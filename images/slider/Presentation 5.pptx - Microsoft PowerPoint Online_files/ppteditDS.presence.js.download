'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1315:function(L,V,d){d.r(V);L=d(0);class k{constructor(ob,ub){this.BRa=null;this.L2=()=>{k.yPf(this.BRa.Sbb())&&(this.BRa.H3e(this.L2),this.jli.IsRealCoauthSession=!0)};this.S_b=ob;this.jli=ub}init(){this.S_b.continueWith(()=>{this.BRa=this.S_b.result;this.BRa.Bvb(this.L2)})}static yPf(ob){let ub=null;for(const bc of ob)if(bc)if(ob=bc.isAnonymous||!bc.email?bc.clientId:bc.email.toUpperCase(),!ub)ub=ob;else if(ub!==
ob)return!0;return!1}}Object(L.a)(k,"CoauthTelemetry",null,[1684]);var e=d(395),n=d(1104),r=d(1264),w=d(25),D;(function(ob){ob[ob.ltm=0]="badStatePreventedTelemetry";ob[ob.notImplemented=1]="notImplemented";ob[ob.KCm=2]="renderHandled";ob[ob.LCm=3]="renderHandledWithVeto"})(D||(D={}));Object(L.b)("CoauthorGalleryTelemetryEndResult",D);var y=d(97),m=d(104),C=d(3);class E{constructor(ob,ub,bc,ic,Rc,Fb,Qb,hc,Pc){this.lCf=this.Ipf=this.TL=null;this.vqd=()=>{this.L2()};this.TUe=()=>{const uc=this.Ci.hh("AppInitStatus_interactivityReady");
e.ULS.shipAssertTag(42259235,325,!!this.pMc);const zb=this.pMc-uc,ac={};ac.InteractiveTime=uc;ac.ReactRenderComplete=this.pMc;ac.HadTabSwitch=this.P5a();ac.IsModernGallery=this.g2b;e.ULS.sendTraceTag(594883104,325,50,m.a.toJSON(ac));this.g2b?(e.ULS.sendTraceTag(42062997,325,15,zb.toString()),this.FLc.sL(this.qnm(zb)?3:2)):e.ULS.sendTraceTag(594883103,325,15,zb.toString())};this.Kra=ob;this.FLc=new n.a;this.La=bc;this.xJd=ub;this.s8=ic;this.Ci=Rc;this.WSd=Fb;this.wRa=Qb;this.V$h=hc;this.luf=this.iuf=
!1;this.pMc=0;this.Fpf=1;this.P5a=Pc;this.g2b=this.La.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled");this.uPa=Object(r.a)(String,w.AFrameworkApplication.ld.Application)||""}get IUh(){return this.FLc.task}init(){C.Task.WAA.call(null,this.wRa,this.xJd,this.WSd).continueWith(()=>{this.TL=this.wRa.result;this.Ipf=this.xJd.result;this.lCf=this.WSd.result;C.Task.WAA.call(null,this.xJd.result.MEa,this.WSd.result.cDd).continueWith(()=>{this.Fpf=this.Ipf.MEa.result;this.pMc=this.lCf.cDd.result;
this.TL.Bvb(this.vqd);this.TL.Sbb().length&&this.L2()})})}L2(){this.V$h(this.TL.Sbb())?(this.TL.H3e(this.vqd),this.m5k(this.iuf)):this.FLc.sL(1);this.iuf=!0}m5k(ob){this.luf?this.IUh.continueWith(()=>{e.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",D[this.IUh.result])}):(this.luf=!0,this.pml(0===this.Fpf&&!ob))}pml(ob){ob?this.s8.Ij(4,this.TUe):this.FLc.sL(1)}qnm(ob){const ub=ob>this.La.tc("CoauthorGalleryTimeToRenderDurationMs",1E4);var bc="Word"===
this.uPa;const ic="PowerPoint"===this.uPa;if(this.P5a())return e.ULS.sendTraceTag(50455714,325,50,ub.toString()),!1;bc&&y.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);ub&&(bc&&y.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),bc=w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientCoauthorGalleryRenderLatencyQoSError"),ic&&bc&&ob<this.La.tc("CoauthorGalleryTimeToRenderCutoffThresholdMs",
3E4)&&y.Health.instance.recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null),e.ULS.sendTraceTag(42062998,325,15,ob.toString()));return ub}}Object(L.a)(E,"CoauthorGalleryTelemetry",null,[1683]);class F{constructor(ob){this.TL=null;this.jEc={};this.NJc={};this.yYb=null;this.L2=()=>{this.l3h()};this.UWi=(ub,bc)=>ub.hIa>bc.hIa?1:ub.hIa<bc.hIa?-1:0;this.wRa=ob}w1c(ob){const ub=new n.a;this.init().continueWith(()=>{ob in this.jEc?ub.sL(this.jEc[ob]):
this.NJc[ob]=ub});return ub.task}init(){if(this.yYb)return this.yYb.task;this.yYb=new n.a;this.wRa.continueWith(()=>{this.TL=this.wRa.result;this.TL.Bvb(this.L2);this.l3h();this.yYb.Jg(null)});return this.yYb.task}l3h(){const ob=this.TL.Sbb();ob.sort(this.UWi);this.jEc={};for(let ub=0;ub<ob.length&&ob[ub]&&ob[ub].hIa;ub++)this.Bvi(this.jEc,ob[ub].clientId,ub)}Bvi(ob,ub,bc){ob[ub]=bc;ub in this.NJc&&(this.NJc[ub].sL(bc),delete this.NJc[ub])}}Object(L.a)(F,"CoauthorPositionFinder",null,[1682]);var B=
d(1266),H=d(1267),K=d(1268),A=d(18),W=d(103);class N{constructor(){this.yka=null;this.SVb=Array(32)}xor(ob){if(!ob)throw Error.argumentNull("Guid argument cannot be null");const ub=new N,bc=new Sys.StringBuilder;for(let ic=0;ic<ob.SVb.length;ic++){const Rc=this.SVb[ic]^ob.SVb[ic];ub.SVb[ic]=Rc;bc.append(Rc.toString(16));7!==ic&&11!==ic&&15!==ic&&19!==ic||bc.append("-")}ub.yka=W.a.Tf(bc.toString());return ub}toString(){return this.yka.toString()}equals(ob){if(!ob)throw Error.argumentNull("Guid argument cannot be null");
return this.yka.equals(ob.yka)}static jZc(ob){if(!ob)throw Error.argumentNull("String input cannot be null");const ub=new N;ub.yka=W.a.Tf(ob);const bc=ub.yka.toString();let ic=0;for(let Fb=0;Fb<bc.length;Fb++){var Rc=ob.charAt(Fb);if(N.Ljk(Rc))Rc=N.u2j(Rc,ob.charCodeAt(Fb)),ub.SVb[ic++]=Rc;else if(!N.cjk(Rc))throw Error.argument("String contains characters not valid in Guids");}return ub}static Ljk(ob){return"0"<=ob&&"9">=ob||"A"<=ob&&"F">=ob||"a"<=ob&&"f">=ob}static cjk(ob){return"{"===ob||"}"===
ob||"-"===ob}static u2j(ob,ub){if("0"<=ob&&"9">=ob)return ub-48;if("A"<=ob&&"F">=ob)return ub-65+10;if("a"<=ob&&"f">=ob)return ub-97+10;throw Error.argument("Char is not valid hex digit");}}Object(L.a)(N,"Guid",null,[]);class P{constructor(ob,ub,bc,ic){this.BRa=null;this.xqf=this.mAf=!1;this.zyf=0;this.L2=()=>{this.VVi(this.BRa.Sbb())};this.S_b=ob;this.pWd=ub;this.La=bc;this.iRd=ic;this.D$h=w.AFrameworkApplication.jqb||w.AFrameworkApplication.YR;this.izf=new B.a(H.a.gl())}get l9d(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",
!1)}init(){this.S_b.continueWith(()=>{this.BRa=this.S_b.result;this.BRa.Bvb(this.L2)})}VVi(ob){var ub=0;const bc=new K.a(H.a.gl());for(const ic of ob)if(ic&&ic.isAnonymous){w.AFrameworkApplication.F1("70eb6120;2gfeb930");if(bc.Ib(ic.userName))bc.ga(ic.userName).add(ic.clientId);else{let Rc;bc.add(ic.userName,(Rc=new A.a,Rc.add(ic.clientId),Rc))}ic.clientId!==this.iRd?(ub++,2<=ub&&!this.mAf&&this.QBk()):!this.xqf&&this.l9d&&"Guest"===ic.userName&&(e.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.xqf=!0)}if(this.l9d&&this.zyf!==ub){e.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",ub+(this.D$h?1:0));this.zyf=ub;for(const ic of bc.keys)2<=bc.ga(ic).count&&(ob=this.eAj(bc.ga(ic)),this.izf.contains(ob)||(ub={},ub.guestsWithSameName=bc.ga(ic).count,ub.identifier=ob,e.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",ub),this.izf.add(ob)))}}QBk(){e.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.mAf=!0;this.l9d&&
this.pWd&&this.pWd.continueWith(()=>{window.setTimeout(()=>{this.pWd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}eAj(ob){if(!ob||1>=ob.count)return"";let ub=N.jZc(ob.ga(0));for(let bc=1;bc<ob.count;bc++)ub=ub.xor(N.jZc(ob.ga(bc)));return ub.toString()}}Object(L.a)(P,"GuestCoauthTelemetry",null,[]);var U=d(1265);class Q{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(L.a)(Q,"PL",null,[]);var G=d(35);class Y{constructor(){this.ct=
this.vt=this.d=0}static RKh(ob,ub,bc){const ic=new Y;ic.d=ob;ic.vt=ub;ic.ct=bc;return G.c(ic)}}Object(L.a)(Y,"VD",null,[]);var ba=d(89);class ha{constructor(ob,ub,bc,ic,Rc,Fb,Qb,hc,Pc){this.pk=0;this.uFf=!1;this._id=ob;this.nGf=ub;this.Du=bc;this.jRd=ic;this.QWd=Rc;this.m9a=Fb;this.i6a=Qb;this.nbi=hc;this.P5a=Pc;this.uPa=Object(r.a)(String,w.AFrameworkApplication.ld.Application)||""}XFd(ob){C.Task.WAA(this.nGf,this.jRd,this.QWd).continueWith(()=>{if(this.jRd.result<=this.QWd.result)ob.sL(!1);else{this.pk=
this.nGf.result;var ub=this.Du-this.pk,bc=new Q;bc.id=this._id;bc.et=this.Du;bc.st=this.pk;bc.d=this.Du-this.pk;bc.mp=this.jRd.result;bc.tp=this.QWd.result;bc.ct=this.owj(this.nbi);bc.vc=this.P5a();var ic=G.c(bc),Rc="Word"===this.uPa,Fb="PowerPoint"===this.uPa;e.ULS.sendTraceTag(42078597,302,15,ic);if(Rc){const Qb=new Map;Qb.set("data",ic);y.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Qb)}ub>this.m9a.value&&!this.uFf&&!bc.vc&&(this.uFf=!0,ob.sL(!0),bc=Object.assign(new ba.a,
{inStaging:!0,extendedProperties:new Map}),bc.extendedProperties.set("data",ic),Rc&&y.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,bc),ub<this.i6a.value&&(e.ULS.sendTraceTag(42078598,302,15,Y.RKh(ub,this.m9a.value,this.i6a.value)),ub=w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientThumbnailPresenceRenderLatencyQoSError"),Fb&&ub&&(bc.inStaging=!1,y.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",
["PresenceExperienceDegraded"],!1,!0,!0,!1,bc))));ob.task.isCompleted||ob.sL(!1)}})}owj(ob){switch(ob){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(L.a)(ha,"PresenceLatencyActivityLogger",null,[]);class ka{constructor(ob,ub,bc){this.cpf=this.Epf=this.YDc=this.iEc=this.Oqb=0;this._id=ob;this.m9a=ub;this.i6a=bc;this.uPa=Object(r.a)(String,w.AFrameworkApplication.ld.Application)||""}get YMf(){return this.Oqb}set YMf(ob){this.Oqb=ob;this.o4d()}get cYf(){return this.iEc}set cYf(ob){this.iEc=
ob;this.o4d()}get nVf(){return this.YDc}set nVf(ob){this.YDc=ob;this.o4d()}get dYf(){return 0!==this.Epf}get oVf(){return 0!==this.cpf}o4d(){!this.dYf&&this.Oqb&&this.iEc&&(this.Epf=this.XFd(this.iEc,"CoauthGalleryLightupDurationTooLong"));!this.oVf&&this.Oqb&&this.YDc&&(this.cpf=this.XFd(this.YDc,"CanvasPresenceLightupDurationTooLong"))}XFd(ob,ub){const bc=ob-this.Oqb;var ic=new Q;ic.id=this._id;ic.et=ob;ic.st=this.Oqb;ic.d=bc;var Rc=G.c(ic);ob="Word"===this.uPa;ic="CanvasPresenceLightupDurationTooLong"===
ub?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===ub?e.ULS.sendTraceTag(572289499,302,15,Rc):e.ULS.sendTraceTag(571524118,302,15,Rc);if(ob){var Fb=new Map;Fb.set("data",Rc);y.Health.instance.recordKpiUsage(ic,0,"wordcollabrel",Fb)}return bc>this.m9a.value?(Fb=Object.assign(new ba.a,{inStaging:!0,extendedProperties:new Map}),Fb.extendedProperties.set("data",Rc),Rc=bc<this.i6a.value,Fb.extendedProperties.set("cash",Rc?"true":"false"),ob&&y.Health.instance.recordKpiFailure(ic,
ub,!1,!0,Fb),e.ULS.sendTraceTag(572289500,302,15,Y.RKh(bc,this.m9a.value,this.i6a.value)),Rc?2:1):3}}Object(L.a)(ka,"PresenceLightupLatencyLogger",null,[]);class ca{constructor(ob,ub,bc,ic,Rc,Fb,Qb,hc=null,Pc=null,uc=null){this.TCf={};this.wJd={};this.Cxf=new A.a;this.GDc=this.zYb=this.TL=this.UKc=null;this.lGf=this.kGf=0;this.f9k=(zb,ac)=>{if(!this.vof&&2===ac.newState){var Jb=this.Ckg();Jb.continueWith(()=>{var Yc=Jb.result;Yc=Date.now()-Yc;const dd={};dd.clientId=this.Eih;dd.bootTime=Yc;this.vof=
!0;this.UKc.gca(15,dd)})}};this.K3k=(zb,ac)=>{if(15===ac.type){zb=Date.now();ac=ac.zBa;var Jb=ac.bootTime;this.tie(ac.clientId).YMf=zb-Jb}};this.vqd=()=>{this.L2()};this.m9a=new U.a(()=>hc.cY("PresenceBootLatencyThreshold",1E4));this.i6a=new U.a(()=>hc.cY("PresenceBootLatencyCutoffThreshold",6E4));this.rri=new U.a(()=>hc.cY("PresenceLightupLatencyThreshold",2E3));this.yci=new U.a(()=>hc.cY("PresenceLightupLatencyCutoffThreshold",1E4));this.s8=ic;this.mli=Rc;this.Gpf=ob;this.xEf=ub;this.wRa=bc;this.Ci=
Fb;this.iRd=Pc;this.P5a=Qb;this.nuf=uc;this.vof=!1;this.init()}Kgj(ob,ub=0){var bc=new Date;const ic=new n.a;this.init().continueWith(()=>{this.m8k(ob);this.Lgj(ic,ob,bc,ub)})}get Eih(){return this.iRd||"{"+w.AFrameworkApplication.userSessionId+"}"}init(){if(this.zYb)return this.zYb.task;this.zYb=new n.a;this.P5a()&&e.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.Gpf.continueWith(()=>{const ob=this.Gpf.result,ub=ob.MEa,bc=ob.Mmd;bc.continueWith(()=>{ub.continueWith(()=>{this.nuf&&this.nuf.addQosPillar("RealTimeCoauth");
this.G5l(ub.result,bc.result);this.zYb.Jg(null)})})});this.xEf.continueWith(()=>{this.UKc=this.xEf.result;this.UKc.C9a(this.f9k);this.UKc.fEa(this.K3k)});this.wRa.continueWith(()=>{this.TL=this.wRa.result;this.TL.Bvb(this.vqd);0<this.TL.Sbb().length&&this.L2()});return this.zYb.task}Ckg(){this.GDc||(this.GDc=new n.a,this.s8.Ij(4,()=>{this.GDc.sL(this.Ci.hh("AppInitStatus_interactivityReady"))}));return this.GDc.task}L2(){const ob=Date.now();var ub=this.TL.Sbb();const bc=new A.a;for(const ic of ub)this.Cxf.contains(ic.clientId)||
(this.Cxf.add(ic.clientId),bc.add(ic.clientId));if(0<bc.count)for(const ic of bc)ub=this.tie(ic),ub.dYf||(ub.cYf=ob)}m8k(ob){ob=this.tie(ob);ob.oVf||(ob.nVf=Date.now())}tie(ob){return ob in this.wJd?this.wJd[ob]:this.wJd[ob]=new ka(ob,this.rri,this.yci)}G5l(ob,ub=0){this.kGf=ob;this.lGf=ub?ub:(new Date).getTime()}Lgj(ob,ub,bc,ic){bc=bc?bc.getTime():(new Date).getTime();ub in this.TCf?ob.A3():(ic=new ha(ub,this.GNj(),bc,this.w1c(this.Eih),this.w1c(ub),this.m9a,this.i6a,ic,this.P5a),this.TCf[ub]=ic,
ic.XFd(ob))}GNj(){return 1===this.kGf?C.Task.ju(this.lGf):this.Ckg()}w1c(ob){return this.mli.w1c(ob)}}Object(L.a)(ca,"PresenceBootTelemetry",null,[1681]);var ia=d(193),oa=d(68),sa=d(288),Ca=d(310),Ta=d(308),R=d(54),Ha=d(255);class da{get name(){return"Common.App.CoauthTelemetry"}fc(ob){ob.register(k,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().na(()=>new k(Ha.a.Au(ob.Ha("Common.IPeopleInfoProvider")),w.AFrameworkApplication.gh));ob.register(E,
"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().na(()=>new E(w.AFrameworkApplication.Pa,Ha.a.Au(ob.Ha("Common.ICoauthoringTelemeryInfoProvider")),w.AFrameworkApplication.fa,ia.a.get_instance(),Ca.a.instance,Ha.a.Au(ob.Ha("Common.IPeoplesWell")),Ha.a.Au(ob.Ha("Common.IPeopleInfoProvider")),k.yPf,()=>this.MRf()));ob.register(ca,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().na(()=>new ca(Ha.a.Au(ob.Ha("Common.ICoauthoringTelemeryInfoProvider")),
Ha.a.Au(ob.Ha("Common.IRealtimeChannelBasic")),Ha.a.Au(ob.Ha("Common.IPeopleInfoProvider")),ia.a.get_instance(),ob.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Ca.a.instance,()=>this.MRf(),w.AFrameworkApplication.fa,null,y.Health.instance));ob.register(F,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().na(()=>new F(Ha.a.Au(ob.Ha("Common.IPeopleInfoProvider"))));ob.register(P,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().na(()=>
new P(Ha.a.Au(ob.Ha("Common.IPeopleInfoProvider")),Ha.a.Au(ob.Ha("Common.ISystemInitiatedFeedback")),w.AFrameworkApplication.fa,"{"+w.AFrameworkApplication.userSessionId+"}"))}init(){w.AFrameworkApplication.fa.Ue(()=>{R.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();R.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();w.AFrameworkApplication.fa.getBooleanAppSetting("CoauthorGalleryTelemetryIsEnabled")&&R.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();
w.AFrameworkApplication.fa.getBooleanAppSetting("CashTelemetryIsEnabled")&&(R.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),R.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}MRf(){return Ta.a.cTa&&Ca.a.instance.Ml(sa.a.kCc)?0<Ca.a.instance.hh(sa.a.kCc)[sa.a.aGd]:!1}static main(){oa.a.instance.Ac(new da)}}Object(L.a)(da,"CoauthTelemetryPackage",null,[2,3]);var Ba=d(270),za=d(801);class Aa{constructor(ob,ub,bc,ic,Rc){this.nd=ob;this._clientId=
ub;this.adi=Rc;this.bfi=bc||(()=>null);this.cfi=ic||(()=>null)}get id(){return this.nd.id}get jNc(){return this.nd.jNc}get nNc(){return this.nd.nNc}get mNc(){return this.nd.mNc}get lNc(){return this.nd.lNc}get kNc(){return this.nd.kNc}get oNc(){return this.nd.oNc}get vYd(){return this.nd.vYd}get nSb(){return this.nd.nSb}get aBd(){return this.nd.aBd}get hnd(){return this.nd.hnd}get clientId(){return this._clientId}get Fva(){return this.bfi}get v5(){return this.cfi}get Kcj(){return this.adi}static createInstance(ob,
ub,bc,ic,Rc=!1){return new Aa(ob,ub,bc,ic,Rc)}}Object(L.a)(Aa,"PeoplesWellSettings",null,[]);var na=d(7),la=d(27);class va{constructor(ob){this.Wj=ob}get MEa(){return this.Wj.MEa}get Mmd(){return this.Wj.Mmd}}Object(L.a)(va,"CoauthoringTelemetryInfoProvider",null,[1081]);var Pa=d(679),Qa=d(75),Ua=d(124),Ya=d(803),Ea=d(588);class La{constructor(ob,ub,bc,ic,Rc){this.VKb=new Qa.a;this.sA=null;this.Wj=ob;this.Eib=bc;this.rF=ic;this.rF.NZd(Object(na.a)(this,this.Eod,"onEditorTableUpdate"));this.AIk=w.AFrameworkApplication.fa.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled");
this.VMe=Rc;ub&&ub.execute(Fb=>{this.sA=Fb})}dispose(){this.VKb&&(Ua.a.Zwd([this.VKb]),this.VKb=null);this.rF.EDh(Object(na.a)(this,this.Eod,"onEditorTableUpdate"))}Bvb(ob){this.VKb.addHandler("UsersUpdatedEvent",ob)}H3e(ob){this.VKb.removeHandler("UsersUpdatedEvent",ob)}Sbb(){return this.Sfg(!1)}fuj(){return this.Sfg(!0)}Sfg(ob){const ub=[];this.Wj.Vpb(this.Wj.mE).returnValue||la.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.Wj.mE);var bc=
null;this.sA&&(bc=this.sA.zZc());const ic=this.VMe.Qig();let Rc=!1;for(const Fb of this.Wj.O0)ob&&La.DPc(ic,Fb.EmailAddress)?Rc=!0:Array.add(ub,this.O5i(Fb,bc));bc={};bc.fExcludeCurrent=ob;bc.fCurrentExcluded=Rc;bc.CurrentID=this.Wj.mE;bc.EditorCount=this.Wj.O0.length;bc.IsRtcNull=!this.sA;bc.UserCount=ub.length;la.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",G.c(bc));return ub}O5i(ob,ub){const bc=this.Eib.Dva(new Pa.a(ob.EmailAddress,void 0,ob.Name),ob.ID,1),ic=new Ya.a;ic.n3a(0);let Rc=
0,Fb=!1,Qb=!1;if(ub&&ob.ID in ub){ic.n3a(1);if(this.AIk){const hc=ub[ob.ID];hc&&hc.capabilities&4&&ic.n3a(4);Fb=!0;hc&&(Rc=hc.capabilities,Qb=hc.isAnonymous)}delete ub[ob.ID]}la.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",ob.ID,bc,ic.Bfa(1),ic.Bfa(4),this.Wj.mE,!ob.EmailAddress,
Rc,Fb,Qb);return new Ea.a(ob.ID,ob.Name,bc,ic,null,ob.EmailAddress,void 0,void 0,Qb,void 0,void 0,ob.JoinCoauthTime)}Eod(){la.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.VKb.raiseEvent("UsersUpdatedEvent",this)}static DPc(ob,ub){return!!ob&&!!ub&&ob.toLowerCase()===ub.toLowerCase()}}Object(L.a)(La,"PeopleInfoProvider",null,[256]);var xb=d(80),dc=d(218),gb=d(132),gc=d(321),Ac=d(279);class $b extends dc.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=!1;this.ImageUrl=
null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(L.a)($b,"PeopleButtonProps",dc.a,[]);var jc=d(787),pb=d(46),$a=d(71);class zc{constructor(ob){this.oCc=new $a.a;this.j9d=null;this.clientId=ob}WUl(ob){this.Fyl();this.tPl(ob);for(const ub of ob)ub.clientId!==this.clientId&&this.iLf(ub)}get HFd(){const ob=[];for(const ub of this.oCc.values){const bc=this.eKh(ub);Array.add(ob,bc)}return ob}get Vya(){return this.oCc.count}HZd(ob,ub){ob=ob.toUpperCase();let bc;({value:bc}=
this.oCc.Eg(ob)).returnValue||(bc=[],this.oCc.$(ob,bc));Array.add(bc,ub)}Fyl(){this.oCc=new $a.a}tPl(ob){for(const ub of ob)if(ub.clientId===this.clientId){this.j9d=ub;break}}}Object(L.a)(zc,"UserTracker",null,[1049]);class rb extends zc{constructor(ob,ub){super(ob);this.dfi=ub}iLf(ob){ob.isAnonymous||!ob.email?this.HZd(ob.clientId,ob):this.j9d&&H.a.gl().equals(this.j9d.email,ob.email)||this.HZd(ob.email,ob)}eKh(ob){let ub=new Date(0),bc=0<ob.length?ob[0]:null;for(const ic of ob)(ob=this.dfi(ic.clientId))&&
ub.getTime()<ob.xFb.getTime()&&(ub=ob.xFb,bc=ic);return bc}}Object(L.a)(rb,"UniqueUserTracker",zc,[]);class ib extends zc{constructor(ob){super(ob)}iLf(ob){this.HZd(ob.clientId,ob)}eKh(ob){return ob[0]}}Object(L.a)(ib,"UserInstanceTracker",zc,[]);const Vb=(ob,ub,bc)=>bc?new rb(ob,ub):new ib(ob);var Od=d(72),jb=d(683),Wb=d(36);class qb{constructor(ob,ub=null,bc=null){this.TL=null;this.UWd=new n.a;this.L3k=(ic,Rc,Fb,Qb,hc)=>{this.UWd.sL(hc.RenderTime);return 32};this.nd=ob;this.zrd=ub;bc&&bc.continueWith(()=>
{this.TL=bc.result;this.TL.Bvb(Object(na.a)(this,this.L2,"onUsersUpdated"));this.Jud()});new Ea.a(this.settings.clientId,"Anonymous user","#cccccc",new Ya.a(7));this.Gve=this.kPd=!0;this.LMd=this.VSd=!1;this.G3=Vb(this.settings.clientId,this.settings.v5,ob.Kcj)}get settings(){return this.nd}get egk(){return w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.getBooleanAppSetting("ColorPresenceHashIsEnabled"):!1}get cgk(){return w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled"):
!1}Lxj(){let ob,ub,bc,ic;var Rc=this.Mxj();this.G3.Vya?1===this.G3.Vya?(ob=!0,ub=this.settings.nSb.cluster,bc=this.settings.nSb.lUc,ic=this.G3.HFd[0].color):(ob=!0,ub=this.settings.hnd.cluster,bc=this.settings.hnd.lUc,ic=""):(ob=!1,ic=bc=ub="");const Fb=Rc[0];Rc=Rc.slice(1);return{Ibl:Fb,Jbl:Rc,Ebl:ob,VBm:ub,Gbl:bc,Fbl:ic}}Mxj(){if(2<=this.G3.Vya)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.G3.Vya)];if(1===this.G3.Vya){const ob=this.G3.HFd[0],ub=this.settings.v5(ob.clientId);
return ub&&2===ub.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,ob.userName]:[ob.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,ob.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}gRj(ob){return this.hRj(ob)}IUf(ob,ub,bc){return ub?this.UPi(ub)?(ob=this.settings.v5(ob))&&2===ob.status?!1:!0:(bc&&e.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(bc&&e.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}KNj(ob){return ob.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}hRj(ob){if(!ob.capabilities.Bfa(1))return this.KNj(ob);const ub=ob.isReadOnly,bc=this.settings.v5(ob.clientId);ob=this.settings.Fva(ob.clientId);if(!bc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(bc.status){case 1:return ob?ub?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.I0i(ob)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}$Cj(ob){if(this.zrd.w9c)return this.zrd.uyb(ob.email,"O365",w.AFrameworkApplication.mh,0)}UQj(ob){ob=this.settings.v5(ob.clientId);return!ob||ob&&1===ob.status?!0:!1}WQj(ob){var ub=String.format("buttonPeoplesWellUser-{0}",ob.clientId),bc=ob.clientId,ic=this.gRj(ob);
const Rc=ob.userName,Fb=ob.color;var Qb=Object,hc=Qb.assign,Pc=new $b,uc=this.settings.oNc.toString(),zb=this.settings.aBd.cluster,ac=this.settings.aBd.lUc,Jb=this.zig(),Yc=ob.isAnonymous,dd;if(dd=[Rc],dd.length){var id=new Sys.StringBuilder("STRARRY@");for(const Cc of dd)id.append(Cc?Cc.length:0),id.append(","),id.append(Cc),id.append(",");dd=id.toString().slice(0,-1)}else dd=null;ub=hc.call(Qb,Pc,{Id:ub,Command:uc,LabelText:"{0}",Image32by32:zb,Image32by32Class:ac,MenuItemId:bc,CommandValueId:bc,
Alt:Rc,DisplayMode:Jb,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:ic,ImageBackColor:Fb,IsAnonymous:Yc,LabelTextUserGeneratedPlaceholderReplacements:dd,Upn:ob.email});w.AFrameworkApplication.fa.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&this.zrd&&(bc=this.$Cj(ob),ic=this.UQj(ob),ub.ImageUrl=bc,ub.ActiveStatus=ic,ub.JoinTimeInMS=ob.hIa,ob=this.IUf(ob.clientId,this.settings.Fva(ob.clientId),!1),ub.CanJump=ob,""===bc&&
e.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));return ub}lCj(){return Object.assign(new dc.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}zig(){return this.egk?"Initials":"Menu32"}XQj(ob){const ub=[];for(const bc of ob)ob=this.WQj(bc),Array.add(ub,ob);return ub}Iue(){return 0<this.G3.Vya}Gol(ob){if(!this.kPd)return!0;this.Gve||(ob[jb.a.Visible]=!0);
const {Ibl:ub,Jbl:bc,Ebl:ic,Gbl:Rc,Fbl:Fb}=this.Lxj();ob[jb.a.LabelText]=ub;bc&&bc.length&&(ob[jb.a.LabelTextUserGeneratedPlaceholderReplacements]=bc);ob[jb.a.ImageIsVisible]=ic;ob[jb.a.Image16by16Class]=Rc;ob[jb.a.ImageBackColor]=Fb;this.kPd=!1;return!0}Zgl(ob){if(0>=this.G3.Vya)return!1;var ub=this.T3l(this.G3.HFd),bc=this.XQj(ub);ub=Object.assign(new gc.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});bc=Object.assign(new Ac.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.zig(),
ControlList:bc});w.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.zrd&&(bc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,bc.TitleId="menuCoauthorsTitle",bc.Theme="Light");Array.add(ub.MenuSectionList,bc);w.AFrameworkApplication.fa.getBooleanAppSetting("DocChatIsEnabled")&&w.AFrameworkApplication.fa.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.Xp&&(bc=[],Array.add(bc,this.lCj()),
bc=Object.assign(new Ac.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:bc}),Array.add(ub.MenuSectionList,bc));w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.Xp?ob.MenuItems=ub:ob.PopulationXML=gb.l(ub);return!0}Ulm(ob){e.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");ob=ob.MenuItemId;if(!ob)return!1;const ub=this.settings.Fva(ob);if(!this.IUf(ob,ub,!0))return!1;this.ouk(ob,ub);return!0}Xul(){const ob=this.iuj();this.G3.WUl(ob);this.Gve&&1<=this.G3.Vya&&
(e.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.Gve=!1);this.kPd=!0}L2(){this.LMd||(window.setTimeout(()=>{this.Jud();this.LMd=!1},3E3),this.LMd=!0)}iuj(){let ob;ob=this.guj()||[];for(const ub of ob)this.IJl(ub);return ob}IJl(ob){ob.clientId||(ob.clientId=W.a.create().toString());ob.userName||(ob.userName="Anonymous user");ob.capabilities||(ob.capabilities=new Ya.a);ob.color||(ob.color="#cccccc");ob.hIa||(ob.hIa=0)}T3l(ob){const ub=[];Array.addRange(ub,ob);
ub.sort(qb.tbl);return ub}oxl(){w.AFrameworkApplication.fa.getBooleanAppSetting("CoauthorGalleryTelemetryIsEnabled")&&!this.VSd&&(w.AFrameworkApplication.Pa.RU(Wb.a.gYf)&&jc.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||w.AFrameworkApplication.Pa.pa(Wb.a.gYf,Od.a.frame,this.L3k,96));this.pxl();this.VSd=!0;this.Jud()}get cDd(){return this.UWd.task}Jud(){if(!this.VSd&&(this.UWd.sL((new Date).getTime()),e.ULS.sendTraceTag(42567504,325,
50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.cgk))return;this.Xul();this.Yul()}dispose(){this.TL&&(this.TL.H3e(Object(na.a)(this,this.L2,"onUsersUpdated")),this.TL=null)}static tbl(ob,ub){return ob.capabilities.Bfa(1)&&ub.capabilities.Bfa(1)||!ob.capabilities.Bfa(1)&&!ub.capabilities.Bfa(1)?pb.a.localeCompare(ob.userName,ub.userName):ob.capabilities.Bfa(1)?-1:1}}Object(L.a)(qb,"APeoplesWell",null,[970,106]);var Ga=d(37);class cb extends qb{constructor(ob,
ub,bc=null,ic=null){super(ob,bc,ic);this.oCa=()=>!0;this.Ca=ub}Iol(ob){return this.Gol(ob)}ahl(ob){return this.Zgl(ob)}Wlm(ob){return this.Ulm(ob)}JR(ob,ub,bc,ic,Rc,Fb){ob=!1;switch(bc){case 1:ob=Rc(ic);break;case 2:ob=Fb(ic)}return cb.MIi(ob)}Fgk(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,()=>this.Iue(),this.oCa)}Hol(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,Object(na.a)(this,this.Iol,"queryUsersProxy"),this.oCa)}$gl(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,this.oCa,Object(na.a)(this,this.ahl,
"populateFlyoutContentsProxy"))}qWi(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,this.oCa,this.oCa)}pWi(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,this.oCa,this.oCa)}Vlm(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,this.oCa,Object(na.a)(this,this.Wlm,"userButtonClickProxy"))}ufl(ob,ub,bc,ic,Rc){return this.JR(ob,ub,bc,Rc,this.oCa,()=>{this.Jud();return!0})}pxl(){this.Ca.xa(this.settings.jNc,Ga.a.application,Object(na.a)(this,this.Fgk,"isControlEnabledHandler"));this.Ca.pa(this.settings.nNc,Ga.a.application,
Object(na.a)(this,this.Hol,"queryUsersHandler"),96);this.Ca.pa(this.settings.lNc,Ga.a.application,Object(na.a)(this,this.qWi,"commandMenuOpenHandler"),96);this.Ca.pa(this.settings.kNc,Ga.a.application,Object(na.a)(this,this.pWi,"commandMenuCloseHandler"),96);this.Ca.pa(this.settings.mNc,Ga.a.application,Object(na.a)(this,this.$gl,"populateFlyoutContentsHandler"),96);this.Ca.xa(this.settings.oNc,Ga.a.application,Object(na.a)(this,this.Vlm,"userButtonClickHandler"));this.Ca.pa(this.settings.vYd,Ga.a.application,
Object(na.a)(this,this.ufl,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static MIi(ob){return ob?32:8}}Object(L.a)(cb,"ABox4PeoplesWell",qb,[]);var Ob=d(754);class Db extends Sys.EventArgs{constructor(ob){super();this.controlId=ob}}Object(L.a)(Db,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);var mb=d(30);class Vc extends cb{constructor(ob,ub,bc,ic,Rc,Fb,Qb,hc,Pc,uc,zb,ac,Jb,Yc,dd,id,Cc,Nb,nc,Kc){super(ob,ub,id,Nb?C.Task.ju(Nb):null);this.sA=null;this.RHe=!1;if(!Rc)throw Error.argumentNull("coauthStateGetter");
if(!Fb)throw Error.argumentNull("appFrame");if(!Qb)throw Error.argumentNull("taskManager");this.Wj=Rc;this.Db=Fb;this.zb=Qb;ic&&ic.execute(xd=>{this.sA=xd});bc&&bc.execute(xd=>{xd.eAi(Object(na.a)(this,this.rkl,"presenceChanged"))});this.Wb=hc;this.De=Pc;this.ue=uc;this.Qkc=Jb;this.wGk=zb;this.Eib=ac;this.ZGb=Yc;this.nZ=dd;this.VMe=Cc;this.L1g=Nb;this.lba=nc;this.Zf=Kc;this.cDd.continueWith(()=>{this.nZ.Jhj(this.cDd.result)})}ouk(ob,ub){let bc=null;({data:bc}=this.Yff(ub)).returnValue&&bc&&bc.Mk&&
(la.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",ob,bc.Mk,this.Wj.mE),(ob=this.Wb.Dma(bc.Mk))?mb.a("CollabGoToLocationFix")&&this.Zf?this.lba.value.RI(ob.ve):(this.De.Eyd(),this.De.RI(ob.ve)):la.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",bc.Mk))}Yff(ob){let ub;ub=null;if(!ob)throw la.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",
this.Wj.mE),Error.argumentNull("presence");return ob?(ub=Ob.a.GTc(ob.data))?{returnValue:!0,data:ub}:{returnValue:!1,data:ub}:{returnValue:!1,data:ub}}UPi(ob){let ub=null;return({data:ub}=this.Yff(ob)).returnValue&&ub&&ub.Mk?!0:!1}guj(){if(this.L1g)return this.L1g.fuj();la.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const ob=this.huj();0<ob.length&&la.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",ob.length);
return ob}huj(){const ob=[],ub=this.VMe.Qig();this.Wj.Vpb(this.Wj.mE).returnValue||la.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.Wj.mE);let bc=null;this.sA&&(bc=this.sA.zZc());var ic=w.AFrameworkApplication.fa.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled");for(var Rc of this.Wj.O0){var Fb=this.Eib.Dva(new Pa.a(Rc.EmailAddress,void 0,Rc.Name),Rc.ID,1),Qb=new Ya.a;Qb.n3a(0);let hc=0,Pc=!1;if(Vc.Tsk(Rc.ID,bc)){Qb.n3a(1);
if(ic){const uc=bc[Rc.ID];uc&&(hc=uc.capabilities);Pc=!0;uc&&uc.capabilities&4&&Qb.n3a(4)}delete bc[Rc.ID]}Vc.DPc(ub,Rc.EmailAddress)||(Array.add(ob,new Ea.a(Rc.ID,Rc.Name,Fb,Qb,null,Rc.EmailAddress)),la.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",Rc.ID,Fb,Qb.Bfa(1),Qb.Bfa(4),this.Wj.mE,
!Rc.EmailAddress,hc,Pc))}if(!ic&&this.Qkc&&bc)for(const hc in bc)ic=bc[hc],!Vc.DPc(ub,ic.email)&&ic&&ic.userName&&(Rc=new Ya.a,Rc.n3a(1),ic.capabilities&4&&Rc.n3a(4),Fb=this.ZGb.fhe(ic.email)||ic.email,Qb=this.Eib.Dva(new Pa.a(Fb,void 0,ic.userName),ic.clientId,1),Array.add(ob,new Ea.a(ic.clientId,ic.userName,Qb,Rc,null,Fb)),la.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
ic.clientId,Qb,Rc.Bfa(1),Rc.Bfa(4),this.sA.clientId,!ic.email,ic.capabilities));return ob}I0i(ob){let ub=null,bc=" ";({data:ub}=this.Yff(ob)).returnValue&&ub&&ub.Mk&&(ob=this.Wb.Dma(ub.Mk))&&(bc=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,ob.ve+1));return bc}rkl(){this.Db.Ru.FHa?this.RHe||(this.zb.Jb(new xb.a(2,1,0,Object(na.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.RHe=!0):this.Ca.nb(Wb.a.Q$a,2)}Yul(){this.ue.Qql(new Db(this.settings.id,!0));
const ob=1<this.G3.Vya||1===this.G3.Vya&&this.G3.HFd[0].clientId!==this.settings.clientId;this.wGk.execute(ub=>{ob&&this.nZ&&this.nZ.KCk();ub.uUb()});ob&&this.nZ.Ei(14,Date.now())}handlePendingRefresh(){this.RHe=!1;this.Ca.nb(Wb.a.Q$a,2)}dispose(){super.dispose()}static Tsk(ob,ub){return ub&&ob in ub?!0:!1}static DPc(ob,ub){return!!ob&&!!ub&&ob.toLowerCase()===ub.toLowerCase()}}Object(L.a)(Vc,"PowerPointPeoplesWell",cb,[]);class Zb{constructor(ob){this.hnc=null;ob.execute(ub=>{this.hnc=ub})}Fva(ob){return this.hnc?
this.hnc.Fva(ob):null}v5(ob){return this.hnc?this.hnc.v5(ob):null}}Object(L.a)(Zb,"PresenceUserInfoGetterProxy",null,[1654]);class fc{constructor(){this.M6=this.rF=this.yh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}fc(ob){fc.Lic=Date.now();this.K=ob;this.M6=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.yh=this.M6.AGa(6,this.name);this.K.register(1654,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().na(()=>new Zb(this.K.Ha("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(1081,"Common.ICoauthoringTelemeryInfoProvider").ma().na(()=>new va(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(La,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().na(()=>new La(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Ha("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(mb.a("PeoplesBaseUlrConfiguredForPods")&&(ob=this.K.resolve("Common.App.People.IExternalPeopleAPI"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mg)){const ub=this.K.resolve("Common.IAppSettingsManager").Ea("368");ob.$rh(ub+"p")}la.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1314)));this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");
this.K.resolve("Common.IPeopleInfoProvider");w.AFrameworkApplication.jC.iGa?(this.rF=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),za.a.Nnd("ribbon","coauthorGallery"),this.rF.gOc(Object(na.a)(this,this.Ixg,"initializePeoplesWellHandler"))):this.Hxg()}Ixg(){try{w.AFrameworkApplication.jC.iGa||(this.Hxg(),this.rF.lvd(Object(na.a)(this,this.Ixg,"initializePeoplesWellHandler")))}catch(ob){la.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",
ob)}}Hxg(){const ob=this.yh.Mu("peoplewell");this.S$j(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);this.yh.Su(ob)}S$j(ob,ub,bc,ic,Rc,Fb){var Qb=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Qb.Ei(10,fc.Lic);Qb.Ei(9,fc.wnc);Qb.Ei(11,
(new Date).getTime());Qb=Date.now();const hc=Ba.CuiHelper.hIj(w.AFrameworkApplication.Mm,w.AFrameworkApplication.Mm,w.AFrameworkApplication.Mm);ob=Aa.createInstance(hc,Fb,Object(na.a)(ob,ob.Fva,"getUserPresence"),Object(na.a)(ob,ob.v5,"getUserStatusInfo"),!0);(Fb=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||la.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");la.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const Pc=new Vc(ob,
ub,this.K.Ha("PowerpointPresence.IPresenceManager"),this.K.Ha("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),bc,ic,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ha("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),Rc.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),
this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),Fb,this.K.ze("PowerPointWebEditor.ISorterViewActorLazy"),Rc.Cm);Pc.oxl();this.K.register(Vc,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().na(()=>Pc);this.K.resolve("Common.IPeoplesWell");this.K.Ha("Box4.IBox4BridgeCommandUi").execute(uc=>{uc.uUb()});la.a.J(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",
Date.now()-Qb);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Nhj()}dispose(){}static main(){fc.wnc=Date.now();if(w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanAppSetting("IsSyncConfigPresenceEnabled")){const ob=new fc;ob.fc(R.a.instance);ob.init()}else oa.a.instance.Ac(new fc)}}fc.wnc=0;fc.Lic=0;Object(L.a)(fc,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");
Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");da.main();Type.registerNamespace("RealtimePresenceUI");fc.main()},754:function(L,V,d){L=d(0);var k=d(57);class e{constructor(r,w,D){this.slideId=r;this.shapes=w;this.sn=D}}Object(L.a)(e,"SerializablePresenceData",null,[]);d.d(V,"a",function(){return n});class n{constructor(r,w,D=0){if(!n.isValid(r))throw Error.create("Invalid Presence Data");this.PC=r;this.Njd=w;this.abh=
D?D:++n.S8i}get Mk(){return this.PC}get mW(){return this.Njd}toString(){return this.PC.toString()+" : "+(this.mW&&this.mW.length?this.mW[0].toString():"")+" : "+this.abh}ske(){return new e(this.PC.CCc,this.Njd,this.abh)}static isValid(r){return!!r}static GTc(r){return new n(new k.a(r.slideId),r.shapes,r.sn)}}n.S8i=0;Object(L.a)(n,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.presence.js.map
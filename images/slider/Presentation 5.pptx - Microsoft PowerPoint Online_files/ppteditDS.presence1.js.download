'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1024:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e,n,r,w){super();this.type=e;this.zBa=n;this.daj=r;this.pOa=w}}Object(L.a)(k,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1025:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(k||
(k={}));Object(L.b)("ChannelConnectionState",k)},1026:function(L,V,d){d.r(V);d.d(V,"MaxOutstandingThrottler",function(){return n});L=d(0);var k=d(75);V=d(1027);var e=d(753);class n extends V.a{constructor(r,w=""){super(r,w);this.Yjb=this.AOa=0;this.Ma=new k.a;this.Msb=!1;this.JEc=this.rEc=this.RWd=0;this.lNl=()=>{this.Msb=!1;if(this.jEb){const D=this.nMc,y=this.Mub;this.D5b(!1);this.exc(D,y)}};this.e7k=()=>{++this.JEc;this.JEc>Math.floor(this.Yjb/2)&&(this.JEc=-1E9,this.Ma.raiseEvent("TMUDM"))};this.bJc=
0;this.rMc=[];this.clearTimeout=n.A9d}add(r){this.Nsb||this.init(n.T3f,n.H3f);this.W8a++;const w=new e.a;this.jEb?this.tzd(r,w):this.bJc<this.Yjb?this.exc(r,w):(this.tzd(r,w),this.Msb=!1);return w}exc(r,w){r=this.kFf(r);const D=this.setTimeout(this.e7k,this.AOa);++this.bJc;Array.add(this.rMc,D);const y=this.rEc;r.mpd(m=>{w.upc(m)});r.lpd(m=>{this.rEc===y&&(this.d7k(y,D),w.K0a(m))})}d7k(r,w){this.rEc===r&&(--this.bJc,this.clearTimeout(w),Array.remove(this.rMc,w),this.jEb&&this.kNl())}kNl(){this.jEb&&
!this.Msb&&(this.RWd=this.setTimeout(this.lNl,0),this.Msb=!0)}COc(r){this.Ma.addHandler("TMUDM",r)}reset(){this.W8a=this.M1b=this.fXb=this.JEc=0;++this.rEc;for(const r of this.rMc)this.clearTimeout(r);this.bJc=0;this.rMc=[];this.D5b(!0);this.Msb&&(this.clearTimeout(this.RWd),this.RWd=0,this.Msb=!1)}init(r,w){this.Nsb||(this.AOa=r,this.Yjb=w,this.Nsb=!0)}static createInstance(r,w=""){return new n(r,w)}static A9d(r){window.clearTimeout(r)}}n.T3f=15E3;n.H3f=5;Object(L.a)(n,"MaxOutstandingThrottler",
V.a,[765,764])},1027:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(395);class e{constructor(n,r=""){this.fXb=this.M1b=0;this.EOd=!1;this.Mub=this.nMc=null;this.Nsb=!1;this.kFf=n;this.fYh=r;this.setTimeout=e.K9d;this.W8a=this.M1b=this.fXb=0}U1e(){0<this.W8a&&0<this.fXb&&k.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.fYh,this.fXb,this.W8a);0<this.W8a&&0<this.M1b&&k.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",
this.fYh,this.M1b,this.W8a)}get jEb(){return this.EOd}tzd(n,r){this.M1b++;this.D5b(!0);this.EOd=!0;this.nMc=n;this.Mub=r}D5b(n){this.EOd=!1;this.Mub&&n&&(this.fXb++,this.Mub.HQe());this.Mub=this.nMc=null}static K9d(n,r){return window.setTimeout(n,r)}}Object(L.a)(e,"ThrottlerBase",null,[])},1028:function(L,V,d){d.r(V);d.d(V,"MaxRateThrottler",function(){return e});L=d(0);V=d(1027);var k=d(753);class e extends V.a{constructor(n,r=""){super(n,r);this.$jb=0;this.jNl=()=>{if(this.jEb){const w=this.nMc,
D=this.Mub;this.D5b(!1);this.exc(w,D)}};this.wZb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(n){this.Nsb||(this.$jb=n,this.Nsb=!0)}add(n){this.Nsb||this.init(e.B3f);this.W8a++;const r=this.currentTime(),w=new k.a;this.wZb>r&&(this.wZb=r);this.jEb?(this.D5b(!0),this.tzd(n,w)):this.wZb+this.$jb<=r?this.exc(n,w):(this.tzd(n,w),this.setTimeout(this.jNl,this.wZb+this.$jb-r));return w}exc(n,r){this.wZb=this.currentTime();n=this.kFf(n);n.mpd(w=>{r.upc(w)});n.lpd(w=>{r.K0a(w)})}static createInstance(n,
r=""){return new e(n,r)}}e.B3f=200;Object(L.a)(e,"MaxRateThrottler",V.a,[763,764])},1029:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.E5e="rr";k.tIl="rd";k.pIl="rbp";k.P6e="sa";Object(L.a)(k,"RtcReconnectParams",null,[])},1030:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.$jb="throttling_messageDelay";k.yEb="enabled";k.AOa="throttling_timeToWaitForResponse";k.Yjb="throttling_maxNumberOfOutstandingMessages";k.kme="throttling_globalMaxNumberOfOutstandingMessages";
k.errorMessage="errorMessage";k.Kaf="url";k.B7="queryString";k.kC="connectionString";Object(L.a)(k,"RtcFindSessionOutputFieldNameConstants",null,[])},1031:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.P2c=this.imd=this.jmd=this.mmd=0;this.Qfc=!1;this.correlationId=this.kC=this.B7=this.h6b=this.errorMessage=null}get dZf(){return this.h6b+"?"+this.B7}}Object(L.a)(k,"FindSessionResponse",null,[])},1053:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(7),n=d(18),r=d(1025),
w=d(1030),D=d(25),y=d(74),m=d(64),C=d(504),E=d(104),F=d(46),B=d(103),H=d(1031);class K{}K.clientId="ClientId";K.Tlm="UserApp";K.userSessionId="usid";K.userType="UserType";K.gmm="UserVersion";K.Luc="qs";K.KUi="clientProtocol";K.U_k="NoAuth";Object(L.a)(K,"RtcFindSessionInputQueryParamConstants",null,[]);class A{constructor(ca,ia,oa,sa,Ca,Ta){this.f8a=null;this.cmi=ca;ca=String.format("{0}={1}",K.clientId,F.a.We(sa));ca=String.format("{0}&{1}={2}",ca,K.userSessionId,F.a.We(Ca));ca=String.format("{0}&{1}={2}",
ca,K.Tlm,F.a.We(oa.toString()));ca=String.format("{0}&{1}={2}",ca,K.userType,F.a.We("1"));ca=String.format("{0}&{1}={2}",ca,K.gmm,F.a.We(ia));ca=String.format("{0}&{1}={2}",ca,K.KUi,F.a.We(A.JUi));(ia=A.Kuj(oa,Ta))&&(ca=String.format("{0}&{1}",ca,ia));this.Pbi=ca}BBh(){this.f8a=this.cmi()}sZc(){this.f8a&&""!==this.f8a||(this.BBh(),k.ULS.sendTraceTag(575784194,500,this.f8a&&""!==this.f8a?50:15,"Query signature delegate called for refresh returned: {0} ",this.f8a));const ca=String.format("{0}={1}",
K.Luc,F.a.We(this.f8a));return String.format("{0}&{1}",ca,this.Pbi)}static Kuj(ca,ia){return 4===ca?String.format("{0}={1}",K.U_k,"1"):ia?ia.jRj():null}}A.JUi="1.0";Object(L.a)(A,"FindSessionQueryStringGenerator",null,[]);var W=d(309),N=d(714),P=d(191),U=d(715);class Q{}Q.aoj="FSType";Object(L.a)(Q,"RtcFindSessionRequestHeaders",null,[]);class G{}G.Qsl="polling";Object(L.a)(G,"RtcFindSessionTypes",null,[]);var Y=d(1029);class ba{}ba.dnm="RTC-TokenProofkey";ba.Gtk="RTC-IsWacJsBootFsRequest";Object(L.a)(ba,
"RtcRequestHeaders",null,[]);var ha=d(320);d.d(V,"FindSessionStrategy",function(){return ka});class ka{constructor(ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za,Aa,na=null){this.dyf=(new Date(0)).getTime();this.qzf=0;this.sIc=!1;this.oFf=null;this.d2e=36E5;this.zrb=ka.yxg;this.vXb=0;this.Smb=null;this.fAa=0;this.cQb=this.BZf=null;this.Mmi=[w.a.yEb,w.a.errorMessage,w.a.Kaf,w.a.kC,w.a.B7,w.a.kme,w.a.Yjb,w.a.AOa,w.a.$jb];this.Lmi=[w.a.yEb,w.a.errorMessage];this.kC=this.qpa=null;this.Tsf=new A(za?za:()=>D.AFrameworkApplication.mh,
Ca,Ta,R,ca,ia);this.aWb=Aa;this.Di=sa;this.Bi=ia;this.qei=oa;this.Dq=Ha;this.oj=da;this.GXb=na;this.Usf=!1;this.O9b=9E4;Ba&&Ba.execute(la=>{la.sOc(()=>{k.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.Dq);this.Tsf.BBh()})});2>=100*Math.random()&&(this.d2e=3E5);W.FrequentLoggingMetrics.instance&&(W.FrequentLoggingMetrics.instance.Seg=this.d2e)}w8e(ca){this.cQb=ca}init(){this.oj.pAi(Object(e.a)(this,this.zFl,"resetGetMachineIdDelay"));this.oj.C9a(Object(e.a)(this,
this.Hpa,"onConnectionStateChanged"))}Hpa(ca,ia){this.fAa=ia.newState;2===ia.newState&&(this.vXb=0)}W_c(){let ca;ca=this.Smb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Smb.B7,ka.h7d,F.a.We(ca)),correlationId:ca}}jke(ca,ia,oa,sa,Ca){this.yMl(()=>{sa(Ca,"GetMachineIdSuccess")&&(k.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.kC,this.Dq),ca(this.oFf),oa(this.OPj()))},Ta=>{sa(Ca,"GetMachineIdFailure")&&(k.ULS.sendTraceTag(4060129,500,
15,"Failed to retrieve Rtc MachineId for [{0}]",this.Dq),ia(Ta))},sa,Ca)}cae(){this.hXf();this.T7j()}yMl(ca,ia,oa,sa){k.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.kC);this.kC?ca():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(ca,ia,oa,sa)},this.IOi())}sendFindSessionRequestToServerInternal(ca,ia,oa,sa){oa(sa,"RequestMachineId")&&(this.dyf=(new Date).getTime(),oa=m.a.jj(),this.ejg(Ca=>{const Ta=
m.a.jj();this.$qd(Ca);this.e8e();ca();Ca=m.a.jj()-Ta;k.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",Ca)},Ca=>{const Ta=m.a.jj();this.hXf();W.FrequentLoggingMetrics.instance&&W.FrequentLoggingMetrics.instance.mI(2,3);ia(Ca);Ca=m.a.jj()-Ta;k.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",Ca)},!1),oa=m.a.jj()-oa,k.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",oa))}T7j(){this.zrb+=ka.dFj;this.zrb=Math.min(this.zrb,ka.RWk)}IOi(){let ca=this.dyf+
this.zrb-(new Date).getTime();0>ca&&(ca=0);return ca}$qd(ca){try{this.Smb=ca,this.qpa=ca.dZf,this.kC=ca.kC,this.BZf=ca.B7,this.oFf=ca.h6b}catch(ia){k.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",ia.toString())}}hXf(){this.kC=null;this.iXf()}e8e(){this.iXf();this.sIc=!0;this.qzf=window.setTimeout(Object(e.a)(this,this.evl,"refreshMachineId"),this.d2e)}iXf(){this.sIc&&(window.clearTimeout(this.qzf),this.sIc=!1)}evl(){this.sIc=!1;this.ejg(ca=>
{const ia=this.BZf!==ca.B7,oa=this.kC!==ca.kC,sa=this.kC;this.$qd(ca);0!==this.fAa&&(oa?(k.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",sa||"null",ca.kC),this.oj.oud()):(this.oj.Xql(ia,oa),this.e8e()))},()=>{W.FrequentLoggingMetrics.instance&&W.FrequentLoggingMetrics.instance.mI(2,3);this.e8e()},!0)}zFl(){this.zrb=ka.yxg}OPj(){return new U.a(this.Smb.mmd,this.Smb.jmd,this.Smb.imd,this.Smb.P2c)}Qbm(ca){if(Object.getType(ca)!==Object)return null;
for(let ia in ca);return this.l3i(ca)}l3i(ca){if(!(w.a.yEb in ca))return null;const ia=ca[w.a.yEb];var oa=ia?this.Mmi:this.Lmi;for(const sa of oa)if(!(sa in ca))return null;oa=Object.assign(new H.a,{Qfc:ca[w.a.yEb],errorMessage:ca[w.a.errorMessage],correlationId:B.a.create().toString()});ia&&(oa.h6b=ca[w.a.Kaf],oa.B7=ca[w.a.B7],oa.kC=ca[w.a.kC],oa.P2c=ca[w.a.kme],oa.imd=ca[w.a.Yjb],oa.jmd=ca[w.a.AOa],oa.mmd=ca[w.a.$jb]);return oa}uBj(ca,ia){k.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");
this.GXb.Znj.continueWith(()=>{this.GXb.Znj.result?(k.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),ca(this.GXb.$nj)):(k.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),ia(this.GXb.$nj))})}cGh(ca,ia,oa,sa,Ca=!1){return Ta=>{N.a.instance.hvc(0,1);ca&&ca.stop();this.aWb=this.cQb=null;this.EKg(Ta.data,!0,ia);var R=P.RtcUtils.deserialize(Ta.data.Ud,"FindSession",null);if(R)if(R=this.Qbm(R)){if(R.Qfc&&R.B7&&R.kC){k.ULS.sendTraceTag(4317446,
500,50,"Successfully retrieved MachineId from server for [{0}]",this.Dq);this.Nzk(Ta.data);oa(R);return}ia.FindSessionFailureReason="FindSessionInvalidResponse";ia.IsRtcEnabled=R.Qfc;ia.IsQueryStringEmpty=!R.B7;ia.IsConnectionStringEmpty=!R.kC;k.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.Dq,R.Qfc,!R.B7,!R.kC)}else ia.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",
k.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Dq);else ia.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",k.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.Dq);this.Izh(ia,Ca);sa(null)}}VFh(ca,ia,oa,sa=!1){return Ca=>{N.a.instance.hvc(0,1);ca&&ca.stop();this.aWb=this.cQb=null;this.EKg(Ca.data,!1,ia);let Ta=null;var R="unknown";let Ha="unknown";Ca.data&&((R=Ca.data.gk)&&ka.Hwc in
R&&(Ta=R[ka.Hwc].toString()),R=C.a[Ca.data.status],Ha=Ca.data.Ke.toString());ia.FindSessionFailureReason="FindSessionRequestFailed";ia.HttpErrorCode=Ha;ia.HttpErrorStatus=R;ia[ka.Hwc]=Ta;k.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",R,Ha,this.Dq,Ta,sa);this.Izh(ia,sa);oa(Ha)}}ejg(ca,ia,oa=!1){let sa=null;k.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Dq);const Ca=
{};var Ta=this.Tsf.sZc();Ca[ha.a.UEa]=B.a.create().toString();this.cQb&&""!==this.cQb?Ta=String.format("{0}&{1}={2}",Ta,Y.a.E5e,this.cQb):this.aWb&&""!==this.aWb&&(Ta=String.format("{0}&{1}={2}",Ta,Y.a.E5e,this.aWb),Ca[ba.dnm]="True",Ca[ba.Gtk]="True");Ta=this.qei+"?"+Ta;oa&&(Ca[Q.aoj]=G.Qsl);const R={};R.IsNetworkOfflineBeforeSendRequest=this.Bi.KHa;R.HasAvailableConnectionsBeforeSendRequest=this.Bi.Stg;R.MaxConnectionsAllowed=this.Bi.Fgh;R.IsRefreshMachineId=oa;this.GXb&&!this.Usf?(this.uBj(this.cGh(null,
R,ca,ia,oa),this.VFh(null,R,ia,oa)),this.Usf=!0):(this.Di&&(sa=this.Di.lj("WebServiceCall","GetMachineIdFromTheServer")),W.FrequentLoggingMetrics.instance&&W.FrequentLoggingMetrics.instance.mI(2,0),0>this.Bi.jU(Ta,1,null,Ca,[ka.kTc,ka.Hwc,ka.Eqc,ka.C5e,ka.sih,ka.okh,ka.nkh],1,this.cGh(sa,R,ca,ia,oa),this.VFh(sa,R,ia,oa),null,null,!1,null,this.O9b,"3",null,!0)&&(5<this.vXb&&200>this.vXb&&k.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",
this.vXb),window.setTimeout(()=>{this.vXb++;ia("-1")},1E3)))}EKg(ca,ia,oa){oa||(oa={});oa.IsNetworkOfflineAfterRequestComplete=this.Bi.KHa;oa.IsRequestSucceeded=ia;ca&&(oa.EnqueueTime=ca.cF,oa.InvokedTime=ca.Et,oa.CompletedTime=ca.au,ca.gk&&(ka.kTc in ca.gk&&(oa.CorrelationId=ca.gk[ka.kTc]),ka.Eqc in ca.gk&&(oa[ka.Eqc]=ca.gk[ka.Eqc])));k.ULS.sendTraceTag(38633565,500,ia?50:15,P.RtcUtils.ULb(oa))}Izh(ca,ia){ca||(ca={});ca.ConnectionState=r.a[this.fAa];ia||this.oj.Hzh(1,ca)}Nzk(ca){try{var ia=!1,oa=
!1,sa=ca.gk,Ca=y.a.GD(ca.request.get_url());if(sa&&ka.C5e in sa){const Ba=sa[ka.C5e].toString().toLocaleLowerCase();oa="true"===Ba;ia="false"===Ba}sa=!1;const da=0<=Ca.toLocaleLowerCase().indexOf("collab");oa&&!da?sa=!0:ia&&da&&(sa=!0);if(sa){ia={};ia.HostName=Ca;ia.Status=C.a[ca.status];ia.HttpStatus=ca.Ke.toString();var Ta=ca.request.get_headers();for(let Ba in Ta){var R=Ta[Ba];(Ca=Ba)&&0<Ca.length&&(oa=0,R&&(oa=R.toString().length),ia["r_"+Ca]=oa)}if(ca.gk){const Ba=new n.a;Ba.add(ka.kTc);Ba.add(ka.Eqc);
Ba.add(ka.Hwc);Ba.add(ka.okh);Ba.add(ka.nkh);Ba.add(ka.sih);ka.Nvi(ia,ca.gk,Ba)}ka.Ivi(ca.request.get_url(),ia);var Ha=E.a.toJSON(ia);k.ULS.sendTraceTag(559437006,500,15,Ha)}}catch(da){k.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",da.toString())}}static createInstance(ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za,Aa=null){return ka.OTc(ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,null,za,Aa)}static c4i(ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za=null){return ka.OTc(ca,ia,oa,sa,Ca,3,Ta,R,Ha,da,Ba,za,null)}static OTc(ca,
ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za,Aa,na=null){ca=ca||B.a.create().toString();ca=new ka(ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za,Aa,na);ca.init();return ca}static Nvi(ca,ia,oa){for(let sa of oa)sa in ia&&(ca[sa]=ia[sa])}static Ivi(ca,ia){if(ca){var oa=ca.indexOf("?");if(-1!==oa)for(ca=ca.substr(oa+1).split("&"),oa=0;oa<ca.length;++oa){var sa=ca[oa].split("=");if(2===sa.length){const Ca=sa[0];if(Ca&&0<Ca.length){let Ta=0;if(sa=sa[1])Ta=sa.length;ia["q_"+Ca]=Ta}}}}}}ka.dFj=3E3;ka.RWk=3E5;ka.yxg=1E3;ka.kTc="X-CorrelationId";
ka.h7d="corrid";ka.Hwc="RtcErrorCode";ka.Eqc="X-OfficeCluster";ka.C5e="X-NewEnv";ka.sih="X-MSEdge-Ref";ka.nkh="X-OFFICEFD";ka.okh="X-OfficeFE";Object(L.a)(ka,"FindSessionStrategy",null,[708])},1083:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(1104),n=d(318),r=d(18);class w{constructor(y){this.messageId=y;this.mNl=(new Date).getTime();this.xze=new r.a}}Object(L.a)(w,"MessageLatencyDetails",null,[]);d.d(V,"ClientToClientMessageTelemetry",function(){return D});class D{constructor(y,m,C){this.zsa=null;
this.zQd=this.YUd=0;this.sendMessage=()=>{if(this.T0b){const E=n.a.create().toString();this.zsa=new w(E);this.oj.n1e(16,E,!1,new e.a);window.setTimeout(()=>{this.HBk(E)},this.zQd)}};this.btl=(E,F)=>{16===F.type?this.oj.n1e(17,F.zBa,!1,new e.a):17===F.type&&this.T0b&&F.zBa&&this.processMessage(F.zBa)};this.nd=m;this.Tzf=C;this.T0b=!1;this.oj=y;this.oj.fEa(this.btl)}start(){if(this.Tzf&&!this.T0b){const y=this.nd.ZHh;this.zQd=this.nd.WHh;y<=this.zQd?(k.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.nd.ZHh,this.nd.WHh),this.Tzf=!1):(this.T0b=!0,this.YUd=window.setInterval(this.sendMessage,y))}}HBk(y){this.zsa&&this.zsa.messageId===y&&(0<this.zsa.xze.count?(y=this.zsa.xze.toArray().join(","),k.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",y)):k.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.zsa=null)}stop(){this.YUd&&(window.clearInterval(this.YUd),this.T0b=!1)}processMessage(y){y&&this.zsa&&y.toString()===this.zsa.messageId&&this.zsa.xze.add((new Date).getTime()-
this.zsa.mNl)}static get instance(){return D.Ja}static nHj(y,m,C){return D.instance||(D.Ja=new D(y,m,C))}}D.Ja=null;Object(L.a)(D,"ClientToClientMessageTelemetry",null,[])},1190:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e,n){super();this.DUb=e;this.a6f=n}}Object(L.a)(k,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1191:function(L,V,d){d.r(V);d.d(V,"RealtimeChannelMetrics",function(){return w});L=d(0);var k=d(395),e=d(160),n=d(104),r=d(191);class w{constructor(){this.WAf=
this.XAf=this.YAf=this.UAf=this.TAf=this.VAf=this.o_b=this.KRd=0;this.aGc=this.XPd=this.xZb=this.NPd=this.OPd=this.FPd=this.PQa=this.rZb=this.Usb=this.EPd=this.ZFc=this.esb=null;this.EQd=this.YZb=this.nFf=this.spf=0;this.Vzf=!1;this.Dud=this.I1e;this.L1e=this.M1e;this.Eud=this.K1e;this.gvc=this.O1e;this.QAh=this.N1e;this.V1e=this.W1e;this.S1e=this.T1e;this.imb=this.Q1e;this.ivc=this.R1e;this.LAh=this.J1e;this.okb=this.kSe;this.CLb=this.lSe}I1e(){this.KRd++;this.EPd=new Date;this.esb||(this.esb=new Date)}M1e(){this.o_b++;
this.PQa=new Date;this.ZFc||(this.ZFc=this.PQa);this.xZb=this.PQa;this.uXi()}K1e(){this.VAf++;this.FPd=new Date}O1e(){this.TAf++;this.Usb=new Date}N1e(){this.UAf++;this.rZb=new Date}T1e(){this.OPd=new Date;this.YAf++}R1e(){this.aGc||(this.aGc=new Date);this.XAf++}Q1e(){this.NPd=new Date;this.WAf++}W1e(){if(!this.Vzf&&this.KRd){var D=this.jSc();k.ULS.sendTraceTag(39321871,500,15,n.a.toJSON(D));this.Vzf=!0}}J1e(D){const {Foe:y,Goe:m,Ni:C}=r.RtcUtils.oag(D);y&&y!==e.a.Zw&&(k.ULS.sendTraceTag(40157596,
500,15,n.a.toJSON({["HttpErrorCode"]:y,["HttpErrorStatus"]:m,["Exception"]:C})),e.a.sAg(y)&&this.spf++,e.a.uFg(y)&&this.nFf++)}kSe(){this.XPd=new Date}lSe(){this.Usb=this.xZb=new Date}jSc(){return{["numberOfConnectionAttempts"]:this.KRd,["numberOfSuccessfulConnections"]:this.o_b,["numberOfFailedConnections"]:this.VAf,["numberOfDisconnectedConnections"]:this.TAf,["numberOfExplicitDisconnectedConnections"]:this.UAf,["numberOfSentMessages"]:this.YAf,["numberOfReceivedMessages"]:this.XAf,["numberOfLostMessages"]:this.WAf,
["firstConnectionAttempt"]:this.esb?this.esb:null,["firstMessageReceived"]:this.aGc?this.aGc:null,["firstConnectionSuccess"]:this.ZFc?this.ZFc:null,["lastConnectionAttempt"]:this.EPd?this.EPd:null,["lastConnectionSuccess"]:this.PQa?this.PQa:null,["lastConnectionFailure"]:this.FPd?this.FPd:null,["lastMessageSent"]:this.OPd?this.OPd:null,["lastMessageLost"]:this.NPd?this.NPd:null,["lastDisconnect"]:this.Usb?this.Usb:null,["lastExplicitDisconnect"]:this.rZb?this.rZb:null,["lastTimeOnline"]:this.xZb?
this.xZb:null,["lastTimeOffline"]:this.XPd?this.XPd:null,["maxDisconnectedTimeMs"]:this.YZb,["maxExplicitDisconnectedTimeMs"]:this.EQd,["clientConnectionErrors"]:this.spf,["serverConnectionErrors"]:this.nFf}}uXi(){this.esb&&1===this.o_b&&(this.YZb=Math.max(this.YZb,this.PQa.getTime()-this.esb.getTime()));this.Usb&&1<this.o_b&&(this.YZb=Math.max(this.YZb,this.PQa.getTime()-this.Usb.getTime()));this.rZb&&1<this.o_b&&(this.EQd=Math.max(this.EQd,this.PQa.getTime()-this.rZb.getTime()))}static createInstance(D){w.Ja||
(w.Ja=new w,k.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",D));return w.Ja}}w.Ja=null;Object(L.a)(w,"RealtimeChannelMetrics",null,[711,370])},1192:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.$if=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.Rnm=7]="visio";e[e.CBm=8]="officeMobile";e[e.Utm=9]="cosmosDBChangefeed";
e[e.last=10]="last"})(k||(k={}));Object(L.b)("RtcClientAppName",k)},1204:function(L,V,d){L=d(0);var k=d(1264),e=d(303),n=d(304),r=d(7),w=d(67),D=d(99);class y extends e.a{constructor(N,P){super(N);this.Ph=null;this.Lda=P.get(8,!1);this.yja=P.get(6,0);this.element=N;this.element.className=y.j$b;this.e9a=this.createElement("ul");this.element.appendChild(this.e9a);this.er=P.get(10);this.er.xb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick"));this.LA=P.get(9);this.LA.xb(w.a.qE,this.element,
Object(r.a)(this,this.hH,"onPointerOut"));this.LA.xb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior"));this.V_=P.get(13);this.V_.xb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior"))}t9(N){this.addHandler(n.a.Ax,N)}xqa(N){this.removeHandler(n.a.Ax,N)}get Oca(){return this.Ph}dispose(){this.element&&(this.er.Hb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.LA.Hb(w.a.BB,this.element,Object(r.a)(this,this.$F,
"stopPropagationAndPreventDefaultBehavior")),this.LA.Hb(w.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut")),this.V_.Hb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(N,P,U){this.hide();!N||0>=N.length||(this.Lda?this.element.style.right=P+"px":this.element.style.left=P+"px",this.element.style.top=U+"px",this.IZd(N),this.visible=!0)}IZd(N){this.Ph=N;D.a.qw(this.e9a);for(let P=N.length-1;0<=P;P--)this.$B(N[P])}$B(N){const P=
document.createElement("li");P.style.backgroundColor=N.color;P.style.height=this.yja+"px";P.id="fly_"+N.clientId;P.style.lineHeight=this.yja+"px";D.a.yA(P,N.userName);P.setAttribute("dir","auto");this.e9a.appendChild(P)}onClick(){this.hide();return!1}hH(N){this.raiseEvent(n.a.Ax,new n.a(3,N));return!1}}y.j$b="prFlyout UIFont";Object(L.a)(y,"PresenceTooltipFlyoutControl",e.a,[]);var m=d(78);class C extends e.a{constructor(N,P,U){super(N);this.d0=null;this.Ph=[];this.element.className="prGlyph";this.nd=
P;this.f9=this.nd.get(9);this.to=this.nd.get(10);this.V_=this.nd.get(13);this.soe();this.$B(U);this.f7a=!1}get gQ(){return this.Ph.length}get Oca(){return this.Ph}t9(N){this.addHandler(n.a.Ax,N)}xqa(N){this.removeHandler(n.a.Ax,N)}dispose(){this.Ogf();super.dispose()}$B(N){Array.add(this.Ph,N);2===this.gQ?this.Lca(!0):1===this.gQ?this.Lca(!1):this.Lca(this.f7a)}qQ(N){this.Gde(N)&&(1<this.gQ&&this.Lca(!0),1===this.gQ?this.Lca(!1):1>this.gQ&&this.hide())}show(){this.Lca(2<=this.gQ);this.visible=!0}hide(){this.visible=
!1}hie(N){return N?this.V$b(0,5):this.V$b(1,4)}Gde(N){for(let P=0;P<this.gQ;P++)if(this.Ph[P].clientId===N)return N=this.Ph[P],Array.removeAt(this.Ph,P),N;return null}Lca(N){this.f7a!==N&&(this.d0&&this.element.removeChild(this.d0),this.d0=this.hie(N),this.element.appendChild(this.d0),this.f7a=N);this.d0.childNodes[0].style.backgroundColor=this.Ph[this.Ph.length-1].color}V$b(N,P){const U=this.nd.get(6,0),Q=this.nd.get(14);return m.createClusteredImageFromClusterWithImageClass(U,U,this.nd.get(N),this.nd.get(P),
"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,Q?Q.cloneNode(!0):null)}FN(N){3!==N.wg&&this.raiseEvent(n.a.Ax,new n.a(2,N));return!1}onClick(N){this.raiseEvent(n.a.Ax,new n.a(1,N));return!0}hH(N){3!==N.wg&&this.raiseEvent(n.a.Ax,new n.a(3,N));return!1}Ogf(){this.element&&(this.f9.Hb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.f9.Hb(w.a.aD,this.element,Object(r.a)(this,this.FN,"onPointerOver")),this.f9.Hb(w.a.qE,this.element,
Object(r.a)(this,this.hH,"onPointerOut")),this.to.Hb(w.a.doubleClick,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.to.Hb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.V_.Hb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")))}soe(){this.element&&(this.f9.xb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.f9.xb(w.a.aD,this.element,Object(r.a)(this,this.FN,
"onPointerOver")),this.f9.xb(w.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut")),this.to.xb(w.a.doubleClick,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.to.xb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.V_.xb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")))}}Object(L.a)(C,"PresenceTooltipGlyph",e.a,[]);var E=d(124);d(64);var F=d(197);class B extends e.a{constructor(N,P,U){super(N);this.Ph=
[];this.Wm=[];this.zJ=0;this.ska=this.K8=!1;this.wVb=null;this.LZ=(Q,G)=>{var Y=Object(k.a)(C,Q);Y=Y?this.H9b(Y):-1;if(2===G.type||1===G.type&&-1!==Y&&!this.qx[Y].visible)this.kMa(Q);else if(1===G.type)this.eY(),this.K8=!1;else if(3===G.type){if(this.dXc(G.Uj))return;this.K8||this.eY()}this.raiseEvent(n.a.Ax,G)};this.Kja={};this.nd=U;this.Ll=U.get(8,!1);this.HH=U.get(11,!1);N=U.get(12,0);this.A5=U.get(6,0);this.oub=P;this.element.id=B.E$b();this.element.className=e.a.p8d(this.Ll);N&&(this.zIndex=
N);this.rtl=this.Ll;this.mxc(P);this.GA=this.createElement("div");this.GA.className=this.HH?"prContainerV":"prContainerHr";this.element.appendChild(this.GA);this.KXb=Array(this.zJ);for(P=0;P<this.zJ;P++)this.qx[P]=new y(this.createElement("div"),this.nd),this.qx[P].t9(this.LZ),this.element.appendChild(this.qx[P].element)}get NNb(){return F.a.clone(this.Ph)}getGlyph(N){return this.Kja[N]}get qx(){return this.KXb}get A2b(){return this.wVb}get YNa(){return this.A5+2}get width(){return this.HH?this.YNa:
this.oub}get height(){return this.HH?this.oub:this.YNa}t9(N){this.addHandler(n.a.Ax,N)}xqa(N){this.removeHandler(n.a.Ax,N)}dispose(){if(this.qx)for(const N of this.qx)N.xqa(this.LZ),E.a.Iz(N);E.a.Zwd(this.Wm);this.Wm=this.KXb=null;super.dispose()}PNa(){this.eY();this.wob();this.visible=!0;this.K8=!1}JAd(){!this.Wm||1>this.Wm.length||(this.eY(),this.visible=!0,this.wob(),this.kMa(this.Wm[this.Wm.length-1]),this.K8=!0)}LNa(){if(this.Wm&&!(1>this.Wm.length)){this.visible=!0;this.wob();var N=0;for(const P of this.Wm)this.kMa(P,
N++);this.K8=!1;this.ska=!0}}hide(){this.visible=!1;this.eY();for(let N=0;N<this.Wm.length;N++)this.Wm[N].hide();this.K8=!1}s5b(){if(!this.ska)return!1;let N=0;for(const P of this.qx)P.visible&&N++;return this.ska=0<N&&(this.Ph.length<=this.zJ?N===this.Ph.length:N===this.zJ)}$B(N){if(!(0>=this.zJ)){N.clientId||(N.clientId=(B.DQa++).toString());if(N.clientId in this.Kja){var P=this.fma(N.clientId);if(0<=P){P=this.Ph[P];if(P.color===N.color&&P.userName===N.userName)return;this.qQ(N.clientId)}}P=this.s5b();
var U=0;if(this.Ph.length<this.zJ){var Q=new C(this.createElement("div"),this.nd,N);Q.t9(this.LZ);this.Ll&&!this.HH&&0<this.Ph.length?this.GA.insertBefore(Q.element,this.GA.firstChild):(this.GA.appendChild(Q.element),U=this.Wm.length);Array.add(this.Wm,Q)}else this.Ll&&!this.HH?Q=this.Wm[0]:(U=this.Wm.length-1,Q=this.Wm[U]),Q.$B(N);Q.show();this.Kja[N.clientId]=Q;Array.add(this.Ph,N);this.PBc(Q,U);P&&this.LNa()}}qQ(N){const P=this.s5b();P&&this.eY();this.v2a(N);this.Ph.length>=this.zJ&&this.Wm.length<
this.zJ&&this.G1e();0>=this.Ph.length?this.hide():P&&this.LNa()}dnd(){}v2a(N){var P=this.fma(N);0>P||(N=this.Ph[P],Array.removeAt(this.Ph,P),P=this.Kja[N.clientId],delete this.Kja[N.clientId],P.qQ(N.clientId),this.PBc(P),0>=P.gQ&&(this.GA.removeChild(P.element),Array.remove(this.Wm,P),P.dispose()))}BRb(){}G1e(){var N=this.rje();!N||1>=N.Oca.length||(N=Array.clone(this.Ph),N.forEach(P=>{this.v2a(P.clientId)}),N.forEach(P=>{this.$B(P)}))}fma(N){for(let P=0;P<this.Ph.length;P++)if(this.Ph[P].clientId===
N)return P;return-1}rje(){return this.Ll&&!this.HH?this.Wm[0]:this.Wm[this.Wm.length-1]}position(N,P){this.element.style.top=P+"px";this.element.style.left=N+"px"}wob(){for(let N=0;N<this.Wm.length;N++)this.Wm[N].show()}eY(){for(let N=0;N<this.zJ;N++)this.qx[N].hide();this.ska=!1}kMa(N,P=0){if(N)if(this.wVb=N,this.HH){const U=this.A5;if(1<N.Oca.length)this.qx[P].show(N.Oca,U,this.height-this.A5);else{const Q=this.GA.children.length;for(let G=0;G<this.GA.children.length;G++)N.element===this.GA.children[G]&&
this.qx[P].show(N.Oca,U,this.height-(Q-G)*this.YNa+2)}}else this.qx[P].show(N.Oca,this.width,0)}dXc(N){N=B.Tac(N);let P=!1;for(const U of this.qx)if(D.a.GXa(U.element,N)){P=!0;break}return this.GA!==N&&D.a.GXa(this.GA,N)||P}PBc(N,P=0){const U=this.Ute(N);U&&0>=N.gQ?this.qx[P].hide():U?this.kMa(N):this.qx[P].hide()}H9b(N){let P=0;for(const U of this.Wm){if(N===U)return P;P++}return-1}Ute(N){const P=this.H9b(N);return!!this.A2b&&N===this.A2b&&-1!==P&&this.qx[P].visible}mxc(N){this.zJ=N===this.A5?1:
Math.floor(N/this.YNa);this.HH?(this.element.style.height=N+"px",this.element.style.width=this.A5+"px"):(this.element.style.width=N+"px",this.element.style.height=this.A5+"px")}static E$b(){return String.format("{0}-{1}","presencetooltip",B.DQa++)}static Tac(N){N=N.hc.rawEvent;return N.relatedTarget||N.toElement}}B.DQa=0;Object(L.a)(B,"PresenceTooltipControl",e.a,[536,106]);var H=d(240),K=d(319),A=d(285);d.d(V,"a",function(){return W});class W{constructor(N){this.nd=N;this.nd.u0(10,H.a.instance);
this.nd.u0(9,A.a.instance);this.nd.u0(6,16);this.nd.u0(13,K.a.instance)}G7d(N,P){return new B(N,P,this.nd)}J6b(N){return new B(N,16,this.nd)}}Object(L.a)(W,"PresenceTooltipFactory",null,[531])},1314:function(L,V,d){d.r(V);var k=d(0),e=d(395),n=d(18),r=d(75),w=d(80),D=d(36),y=d(3);class m{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd=!1){this.rPa=null;this.MLd=!0;this.gTd=this.XT=this.kId=null;this.Ma=new r.a;this.X8j=()=>{this.yEf.result&&this.GCf.result&&(this.XT=this.yEf.result,this.gTd=this.GCf.result,
this.XT.vOc(this.qrc),this.kId=new w.a(2,2,this.oof,this.Ygm,88),m.je.Jb(this.kId))};this.qrc=(ue,Ee)=>{(this.MLd||this.etl(Ee.DUb))&&m.je.G7(this.kId,0)};this.Ygm=ue=>{var Ee=this.XT.juj();if(Ee){var Xe=new Date,Sd=!1;if(this.MLd){this.rPa=Ee;this.MLd=!1;var ad=this.rPa;for(var af in ad){Ee=af;var pf=ad[af];pf.xFb<Xe&&(Xe=pf.xFb);2===pf.status&&(Sd=!0,this.gTd.jvd(Ee))}Sd&&this.hAh();m.je.G7(ue,this.Nlg(Xe))}else{pf=new n.a;af=!1;var xf=this.rPa;for(ad in xf){xf=ad;if(!(xf in this.rPa)||this.Bji.clientId===
xf)continue;var gf=this.rPa[xf];const me=Ee[xf];if(gf&&me){gf=gf.status;const ag=me.status;2===gf&&1===ag?(pf.add(xf),e.ULS.sendTraceTag(38052609,392,50,xf+" returned from away")):1===gf&&2===ag&&(af=Sd=!0,this.gTd.jvd(xf),e.ULS.sendTraceTag(38052610,392,50,xf+" went away"));1===ag&&me.xFb<Xe&&(Xe=me.xFb)}}this.rPa=Ee;m.je.G7(ue,this.Nlg(Xe));(0<pf.count||Sd)&&this.hAh();0<pf.count&&!this.wmi?(ue=this.Fwj(pf),this.lam(ue)):ue=new n.a;(af||0<ue.count)&&this.Cli(D.a.Q$a,2)}}};this.Bji=Za;this.yEf=Kb;
this.GCf=Ic;this.FCf=Hc;this.oof=Id;m.je=jd;this.Cli=ze;this.iRa=Ie;this.wmi=Cd;y.Task.WAA(Kb,Ic).continueWith(this.X8j)}hAh(){this.Ma.raiseEvent("u",null,this)}etl(Za){for(const Ic in Za){var Kb=this.FCf.Vmg({key:Ic,value:Za[Ic]});if(Kb&&Kb.clientId&&(Kb=Kb.clientId.toLowerCase(),(Kb=this.rPa[Kb]||this.rPa[Kb.toUpperCase()])&&2===Kb.status))return!0}return!1}lam(Za){if(Za.count)for(const Kb of Za)Za=this.iRa.YEa(String.format(CommonUIStrings.l_EditorsToastArriving,Kb),!1),Za.image=5,Za.Hfa="CoAuth_AuthorStatus_16x16x32",
this.iRa.Ei(Za)}Fwj(Za){const Kb=this.XT.zZc(),Ic=new n.a;for(const Hc in Kb){const jd={key:Hc,value:Kb[Hc]};if(Za.contains(jd.key)){const Id=this.FCf.Vmg(jd);Id&&(Ic.add(Id.userName),Za.remove(jd.key))}}Ic.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return Ic}Nlg(Za){return Math.max(Za.getTime()+this.oof-(new Date).getTime(),0)}}m.je=null;Object(k.a)(m,"AwayManager",null,[]);var C=d(588),E=d(25),F=d(54),B=d(255),H=d(718),K=d(68),A=d(1192),W=d(7),N=d(1104),P=d(1031),
U=d(1053),Q=d(719),G=d(191),Y=d(1030),ba=d(28),ha=d(460),ka=d(212),ca=d(27),ia=d(803),oa=d(46),sa=d(1264),Ca=d(19),Ta=d(976),R=d(384),Ha=d(40),da=d(57);class Ba{constructor(Za,Kb){this.shapeNode=Za;this.nUh=Kb}}Object(k.a)(Ba,"ShapeNodeStartEditingNotificationTracking",null,[]);class za{constructor(Za,Kb,Ic,Hc,jd="",Id=""){if(!Za||!Kb||0>Ic)throw Error.argumentNull("LockEntry");this.Cy=Za;this.PC=Kb;this.hha=Ic;this.KMk=Hc;this.ndh=jd;this.edh=Id;this.n_g=new Date}get clientId(){return this.Cy}get cBd(){return this.PC}get shapeId(){return this.hha}get lockType(){return this.KMk}get WWh(){return this.ndh}get IWh(){return this.edh}get dGg(){return!oa.a.Ta(this.edh)&&
!oa.a.Ta(this.ndh)}get fIg(){return this.n_g}set fIg(Za){this.n_g=Za}}Object(k.a)(za,"LockEntry",null,[]);class Aa{constructor(Za,Kb,Ic,Hc,jd="",Id=""){this.clientId=Za;this.slideId=Kb;this.shapeId=Ic;this.lockType=Hc;this.rowId=jd;this.cellId=Id}}Object(k.a)(Aa,"SerializableLockData",null,[]);var na=d(187),la=d(219);class va{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee,Xe,Sd,ad,af,pf,xf,gf,me,ag,de,wa){this.MSj=new C.a("",ResourceStrings.L_GhostUserName,Ta.a.O3f,new ia.a(1));this.JIb={};this.KIb=
{};this.IIb={};this.TZg=ba.App.Xn;this.zKe=null;this.UNe={};this.xad={};this.Aad={};this.UZg=ba.App.Xn;this.Xch=!0;this.j1g=this.m0g=0;this.Qgd=(new Date(0)).getTime();this.Rgd=(new Date(0)).getTime();this.Bmc=(new Date(0)).getTime();this.dMe=(new Date(0)).getTime();this.Wch=!1;this.gZa=Za;this.AF=Kb;this.TIb=Ic;this.snc=Hc;this.Yb=jd;this.zb=Id;this.oa=ze;this.uDe=Ie;this.ns=Cd;this.Ga=ue;this.Cc=Ee;this.Jmc=Xe;this.PDe=Sd.$Ag;this.Kt=ad;this.CZ=af;this.sa=pf;this.obh=xf;this.xd=gf;this.xd.DAi(Object(W.a)(this,
this.T9k,"onShapeViewElementRequestUpdateAuthorInfo"));(this.Jw=E.AFrameworkApplication.fa.getBooleanAppSetting("PPTCanvasPresenceBubbleUXEnabled"))&&this.oa.AG(Object(W.a)(this,this.oE,"onSelectionChanged"));this.snc.fEa(Object(W.a)(this,this.Orc,"onUpdateNotificationReceived"));this.aUk=me;this.gf=ag;this.XSk=de;this.Ba=Sd;this.f0a=wa;this.d9j()}d9j(){ca.a.J(509219588,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.PDe,this.Kt.aEk());this.Kt.I$d||
(0<this.Kt.zmb?this.zb.Jb(new w.a(2,2,this.Kt.zmb,Object(W.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):ca.a.J(509219587,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Kt.$Sb?(this.zb.Jb(new w.a(2,2,this.Kt.$Sb/2,Object(W.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.Xch=!1):ca.a.J(509219586,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Kt.rdc?this.zb.Jb(new w.a(2,2,this.Kt.rdc,
Object(W.a)(this,this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):ca.a.J(509219585,804,50,"IME typing lock notification disabled"),0<this.Kt.Xjb?this.zb.Jb(new w.a(2,2,this.Kt.Xjb,Object(W.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):ca.a.J(509219584,804,50,"Lock leack detection is disabled"),this.uDe.addHandler(R.a.mZf,(Za,Kb)=>{this.mXi(Kb)}),this.Kt.yVc||this.Pzc||(this.Jmc.bEa(Object(W.a)(this,this.slh,"onBeforeParagraphNodePropertyChanged")),0<this.Kt.Ypb?this.zb.Jb(new w.a(2,
2,this.Kt.Ypb,Object(W.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):ca.a.J(509219555,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.Pzc&&(this.XSk.bEa(Object(W.a)(this,this.kqd,"onTableCellNodePropertyChanged")),this.Jmc.bEa(Object(W.a)(this,this.slh,"onBeforeParagraphNodePropertyChanged")),this.aUk.initialize(),0<this.Kt.Ypb&&this.zb.Jb(new w.a(2,2,this.Kt.Ypb,Object(W.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),
90,"76")),0<this.Kt.zmb&&this.zb.Jb(new w.a(2,2,this.Kt.zmb,Object(W.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get Pzc(){return this.Kt.jbe&&this.Kt.B8f}removeExpiredLock(){var Za=la.a(this.JIb);for(const Kb of Za){Za=Object(sa.a)(178,this.JIb[Kb]);if(!Za){delete this.JIb[Kb];continue}const Ic=Za.shapeNode;Ic&&Ic.isConnected?this.CZ.Lig(Ic)||this.gtd(Kb)||(delete this.JIb[Kb],this.CZ.fac(Ic)||Za.hm?ca.a.J(509219554,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.b1h(Za)):delete this.JIb[Kb]}}removeExpiredTableCellLock(){var Za=la.a(this.KIb);for(const Kb of Za){Za=Object(sa.a)(1676,this.KIb[Kb]);if(!Za){delete this.KIb[Kb];continue}const Ic=Za.tableCellNode;Ic&&Ic.isConnected?oa.a.Ta(this.CZ.S$b(Ic))&&!this.gtd(Kb)&&(delete this.KIb[Kb],this.c1h(Za)):delete this.KIb[Kb]}}detectLockLeak(){const Za=[],Kb=new Date,Ic=this.Cqg();for(const Hc of Ic)Hc.Mq&&+Kb-+Hc.G$c>this.Kt.Xjb&&Za.push(Hc.shapeNode.ln);0<Za.length&&ca.a.J(509219553,828,15,"Following objects are locked longer than {0} : {1}",
this.Kt.Xjb,Za.join(";"))}switchPendingSveToFidelity(){const Za=new Date,Kb=this.Cqg();for(const Ic of Kb)Ic.Mq||Ic.shapeNode.vd&&this.Pzc||!Ic.Oo||Ic.lz||!(+Za-+Ic.Hyk>this.Kt.$Sb)||Ic.wC||Ic.ZSb()}updateLockIfImeActive(){if(this.TZg>=this.UZg&&this.zKe){const Za=this.boj(this.zKe);this.RFd(Za)&&this.gxc(Za.slideId,Za.get_shapeId(),2)}this.UZg=new Date}updateLockForActiveShapeNodes(){var Za=la.a(this.xad);for(const Kb of Za)Za=Object(sa.a)(4,this.xad[Kb]),this.RFd(Za)&&this.gxc(Za.slideId,Za.get_shapeId(),
3);this.xad={}}updateLockForActiveTableCellNodes(){var Za=la.a(this.Aad);for(const Kb of Za)if(Za=Object(sa.a)(650,this.Aad[Kb]),this.RFd(Za)){const Ic=this.Ga.Gn(Za);this.gxc(Ic.slideId,Ic.get_shapeId(),3,Za.rowId.toString(),Za.cellId.toString())}this.Aad={}}boj(Za){return(Za=this.ns.aK(Za))?this.Ga.Gn(Za.eb):null}slh(Za,Kb){Kb&&Kb.node?(Za=Object(sa.a)(5,Kb.node),Za)?Za.loading||Za.Utc||Kb.property.id!==Ha.a.np.id||(Kb=this.Ga.sfa(Za),Za=this.Cc.NGa(Za),Kb&&(Za?(Kb=this.TZc(Kb.slideId,Kb.get_shapeId(),
Za.rowId.toString(),Za.cellId.toString()),this.Aad[Kb]=Za):(Za=this.SBb(Kb.slideId,Kb.get_shapeId()),this.xad[Za]=Kb))):ca.a.J(509219551,828,10,"Invalid argument."):ca.a.J(509219552,828,10,"Invalid argument.")}EKl(Za){const Kb=new w.a(2,1,this.Kt.sBd,Object(W.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");Kb.gu=new Ba(Za,!1);this.zb.Jb(Kb);this.UNe[this.SBb(Za.slideId,Za.get_shapeId())]=Kb}rtcNotifyStartEditing(Za){Za=Object(sa.a)(Ba,Za.gu);const Kb=Za.shapeNode;this.RFd(Kb)&&
this.ark(Kb)&&this.gxc(Kb.slideId,Kb.get_shapeId(),1);Za.nUh=!0}RFd(Za){return Za?Za.isConnected:!1}ark(Za){return(Za=this.ik(Za))?Za.qK:!1}ik(Za){return Object(sa.a)(178,Za.vg(this.Yb.yo.Na))}Cqg(){const Za=[];if(!this.sa.Aa)return Za;var Kb=this.sa.Aa.yj();if(!Kb)return Za;for(const Ic of Kb)(Kb=this.ik(Ic))&&!Kb.hm?Za.push(Kb):ca.a.J(509219549,828,50,"Shape {0} on active slide doesn't have valid view element",Ic.ln);return Za}J9k(Za){this.vQh(Za)&&(this.gZa.amIAlone||this.EKl(Za))}oE(Za,Kb){for(Za=
0;Za<Kb.LF.length;Za++){const Hc=Kb.LF[Za];var Ic=Object(sa.a)(4,Hc.context.node);Ic&&Ic.isConnected&&(Ic=Object(sa.a)(178,Ic.sc(this.gf)))&&(Ic=this.obh.dK(Ic.shapeNode))&&(1===Hc.Mea?Ic.$pc():0===Hc.Mea&&Ic.RRe())}}I9k(Za){if(this.vQh(Za)&&!this.Kt.wVc){var Kb=this.SBb(Za.slideId,Za.get_shapeId()),Ic=Object(sa.a)(w.a,this.UNe[Kb]);if(Ic){const Hc=Object(sa.a)(Ba,Ic.gu);this.zb.Vg(Ic);Hc&&Hc.nUh&&this.gxc(Za.slideId,Za.get_shapeId(),4);this.UNe[Kb]=null}}}T9k(Za,Kb){this.Qqh(Kb.Vx)}Qqh(Za){Za.hK()||
Za.shapeNode.reb?this.Vui(Za):this.Rqh(Za)}kqd(Za,Kb){if((Kb=Object(sa.a)(na.TableCellNode,Kb.node))&&(Za=Object(sa.a)(1676,Kb.vg(this.gf)))&&Kb.isConnected){Kb=this.CZ.S$b(Kb);const Ic=this.X_e(Za.tableCellNode);oa.a.Ta(Kb)?Ic?(this.oAe(Za,this.Bma(Ic.clientId,va.Vae)),this.Hhf(Za)):oa.a.Ta(Kb)&&(this.X_e(Za.tableCellNode)||this.c1h(Za)):(this.oAe(Za,this.Bma(Kb,va.Vae)),this.Hhf(Za))}}oAe(Za,Kb){Za.lock(Kb)}c1h(Za){Za.unlock()}gxc(Za,Kb,Ic,Hc="",jd=""){try{const Id=new Aa(this.TIb,Za.CCc,Kb,Ic,
Hc,jd);this.snc.gca(7,Id)}catch(Id){ca.a.J(509219548,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.TIb,Id.stack)}}Orc(Za,Kb){this.Ba.pptCoauthSurveyFloodgateEnabled&&!this.Wch&&8===Kb.type&&this.f0a&&this.KZl(Kb)&&(ca.a.J(509219547,814,50,"Log coauth activity"),this.Wch=!0,this.f0a.continueWith(()=>{this.f0a.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===Kb.type&&((Za=Kb.zBa)?Za.clientId===this.TIb?ca.a.J(509219545,828,15,"Lock notification : lock notification from myself recieved"):
(ca.a.J(509219544,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Za.clientId,this.TIb),Za=new za(Za.clientId,Za.slideId,Za.shapeId,Za.lockType,Za.rowId,Za.cellId),this.jvi(Za),this.aml(Za)):ca.a.J(509219546,828,10,"Lock notification: invalid lock data recieved"))}Rqh(Za){if(!Za||Za.hm)ca.a.J(509219543,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Za);else{var Kb=Za.shapeNode;if(!(Kb.ig||this.PDe&&Kb.vd&&(this.Kt.Wyb||this.Pzc))){var Ic=this.CZ.fac(Kb);Ic?this.F$c(Za,
this.Bma(Ic,va.Vae)):(Kb=this.CZ.Lig(Kb))?(this.F$c(Za,this.Bma(Kb,va.hfj)),this.Ghf(Za)):(Kb=this.X_e(Za.shapeNode))?(this.F$c(Za,this.Bma(Kb.clientId,this.Kie(Kb.lockType))),this.Ghf(Za)):Za.Mq&&this.b1h(Za)}}}b1h(Za){const Kb=this.obh.dK(Za.shapeNode);Kb&&(Kb.oFd(null),Za.unlock(this.Xch||!Kb.Ine))}F$c(Za,Kb){Za.lock(Kb);Za.hK()&&this.oa.Bh()}KZl(Za){if(!Za||null===Za.zBa)return!1;Za=this.mel(Za.zBa);for(const Kb of Za)Kb&&Kb.clientId&&(Kb.clientId.toLowerCase()===this.TIb.toLowerCase()?(this.m0g++,
this.Qgd=this.Qgd===(new Date(0)).getTime()?(new Date).getTime():this.Qgd,this.Rgd=(new Date).getTime()):this.Olk(Kb.clientId)||(this.j1g++,this.Bmc=this.Bmc===(new Date(0)).getTime()?(new Date).getTime():this.Bmc,this.dMe=(new Date).getTime()));return 5<=this.m0g&&5<=this.j1g&&(this.dMe>=this.Qgd&&this.Bmc<=this.Rgd||this.Rgd>=this.Bmc&&this.Rgd<=this.dMe)&&1<=this.AF.GBb()?!0:!1}mel(Za){let Kb=null;try{Kb=Za}catch(Ic){}if(null===Kb||!Kb.length){let Ic=null;try{Ic=Za}catch(Hc){ca.a.J(509219541,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==Ic)return[Ic]}return Kb}Olk(Za){Za=this.Bma(Za);const Kb=this.Bma(this.TIb);return Za&&Kb&&Za.userName===Kb.userName&&Za.email===Kb.email?!0:!1}Kie(Za){switch(Za){case 1:return va.f5l;case 2:return va.y7j;case 3:return va.bfm;case 4:return va.Agj}ca.a.J(509219539,828,10,"Unknown lock type");return"Unknown lock type"}jvi(Za){if(Za&&Za.cBd){var Kb=Za.dGg?this.TZc(new da.a(Za.cBd),Za.shapeId,Za.WWh,Za.IWh):this.SBb(new da.a(Za.cBd),Za.shapeId);
if(4===Za.lockType)this.IIb[Kb]=Za;else{var Ic=Object(sa.a)(za,this.IIb[Kb]);Ic?(Ic=this.Jie(Ic),this.Jie(Za)>Ic&&(this.IIb[Kb]=Za)):this.IIb[Kb]=Za}}}Jie(Za){return this.SEj(Za.lockType)-(+new Date-+Za.fIg)}SEj(Za){switch(Za){case 1:return this.Kt.rBd;case 2:return this.Kt.x4c;case 3:return this.Kt.sEd;case 4:return this.Kt.zzb}ca.a.J(509219536,828,10,"Unknown lock type");return 0}X_e(Za){if(Object(Ca.a)(4,Za)){Za=Object(sa.a)(4,Za);if(!Za.slideId)return null;Za=this.SBb(Za.slideId,Za.get_shapeId());
return this.gtd(Za)}if(Object(Ca.a)(650,Za)){Za=Object(sa.a)(650,Za);const Kb=this.Ga.sfa(Za);if(!Kb.slideId)return null;Za=this.TZc(Kb.slideId,Kb.get_shapeId(),Za.rowId.toString(),Za.cellId.toString());return this.gtd(Za)}return null}gtd(Za){if(!Za)return null;const Kb=Object(sa.a)(za,this.IIb[Za]);return Kb?0>=this.Jie(Kb)?this.IIb[Za]=null:Kb:null}Ghf(Za){const Kb=this.cMj(Za);Kb&&(this.JIb[Kb]=Za)}Hhf(Za){const Kb=this.NOj(Za);Kb&&(this.KIb[Kb]=Za)}cMj(Za){return Za?this.SBb(Za.shapeNode.slideId,
Za.shapeNode.get_shapeId()):null}NOj(Za){if(!Za)return null;Za=Za.tableCellNode;const Kb=this.Ga.sfa(Za);return this.TZc(Kb.slideId,Kb.get_shapeId(),Za.rowId.toString(),Za.cellId.toString())}SBb(Za,Kb){return String.format("{0}#{1}#{2}",Za.sid,Za.cid,Kb)}TZc(Za,Kb,Ic,Hc){return String.format("{0}#{1}#{2}#{3}#{4}",Za.sid,Za.cid,Kb,Ic,Hc)}qlk(Za){const Kb=Object(sa.a)(205,this.sa.Aa);return Kb&&da.a.QSh(Za.cBd,Kb.Fb.CCc)?!0:!1}aml(Za){if(this.qlk(Za)){var Kb=Za.shapeId,Ic=Za.clientId;this.sa.Aa&&(Kb=
this.sa.Aa.ER(Kb))&&(Za.dGg&&this.Kt.jbe?this.nml(Za,Ic,Kb):this.hml(Za,Ic,Kb))}}hml(Za,Kb,Ic){Ic.ig||this.PDe&&Ic.vd&&(this.Kt.Wyb||this.Pzc)||!(Ic=this.ik(Ic))||(this.F$c(Ic,this.Bma(Kb,this.Kie(Za.lockType))),this.Ghf(Ic))}nml(Za,Kb,Ic){if((Ic=this.POj(Ic,Za.WWh,Za.IWh))&&Ic.isConnected){var Hc=Object(sa.a)(1676,Ic.vg(this.gf));Hc&&oa.a.Ta(this.CZ.S$b(Ic))&&(this.oAe(Hc,this.Bma(Kb,this.Kie(Za.lockType))),this.Hhf(Hc))}}POj(Za,Kb,Ic){Za=this.Cc.XO(Object(sa.a)(4,Za));if(!Za)return null;var Hc=
this.Cc.Gma(Za);Za=null;for(const jd of Hc){Hc=this.Cc.Scb(jd);for(const Id of Hc)if(Id.rowId.toString()===Kb&&Id.cellId.toString()===Ic){Za=Id;break}}return Za}Vui(Za){const Kb=new w.a(0,1,0,()=>{this.Rqh(Za)},90,"79");this.zb.Jb(Kb)}mXi(Za){this.TZg=new Date;this.zKe=this.knj(Za.Ec)}knj(Za){return Za?Za.querySelector(".Paragraph"):null}Bma(Za,Kb=""){const Ic=this.AF.Bma(Za);if(Ic)return Ic;ca.a.J(509219531,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Za,Kb);return this.MSj}vQh(Za){return!this.Kt.I$d&&
!(this.Kt.Wyb&&Za.vd)&&!Za.ig}}va.Vae="EditingBy";va.hfj="EditingByInSameWorker";va.f5l="StartEditing";va.Agj="EndEditing";va.y7j="ImeTyping";va.bfm="Typing";Object(k.a)(va,"CoauthStateChangesHandler",null,[1707]);class Pa{constructor(Za){this.Fwa={};this.Cy=Za.mE;this.init(Za)}init(Za){if(Za=Za.O0)for(const Kb of Za)Kb.ID!==this.Cy&&(this.Fwa[Kb.ID]=new Date)}Qti(Za){for(let Kb=0;Kb<Za.length;Kb++)Za[Kb]in this.Fwa||Za[Kb]===this.Cy||(this.Fwa[Za[Kb]]=new Date)}g6l(Za){const Kb=this.Fwa[Za];Kb&&
(ca.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Cy,Za,(new Date).getTime()-Kb.getTime()),delete this.Fwa[Za])}f6l(Za){const Kb=this.Fwa[Za];Kb&&(ca.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Cy,Za,(new Date).getTime()-Kb.getTime()),delete this.Fwa[Za])}e6l(){for(const Za of Object.keys(this.Fwa))ca.a.J(37590345,
814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Cy,Za,(new Date).getTime()-this.Fwa[Za].getTime());this.Fwa={}}}Object(k.a)(Pa,"EditorPresenceTracker",null,[1705]);class Qa{constructor(Za){this.CQk=Za;this.yN=new N.a;this.yN.Jg(this.CQk)}}Object(k.a)(Qa,"PPTRtcProvider",null,[1704]);var Ua=d(103),Ya=d(1265),Ea=d(715);class La{constructor(Za,Kb,Ic,Hc,jd){this.Cga=null;this.EV=!1;this.oDe=this.hLe=null;this.mHk=
Ua.a.create();this.Ucd=!1;this.O9b=0;this.nZ=jd;Ic.Mg&&(this.findSessionResponse=Za,Hc.nMf(Object(W.a)(this,this.UNl,"sessionPropertiesChanged")));this.fJa=new Ya.a(()=>Kb())}get findSessionResponse(){return this.Cga}set findSessionResponse(Za){if(this.EV)ca.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.Cga=Za)this.EV=!0,this.hLe=this.Cga.dZf,this.oDe=this.Cga.kC}get qpa(){return this.EV?this.hLe:
this.fJa.value.qpa}set qpa(Za){this.EV?this.hLe=Za:this.fJa.value.qpa=Za}w8e(Za){this.fJa.value.w8e(Za)}get kC(){return this.EV?this.oDe:this.fJa.value.kC}set kC(Za){this.EV?this.oDe=Za:this.fJa.value.kC=Za}W_c(){let Za;ca.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.EV,this.Ucd);return this.EV?(Za=this.Cga.correlationId||this.mHk.toString(),ca.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",
Za),{returnValue:String.format("{0}&{1}={2}",this.Cga.B7,E.AFrameworkApplication.h7d,oa.a.We(Za)),correlationId:Za}):this.Ucd?this.fJa.value.W_c():(ca.a.J(51140183,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}jke(Za,Kb,Ic,Hc,jd){ca.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.EV);this.EV?(Za(this.Cga.h6b),Ic(new Ea.a(this.Cga.mmd,this.Cga.jmd,this.Cga.imd,
this.Cga.P2c))):(this.fJa.value.jke(Za,Kb,Ic,Hc,jd),this.Ucd=!0);this.nZ&&this.nZ.Ei(26,!this.Ucd)}cae(){ca.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.EV);this.EV?this.EV=!1:this.fJa.value.cae()}Hpa(Za,Kb){ca.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.EV);this.EV||this.fJa.value.Hpa(Za,Kb)}UNl(){ca.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",
this.EV);this.EV=!1}}Object(k.a)(La,"PptAssignRtcMachineStrategy",null,[708]);var xb=d(1216);class dc{constructor(){this.Ho=null}h3b(Za,Kb){this.Ho||(this.Ho={});this.Ho[Kb]||(this.Ho[Kb]=0);this.Ho[Kb]+=Za}getData(){return this.Ho}reset(){this.Ho=null}}Object(k.a)(dc,"MultiSumDataAggregator",null,[613]);class gb{constructor(Za,Kb){this.HHd=xb.a.XX(Za,Kb,new dc,!0)}Uf(Za){this.HHd.track(1,Za)}}Object(k.a)(gb,"MultiCounter",null,[796]);class gc{constructor(Za,Kb,Ic,Hc){this.sA=Za;this.N6=Kb;this.GTk=
Ic;this.oKk=Hc;this.sA.fEa(Object(W.a)(this,this.xIl,"rtcOnUpdateNotificationReceived"))}xIl(Za,Kb){0===Kb.type&&(this.oKk.Uf("CU"),this.GTk||this.HG())}HG(){!E.AFrameworkApplication.Dh&&this.N6.AY&&this.N6.HG(null,null,null)}}Object(k.a)(gc,"ContentNotificationManager",null,[]);class Ac extends gc{constructor(Za,Kb,Ic,Hc){super(Za,Kb,Ic,Hc)}static init(){if(ba.App.Ob){var Za=ba.App.Ob.ie;if(Za&&(Za.mLf(Ac.blh),Za=Za.qj)&&(Za=Za.Fq)){var Kb=ba.App.ni;if(Kb&&Kb.qy&&(Kb=F.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var Ic=
E.AFrameworkApplication.fa.getBooleanAppSetting("Box4ThrottleInboundRequests"),Hc=new gb(11,1);Ac.pbd=Ac.pbd||new Ac(Kb,Za,Ic,Hc);Ac.pbd.HG()}}}}static blh(Za){Ac.pbd||(Za.CDh(Ac.blh),Ac.init())}}Ac.pbd=null;Object(k.a)(Ac,"PptContentNotificationManager",gc,[]);var $b=d(104),jc=d(310),pb=d(97),$a;(function(Za){Za[Za.TDm=0]="signalRConnectFailed";Za[Za.Lum=1]="findSessionFailed"})($a||($a={}));Object(k.b)("RtcConnectFailureType",$a);var zc=d(262),rb=d(30);class ib{constructor(Za,Kb,Ic,Hc,jd,Id){this.Zgd=
this.z0g=this.Yhb=this.Xhb=0;this.Hhb=this.KJa=this.woa=this.Dlc=this.pdd=this.U1=null;this.Qdd=this.Sdd=this.Tdd=this.Odd=this.Pdd=!1;this.xah=Za;this.Wj=Kb;this.jZ=Ic;this.jZ.SZd(Object(W.a)(this,this.lMb,"onNetworkHealthStateChanged"));this.Hk=Hc;this.PNe=Id;$addHandler(window,"visibilitychange",Object(W.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.pRk=jd;this.pRk.tAi(Object(W.a)(this,this.e9k,"onRtcConnectFailed"))}lMb(Za,Kb){Kb.xwe||(this.Sdd=this.Tdd=!0)}onVisibilityChange(){window.document.hidden&&
(this.Odd=this.Pdd=!0)}e9k(Za,Kb){Za=Kb.Glj;if(Kb=Kb.errorMessage){if(0===Za){const {Foe:Ic,Goe:Hc,Ni:jd}=G.RtcUtils.oag(Kb.ErrorDetails);Kb.HttpErrorCode=Ic;Kb.HttpErrorStatus=Hc;Kb.Exception=jd;delete Kb.ErrorDetails;if(!Ic&&this.PNe&&0<this.PNe.length)try{let Id=!0;const ze=window.location.hostname.toLowerCase();for(const Ie of this.PNe.split(";"))if(ze.endsWith(Ie)){Id=!1;break}Kb.IsCORS=Id.toString()}catch(Id){Kb.Unexpected=Id.message}}ca.a.J(508946247,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",
this.Wj.amIAlone,window.document.hidden,this.Hk.QR,$a[Za],$b.a.toJSON(Kb));this.Qdd||(this.Qdd=this.bqk(Za,Kb))}}bqk(Za,Kb){const Ic=zc.c(Kb,"HttpErrorCode",-1);return 500<=Ic&&599>=Ic||1===Za&&"FindSessionRequestFailed"!==Kb.FindSessionFailureReason?!0:!1}yug(){return this.U1&&1===this.Yhb?this.Pdd||this.Tdd:this.woa&&1<this.Yhb?this.Odd||this.Sdd:!1}xug(){return this.woa&&0<this.Zgd?this.Odd||this.Sdd:this.U1&&0<this.Xhb?this.Pdd||this.Tdd:!1}Dud(){this.Xhb++;this.Dlc=new Date;this.U1||(this.U1=
new Date,this.Pdd=window.document.hidden,this.Tdd=!this.Hk.QR)}L1e(){this.MAh(0)}MAh(Za){this.Yhb++;this.KJa=new Date;this.pdd?this.HSc>this.xah.THh&&(Za={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.Yhb,["numberOfConnectionAttempts"]:this.Xhb,["firstConnectionAttempt"]:this.U1?this.U1.toISOString():"",["lastConnectionSuccess"]:this.KJa?this.KJa.toISOString():"",["lastUnexpectedDisconnect"]:this.woa?this.woa.toISOString():"",["lastExplicitDisconnect"]:this.Hhb?this.Hhb.toISOString():
"",["reconnectDurationInMs"]:this.HSc,["hasPageHiddenOrNetworkIssue"]:this.yug()},ca.a.J(36804373,500,15,$b.a.toJSON(Za))):(this.pdd=this.KJa,jc.a.instance.Xb("FirstPresenceUpdated",(new Date).getTime().toString()),this.HSc>this.xah.THh&&(Za={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.Xhb,["firstConnectionAttempt"]:this.U1?this.U1.toISOString():"",["firstConnectionSuccess"]:this.pdd?this.pdd.toISOString():"",["lastExplicitDisconnect"]:this.Hhb?this.Hhb.toISOString():
"",["connectDurationInMs"]:this.HSc,["connectionDurationFromStopWatchInMs"]:Za,["hasPageHiddenOrNetworkIssue"]:this.yug()},ca.a.J(36804373,500,15,$b.a.toJSON(Za))))}Eud(){this.z0g++;const Za={["numberOfFailedConnections"]:this.z0g,["numberOfConnectionAttempts"]:this.Xhb,["firstConnectionAttempt"]:this.U1?this.U1.toISOString():"",["lastConnectionAttempt"]:this.Dlc?this.Dlc.toISOString():"",["lastExplicitDisconnect"]:this.Hhb?this.Hhb.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),
["disconnectedDurationMs"]:this.b6f,["hasPageHiddenOrNetworkIssue"]:this.xug()};this.Qdd?(e.ULS.sendTraceTag(508946246,500,15,$b.a.toJSON(Za)),this.YAh("ClientRTCSetupFailureDueToServerError")):(e.ULS.sendTraceTag(36804375,500,15,$b.a.toJSON(Za)),this.YAh("ClientRTCSetupFailureDueToClientError"))}YAh(Za){!this.xug()&&5E3<this.b6f&&rb.a("ClientRTCSetupFailureQoSErrorEnabled")&&pb.Health.instance.recordQosError(Za,["PresenceExperienceDegraded"],!1,!0,!0,!1,null)}gvc(){this.Zgd++;this.woa=new Date;this.Odd=
window.document.hidden;this.Sdd=!this.Hk.QR}Otl(){this.AYl()&&this.Eud();this.Hhb=new Date;this.gUi()}gUi(){this.Zgd=this.Yhb=this.Xhb=0;this.KJa=this.woa=this.Dlc=this.U1=null;this.Qdd=!1}AYl(){return!!this.Dlc&&!this.KJa&&!this.woa}get HSc(){if(this.KJa){if(this.U1&&1===this.Yhb)return this.Wj.b_c(this.U1,this.KJa);if(this.woa&&1<this.Yhb)return this.Wj.b_c(this.woa,this.KJa)}return 0}get b6f(){return this.woa&&0<this.Zgd?this.Wj.b_c(this.woa,new Date):this.U1&&0<this.Xhb?this.Wj.b_c(this.U1,new Date):
0}}Object(k.a)(ib,"PptRealtimeChannelMetrics",null,[1706]);var Vb=d(76),Od=d(33),jb=d(38);class Wb{constructor(Za,Kb,Ic,Hc,jd){this.wNk=Za.toLowerCase();this.RJa=Kb;this.zm=Ic;this.Qs=Hc;this.xq=jd;this.Qs.Pka(Object(W.a)(this,this.Brc,"onShapeNodeLoaded"));this.xq.sMf(Object(W.a)(this,this.Drc,"onShapeViewElementUnlocked"))}dispose(){this.Qs.x2a(Object(W.a)(this,this.Brc,"onShapeNodeLoaded"));this.xq.yEh(Object(W.a)(this,this.Drc,"onShapeViewElementUnlocked"))}zD(Za){return this.g_i(Za)||this.TZf(Za)}TZf(Za){if(!Za||
Za.ig)return!1;const Kb=Za.ra(jb.a.Uae,"");return+new Date-+Za.G$c<this.RJa&&!!Kb&&Kb.toLowerCase()!==this.wNk}g_i(Za){return!!this.fac(Za)}Lig(Za){let Kb="";Za&&this.TZf(Za)&&(Kb=Za.$a(jb.a.Uae));return Kb}fac(Za){return Za?Za.ra(jb.a.Q7f,""):""}S$b(Za){return Za?Za.ra(jb.a.KQi,""):""}jkm(Za){if(Za&&(Za.zD=this.zD(Za),Za.anchor)){const Ic=this.zm.eua(Za);for(;Ic.moveNext();){var Kb=Ic.currentNode;Od.ParagraphReader.ke(Kb)&&(Kb=Object(sa.a)(Vb.AParagraphNode,Kb))&&(Kb.zD=Za.zD)}}}Drc(Za,Kb){this.jkm(Kb.Vx.shapeNode)}Brc(Za,
Kb){Za=Kb.node;Za.bjm();Za.zD=this.zD(Za)}}Object(k.a)(Wb,"PptWetChangeHandler",null,[1703,106]);class qb{constructor(Za){this.bQk=Za}l5(){return this.bQk.l5()}}Object(k.a)(qb,"PresenceCache",null,[]);var Ga=d(679),cb=d(1190),Ob=d(1288),Db=d(1061),mb=d(1277);class Vc extends r.a{constructor(){super();this.Zhd=[]}Mka(Za){Za&&(ca.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Za.clientId,Za.presence.toString()),Array.add(this.Zhd,Za))}jvd(Za){(Za=this.adb(Za))&&
this.qPb(Za);return Za}qPb(Za){Za&&(ca.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Za.clientId,Za.presence.toString()),Array.remove(this.Zhd,Za))}adb(Za){for(const Kb of this.Zhd)if(Kb.clientId===Za)return Kb;return null}l5(){return this.Zhd}}Object(k.a)(Vc,"PresenceDataManager",r.a,[]);var Zb=d(37),fc=d(754);class ob{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee){this.clientId=Za;this.data=ze;this.chatThreadId=Kb;this.chatThreadDiscoveryUri=Ic;this.inChat=
Hc;this.email=jd;this.capabilities=Id;this.userName=Ie;this.clientType=Cd;this.fHasClientEverExperiencedNetworkLoss=ue;this.isAnonymous=Ee}}Object(k.a)(ob,"SerializablePresenceInfo",null,[]);class ub{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee){this.gnc=null;this.Cy=Za.toLowerCase();this.PC=Kb;this.TMe=Ic;this.PNg=Hc;this.ONg=jd;this.EUg=Id;this.yjc=ze;this.BNg=Ie;this.mpa=Cd;this.uah=ue;this.BRg=Ee}ske(){return new ob(this.Cy,this.PNg,this.ONg,this.EUg,this.yjc,this.BNg.capabilities,this.TMe?this.TMe.ske():
null,this.mpa,this.uah,this.BRg,E.AFrameworkApplication.jqb||E.AFrameworkApplication.YR)}N1j(Za){if(!(Za&&this.Mk.equals(Za.slideId)&&this.presence&&this.presence.mW))return!1;for(const Kb of this.presence.mW)if(Kb===Za.get_shapeId())return!0;return!1}get presence(){return this.TMe}get clientId(){return this.Cy}get chatThreadId(){return this.PNg}get chatThreadDiscoveryUri(){return this.ONg}get inChat(){return this.EUg}get email(){return this.yjc}get capabilities(){return this.BNg}get Mk(){return this.PC}get userName(){return this.mpa}get clientType(){return this.uah}get fHasClientEverExperiencedNetworkLoss(){return this.BRg}get presenceUser(){return this.gnc}set presenceUser(Za){this.gnc&&
(Za?!this.gnc.client||0===this.gnc.client||Za.client&&0!==Za.client||ca.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.Cy):ca.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.Cy));this.gnc=Za}static GTc(Za){if(!Za||!Za.clientId)return ca.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const Kb=fc.a.GTc(Za.data);let Ic=0;Za.clientType&&8>=Za.clientType&&(Ic=Za.clientType);
return new ub(Za.clientId,Kb.Mk,Kb,Za.chatThreadId,Za.chatThreadDiscoveryUri,Za.inChat,Za.email,new ia.a(Za.capabilities),Za.userName,Ic,Za.fHasClientEverExperiencedNetworkLoss)}}Object(k.a)(ub,"PresenceEntry",null,[]);class bc extends Sys.EventArgs{constructor(Za,Kb,Ic,Hc,jd,Id){super();this.PC=Za;this.sUk=Ic;this.Njd=Kb;this.mgi=Hc;this.pSk=jd;this.fQk=Id}get slideId(){return this.PC}get user(){return this.sUk}get shapes(){return this.Njd}get F$(){return this.mgi}get dTh(){return this.pSk}get twh(){return this.fQk}}
Object(k.a)(bc,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var ic=d(29);class Rc extends r.a{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee,Xe,Sd,ad,af,pf,xf,gf,me,ag,de,wa,ta,Eb,qc,Sc,td){super();this.xS=new Vc;this.Hp=null;this.GOg=[];this.HOg=null;this.PGb=!0;this.mhb=!1;this.g_g=new Date;this.p0a=null;this.LRg=this.xIk=this.STg=!1;this.Yhd=null;this.Saa=Za;Za.userName||(Za.userName=Eb);this.Lb=Kb;this.sA=Ic;this.Cy=Hc.clientId;this.nba=Hc.Xx;this.Ge=jd;this.rc=de;this.dnc=ag;this.nZ=wa;this.moa=
td;ta.execute(je=>{this.Hp=je});this.g5j();this.Wj=Sd;this.yr=ad;this.ulc=af.lqk;this.Qkc=af.podsDefaultToRtcForPresenceEnabled;this.uLk=af.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.zZg=E.AFrameworkApplication.WA;this.AJe=af.Mg&&af.pptNoRtcConnectWhenReadOnlyEnabled;this.oa=Id;this.oa.AG(Object(W.a)(this,this.oE,"onSelectionChanged"));this.tq=ze;this.tq.qBi(Object(W.a)(this,this.kal,"onValidShapeIdLoaded"));this.xd=Ie;this.xd.kU(Object(W.a)(this,this.d2k,"onActiveSlideDOMReady"));this.rF=
Cd;this.rF.NZd(Object(W.a)(this,this.Eod,"onEditorTableUpdate"));this.Ng=pf;this.Ng.aC(Object(W.a)(this,this.KF,"onSessionEnd"));this.Ng.bC(Object(W.a)(this,this.mo,"onSessionRehydrated"));this.Ng.xSa(Object(W.a)(this,this.orc,"onOutboundReplication"));this.qGk=af.pptAwayStatusTimeGapForPresenceUpdateInMs;this.ia=Ee;this.sa=ue;this.$hd=Xe;this.Acd=xf;this.Eib=gf;this.ZGb=me;af.Mg&&(this.Ng.mMf(Object(W.a)(this,this.xrc,"onSessionAccessTokenExpiring")),this.Ng.xOc(Object(W.a)(this,this.Tpa,"onSessionAccessTokenExpired")),
this.Ng.yOc(Object(W.a)(this,this.Wpd,"onSessionExpired")),this.Lb.Ue(()=>{this.Saa.userName=this.Lb.appSettings.UserName;this.Saa.email||(this.Saa.email=E.AFrameworkApplication.fa.Ea("UserPrincipalName"));this.rc.OM||(ca.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.AJe&&this.Ng.eea(Object(W.a)(this,this.Bz,"onUnifiedAppStateChanged"))}),this.zZg&&this.Ng.DOc(Object(W.a)(this,this.Qha,"onWopiTokenRefreshed")));ca.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",
this.zZg)}qb(){this.ia.pa(ic.a.f2a,Zb.a.application,Object(W.a)(this,this.f2a,"querySlidePresenceUsers"),96)}f2a(Za,Kb,Ic,Hc,jd){jd.dzc=this.mbc(jd.slideId);jd.swh=this.GBb();return 32}mbc(Za){return(Za=this.Log(Za))?Za.length:0}g5j(){this.sA.C9a(Object(W.a)(this,this.zZi,"connectionStateChanged"));this.sA.vOc(Object(W.a)(this,this.skl,"presenceUpdated"));E.AFrameworkApplication.fa.getBooleanAppSetting("PPTForceUpdateEditorTableEnabled")&&this.sA.fEa(Object(W.a)(this,this.kjm,"updateNotificationReceived"));
Q.a.getInstance().Vxi(Object(W.a)(this,this.hnh,"onGotCompletePersistentStateWithMetadata"));this.p0a=this.nba.lj("WebServiceCall","RtcConnection");this.nZ.Mhj();this.sA.connect()}qBh(){const Za=this.sA.zZc();this.m3h(new cb.a(Za,null));this.cxc()}hnh(Za,Kb){this.nZ.Phj(Kb.tkl);Q.a.getInstance().LAl(Object(W.a)(this,this.hnh,"onGotCompletePersistentStateWithMetadata"))}zZi(Za,Kb){ca.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",Rc.Fge(Kb.oldState),
Rc.Fge(Kb.newState),this.Cy);switch(Kb.newState){case 2:this.p0a.stop();Za=this.p0a.Qr;this.nZ.Lhj();this.qBh();this.dnc.MAh(Za);break;case 1:2===Kb.oldState&&this.dnc.gvc();this.dnc.Dud();break;case 0:this.PGb?this.kUi():2===Kb.oldState&&(window.setTimeout(()=>{this.sA.connect()},0),ca.a.J(512360714,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.Ge.cbc().getTime()),this.dnc.gvc())}}getSelectedShapes(){if(!this.ulc)return null;const Za=[],Kb=this.oa.Hd();for(let Ic=0;Ic<Kb.length;++Ic)Array.add(Za,
Kb[Ic].get_shapeId());0<Za.length&&Za.sort();return Za}kUi(){var Za=this.xS.l5();if(Za&&Za.length){Za=Array.clone(Za);for(const Kb of Za)this.qPb(Kb);this.raiseEvent("PresenceChanged")}}Z6e(Za,Kb){try{this.Saa.email||(this.Saa.email=E.AFrameworkApplication.fa.Ea("UserPrincipalName"));const Ic=new fc.a(Za,Kb),Hc=new ub(this.Saa.clientId,Za,Ic,this.Saa.chatThreadId,this.Saa.chatThreadDiscoveryUri,this.Saa.inChat,this.Saa.email,this.Saa.capabilities,this.Saa.userName,1,this.xIk);this.Saa.email||ca.a.J(512360713,
814,15,"PresenceManager : SendPresence; empty email for user");this.sA.Z6e(Hc.ske()).continueWith(()=>{ca.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Cy,Ic.toString(),this.Ge.cbc().getTime())});this.g_g=new Date;this.nZ.qAk();this.Ltl(Za,Kb);ca.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Cy,Ic.toString(),this.Ge.cbc().getTime());
this.oul(Ic)}catch(Ic){ca.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",Ic.toString(),this.Cy)}}skl(Za,Kb){Za=!!this.Hp&&this.Hp.S0;ca.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.Cy,Za);if(!Za){this.nZ.sAk(Kb.DUb);Za=null;this.nba&&(Za=this.nba.lj("ServerNotification","Presence Updated"));try{this.m3h(Kb)}finally{Za&&Za.stop()}}}kjm(Za,Kb){ca.a.J(512360711,
814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",Kb.type,this.Cy)}m3h(Za){this.kvi(Za.DUb);this.u2a(Za.a6f);ca.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}cxc(){this.sa.Mk?this.Z6e(this.sa.Mk,this.getSelectedShapes()):ca.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}oE(){if(this.sa.Mk){var Za=this.getSelectedShapes();
(Rc.R1j(this.HOg,this.sa.Mk)||Rc.Lne(Za,this.GOg))&&this.cxc()}else ca.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}d2k(Za,Kb){Kb.Aa?this.sa.Mk?this.cxc():ca.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):ca.a.J(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}kal(Za,Kb){this.sa.Mk?Array.contains(this.getSelectedShapes(),Kb.shapeNode.get_shapeId())&&
this.cxc():ca.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}V1l(Za,Kb,Ic){Kb=this.nhg(Kb);Za=this.nhg(Za);this.Ge.Gwj().zAc.raiseEvent(Rc.Yae,new Ob.a(this.Wj.mE,null,Kb,Za,null,0,0,Ic))}nhg(Za){const Kb=new Db.a;for(let Ic=0;Ic<Za.length;Ic++){const Hc=Za[Ic];if(!Hc)continue;if(Hc.ID===this.Wj.mE)continue;if(!Hc.EmailAddress){Kb.$(Hc.ID,this.mhg(Hc));continue}const jd=this.xS.adb(this.Wj.mE);jd&&jd.email&&Hc.EmailAddress&&jd.email.toUpperCase()===
Hc.EmailAddress.toUpperCase()||Kb.$(Hc.EmailAddress.toUpperCase(),this.mhg(Hc))}return Kb.values}mhg(Za){const Kb=new mb.a;Kb.EmailAddress=Za.EmailAddress;Kb.Id=Za.ID;Kb.Name=Za.Name;return Kb}Eod(Za,Kb){this.V1l(Kb.AIg,Kb.MPf,Kb.Cik);if(Za=this.Wj.O0){var Ic=Kb.AIg;for(var Hc=0;Hc<Ic.length;Hc++)this.Acd.g6l(Ic[Hc].ID);Ic=[];Kb=Kb.MPf;for(Hc=0;Hc<Kb.length;Hc++){const Id=Kb[Hc],ze=Id.ID;if(ze!==this.Wj.mE){const Ie=this.xS.adb(ze);Ie?this.ZGb.jSf(Ie.email,Id.EmailAddress):Array.add(Ic,ze)}}this.Acd.Qti(Ic);
2<=Za.length&&ca.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.Cy,Za.length);Ic=[];Kb=[];for(var jd of Za)Array.add(Ic,jd.ID),jd.ID===this.Wj.mE||this.xS.adb(jd.ID)||Array.add(Kb,jd.ID);ca.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",this.Cy,Za.length,Ic.join(","),Kb.join(","));for(const Id of this.xS.l5())({editor:jd}=
this.Wj.Vpb(Id.clientId)).returnValue?(this.kul(Id),Za=this.Eib.Dva(new Ga.a(jd.EmailAddress,void 0,jd.Name),jd.ID,0),Id.presenceUser=new C.a(Id.clientId,jd.Name,Za,new ia.a(1),null,null,Id.clientType),this.$hd.qud(new bc(Id.Mk,Id.presence.mW,Id.presenceUser,!0,this.mbc(Id.Mk),this.GBb())),ca.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",Id.clientId,Id.presence.toString(),Id.presenceUser.color,
this.Cy)):ca.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Id.clientId,Id.presence.toString(),Id.presenceUser?Id.presenceUser.color:"",this.Cy);this.raiseEvent("PresenceChanged")}else ca.a.J(512360675,814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.Cy)}KF(Za,Kb){this.Acd.e6l();5!==Kb.uE&&(ca.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),
this.disconnect())}xrc(){ca.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.mhb||(ca.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.mhb=!0)}Tpa(){ca.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");this.mhb||(ca.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.mhb=!0)}Wpd(){ca.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");
this.disconnect()}Qha(Za,Kb){ca.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{Kb.o9c?(ca.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",Rc.Fge(this.sA.connectionState)),this.mhb=!1,this.AJe&&!this.rc.OM?ca.a.J(512360661,814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.PGb||2!==this.sA.connectionState?this.connect():(Za={},Za.qs=this.moa.presentationId.string,ca.a.J(512360660,
814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.sA.S4a(Za))):ca.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(Ic){ca.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",Ic)}}mo(Za,Kb){this.uLk&&this.mhb||this.AJe&&!this.rc.OM?ca.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.mhb,this.rc.OM):4!==
Kb.Rza||this.PGb?this.connect():(ca.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.qBh())}Bz(Za,Kb){Kb.Xve&&!this.rc.OM&&(ca.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){ca.a.J(512360654,814,50,"PresenceManager : Connect");this.PGb=!1;this.sA.connect()}orc(){this.PYl()&&(ca.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),
this.cxc())}PYl(){const Za=this.sA.fGj();return Za?2===Za.status||+new Date-+this.g_g>this.qGk?!0:!1:!1}pok(){const Za=this.xS.l5();if(0<Za.length)for(const Kb of Za)if(Kb.presence&&Kb.presence.Mk)return!0;return!1}iYl(){return!this.STg&&this.Qkc&&2!==this.Wj.Iea}kvi(Za){for(const Ic in Za){var Kb=Za[Ic];try{const Hc=ub.GTc(Kb);if(!Hc||Hc.clientId===this.Cy)continue;const jd=Hc.clientId;this.iYl()&&(this.STg=!0,this.yr.JBc(2),ca.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));
ca.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",jd,Hc.presence.toString());const Id=Hc.email;if(!this.ZGb.fhe(Id)){let ze;({editor:ze}=this.Wj.Vpb(jd)).returnValue&&this.ZGb.jSf(Id,ze.EmailAddress)}this.mvi(Hc);this.nZ.Khj()}catch(Hc){ca.a.J(512360651,814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",Hc.toString(),this.Cy)}}this.nZ.rAk(Za)}mvi(Za){this.Fgj(Za);const Kb=this.sA.v5(Za.clientId);Kb&&2===
Kb.status?ca.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Za.clientId):this.lvi(Za)}lvi(Za){const Kb=this.xS.adb(Za.clientId);if(Kb){if(!this.G1j(Kb,Za))return;ca.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",Za.clientId,Kb.presence.toString(),Za.presence.toString(),this.Cy);this.qPb(Kb)}this.Dvi(Za)}qPb(Za){Za&&
(this.xS.qPb(Za),Za.presenceUser&&this.$hd.qud(new bc(Za.Mk,Za.presence.mW,Za.presenceUser,!1,this.mbc(Za.Mk),this.GBb())))}I9f(Za){if(Za)if(Za.presenceUser)ca.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Za.clientId);else{const Kb=this.Umg(Za.clientId);Kb?Za.presenceUser=Kb:ca.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Za.clientId)}}Dvi(Za){Za&&(this.xS.Mka(Za),this.Acd.f6l(Za.clientId),
this.I9f(Za),Za.presenceUser?this.$hd.qud(new bc(Za.Mk,Za.presence.mW,Za.presenceUser,!0,this.mbc(Za.Mk),this.GBb())):ca.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Za.clientId))}G1j(Za,Kb){let Ic;(Ic=!Za.Mk.equals(Kb.Mk))&&ca.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Za.Mk,Kb.Mk);(Za=this.ulc&&Rc.cWl(Za,Kb))&&ca.a.J(512360646,814,50,"Shape Presence Changed");return Ic||Za}u2a(Za){if(Za){for(let Kb=0;Kb<Za.length;Kb++)Za[Kb]=
Za[Kb].toLowerCase();for(const Kb of Za)ca.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",Kb),(Za=this.xS.jvd(Kb))?Za.presenceUser?this.$hd.qud(new bc(Za.Mk,Za.presence.mW,Za.presenceUser,!1,this.mbc(Za.Mk),this.GBb())):ca.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):ca.a.J(512360644,814,15,"PresenceManager : RemovePresence; entry did not exist")}}Log(Za){const Kb=[];for(const Ic of this.xS.l5())Ic.Mk.equals(Za)&&
Ic.presenceUser&&Array.add(Kb,Ic.presenceUser);return Kb}rog(Za){const Kb=[];for(const Ic of this.xS.l5())Ic.presence&&Ic.N1j(Za)&&Ic.presenceUser&&Array.add(Kb,Ic.presenceUser);return Kb}H$b(){const Za=[];for(const Kb of this.xS.l5())Kb.presenceUser&&Array.add(Za,Kb.presenceUser);return Za}GBb(){const Za=this.H$b();return Za?Za.length:0}Bma(Za){if(!Za)return null;Za=Za.toLocaleLowerCase();for(const Kb of this.xS.l5())if(Kb.presenceUser&&Kb.presenceUser.clientId===Za)return Kb.presenceUser;return this.Umg(Za)}jvd(Za){const Kb=
this.xS.adb(Za);this.qPb(Kb);ca.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",Kb?Kb.clientId:Za+" not found",this.Cy)}eAi(Za){this.addHandler("PresenceChanged",Za)}l5(){return this.xS.l5()}connectionState(){return this.sA.connectionState}disconnect(){try{ca.a.J(512360640,814,50,"PresenceManager : Disconnect"),this.PGb||this.dnc.Otl(),this.PGb=!0,this.sA.disconnect()}catch(Za){ca.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",
Za.message,Za.stack)}}Ltl(Za,Kb){this.HOg=Za;this.GOg=Kb}Umg(Za){let Kb;const Ic=({editor:Kb}=this.Wj.Vpb(Za)).returnValue;var Hc=this.sA.Fva(Za),jd=!!Hc;if(!Ic&&!jd)return ca.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Za),null;Hc=jd?Hc:null;Ic||ca.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Za);jd||ca.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Za);jd&&Ic&&ca.a.J(512360607,
814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Za,Hc.clientId!==Kb.ID,Hc.email!==Kb.EmailAddress);var Id=Ic?new Ga.a(Kb.EmailAddress,void 0,Kb.Name):new Ga.a(this.ZGb.fhe(Hc.email)||Hc.email,void 0,Hc.userName);Id=this.Eib.Dva(Id,Ic?Kb.ID:Hc.clientId,0);jd=jd?Hc.clientType:0;return new C.a(Za,Ic?Kb.Name:Hc.userName,Id,new ia.a(1),null,null,jd)}kul(Za){this.sa.Mk.equals(Za.Mk)&&Za.presence.mW&&Za.presence.mW.length&&ca.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Za.clientId,Za.presence.toString(),this.Cy,this.Ge.cbc().getTime());ca.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Za.clientId,Za.presence.toString(),this.Cy,this.Ge.cbc().getTime())}oul(Za){const Kb=[this.Wj.userName];let Ic=0;for(var Hc of this.xS.l5())Hc.presence.Mk.equals(Za.Mk)&&!Rc.Lne(Hc.presence.mW,Za.mW)&&(Ic++,Hc.presenceUser&&Array.add(Kb,Hc.presenceUser.userName));
if(0<Ic){Hc={};let jd=0,Id=0;for(let ze=0;ze<Kb.length;++ze){let Ie=Kb[ze];Ie&&Ie.length||(Ie="anonymous",Id++);Ie in Hc||(Hc[Ie]=!0,jd++)}ca.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",Ic+1,Za.mW&&0<Za.mW.length?"shape":"slide",jd,Id)}}Fgj(Za){try{this.nZ.rlj()&&!this.xS.adb(Za.clientId)&&(this.I9f(Za),this.Ggj(Za.presenceUser))}catch(Kb){ca.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",
Kb.toString())}}Ggj(Za){Za&&Za.clientId&&(this.LRg||this.Yhd||(this.LRg=!0,this.Yhd=F.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.Yhd&&this.Yhd.Kgj(Za.clientId,Rc.FKj(Za)))}static Fge(Za){let Kb="";switch(Za){case 2:Kb="Connected";break;case 1:Kb="Connecting";break;case 0:Kb="Disconnected"}return Kb}static Lne(Za,Kb){if(!Za&&!Kb)return!1;if(!Za&&Kb||Za&&!Kb||Za.length!==Kb.length)return!0;for(let Ic=0;Ic<Za.length;Ic++)if(Za[Ic]!==Kb[Ic])return!0;return!1}static R1j(Za,
Kb){return!da.a.tca(Za,Kb)}static cWl(Za,Kb){return Za.Mk.equals(Kb.Mk)&&Rc.Lne(Za.presence.mW,Kb.presence.mW)}static FKj(Za){return Za&&1===Za.client?1:0}}Rc.Yae="ETU";Object(k.a)(Rc,"PresenceManager",r.a,[1699,1700,1701,1702]);var Fb=d(1319),Qb=d(1204),hc=d(1328),Pc=d(78),uc=d(48),zb=d(299);class ac{constructor(Za,Kb,Ic,Hc,jd){this.jv=null;this.Jw=E.AFrameworkApplication.fa.getBooleanAppSetting("PPTCanvasPresenceBubbleUXEnabled");Kb=this.JIj(Kb,Hc,jd);this.jv=this.Jw?(new Fb.a(Kb)).J6b(Za):(new Qb.a(Kb)).G7d(Za,
Ic)}dispose(){this.jv.dispose()}eZe(){return uc.a.wi(document.getElementById(zb.a.C4b))}JIj(Za,Kb,Ic){const Hc=new hc.a;Hc.add(0,Pc.getImageClassWithCluster(E.AFrameworkApplication.dP,"MoreUsersGlyph_16x16x32"));Hc.add(5,E.AFrameworkApplication.Mm);Hc.add(1,Pc.getImageClassWithCluster(E.AFrameworkApplication.dP,this.Jw?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));Hc.add(4,E.AFrameworkApplication.Mm);Hc.add(6,Ic);Hc.add(8,E.AFrameworkApplication.isRtl);Hc.add(12,Za);Hc.add(11,Kb);
this.Jw&&(Hc.add(16,Object(W.a)(this,this.eZe,"presenceViewportBoundsCallback")),Hc.add(17,!0));return Hc}$B(Za){this.jv?(ca.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Za.clientId),this.jv.$B(Za)):ca.a.J(509219530,814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Za.clientId)}qQ(Za){this.jv?(ca.a.J(509219528,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Za.clientId),this.jv.qQ(Za.clientId)):ca.a.J(509219529,
814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Za.clientId)}clear(){if(this.jv)if(ca.a.J(509219526,814,50,"PresencePawn:Clear at PresencePawn "),this.r$())for(const Za of this.r$())this.qQ(Za);else ca.a.J(509219525,814,50,"PresencePawn:Clear - Pawn has no users");else ca.a.J(509219527,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}r$(){return this.jv?this.jv.NNb:null}kaf(){this.jv&&(this.Jw&&this.jv.PNa(),this.jv.LNa())}foe(){this.jv&&
this.jv.PNa()}}Object(k.a)(ac,"PresencePawn",null,[830,106]);class Jb{t2f(Za,Kb,Ic){return new ac(Za,2,Kb,!0,Ic)}}Object(k.a)(Jb,"PresencePawnFactory",null,[1685]);var Yc=d(32);class dd{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee){this.uMe=[];this.f0a=null;this.ySg=this.xSg=this.hHe=0;this.Mdd=this.Ndd=null;this.vhd=[];if(!Kb)throw Error.argumentNull("graphTopologyManager");if(!Ic)throw Error.argumentNull("presenceManager");if(!Hc)throw Error.argumentNull("dragInputManager");if(!jd)throw Error.argumentNull("coauthStateChangesHandler");
this.xd=Za;this.sa=Kb;this.AF=Ic;this.av=Hc;this.$Ce=jd;this.Ooa=Id;this.Tb=ze;this.gf=Ie;this.wjb=Cd;this.Noa=ue;this.qS=Ee;this.Noa.E9a(Object(W.a)(this,this.hBd,"slidePresenceChanged"));this.xd.kU(Object(W.a)(this,this.o1a,"onSlideNavigation"));this.xd.BOc(Object(W.a)(this,this.jza,"onThumbnailRefresh"));this.xd.Avb(Object(W.a)(this,this.UVe,"onThumbnailVisibleRangeChanged"));this.zVg=E.AFrameworkApplication.fa.getBooleanAppSetting("PPTCanvasPresenceFloodGateSurveyEnabled");(this.Jw=E.AFrameworkApplication.fa.getBooleanAppSetting("PPTCanvasPresenceBubbleUXEnabled"))&&
this.zVg&&(this.xSg=E.AFrameworkApplication.fa.tc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.ySg=E.AFrameworkApplication.fa.tc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",3),this.hHe=0,this.f0a=B.a.Au(F.a.instance.Ha("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.xd.yvb(Object(W.a)(this,this.lWl,"shapeViewElementAdded"));this.xd.qMf(Object(W.a)(this,this.mWl,"shapeViewElementLocked"));this.xd.Fzi(Object(W.a)(this,this.U9k,"onShapeViewElementShowLockHint"));this.xd.Gzi(Object(W.a)(this,
this.V9k,"onShapeViewElementShowPresenceHint"));this.xd.Dzi(Object(W.a)(this,this.O9k,"onShapeViewElementHidePresenceHint"))}o1a(){this.sa.Mk&&(ca.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",this.sa.Mk),this.mvl(this.sa.Mk))}mvl(Za){if(this.sa.Mk&&this.sa.Mk.equals(Za)&&(ca.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Za),Za=new Yc.GraphIterator,Za.set(this.sa.Aa),Za.Gb(1))){do if(0<
Za.currentNode.$a(jb.a.shapeId)){const Kb=Object(sa.a)(4,Za.currentNode);Kb&&this.CBh(Kb)}while(Za.Qf(1))}}hBd(Za,Kb){this.av.FHa?(ca.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.Mdd||(this.Mdd=new w.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(Kb)},90,"68"),E.AFrameworkApplication.Be.Jb(this.Mdd)),Kb&&this.vhd.push(Kb)):(this.kml(Kb),this.iml(Kb))}handlePendingPresenceChangedEvent(){this.Mdd=null;this.jvl();if(this.sa.Mk&&0<this.vhd.length){const Ic=
{},Hc={};var Za=this.sa.Mk;for(var Kb of this.vhd){if(!Za.equals(Kb.slideId))continue;if(!Kb.shapes||!Kb.user)continue;Kb.user.clientId in Hc||(Ic[Kb.user.clientId]=Kb.user,Hc[Kb.user.clientId]=new Db.a(0));const jd=Hc[Kb.user.clientId];for(const Id of Kb.shapes){const ze=Kb.F$?1:0;jd.Ib(Id)?0<(jd.ga(Id)^ze)&&jd.$(Id,ze):jd.add(Id,ze)}}for(const jd in Ic){Za=Ic[jd];Kb=jd;if(!(Kb in Hc))continue;const Id=[],ze=[];Hc[Kb].forEach((Ie,Cd)=>{0<Cd?ze.push(Ie):Id.push(Ie);return!0});0<Id.length&&this.uDh(Id,
Za);0<ze.length&&this.RKf(ze,Za)}this.vhd=[]}}kml(Za){Za.F$?this.Mka(Za.slideId,Za.user):this.u2a(Za.slideId,Za.user)}jza(Za,Kb){this.ABh([Kb.lYh])}UVe(Za,Kb){this.ABh(Kb.Uia)}ABh(Za){const Kb=[];for(const Ic of Za)Za=this.qS?this.Tb.c2c(Ic):this.Tb.Dma(Ic),this.qS&&0>=Za.FW||Za&&Array.add(Kb,Za);this.zBh(Kb)}Mka(Za,Kb){const Ic=this.Wpg(Za);Ic?(Ic.Mka(Kb),this.qAe(),ca.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Za.toString())):ca.a.J(21770506,
814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Za.toString())}u2a(Za,Kb){const Ic=this.Wpg(Za);Ic?Ic.u2a(Kb):ca.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Za.toString())}Wpg(Za){const Kb=this.Tb.Dma(Za);return Kb?Object(sa.a)(1050,Kb.vg(this.wjb)):(ca.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Za.toString()),null)}jvl(){const Za=this.sa.presentation;if(!Za)throw Error.argumentNull("Presentation is null");
this.zBh(Za.slides||[])}zBh(Za){for(const Ic of Za){var Kb=Object(sa.a)(205,Ic);Kb?(Za=Kb.Fb,(Kb=Object(sa.a)(1050,Kb.vg(this.wjb)))?(ca.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",Za.toString()),Kb.$4a(this.AF.Log(Za))):ca.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Za.toString())):ca.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",
Ic.Fb.toString())}}qAe(){this.Jw&&this.zVg&&(this.Ccm()||this.f0a&&this.f0a.continueWith(()=>{this.f0a.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",this.xSg)&&this.hHe++}))}Ccm(){return this.hHe>=this.ySg}iml(Za){this.sa.Mk&&this.sa.Mk.equals(Za.slideId)&&Za.shapes&&(Za.F$?this.RKf(Za.shapes,Za.user):this.uDh(Za.shapes,Za.user))}lWl(Za,Kb){Za=Kb.Vx;this.AFg(Za.shapeNode)&&(this.uMe.push(Za),this.Ndd||(this.Ndd=new w.a(2,1,0,Object(W.a)(this,this.handlePendingShapePresenceUpdate,
"handlePendingShapePresenceUpdate"),90,"69"),E.AFrameworkApplication.Be.Jb(this.Ndd)))}handlePendingShapePresenceUpdate(){this.Ndd=null;for(const Za of this.uMe){if(!this.AFg(Za.shapeNode))return;this.CBh(Za.shapeNode)}Array.clear(this.uMe)}CBh(Za){const Kb=Object(sa.a)(178,Za.sc(this.gf));if(Kb&&!Za.get_smartArtModelId()){var Ic=this.AF.rog(Za);if(Ic)if(Ic.length){Za=this.Ooa.$J(Za);Za.oXf();for(const Hc of Ic)Za.Mka(Hc),this.qAe()}else(Ic=this.Ooa.dK(Za))&&Ic.oXf();this.$Ce.Qqh(Kb)}}RKf(Za,Kb){var Ic=
this.wog();let Hc=!1;for(const jd of Ic){if(!Array.contains(Za,jd.get_shapeId())||jd.get_smartArtModelId())continue;Ic=Object(sa.a)(178,jd.sc(this.gf));if(!Ic||jd.get_smartArtModelId())continue;const Id=this.Ooa.$J(jd);Id?(Ic.isSelected&&(Id.Bwb=!1),Id.Mka(Kb),this.qAe(),Ic.isSelected&&Id.$pc()):Hc=!0}Hc||ca.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}uDh(Za,Kb){var Ic=this.wog();for(const Hc of Ic)Array.contains(Za,Hc.get_shapeId())&&(Ic=this.Ooa.$J(Hc))&&Ic.u2a(Kb)}wog(){let Za=
null;this.sa.Aa&&(Za=this.sa.Aa.yj());return Za||[]}AFg(Za){return!!this.sa.Aa&&this.sa.Aa.Fb.equals(Za.slideId)}mWl(Za,Kb){this.Ooa.$J(Kb.Vx.shapeNode).oFd(Kb.presenceUser)}U9k(Za,Kb){(Kb.Vx.Mq||Kb.Vx.lAd)&&(Za=this.Ooa.dK(Kb.Vx.shapeNode))&&Za.K$e()}V9k(Za,Kb){(Za=this.Ooa.dK(Kb.Vx.shapeNode))&&Za.k_l()}O9k(Za,Kb){(Za=this.Ooa.dK(Kb.Vx.shapeNode))&&Za.Efa()}}Object(k.a)(dd,"PresencePresenter",null,[]);class id{constructor(Za){this.snc=Za}Fva(Za){return this.snc.Fva(Za)}v5(Za){return this.snc.v5(Za)}}
Object(k.a)(id,"PresenceUserInfoGetter",null,[1687,1654]);class Cc{constructor(Za=null){this.Wj=Za}Vmg(Za){if(!Za||!Za.value)return null;Za=Za.value;let Kb=Za.userName;if(!Kb&&this.Wj){let Ic;({editor:Ic}=this.Wj.Vpb(Za.clientId)).returnValue&&(Kb=Ic.Name)}return Object.assign(new C.a,{clientId:Za.clientId,chatThreadId:Za.chatThreadId,chatThreadDiscoveryUri:Za.chatThreadDiscoveryUri,inChat:Za.inChat,email:Za.email,capabilities:new ia.a(Za.capabilities),userName:Kb})}}Object(k.a)(Cc,"PresenceUtils",
null,[1698]);var Nb;(function(Za){Za[Za.coauthHandlerResponse=0]="coauthHandlerResponse";Za[Za.popSessionResponse=1]="popSessionResponse";Za[Za.defaultFallback=2]="defaultFallback"})(Nb||(Nb={}));Object(k.b)("RtcDiscoverType",Nb);class nc{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee,Xe,Sd,ad,af,pf){this.I$d=Za;this.sBd=Kb;this.rBd=Ic;this.zzb=Hc;this.rdc=jd;this.x4c=Id;this.Ypb=ze;this.sEd=Ie;this.zmb=Cd;this.yVc=ue;this.wVc=Ee;this.$Sb=Xe;this.Xjb=Sd;this.Wyb=ad;this.B8f=af;this.jbe=pf}aEk(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",
this.I$d,this.sBd,this.rBd,this.zzb,this.rdc,this.x4c,this.Ypb,this.sEd,this.zmb,this.yVc,this.wVc,this.$Sb,this.Xjb,this.Wyb,this.B8f,this.jbe)}}Object(k.a)(nc,"RttLockSettings",null,[]);var Kc=d(347);class xd{constructor(Za,Kb,Ic,Hc){this.Llc=this.Klc=null;this.wxf=!1;this.BSk=Za;this.Ga=Kb;this.Uh=Ic;this.CZ=Hc;this.wKb=new Date;this.RJa=-1}get eb(){return this.BSk}get v9c(){return this.wxf}set v9c(Za){this.wxf=Za}Mkj(){return 0<this.RJa&&Date.now()>=this.RJa}BMh(Za){this.RJa=Za}Dbc(){return""}Ebc(){return""}YOb(Za){this.Klc=
Za?this.Dbc():this.Ebc();this.Llc=new Date}z4d(){}B4d(){return!1}SIh(Za,Kb){Za=Za||"";Kb=Kb||"";if(Za.length!==Kb.length)return null;const Ic=[];for(let Hc=0;Hc<Za.length;Hc+=1)Za.charAt(Hc)!==Kb.charAt(Hc)&&Ic.push(Hc);return 0<Ic.length?$b.a.iJ("Length",Za.length,"FirstDiffPos",Ic[0],"DiffCount",Ic.length):null}$Va(Za){return oa.a.replaceAll(Za,"\u00a0"," ").trim()}}Object(k.a)(xd,"ATextContentRecord",null,[]);var Xc=d(35),Tb=d(41);class he extends xd{constructor(Za,Kb,Ic,Hc){super(Za,Kb,Ic,Hc);
this.sfh=Za.VA}get shapeNode(){return Object(sa.a)(4,this.eb)}cVl(){this.sfh=this.shapeNode.VA}Dbc(){const Za=new n.a;var Kb=this.shapeNode.aA();for(const Ic of Kb)(Kb=this.Uh.text(Ic))&&0<Kb.length&&Za.add(Kb);return Za.toArray().join(" ")}Ebc(){return this.Ga.u$(this.shapeNode)}z4d(){try{const Za=this.Dbc()||"",Kb=this.Klc||"";if(Za!==Kb){const Ic=this.$Va(Za)===this.$Va(Kb),Hc=this.sfh||this.shapeNode.VA;if(!Ic&&!Hc&&!this.shapeNode.vd){const jd=$b.a.iJ("Shape",this.shapeNode.ln,"Start",Tb.a.Ef(this.wKb),
"LastSnapshotTime",Tb.a.Ef(this.Llc),"EverEdit",this.v9c,"Type",this.getShapeType());jd.Expiration=-1<this.RJa?(+new Date(this.RJa)-+this.wKb).toString():null;const Id=Za.length-Kb.length;Id?jd.TextLengthDelta=Id:jd.SameLengthDiffDetails=this.SIh(Za,Kb);ca.a.J(25539747,814,15,Xc.c(jd))}}}catch(Za){ca.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Za)}}B4d(){try{const Za=this.CZ.fac(this.shapeNode);if(Za&&0<Za.length)return!1;const Kb=this.Ebc()||"",Ic=this.Klc||"";if(Kb!==Ic&&
0>Kb.indexOf(Ic)&&!(0<=this.$Va(Kb).indexOf(this.$Va(Ic))||this.shapeNode.vd)){const Hc=$b.a.iJ("Shape",this.shapeNode.ln,"Start",Tb.a.Ef(this.wKb),"LastSnapshotTime",Tb.a.Ef(this.Llc),"TextLengthDelta",Kb.length-Ic.length,"Type",this.getShapeType());ca.a.J(25981903,814,15,Xc.c(Hc))}}catch(Za){ca.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Za)}return!0}getShapeType(){return this.shapeNode.vd?"Table":this.shapeNode.ig?"SmartArt":this.shapeNode.Xu?"TextBox":this.shapeNode.Sk?
"PlaceHolder":this.shapeNode.Yfa?"Shape":"Unknown"}}Object(k.a)(he,"ShapeContentRecord",xd,[]);class re{constructor(Za,Kb,Ic,Hc,jd,Id,ze,Ie,Cd,ue,Ee,Xe,Sd){this.rjb=this.AKb=null;this.bQ={};this.eLa={};this.oa=Ie;this.rF=Cd;this.Nc=Za;this.Qt=Kb;this.JJk=Ic;this.Qs=Hc;this.sa=jd;this.Wf=Id;this.CZ=ze;this.Ga=ue;this.Cc=Ee;this.sPe=Xe;this.Kt=Sd;this.oa.fMf(Object(W.a)(this,this.j8k,"onPreSelectionChanged"));this.oa.AG(Object(W.a)(this,this.xMb,"onSetSelectionFinished"));this.rF.$Ai(Object(W.a)(this,
this.D$k,"onTableCellViewElementLocked"));this.Nc.Xxi(Object(W.a)(this,this.OHi,"beforeProcessInboundResponse"));this.Qt.zvb(Object(W.a)(this,this.R9k,"onShapeViewElementOpenTextEditView"));this.Qt.zOc(Object(W.a)(this,this.L9k,"onShapeViewElementCloseTextEditView"));this.Qt.qMf(Object(W.a)(this,this.Q9k,"onShapeViewElementLocked"));this.JJk.f_d(Object(W.a)(this,this.z$k,"onSuccessfulInbound"));this.Qs.Ak(Object(W.a)(this,this.ph,"onPropertyChanged"));this.Wf.HJ(Object(W.a)(this,this.XC,"onActiveSlideChanged"))}R9k(Za,
Kb){Za=Object(sa.a)(4,Object(sa.a)(Kc.a,Kb.Vx).eb);Kb=this.sPe.z8d(Za);this.bQ[Za.id.toString()]=Kb;Kb.YOb(!0)}L9k(Za,Kb){Za=Object(sa.a)(4,Object(sa.a)(Kc.a,Kb.Vx).eb).id.toString();Za in this.bQ&&this.bQ[Za].BMh(Date.now()+this.Kt.zzb)}Q9k(Za,Kb){Za=Object(sa.a)(4,Object(sa.a)(Kc.a,Kb.Vx).eb).id.toString();Za in this.bQ&&delete this.bQ[Za]}j8k(){this.AKb=this.Q2f}xMb(){this.rjb=this.Q2f;if(!(!this.AKb&&!this.rjb||this.AKb&&this.rjb&&this.rjb.id.equals(this.AKb.id))){if(this.AKb){var Za=this.AKb.id.toString();
Za in this.bQ&&this.bQ[Za].BMh(Date.now()+this.Kt.zzb)}this.rjb&&(Za=this.sPe.z8d(this.rjb),this.bQ[this.rjb.id.toString()]=Za,Za.YOb(!0))}}get Q2f(){var Za=this.oa.Oa;if(!Za||!Za.kb||Za.kb.qm)return null;Za=Za.kb;return Za.Ua.node&&Za.Ua.node.isConnected?this.Cc.NGa(Za.Ua.node):null}D$k(Za,Kb){Za=Kb.tableCellNode.id.toString();Za in this.bQ&&delete this.bQ[Za]}OHi(){this.OCh();for(const Za of Object.keys(this.bQ))this.bQ[Za].YOb(!0)}z$k(){this.OCh();for(const Za of Object.keys(this.bQ))this.bQ[Za].z4d();
for(const Za of Object.keys(this.eLa))this.eLa[Za].B4d()&&delete this.eLa[Za]}ph(Za,Kb){if(Kb&&Kb.node&&Kb.property.id===Ha.a.np.id){Za=Object(sa.a)(5,Kb.node);Kb=!Kb.node.loading;const Ic=this.Cc.NGa(Za);if(Ic)this.Mhh(Ic,Kb),this.Nhh(Ic,Kb);else if(Za=this.Ga.sfa(Za))this.Mhh(Za,Kb),this.Nhh(Za,Kb)}}XC(){this.eLa={}}OCh(){for(const Za of Object.keys(this.bQ))this.bQ[Za].Mkj()&&delete this.bQ[Za]}Mhh(Za,Kb){Za=Za.id.toString();if(Za in this.bQ){Za=this.bQ[Za];const Ic=Object(sa.a)(he,Za);Ic&&Ic.cVl();
Za.YOb(!0);Kb&&(Za.v9c=!0)}}Nhh(Za,Kb){var Ic=this.Ga.Gn(Za);Ic&&this.sa.Aa&&this.sa.Aa.sid===Ic.get_sid()&&this.sa.Aa.cid===Ic.get_cid()&&(Ic=Za.id.toString(),Kb?Ic in this.eLa&&delete this.eLa[Ic]:(Kb=Object(Ca.a)(650,Za)?this.CZ.S$b(Object(sa.a)(650,Za)):this.CZ.fac(Object(sa.a)(4,Za)))&&0<Kb.length&&(Ic in this.eLa?this.eLa[Ic].YOb(!1):(Za=this.sPe.z8d(Za),this.eLa[Ic]=Za,Za.YOb(!1))))}}Object(k.a)(re,"TextContentMonitor",null,[]);class ee extends xd{constructor(Za,Kb,Ic,Hc,jd){super(Za,Kb,Hc,
jd);this.Cc=Ic}get tableCellNode(){return Object(sa.a)(650,this.eb)}Dbc(){const Za=new n.a;this.Cc.Btc(this.tableCellNode,Kb=>{(Kb=this.Uh.text(Kb))&&0<Kb.length&&Za.add(Kb)});return Za.toArray().join(" ")}Ebc(){const Za=new n.a;this.Cc.Btc(this.tableCellNode,Kb=>{Kb.Qa(Ha.a.np)&&(Kb=Kb.$a(Ha.a.np))&&0<Kb.length&&Za.add(Kb)});return Za.toArray().join(" ")}z4d(){try{const Za=this.Dbc()||"",Kb=this.Klc||"";if(Za!==Kb&&this.$Va(Za)!==this.$Va(Kb)){const Ic=$b.a.iJ("TableCellNode",this.NOh+"/"+this.tableCellNode.ln,
"Start",Tb.a.Ef(this.wKb),"LastSnapshotTime",Tb.a.Ef(this.Llc),"EverEdit",this.v9c);Ic.Expiration=-1<this.RJa?(+new Date(this.RJa)-+this.wKb).toString():null;const Hc=Za.length-Kb.length;Hc?Ic.TextLengthDelta=Hc:Ic.SameLengthDiffDetails=this.SIh(Za,Kb);ca.a.J(37748808,814,15,Xc.c(Ic))}}catch(Za){ca.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Za)}}B4d(){try{const Za=this.CZ.S$b(this.tableCellNode);if(Za&&0<Za.length)return!1;const Kb=this.Ebc()||"",Ic=this.Klc||"";if(Kb!==
Ic&&0>Kb.indexOf(Ic)&&!(0<=this.$Va(Kb).indexOf(this.$Va(Ic)))){const Hc=$b.a.iJ("TableCellNode",this.NOh+"/"+this.tableCellNode.ln,"Start",Tb.a.Ef(this.wKb),"LastSnapshotTime",Tb.a.Ef(this.Llc),"TextLengthDelta",Kb.length-Ic.length);ca.a.J(37748812,814,15,Xc.c(Hc))}}catch(Za){ca.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Za)}return!0}get NOh(){const Za=this.Ga.Gn(this.tableCellNode);return Za?Za.ln:"UnknownShape"}}Object(k.a)(ee,"TableCellContentRecord",xd,[]);class Yf{constructor(Za,
Kb,Ic,Hc){this.Ga=Za;this.Cc=Kb;this.Uh=Ic;this.CZ=Hc}z8d(Za){return Object(Ca.a)(4,Za)?new he(Object(sa.a)(4,Za),this.Ga,this.Uh,this.CZ):Object(Ca.a)(650,Za)?new ee(Object(sa.a)(650,Za),this.Ga,this.Cc,this.Uh,this.CZ):null}}Object(k.a)(Yf,"TextContentRecordFactory",null,[1686]);var ke=d(641);class ef{constructor(Za,Kb,Ic,Hc,jd){this.yb=Za;this.Ooa=Kb;this.oa=Ic;this.rF=Hc;this.Pw=jd;this.ycd=!1}initialize(){this.oa.AG(Object(W.a)(this,this.xMb,"onSetSelectionFinished"));this.rF.hBi(Object(W.a)(this,
this.Mqh,"onTypingLockStatusChanged"))}dispose(){this.oa.y3e(Object(W.a)(this,this.xMb,"onSetSelectionFinished"));this.rF.SCl(Object(W.a)(this,this.Mqh,"onTypingLockStatusChanged"))}xMb(){var Za=this.oa.yw();let Kb=null;for(const Ic of Za)if(Za=Object(sa.a)(na.TableCellNode,Ic))if(Za=Object(sa.a)(1676,Za.vg(this.yb.Na)))if(Kb=Za.E$c)break;this.W3h(Kb)}Mqh(Za,Kb){this.W3h(Kb.U8i)}W3h(Za=null){this.oa.P$()?this.v7l(Za):this.iHl()}v7l(Za=null){if(this.yb.editingView&&this.yb.editingView.Nm){const Kb=
this.Xhg();Kb&&(this.Ooa.$J(Kb.shapeNode).oFd(Za),Za&&(Kb.lAd=!0,this.Pw.Rzh(new ke.a(Kb)),Kb.lAd=!1));this.ycd||ca.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.yb.editingView.disable(!1,14);this.ycd=!0}}iHl(){if(this.yb.editingView&&this.yb.editingView.Nm){const Za=this.Xhg();Za&&Za.shapeNode.vd&&(this.Ooa.$J(Za.shapeNode).oFd(null),Za.goe());this.ycd&&ca.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");
this.yb.editingView.r4a();this.ycd=!1}}Xhg(){let Za=null;const Kb=this.oa.Hd();1===Kb.length&&(Za=Object(sa.a)(178,Kb[0].sc(this.yb.Na)));return Za}}Object(k.a)(ef,"TypingLockHandler",null,[1697,106]);var yf=d(934);class Rf{constructor(){this.hed=this.yh=this.M6=this.ndd=this.AF=this.K=this.tI=null;this.Lic=0;this.ljd=null;this.TEe=!1;this.had=null;this.VGe=!1;this.cdd=!0;this.vnc=rb.a("PresencePackage.RefactorInit");this.JGk=rb.a("PresencePackage.CheckSignalRLoadedBeforeRTC")}get name(){return"Presence"}SYi(){this.K.register(C.a,
"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(Cc,"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().na(()=>new Cc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.TEe=!0}fc(Za){try{ca.a.J(509100485,814,50,"PresencePackage::configure");this.Lic=(new Date).getTime();this.K!==Za&&(this.K=Za,this.M6=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.yh=this.M6.AGa(1,this.name),this.TEe=!1,this.VGe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);
this.tI=this.K.resolve("Common.AFrameworkApplication");const Kb=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.cdd=!E.AFrameworkApplication.fa.getBooleanAppSetting("PPTODeprecateRtcFallback");this.TEe||this.SYi();if(this.JGk){ca.a.J(508864333,814,50,"PresencePackage::configure; Check SignalR loaded");const jd=this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener");if(jd.Ixe)ca.a.J(508864332,814,50,"PresencePackage::configure; SignalR loaded early");else{ca.a.J(508864331,
814,15,"PresencePackage::configure; SignalR not loaded");jd.cdk(()=>{ca.a.J(508864330,814,50,"PresencePackage::configure; SignalR loaded");this.fc(F.a.instance)});return}}const Ic=Kb.KRi&&Kb.JUb?!1:Kb.Mg,Hc=this.r6i(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),Ic,Kb["368"]);Hc?(this.K.register(662,"Common.IRealtimeChannelBasic").ma().na(()=>Hc),this.K.register(661,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>Hc),this.PYi(Kb),this.vnc&&this.init()):ca.a.J(509100484,
814,15,"PresencePackage::configure could not create rtc")}catch(Kb){ca.a.J(508929377,814,10,"PresencePackage::configure; Initializing Presence failed: {0}",Kb)}}PYi(Za){this.K.register(Qa,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().na(()=>new Qa(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(Pa,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().na(()=>new Pa(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));
this.K.register(ib,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().na(()=>new ib(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkState"),Q.a.getInstance(),Za.rtcAllowCrossDomainAccessOrigins));this.K.register(Rc,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().na(()=>
new Rc(this.K.resolve("Common.IPresenceUser"),E.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),this.tI.nU,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Za,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").F2c(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(qb,"PowerpointPresence.PresenceCache").ma().na(()=>new qb(this.K.resolve("PowerpointPresence.IPresenceManager")));
this.K.register(dd,"PowerpointPresence.PresencePresenter").ma().na(()=>new dd(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Za.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(Wb,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().na(()=>new Wb(this.K.resolve("Common.IPresenceUser").clientId,Za.EWl,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const Kb=new nc(Za.jcj,Za.sBd,Za.rBd,Za.zzb,Za.rdc,Za.x4c,Za.Ypb,Za.sEd,Za.zmb,Za.yVc,Za.wVc,Za.$Sb,Za.Xjb,Za.Wyb,Za.podsTableRTTEnabled,Za.podsTableCellLockEnabled);this.K.register(ef,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().na(()=>new ef(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(va,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().na(()=>new va(ba.App.ni,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),Za,Kb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na,this.K.resolve("Box4.Graph.IGraphInstance").Cd(16),B.a.Au(F.a.instance.Ha("Common.ISystemInitiatedFeedback"))));this.K.register(1685,"PowerpointPresence.IPresencePawnFactory").ma().na(()=>new Jb);
this.K.register(1686,"PowerpointPresence.ITextContentRecordFactory").ma().na(()=>new Yf(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(re,"PowerpointPresence.TextContentMonitor").ma().na(()=>new re(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
ha.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),
Kb));this.K.register(m,"Common.App.Presence.AwayManager").ma().na(()=>this.Z1i(this.K.resolve("Common.IPresenceUser"),this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Za.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(1687,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().na(()=>new id(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));ca.a.J(509100483,814,50,"PresencePackage::configurePostRTC; Setting Rtc configured");
this.RWc().Gnb("RTCConfigured")}rJj(Za){let Kb;var Ic=Za;Kb=0;if(Za=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").GKj())return Ic=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").$zd(),{D5e:Za,B5e:Kb,Ice:Ic};Kb=1;if(Za=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").UHh)return Ic=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").$zd,{D5e:Za,B5e:Kb,Ice:Ic};if(this.cdd)return{D5e:Ic,B5e:2,Ice:!0}}q6i(){const Za=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;
0<Za&&(this.ljd=new w.a(2,1,Za,()=>{this.cdd?this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").abg=!0:this.K.ub("AppRealtimeChannel.IRealtimeChannel")||ca.a.J(509670485,828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Za);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").mEh(Object(W.a)(this,this.rVe,"onPopsRtcEndpointUrlReady"));this.K.ub("AppRealtimeChannel.IRealtimeChannel")||(this.fc(F.a.instance),this.vnc||
this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Jb(this.ljd))}r6i(Za,Kb,Ic,Hc){ca.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",Ic);Kb.clientId=Za.clientId;var jd=null;Kb=null;const Id=Q.a.getInstance();if(Ic){Kb=Hc+"rtc2";({D5e:Kb,B5e:Ic,Ice:Hc}=this.rJj(Kb));jd=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const ze=this.cdd&&this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").abg,Ie=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").xEg;
ca.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",Nb[Ic],jd,Hc,ze,Ie);if(2===Ic&&!ze)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").aAi(Object(W.a)(this,this.rVe,"onPopsRtcEndpointUrlReady")),this.q6i(),null;if(!Hc&&!jd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").gOc(Object(W.a)(this,this.GLa,"onCoauthStatusChanged")),
null;jd=this.T1i(Za,Kb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Id)}return H.RealtimeChannel.createInstance(Za.clientId,Za.userSessionId,Za.Lwd,Za.vea,Za.$Kh,3,Za.Xx,Kb,jd,Id)}Z1i(Za,Kb,Ic,Hc,jd){const Id=new N.a;Id.Jg(Ic);Ic=new N.a;Ic.Jg(Kb);return new m(Za,Ic.task,Id.task,Hc,this.K.resolve("Common.ITaskManager"),this.tI.nU.td.M1d?6E4:this.tI.nU.td.awayCoauthorThresholdMs,Object(W.a)(this.tI.nU.bI(),this.tI.nU.bI().nb,"processAction"),ka.App.fvb.notificationBar,jd)}init(){ca.a.J(509100482,
814,50,"PresencePackage::init; initing presence");const Za=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Za.Ei(21,Rf.wnc);Za.Ei(22,this.Lic);Za.Ei(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?(ca.a.J(509100481,814,50,"PresencePackage::init; Setting Presentation Id ready"),this.RWc().Gnb("PresentationId")):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").dMf(Object(W.a)(this,this.rrc,"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").uXa(()=>
{ca.a.J(509100480,814,50,"PresencePackage::init; Setting B2I Finished");this.RWc().Gnb("B2IFinished")})}rrc(){ca.a.J(509100451,814,50,"PresencePackage::onPresentationIdReady; Setting Presentation Id ready");this.RWc().Gnb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").nEh(Object(W.a)(this,this.rrc,"onPresentationIdReady"))}rVe(){this.ljd&&this.K.resolve("Common.ITaskManager").Vg(this.ljd);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").mEh(Object(W.a)(this,
this.rVe,"onPopsRtcEndpointUrlReady"));this.K.ub("AppRealtimeChannel.IRealtimeChannel")||(this.fc(F.a.instance),this.vnc||this.init())}GLa(Za,Kb){2!==Kb.rSe||this.K.ub("AppRealtimeChannel.IRealtimeChannel")||(this.fc(F.a.instance),this.vnc||this.init());this.K.ub("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").lvd(Object(W.a)(this,this.GLa,"onCoauthStatusChanged"))}RWc(){this.hed||(this.hed=new yf.a(Object(W.a)(this,this.$Cb,"initInternal"),
["PresentationId","B2IFinished","RTCConfigured"]));return this.hed}$Cb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").Ei(4,this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").k1e);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Ei(23,(new Date).getTime());this.a$j();this.W$j();this.hed=null}W$j(){try{let Za="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Za=this.yh.Mu("presencemanager");this.X$j();this.yh.Su(Za);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").u8c=
!0;ca.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");ba.App.F6d&&(Za=this.yh.Mu("contentnotification"),Ac.init(),this.yh.Su(Za));Za=this.yh.Mu("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dij();this.AF=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.tI.nU.td.Rjj&&(ca.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.tI.nU.bI().nb(D.a.Q$a,
2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.tI.nU.td.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.yh.Su(Za);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Ohj();
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").HCk()}catch(Za){ca.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Za)}}dispose(){this.AF?this.AF.disconnect():ca.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}X$j(){this.K.resolve("PowerpointPresence.PresenceManager").qb();ca.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}T1i(Za,
Kb,Ic,Hc){let jd=Kb;jd=jd.endsWith("/")?jd+"findsession":jd+"/findsession";ca.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",jd,Za.vea.LBa);Kb=()=>U.FindSessionStrategy.c4i(Za.userSessionId,Za.vea,jd,Za.Xx,E.AFrameworkApplication.buildVersion,Za.clientId,Rf.jsj(E.AFrameworkApplication.buildVersion),Hc,Za.$Kh,()=>{if(E.AFrameworkApplication.mh)return E.AFrameworkApplication.mh;const ze=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;
ze||ca.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return ze},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").EKj());const Id=!!this.ndd;return this.VGe||Id?this.had=new La(this.ndd,Kb,Ic,Hc,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):Kb()}a$j(){var Za;if(Za=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").tBj():this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").Xde)Za=
G.RtcUtils.deserialize(Za,"PresencePackage","Deserialize existing FindSession response",!0),this.$qd(Za)}$qd(Za){if(Za)try{this.ndd=Object.assign(new P.a,{Qfc:Za[Y.a.yEb],errorMessage:Za[Y.a.errorMessage],h6b:Za[Y.a.Kaf],B7:Za[Y.a.B7],kC:Za[Y.a.kC],P2c:Za[Y.a.kme],imd:Za[Y.a.Yjb],jmd:Za[Y.a.AOa],mmd:Za[Y.a.$jb]}),this.VGe&&this.had&&(this.had.findSessionResponse=this.ndd)}catch(Kb){ca.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",Kb)}}static main(){Rf.wnc=(new Date).getTime();
const Za=new Rf;E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.getBooleanAppSetting("IsSyncConfigPresenceEnabled")?(Za.fc(F.a.instance),Za.K.ub("AppRealtimeChannel.IRealtimeChannel")&&!Za.vnc&&Za.init()):K.a.instance.Ac(Za)}static jsj(Za){return String.format("{0}, {1}, {2}",Rf.qVf(A.a[3]),Rf.qVf("browser"),Za)}static qVf(Za){return Za?Za.charAt(0).toLocaleUpperCase()+Za.substring(1,Za.length):Za}}Rf.wnc=0;Object(k.a)(Rf,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");Rf.main()},191:function(L,V,d){d.r(V);d.d(V,"RtcUtils",function(){return r});L=d(0);var k=d(395),e=d(35),n=d(713);class r{static q4d(w,D=n.a.SQe){let y;try{y=e.c(w)}catch(m){throw w=String.format("Failed to JSON-serialize payload : {0}",m),k.ULS.sendTraceTag(508396173,500,10,w),Error.argument("payload",w);}if(y.length>D)throw w=
String.format("Payload exceeds maximum length: {0} > {1}.",y.length,D),k.ULS.sendTraceTag(508396171,500,10,w),Error.argument("payload",w);return y}static deserialize(w,D,y){if(!w)return null;if(Object.getType(w)!==String){var m=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",D,Object.getType(w).getName(),y);k.ULS.sendTraceTag(508396170,500,10,m);return null}m=null;try{m=e.a(w)}catch(C){w=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
D,C,y),k.ULS.sendTraceTag(508396168,500,10,w)}return m}static ULb(w){if(!w)return"";if("string"===typeof w)return w.toString();try{return e.c(w)}catch(D){return w.toString()}}static oag(w){let D,y,m;D=0;m=y=null;if(!w)return{Foe:D,Goe:y,Ni:m};try{const C=w.source;C&&Object.getType(C)===String&&(m=C);const E=w.context;E&&(w=E,D=w.status?w.status:0,y=w.statusText?w.statusText:null)}catch(C){}return{Foe:D,Goe:y,Ni:m}}}Object(L.a)(r,"RtcUtils",null,[])},309:function(L,V,d){d.r(V);L=d(0);var k=d(395),
e=d(7),n=d(104),r;(function(m){m[m.csm=0]="SendNotification";m[m.dsm=1]="SendPersistentState";m[m.Uqm=2]="FindSession";m[m.f8h=3]="Last"})(r||(r={}));Object(L.b)("ApiType",r);var w;(function(m){m[m.xqm=0]="AttemptCount";m[m.nsm=1]="SuccessCount";m[m.Mqm=2]="DropCount";m[m.Rqm=3]="FailedCount";m[m.srm=4]="LatencyOverThresholdCount";m[m.trm=5]="LatencyUnderThresholdCount";m[m.ysm=6]="ThrottledCount";m[m.f8h=7]="Last"})(w||(w={}));Object(L.b)("EventCountType",w);var D=d(714);d.d(V,"FrequentLoggingMetrics",
function(){return y});class y{constructor(m){this.zZf=this.xcg=null;this.Jgh=this.Seg=0;this.Fu=null;this.nzf=this.yQd=0;this.Bi=m;this.J$j();this.uLd=this.Zsf=this.QQd=!1;this.tQd=0}get Tjj(){return this.uLd}n5l(m){this.nzf=m;window.setInterval(Object(e.a)(this,this.GAe,"logMetricsBatchAndReset"),m);this.yQd=(new Date).getTime()}mI(m,C){this.RWl(m)&&!this.Zsf||this.Tjj||!window.navigator.onLine||this.Bi.KHa||(this.Fu[m][C]++,this.QQd=!0)}J$j(){this.Fu=Array(3);for(let m=0;3>m;m++){this.Fu[m]=Array(7);
for(let C=0;7>C;C++)this.Fu[m][C]=0}}TKi(){const m={};for(let C=0;3>C;C++)for(let E=0;7>E;E++)this.ktk(C,E)&&(m[r[C]+w[E]]=this.Fu[C][E]);m.FSDomain=this.xcg;m.ConnectionDomain=this.zZf;m.FSRetryInterval=this.Seg;m.MaxPayloadSize=this.Jgh;m.LogNumber=this.tQd;1===this.tQd&&(m.FSLatencies=D.a.instance.sBj(),m.ConLatencies=D.a.instance.mxj());return m}ktk(m,C){return 2===m&&3!==C&&0!==C?!1:!0}RWl(m){return 2===m?!1:!0}GAe(){if(this.QQd){this.tQd++;if((new Date).getTime()-this.yQd<5E3+this.nzf){var m=
n.a.toJSON(this.TKi());k.ULS.sendTraceTag(50644352,500,15,m)}this.yQd=(new Date).getTime();for(m=0;3>m;m++)for(let C=0;7>C;C++)this.Fu[m][C]=0;this.QQd=!1}}VVk(){this.Zsf=!0}static get instance(){return y.Ja}static create(m){y.instance||(y.Ja=new y(m));return y.instance}}y.Ja=null;Object(L.a)(y,"FrequentLoggingMetrics",null,[691])},713:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Kgh=31E3;k.SQe=8E3;Object(L.a)(k,"RealtimeChannelStaticConstants",null,[])},714:function(L,V,d){d.d(V,
"a",function(){return k});L=d(0);class k{constructor(){this.zGf=!1;this.mTd=null;this.hqf=0;this.JLd=this.x2f();this.qEc=this.x2f();this.Y5a=this.jsb=0;this.IG=()=>new Date}get W6l(){return this.zGf}x2f(){const e=Array(6);for(let n=0;n<e.length;n++)e[n]=0;return e}sBj(){return this.JLd.toString()}mxj(){return this.qEc.toString()}o5l(){this.mTd=this.IG()}hvc(e,n,r=!1){this.W6l||(r&&(this.zGf=!0),r=this.IG(),0===e&&5<this.jsb||1===e&&5<this.Y5a||(this.hqf<e?(1===this.jsb%2&&(this.JLd[this.jsb]=-1,this.jsb++),
this.hqf=e,1===n&&(this.qEc[this.Y5a]=-1,this.Y5a++),this.qEc[this.Y5a]=this.$bf(r),this.Y5a++):0===e?(this.JLd[this.jsb]=this.$bf(r),this.jsb++):(this.qEc[this.Y5a]=this.$bf(r),this.Y5a++)))}$bf(e){const n=e.getTime()-this.mTd.getTime();this.mTd=e;return n}static get instance(){k.Ja||(k.Ja=new k);return k.Ja}static set instance(e){k.Ja=e}}k.Ja=null;Object(L.a)(k,"LatencyMetrics",null,[])},715:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n,r,w){this.UXk=e;this.AOa=
n;this.XWk=r;this.SSj=w}}Object(L.a)(k,"ThrottlerManagerSettings",null,[])},718:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(7),n=d(1104),r=d(1025),w=d(71),D=d(25);class y{constructor(Ea,La){this.status=Ea;this.xFb=La}}Object(L.a)(y,"UserStatusInfo",null,[]);var m=d(74),C=d(714);class E{constructor(Ea,La){this.data=Ea;this.timeStamp=La}}Object(L.a)(E,"PresenceData",null,[]);class F{constructor(Ea){this.gta=!1;this.Nub=0;this.GJd=!1;this.BDk=()=>{k.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",
this.Dq)};this.setTimeout=F.K9d;this.clearTimeout=F.A9d;this.LEk=this.BDk;this.Dq=Ea}U3k(){this.gta||(this.Nub=this.setTimeout(()=>{this.gta=!1;this.IKg()},8E3),this.gta=!0,this.GJd=!1)}F4k(){this.DO()}y$k(){this.IKg()}IKg(){this.DO();this.GJd||(this.GJd=!0,this.LEk())}DO(){this.gta&&this.clearTimeout(this.Nub);this.Nub=0;this.gta=!1}static K9d(Ea,La){return window.setTimeout(Ea,La)}static A9d(Ea){window.clearTimeout(Ea)}}Object(L.a)(F,"ConnectedUsageKpiLogger",null,[717]);class B{constructor(){this.Dud=
this.I1e;this.L1e=this.M1e;this.Eud=this.K1e;this.gvc=this.O1e;this.QAh=this.N1e;this.V1e=this.W1e;this.S1e=this.T1e;this.imb=this.Q1e;this.ivc=this.R1e;this.LAh=this.J1e;this.okb=this.kSe;this.CLb=this.lSe}I1e(){}M1e(){}K1e(){}O1e(){}N1e(){}T1e(){}R1e(){}Q1e(){}W1e(){}J1e(){}kSe(){}lSe(){}}Object(L.a)(B,"NoopRealtimeChannelMetrics",null,[711,370]);class H{}H.$4a="presenceUpdated";H.updateNotification="updateNotification";H.nuh="persistentStateCleared";H.vUb="persistentStateUpdated";Object(L.a)(H,
"RtcClientMethodNames",null,[]);class K{}K.O5j="realtimeChannelHub";K.$4a="UpdatePresence";K.gca="SendUpdateNotification";K.Ege="GetCompletePersistentStateWithMetadata";K.vUb="UpdatePersistentState";K.S4a="UpdateClientInfo";Object(L.a)(K,"RtcHubMethodNames",null,[]);class A{constructor(Ea){this.MA=Ea}wxl(Ea){this.MA.on(H.$4a,Ea)}$xl(Ea){this.MA.on(H.updateNotification,Ea)}sxl(Ea){this.MA.on(H.vUb,Ea)}rxl(Ea){this.MA.on(H.nuh,Ea)}hgm(Ea){this.MA.off(H.$4a,Ea)}mgm(Ea){this.MA.off(H.updateNotification,
Ea)}ggm(Ea){this.MA.off(H.vUb,Ea)}fgm(Ea){this.MA.off(H.nuh,Ea)}$4a(Ea){return this.MA.invoke(K.$4a,Ea)}S4a(Ea){return this.MA.invoke(K.S4a,Ea)}gca(Ea,La){return this.MA.invoke(K.gca,Ea,La)}Ege(Ea){return this.MA.invoke(K.Ege,Ea)}vUb(Ea,La){return this.MA.invoke(K.vUb,Ea,La)}}Object(L.a)(A,"RealtimeChannelProxy",null,[714,715,716]);var W=d(713);class N{constructor(){this.lId=this.nof=!1;this.jId=0;this.qJd=this.oVd=this.nVd=this.KHd=!1;this.KLd=0;this.wEf=!1;this.vEf=this.uEf=0;this.qUd=!1;this.uUd=
this.sUd=this.vUd=this.rUd=0;this.tUd=!1}get M1d(){return this.lId}get awayCoauthorThresholdMs(){return this.jId}get $Ci(){return this.KHd}get $Xl(){return this.nVd}get aYl(){return this.oVd}get IUi(){return this.qJd}get O9b(){return this.KLd}get wIl(){return this.wEf}get VHh(){return this.uEf}get vIl(){return this.vEf}get qIl(){return this.qUd}get rIl(){return this.rUd}get ZHh(){return this.vUd}get WHh(){return this.sUd}get YHh(){return this.uUd}get XHh(){return this.tUd}static createInstance(Ea){return Ea?
Object.assign(new N,{nof:Ea.getBooleanAppSetting("AwayStatusManagerIsEnabled"),lId:Ea.getBooleanAppSetting("AwayStatusOneMinuteTimeoutIsEnabled"),jId:Ea.tc("AwayCoauthorThresholdMs",9E5),KHd:Ea.getBooleanAppSetting("RtcAllowCrossDomainAccessEnabled"),nVd:Ea.getBooleanAppSetting("ShouldLogOnContentNotification"),oVd:Ea.getBooleanAppSetting("ShouldLogOnHostSubscriptionNotification"),qJd:Ea.getBooleanAppSetting("RtcClientMetricsEnabled"),KLd:Ea.tc("RtcFindSessionRequestTimeoutInMS",6E4),wEf:Ea.getBooleanAppSetting("RtcJsClientFrequentlyLogsMetrics"),
uEf:Ea.tc("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),vEf:Ea.tc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),qUd:Ea.getBooleanAppSetting("RtcClientMessageTelemetryEnabled"),rUd:Ea.tc("RtcClientMessageTelemetrySampleSize",5),vUd:Ea.tc("RtcSendTelemetryMessageIntervalInMS",3E5),sUd:Ea.tc("RtcLogClientMessageMetricsTimeOutInMs",2E4),uUd:Ea.tc("RtcMaxPayloadSizeInCharactersOverride",W.a.SQe),tUd:Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):
Object.assign(new N,{nof:!1,lId:!1,jId:9E5,KHd:!1,nVd:!1,oVd:!0,qJd:!1,KLd:9E4,qUd:!1,rUd:5,vUd:3E5,sUd:2E4,uUd:W.a.SQe,tUd:!1})}}Object(L.a)(N,"RealtimeChannelSettings",null,[713]);var P=d(719),U=d(1264),Q=d(152);class G{constructor(Ea){this.N1b=null;this.fAa=0;this.hbb=!1;this.oj=Ea;this.oj.C9a(Object(e.a)(this,this.Hpa,"onConnectionStateChanged"))}Hpa(Ea,La){this.fAa=La.newState}R$k(){k.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.oj.oud()}v9j(Ea){this.N1b.init(Ea)}}
Object(L.a)(G,"ARtcMessageHandler",null,[]);var Y=d(721);class ba{constructor(){this.Presence=null;this.TimeStamp=0}}Object(L.a)(ba,"PresenceDataEntryForClients",null,[]);var ha=d(104);class ka{constructor(Ea,La=""){this.yni=Ea;this.ICa=La}send(){return this.yni()}get messageId(){return this.ICa}}Object(L.a)(ka,"MessageHandler",null,[773]);var ca=d(753);class ia extends Sys.EventArgs{constructor(Ea,La,xb,dc){super();this.e4e=Ea;this.reconnectDelay=La;this.reason=xb;this.P6e=dc}}Object(L.a)(ia,"RefreshConnectionReconnectArgs",
Sys.EventArgs,[]);var oa=d(1024);class sa{constructor(){this.WVd=this.pk=null}get Qr(){return this.pk?this.WVd?this.WVd.getTime()-this.pk.getTime():(new Date).getTime()-this.pk.getTime():0}start(){this.pk=new Date}stop(){this.WVd=new Date}}Object(L.a)(sa,"SimpleStopwatch",null,[]);var Ca=d(1029),Ta;(function(Ea){Ea[Ea.Jtm=0]="contentUpdate";Ea[Ea.xum=1]="editorsTableUpdate";Ea[Ea.bAb=2]="fileNameUpdate";Ea[Ea.WEm=3]="wetContentUpdate";Ea[Ea.eCm=4]="persistedContentUpdate";Ea[Ea.Atm=5]="clientRtcReconnectRequest";
Ea[Ea.RCm=6]="replicationTelemetry";Ea[Ea.Tvm=7]="lockUpdate";Ea[Ea.Ftm=8]="collabServiceContentUpdate";Ea[Ea.AEm=9]="trackChangeSettingUpdate";Ea[Ea.iDm=10]="saveTargetUpdate";Ea[Ea.LEm=11]="uploadToOcsUpdate";Ea[Ea.Nvm=12]="labelUpdate";Ea[Ea.ovm=13]="hostNotificationSubscriptionStatus";Ea[Ea.eEm=14]="subscribeOrExtend";Ea[Ea.yum=15]="elapsedBootTelemetry";Ea[Ea.Ctm=16]="clientToClientTelemetryMessage";Ea[Ea.Btm=17]="clientToClientResponseMessage";Ea[Ea.REm=18]="verifyNotificationPipeline";Ea[Ea.nvm=
19]="hostNotificationHeartbeat";Ea[Ea.wDm=20]="secondaryMetadataUpdate";Ea[Ea.last=21]="last"})(Ta||(Ta={}));Object(L.b)("UpdateNotificationType",Ta);var R=d(583),Ha=d(794),da=d(795);class Ba extends G{constructor(Ea,La,xb,dc,gb,gc,Ac,$b,jc,pb){super(Ac);this.MA=null;this.MZb=this.gzf=!1;this.ICa=0;this.SSd=new Q.a;this.cii=Ba.zxj();this.wSd=D.AFrameworkApplication.fa.Ea("OwningFeatureCrewForRtcNotificationKpis");this.nd=Ea;this.PAf=this.OAf=0;this.N1b=La;this.N1b.COc(Object(e.a)(this,this.R$k,"onTooManyUndeliveredMessages"));
this._clientId=xb;this.Zli=gb;this.oj.kAi(Object(e.a)(this,this.Voh,"onRefreshProxyRequired"));this.oj.iAi(Object(e.a)(this,this.Soh,"onRefreshAllPersistentStateRequest"));this.oj.wAi(Object(e.a)(this,this.gca,"sendUpdateNotification"));this.oj.byi(Object(e.a)(this,this.Anh,"onInternalPresenceUpdated"));this.oj.cyi(Object(e.a)(this,this.Bnh,"onInternalUpdateNotificationReceived"));this.oj.ayi(Object(e.a)(this,this.znh,"onInternalPersistentStateUpdated"));this.oj.$xi(Object(e.a)(this,this.ynh,"onInternalPersistentStateCleared"));
this.oj.vAi(Object(e.a)(this,this.Yxd,"sendPersistentState"));this.oj.nBi(Object(e.a)(this,this.S4a,"updateClientInfo"));this.Di=gc;this.Dq=dc;this.Fu=$b;this.qO=jc;this.ZZb=pb;this.uPa=Object(U.a)(String,D.AFrameworkApplication.ld.Application)||""}Voh(Ea,La){this.MA=this.Zli(La.hubConnection);this.N1b.reset();this.MA.wxl(Object(e.a)(this,this.qrc,"onPresenceUpdated"));this.MA.sxl(Object(e.a)(this,this.Gpd,"onPersistentStateUpdated"));this.MA.rxl(Object(e.a)(this,this.pVe,"onPersistentStateCleared"));
this.MA.$xl(Object(e.a)(this,this.Orc,"onUpdateNotificationReceived"))}Hpa(Ea,La){this.fAa=La.newState;2===La.newState&&this.QMl()}QMl(){for(const Ea of this.SSd)this.gca(null,new oa.a(Ea.key,Ea.value,!1,new n.a));this.SSd=new Q.a}Soh(Ea,La){La.M4d();for(Ea=0;3>Ea;++Ea)this.zMl(Ea,La)}zMl(Ea,La){try{this.MA.Ege(Ea).done(xb=>{La.OUb(La.n6d,"GetCompletePresenceSuccess")&&(La.xZi.y$k(),k.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}] of type [{1}]",this.Dq,Ea),
this.oj.Oql(),this.a8k(Ea,xb),this.oj.Qpl(xb),La.R$f.Ib(Ea)&&this.oj.Kzh(Ea,La.R$f.ga(Ea),new n.a))}).fail(xb=>{const {RtcUtils:dc}=d(191);La.OUb(La.n6d,"GetCompletePresenceFail")&&(k.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}] of type [{2}]",dc.ULb(xb),this.Dq,Ea),this.oj.oud())}).always(()=>{La.Lz&&La.Lz.stop()})}catch(xb){k.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",
La.n6d,xb.message)}}Yxd(Ea,La){var {RtcUtils:xb}=d(191);Ea=La.presence;let dc;const gb=La.pOa;this.qO.mI(1,0);try{dc=xb.q4d(Ea,this.ZZb)}catch(Ac){this.qO.mI(1,3);k.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Ac.message);gb.setException(Ac);return}xb=new w.a;xb.$(this._clientId,Object.assign(new ba,{Presence:Ea,TimeStamp:(new Date).getTime()}));this.oj.gAh(La.type,xb);if(2!==this.fAa)this.Fu.imb(),this.qO.mI(1,2),gb.Jg(null);else{var gc=
this.ICa.toString();++this.ICa;Ea=new ka(()=>this.SMl(La.type,dc,gc),gc);Ea=this.eYh(0,La.type).add(Ea);Ea.mpd(Ac=>{2===Ac&&(this.qO.mI(1,6),this.MZb||2!==La.type||k.ULS.sendTraceTag(508651234,500,15,"First persistent state update of type LiveMeeting for [{0}] was throttled",this.Dq));gb.Jg(null)});Ea.lpd(()=>{})}}SMl(Ea,La,xb){let dc=null;const gb=new sa,gc=new ca.a;k.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}] of type [{1}]",this.Dq,Ea);if(2!==this.fAa)return this.Fu.imb(),
this.qO.mI(1,2),k.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}] of type [{1}]",this.Dq,Ea),gc.HQe(),gc;this.Di&&20>this.OAf&&(dc=this.Di.lj("WebServiceCall","Send Presence Message"),this.OAf++);gb.start();gc.upc(1);try{this.MA.vUb(Ea,La).done(()=>{this.Fu.S1e();this.qO.mI(1,1);k.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}] of type [{2}]",xb,this.Dq,Ea);gc.K0a(1);gb&&(gb.stop(),gb.Qr>this.nd.VHh?this.qO.mI(1,
4):this.qO.mI(1,5))}).fail(Ac=>{const {RtcUtils:$b}=d(191);this.hbb||(this.Fu.imb(),this.qO.mI(1,3),this.MZb||2!==Ea||k.ULS.sendTraceTag(508651233,500,15,"First persistent state update of type LiveMeeting for [{0}] failed",this.Dq),k.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",xb,$b.ULb(Ac),this.Dq));gc.K0a(2)}).always(()=>{dc&&dc.stop()})}catch(Ac){k.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
Ac.message),this.qO.mI(1,3),this.MZb||2!==Ea||k.ULS.sendTraceTag(508651232,500,15,"First persistent state update of type LiveMeeting for [{0}] hit an exception",this.Dq),gc.K0a(2)}return gc}S4a(Ea,La){({RtcUtils:Ea}=d(191));const xb=La.HUi,dc=La.pOa;let gb;try{gb=Ea.q4d(xb,this.ZZb)}catch(gc){k.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",gc.message);dc.setException(gc);return}try{this.MA.S4a(gb).done(()=>{k.ULS.sendTraceTag(544319E3,
500,50,"Successfully delivered clientInfo.")}).fail(gc=>{const {RtcUtils:Ac}=d(191);this.hbb||k.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",Ac.ULb(gc));dc.Jg(null)})}catch(gc){k.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",gc.message),dc.Jg(null)}}gca(Ea,La){({RtcUtils:Ea}=d(191));const xb=La.type,dc=La.zBa,gb=La.daj,gc=La.pOa;let Ac;this.qO.mI(0,0);try{Ac=Ea.q4d(dc,this.ZZb)}catch(jc){this.qO.mI(0,3);
k.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",jc.message);gc.setException(jc);return}if(2!==this.fAa)gb?this.SSd.$(xb,dc):(this.Fu.imb(),this.qO.mI(0,2)),gc.Jg(null);else{var $b=this.ICa.toString();++this.ICa;La=new ka(()=>this.pNl(xb,Ac,$b),$b);La=this.eYh(1,xb).add(La);La.mpd(jc=>{2===jc&&this.qO.mI(0,6);gc.Jg(null)});La.lpd(()=>{})}}pNl(Ea,La,xb){let dc=null;const gb=new sa,gc=new ca.a;k.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}] of type [{1}]",
this.Dq,Ea);if(2!==this.fAa)return this.Fu.imb(),this.qO.mI(0,2),k.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Dq),gc.HQe(),gc;this.Di&&3===Ea&&20>this.PAf&&(dc=this.Di.lj("WebServiceCall","Send WetContent Update"),this.PAf++);gb.start();gc.upc(1);this.MA.gca(Ea,La).done(()=>{this.Fu.S1e();this.qO.mI(0,1);k.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}] of type [{2}]",xb,this.Dq,Ea);gc.K0a(1);
gb&&(gb.stop(),gb.Qr>this.nd.VHh?this.qO.mI(0,4):this.qO.mI(0,5))}).fail(Ac=>{const {RtcUtils:$b}=d(191);this.hbb||(this.Fu.imb(),this.qO.mI(0,3),k.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",xb,$b.ULb(Ac),this.Dq));gc.K0a(2)}).always(()=>{dc&&dc.stop()});return gc}yBa(){this.MA.hgm(Object(e.a)(this,this.qrc,"onPresenceUpdated"));this.MA.ggm(Object(e.a)(this,this.Gpd,"onPersistentStateUpdated"));this.MA.fgm(Object(e.a)(this,this.pVe,
"onPersistentStateCleared"));this.MA.mgm(Object(e.a)(this,this.Orc,"onUpdateNotificationReceived"))}Taj(){this.oj.iCl(Object(e.a)(this,this.Voh,"onRefreshProxyRequired"));this.oj.gCl(Object(e.a)(this,this.Soh,"onRefreshAllPersistentStateRequest"));this.oj.pCl(Object(e.a)(this,this.gca,"sendUpdateNotification"));this.oj.RAl(Object(e.a)(this,this.Anh,"onInternalPresenceUpdated"));this.oj.SAl(Object(e.a)(this,this.Bnh,"onInternalUpdateNotificationReceived"));this.oj.QAl(Object(e.a)(this,this.znh,"onInternalPersistentStateUpdated"));
this.oj.PAl(Object(e.a)(this,this.ynh,"onInternalPersistentStateCleared"));this.oj.oCl(Object(e.a)(this,this.Yxd,"sendPersistentState"));this.oj.VCl(Object(e.a)(this,this.S4a,"updateClientInfo"))}Anh(Ea,La){this.qrc(La.DUb,La.a6f)}qrc(Ea){this.Fu.ivc();this.Gpd(0,Ea)}znh(Ea,La){this.Gpd(La.type,La.DUb)}a8k(Ea,La){const xb={};for(const dc in La)xb[dc]=La[dc].Presence;this.Boh(Ea,xb,La)}Gpd(Ea,La){this.Fu.ivc();this.Boh(Ea,La)}Boh(Ea,La,xb=null){var {RtcUtils:dc}=d(191);if(k.ULS.FAa(500,100))for(var gb in La);
delete La[this._clientId];if(!ha.a.isEmpty(La)){for(var gc in La)gb=gc,La[gb]=dc.deserialize(La[gc],"Presence",gb,!1,this.ZZb);dc=new w.a;gc=(new Date).getTime();for(const Ac in La){gb=La[Ac];const $b=Ac;let jc;xb?(jc=xb[$b],jc.Presence=gb):jc=Object.assign(new ba,{Presence:gb,TimeStamp:gc});dc.$($b,jc)}this.oj.gAh(Ea,dc);switch(Ea){case 0:this.gzf||(k.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Dq),this.gzf=!0,D.AFrameworkApplication.gh&&D.AFrameworkApplication.gh.RVk());
this.oj.yzh(La,[]);break;case 2:this.MZb||(k.ULS.sendTraceTag(508867081,500,50,"Raising first live meeting update notification for [{0}]",this.Dq),this.MZb=!0);this.oj.uzh(Ea,La);break;default:this.oj.uzh(Ea,La)}}}ynh(Ea,La){this.pVe(La.f5d)}pVe(Ea){this.Fu.ivc();if(k.ULS.FAa(500,100))for(let La=0;La<Ea.length;++La);Ea.length&&(this.oj.Trl(Ea),this.oj.zql(Ea),this.oj.yzh({},Ea))}Bnh(Ea,La){this.Orc(La.type,La.zBa)}Orc(Ea,La=null){this.nd.$Xl&&0===Ea&&k.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");
if(0===Ea&&this.wSd&&0<this.wSd.length){var xb=Object.assign(new R.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.wSd,vetoPillar:"RealTimeCoauth"});(xb=Y.a.getInstance(xb))&&xb.logKpiUsage(this.cii)}this.nd.aYl&&13===Ea&&k.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",La||"<none>"));this.Fu.ivc();5===Ea?(La=(Ea=this.cel(La))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",
Ea.reason,Ea.reconnectDelay):"Received client reconnection request from the server without params.",k.ULS.sendTraceTag(18637071,500,50,La),this.oj.oud(Ea)):(La=d(191).RtcUtils.deserialize(La,String.format("UpdateNotification-{0}",Ta[Ea]),null,!1,this.ZZb),this.oj.Srl(Ea,La))}cel(Ea){try{if(!Ea||""===Ea)return null;const La=JSON.parse(Ea);return new ia(La[Ca.a.E5e],La[Ca.a.pIl],La[Ca.a.tIl],La[Ca.a.P6e])}catch(La){return k.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",
La.message),null}}eYh(Ea,La){return this.N1b.MPj(this.NPj(Ea,La))}NPj(Ea,La){return Ea+","+La}static zxj(){var Ea=new Map;Ea.set("SkipAria","True");Ea=Object.assign(new Ha.a,{extendedProperties:Ea});return Object.assign(new da.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Ea,blockFutureEmissionDurationInMs:3E5})}}Object(L.a)(Ba,"RtcMessageHandler",G,[]);class za{u1f(Ea,La=""){const {MaxOutstandingThrottler:xb}=d(1026);return xb.createInstance(Ea,La)}E4i(Ea,La=""){const {MaxRateThrottler:xb}=
d(1028);return xb.createInstance(Ea,La)}}Object(L.a)(za,"ThrottlerFactory",null,[709]);var Aa=d(75),na=d(715);class la{constructor(Ea){this.nd=null;this.RQ=!1;this.Ma=new Aa.a;this.LQd=new w.a;this.JQd=new w.a;this.SWd=Ea;this.msb=this.SWd.u1f(La=>La.send(),"GlobalMaxOustandingThrottler");this.msb.COc(()=>{this.Ma.raiseEvent("TMUDM")})}init(Ea){this.RQ||(this.nd=Ea,this.msb.init(this.nd.AOa,this.nd.SSj),this.RQ=!0)}MPj(Ea){var {MaxRateThrottler:La}=d(1028),{MaxOutstandingThrottler:xb}=d(1026);this.RQ||
this.init(new na.a(La.B3f,xb.T3f,xb.H3f,la.YWk));({value:La}=this.LQd.Eg(Ea)).returnValue||(({value:La}=this.JQd.Eg(Ea)).returnValue||(La="MaxOutstandingThrottler-"+Ea,La=this.SWd.u1f(Object(e.a)(this.msb,this.msb.add,"add"),La),La.init(this.nd.AOa,this.nd.XWk),La.COc(()=>{this.Ma.raiseEvent("TMUDM")}),this.JQd.add(Ea,La)),xb="MaxRateThrottler-"+Ea,La=this.SWd.E4i(Object(e.a)(La,La.add,"add"),xb),La.init(this.nd.UXk),this.LQd.add(Ea,La));return La}reset(){for(const Ea of this.LQd)Ea.value.U1e();for(const Ea of this.JQd)Ea.value.U1e(),
Ea.value.reset();this.msb.U1e();this.msb.reset()}COc(Ea){this.Ma.addHandler("TMUDM",Ea)}}la.YWk=1E3;Object(L.a)(la,"ThrottlerManager",null,[710]);var va=d(1192);const Pa=(Ea,La,xb,dc,gb,gc,Ac,$b,jc=null,pb=null,$a=null,zc=null)=>{const rb=N.createInstance(D.AFrameworkApplication.fa),ib=D.AFrameworkApplication.buildVersion?D.AFrameworkApplication.buildVersion:"1.0",Vb=Qa(Ea,La,Ac,ib),Od=rb.IUi?d(1191).RealtimeChannelMetrics.createInstance(Vb):new B;var jb=d(309).FrequentLoggingMetrics.create(gb);rb.wIl&&
jb.n5l(rb.vIl);var Wb="";Wb=jc&&""!==jc?jc:"/rtc2/";jb.xcg=m.a.GD(Wb);const qb=Wb+"signalr";jc=Wb+"findsession";const Ga=K.O5j;Wb=new za;$a=$a||P.a.getInstance();k.ULS.shipAssertTag(508396228,500,rb.YHh<=W.a.Kgh,"Client attempting to override max payload size beyond absolute limit");const cb=Math.min(rb.YHh,W.a.Kgh);jb.Jgh=cb;jb=new Ba(rb,new la(Wb),Ea,Vb,Ob=>new A(Ob.createHubProxy(Ga)),$b,$a,Od,jb,cb);pb||(pb=d(1053).FindSessionStrategy.createInstance(La,gb,jc,$b,ib,Ac,Ea,Vb,$a,gc,dc,zc));pb.O9b=
rb.O9b;La=new F(Vb);xb=xb?xb.split(","):null;Ea=new (d(718).RealtimeChannel)(Ea,xb,Vb,$b,()=>$.hubConnection(qb),pb,jb,La,$a,Od,rb,gb);Ea.init();return Ea},Qa=(Ea,La,xb)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Ea,Ua(va.a[xb]),Ua("browser"),La),Ua=Ea=>Ea?Ea.charAt(0).toLocaleUpperCase()+Ea.substring(1,Ea.length):Ea;d.d(V,"RealtimeChannel",function(){return Ya});class Ya{constructor(Ea,La,xb,dc,gb,gc,Ac,$b,jc,pb,$a,zc){this.UVd=!1;this.S_=null;this.TT=new w.a;this.sWb=
1;this.Y3=null;this.IL=!1;this.GPd=(new Date(0)).getTime();this.VFf=0;this.iUh=()=>{const rb=this.sWb;this.UVd=!1;this.Fu.Dud();this.yPa.jke(this.wZi,this.Lmh,Object(e.a)(this.hNa,this.hNa.v9j,"initThrottlerManager"),Object(e.a)(this,this.OUb,"verifyConnectionToken"),rb)};this.Lmh=(rb=null)=>{this.Fu.Eud();let ib=null;!rb||"documentsessiondeleted"!==(ib=rb.toLowerCase())&&"documentsessionexpired"!==ib?this.T7b():(k.ULS.sendTraceTag(508396225,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",
this.Dq,rb),this.disconnect())};this.T7b=(rb,ib=null)=>{k.ULS.sendTraceTag(508396224,500,50,"Disconnecting the connection [{0}]",this.S_);rb=(rb=2===this.U_||1===this.U_)&&!this.hNa.hbb;let Vb=!0,Od=0;ib&&Object.getType(ib)!==Object.getType(Sys.EventArgs.Empty)&&ib.e4e&&""!==ib.e4e&&(rb=!0,this.yPa.w8e(ib.e4e),Vb=ib.P6e,Od=ib.reconnectDelay);rb&&this.Hpa(1,this.U_);++this.sWb;this.hNa.yBa();this.c6l(Vb);this.yPa.cae();this.C1f();rb&&window.setTimeout(this.iUh,Math.min(Od,3E4))};this.T1h=()=>{let rb=
null;const ib=({correlationId:rb}=this.yPa.W_c()).returnValue;this.Y3.qs=ib;k.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Dq,rb)};this.wZi=rb=>{const {FrequentLoggingMetrics:ib}=d(309);this.GPd=(new Date).getTime();let Vb=null;this.Y3.qs=({correlationId:Vb}=this.yPa.W_c()).returnValue;this.nd.$Ci&&(this.Y3.url=rb,ib.instance&&(ib.instance.zZf=m.a.GD(rb)));let Od=null;this.Di&&(Od=this.Di.lj("WebServiceCall","ConnectToServer"));
k.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Dq);rb={};this.yMc&&(rb.transport=1===this.yMc.length?this.yMc[0]:this.yMc);rb.pingInterval=null;C.a.instance.hvc(1,0);rb.waitForPageLoad=!1;this.Y3.start(rb,null).done(jb=>{this.Fu.L1e();C.a.instance.hvc(1,1,!0);k.ULS.sendTraceTag(508396195,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",jb.id,Vb)}).fail(jb=>{k.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",
this.yPa.kC,Vb,this.Dq);this.Lmh();this.Fu.LAh(jb);C.a.instance.hvc(1,1,!1);this.oj.Hzh(0,{["CorrelationId"]:Vb,["ErrorDetails"]:jb,["ConnectionState"]:r.a[this.U_]})}).always(()=>{const {FrequentLoggingMetrics:jb}=d(309);Od&&Od.stop();jb.instance&&(jb.instance.uLd=!1)})};this.Tqh=(rb,ib)=>{for(const Vb of ib.plm)this.TT.Ib(Vb.key)||this.TT.$(Vb.key,new Q.a),rb=Vb.value,this.TT.ga(Vb.key).$(ib.type,new E(rb.Presence,new Date(rb.TimeStamp))),Vb.key===this._clientId&&0===ib.type&&this.oj.hql(rb.Presence)};
this.Sqh=(rb,ib)=>{for(const Vb of ib.f5d)this.TT.remove(Vb)};this.M4d=()=>{let rb;const ib=[];({value:rb}=this.TT.Eg(this._clientId)).returnValue&&this.TT.remove(this._clientId);for(const Vb of this.TT.keys)Array.add(ib,Vb);for(const Vb of ib)this.TT.remove(Vb);rb&&this.TT.$(this._clientId,rb);this.oj.Zpl(ib)};this._clientId=Ea;this.yMc=La;this.U_=0;this.Di=dc;this.FJd=$b;this.jni=Ac;this.Z9h=jc;this.Nbi=gb;this.yPa=gc;this.Dq=xb;this.Fu=pb;this.nd=$a;this.Bi=zc;this.zoi=1>100*Math.random()}get qpa(){return this.yPa.qpa}set qpa(Ea){this.yPa.qpa=
Ea}get hNa(){return this.jni}get oj(){return this.Z9h}init(){this.oj.jAi(this.T7b);this.oj.pBi(this.Tqh);this.oj.oBi(this.Sqh);this.Bi.lvb(this.Fu);D.AFrameworkApplication.Jia(()=>{const {FrequentLoggingMetrics:Ea}=d(309);this.Fu.V1e();Ea.instance&&Ea.instance.GAe()});this.C1f();this.icj();this.oj.nMf(this.T1h)}icj(){try{const xb=$.signalR;if(!xb)throw Error.invalidOperation("Failed to retrieve Signalr object");const dc=xb.version;if(!dc)throw Error.invalidOperation("Signalr object is missing version information");
if("2.1.1"===dc){var Ea=xb.transports;if(!Ea)throw Error.invalidOperation("Failed to retrieve transports object");var La=Ea.longPolling;if(!La)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!La.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");La.supportsKeepAlive=this.N6i()}}catch(xb){k.ULS.sendTraceTag(508396227,500,15,"Failed to disable longPolling KeepAlives: {0}",xb.message)}}N6i(){return()=>!1}C1f(){const Ea=
++this.sWb;this.GPd=(new Date(0)).getTime();this.Y3=this.Nbi();this.oj.Jql(this.Y3);this.Y3.stateChanged(La=>{this.Y3k(La,Ea)});this.Y3.connectionSlow(Object(e.a)(this,this.p$k,"onSlowConnection"));this.Y3.error(Object(e.a)(this,this.a$k,"onSignalRError"));this.Y3.log=Object(e.a)(this,this.b$k,"onSignalRLog")}OUb(Ea,La){return Ea!==this.sWb?(k.ULS.sendTraceTag(508396226,500,50,"ConnectionToken verification failed for {0}",La),!1):!0}connect(){2!==this.U_&&1!==this.U_&&(k.ULS.sendTraceTag(4539721,
500,50,"Starting a new RTC connection for client [{0}]",this.Dq),this.FJd.U3k(),C.a.instance.o5l(),this.Hpa(1,this.U_),this.iUh())}disconnect(){const {FrequentLoggingMetrics:Ea}=d(309);0===this.U_?k.ULS.sendTraceTag(508396194,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Dq):(this.Fu.QAh(),Ea.instance&&(Ea.instance.uLd=!0),k.ULS.sendTraceTag(508396193,500,50,"Starting explicit disconnect for [{0}]",this.Dq),this.hNa.hbb=!0,this.FJd.F4k(),this.Hpa(0,this.U_),
this.T7b(),this.hNa.hbb=!1)}c6l(Ea){const La=this.cPi(),xb=this.Y3,dc=this.S_,gb=()=>{if(this.UVd)k.ULS.sendTraceTag(508396191,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.UVd=!0,xb.stop(!0,Ea)}catch(gc){k.ULS.sendTraceTag(508396192,500,15,"Stopping connection failed: {0}",gc.message)}};0<La?(k.ULS.sendTraceTag(508396190,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",dc,La),window.setTimeout(gb,La)):(k.ULS.sendTraceTag(508396189,500,50,"Stopping connection [{0}].",
dc),gb())}cPi(){let Ea=0;0===this.Y3.state&&(Ea=this.GPd+Ya.lom-(new Date).getTime(),0>Ea&&(Ea=0));return Ea}get connectionState(){return this.U_}C9a(Ea){this.oj.C9a(Ea)}Z6e(Ea){return this.Yxd(0,Ea)}Yxd(Ea,La){const xb=new n.a;this.oj.Kzh(Ea,La,xb);return xb.task}vOc(Ea){this.oj.vOc(Ea)}Fva(Ea){return this.bRj(Ea)}zZc(){return this.auj()}auj(){const Ea={};for(const La of this.TT)La.value.Ib(0)&&(Ea[La.key]=La.value.ga(0).data);return Ea}bRj(Ea){return this.TT.Ib(Ea)&&this.TT.ga(Ea).Ib(0)?this.TT.ga(Ea).ga(0).data:
null}$tj(){const Ea=new Q.a;if(!this.TT.Ib(this._clientId))return Ea;for(const La of this.TT.ga(this._clientId))Ea.$(La.key,La.value.data);return Ea}gca(Ea,La=null,xb=!1){const dc=new n.a;this.oj.n1e(Ea,La,xb,dc);return dc.task}fEa(Ea){this.oj.fEa(Ea)}fGj(){return this.v5(this._clientId)}v5(Ea){let La,xb;return({value:La}=this.TT.Eg(Ea)).returnValue&&({value:xb}=La.Eg(0)).returnValue?new y(this.fRj(xb),xb.timeStamp):null}juj(){const Ea={};for(const La of this.TT)La.value.Eg(0).returnValue&&(Ea[La.key]=
this.v5(La.key));return Ea}S4a(Ea){const La=new n.a;this.oj.Rrl(Ea,La);return La.task}get clientId(){return this._clientId}get l2l(){return this.zoi}dispose(){var Ea;const {FrequentLoggingMetrics:La}=d(309);if(!this.IL){if(null===(Ea=D.AFrameworkApplication.fa)||void 0===Ea?0:Ea.getBooleanAppSetting("DetachRtcEventHandlerOnDispose"))this.Saj(),this.hNa.Taj();this.hNa.yBa();this.Bi.oPb(this.Fu);this.Fu.V1e();La.instance&&La.instance.GAe();this.IL=!0}}Y3k(Ea,La){this.OUb(La,"StateChangedSignalR")&&
this.Hpa(this.y_f(Ea.newState),this.y_f(Ea.oldState))}Hpa(Ea,La){var {FrequentLoggingMetrics:xb}=d(309),{ClientToClientMessageTelemetry:dc}=d(1083);if((1!==this.U_||0!==La||1!==Ea)&&this.U_!==La){const gb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.U_,La,Ea]));k.ULS.sendTraceTag(508396188,500,10,gb)}if(this.U_!==Ea){switch(Ea){case 2:xb.instance&&xb.instance.VVk();this.S_=this.Y3.id;k.ULS.sendTraceTag(3249539,
500,50,"Established connection [{0}] for client [{1}]",this.S_,this.Dq);this.qEk(this.Y3);k.ULS.sendTraceTag(508396186,500,50,"Retrieving complete session state");xb=null;this.Di&&(xb=this.Di.lj("WebServiceCall","Receive First Presence"));dc=this.sWb;this.oj.Iql(Object(e.a)(this,this.OUb,"verifyConnectionToken"),dc,this.FJd,this.M4d,this.$tj(),xb);this.nd.qIl&&(xb=100*Math.random()<=this.nd.rIl,d(1083).ClientToClientMessageTelemetry.nHj(this.oj,this.nd,xb).start());break;case 1:2===La&&k.ULS.sendTraceTag(508396185,
500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.S_);break;case 0:if(dc.instance&&dc.instance.stop(),this.hNa.hbb)k.ULS.sendTraceTag(508396182,500,50,"Connection [{0}] has been explicitly closed",this.S_);else{1===La&&(k.ULS.sendTraceTag(508396184,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.S_),this.Fu.gvc());2===La&&k.ULS.sendTraceTag(508396183,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.S_);this.T7b();return}}this.U_=Ea;this.oj.rpl(Ea,La)}}Saj(){this.oj.hCl(this.T7b);this.oj.XCl(this.Tqh);this.oj.WCl(this.Sqh);this.oj.rCl(this.T1h)}qEk(Ea){if(Ea&&Ea.transport&&Ea.transport.name){Ea=Ea.transport.name;var La=Ea.toLowerCase();"websockets"===La?k.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Ea,this.Dq):"serversentevents"===La?k.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",Ea,this.Dq):"foreverframe"===La?k.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",
Ea,this.Dq):"longpolling"===La?k.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",Ea,this.Dq):"mocktransport"!==La&&k.ULS.sendTraceTag(508396180,500,15,"Unknown transport protocol encountered - '{0}'",Ea)}else k.ULS.sendTraceTag(508396181,500,10,"Transport protocol name is missing")}p$k(){if(this.nd.XHh){const Ea=m.a.VO(this.qpa,"mid");k.ULS.sendTraceTag(508396178,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.S_,Ea)}else k.ULS.sendTraceTag(508396177,
500,50,"Detected that the connection [{0}] is slow",this.S_)}a$k(){k.ULS.sendTraceTag(508396176,600,15,"SignalR ERROR for connection [{0}];",this.S_)}b$k(Ea){Ea=d(191).RtcUtils.ULb(Ea);if(this.nd.XHh&&Ea.startsWith("Keep alive timed out.")){const La=m.a.VO(this.qpa,"mid");k.ULS.sendTraceTag(508396175,500,15,"SignalR lib: {0}. Target Machine: {1}",Ea,La)}else this.l2l&&2E3>this.VFf&&!Ea.startsWith("Invok")&&!Ea.startsWith("Trigger")&&(k.ULS.sendTraceTag(508396174,500,50,"SignalR lib: {0}",Ea),this.VFf++)}y_f(Ea){switch(Ea){case 0:return 1;
case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Ea,"Unknown SignalR state");}}fRj(Ea){return Ea&&Ea.timeStamp?(new Date).getTime()-Ea.timeStamp.getTime()>(this.nd.M1d?6E4:this.nd.awayCoauthorThresholdMs)?2:1:1}static createInstance(Ea,La,xb,dc,gb,gc,Ac,$b=null,jc=null,pb=null,$a=null,zc=null,rb=null){return Pa(Ea,La,xb,rb,dc,gb,gc,Ac,$b,jc,pb,zc,$a)}}Ya.lom=15E3;Object(L.a)(Ya,"RealtimeChannel",null,[661,662])},719:function(L,V,d){L=d(0);class k extends Sys.EventArgs{constructor(U,
Q){super();this.newState=U;this.oldState=Q}}Object(L.a)(k,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(U,Q){super();this.HUi=U;this.pOa=Q}}Object(L.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(U){super();this.presence=U}}Object(L.a)(n,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(U){super();this.f5d=U}}Object(L.a)(r,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);
class w extends Sys.EventArgs{constructor(U,Q){super();this.type=U;this.DUb=Q}}Object(L.a)(w,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var D=d(1190);class y extends Sys.EventArgs{constructor(U,Q=null){super();this.OH=U;this.Vqi=Q}get type(){return this.OH}get zBa(){return this.Vqi}}Object(L.a)(y,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class m extends Sys.EventArgs{constructor(U){super();this.tkl=U}}Object(L.a)(m,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);
class C extends Sys.EventArgs{constructor(U,Q,G,Y,ba,ha){super();this.OUb=U;this.n6d=Q;this.xZi=G;this.R$f=ba;this.M4d=Y;this.Lz=ha}}Object(L.a)(C,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(U){super();this.hubConnection=U}}Object(L.a)(E,"RefreshProxyEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(U,Q){super();this.Glj=U;this.errorMessage=Q}}Object(L.a)(F,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class B extends Sys.EventArgs{constructor(U,
Q,G){super();this.type=U;this.presence=Q;this.pOa=G}}Object(L.a)(B,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var H=d(1024);class K extends Sys.EventArgs{constructor(){super()}}Object(L.a)(K,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(U){super();this.f5d=U}}Object(L.a)(A,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class W extends Sys.EventArgs{constructor(U,Q){super();this.type=U;this.plm=Q}}Object(L.a)(W,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var N=d(75);d.d(V,"a",function(){return P});class P{constructor(){this.Ma=new N.a}rpl(U,Q){this.Ma.raiseEvent("CSC",new k(U,Q))}Jql(U){this.Ma.raiseEvent("RP",new E(U))}oud(U){this.Ma.raiseEvent("RC",U)}Oql(){this.Ma.raiseEvent("RMID")}Iql(U,Q,G,Y,ba,ha){this.Ma.raiseEvent("RPS",new C(U,Q,G,Y,ba,ha))}gAh(U,Q){this.Ma.raiseEvent("UPSR",new W(U,Q))}yzh(U,Q){this.Ma.raiseEvent("PU",new D.a(U,Q))}hql(U){this.Ma.raiseEvent("MPU",new n(U))}n1e(U,Q,G,Y){this.Ma.raiseEvent("SUN",new H.a(U,
Q,G,Y))}Srl(U,Q){this.Ma.raiseEvent("UNR",new y(U,Q))}Kzh(U,Q,G){this.Ma.raiseEvent("SP",new B(U,Q,G))}uzh(U,Q){this.Ma.raiseEvent("PSU",new w(U,Q))}zql(U){this.Ma.raiseEvent("PSC",new r(U))}Zpl(U){this.Ma.raiseEvent("IPSC",new r(U))}Trl(U){this.Ma.raiseEvent("UPSC",new A(U))}Xql(U,Q){this.Ma.raiseEvent("SPC",new K(U,Q))}Hzh(U,Q){this.Ma.raiseEvent("RCF",new F(U,Q))}Qpl(U){this.Ma.raiseEvent("CPSWM",new m(U))}Rrl(U,Q){this.Ma.raiseEvent("UCI",new e(U,Q))}C9a(U){this.Ma.addHandler("CSC",U)}kAi(U){this.Ma.addHandler("RP",
U)}iCl(U){this.Ma.removeHandler("RP",U)}jAi(U){this.Ma.addHandler("RC",U)}hCl(U){this.Ma.removeHandler("RC",U)}pAi(U){this.Ma.addHandler("RMID",U)}iAi(U){this.Ma.addHandler("RPS",U)}gCl(U){this.Ma.removeHandler("RPS",U)}pBi(U){this.Ma.addHandler("UPSR",U)}XCl(U){this.Ma.removeHandler("UPSR",U)}vOc(U){this.Ma.addHandler("PU",U)}byi(U){this.Ma.addHandler("IPU",U)}RAl(U){this.Ma.removeHandler("IPU",U)}nBi(U){this.Ma.addHandler("UCI",U)}VCl(U){this.Ma.removeHandler("UCI",U)}wAi(U){this.Ma.addHandler("SUN",
U)}pCl(U){this.Ma.removeHandler("SUN",U)}cyi(U){this.Ma.addHandler("IUNR",U)}SAl(U){this.Ma.removeHandler("IUNR",U)}fEa(U){this.Ma.addHandler("UNR",U)}ayi(U){this.Ma.addHandler("IPSU",U)}QAl(U){this.Ma.removeHandler("IPSU",U)}$xi(U){this.Ma.addHandler("IPSC",U)}PAl(U){this.Ma.removeHandler("IPSC",U)}oBi(U){this.Ma.addHandler("UPSC",U)}WCl(U){this.Ma.removeHandler("UPSC",U)}vAi(U){this.Ma.addHandler("SP",U)}oCl(U){this.Ma.removeHandler("SP",U)}nMf(U){this.Ma.addHandler("SPC",U)}rCl(U){this.Ma.removeHandler("SPC",
U)}tAi(U){this.Ma.addHandler("RCF",U)}Vxi(U){this.Ma.addHandler("CPSWM",U)}LAl(U){this.Ma.removeHandler("CPSWM",U)}static getInstance(){return P.Ja||(P.Ja=new P)}}P.Ja=null;Object(L.a)(P,"RtcEventHub",null,[712])},753:function(L,V,d){L=d(0);class k{constructor(){this.Qof=this.CJd=!1;this.callback=null}Qqc(n){this.callback=n;this.sZh()}agh(n){this.CJd||(this.CJd=!0,this.Kbi=n,this.sZh())}sZh(){this.CJd&&this.callback&&!this.Qof&&(this.Qof=!0,this.callback(this.Kbi))}}Object(L.a)(k,"CompletionTask",
null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.Szf=new k;this.Qzf=new k}mpd(n){this.Szf.Qqc(n)}lpd(n){this.Qzf.Qqc(n)}upc(n){this.Szf.agh(n)}K0a(n){this.Qzf.agh(n)}HQe(){this.upc(2);this.K0a(2)}}Object(L.a)(e,"MessageStatus",null,[772])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.presence1.js.map
(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[51],{2235:function(e,t,n){"use strict";n.r(t);var r=n(857);n.d(t,"launchAsync",(function(){return r.launchAsync}));var o=n(858);n.d(t,"v0_7_1",(function(){return o}))},857:function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookiePolicy=void 0,function(e){e[e.Disable=0]="Disable",e[e.Enable=1]="Enable"}(t.CookiePolicy||(t.CookiePolicy={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookiePolicy=t.launchWithoutContentAsync=t.launchAsync=t.close=t.renderButtons=void 0;var r=n(2);Object.defineProperty(t,"renderButtons",{enumerable:!0,get:function(){return r.renderButtons}});var o=n(3);Object.defineProperty(t,"close",{enumerable:!0,get:function(){return o.close}}),Object.defineProperty(t,"launchAsync",{enumerable:!0,get:function(){return o.launchAsync}}),Object.defineProperty(t,"launchWithoutContentAsync",{enumerable:!0,get:function(){return o.launchWithoutContentAsync}});var i=n(0);Object.defineProperty(t,"CookiePolicy",{enumerable:!0,get:function(){return i.CookiePolicy}}),"undefined"!=typeof window&&window.addEventListener("load",(function(){var e;window.hasOwnProperty("Promise")||((e=document.createElement("script")).src="https://contentstorage.onenote.office.net/onenoteltir/permanent-static-resources/promise-polyfill.min.js",document.head.appendChild(e)),r.renderButtons()}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderButtons=void 0;var r={af:"Indompelende leser",am:"በህያው ስሜት ፈጣሪ ዕይታ አንባቢ",ar:"القارئ الشامل",as:"ইমাৰচিভ ৰিডাৰ",az:"İmmersiv Oxuyucu",be:"Імерсіўны чытальнік",bg:"Концентриран четец",bn:"মনোগ্রাহী পাঠক","bn-bd":"ইমার্সিভ পাঠক",bs:"Koncentrirani čitalac",ca:"Lector immersiu",cs:"Asistivní čtečka","cy-gb":"Darllenydd Ymdrwythol",da:"Forenklet læser",de:"Plastischer Reader",el:"Προηγμένο πρόγραμμα ανάγνωσης",en:"Immersive Reader",es:"Lector inmersivo",et:"Süvaluger",eu:"Irakurgailu murgiltzailea",fa:"خواننده همه‌جانبه",fi:"Syventävä lukuohjelma",fil:"Immersive Reader",fr:"Lecteur immersif","ga-ie":"Léitheoir tumthach",gd:"An leughadair ùr-nòsach",gl:"Lector avanzado",gu:"ઇમર્સિવ રીડર",ha:"Mai karatu Mai barbazawa",he:"תצוגת קריאה מודרנית",hi:"इमर्सिव रीडर",hr:"Stopljeni čitač",hu:"Modern olvasó",hy:"Խորասուզված ընթերցիչ",id:"Pembaca Imersif",ig:"Ọgụụ Kenzipụtara",is:"Aðgengilegt lestrarumhverfi",it:"Strumento di lettura immersiva",ja:"イマーシブ リーダー",ka:"იმერსიული წამკითხველი",kk:"Иммерсивті оқу құралы",km:"កម្មវិធីអានពណ៌រំលេចនៅលើអេក្រង់",kn:"ಇಮ್ಮರ್ಸಿವ್ ಓದುಗ",ko:"몰입형 리더",kok:"तंद्री लागिल्लो वाचक","ku-arab":"خوێنەری پڕ",ky:"Курчаган Окугуч",lb:"Immersive Reader",lo:"ຕົວອ່ານອິມເມີສີບ",lt:"Įtraukianti skaitytuvė",lv:"Tīrskata lasītājs",mi:"Pūpānui Rumaki",mk:"Сеопфатен читач",ml:"ഇമ്മേഴ്‌സീവ് റീഡർ",mn:"Идэвхтэй уншигч",mr:"इमर्सिव्ह वाचक",ms:"Pembaca Imersif",mt:"Qarrej Immersiv",ne:"इमेर्सिभ रिडर",nl:"Insluitende lezer","nn-no":"Engasjerande lesar",no:"Engasjerende leser",nso:"Go Bala ka Mongwalo o Mokoto",or:"ଇମରସିଭ୍ ରିଡର୍",pa:"ਇਮਰਸਿਵ ਰੀਡਰ","pa-arab":"گھیرن آلا مطالعہ کار",pl:"Czytnik immersyjny",prs:"خواننده نمایش",pt:"Leitura Avançada",quc:"Nim ucholajil sik'inel uwach",quz:"Wankisqa Ñawiq",ro:"Immersive Reader",ru:"Иммерсивное средство чтения",rw:"Insakazasoma",sd:"امرسو ريڊر",si:"ගිලෙන සුළු කියවනය",sk:"Imerzná čítačka",sl:"Potopni bralnik",sq:"Lexuesi kredhës","sr-cyrl-ba":"Концентрисани читалац","sr-cyrl-rs":"Концентрисани читалац","sr-latn-rs":"Koncentrisani čitalac",sv:"Avancerad läsare",sw:"Kisomaji cha Kuzamisha",ta:"அற்புதமான ரீடர்",te:"మంత్రముగ్ధులను చేసే పఠన సాధనం","tg-cyrl-tj":"Хонандаи фарогир",th:"โปรแกรมช่วยอ่าน",ti:"ኣንባቢ ሕሉው ስምዒት ፈጣሪ",tk:"Giňişleýin okaýjy",tn:"Sebadi sa Imesife",tr:"Tam Ekran Okuyucu",tt:"Чолгап алучы уку чарасы","ug-cn":"چۆكمە ئوقۇغۇچ",uk:"Занурення в текст",ur:"امرسیو مطالعہ کار",uz:"Immersiv mutolaa vositasi",vi:"Trình đọc Chân thực",wo:"Jàngukaay bu Rafet",xh:"Isifundi Esikhulu",yo:"Ìwò Alámùtán",zh:"沉浸式阅读器","zh-hant":"沈浸式閱讀程式",zu:"Isifundi Sokuzizwisa"};function o(e){var t=document.createElement("img");t.src="https://contentstorage.onenote.office.net/onenoteltir/permanent-static-resources/immersive-reader-icon.svg";var n=e.getAttribute("data-icon-px-size")||"20";t.style.height=t.style.width=n+"px",t.style.verticalAlign="middle",t.style.marginTop="-2px";var r=e.getAttribute("data-locale")||"en";t.alt=s(r),e.appendChild(t)}function i(e){var t=document.createElement("span");t.style.marginLeft="8px",e.appendChild(t)}function a(e){var t=document.createElement("span"),n=e.getAttribute("data-locale")||"en";t.textContent=s(n),e.appendChild(t)}function s(e){return e=e.toLowerCase(),r[e]?r[e]:"zh-hk"===e||"zh-mo"===e||"zh-tw"===e?r["zh-hant"]:(e=e.substring(0,e.lastIndexOf("-")),r[e]?r[e]:(e=e.substring(0,e.lastIndexOf("-")),r[e]?r[e]:r.en))}t.renderButtons=function(e){var t=document.createElement("style");t.innerHTML=".immersive-reader-button{cursor:pointer;display:inline-block;padding:5px;} .immersive-reader-button:hover{background:rgba(0,0,0,.05);border-radius:2px",document.head.appendChild(t);var n=[].slice.call(document.getElementsByClassName("immersive-reader-button"));e&&e.elements&&(n=e.elements);for(var r=0,d=n;r<d.length;r++){var l=d[r];l.setAttribute("role","button");var u=l.getAttribute("data-locale")||"en";switch(l.setAttribute("aria-label",s(u)),l.textContent="",l.getAttribute("data-button-style")||"icon"){case"icon":o(l);break;case"text":a(l);break;case"iconAndText":o(l),i(l),a(l)}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.close=t.resetLoadingForTest=t.launchWithoutContentAsync=t.launchAsync=void 0;var o=n(0),i=n(4),a={};a[i.ErrorCode.TokenExpired]="The access token supplied is expired.",a[i.ErrorCode.Throttled]="You have exceeded your quota.",a[i.ErrorCode.ServerError]="An error occurred when calling the server to process the text.",a[i.ErrorCode.InvalidSubdomain]="The subdomain supplied is invalid.";var s,d,l,u,c=!1,m=!1;t.launchAsync=function(e,t,n,s){return c?Promise.reject("Immersive Reader is already launching"):new Promise((function(d,l){if(e)if(n)if(n.chunks)if(n.chunks.length){c=!0;var u=Date.now();(s=r({uiZIndex:1e3,timeout:15e3,useWebview:!1,allowFullscreen:!0,hideExitButton:!1,cookiePolicy:o.CookiePolicy.Disable},s)).uiZIndex&&"number"==typeof s.uiZIndex||(s.uiZIndex=1e3);var m=s.parent?s.parent:document.body,p=null,h=document.createElement("div"),v=s.useWebview?document.createElement("webview"):document.createElement("iframe");v.allow="autoplay",v.title="Immersive Reader Frame",v.setAttribute("aria-modal","true");var f=document.createElement("style");f.innerHTML="body{height:100%;overflow:hidden;}";var g=function(){p&&(window.clearTimeout(p),p=null)},y=function(){m.contains(h)&&m.removeChild(h),window.removeEventListener("message",w),g(),f.parentNode&&f.parentNode.removeChild(f)},b=function(){if(y(),s.onExit)try{s.onExit()}catch(e){}};y();var w=function(r){if(r&&r.data&&"string"==typeof r.data)if("ImmersiveReader-ReadyForContent"===r.data){g();var o={cogSvcsAccessToken:e,cogSvcsSubdomain:t,request:n,launchToPostMessageSentDurationInMs:Date.now()-u,disableFirstRun:s.disableFirstRun,readAloudOptions:s.readAloudOptions,translationOptions:s.translationOptions,displayOptions:s.displayOptions,sendPreferences:!!s.onPreferencesChanged,preferences:s.preferences};v.contentWindow.postMessage(JSON.stringify({messageType:"Content",messageValue:o}),"*")}else if("ImmersiveReader-Exit"===r.data)b();else if(r.data.startsWith("ImmersiveReader-LaunchResponse:")){var m=null,p=null,f=null;try{f=JSON.parse(r.data.substring("ImmersiveReader-LaunchResponse:".length))}catch(e){}if(f&&f.success){var y={command:"PlayState",parameters:"Play"},w={command:"PlayState",parameters:"Pause"};m={container:h,sessionId:f.sessionId,charactersProcessed:f.meteredContentSize,postLaunchOperations:{pause:function(){v.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:w}),"*")},play:function(){v.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:y}),"*")}}}}else p=f&&!f.success?{code:f.errorCode,message:a[f.errorCode],sessionId:f.sessionId}:{code:i.ErrorCode.ServerError,message:a[i.ErrorCode.ServerError]};c=!1,m?(g(),d(m)):p&&(b(),l(p))}else if(r.data.startsWith("ImmersiveReader-Preferences:")&&s.onPreferencesChanged&&"function"==typeof s.onPreferencesChanged)try{s.onPreferencesChanged(r.data.substring("ImmersiveReader-Preferences:".length))}catch(e){}};window.addEventListener("message",w),p=window.setTimeout((function(){y(),c=!1,l({code:i.ErrorCode.Timeout,message:"Page failed to load after timeout ("+s.timeout+" ms)"})}),s.timeout),s.allowFullscreen&&v.setAttribute("allowfullscreen",""),v.style.cssText=s.parent?"position: static; width: 100%; height: 100%; left: 0; top: 0; border-width: 0":"position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0",s.useWebview&&v.addEventListener("loadstop",(function(){v.contentWindow.postMessage(JSON.stringify({messageType:"WebviewHost"}),"*")}));var C=(s.customDomain?s.customDomain:"https://learningtools.onenote.com/learningtoolsapp/cognitive/")+"reader?exitCallback=ImmersiveReader-Exit&sdkPlatform=js&sdkVersion=0.5.4";C+="&cookiePolicy="+(s.cookiePolicy===o.CookiePolicy.Enable?"enable":"disable"),s.hideExitButton&&(C+="&hideExitButton=true"),s.uiLang&&(C+="&omkt="+s.uiLang),v.src=C,h.style.cssText=s.parent?"position: relative; width: 100%; height: 100%; border-width: 0; -webkit-perspective: 1px; z-index: "+s.uiZIndex+"; background: white; overflow: hidden":"position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: "+s.uiZIndex+"; background: white; overflow: hidden",h.appendChild(v),m.appendChild(h),document.head.appendChild(f)}else l({code:i.ErrorCode.BadArgument,message:"Chunks must not be empty"});else l({code:i.ErrorCode.BadArgument,message:"Chunks must not be null"});else l({code:i.ErrorCode.BadArgument,message:"Content must not be null"});else l({code:i.ErrorCode.BadArgument,message:"Token must not be null"})}))},t.launchWithoutContentAsync=function(e){if(c)return Promise.reject("Immersive Reader is already launching");c=!0;var t=Date.now();(e=r({uiZIndex:1e3,timeout:15e3,useWebview:!1,allowFullscreen:!0,hideExitButton:!1,cookiePolicy:o.CookiePolicy.Disable},e)).uiZIndex&&"number"==typeof e.uiZIndex||(e.uiZIndex=1e3);var n=null,p=document.createElement("div"),h=e.useWebview?document.createElement("webview"):document.createElement("iframe");h.allow="autoplay",h.title="Immersive Reader Frame",h.setAttribute("aria-modal","true");var v=document.createElement("style");v.innerHTML="body{height:100%;overflow:hidden;}";var f=function(){n&&(window.clearTimeout(n),n=null)},g=function(){document.body.contains(p)&&document.body.removeChild(p),window.removeEventListener("message",w),c=!1,m=!1,s=null,f(),v.parentNode&&v.parentNode.removeChild(v)},y=function(){if(g(),e.onExit)try{e.onExit()}catch(e){}},b=function(){if(m&&s){var n={apiResponse:s,launchToPostMessageSentDurationInMs:Date.now()-t,disableFirstRun:e.disableFirstRun,readAloudOptions:e.readAloudOptions,translationOptions:e.translationOptions,displayOptions:e.displayOptions,sendPreferences:!!e.onPreferencesChanged,preferences:e.preferences};h.contentWindow.postMessage(JSON.stringify({messageType:"ContentModelWithOptions",messageValue:n}),"*")}},w=function(t){if(t&&t.data&&"string"==typeof t.data)if("ImmersiveReader-ReadyForContent"===t.data)f(),m=!0,b();else if("ImmersiveReader-Exit"===t.data)y();else if(t.data.startsWith("ImmersiveReader-LaunchResponse:")){var n=null,r=null,o=null;try{o=JSON.parse(t.data.substring("ImmersiveReader-LaunchResponse:".length))}catch(e){}if(o&&o.success){var s={command:"PlayState",parameters:"Play"},u={command:"PlayState",parameters:"Pause"};n={container:p,sessionId:o.sessionId,charactersProcessed:o.meteredContentSize,postLaunchOperations:{pause:function(){h.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:u}),"*")},play:function(){h.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:s}),"*")}}}}else r=o&&!o.success?{code:o.errorCode,message:a[o.errorCode],sessionId:o.sessionId}:{code:i.ErrorCode.ServerError,message:a[i.ErrorCode.ServerError]};c=!1,n?(f(),d&&d(n)):r&&(y(),l&&l(r))}else if(t.data.startsWith("ImmersiveReader-Preferences:")&&e.onPreferencesChanged&&"function"==typeof e.onPreferencesChanged)try{e.onPreferencesChanged(t.data.substring("ImmersiveReader-Preferences:".length))}catch(e){}};g(),window.addEventListener("message",w),n=window.setTimeout((function(){g(),c=!1;var t={code:i.ErrorCode.Timeout,message:"Page failed to load after timeout ("+e.timeout+" ms)"};l?l(t):u=t}),e.timeout),e.allowFullscreen&&h.setAttribute("allowfullscreen",""),h.style.cssText="position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0",e.useWebview&&h.addEventListener("loadstop",(function(){h.contentWindow.postMessage(JSON.stringify({messageType:"WebviewHost"}),"*")}));var C="https://learningtools.onenote.com/learningtoolsapp/cognitive/reader?exitCallback=ImmersiveReader-Exit&skipearlygcm=true&sdkPlatform=js&sdkVersion=0.5.4";C+="&cookiePolicy="+(e.cookiePolicy===o.CookiePolicy.Enable?"enable":"disable"),e.hideExitButton&&(C+="&hideExitButton=true"),e.uiLang&&(C+="&omkt="+e.uiLang),h.src=C,p.style.cssText="position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: "+e.uiZIndex+"; background: white; overflow: hidden",p.appendChild(h),document.body.appendChild(p),document.head.appendChild(v);var k={cancelAndCloseReader:y,provideApiResponse:function(e){return e?200!==e.status?Promise.reject({code:i.ErrorCode.BadArgument,message:"Unsuccessful Api Response"}):e.data?e.meta?(s=e,b(),new Promise((function(e,t){d=e,l=t,u&&(t(u),u=null)}))):Promise.reject({code:i.ErrorCode.BadArgument,message:"No meta in Api Response"}):Promise.reject({code:i.ErrorCode.BadArgument,message:"No data in Api Response"}):Promise.reject({code:i.ErrorCode.BadArgument,message:"No Api Response"})}};return new Promise((function(e,t){e(k)}))},t.resetLoadingForTest=function(){c=!1},t.close=function(){window.postMessage("ImmersiveReader-Exit","*")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=void 0,function(e){e.BadArgument="BadArgument",e.Timeout="Timeout",e.TokenExpired="TokenExpired",e.Throttled="Throttled",e.ServerError="ServerError",e.InvalidSubdomain="InvalidSubdomain"}(t.ErrorCode||(t.ErrorCode={}))}])},858:function(e,t,n){var r;self,r=()=>(()=>{"use strict";var e={150:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=void 0,(n=t.ErrorCode||(t.ErrorCode={})).BadArgument="BadArgument",n.Timeout="Timeout",n.TokenExpired="TokenExpired",n.Throttled="Throttled",n.ServerError="ServerError"},422:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=void 0;var r=n(848);t.initialize=function(e){var t=(e||{}).nonce;if(t&&""!==t){var n={nonce:t};r.renderButtons(n)}else r.renderButtons()}},925:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.close=t.resetLoadingForTest=t.launchWithoutContentAsync=t.launchAsync=void 0;var o=n(411),i=n(150),a="ImmersiveReader-Preferences:",s="ImmersiveReader-LaunchResponse:",d={};d[i.ErrorCode.TokenExpired]="The access token supplied is expired.",d[i.ErrorCode.Throttled]="You have exceeded your quota.",d[i.ErrorCode.ServerError]="An error occurred when calling the server to process the text.";var l,u,c=!1,m=null,p=null,h=null,v=null,f=null,g=null,y=0,b=0,w=null;!function(e){e[e.launchAsync=0]="launchAsync",e[e.launchWithoutContentAsync=1]="launchWithoutContentAsync"}(u||(u={}));var C,k,P,E=!1;function x(e){var t,n=e||{},i=n.onExit,a=n.parent,s=r({allowFullscreen:!0,cookiePolicy:o.CookiePolicy.Disable,hideExitButton:!1,onExit:i,timeout:15e3,uiZIndex:1e3,useWebview:!1},e);return s.uiZIndex&&"number"==typeof s.uiZIndex||(s.uiZIndex=1e3),function(e,t,n,r){p=e&&document.contains(e)?e:document.body,h=document.createElement("div"),(v=t?document.createElement("webview"):document.createElement("iframe")).allow="autoplay; microphone",v.title="Immersive Reader Frame",v.setAttribute("aria-modal","true"),n&&v.setAttribute("allowfullscreen",""),t&&v.addEventListener("loadstop",(function(){v.contentWindow.postMessage(JSON.stringify({messageType:"WebviewHost"}),"*")}));var o=(r||{}).iframeStyleOverrides;v.style.cssText=o||(e?"position: static; width: 100%; height: 100%; left: 0; top: 0; border-width: 0;":"position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0;"),(f=document.createElement("style")).innerHTML="body{height:100%;overflow:hidden;}",(null==r?void 0:r.nonce)&&""!==(null==r?void 0:r.nonce)&&f.setAttribute("nonce",r.nonce)}(a,s.useWebview,s.allowFullscreen,null===(t=s.internalOptions)||void 0===t?void 0:t.styleOverrides),s}function A(e,t,n){return function(r){var o;if(r&&r.data&&"string"==typeof r.data)if("ImmersiveReader-ReadyForContent"===r.data)switch(T(),t){case u.launchAsync:var l=n.content,m=n.startTime,p={cogSvcsAccessToken:n.token,request:l,launchToPostMessageSentDurationInMs:Date.now()-m,disableFirstRun:e.disableFirstRun,readAloudOptions:e.readAloudOptions,translationOptions:e.translationOptions,displayOptions:e.displayOptions,sendPreferences:!!e.onPreferencesChanged,preferences:e.preferences,internalOptions:null===(o=e.internalOptions)||void 0===o?void 0:o.messageOptions,disableTranslation:e.disableTranslation,disableGrammar:e.disableGrammar,disableLanguageDetection:e.disableLanguageDetection,providePlayPauseControl:e.providePlayPauseControl};y=Date.now()-m,b=m,v.contentWindow.postMessage(JSON.stringify({messageType:"Content",messageValue:p}),"*");break;case u.launchWithoutContentAsync:E=!0,y=Date.now()-n.startTime,b=n.startTime,(0,n.sendContentIfReady)()}else if("ImmersiveReader-Exit"===r.data)j(e.onExit);else if(r.data.startsWith(s)){var f=null,g=null,C=null;try{C=JSON.parse(r.data.substring(s.length)),w=C.gcmCorrelationId}catch(e){}if(C&&C.success){var x={command:"PlayState",parameters:"PlayIfWasPaused"},A={command:"PlayState",parameters:"PauseIfWasPlaying"};f={container:h,sessionId:C.sessionId,charactersProcessed:C.meteredContentSize,postLaunchOperations:!0===e.providePlayPauseControl?{pause:function(){v.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:A}),"*")},play:function(){v.contentWindow.postMessage(JSON.stringify({messageType:"InstrumentationCommand",messageValue:x}),"*")}}:null,readerReadyDuration:y,launchDuration:Date.now()-b,gcmCorrelationId:C.gcmCorrelationId}}else g=C&&!C.success?{code:C.errorCode,message:d[C.errorCode],sessionId:C.sessionId,readerReadyDuration:y,gcmCorrelationId:C.gcmCorrelationId,launchDuration:0}:{code:i.ErrorCode.ServerError,message:d[i.ErrorCode.ServerError]};switch(c=!1,t){case u.launchAsync:var I=n.reject,O=n.resolve;f?(T(),O(f)):g&&(j(e.onExit),I(g));break;case u.launchWithoutContentAsync:f?(T(),k&&k(f)):g&&(j(e.onExit),P&&P(g))}}else if(r.data.startsWith(a)&&e.onPreferencesChanged&&"function"==typeof e.onPreferencesChanged)try{e.onPreferencesChanged(r.data.substring(a.length))}catch(e){}}}function I(e,t){var n,r="reader?exitCallback=ImmersiveReader-Exit";t===u.launchWithoutContentAsync&&(r+="&skipearlygcm=true"),r+="&sdkPlatform=js&sdkVersion=0.7.1",r+="&cookiePolicy="+(e.cookiePolicy===o.CookiePolicy.Enable?"enable":"disable"),e.cognitiveAppId&&(r+="&cognitiveAppId="+e.cognitiveAppId),!1===e.showFeedback&&(r+="&showFeedback=false"),e.hideExitButton&&(r+="&hideExitButton=true"),e.uiLang&&(r+="&omkt="+e.uiLang);var i=null===(n=null==e?void 0:e.internalOptions)||void 0===n?void 0:n.queryParameters;for(var a in i)r+="&"+a+"="+i[a];return r}function O(e,t){var n=t||{},r=n.internalOptions,o=n.parent,i=n.uiZIndex,a=(r||{}).styleOverrides;v.src=e,(null==a?void 0:a.iframeContainerStyleOverrides)?h.style.cssText=null==a?void 0:a.iframeContainerStyleOverrides:h.style.cssText=o?"":"position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: "+i+"; background: white; overflow: hidden",h.appendChild(v),p.appendChild(h),document.head?document.head.appendChild(f):console.log("document.head is null - unable to disable body scrolling")}function T(){window.clearTimeout(m),m=null}function R(){p.contains(h)&&p.removeChild(h),window.removeEventListener("message",g),T(),f.parentNode&&f.parentNode.removeChild(f)}function j(e){if(R(),c=!1,e)try{e()}catch(e){console.log("Error on exit")}}t.launchAsync=function(e,t,n){return c?Promise.reject("Immersive Reader is already launching"):new Promise((function(r,o){if(e)if(t)if(t.chunks)if(t.chunks.length){c=!0;var a=Date.now();l=null,n=x(n);var s={content:t,reject:o,resolve:r,startTime:a,token:e};g=A(n,u.launchAsync,s),R(),window.addEventListener("message",g),m=window.setTimeout((function(){R(),c=!1,o(l||{code:i.ErrorCode.Timeout,message:"Page failed to load after timeout ("+n.timeout+" ms)",readerReadyDuration:y,gcmCorrelationId:w,launchDuration:0})}),n.timeout),O((n.customDomain?n.customDomain:"https://learningtools.onenote.com/learningtoolsapp/cognitive/")+I(n,u.launchAsync),n),l&&o(l)}else o({code:i.ErrorCode.BadArgument,message:"Chunks must not be empty"});else o({code:i.ErrorCode.BadArgument,message:"Chunks must not be null"});else o({code:i.ErrorCode.BadArgument,message:"Content must not be null"});else o({code:i.ErrorCode.BadArgument,message:"Token must not be null"})}))},t.launchWithoutContentAsync=function(e){if(c)return Promise.reject("Immersive Reader is already launching");c=!0;var t=Date.now();l=null,e=x(e);var n=function(){var n;if(E&&C){var r={apiResponse:C,launchToPostMessageSentDurationInMs:Date.now()-t,disableFirstRun:e.disableFirstRun,readAloudOptions:e.readAloudOptions,translationOptions:e.translationOptions,displayOptions:e.displayOptions,sendPreferences:!!e.onPreferencesChanged,preferences:e.preferences,internalOptions:null===(n=e.internalOptions)||void 0===n?void 0:n.messageOptions,disableTranslation:e.disableTranslation,disableGrammar:e.disableGrammar,disableLanguageDetection:e.disableLanguageDetection,providePlayPauseControl:e.providePlayPauseControl};v.contentWindow.postMessage(JSON.stringify({messageType:"ContentModelWithOptions",messageValue:r}),"*")}},r={sendContentIfReady:n,startTime:t};g=A(e,u.launchWithoutContentAsync,r),R(),window.addEventListener("message",g),m=window.setTimeout((function(){R(),c=!1;var t={code:i.ErrorCode.Timeout,message:"Page failed to load after timeout ("+e.timeout+" ms)",readerReadyDuration:y};P?P(t):l?P(l):l=t}),e.timeout),O((e.customDomain?e.customDomain:"https://learningtools.onenote.com/learningtoolsapp/cognitive/")+I(e,u.launchWithoutContentAsync),e);var o={cancelAndCloseReader:function(){return j(e.onExit)},provideContentModelResponse:function(e){return e?200!==e.status?Promise.reject({code:i.ErrorCode.BadArgument,message:"Unsuccessful Api Response"}):e.data?e.meta?(C=e,n(),new Promise((function(e,t){k=e,P=t,l&&(t(l),l=null)}))):Promise.reject({code:i.ErrorCode.BadArgument,message:"No meta in Api Response"}):Promise.reject({code:i.ErrorCode.BadArgument,message:"No data in Api Response"}):Promise.reject({code:i.ErrorCode.BadArgument,message:"No Api Response"})}};return new Promise((function(e,t){e(o)}))},t.resetLoadingForTest=function(){c=!1},t.close=function(){window.postMessage("ImmersiveReader-Exit","*")}},411:(e,t)=>{var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeOption=t.CookiePolicy=void 0,(r=t.CookiePolicy||(t.CookiePolicy={}))[r.Disable=0]="Disable",r[r.Enable=1]="Enable",(n=t.ThemeOption||(t.ThemeOption={}))[n.Light=0]="Light",n[n.Dark=1]="Dark",n[n.Contrast=2]="Contrast"},848:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderButtons=void 0;var n="data-locale",r={af:"Indompelende leser",am:"በህያው ስሜት ፈጣሪ ዕይታ አንባቢ",ar:"القارئ الشامل",as:"ইমাৰচিভ ৰিডাৰ",az:"İmmersiv Oxuyucu",be:"Імерсіўны чытальнік",bg:"Концентриран четец",bn:"মনোগ্রাহী পাঠক","bn-bd":"ইমার্সিভ পাঠক",bs:"Koncentrirani čitalac",ca:"Lector immersiu",cs:"Asistivní čtečka","cy-gb":"Darllenydd Ymdrwythol",da:"Forenklet læser",de:"Plastischer Reader",el:"Προηγμένο πρόγραμμα ανάγνωσης",en:"Immersive Reader",es:"Lector inmersivo",et:"Süvaluger",eu:"Irakurgailu murgiltzailea",fa:"خواننده همه‌جانبه",fi:"Syventävä lukuohjelma",fil:"Immersive Reader",fr:"Lecteur immersif","ga-ie":"Léitheoir tumthach",gd:"An leughadair ùr-nòsach",gl:"Lector avanzado",gu:"ઇમર્સિવ રીડર",ha:"Mai karatu Mai barbazawa",he:"תצוגת קריאה מודרנית",hi:"इमर्सिव रीडर",hr:"Stopljeni čitač",hu:"Modern olvasó",hy:"Խորասուզված ընթերցիչ",id:"Pembaca Imersif",ig:"Ọgụụ Kenzipụtara",is:"Aðgengilegt lestrarumhverfi",it:"Strumento di lettura immersiva",ja:"イマーシブ リーダー",ka:"იმერსიული წამკითხველი",kk:"Иммерсивті оқу құралы",km:"កម្មវិធីអានពណ៌រំលេចនៅលើអេក្រង់",kn:"ಇಮ್ಮರ್ಸಿವ್ ಓದುಗ",ko:"몰입형 리더",kok:"तंद्री लागिल्लो वाचक","ku-arab":"خوێنەری پڕ",ky:"Курчаган Окугуч",lb:"Immersive Reader",lo:"ຕົວອ່ານອິມເມີສີບ",lt:"Įtraukianti skaitytuvė",lv:"Tīrskata lasītājs",mi:"Pūpānui Rumaki",mk:"Сеопфатен читач",ml:"ഇമ്മേഴ്‌സീവ് റീഡർ",mn:"Идэвхтэй уншигч",mr:"इमर्सिव्ह वाचक",ms:"Pembaca Imersif",mt:"Qarrej Immersiv",ne:"इमेर्सिभ रिडर",nl:"Insluitende lezer","nn-no":"Engasjerande lesar",no:"Engasjerende leser",nso:"Go Bala ka Mongwalo o Mokoto",or:"ଇମରସିଭ୍ ରିଡର୍",pa:"ਇਮਰਸਿਵ ਰੀਡਰ","pa-arab":"گھیرن آلا مطالعہ کار",pl:"Czytnik immersyjny",prs:"خواننده نمایش",pt:"Leitura Avançada",quc:"Nim ucholajil sik'inel uwach",quz:"Wankisqa Ñawiq",ro:"Immersive Reader",ru:"Иммерсивное средство чтения",rw:"Insakazasoma",sd:"امرسو ريڊر",si:"ගිලෙන සුළු කියවනය",sk:"Imerzná čítačka",sl:"Potopni bralnik",sq:"Lexuesi kredhës","sr-cyrl-ba":"Концентрисани читалац","sr-cyrl-rs":"Концентрисани читалац","sr-latn-rs":"Koncentrisani čitalac",sv:"Avancerad läsare",sw:"Kisomaji cha Kuzamisha",ta:"அற்புதமான ரீடர்",te:"మంత్రముగ్ధులను చేసే పఠన సాధనం","tg-cyrl-tj":"Хонандаи фарогир",th:"โปรแกรมช่วยอ่าน",ti:"ኣንባቢ ሕሉው ስምዒት ፈጣሪ",tk:"Giňişleýin okaýjy",tn:"Sebadi sa Imesife",tr:"Tam Ekran Okuyucu",tt:"Чолгап алучы уку чарасы","ug-cn":"چۆكمە ئوقۇغۇچ",uk:"Занурення в текст",ur:"امرسیو مطالعہ کار",uz:"Immersiv mutolaa vositasi",vi:"Trình đọc Chân thực",wo:"Jàngukaay bu Rafet",xh:"Isifundi Esikhulu",yo:"Ìwò Alámùtán",zh:"沉浸式阅读器","zh-hant":"沈浸式閱讀程式",zu:"Isifundi Sokuzizwisa"};function o(e){var t=document.createElement("img");t.src="https://res-1.cdn.office.net/immersivereadersdk/permanent-static-resources/immersive-reader-icon.svg";var r=e.getAttribute("data-icon-px-size")||"20";t.style.height=t.style.width=r+"px",t.style.verticalAlign="middle",t.style.marginTop="-2px";var o=e.getAttribute(n)||"en";t.alt=s(o),e.appendChild(t)}function i(e){var t=document.createElement("span");t.style.marginLeft="8px",e.appendChild(t)}function a(e){var t=document.createElement("span"),r=e.getAttribute(n)||"en";t.textContent=s(r),e.appendChild(t)}function s(e){return e=e.toLowerCase(),r[e]?r[e]:"zh-hk"===e||"zh-mo"===e||"zh-tw"===e?r["zh-hant"]:(e=e.substring(0,e.lastIndexOf("-")),r[e]?r[e]:(e=e.substring(0,e.lastIndexOf("-")),r[e]?r[e]:r.en))}t.renderButtons=function(e){var t=document.createElement("style");t.innerHTML=".immersive-reader-button{cursor:pointer;display:inline-block;padding:5px;} .immersive-reader-button:hover{background:rgba(0,0,0,.05);border-radius:2px",e&&e.nonce&&t.setAttribute("nonce",e.nonce),document.head.appendChild(t);var r=[].slice.call(document.getElementsByClassName("immersive-reader-button"));e&&e.elements&&(r=e.elements);for(var d=0,l=r;d<l.length;d++){var u=l[d];u.setAttribute("role","button");var c=u.getAttribute(n)||"en";switch(u.setAttribute("aria-label",s(c)),u.textContent="",u.getAttribute("data-button-style")||"icon"){case"icon":o(u);break;case"text":a(u);break;case"iconAndText":o(u),i(u),a(u)}}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.CookiePolicy=e.launchWithoutContentAsync=e.launchAsync=e.close=e.initialize=void 0;var t=n(925);Object.defineProperty(e,"close",{enumerable:!0,get:function(){return t.close}}),Object.defineProperty(e,"launchAsync",{enumerable:!0,get:function(){return t.launchAsync}}),Object.defineProperty(e,"launchWithoutContentAsync",{enumerable:!0,get:function(){return t.launchWithoutContentAsync}});var o=n(411);Object.defineProperty(e,"CookiePolicy",{enumerable:!0,get:function(){return o.CookiePolicy}});var i=n(422);Object.defineProperty(e,"initialize",{enumerable:!0,get:function(){return i.initialize}}),"undefined"!=typeof window&&window.addEventListener("load",(function(){var e;window.hasOwnProperty("Promise")||((e=document.createElement("script")).src="https://res-1.cdn.office.net/immersivereadersdk/permanent-static-resources/promise-polyfill.min.js",document.head.appendChild(e))}))})(),r})(),e.exports=r()}}]);
//# sourceMappingURL=immersiveReader.min.js.map
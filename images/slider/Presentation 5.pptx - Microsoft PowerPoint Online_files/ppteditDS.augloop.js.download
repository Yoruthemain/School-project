'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1193:function(L,V,d){d.d(V,"b",function(){return k});d.d(V,"a",function(){return e});const {AugLoopTextEncoder:k,AugLoopTextDecoder:e}=(()=>{if("undefined"===typeof TextEncoder){d(1194);const n={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};TextDecoder=TextEncoder=void 0;return n}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},1194:function(L,V,d){(function(k,e){(function(n){function r(N,
P,U){if(N)throw Error("".concat("Failed to ").concat(P,": the '").concat(U,"' option is unsupported."));}function w(N){return e.from(N)}function D(N,P){var U;return N instanceof e?U=N:U=e.from(N.buffer,N.byteOffset,N.byteLength),U.toString(P)}function y(N){for(var P=0,U=Math.min(65536,N.length+1),Q=new Uint16Array(U),G=[],Y=0;;){var ba=P<N.length;if(!ba||Y>=U-1){if(G.push(String.fromCharCode.apply(null,Q.subarray(0,Y))),!ba)return G.join("");N=N.subarray(P);Y=P=0}ba=N[P++];if(0===(ba&128))Q[Y++]=
ba;else if(192===(ba&224)){var ha=N[P++]&63;Q[Y++]=(ba&31)<<6|ha}else if(224===(ba&240)){ha=N[P++]&63;var ka=N[P++]&63;Q[Y++]=(ba&31)<<12|ha<<6|ka}else if(240===(ba&248)){ha=N[P++]&63;ka=N[P++]&63;var ca=N[P++]&63;ba=(ba&7)<<18|ha<<12|ka<<6|ca;65535<ba&&(ba-=65536,Q[Y++]=ba>>>10&1023|55296,ba=56320|ba&1023);Q[Y++]=ba}}}function m(N){for(var P=0,U=N.length,Q=0,G=Math.max(32,U+(U>>>1)+7),Y=new Uint8Array(G>>>3<<3);P<U;){var ba=N.charCodeAt(P++);if(55296<=ba&&56319>=ba){if(P<U){var ha=N.charCodeAt(P);
56320===(ha&64512)&&(++P,ba=((ba&1023)<<10)+(ha&1023)+65536)}if(55296<=ba&&56319>=ba)continue}Q+4>Y.length&&(G+=8,G*=1+P/N.length*2,G=G>>>3<<3,ha=new Uint8Array(G),ha.set(Y),Y=ha);if(0===(ba&4294967168))Y[Q++]=ba;else{if(0===(ba&4294965248))Y[Q++]=ba>>>6&31|192;else if(0===(ba&4294901760))Y[Q++]=ba>>>12&15|224,Y[Q++]=ba>>>6&63|128;else if(0===(ba&4292870144))Y[Q++]=ba>>>18&7|240,Y[Q++]=ba>>>12&63|128,Y[Q++]=ba>>>6&63|128;else continue;Y[Q++]=ba&63|128}}return Y.slice?Y.slice(0,Q):Y.subarray(0,Q)}
function C(){this.encoding="utf-8"}function E(N,P){r(P&&P.fatal,"construct 'TextDecoder'","fatal");N=N||"utf-8";var U;if(F?U=e.lve(N):U=-1!==K.indexOf(N.toLowerCase()),!U)throw new RangeError("".concat(W," encoding label provided ('").concat(N,"') is invalid."));this.encoding=N;this.ignoreBOM=this.fatal=!1}var F="function"==typeof e&&e.from,B=F?w:m;C.prototype.encode=function(N,P){return r(P&&P.stream,"encode","stream"),B(N)};var H=!F&&"function"==typeof Blob&&"function"==typeof URL&&"function"==
typeof URL.createObjectURL,K=["utf-8","utf8","unicode-1-1-utf-8"],A=y;F?A=D:H&&(A=function(N){try{a:{try{var P=URL.createObjectURL(new Blob([N],{type:"text/plain;charset=UTF-8"}));var U=new XMLHttpRequest;var Q=(U.open("GET",P,!1),U.send(),U.responseText);break a}finally{P&&URL.revokeObjectURL(P)}Q=void 0}return Q}catch(G){return y(N)}});var W="".concat("Failed to "," ").concat("construct 'TextDecoder'",": the ");E.prototype.decode=function(N,P){r(P&&P.stream,"decode","stream");var U;return N instanceof
Uint8Array?U=N:N.buffer instanceof ArrayBuffer?U=new Uint8Array(N.buffer):U=new Uint8Array(N),A(U,this.encoding)};n.TextEncoder=n.TextEncoder||C;n.TextDecoder=n.TextDecoder||E})("undefined"!==typeof window?window:"undefined"!==typeof k?k:this)}).call(this,d(1007),d(706).GGd)},1195:function(L,V){Object.defineProperty(V,"__esModule",{value:!0});V.RewriteCompletionStatus=V.ContentType=V.RewriteSuggestionType=void 0;(function(d){d[d.Bullet=0]="Bullet";d[d.Concise=1]="Concise";d[d.Paraphrase=2]="Paraphrase";
d[d.Title=3]="Title"})(V.RewriteSuggestionType||(V.RewriteSuggestionType={}));(function(d){d[d.PLAIN_TEXT=0]="PLAIN_TEXT";d[d.HTML=1]="HTML";d[d.JSON=2]="JSON"})(V.ContentType||(V.ContentType={}));(function(d){d[d.Success=0]="Success";d[d.OffensiveContentInput=1]="OffensiveContentInput";d[d.OffensiveContentOutput=2]="OffensiveContentOutput";d[d.EmptyResponse=3]="EmptyResponse";d[d.OpenAiModelError=4]="OpenAiModelError";d[d.UnsupportedLanguage=5]="UnsupportedLanguage";d[d.Timeout=6]="Timeout";d[d.BadRequest=
7]="BadRequest";d[d.Unknown=8]="Unknown";d[d.UserNotAuthorized=9]="UserNotAuthorized";d[d.ParseFailure=10]="ParseFailure";d[d.RepeatedTitle=11]="RepeatedTitle"})(V.RewriteCompletionStatus||(V.RewriteCompletionStatus={}))},1196:function(L,V,d){Object.defineProperty(V,"__esModule",{value:!0});V.RewriteAnswer=void 0;const k=d(224);class e{constructor(n){k.SchemaObject.assign(e,this,n)}get metadata(){return this.M_}set metadata(n){this.M_=n}static getTypeName(){return"AugLoop_Rewrite_RewriteAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(n){return k.SchemaObject.matchesTypesFor(n,
[e.getTypeName()])}}V.RewriteAnswer=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1197:function(L,V){Object.defineProperty(V,"__esModule",{value:!0});V.RewriteType=void 0;L=V.RewriteType||(V.RewriteType={});L[L.Title=0]="Title";L[L.Subtitle=1]="Subtitle";L[L.Content=2]="Content"},1198:function(L,V,d){Object.defineProperty(V,"__esModule",{value:!0});V.RewriteSignal=void 0;const k=d(224);class e{constructor(n){k.SchemaObject.assign(e,this,n)}static getTypeName(){return"AugLoop_Rewrite_RewriteSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(n){return k.SchemaObject.matchesTypesFor(n,
[e.getTypeName()])}}V.RewriteSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1304:function(L,V,d){(function(k){d.d(V,"a",function(){return n});var e=d(1193);class n{static deserialize(r,w=D=>D){if(r[0]!==n.IDENTIFIERBYTE)throw Error("Invalid Binary: Incorrect Identifier");let D=1;const y=[],m=new DataView(r.buffer,r.byteOffset,r.byteLength);for(;D<r.byteLength;){if(D+4>r.byteLength)throw Error("Invalid Binary: Error reading fragment length");const C=m.getUint32(D);if(D+C+4>r.byteLength)throw Error("Invalid Binary: Fragment out of range");
"undefined"!==typeof k&&k.from?y.push(k.from(r.buffer,r.byteOffset+D+4,C)):y.push(new Uint8Array(r.buffer,r.byteOffset+D+4,C));D+=4+C}if(1>y.length)throw Error("Invalid Binary: No fragments found");r=n.textDecoder.decode(y[0]);return JSON.parse(r,(C,E)=>{if("string"===typeof E){if(E.substring(0,n.BINARYKEYWORD.length)===n.BINARYKEYWORD){C=parseInt(E.substring(n.BINARYKEYWORD.length),10);if("number"!==typeof C||C>=y.length-1)throw Error("Invalid Binary: Binary index out of range");return w(y[C+1])}if(E.substring(0,
n.ESCAPEKEYWORD.length)===n.ESCAPEKEYWORD)return E.substring(n.ESCAPEKEYWORD.length)}return E})}static serialize(r){const w=[void 0];r=JSON.stringify(r,(m,C)=>ArrayBuffer.isView(C)?(w.push(C),`${n.BINARYKEYWORD}${w.length-2}`):C&&"Buffer"===C.type&&Array.isArray(C.data)?(w.push(new Uint8Array(C.data)),`${n.BINARYKEYWORD}${w.length-2}`):"string"===typeof C&&C.substring(0,n.ESCAPEKEYWORD.length)===n.ESCAPEKEYWORD?n.ESCAPEKEYWORD+C:C);w[0]=n.textEncoder.encode(r);r=w.reduce((m,C)=>m+4+C.byteLength,0);
r=new Uint8Array(r+1);r[0]=n.IDENTIFIERBYTE;let D=1;const y=new DataView(r.buffer,r.byteOffset,r.byteLength);for(const m of w)y.setUint32(D,m.byteLength),r.set(m,D+4),D+=4+m.byteLength;return r}}n.IDENTIFIERBYTE=3;n.BINARYKEYWORD=":b";n.ESCAPEKEYWORD=":";n.textDecoder=new e.a;n.textEncoder=new e.b}).call(this,d(706).GGd)},1310:function(L,V,d){d.r(V);var k=d(0),e=d(395),n=d(25),r=d(55),w=d(68),D=d(18);class y{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(k.a)(y,
"AugmentationServiceRequest",null,[]);var m=d(35),C=d(71);class E{constructor(qa,hb,Gb){this.Rub=this.mta=null;this.$Ma=pc=>{!n.AFrameworkApplication.Dh&&pc&&pc.data&&this.R2k(pc.data.Ud)};this.YMa=pc=>{!n.AFrameworkApplication.Dh&&pc&&pc.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",pc.data.Ud)};this.P$h=Gb;this.La=hb;this.Bi=qa}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");const qa=this.La.Ea("AugmentationLoopWebServiceBase"),hb=this.La.Ea("WebServiceBase");
this.mta=(void 0===qa?hb:qa)+"proofing.ashx?"+n.AFrameworkApplication.mh+"&apitype=AL";this.Rub=new C.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(qa,hb){if(qa&&""!==qa)if(hb){if(!({value:Gb}=this.Rub.Eg(qa)).returnValue){var Gb=new D.a;this.Rub.add(qa,Gb)}Gb.contains(hb)||Gb.add(hb)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,306,15,"topic is empty or null")}removeEventHandler(qa,hb){qa&&""!==qa?hb?this.Rub.Ib(qa)?
({value:qa}=this.Rub.Eg(qa),qa&&qa.contains(hb)&&qa.remove(hb)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",qa):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}Q6e(qa,hb,Gb){this.dwc(qa,hb,Gb,this.$Ma,this.YMa)}dwc(qa,hb,Gb,pc,vd,zd=null){qa=Object.assign(new y,{Topic:qa,Payload:hb,AppId:this.P$h,SessionId:this.Bi.userSessionId,ContextId:Gb});this.Bi.Tj(this.mta,2,m.c(qa),{"Content-Type":"application/json; charset=utf-8"},
!1,3,pc,vd,zd?zd:qa,void 0,void 0,void 0,void 0,"18")}R2k(qa){if(qa){try{var hb=m.a(qa)}catch(Gb){e.ULS.sendTraceTag(36284437,306,10,"Try parse aug response failed:{0}",Gb.message);return}if(({value:qa}=this.Rub.Eg(hb.Topic)).returnValue)for(const Gb of qa)Gb(hb.ContextId,hb.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",hb.Topic)}}}Object(k.a)(E,"AugmentationManager",null,[1373]);var F=d(1264);class B{}Object(k.a)(B,"HostMetadata",null,[]);var H=d(708);class K{sendMessage(qa){e.ULS.sendTraceTag(508965922,
306,100,"AL send SDX message");H.a.CKh(qa)}registerMessageReceivedCallback(qa){e.ULS.sendTraceTag(508965921,306,50,"AL handle SDX message");H.a.dCh(qa)}}Object(k.a)(K,"SdxMessageBridge",null,[1381]);class A{}Object(k.a)(A,"Lambda",null,[]);class W extends A{constructor(){super()}}Object(k.a)(W,"WrapperLambda",A,[]);var N=d(470),P=d(123),U=d(197),Q=d(136);class G{constructor(){this.handler=this.schemaName=null}}Object(k.a)(G,"AddEventHandlerParameters",null,[]);var Y=d(672);class ba{constructor(){this.lambda=
this.name=null}}Object(k.a)(ba,"RegisterSimpleLocalWorkflowParameters",null,[]);class ha{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(k.a)(ha,"RegisterSimpleRemoteWorkflowParameters",null,[]);var ka=d(1009);class ca{constructor(){this.bridge=null}}Object(k.a)(ca,"SetMessageBridgeParameters",null,[]);class ia{constructor(){this.requestAuthTokenCallback=null}}Object(k.a)(ia,"SetRequestAuthTokenCallbackParameters",null,[]);class oa{constructor(){this.sendOTelEvent=
null}}Object(k.a)(oa,"SetSendOTelEventCallbackParameters",null,[]);class sa{constructor(){this.ulsLogger=null}}Object(k.a)(sa,"SetULSLoggerParameters",null,[]);var Ca=d(673);class Ta{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(k.a)(Ta,"SubmitParameters",null,[]);var R=d(540);class Ha{constructor(qa,hb=null){this.K_=null;new C.a;new B;this.TEl=()=>{const Gb=n.AFrameworkApplication.fa.Ea("AugLoopOAuthResourceUriV2");if(this.mRa)return new Promise(pc=>{this.mRa.execute(vd=>
{vd.vH("AugLoop",Gb).then(zd=>{zd.IsSuccess?pc(zd.Token):(e.ULS.sendTraceTag(51499467,306,15,zd.ErrorMessage),pc(n.AFrameworkApplication.fa.Ea("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")};this.sendOTelEvent=Gb=>{Q.a.sendOtelEvent(Object.assign(new R.a,{otelEvent:Gb}))};this.Ini=qa;this.mRa=hb}initialize(qa){this.K_?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):
(qa||(qa=new Y.a),this.K_=new Promise(hb=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const Gb=n.AFrameworkApplication.Ui("al",2);this.Ini.LFb(Gb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const pc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();pc.setRequestAuthTokenCallback(Object.assign(new ia,{requestAuthTokenCallback:this.TEl}));pc.setULSLogger(Object.assign(new sa,{ulsLogger:new N.a}));pc.setSendOTelEventCallback(Object.assign(new oa,
{sendOTelEvent:this.sendOTelEvent}));let vd=n.AFrameworkApplication.fa.Ea("OfficeApplicationName")||"";vd=vd.replace("Web","");qa.appName=qa.appName||vd;qa.serviceUrl=qa.serviceUrl||n.AFrameworkApplication.fa.Ea("AugLoopCloudALServiceUrl");qa.appVersion=qa.appVersion||n.AFrameworkApplication.fa.Ea("BuildVersion")||"";qa.releaseAudienceGroup=qa.releaseAudienceGroup||(n.AFrameworkApplication.ld?Object(F.a)(String,n.AFrameworkApplication.ld.AudienceGroup)||"":"");qa.sessionId=qa.sessionId||n.AFrameworkApplication.fa.Ea("SessionId")||
"";qa.uiLanguage=qa.uiLanguage||n.AFrameworkApplication.uiCulture;qa.flights=qa.flights||this.mtj();qa.initSession=qa.initSession||!0;qa.downloadBaseUrl=qa.downloadBaseUrl||n.AFrameworkApplication.fa.Ea("AugLoopDownloadBaseUrl");pc.initialize(qa);pc.setMessageBridge(Object.assign(new ca,{bridge:new K}));hb({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.K_}registerSimpleLocalWorkflow(qa,hb){return this.K_.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",qa);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new ba,{name:qa,lambda:this.JDd(hb)}))})}registerSimpleRemoteWorkflow(qa,hb,Gb,pc){return this.K_.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",qa);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new ha,{name:qa,lambdaBefore:this.JDd(hb),lambdaRemote:this.JDd(Gb),
lambdaAfter:this.JDd(pc)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.K_}submit(qa,hb){this.K_.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",qa);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new Ta,{inputSchema:qa,input:hb}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(qa){this.K_.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",qa);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ca.a,{operation:qa}))})}setSessionDataCallback(qa){this.K_.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(qa)})}setInitSessionCallback(qa){this.K_.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(qa)})}setSessionInitOverrideCallback(qa){this.K_.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(qa)})}setAnnotationResultCallback(qa){this.K_.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new ka.a,{handler:qa}))})}activateAnnotation(qa){return this.K_.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
qa.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(qa)})}releaseAnnotation(qa){return this.K_.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",qa.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(qa)})}addEventHandler(qa,hb){qa&&""!==qa?hb?this.K_.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new G,
{schemaName:qa,handler:Gb=>{Gb&&hb(Gb.inputSchema,Gb.input,Gb.outputSchema,Gb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}JDd(qa){if(qa){let hb=null;qa.func&&(hb=(Gb,pc,vd,zd)=>{qa.func(Gb,pc,zd)});return Object.assign(new W,{name:qa.name,inputSchema:qa.inputSchema,outputSchema:qa.outputSchema,func:hb})}return null}mtj(){var qa=
n.AFrameworkApplication.fa.Ea("FlightId");if(n.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ALFlightForwardingTreatmentVariablesFix")){var hb=n.AFrameworkApplication.fa.b$b,Gb=n.AFrameworkApplication.fa.hz("AugLoopFlightKeywordList");hb=Ha.yde(qa,hb,Array.isArray(Gb)?Gb:null);Gb="";hb&&0<hb.length&&(Gb=hb.join(";"));return Gb}hb=n.AFrameworkApplication.fa.hz("AugLoopFlightKeywordList");Gb=[];if(qa&&""!==qa&&hb&&0<hb.length){qa=qa.split(";");for(let pc=0;pc<
qa.length;pc++)for(let vd=0;vd<hb.length;vd++)-1<qa[pc].toLowerCase().indexOf(hb[vd].toLowerCase())&&Array.add(Gb,qa[pc])}return 0<Gb.length?Gb.join(";"):""}static yde(qa,hb,Gb){const pc=new D.a;if(Gb&&0<Gb.length){for(var vd=0;vd<Gb.length;vd++)Gb[vd]=Gb[vd].toLowerCase();if(qa&&""!==qa){qa=qa.toLowerCase().split(";");for(const zd of qa)U.a.any(Gb,xe=>-1<zd.indexOf(xe))&&pc.add(zd)}if(hb)for(const zd in hb){vd=(qa={key:zd,value:hb[zd]},qa.key)?qa.key:"";const xe=P.d(vd);U.a.any(Gb,le=>-1<xe.indexOf(le))&&
pc.add(String.format("{0}:{1}",vd,qa.value))}}return pc.toArray()}}Object(k.a)(Ha,"NewAugLoopRuntimeManager",null,[223]);var da=d(92),Ba=d(54),za=d(1296),Aa=d(46),na=d(7);class la{}Object(k.a)(la,"Lambda",null,[1387]);var va=d(942);class Pa{constructor(){this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null}}Object(k.a)(Pa,"PowerPointParameters",null,[]);class Qa{constructor(){this.initSessionCallback=null}}Object(k.a)(Qa,"SetInitSessionCallbackParameters",null,[]);class Ua{constructor(){this.sessionDataCallback=
this.handler=null}}Object(k.a)(Ua,"SetSessionDataCallbackParameters",null,[]);class Ya{constructor(){this.handler=null}}Object(k.a)(Ya,"SetSessionInitOverrideCallbackParameters",null,[]);var Ea=d(252),La=d(528),xb=d(134);class dc extends La.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new xb.a,{T_:dc.getTypeName(),B_:dc.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(k.a)(dc,
"DeleteOperation",La.a,[]);var gb=d(529),gc=d(294);class Ac extends gc.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new xb.a,{T_:Ac.getTypeName(),B_:Ac.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}Object(k.a)(Ac,"Message",gc.a,[]);class $b extends Ac{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=
this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new xb.a,{T_:$b.getTypeName(),B_:$b.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}Object(k.a)($b,"SessionInitMessage",Ac,[]);class jc extends $b{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new xb.a,
{T_:jc.getTypeName(),B_:jc.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(k.a)(jc,"PowerPointSessionInitMessage",$b,[]);var pb=d(30);class $a{constructor(){this.authToken=this.origin=this.sessionUrl=null}}Object(k.a)($a,"SessionData",null,[]);var zc=d(546),rb=d(1003);class ib{constructor(){this.XQc=new Map}Vfg(qa,hb){const Gb=
this.XQc.get(qa);if(Gb){var pc=Gb.get(hb);Gb.delete(hb);0===Gb.size&&this.XQc.delete(qa);return pc}}OOl(qa,hb,Gb){let pc=this.XQc.get(qa);pc||(pc=new Map,this.XQc.set(qa,pc));pc.set(hb,Gb)}}Object(k.a)(ib,"AugLoopSessionCallbackStorage",null,[]);var Vb=d(330);class Od{constructor(qa){Vb.a.assign(Od,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Od.getTypeName()])}}Od.H_={T_:Od.getTypeName(),
B_:Od.getBaseTypes()};class jb{constructor(qa){Vb.a.assign(jb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[jb.getTypeName()])}}jb.H_={T_:jb.getTypeName(),B_:jb.getBaseTypes()};class Wb{constructor(qa){Vb.a.assign(Wb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Wb.getTypeName()])}}Wb.H_={T_:Wb.getTypeName(),B_:Wb.getBaseTypes()};class qb{constructor(qa){Vb.a.assign(qb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[qb.getTypeName()])}}qb.H_={T_:qb.getTypeName(),B_:qb.getBaseTypes()};class Ga{constructor(qa){Vb.a.assign(Ga,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Ga.getTypeName()])}}Ga.H_={T_:Ga.getTypeName(),B_:Ga.getBaseTypes()};class cb{constructor(qa){Vb.a.assign(cb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[cb.getTypeName()])}}cb.H_={T_:cb.getTypeName(),B_:cb.getBaseTypes()};class Ob{constructor(qa){Vb.a.assign(Ob,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Ob.getTypeName()])}}Ob.H_={T_:Ob.getTypeName(),B_:Ob.getBaseTypes()};class Db{constructor(qa){Vb.a.assign(Db,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Db.getTypeName()])}}Db.H_={T_:Db.getTypeName(),B_:Db.getBaseTypes()};class mb{constructor(qa){Vb.a.assign(mb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[mb.getTypeName()])}}mb.H_={T_:mb.getTypeName(),B_:mb.getBaseTypes()};class Vc{constructor(qa){Vb.a.assign(Vc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Vc.getTypeName()])}}Vc.H_={T_:Vc.getTypeName(),B_:Vc.getBaseTypes()};class Zb{constructor(qa){Vb.a.assign(Zb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Zb.getTypeName()])}}Zb.H_={T_:Zb.getTypeName(),B_:Zb.getBaseTypes()};class fc{constructor(qa){Vb.a.assign(fc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[fc.getTypeName()])}}fc.H_={T_:fc.getTypeName(),B_:fc.getBaseTypes()};class ob{constructor(qa){Vb.a.assign(ob,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[ob.getTypeName()])}}ob.H_={T_:ob.getTypeName(),B_:ob.getBaseTypes()};class ub{constructor(qa){Vb.a.assign(ub,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[ub.getTypeName()])}}ub.H_={T_:ub.getTypeName(),B_:ub.getBaseTypes()};class bc{constructor(qa){Vb.a.assign(bc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[bc.getTypeName()])}}bc.H_={T_:bc.getTypeName(),B_:bc.getBaseTypes()};class ic{constructor(qa){Vb.a.assign(ic,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[ic.getTypeName()])}}ic.H_={T_:ic.getTypeName(),B_:ic.getBaseTypes()};class Rc{constructor(qa){Vb.a.assign(Rc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Rc.getTypeName()])}}Rc.H_={T_:Rc.getTypeName(),B_:Rc.getBaseTypes()};class Fb{constructor(qa){Vb.a.assign(Fb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Fb.getTypeName()])}}Fb.H_={T_:Fb.getTypeName(),B_:Fb.getBaseTypes()};class Qb{constructor(qa){Vb.a.assign(Qb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Qb.getTypeName()])}}Qb.H_={T_:Qb.getTypeName(),B_:Qb.getBaseTypes()};class hc{constructor(qa){Vb.a.assign(hc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[hc.getTypeName()])}}hc.H_={T_:hc.getTypeName(),B_:hc.getBaseTypes()};class Pc{constructor(qa){Vb.a.assign(Pc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Pc.getTypeName()])}}Pc.H_={T_:Pc.getTypeName(),B_:Pc.getBaseTypes()};class uc{constructor(qa){Vb.a.assign(uc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[uc.getTypeName()])}}uc.H_={T_:uc.getTypeName(),B_:uc.getBaseTypes()};class zb{constructor(qa){Vb.a.assign(zb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[zb.getTypeName()])}}zb.H_={T_:zb.getTypeName(),B_:zb.getBaseTypes()};class ac{constructor(qa){Vb.a.assign(ac,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[ac.getTypeName()])}}ac.H_={T_:ac.getTypeName(),B_:ac.getBaseTypes()};class Jb{constructor(qa){Vb.a.assign(Jb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage",
"AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Jb.getTypeName()])}}Jb.H_={T_:Jb.getTypeName(),B_:Jb.getBaseTypes()};class Yc{constructor(qa){Vb.a.assign(Yc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Yc.getTypeName()])}}Yc.H_={T_:Yc.getTypeName(),B_:Yc.getBaseTypes()};class dd{constructor(qa){Vb.a.assign(dd,
this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[dd.getTypeName()])}}dd.H_={T_:dd.getTypeName(),B_:dd.getBaseTypes()};class id{constructor(qa){Vb.a.assign(id,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[id.getTypeName()])}}id.H_={T_:id.getTypeName(),B_:id.getBaseTypes()};class Cc{constructor(qa){Vb.a.assign(Cc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Cc.getTypeName()])}}Cc.H_={T_:Cc.getTypeName(),B_:Cc.getBaseTypes()};class Nb{constructor(qa){Vb.a.assign(Nb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Nb.getTypeName()])}}Nb.H_={T_:Nb.getTypeName(),B_:Nb.getBaseTypes()};class nc{constructor(qa){Vb.a.assign(nc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[nc.getTypeName()])}}nc.H_={T_:nc.getTypeName(),B_:nc.getBaseTypes()};class Kc{constructor(qa){Vb.a.assign(Kc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Kc.getTypeName()])}}Kc.H_={T_:Kc.getTypeName(),B_:Kc.getBaseTypes()};class xd{constructor(qa){Vb.a.assign(xd,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[xd.getTypeName()])}}xd.H_={T_:xd.getTypeName(),B_:xd.getBaseTypes()};class Xc{constructor(qa){Vb.a.assign(Xc,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Xc.getTypeName()])}}Xc.H_={T_:Xc.getTypeName(),B_:Xc.getBaseTypes()};class Tb{constructor(qa){Vb.a.assign(Tb,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Tb.getTypeName()])}}Tb.H_={T_:Tb.getTypeName(),B_:Tb.getBaseTypes()};class he{constructor(qa){Vb.a.assign(he,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[he.getTypeName()])}}he.H_={T_:he.getTypeName(),B_:he.getBaseTypes()};class re{constructor(qa){Vb.a.assign(re,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class ee{constructor(qa){Vb.a.assign(ee,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class Yf{constructor(qa){Vb.a.assign(Yf,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Yf.getTypeName()])}}Yf.H_={T_:Yf.getTypeName(),B_:Yf.getBaseTypes()};class ke{constructor(qa){Vb.a.assign(ke,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[ke.getTypeName()])}}ke.H_={T_:ke.getTypeName(),B_:ke.getBaseTypes()};class ef{constructor(qa){Vb.a.assign(ef,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[ef.getTypeName()])}}ef.H_={T_:ef.getTypeName(),B_:ef.getBaseTypes()};class yf{constructor(qa){Vb.a.assign(yf,this,qa)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[yf.getTypeName()])}}yf.H_={T_:yf.getTypeName(),B_:yf.getBaseTypes()};var Rf=d(1304);class Za{constructor(qa,hb,Gb){var pc;this.Shc=new Map;this.Wfb=new Map;this.Thc=new Map;this.XFb=new Map;this.zKa=this.nya=this.$Gb=this.zP=null;this.W_d=new ib;this.sNc=new Map;this.tVg=!1;this.LMg=[];this.xr=qa;this.Ba=hb;this.Qi=Gb;const vd=new Y.a;vd.powerpoint=new Pa;qa=new Y.a;pb.a("AL.SendNewInitParams")&&(qa.serviceUrl=null!==(pc=Object(rb.a)(hb))&&void 0!==pc?pc:void 0);if(pb.a("AL.SendSlideTile"))if(pb.a("AL.EnableRehydration"))this.xr.initialize(qa),
this.xr.setInitSessionCallback(Object.assign(new Qa,{initSessionCallback:Object(na.a)(this,this.D9k,"onSessionInit")})),this.xr.setSessionInitOverrideCallback(Object.assign(new Ya,{handler:Object(na.a)(this,this.E9k,"onSessionInitOverride")})),this.zKa=this.S4c(),this.xr.setAnnotationResultCallback(Object(na.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.R1=Promise.resolve(null);else{hb=Ba.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;pc=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
hb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",pc,hb);pc=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ycb?Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").A0c:Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var zd=String.format("{0}getitems.ashx",pc);pc=new za.a(n.AFrameworkApplication.Me);this.R1=zc.b(pc.$6e(hb));this.R1.then(xe=>{try{const le=JSON.parse(xe),Dg=le.downloadUrl;Aa.a.Ta(Dg)?e.ULS.sendTraceTag(509112976,
306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",le):(vd.powerpoint.downloadUrl=Dg,vd.powerpoint.getItemsEndPoint=zd,this.Ba.O8b&&(vd.powerpoint.documentOpenType=this.emg()))}catch(le){e.ULS.sendTraceTag(509112975,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",le)}this.xr.initialize(vd);this.zKa=this.S4c();this.xr.setAnnotationResultCallback(Object(na.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(xe=>
{e.ULS.sendTraceTag(509112974,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",xe);this.xr.initialize(vd);this.zKa=this.S4c();this.xr.setAnnotationResultCallback(Object(na.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.R1=new Promise(xe=>{this.xr.initialize(vd);this.zKa=this.S4c();this.xr.setAnnotationResultCallback(Object(na.a)(this,this.onAnnotationResult,"onAnnotationResult"));xe("")})}S2k(qa){this.LMg.push(qa)}aM(qa){this.R1.then(hb=>{if(!this.sNc.has(qa))return this.xr.activateAnnotation(Object.assign(new va.a,
{annotationType:qa})),this.sNc.set(qa,hb),hb})}releaseAnnotation(qa){return Object(da.b)(this,void 0,void 0,function*(){yield this.R1;var hb=this.sNc.get(qa);return hb?((hb=yield this.xr.releaseAnnotation({token:hb}))&&this.sNc.delete(qa),hb):!1})}Z2(qa,hb){if(qa)if(hb){if(this.Shc.has(qa))var Gb=this.Shc.get(qa);else Gb=new D.a,this.Shc.set(qa,Gb);Gb&&!Gb.contains(hb)&&Gb.add(hb)}else e.ULS.sendTraceTag(509112972,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509112973,306,15,"Annotation Type is null or empty")}Dvl(qa,
hb){if(qa)if(hb){if(this.Thc.has(qa))var Gb=this.Thc.get(qa);else Gb=new D.a,this.Thc.set(qa,Gb);Gb&&!Gb.contains(hb)&&Gb.add(hb)}else e.ULS.sendTraceTag(509116945,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509116947,306,15,"Annotation Type is null or empty")}KBh(qa,hb){if(qa)if(hb){if(this.Wfb.has(qa))var Gb=this.Wfb.get(qa);else Gb=new D.a,this.Wfb.set(qa,Gb);Gb&&!Gb.contains(hb)&&Gb.add(hb)}else e.ULS.sendTraceTag(509112970,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509112971,
306,15,"Annotation Type is null or empty")}addEventHandler(qa,hb){this.R1.then(()=>{this.xr.addEventHandler(qa,hb);return null})}removeEventHandler(qa,hb){this.R1.then(()=>{this.xr.removeEventHandler(qa,hb);return null})}registerSimpleLocalWorkflow(qa,hb){return this.R1.then(()=>this.xr.registerSimpleLocalWorkflow(qa,this.KDd(hb)))}registerSimpleRemoteWorkflow(qa,hb,Gb,pc){return this.R1.then(()=>this.xr.registerSimpleRemoteWorkflow(qa,this.KDd(hb),this.KDd(Gb),this.KDd(pc)))}submit(qa,hb){this.Ba.G5||
this.R1.then(()=>{this.xr.submit(qa,hb);return null})}submitOperation(qa){this.R1.then(()=>{this.xr.submitOperation(qa);return null})}qmj(qa,hb){return this.zKa.then(()=>Object(da.b)(this,void 0,void 0,function*(){return yield fetch(this.nya.sessionUrl,{method:"POST",headers:{"Content-Type":"application/jsond","X-Origin":this.nya.origin,Authorization:`Bearer ${this.nya.authToken}`},body:Rf.a.serialize(qa),signal:hb.signal})}))}P6l(qa,hb=1E4){return Object(da.b)(this,void 0,void 0,function*(){const Gb=
new AbortController,pc=window.setTimeout(()=>{Gb.abort()},hb);try{if(!(yield this.qmj(qa,Gb)).ok)throw Error("Network response was not ok");}catch(vd){if(vd instanceof DOMException&&"AbortError"===vd.name)throw Error("Request timed out");throw vd;}finally{clearTimeout(pc)}})}submitBinarySignal(qa,hb,Gb,pc,vd=1E4){return Object(da.b)(this,void 0,void 0,function*(){this.zKa.then(()=>Object(da.b)(this,void 0,void 0,function*(){this.W_d.OOl(hb,pc,Gb);void 0!==this.ZGi&&clearInterval(this.ZGi);try{yield this.P6l(new uc({parentPath:["session",
"img"],item:{id:pc,body:qa}}),vd)}catch(zd){throw this.W_d.Vfg(hb,pc),zd;}}))})}hmj(qa){return this.zKa.then(()=>fetch(`${this.nya.sessionUrl}/blob/${qa}`,{headers:{"X-Origin":this.nya.origin,Authorization:`Bearer ${this.nya.authToken}`}}))}getBlob(qa,hb=1E4){return Object(da.b)(this,void 0,void 0,function*(){const Gb=new AbortController,pc=window.setTimeout(()=>{Gb.abort()},hb);yield this.R1;try{const vd=yield this.hmj(qa);if(!vd.ok)throw Error("Network response was not ok");return vd.blob()}catch(vd){if(vd instanceof
DOMException&&"AbortError"===vd.name)throw Error("Request timed out");throw vd;}finally{clearTimeout(pc)}})}ylm(qa,hb,Gb,pc,vd){this.zKa&&this.zKa.then(()=>{this.Qi.augmentImage(qa,hb,Gb,!0,this.nya.sessionUrl,this.nya.origin,this.nya.authToken,pc,vd);return null})}E9k(qa){e.ULS.sendTraceTag(509112969,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const hb=Object.assign(new jc,{protocolVersion:qa.protocolVersion,clientMetadata:qa.clientMetadata,sessionKey:qa.sessionKey,origin:qa.origin,
authToken:qa.authToken,messageId:qa.messageId,cv:qa.cv});try{this.Ba.O8b&&(hb.documentOpenType=this.emg())}catch(Gb){e.ULS.sendTraceTag(509112968,306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",Gb)}this.iQl(qa);if(Aa.a.Ta(this.zP)||Aa.a.Ta(this.$Gb))return e.ULS.sendTraceTag(509112967,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),qa;hb.downloadUrl=this.zP;hb.getItemsEndPoint=this.$Gb;this.$Gb=this.zP=null;
return hb}D9k(){e.ULS.sendTraceTag(509112966,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");this.tVg=!0;if(pb.a("AugLoopSessionCreationCallback"))for(var qa of this.LMg)qa();var hb=Ba.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const Gb=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;qa=Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ycb?Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").A0c:Ba.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
hb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Gb,hb);const pc=String.format("{0}getitems.ashx",qa);qa=new za.a(n.AFrameworkApplication.Me);return zc.b(qa.$6e(hb)).then(vd=>{try{const zd=JSON.parse(vd),xe=zd.downloadUrl;Aa.a.Ta(xe)?e.ULS.sendTraceTag(509112965,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",zd):(this.zP=xe,this.$Gb=pc)}catch(zd){e.ULS.sendTraceTag(509112964,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",
zd)}return null}).catch(vd=>{e.ULS.sendTraceTag(509112963,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",vd)})}S4c(){return new Promise(qa=>{this.xr.setSessionDataCallback(Object.assign(new Ua,{sessionDataCallback:(hb,Gb,pc)=>{this.nya=Object.assign(new $a,{sessionUrl:hb,origin:Gb,authToken:pc});qa(null)}}))})}UTj(qa,hb,Gb){qa=this.W_d.Vfg(qa,hb);void 0!==qa&&qa(Gb)}onAnnotationResult(qa){if(qa&&qa.items)if(this.Ba.G5&&this.mMl(qa),gc.a.getTypeNameFor(qa)!==Ea.a.getTypeName()&&
gc.a.getTypeNameFor(qa)!==gb.a.getTypeName())this.Ba.r8f&&gc.a.getTypeNameFor(qa)===dc.getTypeName()&&this.m4k(qa);else for(const Gb of qa.items){if(!Gb||!Gb.body)continue;const pc=gc.a.getTypeNameFor(Gb.body);if(!pc)continue;var hb=Gb.body||{};qa.parentPath&&(hb.parentPath=qa.parentPath);let vd;if(this.Shc.has(pc)){if(vd=this.Shc.get(pc))for(const zd of vd)zd(hb)}else e.ULS.sendTraceTag(509112962,306,50,"Cannot find handlers for annotation:{0};",pc);pc&&qa.parentPath&&this.UTj(pc,qa.parentPath[2],
Gb.body);if(this.Ba.r8f){if(this.Wfb.has(pc)&&(hb=this.Wfb.get(pc)))for(const zd of hb)zd(Gb,!1);Aa.a.Ta(Gb.id)||this.XFb.set(Gb.id,pc)}}}mMl(qa){const hb=new Map,Gb=gc.a.getTypeNameFor(qa)!==Ea.a.getTypeName()&&gc.a.getTypeNameFor(qa)!==gb.a.getTypeName();for(var pc of qa.items){qa=Gb&&this.XFb.has(pc.id)?this.XFb.get(pc.id):gc.a.getTypeNameFor(pc.body);let vd;hb.has(qa)?vd=hb.get(qa):(vd=new D.a,hb.set(qa,vd));vd.add(pc)}for(const vd of hb.keys())if(this.Thc.has(vd)){if(pc=this.Thc.get(vd))for(const zd of pc)zd(hb.get(vd).toArray(),
Gb)}else e.ULS.sendTraceTag(509116952,306,50,"Cannot find handlers for annotation:{0};",vd)}m4k(qa){for(const hb of qa.items)if(hb&&hb.id&&this.XFb.has(hb.id)){qa=this.XFb.get(hb.id);if(this.Wfb.has(qa)&&(qa=this.Wfb.get(qa)))for(const Gb of qa)Gb(hb,!0);this.XFb.delete(hb.id)}}KDd(qa){return qa?Object.assign(new la,{name:qa.name,inputSchema:qa.inputSchema,outputSchema:qa.outputSchema,func:qa.func}):null}emg(){try{return this.Ba.isCreateNew?0:this.Ba.wYa?2:1}catch(qa){return e.ULS.sendTraceTag(509112961,
306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",qa),2}}iQl(qa){try{Aa.a.Ta(qa.clientMetadata.flights)?qa.clientMetadata.flights=";":qa.clientMetadata.flights+=";",this.Ba.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?qa.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":qa.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;",
this.Ba.getBooleanAppSetting("ChatPPTCIQDocMenuEnabled")&&(qa.clientMetadata.flights+="PPTOChatPPTCIQDocMenuEnabled;ciq.user-init.enabled:true;",qa.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Ba.getBooleanAppSetting("StorytellerCiqEnabled")&&(qa.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Ba.gfb&&(qa.clientMetadata.flights+="StorytellerBypassLicenseCheckEnabled;"),this.Ba.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotRewrite",
!1)&&pb.a("RewriteBypassLicenseCheckEnabled")&&(qa.clientMetadata.flights+="RewriteBypassLicenseCheckEnabled;")}catch(hb){e.ULS.sendTraceTag(509112960,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",hb)}}}Object(k.a)(Za,"PPTAugLoopRuntimeManager",null,[1364]);class Kb{constructor(qa){this.tV=qa;this.tV.initialize()}addEventHandler(qa,hb){this.tV.addEventHandler(qa,hb)}removeEventHandler(qa,hb){this.tV.removeEventHandler(qa,hb)}Q6e(qa,hb,Gb){this.tV.Q6e(qa,hb,Gb)}dwc(qa,hb,Gb,pc,vd,zd=
null){this.tV.dwc(qa,hb,Gb,pc,vd,zd)}}Object(k.a)(Kb,"PPTAugmentationManager",null,[1363]);var Ic=d(318),Hc=d(103);class jd{constructor(qa){Vb.a.assign(jd,this,qa)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[jd.getTypeName()])}}jd.H_={T_:jd.getTypeName(),B_:jd.getBaseTypes()};class Id{constructor(qa){Vb.a.assign(Id,this,qa)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Id.getTypeName()])}}Id.H_={T_:Id.getTypeName(),B_:Id.getBaseTypes()};class ze{constructor(qa){Vb.a.assign(ze,this,qa)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[ze.getTypeName()])}}ze.H_={T_:ze.getTypeName(),B_:ze.getBaseTypes()};class Ie{constructor(qa){Vb.a.assign(Ie,this,qa)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,
[Ie.getTypeName()])}}Ie.H_={T_:Ie.getTypeName(),B_:Ie.getBaseTypes()};class Cd{constructor(qa){Vb.a.assign(Cd,this,qa)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(qa){return Vb.a.matchesTypesFor(qa,[Cd.getTypeName()])}}Cd.H_={T_:Cd.getTypeName(),B_:Cd.getBaseTypes()};var ue=d(27);class Ee{constructor(qa){this.HI=qa;qa.body&&(qa=qa.body,this.ID=qa.id,this.Status=qa.status,this.Text=qa.text,this.KGd=this.HLj())}HLj(){return this.HI.parentPath&&
0<this.HI.parentPath.length?this.HI.parentPath[this.HI.parentPath.length-1]:""}}Object(k.a)(Ee,"ALChatHelperResponse",null,[1392]);class Xe{constructor(qa,hb){this.CNk=0;this.P$g=new Map;this.xr=hb;const Gb=["session","chats"],pc=(new Ic.a(Hc.a.create(),1)).toString(),vd=[...Gb,pc];this.hNk=[...vd,"messages"];this.xr.execute(zd=>{zd.submitOperation(Xe.q6d(Gb,pc,qa.txb));zd.submitOperation(Xe.q6d(vd,"messages",new ze));zd.aM(qa.responseType);zd.KBh(qa.responseType,this.FM.bind(this))})}FM(qa){qa=new Ee(qa);
if(qa.KGd){const hb=this.P$g.get(qa.KGd);if(hb){hb(qa);this.P$g.delete(qa.KGd);return}}this.BHk?this.BHk(qa):ue.a.J(509366417,822,15,"No handler found")}send(qa){const hb=`${this.CNk++}`;this.xr.execute(Gb=>{Gb.submitOperation(Xe.q6d(this.hNk,hb,qa))})}static q6d(qa,hb,Gb){return Object.assign(new Ea.a,{parentPath:qa,items:[{id:hb,body:Gb}]})}}Object(k.a)(Xe,"ALChatHelper",null,[1380]);class Sd{constructor(qa){this.Mad=qa}create(qa){return new Xe(qa,this.Mad)}}Object(k.a)(Sd,"ALChatHelperFactory",
null,[1366]);var ad=d(75);class af{constructor(){this.yef="TML";this.h2e="RTA";this.Zaf="SR";this.ua=new ad.a}fBi(qa){this.ua.addHandler(this.yef,qa)}QCl(qa){this.ua.removeHandler(this.yef,qa)}Lrl(qa){this.ua.raiseEvent(this.yef,qa)}qzi(qa){this.ua.addHandler(this.h2e,qa)}GBl(qa){this.ua.removeHandler(this.h2e,qa)}Bzh(qa){this.ua.raiseEvent(this.h2e,qa)}Kzi(qa){this.ua.addHandler(this.Zaf,qa)}TBl(qa){this.ua.removeHandler(this.Zaf,qa)}Vzh(qa){this.ua.raiseEvent(this.Zaf,qa)}}Object(k.a)(af,"TilingEventSource",
null,[1294,1295,1296]);class pf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}fc(qa){this.K=qa;this.K.register(Kb,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().na(()=>new Kb(new E(n.AFrameworkApplication.Me,qa.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.K.register(Za,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().na(()=>
{const hb=r.a.Itk();e.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",hb);n.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=hb.toString();return new Za(new Ha(qa.resolve("Common.ISharedDependencyLoader"),qa.Ha("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))});Object(pb.a)("EnableALChatHelper")&&this.K.register(Sd,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").ma().na(()=>
new Sd(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")));this.K.register(af,"PowerPointWebEditor.AugmentationLoop.TilingEventSource").as("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").as("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers").as("PowerPointWebEditor.AugmentationLoop.ITilingEventSource").ma().na(()=>new af)}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&
(this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Object(pb.a)("EnableALChatHelper")&&this.K.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){w.a.instance.Ac(new pf)}}Object(k.a)(pf,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var xf=d(1265),gf=d(943),me=d(941),ag=d(560),de=d(63),wa=d(33);class ta{constructor(qa){if(!qa)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");
this.B2=qa}mcc(qa){this.rff(qa)}rff(qa){if(qa){try{const vd=qa.parentPath;if(!vd||4>vd.length){ue.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const zd=vd[3];var hb=vd[2];if(!zd){ue.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var Gb=this.B2.pDj(zd);this.B2.tzl(zd);const xe=qa.predictions;if(!xe||!xe.length){ue.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const le=xe[0];if(!le)return;var pc=le.text;if(!pc||!pc.length){ue.a.J(590181641,
820,50,"Text Predictions Null or Empty.");return}}catch(vd){ue.a.J(590710030,820,10,"Unable to parse output because of modified output type from Augloop");return}pc&&ta.Mcj(pc,Gb,hb)}else ue.a.J(590181649,820,50,"Annotations returned from service is null.")}static Mcj(qa,hb,Gb){qa&&qa.length&&(hb=ta.FIj(qa,hb),-1!==hb&&(hb=qa.substring(hb,qa.length),Gb=Object.assign(new me.a,{text:qa,w$:hb,Ly:Gb}),ag.a.YE.z7=Gb,ag.a.x0d(qa,hb)))}static FIj(qa,hb){var Gb=de.a.instance.Oa.kb.vf.node;if(!Gb||!hb)return-1;
Gb=wa.ParagraphReader.text(Gb);if(!Gb)return-1;if(Gb!==hb)if(Gb.length>hb.length&&Gb.substring(0,hb.length)===hb){if(!qa.startsWith(Gb.substring(hb.length,Gb.length-hb.length)))return-1;ue.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===Gb.substring(Gb.length-1,1)?0:ta.Qkg(Gb)}static Qkg(qa){return qa?qa.length-1-qa.lastIndexOf(" "):-1}}Object(k.a)(ta,"TextPredictionAugLoopResponseManager",null,[]);var Eb=d(267);class qc extends La.a{constructor(){super();
this.H_=Object.assign(new xb.a,{T_:qc.getTypeName(),B_:qc.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(k.a)(qc,"SignalOperation",La.a,[]);var Sc=d(743);class td{constructor(){this.WYe=!1}}Object(k.a)(td,"PredictionSettings",null,[]);class je{constructor(qa,hb){this.Hjd=null;this.fIe={};this.xr=qa;this.Db=hb;this.Db.pOc(Object(na.a)(this,this.ntg,"handleResize"))}pDj(qa){return this.fIe[qa]}ZQl(qa,hb){this.fIe[qa]=
hb}tzl(qa){qa&&delete this.fIe[qa]}get settings(){this.Hjd||(this.Hjd=Object.assign(new td,{WYe:!1}));return this.Hjd}set settings(qa){this.Hjd=qa}ydm(qa){if(this.settings.WYe&&qa){var hb=qa.id.toString(),Gb=ag.a.YE.z7,pc=de.a.instance.Oa.kb;if(pc&&1===pc.length&&pc.vf){pc=pc.vf;var vd=pc.node;if(wa.ParagraphReader.textLength(vd)===pc.Ra){if(Gb&&vd&&hb===Gb.Ly&&hb===vd.id.toString()&&(pc=this.Vhe(Gb,vd))){Gb.w$=pc;ag.a.x0d(Gb.text,pc);return}ag.a.YE.z7=null;Gb=Hc.a.create().toString();pc=wa.ParagraphReader.text(qa);
this.ZQl(Gb,pc);qa=["Signal",Sc.a.getTypeName(),hb,Gb];Gb=je.pGj(pc);hb=[Object.assign(new Eb.a,{id:hb,body:Gb})];var zd=Object.assign(new qc,{parentPath:qa,items:hb});this.xr.execute(xe=>{xe.submitOperation(zd);ue.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}pPb(){ag.a.YE.z7=null;ag.a.$Wa()}c_j(qa){!qa||1<qa.length?this.pPb():1>qa.length||((qa=qa[0])&&qa.context?(qa=qa.context,qa.Ra===qa.Pb&&wa.ParagraphReader.textLength(qa.node)===qa.Ra||this.pPb()):this.pPb())}Vhe(qa,
hb){var Gb=null;if(qa&&hb){hb=wa.ParagraphReader.text(hb);qa=qa.text;if(!hb||!qa)return Gb;hb=hb.replace(RegExp("\\u00a0","g")," ");qa=qa.replace(RegExp("\\u00a0","g")," ");if(hb){if(hb.endsWith(qa))return this.pPb(),Gb;Gb=je.xHj(hb,qa);Gb=qa.substring(Gb,qa.length)}}return Gb}ntg(){ag.a.$Wa()}dispose(){this.Db.qvd(Object(na.a)(this,this.ntg,"handleResize"))}static pGj(qa){return Object.assign(new Sc.a,{languageId:"en-US",startOfSentence:!0,text:qa})}static xHj(qa,hb){for(let Gb=hb.length;0<Gb;Gb--){const pc=
hb.substring(0,Gb);if(qa.endsWith(pc.trimStart()))return pc.length}return 0}}je.$Xa=!1;Object(k.a)(je,"TextPredictionHandler",null,[1269]);var Te=d(51),Hd=d(29);class mg{constructor(qa,hb){this.ia=qa;this.Wb=hb}qb(){this.ia.xa(Hd.a.Djl,Te.a.application,Object(na.a)(this,this.Gjl,"predictionHandler"))}Gjl(qa,hb,Gb){return n.AFrameworkApplication.fa.getBooleanAppSetting("PPTOTextPredictionIsEnabled")?1===Gb?this.Wb.Hi()?32:2:8:8}}Object(k.a)(mg,"TextPredictorActor",null,[]);class fg{constructor(){this.uPe=
this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}fc(qa){this.K=qa;qa.register(mg,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().na(()=>new mg(qa.resolve("Common.IActionManagerExtended"),qa.resolve("PowerPointWebEditor.IPresentationReader")));qa.register(1269,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().na(()=>new je(qa.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),qa.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").qb();
this.uPe=new xf.a(()=>new ta(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(qa=>{qa.aM(gf.a.getTypeName());qa.Z2(gf.a.getTypeName(),Object(na.a)(this.uPe.value,this.uPe.value.mcc,"handleResponse"))})}dispose(){}static main(){w.a.instance.Ac(new fg)}}Object(k.a)(fg,"TextPredictionPackage",null,[2,3]);var $e=d(276),oj=d(28);class Me{}Object(k.a)(Me,"AugContextId",null,[]);class we{}Object(k.a)(we,
"AugParagraph",null,[]);class Zc{}Object(k.a)(Zc,"AugShape",null,[]);class te{}Object(k.a)(te,"ShapeTextTile",null,[]);class ne{constructor(qa,hb,Gb,pc){this.Ga=Gb;this.Uh=pc;this.Ub=qa;this.zm=hb}$6b(qa,hb){return qa&&qa.isConnected&&this.Ga.dIa(qa)?(qa=Object(F.a)(4,qa))?Object.assign(new te,{Topic:"ShapeText",ContextId:m.c(ne.DZi(qa,hb)),Data:m.c(this.EZi(qa))}):null:null}C6b(qa){return qa&&qa.get_shapeId()&&qa.hasText&&!qa.Mq?qa.Hue:!1}EZi(qa){const hb=[];qa=this.Ub.Pc(qa);for(qa=this.zm.R4(qa,
qa.currentNode);qa.moveNext();){var Gb=qa.currentNode;const pc=Gb;this.Uh.ke(pc)&&(Gb=Object.assign(new we,{t:this.Uh.text(pc),l:this.Uh.flb(Gb)}),Array.add(hb,Gb))}return Object.assign(new Zc,{p:hb,c:$e.a.Oe(n.AFrameworkApplication.lcid).pAb})}static DZi(qa,hb){return Object.assign(new Me,{gid:qa.id,sid:qa.slideSid,cid:qa.slideCid,shapeId:qa.get_shapeId(),rid:(qa.Z9c||qa.lIa||oj.App.Xn).toString(),t:hb,c:(new Date).getTime()})}}Object(k.a)(ne,"ShapeTextTileManager",null,[1252,1365]);var Zf=d(104),
cd=d(1285),aj=d(80),Qc;(function(qa){qa[qa.none=0]="none";qa[qa.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";qa[qa.onSelectionFinished=2]="onSelectionFinished";qa[qa.onActiveSlideDomReady=4]="onActiveSlideDomReady";qa[qa.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";qa[qa.onParagraphDisconnect=16]="onParagraphDisconnect";qa[qa.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";qa[qa.onNumberListDisconnect=64]="onNumberListDisconnect";qa[qa.onSlideConnected=
128]="onSlideConnected";qa[qa.onSlideDisconnected=256]="onSlideDisconnected";qa[qa.onRefreshTileAnnotations=512]="onRefreshTileAnnotations";qa[qa.onSlideReorder=1024]="onSlideReorder"})(Qc||(Qc={}));Object(k.b)("EventNames",Qc);class Mc{constructor(){this.GOa=this.graphNode=null;this.yYa=0;this.xef=null}}Object(k.a)(Mc,"TileGraphNode",null,[]);class Ig{constructor(){this.xJh=this.j6e=this.rme=this.Crg=0}}Object(k.a)(Ig,"TileTelemetry",null,[]);var wg;(function(qa){qa[qa.unknown=0]="unknown";qa[qa.activeSlideChanged=
1]="activeSlideChanged";qa[qa.shapeSelected=2]="shapeSelected";qa[qa.listLevelChanged=3]="listLevelChanged";qa[qa.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";qa[qa.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";qa[qa.paragraphDeleted=6]="paragraphDeleted";qa[qa.numberListDeleted=7]="numberListDeleted";qa[qa.numberListPropertyChanged=8]="numberListPropertyChanged";qa[qa.slideAdded=9]="slideAdded";qa[qa.slideDeleted=10]="slideDeleted";qa[qa.refreshTileAnnotations=11]="refreshTileAnnotations";
qa[qa.slideReorder=12]="slideReorder"})(wg||(wg={}));Object(k.b)("TriggerName",wg);var fe=d(440);class Qe{constructor(qa,hb,Gb,pc){this.Jqh=(vd,zd)=>{vd=new fe.a(!1,null,zd.Aa);this.cfa(vd,4)};this.zb=hb;this.RIk=Gb;this.LTk=qa;this.wPe={};this.ijc={};this.Db=pc}initialize(){this.ps()}dispose(){this.Jca()}onParagraphPropertyChanged(qa,hb){this.cfa(hb,1)}sMb(qa,hb){this.cfa(hb,2)}onActiveSlideDomReady(qa,hb){this.cfa(hb,4)}onShapeChildTopologyChanged(qa,hb){this.cfa(hb,8)}CLa(qa,hb){this.cfa(hb,16)}get Xv(){return this.LTk}get EU(){return this.wPe}get Ola(){return this.ijc}cfa(qa,
hb){try{if(2===this.Db.mode&&Object(cd.a)(Qc,hb)in this.wPe){var Gb=Date.now();Object(F.a)(1330,this.wPe[Object(cd.a)(Qc,hb)]).$X(qa,(pc,vd)=>{this.q4k(pc,vd,Gb)})}}catch(pc){ue.a.J(508879877,306,10,"Exception thrown at DetectTiles: "+pc)}}q4k(qa,hb,Gb){if(!U.a.Ta(qa))try{for(const pc of qa){if(!Zf.a.count(this.ijc)){const xe=new aj.a(3,1,this.RIk,Object(na.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.zb.Jb(xe)}let vd;if(pc.id.toString()in this.ijc)vd=Object(F.a)(Mc,this.ijc[pc.id.toString()]),
vd.yYa=hb;else{const xe=new Ig;vd=Object.assign(new Mc,{graphNode:pc,yYa:hb,GOa:{},xef:xe});this.ijc[pc.id.toString()]=vd;this.n2k(xe,Gb)}const zd=wg[hb];vd.GOa[zd]=(zd in vd.GOa?vd.GOa[zd]:0)+1}}catch(pc){ue.a.J(508879876,306,10,"Exception thrown at FireTiles: "+pc)}}n2k(qa,hb){qa&&(qa.Crg=hb,qa.rme=Date.now())}Tkh(qa,hb){qa&&(qa.j6e=hb,qa.xJh=Date.now())}pfg(qa){return qa?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",qa.rme-qa.Crg,qa.j6e-qa.rme,qa.xJh-
qa.j6e):""}}Object(k.a)(Qe,"TileTriggerControllerBase",null,[1378,106]);class ig extends Qe{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg,ch,$h,wj,kf){super(xe&31,le,ch,wj);this.KV=qa.Cd(12);this.vN=qa.Cd(10);this.oa=hb;this.xd=Gb;this.tV=pc;this.VP=vd;this.RV=zd;this.sa=Dg;this.aQ=$h;this.oUk=kf}ps(){1===(this.Xv&1)&&(this.KV.Ak(Object(na.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.EU[Object(cd.a)(Qc,1)]=this.aQ.I6i());2===(this.Xv&2)&&(this.oa.AG(Object(na.a)(this,this.sMb,
"onProcessSetSelectionFinished")),this.EU[Object(cd.a)(Qc,2)]=this.aQ.J6i());4===(this.Xv&4)&&(this.xd.kU(Object(na.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.EU[Object(cd.a)(Qc,4)]=this.aQ.G6i());8===(this.Xv&8)&&(this.vN.VE(Object(na.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.EU[Object(cd.a)(Qc,8)]=this.aQ.K6i());16===(this.Xv&16)&&(this.KV.aEa(Object(na.a)(this,this.CLa,"onBeforeParagraphDisconnect")),this.EU[Object(cd.a)(Qc,16)]=this.aQ.H6i())}Jca(){this.KV.tn(Object(na.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.oa.Xza(Object(na.a)(this,this.sMb,"onProcessSetSelectionFinished"));this.xd.wqa(Object(na.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.vN.RN(Object(na.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.KV.UMa(Object(na.a)(this,this.CLa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.sa&&this.sa.Aa){var qa=this.sa.Aa.yj();for(const hb of qa){const Gb=hb.id.toString();Gb in
this.Ola&&(this.R9b(Object(F.a)(Mc,this.Ola[Gb])),delete this.Ola[Gb])}Zf.a.forEach(this.Ola,hb=>{delete this.Ola[hb]},null)}}catch(hb){ue.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+hb)}}R9b(qa){if(qa){var hb=Date.now(),Gb=this.RV.$6b(qa.graphNode,wg[qa.yYa]);if(Gb){this.oUk?this.VP.execute(vd=>{vd.submit("ShapeTextTile",Gb)}):this.tV.execute(vd=>{vd.Q6e(Gb.Topic,Gb.Data,Gb.ContextId)});const pc=qa.xef;this.Tkh(pc,hb);ue.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",
wg[qa.yYa],qa.GOa,this.pfg(pc))}}}}Object(k.a)(ig,"ShapeTextTileTriggerController",Qe,[]);var Ph=d(19),$g=d(76),Vg=d(40),Fg=d(91),bf=d(82),Ag=d(158),ff=d(38);class Fe{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(k.a)(Fe,"TextSpan",null,[]);class Pf{}Object(k.a)(Pf,"AugCharFormat",null,[]);class Md{}Object(k.a)(Md,"AugCharFormatRun",null,[]);class vg{}Object(k.a)(vg,"AugDrawingElement",null,[]);class Ye{}Object(k.a)(Ye,"AugDrawingElementMoniker",null,[]);class Cf{}Object(k.a)(Cf,
"AugPara",null,[]);class Bg{}Object(k.a)(Bg,"AugParaFormat",null,[]);class Ae{}Object(k.a)(Ae,"AugParaFormatRun",null,[]);class Uf{}Object(k.a)(Uf,"AugSlide",null,[]);class Jd{}Object(k.a)(Jd,"AugSlideMoniker",null,[]);class We{}Object(k.a)(We,"AugText",null,[]);class fd{}Object(k.a)(fd,"AugTextTile",null,[]);class ui{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg,ch,$h,wj){this.Uh=qa;this.Qm=hb;this.bNe=Gb;this.Ub=pc;this.xZ=vd;this.Cc=zd;this.zm=xe;this.E_a=$h;this.sgd=le;this.cnc=Dg;this.lB=ch;this.Phd=
wj}$6b(qa){if(!qa||!qa.isConnected)return null;var hb=Object(F.a)(205,qa);if(!hb)return null;let Gb=qa=0;hb=({Nqd:qa,uVc:Gb}=this.d7i(hb)).returnValue;if(!hb)return null;hb=Object.assign(new fd,{Id:Hc.a.create().toString(),Content:m.c(hb)});ue.a.J(508945997,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",hb.Id,qa,Gb);return hb}d7i(qa){let hb=0,Gb=0;const pc=[];var vd=qa?qa.yj():[];for(var zd of vd)if(!this.Qm.NHa(zd)||this.E_a)if(zd.vd){if(vd=this.Cc.XO(zd))vd=this.Ub.Pc(vd),this.xZ.QYc(vd,
xe=>{(xe=Object(F.a)(650,xe.currentNode))&&!xe.isGhostCell&&({Nqd:hb,uVc:Gb}=this.hfg(xe,hb,Gb,pc));return!0})}else({Nqd:hb,uVc:Gb}=this.hfg(zd,hb,Gb,pc));zd=hb;vd=Gb;return{returnValue:Object.assign(new Uf,{id:qa.id.toString(),mk:Object.assign(new Jd,{sId:qa.sid,cId:qa.cid}),drawingElems:pc,isSlideCritiqueReady:qa.isSlideCritiqueReady,sourceTimestamp:Date.now()}),Nqd:zd,uVc:vd}}hfg(qa,hb,Gb,pc){const vd=[];let zd=0;var xe=this.Ub.Pc(qa);for(xe=this.zm.R4(xe,xe.currentNode);xe.moveNext();){var le=
xe.currentNode;le&&this.Uh.ke(le)&&le.Qa(Vg.a.np)&&(le=this.isj(le))&&(le.pfRuns&&0<le.pfRuns.length&&le.pfRuns[0].pf.proofingDirty&&zd++,Array.add(vd,le))}0<vd.length&&(hb+=vd.length,Gb+=zd,qa=Object.assign(new vg,{id:qa.id.toString(),mk:this.gsj(qa),text:Object.assign(new We,{paragraphs:vd})}),Array.add(pc,qa));return{Nqd:hb,uVc:Gb}}gsj(qa){if(!qa)return null;var hb="";let Gb=0,pc=0;if(Object(Ph.a)(650,qa))hb=Object(F.a)(650,qa),pc=3,hb=hb.cellId.toString();else if(Object(Ph.a)(4,qa))if(qa=Object(F.a)(4,
qa),hb=qa.get_shapeId().toString(),Gb=qa.get_cid(),qa.z1)pc=1;else if(qa.ig)pc=2;else if(qa.Xu||qa.Sk)pc=4;return Object.assign(new Ye,{id:hb,cId:Gb,type:pc})}isj(qa){if(!qa)return null;qa=Object(F.a)($g.AParagraphNode,qa);if(!qa)return null;var hb=qa.ra(ff.a.jV,!1);hb=Object.assign(new Cf,{id:qa.id.toString(),chars:hb?"":this.Uh.text(qa)});const Gb=this.hsj(qa);Gb&&0<Gb.length&&(hb.pfRuns=Gb);(qa=this.fsj(qa))&&0<qa.length&&(hb.cfRuns=qa);return hb}hsj(qa){const hb=[],Gb=Object(F.a)(bf.a,this.cnc.L0c(qa));
let pc=16,vd="",zd=0,xe=0;if(Gb&&this.Phd){const le=this.lB.WVa(Gb);if(le)if(pc=le.listType,1===pc)vd=this.sgd.IFb(Gb);else if(0===pc){zd=Gb.ra(ff.a.autonumberBulletType,8);const Dg=Object(F.a)(669,this.sgd);Dg&&(xe=Dg.uEj(le,Gb))}}qa=Object.assign(new Ae,{pf:Object.assign(new Bg,{lvl:this.Uh.flb(qa),proofingDirty:!qa.ra(Ag.a.R5,!1),revisionId:qa.ra(Ag.a.d$c,0).toString(),listType:pc,listTag:vd,listNumeration:zd,listElementIndex:xe})});Array.add(hb,qa);return hb}fsj(qa){const hb=[];let Gb=this.YDj(qa);
if(0<Gb.count){Gb=this.gJi(this.bNe.F_c(qa),Gb);for(const pc of Gb)qa=pc.end-pc.start,Array.add(hb,Object.assign(new Md,{len:qa,cf:Object.assign(new Pf,{lang:pc.lcid,noProof:pc.noProof})}))}return hb}YDj(qa){const hb=new D.a,Gb=qa.characterData;let pc=-1,vd=-1,zd=0;for(let xe=0;xe<qa.Sa.length;xe++){const le=qa.Sa.ga(xe).formatting;le&&(vd=Fg.a.language(le),-1!==pc&&pc!==vd&&(hb.add(Object.assign(new Fe,{start:zd,end:qa.Sa.ga(xe).cp,lcid:pc,noProof:!1})),zd=qa.Sa.ga(xe).cp),pc=vd)}hb.add(Object.assign(new Fe,
{start:zd,end:Gb.length,lcid:vd,noProof:!1}));return hb}gJi(qa,hb){if(!qa)return hb;for(const Gb of qa){qa=!1;for(let pc=0;pc<hb.count;pc++){if(!qa)if(hb.ga(pc).start===Gb.begin)qa=!0,hb.ga(pc).noProof=!0;else if(Gb.begin>hb.ga(pc).start&&Gb.begin<hb.ga(pc).end){hb.insert(pc+1,Object.assign(new Fe,{start:Gb.begin,end:hb.ga(pc).end,lcid:hb.ga(pc).lcid,noProof:!0}));qa=!0;hb.ga(pc).end=Gb.begin;continue}if(qa)if(Gb.end>hb.ga(pc).end)hb.ga(pc).noProof=!0;else{if(Gb.end===hb.ga(pc).end){hb.ga(pc).noProof=
!0;break}if(Gb.end<hb.ga(pc).end){hb.insert(pc+1,Object.assign(new Fe,{start:Gb.end,end:hb.ga(pc).end,lcid:hb.ga(pc).lcid,noProof:!1}));hb.ga(pc).end=Gb.end;hb.ga(pc).noProof=!0;break}}}}return hb}}Object(k.a)(ui,"SlideTextTileManager",null,[1253,1365]);var bj=d(447);class nf extends Qe{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg,ch,$h,wj){super(hb&125,Gb,pc,$h);this.xd=qa;this.aQ=vd;this.oSk=zd;this.KV=xe.Cd(12);this.vN=xe.Cd(10);this.VP=le;this.sa=Dg;this.yjb=ch;this.Ygd=xe.Cd(22);this.Ba=wj}ps(){this.Ba.G5||
4!==(this.Xv&4)||(this.xd.kU(Object(na.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.yjb.fBi(this.Jqh),this.EU[Object(cd.a)(Qc,4)]=this.aQ.Y6i());16===(this.Xv&16)&&(this.KV.aEa(Object(na.a)(this,this.CLa,"onBeforeParagraphDisconnect")),this.EU[Object(cd.a)(Qc,16)]=this.aQ.a7i());1===(this.Xv&1)&&(this.KV.Ak(Object(na.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.EU[Object(cd.a)(Qc,1)]=this.aQ.b7i());8===(this.Xv&8)&&(this.vN.VE(Object(na.a)(this,
this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.EU[Object(cd.a)(Qc,8)]=this.aQ.c7i());64===(this.Xv&64)&&(this.Ygd.aEa(Object(na.a)(this,this.qlh,"onBeforeNumberListDicsonnect")),this.EU[Object(cd.a)(Qc,64)]=this.aQ.Z6i());32===(this.Xv&32)&&(this.Ygd.Ak(Object(na.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),this.EU[Object(cd.a)(Qc,32)]=this.aQ.$6i())}Jca(){this.Ba.G5||this.xd.wqa(Object(na.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));
this.KV.tn(Object(na.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.KV.UMa(Object(na.a)(this,this.CLa,"onBeforeParagraphDisconnect"));this.yjb.QCl(this.Jqh);this.Ygd.UMa(Object(na.a)(this,this.qlh,"onBeforeNumberListDicsonnect"));this.Ygd.tn(Object(na.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}qlh(qa,hb){this.cfa(hb,64)}onNumberListPropertyChanged(qa,hb){this.cfa(hb,32)}fireTileEvents(){try{Zf.a.forEach(this.Ola,qa=>{this.R9b(Object(F.a)(Mc,
this.Ola[qa]));delete this.Ola[qa]},null)}catch(qa){ue.a.J(508944718,306,10,"Exception thrown at FireTileEvents: "+qa)}}R9b(qa){if(qa&&this.sa.Aa&&qa.graphNode&&this.sa.Aa.id===qa.graphNode.id){var hb=Date.now(),Gb=this.oSk.$6b(qa.graphNode,wg[qa.yYa]);if(Gb){Object(pb.a)("PPTOAugLoopProofingTelemetry")&&ue.a.J(508944719,375,20,"ALv1: submitting proofing operation");this.VP.execute(vd=>{vd.submit(bj.a.ezc,Gb)});const pc=qa.xef;this.Tkh(pc,hb);ue.a.J(508944717,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",
wg[qa.yYa],qa.GOa,m.c(Gb).length,Gb.Id,this.pfg(pc))}}}}Object(k.a)(nf,"SlideTextTileTriggerController",Qe,[]);var ki=d(1057),qf=d(631),be=d(632),Ud=d(57);class Ei extends Qe{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg,ch,$h){super(hb&1937,Gb,pc,ch);this.onRefreshTileAnnotations=(wj,kf)=>{this.cfa(kf,512)};this.onSlideReorder=(wj,kf)=>{this.cfa(kf,1024)};this.EKa=qa.Cd(8);this.KV=qa.Cd(12);this.aQ=vd;this.lch=zd;this.VP=le;this.yjb=Dg;this.Ba=$h;Object(qf.b)()&&(this.mch=xe)}ps(){16===(this.Xv&16)&&(this.KV.aEa(Object(na.a)(this,
this.CLa,"onBeforeParagraphDisconnect")),this.EU[Object(cd.a)(Qc,16)]=this.aQ.U6i());1===(this.Xv&1)&&(this.KV.Ak(Object(na.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.EU[Object(cd.a)(Qc,1)]=this.aQ.V6i());128===(this.Xv&128)&&(this.EKa.dea(Object(na.a)(this,this.onSlideConnected,"onSlideConnected")),this.EU[Object(cd.a)(Qc,128)]=this.aQ.S6i());256===(this.Xv&256)&&(this.EKa.B4(Object(na.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.EU[Object(cd.a)(Qc,
256)]=this.aQ.T6i());this.Ba.G5&&512===(this.Xv&512)&&(this.yjb.qzi(this.onRefreshTileAnnotations),this.EU[Object(cd.a)(Qc,512)]=this.aQ.W6i());this.B8c()&&1024===(this.Xv&1024)&&(Object(qf.b)()&&this.mch.ps(),this.yjb.Kzi(this.onSlideReorder),this.EU[Object(cd.a)(Qc,1024)]=this.aQ.X6i())}Jca(){this.KV.tn(Object(na.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.KV.UMa(Object(na.a)(this,this.CLa,"onBeforeParagraphDisconnect"));this.EKa.iia(Object(na.a)(this,this.onSlideConnected,
"onSlideConnected"));this.EKa.Wza(Object(na.a)(this,this.onSlideDisconnected,"onSlideDisconnected"));this.Ba.G5&&this.yjb.GBl(this.onRefreshTileAnnotations);this.B8c()&&(Object(qf.b)()&&this.mch.Jca(),this.yjb.TBl(this.onSlideReorder))}onSlideConnected(qa,hb){this.cfa(hb,128)}onSlideDisconnected(qa,hb){this.cfa(hb,256)}fireTileEvents(){try{Zf.a.forEach(this.Ola,qa=>{this.R9b(Object(F.a)(Mc,this.Ola[qa]));delete this.Ola[qa]},null)}catch(qa){ue.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+
qa)}}R9b(qa){if(qa&&qa.graphNode){var hb=this.lch.$6b(qa.graphNode,wg[qa.yYa]),Gb=null,pc=Object(F.a)(205,qa.graphNode);if(pc&&!pc.hP&&!pc.XEb){var vd=(this.Ba.G5||this.Ba.c6c)&&pb.a("ALSlideTileIdNewFormat")?pc.sid.toString()+"#"+pc.cid.toString():pc.sid.toString()+pc.cid.toString();var zd=["session","doc"];hb=[Object.assign(new Eb.a,{id:vd,body:hb,sourceTimestamp:Date.now()})];this.B8c()&&"slideReorder"in qa.GOa?this.LDl(pc,zd,hb):(10===qa.yYa?"slideAdded"in qa.GOa||(Gb=Object.assign(new dc,{parentPath:zd,
items:hb})):"slideAdded"in qa.GOa?this.B8c()?(pc=this.lch.Z1c(pc),qa=pc[0],pc=pc[1],Gb=Object.assign(new Ea.a,{parentPath:zd,items:hb,prevId:qa,nextId:pc})):Gb=Object.assign(new Ea.a,{parentPath:zd,items:hb}):Gb=Object.assign(new gb.a,{parentPath:zd,items:hb}),Gb&&(pb.a("PPTOAugLoopProofingTelemetry")&&ue.a.J(508953108,375,20,"ALv2: submitting operation {0}",Gb.H_.T_),this.VP.execute(xe=>{xe.submitOperation(Gb)})))}}}LDl(qa,hb,Gb){const pc=Object.assign(new dc,{parentPath:hb,items:Gb}),vd=qa.mZe?
Ud.a.Aq(qa.mZe.sid,qa.mZe.cid).toString():be.a;qa=qa.sSe?Ud.a.Aq(qa.sSe.sid,qa.sSe.cid).toString():be.b;const zd=Object.assign(new Ea.a,{parentPath:hb,items:Gb,prevId:vd,nextId:qa});this.VP.execute(xe=>{xe.submitOperation(pc);xe.submitOperation(zd)})}B8c(){return this.Ba.c6c&&pb.a("SlideReorderOnALEnabled")}}Object(k.a)(Ei,"SlideTileTriggerController",Qe,[]);var ei=d(1273),Aj=d(32),tj;(function(qa){qa[qa.Unspecified=0]="Unspecified";qa[qa.Inline=1]="Inline";qa[qa.Floating=2]="Floating"})(tj||(tj=
{}));var Pi;(function(qa){qa[qa.Undefined=0]="Undefined";qa[qa.Bullet=1]="Bullet";qa[qa.Numbered=2]="Numbered";qa[qa.Lim=3]="Lim";qa[qa.Nil=4]="Nil";qa[qa.Any=5]="Any";qa[qa.NoList=6]="NoList";qa[qa.Invalid=7]="Invalid"})(Pi||(Pi={}));var Eh;(function(qa){qa[qa.DontCare=1]="DontCare";qa[qa.Thin=2]="Thin";qa[qa.ExtraLight=3]="ExtraLight";qa[qa.Light=4]="Light";qa[qa.Normal=5]="Normal";qa[qa.Medium=6]="Medium";qa[qa.SemiBold=7]="SemiBold";qa[qa.Bold=8]="Bold";qa[qa.ExtraBold=9]="ExtraBold";qa[qa.Heavy=
10]="Heavy"})(Eh||(Eh={}));var Th;(function(qa){qa[qa.NoCaps=0]="NoCaps";qa[qa.SmallCaps=1]="SmallCaps";qa[qa.AllCaps=2]="AllCaps";qa[qa.AllPetiteCaps=3]="AllPetiteCaps";qa[qa.PetiteCaps=4]="PetiteCaps";qa[qa.Unicase=5]="Unicase";qa[qa.Titling=6]="Titling";qa[qa.Other=7]="Other"})(Th||(Th={}));var Qi;(function(qa){qa[qa.None=0]="None";qa[qa.Words=1]="Words";qa[qa.SingleLine=2]="SingleLine";qa[qa.DoubleLine=3]="DoubleLine";qa[qa.HeavyLine=4]="HeavyLine";qa[qa.DottedLine=5]="DottedLine";qa[qa.DottedHeavyLine=
6]="DottedHeavyLine";qa[qa.DashLine=7]="DashLine";qa[qa.DashHeavyLine=8]="DashHeavyLine";qa[qa.DashLongLine=9]="DashLongLine";qa[qa.DashLongHeavyLine=10]="DashLongHeavyLine";qa[qa.DotDashLine=11]="DotDashLine";qa[qa.DotDashHeavyLine=12]="DotDashHeavyLine";qa[qa.DotDotDashLine=13]="DotDotDashLine";qa[qa.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";qa[qa.WavyLine=15]="WavyLine";qa[qa.WavyHeavyLine=16]="WavyHeavyLine";qa[qa.WavyDoubleLine=17]="WavyDoubleLine"})(Qi||(Qi={}));var fi;(function(qa){qa[qa.Left=
0]="Left";qa[qa.Right=1]="Right";qa[qa.Center=2]="Center";qa[qa.Justified=3]="Justified";qa[qa.Other=4]="Other";qa[qa.None=5]="None";qa[qa.JustifyLow=6]="JustifyLow";qa[qa.Distributed=7]="Distributed";qa[qa.ThaiDistributed=8]="ThaiDistributed"})(fi||(fi={}));var Ng;(function(qa){qa[qa.Image=0]="Image";qa[qa.TextBox=1]="TextBox";qa[qa.Chart=2]="Chart";qa[qa.SmartArt=3]="SmartArt";qa[qa.Drawing=4]="Drawing";qa[qa.EquationObject=5]="EquationObject";qa[qa.Ink=6]="Ink";qa[qa.InkSpace=7]="InkSpace";qa[qa.InkEndOfLine=
8]="InkEndOfLine";qa[qa.LineBreak=9]="LineBreak";qa[qa.PageBreak=10]="PageBreak";qa[qa.PageNumbers=11]="PageNumbers";qa[qa.FootnoteEndnote=12]="FootnoteEndnote";qa[qa.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";qa[qa.Tab=14]="Tab";qa[qa.UnsupportedObject=15]="UnsupportedObject";qa[qa.Other=16]="Other"})(Ng||(Ng={}));var $d;(function(qa){qa[qa.Initial=0]="Initial";qa[qa.FirstLine=1]="FirstLine";qa[qa.Hanging=2]="Hanging"})($d||($d={}));class Qf{constructor(qa,hb){this.lB=qa;this.Uaa=
hb}bhl(qa){const hb={};try{hb.listType=this.qBb(qa),hb.outlineLevel=wa.ParagraphReader.g1c(qa),hb.indentation=Qf.iEj(this.Uaa.o$(qa))}catch(Gb){ue.a.J(509203979,822,50,"Exception message: "+Gb.message)}return hb}qBb(qa){const hb=new Aj.GraphIterator;hb.set(qa);hb.uc(11);hb.Ug(11);return(qa=this.lB.Aw(hb))?Qf.t0i(qa.listType):Pi.NoList}static t0i(qa){switch(qa){case 15:return Pi.Any;case 1:return Pi.Bullet;case 42:return Pi.Invalid;case 13:return Pi.Lim;case 14:return Pi.Nil;case 16:return Pi.NoList;
case 0:return Pi.Numbered;default:return Pi.Invalid}}static iEj(qa){return 2===qa.unit?Math.floor(ei.a.UVf(qa.value)/20):Math.floor(qa.value/20)}}Object(k.a)(Qf,"TextTileFormatter",null,[1254]);class Cg{}Cg.fWl="ShapeTextOnActiveSlideDomReady";Cg.iWl="ShapeTextOnSelectionFinished";Cg.hWl="ShapeTextOnParagraphPropertyChanged";Cg.jWl="ShapeTextOnShapeChildTopologyChanged";Cg.gWl="ShapeTextOnParagraphDisconnect";Cg.b3l="SlideTextOnActiveSlideDomReady";Cg.f3l="SlideTextOnParagraphPropertyChanged";Cg.e3l=
"SlideTextOnParagraphDisconnect";Cg.g3l="SlideTextOnShapeChildTopologyChanged";Cg.d3l="SlideTextOnNumberListPropertyChanged";Cg.c3l="SlideTextOnNumberListDisconnect";Cg.X2l="SlideOnParagraphPropertyChanged";Cg.W2l="SlideOnParagraphDisconnect";Cg.U2l="SlideOnConnect";Cg.V2l="SlideOnDisconnect";Cg.Y2l="SlideOnRefreshTileAnnotations";Cg.Z2l="SlideOnReorder";Object(k.a)(Cg,"DetectStrategyName",null,[]);class rh{constructor(qa){this.RV=qa}get Xv(){return 4}$X(qa,hb){const Gb=[];if((qa=Object(F.a)(fe.a,
qa))&&qa.Aa&&(qa=Object(F.a)(205,qa.Aa))){qa=qa.yj();for(const pc of qa)this.RV.C6b(pc)&&Array.add(Gb,pc);0<Gb.length&&hb(Gb,1)}}}Object(k.a)(rh,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[1330]);var ge=d(260);class bi{constructor(qa,hb,Gb){this.Ga=qa;this.RV=hb;this.oa=Gb}get Xv(){return 16}$X(qa,hb){if((qa=Object(F.a)(ge.a,qa))&&qa.node&&12===qa.node.type&&(qa=this.Ga.Gn(qa.node))&&this.RV.C6b(qa)){var Gb=this.oa.Z0();Gb&&Gb.id===qa.id&&(Gb=[],Array.add(Gb,qa),hb(Gb,6))}}}Object(k.a)(bi,
"ShapeTextOnParagraphDisconnectDetectStrategy",null,[1330]);var Og=d(42),Ki=d(361);class sk{constructor(qa,hb,Gb){this.Ga=qa;this.RV=hb;this.oa=Gb}get Xv(){return 1}$X(qa,hb){if((qa=Object(F.a)(Ki.a,qa))&&qa.node&&12===qa.node.type){const pc=this.Ga.Gn(qa.node);if(pc&&this.RV.C6b(pc)){var Gb=this.oa.Z0();Gb&&Gb.id===pc.id&&(qa.property===Og.a.listLevel?this.Syb(3,pc,hb):qa.property===Vg.a.np&&this.Syb(4,pc,hb))}}}Syb(qa,hb,Gb){if(hb){var pc=[];Array.add(pc,hb);Gb(pc,qa)}}}Object(k.a)(sk,"ShapeTextOnParagraphPropertyChangedDetectStrategy",
null,[1330]);var kk=d(866);class Nj{constructor(qa,hb,Gb,pc){this.oa=qa;this.RV=hb;this.B2=Gb;this.Hoc=pc}get Xv(){return 2}$X(qa,hb){const Gb=[];if(qa=Object(F.a)(kk.a,qa))if(this.Hoc&&this.B2&&this.B2.c_j(qa.RF),!this.oa.H5())this.Hoc&&this.B2&&this.B2.pPb();else if(qa.LF&&qa.LF.length){this.Hoc&&this.B2&&this.B2.pPb();qa=this.oa.Hd();for(const pc of qa)this.RV.C6b(pc)&&Array.add(Gb,pc);0<Gb.length&&hb(Gb,2)}}}Object(k.a)(Nj,"ShapeTextOnSelectionFinishedDetectStrategy",null,[1330]);var rl=d(599);
class cj{constructor(qa,hb){this.oa=qa;this.RV=hb}get Xv(){return 8}$X(qa,hb){const Gb=[];if((qa=Object(F.a)(rl.a,qa))&&qa.node&&10===qa.node.type&&1===qa.vU&&(qa=Object(F.a)(4,qa.node))&&this.RV.C6b(qa)){var pc=this.oa.Z0();pc&&pc.get_shapeId()===qa.get_shapeId()&&(Array.add(Gb,qa),hb(Gb,5))}}}Object(k.a)(cj,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[1330]);class bh{constructor(qa){this.DLg=qa}get Xv(){return 1===this.DLg?128:256}$X(qa,hb){if((qa=Object(F.a)(ge.a,qa))&&qa.node&&8===
qa.node.type){const Gb=[];Array.add(Gb,qa.node);1===this.DLg?hb(Gb,9):hb(Gb,10)}}}Object(k.a)(bh,"SlideOnConnectOrDisconnectDetectStrategy",null,[1330]);class vi{constructor(qa){this.nc=qa}get Xv(){return 16}$X(qa,hb){if((qa=Object(F.a)(ge.a,qa))&&qa.node&&12===qa.node.type){const Gb=this.nc.ug(qa.node);Gb&&(qa=[],Array.add(qa,Gb),hb(qa,6))}}}Object(k.a)(vi,"SlideOnParagraphDisconnectDetectStrategy",null,[1330]);class xh{constructor(qa){this.nc=qa}get Xv(){return 1}$X(qa,hb){var Gb=Object(F.a)(Ki.a,
qa);if(Gb&&Gb.node&&12===Gb.node.type){const pc=this.nc.ug(Gb.node);pc&&Object(F.a)($g.AParagraphNode,Gb.node)&&(qa=0,Gb.property===Og.a.listLevel?qa=3:Gb.property===Vg.a.np&&(qa=4),Gb=[],Array.add(Gb,pc),hb(Gb,qa))}}}Object(k.a)(xh,"SlideOnParagraphPropertyChangedDetectStrategy",null,[1330]);class hh{get Xv(){return 4}$X(qa,hb){if((qa=Object(F.a)(fe.a,qa))&&qa.Aa&&(qa=Object(F.a)(205,qa.Aa))){var Gb=qa.yj();for(var pc of Gb)if(pc.hasText){pc=[];Array.add(pc,qa);hb(pc,1);break}}}}Object(k.a)(hh,"SlideTextOnActiveSlideDomReadyDetectStrategy",
null,[1330]);class zf{constructor(qa,hb){this.nc=qa;this.sa=hb}get Xv(){return 64}$X(qa,hb){if((qa=Object(F.a)(ge.a,qa))&&this.sa.Aa&&qa.node&&22===qa.node.type&&(qa=this.nc.ug(qa.node))&&qa.id===this.sa.Aa.id){const Gb=[];Array.add(Gb,qa);hb(Gb,7)}}}Object(k.a)(zf,"SlideTextOnNumberListDisconnectDetectStrategy",null,[1330]);class Yh{constructor(qa,hb){this.nc=qa;this.sa=hb}get Xv(){return 32}$X(qa,hb){var Gb=Object(F.a)(Ki.a,qa);Gb&&Gb.node&&22===Gb.node.type&&(qa=this.nc.ug(Gb.node))&&this.sa.Aa&&
qa.id===this.sa.Aa.id&&Gb.property===Vg.a.Dj&&(Gb=[],Array.add(Gb,qa),hb(Gb,8))}}Object(k.a)(Yh,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[1330]);class Oa{constructor(qa,hb,Gb,pc){this.sa=qa;this.Qm=hb;this.nc=Gb;this.E_a=pc}get Xv(){return 16}$X(qa,hb){if((qa=Object(F.a)(ge.a,qa))&&qa.node&&this.sa.Aa&&12===qa.node.type){const Gb=this.nc.ug(qa.node);!Gb||Gb.id!==this.sa.Aa.id||this.Qm.I$(qa.node)&&!this.E_a||(qa=[],Array.add(qa,this.sa.Aa),hb(qa,6))}}}Object(k.a)(Oa,"SlideTextOnParagraphDisconnectDetectStrategy",
null,[1330]);class sb{constructor(qa,hb,Gb,pc,vd,zd,xe,le){this.sa=qa;this.Qm=hb;this.nc=Gb;this.Ga=pc;this.E_a=vd;this.B2=xe;this.Hoc=le}get Xv(){return 1}$X(qa,hb){if((qa=Object(F.a)(Ki.a,qa))&&qa.node&&this.sa.Aa&&12===qa.node.type){var Gb=this.nc.ug(qa.node);if(Gb&&Gb.id===this.sa.Aa.id&&(Gb=Object(F.a)($g.AParagraphNode,qa.node))&&(!this.Qm.I$(Gb)||this.E_a)){var pc=this.Ga.Gn(Gb);pc.Yfa||pc.Xu||pc.ig||pc.vd||!pc.Sk||!this.Hoc||(this.B2.settings.WYe=!0,this.B2.ydm(Gb));qa.property===Og.a.listLevel?
this.Syb(3,this.sa.Aa,hb):qa.property===Vg.a.np?this.Syb(4,this.sa.Aa,hb):qa.property===Ag.a.R5&&(Gb.ra(Ag.a.R5,!1)||this.Syb(4,this.sa.Aa,hb))}}}Syb(qa,hb,Gb){if(hb){var pc=[];Array.add(pc,hb);Gb(pc,qa)}}}Object(k.a)(sb,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[1330]);class Pb{constructor(qa,hb){this.sa=qa;this.nc=hb}get Xv(){return 8}$X(qa,hb){qa=Object(F.a)(rl.a,qa);this.sa.Aa&&qa&&qa.node&&10===qa.node.type&&1===qa.vU&&(qa=Object(F.a)(4,qa.node))&&(qa=this.nc.ug(qa))&&qa.id===
this.sa.Aa.id&&(qa=[],Array.add(qa,this.sa.Aa),hb(qa,5))}}Object(k.a)(Pb,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[1330]);class kc{get Xv(){return 512}$X(qa,hb){if(qa&&qa.Aa&&(qa=qa.Aa)){var Gb=qa.yj();Gb&&Gb.some(pc=>this.otk(pc))&&hb([qa],11)}}otk(qa){if(!qa||!qa.hasText)return!1;switch(qa.mj){case 0:case 2:case 3:case 15:case 1:return!0;case 8:return!qa.T$;default:return!1}}}Object(k.a)(kc,"SlideOnRefreshTileAnnotationsDetectStrategy",null,[1330]);class Wc{get Xv(){return 1024}$X(qa,
hb){if(qa&&qa.lih){var Gb=qa.lih;Gb?(Gb.mZe=qa.Pkl,Gb.sSe=qa.R_k,hb([Gb],12)):ue.a.J(508851910,306,15,"Got null slide node for slide reorder strategy")}else ue.a.J(508851911,306,15,"Slide reorder strategy got blank args")}}Object(k.a)(Wc,"SlideOnReorderDetectStrategy",null,[1330]);class Xd{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg){this.nc=qa;this.Ga=hb;this.gb=Gb;this.RV=pc;this.sa=vd;this.Qm=zd;this.Ba=xe;this.xr=le;this.B2=Dg}FAj(qa){if(U.a.Ta(qa))return 0;let hb=0;for(const Gb of qa)hb|=this.xGl(Gb);
return hb}HAj(qa){if(U.a.Ta(qa))return 0;let hb=0;for(const Gb of qa)hb|=this.zGl(Gb);return hb}GAj(qa){if(U.a.Ta(qa))return 0;let hb=0;for(const Gb of qa)hb|=this.yGl(Gb);return hb}I6i(){return new sk(this.Ga,this.RV,this.gb)}J6i(){return new Nj(this.gb,this.RV,this.B2,this.Ba.Atc)}G6i(){return new rh(this.RV)}K6i(){return new cj(this.gb,this.RV)}H6i(){return new bi(this.Ga,this.RV,this.gb)}Y6i(){return new hh}a7i(){return new Oa(this.sa,this.Qm,this.nc,this.Ba.pptNotesInSlideTextTileIsEnabled)}b7i(){return new sb(this.sa,
this.Qm,this.nc,this.Ga,this.Ba.pptNotesInSlideTextTileIsEnabled,this.xr,this.B2,this.Ba.Atc)}c7i(){return new Pb(this.sa,this.nc)}$6i(){return new Yh(this.nc,this.sa)}Z6i(){return new zf(this.nc,this.sa)}U6i(){return new vi(this.nc)}V6i(){return new xh(this.nc)}T6i(){return new bh(2)}S6i(){return new bh(1)}W6i(){return new kc}X6i(){return new Wc}xGl(qa){return qa===Cg.hWl?1:qa===Cg.iWl?2:qa===Cg.fWl?4:qa===Cg.jWl?8:qa===Cg.gWl?16:0}zGl(qa){return qa===Cg.b3l?4:qa===Cg.e3l?16:qa===Cg.f3l?1:qa===Cg.g3l?
8:qa===Cg.d3l?32:qa===Cg.c3l?64:0}yGl(qa){return qa===Cg.W2l?16:qa===Cg.X2l?1:qa===Cg.U2l?128:qa===Cg.V2l?256:qa===Cg.Y2l?512:qa===Cg.Z2l?1024:0}}Object(k.a)(Xd,"TilingFactory",null,[1255]);class Gd extends Sys.EventArgs{constructor(qa){super();this.Aa=qa}}Object(k.a)(Gd,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class Pe{constructor(){this.K=null;this.zOe=this.cCe=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}fc(qa){this.K=qa;qa.register(1252,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().na(()=>
new ne(qa.resolve("Box4.Graph.IGraphIteratorFactory"),qa.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),qa.resolve("PowerPointWebEditor.IShapeReader"),qa.resolve("Box4.IParagraphReader")));qa.register(1253,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().na(()=>new ui(qa.resolve("Box4.IParagraphReader"),qa.resolve("PowerPointWebEditor.Graph.INotesReader"),qa.resolve("Box4.Proofing.IProofingTextUtility"),qa.resolve("Box4.Graph.IGraphIteratorFactory"),qa.resolve("Box4.ITableNavigator"),
qa.resolve("PowerPointWebEditor.Graph.ITableReader"),qa.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),qa.resolve("Box4.IListMarkerUtility"),qa.resolve("PowerPointWebEditor.IPPTParagraphReader"),qa.resolve("Box4.List.IListReader"),qa.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));qa.register(1254,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().na(()=>
new Qf(qa.resolve("Box4.List.IListReader"),qa.resolve("Box4.IParagraphIndentationReader")));qa.register(ki.a,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().na(()=>new ki.a(qa.resolve("Box4.Graph.IGraphIteratorFactory"),qa.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),qa.resolve("PowerPointWebEditor.IApplicationSettings"),qa.resolve("Box4.IParagraphReader"),qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),qa.resolve("PowerPointWebEditor.IPresentationReader")));
Object(qf.b)()&&qa.register(qf.a,"PowerPointWebEditor.ContentUpdateDetection.SlideTileOrderTracker").ma().na(()=>new qf.a(qa.resolve("PowerPointWebEditor.IPresentationReader"),qa.resolve("Box4.Graph.IGraphInstance"),qa.Ha("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier")));qa.register(1255,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().na(()=>new Xd(qa.resolve("PowerPointWebEditor.ISlideReader"),qa.resolve("PowerPointWebEditor.IShapeReader"),qa.resolve("PowerPointWebEditor.IPptSelectionManager"),
qa.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),qa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),qa.resolve("PowerPointWebEditor.Graph.INotesReader"),qa.resolve("PowerPointWebEditor.IApplicationSettings"),qa.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),qa.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));qa.register(ig,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().na(()=>new ig(qa.resolve("Box4.Graph.IGraphInstance"),
qa.resolve("PowerPointWebEditor.IPptSelectionManager"),qa.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),qa.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),qa.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),qa.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").FAj(qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
qa.resolve("Common.ITaskManager"),qa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),qa.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),qa.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));qa.register(nf,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().na(()=>
new nf(qa.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").HAj(qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),qa.resolve("Common.ITaskManager"),qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),
qa.resolve("Box4.Graph.IGraphInstance"),qa.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),qa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),qa.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),qa.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),qa.resolve("PowerPointWebEditor.IApplicationSettings")));qa.register(Ei,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().na(()=>new Ei(qa.resolve("Box4.Graph.IGraphInstance"),
qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").GAj(qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),qa.resolve("Common.ITaskManager"),qa.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,qa.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),qa.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),Object(qf.b)()?qa.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileOrderTracker"):
null,qa.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),qa.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),qa.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),qa.resolve("PowerPointWebEditor.IApplicationSettings")))}Qag(){return pb.a("AL.SendSlideTile")}init(){const qa=this.K.resolve("Common.IAppSettingsManager");qa.Ue(()=>{this.cCe=qa.getBooleanAppSetting("497");this.zOe=qa.getBooleanAppSetting("810")||qa.getBooleanAppSetting("809");this.cCe&&(qa.getBooleanAppSetting("473")&&
this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.zOe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.Qag()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.K.Ha("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").execute(hb=>
hb.Lrl(new Gd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Aa)))})}dispose(){this.cCe&&(this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.zOe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.Qag()&&
(pb.a("PPTOnline.BugFix-7758356")?this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").dispose():this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize()))}static main(){w.a.instance.Ac(new Pe)}}Object(k.a)(Pe,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Lf=d(1061),Nf=d(661),dg=d(144),Pg=d(154),pi=d(535),li=d(110),Ri=d(47);class Ih{constructor(qa,hb,Gb,pc,vd,zd,xe,le){this.type="EditorPaneProps";this.critiqueCountInclusiveness=
this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=qa;this.critiqueCountGrammar=hb;this.critiqueCountFormality=Gb;this.critiqueCountPunctuationConvention=pc;this.critiqueCountVocabulary=vd;this.critiqueCountConciseness=zd;this.critiqueCountClarity=xe;this.critiqueCountInclusiveness=le}}Object(k.a)(Ih,"EditorPaneProps",
null,[]);class ij{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg,ch,$h,wj,kf,Kf,lh){this.Mb=!1;this.$2d=320;this.W_a=!1;this.Dca={};if(!qa)throw Error.argumentNull("pptSelectionManager");if(!hb)throw Error.argumentNull("appFrame");if(!Gb)throw Error.argumentNull("actionManager");if(!pc)throw Error.argumentNull("focusManager");if(!vd)throw Error.argumentNull("editorPane");if(!xe)throw Error.argumentNull("graphOperationEventHandler");if(!le)throw Error.argumentNull("viewElementEventHandlers");if(!Dg)throw Error.argumentNull("viewEventSource");
if(!ch)throw Error.argumentNull("pageView");if(!wj)throw Error.argumentNull("workspace");if(!kf)throw Error.argumentNull("loadScript");if(!lh)throw Error.argumentNull("graphTopologyManager");kf("powerpoint-editor-intl").then(()=>{this.W_a=!0}).catch(sc=>{ue.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+sc.toString())});this.Db=hb;this.ia=Gb;this.RCe=Kf;this.Fa=pc;this.Wf=xe;this.xd=le;this.Hc=Dg;this.VP=$h;this.sa=lh;this.Wf.HJ(this.FLa.bind(this));this.Wf.$Da(this.FLa.bind(this));
this.Hc.zSa(this.FLa.bind(this));this.xd.eEa(this.FLa.bind(this));this.Db.QH(this.St.bind(this));this.initialize()}initialize(){this.VP.execute(qa=>{qa.addEventHandler(pi.a.cSc,this.LVj.bind(this))})}dispose(){this.Wf.E7(this.FLa.bind(this));this.Wf.w2a(this.FLa.bind(this));this.Hc.Emb(this.FLa.bind(this));this.xd.Gmb(this.FLa.bind(this));this.Db.a_(this.FLa.bind(this))}qb(){this.ia.pa(Hd.a.xob,Te.a.application,this.xob.bind(this),4);this.ia.pa(Hd.a.Ysd,Te.a.application,this.Ysd.bind(this),96)}Sd(){}FLa(){this.Mb&&
this.Jl(!0)}St(qa){1===qa.mode&&this.Mb&&(this.Mb=!1,this.ur(),this.Fa.qk(Ri.a.TX,this.Mb))}Ysd(qa,hb,Gb,pc,vd){(qa=Object(F.a)(li.a,vd))&&qa.Rf(this.Mb);return 32}xob(qa,hb,Gb){return this.W_a?1===Gb?32:2===Gb?(this.Mb=!this.Mb,Pg.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Mb.toString(),qa,()=>{this.Mb?this.Jl():this.ur();return 32})):8:8}Jl(qa=!1){const hb=this.SA(),Gb=Object.assign(new Nf.a,{title:"Editor Pane",hideHeader:!1,width:this.$2d,location:2,contentProps:hb,onOpen:()=>{},
onClose:()=>{this.Mb=!1},isModernPane:!0});dg.UISurfaces.qr().then(pc=>{qa?pc.updateTaskPane(Ri.a.TX,Gb):pc.showTaskPane(Ri.a.TX,Gb);return null}).catch(pc=>{ue.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+pc.toString())})}ur(){dg.UISurfaces.qr().then(qa=>{qa.hideTaskPane(Ri.a.TX,2);return null}).catch(qa=>{ue.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+qa.toString())})}SA(){let qa=0,hb=0,Gb=0,pc=0,vd=0,zd=
0,xe=0,le=0;const Dg=this.sa.Aa?this.sa.Aa.cid:void 0;Dg&&this.Dca[Dg]&&Object.keys(this.Dca[Dg]).forEach(ch=>{this.Dca[Dg][ch].forEach($h=>{switch($h.CategoryTitle){case "Spelling":qa+=1;break;case "Grammar":hb+=1;break;case "Conciseness":zd+=1;break;case "Formality":Gb+=1;break;case "PunctuationConventions":pc+=1;break;case "Clarity":xe+=1;break;case "Inclusiveness":le+=1;break;case "Vocabulary":vd+=1;break;default:ue.a.J(509727769,822,50,"Unknown Critique Type: "+$h.CategoryTitle)}})});return new Ih(qa,
hb,Gb,pc,vd,zd,xe,le)}Dhm(qa,hb){const Gb={};Object.keys(qa).forEach(pc=>{this.Dca[hb]?(Object.keys(this.Dca[hb]).includes(pc),this.Dca[hb][pc]=qa[pc]):(Gb[pc]=qa[pc],this.Dca[hb]=Gb)})}LVj(qa,hb,Gb,pc){hb&&pc&&(qa=JSON.parse(hb.Content),pc=this.RCe.VSc(pc.critiques),hb=this.sa.Aa.cid,null!=pc&&0<pc.length?this.Dhm(this.Ovj(pc),hb):0==pc.length&&this.Dca[hb]&&this.Yej(qa.drawingElems,hb),this.Dca[hb]&&this.eAl(qa.drawingElems,hb),this.Jl(!0))}eAl(qa,hb){const Gb=Object.keys(this.Dca[hb]),pc=this.pQj(qa);
Gb.forEach(vd=>{pc.includes(vd)||delete this.Dca[hb][vd]})}pQj(qa){const hb=[];qa.forEach(Gb=>{0<Gb.text.paragraphs.length&&Gb.text.paragraphs.forEach(pc=>{hb.push(pc.id)})});return hb}Yej(qa,hb){qa.forEach(Gb=>{0<Gb.text.paragraphs.length&&this.wSi(Gb.text.paragraphs,hb)})}wSi(qa,hb){qa.forEach(Gb=>{this.Dca[hb][Gb.id]&&(Gb.pfRuns[0].pf.proofingDirty||""==Gb.chars)&&delete this.Dca[hb][Gb.id]})}Ovj(qa){const hb={};if(qa)for(const Gb of qa)Gb.TileId in hb?Array.add(hb[Gb.TileId],Gb):hb[Gb.TileId]=
[Gb];return hb}}Object(k.a)(ij,"DexLitePaneActor",null,[106,948]);class Fi{constructor(){this.ua=new ad.a}d1e(qa){this.ua.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",qa)}ILf(qa){this.ua.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",qa)}}Object(k.a)(Fi,"EditorRuntimeEventSource",null,[1331,1332,1333]);var Da=d(16),Wa=d(50),lb=d(705),Lb=d(34);class oc{constructor(qa,hb){this.paragraph=qa;this.critiqueId=hb}}Object(k.a)(oc,"CritiqueToHighlight",null,[]);class Jc{constructor(qa,hb,Gb,
pc,vd,zd,xe,le,Dg,ch){this.Gga=qa;this.qHk=hb;this.sa=Gb;this.bE=pc;this.Eb=vd;this.BK=zd;this.oa=xe;this.sDe=le;this.Fa=Dg;this.aJk=ch;this.Gga.q2e(this.qHk)}c4c(qa){qa.length?(qa=this.DHj(qa),qa.length&&(qa=Object.assign(new lb.a,{action:0,type:2,Ffa:qa,Klb:this.Gga.zfb?this.Gga.zfb.Ffa:null}),this.Gga.yyd(qa))):this.w$i()}w$i(){const qa=this.Gga.zfb?this.Gga.zfb.Ffa:null,hb=new lb.a;hb.action=1;hb.type=2;hb.Ffa=qa;hb.Klb=qa;this.Gga.yyd(hb)}DHj(qa){const hb=[];if(!this.sDe.isEnabled(2))return hb;
var Gb=this.sa.Aa;if(Gb&&Gb.isSlideCritiqueReady){var pc=Gb.UNa;if(!pc.count)return this.JAe(2),hb;Gb=0;for(const zd of pc)if(pc=Object(F.a)($g.AParagraphNode,zd)){var vd=this.iie(pc);for(const xe of vd)vd=Object(F.a)(419,xe.Rh),vd.KO&&Array.contains(qa,vd.KO.TraceId)&&(Gb++,vd=new oc(pc,vd.KO.TraceId),Array.add(hb,vd))}Gb!==qa.length&&this.YAe(2,Gb,qa.length)}else this.UAe(2,Gb);return hb}cXh(qa){if(!this.sDe.isEnabled(3))return!1;var hb=this.sa.Aa;if(hb&&hb.isSlideCritiqueReady){hb=hb.UNa;if(!hb.count)return this.JAe(3),
!1;let Gb=0;const pc=this.Eb.ud(15,void 0,()=>{this.$vh()});try{let vd=!1;pc.mc(hb.ga(0));pc.Wc=Lb.a.yCd;for(const zd of hb){const xe=Object(F.a)($g.AParagraphNode,zd);if(xe){const le=new D.a,Dg=this.iie(xe);for(const ch of Dg){const $h=Object(F.a)(419,ch.Rh);if($h.KO&&qa.Ib($h.KO.TraceId)){const wj=qa.ga($h.KO.TraceId);let kf;try{kf=$h.KO.Suggestions[wj].Text;const Kf=new Da.a(ch,kf);le.add(Kf);vd||($h.DOa(this.JVk(wj)),vd=!0);Gb++}catch(Kf){ue.a.J(508692554,375,10,"Take suggestion: Parse failed with exception: {0}",
Kf)}}}le.count&&(le.Sc((ch,$h)=>$h.key.begin-ch.key.begin),this.XDl(xe,le))}}Gb!==qa.count&&this.YAe(3,Gb,qa.count)}finally{pc&&pc.dispose()}}else return this.UAe(3,hb),!1;return!0}JVk(qa){switch(qa){case 0:return Lb.a.dBa;case 1:return Lb.a.eBa;case 2:return Lb.a.fBa;case 3:return Lb.a.lOa;case 4:return Lb.a.mOa;default:return 0}}XDl(qa,hb){for(const Gb of hb)this.BK.replaceTextRange(Wa.a.createTextRange(qa,0<Gb.key.begin?Gb.key.begin:0,Gb.key.end),Gb.value,!0,!1)}ignoreCritiques(qa,hb){if(!this.sDe.isEnabled(hb))return!1;
var Gb=this.sa.Aa;if(Gb&&Gb.isSlideCritiqueReady){var pc=Gb.UNa;if(!pc.count)return this.JAe(hb),!1;this.$vh();Gb=!1;let vd=0;for(const zd of pc)if(pc=Object(F.a)($g.AParagraphNode,zd)){pc=this.iie(pc);for(const xe of pc)pc=Object(F.a)(419,xe.Rh),pc.KO&&Array.contains(qa,pc.KO.TraceId)&&(pc.aHa=!0,Gb||(pc.DOa(Lb.a.Poe),Gb=!0),vd++)}vd!==qa.length&&this.YAe(hb,vd,qa.length)}else return this.UAe(hb,Gb),!1;return!0}iie(qa){return this.bE.KG(qa,hb=>{hb=Object(F.a)(419,hb.Rh);return!!hb&&5===hb.proofingType&&
!hb.aHa})}JAe(qa){ue.a.J(508692553,375,15,"{0}: No slide critique in active slide. Skipping",qa)}YAe(qa,hb,Gb){ue.a.J(508692552,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",qa,hb,Gb)}UAe(qa,hb){ue.a.J(508692551,375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",qa,!!hb)}$vh(){this.oa.Pu();this.oa.uj();this.aJk&&this.Fa.Df(Ri.a.Ag,!0)}}Object(k.a)(Jc,"ConsistencyCheckActor",null,[1258]);var bd=d(317),rd=d(99),Zd=d(937),ea=d(702),Ka=d(49),
bb=d(703),vb=d(704);class Yb extends ea.a{constructor(qa,hb){super();this.Ccd=[Zd.a.wSe,Zd.a.p$c,Zd.a.Awd,Zd.a.dQc];this.sa=qa;this.ELk=hb;this.ZHe=[new bb.a("InconsistentCritiquesHighlight",null),new bb.a("InconsistentCritiquesLeftSidebar",null),new bb.a("InconsistentCritiquesRightSidebar",null)]}get FCb(){return this.ELk}get poe(){return this.ZHe}Zdc(qa,hb){qa=Object(Ph.a)(Array,qa)?Array.isArray(qa)?qa:null:null;if(!qa||0<qa.length&&!Object(F.a)(oc,qa[0]))return hb;const Gb=new Ka.GraphTransaction(3);
try{Gb.rd(this.sa.presentation);for(const pc of qa)vb.b(pc.paragraph),hb.add(pc.paragraph)}finally{Gb&&Gb.dispose()}return hb}prc(qa,hb){if(this.FCb&&this.d1&&this.d1.Dla&&this.d1.Dla.Ffa&&2===this.d1.Dla.type){var Gb=[],pc=[];this.Tuh(this.d1.Dla.Ffa,Gb,pc);var vd=[];this.Tuh(this.d1.Dla.Klb,null,vd);hb=hb.querySelectorAll("*");for(let zd=0;zd<hb.length;zd++){let xe="",le="";const Dg=hb[zd];for(let ch=0;ch<this.Ccd.length;ch++)bd.a.Ie(Dg,this.Ccd[ch])&&(le=this.Ccd[ch],xe=bd.a.Ie(Dg,this.Ccd[ch]));
xe.length&&2===this.d1.Dla.type&&(0===this.d1.Dla.action?Array.contains(pc,qa)&&Array.contains(Gb,xe)?this.V2j(Dg,le):this.Zud(Dg):1===this.d1.Dla.action&&Array.contains(vd,qa)&&this.Zud(Dg))}}}V2j(qa,hb){rd.a.RJ(qa,"InconsistentCritiquesHighlight");switch(hb){case Zd.a.p$c:rd.a.RJ(qa,"InconsistentCritiquesLeftSidebar");break;case Zd.a.Awd:rd.a.RJ(qa,"InconsistentCritiquesRightSidebar");break;case Zd.a.dQc:rd.a.RJ(qa,"InconsistentCritiquesLeftSidebar"),rd.a.RJ(qa,"InconsistentCritiquesRightSidebar")}}Tuh(qa,
hb,Gb){if(qa)for(const pc of qa)Array.add(Gb,pc.paragraph),hb&&Array.add(hb,pc.critiqueId)}}Object(k.a)(Yb,"CritiquesHighlightActor",ea.a,[]);class Gc{}Object(k.a)(Gc,"Critique",null,[]);class ud{}Object(k.a)(ud,"Suggestion",null,[]);class Nd{p_f(qa,hb){if(!qa)return[];const Gb=Array(qa.length);for(let pc=0;pc<qa.length;pc++)Gb[pc]=hb(qa[pc]);return Gb}W_i(qa){return Object.assign(new Gc,{critiqueId:qa.TraceId,typeId:qa.TypeId,tag:qa.Tag,bucketId:qa.BucketId,paragraphId:qa.TileId,start:qa.Start,length:qa.Length,
categoryTitle:qa.CategoryTitle,explanationTitle:qa.ExplanationTitle,explanationLabel:qa.ExplanationLabel,explanation:qa.Explanation,suggestions:this.p_f(qa.Suggestions,Object(na.a)(this,this.X_i,"convertBox4Suggestion"))})}X_i(qa){return Object.assign(new ud,{text:qa.Text,description:qa.Description,bucketId:qa.BucketId,numberOfInstances:qa.NumberOfInstances})}}Object(k.a)(Nd,"DataContractMapper",null,[1261]);class Bc extends Sys.EventArgs{constructor(qa){super();this.zj=qa}}Object(k.a)(Bc,"PaneClosedEventArgs",
Sys.EventArgs,[]);var qe=d(190);class qg{constructor(qa,hb,Gb,pc,vd,zd,xe,le){this.ia=qa;this.Oc=hb;this.Hc=Gb;this.zEe=pc;this.gJb=vd;this.GHb=zd;this.iIe=xe;this.rUk=le;this.Se=0;this.Oc.execute(Dg=>{Dg.lOc(Object(na.a)(this,this.MLa,"onPaneClosed"))})}get state(){return this.Se}Gzd(qa){this.Se!==qa&&(this.Se=qa,this.Hc.Gz(new qe.a(1)))}xrh(qa){0===this.state&&(ue.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",qa,(new Date).getTime()),this.Gzd(1),qa={},qa.BA=
ResourceStrings.L_EditorPaneTitle,qa.assetId=this.gJb.getAssetId(),qa.q7=Object(na.a)(this,this.Jkb,"onPaneRendered"),qa.nonPersistedSettings={},qa.nonPersistedSettings.IdeasEnabled=this.iIe.toString(),qa.vif=this.rUk,32!==this.ia.Ia(Hd.a.Aia,2,qa)&&(ue.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),this.Gzd(0)))}FO(qa){if(2===this.state){var hb=this.gJb.UVa();hb&&(ue.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",qa),32!==this.ia.Ia(Hd.a.Gxb,2,hb)&&ue.a.J(36966788,
375,15,"[EditorPane] Failed to close Editor pane"))}}MLa(qa,hb){2===this.state&&hb&&(qa=hb.zj)&&qa.length&&(hb=this.gJb.UVa(),hb!==qa&&hb||(ue.a.J(37626588,375,50,"[EditorPane] Pane closed"),this.zEe.wql(new Bc(qa)),this.Gzd(0),this.GHb.sessionEnd()))}Jkb(){const qa=this.gJb.UVa();1!==this.state?ue.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",qa):(ue.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",qa),
this.Gzd(2),this.GHb.WNl())}}Object(k.a)(qg,"EditorPane",null,[1263]);class Jf{constructor(qa,hb){this.type=0;this.id=null;this.type=qa;this.id=hb}static Spb(qa){return qa.id&&qa.id.toString().length&&Object(Ph.a)(Number,qa.type)?new Jf(qa.type,qa.id.toString()):null}}Object(k.a)(Jf,"Message",null,[]);var Bd=d(3);class Ld{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg,ch,$h,wj,kf,Kf,lh,sc){this.gce=new Lf.a;this.ia=qa;this.S1=hb;this.YGb=Gb;this.zQg=pc;this.T1=vd;this.y1g=zd;this.dN=xe;this.zEe=le;this.sa=
Dg;this.Noa=ch;this.$jd=$h;this.jh=wj;this.eIk=kf;this.Hc=Kf;this.kJk=lh;this.Wb=sc;this.fXc=new Lf.a(0);this.fXc.add(0,2001);this.fXc.add(1,2002);this.fXc.add(2,2003)}qb(){this.ia.pa(Hd.a.tYe,Te.a.application,Object(na.a)(this,this.Y7f,"editorPaneButtonClicked"),4);this.ia.pa(Hd.a.d0e,Te.a.application,Object(na.a)(this,this.lyh,"queryEditorPaneButton"),96);this.ia.pa(Hd.a.ail,Te.a.application,Object(na.a)(this,this.Y7f,"editorPaneButtonClicked"),4);this.ia.pa(Hd.a.e0e,Te.a.application,Object(na.a)(this,
this.lyh,"queryEditorPaneButton"),96);this.ia.pa(Hd.a.sYe,Te.a.application,Object(na.a)(this,this.Z7f,"editorPaneExtenal"),4);this.ia.pa(Hd.a.uvh,Te.a.application,Object(na.a)(this,this.Z7f,"editorPaneExtenal"),4);this.zQg.QZd(Object(na.a)(this,this.U4k,"onEditorPaneMessageReceived"));this.Noa.E9a(Object(na.a)(this,this.J2,"onSlidePresenceChanged"));this.$jd.Ak(Object(na.a)(this,this.Upa,"onSlidePropertyChanged"));this.jh.HJ(Object(na.a)(this,this.XC,"onActiveSlideChanged"));this.zEe.Wzi(Object(na.a)(this,
this.MLa,"onPaneClosed"))}Sd(){}Z7f(qa,hb,Gb){if(1===Gb)return 32;switch(qa){case Hd.a.sYe:this.S1.xrh(2);break;case Hd.a.uvh:this.S1.FO(2);break;default:return ue.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",qa),16}return 32}Y7f(qa,hb,Gb){if(1===Gb)return this.Wb.Hi()?32:16;switch(this.S1.state){case 0:return this.S1.xrh(1),32;case 2:return this.S1.FO(1),32;case 1:return ue.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Hc.Gz(new qe.a(1)),
32;default:return ue.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}lyh(qa,hb,Gb,pc,vd){if(!vd||!Object(Ph.a)(li.a,vd))return 8;vd.Rf(2===this.S1.state||1===this.S1.state);return 32}U4k(qa,hb){this.V4k(hb)}V4k(qa){const hb=this.T1.taj(qa.message);if(hb){var Gb;({value:Gb}=this.y1g.Eg(hb.type)).returnValue||(Gb=this.y1g.ga(0));var pc=Gb.process(qa,hb);pc.continueWith(()=>{const vd=pc.result,zd=this.T1.H8f(vd);this.sendMessage(qa.zj,zd);this.$Ak(qa,hb,vd)})}else ue.a.J(37025985,
375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Bd.Task.ju(!1)}e1e(qa){this.gce.Ib(qa)||this.gce.$(qa,this.kJk.K7d(200,()=>{const hb=this.YGb.hOj(qa);if(hb.length){var Gb=new Jf(this.fXc.ga(qa),Ic.a.create().toString());Gb=this.T1.H8f(Gb);this.KMl(hb,Gb)}this.eIk.d1e(qa)}));this.gce.ga(qa).perform()}KMl(qa,hb){for(const Gb of qa)this.sendMessage(Gb,hb)}sendMessage(qa,hb){this.zQg.sendMessage(qa,hb)}$Ak(qa,hb,Gb){const pc=new Date,vd=+pc-+qa.GAh;2E3<=vd&&ue.a.J(39331167,
375,1E4<=vd?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",qa.zj,qa.Hve,qa.GAh.toUTCString(),pc.getTime(),vd.toString(),hb.id,hb.type,Gb.id,Gb.type)}Upa(qa,hb){hb.property===Ag.a.isSlideCritiqueReady&&this.e1e(1)}XC(){this.e1e(0)}J2(qa,hb){(qa=this.sa.Aa)&&hb.slideId.equals(qa.Fb)&&this.e1e(2)}MLa(qa,hb){this.YGb.vgm(hb.zj);
this.dN.visualizeCritiques([])}}Object(k.a)(Ld,"EditorPaneActor",null,[]);class sd{constructor(){this.ua=new ad.a}Wzi(qa){this.ua.addHandler("PaneClosed",qa)}wql(qa){this.ua.raiseEvent("PaneClosed",qa)}}Object(k.a)(sd,"EditorPaneEventSource",null,[1264,1323,1324]);var qd=d(4);class Kd{}Object(k.a)(Kd,"Paragraph",null,[]);var Gk=d(215);class of{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg){this.sa=qa;this.bE=hb;this.jZa=Gb;this.ia=pc;this.Ga=vd;this.sQk=zd;this.MDe=xe;this.Uh=le;this.JLk=Dg}checkProofingDirty(qa){const hb=
qa.includedTags;if(2===qa.critiqueSelection&&1===hb)return qa=(qa=this.sa.Aa)&&qa.isConnected?!qa.isSlideCritiqueReady:!0,this.Cwa(0,!0),qa;this.$Kg("CheckProofingDirty");return!0}getCritiques(qa){var hb=qa.includedTags;if(2===qa.critiqueSelection&&1===hb){qa=this.sa.Aa;if(!qa||!qa.isConnected||!qa.isSlideCritiqueReady)return null;hb=qa.UNa;qa=[];for(const Gb of hb)if((hb=Gb)&&hb.isConnected){hb=this.bE.KG(hb,pc=>{pc=Object(F.a)(419,pc.Rh);return!!pc&&5===pc.proofingType&&!pc.aHa});for(const pc of hb)(hb=
Object(F.a)(419,pc.Rh))&&qa.push(hb.KO)}this.Cwa(1,!0);return this.MDe.p_f(qa,Object(na.a)(this.MDe,this.MDe.W_i,"convertBox4Critique"))}this.$Kg("GetCritiques");return null}ymg(qa){var hb=this.sa.Aa;if(!hb||!hb.isConnected)return null;const Gb=[];qa=of.s_k(qa);hb=hb.pea;for(const pc of qa)(qa=Object(F.a)(bf.a,hb.Ie(Ic.a.Tf(pc))))&&qa.isConnected&&Gb.push(Object.assign(new Kd,{paragraphId:pc,text:this.Uh.Z3e(qa,"\n")}));return Gb}getSupportedLanguages(qa){return this.sQk.jyj(qa.includedTags).CWR(hb=>
{const Gb=[];if(hb=Object(F.a)(qd.a,hb)){hb=hb.result;for(const pc of hb)(hb=$e.a.Oe(pc))&&Array.add(Gb,hb.name)}this.Cwa(6,!0);return Gb})}getLanguagesOnCurrentSlide(){const qa=[],hb=[],Gb=this.sa.Aa;let pc=[];Gb&&(pc=Gb.yj());for(const vd of pc)this.Ga.lH(vd,zd=>{if(zd&&Object(Ph.a)($g.AParagraphNode,zd)){zd=Object(F.a)($g.AParagraphNode,zd);var xe=zd.characterData;if(xe&&xe.length){var le=-1,Dg;for(xe=0;xe<zd.Sa.length;xe++)if(Dg=zd.Sa.ga(xe).formatting)Dg=Fg.a.language(Dg),le===Dg||Array.contains(qa,
Dg)||(Array.add(qa,Dg),(le=$e.a.Oe(Dg))&&Array.add(hb,le.name)),le=Dg}}});this.Cwa(7,!0);return hb}visualizeCritiques(qa){if(!qa)return this.Cwa(2,!1),1;const hb=Array(qa.length);if(!qa.length)return this.jZa.c4c(hb),this.Cwa(2,!0),0;for(let Gb=0;Gb<qa.length;Gb++)hb[Gb]=qa[Gb].critiqueId;this.jZa.c4c(hb);this.Cwa(2,!0);return 0}resolveCritiques(qa){if(!qa||!qa.length)return 1;const hb=new Lf.a(0);for(const Gb of qa)hb.add(Gb.critiqueId,Gb.suggestionIndex);qa=this.jZa.cXh(hb);this.Cwa(3,qa);return qa?
0:1}ignoreCritiques(qa){if(!qa||!qa.length)return 1;const hb=[];for(const Gb of qa)Array.add(hb,Gb.critiqueId);qa=this.jZa.ignoreCritiques(hb,4);this.Cwa(4,qa);return qa?0:1}openProofingSettingsDialog(){if(this.JLk){const qa=this.ia.nb(Lb.a.FMb,2);this.Cwa(5,32===qa)}}Cwa(qa,hb){ue.a.J(508692640,375,50,"{0}: {1}",qa,hb?0:1)}$Kg(qa){ue.a.J(508692639,375,15,"{0}: Unsupported CritiqueFilter",qa)}static s_k(qa){const hb=new Gk.a;for(var Gb of qa)hb.contains(Gb.paragraphId)||hb.add(Gb.paragraphId);qa=
Array(hb.count);Gb=0;for(const pc of hb)qa[Gb++]=pc;return qa}}Object(k.a)(of,"EditorPaneHost",null,[1260]);class om{}Object(k.a)(om,"EditorRuntimeNotificationData",null,[]);class mi extends Sys.EventArgs{constructor(){super();this.F8b=this.Vma=null}}Object(k.a)(mi,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class Oe{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(k.a)(Oe,"InfraredResultBase",null,[]);var Ol=d(345),
pm=d(536);class tk{constructor(qa,hb){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=qa;this.includedTags=hb}static jJ(qa){return Object(Ph.a)(Number,qa.critiqueSelection)&&Object(Ph.a)(Number,qa.includedTags)?new tk(qa.critiqueSelection,qa.includedTags):null}}Object(k.a)(tk,"CritiqueFilter",null,[]);class Oj{constructor(qa,hb,Gb,pc){this.ia=qa;this.dN=hb;this.sa=Gb;this.BQg=pc}d1e(qa){if(this.BQg){var hb=new tk(2,1),Gb=this.dN.checkProofingDirty(hb),pc=Gb?[]:this.dN.getCritiques(hb),
vd=Gb?[]:this.dN.ymg(pc);hb=this.WSe();qa=Object.assign(new om,{isProofingDirty:Gb,critiques:pc,paragraphs:vd,numberOfCoAuthors:hb,contextChanged:0===qa});vd=(pc=!!pc&&0<pc.length)?1:0;let zd=Ol.a.success;0<hb?zd=Ol.a.qLa:Gb?zd=Ol.a.pending:pc||(zd=Ol.a.qLa);Gb=Object.assign(new mi,{Vma:Object.assign(new Oe,{notificationConfidence:vd,shouldRaiseNotification:!1,confidence:1,resultStatus:zd}),F8b:qa});this.BQg.d1e(Gb)}}WSe(){var qa=this.sa.Aa;if(!qa||!qa.isConnected)return 0;qa=Object.assign(new pm.a,
{slideId:qa.Fb});this.ia.Ia(Hd.a.f2a,2,qa);return qa.dzc}}Object(k.a)(Oj,"EditorRuntimeEventRaiser",null,[1259]);var yk=d(553),bm=d(716);class Hk{constructor(qa){this.sKk=qa}WNl(){this.e3a(0,0)}sessionEnd(){this.e3a(1,0)}Z6l(){this.e3a(2,4)}$6l(){this.e3a(2,3)}e3a(qa,hb){this.sKk.execute(Gb=>{const pc=Object.assign(new bm.a,{cardId:yk.a.W7f,actionType:qa,actionEngagement:hb});Gb.Lnd(pc)})}}Object(k.a)(Hk,"InfraredTelemetryLogger",null,[1262]);class Af extends Jf{constructor(qa,hb,Gb){super(qa,hb);
this.payload=null;this.payload=Gb}}Object(k.a)(Af,"MessageWithPayload",Jf,[]);class rg extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}}Object(k.a)(rg,"CheckProofingDirtyAndGetCritiquesResponse",Af,[]);class Li extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}}Object(k.a)(Li,"ResponseMessage",Af,[]);class Vf{constructor(qa){this.statusCode=0;this.logErrorMessage=null;this.statusCode=qa;this.logErrorMessage="";0!==qa&&(this.logErrorMessage=qa.toString())}}Object(k.a)(Vf,"Response",null,[]);class Ej extends Vf{constructor(qa,
hb,Gb,pc){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=qa;this.critiques=hb;this.paragraphs=Gb;this.languagesOnTheCurrentSlide=pc}}Object(k.a)(Ej,"ProofingDirtyAndCritiques",Vf,[]);class Tj{constructor(qa,hb,Gb){this.sa=qa;this.dN=hb;this.T1=Gb}process(qa,hb){var Gb=this.T1.y9i(qa.message);if(!Gb)return ue.a.J(508692509,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),qa=new Vf(1),Bd.Task.ju(new Li(1003,
hb.id,qa));qa=this.sa.Aa;if(!qa||!qa.isConnected)return ue.a.J(508692508,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),qa=new Ej(!1,[],[],[]),hb=new rg(1003,hb.id,qa),Bd.Task.ju(hb);Gb=(qa=this.dN.checkProofingDirty(Gb.payload))?[]:this.dN.getCritiques(Gb.payload);if(!Gb)return ue.a.J(508692507,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),qa=new Vf(2),Bd.Task.ju(new Li(1003,hb.id,qa));const pc=
qa?[]:this.dN.ymg(Gb),vd=qa?[]:this.dN.getLanguagesOnCurrentSlide();if(!vd)return ue.a.J(508692506,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),qa=new Vf(7),Bd.Task.ju(new Li(1003,hb.id,qa));qa=new Ej(qa,Gb,pc,vd);hb=new rg(1003,hb.id,qa);return Bd.Task.ju(hb)}}Object(k.a)(Tj,"CheckProofingDirtyAndGetCritiquesProcessor",null,[1299]);class dj{constructor(qa,hb,Gb){this.dN=qa;this.T1=hb;this.GHb=Gb}process(qa,hb){var Gb=this.T1.A9i(qa.message);if(!Gb)return ue.a.J(37087328,
375,15,"[IgnoreProcessor] Can't decode message."),qa=new Vf(1),Bd.Task.ju(new Li(1006,hb.id,qa));Gb=this.dN.ignoreCritiques(Gb.payload);0===Gb&&qa.Hve&&this.GHb.$6l();qa=0===Gb?new Vf(0):new Vf(6);return Bd.Task.ju(new Li(1006,hb.id,qa))}}Object(k.a)(dj,"IgnoreProcessor",null,[1299]);class Pl extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}}Object(k.a)(Pl,"NumberOfCoAuthorsResponse",Af,[]);class Si extends Vf{constructor(qa){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=qa}}Object(k.a)(Si,
"NumberOfCoAuthorsModel",Vf,[]);class Le{constructor(qa,hb){this.ia=qa;this.sa=hb}process(qa,hb){qa=this.WSe();qa=new Si(qa);return Bd.Task.ju(new Pl(1009,hb.id,qa))}WSe(){var qa=this.sa.Aa;if(!qa||!qa.isConnected)return 0;qa=Object.assign(new pm.a,{slideId:qa.Fb});this.ia.Ia(Hd.a.f2a,2,qa);return qa.dzc}}Object(k.a)(Le,"NumberOfCoAuthorsProcessor",null,[1299]);class uj{constructor(qa,hb,Gb){this.ia=qa;this.S1=hb;this.iIe=Gb}process(qa,hb){if(!this.iIe)return ue.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),
qa=new Vf(10),Bd.Task.ju(new Li(1011,hb.id,qa));this.S1.FO(3);qa=this.ia.nb(Hd.a.V$e,2);32!==qa&&ue.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");qa=new Vf(32!==qa?9:0);return Bd.Task.ju(new Li(1011,hb.id,qa))}}Object(k.a)(uj,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[1299]);class Tk{constructor(qa){this.dN=qa}process(qa,hb){this.dN.openProofingSettingsDialog();qa=new Vf(0);return Bd.Task.ju(new Li(1007,hb.id,qa))}}Object(k.a)(Tk,"OpenProofingSettingsProcessor",
null,[1299]);class bk{constructor(qa,hb,Gb){this.dN=qa;this.T1=hb;this.GHb=Gb}process(qa,hb){var Gb=this.T1.B9i(qa.message);if(!Gb)return ue.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),qa=new Vf(1),Bd.Task.ju(new Li(1005,hb.id,qa));Gb=this.dN.resolveCritiques(Gb.payload);0===Gb&&qa.Hve&&this.GHb.Z6l();qa=0===Gb?new Vf(0):new Vf(5);return Bd.Task.ju(new Li(1005,hb.id,qa))}}Object(k.a)(bk,"ResolveProcessor",null,[1299]);class Ql extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}}
Object(k.a)(Ql,"SubscriptionResponse",Af,[]);class lk extends Vf{constructor(qa){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=qa}}Object(k.a)(lk,"SubscriptionModel",Vf,[]);class qm{constructor(qa,hb){this.YGb=qa;this.T1=hb}process(qa,hb){const Gb=this.T1.C9i(qa.message);if(!Gb)return ue.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),qa=new Vf(1),Bd.Task.ju(new Li(1001,hb.id,qa));ue.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",Gb.payload.telemetryCorrelationId);
this.YGb.subscribe(qa.zj,0);this.YGb.subscribe(qa.zj,1);this.YGb.subscribe(qa.zj,2);qa=new lk("not available");return Bd.Task.ju(new Ql(1001,hb.id,qa))}}Object(k.a)(qm,"SubscribeProcessor",null,[1299]);class cm extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}}Object(k.a)(cm,"SupportedLanguagesResponse",Af,[]);class Uh extends Vf{constructor(qa){super(0);this.supportedLanguages=null;this.supportedLanguages=qa}}Object(k.a)(Uh,"SupportedLanguagesModel",Vf,[]);class cg{constructor(qa,hb){this.dN=qa;
this.T1=hb}process(qa,hb){qa=this.T1.D9i(qa.message);if(!qa)return ue.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),qa=new Vf(1),Bd.Task.ju(new Li(1010,hb.id,qa));const Gb=this.dN.getSupportedLanguages(qa.payload);return Gb.CWR(()=>{var pc=Gb.result;if(!pc)return ue.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),pc=new Vf(8),new Li(1010,hb.id,pc);pc=new Uh(pc);return new cm(1010,hb.id,pc)})}}Object(k.a)(cg,"SupportedLanguagesProcessor",
null,[1299]);class Pj{process(qa,hb){ue.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",hb.type);qa=new Vf(3);return Bd.Task.ju(new Li(hb.type,hb.id,qa))}}Object(k.a)(Pj,"UnsupportedMessageProcessor",null,[1299]);class Rl{constructor(qa,hb){this.dN=qa;this.T1=hb}process(qa,hb){qa=this.T1.E9i(qa.message);if(!qa)return ue.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),qa=new Vf(1),Bd.Task.ju(new Li(1004,hb.id,qa));qa=0===this.dN.visualizeCritiques(qa.payload)?
new Vf(0):new Vf(4);return Bd.Task.ju(new Li(1004,hb.id,qa))}}Object(k.a)(Rl,"VisualizeProcessor",null,[1299]);class Uk extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}static jJ(qa){const hb=Jf.Spb(qa);return hb&&qa.payload?(qa=tk.jJ(qa.payload))?new Uk(hb.type,hb.id,qa):null:null}}Object(k.a)(Uk,"CheckProofingDirtyAndGetCritiquesMessage",Af,[]);class Sl{constructor(qa){this.yWb=qa}get critiqueId(){return this.yWb}static jJ(qa){return qa.critiqueId&&Object(F.a)(String,qa.critiqueId)?new Sl(qa.critiqueId.toString()):
null}}Object(k.a)(Sl,"CritiqueIgnore",null,[]);class Ti extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}static jJ(qa){const hb=Jf.Spb(qa);if(!hb||!qa.payload||!Object(Ph.a)(Array,qa.payload))return null;qa=qa.payload;const Gb=Array(qa.length);for(let pc=0;pc<qa.length;pc++){const vd=Sl.jJ(qa[pc]);if(!Gb)return null;Gb[pc]=vd}return new Ti(hb.type,hb.id,Gb)}}Object(k.a)(Ti,"IgnoreCritiquesMessage",Af,[]);class Jg{constructor(qa,hb){this.yWb=qa;this.gpi=hb}get critiqueId(){return this.yWb}get suggestionIndex(){return this.gpi}static jJ(qa){return qa.critiqueId&&
Object(F.a)(String,qa.critiqueId)&&Object(Ph.a)(Number,qa.suggestionIndex)?new Jg(qa.critiqueId.toString(),qa.suggestionIndex):null}}Object(k.a)(Jg,"CritiqueResolution",null,[]);class Uj extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}static jJ(qa){const hb=Jf.Spb(qa);if(!hb||!qa.payload||!Object(Ph.a)(Array,qa.payload))return null;qa=qa.payload;const Gb=Array(qa.length);for(let pc=0;pc<qa.length;pc++){const vd=Jg.jJ(qa[pc]);if(!Gb)return null;Gb[pc]=vd}return new Uj(hb.type,hb.id,Gb)}}Object(k.a)(Uj,
"ResolveCritiquesMessage",Af,[]);class sl{constructor(qa){this.telemetryCorrelationId=null;this.telemetryCorrelationId=qa}static jJ(qa){let hb="unavailable";qa.telemetryCorrelationId&&Object(F.a)(String,qa.telemetryCorrelationId)&&qa.telemetryCorrelationId.toString().length&&50>=qa.telemetryCorrelationId.toString().length&&(hb=qa.telemetryCorrelationId.toString());return new sl(hb)}}Object(k.a)(sl,"Subscription",null,[]);class Bm extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}static jJ(qa){const hb=
Jf.Spb(qa);if(!hb)return null;qa.payload||(qa.payload={});return(qa=sl.jJ(qa.payload))?new Bm(hb.type,hb.id,qa):null}}Object(k.a)(Bm,"SubscribeMessage",Af,[]);class yb extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}static jJ(qa){const hb=Jf.Spb(qa);return hb&&qa.payload?(qa=tk.jJ(qa.payload))?new yb(hb.type,hb.id,qa):null:null}}Object(k.a)(yb,"SupportedLanguagesMessage",Af,[]);class zk{constructor(qa){this.yWb=qa}get critiqueId(){return this.yWb}static jJ(qa){return qa.critiqueId&&Object(F.a)(String,
qa.critiqueId)&&qa.critiqueId.toString().length?new zk(qa.critiqueId.toString()):null}}Object(k.a)(zk,"CritiqueToVisualize",null,[]);class ya extends Af{constructor(qa,hb,Gb){super(qa,hb,Gb)}static jJ(qa){const hb=Jf.Spb(qa);if(!hb||!qa.payload||!Object(Ph.a)(Array,qa.payload))return null;qa=qa.payload;const Gb=Array(qa.length);for(let pc=0;pc<qa.length;pc++){const vd=zk.jJ(qa[pc]);if(!Gb)return null;Gb[pc]=vd}return new ya(hb.type,hb.id,Gb)}}Object(k.a)(ya,"VisualizeCritiquesMessage",Af,[]);class md{taj(qa){return this.Rpb(qa,
Jf.Spb)}C9i(qa){return this.Rpb(qa,Bm.jJ)}y9i(qa){return this.Rpb(qa,Uk.jJ)}E9i(qa){return this.Rpb(qa,ya.jJ)}B9i(qa){return this.Rpb(qa,Uj.jJ)}A9i(qa){return this.Rpb(qa,Ti.jJ)}D9i(qa){return this.Rpb(qa,yb.jJ)}Rpb(qa,hb){try{let Gb;return({Ev:Gb}=m.d(qa)).returnValue?hb(Gb):null}catch(Gb){return null}}H8f(qa){return m.c(qa)}}Object(k.a)(md,"MessageEncoder",null,[1268]);var tl=d(74);class Jh extends Sys.EventArgs{constructor(qa,hb,Gb){super();this.zj=qa;this.message=hb;this.Hve=Gb;this.GAh=new Date}}
Object(k.a)(Jh,"MessageReceivedEventArgs",Sys.EventArgs,[]);class pn{constructor(qa,hb,Gb){this.ua=new ad.a;this.gJb=qa;this.hMg=hb;this.dKk=new RegExp(Gb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(na.a)(this,this.Ppc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(na.a)(this,this.Ppc,"messageReceivedHandler")),!0;ue.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(qa){ue.a.J(37026005,
375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",qa.message,qa.stack)}return!1}QZd(qa){this.ua.addHandler("MessageReceived",qa)}JDh(qa){this.ua.removeHandler("MessageReceived",qa)}sendMessage(qa,hb){if(qa&&hb){var Gb={};Gb.message=hb;Gb.editorPaneWildCard=".";this.GMl(qa,Gb)}}GMl(qa,hb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(qa,"onCustomMessage",hb,Gb=>{Gb&&ue.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",
Gb)})}Ppc(qa){const hb=qa.origin;if(this.qfc(hb)){var Gb;({Ev:Gb}=m.d(qa.data)).returnValue&&Gb&&"."===Gb.editorPaneWildCard&&Gb.message&&this.ua.raiseEvent("MessageReceived",new Jh(this.gJb.UVa(),Gb.message,hb===this.hMg))}}qfc(qa){const hb=tl.a.CR(window.location.href);return!!qa&&0<qa.length&&"null"!==qa&&(qa===this.hMg||qa===hb||this.dKk.test(qa))}}Object(k.a)(pn,"Messenger",null,[1267]);class jj{constructor(qa,hb){this.Oc=qa;this.assetId=hb.Fvh}UVa(){if(!this.Oc.instance)return ue.a.J(37025987,
375,15,"[EditorPaneManager] App for office manager not present"),null;const qa=this.Oc.instance.TO(this.assetId);return qa?qa.zj?qa.zj:(ue.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(ue.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(k.a)(jj,"PaneIdsProvider",null,[1265]);class kh{constructor(){this.Mt=new Lf.a}subscribe(qa,hb){qa&&(this.Mt.Ib(hb)||this.Mt.add(hb,[]),Array.contains(this.Mt.ga(hb),
qa)||this.Mt.ga(hb).push(qa))}unsubscribe(qa,hb){qa&&this.Mt.Ib(hb)&&(qa=Array.indexOf(this.Mt.ga(hb),qa),-1!==qa&&Array.removeAt(this.Mt.ga(hb),qa))}vgm(qa){qa&&(this.unsubscribe(qa,0),this.unsubscribe(qa,1),this.unsubscribe(qa,2))}hOj(qa){return this.Mt.Ib(qa)?this.Mt.ga(qa):[]}}Object(k.a)(kh,"EditorPaneSubscriptionsManager",null,[1266]);var ah=d(180);class Vj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}fc(qa){qa&&(this.K=qa,this.K.register(Yb,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().na(()=>
new Yb(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(1258,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().na(()=>new Jc(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(Ld,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().na(()=>new Ld(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.M4i(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),Vj.ghk&&this.K.register(ij,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().na(()=>
new ij(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),ah.a(this.K),this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(1259,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().na(()=>new Oj(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(Fi,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().na(()=>new Fi),this.K.register(1260,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().na(()=>
new of(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("299"))),
this.K.register(1261,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().na(()=>new Nd),this.K.register(1262,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().na(()=>new Hk(this.K.Ha("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(1263,"PowerPointWebEditor.EditorPane.IEditorPane").ma().na(()=>new qg(this.K.resolve("Common.IActionManagerExtended"),this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(1264,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().na(()=>new sd),this.K.register(1265,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().na(()=>new jj(this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1266,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().na(()=>new kh),this.K.register(1267,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().na(()=>new pn(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iil,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),
this.K.register(1268,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().na(()=>new md),this.K.register(Pj,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().na(()=>new Pj),this.K.register(qm,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().na(()=>new qm(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(bk,
"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().na(()=>new bk(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(dj,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().na(()=>new dj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Tk,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().na(()=>new Tk(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(Tj,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().na(()=>new Tj(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Rl,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().na(()=>new Rl(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Le,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().na(()=>new Le(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),
this.K.register(cg,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().na(()=>new cg(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(uj,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().na(()=>new uj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&
this.K.resolve("Common.IAppSettingsManager").Ue(()=>{var qa=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Vj.cYl(qa)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(qa=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),qa.qb(),qa.Sd(),qa=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),qa.qb(),qa.Sd())})}dispose(){}M4i(){const qa=new Lf.a;qa.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));
qa.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));qa.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));qa.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));qa.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));qa.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));qa.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));
qa.$(9,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));qa.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));qa.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return qa}static main(){w.a.instance.Ac(new Vj)}static cYl(qa){return qa.pptEditorConsistencyCheckIsEnabled&&Vj.vek(qa.Fvh)}static ghk(qa){return qa.h5f}static vek(qa){return!!qa&&
0<qa.length}}Object(k.a)(Vj,"PptWebEditorEditorPanePackage",null,[2,3]);class dm{constructor(qa){this.Mb=!1;this.$2d=320;this.initialize();this.ia=qa}initialize(){}dispose(){}qb(){this.ia.pa(Hd.a.xob,Te.a.application,this.xob,4)}Sd(){}xob(qa,hb,Gb){return 1===Gb?32:2===Gb?Pg.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Mb.toString(),qa,()=>{this.Mb?this.Jl():this.ur();return 32}):8}Jl(qa=!1){const hb=this.SA();this.Mb=!0;const Gb=Object.assign(new Nf.a,{title:ResourceStrings.L_DexLitePaneTitle,
hideHeader:!1,width:this.$2d,location:2,contentProps:hb,onOpen:()=>{},onClose:()=>{this.Mb=!1},isModernPane:!0});dg.UISurfaces.qr().then(pc=>{qa?pc.updateTaskPane(Ri.a.TX,Gb):pc.showTaskPane(Ri.a.TX,Gb);return null}).catch(pc=>{ue.a.J(508883089,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+pc.toString())})}ur(){this.Mb=!1;dg.UISurfaces.qr().then(qa=>{qa.hideTaskPane(Ri.a.TX,2);return null}).catch(qa=>{ue.a.J(508883088,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+
qa.toString())})}SA(){return new Ih(0,0,0,0,0,0,0,0)}}Object(k.a)(dm,"EditorPaneActor",null,[106,948]);var hg=d(554),vj=d(139);class en{constructor(qa,hb,Gb,pc,vd,zd,xe,le,Dg){this.dTf=/[\t\n\s `~!@#$%^&*-+=|:;'"<>?/]+/;this.LNi=4;this.CTf="RewriteInnerContainer";this.MNi="RewriteIndicatorView";if(!qa)throw Error.argumentNull("shapeReader");if(!hb)throw Error.argumentNull("selectionManager");if(!Gb)throw Error.argumentNull("graphTopologyManager");if(!pc)throw Error.argumentNull("pageView");if(!vd)throw Error.argumentNull("activeSlideViewManager");
if(!zd)throw Error.argumentNull("appSettings");if(!xe)throw Error.argumentNull("shapeTargetBounds");if(!le)throw Error.argumentNull("rewriteActivityLogger");if(!Dg)throw Error.argumentNull("slideReader");this.Ga=qa;this.oa=hb;this.sa=Gb;this.yb=pc;this.Jc=vd;this.oNi=zd.hYk;this.nNi=zd.tc("minWordLimitForValidBulletedConciseContent",10);this.kNi=zd.tc("minBulletLimitForValidBulletedConciseContent",7);this.pNi=zd.tc("minWordLimitForTitleSuggestions",10);this.qbh=xe;this.Knc=le;this.nc=Dg}dispose(){}get e9d(){const qa=
this.oa.Hd();return 1!=(null===qa||void 0===qa?void 0:qa.length)?new Sys.UI.Bounds(0,0,0,0):qa[0].sc(this.yb.Na).getBounds()}get U2f(){const qa=this.Jc.Ic;return qa?qa.Oy.getBoundingClientRect():new Sys.UI.Bounds(0,0,0,0)}r1c(){return this.qbh.ySi(this.e9d,this.U2f)}MEb(qa){var hb,Gb;return null===(Gb=null===(hb=this.oa.Hd()[0])||void 0===hb?void 0:hb.id)||void 0===Gb?void 0:Gb.equals(qa)}r2c(){return this.qbh.pBj(this.r1c(),this.U2f,this.e9d)}f9d(){switch(this.Ila){case hg.RewriteType.Title:return this.mLj();
case hg.RewriteType.Content:return this.pRj()}}get Ila(){var qa=this.oa.Hd();if(1==(null===qa||void 0===qa?void 0:qa.length)&&this.zFg(qa[0]))if(qa=qa[0],qa.Sk)switch(qa.mj){case 0:case 2:return hg.RewriteType.Title;case 1:case 8:return hg.RewriteType.Content}else return this.Vbm(qa)?hg.RewriteType.Title:hg.RewriteType.Content}Vbm(qa){var hb,Gb;const pc=this.nc.Uog(this.sa.Aa);if(this.Sqk(pc))for(const vd of pc)if(vd.Xu)return null!==(Gb=null===(hb=qa.id)||void 0===hb?void 0:hb.equals(vd.id))&&void 0!==
Gb?Gb:!1;return!1}zFg(qa){return qa.Sk||pb.a("EnableRewriteForTextbox")&&qa.Xu}Sqk(qa){var hb;return null!==(hb=null===qa||void 0===qa?void 0:qa.every(Gb=>!Gb.z1))&&void 0!==hb?hb:!1}get PDb(){const qa=this.oa.Hd();return 1==(null===qa||void 0===qa?void 0:qa.length)&&this.zFg(qa[0])&&void 0!=this.f9d()}get Nxe(){const qa=this.sa.Aa;return qa&&qa.yj()?qa.yj().every(hb=>hb.Sk&&this.Knk(hb.mj)||this.jmk(hb)):!1}nqk(qa){const hb=this.oa.Hd();if(1!=(null===hb||void 0===hb?void 0:hb.length))return!1;const Gb=
this.Ga.xmg(hb[0]);qa=null===qa||void 0===qa?void 0:qa.kb;const pc=this.G_f(null===qa||void 0===qa?void 0:qa.toArray());this.Sbg(pc,Gb);if(!pc||1>pc.size)return!1;let vd=!0;pc.forEach((zd,xe)=>{if(zd)if(Gb.size!=pc.size&&Gb.get(xe))vd=!1;else{var le=zd.Ra;zd=zd.Pb;Gb.size==pc.size&&0<=le&&0<=zd&&Math.abs(zd-le)<Gb.get(xe)&&(vd=!1)}else vd=!1});return vd}dik(qa){const hb=this.oa.Hd();if(1!=(null===hb||void 0===hb?void 0:hb.length))return!1;const Gb=this.Ga.xmg(hb[0]);qa=null===qa||void 0===qa?void 0:
qa.kb;qa=this.G_f(null===qa||void 0===qa?void 0:qa.toArray());this.Sbg(qa,Gb);if(!qa||Gb.size!=qa.size)return!1;let pc=!0;qa.forEach((vd,zd)=>{if(vd){var xe=vd.Ra;vd=vd.Pb;0<=xe&&0<=vd&&Math.abs(vd-xe)!=Gb.get(zd)&&(pc=!1)}else pc=!1});return pc}Sbg(qa,hb){hb.forEach((Gb,pc)=>{0==Gb&&(qa.delete(pc),hb.delete(pc))})}G_f(qa){const hb=new Map;qa.forEach(Gb=>{const pc=Gb.node;if(hb.has(pc.id)){const vd=Gb.Pb;-1!=Gb.Ra&&-1!=vd&&hb.set(pc.id,Gb)}else hb.set(pc.id,Gb)});return hb}qRj(){var qa=this.sa.Aa;
if(qa){var hb=[];qa.yj().filter(Gb=>Gb&&this.jqk(Gb)).forEach(Gb=>hb.push(this.Ga.J0c(Gb)));qa=hb.filter(Gb=>Gb&&0<Gb.length).join("\n");return this.JAg(qa,!0)?qa:void 0}ue.a.J(508692224,816,10,"Active slide node is null");this.Knc.rewriteLogActivity("RewriteActiveSlideNode",!1,0,{errorMsg:"Active slide node is null"})}aQj(){var qa;const hb=this.oa.Hd();if(1==(null===hb||void 0===hb?void 0:hb.length)&&(null===(qa=hb[0])||void 0===qa||!qa.VA))return(qa=(qa=this.Ga.J0c(hb[0]))?qa.trim():void 0)&&0<
qa.length?qa:void 0}mLj(){var qa=this.qRj();const hb=this.aQj();qa=null!==qa&&void 0!==qa?qa:hb;if(!Aa.a.Ta(qa))return{m7b:qa,inputType:hg.RewriteType.Title,Zae:[hg.RewriteSuggestionType.Concise],D$e:!1,tYh:hb}}pRj(){const qa=this.oa.Hd();if(1==(null===qa||void 0===qa?void 0:qa.length)){var hb=this.Ga.J0c(qa[0]),Gb=this.DAg(qa[0]);if(this.JAg(hb,!1)){const pc=[hg.RewriteSuggestionType.Bullet,hg.RewriteSuggestionType.Paraphrase];this.tgk(qa[0])&&pc.push(hg.RewriteSuggestionType.Concise);return{m7b:hb,
inputType:this.Ila,D$e:Gb,Zae:pc}}}}uLi(){var qa,hb;const Gb=new vj.a;Gb.va.id=this.MNi;this.Rib=new vj.a;this.Rib.va.id=this.CTf;this.Rib.xk(1);this.Rib.va.style.position="absolute";null===(hb=null===(qa=this.Jc.Ic)||void 0===qa?void 0:qa.RHl)||void 0===hb?void 0:hb.appendChild(null===Gb||void 0===Gb?void 0:Gb.va);Gb.appendChild(this.Rib)}ztj(){var qa;const hb=this.oa.Hd();if(n.AFrameworkApplication.fa.getBooleanAppSetting("RewriteViewElementImprovement")){var Gb=null===(qa=hb[0])||void 0===qa?void 0:
qa.sc(this.yb.Na);this.uLi();qa=null===Gb||void 0===Gb?void 0:Gb.Gs();Gb=document.getElementById(this.CTf);if(!qa||!Gb)return this.Rib.va;this.Rib.setPosition(qa.oc-Gb.getBoundingClientRect().width-this.LNi,qa.pc);return this.Rib.va}qa=null===(Gb=hb[0])||void 0===Gb?void 0:Gb.sc(this.yb.Na);Gb=new vj.a;Gb.va.id="RewriteIndicatorId";qa.htmlElement.appendChild(Gb.va);return Gb.va}JAg(qa,hb){if(!qa||0>=qa.length)return!1;const Gb=qa.trim().split(this.dTf);hb=hb&&pb.a("minWordLimitForTitle")?this.pNi:
this.oNi;return Gb.length>=hb||pb.a("CJKContentEligibility")&&(this.mTc(qa.trim(),"ja")>=hb||this.mTc(qa.trim(),"zh")>=hb)}mTc(qa,hb){var Gb,pc;if(!qa||!hb)return 0;let vd="\\b";"ja"===hb?vd="[\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Han}\u30fc]":"zh"===hb&&(vd="[\\p{Script=Han}]");return null!==(pc=null===(Gb=qa.match(new RegExp(vd,"gu")))||void 0===Gb?void 0:Gb.length)&&void 0!==pc?pc:0}DAg(qa){return qa&&18!==qa.w4a&&0!==qa.w4a}tgk(qa){if(!this.DAg(qa))return!0;qa=this.Ga.J0c(qa);if(!qa)return!1;
qa=qa.split("\n");if(qa.length>=this.kNi)return!0;for(const hb of qa){if(null===hb||void 0===hb||!hb.length)break;if(hb.trim().split(this.dTf).length>=this.nNi)return!0}return!1}Knk(qa){switch(qa){case 0:case 3:case 2:case 1:case 8:case 6:case 5:return!0;default:return!1}}jqk(qa){if(qa.Sk)switch(qa.mj){case 1:case 8:return!0}else if(pb.a("EnableRewriteForTextbox"))return qa.Xu;return!1}jmk(qa){return pb.a("EnableRewriteForShapesAndTextbox")?!(qa.vd||qa.Lq||qa.ig):qa.isGif||qa.$j||2==qa.mediaType||
1==qa.mediaType}}Object(k.a)(en,"RewriteSelectionManager",null,[1326]);var M=d(385),ck=d(944);class wf{constructor(){this.completion=new Promise((qa,hb)=>{this.resolve=qa;this.reject=hb})}}Object(k.a)(wf,"ControlledPromise",null,[]);class fn{constructor(qa,hb){this.Jaf=new Map;this.isInitialized=!1;if(!qa)throw Error.argumentNull("pptAugLoopRuntimeManager");if(!hb)throw Error.argumentNull("currentShapeSelectionStore");this.VP=qa;this.FC=hb}initialize(){this.isInitialized||(this.VP.execute(qa=>{qa.aM(hg.RewriteAnswer.getTypeName());
qa.Z2(hg.RewriteAnswer.getTypeName(),this.OZj.bind(this))}),this.isInitialized=!0)}sZc(qa){return Object(da.b)(this,void 0,void 0,function*(){this.initialize();return yield this.Vsj(qa.m7b,qa.inputType,qa.Zae,this.kKj(qa))})}kKj(qa){return Object(pb.a)("SendPrevSuggestionsToAL")&&(null===qa||void 0===qa?void 0:qa.inputType)==hg.RewriteType.Title?{title:this.bQj(qa)}:{concise:this.lxj(qa),bullet:{},paraphrase:this.QHj(qa)}}lxj(qa){return{makeBullet:qa.D$e}}QHj(qa){return{makeBullet:qa.D$e,prevSuggestions:Object(pb.a)("SendPrevSuggestionsToAL")?
this.FC.Ymg(hg.RewriteSuggestionType.Paraphrase):void 0}}bQj(qa){const hb=this.FC.Ymg(hg.RewriteSuggestionType.Title);(null===qa||void 0===qa?0:qa.tYh)&&hb.push(qa.tYh);return{prevTitles:hb}}Vsj(qa,hb,Gb,pc){return Object(da.b)(this,void 0,void 0,function*(){const vd=Ic.a.create().toString(),zd=this.y1i(vd,qa,hb,Gb,pc,this.FC.Cyj(Gb));this.VP.execute(le=>{le.submitOperation(zd.operation)});const xe=new wf;this.Jaf.set(vd,xe);return xe.completion})}y1i(qa,hb,Gb,pc,vd,zd){hb=new hg.RewriteSignal({input:hb,
modelType:Gb,requestedSuggestionTypes:pc,modelParams:vd,regenSequence:zd});qa=new ck.a({parentPath:[M.a.getTypeName(),Vb.a.getTypeNameFor(hb)],items:[{id:qa,body:hb}]});return Object.assign(new Ca.a,{operation:qa})}MVk(qa){return{rewriteSuggestions:qa.suggestions.map(hb=>({text:hb.content,type:hb.type})),statusCode:qa.status}}OZj(qa){if(qa){var hb=this.KMj(qa.parentPath),Gb=this.Jaf.get(hb);Gb&&(this.Jaf.delete(hb),Gb.resolve(this.MVk(qa)))}}KMj(qa){return qa[2]}}Object(k.a)(fn,"RewriteSuggestionGenerator",
null,[1327]);var rm=d(183),pj=d(96),ul=d(122),eg=d(194),ni=d(94),wc=d(67),kj=d(389),$c=d(983),jg=d.n($c);class mk{constructor(qa){this.cjc=qa}bSb(qa,hb,Gb){const pc=this.YGj(hb,qa);this.showDialog(pc,qa,hb,Gb)}showDialog(qa,hb,Gb,pc){function vd(xe){ue.a.J(508847713,811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",xe,Gb,hb);pc&&pc(xe,Gb)}const zd=this.nr;dg.UISurfaces.$0c().then(xe=>{xe.initializeFeedbackModal(qa,vd,zd)})}nr(qa){ue.a.J(508847712,811,10,"Error in submitting feedback: "+
qa)}YGj(qa,hb=!1){var Gb={};n.AFrameworkApplication.fa.M2b(Gb);Gb=this.cjc.getContext(Gb)||{};Gb.uiType="Modal";Gb.screenshot=!0;Gb.showEmailAddress=!0;hb?Gb.initialFeedbackType="Smile":(Gb.scenarioConfig={isScenarioEnabled:!0,scenarioType:"ResponsibleAI"},Gb.initialFeedbackType="Frown");hb=Gb.telemetryGroup||{};hb.processSessionId=Gb.sessionId;hb.officeBuild=Gb.build;hb.featureArea=qa;Gb.telemetryGroup=hb;return Gb}}Object(k.a)(mk,"RewriteFeedback",null,[]);var Kh=d(88);class Yg{constructor(qa,hb,
Gb,pc,vd,zd,xe,le,Dg,ch,$h,wj,kf,Kf){this.fNi="<li>";this.eNi="</li>";this.GV=this.toa=!0;this.QHl=()=>{if(this.toa)return 8;this.mHh(void 0);return 32};this.nHh=lh=>Object(da.b)(this,void 0,void 0,function*(){if(lh.keyCode===rm.a.Mp){lh.stopPropagation();lh.preventDefault();const sc=document.activeElement;sc&&(pj.FocusManager.dr(sc),sc.click())}else lh.keyCode===rm.a.GBa&&(lh.stopPropagation(),lh.preventDefault(),yield this.bzb())});this.onShapeSelected=()=>Object(da.b)(this,void 0,void 0,function*(){this.toa&&
this.GV||this.yJg();this.FC.reset();this.toa||(yield this.tUa());this.GV||(yield this.bzb());(!pb.a("EnableSlideContentValidation")||this.Lv.Nxe)&&this.Lv.PDb&&(yield this.RRh())});this.Oha=()=>Object(da.b)(this,void 0,void 0,function*(){this.toa&&this.GV||this.yJg();this.FC.reset();this.toa||(yield this.tUa());this.GV||(yield this.bzb())});this.oE=(lh,sc)=>Object(da.b)(this,void 0,void 0,function*(){if(sc&&sc.RF){var uf=pb.a("EnableSlideContentValidation")?this.Lv.Nxe:!0,Ak=pb.a("RewriteShapeSelectionIssueFixes")?
this.Lv.nqk(sc.wl):this.Lv.dik(sc.wl);uf&&this.Lv.PDb&&Ak?this.GV&&(yield this.onShapeSelected(lh,sc)):yield this.Oha(lh,sc)}});this.oHh=(lh,sc)=>Object(da.b)(this,void 0,void 0,function*(){const uf=pb.a("EnableSlideContentValidation")?this.Lv.Nxe:!0;sc.Eaf&&uf&&this.Lv.PDb?yield this.RRh():sc.Eaf||(this.GV||(yield this.bzb()),yield this.tUa())});this.tu=()=>Object(da.b)(this,void 0,void 0,function*(){this.toa||(yield this.tUa())});this.iQ=lh=>Object(da.b)(this,void 0,void 0,function*(){if(this.BJa=
lh)this.toa||(yield this.tUa()),this.GV||(yield this.bzb())});this.mHh=lh=>Object(da.b)(this,void 0,void 0,function*(){var sc;const uf=performance.now();null===lh||void 0===lh?void 0:lh.stopPropagation();yield this.tUa();const Ak=this.Lv.Ila;this.FC.N6e=Ak;this.FC.b3a=null===(sc=this.gb.Hd()[0])||void 0===sc?void 0:sc.id;yield this.baf();var oi=yield this.yfg();yield this.DCb();if(this.Lv.MEb(this.FC.b3a)){sc=null===oi||void 0===oi?void 0:oi.statusCode;oi=this.yag(oi);var sg=hg.RewriteCompletionStatus.Success===
sc&&0<(null===oi||void 0===oi?void 0:oi.length);sg?(yield this.xaf(oi,void 0),this.a2h(oi),Kh.c(Hd.a.twd,!0,void 0,0,30,performance.now()-uf,{currentSelectionType:Ak,showSuggestionCard:sg,generatedSuggestionType:this.qag(oi)})):(ue.a.J(508866837,816,10,"No suggestions returned for selected shape with status code: ${statusCode}"),Kh.c(Hd.a.twd,!1,void 0,0,30,performance.now()-uf,{errorMsg:"No suggestions returned for selected shape with status code: ${statusCode}"}),yield this.Jyc(sc))}});this.onLayerMounted=
()=>Object(da.b)(this,void 0,void 0,function*(){const lh=document.getElementById("RewriteSuggestionsBodyId");lh&&(pj.FocusManager.dr(lh),this.Iui())});this.onLikeSuggestionClicked=lh=>{if(this.iah)try{this.iah.bSb(lh,"Copilot Rewrite",null),Kh.c(Hd.a.q5e,!0,void 0,0,30,0,{isFeedbackTypeLiked:lh})}catch(sc){ue.a.J(508851866,811,10,"Copilot Rewrite: Feedback dialog failed to open with error={0}; isLikeDialog={1}",sc.toString(),lh),Kh.c(Hd.a.q5e,!1,void 0,0,30,0,{errorMsg:"Copilot Rewrite: Feedback dialog failed to open with error=${e.toString()}; isLikeDialog=${isLikeClicked}"})}else ue.a.J(508851867,
811,10,"Copilot Chat: ActionAIFeedback is received as null"),Kh.c(Hd.a.q5e,!1,void 0,0,30,0,{errorMsg:"Copilot Chat: ActionAIFeedback is received as null"})};this.cPf=lh=>Object(da.b)(this,void 0,void 0,function*(){var sc=performance.now();const uf=this.Lv.Ila,Ak=this.FC.Tbd;this.GV||(yield this.bzb());var oi=lh.suggestionText;oi.startsWith('"')&&(oi=oi.replace(/(^")|("$)/g,""));oi=jg.a.sanitize(oi);if(pb.a("EnableReplaceTextJsonCmd")){var sg=this.gb.Hd();if(1!=(null===sg||void 0===sg?void 0:sg.length)){ue.a.J(508846176,
816,10,"Selected Shape Not Found");this.Knc.rewriteLogActivity("ShapeSelectionError",!1,0,{errorMsg:"Selected Shape Not Found"});return}oi={id:sg[0].get_sid(),type:1,cId:sg[0].get_cid(),shapeId:sg[0].get_shapeId(),text:oi,textFormat:1,removeBullet:pb.a("FixBulletToParaTextInRewrite")&&!this.hrk(oi)};pb.a("RewriteUseUpdatedApplyJOfcCommands")?JSON.parse(yield this.jS.applyJOfcCommands(JSON.stringify([{data:oi,name:"ReplaceTextCmd"}]),"","","","RewriteActor")).FSuccess||(ue.a.J(508834818,816,10,"Rewrite:: JOFC command execution failed"),
Kh.c(Hd.a.p5e,!1,void 0,0,30,performance.now()-sc,{errorMsg:"Rewrite:: JOFC command execution failed"}),yield this.Jyc(hg.RewriteCompletionStatus.Unknown)):(yield this.jS.D$f(JSON.stringify(oi),"ReplaceTextCmd"))||(ue.a.J(508846175,816,10,"Rewrite:: JOFC command execution failed"),Kh.c(Hd.a.p5e,!1,void 0,0,30,performance.now()-sc,{errorMsg:"Rewrite:: JOFC command execution failed"}),yield this.Jyc(hg.RewriteCompletionStatus.Unknown))}else sg=new kj.a,sg.qob=!0,sg.AW=oi,this.ia.Ia(Hd.a.bqa,2,sg);Kh.c(Hd.a.p5e,
!0,void 0,0,30,performance.now()-sc,{currentSelectionType:uf,appliedSuggestionType:lh.suggestionType,visitedSuggestions:Ak});pb.a("DeselectShapesOnReplace")&&(sc=this.gb.Hd())&&this.gb.Kea(sc)});this.tvl=lh=>Object(da.b)(this,void 0,void 0,function*(){const sc=performance.now();yield this.tUa();yield this.baf();var uf=yield this.svl(lh);yield this.DCb();if(this.Lv.MEb(this.FC.b3a)){uf=null===uf||void 0===uf?void 0:uf.statusCode;var Ak=this.FC.Eyj(),oi=hg.RewriteCompletionStatus.Success===uf&&0<(null===
Ak||void 0===Ak?void 0:Ak.length);oi?yield this.xaf(Ak,lh):(ue.a.J(508866836,816,10,"No suggestions returned for selected type: ${currentSuggestionType} with status code: ${statusCode}"),Kh.c(Hd.a.uwd,!1,void 0,0,30,performance.now()-sc,{errorMsg:"No suggestions returned for selected type: ${currentSuggestionType} with status code: ${statusCode}"}),yield this.Jyc(uf));Kh.c(Hd.a.uwd,!0,void 0,0,30,performance.now()-sc,{currentSelectionType:this.Lv.Ila,showSuggestionCard:oi,generatedSuggestionTypes:lh.toString()})}});
this.FHl=lh=>Object(da.b)(this,void 0,void 0,function*(){null===lh||void 0===lh?void 0:lh.stopPropagation();const sc=performance.now();yield this.tUa();yield this.baf();var uf=yield this.yfg();yield this.DCb();if(this.Lv.MEb(this.FC.b3a)){var Ak=null===uf||void 0===uf?void 0:uf.statusCode;uf=this.yag(uf);var oi=hg.RewriteCompletionStatus.Success===Ak&&0<(null===uf||void 0===uf?void 0:uf.length);oi?(yield this.xaf(uf,void 0),this.a2h(uf)):(ue.a.J(508827721,816,10,"No suggestions returned for selected shape with status code: ${statusCode} on retry"),
Kh.c(Hd.a.uwd,!1,void 0,0,30,performance.now()-sc,{errorMsg:"No suggestions returned for selected shape with status code: ${statusCode} on retry"}),yield this.Jyc(Ak));Kh.c(Hd.a.uwd,!0,void 0,0,30,performance.now()-sc,{currentSelectionType:this.Lv.Ila,showSuggestionCard:oi,generatedSuggestionTypes:this.qag(uf)})}});this.S_k=lh=>{this.FC.U2b(lh)};if(!qa)throw Error.argumentNull("actionManager");if(!hb)throw Error.argumentNull("graphOperationEventSource");if(!Gb)throw Error.argumentNull("viewElementEventSource");
if(!pc)throw Error.argumentNull("rewriteSelectionManager");if(!vd)throw Error.argumentNull("rewriteSuggestionGenerator");if(!zd)throw Error.argumentNull("pptSelectionManager");if(!xe)throw Error.argumentNull("viewEventNotifier");if(!le)throw Error.argumentNull("customerFeedbackUiWrapper");if(!Dg)throw Error.argumentNull("copilotProxy");if(!ch)throw Error.argumentNull("appFrame");if(!$h)throw Error.argumentNull("coreEventHandler");if(!wj)throw Error.argumentNull("currentShapeSelectionStore");if(!kf)throw Error.argumentNull("rewriteActivityLogger");
if(!Kf)throw Error.argumentNull("focusManager");this.tq=hb;this.Pw=Gb;this.Lv=pc;this.jah=vd;this.ia=qa;this.gb=zd;this.ue=xe;this.iah=new mk(le);this.wic=this.eak();this.jS=Dg;this.Db=ch;this.Nc=$h;this.FC=wj;this.Knc=kf;this.Fa=Kf}qb(){this.tq.o_d(this.onShapeSelected);this.tq.pMf(this.Oha);this.Pw.zvb(this.Oha);this.gb.AG(this.oE);this.ue.gBi(this.oHh);n.AFrameworkApplication.za.v9(this.tu);this.Db.cEa(this.iQ);this.Nc.yOc(this.Oha);this.Nc.aC(this.Oha);pb.a("RewriteIndicatorShortcutRegister")&&
this.ia.pa(Hd.a.twd,Te.a.application,this.QHl,4)}dispose(){this.tq.B3e(this.onShapeSelected);this.tq.xEh(this.Oha);this.Pw.Pvc(this.Oha);this.gb.Xza(this.oE);this.ue.RCl(this.oHh);this.Db.Cmb(this.iQ);this.Nc.z3e(this.Oha);this.Nc.F7(this.Oha)}Sd(){if(pb.a("RewriteIndicatorShortcutRegister")){const qa=this.Fa.Kc(ul.AFrame.Nj);null===qa||void 0===qa?void 0:qa.bindAction(eg.KeyInputManager.Va(rm.a.mVb,1|eg.KeyInputManager.Ze),Hd.a.twd)}}Iui(){this.$Ch();ni.a.addHandler(document.getElementById("RewriteSuggestionsBodyId"),
wc.a.Vf,this.nHh)}$Ch(){ni.a.removeHandler(document.getElementById("RewriteSuggestionsBodyId"),wc.a.Vf,this.nHh)}eak(){const qa=document.createElement("div");qa.id="RewriteCardId";document.body.appendChild(qa);return qa}RRh(){return Object(da.b)(this,void 0,void 0,function*(){if(this.toa&&!this.BJa&&1!==this.Db.mode){this.toa=!1;var qa={onRewriteIndicatorClick:this.mHh,getTargetRect:n.AFrameworkApplication.fa.getBooleanAppSetting("RewriteViewElementImprovement")?void 0:this.Lv.e9d,isIndicatorHidden:!1,
targetPlaceholderType:this.Lv.Ila};yield(yield dg.UISurfaces.fcb()).renderContextualCard("RewriteIndicator",this.qKk=this.Lv.ztj(),qa);this.Knc.rewriteLogActivity("RewriteIndicatorCardShown",!0)}})}tUa(){var qa,hb;return Object(da.b)(this,void 0,void 0,function*(){this.toa=!0;(yield dg.UISurfaces.fcb()).dispose(this.qKk);n.AFrameworkApplication.fa.getBooleanAppSetting("RewriteViewElementImprovement")?null===(qa=document.getElementById("RewriteIndicatorView"))||void 0===qa?void 0:qa.remove():null===
(hb=document.getElementById("RewriteIndicatorId"))||void 0===hb?void 0:hb.remove()})}xaf(qa,hb){return Object(da.b)(this,void 0,void 0,function*(){this.GV||(yield this.DCb());if(this.Lv.MEb(this.FC.b3a)){var Gb={getTargetRect:this.Lv.r2c(),placeholderOverflow:this.Lv.r1c(),rewriteCardState:1,isCardHidden:!1,rewriteSuggestions:qa,suggestionCount:qa.length,targetPlaceholderType:this.Lv.Ila,currentRegeneratedSuggestionType:hb,onReplaceSuggestionClicked:this.cPf,onRegenerateSuggestionsClicked:this.tvl,
onLikeSuggestionClicked:this.onLikeSuggestionClicked,onNextSuggestionClicked:this.S_k,onLayerMounted:this.onLayerMounted};yield(yield dg.UISurfaces.fcb()).renderContextualCard("RewriteContextualCard",this.wic,Gb);this.GV=!1}})}Jyc(qa){return Object(da.b)(this,void 0,void 0,function*(){this.GV||(yield this.DCb());if(this.Lv.MEb(this.FC.b3a)){var hb={placeholderOverflow:this.Lv.r1c(),targetPlaceholderType:this.Lv.Ila,getTargetRect:this.Lv.r2c(),rewriteCardState:2,isCardHidden:!1,rewriteErrorState:this.x0i(qa),
onRetryButtonClicked:this.FHl,onLayerMounted:this.onLayerMounted};yield(yield dg.UISurfaces.fcb()).renderContextualCard("RewriteContextualCard",this.wic,hb);this.GV=!1;Kh.a("ErrorContextualCardShown",!0)}})}baf(){return Object(da.b)(this,void 0,void 0,function*(){this.GV||(yield this.DCb());if(this.Lv.MEb(this.FC.b3a)){var qa={placeholderOverflow:this.Lv.r1c(),getTargetRect:this.Lv.r2c(),targetPlaceholderType:this.Lv.Ila,rewriteCardState:0,isCardHidden:!1,onLayerMounted:this.onLayerMounted};yield(yield dg.UISurfaces.fcb()).renderContextualCard("RewriteContextualCard",
this.wic,qa);this.GV=!1;Kh.a("LoadingContextualCardShown",!0)}})}DCb(){return Object(da.b)(this,void 0,void 0,function*(){const qa={getTargetRect:this.Lv.r2c(),isCardHidden:!0};yield(yield dg.UISurfaces.fcb()).renderContextualCard("RewriteContextualCard",this.wic,qa);this.GV=!0})}bzb(){return Object(da.b)(this,void 0,void 0,function*(){this.$Ch();(yield dg.UISurfaces.fcb()).dispose(this.wic);this.GV=!0})}yfg(){return Object(da.b)(this,void 0,void 0,function*(){var qa=this.Lv.f9d();if(null!==qa&&void 0!==
qa&&qa.m7b)return qa=yield this.jah.sZc(qa),this.FC.Z1h(qa),qa;ue.a.J(508870787,816,50,"Ineligible shape selection for ALRewrite");this.Knc.rewriteLogActivity("ShapeSelectionError",!1,0,{errorMsg:"Ineligible shape selection for ALRewrite"})})}svl(qa){return Object(da.b)(this,void 0,void 0,function*(){var hb=this.Lv.f9d();if(null!==hb&&void 0!==hb&&hb.m7b){var Gb=this.ntj(qa);if(!(0>=Gb.length))return this.FC.S7j(Gb[0]),hb.Zae=Gb,hb=yield this.jah.sZc(hb),this.FC.Z1h(hb),hb}else ue.a.J(508823500,816,
50,"Ineligible shape selection for ALRewrite")})}ntj(qa){switch(qa){case 0:return[hg.RewriteSuggestionType.Bullet];case 1:return[hg.RewriteSuggestionType.Concise];case 2:return[hg.RewriteSuggestionType.Paraphrase];case 3:return[hg.RewriteSuggestionType.Title];default:return[]}}yag(qa){var hb;const Gb=[];null===(hb=null===qa||void 0===qa?void 0:qa.rewriteSuggestions)||void 0===hb?void 0:hb.filter(pc=>!!pc.text).forEach(pc=>{Gb.push({suggestionText:pc.text,suggestionType:pc.type})});return Gb}x0i(qa){switch(qa){case hg.RewriteCompletionStatus.OffensiveContentInput:case hg.RewriteCompletionStatus.OffensiveContentOutput:return 0;
case hg.RewriteCompletionStatus.UnsupportedLanguage:return 2;default:return 1}}qag(qa){const hb=[];qa.forEach(Gb=>{hb.push(Gb.suggestionType)});return hb.join(",")}yJg(){Kh.c(Hd.a.PHl,!0,void 0,0,30,void 0,{currentSelectionType:this.FC.N6e,visitedSuggestions:this.FC.Tbd,isRewriteIndicatorDisposed:!this.toa,isRewriteContextualCardDisposed:!this.GV})}a2h(qa){qa=new Set(qa.map(hb=>hb.suggestionType));qa.has(3)?this.FC.U2b(3):qa.has(0)?this.FC.U2b(0):qa.has(1)?this.FC.U2b(1):this.FC.U2b(2)}hrk(qa){return qa.includes(this.fNi)&&
qa.includes(this.eNi)}}Object(k.a)(Yg,"RewriteActor",null,[948]);class em{constructor(){this.zgd=24}ySi(qa,hb){const Gb={isPlaceholderOverflowing:!1,overflowDirection:void 0};qa&&hb&&(qa.y+qa.height>=hb.height+hb.y&&(Gb.isPlaceholderOverflowing=!0,Gb.overflowDirection=0),qa.x<hb.x&&(Gb.isPlaceholderOverflowing=!0,Gb.overflowDirection=1),qa.y+qa.height>=hb.height+hb.y&&qa.x<hb.x&&(Gb.overflowDirection=2));return Gb}pBj(qa,hb,Gb){const pc=new Sys.UI.Bounds(0,0,0,0);if(qa.isPlaceholderOverflowing){switch(qa.overflowDirection){case 0:pc.x=
Gb.x;pc.width=Gb.width;pc.y=hb.y;pc.height=hb.height;break;case 1:pc.x=hb.x+this.zgd;pc.width=hb.width-this.zgd;pc.y=Gb.y;pc.height=Gb.height;break;case 2:pc.x=hb.x+this.zgd,pc.width=hb.width-this.zgd,pc.y=hb.y,pc.height=hb.height}return pc}return Gb}}Object(k.a)(em,"ShapeTargetBounds",null,[1325]);class sh{constructor(qa){this.mpc=[];this.wTf=0;this.bSk=qa}get window(){return this.mpc}Oui(qa){this.mpc[this.wTf%this.bSk]=qa;this.wTf++}}Object(k.a)(sh,"SuggestionWindow",null,[]);class Vk{constructor(qa){this.KDe=
new Map;this.Tbd=new Set;this.nnc=new Map;this.rNe=this.nDe=this.uCe=0;this.uSk=qa}Eyj(){const qa=[];this.KDe.forEach((hb,Gb)=>{(null===hb||void 0===hb?0:hb.text)&&qa.push({suggestionText:hb.text,suggestionType:Gb})});return qa}Z1h(qa){var hb;0<(null===(hb=null===qa||void 0===qa?void 0:qa.rewriteSuggestions)||void 0===hb?void 0:hb.length)&&qa.rewriteSuggestions.forEach(Gb=>{this.KDe.set(Gb.type,Gb);Object(pb.a)("SendPrevSuggestionsToAL")&&this.Nwi(Gb)})}U2b(qa){this.Tbd.add(qa)}get b3a(){return this.EOg}set b3a(qa){this.EOg=
qa}get N6e(){return this.FOg}set N6e(qa){this.FOg=qa}Ymg(qa){return(qa=this.nnc.get(qa))?Array.from(qa.window):[]}Nwi(qa){this.nnc.has(qa.type)||this.nnc.set(qa.type,new sh(this.uSk));this.nnc.get(qa.type).Oui(qa.text)}Cyj(qa){if(1!=qa.length)return 0;switch(qa[0]){case hg.RewriteSuggestionType.Bullet:return this.uCe;case hg.RewriteSuggestionType.Concise:return this.nDe;case hg.RewriteSuggestionType.Paraphrase:return this.rNe;default:return 0}}S7j(qa){switch(qa){case hg.RewriteSuggestionType.Bullet:this.uCe++;
break;case hg.RewriteSuggestionType.Concise:this.nDe++;break;case hg.RewriteSuggestionType.Paraphrase:this.rNe++}}reset(){this.KDe.clear();this.Tbd.clear();this.nnc.clear();this.rNe=this.nDe=this.uCe=0;this.FOg=this.EOg=null}}Object(k.a)(Vk,"CurrentShapeSelectionStore",null,[]);var vl=d(109);class gl{rewriteLogActivity(qa,hb,Gb=0,pc=null){const vd=[];if(pc)for(const [zd,xe]of Object.entries(pc))this.A9a(zd,xe,vd);Kh.a(qa,hb,Gb,vd)}A9a(qa,hb,Gb){Gb.push(Object.assign(new vl.a,{name:qa,string:hb}))}}
Object(k.a)(gl,"RewriteActivityLogger",null,[1298]);class lj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.CopilotRewrite"}fc(qa){if(qa){this.K=qa;var hb=this.K.resolve("PowerPointWebEditor.IApplicationSettings");hb.$7f&&this.K.register(dm,"PowerPointWebEditor.CopilotRewrite.EditorPaneActor").ma().na(()=>new dm(this.K.resolve("Common.IActionManagerExtended")));this.Mue(this.K)&&(this.K.register(Vk,"PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore").ma().na(()=>new Vk(hb.tc("RewritePrevSuggestionWindowSize",
3))),this.K.register(gl,"PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger").ma().na(()=>new gl),this.K.register(en,"PowerPointWebEditor.CopilotRewrite.RewriteSelectionManager").as("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager").ma().na(()=>new en(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),hb,this.K.resolve("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds"),this.K.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger"),this.K.resolve("PowerPointWebEditor.ISlideReader"))),this.K.register(em,"PowerPointWebEditor.CopilotRewrite.ShapeTargetBounds").as("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds").ma().na(()=>new em),this.K.register(fn,"PowerPointWebEditor.CopilotRewrite.RewriteSuggestionGenerator").as("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator").ma().na(()=>
new fn(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore"))),this.K.register(Yg,"PowerPointWebEditor.CopilotRewrite.RewriteActor").ma().na(()=>new Yg(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager"),
this.K.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.K.resolve("PowerPointWebEditor.ICopilotProxy"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore"),
this.K.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger"),this.K.resolve("PowerPointWebEditor.IFocusManager"))))}else ue.a.J(508883090,822,10,"PptWebEditorRewritePackage::Container object not available")}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").Ue(()=>{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").$7f){var qa=this.K.resolve("PowerPointWebEditor.CopilotRewrite.EditorPaneActor");qa.qb();qa.Sd()}this.Mue(this.K)&&(qa=this.K.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor"),
qa.qb(),qa.Sd())})}dispose(){this.K.resolve("Common.IAppSettingsManager").Ue(()=>{this.Mue(this.K)&&this.K.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor").dispose()})}Mue(qa){qa=qa.resolve("PowerPointWebEditor.IApplicationSettings");return!(n.AFrameworkApplication.cD||n.AFrameworkApplication.Tw)&&(qa.r5e||qa.getBooleanAppSetting("RewriteFeatureLicenseCheckEnabled")&&n.AFrameworkApplication.$Sc)}static main(){w.a.instance.Ac(new lj)}}Object(k.a)(lj,"PptWebEditorRewritePackage",null,[2,3]);
var Ij=d(13);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");
Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.EditorPaneV2");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Object(Ij.d)("AugLoop");pf.main();fg.main();Pe.main();Vj.main();lj.main();Object(Ij.c)("AugLoop")},554:function(L,V,d){var k=this&&this.WGd||(Object.create?function(n,r,w,D){void 0===D&&(D=w);var y=Object.getOwnPropertyDescriptor(r,w);if(!y||("get"in y?!r.q8:y.writable||y.configurable))y={enumerable:!0,get:function(){return r[w]}};
Object.defineProperty(n,D,y)}:function(n,r,w,D){void 0===D&&(D=w);n[D]=r[w]}),e=this&&this.__exportStar||function(n,r){for(var w in n)"default"===w||Object.prototype.hasOwnProperty.call(r,w)||k(r,n,w)};Object.defineProperty(V,"__esModule",{value:!0});e(d(1195),V);e(d(1196),V);e(d(1197),V);e(d(1198),V)},702:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(18),e=d(99),n=d(28),r=d(49);d(98);class w{constructor(){this.d1=null}get FCb(){return!1}zZh(D,y){let m=new k.a;const C=new r.GraphTransaction(3);
try{C.rd(n.App.Ob.ie.yo.Zg),this.xgc(y)&&(m=this.Zdc(y,m)),y!==D&&this.xgc(D)&&(m=this.Zdc(D,m))}finally{C&&C.dispose()}return m.toArray()}xgc(D){return!!D}Zud(D){let y=!1;for(const m of this.poe)y||!Sys.UI.DomElement.containsCssClass(D,m.className)&&!Sys.UI.DomElement.containsCssClass(D,m.acc)||(y=!0),e.a.SMa(D,m.className),e.a.SMa(D,m.acc)}}Object(L.a)(w,"AHighlightActor",null,[1358])},703:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.className=e;this.acc=
n}}Object(L.a)(k,"HighlightCssClassPair",null,[])},704:function(L,V,d){d.d(V,"b",function(){return r});d.d(V,"a",function(){return w});var k=d(99);d(28);var e=d(49);d(33);d(95);var n=d(98);const r=D=>{const y=new e.GraphTransaction(3);try{y.rd(D),D.Dw(32,!0)}finally{y&&y.dispose()}},w=D=>{if(D){D=k.a.sma(D);if(-1===D.indexOf(n.a.M9)&&-1!==D.indexOf(n.a.AO)&&-1===D.indexOf(n.a.i7b))return 2;if(-1===D.indexOf(n.a.M9)&&(-1!==D.indexOf(n.a.h7b)||-1!==D.indexOf(n.a.OO)||-1!==D.indexOf(n.a.i7b)||-1!==D.indexOf(n.a.wSc)||
-1!==D.indexOf(n.a.pUc)||-1!==D.indexOf(n.a.nUc)||-1!==D.indexOf(n.a.mUc)||-1!==D.indexOf(n.a.U8d)||-1!==D.indexOf(n.a.P8d)||-1!==D.indexOf(n.a.R8d)||-1!==D.indexOf(n.a.oUc)||-1!==D.indexOf(n.a.O8d)))return 1;if(-1!==D.indexOf("WACImageContainer"))return 3}return 0}},705:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.type=this.action=0;this.Klb=this.Ffa=null}}Object(L.a)(k,"HighlightOperation",null,[])},708:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);
var k=d(18);class e{static TBh(n){e.Ycc.add(n)}static CKh(n){for(const r of e.Ycc)r(n)}static dCh(n){e.nnb.add(n);if(0<e.IMa.count){for(const r of e.IMa)n(r);e.IMa=new k.a}}static KKh(n){if(0<e.nnb.count)for(const r of e.nnb)r(n);else e.IMa.add(n)}}e.IMa=new k.a;e.nnb=new k.a;e.Ycc=new k.a;Object(L.a)(e,"AugLoopEventUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.augloop.js.map
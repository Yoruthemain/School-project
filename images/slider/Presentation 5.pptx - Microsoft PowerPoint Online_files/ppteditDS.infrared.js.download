'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1316:function(L,V,d){d.r(V);L=d(0);var k=d(68),e=d(27),n=d(181),r=d(51),w=d(29);class D{constructor(da,Ba){this.ia=da;this.ia.pa(w.a.v6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.w6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.x6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.y6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.z6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.A6j,
r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.B6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.g6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.h6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.i6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.j6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.k6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.l6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.m6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.f6j,
r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.n6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.o6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.q6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.r6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.s6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.t6j,r.a.application,n.ActionManager.vw,4);this.ia.pa(w.a.u6j,r.a.application,n.ActionManager.vw,4);this.LOg=JSON.parse(Ba.Ea("674"));for(const za of this.LOg)za.regex=
new RegExp(za.pattern)}trackAction(da){for(const Ba of this.LOg)Ba.regex.test(da)&&this.ia.nb(Ba.actionId,2)}}Object(L.a)(D,"IdeasActionTracker",null,[1359]);class y{constructor(){this.fhb=this.vPe=this.yOe=null;this.Wjk=this.LDm}addSlideSuggestionsListener(da){this.yOe=da}addTextToSmartArtSuggestionListener(da){this.vPe=da}dZd(da){this.fhb=da}notifySlideSuggestion(da,Ba){this.yOe&&(this.yOe(da,Ba),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",Ba?Ba.suggestions.length:0,Ba?Ba.correlationId:
"0"))}notifyTextToSmartArtSuggestion(da,Ba){this.vPe&&(this.vPe(da,Ba),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",Ba?Ba.suggestions.length:0,Ba?Ba.correlationId:"0"))}Lnd(da){this.fhb&&this.fhb(da)}}Object(L.a)(y,"InfraredDesignerServiceProvider",null,[1329]);class m{constructor(){this.fhb=null}dZd(da){this.fhb=da}Lnd(da){this.fhb&&this.fhb(da)}}Object(L.a)(m,"InfraredTelemetryListener",null,[1328]);var C=d(197),E=d(1061),F=d(46),B=d(7),H=d(35);class K{}Object(L.a)(K,"EntityGroup",
null,[]);class A extends K{}Object(L.a)(A,"Idea",K,[]);var W=d(553);class N{}Object(L.a)(N,"ProviderResult",null,[]);var P=d(345),U=d(447),Q=d(446),G=d(344),Y=d(552),ba=d(25),ha=d(276);class ka{}ka.Whl="PowerPoint";ka.gom="WAC";Object(L.a)(ka,"ApplicationPropertiesConstants",null,[]);class ca{}Object(L.a)(ca,"EnterpriseUserInfo",null,[]);class ia{}Object(L.a)(ia,"Message",null,[]);class oa extends ia{}oa.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(L.a)(oa,"PowerPointTextTileChangedMessage",
ia,[]);class sa{}Object(L.a)(sa,"RankerConfiguration",null,[]);class Ca{constructor(da){this.Dfh=da}qtj(da,Ba){return new Promise((za,Aa)=>{this.Dfh&&da&&Ba||Aa("wopiIdentityManager or tokenParameter or clientWoipId is null");this.Dfh.getAccessToken(da,Ba).then(na=>{na?za(na.accessToken):Aa("auth token is null")},na=>{Aa(na)})})}}Object(L.a)(Ca,"AuthenticationProvider",null,[1334]);class Ta{constructor(da,Ba,za,Aa,na=""){this.resource=da;this.scope=Ba;this.silentLogin=za;this.options=Aa;this.correlationId=
na}}Object(L.a)(Ta,"InfraredTokenParameters",null,[920]);class R{constructor(da,Ba,za,Aa,na,la,va,Pa,Qa){this.LUg=this.dCe=this.Tuf=null;this.uUg=!1;this.HKe=null;this.hOe=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.gKb=da;this.cKk=va;this.hIe=Qa;this.TMk=da.getBooleanAppSetting("659");this.pKb=da.Ea("750");va=window.location.hostname;Qa=da.Ea("816");va&&0<va.length&&Qa&&0<Qa.length&&0<=Qa.toLowerCase().indexOf(va.toLowerCase())&&(this.pKb="");this.MZa=Ba;this.xjc=
la;if(this.XUk=da.getBooleanAppSetting("688"))this.LUg=da.Ea("689"),this.dCe=new Ca(Pa);this.MZa.addSlideSuggestionsListener(Object(B.a)(this,this.i$k,"onSlideSuggestion"));this.MZa.addTextToSmartArtSuggestionListener(Object(B.a)(this,this.K$k,"onTextToSmartArtSuggestion"));this.MZa.dZd(Object(B.a)(this,this.nnh,"onIdeasSessionTelemetry"));za.dZd(Object(B.a)(this,this.nnh,"onIdeasSessionTelemetry"));this.xjc&&this.xjc.execute(Ua=>{Ua.ILf(Object(B.a)(this,this.qUe,"onEditorCritiques"))});this.ia=Aa;
(this.tV=na)&&this.tV.execute(Ua=>{Ua.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new Q.a,{name:"InfraredSlideTextTileLambda",inputSchema:U.a.ezc,outputSchema:U.a.ezc,func:(Ya,Ea,La)=>{this.j$k(Ya);La(null)}}))});this.MVl()}get LCb(){return this.Tuf}MVl(){var da=JSON.parse(this.gKb.Ea("612"));da=Object.assign(new sa,{rankingOrder:da});var Ba=IdeasInfraredConnector,za=Ba.setup,Aa=e.a.J,na=Object(B.a)(this,this.C6j,"ideasPaneVisibilityStatusCallback"),la=this.gKb;const va=
{};va.appName=2===ba.AFrameworkApplication.za.mb.Ej?ka.Whl:"unknown";va.appVersion=ba.AFrameworkApplication.buildVersion;va.appPlatform=ka.gom;va.lcid=ba.AFrameworkApplication.lcid;var Pa=ha.a.Oe(ba.AFrameworkApplication.lcid);Pa=Pa?Pa.name:null;const Qa=Pa.split("-");va.market=Qa[Qa.length-1];va.uiLanguage=Pa;va.sessionId=ba.AFrameworkApplication.userSessionId;va.tenantRoot=la.Ea("748");va.shredderServiceEndpoint=la.Ea("749");this.Tuf=za.call(Ba,da,Aa,na,va,this.cKk,Object(B.a)(this,this.xog,"getShredderServiceAuthTokenPromise"))}C6j(da){this.uUg=
da;(this.MZa.Wjk=da)?(this.ia.nb(w.a.z9b,2),this.axh()):this.ia.Ia(w.a.Aqa,2,new Y.a(!0,G.a.Loe))}i$k(da,Ba){const za=[];za.push(Object.assign(new A,{providerId:W.a.cTh,groupTypeId:W.a.bTh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ba}));try{this.LCb.pushProviderResult(Object.assign(new N,{providerId:W.a.cTh,resultStatus:da,entityGroups:za}))}catch(Aa){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Aa)}"Success"===da&&(C.a.Ta(Ba.suggestions)||this.hIe.ADd(0))}K$k(da,Ba){const za=[];za.push(Object.assign(new A,{providerId:W.a.mTh,groupTypeId:W.a.lTh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ba}));try{this.LCb.pushProviderResult(Object.assign(new N,{providerId:W.a.mTh,resultStatus:da,entityGroups:za}))}catch(Aa){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Aa)}}nnh(da){try{this.LCb.trackIdeasProviderAction(da.cardId,
da.actionType,da.actionEngagement)}catch(Ba){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",Ba)}}j$k(da){if(this.TMk)if(da)if(da){try{const Ba=H.a(da.Content);this.YGi(this.HKe,Ba)&&(this.HKe=Ba,this.hOe=!0)}catch(Ba){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.uUg&&this.axh()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}YGi(da,
Ba){if(!da&&Ba||da&&!Ba)return!0;if(!da&&!Ba)return!1;if(!da.drawingElems&&Ba.drawingElems||da.drawingElems&&!Ba.drawingElems)return!0;const za=new E.a;for(const Aa of da.drawingElems)if(da=Aa.text)for(const na of da.paragraphs)na&&(F.a.Ta(na.id)||F.a.Ta(na.chars)||za.$(na.id,na.chars));for(const Aa of Ba.drawingElems)if(Ba=Aa.text)for(const na of Ba.paragraphs)if(na&&!(F.a.Ta(na.id)||F.a.Ta(na.chars)||za.Ib(na.id)&&za.ga(na.id)===na.chars))return!0;return!1}axh(){if(this.hOe){try{this.LCb.postMessage(Object.assign(new oa,
{messageType:oa.PowerPointTextTileChangedMessageType,data:this.HKe}))}catch(da){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",da)}this.hIe.ADd(1);this.hOe=!1}}qUe(da,Ba){try{da=[],da.push(Object.assign(new A,{groupTypeId:W.a.W7f,providerId:W.a.c8f,notificationConfidence:Ba.Vma?Ba.Vma.notificationConfidence:0,shouldRaiseNotification:Ba.Vma?Ba.Vma.shouldRaiseNotification:!1,confidence:Ba.Vma?Ba.Vma.confidence:0,data:Ba.F8b})),this.LCb.pushProviderResult(Object.assign(new N,
{providerId:W.a.c8f,resultStatus:Ba.Vma?Ba.Vma.resultStatus:P.a.invalid,entityGroups:da}))}catch(za){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",za)}Ba.Vma&&"Success"===Ba.Vma.resultStatus&&Ba.F8b&&!C.a.Ta(Ba.F8b.critiques)&&this.hIe.ADd(2)}xog(){if(!this.dCe)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.pKb&&0<this.pKb.length)return this.dCe.qtj(new Ta(this.pKb,"user_impersonation",!0,
{}),this.LUg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(da){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",da),null}}NAj(){return new Promise(da=>{const Ba=this.gKb.Ea("749"),za=this.xog();Ba&&Ba.length&&za?za.then(Aa=>{Aa&&Aa.length?(Aa=new ca,Aa.CountryCode="US",Aa.IsEnabled=!1,Aa.IsEnterpriseEnabled=!0,Aa.IsGoLocal=!1,Aa.ServiceEndpoint=Ba,Aa.TenantRoot="",da(Aa)):da(null)},()=>{da(null)}):
da(null)})}}Object(L.a)(R,"PPTWebEditorInfraredRuntimeManager",null,[1297]);class Ha{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}fc(da){this.K=da;this.K.register(y,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().na(()=>new y);this.K.register(m,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().na(()=>new m);this.K.register(D,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().na(()=>
new D(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(R,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().na(()=>new R(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ha("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const da=this.K.resolve("Common.IAppSettingsManager");da.Ue(()=>{da.getBooleanAppSetting("610")&&(e.a.J(512262811,
809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){k.a.instance.Ac(new Ha)}}Object(L.a)(Ha,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");Ha.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.infrared.js.map
/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';function xR(L){function V(k){return L.next(k)}function d(k){return L.throw(k)}return new Promise(function(k,e){function n(r){r.done?k(r.value):Promise.resolve(r.value).then(V,d).then(n,e)}n(L.next())})}
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1E3:function(L,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return n});var k=d(42);const e=(r,w)=>{w[r.$a(k.a.kPc)]=r.$a(k.a.lPc)},n=r=>1074135139===r.hf},1001:function(L,V,d){d.d(V,"a",function(){return y});L=d(0);var k=d(1273),e=d(1298),n=d(90),r=d(32),w=d(33),D=d(233);class y{constructor(m,C,E){this.rV=m;this.oa=C;this.Ga=E;if(!m)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!C)throw Error.argumentNull("m_selectionManager");
if(!E)throw Error.argumentNull("m_shapeReader");this.rV&&this.rV.execute(F=>{this.Oc=F})}nPj(m){if(!m.hasText)return null;const C=this.Ga.Phe(m).cache;let E;switch(C.Yw){case 0:E="None";break;case 1:E="Single";break;case 2:E="Double";break;case 3:E="Heavy";break;case 4:E="Dotted";break;case 5:E="DottedHeavy";break;case 6:E="Dash";break;case 7:E="DashHeavy";break;case 8:E="DashLong";break;case 9:E="DashLongHeavy";break;case 10:E="DotDash";break;case 11:E="DotDashHeavy";break;case 12:E="DotDotDash";
break;case 13:E="DotDotDashHeavy";break;case 14:E="Wavy";break;case 15:E="WavyHeavy";break;case 16:E="WavyDouble";break;default:E="None"}var F=m.aA()[0],B=new r.GraphIterator;B.set(F);B.uc(11);B.Ug(11);B=(B=F.eg.Aw(B))?1===B.listType:!1;switch(w.ParagraphReader.zM(F)){case 1:F="Left";break;case 2:F="Center";break;case 3:F="Right";break;case 7:F="Distributed";break;case 6:F="Justify";break;default:F="Left"}return{text:m.u$(),color:n.a.WH(C.fontColor),bold:C.isBold,italic:C.isItalic,underline:E,fontName:C.tM,
size:C.fontSize/2,bulleted:B,horizontalAlignment:F}}ZLj(m,C){const E=m.get_shapeTypeString(),F=m.shapeName;var B=m.gD;const H=k.a.Ve(B._x,e.a.horizontal);B=k.a.Ve(B._y,e.a.vertical);var K=m.ZS;const A=K.BottomRight.Y-K.TopLeft.Y;K=K.BottomRight.X-K.TopLeft.X;var W=D.a.parse(m.$qa);const N=W?W.RGBColor:"";W=W?W.Alpha:-1;let P;switch(m.JN){case 0:P="Dash";break;case 1:P="DashDot";break;case 2:P="DashDotDot";break;case 3:P="LongDash";break;case 4:P="LongDashDot";break;case 5:P="RoundDot";break;case 6:P=
"Solid";break;case 7:P="SquareDot";break;case 8:P="LongDashDotDot";break;case 9:P="SystemDash";break;case 10:P="SystemDot";break;case 11:P="SystemDashDot";break;default:P="None"}const U=m.outlineWidth;var Q=D.a.parse(m.xia);const G=Q?Q.RGBColor:"";Q=Q?Q.Alpha:-1;m=this.nPj(m);return{index:C,textRange:m,type:E,name:F,left:H,top:B,height:A,width:K,lineColor:N,lineDashStyle:P,lineWeight:U,lineTransparency:W,fillColor:G,fillTransparency:Q}}UMj(m){const C={index:0,shapes:[]};m=m.yj();for(let E=0;E<m.length;E++)C.shapes.push(this.ZLj(m[E],
E));return C}Ige(){if(!this.Oc)throw Error("Cannot create contextTree without valid AppForOfficeManager instance.");const m={slides:[],selectionNames:[]};m.slides.push(this.UMj(this.Oc.$O.Aa));const C=this.oa.Hd();for(const E of C)m.selectionNames.push(E.shapeName);return m}}Object(L.a)(y,"ODSLContext",null,[1271])},1002:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(46),e=d(94),n=d(27),r=d(30);class w{constructor(D){this.npa=null;this.amc=0;this.Wjc=D;switch(this.Wjc){case "audio":this.npa=
w.uUk;this.amc=w.nGk;break;case "captions":this.npa=w.vUk;this.amc=w.EGk;break;case "video":this.npa=w.wUk;this.amc=w.EUk;break;default:n.a.J(509727835,822,10,"Invalid file type")}}static set Gmm(D){w.wUk=D}static set Bnm(D){w.EUk=D}aSi(D){switch(this.Wjc){case "audio":return w.ZRi(D);case "captions":return w.$Ri(D);case "video":return r.a("DisableVideoAsFileCheck")?new Promise(y=>{y(!0)}):w.bSi(D);default:return n.a.J(509727834,822,10,"Invalid file type"),new Promise(y=>{y(!1)})}}Umm(D){D=k.a.Dg(D);
for(let y=0;y<this.npa.length;++y){const m=this.npa[y];if(m&&0<m.length&&D.endsWith(m))return!0}return!1}Vmm(D){return D<=1048576*this.amc}static ZRi(D){return new Promise((y,m)=>{if(D&&D.size){var C=document.createElement("video"),E=URL.createObjectURL(D);C.setAttribute("src",E);e.a.addHandler(C,"loadedmetadata",()=>{URL.revokeObjectURL(E);const F=C.videoHeight,B=C.videoWidth;0<C.duration&&!F&&!B?y(!0):(n.a.J(509727832,822,10,"Invalid audio File"),y(!1))});e.a.addHandler(C,"error",()=>{URL.revokeObjectURL(E);
n.a.J(509727831,822,10,"Invalid audio File");m(ResourceStrings.L_InvalidAudioFileError)})}else n.a.J(509727833,822,10,"Empty media File"),y(!1)})}static $Ri(D){return new Promise((y,m)=>{if(D&&D.size){var C=URL.createObjectURL(D),E=document.createElement("video"),F=document.createElement("track");E.appendChild(F);e.a.addHandler(F,"load",()=>{URL.revokeObjectURL(C);y(!0)});e.a.addHandler(F,"error",()=>{URL.revokeObjectURL(C);n.a.J(509727829,822,10,"Invalid captions File");m(ResourceStrings.l_InvalidCaptionsFileError)});
F.setAttribute("src",C);F.setAttribute("default","true")}else n.a.J(509727830,822,10,"Empty captions File"),y(!1)})}static bSi(D){return new Promise((y,m)=>{if(D&&D.size){var C=document.createElement("video"),E=URL.createObjectURL(D);C.setAttribute("src",E);e.a.addHandler(C,"loadedmetadata",()=>{URL.revokeObjectURL(E);const F=C.videoHeight,B=C.videoWidth;0<C.duration&&0<F&&0<B?y(!0):(n.a.J(509727837,822,10,"Invalid video File"),y(!1))});e.a.addHandler(C,"error",()=>{URL.revokeObjectURL(E);n.a.J(509727836,
822,10,"Invalid video File");m(ResourceStrings.L_InvalidVideoFileError)})}else n.a.J(509727838,822,10,"Empty media File"),y(!1)})}static uhe(D){if(!D||!D.value)return"Input file name is null";const y=D.value.lastIndexOf(".");return-1===y?"":D.value.substring(y+1,y+5)}}w.nGk=16;w.EGk=16;w.vUk=[".vtt"];w.uUk=[".mp3",".wav",".m4a",".aac",".oga"];Object(L.a)(w,"MediaValidationHelper",null,[])},1003:function(L,V,d){d.d(V,"a",function(){return k});const k=e=>{if((e=e.tc("AugLoopEndpointOverride",0))&&!(1>
e))return{[1]:"https://augloop-test.officeppe.com",[2]:"https://augloop-int.officeppe.com",[3]:"https://augloop-dogfood.officeppe.com",[4]:"https://augloop.office.com",[5]:"http://localhost:20080"}[e]}},1004:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.Dag=e}}Object(L.a)(k,"CommentContainersChangedEventArgs",Sys.EventArgs,[])},1005:function(L,V,d){d.d(V,"a",function(){return m});L=d(0);var k=d(1264),e=d(7),n=d(88),r=d(36),w=d(27),
D=d(701),y=d(120);class m{constructor(C,E,F,B,H,K){this.OSd=this.gcd=null;this.xz=Object(k.a)(D.a,B.a2f(C,E,F,Object(e.a)(this,this.FN,"onPointerOver"),Object(e.a)(this,this.hH,"onPointerOut"),H));this.thd=0;this.Nc=K;this.Nc.aC(Object(e.a)(this,this.KF,"onSessionEnd"));this.clear()}dispose(){this.xz.dispose();this.gcd=null}get A1a(){return this.OSd}setZIndex(C){this.xz.setZIndex(C)}Qvi(C,E,F){this.OSd=C;this.gcd=E;this.xz.aMh("UnreadNotification_16x16x32",this.A1a,F)}clear(){this.xz.clear();this.OSd=
y.a.none}Q3a(){this.Efa();this.xz.K2b(this.A1a,this.bae);this.xz.XQe()}Efa(){this.xz.N4d();this.xz.W4e()}KF(){w.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.thd);0<this.thd&&n.c(r.a.uVf)}get bae(){return this.gcd?this.gcd():""}FN(){this.Q3a();w.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.thd+=1;return!0}hH(){this.Efa();return!0}}Object(L.a)(m,"ShapeRevisionTrackingPawn",null,[723])},1006:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=
d(70);class e{constructor(n){this.wHb=this.ikc=null;this.Ye=n}dispose(){this.clear();this.ikc.parentNode.removeChild(this.ikc)}fTa(n){this.ikc=this.x0f(n,"prContainerHr");this.wHb=this.x0f(this.ikc,"prGlyph")}clear(){this.t2a()}xNa(n,r){n&&(this.t2a(),this.wHb.appendChild(n),this.wHb.style.backgroundColor=r,this.ikc.style.visibility=k.a.visible)}x0f(n,r){const w=this.Ye.we();this.Ye.addCssClass(w,r);n.appendChild(w);return w}t2a(){this.wHb.firstChild&&this.wHb.removeChild(this.wHb.firstChild)}}Object(L.a)(e,
"ShapePawnGlyph",null,[])},1041:function(L,V,d){d.r(V);L=d(0);var k=d(75),e=d(46),n=d(94),r=d(67),w=d(25),D=d(1265),y=d(7),m=d(18),C=d(86),E=d(314),F=d(27),B=d(30);class H{constructor(La){this.ApiType=0;this.ApiType=La}}Object(L.a)(H,"SlideshowApiMessage",null,[]);class K extends H{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(L.a)(K,"DockSlideshowViewMessage",H,[]);class A extends H{constructor(){super(6);this.AnimStep=this.SlideIndex=0}}Object(L.a)(A,"GoToSlideApiMessage",
H,[]);class W extends H{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(L.a)(W,"GoToSlideWithTimeLinesApiMessage",H,[]);class N extends H{constructor(){super(19);this.Color=this.Item=null}}Object(L.a)(N,"InkManagerMessage",H,[]);class P{constructor(La){this.FI=La.origin;this.ych=La.source;this.exa=La.data}}Object(L.a)(P,"MessageEvent",null,[]);var U=d(966),Q=d(964),G=d(967),Y=d(968);class ba extends Sys.EventArgs{constructor(La){super();this.egc=La.IsStartTranscription;
this.Xw=La.SubtitlesPosition}}Object(L.a)(ba,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class ha extends Sys.EventArgs{constructor(La){super();this.Qy=La.SessionTelemetry}}Object(L.a)(ha,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ka=d(971),ca=d(972),ia=d(969);class oa extends Sys.EventArgs{constructor(La,xb){super();this.hek=La;this.category=xb.Category;this.code=xb.Code;this.message=xb.Message;this.ny=xb.ExtraInfo;this.correlationId=xb.CorrelationId;this.sessionId=
xb.SessionId}}Object(L.a)(oa,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var sa=d(965);class Ca extends Sys.EventArgs{constructor(La){super();this.isFinal=La.IsFinal;this.fZh=La.Transcripts}}Object(L.a)(Ca,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ta=d(973),R=d(970);class Ha extends Sys.EventArgs{constructor(La){super();this.errorName=La.ErrorName;this.vetoName=La.VetoName;this.isIntentional=La.IsIntentional;this.isInternal=La.IsInternal;this.alertOnPillar=La.AlertOnPillar;this.isSessionEndingError=
La.IsSessionEndingError;this.durationMs=La.DurationMs}}Object(L.a)(Ha,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class da extends H{constructor(){super(11);this.StartSlideShowTime=0}}Object(L.a)(da,"RecordStartedSlideShowTimestampApiMessage",H,[]);class Ba extends H{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(L.a)(Ba,"RefreshPodSessionApiMessage",H,[]);class za extends H{constructor(){super(21);this.IsMute=!1}}Object(L.a)(za,"SetMicrophoneStateMessage",H,[]);class Aa extends H{constructor(){super(12);
this.OsfLocalStorageData=null}}Object(L.a)(Aa,"SetOsfLocalStorageApiMessage",H,[]);class na{constructor(){this.egc=this.iDg=!1;this.Xw=null}}Object(L.a)(na,"SlideShowViewDockingState",null,[]);var la=d(1044);class va extends H{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=
!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(L.a)(va,"StartSlideShowApiMessage",H,[]);class Pa extends H{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(L.a)(Pa,"ToggleTranscriberLiveBroadcastModeMessage",H,[]);class Qa extends H{constructor(){super(18);
this.HideUI=!1}}Object(L.a)(Qa,"ToggleTranscriberUIVisibilityMessage",H,[]);class Ua extends H{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(L.a)(Ua,"TranscribeApiMessage",H,[]);var Ya=d(69);d.d(V,"SlideshowFrame",function(){return Ea});class Ea{constructor(La,xb,dc,gb,gc,Ac,$b,jc){this.jb=this.u_a=this.t_a=this.rxa=null;this.ua=new k.a;this.YIa=null;
this.MOe=this.Cch=!1;this.zf=xb;this.ka=dc;this.Mc=gb;this.Zb=gc;this.vP=Ac;this.xm=$b;this.VGb=jc;this.sMk=new D.a(Object(y.a)(La,La.EJi,"browserSupportsRenderingSVGInWebGL"))}init(La,xb,dc){if(!this.jb){this.rxa=document.getElementById("HiddenFocusTrapAnchor");this.jb=document.createElement("iframe");this.jb.id="SlideShowHostFrame";this.jb.className="SlideShowHostFrame";this.jb.style.display=Ya.a.kf;this.jb.setAttribute("allow","microphone; autoplay");this.YIa=new na;dc=this.ka.isHermesSlideShowPreloadEnabled?
String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.We(ResourceStrings.l_EndOfSlideShowMessage),e.a.We(dc),e.a.We(xb)):"";dc+=String.format(dc?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.We(this.ka.hostSupportsSessionRefreshEnabled.toString()));dc+=String.format(dc?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.We(this.ka.isInkingInSlideShowEnabled.toString()));dc+=String.format(dc?"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",
e.a.We(this.ka.Ctk.toString()));dc+=String.format(dc?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.We(this.ka.Zte.toString()));dc+=String.format(dc?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",e.a.We(this.ka.lfc.toString()));dc+=String.format("&ImageCachingEnabled={0}",e.a.We(this.ka.$2l.toString()));dc+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.We(this.ka.mgl.toString()));dc+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.We(this.ka.podsLoadSlideShowFrameFromCdn.toString()));
dc+=String.format("&PodsBase={0}",e.a.We(this.ka.podsWebServiceBase));var gb=this.ka.Pba;this.ka.fYa&&(gb=new E.a(gb),gb.jCc=this.ka.fYa,gb.eyc=this.ka.HOh,gb.dyc=this.ka.GOh,gb=gb.toString());var gc=this.ka.podsLoadSlideShowFrameFromCdn&&!e.a.Ta(this.ka.podsBaseSlideShowFramePath);this.jb.src=gc?this.ka.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.jb.src=String.format(this.jb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",La,e.a.We(xb),e.a.We(this.ka.pptEditorSlideShowWrsEndpoint),
C.a.xsc,gb);F.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",gc,this.ka.vna));if(this.ka.vna||this.ka.qgc)this.jb.src=String.format(this.jb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",e.a.We(this.ka.pptEditorTranscriberJsUri),e.a.We(this.ka.pptEditorTransciberClientAudioMessageJsUri),e.a.We(this.ka.pptEditorTransciberSpeechResultMessageJsUri),e.a.We(this.ka.pptEditorSpeechHandlerBaseUri)),this.jb.src=String.format(this.jb.src+
"&SpeechResponseMessageJS={0}",e.a.We(this.ka.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.Dg(this.ka.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.jb.src=String.format(this.jb.src+"&QualityStatusMessageJS={0}",e.a.We(this.ka.pptEditorTranscriberQualityStatusMessageJsUri))),this.ka.qgc&&e.a.Dg(this.ka.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.jb.src=String.format(this.jb.src+"&RehearsalResultMessageJS={0}",
e.a.We(this.ka.pptEditorTranscriberRehearsalResultMessageJsUri))),this.ka.pptEditorTranscriberLiveAgentEnabled&&e.a.Dg(this.ka.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.jb.src=String.format(this.jb.src+"&AgentCommandMessageJS={0}",e.a.We(this.ka.pptEditorTranscriberAgentCommandMessageJsUri)));this.ka.powerPointLiveBroadcastEnabled&&(this.jb.src+="&wdLiveBroadcast=true");this.jb.src=String.format(this.jb.src+"#{0}",dc);B.a("PresenterCoachTabFix")&&this.rxa?
this.zf.insertBefore(this.jb,this.rxa):this.zf.appendChild(this.jb);n.a.addHandler(window,r.a.message,Object(y.a)(this,this.l$k,"onSlideshowMessage"));this.Mc.Qzb&&this.ka.osd&&this.$xk();B.a("PresenterCoachTabFix")&&(this.t_a=document.getElementById("legacySlideshowBeginningFocusTrap"),this.u_a=document.getElementById("legacySlideshowEndFocusTrap"),this.t_a||this.u_a||(this.t_a=document.createElement("div"),this.t_a.id="legacySlideshowBeginningFocusTrap",this.t_a.className="FocusTrap",this.t_a.tabIndex=
0,n.a.addHandler(this.t_a,r.a.focus,Object(y.a)(this,this.Grc,"onSlideShowContainerDivFocusHandler")),this.u_a=document.createElement("div"),this.u_a.id="legacySlideshowEndFocusTrap",this.u_a.className="FocusTrap",this.u_a.tabIndex=0,n.a.addHandler(this.u_a,r.a.focus,Object(y.a)(this,this.Grc,"onSlideShowContainerDivFocusHandler")),this.zf.insertBefore(this.t_a,this.zf.firstChild),this.zf.insertBefore(this.u_a,this.rxa.nextSibling)))}}qbb(){return this.ka.osd&&this.MOe}r$k(){F.a.J(512495880,830,50,
"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.Cch=!0;return null}$xk(){const La=new m.a;La.add(this.VGb.loadScript("PPTSpeechClient"));Promise.all(La.toArray()).then(()=>this.r$k()).catch(xb=>{F.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",xb)})}tBd(La,xb,dc,gb,gc,Ac,$b,jc,pb){this.YIa=new na;$b&&F.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",
jc));this.kH(Object.assign(new va,{WacCluster:dc,PodSessionId:gb,UserId:gc,WacUserSessionId:Ac,SlideId:La,SlideIndex:xb,FPrerenderSS:$b,PrerenderCid:jc,SlideShowClickTime:pb,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.sMk.value?"1":"0",RenderShapeBuilder:this.ka.fYa?"1":"0",FileHost:w.AFrameworkApplication.fa.Ea("FileHost"),VetoAppSettingsStr:this.ERj(),DisabledTransitionsList:this.ka.FOa,CustomTransitionResourceUrl:this.ka.d3f,StreamVideoUseThinEmbed:w.AFrameworkApplication.fa.getBooleanAppSetting("StreamVideoUseThinEmbed"),
DisabledChangeGates:w.AFrameworkApplication.fa.Ea("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:w.AFrameworkApplication.Wka,AllowExternalMarketplace:w.AFrameworkApplication.fa.getBooleanAppSetting("51")}))}prev(){this.kH(new H(2))}next(){this.kH(new H(1))}transcribe(La,xb,dc,gb,gc,Ac,$b){var jc=!!this.Zb&&!!this.Zb.instance&&(this.Zb.instance.cVa||this.Zb.instance.Xr);(this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.OFa||jc)&&!this.Zb.instance.Uzb()?F.a.J(512495877,830,50,
"LivePresenter prevented transcriber from starting"):this.qbb()?(la.a.instance.transcribe(La,xb,dc,gb,gc,Ac,$b),this.RVc(this.Mc.ji&&5!==gc,this.Mc.Xw)):(jc={},jc.TranslationLanguages=this.ka.powerPointLiveBroadcastEnabled?this.ka.liveBroadcastTranslationLanguagesOverride:"",jc.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.ka.powerPointLiveBroadcastEnabled?!0:!1,this.kH(Object.assign(new Ua,{SubtitlesAppSettingsStr:this.mOj(La,dc,xb,gb,gc,Ac),SubtitlesContextStr:this.Mc.U6l,SubtitlesResourceStr:this.nOj(),
RehearsalContextStr:$b?$b.gyl:"",LiveBroadcastContextStr:JSON.stringify(jc),MicrophoneDeviceId:this.vP.microphoneDeviceId})))}setMicrophoneState(La){this.qbb()?la.a.instance.setMicrophoneState(La):(this.kH(Object.assign(new za,{IsMute:La})),this.Zb&&this.Zb.instance&&(La?this.Zb.instance.zMh():this.Zb.instance.AMh()))}setCameraState(){}K1h(){}getDefaultCameraLabel(){return""}FTb(La,xb){xb=void 0===xb?"":xb;this.YIa.iDg=La;F.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");
this.qbb()?(la.a.instance.IYh(La,xb),this.RVc(this.Mc.ji,this.Mc.Xw)):this.kH(Object.assign(new Pa,{IsToggleOn:La,PragueSessionInfo:xb}));this.omh()}toggleTranscriberUIVisibility(La){F.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.qbb()?(La=La?La?!1:!0:!la.a.instance.isVisible(),la.a.instance.setVisibility(La),la.a.instance.OOc(),this.RVc(this.Mc.ji,this.Mc.Xw)):this.kH(Object.assign(new Qa,{HideUI:La}))}RVc(La,xb){this.YIa.egc=La;this.YIa.Xw=xb;this.omh()}setOsfLocalStorage(){const La=
{};let xb=!1;try{const dc=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let gb=0;gb<localStorage.length;++gb){const gc=localStorage.key(gb);if(dc.test(gc)){const Ac=localStorage.getItem(gc);La[gc]=Ac;xb=!0}}}catch(dc){F.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",dc.toString())}xb&&this.kH(Object.assign(new Aa,{OsfLocalStorageData:La}))}show(){F.a.J(512495873,830,50,"SlideShowFrame::Show Making frame visible.");if(this.jb){this.jb.style.display=Ya.a.kl;
var La=(new Date).getTime();F.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",La);this.kH(Object.assign(new da,{StartSlideShowTime:La}))}else F.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}jYa(){return this.jb&&this.jb.style.display!==Ya.a.kf?!0:!1}t5(){return"Legacy"}VAc(La){this.jb.style.display=La?Ya.a.kl:Ya.a.kf;this.qbb()&&la.a.instance.setVisibility(La&&this.Mc.ji)}nZc(){F.a.J(512495842,830,
50,"SlideShowFrame: Exiting with post message");this.kH(new H(3))}exit(){this.jb.style.display===Ya.a.kf?this.ua.raiseEvent("OnExit",new Q.a({SlideId:0,IsBeforeReady:!0})):(F.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.jb.style.display=Ya.a.kf,this.kH(new H(3)));this.qbb()&&la.a.instance.Ybf()}restoreFocus(){this.jb.style.display===Ya.a.kf||this.gve()||(this.jb.focus(),this.kH(new H(4)))}pausePresentation(){this.kH(new H(15))}Uef(){this.ua.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}getCurrentPosition(){this.kH(new H(5))}getCurrentPositionWithTimeLines(){this.kH(new H(17))}getCurrentSlideDimensions(){this.kH(new H(20))}uWa(La){this.kH(Object.assign(new A,
{SlideIndex:La,AnimStep:0}))}pYe(La){this.kH(Object.assign(new N,{Item:La.item,Color:La.color}))}a7e(La){this.ua.raiseEvent("OnSpecialKey",new sa.a({["Key"]:La.keyCode,["ShiftKey"]:La.shiftKey,["AltKey"]:La.altKey}))}JKh(){this.kH(new H(22))}rrg(La,xb){this.kH(Object.assign(new W,{SlideIndex:La,TimeLineMappings:xb}))}refreshPodSession(La,xb){this.kH(Object.assign(new Ba,{PodSessionId:La,WacCluster:xb}))}setVisibility(La){this.jb.style.visibility=La?Ya.a.AA:Ya.a.Vt}Bia(La){this.kH(new H(La?9:10));
this.qbb()&&la.a.instance.Bia(La)}qOc(La){this.ua.addHandler("OnSlideshowReady",La)}rvd(La){this.ua.removeHandler("OnSlideshowReady",La)}VZd(La){this.ua.addHandler("OnBrowserEvent",La)}l3e(La){this.ua.removeHandler("OnBrowserEvent",La)}MLf(La){this.ua.addHandler("OnFullscreenClick",La)}WDh(La){this.ua.removeHandler("OnFullscreenClick",La)}YZd(La){this.ua.addHandler("OnSlideshowContextMenu",La)}o3e(La){this.ua.removeHandler("OnSlideshowContextMenu",La)}c_d(La){this.ua.addHandler("OnPodSessionExpired",
La)}s3e(La){this.ua.removeHandler("OnPodSessionExpired",La)}ySa(La){this.ua.addHandler("OnPositionChangeEventId",La)}Dmb(La){this.ua.removeHandler("OnPositionChangeEventId",La)}Oka(La){this.ua.addHandler("OnExit",La)}jia(La){this.ua.removeHandler("OnExit",La)}JLf(La){this.ua.addHandler("OnSlideshowError",La)}TDh(La){this.ua.removeHandler("OnSlideshowError",La)}b3b(La){this.ua.addHandler("OnGetCurrentPosition",La)}Bmb(La){this.ua.removeHandler("OnGetCurrentPosition",La)}mOc(La){this.ua.addHandler("OnGetCurrentSlideDimensions",
La)}pvd(La){this.ua.removeHandler("OnGetCurrentSlideDimensions",La)}rOc(La){this.ua.addHandler("OnSpecialKey",La)}svd(La){this.ua.removeHandler("OnSpecialKey",La)}$Lf(La){this.ua.addHandler("OnVisibilityChangeEventId",La)}w3e(La){this.ua.removeHandler("OnVisibilityChangeEventId",La)}PLf(La){this.ua.addHandler("OnLogEndOfTranscriptionSession",La)}YDh(La){this.ua.removeHandler("OnLogEndOfTranscriptionSession",La)}OLf(La){this.ua.addHandler("OnLiveSubtitlesDockedViewEventId",La)}XDh(La){this.ua.removeHandler("OnLiveSubtitlesDockedViewEventId",
La)}$Zd(La){this.ua.addHandler("OnEnterEndOfShowEventId",La)}p3e(La){this.ua.removeHandler("OnEnterEndOfShowEventId",La)}b_d(La){this.ua.addHandler("OnLeaveEndOfShowEventId",La)}r3e(La){this.ua.removeHandler("OnLeaveEndOfShowEventId",La)}XLf(La){this.ua.addHandler("OnSubtitleUpdatedEventId",La)}gEh(La){this.ua.removeHandler("OnSubtitleUpdatedEventId",La)}YLf(La){this.ua.addHandler("OnTranscriberStartedEventId",La)}iEh(La){this.ua.removeHandler("OnTranscriberStartedEventId",La)}gMf(La){this.ua.addHandler("RecordQosErrorEventId",
La)}qEh(La){this.ua.removeHandler("RecordQosErrorEventId",La)}l$k(La){La=new P(La.rawEvent);if(this.ptk(La)){var xb=this.sHl(La.exa),dc=xb.EventType;28===dc&&F.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",La.exa);switch(dc){case 23:this.Jod(xb);break;case 18:this.zkb(xb);break;case 6:this.o8k();break;case 11:this.Zph(!1,xb);break;case 13:this.Zph(!0,xb);break;case 2:this.Iha(xb);break;case 7:this.Zya(xb);break;case 12:this.iza(xb);break;case 24:this.k$k(xb);
break;case 26:this.r1a(xb);break;case 27:this.Jpd(xb);break;case 29:this.ipd(xb);break;case 5:this.Lpd(xb);break;case 30:this.x$k(xb);break;case 32:this.rqd(xb);break;case 31:this.hpd(xb);break;case 19:this.God(xb);break;case 20:this.epd(xb);break;case 33:this.Fud(xb)}}}ptk(La){try{if(La.ych!==this.jb.contentWindow)return F.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",La.ych.location.href),!1}catch(xb){return F.a.J(512495838,830,
50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",xb.toString()),!1}return!0}sHl(La){try{return Sys.Serialization.JavaScriptSerializer.deserialize(La)}catch(xb){let dc=xb.toString();B.a("DisableLogPostMsgData")&&(La="<redacted>");B.a("DisableLogPostMsgEx")&&(dc="<redacted>");F.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",La,dc)}return{}}o8k(){if(this.ka.osd&&this.Cch&&
!this.MOe)try{const La=(new Date).getTime();la.a.instance.init(this.ka,this.jb.contentDocument.body,this.Mc,this,this.xm,this.Zb,this.vP);this.MOe=!0;F.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-La)}catch(La){F.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",La.toString())}F.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");this.ua.raiseEvent("OnSlideshowReady",
new Sys.EventArgs)}zkb(La){this.ua.raiseEvent("OnBrowserEvent",new U.a(La))}Jod(La){F.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");F.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.jb.style.display=Ya.a.kf;this.ua.raiseEvent("OnExit",new Q.a(La))}Iha(La){F.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.ua.raiseEvent("OnGetCurrentPosition",new G.a(La))}Zya(La){F.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");this.ua.raiseEvent("OnGetCurrentSlideDimensions",
new Y.a(La))}Zph(La,xb){this.ua.raiseEvent("OnSlideshowError",new oa(La,xb))}iza(La){La=new sa.a(La);F.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",La.key);this.ua.raiseEvent("OnSpecialKey",La)}k$k(La){F.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.ua.raiseEvent("OnSlideshowContextMenu",new ia.a(La))}r1a(La){F.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.ua.raiseEvent("OnVisibilityChangeEventId",new R.a(La))}Jpd(La){F.a.J(512495826,
830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.ua.raiseEvent("OnPodSessionExpired",new ka.a(La))}ipd(La){F.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.ua.raiseEvent("OnLogEndOfTranscriptionSession",new ha(La));this.Mc.Wzb=!1}Lpd(La){F.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.ua.raiseEvent("OnPositionChangeEventId",new ca.a(La))}x$k(La){F.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");this.ua.raiseEvent("OnSubtitleUpdatedEventId",
new Ca(La))}rqd(La){F.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.ua.raiseEvent("OnTranscriberStartedEventId",new Ta.a(La));this.Mc.Wzb=!0}Grc(){this.restoreFocus()}hpd(La){F.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const xb=new ba(La);this.RVc(xb.egc,xb.Xw);this.ua.raiseEvent("OnLiveSubtitlesDockedViewEventId",xb)}catch(xb){F.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",xb.toString())}}God(){F.a.J(512495819,
830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.ua.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}epd(){F.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.ua.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}Fud(La){F.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.ua.raiseEvent("RecordQosErrorEventId",new Ha(La))}kH(La){this.jb&&this.jb.contentWindow&&this.jb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(La),
"*")}omh(){var La=0,xb=100;this.YIa.egc&&("BelowSlide"===this.YIa.Xw?(La=0,xb=85):"AboveSlide"===this.YIa.Xw&&(La=15,xb=85));La=La.toString()+"%";xb=xb.toString()+"%";this.YIa.iDg&&(La=String.format("calc({0} + {1})",La,"26px"),xb=String.format("calc({0} - {1})",xb,"26px"));this.kH(Object.assign(new K,{TopValue:La,HeightValue:xb}))}ERj(){const La={};La.AnimTranstionMinDurationMs=w.AFrameworkApplication.fa.tc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);La.AnimTranstionWorstFrameIndex=w.AFrameworkApplication.fa.tc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);La.AnimTranstionMaxFrameDurationMs=w.AFrameworkApplication.fa.tc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);La.AnimTranstionMinFPS=w.AFrameworkApplication.fa.tc("PodSlideShowVetoAnimTranstionMinFPS",24);La.NavDurationMs=w.AFrameworkApplication.fa.tc("PodSlideShowVetoNavDurationMs",1250);La.SlideShowEUPLThresholdInMs=w.AFrameworkApplication.fa.tc("SlideShowEUPLThresholdInMs",6E3);La.SlideShowNavigationThresholdInMs=w.AFrameworkApplication.fa.tc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(La)}mOj(La,xb,dc,gb,gc,Ac){const $b=this.ka.Lil&&e.a.Dg(this.ka.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),jc={};jc.WacUserSessionId=La;jc.WacUserDatacenterCluster=xb;jc.PodSessionId=dc;jc.DocId=gb;jc.EntryPoint=gc;jc.StartTime=Ac;jc.PodsWebServiceBase=this.ka.podsWebServiceBase;jc.TranscriberLoggingIntervalInMS=this.ka.ybm;jc.TranscribeRealTimeFactorLowerThreshold=this.ka.ubm;jc.TranscribeRealTimeFactorUpperThreshold=this.ka.vbm;jc.IsTranscriberLogEachTranscriptMessage=
this.ka.wsk;jc.IsTranscriberContentLoggingEnabled=this.ka.tsk;jc.FUseEndpointInWebapp=this.ka.zsk;jc.CustomEndpointRequestTimeoutInMs=this.ka.pptEditorTransriberCustomEndpointRequestTimeoutInMs;jc.RTLLanguages=this.ka.pptEditorTranscribeRTLTranslationLanguages;jc.HeartbeatInterval=5E3;jc.RoundtripLatencyThreshold=1E6;jc.AudioSendingCountIntervalMS=this.ka.pptEditorTranscribeAudioSendingCountIntervalMS;jc.FragmentLatencyWarnThreshold=1E6;jc.FragmentLatencyErrorThreshold=1E6;jc.MessageType=this.ka.pptEditorTransciberMessageType;
jc.MaxAllowedFragmentLatencyMS=this.ka.pgl;jc.DynamicBufferEnabled=this.ka.usk;jc.DefaultBufferSize=this.ka.xbm;jc.MaxAllowedFinalFragmentLatencyMS=this.ka.ogl;jc.FSupportSpeechResponseMessage=$b;jc.IsLiveAgent=this.ka.pptEditorTranscriberLiveAgentEnabled&&$b&&e.a.Dg(this.ka.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");jc.ShouldCreateCustomEndpointWithSession=this.ka.pptEditorTranscriberCustomEndpointWithSession;jc.TranscriberShowListeningDetectionTextInMS=this.ka.Kil;
jc.PodTranscriberAudioContextSampleRate=this.ka.ngl;jc.RehearsalGrammarIsEnabled=this.ka.GYe;jc.PodRehearsalMonotoneEnabled=this.ka.VXe;return JSON.stringify(jc)}nOj(){const La={};La.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;La.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;La.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;La.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;La.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;La.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;La.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;La.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;La.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;La.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;La.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
La.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;La.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;La.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;La.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;La.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;La.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
La.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;La.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;La.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;La.InitialMessage=ResourceStrings.L_SubtitleInitMessage;La.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;La.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;La.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;La.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;La.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(La)}gve(){return!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Kag}}Object(L.a)(Ea,"SlideshowFrame",null,[875])},1042:function(L,V,d){L=d(0);var k=d(395),e=d(997),n=d(136),r=d(165),w=d(25),D=d(18),y=d(699);class m{constructor(qb){this.aub=qb}next(qb){this.aub=(9301*this.aub+49297)%233280;return Math.floor(this.aub/233280*qb)}}Object(L.a)(m,"Random",
null,[]);var C=d(218),E=d(957),F=d(595),B=d(1180),H=d(1173);class K{constructor(){this.text=this.href=null}}Object(L.a)(K,"LinkProps",null,[]);var A=d(321),W=d(279),N=d(958),P=d(123),U=d(46),Q=d(166),G=d(54),Y=d(334);class ba{constructor(qb){this.kpi=15E3;this.NFf=!0;this.jpi=qb}nvk(){null==Y.a.instance.getItem("AddinEntryPointSurveyShowed")&&this.NFf&&(this.NFf=!1,window.setTimeout(()=>{this.HGf=G.a.instance.Ha("Common.ISystemInitiatedFeedback");null!=this.HGf&&this.HGf.execute(qb=>{qb.Cob(this.jpi,
null);Y.a.instance.setItem("AddinEntryPointSurveyShowed","1")})},this.kpi))}}Object(L.a)(ba,"FpsHelper",null,[]);class ha{constructor(qb,Ga,cb,Ob,Db,mb,Vc){this.eMd={};this.yii={};this.pGc={};this.Lrf=this.ztf=0;this.utf=null;this.Gpa=(Zb,fc)=>{this.Qwl(fc);this.Bnf&&this.Bnf.Gpa(Zb,fc)};this.C5a=Ga;this.TCa=null;this.eii=cb;this.gii=Ob;this.tni=Db;this.Bnf=void 0===Vc?null:Vc;this.La=(void 0===mb?null:mb)||w.AFrameworkApplication.fa;this.C5a.Qud(this.Gpa);appChrome.addInApi.loadOfficeAddInIcons()}get k_f(){return this.pGc}Qwl(qb){if(qb.BG)for(let Ga=
0;Ga<qb.BG.length;Ga++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+qb.BG[Ga].solutionId,qb.BG[Ga].iconUrl);else 0===qb.errorCode&&k.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get rcj(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get lEb(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",
!1)}get kxe(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutRemovingLinksEnabled",!0)}YVf(){if(this.HIi)return!0;let qb=this.C5a.WX(0);if(1!==qb.errorCode)return!0;qb=this.C5a.WX(1);return 1!==qb.errorCode}Sfl(qb){const Ga=[];var cb=new m((new Date).getDate());for(var Ob=0;30>Ob;Ob++)Array.add(Ga,cb.next(qb.count));cb=0;for(const Db of qb){Ob=!1;for(const mb of Ga)if(cb===mb){Ob=!0;break}cb++;if(Ob){let mb;(mb=Db.addinInfo).AUP=20*mb.AUP}else if(1===Db.addinInfo.priority){let mb;
(mb=Db.addinInfo).AUP=4*mb.AUP}else if(2===Db.addinInfo.priority){let mb;(mb=Db.addinInfo).AUP=2*mb.AUP}}qb.Sc((Db,mb)=>Db.addinInfo.AUP<mb.addinInfo.AUP?1:-1);return qb}n8d(qb,Ga){const cb={};cb.width=qb;cb.height=Ga;cb.backgroundColor="transparent";return cb}h0c(){const qb={},Ga={},cb={};Ga.root={margin:"0px","margin-left":"12px",width:"100%",maxWidth:"unset"};Ga.inner={margin:"-4px","margin-left":"18px"};cb.root=this.n8d(100,100);cb.flexContainer={flexDirection:"column"};cb.label={"margin-top":"4px",
"max-width":"86px","font-size":"12px","text-overflow":"ellipsis"};qb.galleryButtonInExpanded=cb;qb.galleryStack=Ga;return qb}Wsj(){return Object.assign(new H.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.tni,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid var(--border-color, #c8c8c8)","border-radius":"6px",padding:"15px 15px 15px 15px",
overflow:"hidden"}},Role:"menuitem",Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}AAb(qb,Ga,cb){const Ob={},Db={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid var(--border-color, #c8c8c8)"};w.AFrameworkApplication.isRtl&&(Db.direction="ltr");Ob.root=Db;return Object.assign(new H.a,{Id:cb,ExternalId:cb,Icon:"AddinFlyoutControl"+Ga.solutionId,Command:qb===CommonUIStrings.l_PopularAddins?this.eii:this.gii,LabelText:Ga.displayName,Role:"menuitem",
FullIconStyle:Ob,Alt:Ga.description})}dhl(qb,Ga,cb){const Ob=Object.assign(new B.a,{SectionId:qb,GalleryButtons:[]});for(let Db=0;Db<cb;Db++)Array.add(Ob.GalleryButtons,this.AAb(qb,Ga[Db],this.eMd[Ga[Db].solutionId]));return Ob}Qac(){var qb=[];const Ga=this.C5a.WX(0);Array.addRange(qb,Ga.BG);const cb=this.C5a.WX(1);Array.addRange(qb,cb.BG);let Ob=qb.length;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&k.ULS.sendTraceTag(509687428,
220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",Ob,y.a[Ga.errorCode],Ga.BG.length,y.a[cb.errorCode],cb.BG.length);qb.sort((ob,ub)=>{ob=P.d(ob.displayName);ub=P.d(ub.displayName);return U.a.localeCompare(ob,ub)});const Db=3<Ob;Db&&(Ob=2);for(var mb=0;mb<Ob;mb++)this.XRf(qb[mb]);let Vc=[];mb=null;this.TCa?Vc=this.TCa:(mb=this.C5a.WX(2),0===mb.errorCode&&mb.BG.forEach(ob=>{-1!==ob.addinInfo.priority&&(this.XRf(ob),Vc.push(ob))}));let Zb=!0;Vc.length||(Zb=!1);Zb&&(Vc=this.REi(Vc,
qb),this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.utf=new ba("AddinFlyoutFeedbackSurvey"),this.utf.nvk()));mb=Object.assign(new W.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});const fc=Object.assign(new C.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(mb.ControlList,fc);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",
CommonUIStrings.l_AddinPickerButtonMore));mb=Object.assign(new A.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:mb,UpdateDynamically:!0,IsFlexLayout:!0});2!==Ga.errorCode||qb.length?3===Ga.errorCode&&3===cb.errorCode?(k.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),qb=this.pfe("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(mb.MenuSectionList,qb)):this.rcj&&4===Ga.errorCode&&!qb.length?(k.ULS.sendTraceTag(508598107,220,10,"dataProvider disconnecteddisabled error hit"),
qb=this.pfe("StoreDisabled",CommonUIStrings.l_AddinPickerServiceDisconnectedError),Array.add(mb.MenuSectionList,qb)):(0<Ob&&this.z1i(mb,qb,Ob,Db),Zb&&(this.Lrf=30<Vc.length?30:Vc.length,Array.add(mb.MenuSectionList,this.Ssj(Vc,this.Lrf)))):(k.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),qb=this.pfe("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(mb.MenuSectionList,qb));this.ASi();return mb}ASi(){window.setTimeout(()=>{var qb=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");
qb&&qb.firstChild&&qb.firstChild.firstChild&&qb.firstChild.firstChild.firstChild&&(qb=qb.firstChild.firstChild.firstChild.scrollTop,0<qb&&(qb={["scrollTopValue"]:qb.toString()},n.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:r.a.YH(qb)}))))},6E4)}Ssj(qb,Ga){const cb=Object.assign(new W.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let Ob=0;Ob<0+Ga&&
Ob<qb.length;Ob++)this.yii.PopularAddInsListItem0=qb[Ob].solutionId,this.bsj(cb.ControlList,Ob.toString(),qb[Ob]);return cb}bsj(qb,Ga,cb){Ga=this.q4i(Ga,cb);Array.add(qb,Ga)}q4i(qb,Ga){const cb=[];if(this.kxe){var Ob=Object.assign(new K,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+Ga.solutionId});Array.add(cb,Ob)}else Ob=Object.assign(new K,{text:CommonUIStrings.l_AddinListPrivacy,href:Ga.privacyUrl}),Array.add(cb,Ob),Ob=Object.assign(new K,{text:CommonUIStrings.l_AddinListLicense,
href:Ga.licenseUrl}),Array.add(cb,Ob),Ob=Object.assign(new K,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Ga.solutionId}),Array.add(cb,Ob);Ob={};Ob["default"]="AddinFlyoutControl"+Ga.solutionId;const Db=this.B$b(Ga);return Object.assign(new N.a,{Id:"PopularAddInsListItem"+qb,ExternalId:"PopularAddInsListItem"+qb,CommandId:"PopularAddInsListItem"+qb,CommandIdMapped:"1497204054",iconSet:Ob,SecondaryLabel:null,Details:null,Label:Ga.displayName,ActionText:CommonUIStrings.l_AddinListAdd,
Description:Ga.description,Links:cb,ActionId:"PopularAddInsListItemAdd"+qb,ActionIdMapped:"2882601901",ActionCommandValueId:Db,CommandValueId:Db})}B$b(qb){return this.lEb?String.format("{0}#{1}",qb.solutionId,qb.storeId):qb.solutionId}Gfe(qb){if(!qb)return null;var Ga=qb.split("#");if(1!==Ga.length&&2!==Ga.length)return k.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;qb=Ga[0].trim();Ga=2===Ga.length?Ga[1].trim():w.AFrameworkApplication.uiCulture;return this.C5a.CAb(qb,
Ga)}XRf(qb){if(!(qb.solutionId in this.eMd)){const Ga="AddinGalleryButton"+this.ztf.toString();this.eMd[qb.solutionId]=Ga;qb=this.B$b(qb);this.pGc[Ga]=qb;this.pGc[Ga+"Add"]=qb;this.ztf++}}qqg(qb){return qb?this.pGc[qb]:null}pfe(qb,Ga){const cb=Object.assign(new W.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});qb=Object.assign(new E.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:qb,Label:Ga,RetryButtonTitle:"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===
qb?Ga:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(cb.ControlList,qb);return cb}REi(qb,Ga){var cb=new D.a;for(let Ob=0;Ob<qb.length;Ob++)cb.add(qb[Ob]);this.TCa||(30<cb.count&&(cb=this.Sfl(cb)),this.TCa=cb.toArray());for(qb=0;qb<this.TCa.length;qb++)for(cb=0;cb<Ga.length;cb++)if(this.TCa[qb].solutionId.toLowerCase()===Ga[cb].solutionId.toLowerCase()){Array.remove(this.TCa,this.TCa[qb--]);break}return this.TCa}z1i(qb,Ga,cb,Ob){var Db=CommonUIStrings.l_MyAddinSection;Ob=void 0===Ob?!1:
Ob;const mb=Object.assign(new W.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[],Title:Db}),Vc=Object.assign(new F.a,{Id:"MRUAddinsGalleryControl",ExternalId:"MRUAddinsGalleryControl",GalleryStyle:this.h0c(),Width:3,Type:4,GallerySections:[]});Array.add(qb.MenuSectionList,mb);Array.add(mb.ControlList,Vc);qb=this.dhl(Db,Ga,cb);Ob&&Array.add(qb.GalleryButtons,this.Wsj());Vc.GallerySections.push(qb)}Yrd(qb){if(qb)try{qb.MenuItems=this.Qac()}catch(Ga){k.ULS.sendTraceTag(509687425,
220,10,"GetReactGalleryMenu hit exception "+(Ga?Ga.toString():""))}else k.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}get HIi(){return"Dev Box"===w.AFrameworkApplication.fa.Ea("StatusBarEnvironmentNameToUse")}}Object(L.a)(ha,"AppsFlyoutGenerator",null,[106]);var ka=d(1266),ca=d(1267);class ia{constructor(){this.addInDetails=this.title=null}}Object(L.a)(ia,"AddInCategoryData",null,[]);class oa{constructor(){this.links=this.description=this.displayName=this.uniqueId=
this.solutionId=null}}Object(L.a)(oa,"AddInDetailData",null,[]);class sa{constructor(){this.href=this.text=null}}Object(L.a)(sa,"AddInLinkData",null,[]);var Ca=d(121);class Ta{constructor(qb,Ga,cb){this.Mra=0;this.Ytf=!1;this.o1b=[];this.La=qb;this.Lra=Ga;this.yCf=cb;k.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}Gpa(qb,Ga){qb&&Ga&&this.qYl(Ga)&&this.Igl()}qYl(qb){0===qb.sX&&(this.Mra|=1);1===qb.sX&&(this.Mra|=2);2===qb.sX&&(this.Mra|=4);return!!this.Mra}Igl(){let qb=null;
const Ga={},cb=this.Unk,Ob=this.bZk;var Db=this.Lra.WX(0);const mb=this.Lra.WX(1),Vc=this.Lra.WX(2);2!==Db.errorCode||Ob.length?3===Db.errorCode&&3===mb.errorCode?qb={label:CommonUIStrings.l_AddinPickerGeneralError,iconName:"Common",ariaDescription:CommonUIStrings.l_AddinPickerGeneralError}:4!==Db.errorCode||Ob.length?this.yEg&&!Vc.BG.length&&k.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.Mra,Vc.errorCode):qb={label:CommonUIStrings.l_AddinPickerServiceDisconnectedError,
iconName:"StoreDisabled",ariaDescription:CommonUIStrings.l_AddinPickerServiceDisconnectedError}:qb={label:CommonUIStrings.l_AddinPickerDisableError,iconName:"StoreDisabled",ariaDescription:CommonUIStrings.l_AddinPickerDisableError};Db=!qb;if(!Db||cb||Ob.length)Db?(Ga.mruAddIns=Ob,cb&&(Ga.categories=this.Ggl)):Ga.errorViewProps=qb,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(Ga,Db)),cb&&Db&&!this.Ytf&&(this.Ytf=!0,k.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",
this.Mra))}get yEg(){return!!(this.Mra&4)}get Unk(){const qb=this.Lra.WX(2);return this.yEg&&0===qb.errorCode&&!!qb.BG.length}get Ggl(){if(Ca.b(this.yCf))return[];var qb=JSON.parse(this.yCf);const Ga=[];for(var cb of qb)qb=Object.assign(new ia,{title:cb.title,addInDetails:[]}),this.XJi(qb,cb.solutionIds),0<qb.addInDetails.length&&Array.add(Ga,qb);0<this.o1b.length&&(cb=this.Lra.WX(2),k.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.o1b.length,
this.o1b,cb.BG.length),this.o1b=[]);return Ga}get bZk(){var qb=[],Ga=this.Lra.WX(0);Array.addRange(qb,Ga.BG);Ga=this.Lra.WX(1);Array.addRange(qb,Ga.BG);qb.sort((cb,Ob)=>{cb=P.d(cb.displayName);Ob=P.d(Ob.displayName);return U.a.localeCompare(cb,Ob)});Ga=[];for(const cb of qb)qb=Object.assign(new oa,{description:cb.description,displayName:cb.displayName,solutionId:cb.solutionId,uniqueId:this.B$b(cb)}),Array.add(Ga,qb);return Ga}XJi(qb,Ga){const cb=this.cZk;let Ob=0;for(const Db of Ga){if(4===Ob)break;
if(cb.contains(Db))continue;Ga=this.Lra.CAb(Db);if(!Ga){this.o1b.push(Db);continue}const mb=Object.assign(new oa,{description:Ga.description,displayName:Ga.displayName,solutionId:Ga.solutionId,uniqueId:this.B$b(Ga)});mb.links=this.kxe?[Object.assign(new sa,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+Ga.solutionId})]:[Object.assign(new sa,{text:CommonUIStrings.l_AddinListPrivacy,href:Ga.privacyUrl}),Object.assign(new sa,{text:CommonUIStrings.l_AddinListLicense,
href:Ga.licenseUrl}),Object.assign(new sa,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Ga.solutionId})];Array.add(qb.addInDetails,mb);++Ob}}get cZk(){const qb=[];var Ga=this.Lra.WX(0);Array.addRange(qb,Ga.BG);Ga=this.Lra.WX(1);Array.addRange(qb,Ga.BG);Ga=new ka.a(ca.a.gl());for(const cb of qb)Ga.add(cb.solutionId);return Ga}B$b(qb){return this.lEb?String.format("{0}#{1}",qb.solutionId,qb.storeId):qb.solutionId}get lEb(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",
!1)&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}get kxe(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutRemovingLinksEnabled",!0)}}Object(L.a)(Ta,"AddInCategoryManager",null,[]);var R=d(1182),Ha=d(201),da=d(7),Ba=d(1264),za=d(698),Aa=d(36),na=d(42),la=d(82),va=d(38);class Pa{constructor(){this.idField=null;this.stateField=0}}Object(L.a)(Pa,"CT_OsfBackgroundAppData",null,[]);class Qa{constructor(){this.currentStoreTypeField=
this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(L.a)(Qa,"CT_OsfInsertionInfo",null,[]);var Ua=d(51),Ya=d(996),Ea=d(998),La=d(340),xb=d(30),dc=d(29),gb=d(92),gc=d(952),Ac=d(541);class $b extends Ac.a{constructor(qb){super("TextAboveImage");this.imageHeight=this.imageWidth=
this.image=this.paragraphs=null;this.paragraphs=qb.paragraphs;this.image=qb.image;this.imageWidth=qb.imageWidth;this.imageHeight=qb.imageHeight}}Object(L.a)($b,"TextAboveImage",Ac.a,[]);class jc{constructor(qb,Ga){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=qb;this.image=Ga}}Object(L.a)(jc,"TextAboveImageCustomProps",null,[]);var pb=d(144),$a=d(1164),zc=d(954),rb=d(953),ib=d(356),Vb=d(80),Od=d(141);class jb{constructor(){this.pMk="ClickOnLaunch";this.QHk="ClickOnDismiss";
this.$Rk="Show";this.yJk="BetterEntryPoint_InsertTab";this.kTk=500;this.kKk=280;this.gKk=192;this.xKk="InsertAddInFlyout";this.iRk="RibbonOverflowMenu-overflow";this.hRk="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.RJk="[data-unique-id=Home]";this.yKk="InsertAddinTransitionEntry"}H1i(){Object(gb.b)(this,void 0,void 0,function*(){try{const qb=yield pb.UISurfaces.BM();jb.GJb&&(qb.removeNotification(jb.GJb),jb.GJb=null);let Ga=this.hRk;const cb=document.getElementById(this.yKk),Ob=cb?window.getComputedStyle(cb,
null):null;if(null==cb||Ob&&"none"===Ob.display)Ga=this.RJk;const Db=CommonUIStrings.l_BetterEntryPointTUI_Title,mb=CommonUIStrings.l_BetterEntryPointTUI_Content,Vc=new gc.a("https://iriscoremetadataprod.blob.core.windows.net/assets/add-ins_powerpoint_1677568738672.svg"),Zb=new jc(mb,Vc),fc=new $b(Zb);fc.imageWidth=this.kKk;fc.imageHeight=this.gKk;const ob=new $a.a;ob.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;ob.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;ob.onExecute=
()=>{this.CYj();this.V5(this.pMk)};const ub=new $a.a;ub.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;ub.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;ub.onExecute=()=>{qb.removeNotification(jb.GJb);this.V5(this.QHk)};const bc=new zc.a;bc.onDismiss=()=>{qb.removeNotification(jb.GJb)};bc.setInitialFocus=!0;const ic=new rb.a;ic.target=Ga;ic.title=Db;ic.content=fc;ic.showCloseIcon=!0;ic.hasDynamicSizing=!1;ic.preventLightDismiss=!1;ic.useTeachingStyles=!0;ic.primaryButtonProps=
ob;ic.secondaryButtonProps=ub;ic.calloutProps=bc;const Rc=qb.callout(ic),Fb=new ib.a;Fb.onShow=()=>{this.V5(this.$Rk)};jb.GJb=qb.addNotification(Rc,Fb);return null}catch(qb){return k.ULS.sendTraceTag(509207556,220,15,"Failed to GetNotificationsAPIAsync: {0}",qb),null}})}CYj(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));const qb=new Vb.a(0,1,this.kTk,()=>{this.Bvk()});Od.a.instance.Jb(qb)}Bvk(){const qb=document.getElementById(this.xKk),Ga=qb?window.getComputedStyle(qb,null):null;
if(null==qb||Ga&&"none"===Ga.display){const cb=document.getElementById(this.iRk);null!=cb?(cb.onclick=function(){const Ob=new Vb.a(0,1,500,()=>{const Db=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=Db?(Db.click(),k.ULS.sendTraceTag(509207555,220,50,"Launch flyout in overflow")):k.ULS.sendTraceTag(509207554,220,10,"Neither ribbon nor overflow can launch flyout")});Od.a.instance.Jb(Ob);cb.onclick=function(){}},cb.click()):k.ULS.sendTraceTag(509207553,220,10,"Neither ribbon nor overflow can launch flyout")}else qb.click(),
k.ULS.sendTraceTag(509207552,220,50,"Launch flyout in ribbon button")}V5(qb){qb={["AppTeachingUICalloutAction"]:qb,["AppTeachingUICalloutGoal"]:this.yJk};n.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:r.a.YH(qb)}))}}jb.GJb=null;Object(L.a)(jb,"PPTBetterEntryTeachingCallout",null,[]);d.d(V,"a",function(){return Wb});class Wb{constructor(qb,Ga,cb,Ob,Db,mb,Vc,Zb,fc,ob,ub,bc,ic){this.kGb=0;this.BXg=this.FTg=!1;this.OFk="g_InstallOrigin";
this.Ach=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.a5g=null;this.INi=`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa104178141","wa104381909","wa104380907","wa104221182","wa104381411","wa104380121","wa104379997","wa104379370","wa104381063","wa104295828","wa200000113","wa200000729"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDesigningAnInteractivePresentation}","solutionIds":["wa104379261","wa200001661","wa200002908","wa200004709","wa200004643","wa104380667","wa104218073","wa104382064","wa104381682"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDesigningWithTemplates}","solutionIds":["wa104380050","wa200001396","wa200003964","wa200001625","wa200003157","wa200001409","wa200002334"]}]`;
this.IYj=()=>this.a1d&&!this.Lb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.pU&&this.pU.YVf()?32:8;this.mYj=(Rc,Fb,Qb,hc,Pc)=>{if(2!==Qb)return this.pU&&this.pU.YVf()?32:8;if(!this.pU)return 8;this.pU.Yrd(Pc);return 32};this.HTj=(Rc,Fb)=>{if(2!==Rc)return 32;Rc=Fb.Href;var Qb=this.Lfg(Fb.CommandValueId);Qb&&(Qb={["solutionId"]:Wb.r5(Qb.solutionId,Qb.storeType,Qb.assetId,Qb.storeId)},Qb.href=Rc,Qb.UILocation=Fb.UILocation,n.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",
dataFields:r.a.YH(Qb)})));return 32};this.bXj=(Rc,Fb,Qb,hc,Pc)=>"LinkClickedPayload"===Pc.Type?this.HTj(Qb,Pc):this.Gsg(Rc,Fb,Qb,hc,Pc);this.WWj=(Rc,Fb,Qb,hc,Pc)=>{if(2!==Qb)return 32;Fb={};if(Qb=this.Lfg(Pc.CommandValueId))Fb.solutionId=Qb.solutionId,Fb.version=Qb.version,Fb.storeType=Qb.storeType,Fb.storeId=Qb.storeId,Fb.assetId=Qb.assetId,Fb.assetStoreId=Qb.assetStoreId,Fb.targetType=Qb.targetType,Fb.displayName=Qb.displayName,Fb.width=Qb.width,Fb.height=Qb.height,this.Kd.jMb("handleInsertAppForOffice",
Fb),this.Ome(Rc,Fb),Rc={["solutionId"]:Wb.r5(Qb.solutionId,Qb.storeType,Qb.assetId,Qb.storeId)},Rc.UILocation=Pc.UILocation,n.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:r.a.YH(Rc)}));else return k.ULS.sendTraceTag(509109065,344,10,"No add-in details."),8;return 32};this.cXj=(Rc,Fb,Qb,hc,Pc)=>{var uc;if(!this.u6||!Pc)return 8;if(1===Qb)return this.Kd?32:8;if(!this.Kd)return this.kGb||(this.kGb=window.performance.now()),
this.$M.mla(),this.$M.pSa(Rc,Pc),8;Rc=Pc[za.a.Lzb];Fb=Pc[za.a.Zkb];Qb=Fb.optionalProperties;Pc={};Pc.BA=Qb.TaskPaneTitle;Pc.assetId=Rc.getId();Pc.q7=Qb.OnRenderedCallback;Pc.nonPersistedSettings=Fb.Uyb;Pc.lVc=Qb.DialogIsModal;Pc.pVc=Qb.DialogShowTitleBar;Pc.dialogWidth=Qb.DialogWidth;Pc.dialogHeight=Qb.DialogHeight;Pc.dialogLeft=Qb.DialogLeft;Pc.Q7b=Qb.DialogRight;Pc.dialogTop=Qb.DialogTop;Pc.N7b=Qb.DialogBottom;Pc.Qla=null!==(uc=Qb.DialogTitle)&&void 0!==uc?uc:"";Pc.sourceLocationOverrideResourceId=
Qb.SourceLocationOverrideResourceId;Pc.t$d=Qb.DialogParentId;Pc.O7b=Qb.DialogCloseCallback;uc=this.Kd.Obb(Pc);if(uc=this.Kd.TO(uc))Pc.zj=uc.zj;this.Kd.ADl(Pc);return 32};this.g_j=(Rc,Fb,Qb,hc,Pc)=>{if(2!==Qb)return 32;if(!this.Kd)return 8;Fb=Pc[za.a.Lzb];Qb=Pc[za.a.Zkb].optionalProperties;Rc={};Rc.BA=Qb.TaskPaneTitle;Rc.assetId=Fb.getId();Rc.sourceLocationOverrideResourceId=Qb.SourceLocationOverrideResourceId;Rc.q7=Qb.Lrm;Rc.nonPersistedSettings=Qb.Uyb;Fb=this.Kd.Obb(Rc);Fb=this.Kd.TO(Fb);Pc=Pc[za.a.Sxb];
return Fb&&"taskpane"==Pc.toLowerCase()?(this.Kd.fQl(Fb.zj,Rc),32):8};this.KTj=(Rc,Fb,Qb,hc,Pc)=>{if(2!==Qb)return 32;if(Pc.SourceControlId)return this.a5g=new jb,this.a5g.H1i(),32;k.ULS.sendTraceTag(509207557,220,10,"Control id is null.")};this.dXj=(Rc,Fb,Qb,hc,Pc)=>{if(2!==Qb)return 32;if(!this.pU)return 8;Fb=Qb=void 0;hc=Pc.SourceControlId;this.pU.lEb?(hc=this.pU.Gfe(this.pU.qqg(hc)),null!=hc&&(Qb=hc.solutionId,Fb=hc.storeId)):Qb=(Qb=Pc.CommandValueId)?Qb:this.SBe.k_f[hc];if(!Qb)return k.ULS.sendTraceTag(509383066,
220,10,"SourceControlId (solutionId) is empty in handleLaunchUserInstalledAddIn"),8;this.Kd?this.Kd.jvk(Qb,Fb,Pc.UILocation):(this.$M.mla(),this.$M.pSa(Rc,Pc));return 32};this.Gsg=(Rc,Fb,Qb,hc,Pc)=>{if(2!==Qb)return 32;if(!this.pU)return 8;Fb=this.tNj(Pc);if(!Fb)return k.ULS.sendTraceTag(509383065,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Kd?this.Kd.j$c(Fb,Pc.UILocation):(this.$M.mla(),this.$M.pSa(Rc,Pc));return 32};this.Hsg=(Rc,Fb,Qb,hc,Pc)=>{Fb=this.sa.Aa;
hc=this.Yb.Of;if(!(this.u6&&Fb&&hc)||this.uf.Xc(Fb))return 8;if(!this.a1d)return k.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===Qb)return 32;Qb=Pc?Pc.SourceControlId:void 0;window[this.OFk]=this.Ach.get(Qb)?this.Ach.get(Qb):"Unknown";this.Kd?xb.a("UpdateLaunchInsertDialog")?(Rc=Pc?Pc.SourceControlId:void 0,Pc=Pc?Pc.CommandValueId:null,"InsertMoreAddInsFromFooter"===Rc||"InsertMoreAddInsFromBackstageFooter"===Rc?this.Kd.rIg("{98143890-AC66-440E-A448-ED8771A02D52}"):
"AddinFlyoutMoreButton"===Rc||"LaunchMyAddInsFromBackstage"===Rc?this.Kd.rIg("0"):"LaunchAddinDialogFromTellMe"==Rc&&Pc?this.Kd.Evk(Pc):this.Kd.launchInsertDialog()):this.Kd.launchInsertDialog():(this.$M.mla(),this.$M.pSa(Rc,Pc));return 32};this.Csg=(Rc,Fb,Qb,hc,Pc)=>{if(!Pc)return 8;null!=this.Kd&&this.Lb.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&this.Kd.jMb("handleInsertAppForOffice",Pc);return this.Ome(Rc,Pc)};this.IWj=(Rc,Fb,Qb,hc,Pc)=>Pc?this.Ome(Rc,Pc):8;this.Ome=(Rc,Fb)=>{if(!this.a1d)return k.ULS.sendTraceTag(512288601,
802,50,"Web add-in insert blocked by doc IRM"),16;if(0===Fb.targetType)return this.xbk(Fb,Rc);if(1===Fb.targetType){if(this.uf.Xc(this.Yb.Of))return 16;this.RKk?Fb.isAddinCommands?xb.a("AddinCommandsActionTypeUndefinedCheck")?void 0===Fb.addinCommandsActionType||null===Fb.addinCommandsActionType||0===Fb.addinCommandsActionType?this.RTb(Fb):1===Fb.addinCommandsActionType?this.k5c(Fb):k.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+Fb.addinCommandsActionType.toString()):
0===Fb.addinCommandsActionType?this.RTb(Fb):1===Fb.addinCommandsActionType&&this.k5c(Fb):(Rc={},Rc.solutionId=Fb.solutionId,Rc.version=Fb.version,Rc.storeType=Fb.storeType,Rc.storeId=Fb.storeId,Rc.targetData=Fb,this.Kd.xj.isAddinCommandsAsync(Rc,(Qb,hc,Pc)=>{hc?this.RTb(Pc.targetData):this.k5c(Pc.targetData);Qb||(Qb=Pc.targetData,k.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Qb.solutionId,Qb.storeType,Qb.assetId,null,
null,Qb.storeId),Qb.storeType))})):this.k5c(Fb);Ya.a.add(Fb.solutionId,Fb.targetType,Fb.storeId,Fb.storeType,Fb.version);return 32}return 8};this.ka=qb;this.Lb=Ga;this.u6=this.ka.pptEditInsertAppsForOfficeEnabled;this.RKk=this.ka.Zva;this.ms=cb;this.ia=Ob;this.Yb=Db;this.sa=mb;this.mgd=Zb;this.Eb=Vc;this.$M=fc;this.Oc=ob;this.Ub=ub;this.uf=bc;this.Lj=ic}get a1d(){return this.u6&&w.AFrameworkApplication.Wka}get Q7c(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",
!1)&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinRibbonStatusEnabled",!1)}qb(){this.ia.pa(dc.a.jXa,Ua.a.application,this.Hsg,516);this.ia.pa(dc.a.W4c,Ua.a.application,this.IWj,4);this.ia.xa(dc.a.T3c,Ua.a.application,Object(da.a)(this,this.rWj,"handleHideAppForOfficeTaskPane"));this.ia.pa(dc.a.Imb,Ua.a.application,Object(da.a)(this,this.AZj,"handleRenderAppForOfficeTaskPane"),4);this.ia.pa(dc.a.Y1a,Ua.a.application,Object(da.a)(this,this.Y1a,"queryEntitledAppsForOffice"),96);
this.ia.xa(dc.a.Aia,Ua.a.application,Object(da.a)(this,this.Btg,"handleShowFirstPartyTaskPane"));this.ia.xa(dc.a.Gxb,Ua.a.application,Object(da.a)(this,this.VUj,"handleCloseAppsForOfficeTaskPane"));this.ia.xa(Aa.a.uRh,Ua.a.application,Object(da.a)(this,this.n_j,"handleShowExtensionTaskPane"));this.ia.xa(Aa.a.RXf,Ua.a.application,Object(da.a)(this,this.WUj,"handleCloseExtensionTaskPane"));this.ia.xa(Aa.a.QGh,Ua.a.application,Object(da.a)(this,this.KZj,"handleRestartExtensionTaskPane"));this.ia.xa(dc.a.F1h,
Ua.a.application,Object(da.a)(this,this.j0j,"handleUpdateBackgroundAppData"));this.ia.xa(Aa.a.uIg,Ua.a.application,this.cXj);xb.a("EnabledTellMeAddinOnPPTO")&&(this.ia.pa(Aa.a.pyg,Ua.a.application,this.Csg,4),this.ia.pa(Aa.a.Aze,Ua.a.application,this.Hsg,4));this.f3b&&(this.ia.xa(Aa.a.j$c,Ua.a.application,this.Gsg),this.ia.xa(Aa.a.oqe,Ua.a.application,this.Csg),this.ia.xa(Aa.a.Fze,Ua.a.application,this.dXj),this.ia.pa(Aa.a.inl,Ua.a.application,this.IYj,4),this.Q7c||this.aCh());if(this.Tih||this.f3b)this.ia.xa(Aa.a.mvk,
Ua.a.application,this.bXj),this.ia.xa(Aa.a.ack,Ua.a.application,this.WWj);xb.a("EnableSetTitleExtensionTaskPane")&&this.ia.xa(Aa.a.XNh,Ua.a.application,this.g_j);this.EBi&&this.ia.pa(Aa.a.eyg,Ua.a.application,this.KTj,516)}aCh(){this.BXg||(this.ia.xa(Aa.a.Jgl,Ua.a.application,this.mYj),this.BXg=!0,k.ULS.sendTraceTag(508560274,220,50,"Register succeed"))}Gpa(){this.aCh()}get pU(){if(!this.f3b)return null;if(!this.Kd)return this.$M.mla(),null;this.SBe||(this.Kd.Evb?(this.SBe=new ha(this.ia,this.Kd.Evb,
Aa.a.j$c.toString(),Aa.a.Fze.toString(),dc.a.jXa.toString(),this.Lb,this.Eui),this.Q7c&&this.Kd.Evb.Qud(Object(da.a)(this,this.Gpa,"onAddinDetailsRefreshed"))):k.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null"));return this.SBe}get Eui(){this.Tih&&!this.SLg&&(this.SLg=new Ta(this.Lb,this.Kd.Evb,this.INi));return this.SLg}get Tih(){var qb;return!(null===(qb=this.Lb)||void 0===qb||!qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",
!1))}get f3b(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get EBi(){return this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",!1)}tNj(qb){if(qb)if(this.pU.lEb){if(qb=this.pU.Gfe(this.IQj(qb)))return qb.solutionId}else{const Ga=qb.CommandValueId;return null!=Ga?Ga:this.pU.k_f[qb.SourceControlId]}}IQj(qb){var Ga;
return null!==(Ga=qb.CommandValueId)&&void 0!==Ga?Ga:this.pU.qqg(qb.SourceControlId)}Sd(){}get Kd(){return this.Oc.instance}Lfg(qb){return this.pU.lEb?this.pU.Gfe(qb):this.Kd.Evb.CAb(qb)}static r5(qb,Ga,cb,Ob){return Telemetry.PrivacyRules.GetPrivacyCompliantId(qb,Ga,cb,null,null,Ob)}n_j(qb,Ga,cb,Ob,Db){if(2!==cb)return 32;const mb=Db[za.a.Lzb];Db=Db[za.a.Zkb];const Vc={};Vc.BA=Db.optionalProperties[e.a.BA];Vc.assetId=mb.getId();Vc.q7=Db.optionalProperties[e.a.q7];Vc.showLoadingSpinner=Db.optionalProperties[e.a.showLoadingSpinner];
Vc.nonPersistedSettings=Db.Uyb;return this.Btg(qb,Ga,cb,Ob,Vc)}WUj(qb,Ga,cb,Ob,Db){if(2!==cb)return 32;qb=Db[za.a.Lzb];Db=Db[za.a.Zkb];Ga={};Ga.BA=Db.optionalProperties[e.a.BA];Ga.assetId=qb.getId();Ga.sourceLocationOverrideResourceId=Db.optionalProperties[e.a.sourceLocationOverrideResourceId];Ga.q7=Db.optionalProperties[e.a.q7];Ga.nonPersistedSettings=Db.Uyb;Db=this.Kd.Obb(Ga);return(Db=this.Kd.TO(Db))&&this.Kd.l5d(Db.zj)?32:8}KZj(qb,Ga,cb,Ob,Db){if(2!==cb)return 32;qb=Db[za.a.Lzb];Ga=Db[za.a.Zkb];
Db={};Db.BA=Ga.optionalProperties[e.a.BA];Db.assetId=qb.getId();Db.sourceLocationOverrideResourceId=Ga.optionalProperties[e.a.sourceLocationOverrideResourceId];Db.q7=Ga.optionalProperties[e.a.q7];Db.nonPersistedSettings=Ga.Uyb;qb=this.Kd.Obb(Db);return(qb=this.Kd.TO(qb))?(this.Kd.uBh(qb.zj,Db),32):8}rWj(qb,Ga,cb,Ob,Db){if(!this.u6)return 16;if(!Db)return 8;if(1===cb)return 32;qb=Object(Ba.a)(String,Db);if(!qb||!qb.length)return 8;if((Ga=this.Kd.pYc(qb))&&Ga.taskpane){if(this.Kd.fwa(qb))return this.Kd.znb(qb,
!1),32;if(Ga.An&&OSF.OsfControl.isFirstPartyStoreString(Ga.An.storeType))return this.Kd.HVc(qb),this.Kd.Kpl(qb),32;Ga=Ga.taskpane.ownerAddinSolutionId;if(this.Kd.Edk(qb)||Ga)this.Kd.HVc(qb);else if(Ga=this.Kd.HZc(),cb=this.Ub.Pc(Ga),qb=this.Kd.Acg(qb)){cb.Cl(Object(Ba.a)(la.a,qb));qb=this.Eb.ud(4,void 0,void 0,void 0,!0);try{qb.mc(Ga),cb.rj()}finally{qb&&qb.dispose()}}}return 32}AZj(qb,Ga,cb,Ob,Db){if(!this.u6)return 16;if(!Db)return 8;if(1===cb)return 32;Ga=Object(Ba.a)(String,Db);if(!Ga||!Ga.length)return 8;
this.Kd?this.Kd.Imb(Ga):this.$M.pSa(qb,Db);return 32}Btg(qb,Ga,cb,Ob,Db){if(!this.u6)return 16;if(!Db)return 8;if(1===cb)return 32;if(this.Kd){if(!Db||!Db.assetId||!w.AFrameworkApplication.H8c(Db.assetId))return 8;Db.nonPersistedSettings||(Db.nonPersistedSettings={});Db.nonPersistedSettings.ShowFeedback=w.AFrameworkApplication.XF;!this.FTg&&this.kGb&&(this.FTg=!0,qb=window.performance.now()-this.kGb,k.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",qb));qb=this.Kd.Obb(Db);if(qb=
this.Kd.TO(qb))return this.Kd.uBh(qb.zj,Db),32;this.Kd.lDl(Db)}else this.kGb||(this.kGb=window.performance.now()),this.$M.mla(),this.$M.pSa(qb,Db);return 32}j0j(qb,Ga,cb,Ob,Db){if(1===cb)return this.u6?32:8;if(!this.u6)return 16;if(!(Db&&Db.lx&&-1!==Db.lx.state&&Db.lx.gAa&&this.Kd))return 8;qb=this.Kd.WFa(Db.An.id);if(!qb)return 8;Ga=this.Eb.ud(4,void 0,void 0,void 0,!0);try{Ga.mc(qb),qb.setValue(va.a.qwb,Db.lx.state),qb.setValue(va.a.W9a,Db.lx.gAa),qb.setValue(na.a.v3b,Db.An.storeType)}finally{Ga&&
Ga.dispose()}return 32}VUj(qb,Ga,cb,Ob,Db){return this.u6?Db?1===cb?32:this.Kd&&Db&&Db.length?this.Kd.l5d(Db)?32:8:8:8:16}Y1a(qb,Ga,cb,Ob,Db){var mb;if(2===cb){Ga=Db.callback;if(!Ga)return 16;xb.a("AllowQueryAddinsForStoreTypes")?this.Kd?this.unl(Ga,null!==(mb=Db.storeType)&&void 0!==mb?mb:OSF.StoreTypeEnum.MarketPlace):(Db=Object.assign({},Db),this.$M.pSa(qb,Db)):this.tnl(Ga)}return 32}unl(qb,Ga){const cb=new R.a;cb.callbackFunc=qb;cb.storeType=Ga;cb.fromInsertDialog=!1;cb.refresh="true"===Y.a.instance.getItem(Ha.a.s_d);
this.Kd.xj.queryEntitlementDetails(cb)}tnl(qb){const Ga=new R.a;Ga.callbackFunc=qb;Ga.storeType=OSF.StoreTypeEnum.MarketPlace;Ga.fromInsertDialog=!1;Ga.refresh="true"===Y.a.instance.getItem(Ha.a.s_d);this.Kd.xj.queryEntitlementDetails(Ga)}RTb(qb){const Ga=new D.a;Ga.add(qb);qb={};qb[Ha.a.FOc]=Ga;qb[Ha.a.Qka]=3;this.ia.Ia(Aa.a.h$c,2,qb)}xbk(qb,Ga){const cb=this.sa.Aa;if(!cb||this.uf.Xc(cb))return 16;if(!this.Lj.UD(cb,1))return this.Lj.yE(cb),16;try{return this.ryg(qb,cb,cb.Fb,Ga)}catch(Ob){return 8}}ryg(qb,
Ga,cb,Ob){cb=Ga.j5i(qb.width,qb.height,Ga.wt()+1);Ea.a.yKf(cb,qb,this.Kd);this.ms.NU([Object(Ba.a)(4,cb)],Ga,Ob);Ya.a.add(qb.solutionId,qb.targetType,qb.storeId,qb.storeType,qb.version);return 32}k5c(qb){if(!this.Kd.TO(qb.solutionId)){var Ga=this.Kd.WFa(qb.solutionId),cb=this.Kd.HZc();if(Ga){cb=new La.a(Ga);if(!cb.visibility){const Ob=this.Eb.ud(4,void 0,void 0,void 0,!0);try{Ob.mc(Ga),Ga.setValue(na.a.x3b,!0),Ga.setValue(na.a.v3b,qb.storeType)}finally{Ob&&Ob.dispose()}}this.Kd.Imb(cb.id)}else{Ga=
Ea.a.O1i(this.mgd.value,qb,this.Kd);qb=this.Eb.ud(4,void 0,void 0,void 0,!0);try{qb.mc(cb),Ea.a.oSa(cb,Ga,19)}finally{qb&&qb.dispose()}}}}}Object(L.a)(Wb,"AppForOfficeActor",null,[948])},1044:function(L,V,d){L=d(0);var k=d(319),e=d(25),n=d(46),r=d(7),w=d(19),D=d(1264),y=d(35),m=d(27);class C{}C.speechMode="Subtitles";C.X2f=[C.speechMode];C.sourceLanguage=null;C.targetLanguages=null;C.speechFDBase=null;C.podSessionId=null;C.y5h=null;C.docId=null;C.webServiceBase=null;C.userSessionId=e.AFrameworkApplication.userSessionId;
Object(L.a)(C,"PPTSpeechClientConfig",null,[]);var E=d(75);class F{constructor(){this.ua=new E.a}onFinalRecognitionText(ba){this.ua.raiseEvent("OnFinalRecognitionText",ba)}onPartialRecognitionText(ba){this.ua.raiseEvent("OnPartialRecognitionText",ba)}onError(ba){this.ua.raiseEvent("OnError",ba)}onSpeechRecognitionStarted(ba){this.ua.raiseEvent("OnSpeechRecognitionStarted",ba)}onEventUpdate(ba){this.ua.raiseEvent("OnEventUpdate",ba)}Qxi(ba){this.ua.addHandler("OnFinalRecognitionText",ba)}HAl(ba){this.ua.removeHandler("OnFinalRecognitionText",
ba)}Yzi(ba){this.ua.addHandler("OnPartialRecognitionText",ba)}aCl(ba){this.ua.removeHandler("OnPartialRecognitionText",ba)}Lxi(ba){this.ua.addHandler("OnError",ba)}CAl(ba){this.ua.removeHandler("OnError",ba)}VAi(ba){this.ua.addHandler("OnSpeechRecognitionStarted",ba)}KCl(ba){this.ua.removeHandler("OnSpeechRecognitionStarted",ba)}Mxi(ba){this.ua.addHandler("OnEventUpdate",ba)}EAl(ba){this.ua.removeHandler("OnEventUpdate",ba)}}Object(L.a)(F,"PPTSpeechClientObserverController",null,[]);var B=d(395),
H=d(470);class K{constructor(){this.accessToken=null}}Object(L.a)(K,"IAuthenticationProvider",null,[]);class A{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(L.a)(A,"IDocumentDownloadConfig",null,[]);class W{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=
this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(L.a)(W,"ISpeechConfig",null,[]);class N{constructor(ba){this.Y6=ba}onFinalText(){}onFragmentText(){}onFinalRecognitionText(ba,ha){this.Y6.onFinalRecognitionText(ba,ha)}onPartialRecognitionText(ba,ha){this.Y6.onPartialRecognitionText(ba,ha)}onError(ba){if("ErrorNone"!==ba)switch(ba){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.Y6.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.Y6.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.Y6.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.Y6.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.Y6.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.Y6.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.Y6.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.Y6.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.Y6.onError("NotReadableError");break;default:this.Y6.onError("CustomError-"+ba)}}onSpeechRecognitionStarted(ba){B.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",ba);this.Y6.onSpeechRecognitionStarted(ba)}onEventUpdate(ba){this.Y6.onEventUpdate(ba)}}Object(L.a)(N,"PPTSpeechClientObserver",null,[1086]);class P{constructor(ba){this.mba=null;this.LKa=0;this.microphoneDeviceId="";this.CSk=new N(ba)}Zqk(){return 2===this.LKa}rak(){const ba=this.C7d(),ha=Object.assign(new K,{accessToken:""});this.mba&&0!==this.LKa&&(this.mba.stopSpeechRecognition(),this.LKa=0);this.mba=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(ba,
this.CSk,ha,null,new H.a);return this.mba?!0:(B.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}CUh(){this.mba&&(0===this.LKa?(this.mba.startSpeechRecognition(),this.LKa=2):1===this.LKa&&(this.mba.resumeSpeechRecognition(),this.LKa=2))}d6l(){this.mba&&(this.mba.stopSpeechRecognition(),this.LKa=0)}mfl(){this.mba&&(this.mba.pauseSpeechRecognition(),this.LKa=1)}setCustomSetting(ba,ha){this.mba&&this.mba.setCustomSetting(ba,ha)}C7d(){return Object.assign(new W,{speechMode:C.speechMode,
sourceLanguage:C.sourceLanguage,targetLanguages:C.targetLanguages,speechFDBase:C.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new A,{docId:C.docId,podsSessionId:C.podSessionId,userDataCenterClusterId:C.y5h,webServiceBase:C.webServiceBase}),userSessionId:C.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(L.a)(P,"PPTSpeechClientProxy",null,[]);var U;(function(ba){ba[ba.none=0]="none";ba[ba.singleLineRibbon=1]="singleLineRibbon";
ba[ba.multipleLineRibbon=2]="multipleLineRibbon";ba[ba.slideShowToolbar=3]="slideShowToolbar";ba[ba.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";ba[ba.liveBroadcast=5]="liveBroadcast"})(U||(U={}));Object(L.b)("TranscriptionEntryPoint",U);var Q=d(688),G=d(69);d.d(V,"a",function(){return Y});class Y{constructor(){this.zf=this.oba=this.hE=this.pjb=this.Vs=this.jb=this.ka=this.Zb=this.Mc=null;this.bIb=!1;this.xm=null;this.zjb=this.Roc=0;this.ZWg=!1;this.PKa=this.OKa="";this.$cd=!1;this.bPe=
"";this.JDe=0;this.AHb=this.A2=this.UKb="";this.vP=null;this.Aya={};this.Moa=new F;this.Zaa=new P(this.Moa);Y.vak()}init(ba,ha,ka,ca,ia,oa,sa){m.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.zf=ha;this.ka=ba;this.Mc=ka;this.jb=ca;this.xm=ia;this.Zb=oa;this.vP=sa;this.Vs=document.createElement("div");this.Vs.id="SubtitleContainer";this.Vs.className="SubtitleContainer";this.Vs.style.display=G.a.kf;this.Vs.style.visibility=G.a.Vt;this.pjb=document.createElement("div");this.pjb.id="SubtitleResultDiv";
this.pjb.className="SubtitleResultDiv";this.Mc.Lkj&&(this.pjb.style.direction="rtl");this.hE=document.createElement("span");this.hE.id="SubtitleResultSpan";this.hE.className="SubtitleResultSpan";this.hE.setAttribute("aria-hidden","true");this.oba=document.createElement("span");this.oba.id="SubtitleAccessibilitySpan";this.oba.className="SubtitleAccessibilitySpan";this.oba.innerText="";this.oba.setAttribute("lang",this.Mc.rBa);this.oba.setAttribute("aria-live","assertive");this.oba.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.oba.setAttribute("aria-atomic","true");this.pjb.appendChild(this.hE);this.pjb.appendChild(this.oba);this.Vs.appendChild(this.pjb);this.zf.appendChild(this.Vs);k.a.instance.xb(this.hE,()=>!1);e.AFrameworkApplication.fa.sY?this.Pn():e.AFrameworkApplication.fa.Ue(Object(r.a)(this,this.Pn,"onFullAppSettingsReady"))}Pn(){this.UKb=this.getUserId();this.A2=e.AFrameworkApplication.fa.Ea("TenantId");this.AHb=this.ka.hostAuthType||e.AFrameworkApplication.fa.Ea("HostAuthType")||
"Unknown"}getUserId(){let ba=e.AFrameworkApplication.fa.Ea("PptEditingUserId");n.a.Ta(ba)&&(ba=e.AFrameworkApplication.fa.Ea("LoggableUserId"),m.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",n.a.Ta(ba)));return ba}hAl(){this.Vs.style.display=G.a.kf;this.Vs.style.visibility=G.a.Vt}transcribe(ba,ha,ka,ca,ia,oa){this.YEb()&&(this.xm.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,Q.a.Knd),this.Roc=window.setTimeout(Object(r.a)(this,this.loe,
"hideSoundReminderNotification"),3E3));this.ojm(ha,ka,ca,this.Mc);this.Zaa&&(this.Zaa.microphoneDeviceId=this.vP.microphoneDeviceId);this.Mc.ji&&this.Zaa.rak()?(this.Aya.StartTime=oa,this.Aya.LastError="ErrorNone",this.Aya.EntryPoint=U[ia],this.Moa.Qxi(Object(r.a)(this,this.Tmh,"onFinalRecognitionTextHandler")),this.Moa.Yzi(Object(r.a)(this,this.xoh,"onPartialRecognitionTextHandler")),this.Moa.Lxi(Object(r.a)(this,this.hqh,"onSpeechProxyErrorHandler")),this.Moa.Mxi(Object(r.a)(this,this.iqh,"onSpeechProxyEventUpdateHandler")),
this.Moa.VAi(Object(r.a)(this,this.jqh,"onSpeechRecognitionStartedHandler")),this.Zaa.CUh(),this.Zaa.setCustomSetting("clientMetadata",JSON.stringify(this.hig())),this.hE.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.hE.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==ia),this.OOc(),this.jb.mOc(Object(r.a)(this,this.Zya,"onGetCurrentSlideDimensionsHandler")),this.jb.ySa(Object(r.a)(this,this.$pd,"onSlideChangedHandler"))):this.Ybf()}hig(ba){ba=void 0===ba?"":ba;const ha=
y.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),ka={};ka.userID=this.UKb;ka.tenantId=this.A2;ka.identityProvider=this.AHb;ka.audienceChannel="";ka.audienceGroup=ha.Ring||"Unknown";ka.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";ka.locale=this.ka.iMa||"Unknown";ka.wacHost=ha.Host||"Unknown";ka.wacDatacenter=ha.WACDatacenter||"Unknown";ka.livePragueSessionInfo=ba;return ka}Ybf(){this.Vs.style.display=G.a.kf;this.Vs.style.visibility=G.a.Vt;this.Zaa.d6l();this.Moa.HAl(Object(r.a)(this,
this.Tmh,"onFinalRecognitionTextHandler"));this.Moa.aCl(Object(r.a)(this,this.xoh,"onPartialRecognitionTextHandler"));this.Moa.CAl(Object(r.a)(this,this.hqh,"onSpeechProxyErrorHandler"));this.Moa.EAl(Object(r.a)(this,this.iqh,"onSpeechProxyEventUpdateHandler"));this.Moa.KCl(Object(r.a)(this,this.jqh,"onSpeechRecognitionStartedHandler"));this.jb.pvd(Object(r.a)(this,this.Zya,"onGetCurrentSlideDimensionsHandler"));this.jb.Dmb(Object(r.a)(this,this.$pd,"onSlideChangedHandler"));this.YEb()&&this.xm.instance.hide();
this.Aya.EndTime=Date.now();m.a.J(512495705,817,15,JSON.stringify(this.Aya,Y.ufm));this.Aya={};this.Mc.Wzb=!1}OOc(){let ba=3;this.Aya.LastPosition=this.Mc.Xw;"AboveSlide"===this.Mc.Xw&&this.Vs.style.visibility===G.a.AA?(this.Vs.style.display=G.a.q3,this.Vs.style.backgroundColor="black",this.Vs.style.bottom="auto"):"BelowSlide"===this.Mc.Xw&&this.Vs.style.visibility===G.a.AA?(this.Vs.style.display=G.a.q3,this.Vs.style.backgroundColor="black",this.Vs.style.bottom="3%",ba=-1):"TopOverlay"===this.Mc.Xw?
(this.Vs.style.display=G.a.q3,this.Vs.style.backgroundColor="transparent",this.Vs.style.bottom="auto",ba=5):"BottomOverlay"===this.Mc.Xw&&(this.Vs.style.display=G.a.q3,this.Vs.style.backgroundColor="transparent",this.Vs.style.bottom="5%",ba=-1);this.bIb&&document.getElementById("LiveURLBarLayerHost")?this.Vs.style.top=-1<ba?String.format("calc({0}% + {1})",ba.toString(),"26px"):"auto":(this.Vs.style.top=-1<ba?ba.toString()+"%":"auto",this.TMf())}isVisible(){return this.Vs.style.visibility===G.a.AA}IYh(ba,
ha){ha=void 0===ha?"":ha;C.X2f=ba?["Live","Subtitles"]:["Subtitles"];this.bIb=ba;this.setVisibility(this.Vs.style.visibility===G.a.AA);this.OOc();this.Zaa.setCustomSetting("clientMetadata",JSON.stringify(this.hig(ha)));this.Zaa.setCustomSetting("slideIndex",this.JDe);this.Zaa.setCustomSetting("currentSpeechModes",JSON.stringify(C.X2f))}Bia(ba){this.Vs.style.cursor=ba?"default":"none"}TMf(){this.hE.style.fontSize=Math.floor(this.Vs.clientHeight/2/1.5).toString()+"px";this.bPe=Math.floor(this.Vs.clientHeight/
12-2)+"px";this.hE.style.display="inline"}setVisibility(ba){this.Vs?(null===ba&&(ba=this.Vs.style.visibility===G.a.Vt),this.Vs.style.visibility=ba?G.a.AA:G.a.Vt):m.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}Zya(){this.TMf()}$pd(ba,ha){this.JDe=ha.slideIndex;this.Zaa.Zqk()&&this.bIb&&(this.Zaa.setCustomSetting("currentSlideIndex",this.JDe),m.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(ba){ba?
(this.Zaa.mfl(),this.kwc(),this.$cd=!0,this.Zb&&this.Zb.instance&&this.Zb.instance.zMh()):(this.Zaa.CUh(),this.Zb&&this.Zb.instance&&this.Zb.instance.AMh())}loe(){this.YEb()&&(window.clearTimeout(this.Roc),this.xm.instance.hide())}ojm(ba,ha,ka,ca){C.sourceLanguage=ca.hra;C.targetLanguages=ca.Mpb;C.podSessionId=ba;C.y5h=ha;C.docId=ka;C.webServiceBase=this.ka.podsWebServiceBase;C.speechFDBase=e.AFrameworkApplication.fa.Ea("715");ba=!!this.Zb&&!!this.Zb.instance&&(this.Zb.instance.cVa||this.Zb.instance.Xr);
C.speechMode=this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.OFa||ba?"Live":"Subtitles"}r6f(ba,ha){this.ZWg||(this.hE.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.zjb),this.hE.innerText=this.vQj(ba,ha),this.hE.scrollTop=this.hE.scrollHeight,this.zjb=window.setTimeout(Object(r.a)(this,this.kwc,"resetSubtitlesToEmpty"),1E4),ha&&(this.oba.innerText=ba,this.oba.focus()),this.hE.style.padding=n.a.Ta(ba)?"0px":this.bPe)}uw(ba){this.ZWg||(this.hE.style.color="rgba( 255, 255, 0, 1 )",
n.a.Ta(ba)&&(ba=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.zjb),this.hE.innerText="["+ba+"]",this.hE.scrollTop=this.hE.scrollHeight,this.zjb=window.setTimeout(Object(r.a)(this,this.kwc,"resetSubtitlesToEmpty"),1E4),this.hE.style.padding=this.bPe,this.oba.innerText="",this.oba.focus())}E_j(ba){if(null!==ba)switch(ba){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.uw(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.Aya.LastError=
"MicrophoneError";break;case "FailedToConnect":this.uw(ResourceStrings.L_SubtitleRetryErrorMessage);this.Aya.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.uw(ResourceStrings.L_SubtitleGenericErrorMessage);this.Aya.LastError="FailedToCreateSpeechSession";break;default:m.a.J(512495703,830,15,"HandleSpeechProxyError {0}",ba)}}Tmh(ba,ha){this.Vs.style.visibility!==G.a.Vt&&this.r6f(ha[this.Mc.Mpb],!0)}xoh(ba,ha){this.Vs.style.visibility!==G.a.Vt&&this.r6f(ha[this.Mc.Mpb],
!1)}hqh(ba,ha){m.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",ha);(ba=ha.toString())&&(-1<ba.indexOf("NotAllowedError")||-1<ba.indexOf("NotFoundError")||-1<ba.indexOf("NotReadableError")||-1<ba.indexOf("MicrophoneError"))&&this.YEb()&&this.xm.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,Q.a.$0a);this.E_j(ba)}jqh(ba,ha){({SlideShowCoreFrame:ba}=d(740));const {SlideshowFrame:ka}=d(1041);m.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",ha.toString());Object(w.a)(ba,
this.jb)?Object(D.a)(ba,this.jb).rqd(ha.toString()):Object(w.a)(ka,this.jb)&&this.ka.osd&&Object(D.a)(ka,this.jb).rqd(ha.toString());this.kwc();this.YEb()&&this.xm.instance.hide()}iqh(ba,ha){if(this.YEb())switch(ba=ha.eventName,ba){case "MediaEvent":"AudioDeviceConnected"===ha.mediaStatus&&this.xm.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,Q.a.Knd);break;case "ConnectionRetry":this.xm.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,Q.a.$0a);this.uw(ResourceStrings.L_SubtitleGenericErrorMessage);
break;case "QualityStatusUpdate":const ka=ha.shortCode;ba=ha.longCode;const ca=ha.shortString,ia=ha.longString;switch(ha.severity){case 0:this.xm.instance.hide();break;case 1:(ha=0<ka?Y.ZZ[ka]:ca)&&this.xm.instance.show(ha,Q.a.QLb);break;case 2:(ha=0<ka?Y.ZZ[ka]:ca)&&this.xm.instance.show(ha,Q.a.$0a),ha=null===ba?ia:Y.ZZ[ba],n.a.Ta(ha)||(window.clearTimeout(this.zjb),this.uw(ha),this.zjb=window.setTimeout(Object(r.a)(this,this.kwc,"resetSubtitlesToEmpty"),3E4))}break;default:m.a.J(512495700,830,50,
"OnSpeechProxyEventUpdateHandler Event {0}",ba)}}YEb(){return this.ka.pptEditorVoiceUXEnabled&&!!this.xm&&!!this.xm.instance}kwc(){this.hE.style.color="rgba( 255, 255, 255, 1 )";this.hE.innerText="";this.hE.scrollTop=this.hE.scrollHeight;this.PKa=this.OKa="";this.$cd=!1;this.zjb=0;this.hE.style.padding="0px"}vQj(ba,ha){this.$cd?this.ZDi(ba):this.TDl(ba);this.$cd=ha;return n.a.Ta(this.OKa)||n.a.Ta(this.PKa)?n.a.Ta(this.OKa)?this.PKa:this.OKa:this.OKa+"\n"+this.PKa}ZDi(ba){this.OKa=n.a.Ta(this.PKa)?
this.OKa:this.PKa;this.PKa=ba}TDl(ba){n.a.Ta(this.OKa)||n.a.Ta(this.PKa)?this.OKa=ba:this.PKa=ba}static get instance(){return Y.Tl}static vak(){Y.ZZ[1]=ResourceStrings.L_SubtitleDetection_Listening;Y.ZZ[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Y.ZZ[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Y.ZZ[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;Y.ZZ[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static ufm(ba,ha){return"undefined"===typeof ha?
null:ha}}Y.ZZ=Array(20);Y.Tl=new Y;Object(L.a)(Y,"SlideshowSubtitles",null,[1041])},1046:function(L,V,d){L=d(0);var k=d(25),e=d(55),n=d(54),r=d(276),w=d(315);class D{constructor(Qa,Ua){this.Nji=Qa;this.cU=(void 0===Ua?null:Ua)||w.a.Qhe(e.a.d$a,"")}get pv(){return this.Nji}get Qb(){return this.cU}X7e(Qa){this.Qb.d++;return this.pv.X7e(Qa)}yRb(Qa){this.Qb.e++;return this.pv.yRb(Qa)}fJ(Qa){this.Qb.f++;return this.pv.fJ(Qa)}p3a(Qa){this.Qb.h++;return this.pv.p3a(Qa)}n_(Qa){this.Qb.i++;return this.pv.n_(Qa)}l_(Qa){this.Qb.j++;
return this.pv.l_(Qa)}O7(Qa){this.Qb.k++;return this.pv.O7(Qa)}m_(Qa){this.Qb.l++;return this.pv.m_(Qa)}P7e(Qa){this.Qb.m++;return this.pv.P7e(Qa)}wAa(Qa,Ua){this.Qb.n++;return this.pv.wAa(Qa,void 0===Ua?!1:Ua)}yme(){this.Qb.o++;return this.pv.yme()}Iaf(){this.Qb.p++;return this.pv.Iaf()}OQb(Qa){this.Qb.m++;return this.pv.OQb(Qa)}Jr(Qa){this.Qb.q++;return this.pv.Jr(Qa)}Pqa(Qa){this.Qb.r++;return this.pv.Pqa(Qa)}iRb(Qa){this.Qb.g++;return this.pv.iRb(Qa)}rzd(Qa){return this.pv.rzd(Qa)}w3a(Qa){this.Qb.s++;
return this.pv.w3a(Qa)}Xyd(Qa){this.Qb.s++;return this.pv.Xyd(Qa)}via(Qa){this.Qb.s++;return this.pv.via(Qa)}v3a(Qa){this.Qb.s++;return this.pv.v3a(Qa)}$nb(Qa){this.Qb.t++;return this.pv.$nb(Qa)}szd(Qa){this.Qb.u++;return this.pv.szd(Qa)}yxc(Qa){this.Qb.v++;return this.pv.yxc(Qa)}Sqa(Qa){return this.pv.Sqa(Qa)}uyd(Qa){this.Qb.z++;return this.pv.uyd(Qa)}G4e(){return this.pv.G4e()}BNa(Qa,Ua){this.Qb.w++;this.Qb.x++;return this.pv.BNa(Qa,Ua)}j_(Qa){this.Qb.y++;return this.pv.j_(Qa)}o3a(Qa){this.Qb.z++;
return this.pv.o3a(Qa)}clearFormatting(){return this.pv.clearFormatting()}clone(){return new D(this.pv.clone(),this.Qb)}}Object(L.a)(D,"FormattingStewardUsageCollector",null,[1853]);class y extends D{constructor(Qa,Ua){super(Qa,void 0===Ua?null:Ua)}get n7(){return this.pv}get oF(){return this.n7.oF}set oF(Qa){this.n7.oF=Qa}get textIndent(){return this.n7.textIndent}get marginLeft(){return this.n7.marginLeft}get Pqd(){return this.n7.Pqd}get lineSpacing(){return this.n7.lineSpacing}get Fia(){return this.n7.Fia}get q$c(){return this.n7.q$c}get Tha(){return this.n7.Tha}get paragraph(){return this.n7.paragraph}set paragraph(Qa){this.n7.paragraph=
Qa}get Jbb(){return this.n7.Jbb}SDd(Qa){return this.n7.SDd(Qa)}Off(Qa){return this.n7.Off(Qa)}clone(){const Qa=this.pv.clone();return new y(Qa,this.Qb)}}Object(L.a)(y,"FormattingStewardUsageCollector",D,[1852,1853]);var m=d(33),C=d(77),E=d(184),F=d(687),B=d(53),H=d(148),K=d(73),A=d(59),W=d(318),N=d(1135),P=d(346),U=d(46),Q=d(1273),G=d(1266),Y=d(1267),ba=d(112),ha=d(40),ka=d(81),ca=d(42),ia=d(39),oa=d(87),sa=d(307);class Ca{}Ca.yellow="FFFF00";Ca.lime="00FF00";Ca.aqua="00FFFF";Ca.fuchsia="FF00FF";
Ca.blue="0000FF";Ca.red="FF0000";Ca.navy="000080";Ca.teal="008080";Ca.green="008000";Ca.purple="800080";Ca.maroon="800000";Ca.olive="808000";Ca.gray="808080";Ca.n3l="C0C0C0";Ca.black="000000";Object(L.a)(Ca,"FontHighlightColorEnum",null,[]);var Ta=d(349),R=d(50),Ha=d(910),da=d(376),Ba=d(107);class za{constructor(Qa,Ua,Ya,Ea,La,xb,dc,gb,gc,Ac){gc=void 0===gc?null:gc;Ac=void 0===Ac?!1:Ac;this.dw=this.DJc=null;this.J_b=0;this.kpf=this.I_b=null;this.f0=0;this.tRa=this.XLc=this.hIc=this.DLc=this.u7a=this.ika=
this.uIc=this.hMc=null;this.N3f=.25*ba.Font.OJ;this.paragraph=Qa;this.Sf=Ua;this.YL=Ya;this.NQ=Ea;this.Gja=La;this.$W=xb;this.Z_=dc;this.A6a=gb;gc?(Ba.a(4223818,307,!!gc.dw),this.dw=gc.dw.XRc(this.paragraph),this.J_b=gc.J_b,this.I_b=gc.I_b,gc.ika&&(this.ika=new Ha.a,this.ika.Pr.value=gc.ika.Pr.value,this.ika.Rr.value=gc.ika.Rr.value),gc.u7a&&(this.u7a=gc.u7a.clone()),this.f0=gc.f0,this.XLc=gc.XLc.clone(),this.hMc=gc.hMc,this.uIc=gc.uIc,this.DLc=gc.DLc,this.hIc=gc.hIc,gc.Tha&&(this.tRa=gc.Tha)):(this.dw=
new sa.a(this.paragraph,0),this.dw.formatting=new Ta.a(this.dw,W.a.nil),Ua=R.a.STa(Qa),Ua=this.NQ.yt(Ua),this.zPl(Ua),za.XZl(Qa)?(this.Gja.S7e(this.dw.formatting,Ua,Ac),Qa.Qa(ha.a.tm)?this.f0=Qa.$a(ha.a.tm):this.f0=0):this.f0=-1,this.J_b=0,this.I_b=null,this.ika=this.kzj(),this.A6a&&(this.ika=this.Gja.dY(Qa),this.u7a=this.Gja.uie(Qa),this.DLc=this.Gja.mWa(Qa),this.hIc=this.Gja.o$(Qa)),this.XLc=new N.DictionaryPropertySet,this.Gja.E7e(this.dw.formatting,Qa,Ac))}get paragraph(){return this.DJc}set paragraph(Qa){Ba.a(4223816,
307,!!Qa&&m.ParagraphReader.ke(Qa));this.DJc=Qa}get Jbb(){return this.dw.formatting}get psc(){return this.J_b}get Ksh(){return this.I_b}get D0(){return this.kpf}get oF(){return this.f0}set oF(Qa){Ba.a(4223817,307,1===Qa||2===Qa||3===Qa||ia.a.instance.ga(54)&&6===Qa);this.f0=Qa}get textIndent(){return this.hMc}get marginLeft(){return this.uIc}get Pqd(){return this.ika}get lineSpacing(){return this.u7a}get Fia(){return this.DLc}get q$c(){return this.hIc}get Tha(){return this.tRa}zPl(Qa){const Ua=this.NQ.language(Qa);
Ua&&this.Sf.wxc(this.dw.formatting,Ua,0,Qa.cache.WXa,!1)}kzj(){if(ia.a.instance.ga(54))return null;const Qa=new Ha.a;Qa.Pr.value=this.N3f;Qa.Rr.value=this.N3f;return Qa}X7e(Qa){(Qa=r.a.Oe(Qa))&&this.Sf.q3a(this.dw.formatting,Qa.LCID);return!0}yRb(){return!1}fJ(Qa){this.Sf.fJ(this.dw.formatting,Qa);return!0}p3a(Qa){this.Sf.setItalic(this.dw.formatting,Qa);return!0}n_(Qa){this.Sf.n_(this.dw.formatting,Qa);return!0}l_(Qa){this.Sf.l_(this.dw.formatting,Qa);return!0}O7(Qa){this.Sf.O7(this.dw.formatting,
Qa);return!0}m_(Qa){this.Sf.m_(this.dw.formatting,Qa);return!0}P7e(Qa){if(0>=Qa)return!1;this.Sf.$q(this.dw.formatting,Qa);return!0}wAa(Qa,Ua){if(!Qa||""===Qa)return!1;var Ya=P.FontUtils.Lem(Qa);({fontInfo:Ea}=Ya);if(Ya.returnValue)return this.Sf.rW(this.dw.formatting,Ea.fontName),!0;var Ea=!1;Ya=P.FontUtils.gH(Qa);Ua&&this.igc(Ya,this.$W)&&(this.$W.createFontUrl(Qa),Ea=!0);this.igc(Ya,this.Z_)&&(Ea=!0);Ea&&this.Sf.rW(this.dw.formatting,Ya);return Ea}igc(Qa,Ua){return!!Ua&&Ua.isEnabled&&Ua.igc(Qa)}yme(){this.Sf.c3c(this.dw.formatting);
return!0}Iaf(){this.Sf.YAd(this.dw.formatting);return!0}OQb(Qa){if(0>=Qa)return!1;this.Sf.OQb(this.dw.formatting,Qa);return!0}Jr(Qa){var {Box4PasteSteward:Ua}=d(253);if(!this.Sf.mFg(Qa)){if(null===Qa||""===Qa)return!1;Qa=Ua.dab(Qa)}Ua=null;this.Tha&&this.Tha.hasOwnProperty(ca.a.listLevel.id.toString())&&(Ua=this.Tha[ca.a.listLevel.id.toString()]);this.Sf.Jr(this.dw.formatting,Qa,Ua);return!0}Pqa(Qa){const {Box4PasteSteward:Ua}=d(253);if(!Qa||""===Qa||ia.a.instance.ga(49)&&!za.ISj().contains(Qa)||
this.Gja.DQh(this.dw.formatting))return!1;this.Sf.Pqa(this.dw.formatting,Ua.dab(Qa));return!0}o3a(Qa){this.Sf.o3a(this.dw.formatting,Qa);return!0}iRb(Qa){this.Sf.iRb(this.dw.formatting,Qa);return!0}rzd(Qa){let Ua=0;switch(U.a.Dg(Qa)){case "small-caps":Ua=1;break;case "uppercase":Ua=2}this.Sf.un(this.dw.formatting,ka.a.capitalization,Ua);return!0}uyd(Qa){const {Box4PasteSteward:Ua}=d(253);if(!Qa||""===Qa)return!1;this.XLc.setValue(ha.a.Y4b,parseInt(Ua.dab(Qa),16));return!0}v3a(Qa){return 0>=Qa?!1:
this.Xyd(oa.StyleReader.bOj(Qa))}w3a(Qa){this.clearFormatting();this.J_b=Qa;return!0}Xyd(Qa){const {Box4PasteSteward:Ua}=d(253);return Qa&&0<Qa.length&&Ua.PSb&&Ua.PSb.gI(Qa)?(this.I_b=Qa,!0):!1}via(Qa){const {Box4PasteSteward:Ua}=d(253);return Qa&&0<Qa.length&&Ua.PSb&&Ua.PSb.gI(Qa)?(this.kpf=Qa,!0):!1}Off(Qa){if(this.D0){Qa=d(253).Box4PasteSteward.PSb||oa.StyleReader.EM(Qa);if(!Qa)return Ba.a(41968715,307,!1),!1;(Qa=Qa.gI(this.D0))&&this.Sf.via(this.dw.formatting,Qa);return!0}return!1}BNa(Qa,Ua){if(ia.a.instance.ga(54))return!1;
Ba.a(5297416,307,0<=Qa&&0<=Ua);0<=Qa&&(this.ika.Rr.value=Qa);0<=Ua&&(this.ika.Pr.value=Ua);return 0<=Qa||0<=Ua}j_(Qa){if(!ia.a.instance.ga(54)||!Qa)return!1;const Ua=parseFloat(U.a.substring(Qa,0,U.a.Dg(Qa).indexOf("px")));if(!isNaN(Ua))return this.u7a=new da.a(3,Q.a.Wha(Ua,1)),!0;Qa=parseFloat(U.a.substring(Qa,0,U.a.Dg(Qa).indexOf("%")));return isNaN(Qa)?!1:(this.u7a=new da.a(2,Qa/100),!0)}$nb(Qa){let Ua=0;if(!Qa||""===Qa)return!1;switch(Qa){case "left":Ua=1;break;case "center":Ua=2;break;case "right":Ua=
3;break;case "justify":ia.a.instance.ga(54)&&(Ua=6)}if(0===Ua)return!1;this.oF=Ua;return!0}szd(Qa){this.hMc=Qa;return!0}yxc(Qa){this.uIc=Qa;return!0}Sqa(Qa){this.tRa=JSON.parse(Qa);return this.Tha?!0:!1}clearFormatting(){this.dw.formatting=new Ta.a(this.dw,W.a.nil);return!0}G4e(){this.f0=0;return!0}SDd(Qa){var {Box4PasteSteward:Ua}=d(253);if(!ia.a.instance.ga(71))return!1;if(0<this.psc&&Ua.VLa[this.psc]){Ba.a(4223819,307,1<=this.psc);Ba.a(4223820,307,7>=this.psc);Ua=oa.StyleReader.EM(Qa);if(!Ua)return Ba.a(4223821,
307,!1),!1;Ua=Ua.gI(d(253).Box4PasteSteward.VLa[this.psc]);this.YL.mca(Ua,Qa,!1);return!0}if(this.Ksh){Ua=d(253).Box4PasteSteward.PSb||oa.StyleReader.EM(Qa);if(!Ua)return Ba.a(41968716,307,!1),!1;this.YL.mca(Ua.gI(this.Ksh),Qa,!1);return!0}return!1}clone(){return new za(this.paragraph,this.Sf,this.YL,this.NQ,this.Gja,this.$W,this.Z_,this.A6a,this)}static ISj(){za.bR||(za.bR=new G.a(Y.a.gl()),za.bR.add(Ca.yellow),za.bR.add(Ca.lime),za.bR.add(Ca.aqua),za.bR.add(Ca.fuchsia),za.bR.add(Ca.blue),za.bR.add(Ca.red),
za.bR.add(Ca.navy),za.bR.add(Ca.teal),za.bR.add(Ca.green),za.bR.add(Ca.purple),za.bR.add(Ca.maroon),za.bR.add(Ca.olive),za.bR.add(Ca.gray),za.bR.add(Ca.n3l),za.bR.add(Ca.black));return za.bR}static XZl(Qa){if(!ia.a.instance.ga(71))return!0;Qa=oa.StyleReader.GR(oa.StyleReader.iF(Qa));return Qa===oa.StyleReader.W5h||Qa===oa.StyleReader.dPa||Qa===oa.StyleReader.Z5h||Qa===oa.StyleReader.lra}}za.bR=null;Object(L.a)(za,"FormattingSteward",null,[1852,1853]);class Aa{agf(){return!1}Ume(Qa){return Qa}Sqa(){}gRb(){}k7c(){return!1}get h8c(){return!1}j_(){}BNa(){}DNh(){}tMh(){}get GQh(){return!1}}
Object(L.a)(Aa,"NoOpPasteStewardBridge",null,[1752]);var na=d(18);class la{constructor(Qa,Ua){this.D0k=Qa;this.E0k=Ua||"Normal"}}Object(L.a)(la,"NoteTagInfoBox4",null,[]);const va=Qa=>{const Ua=new na.a;for(const Ya of Qa)Qa=new la(Ya.D0k,Ya.E0k),Ua.add(Qa);return Ua};d.d(V,"a",function(){return Pa});class Pa{constructor(Qa,Ua,Ya,Ea){Ya=void 0===Ya?null:Ya;Ea=void 0===Ea?null:Ea;this.Z_=this.$W=null;this.cqj=k.AFrameworkApplication.fa.getBooleanAppSetting("FollowDestinationFormattingPasteIsEnabled");
this.iCf=0;this.Cb=Qa;this.IH=Ua;this.N_=Ea||new Aa;this.cU=Ya||w.a.Qhe(e.a.d$a,"")}get Qb(){return this.cU}get characterPropertiesEditor(){return Pa.Ch||(Pa.Ch=n.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get aGa(){return this.$W||(this.$W=n.a.instance.ub("Box4.IFontService"))}get hFa(){return this.Z_||(this.Z_=n.a.instance.ub("Box4.CustomFontService"))}reset(){}get B7b(){return this.Zge(!1)}Zge(Qa){Ba.a(4223770,307,A.OutlineElementReader.vh(this.Cb));const Ua=B.OutlineElementNavigator.Ti(this.Cb);
B.OutlineElementNavigator.$e(this.Cb);Ba.a(4223771,307,!!Ua&&m.ParagraphReader.ke(Ua));Qa=new za(Ua,Pa.Eh,Pa.zQ,Pa.Qqj,Pa.Rqj,this.aGa,this.hFa,this.cqj,void 0,Qa);return new y(Qa,this.Qb)}K2(){}Ppa(){}p1a(){}Opa(){}Npa(){}Xya(){}Wya(){}zB(){}yB(){}l1a(){}k1a(){}bza(){}LLa(){}Spa(){}Qpa(){}aza(){}Rpa(){}m1a(){}tLb(Qa){A.OutlineElementReader.vh(this.Cb)?(Pa.zi.Sdc(this.Cb,!0),B.OutlineElementNavigator.XK(this.Cb,!1,!1)):K.OutlineReader.Wu(this.Cb)?H.OutlineNavigator.Gba(this.Cb)?Qa?(this.Cb.rj(),Pa.$C.uX(this.Cb,
!1)):Pa.zi.Fvc(this.Cb):Pa.$C.uX(this.Cb,!1):Ba.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Cb.Zi)}YVa(Qa){let Ua=null;if(Qa&&Qa.$V&&Qa.cultureName)try{Ua=Object.assign(new F.a,{languageId:r.a.Oe(Qa.cultureName).LCID})}catch(Ya){Ba.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Qa.cultureName,Ya)}Ua||null==this.IH||(Ua=Object.assign(new F.a,{languageId:this.IH}));return Ua}get NN(){return this.iCf}set NN(Qa){this.iCf=Qa}wPc(){}BDd(){}S4d(){}get bab(){return!1}get uab(){return!1}Nwk(Qa){let Ua=
1;if(Qa.eDg){var Ya=0;switch(Qa.listStyleType){case 1:Ua=0;break;case 7:Ua=1;break;case 8:Ua=2;break;case 9:Ua=3;break;case 10:Ua=4;break;case 11:Ua=5}}else switch(Ya=1,Qa.listStyleType){case 1:Ua=0;break;case 3:Ua=1;break;case 4:Ua=2;break;case 5:Ua=3}let Ea;Ya=(Ea=C.ListReader.mbb)?E.a.JO(Ya,Ua,va(Qa.u7),Qa.listId,Qa.listLevel,Qa.levelText,Qa.font):E.a.JO(Ya,Ua,va(Qa.u7));Qa.eDg&&!Qa.Dek&&(Ya.EB=Ea&&0<Qa.listId&&0<=Qa.listLevel&&!Qa.aNb?Qa.r5l:Qa.O8i);this.N_.gRb(this.Cb,Ya,Qa);return Ya}SZ(){}PZ(){}RZ(){}QZ(){}OZ(){}NZ(){}static get zi(){return Pa.Rj||
(Pa.Rj=n.a.instance.resolve("Box4.IOutlineElementEditor"))}static get $C(){return Pa.Wy||(Pa.Wy=n.a.instance.resolve("Box4.IOutlineEditor"))}static get Eh(){return Pa.Sf||(Pa.Sf=n.a.instance.resolve("Box4.IFormattingEditor"))}static get zQ(){return Pa.YL||(Pa.YL=n.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Qqj(){return Pa.NQ||(Pa.NQ=n.a.instance.resolve("Box4.IFormattingReader"))}static get Rqj(){return Pa.Gja||(Pa.Gja=n.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}
Pa.Rj=null;Pa.Wy=null;Pa.Ch=null;Pa.Sf=null;Pa.YL=null;Pa.NQ=null;Pa.Gja=null;Object(L.a)(Pa,"Box4PasteStewardBase",null,[1846,1847,1832])},1048:function(L,V,d){d.r(V);L=d(0);var k=d(736),e=d(1067),n=d(1054),r=d(197),w=d(7),D=d(40),y=d(73),m=d(32),C=d(38),E=d(27),F=d(41);class B{constructor(Y,ba){this.Ae=Y;this.rg=ba}}Object(L.a)(B,"RowSpan",null,[]);class H{constructor(Y){this.UC=Y;this.KKa=[]}yZd(Y,ba){Array.add(this.KKa,new B(Y,ba))}nIl(Y){for(let ba=0;ba<this.KKa.length;ba++){const ha=this.KKa[ba];
Y<=ha.Ae&&ha.Ae++;Y<=ha.rg&&ha.rg++}}get x(){return this.UC}get SHh(){return this.KKa}static $ye(Y,ba){return Y.UC===ba}static b6d(Y,ba){Y=Y.UC-ba.UC;return 0<Y?1:0>Y?-1:0}}Object(L.a)(H,"ColSplit",null,[]);const K=(Y,ba,ha)=>{let ka;ka=-1;for(let ca=0;ca<Y.length;++ca)if(ha(Y.ga(ca),ba))return ka=ca,{returnValue:!0,MCb:ka};return{returnValue:!1,MCb:ka}};class A{constructor(Y,ba){this.qe=Y;this.hg=ba}}Object(L.a)(A,"ColSpan",null,[]);class W{constructor(Y){this.VC=Y;this.KKa=[]}yZd(Y,ba){Array.add(this.KKa,
new A(Y,ba))}FVi(Y){for(let ba=0;ba<this.KKa.length;ba++){const ha=this.KKa[ba];Y<=ha.qe&&ha.qe++;Y<=ha.hg&&ha.hg++}}get kYf(){return this.KKa}get y(){return this.VC}static $ye(Y,ba){return Y.VC===ba}static b6d(Y,ba){Y=Y.VC-ba.VC;return 0<Y?1:0>Y?-1:0}}Object(L.a)(W,"RowSplit",null,[]);var N=d(979),P=d(28);class U{constructor(Y,ba,ha,ka,ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za){this.MXa=!1;this.Ni=this.mRc=this.Kch=this.nkd=null;this.u0h=Y;this.$c=ba;this.UTh=ha;this.a4a=ka;this.bGd=ca;this.tableNode=ia;this.Xd=
oa;this.w_=sa;this.YVa=Ca;this.oIl=Ta;this.GVi=R;this.Jwd=Ha;this.gSc=da;this.rows=Ba;this.cols=za;this.b4a=0;this.ggc=!1}a$a(Y){this.nkd=new Date;this.Kch=Y}Zab(){this.nkd>P.App.Xn&&this.$c&&this.$c.Wa(this.Kch,(+new Date-+this.nkd).toString());this.nkd=P.App.Xn}finish(){const {TableMergeSplitEditor:Y}=d(1048);this.$c&&(this.Ni&&(this.ggc=!1,this.$c.Wa(Y.Eum,this.Ni.message)),this.$c.Wa("SplitCellsSucceeded",this.ggc.toString()),this.$c.finish(),this.$c=null);if(this.Ni)throw this.Ni;this.UTh&&this.UTh(this.ggc,
this.a4a)}}Object(L.a)(U,"SplitCellsArguments",null,[]);var Q=d(336);d.d(V,"TableMergeSplitEditor",function(){return G});class G{constructor(Y,ba,ha,ka,ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za){this.Ub=Y;this.xZ=ba;this.vB=ha;this.b7=ka;this.ykd=ca;this.jN=ia;this.Shd=oa;this.Er=Ca;this.sga=Ta;this.hib=R;this.Hl=Ha;this.Eb=da;this.oa=Ba;this.zjd=za}merge(Y,ba,ha){const ka=Y.tf(ba.Ae,ba.qe),ca=this.Ub.Pc(ka);let ia=ca.tC(1);const oa=[C.a.rowId,C.a.cellId];ia&&ca.Dc();let sa=!0;for(let Ta=ba.Ae;Ta<ba.rg;++Ta){let R=
Y.tf(Ta,ba.qe);for(let Ha=ba.qe+(Ta===ba.Ae?1:0);Ha<ba.hg;++Ha)if(Ha!==ba.qe&&(R=Y.tf(Ta,Ha)),!R||!R.isGhostCell){R.Vo(C.a.rowSpan,C.a.colSpan);R.isGhostCell=!0;var Ca=m.GraphIterator.ob(R);y.OutlineReader.isEmpty(Ca)?this.KCh(Ca):(sa&&y.OutlineReader.isEmpty(ca)&&(sa=!1,ia=null,this.KCh(ca)),this.jN.vqj(R,da=>{this.jN.fz(ca.currentNode,da,oa);return!0},da=>11===da.type||22===da.type||12===da.type),Ca=this.Ub.Whe(Ca),Ca.Gb(1),this.jN.IYk(ca,ia,Ca.role,Ca.role,Ca),Ca.eCb(1),ia=Ca.currentNode)}}this.b7.ihm(ha,
ka,ba);ka.rowSpan=ba.hQ;ka.colSpan=ba.NS;Y.setValue(C.a.complexTable,!0);this.Shd.e3e(Y);Y.Pfa(511);this.vB.Xdc(Y);return ka}y4l(Y,ba,ha,ka,ca,ia,oa,sa,Ca){if(1>=ha&&1>=ka)Ca&&Ca(!0,ba);else{var Ta=new Date,R=F.a.Zj("SplitCells",1);R.tk=!0;var Ha=new k.a,da=new e.a,Ba=new e.a,za=this.sga.KFa(Y,ca,ba);ba=this.Er.pXc(ca,ba);var Aa=ia.Nng();for(ia=ia.ohg();za.moveNext();){Ha.add(za.Q$b().id.toString());var na=za.cB;for(var la=1;la<ha;la++){let va=Aa[na.Ae];va+=(Aa[na.rg]-va)*la/ha;let Pa;(()=>{let Qa=
K(da,va,W.$ye);({MCb:Pa}=Qa);return Qa})().returnValue||(Pa=da.length,da.add(new W(va)));da.ga(Pa).yZd(na.qe,na.hg)}for(la=1;la<ka;la++){let va=ia[na.qe];va+=(ia[na.hg]-va)*la/ka;let Pa;(()=>{let Qa=K(Ba,va,H.$ye);({MCb:Pa}=Qa);return Qa})().returnValue||(Pa=Ba.length,Ba.add(new H(va)));Ba.ga(Pa).yZd(na.Ae,na.rg)}}za=da.toArray();na=Ba.toArray();za.sort((va,Pa)=>W.b6d(Pa,va));na.sort((va,Pa)=>H.b6d(Pa,va));R.Wa("Prep",(+new Date-+Ta).toString());Ta=this.Eb.xe(15);Ta.mc(Y);Y=new U(Ta,R,Ca,ba,Ha,Y,
oa,ca,sa,Aa,ia,za,na,ha,ka);Y=new n.a(null,Object(w.a)(this,this.F4l,"splitRowSeams"),Y);Y.Bj=!1;Y.Fm("SplitTableCells");Y.Lh()}}F4l(Y,ba){try{for(ba.a$a("SplitRowSeams");ba.b4a<ba.Jwd.length;){const ha=(()=>{let ka=this.J1i(ba.tableNode,ba.Xd,ba.w_,ba.YVa,ba.oIl,ba.Jwd[ba.b4a]);({MXa:ba.MXa}=ka);return ka})().returnValue;ba.b4a++;if(ba.MXa){let ka;(ka=ba.a4a).rg=ka.rg+1;for(let ca=0;ca<ba.gSc.length;ca++)ba.gSc[ca].nIl(ha)}if(Y.ura)return!0}ba.Zab();ba.b4a=0;Y.sh(Object(w.a)(this,this.C4l,"splitColSeams"))}catch(ha){ba.Ni=
ha,Y.sh(Object(w.a)(this,this.mpb,"tearDownSplit"))}return!0}C4l(Y,ba){try{for(ba.a$a("SplitColSeams");ba.b4a<ba.gSc.length;){const ha=(()=>{let ka=this.I1i(ba.tableNode,ba.Xd,ba.w_,ba.YVa,ba.GVi,ba.gSc[ba.b4a]);({MXa:ba.MXa}=ka);return ka})().returnValue;ba.b4a++;if(ba.MXa){let ka;(ka=ba.a4a).hg=ka.hg+1;for(let ca=0;ca<ba.Jwd.length;++ca)ba.Jwd[ca].FVi(ha)}if(Y.ura)return!0}ba.Zab();ba.b4a=0;Y.sh(Object(w.a)(this,this.sUb,"updateIsComplexTableProperty"))}catch(ha){ba.Ni=ha,Y.sh(Object(w.a)(this,
this.mpb,"tearDownSplit"))}return!0}sUb(Y,ba){try{ba.a$a("UpdateComplex"),this.Shd.hhf(this.Ub.Pc(ba.tableNode)),ba.Zab(),ba.mRc=this.sga.KFa(ba.tableNode,ba.w_,ba.a4a),Y.sh(Object(w.a)(this,this.$oj,"fixSplitCells"))}catch(ha){ba.Ni=ha,Y.sh(Object(w.a)(this,this.mpb,"tearDownSplit"))}return!0}$oj(Y,ba){try{for(ba.a$a("FixInsideBorders");ba.mRc.moveNext();)if(ba.bGd.contains(ba.mRc.Q$b().id.toString())&&this.Zoj(ba.tableNode,ba.w_,ba.mRc,ba.rows,ba.cols),Y.ura)return!0;ba.Zab();Y.sh(Object(w.a)(this,
this.Shj,"ensureMinRowHeightColumnWidth"))}catch(ha){ba.Ni=ha,Y.sh(Object(w.a)(this,this.mpb,"tearDownSplit"))}return!0}Shj(Y,ba){try{ba.a$a("EnsureMinHeightWidth"),1<ba.rows&&this.Thj(ba.tableNode,ba.a4a),1<ba.cols&&this.Rhj(ba.tableNode,ba.a4a),ba.Zab(),Y.sh(Object(w.a)(this,this.setSelection,"setSelection"))}catch(ha){ba.Ni=ha,Y.sh(Object(w.a)(this,this.mpb,"tearDownSplit"))}return!0}setSelection(Y,ba){try{ba.a$a("SetSelection");ba.ggc=!ba.a4a.aVa();if(ba.ggc){const ha=this.zjd.z7i(ba.tableNode,
ba.w_,ba.a4a);ha&&this.oa.VF(ha)}ba.Zab();ba.a$a("Render");Y.Bj||ba.u0h.HMh(Y);ba.u0h.dispose();Y.sh(Object(w.a)(this,this.mpb,"tearDownSplit"))}catch(ha){ba.Ni=ha,Y.sh(Object(w.a)(this,this.mpb,"tearDownSplit"))}return!0}mpb(Y,ba){ba.Zab();ba.finish();return!1}J1i(Y,ba,ha,ka,ca,ia){var oa,sa=N.c(ca,ia.y);({Dwe:oa}=sa);sa=sa.returnValue;if(oa=!oa){sa++;var Ca=ca[sa-1],Ta=ca[sa],R=this.Ub.Pc(Y);this.iqc(R,sa-1);var Ha=R.currentNode;R=this.Shd.lqe(R);Ca=ia.y-Ca;Ha.setValue(C.a.wv,ba.Cf(Ca,1));Ca=Ta-
ia.y;R.setValue(C.a.wv,ba.Cf(Ca,1));Array.insert(ca,sa,ia.y);ha.tXa(3)}for(ba=0;ba<ia.kYf.length;++ba){ca=ia.kYf[ba];Ta=[];for(Ha=ca.qe;Ha<=ca.hg;++Ha)Ca=this.ykd.j_h(Y,ha,Ha,sa).Ana,Ta[Ta.length]=Ca;Ha=new Q.a;Ha.qe=ca.qe;Ha.hg=ca.hg;Ha.Ae=sa-1;Ha.rg=sa+1;for(Ha=this.sga.KFa(Y,ha,Ha);Ha.moveNext();)Ca=Ha.cB,R=Ha.Q$b(),this.K_f(sa,Ca.qe,R),this.PLh(sa,Ca.qe,R,ka);for(Ha=ca.qe;Ha<ca.hg;++Ha){Ca=Y.tf(sa-1,Ha);R=Y.tf(sa,Ha);var da=this.Er.UJ(ha,sa-1,Ha);da.qe===Ha&&(Ca=Y.tf(da.Ae,da.qe),da=sa-da.Ae,
R.rowSpan=Ca.rowSpan-da,Ca.rowSpan=da,R.colSpan=Ca.colSpan);R.isGhostCell=Ca.isGhostCell}ha.tXa(1);this.b7.hee(Y,ha,sa,ca.qe,ca.hg,!0);for(let Ba=ca.qe,za=0;Ba<=ca.hg;++Ba,++za)Ta[za]&&this.b7.X8e(Y,ha,Ba,sa,sa+1,Ta[za])}return{returnValue:sa,MXa:oa}}I1i(Y,ba,ha,ka,ca,ia){var oa,sa=N.b(ca,ia.x);({Dwe:oa}=sa);sa=sa.returnValue;if(oa=!oa){sa++;var Ca=ca[sa-1],Ta=ca[sa],R=this.Ub.Pc(Y);this.xZ.eih(R);R.Kq(sa-1,1);this.Shd.kqe(R);if(R=Y.ra(D.a.Wv,null))R=r.a.clone(R),R[sa-1]=ba.Cf(ia.x-Ca,0),R[sa]=ba.Cf(Ta-
ia.x,0),Y.setValue(D.a.Wv,R);Array.insert(ca,sa,ia.x);ha.tXa(3)}for(ba=0;ba<ia.SHh.length;++ba){ca=ia.SHh[ba];Ca=[];for(Ta=ca.Ae;Ta<=ca.rg;++Ta)R=this.ykd.f_h(Y,ha,Ta,sa).Ana,Ca[Ca.length]=R;Ta=new Q.a;Ta.Ae=ca.Ae;Ta.rg=ca.rg;Ta.qe=sa-1;Ta.hg=sa+1;for(Ta=this.sga.KFa(Y,ha,Ta);Ta.moveNext();){R=Ta.cB;var Ha=Ta.Q$b();this.K_f(R.Ae,sa,Ha);this.PLh(R.Ae,sa,Ha,ka)}for(Ta=ca.Ae;Ta<ca.rg;++Ta){R=Y.tf(Ta,sa-1);Ha=Y.tf(Ta,sa);var da=this.Er.UJ(ha,Ta,sa-1);da.Ae===Ta&&(R=Y.tf(da.Ae,da.qe),da=sa-da.qe,Ha.colSpan=
R.colSpan-da,R.colSpan=da,Ha.rowSpan=R.rowSpan);Ha.isGhostCell=R.isGhostCell}ha.tXa(1);this.b7.kee(Y,ha,sa,ca.Ae,ca.rg,!0);for(let Ba=ca.Ae,za=0;Ba<=ca.rg;++Ba,++za)Ca[za]&&this.b7.V7e(Y,ha,Ba,sa,sa+1,Ca[za])}return{returnValue:sa,MXa:oa}}Zoj(Y,ba,ha,ka,ca){const ia=this.sga.KFa(Y,ba,ha.yF);ia.moveTo(ha.WP,ha.aN);const oa=ia.cB;for(ha=1;ha<ka;++ha)ia.SYk(),oa.rg=ia.cB.rg,oa.hg=ia.cB.hg;for(ka=1;ka<ca;++ka)ia.moveNext(),oa.rg=ia.cB.rg,oa.hg=ia.cB.hg;for(ca=this.sga.KFa(Y,ba,oa);ca.moveNext();){const sa=
ca.cB;let Ca;sa.rg<oa.rg&&(()=>{let Ta=this.ykd.f_h(Y,ba,oa.rg,sa.qe);({Ana:Ca}=Ta);return Ta})().returnValue&&this.b7.V7e(Y,ba,sa.rg,sa.qe,sa.hg,Ca);sa.hg<oa.hg&&(()=>{let Ta=this.ykd.j_h(Y,ba,oa.hg,sa.Ae);({Ana:Ca}=Ta);return Ta})().returnValue&&this.b7.X8e(Y,ba,sa.hg,sa.Ae,sa.rg,Ca)}}Thj(Y,ba){Y=this.Ub.Pc(Y);this.iqc(Y,ba.Ae);for(let ha=ba.Ae;ha<ba.rg;++ha){const ka=Y.currentNode.ra(C.a.wv,0);ka&&ka<this.Hl.TQc(Y.currentNode)&&Y.currentNode.setValue(C.a.wv,0);Y.Qf(1)}}Rhj(Y,ba){let ha=Y.ra(D.a.Wv,
null),ka=!1;if(ha){ha=r.a.clone(ha);for(let ca=ba.qe;ca<ba.hg;++ca){const ia=this.Hl.Uwb(Y,ca);ha[ca]&&ha[ca]<ia&&(ha[ca]=ia,ka=!0)}}ka&&Y.setValue(D.a.Wv,ha)}K_f(Y,ba,ha){const ka=ha.getContainingTable();ka||E.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");ka.tf(Y,ba).cellShading=ha.cellShading}PLh(Y,ba,ha,ka){const ca=ha.getContainingTable();ca||E.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");Y=m.GraphIterator.ob(ca.tf(Y,ba));this.hib.uX(Y,
!0,ka(ha))}iqc(Y,ba){for(this.xZ.eih(Y);0<ba--;)this.xZ.YYk(Y)}KCh(Y){Y=this.Ub.Whe(Y);let ba=Y.Gb(1);for(;ba;)ba=Y.sUa(1)}}Object(L.a)(G,"TableMergeSplitEditor",null,[859])},1050:function(L,V,d){L=d(0);var k=d(7),e=d(395),n=d(25),r=d(168),w=d(203),D=d(54);class y{constructor(N,P,U,Q){this.AQd=null;this.kFc=Q;this.Dda=N;this.Eda=P;this.FQ=U;this.HFf=this.Pfh.jYl;N=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Pii=N[0];this.Oii=N[1]}get Pfh(){return this.AQd||(this.AQd=D.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get XWa(){return CommonUIStrings.l_OICErrorHelpLink}get vyc(){return this.HFf}get Rfh(){return this.Pii}get Qfh(){return this.Oii}get Ofh(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.HFf?
3:2}get f9b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get NSc(){return!!this.Eda}get g9b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Qla(){return CommonUIStrings.l_DefaultDialogTitle}z1e(N){this.Iqc(N)}Lze(N){this.Iqc(N)}Iqc(N){let P=10;this.Eda&&1===N&&(this.Eda(this.FQ),P=1);this.Dda&&this.Dda(this.FQ);this.Lp(P)}xkb(){w.Redirect.showHelp("OICFailure");this.Lp(2)}fTe(){this.Pfh.sIg();this.Lp(4)}Lp(N){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.kFc,N);n.AFrameworkApplication.Nmb(r.a.qrh,this.kFc,N)}dispose(){this.FQ=this.Dda=this.Eda=null}}Object(L.a)(y,"AOICErrorDialog",null,[106]);var m=d(94),C=d(111);class E extends y{constructor(N,P,U,Q){super(N,P,U,Q);this.YQa=this.IA=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=this.errorMessage;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));this.IA=document.createElement("a");this.IA.href="#";this.IA.innerText=this.XWa;N.appendChild(this.IA);
m.a.addHandler(this.IA,"click",Object(k.a)(this,this.xkb,"oicErrorHelpLinkHandler"));P=new C.StandardDialog;P.Fg=this.id;this.vyc?(U=document.createElement("span"),Q=document.createElement("span"),U.innerText=this.Rfh,Q.innerText=this.Qfh,this.YQa=document.createElement("a"),this.YQa.href="#",this.YQa.innerText=this.Ofh,N.appendChild(document.createElement("br")),N.appendChild(U),N.appendChild(this.YQa),N.appendChild(Q),m.a.addHandler(this.YQa,"click",Object(k.a)(this,this.fTe,"oicErrorMacOfferLinkHandler"))):
this.NSc&&(N.appendChild(document.createElement("br")),N.appendChild(document.createElement("br")),U=document.createElement("span"),U.innerText=this.f9b,N.appendChild(U));this.NSc?(P.Fd=1,P.Te(1,this.g9b)):P.Fd=0;P.Ky(this.Qla,null,this.icon,Object(k.a)(this,this.Lze,"legacyOICErrorDialogHandler"),N);P.M7("errorMessageText")}dispose(){this.IA&&(m.a.removeHandler(this.IA,"click",Object(k.a)(this,this.xkb,"oicErrorHelpLinkHandler")),this.IA=null);this.YQa&&(m.a.removeHandler(this.YQa,"click",Object(k.a)(this,
this.fTe,"oicErrorMacOfferLinkHandler")),this.YQa=null);super.dispose()}}Object(L.a)(E,"OICErrorDialog",y,[]);class F{constructor(N,P,U){this.Dda=P;this.Eda=N;this.FQ=U}get id(){return"OICErrorDialogWithDownload"}get f$f(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get XWa(){return CommonUIStrings.l_OICErrorHelpLink}get f9b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get g9b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Qla(){return CommonUIStrings.l_DefaultDialogTitle}z1e(N){this.Iqc(N)}Lze(N){this.Iqc(N)}Iqc(N){let P=
10;1===N&&(this.Eda(this.FQ),P=1);this.Dda&&this.Dda(this.FQ);this.Lp(P)}xkb(){w.Redirect.showHelp("OICFailure");this.Lp(2)}Lp(N){n.AFrameworkApplication.Nmb(r.a.rrh,3,N)}dispose(){this.FQ=this.Eda=this.Dda=null}}Object(L.a)(F,"AOICErrorDialogWithDownload",null,[106]);class B extends F{constructor(N,P,U){super(N,P,U);this.IA=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=this.f$f;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));this.IA=
document.createElement("a");this.IA.href="#";this.IA.innerText=this.XWa;N.appendChild(this.IA);m.a.addHandler(this.IA,"click",Object(k.a)(this,this.xkb,"oicErrorHelpLinkHandler"));N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));P=document.createElement("span");P.innerText=this.f9b;N.appendChild(P);P=new C.StandardDialog;P.Fg=this.id;P.Fd=1;P.Te(1,this.g9b);P.Ky(this.Qla,null,this.icon,Object(k.a)(this,this.Lze,"legacyOICErrorDialogHandler"),N);P.M7("errorMessageText")}dispose(){this.IA&&
(m.a.removeHandler(this.IA,"click",Object(k.a)(this,this.xkb,"oicErrorHelpLinkHandler")),this.IA=null);super.dispose()}}Object(L.a)(B,"OICErrorDialogWithDownload",F,[]);var H=d(83);class K extends y{constructor(N,P,U,Q){super(N,P,U,Q);P={["errorMessage"]:this.errorMessage};P.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.XWa,["onExecute"]:G=>{this.xkb(G)}};this.vyc?(P.macOfficePreLinkText=this.Rfh,P.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Ofh,
["onExecute"]:G=>{this.fTe(G)}},P.macOfficePostText=this.Qfh):this.NSc&&(P.errorFileDownloadOffer=this.f9b);N=new H.a(!1,!1,!0);this.NSc?(N.Fd=1,N.Te(1,this.g9b)):N.Fd=0;N.Fg=this.id;P={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:P};N.Vj(this.Qla,Object(k.a)(this,this.z1e,"reactOICErrorDialogHandler"),P)}}Object(L.a)(K,"ReactOICErrorDialog",y,[]);class A extends F{constructor(N,P,U){super(N,P,U);P={["errorMessage"]:this.f$f,["errorFileDownloadOffer"]:this.f9b};P.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.XWa,["onExecute"]:Q=>{this.xkb(Q)}};N=new H.a(!1,!1,!0);N.Fd=1;N.Te(1,this.g9b);N.Fg=this.id;P={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:P};N.Vj(this.Qla,Object(k.a)(this,this.z1e,"reactOICErrorDialogHandler"),P)}}Object(L.a)(A,"ReactOICErrorDialogWithDownload",F,[]);d.d(V,"a",function(){return W});class W{constructor(){this.tsa=!!n.AFrameworkApplication.za&&n.AFrameworkApplication.za.mb.SD}d5i(N,P,U){this.tsa?new K(N,P,null,U):new E(N,P,null,U)}e5i(N,
P,U){this.tsa?new A(N,P,U):new B(N,P,U)}f5i(N,P,U,Q,G){const {ReactOICErrorDialogWithTrial:Y}=d(1161),{OICErrorDialogWithTrial:ba}=d(1162);this.tsa?new Y(N,P,U,null,Q,G):new ba(N,P,U,null,Q,G)}static get instance(){return W.Ja||(W.Ja=new W)}}W.Ja=null;Object(L.a)(W,"OICErrorDialogFactory",null,[410])},1059:function(L,V,d){L=d(0);class k{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(L.a)(k,"DocumentContentSearchResults",null,[]);class e{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(A,
W,N,P,U){this.selectRange(W,N,P,U)}selectRangeV3(){}search(){}searchV2(A,W){this.search(A,N=>{W(Object.assign(new k,{results:N,totalResultCount:N.length,hasTooManyResults:100<N.length}))})}searchWithParam(A,W){this.search(A.query,W)}searchWithParamV2(A,W){this.searchWithParam(A,N=>{W(Object.assign(new k,{results:N,totalResultCount:N.length,hasTooManyResults:N.length>A.totalResultLimit}))})}highlight(){}highlightWithParam(A){this.highlight(A.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(L.a)(e,"BaseDocumentContentExecutor",null,[945,946]);class n{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(L.a)(n,"DocumentContentSearchResult",null,[]);var r=d(103),w=d(25),D=d(46),y=d(18),m=d(76),C=d(33),E=d(50),F=d(395),B=d(692),H=d(29);d.d(V,"a",function(){return K});class K extends e{constructor(A,
W,N,P,U,Q,G,Y,ba,ha,ka){super();if(!A)throw Error("pageNode is null");if(!W)throw Error("interactiveViewManager is null");if(!N)throw Error("selectionFactory is null");if(!P)throw Error("slideReader is null");if(!U)throw Error("workspace is null");if(!Q)throw Error("graphTopologyManager is null");if(!G)throw Error("searchContextFactory is null");if(!Y)throw Error("actionManager is null");if(!ba)throw Error("selectionManager is null");if(!ha)throw Error("clipServiceManager is null");if(!ka)throw Error("presentationReader is null");
this.hOk=A;this.hB=W;this.zjd=N;this.nc=P;this.Yb=U;this.sa=Q;this.yRk=G;this.ia=Y;this.oa=ba;this.wP=ha;this.Wb=ka}getAllParagraphsInDocument(){const A=this.Aje(),W=new y.a;for(const N of A)W.add(K.xje(N));return W.toArray()}selectRange(A,W,N,P){if(!(0>A||0>W||0>N||0>P||A>N||A===N&&W>P)){var U=this.Aje();U.count<=N||(A=U.ga(A),N=U.ga(N),K.VGg(A,W)&&K.VGg(N,P)&&(U=this.nc.ug(A),this.sa.Aa!==U&&this.Yb.iLh(U),W=this.zjd.fh(A,W),P=this.zjd.PO(W,E.a.rk(N,P+1)),this.hB.Y8e(this.Yb.dM,P)))}}search(A,W){const N=
new y.a,P=A.toLowerCase();var U=this.Aje();let Q=0;for(const Y of U){U=K.xje(Y);const ba=U.toLowerCase();let ha=0;for(;-1<(ha=ba.indexOf(P,ha));){var G=this.yRk.u6i(U,ha,ha+A.length);G=Object.assign(new n,{snippet:G.J_i,startOffsetInSnippet:G.eHl,endOffsetInSnippet:G.bHl-1,paragraphIndex:Q,startOffsetInParagraph:ha,endOffsetInParagraph:ha+A.length-1});N.add(G);ha+=A.length}Q++}N.Sc((Y,ba)=>Y.paragraphIndex===ba.paragraphIndex?Y.startOffsetInParagraph-ba.startOffsetInParagraph:Y.paragraphIndex-ba.paragraphIndex);
W(N.toArray())}getSelectedSlidesAsPPTXStream(){const A=this.oa.Xe();if(A&&A.length)return this.jhg(A);F.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const A=this.Wb.Tke();if(A&&A.length)return this.jhg(A);F.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}jhg(A){var W=this.wP.wTc(1,A.length,!1),N=r.a.create().toString();N=
new B.a(W,N,A);var P=8;P=this.ia.Ia(H.a.g7d,2,N);W.IX=P;N=w.AFrameworkApplication.fa.Ea("361");P=D.a.We(W.nq);const U=D.a.We(W.EE);W=D.a.We(W.Cz);if(P&&U&&W)return{url:`${N}GetClipboardBytes.ashx?Id=${P}&DC=${U}&pkey=${W}&wdwaccluster=${U}&DataType=${1}`,selectedSlideIDs:A.map(Q=>Q.id.toString())}}Aje(){var A=C.ParagraphReader.m1c(this.hOk.value,!0,!1);const W=new y.a;for(const N of A)A=this.nc.ug(N),A.hP||A.XEb||W.add(N);return W}static xje(A){A=C.ParagraphReader.text(A);return m.AParagraphNode.fvd(A,
" ")}static VGg(A,W){A=K.xje(A);return W<A.length}}Object(L.a)(K,"PPTDocumentContentExecutor",e,[])},1064:function(L,V,d){L=d(0);var k=d(356),e=d(541);class n extends e.a{constructor(E,F,B){F=void 0===F?null:F;B=void 0===B?null:B;super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=F;this.messageText=E;this.isDeferred=B}}Object(L.a)(n,"DeferredContentProps",e.a,[]);var r=d(27),w=d(953),D=d(954);const y=(E,F)=>Object.assign(new w.a,{target:".EditingRibbonPanel",
content:E,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new D.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:F,preventDismissOnResize:!0})});var m=d(47);d.d(V,"a",function(){return C});class C{constructor(){this.vV=new n(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}Fcj(E,F,B,H){H=Object.assign(new k.a,{onShow:()=>{B.bM(m.a.I3a)}});F=E.callout(F);return H=E.addNotification(F,
H)}Myl(E,F){E.removeNotification(F);r.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return F}v5i(E){return y(this.vV,()=>{E.zp(m.a.I3a)})}}Object(L.a)(C,"DownloadACopyDeferred",null,[974])},1066:function(L,V,d){L=d(0);var k=d(593),e=d(1264),n=d(296),r=d(509);class w{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(L.a)(w,"CT_LineJoinMiterProperties",null,[]);var D=d(987);class y{constructor(){this.valField=0}}Object(L.a)(y,"CT_PositiveFixedPercentage",null,[]);var m=
d(988),C=d(370),E=d(328),F=d(297);d.d(V,"a",function(){return B});class B{oog(H,K,A,W,N,P){H=Object(e.a)(227,P.Aa.vg(N.Na));A=N.Xd;N=Math.round(W.wQ(A.Ve(K.width*k.a.kE,0),H.cV));K=Math.round(W.wQ(A.Ve(K.height*k.a.kE,1),H.cV));return{TOh:N,LOh:K}}t0f(H,K){return Object.assign(new n.a,{TopLeft:Object.assign(new F.a,{X:0,Y:0}),TopRight:Object.assign(new F.a,{X:H,Y:0}),BottomLeft:Object.assign(new F.a,{X:0,Y:K}),BottomRight:Object.assign(new F.a,{X:H,Y:K})})}vMh(H){H.lineStyle=Object.assign(new D.a,
{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new w,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new m.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new E.a,{schemeClrField:Object.assign(new C.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}GMh(H){H.fill=Object.assign(new r.a,{solidFillField:Object.assign(new E.a,{schemeClrField:Object.assign(new C.a,{valField:4})})});H.lineStyle=
Object.assign(new D.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new w,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new m.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new E.a,{schemeClrField:this.t6i(Object.assign(new y,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}t6i(H){const K={itemsElementNameField:[26]};K.itemsField=[H];K.valField=4;return K}}Object(L.a)(B,"InsertShapeActorHelper",
null,[1303])},1071:function(L,V,d){L=d(0);var k=d(395),e=d(104),n=d(276),r=d(7),w=d(1264),D=d(35);class y{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(L.a)(y,"CritiqueTypeOption",null,[]);var m=d(3);d.d(V,"a",function(){return C});class C{constructor(E,F,B){this.dVd={};this.yk=null;this.lEf=E;this.eni=F;this.fni=B;this.z7a=m.Task.ju({})}init(){this.z7a=this.lEf.Qle(this.eni,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(r.a)(this,this.V6k,"onLoadSettingsTaskFinished"),
8)}Hbm(E){const F={};if(!(E&&"ProofingSettingLanguageList"in E))return F;const B=Array.isArray(D.a(E.ProofingSettingLanguageList))?D.a(E.ProofingSettingLanguageList):null;for(const H of B)"ProofingSettings"+H in E&&(F[H]=Object(w.a)(Object,D.a(E["ProofingSettings"+H])));return F}Ibm(E){const F={},B=[];for(const A in E){var H=A,K=E[A];K&&(B.push(H),F["ProofingSettings"+H]=D.c(K))}F.ProofingSettingLanguageList=D.c(B);return F}saveSettings(E){this.z7a=m.Task.ju(E);this.yk=null;try{const F=this.Ibm(E);
this.lEf.cOh(this.fni,F).continueWith(Object(r.a)(this,this.j9k,"onSaveSettingsTaskFinished"),8)}catch(F){k.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",F.toString())}}Mge(){if(!this.yk){if(6!==this.z7a.status)return[];try{var E=this.z7a.result;let K;if(e.a.isEmpty(this.dVd))K=E;else if(e.a.isEmpty(E))K=this.dVd;else{K={};var F=this.dVd;for(const A in F)K[A]=e.a.Zxc(F[A]);K=C.merge(K,E)}this.yk=[];for(const A in K){var B=K[A];const W=n.a.Oe(parseInt(A));if(!W)continue;
const N=W.name;F=B;for(const P in F){E=P;var H=F[P];const U=Object.assign(new y,{LanguageId:N,Id:E,Value:H.toString()});this.yk.push(U)}}}catch(K){k.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",K.toString())}}return this.yk}ccj(E,F){const B=this.z7a.result;if(B)try{let H=B[E];H||(H={});H[F]=!1;B[E]=H;this.saveSettings(B)}catch(H){k.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",H.toString())}}V6k(E){if(E.Pm)return k.ULS.sendTraceTag(34964619,
375,10,"Load setting failed with exception {0}",E.Ni),null;if(6===E.status)try{return this.Hbm(E.result)}catch(F){k.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",F.toString())}return null}j9k(E){E.Pm&&k.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",E.Ni)}static merge(E,F){E=E||{};if(F)for(const K in F){var B=K,H=F[K];E[B]=E[B]||{};for(const A in H)E[B][A]=H[A]}return E}}Object(L.a)(C,"CritiqueTypeSettings",null,[1189])},1077:function(L,V,d){L=d(0);
var k=d(1265),e=d(25),n=d(67),r=d(80);class w{constructor(y,m,C,E){this.origin=y;this.data=m;this.source=C;this.hc=void 0===E?null:E}}Object(L.a)(w,"MessageEventArgs",null,[]);d.d(V,"a",function(){return D});class D{constructor(y,m){this.aYd=null;this.Ohl=C=>this.HIc?this.HIc(new w(C.origin,C.data,C.source,C.hc)):!1;this.Gri=y;this.je=m;this.HIc=null}get vpb(){return this.Gri.value}get rT(){return this.je.value}BGi(y){this.HIc=y;this.aYd=this.Ohl;this.vpb.addHandler(n.a.message,this.aYd,null)}Raj(){this.HIc=
null;this.vpb.removeHandler(n.a.message,this.aYd)}R5c(y,m){const C=new r.a(0,1,1,()=>{y(m)},7);this.rT.Jb(C)}Vck(y,m){const C=new r.a(0,1,1,()=>{y(m)},7);this.rT.Jb(C)}static get instance(){return D.Tbb()}static Tbb(){return new D(new k.a(()=>e.AFrameworkApplication.vpb),new k.a(()=>e.AFrameworkApplication.Be))}}Object(L.a)(D,"MessageEventHandler",null,[257])},1078:function(L,V,d){L=d(0);var k=d(142),e=d(74),n=d(1273),r=d(25),w=d(197),D=d(46),y=d(167),m=d(27),C=d(450),E=d(389);class F{constructor(){this.alt=
null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(L.a)(F,"ImagePasteArgs",null,[]);var B=d(335),H=d(41),K=d(48),A=d(29);d.d(V,"a",function(){return W});class W{constructor(N,P,U,Q,G,Y,ba,ha,ka,ca,ia,oa){this.ia=N;this.Fa=P;this.fKa=U;this.oa=Q;this.TUk=G;this.Fp=Y;this.Ona=ba;this.Ye=ca;this.pB=ia;this.Fc=oa;this.nlc=ha;this.ufd=ka;this.Sjd=!1;this.$lc=-1}yR(N){if(!this.fKa.iec(this.Fa)||!N)return!1;if(N.GXc&&N.Uoe)return this.Sjd=!1,N.yR=this.nlc;if(!N.Rn||0<N.Rn.getElementsByTagName(K.a.wwg).length)return!1;
this.Sjd=!this.Cne(N)&&this.Eqk(this.oa.Hd());N.yR=this.Sjd?this.ufd:this.nlc;return N.yR}Eqk(N){return 1===N.length?N[0].Zrk:!1}Ill(N,P){this.gxh(N,P,0);if(!N.firstChild||!N.firstChild.className||!C.a.wzg(N.firstChild.className))if(!this.Fp.jg||"<br>"!==N.innerHTML){const U=y.b(N);U&&0<U.length&&(P.AW=N.innerHTML)}}gxh(N,P,U){if(N){if(U>=W.vQc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",W.vQc));if(1===N.nodeType){var Q=N.tagName.toLowerCase();if(this.Ona.Eok(Q))N.parentNode.removeChild(N);
else{for(let Y=N.firstChild;Y;Y=G){var G=Y.nextSibling;this.gxh(Y,P,U+1)}Q===K.a.C5?(N.parentNode.removeChild(N),this.Jll(N,P)):Q===K.a.kpb?(N.parentNode.removeChild(N),this.oml(N,P)):Q===K.a.listTag&&this.Pll(N);this.Vim(N);P.yfc&&this.gAl(N);P.zfc&&this.fAl(N);this.Fc.K8e(N,P.$b)}}}}Vim(N){(N=N.style)&&N.aef&&(N.textDecoration=N.aef)}fAl(N){const P=N.style;P&&(P.fontFamily&&(P.fontFamily=""),P.fontSize&&(P.fontSize=""),P.color&&(P.color=""),N.getAttribute&&N.getAttribute("data-scheme-color")&&N.setAttribute("data-scheme-color",
""),P.backgroundColor&&(P.backgroundColor=""),P.backgroundImage&&N.className&&-1<N.className.indexOf("Highlight")&&(P.backgroundImage=""))}gAl(N){const P=N.style;P&&(P.fontWeight&&(P.fontWeight=""),P.fontStyle&&(P.fontStyle=""),P.textDecoration&&(P.textDecoration=""),P.aef&&(P.aef=""),P.verticalAlign&&(P.verticalAlign=""),P.fontFamily&&(P.fontFamily=""),P.fontSize&&(P.fontSize=""),P.color&&(P.color=""),N.getAttribute&&N.getAttribute("data-scheme-color")&&N.setAttribute("data-scheme-color",""),P.backgroundColor&&
(P.backgroundColor=""),P.backgroundImage&&N.className&&-1<N.className.indexOf("Highlight")&&(P.backgroundImage=""))}Pll(N){if(N){var P=N.getAttribute("data-"+k.a.O3b);if(P&&0<P.length&&N.style){var U=parseInt(P);if(1!==P.length||isNaN(U)||1>U||U>B.a.G9)P="1",U=1;U>this.$lc&&(this.$lc=U);P=String.format(K.a.Pwk,P);(U=N.style.cssText)?N.setAttribute("style",P+U):N.setAttribute("style",P)}if((P=N.parentNode)&&!this.Ye.hlk(P.tagName)){U=N.nextSibling;const Q=this.Ye.a7b();Q.appendChild(N);P.insertBefore(Q,
U)}}}Jll(N,P){if(N&&N.src&&N.src.length){var U=window.location.href.toLowerCase();U=e.a.CR(U);if(N.src.startsWith(U))m.a.J(509153345,826,50,"Pasted image src is an empty string.");else{U=Math.ceil(n.a.Ve(this.Ona.aDj(N),0,!1));var Q=Math.ceil(n.a.Ve(this.Ona.TCj(N),1,!1));P.Gfa.push(Object.assign(new F,{src:N.src,alt:N.alt,width:U?U:N.width,height:Q?Q:N.height}))}}}oml(N,P){N&&N.innerHTML&&N.rows&&N.rows.length&&(N.getElementsByTagName(K.a.pCd).length||N.getElementsByTagName(K.a.t8l).length)&&(N=
y.c(N),!N||0>=N.length||P.t4a.push(N))}Cne(N){if(N.GXc)return!0;const P=N.Rn.getElementsByTagName(K.a.kpb).length;return 0<N.Rn.getElementsByTagName(K.a.C5).length||0<P}paste(N){if(r.AFrameworkApplication.YR)this.TUk.Zyc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const P=Object.assign(new E.a,{$b:N.$b});let U=!0;P.qob=this.Sjd;P.gAg=N.Gce;P.yfc=N.s9b&&!this.Cne(N)&&""!==N.Rn.innerText;P.zfc=N.t9b&&!this.Cne(N);if(N.GXc)P.Gfa.push(Object.assign(new F,{src:N.Uoe,
width:0,height:0}));else try{this.Ill(N.Rn,P),0<this.$lc&&(m.a.J(509153315,826,50,String.format("max list level pasted into new shape = {0}.",this.$lc-1)),this.$lc=-1)}catch(Q){U=!1,m.a.J(509153314,826,15,Q.message)}U&&(this.rXl(P)?this.Rel(P):this.ia.Ia(A.a.bqa,2,P))}}rXl(N){return w.a.Ta(N.t4a)&&D.a.Ta(N.AW)&&!!N.Gfa&&1===N.Gfa.length&&this.Ysk(N.Gfa[0].src)}Ysk(N){if(D.a.Ta(N)||!N.startsWith("data:image"))return!1;N=N.split(";");if(!N||2!==N.length)return!1;N=N[0].replace("/",".");return 0===this.pB.QFd(N,
!0)}Rel(N){let P=new Image;const U=N.Gfa[0],Q=H.a.Kb;if(U.width&&U.height)N.j8c=!0,this.ia.Ia(A.a.bqa,2,N);else{const G=new Date;P.onload=()=>{N.dXe=+new Date-+G;U.width=P.width;U.height=P.height;N.j8c=!0;P=null;H.a.gz(Q,()=>{this.ia.Ia(A.a.bqa,2,N)})};P.onerror=()=>{P=null;H.a.gz(Q,()=>{this.ia.Ia(A.a.bqa,2,N)})};P.src=U.src}}}W.vQc=100;Object(L.a)(W,"HtmlPasteHandler",null,[1856])},1079:function(L,V,d){L=d(0);var k=d(18),e=d(25),n=d(1270),r=d(251),w=d(38);class D{constructor(E,F){this.actionId=
E;this.Bd=F}}Object(L.a)(D,"CommandActionData",null,[]);var y=d(29),m=d(30);d.d(V,"a",function(){return C});class C{constructor(E,F,B,H,K){this.Heh=[];this.eEg=!1;this.Xhc=null;this.tbd=new k.a;this.ia=E;this.NMe=F;this.mJf=!1;this.Ub=B;this.tI=H;this.eba=K;this.zMg=this.$Ib=null;Object(m.a)("EnhancementOfSDXPaneBootTime")&&this.p8j()}p8j(){this.$Ib||(this.$Ib=e.AFrameworkApplication.Ui("officeExtensionMerge.js",5));this.zMg||(this.zMg=e.AFrameworkApplication.Ui("appforoffice.hermes"+this.tI.CHg,
1));if(!this.Xhc){const E=[this.eba.qyb(this.eTe)];this.Xhc=n.a.create("pptedit.appforoffice",E,()=>d.e(7).then(d.bind(null,1309)))}}get uEd(){return this.Heh}get eTe(){this.$Ib||(this.$Ib=e.AFrameworkApplication.Ui("officeExtensionMerge.js",5));return this.$Ib}set eTe(E){this.$Ib=E}get zDi(){if(!this.Xhc){const E=[this.eba.qyb(this.eTe)];this.Xhc=n.a.create("pptedit.appforoffice",E,()=>d.e(7).then(d.bind(null,1309)))}return this.Xhc}Yvi(E){this.uEd.push(E)}mla(){this.eEg||(r.a.bF(this.zDi),this.eEg=
!0)}tcm(){for(const E of this.uEd)E.uob();this.Heh=[]}ucm(){var E=this.Ub.Pc(this.NMe.Of).Gb(18);E=this.Ub.Pc(E);let F=E.Gb(19);if(F){do F=E.lr,this.ia.Ia(y.a.Imb,2,F.$a(w.a.w0));while(E.Qf(19))}}pSa(E,F){this.tbd.add(new D(E,F))}YUj(){if(0<this.tbd.count){for(const E of this.tbd)this.ia.Ia(E.actionId,2,E.Bd);this.tbd.clear()}}one(){const E=!!this.uEd&&0<this.uEd.length;let F=!1;if(this.NMe.Of&&!E){const B=this.Ub.Pc(this.NMe.Of).Gb(18);B&&0<this.Ub.Pc(B).g$(19)&&(F=!0)}return E||F}}Object(L.a)(C,
"AppForOfficeManagerFactory",null,[1227])},1080:function(L,V,d){L=d(0);var k=d(46);class e{constructor(r,w){this.gLk=r;this.Kgd=w}get IXa(){return this.gLk}get message(){return this.Kgd}}Object(L.a)(e,"CalloutNotificationError",null,[]);d.d(V,"a",function(){return n});class n{constructor(r,w){this.xNg=r;this.kRk=w}rca(r,w,D,y,m,C,E,F,B,H,K,A,W,N){this.xNg.show(this.kRk,null,!1,B,H,r,w,D,m,y,C,E,F,K,A,W,N)}L$d(){this.xNg.dismiss()}fRh(r){if(!r)throw Error.argumentNull("CalloutNotificationMessageAttributes");
const w=this.Nmm(r);if(w&&w.IXa)return w;this.rca(r.title,r.message,r.Aug,r.RNb,r.Fug,r.kxd,r.Tkl,r.iLl,r.Ukl,r.jLl,!!r.timeoutInSeconds,r.timeoutInSeconds,r.f1j,r.Z5j);return new e(!1,null)}Nmm(r){return k.a.Ta(r.title)?new e(!0,"Invalid Title"):k.a.Ta(r.message)?new e(!0,"Invalid Message"):r.Aug&&k.a.Ta(r.RNb)?new e(!0,"Missing PrimaryButtonLabel"):r.Fug&&k.a.Ta(r.kxd)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(L.a)(n,"CalloutNotificationAdapter",null,[1065])},1081:function(L,
V,d){L=d(0);var k=d(25),e=d(750),n=d(234);class r extends e.a{constructor(D,y){super(D);this.sGk=y}zYh(D){return n.i(n.g(D))}Jef(D){return n.i(D)}RAc(D){return this.sGk?D.UQf:D.RAc().toString()}TLi(D,y,m){const C=new Sys.StringBuilder;C.append(String.format('<Menu Id="{0}">',"menuFontColor"));C.append(this.cme(D,y,m));C.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');C.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',
"862825906",k.AFrameworkApplication.Mm,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));C.append("</Controls> </MenuSection>");C.append("</Menu>");return C.toString()}}Object(L.a)(r,"ColorMenuBuilder",e.a,[]);d.d(V,"a",function(){return w});class w{Qwj(D){return new e.a(D)}rhg(D,y){return new r(D,y)}}Object(L.a)(w,"ColorPickerBuilderFactory",null,[1210])},1082:function(L,V,d){var k=d(92);L=d(0);var e=d(103),n=d(1299),r;(function(A){A[A.CEm=0]="unattempted";A[A.f1=1]="inProgress";
A[A.notHandled=2]="notHandled";A[A.gvm=4]="handleExternally";A[A.failed=8]="failed";A[A.error=16]="error";A[A.succeeded=32]="succeeded";A[A.eum=64]="delayed"})(r||(r={}));Object(L.b)("ActionResponse",r);var w=d(38),D=d(284),y=d(350),m=d(694),C=d(151),E=d(339),F=d(1264),B=d(29),H=d(389);d.d(V,"a",function(){return K});class K{constructor(A,W,N,P,U,Q,G,Y,ba,ha,ka){this.sa=A;this.oa=W;this.Lj=N;this.Fa=P;this.Vk=U;this.Dr=Q;this.z2=G;this.uf=Y;this.ia=ba;this.ms=ha;this.aKa=ka;this.select=ca=>{var {scope:ia,
index:oa=-1}=ca;return Object(k.b)(this,void 0,void 0,function*(){const sa=[],Ca=[];var Ta=null!==ia&&void 0!==ia?ia:"Selection";if("Selection"===Ta){var R=this.oa.$n();R?Ca.push(R):(R=this.oa.Xe(),0<R.length&&this.aKa.pQb(14,R,sa),0!=sa.length||ia||(Ta="Presentation"))}if(Array.isArray(Ta)&&0<Ta.length&&Ta[0]instanceof D.a)this.aKa.pQb(14,Ta,sa);else if("Presentation"===Ta&&this.sa.presentation){Ta=this.sa.presentation.slides;if(null===Ta)throw Error("Could not cast from ISlide to ISlide on presentation slides");
this.aKa.pQb(14,Ta,sa)}Ca.push(...sa.map(Ha=>Ha.node));return-1!==oa&&oa<Ca.length?[Ca[oa]]:Ca})};this.format=ca=>{var {tables:ia,color:oa,fillColor:sa,styles:Ca,cellColor:Ta,border:R,borderColor:Ha,mergeCells:da,splitCells:Ba}=ca;return Object(k.b)(this,void 0,void 0,function*(){var za;let Aa=!1;var na=!1,la=!1;const va=[];for(const Qa of ia){let Ua=this.oa.yw();1===ia.length&&Ua&&0<Ua.length?Aa=!0:Ua=Qa.Tcb();Ua.filter(Ya=>!Ya.isGhostCell);var Pa=this.aOj(null!==(za=null!==Ca&&void 0!==Ca?Ca:sa)&&
void 0!==za?za:oa);Pa&&0<Pa.length&&Qa.setValue(w.a.cBa,e.a.Tf(Pa));if(Ta&&m.a.VUf(Ta)&&!na){na=this.Ske(Ta);for(const Ya of Ua)Pa=Ya.cellShading,y.b(Pa),Pa.solidFillField=na,Ya.cellShading=Pa;na=Aa&&1===ia.length}if((R||Ha)&&!la){if(R)la=Ha&&m.a.VUf(Ha)?this.Ske(Ha):void 0,this.ia.Ia(B.a.ora,n.a.execute,{["TableNode"]:Qa,["CellNodes"]:Ua,["SourceControlId"]:this.Zbb(R),["BorderColor"]:la,["DoNotCreateTransaction"]:!0});else{la=m.a.DTa(Ha);this.ia.Ia(B.a.eOa,n.a.execute,{["TableNode"]:Qa,["Color"]:la});
la=this.Ske(Ha);for(const Ya of Ua)C.Box4ColorHelper.neb(Ya.gOa)||(Ya.gOa=la),C.Box4ColorHelper.neb(Ya.Nia)||(Ya.Nia=la),C.Box4ColorHelper.neb(Ya.fOa)||(Ya.fOa=la),C.Box4ColorHelper.neb(Ya.Oia)||(Ya.Oia=la)}la=Aa&&1===ia.length}(da||Ba)&&Aa&&this.ia.Ia(da?B.a.mergeTableCells:B.a.splitTableCells,n.a.execute,{["rows"]:1,["columns"]:2});va.push(new Promise(Ya=>E.a.x$(Ya,Qa,!0).bind(this)))}yield Promise.all(va)})};this.Pbk=ca=>{ca=Object.assign(new H.a,{qob:!1,t4a:[ca]});if(this.ia.Ia(B.a.bqa,n.a.execute,
ca)!==r.succeeded)throw Error("Table insertion from HTML failed.");return this.oa.Zn()};this.Rbk=(ca,ia,oa)=>{const sa=[];if(!ia||Number.isNaN(ia)||!oa||Number.isNaN(oa))throw Error("Invalid rows and columns provided.");this.oa.Pu();this.oa.Bh();this.Fa.Gd();for(const Ta of ca){ca=Ta;if(!ca)throw Error("Cannot find selected slide to insert table.");if(!this.uf.Xc(ca)){if(!this.Lj.UD(ca,1))throw this.Lj.yE(ca),Error("Too many shapes on the slide.");var Ca=ca.Fb;Ca=ca.T4(Ca.sid,Ca.cid,0,ia,oa,ca.wt());
sa.push(Ca);this.ms.NU([Ca],ca,null);this.Dr.YA=Ca}}return sa};this.insert=ca=>{var {slides:ia,rows:oa,columns:sa,html:Ca}=ca;return Object(k.b)(this,void 0,void 0,function*(){if(!ia)throw Error("No slide context provided to insert table.");const Ta=[];Ca?Ta.push(this.Pbk(Ca)):Ta.push(...this.Rbk(ia,oa,sa));const R=[];for(const Ha of Ta)R.push(new Promise(da=>E.a.x$(da,Ha,!0).bind(this)));return Promise.all(R)})};this.delete=ca=>{var {tables:ia}=ca;return Object(k.b)(this,void 0,void 0,function*(){if(!ia)throw Error.argumentNull("tables");
for(const Ca of ia){var oa=this.oa.Zn();oa&&oa.vd&&this.uf.Xc(oa)||(oa=Object(F.a)(4,Ca),this.Vk.zVc(oa))}const sa=this.sa.Aa;sa&&this.uf.mx(sa,"handleDeleteTable");return new Promise(Ca=>E.a.x$(Ca,sa).bind(this))})};if(!A)throw Error.argumentNull("m_graphTopologyManager");if(!W)throw Error.argumentNull("m_selectionManager");if(!N)throw Error.argumentNull("m_shapeCountValidator");if(!P)throw Error.argumentNull("m_focusManager");if(!U)throw Error.argumentNull("m_shapeEditor");if(!Q)throw Error.argumentNull("m_ribbonChangeManager");
if(!G)throw Error.argumentNull("m_tableStyleGalleryManager");if(!Y)throw Error.argumentNull("m_actionBlockingManager");if(!ba)throw Error.argumentNull("m_actionManager");if(!ha)throw Error.argumentNull("m_transactionHelper");if(!ka)throw Error.argumentNull("m_odslGraphUtils");}KPj(){var A=this.oa.Xe();return A&&0!=A.length?(A=A[0])?A.Ld:null:null}Mwj(A,W){A=m.a.Owj(A);return(Math.abs(A.r-W.r)^2)+(Math.abs(A.g-W.g)^2)+(Math.abs(A.b-W.b)^2)}aOj(A){if(!A)return"";var W=A.toLowerCase();this.z2.zbe();
A=this.z2.AZc();if(!A||!A.length)return"";if(W.includes("transparent")||W.includes("none")){var N=A[0].$h(w.a.tableStyle);return N.yZ?N.yZ.styleIdField:""}W=m.a.DTa(W);if(!W.length)return"";const P=this.KPj();if(!P)return"";let U=999999,Q="";for(let Y=0;7>Y;++Y){const ba=A[Y].$h(w.a.tableStyle);if(!ba.yZ)continue;var G=null!==(N=ba.yZ.firstRowField)&&void 0!==N?N:ba.yZ.wholeTblField;if(!G||!G.tcStyleField)continue;G=G.tcStyleField.fillField;if(!G||G.noFillField)continue;let ha;G.solidFillField?ha=
C.Box4ColorHelper.ZI(C.Box4ColorHelper.Eia(G.solidFillField),P):G.gradFillField&&(ha=y.f(G.gradFillField,P).stops[0].color);ha&&(G=this.Mwj(W,ha),G<=U&&(U=G,Q=ba.yZ.styleIdField))}return Q}Ske(A){const W={};W.Color=m.a.DTa(A);return C.Box4ColorHelper.uT(W)}Zbb(A){A=A.toLowerCase();if(A.includes("no"))return"TableBordersNoBorder";if(!A.includes("all")){if(A.includes("outside"))return"TableBordersOutsideBorders";if(A.includes("horizontal"))return"TableBordersInsideHorizontalBorder";if(A.includes("vertical"))return"TableBordersInsideVerticalBorder";
if(A.includes("inside"))return"TableBordersInsideBorders";if(A.includes("top"))return"TableBordersTopBorder";if(A.includes("bottom"))return"TableBordersBottomBorder";if(A.includes("left"))return"TableBordersLeftBorder";if(A.includes("right"))return"TableBordersRightBorder";if(A.includes("up"))return"TableBordersDiagonalUpBorder";if(A.includes("down"))return"TableBordersDiagonalDownBorder";if(A.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}Object(L.a)(K,
"ODSLTable",null,[1273])},110:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(1293);class e{constructor(){this.Mbb=this.ISf=this.k5=this.uca=this.tQc=this.rZc=this.zAb=this.fGa=this.H0=this.rSc=this.lDd=null}Rf(n){this.lDd=new k.a;this.lDd.value=n}kxc(){this.rSc=new k.a;this.rSc.value=!0}sW(n){this.rZc=new k.a;this.rZc.value=n}}Object(L.a)(e,"QueryResult",null,[])},1153:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(99);class e{constructor(n){this.uJd=n.cloneNode(!0);
this.CBf=n}restore(){for(k.a.qw(this.CBf);this.uJd.firstChild;){const n=this.uJd.firstChild;k.a.oQ(n);this.CBf.appendChild(n)}this.uJd=null}}Object(L.a)(e,"DomElementContentState",null,[])},1154:function(L,V,d){var k=this&&this.WGd||(Object.create?function(n,r,w,D){void 0===D&&(D=w);var y=Object.getOwnPropertyDescriptor(r,w);if(!y||("get"in y?!r.q8:y.writable||y.configurable))y={enumerable:!0,get:function(){return r[w]}};Object.defineProperty(n,D,y)}:function(n,r,w,D){void 0===D&&(D=w);n[D]=r[w]}),
e=this&&this.__exportStar||function(n,r){for(var w in n)"default"===w||Object.prototype.hasOwnProperty.call(r,w)||k(r,n,w)};Object.defineProperty(V,"__esModule",{value:!0});e(d(1155),V);e(d(1156),V);e(d(1157),V);e(d(1158),V)},1155:function(L,V){Object.defineProperty(V,"__esModule",{value:!0})},1156:function(L,V){Object.defineProperty(V,"__esModule",{value:!0});V.PowerPointShapeType=void 0;L=V.PowerPointShapeType||(V.PowerPointShapeType={});L[L.Title=0]="Title";L[L.Subtitle=1]="Subtitle";L[L.Content=
2]="Content";L[L.Note=3]="Note";L[L.SmartArt=4]="SmartArt";L[L.Image=5]="Image";L[L.TextBox=6]="TextBox";L[L.Table=7]="Table";L[L.Chart=8]="Chart";L[L.Other=9]="Other"},1157:function(L,V,d){Object.defineProperty(V,"__esModule",{value:!0});V.PowerPointDocumentStateAnnotations=void 0;const k=d(224);class e{constructor(n){k.SchemaObject.assign(e,this,n)}get metadata(){return this.M_}set metadata(n){this.M_=n}static getTypeName(){return"AugLoop_Powerpoint_PowerPointDocumentStateAnnotations"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(n){return k.SchemaObject.matchesTypesFor(n,
[e.getTypeName()])}}V.PowerPointDocumentStateAnnotations=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1158:function(L,V,d){Object.defineProperty(V,"__esModule",{value:!0});V.PowerPointCopilotStart=V.PowerPointCopilotChat=V.PowerPointSlide=V.PowerPointShape=void 0;const k=d(224);class e{constructor(D){k.SchemaObject.assign(e,this,D)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static getBaseTypes(){return[]}static typeGuard(D){return k.SchemaObject.matchesTypesFor(D,[e.getTypeName()])}}
V.PowerPointShape=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class n{constructor(D){k.SchemaObject.assign(n,this,D)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static getBaseTypes(){return[]}static typeGuard(D){return k.SchemaObject.matchesTypesFor(D,[n.getTypeName()])}}V.PowerPointSlide=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(D){k.SchemaObject.assign(r,this,D)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointCopilotChat"}static getBaseTypes(){return[]}static typeGuard(D){return k.SchemaObject.matchesTypesFor(D,
[r.getTypeName()])}}V.PowerPointCopilotChat=r;r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{constructor(D){k.SchemaObject.assign(w,this,D)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointCopilotStart"}static getBaseTypes(){return[]}static typeGuard(D){return k.SchemaObject.matchesTypesFor(D,[w.getTypeName()])}}V.PowerPointCopilotStart=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()}},1159:function(L,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdatedV2",function(){return n});L=d(0);var k=
d(678),e=d(677);class n extends k.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=0}static jfe(r,w){const D=new n;k.a.cYe(D,r,w);D.UserActionType=e.a[r.userAction];D.ProofingEngine=r.aia;D.Descriptors=r.descriptors;D.OverriddenCritiqueTypeOptions=r.overriddenCritiqueTypeOptions;D.UxLcid=r.E4h;2===r.aia?D.TextUnit=r.range.textUnit:1===r.aia&&(D.UseContextualResults=!0);return D}}Object(L.a)(n,
"SpellingRequestObjectUpdatedV2",k.a,[])},1160:function(L,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdated",function(){return n});L=d(0);var k=d(678),e=d(677);class n extends k.a{constructor(){super();this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static jfe(r,w,D,y,m,C){const E=new n;k.a.cYe(E,r,w);E.UserActionType=e.a[r.userAction];E.UseOneSpeller=D;E.TrackMetrics=y;E.UseContextualResults=m;C&&(E.ExperimentId=C);return E}}Object(L.a)(n,"SpellingRequestObjectUpdated",
k.a,[])},1161:function(L,V,d){d.r(V);d.d(V,"ReactOICErrorDialogWithTrial",function(){return r});L=d(0);var k=d(7);V=d(949);var e=d(203),n=d(83);class r extends V.a{constructor(w,D,y,m,C,E){super(w,D,y,m,C,E);D={["errorMessage"]:this.e$f,["offerString"]:this.lkh};w=new n.a(!1,!1,!0);this.ARh?(w.Fd=1,D.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.XWa,["onExecute"]:()=>{e.Redirect.showHelp(this.Vug)}}):(w.Fd=4,w.Te(2,this.iwg));w.Te(1,this.RIf);w.Fg=this.id;D={["id"]:this.id,["dialogIcon"]:this.icon,
["bodyControls"]:D};w.Vj(this.Qla,Object(k.a)(this,this.ssl,"reactOICErrorDialogWithTrialHandler"),D)}}Object(L.a)(r,"ReactOICErrorDialogWithTrial",V.a,[])},1162:function(L,V,d){d.r(V);d.d(V,"OICErrorDialogWithTrial",function(){return n});L=d(0);var k=d(7);V=d(949);var e=d(111);class n extends V.a{constructor(r,w,D,y,m,C){super(r,w,D,y,m,C);r=document.createElement("span");r.innerText=this.e$f;r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));w=document.createElement("span");
w.innerText=this.lkh;r.appendChild(w);w=new e.StandardDialog;this.ARh?(w.Fd=1,w.cZd(this.XWa,this.Vug)):(w.Fd=4,w.Te(2,this.iwg));w.Te(1,this.RIf);w.Fg=this.id;w.Ky(this.Qla,null,this.icon,Object(k.a)(this,this.owk,"legacyOICErrorDialogWithTrialHandler"),r)}}Object(L.a)(n,"OICErrorDialogWithTrial",V.a,[])},1163:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(L.a)(k,"HeaderButtonInfo",null,[])},1164:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(L.a)(k,"CalloutButtonProps",null,[])},1165:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.y=this.x=0}}Object(L.a)(k,"IPoint",null,[])},1166:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(25);d=d(75);class e{static Gyi(n){e.hnf.addHandler(e.tYf,n)}static npl(n){k.AFrameworkApplication.fa.getBooleanAppSetting("SqmCommandEventSourceEnabled")&&
e.hnf.raiseEvent(e.tYf,n)}}e.tYf="CommandClickEvent";e.hnf=new d.a;Object(L.a)(e,"CommandClickEvents",null,[])},1167:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Image16by16Class="Image16by16Class";k.Image32by32Class="Image32by32Class";k.On="On";k.LabelText="LabelText";k.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";k.EnsureControlRoleIsButton="EnsureControlRoleIsButton";k.Visible="Visible";Object(L.a)(k,"SplitButtonCommandProperties",null,[])},1168:function(L,V,d){d.d(V,
"a",function(){return k});L=d(0);class k{constructor(e,n,r,w){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=void 0===n?null:n;this.iconSet.icon24=void 0===r?null:r;this.iconSet.icon32=void 0===w?null:w}}Object(L.a)(k,"IconSetContainer",null,[])},1169:function(L,V,d){d.r(V);d.d(V,"NewCustomEventFactory",function(){return k});L=d(0);d=d(545);class k extends d.a{constructor(){super()}create(e,n){const r={};r.detail=n;return new CustomEvent(e,r)}}Object(L.a)(k,"NewCustomEventFactory",
d.a,[])},1170:function(L,V,d){d.r(V);d.d(V,"IECustomEventFactory",function(){return k});L=d(0);d=d(545);class k extends d.a{constructor(){super()}create(e,n){const r=window.document.createEvent("CustomEvent");r.initCustomEvent(e,!1,!1,n);return r}}Object(L.a)(k,"IECustomEventFactory",d.a,[])},1171:function(L,V,d){d.r(V);d.d(V,"CheckRoamingRightsRequest",function(){return k});L=d(0);d=d(978);class k extends d.a{constructor(){super()}HBb(){return 2}om(){return 1}}Object(L.a)(k,"CheckRoamingRightsRequest",
d.a,[])},1172:function(L,V,d){d.r(V);d.d(V,"GetRoamingLauncherRequest",function(){return k});L=d(0);d=d(978);class k extends d.a{constructor(){super()}HBb(){return 0}om(){return 2}}Object(L.a)(k,"GetRoamingLauncherRequest",d.a,[])},1173:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(359);class k extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(L.a)(k,"IconGalleryButtonProps",d.a,[])},1174:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Dvh="WAC_Powerpoint";k.Wcc=null;Object(L.a)(k,"AddinHostApp",null,[])},1175:function(L,V,d){d.d(V,"a",function(){return n});L=d(0);var k=d(206),e=d(96);class n{constructor(r){this.ix=r;this.nO=Array.indexOf(this.ix,this.gma)}dispose(){this.ix=null}get L0(){return this.ix[this.nO]}bG(r){this.nxc(r,!1);return!0}Hbb(r){this.nxc(r,!0)}nxc(r,w){r&&(this.L0!==r||w)&&(r.tabIndex=0,e.FocusManager.dr(r));Array.contains(this.ix,r)&&(this.nO=Array.indexOf(this.ix,
r))}get Dwh(){let r=this.nO;do if(r)if(0<r&&r<this.ix.length)r--;else break;else r=this.ix.length-1;while(!k.DOMFocusListing.CFa(this.ix[r])&&r!==this.nO);return this.ix[r]}get bjh(){let r=this.nO;do if(r===this.ix.length-1)r=0;else if(0<=r&&r<this.ix.length-1)r++;else break;while(!k.DOMFocusListing.CFa(this.ix[r])&&r!==this.nO);return this.ix[r]}get gma(){let r=0;for(;!k.DOMFocusListing.CFa(this.ix[r])&&r<this.ix.length;)r++;return k.DOMFocusListing.CFa(this.ix[r])?this.ix[r]:null}get sFb(){let r=
this.ix.length-1;for(;!k.DOMFocusListing.CFa(this.ix[r])&&0<r;)r--;return k.DOMFocusListing.CFa(this.ix[r])?this.ix[r]:null}}Object(L.a)(n,"DialogFocusListing",null,[317])},1176:function(L,V){Object.defineProperty(V,"__esModule",{value:!0});V.ActionRecommendationPrompt=void 0;L=V.ActionRecommendationPrompt||(V.ActionRecommendationPrompt={});L.ODSLPPT="ODSLPPT";L.TextToTableAndSmartArtPPT="TextToTableAndSmartArtPPT";L.NextSlidePPT="NextSlidePPT";L.TextGenerationForSelectedTextPPT="TextGenerationForSelectedTextPPT";
L.TextGenerationForTextBoxPPT="TextGenerationForTextBoxPPT"},1177:function(L,V,d){Object.defineProperty(V,"__esModule",{value:!0});V.ActionRecommendationAnnotation=void 0;const k=d(224);class e{constructor(n){k.SchemaObject.assign(e,this,n)}get metadata(){return this.M_}set metadata(n){this.M_=n}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(n){return k.SchemaObject.matchesTypesFor(n,
[e.getTypeName()])}}V.ActionRecommendationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1178:function(L,V){Object.defineProperty(V,"__esModule",{value:!0});V.ActionRecommendationTrigger=void 0;L=V.ActionRecommendationTrigger||(V.ActionRecommendationTrigger={});L.TextBoxSelection="TextBoxSelection";L.TextSelection="TextSelection"},1179:function(L,V,d){Object.defineProperty(V,"__esModule",{value:!0});V.ActionRecommendationSignal=void 0;const k=d(224);class e{constructor(n){k.SchemaObject.assign(e,
this,n)}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(n){return k.SchemaObject.matchesTypesFor(n,[e.getTypeName()])}}V.ActionRecommendationSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1180:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(L.a)(k,"GallerySectionProps",null,
[])},1181:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(301);class k{}k.Value="Value";k.Image16by16Class="Image16by16Class";k.Alt="Alt";k.Visible=d.a.visible;Object(L.a)(k,"LabelCommandProperties",null,[])},1182:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"AppsForOfficeEntitlementQueryInfo",null,[])},1200:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(7),n=d(1264),r=d(25),w=d(144),D=d(464),y=d(275),m=d(204),C=d(54),E=d(72),F=d(36);class B{constructor(Ga,
cb,Ob,Db,mb){this.bRd=null;this.QQ=!0;this.HQ=null;this.Qim=(Vc,Zb)=>{void 0!==Zb&&null!==Zb&&Zb&&(this.bRd=Zb.errorCode)};this.Ca=Ga;this.oi=cb;this.aKd=Ob;this.Hni=Db;this.gh=mb;r.AFrameworkApplication.hOc(this.Qim);this.Hni.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.QQ=r.AFrameworkApplication.XF,C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Vc=>{Vc.isFeatureEnabled("mso_sendASmile",
!0).then(Zb=>{this.QQ=r.AFrameworkApplication.XF&&Zb;this.oi&&this.oi.Gf();return null},()=>null)})):C.a.instance.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Vc=>{Vc.UO("Enabled").then(Zb=>{this.QQ=Zb;return null},()=>null)})}get gh(){this.HQ||(r.AFrameworkApplication.gh||(r.AFrameworkApplication.gh=new D.a),this.HQ=r.AFrameworkApplication.gh);return this.HQ}set gh(Ga){this.HQ=Ga}qb(){this.Ca.xa(F.a.w5,E.a.frame,Object(e.a)(this,this.PSj,"giveFeedbackHandler"));this.Ca.xa(F.a.Cff,
E.a.frame,Object(e.a)(this,this.Cff,"triggerFloodgateSurvey"));this.oi.Gf()}Cff(Ga,cb,Ob,Db,mb){if(1===Ob)return 32;if(2===Ob&&!mb)return 8;C.a.instance.Ha("Common.ISystemInitiatedFeedback").execute(Vc=>{Vc.logActivity(Object(n.a)(String,mb.ActivityName),Object(n.a)(String,mb.BRSName))});return 32}PSj(Ga,cb,Ob,Db,mb){if(1===Ob)return r.AFrameworkApplication.fa.getBooleanAppSetting("IsFeedbackExperiencesAvailable")||(this.QQ=!1),this.QQ&&m.SessionStatusManager.instance.p1?32:8;if(2===Ob){k.ULS.sendTraceTag(8405838,
356,50,"");this.gh.Feedback|=y.a.$lj;const Vc=mb||{};void 0!==Vc.ErrorCode&&null!==Vc.ErrorCode||null==this.bRd||(Vc.ErrorCode=this.bRd);r.AFrameworkApplication.fa.M2b(Vc);this.aKd&&(this.aKd.instance||3===r.AFrameworkApplication.za.mb.Ej&&1===r.AFrameworkApplication.za.mb.wLa||C.a.instance.ub("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.aKd.execute(Zb=>{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",!1)?w.UISurfaces.$0c().then(fc=>
{void 0!==fc&&null!==fc?(k.ULS.sendTraceTag(8405838,356,100,"OCV vNext Modal: GiveFeedbackHandler command invoked"),Zb.Ivk(Vc,fc)):(k.ULS.sendTraceTag(520626707,356,15,"FeedbackAPI not retrieved"),Zb.Bze(Vc));return fc},()=>{k.ULS.sendTraceTag(520626706,356,15,"Error while retrieving feedbackAPI");Zb.Bze(Vc);return null}):Zb.Bze(Vc)}))}return 32}}Object(L.a)(B,"CustomerFeedbackActor",null,[1729]);class H{constructor(Ga,cb,Ob){this.hZb=this.pQd=!1;this.HQ=this.aqf=null;this.C1k=Db=>{Db?(this.hZb=!0,
this.gh.Feedback|=y.a.dmj,this.rxg(),k.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.gh.Feedback|=y.a.cmj,k.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.pQd=!1};this.d9a=Ga;this.EKc=cb;this.gh=Ob}get gh(){this.HQ||(r.AFrameworkApplication.gh||(r.AFrameworkApplication.gh=new D.a),this.HQ=r.AFrameworkApplication.gh);return this.HQ}set gh(Ga){this.HQ=Ga}Bze(Ga){this.aqf=Ga;this.rxg()||this.khc()}Ivk(Ga,cb){this.d9a.c0l(Ga,cb)}khc(){this.pQd||(this.pQd=!0,this.EKc.wae(this.C1k))}rxg(){return this.hZb?
(this.d9a.a2l(this.aqf),!0):!1}AHg(Ga){this.hZb=Ga}}Object(L.a)(H,"CustomerFeedbackC3FormManager",null,[1737]);var K=d(18),A=d(682),W=d(176),N=d(251),P=d(312);class U{constructor(Ga){Ga=void 0===Ga?null:Ga;this.lBf=null;this.oJc=new K.a;this.B6k=(cb,Ob)=>{if(U.Bgc()){for(cb=0;cb<this.oJc.count;cb++)this.oJc.ga(cb)(Ob.succeeded,this.FQ);this.oJc.clear()}else this.lBf(Ob.succeeded,this.FQ)};this.FQ=Ga}wae(Ga){U.Bgc()?this.oJc.add(Ga):this.lBf=Ga;Ga="Feedback/officebrowserfeedback_floodgate.js";A.a.Bve()&&
(Ga="Feedback/latest/officebrowserfeedback_floodgate.js");var cb="OFeedbackIntl";r.AFrameworkApplication.fa.du("IsServerFlavorDebug")&&r.AFrameworkApplication.fa.getBooleanAppSetting("IsServerFlavorDebug")&&(cb+=".debug");cb+=".js";Ga=W.a.Qxb(Ga);W.a.SWi(cb);cb=null;if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)){cb=[];var Ob=W.a.Qxb("Feedback/latest/officebrowserfeedback_ecs_client.js");Ob=P.a.create(Ob);cb.push(Ob)}cb=P.a.create(Ga,
cb,null);cb.u9(this.B6k);N.a.bF(cb);k.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",Ga)}POl(Ga){this.FQ?Ga&&this.FQ.add(Ga):this.FQ=Ga}static Bgc(){return!!r.AFrameworkApplication.za&&!!r.AFrameworkApplication.za.mb&&3===r.AFrameworkApplication.za.mb.Ej&&1===r.AFrameworkApplication.za.mb.wLa}}Object(L.a)(U,"CustomerFeedbackResourceDownloadManager",null,[1736]);class Q{constructor(){this.audienceGroup=null;this.cTe=this.bnb=0}LEg(){return!this.cTe}}Object(L.a)(Q,"OCVData",null,[]);
var G=d(122),Y=d(206),ba=d(88);class ha extends Sys.EventArgs{constructor(Ga){super();this.Q6l=Ga}}Object(L.a)(ha,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ka=d(165),ca=d(65),ia=d(203),oa=d(35),sa=d(123),Ca=d(276),Ta=d(411),R=d(46),Ha=d(103),da=d(722),Ba=d(75);class za{constructor(Ga,cb){this.hVk="obf-MainContentHolder";this.wwk="obf-OverallSmileAnchor";this.Qnm="obf-visible";this.Tra=this.dWb=za.Vvd;this.fOd=this.eOd=this.QQ=!0;this.Bvf=this.Fsb=this.atf=this.OLd=this.NLd=this.LHc=this.gOd=
this.lHc=this.RYb=!1;this.pHc=!0;this.yod=this.INd=this.eWd=null;this.kWd=this.CLd=this.BFc=this.DLd=this.XKc=0;this.BQd=this.gQd=this.HQ=null;this.eei=r.AFrameworkApplication.fa.getBooleanAppSetting("FeedbackTabHandlerEnabled");this.Wd=Ga;this.gh=cb;this.Ma=new Ba.a;const Ob=this;C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fc=>{fc.isFeatureEnabled("mso_sendASmile",Ob.QQ).then(ob=>{Ob.QQ=ob;return null},()=>null);fc.isFeatureEnabled("FloodgateSurvey",Ob.LHc).then(ob=>
{Ob.LHc=ob;Ob.atf=!0;return null},()=>null)});const Db=this;r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriStateOCPSPolicyEnabled",!0)?C.a.instance.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(fc=>{fc.UO("IncludeScreenshot",!0,!1).then(ob=>{Db.RYb=ob;Db.XKc=ob?1:2;return null},ob=>{Db.XKc="PolicyNotConfigured"===ob?0:2;return null});fc.UO("IncludeEmail",!0,!1).then(ob=>{Db.lHc=ob;Db.NLd=!0;Db.BFc=ob?1:2;return null},ob=>{Db.BFc="PolicyNotConfigured"===
ob?0:2;return null});fc.UO("FeedbackIncludeLog",!0,!1).then(ob=>{Db.gOd=ob;Db.OLd=!0;Db.CLd=ob?1:2;return null},ob=>{Db.CLd="PolicyNotConfigured"===ob?0:2;return null});fc.UO("Enabled",!0,!1).then(ob=>{Db.DLd=ob?1:2;return null},ob=>{Db.DLd="PolicyNotConfigured"===ob?0:2;return null});fc.UO("SurveyEnabled",!0,!1).then(ob=>{Db.kWd=ob?1:2;return null},ob=>{Db.kWd="PolicyNotConfigured"===ob?0:2;return null})}):C.a.instance.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(fc=>
{fc.UO("IncludeScreenshot").then(ob=>{Db.RYb=ob;return null},()=>null);fc.UO("IncludeEmail").then(ob=>{Db.lHc=ob;Db.NLd=!0;return null},()=>null);fc.UO("FeedbackIncludeLog").then(ob=>{Db.gOd=ob;Db.OLd=!0;return null},()=>null)});if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",!0)){this.Fsb=r.AFrameworkApplication.fa.getBooleanAppSetting("PremiumUpsellIsEnabled");const fc=this;C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ob=>
{fc.Fsb=ob.isFreemiumUpsellEnabled();ob.isFeatureEnabled("mso_sendASmile",!1).then(ub=>{fc.Bvf=ub;return null},()=>null)})}const mb=this;C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fc=>{fc.isFeatureEnabled("FeedbackForum",mb.pHc).then(ob=>{mb.pHc=ob;return null},()=>null)});const Vc=this;C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fc=>{fc.isFeatureEnabled("FeedbackComplianceCannotConsent",Vc.eOd).then(ob=>{Vc.eOd=
ob;return null},()=>null)});const Zb=this;C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fc=>{fc.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Zb.fOd).then(ob=>{Zb.fOd=ob;return null},()=>null)});A.a.Bve()?(this.eWd=W.a.Qxb("Feedback/latest/officebrowserfeedback.css"),this.INd=W.a.$5d("Feedback/latest/Intl/")):(this.eWd=W.a.Qxb("Feedback/officebrowserfeedback.css"),this.INd=W.a.$5d("Feedback/Intl/"))}get gh(){this.HQ||(r.AFrameworkApplication.gh||
(r.AFrameworkApplication.gh=new D.a),this.HQ=r.AFrameworkApplication.gh);return this.HQ}set gh(Ga){this.HQ=Ga}get Nze(){return this.gQd||(this.gQd=document.getElementById(this.wwk))}get Nld(){return this.BQd||(this.BQd=document.getElementById(this.hVk))}Vyi(Ga){this.Ma.addHandler(za.Nmh,Ga)}LTi(){this.BQd=this.gQd=null}Ohk(Ga){return!!Ga&&0<=Ga.className.toLowerCase().indexOf(this.Qnm.toLowerCase())}c0l(Ga,cb){if(!r.AFrameworkApplication.XF)k.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");
else if(this.QQ)if(k.ULS.sendTraceTag(508952780,356,50,"Feedback api retrieved"),r.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.delayFeedbackForPolicies"))this.B$i(()=>{this.Pal(Ga,cb)});else{k.ULS.sendTraceTag(520626705,356,50,"Feedback api retrieved");const Ob=Ga||{};this.getContext(Ob);cb.initializeFeedbackModal(Ob,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"));k.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus.");
this.gh.Feedback|=y.a.$ce}}Pal(Ga,cb){this.Tra=this.clearInterval(this.Tra);Ga=Ga||{};this.getContext(Ga);cb.initializeFeedbackModal(Ga,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"));k.ULS.sendTraceTag(508952779,356,50,"Successfully opened feedback form and set focus.");this.gh.Feedback|=y.a.$ce}B$i(Ga){let cb=300;this.Tra=this.clearInterval(this.Tra);this.Tra=window.setInterval(()=>{this.uPf()&&Ga();cb*=2;1E4<cb&&(Ga(),k.ULS.sendTraceTag(508952778,356,10,"Failed to retrieve correct OCPS policies due to timeout"))},
cb)}a2l(Ga){if(!r.AFrameworkApplication.XF)k.ULS.sendTraceTag(520626704,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.QQ){Ga=Ga||{};this.getContext(Ga);var cb=za.cbj(Ga.AppMode||"Unknown");da.BrowserFeedbackControlOCV.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,cb,Ga);this.i$j();za.allowKeytips(!1);k.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");
this.gh.Feedback|=y.a.$ce}}Pmj(Ga,cb){cb&&2>=cb.bnb&&(Ga.userEmailConsentDefault=!0);cb=r.AFrameworkApplication.fa.Ea("UserPrincipalName");Ga.userEmail=cb&&0<cb.length?cb:""}$fg(Ga){const cb={};if(void 0!==Ga.appData&&null!==Ga.appData){var Ob=Ga.appData;for(var Db in Ob)cb[Db]=Ob[Db]}cb.App=Ga.Application||"";cb.AppMode=Ga.AppMode||"";cb.AppModeExt=Ga.ApplicationMode||"";cb.Host=Ga.Host||"";cb.Language=Ga.locale;cb.IsError=Ga.Error||!1;cb.IsCrash=Ga.Crash||!1;cb.ServerDocId=Ga.ServerDocId||"";Ga.ErrorCode&&
""!==Ga.ErrorCode.toString()&&(cb.IsError=!0);"Origin"in Ga&&(cb.Origin=Ga.Origin);cb.ClientThrottlingProtection=this.gh.ClientThrottlingProtection||"";cb.HostServiceLevel=this.gh.HostServiceLevel||"";cb.RequestedCallThrottling=this.gh.RequestedCallThrottling||"";cb.WacServiceLevel=this.gh.WacServiceLevel||"";this.gh.HostResponseStats&&(Ob=this.gh.HostResponseStats.Label)&&(cb.HostFarmHint=Ob);Ob=r.AFrameworkApplication.fa;(Db=Ob.Ea(r.AFrameworkApplication.uL))&&""!==Db&&(cb.UiHost=Db);(Db=Ob.Ea(r.AFrameworkApplication.D0h))&&
""!==Db&&(cb.UiHostIntegrationType=Db);Ob.getBooleanAppSetting("OcvFeedbackIncludesSessionOriginIsEnabled")&&(Ob=Ga.SessionOrigin,Ob&&""!==Ob||(Ga=Ga.SourceControlId)&&""!==Ga&&sa.a(sa.d(Ga),"feedback")&&(Ob=this.Lhg().SessionOrigin),Ob&&""!==Ob&&(cb.SessionOrigin=Ob));Ga=null;try{Ga=oa.c(cb),Ga=R.a.Tea(Ga,R.a.lFb)}catch(mb){Ga="",k.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData: {0}",mb.message)}return{["appData"]:Ga||""}}Iyj(Ga){const cb={};for(const Ob in Ga)cb[Ob]=Ga[Ob];
cb.IsFreemiumUpsellEnabled=this.Fsb;cb.IsAadcEnabled=this.Bvf;cb.IsFeedbackEnabled=this.QQ;return cb}Lyj(){let Ga=null;try{const cb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);cb&&(Ga=oa.b(cb))}catch(cb){k.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return Ga||{}}hxj(Ga,cb){Ga.clientFeedbackId||(Ga.clientFeedbackId=Ha.a.create().toString());if(Ga&&cb){Ga.LanguageID?Ga.locale=Ca.a.Oe(Ga.LanguageID).name||
"":Ga.ApplicationLCID&&(Ga.locale=Ga.ApplicationLCID);Ga.applicationGroup=this.$fg(Ga);Ga.applicationSettings=this.Iyj(r.AFrameworkApplication.fa.appSettings);Ga.webSurfacesSettings=this.Lyj();Ga.userfactConfig=za.$Qj();za.e5f(cb,Ga);Ga.appId=za.hbj();Ga.environment=cb.cTe;Ga.stylesUrl=this.eWd;Ga.intlUrl=this.INd;Ga.rtl=r.AFrameworkApplication.fa.getBooleanAppSetting("Rtl")?"rtl":"ltr";var Ob=za.gbj();Ga.primaryColour=Ob.primaryColour;Ga.secondaryColour=Ob.secondaryColour;Ga.sessionId=Ga.SessionID||
Ga.WACSessionID||"";Ga.build=Ga.ApplicationVersion||Ga.WFEVersion||"";Ob=Ga.FlightIDs?Ga.FlightIDs.toString():Ga.Flights?Ga.Flights.toString():"";var Db="";Ga.ErrorCode&&(Db=Ga.ErrorCode.toString());var mb=this.pIj(Ga),Vc=cb.LEg()?r.AFrameworkApplication.fa.Ea("TenantId"):"";Vc&&"0"!==Vc||(Vc="");var Zb=r.AFrameworkApplication.fa.Ea("LoggableUserIdSpace"),fc=r.AFrameworkApplication.fa.Ea("LoggableUserId")||"";switch(Zb){case "MsaPuid":fc="p:"+fc;break;case "MsaCid":fc="m:"+fc;break;case "OrgIdPuid":fc=
"a:"+(r.AFrameworkApplication.fa.Ea("AADUserObjectId")||fc);break;default:k.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: {0}, LoggableUserIdSpace: {1}",fc,Zb),fc=""}Zb={};if(void 0!==Ga.telemetryGroup&&null!==Ga.telemetryGroup){const ob=Ga.telemetryGroup;for(const ub in ob)Zb[ub]=ob[ub]}Zb.audienceGroup=cb.audienceGroup;Zb.audience=cb.audienceGroup;Zb.flights=Ob;Zb.platform=mb;Zb.ringId=cb.bnb;Zb.officeUILang=r.AFrameworkApplication.lcid;Zb.errorCode=Db;Zb.loggableUserId=
fc;Zb.processSessionId=Ga.SessionID||Ga.WACSessionID||"";Zb.officeBuild=Ga.ApplicationVersion||Ga.WFEVersion||"";0<Vc.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==Vc&&(Zb.tenantId=Vc);Ga.telemetryGroup=Zb;Ga.webGroup={["browser"]:Ga.Browser||"",["browserVersion"]:(Ga.BrowserMajorVersion||"")+"."+(Ga.BrowserMinorVersion||""),["dataCenter"]:Ga.Datacenter||Ga.WACDatacenter||""};Ga.isCommercialHost=r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost");this.abj(Ga);Ga.disableIncludeScreenshot=
!this.RYb;Ga.screenshot=this.RYb;Ga.showEmailAddress=this.lHc;r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriStateOCPSPolicyEnabled",!0)?(Ga.emailPolicyValue=this.BFc,Ga.policyAllowContact=this.BFc,Ga.policyAllowContent=this.CLd,Ga.policyAllowFeedback=this.DLd,Ga.policyAllowSurvey=this.kWd,Ga.screenshotPolicyValue=this.XKc,Ga.policyAllowScreenshot=this.XKc):(Ga.emailPolicyValue=this.lHc?1:0,Ga.policyAllowContent=this.gOd?1:0,Ga.policyAllowFeedback=this.QQ?1:0,Ga.policyAllowSurvey=
this.LHc?1:0,Ga.screenshotPolicyValue=this.RYb?1:0);r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost")||(Ga.disableIncludeScreenshot=!1,Ga.showEmailAddress=!0,Ga.screenshot=!0);r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&(Ga.surveyEnabled=this.LHc,r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost")&&(Ga.showEmailAddress=!0,Ga.surveyEnabled=!0));this.Pmj(Ga,cb);this.yod=Ga.DismissHandler?
Ga.DismissHandler:null;this.Zaj(Ga)}}uPf(){return this.NLd&&this.atf&&this.OLd}getContext(Ga){Ga=Ga||this.Lhg();const cb=new Q;this.hxj(Ga,cb);return Ga}pIj(Ga){let cb="";Ga.Platform&&(cb=Ga.Platform.toString());Ga.PlatformMajorVersion&&(0<cb.length&&(cb+=" "),cb+=Ga.PlatformMajorVersion.toString()+".");Ga.PlatformMinorVersion&&(cb+=Ga.PlatformMinorVersion.toString());return cb}W4l(Ga){Ga.ApplicationMode&&(Ga.AppMode=Ga.ApplicationMode);Ga.ApplicationModeExtended&&(Ga.ApplicationMode=Ga.ApplicationModeExtended)}Lhg(){let Ga;
try{Ga=oa.b(r.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.W4l(Ga)}catch(cb){k.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),Ga={}}return Ga}onError(Ga){Ga=Ta.a.Ocb(Ga);k.ULS.sendTraceTag(37259477,356,10,"FB submit error: {0}",Ga);this.gh.Feedback|=y.a.bmj;za.allowKeytips(!0)}qdj(){if(za.zDg()){k.ULS.sendTraceTag(40112215,356,50,za.Rjh);var Ga=C.a.instance.resolve("Common.ISystemInitiatedFeedback");Ga&&Ga.logActivity("AppUsageNPSLocalizationTest",
null)}}onDismiss(Ga){this.sqa();this.LTi();ka.a.WLb()&&k.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ka.a.tYa()&&ba.c(Ga?F.a.Zlj:F.a.Ulj,!0,null,2,8);Ga?(ka.a.WLb()&&k.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.gh.Feedback|=y.a.emj):(this.gh.Feedback|=y.a.amj,this.qdj());this.Ma.raiseEvent(za.Nmh,new ha(Ga));za.allowKeytips(!0);this.yod&&(this.yod(),this.yod=null)}i$j(){if(this.Wd){let Ga=!1,cb=5,Ob=!1;this.Tra=this.clearInterval(this.Tra);this.dWb=this.clearInterval(this.dWb);this.dWb=
window.setInterval(()=>{if(this.Nze){Ob=!0;var Db=this.Wd.Kc(za.wab);Db.uK=!0;Db.parent=G.AFrame.Nj;Db.v9a(za.b9i);Db.cea(()=>{let mb=this.Wd.DR(za.wab),Vc=null,Zb=5,fc=!1;this.Tra=window.setInterval(()=>{this.Ohk(this.Nld)&&(fc=!0,this.Nze.focus(),mb||(mb=this.Wd.DR(za.wab)),mb&&!Vc&&(Vc=mb.jk),Vc&&Vc.bG(this.Nze));Zb--;if(fc||!Zb)this.Tra=this.clearInterval(this.Tra)},1E3)});Ga||(this.Wd.dW(za.wab,!0),Ga=!0);this.eei&&this.Nld&&(Db=new Y.DOMFocusListing(()=>this.Nld),Db.xp(1),Db.xp(2),Db.xp(3),
Db.xp(5),Db=this.Wd.hla(()=>this.Nld,this.Wd.Kc(za.wab),Db),Db.xmb(),Db.IY=!0,Db.HTa=!0,Db.Whh())}cb--;if(Ob||!cb)this.dWb=this.clearInterval(this.dWb)},1E3)}}clearInterval(Ga){Ga!==za.Vvd&&(window.clearInterval(Ga),Ga=za.Vvd);return Ga}sqa(){this.Wd&&(this.Wd.P2(za.wab),this.Wd.rPb(za.wab))}Zaj(Ga){this.eOd?this.fOd||(Ga.ageGroup=4):Ga.ageGroup=3;r.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser")?Ga.authenticationType=2:Ga.authenticationType="aad"===r.AFrameworkApplication.fa.Ea("HostAuthType")?
1:0}abj(Ga){this.pHc&&(Ga.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",Ga.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.pHc){const cb=za.bbj();void 0!==cb&&null!==cb&&(Ga.feedbackPortalUrl=cb,Ga.feedbackForumUrl=cb)}}static allowKeytips(Ga){r.AFrameworkApplication.za.mb.Xp&&ca.a("allowKeytips")&&appChrome.api.allowKeytips(Ga)}static ogj(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSendUserFacts",
!1)}static pgj(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTargetedMessagingServiceFactRequest",!1)}static qcj(){let Ga=null;try{const cb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.DisabledUserFacts","");cb&&""!==cb&&(Ga=cb.split(","))}catch(cb){k.ULS.sendTraceTag(509104515,356,10,"Could not parse DisabledUserFacts")}return Ga||[]}static $Qj(){const Ga={};Ga.enableSendUserFacts=za.ogj();Ga.enableTargetedMessagingServiceFactRequest=
za.pgj();Ga.disabledUserFacts=za.qcj();Ga.userFactRules=za.k7i();Ga.personalizationEventSamplingRate=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.PersonalizationEventSamplingRate",1);Ga.environment=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.PersonalizationEnvironment","Prod");return Ga}static k7i(){const Ga={};Ga["Office.Word.Online.UserAction.RewriteCardSeen"]=da.BrowserFeedbackControlOCV.rWa("EditorSeen");Ga["Office.Word.Online.UserAction.RewriteCardTried"]=
da.BrowserFeedbackControlOCV.rWa("EditorTried");Ga["Office.Excel.Online.UserAction.FormatAsTable"]=da.BrowserFeedbackControlOCV.rWa("FormatAsTableTried");Ga["Office.Graphics.M365ContentPicker.GeneralInfo"]=da.BrowserFeedbackControlOCV.rWa("CreativeContentSeen");Ga["Office.Graphics.M365ContentPicker.Insert"]=da.BrowserFeedbackControlOCV.rWa("CreativeContentTried");Ga.ExcelWebLastUsed=da.BrowserFeedbackControlOCV.rWa("ExcelWebLastUsed");Ga.PowerPointWebLastUsed=da.BrowserFeedbackControlOCV.rWa("PowerPointWebLastUsed");
Ga.WordWebLastUsed=da.BrowserFeedbackControlOCV.rWa("WordWebLastUsed");return Ga}static e5f(Ga,cb){if(cb){Ga.bnb=parseInt(cb.Ring);if(isNaN(Ga.bnb))Ga.audienceGroup="Unknown",Ga.bnb=-2;else switch(Ga.bnb){case 0:case 1:Ga.audienceGroup="Dogfood";break;case 2:Ga.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:Ga.audienceGroup="Production";break;default:Ga.audienceGroup="Unknown"}var Ob=!0;cb.Host&&(Ob="MsInternal"!==cb.Host&&"Blue Chicken"!==cb.Host);Ga.cTe=Ob?0:1}}static hbj(){let Ga=
0;switch(ia.Redirect.application){case 2:Ga=2155;break;case 4:Ga=2158;break;case 3:Ga=2157;break;case 1:Ga=2156;break;case 5:Ga=2159;break;default:k.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",ia.Redirect.application.toString())}return Ga}static gbj(){const Ga={};let cb="#2B579A",Ob="#3C65A4";switch(ia.Redirect.application){case 2:r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.getBooleanAppSetting("AppColorUpdateIsEnabled")?(cb="#185ABD",Ob="#2E6AC5"):(cb="#2B579A",Ob="#3C65A4");
break;case 4:cb="#7719AA";Ob="#9953C0";break;case 3:cb="#B7472A";Ob="#C75033";break;case 1:cb="#217346";Ob="#3F8159";break;case 5:cb="#3955A3";Ob="#4D6AB8";break;default:k.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",ia.Redirect.application.toString())}Ga.primaryColour=cb;Ga.secondaryColour=Ob;return Ga}static bbj(){let Ga=null;switch(ia.Redirect.application){case 2:Ga="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:Ga="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";
break;case 3:Ga="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:Ga="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:Ga="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:k.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",ia.Redirect.application.toString())}return Ga}static cbj(Ga){let cb=356;switch(ia.Redirect.application){case 2:switch(Ga){case "Edit":cb=364;break;case "View":case "Attendee":case "Presenter":cb=
363;break;default:k.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",r.AFrameworkApplication.za.Q0a),cb=363}break;case 4:cb=362;break;case 3:switch(Ga){case "Edit":cb=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":cb=360;break;default:k.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",r.AFrameworkApplication.za.Q0a),cb=360}break;case 1:switch(Ga){case "Edit":cb=
358;break;case "View":cb=357;break;case "Survey":cb=359;break;default:k.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",r.AFrameworkApplication.za.Q0a),cb=357}break;case 5:switch(Ga){case "View":cb=373;break;case "Edit":cb=374;break;default:k.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",r.AFrameworkApplication.za.Q0a),cb=373}break;default:k.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",
ia.Redirect.application.toString())}return cb}static b9i(){k.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static zDg(){if(!za.SSe){const Ga=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.getBooleanAppSetting(za.Rjh);za.SSe=Ga?2:1}return 2===za.SSe}}za.wab="CustomerFeedbackFocusId";za.Nmh="FUID";za.Vvd=-1;za.SSe=0;za.Rjh="NPSLocalizationTestingIsEnabled";Object(L.a)(za,"CustomerFeedbackUiWrapper",null,[561]);var Aa=d(15),na=d(1268),la=d(1267);class va{constructor(Ga,
cb,Ob,Db){this.Tof=Ga;this.ija=cb;this.Sof=Ob;this.Wji=Db}activityName(){return this.ija}object(){return this.Wji}}Object(L.a)(va,"OneCallBackData",null,[]);class Pa{constructor(Ga,cb,Ob,Db){this.IPa=[];Array.add(this.IPa,new va(Ga,cb,Ob,Db))}add(Ga){Ga&&Array.addRange(this.IPa,Ga.IPa)}NTi(){Array.clear(this.IPa)}}Object(L.a)(Pa,"CallBackData",null,[]);var Qa=d(541);class Ua extends Qa.a{constructor(Ga,cb,Ob,Db,mb,Vc,Zb,fc,ob,ub,bc){Ob=void 0===Ob?null:Ob;Db=void 0===Db?!1:Db;mb=void 0===mb?!1:mb;
Vc=void 0===Vc?null:Vc;Zb=void 0===Zb?null:Zb;fc=void 0===fc?null:fc;ob=void 0===ob?!1:ob;ub=void 0===ub?null:ub;bc=void 0===bc?null:bc;super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.showFeedbackBar=!1;this.negativeFeedbackAction=this.positiveFeedbackAction=null;this.footer=Ga;this.message=cb;this.image=Ob;this.positionImageAtLeft=Db;this.smallHeadline=
mb;this.title=Vc;this.primaryButtonProps=Zb;this.secondaryButtonProps=fc;this.showFeedbackBar=ob;this.positiveFeedbackAction=ub;this.negativeFeedbackAction=bc}}Object(L.a)(Ua,"FloodgateCalloutContent",Qa.a,[]);class Ya{constructor(){this.props=this.options=null}}Object(L.a)(Ya,"Notification",null,[]);var Ea=d(1164),La=d(953),xb=d(356);class dc extends Qa.a{constructor(Ga,cb,Ob,Db){Ob=void 0===Ob?null:Ob;Db=void 0===Db?null:Db;super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=
this.title=null;this.title=Ga;this.content=cb;this.imageProps=Ob;this.imageHeight=Db}}Object(L.a)(dc,"PremiumUpsellCalloutContentProps",Qa.a,[]);var gb=d(954),gc=d(952);class Ac{static Q6d(Ga){return Ac.xJj().then(cb=>{try{const Ob=[];for(let Db=0;Db<Ga.length;Db++){const mb=Ga[Db],Vc=Ac.urk(mb.surfaceType),Zb=new Ya;Zb.options=Ac.QGj(mb,!Vc);Zb.props=Vc?cb.callout(Ac.uVk(Ga[Db])):cb.externalNotification();Ob.push(Zb)}return Ac.m0l(cb,Ob)}catch(Ob){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+
Ob.message);}})}static urk(Ga){switch(Ga.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static QGj(Ga,cb){const Ob=new xb.a;cb&&(Ob.onShow=Ga.onUnsupportedSurfaceType);Ob.telemetryId="FloodgateTeachingUx-Surface"+(cb?"NotSupported":"Supported");return Ob}static uVk(Ga){if("premiumupsell"!==Ga.surfaceType.toLowerCase()){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowTUIFeedbackBar",!1)?Ga.showFeedbackBar=
!0:Ga.showFeedbackBar=!1;var cb=new Ua(Ga.footer,Ga.description,Ga.illustrationImage?Object.assign(new gc.a(Ga.illustrationImage),{ariaLabel:Ga.imageAriaLabel}):null,"left"===Ga.position,Ga.smallHeadline,Ga.title,Ac.QZc(Ga.primaryButtonText,Ga.primaryButtonAction),Ac.QZc(Ga.secondaryButtonText,Ga.secondaryButtonAction),Ga.showFeedbackBar,Ga.feedbackPositiveButtonAction,Ga.feedbackNegativeButtonAction)}else cb=new dc(Ga.title,Ga.description,Ga.illustrationImage?Object.assign(new gc.a(Ga.illustrationImage),
{ariaLabel:Ga.imageAriaLabel}):null);cb=Object.assign(new La.a,{target:Ga.selector,content:cb,showCloseIcon:null!=Ga.hasCloseButton?Ga.hasCloseButton:!0,preventLightDismiss:null!=Ga.preventAutoDismiss?Ga.preventAutoDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new gb.a,{onDismiss:Ob=>{if(Ga.onClosed)if(Ob)Ga.onClosed("close");else Ga.onClosed("auto dismiss")},directionalHint:Ga.anchorHint,setInitialFocus:!0})});"coachmark"===Ga.surfaceType.toLowerCase()?(cb.hasDynamicSizing=!1,cb.useCoachmark=
!0,cb.calloutProps.setInitialFocus=!1):"premiumupsell"===Ga.surfaceType.toLowerCase()&&(cb.primaryButtonProps=Ac.QZc(Ga.primaryButtonText,Ga.primaryButtonAction),cb.secondaryButtonProps=Ac.QZc(Ga.secondaryButtonText,Ga.secondaryButtonAction),cb.showCloseIcon=!1,cb.useTeachingStyles=!1,cb.calloutProps.preventDismissOnLostFocus=!1);return cb}static QZc(Ga,cb){return Ga&&""!==Ga&&cb?Object.assign(new Ea.a,{label:Ga,onExecute:cb}):(k.ULS.shipAssertTag(594569111,356,(!Ga||""===Ga)&&!cb,"A callout button needs both a caption and an action."),
null)}static xJj(){Ac.DYc||(r.AFrameworkApplication.za.mb.bYa&&r.AFrameworkApplication.fa.getBooleanAppSetting("WacFloodgateNotificationsIntegrationIsEnabled")?Ac.DYc=w.UISurfaces.BM().then(Ga=>{const cb=new Ua(null,null);if(Ga.isCustomContentSupported&&Ga.isCustomContentSupported(cb))return Ga;throw Error.create("Custom Content not supported: "+cb.type);},Ga=>{k.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",Ga);return null}):Ac.DYc=Promise.reject("React Notifications not enabled"));
return Ac.DYc}static m0l(Ga,cb){if(!cb||!cb.length)return[];const Ob=[];for(let Db=0;Db<cb.length;Db++){const mb=Ac.a1l(Ga,cb[Db]);Ob.push(mb)}return Ob}static a1l(Ga,cb){const Ob=Ga.addNotification(cb.props,cb.options);return()=>{Ga.removeNotification(Ob)}}}Ac.DYc=null;Object(L.a)(Ac,"FloodgateNotifications",null,[]);class $b{static jIj(){switch(r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.PersonalizationEnvironment","Prod")){case "Edog":return $b.Gfj;case "Int":return $b.fck;
case "Prod":return $b.P3f;default:return $b.P3f}}static YEl(){const Ga=r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost"),cb=r.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser");return!Ga||cb?(k.ULS.sendTraceTag(508641601,356,50,"PersonalizationAuthManager - Invalid user isConsumerHost={0}, isAnonymousUser={1}",Ga,cb),Promise.resolve(null)):new Promise((Ob,Db)=>{C.a.instance.Ha("Common.App.OAuth.IOAuthManager").execute(mb=>{mb||(k.ULS.sendTraceTag(508905243,356,15,
"PersonalizationAuthManager oauthManager not valid"),Db("PersonalizationAuthManager oauthManager not valid or auth is not supported in session"));const Vc=$b.jIj();mb.vH("Tulips",Vc).then(Zb=>{Zb&&Zb.IsSuccess?(k.ULS.sendTraceTag(508905242,356,50,"PersonalizationAuthManager got auth token"),Ob(Zb.Token)):(k.ULS.sendTraceTag(508905241,356,15,"PersonalizationAuthManager Error - "+(Zb?Zb.ErrorMessage:"")),Db("PersonalizationAuthManager oauthManager auth token Error - "+(Zb?Zb.ErrorMessage:"")));return null})})})}}
$b.P3f="https://attributes.engagement.office.com";$b.Gfj="https://attributes.engagement.officeppe.com";$b.fck="https://attributes.engagement.office-int.com";Object(L.a)($b,"PersonalizationAuthManager",null,[]);const jc=(Ga,cb)=>{Ga=r.AFrameworkApplication.fa.Ea("UserPrincipalName");if(cb=!!cb.gkh&&2===cb.gkh.bnb)cb=(cb=Ga.toLowerCase())?0<cb.indexOf("linkedin.com")||0<cb.indexOf("linkedin.biz"):!1;return cb};class pb{constructor(Ga,cb){this.gkh=Ga;this.context=cb}}Object(L.a)(pb,"SurveyMetadata",
null,[]);var $a=d(67),zc=d(277),rb=d(94),ib=d(80);class Vb{constructor(Ga){this.IXa=this.isInitialized=!1;this.Gla=this.Tqb=null;this.g5a=!1;this.Scf=null;this.JBg=!1;this.NUc=0;this.Y3f=-1;this.lYe=this.MUc=null;this.WWa=!0;this.Qrc=()=>{this.g5a||this.start()};this.tal=()=>{this.g5a||this.stop()};this.DUh=()=>{da.BrowserFeedbackControlOCV.Fpj();this.I$l()};this.wdg=(cb,Ob)=>{k.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+cb);let Db="";Ob&&Ob.IPa&&
0<Ob.IPa.length&&(Db=Ob.IPa[0].activityName());if(cb)if(A.a.Bve())if(this.isInitialized)this.gae(Ob);else{if(this.IXa||!this.lYe)this.lYe=this.evh();this.lYe.then(()=>{this.gae(Ob)}).catch(mb=>this.fvh(Db,mb))}else this.evh().then(()=>{this.gae(Ob)}).catch(mb=>this.fvh(Db,mb));else this.IXa=!0,k.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+Db)};this.Hpj=cb=>{this.la||this.Fak();let Ob=cb;cb&&0<cb.length&&(Ob=this.la&&this.la.Ib(cb)?this.la.ga(cb):cb);return Ob?
Ob:""};this.qal=cb=>{if(cb=cb?cb.detail:null){var Ob=!r.AFrameworkApplication.fa.getBooleanAppSetting("WacFloodgateNotificationsIntegrationIsEnabled"),Db=(cb.action||"").toLowerCase();switch(Db){case "dismissed":Ob&&zc.a.instance.zp("obf-DynamicWebSurfaces");break;case "updated":Ob&&da.BrowserFeedbackControlOCV.Jka("obf-DynamicWebSurfaces");break;case "opened":case "":Db=cb.telemetryEventName;let mb;try{mb=JSON.stringify(cb)}catch(Vc){mb="id : "+cb.id+" telemetryEventName: "+Db,k.ULS.sendTraceTag(51131789,
306,50,"Error serializing campaign event. "+mb+" Error: "+(Vc?Vc.toString():""))}cb.success?this.JJg(Db,mb):k.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+mb);cb.isHidden||cb.isAA||!Ob||da.BrowserFeedbackControlOCV.Jka("obf-DynamicWebSurfaces");break;default:k.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+Db)}}};this.CVe=(cb,Ob)=>{ka.a.WLb()&&k.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",Ob,cb);ka.a.tYa()&&ba.c(Ob?F.a.dmm:
F.a.cmm,!0,null,2,8);zc.a.instance.zp(da.BrowserFeedbackControlOCV.qee)};this.sR=Ga;this.LAc={};this.fQf=!1;this.PPb=this.la=null;this.CYc=0}Jak(Ga){this.isInitialized&&this.Tqb||this.IXa?k.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===Ga?k.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.g5a=Ga.g5a,k.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}yak(){const Ga=
this.sR.getContext(null),cb=new Q;za.e5f(cb,Ga);this.Scf=new pb(cb,Ga);this.PPb=new Aa.ScriptSharpLegacyMap;this.PPb.$("LinkedInWACUsage",jc)}get Svb(){this.Tqb||(this.Tqb=C.a.instance.ub("Common.App.IAppSpecificFeedbackData"));return this.Tqb}logActivity(Ga,cb,Ob){Ob=void 0===Ob?null:Ob;Ga&&this.Ebb(Ga,Vb.Tjb,cb)&&(this.isInitialized?(k.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+Ga),da.BrowserFeedbackControlOCV.logActivity(Ga,Ob)):(k.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+
Ga),this.Tpe(new Pa(da.BrowserFeedbackControlOCV.logActivity,Ga,null,Ob))))}pAe(Ga){try{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&k.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+Ga),-1===this.Y3f&&(this.Y3f=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Vb.A3f)),this.MUc||(this.MUc=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList",
" ").toString().toLowerCase()),!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.MUc&&Ga&&Ga.startsWith("Ribbon_")&&-1===this.MUc.indexOf(Ga.toLowerCase())?k.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.NUc&&r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.NUc),k.ULS.sendTraceTag(592217693,
356,50,"SIFB: LogActivityDeferred cancelled "+Ga)),this.NUc=window.setTimeout(()=>{this.NUc=0;this.logActivity(Ga,null)},Vb.A3f)):k.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+Ga)}catch(cb){k.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(cb?cb.toString():""))}}ohc(Ga,cb){Ga&&this.Ebb(Ga,Vb.Tjb,cb)&&(this.CJg(Ga,cb),this.LAc[Ga]=cb)}CJg(Ga,cb){this.Ebb(Ga,Vb.Tjb,cb)&&(this.isInitialized?(k.ULS.sendTraceTag(37754501,
356,50,"SIFB: LogActivityStartInternal "+Ga),da.BrowserFeedbackControlOCV.ohc(Ga,null)):(k.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+Ga),this.Tpe(new Pa(da.BrowserFeedbackControlOCV.ohc,Ga,null,null))))}zJg(Ga){Ga&&this.isInitialized&&this.Ebb(Ga,Vb.Tjb,void 0)&&(Ga in this.LAc&&delete this.LAc[Ga],this.AJg(Ga,void 0))}AJg(Ga,cb){this.isInitialized&&this.Ebb(Ga,Vb.Tjb,cb)&&(k.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+Ga),da.BrowserFeedbackControlOCV.zJg(Ga))}Cob(Ga,
cb){if(this.Ebb(Ga,Vb.Tjb,cb))if(this.Svb){if(cb=this.Svb.Ple(Ga))this.isInitialized?(k.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+Ga),da.BrowserFeedbackControlOCV.Cob(cb)):(k.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+Ga),this.Tpe(new Pa(null,null,da.BrowserFeedbackControlOCV.Cob,cb)))}else k.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}Ebb(Ga,cb,Ob){if(this.IXa)return!1;if(!r.AFrameworkApplication.XF)return k.ULS.sendTraceTag(37601796,
356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.Mik())return!1;this.R1i();return(this.yhk(Ga)||this.N8i(Ga)||this.Mdk(Ga))&&this.fJi(cb,Ob)&&this.u7l(Ga)}R1i(){if(!this.Tqb){const Ga=C.a.instance.ub("Common.App.IAppSpecificFeedbackData");Ga?this.Tqb=Ga:k.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}Nik(Ga){return 6!==Ga&&7!==Ga}Mik(){if(0===this.CYc){const Ga=this.sR.getContext(null);this.CYc=this.Nik(parseInt(Ga.Ring))?1:2;2===
this.CYc&&k.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.CYc}u7l(Ga){null===this.PPb&&this.yak();return Ga&&this.PPb&&this.PPb.Ib(Ga)?this.PPb.ga(Ga)(Ga,this.Scf):!0}Ayj(){if(!this.Gla&&!this.fQf){this.fQf=!0;const Ga=this.sR.getContext(null);this.Gla="locale"in Ga?Ga.locale:"";this.Gla=this.Gla.toLowerCase()}return this.Gla}N8i(Ga){this.Gla||(this.Gla=this.Ayj());if(!(this.Gla&&this.Gla.length&&Ga&&Ga.length))return!1;let cb="en-us"===this.Gla||
this.amk(Ga)||za.zDg();!cb&&this.Plk(Ga)&&(cb=this.Qlk(this.Gla));return cb}Plk(Ga){return this.Svb?"AppUsageNPS"===Ga||"AppUsageTimeSatisfiedNPS"===Ga||"SuiteUsageNPS"===Ga||"SuiteUsageTimeSatisfiedNPS"===Ga:(k.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+Ga),!1)}yhk(Ga){return!!Ga&&-1!==Ga.toLowerCase().indexOf("floodgateflight")}amk(Ga){return!!Ga&&-1!==Ga.toLowerCase().indexOf("nlqs")}Qlk(Ga){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",
!1))return!0;if(!Ga||!Ga.length)return!1;if(!r.AFrameworkApplication.fa.getBooleanAppSetting("WacNPSLocalizedLanguagesEnabled"))return"en-us"===Ga;let cb=!1;switch(Ga){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":cb=!0}return cb}fJi(Ga,cb){return r.AFrameworkApplication.fa.getBooleanAppSetting(Ga)?
cb&&!r.AFrameworkApplication.fa.getBooleanAppSetting(cb)?(k.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+cb+") is off"),!1):!0:(k.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+Ga+") is off"),!1)}Mdk(Ga){const cb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!Ga&&!!cb&&-1!==cb.toLowerCase().indexOf(Ga.toLowerCase())}Tpe(Ga){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1))r.AFrameworkApplication.fa.Ue(()=>{try{this.aWc(Ga)}catch(cb){k.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+cb)}});else try{this.aWc(Ga)}catch(cb){k.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+cb)}}Dbf(){this.g5a&&this.start()}W5l(){this.g5a&&this.stop()}start(){k.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",
!1)){const Ga=ib.a.VTc(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",10),this.DUh,r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));r.AFrameworkApplication.Be.Jb(Ga)}else this.DUh(null)}stop(){k.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.H$l(),da.BrowserFeedbackControlOCV.Gpj())}I$l(){const Ga=this.LAc;for(const cb in Ga)this.CJg(cb,
Ga[cb])}H$l(){const Ga=this.LAc;for(const cb in Ga)this.AJg(cb,Ga[cb])}aWc(Ga){k.ULS.sendTraceTag(36546388,356,100,"SIFB: Entered DownloadResources");var cb=C.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");cb&&(cb.hZb?this.wdg(!0,Ga):(cb=C.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),cb.POl(Ga),cb.wae(this.wdg)))}fvh(Ga,cb){this.IXa=!0;k.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+
Ga+". "+cb.toString())}evh(){const Ga=this;return xR(function*(){var cb=C.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");cb&&cb.AHg(!0);Ga.FVl();Ga.fVl();Ga.initOptions();if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isCopilotLicenseEnabled",!1))try{yield da.BrowserFeedbackControlOCV.Jgk()}catch(Ob){k.ULS.sendTraceTag(508368320,356,10,"Error in call for BrowserFeedbackControlOCV.isCopilotLicenseConfigurationSuccessful "+(Ob?Ob.toString():
" "))}if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost"))return Ga.Wtj().then(Ob=>{Ga.yAe(Ob);return Ob}).then(Ob=>da.BrowserFeedbackControlOCV.Ipe(Ga.CVe,Object(e.a)(Ga.sR,Ga.sR.onError,"onError"),Ob,Object(e.a)(Ga.sR,Ga.sR.onDismiss,"onDismiss")));if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost")&&r.AFrameworkApplication.fa.getBooleanAppSetting("OcpsIsEnabled"))return Vb.y$i(Ga.vkg()).then(()=>{const Ob=Ga.Lfe();Ga.yAe(Ob);return Ob}).then(Ob=>da.BrowserFeedbackControlOCV.Ipe(Ga.CVe,Object(e.a)(Ga.sR,Ga.sR.onError,"onError"),Ob,Object(e.a)(Ga.sR,Ga.sR.onDismiss,"onDismiss")));cb=Ga.Lfe();Ga.yAe(cb);return da.BrowserFeedbackControlOCV.Ipe(Ga.CVe,Object(e.a)(Ga.sR,Ga.sR.onError,"onError"),cb,Object(e.a)(Ga.sR,Ga.sR.onDismiss,
"onDismiss"))}())}Wtj(){return new Promise(Ga=>{C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(cb=>{const Ob=this.Lfe();cb.isFeatureEnabled("FloodgateSurvey",!0).then(Db=>{Ob.surveyEnabled="surveyEnabled"in Ob?Db&&Ob.surveyEnabled:Db;Ga(Ob);return null},Db=>{k.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",Db.toString());Ga(Ob);return null})})})}Kyj(){let Ga=null;try{const cb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",
null);cb&&(Ga=oa.b(cb))}catch(cb){k.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return Ga||{}}Lfe(){const Ga=this.sR.getContext(null);Ga.FloodgateUIAutoDismissTimeEnum=this.Muj();Ga.uIStringGetter=this.Hpj;Ga.authTokenCallback=Vb.Y1i(Object(n.a)(String,Ga.AudienceGroup));Ga.userFactsReadConfig=Vb.C5i();Ga.augLoopCallback=Vb.W1i();Ga.onTeachingCampaignRender=Vb.Q6d;Ga.governanceServiceEnabled=Vb.Kjg();Ga.governanceServiceConfig=Vb.cCj();Ga.personalizerEnabled=
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);Ga.messagingServiceSettings=this.Kyj();Ga.isPriorityEnabled=Vb.UIj();Ga.enableWebCampaignGovernance=Vb.rgj();Ga.enableOutOfScopeTelemetry=Vb.hgj();da.BrowserFeedbackControlOCV.I_c()&&(Ga.dynamicUxConfig=Vb.hAj(Ga.Application));return Ga}yAe(Ga){const cb=this.sR.uPf(),Ob=this.vkg(),Db=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1),mb=r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost"),Vc=r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost"),Zb=r.AFrameworkApplication.fa.getBooleanAppSetting("OcpsIsEnabled"),fc="surveyEnabled"in Ga?Ga.surveyEnabled:"null or undefined",ob="showEmailAddress"in Ga?Ga.showEmailAddress:"null or undefined",ub=Vb.Kjg(),bc=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);k.ULS.sendTraceTag(575947136,
356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',cb,Db,mb,Vc,Zb,Ob,ob,fc,ub,oa.c(Ga.governanceServiceConfig),bc)}Muj(){return jc(null,this.Scf)?(k.ULS.sendTraceTag(593278928,356,
50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):r.AFrameworkApplication.fa.tc("FloodgateUIAutoDismissTimeEnum",4)}vkg(){return r.AFrameworkApplication.fa.tc("FloodgateContextAndInitDelayInMilliSeconds",Vb.b$i)}gae(Ga){this.isInitialized=!0;this.fxi();da.BrowserFeedbackControlOCV.xPl(Object(e.a)(this,this.sEk,"logTriggerEvent"));if(Ga){for(const cb of Ga.IPa)cb.Tof?(0,cb.Tof)(cb.activityName(),cb.object()):cb.Sof?(0,cb.Sof)(cb.object()):k.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");
Ga.NTi()}else k.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const cb=this.sR.getContext(null),Ob=da.BrowserFeedbackControlOCV.sjg(Array.isArray(cb.Flights)?cb.Flights:null),Db=Ob?Object(n.a)(String,Ob.SelfTriggerActivity):null;if(Db)for(const mb of Db.split(";"))mb&&""!==mb&&this.logActivity(mb,null)}catch(cb){k.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(cb?cb.toString():""))}}fxi(){!this.JBg&&window.addEventListener&&(window.addEventListener("FGWebSurfaceEvent",
this.qal,!0),this.JBg=!0)}JJg(Ga,cb){Ga&&r.AFrameworkApplication.F1(Ga);k.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+cb)}Hgk(Ga){if(!Ga)return!1;try{const cb=(r.AFrameworkApplication.fa.Ea("FlightId")||"").toLocaleLowerCase(),Ob=Ga.toString().toLocaleLowerCase().split(";");for(const Db of Ob)if(2<Db.length&&(Db.lastIndexOf("-control")===Db.length-8||Db.lastIndexOf("cf")===Db.length-2&&-1!==cb.indexOf(Db)))return!0}catch(cb){k.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+
(cb?cb.toString():""))}return!1}sEk(Ga,cb){cb=cb||{};if(Ga){var Ob=Vb.Ghe(Ga);Ob&&(cb.flightId=Ob);"isControl"in cb||(Ob=this.Hgk(Ga))&&(cb.isControl=Ob)}this.JJg(Ga,JSON.stringify(cb))}$yl(Ga){if(!Ga)return null;try{const cb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase();if(!cb||""===cb)return Ga;const Ob=oa.b(Ga),Db=new K.a;let mb=0;for(const Vc of Ob){const Zb=Vc.CampaignId;Zb&&-1!==cb.indexOf(Zb.toLowerCase())?(k.ULS.sendTraceTag(509167254,
356,50,"Ignoring disabled campaign -"+Zb),mb++):Db.add(Vc)}return mb?oa.c(Db.toArray()):Ga}catch(cb){return k.ULS.sendTraceTag(509167253,356,10,"Error filtering out disabled campaigns"),Ga}}Lcm(Ga){var cb=["Live"];if(!Ga)return null;try{const Ob=oa.b(Ga),Db=new K.a;for(const mb of Ob){const Vc=mb.Tags;if(Vc)for(const Zb of cb)Array.contains(Vc,Zb)&&Db.add(mb)}return oa.c(Db.toArray())}catch(Ob){return k.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}FVl(){let Ga=
!1,cb=null;const Ob=this.Acb();if(Ob&&this.Svb)try{let Db=this.Svb.Kvj();r.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.OfficeVSO:7990933_FilterOfficeLiveSurvey")&&r.AFrameworkApplication.vY&&(Db=this.Lcm(Db));r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FilterDisabledCampaigns",!0)&&(Db=this.$yl(Db));Db?(Ob.setItem(Vb.wPi,Db),Ga=!0):(cb="SIFB.campaign str was null",k.ULS.sendTraceTag(594143442,356,10,cb))}catch(Db){cb="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+
Db,k.ULS.sendTraceTag(594143441,356,50,cb)}else this.Svb?(cb="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",k.ULS.sendTraceTag(594143440,356,50,cb)):(cb="SIFB.Floodgate surveys not available. App Specific Feedback data was null",k.ULS.sendTraceTag(556896920,356,50,cb));k.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+Ga+" errorString: "+(cb?cb:"null"))}initOptions(){}fVl(){this.g5a||(rb.a.addHandler(window.self,$a.a.focus,this.Qrc),rb.a.addHandler(window.self,
$a.a.blur,this.tal))}Acb(){if(!this.WWa)return null;let Ga=null;try{Ga=localStorage}catch(cb){this.WWa=!1,Ga=null,k.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(cb?cb.toString():""))}return Ga}Fak(){k.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.la=new na.a(la.a.gl()),this.la.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.la.$("nps_PromptQuestion",CommonUIStrings.l_WAC_NPS_PromptQuestion),this.la.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),
this.la.$("nps_RatingQuestion_Word",Vb.Rqg()),this.la.$("nps_RatingQuestion_OneNote",Vb.fSj()),this.la.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.la.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.la.$("nps_OneClickRatingQuestion_Excel",Vb.Pqg()),this.la.$("nps_OneClickRatingQuestion_PowerPoint",Vb.Qqg()),this.la.$("nps_RatingQuestion_PowerPoint",Vb.Qqg()),this.la.$("nps_RatingQuestion_Excel",Vb.Pqg()),
this.la.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.la.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.la.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.la.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.la.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.la.$("nps_Rating_Values_5",CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.la.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),
this.la.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.la.$("nps_OneClickRatingQuestion_Word",Vb.Rqg()),this.la.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.la.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.la.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),this.la.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),
this.la.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.la.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.la.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.la.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.la.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),this.la.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),
this.la.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.la.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.la.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.la.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.la.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.la.$("NSV_Prompt_Title_Feedback",CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),
this.la.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.la.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.la.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.la.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.la.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.la.$("NSVFreeformDidntCreateSheetView",CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),
this.la.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.la.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.la.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.la.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.la.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.la.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),this.la.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),
this.la.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.la.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.la.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.la.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.la.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.la.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),
this.la.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.la.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.la.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.la.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.la.$("ReviewMode_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),
this.la.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.la.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.la.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.la.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.la.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),this.la.$("ReviewMode_FloodgateQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.la.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.la.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.la.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.la.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.la.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),this.la.$("collab_Rating_Values_3",
CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.la.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.la.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.la.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.la.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.la.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),this.la.$("connector_campaign_Prompt_Question",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.la.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.la.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.la.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.la.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),this.la.$("connector_campaign_Rating_Values_5",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.la.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.la.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.la.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.la.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),this.la.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",
CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.la.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.la.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.la.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.la.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),this.la.$("WordFollowUpFeelingsFPS_RatingValue_4",
CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.la.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.la.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.la.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.la.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),this.la.$("DictationV2_GreetingAnswer_Sure",
CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.la.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.la.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.la.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.la.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),
this.la.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.la.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.la.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.la.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.la.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),
this.la.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.la.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.la.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.la.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.la.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.la.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),
this.la.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.la.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.la.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.la.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.la.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.la.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.la.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.la.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.la.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.la.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.la.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.la.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),
this.la.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.la.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.la.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.la.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.la.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),
this.la.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.la.$("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.la.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.la.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.la.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.la.$("ExcelRecommendedCharts_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.la.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.la.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.la.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.la.$("ExcelRecommendedCharts_Rating_3_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.la.$("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.la.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.la.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.la.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("ExcelRecommendedPivotTable_Rating_Question",
CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.la.$("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.la.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.la.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.la.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),
this.la.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.la.$("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.la.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.la.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.la.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.la.$("Download_as_Image_Rating_Values_1",
CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.la.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.la.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.la.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.la.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.la.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.la.$("TextPredictions_FloodgatePromptTitle",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.la.$("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.la.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.la.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.la.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),
this.la.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.la.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.la.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.la.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.la.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),
this.la.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.la.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.la.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.la.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.la.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.la.$("SoftwareITDiagrams_Rating_Values_2",
CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.la.$("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.la.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.la.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.la.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.la.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),
this.la.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.la.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.la.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.la.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.la.$("ExternalContent_FloodgateRating_1",
CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.la.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.la.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.la.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.la.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.la.$("ExternalContent_FloodgateQuestion",
CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.la.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.la.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.la.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.la.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.la.$("Translator_RatingQuestion",
CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.la.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.la.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.la.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.la.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.la.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),
this.la.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.la.$("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.la.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),
this.la.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.la.$("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.la.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.la.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.la.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.la.$("LinkedIn_Title",
CommonUIStrings.l_LinkedIn_Title),this.la.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.la.$("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.la.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.la.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.la.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.la.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),
this.la.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.la.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.la.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.la.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.la.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.la.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.la.$("VHRestore_SurveyQuestion",
CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.la.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.la.$("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.la.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.la.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.la.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.la.$("ShowChanges_Prompt",
CommonUIStrings.l_Excel_ShowChanges_Prompt),this.la.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.la.$("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.la.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.la.$("ShowChanges_RatingValue_2",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.la.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.la.$("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.la.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.la.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.la.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),
this.la.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.la.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.la.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.la.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.la.$("ModernUxExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.la.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.la.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.la.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.la.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),
this.la.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.la.$("FileBackedLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.la.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),this.la.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.la.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.la.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),
this.la.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),this.la.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.la.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.la.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.la.$("PollLoopComponent_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.la.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.la.$("PollLoopComponent_FloodgateRatingValue_2",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.la.$("PollLoopComponent_FloodgateRatingValue_3",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.la.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.la.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.la.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),
this.la.$("RemoveLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_RemoveLoopComponents_Floodgate_PromptTitle),this.la.$("RemoveLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("RemoveLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("RemoveLoopComponents_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("RemoveLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingQuestion),
this.la.$("RemoveLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_1),this.la.$("RemoveLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_2),this.la.$("RemoveLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_3),this.la.$("RemoveLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_4),this.la.$("RemoveLoopComponents_FloodgateRatingValue_5",
CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_5),this.la.$("RemoveLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_RemoveLoopComponents_Floodgate_FloodgateWhyQuestion),this.la.$("NotUseLoopComponents_FloodgateCommentQuestion",CommonUIStrings.l_NotUseLoopComponents_Floodgate_CommentQuestion),this.la.$("NotUseLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingQuestion),this.la.$("NotUseLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_1),
this.la.$("NotUseLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_2),this.la.$("NotUseLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_3),this.la.$("NotUseLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_4),this.la.$("NotUseLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_5),this.la.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",
CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),this.la.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.la.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.la.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),this.la.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",
CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),this.la.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.la.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.la.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),this.la.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",
CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),this.la.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.la.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.la.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),this.la.$("TabSwitchControlExperiment_FloodgatePromptQuestion",
CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),this.la.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.la.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.la.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),this.la.$("TabSwitchControlExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),this.la.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.la.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.la.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),this.la.$("TabSwitchControlExperiment_FloodgateRatingValue_5",
CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),this.la.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.la.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.la.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.la.$("ShortcutDiscovery_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ShortcutDiscovery_PromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.la.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.la.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.la.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.la.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),
this.la.$("ShortcutDiscovery_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.la.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.la.$("Fonts_PromptTitle",CommonUIStrings.l_FontExperience_FloodgatePromptTitle),this.la.$("Fonts_PromptQuestion",CommonUIStrings.l_FontExperience_FloodgatePromptQuestion),this.la.$("Fonts_PromptAnswer_NotNow",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_NotNow),this.la.$("Fonts_PromptAnswer_Sure",
CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_Sure),this.la.$("Fonts_RatingQuestion",CommonUIStrings.l_FontExperience_FloodgateRatingQuestion),this.la.$("Fonts_RatingValue_1",CommonUIStrings.l_FontExperience_FloodgateRatingValue_1),this.la.$("Fonts_RatingValue_2",CommonUIStrings.l_FontExperience_FloodgateRatingValue_2),this.la.$("Fonts_RatingValue_3",CommonUIStrings.l_FontExperience_FloodgateRatingValue_3),this.la.$("Fonts_RatingValue_4",CommonUIStrings.l_FontExperience_FloodgateRatingValue_4),
this.la.$("Fonts_RatingValue_5",CommonUIStrings.l_FontExperience_FloodgateRatingValue_5),this.la.$("Fonts_WhyQuestion",CommonUIStrings.l_FontExperience_FloodgateWhyQuestion),this.la.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.la.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.la.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.la.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.la.$("Ruler_RatingQuestion",
CommonUIStrings.l_WordRuler_RatingQuestion),this.la.$("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.la.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.la.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.la.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.la.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.la.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.la.$("CustomTabDialog_PromptTitle",
CommonUIStrings.l_CustomTabDialog_PromptTitle),this.la.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.la.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.la.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.la.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),this.la.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),
this.la.$("CustomTabDialog_RatingValue_2",CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.la.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.la.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.la.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.la.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),this.la.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),
this.la.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.la.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.la.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.la.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),this.la.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.la.$("WordStyles_FloodgateRating_2",
CommonUIStrings.l_WordStyles_FloodgateRating_2),this.la.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.la.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.la.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.la.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),this.la.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),
this.la.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.la.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.la.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.la.$("UnsavedChangesHighlight_RatingQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.la.$("UnsavedChangesHighlight_Rating_Yes",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.la.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.la.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.la.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),this.la.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),
this.la.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.la.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.la.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.la.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),this.la.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),
this.la.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.la.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.la.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.la.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),this.la.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),
this.la.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.la.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.la.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.la.$("GrammarSuggestions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.la.$("GrammarSuggestions_FloodgateRating_1",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.la.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.la.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.la.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),this.la.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.la.$("GrammarSuggestions_FloodgateQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.la.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.la.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.la.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),this.la.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.la.$("WordRemoveSsr_FloodgateRatingQuestion",
CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.la.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.la.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.la.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.la.$("WordRemoveSsr_FloodgateRating_4",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.la.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),
this.la.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.la.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.la.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.la.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),this.la.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),
this.la.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.la.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.la.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.la.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.la.$("WordDrawing_FloodgateRating_4",CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.la.$("WordDrawing_FloodgateRating_5",
CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.la.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.la.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.la.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.la.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.la.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.la.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.la.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.la.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.la.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.la.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.la.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.la.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.la.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),this.la.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),
this.la.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.la.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.la.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.la.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.la.$("ShyRibbon_Floodgate_Option_3",CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.la.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),
this.la.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.la.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.la.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.la.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),this.la.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),
this.la.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.la.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.la.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.la.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),this.la.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),
this.la.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.la.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.la.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.la.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),this.la.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.la.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.la.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.la.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),
this.la.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.la.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.la.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.la.$("PasswordProtectedDocumentSupport_FloodgateRating_4",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),
this.la.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.la.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.la.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.la.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("WordSimilarity_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.la.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.la.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.la.$("WordSimilarity_FloodgateRating_3",CommonUIStrings.l_WordSimilarity_FloodgateRating_3),
this.la.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.la.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.la.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.la.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.la.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),this.la.$("PremiumPreviewFloodgateRatingQuestion",
CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.la.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.la.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.la.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.la.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.la.$("FloodgateNLQSPromptSubtitle",CommonUIStrings.l_FloodgateNLQSPromptSubtitle),
this.la.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.la.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.la.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.la.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.la.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.la.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),this.la.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),
this.la.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.la.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.la.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.la.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.la.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.la.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.la.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.la.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.la.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.la.$("ExcelWebEaseOfUse_RatingValue_4",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.la.$("ExcelWebEaseOfUse_RatingValue_5",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.la.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.la.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.la.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.la.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.la.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.la.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.la.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.la.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.la.$("ExcelWebPrintSurvey_RatingValue_4",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),
this.la.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.la.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.la.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.la.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.la.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ReactAutoFilter_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.la.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.la.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.la.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.la.$("ReactAutoFilter_RatingValue_4",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),
this.la.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.la.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.la.$("NewOfficeDefaultTheme_PromptLine_1",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_PromptLine_1),this.la.$("NewOfficeDefaultTheme_PromptLine_2",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_PromptLine_2),this.la.$("NewOfficeDefaultTheme_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("NewOfficeDefaultTheme_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("NewOfficeDefaultTheme_RatingQuestion",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_RatingQuestion),this.la.$("NewOfficeDefaultTheme_RatingValue_1",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_RatingValue_1),this.la.$("NewOfficeDefaultTheme_RatingValue_2",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_RatingValue_2),this.la.$("NewOfficeDefaultTheme_RatingValue_3",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_RatingValue_3),
this.la.$("NewOfficeDefaultTheme_RatingValue_4",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_RatingValue_4),this.la.$("NewOfficeDefaultTheme_RatingValue_5",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_RatingValue_5),this.la.$("NewOfficeDefaultTheme_CommentQuestion",CommonUIStrings.l_Excel_NewOfficeDefaultTheme_CommentQuestion),this.la.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.la.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),
this.la.$("WordLinksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),this.la.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.la.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.la.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.la.$("WordLinksExperience_FloodgateRating_2",
CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),this.la.$("WordLinksExperience_FloodgateRating_3",CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.la.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.la.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.la.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.la.$("OnlineVideoSupport_FloodgatePromptTitle",
CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),this.la.$("OnlineVideoSupport_FloodgatePromptQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.la.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.la.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.la.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),
this.la.$("OnlineVideoSupport_FloodgateRating_1",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),this.la.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.la.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.la.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.la.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),
this.la.$("OnlineVideoSupport_FloodgateWhyQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),this.la.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.la.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.la.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.la.$("NavPaneExperience_FloodgatePrompt_NoLabel",
CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),this.la.$("NavPaneExperience_FloodgateRatingQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.la.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.la.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.la.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.la.$("NavPaneExperience_FloodgateRating_4",
CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),this.la.$("NavPaneExperience_FloodgateRating_5",CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.la.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.la.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.la.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.la.$("BookmarksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),this.la.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.la.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.la.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.la.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),
this.la.$("BookmarksExperience_FloodgateRating_3",CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.la.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.la.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.la.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.la.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),
this.la.$("WordPictureBorder_FloodgatePromptQuestion",CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.la.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.la.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.la.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.la.$("WordPictureBorder_FloodgateRating_1",
CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),this.la.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.la.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.la.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.la.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.la.$("WordPictureBorder_FloodgateWhyQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),this.la.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.la.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.la.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.la.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.la.$("WordComment_FloodgateRatingQuestion",
CommonUIStrings.l_WordComment_FloodgateRatingQuestion),this.la.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.la.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.la.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.la.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.la.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),
this.la.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),this.la.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.la.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.la.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.la.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),
this.la.$("WordTrackChanges_FloodgateRatingQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.la.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.la.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.la.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.la.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),
this.la.$("WordTrackChanges_FloodgateRating_5",CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.la.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.la.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.la.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.la.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),this.la.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.la.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.la.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.la.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),this.la.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.la.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.la.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.la.$("CollabCorner_Survey_DownloadCopies_Comment_Question",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),this.la.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.la.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.la.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.la.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),
this.la.$("WordListsExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.la.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.la.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.la.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.la.$("WordChartsSupport_FloodgatePromptTitle",
CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),this.la.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.la.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.la.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.la.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),
this.la.$("WordChartsSupport_FloodgateRating_1",CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.la.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.la.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.la.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.la.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),
this.la.$("WordChartsSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.la.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.la.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.la.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.la.$("WordTablesSupport_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),this.la.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.la.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.la.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.la.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.la.$("WordTablesSupport_FloodgateRating_4",
CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),this.la.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.la.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.la.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.la.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.la.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("ModernPresence_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.la.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.la.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.la.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.la.$("ModernPresence_RatingValue_4",
CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),this.la.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.la.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.la.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.la.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.la.$("WordInsertImages_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),this.la.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.la.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.la.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.la.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.la.$("WordInsertImages_FloodgateRating_3",
CommonUIStrings.l_WordInsertImages_FloodgateRating_3),this.la.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.la.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.la.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.la.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.la.$("FontPicker_FloodgatePromptQuestion",
CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),this.la.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.la.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.la.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.la.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.la.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),
this.la.$("FontPicker_FloodgateRating3",CommonUIStrings.l_FontPicker_FloodgateRating3),this.la.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.la.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.la.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.la.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.la.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.la.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.la.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.la.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.la.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.la.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.la.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.la.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.la.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgatePromptTitle",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgatePromptTitle),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgatePromptQuestion",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgatePromptQuestion),
this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_YesLabel",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_YesLabel),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_NoLabel",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_NoLabel),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateRatingQuestion",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateRatingQuestion),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateRating_1",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateRating_1),
this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateRating_2",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateRating_2),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateRating_3",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateRating_3),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateRating_4",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateRating_4),this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateRating_5",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateRating_5),
this.la.$("FluidOnWebCoauthSentimentSurvey_FloodgateWhyQuestion",CommonUIStrings.l_FluidOnWebCoauthSentimentSurvey_FloodgateWhyQuestion),this.la.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.la.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.la.$("WordWebEditorSeen_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.la.$("WordWebEditorSeen_FloodgateRating_4",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.la.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.la.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.la.$("OnenotePerf_FloodgatePromptTitle",Vb.gSj()),this.la.$("OnenotePerf_FloodgatePromptQuestion",CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.la.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),
this.la.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.la.$("OnenotePerf_FloodgateRatingQuestion",Vb.hSj()),this.la.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.la.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),this.la.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),
this.la.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.la.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.la.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.la.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),this.la.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),
this.la.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.la.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.la.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.la.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.la.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),this.la.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),
this.la.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.la.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.la.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.la.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.la.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.la.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.la.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.la.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.la.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.la.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.la.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.la.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.la.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),this.la.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.la.$("PenInkSurvey_PromptQuestion",
CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.la.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.la.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.la.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.la.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.la.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.la.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.la.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.la.$("SkittleFloodgatePrompt",CommonUIStrings.l_Skittle_FeedbackPrompt),this.la.$("SkittleFloodgateRatingQuestion",
CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.la.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.la.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.la.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.la.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.la.$("WordDocumentModes_FloodgatePromptQuestion",CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),
this.la.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.la.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.la.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.la.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),this.la.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),
this.la.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.la.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.la.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.la.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.la.$("WordDesignerFloodgatePromptNoLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.la.$("WordDesignerFloodgateRatingQuestion",
CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.la.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.la.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.la.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.la.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),this.la.$("WordDesignerBlankDocumentExperienceRatingQuestion",
CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.la.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.la.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.la.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.la.$("WordDesignerFormattingSuggestionsSurveyQuestion",CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),
this.la.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.la.$("WordDesignerDesignerPasteFeedbackRatingQuestion",Vb.iSj()),this.la.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.la.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.la.$("WordDesignerHideSuggestionsAnswer2",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),
this.la.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.la.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.la.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.la.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.la.$("FpsInDocSearch_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.la.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.la.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.la.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),this.la.$("FpsInDocSearch_FloodgateRating_4",
CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.la.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.la.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.la.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.la.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.la.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.la.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.la.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.la.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.la.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.la.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.la.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.la.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.la.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.la.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.la.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.la.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.la.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.la.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.la.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.la.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.la.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.la.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.la.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.la.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.la.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.la.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.la.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.la.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.la.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.la.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.la.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.la.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.la.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.la.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.la.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.la.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.la.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.la.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.la.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.la.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.la.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.la.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.la.$("InAppNotification_Description",CommonUIStrings.l_WAC_InAppNotification_Description),this.la.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),
this.la.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.la.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.la.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.la.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.la.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.la.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.la.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.la.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.la.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),
this.la.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.la.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.la.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),this.la.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.la.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.la.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.la.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.la.$("WordWebOpeningDocuments_FloodgateRating_2",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.la.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),
this.la.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.la.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.la.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),this.la.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.la.$("WordCommentReaction_FloodgatePromptQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.la.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.la.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.la.$("WordCommentReaction_FloodgateRatingQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.la.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),
this.la.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.la.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.la.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.la.$("WordCommentReaction_FloodgateRating_5",CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.la.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),
this.la.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.la.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.la.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.la.$("GuestCoauthoring_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.la.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),
this.la.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.la.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.la.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.la.$("GuestCoauthoring_FloodgateRatingValue_4",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.la.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),
this.la.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.la.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.la.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),this.la.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.la.$("CtrlClickExperience_FloodgatePrompt_NoLabel",
CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.la.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.la.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.la.$("CtrlClickExperience_FloodgateRating_2",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.la.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),
this.la.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.la.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.la.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.la.$("WordTypingResponsiveness_FloodgatePromptTitle",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.la.$("WordTypingResponsiveness_FloodgatePromptQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.la.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.la.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.la.$("WordTypingResponsiveness_FloodgateRatingQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.la.$("WordTypingResponsiveness_FloodgateRating_1",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.la.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.la.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.la.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),this.la.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),
this.la.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.la.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.la.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.la.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ShareSection_RatingQuestion",
CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.la.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.la.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.la.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.la.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.la.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.la.$("ShareSection_CommentQuestion",
CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.la.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.la.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.la.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.la.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),this.la.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.la.$("WordUnsavedPrompt_FloodgateRating_4",
CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.la.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.la.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.la.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),this.la.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.la.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.la.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.la.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),this.la.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.la.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),
this.la.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.la.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.la.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.la.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),this.la.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.la.$("SmartViewFormatAsTable_RatingValue_1",
CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.la.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.la.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.la.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),this.la.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),
this.la.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.la.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.la.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.la.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.la.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),this.la.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),
this.la.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.la.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.la.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),this.la.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),
this.la.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.la.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.la.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.la.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.la.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.la.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.la.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.la.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.la.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),this.la.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),
this.la.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.la.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.la.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.la.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),this.la.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),
this.la.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.la.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.la.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.la.$("Toolbar_Floodgate_Prompt_Line1",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Line1),this.la.$("Toolbar_Floodgate_Prompt_Line2",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Line2),this.la.$("Toolbar_Floodgate_Prompt_Affirmative_Answer",
CommonUIStrings.l_Toolbar_Floodgate_Prompt_Affirmative_Answer),this.la.$("Toolbar_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Negative_Answer),this.la.$("Toolbar_Floodgate_Rating_Question",CommonUIStrings.l_Toolbar_Floodgate_Rating_Question),this.la.$("Toolbar_Floodgate_Rating_Scale_1",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_1),this.la.$("Toolbar_Floodgate_Rating_Scale_2",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_2),this.la.$("Toolbar_Floodgate_Rating_Scale_3",
CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_3),this.la.$("Toolbar_Floodgate_Rating_Scale_4",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_4),this.la.$("Toolbar_Floodgate_Rating_Scale_5",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_5),this.la.$("Toolbar_Floodgate_Comment_Question",CommonUIStrings.l_Toolbar_Floodgate_Comment_Question),this.la.$("ToolbarOptOut_Floodgate_Prompt_Line1",CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Line1),this.la.$("ToolbarOptOut_Floodgate_Prompt_Line2",
CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Line2),this.la.$("ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer),this.la.$("ToolbarOptOut_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Negative_Answer),this.la.$("ToolbarOptOut_Floodgate_Rating_Question",CommonUIStrings.l_ToolbarOptOut_Floodgate_Rating_Question),this.la.$("ToolbarOptOut_Floodgate_Rating_Scale_1",CommonUIStrings.l_ToolbarOptOut_Floodgate_Rating_Scale_1),
this.la.$("ToolbarOptOut_Floodgate_Rating_Scale_2",CommonUIStrings.l_ToolbarOptOut_Floodgate_Rating_Scale_2),this.la.$("ToolbarOptOut_Floodgate_Comment_Question",CommonUIStrings.l_ToolbarOptOut_Floodgate_Comment_Question),this.la.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("PerformanceExperience_RatingQuestion",Vb.Pbc(0)),this.la.$("PerformanceExperience_RatingQuestion_OpenFile",
Vb.Pbc(1)),this.la.$("PerformanceExperience_RatingQuestion_Responsivness",Vb.Pbc(2)),this.la.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Vb.Pbc(3)),this.la.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Vb.Pbc(4)),this.la.$("PerformanceExperience_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.la.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.la.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),
this.la.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.la.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.la.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),this.la.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),this.la.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.la.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.la.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.la.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.la.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.la.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.la.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.la.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.la.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),this.la.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),
this.la.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.la.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.la.$("Fluent2Survey_RatingValue_2",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.la.$("Fluent2Survey_RatingValue_3",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.la.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.la.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.la.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.la.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),
this.la.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.la.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),this.la.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),
this.la.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.la.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.la.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.la.$("ConsumerExperiment_PromptQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.la.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),
this.la.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.la.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.la.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.la.$("ConsumerExperiment_RatingValue4",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.la.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),
this.la.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.la.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),this.la.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.la.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),
this.la.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.la.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.la.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.la.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.la.$("AIMakerSurvey_CommentQuestion",CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.la.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.la.$("CheckPerformance_PromptQuestion",
CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.la.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),this.la.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.la.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),
this.la.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.la.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.la.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.la.$("CheckPerformance_CommentQuestion",CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.la.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.la.$("SmartSuggestion_PromptQuestion",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.la.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),this.la.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.la.$("SmartSuggestion_RatingValue_2",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.la.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.la.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.la.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),this.la.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.la.$("ArgumentAssistance_PromptTitle",
CommonUIStrings.l_Excel_ArgumentAssistance_Survey_PromptTitle),this.la.$("ArgumentAssistance_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.la.$("ArgumentAssistance_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("ArgumentAssistance_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("ArgumentAssistance_RatingQuestion",CommonUIStrings.l_Excel_ArgumentAssistance_Survey_RatingQuestion),this.la.$("ArgumentAssistance_RatingValue_1",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.la.$("ArgumentAssistance_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.la.$("ArgumentAssistance_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.la.$("ArgumentAssistance_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.la.$("ArgumentAssistance_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),this.la.$("ArgumentAssistance_CommentQuestion",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.la.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("PPTO_Picture_FloodgateRatingQuestion",
CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.la.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.la.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.la.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.la.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.la.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.la.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.la.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.la.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.la.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.la.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.la.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.la.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.la.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.la.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.la.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.la.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.la.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion),this.la.$("FRE_FirstTeachingCalloutTitle",CommonUIStrings.l_FRE_FirstTeachingCalloutTitle),this.la.$("FRE_FirstTeachingCalloutDescription",CommonUIStrings.l_FRE_FirstTeachingCalloutDescription),this.la.$("FRE_TeachingCalloutNextButtonText",CommonUIStrings.l_FRE_TeachingCalloutNextButtonText),
this.la.$("FRE_SecondTeachingCalloutTitle",CommonUIStrings.l_FRE_SecondTeachingCalloutTitle),this.la.$("FRE_SecondTeachingCalloutDescription",CommonUIStrings.l_FRE_SecondTeachingCalloutDescription),this.la.$("FRE_ThirdTeachingCalloutTitle",CommonUIStrings.l_FRE_ThirdTeachingCalloutTitle),this.la.$("FRE_ThirdTeachingCalloutDescription",CommonUIStrings.l_FRE_ThirdTeachingCalloutDescription),this.la.$("FRE_TeachingCalloutGotItButtonText",CommonUIStrings.l_FRE_TeachingCalloutGotItButtonText),this.la.$("FloodgateSurveyNoRealEditPromptTitle",
CommonUIStrings.l_FloodgateSurveyNoRealEditPromptTitle),this.la.$("FloodgateSurveyNoRealEditPromptQuestion",CommonUIStrings.l_FloodgateSurveyNoRealEditPromptQuestion),this.la.$("FloodgateSurveyNoRealEditSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FloodgateSurveyNoRealEditNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FloodgateSurveyNoRealEditQuestion1",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion1),this.la.$("FloodgateSurveyNoRealEditOption1",CommonUIStrings.l_FloodgateSurveyNoRealEditOption1),
this.la.$("FloodgateSurveyNoRealEditOption2",CommonUIStrings.l_FloodgateSurveyNoRealEditOption2),this.la.$("FloodgateSurveyNoRealEditOption3",CommonUIStrings.l_FloodgateSurveyNoRealEditOption3),this.la.$("FloodgateSurveyNoRealEditOption4",CommonUIStrings.l_FloodgateSurveyNoRealEditOption4),this.la.$("FloodgateSurveyNoRealEditOption5",CommonUIStrings.l_FloodgateSurveyNoRealEditOption5),this.la.$("FloodgateSurveyNoRealEditQuestion2",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion2),this.la.$("FormulaByExample_PromptTitle",
CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptTitle),this.la.$("FormulaByExample_PromptQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptQuestion),this.la.$("FormulaByExample_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FormulaByExample_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FormulaByExample_RatingQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingQuestion),this.la.$("FormulaByExampleIgnored_RatingQuestion",
CommonUIStrings.l_Excel_FormulaByExampleIgnored_Survey_RatingQuestion),this.la.$("FormulaByExample_RatingValue_1",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_1),this.la.$("FormulaByExample_RatingValue_2",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_2),this.la.$("FormulaByExample_RatingValue_3",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_3),this.la.$("FormulaByExample_RatingValue_4",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_4),this.la.$("FormulaByExample_RatingValue_5",
CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_5),this.la.$("FormulaByExample_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_CommentQuestion),this.la.$("FormulaByExampleDeclined_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExampleDeclined_Survey_CommentQuestion),this.la.$("CIQSeenNotKeptFPS_Title",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Title),this.la.$("CIQSeenNotKeptFPS_Question",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Question),this.la.$("CIQSeenNotKeptFPS_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("CIQSeenNotKeptFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("CIQSeenNotKeptFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_RatingQuestion),this.la.$("CIQSeenNotKeptFPS_RatingValue_Yes",CommonUIStrings.l_DialogYes),this.la.$("CIQSeenNotKeptFPS_RatingValue_No",CommonUIStrings.l_DialogNo),this.la.$("CIQSeenNotKeptFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_WhyQuestion),this.la.$("FloodgateSurveyProofingSuggestions_PromptTitle",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptTitle),this.la.$("FloodgateSurveyProofingSuggestions_PromptQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion),this.la.$("FloodgateSurveyProofingSuggestions_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FloodgateSurveyProofingSuggestions_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FloodgateSurveyProofingSuggestions_WhyQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion1),
this.la.$("FloodgateSurveyProofingSuggestions_Option_1",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption1),this.la.$("FloodgateSurveyProofingSuggestions_Option_2",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption2),this.la.$("FloodgateSurveyProofingSuggestions_Option_3",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption3),this.la.$("FloodgateSurveyProofingSuggestions_Option_4",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption4),this.la.$("FloodgateSurveyProofingSuggestions_Option_5",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption5),this.la.$("FloodgateSurveyProofingSuggestions_AdditionalDetailsQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion2),this.la.$("MultiColumnsSurvey_Title",CommonUIStrings.l_WAC_MultiColumnsSurvey_Title),this.la.$("MultiColumnsSurvey_Question",CommonUIStrings.l_WAC_MultiColumnsSurvey_Question),this.la.$("MultiColumnsSurvey_YesLabel",CommonUIStrings.l_WAC_MultiColumnsSurvey_YesLabel),this.la.$("MultiColumnsSurvey_NoLabel",
CommonUIStrings.l_WAC_MultiColumnsSurvey_NoLabel),this.la.$("MultiColumnsSurvey_RatingQuestion",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingQuestion),this.la.$("MultiColumnsSurvey_RatingValue_1",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingValue_1),this.la.$("MultiColumnsSurvey_RatingValue_5",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingValue_5),this.la.$("MultiColumnsSurvey_ImproveQuestion",CommonUIStrings.l_WAC_MultiColumnsSurvey_ImproveQuestion),this.la.$("WordOnlineShare_FloodgatePromptTitle",
CommonUIStrings.l_WordOnlineShare_FloodgatePromptTitle),this.la.$("WordOnlineShare_FloodgatePromptQuestion",CommonUIStrings.l_WordOnlineShare_FloodgatePromptQuestion),this.la.$("WordOnlineShare_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordOnlineShare_FloodgatePrompt_YesLabel),this.la.$("WordOnlineShare_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordOnlineShare_FloodgatePrompt_NoLabel),this.la.$("WordOnlineShare_FloodgateRatingQuestion",CommonUIStrings.l_WordOnlineShare_FloodgateRatingQuestion),
this.la.$("WordOnlineShare_FloodgateRating_1",CommonUIStrings.l_WordOnlineShare_FloodgateRating_1),this.la.$("WordOnlineShare_FloodgateRating_2",CommonUIStrings.l_WordOnlineShare_FloodgateRating_2),this.la.$("WordOnlineShare_FloodgateRating_3",CommonUIStrings.l_WordOnlineShare_FloodgateRating_3),this.la.$("WordOnlineShare_FloodgateRating_4",CommonUIStrings.l_WordOnlineShare_FloodgateRating_4),this.la.$("WordOnlineShare_FloodgateRating_5",CommonUIStrings.l_WordOnlineShare_FloodgateRating_5),this.la.$("WordOnlineShare_FloodgateWhyQuestion",
CommonUIStrings.l_WordOnlineShare_FloodgateWhyQuestion),this.la.$("WordPerformance_FloodgatePromptTitle",CommonUIStrings.l_WordPerformance_FloodgatePromptTitle),this.la.$("WordPerformance_FloodgatePromptQuestion",CommonUIStrings.l_WordPerformance_FloodgatePromptQuestion),this.la.$("WordPerformance_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPerformance_FloodgatePrompt_YesLabel),this.la.$("WordPerformance_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPerformance_FloodgatePrompt_NoLabel),this.la.$("WordPerformance_FloodgateRatingQuestion",
CommonUIStrings.l_WordPerformance_FloodgateRatingQuestion),this.la.$("WordPerformance_FloodgateRating_1",CommonUIStrings.l_WordPerformance_FloodgateRating_1),this.la.$("WordPerformance_FloodgateRating_2",CommonUIStrings.l_WordPerformance_FloodgateRating_2),this.la.$("WordPerformance_FloodgateRating_3",CommonUIStrings.l_WordPerformance_FloodgateRating_3),this.la.$("WordPerformance_FloodgateRating_4",CommonUIStrings.l_WordPerformance_FloodgateRating_4),this.la.$("WordPerformance_FloodgateRating_5",
CommonUIStrings.l_WordPerformance_FloodgateRating_5),this.la.$("WordPerformance_FloodgateWhyQuestion",CommonUIStrings.l_WordPerformance_FloodgateWhyQuestion),this.la.$("DataCleansing_PromptTitle",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_PromptTitle),this.la.$("DataCleansing_PromptQuestion",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_PromptQuestion),this.la.$("DataCleansing_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("DataCleansing_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("DataCleansing_RatingQuestion",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_RatingQuestion),this.la.$("DataCleansing_RatingValue_1",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_RatingValue_1),this.la.$("DataCleansing_RatingValue_2",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_RatingValue_2),this.la.$("DataCleansing_RatingValue_3",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_RatingValue_3),this.la.$("DataCleansing_RatingValue_4",
CommonUIStrings.l_Excel_DataCleansing_Web_Survey_RatingValue_4),this.la.$("DataCleansing_RatingValue_5",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_RatingValue_5),this.la.$("DataCleansing_CommentQuestion",CommonUIStrings.l_Excel_DataCleansing_Web_Survey_CommentQuestion),this.la.$("FloodgateSurveyJTBDCoreValuePromptTitle",CommonUIStrings.l_FloodgateSurveyJTBDCoreValuePromptTitle),this.la.$("FloodgateSurveyJTBDCoreValuePromptQuestion",CommonUIStrings.l_FloodgateSurveyJTBDCoreValuePromptQuestion),
this.la.$("FloodgateSurveyJTBDCoreValueSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("FloodgateSurveyJTBDCoreValueNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("FloodgateSurveyJTBDCoreValueQuestion1",CommonUIStrings.l_FloodgateSurveyJTBDCoreValueQuestion1),this.la.$("FloodgateSurveyJTBDCoreValueOption1",CommonUIStrings.l_FloodgateSurveyJTBDCoreValueOption1),this.la.$("FloodgateSurveyJTBDCoreValueOption2",CommonUIStrings.l_FloodgateSurveyJTBDCoreValueOption2),this.la.$("FloodgateSurveyJTBDCoreValueOption3",
CommonUIStrings.l_FloodgateSurveyJTBDCoreValueOption3),this.la.$("FloodgateSurveyJTBDCoreValueOption4",CommonUIStrings.l_FloodgateSurveyJTBDCoreValueOption4),this.la.$("FloodgateSurveyJTBDCoreValueOption5",CommonUIStrings.l_FloodgateSurveyJTBDCoreValueOption5),this.la.$("FloodgateSurveyJTBDCoreValueQuestion2",CommonUIStrings.l_FloodgateSurveyJTBDCoreValueQuestion2),this.la.$("UploadFileSurvey_PromptLine1",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("UploadFileSurvey_PromptLine2",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("UploadFileSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("UploadFileSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("UploadFileSurvey_RatingQuestion",CommonUIStrings.l_UploadFileSurvey_RatingQuestion),this.la.$("UploadFileSurvey_RatingValue1",CommonUIStrings.l_UploadFileSurvey_RatingValue_1),this.la.$("UploadFileSurvey_RatingValue2",CommonUIStrings.l_UploadFileSurvey_RatingValue_2),this.la.$("UploadFileSurvey_RatingValue3",
CommonUIStrings.l_UploadFileSurvey_RatingValue_3),this.la.$("UploadFileSurvey_RatingValue4",CommonUIStrings.l_UploadFileSurvey_RatingValue_4),this.la.$("UploadFileSurvey_RatingValue5",CommonUIStrings.l_UploadFileSurvey_RatingValue_5),this.la.$("UploadFileSurvey_CommentQuestion",CommonUIStrings.l_UploadFileSurvey_CommentQuestion),this.la.$("NewTheme_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("NewTheme_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.la.$("NewTheme_RatingQuestion",CommonUIStrings.l_NewTheme_Floodgate_RatingQuestion),this.la.$("NewTheme_PPT_RatingQuestion",CommonUIStrings.l_NewTheme_PPT_Floodgate_RatingQuestion),this.la.$("NewTheme_RatingValue1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.la.$("NewTheme_RatingValue2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.la.$("NewTheme_RatingValue3",CommonUIStrings.l_NewTheme_Floodgate_RatingValue_3),this.la.$("NewTheme_RatingValue4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.la.$("NewTheme_RatingValue5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.la.$("NewTheme_VerbatimQuestion",CommonUIStrings.l_NewTheme_Floodgate_Verbatim_Question),this.la.$("NewTheme_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("NewTheme_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("WordCommentFiltering_FloodgatePromptTitle",CommonUIStrings.l_WordCommentFiltering_FloodgatePromptTitle),
this.la.$("WordCommentFiltering_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentFiltering_FloodgatePromptQuestion),this.la.$("WordCommentFiltering_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentFiltering_FloodgatePrompt_YesLabel),this.la.$("WordCommentFiltering_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentFiltering_FloodgatePrompt_NoLabel),this.la.$("WordCommentFiltering_FloodgateRatingQuestion",CommonUIStrings.l_WordCommentFiltering_FloodgateRatingQuestion),this.la.$("WordCommentFiltering_FloodgateRating_1",
CommonUIStrings.l_WordCommentFiltering_FloodgateRating_1),this.la.$("WordCommentFiltering_FloodgateRating_2",CommonUIStrings.l_WordCommentFiltering_FloodgateRating_2),this.la.$("WordCommentFiltering_FloodgateRating_3",CommonUIStrings.l_WordCommentFiltering_FloodgateRating_3),this.la.$("WordCommentFiltering_FloodgateRating_4",CommonUIStrings.l_WordCommentFiltering_FloodgateRating_4),this.la.$("WordCommentFiltering_FloodgateRating_5",CommonUIStrings.l_WordCommentFiltering_FloodgateRating_5),this.la.$("WordCommentFiltering_FloodgateWhyQuestion",
CommonUIStrings.l_WordCommentFiltering_FloodgateWhyQuestion),this.la.$("WordDocumentAutoRename_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.la.$("WordDocumentAutoRename_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.la.$("WordDocumentAutoRename_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.la.$("WordDocumentAutoRename_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.la.$("WordDocumentAutoRename_FloodgateRatingQuestion",
CommonUIStrings.l_WordDocumentAutoRename_FloodgateRatingQuestion),this.la.$("WordDocumentAutoRename_FloodgateRating_1",CommonUIStrings.l_WordDocumentAutoRename_FloodgateRating_1),this.la.$("WordDocumentAutoRename_FloodgateRating_2",CommonUIStrings.l_WordDocumentAutoRename_FloodgateRating_2),this.la.$("WordDocumentAutoRename_FloodgateRating_3",CommonUIStrings.l_WordDocumentAutoRename_FloodgateRating_3),this.la.$("WordDocumentAutoRename_FloodgateRating_4",CommonUIStrings.l_WordDocumentAutoRename_FloodgateRating_4),
this.la.$("WordDocumentAutoRename_FloodgateRating_5",CommonUIStrings.l_WordDocumentAutoRename_FloodgateRating_5),this.la.$("WordDocumentAutoRename_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentAutoRename_FloodgateWhyQuestion)}catch(Ga){k.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(Ga?Ga.toString():""))}}static y$i(Ga){try{return new Promise(cb=>{window.setTimeout(()=>{cb(null)},Ga)})}catch(cb){return k.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),
Promise.resolve(null)}}static Kjg(){return!r.AFrameworkApplication.fa.getBooleanAppSetting("FloodgateGovernanceServiceIsDisabled")}static UIj(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",!1)}static rgj(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableWebCampaignGovernance",!1)}static hgj(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOutOfScopeTelemetry",
!1)}static Q6d(Ga){const cb=Ga?Ga[0]:null;k.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(cb?cb.surfaceId:""));if(cb&&"customsurface"===(cb&&cb.surfaceType?cb.surfaceType.toLocaleLowerCase():null)){const Ob=da.BrowserFeedbackControlOCV.U_j(cb);if(Ob)return k.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+Ob+", "+cb.surfaceId),null}return Ac.Q6d(Ga)}static cCj(){const Ga={};Ga.retry=r.AFrameworkApplication.fa.tc("FloodgateGovernanceServiceRetryCount",
0);Ga.timeout=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);Ga.simpleRequestEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);Ga.forceServicelessSurveyDisplay=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return Ga}static hAj(Ga){return{enabled:da.BrowserFeedbackControlOCV.I_c(),
dum:r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicUxDelayInMs",0),Ld:Vb.Uvj(Ga)}}static Uvj(Ga){const cb=Object(ca.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn();switch(Ga.toLowerCase()){case "word":return cb?"WordDarkTheme":"WordLightTheme";case "excel":return cb?"ExcelDarkTheme":"ExcelLightTheme";case "powerpoint":return cb?"PowerPointDarkTheme":"PowerPointLightTheme";case "visio":return cb?"VisioDarkTheme":"VisioLightTheme";case "onenote":return cb?
"OneNoteDarkTheme":"OneNoteLightTheme";default:return cb?"OfficeDarkTheme":"OfficeLightTheme"}}static Y1i(Ga){if(!("Unknown"!==Ga&&"Automation"!==Ga&&r.AFrameworkApplication.fa.getBooleanAppSetting("FloodgateAuthCallbackIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return k.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+Ga),null;Ga={};Ga.getUserPuid=Vb.eRj;r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PersonalizationOAuthManagerEnabled",
!1)&&(Ga.getAuthToken=Vb.getAuthToken);return Ga}static C5i(){const Ga={};Ga.enabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PersonalizationUserFactsReadConfigEnabled",!1);return Ga}static getAuthToken(Ga){return Ga&&Ga.scenario?"tulips"===Ga.scenario.toLowerCase()?$b.YEl():null:(k.ULS.sendTraceTag(508905240,356,50,"SIFB Invalid authCallback params"),null)}static W1i(){const Ga={},cb=!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",
!1)&&(r.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));Ga.isEnabled=cb;return Ga}static eRj(){return r.AFrameworkApplication.fa.Ea("Puid")}static Ghe(Ga){if(!Ga||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const cb=(r.AFrameworkApplication.fa.Ea("FlightId")||"").toLocaleLowerCase(),
Ob=Ga.toString().toLocaleLowerCase().split(";");for(const Db of Ob)if(-1!==cb.indexOf(Db))return Db}catch(cb){k.ULS.sendTraceTag(508961431,306,50,"Error retrieving flightId of campaign event -"+(cb?cb.toString():""))}return null}static Rqg(){return da.BrowserFeedbackControlOCV.wwa()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static Qqg(){return da.BrowserFeedbackControlOCV.wwa()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static Pqg(){return da.BrowserFeedbackControlOCV.wwa()&&
r.AFrameworkApplication.fa.getBooleanAppSetting("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static Pbc(Ga){if(da.BrowserFeedbackControlOCV.wwa())switch(Ga){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;
case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(Ga){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;
default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static fSj(){return da.BrowserFeedbackControlOCV.wwa()&&r.AFrameworkApplication.fa.getBooleanAppSetting("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static hSj(){return da.BrowserFeedbackControlOCV.wwa()?CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static gSj(){return da.BrowserFeedbackControlOCV.wwa()?
CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static iSj(){switch(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;
default:return""}}}Vb.Tjb="SystemInitiatedFeedbackIsEnabled";Vb.wPi="obf-CampaignDefinitions";Vb.A3f=100;Vb.b$i=8002;Object(L.a)(Vb,"SystemInitiatedFeedback",null,[525]);class Od{constructor(Ga){if(!Ga)throw Error.argumentNull("SystemInitiatedFeedback is null");this.TFf=Ga;this.sHd={};this.iDc={};this.pHd={}}logActivity(Ga,cb,Ob){const Db=new Date;if(!Ga||!this.TFf.Ebb(Ga,Vb.Tjb,cb))return!1;let mb=null;Ga in this.sHd&&(mb=this.sHd[Ga]);const Vc=this.Ftj(Ga),Zb=this.Etj(Ga);if(this.Ogj(mb,Db,Ob))return k.ULS.sendTraceTag(39924675,
356,50,"SIFB with time lapse: skipped {0} {1} log(s)",Vc,Ga),this.TFf.logActivity(Ga,cb),this.sHd[Ga]=Db,this.iDc[Ga]=0,this.pHd[Ga]=Zb+1,!0;this.iDc[Ga]=Vc+1;return!1}Ogj(Ga,cb,Ob){return Ga?cb.getTime()-Ga.getTime()>=1E3*Ob:!0}Ftj(Ga){let cb=0;Ga in this.iDc&&(cb=this.iDc[Ga]);return cb}Etj(Ga){let cb=0;Ga in this.pHd&&(cb=this.pHd[Ga]);return cb}}Object(L.a)(Od,"SystemInitiatedFeedbackWithTimeLapse",null,[1735]);var jb=d(96),Wb=d(68);d.d(V,"CustomerFeedbackPackage",function(){return qb});class qb{constructor(){this.pqf=
this.Da=null}get name(){return"Common.App.CustomerFeedback"}fc(Ga){r.AFrameworkApplication.gh||(k.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),r.AFrameworkApplication.gh=new D.a);Ga.register(U,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();Ga.register(za,"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().na(()=>new za(jb.FocusManager.instance(),
r.AFrameworkApplication.gh));Ga.register(H,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().na(()=>new H(Ga.resolve("Common.App.ICustomerFeedbackUiWrapper"),Ga.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),r.AFrameworkApplication.gh));Ga.register(1729,"Common.ICustomerFeedbackActor").ma().na(()=>new B(r.AFrameworkApplication.Pa,r.AFrameworkApplication.za,Ga.Ha("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
r.AFrameworkApplication.fa,r.AFrameworkApplication.gh));Ga.register(Vb,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().na(()=>new Vb(Ga.resolve("Common.App.ICustomerFeedbackUiWrapper")));Ga.register(Od,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().na(()=>new Od(Ga.resolve("Common.ISystemInitiatedFeedback")));this.Da=Ga}init(){qb._initialized||(qb.Bgc()||(this.pqf=this.Da.resolve("Common.ICustomerFeedbackActor"),
this.pqf.qb(),r.AFrameworkApplication.za.Gf()),this.Da.Ha("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),qb._initialized=!0)}dispose(){}static Bgc(){return!!r.AFrameworkApplication.za&&!!r.AFrameworkApplication.za.mb&&3===r.AFrameworkApplication.za.mb.Ej&&1===r.AFrameworkApplication.za.mb.wLa}static main(){let Ga=!1;qb.Bgc()&&(Ga=!0);Wb.a.instance.Ac(new qb,
0,Ga)}}qb._initialized=!1;Object(L.a)(qb,"CustomerFeedbackPackage",null,[2,3])},1209:function(L,V,d){d.r(V);L=d(0);var k=d(526),e=d(527);class n{constructor(y){this.UQ=this.npf=k.a.unused;this.xLc=y}get zxb(){return this.npf}xTe(y,m,C,E){C===this.xLc.element&&(this.npf=y,this.UQ=E+this.xLc.offset)}wVe(){}K2d(y){return this.zxb!==k.a.unused?Object.assign(new e.a,{element:y,offset:this.UQ}):null}}Object(L.a)(n,"ChildSelectionHelper",null,[614]);class r{constructor(y,m){this.eRd=!1;this.xLc=m;this._parent=
y;this.UQ=m.offset}get zxb(){return k.a.unused}xTe(y,m,C,E){m||this.xLc.offset!==y||(this.UQ=E,this.eRd=!0)}wVe(y,m){!this.eRd&&this.UQ>m&&(this.UQ-=m-y+1)}K2d(y){return Object.assign(new e.a,{element:this.eRd?y:this._parent,offset:this.UQ})}}Object(L.a)(r,"ParentSelectionHelper",null,[614]);var w=d(938);d.d(V,"CombineHelper",function(){return D});class D{constructor(y,m,C){this.esf=k.a.unused;this.mWb="";this._element=y;this.t1b=m;this.S0b=this.shg(y,C.start);this.P0b=this.shg(y,C.end)}shg(y,m){return m.element===
y?new r(y,m):new n(m)}Fwi(y){const m=y===this.t1b,C=this._element.childNodes[y],E=this.mWb.length;this.S0b.xTe(y,m,C,E);this.P0b.xTe(y,m,C,E);this.mWb+=C.nodeValue}end(y,m){this.t1b!==m&&(this.esf=m,Array.add(y,this))}hWi(){var y=this.MIj();this.GCh(this.t1b,y-1);this.GCh(y+1,this.esf);y=this._element.childNodes[this.t1b];this.mWb!==y.nodeValue&&(y.nodeValue=this.mWb);return this.QLi(y)}GCh(y,m){if(!(m<y)){this.S0b.wVe(y,m);this.P0b.wVe(y,m);for(let C=y;C<=m;C++)this._element.removeChild(this._element.childNodes[y])}}QLi(y){return Object.assign(new w.a,
{start:this.S0b.K2d(y),end:this.P0b.K2d(y)})}MIj(){return this.S0b.zxb!==k.a.unused?this.S0b.zxb:this.P0b.zxb!==k.a.unused?this.P0b.zxb:this.t1b}}Object(L.a)(D,"CombineHelper",null,[])},121:function(L,V,d){d.d(V,"a",function(){return k});d.d(V,"b",function(){return e});const k=n=>null===n||"undefined"===typeof n||!n.length,e=n=>null===n||"undefined"===typeof n},1210:function(L,V,d){L=d(0);var k=d(35);class e{constructor(){this.classId=0}static Pyb(y){try{return k.a(y)}catch(m){}return null}}Object(L.a)(e,
"ARoamingAppsResponse",null,[]);class n{constructor(){this.state=this.callback=null}}Object(L.a)(n,"GetRoamingAppsLauncherContext",null,[]);var r=d(25),w=d(80);d.d(V,"a",function(){return D});class D{constructor(y){this.iJd=!1;this.j9=D.Udb;this.iEf=this.NRd=0;this.platform=null;this.XSi=m=>{r.AFrameworkApplication.Dh||(e.Pyb(m.data.Ud),this.aOh())};this.WSi=()=>{if(!r.AFrameworkApplication.Dh)if(this.NRd>=D.VWk)this.aOh();else{var m=new w.a(2,1,this.j9,this.BHl,59);r.AFrameworkApplication.Be.Jb(m);
this.NRd++;this.j9*=D.g5e;this.j9>D.Cpc&&(this.j9=D.Cpc)}};this.BHl=()=>{this.x$f()};this.dni=y;this.jEf=!1}get BHh(){return this.dni}VSi(){r.AFrameworkApplication.ofc&&this.BHh&&!this.jEf&&!this.iJd&&(this.iEf=3,this.iJd=!0,this.MFl(),this.x$f())}MFl(){this.j9=D.Udb;this.NRd=0}x$f(){const y=new (d(1171).CheckRoamingRightsRequest);y.RoamingApp=this.iEf;y.BaseDocQuerySignature=r.AFrameworkApplication.mh;y.execute(this.XSi,this.WSi,null)}aOh(){this.jEf=!0;this.iJd=!1}static get instance(){return D.Iu||
(D.Iu=new D(r.AFrameworkApplication.DFi))}}D.Udb=1E3;D.g5e=5;D.Cpc=12E5;D.VWk=5;D.Iu=null;Object(L.a)(D,"RoamingAppsManager",null,[])},1211:function(L,V,d){L=d(0);var k=d(7),e=d(984),n=d(67);class r extends e.a{constructor(F,B,H,K,A,W){super(F,H,A.sT,void 0===W?null:W);this.$zf=0;this.onClick=()=>{this.dismiss();return!0};this.Uca=this.GFj(K);this.Qub=B;this.oi=A;this.Def=7;this.kt=this.Qub.ownerDocument.createElement("div");this.kt.className="ModalCalloutControlOverlay";this.kt.tabIndex=0;this.Qub.insertBefore(this.kt,
this.Qub.firstChild)}show(){this.MM||(this.oi.Glb(),this.oi.XSa(!1),this.kt.style.zIndex=String(this.oi.qta),super.show(),this.ps(),this.$zf=window.setTimeout(Object(k.a)(this,this.dismiss,"dismiss"),1E3*this.Def))}dismiss(){this.MM&&(this.oi.PUa(!1),this.Jca(),this.Qub&&this.Qub.contains(this.kt)&&this.Qub.removeChild(this.kt),super.dismiss(),window.clearTimeout(this.$zf))}ps(){this.oi.v9(Object(k.a)(this,this.dismiss,"dismiss"));this.oi.Mz.xb(n.a.click,this.kt,this.onClick)}Jca(){this.oi.VMa(Object(k.a)(this,
this.dismiss,"dismiss"));this.oi.Mz.Hb(n.a.click,this.kt,this.onClick)}GFj(F){let B=0;switch(F){case 0:B=190;break;case 1:B=250;break;case 2:B=300;break;case 3:B=360}return B}}Object(L.a)(r,"ModalCallout",e.a,[]);var w=d(395),D=d(356),y=d(144);class m extends r{constructor(F,B,H,K,A,W){super(F,B,H,K,A,void 0===W?null:W);this.YIc=null}show(){if(!this.MM){const F=Object.assign(new D.a,{onShow:()=>{r.prototype.show.call(this)}});y.UISurfaces.BM().then(B=>{const H=B.externalNotification();this.YIc=B.addNotification(H,
F);return null},B=>{w.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null})}}dismiss(){this.MM&&this.YIc&&(y.UISurfaces.BM().then(F=>{F.removeNotification(this.YIc);return this.YIc=null},F=>{w.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",F);return null}),super.dismiss())}}Object(L.a)(m,"ReactManagedModalCallout",r,[]);var C=d(25);d.d(V,"a",function(){return E});class E{static X7d(F,B,H,K,A){A=void 0===A?null:A;return C.AFrameworkApplication.za.mb.bYa?
new m(F,B,H,K,C.AFrameworkApplication.za,A):new r(F,B,H,K,C.AFrameworkApplication.za,A)}}Object(L.a)(E,"ModalCalloutControlFactory",null,[])},1216:function(L,V,d){L=d(0);var k=d(1265),e=d(395),n=d(25),r=d(80),w=d(71);class D{static kSj(){if(!D.pDc&&(D.pDc=new w.a,n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.du("AggregatorIdDisabledList"))){const C=n.AFrameworkApplication.fa.hz("AggregatorIdDisabledList");for(let E=0;E<C.length;E++)D.pDc.$(C[E],!0)}return D.pDc}}D.pDc=null;Object(L.a)(D,
"DisabledAggregatorListStore",null,[]);var y=d(287);d.d(V,"a",function(){return m});class m{constructor(C,E,F,B,H,K,A){K=void 0===K?!0:K;A=void 0===A?null:A;this.erf=this.yGf=this.txf=!1;this.je=null;if(!C)throw y.a.argument("taskManagerLazy");if(!H)throw y.a.argument("dataAggregator");this.Hpi=C;this.aSd=E;this._id=F;this.uvf=6E4*B;this.aFc=H;this.NDf=K;this.F0b=A;D.kSj().Ib(this._id.toString())&&(this.erf=!0)}get rT(){return this.je||(this.je=this.Hpi.value)}track(C,E){E=void 0===E?null:E;this.erf||
(this.iij(),this.FKl(),this.aFc.h3b(C,E))}FKl(){!this.txf&&0<this.uvf&&(this.txf=!0,this.CJh())}CJh(){const C=new r.a(5,1,this.uvf,()=>{this.wMl()},19,this._id.toString());this.rT.Jb(C)}wMl(){!this.F0b||this.F0b.M9e()?this.Uxd():this.NDf&&this.aFc.reset();this.CJh()}Uxd(){const C=this.aFc.getData();if(C){const E=parseInt(String(C.length));if(isNaN(E)||0<E)this.OKh(C),this.NDf&&this.aFc.reset()}}OKh(C){e.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:C})}iij(){this.yGf||
(this.aSd(()=>{this.Uxd()}),this.yGf=!0)}static Fs(C,E,F,B,H){return new m(new k.a(()=>n.AFrameworkApplication.Be),n.AFrameworkApplication.Jia,C,E,F,B,H)}static XX(C,E,F,B){return m.Fs(C,E,F,void 0===B?!0:B,null)}}Object(L.a)(m,"Aggregator",null,[166])},1292:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.arm=3]="IE";e[e.safari=4]="safari";e[e.UBm=5]="others";e[e.unknown=6]="unknown";e[e.zum=7]="electron";
e[e.ytm=8]="chromiumEdge";e[e.mEm=9]="teamsElectron"})(k||(k={}));Object(L.b)("BrowserCode",k)},1293:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.value=!1}}Object(L.a)(k,"OutBool",null,[])},1294:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(L.a)(k,"ColorCellProps",null,[])},1295:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(359);class k extends d.a{constructor(){super();
this.Style=this.Character=null}get Type(){return 1}}Object(L.a)(k,"CharacterCodeGalleryButtonProps",d.a,[])},1296:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(520);class e{constructor(n){this.vea=n}$6e(n){return k.a.then(this.vea.y9a(n,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),r=>this.hKj(r))}hKj(n){return n&&n.Hj&&n.Hj.data?n.Hj.data.Ud:null}}Object(L.a)(e,"SimpleRequestManager",null,[597])},1297:function(L,V,d){d.d(V,"a",
function(){return k});L=d(0);d=d(301);class k{}k.LabelText=d.a.labelText;k.Alt=d.a.alt;k.Image16by16Class=d.a.PCb;k.Image32by32Class=d.a.bHa;k.Image48by48Class=d.a.Toe;k.Visible=d.a.visible;k.HasPopup="HasPopup";Object(L.a)(k,"ButtonCommandProperties",null,[])},1298:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.horizontal=0]="horizontal";e[e.vertical=1]="vertical"})(k||(k={}));Object(L.b)("Orientation",k)},1299:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);
var k;(function(e){e[e.isEnabled=1]="isEnabled";e[e.execute=2]="execute";e[e.animation=3]="animation"})(k||(k={}));Object(L.b)("ActionBehavior",k)},1300:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.fZk=0]="msoulscat_ES_EWAJS";e[e.hZk=1]="msoulscat_ES_EWAJSGrid";e[e.hwm=2]="msoulscat_ES_EWAJSHeaderResize";e[e.iwm=3]="msoulscat_ES_EWAJSKeyboard";e[e.lwm=4]="msoulscat_ES_EWAJSTest";e[e.gwm=5]="msoulscat_ES_EWAJSFloatingObjects";e[e.gZk=6]="msoulscat_ES_EWAJSChart";e[e.nwm=
7]="msoulscat_ES_MobileEwa";e[e.dwm=8]="msoulscat_ES_EWAJSBIExplore";e[e.jwm=9]="msoulscat_ES_EWAJSNov";e[e.fwm=10]="msoulscat_ES_EWAJSExcelEverywhere";e[e.mwm=11]="msoulscat_ES_EWAJSTp";e[e.ewm=12]="msoulscat_ES_EWAJSComment";e[e.kwm=13]="msoulscat_ES_EWAJSOCSIntegration";e[e.rBm=100]="msoulscat_bULS_Uploader";e[e.pBm=101]="msoulscat_bULS_CachingHost";e[e.qBm=102]="msoulscat_bULS_Core";e[e.oBm=103]="msoulscat_bULS_Assert";e[e.txm=200]="msoulscat_Osi_MsoSpLogging";e[e.Dwm=201]="msoulscat_MSOSP_Error";
e[e.iZk=202]="msoulscat_MSOSP_FileMenuCommands";e[e.Fwm=203]="msoulscat_MSOSP_MsoSpRenameManager";e[e.Awm=204]="msoulscat_MSOSP_CrossDocumentMessenger";e[e.wwm=205]="msoulscat_MSOSP_ClientRequestManager";e[e.Cwm=206]="msoulscat_MSOSP_DownloadQueue";e[e.xwm=207]="msoulscat_MSOSP_CommandUI";e[e.vwm=208]="msoulscat_MSOSP_AppSettings";e[e.ywm=209]="msoulscat_MSOSP_CommonDebug";e[e.Bwm=210]="msoulscat_MSOSP_DomUtils";e[e.Hwm=211]="msoulscat_MSOSP_OIC";e[e.uwm=212]="msoulscat_MSOSP_AnonEdit";e[e.rwm=213]=
"msoulscat_MSOSP_Activity";e[e.twm=214]="msoulscat_MSOSP_AnonCreate";e[e.Gwm=215]="msoulscat_MSOSP_O365ShellService";e[e.Lwm=216]="msoulscat_MSOSP_SaveToCloudStorage";e[e.Mwm=217]="msoulscat_MSOSP_SessionExpirationManager";e[e.Pwm=218]="msoulscat_MSOSP_TaskManager";e[e.Kwm=219]="msoulscat_MSOSP_SaveAsToHost";e[e.swm=220]="msoulscat_MSOSP_AddInCommands";e[e.zwm=221]="msoulscat_MSOSP_CookieCompliance";e[e.uxm=222]="msoulscat_Osi_MsoSpOfflineLogger";e[e.Nwm=223]="msoulscat_MSOSP_Signals";e[e.Owm=224]=
"msoulscat_MSOSP_Skills";e[e.jZk=225]="msoulscat_MSOSP_OTelJS";e[e.Iwm=226]="msoulscat_MSOSP_OTelJSBootstrap";e[e.kZk=227]="msoulscat_MSOSP_OTelJSInWebWoker";e[e.lZk=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype";e[e.Jwm=229]="msoulscat_MSOSP_OTelJSTest";e[e.Ewm=230]="msoulscat_MSOSP_LiveMeeting";e[e.Qwm=231]="msoulscat_MSOSP_UploadFileFromPC";e[e.cBm=300]="msoulscat_Wac_WordMerge";e[e.dym=301]="msoulscat_WAC_WordViewer";e[e.TZk=302]="msoulscat_Wac_WordPresence";e[e.Pzm=303]="msoulscat_Wac_RevisionDiffer";
e[e.vAm=304]="msoulscat_Wac_WordCoauth";e[e.Ozm=305]="msoulscat_Wac_Replication";e[e.fq=306]="msoulscat_Wac_BrowserGeneral";e[e.cwm=307]="msoulscat_Box4_CopyPaste";e[e.LAm=308]="msoulscat_Wac_WordEditorFootnoteEndnote";e[e.TAm=309]="msoulscat_Wac_WordEditorPageNumber";e[e.yym=310]="msoulscat_Wac_EventManager";e[e.ZAm=311]="msoulscat_Wac_WordEditorTableStyle";e[e.KAm=312]="msoulscat_Wac_WordEditorFindReplace";e[e.Bym=313]="msoulscat_Wac_FindReplace";e[e.SAm=314]="msoulscat_Wac_WordEditorPageBreak";
e[e.Jxm=315]="msoulscat_WAC_Box4Crash";e[e.AAm=316]="msoulscat_Wac_WordEditorBlobFormatting";e[e.NAm=317]="msoulscat_Wac_WordEditorHeaderFooter";e[e.XAm=318]="msoulscat_Wac_WordEditorSelection";e[e.Pym=319]="msoulscat_Wac_NodeLogger";e[e.Yzm=320]="msoulscat_Wac_TaskPaneFramework";e[e.Cym=321]="msoulscat_Wac_Focus";e[e.Iym=322]="msoulscat_Wac_ImageEditor";e[e.wym=323]="msoulscat_Wac_EditingView";e[e.jym=324]="msoulscat_Wac_Box4General";e[e.Zym=325]="msoulscat_Wac_PeoplesWell";e[e.Xym=326]="msoulscat_Wac_PageView";
e[e.pym=327]="msoulscat_Wac_Comments";e[e.vym=328]="msoulscat_Wac_DirectPrint";e[e.Eym=329]="msoulscat_Wac_GraphValidation";e[e.Vym=330]="msoulscat_Wac_OneNotePrint";e[e.fym=331]="msoulscat_Wac_AppSettings";e[e.xym=332]="msoulscat_Wac_Embed";e[e.Szm=333]="msoulscat_Wac_SkypeChat";e[e.Ixm=334]="msoulscat_WAC_Accessibility";e[e.eym=335]="msoulscat_Wac_Aggregator";e[e.UAm=336]="msoulscat_Wac_WordEditorPagination";e[e.cym=337]="msoulscat_WAC_WordEditorSave";e[e.rAm=338]="msoulscat_Wac_WoncaGeneral";e[e.CZk=
339]="msoulscat_Wac_OneNoteGeneral";e[e.MZk=340]="msoulscat_Wac_Ribbon";e[e.zAm=341]="msoulscat_Wac_WordEditorAppsForOffice";e[e.Rzm=342]="msoulscat_Wac_SendUsYourFile";e[e.Kxm=343]="msoulscat_WAC_DocxSaveMonitor";e[e.hym=344]="msoulscat_Wac_AppsForOffice";e[e.nym=345]="msoulscat_Wac_BrowserPerformance";e[e.YAm=346]="msoulscat_Wac_WordEditorShapes";e[e.JAm=347]="msoulscat_Wac_WordEditorFeatureHelper";e[e.Lym=348]="msoulscat_Wac_InsertSymbol";e[e.qAm=349]="msoulscat_Wac_WebAppsPortal";e[e.nBm=350]=
"msoulscat_Wac_Yammer";e[e.Wym=351]="msoulscat_Wac_OoXml";e[e.Kym=352]="msoulscat_Wac_InsertMedia";e[e.mBm=353]="msoulscat_Wac_WordZoom";e[e.MAm=354]="msoulscat_Wac_WordEditorFormatPainter";e[e.eBm=355]="msoulscat_Wac_WordRealTimeTyping";e[e.RZk=356]="msoulscat_Wac_WacFeedback";e[e.fAm=357]="msoulscat_Wac_WacFeedbackExcelOnlineViewMode";e[e.dAm=358]="msoulscat_Wac_WacFeedbackExcelOnlineEditMode";e[e.eAm=359]="msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode";e[e.iAm=360]="msoulscat_Wac_WacFeedbackPptOnlineViewMode";
e[e.hAm=361]="msoulscat_Wac_WacFeedbackPptOnlineEditMode";e[e.gAm=362]="msoulscat_Wac_WacFeedbackOneNoteOnline";e[e.mAm=363]="msoulscat_Wac_WacFeedbackWordOnlineViewMode";e[e.lAm=364]="msoulscat_Wac_WacFeedbackWordOnlineEditMode";e[e.lym=365]="msoulscat_Wac_Box4Undo";e[e.GAm=366]="msoulscat_Wac_WordEditorCustomXml";e[e.QAm=367]="msoulscat_Wac_WordEditorNavigationPane";e[e.FAm=368]="msoulscat_Wac_WordEditorContentControl";e[e.IAm=369]="msoulscat_Wac_WordEditorExtension";e[e.$zm=370]="msoulscat_Wac_UpdateHints";
e[e.Tym=371]="msoulscat_Wac_OneNoteAppsforOffice";e[e.Uym=372]="msoulscat_Wac_OneNoteExtension";e[e.kAm=373]="msoulscat_Wac_WacFeedbackVisioOnlineViewMode";e[e.jAm=374]="msoulscat_Wac_WacFeedbackVisioOnlineEditMode";e[e.Mzm=375]="msoulscat_Wac_Proofing";e[e.$Am=376]="msoulscat_Wac_WordEditorTrackChange";e[e.BAm=377]="msoulscat_Wac_WordEditorCatchUp";e[e.pAm=378]="msoulscat_Wac_WacSafeLinks";e[e.sAm=379]="msoulscat_Wac_WopiBootstrapper";e[e.Yym=380]="msoulscat_Wac_PeopleHandler";e[e.oAm=381]="msoulscat_Wac_WacOcsVectorClockTelemetry";
e[e.cAm=382]="msoulscat_Wac_WacDigitalPrint";e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";e[e.$ym=384]="msoulscat_Wac_PolicyHandler";e[e.OAm=385]="msoulscat_Wac_WordEditorMetadataHelper";e[e.WAm=386]="msoulscat_Wac_WordEditorRevisionMetadata";e[e.nAm=387]="msoulscat_Wac_WacInProductMessaging";e[e.VAm=388]="msoulscat_Wac_WordEditorResumeAssistant";e[e.iym=389]="msoulscat_Wac_Box4AugmentationLoop";e[e.yAm=390]="msoulscat_Wac_WordEditorAcronyms";e[e.QZk=391]="msoulscat_Wac_WacCatchUpActivities";
e[e.bAm=392]="msoulscat_Wac_WacAwayStatus";e[e.kym=393]="msoulscat_Wac_Box4List";e[e.xZk=394]="msoulscat_Wac_Dictation";e[e.DZk=395]="msoulscat_Wac_OneNoteSync";e[e.Hym=396]="msoulscat_Wac_IdeasRuntime";e[e.Gym=397]="msoulscat_Wac_IdeasPane";e[e.Jym=398]="msoulscat_Wac_Infrared";e[e.PAm=399]="msoulscat_Wac_WordEditorModernTranslator";e[e.gxm=400]="msoulscat_OneService_Site";e[e.oxm=401]="msoulscat_OneService_UnitTests";e[e.dxm=402]="msoulscat_OneService_ClipperInstall";e[e.fxm=403]="msoulscat_OneService_ClipperUsage";
e[e.jxm=404]="msoulscat_OneService_Site_EmailSettings";e[e.mxm=405]="msoulscat_OneService_Site_Notebooks";e[e.ixm=406]="msoulscat_OneService_Site_DevSite";e[e.kxm=407]="msoulscat_OneService_Site_FeaturedApps";e[e.lxm=408]="msoulscat_OneService_Site_FeedbackPage";e[e.Zwm=409]="msoulscat_OneService_Augmentation";e[e.cxm=410]="msoulscat_OneService_AugmentationProvider_UrlEnhancer";e[e.axm=411]="msoulscat_OneService_AugmentationProvider_DomEnhancer";e[e.bxm=412]="msoulscat_OneService_AugmentationProvider_Entitization";
e[e.exm=413]="msoulscat_OneService_ClipperTooltip";e[e.nxm=414]="msoulscat_OneService_Site_Students";e[e.$wm=415]="msoulscat_OneService_AugmentationProvider_BizcardExtractor";e[e.hxm=416]="msoulscat_OneService_Site_ClassNotebook";e[e.Mxm=500]="msoulscat_WAC_RealtimeChannel";e[e.Nxm=501]="msoulscat_WAC_RealtimeChannelTest";e[e.Lxm=502]="msoulscat_WAC_HostNotification";e[e.Oxm=600]="msoulscat_WAC_Signalr";e[e.Pxm=700]="msoulscat_WAC_VisioApp";e[e.Vxm=701]="msoulscat_WAC_VisioLoader";e[e.Txm=702]="msoulscat_WAC_VisioDataModel";
e[e.Xxm=703]="msoulscat_WAC_VisioRenderer";e[e.Wxm=704]="msoulscat_WAC_VisioRecalc";e[e.Rxm=705]="msoulscat_WAC_VisioCommand";e[e.Sxm=706]="msoulscat_WAC_VisioController";e[e.Yxm=707]="msoulscat_WAC_VisioShapePanel";e[e.Qxm=708]="msoulscat_WAC_VisioAppControls";e[e.Zxm=709]="msoulscat_WAC_VisioSync";e[e.Uxm=710]="msoulscat_WAC_VisioDataRefresh";e[e.bym=711]="msoulscat_WAC_VisioWebDVAddinService";e[e.aym=712]="msoulscat_WAC_VisioWebDVAddinClient";e[e.$xm=713]="msoulscat_WAC_VisioWebClipboard";e[e.EZk=
800]="msoulscat_Wac_PptAnimation";e[e.azm=801]="msoulscat_Wac_PptAppEvents";e[e.bzm=802]="msoulscat_Wac_PptAppsForOffice";e[e.czm=803]="msoulscat_Wac_PptBrowserLayer";e[e.dzm=804]="msoulscat_Wac_PptCoauthoring";e[e.fzm=805]="msoulscat_Wac_PptComments";e[e.izm=806]="msoulscat_Wac_PptEditingManager";e[e.jzm=807]="msoulscat_Wac_PptFocus";e[e.nzm=808]="msoulscat_Wac_PptGraph";e[e.ozm=809]="msoulscat_Wac_PptInit";e[e.qzm=810]="msoulscat_Wac_PptNavigation";e[e.rzm=811]="msoulscat_Wac_PptNone";e[e.szm=812]=
"msoulscat_Wac_PptNotes";e[e.uzm=813]="msoulscat_Wac_PptPerf";e[e.wzm=814]="msoulscat_Wac_PptPresence";e[e.KZk=815]="msoulscat_Wac_PptShape";e[e.zzm=816]="msoulscat_Wac_PptSelection";e[e.JZk=817]="msoulscat_Wac_PptSession";e[e.Bzm=818]="msoulscat_Wac_PptTasks";e[e.Dzm=819]="msoulscat_Wac_PptThumbnailPane";e[e.Czm=820]="msoulscat_Wac_PptText";e[e.Ezm=821]="msoulscat_Wac_PptUtil";e[e.lkb=822]="msoulscat_Wac_PptView";e[e.Azm=823]="msoulscat_Wac_PptSynchronization";e[e.Hzm=824]="msoulscat_Wac_PptWebService";
e[e.pzm=825]="msoulscat_Wac_PptMedia";e[e.gzm=826]="msoulscat_Wac_PptCopyPaste";e[e.Jzm=827]="msoulscat_Wac_PptZoom";e[e.yzm=828]="msoulscat_Wac_PptRealTimeCoauth";e[e.hzm=829]="msoulscat_Wac_PptDesigner";e[e.LZk=830]="msoulscat_Wac_PptSlideshow";e[e.vzm=831]="msoulscat_Wac_PptPictureCrop";e[e.Fzm=832]="msoulscat_Wac_PptVersionHistory";e[e.HZk=833]="msoulscat_Wac_PptLive";e[e.IZk=834]="msoulscat_Wac_PptMWeb";e[e.kzm=835]="msoulscat_Wac_PptGc2General";e[e.lzm=836]="msoulscat_Wac_PptGc2GraphicHost";
e[e.mzm=837]="msoulscat_Wac_PptGc2Operation";e[e.xzm=838]="msoulscat_Wac_PptPresentToTeams";e[e.Izm=839]="msoulscat_Wac_PptWebSocketFrontDoor";e[e.Nym=840]="msoulscat_Wac_MediaSnap";e[e.Oym=841]="msoulscat_Wac_MediaTranscoding";e[e.Aym=842]="msoulscat_Wac_FileSnap";e[e.tzm=843]="msoulscat_Wac_PptPartialDocs";e[e.FZk=844]="msoulscat_Wac_PptDataSync";e[e.ezm=845]="msoulscat_Wac_PptCollabTasks";e[e.Gzm=846]="msoulscat_Wac_PptVideos";e[e.oym=847]="msoulscat_Wac_ChatPPT";e[e.GZk=848]="msoulscat_Wac_PptFluidRuntime";
e[e.xxm=1300]="msoulscat_Uci_CommandsClient";e[e.Cxm=1301]="msoulscat_Uci_InsightsClient";e[e.vxm=1302]="msoulscat_Uci_Assistance";e[e.Bxm=1303]="msoulscat_Uci_Insights";e[e.Exm=1304]="msoulscat_Uci_Insights_Overview";e[e.Dxm=1306]="msoulscat_Uci_Insights_DrillIn";e[e.Gxm=1307]="msoulscat_Uci_JunoClient";e[e.Axm=1308]="msoulscat_Uci_GraphImportClient";e[e.Hxm=1309]="msoulscat_Uci_TellMeServiceClient";e[e.zxm=1310]="msoulscat_Uci_EnrichmentClient";e[e.Fxm=1311]="msoulscat_Uci_JunoBrowserExtension";
e[e.yxm=1312]="msoulscat_Uci_Enrichment";e[e.qZk=1313]="msoulscat_Uci_SmartLookupClient";e[e.wxm=1314]="msoulscat_Uci_CanvasContext";e[e.nZk=1401]="msoulscat_Osf_Latency";e[e.oZk=1402]="msoulscat_Osf_Notification";e[e.pZk=1403]="msoulscat_Osf_Runtime";e[e.pxm=1404]="msoulscat_Osf_AppManagementMenu";e[e.qxm=1405]="msoulscat_Osf_InsertionDialogSession";e[e.sxm=1406]="msoulscat_Osf_UploadFileDevCatelog";e[e.rxm=1411]="msoulscat_Osf_UploadFileDevCatalogUsage";e[e.Xwm=1600]="msoulscat_OneNoteOnline_Navigation";
e[e.mZk=1601]="msoulscat_OneNoteOnline_EditableCache";e[e.Ywm=1602]="msoulscat_OneNoteOnline_Zoom";e[e.bwm=1700]="msoulscat_Alchemy_Browser";e[e.pwm=1800]="msoulscat_Ice_EmailHrd";e[e.qwm=1801]="msoulscat_Ice_InsertMedia";e[e.owm=1802]="msoulscat_Ice_Abt";e[e.Rwm=1900]="msoulscat_Met_Broadcast";e[e.Swm=2200]="msoulscat_NlAppsClient_Acronyms";e[e.Twm=2201]="msoulscat_NlAppsClient_EditorPane";e[e.Uwm=2202]="msoulscat_NlAppsClient_KeyPoints";e[e.Vwm=2203]="msoulscat_NlAppsClient_Synonyms";e[e.Wwm=2204]=
"msoulscat_NlAppsClient_ToDo";e[e.Fym=2250]="msoulscat_Wac_Ideas";e[e.Nzm=2251]="msoulscat_Wac_ReadingTime";e[e.Dym=2252]="msoulscat_Wac_Goals";e[e.Tzm=2253]="msoulscat_Wac_StatsDialog";e[e.PZk=2300]="msoulscat_Wac_VersionHistory";e[e.BZk=3E3]="msoulscat_Wac_OAuth";e[e.aBm=3001]="msoulscat_Wac_WordGraphicsEditor";e[e.Mym=3002]="msoulscat_Wac_Licensing";e[e.jBm=3003]="msoulscat_Wac_WordTasks";e[e.gym=3004]="msoulscat_Wac_ApplicationFeatureHelper";e[e.UZk=3005]="msoulscat_Wac_WordVersionHistory";e[e.zZk=
3006]="msoulscat_Wac_LivePersonaCard";e[e.mym=3007]="msoulscat_Wac_Box4Workers";e[e.lBm=3008]="msoulscat_Wac_WordWorkers";e[e.DAm=3009]="msoulscat_Wac_WordEditorClientPagination";e[e.dBm=3010]="msoulscat_Wac_WordPrediction";e[e.Zzm=3011]="msoulscat_Wac_TranscriptionPane";e[e.vZk=3012]="msoulscat_Wac_CatchUpFlyout";e[e.qym=3013]="msoulscat_Wac_ComponentStateLogging";e[e.gBm=3014]="msoulscat_Wac_WordRuler";e[e.bBm=3015]="msoulscat_Wac_WordInlineTab";e[e.SZk=3016]="msoulscat_Wac_WordDesigner";e[e.Uzm=
3017]="msoulscat_Wac_Styles";e[e.hBm=3018]="msoulscat_Wac_WordStyles";e[e.Wzm=3019]="msoulscat_Wac_TableOfContents";e[e.tym=3020]="msoulscat_Wac_ConvertWordToPpt";e[e.AZk=3021]="msoulscat_Wac_ModernFontPicker";e[e.iBm=3022]="msoulscat_Wac_WordTables";e[e.wAm=3023]="msoulscat_Wac_WordColors";e[e.Lzm=3025]="msoulscat_Wac_ProactiveUxGovernance";e[e.Kzm=3026]="msoulscat_Wac_PrebootHandler";e[e.OZk=3027]="msoulscat_Wac_UnifiedUiHost";e[e.rym=3028]="msoulscat_Wac_ConditionalTriggering";e[e.uAm=3029]="msoulscat_Wac_WordBookmarks";
e[e.EAm=3030]="msoulscat_Wac_WordEditorClientPaginationTyping";e[e.RAm=3031]="msoulscat_Wac_WordEditorNudgeToWeb";e[e.Vzm=3032]="msoulscat_Wac_Suite";e[e.yZk=3033]="msoulscat_Wac_EquationTools";e[e.sym=3034]="msoulscat_Wac_ContextIQ";e[e.CAm=3035]="msoulscat_Wac_WordEditorClientActivityGeneration";e[e.HAm=3036]="msoulscat_Wac_WordEditorEmergencyView";e[e.fBm=3037]="msoulscat_Wac_WordRevisionSequenceNumber";e[e.xAm=3038]="msoulscat_Wac_WordDataLossMonitor";e[e.Qym=3039]="msoulscat_Wac_OWL";e[e.Rym=
3040]="msoulscat_Wac_OWLNest";e[e.sZk=3041]="msoulscat_Wac_AiMaker";e[e.Sym=3042]="msoulscat_Wac_OfficeTemplatesMetadataService";e[e.tZk=3043]="msoulscat_Wac_AiRewrite";e[e.rZk=3044]="msoulscat_Wac_AiInsert";e[e.zym=3045]="msoulscat_Wac_FastCards";e[e.Qzm=3046]="msoulscat_Wac_SendToKindle";e[e.uZk=3047]="msoulscat_Wac_AiSummarize";e[e.wZk=3048]="msoulscat_Wac_CopilotCompose";e[e.NZk=3049]="msoulscat_Wac_Skittles";e[e.uym=3050]="msoulscat_Wac_CopilotChat"})(k||(k={}));Object(L.b)("ULSCat",k)},1301:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.error=10]="error";e[e.warning=15]="warning";e[e.tvm=20]="important";e[e.info=50]="info";e[e.verbose=100]="verbose";e[e.aEm=200]="spam";e[e.ODm=1E3]="shiftFactor"})(k||(k={}));Object(L.b)("ULSTraceLevel",k)},1305:function(L,V,d){function k(a,b){return a.isDocDirty===b.isDocDirty&&a.isIrm===b.isIrm&&a.isCreateNew===b.isCreateNew&&a.slideCount===b.slideCount&&a.hasSection===b.hasSection&&a.NDb===b.NDb}function e(a){return`DocumentState: {isDocDirty:${a.isDocDirty}, isIrm:${a.isIrm}, isCreateNew:${a.isCreateNew}, slideCount:${a.slideCount}, hasSection:${a.hasSection}, isCreateNewFromBlank:${a.NDb}}`}
function n(a){return new Promise((b,c)=>{try{a.execute(f=>b(f))}catch(f){c(f)}})}function r(a,b){if(!a)throw Error.argumentNull("scenarioOptionsPayload");if(!b)throw Error.argumentNull("graphOperationEventHandlers");const c=a.scenarioName.toLowerCase();switch(c){case "insertimage":return new dm(a,b);case "createpresentation":return new hg(a,b);case "addslide":return new vj(a,b);case "organize":return new en(a,b);default:ya.a.J(508371530,817,10,`CopilotTelemetryFactory:createTracker Invalid scenarioName type: ${c}`)}return null}
function w(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.aTe)||void 0===l?void 0:l.forEach(u=>{u&&c.add(u)})});return Array.from(c).map(f=>b.Ie(Ua.a.Tf(f))).filter(f=>null!==f&&void 0!==f)}function D(a,b){return b&&b.TableNode?new rH(b):new sH(a)}function y(a,b){jo.set(a,b)}d.r(V);var m=d(0),C=d(68),E=d(55),F=d(96),B=d(194),H=d(183),K=d(122),A=d(25),W=d(1135),N=d(36),P=d(163),U=d(39);class Q{constructor(a){this.value=a}}Object(m.a)(Q,"RefTriState",
null,[]);var G=d(34);class Y{l2e(){this.yij();this.S5j();this.tuk();this.hFk();U.a.instance.ga(70)&&this.Pml();this.eMl();U.a.instance.ga(71)&&this.MSb();this.T7l();this.L8l();this.c9i();this.buk();this.XHl();this.e4l();this.P9l();U.a.instance.ga(79)&&(E.a.Fl||this.b8j(),this.Xwk(),this.F0k(),this.Afm())}yij(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);a.bindAction(B.KeyInputManager.Va(H.a.Mp,0),G.a.enter);a.bindAction(B.KeyInputManager.Va(H.a.Mp,4),G.a.myc)}S5j(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);
K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Hyperlink),G.a.insertHyperlink)}b8j(){const a=F.FocusManager.instance().Kc(K.AFrame.Nj);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.eja,5),G.a.lC);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Rca,5),G.a.My)}buk(){if(!E.a.vy){const a=F.FocusManager.instance().Kc(K.AFrame.Nj);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.XCc,B.KeyInputManager.Ze),G.a.vHg,Y.Zmb("faOpen"))}}tuk(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);U.a.instance.ga(54)&&K.AFrame.Yk(a,
B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_CenterJustify),G.a.centerJustify,Y.cL);E.a.Fl?(K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),G.a.leftJustify,Y.cL),K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),G.a.rightJustify,Y.cL)):(K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_LeftJustify),G.a.leftJustify,Y.cL),K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_RightJustify),G.a.rightJustify,Y.cL));U.a.instance.ga(54)&&
K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.RGd,B.KeyInputManager.Ze),G.a.fullJustify,Y.cL)}Xwk(){var a=F.FocusManager.instance();const b=a.Kc(K.AFrame.Nj);a=a.Kc(P.AppFrame.QX);K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.ZOa,B.KeyInputManager.Ze),G.a.qL,Y.C5f);K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.Gif,B.KeyInputManager.Ze),G.a.aO,Y.C5f);E.a.kFb&&a.bindAction(B.KeyInputManager.Va(H.a.WCc,4|B.KeyInputManager.Ze),G.a.qL)}hFk(){const a=F.FocusManager.instance().Kc(K.AFrame.Nj);K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_TellMe),
N.a.kAc,Y.cL)}F0k(){if(U.a.instance.ga(27)||U.a.instance.ga(58)){const a=F.FocusManager.instance().Kc(K.AFrame.Nj),b=U.a.instance.ga(58)?G.a.nKl:G.a.save;K.AFrame.Yk(a,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Save),b);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Vmf,0),G.a.sync)}}Pml(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasIsEnabled")&&A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")||K.AFrame.Yk(a,
B.KeyInputManager.Va(H.a.TCc,1),G.a.ynd);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.TCc,0),G.a.ynd)}eMl(){this.rKh(P.AppFrame.QX);this.rKh(P.AppFrame.B1e)}rKh(a){var b=F.FocusManager.instance(),c=H.a.Rca,f=H.a.eja;a=b.Kc(a);const l=b.Kc(A.AFrameworkApplication.wlb);a.bindAction(B.KeyInputManager.Va(c,0),G.a.leftArrow);a.bindAction(B.KeyInputManager.Va(f,0),G.a.rightArrow);a.bindAction(B.KeyInputManager.Va(H.a.J3,0),G.a.upArrow);a.bindAction(B.KeyInputManager.Va(H.a.o8,0),G.a.downArrow);a.bindAction(B.KeyInputManager.Va(f,
4),G.a.K3a);a.bindAction(B.KeyInputManager.Va(c,4),G.a.J3a);E.a.Fl?(a.bindAction(B.KeyInputManager.Va(f,1),G.a.eFa),a.bindAction(B.KeyInputManager.Va(c,1),G.a.dFa),a.bindAction(B.KeyInputManager.Va(f,5),G.a.aUa),a.bindAction(B.KeyInputManager.Va(c,5),G.a.$Ta),a.bindAction(B.KeyInputManager.Va(f,8),G.a.T0a),a.bindAction(B.KeyInputManager.Va(c,8),G.a.U0a),a.bindAction(B.KeyInputManager.Va(f,12),G.a.WUa),a.bindAction(B.KeyInputManager.Va(c,12),G.a.XUa)):(a.bindAction(B.KeyInputManager.Va(f,B.KeyInputManager.Ze),
G.a.eFa),a.bindAction(B.KeyInputManager.Va(c,B.KeyInputManager.Ze),G.a.dFa),a.bindAction(B.KeyInputManager.Va(f,B.KeyInputManager.Ze|4),G.a.aUa),a.bindAction(B.KeyInputManager.Va(c,B.KeyInputManager.Ze|4),G.a.$Ta));a.bindAction(B.KeyInputManager.Va(H.a.J3,4),G.a.KRb);a.bindAction(B.KeyInputManager.Va(H.a.o8,4),G.a.kob);a.bindAction(B.KeyInputManager.Va(H.a.J3,B.KeyInputManager.Ze),G.a.j7b);a.bindAction(B.KeyInputManager.Va(H.a.o8,B.KeyInputManager.Ze),G.a.wyb);a.bindAction(B.KeyInputManager.Va(H.a.J3,
B.KeyInputManager.Ze|4),G.a.oab);a.bindAction(B.KeyInputManager.Va(H.a.o8,B.KeyInputManager.Ze|4),G.a.ZTa);a.bindAction(B.KeyInputManager.Va(H.a.lJ,0),G.a.U0a);a.bindAction(B.KeyInputManager.Va(H.a.lJ,4),G.a.XUa);if(U.a.instance.ga(41))a.bindAction(B.KeyInputManager.Va(H.a.lJ,B.KeyInputManager.Ze),G.a.Rmd),a.bindAction(B.KeyInputManager.Va(H.a.Pz,B.KeyInputManager.Ze),G.a.NRe);else if(U.a.instance.ga(17)||U.a.instance.ga(77))a.bindAction(B.KeyInputManager.Va(H.a.lJ,B.KeyInputManager.Ze),G.a.dkb),
a.bindAction(B.KeyInputManager.Va(H.a.Pz,B.KeyInputManager.Ze),G.a.ckb);a.bindAction(B.KeyInputManager.Va(H.a.lJ,B.KeyInputManager.Ze|4),G.a.jbb);a.bindAction(B.KeyInputManager.Va(H.a.Pz,0),G.a.T0a);a.bindAction(B.KeyInputManager.Va(H.a.Pz,4),G.a.WUa);a.bindAction(B.KeyInputManager.Va(H.a.Pz,B.KeyInputManager.Ze|4),G.a.ibb);E.a.Fl&&(a.bindAction(B.KeyInputManager.Va(H.a.J3,2),G.a.U0a),a.bindAction(B.KeyInputManager.Va(H.a.J3,6),G.a.XUa),a.bindAction(B.KeyInputManager.Va(H.a.o8,2),G.a.T0a),a.bindAction(B.KeyInputManager.Va(H.a.o8,
6),G.a.WUa),a.bindAction(B.KeyInputManager.Va(H.a.lJ,1),G.a.dkb),a.bindAction(B.KeyInputManager.Va(H.a.Pz,1),G.a.ckb),U.a.instance.ga(6)&&(a.bindAction(B.KeyInputManager.Va(H.a.J3,5),G.a.oab),a.bindAction(B.KeyInputManager.Va(H.a.o8,5),G.a.ZTa)));c=B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,G.a.Jua);l.bindAction(c,N.a.uUa);U.a.instance.ga(79)&&(f=b.Kc(K.AFrame.vD),b=b.Kc(K.AFrame.Nj),f.bindAction(c,N.a.uEa),b.bindAction(B.KeyInputManager.Va(H.a.iPa,B.KeyInputManager.Ze|
4),G.a.mxd),U.a.instance.ga(41)&&E.a.Fl&&(a.bindAction(B.KeyInputManager.Va(H.a.gG,1),G.a.dkb),a.bindAction(B.KeyInputManager.Va(H.a.fG,1),G.a.ckb)),b.bindAction(B.KeyInputManager.Va(H.a.fG,0),G.a.pageDown),b.bindAction(B.KeyInputManager.Va(H.a.gG,0),G.a.pageUp),b.bindAction(B.KeyInputManager.Va(H.a.fG,4),G.a.nyc),b.bindAction(B.KeyInputManager.Va(H.a.gG,4),G.a.Xzd));U.a.instance.ga(6)&&(a.bindAction(B.KeyInputManager.Va(H.a.fG,B.KeyInputManager.Ze|4),N.a.uUa),a.bindAction(B.KeyInputManager.Va(H.a.gG,
B.KeyInputManager.Ze|4),N.a.uUa));E.a.Fk||a.bindAction(B.KeyInputManager.Va(H.a.YOa,0),G.a.sca);a.bindAction(B.KeyInputManager.Va(H.a.Jra,4),G.a.Wzd);a.bindAction(B.KeyInputManager.Va(H.a.Jra,4|B.KeyInputManager.Ze),G.a.Wzd)}MSb(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.PGd,B.KeyInputManager.Ze|1),G.a.E0d);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.QGd,B.KeyInputManager.Ze|1),G.a.F0d);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Pmf,B.KeyInputManager.Ze|1),
G.a.G0d);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Qmf,B.KeyInputManager.Ze|1),G.a.H0d);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Rmf,B.KeyInputManager.Ze|1),G.a.I0d);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Smf,B.KeyInputManager.Ze|1),G.a.J0d);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.r5a,B.KeyInputManager.Ze|4),G.a.D0d);U.a.instance.ga(61)&&F.FocusManager.instance().Kc(K.AFrame.Nj).bindAction(B.KeyInputManager.Va(H.a.SGd,B.KeyInputManager.Ze|4),G.a.ZEi)}T7l(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);
a.bindAction(B.KeyInputManager.Va(H.a.zs,0),G.a.tab);a.bindAction(B.KeyInputManager.Va(H.a.zs,4),G.a.oyc)}L8l(){if(U.a.instance.ga(30)){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Mp,B.KeyInputManager.Ze),G.a.Yva)}}P9l(){const a=F.FocusManager.instance(),b=a.Kc(P.AppFrame.QX);a.Kc(K.AFrame.vD);K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Bold),G.a.bold,Y.cL);K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Italic),G.a.setItalic,
Y.cL);K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Underline),G.a.underline,Y.cL);E.a.Fl&&(K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Bold_Mac),G.a.bold,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Italic_Mac),G.a.setItalic,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Underline_Mac),G.a.underline,Y.cL));K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_ClearFormatting),G.a.clearFormatting);U.a.instance.ga(54)&&
K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.Eqb,B.KeyInputManager.Ze|4),G.a.clearFormatting);K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.Bqb,B.KeyInputManager.Ze|1),G.a.fT,Y.Zmb("00FFFF"));if(U.a.instance.ga(94)||U.a.instance.ga(96))K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.ZOa,B.KeyInputManager.Ze|4),G.a.OG,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.rCc,B.KeyInputManager.Ze),G.a.OG,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.JFd,B.KeyInputManager.Ze|4),G.a.rH,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.pCc,
B.KeyInputManager.Ze),G.a.rH,Y.cL);A.AFrameworkApplication.fa.getBooleanAppSetting("PPTOToggleCaseByShiftF3Enabled")&&K.AFrame.Yk(b,B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_ToggleCase),G.a.mDd);A.AFrameworkApplication.fa.getBooleanAppSetting("SubSuperscriptShortcutEnabled")&&(K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.LFd,B.KeyInputManager.Ze|4),G.a.superscript,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.OFd,B.KeyInputManager.Ze|4),G.a.superscript,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.MFd,
B.KeyInputManager.Ze|4),G.a.subscript,Y.cL),K.AFrame.Yk(b,B.KeyInputManager.Va(H.a.qCc,B.KeyInputManager.Ze|4),G.a.subscript,Y.cL))}Afm(){const a=F.FocusManager.instance().Kc(K.AFrame.vD),b=F.FocusManager.instance().Kc(P.AppFrame.QX);var c=B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,N.a.uEa);b.bindAction(c,G.a.undo);c=B.KeyInputManager.Va(H.a.eG,1);a.bindAction(c,N.a.uEa);E.a.Fl||b.bindAction(c,G.a.undo);c=B.KeyInputManager.vx(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,
N.a.uEa);b.bindAction(c,G.a.redo);c=B.KeyInputManager.Va(H.a.eG,5);a.bindAction(c,N.a.uEa);E.a.Fl||b.bindAction(c,G.a.redo)}e4l(){const a=F.FocusManager.instance().Kc(P.AppFrame.QX);U.a.instance.ga(54)?(E.a.Fl?this.Jta(a,B.KeyInputManager.Va(H.a.QGd,5),"\u20ac"):this.Jta(a,B.KeyInputManager.Va(H.a.zqb,B.KeyInputManager.Ze|1),"\u20ac"),this.Jta(a,B.KeyInputManager.Va(H.a.Ira,B.KeyInputManager.Ze|1),"\u00a9"),this.Jta(a,B.KeyInputManager.Va(H.a.nVb,B.KeyInputManager.Ze|1),"\u00ae"),this.Jta(a,B.KeyInputManager.Va(H.a.oVb,
B.KeyInputManager.Ze|1),"\u2122"),this.Jta(a,B.KeyInputManager.Va(H.a.qCc,B.KeyInputManager.Ze|1),"\u2014"),this.Jta(a,B.KeyInputManager.Va(H.a.ZOa,B.KeyInputManager.Ze|1),"\u2026"),this.Jta(a,B.KeyInputManager.Va(H.a.Gif,B.KeyInputManager.Ze|5),"\u00bf"),this.Jta(a,B.KeyInputManager.Va(H.a.PGd,B.KeyInputManager.Ze|5),"\u00a1")):U.a.instance.ga(25)&&this.Jta(a,B.KeyInputManager.Va(H.a.zqb,B.KeyInputManager.Ze|1),"\u20ac")}Jta(a,b,c){K.AFrame.Yk(a,b,G.a.qXa,Y.Mbk("symbol_"+c))}c9i(){if(A.AFrameworkApplication.XF){var a=
F.FocusManager.instance().Kc(K.AFrame.Nj);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Tmf,B.KeyInputManager.Ze|1),N.a.w5);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Umf,B.KeyInputManager.Ze|1),N.a.w5)}}XHl(){const a=F.FocusManager.instance().Kc(K.AFrame.Nj);E.a.vy||K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Bqb,1),G.a.activateRibbonTab,Y.Zmb("tabHome"));K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.r5a,1),G.a.activateRibbonTab,Y.Zmb("tabInsert"));K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Cqb,1),G.a.activateRibbonTab,Y.Zmb("tabPageLayout"));
K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.nVb,1),G.a.activateRibbonTab,Y.Zmb("tabReview"));K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.Xmf,1),G.a.activateRibbonTab,Y.Zmb("tabView"))}static get instance(){return Y.Ja||(Y.Ja=new Y)}static C5f(){return new W.DictionaryPropertySet}static cL(){return new Q(2)}static Mbk(a){return()=>{const b={};b.SourceControlId=a;return b}}static Zmb(a){return()=>a}}Y.Ja=null;Object(m.a)(Y,"ShortcutRegistration",null,[]);class ba{get name(){return"Box4.Shortcuts"}fc(){}init(){Y.instance.l2e()}dispose(){}static main(){C.a.instance.Ac(new ba)}}
Object(m.a)(ba,"Box4ShortcutsPackage",null,[2,3]);var ha=d(306);class ka{Nu(a,b,c,f,l,u){return ha.a.Nu(a,b,void 0===c?!1:c,void 0===f?!1:f,void 0===l?!1:l,void 0===u?null:u)}eCc(a,b,c){return ha.a.eCc(a,b,c)}Dwb(a,b){return ha.a.Dwb(a,b)}AX(a,b,c,f,l,u){return ha.a.AX(a,b,c,f,void 0===l?!1:l,void 0===u?!1:u)}aTa(a,b){return ha.a.aTa(a,void 0===b?null:b)}Qfa(){ha.a.Qfa()}gab(a,b,c,f){return ha.a.gab(a,b,c,void 0===f?null:f)}MGa(a,b,c,f){return ha.a.MGa(a,b,void 0===c?!1:c,void 0===f?!0:f)}Sfc(a,b){return ha.a.Sfc(a,
b)}}Object(m.a)(ka,"TextMetricsAdapterProxy",null,[156]);var ca=d(317),ia=d(153);class oa{tPj(a){var b=a;for(a=null;!a&&b&&"P"!==b.tagName;)a=ca.a.Ie(b,ia.a.nTb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(oa,"TextMetricsHelper",null,[157]);class sa{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}fc(a){this.Da=a;this.Da.register(156,"Box4.ITextMetricsAdapter").ma().na(()=>new ka);this.Da.register(157,
"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new oa)}static main(){C.a.instance.Ac(new sa)}}Object(m.a)(sa,"Box4TextMetricsPackage",null,[2,3]);var Ca=d(346),Ta=d(254),R=d(7),Ha=d(100),da=d(395),Ba=d(736),za=d(99),Aa=d(46),na=d(1284),la=d(67),va=d(1280),Pa=d(576),Qa=d(104),Ua=d(318),Ya=d(819),Ea=d(276),La=d(18),xb=d(6);class dc{static yQl(a){const b=new Ba.a;for(const c of a)b.add(c);return b}static PCh(a,b){const c=new La.a;b=dc.yQl(b);for(const f of a)b.contains(f)||c.add(f);return c}static bzl(a,
b){return dc.PCh(xb.asEnumerable(a),b).toArray()}static czl(a,b){return dc.PCh(a,b)}}Object(m.a)(dc,"ExtendedGuidUtils",null,[]);var gb=d(1264),gc=d(19),Ac=d(167);class $b{}$b.CQi="ChangeInfo";Object(m.a)($b,"CatchUpActivityConstants",null,[]);class jc{}jc.LMb="\u00a0";jc.uRf="\ue200";jc.Pwg="\ue201";jc.jfj=32767;jc.DVc=3;jc.W$d=1;Object(m.a)(jc,"ContentEditableViewConstants",null,[]);var pb=d(559),$a=d(33),zc=d(369),rb=d(40),ib=d(42),Vb=d(90),Od=d(91),jb=d(53),Wb=d(87);class qb{constructor(a,b,c){this.Ra=
b;this.Pb=c}}Object(m.a)(qb,"ChangeInfo",null,[]);d(619);var Ga=d(839);class cb extends Sys.EventArgs{constructor(){super();this.Uab=null}}Object(m.a)(cb,"EditEventArgs",Sys.EventArgs,[]);class Ob extends cb{constructor(){super();this.ewk=0;this.dbm=this.wWc=this.kef=this.Iwk=this.F7j=this.szg=this.qeg=this.wmj=this.Bij=!1}}Object(m.a)(Ob,"ParagraphContentUpdatedEventArgs",cb,[]);class Db{constructor(a){this.a$c=a}}Object(m.a)(Db,"BlobPresenterArgs",null,[]);var mb=d(32);class Vc{}Vc.E5="TrackedChange";
Vc.YWh="TrackChangeTableRowInsertion";Vc.VWh="TrackChangeTableRowDeletion";Vc.KXh="TrackChangeTextInsertion";Vc.IXh="TrackChangeTextDeletion";Vc.g7j="TrackChangeImageModified";Vc.e7j="TrackChangeImageInsertion";Vc.a7j="TrackChangeImageDeletion";Vc.Uze="TrackChangeIndirectEffect";Object(m.a)(Vc,"TrackChangeConstants",null,[]);var Zb=d(937),fc=d(98);const ob=a=>!!a.eUa&&xb.AT(a.eUa,b=>3===b.type||2===b.type||4===b.type),ub=(a,b)=>{let c=!1,f=!1,l=null;if(b.eUa)for(const u of b.eUa)1===u.type&&(c=!0),
3===u.type&&(f=!0),4===u.type&&u.Qe&&u.Qe.paragraph&&(l=u);l&&Sys.UI.DomElement.addCssClass(a,fc.a.v8i);f&&Sys.UI.DomElement.addCssClass(a,fc.a.uvg);c&&Sys.UI.DomElement.addCssClass(a,fc.a.p8i)},bc=a=>{const b=[fc.a.oej,fc.a.pej,fc.a.nej];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var ic=d(364);class Rc{constructor(a){this.qXb=this.u1b=this.jqf=null;this.vj=a}get paragraphNode(){return this.vj}get eUa(){return this.jqf}get Qob(){return this.u1b}get $ab(){return this.qXb}get isEmpty(){return(!this.eUa||
!this.eUa.count)&&(!this.Qob||!this.Qob.count)&&(!this.$ab||!this.$ab.count)}v7k(){this.Qob&&(this.u1b=new La.a);this.$ab&&(this.qXb=new La.a)}wFd(a){this.eUa||(this.jqf=new ic.a);this.Qob||(this.u1b=new La.a);this.$ab||(this.qXb=new La.a);this.eUa.wFd(a,b=>{this.Qob.add(b)},b=>{this.$ab.add(b)})}}Object(m.a)(Rc,"IntentRenderingState",null,[]);class Fb{constructor(a,b){this.element=a;this.next=b}}Object(m.a)(Fb,"ElementStackNode",null,[]);class Qb{constructor(a){a=void 0===a?!1:a;this._history=new Sys.StringBuilder;
this.uCa=this.kw=null;this.V1b=a}lAk(a){if(this.V1b&&a){this._history.append("[Cp "+a.cp+":");if(a.vi)for(var b=0;b<a.vi.length;b++)this._history.append(a.vi.ga(b).yz+","+a.vi.ga(b).xha),b!==a.vi.length-1&&this._history.append("|");if(a.Zk)for(a.vi&&this._history.append("|"),b=0;b<a.Zk.length;b++)this._history.append(a.Zk.ga(b).cwa?"B":"I"),this._history.append(a.Zk.ga(b).il?"S":"E"),this._history.append(a.Zk.ga(b).DEb?"R":"F"),b!==a.Zk.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.kw){for(var a=
this.kw;a.next;)a=a.next;a.next=this.uCa;this.uCa=this.kw;this.kw=null;this.V1b&&this._history.append("Clear\n")}}peek(a){a=void 0===a?"":a;this.isEmpty()&&da.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.V1b&&this._history.append(String.format("Peek Label: {0}\n",a));return this.kw.element}pop(a){a=void 0===a?"":a;this.isEmpty()&&da.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",
a,this._history.toString());const b=this.kw.element;this.kw.element=null;const c=this.kw.next;this.kw.next=this.uCa;this.uCa=this.kw;this.kw=c;this.V1b&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b){b=void 0===b?"":b;if(this.uCa){const c=this.uCa.next;this.uCa.next=this.kw;this.kw=this.uCa;this.uCa=c;this.kw.element=a}else this.kw=new Fb(a,this.kw);this.V1b&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",
b))}isEmpty(){return!this.kw}}Object(m.a)(Qb,"ElementStack",null,[]);class hc{constructor(){this.Kfc=!1;this.span=null}}Object(m.a)(hc,"IntelligentPlaceholderRenderingState",null,[]);class Pc{constructor(a,b,c){this.eventName=a;this.Ec=b;this.handler=c}}Object(m.a)(Pc,"ParagraphContentRendererMouseEventRegistration",null,[]);var uc=d(75);class zb extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.jPb=c}}Object(m.a)(zb,"ParagraphContentRendererEventArgs",Sys.EventArgs,
[]);class ac extends zb{constructor(a,b,c,f,l){super(a,b,c);this.u1b=f.Qob;this.qXb=f.$ab;this.zdi=l}get Qob(){return this.u1b}get $ab(){return this.qXb}get elementType(){return this.zdi}}Object(m.a)(ac,"IntentRangeRenderedEventArgs",zb,[]);class Jb extends zb{constructor(a,b,c,f){super(a,b,c);this.Bq=f}}Object(m.a)(Jb,"SpellingErrorRenderedEventArgs",zb,[]);class Yc{constructor(){this.Ma=new uc.a}dispose(){this.Ma&&(this.Ma.dispose(),this.Ma=null)}Drl(a,b,c,f){this.Ma&&this.Ma.raiseEvent(Yc.s$k,
new Jb(a,b,c,f))}izh(a,b,c,f,l){this.Ma&&this.Ma.raiseEvent(Yc.w6k,new ac(a,b,c,f,l))}}Yc.s$k="OnSpellingErrorRangeRendered";Yc.w6k="OnIntentRangeRendered";Object(m.a)(Yc,"ParagraphRenderEvents",null,[106]);class dd{constructor(){this.xWf=null;this.Mug=!1;this.Rhh=this.OIf=null}}Object(m.a)(dd,"RenderParagraphContentResults",null,[]);var id=d(152),Cc=d(71),Nb=d(216);class nc{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc){this.ACa=this.sPd=this.tOd=this.Itb=null;this.$f=a;this.SQ=b;this.zd=c;
this.nsa=f;this.sO=l;this.jw=I;this.k8a=T;this.SQa=ja;this.ici=Ra;this.aX=eb;this.fmi=Bb;this.Pei=Ub;this.Jai=tc;this.BHf=new Ba.a;this.$Lc=Xb;this.Qsb=!!ua&&ua.AHa(65);this.iMc=this.mGc=null;this.zQa=u;this.dhi=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("MinimizeIntelligentPlaceholderWorkIsEnabled");this.kd=ua}get OTf(){return!0}get RCg(){null==this.tOd&&(this.tOd=!!this.kd&&this.kd.isFeatureEnabled(85));return this.tOd}get fHg(){null==this.sPd&&(this.sPd=!!this.kd&&
this.kd.isFeatureEnabled(77));return this.sPd}get jP(){null==this.ACa&&(this.ACa=!!this.kd&&this.kd.isFeatureEnabled(79));return this.ACa}vDl(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.mGc={};this.iMc=new id.a;const yd=$a.ParagraphReader.text(a),Pd=new La.a;var pe=!1;A.AFrameworkApplication.fa&&(pe=A.AFrameworkApplication.fa.getBooleanAppSetting("ElementStackTrackHistoryIsEnabled"));const Se=new Qb(pe);Se.push(c,"RenderParagraphContentStart");let vf=null,ug=null,Tg=null,$f=null,Ve=pe=
null;const xg=new Ob;var yg=!1;let ng=!1,Wh=!1,Ai=!1,Wf=0,gg=null,vh=null;const Zj=new La.a;this.$Lc&&this.$Lc.mvm(a,c);const qj=this.SQa.dY(a);this.SQa.DEi(c,a,b,qj,b.Xd);if(this.k8a.wy&&b.Nm){var Ok=this.$f.$d;Ok&&1===Ok.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}Ok=!a.nY;let Wl=!1,Rm=!1,Pk=!1,Xl=!1,wk=0,Qk=!1,qk=!1,Hl=null,Qh=0;const Il=new hc,ym=Array(a.Sa.length+1);let on=this.RCg?new La.a:null,ml=null,nl=null;for(;Wf<a.Sa.length;){const De=a.Sa.ga(Wf);var Bi=void 0,zg=void 0,
ci=!1;Se.lAk(De);({xSc:Bi,tSc:zg}=nc.xhg(De));this.RCg&&(!this.dhi||Bi.length||zg.length)&&({xSc:Bi,tSc:zg,M8i:on,xkk:ci}=nc.xhm(De.paragraph.Zh,Bi,zg,on),Il.Kfc=0<on.count);Xl=0<Bi.length||Xl;ym[Wf]=c.childNodes.length;if(0<De.cp&&De.Bk)break;let nh=De.cp;const Zi=Wf<a.Sa.length-1?a.Sa.ga(Wf+1).cp:$a.ParagraphReader.textLength(a);Wf++;var Oh=!1;0<nh&&Se.pop("CurrentCpLargerThanZero");De.VM&&(vf=null);De.tw&&(nl=De.tw);De.isDictationCorrectionEnd&&(nl=null);De.g_&&(ug=null);De.O5&&(Tg=null);De.mna&&
($f=null);var Yd=void 0,tf=void 0;this.jP?(Yd=De.aga,tf=De.k1):(Yd=!!De.Ap,tf=!!De.fieldRangeEnd);if(!yg||De.blob||De.formatting||De.hyperlink||De.eo||De.Q5||tf||Yd||this.Qsb&&(De.isTrackChangeInfoEnd||De.pP)||De.zx&&!De.zx.isEmpty)Oh=!0,0<nh&&yg&&Se.pop("InFormattingSpan");tf&&(Se.pop("HasFieldEnd"),yg=!1);De.eo&&(Wl||(Wh=!0),Rm=Wl=!1);De.hyperlink&&(Wl&&(Wh=!0),Wl=!0,Rm=De.hyperlink.awa);De.eo&&!Wh&&(Se.pop("IsHyperlinkEnd"),yg=!1);this.kd&&this.kd.isFeatureEnabled(17)&&(De.isChangeEnd&&(Qk||da.ULS.sendTraceTag(36282713,
324,15,"Found catch up change end with out change start!"),Qk=!1,vh=null),De.changeStart&&(Qk&&da.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),vh=De,Qk=!De.Bk));if(this.Qsb&&(De.isTrackChangeInfoEnd&&(Pk||(Ai=!0),Pk=!1,gg=null),De.pP&&(Pk&&(Ai=!0),gg=De,Pk=!De.Bk),De.isTrackChangeInfoEnd&&!Ai)){for(yg=0;yg<wk;yg++)Se.pop("IsTrackChangeInfoEnd");wk=0;yg=!1}ml&&ml.v7k();De.zx&&(ml||(ml=new Rc(a)),ml.wFd(De.zx));if(De.Q5&&!De.Bk){pe=pe||De.formatting;tf=this.f1f(Se.peek("CreateIpFormattingSpan"),
pe,qj,b,a,Ra,ja,gg);tf=za.a.zcb(tf);for(const rj of tf)eb=nc.Lka(l,eb,rj);xg.szg=!0}De.hyperlink&&!Wh&&({oIa:eb,Rfj:qk,returnValue:Ve}=this.oDl(Ve,De,Se,qj,xg,b,a,f,l,u,I,ja,gg,eb,Ra,Ok,yg,qk));!this.Qsb||Ai||De.Bk||(De.iq&&(this.U3e(De.iq,Se,xg,b,ja),wk++),De.vp&&(this.U3e(De.vp,Se,xg,b,ja),wk++),De.Wt&&(this.U3e(De.Wt,Se,xg,b,ja),wk++));Yd&&({cUa:pe,oIa:eb,returnValue:Ve}=this.kDl(Ve,l,a,De,pe,Se,qj,xg,b,ja,Ra,eb,yg,Ok,gg));this.fHg&&this.LVf(a,b,lc&&tc);De.blob?({oIa:eb,Hwk:Hl,Gwk:Qh,returnValue:ng}=
this.cDl(eb,yg,pe,De,u,I,Ok,Ve,Se,qj,xg,nh,ng,tc,b,Zj,lc,a,Ra,l,Bb,Ub,T,ja,Pd,gg,vh,Bi,zg,Hl,Qh,ml),yg=!1,pe=Ve=null):(Yd=De.Q5&&!Aa.a.substring(yd,nh,Zi).length,Oh&&(Oh=Ve,{cUa:pe,returnValue:Ve}=this.mDl(pe,De,qj,Se,xg,b,a,ja,gg,Ra,Yd),yg=!0,Ve&&Ve.style&&(qk&&Oh&&Oh.style&&(Oh.style.fontSize=Ve.style.fontSize,Oh.style.lineHeight=Ve.style.lineHeight),Hl&&Hl.style&&0<Qh&&De.formatting&&De.formatting.cache.Iva&&Qh>De.formatting.cache.fontSize&&(Hl.style.fontSize=Ve.style.fontSize,Hl.style.lineHeight=
Ve.style.lineHeight))),qk=!1,Hl=null,Qh=0,Yd||(De.Bq&&(vf=De.Bq),De.FG&&(Tg=De.FG),De.WM&&($f=De.WM),De.Sx&&(ug=De.Sx),Oh=Aa.a.substring(yd,nh,Zi),ci=this.A8d(Se.peek("CreateTextOverlaySpan1"),pe,a,vf,Tg,$f,ug,b,Zj,ja,Oh,lc&&(Bb<=nh&&nh<Ub||a.nY),hd,Il,ci,ml,!!nl,Rm),Se.push(ci,"TextOverlaySpan1"),xg.kef=!0,this.NYd(Se.peek("AddCommentHintCssAndDataToElement"),Bi,zg),this.sO&&this.sO.xDb&&vf&&vf.Rh&&(Bi=Object(gb.a)(419,vf.Rh))&&Bi.KO&&Bi.KO.TraceId&&5===Bi.proofingType&&!Bi.aHa&&(this.Ryl(Se.peek("RemoveConsistencyCheckCustomData")),
zg=this.oxj(De.Bq,a,Wf),ca.a.Uw(Se.peek("errorDetails"),zg,Bi.KO.TraceId)),this.w7e(vh,Se.peek("SetChangeId"),De.cp,Zi),lc&&Bb!==Ub&&({oIa:eb,returnValue:nh}=this.gml(ci,Se,pe,a,vf,Tg,$f,ug,xg,b,l,Zj,ja,yd,Bb,Ub,eb,nh,Zi,hd,Il,ml,!!nl,Rm)),za.a.yA(Se.peek("SetElementText"),Aa.a.substring(yd,nh,Zi)),eb=nc.Lka(l,eb,Se.peek("AddLeafNodeElement"))))}if(a.B3c!==Xl||this.Qsb||this.k8a.DCc)a.B3c=Xl,(f=jb.OutlineElementNavigator.qC(a))&&f.E$(b.Na,32,!0);({a$c:Ve,oIa:eb,returnValue:yg}=this.qDl(a,c,pe,qj,
xg,Ve,b,a,l,ja,gg,Ra,eb,yg,Ok));!Il.Kfc&&Il.span&&this.s0d(null,Il.span);Ok&&this.jDl(c,Ve,xg,b,a,l,ja,ua,eb,Xb,vh);ym[ym.length-1]=c.children.length;this.vim(ng,Ec,b);this.sjm(xg,yg,l);this.KMh(b,a,c);let Of;return Of=new dd,Of.xWf=Pd,Of.Mug=ng,Of.OIf=ym,Of.Rhh=Zj,Of}jPb(a,b,c,f){this.SQ.xb(a,b,c,f);return new Pc(a,b,c)}oxj(a,b,c){let f=0;a&&a.Rh&&(f|=16);if(c<b.Sa.length&&b.Sa.ga(c).VM||c===b.Sa.length)f|=1;switch(f){case 0:return Zb.a.wSe;case 16:return Zb.a.p$c;case 1:return Zb.a.Awd;case 17:return Zb.a.dQc}return""}Ryl(a){ca.a.uqa(a,
Zb.a.wSe);ca.a.uqa(a,Zb.a.p$c);ca.a.uqa(a,Zb.a.Awd);ca.a.uqa(a,Zb.a.dQc)}w7e(a,b,c,f){this.kd&&this.kd.isFeatureEnabled(17)&&a&&a.changeStart&&ca.a.Uw(b,$b.CQi,new qb(a.changeStart.id,c,f))}oDl(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){!tc||lc||b.Q5||(a=this.L6b(c.peek("CreateFormattingSpan1"),null,f,u,I,eb,Xb,Bb),a.className+=" EmptyTextRun",Ub=nc.Lka(ja,Ub,a),Ec=l.wWc=!0);b=this.l4i(c.peek("CreateLinkAnchor"),b.hyperlink,u,T,ua,Ra,eb);c.push(b,"RenderHyperlink");l.Iwk=!0;return{returnValue:a,
oIa:Ub,Rfj:Ec}}U3e(a,b,c,f,l){a=this.O7i(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.dbm=!0}kDl(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){Bb||f.Q5||(l=f.formatting||l,Ub?(a=this.L6b(u.peek("CreateFormattingSpan2"),l,I,ja,c,ua,Ra,Xb),a.appendChild(ja.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",eb=nc.Lka(b,eb,a),T.wWc=!0):(a=this.hUc(l,I,ja,c,Ra,Xb),T.qeg=!0));b=this.j3i(u.peek("CreateFieldRangeSpan1"),ja,ua,c);u.push(b,"RenderFieldRange");T.wmj=!0;return{returnValue:a,
cUa:l,oIa:eb}}cDl(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg,yg,ng,Wh){b||(c=f.formatting||c,I&&!f.Q5?(T=this.L6b(ja.peek("CreateFormattingSpan4"),c,ua,Xb,Ec,vf,hd,Tg),T.appendChild(Xb.ownerDocument.createTextNode("")),T.className+=" EmptyTextRun",a=nc.Lka(yd,a,T),Ra.wWc=!0):T=this.hUc(c,ua,Xb,Ec,hd,Tg));1===f.blob.kr&&(Bb=!0);b=f.blob.LIj(Xb);b.lfg(new Db(T));T=b.element;Sys.UI.DomElement.containsCssClass(T,fc.a.chc)&&(yg=T,c&&c.cache.Iva&&(ng=c.cache.fontSize));
Sys.UI.DomElement.addCssClass(T,fc.a.AO);this.k8a.vej&&5!==f.blob.kr&&Sys.UI.DomElement.addCssClass(T,fc.a.rej);this.Qsb&&this.pDl(f,Xb,T,Tg);this.NYd(T,Ve,xg);Wh&&!Wh.isEmpty?(ub(T,Wh),this.Itb&&this.Itb.izh(T,Ec,(Ai,Wf,gg,vh)=>{tc.add(this.jPb(Ai,Wf,gg,vh))},Wh,1)):bc(T);this.w7e($f,T,f.cp,f.cp+1);ja.peek("blobElt").appendChild(T);Se(T,!0);ug.add(f.blob);lc&&(Pd<=eb&&eb+1<=pe||Ec.nY)?(Ub&&(Sys.UI.DomElement.containsCssClass(T,fc.a.S8d)||Sys.UI.DomElement.addCssClass(T,fc.a.S8d),A.AFrameworkApplication.fa&&
A.AFrameworkApplication.fa.getBooleanAppSetting("TouchImageGrippiesResizedIsEnabled")&&this.$f&&this.$f.$d&&Object(gc.a)(pb.PageView,this.$f.$d)&&(c=this.$f.$d,eb=A.AFrameworkApplication.Pa,c&&3===c.bIg?eb.Ia(G.a.TYh,2,T):eb.Ia(G.a.UYh,2,T))),Sys.UI.DomElement.addCssClass(T,fc.a.M9)):(Sys.UI.DomElement.removeCssClass(T,fc.a.S8d),Sys.UI.DomElement.removeCssClass(T,fc.a.M9));this.fHg||this.LVf(Ec,Xb,lc&&Ub);Sys.UI.DomElement.removeCssClass(T,fc.a.r8i);this.kd&&this.kd.isFeatureEnabled(162)&&5===f.blob.kr&&
(f=f.blob,f.properties&&f.properties.Qa(rb.a.gdc)&&(f=f.properties.$a(rb.a.gdc))&&""!==f&&(tc.add(this.jPb(la.a.uha,T,l,f)),tc.add(this.jPb(la.a.uha,T,u,f))));a=nc.Lka(yd,a,T);ja.push(T,"RenderBlob");return{returnValue:Bb,oIa:a,Hwk:yg,Gwk:ng}}NYd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,fc.a.wSc),ca.a.Uw(a,fc.a.T5d,b)):Sys.UI.DomElement.removeCssClass(a,fc.a.wSc);c.length&&ca.a.Uw(a,fc.a.P5d,c)}LVf(a,b,c){a=mb.GraphIterator.ob(a);a.wf();a.Ug(11);if(b=a.currentNode.sc(b.Na))b.htmlElement.style.zIndex=
c?"1":""}pDl(a,b,c,f){let l=za.a.cwj(c,nc.YYh);5===a.blob.kr&&f?(l||(l=b.Tp(va.a.span),l.id=nc.YYh,Sys.UI.DomElement.addCssClass(l,Vc.g7j),Sys.UI.DomElement.addCssClass(l,Vc.E5),c.appendChild(l)),this.zfg(b,l,f.iq,Vc.a7j),this.zfg(b,l,f.vp,Vc.e7j)):l&&c.removeChild(l)}zfg(a,b,c,f){c&&!za.a.U$b(b,f)&&(a=a.Tp(va.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}mDl(a,b,c,f,l,u,I,T,ja,ua,Ra){a=b.formatting||a;b=Ra?this.hUc(a,c,u,I,ua,ja):this.L6b(f.peek("CreateFormattingSpan5"),
a,c,u,I,T,ua,ja);f.push(b,"RenderFormattingSpan");l.qeg=!0;return{returnValue:b,cUa:a}}gml(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf){Ec<Xb&&Xb<hd&&(Ec=Aa.a.substring(Ub,Ec,Xb),za.a.yA(a,Ec),lc=nc.Lka(Ra,lc,a),b.pop("ProcessSelectionBegins"),a=this.A8d(b.peek("CreateTextOverlaySpan2"),c,f,l,u,I,T,ua,eb,Bb,Ec,!0,yd,Pd,!1,pe,Se,vf),b.push(a,"TextOverlaySpan2"),Ec=Xb,ja.kef=!0);Ec<tc&&tc<hd&&(Ub=Aa.a.substring(Ub,Ec,tc),za.a.yA(a,Ub),lc=nc.Lka(Ra,lc,a),b.pop("ProcessSelectionEnds"),
a=this.A8d(b.peek("CreateTextOverlaySpan3"),c,f,l,u,I,T,ua,eb,Bb,Ub,!1,yd,Pd,!1,pe,Se,vf),b.push(a,"TextOverlaySpan3"),Ec=tc,ja.kef=!0);return{returnValue:Ec,oIa:lc}}qDl(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){if(0<a.Sa.length){const lc=a.Sa.last;var tc=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("TextRunForHyperlinkInTableCellEnabled");a=mb.GraphIterator.ob(a);!lc.eo||tc&&a.uc(16)||(Ub=!1,c=null);if(this.jP?lc.k1:lc.fieldRangeEnd)Ub=!1,c=null;tc=u;if(lc.Q5){c||(c=
lc.formatting);u=this.f1f(b,c,f,I,T,eb,ua,Ra);b=za.a.zcb(u);for(const Ec of b)Bb=nc.Lka(ja,Bb,Ec);l.szg=!0}else!Ub&&Xb&&(c||(c=lc.formatting),u=this.L6b(b,c,f,I,T,ua,eb,Ra),u.appendChild(I.ownerDocument.createTextNode("")),u.className+=" EmptyTextRun",Object(Nb.a)("UpdateStyleForEmptyTextRunSpan")&&u&&u.style&&tc&&tc.style&&(u.style.lineHeight!=tc.style.lineHeight&&(da.ULS.sendTraceTag(508876387,324,50,"Update lineHeight for empty text run span"),u.style.lineHeight=tc.style.lineHeight),u.style.fontSize!=
tc.style.fontSize&&(u.style.fontSize=tc.style.fontSize)),Bb=nc.Lka(ja,Bb,u),l.wWc=!0)}else da.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:Ub,a$c:u,oIa:Bb}}jDl(a,b,c,f,l,u,I,T,ja,ua,Ra){let eb;eb=nc.uvj(a,ua);b=this.O0f(b,f,T,eb);Pa.a.instance.shipAssertTag(25519712,8,0<l.Sa.length,"Chps should never be empty");T=null;l.Sa&&0<l.Sa.length&&(T=l.Sa.last);this.Qsb&&T&&(T.iq||T.vp||T.Wt)&&(b.className+=" "+Vc.E5);const {xSc:Bb,tSc:Ub}=nc.xhg(T);this.NYd(b,
Bb,Ub);this.w7e(Ra,b,T?T.cp:0,-1);ua&&(b.className+=" "+zc.a.J9d);this.KMh(f,l,b);a.appendChild(b);I(b);nc.Lka(u,ja,b);c.Bij=!0}KMh(a,b,c){if(a.Nm&&this.nsa.krd&&this.nsa.TYl(c)){if((a=this.nsa.wva(b))&&0<Qa.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){da.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.nsa.xPj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}O7i(a,b,c,f){c=
c.Tp(va.a.span);switch(b.changeType){case 2:c.className=Vc.IXh+" "+Vc.E5;c.style.color="#000";break;case 1:c.className=Vc.KXh+" "+Vc.E5;c.style.color="#000";break;case 3:c.className=Vc.E5}a.appendChild(c);f(c);return c}vim(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}sjm(a,b,c){a.ewk=c.count;a.F7j=b;this.fmi(a)}l4i(a,b,c,f,l,u,I){c=c.Tp(va.a.a);c.className=fc.a.gwg;b.awa&&b.uyc&&!U.a.instance.ga(61)&&(b.url.endsWith(A.AFrameworkApplication.fa.Ea("UserPrincipalName"))?c.className+=" "+fc.a.x8i:c.className+=
" "+fc.a.y8i);this.jw.SQh()&&(c.style["pointer-events"]="all");this.jw.oQh(this.k8a.Qlm,!0)&&this.Dzl(c);this.SQ.xb(la.a.uha,c,l,b.url);this.SQ.xb(la.a.vha,c,u);f.add(c);b.url&&Aa.a.O$(b.url)&&!E.a.Aj&&(Ac.d(c,na.a.href,b.url),Ac.d(c,na.a.target,"_blank"),Ac.d(c,na.a.rel,"noreferrer"));a.appendChild(c);I(c);return c}Dzl(a){a.style.textDecoration="none";a.style.color="inherit"}L6b(a,b,c,f,l,u,I,T){b=this.hUc(b,c,f,l,I,T);a.appendChild(b);u(b);return b}hUc(a,b,c,f,l,u){if(this.OTf){var I=a?a.en.toString():
Ua.a.nil.toString();if(I in this.mGc)a=this.mGc[I];else{const T=a?a.cache:Ga.FormattingCacheManager.$bb(f,Ua.a.nil);a=this.w7d(a,T,b,c,f,l);this.mGc[I]=a}b=a.cloneNode();ca.a.fTc(a,b)}else I=a?a.cache:Ga.FormattingCacheManager.$bb(f,Ua.a.nil),b=this.w7d(a,I,b,c,f,l);this.hPf(b,u);return b}w7d(a,b,c,f,l,u){const I=f.Tp(va.a.span);b=this.jw.dig(f,b,l)||b;this.kEi(f,I,b,l);this.pEi(I,b,l,f,u);this.BEi(I,a);this.SQa.EEi(I,l,c,f.Xd,b.fontSize,b.tM);return I}kEi(a,b,c,f){a=this.jw.aig(a,f,c);for(const l of a.keys)b.setAttribute(l,
a.ga(l))}f1f(a,b,c,f,l,u,I,T){var ja=b?b.cache:Ga.FormattingCacheManager.$bb(l,Ua.a.nil);ja=this.Jai(ja,l);b=this.w7d(b,ja,c,f,l,u);this.hPf(b,T);ja.isSuperscript||ja.nF?(f=f.Tp(va.a.span),this.dPf(f,ja,!0),b.appendChild(f),za.a.yA(f,""),I(f)):za.a.yA(b,"");a.appendChild(b);I(b);return b}pEi(a,b,c,f,l){var u=b.ou;const I=[];Array.add(I,fc.a.tOa);var T=this.jw.Khe(c,b,this.k8a.Rlm,u);var ja=null;b.zdb&&(ja=b.tQ,ja=ja===Vb.a.auto?"transparent":Vb.a.WH(ja));b.RWa&&(ja=b.highlight,ja=ja===Vb.a.auto?"transparent":
Vb.a.WH(ja));c.vjh!==Vb.a.nil&&(T=Vb.a.WH(c.vjh));l!==Vb.a.nil&&(ja=Vb.a.WH(l));za.a.EEa(a);b.pug&&(a.style.opacity=b.Vdg.toString());b.qeb&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);T?(a.style.color=T,Ac.d(a,na.a.m3f,"WindowText"===T?"auto":"none")):Ac.d(a,na.a.m3f,"auto");ja?(a.style.backgroundColor=ja,"transparent"!==ja&&Array.add(I,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.nF)l=Math.floor(l*this.jw.gle());T=this.jw.zjg(l,c,f.Xd);ja=this.jw.mac(b);
l=this.aX&&this.aX.lqj?this.aX.Gti(b.tM):this.ici(ja);this.k8a.Dve&&l&&Ca.FontUtils.LEb(ja)&&(l=this.jw.jPf(ja,l));let ua=b.LWa&&b.isBold;void 0===ua&&(ua=!1);let Ra=b.wdb&&b.isItalic;void 0===Ra&&(Ra=!1);l=this.jw.Axh(new Ya.a(ja,ua,Ra),l,c);!this.Mem(ja,b,a.style)&&b.LWa&&(b.isBold?(a.style.fontWeight="bold",E.a.Fl&&E.a.Fk&&Array.add(I,"MacChromeBold")):a.style.fontWeight="normal");b.wdb&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.xCb||u&&this.jw.qQh()||b.wCb||b.zcc)&&this.V3e(a,b,c,I);
T&&(a.style.fontSize=T);if(l&&(a.style.fontFamily=l,U.a.instance.ga(118))){Pa.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");u=l.split(",");for(l=0;l<u.length-1;l++)c.append('"'+u[l].trim()+'",');0<u.length&&c.append('"'+u[u.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.MWa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.jw.ahg(b,f.Xd))a.style.letterSpacing=
f;if(b=this.jw.Hkg(b))a.style.fontKerning=b,E.a.iV&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=I.join(" ")}Mem(a,b,c){return U.a.instance.ga(116)&&E.a.Fl&&E.a.Fk?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}hPf(a,b){this.zd.Gg&&b&&!b.Bk&&(b.iq||
b.vp)&&(a.style.color="#000")}BEi(a,b){if(b=b?this.Pei(b):0){const c=Ea.a.Oe(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.BHf.contains(b)||(da.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.BHf.add(b))}}V3e(a,b,c,f){c="";const l=b.VD,u=b.zC;b=b.qY;l&&(c="underline",f[f.length]="Underlined");if(u||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||u||b||(c="none");0<c.length&&(a.style.textDecoration=c)}dPf(a,b,c){b.isSuperscript&&
(a.style.verticalAlign="super",a.className+=" Superscript");b.nF&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.nF)&&Ac.d(a,na.a.o3f,(b.fontSize/2).toString())}A8d(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){const hd=b?b.cache:Ga.FormattingCacheManager.$bb(c,Ua.a.nil);Ra=!f||Bb||this.SUa(f,Ra)?0:f.Rh.proofingType;Bb=!!l;const yd=!!u,Pd=!!I;u=this.jw.KQh(hd,eb,l,u,I);if(Ub.Kfc||tc&&ob(tc))u=!1;this.OTf?(l=this.APj(hd,Ra,Bb,yd,
Pd,eb,u,lc),this.iMc.Ib(l)?eb=this.iMc.ga(l):(eb=this.p2f(T,hd,Ra,Bb,yd,Pd,eb,u,lc,f),this.iMc.$(l,eb)),T=eb.cloneNode(),ca.a.fTc(eb,T)):T=this.p2f(T,hd,Ra,Bb,yd,Pd,eb,u,lc,f);this.pCi(a,T,hd);this.I_d(a,T);this.VMf(T);this.UMf(a,T);Object(Nb.a)("FixUnderlineOnLineSpacingChange")&&hd.VD&&(this.XKf(T,"underline"),a.style.textDecoration="",hd.zC||hd.qY)&&(a.style.textDecoration="line-through");Object(Nb.a)("EnableSuperSubScriptStrikethroughFirefoxFix")&&E.a.jg&&(hd.isSuperscript||hd.nF)&&hd.zC&&(this.XKf(T,
"line-through"),a.style.textDecoration="");this.nsa.V0i&&this.qCi(T,b,c);this.Itb&&0!==Ra&&this.Itb.Drl(T,c,(pe,Se,vf,ug)=>{ja.add(this.jPb(pe,Se,vf,ug))},f);Ub.Kfc&&Xb&&Ub.span&&(this.s0d(null,Ub.span),Ub.span=null);if((b=Ub.Kfc?T:null)||Ub.span)this.s0d(b,Ub.span),Ub.span=b,Ub.span&&(b=(b=ca.a.Ie(a,ia.a.u$c))?b:-1,0<b&&(Ub.span.style.lineHeight=String.format("{0}px",b+3)));tc&&!tc.isEmpty&&(ub(T,tc),this.Itb&&this.Itb.izh(T,c,(pe,Se,vf,ug)=>{ja.add(this.jPb(pe,Se,vf,ug))},tc,0));Ec&&Sys.UI.DomElement.addCssClass(T,
fc.a.w8i);a.appendChild(T);ua(T);return T}SUa(a,b){b=a&&a.Rh&&a.Rh.token?a.Rh.token:b;return 0!==a.Rh.errorType&&!!this.zQa&&this.zQa.contains(b,a.Rh.lcid)}APj(a,b,c,f,l,u,I,T){b|=0;u&&(b|=16);I&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);T&&(b|=2048);a.isSuperscript&&(b|=512);a.nF&&(b|=1024);return b}p2f(a,b,c,f,l,u,I,T,ja,ua){a=a.Tp(va.a.span);const Ra=[];if(0!==c){if(!this.k8a.bpm)switch(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&
ua&&(ja=ua.Rh)&&ja.vNf&&Ra.push("annotation-"+ja.vNf),c){case 1:Ra[Ra.length]=fc.a.pUc;break;case 2:Ra[Ra.length]=fc.a.nUc;break;case 3:Ra[Ra.length]=fc.a.mUc}b.isSuperscript&&(Ra[Ra.length]=fc.a.U8d)}else ja&&(Ra[Ra.length]=fc.a.o8i);I&&(Ra[Ra.length]=fc.a.M9);f&&(Ra[Ra.length]=fc.a.P8d);l&&(Ra[Ra.length]=fc.a.R8d);u&&(Ra[Ra.length]=fc.a.oUc);a.className=0<Ra.length?Ra.join(" "):fc.a.h7b;this.dPf(a,b,T);return a}qCi(a,b,c){if(b&&a){if(b=Od.a.LAb(b))if(b=Wb.StyleReader.GR(b)){a.setAttribute("data-ccp-charstyle",
b);return}(c=$a.ParagraphReader.ke(c)?Wb.StyleReader.iF(c):null)&&(c=Wb.StyleReader.GR(c))&&c!==Wb.StyleReader.dPa&&c!==Wb.StyleReader.X5h&&a.setAttribute("data-ccp-parastyle",c)}}XKf(a,b){0===a.style.textDecoration.length?a.style.textDecoration=b:0>a.style.textDecoration.toLowerCase().indexOf(b)&&(a.style.textDecoration+=" "+b)}pCi(a,b,c){(c=this.jw.tpg(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(Aa.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=
a/this.jw.gle()*c/100+"px"))}I_d(){}VMf(){}UMf(){}j3i(a,b,c,f){b=b.Tp(va.a.span);b.className=fc.a.gde;this.$Lc&&this.$Lc.DDm(f,b);a.appendChild(b);c(b);return b}O0f(a,b,c,f){b=b.Tp(va.a.span);b.className=fc.a.OO;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.khe(a),b.style.fontFamily=a.style.fontFamily,Object(Nb.a)("UpdateTextColorInEOP")&&(b.style.color=a.style.color));a="";for(let l=0;l<f;l++)a+=c;b.innerText=a;return b}khe(a){return a.style.lineHeight}s0d(a,b){a?(Sys.UI.DomElement.addCssClass(a,
"Highlight"),Sys.UI.DomElement.addCssClass(a,fc.a.s8i),b||Sys.UI.DomElement.addCssClass(a,fc.a.Q8d)):b&&((a=Sys.UI.DomElement.containsCssClass(b,fc.a.Q8d))&&Sys.UI.DomElement.removeCssClass(b,fc.a.Q8d),Sys.UI.DomElement.addCssClass(b,a?fc.a.u8i:fc.a.t8i))}static Lka(a,b,c){ca.a.Uw(c,ia.a.nIa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static xhg(a){const b=[],c=[];if(a&&a.Kg)for(let f=0;f<a.Kg.length;f++){const l=a.Kg.ga(f);l.il?b.push(l.VH):c.push(l.VH)}return{xSc:b,tSc:c}}static dKi(a,b){const c=
new Cc.a;for(const l of b){var f=a.Ie(l);b=f.$a(ib.a.Z5b);if(f=f.ra(ib.a.uSc,null)){let u,I=c.Eg(f);({value:u}=I);I.returnValue||(u=new La.a,c.$(f,u));u.add(b)}}return c}static zhg(a,b,c){const f=new La.a,l=nc.dKi(a,b);for(const u of b){const I=a.Ie(u),T=I.$a(ib.a.Z5b),ja=I.ra(ib.a.Zve,!1),ua=I.ra(ib.a.YZi,!1),Ra=I.ra(ib.a.HYf,!1);ja&&!Ra&&(c.add(u),ua||l.Ib(T)||f.add(I.id))}return dc.bzl(b,f)}static xhm(a,b,c,f){const l=new La.a,u=new La.a;b=nc.zhg(a,b,l);a=nc.zhg(a,c,u);c=new La.a;c.addRange(f);
c.addRange(l);c=dc.czl(c,u);return{xSc:b,tSc:a,M8i:c,xkk:0<u.count}}static uvj(a,b){var c=1;if(E.a.TG&&!b){a=za.a.yZc(a,!1);for(const f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&(c+=jc.DVc+jc.W$d)}return c}}nc.jqj=.8;nc.YYh="TrackChangeImageOverlay";Object(m.a)(nc,"ParagraphContentRenderer",null,[420]);var Kc=d(77),xd=d(615),Xc=d(1279),Tb=d(54);class he{constructor(a){this._element=null;this.Mi=a;this.JGc=[]}get ownerDocument(){return this.Mi}get element(){return this._element}cob(a){this._element=
a}Ijh(){var a=Sys.EventArgs.Empty;if(this.JGc)for(let b=0;b<this.JGc.length;b++)(0,this.JGc[b])(this,a)}dispose(){this.JGc=this._element=this.Mi=null}}Object(m.a)(he,"APresenter",null,[310,106]);class re extends he{constructor(a,b){super(b.htmlElement.ownerDocument);this.Vsb=null;this.H_b=a;this.wri=b}lfg(a){this.element&&a.a$c===this.Vsb||(this.Vsb=a.a$c,this.cob(this.H_b.O0f(this.Vsb,this.wri.Vd,ia.a.GWc,1)),this.element.className=fc.a.chc,this.element.style.lineHeight=this.Vsb.style.lineHeight,
a=""+ca.a.Ie(this.Vsb,ia.a.nTb),ca.a.Uw(this.element,ia.a.nTb,a),a=Xc.a.createElement(this.ownerDocument,va.a.span),a.innerText=ia.a.yQi,za.a.qw(this.element),this.element.appendChild(a),a=Xc.a.createElement(this.ownerDocument,va.a.br),this.element.appendChild(a))}bzg(){}dispose(){super.dispose();this.Vsb=null}}Object(m.a)(re,"LineBreakPresenter",he,[]);class ee{constructor(a){this.H_b=a}create(a){return new re(this.H_b,a)}}Object(m.a)(ee,"LineBreakPresenterFactory",null,[215]);class Yf extends he{constructor(a,
b){super(a.ownerDocument);this.DXd=b;this.Wda=a}lfg(){this.element||(this.cob(this.Wda.Tp(va.a.span)),19===this.DXd.kind||18===this.DXd.kind?Sys.UI.DomElement.addCssClass(this.element,fc.a.O8d):(Sys.UI.DomElement.addCssClass(this.element,fc.a.i7b),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.DXd.Jab,this.Ijh())}bzg(){this.cob(null);this.Ijh()}}Object(m.a)(Yf,"UnsupportedObjectPresenter",he,[]);class ke{create(a,b){return new Yf(a,b)}}Object(m.a)(ke,"UnsupportedObjectPresenterFactory",
null,[213]);class ef{constructor(a,b,c,f,l,u,I){this.wy=void 0===a?!1:a;this.vej=void 0===b?!1:b;this.Qlm=void 0===c?!1:c;this.Rlm=void 0===f?!1:f;this.DCc=void 0===l?!1:l;this.Dve=void 0===u?!1:u;this.bpm=void 0===I?!1:I}}Object(m.a)(ef,"ParagraphContentRendererSettings",null,[]);var yf=d(112);class Rf{constructor(a,b,c){this.$W=a;this.Z_=b;this.lXb=c}ocb(a){return a}zjg(a,b,c){return c.aua(a)}ahg(){return null}Hkg(){return E.a.Fk&&window.chrome?"none":null}mWf(){return!1}XZh(){return!1}jPf(){return""}X3h(){}RBc(){}eZf(){}OQh(a){return a===
G.a.underline||a===G.a.Wqa||a===G.a.strikethrough||a===G.a.hu||a===G.a.fT}g_e(a,b){this.$W&&this.$W.isEnabled&&this.$W.createFontUrl(a);this.Z_&&this.Z_.isEnabled&&(b=Ca.FontUtils.uvb(b,a,!1,!1,!0),this.Z_.createFontUrl(a));return b}Axh(a,b,c){c=void 0===c?null:c;if(!a)return b;b=this.g_e(a.fontName,b);this.lXb&&this.lXb.isEnabled&&(b=Ca.FontUtils.uvb(b,a.fontName,!1,!0),this.lXb.Ivm(a)||this.lXb.ntm(c),this.lXb.Wtm(a));return b}W6c(){return!1}Khe(a,b,c,f){a=null;!c&&f||!b.y5||(b=b.fontColor,a=b===
Vb.a.auto?"WindowText":Vb.a.WH(b));return a}KQh(a,b,c,f,l){return!b&&!c&&!f&&!l}tpg(){return 0}gle(){return.8}oQh(a,b){return a||!b}SQh(){return!1}qQh(){return!1}aig(){return new Cc.a}dig(){return null}mac(a){return yf.Font.sGa(a.tM)}}Object(m.a)(Rf,"TextRenderingStrategy",null,[128]);class Za{get name(){return"Box4.ParagraphRenderElements"}fc(a){a.register(ee,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().na(()=>new ee(a.resolve("Box4.IParagraphContentRenderer")));a.register(ke,
"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();a.register(Rf,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().na(()=>new Rf(a.ub("Box4.IFontService"),a.ub("Box4.CustomFontService"),a.ub("Box4.IEmbeddedFontService")));a.register(ef,"Box4.ParagraphContentRendererSettings").ma().na(()=>new ef(Kc.ListReader.wy,A.AFrameworkApplication.fa.getBooleanAppSetting("DragDropSelectionIsEnabled"),U.a.instance.ga(49),U.a.instance.ga(53),A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorCommentImprovementIsEnabled"),
A.AFrameworkApplication.fa.getBooleanAppSetting(Ca.FontUtils.ZXf),A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")));a.register(nc,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>new nc(Ha.InteractiveViewManager.instance,Ta.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.ub("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),
a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.ub("Box4.IFeatureHelper"),Ca.FontUtils.wla,a.ub("Box4.IFontSlotProvider"),Object(R.a)(a.resolve("Box4.IEditStateEventManager"),a.resolve("Box4.IEditStateEventManager").szh,"raiseParagraphContentUpdatedEvent"),Od.a.language,a.ub("Box4.ITableOfContentRenderHelper"),xd.a.WRf))}init(){}dispose(){}static main(){C.a.instance.Ac(new Za)}}Object(m.a)(Za,"Box4ParagraphRenderElementsPackage",
null,[2,3]);class Kb{constructor(a,b,c,f,l,u,I){this.Gwe=a;this.Vtk=b;this.V7c=c;this.Xnk=f;this.crk=l;this.wy=u;this.Erk=b&&I||f}}Object(m.a)(Kb,"TableCellViewElementSettings",null,[]);class Ic{get name(){return"Box4.TableViewElements"}fc(a){a.register(Kb,"Box4.TableCellViewElementSettings").ma().na(()=>new Kb(A.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteSpannedTableCellRenderIsEnabled"),U.a.instance.ga(63),U.a.instance.ga(30),U.a.instance.ga(77),U.a.instance.ga(71),Kc.ListReader.wy,A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){C.a.instance.Ac(new Ic)}}
Object(m.a)(Ic,"Box4TableViewElementsPackage",null,[2,3]);var Hc=d(1265),jd=d(396),Id=d(1287),ze=d(240),Ie=d(164),Cd=d(193),ue=d(1215);class Ee{Ie(a,b){return ca.a.Ie(a,b)}Uw(a,b,c){ca.a.Uw(a,b,c)}uqa(a,b){ca.a.uqa(a,b)}QMa(a){ca.a.QMa(a)}fTc(a,b){ca.a.fTc(a,b)}}Object(m.a)(Ee,"CustomDataProxy",null,[852]);var Xe=d(409),Sd=d(64),ad=d(28);class af{constructor(){this.Ma=new uc.a}epl(a){this.Ma.raiseEvent("OnBackspaceDelete",a)}}Object(m.a)(af,"BackspaceDeleteEventSource",null,[630,631]);class pf extends Sys.EventArgs{constructor(a,
b){super();this.dO=a;this.nW=b}}pf.eventId="AEV.AVLD";Object(m.a)(pf,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,[]);class xf extends uc.a{constructor(){super()}ALf(a){this.addHandler(pf.eventId,a)}bBl(a){this.removeHandler(pf.eventId,a)}}xf.r_i="AEV.CR";xf.$$a="CEA";Object(m.a)(xf,"ContentEditableViewEventSource",uc.a,[]);var gf=d(130),me=d(50);class ag{constructor(){this.nKc=null;this.pi=0}yHj(a){if(!this.nKc){var b=a.Pb?me.a.createTextRange(a.node,0,a.Pb):me.a.rk(a.node,a.Pb);this.nKc=
gf.HyperlinkReader.HD(b,!1);this.pi=this.nKc.length-1}for(;0<=this.pi;)if(b=this.nKc[this.pi],a.Pb<=b.Ra)--this.pi;else return b.Pb<=a.Ra?null:b;return null}}Object(m.a)(ag,"OverlappingHyperlinkHelper",null,[]);class de{constructor(a,b,c,f,l){this.y4a=a;this.TE=b;this.Lta=c;this.Kmd=f;this.Lmd=l}}Object(m.a)(de,"PersistActiveSpanEditState",null,[]);class wa{constructor(a,b){this.Yh=a;this.Ch=b;this.QJc=[];this.tJ=this.sJ=-1}c4e(){if(-1!==this.sJ&&-1!==this.tJ&&this.Ch){this.QJc.reverse();const a=
this.QJc.join("");let b,c;this.sJ===this.tJ?(b=me.a.rk(this.Yh,this.sJ),c=!!a.length):(b=me.a.createTextRange(this.Yh,this.sJ,this.tJ),c=this.tJ-this.sJ!==a.length||this.xle(b)!==a);c&&this.Ch.replaceTextRange(b,a,!0,void 0,G.a.Nz)}this.tJ=this.sJ=-1;Array.clear(this.QJc)}$Di(a,b){this.sJ=a.Ra;-1===this.tJ&&(this.tJ=a.Pb);0<b.length&&Array.add(this.QJc,b)}xle(a){return $a.ParagraphReader.text(a.node).substring(a.Ra,a.Pb)}}Object(m.a)(wa,"ReplacementTextRangeBuilder",null,[]);var ta=d(37);class Eb{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb){this.Wh=a;this.JE=b;this.Esa=c;this.sg=f;this.yd=l;this.uo=u;this.Ed=I;this.Tn=ja;this.jd=ua;this.Af=Ra;this.La=eb;this.cZb=this.La.getBooleanAppSetting("TextLayoutServiceUseResponse");this.rxf=this.La.getBooleanAppSetting("TextLayoutServiceEnableActiveContentSpanFix");this.O8=this.La.getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")}Bdm(){let a,b;a=b=null;if(this.Ed&&this.Ed.oT){var c=this.Tn.getSelection(this.jd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&
"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,fc.a.Sha);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,Qdg:a,Rdg:b}}}return{returnValue:!1,Qdg:a,Rdg:b}}SGj(a){let b=0;for(const c of za.a.zcb(a))"span"===c.nodeName.toLowerCase()&&b++;return b}KLl(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,fc.a.Sha)&&!Sys.UI.DomElement.containsCssClass(b,fc.a.DY);){if("font"===b.nodeName.toLowerCase()){a=
b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(const c of za.a.zcb(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=b.parentNode}return null}Vxj(a,b,c,f,l){let u=za.a.zw(c);const I=za.a.Mfe(c,fc.a.Sha);l=this.SGj(I)+this.Wh.pj.length-l.qu.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?u=za.a.zw(f)+za.a.zw(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?u=za.a.zw(f):"#text"===c.nodeName.toLowerCase()&&
c.parentNode!==f&&(u=za.a.zw(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(u=za.a.zw(f)+za.a.zw(f.nextSibling)):2<l&&(u=b.innerText,da.ULS.sendTraceTag(508699799,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));a.c6b||!b.innerText.endsWith(" ")||u.endsWith(" ")||(u+=b.innerText.substr(b.innerText.trimEnd().length));return u}Ffl(a,b,c,f,l){const u=new de(null,null,!0,null,null);let I=null,T=null;if(1===this.Af.mode||2===this.Af.mode)({Qdg:I,Rdg:T}=
this.Bdm());let ja=!1,ua=!1;const Ra=new ag,eb=new wa(a,f),Bb=0<this.Wh.pj.length&&this.Wh.pj[0].c6b;let Ub=null;I&&(this.cZb&&this.La.getBooleanAppSetting("TextLayoutServiceEnableHyperLinkDataLossFix")||this.O8&&0<za.a.qge(b,fc.a.DY).length)&&(Ub=this.KLl(I));for(let tc=this.Wh.pj.length-1;0<=tc;tc--){const lc=this.Wh.pj[tc],Ec=lc.DG;let hd=!1;if((this.rxf&&this.cZb||this.O8&&0<za.a.qge(b,fc.a.DY).length)&&T&&!za.a.H8b(Ec)){var Xb=!1;Bb&&tc===this.Wh.pj.length-1&&!za.a.Mfe(I,fc.a.OO)?hd=Xb=!0:1===
this.Wh.pj.length&&(Xb=!0);Xb&&(Ec.innerText=this.Vxj(lc,Ec,I,T,c),u.Lta=!1)}u.TE=za.a.zw(Ec);this.JE.c9&&this.Mgj(u.TE)&&(u.TE=Aa.a.substr(u.TE,0,u.TE.length-1));Xb=this.Dxj(a,tc);this.VYk(a,b,tc,u);ua=!!u.y4a||ua;Ub===Ec&&(u.Lmd=Ec.innerText+za.a.zw(I),I.nodeValue="",u.Lta=!1,da.ULS.sendTraceTag(508699798,323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));u.Kmd||(u.Kmd=this.Bnj(a,Xb,Ra));const yd=!!l&&l.D_i(Xb);this.Bgm(a,b,Ec,tc,u,hd);yd&&0<u.TE.length?(eb.c4e(),this.replaceTextRange(f,
u,"",Xb),this.vEi(l,yd,u,Xb)):this.IXi(lc,u.TE,Xb,eb);ja=Ec===T||ja}eb.c4e();this.yim(a,u);I&&za.a.zw(I)&&!ja&&!ua&&(this.yd.kc("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),Eb.kzf||(da.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),Eb.kzf=!0));return u.Lta}IXi(a,b,c,f){if(c.contextId!==ta.a.Xf&&!a.c6b&&0<=a.Fqd){const l=a.Fqd,u=a.yWe;a=l!==u?me.a.createTextRange(c.node,l,u):me.a.rk(c.node,l);b=b.substring(l-
c.Ra,b.length-(c.Pb-u))}else a=c;a.Pb-a.Ra!==b.length||b!==this.xle(a)?f.$Di(a,b):f.c4e()}Mgj(a){return a.charAt(a.length-1)===jc.LMb||E.a.gp&&a.charCodeAt(a.length-1)===H.a.MUb}xle(a){return $a.ParagraphReader.text(a.node).substring(a.Ra,a.Pb)}replaceTextRange(a,b,c,f){b.TE!==c&&a&&a.replaceTextRange(f,b.TE,!0,!0)}vEi(a,b,c,f){b&&0<c.TE.length&&(b=me.a.createTextRange(f.node,f.Ra,f.Pb+c.TE.length),a.xEi(b))}yim(a,b){b.Kmd&&(b=gf.HyperlinkReader.HD(b.Kmd,!0),1===b.length&&this.uo&&this.uo.UUl(a,b[0]))}Bgm(a,
b,c,f,l,u){const I=za.a.Jng(c);if(this.Wh.pj[f].c6b&&I)u||this.bVj(b,f,l,I);else if(l.y4a&&!Sys.UI.DomElement.containsCssClass(c,fc.a.AO))this.yd.kc("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.sg.bc++,l.TE+=l.y4a,l.y4a=null,za.a.yA(this.Wh.pj[f].DG,l.TE);else if(l.Lmd)l.TE=l.Lmd,l.Lmd=null;else if(this.cZb&&this.rxf||this.O8&&0<za.a.qge(b,fc.a.DY).length)a=$a.ParagraphReader.text(a),b=this.Wh.pj[f],c=b.Fqd,u=b.yWe,f+1<this.Wh.pj.length&&!za.a.H8b(this.Wh.pj[f+1].DG)&&c===
u&&0<c&&" "===a.charAt(c-1)&&(l.TE=l.TE.substr(0,c-1)+" "+l.TE.substr(c-1),l.Lta=!1),b.DG.innerText.endsWith(" ")||" "!==a.charAt(u)||b.u1a+b.wWa!==u+1||(l.TE+=" ",l.Lta=!1)}bVj(a,b,c,f){!b&&c.y4a?(this.yd.kc("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.sg.bb++,c.TE=c.y4a,za.a.yA(this.Wh.pj[b].DG,c.TE),this.Ed.WD&&(a=a.lastChild,(this.cZb||this.O8)&&Sys.UI.DomElement.containsCssClass(a,fc.a.DY)&&(a=a.lastChild),a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.y4a=null):
(this.yd.kc("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.sg.bd++,c.TE="",za.a.yA(this.Wh.pj[b].DG,c.TE))}Dxj(a,b){b=this.Wh.pj[b];return b.u1a?me.a.createTextRange(a,b.wWa,b.wWa+b.u1a):me.a.rk(a,b.wWa)}VYk(a,b,c,f){if(this.Wh.pj[c].wWa+this.Wh.pj[c].u1a===$a.ParagraphReader.textLength(a)&&(a=b.lastChild,(this.cZb||this.O8)&&Sys.UI.DomElement.containsCssClass(a,fc.a.DY)&&(a=a.lastChild),c=za.a.zw(a),c.length>this.Esa.Wbe)){this.sg.ba++;this.JE.Pnb(!1,b,this.Wh);f.y4a=Aa.a.substr(c,
0,c.length-this.Esa.Wbe);b="";for(c=0;c<this.Esa.Wbe;c++)b+=ia.a.GWc;a.innerText=b;f.Lta=!1}}Bnj(a,b,c){return(b=c.yHj(b))&&Eb.Nek(b)?me.a.rk(a,b.Ra):null}static Nek(a){return!!a.hyperlink&&a.hyperlink.url===$a.ParagraphReader.text(a.paragraph).substring(a.Ra,a.Pb)}}Eb.kzf=!1;Object(m.a)(Eb,"ActiveContentSpansPersistanceManager",null,[632]);class qc{constructor(a){this.Yt=a}H2k(a){a&&this.Yt.v_()}}Object(m.a)(qc,"AppFrameResizeEventProcessor",null,[]);class Sc{constructor(){this.y2b=new La.a}xa(a){this.y2b.add(a)}ava(a){return this.y2b.count>
a?this.y2b.ga(a):null}get qIa(){return this.y2b.count}isEmpty(){return!this.y2b.count}}Object(m.a)(Sc,"AggregatedAutoCorrectActions",null,[680]);var td=d(238);class je{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc){this.QS=this.uo=this.NGc=this.jf=null;this.yv=a;this.BL=b;this.Oh=c;this.Vb=f;this.Wh=l;this.X_=u;this.Io=I;this.Gj=T;this.Wja=ja;this.Yt=ua;this.Af=Ra;this.DT=eb;this.lm=Bb;this.Vc=Ub;this.zd=Xb;this.Pp=tc}sU(a){this.jf=a}get $3b(){return this.BL}get hyperlinkEditor(){return this.uo||
(this.uo=Tb.a.instance.ub("Box4.IHyperlinkEditor"))}get Q5j(){return this.NGc||(this.NGc=Tb.a.instance.ub("Box4.IHyperlinkActionFactory"))}gdk(a){if(this.yv.instance&&a&&2===this.Oh.mode)if(this.jf.Xt(!0),this.Wja.value.Bx(),a.ty)this.yv.instance.edk(a),this.Wja.value.Bx();else{var b=this.Gj.e$(this.Oh.mode,this.Vb.tj);a.ewg.innerText=a.ewg.innerText;this.DT.iwc();this.Io.raiseEvent(td.a.autoCorrect);1===this.yv.instance.fdk(a)&&(this.Af.kca(!0),b>=a.JS&&(b+=a.s$c),this.Gj.MU(b,this.Vb.ui),this.jf.Xt(!0),
this.Wja.value.Bx(),this.Yt.v_())}}yQe(a,b){if(!this.yv.instance||!this.Q5j||!this.hyperlinkEditor)return null;this.jf.Xt(!0);a=this.X_.kva(b).Ua;b=a.Ra;if(0>=b||!this.Wh.pj.length)return null;if(a=this.yv.instance.yQe(a.node,b))this.QS||(this.QS=new Sc),this.QS.xa(a);return a}hdj(a,b){if(2===this.Oh.mode&&this.Wh.pj.length){var c=this.Gj.e$(this.Oh.mode,this.Vb.tj);!this.QS&&this.yv.instance&&(b=this.X_.kva(b).Ua,0>c||!this.Wh.pj.length||(this.QS=new Sc,this.QS=this.yv.instance.s0f(b.node,c,c-this.Wh.pj[0].hQc,
this.Wh.pj[0].DG,!this.Wh.pj[0].hQc,a),this.QS.qIa||(this.QS=null)))}}vfl(){if(2===this.Oh.mode){if(0<this.QS.qIa){this.jf.Xt(!0);for(var a=0;a<this.QS.qIa;a++)this.QS.ava(a).N4h();for(a=0;a<this.QS.qIa;a++)this.gdk(this.QS.ava(a))}this.QS=null}}}Object(m.a)(je,"AutocorrectActionExecutor",null,[]);var Te=d(323);class Hd{constructor(a,b,c,f,l,u,I,T,ja,ua){this.Tqi=u;this.X_=a;this.Qj=b;this.NE=c;this.Bf=f;this.JL=l;this.inf=I;this.zd=T;this.LE=ja;this.SBa=!!ua;this.yv=ua}Ndm(a,b,c,f,l,u,I){if(!f)return!1;
f=this.X_.kva(l);if(!f||!this.Bf.uy(f)||!f.Ua.El)return!1;l=f.Ua;if(this.hnk(l)||this.Dkk(a,l)||this.Neb(l))return!1;if(ad.App.xHi){if(this.gnk(u))return!1}else if(this.fnk(u))return!1;return this.JL&&this.JL.VDb(f)||!this.GPi(a,this.Qj,I,za.a.zw(c),b)||this.SBa&&!a&&this.yv.instance&&this.yv.instance.W1j()?!1:!0}gnk(a){if(this.inf&&a&&Sys.UI.DomElement.containsCssClass(a,fc.a.Sha)){const b=za.a.lfa(a,fc.a.DY);b&&(a=b)}return za.a.lfa(a,Hd.ujh)?!0:!1}fnk(a){if(this.inf&&a&&Sys.UI.DomElement.containsCssClass(a,
fc.a.Sha)){const b=za.a.lfa(a,fc.a.DY);b&&(a=b)}return za.a.lfa(a,Te.a.Ffb)||za.a.lfa(a,Hd.ujh)?!0:!1}Neb(a){return(()=>this.LE.Neb(a))().returnValue}hnk(a){return this.Qj&&(!this.Tqi.N4b(a.node)||U.a.instance.ga(14)&&this.NE.Gsh(a.node))?!0:!1}Dkk(a,b){return U.a.instance.ga(14)&&this.NE.plk(b,!a)}GPi(a,b,c,f,l){if(!f||""===f)return!1;var u=this.zd.Gg&&this.zd.wD;u=a&&!u?0:1;!a&&1<c&&Aa.a.yy(f,c-1)?u=2:c<f.length&&Aa.a.yy(f,c)&&(u=1);if(a){if(a=c+u,a>=f.length-2||!this.HPi(c,f,u))return!1}else{a=
c-u;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&Aa.a.fA(f.charCodeAt(0))&&(f.length===c||Aa.a.fA(f.charCodeAt(c))))return!1}b=ha.a.MGa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,ia.a.q8i)||Sys.UI.DomElement.containsCssClass(b,fc.a.OO)||Sys.UI.DomElement.containsCssClass(b,fc.a.AO)||Sys.UI.DomElement.containsCssClass(b,ia.a.wX)?!1:!0}HPi(a,b,c){return Aa.a.fA(b.charCodeAt(a+c))&&(!a&&b.length===1+c||1===a&&Aa.a.fA(b.charCodeAt(0)))?!1:!0}}Hd.ujh="NoteTagContainer";Object(m.a)(Hd,
"BackspaceInBrowserHandler",null,[]);var mg=d(1275),fg=d(228);class $e{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(m.a)($e,"UnroundedRectangle",null,[]);var oj=d(1111),Me=d(63),we=d(147);class Zc{constructor(a,b,c,f,l,u,I,T,ja){this.Qh=null;this.yia=!1;this.wda=a;this.jd=b;this.c0=c;this.d4=f;this.Ed=l;this.$f=u;this.Af=I;this.Vb=T;this.WQ=ja}g4b(a){this.Qh=a}v_(){if(2===this.Af.mode&&this.Vb.Pg){var a=this.Vb.NX,b=this.Vb.ui;if(a&&b)if(!this.jd.Lg&&A.AFrameworkApplication.fa.getBooleanAppSetting("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))da.ULS.sendTraceTag(51667991,
317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.Qh.Na);else{this.jd.Lg.MSe(a);b=this.jd.Lg.xv;var c=this.Pig(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;a=c.width;c=c.height;0>a&&(a=0);var l=mg.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.YQh()&&(f=this.jd.hn(),this.Etk()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip=
"rect(0px,"+a+"px,"+c+"px,0px)"));this.wda.instance.Xim(b.parentNode,this.Vb.mua,!!this.Qh&&this.Qh.Nm&&this.Qh.eAb)}}}}YQh(){return this.Ed.WD&&!this.Ed.Aj&&U.a.instance.ga(30)}Khk(a){return za.a.LXa(a)}Etk(){return we.c(this.Qh.Zg)}wi(a){return Sd.a.wi(a)}jWh(a){var b=Me.a.instance.Oa.kb;if(1===this.Af.mode){var c=(b.Kf?b.vf:b.Ua).node;b=c.sc(this.$f.$d.Na);a=c.sc(a);if(b&&a){this.jd.Lg.MSe(b);a=this.jd.Lg.xv;var f=this.Pig(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;
0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.Ed.unb)this.d4.pvg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}Pig(a,b){if(!this.Khk(a))return null;var c=this.wi(a),f=this.wi(b);let l=c.x-f.x;f=c.y-f.y;var u=mg.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{u&&u.dispose()}b=c.width;c=c.height;this.c0&&this.c0.instance&&this.c0.instance.KCg(a)&&(u=this.c0.instance.X4,b/=u,c/=u);if(this.WQ.HEb(a)){var I=
fg.a.Tu(a);I&&(u=parseFloat(I.width),I=parseFloat(I.height),isNaN(u)||isNaN(I)||(b=u,c=I))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.Ed.NXa||this.Ed.gp)b+=.001,l+=.001,f+=.001;c+=1.001;return new $e(new oj.a(l,f),b,c)}}Object(m.a)(Zc,"BoundsSynchronizer",null,[623]);var te=d(575),ne=d(80);class Zf{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.Iji=new te.a(RegExp("\r\n","g"),"\n");this.VNd=null;this.MPd=0;this.xTd=!1;this.aHc=!0;this.yd=b;this.sg=c;this.fIc=a;this.jd=f;this.Np=l;
this.Ed=u;this.$f=I;this.je=T;this.Qj=ja;this.Tn=ua;this.JUd=Ra;this.jta=Bb}get XAg(){null==this.VNd&&(this.VNd=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.VNd}get xYa(){return this.MPd}get asl(){return this.xTd}get gck(){return this.aHc}RZc(a,b){var c=this.jd.lva();if(1===a||0===a)return 0;if(this.Ed.oT){var f=this.oGa();if(f){this.xTd=!this.x8c(f);c=this.Tn.h2c(f);var l=this.Tn.bpg(f),u=l;this.XAg&&this.Ed.Fl&&
(f=this.Tn.Tig(f),l!==f&&(u=f));return this.Np.uje(c,b,u,this.sg,this.yd,this.Qj)}da.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.Ed.TG)try{return l=c.selection.createRange(),u=this.jd.hn().innerText,b=0,""!==u&&(b=Math.abs(this.Tn.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.Tn.moveEnd(l.range,-1E5)),this.xTd=b!==f),u=this.Iji.dMa(u),b>=u.length&&(b=u.length-1),b}catch(I){this.yd.kc("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),
this.sg.bg++,da.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",I.message,I.toString())}else da.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");this.sg.bh++;return 0}x8c(a){return Sd.a.x8c(a)}oGa(){return Sd.a.oGa(this.jd.contentWindow)}zZl(a,b,c,f,l){if(!A.AFrameworkApplication.fa||!A.AFrameworkApplication.fa.getBooleanAppSetting("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.qu.length-1||Sys.UI.DomElement.containsCssClass(b.qu[a+
1],fc.a.OO))return!1;a=b.qu[a];b=za.a.Mfe(a,fc.a.DY);if(!b)return!1;b=za.a.zcb(b).toArray();return b[b.length-1]!==a?!1:!0}MU(a,b){var c=this.jd.contentWindow;this.aHc=!0;this.MPd=a;try{if(this.Ed.oT){const u=b.qu;let I;var f=0;const T=this.Tn.getSelection(c);if(T)for(I=0;I<b.qu.length;I++){const ja=b.qu;da.ULS.shipAssertTag(18437200,315,u===ja);let ua=ja[I],Ra=this.Np.cK(ua,this.sg,this.yd,this.Qj);var l=a<=Ra+f;const eb=Sys.UI.DomElement.containsCssClass(ua,fc.a.AO),Bb=Sys.UI.DomElement.containsCssClass(ua,
ia.a.wX),Ub=this.zZl(I,b,a,f,Ra);if(l&&!eb&&!Bb&&!Ub){b=I+1;if(a===Ra+f&&b<ja.length){const Xb=ja[b];!this.Np.cK(Xb,this.sg,this.yd,this.Qj)&&za.a.H8b(Xb)&&(ua=Xb,f=a)}a-=f;this.fIc.value.U5b(ua,c);for(c=ua;c.firstChild;)c=c.firstChild;this.ffk(T,c,a)||(c=this.lij(c,this.jd.lva()),this.XAg&&this.Ed.Fl?2!==this.$f.editingView.yyb&&this.m9f(c,a,T):this.m9f(c,a,T));break}f+=Ra}}else this.Ed.TG&&(f=this.JUd.create(this.$f.$d),l=this.Tn.createRange(this.jd.hn()),this.Tn.collapse(l,!0),this.Tn.moveStart(l,
a),l.select(),f.dispose())}catch(u){da.ULS.shipAssertTag(4203852,315,!1)}}lij(a,b){"SPAN"===a.nodeName&&(b=b.em.createTextNode(""),a.appendChild(b),a=b);return a}m9f(a,b,c){if(this.Np.yBg(a)){this.Tn.removeAllRanges(c);var f=this.Tn.createRange(a.ownerDocument);this.Tn.mRb(f,!0,a,b);this.Tn.mRb(f,!1,a,b);try{this.Tn.addRange(c,f)}catch(l){this.sg.bl++,this.yd.kc("PossibleNoIp",{["Reason"]:"AddRangeException"}),da.ULS.shipAssertTag(1708946,315,!1)}this.Tn.collapse(f,!0)}else da.ULS.sendTraceTag(508625103,
324,50,"EnsureCaretPositionToTextObject: Detached element")}kUb(a,b){this.MPd=this.RZc(a,b)}mouseDown(){return this.aHc=!1}WK(){this.aHc=!0;return!1}e$(a,b){this.jta&&this.jta.Omm(this.xYa,this.RZc(a,b));return this.xYa}ffk(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,u=a.focusOffset;return a.isCollapsed&&l&&f===b&&u===c}e4f(a,b){const c=new ne.a(0,1,0,()=>{b.vYa(a.mode)&&this.kUb(a.mode,b.tj)},28);this.je.Jb(c)}}Object(m.a)(Zf,"CaretPositionManager",null,[624]);var cd=d(272);class aj{constructor(){this.LJ=
cd.a.instance.jge()}}Object(m.a)(aj,"CevUsageDataTracker",null,[]);class Qc{constructor(a,b){this.LEc=null;this.zka=0;this.Pg=this.NX=null;this.mua=!1;this.zDa=a;this.$f=b}init(a){this.zka=a}get $1j(){return!!this.Pg&&!!this.Pg.vg(this.zka)}get bUa(){da.ULS.shipAssertTag(18437208,315,!!this.Pg);return this.ui?this.ui.htmlElement:null}get tj(){return this.ui?this.ui.tj:null}get ui(){return this.LEc}set ui(a){this.LEc=a;a=null;this.zDa.instance&&(a=this.zDa.instance.v_h());this.LEc&&a&&a.IEm(this.LEc.Ish)}vYa(a){return 1!==
a||Me.a.instance.Oa.bga?this.Pg&&this.ui&&this.NX?(a=this.$f.$d)&&$a.ParagraphReader.ke(this.Pg)&&this.ui===this.Pg.sc(this.zka)&&this.NX===this.Pg.sc(a.Na)?!0:!1:!1:!0}}Object(m.a)(Qc,"CevViewContentManager",null,[622]);var Mc=d(1282),Ig=d(384);class wg{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){this.jf=null;this.GL=a;this.KWd=b;this.yd=c;this.tNd=f;this.jta=l;this.pka=u;this.Al=I;this.Oh=T;this.Mr=ja;this.Af=ua;this.CQa=Ra;this.bda=eb;this.sD=Bb;this.gX=Ub;this.pub=Xb}sU(a){this.jf=a}h6d(a,
b,c){if(this.CQa.E7j||this.GL.udc||!b)return!1;if(this.KWd.BPh)return!0;b=this.yd.Cq(G.a.Nz);b.properties.$(Mc.a.source,"Composition");a=this.nXi(a,c);b.end();return a}nXi(a,b){this.tNd.correctBadImeState()&&this.jta.cwc(G.a.$em);this.pka.fAb();if(this.gX.Gqd(a))return!1;this.Al.mze=(new Date).getTime();if(1===this.Oh.mode){const {x5:c,BSb:f}=this.gX.y_h(a,b);if(c)return f}this.Mr.isComposing=!0;this.pub||this.Af.kca(!0);a.eventName===la.a.i6d&&this.bda.raiseEvent(Ig.a.mZf,a);this.sD.uSa(a);return!1}e6b(a,
b,c){this.pub&&this.jf&&this.jf.Xt(!0,!0);return this.h6d(a,b,c)}d6b(a,b,c){this.h6d(a,b,c);return this.Mr.isComposing=!1}}Object(m.a)(wg,"CompositionEventProcessor",null,[]);class fe{constructor(a,b,c){this.e7a=!1;this.bda=a;this.Io=b;this.M8=c}get isComposing(){return this.e7a}set isComposing(a){(this.e7a=a)?(this.bda.raiseEvent(Ig.a.oXi),this.Io.raiseEvent(td.a.z7j)):(this.bda.raiseEvent(Ig.a.lXi),this.Io.raiseEvent(td.a.x7j))}get aIa(){return!this.isComposing&&!this.M8.Swg}}Object(m.a)(fe,"CompositionStateManager",
null,[]);var Qe=d(142),ig=d(93);class Ph{constructor(a,b,c){this.Ggi=A.AFrameworkApplication.fa.getBooleanAppSetting("AccessibilityNotificationEnabledViaAriaLiveRegion");this.JDa=this.XKd=this.gYd=this.pCa=this.mKd=null;this.$ub=a;this.nJ=b;this.Zra=c;this.render();this.Zra.$md&&this.nJ.QH(Object(R.a)(this,this.Jmd,"modeSwitched"))}Jmd(){this.Zra.zQh&&this.vyd(!0);this.t9f()}get xv(){return this.gYd}get contentWindow(){return Sd.a.XHj(this.$ub.ownerDocument)}get contentDocument(){return this.$ub.ownerDocument}get KBa(){return this.$ub}get Mo(){return this.XKd}get b6h(){return this.JDa}get isValid(){return!0}initialize(a,
b){this.pCa=a;this.pCa.d2d=Object(R.a)(this,this.onBlur,"onBlur");b()}yGh(){this.xv.style.left="0px";this.xv.style.top="0px"}jhj(){this.pCa&&this.pCa.bij(this,this.nJ)}sqa(){}VDd(){F.FocusManager.dr(this.contentWindow)}k_h(){F.FocusManager.Fem(this.Mo)}get oob(){return!Sd.a.wdk(this.Mo)}set oob(a){}n7e(a,b,c){this.Mo.setAttribute(Qe.a.Rp,a);this.mKd&&(this.mKd.innerText=b);this.qxc(c)}qxc(a){a&&this.Mo.setAttribute(Qe.a.Ff,a)}vyd(a){if(E.a.Gk||a)a=!this.Zra.due&&a,this.Mo.setAttribute("contenteditable",
a?"true":"false"),this.Zra.zQh?(Sys.UI.DomElement.addCssClass(this.Mo,"WACEditing"),Sys.UI.DomElement.addCssClass(this.Mo,P.AppFrame.H7f),Sys.UI.DomElement.addCssClass(this.Mo,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.Mo,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.Mo,P.AppFrame.H7f),Sys.UI.DomElement.removeCssClass(this.Mo,"EditingSurfaceBody"))}dispose(){this.cgm();this.xv&&(this.xv.parentNode&&this.xv.parentNode.removeChild(this.xv),this.XKd=this.gYd=null)}render(){const a=
String.format("{0}_EditingElement",this.$ub.id),b=String.format("{0}_WrappingDiv",a);this.gYd=document.createElement("div");this.xv.id=b;this.xv.style.height="0px";this.xv.style.width="0px";this.xv.style.display="none";ad.App.instance.R6c&&Sys.UI.DomElement.addCssClass(this.xv,"NoPointer");this.XKd=document.createElement("div");this.Mo.id=a;this.Mo.setAttribute("contenteditable",!this.Zra.due);this.Mo.setAttribute("spellcheck","false");E.a.kna&&this.contentDocument.execCommand("AutoUrlDetect",!1,
!1);this.LOl();this.t9f();ig.c(this.Mo,!0);ig.c(this.xv,!0);this.JDa=document.createElement("div");this.xv.appendChild(this.Mo);this.$ub.appendChild(this.xv)}t9f(){if(this.Mo){const a=String.format("{0}_WACEditing_DescribedByElement",this.$ub.id),b=this.Zra.asi;this.Zra.due?this.Mo.setAttribute("tabindex","0"):this.Mo.removeAttribute("tabindex");if(!this.Ggi){const c=U.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Qe.a.Lvj();this.mKd=Qe.a.TNf(this.xv,this.Mo,
a,c);this.n7e(b,c,null)}}}LOl(){E.a.Gk?Sys.UI.DomElement.addCssClass(this.Mo,"InternetExplorer"):E.a.jg?Sys.UI.DomElement.addCssClass(this.Mo,"FireFox"):E.a.zwa&&Sys.UI.DomElement.addCssClass(this.Mo,"Safari");E.a.Aj?Sys.UI.DomElement.addCssClass(this.Mo,"iPad"):Sys.UI.DomElement.addCssClass(this.Mo,"usehover")}cgm(){this.pCa&&(this.pCa.bgm(this,this.nJ),this.pCa=null)}onBlur(a){this.pCa.nLg(a);this.pCa.iRf(a)}iYk(){this.xv.style.width="0px";this.xv.style.height="0px"}MSe(a){a=a.htmlElement;this.xv.parentNode!==
a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.xv,a)}wdm(a){if(a&&"DIV"===a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);za.a.EEa(a);a.appendChild(b);break}}}}Object(m.a)(Ph,"ContentEditableDiv",null,[677,106]);class $g{create(a,b,c){return new Ph(a,b,c)}}Object(m.a)($g,"ContentEditableDomFactory",null,[620]);var Vg=d(76);class Fg{constructor(a,
b){this.Ed=a;Fg.La=b}O6c(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}Ifj(a,b){a=za.a.zw(a);const c=Aa.a.mIa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(Aa.a.O$(b)||Aa.a.Eec(b))?!0:!1}hhe(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.kc("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return jc.Pwg;if("BR"===a.tagName)return jc.uRf;if(this.BCg(a)&&Fg.La.getBooleanAppSetting("SkipPictureDescriptionWhenGettingElementTextIsEnabled"))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.hhe(a.childNodes[l],b,c);return f}Qpg(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(u){return da.ULS.sendTraceTag(51463192,324,15,u.message),c.kc("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(Fg.K7c(a))return this.jEj(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.BCg(a)&&Fg.La.getBooleanAppSetting("SkipPictureDescriptionWhenGettingElementTextIsEnabled"))return 0;
this.O6c(a)&&(l+=jc.DVc+jc.W$d);for(let u=0;u<a.childNodes.length;u++){const I=this.Qpg(a.childNodes[u],b,c,f);if(0<=I)l+=I;else return a.innerText.length}return l}BCg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}Brk(a){return Sys.UI.DomElement.containsCssClass(a,fc.a.R7l)}jEj(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):
Vg.AParagraphNode.P0.length}cK(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.kc("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.Qpg(a,b,c,f)}Zgg(a,b,c,f,l){let u=0;const I=a.qu;for(let T=0;T<I.length;T++){a=I[T];const ja=this.cK(a,f,c,l);if(b<u+ja)return b-=u,c=a.innerText,b>=c.length?0:Aa.a.charCodeAt(c,b);u+=ja}f.bt++;return 0}uje(a,b,c,f,l,u){if(void 0===a||null===a)return l.kc("IncorrectIpPosition",
{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,da.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return da.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let I=0;if(3===a.nodeType)I=c;else for(var T=0;T<c;T++)I+=this.cK(a.childNodes[T],f,l,u);for(;a!==b;){T=a;a=a.parentNode;if(!a){da.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");
l.kc("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("InvalidCaretPositionFixIsEnabled"))return 0;break}this.O6c(T)&&(I+=jc.DVc);let ja=0;for(;ja<a.childNodes.length&&a.childNodes[ja]!==T;)I+=this.cK(a.childNodes[ja],f,l,u),ja++;if(ja===a.childNodes.length)if(3===T.nodeType)I=c;else return l.kc("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,da.ULS.sendTraceTag(51463196,324,
15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return I}yBg(a){return za.a.H8b(a)}static get instance(){Fg.Ja||(Fg.Ja=new Fg(Id.a.instance,A.AFrameworkApplication.fa));return Fg.Ja}static K7c(a){return Sys.UI.DomElement.containsCssClass(a,fc.a.yWk)||Sys.UI.DomElement.containsCssClass(a,fc.a.Dij)||Sys.UI.DomElement.containsCssClass(a,fc.a.gfj)}}Fg.Ja=null;Fg.La=null;Object(m.a)(Fg,"ContentEditableViewDomUtils",null,[566]);class bf{constructor(a,b){this.fNd=
null;this.jd=a;this.Al=b}AEd(){return 1<this.mAj()||this.gug(this.fNd,this.Mig())}iwc(){const a=this.Mig();this.fNd=a?a.cloneNode(!0):null}mAj(){if(this.jd){const a=this.jd.hn();if(a&&a.childNodes)return a.childNodes.length}return 0}Mig(){if(this.jd){const a=this.jd.hn();if(a)return a.firstChild}return null}gug(a,b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.Y0j(a,b)}catch(c){return da.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}Y0j(a,b){if(Aa.a.Dg(a.nodeName)!==
Aa.a.Dg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!E.a.jg||a.childNodes.length!==b.childNodes.length-1||"BR"!==Aa.a.iD(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<
a.childNodes.length;c++)if((!Fg.K7c(a.childNodes[c])||!Fg.K7c(b.childNodes[c]))&&this.gug(a.childNodes[c],b.childNodes[c]))return!0;return!1}Toj(a,b){if(E.a.OD&&U.a.instance.ga(98)){b.kc("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=za.a.lfa(this.fNd,"EOP");const c=za.a.lfa(a.firstChild,"EOP");b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(m.a)(bf,"ContentEditableHtmlStructureUtils",null,[]);class Ag{constructor(){this.xji=A.AFrameworkApplication.fa.getBooleanAppSetting("MoveToIpModeInReadOnlyView")}get mode(){return A.AFrameworkApplication.Pa.mode}get $md(){return this.xji}get zQh(){return this.$md?
!0:1!==A.AFrameworkApplication.Pa.mode||ad.App.BEb&&A.AFrameworkApplication.kV}get asi(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get due(){return this.$md?1===A.AFrameworkApplication.Pa.mode||ad.App.BEb&&A.AFrameworkApplication.kV:ad.App.BEb&&A.AFrameworkApplication.kV?!(ad.App.P4b||ad.App.Mfc):1===
A.AFrameworkApplication.Pa.mode}get Dyc(){return this.$md?1===A.AFrameworkApplication.Pa.mode||ad.App.BEb&&A.AFrameworkApplication.kV:ad.App.BEb&&A.AFrameworkApplication.kV}}Object(m.a)(Ag,"ContentEditableModeHelper",null,[161]);var ff=d(181),Fe=d(35);class Pf{static s1i(a){const b={};for(const c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return Fe.c(b)}}Object(m.a)(Pf,"CommonActivityAggregationMethods",null,[]);var Md=d(1061),vg=d(1074),Ye=d(586),Cf=d(319),Bg=d(285),Ae=d(94);class Uf{constructor(){this.d2d=
this.nLg=this.iRf=this.cWc=this.e3=this.CRe=this.bkb=this.BQb=this.U2a=this.K_d=this.gff=this.hff=this.AD=this.Qab=this.xD=this.l8b=this.w6b=this.p9d=this.zsc=this.q8b=this.AFa=this.BFa=this.npb=this.d6b=this.j6d=this.e6b=this.ufb=this.jIa=this.XA=null;this.L8=this.FHd=this.KKd=this.BUd=this.DNd=this.LWd=this.EJd=!1}bij(a,b){if(!this.L8){this.L8=!0;var c=Ye.a.instance,f=b.uH,l=b.sT,u=b.upb,I=b.Mz,T=Cf.a.instance,ja=b.Tia,ua=Bg.a.instance,Ra=b.TCd,eb=b.QCd;E.a.Aj&&(Ie.EventHandlerManager.instance.exl(this.K_d),
this.FHd=!0);b.v9(this.e3);this.iwl(a.Mo,f,l,I,u,ua,ja,T,c,Ra,eb)}}bgm(a,b){if(this.L8){var c=Ye.a.instance,f=b.uH,l=b.sT,u=b.upb,I=b.Mz,T=Cf.a.instance,ja=b.Tia,ua=Bg.a.instance,Ra=b.TCd,eb=b.QCd;this.FHd&&(Ie.EventHandlerManager.instance.egm(this.K_d),this.FHd=!1);b.VMa(this.e3);this.Zfm(a.Mo,f,l,I,u,ua,ja,T,c,Ra,eb);this.L8=!1}}iwl(a,b,c,f,l,u,I,T,ja,ua,Ra){b.qq(a);c.qq(a);f.qq(a);l.qq(a);u.qq(a);Ae.a.addHandler(a,la.a.paste,this.zsc);Ae.a.addHandler(a,la.a.cut,this.p9d);Ae.a.addHandler(a,la.a.copy,
this.w6b);!Uf.Xok&&E.a.jg&&(Ae.a.addHandler(a,la.a.sae,this.l8b),this.KKd=!0);Ae.a.addHandler(a,la.a.blur,this.d2d);f.xb(la.a.click,a,this.xD);2===ad.App.mode?I.dL(a,this.cWc,!0):I.dL(a,this.cWc);T.xb(a,this.AD);l.xb(la.a.f8,a,this.hff);l.xb(la.a.z3,a,this.gff);c.xb(la.a.mouseDown,a,this.bkb,null);c.xb(la.a.WK,a,this.CRe,null);b.xb(la.a.rm,a,this.jIa);b.xb(la.a.nz,a,this.ufb);b.xb(la.a.Vf,a,this.XA);b.xb(la.a.sEa,a,this.XA);f.xb(la.a.doubleClick,a,this.Qab);Ae.a.addHandler(a,la.a.scroll,this.U2a);
if(E.a.Hcf||E.a.jg)Ra.xb(la.a.lZf,a,this.e6b,this),Ra.xb(la.a.i6d,a,this.j6d,this),Ra.xb(la.a.g6d,a,this.d6b,this),this.EJd=!0;ad.App.m2d&&E.a.JVh||E.a.gp?(ua.xb(la.a.input,a,this.npb,this),this.DNd=!0):E.a.Lcf&&(ua.xb(la.a.fef,a,this.npb,this),this.LWd=!0);ja.xb(la.a.drop,a,this.BFa);E.a.qwa&&(ja.xb(la.a.Rab,a,this.AFa),ja.xb(la.a.j7f,a,this.q8b),this.BUd=!0);ja.xb(la.a.AQb,a,this.BQb)}Zfm(a,b,c,f,l,u,I,T,ja,ua,Ra){Ae.a.removeHandler(a,la.a.paste,this.zsc);Ae.a.removeHandler(a,la.a.cut,this.p9d);
Ae.a.removeHandler(a,la.a.copy,this.w6b);this.KKd&&(Ae.a.removeHandler(a,la.a.sae,this.l8b),this.KKd=!1);Ae.a.removeHandler(a,la.a.blur,this.d2d);f.Hb(la.a.click,a,this.xD);I.dG(a,this.cWc);T.Hb(a,this.AD);l.Hb(la.a.f8,a,this.hff);l.Hb(la.a.z3,a,this.gff);c.Hb(la.a.mouseDown,a,this.bkb);c.Hb(la.a.WK,a,this.CRe);b.Wr(a);c.Wr(a);f.Wr(a);l.Wr(a);u.Wr(a);b.Hb(la.a.rm,a,this.jIa);b.Hb(la.a.nz,a,this.ufb);b.Hb(la.a.Vf,a,this.XA);b.Hb(la.a.sEa,a,this.XA);f.Hb(la.a.doubleClick,a,this.Qab);Ae.a.removeHandler(a,
la.a.scroll,this.U2a);this.EJd&&(Ra.Hb(la.a.lZf,a,this.e6b),Ra.Hb(la.a.i6d,a,this.j6d),Ra.Hb(la.a.g6d,a,this.d6b),this.EJd=!1);this.LWd&&(ua.Hb(la.a.fef,a,this.npb),this.LWd=!1);this.DNd&&(ua.Hb(la.a.input,a,this.npb),this.DNd=!1);ja.Hb(la.a.drop,a,this.BFa);this.BUd&&(ja.Hb(la.a.Rab,a,this.AFa),ja.Hb(la.a.j7f,a,this.q8b),this.BUd=!1);ja.Hb(la.a.AQb,a,this.BQb)}static get Xok(){null==Uf.SOd&&(Uf.SOd=A.AFrameworkApplication.fa.getBooleanAppSetting("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));
return Uf.SOd}}Uf.SOd=null;Object(m.a)(Uf,"ContentEditableSurfaceEventHandlers",null,[]);var Jd=d(62),We=d(119),fd=d(859),ui=d(138),bj=d(261);class nf extends vg.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg,yg,ng,Wh,Ai,Wf,gg){super(Wf);this.lKc=null;this.qWc=this.eAb=this.F7b=this.nW=!1;this.$f=a;this.Vc=b;this.Bl=c;this.Hu=I.create(this);this.trb=$f;this.jd=T;this.Zra=gg;u.xa(G.a.n5f,ta.a.application,ff.ActionManager.uh);u.xa(G.a.o5f,ta.a.application,
ff.ActionManager.uh);f.execute(vh=>{vh.w9i(G.a.Nz,Mc.a.duh);vh.p7e(G.a.Nz,Mc.a.source,Pf.s1i)});l&&l.execute(vh=>{vh.ACm(Object(R.a)(this,this.kza,"onZoomChanged"))});this.Io=ua;this.fsa=Ec;this.$Ud=Bb;this.GL=Ra;this.WL=Ub;this.WL.init(this.Na);this.d4=Xb;this.Af=tc;this.Al=eb;this.Vb=ja;this.Vb.init(this.Na);this.Oh=hd;this.X7a=yd;this.Yt=lc;this.N_b=Pd;this.pJ=vf;this.Mr=pe;this.sD=ug;this.CQa=Se;this.gX=Tg;this.Vbi=Ve;this.Wbi=xg;this.sdi=yg;this.Ubi=ng;this.Qja=Wh;this.Tbi=Ai;this.Qja.qyi(Object(R.a)(this,
this.ylh,"onBindEditingDom"));this.Qja.Jyi(Object(R.a)(this,this.Nqh,"onUnbindEditingDom"));this.Qja.Zxi(Object(R.a)(this,this.dyh,"pushViewElementValidationStates"));this.Qja.Yxi(Object(R.a)(this,this.xnh,"onInteractiveViewOnAfterLoadContent"));this.qpf=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("ChromiumEdgeUIPasteForPPTIsEnabled")&&E.a.HDb;this.Trf=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("ElectronClipboardAccessFix")&&E.a.gV}get Xd(){return this.Yf.Xd}dispose(){this.Qja.ZAl(Object(R.a)(this,
this.ylh,"onBindEditingDom"));this.Qja.lBl(Object(R.a)(this,this.Nqh,"onUnbindEditingDom"));this.Qja.OAl(Object(R.a)(this,this.dyh,"pushViewElementValidationStates"));this.Qja.NAl(Object(R.a)(this,this.xnh,"onInteractiveViewOnAfterLoadContent"));this.Ubi.dispose();super.dispose()}kza(){this.yia=!0}get ownerDocument(){const a=this.jd.lva();return a?a.em:null}get container(){return this.EUa}get C6d(){return this.Mo}createElement(a){a=this.ownerDocument.createElement(a);this.jd.Lg.b6h.appendChild(a);
return a}Tp(a){a=Xc.a.createElement(this.ownerDocument,a);this.jd.Lg.b6h.appendChild(a);return a}tEa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");}yTe(){this.Io.raiseEvent(td.a.kfj);this.qWc=!0}get EUa(){return this.jd.Lg?this.jd.Lg.xv:null}get Mo(){return this.jd.hn()}get YDb(){return!0}pUi(){this.d4.RRc()}get G8c(){return this.Mr.aIa}get isComposing(){return this.Mr.isComposing}dkl(){this.qpf||this.Trf?this.N_b.kwh(!0,
""):(this.disable(!1,24),this.vyd(!0),E.a.vy&&(this.EUa.style.overflow="hidden"),this.EUa.style.width="0px",this.EUa.style.height="0px",this.EUa.style.display="block",this.Io.raiseEvent(td.a.zel),this.d4.RRc(),this.WL.lNa(this.Oh.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA))}j9l(){this.qpf||this.Trf?this.N_b.UGh("none"):E.a.vy&&this.EUa&&(this.EUa.style.overflow="none")}Xt(a,b){this.pJ.Xt(a,void 0===b?!1:b)}v_(){this.Yt.v_()}get Nm(){return!0}Zia(a,b){if(1===
this.mode&&17!==a.Zi){const c=a.currentNode;if(!Me.a.instance.Oa.rI&&!c.vEb(Me.a.instance.Oa.Xs)&&6!==a.role)return!1}return super.Zia(a,b)}get PG(){let a=super.PG;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get yyb(){const a=A.AFrameworkApplication.fa.getBooleanAppSetting("EditingViewDelayUpdateFixIsEnabled");return a&&!this.G8c?2:this.root&&this.ownerDocument&&this.isActive&&!this.fsa.W$?a||this.G8c?1:2:3}KZ(a){return this.Wbi.KZ(a)}H2(a){return this.Vbi.H2(a)}I8d(){return new fd.a(this.Na)}DTe(a){!A.AFrameworkApplication.Dh&&
0!==this.mode&&this.Yf&&this.Yf.ep&&(this.MAk(a),this.Vc.zte())}MAk(a){if(a){var b=a.iC;a=this.Tfg(a.Rv,!0);b=this.Tfg(b,!1);da.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}Tfg(a,b){let c="";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",$a.ParagraphReader.ke(a)&&(c+="paraId : "+$a.ParagraphReader.zBb(a)+"; ",c+="hasImage : "+We.a(a,5)+";"),b&&(b=mb.GraphIterator.ob(a),b.wf(),c+="inTable : "+Jd.TableReader.Ft(b)+";"));return c}UUe(a){!A.AFrameworkApplication.Dh&&
1===this.mode&&a&1&&this.Yf&&this.Yf.ep&&this.Vc.GVe()}vyd(a){this.jd.m3a(a)}Afb(a,b,c){this.trb.Afb(a,b,c)}OWc(){this.CQa.OWc()}uTl(){this.$Ud.zag(Me.a.instance.Oa)}qnb(){this.WL.qnb(this.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA)}lNa(){this.WL.lNa(this.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA)}get Pg(){return this.isActive?this.Vb.Pg:null}get mode(){return this.Oh.mode}get isActive(){return this.Af.isActive}get DXa(){return this.Af.Aac(this.Vb.Pg)}get Axe(){return this.Af.Gkg(this.Vb.Pg)}get Yf(){return this.$f.$d}get vWe(){return this.X7a.l_f}get CAa(){return this.CQa.CAa}set CAa(a){this.CQa.CAa=
a}get yia(){return this.Yt.yia}set yia(a){this.Yt.yia=a}get dve(){return!0}get P3e(){return 2}get Dyc(){const a=this.Bl.value.isEditingAllowed||this.Bl.value.eA;return this.Zra.Dyc?a:!0}get aMa(){return this.N_b.aMa}get Zxb(){return this.Al}get dfm(){return this.sD}get t_i(){return this.trb}get w7j(){return this.CQa}get lcl(){return this.gX}hhc(a){return bj.a.$Ig(a,this)}yPb(a){return bj.a.TEh(a,this)}Xvc(a){return bj.a.hFh(a,this)}Epc(a){return bj.a.Wgh(a,this)}Xwb(a){return bj.a.jUf(a,this)}bxc(a){return bj.a.mKh(a,
this)}f$b(a){return bj.a.vdg(a,this)}X3b(a){return bj.a.uQf(a,this)}Fhk(){switch(this.mode){case 2:if(this.Vb.Pg)return this.Ghk(this.Vb.Pg)}return!1}Ghk(a){a=ui.a.ob(this.Na,a.node);return a.Ur&&a.wf()?a.gUa.FZ(510&~this.PG):!0}ylh(a,b){this.ZQf(b.Lg)}Nqh(){this.jd.qfm()}c$j(a,b,c,f){a=this.Tbi.create(a,b,this.Zra);b=new Uf;b.cWc=c;this.sdi.Rgl(b);a.initialize(b,f);return a}ZQf(a){this.jd.lIi(a,this)}disable(a,b){this.Oh.ica(0,a,b)}r4a(){this.Oh.r4a()}suspend(){this.fsa.suspend()}resume(){this.fsa.resume()}dyh(a,
b){this.$f.$d===b.Yf&&(this.lKc=this.aPa,this.aPa=new Md.a(0))}Fgl(){const a=this.lKc,b=this.aPa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.aPa=a;this.lKc=null}wXf(){this.lKc=null}A$e(a){return 1!==this.mode||a.Hz||this.Yf.Rb.Oa.rI?!1:!0}Bye(a,b){return this.Yf.Rb&&!this.Yf.Rb.Oa.rI&&b?a.Hz!==b.Xxe:!0}xnh(a,b){this.$f.$d===b.Yf?this.Fgl():this.$f.$d||this.wXf()}}Object(m.a)(nf,"ContentEditableView",vg.a,[418,262,106,619]);class ki{constructor(a,b,c,f,
l,u){this.yd=a;this.sg=b;this.Qj=c;this.Np=f;this.$f=l;this.Cs=u}GAg(a){return Sys.UI.DomElement.containsCssClass(a,fc.a.XZf)}}Object(m.a)(ki,"ContentEditableViewContentControlHelper",null,[160]);var qf=d(408),be=d(129),Ud=d(118),Ei=d(860);class ei{constructor(a,b,c,f,l){this.c6b=!1;this.yWe=this.Fqd=-1;this.DG=a;this.qte=b;this.hQc=c;this.wWa=f;this.u1a=l}}Object(m.a)(ei,"ActiveContentSpan",null,[]);class Aj{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se){this.Fja=this.hXb=
null;this.aaa=!1;this.jGf=0;this.$Jd=Pd;this.$f=a;this.yd=b;this.sg=c;this.Qj=f;this.Vc=l;this.Bf=u;this.JL=I;this.Oh=T;this.Vb=ja;this.Bl=ua;this.Kra=Ra;this.Af=eb;this.je=Bb;this.Ed=Ub;this.Gj=Xb;this.Np=tc;this.Wh=lc;this.GL=Ec;this.jd=hd;this.JE=yd;this.PB=Se}get gfa(){return this.Fja||(this.Fja=Tb.a.instance.ub("Box4.IFormatPainter"))}mIi(a){this.hXb=a}get uUh(){return this.jGf}X8i(a,b,c){const f=this.$f.$d;if(!f)return!1;f.zUe();if(2!==this.Oh.mode)return this.yd.kc("PossibleFocusWeirdness",
{["Reason"]:"ClickOnHiddenEditingFrame"}),this.sg.be++,!1;if(this.Qj&&b)return this.yd.kc("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.sg.bf++,!0;if(3!==a.wg&&a.xB===Sys.UI.MouseButton.rightButton&&this.Ed.jg)return ad.App.Ob.Bca.Aoj(a.hc.rawEvent),!0;if(!f)return!1;b=f.qma(a);if(3===a.wg){var l=this.Vc.Oa.kb;if(this.Bf.uy(l)){var u=l.Ua.node.vg(f.Na);l=this.PB?this.PB.LTa(l.Ua,!0):l.Ua.Ra;u=ha.a.AX(l,u,!!l,!1,!1);u=new Sys.UI.Bounds(u.x-7,u.y,14,u.height);if(qf.a.Krd(b,
u))return ad.App.Ob.Q7(b,3),!0}}if(!c)return!0;this.Gj.e4f(this.Oh,this.Vb);F.FocusManager.eO()&&(F.FocusManager.instance().Df(f.WJ),this.GL.setFocus(this.Oh.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA));(c=ig.a(a.Ec))?(this.hXb.Xt(!0),f.i8(a.clientPoint,c,c.eb,f,a.hc.rawEvent.shiftKey,a.I0,a.wg)):f.i8(b,null,null,f,a.shiftKey,a.I0,a.wg);this.gfa&&this.gfa.JM&&this.Kra.nb(G.a.hfa,2);this.hXb.Afb(a.shiftKey,b,a.wg);f.VTe(new Ei.a(a));this.Ed.OD&&(a=new ne.a(0,
1,0,()=>{this.Af.yNa(!0);this.$9b()},27),this.je.Jb(a));return!0}cdf(a,b){b=void 0===b?!1:b;if(2===this.Oh.mode&&this.Vb.ui){var c=this.jd.Lg.xv;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.Ed.txe){c=this.Vc.Oa.kb;var f=!!this.JL&&this.JL.Ndb();this.Qj&&a?(this.yd.kc("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.sg.bm++):(this.uPl(b||f,this.Vb.ui.qu,this.Vc.Oa.kb.Ua),f&&this.JL.xdf(c))}}}uPl(a,b,c){let f=0,l=0;c=c.Ra;let u=!1;for(let I=0;I<b.length;I++){const T=
b[I],ja=this.Np.cK(T,this.sg,this.yd,this.Qj);if(Sys.UI.DomElement.containsCssClass(T,ia.a.wX))f+=ja;else if(u||(this.jGf=f,u=!0),Sys.UI.DomElement.containsCssClass(T,fc.a.AO))c--,f+=ja,l++;else{if(c<=ja){a||this.Gj.MU(f+c,this.Vb.ui);this.kyd(b,I,f,l,c);break}c-=ja;f+=ja;l+=ja}}}$9b(){if(2===this.Oh.mode){var a=this.Gj.e$(this.Oh.mode,this.Vb.tj),b=0,c=0,f=this.Vb.ui.qu,l;for(l=0;l<f.length;l++){const u=this.Np.cK(f[l],this.sg,this.yd,this.Qj),{I5:I,gna:T,CDb:ja}=this.FRi(f,l);if(a<=u&&this.fpj(f,
l,a,I,T,b,c,ja))return;a-=u;b+=u;I?c++:ja||(c+=u)}this.yd.kc("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.sg.bq++}}fpj(a,b,c,f,l,u,I,T){const ja=a[b],ua=this.Np.cK(ja,this.sg,this.yd,this.Qj);if(f||this.Qj&&l)if(l||!this.aaa&&c!==ua){if(this.sg.bo++,this.Gj.MU(u,this.Vb.ui),c=this.Np.cK(a[b-1],this.sg,this.yd,this.Qj),this.kyd(a,b-1,u-c,I-c,c),l)return!0}else this.sg.bn++,this.Gj.MU(u+ua,this.Vb.ui),this.kyd(a,b+1,u+ua,I+1,0);else if(!T)return Aa.a.yy(za.a.zw(ja),c)&&
(this.sg.bp++,this.Gj.MU(u+c+(this.aaa?1:-1),this.Vb.ui)),this.kyd(a,b,u,I,c),!0;return!1}FRi(a,b){const c=Sys.UI.DomElement.containsCssClass(a[b],fc.a.AO),f=Sys.UI.DomElement.containsCssClass(a[b],ia.a.wX);a=Sys.UI.DomElement.containsCssClass(a[b],fc.a.OO);return{I5:c,gna:a,CDb:f}}kyd(a,b,c,f,l){const u=this.Vb.NX,I=a[b];Sys.UI.DomElement.containsCssClass(I,fc.a.OO)&&(da.ULS.shipAssertTag(4318915,315,!1),this.yd.kc(be.a.C3,{["Reason"]:Ud.a.a$f}));Sys.UI.DomElement.containsCssClass(I,fc.a.AO)&&(da.ULS.shipAssertTag(4318916,
315,!1),this.yd.kc(be.a.C3,{["Reason"]:Ud.a.cRf}));a=this.R4i(a,b,c,f,l,u);b=a.length!==this.Wh.pj.length;for(c=0;!b&&c<this.Wh.pj.length;)this.Wh.pj[c].DG!==a[c].DG&&(b=!0),this.Wh.pj[c].u1a!==a[c].u1a&&(b=!0),c++;b&&(this.hXb.DXa&&this.hXb.Xt(!0),this.Wh.pj=a)}R4i(a,b,c,f,l,u){const I=a[b];var T=this.Np.cK(I,this.sg,this.yd,this.Qj);const ja=[];let ua=null;b<a.length-1&&l===T&&(ua=a[b+1]);var Ra=null;0<b&&!l&&(Ra=a[b-1]);a=this.$Jd.Ie(I,ia.a.nIa);a=u.qu[a];Array.add(ja,new ei(I,a,c,f,T-(this.JE.c9?
1:0)));!ua||Sys.UI.DomElement.containsCssClass(ua,fc.a.OO)||Sys.UI.DomElement.containsCssClass(ua,fc.a.AO)?!Ra||Sys.UI.DomElement.containsCssClass(Ra,fc.a.OO)||Sys.UI.DomElement.containsCssClass(Ra,fc.a.AO)||Sys.UI.DomElement.containsCssClass(Ra,ia.a.wX)||(a=this.$Jd.Ie(Ra,ia.a.nIa),a=u.qu[a],T=this.Np.cK(Ra,this.sg,this.yd,this.Qj),Array.insert(ja,0,new ei(Ra,a,c-T,f-T,T))):(a=this.$Jd.Ie(ua,ia.a.nIa),a=u.qu[a],Ra=this.Np.cK(ua,this.sg,this.yd,this.Qj),Array.add(ja,new ei(ua,a,c+T,f+T,Ra)));return ja}}
Object(m.a)(Aj,"ContentEditableViewCursorManager",null,[617]);class tj{}Object(m.a)(tj,"ContentEditableViewDebugLogger",null,[]);class Pi{constructor(a,b,c,f,l,u,I){this.Esa=a;this.sD=b;this.Wh=c;this.NFc=f;this.sg=l;this.bda=u;this.Oh=I}dispose(){this.Esa.jXf();this.sD.dispose();this.Wh.WWf();this.NFc.Uxd();cd.a.instance.izk(this.sg);this.bda.raiseEvent(Ig.a.mBk);this.Oh.dispose()}}Object(m.a)(Pi,"ContentEditableViewDisposer",null,[]);class Eh{constructor(){this.AVc=!0}Afb(a,b,c){a&&(this.AVc=!1,
ad.App.Ob.Q7(b,c))}}Object(m.a)(Eh,"ContentEditableViewFloatieHandler",null,[615]);var Th=d(1150),Qi=d(146);class fi{constructor(a,b,c,f,l,u,I){this.byf=0;this.D7c=this.udc=this.fpe=this.jpe=!1;this.jd=a;this.$f=b;this.JL=c;this.Qj=f;this.er=l;this.DId=u;this.Wd=I}IIi(){this.Qj&&!this.udc&&100<(new Date).getTime()-this.byf&&(Qi.GrippersManager.instance.Rcc=!0,this.D7c=!1)}setFocus(a,b,c,f,l){const u=this.$f.$d;this.byf=(new Date).getTime();this.JL&&this.JL.Ndb()||(1===a?this.pQl(l):this.Qj&&!this.er.lpe&&
Ie.EventHandlerManager.instance.l$f!==la.a.click||!this.jd.Lg.oob||(l=new Th.a(u),this.jd.Lg.VDd(),this.Qj&&(this.udc=!0,this.jd.hn().blur(),this.udc=!1),this.jd.Lg.k_h(),c&&f&&""!==b.innerText&&b.focus(),this.DId.S$&&(this.D7c=!0),l&&l.dispose(),this.DId.Gk&&0!==a&&(this.jd.Lg.oob=!1)))}pQl(a){if(!this.Qj||a){a=null;E.a.Gk&&(a=new Th.a(this.$f.$d));this.jd.Lg.oob&&(this.jd.Lg.VDd(),this.jd.Lg.k_h(),E.a.Gk&&(this.jd.Lg.oob=!1),this.DId.S$&&this.er.lpe&&(this.D7c=!0));var b=this.jd.hn();this.jd.Lg.oob&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}phj(a){2!==a&&1!==a||this.jd.Lg.VDd()}Cve(){const a=this.Wd.Je;return!!a&&this.$f.$d.WJ===a.name}}Object(m.a)(fi,"ContentEditableViewFocusHelper",null,[616]);class Ng{constructor(a,b,c){this.cdc=a;this.Jlb=b;this.Lta=c}}Object(m.a)(Ng,"GraphUpdateState",null,[]);var $d=d(52),Qf=d(107);class Cg{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg,yg,ng){this.jf=this.MWb=null;this.lm=
yg;this.Cs=xg;this.vja=a;this.Oh=b;this.yd=c;this.Vc=f;this.JL=l;this.Bf=u;this.Af=I;this.OL=T;this.Vb=ja;this.Al=ua;this.JE=Ra;this.Wh=eb;this.jd=Bb;this.PW=Ub;this.DT=Xb;this.fsa=tc;this.X_=lc;this.pka=hd;this.Gj=yd;this.X7a=Pd;this.Yt=pe;this.sg=Se;this.M8=vf;this.je=ug;this.Ed=Tg;this.Oja=$f;this.j$h=Ve;this.Ch=Ec;this.JA=ng}sU(a){this.jf=a}get W2c(){const a=this.X_.kva(this.PW.aaa);return a?a.Ua.Ra:0}get mJi(){return this.W2c}Xt(a,b){b=void 0===b?!1:b;da.ULS.shipAssertTag(18437283,315,!!this.Ch);
if(this.jf.DXa||this.jf.Axe)if(this.jf.dfm.KOa(),this.jf.isActive&&2===this.Oh.mode&&(this.jf.DXa||this.jf.Axe)){var c=this.yd.Cq(G.a.Xt);this.vja.bL(()=>{this.rim(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}CQl(a,b){const c=this.Bf.DA;this.Vc.setSelection(a,void 0,void 0,void 0===b?!1:b);this.Bf.DA=c}rim(a,b){b=void 0===b?!1:b;Qf.c(36226527,306,100,"UpdateGraphInternalCalled");this.Af.vFl();if(this.Vb.ui){a=new Ng(!1,a,!1);a.Jlb&&this.fsa.suspend();this.pka.fAb();var c=this.OL.SVa();
c.set(this.Vb.Pg.node);var f=this.lm.xe(b?12:15,G.a.Xt);f.Wc=this.Al.G4?G.a.rEa:G.a.Nz;f.Jz(c);this.JE.FYl(a.Jlb,this.jf.G8c,this.Wh)&&(this.sg.v++,this.JE.Pnb(!1,this.Vb.tj,this.Wh));var l=!!this.JL&&this.JL.Ndb(),u=l?Me.a.instance.Oa.kb:this.xTi();this.Gfl(a);this.qjm();this.rerenderWhenNeeded(b,a,c);l||this.qpj(b,u);this.Wh.WWf();f.dispose();this.P7l(a);this.Yt.yia&&(this.Yt.v_(),this.Yt.yia=!1);a.Jlb&&this.fsa.resume();this.Al.d3();Qf.c(18437313,306,100,"UpdateGraphInternalExited")}else da.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}P7l(a){a.cdc||this.PW.cdf(this.Al.Ufa,a.Lta)}rerenderWhenNeeded(a,b,c){!b.cdc||this.Al.HGg()||a||(this.Oh.ica(0,!0,5),b.Jlb&&(this.fsa.resume(),b.Jlb=!1),this.$dc(c.currentNode))}xTi(){this.Gj.kUb(this.Oh.mode,this.Vb.tj);this.X7a.Ohf();this.DT.Toj(this.jd.hn(),this.yd);return this.X_.kva(this.PW.aaa)}qpj(a,b){const c=this.Cs.textLength(b.Ua.node);b.Ua.Ra>c&&(b=$d.SelectionFactory.fh(b.Ua.node,c));this.CQl(b,a);a=!!this.JL&&
this.JL.VDb(b);this.Al.HGg()&&!a&&this.Gj.MU(this.Gj.xYa,this.Vb.ui)}$dc(a){U.a.instance.ga(70)&&ad.App.tT.$dc(a)}qjm(){if(U.a.instance.ga(2)){const a=jb.OutlineElementNavigator.qC(this.jf.Pg);a&&Kc.ListReader.PXa(a)}}S9d(){if(this.jf.DXa||this.jf.Axe)this.MWb?this.je.G7(this.MWb,Cg.f4f):(this.MWb=new ne.a(0,1,Cg.f4f,Object(R.a)(this,this.E$i,"delayUpdateGraphCallback"),26),this.je.Jb(this.MWb))}E$i(){this.MWb=null;this.Vb.vYa(this.Oh.mode)&&this.Xt(!0)}iAl(){let a;if(this.Al.G4){var b=this.W2c;a=
this.Al.nTc}else if(this.Al.oua)b=this.W2c,a=b+(this.Al.NCd-za.a.zw(this.Vb.bUa).length);else return;if(b===a)this.yd.kc("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{da.ULS.shipAssertTag(18437315,315,b<=a);var c=this.Cs.text(this.jf.Pg),f="";this.Cs.IVa(this.jf.Pg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=jc.LMb;this.lUi(this.jf.Pg);b=me.a.createTextRange(this.jf.Pg,b,a);this.Ch.replaceTextRange(b,f,void 0,void 0,
G.a.P1d)}}lUi(a){U.a.instance.ga(70)&&this.JA.ORc(a)}Gfl(a){let b=!0;if(this.M8.Swg)this.M8.Bgj();else{const c=1<this.jd.hn().childNodes.length;a.cdc=this.DT.AEd();if(a.cdc||this.Al.oua||this.Al.G4){a.cdc&&this.sg.w++;c&&(this.yd.kc("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.sg.x++,b=!1);if(this.Al.G4||this.Al.oua)this.iAl(),this.DT.iwc(),b=!1;a.Jlb&&(this.yd.kc("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),this.sg.z++,this.fsa.resume(),a.Jlb=!1);
this.Wh.wTi(this.Vb.ui)}}a.Lta=!0;b&&(a.Lta=this.j$h.Ffl(this.Vb.Pg,this.Vb.tj,this.Vb.ui,this.Ch,this.Oja.instance))}}Cg.f4f=250;Object(m.a)(Cg,"ContentEditableViewGraphUpdater",null,[]);var rh=d(442),ge=d(59);class bi{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve){this.jf=null;this.aIg=0;this.jzf=!1;this.Ma=a;this.Oh=b;this.Vb=c;this.$f=f;this.jd=l;this.rja=u;this.Yt=I;this.JE=ja;this.Ed=ua;this.sg=Ra;this.Cs=eb;this.Wh=Bb;this.DT=Ub;this.MWd=Xb;this.Esa=
tc;this.GL=lc;this.X7a=Ec;this.Vc=hd;this.Qj=yd;this.WL=Pd;this.Bl=pe;this.Al=Se;this.Io=vf;this.OL=ug;this.ZRa=Tg;this.Ida=$f;this.kd=Ve}sU(a){this.jf=a}t2k(a){this.Ma.raiseEvent(pf.eventId,new pf(a.dO,this.jf.nW),this.jf);if(1===this.Oh.mode)return this.u2k(a);if(0===this.Oh.mode||!this.Vhm(a))return!1;this.JE.kXf();if(this.Uhm())return!0;this.mpj();this.Esa.GUh(this.Vb.ui);this.kpj();!this.jzf&&this.Vb.ui&&0<this.Vb.ui.kCd&&(this.jzf=!0);this.kd&&this.kd.isFeatureEnabled(84)&&this.$Eh(this.Vb.ui);
this.X7a.Ohf();this.Ida.SOb(Object.assign(new rh.a,{Fyc:!0}));this.kd&&this.kd.isFeatureEnabled(84)||this.$Eh(this.Vb.ui);return!0}$Eh(a){a&&a.kCd&&(this.ZRa?this.ZRa.NCm(a,!0):da.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}Vhm(a){if(!this.Vb.Pg)return!1;this.Vb.ui=this.Vb.Pg.sc(this.jf.Na);this.Vb.ui||da.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Vb.NX=this.Vb.Pg.sc(this.$f.$d.Na);if(!this.Vb.NX)return!1;this.jd.Lg.MSe(this.Vb.NX);const b=
this.jd.hn(),c=this.Vb.bUa;(b?b.firstChild:null)!==c&&c&&(za.a.qw(b),b.appendChild(c),Object(Nb.a)("FidelityLineBreakIssueTelemetryAddition")&&this.Io&&this.Io.raiseEvent("OnParagraphElementAttachedToEditingElement"));if(!a.dO&&!this.jf.qWc){this.jf.nW&&this.rja.cdf(this.Al.Ufa);this.jf.nW=!1;if(this.Yt.yia||!a.SLa)this.Yt.v_(),this.Yt.yia=!1;return!1}this.jf.qWc&&(this.jf.qWc=!1,this.jf.eAb=!0);return!0}kpj(){this.Yt.v_();if(this.jf.eAb){this.GL.setFocus(this.Oh.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,
this.Bl.value.isEditingAllowed||this.Bl.value.eA);if(this.Ed.jg){const a=this.jd.hn(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.sg.bv++,a.removeChild(b))}this.jf.eAb=!1}this.rja.cdf(this.Al.Ufa)}mpj(){if(this.Ed.jg){var a=this.jd.hn();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.sg.bu++,a.removeChild(b))}this.Ed.VSb||(a=this.OL.Pc(this.Vb.Pg),this.Cs.isEmpty(a)&&!this.Cs.jve(a)&&this.JE.Pnb(!0,this.Vb.tj,this.Wh));this.MWd.value.U5b(this.jd.hn(),this.jd.contentWindow);this.DT.iwc()}Uhm(){var a=
this.Vb.NX;const b=this.jd.hn().style;if(this.jf.eAb){if(!a)return!0;a=this.Vb.ui.htmlElement;this.Yt.YQh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Vb.mua=this.Kmk();return!1}Kmk(){return ge.OutlineElementReader.kn(jb.OutlineElementNavigator.qC(this.Vb.Pg.node))}Tu(a){return fg.a.Tu(a)}u2k(a){if(!this.Vc.Oa||!this.Vc.Oa.kb)return da.ULS.sendTraceTag(19711041,324,15,"Attempt to validate selection with empty selection."),!1;if(!this.jf.nW&&(!a.dO||ad.App.Yte&&
a.SLa))return this.Yt.yia&&(this.Yt.jWh(this.jf.Na),this.Yt.yia=!1),!1;this.jf.nW=!1;a=(new Date).getTime();const b=this.Vc.qra;!this.Qj&&!b.Cwe&&!b.vye&&250<a-this.aIg?this.b4f(null):(this.Io.raiseEvent(td.a.v0k),b.RRl(Object(R.a)(this,this.b4f,"delayOnAfterValidateSelection")));return!0}b4f(){1===this.Oh.mode&&(this.Vc.Oa.bga&&this.Vb.Pg&&(this.Vb.ui=this.Vb.Pg.sc(this.jf.Na),this.Vb.ui||da.ULS.sendTraceTag(18437327,324,15,"current editing view element is set to null!"),this.Vb.NX=this.Vb.Pg.sc(this.$f.$d.Na)),
this.Vc.Oa.bga&&this.jd.hn().firstChild!==this.Vb.bUa&&this.Vb.bUa&&(za.a.qw(this.jd.hn()),this.jd.hn().appendChild(this.Vb.bUa)),this.jd.hn().firstChild&&(this.Vc.Oa.bga?this.jd.hn().style.direction=this.Tu(this.jd.hn().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.jd.hn().firstChild,"Rtl")?this.jd.hn().style.direction="rtl":this.jd.hn().style.direction="ltr",this.Vc.Oa.bga&&this.Esa.GUh(this.Vb.ui),this.Yt.jWh(this.jf.Na),this.WL.qnb(this.Oh.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,
this.Bl.value.isEditingAllowed||this.Bl.value.eA)),this.aIg=(new Date).getTime(),this.Io.raiseEvent(td.a.yoj))}H2(a){const b=this.t2k(a);this.Io.raiseEvent(!a.dO||ad.App.Yte&&a.SLa?td.a.TOc:td.a.Hsh);return b}}Object(m.a)(bi,"ContentEditableViewOnAfterValidateHandler",null,[]);class Og{constructor(a,b,c,f,l){this.jf=null;this.Yt=a;this.Mr=c;this.jd=f;this.Io=l}sU(a){this.jf=a}KZ(a){const b=this.jf.yyb;let c=3===b;c||2!==b||(this.jf.root.Soe(510),c=!0,this.Yt.v_());if(c)return a.cancel=!0,!1;this.Io.fpl(a);
return!1}}Object(m.a)(Og,"ContentEditableViewOnBeforeValidateHandler",null,[]);class Ki{constructor(a,b,c,f,l){this.c9=!1;this.OCa=null;this.Io=a;this.yd=b;this.sg=c;this.jd=f;this.xDf=l}kXf(){this.c9=!1}Pnb(a,b,c){const f=this.jd.lva();a&&(this.c9=za.a.zw(b)!==ia.a.GWc);if(a&&!this.c9){for(b=this.jd.hn();b.firstChild;)b=b.firstChild,this.xDf&&Sys.UI.DomElement.containsCssClass(b,fc.a.tOa)&&Sys.UI.DomElement.addCssClass(b,fc.a.CWe);3!==b.nodeType?(this.OCa=f.em.createTextNode(jc.LMb),b.appendChild(this.OCa)):
(this.OCa=b,this.OCa.nodeValue=jc.LMb);this.c9=!0;this.Io.rzh(!0)}if(!a&&this.c9){a=this.OCa;b=null;try{b=this.OCa.parentNode,b||""!==a.nodeValue||(this.OCa=null)}catch(l){this.sg.i++,this.OCa=null}this.OCa&&b!==f||(this.yd.kc("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.sg.j++,c.pj.length&&(a=this.ocg(c.pj[c.pj.length-1].DG)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(jc.LMb))){if(this.xDf)for(c=a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,
fc.a.CWe)){Sys.UI.DomElement.removeCssClass(c,fc.a.CWe);break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.c9=!1;this.Io.rzh(!1)}}FYl(a,b,c){return!this.c9||a||(E.a.WD&&!E.a.Fk||E.a.TG)&&!b?!1:c.eJf()}ocg(a){if(a.className===fc.a.OO)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.ocg(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&(b=a.nodeValue,b.endsWith(" ")||b.endsWith(jc.LMb)))return a;return null}}Object(m.a)(Ki,"ContentEditableViewPaddingManager",
null,[612]);class sk{constructor(a){this.X9d=this.gef=this.oua=this.G4=!1;this.f$c=this.NCd=this.nTc=-1;this.XNd=!1;this.mze=0;this.Kra=a}get Ufa(){return this.XNd}set Ufa(a){a!==this.XNd&&this.Kra.nb(a?G.a.n5f:G.a.o5f,2);this.XNd=a}HGg(){return this.gef||this.oua||this.G4}d3(){this.X9d=this.gef=this.oua=this.G4=!1;this.f$c=this.NCd=this.nTc=-1}}Object(m.a)(sk,"ContentEditableViewTypingState",null,[]);class kk{constructor(a,b,c,f,l,u,I){this.Gj=a;this.sg=b;this.yd=c;this.Np=f;this.Af=l;this.Vb=u;
this.Qj=I}kva(a){if(!this.Vb.ui||1===this.Af.mode&&!this.bga())return null;const b=this.Gj.e$(this.Af.mode,this.Vb.tj);let c=b,f=0;const l=this.Vb.ui.qu;let u,I=!1;for(u=0;u<l.length;u++){var T=l[u];if(!this.Np.yBg(T)){I=!0;continue}const ja=this.Np.cK(T,this.sg,this.yd,this.Qj),ua=Sys.UI.DomElement.containsCssClass(T,fc.a.AO);T=Sys.UI.DomElement.containsCssClass(T,ia.a.wX);if(c<=ja)return ua?c=a||c===ja?1:0:T&&(c=0),this.fh(this.Vb.Pg,f,c);c-=ja;ua?f++:T||(f+=ja)}return I?this.fh(this.Vb.Pg,0,b):
this.fh(this.Vb.Pg,0,0)}fh(a,b,c){return $d.SelectionFactory.fh(a,b+c)}bga(){return Me.a.instance.Oa.bga}}Object(m.a)(kk,"CurrentEditSelectionProvider",null,[611]);class Nj{constructor(a,b,c){this.uVb=[];this.uNc=null;this.yd=a;this.cU=b;this.MWd=c}get pj(){return this.uVb}set pj(a){this.uVb=a}eJf(){return this.uVb.length?1<this.uVb.length||1<this.uVb[0].DG.innerText.length:!1}qdg(a,b,c){const f=ca.a.Ie(a,ia.a.nIa),l=b?a.firstChild:a.lastChild;let u=null;b&&0<f?u=c.qu[f-1]:!b&&f<c.qu.length&&(u=c.qu[f+
1]);if(u)for(this.yd.kc("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),this.cU.u++,a.removeChild(l),b?u.appendChild(l):u.insertBefore(l,u.firstChild),a=0;a<this.pj.length;a++);}wTi(a){for(let b=0;b<this.pj.length;b++){const c=this.pj[b].DG;E.a.WD&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.qdg(c,!0,a):3===c.lastChild.nodeType&&this.qdg(c,!1,a));za.a.yA(c,c.innerText)}}i0k(a){for(let b=0;b<this.pj.length;b++)this.MWd.U5b(this.pj[b].DG,a)}Oyl(){for(let a=
0;a<this.pj.length;++a){const b=this.pj[a].DG;if(Sys.UI.DomElement.containsCssClass(b,fc.a.pUc)||Sys.UI.DomElement.containsCssClass(b,fc.a.nUc)||Sys.UI.DomElement.containsCssClass(b,fc.a.mUc)||Sys.UI.DomElement.containsCssClass(b,fc.a.oUc)){const c=this.pj[a].u1a;c&&c!==b.innerText.length&&(b.className=fc.a.h7b)}}}UVk(a,b){for(let c=0;c<this.pj.length;c++){const f=this.pj[c],l=a<=f.wWa,u=f.wWa+f.u1a,I=u<=b;f.Fqd=l?f.wWa:a;f.yWe=I?u:b;l&&I&&(f.c6b=!0)}}WWf(){Array.clear(this.pj)}}Object(m.a)(Nj,"CurrentlyActiveContentSpans",
null,[607]);class rl{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.bKd=!1;this.Bf=a;this.Vc=b;this.yd=c;this.Af=f;this.Io=l;this.$f=u;this.Wh=I;this.Vb=T;this.Ed=ja;this.WL=ua;this.Bl=Ra;this.ZBa=eb;this.YVb=Bb;this.Mci=Ub;this.Kk=Xb;this.jd=tc;this.Ca=Ec;this.zd=hd;this.Cgi=lc.getBooleanAppSetting("ChromeSingleTextRunCopyImprovementIsEnabled");this.OYb=lc.getBooleanAppSetting("PasteKeepSourceFontSizeFixIsEnabled");this.Xgi=(this.Wli=lc.getBooleanAppSetting("ProtectInClient"))||
lc.getBooleanAppSetting("ProtectedFile");this.Lgi=lc.getBooleanAppSetting("EnableExtractForProtectedFile");this.wYb=lc?lc.getBooleanAppSetting("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.bZb=lc?lc.getBooleanAppSetting("TextLayoutServiceUseResponse"):!1;this.eEf=this.dEf=!1}get F0(){return this.ZBa.instance}get mfb(){return this.zd.Gg&&this.zd.wD}esg(a,b,c,f){this.Vjl(a,b,c,f)}Vjl(a,b,c,f){this.Xgi&&!this.Lgi?a.preventDefault():!b||this.Bl.value.isEditingAllowed||this.Bl.value.eA&&this.mfb?
1!==this.Af.mode||this.bKd||!c||f||(this.F0?b&&!this.Bf.H6c(this.Vc.Ik)?(da.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.yd.kc(be.a.ei,{["Reason"]:Ud.a.q9d}),this.YVb.show(),a.preventDefault()):(this.Vc.qra.Ree(),this.bKd=!0,b&&this.Io.raiseEvent(td.a.d9i),E.a.$Ha&&a.rawEvent&&a.rawEvent.currentTarget&&this.wYb&&this.Kk.Gvd(a.rawEvent.currentTarget,"data-src","data-srcurl"),this.Ed.Fk&&this.Cgi&&this.apj(a),this.OYb&&(this.dEf=this.Xoj(a)),this.bZb&&(this.eEf=this.Czl(a)),a=this.Mci.create(null,
Object(R.a)(this,this.zcj,"dispatchCutCopy"),b),a.Fm("Browser "+(b?"Cut":"Copied")),a.Lh()):(da.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.XAe(b?G.a.cut:G.a.copy),a.preventDefault())):a.preventDefault()}apj(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.ige();({w7b:c}=this.Kk.$Zh(c));c&&(a.preventDefault(),b.setData("text/html",Ac.c(c)),b.setData("text/plain",c.innerText))}}Xoj(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:
null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=this.Kk.WLa(c),this.Kk.a5b(a,this.$f.$d.Xd,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.Kk.a5b(a.rawEvent.currentTarget,this.$f.$d.Xd,!0)}Czl(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();a=c&&0<c.length?this.Kk.WLa(c):a.rawEvent.currentTarget;if(this.Kk.YEd(a,!1))return b.setData("text/html",Ac.c(a)),b.setData("text/plain",a.innerText),
!0}return!1}ige(){if(this.Ed.oT){const a=this.jd.lva();if(a&&a.em)return a.em.getSelection()}return null}zcj(a,b){this.bKd=!1;if(this.$f.$d.ep&&1!==A.AFrameworkApplication.za.state){if(b){if(this.Ed.jg){for(b=0;b<this.Wh.pj.length;b++){const c=this.Wh.pj[b].DG,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.WL.lNa(this.Af.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA)}this.F0.nJi(a)}else this.F0.lJi(a);E.a.$Ha&&this.wYb&&
this.$f&&this.Kk.Gvd(this.$f.$d.Lg.Mo,"data-srcurl","data-src");this.OYb&&this.dEf&&this.$f&&this.$f.$d&&this.Kk.a5b(this.$f.$d.Lg.Mo,this.$f.$d.Xd,!1);this.bZb&&this.eEf&&this.$f&&this.$f.$d&&this.Kk.YEd(this.$f.$d.Lg.Mo,!0)}}}Object(m.a)(rl,"CutCopyHandler",null,[606]);class cj{constructor(a,b,c,f,l,u,I,T){this.Ed=a;this.Oh=b;this.Mr=c;this.yd=f;this.Af=l;this.Rja=u;this.Yt=I;this.pub=T}l8b(a,b){this.Ed.jg&&2===this.Oh.mode&&b&&this.Mr.isComposing&&(a=this.yd.Cq(G.a.Nz),a.properties.$(Mc.a.source,
"DomChange"),this.Wdj(),a.end())}Wdj(){this.pub||this.Af.kca(!0);this.Rja.iLb();this.Yt.v_()}}Object(m.a)(cj,"DomChangeEventProcessor",null,[]);class bh{constructor(a,b,c,f){this.Gj=a;this.Oh=b;this.Vb=c;this.$f=f}Dkb(a,b){if(!b)return!1;this.Gj.e4f(this.Oh,this.Vb);return this.$f.$d?this.$f.$d.Dkb(a):!1}}Object(m.a)(bh,"DoubleClickProcessor",null,[]);class vi{constructor(a,b,c){this.Ed=a;this.Wrb=b;this.YKd=c}AFa(){this.Wrb.sab=!0;return!1}q8b(){return this.Wrb.sab=!1}BFa(a){this.Wrb.sab=!1;this.YKd.cancelEventAndRestoreEditingSurface(a.hc);
return!0}}Object(m.a)(vi,"DragEventsProcessor",null,[]);class xh{constructor(a){this.Frf=0;this.XJd=!1;this.Ed=a}get sab(){return this.XJd}set sab(a){this.XJd=a;window.clearTimeout(this.Frf);this.XJd&&(this.Frf=window.setTimeout(Object(R.a)(this,this.j2k,"onAfterDragInactivity"),1E3))}j2k(){this.sab=!1}}Object(m.a)(xh,"DragStateManager",null,[]);class hh extends cb{constructor(){super();this.Zih=this.S1k=0}}Object(m.a)(hh,"SetModeEditEventArgs",cb,[]);class zf extends cb{constructor(){super();this.updates=
null;this.qBa=new La.a}}Object(m.a)(zf,"BeforeValidateEditEventArgs",cb,[]);class Yh{constructor(){this.$Ll=this.Xdj=null}}Object(m.a)(Yh,"EditStateFactoryManager",null,[]);class Oa extends cb{constructor(){super();this.keyCode=this.charCode=0;this.cBg=this.Rlk=this.isComposing=!1}}Object(m.a)(Oa,"KeyDownEditEventArgs",cb,[]);class sb extends cb{constructor(){super();this.charCode=0;this.isComposing=!1}}Object(m.a)(sb,"KeyPressEditEventArgs",cb,[]);class Pb extends cb{constructor(){super();this.B1j=
!1}}Object(m.a)(Pb,"PaddingChangedEventArgs",cb,[]);class kc{constructor(a){this.Ma=new uc.a;this.r6a=Object.assign(new Yh,{Xdj:()=>a.hn(),$Ll:()=>Sd.a.oGa(a.contentWindow)})}addHandler(a,b){this.Ma.addHandler(a,b)}removeHandler(a,b){this.Ma.removeHandler(a,b)}raiseEvent(a){this.Ma.raiseEvent(a,Object.assign(new cb,{Uab:this.r6a}))}Zql(a,b){0===a&&0===b||this.Ma.raiseEvent(td.a.GRl,Object.assign(new hh,{S1k:a,Zih:b,Uab:this.r6a}))}fpl(a){this.Ma.raiseEvent(td.a.QHi,Object.assign(new zf,{Uab:this.r6a,
updates:a.updates,qBa:a.qBa}))}szh(a){a.Uab=this.r6a;this.Ma.raiseEvent(td.a.Hsh,a)}i1e(a,b){this.Ma.raiseEvent(td.a.nz,Object.assign(new sb,{charCode:a.hc.charCode,isComposing:b,Uab:this.r6a}))}h1e(a,b,c,f){f=void 0===f?!1:f;this.Ma.raiseEvent(td.a.Vf,Object.assign(new Oa,{charCode:a.hc.charCode,keyCode:a.hc.keyCode,isComposing:b,Rlk:c,cBg:f,Uab:this.r6a}))}rzh(a){this.Ma.raiseEvent(td.a.ncl,Object.assign(new Pb,{Uab:this.r6a,B1j:a}))}}Object(m.a)(kc,"EditStateEventManager",null,[602]);class Wc{constructor(a){this.ZOd=
this.gHc=!1;this.Ayf=null;this.$pf=0;this.OCb=!1;this.Ma=a;this.Prf=0;this.$Pd=2}get mode(){return this.Prf}Jnb(a,b){0===a?(0===b&&(b=1),this.Ayf=(new Date).toISOString(),this.$Pd=b):this.$Pd=0;this.Prf=a}get e$c(){return this.$Pd}get fvk(){return this.Ayf}get isActive(){return 0!==this.mode}get u_i(){return this.$pf}yNa(a){this.ZOd=a}Aac(a){return this.isActive&&!!a&&this.gHc}kca(a){!this.gHc&&a&&this.Ma.raiseEvent(xf.r_i);this.gHc=a;this.W0k(a);a&&(this.$pf=(new Date).getTime())}Gkg(a){return this.isActive&&
!!a&&this.ZOd}W0k(a){a&&Qi.GrippersManager.instance.setVisibility(!1)}vFl(){this.ZOd=this.gHc=!1}}Object(m.a)(Wc,"EditViewStateManager",null,[601]);var Xd=d(939);class Gd{constructor(a,b,c,f,l,u){this.jd=a;this.JE=b;this.Io=c;this.WL=f;this.La=l;this.$f=u;this.La&&(this.La.getBooleanAppSetting("WordEditorImageOverflowIsEnabled")||this.La.getBooleanAppSetting("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(Gd.kWc=-1*Math.pow(2,31))}RRc(){this.JE.kXf();za.a.qw(this.jd.hn())}Ebe(a){const b=
this.jd.hn();if(2===a){var c=jc.jfj;a=Gd.ifj;b.style.overflow="visible"}else if(1===a)c=E.a.unb?0:Gd.kWc,a="0",b.style.overflow="hidden";else return;const f=this.jd.Lg.xv;f.style.position="absolute";this.La&&(this.La.getBooleanAppSetting("WordEditorImageOverflowIsEnabled")||this.La.getBooleanAppSetting("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility=
"visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}u9f(a){if(this.jd&&this.jd.Lg&&this.jd.Lg.xv){var b=this.jd.Lg.xv;b.style.zIndex=String(E.a.unb?0:Gd.kWc);E.a.unb&&!a&&(b.style.visibility="hidden",this.jd.hn().style.visibility="hidden")}}akl(a){this.Io.raiseEvent(td.a.mdk);this.RRc();this.jd.m3a(!0);this.jd.hn().style.direction="";this.Ebe(a);this.jd.Lg.iYk()}Xjl(a){this.jd.m3a(!0);this.Ebe(a);E.a.unb&&this.pvg();E.a.TG&&Sys.UI.DomElement.addCssClass(this.jd.hn(),
"NonStandardIEClipboard")}$jl(a){this.Ebe(a);E.a.TG&&Sys.UI.DomElement.removeCssClass(this.jd.hn(),"NonStandardIEClipboard")}Zjl(a,b,c,f,l,u,I){this.Io.raiseEvent(td.a.endEditing);const T=this.jd.hn();T&&(za.a.qw(T),E.a.m1&&b&&a&&(this.jd.m3a(!0),T.innerText=" ",this.WL.lNa(c,f,l,u,I)),a||Sd.a.sXf(T),this.jd.m3a(!1),this.u9f(b))}Yjl(a){this.jd.m3a(!1);E.a.TG&&Sys.UI.DomElement.removeCssClass(this.jd.hn(),"NonStandardIEClipboard");this.u9f(a);this.Io.raiseEvent(td.a.RUi)}bkl(){const a=Sys.UI.DomElement.getBounds(this.$f.$d.jL),
b=this.jd.Lg.xv;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.$f.$d.scrollTop,Xd.a)+"px");b.style.opacity="0";b.style.zIndex=String(Gd.kWc);E.a.Gk&&(b.style.visibility="Hidden",this.jd.hn().style.visibility="Hidden")}pvg(){const a=1E3-this.$f.$d.container.getBoundingClientRect().left+this.$f.$d.scrollLeft+1,b=this.jd.Lg.xv;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}Gd.kWc=-1E3;Gd.ifj="1";Object(m.a)(Gd,"EditingDomDisplayManipulator",null,[]);class Pe{constructor(a){this.gmi=
a}get range(){return this.gmi}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}Object(m.a)(Pe,"RangeProxy",
null,[660]);class Lf{constructor(a){this.dLc=a}get selection(){return this.dLc}get type(){return this.selection.type}createRange(){return new Pe(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(m.a)(Lf,"SelectionProxy",null,[608]);class Nf{constructor(a){this.fdi=a}get em(){return this.fdi}get body(){return this.em.body}get activeElement(){return this.em.activeElement}get documentElement(){return this.em.documentElement}get document(){return this.em.cookie}get selection(){return new Lf(this.em.selection)}get designMode(){return this.em.designMode}get doctype(){return this.em.doctype}get domain(){return this.em.domain}get hidden(){return this.em.hidden}get implementation(){return this.em.implementation}get parentWindow(){return this.em.parentWindow}get referrer(){return this.em.referrer}get title(){return this.em.title}get URL(){return this.em.URL}get visibilityState(){return this.em.visibilityState}createAttribute(a){return this.em.createAttribute(a)}open(){this.em.open()}close(){this.em.close()}attachEvent(a,
b){return this.em.attachEvent(a,b)}detachEvent(a,b){this.em.detachEvent(a,b)}createAttributeNS(a,b){return this.em.createAttributeNS(a,b)}createDocumentFragment(){return this.em.createDocumentFragment()}createElement(a){return this.em.createElement(a)}createElementNS(a,b){return this.em.createElementNS(a,b)}createEvent(a){return this.em.createEvent(a)}createTextNode(a){return this.em.createTextNode(a)}dispatchEvent(a){return this.em.dispatchEvent(a)}execCommand(a,b,c){return this.em.execCommand(a,
b,c)}hasFocus(){return this.em.hasFocus()}focus(){this.em.focus()}getElementById(a){return this.em.getElementById(a)}getElementsByTagName(a){return this.em.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.em.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.em.getElementsByName(a)}write(a){this.em.write(a)}querySelector(a){return this.em.querySelector(a)}querySelectorAll(a){return this.em.querySelectorAll(a)}queryCommandEnabled(a){return this.em.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.em.queryCommandIndeterm(a)}queryCommandState(a){return this.em.queryCommandState(a)}queryCommandSupported(a){return this.em.queryCommandSupported(a)}queryCommandValue(a){return this.em.queryCommandValue(a)}}
Object(m.a)(Nf,"DOMDocumentProxy",null,[847]);class dg{constructor(){this.t6a=null}get isValid(){return this.Lg.isValid}get contentWindow(){return this.Lg?this.Lg.contentWindow:null}get Lg(){return this.t6a}T4k(a){bj.a.fgh(a,this.Lg.xv)}S4k(){bj.a.Qgf(this.Lg.xv)}A9f(){this.Lg.jhj()}dIj(a){if(!E.a.jg)return a.innerHTML;this.Lg.wdm(a);return a.innerHTML}qfm(){this.Lg?(this.S4k(),this.t6a=null):da.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}lIi(a,b){this.t6a=
a;this.T4k(b)}hn(){return this.Lg?this.Lg.Mo:null}m3a(a){this.Lg&&this.Lg.vyd(a)}lva(){return this.Lg?new Nf(this.Lg.contentDocument):null}}Object(m.a)(dg,"EditingDomManager",null,[599]);var Pg=d(148);class pi{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.rka=0;this.jf=null;this.Vb=a;this.lm=b;this.d4=c;this.Io=f;this.fsa=l;this.je=u;this.jd=I;this.Af=T;this.GL=ja;this.Bl=ua;this.Ed=Ra;this.JE=eb;this.Vc=Bb;this.JL=Ub;this.Wh=Xb;this.$f=tc;this.Bf=lc;this.zd=hd;this.Qja=Ec;this.Qja.ZAi(Object(R.a)(this,
this.rqh,"onSynchronizeMode"))}dispose(){this.Qja.LCl(Object(R.a)(this,this.rqh,"onSynchronizeMode"))}g4b(a){(this.jf=a)||da.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.Af.mode}endClipboard(){if(1===this.mode){var a=this.lm.xe(2);a.rd(this.jf.root);this.jf.detach();this.Vb.Pg&&!this.eue&&this.Vb.Pg.E$(this.$f.$d.Na,4,!0);this.Af.Jnb(0,3);this.Vb.Pg=null;this.Vb.ui=null;this.Vb.NX=null;this.d4.Yjl(this.jf.aMa);a.dispose()}}ica(a,b,c){this.jf.DXa&&
this.Vb.ui?this.jf.Xt(!1):this.jf.DXa&&!this.Vb.ui&&da.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Io.Zql(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.Af.Jnb(a,c);f=this.startEditing(this.W8i);break;case 1:if(this.mode!==a||this.Vc.Oa.Xs!==this.rka)this.endEditing(!0),this.Af.Jnb(a,c),f=this.b5l(),this.rka=this.Vc.Oa.Xs;break;case 0:this.mode!==a&&(2===this.mode&&Qi.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.Af.Jnb(a,c))}f||this.Af.Jnb(0,7)}KPl(){this.Af.Jnb(2,0)}get W8i(){return this.Vc.Oa.kb.Ua.node}startEditing(a){if(1===this.fJf)return!1;this.jd.A9f();this.jf.CAa?this.jf.Xt(!0):(this.jf.w7j.C9f(!1),this.Af.Aac(this.Vb.Pg)&&this.jf.Xt(!1));this.jf.CAa=!1;if(this.Vb.Pg===a)return a=mb.GraphIterator.ob(a.node),this.Lbe(a),this.Vb.$1j&&(this.Ed.Aj&&this.jf.Zxb.Ufa||this.GL.setFocus(this.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA)),!0;
const b=this.lm.xe(2,G.a.startEditing);b.rd(a.node);this.jf.detach();this.Vb.Pg&&this.Vb.Pg.E$(this.$f.$d.Na,4,!0);this.Vb.Pg=a;this.Vb.Pg.E$(this.$f.$d.Na,4,!0);if(this.zd.Gg){const c=We.j(this.Vb.Pg,5);for(let f=0;f<c.length;f++)c[f].t6f(this.jf)}this.jf.eAb=!0;this.d4.akl(this.mode);this.jf.ez(a.node);this.JE.Pnb(!1,this.Vb.tj,this.Wh);this.Af.kca(!1);this.Af.yNa(!1);a=mb.GraphIterator.ob(this.Vb.Pg.node);this.Lbe(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.jf.OWc(),this.jf.Xt(!0),
!this.eue)){var b=this.lm.xe(2);b.rd(this.jf.root);this.jf.detach();this.Vb.Pg&&this.$f.$d&&this.Vb.Pg.E$(this.$f.$d.Na,20,!0);this.Af.Jnb(0,4);this.Vb.Pg=null;this.Vb.ui=null;this.Vb.NX=null;this.d4.Zjl(a,this.jf.aMa,this.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA);b.dispose()}}b5l(){if(this.eue||U.a.instance.ga(11)&&1===this.fJf)return!1;this.Io.raiseEvent(td.a.QUi);this.jd.A9f();const a=this.lm.xe(2);a.rd(this.Vc.tpb);this.Af.Aac(this.Vb.Pg)&&this.jf.Xt(!1);
this.jf.detach();this.Vb.Pg=null;this.Vb.ui=null;this.Vb.NX=null;if(this.Vc.Oa.bga){const b=this.Vc.Oa.kb.Ua.node;this.jf.ez(b);const c=mb.GraphIterator.ob(b);this.Vb.Pg=b;this.Vb.mua=this.ngk(b);this.Lbe(c);this.Vb.Pg.E$(this.$f.$d.Na,4,!0)}else this.jf.ez(this.Vc.tpb);this.d4.Xjl(this.mode);this.JE.Pnb(!1,this.Vb.tj,this.Wh);a.dispose();return!0}rqh(){this.r4a()}r4a(){if(!this.fsa.W$&&!A.AFrameworkApplication.Be.Dx&&this.$f.$d&&this.$f.$d.isActive){var a=this.Vc.Oa.kb;a&&this.GL.Cve()?this.JL&&
this.JL.Ndb()?this.ica(2,!0,10):this.Bf.uy(a)?ad.App.Ob.ie.isEditingAllowed||ad.App.Ob.ie.eA?this.ica(2,!0,0):this.jf.Dyc?(this.ica(1,!0,0),this.ica(0,!0,15)):this.ica(2,!0,0):this.ica(1,!0,0):this.ica(0,!1,a?9:8)}}get eue(){return A.AFrameworkApplication.Dh}get fJf(){return A.AFrameworkApplication.za.state}Lbe(a){a.wf();Pg.OutlineNavigator.j5e(a)}ngk(a){return ge.OutlineElementReader.kn(jb.OutlineElementNavigator.qC(a))}}Object(m.a)(pi,"EditingModeTransitionManager",null,[598]);class li{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf){this.jf=null;this.je=a;this.Af=b;this.Vb=c;this.aii=f;this.Al=l;this.$hi=u;this.Yhi=I;this.DJd=T;this.Ypi=ja;this.Vrb=ua;this.N_b=Ra;this.rqf=eb;this.edi=Bb;this.GL=Ub;this.rja=Xb;this.U1b=tc;this.jdi=lc;this.mki=Ec;this.O$h=hd;this.Mii=yd;this.pka=Pd;this.Gj=pe;this.C8=Se;this.O8=vf}sU(a){this.jf=a}get qH(){return!this.je.Dx&&this.Af.isActive&&this.Vb.vYa(this.Af.mode)?!0:!1}Rgl(a){a.jIa=b=>this.aii.jIa(b,this.qH);a.ufb=b=>{this.O8&&
this.qH&&!this.e7a&&this.C8.raiseEvent(xf.$$a);return this.$hi.ufb(b,this.qH)};a.XA=b=>{!this.O8||!this.qH||this.e7a||b.hc.keyCode!==H.a.UCc&&b.hc.keyCode!==H.a.sCc&&b.hc.keyCode!==H.a.eG&&b.hc.keyCode!==H.a.Qca||this.C8.raiseEvent(xf.$$a);return this.Yhi.XA(b,this.qH,this.jf.F7b)};a.e6b=b=>{this.O8&&this.qH&&(this.e7a=!0,this.C8.raiseEvent(xf.$$a));return this.DJd.e6b(b,this.qH,this.jf.F7b)};a.j6d=b=>this.DJd.h6d(b,this.qH,this.jf.F7b);a.d6b=b=>{this.O8&&this.qH&&(this.e7a=!1);return this.DJd.d6b(b,
this.qH,this.jf.F7b)};a.npb=b=>{this.O8&&this.qH&&this.jf.Dyc&&this.C8.raiseEvent(xf.$$a);return this.Ypi.npb(b,this.qH&&this.jf.Dyc)};a.BFa=Object(R.a)(this.Vrb,this.Vrb.BFa,"dropHandler");a.AFa=Object(R.a)(this.Vrb,this.Vrb.AFa,"dragOverHandler");a.q8b=Object(R.a)(this.Vrb,this.Vrb.q8b,"dragLeaveHandler");a.zsc=b=>{this.O8&&this.qH&&!this.Af.OCb&&this.C8.raiseEvent(xf.$$a);this.N_b.handlePaste(b,this.jf.root,this.Af.OCb)};a.p9d=b=>{this.O8&&this.qH&&!this.Af.OCb&&this.C8.raiseEvent(xf.$$a);this.rqf.esg(b,
!0,this.qH,this.Af.OCb)};a.w6b=b=>{this.rqf.esg(b,!1,this.qH,this.Af.OCb)};a.l8b=b=>{this.edi.l8b(b,this.qH)};a.iRf=()=>{this.GL.IIi()};a.xD=b=>this.rja.X8i(b,this.Al.Ufa,this.qH);a.AD=b=>this.U1b.onContextMenu(b,this.jf.Pg);a.hff=Object(R.a)(this.U1b,this.U1b.Nrc,"onTouchMove");a.gff=Object(R.a)(this.U1b,this.U1b.AMb,"onTouchEnd");a.K_d=()=>{this.GL.phj(this.Af.mode)};a.Qab=b=>this.jdi.Dkb(b,this.qH);a.U2a=b=>{this.mki.Qkb(b,this.qH,this.jf.ownerDocument.documentElement)};a.e3=()=>{this.O$h.H2k(this.qH)};
a.nLg=()=>{this.Mii.jFk(this.qH)};a.BQb=()=>this.pka.d_j(this.qH,this.jf.Pg);a.bkb=b=>this.Gj.mouseDown(b);a.CRe=b=>this.Gj.WK(b)}}Object(m.a)(li,"EditingSurfaceEventHandlerManager",null,[]);class Ri{constructor(a,b,c){this.yd=a;this.sg=b;this.Oh=c}cancelEventAndRestoreEditingSurface(a){this.yd.kc("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.sg.bx++;Ae.a.vo(a);this.Oh.ica(0,!0,6);this.Oh.r4a()}}Object(m.a)(Ri,"EditingSurfaceEventHandlerUtils",null,[]);class Ih{constructor(){this.sDa=
0}get W$(){return 0<this.sDa}suspend(){this.sDa++}resume(){0<this.sDa&&this.sDa--}}Object(m.a)(Ih,"EditingSurfaceStateManager",null,[]);class ij{constructor(a){a=void 0===a?30:a;this.fmd=this.Dpc=-1;this.Bpb=Array(a);this.ymd=Array(a-1)}ZYh(){this.cul();this.fjm()}Uxd(){const a=this.xNl();da.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}cul(){var a=(new Date).getTime();if(this.Dpc<this.Bpb.length-1)this.Dpc++;else for(let b=0;b<this.Bpb.length-1;b++)this.Bpb[b]=this.Bpb[b+1];this.Bpb[this.Dpc]=
a}fjm(){const a=this.Dpc+1;for(let b=2;b<=a;b++)this.Uem(b,this.fAj(b))}fAj(a){const b=this.Dpc;return this.Bpb[b]-this.Bpb[b-(a-1)]}Uem(a,b){a-=2;this.fmd<a?(this.fmd++,this.ymd[this.fmd]=b):b<this.ymd[a]&&(this.ymd[a]=b)}xNl(){const a=this.hnj();return Sys.Serialization.JavaScriptSerializer.serialize(a)}hnj(){const a=Array(this.fmd+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.ymd[b]/(b+1));return a}}Object(m.a)(ij,"EventFrequencyTracker",null,[]);var Fi=d(1124),Da=d(1126);class Wa{constructor(a){this.Du=
null;this.Op=0;this.zL=a;this.pk=new Date;this.CDc=A.AFrameworkApplication.za.mode}end(a){this.Op=a;this.Du=new Date}get startTime(){return this.pk}get endTime(){return this.Du}get actionId(){return this.zL}get behavior(){return 2}get YPc(){return this.CDc}get gL(){return null}get Bd(){return null}get telemetryData(){return null}get response(){return this.Op}get eV(){return 1}get oq(){return 30}get Tta(){return null}get Bj(){return!0}}Object(m.a)(Wa,"TypingActionOperation",null,[558,375,376]);class lb{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){this.jf=this.MGc=this.vsb=null;this.Gki=a;this.Oh=b;this.Io=c;this.Wja=f;this.d4=l;this.lm=u;this.Vb=I;this.$f=T;this.je=ja;this.Bl=ua;this.Af=Ra;this.Gj=eb;this.Wh=Bb;this.Yt=Ub;this.Rja=Xb;this.DT=tc;this.Vc=lc;this.NE=Ec}sU(a){this.jf=a}get Swg(){return!!this.vsb}startHybridTransition(){if(this.Bl.value.isEditingAllowed||this.Bl.value.eA){this.Oh.KPl();this.Io.raiseEvent(td.a.kcl);this.JQl(G.a.overtype);this.Wja.value.Bx();this.d4.$jl(this.Oh.mode);
var a=this.lm.xe(2);a.rd(this.jf.root);this.Vb.Pg&&!A.AFrameworkApplication.Dh&&this.Vb.Pg.E$(this.$f.$d.Na,4,!0);a.dispose();this.DT.iwc();this.Af.yNa(!0);this.Gj.kUb(this.Oh.mode,this.Vb.tj);this.Gki.gpj(this.Vb.ui,this.Vb.Pg,this.Vb.NX);this.Wh.UVk(this.Vc.Oa.kb.Ua.Ra,this.Vc.Oa.kb.Ua.Pb);this.Yt.v_();this.Rja.iLb();this.zui();this.Io.raiseEvent(td.a.icl)}else this.Oh.ica(0,!0,12)}Bgj(){this.DT.iwc();this.vsb.end(32);Fi.a.getInstance().lvc(this.vsb);Da.a.getInstance().kvc(this.vsb);this.vsb=null}zui(){this.MGc||
(this.MGc=new ne.a(2,1,20,Object(R.a)(this,this.P5j,"hybridCleanup"),24),this.je.Jb(this.MGc))}JQl(a){this.vsb=new Wa(a)}P5j(){this.MGc=null;this.Vb.vYa(this.Oh.mode)&&this.jf.Xt(!0)}y$e(){if(!this.Vc.Oa.bga)return!1;const a=this.Vc.Oa.kb.Ua,b=gf.HyperlinkReader.HD(a,!1);for(const c of b)if(c.Ra===a.Ra&&c.Pb<=a.Pb)return!1;return this.NE.Tpk(a)?!1:!We.d(a.node,a.Ra)&&!We.d(a.node,a.Pb-1)&&!a.node.a_i}}Object(m.a)(lb,"HybridTransitionManager",null,[596]);class Lb{constructor(a,b,c,f,l){this.vNd=this.CAa=
!1;this.Mr=a;this.Oh=b;this.jd=c;this.Wh=f;this.$f=l}get E7j(){return this.vNd}OWc(){this.C9f(!0)}C9f(a){this.Mr.isComposing&&2===this.Oh.mode&&(da.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.vNd=!0,this.jd.Lg.sqa(),this.Wh.i0k(this.jd.contentWindow),this.vNd=!1,this.Mr.isComposing=!1,a&&this.$f.$d.ep&&(this.$f.$d.wxb()&&da.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.Oh.r4a()))}}Object(m.a)(Lb,"ImeManager",null,[]);class oc{constructor(a,
b,c,f,l,u,I,T){this.Qh=null;this.Ed=a;this.jd=b;this.Oh=c;this.lm=f;this.yd=l;this.sg=u;this.Tn=T}g4b(a){this.Qh=a}get C7j(){if(this.Ed.jg){const a=Sd.a.oGa(this.jd.contentWindow);if(a&&this.Tn.h2c(a)===this.jd.hn())return!0}return!1}correctBadImeState(){if(!this.C7j)return!1;this.yd.kc("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.sg.bz++;const a=this.lm.xe(3);a.rd(this.Qh.root);this.Oh.ica(0,!0,11);this.Oh.r4a();a.dispose();return!0}}Object(m.a)(oc,"ImeRecoveryUtils",null,
[]);class Jc{constructor(a,b,c,f,l,u,I,T,ja){this.Wh=a;this.sg=b;this.yd=c;this.Qj=f;this.OL=l;this.Np=u;this.$f=I;this.Vb=ja}iLb(){for(let a=0;a<this.Wh.pj.length;a++)this.Np.cK(this.Wh.pj[a].DG,this.sg,this.yd,this.Qj)?Sys.UI.DomElement.removeCssClass(this.Wh.pj[a].qte,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Wh.pj[a].qte,"EmptyTextRun"),za.a.v6b(this.Wh.pj[a].DG,this.Wh.pj[a].qte)}}Object(m.a)(Jc,"InteractiveViewSynchronizer",null,[]);var bd=d(15),rd=d(197),Zd=d(244);class ea{constructor(){}}
Object(m.a)(ea,"OnBackspaceDeleteEventArgs",null,[]);class Ka{constructor(a){this.Dde=a}}Object(m.a)(Ka,"OnDisMissFloatieEventArgs",null,[]);var bb=d(560),vb=d(102);class Yb{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg,yg,ng,Wh,Ai,Wf,gg,vh,Zj,qj,Ok,Wl,Rm,Pk,Xl,wk,Qk,qk){this.qka=null;this.rwf=this.Lnf=!1;this.kZb=new bd.ScriptSharpLegacyMap;this.zDa=a;this.Qj=b;this.je=c;this.jd=f;this.yd=l;this.sg=u;this.jta=I;this.pka=T;this.rja=ja;this.Vb=ua;this.Gj=
Ra;this.Ed=eb;this.Tn=Bb;this.X_=Ub;this.Bf=Xb;this.DT=tc;this.pJ=lc;this.wsa=Ec;this.Vc=hd;this.Af=yd;this.Mr=Pd;this.Wja=pe;this.sD=Se;this.Ch=vf;this.Bl=ug;this.WL=Tg;this.trb=$f;this.Al=Ve;this.CQa=xg;this.gX=yg;this.sai=ng;this.pub=Wh;this.lm=Ai;this.Ca=Wf;this.zd=gg;this.Pp=vh;this.QE=Zj;this.uXb=qj;this.WQ=Ok;this.x8a=Wl;this.Ida=Rm;this.Io=Pk;this.rai=Xl;this.SBa=!!wk;this.yv=wk;this.La=Qk;this.uo=qk}get BBc(){return this.zDa.instance?this.zDa.instance.v_h():null}get Q9d(){return this.uXb||
(this.uXb=Tb.a.instance.ub("Common.IEventTimingMeter"))}get c3a(){return this.qka||(this.qka=Tb.a.instance.ub("Box4.ISelectionCommands"))}Buk(a,b){let c=this.Qme(a);c||(c=this.ZWj(a,b));return c}ZWj(a,b){const c=a.hc,f=c.keyCode,l=a.eventName===la.a.sEa;if(this.SBa&&l&&this.yv.instance&&this.yv.instance.a3k(f===H.a.eG))return Ae.a.vo(c),!0;if(f===H.a.lPa&&c.shiftKey&&c.ctrlKey)return l&&(A.AFrameworkApplication.Pa.nb(G.a.E2f,2),da.ULS.sendTraceTag(41738320,323,50,"CtrlShiftV triggered.")),!1;if(l&&
c.ctrlKey){if(f===H.a.LFd||f===H.a.OFd)return this.bBe(G.a.D2f),!1;if(f===H.a.MFd||f===H.a.qCc)return this.bBe(G.a.C2f),!1;if(f===H.a.Omf)return this.bBe(G.a.C8i),!1;this.Vtl(a.hc,f)}this.Qj&&(this.je.d4f(Yb.Z8l),this.jd.Lg.VDd());if(1===this.Af.mode)return this.D6k(a,b);if(this.Qj&&this.Al.Ufa)return this.yd.kc("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.sg.bw++,Ae.a.vo(c),this.jta.cwc(G.a.Nz),!0;this.pka.fAb();this.jd.hn().scrollTop=0;this.rja.aaa=!this.Vb.mua&&f===H.a.LW||
this.Vb.mua&&f===H.a.F_||f===H.a.Pz;this.Gj.kUb(this.Af.mode,this.Vb.tj);this.Ed.Gk&&(c.ctrlKey||c.altKey)&&f!==H.a.KFd&&f!==H.a.XOa&&f!==H.a.kqb&&f!==H.a.UCc&&this.CQa.OWc();return this.YWj(a)}YWj(a){var b=a.hc.keyCode;const c=b===H.a.Qca,f=b===H.a.eG;let l=!1,u=!1,I=!1;switch(b){case H.a.Pz:case H.a.lJ:I=!0;b=this.La.getBooleanAppSetting("BrowserHandledNavigationIsEnabled");a.hc.altKey||a.hc.ctrlKey||a.hc.shiftKey||this.Ed.Fl||!b&&this.Ed.Fk||(u=!0);break;case H.a.F_:case H.a.LW:I=!0;this.Ed.Fl&&
this.Tn.ulg(a.hc.rawEvent)&&!a.hc.altKey&&!a.hc.shiftKey?u=!0:this.Ed.Gk&&this.c3a?a.hc.altKey||a.hc.ctrlKey||a.hc.shiftKey||(u=!0):l=!0;this.La&&this.La.getBooleanAppSetting("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.Af.yNa(!0);break;case H.a.I3:case H.a.H3:I=!0;this.Ed.Gk&&this.c3a?u=this.AVj(a):l=!0;this.La&&this.La.getBooleanAppSetting("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.Bf.P8c(this.x8a.kb)||this.Bf.bNa(),this.Af.yNa(!0));break;case H.a.Qca:case H.a.eG:if(!this.Bl.value.isEditingAllowed&&
this.Bl.value.eA)l=!0;else if(this.pVj(a,c,f))return A.AFrameworkApplication.fa.getBooleanAppSetting("LocallyResizeTextBoxOnContinuousTypingEnabled")&&Nb.a("SendAutofitTypeToClient")&&a.eventName===la.a.sEa&&this.Io.h1e(a,this.Mr.isComposing,!1,!0),!0;break;case H.a.J4h:this.yd.kc("InsertKeyPressed");l=!0;break;default:if(a.hc.keyCode===H.a.UCc||a.hc.keyCode===H.a.sCc||this.Ed.S_d)this.Mr.isComposing=!0,this.pub||this.Af.kca(!0)}(this.Al.G4&&!f||this.Al.oua&&!c)&&this.pJ.Xt(!0);2!==this.Af.mode&&
(I=u=!1);a.eventName===la.a.sEa&&(A.AFrameworkApplication.fa.getBooleanAppSetting("LocallyResizeTextBoxOnContinuousTypingEnabled")&&Nb.a("SendAutofitTypeToClient")?this.Io.h1e(a,this.Mr.isComposing,I,f||c):this.Io.h1e(a,this.Mr.isComposing,I));u&&(this.Wja.value.Bx(),this.sD.uSa(a));l&&Ae.a.vo(a.hc);return u}Qme(a){return A.AFrameworkApplication.fa.getBooleanAppSetting("PPTOTextPredictionIsEnabled")?bb.a.Qme(a,this.x8a.S9b):!1}qVj(a){const b=this.x8a.S9b;var c=b.node;const f=b.Ra,l=$a.ParagraphReader.text(c);
let u=!1;if(a){if(f<$a.ParagraphReader.textLength(c)){a=this.lm.xe(15);try{a.rd(c),c=f+1,Aa.a.yy(l,c)&&c++,this.uo.OLb(b,null),this.Ca.nb(G.a.rightArrow,2)}finally{a&&a.dispose()}u=!0}}else if(0<f){a=this.lm.xe(15);try{a.rd(c),c=f-1,Aa.a.yy(l,c)&&c--,this.uo.OLb(b,null),this.Ca.nb(G.a.leftArrow,2)}finally{a&&a.dispose()}u=!0}return u}Vtl(a,b){switch(b){case H.a.Dqb:b="PowerPointBrowserCut";break;case H.a.Ira:b="PowerPointBrowserCopy";break;case H.a.lPa:b="PowerPointBrowserPaste";break;default:b=void 0}b&&
(null===ff.ActionManager||void 0===ff.ActionManager?0:ff.ActionManager.E4a)&&ff.ActionManager.E4a(a.rawEvent,b,void 0)}BLj(a){return Od.a.yt(a.Ua).cache.fontSize}AVj(a){var b=!1;if(!(a.hc.altKey||a.hc.ctrlKey||a.hc.shiftKey||(a=We.f(this.Vb.Pg),rd.a.any(a,c=>5===c.kr||8===c.kr)))){if(this.jd.Lg&&this.WQ.HEb(this.jd.Lg.Mo))return!1;this.sD.Xpb&&this.sD.KOa();b=this.X_.kva(this.rja.aaa);a=this.Bf.gla(b);a=this.Vb.mua?a.x+a.width:a.x;-1===this.Bf.DA?(this.Bf.DA=a,b=!0):b=Math.abs(this.Bf.DA-a)<=this.BLj(b)}return b}pVj(a,
b,c){if(!a.hc.altKey&&!a.hc.ctrlKey&&!a.hc.shiftKey&&(this.Qj&&this.Al.G4&&this.DT.AEd()&&this.pJ.Xt(!1),this.sai.Ndm(b,this.Vb.ui,this.Vb.bUa,this.Vb.Pg,this.rja.aaa,this.Vb.NX.tj,this.pJ.mJi))){if(this.zd.Gg&&this.zd.wD)return(b=this.qVj(b))&&Ae.a.vo(a.hc),b;const f=this.yd.Cq(G.a.P1d);this.BBc&&this.BBc.Huk();const l=new ea(a,c,b);this.rai.epl(l);(c&&!this.Al.G4||b&&!this.Al.oua)&&this.pJ.Xt(!1);U.a.instance.ga(50)&&this.wsa.value&&this.wsa.value.qy&&this.Vc.v2b();za.a.v6b(this.Vb.ui.tj,this.Vb.NX.tj);
this.sD.uSa(a);this.Bf.bNa();this.Af.kca(!0);this.Al.oua=b;this.Al.G4=c;this.Al.G4&&-1===this.Al.nTc?this.Al.nTc=this.pJ.W2c:this.Al.oua&&-1===this.Al.NCd&&(this.Al.NCd=za.a.zw(this.Vb.bUa).length);f.end();return!0}return!1}XA(a,b,c){const f=this.Q9d;try{f&&f.keyDownEventHandlerStart(a.hc.rawEvent);0===this.Af.mode&&a.hc.keyCode!==H.a.Mp&&1!==this.Ca.mode&&this.nBk(this.Af,a.eventName);if(!b||!this.Ch)return!1;(a.hc.keyCode!==H.a.kqb||this.trb.AVc)&&this.Bl.value.Qp.$E();if(!this.QXl(a)){const I=
new Ka(!0);this.Ida.zpl(I)}if(!this.Af.isActive)return!1;this.Al.mze=(new Date).getTime();const l=this.yd.Cq(G.a.Nz);l.properties.$(Mc.a.source,"KeyDown");l.properties.$(Mc.a.duh,"KeyDown");const u=this.Buk(a,c);u&&Ae.a.iQi(a.hc);l.end();return u}finally{f&&f.keyDownEventHandlerEnd(a.hc.rawEvent)}}QXl(a){switch(a.hc.keyCode){case H.a.Pca:case H.a.I4h:case H.a.o8:case H.a.J3:case H.a.Rca:case H.a.eja:case H.a.sCc:case H.a.PFd:return!0}return!1}nBk(a,b){b={["EventName"]:b};A.AFrameworkApplication.za&&
(b.Mode=A.AFrameworkApplication.za.mode);if(a)if(b.Trigger=a.e$c,b.TriggeredTime=a.fvk,this.kZb.Ib(a.e$c)){let c,f;(c=this.kZb).$(f=a.e$c,c.ga(f)+1)}else this.kZb.$(a.e$c,1);b.Msg="BadEditSurfaceState";this.Lnf?da.ULS.sendTraceTag(18437408,323,50,"{0}",b):(da.ULS.shipAssertTag(18437408,323,!1,"{0}",b),A.AFrameworkApplication.Jia(()=>{this.oBk()}));this.Lnf=!0}oBk(){if(!this.rwf){var a="";for(const b of this.kZb.keys)a+=" Trigger "+b+" - "+this.kZb.ga(b)+",";da.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+
a);this.rwf=!0}}D6k(a,b){this.Qj&&this.WL.qnb(this.Af.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA);if(this.zd.Gg&&(B.KeyInputManager.M3c(a.hc)===B.KeyInputManager.Va(H.a.Ira,B.KeyInputManager.Ze)||B.KeyInputManager.M3c(a.hc)===B.KeyInputManager.Va(H.a.Dqb,B.KeyInputManager.Ze))&&(A.AFrameworkApplication.cD||A.AFrameworkApplication.Tw)&&!A.AFrameworkApplication.MUa)return Ae.a.vo(a.hc),!0;const c=this.x8a.S9b,f=c.node;if(a.hc.keyCode===H.a.Mp){if(Zd.EmbeddedFileReader.Nnk(f))return Ae.a.vo(a.hc),
!0;if(vb.ImageReader.pI(f)||!Zd.EmbeddedFileReader.xeb(f))if(vb.ImageReader.pI(f)||vb.ImageReader.HHa(c))return A.AFrameworkApplication.Pa.Ai(c,G.a.WC,2,!1,null,null),Ae.a.vo(a.hc),!0}switch(a.hc.keyCode){case H.a.UCc:case H.a.sCc:const {x5:l,BSb:u}=this.gX.y_h(a,b);if(l)return u}return!1}bBe(a){A.AFrameworkApplication.Pa.nb(a,2)}}Yb.Z8l=2E3;Object(m.a)(Yb,"KeyDownProcessor",null,[]);class Gc{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){this.Np=a;this.Vb=b;this.sg=c;this.yd=f;this.Qj=l;this.JE=
u;this.pJ=I;this.DT=T;this.Oh=ja;this.Gj=ua;this.X_=Ra;this.PW=eb;this.Bf=Bb;this.Al=Ub;this.Af=Xb}get RWe(){return this.Np.cK(this.Vb.tj,this.sg,this.yd,this.Qj)-(this.JE.c9?1:0)-this.Np.cK(this.Vb.tj.lastChild,this.sg,this.yd,this.Qj)}Nll(a,b){switch(b.keyCode){case H.a.lJ:case H.a.F_:if(this.e5j(a,b))return!0;break;case H.a.Pz:case H.a.LW:if(this.xgj(a,b))return!0;break;case H.a.I3:case H.a.H3:if(this.zgm(a,b))return!0;break;case H.a.eG:if(this.yHi())return!0}return!1}yHi(){return this.Al.G4&&
this.DT.AEd()?(this.pJ.Xt(!1,!0),!0):!1}zgm(a,b){a.F6c=!0;var c=this.RWe;const f=this.Gj.e$(this.Oh.mode,this.Vb.tj);f>=c&&(this.Gj.MU(c,this.Vb.ui),a.kb=this.X_.kva(this.PW.aaa));if(f===b.t7b)a.vab=b.keyCode===H.a.J3?1:3;else return f<c&&Aa.a.fA(this.Np.Zgg(this.Vb.ui,f-1,this.yd,this.sg,this.Qj))&&(b=this.Bf.Sua(a.kb,!1,!1,!1,!0),b=this.Bf.gla(b),c=a.kb.Ua,a=this.Bf.gla(a.kb),c=Od.a.yt(c),a.y>b.y&&Math.abs(a.x-this.Bf.DA)>2*c.cache.fontSize&&this.Gj.MU(f-1,this.Vb.ui)),this.Af.yNa(!0),this.PW.$9b(),
this.pJ.S9d(),!0;return!1}xgj(a,b){a.F6c=!0;const c=this.RWe;this.Bf.bNa();const f=this.Gj.e$(this.Oh.mode,this.Vb.tj);f>=c&&(this.Gj.MU(c,this.Vb.ui),a.kb=this.X_.kva(this.PW.aaa));if(b.keyCode===H.a.LW&&(b.t7b>=c&&!this.Vb.mua||b.t7b===this.PW.uUh&&this.Vb.mua))a.vab=2;else return this.Af.yNa(!0),b.keyCode===H.a.Pz&&f<c&&Aa.a.fA(this.Np.Zgg(this.Vb.ui,f-1,this.yd,this.sg,this.Qj))&&this.Gj.MU(f-1,this.Vb.ui),this.PW.$9b(),this.pJ.S9d(),!0;return!1}e5j(a,b){a.F6c=!0;const c=this.RWe;this.Bf.bNa();
if(b.keyCode===H.a.F_&&(b.t7b===this.PW.uUh&&!this.Vb.mua||b.t7b>=c&&this.Vb.mua))a.vab=4;else return this.Af.yNa(!0),this.PW.$9b(),this.pJ.S9d(),!0;return!1}}Object(m.a)(Gc,"KeyEntryProcessor",null,[]);var ud=d(1271),Nd=d(131),Bc=d(43);class qe{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve){this.ZBa=this.LCf=null;this.Ed=a;this.Tn=b;this.yd=c;this.pka=f;this.Bl=l;this.gX=u;this.M8=I;this.Mr=T;this.Af=ja;this.Vc=ua;this.jd=Ra;this.NFc=eb;this.Gj=Bb;this.lja=
Ub;this.Np=Xb;this.Vb=tc;this.rja=lc;this.Wh=Ec;this.wsa=hd;this.Io=yd;this.sD=Pd;this.bda=pe;this.zDa=Se;this.vpi=vf;this.tja=ug;this.zd=Tg;this.Pp=$f;this.uXb=Ve}get BBc(){return this.zDa&&this.zDa.instance?this.zDa.instance.v_h():null}get mfb(){return this.zd.Gg&&this.zd.wD}get F0(){return this.ZBa||(this.ZBa=Tb.a.instance.ub("Box4.IClipboardCommands"))}get Q9d(){return this.uXb||(this.uXb=Tb.a.instance.ub("Common.IEventTimingMeter"))}ufb(a,b){if(!b)return!1;b=this.Q9d;try{b&&b.keyPressedEventHandlerStart(a.hc.rawEvent);
if(this.Ed.WD&&this.Ed.Fl&&this.Tn.ulg(a.hc.rawEvent))return!1;this.BBc&&!B.KeyInputManager.ECg(a)&&this.BBc.Huk();const c=this.yd.Cq(G.a.Nz);c.properties.$(Mc.a.source,"KeyPress");const f=this.Guk(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.hc.rawEvent)}}S_j(){if((this.vpi||this.mfb)&&this.tja.D9(this.Vc.Ik,14)){var a=Object(gb.a)(ud.a,this.tja.y$b(this.Vc.Ik,16,!1));if(a&&1<a.length){const b=[],c=this.Vc.Oa.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;
if(!mb.GraphIterator.ob(l).Gca(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Vc.setSelection(new Nd.Selection(b,!0))}}}cql(a,b){if(1===this.Af.mode)return!1;this.Io.i1e(a,this.Mr.isComposing);let c;(c=this.sD).M9c=c.M9c+1;E.a.gp||ad.App.m2d&&E.a.JVh||(this.sD.uQh(this.Mr.aIa)||this.sD.uSa(a),this.Af.kca(!0));this.Mr.isComposing&&U.a.instance.ga(50)&&this.wsa.value&&this.wsa.value.qy&&this.Vc.v2b();this.Wh.uNc="";0<this.Wh.pj.length&&(this.Ed.jg||" "===b)&&(this.Wh.uNc=za.a.zw(this.Wh.pj[0].DG));
this.bda.raiseEvent(Ig.a.bze,a);this.NFc.ZYh();return!1}idj(a){let b=!1;this.Mr.aIa&&this.lja.$3b.instance&&(" "===a&&this.Np.Ifj(this.Vb.tj,this.Gj.e$(this.Af.mode,this.Vb.tj))&&(b=!!this.lja.yQe(this.Mr.aIa,this.rja.aaa)),!b&&this.lja.$3b.instance.Bsk(a)&&this.lja.hdj(a,this.rja.aaa))}$Wj(a){if(1!==this.Af.mode||(this.Ed.Gk||this.Ed.gp)&&a.hc.ctrlKey&&!a.hc.altKey||this.Ed.kna&&a.hc.charCode===H.a.E_)return!1;if(this.gX.Eqd(a))return!0;var b=this.gX.$9e();const c=this.gX.TXl();if(b||c||!this.M8.y$e())return b&&
!c&&this.Vc.setSelection($d.SelectionFactory.fh(this.Vc.Oa.kb.Ua.node,this.Vc.Oa.kb.Ua.Ra)),b=this.yeb(),this.S_j(),this.F0&&(this.F0.xth(String.fromCharCode(a.hc.charCode),b),this.bda.raiseEvent(Ig.a.bze,a)),Ae.a.vo(a.hc),!0;if(this.gX.zWe(a))return!0;if(this.mfb){b=this.zd.vwb();try{this.Io.i1e(a,this.Mr.isComposing),this.Ed.gp&&this.F0?(this.F0.xth(String.fromCharCode(a.hc.charCode)),Ae.a.vo(a.hc)):(this.sD.uSa(a),this.Af.kca(!0))}finally{b&&b.dispose()}}else this.M8.startHybridTransition(),this.Io.i1e(a,
this.Mr.isComposing),this.sD.uSa(a),this.Af.kca(!0);this.bda.raiseEvent(Ig.a.bze,a);this.NFc.ZYh();return!1}yeb(){if(this.Vc&&this.Vc.Oa&&this.Vc.Oa.kb){const a=this.Vc.Oa.kb;return Bc.SelectionEditor.Om(a.ga(a.length-1))||a.ga(a.length-1).contextId===ta.a.paragraph}return!1}Guk(a){this.pka.fAb();if(!(this.Bl.value.isEditingAllowed||this.Bl.value.eA&&this.mfb))return Ae.a.vo(a.hc),!0;if(this.gX.Gqd(a))return!1;if(1===this.Af.mode)return this.$Wj(a);this.jd.hn().scrollTop=0;this.Ed.jg&&this.Af.Aac(this.Vb.Pg)&&
" "===this.LCf&&this.sD.KOa();const b=Aa.a.charAt(Aa.a.fromCharCode(a.hc.charCode),0);this.LCf=b;this.Mr.isComposing||(B.KeyInputManager.ECg(a)&&(this.Mr.isComposing=!0),this.Gj.asl&&(this.Mr.isComposing=!0));this.idj(b);if(this.Ed.jg&&!this.Ed.Fl){const c=a.hc;if(c.ctrlKey&&122===this.Tn.Ygg(c)||c.ctrlKey&&121===this.Tn.Ygg(c))return!0}return this.cql(a,b)}}Object(m.a)(qe,"KeyPressProcessor",null,[]);class qg{constructor(a,b){this.Hj=a;this.keyCode=this.Hj.hc.keyCode;this.t7b=b}get k1j(){return!(void 0===
this.keyCode||null===this.keyCode)}}Object(m.a)(qg,"KeyQueueEntry",null,[]);class Jf{constructor(a,b,c,f,l,u,I){this.lZb=[];this.qka=null;this.Zhi=a;this.Af=b;this.Vb=c;this.Bf=f;this.Vc=l;this.pJ=u;this.Gj=I}get c3a(){return this.qka||(this.qka=Tb.a.instance.ub("Box4.ISelectionCommands"))}gwh(a){let b=-1;if(B.KeyInputManager.ZCg(a.eventName)&&2===this.Af.mode)switch(a.hc.keyCode){case H.a.lJ:case H.a.Pz:case H.a.F_:case H.a.LW:case H.a.I3:case H.a.H3:U.a.instance.ga(45)&&this.Af.Aac(this.Vb.Pg)&&
this.pJ.Xt(!1,!1);Qi.GrippersManager.instance.ZWa();b=this.Gj.e$(this.Af.mode,this.Vb.tj);break;default:Qi.GrippersManager.instance.RGh()}Array.add(this.lZb,new qg(a,b))}Oll(a){for(;0<this.lZb.length;){const b=this.lZb[0];Array.removeAt(this.lZb,0);const c=B.KeyInputManager.ZCg(b.Hj.eventName);if(!(c&&(b.Hj.hc.altKey||b.Hj.hc.ctrlKey||b.Hj.hc.shiftKey)||this.lZb.length)){if(c)if(b.k1j){if(this.Zhi.Nll(a,b))return!0}else this.Bf.bNa();if(this.qem(a))return!0}}return!1}qem(a){if(5!==a.vab){if(this.Af.Gkg(this.Vb.Pg))if(1===
a.vab||3===a.vab){const b=this.Bf.DA;this.Vc.setSelection(a.kb);this.Bf.DA=b}else this.Vc.setSelection(a.kb);this.c3a.JYk(a.vab);if(2!==this.Af.mode)return!0}return!1}}Object(m.a)(Jf,"KeyQueueProcessor",null,[]);class Bd{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.qka=null;this.yd=a;this.WL=b;this.Oh=c;this.Mr=f;this.Vb=l;this.Bl=u;this.Rja=I;this.Yt=T;this.SHc=ja;this.jd=ua;this.trb=Ra;this.sD=eb}get c3a(){return this.qka||(this.qka=Tb.a.instance.ub("Box4.ISelectionCommands"))}jIa(a,b){if(!b)return!1;
b=this.yd.Cq(G.a.Nz);b.properties.$(Mc.a.source,"KeyUp");a=this.Juk(a);b.end();return a}Juk(a){a.hc.keyCode===H.a.kqb&&(this.trb.AVc=!0);a.hc.ctrlKey&&this.WL.Z4f(this.Oh.mode,Me.a.instance.Oa,this.c3a,this.Vb.ui,this.Vb.tj,this.Vb.Pg,this.Bl.value.isEditingAllowed||this.Bl.value.eA);this.Mr.isComposing&&(this.Rja.iLb(),this.Yt.v_());this.sD.uQh(this.Mr.aIa)&&(this.SHc.gwh(a),this.sD.Xpb=!0,this.sD.KOa());this.jd.hn().scrollTop=0;return!1}}Object(m.a)(Bd,"KeyUpProcessor",null,[]);class Ld{constructor(a){this.vJd=
this.YHd=this.BH=null;this.je=a}get B9(){return this.BH||(this.BH=Tb.a.instance.resolve("Common.Utils.IAriaNotifier"))}i1k(a){a&&(this.vJd=a,this.YHd=new ne.a(2,1,500,Object(R.a)(this,this.Xcm,"tryAriaNotifyParagraphLockedTask"),29),this.je.Jb(this.YHd))}Xcm(a){this.vJd&&a&&this.YHd===a&&this.B9.K7(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.vJd),!0)}}Object(m.a)(Ld,"LockedParagraphAriaNotifier",null,[]);class sd{constructor(a){this.pJ=a}jFk(a){A.AFrameworkApplication.Dh||a&&
this.pJ.Xt(!0,!1)}}Object(m.a)(sd,"LostFocusEventProcessor",null,[]);class qd{constructor(a,b,c,f){this.sg=a;this.Oh=b;this.Rja=c;this.Yt=f}Qkb(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&(this.sg.h++,c.scrollLeft=0,c.scrollTop=0,2===this.Oh.mode&&(this.Rja.iLb(),this.Yt.v_()))}}Object(m.a)(qd,"OnScrollProcessor",null,[]);var Kd=d(1153);class Gk{constructor(a,b,c,f){this.html=a;this.text=b;this.i$l=c;this.G6d=f}dispose(){this.G6d=null}}Object(m.a)(Gk,"OriginalElementContent",null,[106]);class of{constructor(a,
b,c){this.w_b=[];this.ksf=0;this.yd=a;this.cU=b;this.Np=c}get Wbe(){return this.ksf}get Lrh(){return this.w_b}jXf(){for(let a=0;a<this.w_b.length;a++)this.w_b[a]&&(this.w_b[a].dispose(),this.w_b[a]=null)}GUh(a){this.jXf();a=a.qu;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,fc.a.gde));if(b||Sys.UI.DomElement.containsCssClass(f,fc.a.AO)||Sys.UI.DomElement.containsCssClass(f,ia.a.wX)||Sys.UI.DomElement.containsCssClass(f,
fc.a.OO)){let l=b=null,u=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=za.a.zw(f):(l=this.Np.hhe(f,this.yd,this.cU),u=new Kd.a(f));this.Lrh[c]=new Gk(f.innerHTML,b,l,u)}Sys.UI.DomElement.containsCssClass(f,fc.a.OO)&&(this.ksf=za.a.kcb(f))}}}Object(m.a)(of,"OriginalElementContentArray",null,[574]);class om{constructor(a,b,c,f,l,u,I){this.Wh=a;this.sg=l;this.yd=f;this.Qj=I;this.JE=b;this.Vc=c;this.Np=u}gpj(a,b,c){var f=this.Vc.Oa.kb.Ua;const l=f.Ra;f=f.Pb;let u=0,I=0;a=a.qu;Array.clear(this.Wh.pj);
for(let Ra=0;Ra<a.length;Ra++){var T=a[Ra],ja=this.Np.cK(T,this.sg,this.yd,this.Qj);if(Sys.UI.DomElement.containsCssClass(T,fc.a.AO))I<l?u+=ja:I<f&&(ja=We.d(b,I))&&!ja.yEa&&(ja=ca.a.Ie(T,ia.a.nIa),Array.add(this.Wh.pj,new ei(T,c.qu[ja],u,I,1))),I++;else if(Sys.UI.DomElement.containsCssClass(T,ia.a.wX))u+=ja;else if(!Sys.UI.DomElement.containsCssClass(T,fc.a.OO)){if(I+ja>=l&&I<=f){const eb=ca.a.Ie(T,ia.a.nIa);var ua=c.qu[eb];Sys.UI.DomElement.removeCssClass(ua,fc.a.M9);Array.add(this.Wh.pj,new ei(T,
ua,u,I,ja-(this.JE.c9?1:0)));for(T=this.Np.cK(ua,this.sg,this.yd,this.Qj);T<ja&&!(eb+1>=c.qu.length);)ua=c.qu[eb+1],T+=this.Np.cK(ua,this.sg,this.yd,this.Qj),ua.parentNode.removeChild(ua),Array.removeAt(c.qu,eb+1)}else if(I>f)break;u+=ja;I+=ja}}}}Object(m.a)(om,"OvertypeDomPreparer",null,[]);var mi=d(125),Oe=d(60);class Ol{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc){this.HSd=!1;this.ZBa=null;this.Hii=a;this.Oh=b;this.Ed=c;this.Vc=f;this.jta=l;this.Bf=u;this.Bl=I;this.$f=T;this.Mr=ja;this.M8=
ua;this.Qj=Ra;this.Vb=eb;this.WL=Bb;this.sD=Ub;this.zd=Xb;this.Pp=tc}get F0(){return this.ZBa||(this.ZBa=Tb.a.instance.ub("Box4.IClipboardCommands"))}jem(){return 1===this.Oh.mode?(this.HSd&&this.Ed.jg&&this.W1d(),this.HSd=!1,!0):!1}W1d(){if(this.F0){const a=new W.DictionaryPropertySet;a.setValue(Oe.a.bW,"<span></span>");this.F0.F9(null,a,!1)}}zWe(a){const b=this.Vc.qra;return b.vye||b.Cwe?(Ae.a.vo(a.hc),this.jta.cwc(G.a.jcl),!0):!1}Eqd(a){if(!this.Bf.$va(Me.a.instance.Oa.kb))return!1;Ae.a.vo(a.hc);
this.jta.cwc(G.a.Eqd);return!0}Gqd(a){if(!U.a.instance.ga(14))return!1;var b=Me.a.instance.Oa.ga(0);if(!mi.a.instance.XLl(b))return!1;b=this.Bf.nCc(Me.a.instance.Oa);this.Hii.i1k(b);Ae.a.vo(a.hc);this.jta.cwc(2===this.Oh.mode?G.a.afm:G.a.Gqd);return!0}y_h(a,b){let c,f;f=c=!1;if(!this.Bl.value.isEditingAllowed)return Ae.a.vo(a.hc),{x5:!0,BSb:!0};if(!b)return{x5:!0,BSb:!0};if(this.Eqd(a)||this.$f.$d.Rb.Oa.rI&&a.hc.type===la.a.g6d)return{x5:!0,BSb:f};this.Mr.isComposing=!0;b=this.$9e();if(!b&&this.M8.y$e()){if(this.zWe(a))return{x5:!0,
BSb:f};this.Qj&&this.WL.qnb(this.Oh.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA);this.zd.Gg&&this.zd.wD?(Ae.a.vo(a.hc),f=c=!0):this.M8.startHybridTransition()}else b&&this.Vc.setSelection($d.SelectionFactory.fh(Me.a.instance.Oa.kb.Ua.node,Me.a.instance.Oa.kb.Ua.Ra)),this.Vc.qra.gxb(),this.zd.Gg&&this.zd.wD?(Ae.a.vo(a.hc),f=c=!0):this.Ed.jg?(this.HSd=!0,this.sD.uSa(a),c=!0):(this.W1d(),Ae.a.vo(a.hc));return{x5:c,BSb:f}}$9e(){if(!this.Vc.Oa.bga)return!1;var a=
Me.a.instance.Oa.kb.Ua;return a.Ra!==a.Pb-1?!1:(a=We.d(a.node,a.Ra))&&5===a.kr?!0:!1}TXl(){if(!this.Vc.Oa.bga)return!1;const a=this.Vc.Oa.kb.Ua;return!We.d(a.node,a.Pb)||0<a.Ra&&!We.d(a.node,a.Ra-1)||a.Ra===a.Pb?!1:!0}}Object(m.a)(Ol,"OvertypeUtils",null,[]);class pm{constructor(a,b,c,f,l,u){this.f6a=null;this.jd=a;this.eci=b;this.$f=c;this.Oh=f;this.Vb=l;this.sSd=u}get l_f(){return this.eci}Ohf(){if(2===this.Oh.mode&&this.$f.$d.Wp&&this.Vb.vYa(this.Oh.mode)){var a=this.Vb.ui,b=this.l_f.sje(a.eb);
this.sSd.OEh(b,this.f6a,a,this.jd.Lg.xv,!1,!0);this.f6a=b}}}Object(m.a)(pm,"ParagraphOverlayPositioner",null,[]);class tk{constructor(a,b){this.Jel=this.location=null;this.Gv=a;this.isRtl=b}}Object(m.a)(tk,"OnShowFloatieEventArgs",null,[]);class Oj{constructor(){this.type=0;this.payload=this.uWe=null;this.Mze=!1;this.yTa=this.style=this.h_e=null}}Object(m.a)(Oj,"PasteDataContext",null,[]);class yk{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f){this.KSd=this.hCf=
this.Jo=null;this.mVd=Tg;this.Xsa=$f;this.gCf=a.getBooleanAppSetting("PasteClipboardImageInChromeIsEnabled");this.Vki=a.getBooleanAppSetting("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.BTd=a.getBooleanAppSetting("ReadImageBlobForIE11UpIsEnabled");this.qbi=a.tc("ClipboardDataImageBlobLimitaton",10);this.Z0b=a.getBooleanAppSetting("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.QFf=a.getBooleanAppSetting("PasteInBootLoadingUIIsEnabled");this.qVd=a.getBooleanAppSetting("ParseStyleFromRawHtmlHeadIsEnabled");
this.je=b;this.yd=c;this.lm=f;this.Vc=l;this.Oh=u;this.jd=I;this.d4=T;this.$f=ja;this.Ed=ua;this.WL=Ra;this.Vb=eb;this.lja=Bb;this.Bl=Ub;this.ZBa=Xb;this.Kk=tc;this.Lci=Ec;this.VRa=hd;this.UT=yd;this.Ca=Pd;this.s8=pe;this.Isa=Se;this.Ida=vf;this.wDa=ug;this.wpf=[Object(R.a)(this,this.T6j,"imageClipboardDataHandler"),Object(R.a)(this,this.egl,"plainTextClipboardDataHandler"),Object(R.a)(this,this.F5j,"htmlClipboardDataHandler")]}get F0(){return this.ZBa.instance}get aMa(){return this.KSd}get ioi(){return this.qVd||
this.Z0b}kwh(a,b){this.Vc.qra.gxb();this.Oh.ica(0,!0,13);this.jd.m3a(!0);const c=this.jd.Lg.xv.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.d4.bkl();this.$f.$d.HBa();this.Ed.qwa?this.WL.lNa(this.Oh.mode,this.Vb.tj,this.Vb.Pg,this.Vb.ui,this.Bl.value.isEditingAllowed||this.Bl.value.eA):this.d4.RRc();return b}UGh(a){this.jd.Lg.xv.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.aMa&&!this.je.Dx)if(this.F0||this.QFf){this.lja.QS&&(this.lja.QS=null);this.KSd=this.lm.xe(3);this.aMa.rd(b);
b=new Oj;b.yTa=this.wDa.Hbf();b.yTa.qPc("pasteHandler");b.Mze=!1;b.uWe=this.kwh(this.UT.dAd,b.uWe);if(c=this.Kk.mfa(a)){this.ioi&&this.Sdl(c,b);for(let f=0;f<this.wpf.length&&this.wpf[f](a,c,b);++f);}this.Xsa&&a.preventDefault();!this.F0&&this.QFf?this.BIl(b):this.mIh(b)}else da.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.yd.kc(be.a.ei,{["Reason"]:Ud.a.g4f}),this.Ca.XAe(G.a.F9),a.preventDefault()}BIl(a){da.ULS.sendTraceTag(24492118,307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");
this.fra();this.s8.Ij(6,()=>{this.wcj(a)})}fra(){this.Jo=this.Isa();this.Jo.Is=!1;this.Jo.Fd=5;this.Jo.fra(null,null,null)}wcj(a){this.Jo&&(this.Jo.close(),this.Jo=null);da.ULS.sendTraceTag(24492119,307,50,"Clipboard commands available. Dismissing progress dialog.");this.mIh(a)}mIh(a){a=this.Lci.create(null,Object(R.a)(this,this.wdj,"doPasteOperation"),a);a.Fm("Browser Pasted (Editing Surface)");a.Lh()}T6j(a,b,c){if(this.gCf||this.BTd){const f=this.Kk.tge(a.rawEvent);if(f&&this.Kk.CFd(this.jd.hn())){let l=
null;if((()=>{let u=this.Kk.ZDd(f,this.qbi,this.UT.Apc);({ndc:l}=u);return u})().returnValue)return c.type=1,c.payload=l,this.BTd&&this.Ed.m1&&a.preventDefault(),!1}}return!0}egl(a,b,c){return this.Vki&&this.Kk.tnk(b)&&(a=this.Kk.Eje(b))?(c.type=2,c.payload=a,!1):!0}F5j(a,b,c){return this.mVd&&(a=this.Kk.pac(b))?(c.type=3,c.payload=a,this.qVd&&c.style&&(c.payload+=c.style),!1):!0}wdj(a,b){var c=this.jd.Lg.xv.style;b&&this.UT.dAd&&"hidden"===c.overflow&&this.UGh(b.uWe);if(c=this.jd.hn()){if(this.Ed.zwa)for(var f=
c.firstChild;f&&1===c.childNodes.length&&ig.a(f);)c=f,f=f.firstChild;if(b&&(this.gCf||this.BTd)&&1===b.type&&this.Kk.CFd(c)&&(f=b.payload)){this.hCf=a;this.UT.s6b(f,l=>{this.J6f(this.hCf,l,b)});return}this.J6f(a,this.jd.dIj(c),b)}}HIf(a){a=this.VRa.create(a,Object(R.a)(this,this.rXh,"teardownPaste"),null);a.Fm("Aborting Paste in ContentEditableView");a.Lh()}J6f(a,b,c){this.Ed.Gk&&(za.a.qw(this.jd.hn()),this.Ed.kna||this.jd.Lg.sqa());if(this.Xsa&&!c)da.ULS.sendTraceTag(508625096,307,10,"No pasteDataContext"),
this.HIf(a);else{c.Mze&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.Mze;this.Xsa&&(f=!c.payload&&f);f?(da.ULS.sendTraceTag(18437454,307,15,""),this.HIf(a)):(c.style&&(b+=c.style),this.jd.m3a(!0),f=new W.DictionaryPropertySet,f.setValue(Oe.a.bW,b),f.setValue(ib.a.Uve,!0),f.setValue(rb.a.kP,!0),1===c.type&&this.UT.xyc?f.setValue(Oe.a.u4c,b):2===c.type&&c.payload?f.setValue(Oe.a.klb,c.payload):3===c.type&&c.payload&&(this.Xsa?f.setValue(Oe.a.bW,c.payload):f.setValue(Oe.a.iXe,c.payload)),this.Z0b&&
c.h_e&&f.setValue(Oe.a.Mth,c.h_e),c.yTa&&f.setValue(Oe.a.yTa,c.yTa),a=this.VRa.create(a,Object(R.a)(this,this.mPi,"callPasteAction"),f),a.Fm("Paste in ContentEditableView"),a.Lh())}}mPi(a,b){this.F0.F9(a,b,!0);a.sh(Object(R.a)(this,this.rXh,"teardownPaste"));return!0}rXh(a){this.Oh.r4a();this.aMa&&(this.aMa.pW(a),this.aMa.dispose(),this.KSd=null);a.sh(Object(R.a)(this,this.C3d,"callPasteFloatie"));return!0}C3d(a,b){a=Object(gb.a)(W.DictionaryPropertySet,b);if(!a||a.ra(Oe.a.klb,null)||a.ra(Oe.a.u4c,
null))return!1;b=new tk(1,A.AFrameworkApplication.isRtl);b.Jel=a.ra(Oe.a.bW,null);this.Ida.o1e(b);return!1}Sdl(a,b){if(a=this.Kk.sag(a)){if(this.Z0b){let c=this.Kk.uag(a);null===c?c="inaccessible":""===c&&(c="unknown");b.h_e=c}this.qVd&&(b.style=this.Kk.vkj(a))}}}Object(m.a)(yk,"PasteHandler",null,[535]);class bm{constructor(a,b,c,f,l){this.sAf=new te.a(RegExp("\u00a0","g")," ");this.XGf=new te.a(new RegExp("["+jc.uRf+jc.Pwg+"]","g"),"");this.yd=a;this.sg=b;this.Gj=c;this.Np=f;this.Ed=l}qTi(a,b,c,
f,l){if(l){l=!1;for(let ja=0;ja<a.length;++ja){const ua=b.Lrh[ja];if(!ua)continue;const Ra=a[ja];var u=Ra.innerHTML,I=ua.html;if(u.length===I.length||u===I)continue;if(Fg.K7c(Ra))continue;l=!0;u=Sys.UI.DomElement.containsCssClass(Ra,ia.a.wX);I=Sys.UI.DomElement.containsCssClass(Ra,fc.a.AO);const eb=Sys.UI.DomElement.containsCssClass(Ra,fc.a.OO);let Bb=!1,Ub=!1;Ra.parentNode&&Ra.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Ra.parentNode.parentNode,fc.a.gde)&&(Bb=Ra.parentNode.parentNode.firstChild===
Ra.parentNode,Ub=Ra.parentNode.parentNode.lastChild===Ra.parentNode);var T=void 0;let Xb;ua.text?(T=za.a.zw(Ra),Xb=ua.text):(T=this.Np.hhe(Ra,this.yd,this.sg),Xb=ua.i$l);const tc=this.sAf.dMa(T).indexOf(this.sAf.dMa(Xb));if(0<=tc){const lc=this.XGf.dMa(Aa.a.substring(T,0,tc));T=this.XGf.dMa(Aa.a.right(T,tc+Xb.length));0<lc.length&&((eb||I||Bb)&&0<ja?(this.Ymd(a[ja-1],lc,!0,this.sg),this.Np.O6c(Ra)&&(f-=jc.DVc)):u&&ja!==a.length-1&&this.Ymd(a[ja+1],lc,!1,this.sg));0<T.length&&((I||Ub||u)&&ja!==a.length-
1?(this.Ymd(a[ja+1],T,!1,this.sg),this.Np.O6c(Ra)&&(f+=jc.W$d)):eb&&0<ja&&this.Ymd(a[ja-1],T,!0,this.sg))}else eb&&(this.Ed.Gk||this.Ed.gp)&&1===Xb.length&&!T.length?da.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):eb&&this.Ed.jg||da.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),u=Xb?Xb.length:0,I=T.length,I>u&&(f-=I-u);ua.text?za.a.yA(Ra,ua.text):(this.Np.Brk(Ra)||ua.G6d.restore(),ua.G6d=new Kd.a(Ra))}l&&this.Gj.MU(f,c)}}Ymd(a,b,c,f){f.n++;c?za.a.yA(a,za.a.zw(a)+b):
za.a.yA(a,b+za.a.zw(a))}}Object(m.a)(bm,"ReadOnlyObjectsCleaner",null,[]);class Hk{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd){this.zka=0;this.jd=a;this.$Ud=b;this.GL=c;this.sg=f;this.yd=l;this.fIc=u;this.Vc=I;this.Gj=T;this.Np=ja;this.Ed=ua;this.xf=Ra;this.Bf=eb;this.$f=Bb;this.Qj=Ub;this.JUd=Xb;this.Tn=tc;this.Cs=lc;this.Zgi=Ec;this.tei=yd}init(a){this.zka=a}qnb(a,b,c,f,l){if(this.jd.isValid){var u=this.jd.hn();u&&u.firstChild&&1!==A.AFrameworkApplication.za.state&&(this.$Ud.zag(this.Vc.Oa),
this.y6e(a,b,c,f,l))}}lNa(a,b,c,f,l){if(this.GL.Cve()&&(!this.Qj||this.xf.Cxh))if(this.GL.setFocus(a,b,c,f,l),this.Ed.oT){a="Window.getSelection";b=this.jd.hn();if(this.Ed.iV){if("none"===b.style.display){da.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!za.a.GXa(this.jd.Lg.KBa,b)){da.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var u=this.Tn.getSelection(this.jd.contentWindow);u&&(a="Selection.removeAllRanges",this.Tn.removeAllRanges(u),
a="Selection.selectAllChildren",this.Tn.xLl(u,b))}catch(I){u=za.a.Jng(b),da.ULS.sendTraceTag(18437461,324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?Sd.a.Eae(b):"",I.stack,b?b.style.display:"",u?u.tagName+","+u.id+","+u.className:"")}}else this.Tn.y6e(this.jd.lva().em)}y6e(a,b,c,f,l){const u=this.Vc.Oa.kb;try{if(this.GL.Cve()&&(!this.Qj||this.xf.Cxh)){var I=u.Ua,T=u.vf,ja=this.JUd.create(this.$f.$d);this.lNa(a,b,c,f,l);a=null;var ua=this.jd.lva();if(this.Ed.oT){a=
this.Tn.getSelection(this.jd.contentWindow);if(!a)return;if(this.Tn.tJj(a)){var Ra=this.Tn.getRangeAt(a,0);this.Tn.removeAllRanges(a)}else Ra=this.Tn.createRange(ua.em)}else if(this.Ed.TG)Ra=ua.selection.createRange();else return;this.Zgi&&this.ARl(Ra);(this.Bf.Tk(I)||this.Bf.Om(I))&&this.cpj(I,Ra);this.Bf.Tk(T)&&this.dpj(T,Ra);this.Ed.oT?this.Tn.addRange(a,Ra):this.Ed.TG&&Ra.select();ja.dispose()}}catch(eb){I=this.jd.hn(),da.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",
eb.message,eb.stack,I?Sd.a.Eae(I):"")}}dpj(a,b){var c=a.node.sc(this.zka).qu;let f=0,l=0,u=0;a=a.Pb;for(var I=!1;f<c.length;){const T=this.Np.cK(c[f],this.sg,this.yd,this.Qj);if(I)u+=T;else if(Sys.UI.DomElement.containsCssClass(c[f],fc.a.AO))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],ia.a.wX)){if(a<=l+T)if(I=a-l,this.Ed.oT){c=c[f];this.fIc.value.U5b(c,this.jd.contentWindow);this.cNh(b,c,I,!1);break}else u=T-I,I=!0;l+=T}f++}this.Ed.TG&&this.Tn.moveEnd(b,-u)}cpj(a,b){var c=a.node.sc(this.zka).qu;
let f=0;var l=0;let u=0,I=a.Ra;for(this.Bf.Om(a)&&(I=this.Cs.textLength(a.node));f<c.length;)if(a=this.Np.cK(c[f],this.sg,this.yd,this.Qj),Sys.UI.DomElement.containsCssClass(c[f],fc.a.AO))l++,f++,u+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],ia.a.wX))f++,u+=a;else if(this.tei&&Sys.UI.DomElement.containsCssClass(c[f],fc.a.ebe))f++,u+=a;else{if(I<=l+a){l=I-l;this.Ed.oT?(c=c[f],this.fIc.value.U5b(c,this.jd.contentWindow),this.cNh(b,c,l,!0)):this.Tn.moveStart(b,u+l);break}l+=a;u+=a;f++}}cNh(a,
b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&da.ULS.sendTraceTag(18437465,324,50,"Span is not normalized"):da.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,u=null;b=za.a.yZc(b,!0);for(const I of b)if(3===I.nodeType){b=I.nodeValue.length;if(c<=l+b){this.Tn.mRb(a,f,I,c-l);return}u=I;l+=b}u?(da.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.Tn.mRb(a,
f,u,c-l)):da.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}Z4f(a,b,c,f,l,u,I){var T=this.Vc.qra;if(T.vye||T.Cwe)return!1;var ja=this.jd.hn();if(!ja.innerHTML.length)return!1;T=!1;if(this.Ed.oT)(b=Sd.a.oGa(this.jd.contentWindow))&&(this.Tn.h2c(b)===ja?T=!0:this.Qj&&Sd.a.Iok(b)&&Sd.a.Hok(b)&&(T=!0));else if(this.Ed.TG){var ua=this.jd.lva().selection.createRange();ua=this.Tn.HCj(ua.range);ua=ua.replace(Aa.a.jIc,"");ja=ja.innerHTML;ja=ja.replace(Aa.a.jIc,"");if(ua===ja)switch(a){case 2:T=
!0;break;case 1:1<b.length||!(this.Bf.Vu(b.kb.Ua)||this.Bf.Om(b.kb.Ua)||this.Bf.Vu(b.kb.vf)||this.Bf.Om(b.kb.vf))||(T=!0)}}if(!T)return!1;this.sg.by++;this.Qj&&c?c.Jua():2===a?this.Gj.MU(this.Gj.xYa,f):1===a&&this.qnb(a,l,u,f,I);return!0}ARl(a){a=za.a.yZc(a.commonAncestorContainer,!0);for(const b of a)b&&(a=za.a.sma(b),a.startsWith("OutlineElement")&&(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&
(b.style.margin=""))}}Object(m.a)(Hk,"SelectContentHelper",null,[]);class Af{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc){this.qka=this.jsa=this.jf=null;this.Oh=a;this.Gj=b;this.sg=Bb;this.Vb=c;this.Af=f;this.jd=l;this.je=u;this.Tn=I;this.Np=T;this.yd=eb;this.Vc=ja;this.Qj=Xb;this.WL=ua;this.PW=Ra;this.Bl=Ub;this.DT=tc}get c3a(){return this.qka||(this.qka=Tb.a.instance.ub("Box4.ISelectionCommands"))}sU(a){this.jf=a}d_j(a,b){if(!a)return!1;var c=this.Oh.mode;if(2===c)if(!this.Gj.gck)this.sg.b++,
this.Gj.MU(this.Gj.xYa,this.Vb.ui);else if(this.Qj){if(500>(new Date).getTime()-this.Af.u_i)return this.jf.Zxb.Ufa=!1;a=Sd.a.oGa(this.jd.contentWindow);if(!a)return!1;if(Sd.a.x8c(a)){b=this.Gj.RZc(c,this.Vb.tj);if(this.Gj.xYa===b&&!this.jf.Zxb.Ufa)return this.jsa&&(this.je.Vg(this.jsa),this.je.Jb(this.jsa)),!1;if(this.DT.AEd())return this.sg.c++,this.jf.Zxb.Ufa=!0,!1;if(this.jf.Zxb.Ufa)return this.sg.d++,this.Af.kca(!0),this.jf.Xt(!0),this.jf.Zxb.Ufa=!1;this.jsa||this.jf.Xt(!0);Qi.GrippersManager.instance.setVisibility(!1);
this.gQl();return!1}if(this.WL.Z4f(c,Me.a.instance.Oa,this.c3a,this.Vb.ui,this.Vb.tj,this.Vb.Pg,this.Bl.value.isEditingAllowed||this.Bl.value.eA))return this.sg.e++,!1;c=this.Np.uje(this.Tn.h2c(a),this.Vb.tj,this.Tn.bpg(a),this.sg,this.yd,this.Qj);a=this.Np.uje(this.Tn.JAj(a),this.Vb.tj,this.Tn.Tig(a),this.sg,this.yd,this.Qj);if(0>c||a<c||$a.ParagraphReader.textLength(b.node)<a)return!1;this.sg.f++;this.Vc.setSelection($d.SelectionFactory.U4(b.node,c,a))}return!1}gQl(){this.jsa?this.je.Vg(this.jsa):
this.jsa=new ne.a(2,1,1E3,()=>{this.fAb()},23);this.je.Jb(this.jsa)}fAb(){if(this.jsa){this.jsa=null;var a=this.Oh.mode;2===a&&this.Vb.vYa(a)&&(this.sg.g++,this.Gj.kUb(a,this.Vb.tj),this.Af.yNa(!0),this.PW.$9b(),this.jf.Xt(!0),Qi.GrippersManager.instance.zRh())}}}Object(m.a)(Af,"SelectionChangeHandler",null,[534]);class rg{constructor(a,b){this.jd=a;this.U0b=b}zag(a){this.bPf(this.jd.hn(),this.U0b+a.Xs,E.a.sJi)}bPf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.Kzl(a),Sys.UI.DomElement.addCssClass(a,
b),Sys.UI.DomElement.addCssClass(a,c),this.bPf(a,b,c))}Kzl(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.U0b)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else da.ULS.sendTraceTag(18437474,324,50,"Class string for DOMElement is null")}}Object(m.a)(rg,"SequenceCodeHelper",null,[533]);class Li{constructor(a,b,c,f){this.sg=f;this.Gj=b;this.yd=c;this.La=a}gnl(a,b,c,f){if(a.pj.length){var l=a.pj[0].DG,u=za.a.zw(l);if((a=a.uNc)&&u&&u.length===a.length+1&&u.endsWith(" ")){var I=
Sd.a.vie(l);I&&((a=ca.a.Ie(l,ia.a.nIa),a=b.qu[a+1],a)?Sd.a.vie(a)!==I&&(c=this.Gj.e$(c,f),f=za.a.zw(a),this.yd.kc("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.sg.q++,za.a.yA(l,u.substring(0,u.length-1)),za.a.yA(a," "+f),this.Gj.MU(c,b)):this.sg.p++)}}}xQi(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.La.getBooleanAppSetting("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,fc.a.DY))for(let u=
0;u<l.childNodes.length;u++)this.sVf(l.childNodes[u],u,b,a,c)&&u--;else this.sVf(l,f,b,a,c)&&f--}}sVf(a,b,c,f,l){const u=a.parentNode;f=u===f;if(3===a.nodeType){let I=-1;const T=a.nodeValue;let ja=null,ua="";if(b){const Ra=u.childNodes[b-1];if(ig.a(Ra)&&(!f||$a.ParagraphReader.ke(ig.a(Ra).eb))){for(ja=Ra;ja.lastChild&&1===ja.lastChild.nodeType;)ja=ja.lastChild;ua=ja.innerText+T}}if(!ja&&b!==u.childNodes.length-1&&(b=u.childNodes[b+1],ig.a(b)&&(!f||$a.ParagraphReader.ke(ig.a(b).eb)))){for(ja=b;ja.firstChild&&
1===ja.firstChild.nodeType;)ja=ja.firstChild;ua=T+ja.innerText}ja?(I=this.Gj.e$(c,u),this.yd.kc("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.sg.r++,za.a.yA(ja,ua)):(this.yd.kc("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),this.sg.s++);u.removeChild(a);-1!==I&&this.Gj.MU(I,l);return!0}return!1}Jyl(a,b,c,f){if(E.a.jg&&a.pj.length){var l=za.a.zw(a.pj[0].DG),u=a.uNc;l&&u&&l.length===u.length+2?this.dDh(0,a,b,c,f):2===a.pj.length&&this.dDh(1,a,b,c,f)}}dDh(a,b,c,f,l){c=
this.Gj.e$(c,f);if((f=za.a.zw(b.pj[a].DG))&&f.endsWith("\u00a0 ")){this.sg.t++;var u=f.lastIndexOf("\u00a0 ");f=f.substr(0,u)+" ";b.pj[a].DG.innerText=f;(0<a?c-(b.pj[0].hQc+za.a.zw(b.pj[0].DG).length):c-b.pj[0].hQc)>f.length&&c--;this.Gj.MU(c,l)}}}Object(m.a)(Li,"StrayTextCleanupUtils",null,[]);class Vf{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.Fja=null;this.KWd=a;this.Wrb=b;this.YKd=c;this.yd=f;this.pka=l;this.Oh=u;this.Vc=I;this.M8=T;this.Ed=ja;this.Af=ua;this.Al=Ra;this.sD=
eb;this.Rja=Bb;this.Yt=Ub;this.gX=Xb;this.bda=tc;this.Vb=lc;this.ZRa=Ec;this.zd=hd}get gfa(){return this.Fja||(this.Fja=Tb.a.instance.ub("Box4.IFormatPainter"))}npb(a,b){if(!b)return!1;if(this.KWd.BPh)return a.hc.preventDefault(),!0;if(this.Wrb.sab&&this.Ed.qwa)return this.Wrb.sab=!1,this.YKd.cancelEventAndRestoreEditingSurface(a.hc),!0;this.gfa&&this.gfa.JM&&(this.gfa.JM=!1);this.oVj(a.hc);b=this.yd.Cq(G.a.Nz);b.properties.$(Mc.a.source,"TextInput");a=this.Q9l(a);b.end();return a}Q9l(a){this.pka.fAb();
if(1===this.Oh.mode){if(this.gX.$9e())this.Vc.setSelection($d.SelectionFactory.fh(Me.a.instance.Oa.kb.Ua.node,Me.a.instance.Oa.kb.Ua.Ra));else if(this.M8.y$e()){if(this.gX.zWe(a))return!1;this.M8.startHybridTransition()}this.Ed.OD&&this.gX.W1d()}this.bda.raiseEvent(Ig.a.R9l,a);this.Af.kca(!0);this.Al.gef=!0;this.sD.uSa(a);this.ZRa&&this.ZRa.kDm(this.Vb.ui);this.Rja.iLb();this.Yt.v_();return!1}oVj(a){this.Ed.jg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Al.X9d=!this.Al.G4,this.Al.X9d&&
A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("DeleteFromInputEventIsEnabled")&&(a=Vf.Y3d.RZc(2,this.Vb.tj),a<Vf.Y3d.xYa&&(a=$d.SelectionFactory.U4(this.Vb.Pg,a,Vf.Y3d.xYa),A.AFrameworkApplication.Pa.Ia(G.a.oUa,2,a))))}static get Y3d(){return Vf.Gj||(Vf.Gj=Tb.a.instance.resolve("Box4.ICaretPositionManager"))}}Vf.Gj=null;Vf.DT=null;Vf.pJ=null;Object(m.a)(Vf,"TextInputEventProcessor",null,[]);class Ej{constructor(a,b,c,f,l,u){this.GL=a;this.Ed=b;this.xf=c;this.Al=f;this.Bl=
l;this.zd=u}get mfb(){return this.zd.Gg&&this.zd.wD}get BPh(){if(this.GL.udc||!this.Bl.value.isEditingAllowed&&this.Bl.value.eA&&!this.mfb)return!0;if(this.Ed.S$){var a=this.xf.Wuk;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Al.mze;if(500>a&&a<b)return!0}}return!1}}Object(m.a)(Ej,"TextInputHandlerUtils",null,[]);var Tj=d(526),dj=d(311);class Pl{constructor(a,b,c,f){this.qsa=null;this.Ed=a;this.GL=b;this.$f=c;this.Bf=f}onContextMenu(a,b){let c=!1;this.Ed.S$&&this.GL.D7c&&(b=this.Bf.myb(this.$f.$d,
b,this.$f.$d.qma(a),!1),this.Bf.uy(b)&&(c=!0));c?(this.qsa=a.clientPoint,a=!0):(this.qsa=null,a=this.$f.$d.onContextMenu(a));return a}Nrc(a){if(this.Ed.S$&&this.qsa){const b=dj.a.eff;if(a.clientPoint.x>this.qsa.x+b||a.clientPoint.x<this.qsa.x-b||a.clientPoint.y>this.qsa.y+b||a.clientPoint.y<this.qsa.y-b)this.qsa=null}return!1}AMb(a){let b=!1;this.Ed.S$&&this.qsa&&(b=this.$f.$d.onContextMenu(a),this.qsa=null);return b}}Object(m.a)(Pl,"TouchEventProcessor",null,[]);class Si{create(a){return new Wa(a)}}
Object(m.a)(Si,"TypingActionOperationFactory",null,[527]);var Le=d(72),uj=d(250);class Tk{constructor(a,b,c,f,l,u){this.uHf=0;this.Wxf=Ua.a.nil;this.ZYb=this.hHc=!1;this.Lwf=4===ad.App.mode;this.EJc=!1;this.Cqi=new id.a;this.Cqi.add(0,G.a.m4e);this.AMc=new id.a;this.AMc.add(0,0);this.Eyf=a;this.C8=b;this.$f=c;this.Io=f;this.Dqi=l;this.dJd=u;this.Gxf=Object(R.a)(this,this.PEl,"reportTypingCharCount");A.AFrameworkApplication.Jia(()=>{this.uEk()});this.dJd&&this.Hwl();this.Gwl();A.AFrameworkApplication.Pa&&
A.AFrameworkApplication.Pa.pa(G.a.m4e,Le.a.frame,ff.ActionManager.uh,96)}Hwl(){this.Io&&this.Io.addHandler(td.a.nz,this.Gxf)}Gwl(){this.C8&&this.C8.ALf(Object(R.a)(this,this.ROc,"afterEditingViewValidateEventHandler"))}cwc(a){this.Eyf.value&&0===this.Eyf.value.mode||(a=new Wa(a),a.end(8),Fi.a.getInstance().lvc(a),Da.a.getInstance().kvc(a))}Xlh(a,b){if(!this.Lwf&&ad.App.Ob&&2===ad.App.Ob.mode&&b&&b.graphNode&&$a.ParagraphReader.ke(b.graphNode)&&!We.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.Wxf){if(this.EJc){var c;
(c=this.AMc).$(0,c.ga(0)+1);A.AFrameworkApplication.Pa.nb(G.a.m4e,2);c="Paragraph rendering is blocked";this.Dqi&&(c+=", so graph transaction manager is reset",uj.GraphTransactionManager.instance.$8e());da.ULS.sendTraceTag(38547550,323,15,c)}this.Wxf=a;this.EJc=!0}}else this.EJc=!1}ROc(a,b){this.Lwf||!b.dO&&!b.nW||(!this.hHc&&this.$f.$d&&(this.$f.$d.Ayi(Object(R.a)(this,this.Xlh,"onContentEditableViewClick")),this.hHc=!0),this.EJc=!1)}PEl(){this.uHf++}Omm(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",
a,b),da.ULS.sendTraceTag(18437207,323,15,a))}uEk(){this.ZYb||(this.dJd&&(da.ULS.sendTraceTag(38114780,323,50,""+this.uHf),this.Ycj(),this.dJd=!1),0<this.AMc.ga(0)&&da.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.AMc.ga(0)),this.Xcj(),this.ZYb=!0)}Ycj(){this.Io&&this.Io.removeHandler(td.a.nz,this.Gxf)}Xcj(){this.C8&&this.C8.bBl(Object(R.a)(this,this.ROc,"afterEditingViewValidateEventHandler"));this.hHc&&this.$f.$d&&(this.$f.$d.fBl(Object(R.a)(this,this.Xlh,"onContentEditableViewClick")),
this.hHc=!1)}}Object(m.a)(Tk,"TypingLogger",null,[159]);const bk=a=>{A.AFrameworkApplication.fa.getBooleanAppSetting("TypingSurveyIsEnabled")&&(a.execute(b=>{b.ohc("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};class Ql{constructor(a){this.F6c=!1;this.vab=5;this.Oih=!1;this.hSe=!0;this.kb=a}}Object(m.a)(Ql,"TypingProcessState",null,[]);class lk{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,
ug,Tg,$f,Ve,xg,yg,ng){this.wka=this.jf=null;this.Xpb=!1;this.rEd=null;this.M9c=0;this.YXb=a;this.Vb=b;this.tNd=c;this.Gj=f;this.X7a=l;this.Io=u;this.SHc=I;this.X_=T;this.PW=ja;this.Af=ua;this.wsa=Ra;this.Vc=eb;this.JL=Bb;this.Rja=Ub;this.yd=Xb;this.sg=tc;this.pJ=lc;this.je=Ec;this.Al=hd;this.Wh=yd;this.JE=Pd;this.Esa=pe;this.lja=Se;this.Ed=vf;this.Oja=ug;this.lm=Tg;this.Yt=$f;this.omi=Ve;this.aWd=xg;this.Mr=yg;this.zd=ng;this.Hxf=0;this.etf=!1;this.Eak()}sU(a){this.jf=a}get x4a(){return this.wka||
(this.wka=Tb.a.instance.ub("Box4.ITextFormattingCommands"))}cfm(){Qf.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.zd.vwb();try{this.M9c=0;if(this.jf.lcl.jem()||2!==this.Af.mode||!this.Af.isActive||A.AFrameworkApplication.Dh||!this.Vb.Pg||this.tNd.correctBadImeState())return;this.Gj.kUb(this.Af.mode,this.Vb.tj);this.X7a.Ohf();this.CTi();this.Io.raiseEvent(td.a.KOa);if(!this.Vb.bUa||(2==ad.App.mode||Nb.a("SkipTypingProcessorDuringComposition"))&&this.Mr.isComposing)return;const b=
new Ql(this.X_.kva(this.PW.aaa));if(this.SHc.Oll(b))return;b.F6c||(this.Af.kca(!0),b.Oih=!0);this.Ull(b);if(!this.Vb.vYa(this.Af.mode))return;const c=this.Vb.NX.eb;this.zd.Gg&&(c.mLb=this.Vc.Oa.kb.Ua.Ra);b.Oih&&U.a.instance.ga(50)&&this.wsa.value&&this.wsa.value.qy&&this.Vc.v2b();if(b.hSe){try{this.Rja.iLb()}catch(f){this.yd.kc("PossibleEditSurfaceIncorrectSize",{["Reason"]:"MirrorToPageViewCrash"}),this.sg.l++,this.pJ.Xt(!1,!1)}this.Yt.v_();this.Mr.aIa&&(this.pJ.Xt(!0,!0),this.PRi())}}finally{a&&
a.dispose()}Qf.c(18437510,306,100,"TypingProcessInternalExited")}PRi(){ad.App.Ob.Y1j&&ad.App.Ob.HIl()}uSa(a){this.SHc.gwh(a);this.Xpb||(this.Xpb=!0,this.je.Jb(this.rEd))}D$i(){if(!this.Al.G4&&!this.Al.oua)return!1;const a=!this.wsa.value||this.wsa.value.amIAlone?lk.sTj:lk.rTj,b=this.YXb();-1===this.Al.f$c&&(this.Al.f$c=b);return b-this.Al.f$c<a?(this.je.Jb(this.rEd),this.Xpb=!0):!1}KOa(){if(this.Xpb&&(this.Xpb=!1,this.Hxf++,!this.je.Dx&&this.Vb.vYa(this.Af.mode)&&!(this.JL&&this.JL.Ndb()||this.D$i()))){var a=
this.yd.Cq(G.a.KOa);this.cfm();a.end();this.etf||this.Hxf!==lk.rRi||((a=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback"))&&bk(a),this.etf=!0)}}CTi(){if(this.Mr.aIa){if(this.Wh.eJf())if((this.Ed.WD||this.Ed.gp)&&this.JE.c9){const a=this.Gj.e$(this.Af.mode,this.Vb.tj);this.JE.Pnb(!1,this.Vb.tj,this.Wh);this.Gj.MU(a,this.Vb.ui)}else this.JE.Pnb(!1,this.Vb.tj,this.Wh);this.omi.qTi(this.Vb.ui.qu,this.Esa,this.Vb.ui,this.Gj.e$(this.Af.mode,this.Vb.tj),this.Mr.aIa);this.aWd.xQi(this.Vb.tj,this.Af.mode,
this.Vb.ui);this.aWd.gnl(this.Wh,this.Vb.ui,this.Af.mode,this.Vb.tj);this.Wh.Oyl();this.aWd.Jyl(this.Wh,this.Af.mode,this.Vb.tj,this.Vb.ui)}}Ull(a){this.lja.QS?(this.lja.vfl(),a.hSe=!1):this.Oja.instance&&this.Oja.instance.Jne()&&!this.Ed.VSb&&(this.Mr.aIa&&this.x4a?(this.wEi(a.kb),a.hSe=!1):this.Oja.instance.H2a())}wEi(a){if(this.x4a&&this.Oja.instance){this.Oja.instance.freeze();var b=Me.a.instance.Oa.kb,c=this.lm.xe(15);c.rd(this.Vb.Pg.node);a=$d.SelectionFactory.PO(a,b.Ua);this.x4a.bRb(a.Ua,!0);
this.Oja.instance.qef();this.Oja.instance.H2a();this.Vb.ui&&this.Vc.setSelection(this.X_.kva(this.PW.aaa));c.dispose();this.Af.kca(!0);this.pJ.Xt(!0,!1)}}Eak(){let a=1;E.a.gp&&(a=A.AFrameworkApplication.fa.tc("Box4TypingTaskTimeEdge",1));this.rEd=new ne.a(0,1,a,()=>{this.KOa()},25)}dispose(){this.rEd=null}uQh(a){return this.Ed.S$&&a?this.lja.QS||this.M9c>lk.SWk||this.Oja.instance&&this.Oja.instance.Jne()||this.JE.c9?!0:!1:!1}}lk.SWk=7;lk.rTj=250;lk.sTj=2E3;lk.rRi=500;Object(m.a)(lk,"TypingProcessManager",
null,[520,106]);class qm{constructor(){this.Ma=new uc.a}zpl(a){this.Ma.raiseEvent("OnDismissPasteFloatie",a)}Fpl(){this.Ma.raiseEvent("OnExpandMenuPasteFloatie")}SOb(a){this.Ma.raiseEvent("OnPastedContentUpdated",a)}o1e(a){this.Ma.raiseEvent("OnShowPasteFloatie",a)}nzi(a){this.Ma.addHandler("OnPastedContentUpdated",a)}Oyi(a){this.Ma.addHandler("OnDismissPasteFloatie",a)}Uyi(a){this.Ma.addHandler("OnExpandMenuPasteFloatie",a)}Izi(a){this.Ma.addHandler("OnShowPasteFloatie",a)}}Object(m.a)(qm,"PasteFloatieEventSource",
null,[512,513,514]);var cm=d(900),Uh=d(133),cg=d(327),Pj=d(412),Rl=d(230),Uk=d(855);class Sl{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}fc(a){this.Da=a;a.register(Tj.a,"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().na(()=>new Tj.a);a.register($g,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().na(()=>new $g);a.register(ij,"Box4.EventFrequencyTracker").ma().na(()=>new ij);a.register(aj,"Box4.CevUsageDataTracker").ma().na(()=>new aj);
a.register(xf,"Box4.ContentEditableViewEventSource").ma().na(()=>new xf);a.register(Nj,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().na(()=>new Nj(jd.a.instance,cd.a.instance.jge(),a.resolve("Box4.TextNodeCombiner")));a.register(of,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().na(()=>new of(jd.a.instance,cd.a.instance.jge(),Fg.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(dg,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().na(()=>
new dg);a.register(kc,"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().na(()=>new kc(a.resolve("Box4.IEditingDomManager")));a.register(Ki,"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().na(()=>new Ki(a.resolve("Box4.EditStateEventManager"),jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("RemovePaddingHighlightEnabled")));a.register(159,
"Box4.ITypingLogger").ma().na(()=>new Tk(a.ze("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),Ha.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("QoECharCountIsEnabled")));a.register(Zf,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().na(()=>new Zf(a.ze("Box4.ITextNodeCombiner"),
jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.EditingDomManager"),Fg.instance,Id.a.instance,Ha.InteractiveViewManager.instance,A.AFrameworkApplication.Be,Id.a.instance.Aj,cm.a.instance,a.resolve("Common.IScrollLockFactory"),a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(fi,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().na(()=>new fi(a.resolve("Box4.EditingDomManager"),Ha.InteractiveViewManager.instance,
a.resolve("Box4.IExternalSelectionManager"),Id.a.instance.Aj,ze.a.instance,Id.a.instance,F.FocusManager.instance()));a.register(bm,"Box4.ReadOnlyObjectsCleaner").ma().na(()=>new bm(jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.CaretPositionManager"),Fg.instance,Id.a.instance));a.register(Li,"Box4.StrayTextCleanupUtils").ma().na(()=>new Li(A.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ));a.register(160,
"Box4.IContentEditableViewContentControlHelper").ma().na(()=>new ki(jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,Id.a.instance.Aj,Fg.instance,Ha.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(Eb,"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().na(()=>new Eb(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").LJ,
jd.a.instance,a.ub("Box4.IHyperlinkEditor"),Id.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),cm.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Common.IAppSettingsManager")));a.register(Qc,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().na(()=>new Qc(a.Ha("Common.ITypingSpeedMeterProvider"),Ha.InteractiveViewManager.instance));a.register(sk,"Box4.ContentEditableViewTypingState").ma().na(()=>new sk(A.AFrameworkApplication.Pa));
a.register(bf,"Box4.ContentEditableHtmlStructureUtils").ma().na(()=>new bf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(rg,"Box4.SequenceCodeHelper").ma().na(()=>new rg(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").QKh));a.register(Hk,"Box4.SelectContentHelper").ma().na(()=>new Hk(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").LJ,
jd.a.instance,a.ze("Box4.ITextNodeCombiner"),Me.a.instance,a.resolve("Box4.ICaretPositionManager"),Fg.instance,Id.a.instance,Ie.EventHandlerManager.instance,cg.a.instance,Ha.InteractiveViewManager.instance,Id.a.instance.Aj,a.resolve("Common.ScrollLockFactory"),cm.a.instance,a.resolve("Box4.IParagraphReader"),Kc.ListReader.wy,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(Gd,
"Box4.EditingDomDisplayManipulator").ma().na(()=>new Gd(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),A.AFrameworkApplication.fa,Ha.InteractiveViewManager.instance));a.register(Wc,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().na(()=>new Wc(a.resolve("Box4.ContentEditableViewEventSource")));a.register(Jc,"Box4.InteractiveViewSynchronizer").ma().na(()=>new Jc(a.resolve("Box4.ICurrentlyActiveContentSpans"),
a.resolve("Box4.CevUsageDataTracker").LJ,jd.a.instance,Id.a.instance.Aj,a.resolve("Box4.Graph.IGraphIteratorFactory"),Fg.instance,Ha.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager")));a.register(kk,"Box4.CurrentEditSelectionProvider").ma().na(()=>new kk(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").LJ,jd.a.instance,Fg.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
Id.a.instance.Aj,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Hd,"Box4.BackspaceInBrowserHandler").ma().na(()=>new Hd(a.resolve("Box4.CurrentEditSelectionProvider"),Id.a.instance.Aj,mi.a.instance,cg.a.instance,a.resolve("Box4.IExternalSelectionManager"),Rl.a.instance,A.AFrameworkApplication.fa.getBooleanAppSetting("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),A.AFrameworkApplication.fa.getBooleanAppSetting("AutoCorrectUndoByBackspaceIsEnabled")?
a.Ha("Box4.IAutoCorrectScheduler"):null));a.register(om,"Box4.OvertypeDomPreparer").ma().na(()=>new om(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),Me.a.instance,jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,Fg.instance,Id.a.instance.Aj,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(rl,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().na(()=>new rl(cg.a.instance,Me.a.instance,jd.a.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.EditStateEventManager"),Ha.InteractiveViewManager.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),Id.a.instance,a.resolve("Box4.SelectContentHelper"),new Hc.a(()=>ad.App.Ob.ie),a.Ha("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),A.AFrameworkApplication.fa,A.AFrameworkApplication.Pa,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(qm,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().na(()=>new qm);a.register(af,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().na(()=>new af);a.register(Zc,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().na(()=>new Zc(a.Ha("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ha("Common.IZoomManager"),
a.resolve("Box4.EditingDomDisplayManipulator"),Id.a.instance,Ha.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IRotatingCoordinateConverter")));a.register(Ih,"Box4.EditingSurfaceStateManager").ma().na(()=>new Ih);a.register(pi,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().na(()=>new pi(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),A.AFrameworkApplication.Be,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new Hc.a(()=>ad.App.Ob.ie),Id.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),Me.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),Ha.InteractiveViewManager.instance,cg.a.instance,a.resolve("Box4.IInteractiveEventHandler"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(pm,"Box4.ParagraphOverlayPositioner").ma().na(()=>new pm(a.resolve("Box4.IEditingDomManager"),new Uk.a,Ha.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(tj,"Box4.ContentEditableViewDebugLogger").ma().na(()=>new tj);a.register(oc,"Box4.ImeRecoveryUtils").ma().na(()=>new oc(Id.a.instance,
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.ContentEditableViewDebugLogger"),cm.a.instance));a.register(je,"Box4.AutocorrectActionExecutor").ma().na(()=>new je(a.Ha("Box4.IAutoCorrectScheduler"),a.Ha("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),
a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),a.ze("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),Me.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(yk,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().na(()=>
new yk(a.resolve("Common.IAppSettingsManager"),A.AFrameworkApplication.Be,jd.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),Me.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),Ha.InteractiveViewManager.instance,Id.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new Hc.a(()=>ad.App.Ob.ie),a.Ha("Box4.IClipboardCommands"),
a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),A.AFrameworkApplication.Pa,Cd.a.get_instance(),()=>new ue.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),ad.App.instance.Tec,ad.App.instance.NRb));a.register(Aj,"Box4.ContentEditableViewCursorManager").ma().na(()=>new Aj(Ha.InteractiveViewManager.instance,
jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,Id.a.instance.Aj,Me.a.instance,cg.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new Hc.a(()=>ad.App.Ob.ie),A.AFrameworkApplication.Pa,a.resolve("Box4.IEditViewStateManager"),A.AFrameworkApplication.Be,Id.a.instance,a.resolve("Box4.ICaretPositionManager"),Fg.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),new Ee,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.ub("Box4.CharacterPointConverter")));a.register(Af,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().na(()=>new Af(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),A.AFrameworkApplication.Be,
cm.a.instance,Fg.instance,Me.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,new Hc.a(()=>ad.App.Ob.ie),Id.a.instance.Aj,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(lb,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().na(()=>new lb(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),
a.ze("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),Ha.InteractiveViewManager.instance,A.AFrameworkApplication.Be,new Hc.a(()=>ad.App.Ob.ie),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),
Me.a.instance,mi.a.instance));a.register(fe,"Box4.CompositionStateManager").ma().na(()=>new fe(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(Lb,"Box4.ImeManager").ma().na(()=>new Lb(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),Ha.InteractiveViewManager.instance));a.register(xh,
"Box4.DragStateManager").ma().na(()=>new xh(Id.a.instance));a.register(Pl,"Box4.TouchEventProcessor").ma().na(()=>new Pl(Id.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),Ha.InteractiveViewManager.instance,cg.a.instance));a.register(qc,"Box4.AppFrameResizeEventProcessor").ma().na(()=>new qc(a.resolve("Box4.BoundsSynchronizer")));a.register(qd,"Box4.OnScrollProcessor").ma().na(()=>new qd(a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),
a.resolve("Box4.BoundsSynchronizer")));a.register(Ri,"Box4.EditingSurfaceEventHandlerUtils").ma().na(()=>new Ri(jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.IEditingModeTransitionManager")));a.register(vi,"Box4.DragEventsProcessor").ma().na(()=>new vi(Id.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(bh,"Box4.DoubleClickProcessor").ma().na(()=>new bh(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),
a.resolve("Box4.CevViewContentManager"),Ha.InteractiveViewManager.instance));a.register(cj,"Box4.DomChangeEventProcessor").ma().na(()=>new cj(Id.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),jd.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),A.AFrameworkApplication.fa.getBooleanAppSetting("SkipUpdateGraphWhenComposing")));a.register(Ej,"Box4.TextInputHandlerUtils").ma().na(()=>
new Ej(a.resolve("Box4.IContentEditableViewFocusHelper"),Id.a.instance,Ie.EventHandlerManager.instance,a.resolve("Box4.ContentEditableViewTypingState"),new Hc.a(()=>ad.App.Ob.ie),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Cg,"Box4.ContentEditableViewGraphUpdater").ma().na(()=>new Cg(Xe.a.instance,a.resolve("Box4.EditingModeTransitionManager"),jd.a.instance,Me.a.instance,a.resolve("Box4.IExternalSelectionManager"),cg.a.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),
a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.HybridTransitionManager"),A.AFrameworkApplication.Be,Id.a.instance,a.Ha("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),
a.ub("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(Gc,"Box4.KeyEntryProcessor").ma().na(()=>new Gc(Fg.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").LJ,jd.a.instance,Id.a.instance.Aj,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),
a.resolve("Box4.ContentEditableViewCursorManager"),cg.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditViewStateManager")));a.register(Jf,"Box4.KeyQueueProcessor").ma().na(()=>new Jf(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),cg.a.instance,Me.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(lk,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().na(()=>
new lk(Sd.a.jj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new Hc.a(()=>ad.App.ni),Me.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),
jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.ContentEditableViewGraphUpdater"),A.AFrameworkApplication.Be,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),Id.a.instance,a.Ha("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),
a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ol,"Box4.OvertypeUtils").ma().na(()=>new Ol(new Ld(A.AFrameworkApplication.Be),a.resolve("Box4.EditingModeTransitionManager"),Id.a.instance,Me.a.instance,a.resolve("Box4.ITypingLogger"),cg.a.instance,new Hc.a(()=>ad.App.Ob.ie),Ha.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.HybridTransitionManager"),Id.a.instance.Aj,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Eh,"Box4.ContentEditableViewFloatieHandler").ma().na(()=>new Eh);a.register(Bd,"Box4.KeyUpProcessor").ma().na(()=>new Bd(jd.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),
a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new Hc.a(()=>ad.App.Ob.ie),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("TableEditingSelectIsEnabled");a.register(qe,"Box4.KeyPressProcessor").ma().na(()=>
new qe(Id.a.instance,cm.a.instance,jd.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new Hc.a(()=>ad.App.Ob.ie),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),Me.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),Fg.instance,a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new Hc.a(()=>ad.App.ni),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ha("Common.ITypingSpeedMeterProvider"),b,Uh.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.ub("Common.IEventTimingMeter")));a.register(Yb,
"Box4.KeyDownProcessor").ma().na(()=>new Yb(a.Ha("Common.ITypingSpeedMeterProvider"),Id.a.instance.Aj,A.AFrameworkApplication.Be,a.resolve("Box4.IEditingDomManager"),jd.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),Id.a.instance,cm.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),
cg.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new Hc.a(()=>ad.App.ni),Me.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.ze("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new Hc.a(()=>ad.App.Ob.ie),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),A.AFrameworkApplication.fa.getBooleanAppSetting("SkipUpdateGraphWhenComposing"),a.resolve("Box4.Graph.IGraphTransactionFactory"),A.AFrameworkApplication.Pa,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.ub("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),
Pj.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),A.AFrameworkApplication.fa.getBooleanAppSetting("AutoCorrectUndoByBackspaceIsEnabled")?a.Ha("Box4.IAutoCorrectScheduler"):null,A.AFrameworkApplication.fa,a.ub("Box4.IHyperlinkEditor")));a.register(bi,"Box4.ContentEditableViewOnAfterValidateHandler").ma().na(()=>new bi(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),
a.resolve("Box4.CevViewContentManager"),Ha.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.IContentEditableViewPaddingManager"),Id.a.instance,a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.ze("Box4.ITextNodeCombiner"),
a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),Me.a.instance,Id.a.instance.Aj,a.resolve("Box4.SelectContentHelper"),new Hc.a(()=>ad.App.Ob.ie),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.ub("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.ub("Box4.IFeatureHelper")));a.register(Og,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().na(()=>
new Og(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));a.register(wg,"Box4.CompositionEventProcessor").ma().na(()=>new wg(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),jd.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),A.AFrameworkApplication.fa.getBooleanAppSetting("SkipUpdateGraphWhenComposing")));a.register(Vf,"Box4.TextInputEventProcessor").ma().na(()=>new Vf(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),
jd.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),Me.a.instance,a.resolve("Box4.HybridTransitionManager"),Id.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),
a.ub("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(sd,"Box4.LostFocusEventProcessor").ma().na(()=>new sd(a.resolve("Box4.ContentEditableViewGraphUpdater")));a.register(li,"Box4.EditingSurfaceEventHandlerManager").ma().na(()=>new li(A.AFrameworkApplication.Be,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),
a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),
a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")?a.resolve("Box4.ContentEditableViewEventSource"):null,a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")));a.register(Pi,"Box4.ContentEditableViewDisposer").ma().na(()=>new Pi(a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.TypingProcessManager"),
a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").LJ,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(Si,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().na(()=>new Si);a.register(161,"Box4.IContentEditableModeHelper").ma().na(()=>new Ag);a.register(nf,"Box4.ContentEditableView").as("Box4.IEditingView").ma().na(()=>new nf(Ha.InteractiveViewManager.instance,
Me.a.instance,new Hc.a(()=>ad.App.Ob.ie),a.Ha("Common.IActivityAggregationInfo"),a.Ha("Common.IZoomManager"),A.AFrameworkApplication.Pa,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),
a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),ad.App.wOa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").g4b(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.BoundsSynchronizer").g4b(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ImeRecoveryUtils").g4b(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").mIi(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.SelectionChangeHandler").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewGraphUpdater").sU(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.TypingProcessManager").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").sU(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.CompositionEventProcessor").sU(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){C.a.instance.Ac(new Sl)}}
Object(m.a)(Sl,"ContentEditableViewPackage",null,[2,3]);var Ti=d(13);class Jg{get name(){return"PowerPointWebEditor.AutoFit"}fc(){Object(Ti.a)("AutoFit")}init(){Object(Ti.b)("AutoFit")}dispose(){}static main(){C.a.instance.Ac(new Jg)}}Object(m.a)(Jg,"PPTWebEditorAutoFitPackage",null,[2,3]);var Uj=d(252),sl=d(267),Bm=d(529),yb=d(38),zk=d(1154),ya=d(27),md=d(30);class tl{constructor(a,b,c,f,l,u,I,T,ja){this.och=this.Eic=this.tnc=this.xQg=!1;this.phk=()=>this.xQg||this.tnc||this.Eic||Object(md.a)("DocStateTrackerListenToSlidesRemoved")&&
this.och;this.eMb=()=>{this.xQg=!0;this.QSg.execute(ua=>{ua.qBl(this.eMb)});this.bqb()};this.trc=()=>{this.tnc=!0;this.Ng.pEh(this.trc);this.bqb()};this.jrc=()=>{this.Eic=!0;this.Ng.IDh(this.jrc);this.bqb()};this.k8k=(ua,Ra)=>{ua=Ra.property;ua!==rb.a.ITa&&ua!==yb.a.pptSectionContentNode||this.bqb();Object(md.a)("DocStateTrackerListenToClpChange")&&ua===yb.a.rlb&&this.bqb()};this.YUe=()=>{this.bqb()};this.Dok=()=>{if(!this.tHb.instance)return!1;const ua=this.tHb.instance.zv;if(!ua)return!1;for(const Ra of ua.SensitivityLabels)if(Ra.Id===
ua.AppliedPolicyId)return this.tHb.instance.afb(Ra);return!1};this.MZ=()=>{this.och=!0;this.jh.Mvc(this.MZ);this.bqb()};this.VTa=(ua,Ra)=>{Ra=Ra?new Uj.a:new Bm.a;Ra.parentPath=["session"];const eb=new sl.a;eb.id="docState";eb.body=Object.assign(new zk.PowerPointDocumentStateAnnotations,{["isDocDirty"]:ua.isDocDirty,["isCreateNew"]:ua.isCreateNew,["isIrm"]:ua.isIrm,["hasSection"]:ua.hasSection,["slideCount"]:ua.slideCount,["isCreateNewFromBlank"]:ua.NDb});Ra.items=[eb];return Ra};this.icb=()=>{const ua=
this.Wb.IGa();let Ra=this.pLk();Object(md.a)("DocStateTrackerCheckLabelFromPolicyManager")&&(Ra=Ra||this.Dok());let eb;eb=Object(md.a)("DocStateTrackerReadCreateNewFromBlankSetting")&&this.ka.du("newFromBlank")?this.ka.isCreateNew&&this.ka.getBooleanAppSetting("newFromBlank"):this.ka.isCreateNew&&(!this.ka.a8||"blank"===this.ka.a8);return{isDocDirty:this.phk(),isIrm:Ra,isCreateNew:this.ka.isCreateNew,slideCount:this.Wb.Hi(),hasSection:null!==ua&&void 0!==ua&&0<ua.length,NDb:eb}};this.ihl=()=>{this.njc=
this.icb();ya.a.J(508696470,817,50,`DocumentStateTracker::populateInitialState: ${e(this.njc)}`);this.sHb.execute(ua=>{ua.aM(zk.PowerPointDocumentStateAnnotations.getTypeName());ua.submitOperation(this.VTa(this.njc,!0))})};this.bqb=()=>{const ua=this.icb();k(this.njc,ua)||(ya.a.J(508696469,817,50,`DocumentStateTracker::updateDocumentState: ${e(ua)}`),this.njc=ua,this.sHb.execute(Ra=>{Ra.submitOperation(this.VTa(this.njc,!1))}))};if(!a)throw Error.argumentNull("appSettings");if(!b)throw Error.argumentNull("coreEventSource");
if(!c)throw Error.argumentNull("presHandler");if(!f)throw Error.argumentNull("presentationReader");if(!l)throw Error.argumentNull("futureAugLoopRuntimeManager");if(!u)throw Error.argumentNull("futureEditNotificationEventSource");if(!I)throw Error.argumentNull("futurePolicyManager");if(!T)throw Error.argumentNull("isIrmProtectedFunc");if(!ja)throw Error.argumentNull("graphOperationEventHandlers");this.ka=a;this.Ng=b;this.H_a=c;this.Wb=f;this.sHb=l;this.QSg=u;this.tHb=I;this.pLk=T;this.jh=ja;this.ihl();
this.QSg.execute(ua=>{ua.vvb(this.eMb)});this.Ng.wOc(this.trc);this.Ng.jOc(this.jrc);this.H_a.Ak(this.k8k);Object(md.a)("DocStateTrackerListenToClpChange")&&this.tHb.execute(ua=>{ua.Z2b(this.YUe)});Object(md.a)("DocStateTrackerListenToSlidesRemoved")&&this.jh.wvb(this.MZ)}}Object(m.a)(tl,"CopilotDocumentStateTracker",null,[658]);var Jh=d(92);class pn{constructor(a,b,c,f){if(!a)throw Error.argumentNull("appSettings");if(!b)throw Error.argumentNull("appSettingsManager");if(!c)throw Error.argumentNull("futureApplicationFeatureHelper");
if(!f)throw Error.argumentNull("futureCloudPolicySettingsHelper");this.ka=a;this.Lb=b;this.mJk=c;this.nJk=f}Lge(){return Object(Jh.b)(this,void 0,void 0,function*(){if(!this.ka.getBooleanAppSetting("CopilotChatMasterSwitch"))return Promise.resolve(1);if(this.ka.Afk)return Promise.resolve(0);if(!this.ka.getBooleanAppSetting("CopilotChatLicenseCheckEnabled"))return Promise.resolve(2);yield this.hGd();try{if(!(yield this.$tg()))return Promise.resolve(4)}catch(a){return ya.a.J(508409413,817,10,`ApplicationFeatureHelper isFeatureEnabled failed: ${a}`),
Promise.resolve(3)}return Promise.resolve(0)})}Sxj(){return Object(Jh.b)(this,void 0,void 0,function*(){if(!this.ka.getBooleanAppSetting("CopilotStartMasterSwitch"))return Promise.resolve(1);yield this.hGd();try{if(!(yield this.$tg()))return Promise.resolve(4)}catch(a){return ya.a.J(508409415,817,10,`ApplicationFeatureHelper isFeatureEnabled failed: ${a}`),Promise.resolve(3)}if(Object(md.a)("StorytellerTenantAdminCheck"))try{if(yield this.Igk())return Promise.resolve(5)}catch(a){return ya.a.J(508409414,
817,10,`ApplicationFeatureHelper isFeatureEnabled failed: ${a}`),Promise.resolve(6)}return Promise.resolve(0)})}$tg(){return Object(Jh.b)(this,void 0,void 0,function*(){return(yield n(this.mJk)).isFeatureEnabled("Copilot",!1)})}Igk(){return Object(Jh.b)(this,void 0,void 0,function*(){return(yield n(this.nJk)).UO("CopilotContentGeneration",!0)})}hGd(){return Object(Jh.b)(this,void 0,void 0,function*(){return new Promise(a=>{this.Lb.Ue(()=>{a(!0)})})})}}Object(m.a)(pn,"CopilotEnableStateChecker",null,
[191]);class jj{get name(){return"PowerPointWebEditor.D624F2E9-87AC-467A-8001-7230F6A79100"}fc(a){this.K=a;a.register(tl,"PowerPointWebEditor.CopilotDocumentStateTracker").as("PowerPointWebEditor.ICopilotDocumentStateTracker").ma().na(()=>new tl(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("PowerPointWebEditor.IPresentationReader"),a.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
a.Ha("Common.App.HostNotification.EditNotificationEventSource"),a.Ha("Common.App.Policy.Contracts.IPolicyManager"),()=>A.AFrameworkApplication.cD||A.AFrameworkApplication.Tw,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")));a.register(pn,"PowerPointWebEditor.CopilotEnableStateChecker").as("PowerPointWebEditor.ICopilotEnableStateChecker").ma().na(()=>new pn(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IAppSettingsManager"),a.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
a.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper")))}init(){this.K.resolve("PowerPointWebEditor.CopilotDocumentStateTracker");this.K.resolve("PowerPointWebEditor.CopilotEnableStateChecker")}dispose(){}static main(){A.AFrameworkApplication.fa.isChangeGateEnabled("DocumentStateTrackerEnabled")&&C.a.instance.Ac(new jj)}}Object(m.a)(jj,"PPTWebEditorCopilotCorePackage",null,[2,3]);var kh=d(103),ah=d(160);class Vj{static crd(a,b){try{return JSON.parse(a)}catch(c){ya.a.J(508618849,817,
10,`${b}: parseResult error: ${c}`)}return null}static MW(a,b,c,f,l){a=this.I7i(a,b,c,f,l);a=JSON.stringify(a);ya.a.J(508614039,822,15,`${a}`)}static I7i(a,b,c,f,l){var u,I,T,ja,ua,Ra,eb;const Bb=[];if(a.SlideChangeInfos)for(var Ub of a.SlideChangeInfos)Bb.push({designerRan:Ub.designerRan});Ub=[];if(a.ImageChangeInfos)for(const Xb of a.ImageChangeInfos)Ub.push({designerAdded:Xb.designerAdded});return{["trackerName"]:l,["isKept"]:c,["isSeen"]:f,["correlationId"]:null!==(u=a.CorrelationId)&&void 0!==
u?u:"",["errorCode"]:null!==(I=a.ErrorCode)&&void 0!==I?I:"",["errorReason"]:null!==(T=a.JOfcCommandErrorReason)&&void 0!==T?T:"",["entryPoint"]:null!==(ja=b.entryPoint)&&void 0!==ja?ja:"",["scenarioName"]:null!==(ua=b.scenarioName)&&void 0!==ua?ua:"",["scenarioStartTime"]:null!==(Ra=b.startTime)&&void 0!==Ra?Ra:"",["scenarioCorrelationId"]:null!==(eb=b.correlationId)&&void 0!==eb?eb:"",["designerRanForSlides"]:Bb,["designerAddedForImages"]:Ub}}static y3c(a,b){b=b.SlideChangeInfos;if(null===b||void 0===
b||!b.length)return!1;for(const c of b){b=c.sid;const f=c.cid;for(const l of a)if(l&&l.sid==b&&l.cid==f)return!0}return!1}static H0j(a,b){b=b.SectionChangeInfos;if(null===b||void 0===b||!b.length)return!1;for(const c of b)if((b=c.sectionId)&&a==b)return!0;return!1}}Object(m.a)(Vj,"CopilotTelemetryUtil",null,[]);class dm{constructor(a,b){this.una=this.HV=this.f2=!1;this.Jph=(c,f)=>{var l;this.rA?(null===(l=null===f||void 0===f?void 0:f.shapeNode)||void 0===l?0:l.jT)?this.Cpk(f.shapeNode.jT)&&this.Dba(!1):
ya.a.J(508625094,817,15,"CopilotInsertImageTracker: onShapesRemoved does not have shapeUniqueId in eventargs"):ya.a.J(508616925,817,10,"CopilotInsertImageTracker: onShapesRemoved has null resultPayload")};if(!a)throw Error.argumentNull("scenarioOptionsPayload");if(!b)throw Error.argumentNull("graphOperationEventHandlers");this.Zib=a;this.jh=b}vzc(a){(this.rA=Vj.crd(a,"CopilotInsertImageTracker"))?this.Ujb()?(this.Pob(),setTimeout(()=>{this.una||this.Dba(!0)},18E4)):this.MW():ya.a.J(508625095,817,
10,"CopilotInsertImageTracker: startTracker null resultPayload")}Pob(){this.jh.xAi(this.Jph)}Rob(){this.jh.sCl(this.Jph)}Dba(a){this.f2=a;this.f2||(this.una=!0);this.HV&&this.Rob();this.MW()}Ujb(){var a,b;const c=null!==(b=null===(a=this.rA)||void 0===a?void 0:a.JOfcCommandStatusCode)&&void 0!==b?b:"";return 1==c||4==c?this.HV=!0:this.HV=!1}MW(){Vj.MW(this.rA,this.Zib,this.f2,this.HV,"CopilotInsertImageTracker")}Cpk(a){var b,c,f,l,u=this.rA.SlideChangeInfos,I=this.rA.ImageChangeInfos;if(!((null===
u||void 0===u?0:u.length)&&(null===I||void 0===I?0:I.length)))return!1;const T=u[0].sid;u=u[0].cid;I=I[0].id;return(null===(b=a.slideId)||void 0===b?0:b.sid)&&(null===(c=a.slideId)||void 0===c?void 0:c.sid)==T&&(null===(f=a.slideId)||void 0===f?0:f.cid)&&(null===(l=a.slideId)||void 0===l?void 0:l.cid)==u&&a.shapeId&&a.shapeId==I?!0:!1}}Object(m.a)(dm,"CopilotInsertImageTracker",null,[1211]);class hg{constructor(a,b){this.una=this.HV=this.f2=!1;this.MZ=(c,f)=>{var l;this.rA?0<(null===(l=null===f||
void 0===f?void 0:f.W3a)||void 0===l?void 0:l.length)?Vj.y3c(f.W3a,this.rA)&&this.Dba(!1):ya.a.J(508614037,817,15,"CopilotCreatePresentationTracker: onSlidesRemoved does not have slideList in eventargs"):ya.a.J(508614038,822,15,"CopilotCreatePresentationTracker: onSlidesRemoved has null resultPayload")};if(!a)throw Error.argumentNull("scenarioOptionsPayload");if(!b)throw Error.argumentNull("graphOperationEventHandlers");this.Zib=a;this.jh=b}vzc(a){(this.rA=Vj.crd(a,"CopilotCreatePresentationTracker"))?
this.Ujb()?(this.Pob(),setTimeout(()=>{this.una||this.Dba(!0)},3E5)):this.MW():ya.a.J(508625092,817,10,"CopilotCreatePresentationTracker: startTracker null resultPayload")}Pob(){this.jh.wvb(this.MZ)}Rob(){this.jh.Mvc(this.MZ)}Dba(a){this.f2=a;this.f2||(this.una=!0);this.HV&&this.Rob();this.MW()}Ujb(){var a,b;const c=null!==(b=null===(a=this.rA)||void 0===a?void 0:a.JOfcCommandStatusCode)&&void 0!==b?b:"";return 1==c||4==c?this.HV=!0:!1}MW(){Vj.MW(this.rA,this.Zib,this.f2,this.HV,"CopilotCreatePresentationTracker")}}
Object(m.a)(hg,"CopilotCreatePresentationTracker",null,[1211]);class vj{constructor(a,b){this.una=this.HV=this.f2=!1;this.MZ=(c,f)=>{var l;this.rA?0<(null===(l=null===f||void 0===f?void 0:f.W3a)||void 0===l?void 0:l.length)?Vj.y3c(f.W3a,this.rA)&&this.Dba(!1):ya.a.J(508618851,817,15,"CopilotAddSlideTracker: onSlidesRemoved does not have slideList in eventargs"):ya.a.J(508616926,822,15,"CopilotAddSlideTracker: onSlidesRemoved has null resultPayload")};if(!a)throw Error.argumentNull("scenarioOptionsPayload");
if(!b)throw Error.argumentNull("graphOperationEventHandlers");this.Zib=a;this.jh=b}vzc(a){(this.rA=Vj.crd(a,"CopilotAddSlideTracker"))?this.Ujb()?(this.Pob(),setTimeout(()=>{this.una||this.Dba(!0)},18E4)):this.MW():ya.a.J(508618881,817,10,"CopilotAddSlideTracker: startTracker null resultPayload")}Pob(){this.jh.wvb(this.MZ)}Rob(){this.jh.Mvc(this.MZ)}Dba(a){this.f2=a;this.f2||(this.una=!0);this.HV&&this.Rob();this.MW()}Ujb(){var a,b;const c=null!==(b=null===(a=this.rA)||void 0===a?void 0:a.JOfcCommandStatusCode)&&
void 0!==b?b:"";return 1==c||4==c?this.HV=!0:this.HV=!1}MW(){Vj.MW(this.rA,this.Zib,this.f2,this.HV,"CopilotAddSlideTracker")}}Object(m.a)(vj,"CopilotAddSlideTracker",null,[1211]);class en{constructor(a,b){this.una=this.HV=this.f2=!1;this.wrc=(c,f)=>{var l,u;this.rA?0<(null===(u=null===(l=null===f||void 0===f?void 0:f.section)||void 0===l?void 0:l.sectionId)||void 0===u?void 0:u.length)?Vj.H0j(f.section.sectionId,this.rA)&&this.Dba(!1):ya.a.J(508356301,817,15,"CopilotOrganizeTracker: onSectionRemoved does not have slideList in eventargs"):
ya.a.J(508356302,822,15,"CopilotOrganizeTracker: onSlidesRemoved has null resultPayload")};this.Sph=(c,f)=>{var l;this.rA?0<(null===(l=null===f||void 0===f?void 0:f.W3a)||void 0===l?void 0:l.length)?Vj.y3c(f.W3a,this.rA)&&this.Dba(!1):ya.a.J(508356299,817,15,"CopilotOrganizeTracker: onSectionRemoved does not have slideList in eventargs"):ya.a.J(508356300,822,15,"CopilotOrganizeTracker: onSlidesRemoved has null resultPayload")};this.MZ=(c,f)=>{var l;this.rA?0<(null===(l=null===f||void 0===f?void 0:
f.W3a)||void 0===l?void 0:l.length)?Vj.y3c(f.W3a,this.rA)&&this.Dba(!1):ya.a.J(508356297,817,15,"CopilotOrganizeTracker: onSlidesRemoved does not have slideList in eventargs"):ya.a.J(508356298,822,15,"CopilotOrganizeTracker: onSlidesRemoved has null resultPayload")};if(!a)throw Error.argumentNull("scenarioOptionsPayload");if(!b)throw Error.argumentNull("graphOperationEventHandlers");this.Zib=a;this.jh=b}vzc(a){(this.rA=Vj.crd(a,"CopilotOrganizeTracker"))?this.Ujb()?(this.Pob(),setTimeout(()=>{this.una||
this.Dba(!0)},18E4)):this.MW():ya.a.J(508356303,817,10,"CopilotOrganizeTracker: startTracker null resultPayload")}Pob(){this.jh.SLf(this.wrc);this.jh.Jzi(this.Sph);this.jh.wvb(this.MZ)}Rob(){this.jh.cEh(this.wrc);this.jh.SBl(this.Sph);this.jh.Mvc(this.MZ)}Dba(a){this.f2=a;this.f2||(this.una=!0);this.HV&&this.Rob();this.MW()}Ujb(){var a,b;const c=null!==(b=null===(a=this.rA)||void 0===a?void 0:a.JOfcCommandStatusCode)&&void 0!==b?b:"";return 1==c||4==c?this.HV=!0:!1}MW(){Vj.MW(this.rA,this.Zib,this.f2,
this.HV,"CopilotOrganizeTracker")}}Object(m.a)(en,"CopilotOrganizeTracker",null,[1211]);var M=d(29);class ck{constructor(a,b,c,f,l,u,I,T){this.ka=a;this.Xa=c;this.Ms=f;this.ia=b;this.oa=l;this.Gld=u;this.Wb=I;this.jh=T}D$f(a,b){return Object(Jh.b)(this,void 0,void 0,function*(){try{let c;try{c=JSON.parse(a)}catch(u){return ya.a.J(508850828,817,10,"CopilotProxy::executeJOfcCommand failure to parse jsonPayload error: {0}, commandName: {1}",u,b),!1}const f=JSON.stringify([{data:c,name:b,version:"1.0.0"}]),
l=JSON.parse(yield new Promise(u=>{const I={};I.promiseToResolve=u;I.requestBody=f;this.ia.Ia(M.a.NFa,2,I)}));this.ia.Ia(M.a.NFa,2,{promiseToResolve:void 0,requestBody:""});return l.FSuccess}catch(c){return ya.a.J(508850827,817,10,"CopilotProxy::executeJOfcCommand error: {0}, commandName: {1}",c,b),!1}})}zEi(a,b,c,f,l){var u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc;return Object(Jh.b)(this,void 0,void 0,function*(){try{let Ec="",hd;c&&(hd=JSON.parse(c));(null===hd||void 0===hd?0:hd.correlationId)&&md.a("PptUseScenarioOptionsCorrelationId")?
Ec=hd.correlationId:(Ec=kh.a.create().toString(),ya.a.J(508686415,817,50,`CopilotProxy::applyJOfcCommands generate new correlationId:${Ec}`));var lc=null!==(u=null===hd||void 0===hd?void 0:hd.scenarioName)&&void 0!==u?u:"";const yd=null!==(I=null===hd||void 0===hd?void 0:hd.entryPoint)&&void 0!==I?I:"";ya.a.J(508620814,817,15,`CopilotProxy::applyJOfcCommands called: {correlationId:${Ec}, scenarioName:${lc}, entryPoint:${yd}}`);let Pd;const pe=this.ka.getBooleanAppSetting("JOfcEnableMetricsTracker");
hd&&pe&&(Pd=r(hd,this.jh));md.a("PptApplyJOfcCommandsUseOptions")&&(a=Sys.Serialization.JavaScriptSerializer.serialize({jOfcCommandsPayload:a,designerOptions:b,correlationId:Ec,appId:l}));const Se=yield new Promise(vf=>{const ug={};ug.promiseToResolve=vf;ug.requestBody=a;A.AFrameworkApplication.Pa.Ia(M.a.NFa,2,ug)});pe&&Pd&&Pd.vzc(Se);lc="";if(md.a("PPTLogJOfcResultInfo"))try{const vf=JSON.parse(Se),ug=null!==(T=vf.JOfcCommandStatusCode)&&void 0!==T?T:"",Tg=null!==(ja=vf.ErrorTag)&&void 0!==ja?ja:
"",$f=null!==(ua=vf.ErrorCode)&&void 0!==ua?ua:"",Ve=null!==(Ra=vf.ExtraErrorTag)&&void 0!==Ra?Ra:"",xg=null!==(eb=vf.ExtraErrorCode)&&void 0!==eb?eb:"",yg=null!==(Bb=vf.JOfcCommandErrorReason)&&void 0!==Bb?Bb:"",ng=null!==(Ub=vf.CorrelationId)&&void 0!==Ub?Ub:Ec,Wh=null!==(Xb=null===hd||void 0===hd?void 0:hd.scenarioName)&&void 0!==Xb?Xb:"";lc=`{"FSuccess":${null!==(tc=vf.FSuccess)&&void 0!==tc?tc:""},"JOfcCommandStatusCode":${ug},"JOfcCommandErrorReason":${yg}}`;ya.a.J(508634642,817,15,`ApplyJOFCCommandResult: {scenarioName:${Wh}, errorTag:${Tg}, errorHResult:${$f}, extraErrorTag:${Ve}, extraErrorHResult:${xg}, jOfcCommandStatusCode:${ug}, jOfcCommandErrorReason:${yg}, correlationId:${ng}, entryPoint:${yd}}`)}catch(vf){ya.a.J(508634563,
817,10,"CopilotProxy::executeJOfcCommand error: {0}",vf)}A.AFrameworkApplication.Pa.Ia(M.a.NFa,2,{promiseToResolve:null,requestBody:""});Object(md.a)("PptApplyJOfcCommandsUpdateSelections")&&this.D3h(f);return md.a("PPTLogReturnOnlyResultCodesToCaller")&&""!=lc?lc:Se}catch(Ec){return ya.a.J(508850826,817,10,"CopilotProxy::executeJOfcCommand error: {0}",Ec),'{"FSuccess":false,"JOfcCommandStatusCode":4}'}})}applyJOfcCommands(a,b,c,f,l){return Object(Jh.b)(this,void 0,void 0,function*(){if(!md.a("PPTOApplyJOfcCommandsUseRefactoredCode"))return this.zEi(a,
b,c,f,l);let u=!1,I,T="";try{c&&(I=JSON.parse(c));T=this.fhj(I);this.HDk(I,T);u=!0;if(md.a("PptApplyJOfcCommandsUseScenarioOptionsTelemetry")){const eb=this.URi(I);if(eb.HPh)return this.QAe(I,T,eb.ZWe),this.Hke(eb.ZWe)}var ja=this.WKj(I);const ua=yield this.PMl(a,b,T,l),Ra=this.ZHj(ua);ja&&ja.vzc(ua);md.a("PPTLogJOfcResultInfo")&&Ra&&this.QAe(I,T,Ra);Object(md.a)("PptApplyJOfcCommandsUpdateSelections")&&this.D3h(f);return md.a("PPTLogReturnOnlyResultCodesToCaller")&&Ra?this.Hke(Ra):ua}catch(ua){return ya.a.J(508392260,
817,10,"CopilotProxy::applyJOfcCommands error: {0}",ua),ja={JOfcCommandStatusCode:3},ja.CorrelationId=T,ja.FSuccess=!1,u&&this.QAe(I,T,ja),this.Hke(ja)}})}fhj(a){if((null===a||void 0===a?0:a.correlationId)&&md.a("PptUseScenarioOptionsCorrelationId"))return a.correlationId;a=kh.a.create().toString();ya.a.J(508392262,817,50,`CopilotProxy::applyJOfcCommands generate new correlationId:${a}`);return a}WKj(a){const b=this.ka.getBooleanAppSetting("JOfcEnableMetricsTracker");if(a&&b)return r(a,this.jh)}PMl(a,
b,c,f){return Object(Jh.b)(this,void 0,void 0,function*(){md.a("PptApplyJOfcCommandsUseOptions")&&(a=JSON.stringify({jOfcCommandsPayload:a,designerOptions:b,correlationId:c,appId:f}));const l=yield new Promise(u=>{const I={};I.promiseToResolve=u;I.requestBody=a;this.ia.Ia(M.a.NFa,2,I)});this.ia.Ia(M.a.NFa,2,{promiseToResolve:null,requestBody:""});return l})}ZHj(a){try{return JSON.parse(a)}catch(b){ya.a.J(508392261,817,10,"CopilotProxy::getParsedResult error: {0}",b)}}Hke(a){var b,c,f;const l={};l.FSuccess=
null!==(b=a.FSuccess)&&void 0!==b?b:!1;l.JOfcCommandStatusCode=null!==(c=a.JOfcCommandStatusCode)&&void 0!==c?c:3;l.JOfcCommandErrorReason=null!==(f=a.JOfcCommandErrorReason)&&void 0!==f?f:0;return JSON.stringify(l)}HDk(a,b){var c,f;const l={};l.correlationId=b;l.scenarioName=null!==(c=null===a||void 0===a?void 0:a.scenarioName)&&void 0!==c?c:"";l.entryPoint=null!==(f=null===a||void 0===a?void 0:a.entryPoint)&&void 0!==f?f:"";a=JSON.stringify(l);ya.a.J(508620814,817,15,`CopilotProxy::applyJOfcCommands called: ${a}`)}QAe(a,
b,c){var f,l,u,I,T,ja,ua,Ra,eb,Bb;const Ub={};Ub.scenarioName=null!==(f=null===a||void 0===a?void 0:a.scenarioName)&&void 0!==f?f:"";Ub.errorTag=null!==(l=c.ErrorTag)&&void 0!==l?l:"";Ub.errorHResult=null!==(u=c.ErrorCode)&&void 0!==u?u:"";Ub.extraErrorTag=null!==(I=c.ExtraErrorTag)&&void 0!==I?I:"";Ub.extraErrorHResult=null!==(T=c.ExtraErrorCode)&&void 0!==T?T:"";Ub.jOfcCommandStatusCode=null!==(ja=c.JOfcCommandStatusCode)&&void 0!==ja?ja:"";Ub.jOfcCommandErrorReason=null!==(ua=c.JOfcCommandErrorReason)&&
void 0!==ua?ua:"";Ub.scenarioErrorReason=null!==(Ra=c.ScenarioErrorReason)&&void 0!==Ra?Ra:"";Ub.correlationId=null!==(eb=c.CorrelationId)&&void 0!==eb?eb:b;Ub.entryPoint=null!==(Bb=null===a||void 0===a?void 0:a.entryPoint)&&void 0!==Bb?Bb:"";a=JSON.stringify(Ub);ya.a.J(508634642,817,15,`ApplyJOFCCommandResult: ${a}`)}URi(a){var b,c;if(null===a||void 0===a||!a.copilotScenarioResult)return{HPh:!1,ZWe:void 0};const f={};f.JOfcCommandStatusCode=a.copilotScenarioResult.Success?1:3;f.JOfcCommandErrorReason=
0;f.ScenarioErrorReason=null!==(b=a.copilotScenarioResult.ErrorReason)&&void 0!==b?b:"";f.ErrorTag=null!==(c=a.copilotScenarioResult.Tag)&&void 0!==c?c:"";f.CorrelationId=a.correlationId;f.FSuccess=a.copilotScenarioResult.Success;return{HPh:!0,ZWe:f}}D3h(a){var b,c;try{let f;if(a&&(f=JSON.parse(a),0<(null===(c=null===(b=f.data)||void 0===b?void 0:b.slideMonikerList)||void 0===c?void 0:c.length))){const l=this.Wb.gNj(f.data.slideMonikerList[0].cId);l&&(this.oa.qUa(),this.Gld.Aa=l)}}catch(f){ya.a.J(508630553,
817,10,"CopilotProxy::updateSelectedSlide error: {0}",f)}}gfg(a){return Object(Jh.b)(this,void 0,void 0,function*(){try{a.RequestOptions.CorrelationId||(a.RequestOptions.CorrelationId=kh.a.create().toString());ya.a.J(509214920,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:a.RequestOptions.CorrelationId,ClientName:a.RequestOptions.ClientName,MergeAction:a.RequestOptions.MergeAction,InsertPosition:a.RequestOptions.InsertPosition})}`);const b=yield this.sfe(a.OutlineInput,
a.RequestOptions);return yield this.iRe(b,a.RequestOptions)}catch(b){return ya.a.J(509214918,817,10,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Error:b,Correlation:a.RequestOptions.CorrelationId,ClientName:a.RequestOptions.ClientName,MergeAction:a.RequestOptions.MergeAction,InsertPosition:a.RequestOptions.InsertPosition})}`),!1}})}sfe(a,b){return Object(Jh.b)(this,void 0,void 0,function*(){b.CorrelationId||(b.CorrelationId=kh.a.create().toString());ya.a.J(509214917,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:b.CorrelationId,
ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`);let c=`${this.ka.Ea("CreatorServiceBase")}?action=OutlineToPPT`;c=this.teg(c);const f={};f.PodSID=this.Xa.podSessionId;f.Client=b.ClientName;Object(md.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===b.MergeAction?"Create":"Insert");f["X-CorrelationId"]=b.CorrelationId;f["X-UserSessionId"]=A.AFrameworkApplication.userSessionId;try{const l=yield this.send({Dwa:"generatePPTFromOutline",url:c,payload:JSON.stringify(a),
headers:f});return JSON.parse(l)}catch(l){ya.a.J(509214916,817,10,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Exception:l,Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`)}})}iRe(a,b){return Object(Jh.b)(this,void 0,void 0,function*(){b.CorrelationId||(b.CorrelationId=kh.a.create().toString());if(!a||!a.DownloadablePPTInfos||0==a.DownloadablePPTInfos.length)return ya.a.J(509214919,817,10,`CopilotProxy::generatePPTFromOutline: generatePPTFromOutline returned invalid response ${JSON.stringify({Correlation:b.CorrelationId,
ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`),!1;ya.a.J(509118050,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`);const c=a.DownloadablePPTInfos[0].DownloadUrl;if(!c)return ya.a.J(509163081,817,10,`CopilotProxy::generatePPTFromOutline: generatePPTFromOutline failed; ${JSON.stringify({ErrorCode:a.DownloadablePPTInfos[0].ErrorCode,
Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`),!1;const f={};f.PodSID=this.Xa.podSessionId;f.Client=b.ClientName;Object(md.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===b.MergeAction?"Create":"Insert");f["X-UserSessionId"]=A.AFrameworkApplication.userSessionId;f["X-CorrelationId"]=b.CorrelationId;let l=`${this.ka.Ea("MergeSlidesFromUrlEndpoint")}`;l=this.teg(l);return(yield this.send({Dwa:"mergeGeneratedSlides",
url:l,payload:JSON.stringify({DownloadUrl:c,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition}),headers:f})).includes("Error")?!1:!0})}teg(a){if(!this.ka.getBooleanAppSetting("StoryTellerForwardWdQueryParams"))return a;const b=new URLSearchParams(window.location.search.toLowerCase()),c=this.ka.Ea("StoryTellerWdQueryParamsToForward").toLowerCase().split(",");for(const f of b.entries()){const [l,u]=f;-1<c.indexOf(l)&&(a+="&"+l+"="+encodeURIComponent(u))}return a}send(a){return new Promise((b,
c)=>{const f=new Date;this.Ms.Tj(a.url,2,a.payload,a.headers,!1,0,l=>{var u;ya.a.J(509214915,817,15,`CopilotProxy::${a.Dwa}: Time Taken ${+new Date-+f}`);l.data.Ke!==ah.a.Zw&&(ya.a.J(509214914,817,10,`CopilotProxy::${a.Dwa}: Bad Http Status ${l.data.Ke}`),c(`Error - Bad Http Status ${l.data.Ke}`));ya.a.J(509214913,817,15,`CopilotProxy::${a.Dwa}: call successful`);b(null!==(u=l.data.Ud)&&void 0!==u?u:"")},l=>{var u,I;const T=new Date;ya.a.J(509214912,817,10,`CopilotProxy::${a.Dwa}: request failed Status: ${null===
(u=null===l||void 0===l?void 0:l.data)||void 0===u?void 0:u.Ke}, Time Taken ${+T-+f}`);c(`Error - ${a.Dwa} failed with ${null===(I=null===l||void 0===l?void 0:l.data)||void 0===I?void 0:I.Ke}`)},null)})}}Object(m.a)(ck,"CopilotProxy",null,[1136]);class wf{constructor(){this.appId=this.correlationId=this.designerOptions=this.jOfcCommandsPayload=null}}Object(m.a)(wf,"ApplyJOfcCommandsWithOptionsDataContract",null,[]);class fn{constructor(a,b,c,f){this.nHk=5;this.EDe=0;this.bmc="ReplaceAll";this.dOg=
"colorSchemeTextArea";this.aeh="themeIdsTextArea";this.z9g="presOutlineTextArea";this.ODe="CopilotStatusBarDebugUI";this.G_g="CopilotLogPanelId";this.pSf=l=>{l.innerText="";const u=this.Wb.hGa();for(let I=0;I<u.length;++I){const T=u[I],ja=document.createElement("option");ja.value=T.sid+";"+T.cid;ja.textContent=""+(I+1);l.appendChild(ja)}(l=l.options[l.selectedIndex].value.split(";"))&&2===l.length&&(this.aVg={ReferenceSlide:{Sid:parseInt(l[0]),Cid:parseInt(l[1])},InsertBefore:!1})};this.l8k=()=>{const l=
document.getElementById("InsertPositionSelect");l&&this.pSf(l)};this.jS=a;this.RDe={ColorScheme:b.Ea("CopilotTestDefaultColorScheme"),ThemeIds:b.Ea("CopilotTestDefaultThemeIds"),PresOutline:b.Ea("CopilotTestDefaultPresOutline")};this.Wb=c;this.H_a=f;this.H_a.VE(this.l8k);document.getElementById("StatusBar").addEventListener("contextmenu",()=>{this.EDe++;this.EDe>=this.nHk&&(this.L_l(),this.EDe=0)})}L_l(){if(!document.getElementById(this.ODe)){var a=document.createElement("div");a.id=this.ODe;a.setAttribute("style",
"position: absolute; right: 0; bottom: 24px; display: block; z-Index: 10001; border:1px solid gray; padding: 10px; background-color:#f1f1f1");a.appendChild(this.B2d("Color Scheme",this.dOg,this.RDe.ColorScheme,"100px"));a.appendChild(this.B2d("Theme Ids",this.aeh,this.RDe.ThemeIds,"30px"));a.appendChild(this.B2d("Presentation Outline",this.z9g,this.RDe.PresOutline,void 0));a.appendChild(this.QKi());a.appendChild(this.xLi());a.appendChild(this.OKi());document.body.appendChild(a);"ReplaceAll"==this.bmc?
this.Oyd(!1):this.Oyd(!0)}}B2d(a,b,c,f){const l=document.createElement("div");l.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");const u=document.createElement("div");u.setAttribute("style","margin: 2px; color: black; display: inline");const I=document.createElement("textarea");I.id=b;I.value=c;I.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");void 0!==f&&(I.style.height=f);
b=document.createElement("div");b.setAttribute("style","display: inline; float: right; margin-bottom: 2px");f=document.createElement("button");f.innerText="Default";f.onclick=()=>{I.value=c};b.appendChild(f);f=document.createElement("button");f.style.marginLeft="10px";f.innerText="Clear";f.onclick=()=>{I.value=""};b.appendChild(f);f=document.createElement("label");f.textContent=a;f.setAttribute("style","color: black; margin: 2px");u.appendChild(f);u.appendChild(b);l.appendChild(u);l.appendChild(I);
return l}QKi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.PKi());a.appendChild(this.JKi());return a}PKi(){const a=document.createElement("div");a.setAttribute("style","display:inline; margin: 2px 20px;");const b=document.createElement("label");b.textContent="MergeAction: ";b.style.color="black";const c=document.createElement("select"),f=document.createElement("option");f.value="ReplaceAll";
f.textContent="ReplaceAll";const l=document.createElement("option");l.value="Insert";l.textContent="Insert";"ReplaceAll"==this.bmc?f.selected=!0:l.selected=!0;c.appendChild(f);c.appendChild(l);a.appendChild(b);a.appendChild(c);c.addEventListener("change",()=>{"Insert"===c.options[c.selectedIndex].value?(this.bmc="Insert",this.Oyd(!0)):(this.bmc="ReplaceAll",this.Oyd(!1))});return a}JKi(){const a=document.createElement("div");a.id="InsertPositionDiv";a.setAttribute("style","display:inline; margin: 2px 20px; visibility: hidden");
const b=document.createElement("label");b.textContent="After slide: ";b.style.color="black";const c=document.createElement("select");c.id="InsertPositionSelect";this.pSf(c);c.addEventListener("change",()=>{const f=c.options[c.selectedIndex].value.split(";");f&&2===f.length&&(this.aVg={ReferenceSlide:{Sid:parseInt(f[0]),Cid:parseInt(f[1])},InsertBefore:!1})});a.appendChild(b);a.appendChild(c);return a}Oyd(a){document.getElementById("InsertPositionDiv").style.visibility=a?"visible":"hidden"}xLi(){const a=
document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.yLi());a.appendChild(this.bKi());return a}yLi(){const a=document.createElement("button");a.style.marginRight="10px";a.innerText="GenerateAndMergeSlides";a.onclick=()=>Object(Jh.b)(this,void 0,void 0,function*(){try{const b={OutlineInput:{ColorScheme:JSON.parse(document.getElementById(this.dOg).value),ThemeIds:JSON.parse(`[${document.getElementById(this.aeh).value}]`),
FRenderFirstThumb:!0,PresOutline:JSON.parse(document.getElementById(this.z9g).value)},RequestOptions:{ClientName:"ChatPPT",MergeAction:this.bmc,InsertPosition:this.aVg,CorrelationId:void 0}},c=yield this.jS.gfg(b);this.log(`generateAndMergeSlides succeeded: ${c}`)}catch(b){this.log(`generateAndMergeSlides error: ${b}`)}});return a}bKi(){const a=document.createElement("button");a.innerText="Close";a.onclick=()=>{document.body.removeChild(document.getElementById(this.ODe))};return a}OKi(){const a=document.createElement("div");
a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px; user-select: text;");var b=document.createElement("label");b.style.color="black";b.style.userSelect="text";b.textContent=`UserSessionId: ${A.AFrameworkApplication.userSessionId}`;a.appendChild(b);b=document.createElement("textarea");b.id=this.G_g;b.value="";b.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");b.disabled=!0;b.style.height=
"50px";a.appendChild(b);return a}log(a){document.getElementById(this.G_g).value+=a+"\r\n"}}Object(m.a)(fn,"StatusBarDebugUI",null,[]);class rm{constructor(a,b,c,f){this.Eic=this.tnc=!1;this.Rzj=()=>this.ka.isCreateNew?this.afd?"IrmProtected":this.RSg.instance&&this.RSg.instance.B4h?"UserEditHappened":this.tnc?"RealtimeEditHappened":this.Eic?"CoauthMergeHappened":"None":"NotNewFile";this.trc=()=>{this.tnc=!0;this.Ng.pEh(this.trc)};this.jrc=()=>{this.Eic=!0;this.Ng.IDh(this.jrc)};this.ka=a;this.Ng=
b;this.RSg=c;this.afd=f;this.Ng.wOc(this.trc);this.Ng.jOc(this.jrc)}}Object(m.a)(rm,"CreatePresentationEnabledState",null,[189]);class pj{get name(){return"PowerPointWebEditor.CopilotProxy"}fc(a){this.K=a;a.register(ck,"PowerPointWebEditor.CopilotProxy").as("PowerPointWebEditor.ICopilotProxy").ma().na(()=>new ck(a.resolve("PowerPointWebEditor.IApplicationSettings"),A.AFrameworkApplication.Pa,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),A.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")));Object(md.a)("CreatePresentationEnabledState")&&a.register(rm,"PowerPointWebEditor.CreatePresentationEnabledState").as("PowerPointWebEditor.ICreatePresentationEnabledState").ma().na(()=>new rm(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ha("Common.Interface.IEditNotificationManager"),
A.AFrameworkApplication.cD||A.AFrameworkApplication.Tw))}init(){this.K.resolve("PowerPointWebEditor.ICopilotProxy");Object(md.a)("CreatePresentationEnabledState")&&this.K.resolve("PowerPointWebEditor.ICreatePresentationEnabledState");this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("CopilotDebugUIEnabled")&&new fn(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7))}dispose(){}static main(){C.a.instance.Ac(new pj)}}
Object(m.a)(pj,"PPTWebEditorCopilotProxyPackage",null,[2,3]);var ul=d(168),eg=d(97),ni=d(653),wc=d(51),kj;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(kj||(kj={}));Object(m.b)("RefreshDocTrigger",kj);var $c=d(41),jg=d(85);class mk extends Sys.EventArgs{constructor(a,b){super();
this.Kpk=b}}Object(m.a)(mk,"FailoverEventArgs",Sys.EventArgs,[]);var Kh=d(247),Yg=d(114);class em extends Yg.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}om(){return 61}}Object(m.a)(em,"CheckUnblockUIRequest",Yg.a,[]);var sh=d(899);class Vk{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.soa=!1;this.vya=this.iNe=this.SIa=this.XIa=this.yV=this.It=null;this.ka=a;this.zb=b;this.DQk=c;this.uf=f;this.oa=l;this.Fa=u;this.hB=I;this.Qbd=Xb;this.Bhb=
lc;this.Kn=T;this.rGk=ja;this.sa=ua;this.Yb=Ra;this.aba=eb;this.Ge=Bb;this.fe=Ub;this.VIa=tc;this.ia=Ec;this.$D=hd;this.fo=yd;this.D0a=Pd;this.Mj=pe;this.HIk=this.ka.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.wMk=this.ka.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}qb(){this.ia.pa(M.a.dPb,wc.a.application,Object(R.a)(this,this.Pul,"refeshDoc"),64)}Pul(a,b,c,f,l){this.mgf(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in l&&l.isPodSessionRefreshed?
3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get qj(){return this.Yb.qj}Gua(a){a.Ecc()&&a.Gua()}mgf(a,b,c,f){if(!this.Ge.td.hermesFailOverImprovementIsEnabled||this.Bhb())return!1;if(this.soa||this.VIa.fBg)return!0;const l=this.qj;if(!(l&&l.ij&&l.ij.my&&l.ij.my.id!==Ua.a.nil&&l.Fq&&this.sa.presentation&&this.sa.presentation.id.equals(ni.a.HWe)))return!1;5===f&&this.aJf();this.Kn.pause();this.aba.suspend();this.hB.$d&&this.hB.$d.endEditing(!1,14);this.hB.forEach(Object(R.a)(this,
this.Gua,"ensureGraphUpdated"));l.XU(!0)&&l.qia();this.oa.setSelection(null);this.Fa.Gd();this.It=$c.a.Zj("RefreshDoc");this.It.Wa("IsPlanedShutdown",b.toString());this.It.Wa("PodSessionId",c);this.It.Wa("RefreshDocTrigger",kj[f]);ya.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.It.actionId,this.It.wTb());this.yV=a;b?(this.XIa=new Date,this.VIa.oRh(),this.Qbd.Jb(this.z7d())):this.tBh();this.$D.ezh(new mk(b,!1));this.sa.presentation.M4e();this.uf.blockContent(this.sa.presentation,
"RefreshDoc",!0);ya.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.fe.disabled=!0;return this.soa=this.Ge.Ecb().Hod=!0}aJf(){this.Kn.isPaused&&(ya.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Kn.Zpb());try{this.Kn.ZUf()}catch(a){ya.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",a)}}z7d(){return this.SIa=new Kh.a(new em(this.yV),
Object(R.a)(this,this.STe,"onCheckUnBlockUISuccess"),Object(R.a)(this,this.RTe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}tBh(){this.It.Wa("FailedMachineId",this.yV);this.iNe=new Date;this.DQk.dPb(this.yV,this.It,!this.Ge.td.refreshDocSynchronouslyIsEnabled,!1,Object(R.a)(this,this.Hdj,"docRefreshSuccessCallback"),Object(R.a)(this,this.Gdj,"docRefreshFailedCallback"));this.rGk.cza()}STe(){this.VIa.U3c();this.It.Wa("DeploymengUIBlockingTime",(+new Date-+this.XIa).toString());
this.It.Wa("CheckUnblockUISucceeded","True");this.tBh()}RTe(a){if(142===a.ServerError.Code)return ya.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.yV,+new Date-+this.XIa),this.Qbd.Jb(this.SIa),!0;this.It.Wa("DeploymengUIBlockingTime",(+new Date-+this.XIa).toString());this.It.Wa("CheckUnblockUISucceeded","False");this.VIa.U3c();return this.Toh(a)}Hdj(){this.fo.OZd(Object(R.a)(this,this.IVe,"onSlideDrawComplete"));this.vya&&
this.zb.Vg(this.vya);const a=this.It.rL("RefreshDocTrigger");this.vya=new ne.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.HIk:this.wMk,Object(R.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.zb.Jb(this.vya);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.aJf()}Gdj(a){return this.Toh(a)}IVe(){da.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.vya&&(this.zb.Vg(this.vya),this.vya=null);this.fo.nvd(Object(R.a)(this,this.IVe,"onSlideDrawComplete"));
this.It&&(this.It.Wa("ReStoreStatusAfterRefreshStartTime",$c.a.Ef(new Date)),this.aba.resume(),this.It.Wa("SlideDrawResult","True"),this.It.Xm("SlideDrawCompleteET",new Date),this.Kn.isPaused&&this.Kn.Zpb(),this.It.Wa("LoadAndRenderTime",(+new Date-+this.iNe).toString()),this.Ge.td.Y1e||this.Ge.Ecb().eza(),this.It.Wa("ReStoreStatusAfterRefreshEndTime",$c.a.Ef(new Date)),this.vVe(!0),this.D0a.xzh(new sh.a("DocRefresh")),this.Mj.qqb=2,A.AFrameworkApplication.Nmb(jg.a.hi(180),ul.a.unknown,ul.a.FBc),
eg.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.fo.nvd(Object(R.a)(this,this.IVe,"onSlideDrawComplete"));this.vya&&(this.zb.Vg(this.vya),this.vya=null);da.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.It.Wa("SlideDrawResult","False");this.vVe(!1);this.vEl()}vEl(){this.fe.disabled=!1;A.AFrameworkApplication.Lp(jg.a.hi(379));eg.Health.instance.recordQosError("RefreshDocTimeout",["UnexpectedAppRefresh"],
!1,!1,!0,!0,null);A.AFrameworkApplication.Zx&&A.AFrameworkApplication.Zx.ffa();this.ia.Ia(M.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}Toh(a){da.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.ii);this.vVe(!1);return!1}vVe(a){this.soa=!1;this.SIa=this.yV=null;
this.iNe=new Date(0);$c.a.Wgc=new Date;this.It&&(this.It.Wa("Result",a?"Success":"Failed"),this.It.finish(!0),this.It=null);this.fe.disabled=!1;this.Ge.Ecb().Hod=!1;this.uf.vL(this.sa.presentation)}}Object(m.a)(Vk,"DocRefreshHandler",null,[114]);var vl=d(157);class gl{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.soa=!1;this.SIa=this.XIa=this.yV=this.It=null;this.ia=a;this.Qi=b;this.Ng=c;this.uf=f;this.oa=l;this.Fa=u;this.Kn=I;this.sa=T;this.aba=ja;this.VIa=ua;this.Xa=Ra;this.ka=eb;this.Bhb=Bb;
this.ka.PBg&&this.Ng.aC(Object(R.a)(this,this.KF,"onSessionEnd"))}qb(){this.ia.pa(M.a.failover,wc.a.application,Object(R.a)(this,this.YVj,"handleFailover"),64)}KF(){this.Kn.isPaused||this.Kn.pause()}YVj(a,b,c,f,l){if(1===c||this.Bhb()||this.soa||this.VIa.fBg)return 32;this.yV=l;if(!this.yV)return 8;this.It=$c.a.Zj("SeamlessFailover");this.Kn.pause();this.aba.suspend();this.oa.setSelection(null);this.Fa.Gd();this.uf.blockContent(this.sa.presentation,"SeamlessFailover",!0);ya.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");
this.XIa=new Date;this.VIa.oRh();this.Ng.ezh(new mk(!0,!0));A.AFrameworkApplication.Czb();this.Qi.CNc(this.z7d());this.soa=!0;return 32}z7d(){return this.SIa=new Kh.a(new em(this.yV),Object(R.a)(this,this.STe,"onCheckUnBlockUISuccess"),Object(R.a)(this,this.RTe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}STe(){this.VIa.U3c();this.It.Wa("DeploymengUIBlockingTime",(+new Date-+this.XIa).toString());this.It.Wa("CheckUnblockUISucceeded","True");this.It.Wa("FailedMachineId",this.yV);
this.Xa.Xzb=this.yV;this.hsl()}RTe(a){if(142===a.ServerError.Code)return ya.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.yV,+new Date-+this.XIa),this.Qi.CNc(this.SIa),!0;this.It.Wa("DeploymengUIBlockingTime",(+new Date-+this.XIa).toString());this.It.Wa("CheckUnblockUISucceeded","False");this.VIa.U3c();return this.d5k(a)}hsl(){this.It.Wa("ReStoreStatusAfterRefresh",$c.a.Ef(new Date));this.Kn.Zpb();this.aba.resume();this.Hmh(!0);
A.AFrameworkApplication.Nmb(jg.a.hi(180),ul.a.unknown,ul.a.FBc);eg.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}d5k(a){da.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.ii);this.Hmh(!1);a.ServerError=Object.assign(new vl.a,{Code:157,Source:0});
return!1}Hmh(a){this.soa=!1;this.SIa=this.yV=null;this.It&&(this.It.Wa("Result",a?"Success":"Failed"),this.It.finish(),this.It=null);this.uf.vL(this.sa.presentation)}dispose(){this.ka.PBg&&this.Ng.F7(Object(R.a)(this,this.KF,"onSessionEnd"))}}Object(m.a)(gl,"SeamlessFailoverHandler",null,[106]);var lj=d(225),Ij=d(111),qa=d(1213),hb=d(289),Gb=d(852),pc=d(235),vd=d(637);class zd{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.ka=b;this.vaa=c;this.uB=f;this.Lb=l;
this.vhb=!1}uw(a,b,...c){this.Y7b.apply(this,[jg.a.hi(a),this.vaa.D1c(a),this.vaa.Gle(a),this.vaa.Xie(a),void 0===b?!1:b].concat(c))}Y7b(a,b,c,f,l,...u){l=void 0===l?!1:l;if(!lj.a.ly){var I=2,T=!1;if(a===jg.a.hi(83))this.ka.wqk&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,I=3);else if(a===jg.a.hi(8)||a===jg.a.hi(256)||a===jg.a.hi(257)||a===jg.a.hi(291))I=0,T=!0;u&&0<u.length&&(f=String.format.apply(null,[f].concat(u)));this.zu(new vd.a(a,c,f,b,I),l,T)}}zu(a,
b,c){b=void 0===b?!1:b;c=void 0===c?!1:c;let f=a.Cud;var l=jg.a.hV(a.Bn)?pc.a[jg.a.MJ(a.Bn)]:"";ya.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Bn,l,b,A.AFrameworkApplication.XF,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));"errorLocalChangeLostCoauth"==l&&md.a("LocalChangesLostQoSErrorEnabled")&&
eg.Health.instance.recordQosError("LocalChangesLost",["ClientSideDataLoss"],!1,!0,!0,!1,null);if(this.AZl(a))ya.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",a.Bn);else{l=new Ij.StandardDialog;var u=null,I=!1,T=this.Lb.getBooleanAppSetting("UserCanWriteRelative");f&64&&ya.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.Lb.Ea("DocumentPermissions")||"");var ja=!1;f&64&&this.ka.pptFileRecoveryEnabled&&(ja=!0);f&64&&!T&&ya.a.J(512497108,
801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");!ja&&f&64&&(c=!1,f=this.cim(a));T=!!(f&4)&&!(A.AFrameworkApplication.SZh||A.AFrameworkApplication.YR);var ua=!!(f&2)&&A.AFrameworkApplication.Rfa;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.Is=ua||!!(f&1);f&8?(l.Fd=0,u=Object(R.a)(this,this.Hud,"refreshActionHandler"),Array.contains(this.ka.hermesRefreshErrorSuppressionList,
a.Bn.toString())?l.vQ(qa.a.j5(a.title),qa.a.j5(a.message),u):(ya.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Bn),l.Te(1,ResourceStrings.L_Refresh),l.Kz(a.Bn,qa.a.j5(a.title),qa.a.j5(a.message),u,b)),I=this.vhb=!0):ja?(ya.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Bn),this.ia.nb(M.a.repair,2)):ua&&T?(l.Fd=4,l.Te(1,c),l.Te(2,ResourceStrings.L_Close),u=Object(R.a)(this,this.ibl,"openOrCloseActionHandler"),this.vhb=
!0):T?(l.Fd=0,l.Te(1,c),u=Object(R.a)(this,this.yqd,"openInClientActionHandler"),this.vhb=!0):ua?(l.Fd=0,l.Te(1,ResourceStrings.L_Close),u=Object(R.a)(this,this.cVi,"closeActionHandler"),this.vhb=!0):(c=!!(f&1)||0===f,l.Is=c,l.Fd=c?0:5);I||ja||(f&16&&f&32?(b||A.AFrameworkApplication.Lp(a.Bn),l.T3a=!1,l.Ky(qa.a.j5(a.title),qa.a.j5(a.message),a.icon,u)):l.Kz(a.Bn,qa.a.j5(a.title),qa.a.j5(a.message),u,b));this.vhb&&this.uB&&this.uB.closeSession(4);this.vhb&&!b?eg.Health.instance.recordQosError(jg.a.Bea(a.Bn),
["NonDismissibleDialog"],!1,!1,!0,!0,null):b||eg.Health.instance.recordQosError(jg.a.Bea(a.Bn),["DismissibleDialog"],!1,!1,!0,!1,null)}}get P7c(){return this.vhb}cim(a){ya.a.J(512497105,801,15,"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Bn===jg.a.hi(8)||a.Bn===jg.a.hi(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;
a.icon=2;return 6}yqd(a,b){ya.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.sxh()}ibl(a,b){ya.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",a,b);1===a?this.sxh():this.ia.Ia(M.a.kAb,2,hb.c)}cVi(a,b){ya.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ia(M.a.kAb,2,hb.c)}Hud(a,b){ya.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ia(M.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}sxh(){(new Gb.a(G.a.openInClient)).Kte()}AZl(a){return a.Bn===
jg.a.hi(83)&&this.ka.A2l||a.Bn===jg.a.hi(56)&&this.ka.B2l?!0:!1}}Object(m.a)(zd,"ErrorDialog",null,[112]);var xe=d(308),le=d(127),Dg=d(523),ch=d(1043);class $h extends Sys.EventArgs{constructor(){super();this.GEa=this.yD=0;this.message=this.title=null}}Object(m.a)($h,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class wj extends $h{constructor(a){super();this.YUa=null;this.errorCode=a;this.yD=0}}Object(m.a)(wj,"OnBeforeHandleClientErrorEventArgs",$h,[]);class kf extends $h{constructor(){super();
this.yD=0}}Object(m.a)(kf,"OnBeforeHandleServerErrorEventArgs",$h,[]);class Kf extends Sys.EventArgs{constructor(a,b,c){super();this.UP=a;this.CIk=b;this.xh=c}get podSessionId(){return this.UP}get DXc(){return this.CIk}get errorCode(){return this.xh}}Object(m.a)(Kf,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class lh{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.jIe=!1;this.OJk=[8];this.EIe={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,
["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,
["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.vaa=a;this.zga=b;this.Ql=c;this.jQg=f;this.ia=l;this.Xa=u;this.Lb=I;this.Db=T;this.rJb=ja;this.csf=!1;this.Kn=ua;this.uB=Ra;this.Hp=Bb;this.Wj=Ub;this.Ge=eb}At(a,b,c,f){c=void 0===c?null:c;f=void 0===f?!1:f;if(this.disabled)return da.ULS.sendTraceTag(512263053,804,50,"Ignore server error {0}",a?a.Code:315),!0;this.uB.CVk();
if(this.uB.s1)return da.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,u=0,I=0,T=null;var ja=null;c&&(ja=new kf,l=c(ja),u=ja.yD,I=ja.GEa,T=ja.title,ja=ja.message);l||(l=this.f_j(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.Okj(b)&&(this.csf=!0,this.Kn.pause()),a?this.Kz.apply(this,[u,b,I,T,ja,f].concat(a)):this.Kz(u,b,I,T,ja,f));return l}f_j(a,b){if(!a)return!1;da.ULS.sendTraceTag(512263051,
821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code){xe.a.instance.H1e(Date.now());xe.a.H$c(A.AFrameworkApplication.userSessionId);A.AFrameworkApplication.Nmb(jg.a.hi(153),ul.a.unknown,ul.a.FBc);var c=xe.a.instance.n_h();({Gef:b}=c);c.returnValue&&da.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-b);a.ExtraErrorParam?this.Iul(a.ExtraErrorParam[0]):da.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal");return!0}if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.Ia(M.a.failover,2,a.ExtraErrorParam[0]):this.jQg.mgf(a.ExtraErrorParam[0],!0,this.Xa.podSessionId||"",1))||this.Kz(0,157,0,null,
null),!0;if(274===a.Code)return da.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.Hp.instance&&!Aa.a.Ta(this.Xa.YXc))return da.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.Hp.instance.Aff(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"",this.Lb.getBooleanAppSetting("685")&&c.toLowerCase()!==this.Xa.podSessionId.toLowerCase()?(ya.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.Lb.getBooleanAppSetting("884")&&this.jIe?(ya.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),
!0):this.jQg.mgf(a.ExtraErrorParam[0],!1,this.Xa.podSessionId||"",2);if(223===a.Code||285===a.Code||362===a.Code||this.Lb.getBooleanAppSetting("560")&&229===a.Code||this.Lb.getBooleanAppSetting("914")&&this.Hp.instance&&this.Hp.instance.wlj(a.Code)){if(b!==this.Xa.podSessionId)return ya.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;if(this.Lb.getBooleanAppSetting("914")&&
this.Hp.instance&&this.Hp.instance.S0)return ya.a.J(512263043,801,15,"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;ya.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.rJb.Bql(new Kf(this.Xa.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],
a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=this.Db.notificationBar.YEa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.Lb.getBooleanAppSetting("IsAutomation")?a.displayTimeoutSeconds=this.Lb.tc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:ya.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Db.notificationBar.Ei(a),!0;if(238===a.Code&&this.Lb.getBooleanAppSetting("561")&&
this.Hp.instance&&this.Hp.instance.S0)return ya.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return ya.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.ESh(a.Code,null),!0;if(104===a.Code)return b=2===this.Wj.Iea,a.Code=b?56:105,ya.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.",
"GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",pc.a[a.Code]),this.Kz(0,a.Code,0,null,null),!0;if(this.Cfk(a.Code)&&2!==this.Lb.state)return ya.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.Kz.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Kz.apply(this,
[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),!0;return!1}iI(a,b){if(this.disabled)return da.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,u=null,I=null;var T=null;b&&(T=new wj(a),c=b(T),f=T.yD,l=T.GEa,u=T.title,I=T.message,T=T.YUa);c||(c=!1);c||(T?this.Kz.apply(this,[f,a,l,u,I,!1].concat(T)):this.Kz(f,a,l,u,I));return c}Kz(a,b,c,f,l,u,...I){u=void 0===u?!1:u;0===a&&(a=this.vaa.FJj(b));0===c&&(c=this.vaa.D1c(b));
f||(f=this.vaa.Gle(b));l||(3===b&&this.Lb.getBooleanAppSetting("DecryptSkipReasonIRMErrorEnabled")?l=this.Azj():(ya.a.J(512263007,801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.vaa.Xie(b)));const T=()=>{this.W_l.apply(this,[a,b,c,f,l,u].concat(I))};2===this.Lb.state?T():this.Lb.Ue(T)}Azj(){ya.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+A.AFrameworkApplication.z7b);return A.AFrameworkApplication.z7b&&this.EIe[A.AFrameworkApplication.z7b]?
this.EIe[A.AFrameworkApplication.z7b]:this.EIe.Generic}W_l(a,b,c,f,l,u,...I){if(2===a){let T;(T=this.Ql).Y7b.apply(T,[b,c,f,l].concat(I))}else 3===a?this.ESh.apply(this,[b].concat(I)):this.xua.apply(this,[jg.a.hi(b),c,f,l,u].concat(I))}xua(a,b,c,f,l,...u){md.a("CleanFileOpenFailedFromNonDismissible")&&(l=this.uik(jg.a.MJ(a))||l);0===b&&(b=this.vaa.D1c(jg.a.MJ(a)));if(ch.GraphSpaceRootReplicator.XEg(jg.a.MJ(a))&&u&&0<u.length){this.Xa.Cvd=u[0];var I=new La.a;for(var T=1;T<u.length;T++)I.add(u[T]);
u=I.toArray()}I=Object.assign(new Dg.a,{Type:6,Token:this.Ge.td.ftc,Data:{["Reason"]:"FatalError",["ErrorName"]:jg.a.Bea(a)}});md.a("PPT.BootstrapperMessageNewValues")&&(I.MessageId=le.a.H1h,T={Reason:"FatalError"},T.ErrorName=I.Data.ErrorName,I.Values=T);window.parent.postMessage(Fe.c(I),"*");da.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let ja;(ja=this.zga).Y7b.apply(ja,[a,b,c,f,l].concat(u))}Iul(a){Sd.a.openWindow(1,a)}get Rma(){return this.jIe}set Rma(a){this.jIe=
a;ya.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get nbe(){return this.csf}MZd(){}k_d(){}ESh(a,...b){const c=jg.a.hi(a);ya.a.J(512263003,801,50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");A.AFrameworkApplication.Lp(c);eg.Health.instance.recordQosError(jg.a.Bea(c),["SilentFailure"],!1,!0,!0,!1,null)}Cfk(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}uik(a){return 3===a||80===a||5===
a||117===a||4===a||230===a||233===a||256===a||154===a?!0:!1}Okj(a){return Array.contains(this.OJk,a)?!0:!1}}Object(m.a)(lh,"GlobalErrorHandler",null,[115,683]);class sc{constructor(a){this.Fjc=!1;this.oZ=null;this.Us=a}get fBg(){return this.Fjc}oRh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.Fjc||(this.oZ=new ue.a,this.oZ.Fd=5,this.oZ.message=qa.a.j5(b),this.oZ.Is=!1,ya.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),
this.oZ.fra(qa.a.j5(a),null,null),this.Fjc=!0,this.Us.dRf(!0))}U3c(){this.Fjc&&(this.oZ.hide(),this.Fjc=!1,this.oZ=null,this.Us.dRf(!1))}}Object(m.a)(sc,"DeployingDialog",null,[110]);var uf=d(1054),Ak=d(444),oi=d(659),sg=d(494),Ui=d(169),Vh=d(57),qh=d(931);class ab{constructor(a,b,c,f,l,u,I,T){this.tga=this.ff=this.HHb=this.BHb=null;this.Lcd=!1;this.gdd=this.skd=this.yad=null;this.soa=!1;this.sa=a;this.Yb=b;this.Ar=c;this.Tb=f;this.Qbd=l;this.UQg=u;this.Hp=I;this.pUk=T}get qj(){return this.Yb.qj}dPb(a,
b,c,f,l,u){this.soa||(this.soa=!0,this.Lcd=c,this.ff=b,this.skd=l,this.gdd=u,this.Hp.instance&&this.Hp.instance.oYd("abortedOnRefreshDoc"),this.UQg&&this.UQg(),this.Qbd.Jb(this.W5i(a,f)))}W5i(a,b){let c=this.sa.Aa&&!Vh.a.Cx(this.sa.Aa.Fb)?this.sa.Aa.Fb:Vh.a.empty;c=b?Vh.a.empty:c;this.ff.Wa("CurrentActiveSlideId",c.toString());this.yad=Vh.a.Cx(c)?Vh.a.empty:c;return new Kh.a(new qh.a(c,a),Object(R.a)(this,this.B5k,"onGetCellSuccess"),Object(R.a)(this,this.A5k,"onGetCellFailed"),this.pUk?null:Object(R.a)(this,
this.$mm,"validateResponse"))}$mm(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}B5k(a){this.ff.Wa("GetCells",a.ii);a=new uf.a(null,Object(R.a)(this,this.N7j,"inboundSetup"),a);a.Bj=!this.Lcd;a.Fm("RefreshUIOperation");a.Lh()}A5k(a){this.ff.Wa("GetCells",a.ii);200!==a.HttpStatusCode&&this.ff.Wa("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.gdd&&this.gdd(a))return!0;a.ServerError=Object.assign(new vl.a,
{Code:294,Source:0});eg.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}N7j(a,b){(this.tga=this.Yb.yo)&&this.tga.iO&&this.tga.iO.Z$c();this.tga&&this.tga.Wp&&(this.tga.iO=new oi.a(cd.a.instance,"FailoverView"));this.ff.Wa("InboundSetupStartTime",$c.a.Ef(new Date));if(md.a("UseBuildIncrementalInboundOperation"))this.Yb.Aa=null,this.BHb=this.qj.Fq.ZRf(b);else{const c=b.Cells[b.Cells.length-1],f=this.qj.ij.my.id;c.RevisionList[0].BaseId=Ui.a(f);this.Yb.Aa=
null;this.BHb=new Ak.a(c,f,!1,new Date,b.ii,!1,!1,!1)}this.HHb=this.Ar.xe(3);this.HHb.rd(this.sa.presentation);this.Lcd&&this.HHb.pW(a);a.sh(Object(R.a)(this,this.Rva,"inboundIncrementally"));this.ff.Wa("InboundSetupEndTime",$c.a.Ef(new Date));return!0}Rva(a){this.ff.Wa("InboundIncrementallyStartTime",$c.a.Ef(new Date));this.qj.Fq.Rva(this.BHb,new Date);this.BHb.NR&&(this.HHb.dispose(),a.sh(Object(R.a)(this,this.cOl,"setActiveSlideAndRender")),this.HHb=this.BHb=null,this.ff.Wa("InboundIncrementallyEndTime",
$c.a.Ef(new Date)));return!0}cOl(a){this.ff.Wa("SetActiveSlideAndRenderStartTime",$c.a.Ef(new Date));a.sh(Object(R.a)(this,this.xoj,"finishRefreshDoc"));if(Vh.a.empty.equals(this.yad))return this.ff.Wa("SetActiveSlideAndRenderEndTime",$c.a.Ef(new Date)),!0;const b=this.Tb.Qk(this.yad);if(!b)return this.ff.Wa("SetActiveSlideAndRenderEndTime",$c.a.Ef(new Date)),!0;const c=this.Ar.xe(3);try{c.rd(b),this.Lcd&&c.pW(a),this.Yb.Aa=b}finally{c&&c.dispose()}this.ff.Wa("SetActiveSlideAndRenderEndTime",$c.a.Ef(new Date));
return!0}xoj(){this.skd&&this.skd();this.tga&&this.tga.iO&&(this.tga.iO.Z$c(),this.tga.iO=new sg.a);this.d3();return!1}d3(){this.soa=!1;this.gdd=this.skd=this.yad=this.tga=this.ff=this.HHb=this.BHb=null}}Object(m.a)(ab,"RefreshDocExecutor",null,[113]);class wl{Xie(a){switch(a){case 1:a=ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;
break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=
ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;
break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;
break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;break;case 28:a=ResourceStrings.errorMessage_NoLicense;break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 39:a=ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;
break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;
break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;
case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;
break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=
ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=
ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;
break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;
break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;
break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=
ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;
break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;
break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;
break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;
break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;
break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;
break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;
break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;
break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;
break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;case 450:a=ResourceStrings.errorMessage_UploadedVideoTooLarge;break;default:a=ResourceStrings.errorMessage_Unknown}return a}Gle(a){switch(a){case 1:a=ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;
case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;
break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;
break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;
case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;
case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;
case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;
break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 450:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}D1c(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=
6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=
6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;
break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=
2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;
break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;case 450:a=49;break;default:a=0}return a}FJj(a){switch(a){case 5:a=1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;
case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(m.a)(wl,"DefaultErrorMapping",
null,[111]);var Dn=d(727);class Zn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}fc(a){Object(Ti.a)("ErrorHandling");this.K=a;a.register(110,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().na(()=>new sc(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(111,"PowerPointWebEditor.IErrorMapping").ma().na(()=>new wl);a.register(112,"PowerPointWebEditor.IErrorDialog").ma().na(()=>new zd(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new Hc.a(()=>new Dn.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").X6b(a.resolve("Box4.IReplicationParameters")),Tb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),
()=>A.AFrameworkApplication.Dh));a.register(113,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().na(()=>new ab(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),b.value,A.AFrameworkApplication.j9f,this.K.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("DataSyncUseFluid")));
a.register(114,"PowerPointWebEditor.IDocRefreshHandler").ma().na(()=>new Vk(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),()=>A.AFrameworkApplication.Dh,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),
a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(gl,"PowerPointWebEditor.SeamlessFailoverHandler").ma().na(()=>new gl(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>A.AFrameworkApplication.Dh));a.register(115,"PowerPointWebEditor.IDelayedErrorHandler").ma().na(()=>new lh(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),
this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),
this.K.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){Object(Ti.b)("ErrorHandling");this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").qb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").qb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){C.a.instance.Ac(new Zn)}}Object(m.a)(Zn,"PPTWebEditorErrorHandlingPackage",
null,[2,3]);var Bk=d(1286),Gg=d(86);class Ik{constructor(){this.font=null;this.i7c=this.isValid=!1}}Object(m.a)(Ik,"EmbeddedFontClientStatus",null,[]);class qn{constructor(a,b,c,f,l,u){this.old=this.Jgb=null;this.Ba=a;this.um=b;this.G9g=c.Cd(7);this.Wb=f;this.TJb=l;this.kA=u;this.G9g.Ak(Object(R.a)(this,this.Nkb,"onPresentationPropertyChanged"));this.um.rHa(()=>{this.thf(0)})}dispose(){this.G9g.tn(Object(R.a)(this,this.Nkb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.Jgb}get M4h(){return this.old}sge(a){return this.isInitialized?
this.Jgb.Ib(a)?this.Jgb.ga(a):null:null}createFontUrl(a){if(this.Ba.podsHtmlTextForEmbeddedFontsIsEnabled)if(ya.a.J(508692563,820,50,"CreateFontUrl"),this.isInitialized||this.thf(2),this.isInitialized){var b=this.kA.gH(a);if((b=this.sge(b))&&!b.i7c&&b.isValid){b.font.Name!==a&&ya.a.J(508692562,820,15,"Name is not identical");a=Ca.FontUtils.gac(a);const c=this.TJb.resolve(Gg.a.fqj,qn.oqj(b.font));Aa.a.Ta(a)||Aa.a.Ta(c)?ya.a.J(508692561,820,15,"FontFace name or url is invalid"):(this.kA.gTa(a,String.format("url('{0}')",
c)),b.i7c=!0)}}else ya.a.J(508692560,820,10,"Dictionary is not initialized")}Nkb(a,b){b&&b.node&&b.property&&b.property===yb.a.embeddedFonts&&this.thf(1)}thf(a){if(this.Ba.podsHtmlTextForEmbeddedFontsIsEnabled)if(ya.a.J(508692559,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.Wb.BAj()){this.Jgb?ya.a.J(508692556,820,50,"Dictionary is updated, count: {0}",a.length):(this.Jgb=new Cc.a,ya.a.J(508692557,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(Aa.a.Ta(b.Name)){ya.a.J(508692555,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=qn.Yik(b);const c=this.kA.gH(b.Name),f=this.sge(c);f&&(f.isValid===a||f.i7c)||this.Jgb.$(c,Object.assign(new Ik,{font:b,isValid:a,i7c:!1}))}this.old=qn.W7i(this.Jgb);this.kA.$hm(this.old);Ca.FontUtils.Sti(this.old,Object(R.a)(this,this.createFontUrl,"createFontUrl"))}else ya.a.J(508692558,820,10,"EmbeddedFonts is null")}static oqj(a){return JSON.stringify(a)}static Yik(a){return!Aa.a.Ta(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static W7i(a){const b={};for(const c of a)c.value.isValid&&(a=[],a.push(new Bk.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(m.a)(qn,"EmbeddedFontsManager",null,[121,106]);class rn{}rn.loading="loading";rn.loaded="loaded";rn.error="error";Object(m.a)(rn,"FontFaceStatus",null,[]);class gn{constructor(){this.Cfd=this.gMg=!1;this.EHe=null;this.init()}get UFg(){return this.Cfd}load(a){return new Promise((b,c)=>{this.Cfd&&!Aa.a.Ta(a)||c([]);let f;f=this.gMg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.EHe.load(f).then(l=>{for(const u of l)Aa.a.Ta(u.family)||u.status===rn.loaded||ya.a.J(40429085,801,15,"Font load status {0}",u.status);l.length||ya.a.J(41494563,801,15,"No font resolved");b(l)},l=>{ya.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.EHe=a&&a.fonts?a.fonts:null;this.Cfd=!!this.EHe;this.gMg=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("AllowSpecialCharacterFontsToRender");
ya.a.J(41494593,801,50,"FontFaceSetAPIIsSupported: {0}",this.Cfd)}}Object(m.a)(gn,"FontFaceSetObserver",null,[119]);class Wk{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.Xgb=a}Spe(a){return a?a:{}}Lpe(a){return a?a:()=>{}}F5h(a,b,c,f,l,u,I){if(!a)return[];b=this.Spe(b);c=this.Lpe(c);f=this.Spe(f);l=this.Lpe(l);u=this.Spe(u);I=this.Lpe(I);const T=[];for(const ja of a)ja in f?(l(ja),T.push(this.Xgb.load(String.format("{0}_MSCustomFont",ja)))):ja in b?(c(ja),T.push(this.Xgb.load(String.format("{0}_MSFontService",
ja)))):ja in u&&(I(ja),T.push(this.Xgb.load(String.format("{0}_EmbeddedFont",ja))));return T}}Object(m.a)(Wk,"FontsObserver",null,[120]);class hl{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}fc(a){this.K=a;this.K.register(119,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().na(()=>new gn);this.K.register(120,"PowerPointWebEditor.Fonts.IFontsObserver").ma().na(()=>new Wk(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(121,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().na(()=>
new qn(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){C.a.instance.Ac(new hl)}}Object(m.a)(hl,"PPTWebEditorFontsPackage",
null,[2,3]);var Cm=d(439);class Ao{HQh(){return!1}}Object(m.a)(Ao,"DefaultParagraphViewElementSetUpdateStrategy",null,[666]);var Sf=d(226),En=d(1119),J=d(246);class X extends Sf.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){super(a,b,l);this.aIc=null;this.sZb=Vb.a.nil;this.ltf=this.CMd=!1;this.Q_=this.P_=this.wrb=this.vrb=-1;this.aNd=this.LYb=!1;this.NIc=this.t$c=this.zSd=this.BDf=this.stb=null;this.kCd=0;this.Mof=this.f6a=this.avf=null;a.iO.k2a(b);this.GFb=c;this.Rki=u;this.Uei=I;this.Tei=T;this.Qki=
ja;this.zd=ua;this.tfi=Ra;this.jw=eb;this.W4a(!0);this.d9e(!0);this.fPd=new Hc.a(Object(R.a)(this,this.ebj,"determineIsShapesAndTextboxesEnabled"));this.qu=[];this.uQa=new La.a;this.mpf=new La.a;this.rkb();this.Tc.xi&&(b=this.Tc.KHj(this.eb))&&(b.isSelected&&(this.aT.vLb=!0),b.K$&&(this.LYb=!0),this.aT.vLb&&(this.vrb=b.xla,this.wrb=b.yla,this.P_=b.uU,this.Q_=b.Mta));a.Wp&&(a=Object(gb.a)(417,a))&&a.Xrl(this.eb);this.H_b=f;this.sSd=Bb}get Hcl(){return this.H_b}get SWe(){return this.Rki}get bFh(){return this.BDf||
(this.BDf=this.Uei())}get Oqd(){if(!this.zSd){const a=this.Tei();a&&(this.zSd=a.BEm())}return this.zSd}get kg(){return this.zd}get d1(){return this.tfi}get $Hg(){return this.sZb}set $Hg(a){this.sZb=a}get R5j(){return this.uQa}get Ish(){return this.tj?za.a.Pfg(this.tj,!1):0}get tj(){return this.stb}get Kdb(){return this.avf}W4a(a){let b=!1;this.cXl(a)&&(a=this.mab(),this.mc(a),this.aIc=null,this.sZb=Vb.a.nil,b=!0);this.kg.Gg&&this.eb.Lpb?Sys.UI.DomElement.addCssClass(this.htmlElement,Vc.E5):Sys.UI.DomElement.containsCssClass(this.htmlElement,
Vc.E5)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Vc.E5),this.htmlElement.removeAttribute("title"));return b}cXl(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.tj||"p"!==Aa.a.Dg(this.tj.tagName)}mab(){this.stb=this.Vd.Tp(va.a.p);this.stb.className="Paragraph";this.avf=this.Vd.Tp(va.a.span);this.Kdb.className="WACImageGroupContainer";return this.Vd.Nm?this.stb:this.Ipm()}Ipm(){const a=this.Vd.Tp(va.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.stb);this.rp(this.stb);return a}fW(a){super.fW(a);if(this.eb.G0)return a=this.eb.G0.sc(a.L3).QDc,this.eb.G0=null,new J.a(a.tpa,a.minWidth,a.upa);let b;b=this.Mof;a.Gb(88)&&(b=J.a.max(b,a.Ur.TNa),a.Dc());return b}Oz(a){if(A.AFrameworkApplication.fa.getBooleanAppSetting("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.t$c=null,this.tj)){const b=this.tj.getElementsByClassName("LineBox");if(b&&0<b.length){this.t$c=Array(b.length);for(let c=0;c<b.length;c++)this.t$c[c]=za.a.zw(b[c]).length}}this.W4a(!1)&&
(a.currentNode.anchor.Rk(this.Na,8),a.parentNode.anchor.Rk(this.Na,8),this.aIc=null);super.Oz(a);this.u5i(a,this.tj)}u5i(a,b){var c=this.eb;if(this.Tc.xi){var f=Ha.InteractiveViewManager.instance.$d;f&&f.Na===this.Tc.Na&&f.editingView.Nm&&f.editingView.Pg===this.eb&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,X.Xug):Sys.UI.DomElement.removeCssClass(this.htmlElement,X.Xug)}if(c.G0)c=c.G0.sc(a.L3).htmlElement,za.a.v6b(c,b),b=this.Tc,b.xi&&b.PG&128&&(this.eb.G0=null);else{a=
this.LHj();f=Wb.StyleReader.Ujg(a);Wb.StyleReader.z9c(a)&&f?(Ac.d(b,na.a.role,Qe.a.DPf),Ac.d(b,na.a.FPf,f)):(b.removeAttribute(Qe.a.Ff),b.removeAttribute(Qe.a.O3b));var l="";if(U.a.instance.ga(71)||U.a.instance.ga(77))l=this.vyj(c);f=a=null;var u=$a.ParagraphReader.apg(c,U.a.instance.ga(53),U.a.instance.ga(71),U.a.instance.ga(77),U.a.instance.ga(54));if(this.ltf||l!==this.aIc||this.sZb!==c.ESe){a="WindowText";f="transparent";this.aIc=l;this.ltf=!1;l="";let T=null;"P"!==b.tagName&&u.vdb&&(T=Ca.FontUtils.wla(u.fontName));
if(u.y5){var I=u.fontColor;I!==Vb.a.auto&&(a=Vb.a.WH(I))}U.a.instance.ga(49)||(u.zdb&&(I=u.tQ,I!==Vb.a.auto&&(f=Vb.a.WH(I))),u.RWa&&(I=u.highlight,I!==Vb.a.auto&&(f=Vb.a.WH(I))));if(I=$a.ParagraphReader.language(this.eb))if(I=Ea.a.Oe(I))b.setAttribute("xml:lang",I.name),b.setAttribute("lang",I.name);b.style.fontWeight=u.isBold?"bold":"normal";b.style.fontStyle=u.isItalic?"italic":"normal";b.style.verticalAlign="baseline";u.isSuperscript&&(b.style.verticalAlign="super");u.nF&&(b.style.verticalAlign=
"sub");u.VD&&(l="underline");if(u.zC||u.qY)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=T?T:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";u.MWa?1===u.capitalization?b.style.fontVariant="small-caps":2===u.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.sZb=c.ESe;U.a.instance.ga(49)&&(u.zdb&&(l=u.tQ,l!==Vb.a.auto&&(f=Vb.a.WH(l))),u.RWa&&(u=u.highlight,u!==Vb.a.auto&&(f=Vb.a.WH(u))));this.eb.properties.ra(rb.a.AAg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Qe.a.iea,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Qe.a.iea),f?(b.style.backgroundColor=f,X.YKf(f,b)):U.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.ESe!==Vb.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,X.YKf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=ge.OutlineElementReader.kn(jb.OutlineElementNavigator.qC(this.eb));this.Tc.Nm&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch($a.ParagraphReader.zM(this.eb)){case 1:b.style.textAlign="left";b.style.opb="";break;case 2:b.style.textAlign="center";b.style.opb="";break;case 3:b.style.textAlign="right";b.style.opb="";break;case 6:b.style.textAlign="justify";b.style.opb="auto";break;case 7:b.style.textAlign="justify";b.style.opb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.opb="kashida";break;case 13:b.style.textAlign="justify";b.style.opb="inter-cluster";break;default:b.style.textAlign="",b.style.opb=""}4===ad.App.mode&&U.a.instance.ga(86)&&E.a.Gk&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");U.a.instance.ga(54)&&(a=this.eb.ra(ib.a.Wo,0),Ac.d(b,na.a.Ly,a),Ac.d(b,na.a.Ccl,this.eb.id.toString()));this.SWe.JMh(this.eb,
b,c,this.Na)}}LHj(){var a=U.a.instance.ga(71)?(a=Wb.StyleReader.iF(this.eb))?Wb.StyleReader.GR(a):U.a.instance.ga(61)?Wb.StyleReader.dPa:Wb.StyleReader.lra:Wb.StyleReader.lra;return a}vyj(a){let b="";const c=Wb.StyleReader.iF(a);c&&(b+=c.id);if(Wb.StyleReader.xs){const {tableStyle:f,W$a:l}=Wb.StyleReader.xs.Ucb(a);f&&(b+=f.id);l&&(b+=l.id)}return b}Kca(){this.eb.E$(this.Na,16,!0)}rkb(){this.fPd.value&&this.eb.Ldb.rkb()}wL(a){const b=Date.now();if(!this.y2l()){this.rkb();var c=this.eb;this.KWf();za.a.qw(this.tj);
za.a.qw(this.Kdb);var f=this.tj;f.style.minHeight="";this.qu=[];this.kCd=0;var l=new La.a,u=0;a&&(u=this.wGi(a,c,l,f,u));if(!this.x2l()){a=!1;var I=this.htmlElement.parentNode,T=this.htmlElement.nextSibling;I&&(this.Evc(I,this.htmlElement),a=!0);this.Oqd&&this.Oqd.OCm();var ja=u;u=this.Hcl.vDl(c,this.Vd,f,this.R5j,l,Object(R.a)(this,this.moh,"onOverHyperlink"),Object(R.a)(this,this.ioh,"onOutHyperlink"),Object(R.a)(this,this.pL,"takeOwnershipOfSubtree"),Object(R.a)(this,this.rp,"takeOwnership"),ia.a.GWc,
this.$Hg,u,this.vrb,this.wrb,this.LYb,X.A9c,!!this.aT&&this.aT.vLb,this.CMd,ad.App.tT.Z9e,ge.OutlineElementReader.kn(jb.OutlineElementNavigator.qC(this.eb)));!A.AFrameworkApplication.fa.getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")&&!A.AFrameworkApplication.fa.getBooleanAppSetting("TextLayoutServiceDataDeletionFixEnabled")||!this.jw.mWf(c,l)||this.jw.XZh(f,this.Vd,u.OIf,c,ja,l,Me.a.instance.Oa?Me.a.instance.Oa.kb:null,this.t$c)||this.Vd.Wp||(this.jw.X3h(c),A.AFrameworkApplication.fa.getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")&&
this.jw.RBc(c));this.qu=l.toArray();this.NIc=u.Rhh;this.mpf=u.xWf;this.CMd=u.Mug;this.Oqd&&this.Oqd.HCm(this.Ish);this.bFh&&this.bFh.MCm(f);this.A2h();this.aNd=!0;a&&I.insertBefore(this.htmlElement,T);!this.Tc.Nm&&I&&"li"===Aa.a.Dg(I.tagName)&&this.CGi(c,I);this.Tc.Nm||this.jw.eZf(f);c=Date.now();da.ULS.sendTraceTag(508416091,820,50,"updateHtmlOverlayDisplay: StartTime:{0},EndTime:{1}",b,c)}}}CGi(a,b){if(Kc.ListReader.Fpa){if(b=this.L0c(a)){const c=b.sc(this.Tc.Na);if(c){const f=za.a.lfa(this.htmlElement,
"Paragraph");this.qcl(a)?(a=(a=this.zHj(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):za.a.IYd(f,c.htmlElement);b.anchor.Rk(this.Na,64)}}}else this.GFb.m0f(b,a,this.Na)}zHj(a){for(let b=0;b<a.children.length;b++){const c=a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}qcl(a){if(!a)return!1;a=a.Sa;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.kr:!1:!1}L0c(a){const b=new mb.GraphIterator;b.set(a);return b.wf()?(jb.OutlineElementNavigator.$e(b),
this.kg.Gg&&!b.gK(4)?b.Gb(31):b.Gb(4)):null}wGi(a,b,c,f,l){a=ui.a.ob(a.L3,a.currentNode);if(!a.sj())return l;let u=0,I=!1,T=0,ja=0,ua=0,Ra=!1;const eb=$a.ParagraphReader.tY(b),Bb=this.fPd.value;do{const Ub=a.Ur.htmlElement;Sys.UI.DomElement.containsCssClass(Ub,ia.a.wX)?(Bb&&b.Ldb.QDm?(Ra||(Kc.ListReader.wy&&eb||b.Ldb.HDm(this.Kdb),f.appendChild(this.Kdb)),this.Kdb.appendChild(Ub)):f.appendChild(Ub),ca.a.Uw(Ub,ia.a.nIa,l++),c.add(Ub),this.Tc.xi&&({cYk:T,GWk:ja,FWk:ua}=X.FRl(b,Ub,Bb,a,Ra,T,ja,ua)),
I=Ra=!0):f.appendChild(Ub)}while(a.VGa());Bb?this.Tc.Nm?this.Bim():(this.D2h(ua+6,ja+6),u=ja+6):u=ja-T+6;I&&!ad.App.instance.i7j&&this.Tc.xi&&f.clientHeight<u&&(f.style.minHeight=u+"px");return l}D2h(a,b){this.fPd.value&&this.eb.Ldb.GDm(this.Kdb,void 0===a?0:a,void 0===b?0:b)}ZEd(){const a=new ui.a(this.Na);a.set(this.eb);a.wf();jb.OutlineElementNavigator.$e(a);Kc.ListReader.wy&&(this.SWe.JMh(this.eb,this.tj,ge.OutlineElementReader.kn(a.currentNode),this.Na),this.GFb.$im(a))}A2h(){this.d1.prc(this.eb,
this.tj)}ebj(){const a=Tb.a.instance.ub("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.Q_=this.P_=this.wrb=this.vrb=-1)}get xla(){return this.Tc.Nm?this.eb.sc(this.Tc.Yf.Na).xla:this.vrb}set xla(a){this.vrb!==a&&(this.vrb=a,this.Xqa(16),this.eb.anchor.Rk(this.Tc.Na,16))}get yla(){return this.Tc.Nm?this.eb.sc(this.Tc.Yf.Na).yla:this.wrb}set yla(a){this.wrb!==a&&(this.wrb=a,this.Xqa(48),this.eb.anchor.Rk(this.Tc.Na,
48))}get uU(){return this.Tc.Nm?this.eb.sc(this.Tc.Yf.Na).uU:this.P_}set uU(a){this.P_!==a&&(this.P_=a,this.Xqa(16),this.eb.anchor.Rk(this.Tc.Na,16))}get Mta(){return this.Tc.Nm?this.eb.sc(this.Tc.Yf.Na).Mta:this.Q_}set Mta(a){this.Q_!==a&&(this.Q_=a,this.Xqa(48),this.eb.anchor.Rk(this.Tc.Na,48))}get K$(){return this.Tc.Nm?this.eb.sc(this.Tc.Yf.Na).K$:this.LYb}set K$(a){this.LYb!==a&&(this.LYb=a,this.Xqa(16),this.eb.anchor.Rk(this.Tc.Na,16))}get $9f(){return this.qu[this.qu.length-1]}dispose(){this.Vyl();
super.dispose();this.KWf();for(const a of this.mpf)a.t6f(this.Vd)}Vyl(){if(this.f6a&&this.htmlElement)for(const a of this.f6a)a.Uyl(this.htmlElement)}Jpa(){super.Jpa();this.CMd&&this.Tc.notify(2)}VEd(a){const b=A.AFrameworkApplication.fa.getBooleanAppSetting("Box4DoNotRenderPresenceOutOfView"),c=this.Tc.vWe.sje(this.eb);this.sSd.OEh(c,this.f6a,this,this.htmlElement,b,this.GYl());this.f6a=c;this.aNd||this.A2h();this.aNd=!1;super.VEd(a)}Xqa(a){this.Qki.HQh(this.eb)||super.Xqa(a)}y2l(){if(this.TCg()){const a=
this.Tc;if(1!==a.editingView.yyb)return a.X8d=!0}return!1}x2l(){return this.Tc.Nm&&Bc.SelectionEditor.$va(Me.a.instance.Oa.kb)?!0:!1}Bim(){var a=this.eb.sc(this.Tc.Yf.Na);a&&(a=Sys.UI.DomElement.getBounds(a.Kdb),this.D2h(a.width,a.height))}GYl(){return!this.TCg()&&!this.Tc.Nm}TCg(){if(Ha.InteractiveViewManager.instance.$d!==this.Tc)return!1;const a=this.Tc.editingView;return a.Pg===this.eb&&2===a.mode}jnk(){const a=this.getBounds(),b=Sd.a.wi(this.Tc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}ZQe(a){a.ZFh(this);
0<this.kCd&&a.cFl(this)}get O0a(){return this.tj}V2h(a){this.Mof=new J.a(0,a,0)}getBounds(){const a=ha.a.Dwb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Tc.xi?this.eb.id.toString():"");this.SWe.MBi(this.eb,a,ge.OutlineElementReader.kn(jb.OutlineElementNavigator.qC(this.eb)),this.Tc.Na);return a}moh(a){Sf.a.AUl(a.Ec,a.CE);if(ad.App.P4b){const b=a.Ec,c=b.querySelector(".NormalTextRun")||b;U.a.instance.ga(8)||a.I0?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,
X.BRe);En.a.instance().Hyi(Object(R.a)(this,this.dUe,"onCtrlKeyDown"));En.a.instance().Iyi(Object(R.a)(this,this.fUe,"onCtrlKeyUp"))}return!0}ioh(a){Sys.UI.DomElement.removeCssClass(a.Ec,X.BRe);En.a.instance().ODh(Object(R.a)(this,this.dUe,"onCtrlKeyDown"));En.a.instance().PDh(Object(R.a)(this,this.fUe,"onCtrlKeyUp"));return!0}KWf(){for(let a=0;a<this.uQa.count;a++)ad.App.Ob.sT.Hb(la.a.uha,this.uQa.ga(a),Object(R.a)(this,this.moh,"onOverHyperlink")),ad.App.Ob.sT.Hb(la.a.vha,this.uQa.ga(a),Object(R.a)(this,
this.ioh,"onOutHyperlink")),En.a.instance().ODh(Object(R.a)(this,this.dUe,"onCtrlKeyDown")),En.a.instance().PDh(Object(R.a)(this,this.fUe,"onCtrlKeyUp"));this.uQa.clear();if(this.NIc){for(const a of this.NIc)ad.App.Ob.sT.Hb(a.eventName,a.Ec,a.handler);this.NIc=null}}dUe(){this.tAa("pointer")}fUe(){this.tAa("text")}tAa(a){for(let b=0;b<this.uQa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.uQa.ga(b),X.BRe)){const c=this.uQa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get A9c(){return!!Me.a.instance.Oa&&
!!Me.a.instance.Oa.kb&&Me.a.instance.Oa.kb.A9c}static YKf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static FRl(a,b,c,f,l,u,I,T){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.Ldb.cvm(f.currentNode),b.x=a.x,b.y=a.y,b.height&&b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<u)u=b.y;if(!l||a>I)I=a;b=b.x+b.width;if(!l||b>T)T=b;return{cYk:u,GWk:I,FWk:T}}}X.Xug="HiddenParagraph";X.BRe="MouseIsOn";Object(m.a)(X,"ParagraphViewElement",
Sf.a,[214,675,489,393,106]);class Ia extends Sf.a{constructor(a,b,c,f,l){super(a,b);this.qh=this.zd=this.wda=null;Kc.ListReader.Fpa?(this.R5f(),this.d9e(!0),this.wda=c,this.zd=l,this.qh=f,this.W4a(!0)):(this.d9e(!1),a=this.Vd.Tp(va.a.span),a.className="ListGhost",this.mc(a))}W4a(a){if(Kc.ListReader.Fpa){var b=this.vmg(this.eb);a&&(a=this.V7d(),this.mc(a),(b=Object(gb.a)(X,b.sc(this.Tc.Na)))&&b.htmlElement&&(b=b.tj))&&((a=za.a.U$b(b,Ia.Ffb))?b.replaceChild(this.htmlElement,a):za.a.IYd(b,this.htmlElement))}}get Wze(){return za.a.U$b(this.htmlElement,
Ia.ghc)}Oz(){this.W4a(!1);if(!this.Tc.Nm&&Kc.ListReader.Fpa)if(this.zd.Gg)this.sRl(this.htmlElement,this.Wze,this.eb);else{const a=this.wda.IFb(this.eb);this.Wze.innerText=a}}wL(a){this.Tc.Nm||Kc.ListReader.Fpa&&a.currentNode.anchor.Rk(this.Na,64)}ZQe(a){Kc.ListReader.Fpa&&a.ZFh(this)}get O0a(){return this.htmlElement}V2h(){}ZEd(){this.tRl()}elg(){return-1}sRl(a,b,c){var f=this.qh.Die(c);if(f)if(12!==f.type)Pa.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",
f.type);else{var l=f.Sa,u=l?l.last.vp:null;l=l?l.last.iq:null;var I=f.Lpb,T=f.QNb,ja=f.k$();f=!!I&&T.xig(ja).Qa(ib.a.listID);I=null;f&&(I=T.Qa(ib.a.listID)&&ja.Qa(ib.a.listID)?3:T.Qa(ib.a.listID)?2:1);T=this.wda.IFb(c);c=this.wda.IFb(c);u=!!u||f&&(1===I||3===I);l=!!l||f&&(2===I||3===I);I=!u&&!l&&""!==T&&T!==c;for(ja=!u&&!l&&!I;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,Vc.Uze);Sys.UI.DomElement.removeCssClass(a,Vc.E5);
if(ja)b.innerText=c;else{if(l||I)ja=Xc.a.createElement(b.ownerDocument,va.a.span),Sys.UI.DomElement.addCssClass(ja,Vc.IXh),ja.innerText=T,b.appendChild(ja);if(u||I)T=Xc.a.createElement(b.ownerDocument,va.a.span),Sys.UI.DomElement.addCssClass(T,Vc.KXh),T.innerText=c,b.appendChild(T);u||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Vc.Uze);f&&Sys.UI.DomElement.addCssClass(a,Vc.E5)}}else Pa.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}vmg(a){if(!a)return null;
const b=new mb.GraphIterator;b.set(a);b.wf();return jb.OutlineElementNavigator.$e(b)?b.Gb(2):null}V7d(){const a=this.Vd.Tp(va.a.span);Sys.UI.DomElement.addCssClass(a,Ia.Ffb);this.QTc(a);return a}QTc(a){const b=Xc.a.createElement(a.ownerDocument,va.a.span);Sys.UI.DomElement.addCssClass(b,Ia.ghc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}tRl(){if(!this.Tc.Nm){var a=this.vmg(this.eb),b=a.sc(this.Tc.Na).htmlElement.parentNode;!this.Tc.Nm&&b&&"li"===Aa.a.Dg(b.tagName)&&
this.wda.S2h(b,a,this.Na,this.Wze,!1)}}}Ia.Ffb="ListMarkerWrappingSpan";Ia.ghc="ListMarker";Object(m.a)(Ia,"NumberListViewElement",Sf.a,[675,489,393,106]);var fb=d(399),Ab=d(1134);class ec{constructor(a,b){this.offsetWidth=a;this.offsetHeight=b}}Object(m.a)(ec,"ListMarkerOffset",null,[]);class Uc{constructor(){this.EMk="ListMarkerMeasuringPad";this.Qlc=new Md.a}EEj(a){let b=a.innerHTML;if(!b.length)return new ec(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",
c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.Qlc.Ib(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),Ab.a.d4b(),Ab.a.Mcb(this.EMk).appendChild(a),{width:c,height:a}=Sd.a.M_c(a),this.Qlc.$(b,new ec(c,a)),Ab.a.U8b());return this.Qlc.ga(b)}}Object(m.a)(Uc,"ListMarkerOffsetCache",
null,[126]);var Ad=d(1273),Ce=d(1289),ye=d(81),hf=d(258),Gf=d(184),Kg=d(499);class Lg{constructor(a,b){this.zd=this.c0=this.QL=null;this.qh=a;this.JH=b;this.FH=Kc.ListReader.wy;this.vy=E.a.vy||E.a.gp}get eg(){return this.qh}get KN(){return this.JH}get XM(){return this.QL||(this.QL=Tb.a.instance.ub("Box4.List.ListSettings"))}get mma(){return this.c0||(this.c0=Tb.a.instance.Ha("Common.IZoomManager"))}set mma(a){this.c0=a}get kg(){return this.zd||(this.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.FH}IFb(a){const b=
this.eg.WVa(a);return b&&b.propertySet.ra(rb.a.Dj,null)?1===b.listType?this.ySf(b):0===b.listType?this.akh(b,a):"":""}Zim(a,b){if(this.enabled&&b&&(this.eg.Xfa(b)||this.kg.Gg&&63===b.type)&&this.gEb(a)){a.style.display="block";var c=this.pBb(a);this.Qyd(a,b);c&&(a=this.IFb(b),c.innerText=a)}}m0f(a,b,c){if(this.enabled&&this.gEb(a)){var f=this.pBb(a);f&&this.S2h(a,b,c,f)}}S2h(a,b,c,f,l){l=void 0===l?!1:l;var u=mb.GraphIterator.ob(b);u.wf();jb.OutlineElementNavigator.$e(u);if(Kc.ListReader.hl(u)||this.kg.Gg&&
Kc.ListReader.Tfc(u)){const T=u.currentNode;var I=ge.OutlineElementReader.kn(T);this.kg.Gg?this.eg.hih(u):this.eg.vpa(u);u=u.currentNode;if(!Kc.ListReader.Fpa){const ja=this.IFb(u);f.innerText=ja}f.setAttribute(Qe.a.JJ,Qe.a.cC);12!==b.type?Kg.a.F7c(b)&&(b=f.parentNode,f.style.height="auto",{width:c,height:a}=this.aBb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=I?"13px":c+"px",f.style.marginRight=I?c+"px":"13px",za.a.RPl(f,I?"right":"left"),{height:I}=this.aBb(b.parentNode),f.style.marginTop=
Math.max((I-a)/2,0)+"px"):(this.VTl(a,f,b,T,u,c),this.Ehf(b,f,c,u,I,l))}}$im(a){this.enabled&&a&&a.Ur&&ge.OutlineElementReader.kn(a.currentNode)}Dhf(a,b,c,f,l){l=void 0===l?-1:l;this.enabled&&($a.ParagraphReader.tY(a)||this.kg.Gg&&$a.ParagraphReader.vjk(a))&&this.Q2h(a,b,c,l,null)}Xim(a,b,c){if(this.enabled&&this.gEb(a)){var f=za.a.dhg(a,Lg.mfj);if(f&&(f=za.a.dhg(f,Lg.lfj))&&(f=za.a.f$(f,Lg.Sha))&&f.style&&(E.a.jg||(f.style.marginTop="0px"),(a=za.a.f$(a,Lg.Gcl))&&(a=za.a.f$(a,Lg.Sha))&&f.className.startsWith(Lg.Sha))){if(this.kg.Gg){var l=
za.a.MAb(a,Lg.tOa);var u=za.a.MAb(f,Lg.tOa)}else l=this.eee(a,Lg.tOa),u=za.a.f$(f,Lg.tOa);if(l&&u){f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?"0px":a.style.marginLeft);f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight);var {fdg:I,Ucg:T}=this.O2h(a,f,l,u,b,c);this.cCi(I,T,f)}}}}eee(a,b){return za.a.f$(a,b)}O2h(a,b,c,f,l,u){var I;""!==a.style.textIndent&&(u&&this.eg.Gfb||""===b.style.textIndent)&&
(u=a.style.textIndent,this.eg.Gfb&&(I=this.K0c(a))&&(u=this.EOi(I,u)),b.style.textIndent=u);u=this.YAb(c);I=this.YAb(f);Math.floor(I.x)!==Math.floor(u.x)?(a=this.QOi(l,u,I),a=isNaN(a)?0:a,""!==b.style.textIndent&&(l=b.style.textIndent,u=l.lastIndexOf("px"),0<u&&(l=l.substring(0,u),a+=parseInt(l))),b.style.textIndent=a+"px",u=this.YAb(c),I=this.YAb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{fdg:u,Ucg:I}}QOi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.XM.ilk||(f=this.wmg(a,
b,c)):f=this.wmg(a,b,c);return f}wmg(a,b,c){return a?c.x-b.x:b.x-c.x}EOi(a,b){let c=b;const f=this.aBb(a).width;if(f){var l=a.style.marginLeft,u=a.style.marginRight;const I=l.lastIndexOf("px"),T=u.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<I&&0<T&&(l=this.WWe(l,I),u=this.WWe(u,T),(b=this.WWe(b,a))||l||u)&&(c=b+f+l+u+"px")}return c}WWe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}cCi(a,b,c){if(E.a.jg){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;
c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}elg(a,b){b=void 0===b?!1:b;return(a=this.pBb(a))?(a=this.aBb(a).width,b?a+0:a):0}pBb(a){return this.enabled&&this.gEb(a)?(a=Kg.a.NEj(a))?this.clg(a):null:null}Qyd(a,b,c){c=void 0===c?!1:c;if(this.enabled&&this.gEb(a)){if(this.kg.Gg){var f="1";var l=this.eg.zie(b)}else f=this.DEj(b),l=this.eg.WVa(b);b=this.Bac(b,l);c?(Ac.d(a,na.a.m9i,b),Ac.d(a,na.a.role,Qe.a.PSa),Ac.d(a,na.a.l9i,f)):(Ac.d(a,na.a.YFi,b),Ac.d(a,na.a.role,Qe.a.PSa),
Ac.d(a,na.a.FPf,f))}}clg(a){if(!this.enabled||!a)return null;let b=null;(a=this.K0c(a))&&(b=za.a.f$(a,Lg.ghc)||this.QTc(a));return b}gEb(a){return!!a&&"li"===Aa.a.Dg(a.tagName)}Q2h(){}oig(){return 720}aBb(a){let b,c;({width:b,height:c}=Sd.a.M_c(a));this.mma&&this.mma.instance&&this.mma.instance.KCg(a)&&(b/=this.mma.instance.X4,c/=this.mma.instance.X4);return{width:b,height:c}}YAb(a){const b=Sd.a.M_c(a).returnValue;this.mma&&this.mma.instance&&this.mma.instance.KCg(a)&&(b.x/=this.mma.instance.X4,b.y/=
this.mma.instance.X4);return b}xma(a,b){switch(a.xma()){case 0:return b+"";case 4:return Aa.a.B_f(b-1,!0);case 2:return Aa.a.D_f(b,!0);case 3:return Aa.a.B_f(b-1,!1);case 1:return Aa.a.D_f(b,!1);case 22:return 10>b?"0"+b:b+"";default:return b+""}}ySf(a){if(1!==a.listType)return"";a=this.UGj(a.listType,a.listStyle);return hf.a.ORf(a[0])}akh(a,b){b=this.Bac(b,a);return this.xma(a,b)+"."}UGj(a,b){return Gf.a.JO(a,b).propertySet.ra(rb.a.Dj,null)}Bac(a,b){const c=b.Tla;return c!==hf.a.Wx?c:this.XOi(a,
b)}XOi(a,b){if(b.BY!==hf.a.Wx)return b.BY;if(b.EB!==hf.a.Wx)return b.EB;let c=1;const f=new mb.GraphIterator;f.set(a);f.wf();for(jb.OutlineElementNavigator.$e(f);f.Gva();)if(Kc.ListReader.hl(f)){const l=this.eg.Aw(f);if(l&&b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.BY!==hf.a.Wx)return c+l.BY;if(l.EB!==hf.a.Wx)return c+l.EB;if(a.Qa(ib.a.listID)&&f.currentNode.Qa(ib.a.listID)&&f.currentNode.$a(ib.a.listID)!==a.$a(ib.a.listID))break;c++}}return c}Ekm(a,b){ad.App.Efb&&(a.Qa(rb.a.fontColor)&&
(b.fontColor=a.$a(rb.a.fontColor)),a.Qa(rb.a.fontSize)&&(b.fontSize=a.$a(rb.a.fontSize)),a.Qa(rb.a.font)&&(b.fontName=a.$a(rb.a.font)),a.Qa(rb.a.bold)&&(b.isBold=a.$a(rb.a.bold)),a.Qa(rb.a.italic)&&(b.isItalic=a.$a(rb.a.italic)),a.Qa(rb.a.superscript)&&(b.isSuperscript=a.$a(rb.a.superscript)),a.Qa(rb.a.subscript)&&(b.nF=a.$a(rb.a.subscript)),a.Qa(rb.a.strikethrough)&&(b.zC=a.$a(rb.a.strikethrough)),a.Qa(ye.a.hu)&&(b.qY=a.$a(ye.a.hu)))}vje(a,b){a=$a.ParagraphReader.apg(a,U.a.instance.ga(53),U.a.instance.ga(71),
U.a.instance.ga(77),U.a.instance.ga(54));this.Ekm(b,a);return a}eig(){return null}R2h(a,b,c,f){const l=c.parentNode;let u=f.ra(rb.a.fontSize,yf.Font.OJ);if(a.nF||a.isSuperscript)Ac.d(c,na.a.o3f,(u/2).toString()),u=Math.floor(u*nc.jqj),l&&(l.style.fontSize=u/2+"pt"),c.style.fontSize=u/2+"pt";else if(Kc.ListReader.Fpa){if(c.style.fontSize=u/2+"pt",!f.Qa(rb.a.fontSize)&&(a=za.a.MAb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}VTl(a,b,c,f,l,u){b&&this.gEb(a)&&(b.style.verticalAlign=
a.style.verticalAlign,f&&l&&ad.App.Efb&&(u=f.vg(u)))&&(f=this.vje(c,l,U.a.instance.ga(53),U.a.instance.ga(71),U.a.instance.ga(77),U.a.instance.ga(54)),f=this.eig(u.Vd,c)||f,this.mac(a,b,l),!this.kg.Gg||""===b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Vc.Uze)?(c="",f.y5&&(u=f.fontColor,u!==Vb.a.auto&&(c=Vb.a.WH(u))),b.style.color=c,c=this.eg.WVa(l)):c=this.eg.zie(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?
b.style.verticalAlign="super":f.nF&&(b.style.verticalAlign="sub"),this.R2h(f,a,b,l),f.zC||f.qY)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":"line-through")}mac(a,b){b.style.fontFamily=a.style.fontFamily}K0c(a){return a?za.a.U$b(a,Te.a.Ffb)||this.V7d(a):null}QTc(a){const b=Xc.a.createElement(a.ownerDocument,va.a.span);Sys.UI.DomElement.addCssClass(b,Lg.ghc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}V7d(a){if(!a)return null;
const b=Xc.a.createElement(a.ownerDocument,va.a.span);Sys.UI.DomElement.addCssClass(b,Te.a.Ffb);za.a.IYd(a,b);this.QTc(b);return b}Ehf(a,b,c){this.Dhf(a,b.parentNode.parentNode,this.KN.cBb(a).NUb,this.KN.qcb(a).NUb,c)}}Lg.Sha="Paragraph";Lg.Gcl="ParaWrappingDiv";Lg.lfj="_EditingElement";Lg.mfj="_EditingElement_WrappingDiv";Lg.tOa="TextRun";Lg.ghc="ListMarker";Object(m.a)(Lg,"AListMarkerUtility",null,[127]);var se=d(66),xi=d(834);class gi{}gi.M2d=8226;gi.wSf="Arial";gi.m9d=65532;gi.uLa=65533;Object(m.a)(gi,
"PptListConstants",null,[]);var jf=d(61),th=d(236);class Fn extends Lg{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){super(a,b);this.oFk=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061];this.yBe=c;this.Qlc=f;this.Ga=l;this.Qm=u;this.wSk=I;this.Ub=T;this.iE=ja;this.Uh=ua;this.IK=Ra;this.DI=eb;this.hB=Bb;this.BLg=Ub;this.g_a=Xb;this.kB=Ec;this.yxa=tc;this.llc=lc}DEj(a){const b=new mb.GraphIterator;b.set(a);b.wf();jb.OutlineElementNavigator.$e(b);return b.currentNode.ra(ib.a.listLevel,
0)+1+""}Q2h(a,b,c,f,l){const u=this.yBe.Cq(M.a.Yim);l=new ui.a(f);l.set(a);l.wf();jb.OutlineElementNavigator.$e(l);if(Kc.ListReader.hl(l)){if(!b){this.yBe.kc(be.a.ei,{["Reason"]:"ParagraphElementNull"});u.end();return}f=this.clg(b);if(!f){this.yBe.kc(be.a.ei,{["Reason"]:"ListMarkerNotFound"});u.end();return}const I=this.aBb(f).width,T=l.Ur.Vd.Xd;a=T.tL(this.KN.o$(a).hO,0);c=T.tL(Ad.a.Wha(c,0),0);this.kB&&Object(gc.a)(268,this.hB.$d)&&(c=0);l=ge.OutlineElementReader.kn(l.currentNode);this.pRl(b,f,
a,c,I,l)}u.end()}aBb(a){a=this.Qlc.EEj(a);return{width:a.offsetWidth,height:a.offsetHeight}}K0c(a){let b=a;this.g_a&&a&&0<=a.className.indexOf(fc.a.Sha)&&(a=za.a.lfa(a,fc.a.DY))&&(b=a);return super.K0c(b)}eee(a,b){return this.g_a?za.a.f$(a,fc.a.DY)?za.a.MAb(a,b):za.a.f$(a,b):super.eee(a,b)}O2h(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.YAb(c);f=this.YAb(f);return{fdg:a,Ucg:f}}xma(a,b){switch(a.xma()){case 18:return 21>b?Aa.a.fromCharCode(b-1+9312):b.toString();case 19:return this.Nsj(b)}return super.xma(a,
b)}ySf(a){let b="";if(1===a.listType){const c=a.propertySet.ra(rb.a.Dj,null);c&&c.length&&c[0]&&(b=Aa.a.px(c[0],4))}b=this.tCi(b?b:"2022",a);if(md.a("FixEvalSecurityBugForListMarkerUtility")&&String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));ya.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(Ce.a)(String.format("'\\u{0}'",b))}akh(a,b){b=this.Bac(b,a);return this.xma(a,b)+this.TGj(a)}pRl(a,b,c,f,l,u){f?this.rRl(a,b,f,c,l,u):this.qRl(a,b,l,u)}rRl(a,b,
c,f,l,u){const I=Math.max(Math.abs(c),l);a.style.textIndent=0<c?I+"px":Math.max(I-f,0)+"px";this.yMh(I-l,-1*I,b,u)}qRl(a,b,c,f){a.style.textIndent=c+"px";this.yMh(0,-1*c,b,f)}yMh(a,b,c,f){c.style.marginLeft=f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}TGj(a){a=a.caa;for(let b=0;b<a.length;b++)if(a[b]===gi.uLa){if(b+2>=a.length)break;return a[b+2]?Aa.a.fromCharCode(a[b+2]):""}return"."}Nsj(a){let b="";for(;0<a;)b=Aa.a.fromCharCode(this.oFk[a%10])+b,a=parseInt(String(a/10));return b}tCi(a,b){let c=
a;1===b.listType&&b.udb&&0<=Array.indexOf(Fn.SIl,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}vje(a,b,c,f,l,u){if(!this.BLg)return super.vje(a,b,c,f,l,u);c=this.Ub.Pc(b);c.uc(11);c.Ug(11);c=this.IK.BR(c,this.DI.rfa(c));f=new xi.ParagraphStandardProperties;(l=this.Qm.I$(b))||this.wSk.Efk(b)?(f.fontColor=Vb.a.kUa,f.fontSize=l?jf.a.zjh:$a.ParagraphReader.cma(a,rb.a.fontSize,yf.Font.OJ)):(l=this.Uh.cma(a,rb.a.fontSize,yf.Font.OJ),u=this.Ga.lGa(this.Ga.Gn(a)),l*=u,b.Qa(yb.a.jAb)&&(l*=b.$a(yb.a.jAb)),
f.fontSize=l,f.fontColor=this.getPropertyValue(a,c,b,rb.a.fontColor,Vb.a.nil),md.a("Microsoft.Office.PowerPoint.ChangeGate.ApplyFontPropertiesOnListMarker")&&(1!=this.eg.WVa(b).listType&&(f.isBold=this.getPropertyValue(a,c,b,rb.a.bold,!1),f.isItalic=this.getPropertyValue(a,c,b,rb.a.italic,!1)),f.highlight=this.getPropertyValue(a,c,b,rb.a.highlight,Vb.a.nil),f.tQ=this.getPropertyValue(a,c,b,rb.a.Y4b,Vb.a.nil),f.zC=this.getPropertyValue(a,c,b,rb.a.strikethrough,!1)));return f}R2h(a,b,c){this.BLg&&(b=
this.iE.aK(b))&&a.Iva&&(c.style.fontSize=b.Vd.Xd.aua(a.fontSize),c.style.lineHeight="0.1")}xjg(a,b){let c="";const f=this.eg.WVa(b);1===f.listType&&f.udb?c=f.font&&-1===f.font.indexOf(",")?Ca.FontUtils.wla(f.font):f.font:19===f.xma()||18===f.xma()&&21>this.Bac(b,f)?c=Ca.FontUtils.wla("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}getPropertyValue(a,b,c,f,l){return c.Qa(f)?c.$a(f):b&&b.Qa(f)&&!se.isTableCellOrInside(this.Ub.Pc(c))?
b.$a(f):this.Uh.cma(a,f,l)}mac(a,b,c){a=this.xjg(b,c);b.style.fontFamily=a;b.style.fontFamily||!E.a.Fk&&!E.a.gp||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}Ehf(a,b,c,f,l,u){u=void 0===u?!1:u;if(this.g_a){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(fc.a.DY)?b.parentNode:b,this.Dhf(a,b,this.KN.cBb(a).NUb,this.KN.qcb(a).NUb,c)}else super.Ehf(a,b,c,f,l,u)}pBb(a){return super.pBb(a)}uEj(a,
b){return this.Bac(b,a)}Qyd(a,b,c){c=void 0===c?!1:c;if(this.yxa){var f=this.Ub.Pc(b);f.uc(11);f.Ug(11);f.Gb(2);if(c){if(b&&b.Qa(yb.a.aBg)&&!b.$a(yb.a.aBg)){var l=b.ra(rb.a.Dj,null);l&&0<l.length&&a.setAttribute("data-charcodes",l.toString());l=this.pBb(a);l=this.xjg(l,b);Aa.a.Ta(l)||a.setAttribute("data-font",l);l=b.ra(yb.a.autonumberBulletType,8);a.setAttribute("data-buAutoNum",l)}this.llc&&f.currentNode.Qa(yb.a.Uue)&&!f.currentNode.$a(yb.a.Uue)&&(f=f.currentNode.ra(ib.a.Sm,th.a.leftMargin),a.setAttribute("data-margin",
f.toString()))}}super.Qyd(a,b,c)}eig(a,b){return this.kB&&a&&b&&(Object(gc.a)(268,a)||Object(gc.a)(268,this.hB.$d)&&a.Nm)?(a=new xi.ParagraphStandardProperties,a.fontName=yf.Font.DU,a.fontColor=Vb.a.kUa,a.fontSize=jf.a.x3l,a):null}}Fn.SIl="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(m.a)(Fn,"ListMarkerUtility",Lg,[669]);class Jj{static CCk(){"GetSpecialIndentWithTabs"in Jj.GIh||(Jj.GIh.GetSpecialIndentWithTabs=!0,ya.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs",
"Invalid tab size"))}}Jj.GIh={};Object(m.a)(Jj,"SessionLogger",null,[]);class yi{constructor(a,b,c,f,l,u){this.sgd=a;this.Uaa=b;this.Uh=c;this.Ub=f;this.IK=l;this.POg=u}JMh(a,b,c,f){f=void 0===f?-1:f;let l=this.POg;0<=f&&(l=this.Aig(a,f)||l);this.gSl(a,b,c,l);this.hSl(a,b,l,f)}Aig(a,b){let c=null;(a=a.sc(b))&&a.Vd&&(c=a.Vd.Xd);return c}gSl(a,b,c,f){let l=0;this.Uh.tY(a)||(l=f.tL(this.Uaa.o$(a).hO,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=l+"px",b.style.marginRight=
"")}hSl(a,b,c,f){f=void 0===f?-1:f;var l=this.Uaa.Y_c(a).hO;a.anchor&&this.Uh.tY(a)&&0<=f?this.sgd.Dhf(a,b,Ad.a.tL(l,0),0,f):(f=c.tL(l,0),l=c.tL(this.Uaa.o$(a).hO,0),b.style.textIndent=this.yNj(f,l,this.u1i(a),this.nzj(a),c)+"px")}u1i(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}nzj(a){let b=a.ra(ib.a.Iyb,yi.OQc);if(!a.Qa(ib.a.Iyb)){const c=this.Ub.Pc(a);c.set(a);c.uc(11);c.Ug(11);(a=this.IK.BR(c,a.ra(ib.a.listLevel,th.a.dHa)))&&
(b=a.ra(ib.a.Iyb,yi.OQc))}return b}yNj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&(c=0,Jj.CCk());0<c&&(f=l.tL(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}MBi(a,b,c,f){f=void 0===f?-1:f;var l=this.POg;0<=f&&(l=this.Aig(a,f)||l);a=this.Uaa.Y_c(a).hO;l=l.tL(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}yi.OQc=1440;Object(m.a)(yi,"ParagraphViewIndentationStrategy",null,[668]);var dk=d(435),lo=d(654),sn=d(370),Ze=d(151),Jk=d(234),Wg=d(269);class tg{constructor(a,b,c){this.success=a;this.acl=
b;this.Okl=c}}Object(m.a)(tg,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var xl=d(616);class zq{constructor(){this.Jn=new W.DictionaryPropertySet}$a(a){return this.Jn.$a(a)}ra(a,b){return this.Jn.ra(a,b)}Qa(a){return this.Jn.Qa(a)}get propertySet(){return this.Jn.clone()}get tM(){return this.Jn.ra(rb.a.font,yf.Font.DU)}get EW(){return this.Jn.ra(ib.a.EW,-1)}get fieldInstruction(){return this.Jn.ra(ib.a.fieldInstruction,"")}get Iva(){return this.Jn.Qa(rb.a.fontSize)}get fontSize(){return this.Jn.ra(rb.a.fontSize,
yf.Font.OJ)}get y5(){return this.Jn.Qa(rb.a.fontColor)}get fontColor(){return this.Jn.ra(rb.a.fontColor,Vb.a.nil)}get pug(){return this.Jn.Qa(xl.a.R5b)}get Vdg(){return this.Jn.ra(xl.a.R5b,1)}get RWa(){return this.Jn.Qa(rb.a.highlight)}get highlight(){return this.Jn.ra(rb.a.highlight,Vb.a.nil)}get zdb(){return this.Jn.Qa(ye.a.tQ)}get tQ(){return this.Jn.ra(ye.a.tQ,Vb.a.nil)}get rug(){return this.Jn.Qa(rb.a.pu)}get language(){return this.Jn.ra(rb.a.pu,0)}get LWa(){return this.Jn.Qa(rb.a.bold)}get isBold(){return this.Jn.ra(rb.a.bold,
!1)}get wdb(){return this.Jn.Qa(rb.a.italic)}get isItalic(){return this.Jn.ra(rb.a.italic,!1)}get xCb(){return this.Jn.Qa(rb.a.underline)}get VD(){return this.Jn.ra(rb.a.underline,!1)}get K3c(){return this.Jn.Qa(rb.a.Yw)}get Yw(){return this.Jn.ra(rb.a.Yw,yf.Font.JW)}get wCb(){return this.Jn.Qa(rb.a.strikethrough)}get zC(){return this.Jn.ra(rb.a.strikethrough,!1)}get zcc(){return this.Jn.Qa(ye.a.hu)}get qY(){return this.Jn.ra(ye.a.hu,!1)}get isSuperscript(){return this.Jn.ra(rb.a.superscript,!1)}get nF(){return this.Jn.ra(rb.a.subscript,
!1)}get SH(){return this.Jn.ra(ib.a.SH,null)}get ou(){return this.Jn.ra(rb.a.ou,!1)}get n1(){return this.Jn.ra(rb.a.n1,!1)}get Hn(){return this.Jn.ra(rb.a.Hn,!1)}get qeb(){return this.Jn.ra(ib.a.qeb,!1)}get WXa(){return this.Jn.ra(Oe.a.Rya,!1)}get MWa(){return this.Jn.Qa(ye.a.capitalization)}get capitalization(){return this.Jn.ra(ye.a.capitalization,0)}get uHa(){return this.Jn.ra(ib.a.uHa,!1)}Gq(a,b){b.Qa(a)&&this.Jn.setValue(a,b.$h(a))}static nQc(a){const b=new zq;b.Jn.setValue(rb.a.fontSize,jf.a.u3l);
b.Gq(rb.a.superscript,a.propertySet);b.Gq(rb.a.subscript,a.propertySet);a.ou&&b.Jn.setValue(rb.a.underline,!0);return b}}Object(m.a)(zq,"PptSmartArtFormattingCache",null,[216]);class $n{constructor(a,b,c,f){this.fIi=a;this.iIi=b;this.gIi=c;this.hIi=f}}Object(m.a)($n,"SelectionImageProperty",null,[]);var yl=d(150),Hf=d(69);class xj{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f){this.wJa=this.KTg=this.JTg=!1;if(!vf)throw Error.argumentNull("graphTopologyManager");
this.hB=a;this.Ga=b;this.nc=c;this.WGk=f;this.Fp=l;this.iE=u;this.cnc=I;this.qz=T;this.jA=ja;this.WY=ua;this.sa=vf;this.ohb=Ra;this.nfd=eb;this.gIb=Bb&&!hd;this.g_a=Ub;this.n_a=Xb;this.pIb=tc;this.Nkc=lc;this.mld=Ec&&!hd;this.kB=yd;this.qoa=Pd;this.ofd=pe;this.$Lk=Se;this.sa=vf;this.SLk=ug;this.vjc=Tg;this.wJa=$f}ocb(a,b){if(b.ra(yb.a.MHa,!1))return jf.a.zjh;b=this.Ga.lGa(this.Ga.Gn(b));return qf.a.cA(b,1)?a:2*Math.round(a*b/2)}jPf(a,b){if(!a)return b;const c=xj.yjg(a);if(a===c)return b;md.a("PPTO.TextRendering.UpdateFontFamilyWithWebFontFallback")&&
(this.qz&&this.qz.Sik?(()=>{let f=xj.nEd(a,this.qz.igc(a),b);({n$b:b}=f);return f})().returnValue||(()=>{let f=xj.nEd(c,this.qz.tfk(c),b);({n$b:b}=f);return f})().returnValue:(()=>{let f=xj.nEd(c,!0,b);({n$b:b}=f);return f})().returnValue&&(()=>{let f=xj.nEd(a,!0,b);({n$b:b}=f);return f})().returnValue);return b}NLj(a){if(!this.SLk||Aa.a.Ta(a))return null;const b=this.sa.presentation.Kee;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}zjg(a,b,c){return c.aua(this.ocb(a,
b))}ahg(a,b){return a.Qa(yb.a.rxb)?b.Qba(a.$a(yb.a.rxb)/dk.a.ltc,0)+"px":null}Hkg(a){if(a.Qa(yb.a.mFb)){const b=a.$a(yb.a.mFb)/dk.a.ltc;a=a.fontSize;return 0<b&&a*dk.a.Fdb>=b?"normal":"none"}return null}Khe(a,b,c,f){let l=null;this.ohb?l=Vb.a.WH(0):!c&&f||!b.y5?this.gIb&&f&&(l=U.a.instance.ga(119)?b.ra(yb.a.bXa,!1)?this.bkg(a):Vb.a.WH(b.fontColor):this.bkg(a)):(a=b.fontColor,l=a===Vb.a.auto?"WindowText":Vb.a.WH(a));return l}KQh(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.nfd||a.isSuperscript||a.nF)}tpg(a){return a.Qa(yb.a.zO)?
a.$a(yb.a.zO)/1E3:0}gle(){return 2/3}bkg(a){let b=null;var c=Object.assign(new lo.a,{schemeClrField:Object.assign(new sn.a,{valField:10})});a=Object(gb.a)(267,this.nc.ug(a));(c=this.WGk.ZI(c,a?a.Ld:null))&&(b=Ze.Box4ColorHelper.Xia(c).GW());return b}oQh(a,b){return this.gIb||a||!b}SQh(){return!0}qQh(){return this.gIb}Ukm(a,b,c,f){if(!c||!c.Ua||!f||1>f.length)return b;let l=0,u=0;for(let I=0;I<f.length;I++){if(c.Ua.Ra>=u&&c.Ua.Ra<u+f[I]||c.Ua.Ra===u+f[I]&&f[I]>b.Lines[I]){l=I;break}u+=f[I]}c=0;for(const I of b.Lines)c+=
I;a=a.Sa.ga(a.Sa.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}mWf(a,b){a=Object(gb.a)(Vg.AParagraphNode,a);if(!a||!a.Sa)return!1;let c=0;for(const f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}XZh(a,b,c,f,l,u,I,T){if(!(this.g_a&&a&&c&&c.length&&b))return!1;var ja=this.Ga.Gn(f);if(!ja)return!1;const ua=this.n_a&&ja.lHb;ja=this.wJa&&ja.lKb;if(!b.Wp&&!ua&&!ja)return!1;f=Object(gb.a)(Vg.AParagraphNode,
f);if(!f||!f.Sa||!ua&&!ja&&this.cnc.Eab(f))return!1;c=this.ayj(c,f,!b.Wp);if(this.Uaj(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.Fp||this.Fp.qwa)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.pIb?this.Ucm(f,a,b,l,u,I,T):this.Scm(a,b,c)}RBc(a){this.wJa&&a&&this.vjc&&(a=this.Ga.Gn(a),this.vjc.Wbf(a))}X3h(a){this.n_a&&a&&(a=this.Ga.Gn(a))&&a.lHb&&(ya.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),
a.fqb(!1))}qEj(a,b){const c=yl.a.Fi(a,yb.a.oTb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Sa.length)return ya.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Sa.ga(a.Sa.length-1).cp+1!==b)return null}return c}Scm(a,b,c){if(!c)return!1;const f=new La.a;for(const l of c){c=b.Tp(va.a.span);Sys.UI.DomElement.addCssClass(c,fc.a.DY);f.add(c);let u=!1;for(let I=0;I<l;I++)if(a.firstChild)c.appendChild(a.firstChild);
else{ya.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");u=!0;break}if(u)break}b=Object(gb.a)(214,this.iE.aK(a));if(!b)return ya.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(const l of f)b.rp(l),a.appendChild(l);return!0}Ucm(a,b,c,f,l,u,I){if(!b||!c)return!1;let T=yl.a.Fi(a,yb.a.oTb,null);if(!T||!T.Lines||!T.Lines.length)return!1;for(this.$Lk&&(T=this.Ukm(a,T,u,I));l.count>f;)l.removeAt(f);a=new La.a;I=u=f=
null;for(let ja=0;ja<T.Lines.length;ja++){f=c.Tp(va.a.span);Sys.UI.DomElement.addCssClass(f,fc.a.DY);a.add(f);const ua=this.nwi(T.Lines[ja],b,f,u,I,l);u=ua.acl;I=ua.Okl;this.iEk(ja,T.Lines.length,f.lastChild);if(!ua.success){ya.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");break}}for(this.ZNc(u,f,l);b.firstChild;)this.ZNc(b.firstChild,f,l);return this.Tcm(b,a)}iEk(a,b,c){xj.MTg||(eg.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",
0,"pptotext",null),xj.MTg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!xj.LTg&&!a&&b&&c&&(eg.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),xj.LTg=!0))}nwi(a,b,c,f,l,u){let I=!0;for(;0<a;){if(!(f&&f.innerText.length||b.firstChild)){ya.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");I=!1;break}let T;f?
(l=T=f,f=null):(T=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(T,fc.a.OO)&&(l.style.lineHeight=T.style.lineHeight),l=null);const ja=T.innerText.length;a>=ja?(this.ZNc(T,c,u),a-=ja):(f=T.cloneNode(!1),this.G4l(T,f,a),this.ZNc(T,c,u),a-=T.innerText.length)}return new tg(I,f,l)}G4l(a,b,c){a=a.childNodes;let f=-1;for(let l=0;l<a.length;l++){const u=a[l];if(c)if(c>=u.innerText.length)c-=u.innerText.length;else{const I=u.cloneNode(!0);I.innerText=u.innerText.substring(c,u.innerText.length+1);b.appendChild(I);
u.innerText=u.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}ZNc(a,b,c){if(a&&b&&c){b.appendChild(a);a=za.a.zcb(a);for(const f of a)c.add(f),ca.a.Uw(f,"leafEltIdx",c.count-1)}}Tcm(a,b){const c=Object(gb.a)(214,this.iE.aK(a));if(!c)return ya.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(const f of b)c.rp(f),a.appendChild(f);return!0}ayj(a,b,c){const f=this.A0i(this.qEj(b,c));if(!f||!f.length)return null;
c=f.length;const l=Array(c);let u=0,I=1;for(let T=0;T<b.Sa.length;T++)I<c&&b.Sa.ga(T).cp===f[I]&&(l[u]=a[T],u++,I++);l[c-1]=a[a.length-1];if(I!==c)return ya.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}A0i(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}Uaj(a,b){if(!b)return!1;a=a.childNodes;let c=0;
for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],fc.a.AO)||Sys.UI.DomElement.containsCssClass(a[l],fc.a.ebe)||(b=!1);if(b)return!0;c+=f}return!1}aig(a,b,c){const f=new Cc.a;if(!a||!b||!c)return ya.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":"null",c?"not null":"null"),f;this.MWl(a,b)&&(a=null,c.Qa(yb.a.schemeColor)&&(a=c.$a(yb.a.schemeColor),a=this.JGj(b,a)),
Aa.a.Ta(a)||f.$("data-scheme-color",a),this.ofd&&c.Qa(yb.a.I6c)&&(c.$a(yb.a.I6c)?f.$("data-usefontface","false"):f.$("data-usefontface","true")),md.a("HyperlinkColorBugFix")&&c.Qa(yb.a.bXa)&&(c.$a(yb.a.bXa)||f.$("data-hyperlinkhascustomcolor","true")));return f}JGj(a,b){if(Aa.a.Ta(b))return"";const c=Wg.SchemeColor.parse(b);if(c&&c.color&&!c.Hva){a=Object(gb.a)(267,this.nc.ug(a));a=c.resolve(a?a.Ld:null);if(!a)return"";c.kR=Jk.g(a.N2a);return c.toString()}return b}MWl(a,b){return this.Nkc&&a.Nm&&
xj.ork(b)}eZf(a){if(this.mld){a=a.querySelectorAll("."+xj.T8d);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.DDl(a[b]);for(b=0;b<c;++b)Hf.a.ebk(a[b],f[b].fIi,f[b].iIi,f[b].gIi,f[b].hIi)}}BDl(a){return new $n("linear-gradient(to right, "+Hf.a.mSc+", "+Hf.a.mSc+")",Hf.a.hcf,"0px "+a.style.verticalAlign,Hf.a.MBd)}Ldk(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,fc.a.M9))return!1;a=a.nextSibling}return!0}CDl(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+
fc.a.M9);for(let u=0;u<l.length;u++){const I=l[u];f+=this.yAj(I);b=Math.min(b,I.offsetLeft);c=Math.max(c,I.offsetLeft+I.offsetWidth)}return new $n("linear-gradient(to right, "+Hf.a.mSc+", "+Hf.a.mSc+")",0<c-a.offsetLeft?f+"px 100%":Hf.a.hcf,b-a.offsetLeft+"px "+a.style.verticalAlign,Hf.a.MBd)}DDl(a){return this.Ldk(a)?this.BDl(a):this.CDl(a)}yAj(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}dig(a,b,c){return this.kB&&a&&b&&c&&(Object(gc.a)(268,a)||Object(gc.a)(268,
this.hB.$d)&&a.Nm)?zq.nQc(b):null}OQh(){return!1}mac(a){let b=a.ra(yb.a.latinFont,yf.Font.DU);b.startsWith("+")&&(b=a.ra(rb.a.font,yf.Font.DU));let c=new La.a;c.add(b);var f=[yb.a.eastAsianFont,yb.a.complexScriptFont,yb.a.aTb];for(var l of f)a.Qa(l)&&(f=a.$a(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.NLj(b))l=new La.a,l.add(b),md.a("UseServerFallbackFontFirst")?l.insert(0,a):l.add(a),this.ODk(a,c),c=l;return c.toArray().join(",")}ODk(a,b){this.JTg||Ca.FontUtils.isMissingFont(b.ga(0))?
this.KTg||b.contains(a)||(ya.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.KTg=!0):(ya.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.JTg=!0)}g_e(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.qz&&this.qz.isEnabled;const f=!!this.jA&&this.jA.isEnabled;if(f||c||this.qoa)b=Ca.FontUtils.uvb(b,a,c,this.qoa,f);f&&this.jA.createFontUrl(a);c&&(a?(c=xj.yjg(a),this.qz.createFontUrl(a),c&&this.qz.createFontUrl(c)):
this.qz.createFontUrl(a));this.qoa&&this.WY.createFontUrl(a);return b}Axh(a,b){return a?this.g_e(a.fontName,b):b}W6c(){return this.qoa}static X_c(a){if(Aa.a.Ta(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static yjg(a){if(Aa.a.Ta(a))return null;a=xj.X_c(a);let b=a.toLowerCase();for(;b;){let f=!1;b=b.trim();for(const l of xj.mqj){var c=l;b.endsWith("\u200b")&&(c+="\u200b");b.endsWith(c)&&(f=!0,c=b.lastIndexOf(c),b=b.substring(0,c+1))}if(!f)break}return a.substring(0,
b.length)}static nEd(a,b,c){return a&&b?(c=Ca.FontUtils.eui(xj.X_c(a),c),{returnValue:!0,n$b:c}):{returnValue:!1,n$b:c}}static ork(a){return a.ra(yb.a.MHa,!1)?!1:!0}}xj.T8d="Selection";xj.B2f="SelectionShadow";xj.mqj=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");xj.MTg=!1;xj.LTg=!1;Object(m.a)(xj,"TextRenderingStrategy",null,[128]);class Gn{constructor(){this.ECb=[]}q2e(a){a&&!Array.contains(this.ECb,a)&&(a.d1=this,Array.add(this.ECb,
a))}prc(a,b){for(let c=0;c<this.ECb.length;c++){const f=this.ECb[c];f.FCb&&f.prc(a,b)}}}Object(m.a)(Gn,"AHighlightManager",null,[125]);class rp extends Gn{constructor(){super();this.e_g=this.Uic=null}get Dla(){return this.Uic}get zfb(){return this.e_g}yyd(a){if(a&&((this.Uic=a)&&0===this.Uic.action&&(this.e_g=this.Uic),a.Ffa||a.Klb)){var b=[];for(let c=0;c<this.ECb.length;c++){const f=this.ECb[c];f.FCb&&Array.addRange(b,f.zZh(a.Ffa,a.Klb))}}}}Object(m.a)(rp,"HighlightManager",Gn,[]);class Wd{constructor(a,
b){this.Oxa=a;this.wjc=b;this.Oxa.Ak(Object(R.a)(this,this.ph,"onPropertyChanged"))}dispose(){this.Oxa.tn(Object(R.a)(this,this.ph,"onPropertyChanged"))}ph(a,b){a=b.node;b.property.id===yb.a.oTb.id&&a.isConnected&&!this.wjc.isComposing&&a.anchor.Zr(208)}}Object(m.a)(Wd,"ParagraphNodeViewBehavior",null,[106]);class Gi{constructor(a){this.wjc=a}HQh(a){if(a=Object(gb.a)(5,a)){if(this.wjc.isComposing){if(!a.j9c)return ya.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),
!0;ya.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.j9c=!1}return!1}}Object(m.a)(Gi,"ParagraphViewElementCEVSetUpdateStrategy",null,[666]);class lf{constructor(a){this.qhd=[yb.a.EY,yb.a.Ay,yb.a.gga,yb.a.Cna,yb.a.fga,yb.a.Bna,ib.a.Sm,ib.a.VZ,ib.a.Qn,ib.a.MMb,ib.a.listLevel,rb.a.tm,rb.a.xK];this.Zki=a.Jwe;this.y7c=a.y7c;this.Yki=a.pptCopyPasteMarginAndIndentationEnabled}get krd(){return this.Zki}get V0i(){return!1}get zth(){return this.Yki}get Ncl(){return this.qhd}TYl(a){return!!a.tagName&&
"p"===Aa.a.Dg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,fc.a.Sha)}wva(a){const b={};for(const c of this.qhd)b[c.id.toString()]=a.$h(c);return b}Sqa(a,b){if(b){const c=$a.ParagraphReader.tY(a);this.CSl(a,b,this.qhd,this.iEg(a),c);a.setValue(Oe.a.xfc,!0)}}iEg(a){let b=!1;(a=mb.GraphIterator.ob(a).parentNode)&&ge.OutlineElementReader.U$(a)&&(b=Kc.ListReader.PXa(a));return b}JXk(a,b,c,f){this.zth||(f=!0);if(this.krd){const l=a.ra(Oe.a.xfc,!1),u=b.ra(Oe.a.xfc,!1),I=l||!f&&!u&&!l?b:a;this.Z0i(I,
l||!f&&!u&&!l?a:b,this.qhd,this.iEg(I),c)}}xPj(a){return this.zth&&a?$a.ParagraphReader.tY(a)&&a.Qa(yb.a.Tue)&&!a.$a(yb.a.Tue)&&a.Qa(ib.a.Qn)?a.$a(ib.a.Qn).toString():"":""}CSl(a,b,c,f,l){for(const u of c)this.FQh(u,f,l)||(c=b[u.id.toString()],void 0!==c?a.setValue(u,c):a.removeProperty(u))}Z0i(a,b,c,f,l){for(const u of c)this.FQh(u,f,l)||(c=b.$h(u),void 0!==c?a.He(u,c):a.removeProperty(u))}FQh(a,b,c){return this.y7c&&!b&&c&&(a===ib.a.Sm||a===ib.a.Qn)}}Object(m.a)(lf,"PptFormattingPropertyTransitStrategy",
null,[667]);class zl{}zl.N0h="UnderlineColor";zl.xEd="UnderlinePositionInEm";zl.yEd="UnderlineThicknessInEm";zl.NYc="FontSizePx";Object(m.a)(zl,"ParagraphViewElementProperties",null,[]);class Vo extends nc{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se){super(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc);this.Chc=lc;this.aZg=Ec;this.CWg=hd&&!Pd;this.mld=yd&&!Pd;this.bZg=pe;this.Qjd=Se}I_d(a,b){this.Chc?a.style&&!Aa.a.Ta(a.style.verticalAlign)&&(Aa.a.Ta(b.style.verticalAlign)?
(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.WBi(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.I_d(a,b)}WBi(a){if(null!==a.style&&!Aa.a.Ta(a.style.verticalAlign)){if(this.aZg&&this.Pjk(a)){const b=a.style.backgroundColor;a.style.backgroundColor=null;Hf.a.SNf(a,String.format("linear-gradient(to right, {0}, {0})",b),Hf.a.hcf,String.format("0px {0}",a.style.verticalAlign),Hf.a.MBd)}if(this.mld||
this.aZg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}khe(a){return this.Chc?"0px":super.khe(a)}VMf(a){a.style.position=Hf.a.Dzc}Pjk(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&a.style.backgroundColor!==Hf.a.cWi}V3e(a,b,c,f){if(this.CWg&&b.ou){if(b.zC||b.qY)a.style.textDecoration=Hf.a.E6l,f[f.length]="Strikethrough";b.VD&&(f[f.length]="Underlined");
let l,u;this.Qjd&&(()=>{let I=this.HQj(b.tM);({xEd:l,yEd:u}=I);return I})().returnValue?(ca.a.Uw(a,zl.N0h,this.GQj(c,b)),ca.a.Uw(a,zl.xEd,l),ca.a.Uw(a,zl.yEd,u)):Aa.a.Ta(a.style.textDecoration)?a.style.textDecoration=Hf.a.sVh:a.style.textDecoration+=" "+Hf.a.sVh}else super.V3e(a,b,c,f)}GQj(a,b){a=this.jw.Khe(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",a)}HQj(a){return{returnValue:"Calibri"===a,xEd:1.1133,yEd:.0654}}Dfk(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,
fc.a.M9))return!0;a=a.nextSibling}return!1}UMf(a,b){this.mld&&(Sys.UI.DomElement.containsCssClass(b,fc.a.M9)||this.Dfk(a,fc.a.M9)?(Sys.UI.DomElement.addCssClass(a,xj.T8d),this.bZg&&E.a.Fk&&Sys.UI.DomElement.addCssClass(a,xj.B2f)):(Sys.UI.DomElement.removeCssClass(a,xj.T8d),this.bZg&&E.a.Fk&&Sys.UI.DomElement.removeCssClass(a,xj.B2f)));if(this.CWg&&Sys.UI.DomElement.containsCssClass(a.parentNode,fc.a.gwg)){const c=ca.a.Ie(a,zl.N0h),f=ca.a.Ie(a,zl.yEd);let l=ca.a.Ie(a,zl.xEd);if(c&&f&&l){if(!Aa.a.Ta(a.style.fontSize)&&
a.style.fontSize.endsWith("px")&&!Aa.a.Ta(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const u=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(u)||(l-=u/a)}Hf.a.SNf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),Hf.a.MBd);b.style.textDecoration=Hf.a.F6l}}}}Object(m.a)(Vo,"PptParagraphContentRenderer",nc,[]);class Je{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}fc(a){this.K=a;this.s2e();this.z2e();this.mxl();
this.v2e();this.uxl();this.vxl();this.lxl()}init(){this.K.register(125,"Box4.Highlight.IHighlightManager").ma().na(()=>new rp);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new Cm.a((a,b)=>new X(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),new zc.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Nm&&A.AFrameworkApplication.fa.getBooleanAppSetting("SkipUpdateContentEditableViewWhenComposing")?
this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new Cm.a((a,
b)=>new Ia(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}s2e(){this.K.register(126,"PowerPointWebEditor.IListMarkerOffsetCache").ma().na(()=>new Uc);this.K.register(127,"Box4.IListMarkerUtility").ma().na(()=>new Fn(this.K.resolve("Box4.List.IListReader"),
this.K.resolve("Box4.IParagraphIndentationReader"),jd.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),
this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Teb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}z2e(){this.K.register(128,
"Box4.ITextRenderingStrategy").ma().na(()=>new xj(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.ub("Box4.CloudFontService"),this.K.ub("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").dAg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").DEg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").AEg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Teb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pTb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").MXh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").r8c,this.K.resolve("PowerPointWebEditor.IApplicationSettings").CEg,
this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").c$l,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").GNl,
A.AFrameworkApplication.fa.getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")?this.K.resolve("PowerPointWebEditor.EditSurfaceLayoutManager"):null,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Cbb))}mxl(){this.K.register(Ao,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(Gi,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().na(()=>new Gi(this.K.resolve("Box4.IEditingView")))}v2e(){this.K.register(yi,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().na(()=>
new yi(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new fb.a))}uxl(){this.K.register(lf,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().na(()=>new lf(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}vxl(){this.K.register(Vo,
"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>new Vo(Ha.InteractiveViewManager.instance,Ta.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.ub("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),
this.K.ub("Box4.IFeatureHelper"),Ca.FontUtils.a0i,this.K.ub("Box4.IFontSlotProvider"),Object(R.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").szh,"raiseParagraphContentUpdatedEvent"),Od.a.language,this.K.ub("Box4.ITableOfContentRenderHelper"),xd.a.WRf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").DEg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").AEg,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").CEg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").BXl))}lxl(){this.K.register(Wd,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().na(()=>new Wd(this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("Box4.IEditingView")))}static main(){C.a.instance.Ac(new Je)}}
Object(m.a)(Je,"PPTWebEditorParagraphPackage",null,[2,3]);var sp=d(504),ri=d(636);class Gh extends Sys.EventArgs{constructor(a){super();this.xl=a}}Object(m.a)(Gh,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class Bo{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.LLe=this.Uxa=null;this.Pe=a;this.Ms=b;this.fe=c;this.rc=f;this.ka=l;this.fpc=u;this.Jhd=I;this.um=T;this.Sg=ja;this.$ga=ua;this.oa=Ra;this.uf=eb;this.sa=Bb;this.ia=Ub;this.zb=Xb;this.zga=tc;this.Hp=Ec;this.$D=hd;I.h_d(Object(R.a)(this,
this.qMb,"onPodSessionUnavailable"));I.xvb(Object(R.a)(this,this.Jha,"onPodSessionRefreshed"));lc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.DMe=new ne.a(4,2,2E3,Object(R.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.ka.Mg}get Dfc(){return!!this.Uxa}sIj(a,b){const c=$c.a.Zj("GetPodSessionInfo");try{const f=this.Pe.podSessionId,l=kh.a.create().toString(),u=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.ka.podsWebServiceBase),
I={};I.PodSID=f;I["X-UserSessionId"]=this.fpc();I["X-CorrelationID"]=l;c.Wa("PodSessionId",f);c.Wa("Cid",l);this.Ms.jU(u,2,null,I,[Gg.a.w7],0,T=>{try{if(f!==this.Pe.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Pe.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var ja=!0;if(T.data){if(c.Wa("HttpStatus",T.data.Ke.toString()),c.Wa("RequestStatus",sp.a[T.data.status]),T.data.gk){const ua=T.data.gk[Gg.a.w7];ua&&"errorCannotFindSession"===ua&&
(c.Wa("ErrorCode",ua),ja=!1)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");ja?(c.Wa("Result","Succeeded"),c.finish(),a&&a()):(c.Wa("Result","Failed"),c.finish(!0),b&&b())}}catch(ua){ya.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ua),b&&b()}},T=>{try{if(f!==this.Pe.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Pe.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{if(T.data){if(c.Wa("HttpStatus",
T.data.Ke.toString()),c.Wa("RequestStatus",sp.a[T.data.status]),T.data.gk){const ja=T.data.gk[Gg.a.w7];ja&&c.Wa("ErrorCode",ja)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");c.Wa("Result","Failed");c.finish(!0);b&&b()}}catch(ja){ya.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ja),b&&b()}},null,void 0,void 0,this.ka.uIj,this.ka.vIj,"GetPodSessionInfo",void 0,!0)}catch(f){ya.a.J(512496141,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",
f),c.Wa("Result","Failed"),c.finish(!0),b&&b()}}qMb(a,b){a=!1;this.Uxa?ya.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Pe.presentationId.string,this.um.J5,this.Sg.jH,this.Pe.xl,this.Pe.podSessionId,!this.rc.fp,$c.a.Ef(this.Uxa),!!this.Hp.instance,
b.DXc):(this.Uxa=new Date,a=!0,ya.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Pe.presentationId.string,this.um.J5,this.Sg.jH,this.Pe.xl,this.Pe.podSessionId,!this.rc.fp,$c.a.Ef(this.Uxa),!!this.Hp.instance,b.DXc));this.zga.instance&&this.zga.instance.P7c?
ya.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Pe.xl,this.Pe.podSessionId):this.um.J5&&this.ka.podsSeamlessFailoverEnabled&&this.Hp.instance?this.Hp.instance.Aff(b.DXc,4,b.errorCode):(this.fe.Rma=!1,this.um.J5?this.Sg.jH?(a&&this.zb.Jb(this.DMe),this.$ga.d1c(this.Pe.presentationId.string,this.Pe.xl,this.Pe.podSessionId,b.DXc,c=>{this.uHl(c,this.Pe.xl)},c=>{this.tHl(c,
this.Pe.xl)}),this.oa.setSelection(null),this.uf.blockContent(this.sa.presentation,"OnPodSessionUnavailable",!0),ya.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.HXj():ya.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Pe.podSessionId))}HXj(){this.LLe||(this.LLe=new Date);const a=+new Date-+this.LLe;a>this.ka.podsNullSrmWaitTimeInMs?(ya.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",
a,this.Pe.podSessionId),A.AFrameworkApplication.Lp(jg.a.hi(305)),eg.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.Ia(M.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):ya.a.J(512496134,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",this.ka.podsNullSrmWaitTimeInMs,a,this.Pe.podSessionId)}detectFailoverTimeout(){if(this.Uxa){var a=
+new Date-+this.Uxa;a>this.ka.podsFailoverBrowserWaitTimeoutInMs&&(this.zb.Vg(this.DMe),ya.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Pe.podSessionId,this.Pe.xl),a=Object.assign(new vl.a,{Code:293,Source:6}),this.fe.At(a,this.Pe.podSessionId,b=>{b.yD=1;b.GEa=8;return!1}))}}uHl(a,b){a&&(this.Pe.xl!==b?ya.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",
this.Pe.xl,b,this.Pe.podSessionId):(b=a.result)?(ya.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Pe.podSessionId,b.DocumentSessionID),this.Pe.podSessionId!==b.DocumentSessionID&&(a=this.Pe.podSessionId,this.Pe.podSessionId=b.DocumentSessionID,this.Jhd.vzh(new ri.a(a,b.DocumentSessionID)))):ya.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Pe.podSessionId,
this.Pe.xl))}tHl(a,b){if(this.Pe.xl!==b)ya.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Pe.xl,b,this.Pe.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=jg.a.MJ(a.error.Bn),c=a.error.Bn);ya.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",
this.Pe.presentationId.string,this.Pe.xl,this.Pe.podSessionId,"",$c.a.Ef(new Date),c,b);c===jg.a.hi(241)&&(this.Sg.jH=!1,this.$D.j1e(new Gh(this.Sg.dga)))}}Jha(a,b){$c.a.zFb=new Date;$c.a.$Cd=[];this.Pe.podSessionId!==b.HZ?ya.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",this.Pe.podSessionId,b.HZ,this.Pe.xl):(this.zb.Vg(this.DMe),ya.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",
this.Pe.presentationId.string,this.Pe.xl,b.ZLb,b.HZ,$c.a.Ef(this.Uxa||new Date),$c.a.Ef(new Date)),this.fe.Rma=!1,this.ka.podsSeamlessFailoverEnabled&&this.Hp.instance?ya.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.HZ,this.ia.Ia(M.a.dPb,2,a)),this.Uxa=null)}mo(){this.Uxa=null}}Object(m.a)(Bo,"PodSessionManager",null,[117]);var mh;(function(a){a[a.active=
0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.Rum=3]="frozen"})(mh||(mh={}));Object(m.b)("AppVisibilityState",mh);class ao{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(m.a)(ao,"GetHostSessionInfoParams",null,[]);class Al{constructor(a,b,c,f,l,u,I,T,ja,ua){this.$id=0;this.NJa=this.xoa=this.ANe=null;this.Lah=0;this.hQe=!1;this.Xa=b;this.Ymc=a;this.Sg=c;this.ka=f;this.zga=l;this.vS=u;this.Loa=I;this.rc=T;this.jZ=ja;this.cLa=ua;this.CGb=0;this.oJb=
this.ka.getHostSessionInfoRequestTimeoutInMs;this.sOk=this.ka.getHostSessionInfoRequestMaxTimeoutInMs;this.yOk=this.ka.getHostSessionInfoPingIntervalForFailedResponseInMs;this.eHk=f.maxPopsRehydrationCount;this.uJb=this.ka.Quh;this.tJb=this.ka.podsPopSessionDisconnectedTimeLimitInMS;this.Tna=!1;this.DIb=this.Xa.xl;this.KZg="";this.Tvd();this.iNa(0,!0)}Tvd(){this.$id=0;this.NJa=new Date}kPi(a){if(this.ena&&!A.AFrameworkApplication.Dh&&this.rc.OM){var b=!1;this.cLa&&this.cLa.instance&&(b=2===this.cLa.instance.J9a,
this.hQe||(this.hQe=!0,this.cLa.instance.uOc(Object(R.a)(this,this.t5h,"visiblityChanged"))));var c=Object.assign(new ao,{PopSessionID:this.Xa.xl,PresentationID:this.Xa.presentationId.string,IsTabHidden:b});this.ANe=new Date;b=Math.min(this.oJb+2E3*this.$id,this.sOk);var f=Qa.a.iJ("RequestTimeout",b.toString());this.Ymc.o0c(c,()=>{this.J5k(c.PopSessionID,a)},l=>{this.I5k(l,c.PopSessionID,a)},null,f,this.ka.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.rc.OM&&(ya.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",
this.ena,A.AFrameworkApplication.Dh,!!this.zga.instance&&this.zga.instance.P7c,!this.rc.fp),this.close(this.ena?this.rc.OM?"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}iNa(a,b){this.xoa=new Date;this.Lah=window.setTimeout(()=>{this.kPi(b)},a)}Kkm(a){ya.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.ANe);this.Tvd();this.CGb=0;this.Sg.vze=this.NJa;this.Sg.uze=a}J5k(a,b){this.jZ.bwc();this.vS.Wag(a,
"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.iNa(0,b):(this.Kkm(a),b&&this.iNa(this.ka.getHostSessionInfoPingIntervalInMs,!0))}t5h(a,b){ya.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",mh[b.oldState],mh[b.newState]);this.iNa(0,!1)}XPi(){return this.Loa.Dfc||!this.ena?(ya.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Loa.Dfc,this.ena,$c.a.Ef(new Date)),
!1):this.CGb>this.eHk?(ya.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",this.CGb,this.ka.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.vS.Tme(jg.a.hi(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}hia(a){this.XPi()&&(++this.CGb,this.vS.hia(a),this.Tvd())}DYl(a){if(jg.a.hV(a))switch(jg.a.MJ(a)){case 326:case 240:case 103:return!0;
case 329:return this.ka.jyl}return!1}LAj(a){if(jg.a.hV(a))switch(jg.a.MJ(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}I5k(a,b,c){a.c_&&200===a.c_.Ke&&this.jZ.bwc();if(this.vS.Wag(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.iNa(0,c);else{++this.$id;var f=+new Date-+this.NJa,l=44,u=-1;a&&a.error&&(l=jg.a.hV(a.error.Bn)?jg.a.MJ(a.error.Bn):44,u=a.error.Bn);a=Qa.a.iJ("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",
u,"TimeTakenInMs",+new Date-+this.ANe,"RetryCount",this.$id,"PopSessionDisconnectedTimeLimitInMS",this.tJb,"PopsIdleTimeLimitInMS",this.uJb,"Now",$c.a.Ef(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",this.CGb,"LastPingScheduledTime",$c.a.Ef(this.xoa),"LastSuccessfulEnsureHostSessionId",this.Sg.tze);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(I){ya.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",
I)}ya.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.xoa>this.tJb?this.iNa(0,c):this.DYl(u)?this.hia(this.LAj(u),u):u===jg.a.hi(370)?f<this.uJb?this.iNa(this.ka.getHostSessionInfoPingIntervalInMs,c):this.hia(11,u):f>=this.tJb?this.hia(3,u):this.iNa(this.yOk,c)}}MAe(a){const b=Qa.a.iJ("LastUsedPopSessionId",this.DIb,"LastClientClosedReason",this.KZg,"IsClientActive",this.ena,"AppInEditingMode",this.rc.fp,"PopSessionDisconnectedTimeLimitInMS",
this.tJb,"PopsIdleTimeLimitInMS",this.uJb,"Now",$c.a.Ef(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.CGb,"LastPingScheduledTime",$c.a.Ef(this.xoa),"LastSuccessfulEnsureHostSessionId",this.Sg.tze);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){ya.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}ya.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}hmb(a){ya.a.J(36282957,
801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.xl,this.DIb,this.ena);this.ena&&this.DIb===this.Xa.xl||(this.DIb=this.Xa.xl,this.Tvd(),this.Tna?(this.Tna=!1,this.iNa(0,!0)):ya.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.xl,this.DIb,this.ena))}close(a){this.Tna||
(ya.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Xa.xl,$c.a.Ef(new Date),a),this.hQe&&this.cLa&&this.cLa.instance&&this.cLa.instance.YBl(Object(R.a)(this,this.t5h,"visiblityChanged")),this.Tna=!0,this.DIb="",this.KZg=a,window.clearTimeout(this.Lah))}get ena(){return!this.Tna}}Object(m.a)(Al,"HostSessionInfoCaller",null,[]);class mo{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.Vxa=null;this.Ymc=a;this.Xa=b;this.Nc=c;this.Sg=f;this.ka=l;this.zga=u;this.vS=
I;this.Loa=T;this.rc=ja;this.jZ=Ra;this.cLa=eb;this.Nc.i_d(Object(R.a)(this,this.Lkb,"onPopSessionClosed"));this.Nc.aC(Object(R.a)(this,this.gza,"onSessionEnded"));this.Nc.j_d(Object(R.a)(this,this.j1a,"onPopSessionInitialized"))}t$j(){ya.a.J(509150673,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Sg.jH&&this.Hoh()}j1a(){this.Hoh()}Hoh(){!this.Vxa&&this.Sg.jH?this.Vxa=new Al(this.Ymc,this.Xa,this.Sg,this.ka,this.zga,this.vS,this.Loa,this.rc,this.jZ,this.cLa):this.hmb("PopSessionInitialized")}Lkb(){this.close("PopSessionClosed")}gza(){this.MAe("SessionClosed")}MAe(a){this.Vxa&&
this.Vxa.MAe(a)}hmb(a){this.Vxa&&this.Vxa.hmb(a)}close(a){this.Vxa&&this.Vxa.close(a)}get ena(){return!!this.Vxa&&this.Vxa.ena}dispose(){this.Nc.lEh(Object(R.a)(this,this.Lkb,"onPopSessionClosed"));this.Nc.x3e(Object(R.a)(this,this.j1a,"onPopSessionInitialized"))}}Object(m.a)(mo,"PopSessionInfoClient",null,[118,106]);var bo=d(273),Dm=d(205),Xk=d(113),Yk=d(667),Em=d(332),tp=d(886),Tl=d(870);const Vp=a=>{if(jg.a.hV(a)){a=jg.a.MJ(a);if(Tl.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;
case 326:return 2;default:return 3}}else switch(a){case jg.a.SFa:case jg.a.I9c:return 0;default:return 3}};class up{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.Xa=a;this.Sg=b;this.fe=c;this.ka=f;this.Mw=l;this.$D=u;this.Yaa=I;this.$ga=Ra;this.rc=eb;this.Loa=ja;this.w0g=this.ka.hermesNotRefreshErrorList;this.oLe=this.ka.podsMaxRetryTimesForEnsureHostSession;this.S_g=this.ka.podsMaxRetryDurationForEnsureHostSessionInMs;this.ka.Mg&&(T.YAi(Object(R.a)(this,this.C$k,"onSyncLoopStatusNotified")),ua.Pzi(Object(R.a)(this,
this.A$k,"onSuccessfulOutbound")),ua.eea(Object(R.a)(this,this.Bz,"onUnifiedAppStateChanged")));A.AFrameworkApplication.WA&&ua.DOc(Object(R.a)(this,this.Qha,"onWopiTokenRefreshed"))}hia(a,b,c){b=void 0===b?null:b;c=void 0===c?null:c;var f=this.Yaa.Qbb(this.Xa.presentationId.string);f=Object.assign(new Yk.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.ka.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.ka.Pba,
IsCoauthSession:A.AFrameworkApplication.gh.IsCoauthSession,IsCreateNewSession:this.ka.isCreateNew,UseSharedHostFile:this.ka.JUb});this.Yaa.WQc(f,b,c,a)}rUe(a,b){if(this.Xag(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.nCh();else{var c=new Date;this.Xa.xl=b.mi.PopSessionID;this.Sg.jH=!0;this.Sg.Vsc=!0;this.Sg.tze=b.mi.PopSessionID;this.Sg.wna=c;this.$D.Cql();ya.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.a1a,b.mi.PopSessionID,b.mi.PodSessionID,this.Xa.podSessionId,tp.a[b.trigger],b.retryCount,$c.a.Ef(b.startTime),$c.a.Ef(c),+c-+b.startTime,b.actionId);b.$I&&b.$I(a)}}fMb(a,b){let c=a.error.Bn;const f=new Date;if(this.Xag(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.nCh();else{if(b.retryCount<this.oLe&&+f-+b.startTime<=this.S_g){if(0===Vp(c)||c===jg.a.hi(252)){b.retryCount++;a=this.Yaa.Qbb(this.Xa.presentationId.string);ya.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.a1a,b.mi.PopSessionID,b.mi.PodSessionID,this.Xa.podSessionId,tp.a[b.trigger],b.retryCount,$c.a.Ef(b.startTime),$c.a.Ef(f),+f-+b.startTime,c,b.actionId);b.mi.PopSessionID=a;b.mi.IsRetrySession=!0;this.Yaa.nUf(b);return}this.Sg.wna=f;var l="FatalError"}else this.Sg.wna=f,l=b.retryCount>=this.oLe?String.format("Exceeded the limit of {0} times of retrying",this.oLe):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.S_g,+f-+b.startTime);c===jg.a.SFa&&(c=0===b.trigger?jg.a.hi(375):jg.a.hi(309));ya.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.a1a,b.mi.PopSessionID,b.mi.PodSessionID,this.Xa.podSessionId,tp.a[b.trigger],b.retryCount,$c.a.Ef(b.startTime),
$c.a.Ef(f),+f-+b.startTime,c,l,b.actionId);b.nr&&b.nr(a)||this.Tme(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}Xag(a,b){return a.mi.PodSessionID!==this.Xa.podSessionId?(ya.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Xa.podSessionId,a.mi.PodSessionID,b),!0):!1}nCh(){this.Sg.wna=new Date;this.hia(8)}C$k(a,b){a=jg.a.hi(b.gWh);ya.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.gWh,a,this.Xa.xl,this.Xa.podSessionId);this.Sg.jH=!1;this.$D.j1e(new Gh(this.Sg.dga));this.Tme(a,"PopSessionManager::OnSyncLoopStatusNotified",b.hkj)}Qha(a,b){try{b.o9c?(ya.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.Onk||(this.Ywb(()=>{},()=>{}),this.hia(9))):ya.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){ya.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}Wag(a,b){return a&&this.Xa.xl&&this.Xa.xl!==a?(ya.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Xa.xl,a,this.Sg.dga),!0):!1}Tme(a,b,c){c=void 0===c?null:c;ya.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.XVj(a)){if(A.AFrameworkApplication.WA&&
a===jg.a.hi(320)){const f=bo.a.instance.C$a();if(f){ya.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.Mw.ane(a,b)||this.Z$d(a,b,c)}}Ywb(a,b,c){c=void 0===c?!1:c;var f=void 0===f?"":f;ya.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Xa.xl,this.Xa.podSessionId,this.Sg.jH,this.Sg.dga,
this.Sg.Urd);if(this.Sg.jH||!this.Sg.Urd){if(this.rgf(c,f))a(new Em.a(null)),ya.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const l={};l["X-UsePopsRole"]=A.AFrameworkApplication.fa.getBooleanAppSetting("UsePopsRole").toString();this.$ga.ZRc(this.Sg.dga,f.length?f:this.Xa.podSessionId,this.Xa.presentationId.string,A.AFrameworkApplication.fa.appSettings["361"],this.Xa.Oba,c,a,b,null,l)}this.Sg.jH=!1;this.Sg.Urd=!0;this.$D.j1e(new Gh(this.Sg.dga))}}rgf(a,b){if(!E.a.e$a())return!1;
try{const c=this.Xuj(a,b),f=this.age();A.AFrameworkApplication.Me.Mqa(f,c);return!0}catch(c){return ya.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}Xuj(a,b){const c={};c.popSessionID=this.Sg.dga;c.podSessionID=b.length?b:this.Xa.podSessionId;c.presentationID=this.Xa.presentationId.string;c.podUrl=A.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Xa.Oba;c.fTimeoutOrUserClose=a;return Xk.c(c)}age(){var a=A.AFrameworkApplication.fa.Ea("368")+A.AFrameworkApplication.fa.Ea("367")+
"/ClosePopWacSession";a=new Dm.QueryStringBuilder(a);a.lw(A.AFrameworkApplication.FBa,A.AFrameworkApplication.userSessionId);a.lw(A.AFrameworkApplication.r2d,A.AFrameworkApplication.buildVersion);a.lw("waccluster",this.Xa.$k);a.lw("WacUserType",A.AFrameworkApplication.userType);a.lw(A.AFrameworkApplication.Mfb,A.AFrameworkApplication.L$c);a.lw(A.AFrameworkApplication.fU,A.AFrameworkApplication.accessToken);a.lw(A.AFrameworkApplication.w4,A.AFrameworkApplication.Im.toString());a.lw("X-UsePopsRole",
this.Xa.DBa.toString());a.lw("X-PopsAffinityRoutingEnabled",this.Xa.SHa.toString());return a=a.toString()}XVj(a){if(a!==jg.a.hi(245))return!1;if(this.Sg.UHg>this.Sg.wna&&this.Sg.jH)return ya.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Sg.UHg=new Date;this.nWf(0);return!0}nWf(a){const b=this.Xa.podSessionId;this.Loa.sIj(()=>{if(b!==this.Xa.podSessionId)ya.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId);else{var c=jg.a.hi(245);this.Mw.ane(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.Z$d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Xa.podSessionId?ya.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId):this.Loa.Dfc?
ya.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.ka.tIj?(ya.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.nWf(a+1)):(ya.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.fe.At(Object.assign(new vl.a,{Code:223,
Source:6}),b))})}Z$d(a,b,c){c=void 0===c?null:c;ya.a.J(512262793,801,10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=jg.a.MJ(a);jg.a.hV(a)?(a=Object.assign(new vl.a,{Code:jg.a.MJ(a),Source:5,ExtraErrorParam:c}),this.fe.At(a,this.Xa.podSessionId,l=>{l.yD=1;Array.contains(this.w0g,pc.a[f].toUpperCase())||(l.GEa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,
l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);return!1})):(b=0,Array.contains(this.w0g,pc.a[f].toUpperCase())||(b=8),this.fe.xua(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}A$k(){this.Sg.jH||(ya.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Xa.xl,!this.Xa.presentationId.string),this.hia(5))}Bz(a,b){md.a("Pops.CloseSessionDueToReadonly")&&
b.Xve&&!this.rc.OM&&this.Sg.jH&&(ya.a.J(512262791,801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.Ywb(()=>{},()=>{}))}}Object(m.a)(up,"PopSessionManager",null,[116]);class Wo{get name(){return"PowerPointWebEditor.PodsPops"}fc(a){a.register(116,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().na(()=>new up(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));
a.register(117,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().na(()=>new Bo(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),A.AFrameworkApplication.Me,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>A.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),
a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ha("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));
a.register(118,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().na(()=>new mo(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ha("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ha("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){C.a.instance.Ac(new Wo)}}Object(m.a)(Wo,"PPTWebEditorPodsPopsPackage",null,[2,3]);class hn{constructor(a,b,c,f,l){this.Oaa=new La.a;this.Iic=this.Jic=null;this.tQg=this.ujc=0;this.IIe=this.HIe=!1;this.zHb=Ad.a.Qba(2,0,!1);this.C0a=Ad.a.Qba(2,
1,!1);this.hkd=a;this.hkc=c;this.Wl=f;this.Gr=b;this.M_g=l}get Ic(){return this.hkc.Ic}tph(a,b,c,f){if(!b)return!1;this.HIe||(this.ujc=Date.now(),this.HIe=!0);b=!1;try{if(this.Wl.xPf(c.shapeNode)){this.Oaa.clear();this.OOi();const l=this.kxj(c);if(a){const I=this.Wl.rNj(this.Wl.ZJ(c,a),this.GVa(l),this.Ic,this.zHb,this.C0a);if(I.top||I.bottom||I.left||I.right)b=!0,this.Wl.izc(c,I);if(this.M_g){const T=this.Wl.PAj(this.Wl.ZJ(c,a),l,this.zHb,this.C0a,f);if(T.top||T.bottom||T.left||T.right)b=!0,this.Wl.izc(c,
T);const ja=this.Wl.QAj(this.Wl.ZJ(c,a),l,this.Ic,this.C0a,f,a);if(ja.top||ja.bottom||ja.left||ja.right)b=!0,this.Wl.izc(c,ja);const ua=this.Wl.iFj(this.Wl.ZJ(c,a),l,this.Ic,this.C0a,f,a);if(ua.top||ua.bottom||ua.left||ua.right)b=!0,this.Wl.izc(c,ua)}}else b=this.Wl.J3l(c,this.Wl.ZJ(c,a),this.GVa(l),this.Ic,this.zHb,this.C0a);this.Oaa.addRange(this.Wl.vOi(this.Wl.ZJ(c,a),this.GVa(l),this.Ic));const u=this.Wl.Twb(this.Wl.ZJ(c,a),this.GVa(l));if(u.count)this.Oaa.addRange(u);else if(!b){let I;I=a?this.Wl.I3l(this.Wl.ZJ(c,
!0),this.GVa(l),c):this.Wl.H3l(this.Wl.ZJ(c,!1),this.GVa(l),c,this.C0a,this.zHb);this.Oaa.addRange(I);b=!!I&&0<I.count}if(this.M_g)if(a)this.Oaa.addRange(this.Wl.t3d(this.Wl.ZJ(c,a),this.Wl.AVa(l),this.Ic,f,a)),this.Oaa.addRange(this.Wl.s$a(this.Wl.ZJ(c,a),this.Wl.AVa(l),this.Ic,f,a)),this.Oaa.addRange(this.Wl.FOi(this.Wl.ZJ(c,a),this.Wl.AVa(l),f));else{const I=this.Wl.s$a(this.Wl.ZJ(c,a),this.Wl.AVa(l),this.Ic,f,a);if(I.count)this.Oaa.addRange(I);else if(!b){const ja=this.Wl.wTh(this.Wl.ZJ(c,!1),
this.GVa(l),c,this.Ic,this.C0a,this.zHb);this.Oaa.addRange(this.Wl.s$a(this.Wl.ZJ(c,a),this.Wl.AVa(l),this.Ic,f,a));b=ja}const T=this.Wl.t3d(this.Wl.ZJ(c,a),this.Wl.AVa(l),this.Ic,f,a);if(T.count)this.Oaa.addRange(T);else if(!b){const ja=this.Wl.wTh(this.Wl.ZJ(c,!1),this.GVa(l),c,this.Ic,this.C0a,this.zHb);this.Oaa.addRange(this.Wl.t3d(this.Wl.ZJ(c,a),this.Wl.AVa(l),this.Ic,f,a));b=ja}}this.hkd.u7f(this.Oaa.toArray());this.hkd.visible=!0}}catch(l){this.IIe||(ya.a.J(8959958,815,10,"SmartGuide - moving error {0}",
l.toString()),this.IIe=!0)}return b}wph(a){a&&(this.hkd.visible=!1,this.Iic=this.Jic=null,this.Oaa.clear(),this.hkd.u7f([]),this.tQg=Date.now(),this.IIe=this.HIe=!1,ya.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.tQg-this.ujc).toString()))}OOi(){this.Wl.ikh=this.Gr.Tm(this.Ic.aW.offsetLeft-this.Ic.Tc.scrollLeft);this.Wl.jkh=this.Gr.Tm(this.Ic.aW.offsetTop-this.Ic.Tc.scrollTop)}kxj(a){return this.Jic?this.Jic:this.Jic=this.Wl.jxj(this.Wl.uMj(this.Ic,this.Ic.Na),a)}GVa(a){return this.Iic?
this.Iic:this.Iic=this.Wl.AVa(a)}}Object(m.a)(hn,"SmartGuideManager",null,[122]);var ej=d(135),Ge=d(170),Mi=d(198),pd=d(58),ek=d(171);class dh{constructor(){this.Ubd=this.LIa=null;this.Ldd=0;this.Lgb=this.jjb=null;this.kwf=!1}get color(){return this.LIa}set color(a){this.LIa=a}get dashStyle(){return this.Ubd}set dashStyle(a){this.Ubd=a}get ccc(){return this.Ldd}set ccc(a){this.Ldd=a}get gg(){return this.jjb}set gg(a){this.jjb=a}get Qg(){return this.Lgb}set Qg(a){this.Lgb=a}get oI(){return this.kwf}set oI(a){this.kwf=
a}length(){let a=-1;this.jjb&&this.Lgb&&(a=Math.sqrt(Math.pow(this.Lgb._x-this.jjb._x,2)+Math.pow(this.Lgb._y-this.jjb._y,2)));return a}reset(){const a=new dh;this.LIa=a.LIa;this.Ubd=a.Ubd;this.Ldd=a.Ldd;this.jjb=a.jjb;this.Lgb=a.Lgb}}Object(m.a)(dh,"SmartGuideLine",null,[698]);class co{constructor(a,b,c,f){this.distance=a;this.T1d=b;this.sbe=c;this.direction=f}}Object(m.a)(co,"DistancePair",null,[]);class Uq{constructor(a,b){this.shape=a;this.ql=b}}Object(m.a)(Uq,"LightSet",null,[]);class Zk{constructor(a,
b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(m.a)(Zk,"LightSetItem",null,[]);class Xo{constructor(){this.Egb={};this.EZg=[]}ga(a){return this.Egb[a]}$(a,b){a in this.Egb||this.EZg.push(a);return this.Egb[a]=b}get keys(){return this.EZg}}Object(m.a)(Xo,"NumberDictionary",null,[]);class Hi{constructor(a,b){this.first=a;this.second=b}}Object(m.a)(Hi,"NumberPair",null,[]);var Qj=d(674);class Kk{constructor(a,b){this.bOe=[];this.Ig=5;this.Y5=this.Ox=2;this.NP=4;this.LC=3;this.dhd=
this.chd=0;this.Gr=a;this.qKb=b}uMj(a,b){a=mb.GraphIterator.ob(a.eb);const c=[];for(var f=a.Gb(1);f;f=a.Qf(1))f=ek.a(f,b),c.push(f);return c}ZJ(a,b){for(const c of this.bOe)if(c.pH(a))return c.ZJ(a,b);return null}addHandler(a){this.bOe.push(a)}H3l(a,b,c,f,l){f=this.oBd(f,Kk.BQc);l=this.oBd(l,Kk.BQc);for(var u of f){f=a.copy();f.move(0,0-u);f=this.Twb(f,b);if(f.count)return this.VNa(c,0,-u),f;f=a.copy();f.move(0,u);f=this.Twb(f,b);if(f.count)return this.VNa(c,0,u),f}for(const I of l){u=a.copy();u.move(0-
I,0);u=this.Twb(u,b);if(u.count)return this.VNa(c,-1*I,0),u;u=a.copy();u.move(I,0);u=this.Twb(u,b);if(u.count)return this.VNa(c,I,0),u}return new La.a}oBd(a,b){const c=new La.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}I3l(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.Twb(f,b),f.count)return this.izc(c,l),f;return new La.a}AVa(a){const b=[];for(const c of a)b.push(new Qj.a(c.Gs()));return b}J3l(a,b,c,f,l,u){const I=new pd.a(Number.MAX_VALUE,Number.MAX_VALUE);
let T=Number.MAX_VALUE;var ja=Number.MAX_VALUE;let ua=[];for(const Ra of c)ua.push(Ra);this.qKb&&(ua=this.hwi(ua,f));for(const Ra of ua)c=this.CFj(b,Ra,T),Math.abs(I.y)>Math.abs(c)&&(I.y=c),T=Math.abs(c),c=this.AFj(b,Ra,ja),Math.abs(I.x)>Math.abs(c)&&(I.x=c),ja=Math.abs(c);ja=this.kAj(b,T,f);Math.abs(I.y)>Math.abs(ja)&&(I.y=ja);ja=this.jAj(b,T,f);Math.abs(I.x)>Math.abs(ja)&&(I.x=ja);Math.abs(I.x)>l&&(I.x=0);Math.abs(I.y)>u&&(I.y=0);return I.x||I.y?(this.VNa(a,I.x,I.y),!0):!1}hwi(a,b){var c=this.Gr.Tm(b.Ee.width);
b=this.Gr.Tm(b.Ee.height);var f=new Qj.a(new ej.a(new pd.a(0,0),new pd.a(c,0),new pd.a(c,b),new pd.a(0,b)));a.push(f);f=new Qj.a(new ej.a(new pd.a(0,0),new pd.a(c,0),new pd.a(c,b/2),new pd.a(0,b/2)));a.push(f);c=new Qj.a(new ej.a(new pd.a(0,0),new pd.a(c/2,0),new pd.a(c/2,b),new pd.a(0,b)));a.push(c);return a}izc(a,b){this.x3c(a,c=>{c.setOffsets(a,b)})}VNa(a,b,c){this.x3c(a,f=>{f.setPosition(a,b,c)})}x3c(a,b){for(const c of this.bOe)if(c.pH(a)){b(c);break}}rNj(a,b,c,f,l){let u=Number.MAX_VALUE,I=
Number.MAX_VALUE,T=Number.MAX_VALUE,ja=Number.MAX_VALUE;var ua=[];for(var Ra of b)ua.push(Ra.copy());b=this.Gr.Tm(c.Ee.width);c=this.Gr.Tm(c.Ee.height);Ra=new Qj.a(new ej.a(new pd.a(0,0),new pd.a(b,0),new pd.a(b,c),new pd.a(0,c)));ua.push(Ra);this.qKb&&(Ra=new Qj.a(new ej.a(new pd.a(0,0),new pd.a(b,0),new pd.a(b,c/2),new pd.a(0,c/2))),ua.push(Ra),b=new Qj.a(new ej.a(new pd.a(0,0),new pd.a(b/2,0),new pd.a(b/2,c),new pd.a(0,c))),ua.push(b));for(const eb of ua)ua=this.Exd([eb.jc-a.pc,eb.pc-a.pc,eb.ng().y-
a.pc],l),this.mV(ua,l)&&Math.abs(ua)<Math.abs(u)&&(u=ua),ua=this.Exd([eb.jc-a.jc,eb.pc-a.jc,eb.ng().y-a.jc],l),this.mV(ua,l)&&Math.abs(ua)<Math.abs(I)&&(I=ua),ua=this.Exd([eb.oc-a.oc,eb.lc-a.oc,eb.ng().x-a.oc],f),this.mV(ua,f)&&Math.abs(ua)<Math.abs(T)&&(T=ua),ua=this.Exd([eb.oc-a.lc,eb.lc-a.lc,eb.ng().x-a.lc],f),this.mV(ua,f)&&Math.abs(ua)<Math.abs(ja)&&(ja=ua);a=new Mi.a;a.top=u===Number.MAX_VALUE?a.top:u;a.bottom=I===Number.MAX_VALUE?a.bottom:I;a.left=T===Number.MAX_VALUE?a.left:T;a.right=ja===
Number.MAX_VALUE?a.right:ja;return a}xPf(a){let b=!1;md.a("EnableSmartGuideForTableAndVideo")&&(b=a.vd||a.sK);return a.Yfa||a.$j||a.Sk||a.Lq||a.ig||b}Szj(a,b){return Math.abs(a-b)}CFj(a,b,c){a=[new Hi(a.pc,b.pc),new Hi(a.pc,b.jc),new Hi(a.pc,b.ng().y),new Hi(a.jc,b.pc),new Hi(a.jc,b.jc),new Hi(a.jc,b.ng().y),new Hi(a.ng().y,b.pc),new Hi(a.ng().y,b.jc),new Hi(a.ng().y,b.ng().y)];return this.Q0c(a,c)}AFj(a,b,c){a=[new Hi(a.oc,b.oc),new Hi(a.oc,b.lc),new Hi(a.oc,b.ng().x),new Hi(a.lc,b.oc),new Hi(a.lc,
b.lc),new Hi(a.lc,b.ng().x),new Hi(a.ng().x,b.oc),new Hi(a.ng().x,b.lc),new Hi(a.ng().x,b.ng().x)];return this.Q0c(a,c)}kAj(a,b,c){c=this.Gr.Tm(c.Ee.height);a=[new Hi(a.pc,0),new Hi(a.pc,c),new Hi(a.jc,0),new Hi(a.jc,c),new Hi(a.ng().y,0),new Hi(a.ng().y,c)];return this.Q0c(a,b)}jAj(a,b,c){c=this.Gr.Tm(c.Ee.width);a=[new Hi(a.oc,0),new Hi(a.oc,c),new Hi(a.lc,0),new Hi(a.lc,c),new Hi(a.ng().x,0),new Hi(a.ng().x,c)];return this.Q0c(a,b)}Q0c(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.Szj(f.first,
f.second),a<b&&(b=a,c=f.second-f.first);return c}mV(a,b){a=Math.abs(a);return.2<a&&a<b}Exd(a,b){let c=Number.MAX_VALUE;for(const f of a)this.mV(f,b)&&Math.abs(c)>Math.abs(f)&&(c=f);return c}jxj(a,b){const c=new La.a;for(const f of a)this.xPf(f.shapeNode)&&f.eb!==b.eb&&c.add(f);return c.toArray()}Twb(a,b){var c=new La.a;c.add(a);var f=new La.a;f.add(a);var l=new La.a;l.add(a);var u=new La.a;u.add(a);for(const I of b)I.jc<a.pc||I.pc>a.jc||(I.oc<a.oc&&this.xNc(c,I,2),I.lc>a.lc&&this.xNc(f,I,3)),I.lc<
a.oc||I.oc>a.lc||(I.pc<a.pc&&this.xNc(l,I,0),I.jc>a.jc&&this.xNc(u,I,1));a=this.V0c(c,2);f=this.V0c(f,3);b=this.V0c(l,0);c=this.V0c(u,1);u=new Xo;this.RTc(u,a[0]);this.RTc(u,f[0]);l=new Xo;this.RTc(l,b[0]);this.RTc(l,c[0]);this.aYc(u,a,2);this.aYc(u,f,3);this.aYc(l,b,0);this.aYc(l,c,1);a=new La.a;f=new La.a;this.k1f(u,a,f);this.k1f(l,a,f);this.j4a(a,1);this.j4a(f,2);a.addRange(f);for(const I of a)this.Sw(I);return a}V0c(a,b){const c=new La.a;for(let l=0;l<a.count;++l){var f=new Zk(this.Xyj(a,l,b),
this.qzj(a,l,b),null,-1);f=new Uq(a.ga(l),[f]);for(let u=l+1;u<a.count;++u){const I=f.ql.length;let T=I;for(let ja=0;ja<I;++ja)if(!f.ql[ja].shape&&-1===f.ql[ja].distance&&f.ql[ja].end>f.ql[ja].begin){const ua=this.Tzj(a,l,u,b);T+=this.Ell(a,u,ja,T,l,ua,f,b);T+=this.Gll(a,u,ja,T,l,ua,f,b);T+=this.wml(a,u,ja,T,l,ua,f,b);T+=this.Fll(a,u,ja,l,ua,f,b)}}c.add(f)}return c.toArray()}k1f(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const u=new La.a;for(const I of f){f=!1;for(const T of u)if(this.AFi(I,
T)){f=!0;u.remove(T);break}f||u.add(I)}for(const I of u)this.k4i(I,b,c)}}}AFi(a,b){return this.rPf(a.T1d,b.T1d)&&this.rPf(a.sbe,b.sbe)}rPf(a,b){return a.oc===b.oc&&a.lc===b.lc&&a.pc===b.pc&&a.jc===b.jc}xNc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const u=a.ga(l);if(3===c&&(b.oc<a.ga(0).lc?b.lc:b.oc)<(u.oc<a.ga(0).lc?u.lc:u.oc)||2===c&&(b.lc>a.ga(0).oc?b.oc:b.lc)>(u.lc>a.ga(0).oc?u.oc:u.lc)||0===c&&(b.jc>a.ga(0).pc?b.pc:b.jc)>(u.jc>a.ga(0).pc?u.pc:u.jc)||1===c&&(b.pc<a.ga(0).jc?b.jc:b.pc)<(u.pc<
a.ga(0).jc?u.jc:u.pc)){a.insert(l,b);return}}a.add(b)}RTc(a,b){for(const c of b.ql)0<c.distance&&a.$(Math.round(100*c.distance)/100,new La.a)}aYc(a,b,c){const f=new Xo;for(const l of b){for(const u of a.keys)f.$(u,0);for(const u of l.ql)if(0<u.distance&&u.shape)for(const I of a.keys)if(b=I,this.Hv(u.distance,b)){const T=f.ga(I);1>T&&(a.ga(I).add(new co(b,l.shape,u.shape,c)),f.$(I,T+1));break}}}Xyj(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.pc,a.pc);case 0:case 1:return Math.max(b.oc,
a.oc);default:return-1}}qzj(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.jc,a.jc);case 0:case 1:return Math.min(b.lc,a.lc);default:return-1}}Ell(a,b,c,f,l,u,I,T){const ja=a.ga(b);l=a.ga(l);switch(T){case 3:case 2:if(ja.jc>=I.ql[c].begin&&ja.jc<=I.ql[c].end&&ja.pc<=I.ql[c].begin)return a=new Zk(I.ql[c].begin,ja.jc,a.ga(b),3===T?u-l.lc:l.oc-u),I.ql[f]=a,I.ql[c].begin=ja.jc,1;break;case 0:case 1:if(ja.lc>=I.ql[c].begin&&ja.lc<=I.ql[c].end&&ja.oc<=I.ql[c].begin)return a=new Zk(I.ql[c].begin,
ja.lc,a.ga(b),0===T?l.pc-u:u-l.jc),I.ql[f]=a,I.ql[c].begin=ja.lc,1}return 0}Gll(a,b,c,f,l,u,I,T){const ja=a.ga(b);l=a.ga(l);switch(T){case 3:case 2:if(ja.pc>=I.ql[c].begin&&ja.pc<=I.ql[c].end&&ja.jc>=I.ql[c].end)return a=new Zk(ja.pc,I.ql[c].end,a.ga(b),3===T?u-l.lc:l.oc-u),I.ql[f]=a,I.ql[c].end=ja.pc,1;break;case 0:case 1:if(ja.oc>=I.ql[c].begin&&ja.oc<=I.ql[c].end&&ja.lc>=I.ql[c].end)return a=new Zk(ja.oc,I.ql[c].end,a.ga(b),0===T?l.pc-u:u-l.jc),I.ql[f]=a,I.ql[c].end=ja.oc,1}return 0}wml(a,b,c,
f,l,u,I,T){const ja=a.ga(b);l=a.ga(l);switch(T){case 3:case 2:if(ja.pc>I.ql[c].begin&&ja.pc<I.ql[c].end&&ja.jc>I.ql[c].begin&&ja.jc<I.ql[c].end)return a=new Zk(ja.pc,ja.jc,a.ga(b),3===T?u-l.lc:l.oc-u),I.ql[f]=a,a=new Zk(ja.jc,I.ql[c].end,null,-1),I.ql[++f]=a,I.ql[c].end=ja.pc,2;break;case 0:case 1:if(ja.oc>I.ql[c].begin&&ja.oc<I.ql[c].end&&ja.lc>I.ql[c].begin&&ja.lc<I.ql[c].end)return a=new Zk(ja.oc,ja.lc,a.ga(b),0===T?l.pc-u:u-l.jc),I.ql[f]=a,a=new Zk(ja.lc,I.ql[c].end,null,-1),I.ql[++f]=a,I.ql[c].end=
ja.oc,2}return 0}Fll(a,b,c,f,l,u,I){const T=a.ga(b);f=a.ga(f);switch(I){case 3:case 2:T.pc<u.ql[c].begin&&T.jc>u.ql[c].end&&(u.ql[c].shape=a.ga(b),u.ql[c].distance=3===I?l-f.lc:f.oc-l);break;case 0:case 1:T.oc<u.ql[c].begin&&T.lc>u.ql[c].end&&(u.ql[c].shape=a.ga(b),u.ql[c].distance=0===I?f.pc-l:l-f.jc)}return 0}Tzj(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.oc<a.lc&&c.lc>=a.lc&&(l=c.lc);c.oc>=a.lc&&(l=c.oc);break;case 2:c.lc>a.oc&&c.oc<=a.oc&&(l=c.oc);c.lc<=a.oc&&(l=c.lc);break;case 0:c.jc>
a.pc&&c.pc<=a.pc&&(l=c.pc);c.jc<=a.pc&&(l=c.jc);break;case 1:c.pc<a.jc&&c.jc>=a.jc&&(l=c.jc),c.pc>=a.jc&&(l=c.pc)}return l}k4i(a,b,c){const f=a.T1d;var l=a.sbe;switch(a.direction){case 3:var u=Math.max(f.jc,l.jc),I=new dh;I.gg=new pd.a(f.lc-this.LC,f.pc);I.Qg=new pd.a(f.lc-this.LC,u+this.Ig);b.add(I);I=new dh;I.gg=new pd.a(f.lc+a.distance-this.LC,l.pc);I.Qg=new pd.a(f.lc+a.distance-this.LC,u+this.Ig);b.add(I);b=new dh;b.gg=new pd.a(f.lc-this.LC,u+this.Ig);b.Qg=new pd.a(f.lc+a.distance-this.LC,u+this.Ig);
c.add(b);break;case 2:u=Math.max(f.jc,l.jc);I=new dh;I.gg=new pd.a(f.oc-a.distance-this.LC,l.pc);I.Qg=new pd.a(f.oc-a.distance-this.LC,u+this.Ig);b.add(I);l=new dh;l.gg=new pd.a(f.oc-this.LC,f.pc);l.Qg=new pd.a(f.oc-this.LC,u+this.Ig);b.add(l);b=new dh;b.gg=new pd.a(f.oc-a.distance-this.LC,u+this.Ig);b.Qg=new pd.a(f.oc-this.LC,u+this.Ig);c.add(b);break;case 0:u=Math.max(f.lc,l.lc);I=new dh;I.gg=new pd.a(f.oc,f.pc-this.Ox);I.Qg=new pd.a(u+this.Ig,f.pc-this.Ox);b.add(I);I=new dh;I.gg=new pd.a(l.oc,
f.pc-a.distance-this.Ox);I.Qg=new pd.a(u+this.Ig,f.pc-a.distance-this.Ox);b.add(I);b=new dh;b.gg=new pd.a(u+this.Ig,f.pc-this.Ox);b.Qg=new pd.a(u+this.Ig,f.pc-a.distance-this.Ox);c.add(b);break;case 1:u=Math.max(f.lc,l.lc),I=new dh,I.gg=new pd.a(f.oc,f.jc-this.Ox),I.Qg=new pd.a(u+this.Ig,f.jc-this.Ox),b.add(I),I=new dh,I.gg=new pd.a(l.oc,f.jc+a.distance-this.Ox),I.Qg=new pd.a(u+this.Ig,f.jc+a.distance-this.Ox),b.add(I),b=new dh,b.gg=new pd.a(u+this.Ig,f.jc-this.Ox),b.Qg=new pd.a(u+this.Ig,f.jc+a.distance-
this.Ox),c.add(b)}}FOi(a,b,c){const f=new La.a;if(!c)return f;let l=!1;var u=!1;const I=c.equals(Ge.a.west)||c.equals(Ge.a.Pv)||c.equals(Ge.a.hJ),T=c.equals(Ge.a.east)||c.equals(Ge.a.IF)||c.equals(Ge.a.ZF),ja=c.equals(Ge.a.north)||c.equals(Ge.a.Pv)||c.equals(Ge.a.IF);c=c.equals(Ge.a.south)||c.equals(Ge.a.hJ)||c.equals(Ge.a.ZF);for(const Ra of b){if(this.FFg(a,Ra,!0,b)&&(I||T)){l=!0;var ua=new dh;ua.gg=new pd.a(Ra.oc,Ra.ng()._y);ua.Qg=new pd.a(Ra.lc-this.LC,Ra.ng()._y);ua.oI=!0;f.add(this.Sw(ua))}this.FFg(a,
Ra,!1,b)&&(ja||c)&&(u=!0,ua=new dh,ua.gg=new pd.a(Ra.ng()._x,Ra.pc),ua.Qg=new pd.a(Ra.ng()._x,Ra.jc-this.Y5),ua.oI=!1,f.add(this.Sw(ua)))}l&&(b=new dh,b.gg=new pd.a(a.oc,a.ng()._y),b.Qg=new pd.a(a.lc-this.LC,a.ng()._y),b.oI=!0,f.add(this.Sw(b)));u&&(u=new dh,u.gg=new pd.a(a.ng()._x,a.pc),u.Qg=new pd.a(a.ng()._x,a.jc-this.Y5),u.oI=!1,f.add(this.Sw(u)));this.j4a(f,2);return f}k7(a,b,c){var f=this.Jfa(a,b,!1),l=this.Jfa(a,b,!0);if(!f&&!l)return!1;let u=[];if(f){if(a.lc<=b.oc||a.lc<=b.lc){f=b.pc>a.pc?
b.pc:a.pc;var I=b.jc<a.jc?b.jc:a.jc,T,ja=T=b.oc;a.lc>b.oc&&(ja=T=b.lc);f=new Qj.a(new ej.a(new pd.a(ja,f),new pd.a(T,f),new pd.a(T,I),new pd.a(ja,I)));Array.add(u,f)}if(a.oc>=b.lc||a.oc>=b.oc)f=b.pc>a.pc?b.pc:a.pc,I=b.jc<a.jc?b.jc:a.jc,ja=T=b.lc,a.oc<b.lc&&(ja=T=b.oc),f=new Qj.a(new ej.a(new pd.a(ja,f),new pd.a(T,f),new pd.a(T,I),new pd.a(ja,I))),Array.add(u,f)}if(l){if(a.jc<=b.pc||a.jc<=b.jc)l=b.oc>a.oc?b.oc:a.oc,f=b.lc<a.lc?b.lc:a.lc,T=I=b.pc,a.jc>b.pc&&(T=I=b.jc),l=new Qj.a(new ej.a(new pd.a(l,
T),new pd.a(f,T),new pd.a(f,I),new pd.a(l,I))),u.push(l);if(a.pc>=b.jc||a.pc>=b.pc)l=b.oc>a.oc?b.oc:a.oc,f=b.lc<a.lc?b.lc:a.lc,T=I=b.jc,a.pc<b.jc&&(T=I=b.pc),l=new Qj.a(new ej.a(new pd.a(l,T),new pd.a(f,T),new pd.a(f,I),new pd.a(l,I))),Array.add(u,l)}for(const ua of c)this.Eug(ua,a)||this.Eug(ua,b)||(u=this.Tim(a,ua,u));return 0<u.length?!0:!1}Tim(a,b,c){let f=[];for(const l of c)c=!0,l.oc===l.lc?(this.Jfa(l,b,!1)||(c=!1),a.lc<=l.oc&&b.lc<=a.lc&&(c=!1),a.lc<=l.oc&&b.oc>=l.lc&&(c=!1),a.oc>=l.lc&&b.oc>=
a.oc&&(c=!1),a.oc>=l.lc&&b.lc<=l.oc&&(c=!1),c?b.pc<=l.pc&&b.jc<l.jc?f=this.xUb(f,!0,!0,!1,l,b):b.jc>=l.jc&&b.pc>l.pc?f=this.xUb(f,!0,!1,!1,l,b):b.pc>l.pc&&b.jc<l.jc&&(f=this.xUb(f,!0,!1,!0,l,b)):Array.add(f,l)):l.pc===l.jc&&(this.Jfa(l,b,!0)||(c=!1),a.jc<=l.pc&&b.jc<=a.jc&&(c=!1),a.jc<=l.pc&&b.pc>=l.jc&&(c=!1),a.pc>=l.jc&&b.pc>=a.pc&&(c=!1),a.pc>=l.jc&&b.jc<=l.pc&&(c=!1),c?b.oc<=l.oc&&b.lc<l.lc?f=this.xUb(f,!1,!0,!1,l,b):b.lc>=l.lc&&b.oc>l.oc?f=this.xUb(f,!1,!1,!1,l,b):b.oc>l.oc&&b.lc<l.lc&&(f=this.xUb(f,
!1,!1,!0,l,b)):Array.add(f,l));return f}xUb(a,b,c,f,l,u){let I,T,ja,ua,Ra,eb,Bb;if(c)b?(c=T=l.oc,I=u.jc,ja=l.jc):(I=ja=l.pc,c=u.lc,T=l.lc);else if(c||f){if(b?(c=T=ua=eb=l.oc,I=l.pc,ja=u.pc,Ra=u.jc,Bb=l.jc):(I=ja=Ra=Bb=l.pc,c=l.oc,T=u.oc,ua=u.lc,eb=l.lc),f&&b&&!this.Hv(Ra,Bb)||f&&!b&&!this.Hv(ua,eb))f=new Qj.a(new ej.a(new pd.a(ua,Ra),new pd.a(eb,Ra),new pd.a(eb,Bb),new pd.a(ua,Bb))),Array.add(a,f)}else b?(c=T=l.oc,I=l.pc,ja=u.pc):(I=ja=l.pc,c=l.oc,T=u.oc);if(b&&!this.Hv(I,ja)||!b&&!this.Hv(c,T))b=
new Qj.a(new ej.a(new pd.a(c,I),new pd.a(T,I),new pd.a(T,ja),new pd.a(c,ja))),Array.add(a,b);return a}Eug(a,b){return a.lc!==b.lc||a.oc!==b.oc||a.pc!==b.pc||a.jc!==b.jc?!1:!0}FFg(a,b,c,f){if(c)return c=this.Hv(a.oc,b.oc)&&this.Hv(a.lc,b.lc),this.Hv(a.lc-a.oc,b.lc-b.oc)&&!c&&this.k7(a,b,f);c=this.Hv(a.pc,b.pc)&&this.Hv(a.jc,b.jc);return this.Hv(a.jc-a.pc,b.jc-b.pc)&&!c&&this.k7(a,b,f)}PAj(a,b,c,f,l){const u=new Mi.a;if(!l)return u;let I=Number.MAX_VALUE,T=Number.MAX_VALUE,ja=Number.MAX_VALUE,ua=Number.MAX_VALUE;
const Ra=l.equals(Ge.a.west)||l.equals(Ge.a.Pv)||l.equals(Ge.a.hJ),eb=l.equals(Ge.a.east)||l.equals(Ge.a.IF)||l.equals(Ge.a.ZF),Bb=l.equals(Ge.a.north)||l.equals(Ge.a.Pv)||l.equals(Ge.a.IF);l=l.equals(Ge.a.south)||l.equals(Ge.a.hJ)||l.equals(Ge.a.ZF);const Ub=[];for(const Xb of b)Ub.push(new Qj.a(Xb.Gs()));for(const Xb of Ub)b=Xb.jc-Xb.pc-(a.jc-a.pc),this.mV(b,f)&&Math.abs(b)<Math.abs(I)&&this.k7(a,Xb,Ub)&&Bb&&(I=-1*b),this.mV(b,f)&&Math.abs(b)<Math.abs(T)&&this.k7(a,Xb,Ub)&&l&&(T=b),b=Xb.lc-Xb.oc-
(a.lc-a.oc),this.mV(b,c)&&Math.abs(b)<Math.abs(ja)&&this.k7(a,Xb,Ub)&&Ra&&(ja=-1*b),this.mV(b,c)&&Math.abs(b)<Math.abs(ua)&&this.k7(a,Xb,Ub)&&eb&&(ua=b);u.top=I===Number.MAX_VALUE?u.top:I;u.bottom=T===Number.MAX_VALUE?u.bottom:T;u.left=ja===Number.MAX_VALUE?u.left:ja;u.right=ua===Number.MAX_VALUE?u.right:ua;return u}QAj(a,b,c,f,l,u){let I=Number.MAX_VALUE,T=Number.MAX_VALUE,ja=Number.MAX_VALUE,ua=Number.MAX_VALUE,Ra=!0,eb=!0,Bb=!0,Ub=!0;u&&l&&(Ra=l.equals(Ge.a.west)||l.equals(Ge.a.Pv)||l.equals(Ge.a.hJ),
eb=l.equals(Ge.a.east)||l.equals(Ge.a.IF)||l.equals(Ge.a.ZF),Bb=l.equals(Ge.a.north)||l.equals(Ge.a.Pv)||l.equals(Ge.a.IF),Ub=l.equals(Ge.a.south)||l.equals(Ge.a.hJ)||l.equals(Ge.a.ZF));l=[];for(var Xb of b)l.push(new Qj.a(Xb.Gs()));b=this.Gr.Tm(c.Ee.width);c=this.Gr.Tm(c.Ee.height);for(const tc of l)tc.oc>b/2&&tc.oc<3*b/4&&a.lc<b/2&&eb&&(Xb=b/2-a.lc-(tc.oc-b/2),this.mV(Xb,f)&&Math.abs(Xb)<Math.abs(ua)&&this.k7(a,tc,l)&&(ua=Xb)),tc.lc<b/2&&tc.lc>b/4&&a.oc>b/2&&Ra&&(Xb=b/2-tc.lc-(a.oc-b/2),this.mV(Xb,
f)&&Math.abs(Xb)<Math.abs(ja)&&this.k7(a,tc,l)&&(ja=Xb)),tc.pc>c/2&&tc.pc<3*c/4&&a.jc<c/2&&Ub&&(Xb=c/2-a.jc-(tc.pc-c/2),this.mV(Xb,f)&&Math.abs(Xb)<Math.abs(T)&&this.k7(a,tc,l)&&(T=Xb)),tc.jc<c/2&&tc.jc>c/4&&a.pc>c/2&&Bb&&(Xb=c/2-tc.jc-(a.pc-c/2),this.mV(Xb,f)&&Math.abs(Xb)<Math.abs(I)&&this.k7(a,tc,l)&&(I=Xb));a=new Mi.a;a.top=I===Number.MAX_VALUE?a.top:I;a.bottom=T===Number.MAX_VALUE?a.bottom:T;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=ua===Number.MAX_VALUE?a.right:ua;return a}wTh(a,b,c,f,
l,u){l=this.oBd(l,Kk.BQc);u=this.oBd(u,Kk.BQc);for(var I of l){l=a.copy();l.move(0,0-I);if(this.s$a(l,b,f,null,!1).count)return this.VNa(c,0,-I),!0;l=a.copy();l.move(0,I);if(this.s$a(l,b,f,null,!1).count)return this.VNa(c,0,I),!0}for(const T of u){I=a.copy();I.move(0-T,0);if(this.s$a(I,b,f,null,!1).count)return this.VNa(c,-1*T,0),!0;I=a.copy();I.move(T,0);if(this.s$a(I,b,f,null,!1).count)return this.VNa(c,T,0),!0}return!1}Jfa(a,b,c){return c?a.oc>=b.oc&&a.oc<=b.lc||a.lc>=b.oc&&a.lc<=b.lc||b.oc>=a.oc&&
b.oc<=a.lc||b.lc>=a.oc&&b.lc<=a.lc:a.pc>=b.pc&&a.pc<=b.jc||a.jc>=b.pc&&a.jc<=b.jc||b.pc>=a.pc&&b.pc<=a.jc||b.jc>=a.pc&&b.jc<=a.jc}t3d(a,b,c,f,l){const u=new La.a,I=new La.a,T=new La.a;let ja=!1,ua=!1,Ra=!1,eb=!1,Bb=!0,Ub=!0,Xb=!0,tc=!0;l&&f&&(Bb=f.equals(Ge.a.west)||f.equals(Ge.a.Pv)||f.equals(Ge.a.hJ),Ub=f.equals(Ge.a.east)||f.equals(Ge.a.IF)||f.equals(Ge.a.ZF),Xb=f.equals(Ge.a.north)||f.equals(Ge.a.Pv)||f.equals(Ge.a.IF),tc=f.equals(Ge.a.south)||f.equals(Ge.a.hJ)||f.equals(Ge.a.ZF));f=this.Gr.Tm(c.Ee.width);
c=this.Gr.Tm(c.Ee.height);l=new dh;l.gg=new pd.a(f/2-this.NP,0-this.Ox);l.Qg=new pd.a(f/2-this.NP,c-this.Ox);const lc=new dh;lc.gg=new pd.a(0-this.NP,c/2-this.Ox);lc.Qg=new pd.a(f-this.NP,c/2-this.Ox);lc.oI=!0;for(const Ec of b)Ec.oc>f/2&&Ec.oc<3*f/4&&a.lc<f/2&&this.k7(a,Ec,b)&&Ub&&this.Hv(f/2-a.lc,Ec.oc-f/2)&&(ja=!0,0>Ec.pc&&(l.gg=new pd.a(f/2,Ec.pc)),Ec.jc>c&&(l.Qg=new pd.a(f/2,Ec.jc+this.Ig)),u.add(this.rSa(Ec,!1,!1)),I.add(this.mSa(Ec,!1,!1,f,c))),Ec.lc<f/2&&Ec.lc>f/4&&a.oc>f/2&&this.k7(a,Ec,
b)&&Bb&&this.Hv(a.oc-f/2,f/2-Ec.lc)&&(ua=!0,0>Ec.pc&&(l.gg=new pd.a(f/2,Ec.pc)),Ec.jc>c&&(l.Qg=new pd.a(f/2,Ec.jc+this.Ig)),u.add(this.rSa(Ec,!1,!0)),I.add(this.mSa(Ec,!1,!0,f,c))),Ec.pc>c/2&&Ec.pc<3*c/4&&a.jc<c/2&&this.k7(a,Ec,b)&&tc&&this.Hv(c/2-a.jc,Ec.pc-c/2)&&(Ra=!0,0>Ec.oc&&(lc.gg=new pd.a(Ec.oc,c/2)),Ec.lc>f&&(lc.Qg=new pd.a(Ec.lc+this.Ig,c/2)),u.add(this.rSa(Ec,!0,!1)),I.add(this.mSa(Ec,!0,!1,f,c))),Ec.jc<c/2&&Ec.jc>c/4&&a.pc>c/2&&this.k7(a,Ec,b)&&Xb&&this.Hv(a.pc-c/2,c/2-Ec.jc)&&(eb=!0,0>
Ec.oc&&(lc.gg=new pd.a(Ec.oc,c/2)),Ec.lc>f&&(lc.Qg=new pd.a(Ec.lc+this.Ig,c/2)),u.add(this.rSa(Ec,!0,!0)),I.add(this.mSa(Ec,!0,!0,f,c)));(ja||ua)&&u.add(this.Sw(l));(Ra||eb)&&u.add(this.Sw(lc));Ra&&(a.oc<lc.gg._x&&(lc.gg=new pd.a(a.oc,c/2)),a.lc>lc.Qg._x&&(lc.Qg=new pd.a(a.lc,c/2+this.Ig)),u.add(this.rSa(a,!0,!0)),I.add(this.mSa(a,!0,!0,f,c)));eb&&(a.oc<lc.gg._x&&(lc.gg=new pd.a(a.oc,c/2)),a.lc>lc.Qg._x&&(lc.Qg=new pd.a(a.lc,c/2+this.Ig)),u.add(this.rSa(a,!0,!1)),I.add(this.mSa(a,!0,!1,f,c)));ja&&
(a.pc<l.gg._y&&(l.gg=new pd.a(f/2,a.pc)),a.jc>l.Qg._y&&(l.Qg=new pd.a(f/2,a.jc+this.Ig)),u.add(this.rSa(a,!1,!0)),I.add(this.mSa(a,!1,!0,f,c)));ua&&(a.pc<l.gg._y&&(l.gg=new pd.a(f/2,a.pc)),a.jc>l.Qg._y&&(l.Qg=new pd.a(f/2,a.jc+this.Ig)),u.add(this.rSa(a,!1,!1)),I.add(this.mSa(a,!1,!1,f,c)));this.j4a(u,1);this.j4a(I,2);for(const Ec of u)T.add(Ec);for(const Ec of I)T.add(Ec);return T}rSa(a,b,c){const f=b&&c,l=b&&!c,u=!b&&!c;return!b&&c?(b=new dh,b.gg=new pd.a(a.lc-this.LC,a.jc),b.Qg=new pd.a(a.lc-this.LC,
a.jc+this.Ig),this.Sw(b)):u?(b=new dh,b.gg=new pd.a(a.oc-this.NP,a.jc),b.Qg=new pd.a(a.oc-this.NP,a.jc+this.Ig),this.Sw(b)):f?(b=new dh,b.gg=new pd.a(a.lc,a.jc-this.Y5),b.Qg=new pd.a(a.lc+this.Ig,a.jc-this.Y5),this.Sw(b)):l?(b=new dh,b.gg=new pd.a(a.lc,a.pc-this.Ox),b.Qg=new pd.a(a.lc+this.Ig,a.pc-this.Ox),this.Sw(b)):null}mSa(a,b,c,f,l){const u=b&&c,I=b&&!c,T=!b&&!c;return!b&&c?(l=new dh,l.oI=!0,l.gg=new pd.a(f/2-this.NP,a.jc+this.Ig),l.Qg=new pd.a(a.lc-this.LC,a.jc+this.Ig),this.Sw(l)):T?(l=new dh,
l.oI=!0,l.gg=new pd.a(f/2-this.NP,a.jc+this.Ig),l.Qg=new pd.a(a.oc-this.NP,a.jc+this.Ig),this.Sw(l)):u?(f=new dh,f.oI=!0,f.gg=new pd.a(a.lc+this.Ig,l/2-this.Ox),f.Qg=new pd.a(a.lc+this.Ig,a.jc-this.Y5),this.Sw(f)):I?(f=new dh,f.oI=!0,f.gg=new pd.a(a.lc+this.Ig,l/2-this.Ox),f.Qg=new pd.a(a.lc+this.Ig,a.pc-this.Ox),this.Sw(f)):null}iFj(a,b,c,f,l,u){let I=Number.MAX_VALUE,T=Number.MAX_VALUE,ja=Number.MAX_VALUE,ua=Number.MAX_VALUE,Ra=!0,eb=!0,Bb=!0,Ub=!0;u&&l&&(Ra=l.equals(Ge.a.west)||l.equals(Ge.a.Pv)||
l.equals(Ge.a.hJ),eb=l.equals(Ge.a.east)||l.equals(Ge.a.IF)||l.equals(Ge.a.ZF),Bb=l.equals(Ge.a.north)||l.equals(Ge.a.Pv)||l.equals(Ge.a.IF),Ub=l.equals(Ge.a.south)||l.equals(Ge.a.hJ)||l.equals(Ge.a.ZF));l=[];for(const Xb of b)l.push(new Qj.a(Xb.Gs()));b=this.Gr.Tm(c.Ee.width);c=this.Gr.Tm(c.Ee.height);for(const Xb of l)Xb.lc>3*b/4&&Xb.lc<b&&a.oc<b/4&&0<a.oc&&this.Jfa(a,Xb,!1)&&Ra&&(l=b-Xb.lc-a.oc,this.mV(l,f)&&Math.abs(l)<Math.abs(ja)&&(ja=l)),Xb.oc<b/4&&0<Xb.oc&&a.lc>3*b/4&&a.lc<b&&this.Jfa(a,Xb,
!1)&&eb&&(l=b-a.lc-Xb.oc,this.mV(l,f)&&Math.abs(l)<Math.abs(ua)&&(ua=l)),Xb.jc>3*c/4&&Xb.jc<c&&a.pc<c/4&&0<a.pc&&this.Jfa(a,Xb,!0)&&Bb&&(l=c-Xb.jc-a.pc,this.mV(l,f)&&Math.abs(l)<Math.abs(I)&&(I=l)),Xb.pc<c/4&&0<Xb.pc&&a.jc>3*c/4&&a.jc<c&&this.Jfa(a,Xb,!0)&&Ub&&(l=c-a.jc-Xb.pc,this.mV(l,f)&&Math.abs(l)<Math.abs(T)&&(T=l));a=new Mi.a;a.top=I===Number.MAX_VALUE?a.top:I;a.bottom=T===Number.MAX_VALUE?a.bottom:T;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=ua===Number.MAX_VALUE?a.right:ua;return a}s$a(a,
b,c,f,l){const u=new La.a,I=new La.a,T=new La.a;var ja=!1,ua=!1,Ra=!1,eb=!1,Bb=!0;let Ub=!0,Xb=!0,tc=!0;l&&f&&(Bb=f.equals(Ge.a.west)||f.equals(Ge.a.Pv)||f.equals(Ge.a.hJ),Ub=f.equals(Ge.a.east)||f.equals(Ge.a.IF)||f.equals(Ge.a.ZF),Xb=f.equals(Ge.a.north)||f.equals(Ge.a.Pv)||f.equals(Ge.a.IF),tc=f.equals(Ge.a.south)||f.equals(Ge.a.hJ)||f.equals(Ge.a.ZF));f=this.Gr.Tm(c.Ee.width);c=this.Gr.Tm(c.Ee.height);for(const lc of b)lc.lc>3*f/4&&lc.lc<f&&a.oc<f/4&&0<a.oc&&this.Jfa(a,lc,!1)&&Bb&&this.Hv(a.oc,
f-lc.lc)&&(ja=!0,b=new dh,b.gg=new pd.a(lc.lc-this.LC,lc.jc),b.Qg=new pd.a(lc.lc-this.LC,lc.jc+this.Ig),u.add(this.Sw(b)),b=new dh,b.oI=!0,b.gg=new pd.a(f-this.LC,lc.jc+this.Ig),b.Qg=new pd.a(lc.lc-this.LC,lc.jc+this.Ig),I.add(this.Sw(b))),lc.oc<f/4&&0<lc.oc&&a.lc>3*f/4&&a.oc<f&&this.Jfa(a,lc,!1)&&Ub&&this.Hv(f-a.lc,lc.oc)&&(ua=!0,b=new dh,b.gg=new pd.a(lc.oc-this.NP,lc.jc),b.Qg=new pd.a(lc.oc-this.NP,lc.jc+this.Ig),u.add(this.Sw(b)),b=new dh,b.oI=!0,b.gg=new pd.a(0-this.NP,lc.jc+this.Ig),b.Qg=new pd.a(lc.oc-
this.NP,lc.jc+this.Ig),I.add(this.Sw(b))),lc.jc>3*c/4&&lc.jc<c&&a.pc<c/4&&0<a.pc&&this.Jfa(a,lc,!0)&&Xb&&this.Hv(a.pc,c-lc.jc)&&(Ra=!0,b=new dh,b.gg=new pd.a(lc.lc,lc.jc-this.Y5),b.Qg=new pd.a(lc.lc+this.Ig,lc.jc-this.Y5),u.add(this.Sw(b)),l=new dh,b.oI=!0,l.gg=new pd.a(lc.lc+this.Ig,lc.jc-this.Y5),l.Qg=new pd.a(lc.lc+this.Ig,c-this.Y5),I.add(this.Sw(l))),lc.pc<c/4&&0<lc.pc&&a.jc>3*c/4&&a.jc<c&&this.Jfa(a,lc,!0)&&tc&&this.Hv(c-a.jc,lc.pc)&&(eb=!0,b=new dh,b.gg=new pd.a(lc.lc,lc.pc-this.Ox),b.Qg=new pd.a(lc.lc+
this.Ig,lc.pc-this.Ox),u.add(this.Sw(b)),l=new dh,b.oI=!0,l.gg=new pd.a(lc.lc+this.Ig,0-this.Ox),l.Qg=new pd.a(lc.lc+this.Ig,lc.pc-this.Ox),I.add(this.Sw(l)));Ra&&(Ra=new dh,Ra.gg=new pd.a(a.lc,a.pc-this.Ox),Ra.Qg=new pd.a(a.lc+this.Ig,a.pc-this.Ox),u.add(this.Sw(Ra)),Bb=new dh,Ra.oI=!0,Bb.gg=new pd.a(a.lc+this.Ig,0-this.Ox),Bb.Qg=new pd.a(a.lc+this.Ig,a.pc-this.Ox),I.add(this.Sw(Bb)));eb&&(eb=new dh,eb.gg=new pd.a(a.lc,a.jc-this.Y5),eb.Qg=new pd.a(a.lc+this.Ig,a.jc-this.Y5),u.add(this.Sw(eb)),Ra=
new dh,eb.oI=!0,Ra.gg=new pd.a(a.lc+this.Ig,c-this.Y5),Ra.Qg=new pd.a(a.lc+this.Ig,a.jc-this.Y5),I.add(this.Sw(Ra)));ja&&(ja=new dh,ja.gg=new pd.a(a.oc-this.NP,a.jc),ja.Qg=new pd.a(a.oc-this.NP,a.jc+this.Ig),u.add(this.Sw(ja)),ja=new dh,ja.oI=!0,ja.gg=new pd.a(0-this.NP,a.jc+this.Ig),ja.Qg=new pd.a(a.oc-this.NP,a.jc+this.Ig),I.add(this.Sw(ja)));ua&&(ua=new dh,ua.gg=new pd.a(a.lc-this.LC,a.jc),ua.Qg=new pd.a(a.lc-this.LC,a.jc+this.Ig),u.add(this.Sw(ua)),ua=new dh,ua.oI=!0,ua.gg=new pd.a(f-this.LC,
a.jc+this.Ig),ua.Qg=new pd.a(a.lc-this.LC,a.jc+this.Ig),I.add(this.Sw(ua)));this.j4a(u,1);this.j4a(I,2);for(const lc of u)T.add(lc);for(const lc of I)T.add(lc);return T}vOi(a,b,c){var f=new dh;const l=new dh,u=new dh,I=new dh,T=new dh,ja=new dh,ua=new La.a;ua.add(f);ua.add(l);ua.add(u);ua.add(I);ua.add(T);ua.add(ja);this.j4a(ua,0);this.Mak(f,l,u,I,T,ja,a);for(const Ra of b)this.b5(a.pc,Ra.pc,Ra.jc,f,Ra),this.b5(a.jc,Ra.pc,Ra.jc,l,Ra),this.b5(a.oc,Ra.oc,Ra.lc,u,Ra),this.b5(a.lc,Ra.oc,Ra.lc,I,Ra),this.qKb&&
(this.b5(a.pc,Ra.ng()._y,null,f,Ra),this.b5(a.jc,Ra.ng()._y,null,l,Ra),this.b5(a.oc,Ra.ng()._x,null,u,Ra),this.b5(a.lc,Ra.ng()._x,null,I,Ra),this.b5(a.ng()._y,Ra.pc,null,T,Ra),this.b5(a.ng()._y,Ra.jc,null,T,Ra),this.b5(a.ng()._x,Ra.oc,null,ja,Ra),this.b5(a.ng()._x,Ra.lc,null,ja,Ra)),this.b5(a.ng()._y,Ra.ng()._y,null,T,Ra),this.b5(a.ng()._x,Ra.ng()._x,null,ja,Ra);0<f.length()&&0<l.length()&&(this.qKb?(T.gg=new pd.a(a.oc-this.Ig,a.ng()._y),T.Qg=T.gg.copy()):T.reset());0<u.length()&&0<I.length()&&(this.qKb?
(ja.gg=new pd.a(a.ng()._x,a.oc-this.NP),ja.Qg=ja.gg.copy()):ja.reset());if(this.qKb&&c){b=this.Gr.Tm(c.Ee.width);c=this.Gr.Tm(c.Ee.height);if(this.Hv(a.pc,c/2)||Math.abs(a.pc)<=Kk.m$a||this.Hv(a.pc,c))f.gg._x=Math.min(f.gg._x,-1*this.Ig),f.Qg._x=Math.max(f.Qg._x,b+this.Ig);if(this.Hv(a.jc,c/2)||Math.abs(a.jc)<=Kk.m$a||this.Hv(a.jc,c))l.gg._x=Math.min(l.gg._x,-1*this.Ig),l.Qg._x=Math.max(l.Qg._x,b+this.Ig);if(this.Hv(a.ng()._y,c/2)||Math.abs(a.ng()._y)<=Kk.m$a||this.Hv(a.ng()._y,c))T.gg._x=Math.min(T.gg._x,
-1*this.Ig),T.Qg._x=Math.max(T.Qg._x,b+this.Ig);if(this.Hv(a.lc,b/2)||Math.abs(a.lc)<=Kk.m$a||this.Hv(a.lc,b))I.gg._y=Math.min(I.gg._y,-1*this.Ig),I.Qg._y=Math.max(I.Qg._y,c+this.Ig);if(this.Hv(a.oc,b/2)||Math.abs(a.oc)<=Kk.m$a||this.Hv(a.oc,b))u.gg._y=Math.min(u.gg._y,-1*this.Ig),u.Qg._y=Math.max(u.Qg._y,c+this.Ig);if(this.Hv(a.ng()._x,b/2)||Math.abs(a.ng()._x)<=Kk.m$a||this.Hv(a.ng()._x,b))ja.gg._y=Math.min(ja.gg._y,-1*this.Ig),ja.Qg._y=Math.max(ja.Qg._y,c+this.Ig)}f=new La.a;for(const Ra of ua)Ra.gg&&
0<Ra.length()&&(this.dag(Ra,a),f.add(this.Sw(Ra)));return f}b5(a,b,c,f,l){(this.Hv(a,b)||this.Hv(a,c))&&this.dag(f,l)}dag(a,b){a.oI?(a.gg._x=Math.min(a.gg._x,b.oc-this.Ig),a.Qg._x=Math.max(a.Qg._x,b.lc+this.Ig)):(a.gg._y=Math.min(a.gg._y,b.pc-this.Ig),a.Qg._y=Math.max(a.Qg._y,b.jc+this.Ig))}Sw(a){let b;(b=a.gg).x=b.x+this.chd;let c;(c=a.gg).y=c.y+this.dhd;let f;(f=a.Qg).x=f.x+this.chd;let l;(l=a.Qg).y=l.y+this.dhd;return a}Hv(a,b){var c=void 0===c?Kk.m$a:c;return!!a&&!!b&&Math.abs(a-b)<=c}Mak(a,b,
c,f,l,u,I){a.gg=new pd.a(I.oc-this.Ig,I.pc-this.Ox);a.Qg=a.gg.copy();a.oI=!0;b.gg=new pd.a(I.oc-this.Ig,I.jc-this.Y5);b.Qg=b.gg.copy();b.oI=!0;c.gg=new pd.a(I.oc-this.NP,I.pc-this.Ig);c.Qg=c.gg.copy();f.gg=new pd.a(I.lc-this.LC,I.pc-this.Ig);f.Qg=f.gg.copy();b=I.ng();l.gg=new pd.a(a.gg._x-this.Ig,b._y-this.Ox);l.Qg=l.gg.copy();l.oI=!0;u.gg=new pd.a(b._x-this.Ig,c.gg._y-this.Ig);u.Qg=u.gg.copy()}j4a(a,b){for(const c of a)0===b?(c.color=Hf.a.bWi,c.dashStyle="4,4",c.ccc=0):1===b?(c.color=Hf.a.aWi,c.dashStyle=
"4,4",c.ccc=1):2===b&&(c.color=Hf.a.qYf,c.dashStyle="4,4",c.ccc=2)}get ikh(){return this.chd}set ikh(a){this.chd=a}get jkh(){return this.dhd}set jkh(a){this.dhd=a}}Kk.m$a=.4;Kk.BQc=5;Object(m.a)(Kk,"SmartGuideUtility",null,[124]);var no=d(139),Yo=d(211),Fm=d(162),Wj=d(199);class tn{constructor(a,b,c,f){this.sKb=this.tKb=this.Bb=null;this.yoa=new Sys.UI.Bounds(0,0,0,0);this.fLa=1;this.Mb=!1;this.Tg=a;this.kj=b;this.xd=f;this.Jc=c;this.xd.c3b(Object(R.a)(this,this.tu,"onResize"));this.xd.vSa(Object(R.a)(this,
this.G2,"onActiveSlideDomDisplayed"));this.Cn()}get visible(){return!!this.Bb&&this.Mb}set visible(a){this.Bb||this.Cn();this.Mb!==a&&(this.Bb.ee(a),this.Mb=a)}u7f(a){this.sKb&&this.tKb.va.removeChild(this.sKb.va);this.sKb=new Yo.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new Fm.a,l=tn.qwk(tn.nAh(pd.a.scale(c.gg,this.fLa,this.fLa)),tn.nAh(pd.a.scale(c.Qg,this.fLa,this.fLa)));f.yu(l);f.Vv(this.Nfg(c.color));f.Tqa(c.dashStyle);f.vs(1);this.sKb.appendChild(f);2===c.ccc&&this.xej(l[0],l[1])}this.tKb.appendChild(this.sKb)}xej(a,
b){a._y===b._y?a._x<b._x?this.q0f(a,b):this.q0f(b,a):a._y>b._y?this.r0f(a,b):this.r0f(b,a)}q0f(a,b){const c=this.dUf(b._x-a._x);this.qTc([new pd.a(a._x,a._y),new pd.a(a._x+c,a._y-c/2),new pd.a(a._x+c,a._y+c/2)]);this.qTc([new pd.a(b._x,b._y),new pd.a(b._x-c,b._y-c/2),new pd.a(b._x-c,b._y+c/2)])}r0f(a,b){const c=this.dUf(a._y-b._y);this.qTc([new pd.a(a._x,a._y),new pd.a(a._x-c/2,a._y-c),new pd.a(a._x+c/2,a._y-c)]);this.qTc([new pd.a(b._x,b._y),new pd.a(b._x-c/2,b._y+c),new pd.a(b._x+c/2,b._y+c)])}dUf(a){return Math.min(a,
10)/2}qTc(a){const b=new Fm.a,c=this.Nfg(Hf.a.qYf);b.yu(a);b.Vv(c);b.vs(1);b.UF(c);b.ee(!0);this.sKb.appendChild(b)}Nfg(a){return this.kj&&this.kj.highContrastColors?this.kj.highContrastColors.foregroundTextColor:a}Cn(){this.Bb=new no.a;this.Bb.ot("SmartGuideView");this.Bb.xk(0);this.Bb.ee(!1);this.Tg.va.appendChild(this.Bb.va);this.tKb=new Wj.a;this.tKb.va.style.overflow="visible";this.Bb.appendChild(this.tKb);this.$s(this.Jc.Ic)}tu(a,b){b&&this.$s(b.sH)}G2(a,b){b&&this.$s(b.sH)}$s(a){this.Bb&&a&&
a.Ee&&a===this.Jc.Ic&&(this.yoa.x!==a.Ee.x||this.yoa.y!==a.Ee.y||this.yoa.width!==a.Ee.width||this.yoa.height!==a.Ee.height)&&(this.yoa=new Sys.UI.Bounds(a.Ee.x,a.Ee.y,a.Ee.width,a.Ee.height),this.Bb.setPosition(a.Ee.x,a.Ee.y),this.tKb.Mh(a.Ee.width,a.Ee.height),this.Bb.Mh(a.Ee.width,a.Ee.height))}static qwk(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static nAh(a){return new pd.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(m.a)(tn,
"SmartGuideView",null,[123]);class oo{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Mi.a.add(a.xLa,b),!0)}ZJ(a){return new Qj.a(a.Gs())}pH(a){return!a.shapeNode.Iv}}Object(m.a)(oo,"DefaultShapeMoveResizeHandler",null,[190]);class Gm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}fc(a){Object(Ti.a)("SmartGuide");this.K=a;this.K.register(122,"PowerPointWebEditor.ISmartGuideManager").ma().na(()=>new hn(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),
this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));this.K.register(123,"PowerPointWebEditor.ISmartGuideView").ma().na(()=>new tn(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));this.K.register(124,"PowerPointWebEditor.ISmartGuideUtility").ma().na(()=>new Kk(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){Object(Ti.b)("SmartGuide");this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new oo)}dispose(){}static main(){C.a.instance.Ac(new Gm)}}Object(m.a)(Gm,"PPTWebEditorSmartGuidePackage",
null,[2,3]);class jn{}jn.DJg=[G.a.backspace,G.a.nab,G.a.PJ,G.a.vyb,G.a.nFa,G.a.enter,G.a.myc,G.a.WC,G.a.tab,G.a.oyc,G.a.pageDown,G.a.pageUp,G.a.U0a,G.a.QRe,G.a.T0a,G.a.PRe];jn.Dyk=[G.a.backspace,G.a.nab,G.a.PJ,G.a.vyb,G.a.nFa,G.a.enter,G.a.myc,G.a.WC,G.a.tab,G.a.oyc,G.a.font,G.a.A7,G.a.fNa,G.a.$q,G.a.sMa,G.a.M2a,G.a.OG,G.a.rH,G.a.bold,G.a.setItalic,G.a.underline,G.a.strikethrough,G.a.Jr,G.a.fT,G.a.uea,G.a.qL,G.a.aO,G.a.lC,G.a.My,G.a.rea,G.a.ega,G.a.pia,G.a.Yua,M.a.Ypa,M.a.S2,M.a.R2,M.a.Q2,G.a.pFa,
G.a.Sma,G.a.dBa,G.a.eBa,G.a.fBa,G.a.lOa,G.a.mOa,G.a.Hdc,G.a.Idc,G.a.$db,G.a.kXa,G.a.nXa,G.a.Yva,G.a.S9,M.a.rNb,G.a.deleteRow,M.a.ktc,G.a.mFa,M.a.gsd,G.a.insertTable,M.a.CYe,G.a.oU,G.a.y0,M.a.y7,M.a.pMa,M.a.D3a,M.a.ENa,M.a.Uqa,M.a.FNa,M.a.mBd,M.a.lBd,G.a.eL,G.a.qXa,G.a.centerJustify,G.a.leftJustify,G.a.rightJustify,G.a.fullJustify,G.a.a8b,G.a.Mgc,G.a.Sxc,M.a.Dob,M.a.Eob,M.a.Fob,M.a.Gob,G.a.l4b];jn.VLl=[G.a.leftArrow,G.a.rightArrow,G.a.upArrow,G.a.downArrow,G.a.K3a,G.a.J3a,G.a.eFa,G.a.dFa,G.a.aUa,G.a.$Ta,
G.a.KRb,G.a.kob,G.a.j7b,G.a.wyb,G.a.oab,G.a.ZTa,G.a.U0a,G.a.XUa,G.a.dkb,G.a.ckb,G.a.jbb,G.a.T0a,G.a.WUa,G.a.ibb,G.a.Jua,G.a.Wzd,M.a.Xwc,M.a.fUb,M.a.X3a,M.a.pSb];Object(m.a)(jn,"ActionIdList",null,[]);class vp{constructor(){this.ActionTime=this.ActionName=this.ActionId=null}}Object(m.a)(vp,"ActionInformation",null,[]);class Co{constructor(a,b,c,f,l,u){this.Rfb=[];this.Jhc=[];this.yK=a;this.vBe=b||[];this.ia=c;this.ia.a3(this);this.Xa=f;this.YY=l;this.yI=u}getName(){return"ActionInfo"}JZ(a){this.MQh(a)&&
this.bra(a.actionId)&&(this.Rfb.push(a.actionId),this.Jhc.push(Date.now()))}IZ(a){this.MQh(a)&&this.bra(a.actionId)&&(this.Rfb.pop(),this.Jhc.pop())}bra(a){if(Array.contains(this.vBe,a))return!0;a=this.ia.RU(a);return!!a&&!(a.flags[32]||a.flags[64])}MQh(a){return 2===a.behavior&&a.Bj?!0:!1}getCommandName(a,b){b=void 0===b?"":b;return(a=this.yK?this.yK.H7(a):null)?a:b}FZ(a){a&&a.kua&&ya.a.J(508383891,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.kua.toString(),this.actionName||
(this.YY.Wc===G.a.Nz||this.YY.Wc===G.a.rEa||this.YY.Wc===G.a.nUa?"Typing":null)||(this.yI.t6c?"ClosingTextUndoStack":""),this.Xa.podSessionId||"",this.yK.H7(this.YY.Wc));return!!this.Rfb.length}update(a,b){a=new vp;a.ActionId=this.Rkg();a.ActionName=this.Skg();a.ActionTime=this.dEj().toString();yl.a.pp(b,yb.a.ksi,a);b.setValue(yb.a.xdc,!0);b.setValue(yb.a.swd,1)}get actionName(){return this.Skg()}get actionId(){return this.Rkg()}rie(){return this.Rfb[this.Rfb.length-1]}Rkg(){return this.Rfb.length?
this.rie().toString():null}Skg(){return this.Rfb.length?this.getCommandName(this.rie(),this.rie().toString()):null}dEj(){return this.Jhc.length?this.Jhc[this.Jhc.length-1]:Number.MAX_VALUE}}Object(m.a)(Co,"ActionInfoRevisionMetaDataUpdater",null,[192,182]);class Hn{constructor(){this.ua=new uc.a}fAh(a){this.ua.raiseEvent("UCI",a)}mBi(a){this.ua.addHandler("UCI",a)}UCl(a){this.ua.removeHandler("UCI",a)}}Object(m.a)(Hn,"CcpEventSource",null,[663,664,665]);class $k{constructor(a,b){this.xic=this.HCe=
this.GCe=null;this.ICe=a;this.PV=b;this.ICe.mBi(Object(R.a)(this,this.Hlh,"onCcpPropertyChanged"))}Hlh(a,b){this.GCe=b.nq;this.HCe=b.FQi;this.xic=b.GQi}FZ(a){a=this.PV.FGa(a.dAa);!this.xic&&a.Qa(yb.a.M$a)&&(a.removeProperty(yb.a.EO),a.removeProperty(yb.a.mR),a.removeProperty(yb.a.M$a));return!!this.xic}update(a,b){b.setValue(yb.a.EO,this.GCe);b.setValue(yb.a.mR,this.HCe);b.setValue(yb.a.M$a,this.xic);this.xic=this.HCe=this.GCe=null}dispose(){this.ICe&&this.ICe.UCl(Object(R.a)(this,this.Hlh,"onCcpPropertyChanged"))}}
Object(m.a)($k,"CcpInfoRevisionMetaDataUpdater",null,[134,192,106]);var Im=d(329);class Vm extends Yg.a{constructor(a,b,c,f,l,u,I){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=u;this.AuthToken=I}om(){return 108}}Object(m.a)(Vm,"AugmentImageRequest",Yg.a,[]);class Lh extends Yg.a{constructor(){super()}om(){return 81}}Object(m.a)(Lh,"FlushRequest",
Yg.a,[]);class fm extends Yg.a{constructor(a,b,c,f,l,u){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=f;this.DeckSuggestionId=l;this.Hints=u}om(){return 111}}Object(m.a)(fm,"GenerateAgendaDeckSuggestionRequest",Yg.a,[]);class jl extends Yg.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=
a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}om(){return 110}}Object(m.a)(jl,"GenerateAgendaSuggestionRequest",Yg.a,[]);class Ni extends Yg.a{constructor(a,b,c,f,l,u,I,T,ja,ua){super();this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=u;this.SubNodeWidth=I;
this.SubNodeHeight=T;this.CorrelationId=ja;this.Trigger=ua}om(){return 99}}Object(m.a)(Ni,"GenerateIconSuggestionRequest",Yg.a,[]);class kn extends Yg.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=this.IsSVGBlipFill=!1;this.GraphNodeId=Ui.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}om(){return 91}}Object(m.a)(kn,"GenerateImageDescriptionRequest",Yg.a,[]);class gm extends Yg.a{constructor(a,b,c,f,l,u,I){super();this.Sid=this.Cid=
0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=u;this.Hints=I}om(){return 66}}Object(m.a)(gm,"GenerateSuggestionRequest",Yg.a,[]);class mf extends gm{constructor(a,b,c,f,l,u,I,T){super(a,b,f,null,l,u,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=I;this.ShapeViewHeight=T}om(){return 83}}
Object(m.a)(mf,"GenerateReplaceObjectRequest",gm,[]);class Rj extends Yg.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}om(){return 57}}Object(m.a)(Rj,"GetPictureCropInfoRequest",Yg.a,[]);class Jm extends Yg.a{constructor(){super();this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}om(){return 109}}Object(m.a)(Jm,"ImageTransformRequest",Yg.a,[]);class Lk extends Yg.a{constructor(a,b){super();this.JsonString=this.CorrelationId=
null;this.CorrelationId=a;this.JsonString=b}om(){return 84}}Object(m.a)(Lk,"ReportReplaceObjectInfoRequest",Yg.a,[]);class Wm extends Yg.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}om(){return 67}}Object(m.a)(Wm,"ReportSuggestionSessionInfoRequest",Yg.a,[]);class Vq extends Yg.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}om(){return 59}}Object(m.a)(Vq,
"UpdateContentAddinSnapshotInfoRequest",Yg.a,[]);class Vi{constructor(a,b,c){this.yI=a;this.Yb=b;this.oOg=c}get t6c(){return this.yI.t6c}P$a(a,b){return this.yI.P$a(a,void 0===b?!1:b)}forceOutbound(){this.yI.forceOutbound()}sia(a,b,c){this.yI.sia(a,b,void 0===c?!1:c)}CNc(a){this.yI.CNc(a)}jBb(a){return this.yI.jBb(a)}Jb(a){this.yI.Jb(a)}Fmg(a,b,c,f,l,u){f=void 0===f?null:f;l=void 0===l?null:l;u=void 0===u?!1:u;a=new Kh.a(new Rj(a,b,c),f,l,I=>0===I.StatusCode);this.yI.sia(a,this.Yb,u)}oma(a,b,c,f,
l,u,I,T,ja){T=void 0===T?null:T;ja=void 0===ja?null:ja;a=new Kh.a(new gm(a,b,c,f,l,u,I),T,ja,ua=>0===ua.StatusCode);this.yI.sia(a,this.Yb)}generateImageDescription(a,b,c,f){a=new Kh.a(new kn(a,b,c,f),null,null,l=>0===l.StatusCode);this.yI.sia(a,this.Yb)}Aqa(a,b,c){a=new Kh.a(new Wm(a,b),null,()=>!0,f=>0===f.StatusCode);this.yI.sia(a,this.Yb,c)}rfg(a,b,c,f,l,u,I,T,ja){T=void 0===T?null:T;ja=void 0===ja?null:ja;a=new Kh.a(new mf(a,b,c,f,l,null,u,I),T,ja,ua=>0===ua.StatusCode);this.yI.sia(a,this.Yb)}JEl(a,
b,c){var f=void 0;f=void 0===f?null:f;c=void 0===c?null:c;a=new Kh.a(new Lk(a,b),f,c,l=>0===l.StatusCode);this.yI.sia(a,this.Yb)}Gsj(a,b,c,f,l,u,I,T,ja,ua){ja=void 0===ja?null:ja;ua=void 0===ua?null:ua;a=new Kh.a(new Ni(a,b,c,f,l,u,74,74,I,T),ja,ua,Ra=>0===Ra.StatusCode);this.yI.sia(a,this.Yb)}augmentImage(a,b,c,f,l,u,I,T,ja){T=void 0===T?null:T;ja=void 0===ja?null:ja;a=new Kh.a(new Vm(a,b,c,f,l,u,I),T,ja,ua=>0===ua.StatusCode);this.yI.sia(a,this.Yb)}generateAgendaSuggestion(a,b,c,f,l,u,I){u=void 0===
u?null:u;I=void 0===I?null:I;a=new Kh.a(new jl(a,b,c,f,l),u,I,T=>0===T.StatusCode);this.yI.sia(a,this.Yb)}generateAgendaDeckSuggestion(a,b,c,f,l,u,I,T){I=void 0===I?null:I;T=void 0===T?null:T;a=new Kh.a(new fm(a,b,c,f,l,u),I,T,ja=>0===ja.StatusCode);this.yI.sia(a,this.Yb)}V1h(a,b,c,f,l){f=void 0===f?null:f;l=void 0===l?null:l;const u=new Kh.a(new Vq(a,b,c),f,l,ja=>0===ja.StatusCode),I=()=>{this.ijj(u)};a=this.yI.jBb(this.Yb.Of);const T=new Im.a;a?a.forceOutbound(()=>{I()},l?()=>{l(T)}:null,null):
(ya.a.J(509084637,823,10,"Can't find graph space replicator when trying to do outbound"),l&&l(T))}flush(a,b){a=void 0===a?null:a;b=void 0===b?null:b;a=new Kh.a(new Lh,a,b,c=>0===c.StatusCode,3);this.yI.Iua(a)}Iua(a){this.yI.Iua(a)}v_c(){return this.jBb(this.Yb.Of)}ijj(a){this.oOg.Jb(a);this.oOg.forceOutbound(null,null,null)}}Object(m.a)(Vi,"OutboundHelper",null,[131,39,201]);var al=d(266),Km=d(172);class Bl{constructor(a,b,c,f,l){this.oN=[];this.Rhb=new al.a;this.Gkd=null;this.JLg=[];this.N6=null;
this.ua=new uc.a;this.lSg=this.UIb=this.jkd=!1;this.Tb=a;this.ka=b;this.sa=c;this.VQk=l;this.Lxa=f;this.$Mk=this.ka.owa?1:4;f.Ak(Object(R.a)(this,this.jpd,"onMainMastersLoaded"));this.ka.owa&&f.Ak(Object(R.a)(this,this.Vnh,"onMasterIdListChanged"))}get wWk(){if(this.ka.owa&&this.sa.Aa){const a=this.sa.Aa.Oj;a&&Array.contains(this.oN,a)&&this.KRe(a)}return this.oN.slice(0,Math.min(this.$Mk,this.oN.length))}Izl(a){Array.remove(this.oN,a)}get O8l(){return this.Gkd}get dQ(){return this.Rhb}get t2b(){return this.JLg}get P7j(){return!this.Gkd}get sfl(){return 0<
this.oN.length&&(!this.ka.iYa||this.jkd)}get fSe(){return this.UIb}set fSe(a){this.UIb=a}m5l(a){a&&this.B_h(a.Oj)}sUh(){this.jkd=!0;this.Kud(!0);this.dQb()}B_h(a){this.jkd=!0;a&&(Array.remove(this.oN,a),Array.insert(this.oN,0,a));this.dQb()}Gbf(a){this.ka.owa?this.B_h(a):this.sUh()}plg(a){if(!a||!this.Rhb)return null;const b=a.Oj;if(!b)return null;let c=null;return(()=>{let f=this.Rhb.Eg(b);({value:c}=f);return f})().returnValue?c:null}Vnh(a,b){b.property.id===yb.a.amd.id&&(ya.a.J(38847373,824,50,
"MasterIdList update, need load master id list: {0}",this.UIb),this.UIb&&(this.UIb=!1,this.jkd&&(this.Kud(!1),this.dQb())),this.fWf())}jpd(a,b){a=b.property;if(this.ka.owa)if(a.id===yb.a.cLb.id){a=this.Tb.aEj();const f=this.Tb.YJ();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],u=f[c];l.Id<u.Id?(this.d2h(l.Id),b++):u.Id<l.Id?(this.Lhf(u.Id),c++):(Fe.c(l)!==Fe.c(u)&&this.Thm(u.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.Lhf(f[c].Id);if(b<a.length)for(;b<
a.length;b++)this.d2h(a[b].Id);this.dQb()}else Km.b(f,null,l=>{this.Lhf(l.Id)})}else a.id===yb.a.b_.id&&(ya.a.J(38847375,824,50,"Slide size changed, need to reload the resources."),this.Kud(!0),this.dQb());else if(a.id===yb.a.cLb.id||a.id===yb.a.b_.id)ya.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.Kud(!0),this.dQb()}Lhf(a){this.KRe(a)}Thm(a){this.KRe(a)}KRe(a){Array.contains(this.oN,a)&&Array.remove(this.oN,a);Array.insert(this.oN,0,a)}d2h(a){this.Rhb.remove(a);
-1!==Array.indexOf(this.oN,a)&&Array.remove(this.oN,a)}dQb(){this.N6=this.N6||this.VQk(this);this.N6.HG(null,null,null)}Kud(a){if(this.ka.owa){ya.a.J(38847378,824,50,"RefreshMastersToLoad, need clean cache: {0} ",a);var b=this.Tb.DAb();a&&(Array.clear(this.oN),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.oN,c.idField)&&Array.add(this.oN,c.idField);else this.UIb=!0,(a=this.Tb.oy(0))&&(a=a.Oj)&&Array.add(this.oN,a)}else if(a=this.Tb.YJ(),Array.clear(this.oN),this.clearCache(),
a)for(b of a)this.Rhb.remove(b.Id),-1===Array.indexOf(this.oN,b.Id)&&Array.add(this.oN,b.Id)}Z6k(a){if(a){for(const b of a)b&&(ya.a.J(38847381,824,50,"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",b.MasterId),this.Rhb.$(b.MasterId,b),this.Gkd=this.Gkd||b.TableStyleGallery,this.ka.owa||Array.remove(this.oN,b.MasterId));this.fWf();this.ua.raiseEvent("MainMasterResourcesLoaded")}else ya.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}fWf(){!this.lSg&&
this.XPf()&&(this.lSg=!0,ya.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),md.a("RaiseFirstMasterRetrievedEvent")&&this.ua.raiseEvent("FirstMasterRetrieved"))}Y1k(a){this.ka.powerPointEnableAccCheck&&(a&&a.length?(this.JLg=a,this.ua.raiseEvent("AccCheckRuleInfoListLoaded")):ya.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}XPf(){if(!this.ka.owa)return!0;
const a=this.Tb.DAb();if(a&&0<a.length)for(const b of this.Tb.DAb())if(0<b.layoutCountField&&this.dQ.Ib(b.idField)&&this.dQ.ga(b.idField).LayoutIcons.length===b.layoutCountField)return ya.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",b.idField,b.layoutCountField),!0;return!1}nOc(a){this.ua.addHandler("MainMasterResourcesLoaded",a)}DBl(a){this.ua.removeHandler("MainMasterResourcesLoaded",a)}Xyi(a){this.ua.addHandler("FirstMasterRetrieved",a)}pyi(a){this.ua.addHandler("AccCheckRuleInfoListLoaded",
a)}YAl(a){this.ua.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.Rhb=new al.a}dispose(){this.Lxa.tn(Object(R.a)(this,this.jpd,"onMainMastersLoaded"));this.ka.owa&&this.Lxa.tn(Object(R.a)(this,this.Vnh,"onMasterIdListChanged"));this.ua.dispose();this.N6&&this.N6.dispose()}}Object(m.a)(Bl,"PresentationResourcesManager",null,[133,106]);var Xj=d(397);class Xm extends Yg.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}om(){return 52}static r6d(a,
b,c){const f=new Xm;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(m.a)(Xm,"GetEditPresResourcesRequest",Yg.a,[]);class Vl extends Xj.a{constructor(a,b,c,f){super();this.DGb=0;this.qib=this.f6=!1;this.Kn=a;this.P_a=b;this.jZ=f;this.enabled=2;this.Rx=c.f3i();this.Kn.register(this)}HG(){this.Rx.Eqj();this.Rx.Odb();this.Kn.dca()}forceOutbound(){}Nma(){return this.P_a.sfl||this.P_a.fSe}cP(){return!1}NWa(){return this.ge&&2===this.ge.status?!0:this.f6||this.qib?!1:this.Nma()&&
this.Rx.Fcc()}DPb(){if(1===this._state){var a=this.P_a.wWk;this.ge.hL=Xm.r6d(a,this.P_a.P7j,this.P_a.fSe);for(const b of a)this.P_a.Izl(b);this.ge.status=1;this._state=3}else 3===this._state&&this.ge&&2===this.ge.status&&(this.qib?(this._state=4,this.dispose()):(200===this.ge.lu&&this.jZ.bwc(),this.Rx.POa(),2!==this.ge.statusCode?this.VI():this.ge.Sv&&1===this.ge.Sv.length?(a=this.ge.Sv[0],0===a.StatusCode?(this.P_a.Z6k(Fe.a(a.MainMasterResources)),this.P_a.Y1k(Fe.a(a.AccRuleInfoList)),this.I2()):
this.VI()):this.VI()))}get Lea(){return this.Nma()?this.Rx.Omb():super.Lea}dispose(){1===this._state||4===this._state?(this.f6||this.Kn.unregister(this),this.f6=!0):this.qib=!0}I2(){this.DGb=0;this._state=1;this.Nma()||this.Rx.Y3a()}VI(){4<++this.DGb?(this._state=4,ya.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.DGb)):(ya.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(m.a)(Vl,"PresentationResourcesReplicator",
Xj.a,[106]);class Mh{constructor(a,b){this.gRk=a;this.PV=b}Z8k(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.dAa;let c=null,f=!1;for(const l of this.gRk)if(l.FZ(a)){if(!c&&(c=this.PV.FGa(b),!c)){ya.a.J(23594507,817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.PV.pZd(b,a,c)}}Object(m.a)(Mh,"RevisionMetaDataUpdateListener",null,[135]);var In=d(423);class Cl{FGa(a){if(!a)return null;const b=a.DM(4);return b&&!b.equals(Ua.a.nil)?a.Ie(b):new In.a}Uhf(a,b,c,
f,l,u,I,T,ja){if(a&&f){a.Vo.apply(a,Cl.cJl);a.setValue(yb.a.rEg,b);a.setValue(yb.a.xdc,!0);a.setValue(yb.a.swd,1);a.setValue(yb.a.sid,f.sid);a.setValue(yb.a.cid,f.cid);c&&a.setValue(yb.a.MHa,!0);l&&a.setValue(yb.a.shapeId,l.get_shapeId());u&&(a.setValue(yb.a.Nq,!0),a.setValue(yb.a.KWh,u.cellId),a.setValue(yb.a.rowId,u.rowId));if(I&&0<I.length){b=I.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=I[l].rowId,f[l]=I[l].cellId;a.setValue(yb.a.Nq,!0);a.setValue(yb.a.ipb,f);a.setValue(yb.a.XWh,c)}a.setValue(yb.a.oef,
T);a.setValue(yb.a.nef,ja)}}pZd(a,b,c){if(a&&b&&c){var f=!1;a.Ie(Cl.mia)||(a.NF(c,Cl.mia),f=!0);b.sta(c);f&&b.yAa(c.id,4)}}t3h(a,b){if(a){var c=a.dAa,f=this.FGa(c);f.setValue(yb.a.swd,b);this.pZd(c,a,f)}}Tjm(a){if(a){var b=a.dAa,c=this.FGa(b);c.setValue(yb.a.OHl,0);this.pZd(b,a,c)}}}Cl.mia=Ua.a.Tf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");Cl.cJl=[yb.a.rEg,yb.a.shapeId,yb.a.Nq,yb.a.MHa,yb.a.KWh,yb.a.rowId,yb.a.ipb,yb.a.XWh,yb.a.oef,yb.a.nef];Object(m.a)(Cl,"RevisionMetadataHelper",null,[659]);var Dl=
d(675),Do=d(872);class qo extends Yg.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=f}om(){return 32}}Object(m.a)(qo,"SaveAndCloseRequest",Yg.a,[]);class Be{constructor(a,b,c,f,l,u,I,T,ja){this.Qi=a;this.pjd=b;this.$D=c;this.Xa=f;this.ka=l;this.uB=u;this.fe=I;this.rc=T;this.Kn=ja}Gqj(a){this.Xa.REb=!0;a=new qo(!0,!1,a,this.Xa.podSessionId);
this.fe.Rma=!0;const b=this.Qi.v_c();b&&b.cP()&&this.rc.fp?this.ka.iFa?(da.ULS.sendTraceTag(509436876,844,50,"SaveAndCloseHandler: forceSaveOnUnload - application is unloading, forceOutbound to save any remaining changes."),b.forceOutbound(null,null,null),this.pjd.qce(a,null,null)):b.Gbb(null,null,null,a):this.pjd.qce(a,null,null)}b$(a,b,c,f,l){var u=!0;a=void 0===a?!1:a;u=void 0===u?!0:u;b=void 0===b?!0:b;c=void 0===c?null:c;f=void 0===f?null:f;l=void 0===l?1:l;ya.a.J(509691458,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",
a,u,b);const I=new qo(a,u,l,this.Xa.podSessionId);if(a&&this.ka.markSessionClosingAtForceSave)this.uB.markSessionClosingAtForceSave(l),this.Kn.pause(),this.pjd.Gbb(I,T=>{ya.a.J(509691457,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.ka.$$f?this.uB.closeSession(l):this.$D.pud(new Dl.a(l));c(T)},()=>{ya.a.J(509691456,823,15,"SaveAndCloseHandler::ForceSave Failed.");this.Kn.Zpb();f&&f(null);return!0});else{a=this.Qi.v_c();const T=ja=>{this.w5k(I,c,f,ua=>0===ua.StatusCode,ja,
b,l)};a?a.forceOutbound(()=>{T(!0)},()=>{T(!1)},null):(ya.a.J(509691427,823,10,"Can't find graph space replicator when trying to do outbound"),T(!1))}}w5k(a,b,c,f,l,u,I){ya.a.J(509691426,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",a.ShouldReleaseLock,l,u);l&&u||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.fe.Rma=!0),this.pjd.Iua(a,T=>{a.ShouldReleaseLock&&(this.ka.$$f?this.uB.closeSession(I):this.$D.pud(new Dl.a(I)));
b(T)},c,f)):l&&b?b(new Do.a):!l&&c&&c(new Im.a)}}Object(m.a)(Be,"SaveAndCloseHandler",null,[132]);var Lm=d(1068),Ii=d(106);class $o{constructor(a,b,c,f){this.Qi=a;this.LPe=b;this.Foc=c;this.Eya=f}FZ(a){let b=null,c=!0;if(this.Qi.t6c)b=a.kua,c=!1;else if(this.LPe.Wc===G.a.Nz||this.LPe.Wc===G.a.rEa||this.LPe.Wc===G.a.nUa)b=a.kua;b&&(this.Eya&&this.R7i(b.toString()),$c.a.iIa(),this.Foc.cZh(b,c),ya.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.kua.toString(),$c.a.Ef(new Date)));return!1}update(){}R7i(a){const b=
new Lm.ActionContext(Ii.a.y0h,1,null);b.tk=!0;b.xG=new Date;b.Wa(Ii.a.d_,$c.a.Kcb(a).toString());b.gq=!0;$c.a.Y2(b)}}Object(m.a)($o,"TextEditingRevisionInfoMetaDataUpdater",null,[192]);class Eo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}fc(a){this.K=a;const b=()=>new Dn.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").X6b(a.resolve("Box4.IReplicationParameters")),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>A.AFrameworkApplication.Dh);a.register(131,"PowerPointWebEditor.Storage.IOutboundHelper").ma().na(()=>new Vi(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(132,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().na(()=>new Be(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),
a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(133,"PowerPointWebEditor.IPresentationResourcesManager").ma().na(()=>new Bl(a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),c=>new Vl(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.XYi()}XYi(){this.K.register(Cl,"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();
this.K.register(Hn,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(134,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().na(()=>new $k(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));this.K.register(135,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().na(()=>new Mh([new Co(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),
jn.DJg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new $o(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),
this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){C.a.instance.Ac(new Eo)}}Object(m.a)(Eo,"PPTWebEditorStoragePackage",null,[2,3]);class Dc{constructor(a,b,c){this.M9h=
a;this.vci=b;this.oni=c}get LCID(){return this.M9h}get RKl(){return this.oni}get F2f(){return this.vci}get Due(){return!!(this.F2f&Dc.G7h)}get Aec(){return!!(this.F2f&Dc.H7h)}static K4c(){Dc.X5e={["20490"]:new Dc(20490,4215112,"Latn"),["8251"]:new Dc(8251,4215112,"Latn"),["17418"]:new Dc(17418,4215112,"Latn"),["17417"]:new Dc(17417,4215112,"Latn"),["8218"]:new Dc(8218,4215304,"Cyrl"),["8204"]:new Dc(8204,4215112,"Latn"),["8202"]:new Dc(8202,4215112,"Latn"),["8201"]:new Dc(8201,4215112,"Latn"),["8193"]:new Dc(8193,
4493640,"Arab"),["6154"]:new Dc(6154,4215112,"Latn"),["7227"]:new Dc(7227,4215112,"Latn"),["19466"]:new Dc(19466,4215112,"Latn"),["16394"]:new Dc(16394,4215112,"Latn"),["16393"]:new Dc(16393,4215112,"Latn"),["16385"]:new Dc(16385,4493640,"Arab"),["7194"]:new Dc(7194,4215048,"Cyrl"),["7180"]:new Dc(7180,20808,"Latn"),["7178"]:new Dc(7178,4215112,"Latn"),["7177"]:new Dc(7177,4215112,"Latn"),["7169"]:new Dc(7169,4493640,"Arab"),["12289"]:new Dc(12289,4493640,"Arab"),["6203"]:new Dc(6203,4215080,"Latn"),
["15372"]:new Dc(15372,4215112,"Latn"),["15370"]:new Dc(15370,4215112,"Latn"),["15369"]:new Dc(15369,4215112,"Latn"),["15361"]:new Dc(15361,4493640,"Arab"),["6170"]:new Dc(6170,4215304,"Latn"),["6156"]:new Dc(6156,4215112,"Latn"),["18442"]:new Dc(18442,4215112,"Latn"),["6153"]:new Dc(6153,4215112,"Latn"),["6145"]:new Dc(6145,4493640,"Arab"),["4155"]:new Dc(4155,4215080,"Latn"),["11274"]:new Dc(11274,4215112,"Latn"),["5179"]:new Dc(5179,4215112,"Latn"),["14348"]:new Dc(14348,4215112,"Latn"),["14346"]:new Dc(14346,
4215112,"Latn"),["14345"]:new Dc(14345,20808,"Latn"),["14337"]:new Dc(14337,4493640,"Arab"),["5146"]:new Dc(5146,4215048,"Latn"),["5132"]:new Dc(5132,4215112,"Latn"),["5130"]:new Dc(5130,4215112,"Latn"),["5129"]:new Dc(5129,4215112,"Latn"),["5127"]:new Dc(5127,4215112,"Latn"),["5124"]:new Dc(5124,4281672,"Hant"),["5121"]:new Dc(5121,4493640,"Arab"),["31770"]:new Dc(31770,4210820,""),["31748"]:new Dc(31748,4277380,""),["10266"]:new Dc(10266,4215048,"Cyrl"),["10252"]:new Dc(10252,4215112,"Latn"),["10250"]:new Dc(10250,
4215112,"Latn"),["10249"]:new Dc(10249,4215112,"Latn"),["13324"]:new Dc(13324,4215112,"Latn"),["13322"]:new Dc(13322,4215112,"Latn"),["13321"]:new Dc(13321,4215112,"Latn"),["10241"]:new Dc(10241,4493640,"Arab"),["13313"]:new Dc(13313,4493640,"Arab"),["4122"]:new Dc(4122,4215048,"Latn"),["4108"]:new Dc(4108,4215112,"Latn"),["4106"]:new Dc(4106,4215112,"Latn"),["4105"]:new Dc(4105,4215112,"Latn"),["4103"]:new Dc(4103,4215112,"Latn"),["4100"]:new Dc(4100,4282696,"Hans"),["3179"]:new Dc(3179,4215048,
"Latn"),["4097"]:new Dc(4097,4493640,"Arab"),["1085"]:new Dc(1085,299432,"Hebr"),["1144"]:new Dc(1144,4280616,"Yiii"),["21514"]:new Dc(21514,4215112,"Latn"),["2145"]:new Dc(2145,5132616,"Deva"),["3131"]:new Dc(3131,4215112,"Latn"),["2143"]:new Dc(2143,4215432,"Latn"),["12314"]:new Dc(12314,4215048,"Cyrl"),["1070"]:new Dc(1070,4215080,"Latn"),["1130"]:new Dc(1130,4215080,"Latn"),["12300"]:new Dc(12300,4215112,"Latn"),["1091"]:new Dc(1091,4215080,"Latn"),["12298"]:new Dc(12298,4215112,"Latn"),["12297"]:new Dc(12297,
4215112,"Latn"),["2055"]:new Dc(2055,4215112,"Latn"),["2052"]:new Dc(2052,4282664,"Hans"),["2115"]:new Dc(2115,4215368,"Cyrl"),["9242"]:new Dc(9242,4215304,"Latn"),["3098"]:new Dc(3098,4215048,"Cyrl"),["2107"]:new Dc(2107,4215112,"Latn"),["9228"]:new Dc(9228,4215112,"Latn"),["3084"]:new Dc(3084,4215112,"Latn"),["9226"]:new Dc(9226,4215112,"Latn"),["3082"]:new Dc(3082,4215080,"Latn"),["3081"]:new Dc(3081,4215112,"Latn"),["2094"]:new Dc(2094,4215080,"Latn"),["3079"]:new Dc(3079,4215112,"Latn"),["2092"]:new Dc(2092,
4215368,"Cyrl"),["1064"]:new Dc(1064,4215080,"Cyrl"),["3076"]:new Dc(3076,4281640,"Hant"),["2155"]:new Dc(2155,4215048,"Latn"),["3073"]:new Dc(3073,4493640,"Arab"),["1153"]:new Dc(1153,4215080,"Latn"),["1119"]:new Dc(1119,299400,"Arab"),["1086"]:new Dc(1086,4215080,"Latn"),["2144"]:new Dc(2144,938632,"Deva"),["2077"]:new Dc(2077,4215112,"Latn"),["1053"]:new Dc(1053,4215080,"Latn"),["2141"]:new Dc(2141,4215336,"Latn"),["2074"]:new Dc(2074,4215304,"Latn"),["2073"]:new Dc(2073,20808,"Cyrl"),["2072"]:new Dc(2072,
4215112,"Latn"),["2137"]:new Dc(2137,4493896,"Arab"),["2070"]:new Dc(2070,4215048,"Latn"),["2068"]:new Dc(2068,4215048,"Latn"),["2067"]:new Dc(2067,4215112,"Latn"),["1073"]:new Dc(1073,4215080,"Latn"),["2064"]:new Dc(2064,4215112,"Latn"),["2129"]:new Dc(2129,414016,"Tibt"),["2128"]:new Dc(2128,4608584,"Mong"),["2060"]:new Dc(2060,4215112,"Latn"),["1132"]:new Dc(1132,4215080,"Latn"),["1097"]:new Dc(1097,5132584,"Taml"),["2057"]:new Dc(2057,4215080,"Latn"),["1164"]:new Dc(1164,4493608,"Arab"),["106"]:new Dc(106,
4210820,""),["2118"]:new Dc(2118,4493640,"Arab"),["2117"]:new Dc(2117,5132584,"Beng"),["2049"]:new Dc(2049,4493640,"Arab"),["1156"]:new Dc(1156,4215080,"Latn"),["2110"]:new Dc(2110,4215112,"Latn"),["1054"]:new Dc(1054,4608296,"Thai"),["2108"]:new Dc(2108,4215048,"Latn"),["1083"]:new Dc(1083,4215080,"Latn"),["136"]:new Dc(136,4210820,""),["1114"]:new Dc(1114,4493608,"Syrc"),["1148"]:new Dc(1148,4215080,"Latn"),["1145"]:new Dc(1145,20776,"Latn"),["11290"]:new Dc(11290,4215304,"Latn"),["1075"]:new Dc(1075,
20776,"Latn"),["1106"]:new Dc(1106,4215080,"Latn"),["1140"]:new Dc(1140,4215080,"Latn"),["120"]:new Dc(120,4276356,""),["1136"]:new Dc(1136,4215080,"Latn"),["1066"]:new Dc(1066,4215080,"Latn"),["1098"]:new Dc(1098,5132584,"Telu"),["1169"]:new Dc(1169,4215048,"Latn"),["11276"]:new Dc(11276,4215112,"Latn"),["61"]:new Dc(61,295044,"Hebr"),["1060"]:new Dc(1060,4215080,"Latn"),["11273"]:new Dc(11273,4215112,"Latn"),["1058"]:new Dc(1058,4215080,"Cyrl"),["128"]:new Dc(128,4489348,""),["1160"]:new Dc(1160,
4215080,"Latn"),["1159"]:new Dc(1159,4215080,"Latn"),["1158"]:new Dc(1158,20776,"Latn"),["1157"]:new Dc(1157,4215080,"Cyrl"),["11265"]:new Dc(11265,4493640,"Arab"),["1155"]:new Dc(1155,4215080,"Latn"),["1154"]:new Dc(1154,4215080,"Latn"),["1117"]:new Dc(1117,4215080,"Cans"),["1152"]:new Dc(1152,4493608,"Arab"),["1115"]:new Dc(1115,5132584,"Sinh"),["1150"]:new Dc(1150,4215080,"Latn"),["1113"]:new Dc(1113,938280,"Deva"),["1112"]:new Dc(1112,938280,"Beng"),["51"]:new Dc(51,16516,""),["1146"]:new Dc(1146,
4215080,"Latn"),["1109"]:new Dc(1109,5132584,"Mymr"),["115"]:new Dc(115,4210820,""),["1143"]:new Dc(1143,4215080,"Latn"),["1142"]:new Dc(1142,20872,"Latn"),["1141"]:new Dc(1141,4215080,"Latn"),["1104"]:new Dc(1104,4215080,"Cyrl"),["2058"]:new Dc(2058,4215112,"Latn"),["1102"]:new Dc(1102,5132584,"Deva"),["1137"]:new Dc(1137,20776,"Latn"),["1100"]:new Dc(1100,5132584,"Mlym"),["1135"]:new Dc(1135,4215080,"Latn"),["1134"]:new Dc(1134,4215080,"Latn"),["1133"]:new Dc(1133,4215080,"Cyrl"),["1096"]:new Dc(1096,
5132584,"Orya"),["1131"]:new Dc(1131,4215048,"Latn"),["1094"]:new Dc(1094,5132584,"Guru"),["1129"]:new Dc(1129,20872,"Latn"),["1128"]:new Dc(1128,4215080,"Latn"),["1127"]:new Dc(1127,20776,"Latn"),["1126"]:new Dc(1126,20776,"Latn"),["1125"]:new Dc(1125,4493608,"Thaa"),["1124"]:new Dc(1124,4215080,"Latn"),["1123"]:new Dc(1123,4493608,"Arab"),["1122"]:new Dc(1122,4215080,"Latn"),["1121"]:new Dc(1121,5132584,"Deva"),["1120"]:new Dc(1120,299400,"Arab"),["1118"]:new Dc(1118,4215080,"Ethi"),["1082"]:new Dc(1082,
4215080,"Latn"),["1116"]:new Dc(1116,4215080,"Cher"),["1080"]:new Dc(1080,4215080,"Latn"),["1079"]:new Dc(1079,4215080,"Geor"),["1078"]:new Dc(1078,4215080,"Latn"),["1077"]:new Dc(1077,4215080,"Latn"),["1111"]:new Dc(1111,5132584,"Deva"),["1110"]:new Dc(1110,4215080,"Latn"),["1074"]:new Dc(1074,4215080,"Latn"),["1108"]:new Dc(1108,4608296,"Laoo"),["1107"]:new Dc(1107,4608296,"Khmr"),["1071"]:new Dc(1071,4215080,"Cyrl"),["1105"]:new Dc(1105,4608296,"Tibt"),["1069"]:new Dc(1069,4215080,"Latn"),["1103"]:new Dc(1103,
5132584,"Deva"),["1067"]:new Dc(1067,4215080,"Armn"),["1101"]:new Dc(1101,5132584,"Beng"),["1065"]:new Dc(1065,4493608,"Arab"),["1099"]:new Dc(1099,5132584,"Knda"),["1063"]:new Dc(1063,4215080,"Latn"),["1062"]:new Dc(1062,4215080,"Latn"),["1061"]:new Dc(1061,4215080,"Latn"),["1095"]:new Dc(1095,5132584,"Gujr"),["1059"]:new Dc(1059,4215080,"Cyrl"),["1093"]:new Dc(1093,5132584,"Beng"),["1092"]:new Dc(1092,4215080,"Cyrl"),["1056"]:new Dc(1056,4493608,"Arab"),["1090"]:new Dc(1090,4215080,"Latn"),["1089"]:new Dc(1089,
4215080,"Latn"),["1088"]:new Dc(1088,4215080,"Cyrl"),["1087"]:new Dc(1087,4215080,"Cyrl"),["1052"]:new Dc(1052,4215080,"Latn"),["1051"]:new Dc(1051,4215080,"Latn"),["1050"]:new Dc(1050,4215048,"Latn"),["1049"]:new Dc(1049,4215080,"Cyrl"),["1048"]:new Dc(1048,4215080,"Latn"),["1081"]:new Dc(1081,5132584,"Deva"),["1046"]:new Dc(1046,4215048,"Latn"),["1045"]:new Dc(1045,4215080,"Latn"),["1044"]:new Dc(1044,4215048,"Latn"),["1043"]:new Dc(1043,4215080,"Latn"),["1076"]:new Dc(1076,4215080,"Latn"),["1041"]:new Dc(1041,
4280616,"Jpan"),["1040"]:new Dc(1040,4215080,"Latn"),["119"]:new Dc(119,4210820,""),["1072"]:new Dc(1072,4215176,"Latn"),["1037"]:new Dc(1037,4493608,"Hebr"),["1036"]:new Dc(1036,4215080,"Latn"),["1035"]:new Dc(1035,4215080,"Latn"),["1068"]:new Dc(1068,4215080,"Latn"),["1033"]:new Dc(1033,4215048,"Latn"),["1032"]:new Dc(1032,4215080,"Grek"),["1031"]:new Dc(1031,4215080,"Latn"),["1030"]:new Dc(1030,4215080,"Latn"),["1029"]:new Dc(1029,4215080,"Latn"),["1028"]:new Dc(1028,4281672,"Hant"),["1027"]:new Dc(1027,
4215080,"Latn"),["1026"]:new Dc(1026,4215080,"Cyrl"),["140"]:new Dc(140,4489348,""),["1057"]:new Dc(1057,4215080,"Latn"),["50"]:new Dc(50,4210820,""),["1055"]:new Dc(1055,4215080,"Latn"),["135"]:new Dc(135,4210820,""),["134"]:new Dc(134,16516,""),["133"]:new Dc(133,4210820,""),["132"]:new Dc(132,4210820,""),["131"]:new Dc(131,4210820,""),["130"]:new Dc(130,4210820,""),["129"]:new Dc(129,4210820,""),["1047"]:new Dc(1047,4215080,"Latn"),["126"]:new Dc(126,4210820,""),["89"]:new Dc(89,5128324,""),["124"]:new Dc(124,
4210820,""),["1042"]:new Dc(1042,4280616,"Hang"),["122"]:new Dc(122,4210820,""),["121"]:new Dc(121,16516,""),["1039"]:new Dc(1039,4215080,"Latn"),["1038"]:new Dc(1038,4215080,"Latn"),["118"]:new Dc(118,16516,""),["117"]:new Dc(117,4210820,""),["116"]:new Dc(116,4210820,""),["1034"]:new Dc(1034,4219176,"Latn"),["114"]:new Dc(114,4210820,""),["113"]:new Dc(113,16516,""),["112"]:new Dc(112,4210820,""),["111"]:new Dc(111,4210820,""),["110"]:new Dc(110,4210820,""),["109"]:new Dc(109,4210820,""),["108"]:new Dc(108,
4210820,""),["107"]:new Dc(107,4210820,""),["1025"]:new Dc(1025,4493608,"Arab"),["105"]:new Dc(105,16516,""),["104"]:new Dc(104,4210820,""),["103"]:new Dc(103,4210820,""),["102"]:new Dc(102,16516,""),["101"]:new Dc(101,4489348,""),["100"]:new Dc(100,4210820,""),["99"]:new Dc(99,4489348,""),["98"]:new Dc(98,4210820,""),["97"]:new Dc(97,5128324,""),["96"]:new Dc(96,966788,""),["95"]:new Dc(95,4505732,""),["94"]:new Dc(94,4210820,""),["93"]:new Dc(93,4210820,""),["92"]:new Dc(92,4210820,""),["91"]:new Dc(91,
5128324,""),["90"]:new Dc(90,4489348,""),["85"]:new Dc(85,5128324,""),["88"]:new Dc(88,934020,""),["87"]:new Dc(87,5128324,""),["86"]:new Dc(86,4210820,""),["9275"]:new Dc(9275,4215112,"Latn"),["84"]:new Dc(84,4604036,""),["83"]:new Dc(83,4604036,""),["82"]:new Dc(82,4210820,""),["81"]:new Dc(81,4604036,""),["80"]:new Dc(80,4604036,""),["79"]:new Dc(79,5128324,""),["78"]:new Dc(78,5128324,""),["77"]:new Dc(77,5128324,""),["76"]:new Dc(76,5128324,""),["75"]:new Dc(75,5128324,""),["74"]:new Dc(74,5128324,
""),["73"]:new Dc(73,5128324,""),["72"]:new Dc(72,4210820,""),["71"]:new Dc(71,4210820,""),["70"]:new Dc(70,5128324,""),["69"]:new Dc(69,5128324,""),["68"]:new Dc(68,4210820,""),["67"]:new Dc(67,4210820,""),["66"]:new Dc(66,4210820,""),["65"]:new Dc(65,4210820,""),["64"]:new Dc(64,4210820,""),["63"]:new Dc(63,4210820,""),["62"]:new Dc(62,4210820,""),["18441"]:new Dc(18441,4215112,"Latn"),["59"]:new Dc(59,4210820,""),["58"]:new Dc(58,4210820,""),["57"]:new Dc(57,5128324,""),["56"]:new Dc(56,4210820,
""),["55"]:new Dc(55,4210820,""),["54"]:new Dc(54,4210820,""),["53"]:new Dc(53,4210820,""),["52"]:new Dc(52,4210820,""),["31"]:new Dc(31,4210820,""),["47"]:new Dc(47,4210820,""),["49"]:new Dc(49,4210820,""),["48"]:new Dc(48,4210820,""),["44"]:new Dc(44,4210820,""),["46"]:new Dc(46,4210820,""),["45"]:new Dc(45,4210820,""),["41"]:new Dc(41,4489348,""),["43"]:new Dc(43,4210820,""),["42"]:new Dc(42,4210820,""),["38"]:new Dc(38,4210820,""),["40"]:new Dc(40,4210820,""),["39"]:new Dc(39,4210820,""),["35"]:new Dc(35,
4210820,""),["37"]:new Dc(37,4210820,""),["36"]:new Dc(36,4210820,""),["9225"]:new Dc(9225,4215112,"Latn"),["34"]:new Dc(34,4210820,""),["33"]:new Dc(33,4210820,""),["32"]:new Dc(32,4489348,""),["29"]:new Dc(29,4210820,""),["30"]:new Dc(30,4604036,""),["27"]:new Dc(27,4210820,""),["28"]:new Dc(28,4210820,""),["9217"]:new Dc(9217,4493640,"Arab"),["26"]:new Dc(26,4210820,""),["25"]:new Dc(25,4210820,""),["24"]:new Dc(24,4210820,""),["23"]:new Dc(23,4210820,""),["22"]:new Dc(22,4210820,""),["21"]:new Dc(21,
4210820,""),["20"]:new Dc(20,4210820,""),["19"]:new Dc(19,4210820,"Latn"),["18"]:new Dc(18,4276356,""),["17"]:new Dc(17,4276356,""),["16"]:new Dc(16,4210820,""),["15"]:new Dc(15,4210820,""),["14"]:new Dc(14,4210820,""),["13"]:new Dc(13,4489348,""),["12"]:new Dc(12,4210820,""),["11"]:new Dc(11,4210820,""),["10"]:new Dc(10,4210820,""),["9"]:new Dc(9,4210820,""),["8"]:new Dc(8,4210820,""),["7"]:new Dc(7,4210820,""),["6"]:new Dc(6,4210820,""),["5"]:new Dc(5,4210820,""),["4"]:new Dc(4,4278404,""),["3"]:new Dc(3,
4210820,""),["2"]:new Dc(2,4210820,""),["1"]:new Dc(1,4489348,""),["0"]:new Dc(0,1,"")}}static Oe(a){Dc.X5e||Dc.K4c();return Dc.X5e[a.toString()]}}Dc.X5e=null;Dc.G7h=262144;Dc.H7h=65536;Object(m.a)(Dc,"ExtendedCultureInfo",null,[]);class Kj{rW(a,b){var c=a.ra(rb.a.pu,1033);Ea.a.Oe(c)&&(c=Dc.Oe(c))&&(c.Aec?a.setValue(yb.a.eastAsianFont,b):c.Due&&a.setValue(yb.a.complexScriptFont,b));a.setValue(yb.a.latinFont,b)}static eXi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.He(rb.a.subscript,!0):
0<b.baselineField?a.He(rb.a.superscript,!0):(a.He(rb.a.subscript,!1),a.He(rb.a.superscript,!1)));b.bFieldSpecified&&a.He(rb.a.bold,b.bField);b.noProofFieldSpecified&&a.He(ib.a.noProof,b.noProofField);b.iFieldSpecified&&a.He(rb.a.italic,b.iField);b.strikeFieldSpecified&&a.He(rb.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.He(rb.a.underline,b.uField);if(b.langField){var f=Ea.a.Oe(b.langField);f?a.He(rb.a.pu,f.LCID):ya.a.J(508692678,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+
b.langField)}b.altLangField&&((f=Ea.a.Oe(b.altLangField))?a.He(yb.a.$Oc,f.LCID):ya.a.J(508692677,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.altLangField));b.hlinkClickField&&(a.He(rb.a.ou,!0),a.He(rb.a.n1,!0));Kj.hXi(a,b,c)}static s_f(a){a>dk.a.gmd?a=dk.a.gmd:a<dk.a.Amd&&(a=dk.a.Amd);return Kj.Sfj(a)}static hXi(a,b,c){b.szFieldSpecified&&a.He(rb.a.fontSize,Kj.s_f(b.szField));(c=Ze.Box4ColorHelper.KPb(b,c))&&a.setValue(rb.a.fontColor,c.DE);b.latinField&&
a.He(yb.a.latinFont,b.latinField.typefaceField);b.eaField&&a.He(yb.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.He(yb.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&a.He(ye.a.capitalization,b.capField);b.symField&&a.He(yb.a.aTb,b.symField.typefaceField)}static Sfj(a){return a/(dk.a.ltc*dk.a.Fdb)}static qRf(a){return a*dk.a.Fdb}}Object(m.a)(Kj,"FormattingHelper",null,[142]);class Sj{Nwj(a,b,c){let f="";const l=a.ra(ib.a.C1,[]);l&&0<=b&&b<l.length&&(a=a.Zh)&&(b=a.Ie(l[b]))&&
b.Qa(yb.a.schemeColor)&&((b=Wg.SchemeColor.parse(b.$a(yb.a.schemeColor)))?b.Hva?f=Jk.i(b.kR):b.a2e(c)&&(f=Jk.i(b.kR)):ya.a.J(38606471,826,50,"schemeClr is null."));return f}Pwj(a,b){let c="";(a=a.Qzd)||ya.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&ya.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");a&&a.schemeClrField&&(14===a.schemeClrField.valField?ya.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?ya.a.J(38549312,
826,50,"The color of shapeFont is B"):ya.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=Ze.Box4ColorHelper.Rmb(a,b),b=Jk.g(b.N2a),c=Jk.i(b),"000000"===c?ya.a.J(38549316,826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?ya.a.J(38549318,826,50,"The resolved color of shapeFont is W"):ya.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));return c}}Object(m.a)(Sj,"NonTableThemeColorHelper",null,[143]);class un{constructor(){this.charsetField=0;this.panoseField=
null;this.pitchFamilyField=0;this.typefaceField=null}}Object(m.a)(un,"CT_TextFont",null,[]);class nk{constructor(){this.nVa=this.J2a=null}}Object(m.a)(nk,"ThemeFont",null,[]);class Bf{static isThemeFont(a){return Bf.zJl.hasOwnProperty(a)}static VBj(a){let b="",c,f=Bf.NBj(a);({vbb:a,Iob:c}=f);f.returnValue&&(0===a?0===c?b="+Heading":1===c?b="+Heading Asian":2===c&&(b="+Heading CS"):1===a&&(0===c?b="+Body":1===c?b="+Body Asian":2===c&&(b="+Body CS")));return b}static OLi(a,b,c){const f=[];if(!c||!c.FontScheme)return f;
var l=Bf.B1,u=Bf.B1,I=Bf.B1;({iIg:l,C7f:u,A2f:I}=Bf.q4h(l,u,I,a));({iIg:l,C7f:u,A2f:I}=Bf.q4h(l,u,I,b));a=c.FontScheme;l!==Bf.B1?(Bf.bOb(a,0,l,Bf.Qld,f),Bf.bOb(a,1,l,Bf.Gmd,f)):(l=Bf.Ycb(a,0,0),b=Bf.Ycb(a,1,0),Bf.Ta(l)||Bf.Ta(b)||(f.push(Object.assign(new nk,{J2a:l,nVa:Bf.Qld})),f.push(Object.assign(new nk,{J2a:b,nVa:Bf.Gmd}))));u!==Bf.B1?(Bf.bOb(a,0,u,Bf.Pld,f),Bf.bOb(a,1,u,Bf.Fmd,f)):(u=Bf.Ycb(a,0,1),l=Bf.Ycb(a,1,1),Bf.Ta(u)||Bf.Ta(l)||(f.push(Object.assign(new nk,{J2a:u,nVa:Bf.Pld})),f.push(Object.assign(new nk,
{J2a:l,nVa:Bf.Fmd}))));I!==Bf.B1?(Bf.bOb(a,0,I,Bf.Old,f),Bf.bOb(a,1,I,Bf.Emd,f)):(I=Bf.Ycb(a,0,2),u=Bf.Ycb(a,1,2),Bf.Ta(I)||Bf.Ta(u)||(f.push(Object.assign(new nk,{J2a:I,nVa:Bf.Old})),f.push(Object.assign(new nk,{J2a:u,nVa:Bf.Emd}))));return f}static Ta(a){return!a||!a.length}static bOb(a,b,c,f,l){a&&c!==Bf.B1&&(c=Bf.CQj(a,b,c),Bf.Ta(c)&&(c=Bf.Ycb(a,b,0),Bf.Ta(c)&&(c="Arial")),l.push(Object.assign(new nk,{J2a:c,nVa:f})))}static Ycb(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=Bf.pqg(a.majorFontField,
c));break;case 1:a.minorFontField&&(f=Bf.pqg(a.minorFontField,c))}return f}static pqg(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static CQj(a,b,c){if(!a||c===Bf.B1)return"";let f="";if(1066===c)f="Viet";else if(1152===c)f="Uigh";else if(c=Dc.Oe(c))f=c.RKl;return Bf.DQj(a,b,f)}static DQj(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=
Bf.oqg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Bf.oqg(a.minorFontField,c))}return f}static oqg(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static q4h(a,b,c,f){if(f!==Bf.B1){const l=Dc.Oe(f);l&&(l.Aec?b===Bf.B1&&(b=f):l.Due?c===Bf.B1&&(c=f):a===Bf.B1&&(a=f))}return{iIg:a,C7f:b,A2f:c}}static NBj(a){switch(a){case Bf.Old:return{returnValue:!0,
vbb:0,Iob:2};case Bf.Pld:return{returnValue:!0,vbb:0,Iob:1};case Bf.Qld:return{returnValue:!0,vbb:0,Iob:0};case Bf.Emd:return{returnValue:!0,vbb:1,Iob:2};case Bf.Fmd:return{returnValue:!0,vbb:1,Iob:1};case Bf.Gmd:return{returnValue:!0,vbb:1,Iob:0}}return{returnValue:!1,vbb:2,Iob:0}}static tyb(a,b){let c=null;if(0===a)switch(b){case 2:c=Bf.Old;break;case 1:c=Bf.Pld;break;case 0:c=Bf.Qld}else if(1===a)switch(b){case 2:c=Bf.Emd;break;case 1:c=Bf.Fmd;break;case 0:c=Bf.Gmd}null===c&&(ya.a.J(508692609,
820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new un,{typefaceField:c,charsetField:1})}}Bf.Old="+mj-cs";Bf.Pld="+mj-ea";Bf.Qld="+mj-lt";Bf.Emd="+mn-cs";Bf.Fmd="+mn-ea";Bf.Gmd="+mn-lt";Bf.B1=0;Bf.zJl={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(m.a)(Bf,"TextFontHelper",null,[]);class Fo{constructor(a,b,c){this.sa=a;this.nc=b;this.Thd=c}gGl(a,b){let c="";var f=a.ra(rb.a.pu,Bf.B1),l=a.ra(yb.a.$Oc,Bf.B1),
u=Dc.Oe(f===Bf.B1?1033:f);if(u){let I="";a.Qa(yb.a.aTb)?I=a.$a(yb.a.aTb):u.Due&&a.Qa(yb.a.complexScriptFont)?I=a.$a(yb.a.complexScriptFont):u.Aec&&a.Qa(yb.a.eastAsianFont)?I=a.$a(yb.a.eastAsianFont):a.Qa(yb.a.latinFont)&&(I=a.$a(yb.a.latinFont));if(Bf.isThemeFont(I)){u=!1;let T=null;if(this.Thd){if(b=Object(gb.a)(267,this.nc.ug(b)))T=b.Ld}else{if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");T=this.sa.Aa.Ld}if(T&&(f=Bf.OLi(f,l,T)))for(l=0;l<f.length;l++)if(I===f[l].nVa){c=f[l].J2a;u=
!0;break}u||(c=Bf.VBj(I))}else c=I}c&&a.He(rb.a.font,c)}}Object(m.a)(Fo,"FontResolver",null,[141]);class Go{constructor(a){this.bJk=a}N0i(a,b,c){a(rb.a.pu);a(yb.a.latinFont);a(yb.a.eastAsianFont);a(yb.a.complexScriptFont);a(yb.a.aTb);a(yb.a.$Oc);a(yb.a.Ld);a(yb.a.rxb);a(yb.a.mFb);a(yb.a.zO);a(yb.a.schemeColor);a(yb.a.I6c);a(yb.a.H9d);a(yb.a.E9d);a(yb.a.B9d);a(yb.a.L9d);a(yb.a.bXa);this.bJk.gGl(b(),c)}}Object(m.a)(Go,"PptFormattingCacheCopyPropertyStrategy",null,[196]);class eo{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.TextFormatting"}fc(a){this.K=a;a.register(141,"Box4.IFontResolver").ma().na(()=>new Fo(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(142,"PowerPointWebEditor.IFormattingHelper").ma().na(()=>new Kj);a.register(Go,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().na(()=>
new Go(a.resolve("Box4.IFontResolver")));a.register(143,"PowerPointWebEditor.INonTableThemeColorHelper").ma().na(()=>new Sj)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){C.a.instance.Ac(new eo)}}Object(m.a)(eo,"PPTWebEditorTextFormattingPackage",null,[2,3]);class vn{constructor(a){this.zd=a;this.dbi=U.a.instance.ga(115)}ODg(a){return this.rCg(a)?!0:this.dbi?1074135161===a.hf||1074135162===a.hf:
!1}qCg(a){return this.rCg(a)||131162===a.hf||4325465===a.hf||1179729===a.hf}rCg(a){return 131140===a.hf||this.zd.Gg&&131120===a.hf}Q6f(a){return Qa.a.any(a.iL,(b,c)=>!this.qCg(c)&&!this.ODg(c))}}Object(m.a)(vn,"UndoRevisionValidator",null,[655]);class ap{constructor(){this.kd=Tb.a.instance.ub("Box4.IFeatureHelper")}LRb(){return A.AFrameworkApplication.fa.getBooleanAppSetting("AllowMultiUserUndo")}L3a(){return this.LRb()&&A.AFrameworkApplication.fa.getBooleanAppSetting("AllowSmartUndoMerge")}}Object(m.a)(ap,
"UndoSettingsManager",null,[657]);var hm=d(352),fk=d(1067),wp=d(207);class fo{Qa(a){return a.Qa(void 0)}fng(a,b){return a.ra(b,null)}z1c(a,b){a=(a=a.ra(b,null))?Array.clone(a):[];return new fk.a(a)}ing(a,b){return a.ra(b,"")}ZMh(a,b,c){a.setValue(b,c)}}Object(m.a)(fo,"MergeableObjectUtilities",null,[693]);class Yp{constructor(a,b,c,f,l){this.yb=a;this.sa=b;this.Ga=c;this.oa=f;this.X1=l}eod(a,b,c){if(a)if("PowerPointGroupShapes"===b&&c)for(a=a.iL,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===
f.hf&&f.Qa(yb.a.y$)){f=(new fo).z1c(f,yb.a.y$);for(var l=0;l<f.length;l++){var u=this.sa.Aa;if(!u)throw Error.argumentNull("ActiveSlide is null");const I=this.X1.tfa(f.ga(l));u=u.KD(I.get_shapeId());b.push(u)}this.x2j(b)}}else if("PowerPointUngroupShapes"===b&&!c)for(a=a.iL,b=0;b<a.length;++b)if((c=a[b])&&393227===c.hf&&c.Qa(yb.a.zra))for(c=(new fo).z1c(c,yb.a.zra),f=0;f<c.length;f++){l=this.sa.Aa;if(!l)throw Error.argumentNull("ActiveSlide is null");u=this.X1.tfa(c.ga(f));l=l.KD(u.get_shapeId());
this.w2j(l)}}S3c(a){if(a){const b=a.vg(this.yb.Na);b.Qma();b.sQb=!0;this.oa.T9(a)}else ya.a.J(508694612,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}x2j(a){if(a.length){var b=this.Ga.zt(a[0]);this.S3c(b);for(const c of a)this.S3c(c)}}w2j(a){this.S3c(a);if(a.Lf){a=this.Ga.rx(a);for(const b of a)this.S3c(b)}}}Object(m.a)(Yp,"GroupUngroupUndoRedoActionController",null,[138]);class xp{Rlh(){}eod(){}plh(){}Okh(){}s9c(){return!1}}Object(m.a)(xp,
"NoOpTablePartialEditController",null,[139]);class kl{constructor(a,b,c,f,l,u){this.lib=null;this.Qi=a;this.Ga=b;this.Foc=c;this.Yb=f;this.oa=l;this.ilc=u}Rlh(){this.sye()&&this.Xbf()}eod(a){a&&this.sye()&&(a=this.lib,this.Xbf(),this.FUh(a))}plh(a,b,c,f){let l;this.sye()&&!this.mnk(a,b,c,f)&&(l=this.Xbf());return l}Okh(a,b,c){if(a&&b&&c){this.lib=null;a=this.oa.Hd();c=new Md.a;b=b.iL;for(let l=0;l<b.length;++l){var f=b[l];393230===f.hf&&f.Qa(yb.a.cellId)&&(f=this.Ga.Gn(f),Array.contains(a,f)&&c.$(f.get_shapeId(),
f))}0<c.count&&this.FUh(c.values.ga(0))}}mnk(a,b,c,f){let l=!1;b&&this.s9c(a)&&(f=b.fV&&f,l=(c||f)&&b.actionId===a,this.ilc||(l=(b.actionId===a||this.s9c(b.actionId))&&1===this.Foc.$Bb(b.V7)||l));return l}s9c(a){let b=a===G.a.rEa||a===G.a.nUa||a===G.a.Nz;this.ilc||(b=a===G.a.WC||a===G.a.enter||b);return b}FUh(a){this.lib=a}Xbf(){if(this.lib){var a=this.Yb.qj.ij.my.id;0!==this.Foc.$Bb(a)&&this.Foc.cZh(a,!1);a=this.Qi.P$a(this.lib,!0)}this.lib=null;return a}sye(){return!!this.lib}}Object(m.a)(kl,"TablePartialEditController",
null,[139]);var Zp=d(945);class mj{constructor(a,b,c,f){this.Pt=a;this.bUk=c;this.ia=f;this.qb()}qb(){this.ia.pa(M.a.Tlb,wc.a.application,Object(R.a)(this,this.Tlb,"queryIsShapeTextEditHappened"),96)}Tlb(a,b,c,f,l){l.ewa=this.ewa(l.gAc,l.Yuk);return 32}CTj(a,b,c){this.bUk.iam(new Zp.a(a,b,c))}ewa(a,b){let c=!1;a&&(c=!this.Pt.I7c()&&a.lIa!==b,this.Pt.I7c()||a.lIa!==b||ya.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",
Object(gc.a)(4,a)?"Shape":"Notes"));return c}}Object(m.a)(mj,"PPTUndoActionBehavior",null,[651]);class Ho extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(m.a)(Ho,"OnUndoEventArgs",Sys.EventArgs,[]);var $p=d(738),bp=d(137);class cp extends $p.a{constructor(a,b,c){c=void 0===c?null:c;super(void 0===a?null:a,void 0===b?null:b);this.OQd=c||new fo}TNb(){super.TNb();const a=new fk.a,b=new Ba.a;b.add(Ua.a.nil);this.cnb.forEach((u,I)=>{b.add(I);a.add(I);return!0});for(this.objects.forEach(u=>
{b.add(u);a.add(u);return!0});0<a.length;){var c=a.ga(0);a.T9d(0);var f=this.objects.ga(c)||this.M0.rBb(c);if(f){c=f;f=c.ZA();for(let u=0;u<f.length;u++){var l=f[u];const I=bp.a.pbc(bp.a.Keg(l));8===I?(l=this.OQd.fng(c,l),this.uKf(l,a,b)):9===I&&this.OQd.z1c(c,l).forEach(T=>{this.uKf(T,a,b);return!0})}}else Pa.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}uKf(a,b,c){c.contains(a)||(c.add(a),this.UDg(a)&&(c=this.M0.rBb(a),this.$Se(c),b.add(a)))}}Object(m.a)(cp,
"ReferenceFollowingRevisionDiffer",$p.a,[]);class z{j6i(a,b){return new cp(a,b)}}Object(m.a)(z,"UndoDifferFactory",null,[654]);var Z=d(287),pa=d(601);class Fa{constructor(a,b,c,f,l,u,I){a||Z.a.argument("revisionStore cannot be null","revisionStore");b||Z.a.argument("undoRevisionValidator cannot be null","undoRevisionValidator");c||Z.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||Z.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||Z.a.argument("revisedObjectSpace cannot be null",
"revisedObjectSpace");u||Z.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.Zmi=a;this.DMc=b;this.Uda=c;this.Jqi=f;this.x0b=l;this.Mqi=u;this.wvf=I}PTc(a,b){const c=this.Jqi.j6i(a,b);c.TNb();const f=new pa.a;f.Obf(this.x0b,a);c.cnb.forEach((I,T)=>{f.yAa(T,I);return!0});const l=new fk.a,u=a.nV<b.nV;c.objects.forEach((I,T)=>{if(this.DMc.ODg(T))return!0;if(u&&!this.DMc.qCg(T)&&!b.q1(I)&&!a.q1(I))return l.add(I),!0;f.sta(T);return!0});0<l.length&&da.ULS.sendTraceTag(22607311,
365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,l.ln());this.wvf&&this.wvf.Iim(f);return f.rYc()}k6i(a,b,c,f){b=this.PTc(a,b);if(!b)return null;if(a.id===c.id)return da.ULS.sendTraceTag(22607312,365,this.Uda.L3a()?15:50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.Uda.L3a()),b;a=this.PTc(a,c);if(!a)return null;var l=b;this.DMc.Q6f(a)?(da.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),
l=new fk.a,l.add(a),a=new fk.a,a.add(b),l=this.Mqi.LXk(f,a,l,c.qwd).eQ.last()):da.ULS.sendTraceTag(22607314,365,this.Uda.L3a()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",this.Uda.L3a());return this.PTc(c,l)}l6i(a,b,c,f,l){let u=null;f||(this.Uda.L3a()||!this.Uda.LRb()?u=this.PTc(c,b):(da.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(u=this.k6i(a,
b,c,l));return u&&this.n6l(u)?u:null}n6l(a){return this.DMc.Q6f(a)?(this.Zmi.Vob(a),!0):!1}}Object(m.a)(Fa,"UndoRevisionManager",null,[656]);var Ma=d(161);class tb{constructor(a){this.wzf=null;this.Ma=new uc.a;this.Lqb=null;this.Wub=[];this.Nqi=a}dispose(){for(;0<this.Wub.length;)this.zDh(this.Wub[0])}get cM(){return this.Lqb}set cM(a){this.Lqb&&(this.Lqb.isActive=!1);if(this.Lqb=a)this.Lqb.isActive=!0}ZLf(a){this.Ma.addHandler(tb.Oqh,a)}register(a){if(!this.qna(a)){const b=this.Nqi.S7i(a);b.hOh(c=>
{this.Ma.raiseEvent(tb.Oqh,new Ho(c))});a.addListener(this);Array.add(this.Wub,b)}}unregister(a){if(a=this.bCb(a))a===this.cM&&(this.cM=null),this.zDh(a)}setActive(a){this.cM=this.bCb(a)}SRc(){const a=this.bCb(void 0);a&&(a.Fqa(void 0),this.RSe())}get YU(){return this.fK?this.cM.YU:!1}get h9d(){return this.fK?this.cM.h9d:null}get Pma(){return this.fK?this.cM.Pma:!1}get IHa(){return this.fK?this.cM.IHa():!1}Ebf(a,b){this.fK&&this.cM.Ebf(a,b)}Bx(){this.fK&&this.cM.Bx()}ZX(){return this.fK?this.cM.ZX():
null}undo(){return this.fK?this.cM.undo():!1}redo(){return this.fK?this.cM.redo():!1}L0a(a,b,c){this.fK&&this.cM.L0a(a,b,void 0===c?!1:c)&&(this.RSe(),this.wzf&&this.wzf())}$Ve(){this.fK&&this.cM.$Ve()}zDh(a){a.graphSpace.removeListener(this);a.hOh(null);a.dispose();Array.remove(this.Wub,a)}qna(a){return!!this.bCb(a)}get fK(){return!!this.cM}bCb(a){for(let b=0;b<this.Wub.length;b++){const c=this.Wub[b];if(c.wek(a))return c}return null}RSe(){ad.App.Ob.Gf()}Rod(a){this.unregister(a)}onBeforeLoadContent(a){const b=
this.bCb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.bCb(a);if(b)b.onAfterLoadContent(a);this.cM===b&&(this.cM.YU||this.cM.Pma)&&this.RSe()}onAfterFirstSaveContent(){}}tb.Oqh="OnUndo";Object(m.a)(tb,"UndoManager",null,[648,435,106,649]);class Hb extends tb{constructor(a,b,c){super(a);this.kHk=b;this.xld=c;this.kHk.Pxi(Object(R.a)(this,this.e5k,"onFailoverSucceeded"));this.xld.PZd(Object(R.a)(this,this.p6k,"onInitialSelectionSet"))}get fqa(){return this.cM}Tgk(a){return this.fK?
this.fqa.VAg(a):!1}H4d(){this.fK&&this.fqa.DTi()}Uge(a){return this.fK?this.fqa.Uge(a):null}x_c(a){return this.fK?this.fqa.x_c(a):0}adf(){this.fK&&this.fqa.adf()}get YU(){return this.fK?md.a("Microsoft.Office.PowerPoint.ChangeGate.EnableUndoAfterClearFromatting")?this.fqa.YU:this.fqa.o1j:!1}Fqa(){this.fK&&this.fqa.Fqa(!0)}e5k(a,b){b.Kpk&&this.Fqa()}p6k(){this.L0a(G.a.gXa,null)}mhf(a){this.fK&&this.fqa.mhf(a)}I7c(){return this.fK?this.fqa.I7c():!1}Heb(){return this.fK?this.fqa.Heb():!1}}Object(m.a)(Hb,
"PPTUndoManager",tb,[647,648,435,106,649]);class rc{LXk(a,b,c,f){return a?a.smd(b,c,null,f,1,!1,5):null}}Object(m.a)(rc,"PPTUndoRevisionMergeStrategy",null,[646]);var yc=d(143),xc=d(47);class ld{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.ZJe=!1;if(hd&&!Ec)throw Error.argumentNull("viewElementEventNotifier");this.qCe=a;this.PC=b;this.$bh=c;this.h0a=f;this.FKa=l;this.cjb=u;this.Ioc=I;this.UK=Ec;this.tZ=hd;T===xc.a.xA&&(T=xc.a.Sr);this.ASg=T;this.oa=ja;this.Tb=ua;this.KJk=Ra;
this.Yb=eb;this.Fa=Bb;this.ia=Ub;this.klc=Xb;this.joc=tc;this.yb=lc}ZGl(){this.o0h();if(this.PC){var a=this.Tb.Qk(this.PC);a&&this.KJk.Aa!==a&&(this.Yb.Aa=a)}if(this.klc){if(this.h0a&&0<this.h0a.length){a=[];for(const b of this.h0a){const c=this.Tb.Qk(b);c&&a.push(c)}if(0<a.length){let b;(b=this.oa).sQ.apply(b,a)}}this.ia.nb(M.a.V2a,2)}this.tZ&&this.UK&&this.UK.Azh()}hW(a,b){a=void 0===a?!1:a;b=void 0===b?null:b;this.ZGl();if(this.ZJe||this.Lzg())return this.ZJe=!1,null;b||(b=this.Wwb());this.setSelection(a,
b);return b}Wwb(){let a=null;if(0<this.cjb.length){const b=this.Tb.Qk(this.PC);if(b){const c=[];for(const f of this.cjb){if(!f)continue;const l=b.ER(f);if(l){const u=l.vg(this.yb.Na);u&&!u.sQb&&c.push($d.SelectionFactory.Nl(l))}}0<c.length&&(a=new yc.SelectionCollection(c,c.length-1))}}a||(a=this.qCe.Wwb(!0));!a&&this.Ioc&&(a=this.Ioc.tfg());return a}setSelection(a,b){b=void 0===b?null:b;this.qCe.setSelection(void 0===a?!1:a,b);b&&this.Ioc&&ya.a.J(509445784,816,50,"Selection restore to IP level");
b||this.ASg!==xc.a.Ag?this.Fa.Df(this.ASg):(this.oa.Bh(),this.Fa.Gd())}qQc(){return this.qCe.qQc()}o0h(){this.PC=this.xgf(this.PC,this.$bh);const a=[];let b=0;for(const c of this.h0a)a.push(this.xgf(c,this.FKa[b++]));this.h0a=a}xgf(a,b){let c=a;a&&Vh.a.Cx(a)&&(a=this.Tb.UBb(b),a||(b=this.joc.JMj(b),null!=b&&(a=this.Tb.LGa(b))),a&&(c=a.Fb));return c}Tem(){this.PC=this.xgf(this.PC,this.$bh);this.klc&&this.o0h();if(this.cjb.length&&Array.contains(this.cjb,0)){Array.clear(this.cjb);var a=this.Wwb();if(this.oa.u1(a))for(const b of a)(a=
Object(gb.a)(4,b.Ua.node))&&this.cjb.push(a.get_shapeId())}}kkm(){this.ZJe=this.Lzg()}Lzg(){const a=this.Tb.Qk(this.PC);if(!a)return!1;var b=this.Ioc?[this.Ioc.t6d]:this.cjb;for(const c of b)if((b=a.ER(c))&&b.Mq)return!0;return!1}}Object(m.a)(ld,"PPTUndoSelectionReference",null,[467,644]);class wd{constructor(a,b,c,f,l){this.Wb=a;this.tDe=b;this.Bbd=c;this.Doc=f;this.Coc=l}tfg(){var a=this.Wb.Qk(this.tDe);if(!a)return null;a=a.ER(this.Bbd);if(!a)return null;a=a.XBb();if(!a)return null;var b=a.ra(rb.a.bBa,
0);const c=a.ra(rb.a.Ria,0);if(!this.Doc||!this.Coc||this.Doc.kOa>=b||this.Doc.jOa>=c||this.Coc.kOa>=b||this.Coc.jOa>=c)return null;b=mb.GraphIterator.ob(a.tf(this.Doc.kOa,this.Doc.jOa));b.uc(14);a=mb.GraphIterator.ob(a.tf(this.Coc.kOa,this.Coc.jOa));a.uc(14);return $d.SelectionFactory.Y6b(b,a)}get t6d(){return this.Bbd}}Object(m.a)(wd,"PPTUndoTableCellSelectionPos",null,[690]);class t{constructor(a,b,c,f,l,u,I,T){this.Ub=a;this.Wb=b;this.xZ=c;this.fHk=f;this.tDe=l;this.Bbd=u;this.Bkd=I;this.sTk=
T}tfg(){var a=this.Wb.Qk(this.WZi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.ER(this.t6d),!b)return null;var c=[];switch(this.containerType){case 10:c=this.ufe(b);break;case 16:a=this.Ub.Pc(b);if(!a.sj()||!a.sj())return null;if(0>this.kOa||0>this.jOa||this.kOa>=a.currentNode.ra(rb.a.bBa,0)||this.jOa>=a.currentNode.ra(rb.a.Ria,0)){this.xZ.jih(a,0,0);c.push($d.SelectionFactory.hk(a.currentNode,!0));break}this.xZ.jih(a,this.kOa,this.jOa);c=this.ufe(a.currentNode);
break;case 60:c=a.aWa();if(!c)return null;c=this.ufe(c);break;default:return null}return 0<c.length?new yc.SelectionCollection(c,0):null}get t6d(){return this.Bbd}ufe(a){const b=[];for(const c of this.N9l){const f=c.Xsj(a);f&&b.push(f)}b.length||b.push($d.SelectionFactory.hk(a,!0));return b}get containerType(){return this.fHk}get WZi(){return this.tDe}get jOa(){return this.Bkd?this.Bkd.jOa:-1}get kOa(){return this.Bkd?this.Bkd.kOa:-1}get N9l(){return this.sTk}}Object(m.a)(t,"PPTUndoTextSelectionPos",
null,[690]);class aa{constructor(a,b){this.ZSk=a;this.gTk=b}get jOa(){return this.ZSk}get kOa(){return this.gTk}}Object(m.a)(aa,"TableCellIndex",null,[]);class ra{constructor(a,b,c,f,l,u){this.Ub=a;this.Uh=b;this.kOk=c;this.hHk=f;this.OKk=l;this.NKk=u}get contextId(){return this.hHk}get paragraphIndex(){return this.kOk}get eec(){return this.OKk}get dec(){return this.NKk}Xsj(a){a=this.Ub.Pc(a);if(!a.mme(this.paragraphIndex)||11!==a.lr.type||!a.Gb(2)||12!==a.lr.type&&21!==a.lr.type||this.eec>this.dec||
-1>this.eec||this.dec>this.Uh.textLength(a.currentNode))return null;switch(this.contextId){case ta.a.Xf:return $d.SelectionFactory.U4(a.currentNode,this.eec,this.dec);case ta.a.textRange:return $d.SelectionFactory.U4(a.currentNode,this.eec,this.dec);case ta.a.endOfParagraph:return $d.SelectionFactory.Eea(a.currentNode);case ta.a.paragraph:return $d.SelectionFactory.Dv(me.a.QTa(this.eec,this.dec,!1,a.currentNode))}return null}}Object(m.a)(ra,"TextContextRecord",null,[]);class Na{constructor(a,b,c,
f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc){if(tc&&!Xb)throw Error.argumentNull("viewElementEventNotifier");this.yGk=a;this.oa=b;this.ATg=c;this.Yb=f;this.Ub=l;this.Fa=u;this.Wb=I;this.Ga=T;this.Uh=ja;this.xZ=ua;this.ia=Ra;this.klc=eb;this.joc=Bb;this.yb=Ub;this.UK=Xb;this.tZ=tc}fua(){const a=this.yGk.fua();let b=null,c=Ua.a.nil;const f=this.ATg.Aa;f&&(b=f.Fb,c=f.id);const l=[],u=[];if(this.klc){var I=this.oa.Xe();for(var T of I)l.push(T.Fb),u.push(T.id)}I=[];T=null;f&&(this.oa.nI()&&this.pul(I),this.oa.kz()&&
(T=this.uul(b)));return new ld(a,b,c,l,u,I,T,this.Fa.N9,this.oa,this.Wb,this.ATg,this.Yb,this.Fa,this.ia,this.klc,this.joc,this.yb,this.UK,this.tZ)}S7c(a){return 10===a.type||60===a.type||16===a.type}pul(a){const b=this.oa.Hd();for(const c of b)a.push(c.get_shapeId())}uul(a){return this.oa.Oa.kb.yg?this.sul(a):this.tul(this.oa.Oa,a)}tul(a,b){var c=Object(gb.a)(5,a.kb.Ua.node),f=this.Ub.Pc(c);if(f.h8(Object(R.a)(this,this.S7c,"isOEContainerNode")))if(f.Dc()&&11===f.currentNode.type){if(f.Dc()){c=(c=
this.Ga.sfa(c))?c.get_shapeId():0;const l=f.lr.type;f=16===l?this.mle(Object(gb.a)(650,f.lr)):null;const u=a.kb,I=[];this.$Nf(u,I);for(const T of a)T!==u&&this.CFi(T,u)&&this.$Nf(T,I);return new t(this.Ub,this.Wb,this.xZ,l,b,c,f,I)}}else ya.a.J(509445783,816,15,"Find text selection but its container is not OutlineElement");return null}sul(a){var b=this.oa.Oa.ga(0),c=this.oa.Oa.last,f=b.yg;b=16===f.Ua.node.type?this.mle(Object(gb.a)(650,f.Ua.node)):null;f=c.yg;c=16===f.vf.node.type?this.mle(Object(gb.a)(650,
f.vf.node)):null;f=(f=this.Ga.sfa(f.Ua.node))?f.get_shapeId():0;return new wd(this.Wb,a,f,b,c)}mle(a){return a?new aa(a.Yi,a.rowIndex):null}$Nf(a,b){for(const c of a){if(!Object(gc.a)(102,c.node))continue;a=this.Ub.Pc(c.node);if(!a.h8(Object(R.a)(this,this.S7c,"isOEContainerNode")))continue;a.Dc();const f=a.currentNode;a.Dc();a=a.EVa(f);b.push(new ra(this.Ub,this.Uh,a,c.contextId,c.Ra,c.Pb))}}CFi(a,b){a=this.Ub.Pc(a.Ua.node);b=this.Ub.Pc(b.Ua.node);return a.h8(Object(R.a)(this,this.S7c,"isOEContainerNode"))&&
b.h8(Object(R.a)(this,this.S7c,"isOEContainerNode"))&&a.Dc()&&11===a.currentNode.type&&b.Dc()&&11===b.currentNode.type&&a.Dc()&&b.Dc()?a.currentNode===b.currentNode:!1}}Object(m.a)(Na,"PPTUndoSelectionReferenceFactory",null,[136]);class db{constructor(){this.GZa=this.Vah=this.YNe=this.Keh=null;this.sfd=!1;this.SPe=null}ugf(){if(!this.GZa.ODb&&this.GZa.g$c)for(const a of this.GZa.g$c)if(a.equals(this.Keh)){this.YNe.hW(!1,this.Vah);ya.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.SPe);this.GZa.Lvc(Object(R.a)(this,this.ugf,"trySetSelectionWhenServerUndoRedoFinish"));this.sfd=!0;break}}Exl(a,b,c,f){a&&(this.Keh=b,this.Vah=f,(this.YNe=Object(gb.a)(644,c))?(this.Wgf(),this.SPe=new Date,this.GZa=a,this.GZa.kOc(Object(R.a)(this,this.ugf,"trySetSelectionWhenServerUndoRedoFinish")),this.sfd=!1):ya.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}Wgf(){this.GZa&&!this.sfd&&(ya.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.SPe),this.GZa.Lvc(Object(R.a)(this,this.ugf,"trySetSelectionWhenServerUndoRedoFinish")),this.sfd=!0)}}Object(m.a)(db,"PPTUndoSelectionRestoreExecutor",null,[137]);class kb{constructor(){this.OSk=new Md.a(!1);this.eUk=new Md.a(!1);this.N_g=new Md.a(!1);this.init()}init(){this.Q8j()}Q8j(){this.N_g.add(M.a.QJ,!0)}p1i(a){return a&&this.OSk.Ib(a)?!0:!1}o1i(a){return a&&this.eUk.Ib(a)?!1:!0}fYl(a){return a&&this.N_g.Ib(a)?!0:!1}}Object(m.a)(kb,"PPTUndoSettings",null,[645]);class Ib{constructor(a){this.pk=
null;this.epf=a}start(a){this.pk=a}Z0j(){var a=new Date;return this.epf?+a-+this.pk>this.epf:!1}}Object(m.a)(Ib,"UndoTimer",null,[689]);var Rb=d(485),Cb=d(530);class cc{constructor(a){this.jda=this.u4=null;this.Azb=this.uzc=a}get uzc(){return this.u4}set uzc(a){this.u4&&(this.u4.kQ&=-2);this.u4=a;this.u4.kQ|=1}get Azb(){return this.jda}set Azb(a){this.jda&&(this.jda.kQ&=-3);this.jda=a;this.jda.kQ|=2}get V7(){return this.u4?this.u4.id:Ua.a.nil}get qbe(){return this.jda?this.jda.id:Ua.a.nil}get iL(){return this.u4?
this.u4.MIg():[]}combineWithPrevious(){}dispose(){this.u4&&(this.u4.kQ&=-2);this.jda&&(this.jda.kQ&=-3)}}Object(m.a)(cc,"Box4UndoRecordData",null,[704,106]);class Fc{constructor(a,b,c,f,l,u){this.nAa=a;this.snb=b;this.Kqi=c;this.actionId=f;this.fV=l;this.aNa=u}get B3(){return this.Kqi}get V7(){return this.B3.V7}dispose(){this.B3&&this.B3.dispose()}}Object(m.a)(Fc,"UndoRecord",null,[106]);class ed{constructor(){this.kta=[]}ga(a){return this.kta[a]}get length(){return this.kta.length}add(a){this.kta.push(a)}clear(){for(let a=
0;a<this.kta.length;a++)this.kta[a].dispose();Array.clear(this.kta)}remove(a){const b=Array.remove(this.kta,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.kta.length&&(this.kta[a].dispose(),Array.removeAt(this.kta,a))}}Object(m.a)(ed,"UndoRecordsArray",null,[]);class Td{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se){this.E8a=!0;this.U6a=this.buf=this.xHc=this.gub=!1;this.bsb=null;this.IRd=this.NAf=0;this.ZXd=null;this.XFf=!0;this.isActive=!1;this.HA=a;this.ZId=b;this.pii=
c;this.dMd=f;this.Nri=l;this.Cki=u;this.lm=I;this.nJ=T;this.IDf=ja;this.wni=ua;this.je=Ra;this.Bqi=eb;this.Fni=Bb;this.XCf=Ub;this.xHf=tc;this.yHf=lc;this.Oqi=Ec;this.AHf=hd;this.Uda=yd;this.Tz=pe;this.kh=new ed;this.ut=this.Ih=-1;this.mvf=Object(R.a)(this,this.d1f,"createInitialUndoRecord");this.LKc=Xb;this.LKc.rAi(Object(R.a)(this,this.yDh,"removeUndoRecordForRevision"));this.XFf=Se}dispose(){this.mvf=null;this.SRc();this.HA=null;this.LKc.mCl(Object(R.a)(this,this.yDh,"removeUndoRecordForRevision"))}get graphSpace(){return this.HA}get Ttc(){return this.pii.value}wek(a){return this.HA===
a?!0:!1}SRc(){this.kh.clear();this.ut=this.Ih=-1;this.E8a=!0}aUi(){if(this.Ih===this.kh.length-1)this.SRc();else{let a=0;for(;a<this.Ih;)this.kh.removeAt(0),a++;this.Ih=0;this.ut=1}}get YU(){return 0<this.Ih}get h9d(){return this.YU?this.kh.ga(this.Ih).actionId:null}get i9d(){return 0<=this.Ih&&this.Ih<this.kh.length?this.kh.ga(this.Ih).B3:null}Ebf(a,b){this.U6a?(this.mAc(),this.Fqa()):(this.XCf&&this.Ttc.suspend(),this.U6a=!0,this.bsb=a,this.NAf=b,this.IRd=0)}mAc(){this.U6a=!1;this.XCf&&this.Ttc.resume()}xfm(){this.Fni(new Ua.a(this.bsb,
1));this.mAc()}L0a(a,b,c){c=void 0===c?!1:c;if(!this.ZId()||a===G.a.gXa&&this.kh.length)return!1;var f=this.HA.XU();if(!f&&a!==G.a.gXa&&!c||!this.HA||!this.HA.ij)return!1;f&&(this.buf||(da.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.buf=!0),this.dMd.execute(u=>{u.Rae()}));if(this.U6a){da.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.bsb);this.mAc();for(c=this.kh.length-2;0<=c;c--)this.kh.removeAt(c);this.Ih=0;this.ut=-1}c=
this.ZX();f=this.C8d(f,a);this.Xyb();b=this.kWi(a,f,b);const l=this.Uda.LRb()&&!this.Uda.L3a();a=new Fc(b,c,f,a,this.gub,l);this.kh.add(a);this.Ih=this.kh.length-1;return!0}C8d(a,b){return this.xHf(a,b,void 0)}kWi(a,b,c){if(0<=this.Ih){switch(a){case G.a.rEa:case G.a.nUa:case G.a.Nz:this.E8a&&this.kh.ga(this.Ih).actionId===a?(a=this.kh.ga(this.Ih),c=a.nAa,b.combineWithPrevious(a.B3),this.kh.removeAt(this.Ih)):A.AFrameworkApplication.fa.getBooleanAppSetting("OtelSendTypingUserActionDisabled")||(b=
this.Bqi.create(a),b.end(32),this.Nri.lvc(b),this.Cki.kvc(b))}this.E8a=!0}return c}$Ve(){this.Oqi(this)}acj(){this.XFf&&!this.E8a||!this.Uda.LRb()||(this.E8a=!1,this.gub=!0)}dWk(){if(this.Uda.L3a())for(let a=0;a<this.kh.length;a++)this.kh.ga(a).aNa=!0}Xyb(){if(this.Ih<this.kh.length-1){for(let a=this.kh.length-1;a>this.Ih;a--)this.kh.removeAt(a);this.ut=-1}}Ljm(){var a=Ma.ObjectSpace.j$(this.HA.ij);a=new cc(a);const b=this.ZX(),c=this.kh.ga(this.Ih).nAa;a=new Fc(c,b,a,G.a.FEd,this.kh.ga(this.Ih).fV,
this.kh.ga(this.Ih).aNa);this.kh.removeAt(this.kh.length-1);this.kh.add(a)}Mlb(a,b,c,f){return a.Mlb(b,c,f)}xXe(a,b,c){this.xHc=!0;a.aAe();this.xHc=!1;b.hW(void 0,c)}undo(){if(!this.YU)return!1;this.dMd.execute(ua=>{ua.Rae()});var a=!0;let b=!1;var c=!1;const f=this.lm.xe(7);f.rd(this.HA);let l=0,u=!1,I=this.ZX(),T=null;const ja=this.yHf(!0);for(this.AHf.start(new Date);this.YU&&a;){const ua=this.kh.ga(this.Ih),Ra=this.kh.ga(this.Ih-1);a=ua.fV&&Ra.fV;da.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",
a,Cb.a[this.Tz]);this.ut=this.Ih;try{if(b=this.Mlb(ja,ua.B3,Ra.B3,ua.aNa||Ra.aNa))I=this.kh.ga(this.Ih).nAa,T=this.kh.ga(this.ut).snb,this.ZXd&&this.ZXd(this.kh.ga(this.Ih).actionId)}catch(eb){da.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",eb.message,eb.stack),b=!1,c=!0}l++;b?this.Ih--:(da.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,Cb.a[this.Tz]),this.aUi(),a=!1);if(this.AHf.Z0j()){u=!0;break}}b&&this.xXe(ja,I,null,T,!0);
f.dispose();this.Bx();this.U6a&&(this.xfm(),this.Xyb());this.nJ.Gf();this.IDf.dca();if(0<this.Ih&&u&&this.kh.ga(this.Ih).fV){a=this.Ih;for(c=0;0<a&&this.kh.ga(a).fV;)c++,a--;this.kh.ga(this.Ih).fV=!1;da.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&da.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}Bx(){this.gub=this.E8a=!1}get Pma(){return 0<this.ut}redo(){if(!this.Pma)return!1;
this.dMd.execute(I=>{I.Rae()});var a=!0;let b=!1,c=!1;const f=this.lm.xe(7);f.rd(this.HA);let l=this.ZX();const u=this.yHf(!1);for(;this.Pma&&a;){a=this.kh.ga(this.ut);const I=this.kh.ga(this.Ih);da.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.kh.ga(this.ut).fV&&this.kh.ga(this.Ih).fV,Cb.a[this.Tz]);try{if(b=this.Mlb(u,a.B3,I.B3,a.aNa||I.aNa))l=this.kh.ga(this.ut).snb}catch(T){da.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
T.message,T.stack),b=!1,c=!0}b?(this.Ih=this.ut,this.ut<this.kh.length-1?(this.ut++,a=this.kh.ga(this.ut).fV&&this.kh.ga(this.Ih).fV):(this.ut=-1,a=!1)):(da.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,Cb.a[this.Tz]),this.Fqa(),a=!1)}b&&this.xXe(u,l,null,null,!1);f.dispose();this.Bx();this.nJ.Gf();this.IDf.dca();return b}ZX(){return this.ZId()?this.wni.fua():null}eml(a){return this.U6a&&kh.a.compare(a.rr,this.bsb)?(da.ULS.sendTraceTag(512362002,365,50,"Incremental Action in progress"),
this.Ljm(),this.IRd=a.n,this.IRd===this.NAf&&(da.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.bsb),this.mAc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.xHc&&!this.eml(a.ij.my.id))if(this.U6a&&(da.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.bsb,this.HA.ij.my.id),this.mAc()),!this.Uda.LRb())this.Fqa();else if(this.Pma||this.YU)this.acj(),this.dWk()}Fqa(a){a=void 0===a?
!1:a;this.SRc();a?this.d1f(null):(a=new ne.a(2,1,0,this.mvf,50),this.je.Jb(a))}yDh(a,b){if(b&&(1===(b.kQ&1)||2===(b.kQ&2))){a=this.Pma;const f=this.YU;for(var c=this.kh.length-1;0<=c;c--){const l=Object(gb.a)(cc,this.kh.ga(c).B3);!l||l.uzc!==b&&l.Azb!==b||(this.kh.removeAt(c),-1!==this.Ih&&this.Ih--,-1!==this.ut&&this.ut--)}b=this.Pma;c=this.YU;!this.isActive||a===b&&f===c||(da.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,c),this.nJ.Gf())}}d1f(){this.ZId()&&
this.L0a(G.a.gXa,this.ZX())}IHa(){return this.xHc}hOh(a){this.ZXd=a}}Object(m.a)(Td,"UndoStack",null,[703,106]);var rf=d(823);class sf extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(m.a)(sf,"RevisionStateArgs",Sys.EventArgs,[]);class Hg{constructor(a,b,c,f,l,u){this.nAa=a;this.snb=b;this.V7=c;this.actionId=f;this.fV=l;this.aNa=u}}Object(m.a)(Hg,"PPTLocalUndoRecord",null,[]);class uh extends Td{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,
Ve,xg,yg,ng,Wh,Ai,Wf,gg){super(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,$f,Wf,4,gg);this.Ifd=!1;this.Zmc=-1;this.nN=[];this.PV=yd;this.MMe=Pd;this.KMe=pe;this.Ub=Se;this.ka=vf;this.ipa=ug;this.Fa=Tg;this.FZa=Ve;this.FZa.hMf(Object(R.a)(this,this.vMb,"onRevisionProcessed"));this.ujb=xg;this.oa=yg;this.RPe=ng;this.sZg=Wh;this.Leh=Ai;this.t0g=$f.LRb()&&!$f.L3a()}L0a(a,b,c){c=void 0===c?!1:c;let f=!1;b=this.Leh.fkm(b);var l=this.Ih;this.MMe.fYl(a)?f=this.rWk(a,b):this.MMe.o1i(a)?(f=this.lPi(a,
b,c))&&this.ddm(a):this.Fqa();b=null;f?(l=this.Ih-l,b=this.Hbc(this.Ih),this.Ztl(b,!l),this.Heb()||this.Sbe()):this.Leh.nck();l=null;this.ka.designerSendActionDuration&&b&&b.B3&&b.B3.qbe!==Ua.a.nil&&(l=b.B3.qbe);this.KMe.CTj(a,f,l);return f}C8d(a,b){const c=0<=this.Ih?this.kh.ga(this.Ih):null,f=this.ujb.plh(b,c,this.E8a,this.gub);b=this.xHf(a,b,f);this.ujb.Okh(c,b,a);return b}VAg(a){let b=!1,c=null;a&&this.YU?c=this.kh.ga(this.Ih):!a&&this.Pma&&(c=this.kh.ga(this.ut));c&&(b=this.x7c(c.V7));return b&&
this.Heb()}Mlb(a,b,c,f){let l=!1;if(this.VAg(a.pfb))(l=super.Mlb(a,b,c,f))&&this.kWk(a.zna);else{const u=a.pfb?2:3;l=a.$xh(I=>{this.PV.t3h(I,u)});this.YVk(a.zna);this.FZa.uud(new sf(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.Ifd&&this.FZa.uud(new sf(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.Ifd&&(this.FZa.uud(new sf(3)),this.Ifd=!1)}dispose(){this.FZa.rEh(Object(R.a)(this,this.vMb,"onRevisionProcessed"));super.dispose()}xXe(a,b,c,f,l){a&&a.zna!=Ua.a.nil&&
(this.sZg&&(f&&this.E3h(f),b&&this.E3h(b)),0<this.nN.length&&(f=new Hg(this.ZX(),b,a.zna,l?M.a.P1a:M.a.O1a,!1,this.t0g),Array.add(this.nN,f)),a.aAe(),b&&0<this.nN.length?b.hW(void 0,c):($c.a.Kb&&($c.a.Y2($c.a.Kb),$c.a.Kb.jD(Ii.a.d_,$c.a.Kcb(a.zna.toString()).toString())),this.sZg&&(f=Object(gb.a)(218,this.HA.Fq))&&b&&this.RPe.Exl(f,a.zna,b,c)))}vMb(a,b){b&&(!(a=b.tE)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.Ifd=!0,this.ka.$Ag||(b=2===a.RevisionSource?Object(gb.a)(644,this.kh.ga(0<this.ut?
this.ut:this.kh.length-1).nAa):Object(gb.a)(644,this.kh.ga(this.Ih).snb))&&b.kkm(),this.Ghj(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.FZa.uud(new sf(1))))}Ghj(a,b,c,f){a!==this.Ih&&ya.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.Ih);if(a<this.Ih||f){do this.kh.removeAt(this.Ih--);while(this.Ih>a);this.ut=0<this.ut?this.Ih+1:-1;this.RPe.Wgf()}if(!(0>this.ut)&&(b!==this.kh.length-this.ut&&ya.a.J(512362E3,
823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.kh.length-this.ut),b<this.kh.length-this.ut||c)){do this.kh.removeAt(this.ut);while(this.kh.length-this.ut>b);if(!b||this.ut>=this.kh.length)this.ut=-1;this.RPe.Wgf()}}E3h(a){(a=Object(gb.a)(644,a))&&a.Tem()}DTi(){if(this.ka.hEb&&this.nN.length){var a=this.Hbc(this.Ih);if(a){var b=a.nAa;if(this.x7c(a.V7)){for(let c=this.Ih-1;0<c;c--){const f=this.Hbc(c);if(!f)break;if(this.x7c(f.V7))b=f.nAa,this.kh.removeAt(c),this.Ih--;
else break}this.Xyb()}else this.kh.add(a),this.Ih++,this.ut=-1;a.nAa=b;a.fV=!1;this.Wvd();this.Sbe()}else this.Xyb(),this.Wvd()}}adf(){if(this.ka.hEb){var a=this.Hbc(this.Ih);if(a){if(0<(-1===this.Zmc?0:this.kh.length-this.Zmc)){for(var b=this.kh.length-1;b>=this.Zmc;b--)this.kh.removeAt(b);for(b=0;0<=b&&b<this.nN.length;){var c=b;let f=!0;for(;f&&b<this.nN.length;)b<this.nN.length-1?(f=this.nN[b].fV&&this.nN[b+1].fV,b++):(f=!1,b=-1);c=this.nN[c];this.kh.add(new Fc(c.nAa,this.nN[0>b?this.nN.length-
1:b-1].snb,a.B3,c.actionId,!1,c.aNa))}this.Ih=this.kh.length-1}this.ut=-1;this.Wvd();this.Sbe()}else this.Xyb(),this.Wvd()}}get o1j(){if(this.ka.hEb&&this.Heb()){const a=this.Hbc(this.Ih);if(!a||0<this.nN.length&&!this.x7c(a.V7))return!1}return this.YU}Sbe(){var a=this.ka.hXk;if(this.Ih>a){var b=0;for(a=this.Ih-a-1;0<=a;a--)this.kh.removeAt(a),b++;this.Ih-=b;b=this.ut-b;this.ut=0<b?b:-1}}lPi(a,b,c){const f=0<=this.Ih?this.kh.ga(this.Ih):null;this.gub=!!f&&this.ujb.s9c(a)&&f.actionId===a&&this.gub;
return super.L0a(a,b,c)}Ztl(a,b){this.ka.hEb&&a&&(this.Heb()||this.MMe.p1i(a.actionId))&&(this.nN.length||(this.Zmc=this.Ih),b&&Array.removeAt(this.nN,this.nN.length-1),Array.add(this.nN,new Hg(a.nAa,a.snb,a.V7,a.actionId,a.fV,a.aNa)))}Hbc(a){return 0<a&&a<=this.Ih?this.kh.ga(a):null}Uge(a){a=a?this.Ih:this.ut;return 0<=a&&a<this.kh.length?this.kh.ga(a).B3:null}x_c(a){a=a?this.Ih:this.ut;return 0<=a&&a<this.kh.length?this.kh.ga(a).actionId:0}Wvd(){Array.clear(this.nN);this.Zmc=-1}Heb(){const a=this.Fa.Je;
if(!a)return!1;const b=md.a("HeaderUiInLocalUndoScope")&&a.name===xc.a.Kva;return a.name!==xc.a.Ag&&a.name!==xc.a.Dpa&&a.name!==xc.a.kT&&a.name!==xc.a.aBa&&a.name!==xc.a.mQ&&!b||!this.oa.kz()||this.Ofk()?!1:!0}Vob(a){Ma.ObjectSpace.m5(this.graphSpace.ij,!1).Vob(a)}ddm(a){this.ka.hEb||this.cdm(a);this.bdm(a)}cdm(a){if(1<=this.Ih&&this.IGg(a)){const b=this.Ih-1,c=this.kh.ga(b),f=c.actionId;f!==a&&!this.IGg(f)||1!==this.ipa.$Bb(c.V7)||(this.kh.removeAt(b),this.Ih=this.kh.length-1)}}bdm(a){if(1<=this.Ih&&
this.lek(a)){const b=this.Ih-1,c=this.kh.ga(b).actionId;if(c===a||this.ehk(c))this.kh.removeAt(b),this.Ih=this.kh.length-1}}IGg(a){return a===G.a.WC||a===G.a.rEa||a===G.a.nUa||a===G.a.Nz||a===G.a.enter}ehk(a){return a===M.a.y9||a===M.a.ord}lek(a){return a===M.a.Xvb||a===M.a.Bsc||a===M.a.bNb}rWk(a,b){const c=this.C8d(this.HA.XU(),a);this.Xyb();a=new Fc(b,null,c,a,!1,this.t0g);this.kh.add(a);this.Ih=this.kh.length-1;return!0}kWk(a){let b=null;this.oa.nna()?b=this.oa.$ng():this.oa.kz()&&(b=this.oa.Zn());
b&&this.FZa.eAh(new rf.a(b,a))}YVk(a){const b=this.Ub.Pc(this.graphSpace);b.Gb(80);Object(gb.a)(688,b.lr).isDirty=!0;this.FZa.eAh(new rf.a(b.currentNode,a))}mhf(a){0>this.Ih||(this.kh.ga(this.Ih).snb=a)}I7c(){return!this.nN.length}x7c(a){for(const b of this.nN)if(b.V7===a)return!0;return!1}Ofk(){for(const a of this.oa.Hd())if(a.$a(yb.a.clearFormatting))return!0;return!1}}Object(m.a)(uh,"PPTUndoStack",Td,[]);class fj{constructor(a){this.cUk=a}S7i(a){const b=this.cUk.w2f(a);return new uh(a,()=>!!Ha.InteractiveViewManager.instance.$d,
new Hc.a(()=>ad.App.tT),Tb.a.instance.Ha("Common.Interface.IEditNotificationManager"),Fi.a.getInstance(),Da.a.getInstance(),Tb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Tb.a.instance.resolve("Box4.IAppFrame"),Tb.a.instance.resolve("Box4.IReplicationScheduler"),Tb.a.instance.resolve("Box4.ISelectionReferenceFactory"),Tb.a.instance.resolve("Common.ITaskManager"),Tb.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},U.a.instance.ga(70),Rb.a.instance,b.P0h,b.Q0h,b.U0h,new Ib(ad.App.tVf),
Tb.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Tb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),Tb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),Tb.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),Tb.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),Tb.a.instance.resolve("Common.IFocusManager"),Tb.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
Tb.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Tb.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),Tb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Tb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,Tb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
Tb.a.instance.ze("Box4.ICoauthCashTelemetry"),Object(md.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(m.a)(fj,"PPTUndoStackFactory",null,[640]);class Wi{constructor(){this.acd=new uc.a}iam(a){this.acd.raiseEvent("MU",a)}$2b(a){this.acd.addHandler("MU",a)}j3e(a){this.acd.removeHandler("MU",a)}dispose(){this.acd.dispose()}}Object(m.a)(Wi,"UndoEventSource",null,[641,642,643,106]);class eh{constructor(a,b){this.Cjb=0;this.yjd=null;this.XJe=!1;this.Pt=a;this.jh=b;this.jh.uLf(Object(R.a)(this,
this.olh,"onBeforeForceOutboundGraphTransactionInitialize"));this.jh.tLf(Object(R.a)(this,this.Ood,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.jh.GDh(Object(R.a)(this,this.olh,"onBeforeForceOutboundGraphTransactionInitialize"));this.jh.KAl(Object(R.a)(this,this.Ood,"onForceOutboundGraphTransactionDisposed"))}fkm(a){return 1===this.Cjb&&this.yjd?this.yjd:a}nck(){1===this.Cjb&&(this.XJe=!0)}olh(a,b){this.KGg(b.transaction.qBa)&&(this.Cjb+=1,1===this.Cjb&&(this.yjd=this.Pt.ZX()))}Ood(a,
b){this.KGg(b.transaction.qBa)&&(1===this.Cjb&&(this.yjd=null,this.XJe||(a=this.Pt.ZX(),this.Pt.mhf(a)),this.XJe=!1),--this.Cjb)}KGg(a){return 8===(a&8)}}Object(m.a)(eh,"UndoSelectionUpdater",null,[140,106]);var El=d(606);class Nh{constructor(a,b,c){this.HA=a;this.oPd=b;this.uXd=c;this.Y_=Ma.ObjectSpace.j$(this.HA.ij)}Mlb(a,b,c){a=this.uXd.l6i(this.oPd?a.uzc:b.Azb,this.oPd?b.Azb:a.uzc,this.Y_,c,ad.App.vOa);if(b=!!a)this.Y_=a;return b}$xh(a){const b=new pa.a;b.Obf(this.HA.ij,this.Y_);a(b);a=b.rYc();
Ma.ObjectSpace.m5(this.HA.ij,!1).Vob(a);this.Y_=a;return!!a}aAe(){const a=new El.a(Ma.ObjectSpace.j$(this.HA.ij),this.Y_);this.HA.KFb(a)}get pfb(){return this.oPd}get zna(){return this.Y_.id}}Object(m.a)(Nh,"Box4UndoRedoPerformer",null,[702]);class Mk{constructor(a,b){this.P0h=c=>{c&&this.HA.qia();c=Ma.ObjectSpace.j$(this.HA.ij);return new cc(c)};this.Q0h=c=>new Nh(this.HA,c,this.uXd);this.U0h=c=>{if(c.i9d&&(this.HA.XU()&&this.HA.qia(),c.i9d&&(c=c.i9d))){var f=Ma.ObjectSpace.j$(this.HA.ij);c.Azb=
f}};this.HA=a;this.uXd=b}}Object(m.a)(Mk,"Box4UndoStackDataSyncHelper",null,[687]);class Ym{constructor(a){this.Lqi=a}w2f(a){return new Mk(a,this.Lqi(a.ij))}}Object(m.a)(Ym,"Box4UndoStackDataSyncHelperFactory",null,[639]);class nj{constructor(a,b){var c,f;this.S_a=[];this.PKb=null!==(c=null===a||void 0===a?void 0:a.undoOperation)&&void 0!==c?c:null;this.bjd=null!==(f=null===a||void 0===a?void 0:a.revisionId)&&void 0!==f?f:Ua.a.nil;this.S_a=w(null===a||void 0===a?void 0:a.idb,b);this.pmc=b}get V7(){return this.bjd}get qbe(){return this.bjd}get iL(){return this.S_a}perform(){try{if(this.PKb){const a=
this.PKb.perform();this.PKb=a.undoOperation;this.S_a=w(a.idb,this.pmc);return a}}catch(a){da.ULS.sendTraceTag(509097475,844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.PKb&&this.PKb.combineWithPrevious(a.PKb)}dispose(){}}Object(m.a)(nj,"FluidUndoRecordData",null,[704,106]);class Io{constructor(a,b){this.jkc=[];this.$gb=a;this.fMk=b}Mlb(a){return a?(a=a.perform(),this.fxh(a)):!1}$xh(a){const b=this.$gb.ij.Edj.CTc();b.start(this.$gb.ij);a(b);a=b.finish();
return this.fxh(a)}aAe(){this.jkc.forEach(a=>{this.$gb.KFb(a)})}get pfb(){return this.fMk}get zna(){return 0<this.jkc.length?this.jkc[this.jkc.length-1].yna:Ua.a.nil}fxh(a){return a?(a.idb&&this.jkc.push(...a.idb),!0):!1}}Object(m.a)(Io,"FluidUndoRedoPerformer",null,[702]);class aq{constructor(a){this.P0h=(b,c,f)=>{c=f;b&&(b=this.$gb.qia())&&(c=b,f&&(c.idb.unshift(...f.idb),c.undoOperation.combineWithPrevious(f.undoOperation)));return new nj(c,this.$gb.ij)};this.Q0h=b=>new Io(this.$gb,b);this.U0h=
()=>{};this.$gb=a}}Object(m.a)(aq,"FluidUndoStackDataSyncHelper",null,[687]);class yp{w2f(a){return new aq(a)}}Object(m.a)(yp,"FluidUndoStackDataSyncHelperFactory",null,[639]);class Jo{constructor(a){this.PV=a}Iim(a){this.PV.t3h(a,1);this.PV.Tjm(a)}}Object(m.a)(Jo,"PPTInverseRevisionUpdater",null,[193]);class zp{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}fc(a){this.K=a;a.register(ap,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(vn,
"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().na(()=>new vn(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(136,"Box4.ISelectionReferenceFactory").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new Na(hm.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.RD,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
b.Cm):hm.SelectionReferenceFactory.instance});a.register(rc,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();a.register(kb,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").iFa?a.register(yp,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(Ym,
"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().na(()=>new Ym(b=>new Fa(Ma.ObjectSpace.m5(b,a.resolve("PowerPointWebEditor.IApplicationSettings").iFa),a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new z,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Jo(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(fj,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().na(()=>
new fj(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(mj,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().na(()=>new mj(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(Hb,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().na(()=>
new Hb(a.resolve("Box4.UndoRedo.IUndoStackFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(137,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().na(()=>new db);a.register(Wi,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.eZi(a);
this.iZi(a);a.register(138,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().na(()=>new Yp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}eZi(a){a.register(139,"PowerPointWebEditor.ITablePartialEditController").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");
return b.Mrk?new kl(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.hEb):new xp})}iZi(a){a.register(140,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().na(()=>new eh(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");var b=this.K.resolve("Box4.IPageView");b.Zg&&(b=b.Zg.Dp(),a.register(b),a.setActive(b),a.L0a(G.a.gXa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){C.a.instance.Ac(new zp)}}Object(m.a)(zp,"PPTWebEditorUndoRedoPackage",null,[2,3]);class Jn{constructor(a,b,c,f,l,u,I){this.RXa=void 0===a?!1:a;this.pwe=void 0===
c?!1:c;this.tdb=void 0===f?!1:f;this.Cec=void 0===l?!1:l;this.Hec=void 0===u?!1:u;this.d7c=void 0===I?!1:I}}Object(m.a)(Jn,"DocModeSwitcherData",null,[]);var bq=d(871);class Ap{constructor(a,b,c,f,l){this.THb=!1;this.eNe=null;this.aOd=this.rPd=this.DOd=this.NOd=this.GOd=this.aPd=this.vOd=this.dPd=this.zCa=this.lOd=this.sOd=this.KOd=this.hOd=this.COd=this.Zvf=!1;this.rc=a;this.Ql=b;this.Nc=c;this.Mw=l;this.dWg=f.Hjk;this.mxa=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.EQk=A.AFrameworkApplication.WA;
this.reset()}initialize(){this.Nc.eea(Object(R.a)(this,this.Bz,"onUnifiedAppStateChanged"));this.Nc.xSa(Object(R.a)(this,this.orc,"onOutboundReplication"));this.eNe=[Object(R.a)(this,this.nSi,"checkIsInlineRepairedDocument"),Object(R.a)(this,this.kSi,"checkIrmProtection"),Object(R.a)(this,this.USi,"checkUserPermission"),Object(R.a)(this,this.LRi,"checkFileFormats"),Object(R.a)(this,this.MRi,"checkFileLock"),Object(R.a)(this,this.xSi,"checkPasswordProtection"),Object(R.a)(this,this.ORi,"checkFontRestriction"),
Object(R.a)(this,this.oSi,"checkIsMarkedFinal"),Object(R.a)(this,this.pSi,"checkIsMarkedReadOnlyRecommended"),Object(R.a)(this,this.ESi,"checkSessionRestriction"),Object(R.a)(this,this.DSi,"checkSessionAccessTokenExpired"),Object(R.a)(this,this.uSi,"checkNetworkIssueHappened"),Object(R.a)(this,this.zSi,"checkPopsHostIssueHappened"),Object(R.a)(this,this.aTi,"checkWopiAccessTokenOutOfRefreshRange"),Object(R.a)(this,this.mSi,"checkIsEmergencyViewMode")];this.fIh(this.eNe)}dispose(){this.Nc.Hmb(Object(R.a)(this,
this.Bz,"onUnifiedAppStateChanged"))}reset(){this.aOd=this.sOd=this.rPd=this.DOd=this.NOd=this.GOd=this.aPd=this.vOd=this.dPd=this.lOd=this.KOd=this.zCa=this.hOd=this.COd=this.Zvf=!1}Bz(a,b){ya.a.J(508692319,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.veb&&this.rc.fp||(this.Ql.c6f(),this.fIh(this.eNe))}orc(){this.mxa&&!this.THb&&(this.THb=!0);this.rc.OM||ya.a.J(508692318,801,15,"Outbound on RO mode")}fIh(a){if(a)for(const b of a)if(b())break}LRi(){if(this.qik||!this.rc.Bg(64)||
this.dWg&&!(this.rc.Bg(4)&&this.rc.Bg(16)&&this.rc.Bg(8)))return!0;if(!this.rc.getState(64))return!1;if(this.dWg&&this.rc.getState(4)&&!this.rc.getState(16)&&!this.rc.getState(8)){var a=A.AFrameworkApplication.Pa.Ia(M.a.uFa,2,Object.assign(new Jn,{d7c:!0,tdb:this.rc.getState(1)}));ya.a.J(508692317,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.Ql.oM(10);ya.a.J(508692316,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=
A.AFrameworkApplication.Pa.Ia(M.a.uFa,2,Object.assign(new Jn,{Hec:!0,tdb:this.rc.getState(1)})),ya.a.J(508692315,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.hOd=!0}kSi(){return this.Hkk||!this.rc.Bg(32768)?!0:this.rc.getState(32768)?(this.Ql.oM(14),this.vOd=!0,ya.a.J(508692314,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}MRi(){return this.tik?!0:this.rc.Bg(128)&&this.rc.getState(128)?
(this.Ql.oM(3),this.zCa=!0,ya.a.J(508692313,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),!0):this.rc.Bg(256)&&this.rc.getState(256)?(this.Ql.oM(4),this.zCa=!0,ya.a.J(508692312,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.rc.Bg(512)&&this.rc.getState(512)?(this.Ql.oM(5),this.zCa=!0,ya.a.J(508692311,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),
!0):this.rc.Bg(1024)&&this.rc.getState(1024)?(this.Ql.oM(6),this.zCa=!0,ya.a.J(508692310,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),!0):this.rc.Bg(2048)&&this.rc.getState(2048)?(this.Ql.oM(7),this.zCa=!0,ya.a.J(508692309,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.rc.Bg(4096)&&this.rc.getState(4096)?(this.Ql.oM(8),this.zCa=!0,ya.a.J(508692308,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),
!0):this.rc.Bg(8192)&&this.rc.getState(8192)?(this.Ql.oM(9),this.zCa=!0,ya.a.J(508692307,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),!0):!1}oSi(){if(this.wlk||!this.rc.Bg(2)||!this.rc.Bg(16))return!0;if(!this.rc.getState(2)&&this.rc.getState(16)){const a=A.AFrameworkApplication.Pa.Ia(M.a.uFa,2,Object.assign(new Jn,{RXa:!0,tdb:this.rc.getState(1)}));ya.a.J(508692306,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());
return this.COd=!0}return!1}pSi(){if(this.xlk||!this.rc.Bg(2)||!this.rc.Bg(524288))return!0;if(!this.rc.getState(2)&&this.rc.getState(524288)){const a=A.AFrameworkApplication.Pa.Ia(M.a.uFa,2,Object.assign(new Jn,{pwe:!0,tdb:this.rc.getState(1)}));ya.a.J(508692305,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.DOd=!0}return!1}xSi(){if(this.nnk||!this.rc.Bg(2)||!this.rc.Bg(32))return!0;if(!this.rc.getState(2)&&this.rc.getState(32)){const a=
A.AFrameworkApplication.Pa.Ia(M.a.uFa,2,Object.assign(new Jn,{Cec:!0,tdb:this.rc.getState(1)}));ya.a.J(508692304,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());return this.KOd=!0}return!1}nSi(){return this.nkk||!this.rc.Bg(2097152)?!0:this.rc.getState(2097152)?(this.Ql.oM(22),this.sOd=!0,ya.a.J(508692303,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}mSi(){var a=!1;if(this.Thk||!this.rc.Bg(4194304))return!0;this.rc.getState(4194304)&&
(a="NotAvailable",this.Mw&&(a=this.Mw.ZAb(),a=bq.a[a]),eg.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===A.AFrameworkApplication.Pa.nb(M.a.Ozc,1)?(a=A.AFrameworkApplication.Pa.nb(M.a.Ozc,2),ya.a.J(508692302,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.Ql.oM(23),ya.a.J(508692301,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.aOd=a=!0);
return a}ORi(){return!this.Uik&&this.rc.Bg(2)&&this.rc.Bg(8)?!this.rc.getState(2)&&this.rc.getState(8)?(this.Ql.oM(12),this.lOd=!0,ya.a.J(508692300,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),!0):!1:!0}USi(){if(this.Chk||!this.rc.Bg(1))return!0;if(!this.rc.getState(1)){const a=A.AFrameworkApplication.Pa.Ia(M.a.uFa,2,new Jn);ya.a.J(508692299,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}ESi(){return this.fqk?!0:this.rc.Bg(16384)&&
this.rc.getState(16384)?(this.Ql.oM(13),this.dPd=!0,ya.a.J(508692298,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}DSi(){return this.dqk?!0:this.rc.Bg(65536)&&this.rc.getState(65536)?(eg.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.mxa?this.Ql.EVc(15,this.THb):this.Ql.oM(15),this.aPd=!0,ya.a.J(508692297,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}zSi(){return this.Tnk?
!0:this.rc.Bg(262144)&&this.rc.getState(262144)&&this.mxa?(this.Ql.EVc(17,this.THb),this.NOd=!0,ya.a.J(508692296,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}aTi(){return this.Mtk?!0:this.rc.Bg(1048576)&&this.rc.getState(1048576)&&this.mxa&&this.EQk?(this.Ql.EVc(21,this.THb),this.rPd=!0,ya.a.J(508692295,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}uSi(){return this.Tlk?!0:this.rc.Bg(131072)&&this.rc.getState(131072)&&
this.mxa?(this.Ql.EVc(16,this.THb),this.GOd=!0,ya.a.J(508692294,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get Chk(){return this.Zvf}get wlk(){return this.COd}get qik(){return this.hOd}get nnk(){return this.KOd}get nkk(){return this.sOd}get Uik(){return this.lOd}get tik(){return this.zCa}get fqk(){return this.dPd}get Hkk(){return this.vOd}get dqk(){return this.aPd}get Tlk(){return this.GOd}get Tnk(){return this.NOd}get xlk(){return this.DOd}get Mtk(){return this.rPd}get Thk(){return this.aOd}}
Object(m.a)(Ap,"ReadOnlyUIManager",null,[129,106]);class Aq{constructor(a,b,c,f,l,u,I){this.eWg=!1;this.Bz=()=>{ya.a.J(509367064,809,50,"FilterPrivacyUIManager::OnUnifiedAppStateChanged");this.cce()};this.wik=()=>!this.Lb.getBooleanAppSetting("FilterPrivacyBusinessBarEnabled")||this.eWg?!1:this.rc.Bg(16777216)?this.rc.getState(16777216):(ya.a.J(509367063,809,50,"FilterPrivacyUIManager::IsFilterPrivacyEnabled - Business bar not displayed, filterPrivacyEnabled field not ready"),!1);this.cce=()=>{this.wik()&&
(this.Wj.amIAlone?(ya.a.J(508842016,809,50,"FilterPrivacyUIManager::EvaluateBusinessBarRequirements - !isCoauthoringActive"),this.rF.gOc(this.GLa)):this.Lb.getBooleanAppSetting("KeepFilterPrivacyClickCountRoamingEnabled")?this.lHe.getKeepFilterPrivacyClickCount(this.EUe):this.n6f())};this.GLa=(T,ja)=>{2===ja.rSe&&(ya.a.J(508842015,809,50,"FilterPrivacyUIManager::OnCoauthStatusChanged - e.newStatus === CoauthorStatus.coauthoring"),this.cce());this.rF.lvd(this.GLa)};this.EUe=T=>{T<this.DZg?this.n6f():
ya.a.J(508895451,809,50,`FilterPrivacyUIManager::OnGetKeepFilterPrivacyClickCountSucceeded - keepFilterPrivacyClickCount at maximum (${this.DZg})`)};this.n6f=()=>{this.Ql.oM(27);this.eWg=!0;ya.a.J(509366796,809,15,"FilterPrivacyUIManager::DisplayFilterPrivacyBusinessBar - Business bar displayed")};if(!f)throw Error.argumentNull("appSettingsManager");this.rc=a;this.Ql=b;this.Nc=c;this.Lb=f;this.Wj=l;this.rF=u;this.lHe=I}initialize(){this.Nc.eea(this.Bz);this.DZg=this.Lb.tc("KeepFilterPrivacyMaxClickCount",
3);this.cce()}dispose(){this.Nc.Hmb(this.Bz)}}Object(m.a)(Aq,"FilterPrivacyUIManager",null,[130,106]);var ro=d(249);class Kn{constructor(a,b,c){this.xJa=this.voa=!0;this.EUe=l=>{this.xJa=!0;try{let u=null;l.data.Ud&&0<l.data.Ud.trim().length&&(u=JSON.parse(l.data.Ud));const I=l.data.state;I(u)}catch(u){ya.a.J(508909132,824,10,`FilterPrivacyRoamingCacheProxy::OnGetKeepFilterPrivacyClickCountSucceeded - Exception caught: ${u.toString()}`)}ya.a.J(508909131,824,50,`FilterPrivacyRoamingCacheProxy:OnGetKeepFilterPrivacyClickCountSucceeded - ResponseSize=${0}, EnqueueTimeMS=${JSON.stringify(l.data.cF)}, InvokedTimeMS=${JSON.stringify(l.data.Et)}, CompletedTimeMS=${JSON.stringify(l.data.au)}`)};
this.K5k=l=>{this.xJa=!0;l=this.Tga.n$(l);ya.a.J(508909130,824,10,`FilterPrivacyRoamingCacheProxy:OnGetKeepFilterPrivacyClickCountFailed - ${l}`)};this.v8k=l=>{this.voa=!0;ya.a.J(508908743,824,50,`FilterPrivacyRoamingCacheProxy:OnPutKeepFilterPrivacyClickCountSucceeded - EnqueueTimeMS=${JSON.stringify(l.data.cF)}, InvokedTimeMs=${JSON.stringify(l.data.Et)}, CompletedTimeMS=${JSON.stringify(l.data.au)}`)};this.u8k=l=>{this.voa=!0;l=this.Tga.n$(l);ya.a.J(508909129,824,10,`FilterPrivacyRoamingCacheProxy::OnPutKeepFilterPrivacyClickCountFailed - ${l}`)};
const f=[];a||f.push("clientRequestManager");b||f.push("jsonpHelperManager");c||f.push("appSettings");if(f.length)throw Error.argumentNull(f.join());this.Ms=a;this.Tga=b;this.ka=c}get hHg(){return this.voa}getKeepFilterPrivacyClickCount(a){if(this.xJa){ya.a.J(508909135,824,50,"FilterPrivacyRoamingCacheProxy::GetKeepFilterPrivacyClickCount");var b=this.ka.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTKeepFilterPrivacyClickCount",A.AFrameworkApplication.mh),
c={};c["X-StatelessPopsAffinityRoutingEnabled"]=this.ka.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ms.Tj(b,1,null,c,!1,2,this.EUe,this.K5k,a,void 0,void 0,void 0,void 0,ro.a("18"));this.xJa=!1}else ya.a.J(508909136,824,50,"FilterPrivacyRoamingCacheProxy::GetKeepFilterPrivacyClickCount - Response of previous get roaming request is not back yet.")}W7j(){if(this.voa){ya.a.J(508909133,824,50,"FilterPrivacyRoamingCacheProxy::IncrementKeepFilterPrivacyClickCount");var a=this.ka.roamingServiceHandlerWebServiceBase+
String.format("RoamingServiceHandler.ashx?action={0}&{1}","incrementPPTKeepFilterPrivacyClickCount",A.AFrameworkApplication.mh);if(A.AFrameworkApplication.fa.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled"))this.Ms.Mqa(a,null);else{const b={};b["X-StatelessPopsAffinityRoutingEnabled"]=this.ka.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ms.Tj(a,2,null,b,!1,2,this.v8k,this.u8k,void 0,void 0,void 0,void 0,void 0,ro.a("19"))}this.voa=!1}else ya.a.J(508909134,824,50,"FilterPrivacyRoamingCacheProxy::IncrementKeepFilterPrivacyClickCount - Response of previous write roaming request is not back yet.")}dispose(){}}
Object(m.a)(Kn,"FilterPrivacyRoamingCacheProxy",null,[202,106]);class cq{constructor(){this.mHe=this.rnc=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}fc(a){this.K=a;this.K.register(129,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().na(()=>new Ap(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")));this.K.register(130,"PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager").ma().na(()=>new Aq(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
new Kn(A.AFrameworkApplication.Me,a.resolve("PowerPointWebEditor.IJsonpHelperManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").DHa&&(this.rnc=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.mHe=this.K.resolve("PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager"),this.rnc.initialize(),this.mHe.initialize())}dispose(){this.rnc&&this.rnc.dispose();this.rnc&&this.mHe.dispose()}static main(){C.a.instance.Ac(new cq)}}
Object(m.a)(cq,"PPTWebEditorUnifiedAppPackage",null,[2,3]);var Ji=d(281);class dq{constructor(a,b,c,f){this.yb=a;this.ns=b;this.EF=c;this.qxa=f}vma(){const a=new Md.a;a.$(0,Object(R.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(R.a)(this,this.pptTableColumnHandleClickHandler,"pptTableColumnHandleClickHandler"));a.$(2,Object(R.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(R.a)(this,this.backgroundClickHandler,
"backgroundClickHandler"));a.$(4,Object(R.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.ns.T5(a.Ec)||this.ns.mYa(a.Ec)||this.ns.g9c(a.Ec)?(this.yb.Fzb(),Ji.a.Lm(!0)):Ji.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.ns.vwa(a.Ec)){const b=this.ns.ple(a.Ec);if(!b||!b.ol)return ya.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),Ji.a.Lm(!1);b.ol.Mq||this.ns.pSc(a.Ec,a.zW,a.Uj.wg);
return Ji.a.Lm(!0)}return Ji.a.notHandled}pptTableRowHandleClickHandler(a){if(this.ns.lgc(a.Ec)){const b=this.ns.ple(a.Ec);if(!b||!b.ol)return ya.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),Ji.a.Lm(!1);b.ol.Mq||this.ns.mIl(a.Ec,a.zW,a.Uj.wg);return Ji.a.Lm(!0)}return Ji.a.notHandled}backgroundClickHandler(a){return this.yb.agc(a)?(this.qxa.setVisibility(!1),Ji.a.Lm(!0)):Ji.a.notHandled}shapeClickHandler(a){let b=Ji.a.notHandled;this.EF.Ufc||(b=this.EF.m9e(a));
this.EF.Ufc=!1;if((a=this.EF.NAb(a))&&!a.qK||a&&a.shapeNode&&a.shapeNode.vd&&a.qK)return Ji.a.Lm(!0);this.qxa.setVisibility(!1);return b}}Object(m.a)(dq,"ClickHandlers",null,[]);var wn=d(433),Ln=d(438);class Mm{constructor(a,b,c,f,l,u){this.yb=a;this.oa=b;this.Fa=c;this.ia=f;this.EF=l;this.vJb=u}vma(){const a=new Md.a;a.$(0,Object(R.a)(this,this.noContextMenuHandler,"noContextMenuHandler"));a.$(1,Object(R.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(R.a)(this,
this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.yb.yQh(a)?wn.a.notHandled:wn.a.Lm(null)}slideBackgroundContextMenuHandler(a){return this.yb.agc(a)?(this.oa.Pu(),this.oa.Bh(),this.Fa.Gd(),this.ia.Ia(M.a.M6d,2,a.Uj),wn.a.Lm(null)):wn.a.notHandled}shapeContextMenuHandler(a){var b=this.EF.NAb(a);if(this.qZl(b,a))b.JFa(),this.vJb?b.lz||this.ia.Ia(M.a.WSa,2,new Ln.a(b.shapeNode,!0,a.Uj)):this.ia.Ia(M.a.WSa,2,new Ln.a(b.shapeNode,!0,a.Uj));else if(this.mZl(b))return this.oa.Pu(),
(b=this.EF.sMj(b,a))&&this.oa.selectShape(b,!0),this.Fa.Gd(),this.ia.Ia(M.a.L6d,2,a.Uj),wn.a.Lm(null);return wn.a.notHandled}qZl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.vGg&&!a.EDb(b.Uj)}mZl(a){return!!a||this.oa.nI()||!this.oa.Oa.length}}Object(m.a)(Mm,"ContextMenuClickHandlers",null,[]);class dp{constructor(a,b,c){this.yb=a;this.ns=b;this.EF=c}vma(){const a=new Md.a;a.$(0,Object(R.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));
a.$(1,Object(R.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(R.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.ns.T5(a.Ec)||this.ns.mYa(a.Ec)||this.ns.g9c(a.Ec)?(this.yb.Fzb(),Ji.a.Lm(!0)):this.ns.vwa(a.Ec)||this.ns.lgc(a.Ec)?(this.yb.Fzb(),Ji.a.Lm(!1)):Ji.a.notHandled}shapeDoubleClickHandler(a){return this.EF.NAb(a)?(this.yb.Fzb(),Ji.a.Lm(!1)):Ji.a.notHandled}backgroundDoubleClickHandler(a){return this.yb.agc(a)?
(this.yb.Fzb(),Ji.a.Lm(!0)):Ji.a.notHandled}}Object(m.a)(dp,"DoubleClickHandlers",null,[]);class Ko{constructor(a,b,c,f,l){this.EF=a;this.iE=b;this.ia=c;this.Ga=f;this.EP=l}Dlg(){return Object(R.a)(this,this.Omd,"mouseUpHandlerFilter")}Omd(a){return a?(a=this.iE.dke(a.Ec))&&a.eb&&this.Ga.Gn(a.eb)&&this.EP.pYa&&this.EF.Y9e?(this.ia.nb(G.a.hfa,2),!0):this.EF.Y9e=!1:!1}}Object(m.a)(Ko,"MouseInputHandlers",null,[]);var tm=d(263);class so{constructor(a,b,c,f){this.EF=a;this.Db=b;this.j2=c;this.De=f}vma(){const a=
new Md.a;a.$(0,Object(R.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(R.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,Object(R.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.zem();return this.EF.HQf(a)}zem(){this.De.Wte()||$c.a.oce("ScrollActiveThumbnailIntoView",M.a.lnb,()=>{this.De.ixd();return 32})}shapePointerDownHandler(a){this.Db.wY&&this.j2.show(3,-1);const b=
this.EF.NAb(a);if(b&&b.shapeNode&&b.shapeNode.ig&&!b.shapeNode.Rg)return Ji.a.Lm(!1);if((Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.Zqa)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.iob)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.Szd)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.uCd)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.LWh)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.ZWh))&&b.isSelected&&!b.qK||void 0!==b&&null!==b&&b.shapeNode.Vp)return this.EF.Ufc=!1,Ji.a.Lm(!0);this.EF.Ufc=!0;
a=this.EF.m9e(a);a.x5&&(this.EF.Y9e=!0);return a}defaultPointerDownHandler(){return Ji.a.Lm(!0)}}Object(m.a)(so,"PointerDownHandlers",null,[]);class ai{constructor(a){this.EF=a}vma(){const a=new Md.a;a.$(0,Object(R.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(R.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(R.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(2,Object(R.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));
return a}backgroundPointerUpHandler(a){return this.EF.HQf(a)}shapePointerUpHandler(a){const b=this.EF.NAb(a);return b&&b.shapeNode&&b.shapeNode.ig&&!b.shapeNode.Rg?Ji.a.Lm(!1):this.EF.m9e(a)}defaultPointerUpHandler(){return Ji.a.Lm(!0)}}Object(m.a)(ai,"PointerUpHandlers",null,[]);class vr extends Sys.EventArgs{constructor(){super()}}Object(m.a)(vr,"SlideBackgroundClickedEventArgs",Sys.EventArgs,[]);class wr{constructor(a,b,c,f,l,u,I,T){this.yb=a;this.ns=b;this.oa=c;this.qxa=f;this.Fa=l;this.UK=u;
this.apa=I;this.Ga=T;this.Y9e=this.Ufc=!1}HQf(a){return this.yb.agc(a)?(this.oa.Pu(),a=a.Uj,this.UK.Uzh(new vr(!1)),(a.ctrlKey||a.shiftKey)&&a.xB===Sys.UI.MouseButton.leftButton?this.oa.uj():this.oa.Bh(),this.qxa.setVisibility(!1),this.Fa.Gd(),Ji.a.Lm(!0)):Ji.a.notHandled}m9e(a){const b=this.NAb(a);b&&this.oa.Pu();const c=Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.Zqa)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.iob)||Sys.UI.DomElement.containsCssClass(a.Ec,tm.a.Szd),f=this.ns.g9c(a.Ec)||this.ns.T5(a.Ec)||
this.ns.mYa(a.Ec);$c.a.Xk("isEventFromHandlers",c.toString());$c.a.Xk("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.qK?(this.oa.uj(),this.qxa.setVisibility(!1),this.Fa.Gd(),Ji.a.Lm(!0)):f&&b&&!b.qK?(b.klh(a.Uj),Ji.a.Lm(!0)):!b||b.qK&&!this.aue(a)?Ji.a.notHandled:(b.G9k(a.Uj),Ji.a.Lm(!0))}NAb(a){let b=this.ns.aK(a.Ec);if(!b){var c=a.Ec,f=Ac.a(c,na.a.role);f=f?f.toString()===Qe.a.P3b:!1;if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.ns.aK(c);if(Sys.UI.DomElement.containsCssClass(c,
"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(gb.a)(178,b);if(!c&&(this.ns.g9c(a.Ec)||this.ns.T5(a.Ec)||this.ns.mYa(a.Ec))&&(c=this.apa.Y$b(this.Ga.Gn(b.eb)),!c))return ya.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.apa.Y$b(this.Ga.Gn(b.eb)))&&c.wC&&!(c.lz||c.Mq||c.qye))return c}return null}aue(a){return a&&a.Ec?a.Ec.id.startsWith(jf.a.I9a):!1}sMj(a,b){return a?this.rMj(a):
this.qMj(b.graphNode)}rMj(a){let b=null;a.isSelected&&this.oa.nI()||(b=Object(gb.a)(4,a.eb));return b}qMj(a){let b=null;if(a){const c=mb.GraphIterator.ob(a);c.uc(10)?(a=Object(gb.a)(4,c.Ug(10)),this.oa.zY(a)||(b=a)):ya.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(m.a)(wr,"ViewEventHandlerHelper",null,[194]);class Bq{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}fc(a){this.K=a;a.register(dq,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().na(()=>
new dq(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(dp,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().na(()=>new dp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper")));a.register(Mm,
"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().na(()=>new Mm(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(so,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().na(()=>
new so(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));a.register(ai,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().na(()=>new ai(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(Ko,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().na(()=>
new Ko(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(wr,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().na(()=>new wr(a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.Wsi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").vma());
a.Pti(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").vma());a.Ati(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").vma());a.xvi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").vma());a.Avi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").vma());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").xb(la.a.WK,a.container,
this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").Dlg())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").Hb(la.a.WK,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").Dlg())}static main(){C.a.instance.Ac(new Bq)}}Object(m.a)(Bq,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var oe=d(74),Mn;
(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(Mn||(Mn={}));Object(m.b)("WebSocketCompressionHelperLoadState",Mn);var Fl=d(89),yv=d(314),ep;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(ep||(ep={}));Object(m.b)("WebSocketState",ep);class $r{constructor(a,b,c,f,l){this.Gmc=this.Am=this.TKb=null;this.iKa=-1;this.Lhb=this.Vna=0;this.Cic=-1;this.vIb=0;this.wIb=null;this.iZa=0;if(!a)throw Error.argumentNull("webSocketClient");
this.Qw=a;this.Xa=b;this.BF=c;this.Nc=f;a=document.createElement("a");a.href=this.Qw.Eom;a.protocol="http:"===a.protocol?"ws":"wss";md.a("PodsWebSocketFrontDoor.UseQueryString")?(a=new Dm.QueryStringBuilder(a.href),md.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.zg(Gg.a.Ysh,b.$k),md.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.zg(Gg.a.odl,A.AFrameworkApplication.userSessionId),a.zg(Gg.a.xsc,l.toString()),this.TKb=a.toString()):this.TKb=a.href;this.Phb=oe.a.GD(this.TKb);this.g6b(2);
this.Woa=this.Qw.dHh;this.PCe=this.Qw.mVi;this.k9e();this.Nc.dEa(Object(R.a)(this,this.Rkb,"onSessionEnding"));this.Nc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"))}dispose(){this.Nc.uvd(Object(R.a)(this,this.Rkb,"onSessionEnding"));this.Nc.Wba(Object(R.a)(this,this.mo,"onSessionRehydrated"))}g6b(a){this.Am&&this.Am.close();this.Am=new WebSocket(this.TKb,[]);this.Am.onopen=Object(R.a)(this,this.onOpen,"onOpen");this.Am.onerror=Object(R.a)(this,this.onError,"onError");this.Am.onclose=Object(R.a)(this,
this.onClose,"onClose");this.Am.onmessage=Object(R.a)(this,this.onMessage,"onMessage");this.iZa=a;ya.a.J(556541794,this.Qw.ZR,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",this.Phb,this.Xa.$k,this.iZa)}ping(){if(this.Am)if(1===this.Am.readyState){const a=this.Qw.G5i();this.Am.send(a)}else ya.a.J(559284698,this.Qw.ZR,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Am.readyState),this.cAa(4);else ya.a.J(559284697,
this.Qw.ZR,50,"WebSocketFetcher::Ping Websocket is unavailable.")}tVi(){this.Am.close()}onOpen(){ya.a.J(591208995,this.Qw.ZR,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.Phb,this.Xa.$k);this.jwc();this.vIb=0;this.wIb=null;this.Qw.X3k()}onError(a){ya.a.J(591208993,this.Qw.ZR,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.Phb,this.Xa.$k)}onClose(a){ya.a.J(591208991,this.Qw.ZR,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",
this.Phb,this.Xa.$k,JSON.stringify(a),a.code,a.reason);this.vIb=a.code;this.wIb=a.reason}onMessage(a){try{a&&a.data&&this.Qw.cVe(a)}catch(b){ya.a.J(559284699,this.Qw.ZR,10,"WebSocketFetcher::OnMessage",b.toString())}}k9e(){this.Gmc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Cic),this.Am||(ya.a.J(559284700,this.Qw.ZR,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.cAa(1))):this.Cic=window.setTimeout(()=>{this.Am&&(ya.a.J(559284701,
this.Qw.ZR,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.vIb=1E3,this.wIb="Lost visibility",this.Am.close(this.vIb,this.wIb),this.Am=null,window.clearTimeout(this.iKa))},this.PCe)};window.self.addEventListener("visibilitychange",this.Gmc)}jwc(){this.Vna=0}Q_d(){0<this.Qw.Bmd&&(new Date).getTime()-this.Lhb>this.Qw.Bmd&&(this.jwc(),ya.a.J(559284702,this.Qw.ZR,50,"WebSocketFetcher::Retry connect to server after long pause."))}Q3d(){const a=!!this.BF&&!!this.BF.instance&&
!this.BF.instance.s1,b=(new Date).getTime()-this.Lhb>this.Woa,c=this.Vna<this.Qw.Egh,f=!this.Am||3===this.Am.readyState||2===this.Am.readyState,l=a&&b&&c&&f;ya.a.J(557181E3,this.Qw.ZR,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",l,a,b,c,f);return l}u8e(){this.Lhb=(new Date).getTime();this.Woa=Math.pow(2,this.Vna)*this.Qw.dHh;0<this.Qw.Bmd&&(this.Woa=Math.min(this.Woa,this.Qw.Bmd));window.setTimeout(()=>{this.cAa(3)},
this.Woa)}cAa(a){this.Q_d();this.Q3d()&&(this.g6b(a),this.u8e(),this.Vna++,a!==this.iZa&&ya.a.J(541671620,this.Qw.ZR,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.iZa),ya.a.J(559284703,this.Qw.ZR,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",this.iZa),this.Vna===this.Qw.Egh&&ya.a.J(559284704,this.Qw.ZR,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.iZa))}sendMessage(a,b){if(!this.Am)return ya.a.J(559284705,
this.Qw.ZR,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.vIb,this.wIb),1;ya.a.J(559284706,this.Qw.ZR,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",ep[this.Am.readyState],b,this.vIb,this.wIb);if(1===this.Am.readyState)return this.Am.send(a),0;this.cAa(5);return 2}dVl(){this.Am.binaryType="arraybuffer"}pMb(){-1!==this.iKa&&window.clearTimeout(this.iKa);this.iKa=
window.setTimeout(()=>{this.ping()},this.Qw.agl)}PTi(){this.iZa=0}Rkb(){this.Am&&(ya.a.J(557352418,this.Qw.ZR,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Am.close(),this.Am=null)}mo(){this.Am||(ya.a.J(557352419,this.Qw.ZR,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),this.cAa(6))}}Object(m.a)($r,"WebSocketFetcher",null,[415,106]);var eq;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";
a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(eq||(eq={}));Object(m.b)("ConnectionReason",eq);var Cq;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Cq||(Cq=
{}));Object(m.b)("SendMessageStatusCode",Cq);class Qs extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.KGl=b;this.kgk=c}}Object(m.a)(Qs,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Zm=d(665);class Wq{constructor(a,b,c,f,l){this.km=window.performance.now();this.ENe=new uc.a;this.NFe=this.Mjc=!0;this.VGb=null;this.ZKb=1;this.Xa=b;this.Bgd=a.Com;this.BMe=a.Dom;this.pNk=a.Aom;this.cRk=a.Bom;this.RGk=a.yom;this.EJb=a.jGd;this.nld=a.Olm;this.nQe=a.zom;this.Phb=oe.a.GD(this.nQe);
this.Lya=new $r(this,b,c,f,new yv.a(a.Pba));if(l)this.VGb=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Lya.dispose()}ping(){this.Lya.ping()}Py(a){const b=new Map,c=this.RRj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:null),eg.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.EJb?(a=this.Lya.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",
Cq[a]),eg.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new Fl.a,{extendedProperties:b})))):eg.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new Fl.a,{extendedProperties:b}))}qAi(a){this.ENe.addHandler("ResponseReceivedEventId",a)}lCl(a){this.ENe.removeHandler("ResponseReceivedEventId",a)}X3k(){if(this.EJb){var a=$c.a.Kb?$c.a.Kb.actionId:kh.a.create().toString(),b=A.AFrameworkApplication.userSessionId,c=this.Xa.$k;
this.NFe=!0;b=Zm.p(a,b,this.Xa.podSessionId,c);b=this.Lya.sendMessage(JSON.stringify(b),"validateSession");ya.a.J(508368854,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Cq[b],this.Phb,c)}}cVe(a){if(this.EJb)try{const b=this.qkj(a);if(b.pong)this.pMb(b.pong.pingTimestamp);else if(b.validateSessionResponse)this.lal(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.T3k(b.compressionHandshakeResponse);
else{const c=Object.getType(a.data)!==String;this.ENe.raiseEvent("ResponseReceivedEventId",new Qs(b,this.fKj(a,c),c))}}catch(b){ya.a.J(508368853,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.pMb(a.data)}qkj(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.ZKb)return a=new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);ya.a.J(508368852,839,
10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}fKj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}lal(a){if(a.isValid){a=$c.a.Kb?$c.a.Kb.actionId:kh.a.create().toString();var b=A.AFrameworkApplication.userSessionId,c=this.Xa.podSessionId,f=this.Xa.$k;ya.a.J(508368850,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Mn[this.ZKb]);
1===this.ZKb?this.oyk(a,b,c,f):2===this.ZKb&&this.wKh(a,b,c,f);this.ping()}else ya.a.J(508368851,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.Phb,this.Xa.$k),this.Lya.tVi()}oyk(a,b,c,f){this.VGb.loadScript("WebSocketCompressionHelper").then(()=>{this.ZKb=2;this.wKh(a,b,c,f)}).catch(()=>{ya.a.J(508368849,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.ZKb=3})}wKh(a,b,c,f){a=
Zm.a(a,b,c,!0,f);a=this.Lya.sendMessage(JSON.stringify(a),"compressionHandshake");ya.a.J(508368848,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}T3k(a){a=a.clientReadyForCompression;ya.a.J(508368847,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",a);a&&this.Lya.dVl()}RRj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":
a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}pMb(a){this.Lya.pMb(a);Aa.a.Ta(a)?ya.a.J(508368846,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?ya.a.J(508368845,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",this.EJb):(a={["PingTime"]:window.performance.now()-this.km-a,MeasurementType:"Performance.Now"},a.First=this.Mjc?1:0,
a.WebSocketFrontDoorProtobufEnabled=this.EJb,a.PostConnectionPing=this.NFe,a.ConnectionReason=eq[this.Lya.iZa],this.Lya.PTi(),this.NFe=this.Mjc=!1,ya.a.J(508368844,839,50,Qa.a.toJSON(a))))}G5i(){var a=(window.performance.now()-this.km).toString();if(!this.EJb)return a;a=Zm.q(Zm.l(a),null,null,null,this.Xa.$k);return JSON.stringify(a)}get Eom(){return this.nld&&!Aa.a.Ta(this.nQe)?this.nQe:A.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get ZR(){return 839}get agl(){return this.BMe}get Egh(){return this.Bgd}get dHh(){return this.cRk}get Bmd(){return this.pNk}get mVi(){return this.RGk}}
Object(m.a)(Wq,"PodsWebSocketFrontDoor",null,[144,106,195]);class Dq{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}fc(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;a.register(144,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().na(()=>{try{return new Wq(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ha("PowerPointWebEditor.ISessionLifetimeManager"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").nG)}catch(b){return ya.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){C.a.instance.Ac(new Dq)}}Object(m.a)(Dq,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var as=d(1207),Xq=d(1216);class bs{constructor(a){a=void 0===a?null:a;this.Ho=null;this.reset();
this.F0b=a}h3b(a,b){if(!this.F0b||this.F0b.M9e())b in this.Ho||(this.Ho[b]=[]),this.Ho[b].push(a)}getData(){return Qa.a.count(this.Ho)?this.Ho:null}reset(){this.Ho={}}}Object(m.a)(bs,"NamedValuesAggregator",null,[613]);class Rs{constructor(){this.Ho=new La.a}get Htl(){return this.Ho.count}h3b(a){this.Ho.add(a)}getData(){return this.Htl?xb.toArray(this.Ho):null}reset(){this.Ho=new La.a}}Object(m.a)(Rs,"BatchDataAggregator",null,[613]);var Eq;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=
1]="FeedbackLoop";a[a.Config=2]="Config"})(Eq||(Eq={}));Object(m.b)("ApiType",Eq);class cs{constructor(a,b){this.Bi=a;this.pTd=b}Py(a,b,c){if(c){a=Eq[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=A.AFrameworkApplication.fa.getBooleanAppSetting("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Bi.Tj(this.pTd()+"&apitype="+a,2,b,f,!1,3,Object(R.a)(this,this.$Ma,"requestSucceeded"),Object(R.a)(this,this.YMa,"requestFailed"),c,void 0,void 0,
void 0,void 0,"28")}}$Ma(a){if(!A.AFrameworkApplication.Dh&&a&&a.data){var b=a.data.state;b&&b.u3c(b,a.data.Ud)}}YMa(a){!A.AFrameworkApplication.Dh&&a&&a.data&&(a=a.data.state)&&a.g3c(a)}}Object(m.a)(cs,"EditorServiceRequestManager",null,[508]);class Yq extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(m.a)(Yq,"ErrorRangesChangedEventArgs",Sys.EventArgs,[]);var im=d(280);class Lo{constructor(a,b,c){this.begin=a;this.end=b;this.Rh=c}}Object(m.a)(Lo,"ErrorRange",null,[343]);class ds{constructor(a,
b){this.Xo=a;this.Odi=b}get Qe(){return this.Xo}get Rh(){return this.Odi}le(a){return new ds(a||this.Xo,this.Rh)}}Object(m.a)(ds,"SpellingErrorObject",null,[429]);class Fq{constructor(a,b,c){this.Ma=new uc.a;this.Cs=a;this.Pni=b;this.ohi=c}PJf(a,b){b=this.zTh(a,b);if(!rd.a.Ta(b)){for(var c=this.KG(a),f=[],l=0,u=0;l<b.length&&u<c.length;){const I=c[u],T=b[l];T.end<=I.begin?++l:(I.end>T.begin&&Array.add(f,I),++u)}c=a.p4a();try{const I=a.Jla();try{this.MCh(a,f),this.QJf(a,b)}finally{I&&I.dispose()}}finally{c&&
c.dispose()}this.Mnd(a)}}TMa(a,b,c){c=void 0===c?!1:c;if(!rd.a.Ta(b)){c=c?null:a.p4a();try{const f=a.Jla();try{this.MCh(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.Mnd(a)}}RDl(a,b){const c=a.p4a();try{const f=a.Jla();try{this.L4d(a),b=this.zTh(a,b),rd.a.Ta(b)||this.QJf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}L4d(a){const b=a.p4a();try{const c=a.Jla();try{const f=a.Sa;for(a=0;a<f.length;a++){const l=f.ga(a);l.Bq&&(l.Bq=null);l.VM=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}KG(a,
b){b=void 0===b?null:b;const c=[];let f=0,l=null;var u=!1;a=a.Sa;for(let I=0;I<a.length;I++){const T=a.ga(I);if(T.VM){const ja=T.cp;l?(u=new Lo(f,ja,l),b&&!b(u)||Array.add(c,u)):u?da.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):da.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",f,ja);u=!1}T.Bq&&(u=!0,f=T.cp,l=T.Bq.Rh)}return c}NVa(a){if(!a||!Bc.SelectionEditor.Tk(a)&&!Bc.SelectionEditor.nh(a))return null;
const b=a.node,c=a.Ra,f=a.Pb;a=Bc.SelectionEditor.nh(a);const l=this.Cs.text(b);for(const u of this.KG(b))if(a){if(u.begin<=c&&u.end>=f)return u}else if(u.begin<=c&&u.end>=c&&Aa.a.i_i(l,u.end,f))return u;return null}axc(a){if(!this.ohi||!a||!(a.zea||2===a.length&&Bc.SelectionEditor.Om(a.vf)))return!1;a=this.NVa(a.Ua);if(!a)return!1;if(a=Object(gb.a)(419,a.Rh))if(a.C5h=!0,a.Tve())return!1;return!a||5!==a.proofingType}zTh(a,b){if(rd.a.Ta(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=
b[c];f&&f.Rh||(da.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;im.d(b);c=[];this.Pni&&Array.addRange(c,this.Cs.QVa(a));c=im.a(c);for(f=a=0;f<b.length&&a<c.length;){const l=b[f],u=c[a];l.begin<u.end&&u.begin<l.end?Array.removeAt(b,f):l.end<u.end?f++:a++}return b}QJf(a,b){let c=!1;for(const f of b){b=f.Rh;c=1===b.proofingType||c;let l=a.Dzb(f.begin);l.Bq=new ds(l,b);l.isFromErrorRangeSplit=
!0;l=a.Dzb(f.end);l.VM=!0;l.isFromErrorRangeSplit=!0}c&&(a.KDb=!1)}MCh(a,b){if(!rd.a.Ta(b)){a=a.Sa;for(const c of b){b=a.TU(c.begin);const f=a.TU(c.end);b&&b.Bq&&f&&f.VM?(b.Bq=null,f.VM=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),da.ULS.sendTraceTag(37532355,324,10,b))}}}Syi(a){this.Ma.addHandler("OnErrorRangesChanged",a)}Mnd(a){if(this.Ma.Icc){const b=this.KG(a);this.Ma.raiseEvent("OnErrorRangesChanged",new Yq(a.id.toString(),b))}}}
Object(m.a)(Fq,"ErrorRangeEditor",null,[507]);var bl=d(215);class Bp{constructor(){this.$uf=new bl.a}contains(a,b){return a?this.$uf.contains(Aa.a.xYh(a,b)):!1}add(a,b){a&&this.$uf.add(Aa.a.xYh(a,b))}}Object(m.a)(Bp,"IgnoreAllKeywords",null,[163]);var jm=d(217);class Gq extends jm.a{constructor(a,b,c){super(b,c);this.IH=a;this.lMa=this.Sba=-1;this.l4d=0;this.textUnit=2}get lcid(){return this.IH}}Object(m.a)(Gq,"ModifiedRange",jm.a,[]);class Zq{constructor(a,b,c,f){this.Iri=a;this.UL=b;this.sO=c;this.ZCf=
f}get Osd(){return this.ZCf?this.ZCf.instance:null}wRf(a,b){const c=[];if(rd.a.Ta(a)||rd.a.Ta(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new Gq(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];const u=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const I=a.pop(),T=I.end,ja=Math.min(T,l);T>l&&a.push(new jm.a(l,T));Array.add(c,new Gq(u,I.begin,ja))}f++}while(0<a.length&&f<b.length);da.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}Ljj(a,
b,c,f){const l=Zq.Ecg(a,c,b);c=0;const u=a.begin,I=a.end,T=this.Osd;let ja=!1;T?(c=T.findEndBoundary(b,I-1,l.ypc),f||-1!==c||this.Oug(b,a)?c=-1===c?l.ypc:c:ja=!0):ja=!0;if(ja)return this.Vig(a,b,this.sO.ckh,l.kLa,l.ypc);if(!l.kLa)for(;" "===b.charAt(l.kLa)&&l.kLa<b.length;)l.kLa++;a=Math.max(T.findBeginBoundary(b,u,l.kLa),l.kLa);return jm.a.createTextRange(a,c)}Kjj(a,b,c){return this.W$f(a,b,c,this.sO.ckh)}Jjj(a,b){if(!a||rd.a.Ta(b))return a;let c=a.begin,f=a.end,l=!1;for(const u of b){if(a.end<=
u.begin)break;a.begin>u.begin&&a.begin<u.end&&(c=u.begin,l=!0);a.end>u.begin&&a.end<u.end&&(f=u.end,l=!0)}return l?jm.a.createTextRange(c,f):a}zYl(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!Aa.a.sEb(b.substring(c,a))&&!Aa.a.h_i(b,c,a)}Xvj(a,b,c){if(!a||!c||rd.a.Ta(b))return 0;a=im.c([a],b);b=0;for(const f of a)b+=this.Iri.Lqg(c,f.begin,f.end);return b}Wti(a,b,c,f){if(a&&b){var l=a.begin,u=a.end,I=this.sO.y1k;if(0>=I)a.Sba=l,a.lMa=u;else if(I=this.W$f(a,b,f,I)){b=a.lcid;f=I.begin;I=I.end;
if(0>f||this.WPh(f,l,b,c))f=l;this.WPh(u,I,b,c)&&(I=u);a.Sba=f;a.lMa=I}else a.Sba=l,a.lMa=u}}Oug(a,b){return this.Osd?-1!==this.Osd.findEndBoundary(a,b.begin,b.end):!1}WPh(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.wRf([new jm.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}W$f(a,b,c,f){if(!a||!b||0>f)return null;const {kLa:l,ypc:u}=Zq.Ecg(a,c,b);return this.Vig(a,b,f,l,u)}Vig(a,b,c,f,l){return jm.a.createTextRange(this.UL.Onj(b,c,a.begin,f),this.UL.unj(b,c,a.end,l))}static Ecg(a,b,c){let f;
f=0;c=c.length;if(rd.a.Ta(b))return{kLa:f,ypc:c};const l=a.begin;a=a.end;let u=!1,I=!1;for(const T of b)if(!u&&T.end<=l?f=T.end:u=!0,!I&&T.begin>=a&&(c=T.begin,I=!0),u&&I)break;return{kLa:f,ypc:c}}}Object(m.a)(Zq,"ModifiedExpandRangeHelper",null,[503]);var Cp=d(353);class Nm{constructor(a,b){this.JNd=null;this.Yh=a;this.UL=b;this.MH=$a.ParagraphReader.text(this.Yh);this.UCf=[]}rRj(a,b){return this.G2c(this.UL.P9b(this.MH,a,b))}G2c(a){return a?this.Sle(a.begin,a.end):null}Sle(a,b){this.JNd=this.JNd||
this.UL.F_c(this.Yh);return this.UL.G2c(a,b,this.MH,this.JNd)}QGa(a,b){(a=this.Sle(a,b))&&Array.add(this.UCf,a)}Oac(){return Array.clone(this.UCf)}}Object(m.a)(Nm,"ValidatedRangeContainer",null,[]);class Dp{constructor(a,b,c,f,l,u){this.xn=a;this.UL=b;this.Vc=c;this.sO=f;this.hoi=l;this.Pli=u}RAb(a){return new Nm(a,this.UL)}ACi(a){const b=a.o$d.currentNode;var c=a.FTh.currentNode;const f=a.Mrh;a=this.sva(b);const l=this.RAb(b);c=this.sva(c);for(var u of c)l.QGa(f+u.begin,f+u.end);Array.addRange(a,
l.Oac());if(u=l.rRj(f,f))Array.add(a,u),this.U2e(b,u,0);b.D2=a}BCi(a,b,c){var f=a.D2;if(rd.a.Ta(f)||f[f.length-1].end<=c)this.ORc(b);else{var l=[],u=this.RAb(a),I=this.RAb(b);for(const T of f)if(f=T.end,f>c){const ja=T.begin;ja<c?(u.QGa(ja,c),I.QGa(0,f-c)):I.QGa(ja-c,f-c)}else Array.add(l,T);c=u.Oac();Array.addRange(c,l);a.D2=c;b.D2=I.Oac();a.txc();b.txc()}}fSl(a){$a.ParagraphReader.ke(a)&&!this.UL.zXa(a)&&(this.xn.L4d(a),this.$3e(a,[new jm.a(0,$a.ParagraphReader.textLength(a))]))}bNh(a,b){b&&a&&
$a.ParagraphReader.ke(a)&&!this.UL.zXa(a)&&!a.zD&&this.fhh(a,this.RAb(a).G2c(b),G.a.Nz)}jOh(a,b,c){a&&this.bNh(a,this.UL.P9b($a.ParagraphReader.text(a),b,c))}$3e(a,b){if($a.ParagraphReader.ke(a))if(rd.a.Ta(b))this.ORc(a);else{const c=this.RAb(a);for(const f of b)c.QGa(f.begin,f.end);a.D2=c.Oac()}}ORc(a){$a.ParagraphReader.ke(a)&&(a.D2=null)}azd(a,b,c){c=void 0===c?null:c;if($a.ParagraphReader.ke(a)&&!a.zD&&!rd.a.Ta(b)){im.d(b);var f=null;if(this.sO.xDb||this.sO.vXa)f=T=>1===T.Rh.proofingType;f=this.xn.KG(a,
f);for(var l=[],u=0,I=0;I<f.length&&u<b.length;){const T=b[u],ja=f[I];T.end<=ja.begin?u++:(ja.end<=T.begin||ja.begin>=T.begin&&ja.end<=T.end&&(0!==ja.Rh.errorType||ja.begin!==T.begin)&&Array.add(l,ja),I++)}this.xn.TMa(a,l);f=this.sva(a);b=im.b(f,b);c&&(c=im.c(f,[c]),0<c.length&&(b=im.e(b,c)));this.$3e(a,b)}}sva(a){return $a.ParagraphReader.ke(a)?a.D2||[]:[]}NEi(a,b,c,f,l){l=void 0===l?0:l;const u=a.node;if($a.ParagraphReader.ke(u)&&!this.UL.zXa(u)&&!u.zD){var I=$a.ParagraphReader.text(u),T=a.Ra,ja=
a.Pb+f;this.hoi?(T=a.Ra+b,ja=a.Pb-c+f):this.Pli&&(b=this.Vc.Ik,0<=f&&b&&Bc.SelectionEditor.nh(b)&&(b=b.Ra,0<=b&&b<=I.length&&(b=this.UL.P9b(I,b,b))&&b.begin>=T&&b.end<=ja&&(T=b.begin,ja=b.end)));b=this.RAb(u);c=null;0<=f&&(c=b.Sle(T,ja));c||(c=this.UL.P9b(I,T,ja));0<=f?this.fhh(u,c,l):this.gjm(u,a.Ra,a.Pb,c,b,f,l)}}fhh(a,b,c){if(b){var f=this.sva(a);Array.add(f,b);a.D2=f;a.txc();this.U2e(a,b,c)}}gjm(a,b,c,f,l,u,I){const T=this.sva(a),ja=[];if(T.length)if(T[T.length-1].end<b)if(f)Array.addRange(ja,
T);else return;else{for(const ua of T)ua.end<b?Array.add(ja,ua):ua.begin>=c?l.QGa(ua.begin+u,ua.end+u):ua.begin<b?ua.end>c?l.QGa(ua.begin,ua.end+u):l.QGa(ua.begin,b):ua.end>c&&l.QGa(b,ua.end+u);Array.addRange(ja,l.Oac())}f&&(Array.add(ja,f),this.U2e(a,f,I));a.D2=ja;a.txc();this.xn.Mnd(a)}U2e(a,b,c){const f=this.xn.KG(a,u=>u.begin<=b.end&&u.end>=b.begin);if((c===G.a.P1d||c===G.a.Nz||c===G.a.cut||c===G.a.paste)&&1===f.length&&f[0].Rh){c=f[0].Rh;var l=Ea.a.Oe(c.lcid);l=l?l.name:Dp.A7h;const u=Object(gc.a)(Cp.a,
c)?c.typeId:Dp.x8h;da.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",u,l);c.C5h&&da.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",u,l)}this.xn.TMa(a,f)}}Dp.x8h="";Dp.A7h="UNKNOWN";Object(m.a)(Dp,"ModifiedRangeEditor",null,[502]);class es{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.xn=a;this.JA=b;this.c2b=c;this.OL=f;this.o7a=l;this.eRa=u;this.UL=I;this.x8a=T;this.Vpf=ja;this.huf=(void 0===Ra?null:Ra)||es.R9i;this.mFf=!1;ua.execute(eb=>
{this.mFf=!!eb})}S1h(a){if(a&&$a.ParagraphReader.ke(a)&&a.H3c){let b=null;this.Vpf.jwa&&(b=c=>!!c.Rh&&1===c.Rh.proofingType);a.KDb=rd.a.Ta(this.JA.sva(a))&&rd.a.Ta(this.xn.KG(a,b))}}NFj(a,b){var c=this.PFj(a,b);if(rd.a.Ta(c))return[];const f=$a.ParagraphReader.text(a).replace("\u00a0"," "),l=this.xn.KG(a),u=this.uNl(a,l),I=u&&this.n1i(a),T=this.UL.Ybg(a),ja=im.e(this.UL.Xbg(a),T);c=this.ZAj(c,b,f,ja,l,u,I);if(rd.a.Ta(c))return[];b=this.o7a.XDj(a);c=this.eRa.wRf(c,b);if(rd.a.Ta(c))return[];this.cnl(a,
f,c);a=this.JA.sva(a);for(const ua of c)this.eRa.Wti(ua,f,b,T),ua.l4d=this.eRa.Xvj(ua,a,f),u&&(I||this.eRa.Oug(f,ua))&&(ua.textUnit=4);return c}mnj(a){if(this.huf()||!a||""===a.ra(rb.a.np,""))return null;var b=this.x8a.S9b;if(!b||!Bc.SelectionEditor.nh(b)||b.node!==a||!this.p1j(a))return null;b=b.Ra;return this.UL.P9b($a.ParagraphReader.text(a),b,b)}MEi(a,b,c,f,l,u,I){I=void 0===I?0:I;this.OL.Pc(a.node).wf()&&(this.JA.NEi(a,b,c,u,I),this.c2b.ilm(a,f,l))}p1j(a){const b=im.a(this.JA.sva(a));if(!b.length)return!1;
a=im.a(this.xn.KG(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],u=a[c];l.begin>=u.begin&&l.end<=u.end?f++:c++}return f!==b.length}PFj(a,b){if(!a||a.Cue)return null;a=this.JA.sva(a);return a.length&&b?im.b(a,[b]):a}uNl(a,b){return this.mFf&&this.Vpf.jwa?a.NYb||!b.length||rd.a.any(b,c=>!!c.Rh&&2===c.Rh.sJg):!1}n1i(a){if(!a.NYb||this.huf())return!0;var b;(b=this.x8a.S9b)&&b.node===a?(a=this.JA.sva(a),b=b.Ra<a[a.length-1].begin):b=!0;return b}ZAj(a,b,c,f,l,u,I){let T=[];for(const ja of a)a=
u?this.eRa.Ljj(ja,c,f,I):this.eRa.Kjj(ja,c,f),(a=this.eRa.Jjj(a,l))&&Array.add(T,a);T=im.a(T);b=im.f(f,b);return im.b(T,b)}cnl(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const u=c[l];this.eRa.zYl(u,b)||(Array.removeAt(c,l),Array.add(f,u))}this.JA.azd(a,f)}static R9i(){return qf.a.U1j(ad.App.Ob.uH.XHg)}}Object(m.a)(es,"ParagraphProofingFacade",null,[501]);var v=d(1104);class S{constructor(){this.g3c=this.u3c=this.activity=null}endActivity(a){this.activity&&(this.activity.properties.$("EndReason",
a),this.activity.end())}}Object(m.a)(S,"EditorServiceAPIRequest",null,[]);class ma extends S{constructor(){super();this.gBa=this.request=null}}Object(m.a)(ma,"ProofingConfigV2Request",S,[]);class Ja{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(m.a)(Ja,"ProofingConfigV2RequestObject",null,[]);var Va;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]="error";a[a.disabled=3]="disabled"})(Va||(Va=
{}));Object(m.b)("ResponseStatus",Va);var wb=d(3);class Sb{constructor(a,b,c,f,l){this.iXb=a;this.yd=b;this.c0b=c;this.Nli=f;this.$Hf=A.AFrameworkApplication.lcid;this.jja=ad.App.mode;this.KEc={};this.u_b=new Cc.a;this.Hli=l}init(){this.Vrd(this.$Hf)}Vrd(a){if(!(a.toString()in this.KEc||A.AFrameworkApplication.Dh))try{this.Nli.qSi(a).continueWith(b=>{!b.result||this.u_b.Ib(a.toString())&&this.u_b.ga(a.toString())||this.uMl(a)},3)}catch(b){da.ULS.sendTraceTag(36782929,375,10,"PopulateConfigByLanguageId failed with exception: {0}",
b)}}uMl(a){var b=new v.a;const c=Ea.a.Oe(a).name,f=Ea.a.Oe(this.$Hf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new ma,{request:new Ja(a,this.xuj(),c,f,this.c0b.descriptors),activity:this.yd.Cq(G.a.ZEl),gBa:b,u3c:Object(R.a)(this,this.Rtc,"processSuccessResponse"),g3c:Object(R.a)(this,this.Ptc,"processFailResponse")}),this.u_b.$(a.toString(),!0),this.iXb.Py(2,Fe.c(b.request),b))}Rtc(a,b){if(!a||!a.request)return!1;this.u_b.$(a.request.Lcid.toString(),!1);if(a.request.Lcid.toString()in this.KEc)return a.endActivity("RequestSucceeded"),
!0;let c=null;if(b&&b.length)try{c=Fe.a(b)}catch(f){da.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?Va[c.ResponseStatus]:"EmptyResponse",da.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.Hli.filter(b);da.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",
!b,b?b.length:0,a.request.LanguageId);this.KEc[a.request.Lcid.toString()]=b;return!0}Ptc(a){a&&(a.request&&this.u_b.$(a.request.Lcid.toString(),!1),a.gBa.Jg(!1),da.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return wb.Task.ju(this.KEc[a.toString()])}xuj(){const a=Cb.a[this.jja];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(m.a)(Sb,"ProofingConfigV2Manager",null,[167]);class vc{constructor(){this.Value=
this.Name=null}static create(a,b){return Object.assign(new vc,{Name:a,Value:b})}static Rpe(){Object.assign(new vc,{Name:"IsCompliant",Value:void 0});Object.assign(new vc,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new vc,{Name:"IsGoLocal",Value:void 0})}}Object(m.a)(vc,"Descriptor",null,[]);class gd{constructor(a,b){this.mCa=[];this.La=a;this.Esf=b}get descriptors(){if(!this.mCa.length)try{this.Rpe()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);da.ULS.sendTraceTag(33952285,
375,10,b)}return this.mCa}Rpe(){Array.clear(this.mCa);var a=this.La.getBooleanAppSetting("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.mCa,Object.assign(new vc,{Name:"IsGoLocal",Value:this.La.getBooleanAppSetting("IsGoLocalEnvironment").toString()}));Array.add(this.mCa,Object.assign(new vc,{Name:"IsCompliant",Value:a}));if(this.Esf.Mye||this.Esf.vXa)a=this.La.getBooleanAppSetting("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.mCa,
Object.assign(new vc,{Name:"LicenseType",Value:a}));this.QDi();this.XDi()}XDi(){var a=Fe.b(this.La.appSettings.SessionStartInfoJson.toString()),b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.mCa,Object.assign(new vc,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.mCa,Object.assign(new vc,{Name:"Origin",Value:a}))}QDi(){const a=this.Smj(this.La.Ea("FlightId"));let b;0<a.length&&(b=rd.a.join(a,";"),Array.add(this.mCa,Object.assign(new vc,{Name:"FlightIds",
Value:b})),da.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}Smj(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(m.a)(gd,"ProofingDescriptors",null,[162]);class od{constructor(a,b){this.vXa=this.xDb=this.ZUd=!1;this.PRd=this.ORd=0;this.fKc=a.getBooleanAppSetting("ProofingWithEditorServiceIsEnabled");this.gfi=a.getBooleanAppSetting("GrammarCheckIsEnabled");
this.aYa=a.getBooleanAppSetting("ProofingSettingIsEnabled");this.axe=a.getBooleanAppSetting("ProofingSecondaryContextualMenuIsEnabled");this.jHc=a.getBooleanAppSetting("EditorServiceSuggestionDescriptionsIsEnabled");a.getBooleanAppSetting("NewProofingExperienceEnabled");this.Mri=a.getBooleanAppSetting("WritingStyleIsEnabled");this.bdi=a.getBooleanAppSetting("DoNotCheckThisIssueEnabled");this.Rgi=a.getBooleanAppSetting("IgnoreProofingCommandIsEnabled");this.jwa&&(this.ZUd=!1,b.execute(()=>{this.ZUd=
!0}));2===this.aia?(this.PRd=2,this.ORd=3):(this.PRd=a.tc("NumberOfWordsToProofAroundModifiedRanges",1),this.ORd=a.tc("NumberOfWordsAsContextAroundProofedRanges",0))}get zCg(){return this.Rgi}get jwa(){return 2===this.aia&&this.gfi}get Mye(){return this.jwa&&this.Mri}get Zue(){return this.bdi&&this.axe&&this.aYa}get nhk(){return this.jHc}get aia(){return this.fKc?2:0}get y1k(){return this.ORd}get ckh(){return this.PRd}get isLoaded(){return!this.fKc||!this.jwa||this.ZUd}}Object(m.a)(od,"ProofingFeatureConfiguration",
null,[500]);class Vd extends S{constructor(){super();this.request=null}}Object(m.a)(Vd,"ProofingFeedbackLoopRequest",S,[]);class Ke{constructor(a,b,c){this.iXb=a;this.yd=b;this.c0b=c}xMl(a){a.Descriptors=this.c0b.descriptors;a=Object.assign(new Vd,{request:a,activity:this.yd.Cq(G.a.WMl),u3c:Object(R.a)(this,this.Rtc,"processSuccessResponse"),g3c:Object(R.a)(this,this.Ptc,"processFailResponse")});this.iXb.Py(1,Fe.c(a.request),a)}Rtc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Ptc(a){a&&
(da.ULS.sendTraceTag(38847138,375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(m.a)(Ke,"ProofingFeedbackLoopManager",null,[497]);class kg extends S{constructor(){super();this.gBa=this.request=null}}Object(m.a)(kg,"ProofingLanguageInfoRequest",S,[]);class If{constructor(a){this.AppId=a}}Object(m.a)(If,"ProofingLanguageInfoRequestObject",null,[]);class yh{constructor(a,b){this.iXb=a;this.yd=b;this.jja=ad.App.mode;this.usa=new bd.ScriptSharpLegacyMap;this.pja=null;this.l8a=
0}qSi(a){if(this.usa.Ib(a))return wb.Task.ju(!0);this.l6e();return this.pja.CWRCo(()=>!!this.pja.result&&this.pja.result.Ib(a),3)}rSi(a,b){if(this.usa.Ib(a))return wb.Task.ju(this.upg(a,b));this.l6e();return this.pja.CWRCo(()=>this.upg(a,b),3)}jyj(a){if(0<this.usa.count)return wb.Task.ju(this.Rhg(a));this.l6e();return this.pja.CWRCo(()=>this.Rhg(a),3)}SEl(){const a=new v.a;A.AFrameworkApplication.Dh&&a.Jg(null);const b=Object.assign(new kg,{request:new If(Cb.a[this.jja]+"_Online"),activity:this.yd.Cq(G.a.$El),
gBa:a,u3c:Object(R.a)(this,this.Rtc,"processSuccessResponse"),g3c:Object(R.a)(this,this.Ptc,"processFailResponse")});this.iXb.Py(0,Fe.c(b.request),b);this.l8a+=1;return a.task}Rtc(a,b){let c=null;if(!a)return!1;try{c=Fe.a(b)}catch(l){da.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=Ea.a.Oe(f.LanguageId))&&0!==f.SupportedTextUnit&&this.usa.$(b.LCID,
f);a.gBa.Jg(this.usa);a.endActivity("RequestSucceeded");return!0}a.gBa.Jg(null);f=c?Va[c.ResponseStatus]:"EmptyResponse";da.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}Ptc(a){a&&(a.gBa.Jg(null),da.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}upg(a,b){if(!this.usa||!this.usa.Ib(a))return 0;a=this.usa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.eBj(b,a)}eBj(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}Rhg(a){const b=new La.a;if(!this.usa)return b;
for(const c of this.usa)c.value.SupportedCritiqueTag&a&&b.add(c.key);return b}l6e(){if(!this.pja||5===this.pja.status||4===this.pja.status||6===this.pja.status&&!this.pja.result)this.pja=this.SEl(),da.ULS.sendTraceTag(38319180,375,1===this.l8a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.l8a,this.l8a)}}Object(m.a)(yh,"ProofingLanguageInfoManager",null,[496]);class df{constructor(a,b){this.Lhi=a;this.Ctb=b}track(a,b){b=void 0===b?null:b;this.Lhi&&this.Ctb.track(a(),
b)}}Object(m.a)(df,"ProofingMetricsAggregator",null,[166]);class bg{hLf(a,b){a&&$a.ParagraphReader.ke(a)&&!rd.a.Ta(b)&&(im.d(b),a.hUb=im.e(a.hUb,b))}ilm(a,b,c){if(b){var f=a.Pb;a=a.node.hUb;for(let u=0;u<a.length;u++){var l=a[u];const I=l.begin;l=l.end;0>b?l>c&&(I>=f?a[u]=new jm.a(I+b,l+b):I>=c&&l<=f?(Array.removeAt(a,u),u--):a[u]=new jm.a(I<c?I:c,l<=f?c:l+b)):a[u]=new jm.a(I>f?I+b:I,l>f?l+b:l)}}}}Object(m.a)(bg,"UnsupportedLanguageRangeEditor",null,[492]);var ih=d(1326),He=d(473),$m=d(271),Ck=d(320),
cl=d(1133),Nk=d(678);class xn{constructor(){this.Lz=this.F2a=null}}Object(m.a)(xn,"ClientRequestManagerStateObject",null,[]);class um{constructor(a,b){this.request=a;this.response=b}}Object(m.a)(um,"SpellCheckRequestResponseTuple",null,[]);class km{constructor(){this.E4h=0;this.Z2f=this.Xpa=this.paragraphNode=this.range=null;this.userAction=0;this.cF=null;this.aia=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}LCg(){const a=$a.ParagraphReader.text(this.paragraphNode);if(!a||!this.Xpa)return a===
this.Xpa;const b=this.range.begin,c=this.range.end;return Aa.a.$0d(a.substring(b,c),this.Xpa.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.LCg()}}Object(m.a)(km,"SpellCheckRequest",null,[]);var Fj=d(677),uk=d(923),Nn=d(924);class Hh{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd){this.CXd=new Ba.a;this.Q_b=[];this.xFc=0;this.CKc={};this.Xca=null;this.jpf=Number.POSITIVE_INFINITY;this.tEc=0;this.j9=Hh.Udb;this.e8a=null;this.TLc=0;this.Cub=[];this.REc=null;
this.Emi=!1;this.s_b=[];this.KTd=[];this.Ili=0;this.Mli=c.getBooleanAppSetting(Hh.Lml);this.Rli=c.getBooleanAppSetting(Hh.Sml);this.Jli=c.appSettings[Hh.Jml];this.Gli=c.getBooleanAppSetting(Hh.Iml);this.Qli=c.getBooleanAppSetting(Hh.Qml);this.nJ=f;this.jja=ad.App.mode;this.xn=a;this.JA=b;this.c2b=ua;this.Bi=l;this.fji=c.tc(Hh.Oml,Hh.Nml);this.Oli=Bb;this.lm=u;this.Bf=I;this.OL=T;this.UL=ja;this.pTd=Ra;this.dKc=eb;this.Di=new ih.a;this.Lli=c.getBooleanAppSetting(Hh.Kml);this.cKc=Xb;this.Mml=tc;this.RXc=
Ub;this.fKc=c.getBooleanAppSetting(Hh.Rml);this.c0b=lc;this.Fli=Ec;this.xrb=hd;this.s8=yd;this.je=Pd}get brh(){return this.s_b}set brh(a){this.s_b=a}get tZc(){return A.AFrameworkApplication.Dh}get f7b(){return this.xrb.instance}suspend(){this.TLc++}resume(){if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&Object(Nb.a)("ALV2SpellingEnabled"))da.ULS.sendTraceTag(508913506,324,15,"Paragraph legacy proofing hit");else if(0>=--this.TLc&&(this.TLc=
0,0<this.Cub.length&&!this.REc)){const a=this.s8.isCompleted(4)?0:1;this.REc=new ne.a(a,1,1,Object(R.a)(this,this.m4l,"spellCheckSuspendedNodes"),74);this.je.Jb(this.REc)}}m4l(){this.REc=null;const a=rd.a.clone(this.Cub);Array.clear(this.Cub);Date.now();let b=null;for(const c of a)b=this.g0h(c,!0,b);b&&b.dispose();this.Emi||Date.now()}lT(a,b){(a=this.g0h(a,void 0===b?!1:b,null))&&a.dispose()}g0h(a,b,c){switch(this.ava(a,b)){case 1:rd.a.contains(this.Cub,a)||Array.add(this.Cub,a);break;case 2:c=this.doSpellCheck(a,
c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}ava(a,b){return!a||this.tZc||!this.nJ.ie.isEditingAllowed&&!this.nJ.ie.eA?0:!b&&0<this.TLc||!this.RXc.isLoaded?1:!$a.ParagraphReader.ke(a)||!a.isConnected||a.anchor.oK||a.Cue||a.nY||a.zD?3:this.Xca&&rd.a.any(this.Xca,c=>c.paragraphNode===a)?0:rd.a.any(this.Q_b,c=>c.paragraphNode===a)||!this.Bf.Bu(this.OL.Pc(a))?3:2}doSpellCheck(a,b){const c=(ua,Ra)=>{this.JA.azd(ua,Ra)};var f=this.UL.F_c(a);let l=0<f.length;b=this.TZe(b,
a,f,c);(f=this.cKc.mnj(a))&&this.t5i(a);const u=this.cKc.NFj(a,f),I=$a.ParagraphReader.text(a),T=a.NYb,ja=[];for(let ua=u.length-1;0<=ua;ua--){const Ra=u[ua];Ra.begin!==Ra.end&&(this.CXd.contains(Ra.lcid)?Array.add(ja,Ra):(this.C1i(a,I,f,Ra,T),Array.removeAt(u,ua)))}l=0<ja.length||0<u.length||l;b=this.TZe(b,a,ja,Object(R.a)(this.c2b,this.c2b.hLf,"addUnsupportedRanges"));b=this.TZe(b,a,u,c);l&&this.cKc.S1h(a);return b}xe(a){const b=this.lm.xe(7,G.a.mFd);b.rd(a);return b}TZe(a,b,c,f){rd.a.Ta(c)||(a=
a||this.xe(b),f(b,c));return a}t5i(a){const b=new ne.a(4,1,500,Object(R.a)(this,this.gtl,"recheckParagraphTask"),48);b.gu=a;this.je.Jb(b)}x0k(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.Xpa.length+b.paragraphNode.id;this.CKc[b]=(this.CKc[b]||0)+1;this.xFc=Math.max(this.CKc[b],this.xFc);return this.xFc>Hh.KWk?(da.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.xFc=0,this.CKc={},this.JA.ORc(a),!1):!0}C1i(a,b,c,f,l){const u=
new km;u.E4h=A.AFrameworkApplication.lcid;u.Xpa=b;u.range=f;u.paragraphNode=a;u.Z2f=c;u.userAction=l?1:0;const I=this.RXc.aYa;I&&this.f7b&&(u.overriddenCritiqueTypeOptions=this.f7b.Mge());this.x0k(a,u)&&this.xOj(u.range.lcid,u.range.textUnit).continueWith(T=>{T=T.result;u.aia=2===this.RXc.aia?0!==T?2:0:this.Ili;u.range.textUnit=T;u.descriptors=this.c0b.descriptors;this.Qgj(u);I&&2===u.aia&&this.Fli.Vrd(u.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}xOj(a,b){return 2===this.RXc.aia?
this.Mml.rSi(a,b):wb.Task.ju(b)}Qgj(a){a.cF=new Date;Array.enqueue(this.Q_b,a)}gtl(a){this.lT(a.gu)}executeNextRequest(){if(!this.tZc&&!this.Xca){var a=[];do{if(!this.Q_b.length)break;const b=Array.dequeue(this.Q_b);b.isValid()&&Array.add(a,b)}while(a.length<this.fji);0>=a.length?(this.Xca=null,this.n4l()):(this.Xca=a,this.Xca.sort((b,c)=>+b.cF-+c.cF),a=this.Xca[0],this.dKc.track(+new Date-+a.cF,"ProofingRequestInQueue."+Fj.a[a.userAction]),this.executeRequest(this.Xca))}}n4l(){for(var a=0;a<this.s_b.length;a++)(0,this.s_b[a])();
Array.clear(this.s_b);for(a=0;a<this.KTd.length;a++)(0,this.KTd[a])();Array.clear(this.KTd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=Nk.a.LLj(this.Mli,a[c],this.jja,this.Rli,this.Qli,this.Gli,this.Jli,this.fKc);Array.add(b,f)}b=uk.a.IZi(b,ad.App.mode);this.Bi.Tj(this.pTd(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(R.a)(this,this.k4l,"spellCheckSucceeded"),Object(R.a)(this,this.j4l,"spellCheckFailed"),Object.assign(new xn,{F2a:a,Lz:this.Di.lj("WebServiceCall",
"Proofing")}),void 0,void 0,void 0,void 0,"29")}}k4l(a){if(!this.tZc){a=a.data;this.dKc.track(a.state.Lz.Qr,"ProofingRequestRoundtrip");var b=this.Di.lj("DOMUpdate","Proofing");this.l4l(a);this.dKc.track(b.Qr,"UpdateProofingResults")}}l4l(a){He.a.mark(7798);this.Xca=null;const b=a.state.F2a,c=a.Ud;let f,l;if((()=>{let ja=Nn.a.e_h(c);({group:f}=ja);return ja})().returnValue){l=f.Responses;var u,I,T=(()=>{let ja=this.oOj(b,l);({JHl:u,HNl:I}=ja);return ja})().returnValue;if(0<T.length){const ja=this.xe(T[0].request.paragraphNode);
try{for(const ua of T){const Ra=ua.request;this.nJ.Sgj(Ra.paragraphNode,()=>{this.mWk(ua.response,Ra)})}}finally{ja&&ja.dispose()}}u.length?(this.S1d(a),this.DZe(u),this.obe()):this.LFl();this.S1d(a);for(const ja of I)$m.PageStats.S2b(ja);this.obe();this.executeNextRequest()}else this.DZe(b);He.a.mark(7799)}oOj(a,b){const c=[],f=[],l=[];for(let u=0;u<a.length;u++){const I=a[u];if(!I.paragraphNode.isConnected)continue;const T=b[u];if(5===T.classId){const ja=T.Fault;if(ja)switch(ja.Type){case 1:da.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.jpf,ja.Limit,ja.AttemptedValue);this.jpf=ja.Limit;break;default:da.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(I)}else l.push(new um(I,T));T.ServerPageStatsTrace&&f.push(T.ServerPageStatsTrace)}return{returnValue:l,JHl:c,HNl:f}}mWk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.zD)this.executeNextRequest();else{var f=this.xe(c),l=this.Oli.mGl(a);
if(b.LCg()){var u=b.range;const I=[u];l.gwd(a)?(u=im.a(this.xn.KG(c)),1!==b.userAction&&c.qFi()&&this.Lli&&(a=l.Qbg(a,b,u)),this.JA.azd(c,I,b.Z2f),a=l.ukj(a,b,u),this.xn.PJf(c,a)):this.g0j(c,u);this.cKc.S1h(c)}c.txc();f.dispose();this.lT(c)}else this.executeNextRequest()}g0j(a,b){const c=[b];b=b.lcid;this.CXd.contains(b)||(da.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.CXd.add(b));this.JA.azd(a,c);this.c2b.hLf(a,c)}j4l(a){a=a.data;if(!this.tZc){var b=a.state;this.dKc.track(b.Lz.Qr,
"ProofingRequestRoundtrip");this.DZe(b.F2a);this.S1d(a);this.obe()}}DZe(a){this.Xca=a;a=new ne.a(3,1,this.j9,Object(R.a)(this,this.DHl,"retryCurrentRequest"),49);this.je.Jb(a);++this.tEc;this.j9*=Hh.g5e;this.j9>Hh.Cpc&&(this.j9=Hh.Cpc);4!==this.tEc||this.Bi.KHa||(this.e8a=ad.App.Ob.notificationBar.YEa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),ad.App.Ob.notificationBar.Ei(this.e8a),A.AFrameworkApplication.fj.Qdb(Hh.z7h,1),da.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.Bi.lvb(this))}LFl(){this.tEc&&(this.tEc=0,this.j9=Hh.Udb);this.e8a&&(ad.App.Ob.notificationBar.removeEntry(this.e8a),this.e8a=null,this.Bi.oPb(this))}DHl(){this.executeRequest(this.Xca)}okb(){ad.App.Ob.notificationBar.removeEntry(this.e8a);this.e8a=null;this.Bi.oPb(this)}CLb(){}get Vxe(){return!this.Cub.length&&!this.Xca&&!this.Q_b.length}S1d(a){$m.PageStats.Z9a("SpellCheck",a.Et);(a=a.gk?a.gk[Ck.a.UEa]:null)&&$m.PageStats.t9a(cl.a.ii,a)}obe(){$m.PageStats.GFa("SpellCheck")}}Hh.Oml="ProofingRequestsBatched";
Hh.Nml=1;Hh.Iml="ProofingContextualResultsIsEnabled";Hh.Qml="ProofingTrackMetricsIsEnabled";Hh.Lml="ProofingInstrumentedAndContextualIsEnabled";Hh.Sml="ProofingWithOneSpellerIsEnabled";Hh.Jml="ProofingExperimentId";Hh.Rml="ProofingWithEditorServiceIsEnabled";Hh.Kml="ProofingFilterSpellCheckResultIsEnabled";Hh.z7h=11093;Hh.KWk=30;Hh.Udb=1E3;Hh.g5e=5;Hh.Cpc=72E6;Object(m.a)(Hh,"ProofingCheckOperator",null,[370,491]);var vk=d(532);class fq{constructor(a){this.Ctb=a}ukj(a,b,c){if(this.X4e(a)){const f=
{};a=this.Aag(b,a,c,f);this.NCi(b,f);return a}b&&this.OCi(b);return[]}NCi(a,b){this.Ctb.track(()=>Object.assign(new vk.a,{E:a.aia,C:a.range.l4d,F:b}))}OCi(a){this.Ctb.track(()=>Object.assign(new vk.a,{E:a.aia,C:a.range.l4d}))}ADg(a,b,c){return!a||rd.a.all(a,f=>f.begin!==b||f.end!==c)}gHg(a,b,c){return!!a&&rd.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(m.a)(fq,"AProofingResultsManager",null,[567]);var go=d(531),fp;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";a[a.grammatical=2]="grammatical";
a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(fp||(fp={}));Object(m.b)("ProofingType",fp);class gp extends fq{constructor(a,b,c,f){f=void 0===f?null:f;super(a);this.La=f;this.Pdi=b;this.sO=c}gwd(a){return a&&63===a.classId?!0:(da.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}X4e(a){return this.gwd(a)&&!!a.Critiques&&0<a.Critiques.length}Aag(a,b,c,f){const l=[];b=b.Critiques;for(const T of b)if(this.u1j(b,T)&&this.OWl(T)){var u=
0<=a.range.Sba?a.range.Sba+T.Start:a.range.begin+T.Start;const ja=u+T.Length;var I=a.Xpa.substring(u,ja);const ua=this.Pdi.create(T,this.Ctb,this.La);ua.lcid=a.range.lcid;ua.token=I;ua.originalText=a.Xpa;ua.Sba=a.range.Sba;ua.lMa=a.range.lMa;a.range.end>=ja&&(I=new Lo(u,ja,ua),Array.add(l,I));this.ADg(c,u,ja)&&(u=1===ua.proofingType?fp[ua.proofingType]:ua.typeId,f[u]=u in f?f[u]+1:1)}return l}Qbg(a,b,c){if(!this.X4e(a))return a;const f=[];for(const l of a.Critiques){const u=0<=b.range.Sba?b.range.Sba+
l.Start:b.range.begin+l.Start;this.gHg(c,u,u+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}OWl(a){return 2!==go.b(a)||!this.sO.vXa}u1j(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(m.a)(gp,"ProofingCheckResultsManager",fq,[]);var pg=d(49),ll=d(95);class gq{constructor(a,b,c,f,l,u,I){this.YMd=!1;I&&c.QH(Object(R.a)(this,this.ftl,"recheckAllParagraphs"));b.nxi(Object(R.a)(this,this.p2k,"onAfterParagraphMerge"));
l&&l.Cd(12).B4(Object(R.a)(this,this.X7k,"onParagraphDisconnected"));this.JA=a;this.b0b=f;this.xn=u}X7k(a,b){$a.ParagraphReader.ke(b.node)&&this.xn&&this.xn.Mnd(b.node)}p2k(a,b){this.JA.ACi(b);this.lT(b.o$d.currentNode)}$dc(a){this.JA.fSl(a);this.lT(a)}ftl(a){if(2===a.mode&&(a=this.Ipg(a)))for(a=ll.a.PA(a);a.moveNext();)$a.ParagraphReader.Pl(a.iterator)&&this.lT(a.currentNode)}suspend(){this.b0b.suspend()}resume(){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",
!1)&&Object(Nb.a)("ALV2SpellingEnabled")||this.b0b.resume()}get Vxe(){return this.b0b.Vxe}get Z9e(){return this.YMd}set Z9e(a){if(this.YMd!==a&&(this.YMd=a,a=this.Ipg(ad.App.Ob))){var b=new pg.GraphTransaction(2);try{b.set(a.Ek);const c=ll.a.PA(a);for(;c.moveNext();)$a.ParagraphReader.Pl(c.iterator)&&c.currentNode.Dw(16,!0)}finally{b&&b.dispose()}}}Ipg(a){return(a.ie.isEditingAllowed||a.ie.eA)&&a.ie.yo.ep?a.ie.yo.Zg:null}Gvi(a){Array.add(this.b0b.brh,a)}lT(a){this.b0b.lT(a,!1)}}Object(m.a)(gq,"ProofingManager",
null,[165]);var hq=d(1274),iq=d(676);class rx extends iq.a{constructor(a){super(a);this.y1b=null}get proofingType(){return 1}get suggestions(){return this.y1b?Array.clone(this.y1b):null}aUl(a){this.y1b=a}DOa(a,b){b=void 0===b?0:b;this.YCf.track(()=>Object.assign(new vk.a,{E:0,T:1,A:a,I:b}))}}Object(m.a)(rx,"OfficeSpellerErrorDetails",iq.a,[]);class zv extends fq{constructor(a){super(a)}gwd(a){return!!a.Errors}X4e(a){return this.gwd(a)&&0<a.Errors.length}Aag(a,b,c,f){let l=0;const u=[],I=b.Errors;
for(let ua=0;ua<I.length;ua++){var T=I[ua],ja=Object.assign(new rx(this.Ctb),{token:T.Word,errorType:T.Type,lcid:a.range.lcid});ja.aUl(hq.a.b5h(b.Suggestions,ua*hq.a.JHg));const Ra=T.Offset+a.range.begin;T=Ra+T.Word.length;ja=new Lo(Ra,T,ja);Array.add(u,ja);this.ADg(c,Ra,T)&&l++}f.spelling=l;return u}Qbg(a,b,c){if(rd.a.Ta(c)||!a)return a;const f=[],l=[];for(let I=0;I<a.Errors.length;++I){const T=a.Errors[I];var u=T.Offset+b.range.begin;this.gHg(c,u,u+T.Word.length)&&(u=I*hq.a.JHg,Array.add(f,hq.a.Cuk(a.Suggestions,
u)),Array.add(f,hq.a.b5h(a.Suggestions,u)),Array.add(l,T))}a.Suggestions=f;a.Errors=l;return a}}Object(m.a)(zv,"ProofingResultsManager",fq,[]);class Mz{constructor(a,b,c){this.eKc=new Md.a;this.Aqf=b;a.getBooleanAppSetting("ProofingWithEditorServiceIsEnabled")&&this.eKc.add(63,c.value);this.eKc.add(4,this.Aqf)}mGl(a){if(this.eKc.Ib(a.classId))return this.eKc.ga(a.classId);da.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.Aqf}}
Object(m.a)(Mz,"ProofingResultsManagerResolver",null,[164]);class jq{constructor(a,b){this.QE=this.zd=null;this.pXd=void 0===a?null:a;this.qXd=void 0===b?null:b}get kg(){!this.zd&&this.pXd&&this.pXd.instance&&(this.zd=this.pXd.instance.instance);return this.zd}get gBc(){!this.QE&&this.qXd&&this.qXd.instance&&(this.QE=this.qXd.instance.instance);return this.QE}Onj(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;
" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:c}unj(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}zXa(a){return a.properties.ra(rb.a.zXa,!1)}Xbg(a){a=$a.ParagraphReader.text(a);let b;const c=[];for(;b=jq.K6j.exec(a);)Array.add(c,new jm.a(b.index+b[1].length,b.index+b[0].length));return c}Ybg(a,b,c){b=void 0===b?!0:b;c=void 0===c?
!1:c;let f=[],l=!1,u=!1,I=!1,T=!1,ja=-1;a=a.Sa;for(let Ra=0;Ra<a.length;Ra++){var ua=a.ga(Ra);ua.hyperlink?u=!0:ua.eo&&(u=!1);b&&ua.formatting&&(I=ua.formatting.cache.WXa);if(c&&(ua.VM&&(T=!1),ua.Bq)){const eb=Object(gb.a)(419,ua.Bq.Rh);eb&&(T=eb.aHa)}l!==(u||I||T||!!ua.blob)&&(ua=ua.cp,l?Array.add(f,new jm.a(ja,ua)):ja=ua,l=!l)}l&&(b=jm.a.createTextRange(ja,a.last.cp))&&Array.add(f,b);return f}F_c(a,b,c){b=void 0===b?!0:b;c=void 0===c?!1:c;return im.e(this.Xbg(a),this.Ybg(a,b,c))}P9b(a,b,c){if(b===
a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return jm.a.createTextRange(b,c)}G2c(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=jq.rgg(a,b,c);for(var l=0;l<f.length;l++){var u=f[l];if(a<u.begin)break;a<u.end&&(a=jq.rgg(u.end,b,c))}b=jq.Sig(b,c);for(l=f.length-1;0<=l;l--){u=f[l];if(b>u.end)break;b>u.begin&&(b=jq.Sig(u.begin,c))}return(a=jm.a.createTextRange(a,b))&&a.qtk()?a:null}static rgg(a,b,c){for(;a<b&&Aa.a.fA(c.charCodeAt(a));)a++;
return a}static Sig(a,b){for(;0<a&&jq.Qek(a,b);)a--;return a}static Qek(a,b){a=b.charAt(a-1).toString();return a===Vg.AParagraphNode.tWc||a===Vg.AParagraphNode.P0}}jq.K6j=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)","ig");Object(m.a)(jq,"ProofingTextUtility",null,[490]);class Av{constructor(){this.Da=null}get name(){return"Box4.Proofing"}fc(a){this.Da=a;this.Da.register(Fq,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().na(()=>new Fq(this.Da.resolve("Box4.IParagraphReader"),
U.a.instance.ga(14),U.a.instance.ga(70)));this.Da.register(Dp,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().na(()=>new Dp(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),A.AFrameworkApplication.fa.getBooleanAppSetting("MinimizeProofedRangesIsEnabled"),A.AFrameworkApplication.fa.getBooleanAppSetting("ProofingSetCentralWordRangeIsEnabled")));
this.Da.register(bg,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().na(()=>new bg);this.Da.register(Zq,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().na(()=>new Zq(as.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ha("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(es,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().na(()=>
new es(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),Pj.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ha("Box4.Proofing.IProofingSentenceSeparator")));
this.Da.register(jq,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().na(()=>new jq(this.Da.Ha("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.Ha("Box4.TrackChange.ITrackChangeReaderFactory")));const b=()=>{const c=A.AFrameworkApplication.fa.Ea("ProofingWebServiceBase");return(void 0===c?ad.App.webServiceBase:c)+"proofing.ashx?"+A.AFrameworkApplication.mh};this.Da.register(cs,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().na(()=>
new cs(A.AFrameworkApplication.Me,b));this.Da.register(yh,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().na(()=>new yh(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),jd.a.instance));this.Da.register(Ke,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().na(()=>new Ke(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),jd.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));
this.Da.register(od,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().na(()=>new od(A.AFrameworkApplication.fa,this.Da.Ha("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(162,"Box4.Proofing.IProofingDescriptors").ma().na(()=>new gd(A.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(Hh,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().na(()=>
new Hh(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),A.AFrameworkApplication.fa,ad.App.Ob,A.AFrameworkApplication.Me,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),cg.a.instance,this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Xq.a.XX(4,1,new bs),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),
this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.Da.Ha("Box4.Proofing.ICritiqueTypeSettings"),Cd.a.get_instance(),A.AFrameworkApplication.Be));this.Da.register(zv,"Box4.Proofing.ProofingResultsManager").ma().na(()=>new zv(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));
this.Da.register(163,"Box4.Proofing.IIgnoreAllKeywords").ma().na(()=>new Bp);this.Da.register(gp,"Box4.Proofing.ProofingCheckResultsManager").ma().na(()=>new gp(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),A.AFrameworkApplication.fa));this.Da.register(164,"Box4.Proofing.IProofingResultsManagerResolver").ma().na(()=>
new Mz(A.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.ze("Box4.Proofing.ProofingCheckResultsManager")));this.Da.register(165,"Box4.IProofingManager").ma().na(()=>new gq(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.ub("Box4.INotebookManager").BW,this.Da.ub("Box4.Proofing.IErrorRangeEditor"),4!==ad.App.mode));
this.Da.register(166,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().na(()=>new df(A.AFrameworkApplication.fa.getBooleanAppSetting("ProofingTrackMetricsIsEnabled"),Xq.a.XX(15,1,new Rs)));this.Da.register(167,"Box4.Proofing.IProofingConfigV2Manager").ma().na(()=>new Sb(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),jd.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),
this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){C.a.instance.Ac(new Av)}}Object(m.a)(Av,"Box4ProofingPackage",null,[2,3]);var ok=d(177);class fs{constructor(a){this.Eef=0;this.Edb=this.YNb=this.Sob=null;this.xca=A.AFrameworkApplication.za.DW;this.LR=a;this.LR.Bv(le.a.HLh);this.LR.dD(le.a.HLh,Object(R.a)(this,this.H8k,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.Edb)return da.ULS.sendTraceTag(589050652,
344,100,"Returning existing promise"),this.Edb;this.Sob=this.xca.lj("ComponentAttach","getCustomAuthConfig");return this.Edb=new Promise((a,b)=>{const c={};let f=!1,l=!1,u=0;this.Eef=window.setInterval(()=>{4>u?(u++,this.LR.sendMessage(le.a.getCustomAuthConfig,c)):(window.clearInterval(this.Eef),f=!0,da.ULS.sendTraceTag(588087303,344,10,Fe.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.YNb=(I,T)=>{window.clearInterval(this.Eef);f||l||(l=!0,I?(da.ULS.sendTraceTag(589050653,
344,50,"Resolving Promise with authConfig"),a(I)):(da.ULS.sendTraceTag(589050654,369,10,Fe.c({["error"]:T.toString()})),b(T)))};this.LR.sendMessage(le.a.getCustomAuthConfig,c)})}H8k(a){try{const b=Fe.a(a.Values[ok.a.kOi]);let c=A.AFrameworkApplication.fa.Ea("Application")||"";c=Aa.a.Dg(c);b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.Sob&&(this.Sob.stop(),this.Sob=null);this.YNb(b,"")}catch(b){da.ULS.sendTraceTag(589050655,344,10,Fe.c({["error"]:b.message,["stack"]:b.stack})),this.YNb(null,b.message)}}}Object(m.a)(fs,"AccountSwitchingManager",null,[269]);class gs{get name(){return"Common.App.AccountSwitching"}fc(a){a.register(fs,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().na(()=>
new fs(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){C.a.instance.Ac(new gs)}}Object(m.a)(gs,"AccountSwitchingPackage",null,[2,3]);class sx{constructor(){this.Ma=new uc.a}vvb(a){this.Ma.addHandler("OnEditHappenedEvent",a)}qBl(a){this.Ma.removeHandler("OnEditHappenedEvent",a)}Apl(){this.Ma.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(sx,"EditNotificationEventSource",null,[]);var hp=d(88);class Ss{constructor(a,b,c,f,l,u,I){I=void 0===I?0:I;this.WKd=!1;this.VKd=this.N7a=
null;this.VHf=!1;this.ixc=()=>{this.WKd&&(this.tQa.CWR(()=>this.tQa.result.sendMessage(le.a.afj,null)),da.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.WKd=!1)};this.uEl=()=>{try{this.xGc&&(hp.c(N.a.Qae),this.xGc=!1)}catch(T){this.xGc=!1,da.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+T)}};this.je=b;this.ZIc=a;this.tQa=c;this.Bja=f;this.THf=l;this.qdi=u;this.zFc=0;this.xGc=!1;try{0<I&&
(this.zFc=I,3E5>this.zFc&&(this.zFc=3E5),this.je&&!this.VKd&&(this.VKd=new ne.a(3,2,this.zFc,this.uEl),this.je.Jb(this.VKd)))}catch(T){da.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+T)}}get B4h(){return this.VHf}Rae(){this.B4h?this.xGc=!0:(this.VHf=!0,eg.Health.instance.addQosPillar("Save"),eg.Health.instance.addQosPillar("ContentCreation"),hp.c(N.a.Qae));this.WKd=!0;this.THf&&this.THf.kJf();this.Bja&&this.Bja.Apl();
A.AFrameworkApplication.gh&&A.AFrameworkApplication.gh.SVk();this.qdi&&!this.N7a&&(this.ixc(null),this.N7a=new ne.a(3,2,this.ZIc,this.ixc,113),this.je.Jb(this.N7a))}}Object(m.a)(Ss,"EditNotificationManager",null,[414]);class Ts{constructor(a,b,c,f,l){this.DMd=this.N7a=null;this.nsb=this.oHd=!1;this.RBh=()=>{const u=document.getElementById(A.AFrameworkApplication.rPc);!this.nsb&&this.SQ&&u&&(this.SQ.xb(la.a.Wq,u,this.zRe,null),this.nsb=!0);this.aSd(()=>{this.dispose()})};this.zRe=()=>{this.nsb&&(this.SQ.Hb(la.a.Wq,
document.getElementById(A.AFrameworkApplication.rPc),this.zRe),this.nsb=!1);this.kJf();return!1};this.ixc=()=>{this.oHd&&(this.tQa.CWR(()=>this.tQa.result.sendMessage(le.a.Slm,null)),da.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.oHd=!1)};this.je=b;this.ZIc=a;this.tQa=c;this.SQ=f;this.aSd=l;this.RBh(null)}kJf(){this.oHd=!0;this.DMd||(this.DMd=new ne.a(3,2,this.ZIc,this.RBh,112),this.je.Jb(this.DMd));this.N7a||(this.ixc(null),this.N7a=
new ne.a(3,2,this.ZIc,this.ixc,111),this.je.Jb(this.N7a))}dispose(){this.nsb&&(this.SQ.Hb(la.a.Wq,document.getElementById(A.AFrameworkApplication.rPc),this.zRe),this.nsb=!1)}}Object(m.a)(Ts,"UserActivityHostNotificationManager",null,[413,106]);var ln=d(141),hs=d(255);class kq{constructor(){this.Da=null;this.Pn=()=>{kq.bfj&&0<kq.Sae&&(this.Da.register(sx,"Common.App.HostNotification.EditNotificationEventSource").ma(),this.Da.register(Ts,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().na(()=>
new Ts(6E4,ln.a.instance,hs.a.Au(this.Da.Ha("Postmessage.IHostPostmessenger")),Ta.a.instance,A.AFrameworkApplication.Jia)),this.Da.register(Ss,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().na(()=>new Ss(kq.Sae,ln.a.instance,hs.a.Au(this.Da.Ha("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Da.ub("Common.Interface.IUserActivityHostNotificationManager"),kq.cfj,kq.Zej)),this.Da.resolve("Common.Interface.IEditNotificationManager"),
da.ULS.shipAssertTag(38086291,209,0<kq.Sae,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.Ue(this.Pn)}fc(a){this.Da=a}dispose(){}static get Sae(){return A.AFrameworkApplication.fa?parseInt(A.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get Zej(){return A.AFrameworkApplication.fa?parseInt(A.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get bfj(){return!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("EditNotificationIsEnabled")}static get cfj(){return!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("EditNotificationPostMessageIsEnabled")}static main(){C.a.instance.Ac(new kq)}}Object(m.a)(kq,"CommonHostNotificationPackage",null,[2,3]);class On{}On.pmd="ReactSharedHeaderMeControlFlexPane";On.Kva="headerui";On.o5b="chat_wrapper_pane";Object(m.a)(On,"ReactSharedHeaderConstants",
null,[]);class Bv{constructor(a){this.KCf=0;this.gJd=null;this.pmb=()=>{da.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.txb.getContainerProvider().then(b=>{b.getChatsContainer(this.q3k)}).catch(b=>{da.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.txb.getChatsCounter().then(b=>{b.onChatsCountChange(this.tRi)}).catch(b=>{da.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.txb.getKeyboard().then(b=>
{b.onKeyDown(this.t3k)}).catch(b=>{da.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){da.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}};this.tRi=b=>{da.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.B9e.p3k();else if(1===b&&!this.KCf){const c=document.getElementById(this.gJd?this.gJd:On.o5b);c?this.B9e.u3k(c,this.Cbm):da.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.KCf=b};this.q3k=b=>{this.gJd=
b};this.t3k=b=>{b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.Bbm(b.shiftKey)};this.Cbm=()=>{da.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.txb.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{da.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){da.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",b)}};this.kmi=a}get txb(){return window.swc}get isInitialized(){return!!this.txb}get B9e(){return this.kmi.value}qb(){this.isInitialized?
this.pmb():this.fxl(this.pmb)}fxl(a){Ye.a.instance.xb(la.a.A7l,window.self,()=>{a();return!0})}Bbm(a){da.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.B9e.r3k(a)}}Object(m.a)(Bv,"ChatManager",null,[412]);class Cv{constructor(){this.Ma=new uc.a;this.jHf=!1}Qzi(a){this.Ma.addHandler("OnTopRowControlsCreatedEvent",a)}wzi(a){this.Ma.addHandler("OnRenameTextboxStatusChangedEventKey",a)}get Sam(){return this.jHf}qql(){this.jHf=!1;this.Ma.raiseEvent("OnTopRowControlsDisposingEvent")}Dzh(a){this.Ma.raiseEvent("OnRenameTextboxStatusChangedEventKey",
a?"true":"false")}}Object(m.a)(Cv,"HeaderEventSource",null,[]);var tx=d(206);class Dv{constructor(a,b,c,f,l){this.xMc=null;this.s3k=()=>{this.xMc&&this.xMc()};this.Wd=a;this.KL=b;this.SQ=c;this.pqi=f;this.Ca=l}QBh(a,b,c,f){f=void 0===f?null:f;const l=this.Wd.Kc(b);l.parent=c;l.uK=!0;f&&l.Zda(f);this.SQ.s9(b,a,!1);this.pqi.s9(b,a,!1);b=new tx.DOMFocusListing(()=>a);b.xp(2);b.xp(1);b.xp(8);b.xp(5);b.xp(3);b.xp(6);this.Wd.hla(()=>a,l,b).IY=!0;b=B.KeyInputManager.Va(H.a.zs,0);c=B.KeyInputManager.Va(H.a.zs,
4);l.Sy(b);l.Sy(c)}onFlexPaneOpen(a){this.QBh(a,On.pmd,On.Kva);this.Wd.Df(On.pmd);this.KL.y4(On.pmd)}onFlexPaneClose(){this.KL.zp(On.pmd);this.Wd.Df(On.Kva)}u3k(a,b){this.xMc||(this.xMc=b,this.QBh(a,On.o5b,K.AFrame.vD,this.s3k));this.Wd.Df(On.o5b);this.KL.y4(On.o5b)}p3k(){this.KL.zp(On.o5b);this.Wd.UYc(K.AFrame.PX)}r3k(a){this.Ca.nb(a?N.a.Ece:N.a.Dce,2)}}Object(m.a)(Dv,"ReactSharedHeaderFocusManager",null,[411]);var xr=d(533);class Ev{constructor(a){this.Jih=(b,c,f,l,u)=>{if(1===f)return 32;b=8;2===
f&&(f=this.Dge(u,"experience","gopremiumribbon"),u=oe.a.aY("2116536"),u=oe.a.sSa(u,"ocid",xr.b(A.AFrameworkApplication.za.mb.Ej,A.AFrameworkApplication.za.mb.wLa,f)),Sd.a.qo(u,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.Ca.nb(N.a.sFh,2),da.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b};this.launchUpsellExperience=(b,c,f,l,u)=>{if(1===f)return 32;var I=8;2===f&&(da.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(I=Tb.a.instance.ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(b=this.Dge(u,"experience","gopremium"),u=this.Dge(u,"dimeCampaignId",null),I.launchUpsellExperience(b,u),I=32):(da.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),I=this.Jih(b,c,f,l,u)));return I};this.Ca=a}qb(){this.Ca.xa(N.a.fZc,Le.a.frame,this.Jih);this.Ca.xa(N.a.grj,Le.a.frame,this.launchUpsellExperience);this.Ca.xa(N.a.AEl,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.sFh,Le.a.frame,ff.ActionManager.uh)}Dge(a,b,c){a&&a[b]&&(c=Object(gb.a)(String,a[b]));return c}}
Object(m.a)(Ev,"UpsellActor",null,[270]);class Fv{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){Tb.a.instance.resolve("Common.App.Header.IUpsellActor").qb();Tb.a.instance.resolve("Common.App.Header.IChatManager").qb()}dispose(){}fc(a){this.Da=a;this.Da.register(Cv,"Common.App.Header.HeaderEventSource").ma();this.Da.register(Ev,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().na(()=>new Ev(A.AFrameworkApplication.Pa));this.Da.register(Dv,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().na(()=>
new Dv(A.AFrameworkApplication.za.Zs,A.AFrameworkApplication.za.Yx,A.AFrameworkApplication.za.sT,A.AFrameworkApplication.za.upb,A.AFrameworkApplication.Pa));this.Da.register(Bv,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().na(()=>new Bv(this.Da.ze("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){C.a.instance.Ac(new Fv)}}Object(m.a)(Fv,"CommonAppHeaderPackage",null,[2,3]);class ux{constructor(a,b,c,f,l){this.Jcb=u=>{let I=!1,T=null;try{if(0<u.data.Ud.length){const ja=
Object(gb.a)(Object,Fe.a(u.data.Ud)),ua=ja?ja[this.rG.$_d]:null;ua&&(T=Object(gb.a)(Object,Fe.a(ua.toString())))}I=!0}catch(ja){this.DGa(null)}I&&this.bYb&&this.bYb(u.data,T)};this.DGa=u=>{this.ZXb&&this.ZXb(u?u.data:null)};this.Shl=u=>{this.BCf&&this.BCf(u?u.data:null)};this.mMa=u=>{this.Y_b&&this.Y_b(u?u.data:null)};this.rG=a;this.bYb=b;this.ZXb=c;this.BCf=void 0===f?null:f;this.Y_b=void 0===l?null:l}nce(a){const b=new Sys.StringBuilder(this.rG.Awc);b.append("RoamingServiceHandler.ashx?action=");
b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.Pje(a));b.append("&");b.append(A.AFrameworkApplication.mh);A.AFrameworkApplication.Me.Tj(b.toString(),1,null,null,!0,2,this.Jcb,this.DGa,null)}mXc(a){var b=new Sys.StringBuilder(this.rG.Awc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(A.AFrameworkApplication.mh);b=b.toString();a=Fe.c(a);A.AFrameworkApplication.Me.Tj(b,2,a,null,!0,4,this.Shl,this.mMa,null)}Pje(a){const b=
new Sys.StringBuilder("requestedsettings=");for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(m.a)(ux,"FirstRunExperienceRequestHandler",null,[]);var Gv=d(410);class vx{constructor(){this.JXb=this.cGc=this.rG=null;this.Jcb=(a,b)=>{a=a?+a.au-+a.Et:-1;a>this.rG.DHh?da.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
a,this.rG.DHh):b?this.c_l(b)?(da.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.rG.ohh),this.M$e()):(this.S$d(!1),da.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(da.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.M$e())};this.DGa=a=>{this.S$d(!1);
da.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.Ke:-1)};this.mMa=a=>{da.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",a?a.Ke:-1)};this.k5k=a=>{if(a){var b=a.detail;a=a.type;var c=this.rG&&this.rG.rUf?this.rG.rUf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c)){if("FRELaunchedEvent"===a||b&&b.success)da.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.gJh(this.rG.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.JXb,!0),window.removeEventListener("FRELaunchedEvent",this.JXb,!0))}}}}L$e(a){a?(this.rG=a,this.Clk()&&(da.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new La.a,a.add(this.rG.$_d),this.cGc=new ux(this.rG,this.Jcb,this.DGa,null,this.mMa),this.cGc.nce(a)),
(this.rG.sGg||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.M$e()):da.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Clk(){try{if(this.rG.sGg)return!0;if(!A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||A.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser"))return!1;if(this.rG.bhk||this.rG.hFb||A.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost"))return!0;
const a=A.AFrameworkApplication.fa.Ea("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){da.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",a?a.toString():null)}return!1}gJh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.rG.$_d]=Fe.c(c);da.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.cGc&&this.cGc.mXc(b)}M$e(){this.S$d(!0);
var a=Tb.a.instance.ub("Common.ISystemInitiatedFeedback");a?this.vRh(a):(da.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((a=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.vRh(b)}):da.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}vRh(a){if(a){var b=this.rG.wpj;b&&A.AFrameworkApplication.KYa(b);
da.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.JXb=this.k5k,window.addEventListener("FGWebSurfaceEvent",this.JXb,!0),window.addEventListener("FRELaunchedEvent",this.JXb,!0)):(da.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.gJh(this.rG.currentVersion))}else da.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}c_l(a){if("RemindMeLater"in
a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.rG.ohh)return!0}else if(A.AFrameworkApplication.fa.getBooleanAppSetting("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in a&&a.VersionDisplayed<this.rG.currentVersion)return da.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}S$d(a){A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Gv.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(m.a)(vx,"FirstRunExperienceLauncher",null,[203]);class Hv{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}fc(a){this.Da=a;this.Da.register(203,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().na(()=>new vx)}init(){}dispose(){}static main(){C.a.instance.Ac(new Hv)}}Object(m.a)(Hv,"FirstRunExperienceLauncherPackage",null,[2,3]);class Us{constructor(){this.lHd={}}usi(a){this.lHd[a.id.toString()]=
a}P0k(a){const b=this.lHd;for(const c in b)b[c].notify(a,!1);this.lHd={}}Cnl(a,b){b&&this.usi(b);return this.gph(a,b)}abe(a){this.P0k(a)}q8f(a,b){a.notify(b,!0)}}Object(m.a)(Us,"AEventEmitter",null,[272]);var Vs;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.gAd=2]="shouldRetry";a[a.complete=3]="complete"})(Vs||(Vs={}));Object(m.b)("EventResultState",Vs);class Ep{constructor(){this._state=0}get state(){return this._state}set state(a){da.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",
{["OldState"]:Vs[this._state],["NewState"]:Vs[a]},"ResultType",this.Fng());this._state=a}}Object(m.a)(Ep,"AEventResult",null,[358]);class Nz extends Ep{constructor(){super();this.$Vd=this.U_b=null;this.state=0;this.KNd=this.qvf=!1}get SS(){return this.U_b}get cOa(){return this.$Vd}get eck(){return this.qvf}Fng(){return"GetMoreInfo Result"}}Object(m.a)(Nz,"GetMoreInfoResult",Ep,[357,358]);var wx=d(445),xx=d(534);class lq{constructor(a,b,c,f,l,u,I,T){this.HMb=(ja,ua,Ra,eb,Bb)=>{Bb&&Bb.MenuItemId&&(da.ULS.sendTraceTag(5849678,
202,50,"Opening new tab {0}",{["Id"]:Bb.SourceControlId,["AppType"]:xx.a[this.E2]}),Sd.a.qo(Bb.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.jWe=(ja,ua,Ra,eb,Bb)=>{if(Bb&&Bb.MenuItemId){const Ub=A.AFrameworkApplication.fa.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost"),Xb=A.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");da.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
Ub,Xb);if(Ub&&Xb){da.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Bb.SourceControlId,["AppType"]:xx.a[this.E2]});ja=Bb.MenuItemId.toString();const tc={};tc[ok.a.WOb]="1";tc[ok.a.documentUrl]=ja;tc[ok.a.reason]=wx.a.open;da.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");A.AFrameworkApplication.WU().execute(lc=>{lc.sendMessage(le.a.yFa,tc)})}else this.HMb(ja,ua,Ra,eb,Bb)}return 32};this.VVc=()=>{this.pKg();return 32};this.Ca=a;this.Bi=b;
this.nJ=c;this.kja=f;this.je=l;this.YXb=u;this.nfi=I;this.QLc=T}Rvl(){this.DLb.xa(N.a.HMb,Le.a.frame,this.HMb);this.DLb.xa(N.a.jWe,Le.a.frame,this.jWe);A.AFrameworkApplication.Nea?this.pKg():this.DLb.pa(N.a.VVc,Le.a.frame,this.VVc,96)}Ewa(a,b,c){c=void 0===c?"":c;if(b&&b.Et){const f=sp.a[b.status];b=b.Et.getTime();const l=this.IG()-b;da.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,["StartTime"]:b,["Notes"]:c})}else da.ULS.sendTraceTag(5849680,
202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}pKg(){var a=A.AFrameworkApplication.fa.getBooleanAppSetting("QPGVCI"),b=oe.a.VO(document.URL,"wdNewAndOpenCt",a);if(b){b=parseInt(b);var c=oe.a.VO(document.URL,"wdPreviousSession",a);a=oe.a.VO(document.URL,"wdPreviousCorrelation",a);var f=A.AFrameworkApplication.fa.getBooleanAppSetting("NAOPLP");if(A.AFrameworkApplication.Nea){var l=A.AFrameworkApplication.Nea.getTime();!b||b>l?da.ULS.sendTraceTag(5849682,
202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):da.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else da.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get DLb(){return this.Ca.value}get sqc(){return this.Bi.value}get Sih(){return this.nJ.value}get E2(){return this.kja.value}get lnd(){return this.je.value}get IG(){return this.YXb}get yha(){return this.nfi.value}get VAa(){return this.QLc.value}static get instance(){return lq.Ja||(lq.Ja=lq.Fs())}static Fs(){return new lq(new Hc.a(()=>A.AFrameworkApplication.Pa),new Hc.a(()=>A.AFrameworkApplication.Me),new Hc.a(()=>A.AFrameworkApplication.za),
new Hc.a(()=>A.AFrameworkApplication.za.mb.Ej),new Hc.a(()=>A.AFrameworkApplication.Be),()=>(new Date).getTime(),new Hc.a(()=>A.AFrameworkApplication.za.mb.yha),new Hc.a(()=>A.AFrameworkApplication.VAa))}}lq.Ja=null;Object(m.a)(lq,"NewAndOpenCommonHelpers",null,[271]);class Iv{constructor(a,b,c){this.iLc=this.Wn=null;this.iUd=0;this.Cni=a;this.je=b;this.Iqf=c}xCi(){this.iUd=this.SPb+1}L4e(a){this.Wn&&(this.je.Vg(this.Wn),this.Wn=null);a&&(this.iUd=0)}q5l(a){const b=this.S$l;0<=b?(this.xCi(),this.L4e(!1),
this.Wn=new ne.a(4,1,b,a,107),this.je.Jb(this.Wn)):(this.L4e(!0),da.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Iqf}))}get SPb(){return this.iUd}get S$l(){return this.SPb>=this.YKh.length?-1:this.YKh[this.SPb]}get YKh(){if(!this.iLc){const a=(this.Cni.value||"0").split(",");this.iLc=[];for(let b=0;b<a.length;b++){const c=parseInt(a[b]);isNaN(c)?da.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Iqf,["Entry"]:a[b]}):
Array.add(this.iLc,c)}}return this.iLc}}Object(m.a)(Iv,"RetryHelper",null,[]);class Pn extends Us{constructor(a,b){super();this.$ja=a;this.w0b=new Iv(b,this.Upc.lnd,"GetMoreInfo");this.hw=new Nz}rVk(){this.xQe("Document opened")}C4i(a){return()=>{this.xQe(a,!0)}}gph(a,b){b=void 0===b?null:b;da.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.hw.state?(b&&this.q8f(b,this.hw),da.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",
{["Trigger"]:a})):this.xQe(a);return this.hw}xQe(a,b){this.w0b.L4e(!(void 0===b?0:b));1===this.hw.state?da.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.w0b.SPb}):(da.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.w0b.SPb}),this.hw.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Upc.yha,A.AFrameworkApplication.mh),this.Upc.sqc.jU(b,1,null,null,
[Pn.qCf,Pn.tGf],5,this.C3i(),this.B3i(a),null))}C3i(){return a=>{var b=!1;let c=!1;var f=!1,l;if(A.AFrameworkApplication.fa.getBooleanAppSetting("GetMoreInfoDataFromResponseBody"))if(a.data.Ud){let u=Fe.d(a.data.Ud);({Ev:l}=u);u.returnValue?l?(f=!0,this.hw.$Vd=l.StorageServiceDisplayName,this.hw.U_b=Pn.YGg(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.hw.SS&&"SharePointOnlineConsumer"===A.AFrameworkApplication.fa.Ea("FileSource")&&(this.hw.U_b=oe.a.Vba(A.AFrameworkApplication.breadcrumbFolderUrl)),
b=""===this.hw.SS&&""!==this.hw.cOa):da.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):da.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else da.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");f||((l=a.data.gk)?
(this.hw.$Vd=(l[Pn.tGf]||"").toString(),b=(l[Pn.qCf]||"").toString(),this.hw.U_b=Pn.YGg(b)?b:"",""===this.hw.SS&&"SharePointOnlineConsumer"===A.AFrameworkApplication.fa.Ea("FileSource")?(this.hw.U_b=oe.a.Vba(A.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.hw.SS&&""!==this.hw.cOa):b=""===b&&""!==this.hw.cOa):(da.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.w0b.SPb,c,b,f);this.Upc.Ewa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",a.data,f);this.kLh(3,b,c)}}B3i(a){return b=>{this.Upc.Ewa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.kLh(2);this.w0b.q5l(this.C4i(a))}}kLh(a,b,c){this.hw.state=a;this.hw.qvf=void 0===b?!1:b;this.hw.KNd=void 0===c?!1:c;this.abe(this.hw)}get Upc(){return this.$ja.value}static get instance(){return Pn.Ja||(Pn.Ja=Pn.Fs())}static Fs(){return new Pn(new Hc.a(()=>lq.instance),
new Hc.a(()=>A.AFrameworkApplication.UFj))}static YGg(a){if(!a)return da.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Aa.a.Dg(a).startsWith("https://"))return!0;da.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Pn.qCf="PersonalFileStorageUrl";Pn.tGf="StorageServiceDisplayName";Pn.Ja=null;Object(m.a)(Pn,"GetMoreInfoActor",Us,[]);class Hq{constructor(a,b,c,f,l){this.Rfi=6E4;this.Twg="inactive";this.cJf="active";
this.Tja=!0;this.je=a;this.Qei=b;this.YXb=c;this.qMc=f;this.Ma=new uc.a;l&&this.i5l();this.Sxf=this.Tkg()}uJf(a){this.Ma.addHandler(this.cJf,a)}gvi(a){this.Ma.addHandler(this.Twg,a)}i5l(){const a=new ne.a(5,2,this.Rfi,Object(R.a)(this,this.K7j,"inactiveLoop"),108);this.L7j.Jb(a)}K7j(){const a=this.Tkg(),b=this.IG()-a;b>this.eDd&&this.Tja&&(da.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.Tja=!1,this.Ma.raiseEvent(this.Twg));a-this.Sxf>this.eDd&&(this.Tja=
!0,this.Ma.raiseEvent(this.cJf));this.Sxf=a}get L7j(){return this.je.value}get Tkg(){return this.Qei}get IG(){return this.YXb}get eDd(){return this.qMc.value}static get instance(){return Hq.Ja||(Hq.Ja=Hq.Fs())}static Fs(){return new Hq(new Hc.a(()=>ln.a.instance),()=>A.AFrameworkApplication.yze.getTime(),()=>(new Date).getTime(),new Hc.a(()=>A.AFrameworkApplication.eDd),!0)}}Hq.Ja=null;Object(m.a)(Hq,"InactivityManager",null,[]);var bu=d(946);class cu extends Ep{constructor(){super();this.yji=this.jAf=
this.iAf=null;this.state=this.fHf=0;this.KNd=!1}get aSe(){return this.iAf}get pih(){return this.jAf}get V$l(){return this.fHf}Fng(){return"MruActor Result"}}Object(m.a)(cu,"MruResult",Ep,[369,358]);class du{constructor(a,b,c){this.task=null;this.Udb=a;this.bXk=b;this.rT=c;this.retryCount=this.Vdc=0;this.kTd=this.Rgc=null}ynk(a,b){return a===ah.a.Nee||20===b||18===b||3===b}fpk(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===
a||28===a}get Bsd(){return this.kTd}reset(){this.Vdc=this.retryCount=0;this.kTd=this.Rgc=null;this.task&&(this.rT.Vg(this.task),this.task=null)}Qak(a,b,c,f){this.kTd=String.format("{0}_{1}",c,f);if(this.retryCount>=this.bXk)return da.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.ynk(c,f))return da.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.fpk(f)&&1<=this.Vdc)return this.Rgc=c,!1;b=Math.max(b,this.Udb*Math.pow(2,this.Vdc));if(26===
f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.Rgc||412!==this.Rgc)?b=500:this.Vdc+=1;this.Rgc=c;this.retryCount+=1;this.task&&this.rT.Vg(this.task);da.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new ne.a(2,1,b,a,107);this.rT.Jb(this.task);return!0}}Object(m.a)(du,"RetryManager",null,[]);var $q=d(214),fh=d(65);class yx{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=
null}}Object(m.a)(yx,"WriteOptions",null,[]);class vm extends Us{constructor(a,b,c,f,l,u,I){super();this.Mpm=T=>{this.Qsg(T.data)};this.g8i=T=>{if(T.data.Ke===ah.a.c7b)this.Qsg(T.data);else{var ja=T.data.Ke===ah.a.Ctc,ua=$q.a.Yz();this.otg(this.jSa,T,this.V7i(),ua);ua&&(ua.set("StatusCode",T.data.Ke.toString()),ja||this.SYd(T.data,ua));eg.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",T.data.Ke),ja,!1,Object.assign(new Fl.a,{extendedProperties:ua}))}};this.cGj=T=>{this.Glg(T)};
this.bGj=T=>{this.Glg(T,!0)};this.ZFj=T=>{this.Flg(T)};this.YFj=T=>{this.Flg(T,!0)};this.$ja=a;this.Gii=b;this.ERa=new du(A.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),A.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.iH.lnd);this.jSa=new du(A.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),A.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",
3),this.iH.lnd);this.pmi=c;this.AIf=f;this.Lri={};this.X8=new cu;this.Mei=l;this.RIc="";this.lG=u;this.bsf=I;this.qmi=A.AFrameworkApplication.fa.tc("WordRecentLinksCount",25)}get wGd(){return this.Lri}fyl(){this.iH.DLb.xa(N.a.GEh,Le.a.frame,Object(R.a)(this,this.$Cl,"renameMruEntry"))}$Cl(){return this.zjf("Rename")}zVk(){this.Wfh("File Opened")}AVk(){this.Wfh("IntervalUpdate")}Wfh(a){da.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.zjf(a)}AR(a){(a=Aa.a.AR(a))&&
a.startsWith(".")&&(a=a.substring(1,a.length));return a}FZc(){switch(this.iH.E2){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}lRj(a){var b=this.Mei();if(!b)return null;const c=new yx;c.documentUrl=this.bsf.value?encodeURI(b):b;c.mruItemId=this.RIc;c.app=this.FZc();if(b=this.lG())c.folderName=b.breadcrumbFolderName,b=b.iy,c.documentName=Aa.a.dI(b),c.documentExt=this.AR(b);a&&(c.documentName?c.documentName.length?
255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}zjf(a,b){b=void 0===b?!1:b;if(4===this.iH.E2&&!A.AFrameworkApplication.TVc)return 2;var c=$q.a.Yz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.RIc?"true":"false"),c.set("URLEncoded",this.bsf.value?"true":"false"));eg.Health.instance.recordKpiUsage("WriteMru",
0,"smartfio",c);a=this.lRj(c);if(!a)return b=!A.AFrameworkApplication.pqb,c&&(c.set("WebEditingIsEnabled",A.AFrameworkApplication.pqb?"true":"false"),c.set("ProtectedFile",A.AFrameworkApplication.cD?"true":"false")),eg.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",b,!1,Object.assign(new Fl.a,{extendedProperties:c})),2;this.jSa&&!b&&this.jSa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.iH.yha,this.kAe);this.AIf?this.wGd["X-FileId"]=A.AFrameworkApplication.mh:
c+=String.format("&{0}",A.AFrameworkApplication.mh);A.AFrameworkApplication.ld&&(this.wGd["X-Office-AudienceGroup"]=Object(gb.a)(String,A.AFrameworkApplication.ld.AudienceGroup)||"");this.wGd["X-Timeout"]=15E3;return this.iH.sqc.Tj(c,2,a,this.wGd,!0,5,this.Mpm,this.g8i,null,void 0,void 0,void 0,void 0,"4")}Qsg(a){const b=$q.a.Yz();this.jSa&&(b&&this.jSa.Bsd&&(b.set("LastError",this.jSa.Bsd),b.set("NumRetries",this.jSa.retryCount.toString())),this.jSa.reset());const c=bu.c(a.Ud);c&&c.diagnostics_data&&
(this.RIc=c.diagnostics_data.mru_id);a=+a.au-+a.Et;b&&b.set("RequestDuration",a.toString());eg.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Fl.a,{extendedProperties:b}))}V7i(){return()=>{this.zjf("Retry",!0)}}aGj(){this.Sld("Polling")}$Fj(){this.Sld("Retry",!0)}tVk(){this.Sld("Open")}sVk(){this.Sld("Activity")}Sld(a,b){b=void 0===b?!1:b;var c=void 0===c?!1:c;da.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const f=$q.a.Yz();f&&(f.set("Trigger",a),f.set("IsRetry",
b?"true":"false"),c&&f.set("RecentLinks","true"));eg.Health.instance.recordKpiUsage("GetMru",0,"smartfio",f);this.ERa&&!b&&this.ERa.reset();c?this.W0f(this.bGj,this.YFj,!0):this.W0f(this.cGj,this.ZFj)}SYd(a,b){a&&a.gk&&(a=a.gk["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}GAk(a,b){a&&(b&&b.set("RequestDuration",(+a.au-+a.Et).toString()),eg.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Fl.a,{extendedProperties:b})))}Glg(a,b){b=void 0===b?!1:b;var c="";let f=null,l=null,u=null;const I=
bu.c(a.data.Ud);I&&(f=I.places?I.places.items:[],l=I.documents?I.documents.items:[],(u=bu.a(I,b))&&(c=Fe.c(u)));A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.WHa&&fh.c()&&!b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(c,!0));c=$q.a.Yz();this.ERa&&(c&&this.ERa.Bsd&&(c.set("LastError",this.ERa.Bsd),c.set("NumRetries",this.ERa.retryCount.toString())),this.ERa.reset());b&&c&&c.set("RecentLinks","true");u||f||l?(b?this.iH.Ewa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
a.data,"Success"):this.iH.Ewa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.cFd(3,u,f,l),this.GAk(a.data,c)):(b?this.iH.Ewa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",a.data,"Failure: Invalid JSON"):this.iH.Ewa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),c&&this.SYd(a.data,c),eg.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Fl.a,{extendedProperties:c})),this.cFd(3,null,null,null,!0));this.abe(this.X8)}otg(a,
b,c,f){let l=0,u=0;const I=bu.c(b.data.Ud);I&&(null!=I.response_code&&(l=I.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.RIc="")),I.error_data&&null!=I.error_data.retry_after_ms&&(u=I.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",u.toString())));a&&(b=a.Qak(c,u,b.data.Ke,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}Flg(a,b){b=void 0===b?!1:b;const c=a.data.Ke===ah.a.Ctc,f=$q.a.Yz();f&&(f.set("StatusCode",a.data.Ke.toString()),
b&&f.set("RecentLinks","true"),c||this.SYd(a.data,f));b?this.iH.Ewa("MruActor.GetMruForRecentLinksFromServerFailureCallback",a.data,"Failure"):this.iH.Ewa("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.cFd(2);this.otg(this.ERa,a,Object(R.a)(this,this.$Fj,"getMruFromServerRetryTask"),f);eg.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.Ke),c,!1,Object.assign(new Fl.a,{extendedProperties:f}));this.abe(this.X8);A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.WHa&&
fh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),b||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}cFd(a,b,c,f,l){if(3!==this.X8.state||3===a)this.X8.iAf=void 0===b?null:b,this.X8.jAf=void 0===c?null:c,this.X8.yji=void 0===f?null:f,this.X8.state=a,this.X8.KNd=void 0===l?!1:l,this.X8.fHf=this.iH.IG()}gph(a,b){da.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.X8.state});b&&3===this.X8.state&&this.q8f(b,
this.X8);return this.X8}W0f(a,b,c){c=void 0===c?!1:c;this.cFd(1);let f;const l={};f=c?String.format(this.iH.yha+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.qmi,"OfficeSuite",this.kAe,"ClassicMru"):String.format(this.iH.yha+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.FZc(),this.kAe);this.pmi.value||(f+="&entity=docs");A.AFrameworkApplication.ld&&(l["X-Office-AudienceGroup"]=Object(gb.a)(String,A.AFrameworkApplication.ld.AudienceGroup)||"");c&&
(l["X-Office-Application"]="147");this.AIf?l["X-FileId"]=A.AFrameworkApplication.mh:f+=String.format("&{0}",A.AFrameworkApplication.mh);this.iH.sqc.Tj(f,1,null,l,!0,5,a,b,null)}get iH(){return this.$ja.value}get kAe(){return this.Gii.value}static get instance(){return vm.Ja||(vm.Ja=vm.Fs())}static Fs(){return new vm(new Hc.a(()=>lq.instance),new Hc.a(()=>Ea.a.Oe(A.AFrameworkApplication.lcid).name),new Hc.a(()=>A.AFrameworkApplication.za.mb.SD),A.AFrameworkApplication.fa.getBooleanAppSetting("MruWriteFileIdInHeader"),
()=>A.AFrameworkApplication.za.mb.lR,()=>A.AFrameworkApplication.Qu,new Hc.a(()=>A.AFrameworkApplication.fa.getBooleanAppSetting("OICEncodeUrlIsEnabled")))}}vm.Ja=null;Object(m.a)(vm,"MruActor",Us,[]);class zx{constructor(){this.d2b=this.lDf=this.Da=null;this.Zo=!1;this.V$i=()=>{ln.a.instance.Vg(this.rih)};this.eKf=()=>{ln.a.instance.Jb(this.rih)}}get name(){return"Common.App.NewAndOpen.Core"}fc(a){this.Da=a;a.register(271,"Common.INewAndOpenCommonHelpers").ma().na(()=>lq.instance);a.register(272,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().na(()=>Pn.instance);a.register(272,"Common.IEventEmitter<Common.IMruResult>").ma().na(()=>vm.instance)}init(){A.AFrameworkApplication.fa.Ue(()=>{this.gHa()})}gHa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;lq.instance.Rvl();A.AFrameworkApplication.Qya&&(a=!0);A.AFrameworkApplication.A1e&&(vm.instance.tVk(),
0<A.AFrameworkApplication.qih&&this.eKf(),this.NVl(),a=!0);A.AFrameworkApplication.VAa&&a&&Pn.instance.rVk();A.AFrameworkApplication.hjm&&(a=vm.instance,a.fyl(),a.zVk(),ln.a.instance.Jb(this.ijm))}NVl(){Hq.instance.uJf(Object(R.a)(vm.instance,vm.instance.sVk,"makeGetMruRequestActivityTrigger"));Hq.instance.uJf(this.eKf);Hq.instance.gvi(this.V$i)}get rih(){return this.lDf||(this.lDf=new ne.a(5,2,A.AFrameworkApplication.qih,Object(R.a)(vm.instance,vm.instance.aGj,"getMruFromServerTask"),109))}get ijm(){return this.d2b||
(this.d2b=new ne.a(2,2,6E4*A.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(R.a)(vm.instance,vm.instance.AVk,"makeUpdateMruTask"),197))}dispose(){this.Zo||(this.Zo=!0,this.d2b&&(ln.a.instance.Vg(this.d2b),this.d2b=null))}}Object(m.a)(zx,"CorePackageManager",null,[2,3,106]);var yj=d(126);class Ax{constructor(a,b,c,f,l,u,I,T,ja,ua){this.Z_g=new La.a;this.lbh=null;this.Yb=f;this.sa=l;this.Fa=c;this.Pwa=I;this.Jna=T;this.hB=u;this.oa=
b;this.ka=ja;this.xq=a;this.xd=ua;this.ka.Hpk&&(this.oa&&this.oa.AG(Object(R.a)(this,this.oE,"onSelectionChanged")),T&&T.axl(this),this.xq.iOc(Object(R.a)(this,this.ZV,"onFocusChanged")),this.xd.sMf(Object(R.a)(this,this.Drc,"onShapeViewElementUnlocked")),this.xd.cBi(Object(R.a)(this,this.Gqh,"onThumbnailsSetFakeImage")),this.xd.dBi(Object(R.a)(this,this.Hqh,"onThumbnailsSetFocus")),this.xd.eBi(Object(R.a)(this,this.Iqh,"onThumbnailsSetSelected")),this.ka.p7c&&this.xq.Mzi(Object(R.a)(this,this.$ph,
"onSlideshowNavigationToolbarClickedHandler")),this.ka.Mg&&this.xq.Lzi(Object(R.a)(this,this.Yph,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.xq.mvd(Object(R.a)(this,this.ZV,"onFocusChanged"));this.xq.BAl(Object(R.a)(this,this.p4k,"onDesignerClickSuggestion"));this.xd.yEh(Object(R.a)(this,this.Drc,"onShapeViewElementUnlocked"));this.xd.NCl(Object(R.a)(this,this.Gqh,"onThumbnailsSetFakeImage"));this.xd.OCl(Object(R.a)(this,this.Hqh,"onThumbnailsSetFocus"));this.xd.PCl(Object(R.a)(this,
this.Iqh,"onThumbnailsSetSelected"));this.ka.p7c&&this.xq.VBl(Object(R.a)(this,this.$ph,"onSlideshowNavigationToolbarClickedHandler"));this.ka.Mg&&this.xq.UBl(Object(R.a)(this,this.Yph,"onSlideshowContextMenuFocusedHandler"))}oE(a,b){if(b&&b.wl&&this.oa.u1(b.wl))try{this.WZj(b.wl)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",c.message,c.stack),ya.a.J(508694669,822,10,a)}}WZj(a){var b=this.oa.rf();if(1===a.length||1===b.length&&b[0].Rg){if(a=
this.oa.Zn()){b=new La.a;let c=this.jng(a,b,Object(R.a)(this,this.dMj,"getShapeName"));c||b.count||(c=this.Jna.nog(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:Aa.a.Ta(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.Jna.lMj(a);({IPf:c,$jf:b}=this.WNf(f,c,b));!a.Bt&&a.isUnread&&({IPf:c,$jf:b}=this.WNf(this.Jna.mMj(a,this.lbh),c,b));0<b.count?this.zAh(b):this.dia(c||"")}}else 1<a.length&&(a=this.Jna.eGj(this.oa.Hd()),this.dia(a||""))}WNf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):
b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{IPf:b,$jf:c}}ZV(a,b){b=b.qkb;if(b===yj.a.XE||b===xc.a.Ag){a=this.sa.Aa;let c=null;b===yj.a.XE?c=(a=this.Yb.EAc.baa)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.Ccb()+this.Jna.yle(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.Ccb()):b!==xc.a.Ag||!this.oa.Js()&&this.oa.H5()||(this.hB&&this.hB.value&&(b=this.hB.value.$d)&&a&&b.Wp&&ek.e(a,b.Na),c=this.Jna.RMj());this.dia(c||"")}}setAttribute(a,
b,c){a&&Qe.a.bT(a,b,c)}C7(a){this.Z_g.add(a)}jng(a,b,c){c=void 0===c?null:c;try{if(a&&this.Fa)for(const f of this.Z_g)if(f){const l=f(a,this.Fa.Je?this.Fa.Je.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),ya.a.J(508694667,822,10,a)}return null}zAh(a){if(this.Pwa&&this.Pwa.value){const b=this.Pwa.value.OEj();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");
for(const f of a)c.appendChild(f);b.appendChild(c)}}}CAh(a,b){if(a){const c=new La.a;let f=this.jng(a,c);f||c.count||(f=this.Jna.nog(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.zAh(c)):(b&&(f+=" "+b),this.dia(f||""))}}dia(a){this.Pwa&&this.Pwa.value&&this.Pwa.value.K7(a,!0)}Drc(a,b){b.presenceUser&&b.Ppk&&this.dia(String.format(ResourceStrings.L_EditorLeavingHint,b.presenceUser.userName))}p4k(a,b){this.dia(this.Jna.xzj(b.TLl,b.a7l))}Gqh(a,b){this.setAttribute(b.e8.image,Qe.a.Ff,Qe.a.PSa)}Hqh(a,
b){b.hasFocus&&b.e8.isSelected&&this.dia(this.Ccb()+this.Jna.yle(b.e8));this.setAttribute(b.e8.wpb,Qe.a.Q9a,b.hasFocus&&b.e8.isSelected?"true":"false")}Iqh(a,b){b.e8.isSelected&&b.hasFocus?this.dia(this.Ccb()+this.Jna.yle(b.e8)):b.e8.isSelected||this.dia(this.Ccb());this.setAttribute(b.e8.wpb,Qe.a.Q9a,b.e8.isSelected?"true":"false")}$ph(a,b){this.dia(b.text)}dMj(a){this.lbh=a||ResourceStrings.l_Object}Yph(a,b){this.dia(b.text)}Ccb(){let a="";const b=this.oa.Xe();b&&1<b.length&&(b.sort((c,f)=>c.ve-
f.ve),this.ewb(b)&&(a=this.Jna.Ccb(b[0].ve+1,b[b.length-1].ve+1)));return a}ewb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].ve-a[0].ve+1===b?!0:!1}}Object(m.a)(Ax,"AriaManager",null,[146,106]);var Oz=d(947);class Bx{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}fc(a){this.K=a;this.K.register(145,"PowerPointWebEditor.IAriaMessageHelper").ma().na(()=>new Oz.a(this.K.Ha("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ha("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),this.K.ze("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(146,"PowerPointWebEditor.IAriaManager").ma().na(()=>new Ax(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.ze("Box4.IInteractiveViewManager"),this.K.ze("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){C.a.instance.Ac(new Bx)}}
Object(m.a)(Bx,"PptAriaPackage",null,[2,3]);var Pz=d(1071);class Iq{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=Iq.Ofj;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0;this.AnnotationId=null}}Iq.Ofj=[];Object(m.a)(Iq,"Critique",null,[]);class Jv{constructor(){this.Text=
null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(Jv,"Suggestion",null,[]);class eu{VSc(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new Iq,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.r0i(c.tags):0,Start:c.start,
Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.S6d(c.supportedActions)),c.suggestions&&(a.Suggestions=this.Y6d(c.suggestions)),b.push(a);return b}Y6d(a){if(!a)return null;const b=[];for(const c of a)(a=this.W6d(c))&&b.push(a);return b}W6d(a){if(!a)return null;const b=Object.assign(new Jv,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.R6d(a.confidenceLevel)});a.actions&&
(b.Action=this.X6d(a.actions));return b}R6d(a){return 1===a?0:2===a?1:2}X6d(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}r0i(a){return a.consistency?1:0}S6d(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&(b|=8);a.showDetails&&(b|=32);return b}}Object(m.a)(eu,"CloudALResponseTransformer",null,[1251]);var Zg=d(82),Qz=d(536);class Cx{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.Oxa=
a;this.Whb=b;this.nbh=c;this.sa=f;this.Eb=l;this.ia=u;this.nc=T;this.Qm=ja;this.Uh=ua;this.Nc=I;this.lB=Ra;this.Oxa.aEa(Object(R.a)(this,this.CLa,"onBeforeParagraphDisconnect"));this.Oxa.Ak(Object(R.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Nc.fyi(Object(R.a)(this,this.Inh,"onLanguageOnRangeChanged"));this.Whb.aEa(Object(R.a)(this,this.rlh,"onBeforeNumberListDisconnect"));this.Whb.Ak(Object(R.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));
this.nbh.VE(Object(R.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.sa.Aa;if(!b||!b.isConnected)return!1;const c=Object.assign(new Qz.a,{slideId:b.Fb});this.ia.Ia(M.a.f2a,2,c);return 0<c.dzc?(ya.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",a,b.id),!1):!0}initialize(){this.ute(this.sa.Aa)}dispose(){this.Oxa.UMa(Object(R.a)(this,this.CLa,"onBeforeParagraphDisconnect"));this.Oxa.tn(Object(R.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Nc.UAl(Object(R.a)(this,this.Inh,"onLanguageOnRangeChanged"));this.Whb.UMa(Object(R.a)(this,this.rlh,"onBeforeNumberListDisconnect"));this.Whb.tn(Object(R.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.nbh.RN(Object(R.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}CLa(a,b){this.rBc(Object(gb.a)(Vg.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==rb.a.np&&
b.property!==ib.a.listLevel||this.rBc(Object(gb.a)(Vg.AParagraphNode,b.node),!1)}Inh(a,b){this.rBc(b.paragraphNode,!0)}rlh(a,b){b.node&&Object(gc.a)(Zg.a,b.node)&&this.rBc(this.lB.Die(Object(gb.a)(Zg.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(gc.a)(Zg.a,b.node)&&b.node.isConnected&&b.property===rb.a.Dj&&this.rBc(this.lB.Die(Object(gb.a)(Zg.a,b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(gb.a)(4,b.node))a=this.nc.ug(a),this.ute(a)}rBc(a,b){!this.UXl(a)||b&&this.$0j(a)||
(a=Object(gb.a)(205,this.nc.ug(a)),this.ute(a))}ute(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Eb.xe(7,G.a.mFd);b.mc(a);a.isSlideCritiqueReady=!1;b.dispose()}}UXl(a){return!!a&&a.isConnected&&this.Uh.ke(a)&&!this.Qm.I$(a)&&!a.ra(yb.a.jV,!1)}$0j(a){a=a.ra(rb.a.np,"");return!a||!a.length}}Object(m.a)(Cx,"ConsistencyCheckManager",null,[150,106]);var wm=d(158),Fp=d(535);class ip{constructor(){this.d=this.p=this.w=null}}Object(m.a)(ip,"ProofingDashboardTraceMetrics",null,[]);class Gl{}
Gl.fze="bs";Gl.R9c="bd";Gl.z5h="was";Gl.A5h="wad";Gl.dpk="rm";Gl.Fpm="wd";Gl.jom="ad";Gl.NGl="rs";Object(m.a)(Gl,"TelemetryFieldNames",null,[]);class Om{}Om.G$l="tcw";Om.bDd="tcc";Om.OHg="bs";Om.Uuk="bd";Om.NHg="bpc";Om.hgh="md";Object(m.a)(Om,"TelemetryValues",null,[]);class Ws{constructor(){this.wn=this.i=null}}Object(m.a)(Ws,"Workflow",null,[]);var pk=d(330);class Xs{constructor(a){pk.a.assign(Xs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,
[Xs.getTypeName()])}}Xs.H_={T_:Xs.getTypeName(),B_:Xs.getBaseTypes()};class fu{constructor(a){pk.a.assign(fu,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[fu.getTypeName()])}}fu.H_={T_:fu.getTypeName(),B_:fu.getBaseTypes()};class gu{constructor(a){pk.a.assign(gu,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[gu.getTypeName()])}}gu.H_={T_:gu.getTypeName(),B_:gu.getBaseTypes()};class hu{constructor(a){pk.a.assign(hu,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,
[hu.getTypeName()])}}hu.H_={T_:hu.getTypeName(),B_:hu.getBaseTypes()};class Ys{constructor(a){pk.a.assign(Ys,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[Ys.getTypeName()])}}Ys.H_={T_:Ys.getTypeName(),B_:Ys.getBaseTypes()};class Zs{constructor(a){pk.a.assign(Zs,
this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[Zs.getTypeName()])}}Zs.H_={T_:Zs.getTypeName(),B_:Zs.getBaseTypes()};class $s{constructor(a){pk.a.assign($s,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[$s.getTypeName()])}}$s.H_={T_:$s.getTypeName(),B_:$s.getBaseTypes()};class jp{constructor(a){pk.a.assign(jp,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[jp.getTypeName()])}}jp.H_=
{T_:jp.getTypeName(),B_:jp.getBaseTypes()};class at{constructor(a){pk.a.assign(at,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[at.getTypeName()])}}at.H_={T_:at.getTypeName(),B_:at.getBaseTypes()};class bt{constructor(a){pk.a.assign(bt,
this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[bt.getTypeName()])}}bt.H_={T_:bt.getTypeName(),B_:bt.getBaseTypes()};class ct{constructor(a){pk.a.assign(ct,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,
[ct.getTypeName()])}}ct.H_={T_:ct.getTypeName(),B_:ct.getBaseTypes()};class dt{constructor(a){pk.a.assign(dt,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[dt.getTypeName()])}}dt.H_={T_:dt.getTypeName(),B_:dt.getBaseTypes()};class mq{constructor(a){pk.a.assign(mq,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[mq.getTypeName()])}}mq.H_={T_:mq.getTypeName(),B_:mq.getBaseTypes()};class et{constructor(a){pk.a.assign(et,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,
[et.getTypeName()])}}et.H_={T_:et.getTypeName(),B_:et.getBaseTypes()};class ft{constructor(a){pk.a.assign(ft,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return pk.a.matchesTypesFor(a,[ft.getTypeName()])}}ft.H_={T_:ft.getTypeName(),B_:ft.getBaseTypes()};
class Kv extends Sys.EventArgs{constructor(a){super();this.Aa=a}}Object(m.a)(Kv,"RefreshTileAnnotationsEventArgs",Sys.EventArgs,[]);class Lv{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){this.sa=a;this.bE=b;this.bNe=c;this.Eb=f;this.mIk=l;this.U9g=u;this.VP=I;this.Ga=T;this.Qm=ja;this.Ba=ua;this.RCe=Ra;this.$aa=eb;this.AFk=Ub;this.Uhc=Xb;this.xd=tc;this.Wb=lc;this.LKb=Ec}initialize(){this.VP.execute(a=>{this.Ba.G5?(a.aM(jp.getTypeName()),a.Dvl(jp.getTypeName(),this.Bme.bind(this)),md.a("PPTOAugLoopProofingTelemetry")&&
ya.a.J(508966307,375,20,"EditorServiceResultsManager.initialize: Activated annotation {0} on AugLoop v2 session & registered annotation handler {1}",jp.getTypeName,this.Bme.getName),this.xd.kU(this.onActiveSlideDomReady.bind(this))):(a.addEventHandler(Fp.a.t1d,Object(R.a)(this,this.Xrg,"handleAugResults")),md.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966306,375,20,"EditorServiceResultsManager.initialize: Registered event handler {0} with AugLoop V1 session for {1}",this.Xrg.getName,Fp.a.t1d),this.Ba.pptAugmentationLoopCloudALEnabled&&
(a.addEventHandler(Fp.a.cSc,Object(R.a)(this,this.asg,"handleCloudALResults")),md.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966305,375,20,"EditorServiceResultsManager.initialize: Registered event handler {0} with AugLoop V1 session for {1}",this.asg.getName,Fp.a.cSc)))})}dispose(){this.Ba.G5&&this.xd.wqa(this.onActiveSlideDomReady.bind(this))}onActiveSlideDomReady(a,b){var c,f,l;if(md.a("EnableAnnotationStorage")&&this.Uhc&&b&&b.Aa){var u=b.Aa;u&&null!==(c=u.yj())&&void 0!==c&&c.some(I=>I.hasText)&&
(a=Vh.a.Aq(u.sid,u.cid),a=this.Uhc.tuj(a),!a||1>a.length?this.LKb.execute(I=>I.Bzh(new Kv(u))):(b=null===(l=null===(f=u.changesData)||void 0===f?void 0:f.dtField)||void 0===l?void 0:l.getTime(),f=a.map(I=>I.body).filter(I=>I&&I.critiqueMetadata.sourceTimestamp).map(I=>Number(I.critiqueMetadata.sourceTimestamp)).find(I=>0<I),!f||!b||f>=b?this.Bme(a,!1,!1):this.LKb.execute(I=>I.Bzh(new Kv(u)))))}}Bme(a,b,c){c=void 0===c?!0:c;md.a("EnableAnnotationStorage")&&this.Uhc&&c&&this.Uhc.VTj(a,b);c=Date.now();
var f=this.Uhc.Iog(a);if(f&&!b&&a&&!(1>a.length)){b=[];f=this.Wb.Qk(f);for(var l of a){const u=l.body;if(!u)continue;const I=this.qvj(f,Number(u.critiqueMetadata.shapeId),Number(u.critiqueMetadata.paragraphIndex));I&&b.push(...this.AFk.VSc([u],I.id.toString()))}this.$Vk(b,f);md.a("PPTOAugLoopProofingTelemetry")&&(l=Date.now(),a=a.map(u=>u.body).filter(u=>u&&u.critiqueMetadata.sourceTimestamp).map(u=>Number(u.critiqueMetadata.sourceTimestamp)).find(u=>0<u),ya.a.J(508945999,375,20,"ALv2TotalProofingTime: {0}, ALv2MarkingResultsTime: {1}",
l-a,l-c))}}$Vk(a,b){var c;try{md.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966304,375,20,"ALv2: Marking critiques for slide, critiques count: {1}",null!==(c=null===a||void 0===a?void 0:a.length)&&void 0!==c?c:0);const I=md.a("ALV2SpellingEnabled"),T=this.k1c(a,I);if(T){var f=new La.a,l=this.sa.Aa.pea,u=this.Eb.xe(7,G.a.mFd);u.mc(b);for(const ja in T){const ua=Object(gb.a)(Vg.AParagraphNode,l.Ie(Ua.a.Tf(ja)));if(!ua||ua.ra(wm.a.R5,!1))continue;f.add(ja);const Ra=T[ja];Ra||0<Ra.length?this.fWk(ua,
Ra):this.eDh(ua);ua.setValue(wm.a.R5,!0)}if(this.Ba.pptEditorConsistencyCheckIsEnabled){const ja=String.format("Start:{0}",(new Date).getTime().toString());c=0;const ua=b.isSlideCritiqueReady;l=!1;if(!ua){const Ra=new La.a,eb=this.k1c(a,!0);(l=this.Pbg(eb,f,b,Ra))&&(c=this.XOf(eb,f,b,Ra))}ya.a.J(509116999,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",ja,(new Date).getTime().toString(),ua,l,c)}b.setValue(wm.a.ove,!0);u.dispose()}}catch(I){ya.a.J(509116997,375,10,"markEditorServiceResultsForALV2 failed {0}",
I.message)}}fWk(a,b){const c=this.WDj(a);this.kgh(a,b,c)}WDj(a){const b=new bd.ScriptSharpLegacyMap;let c=-1,f=-1,l=0;for(let u=0;u<a.Sa.length;u++){const I=a.Sa.ga(u).formatting;I&&(f=Od.a.language(I),-1!==c&&c!==f&&(b.add(l,f),l=a.Sa.ga(u).cp),c=f)}b.add(l,f);return b}qvj(a,b,c){if(!a)return null;a=a.ER(b);if(!a)return null;a=a.aA();b=0;for(const f of a)if(f.characterData){if(b==c)return f;b++}return null}Xrg(a,b,c,f){ya.a.J(509116995,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",
f.Telemetry,(new Date).getTime().toString());var l=this.igg(b.Content);c=this.nAj(f.Payload);if(l&&c){var u=!1;if(this.Ba.pptRegisterSingleProofingWorkflowEnabled||!this.Ba.pptAugmentationLoopCloudALEnabled||this.Ba.pptAugmentationLoopShadowCloudALEnabled)this.igh(c.Critiques,l),u=!0;l=(new Date).getTime();if(f=this.$aa.e$d(f.DashboardTelemetry))try{const I={};I[Gl.NGl]=c.ResponseStatus;I[Gl.dpk]=u;I[Gl.Fpm]=l-f.d[Gl.fze];I[Gl.jom]=f.d[Gl.A5h]-f.d[Gl.z5h];f.d=I;f.p=Om.hgh;this.$aa.track(f)}catch(I){ya.a.J(509116993,
375,15,"trace metrics exception {0}",I.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());ya.a.J(509116992,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",u,b.Id,c.Critiques?c.Critiques.length:0,a)}else ya.a.J(509116994,375,10,c?"Aug slide is null":"Result is null")}}asg(a,b,c,f){ya.a.J(509116963,375,50,"Handle Cloud AL results");a=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&ya.a.J(509116962,375,15,"Get partial success response");c=String.format("MarkStart:{0}",a.toString());
var l=this.igg(b.Content);if(l){var u=!1;if(this.Ba.pptRegisterSingleProofingWorkflowEnabled||!this.Ba.pptAugmentationLoopShadowCloudALEnabled)u=this.RCe.VSc(f.critiques),this.igh(u,l),u=!0;var I=(new Date).getTime(),T=Object.assign(new ip,{w:Object.assign(new Ws,{wn:Om.bDd,i:b.Id}),p:Om.hgh,d:{["ms"]:a,["md"]:I,["rm"]:u,["rs"]:f.partialSuccess?1:0}});this.$aa.track(T);c=String.format("{0}, MarkDone:{1}",c,I.toString());ya.a.J(509116960,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",
u,b.Id,f.critiques?f.critiques.length:0,c);md.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508945998,375,20,"ALv1TotalProofingTime: {0}, ALv1MarkingResultsTime: {1}",I-l.sourceTimestamp,I-a)}else ya.a.J(509116961,375,10,"Aug slide is null")}}igg(a){let b=null;try{b=Fe.a(a)}catch(c){return ya.a.J(509116959,375,10,"Try parse aug slide failed"),null}return b}nAj(a){let b=null;try{b=Fe.a(a)}catch(c){return ya.a.J(509116958,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),
null}if(!b)return ya.a.J(509116957,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return ya.a.J(509116956,375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&ya.a.J(509116955,375,15,"Get partial success response");return b}igh(a,b){var c;try{const T=this.sa.Aa;md.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(509088202,375,20,"ALv1: Marking critiques for slide, critiques count: {1}",
null!==(c=null===a||void 0===a?void 0:a.length)&&void 0!==c?c:0);if(!this.yZl(b,T)){var f=this.k1c(a,!1);if(f){var l=this.sa.Aa.pea,u=new La.a,I=this.Eb.xe(7,G.a.mFd);I.mc(T);for(const ja of b.drawingElems)if(ja.text&&ja.text.paragraphs)for(const ua of ja.text.paragraphs){const Ra=ua.id;u.add(Ra);const eb=Object(gb.a)(Vg.AParagraphNode,l.Ie(Ua.a.Tf(Ra)));if(eb&&!eb.ra(wm.a.R5,!1)){if(this.Ba.pptEditorGrammarAndWritingStyleIsEnabled)if(Ra in f){const Bb=Array.isArray(f[Ra])?f[Ra]:null;if(!Bb||!Bb.length||
Bb[0].RevisionId!==eb.ra(wm.a.d$c,0).toString())continue;this.kgh(eb,Bb,this.KKj(ua.cfRuns))}else this.eDh(eb);eb.setValue(wm.a.R5,!0)}}if(this.Ba.pptEditorConsistencyCheckIsEnabled){const ja=String.format("Start:{0}",(new Date).getTime().toString());b=0;const ua=T.isSlideCritiqueReady;c=!1;if(!ua){const Ra=new La.a,eb=this.k1c(a,!0);(c=this.Pbg(eb,u,T,Ra))&&(b=this.XOf(eb,u,T,Ra))}ya.a.J(509116998,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",ja,(new Date).getTime().toString(),ua,
c,b)}T.setValue(wm.a.ove,!0);I.dispose()}}}catch(T){ya.a.J(509116996,375,10,"MarkEditorServiceResults failed {0}",T.message)}}KKj(a){const b=new bd.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}kgh(a,b,c){var f=this.bE.KG(a,u=>!!u.Rh);const l=[];for(const u of f)1===u.Rh.proofingType&&Array.add(l,u);b=this.Zmj(a,b,l);f=this.Ymj(b,f);this.bE.TMa(a,f);this.ggh(b,a,c);a.setValue(wm.a.R5,!0)}eDh(a){const b=this.bE.KG(a,c=>!!c.Rh&&1!==c.Rh.proofingType);
this.bE.TMa(a,b);a.setValue(wm.a.R5,!0)}XOf(a,b,c,f){const l=c.pea,u=new Md.a;let I=0;this.QFl(c);for(const ja in a){var T=a[ja];const ua=Object(gb.a)(Vg.AParagraphNode,l.Ie(Ua.a.Tf(ja)));T=Array.isArray(T)?T:null;if(!(ua&&ua.isConnected&&T&&T.length))continue;const Ra=[];for(const eb of T)this.BAg(eb)&&!f.contains(eb.BucketId)&&Ra.push(eb);0<Ra.length&&(this.ggh(Ra,ua),u.Ib(ua.id.toString())||u.$(ua.id.toString(),ua),I+=Ra.length)}if(0<u.count)for(const ja of b)u.Ib(ja)&&(a=u.ga(ja))&&c.UNa.add(a);
c.isSlideCritiqueReady=!0;return I}Pbg(a,b,c,f){var l=this.HHj(c);if(b.count!==l.count)return this.V$c(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.pea;for(var u of b){if(!l.contains(u))return this.V$c("ParaId changed"),!1;b=Object(gb.a)(Vg.AParagraphNode,c.Ie(Ua.a.Tf(u)));if(!b||!b.isConnected)return this.V$c("Invalid ParaId"),!1;if(!b.ra(wm.a.R5,!1))return this.V$c("Para pending proofing"),!1}for(const I in a){u=a[I];l=Object(gb.a)(Vg.AParagraphNode,c.Ie(Ua.a.Tf(I)));
u=Array.isArray(u)?u:null;if(!u||!u.length)continue;b=this.bE.KG(l,ja=>!!ja.Rh&&(1===ja.Rh.proofingType||2===ja.Rh.proofingType||3===ja.Rh.proofingType));const T=this.bE.KG(l,ja=>{ja=Object(gb.a)(419,ja.Rh);return!!ja&&5===ja.proofingType&&ja.aHa});l=this.bNe.F_c(l,!1,!0);for(const ja of u)if(this.BAg(ja)){if(this.D6c(ja,b)||this.Pgk(ja,u))f.add(ja.BucketId),ya.a.J(509116954,375,50,"Overlap critique: {0}",ja.BucketId);(this.D6c(ja,l)||this.D6c(ja,T))&&f.add(ja.BucketId)}}return!0}V$c(a){ya.a.J(509116953,
375,50,"Skip apply: {0}",a)}Zmj(a,b,c){if(this.Ba.G5)return b;const f=[];for(const l of b){if(this.T0j(b,l)||a.characterData.length<l.Start+l.Length||this.D6c(l,c))continue;const u=go.b(l);2!==u&&3!==u||f.push(l)}return f}Ymj(a,b){const c=[];for(const f of b)this.VXl(a,f)||Array.add(c,f);return c}VXl(a,b){const c=b.Rh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===c){for(const f of a)if(this.y8c(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}D6c(a,b){const c=a.Start;
a=a.Start+a.Length;for(const f of b)if(this.y8c(c,a,f.begin,f.end))return!0;return!1}k1c(a,b){const c={};md.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966303,375,20,"Including spelling critiques {0}",b);if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}VVa(a,b){let c=0;for(const f of a)if(b>=f.key)c=f.value;else break;return c}ggh(a,b,c){c=void 0===c?null:c;if(a&&a.length&&b){var f={},l=[];for(const I of a){var u=I.Start;const T=u+I.Length,
ja=b.characterData.substring(u,T);a=this.mIk.create(I,this.U9g);a.token=ja;c&&(a.lcid=this.VVa(c,u));u=new Lo(u,T,a);Array.add(l,u);a=1===a.proofingType?fp[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.bE.PJf(b,l);this.U9g.track(()=>Object.assign(new vk.a,{E:2,C:this.mTc(b.characterData),F:f}))}}T0j(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.y8c(c,f,l.Start,l.Start+l.Length)&&go.a(l)>go.a(b))return!0;return!1}Pgk(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==
a&&this.y8c(c,f,l.Start,l.Start+l.Length))return!0;return!1}y8c(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}mTc(a){return as.a.instance.Lqg(a,0,a.length-1)}yZl(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}BAg(a){return!!a&&5===go.b(a)}HHj(a){const b=new La.a;a=a?a.yj():[];for(const c of a)this.Qm.NHa(c)||this.Ga.lH(c,f=>{b.add(f.id.toString())});return b}QFl(a){for(const b of a.UNa){const c=b;if(c){const f=this.bE.KG(c,l=>{l=Object(gb.a)(419,l.Rh);return!!l&&5===l.proofingType&&!l.aHa});this.bE.TMa(c,
f)}}a.UNa.clear()}}Object(m.a)(Lv,"EditorServiceResultsManager",null,[]);class Dx extends Cp.a{constructor(a,b,c,f,l,u){super(a,b,c,f,void 0===u?null:u);this.dH=l}get proofingType(){const a=super.proofingType;return this.dH.vXa||2!==a?a:1}}Object(m.a)(Dx,"PPTEditorServiceErrorDetails",Cp.a,[]);class Ex{constructor(a,b,c){this.ILk=a;this.rQk=b;this.dH=c}create(a,b,c){return new Dx(a,b,this.ILk,this.rQk,this.dH,void 0===c?null:c)}}Object(m.a)(Ex,"PPTEditorServiceErrorDetailsFactory",null,[147]);class Fx{constructor(a){this.Ba=
a}filter(a){if(a&&(!this.Ba.pptEditorConsistencyCheckIsEnabled||!this.Ba.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=go.c(b.CritiquePriority,b.CritiqueTag);this.Ba.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ba.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(m.a)(Fx,"PPTProofingCritiqueCategoryInfoFilter",
null,[148]);class Mv extends iq.a{constructor(a,b){super(null);this.rTd=a;this.errorType=2;this.sJg=b}get proofingType(){return this.rTd}get suggestions(){return[]}DOa(){}}Object(m.a)(Mv,"UnknownErrorDetails",iq.a,[]);class Nv{constructor(a,b,c,f,l){this.Nof=this.Kof=null;this.BXd=this.$Qd=0;this.TJd=!1;this.vj=a;this.d0b=b;this.JA=c;this.xn=f;this.sO=l;this.SEc=0}XAh(a,b,c){return{Rxh:a,Bkh:b,Akh:c}}Z_h(){}gAe(a,b,c,f,l,u,I,T){!u&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.vj.Sa.last.cp,u=
this.vj.characterData.length,Array.add(I,new jm.a(b,u)),(c||f)&&Array.add(T,new Lo(b,u,new Mv(this.sO.Mye?l?l[a]:0:f?2:1,c?1:2))))}rjm(a,b){this.JA.$3e(this.vj,a);b&&this.xn.RDl(this.vj,b);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&Object(Nb.a)("ALV2SpellingEnabled")||this.Qxh()}Qxh(){this.d0b.lT(this.vj)}bKl(a,b,c,f){this.eJh(this.SEc,b,c,f);this.d6e(a,this.TJd)}eJh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.sO.Mye?a:0)}d6e(a,
b){a.add(b)}Vxk(a){let b,c,f,l;b=this.vj.ra(rb.a.Tya,null);c=this.vj.ra(rb.a.$Na,null);f=this.vj.ra(ib.a.fdb,null);l=this.vj.ra(ib.a.S1a,null);this.vj.KDb=this.vj.ra(ye.a.yqc,!1);({Tya:b,$Na:c,fdb:f,S1a:l}=this.$4h(b,c,f,l,a,"loading"));return{Tya:b,$Na:c,fdb:f,S1a:l}}f6e(a,b,c,f,l){({Tya:a,$Na:b,fdb:c,S1a:f}=this.$4h(a,b,c,f,l,"saving"));this.l8e(rb.a.Tya,a);this.l8e(rb.a.$Na,b);this.n$e()&&this.l8e(ib.a.fdb,c);this.VRl(ib.a.S1a,f);this.vj.KDb?this.vj.He(ye.a.yqc,!0):this.vj.removeProperty(ye.a.yqc)}n$e(){return!0}l8e(a,
b){b&&Array.contains(b,!0)?this.vj.He(a,b):this.vj.removeProperty(a)}VRl(a,b){!b||rd.a.all(b,c=>0===c)?this.vj.removeProperty(a):this.vj.He(a,b)}WUi(a,b){(b=this.vj.Sa.ga(b).formatting)?(a.formatting=b.le(a),U.a.instance.ga(57)&&(this.vj.$v(),-1!==a.formatting.Cg&&this.vj.wordRunProperties.dDb(b.Cg,64))):(da.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),jd.a.instance.kc("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}$4h(a,
b,c,f,l,u){const I=jd.a.instance.Cq(G.a.Zmm);I.properties.$(Mc.a.source,u);let T=!1;a&&a.length!==l&&(da.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,u),T=!0);b&&b.length!==l&&(da.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,u),T=!0);this.n$e()&&c&&c.length!==l&&(da.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
c.length,l,u),T=!0);f&&f.length!==l&&(da.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,u),T=!0);if(T)for(f=c=b=null,a=[],u=0;u<l;u++)Array.add(a,!0);I.end();return{returnValue:!T,Tya:a,$Na:b,fdb:c,S1a:f}}kqh(){}BTe(){this.SEc=0;this.Kof=this.vj.D2||[];this.Nof=this.vj.hUb||[];this.BXd=this.$Qd=0;this.TJd=!1}ETe(a,b){a.Bq&&a.Bq.Rh?this.SEc=a.Bq.Rh.proofingType:a.VM&&(this.SEc=0);const c=a.cp,f=b?b.cp:
c;this.TJd=(()=>{let l=this.SAg(c,f,this.Kof,this.$Qd);({Qbf:this.$Qd}=l);return l})().returnValue||(()=>{let l=this.SAg(c,f,this.Nof,this.BXd);({Qbf:this.BXd}=l);return l})().returnValue}SAg(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,Qbf:f}}return{returnValue:!1,Qbf:f}}}Object(m.a)(Nv,"ProofingDataHandler",null,[1322]);var gk=d(517);class Gp extends Nv{constructor(a,b,c,f,l,u,I,T,ja,ua){super(a,b,c,f,T);this.$Vg=!1;this.qic=null;this.MK=l;this.ia=u;
this.Ga=I;this.nc=ja;this.Abd=null;this.ka=ua}kqh(){this.MK.yem(this.vj)}XAh(a,b,c){this.vj.Cue||(a=!1,c=this.xn.KG(this.vj));this.Abd=this.xn.KG(this.vj,f=>{f=Object(gb.a)(419,f.Rh);return!!f&&5===f.proofingType&&!f.aHa});return{Rxh:a,Bkh:b,Akh:c}}Z_h(a,b,c,f,l){const u=Object(gb.a)(205,this.nc.ug(this.vj));this.vj&&u&&u.isConnected&&u.isSlideCritiqueReady&&Aa.a.$0d(this.vj.characterData,b)&&this.Abd&&0<this.Abd.length&&(Array.addRange(l,this.Abd),l.sort((I,T)=>I.end-T.end));if(!a&&c&&0<c.length&&
Aa.a.$0d(this.vj.characterData,b)&&f&&0<f.length){for(const I of c)this.OEg(I,f)&&!this.OEg(I,l)&&Array.add(l,I);l.sort((I,T)=>I.end-T.end)}}OEg(a,b){a=im.c([a],b);return!rd.a.Ta(a)&&rd.a.any(a,c=>c.begin<c.end)}Qxh(){this.ka.G5&&Object(md.a)("ALV2SpellingEnabled")?this.MK.xok(this.vj)&&this.d0b.lT(this.vj):ya.a.J(508913505,375,15,"Paragraph legacy proofing hit")}n$e(){return!1}d6e(a,b){this.$Vg=!0;super.d6e(a,b);b&&(this.vj.He(wm.a.R5,!1),this.vj.He(wm.a.d$c,(new Date).getTime()))}eJh(a,b){this.qic||
(this.qic=this.xn.KG(this.vj));b.add(1===a)}BTe(){super.BTe();this.qic=null}gAe(a,b,c,f,l,u,I,T){u||(b=!!b&&b[a],a=!!c&&c[a],c=this.vj.Sa.ga(this.vj.Sa.length-1),b?(Array.add(I,new jm.a(c.cp,this.vj.characterData.length)),this.aKl()):(b=this.Fvj(c.cp,this.vj.characterData.length,this.vj.characterData,ja=>{ja=ja.Rh.proofingType;return 2===ja||3===ja}))&&0<b.length&&Array.addRange(T,b),a&&(Array.add(I,new jm.a(c.cp,this.vj.characterData.length)),Array.add(T,new Lo(c.cp,this.vj.characterData.length,
new Mv(1,1)))))}f6e(a,b,c,f,l){this.$Vg||this.O1j()||ya.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.f6e(a,b,c,null,l)}O1j(){if(!this.vj)return ya.a.J(508921562,375,10,"ParagraphNode is null"),!1;var a=this.Ga.Gn(this.vj);if(!a)return ya.a.J(508921561,375,10,"ShapeNode is null"),!1;a=new gk.a(a,ad.App.Xn);this.ia.Ia(M.a.Tlb,2,a);return a.ewa}aKl(){const a=new pg.GraphTransaction(4);a.rd(this.vj);this.vj.He(wm.a.R5,!1);this.vj.He(wm.a.d$c,
(new Date).getTime());a.dispose()}Fvj(a,b,c,f){const l=[];if(this.qic)for(const u of this.qic){const I=Object(gb.a)(Lo,u);I&&I.Rh&&I.Rh.token===c.substring(I.begin,I.end)&&I.end>a&&I.end<=b&&f(I)&&Array.add(l,I)}return l}}Object(m.a)(Gp,"PPTProofingDataHandler",Nv,[]);class Gx{constructor(a,b,c,f,l,u,I,T,ja){this.aba=a;this.sNk=b;this.bE=c;this.MK=f;this.dH=I;this.ia=l;this.nc=T;this.Ga=u;this.ka=ja}p5i(a){return new Gp(a,this.aba,this.sNk,this.bE,this.MK,this.ia,this.Ga,this.dH,this.nc,this.ka)}}
Object(m.a)(Gx,"PPTProofingDataHandlerFactory",null,[151]);class iu{constructor(a,b){this.VP=a;this.MMg=b}initialize(){this.VP.execute(a=>{if(this.MMg)for(const b of this.MMg)this.eyl(a,b)})}eyl(a,b){a.registerSimpleRemoteWorkflow(b.xH,b.uwb,b.kPb,b.Ivb)}}Object(m.a)(iu,"ProofingAugLoopRuntimeManager",null,[]);class Ov{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){this.Ga=a;this.Qm=b;this.nc=c;this.zm=f;this.Eb=l;this.Ub=u;this.jh=I;this.sa=T;this.aba=ja;this.bE=ua;this.Qi=eb;this.Uh=
Bb;this.apa=Ub;this.zb=Xb;this.xd=lc;this.P5g=Ec;this.z0a=new La.a;this.jh.jBi(Object(R.a)(this,this.Pqh,"onUndoRevisionStateChanged"));this.KV=Ra.Cd(12);this.KV.Ak(Object(R.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.vN=Ra.Cd(10);this.vN.VE(Object(R.a)(this,this.Fph,"onShapeTopologyChanged"));this.bRk=new ne.a(3,1,0,Object(R.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.hoc=this.w6=!1;this.xd.kU(Object(R.a)(this,this.onActiveSlideDomReady,
"onActiveSlideDomReady"))}dispose(){this.jh.TCl(Object(R.a)(this,this.Pqh,"onUndoRevisionStateChanged"));this.KV.tn(Object(R.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.vN.RN(Object(R.a)(this,this.Fph,"onShapeTopologyChanged"));this.xd.wqa(Object(R.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}Axc(a,b){this.Ga.lH(a,c=>{this.MMh(c,b)})}NMh(a,b){this.Qm.Btc(a,c=>{this.MMh(c,b)})}Gjm(a,b){b?this.Ga.lH(a,c=>{c&&this.bE.L4d(c)}):this.Ga.lH(a,c=>{c&&(c.k3b=
!0)})}$_h(a){if(a&&a.isConnected&&!a.Mq){var b=this.Eb.xe(4);try{let c=!1;const f=this.Ub.Pc(a);b.mc(f);const l=this.zm.eua(a);for(;l.moveNext();){const u=l.currentNode;this.LYl(u)&&(c=!0,u.Npd(),u.Utc=!0)}c&&this.ogh(a)}finally{b&&b.dispose()}this.Qi.forceOutbound()}}yem(a){if(this.kwa(a)&&a.k3b)if(this.hoc&&!this.z0a.contains(a))this.z0a.add(a);else{var b=this.Eb.xe(4);try{b.mc(a),a.Npd(),a.Utc=!0,this.gWk(a)}finally{b&&b.dispose()}a.k3b=!1}}Msd(a){this.kwa(a)&&this.Ga.lH(a,b=>{this.aba.lT(b)})}Hml(a){this.kwa(a)&&
this.Qm.Btc(a,b=>{this.aba.lT(b)})}xok(a){return this.kwa(a)&&(this.zok(a)||this.yok(a))}ogh(a){a&&a.isConnected&&this.Ga.dIa(a)&&this.WMh(a)}gWk(a){const b=this.Ga.Gn(a);this.ogh(b);this.Qm.I$(a)&&(a=this.Qm.DBb(a))&&a.isConnected&&this.Qm.NHa(a)&&this.WMh(a)}Pqh(a,b){if(b)switch(b.state){case 0:this.hoc=!0;break;case 3:this.hoc=!1,this.w6||(this.zb.Jb(this.bRk),this.w6=!0)}}LYl(a){return this.kwa(a)?a.ra(rb.a.Tya,null)?!0:a.ra(rb.a.$Na,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.hoc&&b&&
b.node&&(12!==b.node.type||this.z0a.contains(b.node)||this.z0a.add(b.node))}Fph(a,b){this.hoc&&b&&b.node&&(10!==b.node.type||this.z0a.contains(b.node)||this.z0a.add(b.node))}resumeProofingAfterUndo(){this.w6=!1;for(const b of this.z0a)if(this.kwa(b))if(this.Ga.dIa(b)){var a=b;a&&(this.Axc(a,!0),this.Msd(a))}else this.Uh.ke(b)&&(a=b)&&(a.k3b=!0,this.aba.lT(a));this.z0a.clear()}MMh(a,b){a&&(a.k3b=b&&a.D2&&0<a.D2.length?!0:!1)}zok(a){if(this.P5g){const b=this.sa.Aa;if(!this.kwa(b))return!1;a=this.Ga.sfa(a);
return this.nc.ug(a)===b}return this.apa.ogk(a)}yok(a){var b=this.sa.Aa;if(!this.kwa(b))return!1;a=this.Qm.DBb(a);b=b.aWa();return this.kwa(a)&&this.kwa(b)&&Ua.a.fR(a.id,b.id)}WMh(a){const b=a.ra(yb.a.Nsd,0);a.setValue(yb.a.Nsd,b+1)}kwa(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.P5g){var a=this.sa.Aa;if(a&&(a=a.yj())&&0<a.length)for(const b of a)this.Ga.wC(b)&&this.Msd(b)}}}Object(m.a)(Ov,"ProofingBehaviorController",null,[152,106]);class Rz extends Xq.a{constructor(a,b,c,f,l,u,I,
T){I=void 0===I?!1:I;T=void 0===T?50:T;super(a,b,c,f,l,void 0===u?!0:u);this.bMk=I;this.R_g=T}OKh(a){a=Array.isArray(a)?a:null;if(!rd.a.Ta(a))if(a.length<=this.R_g)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.R_g&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&ya.a.J(37325012,375,this.bMk?15:50,"{0}",Xk.c(a))}}Object(m.a)(Rz,"DashboardAggregator",Xq.a,[]);class nq{constructor(a){this.$aa=new Rz(new Hc.a(()=>A.AFrameworkApplication.Be),
A.AFrameworkApplication.Jia,15,a.pptProofingDashboardTraceIntervalInMinutes,new Rs,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.$aa.track(a,"")}e$d(a){let b=null;try{b=Fe.a(a)}catch(c){ya.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(m.a)(nq,"ProofingDashboardAggregator",null,[149]);class Hx{track(){}e$d(){return null}}Object(m.a)(Hx,"ProofingDashboardNonOperationAggregator",null,[149]);var Ix=d(447),ju=d(446);
class Pv{constructor(a){this.WQk=a}Py(a,b,c){this.WQk(b,c);return!0}}Object(m.a)(Pv,"NonOpProofingALRequestManager",null,[1301]);class Qv{constructor(a,b,c){this.o2=this.J1=null;this.Ajb=a;this.Mic=b.pptEditorConsistencyCheckIsEnabled;this.dLe=b.pptProofingLogWorkflowExceptionEnabled;this.$aa=c;this.aNe=new Pv(Object(R.a)(this,this.p4e,"requestAL"))}get xH(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get uwb(){this.J1||(this.J1=Object.assign(new ju.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",
inputSchema:Ix.a.ezc,outputSchema:Fp.a.YXf,func:Object(R.a)(this,this.wfb,"lambdaBeforeFunc")}));return this.J1}get Ivb(){return null}get kPb(){this.o2||(this.o2=Object.assign(new ju.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:Fp.a.YXf,outputSchema:Fp.a.cSc,func:null}));return this.o2}p4e(a,b){b(a)}wfb(a,b,c){try{ya.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.xH);const T=Object.assign(new ip,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Ws,{wn:Om.bDd})});this.$aa.track(Object.assign(new ip,
{w:Object.assign(new Ws,{wn:Om.bDd}),p:Om.OHg}));let ja=String.format("LambdaBeforeStart:{0}",T.d[Gl.fze].toString());if(a){T.w.i=a.Id;try{var f=Fe.a(a.Content)}catch(ua){ya.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady,u=!1,I=(()=>{let ua=this.Ajb.h3l(f);({VHa:u}=ua);return ua})().returnValue;I?u&&(!this.Mic||this.Mic&&l)?(c(null),this.$aa.track(Object.assign(new ip,{w:Object.assign(new Ws,{wn:Om.bDd}),p:Om.NHg})),ya.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",
this.xH,a.Id,u,l)):(T.d[Gl.R9c]=(new Date).getTime(),T.p=Om.Uuk,ja=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,ja,T.d[Gl.R9c].toString()),this.$aa.track(T),ya.a.J(36783312,375,50,ja),this.aNe.Py(f.id,I,c)):(c(null),ya.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.xH,a.Id))}else c(null)}else c(null),ya.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.xH)}catch(T){a="CloudAL LambdaBefore Exception",this.dLe&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",
T.message,T.stack)),ya.a.J(37835201,375,10,a),c(null)}}}Object(m.a)(Qv,"ProofingTileCheckCloudALWorkflow",null,[1175,1248]);class Jx{}Object(m.a)(Jx,"AugEditorServiceTileCheckRequest",null,[]);class Rv{constructor(){this.contextId=this.S9c=null}}Object(m.a)(Rv,"RequestStateObject",null,[]);class ku{constructor(a,b,c,f){this.XQk=0;this.o2=this.J1=null;this.Ajb=a;this.tV=b;this.Mic=c.pptEditorConsistencyCheckIsEnabled;this.dLe=c.pptProofingLogWorkflowExceptionEnabled;this.$aa=f;this.aNe=new Pv(Object(R.a)(this,
this.p4e,"requestAL"))}get xH(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get uwb(){this.J1||(this.J1=Object.assign(new ju.a,
{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:Ix.a.ezc,outputSchema:Fp.a.nQf,func:Object(R.a)(this,this.wfb,"lambdaBeforeFunc")}));return this.J1}get Ivb(){return null}get kPb(){this.o2||(this.o2=Object.assign(new ju.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:Fp.a.nQf,outputSchema:Fp.a.t1d,func:Object(R.a)(this,this.gze,"lambdaRemoteFunc")}));return this.o2}p4e(a,b){if(b){var c=this.$aa.e$d(a.DashboardTelemetry);c&&(c.d[Gl.z5h]=(new Date).getTime());var f=String.format("{0}, LambdaRemoteStart:{1}",
a.Telemetry,(new Date).getTime());this.tV.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.dwc(a.Topic,a.Data,a.ContextId,u=>{this.$Ma(u,f,c)},u=>{this.YMa(u,f)},Object.assign(new Rv,{contextId:a.ContextId,S9c:b}))})}}wfb(a,b,c){try{ya.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.xH);const T=Object.assign(new ip,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Ws,{wn:Om.G$l})});let ja=String.format("LambdaBeforeStart:{0}",T.d[Gl.fze].toString());
this.$aa.track(Object.assign(new ip,{w:T.w,p:Om.OHg}));if(a){try{var f=Fe.a(a.Content)}catch(ua){c(null);ya.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady,u=!1,I=(()=>{let ua=this.Ajb.i3l(f,++this.XQk);({VHa:u}=ua);return ua})().returnValue;I?u&&(!this.Mic||this.Mic&&l)?(c(null),this.$aa.track(Object.assign(new ip,{w:T.w,p:Om.NHg})),ya.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.xH,a.Id,u,l)):(T.d[Gl.R9c]=
(new Date).getTime(),ja=String.format("{0}, LambdaBeforeDone:{1}",ja,T.d[Gl.R9c].toString()),c(Object.assign(new Jx,{Topic:Fp.a.yfj,Data:Fe.c(I),ContextId:f.id,Telemetry:ja,DashboardTelemetry:Xk.c(T)})),ya.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.xH,a.Id)):(c(null),ya.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.xH,a.Id))}else c(null)}else c(null),ya.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.xH)}catch(T){a="WACAL LambdaBefore Exception",this.dLe&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
T.message,T.stack)),ya.a.J(37835210,375,10,a),c(null)}}gze(a,b,c){ya.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.xH);a?this.aNe.Py(a.ContextId,a,c):(c(null),ya.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.xH))}$Ma(a,b,c){if(!A.AFrameworkApplication.Dh&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var u=Fe.a(a.data.Ud)}catch(I){l.S9c(null);ya.a.J(36525527,375,10,"Try parse aug response failed:{0}",I.message);return}u&&(u.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[Gl.A5h]=f,u.DashboardTelemetry=Xk.c(c)));l.S9c(u);ya.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.xH)}}}YMa(a,b){!A.AFrameworkApplication.Dh&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),ya.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Ud,b),(a=a.data.state)&&a.S9c(null))}}Object(m.a)(ku,"ProofingTileCheckWacALWorkflow",null,[1175,1248]);class Kx{constructor(){this.groupType=
0}}Object(m.a)(Kx,"AnalyzerData",null,[]);class gt{constructor(){this.nodes=this.metadata=null}}Object(m.a)(gt,"TopologyNode",null,[]);class Lx{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(m.a)(Lx,"Content",null,[]);class Sv{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(m.a)(Sv,"CritiqueTypeOption",null,[]);class Sz{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(m.a)(Sz,"Descriptors",null,[]);class Mx{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(m.a)(Mx,"EditorServiceTileCheckRequest",null,[]);class Nx{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(m.a)(Nx,"ListMetadata",null,[]);var lu;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(lu||
(lu={}));Object(m.b)("ListNumeration",lu);var Tv;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(Tv||(Tv={}));Object(m.b)("ListType",Tv);class Tz{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(m.a)(Tz,"ProofingRequest",null,[]);class yr{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(m.a)(yr,"TopologyNode",null,[]);class Uv{constructor(){this.nodes=null}}Object(m.a)(Uv,"ReadingOrderTopology",null,[]);class Xi{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(m.a)(Xi,"Span",null,[]);class Uz{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(m.a)(Uz,"TextTile",null,[]);class Vz{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(m.a)(Vz,"TextTileElement",null,[]);class ar{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(m.a)(ar,"TextTileElementSpan",null,[]);class ht{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(m.a)(ht,"TileContext",null,[]);class Ox{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(m.a)(Ox,"TileElement",null,[]);class zr{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(m.a)(zr,"TileMetadata",null,[]);class it{constructor(a,b,c,f,l,u){this.S9g=a;this.Ibd=b;this.R9g=c;this.dH=f;this.Ba=l;this.Wb=u;this.$bd=null}get SFg(){return A.AFrameworkApplication.fa.getBooleanAppSetting("IsSubscriptionForProofingUser")&&this.dH.vXa}get descriptors(){this.$bd||(this.$bd=this.wzj(),ya.a.J(37090579,375,50,"Descriptors: {0}",Fe.c(this.$bd)));return this.$bd}i3l(a,b){let c;c=!0;var f=Ea.a.Oe(A.AFrameworkApplication.lcid);if(!f)return{returnValue:null,
VHa:c};var l=new yr,u=new yr;b=Object.assign(new Mx,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:A.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.Ibd.Mge()});this.Ba.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=kh.a.b7b(A.AFrameworkApplication.fa.Ea("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.Wb.Hi(),l.AreChildrenOrdered=!1,u.Id=
a.id,u.Type=3,u.AnalyzerData=null,u.Children=[],u.NumberOfChildren=null,u.AreChildrenOrdered=!0,Array.add(l.Children,u));for(var I of a.drawingElems)if(this.Ba.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(u.Children,this.Fbm(I)),I.text&&I.text.paragraphs)for(const ja of I.text.paragraphs){if(null===ja.chars||!ja.cfRuns||!ja.cfRuns.length)continue;a=new Lx;a.TileId=ja.id;a.TileElements=[];l=new Ox;l.Text=ja.chars;l.TextUnit=8;if(ja.pfRuns&&ja.pfRuns.length&&ja.pfRuns[0].pf){f=ja.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ba.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var T=Tv[this.uge(f.listType)];1===f.listType?(l.AnalyzerData.ListType=T,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=T,l.AnalyzerData.ListNumeration=lu[this.lhg(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;T=0;const ua=[];let Ra=null;for(const eb of ja.cfRuns)if(eb)if(f=Ea.a.Oe(eb.cf.lang)){this.R9g.Vrd(eb.cf.lang);f=Object.assign(new Xi,{Start:T,Length:eb.len,LanguageId:f.name,DoNotCheck:eb.cf.noProof});Ra||(Ra=f.LanguageId);if(Ra!==f.LanguageId||eb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?ua.push(f):(f.Length||f.Start!==l.Text.length)&&ya.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
T+=eb.len}else T+=eb.len;!l.IsClean&&0<ua.length&&(l.Spans=Array.clone(ua));l.LanguageId=Ra;Aa.a.Ta(l.LanguageId)?ya.a.J(38385410,375,15,"Empty LanguageId, span length {0}",ua.length):(a.TileElements.push(l),b.Content.push(a))}for(u=b.Content.length-1;0<=u;u--)I=b.Content[u],I.TileElements.length&&null!==I.TileElements[0].Text||(ya.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",I.TileId),Array.removeAt(b.Content,u));b.Content.length||ya.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
VHa:c}}Fbm(a){const b=Object.assign(new yr,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new yr,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}h3l(a){let b;b=!0;var c=Ea.a.Oe(A.AFrameworkApplication.lcid);if(!c)return{returnValue:null,VHa:b};var f={};c=Object.assign(new Tz,{descriptors:this.zwj(this.descriptors),
languageUxId:c.name,documentSessionId:A.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.ywj(this.Ibd.Mge()),tileContextDictionary:f,documentId:kh.a.b7b(A.AFrameworkApplication.fa.Ea("ServerDocId")).toString(),readingOrderTopology:Object.assign(new Uv,{nodes:[]})});const l=this.iwi(a,c.readingOrderTopology,f);for(var u of a.drawingElems)if(u.text&&u.text.paragraphs){a=this.wui(u,l,f);for(const I of u.text.paragraphs)({VHa:b}=this.Gwi(c.tiles,I,b)),this.pvi(I,a,f)}for(f=
c.tiles.length-1;0<=f;f--)u=c.tiles[f],u.elements.length&&null!==u.elements[0].text||(ya.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",u.metadata?u.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||ya.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,VHa:b}}wzj(){if(!this.S9g.descriptors)return null;const a=Array.clone(this.S9g.descriptors);for(const b of a)if(this.SFg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.SFg&&Array.add(a,
Object.assign(new vc,{Name:"LicenseType",Value:"Subscription"}));return a}zwj(a){const b=new Sz;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}uge(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}ywj(a){const b=[];for(const c of a)a=Object.assign(new Sv,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}lhg(a){return a+
1}Awj(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Gwi(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,VHa:c};const f=new Uz;f.metadata=new zr;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new Vz;l.text=b.chars;l.textUnit=4;l.listMetadata=new Nx;var u=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){u=b.pfRuns[0].pf;if(this.Ba.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
u.listType){l.listMetadata.listLevel=u.lvl;var I=this.uge(u.listType);1===u.listType?(l.listMetadata.listType=I,l.listMetadata.listTag=u.listTag):0===u.listType&&(l.listMetadata.listType=I,l.listMetadata.listNumeration=this.lhg(u.listNumeration),l.listMetadata.listElementIndex=u.listElementIndex)}else l.listMetadata.indentationLevel=u.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.uge(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
u=!b.pfRuns[0].pf.proofingDirty;c=c&&u}I=0;const T=[];let ja=null;for(const ua of b.cfRuns)if(ua)if(b=Ea.a.Oe(ua.cf.lang)){this.R9g.Vrd(ua.cf.lang);b=Object.assign(new ar,{start:I,length:ua.len,languageId:b.name,doNotProcess:ua.cf.noProof});ja||(ja=b.languageId);if(ja!==b.languageId||ua.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?T.push(b):(b.length||b.start!==l.text.length)&&ya.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);I+=ua.len}else I+=ua.len;!u&&0<T.length&&(l.spans=Array.clone(T));l.languageId=ja;if(Aa.a.Ta(l.languageId))return ya.a.J(38385415,375,15,"Empty LanguageId, span length {0}",T.length),{returnValue:null,VHa:c};f.elements.push(l);a.push(f);return{returnValue:f,VHa:c}}iwi(a,b,c){const f=Object.assign(new gt,{metadata:Object.assign(new zr,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ht,{analyzerData:new Kx,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}wui(a,b,c){const f=Object.assign(new gt,{metadata:Object.assign(new zr,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ht,{analyzerData:Object.assign(new Kx,{groupType:this.Awj(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}pvi(a,b,c){const f=Object.assign(new gt,{metadata:Object.assign(new zr,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ht,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(m.a)(it,
"TileToTileCheckRequestTransformer",null,[1249]);var Wz;(function(a){a[a.High=0]="High";a[a.Medium=1]="Medium";a[a.Low=2]="Low";a[a.Informational=3]="Informational"})(Wz||(Wz={}));var Hp;(function(a){a[a.NotificationOnly=0]="NotificationOnly";a[a.Delete=1]="Delete";a[a.Ignore=2]="Ignore";a[a.IgnoreAll=4]="IgnoreAll";a[a.IgnoreCritiqueType=8]="IgnoreCritiqueType";a[a.AddToDictionary=16]="AddToDictionary";a[a.ShowDetails=32]="ShowDetails"})(Hp||(Hp={}));var jt;(function(a){a[a.None=0]="None";a[a.ChangeOnce=
1]="ChangeOnce";a[a.ChangeAll=2]="ChangeAll";a[a.AutoCorrect=4]="AutoCorrect";a[a.ReadAloud=8]="ReadAloud";a[a.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"})(jt||(jt={}));class Px{VSc(a,b){if(!a)return null;const c=[];for(const f of a)a=Object.assign(new Iq,{CategoryTitle:f.categoryName,ExplanationTitle:f.explanationTitle||"",ExplanationLabel:f.explanationLabel||"",Explanation:f.context||"",TileId:b,BucketId:f.bucketId,Tag:0,Start:f.range.start,Length:f.range.length,Priority:f.priority,TypeId:f.typeId,
AnnotationId:f.id}),f.critiqueActions&&(a.SupportedActions=this.S6d(f.critiqueActions)),f.suggestions&&(a.Suggestions=this.Y6d(f.suggestions)),c.push(a);return c}Y6d(a){if(!a)return null;const b=[];for(const c of a)(a=this.W6d(c))&&b.push(a);return b}W6d(a){if(!a)return null;const b=Object.assign(new Jv,{Description:a.description,Text:a.text,Level:this.R6d()});a.suggestionActions&&(b.Action=this.X6d(a.suggestionActions));return b}R6d(){return 2}X6d(a){let b=0;a&jt.AutoCorrect&&(b|=4);a&jt.ChangeOnce&&
(b|=1);a&jt.ChangeAll&&(b|=2);a&jt.ReadAloud&&(b|=8);return b}S6d(a){let b=0;a&Hp.AddToDictionary&&(b|=16);a&Hp.Delete&&(b|=1);a&Hp.Ignore&&(b|=2);a&Hp.IgnoreAll&&(b|=4);a&Hp.IgnoreCritiqueType&&(b|=8);a&Hp.ShowDetails&&(b|=32);return b}}Object(m.a)(Px,"ALV2ResponseTransformer",null,[1247]);class is{constructor(a){this.Ba=a;this.iGb=new Map}VTj(a,b){!a||1>a.length||(b?this.N$i(a):(a=a.filter(c=>pk.a.getTypeNameFor(c.body)===jp.getTypeName()),!a||1>a.length||this.Hsi(a)))}tuj(a){if(a&&this.iGb.has(a.toString()))return this.iGb.get(a.toString())}N$i(a){for(const b of a){const c=
b.id;this.iGb.forEach(f=>{const l=f.findIndex(u=>u.id===c);-1<l&&f.splice(l,1)})}}Hsi(a){const b=this.Iog(a);b&&(this.iGb.has(b.toString())?this.iGb.get(b.toString()).push(...a):this.iGb.set(b.toString(),a))}$Mj(a){var b=a[a.length-1];if(!b)return ya.a.J(508900097,375,15,"ALV2:getSlideNodeFromParentPath:: Null slide id received"),null;if(this.Ba.G5&&Object(md.a)("ALSlideTileIdNewFormat")){if(0>b.indexOf("#")){ya.a.J(508900096,375,15,"ALV2:getSlideNodeFromParentPath:: Slide Id does not have valid separator");
return}b=b.split("#");a=parseInt(b[0]);b=parseInt(b[1])}else a=parseInt(b.substring(0,3)),b=parseInt(b.substring(3,b.length));return Vh.a.Aq(a,b)}Iog(a){if(a&&!(1>a.length)&&a[0].source)switch(a=a[0],a.source.toLowerCase()){case "proofing-powerpoint":return this.$Mj(a.parentPath)}}}Object(m.a)(is,"AnnotationStore",null,[204]);class to{constructor(){this.dH=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}fc(a){this.K=a;this.TYi();this.UYi();this.K.register(147,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().na(()=>
new Ex(A.AFrameworkApplication.fa.getBooleanAppSetting("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(148,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().na(()=>new Fx(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(149,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().na(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?
new nq(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new Hx);this.K.register(is,"PowerPointWebEditor.Proofing.AnnotationStore.AnnotationStore").as("PowerPointWebEditor.Proofing.AnnotationStore.IAnnotationStore").ma().na(()=>new is(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Lv,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().na(()=>new Lv(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"),this.K.resolve("PowerPointWebEditor.Proofing.IALV2ResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.AnnotationStore.IAnnotationStore"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.Ha("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier")));this.K.register(150,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().na(()=>new Cx(this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("Box4.Graph.IGraphInstance").Cd(22),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(it,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().na(()=>new it(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(eu,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().na(()=>new eu);this.K.register(Px,"PowerPointWebEditor.Proofing.ALV2ResponseTransformer").as("PowerPointWebEditor.Proofing.IALV2ResponseTransformer").ma().na(()=>new Px);this.K.register(ku,
"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new ku(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Qv,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>
new Qv(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(iu,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().na(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("576");this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new iu(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(Pz.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().na(()=>new Pz.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
A.AFrameworkApplication.fa.Ea("PptRoamingServiceGetActionName"),A.AFrameworkApplication.fa.Ea("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.Ue(()=>{this.dH=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.dH.vXa=a.getBooleanAppSetting("810");this.dH.xDb=a.getBooleanAppSetting("809");this.dH.aYa=a.getBooleanAppSetting("299");if(this.dH.vXa||this.dH.xDb)this.K.resolve("Box4.Proofing.IProofingDescriptors").Rpe(),
this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.dH.aYa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.dH.xDb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.dH.xDb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose();this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").dispose()}TYi(){this.K.register(151,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().na(()=>new Gx(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}UYi(){this.K.register(152,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().na(()=>new Ov(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),
this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").$nk))}static main(){C.a.instance.Ac(new to)}}Object(m.a)(to,"PPTWebEditorProofingPackage",null,[2,3]);class Qx{constructor(a,b,c,f,l,u,I,T,ja,ua){this.xd=a;this.xd.zOc(Object(R.a)(this,this.Bqh,"onTextEditViewClose"));
this.xd.zvb(Object(R.a)(this,this.Cqh,"onTextEditViewOpen"));this.xd.BAi(Object(R.a)(this,this.wlh,"onBeforeTextEditViewClose"));this.xd.FAi(Object(R.a)(this,this.Dqh,"onTextEditViewUpdate"));this.$Ce=b;this.Qi=l;this.Pt=u;this.MK=c;this.ujb=f;this.kkc=I;this.wjc=T;this.Xjd=ja;this.BF=ua}get eSc(){return this.$Ce.instance}dispose(){this.xd.C3e(Object(R.a)(this,this.Bqh,"onTextEditViewClose"));this.xd.Pvc(Object(R.a)(this,this.Cqh,"onTextEditViewOpen"));this.xd.vCl(Object(R.a)(this,this.wlh,"onBeforeTextEditViewClose"));
this.xd.yCl(Object(R.a)(this,this.Dqh,"onTextEditViewUpdate"))}Dqh(){this.wjc.v_()}Cqh(a,b){a=b.Vx.shapeNode;this.MK.Axc(a,!1);this.MK.Msd(a);this.eSc&&this.eSc.J9k(a)}wlh(a,b){this.kkc.Gbe(b.Vx.Vd)}Bqh(a,b){a=b.Vx;const c=b.Vx.shapeNode,f=!!c&&c.isConnected;b.ewa?this.BF.instance&&((this.BF.instance.REb||this.BF.instance.s1)&&2===this.BF.instance.uE||this.BF.instance.U8c)?ya.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",
this.BF.instance.uE,this.BF.instance.U8c):(f&&c.kzd(),c.vd?(this.MK.$_h(c),this.ujb.Rlh(),this.Pt.adf()):(this.Qi.P$a(c),this.Pt.H4d())):this.Xjd||this.MK.$_h(c);this.MK.Axc(b.Vx.shapeNode,f&&c.a7c);this.eSc&&!a.Mq&&this.eSc.I9k(c)}}Object(m.a)(Qx,"ShapeViewElementTextEditHandler",null,[106]);class Vv{constructor(a){this.Uoc=null;this.ZLk=a;this.reset()}cZh(a,b){a&&this.Uoc.$(a,b)}$Bb(a){let b=0;this.Uoc.Ib(a)&&(b=this.Uoc.ga(a)?1:2);return b}gSe(a){return this.ZLk?1===this.$Bb(a):!1}reset(){const a=
this.Uoc;this.Uoc=new Md.a(!1);return a}}Object(m.a)(Vv,"TextEditingRevisionInfoTracker",null,[1245,1246]);var mu=d(1105),Re=d(593),Xz=d(427),Rx=d(869),nu=d(328);class ou{constructor(){this.typeField=this.startAtField=0}}Object(m.a)(ou,"CT_TextAutonumberBullet",null,[]);class Wv{constructor(){this.charField=null}}Object(m.a)(Wv,"CT_TextCharBullet",null,[]);class Sx{}Object(m.a)(Sx,"CT_TextNoAutofit",null,[]);class pu{}Object(m.a)(pu,"CT_TextNoBullet",null,[]);class Xv{constructor(){this.lnSpcReductionField=
this.fontScaleField=0}}Object(m.a)(Xv,"CT_TextNormalAutofit",null,[]);class qu{constructor(){this.itemField=null}}Object(m.a)(qu,"CT_TextSpacing",null,[]);class Tx{constructor(){this.valField=0}}Object(m.a)(Tx,"CT_TextSpacingPercent",null,[]);class yn{constructor(){this.tField=this.rPrField=null}}Object(m.a)(yn,"CT_WebRegularTextRun",null,[]);class kp{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(m.a)(kp,"CT_WebTextBody",null,[]);class Ux{constructor(){this.lInsField=
this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(m.a)(Ux,"CT_WebTextBodyProperties",null,[]);class Ar{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=
!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=
null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=
this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(m.a)(Ar,"CT_WebTextCharacterProperties",null,[]);class Vx{constructor(){this.pPrField=this.itemsField=this.endParaRPrField=null}}Object(m.a)(Vx,"CT_WebTextParagraph",null,[]);class kt{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=
this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=
this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(m.a)(kt,"CT_WebTextParagraphProperties",null,[]);class Yv{constructor(a,b){this.shapeText=a;this.dVb=b}}Object(m.a)(Yv,"ShapeTextState",
null,[]);class Zv{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(m.a)(Zv,"IncrementalRequestTextOperation",null,[]);class Dk{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}UH(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.UH()}pza(a){return this.contains(a.cp)||a.contains(this.cp)}qHa(a){const b=Math.max(a.cp,this.cp);return new Dk(b,Math.max(0,Math.min(a.UH(),this.UH())-1-b+1))}static copy(a){return new Dk(a.cp,
a.len)}}Object(m.a)(Dk,"TextRange",null,[]);class lp{constructor(a){this.Fr=a}}Object(m.a)(lp,"ChangeState",null,[]);const Wx=(a,b)=>{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new Ar;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,
f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=
b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=
b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},Yz=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new kt;let f=!1;Br(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);Br(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);Br(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);
Br(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);Br(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,f=!0);Br(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);Fe.c(a.defRPrField)!==Fe.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);Fe.c(a.buCharField)!==Fe.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);Fe.c(a.buAutoNumField)!==Fe.c(b.buAutoNumField)&&
(c.buAutoNumField=b.buAutoNumField,f=!0);Fe.c(a.buFontField)!==Fe.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||
a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=
b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=
b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,
c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},Br=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class $v{constructor(){this.To=
this.dKa=null}}Object(m.a)($v,"TextParaRange",null,[]);class lt{constructor(){this.To=this.UKa=null}}Object(m.a)(lt,"TextRunRange",null,[]);class Xx{constructor(a,b,c,f,l,u){this.dha=this.Roa=null;this.S6=this.Kna=0;this.bN=this.d6=null;this.jya=this.GIa=0;this.HIa=c;this.rKa=f;this.Mna=l;this.cba=u;this.$yd(new Dk(0,a.shapeText.length),new Dk(0,b.shapeText.length))}$yd(a,b){this.Roa=a;this.dha=b;for(a=Math.max(0,this.GIa-1);a<this.HIa.length;a++)if(this.HIa[a].To.pza(this.Roa)||this.Roa.UH()<=this.HIa[a].To.cp){this.GIa=
a;break}for(a=Math.max(0,this.jya-1);a<this.rKa.length;a++)if(this.rKa[a].To.pza(this.dha)||this.dha.UH()<=this.rKa[a].To.cp){this.jya=a;break}this.bN=this.d6=null;for(a=Math.max(0,this.Kna-1);a<this.Mna.length;a++)if(this.Mna[a].To.pza(this.Roa)||this.Roa.UH()<=this.Mna[a].To.cp){this.Kna=a;break}for(a=Math.max(0,this.S6-1);a<this.cba.length;a++)if(this.cba[a].To.pza(this.dha)||this.dha.UH()<=this.cba[a].To.cp){this.S6=a;break}}M2f(){return this.GIa>=this.HIa.length?null:Object.assign(new $v,{dKa:this.HIa[this.GIa].dKa,
To:this.HIa[this.GIa].To.qHa(this.Roa)})}N2f(){return this.jya>=this.rKa.length?null:Object.assign(new $v,{dKa:this.rKa[this.jya].dKa,To:this.rKa[this.jya].To.qHa(this.dha)})}O2f(){return this.Rue()&&this.d6?Object.assign(new lt,{UKa:this.Mna[this.Kna].UKa,To:this.d6}):null}P2f(){return this.xec()&&this.bN?Object.assign(new lt,{UKa:this.cba[this.S6].UKa,To:this.bN}):null}Que(){return this.UAg()&&this.wec()}UAg(){return this.GIa>=this.HIa.length?!1:this.HIa[this.GIa].To.pza(this.Roa)}wec(){return this.jya>=
this.rKa.length?!1:this.rKa[this.jya].To.pza(this.dha)}Rue(){return!this.UAg()||this.Kna>=this.Mna.length?!1:this.Mna[this.Kna].To.pza(this.HIa[this.GIa].To)&&this.Mna[this.Kna].To.pza(this.Roa)}xec(){return!this.wec()||this.S6>=this.cba.length?!1:this.cba[this.S6].To.pza(this.rKa[this.jya].To)&&this.cba[this.S6].To.pza(this.dha)}I_h(){this.Que()&&(this.GIa++,this.jya++);return this.Que()}J_h(){this.wec()&&this.jya++;return this.wec()}bem(){if(!this.Rue()||!this.xec())return!1;if(this.d6&&this.bN){this.d6.UH()===
this.Mna[this.Kna].To.UH()&&this.Kna++;this.bN.UH()===this.cba[this.S6].To.UH()&&this.S6++;if(!this.Rue()||!this.xec())return!1;var a=this.Mna[this.Kna].To.qHa(this.Roa);this.d6.cp=Math.max(a.cp,this.d6.UH());this.d6.len=a.UH()-this.d6.cp;a=this.cba[this.S6].To.qHa(this.dha);this.bN.cp=Math.max(a.cp,this.bN.UH());this.bN.len=a.UH()-this.bN.cp}else this.d6=this.Mna[this.Kna].To.qHa(this.Roa),this.bN=this.cba[this.S6].To.qHa(this.dha);a=Math.min(this.d6.len,this.bN.len);this.d6.len=a;this.bN.len=a;
return 0<a}cem(){if(!this.xec())return!1;this.d6||(this.d6=this.Mna[this.Kna].To.qHa(this.Roa));if(this.bN){if(this.bN.UH()===this.cba[this.S6].To.UH()&&(this.S6++,!this.xec()))return!1;const a=this.cba[this.S6].To.qHa(this.dha);this.bN.cp=Math.max(a.cp,this.bN.UH());this.bN.len=a.UH()-this.bN.cp}else this.bN=this.cba[this.S6].To.qHa(this.dha);return 0<this.bN.len}}Object(m.a)(Xx,"TextFormatIterator",null,[]);class Yx{constructor(){this.txt=this.txtrng=null}}Object(m.a)(Yx,"TextModificationData",
null,[]);class mt{constructor(a,b){this.textRange=new Dk(a.cp,a.len);this.text=b}}Object(m.a)(mt,"TextModificationInfo",null,[]);class aw{constructor(){this.len=this.cp=0}}Object(m.a)(aw,"TextRangeData",null,[]);class ru{constructor(){this.charPrp=this.txtrng=null}}Object(m.a)(ru,"WebTextCharFormatChange",null,[]);class bw{constructor(){this.paraPrp=this.txtrng=null}}Object(m.a)(bw,"WebTextParaFormatChange",null,[]);class js{constructor(a,b){this.UMg=this.v_a=this.GIb=this.Aoa=this.JV=-1;this.kMe=
this.KCe=null;this.mZa=new Dk(0,0);this.Wna=new Dk(0,0);this.g2=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.nGb=a;this.Oib=b;const {L5e:c,NWe:f}=this.Spg(a.dVb);1<c.length&&(this.UMg=c[c.length-1].To.UH());const {L5e:l,NWe:u}=this.Spg(b.dVb);this.DP=new Xx(this.nGb,this.Oib,f,u,c,l)}zXi(){this.qXi();this.rXi();this.BXi();const a=[],b=this.HXi();b&&a.push(b);a.push.apply(a,this.xXi());a.push.apply(a,this.wXi());a.push.apply(a,this.yXi());
return a}Spg(a){const b=[],c=[];var f=[];var l=[];let u=0;if(!a.pField)return{L5e:f,NWe:l};for(const I of a.pField)if(a=new $v,a.dKa=I,a.To=new Dk(u,0),f=0,I.itemsField&&I.itemsField.length){for(const T of I.itemsField)T.tField&&T.tField.length&&(l=new lt,l.To=new Dk(u,T.tField.length),l.UKa=T,u+=T.tField.length,f+=T.tField.length,b.push(l));u+=1;a.To.len=f;c.push(a)}return{L5e:b,NWe:c}}qXi(){this.JV=this.emd(!0)}rXi(){this.JV===this.nGb.shapeText.length?this.Aoa=0:(this.Aoa=this.emd(!1),this.JV+
this.Aoa>this.nGb.shapeText.length?this.Aoa=this.nGb.shapeText.length-this.JV:this.JV+this.Aoa>this.Oib.shapeText.length&&(this.Aoa=this.Oib.shapeText.length-this.JV))}BXi(){this.GIb=this.nGb.shapeText.length-this.JV-this.Aoa;this.v_a=this.Oib.shapeText.length-this.JV-this.Aoa}xXi(){const a=[];if(!this.JV)return a;this.DP.$yd(new Dk(0,this.JV),new Dk(0,this.JV));do this.g2=this.g_h(),0!==this.g2.Fr&&a.push(this.VZc(this.g2));while(0!==this.g2.Fr);return a}HXi(){if(!this.GIb&&!this.v_a)return null;
this.mZa=new Dk(this.JV,this.GIb);this.Wna=new Dk(this.JV,this.v_a);this.g2=!this.GIb&&0<this.v_a?new lp(4):0<this.GIb&&!this.v_a?new lp(5):new lp(6);return this.VZc(this.g2)}wXi(){const a=[];if(!this.v_a)return a;const b=new Dk(this.JV-1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.UMg-1);this.DP.$yd(b,new Dk(this.JV,this.v_a));do this.g2=this.udm(),0!==this.g2.Fr&&a.push(this.VZc(this.g2));while(0!==this.g2.Fr);return a}yXi(){const a=[];if(!this.Aoa)return a;this.g2=null;this.DP.$yd(new Dk(this.JV+
this.GIb,this.Aoa),new Dk(this.JV+this.v_a,this.Aoa));do this.g2=this.g_h(),0!==this.g2.Fr&&a.push(this.VZc(this.g2));while(0!==this.g2.Fr);return a}VZc(a){if(!a)return null;const b=new Zv;b.chngTyp=a.Fr;switch(a.Fr){case 3:b.charFrmtChng=Object.assign(new ru,{txtrng:this.Wna,charPrp:this.KCe});break;case 2:b.paraFrmtChng=Object.assign(new bw,{txtrng:this.Wna,paraPrp:this.kMe});break;case 4:b.insChar=js.jef(new mt(this.mZa,this.Oib.shapeText.substring(this.Wna.cp,this.Wna.UH())));break;case 5:b.delChar=
js.jef(new mt(this.mZa,""));break;case 6:b.repChar=js.jef(new mt(this.mZa,this.Oib.shapeText.substring(this.Wna.cp,this.Wna.UH())))}return b}emd(a){const b=this.nGb.shapeText,c=this.Oib.shapeText,f=new Dk(0,b.length),l=new Dk(0,c.length);let u=a?0:b.length-1,I=a?0:c.length-1;for(;f.contains(u)&&l.contains(I)&&b.charAt(u)===c.charAt(I);)u=a?u+1:u-1,I=a?I+1:I-1;return a?u:b.length-u-1}udm(){do{for(;this.DP.cem();){var a=this.DP.O2f(),b=this.DP.P2f();if(a&&b){var c=Wx(a.UKa,b.UKa);this.mZa=Dk.copy(a.To);
this.Wna=Dk.copy(b.To);if(c)return this.KCe=c,new lp(3)}}if(this.DP.wec()&&(a=this.DP.M2f(),b=this.DP.N2f(),a&&b&&(c=Yz(a.dKa,b.dKa),this.mZa=Dk.copy(a.To),this.Wna=Dk.copy(b.To),c)))return this.kMe=c,this.DP.J_h(),new lp(2)}while(this.DP.J_h());return new lp(0)}g_h(){do{for(;this.DP.bem();){var a=this.DP.O2f(),b=this.DP.P2f();if(a&&b){var c=Wx(a.UKa,b.UKa);this.mZa=Dk.copy(a.To);this.Wna=Dk.copy(b.To);if(c)return this.KCe=c,new lp(3)}}if(this.DP.Que()&&(a=this.DP.M2f(),b=this.DP.N2f(),a&&b&&(c=Yz(a.dKa,
b.dKa),this.mZa=Dk.copy(a.To),this.Wna=Dk.copy(b.To),c)))return this.kMe=c,this.DP.I_h(),new lp(2)}while(this.DP.I_h());return new lp(0)}static jef(a){return Object.assign(new Yx,{txt:a.text,txtrng:js.d$l(a.textRange)})}static d$l(a){return Object.assign(new aw,{cp:a.cp,len:a.len})}}Object(m.a)(js,"IncrementalChangeIterator",null,[]);class ks{constructor(){this.rh=this.bh=this.increq=null}}Object(m.a)(ks,"TextLayoutDeltaClientRequestData",null,[]);class Zz{constructor(){this.tb=null;this.h=this.w=
0}}Object(m.a)(Zz,"TextLayoutFullClientRequest",null,[]);class Cr{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(m.a)(Cr,"TextLayoutRequest",null,[]);class su{constructor(a,b,c,f,l,u){this.Gmc=this.Am=null;this.Mjc=!0;this.iKa=-1;this.zOk=(new Date).getTime();this.Lhb=this.Vna=0;this.Cic=-1;this.PCe=5E3;const I=document.createElement("a");I.href=a;I.protocol="http:"===I.protocol?"ws":"wss";this.TKb=I.href;this.t6=b;this.g6b();this.F_g=c;this.P0g=f;this.VNk=l;this.BMe=
u.Z9l;this.Bgd=u.Y9l;this.Y$g=u.V9l;this.Zid=u.U9l;this.Woa=this.Y$g;this.k9e()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.pMb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.P0g&&this.P0g(a)}catch(b){ya.a.J(578828128,824,50,(this.t6?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.F_g){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.Mjc;this.F_g(b)}this.Mjc=
!1}else ya.a.J(592304271,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){ya.a.J(592840414,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){ya.a.J(592840412,820,10,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){ya.a.J(592840410,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.jwc();this.ping();this.VNk()}k9e(){this.Gmc=
()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.Cic),this.Am||(ya.a.J(587522389,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.cAa())):this.Cic=window.setTimeout(()=>{this.Am&&(ya.a.J(587522387,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Am.close(),this.Am=null,window.clearTimeout(this.iKa))},this.PCe)};
window.self.addEventListener("visibilitychange",this.Gmc)}g6b(){this.Am&&this.Am.close();this.Am=new WebSocket(this.TKb,[]);this.Am.onopen=Object(R.a)(this,this.onOpen,"onOpen");this.Am.onerror=Object(R.a)(this,this.onError,"onError");this.Am.onclose=Object(R.a)(this,this.onClose,"onClose");this.Am.onmessage=Object(R.a)(this,this.onMessage,"onMessage")}jwc(){this.Vna=0}Q_d(){0<this.Zid&&(new Date).getTime()-this.Lhb>this.Zid&&(this.jwc(),ya.a.J(587337758,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}Q3d(){return(new Date).getTime()-
this.Lhb>this.Woa&&this.Vna<this.Bgd&&(!this.Am||3===this.Am.readyState||2===this.Am.readyState)}u8e(){this.Lhb=(new Date).getTime();this.Woa=Math.pow(2,this.Vna)*this.Y$g;0<this.Zid&&(this.Woa=Math.min(this.Woa,this.Zid));window.setTimeout(()=>{this.cAa()},this.Woa)}cAa(){this.Q_d();this.Q3d()&&(this.g6b(),this.u8e(),this.Vna++,ya.a.J(588071072,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.Vna===this.Bgd&&ya.a.J(588071070,820,50,(this.t6?"Dark Traffic ":
"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.Am?(ya.a.J(587804674,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",ep[this.Am.readyState]),1===this.Am.readyState?this.Am.send(Fe.c(a)):this.cAa()):ya.a.J(587522383,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.Am?1===this.Am.readyState?this.Am.send("ping"+((new Date).getTime()-this.zOk).toString()):(ya.a.J(588294232,
820,10,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.Am.readyState),this.cAa()):ya.a.J(587522380,820,50,(this.t6?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}pMb(){-1!==this.iKa&&window.clearTimeout(this.iKa);this.iKa=window.setTimeout(()=>{this.ping()},this.BMe)}}Object(m.a)(su,"WebSocketTextLayoutFetcher",null,[1292]);class oq{constructor(a,b,c,f,l,u,I){this.hKb=this.djb=this.hSg=this.gSg=null;this.nextId=1;this.WCe=
-1;this.VCe=0;this.JGe=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");if(!u)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ga=a;this.Uq=b;this.sha=f;this.ka=l;this.WV=-1;u.execute(T=>{this.djb=T});this.ka.a$l&&(this.gSg=new su(this.ka.X9l,!1,Object(R.a)(this,this.BCk,"logOnResponseReceived"),Object(R.a)(this,
this.I$k,"onTextLayoutReceived"),Object(R.a)(this,this.Vlh,"onConnectionOpen"),this.ka),this.ka.Xvh&&(this.hSg=new su(this.ka.W9l,!0,Object(R.a)(this,this.ACk,"logOnDarkTrafficResponseReceived"),null,Object(R.a)(this,this.Vlh,"onConnectionOpen"),this.ka)));this.aha=I}HN(a,b,c){ya.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.WV){window.clearTimeout(this.WV);this.WV=-1;var f=this.Uq.presentation;f?(a=Object(gb.a)(205,f.LD(Vh.a.Aq(a,
b))))?(c=a.ER(c))?c.fqb(!1):ya.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):ya.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):ya.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}zCk(){this.VCe++;-1===this.WCe&&(this.WCe=window.setTimeout(Object(R.a)(this,this.J3k,"onCoauthLogTimer"),3E5))}J3k(){this.WCe=-1;ya.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.VCe);this.VCe=0}sog(a){let b=
"";a.lH(c=>{(c=Object(gb.a)(Vg.AParagraphNode,c))&&(b+=$a.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}AXi(a){try{var b=Object,c=b.assign,f=new ks,l=this.hKb;const ua=[];var u,I=l.dVb.bodyPrField,T=a.dVb.bodyPrField;let Ra=!1;I.anchorField!==T.anchorField&&(Ra=!0);I.bInsField!==T.bInsField&&(Ra=!0);I.tInsField!==T.tInsField&&(Ra=!0);I.lInsField!==T.lInsField&&(Ra=!0);I.rInsField!==T.rInsField&&(Ra=!0);I.horzOverflowField!==T.horzOverflowField&&(Ra=!0);I.vertOverflowField!==T.vertOverflowField&&
(Ra=!0);Fe.c(I.normAutofitField)!==Fe.c(T.normAutofitField)&&(Ra=!0);Fe.c(I.spAutoFitField)!==Fe.c(T.spAutoFitField)&&(Ra=!0);I.rotField!==T.rotField&&(Ra=!0);I.spcFirstLastParaField!==T.spcFirstLastParaField&&(Ra=!0);I.wrapField!==T.wrapField&&(Ra=!0);(u=Ra?T:null)&&ua.push(Object.assign(new Zv,{chngTyp:1,bodyPrChng:u}));const eb=new js(l,a);var ja=ua.concat.apply(ua,eb.zXi());const Bb=c.call(b,f,{increq:ja});ya.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",
Fe.c(Bb).length);return Bb}catch(ua){ya.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",ua.message)}return null}bde(a,b){if(this.ka.LXh&&a)if(b&&ya.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),this.sha.xPi())if(0!==this.sha.LSi(a,this.Ga))a.fqb(!1);else{if(!a.lHb)if(b)a.fqb(this.ka.pTb);else return;if(!a.VA&&a.u$().length&&(a.rOa||4===a.fM))try{const c=this.Yle(a),f=Object.assign(new Cr,
{id:this.nextId.toString(),corr:kh.a.create().toString()});if(this.ka.$9l)if(!this.hKb||b||this.JGe)this.hKb=new Yv(this.sog(a),c),this.JGe=!1;else{const u=this.sog(a),I=new Yv(u,c),T=mu.a.BAb(Fe.c(this.hKb.dVb));f.delta=this.AXi(I);f.delta&&(f.delta.bh=T,f.delta.rh=mu.a.BAb(Fe.c(I.dVb)));if(f.delta&&!f.delta.increq.length)if(this.ka.ief)f.delta=null;else return;if(f.delta&&f.delta.increq.length)for(const ja of f.delta.increq)if(ja.repChar){ja.repChar.txtrng.len===this.hKb.shapeText.length&&(f.delta=
null);break}this.hKb=I}f.delta&&f.delta.increq.length&&!this.ka.ief||(f.full=Object.assign(new Zz,{tb:c,w:a.rOa?a.rOa.Right:a.get_widthPersisted(),h:a.rOa?a.rOa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.WV&&window.clearTimeout(this.WV);this.WV=window.setTimeout(()=>{this.HN(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.ka.b$l);f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.WV;f.h.reqHash=
mu.a.BAb(Fe.c(c));f.h.reqSz=Fe.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.ka.ief;const l=a.yPj();b&&l&&(f.h.initialTextLayout=l.toString());this.gSg.fetch(f);this.ka.Xvh&&this.hSg.fetch(f)}catch(c){ya.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.zCk(),a.fqb(!1)}w_f(a,b){switch(a.listType){case 16:b.buNoneField=new pu;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new ou,
{startAtField:a.EB});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new Wv,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new un,b.buFontField.typefaceField=a.font}}dWa(a){const b=new Tx;b.__type=oq.Dwk;b.valField=Math.floor(1E5*a);return b}g0i(a){const b=new kt;var c=new mb.GraphIterator;c.set(a);c.uc(11);c.Ug(11);a.eg.Aw(c)?this.w_f(a.eg.Aw(c),b):this.w_f(Gf.a.JO(16,0),b);c=a.ra(ib.a.Sm,th.a.leftMargin);const f=a.ra(ib.a.VZ,th.a.rightMargin),l=
a.ra(ib.a.Qn,th.a.indent);b.indentField=Re.a.pEd(l);b.indentFieldSpecified=!0;b.marLField=Re.a.pEd(c);b.marLFieldSpecified=!0;b.marRField=Re.a.pEd(f);b.marRFieldSpecified=!0;b.defTabSzField=Re.a.pEd(a.ra(ib.a.Iyb,oq.OQc));b.defTabSzFieldSpecified=!0;b.lvlField=a.ra(ib.a.listLevel,th.a.dHa);b.lvlFieldSpecified=!0;b.algnField=this.S9l(a.ra(rb.a.tm,1));b.algnFieldSpecified=!0;2===this.aha.dY(a).lineSpacing.unit&&(b.lnSpcField=new qu,b.lnSpcField.itemField=this.dWa(this.aha.dY(a).lineSpacing.value));
2===this.aha.dY(a).Rr.unit&&(b.spcBefField=new qu,b.spcBefField.itemField=this.dWa(this.aha.dY(a).Rr.value));2===this.aha.dY(a).Pr.unit&&(b.spcAftField=new qu,b.spcAftField.itemField=this.dWa(this.aha.dY(a).Pr.value));a=jb.OutlineElementNavigator.qC(a);a.properties.Qa(rb.a.UZ)&&(b.rtlField=a.$h(rb.a.UZ));return b}S9l(a){switch(a){case 2:return 1;case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}Yle(a){try{const b=Object.assign(new kp,{bodyPrField:new Ux,pField:[]});b.bodyPrField.noAutofitField=
a.Hba?new Sx:null;a.Qa(yb.a.F4)&&(b.bodyPrField.normAutofitField=new Xv,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.F4));a.Qa(yb.a.Hta)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new Xv),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.Hta));b.bodyPrField.rotField=Math.floor(a.lef);b.bodyPrField.vertField=a.u3;b.bodyPrField.lInsField=Math.floor(Ad.a.uLb(a.dla));b.bodyPrField.tInsField=Math.floor(Ad.a.uLb(a.fla));b.bodyPrField.rInsField=
Math.floor(Ad.a.uLb(a.ela));b.bodyPrField.bInsField=Math.floor(Ad.a.uLb(a.bla));b.bodyPrField.anchorField=a.pra;b.bodyPrField.wrapField=a.l9c?0:1;this.Ga.lH(a,c=>{if(c=Object(gb.a)(Vg.AParagraphNode,c)){var f=Object.assign(new Vx,{itemsField:[]});f.pPrField=this.g0i(c);for(var l=$a.ParagraphReader.text(c),u=0;u<c.Sa.length;){const T=new yn;T.__type="CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var I=c.Sa.ga(u);const ja=I.cp,ua=u<c.Sa.length-1?c.Sa.ga(u+1).cp:$a.ParagraphReader.textLength(c);
u++;I.formatting?T.rPrField=this.Tpg(I.formatting.cache):(I=Xz.c(c.Sa,I.cp).$9c,T.rPrField=I?this.Tpg(I.cache):this.BPj(a));T.tField=Aa.a.substring(l,ja,ua);f.itemsField.push(T)}b.pField.push(f)}});return b}catch(b){throw ya.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");}}Tpg(a){const b=new Ar;b.bField=a.isBold;b.bFieldSpecified=a.LWa;b.iField=a.isItalic;b.iFieldSpecified=a.wdb;b.uField=a.VD;b.uFieldSpecified=a.xCb;
b.strikeFieldSpecified=a.wCb;b.strikeField=a.zC;b.szField=a.fontSize*dk.a.ltc*dk.a.Fdb;b.szFieldSpecified=a.Iva;b.baselineFieldSpecified=a.Qa(yb.a.zO);b.baselineField=a.$a(yb.a.zO);b.capFieldSpecified=a.MWa;b.capField=a.capitalization;if(a.rug){const c=Ea.a.Oe(a.language);b.langField=c?c.pAb:"en-US"}a.Qa(yb.a.latinFont)&&(b.latinField=Object.assign(new un,{typefaceField:a.$a(yb.a.latinFont)}));a.Qa(yb.a.eastAsianFont)&&(b.eaField=Object.assign(new un,{typefaceField:a.$a(yb.a.eastAsianFont)}));a.y5&&
(b.rawSolidFillField=Object.assign(new nu.a,{srgbClrField:Object.assign(new Rx.a,{valField:Vb.a.wwb(a.fontColor)})}));a.RWa&&(b.highlightField=Object.assign(new lo.a,{srgbClrField:Object.assign(new Rx.a,{valField:Vb.a.wwb(a.highlight)})}));a.Qa(yb.a.rxb)&&(b.spcField=a.$a(yb.a.rxb),b.spcFieldSpecified=!0);a.Qa(yb.a.mFb)&&(b.kernField=a.$a(yb.a.mFb),b.kernFieldSpecified=!0);return b}BPj(a){const b=new Ar;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.VD;
b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.zC;b.szField=a.Aca*dk.a.ltc;b.szFieldSpecified=!!b.szField;const c=Ea.a.Oe(a.VVa());b.langField=c?c.pAb:"en-US";a.Qa(yb.a.latinFont)&&(b.latinField=Object.assign(new un,{typefaceField:a.$a(yb.a.latinFont)}));a.Qa(yb.a.eastAsianFont)&&(b.eaField=Object.assign(new un,{typefaceField:a.$a(yb.a.eastAsianFont)}));b.baselineField=a.zO;b.baselineFieldSpecified=!0;return b}BCk(a){if(a){ya.a.J(512493790,820,50,Xk.c(a));var b=new Map;for(const l in a){var c=
l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}eg.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else ya.a.J(512493791,820,50,"response data null")}ACk(a){a?ya.a.J(512493788,820,50,"Dark Traffic"+Xk.c(a)):ya.a.J(512493789,820,50,"Dark Traffic response data null")}Vlh(){this.JGe=!0}Zhg(a){var b=this.Uq.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.Upb(a,"cid"),f=this.Upb(a,"sid");a=this.Upb(a,"shapeId");
if(!c||!f||!a)return ya.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(gb.a)(205,b.LD(Vh.a.Aq(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.ER(Number.parseInvariant(a)):(ya.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}I$k(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&a.h)ya.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.Zhg(a.h))?this.bde(a,!0):ya.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");
else{if(ya.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?eg.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new Fl.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),eg.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new Fl.a,{extendedProperties:b})))}}else if(this.ka.pTb){b=
this.Upb(a.h,"timeoutId");var c=this.Upb(a.h,"firstRequest");if(b&&-1!==this.WV&&this.WV===Number.parseInvariant(b))window.clearTimeout(this.WV),this.WV=-1;else if(!c||!Boolean.parse(c))return;if(b=this.Zhg(a.h)){var f=this.Upb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),eg.Health.instance.recordKpiFailure("TextLayoutServiceResponse",
"ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new Fl.a,{extendedProperties:c})),ya.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.fqb(!1)):b.fqb(!0):(f=this.Upb(a.h,"reqHash"))?(c=this.Yle(b),mu.a.BAb(Fe.c(c))!==f?ya.a.J(512493779,820,50,"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.djb&&this.djb.XRl(f,a.l,b),b.sFd(a.l))):ya.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else ya.a.J(512493782,
820,50,"OnTextLayoutReceived - IShapeNode is null")}}Upb(a,b){return b in a?a[b].toString():null}}oq.Dwk="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";oq.OQc=1440;Object(m.a)(oq,"TextLayoutManager",null,[154]);var nt;(function(a){a[a.noWall=0]="noWall";a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(nt||(nt={}));Object(m.b)("TextLayoutWall",nt);var Zx=d(643);class $x{constructor(a,
b){this.fLe=new Md.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.gZa=a;this.sha=b.OXh}zgc(a){switch(a){case 1:return!!this.sha.COAUTH;case 2:return!!this.sha.LINEBREAKBLOBS;case 3:return!!this.sha.TABLE;case 4:return!!this.sha.SMARTART;case 5:return!!this.sha.NONRECTSHAPE}return!1}xPi(){return!this.zgc(1)||this.gZa.iGa}$Si(a,b){return a?this.zgc(2)&&Zx.a.Rag(a,b)?2:this.zgc(3)&&a.vd?3:this.zgc(4)&&a.ig?4:this.zgc(5)&&4!==a.fM?5:0:0}LSi(a,
b){b=this.$Si(a,b);if(!this.fLe.Ib(a.MOa)||this.fLe.ga(a.MOa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.MOa.toString());c.set("IsShapeWalled",nt[b]);eg.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",nt[b]),eg.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new Fl.a,{extendedProperties:c})))}this.fLe.$(a.MOa,b);return b}}Object(m.a)($x,
"TextLayoutServiceWalls",null,[153]);class cw{constructor(a,b,c,f){this.Qt=a;this.gf=b.Na;this.KP=c;this.Hed=f}initialize(){this.Qt.vSa(Object(R.a)(this,this.QMf,"adjustShapeViews"))}dispose(){this.Qt.uPb(Object(R.a)(this,this.QMf,"adjustShapeViews"))}QMf(a,b){if((a=b.sH)&&a.gd&&(a=a.gd.X0(c=>c.isEditable&&c.VR))&&a.length)for(const c of a)if(a=Object(gb.a)(178,c.vg(this.gf)))a.P3h(),c.vd&&a.Oo&&a.mkm(),!this.Hed||this.KP&&!b.Y8c||a.qK||!a.wC||a.ZVh()}}Object(m.a)(cw,"TextLocalRenderAdjustManager",
null,[106]);class dw{constructor(){this.Yoc=this.qJb=null;this.nOg=-1;this.Qic=Date.now()}Ttg(){return 0<=this.nOg}}Object(m.a)(dw,"LineBreakComparison",null,[]);class tu{constructor(a){this.AI=new Md.a;this.OZg=0;this.ZSf="TextLayoutServiceAccuracy";this.Goc=a}WRl(a,b){try{if(a&&b){var c=a.aA(),f=mu.a.BAb(Fe.c(b.Yle(a)));if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const u=yl.a.Fi(c[l],yb.a.oTb,null);u&&(b.push.apply(b,u.Lines),b.push(-1))}if(b.length){if(!this.AI.Ib(f))this.AI.add(f,new dw);
else if(this.AI.ga(f).Ttg())return;this.AI.ga(f).qJb=b;this.cZf(f,a)}}}}catch(l){ya.a.J(512493704,820,10,l.message)}}XRl(a,b,c){try{if(!this.AI.Ib(a))this.AI.add(a,new dw);else if(this.AI.ga(a).Ttg())return;this.AI.ga(a).Yoc=b;this.cZf(a,c)}catch(f){ya.a.J(512493703,820,10,f.message)}}cZf(a,b){if(this.AI.ga(a)&&this.AI.ga(a).qJb&&this.AI.ga(a).Yoc){var c=!0;if(this.AI.ga(a).qJb.length!==this.AI.ga(a).Yoc.length)c=!1;else for(var f=0;f<this.AI.ga(a).qJb.length;f++)if(this.AI.ga(a).qJb[f]!==this.AI.ga(a).Yoc[f]){c=
!1;break}ya.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.u$().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());eg.Health.instance.recordKpiUsage(this.ZSf,0,"pptotext",f);c||(f.set("UnifiedResponseLineCount",this.AI.ga(a).qJb.length.toString()),f.set("TextLayoutResponseLineCount",this.AI.ga(a).Yoc.length.toString()),eg.Health.instance.recordKpiFailure(this.ZSf,
"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new Fl.a,{extendedProperties:f})));this.AI.ga(a).nOg=Date.now()}this.nTi()}nTi(){const a=Date.now();a-this.OZg<this.Goc||(this.AI.keys.forEach(b=>{a-this.AI.get(b).Qic>this.Goc&&this.AI.remove(b);return!0}),this.OZg=a)}}Object(m.a)(tu,"ServiceComparisonLineBreakTelemetry",null,[155]);const ew=[G.a.Vye,G.a.Tye,G.a.Xye,G.a.Uye,G.a.Yye,G.a.Wye,G.a.Sye,G.a.Kgc,G.a.Jgc,G.a.Lgc,G.a.Hgc,G.a.Ggc,G.a.Igc,G.a.Egc,G.a.Dgc,G.a.Fgc,G.a.pia,
G.a.ega,G.a.rea,G.a.Yua,G.a.bold,G.a.Jr,G.a.fT,G.a.uea,G.a.setItalic,G.a.$q,G.a.rH,G.a.OG,G.a.strikethrough,G.a.underline,G.a.My,G.a.lC,G.a.subscript,G.a.superscript,G.a.font,G.a.j_,G.a.B3a,G.a.C3a,G.a.Xnb,G.a.Ynb,G.a.Znb,G.a.Z7j,G.a.bxg,G.a.qL,G.a.aO,G.a.Rqa,G.a.hfa,G.a.insertHyperlink,G.a.eL,G.a.cut,G.a.paste,G.a.O2,G.a.undo,G.a.redo];class ay{constructor(a,b,c){this.Z3k=()=>{this.Wbf(null)};this.gb=a;this.yb=c;this.Uxl(b)}Uxl(a){a.execute(b=>{this.uDe=b;this.uDe.addHandler(xf.$$a,this.Z3k)})}getName(){return"EditSurface"}JZ(a){2===
a.behavior&&this.tdk(a.actionId)&&this.Wbf(null)}IZ(){}tdk(a){return-1!==ew.indexOf(a)}Wbf(a){a||(a=this.xyj());a&&(a.lKb&&this.KW(a),a.RBc(!1))}y5l(a){a&&a.RBc(!0)}xyj(){if(this.gb&&this.gb.kz()){var a=this.gb.Hd();if(a&&1===a.length&&(a=a[0])&&a.isConnected)return a}}KW(a){a=a.vg(this.yb.Na);null===a||void 0===a?void 0:a.KW(!0)}}Object(m.a)(ay,"EditSurfaceLayoutManager",null,[197]);class ot{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}fc(a){this.K=a;this.K.register(Vv,
"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().na(()=>new Vv(!a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("DataSyncUseFluid")));this.K.register(Qx,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().na(()=>new Qx(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ha("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,a.Ha("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(cw,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().na(()=>new cw(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").hBg));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").LXh;ya.a.J(508699797,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",b);b&&(this.K.register(153,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().na(()=>new $x(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),
this.K.register(154,"PowerPointWebEditor.ITextLayoutManager").ma().na(()=>{try{return new oq(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.AFrameworkApplication.Me,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ha("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return ya.a.J(508699796,820,
10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(155,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().na(()=>new tu(this.K.resolve("PowerPointWebEditor.IApplicationSettings").T9l)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("FixTextFlickeringOnEditStartEnabled")&&this.K.register(ay,
"PowerPointWebEditor.EditSurfaceLayoutManager").ma().na(()=>new ay(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.Ha("Box4.ContentEditableViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"))))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.hBg&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){C.a.instance.Ac(new ot)}}Object(m.a)(ot,"PPTWebEditorTextEditingPackage",null,[2,3]);class Ip{constructor(){this.capabilities=2}}Object(m.a)(Ip,"IExternalPeopleAPI",null,[]);class by{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(m.a)(by,"ExternalGrantAccessResponse",null,[]);class uu{constructor(a,b,c,f){this.authorImageURL=
this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(m.a)(uu,"PersonaIconProperties",null,[]);var fw=d(679),Jq=d(680),$z=d(538);class vu extends Ip{constructor(a,b,c,f,l){super();this.hX=a;this.cli=b;this.Htf=c;this.C$h=l}$rh(a){this.hX.oAa=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.hX.Yzg.continueWith(c=>{c.Ao||c.Pm?(da.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(Jq.a.fu(-2130915318))):
a(this.hX.Yzg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.hX.checkUserAccess([a]);f.continueWith(l=>{l.Ao||l.Pm?(da.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(Jq.a.fu(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){da.ULS.sendTraceTag(37582727,380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.hX.CEa(a);f.continueWith(l=>{if(l.Ao||l.Pm)da.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),
c(Jq.a.fu(-2130915318));else{l=f.result;var u=!l.Canceled;for(var I of l.Result)if(!I.UserCanWrite&&!I.UserCanReview){u=!1;break}I=new by(u,l);b(I)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const u=this.hX.Eva(a,b,0,c,"AtMentions");u.continueWith(I=>{I.Ao||I.Pm?(da.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(Jq.a.fu(-2130915318))):f(u.result)})})}getAuthToken(){da.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,
b)=>{this.Htf.continueWith(c=>{c.Ao||c.Pm?(da.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(Jq.a.fu(-2130915318))):this.Htf.result.VEj().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(da.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),a(f.token)):A.AFrameworkApplication.fa.Ea("LokiUserDataSignature")?(da.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.C$h.execute(l=>{l.luj().then(u=>{void 0!==u&&
null!==u&&0<u.length?(da.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(u)):0<A.AFrameworkApplication.fa.Ea("LokiUserDataSignature").length&&(da.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),a(A.AFrameworkApplication.fa.Ea("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(da.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(Jq.a.fu(-2130915318))):
(da.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(Jq.a.fu(-2130915318)))}).catch(f=>{da.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(Jq.a.fu(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>{const c=[];for(const l of a){let u=null;var f=l;let I=l.Email;I&&""!==I||!l.UserId||""===l.UserId||"AD"!==l.Provider||(I=$z.a.nbb(l.UserId));I&&""!==I&&(u=this.hX.uyb(I,l.Provider,
A.AFrameworkApplication.mh,0),f=new fw.a(I,void 0,l.DisplayName));f=this.cli.Dva(f,2);Array.add(c,new uu(l.DisplayName,l.UserId,f,u))}b(c)})}}Object(m.a)(vu,"ExternalPeopleAPI",Ip,[]);class gw{constructor(){this.j9a={};this.Nrb={};this.kRd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in this.j9a?(b=this.j9a[a.UserId],!c||c in this.Nrb||(this.Nrb[c]=b)):c&&c in this.Nrb&&(b=this.Nrb[c],a.UserId&&(c in this.kRd?(delete this.kRd[c],this.j9a[a.UserId]=b):a.UserId in this.j9a||
(b=null)));return b}add(a,b){a.UserId&&(this.j9a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.Nrb||(this.Nrb[c]=b,a.UserId||(this.kRd[c]=!0))}Dwj(a){a=Array(a.oSc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of Qa.a.AM(this.j9a))b=this.j9a[c],b.sources.contains(1)&&a[b.nYf]++;return a}normalize(a){return a?a.toLowerCase():null}}Object(m.a)(gw,"ColorLookupDict",null,[]);class cy{constructor(a,b){this.nYf=a;this.sources=new La.a;this.sources.add(b)}mwi(a){this.sources.contains(a)||
this.sources.add(a)}}Object(m.a)(cy,"ColorSource",null,[]);class wu{constructor(a){this.kWb=a;this.LXd=new gw;this.Txf=-1;this.L$h=0}Dva(a,b,c){c=void 0===c?!0:c;if(!this.kWb||!this.kWb.oSc.length)return da.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.dsj();else if(!a.UserId&&!a.DisplayName)return da.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.LXd.get(a);if(f)c=
f.nYf,f.mwi(b);else{if(!c)return null;c=this.rGj();this.LXd.add(a,new cy(c,b));this.Txf=c}return this.Kwj(this.kWb.oSc[c])}rGj(){const a=this.kWb.oSc.length,b=this.LXd.Dwj(this.kWb),c=this.Ywg(this.Txf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.Ywg(f,a))||(l=!0);else break;l&&da.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");return f}Ywg(a,b){return(a+1)%b}dsj(){return"anonymous"+ ++this.L$h}Kwj(a){return 16777215>=a?"#"+Aa.a.px((a&255)<<16|a&65280|(a&16711680)>>>
16,6):null}}Object(m.a)(wu,"PeopleColorUtils",null,[409]);class hw{constructor(a,b,c,f,l,u){this.Zzg=new v.a;this.TUe=()=>{const I=this.La.tc("NumberOfContactsToFetchOnBoot",100);0>=I||this.Eva("",I,0,!1,"AtMentions").continueWith(T=>{(T.Pm||T.Ao)&&da.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})};this.Psa=a;this.i9a=b;this.UHf=f;this.La=c;this.s8=l;this.XHf=u;this.La.Ue(()=>{this.Lrj()})}Lrj(){const a=A.AFrameworkApplication.jqb||A.AFrameworkApplication.YR,b=this.La.getBooleanAppSetting("PeopleEndPointIsEnabled");
let c=b&&!a&&(this.Isc||this.RSb&&this.TSb);const f=this.La.getBooleanAppSetting("DisableAtmentionsForTeams"),l=this.La.getBooleanAppSetting("ConsumerMentionsHostIsEnabled")||this.UHf.GVh;c=c&&l&&this.EVh&&this.DVh&&!f;this.La.getBooleanAppSetting("ConsumerMentionsHostIsEnabled")&&(c=c&&this.La.getBooleanAppSetting("OneDriveConsumerMentionsIsEnabled"));da.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",
c,b,this.Isc,this.RSb,this.TSb,this.EVh,a,this.DVh);this.Zzg.Jg(c);c&&this.s8&&this.s8.Ij(4,this.TUe)}get RSb(){return this.i9a.RSb}get w9c(){return this.XHf.w9c}get TSb(){return this.i9a.TSb}get Isc(){return this.i9a.Isc}get EVh(){return this.La.getBooleanAppSetting("SupportsAddActivities")}get DVh(){return this.La.getBooleanAppSetting("SupportsActivitiesNotification")}CEa(a){return this.i9a.CEa(a)}Q6b(a,b){return this.i9a.Q6b(a,b)}get Yzg(){return this.Zzg.task}get oAa(){return this.Psa.oAa}set oAa(a){this.Psa.oAa=
a}checkUserAccess(a){da.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.i9a.checkUserAccess(a)}vWa(a,b,c,f,l){return this.i9a.vWa(a,b,c,f,l)}Eva(a,b,c,f,l){return this.UHf.Eva(a,b,c,f,l)}uyb(a,b,c,f){return this.XHf.uyb(a,b,c,f)}SSb(){const a=new v.a,b=this.Psa.SSb();b.continueWith(()=>{b.Pm||b.Ao?a.Jg(!1):a.Jg(!0)});return a.task}}Object(m.a)(hw,"PeopleManager",null,[408,406]);var Jp=d(386);class iw{}Object(m.a)(iw,"CheckUserAccessRequestItem",null,[]);class dy extends Jp.a{constructor(a,
b,c){super(a,b);this.Users=null;this.Users=this.A7d(c)}A7d(a){const b=[];for(const c of a)Array.add(b,Object.assign(new iw,{Id:c.UserId,Provider:c.Provider}));return b}om(){return 1}}Object(m.a)(dy,"CheckUserAccessRequest",Jp.a,[]);class ey extends Jp.a{constructor(a,b,c,f,l,u,I){super(a,b);this.Filter=null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=u;this.Skip=l;this.Scenario=I}om(){return 2}}Object(m.a)(ey,"GetUserContactsRequest",Jp.a,
[]);class fy extends Jp.a{constructor(a,b,c,f,l,u,I){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.A7d(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=u;this.GrantReviewAccess=I}A7d(a){const b=[];for(const c of a)Array.add(b,Object.assign(new iw,{Id:c.UserId,Provider:c.Provider}));return b}om(){return 4}}Object(m.a)(fy,"GrantUserAccessRequest",Jp.a,[]);class gy extends Jp.a{constructor(a,b){super(a,b)}om(){return 5}}
Object(m.a)(gy,"SupportsExchangeRestApisRequest",Jp.a,[]);var jw=d(537);class xu{constructor(a,b,c,f){this.oAa=null;this.Hmi=a;this.M5a=b;this.La=c;this.W5a=f}get aFl(){return this.La.tc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return da.ULS.sendTraceTag(37757202,380,15,"no user in the request"),a=new v.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;da.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",
a.length);const b=new v.a,c=this.W5a.execute(new dy(this.M5a(),null,a),(f,l,u)=>this.KVc(f,l,u,"CheckUserAccess"),this.oAa);c.continueWith(()=>{if(c.Ao||c.Pm)b.wH(c.Ni);else{var f=this.qel(c.result.Hj);b.Jg(f)}});return b.task}vWa(a,b,c,f,l){if(!a||!a.length)return da.ULS.sendTraceTag(37757204,380,15,"no user in the request"),a=new v.a,a.Jg(null),a.task;da.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const u=new v.a,
I=this.W5a.execute(new fy(this.M5a(),null,a,b,c,f,l),(T,ja,ua)=>this.KVc(T,ja,ua,"GrantUserAccess"),this.oAa);I.continueWith(()=>{if(I.Ao||I.Pm)da.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",I.Ni),u.wH(I.Ni);else{var T=this.Rdl(I.result.Hj);u.Jg(T)}});return u.task}qel(a){if(!a.data)return da.ULS.sendTraceTag(24749450,380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Ud)return da.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),
null;a=jw.a.Pyb(a.data.Ud);return a?a.Result?a.Result:(da.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(da.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}Rdl(a){if(!a.data)return da.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),null;if(!a.data.Ud)return da.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=jw.a.Pyb(a.data.Ud);return a?a.Result?
a.Result:(da.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(da.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}Eva(a,b,c,f,l){const u=new v.a,I=this.W5a.execute(new ey(this.M5a(),null,a,b,c,f,l),(T,ja,ua)=>this.KVc(T,ja,ua,"GetUserContacts"),this.oAa);I.continueWith(()=>{if(I.Ao||I.Pm)u.wH(I.Ni);else{var T=I.result;try{const ja=this.pel(T.Hj);u.Jg(ja.Result)}catch(ja){u.wH(ja)}}});return u.task}pel(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");
if(!a.data.Ud)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=jw.a.Pyb(a.data.Ud);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");return a}SSb(){const a=new v.a,b=this.W5a.execute(new gy(this.M5a(),null),(c,f,l)=>this.KVc(c,f,l,"SupportsExchangeRestApisRequest"),this.oAa);b.continueWith(()=>{b.Ao||b.Pm?(a.wH(b.Ni),da.ULS.sendTraceTag(50657307,380,
50,"SupportsExchangeRestApis: false")):(da.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.sL(!0))});return a.task}KVc(a,b,c,f){return this.Hmi.y9a(a,2,c,b,2,f,null,!1,null,this.aFl)}}Object(m.a)(xu,"PeopleRequestHandler",null,[407]);class pt{constructor(a,b){this.j7l=()=>{this.SSb();return 32};this.OSi=()=>{const c=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(c);return 32};this.YQj=()=>{const c=prompt("Get user contacts:filter;limit;skip;searchGal");
this.Eva(c);return 32};this.QSi=()=>{const c=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.CEa(c);return 32};this.cRj=()=>{const c=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.Aqg(c);return 32};this.hX=a;this.Ca=b;this.Ca.xa(N.a.TSi,Le.a.frame,this.OSi);this.Ca.xa(N.a.ZQj,Le.a.frame,this.YQj);this.Ca.xa(N.a.SSi,Le.a.frame,this.QSi);this.Ca.xa(N.a.dRj,Le.a.frame,this.cRj);this.Ca.xa(N.a.i7l,Le.a.frame,this.j7l)}lIh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.vWa();break;case "3":this.CEa(prompt("CUAGP: u1;u2;u3"));break;case "4":this.Eva(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.Aqg(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.SSb();break;case "7":return}}catch(b){alert(b.message)}wb.Task.delay(5E3).continueWith(()=>{this.lIh()})}GIl(){window.setTimeout(Object(R.a)(this,this.lIh,
"runOperations"),1E4)}SSb(){const a=this.hX.SSb();a.continueWith(b=>{if(b.Pm)alert("Exception: "+b.Ni.message);else{b=a.result;var c=new Ij.StandardDialog;c.Fd=0;c.Te(1,"Close");document.createElement("pre").innerText=b.toString();c.Ky("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}Aqg(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.Jzj(a)}catch(l){alert("Invalid dimension value");return}Tb.a.instance.Ha("Common.App.People.IPeopleManager").execute(l=>{var u=l.uyb(b,
c,A.AFrameworkApplication.mh,f);l=document.createElement("img");l.src=u;u=new Ij.StandardDialog;u.Fd=0;u.Te(1,"Close");u.Ky("Profile photo",null,3,null,l)})}Jzj(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.hX.Q6b(a,"O365");const b=this.hX.checkUserAccess(a);
b.continueWith(c=>{if(c.Pm)alert("Exception: "+c.Ni.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new Ij.StandardDialog;l.Fd=0;l.Te(1,"Close");f=document.createElement("pre");f.innerText=c;l.Ky("Check User Access Results",null,3,null,f)}})}vWa(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.hX.Q6b(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),u=0<=c.toUpperCase().indexOf("REVIEW"),I=this.hX.vWa(a,b,f,l,u);I.continueWith(T=>{if(T.Pm)alert("Exception: "+T.Ni.message);else{T=I.result;var ja="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(u?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const ua of T.Result)ja+="User: "+ua.Id+"\nMessage: "+ua.Message+"\nStatus Code: "+ua.Status+"\nProvider: "+ua.Provider+"\n\n";alert(ja)}})}Eva(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.hX.Eva(a,b,c,f,"AtMentions");l.continueWith(u=>
{if(u.Pm)alert("Something went wrong"+u.Ni.message);else if(u.Ao)alert("Task was canceled");else{var I=l.result;u="";for(var T of I)I="ID => "+T.Id+" \n",I+="Provider => "+T.Provider+" \n",I+="DisplayName => "+T.DisplayName+" \n",I+="GivenName => "+T.GivenName+" \n",I+="Surname => "+T.Surname+" \n",I+="Email => "+T.Email+" \n",I+="Title => "+T.Title+" \n",u+=I+"----------------------\n";T=new Ij.StandardDialog;T.Fd=0;T.Te(1,"Close");I=document.createElement("pre");I.innerText=u;T.Ky("Contacts",null,
3,null,I)}})}CEa(a){a=a.split(";");a=this.hX.Q6b(a,"O365");const b=this.hX.CEa(a);b.continueWith(c=>{if(c.Pm)alert("Exception: "+c.Ni.message);else{c=b.result;var f="";for(var l of c.Result){var u=[];Array.add(u,l.UserCanRead?"Read YES":"Read NO");Array.add(u,l.UserCanReview?"Review YES":"Review NO");Array.add(u,l.UserCanWrite?"Write YES":"Write NO");u=l.Id+"=>"+u.join(" | ");f+=u+"\r\n"}l=new Ij.StandardDialog;l.Fd=0;l.Te(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Ky("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(m.a)(pt,"PeopleTestHook",null,[]);var yu=d(196);class hy{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(m.a)(hy,"ShowSharingUiRequestBody",null,[]);class zu{constructor(a,b){this.H8a=null;this.GKc=new v.a;this.h1b=new hy(this.U4i(),a,b);da.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.h1b.Persons?
this.h1b.Persons.length:0,this.h1b.UserPermissionsVerified)}get JGl(){return this.GKc.task}get id(){return this.h1b.Id}get payload(){return this.h1b}TSl(a){this.H8a=a;this.lnm()?this.GKc.sL(this.H8a):this.GKc.wH(Error.format("Format of the "+le.a.A4d+" body is not valid"))}setException(a){da.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.GKc.wH(a)}U4i(){return zu.Gfi++}mnm(a){if(void 0===a.Id)return da.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return da.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(da.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(da.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):Aa.a.sEb(a.Status)?!0:(da.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}lnm(){if(void 0===this.H8a.Persons)return da.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!rd.a.isArray(this.H8a.Persons))return da.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.H8a.Persons.length;a++)if(!this.mnm(this.H8a.Persons[a]))return!1;return void 0===this.H8a.DialogCanceled?(da.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(da.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):Aa.a.sEb(this.id)?!0:(da.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}zu.Gfi=0;Object(m.a)(zu,"PostmessageRequestState",null,[]);class ls{constructor(a){this.VTd=new yu.a;this.AYb=this.N6a=null;this.jvf=!1;this.RSi=b=>{const c=b.Values;if(c)if(void 0===c.Id||null===c.Id)da.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",c.Id);else{var f=null;(()=>{let l=this.VTd.Eg(c.Id);
({value:f}=l);return l})().returnValue?(da.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",c.Id),f.TSl(c),this.VTd.remove(c.Id)):da.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",c.Id)}else da.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")};this.tQa=a}q8j(){da.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.AYb)return this.AYb.task;this.AYb=new v.a;
this.tQa.continueWith(()=>{da.ULS.sendTraceTag(25036172,380,50,"hostPostMessenger Resolved successfully");this.N6a=this.tQa.result;this.J4c();this.AYb.Jg(!0)});return this.AYb.task}J4c(){this.jvf||(da.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.jvf=!0,this.N6a.Bv(le.a.A4d),this.N6a.dD(le.a.A4d,this.RSi))}PSi(a,b){const c=new zu(a,b);this.q8j().continueWith(()=>{const f=kh.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,f);da.ULS.sendTraceTag(25036179,
380,50,l);this.N6a.sendMessage(le.a.CEa,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.VTd.add(c.id,c)});return c.JGl}}Object(m.a)(ls,"ShowSharingUiPostMessageHandler",null,[]);class kw{}Object(m.a)(kw,"GrantUserAccessResponse",null,[]);var zi=d(83);class iy extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.Jfl=a;this.pOa=c;this.scenario=f}}Object(m.a)(iy,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class ms{static R2i(a){return zi.a.oC(ms.Hq,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}ms.Hq="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(m.a)(ms,"ShareAndNotifyDialogHtml",null,[]);class jy extends zi.a{constructor(a,b,c){super();this.$Pa=!1;this.Ma=new uc.a;this.oWl=f=>{this.Ma.raiseEvent("SNEK",new iy(this.eli,f,this.hx,this.k0))};this.eli=a;this.kri=jy.Nqj(a);this.hx=b;this.k0=c}HAi(a){this.Ma.addHandler("SNEK",a)}qaf(){this.Wg=
ms.R2i(this.kri);this.Fd=8;this.Fg="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,this.oWl);this.M7("ShareAndNotifyDialogTextId")}$ya(){}dispose(){this.$Pa||(super.dispose(),this.$Pa=!0)}static Nqj(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(m.a)(jy,"ShareAndNotifyDialog",zi.a,[]);class aA{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(m.a)(aA,"ShowSharingUiRequestPerson",null,[]);class Au{constructor(a,b,c,f,l,u){this.MSi=I=>{da.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(I=I.gu)?I.Ao?da.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):I.Pm?da.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):I.isCompleted||da.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):da.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")};
this.X9k=(I,T)=>{let ja;const ua=Au.m0i(T.Jfl);switch(T.result){case 1:this.vWa(ua,T.scenario,!0,!0,!0).continueWith(Ra=>{Ra.Pm?(da.ULS.sendTraceTag(36300674,380,15,"GrantUserAccess from OnShareAndNotify failed with exception. {0}",Ra.Ni?Ra.Ni.message:"No inner exception"),T.pOa.wH(Ra.Ni)):(da.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),ja=this.oX.PTa(ua),ja.Canceled=!1,T.pOa.Jg(ja))});break;default:da.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),
ja=this.oX.PTa(ua),ja.Canceled=!0,T.pOa.Jg(ja)}};this.Psa=a;this.La=b;this.voi=c;this.oX=f;this.Hai=l;this.je=u}get RSb(){return this.La.getBooleanAppSetting("SupportsCheckUserAccess")}get TSb(){return this.La.getBooleanAppSetting("SupportsGrantUserAccess")}get Isc(){return this.La.getBooleanAppSetting("PermissionsPostMessage")&&!this.La.getBooleanAppSetting("CrossDocumentMessengerDisabled")&&this.Hai()}CEa(a){const b=new v.a;if(rd.a.Ta(a))return b.Jg(this.oX.PTa([])),b.task;let c;const f=(()=>{let u=
this.oX.Fif(a);({K4b:c}=u);return u})().returnValue,l=Au.h0i(f);0<f.length?this.Isc?this.z0l(f,b,c,l):this.RSb&&this.TSb&&this.qaf(l,b,"mention"):b.Jg(this.oX.PTa(a));return b.task}z0l(a,b,c,f){const l=Date.now();da.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const u=this.voi.PSi(f,c);c=new ne.a(4,1,this.La.tc("GrantPermissionSharingDialogWatchdogInternal",12E4),this.MSi,100);this.je.Jb(c);c.gu=u;u.continueWith(I=>{if(I.Pm)da.ULS.sendTraceTag(36300673,380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",
I.Ni?I.Ni.message:"No inner exception"),b.wH(I.Ni);else{I=u.result;this.oX.ghm(I);var T=this.oX.PTa(a);T.Canceled=I.DialogCanceled;b.Jg(T);da.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}qaf(a,b,c){a=new jy(a,b,c);a.HAi(this.X9k);a.qaf()}checkUserAccess(a){const b=new v.a;if(!this.RSb)return da.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),
b.task;if(!a||!a.length)return b.Jg(this.oX.PTa([])),b.task;let c;const f=(()=>{let l=this.oX.Fif(a);({K4b:c}=l);return l})().returnValue;if(c)da.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Jg(this.oX.PTa(a));else{const l=this.Psa.checkUserAccess(f);l.continueWith(()=>{if(l.Ao||l.Pm)da.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));else{da.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");
var u=l.result;u&&this.oX.ehm(u);u=this.oX.PTa(a);b.Jg(u)}})}return b.task}vWa(a,b,c,f,l){const u=new v.a;if(!this.TSb)return da.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),u.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),u.task;if(!a||!a.length)return u.Jg(this.oX.Y0f([])),u.task;let I;const T=(()=>{let ja=this.oX.Fif(a);({K4b:I}=ja);return ja})().returnValue;if(I)da.ULS.sendTraceTag(36300684,
380,50,"GrantUserAccess response populated from cache."),u.Jg(this.oX.Y0f(a));else{const ja=this.Psa.vWa(T,b,c,f,l);ja.continueWith(()=>{if(ja.Ao||ja.Pm)da.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),u.setException(Error.create("GrantUserAccess Call failed."));else{da.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var ua=ja.result;this.oX.fhm(ua,c,f,l);ua=Object.assign(new kw,{Result:ua});u.Jg(ua)}})}return u.task}Q6b(a,b){const c=[];for(const f of a)c.push(new fw.a(f,
b));return c}static h0i(a){const b=[];for(const c of a)a=new aA(c.UserId,c.Provider,""),b.push(a);return b}static m0i(a){const b=[];for(const c of a)a=new fw.a(c.Id,c.Provider),b.push(a);return b}}Object(m.a)(Au,"UserAccessUtils",null,[406]);class lw{constructor(a){if(a=void 0===a?null:a)this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=a.Title}}Object(m.a)(lw,"PersonaProperties",null,[]);class qt{constructor(a,
b){this.UEf=[];this.PId=[];this.Jyf=-1;this.La=a;this.Psa=b}get GVh(){return this.La.getBooleanAppSetting("IsContactsResolutionEnabled")}Eva(a,b,c,f,l){da.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const u=new Map;u.set("Limit",b.toString());u.set("SearchGal",f.toString());u.set("Scenario",l);eg.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser","wackpitesting",u);if(!this.GVh)return da.ULS.sendTraceTag(39145936,
380,10,"Trying to get user contacts when hosts doesn't support it"),eg.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new v.a,a.wH(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return da.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),eg.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","LimitShouldBeGreaterThanZero",!1,!0,null),a=new v.a,a.wH(Error.invalidOperation("Limit should be > 0")),
a.task;"Unknown"===l&&da.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.Jyf&&!a&&!f)return a=new v.a,c=this.PId.slice(0,Math.max(b-1,this.PId.length-1)),c=this.bhh(this.UEf,c),a.Jg(c),a.task;const I=new v.a;let T;try{T=this.Psa.Eva(a,b,c,f,l)}catch(ja){return I.wH(ja),I.task}if(f||"AtMentions"!==l)return T;T.continueWith(ja=>{if(ja.Ao||ja.Pm){ja=ja.Ao?"Canceled":ja.Ni.message;da.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",ja);var ua=new Map;
u.set("ErrorMessage",ja);ua=Object.assign(new Fl.a,{extendedProperties:ua});eg.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,ua);I.wH(Error.create(ja))}else this.PId=ja=T.result,this.Jyf=b,ja=this.bhh(this.UEf,ja),I.Jg(ja)});return I.task}bhh(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>{this.cLf(f,c)});b.forEach(f=>{this.cLf(f,c)});a=[];for(const f in c)Array.add(a,c[f]);return a}cLf(a,b){if(a&&(a=new lw(a),
a.Email&&a.DisplayName&&a.Id&&a.Provider)){const c=b[this.I1f(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.I1f(a)]=a}}I1f(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(m.a)(qt,"UserContactsUtils",null,[404]);class bA{}Object(m.a)(bA,"CheckUserAccessResponse",null,[]);class ky{}Object(m.a)(ky,"GrantUserAccessResponseItem",null,[]);class mw{}Object(m.a)(mw,"UserPermissions",null,[]);class Qn{constructor(){this.lO=new Cc.a;
this.Ccf=0}Fif(a){let b;const c=[];if(!a)return da.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,K4b:!1};if(!a.length)return da.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,K4b:!1};b=!0;const f={};for(const l of a){a=Qn.x7d(l);if(a in f)continue;f[a]=!0;let u;(a=(()=>{let I=this.lO.Eg(Qn.x7d(l));({value:u}=I);return I})().returnValue)&&
(!u||u.UserCanWrite||u.UserCanReview)||Array.add(c,l);b=b&&a}return{returnValue:c,K4b:b}}ehm(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.lO.remove(Qn.uTc(b));this.lO.add(Qn.uTc(b),b)}}fhm(a,b,c,f){if(!a)throw Error.argumentNull("result");for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");
if(void 0===l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){let u;const I=Qn.y7d(l.Id,l.Provider);(()=>{let T=this.lO.Eg(I);({value:u}=T);return T})().returnValue?(u.UserCanRead=b,u.UserCanWrite=c,u.UserCanReview=f):(u=Object.assign(new mw,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.lO.remove(I),this.lO.add(I,u))}}}ghm(a){if(!a)throw Error.argumentNull("showSharingUiResponse");a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");
for(let b=0;b<a.length;b++){const c=new mw,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?da.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.Ccf,c.UserCanWrite=f.Status===this.Ccf,c.UserCanReview=f.Status===this.Ccf,c.Id=f.Id,c.Provider=f.Provider,this.lO.remove(Qn.uTc(c)),this.lO.add(Qn.uTc(c),c))}}zqg(a){const b=[];for(const c of a)a=Qn.x7d(c),
this.lO.Ib(a)&&Array.add(b,this.lO.ga(a));return b}PTa(a){a=this.zqg(a);return Object.assign(new bA,{Result:a,Canceled:!1})}Y0f(a){a=this.zqg(a);const b=[];for(const c of a)b.push(Object.assign(new ky,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new kw,{Result:b,Canceled:!1})}static uTc(a){return Qn.y7d(a.Id,a.Provider)}static x7d(a){return Qn.y7d(a.UserId,a.Provider)}static y7d(a,b){return b+a}}Object(m.a)(Qn,
"UserPermissionsCache",null,[403]);class ly{constructor(a,b,c,f){this.Psa=a;this.La=b;this.nri=c;this.lri=f}uyb(a,b,c,f){var l=this.Psa.oAa;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new Dm.QueryStringBuilder(l);l.zg("oid","3");l.zg("bdqs",c);(c=this.$_i(f))&&2<=c.length&&(f=c[1],l.zg("w",c[0]),l.zg("h",f));l.zg("uid",a);l.zg("p",b);l.zg("usid",this.nri);l.zg("WacUserType",this.lri);return l.toString()}$_i(a){switch(a){case 1:return["48","48"];case 2:return["64","64"];case 3:return["96",
"96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get w9c(){return this.La.getBooleanAppSetting("IsUserProfilePictureResolutionEnabled")}}Object(m.a)(ly,"UserProfilePictureUtils",null,[401,402]);var Bu=d(584);class ns{constructor(){this.Pn=()=>{const a=Tb.a.instance.resolve("Common.App.People.IPeopleManager");Tb.a.instance.resolve("Common.App.People.IExternalPeopleAPI");
A.AFrameworkApplication.fa.getBooleanAppSetting("GetUserContactsTestHookIsEnabled")&&(new pt(a,A.AFrameworkApplication.Pa)).GIl()}}get name(){return"Common.App.People"}fc(a){a.register(xu,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().na(()=>new xu(A.AFrameworkApplication.Me,()=>A.AFrameworkApplication.mh,A.AFrameworkApplication.fa,new jw.a));a.register(Qn,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(ls,
"Common.App.People.ShowSharingUiPostMessageHandler").ma().na(()=>new ls(hs.a.Au(a.Ha("Postmessage.IHostPostmessenger"))));a.register(Au,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().na(()=>new Au(a.resolve("Common.App.People.PeopleRequestHandler"),A.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),Bu.a,ln.a.instance));a.register(qt,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().na(()=>
new qt(A.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(ly,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().na(()=>new ly(a.resolve("Common.App.People.PeopleRequestHandler"),A.AFrameworkApplication.fa,A.AFrameworkApplication.userSessionId,A.AFrameworkApplication.userType));a.register(wu,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().na(()=>
new wu(a.ub("Common.IColorTable")));a.register(hw,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().na(()=>new hw(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),A.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),Cd.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(vu,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().na(()=>
new vu(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),hs.a.Au(a.Ha("Common.ILokiTokenManager")),A.AFrameworkApplication.fa,a.Ha("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.Ue(this.Pn)}dispose(){}static main(){C.a.instance.Ac(new ns)}}Object(m.a)(ns,"PeoplePackage",null,[2,3]);var Dd={};Dd.jVb=function(){function a(){return I()&&(Xb()||3<=(eb()?tc("version/"):0))}function b(){return 0<=
window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(Yd){Yd=(new RegExp(Yd+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var tf=-1;null!=Yd&&2<=Yd.length&&(tf=parseFloat(Yd[1]),isNaN(tf)&&(tf=-1));return tf}function l(){on||(on=!0,ml=f("Windows Phone"));return 8<=ml}function u(){return"function"==typeof navigator.msLaunchUri&&!c()&&!Ub()&&!T()}function I(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function T(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ja(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function ua(){return ja()?8==window.document.documentMode:!1}function Ra(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function eb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Bb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Ub(){var Yd=window.navigator.userAgent.toLowerCase();
return 0<=Yd.indexOf("android")&&0<=Yd.indexOf("chrome")}function Xb(){return 3<=(Ra()?tc("firefox/"):0)}function tc(Yd){var tf=window.navigator.userAgent.toLowerCase(),Of=tf.indexOf(Yd);return 0<=Of?parseInt(tf.substring(Of+Yd.length,tf.length)):0}function lc(Yd,tf,Of,De,nh){if(De&&null!=tf)tf();else if(u())navigator.msLaunchUri(Yd,tf,Of);else if(!(Bb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&I())||T())hd(Yd,tf,
Of);else if(Bb()&&nh)a:{try{window.open(Yd,"_self")}catch(Zi){null!=Of&&Of();break a}null!=tf&&tf()}else Ec(Yd,tf,Of)}function Ec(Yd,tf,Of){var De=document.getElementById("OICLinkTag");null==De&&(De=document.createElement("a"),De.id="OICLinkTag",De.style.visibility="hidden",De.href="",0==(Qh.Options&Bi.SupportsTopTargetNavigation)||Qh.NoBrowserModalDialogs?De.target="_blank":De.target="_top",document.body.appendChild(De),null!=De.addEventListener&&De.addEventListener("click",function(nh){null!=nh.stopPropagation&&
nh.stopPropagation()},!1));try{De.href=Yd,De.dispatchEvent(new MouseEvent("click"))}catch(nh){null!=Of&&Of();return}null!=tf&&tf()}function hd(Yd,tf,Of){var De=document.getElementById("OICFrame");null==De&&(De=document.createElement("iframe"),De.className="ObjectInDialog",De.style.visibility="hidden",De.src="about:blank",document.body.appendChild(De),De.id="OICFrame");try{De.contentWindow.location.href=Yd}catch(nh){null!=Of&&Of();return}null!=tf&&tf()}function yd(Yd){return 0!=(Yd.Options&Bi.SkipProtocolHandler)||
ua()}function Pd(Yd){return Yd===nl.ReadOnly||Yd===nl.ReadWrite}function pe(Yd,tf,Of,De){var nh;try{var Zi=new ActiveXObject("SharePoint.OpenDocuments.4");return(nh=Zi.ViewDocument3(window.self,Yd,tf,De))?(Zj(ci.O14ActiveX),zg.None):zg.Failed}catch(rj){}if(Bi.O14Only===(Of&Bi.O14Only))return Qh.DescriptiveUnattemptedEnums?zg.O14AttemptFailure:zg.Unattempted;try{return Zi=new ActiveXObject("SharePoint.OpenDocuments.3"),(nh=Zi.ViewDocument3(window.self,Yd,tf,De))?(Zj(ci.O12ActiveX),zg.None):zg.Failed}catch(rj){}if(Bi.O12UpOnly===
(Of&Bi.O12UpOnly))return Qh.DescriptiveUnattemptedEnums?zg.O12UpOnlyFail:zg.Unattempted;try{return Zi=new ActiveXObject("SharePoint.OpenDocuments.2"),(nh=Pd(tf)?Zi.ViewDocument2(window.self,Yd,De):Zi.EditDocument2(window.self,Yd,De))?(Zj(ci.O11ActiveX),zg.None):zg.Failed}catch(rj){}return Qh.DescriptiveUnattemptedEnums?zg.ActiveXUnattempted:zg.Unattempted}function Se(Yd,tf,Of,De,nh){Yd==Oh.Visio&&Of==nl.ReadWrite&&(Of=nl.WriteOnly);De=De||c()&&!l();if(!De){De="";if(Yd==Oh.PowerPoint){Yd=De;De=Qh.DocumentExtension;
Of=Pd(Of);var Zi=new Set([".pot",".potm",".potx"]),rj=new Set([".pps",".ppsm",".ppsx"]);Of=Of&&Zi.has(De)?"nft|ofc|":Of&&rj.has(De)?"ofv|ofs|t|":!Of&&rj.has(De)?"ofe|ofs|t|":Of?"ofv|ofc|":"ofe|";Of=Yd+Of}else Of=Pd(Of)?De+"ofv|ofc|":De+"ofe|";De=Of;Qh.NewTelemetryDataIsEnabled&&(Of=Qh.SessionOrigin?"or|"+Qh.SessionOrigin+"|":"",Of+=Qh.ClickTime?"ct|"+Qh.ClickTime+"|":"",Of+=Qh.CorrelationId?"cid|"+Qh.CorrelationId+"|":"",De+=ug(Of));nh+=ug(De+"u|")}nh+=ug(tf);tf=window.location.href;Of=tf.toLowerCase().indexOf("&wdlor=");
-1!=Of?(Of+=7,Yd=tf.indexOf("&",Of),tf=-1==Yd?tf.substr(Of):tf.substring(Of,Yd)):tf=void 0;if(null!=tf&&"undefined"!=typeof tf){Of="";try{Of=decodeURIComponent(tf)}catch(Mo){}0<Of.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Of)&&(nh=nh+"|f|"+Of)}return nh}function vf(Yd,tf,Of,De,nh,Zi){var rj=Wf(Yd);if(null==rj)return qj(Qh.DescriptiveUnattemptedEnums?zg.ProtocolHandlerIsNull:zg.Unattempted,Qh.Application),!1;Yd=Se(Yd,tf,Of,De,rj);lc(Yd,Tg,$f,nh,Zi);return!0}function ug(Yd){if(I()&&
Bb()){var tf="";try{tf=decodeURI(Yd)}catch(Of){}if(tf==Yd)return encodeURI(Yd)}return Yd}function Tg(){Zj(ci.ProtocolHandler)}function $f(){Qh.Options|=Bi.SkipProtocolHandler;vh(Qh,wk,Qk)}function Ve(){null!=qk&&qk(ci.RoamingProtocolHandler)}function xg(){null!=Hl&&Hl(zg.ControlNeeded)}function yg(){var Yd=document.getElementById("npSharePointPlugin");if(null==Yd){Yd="application/x-sharepoint";I()&&3<=(eb()?tc("version/"):0)&&ng("application/x-sharepoint-webkit",!0)&&(Yd="application/x-sharepoint-webkit");
if(!ng(Yd,!0))if(I()&&ng("application/officelive",!0))Yd="application/officelive";else return null;var tf=document.createElement("object");tf.id="npSharePointPlugin";tf.type=Yd;tf.style.width="0px";tf.style.height="0px";tf.style.setProperty("visibility","hidden","");document.body.appendChild(tf);Yd=document.getElementById("npSharePointPlugin")}return Yd}function ng(Yd,tf){var Of=window.navigator.mimeTypes;if(null==Of)return!1;Yd=Of[Yd];return!Yd||tf&&!Yd.enabledPlugin?!1:!0}function Wh(Yd){try{if(null!=
new ActiveXObject(Yd))return!0}catch(tf){}return!1}function Ai(Yd){switch(Yd){case Oh.OneNote:return"OneNote.Notebook";default:return""}}function Wf(Yd){if(Yd!=Oh.OneNote&&c()&&!l())return"office:";switch(Yd){case Oh.Excel:return"ms-excel:";case Oh.OneNote:return"onenote:";case Oh.PowerPoint:return"ms-powerpoint:";case Oh.Visio:return"ms-visio:";case Oh.Word:return"ms-word:";case Oh.Project:return"ms-project:";case Oh.Publisher:return"ms-publisher:";case Oh.Infopath:return"ms-infopath:";case Oh.Access:return"ms-access:";
default:return""}}function gg(Yd){switch(Yd){case Oh.Excel:return"root\\office15\\excel.exe";case Oh.PowerPoint:return"root\\office15\\powerpnt.exe";case Oh.Visio:return"root\\office15\\visio.exe";case Oh.Word:return"root\\office15\\winword.exe";case Oh.Project:return"root\\office15\\winproj.exe";case Oh.Publisher:return"root\\office15\\mspub.exe";case Oh.Infopath:return"root\\office15\\infopath.exe";case Oh.Access:return"root\\office15\\msaccess.exe";default:return null}}function vh(Yd,tf,Of){Qh=
Yd;wk=tf;Qk=Of;if(Yd.DocumentUrl){var De=Of=tf=Yd.DocumentUrl;try{De=decodeURIComponent(Yd.DocumentUrl)}catch(No){}try{Of=encodeURI(Yd.DocumentUrl)}catch(No){}tf=tf+""+Yd.CorrelationIdForWinClient;De+=Yd.CorrelationIdForWinClient;Of+=Yd.CorrelationIdForWinClient;Yd.Mode===nl.ReadWrite&&Bi.CheckoutRequired===(Yd.Options&Bi.CheckoutRequired)&&(Yd.Mode=nl.ForceCheckout);Bi.HostIsEditOnly===(Yd.Options&Bi.HostIsEditOnly)&&(Yd.Mode=nl.WriteOnly);if(yd(Yd)?0:I()&&(Yd.Application==Oh.OneNote||ng("application/x-sharepoint-protocolhandler",
!1)||ng("application/x-sharepoint-webkit-protocolhandler",!1))||u()||Ub()||!(a()||Xb()||"ActiveXObject"in window&&!c()||Bb())||15<=Ok())vf(Yd.Application,Yd.EncodeUrl?Of:tf,Yd.Mode,Yd.Application==Oh.OneNote,Yd.SilentExternalHandler,Yd.NavigateUsingWindowOpen);else{var nh;if(nh=ua())a:{var Zi=Yd.EncodeUrl?tf:De,rj=Yd.Mode,Mo=Ai(Yd.Application);try{nh=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Zi,rj,Mo);break a}catch(No){}nh=!1}if(nh)Zj(ci.O15ActiveX);else{if(a()||
Xb()){var Rk=Yd.EncodeUrl?tf:De;De=Yd.Mode;nh=Ai(Yd.Application);Zi=yg();if(null==Zi)Rk=Qh.DescriptiveUnattemptedEnums?zg.PluginIsNull:zg.Unattempted;else{rj=!1;try{rj=Zi.ViewDocument3(window.self,Rk,De,nh)}catch(No){}if(!rj)try{rj=Pd(De)?Zi.ViewDocument2(window.self,Rk,nh):Zi.EditDocument2(window.self,Rk,nh)}catch(No){}rj?(Zj(ci.NpapiPlugin),Rk=zg.None):Rk=zg.Failed}}else{try{Rk=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Rk&&Rk.SaveSSOCreds()}catch(No){}Rk=pe(Yd.EncodeUrl?tf:De,Yd.Mode,Yd.Options,
Ai(Yd.Application))}if(Rk!=zg.None){if(De=Yd.CouldUseRoamingApps)Il||(Il=!0,ym=f("Windows NT")),De=6.1<=ym&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ja()||Xb()||Bb());if(De&&Yd.Application!=Oh.OneNote){if(!Dd.jVb.yqm()){qj(zg.ControlNeeded,Qh.Application);return}if(Yd.RoamingAppsLauncher){"undefined"==typeof Yd.RoamingAppsLauncher||null==Yd.RoamingAppsLauncher?qj(Qh.DescriptiveUnattemptedEnums?zg.RoamingLauncherIsNull:zg.Unattempted,Qh.Application):"undefined"==typeof Yd.RoamingBitsUrl||
null==Yd.RoamingBitsUrl?Dd.jVb.urm(Yd.DocumentUrl,Yd.RoamingAppsLauncher,Yd.Application,Yd.ApplicationParameters,wk,Qk):Dd.jVb.g8h(Yd.DocumentUrl,Yd.RoamingAppsLauncher,Yd.RoamingApplicationExe,Yd.ApplicationParameters,Yd.RoamingPlatform,Yd.RoamingBitsUrl,wk,Qk);return}if(!Yd.ContinueIfLauncherIsNull){qj(zg.LauncherNeeded,Qh.Application);return}}Bi.NoProtocolHandlerFallback==(Yd.Options&Bi.NoProtocolHandlerFallback)||yd(Yd)||ja()||I()&&!(Qh.DescriptiveUnattemptedEnums?Rk>=zg.O14Unattempted&&Rk<=zg.DocumentUrlIsNull:
Rk==zg.Unattempted)?qj(Rk,Qh.Application):vf(Yd.Application,Yd.EncodeUrl?Of:tf,Yd.Mode,Yd.Application==Oh.OneNote,Yd.SilentExternalHandler,Yd.NavigateUsingWindowOpen)}}}}else qj(Qh.DescriptiveUnattemptedEnums?zg.DocumentUrlIsNull:zg.Unattempted,Qh.Application)}function Zj(Yd){null!=wk&&wk(Yd)}function qj(Yd,tf){"undefined"==typeof tf&&(tf=null);null!=Qk&&Qk(Yd,tf)}function Ok(){var Yd=0;if(a()||Xb()||Bb()){var tf=yg();try{null!=tf&&(Yd=tf.GetOfficeVersion())}catch(Of){}}else Wh("SharePoint.OpenDocuments.5")?
Yd=15:Wh("SharePoint.OpenDocuments.4")?Yd=14:Wh("SharePoint.OpenDocuments.3")?Yd=12:Wh("SharePoint.OpenDocuments.2")&&(Yd=11);return Yd}function Wl(){return I()&&(ng("application/x-sharepoint",!0)||ng("application/x-sharepoint-webkit",!0))}var Rm="",Pk="",Xl="",wk,Qk,qk,Hl,Qh,Il,ym,on,ml,nl={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Bi={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
zg={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},ci={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Oh={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:nl,OpenDocumentOptions:Bi,OpenDocumentFailureType:zg,OpenDocumentControl:ci,OfficeApplication:Oh,EditDocumentInClient:vh,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Oh.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Ok,IsO14MacPluginInstalled:Wl,OfferOfficeInDialog:function(){return b()&&11>=Ok()},OfferOfficeNoIntrusive:function(){return b()&&15>Ok()},OfferMacOffice:function(){return I()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!Wl()},InstallRoamingControl:function(){Ra()?window.InstallTrigger.install({Office:{URL:Pk}}):hd(Xl,null,null)},CanUseRoamingControl:function(){if(u())return!0;if(Bb())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Ra()){var Yd=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Yd);var tf=document.createEvent("Events");tf.initEvent("RoamingOfficeInstalled",!0,!1);Yd.dispatchEvent(tf);
return!!Yd.getAttribute("installed")}if(ja())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Of){}return!1},InitUrls:function(Yd,tf,Of){Rm=Yd;Pk=Of;Xl=tf},LaunchRoamingApps:function(Yd,tf,Of,De,nh,Zi){Dd.jVb.g8h(Yd,tf,gg(Of),De,"x86",Rm,nh,Zi)},LaunchRoamingApps2:function(Yd,tf,Of,De,nh,Zi,rj,Mo){var Rk="";null!=De&&(Rk+=" "+De);null!=Yd&&(Rk+=' "'+Yd+'"');if(u()||Bb())qk=rj,Hl=Mo,rj='office: "'+(Zi+'" "')+(Of+'" "ROAMING"'),rj+=' "'+tf+'"',rj+=' "'+nh+'"',rj+=
" "+Rk,lc(rj,Ve,xg,!1,!1);else if(Ra())Yd=document.createElement("RoamingExtensionElement"),Yd.setAttribute("cabUrl",Zi),Yd.setAttribute("app",Of),Yd.setAttribute("licensingEntitlements",tf),Yd.setAttribute("platform",nh),Yd.setAttribute("args",Rk),document.documentElement.appendChild(Yd),tf=document.createEvent("Events"),tf.initEvent("RoamingOfficeLaunch",!0,!1),Yd.dispatchEvent(tf),null!=rj&&rj(ci.RoamingFFExtension);else if(ja()){if(Yd=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Yd)try{Yd.HrConfigureSingle(Zi,Of,tf,nh,Rk),null!=rj&&rj(ci.RoamingActiveX)}catch(No){}}else null!=Mo&&Mo(zg.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:Ec,OpenDocumentWithProtocolHandler:vf,OpenDocumentWithProtocolHandlerNoCallBack:function(Yd,tf,Of,De){var nh=Wf(Yd);if(null==nh)return qj(Qh.DescriptiveUnattemptedEnums?zg.ProtocolHandlerNoCallbackIsNull:zg.Unattempted,Qh.Application),!1;Yd=Se(Yd,tf,Of,De,nh);lc(Yd,null,null,!1,!1);return!0}}}();Dd.ClientUtils=
Dd.jVb;class Fd{constructor(a,b,c){this.Y$k=(f,l,u,I,T)=>{if(1===u)return 32;T?(f=T.SourceControlId,"btnjTryMacOfficeForWordEditor"===f?Sd.a.qo(oe.a.tGa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===f&&Sd.a.qo(oe.a.tGa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.sIg();return 32};this.Lqh=(f,l,u)=>{if(1===u)return 32;switch(f){case N.a.E_h:Sd.a.qo(oe.a.tGa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case N.a.D_h:Sd.a.qo(oe.a.tGa(25),
"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};this.Ca=a;this.chi=b;this.IH=c}qb(){this.Ca.xa(N.a.Xdm,Le.a.frame,this.Y$k);this.Ca.xa(N.a.E_h,Le.a.frame,this.Lqh);this.Ca.xa(N.a.D_h,Le.a.frame,this.Lqh)}sIg(){var a=void 0===a?null:a;let b=0;a&&(b=a);Sd.a.qo(2===b?"https://go.microsoft.com/fwlink/?LinkId=331579":Fd.eVk,"_blank",void 0,"LaunchMacTrialWindow")}get vyc(){return this.chi&&E.a.Fl&&!E.a.Wwe&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get gQh(){const a=this.vyc;a||A.AFrameworkApplication.fj.FOl();
return a}get jYl(){return this.vyc}static get eVk(){return oe.a.aY("522401")}}Object(m.a)(Fd,"MacOfficeOffer",null,[290]);class Ed{constructor(a,b,c){this.Z$k=(f,l,u,I,T)=>{if(this.NMc&&1===u)return this.isFreemiumUpsellEnabled&&this.wyc?32:8;2===u&&(T?(f=T.SourceControlId,"btnjTryOfficeForWordEditor"===f?Sd.a.qo(oe.a.tGa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===f?Sd.a.qo(oe.a.tGa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Cze()):this.Cze());
return 32};this.igf=(f,l,u,I,T)=>{if(this.NMc&&1===u)return this.isFreemiumUpsellEnabled&&this.wyc?32:8;2===u&&(T?(f=T.SourceControlId,Sd.a.qo(oe.a.aY("862405")+this.NHj(f),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Sd.a.qo(oe.a.aY("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};this.N_h=(f,l,u)=>{if(this.NMc&&1===u)return this.isFreemiumUpsellEnabled&&this.wyc?32:8;if(2===u)switch(f){case N.a.M_h:Sd.a.qo(oe.a.tGa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");
break;case N.a.L_h:Sd.a.qo(oe.a.tGa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};this.Ca=a;this.fhi=b;this.VHd=null;(this.NMc=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.VHd=f});this.IH=c}qb(){this.Ca.xa(N.a.gem,Le.a.frame,this.Z$k);this.Ca.xa(N.a.igf,Le.a.frame,this.igf);this.Ca.xa(N.a.M_h,
Le.a.frame,this.N_h);this.Ca.xa(N.a.L_h,Le.a.frame,this.N_h)}get kkh(){return this.wyc}get J1k(){return this.wyc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get wyc(){return this.fhi&&!E.a.Fl}get isFreemiumUpsellEnabled(){let a=!1;this.VHd&&(a=this.VHd.isFreemiumUpsellEnabled());return a}Cze(a){a=void 0===a?null:a;let b=0;a&&(b=a);Sd.a.qo(Ed.tEj(b),"_blank",void 0,"LaunchOfficeOffer")}NHj(a){let b=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=
2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=
16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=
29}return 0===b?"":String.format("&pc={0:D}",b)}static tEj(a){if(E.a.Aj)switch(a){case 1:return oe.a.aY("393806");case 2:return oe.a.aY("393810");case 3:return oe.a.aY("393809");case 5:return oe.a.aY("393805")}else if(E.a.OD)switch(a){case 1:return oe.a.aY("521979");case 3:return oe.a.aY("521980");case 5:return oe.a.aY("521978");case 2:return oe.a.aY("522490")}else{if(2===a)return oe.a.aY("517778");if(1===a)return oe.a.tGa(30)}return oe.a.aY("522402")}}Object(m.a)(Ed,"OfficeTrialExperience",null,
[289]);class rt{fc(a){a.register(Ed,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().na(()=>new Ed(A.AFrameworkApplication.Pa,A.AFrameworkApplication.Bwe,A.AFrameworkApplication.lcid));a.register(Fd,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().na(()=>new Fd(A.AFrameworkApplication.Pa,A.AFrameworkApplication.pDg,A.AFrameworkApplication.lcid))}}Object(m.a)(rt,"OpenInClientConfiguration",null,[3]);var Kq=d(176),Df=d(48);class my{constructor(a,
b,c){this.fZ=this.ev=this.K=null;this.zf=a;this.aH=b;this.jOe=c}c1f(a,b,c){if(!this.zf)return null;if(!this.K){this.K=Df.a.we();this.K.id=this.aH;this.K.className="HTMLSpinnerIndicator";const f=Df.a.we();f.className="HtmlspinnerOverlay";this.ev=Df.a.we();this.ev.className="HtmlspinnerInner";const l=Df.a.En();l.className="BootSpinner";this.ev.appendChild(l);this.jOe&&(this.fZ=Df.a.En(),this.fZ.id="htmlspinner_label",this.ev.appendChild(this.fZ));this.K.appendChild(f);this.K.appendChild(this.ev);this.zf.appendChild(this.K)}this.jOe&&
(this.fZ.innerText=a||ResourceStrings.l_Loading);this.E_d(b,c);return this.K}rUb(a){this.fZ&&(this.fZ.innerText=a)}E_d(a,b){this.K.style.left=Df.a.Rc(a);this.K.style.top=Df.a.Rc(b);this.ev.style.bottom=this.jOe?Df.a.Rc(this.zf.clientHeight/2+16):Df.a.Rc(this.zf.clientHeight/2+24)}}Object(m.a)(my,"HtmlSpinnerIndicator",null,[]);class cA extends my{constructor(a,b,c){super(a,b,!1);this.lOe=c}c1f(a,b,c){if(!this.zf)return null;if(!this.K){this.K=Df.a.we();this.K.id=this.aH;this.K.className="HTMLProgressIndicator";
const f=Df.a.we();f.className="HtmlprogressOverlay";this.ev=Df.a.we();this.ev.className="HtmlprogressInner";if(this.lOe){const l=Df.a.DD();l.src=Kq.a.GO(jf.a.iqa);l.width=jf.a.XNb;l.height=jf.a.Lsd;this.ev.appendChild(l)}this.fZ=Df.a.En();this.ev.appendChild(this.fZ);this.K.appendChild(f);this.K.appendChild(this.ev);this.zf.appendChild(this.K)}this.fZ.innerText=a||ResourceStrings.l_Loading;this.E_d(b,c);return this.K}E_d(a,b){this.K.style.left=Df.a.Rc(a);this.K.style.top=Df.a.Rc(b);this.K.style.display=
Hf.a.kl;this.ev.style.position=Hf.a.Iia;a=this.ev.clientWidth;this.ev.style.top=Df.a.Rc(this.zf.clientHeight/2-this.ev.clientHeight/2);A.AFrameworkApplication.isRtl?(this.ev.style.right=Df.a.Rc(this.zf.clientWidth/2-a/2),this.ev.style.direction=Hf.a.i4a):(this.ev.style.left=Df.a.Rc(this.zf.clientWidth/2-a/2),this.ev.style.direction=Hf.a.oVh);this.K.style.display=Hf.a.kf}}Object(m.a)(cA,"HtmlProgressIndicator",my,[]);class dA{constructor(a,b){this.QK=this.$P=this.K=null;this.Mb=!0;this.eUg=a;this.yK=
b}hSb(a,b,c,f,l){A.AFrameworkApplication.$Eb()||(this.K=this.eUg.c1f(a,c,f),b?(this.$P&&(window.clearTimeout(this.$P),this.$P=null),this.QK&&(window.clearTimeout(this.QK),this.QK=null),this.W$e(l)):this.$P||this.QK||(this.$P=window.setTimeout(()=>{this.waf(l)},200)))}X3c(){this.$P&&(window.clearTimeout(this.$P),this.$P=null);this.QK&&(window.clearTimeout(this.QK),this.QK=null);this.K&&(this.K.style.display=Hf.a.kf,this.K.style.opacity="0")}rUb(a){this.eUg.rUb(a)}W$e(a){this.K&&(this.K.style.opacity=
"1.0",this.K.style.visibility=Hf.a.AA,this.Mb&&(this.K.style.display=Hf.a.kl),ya.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.tBc(a)))}waf(a){this.$P=null;this.K&&(this.K.style.visibility=Hf.a.AA,this.Mb&&(this.K.style.display=Hf.a.kl),this.K.style.opacity="0.0",this.QK||(this.QK=window.setTimeout(()=>{this.vaf(a)},1800)))}vaf(a){this.QK=null;this.K&&(this.K.style.opacity="1.0",this.Mb&&(this.K.style.display=Hf.a.kl),ya.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",
this.tBc(a)))}tBc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.yK.H7(a):null:null}get visible(){return this.Mb}set visible(a){this.Mb=a;this.K&&(this.K.style.display=a?Hf.a.kl:Hf.a.kf)}}Object(m.a)(dA,"HtmlProgressIndicatorView",null,[1839]);class eA{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=null}}Object(m.a)(eA,"UploadConvertedFileToHostParams",null,[]);var fA=d(1050),mp=d(78);const st=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];
c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},tt=a=>a.hc.keyCode===H.a.Mp||a.hc.keyCode===H.a.fO?(a.Ec.click(),!0):!1,Ff=(a,b,c,f,l,u,I)=>{const T=document.createElement("a");T.className="ProtocolLaunchingDialogButtonAnchor";T.className+=" OICDialog";T.id=a;T.setAttribute(Qe.a.Ff,Qe.a.jx);T.style.padding="0";T.style.margin="0";f&&kd(l,b,c,f,T);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;T.appendChild(a);
T.tabIndex=0;u&&ze.a.instance.xb(la.a.click,T,u);I&&B.KeyInputManager.instance.xb(la.a.rm,T,I);return T},kd=(a,b,c,f,l)=>{var u=document.createElement("img");u.alt=a;u.className=mp.getImageClassWithCluster(c,f);u.src=b;u.setAttribute(Qe.a.Ff,Qe.a.gR);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(u);u=document.createElement("span");u.className="ProtocolLaunchingDialogIconContainer";u.appendChild(a);l.appendChild(u)};class Uo{static get Wg(){return zi.a.oC(Uo.Hq,
CommonUIStrings.l_OICLaunchDialogTitle)}}Uo.Hq="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(Uo,"OICLaunchDialogHtml",null,[]);class ny extends zi.a{constructor(a){super();this.erb=this.Q5a=null;this.$Pa=!1;this.iph=()=>{this.hide();this.gy.K2a();return!0};this.kph=()=>{da.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();A.AFrameworkApplication.Pa.nb(N.a.Ymb,2);return!0};this.P1k=()=>{this.gy.K2a()};this.gy=a;this.Wg=Uo.Wg;this.Fd=5;this.Fg="OICLaunchDialog";this.showDialog("",this.P1k);this.qMh();this.M7("ProtocolLaunchingDialogTitle");4!==A.AFrameworkApplication.za.mb.Dua&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.eT(this.Q5a);da.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}$ya(){this.Q5a=Ff("BtnRichClient",this.gy.czb,this.gy.Mdb,this.gy.ape,CommonUIStrings.l_OICLaunchRichClient,this.kph,tt);document.getElementById("OICLaunchRichClient").appendChild(this.Q5a);st(this.Q5a);this.erb=Ff("BtnReturn",this.gy.czb,
this.gy.Mdb,this.gy.Nwg,CommonUIStrings.l_OICReturnToOnlineClient,this.iph,tt);document.getElementById("OICReturnToApp").appendChild(this.erb);st(this.erb)}dispose(){this.$Pa||(this.Q5a&&(ze.a.instance.Hb(la.a.click,this.Q5a,this.kph),B.KeyInputManager.instance.Hb(la.a.rm,this.Q5a,tt)),this.erb&&(ze.a.instance.Hb(la.a.click,this.erb,this.iph),B.KeyInputManager.instance.Hb(la.a.rm,this.erb,tt)),super.dispose(),this.$Pa=!0)}}Object(m.a)(ny,"OICLaunchDialog",zi.a,[]);class nw{static get Wg(){return zi.a.oC(nw.Hq,
CommonUIStrings.l_OICDialogTitle)}}nw.Hq="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(nw,"ProtocolLaunchingDialogV2Html",null,[]);var gA=d(203);class hA extends zi.a{constructor(a){super();this.drb=this.WBa=null;this.$Pa=!1;this.EPa=null;this.Amh=b=>this.MTe(b,0);this.fnh=b=>this.MTe(b,2);this.hph=b=>this.MTe(b,1);this.xmh=()=>{this.hide();4===A.AFrameworkApplication.za.mb.Dua?(da.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.gy.K2a()):(da.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.gy.gcc());return!0};this.Pod=
()=>{da.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0};this.Spd=()=>{da.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";A.AFrameworkApplication.Pa.nb(N.a.Ymb,2);return!0};this.Vtc=()=>{this.gy.K2a()};this.gy=a;this.Wg=nw.Wg;this.Fd=5;this.Fg="ProtocolLaunchingDialog";this.ZEc="OICRetryDialog";A.AFrameworkApplication.Be.Jva&&A.AFrameworkApplication.Be.dNa();A.AFrameworkApplication.Be.Jb(new ne.a(2,1,5E3,()=>
{this.D7l()},101));this.showDialog("",this.Vtc);this.qMh();this.M7("Issues");this.Ndg();da.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}$ya(){const a=document.getElementById("Issues");if(a){kd("",this.gy.czb,this.gy.Mdb,this.gy.ape,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.gy.hrh?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);
st(a);a.style.display="none"}A.AFrameworkApplication.za.mb.drg?(this.drb=Ff("GiveFeedback",this.gy.czb,this.gy.Mdb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,this.Pod,this.fnh),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.drb),st(this.drb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===A.AFrameworkApplication.za.mb.Dua||A.AFrameworkApplication.dcj?document.getElementById("ButtonEdit").style.display="none":(this.WBa=Ff("Edit",this.gy.czb,
this.gy.Mdb,"",2===A.AFrameworkApplication.za.mb.Ej?4===A.AFrameworkApplication.za.mb.Dua?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===A.AFrameworkApplication.za.mb.Dua?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this.xmh,this.Amh),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.WBa),st(this.WBa));0===A.AFrameworkApplication.za.mb.Dua&&!A.AFrameworkApplication.Bwe&&a&&(a.style.display="none")}Odg(){return this.EPa?
(this.eT(this.EPa),!0):!1}Ndg(){return this.WBa?(this.eT(this.WBa),!0):!1}MTe(a,b){let c=!1;if(a.hc.keyCode===H.a.Mp||a.hc.keyCode===H.a.fO)a.Ec.click(),c=!0;else if(a.hc.keyCode===Sys.UI.Key.down||a.hc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.Ndg();break;case 0:c=this.Odg()}return c}D7l(){var a=document.getElementById("ProtocolLaunchingDialogTitle");if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!a.children.length&&(this.EPa=Ff("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,this.Spd,this.hph),a.appendChild(this.EPa),st(this.EPa),this.WBa||this.Odg())}}dispose(){this.$Pa||(this.WBa&&(ze.a.instance.Hb(la.a.click,this.WBa,this.xmh),B.KeyInputManager.instance.Hb(la.a.rm,this.WBa,this.Amh)),this.drb&&(ze.a.instance.Hb(la.a.click,this.drb,this.Pod),B.KeyInputManager.instance.Hb(la.a.rm,this.drb,this.fnh)),this.EPa&&(ze.a.instance.Hb(la.a.click,this.EPa,this.Spd),B.KeyInputManager.instance.Hb(la.a.rm,
this.EPa,this.hph)),super.dispose(),this.$Pa=!0)}}Object(m.a)(hA,"ProtocolLaunchingDialog",zi.a,[]);class Cu extends Ij.StandardDialog{constructor(a){super();this.Pod=b=>{da.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Mmh(b)};this.Spd=()=>{da.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");A.AFrameworkApplication.Pa.nb(N.a.Ymb,2)};this.Vtc=b=>{Cu.Xtg?3===b?this.fHh():2===b||0===b?this.i_f():1===b&&this.closeDocument():2===b?this.fHh():(1===b||0===b)&&this.i_f()};this.gy=
a;this.Fg="ProtocolLaunchingDialog";A.AFrameworkApplication.Be.Jva&&A.AFrameworkApplication.Be.dNa();A.AFrameworkApplication.za.mb.drg&&this.WJf(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,this.Pod);Cu.Xtg?(this.Fd=12,this.Te(1,CommonUIStrings.l_CloseFile),this.Te(2,CommonUIStrings.l_OICDialogContinueHere),this.Te(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Fd=4,this.Te(1,CommonUIStrings.l_OICDialogContinueHere),this.Te(2,CommonUIStrings.l_OICDialogLaunchAgain));this.Opc(CommonUIStrings.l_OICDialog2ndTitle,
5===this.gy.hrh?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,this.Vtc,null)}closeDocument(){da.ULS.sendTraceTag(577783557,211,50,"Closing the document");A.AFrameworkApplication.Pa.Ia(N.a.close,2,hb.a)}fHh(){da.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.Spd,0)}i_f(){4===A.AFrameworkApplication.za.mb.Dua||A.AFrameworkApplication.fa.getBooleanAppSetting("WordConsumptionViewToEditRedirectIsEnabled")&&1===A.AFrameworkApplication.za.mode?
(da.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.gy.K2a()):(da.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.gy.gcc())}static get Xtg(){return A.AFrameworkApplication.fa.getBooleanAppSetting("OICDialogThreeActions")&&32===A.AFrameworkApplication.Pa.nb(N.a.close,1)}}Object(m.a)(Cu,"StandardProtocolLaunchingDialog",Ij.StandardDialog,[]);var ow=d(681);class qx{}Object(m.a)(qx,"EditDocumentInClientParams",null,[]);class oy{static E7f(a,b,c,f,
l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc){I=void 0===I?!1:I;T=void 0===T?!1:T;ja=void 0===ja?"":ja;ua=void 0===ua?!1:ua;Ra=void 0===Ra?!1:Ra;eb=void 0===eb?!1:eb;Bb=void 0===Bb?"":Bb;Ub=void 0===Ub?"":Ub;Xb=void 0===Xb?"":Xb;tc=void 0===tc?!1:tc;lc=void 0===lc?"":lc;const Ec=new qx;Ec.DocumentUrl=a;Ec.DocumentExtension=lc;Ec.Mode=b;Ec.Options=c;Ec.Application=f;Ec.SilentExternalHandler=I;Ec.EncodeUrl=T;Ec.CorrelationIdForWinClient=ja;Ec.NavigateUsingWindowOpen=ua;Ec.DescriptiveUnattemptedEnums=Ra;Ec.NoBrowserModalDialogs=
eb;Ec.SessionOrigin=Bb;Ec.CorrelationId=Ub;Ec.ClickTime=Xb;Ec.NewTelemetryDataIsEnabled=tc;MSOJS.ClientUtils.EditDocumentInClient(Ec,l,u)}}Object(m.a)(oy,"ClientUtils",null,[]);var iA=d(578),jA=d(539),pw=d(109);class os{constructor(a){this.UCa=this.aXb=this.gWb=null;this.OXb=!1;this.GKd=this.AQd=this.cBf=null;this.eEc=this.$ra=this.kLc="";this.application=this.Tz=0;this.r7l=this.Ncf=!1;this.GHl=(b,c,f)=>c.contextId!==Le.a.frame?2:1===f?32:this.Ymb();this.ukh=()=>{this.o5d()};this.vkh=()=>{this.K2a()};
this.Jnh=()=>{this.nIg()};this.V5j=()=>this.E5f(!0);this.Elm=a&&A.AFrameworkApplication.fa.getBooleanAppSetting("OICLaunchDialogIsEnabled");A.AFrameworkApplication.Pa.RU(N.a.Ymb)||A.AFrameworkApplication.Pa.xa(N.a.Ymb,Le.a.frame,this.GHl);this.DSh=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("SilentExternalHandler")}get hrh(){return this.Tz}jUl(a,b,c){b=void 0===b?"":b;this.$ra=(void 0===c?"":c)||kh.a.create().toString();this.kLc=b||iA.a.Ulg();this.eEc=a}get options(){let a=
0;A.AFrameworkApplication.requiresCheckout&&(a|=1);A.AFrameworkApplication.prh&&(a|=4);this.p7l()&&(a|=64);return a}p7l(){return!(2===this.application&&A.AFrameworkApplication.fa.getBooleanAppSetting("IsEmbeddedScenario"))}get czb(){return A.AFrameworkApplication.Mm}get Mdb(){return A.AFrameworkApplication.dP}get Nwg(){return""}get ape(){return""}get q7l(){return A.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteMobileViewerIsEnabled")}get k$l(){return this.cBf||(this.cBf=Tb.a.instance.resolve("Common.IOfficeTrialExperience"))}o5d(){this.Ncf||
this.ejj()}K2a(){this.r7l||this.N$f()}Wsl(a){return this.Elm&&E.a.Aj?(new ny(this),32):this.Rxb(a)}Rxb(a){let b;const c=(()=>{let f=this.vvk(a);({F4a:b}=f);return f})().returnValue;da.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===c,b);return c}begin(a,b,c,f,l,u,I){this.gWb=a;this.GKd=void 0===I?"":I;this.aXb=b;this.UCa=u;this.application=c;this.Tz=f;return A.AFrameworkApplication.$6f?(this.nIg(),32):A.AFrameworkApplication.YR&&!A.AFrameworkApplication.Pvg?(A.AFrameworkApplication.gSh(),
8):this.NQf(l)}get O1k(){return!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}Ymb(){this.O1k&&this.azk();return this.Rxb(this.OXb)}GKh(){const a=new jA.a(le.a.openInClient);a.Values["ui-language"]=A.AFrameworkApplication.lcid.toString();a.Values[ow.a.S2f]=A.AFrameworkApplication.userSessionId;return this.UCa.value.send(a)?32:8}azk(){eg.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],
!1,!1,!1,!1,Object.assign(new Fl.a,{inStaging:!1}))}hNl(a){const b=new jA.a(le.a.aom);b.Values["ui-language"]=A.AFrameworkApplication.lcid.toString();b.Values[ow.a.S2f]=A.AFrameworkApplication.userSessionId;b.Values[ok.a.$nm]=a;this.UCa.value.send(b)}vvk(a){this.OXb=a;this.hNl(5===this.Tz?os.Tal:os.Zal);return 5===this.Tz?this.ovk():this.wvk()}ovk(){this.tIg();return{returnValue:32,F4a:"HostEditUrl,"}}wvk(){let a;var b=a="";A.AFrameworkApplication.QKf&&(b="|f|"+A.AFrameworkApplication.userSessionId);
const c=A.AFrameworkApplication.fa.getBooleanAppSetting("IsAssignmentMode")&&A.AFrameworkApplication.fa.getBooleanAppSetting("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||A.AFrameworkApplication.sgc||E.a.gIa,f=A.AFrameworkApplication.fa.getBooleanAppSetting("UnattemptedEnumIsEnabled"),l=A.AFrameworkApplication.fa.getBooleanAppSetting("NoBrowserModalDialogs");if(A.AFrameworkApplication.Pa.qnd){var u=A.AFrameworkApplication.Pa.Vcb(3588168074);u&&this.jUl(u.epochClickTime,u.sessionOrigin,
u.correlationId);this.vKg()}if(A.AFrameworkApplication.ewh){a+="NewOrder,";u=8;this.UCa&&this.UCa.value&&this.UCa.value.isEnabled()&&A.AFrameworkApplication.gCc&&(a+="Post,",u=this.GKh());if(32===u)return{returnValue:u,F4a:a};da.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return A.AFrameworkApplication.Qu.lza?(da.ULS.shipAssertTag(5566816,211,!!A.AFrameworkApplication.Qu.lza),a+="HostUrl,",{returnValue:A.AFrameworkApplication.za.DN(!0,A.AFrameworkApplication.Qu.lza),
F4a:a}):this.gWb?(da.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",A.AFrameworkApplication.userSessionId),a+="DocUrl,",oy.E7f(this.gWb,this.Tz,this.options,this.application,Object(R.a)(this,this.zmh,"onEditInClientSuccess"),Object(R.a)(this,this.ymh,"onEditInClientFailure"),this.DSh,A.AFrameworkApplication.fa.getBooleanAppSetting("OICEncodeUrlIsEnabled"),b,c,f,l,this.kLc,this.$ra,this.eEc,A.AFrameworkApplication.Pa.qnd,this.GKd),{returnValue:32,F4a:a}):{returnValue:8,
F4a:a}}a+="OldOrder,";if(!this.gWb&&A.AFrameworkApplication.Qu.lza)return this.UCa&&this.UCa.value&&this.UCa.value.isEnabled()&&A.AFrameworkApplication.gCc?(a+="Post,",b=this.GKh()):(da.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(da.ULS.shipAssertTag(22595484,211,!!A.AFrameworkApplication.Qu.lza),a+="HostUrl,",{returnValue:A.AFrameworkApplication.za.DN(!0,A.AFrameworkApplication.Qu.lza),F4a:a}):{returnValue:b,F4a:a};da.ULS.sendTraceTag(22595485,
211,15,"Try to open doc in rich client, SessionId {0}",A.AFrameworkApplication.userSessionId);a+="DocUrl,";oy.E7f(this.gWb,this.Tz,this.options,this.application,Object(R.a)(this,this.zmh,"onEditInClientSuccess"),Object(R.a)(this,this.ymh,"onEditInClientFailure"),this.DSh,A.AFrameworkApplication.fa.getBooleanAppSetting("OICEncodeUrlIsEnabled"),b,c,f,l,this.kLc,this.$ra,this.eEc,A.AFrameworkApplication.Pa.qnd,this.GKd);return{returnValue:32,F4a:a}}sEl(a){A.AFrameworkApplication.fj.setDw(8981,a)}zmh(a){this.sEl(a);
da.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?(this.q7l||this.tIg(),this.vKg()):this.Ncf||this.o5d()}ymh(a,b){b=void 0===b?0:b;da.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.aXb&&!this.OXb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.Ncf=!0));this.k$l.J1k?(da.ULS.sendTraceTag(18715408,
211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),fA.a.instance.f5i(this.OXb?this.ukh:this.vkh,c?this.Jnh:null,this.E5f(!1)?this.V5j:null,f,b)):(da.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),fA.a.instance.d5i(this.OXb?this.ukh:this.vkh,c?this.Jnh:null,f))}}vKg(){try{const a=[Object.assign(new pw.a,{name:"CorrelationId",string:this.$ra}),Object.assign(new pw.a,{name:"SessionOrigin",string:this.kLc}),Object.assign(new pw.a,{name:"ClickTime",string:this.eEc}),
Object.assign(new pw.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];hp.a("OpenInClientCompleted",!0,0,a)}catch(a){da.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}tIg(){A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.SD&&A.AFrameworkApplication.fa.getBooleanAppSetting("StandardProtocolDialogIsEnabled")?new Cu(this):new hA(this)}E5f(a){const b=(E.a.NXa||E.a.gp)&&!!A.AFrameworkApplication.sVc;b&&a&&(Sd.a.qo(A.AFrameworkApplication.sVc,
"_blank",void 0,"OpenInClient"),this.o5d());return b}}os.Zal="OpenInDesktop";os.Tal="OpenInBrowser";Object(m.a)(os,"AOpenInClientOperation",null,[]);class qw extends os{constructor(a,b,c){super(void 0===c?!1:c);this.Qfi=a;this.Pfi=b}get Nwg(){return this.Pfi}get ape(){return this.Qfi}ejj(){A.AFrameworkApplication.Pa.Ia(N.a.close,2,hb.a)}N$f(){}NQf(a){return this.Wsl(a)}nIg(){da.ULS.shipAssertTag(5566817,211,!!this.aXb);A.AFrameworkApplication.Rfa?A.AFrameworkApplication.za.DN(!0,this.aXb):Sd.a.qo(this.aXb,
void 0,void 0,"LaunchDownload")}gcc(){A.AFrameworkApplication.za.mb.gcc()}}Object(m.a)(qw,"OpenInClientOperation",os,[]);class vv extends qw{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");if(!a)throw Error.argumentNull("pathManager");this.L0g=b;this.te=a;this.Ep=c;this.ia=f}get czb(){return this.te.Ok(this.Mdb+".png")}get Mdb(){return"prt2"}NQf(a){return this.L0g?this.L0g(a):this.Rxb(a)}N$f(){ya.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");
this.ia.Ia(M.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}Rxb(a){this.Ep.pfc=!0;return super.Rxb(a)}}Object(m.a)(vv,"OpenInPowerPointOperation",qw,[]);class py{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.bUg=null;this.JI=u;this.ia=a;this.Fa=b;this.oa=c;this.te=f;this.K0g=new vv(this.te,Object(R.a)(this,this.YHi,"beginSaveBeforeOpenInClient"),eb,a);I.execute(Se=>{this.bUg=new Hc.a(()=>Se)});this.iQg=l;this.Kx=T;this.ZUk=ja;this.sa=
ua;this.ic=Ra;this.Ba=Bb;this.Xa=Ub;this.$ga=Xb;this.Db=tc;this.fe=lc;this.Kn=Ec;this.Mw=hd;this.zib=yd;this.Yaa=Pd;this.vS=pe}qb(){this.ia.xa(M.a.openInClient,wc.a.application,Object(R.a)(this,this.jrh,"openExternal"));this.ia.xa(N.a.lWe,wc.a.application,Object(R.a)(this,this.jrh,"openExternal"));this.ia.xa(M.a.o_f,wc.a.application,Object(R.a)(this,this.V_i,"convertBinaryFormat"));this.ia.xa(M.a.repair,wc.a.application,Object(R.a)(this,this.MDl,"repairCorruptedFile"));this.ia.xa(M.a.Zvc,wc.a.application,
Object(R.a)(this,this.Zvc,"replaceOriginalFile"));this.ia.xa(M.a.iQb,wc.a.application,Object(R.a)(this,this.iQb,"saveRepairedFile"));this.ia.xa(M.a.x8b,wc.a.application,Object(R.a)(this,this.x8b,"editAnyway"));this.ia.xa(M.a.Rbc,wc.a.application,Object(R.a)(this,this.Rbc,"goToEditMode"));this.ia.pe(M.a.openInClient,12288)}YHi(a){if(this.Kn.isPaused)return this.Fa.Gd(),this.c6e(a),32;this.oa.Bh();this.Fa.Gd();if(1===this.Db.mode&&this.Ba.SEg)return this.Kcg(a),32;this.JI.b$(a,!0,()=>{this.c6e(a)},
()=>{this.c6e(a);return!0},3);this.Kx.show(!1,"OpenInClient");return 32}c6e(a){this.Kx.hide();this.Kcg(a)}Kcg(a){$c.a.UDd();this.K0g.Rxb(a)}jrh(a,b,c){if(b.contextId!==wc.a.application)return 2;b=!(!this.te.documentUrl&&!this.iQg.lza&&!A.AFrameworkApplication.gCc);if(1===c)return b?32:8;if(!b)return 8;this.yCk();if(this.ic.Xc(this.ZUk.Of))return 16;a=a===N.a.lWe?5:2;1===this.Db.mode&&this.Ba.SEg&&(a=1);return this.K0g.begin(this.te.documentUrl,A.AFrameworkApplication.xUa,3,a,this.Ba.qmk,this.bUg,
md.a("OpenPPTTemplateInDesktopAppAsNFT")?Aa.a.AR(this.iQg.iy):"")}yCk(){try{let a="";const b=this.sa.Mk;b&&(a=b.toString());ya.a.J(509372432,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",this.sa.currentSlideIndex,a)}catch(a){ya.a.J(509372431,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}V_i(a,b,c){ya.a.J(509372430,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==wc.a.application)return 2;if(1===c)return 32;const f=
Object.assign(new eA,{PodEndpointUrl:this.Ba.podsWebServiceBase,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string});this.$ga.xFd(f,Object(R.a)(this,this.fal,"onUploadConvertedFileToHostSucceeded"),l=>{this.eal(l,f.PodSessionID)});this.Kx.Faf(!0,ResourceStrings.L_FileConverting,a);return 32}fal(a){ya.a.J(509372429,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.Kx.hide();if(this.Db)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;A.AFrameworkApplication.fa&&
(b=A.AFrameworkApplication.fa.getBooleanAppSetting("IsUIEmbedMode"),c=A.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"),f=A.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){ya.a.J(509372426,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[ok.a.WOb]="1";l[ok.a.documentUrl]=a.EditUrl;l[ok.a.mode]="edit";l[ok.a.reason]=wx.a.convert;A.AFrameworkApplication.WU().execute(u=>
{u.sendMessage(le.a.yFa,l)})}else this.Db.DN(!0,a.EditUrl)}else ya.a.J(509372427,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else ya.a.J(509372428,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}eal(a,b){a=jg.a.MJ(a.error.Bn);ya.a.J(509372425,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.Kx.hide();a=Object.assign(new vl.a,{Code:a,Source:5});this.fe.At(a,
b,c=>{c.yD=1;c.GEa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}MDl(a,b,c){if(b.contextId!==wc.a.application)return 2;if(1===c)return 32;ya.a.J(509372424,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.ODl();return 32}ODl(){const a=new Date;ya.a.J(509372423,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=$c.a.Zj("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");
this.vS.Ywb(()=>{ya.a.J(509372422,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},()=>{ya.a.J(509372421,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});
this.zib.iFh(b,()=>{ya.a.J(509372420,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.dcm()},c=>{ya.a.J(509372419,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-+a,c);b.finish();this.cml(c,this.Xa.podSessionId);return!0})}dcm(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Xa.podSessionId;a.fromInlineDocumentRepair=!0;this.Mw.H7e();
a=this.ia.Ia(M.a.dPb,2,a);ya.a.J(509372418,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}cml(a,b){a=Object.assign(new vl.a,{Code:a,Source:5});this.fe.At(a,b,c=>{c.yD=1;c.GEa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;return!1})}x8b(a,b,c,f,l){if(b.contextId!==wc.a.application)return 2;if(1===c)return 32;ya.a.J(509372417,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.Mw.ZAb();0!==a&&(ya.a.J(509372416,
801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.L1f());if(20===l)this.Mw.Shm();else return ya.a.J(509372387,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}iQb(a,b,c,f,l){if(b.contextId!==wc.a.application)return ya.a.J(509372386,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.nb(l,
1);ya.a.J(509372385,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.Sog(1,l);return 32}Sog(a,b){ya.a.J(509372384,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.Ba.podsWebServiceBase,this.Xa.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=A.AFrameworkApplication.userSessionId;const l=new Date;
A.AFrameworkApplication.Me.Tj(c,1,"",f,!1,0,u=>{this.HUe(u,l,b)},u=>{this.GUe(u,a,b)},null,null)}HUe(a,b,c){ya.a.J(509372383,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Ud).downloadUrl;Aa.a.Ta(a)?(ya.a.J(509372382,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.yTh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.Ia(c,2,b))}GUe(a,b,c){a=a.data?a.data.Ke:
-1;a===ah.a.AHi&&0<b--?(ya.a.J(509372381,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.Sog(b,c)):(ya.a.J(509372380,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",a,c),this.yTh())}yTh(){const a=Object.assign(new vl.a,{Code:20,Source:6});this.fe.At(a,this.Xa.podSessionId,b=>{b.yD=1;b.GEa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;
b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}Zvc(a,b,c){if(b.contextId!==wc.a.application)return ya.a.J(509372379,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=A.AFrameworkApplication.fa.Ea("DocumentPermissions")||"",b=this.Xa.csh&&-1<a.indexOf("W"),ya.a.J(509372378,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",
this.Xa.csh,a),b?32:8;ya.a.J(509372377,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Xa.xl=this.Yaa.Qbb(this.Xa.presentationId.string);a=Object.assign(new Yk.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ba.podsWebServiceBase,PopSessionID:this.Xa.xl,UrlOverrides:this.Ba.Pba,IsCreateNewSession:this.Ba.isCreateNew,UseSharedHostFile:this.Ba.JUb});this.Yaa.WQc(a,()=>{this.Y4k()},
Object(R.a)(this,this.fMb,"onEnsureHostSessionFailed"),0,!0);return 32}Y4k(){ya.a.J(509372376,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.Mw.uFl();this.Xa.KFl();0!==this.Mw.ZAb()&&this.Mw.I7e(!1)}fMb(){ya.a.J(509372375,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");this.Mw.H7e();0!==this.Mw.ZAb()&&this.Mw.I7e(!0);return!1}Rbc(a,b,c){if(b.contextId!==wc.a.application)return ya.a.J(509372374,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",
b.contextId),2;if(1===c)return 32;a=new Date;this.L1f();ya.a.J(509372373,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}L1f(){this.Xa.xl=this.Yaa.Qbb(this.Xa.presentationId.string);const a=Object.assign(new Yk.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ba.podsWebServiceBase,PopSessionID:this.Xa.xl,UrlOverrides:this.Ba.Pba,
IsCreateNewSession:this.Ba.isCreateNew,UseSharedHostFile:this.Ba.JUb});this.Yaa.WQc(a,()=>{this.Z4k()},null,15,!0);this.Mw.I7e(!1)}Z4k(){ya.a.J(509372372,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(m.a)(py,"PowerPointAppFrameCommandUIActor",null,[]);var Du=d(512);class kA{constructor(a,b,c){this.ZMg=a;this.W1=b;this.dIb=c}show(a,b){this.dIb?(b=new Du.a(b),b.message=ResourceStrings.l_Saving,b.kCg=!0,b.fSb=a,this.W1.JMa(b)):this.Faf(a,ResourceStrings.l_Saving,
b)}Faf(a,b,c){this.dIb?(c=new Du.a(c),c.message=b,c.fSb=a,this.W1.JMa(c)):this.ZMg.hSb(b,a,0,0,c)}hide(){this.dIb?this.W1.JMa(Object.assign(new Du.a(null),{jCg:!0})):this.ZMg.X3c()}}Object(m.a)(kA,"SaveBlockingUI",null,[901]);var Dr=d(241);class Eu{constructor(a,b,c,f,l,u,I,T,ja){this.Mlc=ad.App.Xn;this.q_g=Ua.a.nil;this.zb=a;this.sa=b;this.Nc=c;this.jh=f;this.iN=l;this.qjd=u;this.uB=T;this.Us=I;this.NMk=ja.kKl;this.FNk=ja.pptNotShowSavingStatusOfProofingOnlyRevision;this.Nc.aC(Object(R.a)(this,this.KF,
"onSessionEnd"));this.jh.XZd(Object(R.a)(this,this.z3h,"updateSavingStatus"));this.jh.hMf(Object(R.a)(this,this.y3h,"updateSavedStatus"));this.Us.QH(Object(R.a)(this,this.Bra,"updateSaveStatusDisplay"));this.iUk=new ne.a(3,1,ja.jKl,Object(R.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),90,"28");this.kye=!1;this.Ohd=ja.powerPointTextEditOnlyMode}initialize(){this.Bra(this.Us)}y3h(){this.kye||this.uB.s1||this.uB.vFg||(this.zb.Jb(this.iUk),this.kye=!0)}z3h(a,b){this.uB.s1||this.uB.vFg||(this.FNk&&
Eu.Aok(b.node)||this.qjd.updateSaveStatusText(!1),this.Mlc=new Date,this.q_g=b?b.revisionId:Ua.a.nil)}updateSaveStatusText(){this.kye=!1;const a=!this.iN.pY(this.sa.presentation);this.qjd.updateSaveStatusText(a);a&&(this.tFh(0,0),this.Mlc=ad.App.Xn);this.Ohd&&Eu.gim(a)}Bra(a){this.qjd.Bra(!1,1===a.mode?1:3)}KF(a,b){this.qjd.updateSaveStatusText(!0);this.tFh(1,b.uE);this.Mlc=ad.App.Xn}tFh(a,b){if(this.Mlc!==ad.App.Xn){var c=+new Date-+this.Mlc;c>=this.NMk&&(c=String.format("SavingTime {0};Type {1};Revision {2};",
c,a,this.q_g),1===a&&(c+=String.format("CloseReason {0};",b)),ya.a.J(21604228,811,50,c))}}dispose(){this.Nc.F7(Object(R.a)(this,this.KF,"onSessionEnd"));this.jh.n3e(Object(R.a)(this,this.z3h,"updateSavingStatus"));this.jh.rEh(Object(R.a)(this,this.y3h,"updateSavedStatus"));this.Us.a_(Object(R.a)(this,this.Bra,"updateSaveStatusDisplay"))}static gim(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display="block";
a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static Aok(a){return a.Qa(yb.a.Nsd)&&!a.Qa(Dr.a.axd)}}Object(m.a)(Eu,"SaveStatusManager",null,[106]);class qy{constructor(){this.K=null;this.WJe=!1}get name(){return"PowerPointWebEditor.Actors"}fc(a){(new rt).fc(a);this.K=a;a.register(py,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().na(()=>new py(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ha("Postmessage.IHostPostmessenger"),a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(901,"PowerPointWebEditor.ISaveBlockingUI").ma().na(()=>new kA(new dA(new cA(a.resolve("PowerPointWebEditor.IPaneManager").va,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").RDg));a.register(Eu,"PowerPointWebEditor.SaveStatusManager").ma().na(()=>new Eu(a.resolve("Common.ITaskManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.WJe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").bok)&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").qb();this.K.resolve("Common.IOfficeTrialExperience").qb();this.K.resolve("Common.IMacOfficeOffer").qb()}dispose(){this.WJe&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){C.a.instance.Ac(new qy)}}Object(m.a)(qy,"PowerPointActorsPackage",null,[2,3]);var DC=d(1077),rw=d(1140);class ry{constructor(){this.lta=this.eU=this.ICa=null;
this.JFf=!1;this.rnf=null;this.snf=this.XZb=0}get messageId(){return this.ICa}get values(){return this.eU}get userSessionId(){return this.lta}get gAd(){return this.JFf}get hNc(){return this.rnf}get Mya(){return this.XZb}get esi(){return this.snf}static g6i(a,b){var c=void 0===c?le.a.H9i:c;var f=void 0===f?1E3:f;const l=new ry;l.ICa=a;l.eU={};l.lta=b;l.JFf=!0;l.rnf=c;l.XZb=3;l.snf=f;return l}}Object(m.a)(ry,"PostMessageData",null,[]);class wv{constructor(a,b,c){this.gWd={};this.La=a;this.dNd=c;this.eyk();
this.vvl(b)}eyk(){if(this.La.getBooleanAppSetting("DocRebootIsSupported")||this.La.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"))this.gWd[rw.a.refresh]=()=>this.TMl(le.a.yFa)}vvl(a){a.xa(N.a.Vyh,Le.a.frame,Object(R.a)(this,this.kMl,"sendActionToHostIfSupported"))}kMl(a,b,c,f,l){if(2!==c)return 32;if(!l)return da.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.gWd[a]?(da.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",
a),this.gWd[a]()):2}TMl(a){const b=ry.g6i(a,A.AFrameworkApplication.userSessionId);this.dNd.execute(c=>{c.postMessage(b)});return 32}}Object(m.a)(wv,"HostActionExecutionManager",null,[]);var sw=d(124),tw=d(748);class sy extends ow.a{constructor(a,b,c,f){super(a,b,c);this.kYb=this.J8=0;this.yuf=!1;this.mYb=0;this.cNd=this.HGc=null;this.zuf=this.Auf=!1;this.r5j=l=>{const u=l.message,I=l.Uj.origin;A.AFrameworkApplication.wopiHostOriginFromPostMessage||(A.AFrameworkApplication.wopiHostOriginFromPostMessage=
I);switch(u.MessageId){case le.a.c2d:case le.a.e2d:this.l5j(u);break;case le.a.ome:case le.a.pme:this.aEd();break;case le.a.yoe:this.t5j(u);break;case le.a.rfb:this.guk(u);break;case le.a.Xif:this.PHi(l);break;case le.a.bjf:this.Kfm()}};this.hfm=l=>{switch(l.MessageId){case le.a.uoe:A.AFrameworkApplication.Pa.Ia(N.a.iwd,2,l.Values[ok.a.direction]);break;case le.a.JCb:da.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");A.AFrameworkApplication.Pa.Ia(N.a.JCb,2,(new Date).getTime());break;case le.a.voe:da.ULS.sendTraceTag(544221062,
204,50,"We received HostBackButtonPressed message in WAC");break;case le.a.woe:da.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");A.AFrameworkApplication.Pa.nb(N.a.pwj,2);break;case le.a.Xcc:da.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");A.AFrameworkApplication.Pa.nb(N.a.Xcc,2);break;case le.a.xoe:da.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");A.AFrameworkApplication.Pa.nb(N.a.SRj,2);break;case le.a.Boe:da.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received")}};
this.Zcj=(l,u,I)=>{if(2!==I)return 32;sw.a.Iz(this);return 32};this.Ca=f;this._name="HostIntegrationMessenger";this.create()}aEd(){F.FocusManager.instance()&&F.FocusManager.instance().Je&&F.FocusManager.instance().Je.name===A.AFrameworkApplication.wlb&&F.FocusManager.instance().P2(F.FocusManager.instance().Je.name)}l5j(a){F.FocusManager.instance().dW(A.AFrameworkApplication.wlb,!1);if(ok.a.lyc in a.Values){const b={};b[ok.a.lyc]=a.Values[ok.a.lyc];da.ULS.sendTraceTag(38278996,204,50,Fe.c(b))}}t5j(a){if(!oe.a.VO(document.URL,
A.AFrameworkApplication.Imd)&&a.Values){var b=0,c=0;try{b=a.Values[ok.a.u5j],c=a.Values[ok.a.v5j],ok.a.Uvg in a.Values?this.HGc=a.Values[ok.a.Uvg]:ok.a.Vvg in a.Values&&(this.HGc=a.Values[ok.a.Vvg]),ok.a.Wvg in a.Values&&(this.cNd=a.Values[ok.a.Wvg])}catch(f){return}this.kYb=b;this.mYb=c;this.J8&&this.cKg()}}guk(a){da.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");var b=a.Values[ok.a.q5j];b&&xe.a.instance.Qtl(b);(b=a.Values[ok.a.e5d])&&xe.a.instance.Dtl(b);(a=a.Values[ok.a.rfb])&&xe.a.instance.Xtl(a)}PHi(a){da.ULS.sendTraceTag(40433733,
338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now());A.AFrameworkApplication.UEb=!0;A.AFrameworkApplication.za.w3.zTe(a.Uj.hc)}Kfm(){da.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());A.AFrameworkApplication.za.w3.fVe(null,Sys.EventArgs.Empty)}cKg(){this.NAk();this.OAk();null!=this.HGc&&xe.a.instance.Stl(this.HGc);null!=this.cNd&&xe.a.instance.Ttl(this.cNd)}NAk(){this.J8&&this.kYb&&!this.yuf&&(this.yuf=!0,this.kYb>this.J8||(A.AFrameworkApplication.fj.setDw(10324,
this.J8-this.kYb),xe.a.instance.bBh(this.kYb)))}OAk(){this.J8&&this.mYb&&!this.Auf&&(this.Auf=!0,this.mYb>this.J8||(A.AFrameworkApplication.fj.setDw(10325,this.J8-this.mYb),xe.a.instance.zul(this.mYb)))}qEl(){var a=Sd.a.Kqg();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.J8||A.AFrameworkApplication.fj.setDw(11045,this.J8-b)}}create(){A.AFrameworkApplication.TAg&&this.disable();this.nOa!==tw.a.r3b&&this.ODa(this.nOa);this.Ca.pa(N.a.Tcj,Le.a.frame,this.Zcj,96);this.Bv(le.a.c2d);
this.Bv(le.a.e2d);this.Bv(le.a.ome);this.Bv(le.a.pme);this.Bv(le.a.yoe);this.Bv(le.a.Aoe);this.Bv(le.a.b0d);const a=this.r5j;this.p2a(le.a.c2d,a);this.p2a(le.a.e2d,a);this.p2a(le.a.ome,a);this.p2a(le.a.pme,a);this.p2a(le.a.yoe,a);A.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteEmbedUnloadIsEnabled")&&(this.oJf(le.a.Xif),this.oJf(le.a.bjf),this.p2a(le.a.Xif,a),this.p2a(le.a.bjf,a));if(A.AFrameworkApplication.fa.getBooleanAppSetting("PostMessageEmbedded")||A.AFrameworkApplication.fa.getBooleanAppSetting("IsJsApi")){this.Bv(le.a.JCb);
const b=this.hfm;A.AFrameworkApplication.fa.getBooleanAppSetting("SupportsAccessibilityLoop")&&(this.Bv(le.a.uoe),this.dD(le.a.uoe,b));this.dD(le.a.JCb,b);A.AFrameworkApplication.fa.getBooleanAppSetting("MobileEmbedViewerIsEnabled")&&(this.Bv(le.a.woe),this.dD(le.a.woe,b),this.Bv(le.a.voe),this.dD(le.a.voe,b),this.Bv(le.a.Xcc),this.dD(le.a.Xcc,b),this.Bv(le.a.xoe),this.dD(le.a.xoe,b));A.AFrameworkApplication.fa.getBooleanAppSetting("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.Bv(le.a.Boe),
this.dD(le.a.Boe,b))}A.AFrameworkApplication.fa.getBooleanAppSetting("IsJsApi")&&(this.Bv(le.a.rfb),this.p2a(le.a.rfb,a))}reportDocumentLoadedTime(a){this.zuf||(this.J8=a,this.qEl(),this.nOa!==tw.a.r3b&&this.sendMessage(le.a.CDi,{["DocumentLoadedTime"]:a}),this.cKg(),this.zuf=!0)}}Object(m.a)(sy,"HostIntegrationMessenger",ow.a,[224,225,106]);class lA{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){da.ULS.sendTraceTag(508381087,204,50,"Calling init for PostMessenger {0}",
Date.now());A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnablePostMessengerPkgIndependentofFullAppSettingsReady",!1)?(da.ULS.sendTraceTag(508372251,204,50,"Initializing PostMessenger Package at {0}",Date.now()),this.J4c(this.Da)):A.AFrameworkApplication.fa.Ue(()=>{da.ULS.sendTraceTag(508389594,204,50,"Initializing PostMessenger Package on Full App setting Ready at {0}",Date.now());this.J4c(this.Da)})}J4c(a){A.AFrameworkApplication.LR=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");
A.AFrameworkApplication.fa.getBooleanAppSetting("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}fc(a){this.Da=a;a.register(sy,"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().na(()=>{A.AFrameworkApplication.fa.sY||da.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=A.AFrameworkApplication.dqa?A.AFrameworkApplication.dqa:tw.a.r3b;da.ULS.sendTraceTag(536987587,
204,50,"HostIntegrationMessenger instantiating");return new sy(window.parent,b,DC.a.instance,A.AFrameworkApplication.Pa)});a.register(wv,"Common.App.HostActionExecutionManager").ma().na(()=>{A.AFrameworkApplication.fa.sY||da.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new wv(A.AFrameworkApplication.fa,A.AFrameworkApplication.Pa,a.Ha("Postmessage.IHostPostmessenger"))})}}Object(m.a)(lA,"PostmessengersPackage",null,[2,3]);var ty=
d(416),Rn=d(321),dl=d(279),Eg=d(218);class ps extends Eg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(ps,"PersonaButtonProps",Eg.a,[]);class uy{S6b(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new dl.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.o3i(a,c.ControlList);b.push(c)}}o3i(a,b){const c=Object.assign(new ty.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Rn.a,
{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new dl.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,b);this.B5i(a,b.ControlList)}B5i(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new ps,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}
Object(m.a)(uy,"PresenceContextMenuSectionBuilder",null,[480]);var Fu=d(358);class Pm{constructor(a,b,c,f){this.O_=this.so=this.Wn=this.Nf=this.Pra=null;this.aHi=()=>{this.yLc.qQf()};this.Y4=l=>{1===l?(Fu.a.Crd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),A.AFrameworkApplication.Pa.nb(N.a.Eze,2)):(this.p_l(),A.AFrameworkApplication.Pa.nb(N.a.iVf,2))};this.aMi=()=>{this.kcj();A.AFrameworkApplication.Pa.nb(N.a.hVf,2)};this.yLc=a;this.toi=f;this.yLc.gue&&(this.Wn=new ne.a(3,
2,5E3,this.aHi,2),A.AFrameworkApplication.Be.Jb(this.Wn),this.qb(b,c));this.yLc.wxi(()=>{this.Lqc()});this.yLc.nLf(()=>{this.Mqc()})}get businessBar(){return this.so||(this.so=Tb.a.instance.ub("CommonUI.IBusinessBar"))}get FSf(){return this.O_||(this.O_=Tb.a.instance.ub("CommonUI.IBusinessBarEntryFactory"))}qb(a,b){const c=A.AFrameworkApplication.Pa;c.pa(N.a.rQf,Le.a.frame,a,96);c.pa(N.a.sQf,Le.a.frame,b,96);c.xa(N.a.hVf,Le.a.frame,ff.ActionManager.vw);c.xa(N.a.iVf,Le.a.frame,ff.ActionManager.vw);
c.xa(N.a.Eze,Le.a.frame,ff.ActionManager.vw)}Lqc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);A.AFrameworkApplication.Pa.nb(N.a.rQf,2)}Mqc(){this.l9l();A.AFrameworkApplication.Pa.nb(N.a.sQf,2)}l9l(){this.Nf&&(this.Nf.hide(),this.Nf.dispose(),this.Nf=null);this.Pra&&this.businessBar&&(A.AFrameworkApplication.Dh||this.businessBar.removeEntry(this.Pra),this.Pra.dispose(),this.Pra=null)}showDialog(a){sw.a.Iz(this.Nf);this.Nf=new Ij.StandardDialog;this.toi||(this.Nf.Is=!1,this.Nf.Fd=
0);this.Nf.Te(1,CommonUIStrings.l_SignIn);this.Nf.vQ(CommonUIStrings.l_DefaultDialogTitle,a,this.Y4)}p_l(){this.businessBar&&this.FSf&&(this.Pra=this.FSf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Pra.closeable=!0,this.Pra.addButton(CommonUIStrings.l_SignIn,Pm.$Li,""),this.Pra.xU=this.aMi,this.businessBar.Ei(this.Pra,!1))}kcj(){this.Wn&&(A.AFrameworkApplication.Be.Vg(this.Wn),this.Wn=null)}dispose(){this.Wn=this.Nf=this.Pra=null}static $Li(){Fu.a.Crd();
A.AFrameworkApplication.Pa.nb(N.a.Eze,2)}}Object(m.a)(Pm,"SignOutResponseUI",null,[106]);class zn{get name(){return"Common.App.UI"}fc(a){a.register(uy,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){sw.a.Iz(zn.Oda);zn.Oda=null}static main(){C.a.instance.Ac(new zn)}static m9j(a,b,c){zn.b_l()&&(zn.Oda=new Pm(Fu.a.instance,a,b,c))}static b_l(){return A.AFrameworkApplication.Pih&&!A.AFrameworkApplication.isEmbedded}}zn.Oda=
null;Object(m.a)(zn,"CommonAppUIPackage",null,[2,3]);class Sn{constructor(a){this.fDa=this.ZCa=this.kDa=this.jDa=null;this.cuf=this.krf=this.euf=this.eyf=this.RQ=this.sda=!1;this.UTd=this.wyf=null;this.pyf=0;this.La=this.uyf=null;this.Bja=a;this.zH=3;this.Bsb=!0}initialize(a,b,c){this.jDa=this.mke(a,b);this.kDa=CommonUIStrings.l_SavingStatus;this.ZCa=CommonUIStrings.l_ReadOnlyStatus;this.fDa=CommonUIStrings.l_ReviewModeStatus;this.Bja&&this.Bja.execute(f=>{f.vvb(Object(R.a)(this,this.$Bc,"updateToSavingStatus"))});
this.RQ=!0;this.La=c;this.krf=this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}Bra(a,b){this.sda=a;this.zH=b;this.updateSaveStatusText(this.Bsb)}updateSaveStatusText(a){!this.Bsb&&a&&(this.uyf=new Date);this.Bsb=a;this.cuf=!1;a=null;3===this.zH&&(a=this.Bsb?this.jDa:this.kDa);this.Bcj(a)}mke(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):
CommonUIStrings.l_SavedStatus}$Bc(){this.updateSaveStatusText(!1)}IFj(){switch(this.zH){case 1:return this.ZCa;case 2:return this.fDa;default:return null}}HFj(){if(3!==this.zH)switch(this.zH){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.cuf?"FailedToSave":this.Bsb?"Saved":"Saving"}mhk(a){return this.eyf===this.sda&&this.pyf===this.zH&&this.wyf===a}P$d(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.sda,a,this.IFj(),this.uyf,this.Bsb,this.krf?
b.getHeaderSaveStatusIconProps(this.HFj()):null);this.euf=!0;return null});this.UTd=null}Bcj(a){this.RQ&&fh.c()&&!this.mhk(a)&&(!this.euf&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.P$d(a):Sd.a.t4e()?(this.UTd&&da.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.UTd=window.requestIdleCallback(()=>{this.P$d(a)})):window.requestAnimationFrame(()=>{this.P$d(a)}),this.eyf=this.sda,this.wyf=
a,this.pyf=this.zH)}}Object(m.a)(Sn,"ReactSaveStatusUIHandler",null,[1794]);class Gu{constructor(a,b){this.LR=null;this.jDa=CommonUIStrings.l_SavedStatus;this.kDa=CommonUIStrings.l_SavingStatus;this.ZCa=CommonUIStrings.l_ReadOnlyStatus;this.fDa=CommonUIStrings.l_ReviewModeStatus;this.yCa=b;this.Bja=a;this.zH=3;this.MRa=!0}nQ(){this.Bja&&this.Bja.execute(a=>{a.vvb(Object(R.a)(this,this.$Bc,"updateToSavingStatus"))});this.yCa.execute(a=>{this.LR=a})}Bra(a,b){this.zH=b;3===b?this.updateSaveStatusText(this.MRa):
2===b?this.sgf(this.fDa):this.sgf(this.ZCa)}$Bc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.MRa=a;this.sgf(this.MRa?this.jDa:this.kDa)}sgf(a){this.LR&&this.LR.sendMessage(le.a.ffm,this.OZi(a))}OZi(a){const b={};b.StatusText=a;return b}}Object(m.a)(Gu,"SaveStatusPostMessageHandler",null,[1794]);var xm=d(270);class uw{constructor(a,b,c,f){this.fDa=this.ZCa=this.kDa=this.jDa=null;this.C7a=0;this.XQ=this.EUd=this.H5a=this.RHd=this.ZWd=null;this.xf=a;this.psa=b;this.Bja=c;this.Ll=f;this.gwf=
!0;this.sda=!1;this.zH=3;this.MRa=!0}initialize(a,b){if(!this.xf)return!1;this.jDa=this.mke(a,b);this.kDa=CommonUIStrings.l_SavingStatus;this.ZCa=CommonUIStrings.l_ReadOnlyStatus;this.fDa=CommonUIStrings.l_ReviewModeStatus;this.nQ();return!0}mke(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}nQ(){this.psa&&this.psa.execute(a=>{a.Qzi(Object(R.a)(this,this.j2f,"createStatusAndModeElements"));
a.wzi(Object(R.a)(this,this.x0l,"showHideSaveStatusElement"));a.Sam&&this.j2f(null,null)});this.Bja&&this.Bja.execute(a=>{a.vvb(Object(R.a)(this,this.$Bc,"updateToSavingStatus"))})}yBa(){this.XQ&&this.xf&&this.xf.DEd(this.XQ)}x0l(a,b){this.Bra("true"===b,this.zH)}Bra(a,b){this.sda=a;this.zH=b;this.RHd&&(this.RHd.style.display=this.sda||3===this.zH||!this.ZWd?"none":"");this.H5a&&(this.H5a.style.display=this.sda||3===this.zH?"none":"",this.H5a.innerText=1===this.zH?this.ZCa:this.fDa,this.H5a.title=
1===this.zH?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.EUd&&(this.EUd.style.display=this.sda||1===this.zH||!this.ZWd&&!this.H5a?"none":"");this.XQ&&(this.XQ.style.display=this.sda||1===this.zH?"none":"",this.updateSaveStatusText(this.MRa),this.XQ.title=CommonUIStrings.l_SaveStatusTooltip)}j2f(a,b){a=document.getElementById(xm.CuiHelper.i2j);b&&b.Nom||!a||""===this.jDa||""===this.kDa||""===this.ZCa||""===this.fDa||(this.ZWd=document.getElementById(xm.CuiHelper.q2d),
this.RHd=xm.CuiHelper.tTc(a,"BreadcrumbAppModeDash","-"),this.H5a=xm.CuiHelper.tTc(a,"BreadcrumbAppModeStatus",1===this.zH?this.ZCa:this.fDa),this.k2h(this.H5a),this.EUd=xm.CuiHelper.tTc(a,"BreadcrumbSaveStatusDash","-"),this.XQ=xm.CuiHelper.tTc(a,"BreadcrumbSaveStatus",this.jDa),this.k2h(this.XQ),this.Bra(this.sda,this.zH))}$Bc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.MRa=a;this.akm(this.MRa?this.jDa:this.kDa)}akm(a){!this.XQ||3!==this.zH&&2!==this.zH||(this.gwf&&!this.MRa?(this.C7a=
this.XQ.offsetWidth<this.C7a?this.C7a:this.XQ.offsetWidth,this.Pgm(this.kDa),this.gwf=!1):this.XQ.innerText=a)}k2h(a){a.style.direction=this.Ll?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Ll?"right":"left";a.style.display=this.sda?"none":"";a.setAttribute("Unselectable","on")}Pgm(a){this.XQ&&(this.XQ.style.width="",this.XQ.innerText=a,this.C7a=this.XQ.offsetWidth<this.C7a?this.C7a:this.XQ.offsetWidth,a=fg.a.Tu(this.XQ),this.XQ.style.width=this.C7a-za.a.LN(a.paddingLeft)-za.a.LN(a.paddingRight)+
1+"px")}}Object(m.a)(uw,"SaveStatusUIHandler",null,[1794]);class mA{constructor(){this.FUd=this.ATd=this.H0b=this.Da=null;this.Pn=()=>{const a=A.AFrameworkApplication.fa,b=!!A.AFrameworkApplication.za.mb&&4===A.AFrameworkApplication.za.mb.Ej;if(a.getBooleanAppSetting("WordEditorAutoSaveImprovementIsEnabled")||a.getBooleanAppSetting("PptEditorSaveStatusInHeaderEnabled")||b&&a.getBooleanAppSetting("SimplifiedReactRibbonUxIsEnabled")||a.getBooleanAppSetting("ExcelSaveStatusInHeaderEnabled")||a.getBooleanAppSetting("VisioSaveStatusInHeaderEnabled"))A.AFrameworkApplication.fa.getBooleanAppSetting("PostMessageEmbedded")&&
A.AFrameworkApplication.fY?(this.FUd=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.FUd.nQ():A.AFrameworkApplication.za.mb.bGg||A.AFrameworkApplication.hideHeader||(A.AFrameworkApplication.za.mb.mP?(this.ATd=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.ATd.initialize(a.getBooleanAppSetting("IsSkyDrive"),a.Ea("HostNameToIncludeInSavedStatus"),A.AFrameworkApplication.fa):(this.H0b=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.H0b.initialize(a.getBooleanAppSetting("IsSkyDrive"),a.Ea("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}fc(a){this.Da=a;A.AFrameworkApplication.fa.getBooleanAppSetting("PostMessageEmbedded")&&A.AFrameworkApplication.fY?this.Da.register(Gu,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new Gu(this.Da.Ha("Common.App.HostNotification.EditNotificationEventSource"),this.Da.Ha("Postmessage.IHostPostmessenger"))):
A.AFrameworkApplication.za.mb.bGg||(A.AFrameworkApplication.za.mb.mP?this.Da.register(Sn,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new Sn(this.Da.Ha("Common.App.HostNotification.EditNotificationEventSource"))):this.Da.register(uw,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new uw(Ie.EventHandlerManager.instance,this.Da.Ha("Common.App.Header.HeaderEventSource"),this.Da.Ha("Common.App.HostNotification.EditNotificationEventSource"),
A.AFrameworkApplication.isRtl)))}init(){A.AFrameworkApplication.fa.Ue(this.Pn)}dispose(){this.H0b&&this.H0b.yBa()}}Object(m.a)(mA,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2023-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:49,PercentageDenominator:1E4,
NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1",
"nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCih_e1uFIbpMs9-LxFTE8VpUQzhMTzNBRDJRWTMwMkM1T0tCSzQxRTI5Ti4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:1,NominationScheme:{Type:0,
PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",
RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCih_e1uFIbpMs9-LxFTE8VpUQzRMVFFWVERHVVgzRzNMTFc3U0taNTZGOC4u"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,
NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",
RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:166,PercentageDenominator:1E4,NominationPeriod:{Type:0,
IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2",
"nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrqS6vMqN69DhDipYQ7GG0BUQkU0RkYxUFEzTEJINlNaR0RDUTNDMzZHUC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",
RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",
RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",
RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,
IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3",
"CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied",
"4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,
Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",
EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",
YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,
NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",
RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"5b3d20e1-9515-435f-91cd-84ec2a06346b",StartTimeUtc:"2023-05-18T07:00:00Z",EndTimeUtc:"2023-10-31T07:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:259200},CooldownPeriod:{Type:0,
IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"NewDefaultThemeActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"NewTheme_PromptTitle",Question:"NewTheme_PromptQuestion",YesLabel:"NewTheme_Sure",NoLabel:"NewTheme_NotNow"},Rating:{Question:"NewTheme_PPT_RatingQuestion",RatingValuesAscending:["NewTheme_RatingValue1","NewTheme_RatingValue2","NewTheme_RatingValue3","NewTheme_RatingValue4","NewTheme_RatingValue5"]},
Question:{Question:"NewTheme_VerbatimQuestion"}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,
Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},
{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",
Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",
EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4",
"FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},
{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",
Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,
Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,
Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},
{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,
Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,
Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",
YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,
Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,
surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),title1:"Never lose your work",
description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Ribbon-InsertAddInFlyout']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-06-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}},{CampaignId:"c855ff69-ff13-48f9-83b8-e76d1b65ee6a",
StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InsertPicture",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"PPTO_Picture_FloodgatePromptTitle",
Question:"PPTO_Picture_FloodgatePromptQuestion",YesLabel:"PPTO_Picture_FloodgatePrompt_YesLabel",NoLabel:"PPTO_Picture_FloodgatePrompt_NoLabel"},Rating:{Question:"PPTO_Picture_FloodgateRatingQuestion",RatingValuesAscending:["PPTO_Picture_FloodgateRating_1","PPTO_Picture_FloodgateRating_2","PPTO_Picture_FloodgateRating_3","PPTO_Picture_FloodgateRating_4","PPTO_Picture_FloodgateRating_5"]},Question:{Question:"PPTO_Picture_FloodgateWhyQuestion"}}}},{CampaignId:"1716b3a6-4d13-486e-a86a-6fb3f55f296a",
StartTimeUtc:"2023-04-10T00:00:00Z",EndTimeUtc:"2023-09-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:80,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SingleLineToolBarFPS",IsAggregate:!0,Count:4}]},Content:{Prompt:{Title:"Toolbar_Floodgate_Prompt_Line1",Question:"Toolbar_Floodgate_Prompt_Line2",
YesLabel:"Toolbar_Floodgate_Prompt_Affirmative_Answer",NoLabel:"Toolbar_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"Toolbar_Floodgate_Rating_Question",RatingValuesAscending:["Toolbar_Floodgate_Rating_Scale_1","Toolbar_Floodgate_Rating_Scale_2","Toolbar_Floodgate_Rating_Scale_3","Toolbar_Floodgate_Rating_Scale_4","Toolbar_Floodgate_Rating_Scale_5"]},Question:{Question:"Toolbar_Floodgate_Comment_Question"}}}},{CampaignId:"45f045b2-3824-42a5-b44b-1c33cbb2b81e",StartTimeUtc:"2023-04-25T00:00:00Z",
EndTimeUtc:"2023-08-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"SingleLineToolBarOptOut",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"ToolbarOptOut_Floodgate_Prompt_Line1",Question:"ToolbarOptOut_Floodgate_Prompt_Line2",YesLabel:"ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer",
NoLabel:"ToolbarOptOut_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"ToolbarOptOut_Floodgate_Rating_Question",RatingValuesAscending:["ToolbarOptOut_Floodgate_Rating_Scale_1","ToolbarOptOut_Floodgate_Rating_Scale_2"]},Question:{Question:"ToolbarOptOut_Floodgate_Comment_Question"}}}},{CampaignId:"5865d128-bec5-4fdc-9031-067f4caeca4f",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2023-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:166,PercentageDenominator:1E4,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},
Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCih_e1uFIbpMs9-LxFTE8VpUOTdPWE9TQlVSMzRRMklBVE5XQVowSUE3OC4u"}}}}];var vw=d(682);class nA{$fg(){return null}Kvj(){return Fe.c(window.PPTCampaignsObj_FromAppPackage)}Ple(a){return vw.a.Ple(a,"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}
Object(m.a)(nA,"PowerPointFeedbackAppData",null,[742]);class vy{constructor(){this.Da=null}fc(a){this.Da=a;a.register(742,"Common.App.IAppSpecificFeedbackData").ma().na(()=>new nA)}init(){this.Da.ub("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){C.a.instance.Ac(new vy)}}Object(m.a)(vy,"PPTWebEditorFeedbackPackage",null,[2,3]);class ww{get name(){return"Box4.ListEditors"}fc(){}init(){}dispose(){}static main(){C.a.instance.Ac(new ww)}}Object(m.a)(ww,
"Box4ListEditorsPackage",null,[2,3]);var Gj=d(144),Yj=d(121);const xw=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class oA{constructor(a){this.TXd=this.JMd=!1;this.PPa=null;this.Xof=!1;this.P3=null;this.rda=!1;this.$3k=b=>{b.hc&&b.hc.target&&"input"===b.hc.target.tagName.toLowerCase()&&F.FocusManager.instance().PF("ribbon");return!1};this.jmi=a;Ta.a.instance.xb(la.a.mouseDown,this.$$b(),this.$3k);(a=Tb.a.instance.Ha("Common.IActionContextProvider"))&&a.execute(b=>
{this.P3=b});A.AFrameworkApplication.fa.getBooleanAppSetting("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&A.AFrameworkApplication.za.mb.mP?Cd.a.get_instance().Ij(16,()=>{this.Bg?this.initializeContextualUI(this.$$b()):Cd.a.get_instance().Ij(7,()=>{this.initializeContextualUI(this.$$b())})}):Cd.a.get_instance().Ij(7,()=>{this.initializeContextualUI(this.$$b())})}get hwa(){return this.rda}get Bg(){return A.AFrameworkApplication.fa.getBooleanAppSetting("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
A.AFrameworkApplication.za.mb.mP?Cd.a.get_instance().isCompleted(16)&&Cd.a.get_instance().isCompleted(7):Cd.a.get_instance().isCompleted(7)}PPi(){if(this.Xof)return!0;try{return Promise.resolve(null),this.Xof=!0}catch(a){return!1}}Kgf(a){if(!this.Bg||this.TXd)return this.WAe("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.PPi())return this.WAe("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(A.AFrameworkApplication.SVc||""!==A.AFrameworkApplication.i8b)if(!A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",
!1)||"DocGen"===A.AFrameworkApplication.i8b||"ContentAssemblyView"===A.AFrameworkApplication.i8b)return this.WAe("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.TXd=!0;let b=N.a.Ce;switch(a){case 1:b=N.a.showContextMenu;break;case 0:b=N.a.showFloatie;break;case 2:b=N.a.yAd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.TXd=!1;hp.c(b)},0)});return!1}Jqg(a){return Gj.UISurfaces.mGa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=
b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f){f=void 0===f?null:f;this.Kgf(0)||this.Jqg(b).then(l=>{if(0>=l.length)return null;this.g9e(l).then(()=>{const u={};u.target=a;Gj.UISurfaces.mGa().then(I=>{appChrome.api.dispatch(I.showFloatie(u,c,void 0,this.Vie(),f));this.rda=!0;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&A.AFrameworkApplication.Pa&&
A.AFrameworkApplication.Pa.nb(N.a.lzk,2);return null})});return null})}showContextMenu(a,b,c,f){c=void 0===c?null:c;f=void 0===f?null:f;this.Kgf(1)||this.jRh(a,b,c,f)}jRh(a,b,c,f){c=void 0===c?null:c;f=void 0===f?null:f;this.g9e(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);Gj.UISurfaces.mGa().then(u=>{appChrome.api.dispatch(u.showContextMenu(l,b,c,void 0,this.Vie()));return null})})}GAa(a,b,c){var f=void 0===f?null:f;this.Kgf(2)||this.Jqg(b).then(l=>{0>=l.length?this.jRh(a,c,f):
this.g9e(l).then(()=>{const u={};u.target=a;const I={};I.target=a;Gj.UISurfaces.mGa().then(T=>{appChrome.api.dispatch(T.showContextualUI(u,I,c,void 0,f,this.Vie()));this.rda=!0;return null})});return null})}WAe(a){da.ULS.sendTraceTag(561394519,340,15,a)}M$d(){this.Bg&&Gj.UISurfaces.isLoaded()&&Gj.UISurfaces.mGa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());return null})}$E(){this.Bg&&Gj.UISurfaces.isLoaded()&&Gj.UISurfaces.mGa().then(a=>{this.rda=!1;appChrome.api.dispatch(a.hideFloatie());
return null})}X7b(){this.Bg&&Gj.UISurfaces.isLoaded()&&Gj.UISurfaces.mGa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.rda=!1;return null})}initializeContextualUI(a){return Gj.UISurfaces.mGa().then(b=>{this.JMd||(b.initializeContextualUI(a),this.JMd=!0);return null})}g9e(a){if(!this.JMd)return this.initializeContextualUI(this.$$b()).then(()=>{this.setActiveFloatieGroups(a);return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=
[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];Gj.UISurfaces.mGa().then(f=>{c.push.apply(c,this.jmi.UOb.C2c(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}$$b(){if(this.PPa)return this.PPa;this.PPa=xw("div");this.PPa.id="ReactContextualUIDiv";this.PPa.style.position="absolute";this.PPa.style.zIndex="1001";document.body.insertBefore(this.PPa,document.body.firstChild);return this.PPa}Vie(){return this.P3?this.P3.contentType:
"Unknown"}}Object(m.a)(oA,"ReactContextualUILauncher",null,[673]);var Hj=d(132);class wy{constructor(a){this.r0b=a}create(a,b){const c=new Sys.StringBuilder;this.W6b(c,a,b);this.Q7d(c,a);return c.toString()}eu(a,b){const c=[];this.v8d(c,a,b);this.R7d(c,a);return c}W6b(a,b,c){switch(b.errorType){case 0:a.append(this.r0b.build());break;case 1:case 2:a.append(this.y2d(b,c))}}v8d(a,b,c){switch(b.errorType){case 0:a.push(this.r0b.lSf());break;case 1:case 2:a.push(this.jKi(b,c))}}Q7d(a,b){U.a.instance.ga(92)||
(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(Hj.a("btnIgrnoreSpellingError",(2===b.errorType?G.a.FEd:G.a.Sma).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}R7d(a,b){if(!U.a.instance.ga(92)){var c=Object.assign(new dl.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:b}));a.push(c)}}y2d(a,b){a=this.$sj(a.suggestions,
b);return 0<a.length?Hj.e("msUnknownWord",Hj.c(null,a),"Menu16"):Hj.e("msUnknownWord",Hj.c(null,[Hj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}$sj(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l)a[l]&&c.push(Hj.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}jKi(a,b){const c=Object.assign(new dl.a,{Id:"Suggestions",ControlList:[]});this.Zsj(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new Eg.a,
{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}Zsj(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const u=Object.assign(new Eg.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});Array.add(c,u)}}}}Object(m.a)(wy,"DefaultProofingContextMenuCreator",null,[]);class xy{constructor(a,b){this.wqf=a;this.Rrf=b;this.XRa=[G.a.dBa,G.a.eBa,G.a.fBa,G.a.lOa,G.a.mOa]}create(a,b){return b?Object(gc.a)(Cp.a,b)?this.Rrf.create(a,b,
this.XRa):this.wqf.create(b,this.XRa):""}S6b(a,b){return b?Object(gc.a)(Cp.a,b)?this.Rrf.eu(a,b,this.XRa):this.wqf.eu(b,this.XRa):null}}Object(m.a)(xy,"ProofingContextMenuSectionFactory",null,[1726]);class Hu{build(){const a=[Hj.a("btnDeleteRepeatedWord","2023591105",Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Hj.e("msRepeatedWord",Hj.c(null,a),"Menu16")}lSf(){const a=Object.assign(new dl.a,{ControlList:[]}),b=Object.assign(new Eg.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,
b);return a}}Object(m.a)(Hu,"ProofingRepeatedWordSectionBuilder",null,[1725]);var yw=d(1165);class Er{constructor(a,b){this.c6a=a;this.Hm=b}get isVisible(){return this.c6a.hwa}get controls(){return null}$E(){this.c6a.$E();return!0}N$e(a,b){var c=void 0===c?null:c;this.c6a.showFloatie(Object.assign(new yw.a,{x:a.x,y:a.y}),this.G$b(b),b,c)}rjg(){return new Sys.UI.Bounds(0,0,0,0)}wua(){return this.$E()}G$b(){return[]}}Object(m.a)(Er,"ReactFloatie",null,[568,823]);class pA{constructor(a){this.OEc=null;
this.c6a=a}dispose(){}wua(){this.c6a.X7b();return!0}showContextMenu(a,b){this.P7(a,b.clientPoint,b.wg)}P7(a,b,c){this.xAd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);da.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}xAd(a,b,c,f){f=void 0===f?null:f;this.OEc?this.c6a.GAa(Object.assign(new yw.a,{x:b.x,y:b.y}),this.OEc.G$b(c),c):this.c6a.showContextMenu(Object.assign(new yw.a,{x:b.x,y:b.y}),c,void 0,f);this.OEc=null}yAd(a,b,c,f){this.OEc=Object(gb.a)(Er,c);f.sca(a,b);return!0}}
Object(m.a)(pA,"ReactContextMenuController",null,[897,106]);var br=d(448);class zw{static get Wg(){return zi.a.oC(zw.Hq,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}
zw.Hq="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(m.a)(zw,"AutoCorrectOptionsDialogHTML",null,[]);class Aw{static get Wg(){return zi.a.oC(Aw.Hq,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Aw.Hq="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(m.a)(Aw,"AutoCorrectOptionsDialogHTML2",null,[]);class qA extends zi.a{constructor(a,b){super();this.wT=a;this.q4=b;this.Fg="AutoCorrectOptionsDialog"}Syc(){da.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Wg=this.q4?Aw.Wg:zw.Wg;const a={};a.ReplaceTextAsYouType=this.wT.Kmb;a.CapitalizeFirstLetterOfSentences=this.wT.jRc;a.ReplaceOrdianalsWithSuperscript=this.wT.Hvd;a.ReplaceHyphensWithDash=this.wT.Yvc;a.ReplaceFractionsWithFractionCharacter=this.wT.Fvd;this.q4&&
(a.ReplaceQuoteWithSmartQuote=this.wT.a4e);this.Vj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(R.a)(this,this.zOl,"setAutoCorrectOptionsHandler"),a)}zOl(a,b){U.a.instance.ga(70)&&(1!==a?da.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.wT.Kmb||b.CapitalizeFirstLetterOfSentences!==this.wT.jRc||b.ReplaceOrdianalsWithSuperscript!==this.wT.Hvd||b.ReplaceHyphensWithDash!==this.wT.Yvc||b.ReplaceFractionsWithFractionCharacter!==
this.wT.Fvd||this.q4&&b.ReplaceQuoteWithSmartQuote!==this.wT.a4e?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.q4&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.wT.TJl(a),da.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.q4,["ReplaceQuoteWithSmartQuote"]:this.q4&&b.ReplaceQuoteWithSmartQuote}),
ad.App.Ob.Gf(!0)):da.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(m.a)(qA,"AutoCorrectOptionsDialog",zi.a,[900]);const EC=()=>{ad.App.dDi=!0;return 32},FC=(a,b,c,f,l)=>{if(1===c)return 32;c=zy(l);({point:a,Gv:b}=c);if(!c.returnValue)return 16;ad.App.Ob.GAa(a,b);return 32},yy=(a,b,c,f,l)=>{if(1===c)return 32;c=zy(l);({point:a,Gv:b}=c);if(!c.returnValue)return 16;ad.App.Ob.Q7(a,b);return 32},zy=a=>{let b,c;b=null;c=0;if(!a)return{returnValue:!1,
point:b,Gv:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Gv:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Gv:c}};var rA=d(1166);class sA extends Sys.EventArgs{constructor(a,b,c,f,l,u,I,T){u=void 0===u?0:u;I=void 0===I?0:I;T=void 0===T?null:T;super();this.controlId=a;this.ZMb=c;this.commandId=f;this.time=l;this.commandSurface=u;this.Gv=I;this.contentType=T}}Object(m.a)(sA,"CommandClickEventArgs",Sys.EventArgs,[]);class tA{constructor(a,
b){this.oda=a.qyj();this.zWb=a;this.pPa=b}O$f(a,b,c,f,l){f=void 0===f?null:f;l=void 0===l?null:l;c&&(this.pPa.oq=c.CommandLocation,this.pPa.eV=c.InvocationMethod,this.pPa.Tta=c.CommandTabName);let u=this.zWb.Uig(parseInt(a),b,c);u.lE&&(u=this.zWb.Uig(u.Jm,b,c));if(void 0!==u.qM&&null!==u.qM)return u.qM;if(u.Tne)l=32;else{var I=null;this.oda&&this.oda.TYe&&(I=this.oda.TYe(u,l));u.yY||u.cxe?u.pq?l=16:(l=this.pPa.Ia(u.Jm,u.bxe?2:1,u.Bd,l),2===l&&(l=32)):u.pq?l=this.pPa.Dsd(null,u.Jm,u.Bd,T=>{f&&f(T.response)},
l):(l=this.pPa.Ia(u.Jm,2,u.Bd,l),f&&f(l));this.oda&&this.oda.mYe&&this.oda.mYe(u,l,I);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";I=b.ParentMenuId;void 0!==I&&null!==I||!b.MenuId||(I=b.MenuId);let T=b.SqmControlId;void 0!==T&&null!==T||!b.SourceControlId||(T=b.SourceControlId);(void 0!==T&&null!==T||void 0!==I&&null!==I)&&rA.a.npl(new sA(T,c,I,a,Date.now()))}}u.yY&&32===l&&this.oda&&this.oda.G3b&&this.oda.G3b(u,b);u.cxe&&32===l&&this.oda&&this.oda.C0d&&
this.oda.C0d(u,b);return 32===l||1===l}Pfc(a,b){b=void 0===b?null:b;if(A.AFrameworkApplication.Dh||ln.a.instance.Dx)return!1;const c=parseInt(a);b&&b.UILocation&&(this.pPa.oq=b.UILocation);if(!a||c===ff.ActionManager.L8b)return!0;a=this.zWb.Q_c(c,b);a.lE&&(a=this.zWb.Q_c(a.Jm,b));if(void 0!==a.qM&&null!==a.qM)return a.qM;c===N.a.w9a&&b&&(a.Bd=b);return 32===this.pPa.Ia(a.Jm,1,a.Bd)}clearCache(){this.zWb.clearCache()}}Object(m.a)(tA,"GeneralCuiUser",null,[898,625]);class uA{constructor(a,b,c,f){this.WGf=
a;this.wka=b;this.zDc=c;this.o7a=f}Zng(){return{returnValue:this.o7a.F0c(this.WGf),Sxh:this.o7a.$Ij(this.WGf)}}rNh(a,b){if(this.wka){var c=new W.DictionaryPropertySet;this.zDc.execute(f=>{f.W8b(a)});c.setValue(rb.a.pu,a);c.setValue(U.a.instance.ga(20)?ib.a.noProof:Oe.a.Rya,b);b=new pg.GraphTransaction(15);b.set(ad.App.BQ.BW);this.wka.tW(c);b.dispose()}}}Object(m.a)(uA,"LanguageEditor",null,[899]);var Yi=d(202);class pq{constructor(a,b){a=void 0===a?!1:a;b=void 0===b?0:b;this.JHd=null;this.CPd=pq.Tog(Ea.a.syj());
this.gIc=new yu.a;this.Msa=[];this.Htb=new Ba.a;this.pDf=a;this.qDf=0>=b?7:b;this.oDf=this.HTd=0;this.$tf=!1;a&&(this.dak(),A.AFrameworkApplication.Jia(()=>{this.lDk()}))}get languages(){return this.CPd}dak(){for(var a of this.CPd)this.gIc.$(a.LCID,a);a=[];try{var b=Yi.a.get("RecentlyUsedLcids");if(b&&""!==b){const c=decodeURIComponent(b).split(",").slice(0,this.qDf);for(const f of c){const l=parseInt(f);let u;(()=>{let I=this.gIc.Eg(l);({value:u}=I);return I})().returnValue&&a.push(u)}}}catch(c){da.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",c.message),Array.clear(a)}if(a.length)for(const c of a)b=c.LCID,this.Htb.contains(b)||(this.Msa.push(c),this.Htb.add(b));else{const c=A.AFrameworkApplication.lcid;let f;(()=>{let l=this.gIc.Eg(c);({value:f}=l);return l})().returnValue&&(this.Msa.push(f),this.Htb.add(c))}this.kJh()}kJh(){const a=xb.toArray(xb.select(xb.asEnumerable(this.Msa),b=>b.LCID)).join(",");Yi.a.lL("RecentlyUsedLcids",a,180)}jhl(a,b){if(a&&
!(0<a.options.length)){var c=-1,f=pq.Tog(this.Msa);this.pDf&&0<f.length&&(c=pq.fSf(f),c=pq.vKf(a,c,b),a.add(pq.oKi(),null));this.JHd||(this.JHd=pq.fSf(this.CPd));b=pq.vKf(a,this.JHd,b);-1===c&&(c=b);a.selectedIndex=c}}gRl(a,b){if(this.pDf){var c;if((()=>{let l=this.gIc.Eg(a);({value:c}=l);return l})().returnValue){b=a!==b;if(this.Htb.contains(a)){var f=Array.indexOf(this.Msa,c);0<=f&&(Array.removeAt(this.Msa,f),this.Msa.push(c));b&&this.HTd++}else this.Htb.add(a),this.Msa.push(c),this.Msa.length>
this.qDf&&(f=this.Msa.shift(),this.Htb.remove(f.LCID)),b&&this.oDf++;this.kJh()}}}lDk(){const a=this.HTd+this.oDf;!this.$tf&&0<a&&(da.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.HTd/a),this.$tf=!0)}static fSf(a){return xb.toArray(xb.select(xb.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static oKi(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static vKf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static Tog(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(m.a)(pq,"LanguageListHelper",null,[1722]);var Ay=d(242);class Fr extends Ay.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(Fr,"NumberButtonProps",Ay.a,[]);class cr{static get b4l(){return cr.dGf||(cr.dGf=
Tb.a.instance.ub("Box4.ISpacingCommands"))}static get kQh(){return!!cr.b4l}static qb(){const a=A.AFrameworkApplication.Pa;a.xa(G.a.jMa,ta.a.view,cr.jMa);a.pe(G.a.jMa,1126)}static jMa(a,b,c,f,l){if(1===c||!cr.kQh)return cr.kQh?32:8;if(A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es)a=[],a.push(Object.assign(new Fr,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new Fr,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new Fr,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new Fr,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new Fr,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new Fr,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=Hj.d(a);else{a=Hj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=Hj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=Hj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=Hj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const u=Hj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),I=Hj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),T=Hj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=Hj.c("LineSpacing.Menu.Controls",[a,b,c,f,u,I,T]);a=Hj.e("msLineSpacing",a,"Menu");a=Hj.f([a]);l.PopulationXML=a}return 32}}cr.dGf=null;Object(m.a)(cr,"LineSpacingRibbonMenu",null,[]);var GC=d(1164),HC=d(953);const Bw=(a,b,c)=>{if(1===
c)return 32;a=ad.App.Ob.notificationBar.YEa("Automation test",!1);a.image=3;ad.App.Ob.notificationBar.Ei(a);return 32},vA=(a,b,c,f,l)=>{let u;if(!(()=>{var I=!1;l?(I=Boolean.parse(l),I={returnValue:!0,x4h:I}):I={returnValue:!1,x4h:I};({x4h:u}=I);return I})().returnValue)return 16;Gj.UISurfaces.BM().then(I=>{let T=null;var ja=Object.assign(new GC.a,{label:"OK",onExecute:()=>{T&&I.removeNotification(T)}});ja=Object.assign(new HC.a,{target:"#"+P.AppFrame.vHh,content:"Here's the text for the callout",
title:"Your title",primaryButtonProps:ja,useTeachingStyles:u});ja=I.callout(ja);T=I.addNotification(ja);return null},I=>{da.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null});return 32};class By{constructor(a){this.nJ=a}nUb(a){this.nJ&&this.nJ.OB(a)}}Object(m.a)(By,"RibbonButtonUpdater",null,[1721]);class Cy{constructor(){this.D8=this.Da=null}get name(){return"Box4.UI"}fc(a){this.Da=a;a.register(673,"Common.IReactContextualUILauncher").ma().na(()=>new oA(a.resolve("CommandUI.ReactRibbonRoot"),
a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(897,"Box4.IContextMenuController").ma().na(()=>new pA(a.resolve("Common.IReactContextualUILauncher")));a.register(898,"Box4.IGeneralCuiUser").na(()=>new tA(a.resolve("Box4.UI.CuiActionBridge"),A.AFrameworkApplication.Pa)).ma();a.register(899,"Box4.UI.ILanguageEditor").na(()=>new uA(Me.a.instance.Ik,a.ub("Box4.ITextFormattingCommands"),a.Ha("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(900,"Box4.UI.IAutoCorrectOptionsDialog").na(()=>
new qA(a.resolve("Box4.IAutoCorrectOptionsInfo"),A.AFrameworkApplication.fa.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(pq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().na(()=>new pq(A.AFrameworkApplication.fa.getBooleanAppSetting("RecentlyUsedLanguagesListIsEnabled")));a.register(Hu,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(wy,"Box4.UI.DefaultProofingContextMenuCreator").ma().na(()=>
new wy(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(xy,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().na(()=>new xy(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(By,"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().na(()=>new By(this.Da.resolve("Box4.IAppFrame")))}init(){var a=ad.App.Ob;const b=a.mb;zn.m9j(Object(R.a)(b,b.Lqc,
"onAuthenticationLost"),Object(R.a)(b,b.Mqc,"onAuthenticationRestored"),a.aQi);br.a.qb();a=A.AFrameworkApplication.Pa;a.xa(G.a.Fkl,ta.a.application,EC);a.pa(G.a.G_l,ta.a.application,FC,96);a.pa(G.a.i0l,ta.a.application,yy,96);a=A.AFrameworkApplication.Pa;a.pa(G.a.W1l,ta.a.application,Bw,96);a.pa(G.a.v_l,ta.a.application,vA,96);cr.qb();this.D8=this.Da.ub("Box4.IContextMenuController")}dispose(){this.D8&&(this.D8.dispose(),this.D8=null)}static main(){C.a.instance.Ac(new Cy,6)}}Object(m.a)(Cy,"Box4UIPackage",
null,[2,3]);var wA=d(465),IC=d(904),Gr=d(208),Dy=d(555),ut=d(381),mn=d(322),Bj=d(73);class xA{constructor(a){this.Cpa=a}}Object(m.a)(xA,"ValidParentData",null,[]);var Hr=d(374),JC=d(837),dr=d(291),xv=d(836),vt=d(614),Qm=d(248),yA=d(360),qq=d(229);class zA{constructor(){this.Oyb=0}}Object(m.a)(zA,"BelowOutlineElementData",null,[]);var Ir=d(428),KC=d(605),LC=d(484);class AA extends Ir.a{constructor(a,b,c,f){super(4,f);this.Qci=a;this.XGd=b;this.wId=c}get WUc(){return this.Qci}get r2b(){return this.XGd}get U1d(){return this.wId}cCb(){var a=
this.WUc;if(!a)return da.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new KC.a(this.WUc.id,this.WUc.Wo,this.r2b?this.r2b.id:null);""!==a.characterData&&a.characterData&&(a=new LC.DeleteTextUpdateHint(this.WUc.id,0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(m.a)(AA,"DeleteParagraphOperation",Ir.a,[]);var MC=d(604),NC=d(483);class Ey extends Ir.a{constructor(a,b,c,f,l){super(3,l);this.TRd=
a;this.URd=b;this.l_b=f}get yLa(){return this.TRd}get XLb(){return this.URd}get oLa(){return this.l_b}cCb(){const a=[];var b=new MC.AddParagraphUpdateHint(this.oLa.id,this.oLa.Wo,this.yLa?this.yLa.id:null);Array.add(a,b);""!==this.oLa.characterData&&this.oLa.characterData&&(b=new NC.a(this.oLa.id,0,this.oLa.characterData),Array.add(a,b));return a}}Object(m.a)(Ey,"InsertNewParagraphOperation",Ir.a,[]);var OC=d(603);class BA extends Ir.a{constructor(a,b,c,f){super(2,f);this.TRd=a;this.URd=b;this.sji=
c}get yLa(){return this.TRd}get XLb(){return this.URd}get khh(){return this.sji}cCb(){const a=[],b=new OC.MergeParagraphUpdateHint(this.yLa.id,this.yLa.Wo,this.yLa.characterData.length,this.XLb.id,this.XLb.Wo,this.khh.id,this.khh.Wo);Array.add(a,b);return a}}Object(m.a)(BA,"MergeParagraphOperation",Ir.a,[]);var PC=d(602);class CA extends Ir.a{constructor(a,b,c,f,l){super(1,l);this.WRd=a;this.Qoi=b;this.XGd=c;this.wId=f}get zLa(){return this.WRd}get r2b(){return this.XGd}get U1d(){return this.wId}get A4l(){return this.Qoi}cCb(){const a=
[],b=new PC.a(this.zLa.id,this.zLa.Wo,this.A4l,this.r2b.id,this.r2b.Wo,this.U1d.id,this.U1d.Wo);Array.add(a,b);return a}}Object(m.a)(CA,"SplitParagraphOperation",Ir.a,[]);var qs=d(326);class hk{constructor(a,b,c,f,l,u){this.Pp=this.zd=null;this.Wy=a;this.ir=b;this.qh=c;this.nci=f;this.pji=l;this.nsa=void 0===u?null:u}fsi(a){U.a.instance.ga(50)&&ad.App.ni&&ad.App.ni.qy&&ad.App.ni.v3.LDa(a)}Lnb(a,b,c){jb.OutlineElementNavigator.Ti(a);$a.ParagraphReader.Pl(a)?hk.paragraphEditor.Cw.Lnb(a,b,c):Jd.TableReader.Nq(a)&&
14===a.Zi&&(b=(new dr.a(1,c)).hO,this.gUl(Object(gb.a)(Hr.a,a.currentNode),b));jb.OutlineElementNavigator.$e(a)}gUl(a,b){a&&Object(gc.a)(Hr.a,a)&&(a.Sm=b)}get Cw(){return ut.a.wBb}get kg(){return this.zd||(this.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get g8(){return this.Pp||(this.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get hs(){return this.ir.value}get eg(){return this.qh.value}get $C(){return this.Wy.value}get Jj(){return mi.a.instance}b8d(){const a=
Dy.a.instance.createInstance(393229);a.setValue(rb.a.MF,mn.a.first);a.setValue(rb.a.j8i,new Date);a.XEd();return a}n5i(){const a=new IC.a;a.setValue(rb.a.MF,mn.a.first);return a}ryd(a,b,c){const f=a.Zh;if(f){f.id.equals(hk.Jof)||(hk.Jof=f.id,hk.NDc={});var l=hk.NDc[b];b in hk.NDc&&f.ydb(l.id)&&f.my&&f.my.q1(l.id)||(l=new qq.a,l.setValue(rb.a.author,b),l=f.PMa(l));a.properties.setValue(c,l.id);hk.NDc[b]=l}}fRb(a,b){a.properties.setValue(rb.a.lastModifiedTime,b)}dhf(a,b){b=void 0===b?null:b;const c=
new pg.GraphTransaction(7);c.rd(a);b||(b=new Date);this.fRb(a,b);this.ryd(a,this.F2c(),rb.a.Y3b);""===ge.OutlineElementReader.JZc(a,rb.a.NPc)&&this.ryd(a,this.F2c(),rb.a.NPc);c.dispose()}F2c(){return ad.App.tef.name}Jae(a,b,c){c=void 0===c?!1:c;if(U.a.instance.ga(56))ge.OutlineElementReader.rxe(a)?(a=ge.OutlineElementReader.isRtl(a),c?this.czd(b,a):this.DNa(b,a)):this.aAl(b);else if(U.a.instance.ga(26)||U.a.instance.ga(89))a=ge.OutlineElementReader.isRtl(a),c?this.czd(b,a):this.DNa(b,a)}yRb(a,b){var c=
new mb.GraphIterator;c.set(a);c.uc(11);c=c.Ug(11);ge.OutlineElementReader.kn(c)!==b&&(this.DNa(c,b),U.a.instance.ga(54)?a.anchor.Zr(4):(c=1,b&&(c=3),a.setValue(rb.a.tm,c),a.setValue(rb.a.xK,c)))}DNa(a,b){const c=new pg.GraphTransaction(7);c.rd(a);this.czd(a,b);if(U.a.instance.ga(26)){var f=new mb.GraphIterator;f.set(a);f.Gb(2)&&$a.ParagraphReader.Pl(f)&&(f=f.currentNode,b?(f.He(ye.a.Aud,!0),hk.paragraphEditor.kL(f,3)):(f.removeProperty(ye.a.Aud),hk.paragraphEditor.kL(f,1)))}f=new mb.GraphIterator;
f.set(a);qs.a.instance.Bck(f);if(f.uc(10)){const l=f.Ug(10);f.Gb(1)===a&&this.$C.DNa(l,b)}c.dispose()}czd(a,b){let c=null,f=null;if(this.kg.Gg&&a.isConnected){c=$a.ParagraphReader.m1c(a,!0,!0);f=new La.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).k$())}b?a.properties.setValue(rb.a.UZ,!0):U.a.instance.ga(56)?a.properties.setValue(rb.a.UZ,!1):(U.a.instance.ga(26)||U.a.instance.ga(89))&&a.properties.removeProperty(rb.a.UZ);if(this.kg.Gg&&c&&f)if(c.count!==f.count)da.ULS.shipAssertTag(35973010,
376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}aAl(a){a.properties.removeProperty(rb.a.UZ)}Fea(a,b,c){b=void 0===b?null:b;c=void 0===c?!1:c;let f=null,l=null;if(!ge.OutlineElementReader.vh(a))return da.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;var u=null;let I=null,T=0;b&&(u=b.formatting,I=b.style,T=b.languageId);c||({yLa:f,XLb:l}=this.Efg(a));b=Gr.a.instance.createInstance(393230);
b.setValue(rb.a.np,"");a.$l(b,2);a.Cl(b);hk.paragraphEditor.Fvc(b);hk.paragraphEditor.oVk(b);hk.paragraphEditor.zUb(b);this.fsi(b);u&&(b.Sa.first.formatting.en=u);T||(T=A.AFrameworkApplication.lcid);a.currentNode.He(rb.a.$mb,a.currentNode.ra(rb.a.$mb,T));U.a.instance.ga(54)&&a.currentNode.setValue(ib.a.msc,0);!U.a.instance.ga(71)||U.a.instance.ga(61)||I||(u=Wb.StyleReader.EM(b))&&(I=u.gI(Wb.StyleReader.lra));this.nci.Yjj(a);I&&hk.zQ.mca(I,b,!0);!c&&f&&(c=new Ey(f,l,f,new vt.a(b),b.wUa),a.currentNode.eI().graphTransactionOperations.A4(c));
return b}Efg(a){let b;b=null;const c=new mb.GraphIterator;c.Uc(a);c.cCg?c.currentNode.eI().graphTransactionOperations.ala(6):(jb.OutlineElementNavigator.Pya(c,!0,!1),b=this.i0c(c));c.Uc(a);a=this.sgg(c);return{yLa:b,XLb:a}}sgg(a){const b=new mb.GraphIterator;b.Uc(a);a=null;b.dEb||(jb.OutlineElementNavigator.XK(b,!0,!1),a=this.i0c(b));return a}i0c(a,b){b=void 0===b?!1:b;a=jb.OutlineElementNavigator.Ti(a,!0);return a?this.Mjg(a,b):(da.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),
null)}Mjg(a,b){b=void 0===b?!1:b;if(12===a.type)return b?new vt.a(a):new xv.a(a);a.eI().graphTransactionOperations.ala(5);return new JC.a(a)}VUi(a,b){var c=b.currentNode.clone();a.IM(c,null,1);a.Cl(c);c.G0=b.currentNode;jb.OutlineElementNavigator.Ti(b);b.lY&1&&b.currentNode.k5a(null);c=b.currentNode.clone();c.yW=b.currentNode.yW;a.IM(c,null,2);a.Cl(c);a.dV(1);c.G0=b.currentNode;U.a.instance.ga(55)&&c.setValue(ib.a.Wo,qf.a.i2a());b.eD(11)}Fvc(a){a.Gb(2)&&a.rj()}jFh(a,b){const c=a.currentNode;jb.OutlineElementNavigator.Ti(a);
const f=a.currentNode;jb.OutlineElementNavigator.$e(a);b.tC(1);jb.OutlineElementNavigator.Ti(b);a.$l(b.currentNode,2);b.rj();var l=new mb.GraphIterator;l.Uc(b);if(l.Gb(1)){const u=new mb.GraphIterator;u.Uc(a);const I=new xA(null);if(!this.nRj(u,l.currentNode,I))return;Qm.h(u,null,1,1,l,-1)}b.rj();l=null;a.NG(1)&&(l=a.currentNode);for(a.Dc();Pg.OutlineNavigator.Gba(b);)a.IM(b.currentNode,l,1),l=b.currentNode,b.rj();a.Cl(c);a.Cl(f);a.rj()}xSb(a,b,c,f,l,u){u=void 0===u?!1:u;this.Fvc(b);const I=b.Zi;
var T=a.currentNode;let ja=null;var ua=null;let Ra=null,eb=!1;jb.OutlineElementNavigator.Ti(a);const Bb=a.Zi;if($a.ParagraphReader.Pl(a)){var Ub=a.currentNode;(ua=Object(gb.a)(Vg.AParagraphNode,Ub))?ua.Sa&&ua.Sa.length||da.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",ua):da.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");ua=new vt.a(ua);(eb=c.Ra===$a.ParagraphReader.textLength(Ub))&&(Ra=this.sgg(b));var Xb=b.currentNode;ja=this.Fea(b,void 0,!0);
hk.paragraphEditor.vbf(a,b,c,l,!0,u);U.a.instance.ga(71)&&(f?(l=Wb.StyleReader.iF(Ub))&&hk.zQ.mca(l,ja,!0):eb&&(l=Wb.StyleReader.iF(Ub))&&((Ub=l.ra(ye.a.gjh,null))?(l=Wb.StyleReader.EM(ja).gI(Ub),hk.zQ.mca(l,ja,!1)):hk.zQ.mca(l,ja,!0)));this.Jae(T,Xb);this.hs.Hae(T,Xb)}jb.OutlineElementNavigator.$e(a);jb.OutlineElementNavigator.$e(b);T=ge.OutlineElementReader.isEmpty(a,!0);Xb=ge.OutlineElementReader.isEmpty(b,!0);U.a.instance.ga(27)&&T&&!Xb&&(b.lY&1&&(T=new yA.a,T.Uc(b),b.currentNode.k5a(T)),this.ryd(b.currentNode,
ge.OutlineElementReader.JZc(a.currentNode,rb.a.Y3b),rb.a.Y3b),this.ryd(b.currentNode,ge.OutlineElementReader.JZc(a.currentNode,rb.a.NPc),rb.a.NPc),this.fRb(b.currentNode,ge.OutlineElementReader.bEj(a.currentNode)));jb.OutlineElementNavigator.Ti(a);(T=Object(gb.a)(Vg.AParagraphNode,a.currentNode))?T.Sa&&T.Sa.length||da.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",T):da.ULS.sendTraceTag(38925761,307,15,"srcPara is null");T=new vt.a(T);jb.OutlineElementNavigator.$e(a);
(a=ja)?a.Sa&&a.Sa.length||da.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(da.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),da.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:eb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:Bb,["destinationOutlineElementNodeType"]:I,["alwaysMoveEopToDestinationPara"]:u}));eb?(c=new Ey(ua,Ra,T,new vt.a(a),a.wUa),b.currentNode.eI().graphTransactionOperations.A4(c)):
(c=new CA(ua,c.Ra,T,new vt.a(a),a.wUa),b.currentNode.eI().graphTransactionOperations.A4(c))}AUf(a,b){jb.OutlineElementNavigator.Ti(a);let c=$a.ParagraphReader.rt(a.currentNode);const f=a.currentNode;U.a.instance.ga(14)&&(c=b?c&&!this.Jj.Pcl(f):c&&!this.Jj.Jcl(f));jb.OutlineElementNavigator.$e(a);return c}merge(a,b,c,f,l,u,I,T){l=void 0===l?null:l;u=void 0===u?!1:u;I=void 0===I?!1:I;T=void 0===T?!1:T;if(a.currentNode.id===b.currentNode.id)return!1;let ja,ua;var Ra=new mb.GraphIterator;Ra.Uc(b);ja=
this.i0c(Ra);Ra.Uc(a);ua=this.i0c(Ra,!0);if(!this.AUf(b,!0)||!this.AUf(a,!1))return!1;if(this.eg.Xtc){var eb=Object(gb.a)(Vg.AParagraphNode,a.currentNode);eb=(c||!eb||!eb.characterData.length)&&!Kc.ListReader.hl(a)}else eb=this.pji.Llm(c,a);T||this.hs.merge(a,b,eb,l);jb.OutlineElementNavigator.Ti(a);l=a.currentNode.wUa;jb.OutlineElementNavigator.Ti(b);if($a.ParagraphReader.Pl(b)){if(U.a.instance.ga(50)&&ad.App.ni.qy){T=b.currentNode;eb=a.currentNode;const Bb=wA.CoauthLockEditor.getInstance();if(Bb.VRb(this.Jj.W$b(T))||
Bb.VRb(this.Jj.W$b(eb)))return b.Dc(),a.Dc(),!1}T=!1;Kc.ListReader.wy&&(eb=a.parentNode)&&ge.OutlineElementReader.U$(eb)&&(T=Kc.ListReader.PXa(eb));U.a.instance.ga(71)&&(eb=(eb=$a.ParagraphReader.isEmpty(a)||c)&&!T)&&(eb=Wb.StyleReader.lpg(b))&&hk.zQ.mca(eb,a.currentNode,!0);c&&this.nsa.JXk(b.currentNode,a.currentNode,T,I);c=hk.paragraphEditor.merge(a,b,c,f,u);f=Ra.currentNode;Ra=a.currentNode;a.Dc();c&&ge.OutlineElementReader.isEmpty(b,!0)&&this.tFa(b);a=new BA(ua,ja,new xv.a(f),l);Ra.eI().graphTransactionOperations.A4(a);
return!0}b.Dc();a.Dc();return!1}ybk(a){var b=!0;b=void 0===b?!1:b;const c=new mb.GraphIterator;c.set(a.node);c.wf();jb.OutlineElementNavigator.$e(c);const f=this.Sdc(c),l=this.Sdc(c);this.xSb(c,f,a,!1,!0);ge.OutlineElementReader.isEmpty(c,!1)&&(this.hs.tqa(c),c.rj());!ge.OutlineElementReader.isEmpty(f,!1)||b&&ge.OutlineElementReader.Peb(f)||(this.hs.tqa(f),f.rj());return l}Nfa(a,b,c,f,l){f=void 0===f?null:f;l=void 0===l?!1:l;var u=void 0===u?!0:u;if(!this.SPi(a))return null;const I=a.currentNode;
var T=!1;u&&(T=Kc.ListReader.hl(a),b||l||ge.OutlineElementReader.isEmpty(a,!1),T=this.hs.IZl(T));b=b?a.NG(1):a.currentNode;a.Dc();c=this.$C.Rdc(a,b,c,f);if(!c)return null;this.Jae(I,c);u&&(this.hs.Hae(I,c),T&&this.hs.Dbm(a,I));return c}SPi(a){return ge.OutlineElementReader.vh(a)&&(a=a.parentNode,Bj.OutlineReader.tfc(a)||ge.OutlineElementReader.U$(a)||ge.OutlineElementReader.pwa(a))?!0:!1}Syl(a){const b=new mb.GraphIterator;b.set(a);b.wf();b.eD(11);let c,f;({yLa:c,XLb:f}=this.Efg(b));let l=-1;12===
a.type&&(l=a.wUa);b.currentNode.eI().graphTransactionOperations.A4(new AA(this.Mjg(a,!0),c,f,l));this.tFa(b)}tFa(a){if(a.gK(1)){const b=new zA,c=new mb.GraphIterator;c.Uc(a);this.$uj(c,b)&&this.Cw.aVc(a,-b.Oyb)}a.rj();Jd.TableReader.Ft(a)&&this.Phl(a)}tqe(a,b,c){if(!Bj.OutlineReader.Wu(a)&&!ge.OutlineElementReader.vh(a))return null;const f=this.n5i();0<c&&c<mn.a.last&&f.setValue(rb.a.MF,Math.min(mn.a.nil,c));a.IM(f,b,1);return f}Abk(a,b){if(!ge.OutlineElementReader.vh(a)&&!ge.OutlineElementReader.nK(a)||
!Bj.OutlineReader.xY(a.parentNode)&&!ge.OutlineElementReader.U$(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.Dc();b=this.tqe(a,f,b);a.Cl(c);return b}Phl(a){ge.OutlineElementReader.nK(a)&&(a.gK(1)||a.rj());this.mdg(a,!1);this.NMf(a)}mdg(a,b){var c,f=null;for(c=a.Gb(1);c;){var l=!1;ge.OutlineElementReader.pwa(c)&&!a.gK(1)&&(l=!0);var u=c;c=a.sk(1);if(l)l=new mb.GraphIterator,l.set(u),l.wf(),l.rj();else if(ge.OutlineElementReader.pwa(u)){if(f){l=new mb.GraphIterator;l.set(f);
var I=new mb.GraphIterator;I.set(u);I.wf();l.$l(I.currentNode,1);I.rj();I=ge.OutlineElementReader.n5(u);I===mn.a.nil&&(I=1);const T=ge.OutlineElementReader.n5(u);(I=Math.max(0,T-I))?u.setValue(rb.a.MF,Math.min(mn.a.nil,I)):(l.Cl(u),a.Gb(1),Qm.e(l),l.Dc());b&&this.mdg(l,!0)}}else f=u}b=null;f=mn.a.last+1;for(c=a.Gb(1);c;c=a.sk(1))if(ge.OutlineElementReader.nK(a))u=ge.OutlineElementReader.n5(c),f>u&&(f=u,b=c);else{a.Dc();return}if(b){for(c=a.Gb(1);c;c=a.sk(1))c!==b&&(c=ge.OutlineElementReader.n5(c),
a.currentNode.setValue(rb.a.MF,Math.min(mn.a.nil,c-f)));f+=ge.OutlineElementReader.n5(a.currentNode);a.currentNode.setValue(rb.a.MF,Math.min(mn.a.nil,f));c=new mb.GraphIterator;c.Uc(a);c.Cl(b);c.Gb(1);Qm.e(c)}}nRj(a,b,c){var f=ge.OutlineElementReader.n5(a.currentNode);if(1===f)return!0;if(ge.OutlineElementReader.nK(a))return!1;if(!a.g$(1)||this.Dmk(a,b))return a.currentNode.setValue(rb.a.MF,Math.min(mn.a.nil,1)),!0;if(c.Cpa&&a.Cl(c.Cpa)){if(ge.OutlineElementReader.nK(a)&&1===f+ge.OutlineElementReader.n5(a.currentNode))return c.Cpa=
a.tC(1),a.Dc(),!0;a.Dc()}if(c.Cpa&&a.Cl(c.Cpa)||!c.Cpa&&a.Gb(1)){if(a.currentNode!==b&&a.Qf(1)&&ge.OutlineElementReader.nK(a)&&1===f+ge.OutlineElementReader.n5(a.currentNode))return c.Cpa=null,!0;a.Dc()}if(a.OWa(b)&&this.Cmk(a,b)){for(c=a.Gb(1);c;c=a.sk(1))if(c!==b){var l=ge.OutlineElementReader.n5(c);c.setValue(rb.a.MF,Math.min(mn.a.nil,l+(f-1)))}a.currentNode.setValue(rb.a.MF,Math.min(mn.a.nil,1));return!0}if(1>f)return f=this.tqe(a,c.Cpa,1-f),a.Cl(f),c.Cpa=null,!0;if(1<f){a.currentNode.setValue(rb.a.MF,
Math.min(mn.a.nil,1));b=null;for(l=a.Gb(1);l;){if(ge.OutlineElementReader.nK(a)){l.setValue(rb.a.MF,Math.min(mn.a.nil,f-1+ge.OutlineElementReader.n5(l)));l=a.sk(1);continue}b||(b=this.Abk(a,f-1));const u=l;l=Qm.j(a,b,1);l===b&&(l=a.sk(1));c.Cpa===u&&(c.Cpa=b,b=null)}return!0}return!1}Dmk(a,b){return mb.GraphIterator.Xea(()=>{if(1===a.g$(1)){const c=a.Gb(1);a.Dc();if(c===b)return!0}return!1})}Cmk(a,b){return mb.GraphIterator.Xea(()=>{let c;for(c=a.Gb(1);c;c=a.sk(1))if(c!==b&&!ge.OutlineElementReader.nK(a))return a.Dc(),
!1;return!0})}$uj(a,b){b.Oyb=0;do{const c=a.currentNode;if(a.Gb(1))b.Oyb-=ge.OutlineElementReader.n5(c);else{if(Bj.OutlineReader.Wu(a)||null===a.currentNode)return!1;if(3!==a.role||!a.Ima(1))for(;!a.sk(1);)if(b.Oyb+=ge.OutlineElementReader.n5(a.currentNode),Bj.OutlineReader.Wu(a)||null===a.currentNode)return!1}}while(ge.OutlineElementReader.nK(a));return!0}Sdc(a,b){return this.sqe(a,!1,void 0===b?!1:b)}sqe(a,b,c){c=void 0===c?!1:c;const f=new mb.GraphIterator;f.Uc(a);a=new mb.GraphIterator;a.Uc(f);
this.Nfa(a,b,!1,null,c);a.currentNode.setValue(rb.a.MF,Math.min(mn.a.nil,ge.OutlineElementReader.n5(f.currentNode)));f.Gb(1)&&Qm.h(a,null,1,1,f,-1);return a}NMf(a){if(ge.OutlineElementReader.hFl(a)){1!==ge.OutlineElementReader.n5(a.currentNode)&&a.currentNode.setValue(rb.a.MF,mn.a.first);for(var b=a.Gb(1);b;)if(ge.OutlineElementReader.nK(a)){b=new mb.GraphIterator;b.Uc(a);b.Dc();const c=new mb.GraphIterator;c.Uc(a);c.Gb(1);Qm.h(b,a.currentNode,1,1,c,-1);b=a.sUa(1)}else this.NMf(a),b=a.sk(1)}}static get zQ(){return hk.YL||
(hk.YL=Tb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set zQ(a){hk.YL=a}static get paragraphEditor(){return hk.hy||(hk.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){hk.hy=a}}hk.YL=null;hk.hy=null;hk.Jof=null;hk.NDc=null;Object(m.a)(hk,"OutlineElementEditor",null,[1733]);var Iu=d(117),Ju=d(418),DA=d(598),rq=d(259);class ho{constructor(a){this.PBf=a}o5i(){var a=void 0===a?!1:a;const b=Gr.a.instance.createInstance(393228);b.setValue(rb.a.MF,mn.a.first);b.setValue(rb.a.KIi,
0);a||b.setValue(rb.a.zy,Bj.OutlineReader.M3f);(new DA.OutlineIndentInfo(!0)).oJh(b);return b}uX(a,b,c){c=void 0===c?null:c;const f=a.currentNode;if(!a.tC(1))return this.Rdc(a,null,b,c);ge.OutlineElementReader.nK(a)&&jb.OutlineElementNavigator.XRe(a,!0);return ge.OutlineElementReader.vh(a)?ho.zi.Nfa(a,!1,b,c):(a.ywc(f),null)}RPi(a){return Bj.OutlineReader.Hwe(a.currentNode)||ge.OutlineElementReader.vh(a)||ge.OutlineElementReader.nK(a)||se.isTableCell(a)}Rdc(a,b,c,f){b=void 0===b?null:b;c=void 0===
c?!1:c;f=void 0===f?null:f;if(!this.RPi(a))return null;const l=ho.zi.b8d();this.bTl(l,a);a.Z4c(l,b,1,this.PBf.ofg());a.Cl(l);c&&(ho.zi.Fea(a,f),jb.OutlineElementNavigator.$e(a));U.a.instance.ga(25)&&ho.zi.dhf(a.currentNode);return l}bTl(a,b){if(b=this.HKj(b))switch(b.type){case 11:ho.zi.Jae(b,a,!0);break;case 8:b=ho.Il.isRtl(b),ho.zi.czd(a,b)}}HKj(a){return this.PBf.kke(a)}jzj(a,b){a=ho.Il.O0c(a);return new Ju.a(a.x+Bj.OutlineReader.JUc*(b?-1:1),a.y+Bj.OutlineReader.V3f)}Vyd(a){if(U.a.instance.ga(17)){var b=
new mb.GraphIterator;b.set(a);b.Zv();b=this.jzj(b.origin,Bj.OutlineReader.kn(a));rq.c(a,b.x,b.y)}}DNa(a,b){U.a.instance.ga(43)&&we.c(a)||a.setValue(rb.a.xK,b?11:9)}static get Il(){return Iu.PageReader.instance}static get zi(){return ho.Rj||(ho.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static set zi(a){ho.Rj=a}}ho.Rj=null;ho.Sf=null;Object(m.a)(ho,"OutlineEditor",null,[1734]);const EA=a=>{a.register(ho,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().na(()=>new ho(a.resolve("Box4.IOutlineElementNodeIdFactory")));
a.register(hk,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().na(()=>new hk(a.ze("Box4.IOutlineEditor"),a.ze("Box4.List.IListEditor"),a.ze("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class Fy{get name(){return"Box4.OutlineLevelEditors"}fc(a){EA(a)}init(){}dispose(){}static main(){C.a.instance.Ac(new Fy)}}Object(m.a)(Fy,"Box4OutlineLevelEditorsPackage",
null,[2,3]);class Cw{get name(){return"Box4.TableEditors"}fc(){}init(){}dispose(){}static main(){C.a.instance.Ac(new Cw)}}Object(m.a)(Cw,"Box4TableEditorsPackage",null,[2,3]);class Lq{get name(){return"Box4.TextLevelEditors"}fc(){}init(){}dispose(){}static main(){C.a.instance.Ac(new Lq)}}Object(m.a)(Lq,"Box4TextLevelEditorsPackage",null,[2,3]);class Oc{constructor(a,b,c){this.YRd=this.j8a=this.VRd=this.i8a=this.UPd=null;this.BH=a;this.udi=b;this.Vc=c;this.init()}init(){this.udi.xb(Object(R.a)(this,
this.KVj,"handleEditingViewUpdatesSafe"));this.i8a=new Md.a;this.VRd=new Md.a;this.j8a=new Md.a;this.YRd=new fk.a}o2a(a){this.i8a.add(a.key,a)}y2e(a){this.j8a.add(a.key,a)}KVj(a){try{this.JVj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),da.ULS.sendTraceTag(5285580,334,10,a)}}JVj(a){let b;(()=>{let c=Oc.Ldm(this.Vc.Oa.kb);({g9d:b}=c);return c})().returnValue&&(a=Oc.Fxj(a,this.UPd,b),this.ull(a,b),this.UPd=b)}ull(a,
b){a=this.Vtj(a,b);b=Oc.Edm(a);({notification:a}=b);b.returnValue&&this.BH.K7(a,!1)}Vtj(a,b){const c=new Md.a;c.$(1,new fk.a);c.$(0,new fk.a);a.forEach(f=>{3===f?(vb.ImageReader.pI(b.node)||this.mFl(b),this.JHj(c,b)):0===f&&this.fyj(c,b);return!0});return c}mFl(a){this.i8a.forEach((b,c)=>{c.reset(a);return!0})}fyj(a,b){let c=new Md.a;vb.ImageReader.pI(b.node)||(c=this.cyj(b.Ra));this.dyj(a,this.VRd,c,Oc.kKh(this.UPd,b));this.VRd=c}cyj(a){const b=new Md.a;this.i8a.forEach((c,f)=>{let l=f.qBc(a);({NDa:c}=
l);l.returnValue&&b.$(f.key,c);return!0});return b}dyj(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((u,I)=>{const T=this.i8a.ga(u).J9||I.title;let ja,ua=c.Eg(u);({value:ja}=ua);ua.returnValue?f&&ja.nR!==I.nR&&(T&&a.ga(1).add(T),u=this.i8a.ga(u).J9,u=String.format(l,ja.title,u),ja.description&&(u+=", "+ja.description),a.ga(0).add(u)):T&&a.ga(1).add(T);return!0});c.forEach((u,I)=>{b.Ib(u)||(u=this.i8a.ga(u).J9,u=String.format(l,I.title,u),I.description&&(u+=", "+
I.description),a.ga(0).add(u));return!0})}JHj(a,b){b=this.RNj(b.node);b=this.RVi(b);this.SNj(a,this.YRd,b);this.YRd=b}RNj(a){const b=new mb.GraphIterator;b.set(a);if(!b.uc(1))return null;const c=new fk.a;for(;1!==b.Zi;)this.j8a.forEach((f,l)=>{l=l.Uff(b);({Yxb:f}=l);l.returnValue&&c.add(f);return!0}),b.Dc();c.reverse();return c}RVi(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.T2===a[b+1].T2){this.j8a.ga(c.T2);let f={returnValue:!1,UVi:null};({UVi:c}=f);if(f.returnValue){a.splice(b,
2,c);continue}}b++}return new fk.a(a)}SNj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.j8a.ga(c.ga(f).T2).s_c(c.ga(f),b.ga(f));l&&(c.ga(f).description&&(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let u=this.j8a.ga(c.ga(l).T2).s_c(c.ga(l),null);u&&(c.ga(l).description&&(u+=", "+c.ga(l).description),a.ga(0).add(u))}for(c=f;c<b.length;c++)(f=this.j8a.ga(b.ga(c).T2).J9)&&a.ga(1).add(f)}static Fxj(a,b,c){const f=
new fk.a;(a=a||Oc.aMl(b,c))?(f.add(3),f.add(0)):Oc.kKh(b,c)&&f.add(0);return f}static aMl(a,b){return!a||!a.node.id.equals(b.node.id)}static kKh(a,b){return!a||!a.equals(b)}static Ldm(a){let b;b=null;if(!a||!(Bc.SelectionEditor.uy(a)||(a=Bc.SelectionEditor.Km(a,!0,!1),Bc.SelectionEditor.uy(a)||a.Ua&&vb.ImageReader.pI(a.Ua.node))))return{returnValue:!1,g9d:b};b=a.Ua;return{returnValue:!!b,g9d:b}}static Edm(a){const b=new fk.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,
c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<b.length,notification:a}}}Object(m.a)(Oc,"AccessibilityContextManager",null,[1719]);class Ku{constructor(a,b){this.Rwf=!1;this.J0b=null;this.eLc=this.LMc=!1;this.Qrf=null;this.je=a;this.C8=b}get L1j(){return!!this.J0b}xb(a){this.Rwf||(this.C8.ALf(Object(R.a)(this,this.ROc,"afterEditingViewValidateEventHandler")),
this.Rwf=!0);this.Qrf=a}ROc(a,b){(b.dO||b.nW)&&this.X0k(b.dO,b.nW)}X0k(a,b){this.L1j&&this.je.Vg(this.J0b);this.LMc=this.LMc||a;this.eLc=this.eLc||b;this.J0b=new ne.a(4,1,Ku.Tij,()=>{this.Qrf(this.LMc,this.eLc);this.reset()},126);this.je.Jb(this.J0b)}reset(){this.J0b=null;this.eLc=this.LMc=!1}}Ku.Tij=100;Object(m.a)(Ku,"EditingViewOnAfterValidateEventsConsolidator",null,[1718]);class rs{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){ad.App.GPf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}fc(a){this.Da=
a;a.register(Ku,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().na(()=>new Ku(A.AFrameworkApplication.Be,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Oc,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().na(()=>new Oc(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),
Me.a.instance))}static main(){C.a.instance.Ac(new rs)}}Object(m.a)(rs,"Box4AccessibilityPackage",null,[2,3]);class Dw{constructor(a,b){this.kEf=a;this.q4=b;this.FDf=this.CDf=this.DDf=this.EDf=this.dpf=this.GDf=!0}get Kmb(){return this.GDf}get jRc(){return this.dpf}get Hvd(){return this.EDf}get Yvc(){return this.DDf}get Fvd(){return this.CDf}get a4e(){return this.FDf}MTf(a){if(a)for(const c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.GDf=
f;break;case "CapitalizeFirstLetterOfSentences":this.dpf=f;break;case "ReplaceOrdianalsWithSuperscript":this.EDf=f;break;case "ReplaceHyphensWithDash":this.DDf=f;break;case "ReplaceFractionsWithFractionCharacter":this.CDf=f;break;case "ReplaceQuoteWithSmartQuote":this.FDf=this.q4&&f}}}Luj(){this.kEf.Qle("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(R.a)(this,
this.N5k,"onGetRequestFinished"),8);da.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}TJl(a){this.kEf.cOh("saveAutoCorrectOptionsSettings",a);da.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.MTf(a)}N5k(a){a.Pm?da.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.MTf(a),da.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",
!a||!Qa.a.count(a)))}}Object(m.a)(Dw,"AutoCorrectOptionsInfo",null,[1724]);var Lu=d(220);class Cj{static get vQf(){Cj.IVb||(Cj.IVb=[],Cj.gLb(Ea.a.Oe("ar-sa")),Cj.gLb(Ea.a.Oe("de-de")),Cj.gLb(Ea.a.Oe("es-es")),Cj.IS(Ea.a.Oe("en-029"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-au"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-bz"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-ca"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-gb"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-id"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-my"),Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("en-ph"),
Ea.a.Oe("en-us")),Cj.IS(Ea.a.Oe("zh-tw"),Ea.a.Oe("en-us")),Cj.gLb(Ea.a.Oe("fr-fr")),Cj.IS(Ea.a.Oe("hr-ba"),Ea.a.Oe("hr-hr")),Cj.IS(Ea.a.Oe("it-ch"),Ea.a.Oe("it-it")),Cj.IS(Ea.a.Oe("nb-no"),Ea.a.Oe("nn-no")),Cj.gLb(Ea.a.Oe("nl-nl")),Cj.IS(Ea.a.Oe("ro-md"),Ea.a.Oe("ro-ro")),Cj.IS(Ea.a.Oe("ru-md"),Ea.a.Oe("ru-ru")),Cj.IS(Ea.a.Oe("sr-latn-ba"),Ea.a.Oe("sr-latn-cs")),Cj.IS(Ea.a.Oe("sr-latn-me"),Ea.a.Oe("sr-latn-cs")),Cj.IS(Ea.a.Oe("sr-latn-rs"),Ea.a.Oe("sr-latn-cs")),Cj.gLb(Ea.a.Oe("sr-cyrl-cs")),Cj.IS(Ea.a.Oe("sv-fi"),
Ea.a.Oe("sv-se")));return Cj.IVb}static gLb(a){Cj.IVb[a.languageId]=a.LCID}static IS(a,b){Cj.IVb[a.LCID]=b.LCID}static $ig(a){var b=Ea.a.Oe(a);if(!b)return 0;b=Cj.vQf[b.LCID]||Cj.vQf[b.languageId]||0;return b===a?0:b}}Cj.IVb=null;Object(m.a)(Cj,"AutoCorrectListFallback",null,[]);class io{constructor(a,b,c,f,l){this.dwf=!1;this.Hyf=0;this.oQa=null;this.xni=!1;this.Byf=this.tAf=!0;this.vvf=null;this.eIc=!0;this.usb=a;this.pQa=b;this.B7a=c;this.V8=f;this.Ch=l;this.z_b=a?a.innerText:$a.ParagraphReader.text(b)}get ty(){throw Error.notImplemented("The inherit class should have the default value.");
}set ty(a){}get s$c(){return this.Hyf}uOh(a){this.Hyf=a}get kb(){return this.oQa}set kb(a){this.oQa=a}get ewg(){return this.usb}get Krg(){return this.pQa}get wB(){return this.B7a}get JS(){return this.V8}get BLb(){return this.tAf}set BLb(a){this.tAf=a}get WBg(){return this.dwf}get LGg(){return!1}get Xpa(){return this.z_b}invoke(){this.dwf=!0;if(this.usb&&this.usb.parentNode&&!this.ty){var a=this.usb.innerText;if(this.BLb&&Aa.a.substring(this.z_b,this.B7a,this.V8)!==Aa.a.substring(a,this.B7a,this.V8))return 0;
this.Kab(this.usb);this.uOh(this.usb.innerText.length-a.length);return 1}this.eIc||jd.a.instance.kc("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.Byf)return jd.a.instance.kc("AbortedAction",{["Reason"]:this.vvf}),0;var b=$a.ParagraphReader.text(this.pQa);a=b.length;var c=this.z_b.length,f=Aa.a.substring(this.z_b,this.B7a,this.V8).trimEnd();b=Aa.a.substring(b,this.B7a,this.V8).trimEnd();f===b&&this.V8>c&&(this.V8=c);if(this.BLb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===
Aa.a.substr(b,0,c.length))this.V8-=2;else return 0;if(U.a.instance.ga(50)&&ad.App.ni.qy&&wA.CoauthLockEditor.getInstance().VRb(io.Jj.W$b(this.pQa)))return 0;c=new pg.GraphTransaction(15);c.rd(this.pQa);c.Wc=this.commandId;this.V9(this.pQa);this.uOh($a.ParagraphReader.textLength(this.pQa)-a);this.oQa&&!this.xni&&Bc.SelectionEditor.uy(this.oQa)&&(b=this.oQa.Ua,a=b.Ra,f=b.Pb,b=b.node,b===this.pQa&&this.s$c&&(a>=this.V8&&(a+=this.s$c),f>=this.V8&&(f+=this.s$c),this.oQa=$d.SelectionFactory.U4(b,a,f)));
c.dispose();return 2}N4h(){this.eIc=this.kWf()}Kab(){}kWf(){var a=$a.ParagraphReader.text(this.pQa);const b=Aa.a.substring(this.z_b,this.B7a,this.V8).trimEnd();a=Aa.a.substring(a,this.B7a,this.V8).trimEnd();return b===a}static get Jj(){return mi.a.instance}}Object(m.a)(io,"AutoCorrectAction",null,[1015]);class nn extends io{constructor(a,b,c,f,l,u){super(a,b,c,f,u);this.Qyf=null;this.rpa=l;this.QW=u}get GYa(){return this.Qyf||(this.Qyf=Tb.a.instance.ub("Box4.List.IListCommands"))}get hs(){return nn.ir||
(nn.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}get ty(){return!0}get commandId(){return G.a.D1d}set ty(a){super.ty=a}}nn.ir=null;Object(m.a)(nn,"RegexCorrectAction",io,[]);const ss={[0]:{"a)":{autonumberBulletType:2,Dj:[65533,4,41]},"a.":{autonumberBulletType:4,Dj:[65533,4,46]},"A.":{autonumberBulletType:5,Dj:[65533,3,46]},"1)":{autonumberBulletType:7,Dj:[65533,0,41]},"1.":{autonumberBulletType:8,Dj:[65533,0,46]},"i.":{autonumberBulletType:14,Dj:[65533,2,46]},"I.":{autonumberBulletType:15,
Dj:[65533,1,46]}},[1]:{"*":{Dj:[8226],font:"Arial"},"-":{Dj:[45],font:"Calibri"},"--":{Dj:[167],font:"Wingdings"},">":{Dj:[216],font:"Wingdings"},"<>":{Dj:[118],font:"Wingdings"}}};class Ek extends nn{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u);Ek.KPa=u}get commandId(){return G.a.v1d}V9(a){if(this.GYa){var b=mb.GraphIterator.ob(a);b.wf();jb.OutlineElementNavigator.$e(b);var c=Ek.eg.Aw(b),f=this.rpa[0];switch(Aa.a.charAt(f,0)){case "*":var l=Gf.a.JO(1,1);l.Ita="*";break;default:l=Gf.a.JO(1,0)}c&&l.Bne(c)||
(c=new pg.GraphTransaction(15),c.Jz(b),b=this.yvj(l.listType,l.listStyle,f),null!=b&&this.GYa.ZLi(b)&&(da.ULS.sendTraceTag(509747285,393,50,"Found list insert matching string "+f),Ek.KPa.replaceTextRange(me.a.createTextRange(a,this.wB,this.JS+1),"",!0,!1)),c.dispose())}}yvj(a,b,c){var f;const l=null===(f=null===ss||void 0===ss?void 0:ss[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new W.DictionaryPropertySet;c.setValue(Oe.a.pF,a);c.setValue(Oe.a.iga,b);c.setValue(rb.a.Dj,l.Dj);c.setValue(rb.a.font,
l.font);return c}static get characterPropertiesEditor(){return Ek.KPa||(Ek.KPa=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get eg(){return Ek.qh||(Ek.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static CD(a,b,c,f,l){return new Ek(null,a,b,c,f,l)}static pR(a,b,c,f,l){return new Ek(a,ig.a(a).eb,b,c,f,l)}}Ek.KPa=null;Ek.qh=null;Object(m.a)(Ek,"BulletListAction",nn,[]);class zh extends nn{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u);this.MYb=!1;this.ty=!a;this.KPa=u;zh.Xl=new Cc.a}get ty(){return this.MYb}set ty(a){this.MYb=
a}Kab(a){this.v4d(a.innerText,(b,c,f)=>{a.innerText=Aa.a.substring(a.innerText,0,b)+f+Aa.a.right(a.innerText,c)})}V9(a){this.v4d($a.ParagraphReader.text(a).substring(this.wB,this.JS),(b,c,f)=>{this.KPa.replaceTextRange(me.a.createTextRange(a,this.wB+b,this.wB+c),f,!0,!1)})}v4d(a,b){if(!(2>this.rpa.length)&&this.rpa[1]){var c=this.rpa[1];zh.Xl.count||this.$uh();zh.Xl.Ib(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,zh.Xl.ga(c)))}}}zh.Xl=null;Object(m.a)(zh,"DictionarySequenceReplacerAction",nn,[]);
class wt extends zh{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u)}get commandId(){return G.a.Z3b}$uh(){zh.Xl.$("--","\u2014");zh.Xl.$(" -- "," \u2013 ");zh.Xl.$(" - "," \u2013 ");zh.Xl.$("-- ","\u2014");zh.Xl.$(" --"," \u2013");zh.Xl.$(" -"," \u2013")}static CD(a,b,c,f,l){return new wt(null,a,b,c,f,l)}static pR(a,b,c,f,l){return new wt(a,ig.a(a).eb,b,c,f,l)}}Object(m.a)(wt,"DashAction",zh,[]);class ts extends zh{constructor(a,b,c,f,l,u,I){super(a,b,c,f,l,u);this.Ca=I}get commandId(){return G.a.x1d}$uh(){zh.Xl.$(":)",
"\ud83d\ude0a");zh.Xl.$(":-)","\ud83d\ude0a");zh.Xl.$(":|","\ud83d\ude10");zh.Xl.$(":-|","\ud83d\ude10");zh.Xl.$(":(","\ud83d\ude41");zh.Xl.$(":-(","\ud83d\ude41");zh.Xl.$(";)","\ud83d\ude09");zh.Xl.$(";-)","\ud83d\ude09");zh.Xl.$(":D","\ud83d\ude00");zh.Xl.$(":-D","\ud83d\ude00");zh.Xl.$(":')","\ud83d\ude02");zh.Xl.$("=D","\ud83d\ude03");zh.Xl.$(":>","\ud83d\ude06");zh.Xl.$(":->","\ud83d\ude06");zh.Xl.$(":3","\ud83d\ude0a");zh.Xl.$(":-3","\ud83d\ude0a");zh.Xl.$("B-)","\ud83d\ude0e");zh.Xl.$("*-*",
"\ud83d\ude0d");zh.Xl.$(":*","\ud83d\ude19");zh.Xl.$(":-*","\ud83d\ude19");zh.Xl.$(":X","\ud83d\ude36");zh.Xl.$(":-X","\ud83d\ude36");zh.Xl.$(":O","\ud83d\ude2e");zh.Xl.$(":-O","\ud83d\ude2e");zh.Xl.$(":#","\ud83e\udd10");zh.Xl.$(":-#","\ud83e\udd10");zh.Xl.$(":P","\ud83d\ude1b");zh.Xl.$(":-P","\ud83d\ude1b");zh.Xl.$(";P","\ud83d\ude1c");zh.Xl.$(";-P","\ud83d\ude1c");zh.Xl.$(":-/","\ud83d\ude15");zh.Xl.$("$-$","\ud83e\udd11");zh.Xl.$(":S","\ud83d\ude16");zh.Xl.$(":-S","\ud83d\ude16");zh.Xl.$(":[",
"\ud83d\ude1f");zh.Xl.$(":-[","\ud83d\ude1f");zh.Xl.$(":\u2019(","\ud83d\ude22");zh.Xl.$(":'(","\ud83d\ude22");zh.Xl.$("@-@","\ud83d\ude31")}V9(a){this.v4d($a.ParagraphReader.text(a).substring(this.wB,this.JS),(b,c,f)=>{b=me.a.createTextRange(a,this.wB+b,this.wB+c);c={};c.MenuItemId=f;this.Ca.Ai(b,G.a.kbk,2,!1,null,c,null)})}static CD(a,b,c,f,l,u){return new ts(null,a,b,c,f,l,u)}static pR(a,b,c,f,l,u){return new ts(a,ig.a(a).eb,b,c,f,l,u)}}Object(m.a)(ts,"EmojiAction",zh,[]);class np{constructor(a,
b,c,f){this.HL=a;this.zMc=b;this.Mxf=f;this.KA=c}gEg(){if(!this.KA)return!1;this.HL=this.HL.trimStart();return this.HL===this.KA?!0:!1}Rtk(){if(!this.HL)return!1;const a=this.HL.lastIndexOf(" ");return-1!==a&&"."===this.HL.charAt(a-1)&&"."===this.HL.charAt(a-3)?!0:!1}Qtk(){if(!this.HL)return!1;var a=this.HL.lastIndexOf(" ");return-1!==a&&(a=this.HL.substring(0,a-1).lastIndexOf(" "),"."===this.HL.charAt(a+2))?!0:!1}vmk(){return this.gEg()&&(1===this.KA.length&&"."===this.zMc||"."===this.HL.charAt(1))?
!0:!1}wmk(){return this.KA?0<="\\/".indexOf(this.zMc)||3===this.KA.length&&0<="\\/".indexOf(this.KA.charAt(1))?!0:!1:!1}ulk(){return this.KA?0<=this.KA.indexOf("@")?!0:!1:!1}ou(){if(!this.KA)return!1;for(const a of np.fme())if(Aa.a.startsWith(this.KA+this.zMc,a))return!0;return!1}$kk(){return this.KA?"i"===this.KA&&0<=np.quotes.indexOf(this.zMc)?!0:!1:!1}hgk(){if(!this.HL)return!1;const a=Aa.a.mIa(this.HL,this.HL.length-1);if(-1!==a&&this.HL.substring(a+1,this.HL.length)===this.KA){const b=this.HL.charAt(a-
1);if(0<=np.c7e.indexOf(b)||0<=np.quotes.indexOf(b)&&0<=np.c7e.indexOf(this.HL.charAt(a-2)))return!0}return!1}GRi(){return!this.HL||this.Rtk()||this.vmk()||this.wmk()||this.Qtk()||this.ulk()||this.ou()?!1:this.gEg()||this.$kk()||this.hgk()?!0:!1}static fme(){return np.Pyf||(np.Pyf="http: https: ftp:// mailto: \\\\ www.".split(" "))}}np.c7e=".!?";np.quotes="'\"";np.Pyf=null;Object(m.a)(np,"FirstLetterUpperCaseRules",null,[]);class Kp{constructor(a){this.KA=a}Uqj(){if(!this.KA)return null;for(let a=
0;a<Kp.Vqg().length;a++)if(this.KA===Kp.Vqg()[a])return Kp.qSj()[a];return null}static Vqg(){return Kp.wtf||(Kp.wtf=["1/2","1/4","3/4"])}static qSj(){return Kp.vtf||(Kp.vtf=["\u00bd","\u00bc","\u00be"])}}Kp.wtf=null;Kp.vtf=null;Object(m.a)(Kp,"FractionsCollection",null,[]);class hi extends io{constructor(a,b,c,f,l,u){super(a,b,c,f,u);this.xWb=l;this.QW=u}get ty(){return!0}get commandId(){return G.a.y1d}Kab(a){a.innerText=Aa.a.substring(a.innerText,0,this.wB)+this.xWb+Aa.a.right(a.innerText,this.JS)}V9(a){this.QW.replaceTextRange(me.a.createTextRange(a,
this.wB,this.JS),this.xWb,!0,!1)}set ty(a){super.ty=a}static CD(a,b,c,f,l){return new hi(null,a,b,c,f,l)}}Object(m.a)(hi,"FractionsReplaceCorrectAction",io,[]);class h extends nn{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u)}get commandId(){return G.a.A1d}V9(a){if(this.GYa){var b=mb.GraphIterator.ob(a);b.wf();jb.OutlineElementNavigator.$e(b);var c=this.rpa[0],f=h.s1k(c),l=Aa.a.ugc(c.charAt(0))?4:2,u=me.a.createTextRange(a,this.wB,this.JS+1);this.hs.SSa(a,b,l,f,u,c,this.GYa)}}static CD(a,b,c,f,l){return new h(null,
a,b,c,f,l)}static pR(a,b,c,f,l){return new h(a,ig.a(a).eb,b,c,f,l)}static s1k(a){if(!a)return 0;a=Aa.a.Dg(a);if(!Aa.a.g6c(a.charAt(0)))return 0;const b=a.charCodeAt(0)-97+1;let c;for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(m.a)(h,"LetterListAction",nn,[]);class x extends nn{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u)}get commandId(){return G.a.SSa}V9(a){if(this.GYa){var b=mb.GraphIterator.ob(a);b.wf();jb.OutlineElementNavigator.$e(b);var c=this.rpa[0],f=parseInt(c);
if(!(99999999<=f)){var l=me.a.createTextRange(a,this.wB,this.JS+1);this.hs.SSa(a,b,1,f,l,c,this.GYa)}}}static CD(a,b,c,f,l){return new x(null,a,b,c,f,l)}static pR(a,b,c,f,l){return new x(a,ig.a(a).eb,b,c,f,l)}}Object(m.a)(x,"NumberListAction",nn,[]);class O extends io{constructor(a,b,c,f,l){super(a,b,c,f,l);O.QW=l}get ty(){return!0}get commandId(){return G.a.B1d}Kab(){}V9(a){const b=me.a.createTextRange(a,this.JS-2,this.JS),c=new pg.GraphTransaction(15);c.rd(a);let f=!1,l=null,u=0;for(;u<a.Sa.length;){var I=
a.Sa.ga(u),T=!!I.Ap||I.aga;const ja=!!I.fieldRangeEnd||I.k1;if(I.cp>=b.Ra){I.cp>b.Ra||!I.formatting?l=f?I.formatting:O.QW.Gia(a,u,b.Ra,l):(l=I.formatting,ja&&(f=!1),T&&(f=!0));u++;break}I.formatting&&(l=I.formatting);ja&&(f=!1);T&&(f=!0);u++}for(;u<a.Sa.length;){T=a.Sa.ga(u);if(T.cp>=b.Pb){if(T.cp>b.Pb||!T.formatting&&!T.Bk)f||O.QW.Gia(a,u,b.Pb,l);f||O.Eh.m_(l,!0);break}T.formatting&&(f||O.Eh.m_(l,!0),l=T.formatting);I=!!T.Ap||T.aga;T=!!T.fieldRangeEnd||T.k1;I&&(f=!0);!I&&T&&(f=!1);u++}c.dispose()}set ty(a){super.ty=
a}static get Eh(){return O.Sf||(O.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}static CD(a,b,c,f){return new O(null,a,b,c,f)}}O.QW=null;O.Sf=null;Object(m.a)(O,"OrdinalsReplaceCorrectAction",io,[]);class fa extends nn{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u);fa.Gtb||fa.L5l();this.KPa=u}get commandId(){return G.a.C1d}V9(a){if(!a.R0j){var b=this.oQa.Ua.node===a,c=-1,f=3;this.rpa[2]&&(c=parseInt(this.rpa[2]));this.rpa[1]&&(f=parseInt(this.rpa[1]));if(!(20<c||100<f)){a.eI().graphTransactionOperations.ala(7);
var l=mb.GraphIterator.ob(a);l.wf();jb.OutlineElementNavigator.$e(l);fa.zi.Nfa(l,!1,!1);fa.zi.Fea(l);for(let T=0;T<f;++T){const ja=[];var u=T%fa.Gtb.length,I=0<c?c:fa.Gtb[u].length;for(let ua=0;ua<I;++ua)Array.add(ja,fa.Gtb[u][ua%fa.Gtb[u].length]);u=me.a.rk(l.currentNode,0);I=Od.a.yt(u);2!==ad.App.mode?fa.Eh.q3a(I,1142):fa.Eh.un(I,ib.a.noProof,!0);this.KPa.replaceTextRange(u,ja.join(" "),!0,!1);T<f-1&&(jb.OutlineElementNavigator.$e(l),fa.zi.Nfa(l,!1,!1),fa.zi.Fea(l))}c=l.currentNode;l=mb.GraphIterator.ob(a);
l.wf();jb.OutlineElementNavigator.$e(l);l.rj();b&&(this.oQa=$d.SelectionFactory.fh(c,$a.ParagraphReader.textLength(c)))}}}static get zi(){return fa.Rj||(fa.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Eh(){return fa.Sf||(fa.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}static L5l(){fa.Gtb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],
["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.","Proin pharetra nonummy pede.","Mauris et orci."]]}static CD(a,b,c,f,l){return new fa(null,a,b,c,f,l)}static pR(a,b,c,f,l){return new fa(a,ig.a(a).eb,b,c,f,l)}}fa.Gtb=null;fa.Rj=null;fa.Sf=null;Object(m.a)(fa,"RandAction",nn,[]);class xa{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.H5j=b;this.lTj=c;this.flags=
f}}Object(m.a)(xa,"RegexAutoCorrectEntry",null,[]);class Sa extends nn{constructor(a,b,c,f,l,u){super(a,b,c,f,l,u)}get commandId(){return G.a.E1d}V9(a){if(this.GYa){var b=mb.GraphIterator.ob(a);b.wf();jb.OutlineElementNavigator.$e(b);var c=this.rpa[0],f=Aa.a.substring(c,0,c.indexOf("."));f=Sa.t1k(f);if(!(0>=f)){var l=Aa.a.ugc(c.charAt(0))?5:3,u=me.a.createTextRange(a,this.wB,this.JS+1);this.hs.SSa(a,b,l,f,u,c,this.GYa)}}}static CD(a,b,c,f,l){return new Sa(null,a,b,c,f,l)}static pR(a,b,c,f,l){return new Sa(a,
ig.a(a).eb,b,c,f,l)}static eij(){Sa.Rsa||(Sa.Rsa={},Sa.Rsa.M=1E3,Sa.Rsa.D=500,Sa.Rsa.C=100,Sa.Rsa.L=50,Sa.Rsa.X=10,Sa.Rsa.V=5,Sa.Rsa.I=1)}static t1k(a){if(!a)return 0;Sa.eij();a=Aa.a.iD(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=Sa.Rsa[Aa.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}Sa.Rsa=null;Object(m.a)(Sa,"RomanListAction",nn,[]);class nb extends io{constructor(a,b,c,f,l,u){super(a,b,c,c+1,u);this.QW=u;this.Aqi=f;this.eqf=l;this.BLb=!1}get ty(){return!1}get commandId(){return G.a.cHi}Kab(a){a.innerText=
Aa.a.substring(a.innerText,0,this.wB)+this.eqf+Aa.a.right(a.innerText,this.JS)}V9(a){this.QW.replaceTextRange(me.a.createTextRange(a,this.wB,this.JS),this.Aqi,!0,!1);this.QW.replaceTextRange(me.a.createTextRange(a,this.wB,this.wB+1),this.eqf,!0,!1)}set ty(a){super.ty=a}static CD(a,b,c,f,l,u){if("'"!==c&&'"'!==c)return null;var I=mb.GraphIterator.ob(a);I.wf();jb.OutlineElementNavigator.$e(I);if(ge.OutlineElementReader.kn(I.currentNode))return null;f=!b||Aa.a.Iye(f)||-1!==Array.indexOf(nb.Kal,f);I=
"'"===c;return new nb(u,a,b,c+"",f?I?"\u2018":"\u201c":I?"\u2019":"\u201d",l)}}nb.Kal=["[","{","("];Object(m.a)(nb,"SmartQuoteCorrectAction",io,[]);class Mb extends io{constructor(a,b,c,f,l,u){super(a,b,c,f,u);this.xWb=l;this.QW=u}get ty(){return Mb.MYb}set ty(a){Mb.MYb=a}get commandId(){return G.a.G1d}N4h(){this.eIc=this.kWf();this.eIc||(this.Byf=!1,this.vvf="MatchTextIsNotTheSame")}Kab(a){a.innerText=Aa.a.substring(a.innerText,0,this.wB)+this.xWb+Aa.a.right(a.innerText,this.JS)}V9(a){this.QW.replaceTextRange(me.a.createTextRange(a,
this.wB,this.JS),this.xWb,!0,!1)}static pR(a,b,c,f,l){const u=ig.a(a);return new Mb(a,u?u.eb:null,b,c,f,l)}static CD(a,b,c,f,l){return new Mb(null,a,b,c,f,l)}}Mb.MYb=!1;Object(m.a)(Mb,"StringReplaceCorrectAction",io,[]);class mc extends io{constructor(a,b,c,f,l,u,I,T){super(a,b,c,f,l);this.QW=l;this.NE=u;this.bhi=I;this.QE=T}get ty(){return!0}get commandId(){return G.a.I1d}Kab(a){let b=Aa.a.substring(a.innerText,this.wB,this.JS);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+
b.substring(1,b.length));a.innerText=Aa.a.substring(a.innerText,0,this.wB)+b+Aa.a.right(a.innerText,this.JS)}V9(a){const b=this.wB,c=this.wB+1,f=a.characterData.substring(b,c).charAt(0);Aa.a.ugc(f)||(a=me.a.createTextRange(a,b,c),this.zgk(a)||this.QW.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}zgk(a){return this.bhi?!!this.NE&&this.NE.mwa(a):!1}set ty(a){super.ty=a}static pR(a,b,c,f){const l=ig.a(a);return new mc(a,l?l.eb:null,b,c,f,null,!1,null)}static CD(a,b,c,f,l,u,I){return new mc(null,
a,b,c,f,l,u,I)}}Object(m.a)(mc,"UpperFirstLetterAutoCorrect",io,[]);class Nc{constructor(a,b){this.Mxf=b;this.KA=a}Rmm(){const a=Number.parseInvariant(this.KA.substring(0,this.KA.length-2));switch(Number.parseInvariant(this.KA.charAt(this.KA.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}Hmk(){var a=Ea.a.Oe(this.Mxf);if(!a||!a.name.toLowerCase().startsWith("en")||
!this.KA||2>=this.KA.length)return!1;for(a=0;a<Nc.N2c().length;a++)if(this.KA.toLowerCase().endsWith(Nc.N2c()[a])){if(RegExp("^\\d+$").test(this.KA.substr(0,this.KA.length-2))){const b=this.Rmm();if(this.KA.toLowerCase().endsWith(Nc.N2c()[a])&&b===Nc.N2c()[a])return!0}break}return!1}static N2c(){return Nc.ABf||(Nc.ABf=["st","nd","rd","th"])}}Nc.ABf=null;Object(m.a)(Nc,"ValidateOrdinalsRule",null,[]);class Tc{constructor(a,b,c,f,l,u,I){this.h8a=[];this.$qb=[];this.HVb=[];this.gId=[];this.ssa=-1;this.Puf=
this.q4=this.FFc=!1;this.NGc=a;this.Ch=b;this.NE=c;this.Ca=f;this.wT=u;this.QE=I;l?(this.FFc=l.getBooleanAppSetting("WordEditorEmoticonAutoCorrectIsEnabled")||l.getBooleanAppSetting("OneNoteInsertEmojiIsEnabled"),this.q4=l.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"),this.Puf=l.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"),da.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.FFc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.q4})):(da.ULS.sendTraceTag(23418954,
324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.q4=this.FFc=!1)}Vue(a){return 0<=Tc.w1d.indexOf(a)}Bsk(a){return 0<=Tc.H1d.indexOf(a)}oDg(a){return a.toLowerCase()===a}ugc(a){return a.toUpperCase()===a}g6c(a){return a.toLowerCase()!==a.toUpperCase()}Bik(a,b,c,f){return(new np(a,b,c,f)).GRi()}ryj(a){do{if(a.getAttribute("xml:lang"))return Ea.a.Oe(a.getAttribute("xml:lang"))||Ea.a.cec;if(a.getAttribute("lang"))return Ea.a.Oe(a.getAttribute("lang"))||
Ea.a.cec;a=a.parentNode}while(a&&1===a.nodeType);return Ea.a.cec}Rge(a){return Ea.a.Oe(Od.a.language(Od.a.yt(a)))||Ea.a.cec}lYc(a,b){0>b&&(b=0);let c=-1;const f=Tc.w1d.length;for(let l=0;l<f;++l){const u=a.lastIndexOf(Aa.a.charAt(Tc.w1d,l),b);u>c&&(c=u)}a=Aa.a.mIa(a,b);a>c&&(c=a);return c}snj(a){for(let b=0;b<a.length;++b)if(this.g6c(Aa.a.charAt(a,b)))return b;return-1}Gcg(a,b){if(!a||0>b)return-1;let c=b;c=c?this.lYc(a,c-1):-1;c=c>Aa.a.mIa(a,b-1)?c:Aa.a.mIa(a,b-1);c++;return c}zcg(a,b,c){if(!U.a.instance.ga(70))return null;
this.W8b(b);if(!this.$qb[b])if(b=Cj.$ig(b),0<b){if(this.W8b(b),!this.$qb[b])return null}else return null;if(c&&this.HVb[b]&&Array.contains(this.HVb[b],a+c))return null;c=this.$qb[b][Aa.a.Dg(a)];if("string"!==typeof c||c===a)return null;if(c){var f=this.snj(a);if(0>f||this.oDg(Aa.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=Aa.a.charAt(a,f);b&&!this.ugc(l)&&(b=!1)}return b?Aa.a.iD(c):Aa.a.iD(Aa.a.substring(c,0,1))+Aa.a.right(c,1)}return null}Anj(a,b,c,f){He.a.mark(4666);const l=this.ryj(b).LCID;
let u=0,I=a;const T=b.innerText;var ja=T.lastIndexOf(" ",a);if(this.qve(T.substring(ja+1,a)))return He.a.mark(4667),null;ja=null;var ua=!1;do{I=I?this.lYc(T,I-1):-1;if(-1===I&&!c){ua=b;var Ra=null;if(!this.Vue(T.charAt(0))){do{for(;ua&&!ua.previousSibling;)ua=ua.parentNode;ua&&(ua=ua.previousSibling,Ra=ua.innerText)}while(ua&&!Ra);if(ua&&Ra&&!this.Vue(Aa.a.charAt(Ra,Ra.length-1)))return He.a.mark(4667),null}ua=!0}Ra=Aa.a.substring(T,I+1,a);++u;var eb=this.zcg(Ra,l,f.toString());if(eb)ja=Mb.pR(b,I+
1,a,eb,this.Ch);else for(eb=0;eb<this.h8a.length;++eb){const Bb=this.h8a[eb];if(!(Bb.flags&1&&!(c&&1>I)||Bb.flags&4||Bb.flags&2&&" "!==f)){const Ub=Bb.pattern.exec(Ra);if(Ub){ja=Bb.H5j(b,I+1,a,Ub,this.Ch,this.Ca);break}}}}while(!ua&&!ja&&u<Tc.Cgh&&0<=I);He.a.mark(4667);return ja}wnj(a,b,c){const f=a.node;let l=$a.ParagraphReader.text(f);0>b&&(b=a.Ra);a=this.Rge(a).LCID;if(this.qve(l.substring(Aa.a.mIa(l,b)+1,b)))return null;var u=-1,I=gf.HyperlinkReader.tac(f);for(var T=0;T<I.length;T++)if(b>I[T].Pb)u=
I[T].Pb;else{if(b>I[T].Ra)return null;break}I=null;T=(T=b)?this.lYc(l,T-1):-1;T<u&&(T=u-1);u=Aa.a.substring(l,T+1,b);u=u.trimStart();if(1>T)for(let ja=0;ja<this.h8a.length;++ja){const ua=this.h8a[ja];let Ra=l;" "!==c&&(Ra=l+c);if(ua.pattern.exec(Ra))return null}l=l.substring(0,b);if(!this.Bik(l,c.toString(),u,a))return null;u.charAt(0).toUpperCase()!==u.charAt(0)&&(I=mc.CD(f,T+1,b,this.Ch,this.NE,U.a.instance.ga(14),this.QE));return I}dcg(a,b,c){a=$d.SelectionFactory.hk(a,!1);if(!a)return null;a=
a.vf;return Bc.SelectionEditor.nh(a)?this.wnj(a,b,c):null}qve(a){return Aa.a.O$(a)}Mde(a,b,c,f){He.a.mark(4666);const l=a.node,u=this.Rge(a).LCID,I=$a.ParagraphReader.text(l);0>b&&(b=a.Ra);if(c&&!this.Vue(Aa.a.charAt(I,b))||this.qve(I.substring(Aa.a.mIa(I,b)+1,b)))return He.a.mark(4667),null;a=-1;c=gf.HyperlinkReader.tac(l);for(var T=0;T<c.length;T++)if(b>c[T].Pb)a=c[T].Pb;else{if(b>c[T].Ra)return null;break}c=0;T=b;let ja=null;do{T=T?this.lYc(I,T-1):-1;T<a&&(T=a-1);const Ra=Aa.a.substring(I,T+1,
b);++c;var ua=this.zcg(Ra,u,f==H.a.ZOa?".":null);if(ua)this.wT.Kmb&&(ja=Mb.CD(l,T+1,b,ua,this.Ch));else for(ua=0;ua<this.h8a.length;++ua){const eb=this.h8a[ua];if(!(eb.flags&1&&!(0>T)||eb.flags&4&&f!==H.a.Mp||eb.flags&2&&f!==H.a.fO)){const Bb=eb.pattern.exec(Ra);if(Bb){ja=eb.lTj(l,T+1,b,Bb,this.Ch,this.Ca);if(ja.commandId!==G.a.Z3b&&!this.wT.Kmb||ja.commandId===G.a.Z3b&&!this.wT.Yvc)ja=null;break}}}}while(0<=T&&T>=a&&!ja&&c<Tc.Cgh);He.a.mark(4667);return ja}ccg(a,b,c){a=$d.SelectionFactory.hk(a,!1);
if(!a)return null;a=a.vf;return Bc.SelectionEditor.nh(a)?this.Mde(a,b,!1,c):null}jcg(a,b){a=$d.SelectionFactory.hk(a,!1);if(!a)return null;a=a.vf;if(!Bc.SelectionEditor.nh(a)||gf.HyperlinkReader.lna(a,!1))return null;var c=$a.ParagraphReader.text(a.node);const f=0<b?Aa.a.mIa(c,b-1)+1:Aa.a.mIa(c,c.length-1)+1;b=0<b?b:c.length;c=Aa.a.substring(c,f,b);return!c||this.Puf&&!gf.HyperlinkReader.Dye(c)||!Aa.a.O$(c)&&!Aa.a.Eec(c)||!Tc.hyperlinkEditor.Ozl(a,f,b)?null:this.NGc.R3i(a.node,f,b)}ncg(a,b){var c=
$d.SelectionFactory.hk(a,!1);if(!c)return null;var f=c.vf;if(!Bc.SelectionEditor.nh(f))return null;0>b&&(b=f.Ra);var l=$a.ParagraphReader.text(f.node);c=this.Gcg(l,b);const u=Tc.H1d.length;for(let I=0;I<u;++I){const T=l.lastIndexOf(Aa.a.charAt(Tc.H1d,I),b-1);T>c&&(c=T+1)}l=Aa.a.substring(l,c,b);if(!l)return null;f=this.Rge(f).LCID;return(new Nc(l,f)).Hmk()?O.CD(a,c,b,this.Ch):null}bcg(a,b){var c=$d.SelectionFactory.hk(a,!1);if(!c)return null;c=c.vf;if(!Bc.SelectionEditor.nh(c))return null;0>b&&(b=
c.Ra);var f=$a.ParagraphReader.text(c.node);c=this.Gcg(f,b);f=Aa.a.substring(f,c,b);return f?(f=(new Kp(f)).Uqj())?hi.CD(a,c,b,f,this.Ch):null:null}goj(a,b,c,f,l){var u=$d.SelectionFactory.hk(a,!1);if(!u)return null;u=u.vf;if(c>b||!Bc.SelectionEditor.nh(u))return null;0>b&&(b=u.Ra);if(0>b)return null;u=$a.ParagraphReader.text(u.node);return nb.CD(a,c,l,b?u.charAt(b-1):"\x00",this.Ch,f)}XDa(a,b,c,f){Array.add(this.h8a,new xa("^"+a+"$",b,c,f))}fRe(a){if(this.$qb[this.ssa]){const b=this.$qb[this.ssa];
for(const c in a)b[c]=a[c]}else this.$qb[this.ssa]=a}gRe(a){this.HVb[this.ssa]?Array.addRange(this.HVb[this.ssa],a):this.HVb[this.ssa]=a}H4e(){this.ssa=-1}F1d(){this.lhj(this.ssa);this.ssa=-1}gxk(a,b){this.gId[b]||(this.gId[b]=!0,this.ssa=b,b=document.createElement("script"),b.type="text/javascript",b.src=a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}lhj(a){a=Cj.$ig(a);0<a&&this.W8b(a)}qxk(){U.a.instance.ga(70)&&
(this.W8b(1033),this.XDa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",fa.pR,fa.CD,5),this.XDa("(\\d+)[\\.|\\)]",x.pR,x.CD,3),this.XDa("(L|l|C|c|D|d|M|m){1}\\.",h.pR,h.CD,3),this.XDa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",Sa.pR,Sa.CD,11),this.XDa("([A-Za-z]){1}[\\.|\\)]",h.pR,h.CD,3),this.XDa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",Ek.pR,Ek.CD,3),this.XDa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",wt.pR,wt.CD,0),this.FFc&&(this.XDa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",ts.pR,
ts.CD,0),this.XDa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",ts.pR,ts.CD,0)))}W8b(a){this.gId[a]||this.gxk(Lu.a.eJi(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return Tc.uo||(Tc.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}}Tc.w1d=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Tc.H1d=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Tc.c7e=".!?";Tc.Cgh=5;Tc.uo=null;Object(m.a)(Tc,"AutoCorrectRules",null,[1720]);class ae{constructor(a,
b,c,f,l,u){this.vsa=this.uG=null;this.BL=a;this.Vc=b;this.yd=c;this.gof=f.getBooleanAppSetting("AutoCorrectFirstLetterUpperCaseEnabled");this.jof=f.getBooleanAppSetting("AutoFormatOrdinalNumberAndFractionsEnabled");this.q4=f.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled");this.Gda=l;this.SBa=!!u;this.$t=u;this.umi=new yu.a;this.SBa&&this.Vc.AG(Object(R.a)(this,this.xMb,"onSetSelectionFinished"))}aUb(a,b,c){c=void 0===c?-1:c;if(this.Gda.Kmb||this.Gda.Yvc)if(b=this.BL.jcg(a,c)||this.BL.ccg(a,
c,b))this.uG||(this.uG=new Sc),this.uG.xa(b);this.gof&&this.Gda.jRc&&(b=this.BL.dcg(a,c," "))&&(this.uG||(this.uG=new Sc),0<this.uG.qIa&&(this.uG.ava(0).ty=!0,b.BLb=!1),this.uG.xa(b));this.jof&&(this.Gda.Hvd&&4!==ad.App.mode&&(b=this.BL.ncg(a,c))&&(this.uG||(this.uG=new Sc),this.uG.xa(b),da.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.Gda.Fvd&&(a=this.BL.bcg(a,c))&&(this.uG||(this.uG=new Sc),this.uG.xa(a),da.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}s0f(a,
b,c,f,l,u){const I=new Sc;if(0<b){if(!this.gof&&this.Gda.Kmb){var T=this.BL.Anj(c,f,l,u);T&&I.xa(T)}else{if(this.Gda.Kmb||this.Gda.Yvc)if(T=0," "===u?T=H.a.fO:"."===u&&(T=H.a.ZOa),T=this.BL.ccg(a,b,T))T.ty=!0,I.xa(T);this.Gda.jRc&&(T=this.BL.dcg(a,b,u))&&(0<I.qIa&&(T.BLb=!1),I.xa(T))}this.jof&&(this.Gda.Hvd&&4!==ad.App.mode&&(T=this.BL.ncg(a,b))&&(I.xa(T),da.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.Gda.Fvd&&(T=this.BL.bcg(a,b))&&(I.xa(T),da.ULS.sendTraceTag(8271385,
324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===u||'"'===u)&&this.q4&&this.Gda.a4e&&(T=this.BL.goj(a,b,c,f,u))&&(I.xa(T),da.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(const ja of this.umi.values)if((T=ja.s0f(a,b,c,f,l,u))&&!T.isEmpty())for(let ua=0;ua<T.qIa;ua++)I.xa(T.ava(ua));return I}yQe(a,b){return this.BL.jcg(a,b)}zJh(a){this.uG||(this.uG=new Sc);this.uG.xa(a)}ddk(a){if(this.uG){var b=!1;for(var c=0;c<this.uG.qIa;c++){var f=this.uG.ava(c);if(!f)return;
if(!f.WBg){b=!0;break}}if(b){b=this.vsa=null;c=new pg.GraphTransaction(15);c.Wc=a;a=!1;for(f=0;f<this.uG.qIa;f++){const l=this.uG.ava(f);if(!l)return;if(l.WBg)continue;this.SBa&&l.ty&&l.LGg&&(b=l);a||(a=!0,c.rd(l.Krg));l.kb=this.Vc.Oa.kb;const u=this.yd.Cq(l.commandId);l.invoke();u.end();this.Vc.setSelection(l.kb)}this.uG=null;this.vsa=b?b.commandId:null;a&&c.dispose()}}}edk(a){this.vsa=null;const b=new pg.GraphTransaction(15);b.rd(a.Krg);b.Wc=a.commandId;a.kb=this.Vc.Oa.kb;const c=this.yd.Cq(a.commandId);
a.invoke();c.end();this.Vc.setSelection(a.kb);this.SBa&&a.ty&&a.LGg&&(this.vsa=a.commandId);b.dispose()}fdk(a){this.vsa=null;return a.invoke()}W1j(){return this.SBa&&!!this.vsa}a3k(a){if(!this.SBa||!this.vsa)return!1;const b=this.vsa;this.vsa=null;if(!a||!this.$t.YU||this.$t.h9d!==b)return!1;this.$t.undo();return!0}xMb(){this.vsa=null}}Object(m.a)(ae,"AutoCorrectScheduler",null,[1717]);class Ue extends io{constructor(a,b,c,f,l,u){super(a,b,c,f,l);this.ACf=this.Sja=null;this.QW=l;this.zd=u}get Ofa(){return this.Sja||
(this.Sja=Tb.a.instance.ub("Box4.IInternalLinkManager"))}get hvh(){return this.ACf||(this.ACf=Tb.a.instance.ub("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get ty(){return!0}get commandId(){return G.a.z1d}V9(a){He.a.mark(7012);const b=new pg.GraphTransaction(15);b.rd(a);var c=this.wB,f=this.JS;const l=$a.ParagraphReader.text(a),u=l.substring(c,f);let I;var T=(()=>{let Bb=Aa.a.dcf(u);({qSe:I}=Bb);return Bb})().returnValue;u!==T&&(c+=I,f=c+T.length);T=me.a.createTextRange(a,c,f);const ja=
l.substring(c,f);Ue.ukk(l,c,f)&&(this.QW.replaceTextRange(me.a.createTextRange(a,c-1,f+1),ja,!0,!1),--c,--f,T=me.a.createTextRange(a,c,f),c=$d.SelectionFactory.fh(a,f),Me.a.instance.setSelection(c));let ua=gf.HyperlinkReader.GGa(ja);Ue.hyperlinkEditor.Ala(T,ua,!1);let Ra="",eb="";c=!1;this.Ofa&&(()=>{let Bb=this.Ofa.a_h(ua,!0);({vCh:Ra,jrj:eb}=Bb);return Bb})().returnValue&&(ua=Ra,c=!0,f=gf.HyperlinkReader.HD(T,!1),Ue.hyperlinkEditor.eL(f[0].paragraph,f[0].hyperlink),""!==eb&&(this.QW.replaceTextRange(T,
eb,!0,!1),T=me.a.createTextRange(a,this.wB,this.wB+eb.length),a=$d.SelectionFactory.fh(a,this.wB+this.wB+eb.length),Me.a.instance.setSelection(a)),Ue.hyperlinkEditor.Ala(T,ua,!1));b.dispose();!c&&this.hvh&&this.hvh.iCm(T,ua);He.a.mark(7013)}set ty(a){super.ty=a}static get hyperlinkEditor(){return Ue.uo||(Ue.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static ukk(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}
Ue.uo=null;Object(m.a)(Ue,"HyperlinkAction",io,[]);class Ne{constructor(a,b){this.Ch=a;this.zd=b}R3i(a,b,c){return new Ue(null,a,b,c,this.Ch,this.zd)}}Object(m.a)(Ne,"Factory",null,[966]);class Ef{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}fc(a){this.Da=a;a.register(Tc,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().na(()=>new Tc(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),mi.a.instance,A.AFrameworkApplication.Pa,
A.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(Dw,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().na(()=>new Dw(a.resolve("Box4.IRoamingServiceRequestManager"),A.AFrameworkApplication.fa.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(ae,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().na(()=>new ae(a.resolve("Box4.IAutoCorrectRules"),
Me.a.instance,jd.a.instance,A.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),A.AFrameworkApplication.fa.getBooleanAppSetting("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(Ne,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().na(()=>new Ne(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").qxk();
const a=A.AFrameworkApplication.fa;a.getBooleanAppSetting("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.getBooleanAppSetting("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").Luj()}dispose(){}static main(){C.a.instance.Ac(new Ef)}}Object(m.a)(Ef,"Box4AutoCorrectPackage",null,[2,3]);class Qg{get name(){return"Box4.Clipboard"}init(){}dispose(){}fc(){}static main(){C.a.instance.Ac(new Qg)}}Object(m.a)(Qg,"Box4ClipboardPackage",null,[2,3]);var wi=d(594),Zh=d(502),qi=d(335);
class Xg{}Xg.fontSize=0;Xg.bold=!1;Xg.italic=!1;Xg.spacing=0;Object(m.a)(Xg,"DefaultTextCharPropertyBag",null,[]);class fl{constructor(a,b,c,f,l,u,I,T){this.Zad=[rb.a.fontColor,yb.a.jAb];this.tgd=[rb.a.Dj,rb.a.font,yb.a.autonumberBulletType,rb.a.IYa,Oe.a.HYa];this.AMk=[new Zh.a(yb.a.EY,yb.a.Ay),new Zh.a(yb.a.Cna,yb.a.gga),new Zh.a(yb.a.Bna,yb.a.fga)];this.Nxa=a;this.IK=b;this.Plc=c;this.Pi=f;this.VZa=l;this.h_a=u;this.Ub=I;this.Ga=T}dxb(a){return this.P3d(a,-1)}aRc(a){return this.P3d(a,1)}P3d(a,b){return mb.GraphIterator.Xea(()=>
this.h_a?ge.OutlineElementReader.vh(a)&&!a.xcc(14)&&a.xcc(12)&&!this.jkk(a)&&this.NUf(a,b):Kc.ListReader.hl(a)&&this.NUf(a,b))}jkk(a){return(a=this.Ga.Gn(a.currentNode))?a.z1:!1}NUf(a,b){return mb.GraphIterator.Xea(()=>{const c=a.currentNode.ra(ib.a.listLevel,th.a.dHa)+b;if(0>c||c>=qi.a.G9||!this.IK.BR(a,c))return!1;this.h_a||(jb.OutlineElementNavigator.Ti(a),jb.OutlineElementNavigator.$e(a));return!0})}Olb(a,b){this.Srh(a,b)}aVc(a,b){this.Srh(a,b)}Srh(a,b){if(this.P3d(a,b)&&(this.h_a||Kc.ListReader.hl(a))){var c=
a.Gb(2);a.Dc();(new mb.GraphIterator).Uc(a);const f=a.currentNode.ra(ib.a.listLevel,th.a.dHa);(0>f||f>=qi.a.G9)&&ya.a.J(508672142,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=qi.a.G9)&&ya.a.J(508672140,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.IK.BR(a,f),u=this.IK.BR(a,f+b);if(l&&u){a.currentNode.setValue(ib.a.listLevel,f+b);c.setValue(ib.a.listLevel,
f+b);for(b=0;b<c.Sa.length;b++)c.Sa.ga(b).formatting&&c.Sa.ga(b).formatting.vte();this.bCi(c,l,u);this.UBi(c,l,u);this.ZBi(c,l,u);c=a.Gb(4);a.Dc();c&&this.OBi(c,l,u)}}}UBi(a,b,c){b=b.ra(rb.a.fontSize,Xg.fontSize);c=c.ra(rb.a.fontSize,Xg.fontSize)-b;a.Qa(rb.a.fontSize)&&a.setValue(rb.a.fontSize,a.$a(rb.a.fontSize)+c);for(b=0;b<a.Sa.length;++b){const f=a.Sa.ga(b);f||ya.a.J(508672138,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",
b);f&&f.formatting&&f.formatting.RA&&f.formatting.RA.Qa(rb.a.fontSize)&&this.Pi.$q(f.formatting,f.formatting.RA.$a(rb.a.fontSize)+c)}this.VZa&&this.VZa.Qa(rb.a.fontSize)&&(a=this.VZa.fontSize(),this.VZa.$q(a+c))}bCi(a,b,c){if(a.Qa(ib.a.Sm)){var f=a.$a(ib.a.Sm),l=b.ra(ib.a.Sm,th.a.leftMargin);let u=c.ra(ib.a.Sm,th.a.leftMargin);const I=this.Ga.Gn(a);I&&!I.vd&&(l=b.ra(yb.a.C7b,th.a.leftMargin),u=c.ra(yb.a.C7b,th.a.leftMargin));f=f+u-l;0>f&&(l=a.ra(ib.a.Qn,th.a.indent)+f,a.setValue(ib.a.Qn,l));this.Nxa.Cw.Kyd(a,
1,f)}this.BXc(a,b,ib.a.Qn)&&(md.a("FixForCorrectIndent")?c.Qa(ib.a.Qn)&&c.$h(ib.a.Qn)?this.ydc(a,c,ib.a.Qn):ya.a.J(508672146,820,10,"ParaIndentFirstLine property is not set."):this.ydc(a,c,ib.a.Qn))}ZBi(a,b,c){for(const f of this.AMk)this.BXc(a,b,f.first,f.second)&&this.ydc(a,c,f.first,f.second)}OBi(a,b,c){if(this.BXc(a,b,rb.a.Dj,rb.a.font)){if(0===this.Plc.qBb(a)){var f=a.ra(yb.a.autonumberBulletType,8);const l=b.ra(yb.a.autonumberBulletType,8);if(f!==l)return}c.ra(rb.a.Dj,null)?(this.Plc.B5b(a),
a.Vo.apply(a,this.tgd),this.ydc.apply(this,[a,c].concat(this.tgd))):(f=this.Ub.Pc(a),f.uc(11),f.rj())}for(const l of this.Zad)this.BXc(a,b,l)&&(a.removeProperty(l),this.ydc(a,c,l))}BXc(a,b,...c){for(const f of c)if(a.Qa(f)||b.Qa(f))if(!a.Qa(f)||!b.Qa(f)||!wi.APropertySet.V1a(f.type,a.$h(f),b.$h(f)))return!1;return!0}ydc(a,b,...c){for(const f of c)b.Qa(f)&&a.He(f,b.$h(f))}}Object(m.a)(fl,"OutlineElementIndentationEditor",null,[1716]);var Tm=d(156);class il{constructor(a,b){this.Pp=this.zd=this.Eu=
null;this.ir=b;il.qh=a}get hs(){return this.ir.value}get insertionPointFormatting(){return this.Eu||(this.Eu=Tb.a.instance.ub("Box4.IInsertionPointFormatting"))}get kg(){return this.zd||(this.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get g8(){return this.Pp||(this.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}Zke(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.bhg():null;if(c&&!c.equals(Ua.a.nil)){a=
b.Zh;if(!a)return null;c=a.Ie(c);if(!c||c&&1!==Wb.StyleReader.Bva(c))return null}else c=Od.a.yt(a),c=Od.a.LAb(c);return c}mca(a,b,c){var f=void 0===f?!1:f;if($a.ParagraphReader.ke(b))if(a)if(Wb.StyleReader.B9c(a))if(2!==Wb.StyleReader.Bva(a))da.ULS.shipAssertTag(7467991,324,!1);else{var l=Wb.StyleReader.EM(b);if(l){var u=Wb.StyleReader.GR(a);if(!u)da.ULS.shipAssertTag(7467993,324,!1);else if(l.gI(u)){u=null;this.kg.Gg&&!f&&b.k$();c||(u=this.hs.Ysl(u),il.paragraphEditor.C5b(b,!0));this.XBc(b,l);U.a.instance.ga(61)||
(a=l.gI(Wb.StyleReader.GR(a)));b.properties.setValue(ye.a.paragraphStyle,a.id);b.yW=a;for(c=0;c<b.Sa.length;c++)b.Sa.ga(c).formatting&&b.Sa.ga(c).formatting.vte();il.aad.k8b(a)&&(u||(u=new mb.GraphIterator,u.set(b),u.wf(),jb.OutlineElementNavigator.$e(u)),Kc.ListReader.hl(u)||(b.Vo(ib.a.Sm,ib.a.rza,ib.a.Qn,ib.a.ULa,ib.a.msc,ib.a.ysh),this.t0d(u,a)))}}else da.ULS.shipAssertTag(7467992,324,!1)}else da.ULS.shipAssertTag(7467990,324,!1);else da.ULS.shipAssertTag(7467989,324,!1);else da.ULS.shipAssertTag(7467988,
324,!1)}t0d(){}PRc(a,b){b=void 0===b?!1:b;let c;c=we.c(a)?we.d(a)?Wb.StyleReader.EM(a).gI(Wb.StyleReader.OBd):Wb.StyleReader.EM(a).gI(Wb.StyleReader.QBd):Wb.StyleReader.EM(a).gI(U.a.instance.ga(61)?Wb.StyleReader.dPa:Wb.StyleReader.lra);this.mca(c,a,b)}I8e(a,b){const c=Wb.StyleReader.EM(b);c&&c.gI(Wb.StyleReader.GR(a))&&(this.XBc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.H2a(),this.insertionPointFormatting.via(a,b)))}XBc(a,b){return(a=il.Rm.ALb(a))?b.XTl(a):!1}static get paragraphEditor(){return il.hy||
(il.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){il.hy=a}static get aad(){return il.qh||(il.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static get Rm(){return Tm.PageNavigator.instance}}il.hy=null;il.qh=null;Object(m.a)(il,"StyleEditor",null,[1715]);class Um{static gme(){return Um.vFk}static gag(a){return new Ua.a(a,1)}static E_f(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return kh.a.Tf(a)}}Um.vFk=[yb.a.sza,yb.a.cellId,yb.a.rowId,
yb.a.shapeId];Object(m.a)(Um,"TransformHelper",null,[]);class sm{constructor(a,b){this.Xad=new il(a,b);this.lB=a;this.IK=b.value}Zke(a){return this.Xad.Zke(a)}I8e(a,b){this.Xad.I8e(a,b)}mca(a,b){const c=new mb.GraphIterator;c.set(b);c.Zv();c.Dc();Qm.d(a,c.currentNode,[ib.a.listLevel]);Qm.d(a,b,[rb.a.tm,rb.a.xK,ib.a.Qn,ib.a.Sm,yb.a.Ay,yb.a.EY,yb.a.Cna,yb.a.gga,yb.a.Bna,yb.a.fga]);if(this.lB.k8b(a)&&!Kc.ListReader.hl(c)){a=Gf.a.$Ea(a,a);const f=Gf.a.JO(a.listType,a.listStyle);f.EB=a.EB;a.propertySet.Qa(rb.a.Dj)&&
f.propertySet.setValue(rb.a.Dj,a.propertySet.$a(rb.a.Dj));a.propertySet.Qa(rb.a.font)&&f.propertySet.setValue(rb.a.font,a.propertySet.$a(rb.a.font));a.propertySet.Qa(yb.a.autonumberBulletType)&&f.propertySet.setValue(yb.a.autonumberBulletType,a.propertySet.$a(yb.a.autonumberBulletType));this.IK.ISa(c,f,!1,!1,0);a=c.Gb(4);Qm.b(b,a,Um.gme());c.Dc()}}PRc(a,b){this.Xad.PRc(a,void 0===b?!1:b)}XBc(a,b){return this.Xad.XBc(a,b)}}Object(m.a)(sm,"StyleEditor",null,[1715]);class Ul{constructor(a){this.uTg=
a;this.uTg.Nka(Object(R.a)(this,this.d1a,"onBeforeValidatePersistence"))}dispose(){this.uTg.wPb(Object(R.a)(this,this.d1a,"onBeforeValidatePersistence"))}d1a(a,b){10!==b.node.type&&60!==b.node.type||b.node.L2h()}}Object(m.a)(Ul,"LockableGraphNodeEditBehavior",null,[106]);class Hm{constructor(){}Yjj(a){const b=a.parentNode.$a(yb.a.shapeId),c=a.parentNode.$a(yb.a.sza);let f=null,l=null;const u=Object(gb.a)(5,a.currentNode);u&&u.Ft()&&(f=a.parentNode.$a(yb.a.rowId),l=a.parentNode.$a(yb.a.cellId));this.q8e(a.currentNode,
b,c,f,l)}q8e(a,b,c,f,l){a.He(yb.a.shapeId,b);a.He(yb.a.sza,c);l&&(a.He(yb.a.rowId,f),a.He(yb.a.cellId,l))}}Object(m.a)(Hm,"PptCreateParagraphStrategy",null,[1714]);var Zo=d(31);class po{constructor(a){this.Qs=a;this.Qs.Nka(Object(R.a)(this,this.d1a,"onBeforeValidatePersistence"))}dispose(){this.Qs.wPb(Object(R.a)(this,this.d1a,"onBeforeValidatePersistence"))}d1a(a,b){$c.a.Kb&&(a=$c.a.Kb,a.gq&&$c.a.Y2($c.a.Kb),b.revisionId&&(b=$c.a.Kcb(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?da.ULS.sendTraceTag(41714057,
305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),Zo.Debug.ku()):a.jD(Ii.a.d_,b.toString())))}}Object(m.a)(po,"PresentationNodeEditBehavior",null,[106]);class Wp{pxc(a,b,c){let f,l=a.Eg(b);({value:f}=l);l.returnValue||(f=new La.a,a.$(b,f));f.add(c)}oEd(a,b,c,f){if(a.count)for(const l of a)l&&l!==Ua.a.nil&&(a=b.c1c(l,Ua.a.nil),a=f.ga(a))&&(b.$(l,a),this.pxc(c,a,l))}jEd(a,b,c){a.Ib(b)&&Ua.a.fR(a.ga(b),c)&&a.remove(b)}}Object(m.a)(Wp,"GraphHotColdHelper",
null,[1713]);var Xp=d(221),ur;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(ur||(ur={}));Object(m.b)("GraphNodeModificationType",ur);class Zr{constructor(a,b,c,f,l,u){this.I_a=a;this.cpa=b;this.$oa=c;this.QV=f;this.oS=l;this.ipa=u;this.Qmc=Ua.a.nil}pH(a){return!!a&&(7===a.type||68===a.type)}Zqc(a,b){this.I_a.$(a.id,b);this.ipa.gSe(b)?this.Qmc=a.id:this.oS.pxc(this.QV,b,a.id)}Thf(a){if(this.Qmc&&this.Qmc!==
Ua.a.nil){let b;this.oS.oEd((b=new La.a,b.add(this.Qmc),b),this.I_a,this.QV,a);this.Qmc=Ua.a.nil}}vMb(a,b){this.oS.jEd(this.I_a,a,b)}L5(a){return this.I_a.Ib(a.id)}pY(a){return this.L5(a)||0<this.cpa.count||0<this.$oa.count}}Object(m.a)(Zr,"PresentationHotColdHandler",null,[977,964]);class tH extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(m.a)(tH,"RevisionPersistArgs",Sys.EventArgs,[]);var uH=d(929);class vH{constructor(a,b,c,f,l,u,I){this.tya=a;this.$oa=b;this.QV=
c;this.oS=f;this.ipa=l;this.nc=u;this.Ga=I;this.xhd=new La.a;this.hKa=new La.a}pH(a){return!!a&&(10===a.type||60===a.type||39===a.type)}Zqc(a,b){let c=a;const f=this.nc.ug(a);60!==a.type&&39!==a.type&&(c=this.Ga.Gn(a));f&&c&&(this.$oa.$(c.id,b),this.tya.$(f.id,b),this.ipa.gSe(b)?(this.xhd.contains(c.id)||this.xhd.add(c.id),this.hKa.contains(f.id)||this.hKa.add(f.id)):(this.oS.pxc(this.QV,b,c.id),this.oS.pxc(this.QV,b,f.id)))}Thf(a){this.oS.oEd(this.xhd,this.$oa,this.QV,a);this.oS.oEd(this.hKa,this.tya,
this.QV,a);this.xhd.clear();this.hKa.clear()}vMb(a,b){this.oS.jEd(this.$oa,a,b);this.oS.jEd(this.tya,a,b)}L5(a){return this.pH(a)&&this.$oa.Ib(a.id)}pY(a){return this.L5(a)}}Object(m.a)(vH,"ShapeLevelHotColdHandler",null,[977,964]);class wH{constructor(a,b,c,f,l){this.cpa=a;this.tya=b;this.QV=c;this.oS=f;this.ipa=l;this.hKa=new La.a}pH(a){return!!a&&8===a.type}Zqc(a,b){this.cpa.$(a.id,b);this.ipa.gSe(b)&&!this.hKa.contains(a.id)?this.hKa.add(a.id):this.oS.pxc(this.QV,b,a.id)}Thf(a){this.oS.oEd(this.hKa,
this.cpa,this.QV,a);this.hKa.clear()}vMb(a,b){this.oS.jEd(this.cpa,a,b)}L5(a){return this.cpa.Ib(a.id)}pY(a){return this.L5(a)||this.Gfk(a)}Gfk(a){return this.tya.Ib(a.id)}}Object(m.a)(wH,"SlideHotColdHandler",null,[977,964]);class FA{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){ua=void 0===ua?null:ua;Ra=void 0===Ra?null:Ra;eb=void 0===eb?null:eb;this.Sl=this.QV=this.$oa=this.tya=this.cpa=this.I_a=null;this.nc=a;this.Ga=b;this.Nc=c;this.tq=f;this.oS=l;this.Qs=u;this.pMe=!1;this.W1=I;this.sa=T;this.ipa=
ja;this.tq.ASa(Object(R.a)(this,this.Tpd,"onRevisionProcessedOnServerHandler"));this.tq.uMf(Object(R.a)(this,this.Qod,"onGraphNodePersistHandler"));this.Qs.Nka(Object(R.a)(this,this.Qod,"onGraphNodePersistHandler"));this.Nc.aC(Object(R.a)(this,this.KF,"onSessionEnd"));this.Nc.Oxi(Object(R.a)(this,this.Imh,"onFailoverHandler"));this.Nc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.initialize(ua,Ra,eb);this.KZa=new Md.a}reset(){this.initialize();this.tq.Gzh(new uH.a(null));this.p0h()}initialize(a,
b,c){b=void 0===b?null:b;c=void 0===c?null:c;(void 0===a?0:a)||this.hFj();this.QV=b||new Md.a;this.Sl=c||this.vma()}Imh(){this.reset()}Tpd(a,b){b&&(a=b.tE)&&this.BVe(a)}Qod(a,b){this.Zqc(b.node,b.revisionId)}Zqc(a,b){if(!this.pMe&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.Sl)if(c.pH(a)){c.Zqc(a,b);this.tq.spl(new tH(b,a));break}}BVe(a){const b=Ua.a.Tf(a.Id),c=this.QV.ga(b);if(c&&c.count){for(const f of c)for(const l of this.Sl)l.vMb(f,b);this.QV.remove(b);this.tq.Gzh(new uH.a(a));
this.p0h()}}Kej(){const a={},b=FA.Gak(a);b(0,this.I_a);b(1,this.cpa);b(2,this.tya);b(3,this.$oa);Qa.a.isEmpty(a)||ya.a.J(508692549,811,50,Qa.a.toJSON(a))}pY(a){for(const b of this.Sl)if(b.pH(a))return b.pY(a);return!1}L5(a){for(const b of this.Sl)if(b.pH(a))return b.L5(a);return!1}O3h(a){if(0<a.count)for(const b of this.Sl)b.Thf(a)}dispose(){this.Nc.F7(Object(R.a)(this,this.KF,"onSessionEnd"));this.Nc.GAl(Object(R.a)(this,this.Imh,"onFailoverHandler"));this.Qs.wPb(Object(R.a)(this,this.Qod,"onGraphNodePersistHandler"));
this.tq.xPb(Object(R.a)(this,this.Tpd,"onRevisionProcessedOnServerHandler"));this.tq.EEh(Object(R.a)(this,this.Qod,"onGraphNodePersistHandler"));this.Nc.Wba(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.KZa&&0<this.KZa.count&&ya.a.J(508692548,822,15,String.format("Disposed with {0} listening node",this.KZa.count))}KF(){this.pMe=!0;this.Kej();this.reset()}mo(){this.sa.presentation.M4e();this.reset();this.pMe=!1;this.W1.JMa(new Du.a("SessionRehydrated"))}vma(){return[new vH(this.tya,this.$oa,
this.QV,this.oS,this.ipa,this.nc,this.Ga),new wH(this.cpa,this.tya,this.QV,this.oS,this.ipa),new Zr(this.I_a,this.cpa,this.$oa,this.QV,this.oS,this.ipa)]}hFj(){this.I_a=new Md.a;this.cpa=new Md.a;this.tya=new Md.a;this.$oa=new Md.a}b8b(a,b){const c=Object(gb.a)(738,a);c.Mva+=1;let f;(()=>{let l=this.KZa.Eg(b.id);({value:f}=l);return l})().returnValue||(f=new La.a,this.KZa.add(b.id,f));f.add(a)}p0h(){if(this.KZa.count&&this.sa.presentation&&this.sa.presentation.Zh){var a=this.sa.presentation.Zh;this.KZa.forEach((b,
c)=>{if(!this.L5(Object(gb.a)(9,a.Ie(b)))){for(const f of c)if(c=Object(gb.a)(738,f))--c.Mva,this.oEb(c)&&(this.W1.JMa(new Du.a("SessionRehydrated")),this.Mvd(f));this.KZa.remove(b)}return!0})}}oEb(a){return a?!a.Mva&&!a.ima:!1}Mvd(a){var b=Object(gb.a)(738,a);a&&b&&(b=+new Date-+b.ula,12E4<b&&ya.a.J(508692547,822,15,String.format("{0} been blocked {1}",a.type,b)))}static Gak(a){return(b,c)=>{c=Xp.a(c.values.toArray(),f=>f.toString());c.length&&(a[ur[b]]=c)}}}Object(m.a)(FA,"GraphHotColdManager",
null,[963,964,106,965]);class QC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}fc(a){this.K=a;this.K.register(Ul,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().na(()=>new Ul(this.K.resolve("Box4.Graph.IGraphInstance").wVa));this.K.register(po,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().na(()=>new po(this.K.resolve("Box4.Graph.IGraphInstance").Cd(7)));this.K.register(fl,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").na(()=>
new fl(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(sm,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().na(()=>
new sm(this.K.resolve("Box4.List.IListReader"),this.K.ze("Box4.List.IListEditor")));this.K.register(Wp,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").na(()=>new Wp);this.K.register(FA,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().na(()=>new FA(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").wVa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));this.K.register(Hm,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().na(()=>new Hm(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){C.a.instance.Ac(new QC)}}
Object(m.a)(QC,"PPTWebEditorGraphEditorPackage",null,[2,3]);var yR=d(797),GA=d(799),zR=d(798),Oo=d(458);const xH=a=>{a.element.style.top=""};var Ew=d(808);class yH{constructor(a,b,c){this.p9=!1;this.UPa=0;this.sja=this.GBf=null;this.s2k=f=>{f.element.style.top="";A.AFrameworkApplication.za.qv()};this.o2k=f=>{f.element.parentNode.removeChild(f.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);A.AFrameworkApplication.za.qv()};this.tu=()=>{const f=this.so.entries.length,l=Sys.UI.DomElement.getBounds(this.htmlElement).height;
let u;for(let I=0;I<f;++I)u=this.so.entries[I],u.htmlElement&&u.FGh();this.UPa=Sys.UI.DomElement.getBounds(this.htmlElement).height;l!==this.UPa&&this.qFd()};this.AD=()=>!0;this.$T=a;this.Cpi=b;this.so=c;this.OQ=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.j4=!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.XHa)&&!this.so.GVc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";E.a.jg&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"FireFox")}get htmlElement(){return this.OQ}get visible(){return this.p9}set_visible(a){if(this.p9!==a)return(this.p9=a)?this.r1d():this.L7b(),a}dispose(){this.visible&&this.L7b();za.a.EEa(this.htmlElement);this.$T=this.OQ=null}sRh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.FGh();this.UPa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.sNf,u=
this.s2k;Oo.WacAirSpace.g3a(c,"Shared_BasicClass");var I=new zR.a(c);I.o3b(0,1);const T=new GA.a(c);T.p3b(c.clientTop-30,c.clientTop);l?(Oo.WacAirSpace.S0a(I,null,null),Oo.WacAirSpace.S0a(T,null,u)):(Oo.WacAirSpace.animate(I,null,null),Oo.WacAirSpace.animate(T,null,u));for(b+=1;b<f.length;b++)u=f[b],Oo.WacAirSpace.g3a(u,"Shared_BasicClass"),I=new GA.a(u),I.p3b(u.clientTop-c.clientHeight,u.clientTop),l?Oo.WacAirSpace.S0a(I,null,null):Oo.WacAirSpace.animate(I,null,null);a.U_l();this.set_visible(!0)}dvg(a){const b=
a.htmlElement;if(za.a.LXa(b)){this.UPa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.sNf;var f=this.o2k;Oo.WacAirSpace.g3a(b,"Shared_BasicClass");var l=new yR.a(b);l.o3b(1,0);a?Oo.WacAirSpace.S0a(l,null,f):Oo.WacAirSpace.animate(l,null,f);f=!1;for(l=0;l<c.length;l++){if(f){const u=c[l];Oo.WacAirSpace.g3a(u,"Shared_BasicClass");const I=new GA.a(u);I.p3b(u.clientTop,-b.clientHeight);a?Oo.WacAirSpace.S0a(I,null,xH):Oo.WacAirSpace.animate(I,null,xH)}f||c[l]!==b||(f=!0)}}}r1d(){""===this.$T.style.top.trim()&&
(this.$T.style.top=this.$T.offsetTop+"px");this.htmlElement.style.left=this.$T.style.left;this.htmlElement.style.top=this.$T.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.GBf=this.$T.style.top;this.UPa=a.height;this.qFd();A.AFrameworkApplication.za.v9(this.tu);Ae.a.addHandler(this.htmlElement,la.a.Hxd,Ae.a.fxb);this.sja=this.AD;A.AFrameworkApplication.za.Bca.xb(this.htmlElement,this.sja,null);if(F.FocusManager.eO()){var b=
F.FocusManager.instance();a=b.Kc(Ew.a.j$a);a.parent=K.AFrame.Nj;const c=new tx.DOMFocusListing(()=>this.htmlElement);c.xp(1);c.xp(2);c.xp(8);b.hla(()=>this.htmlElement,a,c);b=b.DR(Ew.a.j$a);b.xmb();b.IY=!0;b.HTa=!0;const f=A.AFrameworkApplication.za.Yx;a.v9a(()=>{f.zp(Ew.a.j$a)});f.Hka(Ew.a.j$a);(c.gma||A.AFrameworkApplication.fa.getBooleanAppSetting("ReactBusinessBarIsEnabled"))&&f.bM(Ew.a.j$a)}}L7b(){this.UQh()&&(this.$T.style.top=this.GBf);this.htmlElement.style.visibility="hidden";A.AFrameworkApplication.za&&
(F.FocusManager.eO()&&F.FocusManager.instance().rPb(Ew.a.j$a),this.sja&&(A.AFrameworkApplication.za.Bca.Hb(this.htmlElement,this.sja),this.sja=null));Ae.a.removeHandler(this.htmlElement,la.a.Hxd,Ae.a.fxb)}qFd(){if(this.UQh()&&this.visible){var a=this.$T,b=this.UPa+this.Cpi;const c=za.a.LN(a.style.top);Oo.WacAirSpace.g3a(a,"Shared_BasicClass");a=new GA.a(a);a.p3b(c,b);Oo.WacAirSpace.animate(a,null,null)}}UQh(){return!this.j4&&!this.so.GVc}}Object(m.a)(yH,"BusinessBarDom",null,[557,106]);var Mu;(function(a){a[a.none=
0]="none";a[a.Ttm=1]="corruptPage";a[a.$tm=2]="currentPageStatus";a[a.qum=3]="documentMarkedAsFinal";a[a.sum=4]="documentSigned";a[a.Jum=5]="fileAccess";a[a.Mvm=6]="kickoutWithDataLoss";a[a.oLg=7]="lostSession";a[a.Vvm=8]="malformedHyperlinkUris";a[a.BBm=9]="odt";a[a.sCm=10]="readonlyRecommended";a[a.hDm=11]="saveReplaySuccess";a[a.gDm=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.YEm=14]="word11Compat";a[a.FEm=15]="unsupportedBrowser";a[a.dtm=16]="applicationNotification";
a[a.VDm=17]="skypeDocChatFailed";a[a.RDm=18]="showDialogInNewWindowInfo";a[a.j7e=19]="sessionExpired";a[a.uzg=20]="irmPolicyDescription";a[a.gCm=21]="policyWarningMessage";a[a.yEm=22]="thirdPartyAddinDisabled";a[a.Tum=23]="gdprPrivacyNotice";a[a.bum=24]="datacenterDecommissionWarning";a[a.fvm=25]="graphMergePrompt";a[a.qCm=26]="readOnlyDocument";a[a.ium=27]="dictationSilence";a[a.ftm=28]="autoSensitivityLabel";a[a.yCm=29]="recommendedSensitivityLabel";a[a.hum=30]="dictationDebugInfo";a[a.QBm=31]=
"oneNoteCovid19Message";a[a.ztm=32]="citationStylePrompt";a[a.TBm=33]="oneNoteViewModeMessage";a[a.SBm=34]="oneNotePrintImagesDownloading";a[a.RBm=35]="oneNotePagePrintReady";a[a.Gvm=36]="irmPolicyCausedFeatureDisabled";a[a.Wvm=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.$vm=39]="minorVersionLimit";a[a.pEm=40]="testEntry1";a[a.qEm=41]="testEntry2";a[a.rEm=42]="testEntry3";a[a.sEm=43]="testEntry4";a[a.tEm=44]="testEntry5";a[a.uEm=45]="testEntry6";a[a.vEm=46]="testEntry7"})(Mu||(Mu={}));
Object(m.b)("BusinessBarId",Mu);class er{constructor(a,b,c,f){c=void 0===c?null:c;this.Pwf=this.jrf=!1;this.ytb=null;this.LQ=[];this.XBa=(void 0===f?null:f)||new yH(a,void 0===b?0:b,this);this.Y$j(c)}Y$j(a){if(a){this.ytb={};a=a.ranking;for(let b=0;b<a.length;b++)this.ytb[Mu[a[b]]]=b}}dispose(){this.XBa.dispose();sw.a.Zwd(this.LQ);this.LQ=null}get htmlElement(){return this.XBa.htmlElement}get visible(){return this.XBa.visible}get GVc(){return this.jrf}set GVc(a){this.jrf=a}get exe(){return this.Pwf}set exe(a){this.Pwf=
a}get entries(){return this.LQ}set entries(a){this.LQ=a}Tfa(a){for(let b=0;b<this.LQ.length;b++)if(this.LQ[b].id===a)return!0;return!1}Ei(a,b,c){c=void 0===c?null:c;var f=void 0===f?null:f;var l=void 0===l?null:l;a.businessBar=this;let u=this.eDj(a.id);(void 0===b?0:b)&&!this.ytb&&(u=0);u<er.Wjb&&(this.XBa.sRh(a,u),this.LQ.length>=er.Wjb&&this.XBa.dvg(this.LQ[er.Wjb-1]),this.XBa.qFd());Array.insert(this.LQ,u,a);da.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",
Mu[a.id],void 0===a.QEa||null===a.QEa?"":a.QEa);a.errorCode&&A.AFrameworkApplication.Lp(a.errorCode,c,f,l)}removeEntry(a){const b=Array.indexOf(this.LQ,a);-1!==b&&b<er.Wjb&&(this.LQ.length>er.Wjb&&this.XBa.sRh(this.LQ[er.Wjb],er.Wjb),this.XBa.dvg(a),this.XBa.qFd());Array.remove(this.LQ,a);a.businessBar=null;a.dispose()}eDj(a){if(!this.ytb||0===a)return this.LQ.length;a=this.ytb[Mu[a]];if(void 0===a||null===a)return this.LQ.length;for(let b=0;b<this.LQ.length;b++)if(a<this.ytb[Mu[this.LQ[b].id]])return b;
return this.LQ.length}}er.Wjb=2;Object(m.a)(er,"BusinessBar",null,[518,106,519]);class RC{constructor(a){this.wUc=null;this.pkh=a.Ea("OfficeOnlineChromeExtensionId");this.zkh=a.Ea("ChromeClipboardAccessExtensionId");this.lfk=a.getBooleanAppSetting("OfficeOnlineChromeExtensionIsEnabled");this.CFf=!this.umk();this.wUc=this.BAa?this.zkh:this.pkh}R_c(){return this.wUc}E4e(){this.wUc===this.pkh&&this.jDg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));
this.wUc=this.zkh;this.CFf=!0}get BAa(){return this.CFf}umk(){if(this.lfk&&this.jDg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&"true"===a}return!1}get jDg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){da.ULS.sendTraceTag(19452045,
307,50,b.toString())}return a}}Object(m.a)(RC,"ChromeExtensionHelper",null,[237]);class zH{constructor(a,b,c){this.Fca=(void 0===a?null:a)||{};this.TZh=(void 0===b?null:b)||[];this.Ocm=(void 0===c?null:c)||{}}}Object(m.a)(zH,"RibbonTrimmingProperties",null,[]);var AR=d(462);class AH{create(a,b,c){return new AR.a(a,b,c)}}Object(m.a)(AH,"Factory",null,[555]);class BH{constructor(){this.lsl=(a,b,c,f,l)=>{if(1===c)return 32;A.AFrameworkApplication.KYa("54hi9858;4f638686");if(!l)return 32;a=l.SourceControlId;
17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],fh.d("setFileMenuSelectedPage")&&("New"===a&&A.AFrameworkApplication.za?2===A.AFrameworkApplication.za.mb.Ej?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&A.AFrameworkApplication.za&&(2===A.AFrameworkApplication.za.mb.Ej?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),
l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32};A.AFrameworkApplication.Pa.xa(N.a.BFb,Le.a.frame,this.lsl)}Avk(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(m.a)(BH,"ReactFileMenu",null,[682]);class CH{createFileMenu(){const a=new BH,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(m.a)(CH,"ReactFileMenuFactory",
null,[1730]);var Xh=d(543);class DH{constructor(a,b,c,f,l){this.uJa=!1;this.eB=null;this.noa=this.xkd=this.i_a=!1;this.Akc="Edit";this.rc=f;this.ia=a;this.Mw=b;this.Db=l;this.Db.QH(Object(R.a)(this,this.Jmd,"modeSwitched"));this.Ba=c;this.qb()}qb(){this.ia.xa(M.a.Ihh,Le.a.frame,Object(R.a)(this,this.vYk,"modeSwitcherHandler"));this.ia.xa(M.a.Mzc,Le.a.frame,Object(R.a)(this,this.Mzc,"switchToDocumentEditMode"));this.ia.xa(M.a.Ozc,Le.a.frame,Object(R.a)(this,this.Ozc,"switchToEmergencyViewMode"));this.ia.xa(M.a.Nzc,
Le.a.frame,Object(R.a)(this,this.Nzc,"switchToDocumentViewMode"));this.ia.pa(M.a.s0e,Le.a.frame,Object(R.a)(this,this.kyh,"queryDocumentModeSwitchMenuItem"),96);this.ia.pa(M.a.t0e,Le.a.frame,Object(R.a)(this,this.kyh,"queryDocumentModeSwitchMenuItem"),96);this.ia.xa(M.a.uFa,wc.a.application,Object(R.a)(this,this.uFa,"displayCallout"));this.ia.xa(N.a.VVh,Le.a.frame,Object(R.a)(this,this.C7l,"switchFromViewModeToEditMode"))}dispose(){this.Db.a_(Object(R.a)(this,this.Jmd,"modeSwitched"))}Sd(){}vYk(){return 32}Nzc(a,
b,c){if(1===c||"View"===this.hcb())return 32;this.Mw.aWh();this.ayd("View");this.xkd=!0;return 32}Mzc(a,b,c){if(A.AFrameworkApplication.TR)return 8;a=this.hcb();if(1===c){if("Edit"===a||this.uJa||this.xkd||this.i_a&&this.rc.getState(1))return 32;da.ULS.sendTraceTag(512500510,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.Mw.NUl();c=this.i_a?this.ia.Ia(M.a.x8b,2,20):this.ia.nb(M.a.Rbc,2);this.uJa=this.i_a=
this.xkd=!1;this.ayd("Edit");return c}C7l(a,b,c){if(A.AFrameworkApplication.TR)return 8;a=this.hcb();if(1===c){if("Edit"===a||this.uJa||this.xkd||this.i_a&&this.rc.getState(1))return 32;da.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;if(2!==c)return da.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.Ia(M.a.refresh,
2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}Ozc(a,b,c){if(1===c)return 32;this.uJa=!0;return this.initialize()}kyh(a,b,c,f,l){b=this.hcb();l[Xh.a.On]=a===M.a.s0e&&"Edit"===b||a===M.a.t0e&&"View"===b?!0:!1;return 32}uFa(a,b,c,f,l){if(!l||!Object(gc.a)(Jn,l))return 8;this.eB=l;this.initialize();return this.initialize()}initialize(){if(!fh.c())return da.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),
8;this.Akc=this.wkg();!this.noa&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.hcb()!==this.Akc&&da.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",this.Akc,this.hcb());var a=this.eB?this.eB.Cec||this.eB.Hec:!1,b=this.eB?this.eB.RXa:this.rc.getState(16);this.i_a=this.eB?this.eB.pwe:this.rc.getState(524288);var c=this.eB?this.eB.tdb:this.rc.getState(1);const f=this.uJa||
a||this.i_a||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.Akc;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.i_a;l.isReviewer=!1;l.isServiceDefaultedToView=this.uJa||a;l.forceShowNotificationByExternalTrigger=this.eB&&this.eB.d7c?!this.eB.d7c:f;a&&(a={},c={},c.title=ResourceStrings.L_BizBarTitle_Readonly,this.eB.Cec?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.eB.Hec&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,
c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return da.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),8;da.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",
!!this.eB,l.hasEditPermission,this.Akc,b,this.i_a,!!this.eB&&this.eB.Cec,!!this.eB&&this.eB.Hec,this.uJa,this.Nzg());b=this.O$d(a);this.noa=!0;return b}O$d(a){if(appChrome.api)return appChrome.api.dispatch(a),32;da.ULS.sendTraceTag(512500503,306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}Nzg(){return!!A.AFrameworkApplication.za&&1===A.AFrameworkApplication.za.mode}wkg(){return this.eB?this.uJa||this.eB.RXa||this.eB.pwe||
this.eB.Cec||this.eB.Hec||this.eB.d7c?"View":this.eB.tdb?"Edit":"View":this.uJa||this.Nzg()?"View":"Edit"}hcb(){if(fh.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:da.ULS.sendTraceTag(512500502,306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}ayd(a){if(fh.c()&&this.hcb()!==a){var b={};b.activeMode=a;da.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",
a);a=appChrome.actions.updateModeSwitcher(b);this.O$d(a)}}Jmd(a){this.noa&&(1===a.mode?this.ayd("View"):2===a.mode&&this.ayd("Edit"))}hDl(){const a={hidden:!1};a.activeMode=this.wkg();this.O$d(appChrome.actions.updateModeSwitcher(a))}}Object(m.a)(DH,"ModeSwitcherControlActor",null,[892]);var EH=d(256);class SC{constructor(a,b,c,f){this.ADa=this.Hsf=this.S7a=this.brf=this.XPa=this.fqf=null;this.CHf=!1;this.so=a;this.O_=b;this.Ca=c;this.La=f}zfl(){this.p5b();this.q5b();this.NSi()}p5b(){const a=ad.App.Ob.ie.qj;
a&&(this.fqf=this.rFd(this.fqf,1,2===ad.App.Ob.mode&&a.C6c,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get Jsk(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)?E.a.Ksk:!1}NSi(){this.Jsk&&!this.S7a&&(this.S7a=this.O_.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.S7a.id=15,this.S7a.closeable=!0,this.S7a.jfc=!1,this.S7a.addButton(Box4Intl.Box4Strings.L_DownloadNow,P.AppFrame.wgm,""),hp.a("NewBrowserSuggestionShown"),
this.so.Ei(this.S7a,!1))}q5b(){let a=null;const b=ad.App.Ob.ie.x4;if(b){const c=b.Zrc;EH.a.kec(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===c||20===c?a=E.a.Aj?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=E.a.Aj?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):
2!==ad.App.Ob.mode||EH.a.L3c(b.u2b)||ad.App.Mfc||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.Hsf=this.rFd(this.Hsf,5,!!a,a)}OUl(a){!!this.ADa===a||this.CHf||(a?(this.ADa=this.O_.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.ADa.id=13,this.ADa.closeable=!0,this.ADa.xU=()=>{this.CHf=!0;this.ADa=null},this.so.Ei(this.ADa)):(this.so.removeEntry(this.ADa),this.ADa=null))}yRh(a,b,c,f){a=this.O_.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.hZd(b,()=>
{Sd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.xU=f);this.so.Ei(a,!0)}p0l(a,b,c){this.yRh(a,b,c,null)}K_l(a){a=this.O_.create(null,a,null);a.closeable=!0;a.id=24;a.image=1;this.so.Ei(a,!0)}B0l(a){a=this.O_.create(null,a,null);a.closeable=!0;a.id=20;this.so.Ei(a)}Q_l(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.XPa||(this.XPa=this.O_.create(a,b,null),this.XPa.closeable=!0,this.XPa.id=27,this.so.Ei(this.XPa))}A2j(){this.XPa&&
(this.XPa=this.rFd(this.XPa,27,!1,""))}J$e(a){this.brf=this.rFd(this.brf,30,!0,a)}rFd(a,b,c,f){var l=void 0===l?!1:l;var u=void 0===u?"":u;var I=void 0===I?null:I;var T=void 0===T?null:T;var ja=void 0===ja?null:ja;c?a?a.message=f:(a=this.O_.create(u,f,null),a.id=b,a.closeable=l,I&&a.addButton(I.text,I.jeb,I.mDm),T&&a.hZd(T.text,T.jeb),ja&&(a.xU=ja),this.so.Ei(a,!1)):a&&(this.so.removeEntry(a),a=null);return a}}Object(m.a)(SC,"BusinessBarController",null,[1728]);var BR=d(265);class TC extends SC{constructor(a,
b,c,f,l,u,I,T,ja,ua){const Ra=[];a||Ra.push("businessBar");b||Ra.push("businessBarEntryFactory");c||Ra.push("appFrame");f||Ra.push("actionManager");l||Ra.push("errorMapping");u||Ra.push("appSettingsManager");I||Ra.push("focusManager");T||Ra.push("applicationSettings");ja||Ra.push("presentationIdGetter");ua||Ra.push("filterPrivacyRoamingCacheProxy");if(Ra.length)throw Error.argumentNull(Ra.join());super(a,b,f,u);this.qnc=[];this.kBe=this.PTg=!1;this.yIa=0;this.yNe=null;this.xU=eb=>{ya.a.J(508884448,
801,50,"BusinessBarController::CloseHandler");this.Ape(eb)};this.hzl=eb=>{ya.a.J(509195598,801,50,"BusinessBarController::RemoveFilterPrivacyHandler");BR.a.eQl(this.dQk.presentationId.string,this.P8k,this.O8k);this.so.removeEntry(eb)};this.P8k=()=>{ya.a.J(509195597,801,50,"BusinessBarController::OnRemoveFilterPrivacySucceeded")};this.O8k=eb=>{ya.a.J(509195596,801,10,"BusinessBarController::OnRemoveFilterPrivacyFailed - Error: {0}",jg.a.MJ(eb.error.Bn))};this.uuk=eb=>{this.La.getBooleanAppSetting("KeepFilterPrivacyClickCountRoamingEnabled")&&
this.lHe.W7j();ya.a.J(509182920,801,50,"BusinessBarController::KeepFilterPrivacyHandler");this.so.removeEntry(eb)};this.Db=c;this.ia=f;this.vaa=l;this.Fa=I;this.jB=T.DHa;this.$mc=T.powerPointDragInsertMultipleImageQuantityLimit;this.dQk=ja;this.lHe=ua}initialize(){this.Db.QH(Object(R.a)(this,this.St,"onAppFrameModeSwitched"))}dispose(){this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"))}uw(a,...b){this.Y7b.apply(this,[a,this.vaa.D1c(a),this.vaa.Gle(a),this.vaa.Xie(a)].concat(b))}Y7b(a,
b,c,f){0===a||this.yNe||(c=this.O_.create(c,f||"",null),c.closeable=!0,c.errorCode=jg.a.hi(a),c.xU=Object(R.a)(this,this.Gij,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(R.a)(this,this.Hud,"refreshActionHandler"),""),b&&(a?c.sZd(ResourceStrings.L_OpenInPowerPoint,Object(R.a)(this,this.yqd,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,Object(R.a)(this,this.yqd,"openInClientActionHandler"),"")),this.yNe=c,this.D2b(c))}oM(a){var b=
"";let c="",f=null,l="",u=null;var I=!1;let T=!1,ja=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;I=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;I=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;I=!0;break;case 2:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;
I=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;I=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;I=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;I=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;I=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;I=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;I=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;I=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;c=ResourceStrings.L_BizBarButton_Convert;f=Object(R.a)(this,this.S_i,"convertActionHandler");
I=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;I=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;I=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;I=!0;break;case 14:b=A.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?A.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=A.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?
A.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";I=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;I=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;I=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,this.$mc);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,
this.$mc);I=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.UKj();I=!1;a&&(this.yIa=a,a=this.ia.Ia(M.a.iQb,1,this.yIa),8!==a&&16!==a&&(I=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(R.a)(this,this.PDl,"repairSaveCopyHandler")));32===this.ia.nb(M.a.Zvc,1)&&(I?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,u=Object(R.a)(this,this.mFh,"replaceOriginalFileHandler")):(I=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(R.a)(this,this.mFh,"replaceOriginalFileHandler")));
a=I?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;I=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(R.a)(this,this.$Sj,"goToEditModeHandler");I=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(R.a)(this,
this.qbl,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;I=!1;break;case 27:ja=T=!0;a=ResourceStrings.L_BizBarInlineFilterPrivacy;c=ResourceStrings.L_RemoveSetting;f=this.hzl;l=ResourceStrings.L_KeepSetting;u=this.uuk;break;default:return}b=this.O_.create(b,a,null);b.image=3;b.closeable=!0;b.xU=I?Object(R.a)(this,this.xAh,
"readOnlyInfoEntryClosedHandler"):ja?this.xU:Object(R.a)(this,this.Ape,"infoEntryClosedHandler");T&&(b.jfc=!1);f&&b.addButton(c,f,"");u&&b.sZd(l,u);this.D2b(b);I&&Array.add(this.qnc,b)}vFa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.O_.create(c,b,null);
c.id=a;c.image=1;c.closeable=!0;this.D2b(c)}EVc(a,b){let c,f=!1,l=!1,u=!1,I=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;u=!0;b=3;break;
case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;I=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;
f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;f=!0;b=1;break;default:return}a=this.O_.create(a,c||"",null);a.closeable=!0;a.xU=Object(R.a)(this,this.xAh,"readOnlyInfoEntryClosedHandler");a.image=b;f?(ya.a.J(512263711,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(R.a)(this,this.Hud,"refreshActionHandler"),"")):l?(ya.a.J(512263710,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,
Object(R.a)(this,this.LJl,"saveAsActionHandler"),"")):I?(ya.a.J(512263709,801,15,"DownloadACopy button is show"),a.addButton(ResourceStrings.L_DownloadCopy,Object(R.a)(this,this.aej,"downloadACopyActionHandler"),"")):u&&(ya.a.J(512263708,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(R.a)(this,this.Uej,"editAnywayActionHandler"),""));this.D2b(a);Array.add(this.qnc,a)}Tfa(a){return this.so.Tfa(a)}UKj(){let a=0;if(this.La.getBooleanAppSetting("IsUIEmbedMode")||
this.La.getBooleanAppSetting("DisablePrint")||!this.La.Ea("DownloadACopyUrl")||"true"===this.La.Ea("ProtectInClient")||E.a.Aj)return a;let b=!0;this.La.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")&&this.La.getBooleanAppSetting("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.La.getBooleanAppSetting("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.La.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")&&this.La.getBooleanAppSetting("UserCanWriteRelative")&&this.La.getBooleanAppSetting("SupportsEditing")||
(f=!1);a=b?N.a.inb:c?N.a.Q2a:a;ya.a.J(512263707,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,f,a);return a}D2b(a){const b=this.so.visible;this.so.Ei(a);b||this.Fa.qk(yj.a.W2d,!0)}Hud(a){ya.a.J(512263706,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.nb(M.a.refresh,2)}Ape(){this.so.entries.length||this.Fa.qk(yj.a.W2d,!1)}Gij(){this.yNe=null;this.so.entries.length||this.Fa.qk(yj.a.W2d,
!1)}xAh(a){Array.remove(this.qnc,a);this.Ape(a);ya.a.J(512263705,801,50,"Read-only info entry is closed")}yqd(){this.ia.Ia(M.a.openInClient,2,!0)}S_i(){this.ia.Ia(M.a.o_f,2,!1)}PDl(){A.AFrameworkApplication.Tw?this.naf(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ia(M.a.iQb,2,this.yIa)}mFh(){this.ia.nb(M.a.Zvc,2)}$Sj(){this.ia.nb(M.a.Rbc,2)}LJl(){ya.a.J(512263704,801,15,"SaveACopy button is clicked");A.AFrameworkApplication.Tw?this.naf(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ia(N.a.inb,
2,!0)}aej(){ya.a.J(512263703,801,15,"DownloadACopy button is clicked");A.AFrameworkApplication.Tw?this.naf(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.Ia(N.a.downloadACopy,2,!0)}naf(a){ya.a.J(512263702,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new Ij.StandardDialog;b.Fd=0;b.Kz(jg.a.Ldj,qa.a.j5(ResourceStrings.l_GenericDialogTitle),qa.a.j5(a),null)}Uej(){ya.a.J(512263701,801,50,"EditAnyway button is clicked");this.ia.Ia(M.a.x8b,2,20)}qbl(){ya.a.J(512263700,
801,50,"Learn More button is clicked");gA.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}r4d(){if(this.Db.rdb&&!this.kBe&&!this.PTg){this.kBe=!0;var a=this.O_.create("",CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.xU=()=>{this.PTg=!0;this.kBe=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(R.a)(this,this.R3k,"onCompatWarningButtonClick"),"");this.D2b(a)}}R3k(){gA.Redirect.showHelp("PPTODF")}c6f(){for(const a of this.qnc)this.so.removeEntry(a);
Array.clear(this.qnc)}St(a){this.jB&&2===a.mode&&this.c6f()}}Object(m.a)(TC,"BusinessBarController",SC,[1727,1728,106]);class FH{constructor(a,b){this.egb=null;this.AQk=b;this.wb=document.createElement("div");this.wb.className="BusinessBarPanel";this.wb.id="BusinessBarPanel";this.ppc=document.createElement("div");this.ppc.id="BusinessBarPanelWorking";this.wb.insertBefore(this.ppc,this.wb.firstChild);a.execute(c=>{this.egb=c;this.AQk&&this.egb&&(this.egb.GVc=!0);this.ppc.insertBefore(this.egb.htmlElement,
this.ppc.firstChild)});this.wb.style.position=Hf.a.Dzc}dispose(){}layout(a,b){if(!this.egb||!this.egb.visible)return this.ur(),a;this.Lcj(b);this.wb.style.height=Df.a.Rc(this.egb.htmlElement.offsetHeight);return a}ur(){"none"!==this.wb.style.display&&(this.wb.style.display="none")}Lcj(a){this.wb.style.display.length&&(this.wb.style.display="");a&&(this.wb.style.direction=Hf.a.i4a)}get va(){return this.wb}get Gpm(){return this.ppc}get order(){return 2}}Object(m.a)(FH,"BusinessBarPane",null,[895,180,
106]);var Hy=d(582),GH=d(334);class Lp{}Lp.Value="value";Lp.MinValue="MinValue";Lp.MaxValue="MaxValue";Lp.Text="Text";Object(m.a)(Lp,"SliderCommandProperties",null,[]);var Mp=d(1168);class op{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(m.a)(op,"CommonOptionalButtonProperties",null,[]);class Fw extends op{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=
this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(Fw,"OptionalButtonProperties",op,[]);class HH extends Fw{constructor(){super();this.animateTransition=!1}}Object(m.a)(HH,"AdditionalInkButtonProperties",Fw,[]);class HA extends op{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(HA,"OptionalFlyoutAnchorProperties",
op,[]);class IH extends HA{constructor(){super();this.animateTransition=!1}}Object(m.a)(IH,"AdditionalInkFlyoutAnchorProperties",HA,[]);class JH{constructor(){this.selected=!1;this.iconColor=null}}Object(m.a)(JH,"InkControlState",null,[]);class KH{constructor(){this.keytip=this.iconName=this.label=null}}Object(m.a)(KH,"InkFlyoutAnchorResources",null,[]);class us{constructor(){this.dGb=[]}xa(a){this.dGb.push(a)}commit(){appChrome.api.dispatch(this.dGb);Array.clear(this.dGb)}}Object(m.a)(us,"AppChromeTransaction",
null,[]);class ie{}ie.jz="InkPen1";ie.UA="InkPen2";ie.TA="InkHighlighter";ie.Zma="InkRuler";ie.Wdb="InkColorPicker1";ie.Mfa="InkColorPicker2";ie.Uva="InkColorPicker3";ie.Wma="InkColorPickerMRU1";ie.Xma="InkColorPickerMRU2";ie.hHa="InkColorPickerMRU3";ie.jHa="InkThicknessSlider1";ie.kHa="InkThicknessSlider2";ie.lHa="InkThicknessSlider3";ie.Vva="InkDrawWithTouch";ie.iY="InkEraser";ie.Ydb="InkStrokeEraser";ie.Xdb="InkPointEraser";ie.C$="InkLasso";ie.iHa="InkSelect";ie.Fdg="label";ie.Ddg="iconName";ie.Edg=
"keytip";ie.iqe=4;Object(m.a)(ie,"InkRibbonManagerConstants",null,[]);class Np{constructor(a,b,c,f,l){this.y_a=this.A_a=this.z_a=Np.zQc;this.FWj=(u,I,T)=>{if(1===T)return 32;if(this.aZ.ga(ie.Vva).selected)return this.vVc(),32;!Np.T4c.some(ja=>this.aZ.ga(ja).selected&&ie.Zma!==ja)&&this.Caa.count&&(this.Dxb(!1),u=new us,this.GB(this.mB,!0,!0,u,!0),this.ia.nb(M.a.dqe,2),u.commit());return 32};this.c1=(u,I,T,ja,ua)=>{if(1===T)return this.iEe?8:32;I=this.aZ.ga(ie.Zma).selected;u!==M.a.Cxd&&this.Dxb(u===
M.a.mNa);T=new us;if(this.L9e(this.Pwe(ua)))switch(u){case M.a.zxd:case M.a.Axd:case M.a.xxd:case M.a.wxd:case M.a.Dxd:case M.a.Bxd:case M.a.yxd:case M.a.qxd:case M.a.rxd:case M.a.sxd:case M.a.txd:case M.a.uxd:case M.a.vxd:this.GB(ie.Vva,!0,!1,T,!1)}switch(u){case M.a.zxd:this.GB(ie.jz,!0,!0,T,!0);this.ia.Ia(M.a.jz,2,ua);this.mB=ie.jz;break;case M.a.txd:this.GB(ie.jz,!0,!0,T,!0);this.qQb(ie.jz,this.OZa,ie.Mfa,[ie.Wma,ie.Xma],"#000000",ua,T);this.ia.Ia(M.a.Wma,2,ua);this.mB=ie.jz;break;case M.a.qxd:this.GB(ie.jz,
!0,!0,T,!0);this.qQb(ie.jz,this.OZa,ie.Mfa,[ie.Wma,ie.Xma],"#000000",ua,T);this.ia.Ia(M.a.Wdb,2,ua);this.mB=ie.jz;break;case M.a.Axd:this.GB(ie.UA,!0,!0,T,!0);this.ia.Ia(M.a.UA,2,ua);this.mB=ie.UA;break;case M.a.uxd:this.GB(ie.UA,!0,!0,T,!0);this.qQb(ie.UA,this.OZa,ie.Mfa,[ie.Wma,ie.Xma],"#e71224",ua,T);this.ia.Ia(M.a.Xma,2,ua);this.mB=ie.UA;break;case M.a.rxd:this.qQb(ie.UA,this.OZa,ie.Mfa,[ie.Wma,ie.Xma],"#e71224",ua,T);this.GB(ie.UA,!0,!0,T,!0);this.ia.Ia(M.a.Mfa,2,ua);this.mB=ie.UA;break;case M.a.xxd:this.GB(ie.TA,
!0,!0,T,!0);this.ia.Ia(M.a.TA,2,ua);this.mB=ie.TA;break;case M.a.vxd:this.GB(ie.TA,!0,!0,T,!0);this.qQb(ie.TA,this.KHb,ie.Uva,[ie.hHa],"#fffc00",ua,T);this.ia.Ia(M.a.hHa,2,ua);this.mB=ie.TA;break;case M.a.sxd:this.GB(ie.TA,!0,!0,T,!0);this.qQb(ie.TA,this.KHb,ie.Uva,[ie.hHa],"#fffc00",ua,T);this.ia.Ia(M.a.Uva,2,ua);this.mB=ie.TA;break;case M.a.wxd:this.ka.getBooleanAppSetting("IsInkPartialEraserEnabled")?this.GB(ie.iY,!0,!0,T,!0):this.GB(ie.iY,!0,!1,T,!1);this.ia.Ia(M.a.iY,2,ua);break;case M.a.Dxd:this.ka.getBooleanAppSetting("IsInkPartialEraserEnabled")&&
(this.GB(ie.Ydb,!0,!1,T,!1),this.GB(ie.iY,!0,!0,T,!0),this.ia.Ia(M.a.Ydb,2,ua));break;case M.a.Bxd:this.ka.getBooleanAppSetting("IsInkPartialEraserEnabled")&&(this.GB(ie.Xdb,!0,!1,T,!1),this.GB(ie.iY,!0,!0,T,!0),this.ia.Ia(M.a.Xdb,2,ua));break;case M.a.Cxd:this.GB(ie.Zma,!I,!1,T,!1);this.ia.Ia(M.a.Zma,2,ua);break;case M.a.yxd:this.GB(ie.C$,!0,!1,T,!1);this.ia.Ia(M.a.C$,2,ua);break;case M.a.mNa:this.GB(ie.iHa,!0,!1,T,!1),this.GB(ie.Vva,!1,!1,T,!1),this.ia.nb(M.a.iHa,2)}T.commit();this.VLk&&Hy.ShyRibbon.qTa(1,
2);return 32};this.B8h=()=>{this.Dxb(!1);this.vVc()};this.ia=a;this.VLk=f;this.ka=l;this.aZ=new Cc.a;this.Caa=new Cc.a;for(const u of Np.T4c){a="";if(md.a("IsPenColorRetentionEnabled"))(a=GH.a.instance.getItem(u+"Color"))||(a=Np.mJl[u]);else switch(u){case ie.jz:a="#000000";break;case ie.UA:a="#E71224";break;case ie.TA:a="#FFFC00"}this.aZ.$(u,Object.assign(new JH,{selected:!1,iconColor:a}))}A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb&&A.AFrameworkApplication.za.mb.es&&this.qb();this.OZa=
new La.a;this.OZa.add("#FFC114");this.OZa.add("#F6630D");this.OZa.add("#FF0066");this.OZa.add("#5B2D90");this.KHb=new La.a;this.KHb.add("#00F900");this.KHb.add("#00FDFF");this.KHb.add("#FF40FF");this.KHb.add("#FF8517");this.mB=ie.jz;b.oOc(Object(R.a)(this,this.ZV,"onFocusChanged"));md.a("InkEscapeKeyPressedHandling")&&b.sLf(this.B8h);this.iEe=!c||!c.Ic}qb(){this.ia.pa(M.a.eqe,ta.a.application,Object(R.a)(this,this.fgj,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.pa(M.a.Txg,ta.a.application,Object(R.a)(this,
this.vZj,"handleRefreshInkUIValues"),4);this.ia.pa(M.a.U4c,ta.a.application,Object(R.a)(this,this.EWj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.pa(M.a.zxd,ta.a.application,this.c1,4);this.ia.pa(M.a.Axd,ta.a.application,this.c1,4);this.ia.pa(M.a.xxd,ta.a.application,this.c1,4);this.ia.pa(M.a.Cxd,ta.a.application,this.c1,4);this.ia.pa(M.a.qxd,ta.a.application,this.c1,4);this.ia.pa(M.a.rxd,ta.a.application,this.c1,4);this.ia.pa(M.a.sxd,ta.a.application,this.c1,4);this.ia.pa(M.a.txd,ta.a.application,
this.c1,4);this.ia.pa(M.a.uxd,ta.a.application,this.c1,4);this.ia.pa(M.a.vxd,ta.a.application,this.c1,4);this.ia.pa(M.a.G6e,ta.a.application,Object(R.a)(this,this.hne,"handleThicknessSliderChanged"),4);this.ia.pa(M.a.H6e,ta.a.application,Object(R.a)(this,this.hne,"handleThicknessSliderChanged"),4);this.ia.pa(M.a.I6e,ta.a.application,Object(R.a)(this,this.hne,"handleThicknessSliderChanged"),4);this.ia.pa(M.a.F6e,ta.a.application,Object(R.a)(this,this.CWj,"handleInkDrawWithTouchSelected"),4);md.a("PenDownHandlingEnabled")&&
this.ia.pa(M.a.$Jh,ta.a.application,this.FWj,4);this.ia.pa(M.a.wxd,ta.a.application,this.c1,4);this.ka.getBooleanAppSetting("IsInkPartialEraserEnabled")&&(this.ia.pa(M.a.Dxd,ta.a.application,this.c1,4),this.ia.pa(M.a.Bxd,ta.a.application,this.c1,4));this.ia.pa(M.a.yxd,ta.a.application,this.c1,4);this.ia.pa(M.a.mNa,ta.a.application,this.c1,4)}EWj(a,b,c,f,l){if(1===c)return 32;this.iEe=l;return 32}vZj(a,b,c){if(1===c)return 32;a=new us;this.dRb(ie.jHa,this.z_a,a);this.dRb(ie.kHa,this.A_a,a);this.dRb(ie.lHa,
this.y_a,a);md.a("IsPenColorRetentionEnabled")||a.commit();this.Caa.count||this.Gxk();md.a("IsPenColorRetentionEnabled")&&(this.Lyd(ie.jz,this.aZ.ga(ie.jz).iconColor,a),this.Lyd(ie.UA,this.aZ.ga(ie.UA).iconColor,a),this.Lyd(ie.TA,this.aZ.ga(ie.TA).iconColor,a),a.commit());return 32}CWj(a,b,c,f,l){if(1===c)return this.iEe?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.aZ.ga(ie.Vva).selected||a?(this.Dxb(!1),this.vVc()):(this.Dxb(!1),a=new us,this.GB(ie.Vva,!0,!1,a,!1),this.GB(this.mB,!0,!0,a,!0),
a.commit(),this.ia.Ia(M.a.cqe,2,{enable:!0}));return 32}hne(a,b,c,f,l){if(1===c)return 32;b=new us;md.a("DrawWithTouchEnabledOnThicknessSliderMove")||this.GB(ie.Vva,!0,!1,b,!1);l&&l&&(l[Np.l3l]=Lp.Value);switch(a){case M.a.G6e:this.ia.Ia(M.a.jHa,2,l);this.z_a=this.Xcb(l);this.dRb(ie.jHa,this.z_a,b);this.mB=ie.jz;break;case M.a.H6e:this.ia.Ia(M.a.kHa,2,l);this.A_a=this.Xcb(l);this.dRb(ie.kHa,this.A_a,b);this.mB=ie.UA;break;case M.a.I6e:this.ia.Ia(M.a.lHa,2,l),this.y_a=this.Xcb(l),this.dRb(ie.lHa,this.y_a,
b),this.mB=ie.TA}b.commit();return 32}isEnabled(a){return this.aZ.ga(a).selected}fgj(a,b,c){if(1===c)return 32;if(!fh.c())return ya.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.Caa.count)return 32;this.Dxb(!1);this.vVc();this.aZ.ga(this.mB).selected=!1;a=new us;this.GB(this.mB,!0,!0,a,!0);this.ia.nb(M.a.dqe,2);a.commit();return 32}Gxk(){for(const a of Np.T4c)switch(a){case ie.jz:this.jhc(ie.jz);break;case ie.UA:this.jhc(ie.UA);break;
case ie.TA:this.jhc(ie.TA);break;case ie.iY:this.jhc(ie.iY);break;case ie.C$:this.jhc(ie.C$)}}jhc(a){const b=appChrome.selectors.getInkButtonState(a);this.Caa.$(a,Object.assign(new KH,{label:ie.Fdg in b?Object(gb.a)(String,b[ie.Fdg]):"",iconName:ie.Ddg in b?Object(gb.a)(String,b[ie.Ddg]):"",keytip:ie.Edg in b?Object(gb.a)(String,b[ie.Edg]):""}))}Dxb(a){const b=new us;for(const c of Np.T4c)if(c!==ie.Zma)switch(this.GB(c,!1,!1,b,!0),c){case ie.jz:this.Pxb(ie.jz,b,!0,a);break;case ie.UA:this.Pxb(ie.UA,
b,!0,a);break;case ie.TA:this.Pxb(ie.TA,b,!0,a);break;case ie.iY:this.Pxb(ie.iY,b,!0,a);break;case ie.C$:this.Pxb(ie.C$,b,!0,a)}b.commit()}S3h(a,b,c){c.xa(appChrome.actions.toggleButton(a,b));this.aZ.ga(a).selected=b}GB(a,b,c,f,l){c?b?(b&&!this.aZ.ga(a).selected&&this.PWi(a,f,l),this.S3h(a,b,f)):this.Pxb(a,f,l,a!==ie.iHa):this.S3h(a,b,f)}Pxb(a,b,c,f){if(this.Caa.Ib(a)){var l=this.Caa.ga(a).iconName,u=this.Caa.ga(a).keytip,I=this.Caa.ga(a).label,T=this.zge(a);a=appChrome.api.createInkButtonModel(a,
T?T:I,Object.assign(new HH,{iconSet:(new Mp.a(l)).iconSet,iconColor:this.aZ.ga(a).iconColor,keytip:u,animateTransition:c&&!f}));b.xa(appChrome.actions.addControls([a]))}}PWi(a,b,c){if(this.Caa.Ib(a)){var f=this.zge(a),l=this.Caa.ga(a).iconName,u=this.Caa.ga(a).keytip,I=this.Caa.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,f?f:I,Object.assign(new IH,{iconSet:(new Mp.a(l)).iconSet,iconColor:this.aZ.ga(a).iconColor,keytip:u,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));
b.xa(appChrome.actions.addControls([a]))}}zge(a){if(this.ka.getBooleanAppSetting("InkColorLabelEnabled")){var b=void 0;switch(a){case ie.jz:case ie.UA:var c=appChrome.selectors.getColorPickerState(ie.Mfa);break;case ie.TA:c=appChrome.selectors.getColorPickerState(ie.Uva)}c&&(c=this.y0f(Array.isArray(c.colorCells)?c.colorCells:null),b=this.Caa.ga(a).label,b=`${b.split(":")[0]}: ${c[this.aZ.ga(a).iconColor].label}`);return b}}Lyd(a,b,c){c.xa(appChrome.actions.updateIconColor(a,b));this.XQl(a,c)}XQl(a,
b){const c=this.zge(a);c&&b.xa(appChrome.actions.setControlLabel(a,c))}YQl(a,b,c){c.xa(appChrome.actions.populateColorPickerCells(a,b))}dRb(a,b,c){c.xa(appChrome.actions.updateSliderSelectedValue(a,b))}khl(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.y0f(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.YQl(l,this.bFj(a,c),f)}}cFj(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}y0f(a){const b={};for(const c of a)b[c.id]=c;return b}bFj(a,
b){const c=[];for(const f of b)f in a&&Array.add(c,a[f]);return c}Pwe(a){return a&&a.InputMethod?a.InputMethod===ie.iqe:!1}L9e(a){return!a||E.a.Aj||E.a.pec}iLj(a,b){a&&a.Color&&(b=6===Object(gb.a)(String,a.Color).length?"#"+a.Color:Object(gb.a)(String,a.Color));return b}qQb(a,b,c,f,l,u,I){l=this.iLj(u,l);this.aZ.ga(a).iconColor=l;md.a("IsPenColorRetentionEnabled")&&GH.a.instance.setItem(a+"Color",l);this.Lyd(a,l,I);this.cFj(b,l);this.khl(c,f,b,I)}vVc(){const a=new us;this.GB(ie.Vva,!1,!1,a,!1);this.ia.Ia(M.a.cqe,
2,{enable:!1});a.commit()}ZV(a,b){b.ONb===xc.a.mQ&&b.qkb!==xc.a.mQ&&this.ia.nb(M.a.Rxg,2);b.ONb!==xc.a.Ag&&b.qkb===xc.a.Ag&&this.ia.nb(M.a.Vxg,2)}Xcb(a){return a&&a[Lp.Value]?a[Lp.Value]:Np.zQc}}Np.l3l="SliderCommandPropertiesValueKey";Np.zQc=3;Np.T4c=[ie.jz,ie.UA,ie.Vva,ie.iY,ie.Ydb,ie.Xdb,ie.TA,ie.Zma,ie.C$,ie.iHa];Np.mJl={[ie.jz]:"#000000",[ie.UA]:"#E71224",[ie.TA]:"#FFFC00"};Object(m.a)(Np,"InkRibbonManager",null,[896]);class LH{constructor(a){this.MCe=a}get BAa(){return this.MCe.BAa}R_c(){return this.MCe.R_c()}E4e(){this.MCe.E4e()}}
Object(m.a)(LH,"PPTChromeExtensionHelper",null,[891,237]);var Xa=d(542);class Fh{constructor(a,b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(m.a)(Fh,"MenuPopulationProperties",null,[]);class Iy{constructor(){this.DEc={};this.AEc={};this.IGf={};this.BEc={};this.zMd={};this.AMd={};this.lNd={};this.Ysi()}hva(a){return this.AEc[a]}phe(a){return this.BEc[a]}oCj(a){return this.zMd[a]}getCommandByExternalUxId(a){return this.DEc[a]}kle(a){return this.IGf[a]}Xig(a){if(a in
this.lNd)return this.lNd[a];da.ULS.sendTraceTag(39946131,306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}nCj(a){return this.AMd[a]}nJf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.DEc[a.externalUxCommand];if(b){delete this.DEc[b.externalUxCommand];const c=this.AEc[b.commandId];for(let f=0;f<c.length;f++)if(c[f].externalUxCommand===b.externalUxCommand){Array.remove(c,c[f]);break}}this.DEc[a.externalUxCommand]=
a;b=this.AEc[a.commandId];if(void 0===b||null===b)b=[],this.AEc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.BEc[a.legacyControlId]||(this.BEc[a.legacyControlId]=new La.a),this.BEc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.IGf[a]=b}addIconToMap(a,b){this.lNd[b]=a}hj(a){if(a.legacyGroupId){var b=this.zMd[a.legacyGroupId];b||(b=[],this.zMd[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.AMd[a.externalUxGroupId],b||(b=[],this.AMd[a.externalUxGroupId]=b),b.push(a))}Ysi(){this.addCommandToMaps(Object.assign(new Xa.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Xa.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Xa.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Xa.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Xa.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Xa.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Xa.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(new Xa.a("CoEditInTeams","327119921"));this.addCommandToMaps(Object.assign(new Xa.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Xa.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Xa.a("DownloadACopy",
"3555692408"),{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Xa.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Xa.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Xa.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Xa.a("HideRibbon","336231556"));this.addCommandToMaps(new Xa.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Xa.a("InsertMoreAddInsFromBackstageFooter",
"1945259303"));this.addCommandToMaps(new Xa.a("InsertMoreAddInsFromFooter","1945259303"));this.addCommandToMaps(new Xa.a("InsertAddInsFromBackstage","1945259303"));this.addCommandToMaps(new Xa.a("InsertAddinTransitionEntry","1095658066"));this.addCommandToMaps(new Xa.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Xa.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Xa.a("LaunchAddinInstallDialogFromBackstage","3164366947"));
this.addCommandToMaps(new Xa.a("LaunchMyAddInsFromBackstage","1945259303"));this.addCommandToMaps(new Xa.a("LaunchUserInstalledAddInFromBackstage","2544406033"));this.addCommandToMaps(new Xa.a("ManageAccess","981334692"));this.addCommandToMaps(new Xa.a("MenuClose","336231556"));this.addCommandToMaps(new Xa.a("MenuOpen","336231556"));this.addCommandToMaps(new Xa.a("MenuPopulate","336231556"));this.addCommandToMaps(new Xa.a("TriggerModeSwitcherTUI","1251719100"));this.addCommandToMaps(new Xa.a("MoveToFolder",
"1182470434"));this.addCommandToMaps(new Xa.a("NavigateToCoauthor","4033456482"));this.addCommandToMaps(new Xa.a("New","1056925771"));this.addCommandToMaps(new Xa.a("NewBrowserSuggestionClicked","3734060499"));this.addCommandToMaps(Object.assign(new Xa.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Xa.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new Fh("1285265560",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("Privacy",
"1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Xa.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));this.addCommandToMaps(Object.assign(new Xa.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Xa.a("SearchHelp",
"2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Xa.a("ShareTopBar","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(new Xa.a("ShowMultilineRibbonFromToolbar","1088082265"));this.addCommandToMaps(new Xa.a("ShowToolBarFromMultiLineRibbon","336231556"));this.addCommandToMaps(Object.assign(new Xa.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"}));
this.addCommandToMaps(new Xa.a("TabSwitch","336231556"));this.addCommandToMaps(Object.assign(new Xa.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));this.addCommandToMaps(Object.assign(new Xa.a("Training","2918242107"),{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Xa.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Xa.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));this.addCommandToMaps(Object.assign(new Xa.a("Zoom",
"1738002952"),{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));this.addCommandToMaps(new Xa.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Xa.a("RibbonModeToggledToMLR","536345575"));this.addCommandToMaps(new Xa.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Xa.a("Workflow","2988588587"));this.addCommandToMaps(new Xa.a("ToggleVNextLook",
"1650341290"));this.addCommandToMaps(Object.assign(new Xa.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpWithDescriptionFromTellMe1",
"2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(new Xa.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Xa.a("AnswerForSearchSingleLine","1914896509"));this.addCommandToMaps(new Xa.a("ReuseFileQuickActionForSearch","1914896509"));this.addCommandToMaps(new Xa.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Xa.a("PeopleSuggestion2",
"2133437453"));this.addCommandToMaps(new Xa.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Xa.a("QuickActionOnFile","548581900"));this.addCommandToMaps(new Xa.a("GenerateSlidesFromTellMe","2862675062"));this.addCommandToMaps(new Xa.a("FileSuggestion1","2260671807"));this.addCommandToMaps(new Xa.a("FileSuggestion2","2260671810"));this.addCommandToMaps(new Xa.a("FileSuggestion3","2260671809"));this.addCommandToMaps(new Xa.a("FileSuggestion4","2260671804"));this.addCommandToMaps(new Xa.a("FileSuggestion5",
"2260671803"));this.addCommandToMaps(new Xa.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Xa.a("NotesSuggestion2","1914896509"));this.addCommandToMaps(new Xa.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Xa.a("OnenoteNotesSuggestion1","4083547050"));this.addCommandToMaps(new Xa.a("OnenoteNotesSuggestion2","4083547053"));this.addCommandToMaps(new Xa.a("OnenoteNotesSuggestion3","4083547052"));this.addCommandToMaps(new Xa.a("TellMeFeedback","2230755196"));this.addCommandToMaps(new Xa.a("TemplateForSearch",
"57037313"));this.addCommandToMaps(new Xa.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Xa.a("AddinSuggestion2","981735384"));this.addCommandToMaps(new Xa.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Xa.a("LaunchAddinDialogFromTellMe","1421877154"));A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.SRb?(this.addCommandToMaps(new Xa.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new Xa.a("FindParameterized","1914896509")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion1",
"1914896509")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Xa.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new Xa.a("FindParameterized","1540292897")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new Xa.a("FindInDocumentSuggestion3",
"1540292897")));this.addCommandToMaps(new Xa.a("ImageForSearch","1914896509"));this.addCommandToMaps(new Xa.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Xa.a("SmartLookupFromTellMe","1914896509"));this.addCommandToMaps(new Xa.a("SmartLookupFromTellMeQueryTermAtTop","1914896509"));this.addCommandToMaps(new Xa.a("SmartLookupFromTellMeZeroTerm","3359903192"));this.addCommandToMaps(new Xa.a("ActionAIFromTellMe","1914896509"));!A.AFrameworkApplication.oHa||A.AFrameworkApplication.LAa||
A.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Xa.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Xa.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new Xa.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new Xa.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Xa.a("SynonymsParameterized",
"2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Xa.a("TellMeLogMenuClose","4266170064"));this.addCommandToMaps(new Xa.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Xa.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Xa.a("TellMeSearchResultChange","2652476189"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_1","1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_3",
"1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Xa.a("TellMeSuggestion_5","1404166600"));this.addCommandToMaps(new Xa.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Xa.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));this.addCommandToMaps(Object.assign(new Xa.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Xa.a("FileAboutPage",
"336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Xa.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Xa.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Xa.a("FileGetAddinsPage","336231556"),{legacyControlId:"faGetAddinsFromBackstage"}));this.addCommandToMaps(Object.assign(new Xa.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Xa.a("FileNewPage",
"2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Xa.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Xa.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Xa.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"}));this.addCommandToMaps(Object.assign(new Xa.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Xa.a("FileTransformPage",
"336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Xa.a("NewDocument","1056925771"));this.addCommandToMaps(new Xa.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Xa.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Xa.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"}));this.addCommandToMaps(Object.assign(new Xa.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Xa.a("ThirdPartyNotices",
"2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Xa.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Xa.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Xa.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Xa.a("PreviousVersions",
"466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Xa.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Xa.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Xa.a("HostConversation","710925581"),{legacyControlId:"HostConversation"}));this.addCommandToMaps(Object.assign(new Xa.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));
this.addCommandToMaps(Object.assign(new Xa.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Xa.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Xa.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Xa.a("Sensitivity","941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new Fh("1145315516",
!0)}));this.addCommandToMaps(Object.assign(new Xa.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&this.addCommandToMaps(Object.assign(new Xa.a("OpenDocumentShortLabelPane","390001269"),{queryCommandId:"888027492"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertAddInFlyout","2749373765"),{populationProps:new Fh("1230970894",!1)}));
this.addCommandToMaps(Object.assign(new Xa.a("ReloadAddInPicker","2502873265"),{populationProps:new Fh("1230970894",!1)}));this.addCommandToMaps(new Xa.a("LaunchAddinInstallDialogFromList","1497204054"));this.addCommandToMaps(new Xa.a("InstallPopularAddInAndLaunchIt","2882601901"));this.addCommandToMaps(new Xa.a("FreemiumUpsellEligible","1274543852"));this.addCommandToMaps(new Xa.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Xa.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));
this.addCommandToMaps(new Xa.a("HandleDiscoverPremiumButtonClick","2280081216"));this.addCommandToMaps(new Xa.a("RequestFontInfo","3169500754"));this.addCommandToMaps(new Xa.a("PinOrUnpinFont","1500655301"));this.addCommandToMaps(new Xa.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Xa.a("FontPickerMenuOpen","482125874"));this.addCommandToMaps(new Xa.a("ShowAccessibilitySettingsDialog","2236763780"));this.addCommandToMaps(new Xa.a("ShowRibbonSettingsDialog","4211880506"));this.addCommandToMaps(Object.assign(new Xa.a("ShowZoomDialog",
"1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"}));this.addCommandToMaps(new Xa.a("ZoomToPercentageCompleted","3139946409"));this.addCommandToMaps(Object.assign(new Xa.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new Fh("860679239",!1)}));let a;this.addCommandToMaps((a=new Xa.a("InsertLinkFlyout","1052791248"),
a.queryCommandId="1052791248",a.populationProps=new Fh("276140882",!1),a))}}Object(m.a)(Iy,"ReactCommandDefinitionMapping",null,[674]);class Rg{constructor(a){this.externalUxCommandIds=this.commandId=this.externalUxGroupId=this.legacyGroupId=null;this.legacyGroupId=a}}Object(m.a)(Rg,"GroupMetadata",null,[]);class UC extends Iy{constructor(a,b){super();this.ZFk="AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.WFk=26;this.VFk="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.YFk=31;this.XFk="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.ZTk=23;this.YTk="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.uOk="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.DRk="ChangeShape_ShapeAlternateProcess_126 ChangeShape_ShapeArc_84 ChangeShape_ShapeBentArrow_28 ChangeShape_ShapeBentUpArrow_31 ChangeShape_ShapeBevel_74 ChangeShape_ShapeBlockArc_77 ChangeShape_ShapeCan_7 ChangeShape_ShapeCard_139 ChangeShape_ShapeChevron_38 ChangeShape_ShapeChord_66 ChangeShape_ShapeCircularArrow_45 ChangeShape_ShapeCloud_83 ChangeShape_ShapeCloudCallout_93 ChangeShape_ShapeCollate_143 ChangeShape_ShapeConnector_137 ChangeShape_ShapeCross_72 ChangeShape_ShapeCube_8 ChangeShape_ShapeCurvedArrowConnector_153 ChangeShape_ShapeCurvedConnector_25 ChangeShape_ShapeCurvedDoubleArrowConnector_154 ChangeShape_ShapeCurvedDownArrow_46 ChangeShape_ShapeCurvedDownRibbon_120 ChangeShape_ShapeCurvedLeftArrow_33 ChangeShape_ShapeCurvedRightArrow_32 ChangeShape_ShapeCurvedUpArrow_34 ChangeShape_ShapeCurvedUpRibbon_119 ChangeShape_ShapeData_128 ChangeShape_ShapeDecagon_63 ChangeShape_ShapeDecision_127 ChangeShape_ShapeDelay_148 ChangeShape_ShapeDiagonalStripe_71 ChangeShape_ShapeDiamond_58 ChangeShape_ShapeDirectAccessStorage_151 ChangeShape_ShapeDisplay_152 ChangeShape_ShapeDocument_131 ChangeShape_ShapeDodecagon_64 ChangeShape_ShapeDonut_75 ChangeShape_ShapeDoubleBrace_86 ChangeShape_ShapeDoubleBracket_85 ChangeShape_ShapeDoubleWave_124 ChangeShape_ShapeDownArrow_0 ChangeShape_ShapeDownArrowCallout_40 ChangeShape_ShapeDownRibbon_118 ChangeShape_ShapeElbowArrowConnector_155 ChangeShape_ShapeElbowConnector_26 ChangeShape_ShapeElbowDoubleArrowConnector_156 ChangeShape_ShapeEllipse_9 ChangeShape_ShapeExplosion1_106 ChangeShape_ShapeExplosion2_107 ChangeShape_ShapeExtract_145 ChangeShape_ShapeFoldedCorner_78 ChangeShape_ShapeFrame_68 ChangeShape_ShapeGallery ChangeShape_ShapeHalfFrame_69 ChangeShape_ShapeHeart_18 ChangeShape_ShapeHeptagon_61 ChangeShape_ShapeHexagon_60 ChangeShape_ShapeHorizontalScroll_122 ChangeShape_ShapeInternalStorage_130 ChangeShape_ShapeLeftArrow_1 ChangeShape_ShapeLeftArrowCallout_41 ChangeShape_ShapeLeftBrace_89 ChangeShape_ShapeLeftBracket_87 ChangeShape_ShapeLeftRightArrow_2 ChangeShape_ShapeLeftRightArrowCallout_43 ChangeShape_ShapeLeftRightUpArrow_27 ChangeShape_ShapeLeftUpArrow_30 ChangeShape_ShapeLightningBolt_80 ChangeShape_ShapeLineCallout1_94 ChangeShape_ShapeLineCallout1Accent_97 ChangeShape_ShapeLineCallout1BorderAccent_100 ChangeShape_ShapeLineCallout1NoBorder_103 ChangeShape_ShapeLineCallout2_95 ChangeShape_ShapeLineCallout2Accent_98 ChangeShape_ShapeLineCallout2BorderAccent_101 ChangeShape_ShapeLineCallout2NoBorder_104 ChangeShape_ShapeLineCallout3_96 ChangeShape_ShapeLineCallout3Accent_99 ChangeShape_ShapeLineCallout3BorderAccent_102 ChangeShape_ShapeLineCallout3NoBorder_105 ChangeShape_ShapeLShape_70 ChangeShape_ShapeMagneticDisk_150 ChangeShape_ShapeManualInput_135 ChangeShape_ShapeManualOperation_136 ChangeShape_ShapeMathDivide_22 ChangeShape_ShapeMathEqual_23 ChangeShape_ShapeMathMinus_20 ChangeShape_ShapeMathMultiply_21 ChangeShape_ShapeMathNotEqual_24 ChangeShape_ShapeMathPlus_19 ChangeShape_ShapeMerge_146 ChangeShape_ShapeMoon_82 ChangeShape_ShapeMultidocument_132 ChangeShape_ShapeNoSymbol_76 ChangeShape_ShapeNotchedRightArrow_36 ChangeShape_ShapeOctagon_62 ChangeShape_ShapeOffpageConnector_138 ChangeShape_ShapeOr_142 ChangeShape_ShapeOvalCallout_92 ChangeShape_ShapeParallelogram_56 ChangeShape_ShapePentagon_37 ChangeShape_ShapePie_65 ChangeShape_ShapePlaque_73 ChangeShape_ShapePredefinedProcess_129 ChangeShape_ShapePreparation_134 ChangeShape_ShapeProcess_125 ChangeShape_ShapePunchedTape_140 ChangeShape_ShapeQuadArrow_47 ChangeShape_ShapeQuadArrowCallout_44 ChangeShape_ShapeRectangle_10 ChangeShape_ShapeRectangularCallout_91 ChangeShape_ShapeRightArrow_3 ChangeShape_ShapeRightArrowCallout_39 ChangeShape_ShapeRightBrace_90 ChangeShape_ShapeRightBracket_88 ChangeShape_ShapeRightTriangle_55 ChangeShape_ShapeRoundDiagonalCornerRectangle_48 ChangeShape_ShapeRoundedRectangle_11 ChangeShape_ShapeRoundedRectangleCallout_6 ChangeShape_ShapeRoundSameSideCornerRectangle_49 ChangeShape_ShapeRoundSingleCornerRectangle_50 ChangeShape_ShapeSequentialActionStorage ChangeShape_ShapeSequentialActionStorage_149 ChangeShape_ShapeSmileyFace_79 ChangeShape_ShapeSnipDiagonalCornerRectangle_52 ChangeShape_ShapeSnipRoundSingleCornerRectangle_51 ChangeShape_ShapeSnipSameSideCornerRectangle_53 ChangeShape_ShapeSnipSingleCornerRectangle_54 ChangeShape_ShapeSort_144 ChangeShape_ShapeSPentagon_59 ChangeShape_ShapeStar10_112 ChangeShape_ShapeStar12_113 ChangeShape_ShapeStar16_114 ChangeShape_ShapeStar24_115 ChangeShape_ShapeStar32_116 ChangeShape_ShapeStar4_108 ChangeShape_ShapeStar5_15 ChangeShape_ShapeStar6_109 ChangeShape_ShapeStar7_110 ChangeShape_ShapeStar8_111 ChangeShape_ShapeStoredData_147 ChangeShape_ShapeStraightConnector_12 ChangeShape_ShapeStraightConnectorArrow_13 ChangeShape_ShapeStraightConnectorTwoArrow_14 ChangeShape_ShapeStripedRightArrow_35 ChangeShape_ShapeSummingJunction_141 ChangeShape_ShapeSun_81 ChangeShape_ShapeTeardrop_67 ChangeShape_ShapeTerminator_133 ChangeShape_ShapeTrapezoid_57 ChangeShape_ShapeTriangle_17 ChangeShape_ShapeUpArrow_4 ChangeShape_ShapeUpArrowCallout_42 ChangeShape_ShapeUpDownArrow_5 ChangeShape_ShapeUpRibbon_117 ChangeShape_ShapeUTurnArrow_29 ChangeShape_ShapeVerticalScroll_121 ChangeShape_ShapeWave_123".split(" ");
this.tOk="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.rch="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.DGk="CameoStyles_NoEffectStyle_34500 CameoStyles_SimpleFrameRectangle_34501 CameoStyles_CenterShadowRectangle_34502 CameoStyles_SoftEdgeRectangle_34503 CameoStyles_SimpleFrameCircle_34504 CameoStyles_CenterShadowCircle_34505 CameoStyles_SoftEdgeCircle_34506 CameoStyles_CenterShadowDiamond_34507 CameoStyles_CenterShadowHexagon_34508".split(" ");this.ka=a;this.Lb=b;this.MYd();this.uti();this.bti();this.ati();this.iti();this.kti();this.nti();this.tti();this.lti();this.hti();this.eti();this.qti();
this.mti();this.oti();this.sti();this.AZd();this.tui();this.rti();this.Bui();this.Zsi();this.gti();this.cti();this.$si();this.jti();this.pti();this.fti();this.dti()}Bui(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}MYd(){this.addCommandToMaps(new Xa.a("AddSection",M.a.z9a.toString()));var a=new Xa.a("AlternativeText",M.a.aPc.toString());a.legacyControlId="AlternativeText";a.queryCommandId=M.a.dOb.toString();this.addCommandToMaps(a);
this.addCommandToMaps(new Xa.a("AlignAnchor",M.a.hNf.toString()));this.addCommandToMaps(Object.assign(new Xa.a("AlwaysUseSubtitles",M.a.BOa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:M.a.g2a.toString()}));this.addCommandToMaps(new Xa.a("ArrangeAnchor",M.a.hwb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("AudioSettings",M.a.BAd.toString()),{queryCommandId:M.a.EOb.toString()}));this.addCommandToMaps(new Xa.a("LivePollTaskPane",M.a.DAd.toString()));this.addCommandToMaps(new Xa.a("ArrangeShapeAnchor",
M.a.hwb.toString()));this.addCommandToMaps(new Xa.a("BeginEditShapeText",M.a.Y9a.toString()));this.addCommandToMaps(Object.assign(new Xa.a("Bold",M.a.oNb.toString()),{queryCommandId:M.a.pOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("BottomOverlaid",M.a.CTb.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:M.a.dmb.toString()}));this.addCommandToMaps(new Xa.a("BringToFrontFlyout",M.a.zRf.toString()));this.addCommandToMaps(new Xa.a("BringForward",
M.a.bringForward.toString()));this.addCommandToMaps(new Xa.a("BringToFront",M.a.bringToFront.toString()));this.addCommandToMaps(Object.assign(new Xa.a("BulletLibrary",M.a.eqa.toString()),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:M.a.qOb.toString(),populationProps:new Fh(M.a.ntc.toString(),!1)}));this.addCommandToMaps(Object.assign(new Xa.a("CatchUpWithChanges",N.a.Tef.toString()),{legacyControlId:"CatchUpWithChanges",queryCommandId:N.a.Qyh.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseCapitalizeEachWord",
G.a.y$a.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseLower",G.a.nxb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseMenuEnabled",M.a.IVf.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseSentence",G.a.Z4b.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseToggle",G.a.$4b.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeCaseUpper",G.a.oxb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Xa.a("ChangeLayout",M.a.lla.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ChangeGraphicContextMenu",M.a.d4d.toString()),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangeGraphicFlyout",M.a.d4d.toString()),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePicture",M.a.sRc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenu",M.a.i4d.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuBing",
M.a.d5b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuM365",M.a.z$a.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuCreateWithAI",M.a.g5b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromCreateWithAI"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuIcons",
M.a.pTa.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuDevice",M.a.sRc.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuOneDrive",M.a.e5b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",queryCommandId:M.a.iuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureContextMenuMobileDevice",
M.a.h5b.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyout",M.a.i4d.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutBing",M.a.d5b.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutM365",M.a.z$a.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutCreateWithAI",M.a.g5b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromCreateWithAI"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutIcons",M.a.pTa.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutDevice",M.a.sRc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));
this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutOneDrive",M.a.e5b.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",queryCommandId:M.a.iuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ChangePictureFlyoutMobileDevice",M.a.h5b.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Xa.a("RemovePictureBackground",M.a.gvd.toString()),{legacyControlId:"RemovePictureBackground"}));this.addCommandToMaps(Object.assign(new Xa.a("RestorePictureBackground",
M.a.ewd.toString()),{legacyControlId:"RestorePictureBackground"}));this.addCommandToMaps(Object.assign(new Xa.a("ChangeSmartArtColorAnchor",M.a.OVf.toString()),{populationProps:new Fh(M.a.avh.toString(),!1)}));this.addCommandToMaps(new Xa.a("CheckAccessibility",M.a.qYe.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ClearFormatting",M.a.clearFormatting.toString()),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));this.addCommandToMaps(new Xa.a("ClearTableFormatting",G.a.J$a.toString()));
this.addCommandToMaps(Object.assign(new Xa.a("CommentsPane",M.a.n3.toString()),{queryCommandId:M.a.FOb.toString()}));this.addCommandToMaps(new Xa.a("CopyHyperlink",G.a.dTc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ContextMenu",G.a.qNf.toString()),{populationProps:new Fh(G.a.Wrd.toString(),!1)}));this.addCommandToMaps(Object.assign(new Xa.a("SelectionPane",M.a.R7.toString()),{queryCommandId:M.a.BOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("RenderFooterPane",M.a.r_.toString()),
{queryCommandId:M.a.guc.toString()}));this.addCommandToMaps(new Xa.a("InsertSlideNumber",M.a.pXa.toString()));this.addCommandToMaps(Object.assign(new Xa.a("RenderSelectionPane",M.a.R7.toString()),{queryCommandId:M.a.BOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("CommentsShowMarkUp",M.a.dSb.toString()),{queryCommandId:M.a.Ltd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("CommentsShowAdvancedMarkUp",M.a.Nyc.toString()),{queryCommandId:M.a.l0e.toString()}));this.addCommandToMaps(new Xa.a("Copy",
M.a.pNb.toString()));this.addCommandToMaps(new Xa.a("CopyInVersionHistory",M.a.e5h.toString()));this.addCommandToMaps(new Xa.a("ClickVersionHistoryRestore",M.a.G5b.toString()));this.addCommandToMaps(new Xa.a("ClickVersionHistorySaveACopy",M.a.b5d.toString()));this.addCommandToMaps(new Xa.a("ClickVersionHistoryDownloadVersion",M.a.a5d.toString()));this.addCommandToMaps(new Xa.a("Cut",M.a.qNb.toString()));this.addCommandToMaps(new Xa.a("Delete",M.a.deleteObject.toString()));this.addCommandToMaps(new Xa.a("DeleteAllCommentsInPresentation",
M.a.Lyb.toString()));this.addCommandToMaps(new Xa.a("DeleteAllCommentsInSlide",M.a.mUa.toString()));this.addCommandToMaps(new Xa.a("DeleteAllResolvedComments",M.a.Myb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("DeleteComment",M.a.deleteComment.toString()),{queryCommandId:M.a.pnl.toString()}));this.addCommandToMaps(new Xa.a("DeleteRepeatedWord",G.a.pFa.toString()));this.addCommandToMaps(new Xa.a("DeleteSlide",M.a.QJ.toString()));this.addCommandToMaps(Object.assign(new Xa.a("DesignerHome",
M.a.T$e.toString()),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:M.a.Kuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("DesignerNew",M.a.EAd.toString()),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:M.a.Kuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("Dictation",G.a.UAc.toString()),{legacyControlId:"btnStartDictation",queryCommandId:G.a.Wsd.toString(),populationProps:new Fh(G.a.Xsc.toString(),!0)}));this.addCommandToMaps(Object.assign(new Xa.a("DocChat",
N.a.EYh.toString()),{legacyControlId:"DocChat",queryCommandId:N.a.jyh.toString()}));this.addCommandToMaps(new Xa.a("DoNotCheckThisCritiqueType",G.a.dzb.toString()));this.addCommandToMaps(new Xa.a("Duplicate",M.a.Iae.toString()));this.addCommandToMaps(new Xa.a("DuplicateSlide",M.a.uR.toString()));this.addCommandToMaps(new Xa.a("EditHyperlink",M.a.insertHyperlink.toString()));this.addCommandToMaps(Object.assign(new Xa.a("EditInApp",M.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));
this.addCommandToMaps(Object.assign(new Xa.a("EditInAppWithIcon",M.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Xa.a("EditorPane",M.a.tYe.toString()),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:M.a.d0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("EditorPaneSplitButton",M.a.tYe.toString()),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:M.a.e0e.toString()}));this.ka.h5f&&
this.addCommandToMaps(Object.assign(new Xa.a("DexLitePane",M.a.xob.toString()),{queryCommandId:M.a.Ysd.toString()}));this.addCommandToMaps(new Xa.a("Find",M.a.find.toString()));this.addCommandToMaps(new Xa.a("FitToWindow",M.a.HCc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("FixIt",M.a.fixIt.toString()),{legacyControlId:"FixIt",queryCommandId:M.a.E_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("FontColor",M.a.Aza.toString()),{populationProps:new Fh(M.a.wNb.toString(),!1)}));
this.addCommandToMaps(Object.assign(new Xa.a("FontPicker",G.a.font.toString()),{legacyControlId:"fontPicker",queryCommandId:G.a.atd.toString(),populationProps:new Fh(G.a.Ysc.toString(),!0)}));this.ka.getBooleanAppSetting("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Xa.a("FontName",M.a.G1a.toString()),{queryCommandId:M.a.Ulb.toString(),populationProps:new Fh(M.a.Alb.toString(),!1),commandPreviewId:M.a.yNb.toString(),commandRevertId:M.a.BNb.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("FontSize",
M.a.H1a.toString()),{queryCommandId:M.a.Vlb.toString(),commandPreviewId:M.a.zNb.toString(),commandRevertId:M.a.CNb.toString()}))):(this.addCommandToMaps(Object.assign(new Xa.a("FontName",M.a.G1a.toString()),{queryCommandId:M.a.Ulb.toString(),populationProps:new Fh(M.a.Alb.toString(),!1)})),this.addCommandToMaps(Object.assign(new Xa.a("FontSize",M.a.H1a.toString()),{queryCommandId:M.a.Vlb.toString()})));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundApplyToAll",M.a.s$b.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.ka.b9c?(a=new Xa.a("FormatBackgroundPictureMenu",M.a.YYc.toString()),a.legacyControlId="PptRibbon.Design.Customize.FormatBackgroundAnchor",this.addCommandToMaps(a),a=new Xa.a("FormatBackgroundPictureFromDevice",M.a.XYc.toString()),a.legacyControlId="PptRibbon.Design.Customize.FormatBackgroundAnchor",this.addCommandToMaps(a),a=new Xa.a("FormatBackgroundPictureFromStockImages",M.a.Ibb.toString()),a.legacyControlId="PptRibbon.Design.Customize.FormatBackgroundAnchor.StockPictures",this.addCommandToMaps(a)):
this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundPicture",M.a.Yee.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundSolidFill",M.a.jma.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Fh(M.a.Xrd.toString(),!1)}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundReset",M.a.t$b.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundStandardColors",M.a.jma.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundThemeColors",M.a.jma.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Xa.a("FormatBackgroundThemeColorsMCU",M.a.jma.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(new Xa.a("FormatBackgroundRecentColors",M.a.jsd.toString()));this.addCommandToMaps(Object.assign(new Xa.a("FormatPainter",M.a.pVa.toString()),{queryCommandId:M.a.ptd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("HideProofingErrors",M.a.ovg.toString()),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:M.a.dtd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("GiveFeedback",N.a.mQb.toString()),{legacyControlId:"btnFeedback"}));
this.addCommandToMaps(Object.assign(new Xa.a("GrammarOptions",G.a.FMb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Xa.a("ProofingOptions",G.a.FMb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Xa.a("Grow",M.a.xlb.toString()),{legacyControlId:"PptRibbon.Home.Font.Grow"}));this.addCommandToMaps(Object.assign(new Xa.a("HideSlide",M.a.Scc.toString()),{queryCommandId:M.a.Ntd.toString()}));
this.ka.joe&&this.addCommandToMaps(new Xa.a("UnhideSlide",M.a.Ngf.toString()));this.ka.Fyk&&this.addCommandToMaps(new Xa.a("LocalVideoTrimDialog",M.a.vJg.toString()));this.ka.Pkk&&this.addCommandToMaps(new Xa.a("KeyboardShortcutsDialog",M.a.KHg.toString()));this.addCommandToMaps(Object.assign(new Xa.a("Highlight",M.a.tNb.toString()),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));this.addCommandToMaps(new Xa.a("HighlighterColor",G.a.fT.toString()));this.addCommandToMaps(new Xa.a("IgnoreSpellingError",
G.a.Sma.toString()));this.addCommandToMaps(new Xa.a("Indent",M.a.sNb.toString()));this.addCommandToMaps(new Xa.a("InsertAddIns",M.a.jXa.toString()));this.addCommandToMaps(new Xa.a("InsertAddInsFromBackstage",M.a.jXa.toString()));this.addCommandToMaps(Object.assign(new Xa.a("InsertAddinTransitionEntry",N.a.eyg.toString()),{legacyControlId:"PptRibbon.InsertTab.InsertAddinTransitionEntry"}));this.addCommandToMaps(new Xa.a("InsertMoreAddInsFromBackstageFooter",M.a.jXa.toString()));this.addCommandToMaps(new Xa.a("InsertMoreAddInsFromFooter",
M.a.jXa.toString()));this.addCommandToMaps(new Xa.a("InsertComment",M.a.cDb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("InsertIcons",M.a.Kdc.toString()),{legacyControlId:"InsertIconDialog"}));this.addCommandToMaps(new Xa.a("InsertLink",M.a.insertHyperlink.toString()));this.addCommandToMaps(new Xa.a("InsertSocialMediaVideo",M.a.wyg.toString()));this.addCommandToMaps(new Xa.a("InsertPicturesFlyoutDalle",M.a.b5c.toString()));this.addCommandToMaps(new Xa.a("InsertPicturesDalle",M.a.c5c.toString()));
this.addCommandToMaps(new Xa.a("InsertLiveFeed",M.a.e5c.toString()));this.addCommandToMaps(Object.assign(new Xa.a("InsertOnlineVideo",M.a.Xva.toString()),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));(this.ka.f5c||this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOInsertLocalVideoEnabledViaExp",!1))&&this.addCommandToMaps(new Xa.a("InsertVideoFromDevice",M.a.gSb.toString()));this.ka.geb&&this.addCommandToMaps(new Xa.a("InsertVideoFromStock",M.a.xyg.toString()));this.addCommandToMaps(Object.assign(new Xa.a("InsertPicturesFlyout",
M.a.syg.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertPicturesFlyoutBing",M.a.insertOnlinePicture.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));var b;this.addCommandToMaps((b=new Xa.a("InsertPicturesFlyoutM365",M.a.gDb.toString()),b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Xa.a("InsertPicturesM365",M.a.Pdc.toString()),
c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",c));let f;this.addCommandToMaps((f=new Xa.a("InsertPicturesFlyoutDevice",M.a.insertPicture.toString()),f.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",f));let l;this.addCommandToMaps((l=new Xa.a("InsertPicturesFlyoutOneDrive",M.a.hDb.toString()),l.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromHost",l.queryCommandId=M.a.iuc.toString(),l));let u;this.addCommandToMaps((u=new Xa.a("InsertPicturesFlyoutMobileDevice",
M.a.m5c.toString()),u.legacyControlId="InsertPictureFromMobileDevice",u));this.addCommandToMaps(new Xa.a("InsertSlides",M.a.ypa.toString()));let I;this.addCommandToMaps((I=new Xa.a("NewSlideSplit",M.a.lNb.toString()),I.populationProps=new Fh(M.a.lNb.toString(),!1),I));let T;this.addCommandToMaps((T=new Xa.a("InsertSlideSplit",M.a.lNb.toString()),T.populationProps=new Fh(M.a.lNb.toString(),!1),T));this.addCommandToMaps(new Xa.a("NewDefaultSlide",M.a.m7.toString()));let ja;this.addCommandToMaps((ja=
new Xa.a("ChangeLayoutFlyout",M.a.bYe.toString()),ja.populationProps=new Fh(M.a.bYe.toString(),!1),ja));this.addCommandToMaps(new Xa.a("InsertTextBox",M.a.oXa.toString()));this.addCommandToMaps(new Xa.a("InsertAudio",M.a.SRh.toString()));let ua;this.addCommandToMaps((ua=new Xa.a("InsertFooterFlyout",M.a.aeb.toString()),ua.legacyControlId="PptRibbon.InsertTab.FooterFlyout",ua));let Ra;this.addCommandToMaps((Ra=new Xa.a("InsertSymbol",G.a.gCd.toString()),Ra.populationProps=new Fh(G.a.tlb.toString(),
!0),Ra));this.addCommandToMaps(new Xa.a("InsertTable",G.a.insertTable.toString()));this.addCommandToMaps(new Xa.a("InvokeFilesSerplet",N.a.qDb.toString()));let eb;this.addCommandToMaps((eb=new Xa.a("Italic",M.a.uNb.toString()),eb.queryCommandId=M.a.tOb.toString(),eb));this.addCommandToMaps(new Xa.a("LaunchAddinInstallDialogFromBackstage",N.a.lvk.toString()));this.addCommandToMaps(new Xa.a("LaunchMyAddInsFromBackstage",M.a.jXa.toString()));this.addCommandToMaps(new Xa.a("LaunchUserInstalledAddInFromBackstage",
N.a.Fze.toString()));this.addCommandToMaps(new Xa.a("LeftToRight",M.a.htc.toString()));let Bb;this.addCommandToMaps((Bb=new Xa.a("LineSpacing",M.a.ylb.toString()),Bb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",Bb.populationProps=new Fh(M.a.xNb.toString(),!1),Bb));let Ub;this.addCommandToMaps((Ub=new Xa.a("LineSpacingButton1_00",M.a.Cza.toString()),Ub.queryCommandId=M.a.Iza.toString(),Ub.menuItemId="1.00",Ub));let Xb;this.addCommandToMaps((Xb=new Xa.a("LineSpacingButton1_50",M.a.Cza.toString()),
Xb.queryCommandId=M.a.Iza.toString(),Xb.menuItemId="1.50",Xb));let tc;this.addCommandToMaps((tc=new Xa.a("LineSpacingButton2_00",M.a.Cza.toString()),tc.queryCommandId=M.a.Iza.toString(),tc.menuItemId="2.00",tc));let lc;this.addCommandToMaps((lc=new Xa.a("LineSpacingButton2_50",M.a.Cza.toString()),lc.queryCommandId=M.a.Iza.toString(),lc.menuItemId="2.50",lc));let Ec;this.addCommandToMaps((Ec=new Xa.a("LineSpacingButton3_00",M.a.Cza.toString()),Ec.queryCommandId=M.a.Iza.toString(),Ec.menuItemId="3.00",
Ec));this.addCommandToMaps(new Xa.a("LineSpacingOptionsForParagraphDialog",M.a.CFb.toString()));this.addCommandToMaps(new Xa.a("MarkActivitiesAsRead",M.a.EQe.toString()));let hd;this.addCommandToMaps((hd=new Xa.a("ModeSwitcherEditing",M.a.Mzc.toString()),hd.queryCommandId=M.a.s0e.toString(),hd.legacyControlId="ModeSwitcherModeEditing",hd));let yd;this.addCommandToMaps((yd=new Xa.a("ModeSwitcherViewing",M.a.Nzc.toString()),yd.queryCommandId=M.a.t0e.toString(),yd.legacyControlId="ModeSwitcherModeViewing",
yd));this.addCommandToMaps(new Xa.a("ModeSwitcher",M.a.Ihh.toString()));this.addCommandToMaps(new Xa.a("MoreSymbols",G.a.g5c.toString()));let Pd;this.addCommandToMaps((Pd=new Xa.a("MoreVariantsAnchor",M.a.AEa.toString()),Pd.queryCommandId=M.a.Xuc.toString(),Pd.populationProps=new Fh(M.a.$rd.toString(),!1),Pd.previewControlIds=["Variant1","Variant2","Variant3","Variant4"],Pd));this.addCommandToMaps(new Xa.a("MoveSectionDown",M.a.Umd.toString()));this.addCommandToMaps(new Xa.a("MoveSectionUp",M.a.Vmd.toString()));
let pe;this.addCommandToMaps((pe=new Xa.a("NewComment",M.a.cDb.toString()),pe.queryCommandId=M.a.Jnl.toString(),pe));this.addCommandToMaps(new Xa.a("NewSlide",M.a.ypa.toString()));this.addCommandToMaps(new Xa.a("NewSlideWithoutDialog",M.a.m7.toString()));let Se;this.addCommandToMaps((Se=new Xa.a("NextComment",M.a.tSe.toString()),Se.queryCommandId=M.a.Onl.toString(),Se));this.addCommandToMaps(new Xa.a("NoHighlight",G.a.uea.toString()));let vf;this.addCommandToMaps((vf=new Xa.a("Notes",M.a.ONa.toString()),
vf.queryCommandId=M.a.jtd.toString(),vf));let ug;this.addCommandToMaps((ug=new Xa.a("NumberingLibrary",M.a.nMa.toString()),ug.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",ug.queryCommandId=M.a.uOb.toString(),ug.populationProps=new Fh(M.a.otc.toString(),!1),ug));this.addCommandToMaps(new Xa.a("OpenHyperlink",G.a.PLa.toString()));this.addCommandToMaps(new Xa.a("OpenPowerPointLanguageDialog",M.a.zqd.toString()));let Tg;this.addCommandToMaps((Tg=new Xa.a("OpenSetSlideSizeDialog",M.a.mWe.toString()),
Tg.queryCommandId=M.a.p0e.toString(),Tg));this.addCommandToMaps(new Xa.a("OpenVersionHistory",M.a.Erh.toString()));this.addCommandToMaps(new Xa.a("Outdent",M.a.ANb.toString()));this.addCommandToMaps(new Xa.a("ParagraphOptions",M.a.CFb.toString()));this.addCommandToMaps(new Xa.a("Paste",M.a.oMa.toString()));this.addCommandToMaps(new Xa.a("PasteGalleryIcon",M.a.oMa.toString()));this.addCommandToMaps(new Xa.a("PasteKeepingDestinationTheme",M.a.YLa.toString()));this.addCommandToMaps(new Xa.a("PasteKeepingSourceFormatting",
M.a.ZLa.toString()));let $f;this.addCommandToMaps(($f=new Xa.a("PasteTextOnlyGalleryIcon",M.a.zlb.toString()),$f.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",$f));this.addCommandToMaps(new Xa.a("PasteAsImage",M.a.w1a.toString()));let Ve;this.addCommandToMaps((Ve=new Xa.a("PasteSlideKeepDestinationFromClipService",M.a.Bsc.toString()),Ve.queryCommandId=M.a.a0e.toString(),Ve));let xg;this.addCommandToMaps((xg=new Xa.a("PasteSlideKeepSourceFromClipService",M.a.bNb.toString()),xg.queryCommandId=
M.a.a0e.toString(),xg));let yg;this.addCommandToMaps((yg=new Xa.a("PasteTextOnly",M.a.zlb.toString()),yg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",yg));let ng;this.addCommandToMaps((ng=new Xa.a("PasteAsPlainText",M.a.rrd.toString()),ng.queryCommandId=M.a.Wtd.toString(),ng));let Wh;this.addCommandToMaps((Wh=new Xa.a("PasteTextMergeFormatting",M.a.qrd.toString()),Wh.queryCommandId=M.a.Wtd.toString(),Wh));let Ai;this.addCommandToMaps((Ai=new Xa.a("PasteTextKeepingSourceFormatting",M.a.prd.toString()),
Ai.queryCommandId=M.a.Wtd.toString(),Ai));this.addCommandToMaps(new Xa.a("PlayFromBeginning",M.a.zSb.toString()));this.addCommandToMaps(new Xa.a("PlayFromBeginningTopBar",M.a.Msc.toString()));this.addCommandToMaps(new Xa.a("PlayFromCurrentSlide",M.a.NAa.toString()));let Wf;this.addCommandToMaps((Wf=new Xa.a("PresentLive",M.a.M1a.toString()),Wf.legacyControlId="PresentLive",Wf));let gg;this.addCommandToMaps((gg=new Xa.a("PresentLiveTopBar",M.a.Htc.toString()),gg.legacyControlId="PresentLiveTopBar",
gg));let vh;this.addCommandToMaps((vh=new Xa.a("PresentLiveSetAccessControlAnyone",M.a.N1a.toString()),vh.legacyControlId="PresentLiveSetAccessControlAnyone",vh.queryCommandId=M.a.xOb.toString(),vh));let Zj;this.addCommandToMaps((Zj=new Xa.a("PresentLiveSetAccessControlOrganization",M.a.Gtc.toString()),Zj.legacyControlId="PresentLiveSetAccessControlOrganization",Zj.queryCommandId=M.a.yOb.toString(),Zj));let qj;this.addCommandToMaps((qj=new Xa.a("PresentLiveConsumer",M.a.M1a.toString()),qj.legacyControlId=
"PresentLiveConsumer",qj));let Ok;this.addCommandToMaps((Ok=new Xa.a("PresentLiveEnterprise",M.a.M1a.toString()),Ok.legacyControlId="PresentLiveEnterprise",Ok));let Wl;this.addCommandToMaps((Wl=new Xa.a("PresentToTeams",M.a.Ilb.toString()),Wl.legacyControlId="PresentToTeams",Wl));let Rm;this.addCommandToMaps((Rm=new Xa.a("PresentToTeamsTopBar",M.a.gZe.toString()),Rm.legacyControlId="PresentToTeamsTopBar",Rm));let Pk;this.addCommandToMaps((Pk=new Xa.a("PreviousComment",M.a.nZe.toString()),Pk.queryCommandId=
M.a.$nl.toString(),Pk));this.addCommandToMaps(new Xa.a("ReadingView",M.a.zud.toString()));let Xl;this.addCommandToMaps((Xl=new Xa.a("PictureCrop",M.a.jUc.toString()),Xl.queryCommandId=M.a.b0e.toString(),Xl));this.addCommandToMaps(new Xa.a("PictureCropAnchor",M.a.L8d.toString()));let wk;this.addCommandToMaps((wk=new Xa.a("PictureCropMoreOptions",M.a.Qyc.toString()),wk.queryCommandId=M.a.GOb.toString(),wk));this.addCommandToMaps(Object.assign(new Xa.a("FormatPicture",M.a.Qyc.toString()),{queryCommandId:M.a.GOb.toString()}));
this.addCommandToMaps(new Xa.a("Redo",M.a.ptc.toString()));let Qk;this.addCommandToMaps((Qk=new Xa.a("RehearsalFeedbackSettings",M.a.GAd.toString()),Qk.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",Qk.queryCommandId=M.a.Mtd.toString(),Qk));let qk;this.addCommandToMaps((qk=new Xa.a("RehearsePresentation",M.a.gia.toString()),qk.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",qk));let Hl;this.addCommandToMaps((Hl=new Xa.a("RehearsePresentationTopBar",M.a.yvc.toString()),Hl.legacyControlId=
"PptRibbon.View.Coach.RehearseWithCoachTopBar",Hl));let Qh;this.addCommandToMaps((Qh=new Xa.a("RehearsePresentationDropDown",M.a.xvc.toString()),Qh.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",Qh));this.addCommandToMaps(new Xa.a("RemoveHyperlink",G.a.eL.toString()));this.addCommandToMaps(new Xa.a("RemoveSection",M.a.$2e.toString()));this.addCommandToMaps(new Xa.a("RenameSection",M.a.xvd.toString()));this.addCommandToMaps(new Xa.a("ShowHideThumbnailSorterView",M.a.Ryc.toString()));
this.addCommandToMaps(new Xa.a("Replace",M.a.b3.toString()));this.addCommandToMaps(new Xa.a("ResetPicture",M.a.Xvd.toString()));this.addCommandToMaps(new Xa.a("ResetPictureAndSize",M.a.vGh.toString()));this.addCommandToMaps(new Xa.a("ResetPictureSplitButton",M.a.wGh.toString()));this.addCommandToMaps(new Xa.a("RightToLeft",M.a.itc.toString()));this.addCommandToMaps(new Xa.a("RotateAnchor",M.a.KHh.toString()));this.addCommandToMaps(new Xa.a("RotateShapeAnchor",M.a.LHh.toString()));let Il;this.addCommandToMaps((Il=
new Xa.a("RotateLeft",M.a.cca.toString()),Il.commandPreviewId=M.a.kZe.toString(),Il.commandRevertId=M.a.n5e.toString(),Il));let ym;this.addCommandToMaps((ym=new Xa.a("RotateRight",M.a.z5e.toString()),ym.commandPreviewId=M.a.lZe.toString(),ym.commandRevertId=M.a.n5e.toString(),ym));this.addCommandToMaps(new Xa.a("RotateFlipVertical",M.a.Dwc.toString()));this.addCommandToMaps(new Xa.a("RotateFlipHorizontal",M.a.Cwc.toString()));this.addCommandToMaps(new Xa.a("SelectHyperlink",G.a.pxd.toString()));this.addCommandToMaps(new Xa.a("SendBackward",
M.a.sendBackward.toString()));this.addCommandToMaps(new Xa.a("SendToBack",M.a.sendToBack.toString()));this.addCommandToMaps(new Xa.a("SendToBackFlyout",M.a.MKh.toString()));this.ka.Ovb?(this.addCommandToMaps(Object.assign(new Xa.a("SetAnimationDelay",M.a.QQb.toString()),{queryCommandId:M.a.yMa.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("SetAnimationDuration",M.a.RQb.toString()),{queryCommandId:M.a.zMa.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("AnimationStart",M.a.q3b.toString()),
{queryCommandId:M.a.eOb.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("SetAnimationDelayMLR",M.a.QQb.toString()),{queryCommandId:M.a.yMa.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("SetAnimationDurationMLR",M.a.RQb.toString()),{queryCommandId:M.a.zMa.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("AnimationStartMLR",M.a.q3b.toString()),{queryCommandId:M.a.eOb.toString()})),this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsMLR",M.a.Zsd.toString()),
{populationProps:new Fh(M.a.E1a.toString(),!1)})),b=new Xa.a("AnimationPane",M.a.ERh.toString()),b.queryCommandId=M.a.Ztc.toString(),this.addCommandToMaps(b),this.addCommandToMaps(new Xa.a("MoveEarlier",M.a.Ypc.toString())),this.addCommandToMaps(new Xa.a("MoveLater",M.a.Zpc.toString()))):(this.addCommandToMaps(new Xa.a("MoveEarlier",M.a.W3e.toString())),this.addCommandToMaps(new Xa.a("MoveLater",M.a.X3e.toString())));this.ka.yNc&&this.addCommandToMaps(new Xa.a("AddAnimationInContextMenu",M.a.qJf.toString()));
let on;this.addCommandToMaps((on=new Xa.a("SetHeight",M.a.iyd.toString()),on.queryCommandId=M.a.Plb.toString(),on));let ml;this.addCommandToMaps((ml=new Xa.a("SetWidth",M.a.jyd.toString()),ml.queryCommandId=M.a.Qlb.toString(),ml));let nl;this.addCommandToMaps((nl=new Xa.a("SetSlideSize",M.a.Nxc.toString()),nl.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",nl));let Bi;this.addCommandToMaps((Bi=new Xa.a("SetSlideSize4x3",M.a.nzd.toString()),Bi.queryCommandId=M.a.Ptd.toString(),Bi));
let zg;this.addCommandToMaps((zg=new Xa.a("SetSlideSize16x9",M.a.mzd.toString()),zg.queryCommandId=M.a.Otd.toString(),zg));let ci;this.addCommandToMaps((ci=new Xa.a("SetTransitionApplyAll",M.a.aob.toString()),ci.queryCommandId=M.a.POb.toString(),ci));this.addCommandToMaps(Object.assign(new Xa.a("SetTransitionDuration",M.a.bob.toString()),{queryCommandId:M.a.Kza.toString()}));this.addCommandToMaps(new Xa.a("ShapeAlignAnchor",M.a.FOh.toString()));this.addCommandToMaps(new Xa.a("ShapeAlignLeft",M.a.Izd.toString()));
this.addCommandToMaps(new Xa.a("ShapeAlignRight",M.a.cyc.toString()));this.addCommandToMaps(new Xa.a("ShapeAlignTop",M.a.Jzd.toString()));this.addCommandToMaps(new Xa.a("ShapeAlignBottom",M.a.$xc.toString()));this.addCommandToMaps(new Xa.a("ShapeAlignCenter",M.a.ayc.toString()));this.addCommandToMaps(new Xa.a("ShapeAlignMiddle",M.a.byc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShapeAlignToSlide",M.a.XAc.toString()),{queryCommandId:M.a.DOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeAlignToSelectedObjects",
M.a.WAc.toString()),{queryCommandId:M.a.COb.toString()}));this.addCommandToMaps(new Xa.a("ShareSlide",M.a.Uzd.toString()));this.addCommandToMaps(new Xa.a("DistributeShapesVertically",M.a.wFa.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ImmersiveReader",M.a.z4c.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Xa.a("ImmersiveReaderRibbon",M.a.cpe.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(new Xa.a("DistributeShapesHorizontally",
M.a.$7b.toString()));this.addCommandToMaps(new Xa.a("ShareSlide",M.a.Uzd.toString()));this.addCommandToMaps(Object.assign(new Xa.a("Shrink",M.a.Blb.toString()),{legacyControlId:"PptRibbon.Home.Font.Shrink"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowCommentsTopBar",N.a.nDd.toString()),{legacyControlId:"ShowCommentsTopBar",queryCommandId:N.a.S0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowComments",M.a.n3.toString()),{queryCommandId:M.a.FOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowEditTriPaneView",
M.a.MNa.toString()),{queryCommandId:M.a.fOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowHideChanges",M.a.R3a.toString()),{queryCommandId:M.a.m0e.toString()}));let Oh;this.addCommandToMaps((Oh=new Xa.a("ShowHideComments",M.a.n3.toString()),Oh.legacyControlId="PptRibbon.View.ShowHide.CommentsSplitButton",Oh.queryCommandId=M.a.FOb.toString(),Oh));let Yd;this.addCommandToMaps((Yd=new Xa.a("ShowHideCommentsInReview",M.a.n3.toString()),Yd.queryCommandId=M.a.FOb.toString(),Yd));this.ka.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.GridlinesFeatureEnabled",
!1)&&this.addCommandToMaps(Object.assign(new Xa.a("ShowHideGridlines",M.a.CAd.toString()),{queryCommandId:M.a.ctd.toString()}));let tf;this.addCommandToMaps((tf=new Xa.a("ShowHideRuler",M.a.HAd.toString()),tf.legacyControlId="btnShowHideRuler",tf.queryCommandId=M.a.utd.toString(),tf));this.addCommandToMaps(new Xa.a("ShowRevisionTrackingWithUrlOverrides",M.a.TAd.toString()));let Of;this.addCommandToMaps((Of=new Xa.a("ShowMarkup",M.a.dSb.toString()),Of.queryCommandId=M.a.Ltd.toString(),Of));let De;
this.addCommandToMaps((De=new Xa.a("ShowTranslatePane",M.a.X1l.toString()),De.legacyControlId="PptRibbon.Review.Show.Translate",De));let nh;this.addCommandToMaps((nh=new Xa.a("ShowSmartLookupPane",N.a.Z5c.toString()),nh.legacyControlId="PptRibbon.Review.Show.SmartLookup",nh));this.addCommandToMaps(new Xa.a("SmartLookupContextMenu",N.a.Y5c.toString()));this.addCommandToMaps(new Xa.a("RecommendationContextMenuFlyout",M.a.HAh.toString()));this.addCommandToMaps(new Xa.a("ActionRecommendation1",M.a.UIf.toString()));
this.addCommandToMaps(new Xa.a("ActionRecommendation2",M.a.VIf.toString()));this.addCommandToMaps(new Xa.a("ActionRecommendation3",M.a.WIf.toString()));this.addCommandToMaps(new Xa.a("ActionRecommendation4",M.a.XIf.toString()));this.addCommandToMaps(new Xa.a("ActionRecommendation5",M.a.YIf.toString()));this.addCommandToMaps(new Xa.a("ActionRecommendation6",M.a.ZIf.toString()));this.addCommandToMaps(new Xa.a("ActionAIFromTellMe",M.a.uxb.toString()));this.addCommandToMaps(new Xa.a("SmartLookupSynonyms",
N.a.a6c.toString()));let Zi;this.addCommandToMaps((Zi=new Xa.a("ShowSorterView",M.a.Dia.toString()),Zi.queryCommandId=M.a.HOb.toString(),Zi));let rj;this.addCommandToMaps((rj=new Xa.a("ShowVersionHistoryDialog",N.a.Xyc.toString()),rj.legacyControlId="PptJewel.Info.VersionHistory",rj));let Mo;this.addCommandToMaps((Mo=new Xa.a("SpokenLanguage",M.a.ulb.toString()),Mo.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",Mo.queryCommandId=M.a.ulb.toString(),Mo.populationProps=
new Fh(M.a.ulb.toString(),!0),Mo));this.addCommandToMaps(new Xa.a("StandardFontColorPicker",M.a.Aza.toString()));let Rk;this.addCommandToMaps((Rk=new Xa.a("Strikethrough",M.a.ENb.toString()),Rk.legacyControlId="PptRibbon.Home.Font.Strikethrough",Rk.queryCommandId=M.a.vOb.toString(),Rk));let No;this.addCommandToMaps((No=new Xa.a("SubtitleLanguage",M.a.vlb.toString()),No.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",No.queryCommandId=M.a.vlb.toString(),No.populationProps=
new Fh(M.a.vlb.toString(),!0),No));let Nu;this.addCommandToMaps((Nu=new Xa.a("SubtitleSettingsAnchor",M.a.Qtd.toString()),Nu.legacyControlId="PptRibbon.View.Subtitles.SubtitleSettings",Nu));let xt;this.addCommandToMaps((xt=new Xa.a("Subscript",M.a.FNb.toString()),xt.legacyControlId="PptRibbon.Home.Font.Subscript",xt.queryCommandId=M.a.c2a.toString(),xt));this.addCommandToMaps(new Xa.a("SummarizeSlides",M.a.n4a.toString()));this.addCommandToMaps(new Xa.a("SummarizeSlidesFromTellMe",M.a.n4a.toString()));
this.addCommandToMaps(new Xa.a("SummarizeDeck",M.a.Dcf.toString()));this.addCommandToMaps(new Xa.a("SummarizeDeckFromTellMe",M.a.Dcf.toString()));let yt;this.addCommandToMaps((yt=new Xa.a("Superscript",M.a.GNb.toString()),yt.legacyControlId="PptRibbon.Home.Font.Superscript",yt.queryCommandId=M.a.d2a.toString(),yt));this.addCommandToMaps(new Xa.a("TabSwitch",N.a.xHh.toString()));this.addCommandToMaps(new Xa.a("TextAlignmentAnchor",M.a.Lab.toString()));let Ou;this.addCommandToMaps((Ou=new Xa.a("TextAlignmentCenterJustify",
M.a.zza.toString()),Ou.queryCommandId=M.a.AMa.toString(),Ou));let zt;this.addCommandToMaps((zt=new Xa.a("TextAlignmentFullJustify",M.a.I1a.toString()),zt.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",zt.queryCommandId=M.a.Wlb.toString(),zt));let Pu;this.addCommandToMaps((Pu=new Xa.a("TextAlignmentLeftJustify",M.a.Bza.toString()),Pu.queryCommandId=M.a.BMa.toString(),Pu));let Qu;this.addCommandToMaps((Qu=new Xa.a("TextAlignmentRightJustify",M.a.Dza.toString()),Qu.queryCommandId=M.a.DMa.toString(),
Qu));let Ru;this.addCommandToMaps((Ru=new Xa.a("TextAnchoringBottom",M.a.Q2.toString()),Ru.queryCommandId=M.a.EMa.toString(),Ru));let VC;this.addCommandToMaps((VC=new Xa.a("TextAnchoringMiddle",M.a.R2.toString()),VC.queryCommandId=M.a.FMa.toString(),VC));let WC;this.addCommandToMaps((WC=new Xa.a("TextAnchoringTop",M.a.S2.toString()),WC.queryCommandId=M.a.GMa.toString(),WC));this.addCommandToMaps(new Xa.a("ThemeFontColorPicker",M.a.Aza.toString()));this.addCommandToMaps(new Xa.a("ThemeFontColorPickerMCU",
M.a.Aza.toString()));if(this.ka.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.DarkModeEnabled",!1)){let XC;this.addCommandToMaps((XC=new Xa.a("ToggleDarkMode",M.a.oDd.toString()),XC.queryCommandId=M.a.Vsd.toString(),XC))}let IA;this.addCommandToMaps((IA=new Xa.a("TopOverlaid",M.a.DTb.toString()),IA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",IA.queryCommandId=M.a.emb.toString(),IA));let YC;this.addCommandToMaps((YC=new Xa.a("Underline",M.a.HNb.toString()),YC.queryCommandId=
M.a.wOb.toString(),YC));this.addCommandToMaps(new Xa.a("Undo",M.a.vtc.toString()));let ZC;this.addCommandToMaps((ZC=new Xa.a("UsePresenterView",M.a.tif.toString()),ZC.queryCommandId=M.a.QOb.toString(),ZC));this.addCommandToMaps(new Xa.a("Zoom",M.a.oWe.toString()));let JA;this.addCommandToMaps((JA=new Xa.a("ToggleUseSubtitles",M.a.BOa.toString()),JA.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",JA.queryCommandId=M.a.g2a.toString(),JA));let $C;this.addCommandToMaps(($C=new Xa.a("ToggleShapeAlignToSlide",
M.a.XAc.toString()),$C.queryCommandId=M.a.DOb.toString(),$C));let aD;this.addCommandToMaps((aD=new Xa.a("ToggleShapeAlignToSelectedObjects",M.a.WAc.toString()),aD.queryCommandId=M.a.COb.toString(),aD));let KA;this.addCommandToMaps((KA=new Xa.a("ToggleSubtitlesBottomOverlay",M.a.CTb.toString()),KA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",KA.queryCommandId=M.a.dmb.toString(),KA));let LA;this.addCommandToMaps((LA=new Xa.a("ToggleSubtitlesTopOverlay",M.a.DTb.toString()),
LA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",LA.queryCommandId=M.a.emb.toString(),LA));let MA;this.addCommandToMaps((MA=new Xa.a("ToggleRehearsalVisionEnabled",M.a.zTb.toString()),MA.legacyControlId="PptRibbon.View.Coach.Menu.Vision",MA.queryCommandId=M.a.AOb.toString(),MA));let bD;this.addCommandToMaps((bD=new Xa.a("HostOpenInClient",M.a.openInClient.toString()),bD.legacyControlId="HostOpenInClient",bD));let NA;this.addCommandToMaps((NA=new Xa.a("ToggleSubtitlesBelowSlide",
M.a.BTb.toString()),NA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",NA.queryCommandId=M.a.cmb.toString(),NA));let OA;this.addCommandToMaps((OA=new Xa.a("ToggleSubtitlesAboveSlide",M.a.ATb.toString()),OA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",OA.queryCommandId=M.a.bmb.toString(),OA));let PA;this.addCommandToMaps((PA=new Xa.a("BelowSlide",M.a.BTb.toString()),PA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",PA.queryCommandId=
M.a.cmb.toString(),PA));let QA;this.addCommandToMaps((QA=new Xa.a("AboveSlide",M.a.ATb.toString()),QA.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",QA.queryCommandId=M.a.bmb.toString(),QA));let cD;this.addCommandToMaps((cD=new Xa.a("PreviousVersions",N.a.Lyc.toString()),cD.legacyControlId="PptJewel.Info.FileVersion",cD));this.addCommandToMaps(new Xa.a("Present",M.a.ysd.toString()));this.addCommandToMaps(new Xa.a("PresentDropDown",M.a.Ftc.toString()))}jti(){this.addCommandToMaps(Object.assign(new Xa.a("CenterJustify",
M.a.zza.toString()),{queryCommandId:M.a.AMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("FullJustify",M.a.I1a.toString()),{queryCommandId:M.a.Wlb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("LeftJustify",M.a.Bza.toString()),{queryCommandId:M.a.BMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("RightJustify",M.a.Dza.toString()),{queryCommandId:M.a.DMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TextAnchoringAnchor",M.a.msd.toString()),{queryCommandId:M.a.msd.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("AlignBottom",M.a.Q2.toString()),{queryCommandId:M.a.EMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("AlignMiddle",M.a.R2.toString()),{queryCommandId:M.a.FMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTop",M.a.S2.toString()),{queryCommandId:M.a.GMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("UseSubtitles",M.a.BOa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:M.a.g2a.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SubtitleSettings",
M.a.Qtd.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));this.addCommandToMaps(new Xa.a("NewBringForwardAnchorMLR",M.a.hwb.toString()));this.addCommandToMaps(new Xa.a("NewSendBackwardAnchorMLR",M.a.hwb.toString()));this.addCommandToMaps(new Xa.a("PowerPointGroupFlyoutAnchorMLR",M.a.uYe.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SetLockAspectRatio",M.a.xxc.toString()),{queryCommandId:M.a.muc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableHeight",
M.a.Uqa.toString()),{queryCommandId:M.a.Wuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableWidth",M.a.FNa.toString()),{queryCommandId:M.a.Vtd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableColumnWidth",M.a.ENa.toString()),{queryCommandId:M.a.IOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetTableRowHeight",M.a.D3a.toString()),{queryCommandId:M.a.JOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropWidth",M.a.jFd.toString()),
{queryCommandId:M.a.nOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropHeight",M.a.gFd.toString()),{queryCommandId:M.a.lOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropLeft",M.a.hFd.toString()),{queryCommandId:M.a.mOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("UpdatePictureCropTop",M.a.iFd.toString()),{queryCommandId:M.a.ruc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("Paste_MLR",M.a.oMa.toString()),{queryCommandId:M.a.qtd.toString()}));
this.addCommandToMaps(new Xa.a("PasteKeepingDestinationThemeMLR",M.a.YLa.toString()));this.addCommandToMaps(new Xa.a("PasteKeepingSourceFormattingMLR",M.a.ZLa.toString()));this.addCommandToMaps(new Xa.a("PasteAsImageMLR",M.a.w1a.toString()));this.addCommandToMaps(Object.assign(new Xa.a("TableCellBottomAnchoringMLR",M.a.Q2.toString()),{queryCommandId:M.a.EMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellCenterJustifyMLR",M.a.zza.toString()),{queryCommandId:M.a.AMa.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TableCellLeftJustifyMLR",M.a.Bza.toString()),{queryCommandId:M.a.BMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellMiddleAnchoringMLR",M.a.R2.toString()),{queryCommandId:M.a.FMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellRightJustifyMLR",M.a.Dza.toString()),{queryCommandId:M.a.DMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellTopAnchoringMLR",M.a.S2.toString()),{queryCommandId:M.a.GMa.toString()}));
this.addCommandToMaps(new Xa.a("ParagraphOptionsMLR",M.a.CFb.toString()));this.addCommandToMaps(new Xa.a("Delete_MLR",M.a.deleteObject.toString()));this.addCommandToMaps(new Xa.a("SmartArtStylesMLR",M.a.hM.toString()));this.addCommandToMaps(new Xa.a("PictureCropMLR",M.a.M8d.toString()))}AZd(){this.addTabToMap("FormatShape",M.a.w7f.toString());this.addTabToMap("FormatPicture",M.a.yuh.toString());this.addTabToMap("SmartArtDesign",M.a.rTh.toString());this.addTabToMap("Table",M.a.g0e.toString());this.addTabToMap("Graphics",
M.a.myh.toString());this.addTabToMap("Playback",M.a.lQf.toString());this.addTabToMap("AudioFormat",M.a.jQf.toString());this.addTabToMap("Audio",M.a.mQf.toString());this.addTabToMap("AccessibleAuthoring",M.a.gNc.toString());this.addTabToMap("LiveFeed",M.a.bJg.toString())}rti(){this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadACopyAsOdp",M.a.m8b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadACopyAsPdf",
M.a.n8b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadACopy",M.a.downloadACopy.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelDownloadAsImages",M.a.o8b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelNew",N.a.BFb.toString()),{legacyControlId:"PptJewel.New"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptJewelOpen",N.a.BFb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Xa.a("New",N.a.BFb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Xa.a("Open",N.a.BFb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintFullSlide",M.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintHandouts",
M.a.pZe.toString()),{legacyControlId:"PptJewel.Print.PrintHandouts"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintNotes",M.a.rZe.toString()),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPrintToPdf",M.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelRename",N.a.maf.toString()),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelSaveACopy",
M.a.qtc.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelSaveAsToHost",M.a.AYe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelSaveToSharePoint",M.a.BYe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelTrustCenter",N.a.lSb.toString()),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelVersionHistory",
N.a.Xyc.toString()),{legacyControlId:"PptJewel.Info.VersionHistory"}));this.addCommandToMaps(Object.assign(new Xa.a("PptJewelPreviousVersions",N.a.Lyc.toString()),{legacyControlId:"PptJewel.Info.FileVersion"}))}mti(){this.addCommandToMaps(Object.assign(new Xa.a("ApplyShapeStyleAnchor",M.a.B0d.toString()),{populationProps:new Fh(M.a.hYe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyShapeStylePreviewGallery",M.a.cwb.toString()),{queryCommandId:M.a.Ftd.toString(),populationProps:new Fh(M.a.hYe.toString(),
!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyGraphicsStyleAnchor",M.a.r0d.toString()),{populationProps:new Fh(M.a.eYe.toString(),!1)}));this.addCommandToMaps(new Xa.a("FontRecentColors",M.a.vNb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("GraphicsStylePreviewGallery",M.a.F3b.toString()),{queryCommandId:M.a.btd.toString(),populationProps:new Fh(M.a.eYe.toString(),
!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));this.addCommandToMaps(Object.assign(new Xa.a("GraphicsFill",M.a.Zvb.toString()),{populationProps:new Fh(M.a.gYe.toString(),!1)}));this.addCommandToMaps(new Xa.a("GraphicNoFill",M.a.P2e.toString()));this.addCommandToMaps(new Xa.a("GraphicNoOutline",M.a.Q2e.toString()));this.addCommandToMaps(Object.assign(new Xa.a("GraphicsOutline",
M.a.$vb.toString()),{populationProps:new Fh(M.a.ctc.toString(),!1)}));this.addCommandToMaps(new Xa.a("MoreFillColors",M.a.vRe.toString()));this.addCommandToMaps(new Xa.a("MoreFontColors",M.a.Phh.toString()));this.addCommandToMaps(new Xa.a("MoreFormatBackgroundColors",M.a.wRe.toString()));this.addCommandToMaps(new Xa.a("MoreOutlineColors",M.a.xRe.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShowHideFormatShapePane",M.a.Oyc.toString()),{queryCommandId:M.a.gOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("MoreRotationOptions",
M.a.Oyc.toString()),{queryCommandId:M.a.gOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("PictureBorders",M.a.hea.toString()),{populationProps:new Fh(M.a.ctc.toString(),!1)}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeFill",M.a.lEa.toString()),{populationProps:new Fh(M.a.gYe.toString(),!1),commandPreviewId:M.a.PNb.toString(),commandRevertId:M.a.VPb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeFillRecentColors",M.a.H3b.toString()),{commandPreviewId:M.a.PNb.toString(),
commandRevertId:M.a.VPb.toString()}));this.addCommandToMaps(new Xa.a("ShapeNoFill",M.a.hvd.toString()));this.addCommandToMaps(new Xa.a("ShapeNoOutline",M.a.ivd.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutline",M.a.hea.toString()),{populationProps:new Fh(M.a.ctc.toString(),!1)}));this.addCommandToMaps(new Xa.a("ShapeOutlineRecentColors",M.a.I3b.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineDashStyle_1",M.a.L9a.toString()),{menuItemId:"ShapeOutlineDashStyle,1"}));
this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineDashStyle_2",M.a.L9a.toString()),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineDashStyle_4",M.a.L9a.toString()),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Xa.a("ShapeOutlineDashStyleAnchor",M.a.xPc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_1",M.a.M9a.toString()),{menuItemId:"ShapeOutlineSketchStyle,1"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_2",
M.a.M9a.toString()),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_3",M.a.M9a.toString()),{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineSketchStyle_4",M.a.M9a.toString()),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Xa.a("ShapeOutlineSketchStyleAnchor",M.a.zPc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_1",M.a.Vka.toString()),
{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_2",M.a.Vka.toString()),{menuItemId:"ShapeOutlineEndStyle,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_3",M.a.Vka.toString()),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_4",M.a.Vka.toString()),{menuItemId:"ShapeOutlineEndStyle,4"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_5",M.a.Vka.toString()),
{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_6",M.a.Vka.toString()),{menuItemId:"ShapeOutlineEndStyle,6"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineEndStyle_7",M.a.Vka.toString()),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Xa.a("ShapeOutlineEndStyleAnchor",M.a.yPc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_1",M.a.LSa.toString()),{menuItemId:"ShapeOutlineWidth,1"}));
this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_2",M.a.LSa.toString()),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_3",M.a.LSa.toString()),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Xa.a("ShapeOutlineWidth_4",M.a.LSa.toString()),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Xa.a("ShapeOutlineWidthAnchor",M.a.APc.toString()));this.addCommandToMaps(new Xa.a("StandardGraphicFillColorPicker",
M.a.Zvb.toString()));this.addCommandToMaps(new Xa.a("StandardGraphicOutlineColorPicker",M.a.$vb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("StandardShapeFillColorPicker",M.a.lEa.toString()),{commandPreviewId:M.a.PNb.toString(),commandRevertId:M.a.VPb.toString()}));this.addCommandToMaps(new Xa.a("StandardShapeOutlineColorPicker",M.a.hea.toString()));this.addCommandToMaps(new Xa.a("ThemeGraphicFillColorPicker",M.a.Zvb.toString()));this.addCommandToMaps(new Xa.a("ThemeGraphicFillColorPickerMCU",
M.a.Zvb.toString()));this.addCommandToMaps(new Xa.a("ThemeGraphicOutlineColorPicker",M.a.$vb.toString()));this.addCommandToMaps(new Xa.a("ThemeGraphicOutlineColorPickerMCU",M.a.$vb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ThemeShapeFillColorPickerMCU",M.a.lEa.toString()),{commandPreviewId:M.a.PNb.toString(),commandRevertId:M.a.VPb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemeShapeFillColorPicker",M.a.lEa.toString()),{commandPreviewId:M.a.PNb.toString(),commandRevertId:M.a.VPb.toString()}));
this.addCommandToMaps(new Xa.a("ThemeShapeOutlineColorPicker",M.a.hea.toString()));this.addCommandToMaps(new Xa.a("ThemeShapeOutlineColorPickerMCU",M.a.hea.toString()));let a;this.addCommandToMaps((a=new Xa.a("LiveFeedBorder",M.a.hea.toString()),a.populationProps=new Fh(M.a.ctc.toString(),!1),a))}sti(){this.addCommandToMaps(Object.assign(new Xa.a("Themes",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString(),previewControlIds:"ThemesOfficeTheme2023 ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));
this.addCommandToMaps(Object.assign(new Xa.a("ThemesOfficeTheme2023",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesOfficeTheme",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesAtlas",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesMadison",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesIon",
M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesOrganic",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesFrame",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesIonBoardroom",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesMesh",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("ThemesRetrospect",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesSlice",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesSavon",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesBanded",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesQuotable",
M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesWoodType",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesBasis",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesIntegral",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesWisp",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("ThemesDividend",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesCelestial",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesParallax",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesMetropolitan",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesFacet",
M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ThemesViewTheme",M.a.ow.toString()),{queryCommandId:M.a.Fz.toString()}))}uti(){this.addCommandToMaps(Object.assign(new Xa.a("Transitions",M.a.Jk.toString()),{queryCommandId:M.a.wk.toString(),previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionExisting",
M.a.Vqa.toString()),{legacyControlId:"TransitionExisting",queryCommandId:M.a.lqa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionExistingInMenu",M.a.AAa.toString()),{legacyControlId:"TransitionExistingInMenu",queryCommandId:M.a.Lza.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionNone",M.a.Jk.toString()),{legacyControlId:"TransitionNone",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionMorph",M.a.Jk.toString()),
{legacyControlId:"TransitionMorph",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCut",M.a.Jk.toString()),{legacyControlId:"TransitionCut",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFade",M.a.Jk.toString()),{legacyControlId:"TransitionFade",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPush",M.a.Jk.toString()),{legacyControlId:"TransitionPush",queryCommandId:M.a.wk.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionWipe",M.a.Jk.toString()),{legacyControlId:"TransitionWipe",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionSplit",M.a.Jk.toString()),{legacyControlId:"TransitionSplit",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRandomBars",M.a.Jk.toString()),{legacyControlId:"TransitionRandomBars",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionShape",
M.a.Jk.toString()),{legacyControlId:"TransitionShape",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionComb",M.a.Jk.toString()),{legacyControlId:"TransitionComb",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionBlinds",M.a.Jk.toString()),{legacyControlId:"TransitionBlinds",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionBox",M.a.Jk.toString()),{legacyControlId:"TransitionBox",
queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCover",M.a.Jk.toString()),{legacyControlId:"TransitionCover",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCube",M.a.Jk.toString()),{legacyControlId:"TransitionCube",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCurtains",M.a.Jk.toString()),{legacyControlId:"TransitionCurtains",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionDissolve",
M.a.Jk.toString()),{legacyControlId:"TransitionDissolve",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionOrbit",M.a.Jk.toString()),{legacyControlId:"TransitionOrbit",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPageCurl",M.a.Jk.toString()),{legacyControlId:"TransitionPageCurl",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPeelOff",M.a.Jk.toString()),{legacyControlId:"TransitionPeelOff",
queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRandom",M.a.Jk.toString()),{legacyControlId:"TransitionRandom",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionReveal",M.a.Jk.toString()),{legacyControlId:"TransitionReveal",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRotate",M.a.Jk.toString()),{legacyControlId:"TransitionRotate",queryCommandId:M.a.wk.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionUncover",M.a.Jk.toString()),{legacyControlId:"TransitionUncover",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWheel",M.a.Jk.toString()),{legacyControlId:"TransitionWheel",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionRipple",M.a.Jk.toString()),{legacyControlId:"TransitionRipple",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionBox",
M.a.Jk.toString()),{legacyControlId:"TransitionBox",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCube",M.a.Jk.toString()),{legacyControlId:"TransitionCube",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionSwitch",M.a.Jk.toString()),{legacyControlId:"TransitionSwitch",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFallOver",M.a.Jk.toString()),{legacyControlId:"TransitionFallOver",
queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionDrape",M.a.Jk.toString()),{legacyControlId:"TransitionDrape",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFlip",M.a.Jk.toString()),{legacyControlId:"TransitionFlip",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWind",M.a.Jk.toString()),{legacyControlId:"TransitionWind",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPrestige",
M.a.Jk.toString()),{legacyControlId:"TransitionPrestige",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFracture",M.a.Jk.toString()),{legacyControlId:"TransitionFracture",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionCrush",M.a.Jk.toString()),{legacyControlId:"TransitionCrush",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionAirplane",M.a.Jk.toString()),{legacyControlId:"TransitionAirplane",
queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionOrigami",M.a.Jk.toString()),{legacyControlId:"TransitionOrigami",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionChecker",M.a.Jk.toString()),{legacyControlId:"TransitionChecker",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionVortex",M.a.Jk.toString()),{legacyControlId:"TransitionVortex",queryCommandId:M.a.wk.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TransitionGlitter",M.a.Jk.toString()),{legacyControlId:"TransitionGlitter",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionPan",M.a.Jk.toString()),{legacyControlId:"TransitionPan",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionGalleryIcon",M.a.Jk.toString()),{legacyControlId:"TransitionGalleryIcon",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionConveyor",
M.a.Jk.toString()),{legacyControlId:"TransitionConveyor",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionZoom",M.a.Jk.toString()),{legacyControlId:"TransitionZoom",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionFlyThrough",M.a.Jk.toString()),{legacyControlId:"TransitionFlyThrough",queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionWindow",M.a.Jk.toString()),{legacyControlId:"TransitionWindow",
queryCommandId:M.a.wk.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TransitionDoors",M.a.Jk.toString()),{legacyControlId:"TransitionDoors",queryCommandId:M.a.wk.toString()}))}bti(){this.addCommandToMaps(Object.assign(new Xa.a("Animations",M.a.Tx.toString()),{queryCommandId:M.a.jqa.toString(),previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationExisting",M.a.SQb.toString()),
{queryCommandId:M.a.jqa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationExistingInMenu",M.a.j3a.toString()),{queryCommandId:M.a.jqa.toString()}));for(const a of this.ZFk)this.addCommandToMaps(Object.assign(new Xa.a(a,M.a.Tx.toString()),{queryCommandId:M.a.jqa.toString()}))}ati(){this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptions",M.a.Zsd.toString()),{populationProps:new Fh(M.a.E1a.toString(),!1)}));for(const a of this.VFk)this.addCommandToMaps(Object.assign(new Xa.a(a,
M.a.i3a.toString()),{queryCommandId:M.a.X1a.toString(),menuItemId:a.slice(this.WFk)}));for(const a of this.XFk)this.addCommandToMaps(Object.assign(new Xa.a(a,M.a.h3a.toString()),{queryCommandId:M.a.W1a.toString(),menuItemId:a.slice(this.YFk)}));this.addCommandToMaps(new Xa.a("AnimationEffectOptionsThemeColorPickerMCU",M.a.rAa.toString()));this.addCommandToMaps(new Xa.a("AnimationEffectOptionsThemeColorPicker",M.a.rAa.toString()));this.addCommandToMaps(new Xa.a("AnimationEffectOptionsStandardColorPicker",
M.a.rAa.toString()));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceAsOneObject",M.a.oyd.toString()),{queryCommandId:M.a.kqa.toString(),menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceAllAtOnce",M.a.nyd.toString()),{queryCommandId:M.a.kqa.toString(),menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceByParagraph",M.a.pyd.toString()),{queryCommandId:M.a.kqa.toString(),
menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Xa.a("AnimationEffectOptionsSequenceOneByOne",M.a.qyd.toString()),{queryCommandId:M.a.kqa.toString(),menuItemId:"OneByOne"}))}tti(){this.addCommandToMaps(Object.assign(new Xa.a("TransitionEffectOptions",M.a.fmb.toString()),{populationProps:new Fh(M.a.mNb.toString(),!1)}));for(const a of this.YTk)this.addCommandToMaps(Object.assign(new Xa.a(a,M.a.Txc.toString()),{queryCommandId:M.a.Xtd.toString(),menuItemId:a.slice(this.ZTk)}))}lti(){this.addCommandToMaps(new Xa.a("PictureStyles",
M.a.Nta.toString()));for(const a of this.uOk){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Xa.a(a,M.a.Nta.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:b}))}}oti(){this.addCommandToMaps(new Xa.a("ChangeSmartArtLayoutAnchor",N.a.uUa.toString()));for(const a of this.rch){const b=a.split("__");this.addCommandToMaps(Object.assign(new Xa.a("Change"+a,M.a.k5b.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Xa.a("SmartArtEditText",
M.a.L7f.toString()),{queryCommandId:M.a.Xsd.toString()}));this.addCommandToMaps(new Xa.a("SmartArtDemote",M.a.rtc.toString()));this.addCommandToMaps(new Xa.a("SmartArtPromote",M.a.DNb.toString()));this.addCommandToMaps(new Xa.a("SmartArtResetGraphic",M.a.$za.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtReverse",M.a.l5e.toString()),{queryCommandId:M.a.ttd.toString()}));this.addCommandToMaps(new Xa.a("SmartArtStyles",M.a.hM.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple1__simple",
M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple2__simple",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple3__simple",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple4__simple",M.a.hM.toString()),
{queryCommandId:M.a.zc.toString(),menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__simple5__simple",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d1__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d2__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d2,3D"}));
this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d3__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d4__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d5__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d6__3D",
M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d7__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d8__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Xa.a("SmartArtStyle__3d9__3D",M.a.hM.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:"3d9,3D"}))}iti(){this.addCommandToMaps(new Xa.a("InsertSmartArtAnchor",
M.a.nte.toString()));for(const a of this.rch){const b=a.split("__");this.addCommandToMaps(Object.assign(new Xa.a(a,M.a.mHa.toString()),{queryCommandId:M.a.zc.toString(),menuItemId:b[1]+","+b[2]}))}}kti(){this.addCommandToMaps(new Xa.a("PictureCropToShapeAnchor",M.a.LXe.toString()));for(const a of this.tOk)this.addCommandToMaps(Object.assign(new Xa.a(a,M.a.wuh.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(new Xa.a("LiveFeedShape",M.a.LXe.toString()))}nti(){if(this.ka.getBooleanAppSetting("ChangeShapeGeometryEnabled"))for(const a of this.DRk)this.addCommandToMaps(Object.assign(new Xa.a(a,
M.a.IOh.toString()),{queryCommandId:M.a.zc.toString()}))}hti(){this.addCommandToMaps(new Xa.a("InsertShapesAll",M.a.uyg.toString()));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStraightConnector",M.a.x5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStraightConnectorArrow",M.a.y5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStraightConnectorTwoArrow",M.a.z5c.toString()),
{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeElbowConnector",M.a.v5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeElbowArrowConnector",M.a.u5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeElbowDoubleArrowConnector",M.a.w5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCurvedConnector",
M.a.s5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCurvedArrowConnector",M.a.r5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCurvedDoubleArrowConnector",M.a.t5c.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRectangle",M.a.vse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundedRectangle",
M.a.Fse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipSingleCornerRectangle",M.a.Nse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipSameSideCornerRectangle",M.a.Mse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipDiagonalCornerRectangle",M.a.Kse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSnipRoundSingleCornerRectangle",
M.a.Lse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundSingleCornerRectangle",M.a.Ese.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundSameSideCornerRectangle",M.a.Dse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRoundDiagonalCornerRectangle",M.a.Cse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTextBox",
M.a.oXa.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeEllipse",M.a.kre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTriangle",M.a.fte.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightTriangle",M.a.Bse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeParallelogram",
M.a.kse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTrapezoid",M.a.ete.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDiamond",M.a.Zqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSPentagon",M.a.Hse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHexagon",M.a.tre.toString()),
{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHeptagon",M.a.sre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeOctagon",M.a.gse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDecagon",M.a.Vqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDodecagon",M.a.cre.toString()),{queryCommandId:M.a.zc.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapePie",M.a.mse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeChord",M.a.Gqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeTeardrop",M.a.cte.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeFrame",M.a.pre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHalfFrame",
M.a.qre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLShape",M.a.wre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDiagonalStripe",M.a.Yqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCross",M.a.Mqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapePlaque",M.a.nse.toString()),
{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCan",M.a.Dqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCube",M.a.Nqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBevel",M.a.Bqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDonut",M.a.dre.toString()),{queryCommandId:M.a.zc.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeNoSymbol",M.a.ese.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBlockArc",M.a.Cqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeFoldedCorner",M.a.ore.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSmileyFace",M.a.Jse.toString()),{queryCommandId:M.a.zc.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeHeart",M.a.rre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLightningBolt",M.a.Fre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeSun",M.a.bte.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeMoon",M.a.cse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeCloud",
M.a.Iqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeArc",M.a.yqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDoubleBracket",M.a.fre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDoubleBrace",M.a.ere.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftBracket",
M.a.Are.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightBracket",M.a.Ase.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftBrace",M.a.zre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightBrace",M.a.zse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeRightArrow",
M.a.xse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftArrow",M.a.xre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUpArrow",M.a.hte.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeDownArrow",M.a.hre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftRightArrow",
M.a.Bre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUpDownArrow",M.a.jte.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeQuadArrow",M.a.sse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftRightUpArrow",M.a.Dre.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBentArrow",
M.a.zqe.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUTurnArrow",M.a.gte.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeLeftUpArrow",M.a.Ere.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeBentUpArrow",M.a.Aqe.toString()),{queryCommandId:M.a.zc.toString()}));let a;this.addCommandToMaps((a=new Xa.a("InsertShapeCurvedRightArrow",
M.a.Rqe.toString()),a.queryCommandId=M.a.zc.toString(),a));let b;this.addCommandToMaps((b=new Xa.a("InsertShapeCurvedLeftArrow",M.a.Qqe.toString()),b.queryCommandId=M.a.zc.toString(),b));let c;this.addCommandToMaps((c=new Xa.a("InsertShapeCurvedUpArrow",M.a.Sqe.toString()),c.queryCommandId=M.a.zc.toString(),c));let f;this.addCommandToMaps((f=new Xa.a("InsertShapeCurvedDownArrow",M.a.Oqe.toString()),f.queryCommandId=M.a.zc.toString(),f));let l;this.addCommandToMaps((l=new Xa.a("InsertShapeStripedRightArrow",
M.a.$se.toString()),l.queryCommandId=M.a.zc.toString(),l));let u;this.addCommandToMaps((u=new Xa.a("InsertShapeNotchedRightArrow",M.a.fse.toString()),u.queryCommandId=M.a.zc.toString(),u));let I;this.addCommandToMaps((I=new Xa.a("InsertShapePentagon",M.a.lse.toString()),I.queryCommandId=M.a.zc.toString(),I));let T;this.addCommandToMaps((T=new Xa.a("InsertShapeChevron",M.a.Fqe.toString()),T.queryCommandId=M.a.zc.toString(),T));let ja;this.addCommandToMaps((ja=new Xa.a("InsertShapeRightArrowCallout",
M.a.yse.toString()),ja.queryCommandId=M.a.zc.toString(),ja));let ua;this.addCommandToMaps((ua=new Xa.a("InsertShapeDownArrowCallout",M.a.ire.toString()),ua.queryCommandId=M.a.zc.toString(),ua));let Ra;this.addCommandToMaps((Ra=new Xa.a("InsertShapeLeftArrowCallout",M.a.yre.toString()),Ra.queryCommandId=M.a.zc.toString(),Ra));let eb;this.addCommandToMaps((eb=new Xa.a("InsertShapeUpArrowCallout",M.a.ite.toString()),eb.queryCommandId=M.a.zc.toString(),eb));let Bb;this.addCommandToMaps((Bb=new Xa.a("InsertShapeLeftRightArrowCallout",
M.a.Cre.toString()),Bb.queryCommandId=M.a.zc.toString(),Bb));let Ub;this.addCommandToMaps((Ub=new Xa.a("InsertShapeQuadArrowCallout",M.a.tse.toString()),Ub.queryCommandId=M.a.zc.toString(),Ub));let Xb;this.addCommandToMaps((Xb=new Xa.a("InsertShapeCircularArrow",M.a.Hqe.toString()),Xb.queryCommandId=M.a.zc.toString(),Xb));let tc;this.addCommandToMaps((tc=new Xa.a("InsertShapeMathPlus",M.a.ase.toString()),tc.queryCommandId=M.a.zc.toString(),tc));let lc;this.addCommandToMaps((lc=new Xa.a("InsertShapeMathMinus",
M.a.Yre.toString()),lc.queryCommandId=M.a.zc.toString(),lc));let Ec;this.addCommandToMaps((Ec=new Xa.a("InsertShapeMathMultiply",M.a.Zre.toString()),Ec.queryCommandId=M.a.zc.toString(),Ec));let hd;this.addCommandToMaps((hd=new Xa.a("InsertShapeMathDivide",M.a.Wre.toString()),hd.queryCommandId=M.a.zc.toString(),hd));let yd;this.addCommandToMaps((yd=new Xa.a("InsertShapeMathEqual",M.a.Xre.toString()),yd.queryCommandId=M.a.zc.toString(),yd));let Pd;this.addCommandToMaps((Pd=new Xa.a("InsertShapeMathNotEqual",
M.a.$re.toString()),Pd.queryCommandId=M.a.zc.toString(),Pd));let pe;this.addCommandToMaps((pe=new Xa.a("InsertShapeProcess",M.a.qse.toString()),pe.queryCommandId=M.a.zc.toString(),pe));let Se;this.addCommandToMaps((Se=new Xa.a("InsertShapeAlternateProcess",M.a.xqe.toString()),Se.queryCommandId=M.a.zc.toString(),Se));let vf;this.addCommandToMaps((vf=new Xa.a("InsertShapeDecision",M.a.Wqe.toString()),vf.queryCommandId=M.a.zc.toString(),vf));let ug;this.addCommandToMaps((ug=new Xa.a("InsertShapeData",
M.a.Uqe.toString()),ug.queryCommandId=M.a.zc.toString(),ug));let Tg;this.addCommandToMaps((Tg=new Xa.a("InsertShapePredefinedProcess",M.a.ose.toString()),Tg.queryCommandId=M.a.zc.toString(),Tg));let $f;this.addCommandToMaps(($f=new Xa.a("InsertShapeInternalStorage",M.a.vre.toString()),$f.queryCommandId=M.a.zc.toString(),$f));let Ve;this.addCommandToMaps((Ve=new Xa.a("InsertShapeDocument",M.a.bre.toString()),Ve.queryCommandId=M.a.zc.toString(),Ve));let xg;this.addCommandToMaps((xg=new Xa.a("InsertShapeMultidocument",
M.a.dse.toString()),xg.queryCommandId=M.a.zc.toString(),xg));let yg;this.addCommandToMaps((yg=new Xa.a("InsertShapeTerminator",M.a.dte.toString()),yg.queryCommandId=M.a.zc.toString(),yg));let ng;this.addCommandToMaps((ng=new Xa.a("InsertShapePreparation",M.a.pse.toString()),ng.queryCommandId=M.a.zc.toString(),ng));let Wh;this.addCommandToMaps((Wh=new Xa.a("InsertShapeManualInput",M.a.Ure.toString()),Wh.queryCommandId=M.a.zc.toString(),Wh));let Ai;this.addCommandToMaps((Ai=new Xa.a("InsertShapeManualOperation",
M.a.Vre.toString()),Ai.queryCommandId=M.a.zc.toString(),Ai));let Wf;this.addCommandToMaps((Wf=new Xa.a("InsertShapeConnector",M.a.Lqe.toString()),Wf.queryCommandId=M.a.zc.toString(),Wf));let gg;this.addCommandToMaps((gg=new Xa.a("InsertShapeOffpageConnector",M.a.hse.toString()),gg.queryCommandId=M.a.zc.toString(),gg));let vh;this.addCommandToMaps((vh=new Xa.a("InsertShapeCard",M.a.Eqe.toString()),vh.queryCommandId=M.a.zc.toString(),vh));let Zj;this.addCommandToMaps((Zj=new Xa.a("InsertShapePunchedTape",
M.a.rse.toString()),Zj.queryCommandId=M.a.zc.toString(),Zj));let qj;this.addCommandToMaps((qj=new Xa.a("InsertShapeSummingJunction",M.a.ate.toString()),qj.queryCommandId=M.a.zc.toString(),qj));let Ok;this.addCommandToMaps((Ok=new Xa.a("InsertShapeOr",M.a.ise.toString()),Ok.queryCommandId=M.a.zc.toString(),Ok));let Wl;this.addCommandToMaps((Wl=new Xa.a("InsertShapeCollate",M.a.Kqe.toString()),Wl.queryCommandId=M.a.zc.toString(),Wl));let Rm;this.addCommandToMaps((Rm=new Xa.a("InsertShapeSort",M.a.Ose.toString()),
Rm.queryCommandId=M.a.zc.toString(),Rm));let Pk;this.addCommandToMaps((Pk=new Xa.a("InsertShapeExtract",M.a.nre.toString()),Pk.queryCommandId=M.a.zc.toString(),Pk));let Xl;this.addCommandToMaps((Xl=new Xa.a("InsertShapeMerge",M.a.bse.toString()),Xl.queryCommandId=M.a.zc.toString(),Xl));let wk;this.addCommandToMaps((wk=new Xa.a("InsertShapeStoredData",M.a.Zse.toString()),wk.queryCommandId=M.a.zc.toString(),wk));let Qk;this.addCommandToMaps((Qk=new Xa.a("InsertShapeDelay",M.a.Xqe.toString()),Qk.queryCommandId=
M.a.zc.toString(),Qk));let qk;this.addCommandToMaps((qk=new Xa.a("InsertShapeSequentialActionStorage",M.a.Ise.toString()),qk.queryCommandId=M.a.zc.toString(),qk));let Hl;this.addCommandToMaps((Hl=new Xa.a("InsertShapeMagneticDisk",M.a.Tre.toString()),Hl.queryCommandId=M.a.zc.toString(),Hl));let Qh;this.addCommandToMaps((Qh=new Xa.a("InsertShapeDirectAccessStorage",M.a.$qe.toString()),Qh.queryCommandId=M.a.zc.toString(),Qh));let Il;this.addCommandToMaps((Il=new Xa.a("InsertShapeDisplay",M.a.are.toString()),
Il.queryCommandId=M.a.zc.toString(),Il));let ym;this.addCommandToMaps((ym=new Xa.a("InsertShapeExplosion1",M.a.lre.toString()),ym.queryCommandId=M.a.zc.toString(),ym));let on;this.addCommandToMaps((on=new Xa.a("InsertShapeExplosion2",M.a.mre.toString()),on.queryCommandId=M.a.zc.toString(),on));let ml;this.addCommandToMaps((ml=new Xa.a("InsertShapeStar4",M.a.Use.toString()),ml.queryCommandId=M.a.zc.toString(),ml));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar5",M.a.Vse.toString()),
{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar6",M.a.Wse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar7",M.a.Xse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar8",M.a.Yse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar10",M.a.Pse.toString()),{queryCommandId:M.a.zc.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar12",M.a.Qse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar16",M.a.Rse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar24",M.a.Sse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeStar32",M.a.Tse.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("InsertShapeUpRibbon",
M.a.kte.toString()),{queryCommandId:M.a.zc.toString()}));let nl;this.addCommandToMaps((nl=new Xa.a("InsertShapeDownRibbon",M.a.jre.toString()),nl.queryCommandId=M.a.zc.toString(),nl));let Bi;this.addCommandToMaps((Bi=new Xa.a("InsertShapeCurvedUpRibbon",M.a.Tqe.toString()),Bi.queryCommandId=M.a.zc.toString(),Bi));let zg;this.addCommandToMaps((zg=new Xa.a("InsertShapeCurvedDownRibbon",M.a.Pqe.toString()),zg.queryCommandId=M.a.zc.toString(),zg));let ci;this.addCommandToMaps((ci=new Xa.a("InsertShapeVerticalScroll",
M.a.lte.toString()),ci.queryCommandId=M.a.zc.toString(),ci));let Oh;this.addCommandToMaps((Oh=new Xa.a("InsertShapeHorizontalScroll",M.a.ure.toString()),Oh.queryCommandId=M.a.zc.toString(),Oh));let Yd;this.addCommandToMaps((Yd=new Xa.a("InsertShapeWave",M.a.mte.toString()),Yd.queryCommandId=M.a.zc.toString(),Yd));let tf;this.addCommandToMaps((tf=new Xa.a("InsertShapeDoubleWave",M.a.gre.toString()),tf.queryCommandId=M.a.zc.toString(),tf));let Of;this.addCommandToMaps((Of=new Xa.a("InsertShapeRectangularCallout",
M.a.wse.toString()),Of.queryCommandId=M.a.zc.toString(),Of));let De;this.addCommandToMaps((De=new Xa.a("InsertShapeRoundedRectangleCallout",M.a.Gse.toString()),De.queryCommandId=M.a.zc.toString(),De));let nh;this.addCommandToMaps((nh=new Xa.a("InsertShapeOvalCallout",M.a.jse.toString()),nh.queryCommandId=M.a.zc.toString(),nh));let Zi;this.addCommandToMaps((Zi=new Xa.a("InsertShapeCloudCallout",M.a.Jqe.toString()),Zi.queryCommandId=M.a.zc.toString(),Zi));let rj;this.addCommandToMaps((rj=new Xa.a("InsertShapeLineCallout1BorderAccent",
M.a.Ire.toString()),rj.queryCommandId=M.a.zc.toString(),rj));let Mo;this.addCommandToMaps((Mo=new Xa.a("InsertShapeLineCallout2BorderAccent",M.a.Mre.toString()),Mo.queryCommandId=M.a.zc.toString(),Mo));let Rk;this.addCommandToMaps((Rk=new Xa.a("InsertShapeLineCallout3BorderAccent",M.a.Rre.toString()),Rk.queryCommandId=M.a.zc.toString(),Rk));let No;this.addCommandToMaps((No=new Xa.a("InsertShapeLineCallout1Accent",M.a.Hre.toString()),No.queryCommandId=M.a.zc.toString(),No));let Nu;this.addCommandToMaps((Nu=
new Xa.a("InsertShapeLineCallout2Accent",M.a.Lre.toString()),Nu.queryCommandId=M.a.zc.toString(),Nu));let xt;this.addCommandToMaps((xt=new Xa.a("InsertShapeLineCallout3Accent",M.a.Qre.toString()),xt.queryCommandId=M.a.zc.toString(),xt));let yt;this.addCommandToMaps((yt=new Xa.a("InsertShapeLineCallout1",M.a.Gre.toString()),yt.queryCommandId=M.a.zc.toString(),yt));let Ou;this.addCommandToMaps((Ou=new Xa.a("InsertShapeLineCallout2",M.a.Kre.toString()),Ou.queryCommandId=M.a.zc.toString(),Ou));let zt;
this.addCommandToMaps((zt=new Xa.a("InsertShapeLineCallout3",M.a.Ore.toString()),zt.queryCommandId=M.a.zc.toString(),zt));let Pu;this.addCommandToMaps((Pu=new Xa.a("InsertShapeLineCallout1NoBorder",M.a.Jre.toString()),Pu.queryCommandId=M.a.zc.toString(),Pu));let Qu;this.addCommandToMaps((Qu=new Xa.a("InsertShapeLineCallout2NoBorder",M.a.Nre.toString()),Qu.queryCommandId=M.a.zc.toString(),Qu));let Ru;this.addCommandToMaps((Ru=new Xa.a("InsertShapeLineCallout3NoBorder",M.a.Sre.toString()),Ru.queryCommandId=
M.a.zc.toString(),Ru));this.addCommandToMaps(new Xa.a("InsertShapeTextBoxBig",M.a.oXa.toString()))}eti(){this.addCommandToMaps(Object.assign(new Xa.a(ie.C$,M.a.yxd.toString()),{queryCommandId:M.a.K_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.jz,M.a.zxd.toString()),{queryCommandId:M.a.L_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.UA,M.a.Axd.toString()),{queryCommandId:M.a.M_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.TA,M.a.xxd.toString()),
{queryCommandId:M.a.J_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Zma,M.a.Cxd.toString()),{queryCommandId:M.a.pyh.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Wdb,M.a.qxd.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Mfa,M.a.rxd.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Uva,M.a.sxd.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Wma,
M.a.txd.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Xma,M.a.uxd.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.hHa,M.a.vxd.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.Vva,M.a.F6e.toString()),{queryCommandId:M.a.H_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.iY,M.a.wxd.toString()),{queryCommandId:M.a.I_e.toString()}));if(this.ka.getBooleanAppSetting("IsInkPartialEraserEnabled")){var a=
new Xa.a(ie.Ydb,M.a.Dxd.toString());a.queryCommandId=M.a.Inl.toString();this.addCommandToMaps(a);a=new Xa.a(ie.Xdb,M.a.Bxd.toString());a.queryCommandId=M.a.Hnl.toString();this.addCommandToMaps(a)}this.addCommandToMaps(Object.assign(new Xa.a(ie.iHa,M.a.mNa.toString()),{queryCommandId:M.a.N_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.jHa,M.a.G6e.toString()),{queryCommandId:M.a.zc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a(ie.kHa,M.a.H6e.toString()),{queryCommandId:M.a.zc.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a(ie.lHa,M.a.I6e.toString()),{queryCommandId:M.a.zc.toString()}))}qti(){this.addCommandToMaps(Object.assign(new Xa.a("Select",N.a.uUa.toString()),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Xa.a("SelectTable",G.a.uQb.toString()),{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Xa.a("SelectColumn",G.a.oxd.toString()),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("SelectRow",
G.a.Zwc.toString()),{legacyControlId:"btnSelectRow"}));this.addCommandToMaps(Object.assign(new Xa.a("TableDelete",N.a.uUa.toString()),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("PowerPointDeleteTableColumn",M.a.gsd.toString()),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("PowerPointDeleteTableRow",M.a.ktc.toString()),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteTable",G.a.S9.toString()),
{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertRowAbove",G.a.nXa.toString()),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertRowBelow",G.a.Yva.toString()),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertColumnLeft",G.a.Hdc.toString()),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertColumnRight",G.a.Idc.toString()),{legacyControlId:"btnInsertColumnRight"}));
this.addCommandToMaps(new Xa.a("ApplyTableStyleOptionAnchor",N.a.uUa.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionHeaderRow",G.a.oU.toString()),{legacyControlId:"buttonFirstRow",queryCommandId:G.a.Tba.toString(),menuItemId:"buttonFirstRow"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionFirstColumn",G.a.oU.toString()),{legacyControlId:"buttonFirstColumn",queryCommandId:G.a.Tba.toString(),menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionTotalRow",
G.a.oU.toString()),{legacyControlId:"buttonLastRow",queryCommandId:G.a.Tba.toString(),menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionLastColumn",G.a.oU.toString()),{legacyControlId:"buttonLastColumn",queryCommandId:G.a.Tba.toString(),menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionBandedRows",G.a.oU.toString()),{legacyControlId:"buttonBandedRow",queryCommandId:G.a.Tba.toString(),menuItemId:"buttonBandedRow"}));
this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableStyleOptionBandedColumns",G.a.oU.toString()),{legacyControlId:"buttonBandedColumn",queryCommandId:G.a.Tba.toString(),menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Xa.a("PowerPointCellShadingMenuOpen",M.a.y7.toString()),{legacyControlId:"cellShadingColor",populationProps:new Fh(M.a.Bvh.toString(),!1),menuItemId:"cellShadingColor"}));this.addCommandToMaps(new Xa.a("StandardCellShadingColorPicker",M.a.y7.toString()));
this.addCommandToMaps(new Xa.a("ThemeCellShadingColorPicker",M.a.y7.toString()));this.addCommandToMaps(new Xa.a("ThemeCellShadingColorPickerMCU",M.a.y7.toString()));this.addCommandToMaps(new Xa.a("NoCellShading",M.a.pMa.toString()));this.addCommandToMaps(new Xa.a("CellShadingMoreColors",M.a.yvh.toString()));this.addCommandToMaps(new Xa.a("CellShadingRecentColors",M.a.gtc.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SetSizeAnchor",M.a.Pyc.toString()),{queryCommandId:M.a.zOb.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("MergeTableCells",M.a.mergeTableCells.toString()),{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Xa.a("SplitTableCells",M.a.splitTableCells.toString()),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Xa.a("TableAnchor",M.a.zyg.toString()));this.addCommandToMaps(Object.assign(new Xa.a("TableStyles",G.a.y0.toString()),{legacyControlId:"fsfaMoreTableStyles",queryCommandId:G.a.KOb.toString(),populationProps:new Fh(G.a.kNb.toString(),
!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));this.addCommandToMaps(new Xa.a("TableAlignmentAnchor",M.a.ovh.toString()));this.addCommandToMaps(Object.assign(new Xa.a("TableCellBottomAnchoring",M.a.Q2.toString()),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:M.a.EMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellCenterJustify",
M.a.zza.toString()),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:M.a.AMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellLeftJustify",M.a.Bza.toString()),{legacyControlId:"btnTableCellLeftJustify",queryCommandId:M.a.BMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellMiddleAnchoring",M.a.R2.toString()),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:M.a.FMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellRightJustify",
M.a.Dza.toString()),{legacyControlId:"btnTableCellRightJustify",queryCommandId:M.a.DMa.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellTopAnchoring",M.a.S2.toString()),{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:M.a.GMa.toString()}));this.addCommandToMaps(new Xa.a("DistributeRows",M.a.C6f.toString()));this.addCommandToMaps(new Xa.a("DistributeColumns",M.a.B6f.toString()));this.addCommandToMaps(new Xa.a("TableDistribute",M.a.QWh.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SetCellBorderColor",
M.a.sWh.toString()),{populationProps:new Fh(M.a.Ruh.toString(),!1)}));this.addCommandToMaps(new Xa.a("CellBorderColorPickerMCU",M.a.eOa.toString()));this.addCommandToMaps(new Xa.a("CellBorderColorPicker",M.a.eOa.toString()));this.addCommandToMaps(new Xa.a("StandardCellBorderColorPicker",M.a.eOa.toString()));this.addCommandToMaps(new Xa.a("CellBorderRecentColors",M.a.rvh.toString()));this.addCommandToMaps(new Xa.a("CellBorderMoreColors",M.a.Ohh.toString()));this.addCommandToMaps(new Xa.a("TableBorderWidthAnchor",
M.a.GWh.toString()));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_1",M.a.XAa.toString()),{queryCommandId:M.a.H0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_2",M.a.XAa.toString()),{queryCommandId:M.a.I0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_3",M.a.XAa.toString()),{queryCommandId:M.a.J0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_4",M.a.XAa.toString()),{queryCommandId:M.a.K0e.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_5",M.a.XAa.toString()),{queryCommandId:M.a.L0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_6",M.a.XAa.toString()),{queryCommandId:M.a.M0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_7",M.a.XAa.toString()),{queryCommandId:M.a.N0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_8",M.a.XAa.toString()),{queryCommandId:M.a.O0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBorderWidth_9",
M.a.XAa.toString()),{queryCommandId:M.a.P0e.toString()}));this.addCommandToMaps(new Xa.a("TableBorderTypeAnchor",M.a.FWh.toString()));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersNoBorder",M.a.ora.toString()),{queryCommandId:M.a.D0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersAllBorders",M.a.ora.toString()),{queryCommandId:M.a.v0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersOutsideBorders",M.a.ora.toString()),{queryCommandId:M.a.E0e.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TableBordersInsideBorders",M.a.uWh.toString()),{queryCommandId:M.a.z0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersTopBorder",M.a.ora.toString()),{queryCommandId:M.a.G0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersBottomBorder",M.a.ora.toString()),{queryCommandId:M.a.w0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersLeftBorder",M.a.ora.toString()),{queryCommandId:M.a.C0e.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("TableBordersRightBorder",M.a.ora.toString()),{queryCommandId:M.a.F0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersInsideHorizontalBorder",M.a.tWh.toString()),{queryCommandId:M.a.A0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersInsideVerticalBorder",M.a.vWh.toString()),{queryCommandId:M.a.B0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersDiagonalUpBorder",M.a.ora.toString()),
{queryCommandId:M.a.y0e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableBordersDiagonalDownBorder",M.a.ora.toString()),{queryCommandId:M.a.x0e.toString()}));this.addCommandToMaps(new Xa.a("TableCellMarginAnchor",M.a.jdf.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginNormal",M.a.Uzc.toString()),{queryCommandId:M.a.Ttd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginNone",M.a.Tzc.toString()),{queryCommandId:M.a.Std.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginNarrow",M.a.Szc.toString()),{queryCommandId:M.a.Rtd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyTableCellMarginWide",M.a.Xzc.toString()),{queryCommandId:M.a.Utd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TableCellMarginCustom",M.a.Pyc.toString()),{queryCommandId:M.a.zOb.toString()}))}tui(){this.hj(Object.assign(new Rg("ContextualTabs.Tables.Design.Shading"),{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));
this.hj(Object.assign(new Rg("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Layout.Properties"),
{externalUxCommandIds:["AlternativeText"]}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Layout.RowColumn"),{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.hj(Object.assign(new Rg("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));this.hj(Object.assign(new Rg("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));
this.hj(Object.assign(new Rg("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));this.hj(Object.assign(new Rg("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.hj(Object.assign(new Rg("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.hj(Object.assign(new Rg("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Designer"),{externalUxGroupId:"DesignerHome"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Ideas"),
{externalUxGroupId:"Ideas"}));this.addCommandToMaps(Object.assign(new Xa.a("CopilotStart",M.a.aTc.toString())));this.addCommandToMaps(Object.assign(new Xa.a("ChatPPTPane",M.a.uxb.toString()),{queryCommandId:M.a.Juc.toString()}));this.hj(Object.assign(new Rg("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.hj(Object.assign(new Rg("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.hj(Object.assign(new Rg("PptRibbon.DrawingFormat.ShapeStyles"),
{externalUxGroupId:"ShapeStyles"}));this.hj(Object.assign(new Rg("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));this.hj(Object.assign(new Rg("PptRibbon.Home.Delete"),{externalUxGroupId:"Delete"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Font"),
{externalUxGroupId:"Font"}));this.hj(Object.assign(new Rg("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));this.hj(Object.assign(new Rg("PptRibbon.Home.UndoRedo"),{externalUxGroupId:"Undo"}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));let a;this.hj((a=new Rg("PptRibbon.Home.InsertAddInFlyout"),a.externalUxCommandIds=["InsertAddInFlyout"],a));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));
this.hj(Object.assign(new Rg("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.Images"),{externalUxCommandIds:["Picture","OnlinePictures"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.InsertHyperlink"),{externalUxCommandIds:["InsertLink"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.InsertTables"),
{externalUxCommandIds:["TableAnchor"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.Media"),{externalUxCommandIds:["InsertOnlineVideo"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.Symbols"),{externalUxCommandIds:["InsertSymbol"]}));this.hj(Object.assign(new Rg("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.hj(Object.assign(new Rg("PptRibbon.PictureFormat.Adjust"),
{externalUxGroupId:"Adjust"}));this.hj(Object.assign(new Rg("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.hj(Object.assign(new Rg("PptRibbon.PictureFormat.Style"),{externalUxGroupId:"PictureStyles"}));this.hj(Object.assign(new Rg("PptRibbon.Review.Comments"),{externalUxGroupId:"Comments"}));this.hj(Object.assign(new Rg("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.hj(Object.assign(new Rg("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));
this.hj(Object.assign(new Rg("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.hj(Object.assign(new Rg("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));this.hj(Object.assign(new Rg("PptRibbon.SmartArt.Layouts"),{externalUxGroupId:"SmartArtLayouts"}));this.hj(Object.assign(new Rg("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.hj(Object.assign(new Rg("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.hj(Object.assign(new Rg("PptRibbon.Transition.AllSlides"),
{externalUxGroupId:"TransitionAllSlides"}));this.hj(Object.assign(new Rg("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.hj(Object.assign(new Rg("PptRibbon.Transition.Timing"),{externalUxGroupId:"TransitionTiming"}));this.hj(Object.assign(new Rg("PptRibbon.Review.Proofing"),{externalUxGroupId:"Proofing"}));this.hj(Object.assign(new Rg("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.hj(Object.assign(new Rg("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes",
"ShowHideComments"]}));this.hj(Object.assign(new Rg("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.hj(Object.assign(new Rg("PptRibbon.View.Zoom"),{externalUxGroupId:"Zoom"}));this.hj(Object.assign(new Rg("PptRibbon.View.Subtitles"),{externalUxGroupId:"Subtitles"}));this.hj(Object.assign(new Rg("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.hj(Object.assign(new Rg("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.hj(Object.assign(new Rg("PptRibbon.DrawingFormat.NewArrange"),
{externalUxGroupId:"Arrange"}));this.hj(Object.assign(new Rg("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.hj(Object.assign(new Rg("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));this.hj(Object.assign(new Rg("PptRibbon.DrawingFormat.FormatOptions"),{externalUxGroupId:"Properties"}));this.hj(Object.assign(new Rg("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.hj(Object.assign(new Rg("PptRibbon.Graphics.FormatOptions"),
{externalUxGroupId:"Properties"}))}Zsi(){this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuEmbed",M.a.vob.toString()),{legacyControlId:"PptJewel.Share.Embed"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuShare",N.a.bfa.toString()),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuTermsOfUse",N.a.GMb.toString()),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuThirdPartyNotices",
N.a.kSb.toString()),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileMenuPrivacy",N.a.SNb.toString()),{legacyControlId:"PptJewel.About.Privacy"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileAboutPage",N.a.Ce.toString()),{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileHomePage",N.a.btc.toString()),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileAddinPage",
N.a.Ce.toString()),{legacyControlId:"PptJewel.Addin"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileInfoPage",N.a.Ce.toString()),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileNewPage",N.a.btc.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileOpenPage",N.a.Zrd.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFilePrintPage",N.a.Ce.toString()),{legacyControlId:"PptJewel.Print"}));
this.addCommandToMaps(Object.assign(new Xa.a("PptFileSaveAsPage",N.a.Ce.toString()),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Xa.a("PptFileSharePage",N.a.Ce.toString()),{legacyControlId:"PptJewel.Share"}))}gti(){this.addCommandToMaps(new Xa.a("GroupAnchor",M.a.uYe.toString()));this.addCommandToMaps(new Xa.a("GroupShapes",M.a.vYe.toString()));this.addCommandToMaps(new Xa.a("UngroupShapes",M.a.DYe.toString()))}cti(){this.addCommandToMaps(new Xa.a("AudioPlay",M.a.LPc.toString()));
this.addCommandToMaps(new Xa.a("AudioPause",M.a.U3b.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SetAudioOptions",M.a.oLh.toString()),{queryCommandId:M.a.$tc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("PlayAcrossSlides",M.a.playAcrossSlides.toString()),{queryCommandId:M.a.suc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("LoopUntilStopped",M.a.loopUntilStopped.toString()),{queryCommandId:M.a.nuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("HideDuringShow",
M.a.hideDuringShow.toString()),{queryCommandId:M.a.huc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("RewindAfterPlaying",M.a.rewindAfterPlaying.toString()),{queryCommandId:M.a.yuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("PlayInBackground",M.a.playInBackground.toString()),{queryCommandId:M.a.tuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("NoAudioStyle",M.a.noAudioStyle.toString()),{queryCommandId:M.a.puc.toString()}));this.addCommandToMaps(new Xa.a("SetVolume",
M.a.setVolume.toString()));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeLow",M.a.Dzd.toString()),{queryCommandId:M.a.Cuc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeMedium",M.a.Ezd.toString()),{queryCommandId:M.a.Duc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeHigh",M.a.Czd.toString()),{queryCommandId:M.a.Buc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SetVolumeMute",M.a.Fzd.toString()),{queryCommandId:M.a.Euc.toString()}));
this.addCommandToMaps(Object.assign(new Xa.a("StartAudio",M.a.cUh.toString()),{queryCommandId:M.a.Nuc.toString()}))}pti(){this.addCommandToMaps(Object.assign(new Xa.a("GetSlideInformation",N.a.x9.toString()),{queryCommandId:M.a.Muc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("OpenLanguageDialog",M.a.zqd.toString()),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:M.a.jOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("OpenDocumentLabelPane",N.a.iWe.toString()),
{queryCommandId:N.a.oOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("TextForOfficeOnlineInGallatin",N.a.x9.toString()),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Xa.a("GetEnvironmentName",N.a.x9.toString()),{legacyControlId:"EnvironmentLabel",queryCommandId:N.a.C_e.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("GetSlideScore",N.a.x9.toString()),{legacyControlId:"SlideScoreLabel",queryCommandId:M.a.Iyh.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("GetCoAuthStatus",
N.a.x9.toString()),{legacyControlId:"CoauthStatusLabel",queryCommandId:M.a.hyh.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("GetDataSyncMode",N.a.x9.toString()),{legacyControlId:"DataSyncModeLabel",queryCommandId:M.a.iyh.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("GetOfflineStatus",N.a.x9.toString()),{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",queryCommandId:M.a.wyh.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowAddInCommandsLoadStatusCallout",
N.a.C$e.toString()),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:N.a.cOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("OpenFeedbackDialog",N.a.w5.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));this.addCommandToMaps(Object.assign(new Xa.a("GiveFeedbackPane",N.a.mQb.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));this.addCommandToMaps(Object.assign(new Xa.a("ShowHidePerfStats",M.a.FAd.toString()),{legacyControlId:"PptEditingStatusBar.PerfStats",
queryCommandId:M.a.quc.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowHideNotes",M.a.ONa.toString()),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:M.a.jtd.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowEditTriPaneViewInStatusBar",M.a.MNa.toString()),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:M.a.fOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("ShowSorterViewInStatusBar",M.a.Dia.toString()),{legacyControlId:"PptEditingStatusBar-SlideSorterView",
queryCommandId:M.a.HOb.toString()}));this.addCommandToMaps(Object.assign(new Xa.a("SwitchToReadingMode",M.a.zud.toString()),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Xa.a("StartSlideShowFromCurrentSlide",M.a.NAa.toString()),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Xa.a("ZoomOut",N.a.Eyb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("OpenZoomConfig",M.a.oWe.toString()),{legacyControlId:"PptEditingStatusBar.ZoomScale",
queryCommandId:M.a.W0e.toString()}));this.addCommandToMaps(new Xa.a("ZoomIn",N.a.XCb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("ZoomToFit",M.a.HCc.toString()),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}fti(){this.addCommandToMaps(new Xa.a("CellBorderEyedropper",M.a.lRc.toString()));this.addCommandToMaps(new Xa.a("CellShadingEyedropper",M.a.oRc.toString()));this.addCommandToMaps(new Xa.a("EyedropperFormatBackgroundColors",M.a.wXc.toString()));this.addCommandToMaps(new Xa.a("EyedropperFillColors",
M.a.tXc.toString()));this.addCommandToMaps(new Xa.a("EyedropperFontColors",M.a.vXc.toString()));this.addCommandToMaps(new Xa.a("EyedropperFontBackgroundColors",M.a.uXc.toString()));this.addCommandToMaps(new Xa.a("EyedropperOutlineColors",M.a.xXc.toString()))}dti(){this.addCommandToMaps(new Xa.a("LiveFeedStylesPreviewGallery",M.a.x$a.toString()));for(const a of this.DGk){const b=a.split("_")[2],c=new Xa.a(a,M.a.x$a.toString());c.queryCommandId=M.a.zc.toString();c.menuItemId=b;this.addCommandToMaps(c)}}$si(){this.addCommandToMaps(new Xa.a("AccessibleAuthoringHelp",
M.a.NIf.toString()));this.addCommandToMaps(new Xa.a("AddHiddenSlideTitle",M.a.fKf.toString()));this.addCommandToMaps(new Xa.a("AddSlideTitle",M.a.addSlideTitle.toString()));this.addCommandToMaps(new Xa.a("EditSlideTitle",M.a.editSlideTitle.toString()));this.addCommandToMaps(new Xa.a("InsertCaptions",M.a.gyg.toString()));this.addCommandToMaps(new Xa.a("InsertCaptionsSplitButton",M.a.hyg.toString()));this.addCommandToMaps(new Xa.a("InsertHeaderColumn",G.a.mXa.toString()));this.addCommandToMaps(new Xa.a("InsertHeaderRow",
G.a.beb.toString()));this.addCommandToMaps(new Xa.a("InsertHeaderRowSplitButton",G.a.beb.toString()));this.addCommandToMaps(Object.assign(new Xa.a("InspectWithoutColor",M.a.Cyg.toString()),{queryCommandId:M.a.juc.toString()}));this.addCommandToMaps(new Xa.a("LinkText",M.a.vvh.toString()));const a=new Xa.a("MarkAsDecorative",M.a.IQe.toString());a.queryCommandId=M.a.ouc.toString();this.addCommandToMaps(a);this.addCommandToMaps(new Xa.a("RemoveAllCaptions",M.a.CCh.toString()));this.addCommandToMaps(new Xa.a("SetAsSlideTitle",
M.a.setAsSlideTitle.toString()));this.addCommandToMaps(new Xa.a("SlideTitle",M.a.OJf.toString()))}}Object(m.a)(UC,"PPTWebEditReactCommandDefinitionMapping",Iy,[]);class RA{}RA.kWh="TabId";Object(m.a)(RA,"RibbonSQMProperties",null,[]);class dD{constructor(a){this.Ca=a;this.Ca.xa(N.a.Nvd,Le.a.frame,Object(R.a)(this,this.Nvd,"reportTabSwitch"));this.Ca.xa(N.a.NFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.PFh,Le.a.frame,ff.ActionManager.uh)}Nvd(a,b,c,f,l){this.Ca.nb(this.mKj(l[RA.kWh]),2);return 32}}
Object(m.a)(dD,"RibbonSQMInformation",null,[626]);class di{}di.GNc="PptRibbon.AddIns";di.animations="PptRibbon.Animation";di.dVc="PptRibbon.Design";di.jVc="PptRibbon.Developer";di.a3c="PptRibbon.Graphics";di.Dfa="PptRibbon.Help";di.home="PptRibbon.Home";di.insert="PptRibbon.InsertTab";di.picture="PptRibbon.PictureFormat";di.pwd="PptRibbon.Review";di.shape="PptRibbon.DrawingFormat";di.iBd="PptRibbon.SlideShow";di.smartArt="PptRibbon.SmartArt";di.PWh="ContextualTabs.Tables.Design";di.tableLayout="ContextualTabs.Tables.Layout";
di.G4a="PptRibbon.Transition";di.view="PptRibbon.View";Object(m.a)(di,"MLRTabIds",null,[]);class ak{}ak.GNc="AddIns";ak.animations="Animations";ak.dVc="Design";ak.jVc="Developer";ak.draw="Draw";ak.a3c="Graphics";ak.Dfa="Help";ak.home="Home";ak.insert="Insert";ak.picture="FormatPicture";ak.pwd="Review";ak.shape="FormatShape";ak.iBd="SlideShow";ak.smartArt="SmartArtDesign";ak.table="Table";ak.G4a="Transitions";ak.view="View";Object(m.a)(ak,"SLRTabIds",null,[]);class MH extends dD{constructor(a){super(a)}Gxl(){this.Ca.xa(N.a.zFh,
Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.AFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.BFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.CFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.EFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.FFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.GFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.HFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.IFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.JFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.KFh,
Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.LFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.MFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.l4e,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(M.a.OFh,Le.a.frame,ff.ActionManager.uh);this.Ca.xa(N.a.QFh,Le.a.frame,ff.ActionManager.uh)}mKj(a){let b=N.a.PFh,c="PptRibbon.Unknown";switch(a){case di.GNc:case ak.GNc:c=di.GNc;b=N.a.zFh;break;case di.animations:case ak.animations:c=di.animations;b=M.a.AFh;break;case di.dVc:case ak.dVc:c=di.dVc;b=M.a.BFh;
break;case di.jVc:case ak.jVc:c=di.jVc;b=N.a.CFh;break;case ak.draw:c=a;b=M.a.DFh;break;case di.a3c:case ak.a3c:c=di.a3c;b=M.a.EFh;break;case di.Dfa:case ak.Dfa:c=di.Dfa;b=N.a.FFh;break;case di.home:case ak.home:c=di.home;b=N.a.GFh;break;case di.insert:case ak.insert:c=di.insert;b=N.a.HFh;break;case di.picture:case ak.picture:c=di.picture;b=M.a.IFh;break;case di.pwd:case ak.pwd:c=di.pwd;b=N.a.JFh;break;case di.shape:case ak.shape:c=di.shape;b=M.a.KFh;break;case di.iBd:case ak.iBd:c=di.iBd;b=M.a.LFh;
break;case di.smartArt:case ak.smartArt:c=di.smartArt;b=M.a.MFh;break;case di.PWh:case di.tableLayout:c=a;b=M.a.l4e;break;case ak.table:c=di.PWh;b=M.a.l4e;break;case di.G4a:case ak.G4a:c=di.G4a;b=M.a.OFh;break;case di.view:case ak.view:c=di.view,b=N.a.QFh}if(a=$c.a.Kb)a.actionName=c,a.tk=!0,a.gq=!1;return b}}Object(m.a)(MH,"PPTWebEditorRibbonSQMInformation",dD,[]);var Gw=d(950);class eD{constructor(){this.rVb=null}wem(){this.rVb||(this.rVb=Tb.a.instance.ub("Common.App.AccountSwitching.IAccountSwitching"))||
da.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}utj(){this.wem();return this.rVb?this.rVb.getCustomAuthConfig():null}static Wgk(){return A.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsCustomAuthConfig")}}Object(m.a)(eD,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class fD{constructor(){this.Qgc=this.cultureName=null}}Object(m.a)(fD,"HeaderCultureInfo",null,[]);var SA=d(685);class NH{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=
null}}Object(m.a)(NH,"SearchInitializationSettings",null,[]);var OH=d(357);class PH{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(PH,"DocumentTitleAppProps",null,[]);class QH{constructor(){this.documentExtension=
this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(QH,"DocumentTitleCalloutAppProps",null,[]);class RH{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=
this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=
this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(RH,"HeaderAppProps",null,[]);class SH{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(SH,"HeaderControls",null,[]);class TH{constructor(){this.command=this.label=null}}Object(m.a)(TH,"WorkflowButtonAppProps",null,[]);var TA;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.Cvm=2]="insufficientPermission";
a[a.vvm=3]="incompatibleEditorsPresent";a[a.wum=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(TA||(TA={}));Object(m.b)("RenameDisableReason",TA);class UH{constructor(a){a=void 0===a?"":a;this.r6e=this.documentTitleAppProps=this.wjf=null;this.bme=()=>{if(!this.wjf){const b=Gw.a();if(b){const c=this.wJj(b.command);c&&(this.wjf=Object.assign(new TH,{command:c,label:b.label}))}}return this.wjf};this.O4k=()=>{Cd.a.get_instance().eJ(17)};this.onMove=()=>{const b={};b.MoveButtonClickedTime=new Date;
A.AFrameworkApplication.Pa.Ia(N.a.ikb,2,b)};this.Xzj=()=>{let b=null,c=null;var f=Tb.a.instance.ub("Common.IRenameProps");f?(f=f.vng(),0!==f&&(b=this.ZJj(f),c=TA[f])):da.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new QH,{breadcrumbBrandName:A.AFrameworkApplication.Qu.breadcrumbBrandName,breadcrumbBrandUrl:A.AFrameworkApplication.Qu.breadcrumbBrandUrl,breadcrumbFolderName:A.AFrameworkApplication.Qu.breadcrumbFolderName,breadcrumbFolderUrl:A.AFrameworkApplication.Qu.breadcrumbFolderUrl,
hideDocumentTitleInput:A.AFrameworkApplication.za.mb.B2j,isVersionHistoryEnabled:this.rZl(),documentExtension:Aa.a.AR(A.AFrameworkApplication.fileName),isMoveEnabled:32===A.AFrameworkApplication.Pa.nb(N.a.ikb,1),onMove:this.onMove,message:b,renameDisableReason:c,openBreadcrumbsInNewTab:A.AFrameworkApplication.fa.getBooleanAppSetting("OpenLinksInNewWindow")})};this.Fig=()=>{if(!this.documentTitleAppProps){const b=A.AFrameworkApplication.Qu.iy;this.documentTitleAppProps=Object.assign(new PH,{documentTitle:A.AFrameworkApplication.TVc?
b:Aa.a.dI(b),onFirstRender:this.O4k,getCalloutAppProps:this.Xzj,isShared:!1})}return this.documentTitleAppProps};this.L_i=b=>{appChrome.getHeaderApi().then(c=>{c.setNavBarData(b.result);return null});da.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")};this.onFirstRender=()=>{Tb.a.instance.Ha("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.GWl.continueWith(this.L_i,3)});Cd.a.get_instance().eJ(15)};this.onFullyLoaded=()=>{Cd.a.get_instance().eJ(16)};this.Xoi=""!==
a?a:Kq.a.YN}wJj(a){const b=Tb.a.instance.ub("Common.IExternalUICommandDefinitionMapping").hva(a);if(b&&0<b.length)return b[0].externalUxCommand;da.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}Oxj(){return Object.assign(new SH,{workflowButton:this.bme()})}ZJj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}rZl(){return!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.CFg}uXl(){return!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.pqk}bZl(){const a=!Gw.b()&&!A.AFrameworkApplication.hideHeader&&!A.AFrameworkApplication.avg&&(A.AFrameworkApplication.fa.getBooleanAppSetting("SkypeWebControlIsEnabled")||A.AFrameworkApplication.fa.getBooleanAppSetting("TeamsChatIsEnabled"));da.ULS.sendTraceTag(592315859,215,
50,"ShowChat is {0}",a);return a}Qvl(a){a=void 0===a?!1:a;appChrome.getHeaderApi().then(b=>{const c=Tb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});b.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});b.setHeaderCommandHandler("OnFlexPaneOpen",f=>{c.onFlexPaneOpen(f)});b.setHeaderCommandHandler("OnFlexPaneClose",f=>{c.onFlexPaneClose(f)});b.setHeaderCommandHandler("SetCookie",f=>Yi.a.set(f.cookieName,
f.value));b.setHeaderCommandHandler("GetCookie",f=>this.Pxj(f));b.setHeaderCommandHandler("QueryWorkflowButtonSettings",this.bme);a||(b.setHeaderCommandHandler("QueryDocumentTitleAppProps",this.Fig),b.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.P4k();return null}));SA.a.J8c()&&b.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(R.a)(this,this.Wng,"getSearchInitializationSettings"))})}P4k(){Tb.a.instance.Ha("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>
{a.Bra(!1,A.AFrameworkApplication.Pa.mode)})}Pxj(a){a=Yi.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}wOj(){return OH.AppChromeOverrideUtilities.isEnabled?OH.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.Xoi+A.AFrameworkApplication.h3+"suiteux-shell"}gJj(){var a=void 0===a?!1:a;a:{try{var b=Ea.a.Oe(A.AFrameworkApplication.lcid);if(b){var c=Object.assign(new fD,{cultureName:b.name,Qgc:b.Qgc});break a}}catch(f){da.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
A.AFrameworkApplication.lcid.toString())}c=Object.assign(new fD,{cultureName:"en-us",Qgc:"en"})}b=Tb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");c=Object.assign(new RH,{appName:CommonUIStrings.l_AppNameShort,culture:c.cultureName,language:c.Qgc,isConsumer:!A.AFrameworkApplication.EFd,showAppLauncher:Gw.f(),showMeControl:Gw.e(),hideUserName:A.AFrameworkApplication.doe,defaultDocumentTitleToLeft:A.AFrameworkApplication.D3f,assetsContainerOverride:this.wOj(),controls:this.Oxj(),
documentTitleAppProps:a?null:this.Fig(),showDocumentTitleControl:!a,showWorkflowButton:!!this.bme(),showChatControl:this.bZl(),showGoPremiumControl:Gw.g(),showDiscoverPremiumButton:Gw.d(),enableSearchControl:SA.a.Lpk(),onFlexPaneOpen:Object(R.a)(b,b.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(R.a)(b,b.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.uXl(),testTraffic:A.AFrameworkApplication.fa.getBooleanAppSetting("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,
onFullyLoaded:this.onFullyLoaded,enableUpdatedRUMReporting:A.AFrameworkApplication.vXl()});!A.AFrameworkApplication.jqb||A.AFrameworkApplication.Laf?(c.userDisplayName=A.AFrameworkApplication.userName,c.emailAddress=A.AFrameworkApplication.fa.Ea("UserPrincipalName"),c.userID=A.AFrameworkApplication.fa.Ea("Puid")||"",c.signOutLink=A.AFrameworkApplication.Laf):A.AFrameworkApplication.signInUrl&&(c.signInLink=A.AFrameworkApplication.signInUrl);SA.a.J8c()&&(b=this.Wng(),c.loadTellMeResources=b.loadTellMeResources,
c.getTokenRequestDictionary=b.getTokenRequestDictionary,c.enableVanillaSearchBox=A.AFrameworkApplication.fa.getBooleanAppSetting("VanillaSearchUxInHeaderIsEnabled"),c.userRing=b.userRing);eD.Wgk()&&(b=new eD,c.shellAuthProviderConfigPromise=Object(R.a)(b,b.utj,"getAccountSwitchingConfig"));this.Nsi();this.Qvl(a);A.AFrameworkApplication.F1("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return c}Nsi(){A.AFrameworkApplication.fa.getBooleanAppSetting("SideLoadingIsEnabled")&&
Cd.a.get_instance().Ij(16,()=>{appChrome.getHeaderApi().then(a=>{a.setCustomHeaderButtonBadgeCharacter("overrideSettingButtonId","\u25b6");a.setCustomHeaderButtonBadgeLabel("overrideSettingButtonId","Sideloading is active so javascript is coming from an unofficial source.");a.setCustomHeaderButtonBadgeColors("overrideSettingButtonId",{badgeColor:"green",badgeHoverColor:"green",badgeFontColor:"white",badgeFontHoverColor:"white"});return null})})}Wng(){if(!this.r6e){const a=new SA.a;let b=A.AFrameworkApplication.fa.Ea("Microsoft365Ring");
b&&b.length||(b="generalAudience");this.r6e=Object.assign(new NH,{loadTellMeResources:a.fyk(),getTokenRequestDictionary:Object(R.a)(a,a.eQj,"getTokenRequestDict"),userRing:b})}return this.r6e}}Object(m.a)(UH,"ReactSharedHeaderPropsHelper",null,[499]);var Mg=d(310),CR=d(1291),DR=d(1117);d(951);var VH=d(684);const Su=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},WH=(a,b,c,f)=>{if(a&&a.parentNode&&a.parentNode.parentNode){var l=(l=fg.a.Tu(a))?za.a.LN(l.paddingLeft)+za.a.LN(l.paddingRight):0;var u=
fg.a.Tu(a.parentNode);u=u?za.a.LN(u.paddingLeft)+za.a.LN(u.paddingRight):0;let I=0,T=a;for(;T.nextSibling;)T=T.nextSibling,I+=T.offsetWidth;l=l+u+I;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");u=f?c:b;c=f?b:c;f=Sd.a.wi(a.parentNode.parentNode);b=u?Sd.a.wi(u):new Sys.UI.Bounds(f.x,0,0,0);c=c?Sd.a.qGa(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=Sd.a.wi(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-
(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},UA=a=>{a&&Jr(a)&&(a.style.display="",a._isHidden="0")},Yl=a=>{a&&!Jr(a)&&(a.style.display="none",a._isHidden="1")},Jr=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},At=(a,b,c)=>{if(a&&!Jr(a)){var f=fg.a.Tu(a);f=za.a.LN(f.paddingLeft)+za.a.LN(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=fg.a.Tu(b))&&(l+=za.a.LN(f.paddingLeft)+za.a.LN(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},
vs=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},ER=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,top:l}=Sd.a.Oig(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},fr=(a,b,c)=>!a||!b||Jr(a)||Jr(b)?!1:Sd.a.BIg(Sd.a.wi(a),Sd.a.wi(b),c),Bt=(a,b,c)=>{let f=0;a&&b&&(f=Sd.a.Jze(Sd.a.wi(a),Sd.a.wi(b),c));return f};var ws=d(430);class VA{constructor(a,b,c){this.uzb=this.K8b=this.tzb=this.Yab=this.rWc=this.J8b=this.$H=this.I8b=this.JUa=this.xR=this.sWc=this.IUa=
this.Sea=this.ww=this.rM=this.KU=this.HUa=this.Xab=this.Wab=this.DFa=null;this.JQ=a;this.jXb=b;this.Ll=c}tKl(a){this.JQ=a;this.jXb=null;this.Yde(this.JQ);this.S0h();this.vJh()}T2a(){this.JQ&&this.jXb&&this.jXb.clientHeight&&(this.Yde(this.JQ),this.S0h(),this.vJh(),-1!==this.jXb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.Ccg(this.jXb),this.zfm(),this.xKl()))}Yde(a){if(a)for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=za.a.sma(f),u=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.DFa=
f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.Wab=f;else if(f.id===xm.CuiHelper.o2d)this.Xab=f;else if(f.id===xm.CuiHelper.Tdg)this.HUa=f;else if(f.id===xm.CuiHelper.p2d)this.KU=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.rM=f;else if(f.id===xm.CuiHelper.q2d)this.ww=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.Sea=f;else{var b;if(b=u)b=f,b=!!b.id&&(b.id.startsWith(xm.CuiHelper.v9e)||b.id.startsWith(xm.CuiHelper.Kvd));b?this.IUa=f:u&&f.id.startsWith(xm.CuiHelper.E2l)?
this.sWc=f:-1!==l.indexOf("UsernameNameContainer")?this.xR=f:-1!==l.indexOf("UsernameNameItem")&&(this.JUa=f)}this.Yde(f)}}S0h(){var a=[this.rM,this.ww,this.xR],b=[this.Wab,this.Xab,this.HUa,this.KU,this.rM,this.ww,this.Sea,this.IUa,this.sWc,this.xR];for(const c of b)UA(c);for(const c of a)vs(c);if(a=this.rM)a.style.position="static",a.style.left="auto"}vJh(){this.O6d()?this.vKl():this.wKl();var a=this.HUa,b=this.KU;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}vKl(){let a;const b=
this.Dhe();a=[()=>{At(this.KU,this.KU,Bt(this.DFa,b,this.Ll))},()=>{Yl(this.Wab);Yl(this.Xab);Yl(this.HUa);Yl(this.KU)}];Su(a,()=>fr(this.KU,b,this.Ll));fr(this.$H,this.rM,this.Ll)&&ER(this.rM,this.$H,this.Ll);this.KGh();a=[()=>{At(this.xR,this.JUa,Bt(this.$H,this.Sea,this.Ll))},()=>{Yl(this.IUa)}];this.LGh();Jr(this.rM)||Jr(this.ww)||WH(this.ww,this.$H,this.Sea,this.Ll)}wKl(){const a=!!this.KU,b=!!this.ww;let c=0;if((a||b)&&0<(c=Bt(this.DFa,this.rM,this.Ll))){let f=a;b&&(!a||this.ww.offsetWidth>
this.KU.offsetWidth)&&(f=!1);At(f?this.KU:this.ww,f?this.KU:this.ww,f?c:2*c);a&&b&&0<(c=Bt(this.DFa,this.rM,this.Ll))&&(f=!f,At(f?this.KU:this.ww,f?this.KU:this.ww,f?c:2*c))}Su([()=>{Yl(this.Wab);Yl(this.Xab);Yl(this.HUa);Yl(this.KU);vs(this.ww)},()=>{At(this.ww,this.ww,2*Bt(this.DFa,this.rM,this.Ll))},()=>{Yl(this.ww)}],()=>fr(this.DFa,this.rM,this.Ll));this.KGh();this.LGh();Jr(this.rM)||Jr(this.ww)||WH(this.ww,this.DFa,this.Sea,this.Ll)}KGh(){const a=Jr(this.ww);Su([()=>{this.S4e()},()=>{Yl(this.IUa);
vs(this.ww);vs(this.xR);a||UA(this.ww)},()=>{this.S4e()},()=>{Yl(this.sWc);vs(this.ww);vs(this.xR);a||UA(this.ww)},()=>{this.S4e()}],()=>fr(this.rM,this.Sea,this.Ll))}S4e(){const a=!!this.ww,b=!!this.xR;let c=0;if((a||b)&&0<(c=Bt(this.rM,this.Sea,this.Ll))){const f=!!this.rM&&"absolute"!==this.rM.style.position;let l=a;b&&(!a||this.xR.offsetWidth>this.ww.offsetWidth)&&(l=!1);At(l?this.ww:this.xR,l?this.ww:this.JUa,l&&f?2*c:c);a&&b?(0<(c=Bt(this.rM,this.Sea,this.Ll))&&(l=!l,At(l?this.ww:this.xR,l?
this.ww:this.JUa,l&&f?2*c:c)),fr(this.rM,this.Sea,this.Ll)&&(Yl(this.rM),vs(this.xR))):a&&fr(this.rM,this.Sea,this.Ll)&&Yl(this.ww)}}LGh(){const a=()=>{At(this.xR,this.JUa,Bt(this.DFa,this.Sea,this.Ll))};Su([a,()=>{Yl(this.IUa);vs(this.xR)},a,()=>{Yl(this.sWc);vs(this.xR)},a,()=>{Yl(this.xR)}],()=>fr(this.DFa,this.Sea,this.Ll))}O6d(){if(!this.$H)return!1;for(let a=0;a<this.$H.childNodes.length;a++)if(-1!==za.a.sma(this.$H.childNodes[a]).indexOf("cui-cg"))return!0;return!1}Dhe(){if(!this.$H)return null;
let a=null;for(let b=this.$H.childNodes.length-1;0<=b;b--){const c=this.$H.childNodes[b];if(-1===za.a.sma(c).indexOf("cui-cg"))break;a=c}return a}Ccg(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=za.a.sma(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.I8b=c:-1!==f.indexOf("cui-tts")?this.$H=c:-1!==f.indexOf("cui-TabRowInline")?this.J8b=c:-1!==f.indexOf("cui-separator")?this.rWc=c:l&&c.id.startsWith(xm.CuiHelper.orh)?this.Yab=c:l&&c.id.startsWith(xm.CuiHelper.vbg)?
this.tzb=c:-1!==f.indexOf("cui-TabRowRight")?this.K8b=c:l&&c.id.startsWith(xm.CuiHelper.qXe)&&(this.uzb=c);this.Ccg(c)}}zfm(){var a=[this.$H,this.J8b,this.rWc,this.Yab,this.tzb,this.K8b,this.uzb];for(const b of a)UA(b);this.wRb(0)}xKl(){let a;a=[()=>{Yl(this.rWc);Yl(this.Yab)},()=>{this.wRb(1)},()=>{this.wRb(2)},()=>{Yl(this.J8b);this.wRb(0)}];Su(a,()=>fr(this.$H,this.J8b,this.Ll));a=[()=>{Yl(this.rWc);Yl(this.Yab)},()=>{Yl(this.tzb)},()=>{Yl(this.uzb)},()=>{Yl(this.K8b)}];Su(a,()=>fr(this.J8b,this.K8b,
this.Ll)||fr(this.$H,this.K8b,this.Ll));a=[()=>{this.wRb(1)},()=>{this.wRb(2)},()=>{Yl(this.$H)}];Su(a,()=>fr(this.I8b,this.$H,this.Ll))}wRb(a){this.$H&&(this.$H.className=VA.S7l[a],this.$H._scaleStep=a)}}VA.S7l=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(m.a)(VA,"TopBarScalingManager",null,[]);class XH{constructor(a,b){this.JQ=this.wCa=null;this._clientId=a;this.ODf=b}pij(){if(!Yj.b(this.JQ))return this.JQ;this.thj();if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("OfficeVSO:8025441_MissingHeaderThrowException")&&
Yj.b(this.JQ))throw Error.create("HeaderSkeleton.EnsureTopBarDomElement _elmTopBar1 is null or undefined");this.JQ.style.display="block";this.ODf&&this.ODf.v9(Object(R.a)(this,this.tu,"onResize"));return this.JQ}tu(){this.T2a()}T2a(){this.Ngj()?(document.getElementById("application").style.minWidth="0px",(new VA(this.JQ,null,A.AFrameworkApplication.isRtl)).tKl(this.JQ)):A.AFrameworkApplication.za.mb.mP||VH.a.uKl(this.JQ,A.AFrameworkApplication.isRtl)}Ngj(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("EnhancedMobileViewIsEnabled"):
!1}thj(){if(Yj.b(this.wCa)){var a;let b=ws.a.XTb(!A.AFrameworkApplication.fY);({Mcc:a}=b);b.returnValue?(this.wCa=xw("div"),this.wCa.className=ws.a.ckj,this.wCa.id=xm.CuiHelper.Ace,a.appendChild(this.wCa),this.khj(),A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.dYa&&!A.AFrameworkApplication.fY&&this.nhj(),this.oij()):A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("ReactHeaderCrashLogs")&&da.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}oij(){Yj.b(this.JQ)&&
(this.JQ=xw("div"),this.JQ.className=ws.a.Ram,this.JQ.style.display="none",this.wCa.appendChild(this.JQ))}khj(){Sys.UI.DomElement.addCssClass(this.wCa,ws.a.dkj);if(A.AFrameworkApplication.isRtl){var a=this.wCa;if(!Yj.b(a)){var b=a.className;if(Yj.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}nhj(){Sys.UI.DomElement.addCssClass(this.wCa,"FlexBoxLayout")}}Object(m.a)(XH,"HeaderSkeleton",null,[]);var FR=d(1324),gD=d(1267);class hD{constructor(){this.commandId=0;this.externalUxCommand=
null}}Object(m.a)(hD,"CommandDefinition",null,[]);class YH{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(YH,"CommandDefinitionMapping",null,[]);const GR=a=>Object.assign(new YH,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new hD,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new hD,{externalUxCommand:b})},getDoNothingCommand:()=>
parseInt(N.a.Ce),addCommandToMaps:Object(R.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(R.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(R.a)(a,a.addTabToMap,"addTabToMap")});var ZH=d(961);class $H{}Object(m.a)($H,"RibbonInitState",null,[]);var HR=d(470),aI=d(520);let Ct;class sq{static Ncm(a){A.AFrameworkApplication.za.mb.zAg||(a.ShowCommentsTopBar=!0);A.AFrameworkApplication.za.mb.nAg||(a.CatchUpWithChanges=!0)}static OZh(a){for(const b of sq.ufi)a[b]=!0}static flm(a,
b){var c=A.AFrameworkApplication.$cc;if(A.AFrameworkApplication.fa.du(c)&&A.AFrameworkApplication.fa.Ea(c)){sq.OZh(b);c=A.AFrameworkApplication.fa.hz("HostDefinedUIControls");for(let f=0;f<c.length;f++)sq.glm(a,b,c[f]);sq.Jcm(b);sq.Icm(b)}}static glm(a,b,c){if(c.id in a){a=a[c.id];for(const f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static Jcm(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static wwa(){const a=A.AFrameworkApplication.fa.Ea(A.AFrameworkApplication.uL);
return!!a&&"teams"===a.toLowerCase()}static gZl(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||A.AFrameworkApplication.fa.getBooleanAppSetting("IsTeamsCollabDeclutterIsEnabled")}static LZl(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",
!1)||A.AFrameworkApplication.fa.getBooleanAppSetting("IsPeripheralOverflowScalingEnabled")||A.AFrameworkApplication.fa.getBooleanAppSetting("IsTeamsCollabDeclutterIsEnabled")}static Icm(a){sq.wwa()&&(sq.gZl()&&(a.HostOpenInClient=!1),sq.LZl()&&(a.HostMoreOptions=!0))}}sq.ufi=(Ct=new La.a,Ct.add("HostOpenInClient"),Ct.add("HostConversation"),Ct.add("HostClose"),Ct.add("HostDownload"),Ct.add("HostOpenInBrowser"),Ct.add("HostMoreOptions"),Ct);Object(m.a)(sq,"CommandTrimmer",null,[]);class bI{constructor(){}flatten(a){const b=
[];for(const c of a)b.push.apply(b,c);return b}}Object(m.a)(bI,"ReactAsyncDispatcher",null,[]);class iD{}iD.dsc="PageId";Object(m.a)(iD,"FileMenuSQMProperties",null,[]);var jD=d(165);class cI{constructor(a,b){this.hr=null;this.xKc=!1;this.bRa=0;this.Uxf="";this.UId={};this.byh=()=>{this.Wd&&this.Wd.dW(K.AFrame.mQ,!0)};this.npd=()=>{this.X7b();this.e6f();this.XTe();this.vNa();return!0};this.opd=()=>{this.X7b();this.e6f();this.XTe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.vNa()},
0)});return!0};this.eVe=c=>{c.stopPropagation()};this.WQd=a;this.Wd=b;this.nBf=this.eVe;this.cxf=!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Zfa;this.j4=!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.XHa;this.dxf=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)}kMb(){0<this.bRa?this.bRa++:(this.bRa++,A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",
!1)?window.requestAnimationFrame(()=>{window.setTimeout(this.byh,0)}):this.byh(),this.showModal())}psk(){const a=document.getElementById("WACToolbarContainer");return!!a&&"block"===a.style.display}getRibbonMode(){return this.dxf&&this.psk()?"Toolbar":fh.f()}Gvj(){const a=this.getRibbonMode(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.cxf&&b.isActive&&0!==b.state?"_ShyRibbon":"")}jQj(a){var b=0;if(this.j4){if(this.UId[a])return this.UId[a];(b=document.getElementById("BusinessBar"))||
da.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.UId[a]=b}return b}showModal(){if(!this.hr)if(this.hr=this.createElement("div"),this.hr.setAttribute("id","ReactModalDiv"),this.hr.style.position="absolute",this.hr.style.bottom="0px",this.hr.style.left="0px",this.hr.style.right="0px",this.hr.style.backgroundColor="white",this.hr.style.opacity="0.0",this.j4){var a=document.getElementById("regionComposerRoot");
a&&a.appendChild(this.hr)}else this.WQd.appendChild(this.hr);a=this.Gvj();if(a!==this.Uxf){const c=this.jQj(a);var b=appChrome.selectors.getShyState();this.cxf&&b.isActive&&0!==b.state?(b=this.dxf?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(fh.f()),this.hr.style.top=String.format("{0}px",c+b)):this.hr.style.top=String.format("{0}px",c);this.Uxf=a}this.hr.style.display="block";this.hr.style.visibility="visible";this.hr.style.zIndex=
"1000";this.xKc||(window.addEventListener("wheel",this.nBf,!0),this.L7c()?Bg.a.instance.xb(la.a.US,this.hr,this.opd):Bg.a.instance.xb(la.a.BB,this.hr,this.npd),this.xKc=!0)}a7k(){this.bRa--;0<this.bRa||(0>this.bRa?this.bRa=0:this.kvg())}XTe(){this.bRa=0;this.M$d();this.kvg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}jvg(){this.Wd&&this.Wd.Je&&this.Wd.Je.name===K.AFrame.mQ&&!A.AFrameworkApplication.Be.Dx&&this.Wd.P2(K.AFrame.mQ,!1);this.hr&&(this.hr.style.zIndex=
"-1",this.hr.style.visibility="hidden",this.hr.style.display="none");this.xKc&&(window.removeEventListener("wheel",this.nBf,!0),this.L7c()?Bg.a.instance.Hb(la.a.US,this.hr,this.opd):Bg.a.instance.Hb(la.a.BB,this.hr,this.npd),this.xKc=!1)}kvg(){this.L7c()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.jvg()},0)}):this.jvg()}vNa(){4===A.AFrameworkApplication.za.mb.Ej&&A.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?A.AFrameworkApplication.za.vNa():
this.Wd.Df(K.AFrame.PX)}X7b(){const a=Tb.a.instance.ub("Common.IReactContextualUILauncher");a&&a.X7b()}M$d(){const a=Tb.a.instance.ub("Common.IReactContextualUILauncher");a&&a.M$d()}e6f(){A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.WHa&&(this.L7c()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}L7c(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(m.a)(cI,"ReactModalDiv",null,[]);var Tn=d(544);class dI{constructor(a,b){this.Coi=a;this.Dbi=b}}Object(m.a)(dI,"ReactExecuteCommandContext",null,[]);class Hw{}Hw.Color="Color";Hw.IndexColorSelected="ColorSelected";Object(m.a)(Hw,"ColorPickerCommandProperties",null,[]);var Po=d(955);class uo{}uo.SelectedFont="SelectedFont";uo.Formatting="Format";uo.RequestUpdateMru="RequestUpdateMru";uo.FontPickerId="fontPickerId";uo.IsPinned="IsPinned";uo.Trigger="Trigger";Object(m.a)(uo,"FontPickerCommandProperties",
null,[]);class Op{}Op.Trigger="FontTrigger";Op.Name="FontName";Op.Action="FontAction";Op.Level="FontLevel";Op.IsPinned="FontIsPinned";Object(m.a)(Op,"FontPickerLogProperties",null,[]);class Jy{}Jy.Rows="Rows";Jy.Columns="Columns";Object(m.a)(Jy,"InsertTableCommandProperties",null,[]);class Un{}Un.Alt="Alt";Un.Number="Number";Un.UnitType="UnitType";Un.Text="Text";Un.MaxValue="MaxValue";Object(m.a)(Un,"SpinnerCommandProperties",null,[]);class eI{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){ua=void 0===ua?
null:ua;Ra=void 0===Ra?null:Ra;this.E7a=null;this.DFf=!1;this.hLd=[];this.NEc=-1;this.fMc=!1;this.ppi=0;this.nWb=null;this.MCf=!1;this.zEc=null;this.lzf=!1;this.iim=(eb,Bb)=>{const Ub=eb.launcherId;this.WRb(Ub,Bb)&&(Bb=appChrome.selectors.getFlyoutAnchorMenuItems(Ub),this.tUb(Bb,Ub,fh.g(eb)))};this.Fim=(eb,Bb)=>{const Ub=eb.launcherId;this.WRb(Ub,Bb)&&(Bb=fh.j("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(Ub):appChrome.selectors.getFlyoutAnchorMenuItems(Ub),this.tUb(Bb,
Ub,fh.g(eb)))};this.Fjm=(eb,Bb)=>{const Ub=eb.launcherId;this.WRb(Ub,Bb)&&(Bb=appChrome.selectors.getPreviewGalleryMenuItems(Ub),this.tUb(Bb,Ub,fh.g(eb)))};this.Ckm=(eb,Bb)=>{const Ub=eb.launcherId;this.WRb(Ub,Bb)&&(Bb=appChrome.selectors.getSplitButtonMenuItems(Ub),this.tUb(Bb,Ub,fh.g(eb)))};this.Gkm=(eb,Bb)=>{const Ub=eb.launcherId;this.WRb(Ub,Bb)&&(Bb=appChrome.selectors.getStatefulSplitButtonMenuItems(Ub),this.tUb(Bb,Ub,fh.g(eb)))};this.VQ=a;this.DRa=b;this.nUd=Object(gb.a)(670,a);this.Hm=c;this.Wd=
f;l&&(this.E7a=new cI(l,f));this.$mi=u;this.gei=I;this.uO=ua;this.Ca=T;this.r7a={};this.La=ja;this.jnf=Ra;ja&&(ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ja.getBooleanAppSetting("EnqueueTasksWhenTaskMgrIsYielding"))&&xe.a.instance.ENf.CWR(()=>this.DFf=!0);ja&&(a=this.La.Ea("CommandControlIdPairsForLoggingOverride")||"")&&0<=a.trim().length&&({Ev:this.nWb}=Fe.d(a));this.nWb||(this.nWb={})}get Pxd(){return!!window.appChrome&&!!appChrome.selectors}DJh(){-1!==
this.NEc&&window.clearTimeout(this.NEc);this.NEc=window.setTimeout(()=>{for(this.NEc=-1;0<this.hLd.length;){if(ln.a.instance.Dx){this.DJh();break}const a=this.hLd.shift();a&&this.executeCommand(a.Coi,a.Dbi)}},0)}executeCommand(a,b){if(ln.a.instance.Dx){if(this.DFf){this.hLd.push(new dI(a,b));this.DJh();return}da.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,b.modelType,Qa.a.toJSON(b.payload));if(this.La.getBooleanAppSetting("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.Hm.getCommandByExternalUxId(a),f=b.modelType;this.jnf&&this.jnf.szk(a,b);c?this.gjj(a,c,f,b):this.hjj(a,f,b);this.QRi(b);this.xcm(b);this.BVk(a,b)}}hjj(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.B$f(c,a);break;case "ButtonModel":this.djj(c,a)}}ujm(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=
c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;a.TerminalParentControlId=c.payload.terminalParentControlId;this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(b=!0,Yj.b(c.payload.dismissHostingSurfaceOnExecute)||(b=c.payload.dismissHostingSurfaceOnExecute),b&&this.IEa()):this.IEa();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=
b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}vjm(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.Hm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":a=this.Hm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=
b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.IEa();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}gjj(a,b,c,f){var l=this.Tgl(f,c),u=b.commandId;const I={},T={};switch(c){case "SplitButtonModel":if(this.jcc(f.payload,this.Ckm,l))return;I.MenuItemId=b.menuItemId;this.Q8e(f,I);break;case "StatefulSplitButtonModel":if(this.jcc(f.payload,
this.Gkm,l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?I.Color=c:"icon"===l&&(c=this.Hm.getCommandByExternalUxId(c))&&(I.MenuItemId=c.menuItemId);break;case "FileMenu":I.MenuItemId=b.menuItemId;I.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.aWj(u,f.payload,a);break;case "TellMe":u=this.vjm(u,f,I);I.SourceControlId=a;I.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.O_j(I,f):u=this.ujm(I,
b,f,a,u);break;case "CompoundButtonModel":I.MenuItemId=b.menuItemId;I.CommandValueId=f.payload.commandValueId;I.SourceControlId=a;this.Q8e(f,I);this.IEa();break;case "ToggleButtonModel":case "InkButtonModel":I.MenuItemId=b.menuItemId;I.SourceControlId=a;this.Q8e(f,I);this.IEa();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":u=this.Hm.getCommandByExternalUxId("FontPickerMenuOpen").commandId;I[uo.FontPickerId]=f.payload.launcherId;break;case "MenuClosePayload":u=this.Hm.getCommandByExternalUxId("FontPickerMenuClose").commandId;
I[uo.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=Ca.FontUtils.gH(c),I.CommandValueId=l,l=Ca.FontUtils.TTc(l)):(c.data?(I.CommandValueId=c.data.fontToApply,I.MenuItemId=c.data.themeIndex,I[uo.Formatting]=c.data):I.CommandValueId=c.name,l=c);I.SourceControlId=a;I[uo.RequestUpdateMru]=l;T[Op.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?Ca.FontUtils.w6c(c)?"*"+c:Ca.FontUtils.ive(c)?"[EF]":"[MF]":"";T[Op.IsPinned]=
f.payload.isPinned;T[Op.Level]=f.payload.level;this.zAe();break;case "FontPickerFontInfoRequestedPayload":I.CommandValueId=f.payload.font.name;I[uo.Trigger]=f.payload.trigger;T[Op.Trigger]=f.payload.trigger;T[Op.Name]=f.payload.nameToLog;this.zAe();break;case "FontPickerFontPinningPayload":c=f.payload.isPinned;I.CommandValueId=f.payload.fontKey;I[uo.IsPinned]=c;T[Op.Name]=f.payload.nameToLog;T[Op.Action]=c?"pin":"unpin";T[Op.Level]=f.payload.level;this.zAe();break;default:return}break;case "ComboBoxModel":var ja=
f.payload.type;switch(ja){case "MenuOpenPayload":case "MenuPopulatePayload":this.WRb(f.payload.launcherId,l)&&(u={},u[f.payload.launcherId]=c,this.DRa.Tsc(u,fh.g(f.payload)),this.r7a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=f.payload.newValue;if(!c)return;c.value?(I[Po.a.Value]=c.value,I[Po.a.IsFreeForm]=!0):(I[Po.a.Value]=c.text,I.MenuItemId=c.key,I.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===ja&&(u=b.commandPreviewId);
break;case "ComboBoxRevertPreviewPayload":u=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=Qa.a.AM(f.payload);for(ja of c)I[ja]=f.payload[ja];break;default:this.jcc(f.payload,this.iim,l),I.launcherId=f.payload.launcherId}break;case "InkFlyoutAnchorModel":this.jcc(f.payload,this.Fim,l);I.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":I[Hw.Color]=f.payload.selectedColorId;
I.colorRGB=f.payload.color;break;case "ColorPickerPreviewPayload":u=b.commandPreviewId;I[Hw.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":u=b.commandRevertId;break;default:return}break;case "SpinButtonModel":I[Un.Number]=f.payload.value;I[Un.UnitType]=Re.a.t6b(f.payload.unitType.toLowerCase());I[Un.Text]=f.payload.reservedValue;break;case "SliderModel":I[Lp.Value]=f.payload.value;break;case "InsertTableModel":I[Jy.Rows]=f.payload.rows;I[Jy.Columns]=f.payload.columns;
break;case "CheckboxModel":I[Xh.a.On]=f.payload.checked;I.MenuItemId=b.menuItemId;I.TerminalParentControlId=f.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.jcc(f.payload,this.Fjm,l)){I.launcherId=f.payload.launcherId;break}this.B$f(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":I.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":u={};u[f.payload.launcherId]=c;this.DRa.Tsc(u,fh.g(f.payload));this.r7a[a]=
new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":I.MenuItemId=f.payload.url;this.mAk(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":I.MenuItemId=f.payload.assetId;I.SourceControlId=a;A.AFrameworkApplication.fa.getBooleanAppSetting("BackstagePremiumTemplateExperienceEnabled")&&(I.IsPremium=f.payload.isPremium||!1);this.nAk(f.payload.pageId);break;case "CoauthorGallery":I.RenderTime=f.triggerTime;break;case "PeopleWell":I.RenderTime=
f.triggerTime;break;case "SyncStatus":I.SourceControlId=a;break;case "InputBoxModel":I.Text=f.payload.newValue;break;case "PersonaButtonModel":I.CommandValueId=f.payload.commandValueId;this.kYj(f.payload);break;case "MultiActionButtonModel":I.CommandValueId=f.payload.commandValueId;I.Href=f.payload.href;I.SourceControlId=a;I.Type=f.payload.type;I.TerminalParentControlId=f.payload.terminalParentControlId;this.IEa();break;default:return}u&&!this.isShadowMenuOpen(f.payload)&&(f.payload&&"terminalParentControlId"in
f.payload&&(I.ParentMenuId=f.payload.terminalParentControlId),I.CommandValueId||(I.CommandValueId=I.MenuItemId),b.legacyControlId&&(I.LegacyId=b.legacyControlId),I.SourceControlId||(I.SqmControlId=a),this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&I.launcherId&&(b=this.Hm.getCommandByExternalUxId(I.launcherId))&&(I.launcherCommandId=parseInt(b.commandId)),f.payload&&!Yj.b(f.payload.PRIReadinessCheck)&&(I.PRIReadinessCheck=f.payload.PRIReadinessCheck,
this.MCf=!0),f.payload&&!Yj.b(f.payload.shouldTakeFocus)&&(I[Tn.a.pca]=f.payload.shouldTakeFocus),b=this.eZd(f,I),Yj.b(f.triggerTime)||(T.TriggerTime=f.triggerTime),f.payload&&!Yj.b(f.payload.userActionKey)&&(T.userActionKey=f.payload.userActionKey),this.B7e(T,f,a,u),this.nUd.executeCommand(u,I,this.getSelectedTabId(),b,!0,()=>{this.LRe(I,a)},T,fh.g(f.payload)))}B7e(a,b,c,f){if(this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&b.payload){const l=
!Yj.b(b.payload.launcherId);c=this.WIh(this.KGj(l?b.payload.launcherId:c,f),f,!1);a.ControlId=c;const u=b.payload.inputMethod,I=b.payload.location;Yj.b(u)||Yj.b(I)||this.xzk(1===u,2===u||3===u||4===u,l&&("Overflow"===I||"ToolBarOverflow"===I)||"TabSwitchPayload"===b.payload.type,c,I)}this.La&&this.La.getBooleanAppSetting("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.WIh(b.payload.terminalParentControlId,f,
!0))}xzk(a,b,c,f,l){this.zEc||(this.zEc={});const u=[];l=jD.a.W0("UILocation",l,2);Array.add(u,l);if(l=this.getSelectedTabId())l=jD.a.W0("Tab",l,2),Array.add(u,l);this.zEc[f]||c||(this.zEc[f]=1,b?this.phc("DistinctUserInitiatedTerminalCommand",u):a&&this.phc("DistinctUserInitiatedKeyboardCommand",u));b?c?this.phc("UserInitiatedNavigationalCommand",u):this.phc("UserInitiatedTerminalCommand",u):a&&this.phc("UserInitiatedKeyboardCommand",u)}phc(a,b){hp.b(a,null,0,!0,0,b)}WIh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;
da.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}KGj(a,b){b=parseInt(b);b=ff.ActionManager.H5d(b)||ff.ActionManager.Xda(b)||"";return!Yj.b(b)&&b in this.nWb?this.nWb[b]:100<a.length?"":a}zAe(){this.uO&&this.uO.execute(a=>{a.pAe("ModernFontPickerExperience")})}eZd(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&
a.payload.inputMethod&&(c=a.payload.inputMethod,b[Tn.a.Gv]=c);return c}LRe(a,b){const c=Object(gb.a)(K.AFrame,A.AFrameworkApplication.za);if(this.Wd&&this.eQh(a)){if(!this.Wd.Je&&c){let f="null";if(a){const l=a.Value;delete a.Value;f=Qa.a.toJSON(a);Yj.b(l)||(a.Value=l)}da.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",b,f,c.gNa)}this.Wd.Kdg()}(this.Wd&&this.Wd.Je&&this.Wd.Je.name!==
K.AFrame.mQ&&c&&this.Wd.Je.name!==c.gNa||this.eQh(a))&&this.TVi(a)}eQh(a){return!!a&&!Yj.b(a[Tn.a.pca])&&a[Tn.a.pca]}TVi(a){Tn.a.Gv in a&&1===a[Tn.a.Gv]&&Hy.ShyRibbon.qTa(1,0)}O_j(a,b){fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.IEa();this.VQ.Ssc();if(this.$mi&&this.Ca){const c={};c[RA.kWh]=b.payload.tabId;this.Ca.Ia(N.a.Nvd,2,c,this.Vcb(b));Yj.b(b.payload.inputMethod)||(this.Ca.nb(N.a.NFh,2),this.fMc||this.R1l(b.payload.tabId))}b=
b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.Hm.kle(b);da.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.uO&&b){const c=b+"TabSwitchActivity";this.uO.execute(f=>{f.pAe(c)})}}jcc(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}kYj(a){a=a.type;"MenuOpenPayload"===a?A.AFrameworkApplication.MVh=!0:"MenuClosePayload"===a&&(A.AFrameworkApplication.MVh=!1)}Tgl(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&
"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.Hm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.DRa.dYe(f,b,a.payload))&&c in this.r7a&&delete this.r7a[c],a):!1}getSelectedTabId(){return this.Pxd?appChrome.selectors.getSelectedTabId():null}tUb(a,b,c){this.DRa.Tsc(a,c);this.r7a[b]=new Date}WRb(a,b){let c=!0;a in this.r7a&&(c=this.r7a[a].getTime()<this.VQ.b$c.getTime());return c&&!b&&this.Pxd}B$f(a,b){const c={};var f=a.payload.selectedGalleryId;
const l=this.Hm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!Yj.b(a.payload.shouldTakeFocus)&&(c[Tn.a.pca]=a.payload.shouldTakeFocus);this.PHj(a.payload,c);(f=this.Vcb(a))||(f={});this.B7e(f,a,b,l.commandId);const u=this.eZd(a,c);this.nUd.executeCommand(l.commandId,c,this.getSelectedTabId(),u,!0,()=>{this.LRe(c,b)},f,fh.g(a.payload))}}djj(a,b){const c=this.Hm.getCommandByExternalUxId(b);
if(c){const f={};f.SourceControlId=b;f.MenuItemId=b;f.SqmControlId=b;a.payload&&!Yj.b(a.payload.shouldTakeFocus)&&(f[Tn.a.pca]=a.payload.shouldTakeFocus);let l=this.Vcb(a);l||(l={});this.B7e(l,a,b,c.commandId);const u=this.eZd(a,f);this.nUd.executeCommand(c.commandId,f,this.getSelectedTabId(),u,!1,()=>{this.LRe(f,b)},l,fh.g(a.payload))}}PHj(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=a.character)}Q8e(a,b){a.payload&&"toggled"in a.payload&&(b[Xh.a.On]=a.payload.toggled)}BVk(a,b){"MenuOpen"===
a?!this.E7a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.E7a.kMb():"MenuClose"===a&&this.E7a&&this.E7a.a7k()}IEa(){this.E7a&&this.E7a.XTe()}Vcb(a){let b=null;Yj.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}aWj(a,b,c){if(this.gei&&this.Ca){const f={};f[iD.dsc]=c;this.Ca.Ia(N.a.xEl,2,f)}this.tUb(b.pageControlIdMap,a,fh.g(b))}nAk(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.nb(N.a.MEl,2);break;case "FileNewPage":this.Ca.nb(N.a.NEl,2)}}mAk(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.nb(N.a.FEl,
2);break;case "FileOpenPage":this.Ca.nb(N.a.GEl,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}R1l(a){if(A.AFrameworkApplication.fa.getBooleanAppSetting("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.uO.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.fMc=!0;else{if(A.AFrameworkApplication.fa.getBooleanAppSetting("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.uO.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),
3===++this.ppi)){this.fMc=!0;return}A.AFrameworkApplication.fa.getBooleanAppSetting("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.nb(N.a.Bob,2)&&(this.fMc=!0)}}QRi(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.MCf&&appChrome.PRIToastManager.dismissToast()}xcm(a){!this.lzf&&this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(a=fh.g(a.payload),31===a||14===a||15===a||2===a)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>
{const b=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback");b&&b.execute(c=>{c.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.lzf=!0)}}Object(m.a)(eI,"ReactExecuteCommandHandler",null,[]);class fI{constructor(){this.Gbg=null}get iif(){return 0}T2a(){}wua(){return!1}E3(){return!1}get iKh(){return null}dT(){}Iue(){return!1}XSa(){}PUa(){}refresh(){}get controls(){return null}zSc(){}Ssc(){}get bca(){return null}set bca(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(m.a)(fI,"ReactRibbonExternal",null,[628,569,570]);var IR=d(277);class gI{constructor(a,b,c,f){this.t5k=(l,u)=>{if((l=Object(gb.a)(K.AFrame,A.AFrameworkApplication.za))&&u.ejh&&A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Zfa){const I=appChrome.selectors.getShyState();I.isActive&&u.ejh.name===l.gNa&&Hy.ShyRibbon.qTa(I.state,1)}};this.uHh=()=>4;this.tHh=()=>4;this.sHh=()=>{fh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Zfa&&
appChrome.selectors.getShyState().isActive&&Hy.ShyRibbon.qTa(1,0),this.Wd.Df(K.AFrame.PX));return 4};this.a9k=l=>{l.hc&&l.hc.target&&"input"!==l.hc.target.tagName.toLowerCase()&&l.hc.preventDefault();return!1};this.Wd=a;this.Ca=b;this.qIf=c;this.Utb=f}initialize(){this.Ca.xa(N.a.ZPb,Le.a.frame,this.uHh);this.Ca.xa(N.a.YPb,Le.a.frame,this.tHh);this.Ca.xa(N.a.vwd,Le.a.frame,this.sHh);var a=ws.a.Qpe(this.Utb,this.qIf,!1);a.uK=!0;this.fvc(a,N.a.ZPb,N.a.YPb);a.bindAction(B.KeyInputManager.Va(H.a.E_,0),
N.a.vwd);a=this.Wd.Kc(K.AFrame.mQ);a.uK=!0;this.fvc(a,N.a.zua,N.a.zua);Ta.a.instance.xb(la.a.mouseDown,this.qIf,this.a9k);a=IR.a.instance;fh.a("enterKeytipMode")&&a.jRb(this.Utb,()=>{appChrome.api.enterKeytipMode(!1)});fh.a("exitKeytipMode")&&a.zxc(this.Utb,()=>{appChrome.api.exitKeytipMode();Hy.ShyRibbon.qTa(1,0)});A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Zfa&&(a=Object(gb.a)(F.FocusManager,this.Wd))&&a.Zyi(this.t5k)}Dak(a){a=ws.a.Qpe(a,document.getElementById("WACToolbarContainer"),
!1);a.uK=!0;this.fvc(a,N.a.ZPb,N.a.YPb)}fvc(a,b,c){const f=B.KeyInputManager.Va(H.a.zs,0),l=B.KeyInputManager.Va(H.a.zs,4);a.Sy(f);a.Sy(l);a.bindAction(f,b);a.bindAction(l,c)}dispose(){this.Ca.YI(N.a.ZPb,Le.a.frame,this.uHh);this.Ca.YI(N.a.YPb,Le.a.frame,this.tHh);this.Ca.YI(N.a.vwd,Le.a.frame,this.sHh)}}Object(m.a)(gI,"ReactRibbonFocusManager",null,[106]);class kD{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(m.a)(kD,"CommandSqmInfo",null,[]);var Ky=
d(359),Ly;(function(a){a[a.Fsm=0]="UnspecifiedGallery";a[a.Bqm=1]="CharacterCodeGallery";a[a.Xqm=2]="FontStyleGallery";a[a.krm=3]="InkThicknessGallery";a[a.drm=4]="IconGallery";a[a.vrm=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.Mrm=7]="PageNumberGallery";a[a.zqm=8]="ChangeColorsGallery"})(Ly||(Ly={}));Object(m.b)("GalleryType",Ly);class pp{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(pp,"CommonGalleryButtonProps",null,[]);class WA extends pp{constructor(){super();
this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(WA,"AdditionalTableStyleGalleryButtonProps",pp,[]);class hI extends WA{constructor(){super()}}Object(m.a)(hI,"AdditionalChangeColorsGalleryButtonProps",WA,[]);class iI extends pp{constructor(){super();this.character=null}}Object(m.a)(iI,"AdditionalCharacterCodeGalleryButtonProps",pp,[]);class jI extends pp{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(jI,"AdditionalFontStyleGalleryButtonProps",
pp,[]);class kI{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(kI,"AdditionalGalleryProperties",null,[]);class lI extends pp{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.role=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(lI,"AdditionalIconButtonProperties",pp,[]);class mI extends pp{constructor(){super();
this.styleDisplayName=null}}Object(m.a)(mI,"AdditionalInkThicknessGalleryButtonProps",pp,[]);class nI extends pp{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(nI,"AdditionalListGallerButtonProps",pp,[]);class oI extends pp{constructor(){super();this.text=null}}Object(m.a)(oI,"AdditionalPageNumberGalleryButtonProps",pp,[]);var XA=d(683),an=d(956),pI=d(1167);class lD{}lD.Text="Text";Object(m.a)(lD,"TextBoxCommandProperties",null,[]);var bn=d(301);const JR=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();
if(c=Object(gb.a)(Object,c[a])){if((a=Object(gb.a)(String,c.value))&&a===b)return!1;a=Object(gb.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:null;let f=null;for(let l=0;l<c.length;l++){const u=Object(gb.a)(Object,c[l]);if(Object(gb.a)(String,u.key)===a){f=u;break}}if(f&&Object(gb.a)(String,f.text)===b)return!1}}return!0},rI=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(YA(a,c[Xh.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,
c[Xh.a.On]));break;case "ComboBoxModel":if(A.AFrameworkApplication.fa&&(A.AFrameworkApplication.fa.getBooleanAppSetting("ReactRibbonDispatchActionFilter")||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!JR(a,c[Po.a.Value]))break;(b=c[Po.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[Po.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[Po.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,
c[uo.SelectedFont]));break;case "SplitButtonModel":f.push(YA(a,c[pI.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,c[Un.Number],Re.a.u6b(c[Un.UnitType]),c[Un.Text],c[Un.MaxValue],c[Un.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[Hw.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[an.a.Text]));break;case "CompoundButtonModel":c[Xh.a.Description]&&
f.push(appChrome.actions.updateCompoundButtonDescription(a,c[Xh.a.Description]));Xh.a.On in c&&f.push(YA(a,c[Xh.a.On]));break;case "SliderModel":c.snapToStep?f.push(appChrome.actions.updateSliderSelectedValue(a,c[Lp.Value])):f.push(appChrome.actions.updateSliderValue(a,c[Lp.Value],c[Lp.MinValue]||0,c[Lp.MaxValue],c[Lp.Text]));break;case "FlyoutAnchorModel":XA.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[XA.a.ImageIsVisible]));Xh.a.On in c&&f.push(YA(a,c[Xh.a.On]));break;
case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[lD.Text]))}b=f;var l=Object(gb.a)(String,c[bn.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,l));qI(a,c,f);b=f;(l=Object(gb.a)(Object,c[bn.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(gb.a)(String,c[bn.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[bn.a.nBh])?c[bn.a.nBh]:null)&&a.push.apply(a,c);
return f}return null},Tu=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),YA=(a,b)=>appChrome.actions.toggleButton(a,b),qI=(a,b,c)=>{b=Object(gb.a)(String,b[bn.a.Icon]);void 0!==b&&null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class sI{constructor(a,b,c,f){this.Hm=f;this.Ssa=a;this.VL=b;this.Vtb=c;this.iZb={}}chl(a,b,c,f,l){l=void 0===l?null:l;const u=a.ExternalGalleryId||a.ExternalId;var I=a.ExternalId;f.push(u);if(appChrome.selectors.isControlDefined(u))a.GalleryStyle&&
fh.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(u,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(u,Object.assign(new kI,{columns:a.Width,sections:[appChrome.api.gallerySection([],I)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!A.AFrameworkApplication.fa&&(A.AFrameworkApplication.fa.getBooleanAppSetting("ReactRibbonDispatchActionFilter")||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1));if(fh.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){I=[];const ja=[],ua=[],Ra={};for(var T of a.GallerySections){I.push(appChrome.api.gallerySection([],T.SectionId,T.Title));0===c&&T.GalleryButtons&&0<T.GalleryButtons.length&&(c=T.GalleryButtons[0].Type);f&&this.Qmg(T.GalleryButtons,l,Ra);const eb=this.$Yd(ja,T.GalleryButtons,Ra);ja.push.apply(ja,this.Mje(eb,u,T.SectionId,!1,c,l,!0,Ra));ua.push.apply(ua,eb)}b.push(appChrome.actions.setGallerySections(u,I));b.push.apply(b,
ja);b.push.apply(b,this.Uhe(u,Ly[c],ua,null,5===a.Type,!0,null,Ra))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),T=f?this.Qmg(a.GalleryItems,l,null):null,b.push.apply(b,this.Mje(this.$Yd(b,a.GalleryItems,T),u,I,!1,c,l,!1,T))}OIj(a,b){const c=[];let f=null,l=!1;if(!a)return null;const u=this.Ssa.Rsc(this.VL,a.commandId,b);c.push(Tu(a.externalUxCommand,!u));if(a.previewControlIds){const ja=[];for(let ua=0;ua<a.previewControlIds.length;ua++){var I={},T=a.previewControlIds[ua];
I.SourceControlId=T;const Ra=this.Hm.getCommandByExternalUxId(T);this.u1c(Ra||a,I);I[an.a.On]&&(f=I.SourceControlId,I[an.a.HighlightOn]&&(l=!0));qI(T,I,c);if(I=Object(gb.a)(Ky.a,I[an.a.GalleryButtonProps]))ja.push(I),u&&(T=this.Ssa.Rsc(this.VL,I.Command,b),I.IsDisabled=!T)}0<ja.length&&c.push.apply(c,this.Mje(this.$Yd(c,ja),a.externalUxCommand,a.externalUxCommand,!0,ja[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(da.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",
f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}$Yd(a,b,c){c=void 0===c?null:c;const f=[],l=[];for(let I=0;I<b.length;I++){const T=b[I],ja=Yj.a(T.ExternalId)?T.Id:T.ExternalId;f.push(ja);const ua=c&&c[ja]?c[ja].result:-1;switch(T.Type){case 1:var u=T;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(ja,Object.assign(new iI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,character:u.Character,style:u.Style,title:u.Alt})));break;case 2:u=T;l.push(appChrome.api.createFontStylesGalleryButtonModel(ja,
Object.assign(new jI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,styleDisplayName:u.LabelText,style:u.Style,title:u.Alt,previewStyleLabel:u.PreviewStyleLabel})));break;case 3:u=T;l.push(appChrome.api.createInkThicknessGalleryButtonModel(ja,Object.assign(new mI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,styleDisplayName:u.LabelText,style:u.Style,title:u.Alt})));break;case 4:u=T;l.push(appChrome.api.createIconGalleryButtonModel(ja,Object.assign(new lI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,icon:[u.Icon],
role:u.Role,fullIconStyle:u.FullIconStyle,previewIconStyle:u.PreviewIconStyle,largePreviewIconStyle:u.LargePreviewIconStyle,label:u.LabelText,title:u.Alt})));break;case 5:u=T;l.push(appChrome.api.createListGalleryButtonModel(ja,Object.assign(new nI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,infoAtLevel:u.LevelInfo,ariaLabel:u.Alt})));break;case 6:u=T;l.push(appChrome.api.createTableStyleGalleryButtonModel(ja,Object.assign(new WA,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,tableCellStyles:u.TableCellStyles,
tableStyles:u.TableStyles,title:u.Alt,columns:u.columns})));break;case 8:u=T;l.push(appChrome.api.createChangeColorsGalleryButtonModel(ja,Object.assign(new hI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,tableCellStyles:u.TableCellStyles,tableStyles:u.TableStyles,title:u.Alt})));break;case 7:u=T,l.push(appChrome.api.createPageNumberGalleryButtonModel(ja,Object.assign(new oI,{disabled:-1!==ua?1>(ua&1):u.IsDisabled,text:u.Text,title:u.Alt})))}this.Hm.addCommandToMaps(Object.assign(new Xa.a(ja,T.Command),
{queryCommandId:T.QueryCommand,menuItemId:T.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}Mje(a,b,c,f,l,u,I,T){u=void 0===u?null:u;I=void 0===I?!1:I;T=void 0===T?null:T;const ja=[];f?ja.push(appChrome.actions.populateGalleryItems(b,a)):(this.iZb[b]=!1,I||(f=!0,appChrome.selectors.isControlDefined(b)&&(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),ja.push.apply(ja,this.Uhe(b,Ly[l],a,null,5===l,f,u,T))),ja.push(appChrome.actions.updateGallerySectionItems(b,
c,a)));return ja}aCj(a){return this.Uhe(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}Uhe(a,b,c,f,l,u,I,T){u=void 0===u?!0:u;I=void 0===I?null:I;T=void 0===T?null:T;const ja=[];if(a in this.iZb){if(this.iZb[a])return delete this.iZb[a],ja;this.iZb[a]=!0}let ua=null,Ra=-1;if(c)({cfg:Ra,returnValue:ua}=this.cKf(b,c,ja,u,I,T));else if(f)for(const eb of f)(c=(()=>{let Bb=this.cKf(b,eb.galleryButtons,ja,u,null,T);({cfg:Ra}=Bb);
return Bb})().returnValue)&&(ua=c);ja.push(appChrome.actions.updateGallerySelectedId(a,ua));u&&ja.push(Tu(a,!1));l&&0<Ra&&ja.push(appChrome.actions.updateListGalleryTextDirection(a,2===Ra));return ja}Pmg(a,b){const c={},f={};f.SourceControlId=a;f.Location=void 0===b?null:b;a=this.Hm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.u1c(a,f);c.result=a;c.props=f;return c}Qmg(a,b,c){b=void 0===b?null:b;(c=void 0===c?null:c)||(c={});for(const f of a)a=Yj.a(f.ExternalId)?f.Id:f.ExternalId,
c[a]=this.Pmg(a,b);return c}cKf(a,b,c,f,l,u){l=void 0===l?null:l;u=void 0===u?null:u;let I,T=null;I=-1;let ja=!1;for(const Ra of b){var ua=this.ZBj(a);b=u&&u[Ra]&&-1!==u[Ra].result?u[Ra]:this.Pmg(Ra,l);const eb=b.result;b=b.props;f&&c.push(Tu(Ra,1>(eb&1)));(ua=rI(Ra,ua,b,eb))&&c.push.apply(c,ua);b[an.a.On]&&(T=Ra,b[an.a.HighlightOn]&&b[an.a.HighlightOn]&&(ja=!0));void 0!==b[bn.a.labelText]&&null!==b[bn.a.labelText]&&(ua=this.Hm.getCommandByExternalUxId(Ra),c.push(appChrome.actions.setControlLabel(ua.externalUxCommand,
b[bn.a.labelText])));b[an.a.IsRtl]&&0>I&&(I=b[an.a.IsRtl])}ja&&(da.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",T),c.push(appChrome.actions.highlightSelectedFontStyle(T)));return{returnValue:T,cfg:I}}ZBj(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";
case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}u1c(a,b){b.MenuItemId=a.menuItemId;return this.Ssa.Trd(this.VL,this.Vtb,a.commandId,a.queryCommandId,b)}}Object(m.a)(sI,"ReactGalleryPoller",null,[]);var KR=d(596),ZA=d(815),LR=d(818);class mD extends Eg.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(mD,"CompoundButtonProps",Eg.a,
[]);var MR=d(957),gr=d(595),tI=d(816),NR=d(958);class uI{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(uI,"PopulateFontPickerDataProps",null,[]);var xs=d(417);class vI extends op{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(vI,"OptionalCompoundButtonProperties",op,[]);class wI extends op{constructor(){super();this.onRetryCommandId=
this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(m.a)(wI,"OptionalErrorViewProperties",op,[]);class xI extends op{constructor(){super();this.isBanner=null}}Object(m.a)(xI,"OptionalLabelProperties",op,[]);class yI extends op{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(yI,"OptionalMultipActionButtonProperties",
op,[]);class zI extends Fw{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(zI,"OptionalPersonaButtonProperties",Fw,[]);class $A extends op{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)($A,"OptionalToggleButtonProperties",op,[]);var OR=d(960),PR=d(959),aB=d(479);class AI{constructor(){this.FYf=this.actions=null;this.D5h=!1}}Object(m.a)(AI,"PopulateActions",null,[]);class nD{fpg(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);
case "ToggleButtonModel":return this.kJj(a);case "InkButtonModel":return this.jJj(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}kJj(a){const b={};b[Xh.a.On]=appChrome.selectors.getButtonToggleState(a);return b}jJj(a){const b={};b[Xh.a.On]=fh.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);
return b}}Object(m.a)(nD,"ReactStatePropsSelector",null,[]);class bB{constructor(a,b,c,f,l){this.Ssa=a;this.VL=b;this.Vtb=c;this.Hm=f;this.fWd={};this.lmi=new nD;this.g8a=l}LSh(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.fWd}HJj(a,b,c){c=void 0===c?null:c;const f=[],l={};if(!this.LSh(a)){const u=a.populationProps.populateQueryCommandId,I={};I.MenuId=a.externalUxCommand;I.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.Ssa.Trd(this.VL,
this.Vtb,u,u,I,this.oDj(c))&1))if("FontPickerModel"===b)this.fWd[u]=!0,f.push(bB.zIj(a,I)),l[a.externalUxCommand]="FontPickerModel";else if(I.MenuItems)switch(this.fWd[u]=!0,b){case "ComboBoxModel":f.push(bB.xIj(a,I));l[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.sqg(a.externalUxCommand,b,I.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new AI,
{actions:f,FYf:l,D5h:this.isShadowMenuOpen(c)})}slg(a,b,c,f,l,u,I,T,ja){ja=void 0===ja?null:ja;let ua=null;const Ra=[];Yj.b(a.Title)||(ua=a.Title);for(let eb=0;eb<a.ControlList.length;eb++){const Bb=Object(gb.a)(Ay.a,a.ControlList[eb]);if(!Bb||Bb.ExternalId)u&&this.axj(Bb,u),b.push.apply(b,this.yIj(Bb,I,Ra,l,c,f,ja))}return T?appChrome.api.menuSection(Ra,ua,a.Lang):null}sqg(a,b,c,f,l){l=void 0===l?null:l;const u=[],I=[],T=[],ja=[];for(var ua=0;ua<c.MenuSectionList.length;ua++){var Ra=Object(gb.a)(dl.a,
c.MenuSectionList[ua]);Ra&&(Ra=this.slg(Ra,u,a,b,ja,f,I,c.UpdateDynamically,l),c.UpdateDynamically&&T.push(Ra))}ua=null;c.MenuFooterSection&&(ua=this.slg(c.MenuFooterSection,u,a,b,ja,f,I,c.UpdateDynamically,l));c.UpdateDynamically&&u.push(appChrome.actions.updateMenu(a,T,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,ua,c.IsFlexLayout));0<I.length&&u.splice(0,0,appChrome.actions.addControls(I));0<ja.length&&fh.d("setStatefulSplitButtonMruBypassControls")&&u.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,
ja));return u}axj(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(gb.a)(ZA.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}yIj(a,b,c,f,l,u,I){I=void 0===I?null:I;const T=[];switch(a.ControlType){case 14:A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(f=Object(gb.a)(tI.a,a),null!=f.IsBanner&&f.IsBanner&&this.Kgl(Object(gb.a)(tI.a,a),T,b,c));break;case 1:case 3:a=Object(gb.a)(Eg.a,a);this.Lgl(a,T,b,c);a.MenuItemsStatefulData&&fh.d("setStatefulSplitButtonMenuItemsStatefulData")&&T.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,a.MenuItemsStatefulData));break;case 2:this.Chl(Object(gb.a)(aB.a,a),T,b,c);break;case 6:this.Ogl(Object(gb.a)(KR.a,a),T,b,c);break;case 4:this.uhl(Object(gb.a)(ps,a),T,b,c);break;case 7:this.Pgl(Object(gb.a)(ZA.a,
a),T,b,c);break;case 12:this.Vgl(Object(gb.a)(MR.a,a),T,b,c);break;case 13:this.ohl(Object(gb.a)(NR.a,a),T,b,c);break;case 9:a=Object(gb.a)(ty.a,a);this.Ygl(a,T,b,c);"StatefulSplitButtonModel"===u&&f.push(a.ExternalId);break;case 8:this.g8a.chl(Object(gb.a)(gr.a,a),T,b,c,I)}return T}Kgl(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,
a.IconName))):(b=null,a.IconName&&0<a.IconName.length&&(b=new Mp.a(a.IconName)),c.push(appChrome.api.createLabelModel(a.ExternalId,a.LabelText,a.Id,Object.assign(new xI,{isBanner:a.IsBanner,iconSet:b?b.iconSet:null}))))}Lgl(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&
b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.ZOc()&&((c=this.pva(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Mp.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(gc.a)(mD,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new vI,{iconSet:(new Mp.a(this.pva(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,
ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):(f=a.DismissHostingSurfaceOnExecute,c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new Fw,{iconSet:(new Mp.a(this.pva(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==f&&null!==f?f:!0})))),this.Hm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&fh.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}Ogl(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.ZOc()&&((c=this.pva(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,
(new Mp.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new $A,{iconSet:(new Mp.a(this.pva(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),
this.Hm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}Vgl(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):(b=null,a.IconName&&0<a.IconName.length&&(b=new Mp.a(a.IconName)),c.push(appChrome.api.createErrorViewModel(a.ExternalId,
Object.assign(new wI,{label:a.Label,retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId,ariaDescription:a.AriaDescription,iconSet:b?b.iconSet:null}))))}ohl(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(c={},a.Label&&(c.label=a.Label),a.SecondaryLabel&&(c.secondaryLabel=a.SecondaryLabel),a.Details&&(c.details=a.Details),a.Description&&(c.description=a.Description),a.iconSet&&(c.iconSet=a.iconSet),a.Links&&(c.links=a.Links),a.CommandValueId&&(c.commandValueId=
a.CommandValueId),a.ActionCommandValueId&&(c.actionCommandValueId=a.ActionCommandValueId),a.ActionCommandId&&(c.actionCommandId=a.ActionCommandId),a.CommandId&&(c.commandId=a.CommandId),b.push(appChrome.actions.updateMultiActionButton(a.ExternalId,c))):(c.push(appChrome.api.createMultiActionButtonModel(a.Id,Object.assign(new yI,{label:a.Label,secondaryLabel:a.SecondaryLabel,actionText:a.ActionText,description:a.Description,iconSet:a.iconSet,links:a.Links,details:a.Details,actionId:a.ActionId,commandId:a.CommandId,
actionCommandId:a.ActionCommandId||a.ActionId,commandValueId:a.CommandValueId,actionCommandValueId:a.ActionCommandValueId||a.CommandValueId}))),a.CommandIdMapped&&this.Hm.addCommandToMaps(new Xa.a(a.CommandId,a.CommandIdMapped)),a.ActionIdMapped&&this.Hm.addCommandToMaps(new Xa.a(a.ActionId,a.ActionIdMapped)))}Chl(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.ZOc()&&((c=this.pva(a))&&
0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Mp.a(c)).iconSet)),A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new $A,{iconSet:(new Mp.a(this.pva(a))).iconSet,
iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:a.ToggleUsingIcon}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new $A,{iconSet:(new Mp.a(this.pva(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,toggleUsingIcon:a.ToggleUsingIcon}))),this.Hm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}uhl(a,b,c,f){f.push(a.ExternalId);f=this.iIj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):fh.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new zI,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}Ygl(a,
b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.ZOc()&&((c=this.pva(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Mp.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,
a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new HA,{iconSet:(new Mp.a(this.pva(a))).iconSet,keytip:a.KeyTip,hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.Hm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new Fh(a.PopulateQueryCommand,
a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.sqg(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}Pgl(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(f=this.lmi.fpg(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.Hm.addCommandToMaps(Object.assign(new Xa.a(a.McuExternalId,
a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Hm.addCommandToMaps(Object.assign(new Xa.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const l=[];for(let u=0;u<a.Colors.length;u++){const I=a.Colors[u],T=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",!1)?I.Disabled:
!1;u<f?c.push(appChrome.api.colorPickerCell(I.Color,I.DisplayColor,I.Alt,T)):l.push(appChrome.api.colorPickerCell(I.Color,I.DisplayColor,I.Alt,T))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}pva(a){return a.Image32by32Class?
this.Hm.Xig(a.Image32by32Class):a.Image16by16Class?this.Hm.Xig(a.Image16by16Class):a.ExternalImageId}iIj(a){return a?Object.assign(new PR.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new OR.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}oDj(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}ZOc(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static zIj(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,f)=>{Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(xs.a.AYa,!1).then(u=>{let I=b.fonts;u||l.isFreemiumUpsellEnabled()||(I=rd.a.MBa(I,T=>T.fontType!==xs.a.XYe));u=Object.assign(new uI,{commandId:a.externalUxCommand,fonts:I,isSubscriber:u,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
c(u)}).catch(f)})}))}static xIj(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let u=0;u<l.ControlList.length;u++){const I=Object(gb.a)(LR.a,l.ControlList[u]);I&&c.push(appChrome.api.comboBoxItem(I.MenuItemId,I.LabelText,I.Styles,I.CommandValueId,I.AriaLabel,I.Data,I.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+
f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(m.a)(bB,"ReactPopulateQueryCommandPoller",null,[]);class BI{constructor(a,b,c,f,l){this.Hm=c;this.Ssa=a;this.VL=b;this.Vtb=f;this.g8a=l}GJj(a,b,c){const f=[];if(this.mgk(b))a=this.INj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.u1c(a,c);bn.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[bn.a.visible]));f.push(Tu(a.externalUxCommand,1>(l&1)));
void 0!==c[bn.a.labelText]&&null!==c[bn.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[bn.a.labelText]));void 0!==b&&null!==b&&(l=rI(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.vvi(a.externalUxCommand,c,f))}return f}EAj(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var u=appChrome.selectors.getSplitButtonState(a);if(u=this.Hm.getCommandByExternalUxId(u.command))c=
this.Ssa.Rsc(this.VL,u.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),f.push(Tu(a,!1));return f;default:return null}b=!1;for(u in l)if(l=this.Hm.getCommandByExternalUxId(u),Yj.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.Ssa.Rsc(this.VL,l.commandId,c))return f.push(Tu(a,!1)),f;f.push(Tu(a,!b));return f}INj(a,b,c){switch(b){case "PreviewGalleryModel":return this.g8a.OIj(a,c);case "GalleryModel":return this.g8a.aCj(c)}return null}mgk(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}u1c(a,b){b.MenuItemId=a.menuItemId;return this.Ssa.Trd(this.VL,this.Vtb,a.commandId,a.queryCommandId,b)}vvi(a,b,c){const f=b[XA.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[XA.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.OQj(a,b))}OQj(a,b){return appChrome.actions.updatePeopleWell(this.Hwj(a),b)}Hwj(a){const b=[];var c={};a=this.Hm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.Ssa.Trd(this.VL,this.Vtb,
"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(m.a)(BI,"ReactQueryCommandPoller",null,[]);class CI{Trd(a,b,c,f,l,u){let I=0;a&&(this.Rsc(a,c,l)&&(I|=1),c=new kD,c.CommandLocation=
b,void 0!==u&&null!==u&&(c.InvocationMethod=u),!Yj.b(f)&&a.O$f(f,l,c)&&(I|=2));return I}Rsc(a,b,c){return a?a.Pfc(b,void 0===c?null:c):!1}}Object(m.a)(CI,"RootPoller",null,[]);class DI{constructor(a,b,c){this.Hm=a;this.VL=b;a=new CI;this.Voi=new nD;this.g8a=new sI(a,this.VL,c,this.Hm);this.jDf=new bB(a,this.VL,c,this.Hm,this.g8a);this.eDf=new BI(a,this.VL,this.Hm,c,this.g8a)}eWa(){const a=[];if(!fh.c())return a;a.push.apply(a,this.MQj());var b=this.Ozj();if(0<b.length)a.push.apply(a,b);else if(b=
appChrome.selectors.getActiveControlIds(),Object.keys(b).length){const c=this.Pzj();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,!0)),delete b[f];a.push.apply(a,this.C2c(b))}return a}Tsc(a,b){fh.c()&&(a=this.C2c(a,b),appChrome.api.dispatch(a))}dYe(a,b,c){c=void 0===c?null:c;if(!Yj.b(a)&&a.populationProps&&!this.jDf.LSh(a)){a=this.jDf.HJj(a,b,c);if(!a.D5h){let f;(f=a.actions).push.apply(f,this.C2c(a.FYf,fh.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),
!0}return!1}C2c(a,b){b=void 0===b?0:b;const c=[],f={};if(fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var u of appChrome.selectors.getVisibleControlsInGroup(l))f[u]=!0;for(const I in a)l=I,u=a[I],0===b&&f[l]&&(b=2),c.push.apply(c,this.LQj(l,u,b));return c}LQj(a,b,c){c=void 0===c?0:c;const f=[],l=this.Hm.getCommandByExternalUxId(a);
let u={};appChrome.selectors.isControlDefined(a)&&(u=this.Voi.fpg(a,b));u[Tn.a.tEd]=c;Yj.b(l)?(u.ExternalUxId=a,(a=this.eDf.EAj(a,b,u))&&0<a.length&&f.push.apply(f,a)):(u.MenuItemId=l.menuItemId,u.SourceControlId=a);f.push.apply(f,this.eDf.GJj(l,b,u));return f}MQj(){const a=[],b=!!A.AFrameworkApplication.fa&&(A.AFrameworkApplication.fa.getBooleanAppSetting("ReactRibbonDispatchActionFilter")||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());for(let u=0;u<c.length;u++){var l=this.Hm.kle(c[u]);if(l){l=this.VL.Pfc(l);let I=!0;b&&(I=0<=Array.indexOf(f,c[u]));b&&I===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[u],l))}}return a}Ozj(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.Hm.kle(a);c&&(this.VL.Pfc(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}Pzj(){var a=
appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.Hm.nCj(c))for(const f of a)this.VL.Pfc(f.commandId)||((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),b.push.apply(b,a));return b}}Object(m.a)(DI,"ReactRibbonRootPoller",null,[672]);class My{constructor(a,b,c){c=void 0===c?null:c;this.VL=this.uZb=this.DRa=null;this.imi=b;a.ovb(this);this.bca=c}get b$c(){this.uZb||(this.uZb=new Date,this.uZb.setTime(0));return this.uZb}set b$c(a){this.uZb=
a}get gIl(){return 2}get bca(){return this.VL}set bca(a){this.VL=a}get UOb(){this.DRa||(this.DRa=new DI(this.imi,this.bca,this.gIl));return this.DRa}zSc(){const a=document.activeElement;za.a.isEditable(a)&&a.blur()}executeCommand(a,b,c,f,l,u,I,T){T=void 0===T?2:T;Yj.b(this.bca)||(l=new kD,l.CommandLocation=T,l.InvocationMethod=f,l.CommandTabName=c,b[Tn.a.tEd]=T,this.bca.O$f(a,b,l,u,I),this.qzk(a,b))}eWa(){return Yj.b(this.bca)?[]:this.UOb.eWa()}Ssc(){const a=this.eWa();0<a.length&&(this.b$c=new Date,
appChrome.api.dispatch(a))}uUb(){fh.c()&&this.UOb.Tsc({PeopleWell:"PeopleWell"},18)}qzk(a,b){try{const c=Tb.a.instance.ub("Common.ISystemInitiatedFeedback");if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.pAe("Ribbon"+l)}}catch(c){da.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(m.a)(My,"ReactRibbonRoot",null,[570,670]);class oD{constructor(){this.Tsa=
[]}ovb(a){a&&!Array.contains(this.Tsa,a)&&Array.add(this.Tsa,a)}qDh(a){Array.remove(this.Tsa,a)}zSc(){for(const a of this.Tsa)a.zSc()}dispose(){this.Tsa=null}}Object(m.a)(oD,"RootManagerBase",null,[678,106]);class ys extends oD{constructor(){super()}static get instance(){return ys.Ja||ys.iak()}static iak(){ys.Ja=new ys;return ys.Ja}}ys.Ja=null;Object(m.a)(ys,"ReactRootManager",oD,[692,678]);class tq{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){T=void 0===T?null:T;ja=void 0===ja?!0:ja;ua=void 0===ua?null:
ua;Ra=void 0===Ra?null:Ra;this.DXb=this.FMc=this.AJd=this.VQ=null;this.vFf=[];this.z0b=null;this.Mol=()=>{A.AFrameworkApplication.fa.Ue(()=>{this.Ccj()})};this.zDk=()=>{if(A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Xp){var eb=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?eb.execute(Bb=>{Bb.logActivity("SingleRibbonModeActivity",null)}):"Multiline"===appChrome.selectors.getRibbonMode()&&eb.execute(Bb=>{Bb.logActivity("MultiRibbonModeActivity",
null)});if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeActivity")){eb=za.a.Mbc();const Bb=za.a.Lbc();hp.a("ScreenBucket_W_"+(1550<eb?"Large":1050<eb?"Medium":"Small")+"_H_"+(850<Bb?"Large":675<Bb?"Medium":"Small"))}}};this.caf=()=>{const eb=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback");eb&&eb.execute(Bb=>{Bb.logActivity("SingleLineToolBarOptOut",null)});return 32};this.Zyk=()=>{this.Ca.xa(N.a.Eff,Le.a.frame,Object(R.a)(this,
this.Eff,"triggerModeSwitcherTUI"));this.Ca.pa(N.a.caf,Le.a.frame,this.caf,96);const eb=Yi.a.YX(A.AFrameworkApplication.fa.Ea("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const Bb=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback");Bb&&(A.AFrameworkApplication.fa.getBooleanAppSetting("Fluent2StyleIsEnabled")?(Bb.execute(Ub=>{Ub.logActivity("VNextStylesOn",null)}),Bb.execute(Ub=>{Ub.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):A.AFrameworkApplication.fa.getBooleanAppSetting("Fluent2StyleFGOnlyIsEnabled")&&
eb&&Bb.execute(Ub=>{Ub.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)};this.Nxl=()=>{Cd.a.get_instance().Ij(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const eb=appChrome.api.getRibbonSubComponentMappings();for(const Ub in eb){var Bb=Ub;const Xb=eb[Ub];if(Xb)for(const tc of Xb)A.AFrameworkApplication.Pa.RU(tc)?appChrome.api.reportRibbonSubComponentBehaviorMapped(Bb):A.AFrameworkApplication.Pa.QRl(tc,this.h5i(Bb));else appChrome.api.reportRibbonSubComponentBehaviorMapped(Bb)}};
this.o8a=a;this.WQd=b;this.Utb=c;this.Wd=f;this.Ca=l;this.Hm=u;this.VQ=ua?ua:new My(ys.instance,this.Hm);this.k7a=I;this.hEf=new fI;this.KRa=T;this.rVd=ja;new bI;this.Ksf=Ra;Cd.a.get_instance().Ij(7,Object(R.a)(this,this.YSl,"setRibbonPostInteractiveReady"));Cd.a.get_instance().Ij(7,this.zDk);Cd.a.get_instance().Ij(19,this.Zyk);Cd.a.get_instance().Ij(7,this.Nxl);Cd.a.get_instance().Ij(7,this.Mol)}initialize(a,b,c){c=void 0===c?null:c;this.rVd||this.eJ(5);c?c.then(()=>{this.UEh()}).catch(()=>da.ULS.sendTraceTag(561394319,
340,10,"Failed to load the resources for the Ribbon")):aI.a.cYh(aI.a.cYh(wb.Task.WAA(this.lJg(a),this.kJg(tq.Ibi)),()=>this.kJg(tq.M$h)),()=>this.lJg(b)).continueWith(()=>{this.UEh()},11)}dispose(){this.sfm();this.z0b&&this.z0b.dispose();for(const a of this.vFf)Cd.a.get_instance().ITi(a);A.AFrameworkApplication.Pa.YI(N.a.HEl,Le.a.frame,ff.ActionManager.uh)}kJg(a){return Tb.a.instance.resolve("Common.ISharedDependencyLoader").LFb(A.AFrameworkApplication.Ui(a,2))}lJg(a){return""===a?wb.Task.ju(!0):
Tb.a.instance.resolve("Common.ISharedDependencyLoader").LFb(A.AFrameworkApplication.Ui(a,3))}Kxg(){(this.KRa||this.k7a)&&appChrome.api.dispatch(this.nqg());this.V8e();fh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(A.AFrameworkApplication.jra);this.VQ.Ssc()}UEh(){this.Kxg();this.rVd&&(appChrome.renderAppChrome(this.o8a,fh.e()),this.eJ(10));this.wJf();this.mQc();this.rVd&&this.eJ(5);this.R4c()}R4c(){this.Wd&&this.Ca&&this.Utb&&(this.z0b=new gI(this.Wd,this.Ca,this.o8a,this.Utb),this.z0b.initialize())}get THl(){return this.hEf}setCommandDefinitionMapping(){if(fh.a("setCommandDefinitionMapping")){const a=
GR(this.Hm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Zfa&&fh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{0===b&&this.hNb()})}wJf(){var a=void 0===a?null:a;this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(gb.a)(My,this.VQ);this.AJd=new eI(this.VQ,b.UOb,this.Hm,this.Wd,this.WQd,Tb.a.instance.ub("Common.IRibbonSQMInformation"),
Tb.a.instance.ub("Common.IFileMenuSQMInformation"),A.AFrameworkApplication.Pa,A.AFrameworkApplication.fa,Tb.a.instance.Ha("Common.ISystemInitiatedFeedback"),a);this.qIi();this.zUj()}qIi(){this.FMc=appChrome.api.bindCommandHandler((a,b)=>{this.AJd.executeCommand(a,b)})}sfm(){this.FMc&&(this.FMc(),this.FMc=null)}V8e(){appChrome.api.initializeLogger(new HR.a)}eWa(){return this.VQ?this.VQ.eWa():[]}hNb(){Xe.a.instance.bL(()=>{let a=null;Xe.a.instance.bL(()=>{a=this.eWa()},"RB:GA");a&&0<a.length&&(this.VQ.b$c=
new Date,Xe.a.instance.bL(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.DXb&&Xe.a.instance.bL(()=>{},"RB:J")},"RB:PFSU")}uUb(){this.VQ.uUb()}psi(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}nqg(){var a=A.AFrameworkApplication.fa;const b=[];a.getBooleanAppSetting("EnableTellMeForOneLineRibbonIsEnabled")?a.getBooleanAppSetting("OcpsIsEnabled")&&
Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));b.push.apply(b,this.cjg());a=new ZH.a(this.Hm);this.KRa.Fca&&(sq.Ncm(this.KRa.Fca),b.push.apply(b,a.Dfe(this.KRa.Fca)));if(this.KRa.TZh)for(const c of this.KRa.TZh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.Urj,
c.sectionId,c.Pcm));b.push.apply(b,a.ytj(this.KRa.Ocm));return b}cjg(){const a=[];if(this.k7a&&this.k7a.Fca){const c=this.k7a.Fca;for(const f in c){var b=c[f];const l=this.Hm.phe(f);if(l)for(const u of l)a.push(appChrome.actions.updateControlHiddenState(u,b))}}return a}nUb(a){a&&this.VQ.UOb.Tsc(a,0)}dYe(a){this.VQ.UOb.dYe(this.Hm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}g_l(a){Cd.a.get_instance().Ij(5,null).continueWith(()=>{appChrome.api.dispatch(this.FMj(a))})}Ccj(){const a=
A.AFrameworkApplication.fa.getBooleanAppSetting("ShareMenuIsEnabled")?"ShareMenu":"Share",b=A.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.okm(a,"Shared"===(b.SharingStatus||"")))}okm(a,b){return appChrome.actions.updateSharingStatusIndicator(a,b)}FMj(a){return appChrome.actions.updateControlHiddenState(a,!1)}GMj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}eJ(a){Cd.a.get_instance().eJ(a);this.vFf.push(a)}YSl(){fh.d("updateRibbonInitializationState")&&
appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new $H,{postRibbonInteractiveReady:!0})))}mQc(){this.k7a&&this.Ksf&&(this.DXb=this.Ksf.createFileMenu(this.k7a,this.VQ.bca),this.hEf.Gbg=this.DXb)}Fvk(){this.DXb&&this.DXb.Avk()}xwd(a,b,c){if(1===c)return 32;this.Fxc(!0);this.hNb();A.AFrameworkApplication.za.Gf();return 32}ywd(a,b,c){if(1===c)return 32;this.Fxc(!1);this.cTl();this.hNb();A.AFrameworkApplication.za.Gf();return 32}Eff(a,b,c){if(1===c)return 32;(a=
Tb.a.instance.Ha("Common.ISystemInitiatedFeedback"))&&a.execute(f=>{f.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}cTl(){Yi.a.lL(A.AFrameworkApplication.fa.Ea("IsSimplifiedRibbonOnCookieName"),"true",Yi.a.VK)}Fxc(a){Yi.a.lL(A.AFrameworkApplication.fa.Ea("ReactRibbonMLRPreferenceCookieName"),a.toString(),Yi.a.VK)}h5i(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}zUj(){if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&A.AFrameworkApplication.eNb.xYd){const a=A.AFrameworkApplication.eNb.xYd,b=A.AFrameworkApplication.eNb.dJf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:a;tq.zwd.Ib(c)?tq.zwd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.AJd.executeCommand(a,b))}}}tq.Ibi="common";tq.M$h=
"appChrome";tq.zwd=new FR.a(gD.a.Xqg());Object(m.a)(tq,"ReactRibbonUser",null,[671,181,106]);class pD{constructor(){this.label=this.value=null}}Object(m.a)(pD,"TextInfoSectionField",null,[]);class EI{constructor(a,b){this.Fca=b}}Object(m.a)(EI,"ReactRibbonJewelProperties",null,[]);class qD extends tq{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){super(a,b,f,l,u,I,T,void 0===ja?null:ja,void 0===ua?!0:ua,void 0===Ra?null:Ra,void 0===eb?null:eb);this.qGc=null;this.fMd=c;this.fMd.execute(Bb=>{this.qGc=Bb});
this.fMd.execute(Bb=>{this.VQ.bca=Bb})}eWa(){return this.qGc?(this.qGc.clearCache(),super.eWa()):[]}}Object(m.a)(qD,"ReactRibbonUser",tq,[]);class cB{static get Hlj(){const a=window.self.PowerPointWebEditor;return!(void 0===a||null===a)&&!(void 0===a.FakeHeader||null===a.FakeHeader)}static get pbg(){const a=window.self.PowerPointWebEditor;return!(void 0===a||null===a)&&!(void 0===a.FakeRibbon||null===a.FakeRibbon)}}Object(m.a)(cB,"FakeUtils",null,[]);var zs=d(180),rD=d(380),QR=d(733),sD=d(1163);class Ny{static get kGg(){return"teams"===
(A.AFrameworkApplication.fa.Ea(A.AFrameworkApplication.uL)||"").toLowerCase()}static get KPh(){return Ny.kGg?(ya.a.J(576030427,811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",A.AFrameworkApplication.iVa,A.AFrameworkApplication.gyb),A.AFrameworkApplication.iVa&&A.AFrameworkApplication.gyb):A.AFrameworkApplication.iVa}}Object(m.a)(Ny,"CopyLinkHelper",null,[]);class FI{constructor(a,b){this.FPe=null;this.ka=a;this.LRk=b}dispose(){this.FPe&&(xm.CuiHelper.ddj(this.FPe),this.FPe=null)}kQj(){if(A.AFrameworkApplication.workflowEnabled){let a=
"";switch(A.AFrameworkApplication.ECc){case "Assign":a=CommonUIStrings.l_Assign;break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new sD.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return A.AFrameworkApplication.nxe&&A.AFrameworkApplication.z2a||A.AFrameworkApplication.hCc?Object.assign(new sD.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:xm.CuiHelper.Kvd}):A.AFrameworkApplication.iVa?Object.assign(new sD.a,{command:"981334692",label:ResourceStrings.L_Share,
image:xm.CuiHelper.pWl,id:xm.CuiHelper.v9e}):null}ZYl(){if(Ny.kGg&&!this.LRk)return!1;const a=this.kQj();return a&&"981334692"===a.command?this.ka.IEg||this.ka.dok:!1}cZl(){ya.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",A.AFrameworkApplication.iVa,A.AFrameworkApplication.gyb);return A.AFrameworkApplication.iVa&&(A.AFrameworkApplication.gyb||A.AFrameworkApplication.fa.getBooleanAppSetting("ShareMenuIsEnabled"))}}Object(m.a)(FI,"CuiControlUser",null,[106]);class GI extends qD{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){super(b,a.Sla,f,xc.a.aca,l,u,I,null,ua,!0,null,Bb);this.MNg=this.Nhc=this.VMg=this.eHb=this.XJa=this.ka=this.yh=this.dZa=this.fjd=this.ADe=this.cIe=null;this.lYg=!1;this.O9=0;this.$Ie=this.Zed=this.Iaa=!1;this.Kv=this.Bhd=this.Bib=null;b=new rD.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.XJa=eb,this.ka=Ra,this.ADe=new FI(this.ka,Xb.getBooleanAppSetting("ShareMenuIsEnabled")),this.cIe=a,this.fjd=ja,this.eHb=I,this.dZa=T||new QR.a,this.yh=this.dZa.c8d(2,
"ReactRibbonUser"),this.O9=0,this.VMg=ua.Fca,this.Iaa=!!window.performance&&!!window.performance.now,this.Zed=Ub,this.Bib=Xb,this.$Ie=tc,this.Bhd=lc,this.Kv=Ec,this.pba=hd,this.bDl(),Cd.a.get_instance().Ij(10,Object(R.a)(this,this.q$j,"initializeFullPptRibbon"),11),Cd.a.get_instance().Ij(10,Object(R.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}Jxg(){Mg.a.instance.Xb("InitRibbon",(new Date).getTime());ya.a.J(512496020,801,50,"Initialize SLR IsReactMLRRendered: {0}",this.ka.DAa);
this.ka.podsRibbonEarlyRendererExposureControl&&!this.ka.c4f?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(R.a)(this,this.b$j,"initializeEarlyRenderedPptRibbon")):(Mg.a.instance.Xb("RenderRibbonStart",Date.now()),this.PEj(zs.a(Tb.a.instance)).catch(()=>{ya.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>{Mg.a.instance.Xb("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(zs.a(Tb.a.instance));fh.a("setCookieWithExpirationCallback")&&
fh.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>Yi.a.lL(a,b,Yi.a.VK)),appChrome.api.setGetCookieValueCallback(a=>Yi.a.get(a)));appChrome.setAppSettings(A.AFrameworkApplication.fa.appSettings);if(this.ka.getBooleanAppSetting("DynamicBundlesIsEnabled")){const a=A.AFrameworkApplication.jra+"exp/";appResourceLoader.init(CR.a.resolveScript,a);appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.V8e();
appChrome.initializeRibbonStore(this.ka.DAa);this.Kxg();this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==A.AFrameworkApplication.za.mode&&(this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)?this.WBh():this.bqe());this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.XJa&&this.XJa.hDl();appChrome.renderAppChrome(this.o8a,fh.e());this.ka.lLa&&
md.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");Cd.a.get_instance().eJ(5);Cd.a.get_instance().eJ(10);Cd.a.get_instance().eJ(6);this.HKg();Mg.a.instance.Xb("Stage1Ribbon",cB.pbg&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}WBh(){Cd.a.get_instance().Ij(4,()=>{Cd.a.get_instance().isCompleted(7)||this.bqe()})}PEj(a){return a(this.ka.DAa?
"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome"))}b$j(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&Mg.a.instance.Xb("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&Mg.a.instance.Xb("AppChromeReadyTime",
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&Mg.a.instance.Xb("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),this.bqe()):this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)&&this.WBh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.Bhd.gLh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?Mg.a.instance.Xb("AppInitStatus_ribbonSkeletonDismissed",
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.HKg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&da.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.V8e();Cd.a.get_instance().eJ(5);Cd.a.get_instance().eJ(10);Cd.a.get_instance().eJ(6);Gv.a.dispatch("RibbonVisible")}OVl(){const a=Yi.a.get("PPTReactShyRibbonPreference");"true"==a?this.pba.execute(b=>{b.logActivity("OptInShyRibbonNormalScreenActivity",
null)}):"false"!=a&&""!=a||!(1300>window.innerWidth||700>window.innerHeight)||this.pba.execute(b=>{b.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});document.addEventListener("ShyRibbonSmallScreenActivity",()=>{requestAnimationFrame(()=>setTimeout(()=>{var b;null===(b=document.getElementById("RibbonModeToggle"))||void 0===b?void 0:b.click()},0))},!1)}q$j(){Mg.a.instance.Xb("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{Mg.a.instance.Xb("RibbonLazyPromiseFulfilled",
(new Date).getTime());A.AFrameworkApplication.fa.Ue(()=>{this.ADe.cZl()?Cd.a.get_instance().Ij(7,()=>{ya.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");appChrome.api.dispatch(this.GMj())}):Cd.a.get_instance().Ij(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))});this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(Cd.a.get_instance().Ij(19,()=>{appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState({["renderDelayedBottomBar"]:!0}))}),
this.z0b.Dak(xc.a.Paf))});this.KRa&&a.push.apply(a,this.nqg());if(A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Zfa){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new DR.a,{shyDismissalRegions:b})))}this.OVl();appChrome.api.dispatch(a);this.Xxl();this.fMd.execute(b=>{if(void 0===this.VQ.bca||null===this.VQ.bca)this.VQ.bca=b;this.wJf()});this.qvl();this.mQc();this.createFileMenu();this.XJa&&(a=this.XJa.initialize(),ya.a.J(512496017,
801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.R4c();Cd.a.get_instance().eJ(7);Mg.a.instance.Xb("Stage3Ribbon",(new Date).getTime());this.Iaa&&Mg.a.instance.Xb("RibbonInteractivePerfMark",window.performance.now());this.ADk();this.dzl();this.r$j();za.a.RJ(this.cIe.JG(),"ScrollableRibbon");return null})}ADk(){if(Mg.a.instance.xdb)ya.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};
Mg.a.instance.Ml("Stage1Ribbon")&&(a.RibbonDisplayed=Mg.a.instance.hh("Stage1Ribbon"));Mg.a.instance.Ml("Stage3Ribbon")&&(a.RibbonInteractive=Mg.a.instance.hh("Stage3Ribbon"));Mg.a.instance.Ml("InitRibbon")&&(a.InitRibbon=Mg.a.instance.hh("InitRibbon"));Mg.a.instance.Ml("InitFullRibbon")&&(a.InitFullRibbon=Mg.a.instance.hh("InitFullRibbon"));Mg.a.instance.Ml("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=Mg.a.instance.hh("RibbonLazyPromiseFulfilled"));Mg.a.instance.Ml("RenderRibbonStart")&&
(a.RenderRibbonStart=Mg.a.instance.hh("RenderRibbonStart"));Mg.a.instance.Ml("AppChromeReadyTime")&&(a.AppChromeReadyTime=Mg.a.instance.hh("AppChromeReadyTime"));Mg.a.instance.Ml("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=Mg.a.instance.hh("AppInitStatus_ribbonSkeletonDismissed"));ya.a.J(512496015,809,50,"Ribbon Perf metrics: "+Qa.a.toJSON(a))}}rBk(){if(Mg.a.instance.xdb)ya.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};Mg.a.instance.Ml("Stage2Ribbon")&&(a.RibbonEnabled=Mg.a.instance.hh("Stage2Ribbon"));Mg.a.instance.Ml("Stage4Ribbon")&&(a.RibbonFull=Mg.a.instance.hh("Stage4Ribbon"));ya.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+Qa.a.toJSON(a))}}r$j(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);Mg.a.instance.Xb("Stage4Ribbon",(new Date).getTime());this.rBk();return null})}hNb(){this.qGc&&Cd.a.get_instance().isCompleted(7)&&(He.a.mark(4893),super.hNb(),He.a.mark(4894),
this.lYg||(Mg.a.instance.Xb("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),Mg.a.instance.Xb("Stage2Ribbon",Date.now()),this.lYg=!0))}CB(){this.hNb()}selectRibbonTabById(a){this.psi(a)}get iKh(){return appChrome.selectors.getSelectedTabId()}xcj(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();A.AFrameworkApplication.fa.Ue(()=>{if(!md.a("PPTOHideLegacySharedHeaderBugFix")||!A.AFrameworkApplication.fY){var b=
(new Date).getTime(),c=this.yh.Mu("createHeader"),f=A.AFrameworkApplication.za.mb.mP,l=document.getElementById("HeaderPlaceholder");this.mah=(new XH(jf.a.dfj,this.cIe)).pij();if(f)try{ya.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");var u=new UH;appChrome.renderSharedHeader(this.mah,u.gJj()).then(()=>{this.Uyk(b,a);l&&this.xcj()})}catch(I){ya.a.J(512496011,801,10,"Exception while trying to render shared header {0}",I)}else throw ya.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),
Error.invalidOperation("Invalid request to render legacy Shared Header");A.AFrameworkApplication.fY||(u=ws.a.Qpe(P.AppFrame.Kva,this.mah,!0),f&&(u.uK=!0,this.fvc(u,N.a.ZPb,N.a.YPb),u.bindAction(B.KeyInputManager.Va(H.a.E_,0),N.a.vwd)));!l&&cB.Hlj&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.yh.Su(c);this.O9|=1;this.zBc()}})}Uyk(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;ya.a.J(512496009,809,50,
"Create Header Perf metrics: "+Qa.a.toJSON(f))}fvc(a,b,c){const f=B.KeyInputManager.Va(H.a.zs,0),l=B.KeyInputManager.Va(H.a.zs,4);a.Sy(f);a.Sy(l);a.bindAction(f,b);a.bindAction(l,c)}mQc(){const a=()=>{const b=this.yh.Mu("createJewel");this.k7a=this.cak();tq.prototype.mQc.call(this);this.yh.Su(b);this.O9|=2;this.zBc()};this.Zed&&this.Bib?this.Bib.sDb(a):A.AFrameworkApplication.fa.Ue(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.yh.Mu("createFileMenu"),
l=[];if(this.ka.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var u=[Object.assign(new pD,{label:CommonUIStrings.L_DiagnosticsSessionId,value:A.AFrameworkApplication.userSessionId}),Object.assign(new pD,{label:CommonUIStrings.L_DiagnosticsBuild,value:A.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",u))}l.push.apply(l,this.cjg());u=document.createElement("div");document.body.appendChild(u);appChrome.renderFileMenu(u,l);
this.Tyk(c,a);this.yh.Su(f);this.O9|=22;this.zBc()};this.Zed&&this.Bib?this.Bib.sDb(b):A.AFrameworkApplication.fa.Ue(b)}Tyk(a,b){var c=(new Date).getTime();const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;ya.a.J(512496008,809,50,"File Menu Perf metrics: "+Qa.a.toJSON(f))}qvl(){const a=()=>{const b=this.yh.Mu("refreshRibbon");this.Nhc||(this.Nhc={},sq.OZh(this.Nhc),this.fjd.V3h(this.Nhc),this.MNg=this.Wvj(this.VMg,this.Nhc));const c=new ZH.a(this.eHb);
appChrome.api.dispatch(c.Dfe(this.MNg));this.yh.Su(b);this.O9|=4;this.zBc()};this.Zed&&this.Bib?this.Bib.sDb(a):A.AFrameworkApplication.fa.Ue(a)}Wvj(a,b){const c={};for(const l in b){var f=b[l];const u=l;f!==a[u]&&(c[u]=f,ya.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",u,a[u],f))}return c}cak(){const a={};this.fjd.dRl(a);this.fjd.V3h(a);return new EI(null,a,"jewelPPTEditor")}dzl(){cB.pbg&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}vDh(a){Cd.a.get_instance().Ij(7,
()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}bDl(){const a=this.ka.getBooleanAppSetting("ShareMenuIsEnabled"),b=a?"ShareTopBar":"Share";A.AFrameworkApplication.gyb?this.vDh(b):A.AFrameworkApplication.fa.Ue(()=>{const c=this.yh.Mu("createShareAction"),f=this.ADe.ZYl();f?this.g_l(b):this.vDh(b);a&&(f||Cd.a.get_instance().Ij(7,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.yh.Su(c);this.O9|=8;this.zBc()})}zBc(){31===this.O9&&
(this.dZa.Y$c(2),this.O9=0)}bqe(){this.Bhd.pIi();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));Cd.a.get_instance().Ij(7,()=>{this.Bhd.rfm();fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.$Ie||appChrome.PRIToastManager.dismissToast()},11)}HKg(){Cd.a.get_instance().eJ(18);Gv.a.dispatch("RibbonVisible")}Tfh(){return()=>{this.Kv.nOc(()=>{appChrome.PRIToastManager.dismissToast()})}}Xxl(){this.$Ie&&(tq.zwd.$("NewDefaultSlide",
this.Tfh()),tq.zwd.$("ChangeLayoutFlyout",this.Tfh()))}}Object(m.a)(GI,"ReactRibbonUser",qD,[893,181,106]);class HI{constructor(a,b,c,f,l,u,I){this.xIb=null;this.zb=a;this.m1g=b;this.oa=c;this.nv=f;this.EP=l;this.ia=u;this.wq=I;this.m1g.Ak(Object(R.a)(this,this.rHh,"ribbonChangeTabHandler"))}dispose(){this.m1g.tn(Object(R.a)(this,this.rHh,"ribbonChangeTabHandler"))}get YA(){return this.xIb}set YA(a){this.xIb!==a&&a&&(this.xIb=a,this.EP.t1?this.EP.t1=!1:this.wq&&this.EP.pYa&&this.ia.nb(G.a.kma,2))}rHh(a,
b){b.node.Qa(yb.a.shapeId)&&(a=b.node.$a(yb.a.shapeId),this.xIb&&this.xIb.id===b.node.id&&a&&(this.zb.Jb(new ne.a(2,1,0,()=>{const c=this.oa.gLj(this.nv.iKh,b.node);0<c.length&&this.nv.selectRibbonTabById(c)},90,"10")),this.xIb=null))}}Object(m.a)(HI,"RibbonChangeManager",null,[894]);class II{constructor(a,b,c){this.Urj=a;this.sectionId=b;this.Pcm=c}}Object(m.a)(II,"GallerySectionData",null,[]);let tD,uD,dB,vD,Oy,wD,xD,yD,zD;class Iw{constructor(a,b,c,f,l){this.ka=a;this.ehd=b;this.ygd=c;this.D7g=
f;this.gHb=l}zzd(a){this.ka.xDg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=
!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.ka.YQi,a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=
!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.ka.xDg||(a["PptRibbon.Home.Drawing.AllShapes"]=
!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.ka.hye||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=
!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=
!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=
!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.ka.fye){if(this.ka.gye||this.ka.dFb||this.ka.eye)a["ContextualTabs.Tables.Layout"]=!1;this.ka.eye&&(a["ContextualTabs.Tables.Layout.Alignment"]=!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=
!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.ka.gye&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.ka.dFb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=
!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=
!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.ka.Rba&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.ka.KNb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.ka.Dlb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.ka.f9c&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.ka.jye&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.ka.ytc&&
(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.ka.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.ka.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.ka.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=!this.ka.getBooleanAppSetting("InsertSymbolIsEnabled");this.ka.zEg||
(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.ka.Wnk||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.ka.yue||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.QZh(a,!0,!0,!0);this.PZh(a,!0);this.ka.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.ka.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.ka.Tvh||(a["PptRibbon.AudioPlayback"]=!0);this.ka.INb||(a["PptRibbon.AudioFormat"]=!0);if(A.AFrameworkApplication.vua||
!this.ka.pptEditInsertAppsForOfficeEnabled||this.ka.ufc)this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)?a["PptRibbon.Home.InsertAddInFlyout"]=!0:a["PptRibbon.InsertTab.AppForOffice"]=!0,a["PptRibbon.InsertTab.InsertAddinTransitionEntry"]=!0;this.ka.RDb||(a["PptRibbon.View.Zoom"]=!0);this.ka.blk||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);var b=[];this.ka.FOa&&(b=this.ka.FOa.split(","));for(const c of b){const f=c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,
c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.ka.S0d||(a.AnimationMore=!0);this.ka.Ask?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.ka.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.ka.Mg&&(a["PptRibbon.View.PresentationViews"]=!0);this.D7g?a["PptRibbon.Home.Clipboard.Paste"]=!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.ka.BDg?
a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.ka.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.ka.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.ka.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.ka.Ewe||(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?
a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=this.ka.getBooleanAppSetting("HelpTabIsEnabled")&&!A.AFrameworkApplication.XSb&&!A.AFrameworkApplication.vua)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&this.ka.getBooleanAppSetting("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&this.ka.getBooleanAppSetting("HelpTabShowTrainingIsEnabled"));a.btnWhatsNew=!(b&&this.ka.getBooleanAppSetting("HelpTabWhatsNewIsEnabled"));
a.btnFeedbackPane=!0;this.ka.ceb&&this.ka.i5c&&this.ka.i5c.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;
a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=
!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;this.gHb&&(a["PptRibbon.Review.Comments.Markers"]=!0);this.ka.getBooleanAppSetting("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.ka.Fuh;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.ka.Ajl;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.ka.qMa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.ka.qMa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.ka.qMa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=
!this.ka.qMa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.ka.qMa;a.FixIt=!this.ka.X9b}LUl(a){if(!this.ka.getBooleanAppSetting("HelpTabIsEnabled")||A.AFrameworkApplication.XSb||A.AFrameworkApplication.vua)a.Help=!0;a.Draw=!this.ka.Mg}zQj(){const a=new La.a;if(this.ka.FOa){var b=this.ka.FOa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new II("TransitionMore","Transition"+b,!0))}return a.toArray()}dRl(a){a["PptJewel.Menu"]=!0;this.ka.getBooleanAppSetting("WheresSaveButtonBrsIsEnabled")||
(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.ka.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.ehd&&this.ehd.kkh||
(a["PptJewel.About.TryOffice"]=!0);this.ygd&&this.ygd.gQh||(a["PptJewel.About.TryMacOffice"]=!0);this.ka.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&A.AFrameworkApplication.Qu.iy||(a.lblBreadcrumbDocName=!0);this.ka.getBooleanAppSetting("HelpTabIsEnabled")&&!A.AFrameworkApplication.XSb&&(a["PptJewel.Help"]=!0)}V3h(a){delete a["PptJewel.Menu"];const b=this.ka.Ea(A.AFrameworkApplication.uL);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=!0;var c=
this.ka.getBooleanAppSetting("SaveACopyIsEnabledForUiHost");const f=this.ka.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}A.AFrameworkApplication.Qya||(a["PptJewel.New"]=!0);A.AFrameworkApplication.A1e||(a["PptJewel.Open"]=!0);A.AFrameworkApplication.XF||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);A.AFrameworkApplication.SZh&&(a["PptJewel.Info.OpenInClient"]=
!0,a.btnOpenInClient=!0);A.AFrameworkApplication.z2a||(a["PptJewel.Share.ReplyWithChanges"]=!0);A.AFrameworkApplication.tde||A.AFrameworkApplication.qif||(a["PptJewel.Info.FileVersion"]=!0);A.AFrameworkApplication.WEb?(a["PptJewel.Info.FileVersion"]=!0,da.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):A.AFrameworkApplication.C9c()?this.ka.igl?(a["PptJewel.Info.VersionHistory"]=!0,da.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):
this.ka.$bj?this.ka.getBooleanAppSetting("IsAnonymousUserCheckSupportedForVH")&&this.ka.getBooleanAppSetting("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,da.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):this.ka.getBooleanAppSetting("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,da.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):(a["PptJewel.Info.VersionHistory"]=!0,da.ULS.sendTraceTag(512262733,
832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);A.AFrameworkApplication.iVa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(A.AFrameworkApplication.cD||!A.AFrameworkApplication.oif&&!A.AFrameworkApplication.ICb&&!A.AFrameworkApplication.jde)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&
(a["PptJewel.Share"]=!0);A.AFrameworkApplication.Kcm&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);this.ka.getBooleanAppSetting("DisablePrint")&&(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=
!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);A.AFrameworkApplication.cD&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);this.ka.getBooleanAppSetting("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=!0);
this.ka.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")&&this.ka.getBooleanAppSetting("UserCanWriteRelative")&&this.ka.getBooleanAppSetting("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=!0);this.ka.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")&&this.ka.getBooleanAppSetting("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=
!0);this.ka.aok||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.ka.HEg&&this.ka.Mg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!this.ka.getBooleanAppSetting("153")||".odp"===this.ka.Ea("152").toLowerCase()||A.AFrameworkApplication.cD)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0;this.ka.getBooleanAppSetting("RenameDialogIsEnabled")&&A.AFrameworkApplication.Jfc()&&!A.AFrameworkApplication.cD||(a["PptJewel.Rename"]=!0);A.AFrameworkApplication.awc||(a["PptJewel.Help.ReportAbuse"]=!0);
c=!A.AFrameworkApplication.xmd||!this.ka.getBooleanAppSetting("1072");A.AFrameworkApplication.privacyUrl||!c||A.AFrameworkApplication.nAc||this.ehd&&this.ehd.kkh||this.ygd&&this.ygd.gQh||this.ka.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);A.AFrameworkApplication.privacyUrl||(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;A.AFrameworkApplication.nAc||(a["PptJewel.About.TermsOfUse"]=!0);this.ka.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")||
(a["PptJewel.About.DiagnosticsSection"]=!0);A.AFrameworkApplication.Rfa||(a["PptJewel.SecondaryMenu"]=!0);c=!this.ka.getBooleanAppSetting("248");a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;a["PptRibbon.Home.ShowHide.Designer"]=c;a["PptRibbon.Design.Customize.FormatBackgroundAnchor.StockPictures"]=!this.ka.pptInsertOnlinePictureEnabled;c=!this.ka.getBooleanAppSetting("822");a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=
c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!Iw.gpk())||da.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;da.ULS.sendTraceTag(512262728,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",
A.AFrameworkApplication.$ec(),A.AFrameworkApplication.insertOnlinePictureFromHostEnabled,A.AFrameworkApplication.h4c,A.AFrameworkApplication.WEb,A.AFrameworkApplication.pPc,A.AFrameworkApplication.w3b);this.ka.getBooleanAppSetting("671")&&this.QZh(a,this.ka.pptInsertOnlinePictureEnabled,A.AFrameworkApplication.$ec(),this.ka.ceb);this.PZh(a,this.ka.n5c);this.ka.getBooleanAppSetting("670")&&(c=!this.ka.getBooleanAppSetting("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=
!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!this.ka.getBooleanAppSetting("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!this.ka.getBooleanAppSetting("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!this.ka.getBooleanAppSetting("619");a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=
!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=this.ka.getBooleanAppSetting("LiveSubtitlesEnabled");this.ka.vna&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,md.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=
!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.ka.qgc&&this.ka.UEg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.ka.pptRehearsalVisionEnabled||this.ka.JNb?(a["PptRibbon.View.Coach.Menu"]=
!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.ka.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.ka.JNb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.ka.ysk&&this.ka.vna&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,md.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.ka.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=
!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);this.ka.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&this.ka.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&this.ka.pptLabelingGetPolicyLabelsIsEnabled&&this.ka.pptApplyManualPolicyLabelIsEnabled&&this.ka.getBooleanAppSetting("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0);this.ka.dictationIsEnabled&&E.a.LVh&&this.ka.getBooleanAppSetting("UserCanUseDictation")&&(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=
!1);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.ka.Fuh;
a.FixIt=!this.ka.X9b;this.ka.du("IsPresentToTeamsSupportedHost")&&!this.ka.getBooleanAppSetting("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);this.ka.getBooleanAppSetting("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);sq.flm(Iw.o5j,a);if(A.AFrameworkApplication.vua||!this.ka.pptEditInsertAppsForOfficeEnabled||this.ka.ufc)a["PptJewel.Addin"]=!0}QZh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=
!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=
!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=
!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}PZh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static gpk(){const a=A.AFrameworkApplication.fa.Ea("SovereignEnvironmentName"),b=A.AFrameworkApplication.fa.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled");var c=A.AFrameworkApplication.fa.Ea(A.AFrameworkApplication.uL);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&
b&&!c}}Iw.o5j={["ellipsisOpenInApp"]:(zD=new La.a,zD.add("HostOpenInClient"),zD),["ellipsisOpenInBrowser"]:(yD=new La.a,yD.add("HostOpenInBrowser"),yD),["ellipsisDownload"]:(xD=new La.a,xD.add("HostDownload"),xD),["conversation"]:(wD=new La.a,wD.add("HostConversation"),wD),["close"]:(Oy=new La.a,Oy.add("HostClose"),Oy.add("btnjClose"),Oy.add("msJewelSecondary"),Oy),["copyLink"]:(vD=new La.a,vD.add("CopyLink"),vD),["share"]:(dB=new La.a,dB.add("jbtnFileSharing"),dB.add("btnFileSharing"),dB),["docChat"]:(uD=
new La.a,uD.add("DocChat"),uD),["openInApp"]:(tD=new La.a,tD.add("btnOpenInClient"),tD)};Object(m.a)(Iw,"RibbonCommandTrimmer",null,[1712]);class AD{constructor(){this.XJa=this.Ql=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}fc(a){this.K=a;a.register(UC,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().na(()=>new UC(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IAppSettingsManager")));
a.register(891,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().na(()=>new LH(new RC(A.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").uEb;E.a.Fk&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").BAa);const c=this.K.resolve("PowerPointWebEditor.IFileInfo").sla;let f=2===c||3===c||0===c;f=f&&1!==c;a.register(Iw,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().na(()=>new Iw(a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f));a.register(892,"PowerPointWebEditor.IModeSwitcherControlActor").ma().na(()=>new DH(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),Cd.a.get_instance()));a.register(893,"PowerPointWebEditor.IRibbonUser").ma().na(()=>{const l=
a.resolve("PowerPointWebEditor.IApplicationSettings"),u=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var I={};u.zzd(I);var T={};u.LUl(T);I=new zH(I,u.zQj(),T);T=new CH;const ja=a.resolve("Common.IAppSettingsManager"),ua=new GI(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").va,a.resolve("PowerPoint.IPathManager"),a.Ha("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),
a.ub("PowerPointWebEditor.Core.IBundleMetricRecorder"),u,I,l,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),T,ja.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(gc.a)(108,ja)?ja:null,ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),A.AFrameworkApplication.eNb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"),a.Ha("Common.ISystemInitiatedFeedback"));l.c4f?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").uXa(()=>
{ua.Jxg()}):ua.Jxg();return ua});a.register(628,"Common.IRibbonExternal").ma().na(()=>a.resolve("PowerPointWebEditor.IRibbonUser").THl);a.register(894,"PowerPointWebEditor.IRibbonChangeManager").ma().na(()=>new HI(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));
a.register(TC,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().na(()=>new TC(a.resolve("CommonUI.IBusinessBar"),new AH,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),A.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.PresentationContext"),
new Kn(A.AFrameworkApplication.Me,a.resolve("PowerPointWebEditor.IJsonpHelperManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))));a.register(895,"PowerPointWebEditor.IBusinessBarPane").ma().na(()=>new FH(a.Ha("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").cvc));a.register(er,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().na(()=>new er(a.resolve("PowerPointWebEditor.IBusinessBarPane").Gpm));a.register(626,"Common.IRibbonSQMInformation").ma().na(()=>
{const l=new MH(A.AFrameworkApplication.Pa);l.Gxl();return l});a.register(896,"PowerPointWebEditor.IInkRibbonManager").ma().na(()=>{const l=a.resolve("PowerPointWebEditor.IApplicationSettings");return new Np(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),A.AFrameworkApplication.za.mb.Zfa,l)})}init(){this.XJa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");this.K.resolve("PowerPointWebEditor.BusinessBarController").zfl();
this.Ql=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.Ql.initialize();A.AFrameworkApplication.fa.getBooleanAppSetting("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Ha("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");var c=document.getElementById("WACDocumentAndTaskPanel");
this.K.resolve("PowerPointWebEditor.IApplicationSettings").rvc?(c=document.getElementById("BusinessBarRegion"),b.VDa(a,c,null)):c?b.VDa(a,this.K.resolve("PowerPointWebEditor.AppFrame").M3,c):b.s0(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.Ql&&this.Ql.dispose();this.XJa&&this.XJa.dispose()}static main(){C.a.instance.Ac(new AD)}}Object(m.a)(AD,"PPTWebEditorRibbonPackage",null,[2,3]);var Py=d(686);class JI{get name(){return"Box4.Insights"}init(){}dispose(){}fc(a){a.register(Py.a,
"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new Py.a)}}Object(m.a)(JI,"Box4InsightsPackage",null,[2,3]);class BD{constructor(a,b){this.xRd=0;this.eka=new La.a;this.Ca=a;this.yd=b}get fd(){return this.yd}get ipe(){return 0<this.xRd}getName(){return"ActivityAction"}JZ(a){this.FDg(a)&&this.xRd++;this.ipe?this.fd.enabled=!1:this.eka.add(this.fd.Cq(a.actionId))}IZ(a){!this.ipe&&0<this.eka.count&&(this.eka.ga(this.eka.count-
1),this.K8f(this.eka.count-1));this.FDg(a)&&this.xRd--;this.ipe||(this.fd.enabled=!0)}K8f(a){if(0<this.eka.count&&0<=a&&a<this.eka.count){const b=this.eka.ga(a);this.eka.removeAt(a);b.end()}}bVi(){let a=this.eka.count-1;for(;0<=a;){var b=this.eka.ga(a);(b=this.Ca.RU(b.activityName))&&b.flags[128]&&this.K8f(a);a--}}FDg(a){if(2!==a.behavior)return!0;a=this.Ca.RU(a.actionId);return!!a&&a.flags[32]}}Object(m.a)(BD,"ActivityActionListener",null,[182]);var eB;(function(a){a[a.L$l=0]="timeOut";a[a.Tsm=1]=
"appClose";a[a.Xsm=2]="appError"})(eB||(eB={}));Object(m.b)("ActivityAutoEndReason",eB);class CD{constructor(a){this.xka=new al.a;this.dHi=()=>{for(const b of this.xka.keys)this.eHi(b)};this.zVb=a}feg(a){if(this.zVb.PPc)for(const b of this.xka.keys){const c=Array.clone(this.xka.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.Oee();this.RAh(b,a,l.uniqueID)}}}eHi(a){var b=this.xka.ga(a);b=this.$Ej(b);for(let c=0;c<b.length;c++){const f=b[c];f.Oee();this.RAh(a,0,f.uniqueID)}}$Ej(a){const b=[];for(let c=
0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.Bgh&&Array.add(b,f)}return b}RAh(a,b,c){const f={};f.AID=c;f.A=a;f.AE=eB[b];jd.a.instance.kc("AutoEnded",f)}DVl(){if(this.zVb.PPc){var a=new ne.a(2,2,this.zVb.fHi,this.dHi,67);A.AFrameworkApplication.Be.Jb(a)}}register(a){if(this.zVb.PPc){var b=a.activityName;this.xka.Ib(b)&&this.xka.ga(b)||this.xka.$(b,[]);Array.add(this.xka.ga(b),a)}}unregister(a){if(this.zVb.PPc){var b=a.activityName;this.xka.Ib(b)&&this.xka.ga(b)&&Array.remove(this.xka.ga(b),
a)}}}Object(m.a)(CD,"ActivityAutoEndHelper",null,[1798]);class Uu{constructor(a){this.ynf=null;this.vIc=0;this.gLd=this.FH=!1;this.wXd=0;this.Xy=new Cc.a;this.rAb=new Cc.a;this.k$h=a}get BYd(){return this.ynf||(this.ynf=this.k$h())}get properties(){return this.Xy}get Bgh(){return this.vIc}get enabled(){return this.FH}get ended(){return this.gLd}get uniqueID(){return this.wXd}Vfh(){const a={};a.ID=this.uniqueID;a.A=this.activityName;a.ST=this.startTime;a.ET=this.endTime;xb.Ct(this.properties.keys)&&
(a.P=Uu.gng(this.properties));xb.Ct(this.rAb.keys)&&(a.FP=Uu.gng(this.rAb));return a}static gng(a){const b={};for(const c of a)b[c.key]=c.value;return b}}Object(m.a)(Uu,"AActivity",null,[1827,367]);class DD extends Uu{constructor(a,b,c,f,l,u,I,T){super(I);this.Du=0;this.m$h=a;this.Sdi=b;this.ija=c;this.pk=(new Date).getTime();this.Dji=f;this.mHd=u;this.vIc=l;this.mHd.register(this);this.wXd=T()}get activityName(){return this.ija}get startTime(){return this.pk}get endTime(){return this.Du}U8f(a){this.Du=
(new Date).getTime();this.ended?this.aul():(this.gLd=!0,this.Du=(new Date).getTime(),this.Du<this.pk&&(da.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.Du,this.pk,this.ija)),this.Du=this.pk),this.mHd.unregister(this),this.Dji&&(!a&&this.BYd&&this.BYd.enabled?this.svb():this.b6b()))}end(){this.U8f(!1)}Oee(){this.U8f(!0)}aul(){const a={};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.Sdi("AlreadyEnded",
this.endTime,a)}svb(){this.BYd.svb()}b6b(){this.m$h(this.Vfh())}cancel(){this.ended||(this.gLd=!0,this.mHd.unregister(this))}}Object(m.a)(DD,"ActivityImpl",Uu,[]);class KI extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(m.a)(KI,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Vu{constructor(a,b,c){this.Ma=new uc.a;this.FH=!0;this.SAh=(f,l,u)=>{this.GBg(f)&&(f=this.hog(f,u,l),da.ULS.sendTraceTag(6068304,213,100,f))};this.settings=a;this.nHd=b;this.rHd=c}get enabled(){return this.FH&&
this.settings.enabled}set enabled(a){this.FH=a}Cq(a,b){b=void 0===b?-1:b;-1===b&&(b=this.settings.X9i);return this.nHd(Object(R.a)(this,this.b6b,"completeActivity"),this.SAh,a,this.Adk(a.toString()),b)}kc(a,b){b=void 0===b?null:b;this.SAh(a,(new Date).getTime(),b);this.Ma.raiseEvent("HHR",Object.assign(new KI,{name:a,properties:b}))}nqa(a,b){b=void 0===b?null:b;this.GBg(a.toString())&&(a=this.hog(a.toString(),b,(new Date).getTime()),da.ULS.sendTraceTag(6415520,213,100,a))}Adk(a){return this.enabled&&
!this.Bdk(a)}GBg(a){return this.enabled&&!this.gik(a)}Bdk(a){return this.settings.ncj.contains(a)}gik(a){return this.settings.ocj.contains(a)}b6b(a){if(this.rHd.JUf(a.A.toString())){var b=[];Array.add(b,a);a=Fe.c(b);da.ULS.sendTraceTag(5894867,213,100,a)}}hog(a,b,c){const f={};f.ID=Vu.xfe();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return Fe.c(a)}static xfe(){return Vu.Qqi++}}Vu.Qqi=0;Object(m.a)(Vu,"ActivityManagerImpl",null,[304]);class Pp{constructor(){this.FH=!1;this.zqf=this.iof=0;this.hof=
!1;this.frf=new bl.a;this.grf=new bl.a}o9b(a){this.FH=Boolean.parse(a[Pp.$hk]||"false");this.frf=this.cth(a[Pp.mcj]);this.grf=this.cth(a[Pp.pcj]);this.kkj(a)}get enabled(){return this.FH}get ncj(){return this.frf}get ocj(){return this.grf}kkj(a){this.hof=Boolean.parse(a[Pp.Cek]||"false");this.iof=parseInt(a[Pp.gHi]||"60000");this.zqf=parseInt(a[Pp.Y9i]||"5000")}get fHi(){return this.iof}get X9i(){return this.zqf}get PPc(){return this.hof}cth(a){const b=new bl.a;for(const c of(a||"").split(","))""!==
c&&b.add(c);return b}}Pp.$hk="ActivityLoggingIsEnabled";Pp.mcj="DisabledClientActivityNames";Pp.pcj="DisabledClientActivityEventNames";Pp.Cek="ActivityAutoEndEnabled";Pp.gHi="ActivityAutoEndTaskInterval";Pp.Y9i="ActivityDefaultMaxDuration";Object(m.a)(Pp,"ActivitySettings",null,[1797]);class Jw{constructor(a){this.EKd=new bl.a;this.E0b=new Cc.a;this.Adj=()=>{this.PFl()};this.oMc=a;this.EVl()}EVl(){this.oMc.enabled&&(Jw.$Gf=new ne.a(2,2,this.oMc.interval,this.Adj,65),A.AFrameworkApplication.Be.Jb(Jw.$Gf))}PFl(){this.E0b=
new Cc.a;this.EKd=new bl.a}Cdk(a){return this.EKd.contains(a)}adm(a){if(this.E0b.Ib(a)){if(this.E0b.ga(a)>=this.oMc.DWk)return this.EKd.add(a),da.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.E0b).$(a,b.ga(a)+1)}else this.E0b.add(a,1);return!0}JUf(a){return this.oMc.enabled?!this.Cdk(a)&&this.adm(a):!0}}Jw.$Gf=null;Object(m.a)(Jw,"ActivityThrottler",null,[1796]);class As{constructor(){this.FH=!1;this.tvf=this.Azf=0}o9b(a){this.FH=Boolean.parse(a[As.kbe]||
"false");this.Azf=parseInt(a[As.EWk]||"600");this.tvf=parseInt(a[As.ock]||"600000")}get enabled(){return this.FH}get DWk(){return this.Azf}get interval(){return this.tvf}}As.kbe="ActivityThrottlerEnabled";As.EWk="ActivityThrottlerMaxActivities";As.ock="ActivityThrottlerInterval";Object(m.a)(As,"ActivityThrottlerSettings",null,[1793]);class ED{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.G9j()}G9j(){const a=this.Da.resolve("Common.App.Activities.IActivitySettings"),
b=A.AFrameworkApplication.fa.appSettings;a.o9b(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").o9b(b);if(a.enabled){jd.a.instance=new Vu(this.Da.resolve("Common.App.Activities.IActivitySettings"),(l,u,I,T,ja)=>new DD(l,u,I,T,ja,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.ub("Common.App.Activities.IActivityAggregationManager"),Vu.xfe),this.Da.resolve("Common.App.Activities.IActivityThrottler"));var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),
f=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.DVl();A.AFrameworkApplication.Jia(()=>{f.bVi();c.feg(1)});A.AFrameworkApplication.Pa.a3(f);A.AFrameworkApplication.hOc((l,u)=>{jd.a.instance.nqa(u.errorCode,{["ErrorCause"]:u.Xbe,["ErrorResolution"]:u.Ybe});c.feg(2)})}}dispose(){}fc(a){this.Da=a;a.register(Pp,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(CD,"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().na(()=>
new CD(a.resolve("Common.App.Activities.IActivitySettings")));a.register(BD,"Common.App.Activities.ActivityActionListener").na(()=>new BD(A.AFrameworkApplication.Pa,a.resolve("Common.IActivityManager")));a.register(As,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().na(()=>new As);a.register(Jw,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().na(()=>new Jw(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){C.a.instance.Ac(new ED)}}
Object(m.a)(ED,"ActivitiesPackage",null,[2,3]);class LI{constructor(){this.Ora=new Cc.a}p7e(a,b){this.Ora.$(a,b)}Jfe(a){({value:a}=this.Ora.Eg(a));return a}}Object(m.a)(LI,"AggregationMethodsForActivityName",null,[]);class FD{constructor(){this.ZJc=new al.a;this.Ora=new al.a}p7e(a,b,c){this.Ora.Ib(a)&&this.Ora.ga(a)||this.Ora.$(a,new LI);this.Ora.ga(a).p7e(b,c)}Jfe(a,b){return this.Ora.Ib(a)&&this.Ora.ga(a)?this.Ora.ga(a).Jfe(b):null}Nac(a){this.ZJc.Ib(a)&&this.ZJc.ga(a)||this.ZJc.$(a,new bl.a);return this.ZJc.ga(a)}w9i(a,
b){this.Nac(a).add(b)}}Object(m.a)(FD,"ActivityAggregationInfo",null,[962]);class Qy extends Uu{constructor(a,b){super(a);this.wXd=(this.l$h=b)?b.IBj():Vu.xfe()}get Dka(){return this.l$h}get activityName(){return this.Dka.name}get startTime(){return this.Dka.startTime}get endTime(){return this.Dka.endTime}end(){}cancel(){}Oee(){}nim(){this.rAb.$("AM",this.Dka.mode.toString());this.rAb.$("C",this.Dka.count.toString());this.rAb.$("DA",this.Dka.y7f.toFixed(2));this.rAb.$("DV",this.Dka.Lej.toFixed(2))}Oje(a){return this.Dka.Oje(a)}pke(){return this.Dka.pke()}svb(){for(const a of this.Dka.Eka)a.svb()}}
Object(m.a)(Qy,"AggregatedActivity",Uu,[]);class MI{constructor(a,b){this.GHd=0;this.ija=a;this.RBa=b}PCi(a,b){this.GHd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.QCi(c)}}QCi(a){const b=Object(gb.a)(Qy,a);if(b)if(1===this.GHd)this.MCi(b);else if(2===this.GHd){this.RCi(b);for(const c of this.RBa.Nac(this.ija)){const f=b.Dka.Eka.ga(0);f.properties.Ib(c)&&a.properties.$(c,f.properties.ga(c))}}}MCi(a){for(const b of this.RBa.Nac(this.ija))this.dIh(a,b)}RCi(a){for(const b of a.pke())this.dIh(a,b)}dIh(a,
b){const c=this.RBa.Jfe(this.ija,b);if(c){const f=a.Oje(b);a.properties.$(b,c(f))}}}Object(m.a)(MI,"PropertyAggregationHelper",null,[]);class GD{constructor(a,b,c,f,l){this.Pqb=a;this.RBa=b;this.Tpf=l;this.rHd=f;this.iii=c}get jJf(){return this.iii.value}b6b(a){if(Object(gc.a)(DD,a))a.b6b();else if(Object(gc.a)(Qy,a)&&this.rHd.JUf(a.activityName.toString())){a=Object(gb.a)(Qy,a);a.nim();a=a.Vfh();var b=[];Array.add(b,a);a=Fe.c(b);da.ULS.sendTraceTag(6907266,213,50,a)}}h3b(a,b){const c=(new Date).getTime(),
f=this.Tpf.list.ga(a);let l=null;const u=(()=>{let I=this.Utj(f);({SCi:l}=I);return I})().returnValue;this.Tpf.list.$(a,new La.a);b&&(l=this.k1i(l,c,this.Pqb.wrg));0<l.count&&(new MI(a,this.RBa)).PCi(l,u)}k1i(a,b,c){const f=new La.a;for(let l=0;l<a.count;l++){const u=a.ga(l);u.startTime>b-c?u.svb():f.add(u)}return f}Utj(a){const b=this.jJf.mYh(a);a=this.jJf.N$l(a);const c=this.TCi(b,a);return{returnValue:c,SCi:1===c?b:a}}TCi(a,b){return a.count*this.Pqb.Ghh<b.count?1:2}get enabled(){return this.Pqb.enabled}svb(){}}
Object(m.a)(GD,"ActivityAggregationManager",null,[1799]);class qp{constructor(a){this.enabled=!1;this.Igh=500;this.mhh=2;this.CCd=6E4;this.Ghh=5;this.wrg=3E4;this.o9b(a.appSettings)}o9b(a){this.enabled=Boolean.parse(a[qp.kbe]||"false");this.Igh=parseInt(a[qp.TWk]||"500");this.mhh=parseInt(a[qp.eYk]||"2");this.CCd=parseInt(a[qp.a9l]||"60000");this.Ghh=parseInt(a[qp.uYk]||"5");this.wrg=parseInt(a[qp.iTj]||"30000")}}qp.kbe="ActivityAggregationEnabled";qp.TWk="ActivityAggregationMaxInterval";qp.eYk="ActivityAggregationMinChain";
qp.a9l="ActivityAggregationTaskInterval";qp.uYk="ActivityAggregationModeFactor";qp.iTj="ActivityAggregationGraceWindow";Object(m.a)(qp,"ActivityAggregationParams",null,[]);class HD{constructor(a,b){this.RBa=a;this.znf=b}mYh(a,b){b=void 0===b?1:b;if(!a||!a.count)return a;const c=new La.a;var f=null;for(let l=0;l<a.count;l++){const u=a.ga(l);if(!u)continue;const I=u.activityName;f?f.Ltk(u)?f.add(u):(f=f.process(),c.addRange(f),f=this.znf(I,b),f.add(u)):(f=this.znf(I,b),f.add(u))}f&&(a=f.process(),c.addRange(a));
return c}N$l(a){if(!a||!a.count)return a;const b={};var c=null;for(let l=0;l<a.count;l++){const u=a.ga(l);if(u){if(!c){c=new La.a;var f=this.RBa.Nac(u.activityName);for(const I of f)c.add(I)}f=this.fJj(u,c);null!==f&&(f in b&&b[f]||(b[f]=new La.a),b[f].add(u))}}a=new La.a;for(const l of Qa.a.AM(b))c=this.mYh(b[l],2),a.addRange(c);return a}fJj(a,b){let c="";for(const f of b)c+=f,c=a.properties.Ib(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(m.a)(HD,
"ActivityAggregationSchemes",null,[1792]);class NI{constructor(a,b,c,f,l){this.Du=this.pk=0;this.Pqb=c;this.nHd=f;this.RBa=l;this.name=a;this.Tz=b;this.Eka=new La.a}get mode(){return this.Tz}get count(){return this.Eka.count}get startTime(){return this.pk}get endTime(){return this.Du}get y7f(){if(!this.count)return 0;let a=0;for(const b of this.Eka)a+=b.endTime-b.startTime;return a/this.count}get Lej(){if(!this.count)return 0;let a=0;const b=this.y7f;for(const c of this.Eka){const f=c.endTime-c.startTime;
a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?this.Du=a.endTime>this.endTime?a.endTime:this.endTime:(this.pk=a.startTime,this.Du=a.endTime);this.Eka.add(a)}Ltk(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.Pqb.Igh}process(){if(this.count>=this.Pqb.mhh){const a=new La.a,b=this.nHd(this);a.add(b);return a}return this.Eka}Oje(a){const b=new La.a;for(const c of this.Eka)if(c.properties.Ib(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}pke(){const a=this.RBa.Nac(this.name),
b=new bl.a;for(const c of this.buj())a.contains(c)||b.add(c);return b}buj(){const a=new bl.a;if(!this.Eka)return a;for(const b of this.Eka)for(const c of b.properties.keys)a.add(c);return a}IBj(){return this.Eka.ga(0).uniqueID}}Object(m.a)(NI,"ActivityCollection",null,[1791]);class ID{constructor(){this.X5a=new al.a}get list(){return this.X5a}add(a){const b=a.activityName;if(this.X5a.Ib(b)&&this.X5a.ga(b)){const c=this.dDj(this.X5a.ga(b),a);this.X5a.ga(b).insert(c,a)}else this.X5a.$(b,new La.a),this.X5a.ga(b).add(a)}dDj(a,
b){for(let c=a.count-1;0<=c;c--)if(b.startTime>a.ga(c).startTime)return c+1;return 0}}Object(m.a)(ID,"CompletedActivitiesHelper",null,[1790]);class JD{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){A.AFrameworkApplication.Jia(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}fc(a){this.Da=a;const b=f=>new Qy(()=>a.ub("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new NI(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),
b,a.resolve("Common.IActivityAggregationInfo"));a.register(GD,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().na(()=>new GD(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.ze("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));
a.register(qp,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().na(()=>new qp(A.AFrameworkApplication.fa));a.register(FD,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().na(()=>new FD);a.register(HD,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().na(()=>new HD(a.resolve("Common.IActivityAggregationInfo"),c));a.register(ID,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().na(()=>
new ID)}static main(){C.a.instance.Ac(new JD)}}Object(m.a)(JD,"ActivityAggregatorPackage",null,[2,3]);var OI=d(16);class Kr{constructor(){this.cIl="getAddinShortcutsPreference";this.dIl="saveAddinShortcutsPreference";this.eIl="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Otj=6E4;this.snd=this.Q9=this.o_=null}Ing(a){return String.format(this.eIl,A.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",a,A.AFrameworkApplication.mh)}executeRequest(a,b,c,f,l){return Kr.vea.y9a(a,
b,void 0===l?null:l,null,2,c,f,!1,null,this.Otj)}saveSetting(a,b,c,f,l){return this.lJh(a,b,c,null,f,l)}startBatchUpdateScope(){this.snd=[]}saveShortcutInfoArrayBatch(a,b,c){this.cKl(c,a,b)}cKl(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.PYd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;b=new OI.a(c.toString(),a);this.snd.push(b)}commitBatchUpdateScope(){return this.Hyc()?
this.eKl().then(()=>{this.Iwb();return Promise.resolve(!0)}):this.gKl().then(()=>{this.Iwb();return Promise.resolve(!0)})}eKl(){return this.getSetting().then(a=>{let b=null;var c;if(c=a)a=Fe.d(a),{Ev:b}=a,c=!a.returnValue;if(c)return da.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const f of this.snd){(a=b[f.key])||(a={});c=f.value;for(const l of Qa.a.AM(c))a[l]=c[l];b[f.key]=a}this.o_=b;try{return localStorage.setItem("AddinShortcutPreferenceData",
Fe.c(b)),Promise.resolve(!0)}catch(f){return da.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",f),Promise.resolve(!1)}})}gKl(){return this.BNl().then(a=>this.cxd(a))}BNl(){return this.vke().then(a=>{let b=null;a&&(a=Fe.d(a),{Ev:b}=a,a.returnValue||da.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));b||(b={});for(const c of this.snd){(a=b[c.key])||(a={});const f=c.value;for(const l of Qa.a.AM(f))a[l]=
f[l];b[c.key]=a}this.o_=b;return Fe.c(b)})}saveShortcutInfoArray(a,b,c){return this.lJh(0,"","",c,a,b)}lJh(a,b,c,f,l,u){const I=this.Hyc(),T={};T.action=c;T.addinId=b;T.ownerType=a;T.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),u.toString());0===a&&f?(T.shortcutInfoArray=f,this.PYd(l,u,f)):b&&(T.shortcutInfoArray=b);a={};a[l.toString()]=T;l=new OI.a(u.toString(),a);return I?this.dKl(l):this.fKl(l)}dKl(a){return this.getSetting().then(b=>{let c=null;var f;if(f=b)b=Fe.d(b),
{Ev:c}=b,f=!b.returnValue;if(f)return da.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.o_=c;try{return localStorage.setItem("AddinShortcutPreferenceData",Fe.c(c)),Promise.resolve(!0)}catch(l){return da.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",l),Promise.resolve(!1)}})}fKl(a){return this.ANl(a).then(b=>this.cxd(b))}ANl(a){return this.vke().then(b=>{let c=null;
b&&(b=Fe.d(b),{Ev:c}=b,b.returnValue||da.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));c||(c={});c[a.key]=a.value;this.o_=c;return Fe.c(c)})}saveSettings(a){this.o_=Fe.a(a);this.Iwb();return this.Hyc()?this.mJh(a):this.cxd(a)}mJh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return da.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}cxd(a){const b=
{};b.Wac=a;const c=Fe.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.Ing(this.dIl),2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.Ao||l.Pm)da.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var u=l.result;void 0!==u.Hj&&null!==u.Hj&&void 0!==u.Hj.data&&null!==u.Hj.data&&u.Hj.data.Ke===ah.a.Zw?f(!0):f(!1)}})}}catch(u){da.ULS.sendTraceTag(522739860,0,10,
"SaveAddinShortcutPerferrenceSettings: Exception = {0}",u.toString()),f(!1)}})}getSetting(){const a=this.Hyc();return this.o_?Promise.resolve(Fe.c(this.o_)):a?this.VLj():this.vke()}Hyc(){const a=A.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser"),b=A.AFrameworkApplication.fa.getBooleanAppSetting("IsRoamingServiceEnabled");var c=A.AFrameworkApplication.fa.Ea("Puid");const f=A.AFrameworkApplication.fa.Ea("UserPrincipalName");c=!(void 0===c||null===c)&&!(void 0===f||null===f)&&0<c.length&&
0<f.length;return a||!b||!c}VLj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return da.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}vke(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.Ing(this.cIl),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.Ao||c.Pm)da.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.Hj&&f.Hj.data?
f.Hj.data.Ke!==ah.a.Zw?da.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.Hj.data.Ke):f.Hj.data.Ud?(f=Fe.a(f.Hj.data.Ud),f.Wac&&(l=f.Wac)):da.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):da.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){da.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=
this.Hyc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=Fe.a(f));if(!l)return da.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const u of Qa.a.AM(l)){f=l[u.toString()];for(const I of Qa.a.AM(f)){const T=f[I];if(T.addinId===a)delete f[I.toString()];else if(0===T.ownerType&&T.shortcutInfoArray){const ja=T.shortcutInfoArray,ua=new La.a;for(let Ra=0;Ra<ja.length;++Ra)ja[Ra].addinId!==a&&ua.add(ja[Ra]);T.shortcutInfoArray=ua.toArray()}}Qa.a.count(f)||
delete f[u]}c.o_=l;c.Wyl(a);return b?c.mJh(Fe.c(l)):c.cxd(Fe.c(l))})}Iwb(){if(this.o_){this.Q9=null;const c=this.o_;for(const f in c){var a=f;const l=c[f];for(const u in l){var b=u;const I=l[u];I.shortcutInfoArray&&this.PYd(parseInt(b),parseInt(a),I.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;var c;if(c=a)a=Fe.d(a),{Ev:b}=a,c=!a.returnValue;if(c)return da.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),
Promise.resolve(!1);this.o_=b;this.Iwb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.o_&&(c=this.o_[c])&&(b=c[b])&&b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.o_&&(b=this.o_[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.Iwb();
return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.Q9)return Promise.resolve(!0);var c=this.Q9[a];if(!c)return Promise.resolve(!0);var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let u=0;for(const I of l){if(I.addinId===a&&I.action===b)break;++u}if(u>=l.length)return Promise.resolve(!0);l.splice(u,1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.Iwb();return Promise.resolve(!0)})}PYd(a,
b,c){this.Q9||(this.Q9={});for(const f of c){c=f.addinId;const l=f.action;let u=this.Q9[c];u||(u={});const I={};I.modifiers=a;I.keyCode=b;u[l]=I;this.Q9[c]=u}}Wyl(a){a in this.Q9&&delete this.Q9[a]}isActionCustomized(a,b){return this.Q9&&(a=this.Q9[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.Q9&&(a=this.Q9[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.o_}static instance(){Kr.x_d||(da.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Kr.x_d=
new Kr,Kr.vea=A.AFrameworkApplication.Me);return Kr.x_d}}Kr.x_d=null;Kr.vea=null;Object(m.a)(Kr,"AddinShortcutsPreferenceSettingHelper",null,[]);class PI{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=
this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(PI,"BrowserInfo",null,[]);class QI{constructor(){this.Version=this.Name=null}}Object(m.a)(QI,"PluginInfo",null,[]);class Fk{static uhc(){if(A.AFrameworkApplication.fa.getBooleanAppSetting("LogBrowserInfoIsEnabled")){var a=Fk.Xrj();try{const b=JSON.stringify(a);da.ULS.sendTraceTag(6903563,
102,50,b)}catch(b){da.ULS.sendTraceTag(6903564,102,15,b.message)}}else da.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static rIj(){const a=window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new QI,{Name:f,Version:l}))}return b}static Xrj(){const a=new PI,b=new Sys.StringBuilder;Fk.rC(c=>{a.DocElemClientHeight=c},()=>document.documentElement.clientHeight,b);Fk.rC(c=>
{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);Fk.rC(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);Fk.rC(c=>{a.DocElemOffsetWidth=c},()=>document.documentElement.offsetWidth,b);Fk.rC(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);Fk.rC(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);Fk.rC(c=>{a.ScreenWidth=c},()=>window.screen.width,b);Fk.rC(c=>{a.ScreenHeight=c},()=>window.screen.height,b);Fk.rC(c=>{a.ScreenLogicalXdpi=c},()=>
window.screen.logicalXDPI,b);Fk.rC(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);Fk.rC(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);Fk.rC(c=>{a.ScreenDeviceYdpi=c},()=>window.screen.deviceYDPI,b);Fk.rC(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);Fk.rC(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);Fk.rC(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);Fk.rC(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);Fk.rC(c=>{a.WinOrientation=c},()=>window.self.orientation,
b);Fk.rC(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);Fk.rC(c=>{a.SupportsTouch=c},()=>E.a.dOa,b);Fk.rC(c=>{a.NavAppName=c},()=>window.navigator.appName,b);Fk.rC(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);Fk.rC(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);Fk.rC(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);Fk.rC(c=>{a.NavPlatform=c},()=>window.navigator.platform,b);Fk.rC(c=>{a.NavPlugins=c},Fk.rIj,b);Fk.rC(c=>
{a.CalculatedDevicePixelRatio=c},()=>Fk.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static rC(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(m.a)(Fk,"BrowserInfoLogger",null,[]);class KD{get name(){return"Common.App.BrowserInfoLogger"}fc(){}init(){Fk.uhc()}dispose(){}static main(){C.a.instance.Ac(new KD)}}Object(m.a)(KD,
"BrowserInfoLoggerPackage",null,[2,3]);class LD{get name(){return"Common.App.DialogWithLinkToResource"}fc(){}init(){}dispose(){}static main(){C.a.instance.Ac(new LD)}}Object(m.a)(LD,"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var RR=d(725);class MD{get name(){return"Common.App.EventsCachePackage"}fc(){}init(){RR.a.instance.init()}dispose(){}static main(){C.a.instance.Ac(new MD)}}Object(m.a)(MD,"EventsCachePackage",null,[2,3]);class ND{constructor(a,b,c){this.G8a=null;this.AAd=()=>{this.G8a=
null;da.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.dtf.display()};this.g0l=(f,l,u,I,T)=>f!==N.a.AAd?2:1===u?32:2===u&&T?(da.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",T),T?this.wvc():(this.G8a?(da.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.je.Vg(this.G8a)):(da.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.dtf.remove(null)),this.G8a=
null),32):8;this.je=a;this.Ca=b;this.dtf=c.create()}wvc(){this.G8a?da.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(da.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.G8a=new ne.a(2,1,3E4,this.AAd,67),this.je.Jb(this.G8a))}Pza(){this.Ca.xa(N.a.AAd,Le.a.frame,this.g0l)}}Object(m.a)(ND,"FloatPaneActor",null,[1803]);class RI{constructor(a,b,c,f,l){this.iQd=this.jYb=this.AKc=this.aDa=this.m4=this.$Ba=this.EId=this.h0=this.G_b=
this.HZb=this.IZb=this.RLd=null;this.U6k=()=>{const u=this.La.tc("O365AdPaneShowingDuration",60);this.D0f();this.h0.style.display="block";this.h0.style.height=this.m4.height+"px";this.jYb=new ne.a(2,1,1E3*u,Object(R.a)(this,this.hide,"hide"),67);this.je.Jb(this.jYb);this.XCh()};this.T6k=()=>{da.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.XCh();this.m4=null};this.Roh=()=>{da.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");
return!1};this.onClose=()=>{this.jYb&&this.je.Vg(this.jYb);this.hide();return!0};this.je=b;this.La=a;this.er=c;this.Da=l;this.kja=f}D0f(){this.h0=document.createElement("div");this.h0.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.h0.style.width=this.m4.width+"px";(this.iQd=this.WGj(this.kja))?(this.aDa=document.createElement("a"),this.aDa.setAttribute(Qe.a.Ff,Qe.a.gR),this.er.xb(la.a.click,this.aDa,this.Roh),this.aDa.href=this.iQd,this.aDa.target="_blank",this.aDa.appendChild(this.m4),
this.h0.appendChild(this.aDa)):this.h0.appendChild(this.m4);this.$Ba=document.createElement("a");this.$Ba.setAttribute(Qe.a.Ff,Qe.a.jx);this.$Ba.className="StandardButton WACFloatPaneCloseButton";this.$Ba.title=CommonUIStrings.l_Close;this.$Ba.tabIndex=-1;this.EId=mp.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.EId.setAttribute(Qe.a.Ff,Qe.a.gR);this.$Ba.appendChild(this.EId);this.er.xb(la.a.click,this.$Ba,this.onClose);
this.h0.appendChild(this.$Ba);this.G_b.appendChild(this.h0)}Ok(a){const b=this.La.getBooleanAppSetting("O365PromotionHasStarted");switch(a){case 2:return Kq.a.GO(String.format("adppt{0}.png",b?"sale":""));case 1:return Kq.a.GO(String.format("adxls{0}.png",b?"sale":""));case 3:return Kq.a.GO(String.format("addoc{0}.png",b?"sale":""))}return null}WGj(a){const b=this.La.Ea("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,
"Word")}return null}hide(a){this.jYb=null;this.h0&&!this.AKc&&((void 0===a?0:a)?da.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):da.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.h0.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.h0.style.height="0px",this.AKc=new ne.a(2,1,1E3,Object(R.a)(this,this.remove,"remove"),67),this.je.Jb(this.AKc))}remove(){this.h0&&this.G_b&&(this.aDa&&this.er.Hb(la.a.click,
this.aDa,this.Roh),this.er.Hb(la.a.click,this.$Ba,this.onClose),this.G_b.removeChild(this.h0),this.h0=null);this.AKc=null}display(){if(this.RLd=this.Da.ub("Common.IFloatPaneContainer"))if(this.G_b=this.RLd.container){var a=this.Ok(this.kja);a?(da.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.m4=document.createElement("img"),this.m4.className="WACFloatPaneImage",this.IZb=this.U6k,Ae.a.addHandler(this.m4,la.a.load,this.IZb),this.HZb=this.T6k,Ae.a.addHandler(this.m4,
la.a.error,this.HZb),this.m4.src=a):da.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else da.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else da.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}XCh(){this.IZb&&this.m4&&Ae.a.removeHandler(this.m4,la.a.load,this.IZb);this.IZb=null;this.HZb&&this.m4&&Ae.a.removeHandler(this.m4,la.a.error,this.HZb);
this.HZb=null}dispose(){this.hide()}}Object(m.a)(RI,"FloatPane",null,[1828]);class OD{constructor(a,b,c,f,l){this.je=b;this.La=a;this.er=c;this.Da=l;this.kja=f}create(){return new RI(this.La,this.je,this.er,this.kja,this.Da)}}Object(m.a)(OD,"FloatPaneFactory",null,[1802]);class PD{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get gCg(){return A.AFrameworkApplication.fa.getBooleanAppSetting("O365AdvertisementIsEnabled")&&A.AFrameworkApplication.fa.getBooleanAppSetting("IsShowAdvertisementPaneEnabled")}init(){this.gCg&&
(da.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").wvc(),da.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Pza())}fc(a){this.Da=a;this.gCg&&(this.Da.register(OD,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").na(()=>new OD(A.AFrameworkApplication.fa,A.AFrameworkApplication.Be,ze.a.instance,
A.AFrameworkApplication.za.mb.Ej,this.Da)).ma(),this.Da.register(ND,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").na(()=>new ND(A.AFrameworkApplication.Be,A.AFrameworkApplication.Pa,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){C.a.instance.Ac(new PD)}}Object(m.a)(PD,"FloatPanePackage",null,[2,3]);const SI=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);0>a&&(a+=2*Math.PI);return a};class SR{constructor(a,b,c){this.UQ=this.Zrb=
this.xub=null;this.UBa=this.ZJd=this.Ura=0;this.HH=this.uHc=this.eGc=this.dGc=!1;this.rNd=this.bvf=this.dvf=0;this.BQa=a;this.Ca=b;this.p0=c}Ew(a){return ad.App.Ob.ie.isEditingAllowed?""!==this.m0c(a.Ec):!1}Qv(a){if(!this.Ew(a))return!1;this.UBa=this.BQa.Xum();this.QSl(a);this.RSl();({Qve:this.uHc,Eye:this.HH}=this.fNh(this.ZJd));this.SSl();this.xub=a.QF;this.UQ=new Sys.UI.Point(0,0);({width:this.dvf,height:this.bvf}=this.BQa.E_c());da.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");
return!0}Px(a){this.Zrb=a.QF;this.uOi();var b=this.UQ.x,c=this.UQ.y;a=this.dvf;var f=this.bvf,l=this.uHc,u=this.HH,I=1;(b||c)&&a&&f&&(l&&u?(I=a+b,l=f+c,b=1/a,c=1/f,u=b>c?b:c,1>I?I=1:1920<I&&(I=1920),1>l?l=1:1280<l&&(l=1280),b=I-a,c=l-f,I=Math.abs(b/a)>Math.abs(c/f)?I/a:l/f,I<u&&(I=u)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),I=b/a):u&&(b=f+c,1>b?b=1:1280<b&&(b=1280),I=b/f));a=I;this.rNd=a;this.BQa.JEm(this.rNd,this.uHc,this.HH);return!0}Uo(){this.Mh();da.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}rv(){this.BQa.SCm();
da.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}RSl(){this.ZJd=(Math.floor((this.UBa+22)/45)%8+this.Ura)%8}fNh(a){let b,c;if(this.UBa&&90!==this.UBa&&180!==this.UBa&&270!==this.UBa&&360!==this.UBa||this.ykk(a))return{Qve:!0,Eye:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{Qve:b,Eye:c}}SSl(){this.eGc=this.dGc=!1;switch(this.ZJd){case 0:this.eGc=this.dGc=!0;break;case 1:case 2:this.eGc=!0;break;case 7:case 6:this.dGc=!0}}ykk(a){return!(a%2)}m0c(a){var b=
a.className;-1===b.indexOf("WACImageResizeHandle")&&a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}QSl(a){switch(this.m0c(a.Ec)){case "WACImageResizeHandleNW":this.Ura=0;break;case "WACImageResizeHandleN":this.Ura=1;break;case "WACImageResizeHandleNE":this.Ura=2;break;case "WACImageResizeHandleE":this.Ura=3;break;case "WACImageResizeHandleSE":this.Ura=4;break;
case "WACImageResizeHandleS":this.Ura=5;break;case "WACImageResizeHandleSW":this.Ura=6;break;case "WACImageResizeHandleW":this.Ura=7}}uOi(){var a=1;this.p0.instance&&(a=this.p0.instance.X4);const b=(this.Zrb.x-this.xub.x)/a;a=(this.Zrb.y-this.xub.y)/a;this.UQ.x=this.dGc?-b:b;this.UQ.y=this.eGc?-a:a}Mh(){const a=new W.DictionaryPropertySet;a.setValue(Oe.a.n7j,100*this.rNd);a.setValue(Oe.a.o7j,!0);if(90===this.UBa||270===this.UBa){const {Qve:b,Eye:c}=this.fNh(this.Ura);a.setValue(Oe.a.Hwg,b);a.setValue(Oe.a.Iwg,
c)}else a.setValue(Oe.a.Hwg,this.uHc),a.setValue(Oe.a.Iwg,this.HH);this.Ca.Ia(G.a.l7j,2,a)}}Object(m.a)(SR,"ImageResizeDragAdapter",null,[363]);class QD{constructor(a,b){this.Ca=a;this.p0=b}}Object(m.a)(QD,"ImageResizeDragAdapterFactory",null,[1711]);class TI{constructor(a,b,c,f,l,u){this.Wtb=this.QKc=this.uNd=this.Zrb=this.xub=this.RKc=null;this.uJc=this.cNc=0;this.Xy=null;this.Zo=!1;this.Ca=a;this.Vc=b;this.$g=c;this.BQa=f;this.p0=l;this.Vyf=this.oka=0;this.bub=u}Ew(a){return ad.App.Ob.ie.isEditingAllowed&&
a?(this.RKc=this.Vc.Ik)?!0:!1:!1}Qv(a){if(!this.Ew(a))return!1;this.RKc=this.Vc.Ik;if(this.Xy=vb.ImageReader.uGa(this.RKc))return this.xub=this.gva(a),this.uNd=Sys.UI.DomElement.getBounds(this.bub),this.cNc=0<vb.ImageReader.jkg(this.Xy)?vb.ImageReader.jkg(this.Xy):0,this.uJc=vb.ImageReader.WCj(this.Xy),da.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;da.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}Px(a){this.Zrb=
this.gva(a);this.wOi();if(this.BQa)return this.BQa.Vjm(this.oka,this.Vyf),da.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;da.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}Uo(){var a=this.oka;a%=360;0>a&&(a+=360);this.cNc=this.oka=a;this.setRotation();da.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}rv(){this.BQa.Vjm(this.uJc,0);da.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}gva(a){return this.$g.qma(a)}wOi(){var a=
1;this.p0&&this.p0.instance&&(a=this.p0.instance.X4);var b=new Sys.UI.Point(this.uNd.x+this.bub.clientWidth/2*a,this.uNd.y+this.bub.clientHeight/2*a);a=SI(this.xub,b);b=SI(this.Zrb,b);this.oka=Math.round(Re.a.VS(b-a));0<this.cNc&&(this.oka+=this.cNc-this.uJc);this.Vyf=this.oka;this.oka+=this.uJc}setRotation(){const a=new W.DictionaryPropertySet;a.setValue(Oe.a.m7j,0);a.setValue(Oe.a.pdc,this.oka);this.Ca.Ia(G.a.imageRotate,2,a)}dispose(){da.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");
this.Zo||(this.Wtb&&(this.QKc&&this.Wtb.contains(this.QKc)&&(this.Wtb.removeChild(this.QKc),this.QKc=null),this.bub&&this.bub.contains(this.Wtb)&&(this.bub.removeChild(this.Wtb),this.Wtb=null)),this.Zo=!0)}}Object(m.a)(TI,"ImageRotateDragAdapter",null,[1731,363,106]);class RD{constructor(a,b,c){this.Ca=a;this.Vc=b;this.p0=c}create(a,b,c){return new TI(this.Ca,this.Vc,a,b,this.p0,c)}}Object(m.a)(RD,"ImageRotateDragAdapterFactory",null,[1710]);class SD{constructor(){this.Da=null}get name(){return"Box4.Images"}fc(a){this.Da=
a;this.Da.register(QD,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().na(()=>new QD(A.AFrameworkApplication.Pa,Tb.a.instance.Ha("Common.IZoomManager")));this.Da.register(RD,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().na(()=>new RD(A.AFrameworkApplication.Pa,Me.a.instance,Tb.a.instance.Ha("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){C.a.instance.Ac(new SD)}}
Object(m.a)(SD,"Box4ImagesPackage",null,[2,3]);class UI{create(a){return new Kd.a(a)}}Object(m.a)(UI,"Factory",null,[1815]);var fB=d(449);class VI{constructor(){this.vj=null}get key(){return"COMMENTTEXTANCHOR"}get J9(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.vj=Object(gb.a)(Vg.AParagraphNode,a.node)}qBc(a){a=this.cxj(a);let b;a&&(b=new fB.a,b.T2=this.key,b.nR=a);return{returnValue:!!b,NDa:b}}cxj(a){if(!this.vj.Sa)return null;const b=new La.a;for(let c=0;c<this.vj.Sa.length;c++){const f=
this.vj.Sa.ga(c);if(f.cp>a)break;if(f.Kg)for(let l=0;l<f.Kg.length;l++){const u=f.Kg.ga(l);u.il?b.add(u.VH.rr.toString()):b.remove(u.VH.rr.toString())}}return 0<b.count?b.ga(0):null}}Object(m.a)(VI,"CommentTextAnchorDetailsProvider",null,[1062,1063]);class Ry{constructor(){this.vj=null}get J9(){return null}getTitle(){return null}pig(){return null}reset(a){this.vj=a.node}qBc(a){const b=We.d(this.vj,a);a=null;if(!b||b.kr!==this.kr)return{returnValue:!1,NDa:a};a=Object.assign(new fB.a,{T2:this.key,nR:b,
title:this.getTitle(b),description:this.pig(b)});return{returnValue:!0,NDa:a}}}Object(m.a)(Ry,"BlobDetailsProvider",null,[1062,1063]);class WI extends Ry{constructor(){super()}get key(){return"EQUATION"}get kr(){return 11}get J9(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(WI,"EquationDetailsProvider",Ry,[]);class XI{constructor(){this.Ouf=null}get key(){return"LINK"}get J9(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.Ouf=gf.HyperlinkReader.tac(a.node)}qBc(a){let b;
b=null;for(const c of this.Ouf)if(c.Ra<=a&&a<c.Pb)return b=Object.assign(new fB.a,{T2:this.key,nR:c.hyperlink}),{returnValue:!0,NDa:b};return{returnValue:!1,NDa:b}}}Object(m.a)(XI,"HyperlinkDetailsProvider",null,[1062,1063]);class YI extends Ry{constructor(){super()}get key(){return"IMAGE"}get kr(){return 5}get J9(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return vb.ImageReader.q0c(a.properties)}pig(a){return vb.ImageReader.eie(a.properties)}}Object(m.a)(YI,"ImageDetailsProvider",
Ry,[]);class gB{constructor(){this.description=this.contentId=this.nR=this.T2=null}}Object(m.a)(gB,"StructuralContentDetails",null,[1084]);class ZI{get key(){return"IMAGENODE"}get J9(){return Box4Intl.Box4Strings.l_ImageContentTitle}Uff(a){let b;b=null;if(!a||!vb.ImageReader.pI(a.currentNode))return{returnValue:!1,Yxb:b};b=Object.assign(new gB,{T2:this.key,contentId:a.currentNode.id,nR:a.currentNode});return{returnValue:!0,Yxb:b}}s_c(a,b){a=a.nR;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.nR.id||(f=String.format(c,vb.ImageReader.q0c(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(m.a)(ZI,"ImageNodeDetailsProvider",null,[1830,1063]);let Sy,Ty;class Bs{constructor(a,b){this.nsf=null;this.xn=b;this.rTd=a;this.jZb=Bs.keys.ga(a);this.Ybi=Bs.B_i.ga(a)}get key(){return this.jZb}get J9(){return this.Ybi}reset(a){this.nsf=this.xn.KG(a.node)}qBc(a){var b=Bs.Hoj(this.nsf||[],c=>this.Ogk(a,c));b=this.C2i(b);return{returnValue:!!b,NDa:b}}Ogk(a,b){return b.begin<=
a&&a<b.end&&(!b.Rh||this.rTd===b.Rh.proofingType)}C2i(a){return a?Object.assign(new fB.a,{T2:this.key,nR:a.Rh,description:this.Hge()}):null}Hge(){return A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static Hoj(a,b){for(const c of a)if(b(c))return c;return null}}Bs.keys=(Ty=new id.a,Ty.add(1,"SPELLINGERROR"),Ty.add(2,"GRAMMATICALERROR"),Ty.add(3,"ADVANCEDERROR"),Ty);Bs.B_i=
(Sy=new id.a,Sy.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Sy.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Sy.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Sy);Object(m.a)(Bs,"ProofingDetailsProvider",null,[1062,1063]);class $I{constructor(){this.tableNode=null;this.fSc=this.Hwd=this.columns=this.rows=0}}Object(m.a)($I,"TableInfo",null,[]);var vo=d(149),ce=d(84),Sk=d(128);class aJ{get key(){return"TABLE"}get J9(){return Box4Intl.Box4Strings.l_TableContentTitle}Uff(a){var b=
null;if(!se.isTableCell(a))return{returnValue:!1,Yxb:b};b=new mb.GraphIterator;b.Uc(a);a=new $I;a.Hwd=Sk.c(b)+1;a.fSc=vo.a(b)+1;ce.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=Jd.TableReader.ej(a.tableNode);a.rows=Jd.TableReader.fl(a.tableNode);b=Object.assign(new gB,{T2:this.key,contentId:a.tableNode.id,nR:a});return{returnValue:!0,Yxb:b}}s_c(a,b){a=a.nR;const c=new fk.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.nR.fSc===a.fSc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.fSc));b&&b.nR.Hwd===a.Hwd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.Hwd));return c.toArray().join(" ")}}Object(m.a)(aJ,"TableDetailsProvider",null,[1830,1063]);class TD{constructor(a,b){this.Jei=a;this.xn=b}n2e(){this.Jei.execute(a=>{a.o2a(new XI);a.o2a(new Bs(1,this.xn));a.o2a(new Bs(2,this.xn));a.o2a(new Bs(3,this.xn));a.o2a(new WI);a.o2a(new YI);a.o2a(new VI);a.y2e(new aJ);a.y2e(new ZI)})}}
Object(m.a)(TD,"AccessibilityActor",null,[]);class UD{constructor(a,b,c){this.I1b=a;this.yd=b;this.nai=c}qb(){this.I1b.pa(G.a.Ial,ta.a.view,Object(R.a)(this,this.Jal,"openAutoCorrectOptionsView"),1028)}Jal(a,b,c){if(1===c)return 32;this.nai().Syc();return 32}}Object(m.a)(UD,"AutoCorrectActor",null,[]);class VD{constructor(a){this.jhi=a}Ymk(a){if(!a||!a.wx||1>a.wx.count)return!1;const b=[fc.a.A8i,fc.a.z8i];return!!this.a_c(a.wx,1,c=>this.KSc(c,b))}tBg(a){return!a||!a.wx||1>a.wx.count?!1:!!this.a_c(a.wx,
1,b=>this.KSc(b,[fc.a.OO]))}hkk(a){return!a||!a.wx||1>a.wx.count?!1:!!this.a_c(a.wx,2,b=>this.KSc(b,[fc.a.chc]))}Pl(a){return!a||!a.wx||1>a.wx.count?!1:!!this.a_c(a.wx,1,b=>this.KSc(b,[fc.a.Sha]))}k7c(a){if(!a||!a.wx)return!1;a=a.wx;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).QGi)return!1;return!0}Kij(a,b){return this.tBg(b)||this.hkk(b)?"":a}get h8c(){return this.jhi}a_c(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}KSc(a,
b){a=a&&a.awg?a.awg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(m.a)(VD,"Box4PasteStewardUtils",null,[1837]);class bJ{constructor(){this.D_=0;this.FFb=Array(9)}}Object(m.a)(bJ,"FullListMetadata",null,[]);class hB{constructor(){this.level=0;this.cPa=null;this.D_=0;this.Ilj=this.Wrc=null;this.aNb=!1}}Object(m.a)(hB,"ListItemMetadata",null,[]);class Wu{constructor(){this.J_=[]}Mhg(){const a=new Wu;for(let b=0;b<this.J_.length;b++)a.add(this.ga(b));
return a}get count(){return this.J_.length}ga(a){return this.J_[a]}$(a,b){return this.J_[a]=b}add(a){Array.add(this.J_,a)}clear(){Array.clear(this.J_)}contains(a){return Array.contains(this.J_,a)}indexOf(a){return Array.indexOf(this.J_,a)}insert(a,b){Array.insert(this.J_,a,b)}remove(a){return Array.remove(this.J_,a)}removeAt(a){Array.removeAt(this.J_,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.J_,a)}reverse(){this.J_.reverse()}sort(){this.J_.sort()}toArray(){return Array.clone(this.J_)}}
Object(m.a)(Wu,"List",null,[]);class cJ{constructor(){this.level=0;this.tagName="UL";this.R0a=null;this.ignore=!1;this.Cqc=0;this.listStyle="BulletListStyle1";this.daa=new Wu;this.font=this.levelText=""}}Object(m.a)(cJ,"ListLevelMetadata",null,[]);class WD{constructor(){this.aJg={};this.vUc=-1}}Object(m.a)(WD,"LevelLists",null,[]);class XD{constructor(a){this.nodes=a;this.V4=0;this.lists={};this.daa=[];this.uFb=null;this.Fla=[];this.Fla[0]=new WD}}Object(m.a)(XD,"WordConverterArguments",null,[]);
class dJ{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(m.a)(dJ,"AbsolutePosition",null,[]);class Vn{constructor(a,b,c,f,l){this.cultureName=this.u7=this.wx=this.$V=null;a&&(this.$V=a);b&&(this.wx=b);this.u7=c?c:new La.a;f&&""!==f&&(this.cultureName=f);this.Bka=l}}Object(m.a)(Vn,"GlobalAttributesArgs",null,[]);class Xu{constructor(a,b,c,f){c=void 0===c?"":c;f=void 0===f?0:f;this.gx=!1;this.Fuf=this.Guf=null;let l=!1;Xu.Djk(a)&&(l=!0,this.Guf=a);Xu.Sjk(b)&&(this.Fuf=b);this.zfi=c;this.iai=
f;this.gx=l&&this.bdc?!0:!1}get isValid(){return this.gx}get cwg(){return this.Guf}get bdc(){return this.Fuf}get awg(){return this.zfi}get QGi(){return this.iai}static Djk(a){return a?-1===a.indexOf(" ")&&0<a.length:!0}static Sjk(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(m.a)(Xu,"HtmlElementInfo",null,[]);class eJ{constructor(a){this.next=null;this.data=a}}Object(m.a)(eJ,"StackNode",null,[]);class Uy{constructor(){this.kw=null;this.Un=0}get count(){return this.Un}get isEmpty(){return!this.Un||
!this.kw}push(a){a=new eJ(a);a.next=this.kw;this.kw=a;this.Un++}peek(){return this.isEmpty?null:this.kw.data}pop(){if(this.isEmpty)return null;const a=this.kw;this.kw=a.next;this.Un--;return a.data}clear(){this.kw=null;this.Un=0}toArray(){const a=Array(this.count);let b=this.kw;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(m.a)(Uy,"Stack",null,[]);class Rh{constructor(a){this.SXb=this.lJc=null;this.AFc=!1;this.Yg=a}get cUa(){return this.SXb.peek()}reset(){this.Yg.reset();
this.lJc=new Uy;this.SXb=new Uy;this.SXb.push(this.Yg.B7b);this.AFc=!1}bod(){this.AFc=!1}sE(a){this.AFc||(this.lJc.push(null),this.AFc=!0);this.lJc.push(a)}onClose(){for(;;){const a=this.lJc.pop();if(!a)break;a()}}WLh(){return!1}$0k(){this.sr(()=>!0)}sr(a){const b=this.cUa.clone();return a(b)?(this.SXb.push(b),this.Yg.Npa(b),this.sE(Object(R.a)(this,this.x5k,"onFormattingEnd")),!0):!1}Cme(a){return a.style?this.sr(b=>this.WLh(b,a))?1:2:2}x5k(){this.SXb.pop();this.Yg.Npa(this.cUa)}K2(){}Wnd(){return 2}gTe(){return 2}hTe(){return 2}jTe(){return 2}qTe(){return 3}tTe(){}$nd(){return 2}uTe(){}vTe(){}wTe(){return 2}fod(){return 2}god(){return 2}ITe(){return 2}hod(){}NTe(){return 2}jod(){return 2}lod(){return 2}ood(){return 2}qod(){return 2}YTe(){}ZTe(){return 2}tod(){return 2}uod(){return 2}wod(){return 2}xod(){return 2}zod(){return 2}Aod(){return 2}Bod(){return 2}Fod(){return 2}vUe(){return 2}Nod(){return 2}BUe(){return 2}CUe(){}DUe(){return 2}Sod(){return 2}Tod(){return 2}Uod(){return 2}Vod(){return 2}Wod(){return 2}Xod(){return 2}IUe(){return 3}Yod(){}KUe(){return 2}Zod(){return 2}MUe(){return 3}$od(){}OUe(){}apd(){return 2}VUe(){return 3}bpd(){return 2}dpd(){return 2}fpd(){return 2}gpd(){return 2}ZUe(){}$Ue(){return 3}kpd(){return 2}kMb(){return 2}dVe(){}hVe(){return 2}iVe(){return 2}jVe(){return 3}tpd(){return 2}kVe(){return 2}xpd(){return 2}Apd(){return 2}lVe(){}Mpd(){return 2}tVe(){return 2}Upd(){return 2}Vpd(){return 2}EVe(){return 3}FVe(){return 2}dqd(){return 2}eqd(){return 2}fqd(){return 2}gqd(){return 2}LVe(){return 3}hqd(){return 2}jqd(){return 2}nqd(){return 2}PVe(){return 2}Krc(){return 2}RVe(){return 2}SVe(){return 2}oqd(){return 2}TVe(){return 2}VVe(){return 3}pqd(){return 2}sqd(){return 2}tqd(){return 2}uqd(){return 2}wqd(){return 2}static xva(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(Aa.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static PMj(a){if(!a||""===a)return-1;const b=Aa.a.Dg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(Aa.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(Aa.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static Smg(a){return a&&""!==a?Rh.xva(a):null}static Dz(a){let b=null,c=null,f=null,l=null;a&&a.tg&&(b=Rh.nva(a.tg,"id"),c=Rh.nva(a.tg,"lang"),f=a.tg.tagName,
a.dEi&&(l=Object.assign(new dJ,{x:Rh.xva(a.tg.style.left),y:Rh.xva(a.tg.style.top),left:Rh.Smg(a.tg.style.left),top:Rh.Smg(a.tg.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new Vn(new Xu(b,f),a.wx,null,c,l)}static nva(a,b){return a[b]}}Object(m.a)(Rh,"AHtmlTranslator",null,[1850]);class fJ extends Vn{constructor(a,b,c,f,l,u){f=void 0===f?0:f;l=void 0===l?0:l;u=void 0===u?null:u;super(u?u.$V:null,u?u.wx:null,u?u.u7:null,u?u.cultureName:null,u?u.Bka:null);this.width=f;this.height=l}}
Object(m.a)(fJ,"AugmentationSemanticArgs",Vn,[]);class gJ{constructor(){this.stop=this.color=null}}Object(m.a)(gJ,"ColorStopPair",null,[]);class iB{constructor(a,b){this.value=a;this.krj=b}get l7c(){return this.krj}}Object(m.a)(iB,"ElementValueWrapper",null,[]);class hJ extends iB{constructor(a,b,c){super(a,b);this.WEg=c}}Object(m.a)(hJ,"DimensionWrapper",iB,[]);class YD{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.borderTopStyle=void 0===a?0:a;this.borderRightStyle=void 0===b?0:b;this.borderBottomStyle=
void 0===c?0:c;this.borderLeftStyle=void 0===f?0:f;this.borderTopColor=void 0===l?"":l;this.borderRightColor=void 0===u?"":u;this.borderBottomColor=void 0===I?"":I;this.borderLeftColor=void 0===T?"":T;this.borderTopWidth=void 0===ja?"0pt":ja;this.borderRightWidth=void 0===ua?"0pt":ua;this.borderBottomWidth=void 0===Ra?"0pt":Ra;this.borderLeftWidth=void 0===eb?"0pt":eb}}Object(m.a)(YD,"TableCellBorderProperties",null,[]);class ZD{constructor(a,b,c,f){this.QQi=void 0===a?"":a;this.PQi=void 0===b?"":
b;this.NQi=void 0===c?"":c;this.OQi=void 0===f?"":f}}Object(m.a)(ZD,"TableCellMarginProperties",null,[]);class Ah{static get bwg(){return Ah.Bfi}static get qCd(){return Ah.tpi}static get mCd(){return Ah.rpi}static Tle(a,b,...c){b=Ah.Dqg(b);let f=!1;b||(b=Ah.vRj.apply(null,[a].concat(c)),f=!!b);return new iB(b,f)}static Dqg(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static vRj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==
b&&null!==b&&""!==b))return b.trim();return null}static lIj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(Ad.a.Qba(b,0,!1));case "in":return Math.round(Ad.a.g1(b,0,!1));case "cm":return Math.round(Ad.a.g1(Re.a.GVf(b),0,!1));case "mm":return Math.round(Ad.a.g1(Re.a.GVf(.1*b),0,!1));default:return b}}static kwd(a,b,...c){a=Ah.Tle.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=Aa.a.substring(a.value,
0,a.value.length-1)):a.l7c?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=Aa.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=Ah.lIj(c,f)}return new hJ(c,a.l7c,b)}static tWa(a){return Ah.kwd(a,[a.style.width],"width","WIDTH","Width")}static rcb(a){return Ah.kwd(a,[a.style.height],"height","HEIGHT","Height")}static Pie(a){return Ah.kwd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static Qie(a){return Ah.kwd(a,[a.style.marginRight],"rightmargin",
"RIGHTMARGIN","RightMargin")}static DRj(a){a=Ah.Tle(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in Ah.qCd&&void 0!==Ah.qCd[a.value]&&null!==Ah.qCd[a.value]?Ah.qCd[a.value]:0}static Drk(a){a=Ah.Dqg([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static Quj(a){return Ah.Tle(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static l0i(a){const b=Aa.a.substring(a,
0,1),c=Aa.a.substring(a,1,2);a=Aa.a.substring(a,2,3);return b+b+c+c+a+a}static Aea(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=Aa.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return Aa.a.iD(b)}if(Ah.bwg[Aa.a.Dg(b)])return Ah.bwg[Aa.a.Dg(b)];b.startsWith("#")&&(b=Aa.a.substring(b,1,b.length));if(isNaN(parseInt(b,
16)))return"";3===b.length&&(b=Ah.l0i(b));return 6!==b.length?"":b}static Ydl(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static e3c(a,b){const c=Ah.Quj(a);c&&""!==c&&b.sr(f=>f.uyd(Ah.Aea(c)))}static Qgg(a){a=a.style;if(!a)return null;const b=Ah.mCd[a.borderTopStyle],c=Ah.Aea(a.borderTopColor),f=a.borderTopWidth,l=Ah.mCd[a.borderRightStyle],
u=Ah.Aea(a.borderRightColor),I=a.borderRightWidth,T=Ah.mCd[a.borderBottomStyle],ja=Ah.Aea(a.borderBottomColor),ua=a.borderBottomWidth,Ra=Ah.mCd[a.borderLeftStyle],eb=Ah.Aea(a.borderLeftColor);return new YD(b,l,T,Ra,c,u,ja,eb,f,I,ua,a.borderLeftWidth)}static Pvj(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new ZD(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}Ah.Bfi=Qa.a.iJ("aliceblue","F0F8FF","antiquewhite",
"FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400",
"darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro",
"DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90",
"lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred",
"C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown",
"BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen",
"9ACD32");Ah.tpi=Qa.a.iJ("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);Ah.rpi=Qa.a.iJ("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(m.a)(Ah,"DefaultHtmlTranslatorHelper",null,[]);class iJ{constructor(){this.direction=null;this.T5b=new Wu}hug(){return!!this.direction&&0<this.direction.length}}Object(m.a)(iJ,
"LinearGradient",null,[]);class $D{constructor(){this.Owe=this.vec=!1}}Object(m.a)($D,"HtmlTranslatorContext",null,[]);class aE{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd){this.vec=!1;this.CZl=Pd=>Pd.Owe;this.Xki=void 0===a?!1:a;this.bli=void 0===b?!1:b;this.Uki=void 0===c?!1:c;this.ali=void 0===f?!1:f;this.Rni=void 0===l?!0:l;this.Sni=void 0===u?!1:u;this.Tni=void 0===I?!0:I;this.boi=void 0===T?!1:T;this.qoi=void 0===ja?!1:ja;this.hpi=void 0===Ra?!1:Ra;this.Xni=void 0===eb?!1:
eb;this.$fi=void 0===Bb?!1:Bb;this.Wni=void 0===Ub?null:Ub;this.aoi=void 0===Xb?null:Xb;this.Uni=void 0===hd?null:hd;this.Zni=void 0===lc?null:lc;this.Vni=void 0===Ec?null:Ec;this.Yni=void 0===yd?null:yd;this.$ni=void 0===tc?null:tc}get x1a(){return this.Xki}get Tel(){return this.bli}get qth(){return this.Uki}get Sel(){return this.ali}get CXl(){return this.Rni}get DXl(){return this.Sni}get EXl(){return this.Tni}get N3a(){return this.Xni}get Xak(){return this.$fi}get TPh(){return this.boi}get tZl(){return this.qoi}get CVh(){return this.hpi}get QPh(){return this.Wni||
Object(R.a)(this,this.nwd,"returnFalse")}get MXl(){return this.aoi||Object(R.a)(this,this.nwd,"returnFalse")}get LXl(){return this.Zni||Object(R.a)(this,this.k5e,"returnTrue")}get HXl(){return this.Vni||Object(R.a)(this,this.k5e,"returnTrue")}get GXl(){return this.Uni||Object(R.a)(this,this.nwd,"returnFalse")}get KXl(){return this.Yni||Object(R.a)(this,this.k5e,"returnTrue")}get SPh(){return this.$ni||this.CZl||Object(R.a)(this,this.nwd,"returnFalse")}k5e(){return!0}nwd(){return!1}}Object(m.a)(aE,
"HtmlTranslatorSettings",null,[1751]);class jJ extends Vn{constructor(a,b,c,f,l,u,I,T,ja){l=void 0===l?null:l;u=void 0===u?0:u;I=void 0===I?0:I;T=void 0===T?null:T;ja=void 0===ja?null:ja;super(l?l.$V:null,l?l.wx:null,l?l.u7:null,l?l.cultureName:null,l?l.Bka:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=u;this.maxHeight=I;this.href=T;this.desc=ja}}Object(m.a)(jJ,"ImageSemanticArgs",Vn,[]);class kJ{constructor(a,b){this.$3l=a;this.Z3l=b}}Object(m.a)(kJ,"IndentationProperties",
null,[]);class Vy extends Vn{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){f=void 0===f?0:f;l=void 0===l?-1:l;u=void 0===u?!1:u;I=void 0===I?!1:I;T=void 0===T?"":T;ja=void 0===ja?"":ja;ua=void 0===ua?null:ua;Ra=void 0===Ra?-1:Ra;super(c?c.$V:null,c?c.wx:null,c?c.u7:null,c?c.cultureName:null,c?c.Bka:null);this.DBf=a;this.EZb=0;this.RVd=b;this.FYb=1===b&&-1===l&&!this.x6a;this.jQd=f;this.kQd=l;this.GSd=u;this.x6a=I;this.s7a=T;this.gsb=ja;this.aEc=ua;this.JDc=Ra;this.Drb=-1;this.PMc=!0}get listStyleType(){return this.glk?
this.EZb:this.DBf}get glk(){return 0!==this.EZb}get r5l(){return this.RVd}get listLevel(){return this.kQd}set listLevel(a){this.kQd=a}get listId(){return this.jQd}set listId(a){this.jQd=a}get aNb(){return this.GSd}set aNb(a){this.GSd=a}get mbb(){return this.x6a}set mbb(a){this.x6a=a}get levelText(){return this.s7a}set levelText(a){this.s7a=a}get font(){return this.gsb}set font(a){this.gsb=a}get rTa(){return this.aEc}set rTa(a){this.aEc=a}get Gwb(){return this.JDc}set Gwb(a){this.JDc=a}get eDg(){return 6<=
this.listStyleType}get Dek(){return this.FYb}get O8i(){return this.PMc?this.RVd+this.Drb:this.Drb}clone(){const a=new Vy(this.DBf,this.RVd,new Vn(this.$V,this.wx,this.u7,this.cultureName,this.Bka),this.jQd,this.kQd,this.GSd,this.x6a);a.EZb=this.EZb;a.FYb=this.FYb;a.Drb=this.Drb;a.PMc=this.PMc;a.s7a=this.s7a;a.gsb=this.gsb;a.aEc=this.aEc;a.JDc=this.JDc;return a}FEi(a,b,c){this.EZb=a;0<b?(this.FYb=!1,this.Drb=b,this.PMc=!1):(this.Drb++,this.FYb=!c)}}Object(m.a)(Vy,"ListSemanticArgs",Vn,[]);class jB extends Vn{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb){l=void 0===l?null:l;u=void 0===u?0:u;I=void 0===I?null:I;T=void 0===T?null:T;ja=void 0===ja?!1:ja;ua=void 0===ua?!1:ua;Ra=void 0===Ra?69905:Ra;eb=void 0===eb?null:eb;super(eb?eb.$V:null,eb?eb.wx:null,eb?eb.u7:null,eb?eb.cultureName:null,eb?eb.Bka:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.VEb=ua;this.height=f;this.YHa=ja;this.Yxc=l;this.verticalAlignment=u;this.Y7=I;this.nCd=T;this.nRc=Ra}}Object(m.a)(jB,"TableCellSemanticArgs",Vn,[]);class bE extends Vn{constructor(a,
b){b=void 0===b?null:b;super(b?b.$V:null,b?b.wx:null,b?b.u7:null,b?b.cultureName:null,b?b.Bka:null);this.height=a}}Object(m.a)(bE,"TableRowSemanticArgs",Vn,[]);class cE extends Vn{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){ua=void 0===ua?null:ua;Ra=void 0===Ra?-1:Ra;eb=void 0===eb?null:eb;super(eb?eb.$V:null,eb?eb.wx:null,eb?eb.u7:null,eb?eb.cultureName:null,eb?eb.Bka:null);this.BTa=null;this.jW=a;this.Sta=b;this.width=c;if(l)for(this.BTa=Array(l.length),a=0;a<l.length;++a)this.BTa[a]=l[a];this.eAg=
u;this.idf=T;this.Xek=I;this.YHa=f;this.xpe=ja;this.pVh=ua;this.tableLook=Ra}}Object(m.a)(cE,"TableSemanticArgs",Vn,[]);let Cs;class ol extends Rh{get Rik(){var a,b;return null!==(b=null===(a=A.AFrameworkApplication.fa)||void 0===a?void 0:a.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FontFamilyFixEnabled",!1))&&void 0!==b?b:!1}constructor(a,b,c,f){b=void 0===b?null:b;c=void 0===c?null:c;f=void 0===f?null:f;super(a);this.x7a=null;this.Dii=Qa.a.iJ("none",1,"disc",3,"circle",4,"square",
5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.nd=b||new aE;this.ew=c||new $D;this.mQd=f}get XIg(){return this.Dii}hlg(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.XIg[Aa.a.Dg(c)])||(c=Rh.nva(a,"type"))&&""!==c&&(c=this.XIg[c]))return c;if(this.nd.x1a&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=
a.className)&&""!==a)if("ul"===c)switch(a=ol.z2c(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===c)switch(a=ol.z2c(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}zEj(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=za.a.gjg(a,"li");if(!a)return b;
c="li"}if("li"===c){b=(b=this.IZc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=za.a.gjg(a,"p"))return ol.AEj(a)-1}return b}IZc(a,b,c){a=this.nd.x1a?a.getAttribute(b):Rh.nva(a,b);a=parseInt(a);return isNaN(a)||0>a?c:a}P6k(){this.x7a.pop();this.Yg.Qpa()}icc(a,b){this.sr(l=>l.BNa(0,0));const c=this.hlg(a.tg,b?6:2);let f=1;b&&(f=this.IZc(a.tg,"start",1));b=!1;this.nd.x1a&&(b=a.tg.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.tg.removeAttribute("data-pasteFromRc"),(E.a.iV||E.a.jg)&&ol.NRc(a.tg));
a=new Vy(c,f,Rh.Dz(a),0,-1,b,this.nd.x1a);this.x7a.push(a);this.Yg.Spa(a);this.sE(Object(R.a)(this,this.P6k,"onListElementClose"));return 1}reset(){super.reset();this.x7a=new Uy}WLh(a,b){let c=!1;try{var f=b.getAttribute("xml:lang")||Rh.nva(b,"lang")}catch(ja){f=null}f&&""!==f&&(c=a.X7e(f)||c);(f=Rh.nva(b,"dir"))&&(c=a.yRb(f)||c);f=b.style;var l=this.ew.Owe;if(f){if(f.fontWeight){var u=Aa.a.iD(f.fontWeight),I=parseInt(u);isNaN(I)?"BOLD"===u?c=a.fJ(!0)||c:"NORMAL"===u&&(c=a.fJ(!1)||c):c=600<=I?a.fJ(!0)||
c:a.fJ(!1)||c}f.fontSize&&!l&&(u=Math.round(Rh.PMj(f.fontSize)),0<u&&(c=a.OQb(Math.floor(2*u))||c));this.nd.LXl(this.ew)&&(this.nd.TPh&&b.getAttribute?(u=b.getAttribute("data-indent"))&&0<u.length&&(u=Ad.a.tL(parseInt(u),0)+"px",c=a.szd(u)||c):f.textIndent&&(c=a.szd(f.textIndent)||c));this.nd.HXl(this.ew)&&f.marginLeft&&(this.nd.TPh&&b.getAttribute?(u=b.getAttribute("data-margin"))&&0<u.length&&(c=a.yxc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.yxc(f.marginLeft)||c));this.nd.GXl(this.ew)&&f.lineHeight&&
(c=a.j_(f.lineHeight)||c);if(this.nd.EXl)if(u=f.fontVariantCaps?Aa.a.Dg(f.fontVariantCaps):null,I=f.fontVariant?Aa.a.Dg(f.fontVariant):null,"uppercase"===(f.textTransform?Aa.a.Dg(f.textTransform):null))c=a.rzd("uppercase")||c;else if("small-caps"===u||I&&0<=I.indexOf("small-caps"))c=a.rzd("small-caps")||c;this.nd.KXl(this.ew)&&f.textAlign&&(c=a.$nb(Aa.a.Dg(f.textAlign))||c);f.fontStyle&&(u=Aa.a.iD(f.fontStyle),"ITALIC"===u||"OBLIQUE"===u?c=a.p3a(!0)||c:"NORMAL"===u&&(c=a.p3a(!1)||c));u=ol.oPj(b);
if(f.textDecoration||u){I=Aa.a.Dg(f.textDecoration||"");u=Aa.a.Dg(u||"");if(b.parentNode&&b.parentNode.tagName&&"a"===Aa.a.Dg(b.parentNode.tagName)){var T=(b.querySelector(".TextRun")||b).className;T&&-1<T.indexOf("Underlined")&&(c=a.n_(!0)||c)}else if(f.xEm||ol.VD(I)||ol.VD(u))c=a.n_(!0)||c;if(f.wEm||ol.dDg(I)||ol.dDg(u))c=a.l_(!0)||c}if(f.verticalAlign){u=Aa.a.iD(f.verticalAlign);if("SUB"===u||this.nd.SPh(this.ew)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.O7(!0)||c;else if("SUPER"===
u||this.nd.SPh(this.ew)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.m_(!0)||c;"SUB"!==u&&"SUPER"!==u||!b.getAttribute||(u=parseFloat(b.getAttribute("data-fontsize")),isNaN(u)||(c=a.P7e(Math.floor(2*u))||c))}f.fontFamily&&!l&&(c=this.tQl(a,f.fontFamily,c));u=null;f.color&&(u=Ah.Aea(f.color));I=!!u;this.nd.MXl(this.ew)&&b.getAttribute&&(I=b.getAttribute("data-scheme-color"),u=null!==I?I:u,I="inherit"!=f.color&&(""!==u||!this.ew.vec||ol.$rk(b))&&!l);I&&(c=a.Jr(u)||c);this.nd.CXl&&!this.ew.vec&&
f.backgroundColor&&!l&&(this.nd.Tel&&b.tagName&&ol.U8l.contains(Aa.a.iD(b.tagName))||(c=a.Pqa(Ah.Aea(f.backgroundColor))||c));if(this.nd.DXl&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&!l&&(l=ol.wRj(f.backgroundImage))&&0<l.T5b.count){u=l.T5b.ga(0).color;I=!0;for(T=0;T<l.T5b.count&&(I=I&&u===l.T5b.ga(T).color,I);T++);I&&(da.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.Pqa(Ah.Aea(u))||c)}}this.nd.QPh(this.ew)&&b.getAttribute&&(l=b.getAttribute("data-ccp-props"))&&
(c=a.Sqa(l)||c);b.getAttribute&&((l=b.getAttribute("data-ccp-charstyle"))&&this.nd.N3a&&(c=a.via(l)||c),(l=b.getAttribute("data-ccp-parastyle"))&&this.nd.N3a&&(c=a.Xyd(l)||c),"true"==b.getAttribute("data-hyperlinkhascustomcolor")&&(da.ULS.sendTraceTag(508900183,307,50,"Paste hyperlink with custom color"),b=null,f.color&&(b=Ah.Aea(f.color),a.o3a(!1)),c=a.Jr(b)||c));return c}sZl(a){if(this.nd.tZl)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===String&&-1<Aa.a.iD(a.className).indexOf("MSOCOM"))return!0;
if("DIV"===Aa.a.iD(a.tagName))break;a=a.parentNode}return!1}tQl(a,b,c){if(this.Rik){b=ol.Ytj(b);if(!b)return c;let l=!1;for(var f of b)if(l=a.wAa(f,this.nd.CVh))break;return l||c}f=this.vjg(b);return a.wAa(f,this.nd.CVh)||c}K2(a,b){"\u200b"===a&&(a="\u00a0");b&&b.tg&&this.sZl(b.tg)&&(a="");this.Yg.K2(a,Rh.Dz(b))}Wnd(a){const b=Rh.nva(a.tg,"href");return b&&""!==b?(this.Yg.Xya(b,Rh.Dz(a)),this.sE(Object(R.a)(this.Yg,this.Yg.Wya,"onAnchorEnd")),1):2}$nd(){return this.sr(a=>a.fJ(!0))?1:2}fod(){return this.sr(a=>
a.yme())?1:2}god(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}hod(a){this.Yg.Ppa(Rh.Dz(a))}jod(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}ood(){return this.sr(a=>a.p3a(!0))?1:2}lod(a){this.sr(b=>b.$nb("center"));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}qod(){return this.sr(a=>a.wAa("consolas"))?1:2}uod(){return this.sr(a=>a.l_(!0))?1:2}tod(a){return this.icc(a,
!1)}wod(){return this.sr(a=>a.p3a(!0))?1:2}xod(a){return this.icc(a,!1)}zod(a){var b=a.tg.getAttribute("data-render-src");const c=a.tg.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const I=a.tg.getAttribute("data-render-fallback");let T=0,ja=0;if(a.tg.currentStyle){var f=a.tg.currentStyle.width,l=a.tg.currentStyle.height;f&&-1!==f.indexOf("px")&&(f=parseInt(Aa.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(T=f));l&&-1!==l.indexOf("px")&&(l=parseInt(Aa.a.substring(l,0,l.indexOf("px"))),
isNaN(l)||(ja=l))}a=new fJ(b,c,I,T,ja,Rh.Dz(a));this.Yg.m1a(a);return 2}this.nd.x1a&&(E.a.iV||E.a.jg)&&(b=a.tg.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.nd.x1a&&b&&b.length&&ol.NRc(a.tg));const u=a.tg.getAttribute("align");this.sr(I=>I.$nb(u));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Aod(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Bod(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,
"onParagraphEnd"));return 1}Fod(){return this.sr(a=>a.p3a(!0))?1:2}Nod(a){return this.sr(b=>{var c=this.vjg(a.tg.getAttribute("face"));c=b.wAa(c);b=b.Jr(Ah.Aea(a.tg.getAttribute("color")));return c||b})?1:2}Sod(a){this.sr(b=>this.nd.N3a?b.v3a(1):b.w3a(1));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Tod(a){this.sr(b=>this.nd.N3a?b.v3a(2):b.w3a(2));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Uod(a){this.sr(b=>this.nd.N3a?
b.v3a(3):b.w3a(3));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Vod(a){this.sr(b=>this.nd.N3a?b.v3a(4):b.w3a(4));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Wod(a){this.sr(b=>this.nd.N3a?b.v3a(5):b.w3a(5));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Xod(a){this.sr(b=>this.nd.N3a?b.v3a(6):b.w3a(6));this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));
return 1}Yod(a){this.Yg.Ppa(Rh.Dz(a))}$od(a){var b=a.tg;const c=b.src,f=b.alt,l=b.Uvm;let u=0,I=0;b.style&&(u=Rh.xva(b.style.width),I=Rh.xva(b.style.height));u&&I||(u=b.width,I=b.height);let T=b=0;a.tg.currentStyle&&(u||I||(u=Rh.xva(a.tg.currentStyle.width),I=Rh.xva(a.tg.currentStyle.height)),b=Rh.xva(a.tg.currentStyle.maxWidth),T=Rh.xva(a.tg.currentStyle.maxHeight));a=new jJ(c,f,u,I,Rh.Dz(a),b,T,l);this.Yg.Opa(a)}Zod(){return this.sr(a=>a.p3a(!0))?1:2}apd(){return this.sr(a=>a.n_(!0))?1:2}bpd(){return this.sr(a=>
a.wAa("consolas"))?1:2}dpd(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}fpd(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}gpd(a){let b;const c=this.hlg(a.tg,0);let f=this.IZc(a.tg,"value",0);var l=!1;0<this.x7a.count?b=this.x7a.peek():(b=new Vy(2,1,Rh.Dz(a)),f||(f=1));if(this.nd.x1a){let ja=b.listId;l=this.zEj(a.tg);l=0>l&&0>b.listLevel&&0<this.x7a.count?b.listLevel=this.x7a.count-1:b.listLevel=0<=l?l:b.listLevel;
this.mQd&&this.mQd.b<l&&(this.mQd.b=l);1>ja&&(ja=b.listId=this.IZc(a.tg,"data-listid",0));a.tg.getAttribute("data-leveltext")&&(b.levelText=a.tg.getAttribute("data-leveltext"));var u=a.tg.getAttribute("data-font");u&&(b.font=u);u=!1;A.AFrameworkApplication.fa&&(u=A.AFrameworkApplication.fa.getBooleanAppSetting("FollowDestinationThemePasteIsEnabled"));if(u){var I=a.tg.getAttribute("data-charcodes");u=[];if(I&&""!==I)if(-1<I.indexOf(",")){I=I.split(",");for(var T=0;T<I.length;T++)Array.add(u,parseInt(I[T]))}else Array.add(u,
parseInt(I));if(u&&0<u.length){I=Array(u.length);for(T=0;T<u.length;T++)I[T]=u[T];b.rTa=I}(u=a.tg.getAttribute("data-buAutoNum"))&&0<u.length&&(b.Gwb=parseInt(u))}(l=0<=l&&0<ja)&&ol.NRc(a.tg)}b.FEi(c,f,l);this.Yg.aza(b.clone());this.sE(Object(R.a)(this.Yg,this.Yg.Rpa,"onListItemEnd"));return 1}kMb(a){return this.icc(a,!1)}kpd(a){if(this.sr(b=>b.iRb(!0))){const b=a.tg.getAttribute("OuterHtml");this.Yg.bza(b,Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.LLa,"onMathEnd"))}return 1}tpd(a){return this.icc(a,
!0)}xpd(a){this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Apd(a){const b=a.tg.getAttribute("align");this.sr(c=>c.$nb(b));if(this.nd.x1a){const c=a.tg.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&ol.NRc(a.tg,E.a.iV||E.a.jg)}this.Yg.zB(Rh.Dz(a));this.sE(Object(R.a)(this.Yg,this.Yg.yB,"onParagraphEnd"));return 1}Mpd(){this.sr(a=>a.wAa("consolas"));this.Yg.l1a();this.sE(Object(R.a)(this.Yg,this.Yg.k1a,"onPreFormattedTextEnd"));return 1}Upd(){return this.sr(a=>
a.l_(!0))?1:2}Vpd(){return this.sr(a=>a.wAa("consolas"))?1:2}dqd(){return this.sr(a=>a.Iaf())?1:2}eqd(a){var b=a.tg.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=Ah.Ydl(c);if(0<b&&this.nd.Xak){for(c=0;c<b;c++)this.Yg.p1a(Rh.Dz(a));return 3}return 2}fqd(){return this.sr(a=>a.l_(!0))?1:2}gqd(){return this.sr(a=>a.fJ(!0))?1:2}hqd(){return this.sr(a=>a.O7(!0))?1:2}jqd(){return this.sr(a=>a.m_(!0))?1:2}nqd(a){this.sr(Ra=>Ra.clearFormatting()&&Ra.G4e());Ah.e3c(a.tg,this);const b=Ah.tWa(a.tg),
c=Ah.Qgg(a.tg),f=Ah.Pie(a.tg),l=Ah.Qie(a.tg),u=!parseInt(Rh.nva(a.tg,"border")),I=Ah.Drk(a.tg);let T=-1,ja="";var ua=-1;a.tg.attributes.hasOwnProperty("style")&&-1!==(ua=a.tg.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?T=parseInt(a.tg.attributes.getNamedItem("style").value.substr(ua+17)):a.tg.attributes.hasOwnProperty(na.a.t9d.toString())&&(T=parseInt(a.tg.attributes.getNamedItem(na.a.t9d.toString()).value));ua=-1;a.tg.attributes.hasOwnProperty("class")&&-1!==(ua=a.tg.attributes.getNamedItem("class").value.indexOf("Mso"))?
ja=a.tg.attributes.getNamedItem("class").value.substr(ua).split(" ")[0]:a.tg.attributes.hasOwnProperty(na.a.u9d.toString())&&(ja=a.tg.attributes.getNamedItem(na.a.u9d.toString()).value);this.Yg.SZ(new cE(0,0,b.value,b.WEg,null,u,I,c,new kJ(f.value,l.value),ja,T,Rh.Dz(a)));this.sE(Object(R.a)(this.Yg,this.Yg.PZ,"onTableEnd"));return 1}Krc(a){const b=Ah.rcb(a.tg),c=Ah.tWa(a.tg);if(!c.value&&c.l7c&&this.nd.qth)return 3;let f=parseInt(Rh.nva(a.tg,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?
1:0;let l=parseInt(Rh.nva(a.tg,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let u=!1;a.tg.attributes.hasOwnProperty("style")&&(u=-1!==a.tg.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.tg.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!u&&a.tg.attributes.hasOwnProperty("class")&&(u=-1!==a.tg.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let I=69905;if(a.tg.attributes.hasOwnProperty(na.a.s9d.toString())){var T=
parseInt(a.tg.attributes.getNamedItem(na.a.s9d.toString()).value);isNaN(T)||(I=T)}T=Ah.Aea(a.tg.style.backgroundColor);const ja=Ah.DRj(a.tg);this.sr(eb=>eb.BNa(0,0));Ah.e3c(a.tg,this);const ua=Ah.Qgg(a.tg),Ra=this.nd.Sel?Ah.Pvj(a.tg):null;a=new jB(f,l,c.value,b.value,T,ja,ua,Ra,c.WEg,u,I,Rh.Dz(a));this.Yg.OZ(a);this.sE(Object(R.a)(this.Yg,this.Yg.NZ,"onTableCellEnd"));this.$0k();return 1}oqd(a){const b=this.Krc(a);if(3===b)return b;this.sr(c=>{const f=c.fJ(!0);c=c.$nb("center");return f||c});Ah.e3c(a.tg,
this);return 1}pqd(a){Ah.e3c(a.tg,this);const b=Ah.rcb(a.tg);if(b.l7c&&!b.value&&this.nd.qth)return 3;this.Yg.RZ(new bE(b.value,Rh.Dz(a)));this.sE(Object(R.a)(this.Yg,this.Yg.QZ,"onTableRowEnd"));return 1}sqd(){return this.sr(a=>a.wAa("consolas"))?1:2}tqd(){return this.sr(a=>a.n_(!0))?1:2}uqd(a){return this.icc(a,!1)}wqd(){return this.sr(a=>a.n_(!0))?1:2}wAj(a){if(!a)return null;a=a.split(",");return a[0].startsWith("WordVisi")&&1<a.length?a[1].trim():a[0]}static RZh(a){if(!a)return null;a=Aa.a.d3e(a.trim(),
'"');return a=Aa.a.d3e(a,"'")}vjg(a){if(!a)return null;a=this.wAj(a);return a=ol.RZh(a)}static Xtj(a){if(a)return a.split(",")}static Ytj(a){var b;if(a)return a=null===(b=ol.Xtj(a))||void 0===b?void 0:b.map(c=>ol.RZh(c)),null===a||void 0===a?void 0:a.filter(c=>!!c)}static VKf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.hug())return!1;a.direction=b;return!0}if((c=b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.hug())return!1;
a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:Ah.Aea(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new gJ;f.color=c;f.stop=b;a.T5b.add(f);return!0}static wRj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);b=b.substr(0,b.lastIndexOf(")"));const c=new iJ;for(;0<b.trim().length;){let f=b.indexOf(",");const l=b.indexOf("(");
if(0<l&&l<f){const u=b.indexOf(")");if(u<l)return null;f=b.indexOf(",",u)}if(-1===f){if(!ol.VKf(c,b))return null;b=""}else{const u=b.substr(0,f);b=b.substr(f+1);if(!ol.VKf(c,u))return null}}return c}catch(b){return null}}static z2c(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static NRc(a,b){b=void 0===b?!1:b;a&&3!==a.nodeType&&(a.style.margin="",b&&ol.ZWf(a,b))}static ZWf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=
""),b&&ol.ZWf(a,b)),a=a.nextSibling}static AEj(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static $rk(a){return!(void 0===a.className||null===a.className)&&a.className.startsWith("TextRun")}static oPj(a){a=a.style.textDecorationLine;
return void 0===a||null===a?null:a}static dDg(a){return 0<=a.indexOf("line-through")}static VD(a){return 0<=a.indexOf("underline")}}ol.U8l=(Cs=new La.a,Cs.add("TABLE"),Cs.add("THEAD"),Cs.add("TBODY"),Cs.add("TFOOT"),Cs.add("TR"),Cs.add("TH"),Cs.add("TD"),Cs);Object(m.a)(ol,"DefaultHtmlTranslator",Rh,[]);var An=d(315);class xk{constructor(a){this.cU=(void 0===a?null:a)||An.a.ame("");this.UIc=Number.parseInvariant((new Date).format("HHmmss"))}get Qb(){return this.cU}process(a,b){if(a&&a.querySelectorAll){const u=
a.querySelectorAll("p");if(u&&0<u.length){for(var c=0,f=!1,l=u[0].parentNode;5>c&&l&&l!==a;){c++;const I=l.id.toLowerCase();if(I&&I.length&&-1!==I.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),c=l}a=new uf.a(b,Object(R.a)(this,
this.MZe,"processNodesDiscovery"),new XD(u));a.Fm("Word Converter Operation");a.Bj=!b||b.Bj;a.Lh()}}}MZe(a,b){const c=b.nodes[b.V4];var f=xk.Aie(c);if(f){let u=f.cPa.replace(RegExp("level[0-9]"),"").trim();u=u&&u.length?u:f.cPa;let I=b.lists[u];I||(I=new bJ,I.D_=this.UIc++);let T=I.FFb[f.level-1];T||(T=new cJ,T.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(T.tagName=l)}else T.R0a=xk.Zig(c,5),T.R0a&&T.R0a.length||
(T.R0a=xk.hle(c,5)),T.ignore=!T.R0a||!T.R0a.length,T.tagName=xk.S_c(T.R0a);f.D_=I.D_;T.Cqc++;T.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=xk.hle(c,5))?l:T.R0a)&&l.length&&(f.Ilj=l,(l=xk.wRl(c,l,T.listStyle,f.level-1))&&l.length&&(T.listStyle=l));b.daa[b.daa.length]=f;T.daa.contains(f)||T.daa.add(f);if(void 0===I.FFb[f.level-1]||null===I.FFb[f.level-1]||I.FFb[f.level-1]!==T)I.FFb[f.level-1]=T;b.lists[u]&&b.lists[u]===I||(b.lists[u]=I);b.uFb=c}else if((f=b.uFb)&&xk.Sac(c)===f&&c.tagName===
f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.V4++;if(b.nodes.length<=b.V4){if(!b.daa.length)return!1;b.V4=0;a.sh(Object(R.a)(this,this.LZe,"processNodeConvert"))}return!0}LZe(a,b){a=b.daa[b.V4];var c=a.Wrc,f=a.cPa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.cPa;f=b.lists[f];var l=f.FFb[a.level-1],u=c.parentNode.tagName.toLowerCase();
if(!l.ignore&&c.parentNode&&"li"!==u){if(u=xk.p4i(c,l)){xk.w5b(c,5);const I=c.ownerDocument.createElement("LI");I.setAttribute("data-aria-level",String.format("{0}",a.level));for(I.setAttribute("data-listid",String.format("{0}",f.D_));c.firstChild;)I.appendChild(c.firstChild);u.appendChild(I);c.parentNode.removeChild(c);"UL"===l.tagName?this.Qb.b++:this.Qb.c++}}else"li"===u&&(l=l.tagName,c=c.parentNode,a.aNb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc","true"),
c.setAttribute("data-listid",String.format("{0}",f.D_)),"UL"===l?this.Qb.b++:this.Qb.c++);b.V4++;return b.V4<b.daa.length}static p4i(a,b){a=xk.m4i(a,b.tagName);return xk.U6d(a,b)}static U6d(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static m4i(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",
c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?ol.z2c(c,"NumberListStyle"):ol.z2c(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static w5b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&xk.w5b(f,b-1);if(xk.kve(f)||xk.Vec(f))a.removeChild(f),c--}}static Aie(a){if(1===a.nodeType){var b=xk.sbc(a,"mso-list");if(b&&0<b.length)try{var c=
b.split(" ");if(3===c.length){var f=new hB;f.level=Number.parseInvariant(c[1].substr(5));f.cPa=b;f.Wrc=a;f.aNb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+Qe.a.O3b),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new hB,f.level=Number.parseInvariant(b),f.cPa=c+" level"+b,f.Wrc=a,f.aNb=!1,f}return null}static wRl(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===xk.S_c(b))return c=xk.zvj(b),
Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?xk.pKj(c,f):1,1!==f&&((c=xk.WSc(a,l,RegExp("^[ivxlcdm]+"),Aa.a.u_f,"NumberListStyle3"))||(c=xk.WSc(a,l,RegExp("^[IVXLCDM]+"),Aa.a.u_f,"NumberListStyle5")))||f&&((c=xk.WSc(a,l,RegExp("^[a-z]+"),Aa.a.t_f,"NumberListStyle2"))||
(c=xk.WSc(a,l,RegExp("^[A-Z]+"),Aa.a.t_f,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static zvj(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static pKj(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static WSc(a,
b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static S_c(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static hle(a,b){let c=null;var f;let l,u;for(let I=-1;!c&&I<a.childNodes.length;I++){const T=-1===I?a:a.childNodes[I];if(T)if((f=T.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(u=f.indexOf("\x3c!--[endif]--\x3e"),0<=u)){f=f.substring(l,u+14);T.innerHTML=
T.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=I&&1===T.nodeType&&1<b&&(c=xk.hle(T,b-1))}return c}static Zig(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];xk.Vec(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=xk.Zig(l,b-1))}return c}static Vec(a){return 1===a.nodeType&&
(a=xk.sbc(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static kve(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static sbc(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static Sac(a){do a=a.previousSibling;while(a&&xk.Fec(a));return a}static Fec(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(xk.hQd,
""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:xk.Fec(a.firstChild):!0}}xk.hQd=RegExp("[\n|\r]","gi");Object(m.a)(xk,"WacAndRichClientWordConverter",null,[1848]);class lJ{constructor(){this.D_=0;this.tagName="UL";this.T9b=null;this.ignore=!1;this.Cqc=0}}Object(m.a)(lJ,"ListMetadata",null,[]);class Zl{constructor(a){this.UIc=1;this.cU=(void 0===a?null:a)||An.a.ame("")}get Qb(){return this.cU}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&
0<a.length&&(a=new uf.a(b,Object(R.a)(this,this.MZe,"processNodesDiscovery"),new XD(a)),a.Fm("Word Converter Operation"),a.Bj=!b||b.Bj,a.Lh())}MZe(a,b){const c=b.nodes[b.V4];var f=Zl.Aie(c);if(f){let l=b.Fla[f.level-1];l||(l=new WD,b.Fla[f.level-1]=l);b.uFb&&Zl.Sac(c)!==b.uFb&&Zl.sFl(b);let u=l.aJg[f.cPa];if(!u)u=new lJ,u.D_=this.UIc++,u.T9b=Zl.rhe(c,5),u.ignore=!u.T9b||!u.T9b.length,u.tagName=Zl.S_c(u.T9b),l.aJg[f.cPa]=u,b.lists[u.D_.toString()]=u;else if(!u.ignore&&1===u.Cqc){const I=Zl.rhe(c,5);
u.tagName=u.T9b===I?"UL":"OL"}f.D_=u.D_;u.ignore||"OL"===u.tagName&&0<u.Cqc&&l.vUc!==f.D_?(u.ignore=!0,b.Fla[0].vUc=-1,b.Fla=b.Fla.slice(0,1)):(b.Fla.length>f.level&&(b.Fla=b.Fla.slice(0,f.level)),l.vUc=f.D_,b.daa[b.daa.length]=f,u.Cqc++);b.uFb=c}else if((f=b.uFb)&&Zl.Sac(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.V4++;
if(b.nodes.length<=b.V4){if(!b.daa.length)return!1;b.V4=0;a.sh(Object(R.a)(this,this.LZe,"processNodeConvert"))}return!0}LZe(a,b){var c=b.daa[b.V4];a=c.Wrc;const f=b.lists[c.D_.toString()];if(!f.ignore&&(c=Zl.oHj(a,c,f))){Zl.w5b(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===f.tagName?this.Qb.b++:this.Qb.c++}b.V4++;return b.V4<b.daa.length}static oHj(a,b,c){let f=Zl.iBh(a,b.level,c);const l=ca.a.Ie(f,
"UniqueListId");if(l&&l!==b.D_||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;ca.a.Uw(f,"UniqueListId",b.D_);return Zl.U6d(f,c)}static U6d(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(ca.a.Uw(b,"UniqueListId",ca.a.Ie(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static iBh(a,b,c){let f=null,l;1===b?l=Zl.Sac(a):(f=Zl.iBh(a,
b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const u=l.tagName.toUpperCase();if("UL"===u||"OL"===u)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static w5b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&Zl.w5b(f,b-1);if(Zl.kve(f)||Zl.Vec(f))a.removeChild(f),c--}}static Aie(a){if(1===a.nodeType){const b=Zl.sbc(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=
new hB;f.level=Number.parseInvariant(c[1].substr(5));f.cPa=b;f.Wrc=a;return f}}catch(c){}}return null}static S_c(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static rhe(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];Zl.Vec(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&(c=Zl.rhe(l,b-1))}return c}static Vec(a){return 1===a.nodeType&&(a=Zl.sbc(a,"mso-list"))&&0<a.length&&"ignore"===
a.trim().toLowerCase()?!0:!1}static kve(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static sbc(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static Sac(a){do a=a.previousSibling;while(a&&Zl.Fec(a));return a}static Fec(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Zl.hQd,""),!a.trim().length):1!==a.nodeType||
a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Zl.Fec(a.firstChild):!0}static sFl(a){for(let b=0;b<a.Fla.length;b++){const c=a.Fla[b];c&&(c.vUc=-1)}}}Zl.hQd=RegExp("[\n|\r]","gi");Object(m.a)(Zl,"WordConverter",null,[1848]);class dE{constructor(a){this.x6a=a.getBooleanAppSetting("ExternalPasteImprovementsEnabled")&&a.getBooleanAppSetting("ListMarkerIsEnabled")}get mbb(){return this.x6a}create(a){a=void 0===a?null:a;return this.x6a?new xk(a):new Zl(a)}}Object(m.a)(dE,"Box4WordConverterFactory",
null,[1836]);var mJ=d(720);class nJ{constructor(a,b,c,f,l){this.hsf=0;this.yd=a;this.Ed=b;this.mJd=l;this.m0=c;this.VRa=f}KSi(a,b,c){da.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.Ed.nx);a.Bj&&this.Ed.Fk&&window.chrome&&da.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.m0.Vea(!!(b&16));this.VRa.create(a,Object(R.a)(this,this.djf,"waitingForEnsureAccessOperationResult"),
null).Fm("ClipboardPreProcess");this.hsf=Date.now()}UFl(){this.m0.reset()}djf(a){let b=!0;const c=this.m0.Xhj,f=null==this.m0.Ehj;null!=c?(a.s7=c,b=!1):Date.now()-this.hsf>this.mJd&&!f&&(da.ULS.sendTraceTag(18354843,307,50,null),this.yd.kc(be.a.ama,{["Reason"]:Ud.a.Hrh}),b=a.s7=!1);return b}}Object(m.a)(nJ,"ClipboardOperationClipboardAccessHelper",null,[1818]);class kB{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc){this.Ca=a;this.yd=b;this.ht=c;this.Rj=f;this.Vc=l;this.m0=u;this.Cs=I;this.Bf=
T;this.fka=ja;this.OL=ua;this.gka=Ra;this.Jtb=eb;this.v8a=Bb;this.Kk=Xb;this.wYb=Ub?Ub.getBooleanAppSetting("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.OYb=Ub?Ub.getBooleanAppSetting("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.bZb=Ub?Ub.getBooleanAppSetting("TextLayoutServiceUseResponse"):!1;this.Ed=tc;this.jd=lc}get zi(){return this.Rj}get fd(){return this.yd}kom(a){a.Hra();return!0}M_f(a,b){a=b.mq;da.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){let c=null;b.Yf&&b.Yf.Lg&&(c=b.Yf.Lg.Mo);
let f=!1;this.wYb&&E.a.$Ha&&this.Kk.Gvd(c,"data-src","data-srcurl");this.OYb&&(f=this.Kk.a5b(b.Yf.Lg.Mo,b.Yf.Xd,!0));this.bZb&&this.Kk.YEd(c,!1);Ae.a.addHandler(c,la.a.copy,Object(R.a)(this,this.e3f,"cutCopyHandlerForRibbon"));a=this.m0.copy();Ae.a.removeHandler(c,la.a.copy,Object(R.a)(this,this.e3f,"cutCopyHandlerForRibbon"));this.wYb&&E.a.$Ha&&this.Kk.Gvd(c,"data-srcurl","data-src");this.OYb&&f&&this.Kk.a5b(b.Yf.Lg.Mo,b.Yf.Xd,!1);this.bZb&&this.Kk.YEd(c,!0);if(!a)return da.ULS.sendTraceTag(6305540,
307,50,"SystemClipboard didn't copy"),this.fd.kc(be.a.rbb,{["Reason"]:Ud.a.gdf}),b.M2&&b.M2.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}e3f(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.ige();({w7b:c}=this.Kk.$Zh(c));c&&(a.preventDefault(),a.stopPropagation(),b.setData("text/html",Ac.c(c)),b.setData("text/plain",c.innerText))}}ige(){if(this.Ed.oT){const a=this.jd.lva();if(a&&a.em)return a.em.getSelection()}da.ULS.sendTraceTag(509109137,
307,10,"Browser don't support DomL2Selection");return null}x6b(a,b){const c=b.Yf;da.ULS.shipAssertTag(18130961,307,!!(b.mq&16));b.v2l?this.ht.eXf():this.ht.f7d(c,a);return!0}RUc(a,b){var c=b.context,f=b.Bd;const l=b.gL;var u=!1;a=this.Vc.Oa.kb.vf;if(this.Cs.jn(a)||this.Bf.Om(a)){const I=this.OL.Pc(a.node),T=I.wf();da.ULS.shipAssertTag(18130962,307,T);this.fka.$e(I);this.gka.Peb(I)&&(u=!0)}f=b.mq&64?new W.DictionaryPropertySet:f||new W.DictionaryPropertySet;f.setValue(Oe.a.ezb,!1);c=this.Ca.Ai(c,G.a.PJ,
2,!0,l,f);8===c&&(da.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.fd.kc(be.a.ama,{["Reason"]:Ud.a.q4f}),b.M2&&b.M2.fail("DeleteKey failed",!1),b.failed=!0);32===c&&u&&(b=this.Vc.Oa.kb,this.Bf.uy(b)&&b.Ua.node===a.node&&!this.Cs.textLength(b.Ua.node)&&(b=this.OL.Pc(b.Ua.node),a=this.Bf.Bu(b),da.ULS.shipAssertTag(18130964,307,a),this.fka.$e(b),this.gka.WDb(b)||(a=this.Jtb.create(),a.Uc(b),this.fka.Pya(a,!1,!1),u=this.fka.Ti(a),this.Cs.ke(u)&&(this.fka.$e(a),this.zi.merge(a,b,!1,!1),this.Vc.setSelection(this.v8a.fh(u,
this.Cs.textLength(u)))))));return!0}}Object(m.a)(kB,"ClipboardOperationCutCopy",null,[1842]);class oJ{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc){this.Ca=a;this.yd=b;this.ht=c;this.m0=u;this.Vc=l;this.Rj=f;this.Cs=I;this.Bf=T;this.fka=ja;this.OL=ua;this.gka=Ra;this.Jtb=eb;this.v8a=Bb;this.La=Ub;this.Kk=Xb;this.Ed=tc;this.jd=lc}create(){return new kB(this.Ca,this.yd,this.ht,this.Rj,this.Vc,this.m0,this.Cs,this.Bf,this.fka,this.OL,this.gka,this.Jtb,this.v8a,this.La,this.Kk,this.Ed,this.jd)}}
Object(m.a)(oJ,"Factory",null,[1744]);class pJ{FPh(){return!0}}Object(m.a)(pJ,"ClipboardOperationCutStrategy",null,[1758]);var Dt=d(471),eE=d(1285),fE=d(231);class Qp{constructor(a,b,c,f,l,u,I,T){u=void 0===u?null:u;I=void 0===I?"":I;T=void 0===T?!0:T;this.Qua=this.xBd=this.U1a=this.Jvd=null;this.Zec=!1;this.ppe=null;this.XSe=0;this.context=a;this.Yf=a.view;this.mq=b;this.Bd=l;this.M2=c;this.gL=f;this.tQb=this.failed=!1;this.Bqd=null;this.yeb=this.tEb=!1;this.v2l=Qp.H6d(a);this.browserName=I;this.w4h=
T;this.VOa=!1;this.NTa=0;this.j5d=Ua.a.create().toString();if(a=Object(gc.a)(10,l)?l:null){this.U1a=new W.DictionaryPropertySet;this.U1a.fz(a);if(a.ra(Oe.a.urd,!1)){this.tEb=!0;this.yeb=a.ra(Oe.a.yeb,!1);this.Bqd=u;for(u=this.Yf.Rb.Ik;u.ry;)u=u.getContext(0);if(l=Object(gb.a)(Vg.AParagraphNode,u.node)){c=0;f=$a.ParagraphReader.textLength(l);switch(u.contextId){case ta.a.textRange:c=u.Ra;f=u.Pb;break;case ta.a.endOfParagraph:c=f}this.Jvd=Od.a.xBj(u.node,c);da.ULS.shipAssertTag(6305503,307,!!this.Jvd);
l=gf.HyperlinkReader.tac(l);for(const ja of l)ja.Pb<=c||ja.Ra>=f||Qp.hyperlinkEditor.eL(u.node,ja.hyperlink)}}this.tQb=a.ra(Oe.a.tQb,!1);this.VOa=a.ra(Oe.a.VOa,!1)}b&64&&(this.tQb=!0)}static get fd(){return jd.a.instance}static get hyperlinkEditor(){return Qp.uo||(Qp.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static H6d(a){if(a){if(a.ry){for(let b=0;b<a.length;b++)if(Qp.H6d(a.getContext(b)))return!0;return!1}if(Object(gc.a)(fE.a,a))return Qp.H6d(a.GF);if($a.ParagraphReader.ke(a.node)&&a.node.zD)return!0}return!1}}
Qp.uo=null;Object(m.a)(Qp,"ClipboardActionArguments",null,[]);var Kw;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.pasteAsMerge=16384]="pasteAsMerge";a[a.showPlaceholderGlossary=
65536]="showPlaceholderGlossary"})(Kw||(Kw={}));Object(m.b)("ClipboardActionFlags",Kw);const qJ=a=>{a=a.Oa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},rJ=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),b[c]=b[c]?b[c]+1:1;a="";for(const f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};class sJ extends Dt.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f){$f=
void 0===$f?!0:$f;super();this.RUd=this.Fda=this.z8=this.rD=null;this.init(a);this.Fm("ClipboardOperation");this.eHa(ja,b,l,u,I);this.yd=ua;this.Bf=Ra;this.Ed=eb;this.lm=Bb;this.xpf=Ub;this.Apf=Xb;this.ypf=tc;this.Bpf=lc;this.gEc=Ec;this.tJd=hd;this.fWb=T;this.YVb=yd;this.VRa=Pd;this.eri=$f;this.QE=pe;this.zd=Se;this.$t=vf;this.Ida=ug;this.ew=f;this.wDa=Tg;I&&Object(gc.a)(10,I)&&(this.Fda=Object(gb.a)(563,I.ra(Oe.a.yTa,null)));this.Fda||(this.Fda=this.wDa.Hbf());this.z5a=void 0===c||null===c?"NotAvailable":
Object(eE.a)(Kw,c);this.Fda.TDi(this.z5a.split(", "));a=this.ew;a.view.xi?(this.$g=a.view,this.$g.Rb?(this.AJ=0,this.NW=c,this.Gub=lc.cNb,!$f||this.Gub&&this.Gub.kb&&this.Gub.length?(lc=Bc.SelectionEditor.uy(this.Gub.kb),lc=!(this.NW&16&&lc),lc=hd.Ufk(c,this.Ik)&&lc,1!==this.behavior&&lc||(lc||this.Fda.fail("Clipboard operation disabled for selection",!0),this.Op=lc?32:8,this.i_())):(this.yd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),this.Fda.fail("No selection when one required",!0),this.Op=8,this.finish())):
(this.yd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),this.Fda.fail("No selection manager",!1),this.Op=8,this.finish())):(this.yd.kc(be.a.ei,{["Reason"]:Ud.a.Fnd}),this.Fda.fail("Not in interactive view",!0),this.Op=8,this.finish())}get Ik(){this.RUd||(this.RUd=Me.a.Jwb(this.Gub));return this.RUd}X2(){super.X2();this.Gub=null}Lh(){const a={};a.StartClipboardOperation=Date.now();0===this.AJ&&this.setup();a.ClipboardSetupTime=Date.now();1===this.AJ&&this.process();a.ClipboardProcessTime=Date.now();2===this.AJ&&
this.teardownSync();a.ClipboardteardownSyncTime=Date.now();3===this.AJ&&this.teardownAsync();a.ClipboardteardownAsyncTime=Date.now();4===this.AJ&&this.finish();a.ClipboardFinishTime=Date.now();A.AFrameworkApplication.Pa.XOb(this.actionId,"Box4ClipboardOperationStagesTelemetry",a)}setup(){if(this.NW&256&&this.fWb){this.ox||this.gEc.KSi(this,this.NW,this.z5a);this.ox.Lh();if(this.ox.f1)return;const a=this.ox.s7;this.JRc();if(!a){this.Fda.fail("No access to system clipboard",!0);this.Op=8;this.AJ=4;
this.Bzk();return}}else da.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.NW,this.z5a,this.Ed.nx);this.NW&32&&!this.Bf.H6c(this.$g.Rb.Ik)?(da.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.yd.kc(be.a.ei,{["Reason"]:Ud.a.q9d}),this.Fda.fail("Cut not allowed",!0),this.YVb.show(),this.Op=8,this.AJ=4):(this.NW&4096&&(this.Ida.SOb(Object.assign(new rh.a,{hCg:!0,nth:this.z5a})),this.$t.undo()),this.tJd.ekl(this.NW),this.rD=this.lm.xe(15),this.rD.rd(this.$g.Zg),
this.AJ=1)}process(){if(!this.ox){da.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.NW,this.z5a,this.Ed.nx);da.ULS.shipAssertTag(6305507,307,!this.z8);this.z8=new Qp(this.ew,this.NW,this.Fda,this.gL,this.yH,void 0,this.Ed.nx,this.eri);let a;a=this.NW&65536?Object(R.a)(this.xpf,this.xpf.process,"process"):this.NW&64?Object(R.a)(this.Apf,this.Apf.process,"process"):this.NW&1?Object(R.a)(this.Bpf,this.Bpf.process,"process"):Object(R.a)(this.ypf,this.ypf.process,
"process");this.NW&16&&this.$g.Rb.qra.Ree();this.VRa.create(this,a,this.z8).Fm("ClipboardAction")}da.ULS.shipAssertTag(6305536,307,!!this.ox);this.ox.Lh();this.ox.f1||(this.JRc(),this.AJ=this.Bj?2:3)}teardownSync(){this.z8.tEb&&(this.rD.Wc=G.a.Nz);this.z8.Zec&&this.rD.Tld(this.z8.ppe,this.z8.XSe);this.rD.dispose();this.Op=this.z8.failed?8:32;this.AJ=4}teardownAsync(){if(this.ox){if(this.ox.Lh(),this.ox.f1)return}else if(this.z8.tEb&&(this.rD.Wc=G.a.Nz),this.rD.pW(this),this.z8.Zec&&this.rD.Tld(this.z8.ppe,
this.z8.XSe),this.rD.dispose(),this.tNc)return;this.Op=this.z8.failed?8:32;this.AJ=4}finish(){this.Ida.SOb(Object.assign(new rh.a,{hCg:!1}));this.i_();32===this.response?da.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.NW,this.z5a,this.Ed.nx):da.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.NW,this.z5a,this.Ed.nx);this.wDa.GFa(this.Fda)}Bzk(){var a=
!!(this.NW&1),b=this.ew.view;if(b){var c=b.Rb;b=this.Ed.nx;A.AFrameworkApplication.Pa.nb(G.a.f3f,2);a?da.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(da.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=qJ(c),1===a.length?da.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=rJ(a),da.ULS.sendTraceTag(18425101,
307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}Object(m.a)(sJ,"ClipboardOperation",Dt.a,[]);class tJ{constructor(a,b){this.uEc=null;this.ht=a;this.SW=b;this.nD=0}process(a,b){this.nD||(this.uEc=[Object(R.a)(this,this.Q0i,"copyGlossarySelection"),Object(R.a)(this.SW,this.SW.Iel,"pasteGlossaryPlaceholder")]);let c=!0;this.nD<this.uEc.length&&(c=this.uEc[this.nD++](a,b));return c?this.nD<this.uEc.length:!1}Q0i(a,b){if(!Object(gc.a)(10,b.Bd))return!1;const c=
Object(gb.a)(10,b.Bd);if(!c.Qa(Oe.a.erg))return!1;const f=c.$a(Oe.a.erg),l=b.Yf,u=l.Rb;this.ht.Nlm();u.Nwd(()=>{u.setSelection(f,void 0,!0);this.ht.f7d(l,a)},!0);return!0}}Object(m.a)(tJ,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[1844]);class uJ{constructor(a){this.h6a=null;this.yT=a;this.nD=-1}process(a,b){-1===this.nD&&(this.e9i(a,b),this.nD=0);let c=!1;this.nD<this.h6a.length&&(c=this.h6a[this.nD++](a,b));return c?this.nD<this.h6a.length:!1}e9i(a,b){E.a.S$||b.mq&512?(this.h6a=
[Object(R.a)(this.yT,this.yT.x6b,"copyInternal")],da.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!a.Bj&&b.mq&256?(this.h6a=[Object(R.a)(this.yT,this.yT.kom,"waitBeforeCopy"),Object(R.a)(this.yT,this.yT.M_f,"copyExternal"),Object(R.a)(this.yT,this.yT.x6b,"copyInternal")],da.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.h6a=[Object(R.a)(this.yT,this.yT.M_f,
"copyExternal"),Object(R.a)(this.yT,this.yT.x6b,"copyInternal")],da.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));b.mq&32&&(a=Object(R.a)(this.yT,this.yT.RUc,"deleteForCut"),this.h6a.push(a),da.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;da.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Yf)if(b=qJ(b.Yf.Rb),1===b.length)da.ULS.sendTraceTag(18425102,
307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=rJ(b);da.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",b.length,c,a)}}}Object(m.a)(uJ,"ClipboardOperationCutCopyProcessor",null,[1843]);class vJ{constructor(a,b,c,f){this.PIc=null;this.ht=a;this.Vc=b;this.yT=c;this.SW=f;this.nD=0}process(a,b){this.nD||(this.PIc=[Object(R.a)(this,this.U0i,"copyMovedSelection"),Object(R.a)(this.yT,this.yT.RUc,"deleteForCut"),Object(R.a)(this,this.Xhh,"moveIp"),
Object(R.a)(this.SW,this.SW.yth,"pasteInternal"),Object(R.a)(this.SW,this.SW.uNh,"setSelectionAfterPaste")]);let c=!0;this.nD<this.PIc.length&&(c=this.PIc[this.nD++](a,b));return c?this.nD<this.PIc.length:!1}U0i(a,b){b=b.Yf;this.ht.Clm();this.ht.f7d(b,a);return!0}Xhh(a,b){b=new Nd.Selection([b.Bd],!0);this.Vc.setSelection(b,a);return!0}}Object(m.a)(vJ,"ClipboardOperationMoveProcessor",null,[1841]);class wJ{constructor(a,b,c,f,l,u){this.FSd=null;this.ECf=0;this.yd=f;this.Ed=b;this.SW=l;this.gNd=c;
this.fWb=A.AFrameworkApplication.uAd()&&!(E.a.gV&&A.AFrameworkApplication.fa.getBooleanAppSetting("ElectronClipboardAccessFix"));this.mJd=a.appSettings.ChromeClipboardAccessOperationTimeout;this.nD=0;this.pbi=u}get cNb(){return this.SW.cNb}process(a,b){if(0===this.nD)return this.Pel(b);if(1===this.nD)return this.prepareForPaste(a,b);if(2===this.nD)return this.nD=3,this.FSd(a,b);3===this.nD&&this.SW.uNh(a,b);return!1}Pel(a){this.Ed.S$||a.mq&512?(this.FSd=a.mq&2?Object(R.a)(this.SW,this.SW.paste,"paste"):
Object(R.a)(this.SW,this.SW.yth,"pasteInternal"),this.nD=2):(this.fWb?(this.nD=1,this.ECf=Date.now()):this.nD=2,this.FSd=Object(R.a)(this.SW,this.SW.paste,"paste"));da.ULS.sendTraceTag(18617486,307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.gNd.value.hwh())this.nD=2;else{const c=Date.now()-this.ECf;c>this.mJd&&(da.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.yd.kc(be.a.ama,{["Reason"]:Ud.a.Hrh}),b.M2&&b.M2.fail("Prepare for paste timed out",
!1),b.failed=!0,a=!1,this.pbi.UFl())}return a}}Object(m.a)(wJ,"ClipboardOperationPasteProcessor",null,[1840]);class xJ{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){this.ht=a;this.Ca=b;this.fWb=c;this.yd=f;this.Bf=l;this.Ed=u;this.lm=I;this.tbi=T;this.rbi=ja;this.gEc=ua;this.tJd=Ra;this.YVb=eb;this.VRa=Bb;this.QE=Ub;this.zd=Xb;this.$t=tc;this.Ida=lc;this.wDa=Ec}create(a,b,c,f,l,u,I,T,ja){ja=void 0===ja?!0:ja;const ua=this.tbi.create(f,Object(gb.a)(10,T));var Ra=this.rbi.create();const eb=
new tJ(this.ht,ua),Bb=new vJ(this.ht,Me.a.instance,Ra,ua);Ra=new uJ(Ra);f=new wJ(A.AFrameworkApplication.fa,Id.a.instance,f,jd.a.instance,ua,this.gEc);return new sJ(a,b,c,l,u,I,T,this.fWb,this.Ca,this.yd,this.Bf,this.Ed,this.lm,eb,Bb,Ra,f,this.gEc,this.tJd,this.YVb,this.VRa,this.QE,this.zd,this.$t,this.Ida,this.wDa,ja)}}Object(m.a)(xJ,"Factory",null,[1820]);class lB{constructor(a,b){this.gdb=a.k0c(b);this.n7d=a.gyj(b);this.F$a=a.YZc(b);this.YSa=a.NZc(b)}static XX(a){return lB.Fs(a)}static Fs(a){return new lB(cd.a.instance,
a)}}Object(m.a)(lB,"CpUsageHelper",null,[]);var Et=d(178),TR=d(324);class yJ{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.yd=a;this.ht=b;this.M_b=c;this.Vda=f;this.Vc=l;this.Ca=u;this.gNd=I;this.a2b=ja;this.ISd=T;this.IKd=ua;this.sJd=Ra;this.zd=eb}get Fo(){return this.a2b.value}get Nca(){return this.Vda}get fd(){return this.yd}get cNb(){return this.ISd.cNb}paste(a,b){const c=this.zd.vwb();try{const f=b.Yf;da.ULS.shipAssertTag(18131010,307,!!(b.mq&1));Object(gc.a)(10,b.Bd)&&b.Bd.setValue(Et.a.A8b,
f.Lg.Mo.clientWidth);this.sJd.Kem(a,b);let l;if(!(()=>{let ua=this.gNd.value.o_h();({QSc:l}=ua);return ua})().returnValue)return b.M2&&b.M2.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.Fo.Bx();let u=!0,I=null;const T=this.IKd.create(l),ja=b.w4h;f.Rb.Nwd(()=>{ja&&2===this.Ca.nb(G.a.nFa,2)?u=!1:(I=ja?this.Vc.Oa.kb.Ua:b.Bd,da.ULS.shipAssertTag(18158338,307,Bc.SelectionEditor.nh(I)),this.lKg(I,"paste"))},this.ISd.qEg);if(!u)return!1;f.editingView.disable(!0,25);T.restore();this.M_b.Cel(l,
I,a);return!0}finally{c&&c.dispose()}}Iel(a,b){this.Fo.Bx();const c=(new TR.a).xe(15);c.rd(this.ht.ref);b=Object(gb.a)(10,b.Bd).$a(Oe.a.TSj);da.ULS.shipAssertTag(20492440,307,Bc.SelectionEditor.nh(b));this.M_b.Qyg(b,a);this.ht.eXf();c.dispose();return!0}yth(a){this.Fo.Bx();this.Ca.nb(G.a.nFa,2);const b=this.Vc.Oa.kb.Ua;da.ULS.shipAssertTag(18158339,307,Bc.SelectionEditor.nh(b));this.lKg(b,"intPaste");this.M_b.Qyg(b,a);return!0}lKg(a,b){b=lB.XX(b);this.Nca.Jtl(b,a.node,a.Ra);this.Nca.Czk(b.n7d);this.Nca.AAe(b.gdb);
this.Nca.uAe(b.F$a);this.Nca.sAe(b.YSa)}uNh(a,b){if(!b.w4h)return!1;b.mq&64&&this.ht.Mlm();if(!b.Qua)return da.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.fd.kc(be.a.C3,{["Reason"]:Ud.a.Xyg}),b.M2&&b.M2.fail("No selection after paste",!1),b.failed=!0,!1;this.ISd.tlm(b);this.Fo.Bx();return!1}}Object(m.a)(yJ,"ClipboardOperationPaste",null,[1838]);class zJ{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.yd=a;this.ht=b;this.M_b=c;this.Vda=f;this.Vc=l;this.Ca=u;this.a2b=T;this.$ki=I;this.IKd=
ja;this.sJd=ua;this.zd=Ra}create(a,b){b=this.$ki.create(this.Vc,b);return new yJ(this.yd,this.ht,this.M_b,this.Vda,this.Vc,this.Ca,a,b,this.a2b,this.IKd,this.sJd,this.zd)}}Object(m.a)(zJ,"Factory",null,[1817]);class AJ{constructor(a,b){this.epi=a;this.Oki=b}get stylePropertySet(){return this.epi}get udl(){return this.Oki}}Object(m.a)(AJ,"ParagraphFormatStore",null,[]);class BJ{constructor(a,b,c,f){this.Vc=a;this.Cs=b;this.ZL=c;this.yhi=f}Kem(a,b){if(b.tEb&&this.yhi){b=a.s7;var c=this.Vc.Oa.kb.Ua.node,
f=null;this.Cs.ke(c)&&(f=this.ZL.iF(c),c=this.Cs.wva(c),f=new AJ(f,c));b=new Qp(b.context,b.mq,b.M2,b.gL,b.Bd,f);a.s7=b}}}Object(m.a)(BJ,"ClipboardOperationPasteOvertypeStrategy",null,[1816]);class Wy{constructor(a){this.nQd=null;this.Vc=a;a.Nwd(b=>{this.nQd=b},!1)}get qEg(){return!1}tlm(a){a=this.g3b(a);this.setSelection(this.Vc,a)}g3b(a){let b=a.Qua;(a.VOa||a.tQb)&&a.xBd&&(b=$d.SelectionFactory.PO(a.xBd,b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(m.a)(Wy,"AClipboardOperationPasteStrategy",
null,[1849]);class CJ extends Wy{constructor(a){super(a)}get cNb(){return this.nQd}}Object(m.a)(CJ,"ClipboardOperationPasteToLiveSelectionStrategy",Wy,[]);class DJ extends Wy{constructor(a,b){super(a);this.RXd=null;this.d_b=b;a.Nwd(c=>{this.RXd=c},!0)}get qEg(){return!0}get cNb(){return this.RXd}g3b(a){let b=super.g3b(a);a.Bd.setValue(Oe.a.Vel,b);return b=this.d_b.avm(this.nQd.kb,this.RXd.kb,b)}}Object(m.a)(DJ,"ClipboardOperationPasteToVirtualSelectionStrategy",Wy,[]);class EJ{constructor(a){this.d_b=
null;this.QXd=a.getBooleanAppSetting("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.ra(Oe.a.VOa,!1)&&this.QXd?new DJ(a,this.Pnm):new CJ(a)}get Pnm(){this.d_b||(this.d_b=Tb.a.instance.ub("Box4.Actors.IVirtualSelectionMerger"));return this.d_b}}Object(m.a)(EJ,"ClipboardOperationPasteStrategyFactory",null,[1819]);class gE{constructor(a,b,c,f,l,u){this.yd=a;this.Vc=b;this.LPa=c;this.NE=f;this.ahi=l;this.Ohi=u}ekl(a){this.Ohi&&(a&1||a&32)&&this.LPa.qy&&this.Vc.v2b()}Ufk(a,b){return this.ahi?
a&1&&this.NE.aab(b)?(this.yd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),!1):!0:!0}}Object(m.a)(gE,"ClipboardOperationWordStrategy",null,[]);class FJ{constructor(a){this.sci=a.getBooleanAppSetting("CssConverterFidelityImprovementIsEnabledIsEnabled")}q0i(a,b){if(b)if(b=b.sheet)if(b=b.cssRules){var c=Array.clone(b);this.sci&&c.reverse();var f=b=0,l=0,u=0;for(const T of c){c=T.style;var I=T.selectorText;c=c?c.cssText:null;I=I?I.split(","):null;if(c&&I&&T.type===T.STYLE_RULE){u+=I.length;for(const ja of I){0<=ja.indexOf("#")&&
b++;0<=ja.indexOf(".")&&f++;0>ja.indexOf("#")&&0>ja.indexOf(".")&&l++;I=null;try{I=a.querySelectorAll(ja)}catch(ua){da.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ja,ua.message)}if(I)for(let ua=0;ua<I.length;ua++)I[ua].setAttribute("style",c+(I[ua].getAttribute("style")||""))}}}da.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",u,b,f,l)}else this.NKg();else this.NKg()}NKg(){da.ULS.sendTraceTag(41211202,
307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",E.a.nx)}}Object(m.a)(FJ,"ExternalPasteCssConverter",null,[1824]);var mB=d(1293);class Xy{constructor(a){this.XW=this.gZb=null;this.Q8a=a.currentNode;const b=new mb.GraphIterator;b.Uc(a);this.nSd=new mb.GraphIterator;this.nSd.Uc(a);this.kSd=b.origin;this.jJd=Array(b.depth);this.nrb=Array(b.depth);this.kJd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.nrb[a]=
b.role;this.kJd[a]=c;b.Dc();this.jJd[a]=b.gwj(c,this.nrb[a])}}Um(a,b){this.gZb=a;this.XW=b}restore(a){const b=new mB.a,c=new mB.a;this.TGh(a,b,c);return c.value}TGh(a,b,c){b.value=!0;if(this.nSd.isValid)a.Uc(this.nSd),c.value=!1;else{for(let f=this.kJd.length-1;0<=f;--f){const l=this.kJd[f];if(l.anchor&&!l.anchor.oK&&(a.set(l),a.Gca(this.kSd)||this.kSd.Nve&&a.l0h())){c.value=this.eag(a,f+1);return}b.value=!1}a.set(this.kSd);c.value=this.eag(a,0)}}eag(a,b){const c=this.jJd[b],f=this.nrb[b],l=a.g$(f);
let u=!1;if(c<l)a.Kq(c,f);else if(u=!0,!a.tC(f))return!0;if(!this.cih(a,f))return u;for(b+=1;b<this.jJd.length;++b){if(u){if(!a.tC(this.nrb[b]))return!0}else if(!a.Gb(this.nrb[b]))return!1;if(!this.cih(a,this.nrb[b]))break}return u}cih(a,b){if(this.gZb&&!this.gZb(a,this.XW)){const c=new mb.GraphIterator;c.Uc(a);let f=!0;do if(!a.Qf(b)){f=!1;break}while(!this.gZb(a,this.XW));if(!f){a.Uc(c);do if(!a.NG(b))return a.Dc(),!1;while(!this.gZb(a,this.XW))}}return!0}}Object(m.a)(Xy,"NodeReference",null,[]);
var ko=d(186);class ik{constructor(a,b,c,f){this.l1b=this.ir=this.qh=this.hy=this.YL=this.BJ=null;this.PNd=!1;this.Cci=100;this.Jtb=this.LSd=this.JPa=this.zd=this.QE=this.Pp=this.LYh=null;this.CKl=()=>{this.PNd&&this.UDc&&ln.a.instance.Vg(this.UDc);this.UDc||(this.UDc=new ne.a(3,1,this.Cci,()=>{this.C3d();this.PNd=!1},215));ln.a.instance.Jb(this.UDc);this.PNd=!0;return!1};this.vDb=a;this.Eee=this.Elb=null;this.qg=b;this.transaction=c;this.Aka=f}get fa(){return A.AFrameworkApplication.fa}get zQ(){return this.YL||
(this.YL=Tb.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.hy||(this.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}get $K(){return this.BJ||(this.BJ=Tb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get $C(){return ik.Wy||(ik.Wy=Tb.a.instance.resolve("Box4.IOutlineEditor"))}get eg(){return this.qh||(this.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}get hs(){return this.ir||(this.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}get bzc(){return this.l1b||
(this.l1b=Tb.a.instance.ub("Box4.List.ISingleLevelListEditor"))}get g8(){return this.Pp||(this.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get gBc(){return this.QE||(this.QE=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get kg(){return this.zd||(this.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get f4d(){return this.JPa||(this.JPa=Tb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get uth(){return this.Ida||
(this.Ida=Tb.a.instance.resolve("Box4.IPasteFloatieEventSource"))}get ppb(){return this.$pi||(this.$pi=Tb.a.instance.resolve("Box4.ITextPasteFloatieManager"))}get trd(){return this.LSd||(this.LSd=Tb.a.instance.ub("Box4.IPastedParagraphSpaceHandler"))}set trd(a){this.LSd=a}get Sth(){return!1}get RPh(){return this.fa.getBooleanAppSetting("WordEditorAutoResizeImageIsEnabled")}H$f(){}Dth(a){var b=void 0===this.qg.mq||null===this.qg.mq?"not available":Object(eE.a)(Kw,this.qg.mq);da.ULS.sendTraceTag(8765522,
307,50,"PasteSetup: {0} [{1}].",this.qg.mq,b);da.ULS.shipAssertTag(6305487,307,Bc.SelectionEditor.nh(this.vDb));if(this.Jnd)return da.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.qg.Qua=$d.SelectionFactory.Dv(this.vDb),a.sh(Object(R.a)(this,this.y1a,"pasteTeardown")),!0;b=new mb.GraphIterator;b.set(this.vDb.node);Bc.SelectionEditor.Bu(b);jb.OutlineElementNavigator.$e(b);this.LYh=b.origin;if(this.Sth)return b.eD(10),this.H$f(b,a),a.sh(Object(R.a)(this,this.qTl,"setSelectionAfterPastingOutlines")),
!0;if(we.b(b)){if(this.IAg)return this.qg.Qua=this.Oel(this.vDb,this.VZf),a.sh(Object(R.a)(this,this.y1a,"pasteTeardown")),!0;this.vDb=this.NYk(b).ga(0)}this.E4l(this.vDb);const c=new ko.a;c.Uc(b);jb.OutlineElementNavigator.XK(c,!1,!1);this.Elb=new Xy(b);this.Eee=new Xy(c);a.sh(Object(R.a)(this,this.Gel,"pasteExecution"));return!0}Gel(a){He.a.mark(5568);this.G$f(a);let b=Object(R.a)(this,this.oXk,"mergeAfterPaste");if(this.uDg){const c=this.EQh();c&&(b=Object(R.a)(this,this.y1a,"pasteTeardown"));
da.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.sh(b);return!0}EQh(){return!1}get uDg(){return this.fa.getBooleanAppSetting("PptCcpFix2IsEnabled")}get JXl(){return this.fa.getBooleanAppSetting("CopyAndPasteOneParagraphIndentationFixIsEnabled")}oXk(a){He.a.mark(5569);var b=new mb.GraphIterator;this.Elb.restore(b);this.Elb=null;var c=new mb.GraphIterator;this.Eee.restore(c);this.Eee=null;da.ULS.shipAssertTag(6305489,307,ge.OutlineElementReader.vh(b));da.ULS.shipAssertTag(6305490,
307,ge.OutlineElementReader.vh(c));jb.OutlineElementNavigator.Ti(b);$a.ParagraphReader.Pl(b)&&$a.ParagraphReader.textLength(b.currentNode);jb.OutlineElementNavigator.$e(b);jb.OutlineElementNavigator.Ti(c);da.ULS.shipAssertTag(6305491,307,$a.ParagraphReader.Pl(c));var f=$a.ParagraphReader.textLength(c.currentNode);jb.OutlineElementNavigator.$e(c);const l=this.cQh;var u=new ko.a;u.Uc(b);jb.OutlineElementNavigator.XK(u,!1,!1);var I=u.currentNode===c.currentNode;var T=!!this.qg&&!!(this.qg.mq&8192);let ja=
!1;!T&&this.qg.Bd&&Object(gc.a)(W.DictionaryPropertySet,this.qg.Bd)&&2===ad.App.mode&&(T=(T=this.qg.Bd.$h(Oe.a.klb))&&""!==T?!0:!1);if(I)u=mb.GraphIterator.ob(b.currentNode),$a.ParagraphReader.rt(jb.OutlineElementNavigator.Ti(u))||(b=c),b.currentNode.id!==c.currentNode.id&&(da.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Kc.ListReader.hl(b),Kc.ListReader.hl(c)),u=ik.zi.merge(b,c,!0,T),da.ULS.shipAssertTag(6305492,307,
u)),c=b,T=!0;else{var ua=!!(this.qg.mq&4);I=this.kg.Gg&&this.kg.wD&&ua&&this.qg.yeb;this.trd&&this.qg&&2===ad.App.mode&&!ua&&(this.trd.D_j(b,!1),this.trd.D_j(c,!0));jb.OutlineElementNavigator.Ti(u);$a.ParagraphReader.Pl(u)&&$a.ParagraphReader.textLength(u.currentNode);jb.OutlineElementNavigator.$e(u);this.hFi(u,b,c);if(this.f4d.W4b||this.JXl)if(ua=new ko.a,ua.Uc(u),jb.OutlineElementNavigator.XK(ua,!1,!1),ua.lr.id!==c.lr.id){for(;u.currentNode.id!==c.currentNode.id;)jb.OutlineElementNavigator.Ti(u,
!1),me.a.create(u.currentNode),u.Dc(),jb.OutlineElementNavigator.XK(u,!1,!1);u.Uc(b);jb.OutlineElementNavigator.XK(u,!1,!1)}else ja=!0;if(this.qg.Jvd&&(da.ULS.shipAssertTag(6305493,307,this.qg.tEb),ua=new mb.GraphIterator,ua.Uc(u),ua=jb.OutlineElementNavigator.Ti(ua))){var Ra=this.qg.Jvd.le(ua.Sa.ga(0));ua.Sa.ga(0).formatting=Ra}Kc.ListReader.hl(b)?(ik.XM.Wfc&&this.bzc&&this.bzc.wvm(b),ua=Kc.ListReader.hl(u)?this.dQh:!0):ge.OutlineElementReader.isEmpty(b,!0)?(ik.zi.tFa(b),ua=!1):ua=Kc.ListReader.wy||
!Kc.ListReader.hl(u);this.qg.xBd=null;if(this.qg.tQb||this.qg.VOa)this.qg.xBd=this.ENj(ua?b.currentNode:u.currentNode,ua);if(ua&&(Ra=Kc.ListReader.hl(b),da.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Ra,Kc.ListReader.hl(c)),ik.zi.merge(b,u,!0,T,c,void 0,ja,I),Kc.ListReader.hl(b)&&this.eg.Xtc)){var eb=new ko.a;eb.Uc(b);jb.OutlineElementNavigator.XK(eb,!1,!1);if(eb.lr.id!==c.lr.id){var Bb=this.eg.Aw(b);this.eg.vpa(b);const tc=
b.currentNode.ra(ib.a.listID,0);b.Dc();for(Bb.EB=hf.a.Wx;eb.currentNode.id!==c.currentNode.id;){if(!Kc.ListReader.hl(eb))({Rdb:Bb}=this.hs.Wvb(Bb.propertySet,eb,Bb));else if(Ra){var Ub=this.eg.BEj(eb),Xb=this.eg.Eie(b.currentNode,tc,Ub);Xb=Xb?Gf.a.$Ea(Xb,null):Bb;Ub=Gf.a.JO(Xb.listType,Bb.listStyle,null,0,Ub,"","");Ub.H1k=b.currentNode;this.hs.mSl(Ub);this.hs.Z7e(eb,!0)}jb.OutlineElementNavigator.XK(eb,!1,!1)}}}l?(Ra=new ko.a,Ra.Uc(c),jb.OutlineElementNavigator.Pya(Ra,!1,!1),eb=Kc.ListReader.hl(Ra),
Bb=Kc.ListReader.hl(c),T=ik.zi.merge(Ra,c,!0,T,void 0,!0,void 0,I),da.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",eb,Bb,T?"True":"False, will cause IP to reset to zero."),c=T?Ra:c):(T=!1,da.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));this.f4d.W4b&&ja&&(ua?(u=new mb.GraphIterator,u.Uc(b),jb.OutlineElementNavigator.Ti(u)):l?(b=new mb.GraphIterator,b.Uc(u),jb.OutlineElementNavigator.Ti(b)):
(b=new mb.GraphIterator,b.Uc(u),b=jb.OutlineElementNavigator.Ti(b),me.a.create(b)))}da.ULS.shipAssertTag(6305494,307,c.isValid);b=jb.OutlineElementNavigator.Ti(c);f=T?$a.ParagraphReader.textLength(b)-f:0;u=!1;Object(gc.a)(10,this.qg.Bd)&&(u=this.qg.Bd.ra(Oe.a.v7c,!1));u&&U.a.instance.ga(11)?this.qg.Qua=$d.SelectionFactory.U4(b,f-1,f):this.qg.Qua=$d.SelectionFactory.fh(b,f);U.a.instance.ga(71)&&this.qg&&this.qg.tEb&&$a.ParagraphReader.ke(b)&&this.qg.Bqd&&((f=this.qg.Bqd.stylePropertySet)&&this.zQ.mca(f,
b,!0),(f=this.qg.Bqd.udl)&&this.paragraphEditor.QOf(b,f));a.sh(Object(R.a)(this,this.y1a,"pasteTeardown"));return!0}hFi(a,b,c){var f=!1;this.kg.Gg&&this.kg.wD&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){jb.OutlineElementNavigator.Ti(a,!1);f=this.gBc.x4l(me.a.create(a.currentNode));f.rqg();for(let u=0;u<f.length;u++){let I;var l=f.getContext(u);({FGg:I}=l);l=l.returnValue;I&&ik.hyperlinkEditor.OLb(l,1)}a.Dc();jb.OutlineElementNavigator.XK(a,!1,!1)}a.Uc(b);jb.OutlineElementNavigator.XK(a,!1,
!1)}}ENj(a,b){a=mb.GraphIterator.ob(a);jb.OutlineElementNavigator.Ti(a);return $a.ParagraphReader.ke(a.currentNode)?(b=b?$a.ParagraphReader.textLength(a.currentNode):0,$d.SelectionFactory.fh(a.currentNode,b)):Jd.TableReader.kfb(a.currentNode)?$d.SelectionFactory.Nl(a.currentNode):null}qTl(a){const b=mb.GraphIterator.ob(this.LYh);b.tC(1);this.qg.Qua=$d.SelectionFactory.hk(b.currentNode,!1);a.sh(Object(R.a)(this,this.y1a,"pasteTeardown"));return!0}y1a(a){var b=void 0===this.qg.mq||null===this.qg.mq?
"not available":Object(eE.a)(Kw,this.qg.mq);da.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.qg.mq,b);da.ULS.shipAssertTag(6305497,307,!!this.qg.Qua);this.transaction.dispose();b=this.Aka.dM;if(!b.xi||!b.editingView.Nm)return!1;b.editingView.j9l();if(this.qg&&this.qg.mq&&this.qg.mq&4&&this.qg.mq&2)return!1;a.sh(this.CKl,"scheduleCallPasteFloatieTask");return!0}C3d(){if(this.ppb.hwa){const a=new rh.a;a.Fyc=!0;this.uth.SOb(a)}else this.uth.o1e(new tk(1,A.AFrameworkApplication.isRtl));
this.qg&&this.qg.mq&&(1===this.qg.mq?this.ppb.XR=G.a.F9:257===this.qg.mq?this.ppb.XR=G.a.paste:8449===this.qg.mq?this.ppb.XR=G.a.O2:4097===this.qg.mq?this.ppb.XR=G.a.reformatPastedContent:12289==this.qg.mq?this.ppb.XR=G.a.n2a:this.qg.mq&16384&&(this.ppb.XR=G.a.bPb))}ZWl(a,b){const c=new mb.GraphIterator;c.Uc(a);a=jb.OutlineElementNavigator.Ti(c);b=$a.ParagraphReader.ke(a)&&b===$a.ParagraphReader.textLength(a);da.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}E4l(a){da.ULS.shipAssertTag(6305498,
307,Bc.SelectionEditor.nh(a));const b=mb.GraphIterator.ob(a.node);var c=b.wf();jb.OutlineElementNavigator.$e(b);da.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=ik.zi.Sdc(b,!0);const f=this.ZWl(b,a.Ra);ik.zi.xSb(b,c,a,!1,!1,f)}Oel(a,b){da.ULS.shipAssertTag(6305500,307,a.contextId===ta.a.Xf);const c=a.node;b=b.replace(Aa.a.jIc," ");ik.characterPropertiesEditor.replaceTextRange(a,b);return $d.SelectionFactory.fh(c,
a.Ra+b.length)}NYk(a){a.Zv();ik.Rm.eNa(a);const b=ik.Il.mmg(a),c=this.$K.P6b(a);b?rq.c(a.currentNode,b+1,b+2):this.$C.Vyd(c,ad.App.Ob.ie.yo.Nbc());this.$C.Rdc(a,null,!0);return $d.SelectionFactory.hk(a.currentNode,!0)}static get Rm(){return Tm.PageNavigator.instance}static get characterPropertiesEditor(){return ik.Ch||(ik.Ch=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return ik.uo||(ik.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Il(){return Iu.PageReader.instance}static get zi(){return ik.Rj||
(ik.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get XM(){return ik.QL||(ik.QL=Tb.a.instance.ub("Box4.List.ListSettings"))}static get Re(){return ik.kd||(ik.kd=Tb.a.instance.ub("Box4.IFeatureHelper"))}}ik.Wy=null;ik.kd=null;ik.Rj=null;ik.Ch=null;ik.uo=null;ik.QL=null;Object(m.a)(ik,"APasteExecutionManager",null,[]);var UR=d(1292);class GJ{constructor(){this.mq=0;this.y6b=6;this.hfe=this.gfe=this.xeg=this.ffe=this.efe=this.dfe=this.cfe=!1;this.k_e=null;this.weg=this.Kbb=this.u$b=
this.veg=this.zeg=!1;this.Lth=this.$Mb=0;this.qWe=this.platform=null;this.P6a={}}get kbf(){if(this.hfe)return"Word Online";if(this.ffe)return"Google Docs";if(this.gfe||this.dfe||this.efe)return"PowerPoint Online";if(this.cfe)return"Excel Online";switch(this.k_e){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}RAk(){da.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.FKi()))}SAk(){const a=
this.P6a;for(const c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.kbf,f.Browser=UR.a[this.$Mb],f.TagName=b,f.OperationId=this.qWe,da.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}X7j(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.P6a||(this.P6a[a]={}),this.P6a[a][b]=this.YNj(a,b)+1)}YNj(a,b){if(!(a&&a.length&&b&&b.length&&this.P6a&&a in this.P6a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.P6a[a])&&b in a?a[b]:0}FKi(){const a={};a.ActionIdFlags=
this.mq;a.FoundDataCcpTimestampAttribute=this.cfe;a.FoundDataClipserviceCcpidAttribute=this.dfe;a.FoundDataShapeIdsAttribute=this.efe;a.FoundGoogleDocsInternalGuidId=this.ffe;a.FoundOneNoteOnlineSequenceClass=this.xeg;a.FoundPowerPointOnlineSequenceClass=this.gfe;a.FoundWordOnlineSequenceClass=this.hfe;a.ProgId=this.k_e;a.SourceApp=this.kbf;a.FoundText=this.zeg;a.FoundEquation=this.veg;a.FoundList=this.u$b;a.FoundTable=this.Kbb;a.FoundImage=this.weg;a.CopySourceBrowser=this.y6b;a.PasteBrowser=this.$Mb;
a.IsSameBrowserPaste=this.xpk(this.y6b,this.$Mb);a.IsCrossBrowserPaste=this.Rgk(this.y6b,this.$Mb);a.IsUncategorizedBrowserPaste=this.Fsk(this.y6b,this.$Mb);a.Platform=this.platform;a.PastedHtmlLength=this.Lth;a.OperationId=this.qWe;return a}xpk(a,b){return 5===a||6===a?!1:a===b}Rgk(a,b){return 6===a?!1:a!==b}Fsk(a,b){return 5===a&&5===b}}Object(m.a)(GJ,"HtmlContentMetadata",null,[]);class nB{constructor(a,b,c){this.tg=a;this.wx=b;this.dEi=void 0===c?!1:c}}Object(m.a)(nB,"TagEventParam",null,[]);
class hE{constructor(a,b){this.rFc=this.bDf=this.sXd=this.mIf=null;this.Qc=a;this.cU=(void 0===b?null:b)||An.a.akg("");this.QUl()}get Qb(){return this.cU}o1k(a,b,c){this.sXd[b]?this.Pjh():(this.Qb.e++,(b=this.rFc[b])&&b(new nB(a,c,!1)),this.Qb.b++)}Pjh(){this.Qb.d++}h1k(){this.Qb.c++}Y0k(a,b,c){if(this.sXd[b])this.Pjh();else{if(b=this.rFc[b])return this.Qb.b++,b(new nB(a,c,!1));this.Qb.f++}return 2}QUl(){this.mIf=Qa.a.iJ("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",
!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.sXd=Qa.a.iJ("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.bDf=Qa.a.iJ("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const a=this.Qc,b=this.Qc,c=this.Qc,f=this.Qc,
l=this.Qc,u=this.Qc,I=this.Qc,T=this.Qc,ja=this.Qc,ua=this.Qc,Ra=this.Qc,eb=this.Qc,Bb=this.Qc,Ub=this.Qc,Xb=this.Qc,tc=this.Qc,lc=this.Qc,Ec=this.Qc,hd=this.Qc,yd=this.Qc;this.rFc=Qa.a.iJ("A",Object(R.a)(this.Qc,this.Qc.Wnd,"onAOpen"),"ABBR",Object(R.a)(this.Qc,this.Qc.gTe,"onAbbrOpen"),"ACRONYM",Object(R.a)(this.Qc,this.Qc.hTe,"onAcronymOpen"),"ADDRESS",Object(R.a)(this.Qc,this.Qc.jTe,"onAddressOpen"),"APPLET",Object(R.a)(this.Qc,this.Qc.qTe,"onAppletOpen"),"AREA",Object(R.a)(this.Qc,this.Qc.tTe,
"onAreaTag"),"B",Object(R.a)(this.Qc,this.Qc.$nd,"onBOpen"),"BASE",Object(R.a)(this.Qc,this.Qc.uTe,"onBaseTag"),"BASEFONT",Object(R.a)(this.Qc,this.Qc.vTe,"onBasefontTag"),"BDO",Object(R.a)(this.Qc,this.Qc.wTe,"onBdoOpen"),"BIG",Object(R.a)(this.Qc,this.Qc.fod,"onBigOpen"),"BLOCKQUOTE",Object(R.a)(this.Qc,this.Qc.god,"onBlockquoteOpen"),"BODY",Object(R.a)(this.Qc,this.Qc.ITe,"onBodyOpen"),"BR",Object(R.a)(this.Qc,this.Qc.hod,"onBrTag"),"BUTTON",Object(R.a)(this.Qc,this.Qc.NTe,"onButtonOpen"),"CAPTION",
Object(R.a)(this.Qc,this.Qc.jod,"onCaptionOpen"),"CENTER",Object(R.a)(this.Qc,this.Qc.lod,"onCenterOpen"),"CITE",Object(R.a)(this.Qc,this.Qc.ood,"onCiteOpen"),"CODE",Object(R.a)(this.Qc,this.Qc.qod,"onCodeOpen"),"COL",Object(R.a)(this.Qc,this.Qc.YTe,"onColTag"),"COLGROUP",Object(R.a)(this.Qc,this.Qc.ZTe,"onColgroupOpen"),"DD",Object(R.a)(this.Qc,this.Qc.tod,"onDdOpen"),"DEL",Object(R.a)(this.Qc,this.Qc.uod,"onDelOpen"),"DFN",Object(R.a)(this.Qc,this.Qc.wod,"onDfnOpen"),"DIR",Object(R.a)(this.Qc,this.Qc.xod,
"onDirOpen"),"DIV",Object(R.a)(this.Qc,this.Qc.zod,"onDivOpen"),"DL",Object(R.a)(this.Qc,this.Qc.Aod,"onDlOpen"),"DT",Object(R.a)(this.Qc,this.Qc.Bod,"onDtOpen"),"EM",Object(R.a)(this.Qc,this.Qc.Fod,"onEmOpen"),"FIELDSET",Object(R.a)(this.Qc,this.Qc.vUe,"onFieldsetOpen"),"FONT",Object(R.a)(this.Qc,this.Qc.Nod,"onFontOpen"),"FORM",Object(R.a)(this.Qc,this.Qc.BUe,"onFormOpen"),"FRAME",Object(R.a)(this.Qc,this.Qc.CUe,"onFrameTag"),"FRAMESET",Object(R.a)(this.Qc,this.Qc.DUe,"onFramesetOpen"),"H1",Object(R.a)(this.Qc,
this.Qc.Sod,"onH1Open"),"H2",Object(R.a)(this.Qc,this.Qc.Tod,"onH2Open"),"H3",Object(R.a)(this.Qc,this.Qc.Uod,"onH3Open"),"H4",Object(R.a)(this.Qc,this.Qc.Vod,"onH4Open"),"H5",Object(R.a)(this.Qc,this.Qc.Wod,"onH5Open"),"H6",Object(R.a)(this.Qc,this.Qc.Xod,"onH6Open"),"HEAD",Object(R.a)(this.Qc,this.Qc.IUe,"onHeadOpen"),"HR",Object(R.a)(this.Qc,this.Qc.Yod,"onHrTag"),"HTML",Object(R.a)(this.Qc,this.Qc.KUe,"onHtmlOpen"),"I",Object(R.a)(this.Qc,this.Qc.Zod,"onIOpen"),"IFRAME",Object(R.a)(this.Qc,this.Qc.MUe,
"onIframeOpen"),"IMG",Object(R.a)(this.Qc,this.Qc.$od,"onImgTag"),"INPUT",Object(R.a)(this.Qc,this.Qc.OUe,"onInputTag"),"INS",Object(R.a)(this.Qc,this.Qc.apd,"onInsOpen"),"ISINDEX",Object(R.a)(this.Qc,this.Qc.VUe,"onIsindexOpen"),"KBD",Object(R.a)(this.Qc,this.Qc.bpd,"onKbdOpen"),"LABEL",Object(R.a)(this.Qc,this.Qc.dpd,"onLabelOpen"),"LEGEND",Object(R.a)(this.Qc,this.Qc.fpd,"onLegendOpen"),"LI",Object(R.a)(this.Qc,this.Qc.gpd,"onLiOpen"),"LINK",Object(R.a)(this.Qc,this.Qc.ZUe,"onLinkTag"),"MAP",Object(R.a)(this.Qc,
this.Qc.$Ue,"onMapOpen"),"MATH",Object(R.a)(this.Qc,this.Qc.kpd,"onMathOpen"),"MENU",Object(R.a)(this.Qc,this.Qc.kMb,"onMenuOpen"),"META",Object(R.a)(this.Qc,this.Qc.dVe,"onMetaTag"),"NOFRAMES",Object(R.a)(this.Qc,this.Qc.hVe,"onNoframesOpen"),"NOSCRIPT",Object(R.a)(this.Qc,this.Qc.iVe,"onNoscriptOpen"),"OBJECT",Object(R.a)(this.Qc,this.Qc.jVe,"onObjectOpen"),"OL",Object(R.a)(this.Qc,this.Qc.tpd,"onOlOpen"),"OPTGROUP",Object(R.a)(this.Qc,this.Qc.kVe,"onOptgroupOpen"),"OPTION",Object(R.a)(this.Qc,
this.Qc.xpd,"onOptionOpen"),"P",Object(R.a)(this.Qc,this.Qc.Apd,"onPOpen"),"PARAM",Object(R.a)(this.Qc,this.Qc.lVe,"onParamTag"),"PRE",Object(R.a)(this.Qc,this.Qc.Mpd,"onPreOpen"),"Q",Object(R.a)(this.Qc,this.Qc.tVe,"onQOpen"),"S",Object(R.a)(this.Qc,this.Qc.Upd,"onSOpen"),"SAMP",Object(R.a)(this.Qc,this.Qc.Vpd,"onSampOpen"),"SCRIPT",Object(R.a)(this.Qc,this.Qc.EVe,"onScriptOpen"),"SELECT",Object(R.a)(this.Qc,this.Qc.FVe,"onSelectOpen"),"SMALL",Object(R.a)(a,a.dqd,"onSmallOpen"),"SPAN",Object(R.a)(b,
b.eqd,"onSpanOpen"),"STRIKE",Object(R.a)(c,c.fqd,"onStrikeOpen"),"STRONG",Object(R.a)(f,f.gqd,"onStrongOpen"),"STYLE",Object(R.a)(l,l.LVe,"onStyleOpen"),"SUB",Object(R.a)(u,u.hqd,"onSubOpen"),"SUP",Object(R.a)(I,I.jqd,"onSupOpen"),"TABLE",Object(R.a)(T,T.nqd,"onTableOpen"),"TBODY",Object(R.a)(ja,ja.PVe,"onTbodyOpen"),"TD",Object(R.a)(ua,ua.Krc,"onTdOpen"),"TEXTAREA",Object(R.a)(Ra,Ra.RVe,"onTextareaOpen"),"TFOOT",Object(R.a)(eb,eb.SVe,"onTfootOpen"),"TH",Object(R.a)(Bb,Bb.oqd,"onThOpen"),"THEAD",
Object(R.a)(Ub,Ub.TVe,"onTheadOpen"),"TITLE",Object(R.a)(Xb,Xb.VVe,"onTitleOpen"),"TR",Object(R.a)(tc,tc.pqd,"onTrOpen"),"TT",Object(R.a)(lc,lc.sqd,"onTtOpen"),"U",Object(R.a)(Ec,Ec.tqd,"onUOpen"),"UL",Object(R.a)(hd,hd.uqd,"onUlOpen"),"VAR",Object(R.a)(yd,yd.wqd,"onVarOpen"))}}Object(m.a)(hE,"AHtmlProcessor",null,[]);class iE{constructor(a,b){this.childNodes=a.childNodes;this.wx=b;this.V8d=0;this.E6c=!1}}Object(m.a)(iE,"HtmlProcessorArguments",null,[]);class Lr extends hE{constructor(a,b){super(a,
void 0===b?null:b);this.LOd=null}get rnk(){null==this.LOd&&(this.LOd=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.LOd}process(a,b){b=void 0===b?null:b;a&&(this.Qc.reset(),this.bxh(new iE(a,new Wu),b))}bxh(a,b){a.childNodes.length&&(a=new uf.a(b,Object(R.a)(this,this.rll,"processChild"),a),a.Fm("HTML Processing Operation"),b||(a.Bj=!0),a.Lh())}rll(a,b){const c=b.childNodes[b.V8d];if(3===c.nodeType)return this.Qc.bod(),
this.Qc.K2(c.nodeValue,new nB(c,b.wx.Mhg())),Lr.bUb(b);if(1!==c.nodeType)return Lr.bUb(b);if(!b.E6c){const l=Aa.a.iD(c.tagName);if(!Lr.M0j(c))if(this.bDf[l])this.h1k();else{Lr.QVk(c);this.Qc.bod();var f=c.id;const u=c.tagName,I=b.wx.Mhg(),T=c.getAttribute?c.getAttribute("class"):null;f=new Xu(f,u,T?T:"",c.attributes?c.attributes.length:0);f.isValid&&I.add(f);if(this.mIf[l])return this.o1k(c,l,I),Lr.bUb(b);f=!1;switch(this.Y0k(c,l,I)){case 1:f=!0;break;case 3:return Lr.bUb(b)}switch(this.Qc.Cme(c)){case 1:f=
!0}b.E6c=f;this.bxh(new iE(c,I),a);if(!a.Bj)return!0}}if(b.E6c){if(this.rnk&&!this.rFc[Aa.a.iD(c.tagName)])return Lr.bUb(b);this.Qc.onClose()}return Lr.bUb(b)}static QVk(a){3!==a.nodeType&&ca.a.Uw(a,"alreadyPasted",!0)}static M0j(a){return 3!==a.nodeType&&ca.a.Ie(a,"alreadyPasted")}static bUb(a){a.V8d++;a.E6c=!1;return a.V8d<a.childNodes.length}}Object(m.a)(Lr,"HtmlProcessor",hE,[]);var Ds=d(963);class HJ{constructor(a,b,c,f){f=void 0===f?null:f;this.oe=a;this.cU=(void 0===b?null:b)||An.a.$jg(E.a.d$a,
"");this.fr=void 0===c?null:c;this.Ysa=f?f.getBooleanAppSetting("ParseStyleForHtmlTagEventIsEnabled"):!1}get Qb(){return this.cU}get Lo(){return this.fr}Uf(a){return a?a+1:1}reset(){this.oe.reset()}bod(){this.oe.bod()}Cme(a){if(a&&this.Lo&&(a.getAttribute&&(a.getAttribute(Ds.a.k3f)&&(this.Lo.cfe=!0),a.getAttribute(Ds.a.l3f)&&(this.Lo.dfe=!0),a.getAttribute(Ds.a.p3f)&&(this.Lo.efe=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Ds.a.urg)&&(this.Lo.ffe=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Ds.a.$qh)&&
(this.Lo.xeg=!0);b.startsWith(Ds.a.zvh)&&(this.Lo.gfe=!0);b.startsWith(Ds.a.U5h)&&(this.Lo.hfe=!0);if(b.startsWith(E.a.k4b)&&b.length===E.a.k4b.length+1){const c=parseInt(Aa.a.substring(b,b.length-1,b.length));isNaN(c)||(this.Lo.y6b=c)}if(b===Ds.a.Aih||b===Ds.a.Bih)this.Lo.u$b=!0}return this.oe.Cme(a)}onClose(){this.oe.onClose()}K2(a,b){this.Lo&&(this.Lo.zeg=!0);this.Qb.d=this.Uf(this.Qb.d);this.Ysa&&this.uza(b);this.oe.K2(a,b)}Wnd(a){this.Qb.e=this.Uf(this.Qb.e);this.Ysa&&this.uza(a);return this.oe.Wnd(a)}gTe(a){this.Qb.f=
this.Uf(this.Qb.f);return this.oe.gTe(a)}hTe(a){this.Qb.g=this.Uf(this.Qb.g);return this.oe.hTe(a)}jTe(a){this.Qb.h=this.Uf(this.Qb.h);return this.oe.jTe(a)}qTe(a){this.Qb.i=this.Uf(this.Qb.i);return this.oe.qTe(a)}tTe(a){this.Qb.j=this.Uf(this.Qb.j);this.oe.tTe(a)}$nd(a){this.Qb.k=this.Uf(this.Qb.k);return this.oe.$nd(a)}uTe(a){this.Qb.l=this.Uf(this.Qb.l);this.oe.uTe(a)}vTe(a){this.Qb.m=this.Uf(this.Qb.m);this.oe.vTe(a)}wTe(a){this.Qb.n=this.Uf(this.Qb.n);return this.oe.wTe(a)}fod(a){this.Qb.o=
this.Uf(this.Qb.o);return this.oe.fod(a)}god(a){this.Qb.p=this.Uf(this.Qb.p);return this.oe.god(a)}ITe(a){this.Qb.q=this.Uf(this.Qb.q);return this.oe.ITe(a)}hod(a){this.Qb.r=this.Uf(this.Qb.r);this.oe.hod(a)}NTe(a){this.Qb.s=this.Uf(this.Qb.s);return this.oe.NTe(a)}jod(a){this.Qb.t=this.Uf(this.Qb.t);return this.oe.jod(a)}lod(a){this.Qb.u=this.Uf(this.Qb.u);return this.oe.lod(a)}ood(a){this.Qb.v=this.Uf(this.Qb.v);return this.oe.ood(a)}qod(a){this.Qb.w=this.Uf(this.Qb.w);return this.oe.qod(a)}YTe(a){this.Qb.x=
this.Uf(this.Qb.x);this.oe.YTe(a)}ZTe(a){this.Qb.y=this.Uf(this.Qb.y);return this.oe.ZTe(a)}tod(a){this.Qb.z=this.Uf(this.Qb.z);return this.oe.tod(a)}uod(a){this.Qb.ba=this.Uf(this.Qb.ba);return this.oe.uod(a)}wod(a){this.Qb.bb=this.Uf(this.Qb.bb);return this.oe.wod(a)}xod(a){this.Qb.bc=this.Uf(this.Qb.bc);return this.oe.xod(a)}zod(a){this.Qb.bd=this.Uf(this.Qb.bd);return this.oe.zod(a)}Aod(a){this.Qb.be=this.Uf(this.Qb.be);return this.oe.Aod(a)}Bod(a){this.Qb.bf=this.Uf(this.Qb.bf);return this.oe.Bod(a)}Fod(a){this.Qb.bg=
this.Uf(this.Qb.bg);return this.oe.Fod(a)}vUe(a){this.Qb.bh=this.Uf(this.Qb.bh);return this.oe.vUe(a)}Nod(a){this.Qb.bi=this.Uf(this.Qb.bi);return this.oe.Nod(a)}BUe(a){this.Qb.bj=this.Uf(this.Qb.bj);return this.oe.BUe(a)}CUe(a){this.Qb.bk=this.Uf(this.Qb.bk);this.oe.CUe(a)}DUe(a){this.Qb.bl=this.Uf(this.Qb.bl);return this.oe.DUe(a)}Sod(a){this.Qb.bm=this.Uf(this.Qb.bm);return this.oe.Sod(a)}Tod(a){this.Qb.bm=this.Uf(this.Qb.bm);return this.oe.Tod(a)}Uod(a){this.Qb.bm=this.Uf(this.Qb.bm);return this.oe.Uod(a)}Vod(a){this.Qb.bm=
this.Uf(this.Qb.bm);return this.oe.Vod(a)}Wod(a){this.Qb.bm=this.Uf(this.Qb.bm);return this.oe.Wod(a)}Xod(a){this.Qb.bm=this.Uf(this.Qb.bm);return this.oe.Xod(a)}IUe(a){this.Qb.bn=this.Uf(this.Qb.bn);return this.oe.IUe(a)}Yod(a){this.Qb.bo=this.Uf(this.Qb.bo);this.oe.Yod(a)}KUe(a){this.Qb.bp=this.Uf(this.Qb.bp);return this.oe.KUe(a)}Zod(a){this.Qb.bq=this.Uf(this.Qb.bq);return this.oe.Zod(a)}MUe(a){this.Qb.br=this.Uf(this.Qb.br);return this.oe.MUe(a)}$od(a){this.Lo&&(this.Lo.weg=!0);this.Ysa&&this.uza(a);
this.Qb.bs=this.Uf(this.Qb.bs);this.oe.$od(a)}OUe(a){this.Qb.bt=this.Uf(this.Qb.bt);this.oe.OUe(a)}apd(a){this.Qb.bu=this.Uf(this.Qb.bu);return this.oe.apd(a)}VUe(a){this.Qb.bv=this.Uf(this.Qb.bv);return this.oe.VUe(a)}bpd(a){this.Qb.bw=this.Uf(this.Qb.bw);return this.oe.bpd(a)}dpd(a){this.Qb.bx=this.Uf(this.Qb.bx);return this.oe.dpd(a)}fpd(a){this.Qb.by=this.Uf(this.Qb.by);return this.oe.fpd(a)}gpd(a){this.Lo&&(this.Lo.u$b=!0);this.Qb.bz=this.Uf(this.Qb.bz);this.Ysa&&this.uza(a);return this.oe.gpd(a)}ZUe(a){this.Qb.ca=
this.Uf(this.Qb.ca);this.oe.ZUe(a)}$Ue(a){this.Qb.cb=this.Uf(this.Qb.cb);return this.oe.$Ue(a)}kpd(a){this.Lo&&(this.Lo.veg=!0);this.Qb.cc=this.Uf(this.Qb.cc);return this.oe.kpd(a)}kMb(a){this.Qb.cd=this.Uf(this.Qb.cd);return this.oe.kMb(a)}dVe(a){this.Qb.ce=this.Uf(this.Qb.ce);this.oe.dVe(a)}hVe(a){this.Qb.cf=this.Uf(this.Qb.cf);return this.oe.hVe(a)}iVe(a){this.Qb.cg=this.Uf(this.Qb.cg);return this.oe.iVe(a)}jVe(a){this.Qb.ch=this.Uf(this.Qb.ch);return this.oe.jVe(a)}tpd(a){this.Lo&&(this.Lo.u$b=
!0);this.Qb.ci=this.Uf(this.Qb.ci);this.Ysa&&this.uza(a);return this.oe.tpd(a)}kVe(a){this.Qb.cj=this.Uf(this.Qb.cj);return this.oe.kVe(a)}xpd(a){this.Qb.ck=this.Uf(this.Qb.ck);return this.oe.xpd(a)}Apd(a){this.Qb.cl=this.Uf(this.Qb.cl);this.Ysa&&this.uza(a);return this.oe.Apd(a)}lVe(a){this.Qb.cm=this.Uf(this.Qb.cm);this.oe.lVe(a)}Mpd(a){this.Qb.cn=this.Uf(this.Qb.cn);return this.oe.Mpd(a)}tVe(a){this.Qb.co=this.Uf(this.Qb.co);return this.oe.tVe(a)}Upd(a){this.Qb.cp=this.Uf(this.Qb.cp);return this.oe.Upd(a)}Vpd(a){this.Qb.cq=
this.Uf(this.Qb.cq);return this.oe.Vpd(a)}EVe(a){this.Qb.cr=this.Uf(this.Qb.cr);return this.oe.EVe(a)}FVe(a){this.Qb.cs=this.Uf(this.Qb.cs);return this.oe.FVe(a)}dqd(a){this.Qb.ct=this.Uf(this.Qb.ct);return this.oe.dqd(a)}eqd(a){this.Qb.cu=this.Uf(this.Qb.cu);this.Ysa&&this.uza(a);return this.oe.eqd(a)}fqd(a){this.Qb.cv=this.Uf(this.Qb.cv);return this.oe.fqd(a)}gqd(a){this.Qb.cw=this.Uf(this.Qb.cw);return this.oe.gqd(a)}LVe(a){this.Qb.cx=this.Uf(this.Qb.cx);return this.oe.LVe(a)}hqd(a){this.Qb.cy=
this.Uf(this.Qb.cy);return this.oe.hqd(a)}jqd(a){this.Qb.cz=this.Uf(this.Qb.cz);return this.oe.jqd(a)}nqd(a){this.Lo&&(this.Lo.Kbb=!0);this.Qb.da=this.Uf(this.Qb.da);this.Ysa&&this.uza(a);return this.oe.nqd(a)}PVe(a){this.Lo&&(this.Lo.Kbb=!0);this.Qb.db=this.Uf(this.Qb.db);this.Ysa&&this.uza(a);return this.oe.PVe(a)}Krc(a){this.Lo&&(this.Lo.Kbb=!0);this.Qb.dc=this.Uf(this.Qb.dc);this.Ysa&&this.uza(a);return this.oe.Krc(a)}RVe(a){this.Qb.dd=this.Uf(this.Qb.dd);return this.oe.RVe(a)}SVe(a){this.Qb.de=
this.Uf(this.Qb.de);return this.oe.SVe(a)}oqd(a){this.Lo&&(this.Lo.Kbb=!0);this.Qb.df=this.Uf(this.Qb.df);return this.oe.oqd(a)}TVe(a){this.Lo&&(this.Lo.Kbb=!0);this.Qb.dg=this.Uf(this.Qb.dg);return this.oe.TVe(a)}VVe(a){this.Qb.dh=this.Uf(this.Qb.dh);return this.oe.VVe(a)}pqd(a){this.Lo&&(this.Lo.Kbb=!0);this.Qb.di=this.Uf(this.Qb.di);return this.oe.pqd(a)}sqd(a){this.Qb.dj=this.Uf(this.Qb.dj);return this.oe.sqd(a)}tqd(a){this.Qb.dk=this.Uf(this.Qb.dk);return this.oe.tqd(a)}uqd(a){this.Lo&&(this.Lo.u$b=
!0);this.Qb.dl=this.Uf(this.Qb.dl);return this.oe.uqd(a)}wqd(a){this.Qb.dm=this.Uf(this.Qb.dm);return this.oe.wqd(a)}uza(a){if((a=a.tg)&&a.style&&this.Lo){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.Lo.X7j(a.tagName,c)}}}Object(m.a)(HJ,"HtmlEventUsageCollector",null,[1850]);class IJ{constructor(a,b,c){this.oe=a;this.cU=(void 0===b?null:b)||An.a.fog("");this.ypi=(void 0===c?null:c)||An.a.gog("")}get Qb(){return this.cU}get tdf(){return this.ypi}SZ(a){this.tdf.b++;this.oe.SZ(a)}PZ(){this.oe.PZ()}RZ(a){this.tdf.c++;
this.oe.RZ(a)}QZ(){this.oe.QZ()}OZ(a){this.tdf.d++;this.oe.OZ(a)}NZ(){this.oe.NZ()}reset(){this.oe.reset()}get B7b(){return this.oe.B7b}K2(a,b){this.Qb.b++;this.oe.K2(a,b)}Ppa(a){this.Qb.c++;this.oe.Ppa(a)}p1a(a){this.Qb.b++;this.oe.p1a(a)}Opa(a){this.Qb.d++;this.oe.Opa(a)}Npa(a){this.Qb.f++;this.oe.Npa(a)}Xya(a,b){this.Qb.g++;this.oe.Xya(a,b)}Wya(){this.oe.Wya()}zB(a){this.Qb.h++;this.oe.zB(a)}yB(){this.oe.yB()}l1a(){this.oe.l1a()}k1a(){this.oe.k1a()}bza(a,b){this.Qb.i++;this.oe.bza(a,b)}LLa(){this.oe.LLa()}Spa(a){this.Qb.j++;
this.oe.Spa(a)}Qpa(){this.oe.Qpa()}aza(a){this.Qb.k++;this.oe.aza(a)}Rpa(){this.oe.Rpa()}m1a(a){this.Qb.l++;this.oe.m1a(a)}}Object(m.a)(IJ,"SemanticEventUsageCollector",null,[1847,1832]);class jE{constructor(a){this.Nh=a}reset(){this.Nh.reset()}get B7b(){return this.Nh.B7b}K2(a,b){this.Nh.K2(a,b)}Ppa(a){this.Nh.Ppa(a)}p1a(a){this.Nh.p1a(a)}Opa(a){this.Nh.Opa(a)}Npa(a){this.Nh.Npa(a)}Xya(a,b){this.Nh.Xya(a,b)}Wya(){this.Nh.Wya()}zB(a){this.Nh.zB(a)}yB(){this.Nh.yB()}l1a(){this.Nh.l1a()}k1a(){this.Nh.k1a()}Spa(a){this.Nh.Spa(a)}Qpa(){this.Nh.Qpa()}aza(a){this.Nh.aza(a)}Rpa(){this.Nh.Rpa()}m1a(a){this.Nh.m1a(a)}SZ(a){this.Nh.SZ(a)}PZ(){this.Nh.PZ()}RZ(a){this.Nh.RZ(a)}QZ(){this.Nh.QZ()}OZ(a){this.Nh.OZ(a)}NZ(){this.Nh.NZ()}bza(a,
b){this.Nh.bza(a,b)}LLa(){this.Nh.LLa()}}Object(m.a)(jE,"AHtmlNormalizer",null,[1847,1832]);class kE extends jE{constructor(a){super(a);this.rE=!1}K2(a,b){this.rE?this.nH.EG(()=>{this.e_e(a,b)}):this.e_e(a,b)}e_e(a,b){this.Nh.K2(a,b)}Ppa(a){this.rE?this.nH.EG(()=>{this.FZe(a)}):this.FZe(a)}FZe(a){this.Nh.Ppa(a)}Opa(a){this.rE?this.nH.EG(()=>{this.Qtc(a)}):this.Qtc(a)}Qtc(a){this.Nh.Opa(a)}Npa(a){this.rE?this.nH.EG(()=>{this.EZe(a)}):this.EZe(a)}EZe(a){this.Nh.Npa(a)}Xya(a,b){this.rE?this.nH.EG(()=>
{this.AZe(a,b)}):this.AZe(a,b)}AZe(a,b){this.Nh.Xya(a,b)}Wya(){this.rE?this.nH.EG(Object(R.a)(this,this.zZe,"processAnchorEnd")):this.zZe()}zZe(){this.Nh.Wya()}zB(a){this.rE?this.nH.EG(()=>{this.PZe(a)}):this.PZe(a)}PZe(a){this.Nh.zB(a)}yB(){this.rE?this.nH.EG(Object(R.a)(this,this.OZe,"processParagraphEnd")):this.OZe()}OZe(){this.Nh.yB()}l1a(){this.rE?this.nH.EG(Object(R.a)(this,this.RZe,"processPreFormattedTextStart")):this.RZe()}RZe(){this.Nh.l1a()}k1a(){this.rE?this.nH.EG(Object(R.a)(this,this.QZe,
"processPreFormattedTextEnd")):this.QZe()}QZe(){this.Nh.k1a()}Spa(a){this.rE?this.nH.EG(()=>{this.JZe(a)}):this.JZe(a)}JZe(a){this.Nh.Spa(a)}Qpa(){this.rE?this.nH.EG(Object(R.a)(this,this.GZe,"processListEnd")):this.GZe()}GZe(){this.Nh.Qpa()}aza(a){this.rE?this.nH.EG(()=>{this.IZe(a)}):this.IZe(a)}IZe(a){this.Nh.aza(a)}Rpa(){this.rE?this.nH.EG(Object(R.a)(this,this.HZe,"processListItemEnd")):this.HZe()}HZe(){this.Nh.Rpa()}SZ(a){this.rE?this.nH.EG(()=>{this.d_e(a)}):this.d_e(a)}d_e(a){this.Nh.SZ(a)}PZ(){this.rE?
this.nH.EG(Object(R.a)(this,this.a_e,"processTableEnd")):this.a_e()}a_e(){this.Nh.PZ()}RZ(a){this.rE?this.nH.EG(()=>{this.c_e(a)}):this.c_e(a)}c_e(a){this.Nh.RZ(a)}QZ(){this.rE?this.nH.EG(Object(R.a)(this,this.b_e,"processTableRowEnd")):this.b_e()}b_e(){this.Nh.QZ()}OZ(a){this.rE?this.nH.EG(()=>{this.$Ze(a)}):this.$Ze(a)}$Ze(a){this.Nh.OZ(a)}NZ(){this.rE?this.nH.EG(Object(R.a)(this,this.ZZe,"processTableCellEnd")):this.ZZe()}ZZe(){this.Nh.NZ()}bza(a,b){this.rE?this.nH.EG(()=>{this.KZe(a,b)}):this.KZe(a,
b)}KZe(a,b){this.Nh.bza(a,b)}LLa(){this.rE?this.nH.EG(Object(R.a)(this,this.oxh,"processMathEnd")):this.oxh()}oxh(){this.Nh.LLa()}}Object(m.a)(kE,"AQueuingHtmlNormalizer",jE,[]);class JJ{constructor(a){this.next=null;this.data=a}}Object(m.a)(JJ,"QueueNode",null,[]);class lE{constructor(){this.D6a=this.L5a=null;this.Un=0}get count(){return this.Un}get isEmpty(){return!this.Un||!this.L5a||!this.D6a}enqueue(a){a=new JJ(a);this.isEmpty?this.D6a=this.L5a=a:this.L5a=this.L5a.next=a;this.Un++}back(){return this.isEmpty?
null:this.L5a.data}dequeue(){if(this.isEmpty)return null;const a=this.D6a;this.D6a=a.next;this.Un--;this.D6a||(this.L5a=null);return a.data}clear(){this.D6a=this.L5a=null;this.Un=0}toArray(){const a=Array(this.count);let b=this.D6a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(m.a)(lE,"Queue",null,[]);class Yy{constructor(){this.wTd=new lE}EG(a){this.wTd.enqueue(a)}flush(a){for((a=void 0===a?!1:a)&&this.wyd();!this.wTd.isEmpty;)this.wTd.dequeue()();a&&this.Uvd()}wyd(){}Uvd(){}}
Object(m.a)(Yy,"QueuedEventManager",null,[]);class oB extends Yy{constructor(a){super();this.id=void 0;this.$8d=null;this.B7c=!1;this.qsc="";this.A7c=this.t8c=!1;this.Y8d=this.zyb=null;this.rqc=0;this.bfc=this.rgc=this.uye=!1;this.table=null;this.jSe=0;this.TQ=a}get m3b(){return!!this.table}wyd(){this.TQ.IMb.push(this.TQ.currentState);this.TQ.currentState=this}Uvd(){this.TQ.currentState=this.TQ.IMb.pop()}}oB.nextId=void 0;Object(m.a)(oB,"ContentState",Yy,[]);class KJ{constructor(a,b,c){this.colSpan=
a.colSpan;this.rowSpan=a.rowSpan;this.width=a.width;this.height=a.height;this.YHa=a.YHa;this.Yxc=a.Yxc;this.verticalAlignment=a.verticalAlignment;this.Y7=a.Y7;this.nCd=a.nCd;this.VEb=a.VEb;this.nRc=a.nRc;this.contents=c;this.RSj=b}}Object(m.a)(KJ,"TableCell",null,[]);class LJ extends Yy{constructor(a,b){super();this.TQ=a;this.LGf=new Wu;this.DH=new Wu;this.PQd=[];this.SKc=[];this.csa=-1;this.fCa=0;this.ygi=b.eAg;this.xgi=b.Xek;this.qpi=b.idf;this.o9a=b.width;this.Swf=b.YHa;this.efi=new Vn(new Xu(b.$V.cwg,
b.$V.bdc),b.wx,b.u7,b.cultureName,b.Bka);this.Wfi=b.xpe;this.bMc=b.pVh;this.wpi=b.tableLook}get Nh(){return this.TQ.Nh}okl(a){this.csa++;this.LGf.add(a);this.SKc[this.csa]=a.height;this.fCa=0}get K8i(){for(;this.fCa>=this.DH.count;)this.DH.add(Array(this.csa+1));return this.DH.ga(this.fCa)}LYd(a,b,c,f,l,u,I){if(0>this.csa)return!1;for(;this.PQd[this.fCa]>=this.csa;)this.fCa++;a=new KJ(a,new Vn(b,c,f,l,u),I);this.K8i[this.csa]=a;if(1<a.rowSpan)for(b=this.csa+a.rowSpan-1,f=this.fCa,c=this.fCa+a.colSpan-
1;f<=c;f++)this.PQd[f]>=b||(this.PQd[f]=b);this.fCa+=a.colSpan;this.SKc[this.csa]<a.height&&(this.SKc[this.csa]=a.height);return!0}wyd(){this.TQ.currentState.table=this}Uvd(){this.TQ.currentState.table=null}Cdg(){this.flush(!0);const a=this.csa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.DH.count);c=!0;var f=0;for(var l=0;l<this.DH.count;l++){var u=this.DH.ga(l),I=!0;for(var T=0;T<a;T++){var ja=u[T];ja&&(I=!1,b[T][l+f]=new jB(ja.colSpan,ja.rowSpan,ja.width,ja.height,void 0,void 0,void 0,
void 0,ja.YHa,ja.VEb))}I?(this.DH.removeAt(l),l--,++f):c=!1}if(!c){(b=this.Swf?this.TQ.kUf(b,this.o9a/100):this.TQ.kUf(b))&&b.length!==this.DH.count&&(b=null);this.TQ.IFa(!0);this.TQ.YRc();this.Nh.SZ(new cE(a,this.DH.count,this.o9a,this.Swf,b,this.ygi,this.xgi,this.qpi,this.Wfi,this.bMc,this.wpi,this.efi));for(b=0;b<a;b++){c=this.LGf.ga(b);this.Nh.RZ(new bE(this.SKc[b],new Vn(c.$V,c.wx,c.u7,c.cultureName,c.Bka)));for(c=0;c<this.DH.count;c++){f=this.DH.ga(c)[b];var ua=!!this.bMc&&""!==this.bMc&&"Custom"!==
this.bMc;l=f?f.colSpan:0;u=f?f.rowSpan:0;I=f?f.width:0;T=f?f.height:0;ja=f?f.nRc:0;const Ra=f?f.YHa:!1,eb=f&&(65536&ja||!ua)?f.Yxc:"",Bb=f?f.verticalAlignment:0,Ub=f?f.VEb:!1;ua=f?this.TQ.NGj(f.Y7,c,b,this.DH,ua,f.nRc):new YD;const Xb=f?f.nCd:new ZD,tc=f?f.RSj:null;this.Nh.OZ(new jB(l,u,I,T,eb,Bb,ua,Xb,Ra,Ub,ja,new Vn(tc?tc.$V:null,tc?tc.wx:null,tc?tc.u7:null,tc?tc.cultureName:null,tc?tc.Bka:null)));f&&!f.VEb&&(f.contents.wyd(),f.contents.flush(),this.TQ.IFa(!1),this.TQ.YRc(),f.contents.Uvd());this.Nh.NZ()}this.Nh.QZ()}this.Nh.PZ();
this.TQ.currentState.bfc=!1;this.TQ.G9f(!1)}}}Object(m.a)(LJ,"NormalizedTable",Yy,[]);class mE{constructor(a,b){this.Vgi=void 0===a?!1:a;this.DJ=void 0===b?!1:b}get okk(){return this.Vgi}get vW(){return this.DJ}}Object(m.a)(mE,"HtmlNormalizerSettings",null,[1750]);class Es extends kE{constructor(a,b){b=void 0===b?null:b;super(a);this.currentState=null;this.IMb=new Uy;this.tsb=b||new mE}reset(){super.reset();this.currentState=new oB(this);this.IMb.clear();this.rE=!1}get nH(){return this.currentState&&
this.currentState.m3b?this.currentState.table:this.currentState}TWc(a){a=void 0===a?!1:a;this.currentState.B7c||(this.YRc(),this.Nh.zB(this.currentState.$8d),this.currentState.B7c=!0,this.currentState.bfc=!1);a||!this.currentState.zyb||this.currentState.A7c||(this.Nh.Xya(this.currentState.zyb,this.currentState.Y8d),this.currentState.A7c=!0)}a9b(){this.currentState.A7c&&(this.Nh.Wya(),this.currentState.A7c=!1)}Yhj(){this.currentState.B7c&&(this.Nh.yB(),this.currentState.B7c=!1,this.currentState.qsc=
"")}G9f(a){this.currentState.rgc&&(this.currentState.bfc?a||(this.Nh.zB(null),this.Nh.yB(),this.Nh.Rpa(),this.currentState.rgc=!1):(this.Nh.Rpa(),this.currentState.rgc=!1,this.currentState.bfc=!0))}IFa(a){this.a9b();this.Yhj();this.G9f(a)}hbl(a){this.Nh.Spa(new Vy(2,1,a));this.currentState.rqc++;this.currentState.uye=!0}YRc(){!this.currentState.rgc&&this.currentState.uye&&(this.Nh.Qpa(),this.currentState.rqc--,this.currentState.uye=!1)}e_e(a,b){a=this.q0k(a);if(""!==a)if(this.TWc(),this.currentState.t8c)this.f_e(a,
b);else{a=a.split(Es.WNi);for(let c=0;c<a.length-1;c++)this.f_e(a[c],b),this.Nh.p1a(b);this.f_e(a[a.length-1],b)}}KZe(a,b){""!==a&&(this.TWc(),this.Nh.bza(a,b))}FZe(a){this.tsb.vW||this.a9b();this.TWc(!0);this.Nh.Ppa(a)}EZe(a){this.currentState.m3b||this.Nh.Npa(a)}Qtc(a){this.currentState.zyb&&(a.href=this.currentState.zyb);super.Qtc(a)}AZe(a,b){this.a9b();this.currentState.zyb=a;this.currentState.Y8d=b}zZe(){this.a9b();this.currentState.zyb=null;this.currentState.Y8d=null}PZe(a){this.currentState.$8d=
a;this.IFa(!0)}OZe(){this.currentState.$8d=null;this.IFa(!0)}RZe(){this.currentState.t8c=!0}QZe(){this.currentState.t8c=!1}JZe(a){this.IFa(!1);this.YRc();this.Nh.Spa(a);this.currentState.rqc++}GZe(){this.IFa(!1);this.Nh.Qpa();this.currentState.rqc--}IZe(a){this.IFa(!1);this.currentState.rqc||this.hbl(a);this.Nh.aza(a);this.currentState.rgc=!0;this.currentState.bfc=!0}HZe(){this.IFa(!1)}SZ(a){this.currentState.m3b||(this.rE=!0,this.currentState.table=new LJ(this,a))}d_e(){}PZ(){if(this.currentState.table){var a=
this.currentState.table;this.currentState.table=null;this.IMb.isEmpty?(this.rE=!1,a.Cdg()):this.nH.EG(Object(R.a)(a,a.Cdg,"flushTable"))}}a_e(){}RZ(a){this.currentState.m3b&&this.currentState.table.okl(a)}c_e(){}QZ(){}b_e(){}OZ(a){let b=!1;if(this.currentState.m3b){const c=new oB(this);this.currentState.table.LYd(a,new Xu(a.$V.cwg,a.$V.bdc),a.wx,a.u7,a.cultureName,a.Bka,c)?(this.IMb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.jSe++}$Ze(){}NZ(){0<this.currentState.jSe?
this.currentState.jSe--:this.currentState=this.IMb.pop()}ZZe(){}kUf(a,b){b=void 0===b?1:b;if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const u=Array(f+1);for(var I=0;I<u.length;I++)u[I]=!1;I=new La.a;for(let ja=0;ja<f;ja++){for(var T=0;T<c;T++)if(a[T][ja]&&0<a[T][ja].width){const ua=Math.min(ja+a[T][ja].colSpan,f);l[ua]=l[ja]+a[T][ja].width*(a[T][ja].YHa?b:1);u[ua]=!0}if(u[ja+1]){T=l[ja+1]-l[ja];if(0>=
T)return null;I.add(T)}else l[ja+1]=l[ja]}return I.toArray()}pWk(a,b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}NGj(a,b,c,f,l,u){if(!a)return null;l&&(a=this.pWk(a,u));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.Y7.borderRightStyle&&(a.borderLeftStyle=l.Y7.borderRightStyle,a.borderLeftColor=l.Y7.borderRightColor,a.borderLeftWidth=l.Y7.borderRightWidth);
0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-1])&&1!==b.Y7.borderBottomStyle&&(a.borderTopStyle=b.Y7.borderBottomStyle,a.borderTopColor=b.Y7.borderBottomColor,a.borderTopWidth=b.Y7.borderBottomWidth);return a}q0k(a){this.currentState.t8c||(a=this.tsb.okk?a.replace(Es.N5j," "):a.replace(Es.M5j," "));a.startsWith(" ")&&(this.currentState.qsc.endsWith(" ")||""===this.currentState.qsc)&&(a=Aa.a.substring(a,1,a.length));return a}f_e(a,b){""!==a&&(this.Nh.K2(a,b),this.currentState.qsc+=
a)}}Es.M5j=RegExp("[ \t\f\u200b\r\n]+","g");Es.N5j=RegExp("[ \f\u200b\r\n]+","g");Es.WNi="\t";Object(m.a)(Es,"DefaultHtmlNormalizer",kE,[]);class MJ extends Es{constructor(a,b,c){super(a,c);this.muf=!1;this.S6a=b}Qtc(a){this.S6a.Frd&&(A.AFrameworkApplication.YR?this.muf||(a=new Ij.StandardDialog,a.Fd=0,a.Te(1,CommonUIStrings.l_DialogClose),a.Ky(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.muf=!0):this.S6a.ZWk?this.S6a.Lgh=!0:a.src&&""!==a.src?oe.a.CR(a.src)===
oe.a.CR(window.location.href)?A.AFrameworkApplication.Pa.nb(G.a.Qth,2):a.src.startsWith("data:")&&19922944<a.src.length?A.AFrameworkApplication.Pa.nb(G.a.Oth,2):a.src.startsWith("webkit-fake-url")?A.AFrameworkApplication.Pa.nb(G.a.Nth,2):(U.a.instance.ga(1)?this.IFa(!1):U.a.instance.ga(11)&&(this.a9b(),this.TWc(!0)),this.Nh.Opa(a)):A.AFrameworkApplication.Pa.nb(G.a.Pth,2))}}Object(m.a)(MJ,"Box4HtmlNormalizer",Es,[]);class NJ{constructor(a,b,c,f,l,u,I,T,ja,ua){this.htmlProcessor=a;this.$oe=b;this.S5h=
c;this.Sqj=f;this.hMl=l;this.iMl=u;this.j4c=I;this.G5j=T;this.I5j=ja;this.$wk=ua}}Object(m.a)(NJ,"ExecutePasteArguments",null,[]);class OJ extends ik{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){super(b,c,f,Ra);this.N8=null;this.kka=a;this.AId=l;this.sNd=u;this.tWd=I;this.cYd=T;this.LGc=ja;this.tsb=Bb;this.La=ua;this.hNd=Object.assign(new $D,{vec:2===this.qg.NTa||3===this.qg.NTa});this.wLd=eb;this.Z0b=ua.getBooleanAppSetting("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Oni=ua.getBooleanAppSetting("ParseStyleFromRawHtmlHeadIsEnabled")}get Jnd(){return!1}get IAg(){return!Aa.a.F9l(Aa.a.jIc,
this.kka.innerText)}get VZf(){return this.kka.innerText}G$f(a){this.N8=new mb.GraphIterator;this.Elb.restore(this.N8);da.ULS.shipAssertTag(6305550,307,ge.OutlineElementReader.vh(this.N8));this.qg.M2&&this.qg.M2.qPc("external");var b=this.qg.mq&8192?1:0,c=this.sNd.value.create(b,this.N8);const f=this.tWd.value.create(b,this.N8),l=An.a.ame(A.AFrameworkApplication.userSessionId),u=An.a.Qhe(E.a.d$a,this.qg.j5d),I=An.a.fog(A.AFrameworkApplication.userSessionId),T=An.a.gog(A.AFrameworkApplication.userSessionId),
ja=this.Z0b?this.y$j():null,ua=An.a.$jg(E.a.d$a,this.qg.j5d),Ra=An.a.akg(A.AFrameworkApplication.userSessionId),eb=An.a.MEj(A.AFrameworkApplication.userSessionId);b=this.AId.value.create(b,this.N8,c,f,null,u);b=new IJ(b,I,T);b=new MJ(b,c,this.tsb);this.hNd.Owe=this.qg.mq&16384?!0:!1;b=new ol(b,this.LGc,this.hNd,eb);b=new HJ(b,ua,ja,this.La);b=new Lr(b,Ra);c=new NJ(b,c,l,u,I,T,ja,ua,Ra,eb);c=new uf.a(a,Object(R.a)(this,this.qkl,"preprocessStyle"),c);c.Fm("paste and request pictures");c.Bj=!a||a.Bj;
c.Lh()}qkl(a){if(this.Oni){const b=this.kka.getElementsByTagName("style");if(b&&0<b.length){da.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.wLd.q0i(this.kka,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.sh(Object(R.a)(this,this.J0i,"convertWordListHtml"));return!0}J0i(a,b){this.cYd.value.create(b.S5h).process(this.kka,a);a.sh(Object(R.a)(this,this.Hll,"processHtml"));return!0}Hll(a,b){b.htmlProcessor.process(this.kka,
a);b=b.$oe&&b.$oe.Frd?Object(R.a)(this,this.Rvd,"requestImages"):Object(R.a)(this,this.W8f,"endPasteOperation");a.sh(b);return!0}Rvd(a,b){if(b=b.$oe){let c=!1,f=!1,l=!1,u=!1,I=-1;const T=new W.DictionaryPropertySet,ja=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(gc.a)(10,this.qg.Bd)){c=this.qg.Bd.ra(ib.a.Uve,!1);const ua=this.qg.Bd.ra(Oe.a.bW,"");l=this.qg.Bd.ra(Oe.a.v7c,!1);u=this.qg.Bd.ra(rb.a.kP,!1);ja.test(ua)&&(f=!0);this.RPh&&(I=this.qg.Bd.ra(Et.a.A8b,-1))}else this.qg.mq&
256&&this.kka&&(c=!0,ja.test(this.kka.innerHTML)&&(f=!0));T.setValue(ib.a.Uve,c);T.setValue(Oe.a.Osk,f);T.setValue(Oe.a.v7c,l);T.setValue(Et.a.A8b,I);T.setValue(rb.a.kP,u);b.Xjh&&(this.qg.Zec=!0,this.qg.ppe=b.gVc,this.qg.XSe=b.Xjh,A.AFrameworkApplication.Pa.nb(G.a.Rvd,2))}a.sh(Object(R.a)(this,this.W8f,"endPasteOperation"));return!0}W8f(a,b){An.a.WEk(b.S5h);An.a.UAk(b.I5j);An.a.KDk(b.hMl);An.a.LDk(b.iMl);An.a.tBk(b.$wk);a="Others";b.j4c&&(b.j4c.RAk(),b.j4c.SAk(),a=b.j4c.kbf);An.a.TAk(b.G5j,a);An.a.zAk(b.Sqj,
a);return!1}y$j(){const a=new GJ;a.$Mb=E.a.d$a;this.qg&&(a.mq=this.qg.mq,a.qWe=this.qg.j5d,this.qg.Bd&&(a.k_e=this.qg.Bd.ra(Oe.a.Mth,"")));this.kka&&this.kka.innerHTML&&(a.Lth=this.kka.innerHTML.length);A.AFrameworkApplication.ld&&(a.platform=A.AFrameworkApplication.ld.Platform);return a}get dQh(){return!0}get cQh(){da.ULS.shipAssertTag(6305551,307,!!this.N8);if(this.LGc.QPh(this.hNd)){let a=!1;ge.OutlineElementReader.vh(this.N8)&&(this.N8.Tbc(),a=!0);const b=$a.ParagraphReader.Pl(this.N8)&&!this.N8.currentNode.ra(Oe.a.EBg,
!1);a&&this.N8.Dc();return b}return $a.ParagraphReader.Pl(this.N8)}}Object(m.a)(OJ,"ExternalPasteExecutionManager",ik,[]);class PJ{constructor(a,b,c,f,l,u,I,T){this.AId=a;this.sNd=b;this.tWd=c;this.cYd=f;this.LGc=l;this.La=u;this.wLd=I;this.tsb=T}create(a,b,c,f){return new OJ(a,b,c,f,this.AId,this.sNd,this.tWd,this.cYd,this.LGc,this.La,ad.App.Ob.ie,this.wLd,this.tsb)}}Object(m.a)(PJ,"Factory",null,[1821]);class pB{constructor(a){this.ana=a.wDj();this.gdb=a.k0c("intCopy");this.Rqd=a.yje("intCopy");
this.F$a=a.YZc("intCopy");this.YSa=a.NZc("intCopy")}static XX(){return pB.Fs()}static Fs(){return new pB(cd.a.instance)}}Object(m.a)(pB,"InternalCopyUsageHelper",null,[]);class Zy{constructor(a,b,c){this.xO=pB.XX();this.DRc=null;this.aAd=this.BFd=!1;this.Dsf=null;this.source=a;this.target=b;this.PWe=c}get n8(){return this.xO}get sM(){return this.Dsf}set sM(a){this.Dsf=a}}Object(m.a)(Zy,"InternalCopyArguments",null,[]);class QJ extends Zy{constructor(a,b,c,f){super(a,b,{});this.wQb=[];for(a=0;a<c.length;a++)Array.addRange(this.wQb,
c.ga(a).toArray());this.Yta=0;this.qTj=f}}Object(m.a)(QJ,"BasicInternalCopyArguments",Zy,[]);class RJ extends Sys.EventArgs{constructor(a){super();this.sM=a}}Object(m.a)(RJ,"BeforePasteArguments",Sys.EventArgs,[]);class qB extends Zy{constructor(a,b){super(a.source,a.target,a.PWe);this.qg=a;this.insertAfter=b}get n8(){return this.qg.n8}get sM(){return this.qg.sM}set sM(a){this.qg.sM=a}}Object(m.a)(qB,"CoreInternalCopyArguments",Zy,[]);class rB{constructor(a,b,c,f,l){this.source=a;this.target=b;this.insertAfter=
c;this.Dqd=f;this.sM=(void 0===l?null:l)||{}}}Object(m.a)(rB,"CoreInternalPasteArguments",null,[]);class SJ{constructor(a,b,c,f,l,u,I,T,ja){this.dTb=a;this.source=b;this.target=c;this.Dqd=f;this.rowIndex=l;this.qla=u;this.Ath=T;this.Yf=ja}}Object(m.a)(SJ,"CoreInternalTablePasteArguments",null,[]);class sB extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.sM=l}}Object(m.a)(sB,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Mr=d(210);class gj{static As(){gj.bQb=
new id.a;gj.bQb.$(88,!0);gj.bQb.$(4,!0)}static Zua(a,b,c){const f=[];if(U.a.instance.ga(104)&&a.qm&&$d.SelectionFactory.Jrk(a))a=mb.GraphIterator.ob(a.kb.yg.Ua.node),a.uc(14),c=me.a.create(a.origin),c=gj.HPc(c,!0,!0,null),a.set(c),Bc.SelectionEditor.Bu(a),gj.uVa(a,f);else for(let ua=0;ua<a.length&&!(c&&0<f.length);++ua){var l=a.ga(ua),u=gj.$_c(l,!0),I=gj.$_c(l,!1);if(!u||!I)continue;if(u===I&&u.contextId===ta.a.Xf){l=mb.GraphIterator.ob(u.node);l.uc(11)&&gj.uVa(l,f);continue}var T=void 0;T=l=null;
var ja=-1;let Ra;if(u.node===I.node)Ra=u.node,I=I.node;else{T=gj.Ofg(u.node);l=gj.Ofg(I.node);for(ja=0;ja<T.length&&ja<l.length&&T[ja]===l[ja];++ja);T=T[ja-1];--ja;Ra=gj.HPc(u,!0,!1,T);I=gj.HPc(I,!1,!0,T)}if(Ra===I)l=Ra===u.node?u:me.a.create(Ra),l=gj.HPc(l,!0,!0,null),u=new ko.a,u.set(l),Bc.SelectionEditor.Bu(u),gj.uVa(u,f);else{u=new ko.a;u.set(Ra);Bc.SelectionEditor.Bu(u);Ra===T&&u.sj();for(gj.uVa(u,f);u.parentNode!==T;){for(;u.Up();)gj.uVa(u,f);u.Dc()}if(I===T)for(;u.Up();)gj.uVa(u,f);else{u.Up();
for(T=ja+1;T<l.length;++T){for(;u.currentNode!==l[T];)gj.uVa(u,f),u.Up();if(I===l[T])break;u.sj()}gj.uVa(u,f)}}}if(0>=f.length)return null;if(b)for(b=new mb.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),jb.OutlineElementNavigator.Ti(b),f[a]=me.a.create(b.currentNode);return ud.a.YTa(f)}static $_c(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).El)return a.ga(b);if(a.ga(b).ry){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).El)return c.getContext(f)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).El)return a.ga(b);
if(a.ga(b).ry)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).El)return c.getContext(f)}return null}static uVa(a,b){gj.lEg(a)?gj.inj(a,b):gj.bQb.Ib(a.role)||(a=a.ay(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,me.a.create(a)))}static Ofg(a){const b=[],c=new mb.GraphIterator;c.set(a);Bc.SelectionEditor.Bu(c);for(Array.add(b,a);c.Dc();)Array.add(b,c.currentNode);b.reverse();return b}static HPc(a,b,c,f){let l=a.node;if(Bc.SelectionEditor.Tk(a)&&(b&&0<a.Ra||c&&a.Pb<$a.ParagraphReader.textLength(l))||
Bc.SelectionEditor.Om(a)&&b&&0<$a.ParagraphReader.textLength(l))return l;a=new ko.a;a.set(l);for(Bc.SelectionEditor.Bu(a);!a.ds;){l=a.currentNode;if(f===l||b&&!gj.Eik(a)||c&&!gj.Tkk(a))return l;a.Dc()}return a.currentNode}static Tkk(a){let b=!0;if(a.Up())for(b=!1;gj.bQb.Ib(a.role)||U.a.instance.ga(77)&&16===a.Zi&&se.isGhostCell(a);)if(!a.Up()){b=!0;break}return b}static Eik(a){const b=a.currentNode;let c=!0;if(a.Gva())for(c=!1;gj.bQb.Ib(a.role);)if(!a.Gva()){c=!0;break}a.Dc();a.Cl(b);return c}static inj(a,
b){a=ll.a.rw(a);for(a.Um(gj.Xmj,null);a.moveNext();)ge.OutlineElementReader.U$(a.currentNode)&&Array.add(b,me.a.create(a.currentNode))}static Xmj(a){return gj.lEg(a)}static lEg(a){return a.ds||1===a.role||27===a.role}}gj.bQb=null;Object(m.a)(gj,"OutlineElementGeneralizer",null,[]);gj.As();class TJ{constructor(){this.controlCell=this.Yn=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(m.a)(TJ,"ComplexCellData",null,[]);var $y=d(179);class nE{constructor(a){this.Vn=a;a.Kyk()}dispose(){this.Vn.Pfm()}static ob(a){return new nE(a.Ek)}}
Object(m.a)(nE,"TempGraphAlgorithmLock",null,[106]);class si{constructor(a,b,c){this.srf=this.BJ=null;this.FJc=[];this.eFc=[];this.WLc=[];this.lWb={};this.XRd={};this.QHd={};this.EJ=null;this.U8a=si.iQj(a);this.U8a.uWk();this.Spi=nE.ob(this.U8a);si.Crb=this;this.g9=1;this.jKd=b;this.k6a=c}get Lr(){return this.EJ||(this.EJ=Tb.a.instance.resolve("Box4.ITableEditor"))}get $K(){return this.BJ||(this.BJ=Tb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.g9)){var a=new pg.GraphTransaction(7);
a.rd(this.U8a);this.bnl();this.qXk();this.Soj();U.a.instance.ga(63)&&this.yTi();this.Uoj();a.dispose();this.K4()}}cUl(a){this.srf=a}Uoj(){var a=mb.GraphIterator.ob(this.U8a);if(!a.YGa()){const b=this.$K.P6b(a);si.$C.uX(a,!0);a=ad.App.Ob.ie.yo;a.Wp&&si.$C.Vyd(b,a.Nbc())}}cancel(){if(!(0<--this.g9)){var a=$y.a.PA(this.U8a);for(a.Um(si.Wof,null);a.moveNext();)a.iterator.ds||a.iterator.G_(16,!1);this.K4()}}K4(){this.U8a.Qfm();this.Spi.dispose();si.Crb=null}vra(a){a.El?(si.Isk(a)&&Array.add(this.FJc,a.node),
this.bZh(a.node)):a.ry&&this.hbm(a)}hbm(a){for(let b=0;b<a.length;++b)this.vra(a.getContext(b))}bZh(a){a.anchor.dV(16)}qXk(){for(let b=0;b<this.FJc.length;++b){var a=this.FJc[b];if(!a.anchor||a.anchor.oK)continue;const c=new mb.GraphIterator;c.set(a);if(!Bc.SelectionEditor.Bu(c))continue;jb.OutlineElementNavigator.$e(c);if(this.k6a.JPi(c)){si.zi.tFa(c);continue}a=new ko.a;a.Uc(c);if(!jb.OutlineElementNavigator.XK(a,!1,!1))continue;if(36===a.role)continue;jb.OutlineElementNavigator.Ti(a);if(a.currentNode.nY)continue;
if(Jd.TableReader.Nq(a))continue;jb.OutlineElementNavigator.$e(a);const f=new mb.GraphIterator;f.Uc(a);f.Dc();si.zi.merge(c,a,!1,!1);ge.OutlineElementReader.nK(f)&&!f.YGa()&&a.rj()}Array.clear(this.FJc)}yTi(){for(let a=0;a<this.WLc.length;++a){const b=this.WLc[a];if(!b.anchor||b.anchor.oK)continue;if(se.isGhostCellNode(b))continue;const c=new mb.GraphIterator;c.set(b);c.tC(1);c.Gb(2);Jd.TableReader.Nq(c)&&(c.Dc(),si.zi.Nfa(c,!1,!0,null))}Array.clear(this.WLc)}Rwj(a){const b=a.id.toString();if(this.lWb[b])return this.lWb[b];
const c=Array(Jd.TableReader.ej(a));for(let f=0;f<Jd.TableReader.ej(a);++f)c[f]=0;this.lWb[b]=c;this.XRd[b]=Jd.TableReader.fl(a);return c}bnl(){const a=$y.a.PA(this.U8a);a.Um(si.Wof,null);var b=a.moveNext();const c=new mb.GraphIterator;let f=0;for(;b;)if(a.iterator.ds)this.lTi(a.iterator),b=a.moveNext();else if(this.k6a.lnk(a.iterator)&&Array.add(this.eFc,a.iterator.currentNode),U.a.instance.ga(63)&&se.isTableCell(a.iterator)&&Array.add(this.WLc,a.iterator.currentNode),si.TPi(a.iterator))switch(a.iterator.Zi){case 16:b=
ce.getContainingTable(a.iterator);if(this.jKd&&!Jd.TableReader.nu(b)&&!se.isGhostCell(a.iterator)){b=this.Rwj(b);var l=vo.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=ce.getContainingTable(a.iterator);this.jKd&&!Jd.TableReader.nu(b)?(this.QHd[b.id.toString()]=!0,c.Uc(a.iterator),b=a.moveNext(),this.Lr.SUc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.srf?(a.moveNext(),c.Uc(a.iterator),b=a.moveNext(),si.zi.tFa(c)):(a.iterator.G_(16,!1),b=a.moveNext());break;case 23:c.Uc(a.iterator);
b=a.moveNext();c.rj();break;case 11:f++;we.b(a.iterator)?(a.iterator.G_(16,!1),b=a.moveNext()):(c.Uc(a.iterator),Kc.ListReader.hl(c)&&!this.k6a.X9e(c,f)&&si.hs.tqa(c),c.gK(2)?this.k6a.WXl(c,f)?b=a.moveNext():(c.Uc(a.iterator),b=a.moveNext(),si.zi.tFa(c)):(b=a.moveNext(),si.zi.tFa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(Jd.TableReader.Nq(a.iterator)&&this.jKd){var u=a.currentNode;const I=u.id.toString(),T=this.lWb[I];let ja=!1;if(T){const ua=this.XRd[I];for(u=Jd.TableReader.ej(u)-
1;0<=u;--u)T[u]===ua&&(this.Lr.QUc(a.iterator,u),ja=!0)}Jd.TableReader.ej(a.iterator.currentNode)?U.a.instance.ga(30)&&(ja||this.QHd[I])&&Jd.TableReader.Kxe(a.iterator.currentNode)&&(c.Uc(a.iterator),ce.moveToFirstRow(c),ce.moveToFirstColumn(c),b=a.moveNext(),si.zi.jFh(a.iterator,c)):(a.moveNext(),c.Uc(a.iterator),b=a.moveNext(),c.rj(),l=!1)}l&&(a.iterator.G_(16,!1),b=a.moveNext())}this.lWb={};this.XRd={};this.QHd={}}lTi(a){if(a.sj()){do a.G_(16,!1);while(a.VGa())}}Soj(){for(let b=0;b<this.eFc.length;++b){var a=
this.eFc[b];if(a.anchor&&!a.anchor.oK){const c=new mb.GraphIterator;c.set(a);Pg.OutlineNavigator.Gba(c)||(c.currentNode.setValue(rb.a.MF,mn.a.first),U.a.instance.ga(41)&&10===c.Zi&&(a=si.zi.tqe(c,null,1),c.Cl(a)),si.$C.uX(c,!0))}}Array.clear(this.eFc)}static get hs(){return si.ir||(si.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}static get $C(){return si.Wy||(si.Wy=Tb.a.instance.resolve("Box4.IOutlineEditor"))}static get zi(){return si.Rj||(si.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get kJ(){return Rl.a.instance}static get Jj(){return mi.a.instance}static Y0c(a,
b){si.Crb?si.Crb.g9++:si.Crb=new si(a,b,Tb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return si.Crb}static iQj(a){a=mb.GraphIterator.ob(a);Bc.SelectionEditor.Bu(a);a.UPb(b=>b.ogc);return a.currentNode}static Isk(a){let b=!1;Bc.SelectionEditor.Om(a)&&(b=!U.a.instance.ga(14)||!si.Jj.Y6c(a));!b&&$a.ParagraphReader.jn(a)&&(b=!U.a.instance.ga(14)||!si.Jj.c8c(a)&&!a.node.ra(ib.a.dfb,!1));return b}static TPi(a){switch(a.Zi){case 12:return a.currentNode.$Qc}if(!a.sj())return si.kJ.OGg(a)?
si.kJ.I3d(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.lY&16||16===a.Zi&&se.isGhostCell(a)||(b=!1)}a.G_(16,!0)}while(a.VGa());b&&si.kJ.OGg(a)&&(b=si.kJ.I3d(a.currentNode));return b}static IPi(a){return a.ds||!!(a.lY&16)}}si.Wof=si.IPi;si.Crb=null;si.Ma=new uc.a;si.Wy=null;si.ir=null;si.Rj=null;Object(m.a)(si,"GraphStructureNormalizer",null,[]);class Fs{constructor(){this.U3a=this.Yn=this.DB=null;this.vLa=0;this.response=2}}Object(m.a)(Fs,"TableGeneralizeData",
null,[]);class Oi{static get Dn(){return Uh.ContextSetEditor.instance}static x7(a,b,c,f,l,u,I){let T=!1;u&&u[Oi.TUb]&&u[Oi.TUb]&&(T=!0);if(!b.view.xi)return 2;const ja=b.view;var ua=ja.Rb;if(1===c){if(!ua||!ua.Oa.kb)return 8;b=0===I?b.GF:Oi.Dn.y$b(b.GF,I,!0);return A.AFrameworkApplication.Pa.Ai(b,a,c,!0,f,l)}u&&u[Oi.Fra]&&He.a.mark(u[Oi.Fra]);const Ra=hm.SelectionReferenceFactory.instance.fua(),eb=ua.Oa.kb.Ua;ua=new pg.GraphTransaction(15);ua.rd(eb.node);ua.qAa();b=0===I?b.GF:Oi.Dn.y$b(b.GF,I);a=
A.AFrameworkApplication.Pa.Ai(b,a,c,!0,f,l);32===a&&Ra.hW(T);F.FocusManager.instance().Df(ja.WJ);ua.dispose();ad.App.Ob.Gf();u&&u[Oi.Era]&&He.a.mark(u[Oi.Era]);return a}static mlb(a,b,c,f,l,u){var I=Me.a.instance;let T,ja=!1;u&&u[Oi.TUb]&&u[Oi.TUb]&&(ja=!0);if(1===c)return I&&I.Oa.kb?(T=gj.Zua(I.Oa,!1,!0))?A.AFrameworkApplication.Pa.Ai(T,a,c,!0,f,l):8:8;u&&u[Oi.Fra]&&He.a.mark(u[Oi.Fra]);const ua=hm.SelectionReferenceFactory.instance.fua(),Ra=I.Oa.kb.Ua;T=gj.Zua(I.Oa,!1);if(!T)return 8;I=new pg.GraphTransaction(15);
I.rd(Ra.node);I.qAa();a=A.AFrameworkApplication.Pa.Ai(T,a,c,!0,f,l);32===a&&ua.hW(ja);(b=b.view)&&F.FocusManager.instance().Df(b.WJ);I.dispose();ad.App.Ob.Gf();u&&u[Oi.Era]&&He.a.mark(u[Oi.Era]);return a}}Oi.Fra="PerfMarkStart";Oi.Era="PerfMarkEnd";Oi.TUb="CollapseIp";Object(m.a)(Oi,"ViewActionHandler",null,[]);var UJ=d(571);class VJ{constructor(){this.controlCell=null;this.jYf=this.RHh=0;this.Vcg=this.Wcg=null}}Object(m.a)(VJ,"MergedCellInfo",null,[]);var az=d(325),WJ=d(687),VR=d(742),wo=d(368);
class Lw extends J.a{constructor(a){super(0,0,0);this.O4=a;this.MPa=Array(a)}Uwj(a){return this.MPa[a]}zLh(a,b){this.MPa[a]=b}copy(){const a=new Lw(this.O4);for(let b=0;b<this.O4;++b)a.MPa[b]=this.MPa[b];return a}zXk(){let a=wo.a.hpb;for(let b=0;b<this.O4;++b)a+=this.MPa[b]+1;return a}static eWi(a,b){const c=new Lw(a.O4);for(let f=0;f<c.O4;f++)c.MPa[f]=Math.max(a.MPa[f],b.MPa[f]);return c}}Object(m.a)(Lw,"TableRowViewSizeConstraints",J.a,[]);class Yu extends Sf.a{constructor(a,b,c,f,l,u){u=void 0===
u?null:u;super(a,b,c);this.K5a=null;this.LJd=0;this.$Dc=-1;this.kd=f;this.zd=l;this.mc(this.Vd.Tp(va.a.tr));this.htmlElement.className="TableRow";Ac.d(this.htmlElement,na.a.role,"row");this.ZEh();this.Erf=u}Oz(){this.eb.Lsh=[];this.htmlElement.style.height=this.PHh;this.ZEh()}ZEh(){this.kd&&this.kd.AHa(65)&&(this.eb.o6b?Sys.UI.DomElement.addCssClass(this.htmlElement,Vc.E5):Sys.UI.DomElement.removeCssClass(this.htmlElement,Vc.E5))}XOl(a){const b=this.$Dc!==a;this.$Dc=a;return b}Xjm(){this.htmlElement.style.height=
this.QHh+"px"}get QHh(){let a=0>=this.$Dc?Yu.zhh:this.$Dc;this.eb.Qa(ib.a.wv)&&(a=Math.max(a,this.Vd.Xd.Ve(this.eb.$a(ib.a.wv),1)));return a}get PHh(){return this.eb.Qa(ib.a.wv)?this.Vd.Xd.Ve(this.eb.$a(ib.a.wv),1)+"px":"auto"}fW(a){super.fW(a);var b=Jd.TableReader.ej(ce.getContainingTable(a));let c=0;b=new Lw(b);if(a.Gb(1)){do b.zLh(c,a.Ur.TNa.total),c++;while(a.sk(1))}return b}wL(a){super.wL(a);this.aT.XV(this.htmlElement)}get author(){return this.K5a}ehf(a){let b=!0;if(this.Tc.Wp&&this.Tc.Aek){a=
ll.a.rw(a);for(var c={};a.moveNext();){if(!ge.OutlineElementReader.vh(a.iterator)||ge.OutlineElementReader.One(a.iterator))continue;const f=ge.OutlineElementReader.JZc(a.currentNode,rb.a.Y3b);f&&(c[f]="")}a=Qa.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.K5a=a,this.LJd=c.height,b=!1)}b&&(this.K5a="",this.LJd=-1)}get E6d(){return this.LJd}gDl(){this.Erf&&this.Erf.GEm(this)}}Yu.zhh=20;Object(m.a)(Yu,"TableRowViewElement",
Sf.a,[1688]);class ti{constructor(a,b){ti.Wy=a;ti.Rj=b}NFl(a){const b=a.tCd.currentNode;this.pim(b);let c=this.q1i(b);var f=this.XOj(b,c);let l=f.length;a.XUc=this.Vnj(f);a.VUc=this.lnj(f);f=a.XUc.toArray().length;const u=a.VUc.toArray().length;if(0<f||0<u)l-=f,c-=u,this.Mkm(a);this.lRb(Object(gb.a)(Zg.a,b),l);this.XQb(Object(gb.a)(Zg.a,b),c);this.qFl(a)}lnj(a){const b=new La.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}Vnj(a){const b=
new La.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}q1i(a){let b=0;a=mb.GraphIterator.ob(a);ce.moveToFirstRow(Object(gb.a)(mb.GraphIterator,a));ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,a));let c=Object(gb.a)(344,a.lr),f=!1;for(;c;)!c.isGhostCell||se.isSkippedCell(Object(gb.a)(Zg.a,c))?(b+=c.qdb?c.colSpan:1,f=!0):f||b++,c=Object(gb.a)(344,ce.moveToNextColumn(Object(gb.a)(mb.GraphIterator,a)));return b}Mkm(a){const b=
mb.GraphIterator.ob(a.tCd.lr);let c=0;ce.moveToFirstRow(Object(gb.a)(mb.GraphIterator,b));var f=b.lr;const l=Ad.a.Cf(Yu.zhh,1);for(;f;){for(;a.XUc.contains(c);)c++;var u=1,I=a.kzc?a.kzc.rowIndex:0,T=a.GTh[I+c];for(T<l&&(T=l);a.XUc.contains(c+u);){var ja=a.GTh[I+c+u];ja<l&&(ja=l);T+=ja;u++}f.setValue(ib.a.wv,T);f=u-1;u=0;ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,b));for(I=Object(gb.a)(344,b.lr);I;){T=I.qdb?I.colSpan:1;if(!I.isGhostCell||1<T){0<f&&(I.rowSpan-=f,1>I.rowSpan&&(I.rowSpan=1));
ja=0;for(let ua=1;ua<T;ua++)a.VUc.contains(u+ua)&&ja++;0<ja&&(I.colSpan-=ja,1>I.colSpan&&(I.colSpan=1))}u+=T;I=Object(gb.a)(344,ce.moveToNextColumn(Object(gb.a)(mb.GraphIterator,b)))}c++;ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,b));b.Dc();f=ce.moveToNextRow(Object(gb.a)(mb.GraphIterator,b))}}pim(a){const b=new La.a;a=mb.GraphIterator.ob(a);ce.moveToFirstRow(Object(gb.a)(mb.GraphIterator,a));for(var c=a.lr;c;){c=!1;let l=0;ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,a));for(var f=
Object(gb.a)(az.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.qdb?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.K4d())):se.isSkippedCell(Object(gb.a)(Zg.a,f))||b.contains(l)&&(c||U.a.instance.ga(77))||(f.isGhostCell=!1,f.K4d());else{c=!0;f=f.qdb?f.colSpan:1;for(let u=0;u<f;u++)b.contains(l+u)||b.add(l+u)}l++;f=Object(gb.a)(az.TableCellNode,ce.moveToNextColumn(Object(gb.a)(mb.GraphIterator,a)))}ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,a));a.Dc();c=ce.moveToNextRow(Object(gb.a)(mb.GraphIterator,
a))}}XOj(a,b){const c=[];let f=0;a=mb.GraphIterator.ob(a);ce.moveToFirstRow(Object(gb.a)(mb.GraphIterator,a));for(var l=a.lr;l;){l=0;ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,a));for(var u=Object(gb.a)(344,a.lr);u;){if(!u.isGhostCell||se.isSkippedCell(Object(gb.a)(Zg.a,u))){const I=u.qdb?u.colSpan:1;for(u=u.Kne?u.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let T=0;T<u;T++){const ja=f+T;ja===c.length&&Array.add(c,Array(b));for(let ua=0;ua<I;ua++)c[ja][l+ua]=0<T||0<ua?2:1}l+=I}u=
Object(gb.a)(344,ce.moveToNextColumn(Object(gb.a)(mb.GraphIterator,a)))}ce.moveToFirstColumn(Object(gb.a)(mb.GraphIterator,a));a.Dc();l=ce.moveToNextRow(Object(gb.a)(mb.GraphIterator,a));f++}return c}qFl(a){if(Jd.TableReader.Nq(a.tCd)&&a.kzc&&a.ETh){var b=Object(gb.a)(306,a.tCd.lr),c=a.ETh,f=Array(b.O4),l=a.kzc.qla;for(let u=0;u<f.length;u++)for(f[u]=c[l],l++;a.VUc.contains(l-a.kzc.qla);)f[u]+=c[l],l++;b.ETa=f}}ABa(a){if(U.a.instance.ga(77)||U.a.instance.ga(63))ce.forEachCellInTable(a,b=>{b.currentNode.iLa=
null;return!0}),ce.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.I4i(b,f,l):c.C4e()}return!0})}I4i(a,b,c){const f=a.currentNode,l=new mb.GraphIterator;l.Uc(a);ce.forEachCell(l,b,c,(u,I,T)=>{const ja=u.currentNode;if(ja!==f){ja.isGhostCell=!0;let Ra=!1;var ua=!0;const eb=ti.Re;eb&&(Ra=eb.isFeatureEnabled(136),eb.Nfb(136));do{u.Gb(1);if(Object(gc.a)(UJ.a,u.currentNode)){if((ua=ua&&ge.OutlineElementReader.isEmpty(u,!1))||!Ra)ua=mb.GraphIterator.ob(u.lr),
ua.uc(16),ua=!ua.Qf(1);ua||a.$l(u.currentNode,1);u.rj()}ua=!1}while(Ra&&u.gK(1))}ja.iLa=Object.assign(new VJ,{controlCell:f,RHh:I,jYf:T});1!==I||T||(f.iLa.Vcg=ja);I||1!==T||(f.iLa.Wcg=ja);ja.C4e();T||(ja.colSpan=c)});f.rowSpan=b;f.colSpan=c}lqe(a){const b=new mb.GraphIterator;b.Uc(a);ce.returnToContainingRow(b);var c=b.currentNode;b.Gb(1);const f=new mb.GraphIterator;f.Uc(a);ce.returnToContainingTable(f);a=f.currentNode;this.ABa(f);const l=Gr.a.instance.createInstance(393251);this.Tdc(f,l,c,c,!1);
f.Cl(l);c=Jd.TableReader.ej(a);for(let u=0;u<c;++u){const I=b.currentNode,T=this.hua();this.F2b(f,T,I,!1,!0);if(!T.isGhostCell)if(I.isGhostCell){let ja;(ja=I.iLa.controlCell).rowSpan=ja.rowSpan+1}else I.rowSpan=2;b.Qf(1)}this.lRb(a,Jd.TableReader.fl(a)+1);ce.returnToContainingTable(f);this.ABa(f);return l}kqe(a){const b=mb.GraphIterator.ob(a.p4h());let c=Jd.TableReader.ej(b.currentNode);a=vo.a(a);const f=a+1;this.ABa(b);b.Gb(1);do{const u=b.Kq(a,1);b.Dc();const I=this.hua();this.Gdc(b,I,u,!1,!1);
if(!I.isGhostCell)if(u.isGhostCell){var l=void 0;(l=u.iLa.controlCell).colSpan=l.colSpan+1}else u.colSpan=2}while(b.sk(1));this.ABa(b);(l=b.currentNode.ra(rb.a.Wv,null))&&(l=rd.a.clone(l));this.XQb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(rb.a.Wv,l));this.brc(b.currentNode,f,!1,1,null)}dvd(a,b){Jd.TableReader.nu(a.currentNode)&&U.a.instance.ga(63)&&this.JCh(a,c=>this.vCj(c,b),(c,f)=>{c.He(ib.a.wv,f)},ib.a.complexTable)}LWj(a,b,c,f){let l=b;const u=b.iLa;U.a.instance.ga(77)&&
(a.isGhostCell=!1);if(u)if(ti.a1c(u,!f))a.isGhostCell=!0;else{const I=ti.KAb(u.controlCell,f);!b.isGhostCell&&c||!c&&ti.a1c(u,f)===I-1?(l=u.controlCell,!f&&l.Kne&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,ti.Fnb(u.controlCell,f,I+1));f&&l.qdb&&(a.colSpan=l.colSpan)}return l}mVj(a,b,c){var f=a.iLa;if(f)if(a.isGhostCell)this.oWj(f,b);else if(f=ti.KAb(a,b),1<f){const l=ti.KAb(a,!b),u=new mb.GraphIterator;u.set(a);u.uc(14);a=new mb.GraphIterator;a.Uc(u);const I=b?ce.moveToNextRow(a):a.Qf(1);ti.Fnb(I,b,
f-1);ti.Fnb(I,!b,l);c(a,u)}}oWj(a,b){ti.a1c(a,!b)||ti.Fnb(a.controlCell,b,ti.KAb(a.controlCell,b)-1)}sUb(a,b){let c=!1;ce.forEachCellInTable(a,f=>se.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.He(b,c)}JCh(a,b,c,f){var l=Jd.TableReader.fl(a.currentNode);const u=Jd.TableReader.ej(a.currentNode);if(l&&u){var I=!1,T=!1,ja=Array(l);ce.forEachCellInTable(a,(Ub,Xb,tc)=>{tc||(ja[Xb]=Array(u));Ub=Ub.currentNode;Ub.isGhostCell?se.isSkippedCell(Ub)?ja[Xb][tc]=2:ja[Xb][tc]=1:ja[Xb][tc]=0;return!0});var ua=Array(l),
Ra=Array(l);for(var eb=0;eb<l;eb++){var Bb=!!eb;let Ub=!0;for(let Xb=0;Xb<u;Xb++)if(ja[eb][Xb])1===ja[eb][Xb]?Ub=!1:eb&&2===ja[eb-1][Xb]||(Bb=!1);else{Ub=Bb=!1;break}ua[eb]=Bb;Ra[eb]=Ub}for(--l;0<=l;l--)Ra[l]?(a.Kq(l,1),this.SUc(a),Array.removeAt(ja,l),I=!0):ua[l]&&b&&(a.Kq(l,1),I=a.Mac(1),eb=b(a.currentNode),Bb=b(I),c(I,eb+Bb),this.SUc(a),Array.removeAt(ja,l),I=!0);l=ja.length;if(0<l){ua=Array(u);Ra=Array(u);for(b=0;b<u;b++){c=!!b;eb=!0;for(Bb=0;Bb<l;Bb++)if(ja[Bb][b])1===ja[Bb][b]?eb=!1:b&&2===
ja[Bb][b-1]||(c=!1);else{eb=c=!1;break}ua[b]=c;Ra[b]=eb}b=a.currentNode.ra(rb.a.Wv,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=u-1;0<=l;l--)Ra[l]?(b&&Array.removeAt(b,l),this.QUc(a,l),T=!0):ua[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.QUc(a,l),T=!0);T&&b&&a.currentNode.setValue(rb.a.Wv,b)}(I||T)&&this.sUb(a,f)}}vCj(a,b){let c=Sk.b(a);c||(a=a.sc(b))&&(c=Re.a.WI(a.htmlElement.offsetHeight));return c}lRb(a,b){Jd.TableReader.fl(a)!==b&&a.properties.setValue(rb.a.bBa,
b)}XQb(a,b){const c=Jd.TableReader.ej(a);c!==b&&(b&&c&&a.properties.Vo(rb.a.Wv,rb.a.s4a),a.properties.setValue(rb.a.Ria,b))}T4(a,b,c,f,l,u){f=void 0===f?null:f;l=void 0===l?!1:l;u=void 0===u?!1:u;a=this.m2f(a);U.a.instance.ga(71);this.Icg(a,b,c,f,l,u);U.a.instance.ga(71);return a}m2f(a){U.a.instance.ga(63)&&Jd.TableReader.Ft(a)&&ce.getContainingTable(a);const b=Gr.a.instance.createInstance(393250);a.$l(b,2);a.Cl(b);return b}Cul(a,b,c,f,l){a=this.m2f(a);U.a.instance.ga(71);this.Icg(a,b,c,f,!1,l);da.ULS.sendTraceTag(50373653,
324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",a.id.toString(),b,c));return a}Icg(a,b,c,f,l,u){f=void 0===f?null:f;l=void 0===l?!1:l;u=void 0===u?!1:u;const I=mb.GraphIterator.ob(a);this.U1f(I,b,c,f,l);this.lRb(a,b);this.XQb(a,c);U.a.instance.ga(63);a.setValue(rb.a.gpb,!u)}U1f(a,b,c,f,l){f=void 0===f?null:f;l=void 0===l?!1:l;for(var u=0;u<b;++u){var I=new VR.a;a.$l(I,1);U.a.instance.ga(55)&&I.setValue(ib.a.Wo,qf.a.i2a())}b=null;u=!0;a.Gb(1);do for(I=0;I<c;++I){const T=
this.hua();a.$l(T,1);({OJh:b,isFirst:u}=this.Hcg(a,T,l,f,b,u));ce.returnToContainingRow(a)}while(a.sk(1))}Hcg(a,b,c,f,l,u){a.Cl(b);l&&c?ti.Rj.VUi(a,l):(ti.Wy.uX(a,!0,f),!u&&c&&(l=new mb.GraphIterator,l.Uc(a)),u=!1);return{OJh:l,isFirst:u}}wqe(a,b,c,f){Lc.ZOb("TableEditorInsertRowsBegin");const l=new mb.GraphIterator;l.Uc(a);var u=l.currentNode;l.Gb(1);let I=Sk.c(a);if(b)var T=a.NG(1);else T=a.currentNode,I++;const ja=a.Dc();U.a.instance.ga(63);this.ABa(a);let ua=null,Ra=null;for(var eb=0;eb<c;++eb){var Bb=
Gr.a.instance.createInstance(393251);Ra||(Ra=Bb);ua=Bb;this.Tdc(a,Bb,T,u,b)}u=Jd.TableReader.ej(a.currentNode);T=!0;do{T?(a.Cl(ua),T=!1):a.Qf(1);for(eb=0;eb<u;++eb){Bb=this.hua();const Ub=this.F2b(a,Bb,l.currentNode,b,!0);this.XNf(a,Bb,f(Ub));l.Qf(1)}l.Ima(1)}while(a.currentNode!==Ra);this.lRb(ja,Jd.TableReader.fl(ja)+c);this.QUe(ja,b,I,c);Lc.ZOb("TableEditorInsertRowsEnd")}SUc(a){const b=Sk.c(a);var c=b+1;a.Dc();U.a.instance.ga(63);this.ABa(a);for(--c;c>=b;--c){a.Kq(c,1);let f=a.Gb(1);for(;f;)this.PTe(f,
!0),f=a.sk(1);a.rj()}this.lRb(a.currentNode,Jd.TableReader.fl(a.currentNode)-1);this.iUe(a,b,1)}iyg(a,b,c,f,l){U.a.instance.ga(63);this.ABa(a);let u=Jd.TableReader.ej(a.currentNode);-1===b&&(b=u);const I=c?b:b-1;a.Gb(1);do{const T=a.Kq(I,1);a.Dc();for(let ja=0;ja<f;++ja){const ua=this.hua(),Ra=this.Gdc(a,ua,T,c,!1);this.XNf(a,ua,l(Ra))}}while(a.sk(1));this.jtl(a,u+f,f,b,c);this.brc(a.currentNode,b,c,f,l)}jtl(a,b,c,f,l){let u=a.currentNode.ra(rb.a.s4a,null),I=a.currentNode.ra(rb.a.Wv,null);u&&(u=rd.a.clone(u));
I&&(I=rd.a.clone(I));this.XQb(a.currentNode,b);if(U.a.instance.ga(30)&&u){const T=Array(b);let ja=0;for(;ja<f;++ja)T[ja]=u[ja];for(;ja<f+c;++ja)T[ja]=!1;for(;ja<b;++ja)T[ja]=u[ja-c];a.currentNode.setValue(rb.a.s4a,T)}I&&(b=this.gNf(a,I,b,f,l,c),a.currentNode.setValue(rb.a.Wv,b))}gNf(a,b,c,f,l,u){a=Array(c);let I=l=0;for(;l<f;++l)a[l]=b[l],I+=a[l];for(;l<c;++l)a[l]=0>l-u?b[0]:b[l-u],I+=a[l];if(U.a.instance.ga(63)&&0<I)for(b=0/I,l=0;l<c;++l)a[l]=Math.max(Ad.a.Cf(wo.a.oCd,0),a[l]*b);return a}brc(){}QUe(){}Tdc(a,
b,c){a.Z4c(b,c,1,ti.E6a?ti.E6a():null)}Gdc(a,b,c,f){a.Cl(c);f=f?a.Mac(1):c;a.Dc();a.Z4c(b,f,1,ti.E6a?ti.E6a():null);return c}F2b(a,b,c){a.BJf(b,1,ti.E6a?ti.E6a():null);return c}XNf(a,b,c){se.isGhostCellNode(b)||(a.Cl(b),ti.Wy.uX(a,!0,c),ce.returnToContainingRow(a))}QUc(a,b){U.a.instance.ga(63);this.ABa(a);let c=Jd.TableReader.ej(a.currentNode);-1===b&&(b=c-1);a.Gb(1);do for(let f=b+1-1;f>=b;--f)a.Kq(f,1),this.PTe(a.currentNode,!1),a.rj();while(a.sk(1));this.itl(a,c-1,b);this.hUe(a,b,1)}itl(a,b,c){var f=
a.currentNode.ra(rb.a.s4a,null);let l=a.currentNode.ra(rb.a.Wv,null);f&&(f=rd.a.clone(f));l&&(l=rd.a.clone(l));this.XQb(a.currentNode,b);if(f){var u=Array(b);let I=0;for(;I<c;++I)u[I]=f[I];for(;I<b;++I)u[I]=f[I+1];a.currentNode.setValue(rb.a.s4a,u)}if(l){f=Array(b);for(u=0;u<c;++u)f[u]=l[u];for(;u<b;++u)f[u]=l[u+1];a.currentNode.setValue(rb.a.Wv,f)}}mergeCells(){}PTe(){}iUe(){}hUe(){}Q$i(a){const b=vo.a(a);a.Dc();a.Dc();this.QUc(a,b)}hua(){const a=Gr.a.instance.createInstance(393252);a.setValue(rb.a.MF,
mn.a.first);(new DA.OutlineIndentInfo(!0)).oJh(a);return a}kL(a,b){a.setValue(rb.a.tm,b);a.setValue(rb.a.xK,b)}aXf(){}l3a(a,b,c){const f=Jd.TableReader.ej(a);let l=a.ra(rb.a.s4a,null);l=l?rd.a.clone(l):Array(f);let u=a.ra(rb.a.Wv,null);u=u?rd.a.clone(u):Array(f);l[b]=!0;u[b]=c;a.setValue(rb.a.Wv,u);a.setValue(rb.a.s4a,l)}static get Eh(){return ti.Sf||(ti.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}static get Re(){return ti.kd||(ti.kd=Tb.a.instance.ub("Box4.IFeatureHelper"))}static omg(a,b){b=
void 0===b?!0:b;const c=new WJ.a;if(a){let f=null;a=$d.SelectionFactory.hk(a,b);if(!a)da.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(Od.a.JZf(a.ga(b))){f=a.ga(b);break}f&&(a=Od.a.yt(f),a.cache.ou&&(a=a.le(null),ti.Eh.fL(a)),c.formatting=a.en,c.languageId=Od.a.language(a),U.a.instance.ga(71)&&(c.style=Wb.StyleReader.iF(f.node)))}return c}static Fnb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static KAb(a,b){return b?a.rowSpan:a.colSpan}static a1c(a,b){return b?
a.RHh:a.jYf}static yBj(a,b){return b?a.Wcg:a.Vcg}static OTi(a,b,c){let f=a.ra(rb.a.Wv,null);f=f?rd.a.clone(f):Array(c);f[b]=0;a.setValue(rb.a.Wv,f)}}ti.Sf=null;ti.kd=null;ti.Wy=null;ti.Rj=null;ti.E6a=null;Object(m.a)(ti,"TableEditor",null,[1795]);class Nr{constructor(a){this.krb=this.UQ=0;Bc.SelectionEditor.uy(a)||(a=Bc.SelectionEditor.Km(a,!0,!1));a=a.Ua;const b=new mb.GraphIterator;b.set(a.node);Bc.SelectionEditor.Bu(b);Bc.SelectionEditor.nh(a)&&(this.UQ=a.Ra,this.krb=a.uU);Bc.SelectionEditor.G$(a)&&
b.Ug(12);this.GAf=new Xy(b)}restore(){var a=new mb.GraphIterator;this.GAf.Um(Object(R.a)(this,this.NLl,"selectableFilter"),null);var b=new mB.a;const c=new mB.a;this.GAf.TGh(a,c,b);if($a.ParagraphReader.rt(a.currentNode)){if(!c.value&&b.value)return $d.SelectionFactory.hk(a.currentNode,!1);b=me.a.rk(a.currentNode,this.UQ);-1!==this.krb&&(a=$a.ParagraphReader.IVa(a.currentNode,this.UQ),0<this.krb&&this.krb<=a&&(b.uU=this.krb,b.Mta=this.krb));return $d.SelectionFactory.Dv(b)}return a.currentNode.yC?
Bc.SelectionEditor.Km($d.SelectionFactory.Nl(a.currentNode),!b.value,!1):(a=Bc.SelectionEditor.dma(a,!b.value))?$a.ParagraphReader.rt(a)?$d.SelectionFactory.fh(a,b.value?$a.ParagraphReader.textLength(a):0):$d.SelectionFactory.Nl(a):null}NLl(a){return a.currentNode.bIa||a.currentNode.pK}}Object(m.a)(Nr,"IpReference",null,[]);class XJ{constructor(){this.tableNode=null;this.columns=this.rows=0;this.jpk=!1}}Object(m.a)(XJ,"TableActionData",null,[]);var WR=d(185);class Ft{constructor(){this.r$b=!1}}Object(m.a)(Ft,
"TrackChangeDeletionActionData",null,[]);class Lc{static get kea(){return Lc.yv||(Lc.yv=Tb.a.instance.ub("Box4.IAutoCorrectScheduler"))}static get KN(){return Lc.JH||(Lc.JH=Tb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get aaj(){return Lc.Eqf||(Lc.Eqf=Tb.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static Yr(){return Lc.yn||(Lc.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static get tBb(){return Lc.G6a||(Lc.G6a=a=>ti.omg(a))}static set tBb(a){Lc.G6a=
a}static get Wje(){return Lc.pMd||(Lc.pMd=Lc.RJj)}static set Wje(a){Lc.pMd=a}static get Tje(){return Lc.mMd||(Lc.mMd=Lc.KJj)}static set Tje(a){Lc.mMd=a}static get Uje(){return Lc.nMd||(Lc.nMd=Lc.MJj)}static set Uje(a){Lc.nMd=a}static get Vje(){return Lc.oMd||(Lc.oMd=Lc.OJj)}static set Vje(a){Lc.oMd=a}static get Xje(){return Lc.qMd||(Lc.qMd=Lc.TJj)}static set Xje(a){Lc.qMd=a}static get nme(){return Lc.tMd||(Lc.tMd=Lc.hTj)}static set nme(a){Lc.tMd=a}static get ike(){return Lc.rMd||(Lc.rMd=Lc.BKj)}static set ike(a){Lc.rMd=
a}static get IEb(){return Lc.VOd||(Lc.VOd=Lc.ppk)}static set IEb(a){Lc.VOd=a}static get Re(){return Lc.kd||(Lc.kd=Tb.a.instance.ub("Box4.IFeatureHelper"))}static get Eh(){return Lc.Sf||(Lc.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}static get kg(){return Lc.zd||(Lc.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g8(){return Lc.Pp||(Lc.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get f4d(){return Lc.JPa||
(Lc.JPa=Tb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get kJ(){return Rl.a.instance}static get Jj(){return mi.a.instance}static get eg(){return Lc.qh||(Lc.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static get hs(){return Lc.ir||(Lc.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}static get zi(){return Lc.Rj||(Lc.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Dn(){return Lc.tja||(Lc.tja=Uh.ContextSetEditor.instance)}static set Dn(a){Lc.tja=a}static get fd(){return jd.a.instance}static get Lr(){return Lc.EJ||
(Lc.EJ=Tb.a.instance.resolve("Box4.ITableEditor"))}static get Yu(){null==Lc.qG&&(Lc.qG=A.AFrameworkApplication.fa.getBooleanAppSetting("UnblockComplexTableIsEnabled")&&!U.a.instance.ga(30));return Lc.qG}static qb(a){const b=u=>gj.Zua(u.Oa,!1),c=(u,I,T,ja,ua)=>{const Ra=ad.App.uOa.G0f(b);ua[Lc.I2f]={};return Ra(u,I,T,ja,ua)};Lc.F9j();const f=A.AFrameworkApplication.Pa;a=a.H0f();f.xa(G.a.T4,ta.a.view,Lc.E7i);f.xa(G.a.T4,ta.a.Xf,Lc.T4);f.pe(G.a.T4,1028);f.xa(G.a.Yva,ta.a.view,Lc.p5c);f.xa(G.a.Yva,ta.a.tableRow,
Lc.insertRow);f.pe(G.a.Yva,1028);f.xa(G.a.nXa,ta.a.view,Lc.p5c);f.xa(G.a.nXa,ta.a.tableRow,Lc.insertRow);f.pe(G.a.nXa,1028);f.xa(G.a.beb,ta.a.view,Lc.p5c);f.xa(G.a.beb,ta.a.tableRow,Lc.insertRow);f.pe(G.a.beb,1028);f.xa(G.a.kXa,ta.a.view,Lc.bDb);f.xa(G.a.kXa,ta.a.tableCell,Lc.insertColumn);f.pe(G.a.kXa,4);f.xa(G.a.Idc,ta.a.view,Lc.bDb);f.pe(G.a.Idc,4);f.xa(G.a.$db,ta.a.view,Lc.bDb);f.xa(G.a.$db,ta.a.tableCell,Lc.insertColumn);f.pe(G.a.$db,4);f.xa(G.a.Hdc,ta.a.view,Lc.bDb);f.pe(G.a.Hdc,4);f.xa(G.a.mXa,
ta.a.view,Lc.bDb);f.xa(G.a.mXa,ta.a.tableCell,Lc.insertColumn);f.pe(G.a.mXa,1028);f.xa(G.a.mFa,ta.a.view,Lc.z4f);f.xa(G.a.mFa,ta.a.tableCell,Lc.mFa);f.pe(G.a.mFa,4);f.xa(G.a.deleteRow,ta.a.view,Lc.z4f);f.xa(G.a.deleteRow,ta.a.tableRow,Lc.deleteRow);f.pe(G.a.deleteRow,1028);f.xa(G.a.S9,ta.a.view,Lc.baj);f.xa(G.a.S9,ta.a.table,Lc.S9);f.pe(G.a.S9,1028);f.xa(G.a.S$a,ta.a.table,Lc.S$a);f.xa(G.a.S$a,ta.a.view,a);f.pe(G.a.S$a,4);f.xa(G.a.insertTable,ta.a.view,Lc.Qbk);f.xa(G.a.insertTable,ta.a.Xf,Lc.insertTable);
f.pe(G.a.insertTable,1036);f.xa(G.a.mergeCells,ta.a.view,Lc.uXk);f.xa(G.a.mergeCells,ta.a.tableCell,Lc.mergeCells);f.pe(G.a.mergeCells,4);f.xa(G.a.splitCells,ta.a.view,Lc.B4l);f.xa(G.a.splitCells,ta.a.tableCell,Lc.splitCells);f.pe(G.a.splitCells,4);f.pa(G.a.xol,ta.a.view,br.a.V2,96);f.pa(G.a.zol,ta.a.view,br.a.V2,96);f.xa(G.a.v8l,ta.a.view,br.a.jI);f.xa(G.a.I8l,ta.a.view,br.a.jI);f.xa(G.a.C5c,ta.a.view,Lc.C5c);f.pe(G.a.C5c,1124);f.xa(G.a.uQb,ta.a.view,Lc.uQb);f.xa(G.a.Zwc,ta.a.view,Lc.ILl);f.xa(G.a.oxd,
ta.a.view,Lc.oxd);f.xa(G.a.A6e,ta.a.view,Lc.A6e);f.xa(G.a.TAc,ta.a.view,a);f.xa(G.a.TAc,ta.a.table,Lc.TAc);f.pe(G.a.TAc,4);f.xa(G.a.buc,ta.a.view,a);f.xa(G.a.buc,ta.a.table,Lc.buc);f.pe(G.a.buc,96);U.a.instance.ga(30)&&(f.xa(G.a.$3a,ta.a.view,Lc.bDb),f.xa(G.a.$3a,ta.a.Xf,Lc.insertColumn),f.pe(G.a.$3a,4),f.xa(G.a.mzc,ta.a.Xf,Lc.insertRow),f.xa(G.a.mzc,ta.a.view,Lc.p5c),f.pe(G.a.mzc,4));f.xa(G.a.LOb,ta.a.view,Lc.LOb);U.a.instance.ga(63)?f.pe(G.a.LOb,96):f.pe(G.a.LOb,1124);a=[G.a.Vye,G.a.Tye,G.a.Xye,
G.a.Uye,G.a.Yye,G.a.Wye,G.a.Sye,G.a.Kgc,G.a.Jgc,G.a.Lgc,G.a.Hgc,G.a.Ggc,G.a.Igc,G.a.Egc,G.a.Dgc,G.a.Fgc];for(var l of a)f.xa(l,ta.a.view,Lc.pma),f.xa(l,ta.a.tableCell,Lc.$Ei),f.pe(l,4);l=[G.a.V_e,G.a.U_e,G.a.W_e,G.a.S_e,G.a.R_e,G.a.T_e,G.a.P_e,G.a.O_e,G.a.Q_e];for(const u of l)f.xa(u,ta.a.view,c),f.xa(u,ta.a.paragraph,Lc.snl),f.pe(u,68)}static F9j(){Lc.GE.$(G.a.Yye,Lc.GE.$(G.a.Kgc,Lc.GE.$(G.a.Jgc,Lc.GE.$(G.a.Lgc,Lc.GE.$(G.a.V_e,Lc.GE.$(G.a.U_e,Lc.GE.$(G.a.W_e,Lc.KYh)))))));Lc.GE.$(G.a.Wye,Lc.GE.$(G.a.Hgc,
Lc.GE.$(G.a.Ggc,Lc.GE.$(G.a.Igc,Lc.GE.$(G.a.S_e,Lc.GE.$(G.a.R_e,Lc.GE.$(G.a.T_e,Lc.bYk)))))));Lc.GE.$(G.a.Sye,Lc.GE.$(G.a.Egc,Lc.GE.$(G.a.Dgc,Lc.GE.$(G.a.Fgc,Lc.GE.$(G.a.P_e,Lc.GE.$(G.a.O_e,Lc.GE.$(G.a.Q_e,Lc.YIi)))))));Lc.lD.$(G.a.Vye,Lc.lD.$(G.a.Kgc,Lc.lD.$(G.a.Hgc,Lc.lD.$(G.a.Egc,Lc.lD.$(G.a.V_e,Lc.lD.$(G.a.S_e,Lc.lD.$(G.a.P_e,1)))))));Lc.lD.$(G.a.Tye,Lc.lD.$(G.a.Jgc,Lc.lD.$(G.a.Ggc,Lc.lD.$(G.a.Dgc,Lc.lD.$(G.a.U_e,Lc.lD.$(G.a.R_e,Lc.lD.$(G.a.O_e,2)))))));Lc.lD.$(G.a.Xye,Lc.lD.$(G.a.Lgc,Lc.lD.$(G.a.Igc,
Lc.lD.$(G.a.Fgc,Lc.lD.$(G.a.W_e,Lc.lD.$(G.a.T_e,Lc.lD.$(G.a.Q_e,3)))))));Lc.lD.$(G.a.Uye,6)}static uQb(a,b,c){He.a.mark(5756);if(!b.view.xi)return 2;const f=b.view;if(!f.Rb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),8;a=f.Rb.Ik;a=Lc.Dn.D9(a,14);if(!a)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),8;if(2===c){let l=null;b=a.node;c=Jd.TableReader.nu(b);const u=Lc.Yu;if(!U.a.instance.ga(104)||c&&!u)l=$d.SelectionFactory.Nl(a.node);else if(U.a.instance.ga(77))c=$d.SelectionFactory.dUc(b,u),f.Rb.nRb(c,
null);else{a=mb.GraphIterator.ob(b);a.Gb(1);for(b=[Mr.TableNodeContext.create(a.currentNode)];a.Qf(1);)c&&Sk.h(a)||Array.add(b,Mr.TableNodeContext.create(a.currentNode));l=new Nd.Selection(b,!0)}l&&(c=new uf.a(null,I=>{f.Rb.setSelection(l,I);return!1},null),c.Fm("SelectTable"),c.Lh())}He.a.mark(5757);return 32}static ILl(a,b,c){He.a.mark(5752);if(!b.view.xi)return 2;a=b.view;if(!a.Rb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),8;b=a.Rb.Oa;if(!b)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),2;b=
Lc.Xje(b);if(32!==b.response)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),b.response;if(2===c){var f=b.DB;b=c=f[0].node;var l=mb.GraphIterator.ob(c);l.uc(14);let T=null;var u=ce.getContainingTable(l);u=Jd.TableReader.nu(u);var I=Lc.Yu;I=U.a.instance.ga(104)&&(!u||I);const ja=[];for(let ua=0;ua<f.length;++ua){const Ra=l.currentNode===f[ua].node;if(Ra||u&&Sk.d(l))b=l.currentNode,!I||u&&Sk.h(l)||Array.add(ja,Mr.TableNodeContext.create(l.currentNode)),ce.moveToNextRow(l),Ra||--ua}f=a.Rb.Oa.kb;l=null;
I?U.a.instance.ga(77)?(l=new mb.GraphIterator,I=new mb.GraphIterator,f.Kf?(l.set(c),I.set(b)):(l.set(b),I.set(c)),l.uc(14),ce.moveToFirstColumn(l),I.uc(14),ce.moveToLastColumn(I),l=u?$d.SelectionFactory.Y6b(l,I):$d.SelectionFactory.k2f(l,I)):T=new Nd.Selection(ja,U.a.instance.ga(63)||f.Kf):T=$d.SelectionFactory.X1f(c,b);T&&(l=new yc.SelectionCollection([T],0));a.Rb.nRb(l,null)}He.a.mark(5753);return 32}static oxd(a,b,c){He.a.mark(5754);if(!b.view.xi)return 2;a=b.view;if(!a.Rb)return Lc.fd.kc(be.a.ei,
{["Reason"]:Ud.a.Sya}),8;b=a.Rb.Oa;if(!b)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),2;b=Lc.Vje(b);if(32!==b.response)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),b.response;if(2===c){c=[];var f=b.DB,l=new mb.GraphIterator;l.set(f[0].node);l.uc(14);b=ce.getContainingTable(l);var u=Number.MAX_VALUE,I=0;if(f.length===Jd.TableReader.ej(ce.getContainingTable(l)))I=null,U.a.instance.ga(104)&&(I=$d.SelectionFactory.dUc(b,Lc.Yu))?c=I.toArray():(I=$d.SelectionFactory.Nl(b),Array.add(c,I)),u=0,I=Jd.TableReader.ej(b)-
1;else{for(l=0;l<f.length;++l){var T=mb.GraphIterator.ob(f[l].node);T.uc(14);T=vo.a(T);u=Math.min(u,T);I=Math.max(I,T)}f=mb.GraphIterator.ob(b);ce.moveToFirstRow(f);ce.moveToColumnByIndex(f,u);l=new mb.GraphIterator;l.Uc(f);ce.moveToColumnByIndex(l,I);var ja;T=b.rq();T=U.a.instance.ga(104)&&(!T||Lc.Yu);do(ja=T?$d.SelectionFactory.aUc(f,l,!0,!0):$d.SelectionFactory.X1f(f.currentNode,l.currentNode))&&Array.add(c,ja),ja=!ce.moveToNextRow(f),ce.moveToNextRow(l);while(!ja)}f=mb.GraphIterator.ob(b);ce.moveToCell(f,
0,u);u=Jd.TableReader.fl(b);b=mb.GraphIterator.ob(b);ce.moveToCell(b,u-1,I);c=new yc.SelectionCollection(c,c.length-1,0,f,b);a.Rb.nRb(c,null)}He.a.mark(5751);return 32}static A6e(a,b,c){He.a.mark(5750);if(!b.view.xi)return 2;a=b.view;if(!a.Rb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),8;b=a.Rb.Ik;if(!b)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),2;var f=Lc.Dn.dC(b);b={};for(var l=0;l<f.length;++l)if(f[l].El){var u=mb.GraphIterator.ob(f[l].node);u.wf();if(!se.isTableCellOrInside(u))return 8;
ce.returnToCell(u);b[u.currentNode.id.toString()]=u}if(2===c){if(U.a.instance.ga(104)){c=a.Rb.Oa;if(c.kb.yg)return He.a.mark(5751),32;f=c.kb;u=f.Kf?f.Ua:f.vf;l=f.Kf?f.vf:f.Ua;c=new mb.GraphIterator;c.set(u.node);c.wf();u=new mb.GraphIterator;u.set(l.node);u.wf();l=null;if((l=ce.returnToLowestCommonTable(c,u))&&!l.rq()){var I=Bc.SelectionEditor.Km(f,!0,!1);I=Mr.TableNodeContext.create(c.currentNode,I.Ua);I=$d.SelectionFactory.U6b($d.SelectionFactory.Dv(I));a.Rb.VF(I);He.a.mark(5751);return 32}}c=[];
for(I in b)f=$d.SelectionFactory.Nl(b[I].currentNode),Array.add(c,f);0<c.length&&(I=new yc.SelectionCollection(c,c.length-1),a.Rb.nRb(I,null))}He.a.mark(5751);return 32}static LOj(){return A.AFrameworkApplication.fa.getBooleanAppSetting("WacTableCellAlignmentIsEnabled")}static $Ei(a,b,c,f,l){f=Lc.VCi();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(se.isGhostCellNode(b))return 32;Lc.GE.Ib(a)&&(c=Lc.GE.ga(a),b.He(ib.a.ldf,c));Lc.lD.Ib(a)&&(a=Lc.lD.ga(a),Lc.KOf(b,a));return 32}static KOf(a,
b){if(!se.isGhostCellNode(a)&&(a=mb.GraphIterator.ob(a),Pg.OutlineNavigator.Gba(a))){do if(a.Gb(2)){const c=a.currentNode;12===c.type?c.He(rb.a.tm,b):14===c.type?Jd.TableReader.meg(c,f=>{Lc.KOf(f,b)}):da.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",WR.a[c.type]);a.Dc()}while(a.Up())}}static snl(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[Lc.I2f];if(Lc.p6d in c&&!c[Lc.p6d])return 32;f=Lc.lD.ga(a);a=Lc.GE.ga(a);if(!b||!b.node)return 2;var u=b.node;b=$a.ParagraphReader.zM(u);
u=mb.GraphIterator.ob(u);u.uc(16);u.Ug(16);u=u.currentNode.ra(ib.a.ldf,Lc.KYh);c[Lc.p6d]=l[Xh.a.On]=f===b&&a===u;return 32}static baj(a,b,c,f,l){if(!b.view.xi)return 2;a=b.view;if(!a.Rb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),8;let u=a.Rb.Ik;u=Lc.Dn.D9(u,14);if(!u)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),8;if(1===c)return A.AFrameworkApplication.Pa.Ai(u,G.a.S9,c,!0,f,l);He.a.mark(7117);const I=new Nr(Bc.SelectionEditor.Km($d.SelectionFactory.Dv(u),!0,!1)),T=new pg.GraphTransaction(15);
try{T.rd(b.view.Zg);const ja=si.Y0c(u.node,!0);ja.vra(u);const ua=Object(gb.a)(Ft,l)||new Ft,Ra=A.AFrameworkApplication.Pa.Ai(u,G.a.S9,c,!0,f,Lc.kg.Gg?ua:l),eb=!Lc.kg.Gg||!Lc.kg.wD||ua.r$b;32===Ra&&2===c&&eb?(ja.normalize(),a.Rb.setSelection(I.restore()),F.FocusManager.instance().Df(a.WJ)):ja.cancel()}finally{T&&T.dispose()}He.a.mark(7118);return 32}static E7i(a,b,c,f,l){He.a.mark(4943);let u=null;2===c&&(u=new pg.GraphTransaction(15),u.rd(b.view.Zg));a=A.AFrameworkApplication.Pa.Ai(b.GF,a,c,!0,f,
l);if(32===a&&2===c){if(!b.view.xi)return 2;b=b.view;c=b.Rb.Ik;c=Lc.Dn.D9(c,16);f=new mb.GraphIterator;f.set(c.node);f.uc(14);ce.moveToNextOrPreviousCell(f,!1);b.Rb.setSelection($d.SelectionFactory.hk(f.currentNode,!0))}u&&u.dispose();He.a.mark(4944);return a}static bDb(a,b,c,f){if(!b.view.xi)return 2;var l=b.view;if(!l.Rb||!l.Rb.Oa.kb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;He.a.mark(4945);var u=l.Rb.Ik;if(!u)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;var I=a===G.a.kXa||a===G.a.$3a;
l=a===G.a.mXa;var T=Lc.Dn.dC(u);if(!T||0>=T.length)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;T=T[0].node;if(!T)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;I=Jd.TableReader.kn(T)?a===G.a.Hdc||I:a===G.a.Idc||I;const ja=Lc.Tje(u,l,I);if(32!==ja.response)return ja.response;u=ja.Yn;T=Jd.TableReader.nu(u);const ua=a;let Ra;Ra=I?Object(gb.a)(305,ja.DB[ja.DB.length-1]):Object(gb.a)(305,ja.DB[0]);a!==G.a.$3a&&(a=l?G.a.mXa:I?G.a.kXa:G.a.$db);I=null;2===c&&(I=new pg.GraphTransaction(15),I.rd(b.view.Zg));
a=A.AFrameworkApplication.Pa.Ai(Ra,a,c,!0,f,ja.vLa);if(l){b={MenuItemId:"buttonFirstColumn"};b[Xh.a.On]=!0;f=A.AFrameworkApplication.Pa.Ai(me.a.create(u),2===c?G.a.oU:G.a.Tba,2,!0,f,b);if(32!==f)return f;if(1===c&&b[Xh.a.On])return 2}I&&I.dispose();2===c&&da.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",ua,G.a.Fv(ua)||"Unknown",U.a.instance.ga(77),T,a,u.id.toString(),Jd.TableReader.ej(u)));
He.a.mark(4946);return a}static ZOb(a){Lc.OGd.set(a,Date.now().toString())}static qUi(){Lc.OGd.clear()}static HOj(){return Array.from(Lc.OGd,a=>{var [b,c]=a;return`${b}=${c}`})}static p5c(a,b,c,f){if(!b.view.xi)return 2;var l=a===G.a.mzc,u=a===G.a.beb;const I=u||a===G.a.nXa;Lc.ZOb("TableInsertRowViewBegin");He.a.mark(4947);var T=b.view;if(!T.Rb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),8;const ja=T.Rb.Ik;if(!ja)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;T=Lc.Wje(ja,u,I);if(32!==T.response)return Lc.fd.kc(be.a.ei,
{["Reason"]:Ud.a.TFa}),T.response;const ua=Jd.TableReader.nu(T.Yn);let Ra=null;2===c&&(Ra=new pg.GraphTransaction(15),Ra.rd(b.view.Zg));b=I?Object(gb.a)(305,T.DB[0]):Object(gb.a)(305,T.DB[T.DB.length-1]);l=A.AFrameworkApplication.Pa.Ai(l?ja:b,a,c,!1,f,T.vLa);if(u){u={MenuItemId:"buttonFirstRow"};u[Xh.a.On]=!0;f=A.AFrameworkApplication.Pa.Ai(me.a.create(T.Yn),2===c?G.a.oU:G.a.Tba,2,!0,f,u);if(32!==f)return f;if(1===c&&u[Xh.a.On])return 2}Ra&&Ra.dispose();2===c&&da.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",
a,G.a.Fv(a)||"Unknown",U.a.instance.ga(77),ua,l,T.Yn.id.toString(),Jd.TableReader.fl(T.Yn)));He.a.mark(4948);Lc.ZOb("TableInsertRowViewEnd");return l}static dih(a){for(ce.moveToFirstColumn(a);se.isGhostCell(a)&&ce.moveToPreviousRow(a););}static XYk(a){for(ce.moveToFirstRow(a);se.isGhostCell(a)&&ce.moveToPreviousColumn(a););}static uXk(a,b,c,f){if(U.a.instance.ga(30)||!b.view.xi)return 2;const l=b.view;if(!l.Rb||!l.Rb.Oa.kb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;const u=Lc.oFj(l.Rb.Ik);if(32!==
u.response)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),u.response;let I=null,T=null;2===c&&(I=new Nr(l.Rb.Oa.kb),I.restore(),T=new pg.GraphTransaction(15),T.rd(b.view.Zg));a=A.AFrameworkApplication.Pa.Ai(me.a.create(u.controlCell),a,c,!1,f,u);2===c&&32===a&&(b=mb.GraphIterator.ob(u.Yn),b.wf()&&Lc.Lr.dvd(b,l.Na),I&&(l.Rb.setSelection($d.SelectionFactory.hk(u.controlCell,!0)),F.FocusManager.instance().Df(l.WJ)));T&&T.dispose();2===c&&da.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",
a));return a}static oFj(a){const b=new TJ;b.Yn=null;b.controlCell=null;if(!a)return b.response=8,b;var c=Lc.Dn.dC(a);if(1>=c.length)return b.response=2,b;const f=new La.a;a={};for(let T=0;T<c.length;++T)if(c[T].El){const ja=mb.GraphIterator.ob(c[T].node);ja.wf();if(!se.isTableCellOrInside(ja))return b.response=8,b;var l=Object(gb.a)(Vg.AParagraphNode,ja.currentNode);if(l&&!l.ra(ib.a.Kve,!0))return b.response=8,b;ce.returnToCell(ja);l=ja.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());
var u=ce.getContainingTable(ja),I=ce.getContainingTableRow(ja).id.toString();if(b.Yn)if(b.Yn!==u)if(ja.JWa(b.Yn))continue;else if(mb.GraphIterator.ob(b.Yn).Gca(u))a={},b.Yn=u,b.controlCell=l,a[I]=l.colSpan;else return b.response=8,b;else a[I]=I in a?a[I]+l.colSpan:l.colSpan;else a={},b.Yn=u,b.controlCell=l,a[I]=l.colSpan;for(u=1;u<l.rowSpan;u++)ce.moveToNextRow(ja),I=ce.getContainingTableRow(ja).id.toString(),a[I]=I in a?a[I]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);
b.rowSpan=c.length;b.colSpan=a[c[0]];for(const T of c)if(b.colSpan!==a[T])return b.response=2,b;b.response=32;return b}static B4l(a,b,c,f,l){if(U.a.instance.ga(30)||!b.view.xi)return 2;const u=b.view;if(!u.Rb||!u.Rb.Oa.kb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;if(Bc.SelectionEditor.uy(u.Rb.Oa.kb))var I=u.Rb.Oa.kb.Ua.node;else{I=u.Rb.Ik;if(!I)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),8;I=Lc.Dn.dC(I);if(1!==I.length||!Object(gc.a)(me.a,I[0]))return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.NZf}),
8;I=I[0].node}I=mb.GraphIterator.ob(I);I.wf();if(!se.isInTableCell(I))return 2;ce.returnToContainingCell(I);I=I.currentNode;let T=null,ja=null;2===c&&(T=new Nr(u.Rb.Oa.kb),T.restore(),ja=new pg.GraphTransaction(15),ja.rd(b.view.Zg));b=me.a.create(I);a=A.AFrameworkApplication.Pa.Ai(b,a,c,!1,f,l);2===c&&32===a&&T&&(u.Rb.setSelection($d.SelectionFactory.hk(I,!0)),F.FocusManager.instance().Df(u.WJ));ja&&ja.dispose();2===c&&da.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",
a));return a}static z4f(a,b,c,f,l){if(!b.view.xi)return 2;const u=a===G.a.deleteRow;u?He.a.mark(4951):He.a.mark(4949);const I=b.view;if(!I.Rb||!I.Rb.Oa.kb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;var T=I.Rb.Ik;const ja=Lc.ike(T,u,I.Rb);if(32!==ja.response)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.TFa}),ja.response;const ua=Jd.TableReader.nu(ja.Yn);var Ra=null,eb=null,Bb=null;let Ub=!1;var Xb=!1;2===c&&(Ra=new Nr(I.Rb.Oa.kb),Xb=Ra.restore(),Bb=mb.GraphIterator.ob(Xb.Ua.node),Bb.uc(14),ce.returnToContainingCell(Bb),
Xb=se.isLastCellInRow(Bb),ce.returnToContainingRow(Bb),Ub=Sk.j(Bb),eb=si.Y0c(b.view.Zg,!0),ua&&(T=Lc.aaj.t$f(T)),eb.vra(T),Bb=new pg.GraphTransaction(15),Bb.rd(b.view.Zg));b=Object(gb.a)(Ft,l)||new Ft;f=A.AFrameworkApplication.Pa.Ai(ud.a.YTa(ja.DB),a,c,!1,f,Lc.kg.Gg&&u?b:l);T=!Lc.kg.Gg||!Lc.kg.wD||!u||b.r$b;b=l=!1;if(2===c&&32===f&&T){const tc=mb.GraphIterator.ob(ja.Yn);tc.wf()&&Lc.Lr.dvd(tc,I.Na)}2===c&&32===f&&U.a.instance.ga(30)&&Jd.TableReader.Kxe(ja.Yn)&&T&&mb.GraphIterator.ob(ja.Yn).wf()&&(Ra=
u?new Nr($d.SelectionFactory.hk(ja.Yn,!Ub)):new Nr($d.SelectionFactory.hk(ja.Yn,!Xb)),I.Rb.setSelection(Bc.SelectionEditor.Km($d.SelectionFactory.Nl(ja.Yn),!1,!1)),A.AFrameworkApplication.Pa.nb(G.a.S$a,2),b=l=!0);if(32===f&&2===c&&T){if(!l&&0>=Jd.TableReader.ej(ja.Yn)||0>=Jd.TableReader.fl(ja.Yn))l=!0;eb.normalize();if(Ra){Ra=Ra.restore();if(l)Ra=b&&!u?$d.SelectionFactory.hk(Ra.Ua.node,!Xb):$d.SelectionFactory.hk(Ra.Ua.node,!0);else if(eb=mb.GraphIterator.ob(Ra.Ua.node),eb.uc(14),u)ce.returnToContainingRow(eb),
Ub&&!U.a.instance.ga(77)?(eb.wf(),jb.OutlineElementNavigator.$e(eb),Lc.zi.Nfa(eb,!1,!0)):Lc.dih(eb),Ra=$d.SelectionFactory.hk(eb.currentNode,!0);else if(ce.returnToCell(eb),Xb&&U.a.instance.ga(30))ce.moveToLastRow(eb),Ra=$d.SelectionFactory.hk(eb.currentNode,!1);else if(U.a.instance.ga(63)||U.a.instance.ga(77))Lc.XYk(eb),Ra=$d.SelectionFactory.hk(eb.currentNode,!0);I.Rb.setSelection(Ra);F.FocusManager.instance().Df(I.WJ)}}else eb&&eb.cancel();Bb&&Bb.dispose();2===c&&da.ULS.sendTraceTag(9011549,324,
50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,G.a.Fv(a)||"Unknown",U.a.instance.ga(77),ua,f,ja.Yn.id.toString()));u?He.a.mark(4952):He.a.mark(4950);return f}static hTj(a,b){ce.moveToFirstRow(a);const c=Object(gb.a)(az.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)ce.moveToNextColumn(a);else ce.moveToPreviousColumn(a)}static RJj(a){return Lc.z$b(a,!1,!0)}static KJj(a){return Lc.z$b(a,!0,!0)}static MJj(a,b){let c=vo.a(a);
b&&(c+=a.currentNode.colSpan-1);return c}static OJj(a){a=Me.a.Jwb(a);return Lc.z$b(a,!0,U.a.instance.ga(104)&&Lc.Yu)}static TJj(a){a=Me.a.Jwb(a);return Lc.z$b(a,!1,U.a.instance.ga(104)&&Lc.Yu)}static BKj(a,b){return Lc.z$b(a,!b,!0)}static z$b(a,b,c){const f=new Fs;f.Yn=null;if(!a)return f.response=8,f;var l={};let u=[],I=!1;a=Lc.Dn.dC(a);1===a.length&&(I=!0);for(let Ra=0;Ra<a.length;++Ra)if(a[Ra].El){const eb=[];let Bb=mb.GraphIterator.ob(a[Ra].node);Bb.wf();if(!se.isTableCellOrInside(Bb))return f.response=
8,f;if(b)ce.returnToCell(Bb),c&&1<se.getColSpan(Bb.currentNode)?se.foreachMergedCells(Bb.currentNode,Ub=>{Ub=mb.GraphIterator.ob(Ub);Ub.wf();ce.moveToFirstRow(Ub);Array.add(eb,Ub)},2):Array.add(eb,Bb),ce.moveToFirstRow(Bb);else{se.isTableCell(Bb)||ce.returnToCell(Bb);var T=Bb.currentNode.rowSpan;ce.returnToContainingRow(Bb);if(1<T)for(var ja=1;ja<T;ja++){var ua=mb.GraphIterator.ob(Bb.currentNode);ua.wf();Array.add(eb,ua);ce.moveToNextRow(Bb)}Array.add(eb,Bb)}for(T=0;T<eb.length;++T)if(Bb=eb[T],ja=
ce.getContainingTable(Bb),ua=Bb.currentNode.id.toString(),!l[ua])if(l[ua]=!0,f.Yn)if(f.Yn!==ja)if(Bb.JWa(f.Yn))Lc.efg(Bb,f.Yn,b),ua=Bb.currentNode.id.toString(),l[ua]||(l[ua]=!0,Array.add(u,Bb));else if(l[ua]=!1,mb.GraphIterator.ob(f.Yn).Gca(ja)){const Ub=[];for(let Xb=0;Xb<u.length;Xb++){const tc=u[Xb];Lc.efg(tc,ja,b);ua=tc.currentNode.id.toString();l[ua]||(l[ua]=!0,Array.add(Ub,tc))}ua=Bb.currentNode.id.toString();l[ua]||(l[ua]=!0,Array.add(Ub,Bb));f.Yn=ja;Array.clear(u);u=Ub}else return f.response=
8,f;else Array.add(u,Bb);else f.Yn=ja,Array.add(u,Bb);Array.clear(eb)}if(!u.length)return f.response=8,f;f.U3a=u[0].currentNode;b=[];for(l=0;l<u.length;l++){a=u[l];if(!c&&Jd.TableReader.ZDb(a))return f.response=8,f;Array.add(b,me.a.create(a.currentNode))}f.vLa=I?1:b.length;f.DB=b;f.response=32;return f}static efg(a,b,c){do c?ce.returnToContainingCell(a):ce.returnToContainingRow(a);while(ce.getContainingTable(a)!==b);c&&ce.moveToFirstRow(a)}static C5c(a,b,c,f,l){return 1===c?(a=b.GF)&&Bc.SelectionEditor.nh(a)?
A.AFrameworkApplication.Pa.Ai(a,G.a.insertTable,c,!0,f,l):2:32}static Qbk(a,b,c,f,l){f.ED=0;f.MO=0;let u=-1,I=null,T=null,ja=null;if(!b.view.xi)return 2;const ua=b.view;if(!ua.Rb)return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),8;He.a.mark(4941);if(2===c){const Ra=ua.Rb.Ik;Ra.El&&(ja=new pg.GraphTransaction(15),T=qs.a.instance.xQj(Ra.node),ja.Jz(T),I=new mb.GraphIterator,I.Uc(T),I.Dc(),u=I.EVa(T.currentNode))}a=A.AFrameworkApplication.Pa.Ai(b.GF,a,c,!0,f,l);32===a&&2===c&&(T.isValid?(jb.OutlineElementNavigator.XK(T,
!1,!1),jb.OutlineElementNavigator.Ti(T),c=$d.SelectionFactory.hk(T.currentNode,!0)):(I.mme(u),jb.OutlineElementNavigator.Ti(I),c=$d.SelectionFactory.hk(I.currentNode,!0)),ua.Rb.setSelection(c),F.FocusManager.instance().Df(ua.WJ));ja&&ja.dispose();He.a.mark(4942);return a}static LOb(a,b){if(!b.view.xi)return 8;a=b.view;if(!a.Rb)return 8;a=Lc.Dn.dC(a.Rb.Ik);if(0>=a.length)return 8;b=new mb.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.wf(),!Jd.TableReader.Ft(b))return 8;return 32}static T4(a,
b,c){var f=b.contextId===ta.a.Xf;let l=null,u=null;if(f){l=b;if(gf.HyperlinkReader.lna(l,!0))return Lc.fd.kc(be.a.ei,{["Reason"]:Ud.a.KZf}),8;u=new mb.GraphIterator;u.set(l.node);Bc.SelectionEditor.Bu(u);we.b(u)&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.y6d}),f=!1);!l.Ra&&u.cCg&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.Zyg}),f=!1)}if(1===c||!f)return f?32:8;He.a.mark(4929);b=new pg.GraphTransaction(7);b.Jz(u);jb.OutlineElementNavigator.$e(u);c=u.currentNode;Lc.zi.Nfa(u,!1,!1);f=Lc.Lr.T4(u,1,2);const I=new mb.GraphIterator;
I.set(c);I.wf();ce.moveToCellContent(u,0,1);Lc.zi.xSb(I,u,l,!0,!0);ce.returnToContainingTable(u);ce.moveToCellContent(u,0,0);u.rj();Qm.i(I,u,null,I.role);Lc.hs.ISa(I,null);ce.returnToContainingTable(u);jb.OutlineElementNavigator.$e(u);I.Gb(1)&&Qm.h(u,null,1,1,I,-1);Lc.kea&&Lc.kea.aUb(c,H.a.zs);b.dispose();da.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,G.a.Fv(a)||"Unknown",U.a.instance.ga(77),f.id.toString()));He.a.mark(4930);return 32}static insertColumn(a,
b,c,f,l){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?da.ULS.sendTraceTag(509092047,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):da.ULS.sendTraceTag(509092046,324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var u=Bc.SelectionEditor.nh(b)&&a===G.a.$3a||b.contextId===ta.a.tableCell;f=null;if(u&&(f=new mb.GraphIterator,f.set(b.node),f.uc(14),se.isTableCellOrInside(f)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.n6b}),
u=!1),u&&!Lc.IEb(f,a)&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.m6b}),u=!1),u)){ce.returnToContainingCell(f);var I=U.a.instance.ga(63)?63:255;if(Jd.TableReader.ej(ce.getContainingTable(f))>=I)return Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.Dgh}),8}if(1===c||!u)return u?32:8;He.a.mark(4931);c=a!==G.a.$db&&a!==G.a.mXa;I=a===G.a.mXa;u=new pg.GraphTransaction(15);u.Jz(f);b.node.eI().graphTransactionOperations.ala(2);const T=new mb.GraphIterator;T.set(f.currentNode);T.uc(15);ce.returnToContainingTable(f);let ja=Lc.Uje(T,
I,c);c&&ja++;Lc.Lr.iyg(f,ja,!c,!I&&l?l:1,Lc.tBb);f.set(b.node);f.uc(16);a===G.a.$3a?(ce.moveToNextColumn(T),Pg.OutlineNavigator.Gba(T),jb.OutlineElementNavigator.$e(f),Lc.zi.Fvc(T),Lc.zi.xSb(f,T,b,!0,!0),Lc.kea&&Lc.kea.aUb(f.currentNode,H.a.zs)):(a=ad.App.Ob.ie,b=mb.GraphIterator.ob(b.node),b.wf(),Lc.nme(b,c),a.yo.Rb.setSelection($d.SelectionFactory.hk(b.currentNode,!0)));u.dispose();He.a.mark(4932);return 32}static ppk(a){return!(U.a.instance.ga(14)&&Jd.TableReader.ikk(a))&&!(U.a.instance.ga(30)&&
Jd.TableReader.ZDb(a))}static insertRow(a,b,c,f,l){const u=a===G.a.mzc,I=(f=a===G.a.beb)||a===G.a.nXa;var T=b.node;const ja=new mb.GraphIterator;ja.set(T);ja.wf();let ua=!0;Sk.m(T)||Jd.TableReader.Ft(ja)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.qae}),ua=!1);ua&&!Lc.IEb(ja,a)&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.m6b}),ua=!1);if(1===c||!ua)return ua?32:8;Lc.ZOb("TableInsertRowBegin");He.a.mark(4933);a=new pg.GraphTransaction(15);a.Jz(ja);b.node.eI().graphTransactionOperations.ala(2);u?(l=new mb.GraphIterator,
l.Uc(ja),jb.OutlineElementNavigator.$e(l),ce.returnToContainingRow(ja),Lc.Lr.wqe(ja,I,1,Lc.tBb),ce.moveToFirstColumn(ja),Pg.OutlineNavigator.Gba(ja),Lc.zi.xSb(l,ja,b,!1,!0),ce.returnToContainingRow(ja),Lc.kea&&Lc.kea.aUb(l.currentNode,H.a.zs)):Lc.Lr.wqe(ja,I,!f&&l?l:1,Lc.tBb);b=ad.App.Ob.ie;T=mb.GraphIterator.ob(T);T.uc(14);Sk.l(T)||ce.returnToContainingRow(T);f?ce.moveToFirstRow(T):I?ce.moveToPreviousRow(T):ce.moveToNextRow(T);Lc.dih(T);b.yo.Rb.setSelection($d.SelectionFactory.hk(T.currentNode,!0));
a.dispose();He.a.mark(4934);Lc.ZOb("TableInsertRowEnd");return 32}static pma(a,b,c,f,l){b=Oi.x7(a,b,c,f,l,{},16);2===c&&Lc.bra(a)&&da.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,G.a.Fv(a)||"Unknown",b));return b}static bra(a){return a===G.a.Kgc||a===G.a.Jgc||a===G.a.Lgc||a===G.a.Hgc||a===G.a.Ggc||a===G.a.Igc||a===G.a.Egc||a===G.a.Dgc||a===G.a.Fgc}static mFa(a,b,c){const f=new mb.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.wf()||(Lc.fd.kc(be.a.C3,
{["Reason"]:Ud.a.JXc}),l=!1),se.isTableCellNode(b.node)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.n6b}),l=!1));l&&!Lc.IEb(f,a)&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.m6b}),l=!1);if(l&&!Lc.kJ.T0d()){a=new mb.GraphIterator;a.Uc(f);do if(!Lc.kJ.N4b(a.currentNode)){Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.PSc});l=!1;break}while(ce.moveToNextRow(a))}if(l&&(a=new mb.GraphIterator,a.Uc(f),1!==c&&U.a.instance.ga(50)&&ad.App.ni.qy)){do for(b=ll.a.PA(a.currentNode);b.moveNext();){const u=b.currentNode;$a.ParagraphReader.ke(u)&&
ad.App.ni.v3.LDa(u)}while(ce.moveToNextRow(a))}if(1===c)return l?32:8;if(l){He.a.mark(4935);c=new pg.GraphTransaction(7);try{c.Jz(f),Lc.Lr.Q$i(f)}finally{c&&c.dispose()}He.a.mark(4936);return 32}return 2}static mergeCells(a,b,c,f,l){a=new mb.GraphIterator;if(f=b.isValid){a.set(b.node);a.wf()||(Lc.fd.kc(be.a.C3,{["Reason"]:Ud.a.JXc}),f=!1);se.isTableCellNode(b.node)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.n6b}),f=!1);if(f&&!Lc.kJ.T0d()){b=new mb.GraphIterator;b.Uc(a);var u=new mb.GraphIterator;u.Uc(a);
for(var I=0;I<l.rowSpan;I++){for(var T=0;T<l.colSpan;T++){if(!Lc.kJ.N4b(b.currentNode)){Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.PSc});f=!1;break}b.Qf(1)}if(!f)break;ce.moveToNextRow(u);b.Uc(u)}}if(f&&1!==c&&U.a.instance.ga(50)&&ad.App.ni.qy)for(b=new mb.GraphIterator,b.Uc(a),u=new mb.GraphIterator,u.Uc(a),I=0;I<l.rowSpan;I++){for(T=0;T<l.colSpan;T++)ad.App.ni.v3.LDa(b.currentNode),b.Qf(1);if(!f)break;ce.moveToNextRow(u);b.Uc(u)}}if(1===c)return f?32:8;if(f){c=new pg.GraphTransaction(7);try{c.Jz(a),Lc.Lr.mergeCells(a,
l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static splitCells(a,b,c){a=new mb.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.wf()||(Lc.fd.kc(be.a.C3,{["Reason"]:Ud.a.JXc}),f=!1),se.isTableCellNode(b.node)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.n6b}),f=!1),f&&1!==c&&U.a.instance.ga(50)&&ad.App.ni.qy&&(b=new mb.GraphIterator,b.Uc(a),ad.App.ni.v3.LDa(b.currentNode)));if(1===c)return f?32:8;if(f){c=new pg.GraphTransaction(7);try{c.Jz(a)}finally{c&&c.dispose()}return 32}return 2}static S9(a,
b,c,f,l){b=b.node;f=!0;Jd.TableReader.kfb(b)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.OSc}),f=!1);Lc.kJ.N4b(b)||(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.PSc}),f=!1);f&&(U.a.instance.ga(14)||U.a.instance.ga(63))&&Lc.Jj.iye(b)&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),f=!1);if(1===c)return f?32:8;if(f){if(U.a.instance.ga(50)&&ad.App.ni.qy)for(c=ll.a.PA(b);c.moveNext();)f=c.currentNode,12===f.type&&ad.App.ni.v3.LDa(f);l=Object(gb.a)(Ft,l);c=new pg.GraphTransaction(7);c.rd(b);f=new mb.GraphIterator;f.set(b);f.wf();
f.Dc();Lc.zi.tFa(f);c.dispose();l&&(l.r$b=!0);da.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,G.a.Fv(a)||"Unknown",U.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!Lc.kJ.N4b(b))return 8;f=new mb.GraphIterator;f.set(b);f.wf();let u=Sk.m(b);u||Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.QZf});u&&!Lc.IEb(f,a)&&(Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.m6b}),u=!1);if(1===c)return u?32:8;if(u){if(U.a.instance.ga(50)&&
!ad.App.ni.amIAlone)for(a=ll.a.PA(b);a.moveNext();)c=a.currentNode,12===c.type&&ad.App.ni.v3.LDa(c);He.a.mark(4937);l=Object(gb.a)(Ft,l);a=new pg.GraphTransaction(7);a.rd(b);Lc.Lr.SUc(f);a.dispose();l&&(l.r$b=!0);He.a.mark(4938);return 32}return 2}static S$a(a,b,c){let f=!1;a=null;b.El&&(a=new mb.GraphIterator,a.set(b.node),(f=Jd.TableReader.Nq(a)&&Jd.TableReader.Kxe(a.currentNode))?a.wf():Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.PZf}));return 1===c?f?32:8:f?(He.a.mark(4939),b=new mb.GraphIterator,b.Uc(a),
ce.moveToCell(b,0,0),jb.OutlineElementNavigator.$e(a),c=new pg.GraphTransaction(7),c.Jz(b),Lc.zi.jFh(a,b),c.dispose(),He.a.mark(4940),32):2}static insertTable(a,b,c,f,l){if(!b.El||!Bc.SelectionEditor.nh(b))return 2;if(U.a.instance.ga(14)&&Lc.Jj.mwa(b))return Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),2;if(Lc.Yr()&&Lc.Yr().instance&&Lc.Yr().instance.rY(b))return 2;var u=new mb.GraphIterator;u.set(b.node);Bc.SelectionEditor.Bu(u);if(we.b(u))return Lc.fd.kc(be.a.Kp,{["Reason"]:Ud.a.y6d}),2;if(1===c)return 32;
c=1;u=2;l&&(c=l.rows,u=l.columns);f.ED=u;f.MO=c;if(Bc.SelectionEditor.nh(b)){f=new pg.GraphTransaction(7);He.a.mark(4927);f.rd(b.node);b.node.eI().graphTransactionOperations.ala(2);const T=new WJ.a;U.a.instance.ga(50)&&ad.App.ni.qy&&ad.App.ni.v3.LDa(b.node);var I=Od.a.yt(b);U.a.instance.ga(49)&&(I.cache.ou&&(I=I.le(null),Lc.Eh.fL(I)),T.formatting=I.en);T.languageId=Od.a.language(I);U.a.instance.ga(71)&&(T.style=Wb.StyleReader.iF(b.node),Lc.eg.k8b(T.style)&&(I=Wb.StyleReader.EM(b.node)))&&(T.style=
I.gI(Wb.StyleReader.dPa));U.a.instance.ga(54)?(I=mb.GraphIterator.ob(b.node),I.uc(11),Lc.KN.o$(I.currentNode)):new dr.a(1,-1);b=Lc.zi.ybk(b);I=l&&l.jpk?Lc.Lr.T4(b,c,u,T):Lc.Lr.T4(b,c,u,T,!0);l&&(l.tableNode=I);jb.OutlineElementNavigator.$e(b);U.a.instance.ga(56)&&T.style&&!ge.OutlineElementReader.rxe(b.currentNode)&&T.style.ra(rb.a.UZ,!1)&&Lc.zi.DNa(b.currentNode,!0);Lc.hs.ISa(b,null,!0,!1,-1);ge.OutlineElementReader.Peb(b)&&Lc.zi.Nfa(b,!1,!0,T);f.dispose();da.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",
a,G.a.Fv(a)||"Unknown",U.a.instance.ga(77),I.id.toString(),c,u));He.a.mark(4928);return 32}return 2}static TAc(a,b,c){if(1===c)return 32;He.a.mark(5748);a=b.node;b=new pg.GraphTransaction(15);b.rd(a);c=!a.ra(rb.a.gpb,!0);a.setValue(rb.a.gpb,c);b.dispose();He.a.mark(5749);return 32}static buc(a,b,c,f,l){a=!b.node.ra(rb.a.gpb,!0);l.setValue(rb.a.gpb,a);return 32}}Lc.KYh="top";Lc.bYk="center";Lc.YIi="bottom";Lc.I2f="__cumulative__";Lc.p6d="__consistent__";Lc.OGd=new Map;Lc.lD=new al.a;Lc.GE=new al.a;
Lc.Rj=null;Lc.yv=null;Lc.JH=null;Lc.Eqf=null;Lc.qG=null;Lc.yn=null;Lc.G6a=null;Lc.VCi=Lc.LOj;Lc.pMd=null;Lc.mMd=null;Lc.nMd=null;Lc.oMd=null;Lc.qMd=null;Lc.tMd=null;Lc.rMd=null;Lc.VOd=null;Lc.kd=null;Lc.Sf=null;Lc.zd=null;Lc.Pp=null;Lc.JPa=null;Lc.qh=null;Lc.ir=null;Lc.tja=null;Lc.EJ=null;Object(m.a)(Lc,"TableActor",null,[]);var YJ=d(313),YR=d(847),ZJ=d(907),ZR=d(414),$R=d(833);class $J{constructor(a,b,c,f){this.XUc=this.VUc=null;this.kzc=a;this.tCd=b;this.ETh=c;this.GTh=f}}Object(m.a)($J,"TableSimplificationInformation",
null,[]);var Mw=d(429),aS=d(558),Zu=d(257),hr=d(219);class Ci{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){this.qh=this.G6a=this.xO=this.lq=null;this.vRd=!1;this.Vji=u;this.JH=I;this.wsb=a;this.EJ=b;this.Wy=c;this.Rj=f;this.ir=l;this.La=T;this.lm=ua;this.KXd=ja.create(2097162);this.m2e(this.KXd);this.Grf=ja.create(2097162);this.m2e(this.Grf);this.iIf=ja.create(2097162);this.m2e(this.iIf);this.W3=this.KXd;this.sWd=Ra;this.QE=eb;this.zd=Bb;this.U0b=Ub;this.Ani=Ub.substr(0,3);this.nsa=Xb}get eg(){return this.qh||
(this.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}get Xs(){return this.lq?this.lq.Xs:0}get Y$a(){return this.lq.kb.Y$a}get Wla(){return this.lq.kb.Wla}get ref(){return this.W3}get x6d(){return this.lq.rI&&!this.vRd}nOh(){this.vRd=!0}get crh(){return!this.lq.rI}get Nca(){return cd.a.instance}get qnk(){return this.La.getBooleanAppSetting("InternalPasteTableWithReplacingCellIsEnabled")&&U.a.instance.ga(63)||U.a.instance.ga(77)}m2e(a){var b=new aS.a(-1);this.Vji.BW.ovb(b);const c=new mb.GraphIterator;
c.set(b);b=this.lm.xe(3);b.Jz(c);c.$l(a,80);b.dispose()}f7d(a,b){b=void 0===b?null:b;a=a.Rb;this.lq=a.Oa.clone();this.vRd=!1;a=mb.GraphIterator.ob(a.tpb);const c=mb.GraphIterator.ob(this.W3),f=this.lm.xe(3);f.Jz(c);a.Gb(82);do a.currentNode.k5a(null);while(a.sk(82));a=new uf.a(b,Object(R.a)(this,this.cUi,"clearInternalClipboard"),new QJ(a,c,this.lq,f));a.Fm("InternalCopy");a.Bj=!b||b.Bj;a.Lh()}cUi(a,b){He.a.mark(5566);b=b.target;if(b.sj())return b.rj(),!0;a.sh(Object(R.a)(this,this.iXc,"executeCopy"));
return!0}iXc(a,b){b=new qB(b,null);b=new uf.a(a,Object(R.a)(this,this.A6b,"coreCopySetup"),b);b.Fm("ExecuteCoreCopyToInternalClipboard");b.Lh();a.sh(Object(R.a)(this,this.Mcm,"trimNewText"));return!0}A6b(a,b){if(!b.source.sj())return b.qg&&(b.qg.DRc=null),da.ULS.shipAssertTag(6305560,307,!1),!1;a.sh(Object(R.a)(this,this.W_f,"coreCopyIteration"));return!0}W_f(a,b){const c=b.insertAfter,f=b.source,l=b.target,u=f.currentNode;var I=this.crh;if(!u.Qwe)return a.sh(Object(R.a)(this,this.hTc,"coreCopyIncrement")),
!0;b.qg.aAd&&(b.aAd=!0);if(!b.aAd&&(u.j9b()&&b.n8.ana.c++,u.j9b()||I&&!u.vEb(this.Xs)))return a.sh(Object(R.a)(this,this.hTc,"coreCopyIncrement")),!0;if(!b.aAd&&I&&!u.Hz)return f.YGa()&&(b.BFd=!0,b=new uf.a(a,Object(R.a)(this,this.A6b,"coreCopySetup"),new qB(b,c)),b.Fm("RecursiveCoreCopyToInternalClipboard"),b.Lh()),a.sh(Object(R.a)(this,this.hTc,"coreCopyIncrement")),!0;I=l.currentNode.Dp().ij;I=Qm.a(u,I,!0);this.Nca.jvc(b.n8.gdb,I);l.IM(I,c,18===f.parentNode.type?1:f.role);l.Cl(I);b.insertAfter=
I;$a.ParagraphReader.ke(I)&&(this.xll(a,Object(R.a)(this,this.A6b,"coreCopySetup"),u,I,b),this.wll(u,I));this.S9f(u,I);f.YGa()&&(da.ULS.shipAssertTag(6305562,307,!b.BFd),b=new uf.a(a,Object(R.a)(this,this.A6b,"coreCopySetup"),new qB(b,null)),b.Fm("RecursiveCoreCopyToInternalClipboard"),b.Lh());a.sh(Object(R.a)(this,this.d1i,"coreCopyIterationPostProcessing"));return!0}d1i(a,b){var c=b.source;const f=b.target;var l=f.currentNode,u=c.currentNode;$a.ParagraphReader.Pl(f)&&(b.PWe[u.id.toString()]=l);
if(U.a.instance.ga(54)&&$a.ParagraphReader.ke(l)){if(0<$a.ParagraphReader.wpg(u))if(0<this.JH.qcb(u).hO)u.setValue(ib.a.msc,0);else{var I=this.JH.cBb(u).hO;Ci.paragraphEditor.Cw.Knb(l,I)}if(!this.oeb&&this.nsa.krd){c.Dc();if(!Jd.TableReader.Ft(f)&&c.dEb&&!this.Wla)for(var T of this.nsa.Ncl)l.removeProperty(T);c.Cl(u)}}if(U.a.instance.ga(57)&&$a.ParagraphReader.ke(l)){I=[];T=[];for(let ja=0;ja<l.wordRunProperties.length;ja++)l.wordRunProperties.f_.$(ja,YJ.CharacterPropertiesEditor.Bha),l.wordRunProperties.Rha.$(ja,
YJ.CharacterPropertiesEditor.Aha),I[ja]=!0,T[ja]=!1;l.He(ib.a.wnd,I);da.ULS.shipAssertTag(6305563,307,I.length===l.wordRunProperties.length);da.ULS.shipAssertTag(6305564,307,U.a.instance.ga(50));da.ULS.shipAssertTag(6305565,307,!!ad.App.ni);U.a.instance.ga(50)&&ad.App.ni.qy&&(l.He(Et.a.Sx,T),da.ULS.shipAssertTag(6305566,307,T.length===l.wordRunProperties.length));(this.zd.Gg&&this.zd.wD||U.a.instance.ga(45)&&ad.App.WE.LTb)&&l.setValue(ib.a.kfc,!0);U.a.instance.ga(14)&&l.Vo(ib.a.fde,ib.a.Dcl,ib.a.Fcl);
U.a.instance.ga(45)&&$a.ParagraphReader.ke(l)&&l.Vo(ib.a.dfb)}this.arh(f)&&(I=f.currentNode.eI(),l=vb.ImageReader.q1c(f.currentNode.properties,I.ij,!1),I=vb.ImageReader.q1c(f.currentNode.properties,I.ij,!0),T=null,Zd.EmbeddedFileReader.U6c(f)&&(T=Zd.EmbeddedFileReader.N_c(f.currentNode)),this.hde(l,u),this.hde(I,u),this.hde(T,u));this.crh&&(this.R9f(f),Jd.TableReader.Nq(f)&&(u=this.lq.KX(),u.moveNext(),(u=se.getCellLocation(c,u.current.node))||(u=new $R.a(0,0)),c=new $J(u,f,Jd.TableReader.Vwj(c),
Jd.TableReader.yKj(c)),this.EJ.NFl(c)));ge.OutlineElementReader.vh(f)&&!f.gK(2)&&(this.Rj.Fea(f),f.Dc());f.Dc();b.qg&&(b.qg.DRc=b.insertAfter);a.sh(Object(R.a)(this,this.hTc,"coreCopyIncrement"));return!0}hTc(a,b){b.BFd&&(b.insertAfter=b.DRc,b.BFd=!1);if(!b.source.VGa()){b.qg&&(b.qg.DRc=b.insertAfter);const c=b.source;11!==c.Zi||c.X0c(-1)||this.Rll(a,c.currentNode,b.target.currentNode,b);return!1}a.sh(Object(R.a)(this,this.W_f,"coreCopyIteration"));return!0}wll(a,b){a=We.f(a);We.f(b);for(b=0;b<a.length;b++)Object(R.a)(this,
this.A6b,"coreCopySetup")}Mcm(a,b){if(b.Yta>=b.wQb.length)return a.sh(Object(R.a)(this,this.c1i,"copyTeardown")),!0;a=b.wQb[b.Yta];var c=a.node,f=a.Ra,l=a.Pb;if(!Bc.SelectionEditor.Vu(a))if(!b.Yta&&Bc.SelectionEditor.Om(a))l=f=$a.ParagraphReader.textLength(c);else if($a.ParagraphReader.jn(a))f=0,l=$a.ParagraphReader.textLength(c);else if(Bc.SelectionEditor.G$(a)){da.ULS.shipAssertTag(6305568,307,!b.Yta);var u=mb.GraphIterator.ob(c);f=u.uc(12);da.ULS.shipAssertTag(6305569,307,f);c=u.origin;l=f=$a.ParagraphReader.textLength(c)}else{if(Bj.OutlineReader.rfc(a))for(a=
$y.a.PA(a.node);a.moveNext();)u=a.currentNode,$a.ParagraphReader.ke(u)&&Array.add(b.wQb,me.a.createTextRange(u,0,$a.ParagraphReader.textLength(u)));b.Yta++;return!0}u=b.PWe[c.id.toString()];da.ULS.shipAssertTag(6305570,307,!!u);if(!u)return da.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Yta,["SelectedContextsLength"]:b.wQb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Yta++,!0;c=We.f(u);let I,T=!1;for(I=c.length-1;0<=I;I--)if(!c[I].ZQc)if(4===
c[I].kr)c[I].Qe.blob=null,c[I].Qe.blob=new Mw.a(c[I].Qe,Mw.a.KUc),b.n8.ana.e++;else{c[I].Qe.blob=null;if(U.a.instance.ga(57)&&-1!==c[I].Cg){var ja=c[I].Qe.formatting,ua=void 0,Ra=void 0;ja&&-1===ja.Cg?(Ra=c[I].Cg+1,ua=c[I].Iba-1,ja.Cg=c[I].Cg):(ua=c[I].Iba,Ra=c[I].Cg);for(ja=0;ja<ua;ja++)u.wordRunProperties.removeAt(Ra,16);0<ua&&(T=!0)}ua="";Zu.f(c[I])?(ua=" ",b.n8.ana.f++):Zu.g(c[I])&&(Ra=Zu.b(c[I]))&&(ua=Zu.a(Ra),b.n8.ana.g++);Ra=c[I].Qe.cp;Ra>=f&&Ra<l&&(Ci.characterPropertiesEditor.replaceTextRange(me.a.createTextRange(u,
Ra,Ra+1),ua),l=l-1+ua.length,b.n8.ana.i++)}T&&u.$v();this.Pzl(u);c=$a.ParagraphReader.textLength(u);l<c&&Ci.characterPropertiesEditor.replaceTextRange(me.a.createTextRange(u,l,c),"");0<f&&Ci.characterPropertiesEditor.replaceTextRange(me.a.createTextRange(u,0,f),"");f=0;l=mb.GraphIterator.ob(u);for(l.Gb(6);!l.ds;)c=l.currentNode,l.sk(6),vb.ImageReader.pI(c)?vb.ImageReader.oxe(c)?(Ci.paragraphEditor.n_f(c,me.a.rk(u,f)),f++,b.n8.ana.d++):(c=mb.GraphIterator.ob(c),c.uc(12),c.rj(),b.n8.ana.h++):da.ULS.shipAssertTag(6305571,
307,!1);!$a.ParagraphReader.textLength(u)&&b.Yta===b.wQb.length-1&&Bc.SelectionEditor.Vu(a)&&(a=mb.GraphIterator.ob(u),a.uc(25)&&(jb.OutlineElementNavigator.$e(a),this.Rj.tFa(a),b.Yta&&(this.lq.kb.Wla=!0)));this.Nca.k2a(b.n8.Rqd,b.n8.F$a,b.n8.YSa,u);b.Yta++;return!0}Pzl(a){const b=U.a.instance.ga(14),c=!this.zd.Gg&&U.a.instance.ga(45),f=Ci.jP,l=a.Sa;if(U.a.instance.ga(57)&&l&&(b||c)){var u=new La.a,I=new La.a;for(let ja=0;ja<l.length;ja++){const ua=l.ga(ja);if(b){ua.fm&&u.add(ua);if(f){if(ua.vi){for(var T=
0;T<ua.vi.length;T++)I.add(ua.vi.ga(T).Cg);ua.vi=null}}else ua.fieldRangeEnd&&(I.add(ua.fieldRangeEnd.Cg),ua.fieldRangeEnd=null),ua.Ap&&(I.add(ua.Ap.Cg),ua.Ap=null);if(ua.Zk){for(T=0;T<ua.Zk.length;T++)I.add(ua.Zk.ga(T).Cg);ua.Zk=null}}if(c){if(ad.App.WE.LTb){ua.formatting&&Ci.Eh.fL(ua.formatting);if(ua.hyperlink){for(T=0;T<ua.hyperlink.Iba;T++)I.add(ua.hyperlink.Cg+T);ua.hyperlink=null}ua.eo=!1}ua.trackedChange=null;ua.rK=!1}}a.RMa(!0,I);for(const ja of u)ja.fm=null;c&&1<l.length&&(a=l.first,a.trackedChange=
new YR.a(a),l.last.rK=!0)}}c1i(a,b){this.W3.k5a(null);b.qTj.dispose();He.a.mark(5567);this.k0k();this.xO=b.n8;this.LJg("Copy");this.Vfk&&da.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get Vfk(){return!mb.GraphIterator.ob(this.W3).sj()}Nlm(){this.W3=this.iIf}Mlm(){this.W3=this.KXd}Clm(){this.W3=this.Grf}eXf(){const a=mb.GraphIterator.ob(this.W3);for(;a.sj();)a.rj()}LJg(a){const b=this.xO.ana.b;a+="-"+b;this.xO.ana.b=a;this.xO.gdb.b=a;this.xO.Rqd.b=a;this.xO.F$a.b=a;this.xO.YSa.b=
a;this.Nca.fBk(this.xO.ana);this.Nca.AAe(this.xO.gdb);this.Nca.xKg(this.xO.Rqd);this.Nca.uAe(this.xO.F$a);this.Nca.sAe(this.xO.YSa);this.xO.ana.b=b;this.xO.gdb.b=b;this.xO.Rqd.b=b;this.xO.F$a.b=b;this.xO.YSa.b=b}vth(a,b,c,f,l,u){l=void 0===l?null:l;u=void 0===u?null:u;this.LJg("Paste");b=mb.GraphIterator.ob(b);const I=mb.GraphIterator.ob(this.W3);var T=null;l&&(T=new Ju.a(Bj.OutlineReader.JUc,Bj.OutlineReader.V3f),T=l.equals(new Ju.a(-1,-1))?new Ju.a(0,0):l.nT(T));if(this.I5c())if(I.sj(),vb.ImageReader.pI(I.currentNode))l=
I.currentNode,I.Dc(),I.IM(this.Rj.b8d(),null,1),I.sj(),I.IM(l,null,2),I.Dc(),I.Cl(l),I.rj(),this.wsb.o5k(),this.nOh();else if(Zd.EmbeddedFileReader.Beb(I.currentNode)){l=I.currentNode;I.Dc();I.IM(this.Rj.b8d(),null,1);I.sj();var ja=this.Rj.Fea(I);ja=me.a.rk(ja,0);Ci.characterPropertiesEditor.replaceTextRange(ja,"<<"+Zd.EmbeddedFileReader.O_c(l)+">>");I.Dc();I.Dc();I.Cl(l);I.rj();this.nOh()}this.qnk&&this.DGg(I,b)?(I.currentNode.k5a(null),da.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),
this.WDl(u,I,b,T,a),da.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(He.a.mark(5564),I.currentNode.k5a(null),a={},a[Ci.j7j]=f,Kc.ListReader.PXa(c)&&this.eg.Xtc&&(a[ZJ.a.Oyg]=!0),c=new rB(I,b,c,T,a),f=new uf.a(u,Object(R.a)(this,this.B6b,"corePasteSetup"),c),f.Fm("ExecuteCorePasteFromInternalClipboard"),f.Bj=!u||u.Bj,this.nll(c),f.Lh())}eGg(a){if(a&&a.isValid){const b=mb.GraphIterator.ob(this.W3);return this.DGg(b,a)}return!1}DGg(a,b){if(se.isTableCellOrInside(b)&&
1===a.bcb()){a.Gb(1);if(ge.OutlineElementReader.vh(a)){jb.OutlineElementNavigator.Ti(a);if(Jd.TableReader.Nq(a)){Jd.TableReader.nu(a.currentNode)&&da.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.uc(14)&&!Jd.TableReader.nu(ce.getContainingTable(b)))return da.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!0;da.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.oeb)return!0}jb.OutlineElementNavigator.$e(a)}a.Dc()}return!1}WDl(a,
b,c,f,l){var u=void 0===u?null:u;c.uc(14);const I=Sk.c(c),T=vo.a(c);c.Ug(14);var ja=Jd.TableReader.fl(c.currentNode);const ua=Jd.TableReader.ej(c.currentNode),Ra=Jd.TableReader.fl(b.currentNode),eb=Jd.TableReader.ej(b.currentNode);da.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",ja,ua,Ra,eb);this.G6a=u?()=>null:Lc.tBb;if(this.Grk(I+Ra,T+eb)){var Bb=I+Ra-ja;0<Bb&&(ce.moveToLastRow(c),da.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+
Bb),this.EJ.wqe(c,!1,Bb,this.G6a),da.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Ug(14));Bb=T+eb-ua;if(0<Bb){da.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Bb);try{this.EJ.iyg(c,ua,!1,Bb,this.G6a)}catch(Ub){throw da.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Ub.toString()),Ub;}da.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}ja=this.Vvj(ja,ua,Ra,eb,I,T);da.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new uf.a(this.oeb?
a:null,Object(R.a)(this,this.Uel,"pasteTableOperationRun"),new SJ(null,b,c,f,I,T,ja,u,l));a.Fm("ExecuteCorePasteTableInTable");a.Bj=!1;a.Lh()}}Grk(a,b){if(!this.HDg)return!0;const c={};a>Ci.FQc&&(c.rowCount=a,c.c_maxTableRowColCount=Ci.FQc);b>Ci.FQc&&(c.columnCount=b,c.c_maxTableRowColCount=Ci.FQc);const f=a*b;f>Ci.rTf&&(c.rowCount=a,c.columnCount=b,c.cellsCount=f,c.c_maxTableCellCount=Ci.rTf);0<hr.a(c).length&&da.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!hr.a(c).length}Uel(a,
b){if(b.dTb){if(b.dTb.f1)return!0;se.isTableCell(b.source)||b.source.Ug(16);this.HDg&&se.isFirstCellInTable(b.source)&&this.g3b(b.Yf,b.target.currentNode);if(se.isLastCellInTable(b.source))return this.m0k(ce.getContainingTable(b.target)),da.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;se.isTableCell(b.target)||b.target.Ug(16);const c=!this.oeb;se.isLastCellInRow(b.source)?(ce.moveToNextRow(b.target),ce.moveToColumnByIndex(b.target,b.qla),da.ULS.sendTraceTag(8716379,307,
50,"Move to next row to replace cell contents")):ce.moveToNextOrPreviousCell(b.target,!1,c);ce.moveToNextOrPreviousCell(b.source,!1,c)}else Jd.TableReader.Nq(b.target)||b.target.Ug(14),Jd.TableReader.Nq(b.source)||b.source.Ug(14),ce.moveToCell(b.target,b.rowIndex,b.qla),ce.moveToCell(b.source,0,0);for(;b.target.sj();)b.target.rj();b.dTb=new uf.a(a,b.Ath?b.Ath:Object(R.a)(this,this.B6b,"corePasteSetup"),new rB(b.source,b.target,null,b.Dqd));b.dTb.Fm("ExecuteCorePasteCellContentInCell");b.dTb.Bj=!1;
b.dTb.Lh();return!0}k0k(){if(this.oeb){for(var a=mb.GraphIterator.ob(this.ref),b=a.currentNode;14!==a.Zi;)if(b=a.sj(),!b){da.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.sjh(b)}}m0k(a){this.oeb&&this.sjh(a)}aam(a){const b=mb.GraphIterator.ob(a);this.Wy.Rdc(b,null,!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}sjh(a){if(a&&14===a.type){da.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b=
{},c=Jd.TableReader.fl(a),f=Jd.TableReader.ej(a),l=mb.GraphIterator.ob(a);ce.forEachCellInTable(l,(u,I,T)=>{const ja={};u=u.currentNode;if(16===u.type)if(u.isGhostCell)Ci.kZf(I,T)in b||(this.aam(u),ja.IsGhostCell="->false");else{U.a.instance.ga(77);Ci.Uul(a,u,I,T,c,(Ra,eb,Bb)=>{ja.rowSpan=String.format("{0}:{1}->{2}",Ra,eb,Bb)});Ci.Tul(a,u,T,I,f,(Ra,eb,Bb)=>{ja.colSpan=String.format("{0}:{1}->{2}",Ra,eb,Bb)});const ua=String.format("{0},{1}-{2},{3}",I,T,I+u.rowSpan,T+u.colSpan);for(let Ra=0;Ra<u.rowSpan;Ra++)for(let eb=
0;eb<u.colSpan;eb++)if(Ra||eb)b[Ci.kZf(I+Ra,T+eb)]=ua}if(0<hr.a(ja).length){if(void 0===ja.IsGhostCell||null===ja.IsGhostCell){if(void 0===ja.rowSpan||null===ja.rowSpan)ja.rowSpan=u.rowSpan;if(void 0===ja.colSpan||null===ja.colSpan)ja.colSpan=u.colSpan}da.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",I,T,ja)}return!0});Ci.Gej(b)}}get HDg(){return U.a.instance.ga(77)}get oeb(){return!!this.La&&this.La.getBooleanAppSetting("ComplexTableCellPasteWithFormattingIsEnabled")}g3b(a,b){a?
(b=mb.GraphIterator.ob(b),b.tC(1)?(b=b.Gb(2))?(b=$d.SelectionFactory.fh(b,0),a.Rb.setSelection(b)):da.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):da.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):da.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}Vvj(a,b,c,f,l,u){const I=[];for(let T=0;T<Math.max(l+c,a);T++){let ja=0,ua=u+f;for(T<l?ja=b:T>=l&&T<Math.min(l+
c,a)?ja=u:T>=l+c&&T<a?ja=b:ua=Math.max(u+f,b);ja<ua;ja++)Array.add(I,Array(2)),I[I.length-1][0]=T,I[I.length-1][1]=ja}return I}B6b(a,b){if(!b.source.sj())return a.sh(Object(R.a)(this,this.y1a,"pasteTeardown")),!0;a.sh(Object(R.a)(this,this.X_f,"corePasteIteration"));return!0}fEl(a,b){if(this.oeb)if(!b||!a)da.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c=
{};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.pob!==a.pob&&(b.pob=a.pob,c.ShouldRenderCell=b.pob);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);hr.a(c)}}X_f(a,b){const c=b.source,f=b.target,l=c.currentNode;
if(!l.Qwe||!l.bxb)return a.sh(Object(R.a)(this,this.jTc,"corePasteIncrement")),!0;if(this.zd.Gg&&ge.OutlineElementReader.vh(c)){if(!jb.OutlineElementNavigator.Ti(c).bxb)return jb.OutlineElementNavigator.$e(c),a.sh(Object(R.a)(this,this.jTc,"corePasteIncrement")),!0;jb.OutlineElementNavigator.$e(c)}da.ULS.shipAssertTag(6305608,307,!l.j9b());var u=f.currentNode.Dp().ij;u=Qm.a(l,u,!0);u.ykb();this.fEl(c,f);f.IM(u,b.insertAfter,c.role);f.Cl(u);b.insertAfter=u;U.a.instance.ga(50)&&ad.App.ni.qy&&ad.App.ni.v3.LDa(u);
this.S9f(l,u);b=new uf.a(a,Object(R.a)(this,this.B6b,"corePasteSetup"),new rB(c,f,null,b.Dqd,b.sM));b.Fm("RecursiveCorePasteOperation");b.Lh();a.sh(Object(R.a)(this,this.h1i,"corePasteIterationPostProcessing"));return!0}Xll(a,b,c){b=We.f(b);c=We.f(c);for(let f=b.length-1;0<=f;f--)b[f].GTe(c[f],a,Object(R.a)(this,this.B6b,"corePasteSetup"))}hde(a,b){a&&(da.ULS.shipAssertTag(6305610,307,a.Qa(Dr.a.Xrc)),a.Qa(Dr.a.Xrc)||a.setValue(Dr.a.Xrc,a.ra(Dr.a.ekh,"")),b=(b=ZR.SectionNavigator.Xng(b))?b.fileId:
ad.App.Ob.ie.x4?ad.App.Ob.ie.x4.fileId:null,!a.Qa(Dr.a.fileId)&&b&&a.setValue(Dr.a.fileId,b))}ide(a){a&&this.wsb.LRl()}h1i(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;$a.ParagraphReader.ke(f)&&(this.Yll(a,Object(R.a)(this,this.B6b,"corePasteSetup"),l,f,b),this.Xll(a,l,f));f.Qkh();b.sM[ZJ.a.Oyg]&&22===f.type&&f.setValue(ib.a.listID,Number.MAX_VALUE);if(U.a.instance.ga(11)&&$a.ParagraphReader.ke(f)){var u=We.j(f,5);if(0<u.length){for(var I of u)!I.properties.Qa(ib.a.zuh)&&I.properties.Qa(ib.a.xuh)&&
I.properties.setValue(ib.a.zuh,I.properties.$a(ib.a.xuh)),vb.ImageReader.lxe(I.properties)||this.wsb.sKl();f.Dp().Fq.forceOutbound(null,null,null)}}U.a.instance.ga(25)&&ge.OutlineElementReader.vh(c)&&this.Rj.dhf(c.currentNode);U.a.instance.ga(10)&&Bj.OutlineReader.Y7c(f)&&(u=rq.b(f),b=b.Dqd,rq.c(f,u.x+b.x,u.y+b.y));if(this.arh(c)){b=c.currentNode.eI();u=vb.ImageReader.q1c(c.currentNode.properties,b.ij,!1);I=vb.ImageReader.q1c(c.currentNode.properties,b.ij,!0);let T=null;Zd.EmbeddedFileReader.U6c(c)&&
(T=Zd.EmbeddedFileReader.N_c(c.currentNode));this.ide(u);this.ide(I);this.ide(T);if(u||I||T)b.zmk=!0,b.Amk=!0}U.a.instance.ga(24)&&Zd.EmbeddedFileReader.U6c(c)&&(b=c.currentNode,Zd.EmbeddedFileReader.Jik(c)?(c.Dc(),u=this.Wy.o5i(),u.setValue(rb.a.xK,Ci.Il.isRtl(b)?11:9),I=rq.b(f),rq.c(u,I.x,I.y),c.IM(u,b,1),c.Cl(b),c.Y5f(),this.Wy.uX(c,!1)):c.rj(),u=this.Rj.Fea(c),u=me.a.rk(u,0),Ci.characterPropertiesEditor.replaceTextRange(u,"<<"+Zd.EmbeddedFileReader.O_c(b)+">>"));this.R9f(c);this.Okm(l,f);c.Dc();
a.sh(Object(R.a)(this,this.jTc,"corePasteIncrement"));return!0}arh(a){return U.a.instance.ga(1)&&vb.ImageReader.Wec(a)||U.a.instance.ga(24)&&Zd.EmbeddedFileReader.U6c(a)}Okm(a,b){if(this.zd.Gg&&Jd.TableReader.kfb(a)){let c=0;const f=Jd.TableReader.fl(a);for(const l of Jd.TableReader.I1c(a,0,f-1))l.hBc&&c++;a=this.lm.xe(4);a.rd(b);b.properties.setValue(rb.a.bBa,f-c);a.dispose()}}jTc(a,b){if(!b.source.VGa())return a.sh(Object(R.a)(this,this.y1a,"pasteTeardown")),!0;a.sh(Object(R.a)(this,this.X_f,"corePasteIteration"));
return!0}y1a(){He.a.mark(5565);return!1}Jnd(){return!mb.GraphIterator.ob(this.W3).sj()}I5c(){return this.x6d?1===mb.GraphIterator.ob(this.W3).bcb():!1}jck(){const a=mb.GraphIterator.ob(this.W3);this.I5c()&&a.sj();return 1===a.bcb()&&(a.sj(),ge.OutlineElementReader.vh(a)&&1===a.bcb()&&a.Gb(2))?$a.ParagraphReader.Pl(a)&&!Ci.kJ.RZf(a):!1}twj(){const a=mb.GraphIterator.ob(this.W3);this.I5c()&&a.sj();a.sj();a.sj();da.ULS.shipAssertTag(6305614,307,$a.ParagraphReader.Pl(a));return $a.ParagraphReader.text(a.currentNode)}Ohg(a){try{return this.Uxj(a)}catch(b){return da.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}Uxj(a){let b=0;if(a&&(b=this.Txj(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.Ohg(a.childNodes[c]),0===b);c++);return b}Txj(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.Ani))return b.startsWith(this.U0b)?this.Xs&&b===this.U0b+this.Xs?3:2:1}return 0}xll(a,b,c,f,l){l.sM||(l.sM={});Ci.Ma.raiseEvent("OnParagraphCopy",new sB(a,b,c,f,l.sM))}Rll(a,
b,c,f){f.sM||(f.sM={});Ci.Ma.raiseEvent("OnCopyComplete",new sB(a,null,b,c,f.sM))}nll(a){a.sM||(a.sM={});Ci.Ma.raiseEvent("BeforePaste",new RJ(a.sM))}Yll(a,b,c,f,l){Ci.Ma.raiseEvent("OnParagraphPaste",new sB(a,b,c,f,l.sM))}R9f(a){se.isTableCell(a)&&(a.Gb(1)||this.Wy.uX(a,!0),a.Dc())}S9f(a,b){this.sWd.isTableCellNode(b)&&(b.width=a.width)}static get Eh(){return Ci.Sf||(Ci.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Ci.Ch||(Ci.Ch=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Ci.hy||
(Ci.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}static get jP(){const a=Tb.a.instance.ub("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get kJ(){return Rl.a.instance}static get Il(){return Iu.PageReader.instance}static Gej(a){const b={};for(const c of hr.a(a)){const f=a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=hr.a(b).length&&da.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static Tul(a,b,c,f,l,u){b.colSpan>l-c&&(u&&u("A",b.colSpan,l-c),
b.colSpan=l-c);a=Ci.i2l(a,b,f,c);b.colSpan!==a&&(u&&u("B",b.colSpan,a),b.colSpan=a)}static Uul(a,b,c,f,l,u){b.rowSpan>l-c&&(u&&u("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Ci.j2l(a,b,c,f);b.rowSpan!==a&&(u&&u("B",b.rowSpan,a),b.rowSpan=a)}static i2l(a,b,c,f){return Ci.xSh(a,b.colSpan,(l,u)=>{ce.moveToCell(l,c,f+u)})}static j2l(a,b,c,f){return Ci.xSh(a,b.rowSpan,(l,u)=>{ce.moveToCell(l,c+u,f)})}static xSh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");
for(let l=1;l<b;l++){var f=mb.GraphIterator.ob(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static kZf(a,b){return a+","+b}}Ci.Ma=new uc.a;Ci.Sf=null;Ci.Ch=null;Ci.hy=null;Ci.FQc=50;Ci.rTf=1225;Ci.j7j="PasteConstrainingWidth";Object(m.a)(Ci,"InternalClipboard",null,[]);class aK extends ik{constructor(a,b,c,f,l,u){super(a,b,c,l);this.ht=f;this.dQd=u}get FXl(){return A.AFrameworkApplication.fa.getBooleanAppSetting("AutoResizeDragDropImageIsEnabled")}get Hh(){return this.dQd.value}get Jnd(){return this.ht.Jnd()}get Sth(){const a=
this.ht;return a.x6d&&!a.I5c()}H$f(a,b){da.ULS.shipAssertTag(6305616,307,Bj.OutlineReader.Wu(a));const c=rq.b(a.currentNode);if(Bj.OutlineReader.isEmpty(a)){var f=me.a.create(a.currentNode);a.eD(8);A.AFrameworkApplication.Pa.Ai(f,G.a.PJ,2,!0,null,null)}else a.eD(8);(f=a.tC(1))&&a.Dc();this.ht.vth(this.qg.Yf,a.currentNode,f,-1,c,b)}get IAg(){return this.ht.jck()}get VZf(){return this.ht.twj()}G$f(a){const b=new mb.GraphIterator;this.Elb.restore(b);da.ULS.shipAssertTag(6305618,307,ge.OutlineElementReader.vh(b));
this.qg.M2&&this.qg.M2.qPc("internal");let c=-1;if(this.RPh&&Object(gc.a)(10,this.qg.Bd))c=this.qg.Bd.ra(Et.a.A8b,-1);else if(this.FXl){const f=this.Nyj(b.currentNode);c=f?f.clientWidth:c}this.ht.vth(this.qg.Yf,b.parentNode,b.currentNode,c,null,a);this.uDg&&(this.Elb.restore(b),ge.OutlineElementReader.vh(b)&&this.ht.eGg(b)&&(a=jb.OutlineElementNavigator.Ti(b)))&&(this.qg.Qua=$d.SelectionFactory.fh(a,0))}Nyj(a){return a?(a=a?a.sc(this.Hh.Na):null)?a.htmlElement:null:null}EQh(){const a=new mb.GraphIterator;
this.Elb.restore(a);return this.ht.eGg(a)}get dQh(){return Kc.ListReader.wy}get cQh(){return!this.ht.Wla&&!this.ht.x6d}}Object(m.a)(aK,"InternalPasteExecutionManager",ik,[]);class bK{constructor(a,b){this.ht=a;this.dQd=b}create(a,b,c){return new aK(a,b,c,this.ht,ad.App.Ob.ie,this.dQd)}}Object(m.a)(bK,"Factory",null,[1822]);var tB;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=
3]="sameBox4AppSameSession"})(tB||(tB={}));Object(m.b)("CopySource",tB);class Gs{constructor(a,b,c){this.ht=a;this.rvf=b;this.Vdi=c}Cel(a,b,c){da.ULS.shipAssertTag(6305620,307,!!a);da.ULS.shipAssertTag(6305621,307,Bc.SelectionEditor.nh(b));da.ULS.shipAssertTag(6305622,307,!!c);da.ULS.shipAssertTag(6305623,307,Object(gc.a)(Qp,c.s7));const f=c.s7;f.NTa=this.ht.Ohg(a);this.eBk(a,f);const l=this.awe(a,b,f);if(l||this.O9e(a,b,f)){var u=new pg.GraphTransaction(7);u.rd(b.node);b.node.eI().graphTransactionOperations.ala(8);
l?(da.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.mq,f.browserName),a=this.rvf.create(b,f,u)):(da.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.mq,f.NTa,f.browserName),Gs.ZAk(a),a=this.Vdi.create(a,b,f,u));c=new uf.a(c,Object(R.a)(a,a.Dth,"pasteSetup"),null);c.Fm("Paste");c.Lh()}else f.Qua=$d.SelectionFactory.Dv(b)}awe(a,b,c){return!this.pEg(c)&&3===c.NTa}O9e(){return!0}pEg(a){return 1===(a.mq&8192?1:0)}Qyg(a,b){da.ULS.shipAssertTag(6305624,
307,Bc.SelectionEditor.nh(a));da.ULS.shipAssertTag(6305625,307,!!b);da.ULS.shipAssertTag(6305626,307,Object(gc.a)(Qp,b.s7));const c=new pg.GraphTransaction(7);c.rd(a.node);a=this.rvf.create(a,b.s7,c);b=new uf.a(b,Object(R.a)(a,a.Dth,"pasteSetup"),null);b.Fm("InternalPasteAtIp");b.Lh()}eBk(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);(c||f)&&da.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",
tB[b.NTa],c,f)}}static ZAk(a){a&&Gs.Dri.test(a.innerText)&&da.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Gs.Dri=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(Gs,"PasteCoordinator",null,[]);class oE{constructor(a,b){this.Kk=a;this.B8=b}}Object(m.a)(oE,"PasteFloatieFeatureSetBuilder",null,[]);class Qo{constructor(a,b){this.QWb=a;this.obi=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get seg(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get BUc(){return CommonUIStrings.l_ClipboardCut}get tQe(){return CommonUIStrings.l_ClipboardCut_Mac}get gTc(){return CommonUIStrings.l_ClipboardCopy}get sQe(){return CommonUIStrings.l_ClipboardCopy_Mac}get $La(){return CommonUIStrings.l_ClipboardPaste}get uQe(){return CommonUIStrings.l_ClipboardPaste_Mac}get O2(){return CommonUIStrings.l_ClipboardPasteText}get vQe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get i5d(){return this.obi}get GXf(){return CommonUIStrings.l_ClipboardExtensionLink}get xTa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}kag(){da.ULS.sendTraceTag(8716421,
307,50,null);Sd.a.qo(this.i5d,"_blank",void 0,"ClipboardAccessExtensionLink")}g3(a,b){let c=E.a.Fl;A.AFrameworkApplication.fa.getBooleanAppSetting("CcpFixIPadShortcutStringsIsEnabled")&&(c=E.a.Aj||c);return c?String.format(b,"\u2318"):a}dispose(){this.QWb=null}y1e(a){this.Q_f(a)}jwk(a){this.Q_f(a)}Q_f(a){this.QWb&&this.QWb(a)}}Qo.id="CopyPasteShortcutDialog";Qo.JXh="CopyPasteText";Object(m.a)(Qo,"ACopyPasteShortcutDialog",null,[106]);class cK extends Qo{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=Qo.JXh;var f=document.createElement("span");f.innerText=this.seg;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.g3(this.BUc,this.tQe);const u=document.createElement("span");u.className="UIFontBold";u.innerText=this.g3(this.gTc,this.sQe);const I=document.createElement("span");I.className="UIFontBold";I.innerText=this.g3(this.$La,this.uQe);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(u);b.appendChild(I);c.getBooleanAppSetting("PasteTextOnlyShortcutDialogIsEnabled")&&(E.a.Fk||E.a.jg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.g3(this.O2,this.vQe),b.appendChild(c));a.appendChild(b);this.i5d?(da.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.GXf,Ae.a.addHandler(b,"click",Object(R.a)(this,this.kag,"extensionLinkHandler")),c.appendChild(b),
l=this.xTa.indexOf("{0}"),-1!==l&&(f=this.xTa.substring(l+3,this.xTa.length),l=document.createTextNode(this.xTa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):da.ULS.sendTraceTag(8716422,307,50,null);c=new Ij.StandardDialog;c.Fd=0;c.Fg=Qo.id;c.Ky(this.titleText,null,0,Object(R.a)(this,this.jwk,"legacyCopyPasteShortcutDialogHandler"),a);c.M7(Qo.JXh)}}Object(m.a)(cK,"CopyPasteShortcutDialog",Qo,[]);class dK extends Qo{constructor(a,
b){super(a,b);b={};a=this.cck;b.extensionStartText=this.bkj;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.LWl;b.cutText=this.g3(this.BUc,this.tQe);b.copyText=this.g3(this.gTc,this.sQe);b.pasteText=this.g3(this.$La,this.uQe);4!==A.AFrameworkApplication.za.mb.Ej&&(b.pasteTextOnly=this.g3(this.O2,this.vQe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new zi.a(!1,!1,!0);c.Fg="CopyPasteInstallDialog";c.Fd=0;c.Te(1,this.bck);c.uAa(1);c.Vj(a,Object(R.a)(this,
this.y1e,"reactCopyPasteShortcutDialogHandler"),b)}get LWl(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get bck(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get cck(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get bkj(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(m.a)(dK,"ReactCopyPasteInstallDialog",Qo,[]);class eK extends Qo{constructor(a){super(a,null);this.zIg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.Y_k;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.h9i;b.copyText=this.T0i;b.pasteText=this.Kel;b.cutShortcutText=this.g3(this.i9i,this.dVk);b.copyShortcutText=this.g3(this.a1i,this.cVk);b.pasteShortcutText=this.g3(this.Qel,this.fVk);b.imageSrc=Kq.a.GO("NoClipboardAccessDialogImage.svg");b.imageAltText=this.cHa;b.primaryButtonLabel=this.RNb;this.zIg&&(da.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.zYa,["onExecute"]:()=>{this.gwk()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new zi.a(!1,!1,!0);c.Fd=0;c.Fg="CopyPasteNoClipboardAccessDialog";c.Vj(a,Object(R.a)(this,this.y1e,"reactCopyPasteShortcutDialogHandler"),b)}get Y_k(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get zYa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get cHa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get RNb(){return CommonUIStrings.l_DialogOk}get h9i(){return CommonUIStrings.l_CutString}get i9i(){return CommonUIStrings.l_CutShortcut}get dVk(){return CommonUIStrings.l_CutShortcut_Mac}get T0i(){return CommonUIStrings.l_CopyString}get a1i(){return CommonUIStrings.l_CopyShortcut}get cVk(){return CommonUIStrings.l_CopyShortcut_Mac}get Kel(){return CommonUIStrings.l_PasteString}get Qel(){return CommonUIStrings.l_PasteShortcut}get fVk(){return CommonUIStrings.l_PasteShortcut_Mac}gwk(){da.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Sd.a.qo(this.zIg,"_blank",void 0,"learnMoreLink")}}Object(m.a)(eK,"ReactCopyPasteNoClipboardAccessDialog",Qo,[]);class fK extends Qo{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.seg;a.cutText=this.g3(this.BUc,this.tQe);a.copyText=this.g3(this.gTc,this.sQe);a.pasteText=this.g3(this.$La,this.uQe);c.getBooleanAppSetting("PasteTextOnlyShortcutDialogIsEnabled")&&(E.a.Fk||E.a.jg)&&(a.pasteTextOnly=this.g3(this.O2,this.vQe));this.i5d?(da.ULS.sendTraceTag(40726914,
307,50,null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.GXf,["onExecute"]:f=>{this.kag(f)}},c=this.xTa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.xTa.substring(0,c),a.suggestionSuffixElement=this.xTa.substring(c+3,this.xTa.length))):da.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:Qo.id,["bodyControls"]:a};a=new zi.a(!1,!1,!0);a.Fd=0;a.Fg=Qo.id;a.Vj(this.titleText,Object(R.a)(this,this.y1e,"reactCopyPasteShortcutDialogHandler"),c)}}Object(m.a)(fK,
"ReactCopyPasteShortcutDialog",Qo,[]);class ir{constructor(){this.tsa=!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.SD}kyb(a,b,c,f){c=void 0===c?!1:c;f=void 0===f?!1:f;da.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.tsa,c));f?new eK(a):this.tsa?c?new dK(a,b):new fK(a,b,A.AFrameworkApplication.fa):new cK(a,b,A.AFrameworkApplication.fa)}static get instance(){return ir.Ja||(ir.Ja=new ir)}}ir.Ja=null;Object(m.a)(ir,"CopyPasteShortcutDialogFactory",
null,[621]);class gK{constructor(a,b,c,f,l,u,I){this.mwf=this.VVd=!1;this.A1b=a;this.$f=b;this.Aka=c;this.Wd=f;this.jd=l;this.Af=u;this.Ed=I}get $N(){return this.A1b}get GHa(){return this.mwf}set GHa(a){this.mwf=a;this.Af.OCb=a}Vea(a){this.$N.Vea(a);a||this.qOa(!0)}E$a(a){this.$N.E$a(a)}get Xhj(){return this.$N.I7}get Ehj(){return this.$N.mz}prepareForPaste(a){this.GHa=!0;this.$N.prepareForPaste(a,!1,this.ydf)}mfa(a,b){this.$N.mfa(a,!1,b)}reset(){this.GHa=!1}paste(){var a=this.$f.$d;a&&this.Wd.Df(a.WJ);
var b=this.Aka.dM;if(!b.xi||!b.editingView.Nm)return null;a=b.editingView;let c=this.jd.hn();this.GHa=!0;b.HBa();b=null;try{a.dkl(),b=c=this.$N.ebb(this.ydf,c)}catch(f){da.ULS.shipAssertTag(6305672,307,!1),this.fcc(!0)}this.GHa=!1;return b}copy(){var a=this.$f.$d;a&&this.Wd.Df(a.WJ);a=this.Aka.dM;if(!a.xi||1!==a.editingView.mode)return!1;this.GHa=!0;let b;try{this.$N.jXc(this.ydf),b=!0}catch(c){da.ULS.shipAssertTag(6305673,307,E.a.jg),da.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",
E.a.nx),b=!1}this.GHa=!1;return b?!0:!1}qOa(a){if(this.VVd)return!0;var b=this.Aka.dM;if(!b.xi||!b.editingView.Nm)return!1;const c=b.editingView;b=this.jd.hn();this.GHa=!0;const f=new Kd.a(b);let l=!1;try{l=this.$N.qOa(b,()=>{c.pUi()},()=>{c.lNa()})}catch(u){da.ULS.shipAssertTag(6305674,307,!E.a.Gk)}f.restore();this.GHa=!1;l?this.VVd=!0:(da.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",E.a.nx),E.a.Gk||this.fcc(a));return l}fcc(){this.VVd=!1;
if(A.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)ir.instance.kyb(null,null);else{const a=new Ij.StandardDialog;a.Fd=0;a.vQ(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get ydf(){const a=this.jd.lva();return a?a.em:null}}Object(m.a)(gK,"SystemClipboard",null,[1812]);class pE{constructor(a){this.xqb=2147483647;this.hWb=null;this.km=0;this.wXg=!0;this.pAf=window.navigator.clipboard;this.qAf=window.navigator.permissions;this.UT=a}getData(a,
b){da.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.hWb){var c=this.uwj(this.hWb,a);c?this.hWb[0].getType(c).then(f=>{"image/png"===c?this.UT.s6b([f],l=>{this.NUe(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.Voj(l):l;da.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.HY(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.HY(!1,"getDataFailed");b(a,null)}):(this.HY(!1,"unSupportedType"),b(a,null))}else this.HY(!1,
"invalidClipboardItems"),b(a,null)}catch(f){this.HY(!1,"getDataFailed"),b(a,null)}}uwj(a,b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}NUe(a,b,c){a&&this.UT.xyc&&(a=String.format('<img src="{0}">',a));da.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",
a)}Voj(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}hgf(a,b,c){this.hWb=b;a(c)}fEd(a){try{this.hWb=null,this.pAf.read().then(b=>{let c;this.km&&(c=Date.now()-this.km,da.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.HY(!0,"none");this.hgf(a,b,!0)},()=>{this.HY(!1,"clipboardReadFailed");this.hgf(a,null,!1)}).catch(()=>{this.HY(!1,"clipboardReadFailed");
this.hgf(a,null,!1)})}catch(b){this.HY(!1,"clipboardReadNotSupported"),a(!1)}}pWf(a,b){this.wXg=a?!0:!1;if(this.pAf)if(this.qAf)try{this.qAf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.km=Date.now(),this.fEd(b)):"prompt"===c&&a?this.fEd(b):(this.HY(!1,"permissionDenied"),b(!1))):(this.HY(!1,"invalidPermissionStatus"),b(!1))},()=>{this.HY(!1,"permissionQueryFailed");a?this.fEd(b):b(!1)}).catch(()=>{this.HY(!1,"permissionQueryFailed");b(!1)})}catch(c){this.HY(!1,"permissionQueryNotSupported"),
b(!1)}else this.HY(!1,"navigatorPermissionNotSupported"),a&&this.fEd(b);else this.HY(!1,"navigatorClipboardNotSupported"),b(!1)}HY(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.wXg;"none"!==b&&(c.AsyncAPIFailureReason=b);da.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(m.a)(pE,"AsyncClipboardAPI",null,[]);class uB{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(m.a)(uB,"ExtensionClipboardData",
null,[]);class hK{constructor(a,b,c,f){this.k4=this.NA=this.oyf=this.Wra=null;this.cEc=a.getBooleanAppSetting("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.getBooleanAppSetting("ChromeClipboardAccessRichFormatContentIsEnabled");a.getBooleanAppSetting("ChromeSingleTextRunCopyImprovementIsEnabled");this.ffi=a.Ea("ChromeClipboardAccessExtensionLink");this.dQa=b;this.Kk=c;this.$ji=a.Ea("ChromeClipboardAccessExtensionId");this.UT=f;this.R3=new pE(this.UT);this.wXb=null;this.Dvf=l=>!!l.tagName&&
"a"===l.tagName.toLowerCase()}Vea(a){a?this.NA=!0:(this.k4=this.NA=null,chrome.runtime&&chrome.runtime.sendMessage?(this.wXb=this.dQa.R_c(),this.dQa.BAa?this.eWf(!0,null):(this.NA=!0,da.ULS.sendTraceTag(19256732,307,50,Ua.a.create().toString()))):this.R3?this.vxb(!0,null):(this.iYe(),this.NA=!1))}E$a(a){this.k4=this.NA=null;chrome.runtime&&chrome.runtime.sendMessage?(this.wXb=this.dQa.R_c(),this.dQa.BAa?this.eWf(!1,a):(this.NA=!0,da.ULS.sendTraceTag(19256732,307,50,Ua.a.create().toString()),a(this.I7))):
this.R3?this.vxb(!1,a):(this.NA=!1,a(this.I7))}get I7(){return this.NA}get mz(){return this.k4}qOa(){return!0}jXc(a){da.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");Sd.a.dbb(a,"copy")||da.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}ebb(a,b){this.Wra&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Wra,b=a.body,this.Wra=null);return b}Syj(a){var b=this.Kk.Qng(a.html);
if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}fig(a){const b=Ua.a.create();this.oyf=b;this.dQa.BAa?da.ULS.sendTraceTag(7377737,307,50,b.toString()):da.ULS.sendTraceTag(19256735,307,50,b.toString());const c={command:"getClipboardData"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.wXb,c,f=>{b.equals(this.oyf)?this.Wra=this.Syj(f):da.ULS.sendTraceTag(7385868,307,50,null);da.ULS.sendTraceTag(7377738,307,50,b.toString());
chrome.runtime.lastError&&(this.Bej(),this.dQa.BAa?da.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):da.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));a(f)}):(da.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},f=(l,u)=>{this.Wra=u;a(!0)};null!=this.mz&&this.mz?this.R3.getData(b?"image/png":null,f):this.fig(c)}mfa(a,b,c){a=(f,l)=>{const u=new uB;"image/png"==f?u.img=l:u.html=l;
c(u)};null!=this.mz&&this.mz?this.R3.getData(b?"image/png":null,a):this.fig(c)}iYe(){da.ULS.sendTraceTag(8716423,307,50,null);ir.instance.kyb(Object(R.a)(this,this.Hhl,"popupInstallDialogHandler"),this.cEc?this.ffi+this.wXb:null)}Hhl(a){1===a?da.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.cEc)):0===a&&da.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.cEc))}Ehl(){da.ULS.sendTraceTag(509666773,307,50,null);ir.instance.kyb(Object(R.a)(this,this.Fhl,
"popupClipboardAccessDialogHandler"),null,!1,!0)}Fhl(){da.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",this.cEc))}Bej(){this.dQa.E4e();this.iYe()}LKh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(da.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}vxb(a,b){da.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.R3.pWf(a,c=>{this.k4=
c;this.NA=this.mz;a&&this.P_l();b&&b(this.I7)})}P_l(){null==this.mz||this.mz||this.Ehl()}eWf(a,b){const c=Ua.a.create();da.ULS.sendTraceTag(7726105,307,50,c.toString());this.LKh(this.wXb,f=>{da.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.NA=!0:(f?"ping"!==f&&da.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):da.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.R3?this.vxb(a,b):(a&&this.iYe(),this.NA=!1));b&&b(this.I7)})}gKg(a,b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;da.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}eAk(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.dQa.BAa;this.LKh(this.$ji,b=>{this.gKg(a,!!b)})}else this.gKg(!1,!1)}}Object(m.a)(hK,"ChromeSystemClipboardAccessManager",null,[1811]);class iK{constructor(a,
b,c,f){this.k4=this.NA=this.kMc=this.Wra=this.R3=null;this.Ed=a;this.La=b;this.tof=!this.La.getBooleanAppSetting("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.La.getBooleanAppSetting("BlockCopyCutOnFirefoxIsEnabled");this.UT=c;this.Kk=f;this.HQd=b.tc("ClipboardDataImageBlobLimitaton",10);E.a.Icf||(this.R3=new pE(this.UT))}Vea(a){this.tof&&a&&this.Ed.jg?(ir.instance.kyb(null,null),this.NA=!1):(this.NA=!0,this.k4=!1,this.R3&&(this.k4=this.NA=null,this.vxb(!0,null)))}E$a(a){this.tof&&this.Ed.jg&&
(this.NA=!1,a(this.I7));this.NA=!0;this.k4=!1;this.R3?(this.k4=this.NA=null,this.vxb(!1,a)):a(this.I7)}vxb(a,b){da.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");this.R3.pWf(a,c=>{this.k4=c;this.NA=this.mz;a&&this.l_l();b&&b(this.I7)})}l_l(){null==this.mz||this.mz||this.Dhl()}Dhl(){ir.instance.kyb(null,null)}get I7(){return this.NA}get mz(){return this.k4}jXc(a){Sd.a.dbb(a,"copy")}ebb(a,b){if(this.Wra&&null!=this.mz&&this.mz)return a=document.implementation.createHTMLDocument("doc"),
a.body.innerHTML=this.Wra,b=a.body,this.Wra=null,b;const c=Date.now(),f=Sd.a.dbb(a,"paste");b&&""===b.innerHTML&&(this.qwj(a),b.innerHTML=this.kMc?this.kMc:"",this.kMc="");da.ULS.sendTraceTag(512356673,307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}qwj(a){const b=c=>{if(c){c=c.clipboardData;const f=this.Kk.pac(c);this.kMc=f&&""!==f?f:this.Kk.Eje(c)}};window.addEventListener("paste",b,!1);Sd.a.dbb(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,
b){const c=(f,l)=>{this.Wra=l;a(!0)};null!=this.mz&&this.mz?this.R3.getData(b?"image/png":null,c):a(!1)}mfa(a,b,c){if(c){var f=(l,u)=>{const I=new uB;"image/png"==l?I.img=u:I.html=u;c(I)};null!=this.mz&&this.mz?this.R3.getData(null,f):E.a.Icf&&this.rwj(a,b,c)}else da.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}rwj(a,b,c){da.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;za.a.qw(a.body);try{const f=l=>{const u=new uB;
l=l.clipboardData;if(b)(l=this.Kk.ZDd(l,this.HQd,this.UT.Apc).ndc)&&0<l.length&&(u.isImageAvailable=!0);else{var I=this.Kk.getData(l,"ppt/slides");u.pptSlide=I;I&&""!==I||(l=(I=this.Kk.pac(l))&&""!==I?I:this.Kk.Eje(l),u.html=l)}c(u)};a.addEventListener("paste",f,!1);Sd.a.dbb(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){da.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}qOa(a,b,c){if(this.Ed.gV&&!this.La.getBooleanAppSetting("ElectronClipboardAccessFix"))return this.NA=
!1;b();c();a=this.ebb(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=kh.a.create().toString();c();a=this.ebb(a.ownerDocument,a);a=b===a.innerHTML;this.R3?a&&(this.NA=!0):this.NA=a;return a}}Object(m.a)(iK,"DefaultSystemClipboardAccessManager",null,[1811]);class jK{constructor(a,b,c,f){this.k4=this.NA=this.cX=this.wtb=this.e9=this.RCa=this.fEc=null;this.Kk=b;this.UT=c;this.HQd=a.tc("ClipboardDataImageBlobLimitaton",10);this.Fgi=a.getBooleanAppSetting("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");
this.odi=f;this.coi=a.getBooleanAppSetting("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Vea(a){this.coi&&a&&(this.NA=!0);this.k4=!1}E$a(a){a(!0)}get I7(){return this.NA}get mz(){return this.k4}jXc(a){a&&Sd.a.dbb(a,la.a.copy)}ebb(a,b){this.RCa&&(b=this.RCa,this.RCa=null);return b}mfa(a,b,c){c?c(null):da.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c){c=void 0===c?null:c;if(a&&c){this.fEc=a;this.wtb=c;$addHandler(this.wtb,la.a.paste,Object(R.a)(this,this.zoh,
"onPasteEvent"));this.cX=this.e9=null;this.Fgi&&this.odi.c9b();if(this.gEd(this.wtb)){if(this.cX&&0<this.cX.length&&(!this.e9||this.Kk.CFd(this.e9))){this.UT.s6b(this.cX,Object(R.a)(this,this.NUe,"onImageConverted"));this.RCa&&!this.RCa.hasChildNodes()&&da.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.e9&&this.e9.innerHTML&&((this.RCa=this.dwg(this.e9.innerHTML))&&!this.RCa.hasChildNodes()&&da.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),
za.a.qw(this.e9))}this.Lcg()}else a&&a(!1)}qOa(a){return this.NA=a=this.gEd(a.ownerDocument)}zoh(a){try{a&&a.rawEvent&&((this.e9=a.rawEvent.target)&&this.e9.id&&-1<this.e9.id.indexOf("Paste")?(da.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.e9.id),this.e9=null):this.cX=this.RCj(a.rawEvent))}catch(b){da.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}NUe(a){a&&(this.UT.xyc&&(a=String.format('<img src="{0}">',
a)),this.RCa=this.dwg(a));this.Lcg()}Lcg(){this.wtb&&($removeHandler(this.wtb,la.a.paste,Object(R.a)(this,this.zoh,"onPasteEvent")),this.wtb=null);this.fEc&&(this.fEc(!1),this.fEc=null)}RCj(a){let b=null;(a=this.Kk.tge(a))&&({ndc:b}=this.Kk.ZDd(a,this.HQd,this.UT.Apc));return b}gEd(a){return Sd.a.dbb(a,la.a.paste)}dwg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(m.a)(jK,"EdgeSystemClipboardAccessManager",null,[1811]);class kK{constructor(a,
b,c,f){this.La=a;this.kbi=b;this.Kk=c;this.Ed=f}create(){var a=null;a=this.Ed.gV&&this.La.getBooleanAppSetting("ElectronClipboardAccessFix"),A.AFrameworkApplication.uAd()&&this.Ed.Fk&&window.chrome&&!a?(da.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),a=new hK(this.La,this.kbi,this.Kk,Tb.a.instance.resolve("Box4.IProcessImageStrategy")),this.La.getBooleanAppSetting("LogChromeExtensionInstallationStatusIsEnabled")&&a.eAk()):this.La.getBooleanAppSetting("EdgeContextMenuPasteFixIsEnabled")&&
this.Ed.gp?(da.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new jK(this.La,Tb.a.instance.resolve("Box4.IClipboardDataHelper"),Tb.a.instance.resolve("Box4.IProcessImageStrategy"),Tb.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(da.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),a=new iK(this.Ed,this.La,Tb.a.instance.resolve("Box4.IProcessImageStrategy"),this.Kk));return a}}Object(m.a)(kK,"SystemClipboardAccessManagerFactory",
null,[1810]);class lK{t$f(a){return a}}Object(m.a)(lK,"DeleteTableSegmentStrategy",null,[1759]);var bS=d(1276),cS=d(651);class jr{constructor(a,b){this.Kl=new W.DictionaryPropertySet;this.oOd=!1;this.wka=this.jka=this.$5a=null;this.aX=a;this.yei=b}get x4a(){return this.wka||(this.wka=Tb.a.instance.ub("Box4.ITextFormattingCommands"))}get Eh(){return jr.Sf||(jr.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}H2a(){this.oOd||(this.Kl.J2e(),this.$5a=null,this.yzl())}$0i(a){a=Od.a.yt(a);if(!a.cache.ou){var b=
a.RA;if(b){var c=new W.DictionaryPropertySet;c.fz(b);c.fz(this.Kl);c.Qa(ye.a.D0)&&(this.$5a=a.paragraph.Zh);this.Kl=c}}}Qa(a){return this.Kl.Qa(a)}Jne(){return 0<this.Kl.U3}get keb(){return this.Kl}freeze(){this.oOd=!0}qef(){this.oOd=!1}bK(a,b){return this.keb.ra(a,b)}$q(a){this.Kl.setValue(rb.a.fontSize,this.Eh.i6b(a));this.gT()}fontSize(){return this.Kl.ra(rb.a.fontSize,yf.Font.OJ)}Hyd(a){this.Kl.setValue(rb.a.font,a);this.yei.Hyd(this.Kl,a);this.aX&&this.aX.enabled&&(Qf.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),
this.aX.FDm(this.Kl,a));this.gT()}HNa(a){this.Kl.setValue(ib.a.EW,a);this.aX&&this.aX.enabled&&(Qf.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.aX.JDm(this.Kl,a));this.gT()}Jr(a){a=cS.a.instance.F5d(Me.a.instance.Oa.kb.Ua.node,a);this.Kl.setValue(rb.a.fontColor,a);this.gT()}FX(){this.Kl.setValue(rb.a.fontColor,Vb.a.auto);this.gT()}fontColor(){return this.Kl.ra(rb.a.fontColor,Vb.a.nil)}Pqa(a){this.Kl.setValue(rb.a.highlight,parseInt(a,16));this.gT()}y5b(){this.Kl.setValue(rb.a.highlight,
Vb.a.auto);this.gT()}isBold(){return this.Kl.ra(rb.a.bold,!1)}fJ(a){this.Kl.setValue(rb.a.bold,a);this.gT()}isItalic(){return this.Kl.ra(rb.a.italic,!1)}setItalic(a){this.Kl.setValue(rb.a.italic,a);this.gT()}VD(){return this.Kl.ra(rb.a.underline,!1)}n_(a){this.Kl.setValue(rb.a.underline,a);this.Kl.setValue(rb.a.Yw,a?yf.Font.zEd:yf.Font.JW);this.gT()}Yw(){return this.Kl.ra(rb.a.Yw,yf.Font.JW)}Wqa(a){a<yf.Font.zEd||a>yf.Font.JW||(this.Kl.setValue(rb.a.underline,a!==yf.Font.JW),this.Kl.setValue(rb.a.Yw,
a),this.gT())}isSuperscript(){return this.Kl.ra(rb.a.superscript,!1)}m_(a){this.Kl.setValue(rb.a.superscript,a);a&&this.isSuperscript()&&this.Kl.setValue(rb.a.subscript,!1);this.gT()}nF(){return this.Kl.ra(rb.a.subscript,!1)}O7(a){this.Kl.setValue(rb.a.subscript,a);a&&this.nF()&&this.Kl.setValue(rb.a.superscript,!1);this.gT()}zC(){return this.Kl.ra(rb.a.strikethrough,!1)}l_(a){this.Kl.setValue(rb.a.strikethrough,a);this.gT()}qY(){return this.Kl.ra(ye.a.hu,!1)}Inb(a){this.Kl.setValue(ye.a.hu,a);this.gT()}bhg(){return this.Kl.ra(ye.a.D0,
null)}via(a,b){this.Kl.J2e();this.Kl.setValue(ye.a.D0,a.id);this.$5a=b.Zh;this.gT()}tW(a){let b=rb.a.pu;if(U.a.instance.ga(13)){const c=bS.a.$gc(a);switch(c){case 1:b=ib.a.qFb;break;case 2:b=ib.a.rFb}this.Kl.setValue(ib.a.languageHint,c)}this.Kl.setValue(b,a);this.gT()}language(){let a=rb.a.pu;if(U.a.instance.ga(13))switch(this.Kl.ra(ib.a.languageHint,0)){case 1:a=ib.a.qFb;break;case 2:a=ib.a.rFb}return this.Kl.ra(a,0)}NRl(a){this.Kl.setValue(jr.xSe,a);this.gT()}WXa(){return this.Kl.ra(jr.xSe,!1)}hmk(){return this.Kl.Qa(jr.xSe)}Rkk(){return U.a.instance.ga(13)?
this.Kl.Qa(rb.a.pu)||this.Kl.Qa(ib.a.qFb)||this.Kl.Qa(ib.a.rFb):this.Kl.Qa(rb.a.pu)}gT(){if(E.a.VSb){var a=Me.a.instance.Oa.kb.Ua,b=a.node;if(b===this.jka)this.jka.Dw(16,!0);else{this.jka=b;b=this.jka.p4a();try{this.jka.Dzb(a.Ra).Q5=!0}finally{b&&b.dispose()}}}}yzl(){if(E.a.VSb&&this.jka){var a=0,b=this.jka.p4a();try{for(let c=this.jka.Sa.length-1;0<=c;c--){const f=this.jka.Sa.ga(c);f.Q5&&(f.Q5=!1,a++,f.isEmpty&&this.jka.Sa.removeAt(c))}}finally{b&&b.dispose()}this.jka=null}}D_i(a){if(a.Ra!==a.Pb)return!1;
a=a.node.Sa.TU(a.Ra);return!!a&&a.Q5}xEi(a){if(this.x4a){this.freeze();var b=new pg.GraphTransaction(7);b.rd(a.node);this.x4a.bRb(a);this.qef();this.H2a();b.dispose()}}bbc(a){const b=$a.ParagraphReader.text(a.node);return a.Ra&&a.Ra!==b.length&&!Aa.a.fA(b.charCodeAt(a.Ra))&&as.a.instance.d0c(b,a.Ra-1)!==a.Ra&&Bc.SelectionEditor.QEb(a)?(a=Bc.SelectionEditor.VUa(a,!1))?1<a.length||Bc.SelectionEditor.Tk(a.Ua)?a:null:null:null}static get xSe(){return U.a.instance.ga(20)?ib.a.noProof:Oe.a.Rya}}jr.Sf=null;
Object(m.a)(jr,"InsertionPointFormatting",null,[1748]);class mK{constructor(a){this.Ca=a}get zn(){return this.Ca}ZLi(a){return 32===this.zn.Ia(G.a.qL,2,a)}numbering(a){return 32===this.zn.Ia(G.a.aO,2,a)}}Object(m.a)(mK,"ListCommands",null,[1823]);class qE{constructor(a){this.Bf=a}D$a(a){a=Object(gb.a)(fE.a,a);return!!a&&!!a.view&&a.view.xi}dxh(){return!0}NZe(){return!0}exh(){}LTh(a){if(a.ds)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}cJj(a){if(!a||!this.Bf)return a;const b=new ko.a;
b.set(a);if(this.Bf.Bu(b)){for(;!b.ds;)b.Dc();return b.currentNode}return a}}Object(m.a)(qE,"SimpleProofingWholeDocumentCallBacks",null,[1851]);class nK{constructor(a){this.value=a}}Object(m.a)(nK,"RefBool",null,[]);class vB{constructor(){this.aXc=this.HLb=null;this.M0h=new nK(!1)}}Object(m.a)(vB,"FindNextErrorOperationParam",null,[]);class oK extends qE{constructor(a,b){super(b);this.xn=a}dxh(a,b){return!this.mAe(a.node,a.Ra,b)}NZe(a,b){return!this.mAe(a,0,b)}exh(a,b){this.mAe(a.node,0,b);Object(gb.a)(vB,
b)}mAe(a,b,c){c=Object(gb.a)(vB,c);if($a.ParagraphReader.ke(a)&&!a.nY)if(Od.a.yt(me.a.rk(a,b)).cache.WXa)c.M0h.value=!0;else{const f=A.AFrameworkApplication.fa.getBooleanAppSetting("SkipIgnoredProofingErrorsFromRibbon"),l=this.xn.KG(a);for(let u=0;u<l.length;u++){const I=l[u],T=f&&I.Rh.Tve();if(I.begin>=b&&!T)return c.HLb=I,c.aXc=a,!0}}return!1}}Object(m.a)(oK,"FindNextErrorCallbackSteps",qE,[]);class pK extends Dt.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){super();this.Dtb=this.wj=this.hCa=null;this.init(a);
this.Fm(Ra);this.eHa(T,b,f,l,u);this.yH=u;this.ew=c;this.Vc=ja;this.Bf=ua;this.Jsa=I;this.AJ=0}Lh(){this.D$a();0===this.AJ&&this.l9e();1===this.AJ&&this.XZe();2===this.AJ&&this.Edf();3===this.AJ&&this.$de()}D$a(){this.Vc.Oa&&this.Vc.Oa.kb?1===this.behavior&&(this.Jsa.D$a(this.ew)?this.Op=32:this.Op=2,this.AJ=3):(da.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.Op=2,this.AJ=3)}l9e(){this.iLi();this.EKi();this.AJ=1}XZe(){this.ox||new uf.a(this,Object(R.a)(this,this.yll,"processCurrentNodeAtBegin"),
this.yH);do if(this.ox.Lh(),this.ox.f1&&!this.Bj)return;while(this.ox.f1);this.JRc();this.AJ=2}Edf(){this.Op=32;this.AJ=3}$de(){this.i_()}yll(a,b){b=this.Jsa.dxh(this.hCa,b);a.sh(Object(R.a)(this,this.trj,"fromHereToEnd"));return b}trj(a,b){if(this.wj.moveNext())return a=this.wj.currentNode,12!==a.type||a===this.hCa.node?!0:this.Jsa.NZe(a,b);this.ELi();a.sh(Object(R.a)(this,this.Drj,"fromStartToHere"));return!0}Drj(a,b){if(this.wj.moveNext()){const c=this.wj.currentNode;return 12!==c.type?!0:c===
this.hCa.node?(a.sh(Object(R.a)(this,this.zll,"processCurrentNodeAtEnd")),!0):this.Jsa.NZe(c,b)}return!1}zll(a,b){this.Jsa.exh(this.hCa,b);return!1}iLi(){let a=this.Vc.Oa.kb;if(a=this.Bf.Km(a,!0,!1))this.hCa=a.Ua;this.hCa&&this.hCa.node&&(this.Dtb=this.Jsa.cJj(this.hCa.node))}EKi(){if(!this.Dtb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new ko.a;a.set(this.hCa.node);a.uc(this.Dtb.type);this.wj=$y.a.S4(a,this.Dtb);this.wj.Um(Object(R.a)(this.Jsa,this.Jsa.LTh,"spellErrorFilter"),
null)}ELi(){if(!this.Dtb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new ko.a;a.set(this.Dtb);this.wj=$y.a.rw(a);this.wj.Um(Object(R.a)(this.Jsa,this.Jsa.LTh,"spellErrorFilter"),null)}}Object(m.a)(pK,"ProofingWholeDocumentOperation",Dt.a,[]);class rE{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){this.Ca=b;this.xn=a;this.dii=c;this.Ch=f;this.lm=l;this.Vc=u;this.yn=I;this.Bf=T;this.u8a=ja;this.NE=ua;this.yd=Ra;this.DHc=Bb.axe;this.WCf=Ub;this.EQ=Xb;this.cDc=new id.a;this.cDc.$(1,
G.a.MTh);this.cDc.$(2,G.a.xrg);this.cDc.$(3,G.a.dVh);this.zKc=new id.a;this.zKc.$(1,G.a.NTh);this.zKc.$(2,G.a.yrg);this.zKc.$(3,G.a.eVh)}qb(){const a=this.Ca,b=Object(R.a)(this,this.j1i,"correctError"),c=Object(R.a)(this,this.QVi,"collapseIp");a.pa(G.a.bbl,ta.a.view,Object(R.a)(this,this.cbl,"openLanguageDialogView"),1028);a.xa(G.a.pFa,ta.a.Xf,Object(R.a)(this,this.pFa,"deleteRepeatedWord"));a.xa(G.a.Sma,ta.a.Xf,Object(R.a)(this,this.Sma,"ignoreSpellingError"));a.xa(G.a.dBa,ta.a.Xf,b);a.xa(G.a.eBa,
ta.a.Xf,b);a.xa(G.a.fBa,ta.a.Xf,b);a.xa(G.a.lOa,ta.a.Xf,b);a.xa(G.a.mOa,ta.a.Xf,b);a.xa(G.a.pFa,ta.a.view,c);a.xa(G.a.Sma,ta.a.view,c);a.xa(G.a.dBa,ta.a.view,c);a.xa(G.a.eBa,ta.a.view,c);a.xa(G.a.fBa,ta.a.view,c);a.xa(G.a.lOa,ta.a.view,c);a.xa(G.a.mOa,ta.a.view,c);a.pe(G.a.pFa,1028);a.pe(G.a.Sma,1028);a.pe(G.a.dBa,1028);a.pe(G.a.eBa,1028);a.pe(G.a.fBa,1028);a.pe(G.a.lOa,1028);a.pe(G.a.mOa,1028);a.xa(G.a.yCd,Le.a.frame,ff.ActionManager.uh);this.DHc&&a.pa(G.a.fYe,ta.a.view,Object(R.a)(this,this.fYe,
"populateProofingSecondaryMenu"),1124);A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasIsEnabled")&&A.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")||a.pa(G.a.ynd,ta.a.view,Object(R.a)(this,this.Knj,"findNextProofingError"),1028);this.$wl([G.a.o4l,G.a.MTh,G.a.NTh,G.a.jTj,G.a.xrg,G.a.yrg,G.a.y6l,G.a.dVh,G.a.eVh])}$wl(a){for(let b=0;b<a.length;b++)this.Ca.pa(a[b],ta.a.view,ff.ActionManager.vw,1028)}QVi(a,b,c,f,l){b=this.Vc.Oa.kb;if(!b)return this.yd.kc(be.a.ei,
{["Reason"]:Ud.a.fQ}),2;b=this.Bf.Km(b,!0,!1);return this.Ca.Ai(b.Ua,a,c,!1,f,l)}cbl(a,b,c){if(1===c)return this.Ca.nb(G.a.tW,1);this.dii().Syc();return 32}bgf(a){return a?a.Rh?!1:(da.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.yd.kc(be.a.rbb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),He.a.mark(4671),!0):(da.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.yd.kc(be.a.rbb,{["Reason"]:"RequestedErrorRangeNotFound"}),
He.a.mark(4671),!0)}pFa(a,b,c){if(1===c)return 32;He.a.mark(4670);c=this.xn.NVa(b);if(this.bgf(c))return 8;b=b.node;const f=this.lm.xe(15);let l=c.begin;" "===$a.ParagraphReader.text(b).charAt(l-1)&&l--;f.rd(b);const u=this.Ch.replaceTextRange(me.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Vc.setSelection($d.SelectionFactory.fh(b,u+l));f.dispose();c.Rh.DOa(a);He.a.mark(4671);return 32}mDk(a){let b;(()=>{let c=this.zKc.Eg(a.Rh.proofingType,0);({value:b}=c);return c})().returnValue&&
this.Ca.nb(b,2)}Sma(a,b,c){if(1===c)return 32;da.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");He.a.mark(4670);c=this.xn.NVa(b);if(this.bgf(c))return 8;b=b.node;const f=this.lm.xe(15);f.rd(b);this.xn.TMa(b,[c],!0);b.setValue(rb.a.MZf,!0);f.dispose();c.Rh.DOa(a,1);He.a.mark(4671);da.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.mDk(c);return 32}Yxj(a){switch(a){case G.a.dBa:return 0;case G.a.eBa:return 1;case G.a.fBa:return 2;case G.a.lOa:return 3;
case G.a.mOa:return 4;default:return-1}}Lyk(a){let b;(()=>{let c=this.cDc.Eg(a.Rh.proofingType,0);({value:b}=c);return c})().returnValue&&this.Ca.nb(b,2)}j1i(a,b,c){var f=!0;this.EQ.ga(14)&&(f=!this.NE.mwa(b));this.yn&&this.yn.instance&&this.yn.instance.rY(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.nb(G.a.yCd,2);He.a.mark(4670);f=this.Yxj(a);if(0>f)return 8;c=this.xn.NVa(b);if(this.bgf(c))return 8;b=b.node;var l=c.Rh.suggestions;if(!l)return this.yd.kc(be.a.rbb,{["Reason"]:"NoSuggestionsFound"}),
He.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.yd.kc(be.a.rbb,{["Reason"]:"RequestedSuggestionIsNull"}),He.a.mark(4671),8;this.EQ.ga(50)&&ad.App.ni.qy&&ad.App.ni.v3.LDa(b);f=f.replace("  "," \u00a0");l=this.lm.xe(15);l.rd(b);const u=this.Ch.replaceTextRange(me.a.createTextRange(b,c.begin,c.end),f,!0,!1,G.a.yCd);this.Vc.setSelection($d.SelectionFactory.fh(b,c.begin+f.length+u));l.dispose();c.Rh.DOa(a);He.a.mark(4671);this.Lyk(c);return 32}ZKl(a,b,c,f){a.kAa();(a=c.sc(a.Na))?(f=ha.a.Nu(a,
A.AFrameworkApplication.isRtl?f.begin:f.end),this.u8a.sca(new Sys.UI.Point(f.x,f.y+f.height),b)):da.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}Knj(a,b,c,f,l){if(!b.view.xi)return 2;const u=b.view;if(!this.Vc.Oa.kb)return this.yd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),2;if(1===c)return 32;const I=new vB,T=new oK(this.xn,this.Bf);b=new pK(null,a,b,c,f,I,T,this.Ca,this.Vc,this.Bf,null);b.Bj=!0;b.Lh();if(b.isCompleted&&I.HLb){if(b=$d.SelectionFactory.fh(I.aXc,I.HLb.begin),b=$d.SelectionFactory.PO(b,
me.a.rk(I.aXc,I.HLb.end)),!this.WCf.instance||!this.WCf.instance.lCm(I.HLb,b,u)){this.Vc.setSelection(b);let ja=0;l&&(ja=l.Gv);u.iAd=!1;ln.a.instance.Jb(new ne.a(1,1,1,()=>{this.ZKl(u,ja,I.aXc,I.HLb)}))}}else{const ja=new Ij.StandardDialog;ja.Fd=0;ad.App.tT.Vxe?ja.yob(CommonUIStrings.l_DefaultDialogTitle,I.M0h.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ja.yob(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,
null),ad.App.tT.Gvi(()=>{ja.UR&&(ja.hide(),this.Ca.nb(a,2))}))}return 32}fYe(){return 32}}Object(m.a)(rE,"ProofingActor",null,[]);var qK=d(737),dS=d(1136);class Sh{static BSj(){Sh.ZN||(Sh.ZN=Array(Sh.C6l),Sh.ZN[0]=rb.a.fontColor,Sh.ZN[1]=ye.a.tQ,Sh.ZN[2]=rb.a.pu,Sh.ZN[3]=rb.a.underline,Sh.ZN[4]=rb.a.Yw,Sh.ZN[5]=ye.a.hu,Sh.ZN[6]=rb.a.font,Sh.ZN[7]=rb.a.fontSize,Sh.ZN[8]=rb.a.superscript,Sh.ZN[9]=rb.a.subscript,Sh.ZN[10]=rb.a.Hn,Sh.ZN[11]=ib.a.noProof,Sh.ZN[12]=Oe.a.Rya,Sh.ZN[13]=ye.a.capitalization,
Sh.ZN[14]=rb.a.bold,Sh.ZN[15]=rb.a.italic,Sh.ZN[16]=rb.a.underline);return Sh.ZN}static zSj(){Sh.pE||(Sh.pE=Array(Sh.Kcl),Sh.pE[0]=ib.a.Qn,Sh.pE[1]=ib.a.ULa,Sh.pE[2]=ib.a.Sm,Sh.pE[3]=ib.a.rza,Sh.pE[4]=ib.a.VZ,Sh.pE[5]=ib.a.elb,Sh.pE[6]=ib.a.MMb,Sh.pE[7]=ib.a.dlb,Sh.pE[8]=ye.a.WMb,Sh.pE[9]=ye.a.VMb,Sh.pE[10]=ib.a.SMb,Sh.pE[11]=ib.a.PMb,Sh.pE[12]=ib.a.CYa,Sh.pE[13]=ib.a.Ay,Sh.pE[14]=ib.a.hlb,Sh.pE[15]=ib.a.glb,Sh.pE[16]=ib.a.ksc,Sh.pE[17]=ib.a.jsc,Sh.pE[18]=rb.a.tm,Sh.pE[19]=rb.a.xK,Sh.pE[20]=ye.a.Aud,
Sh.pE[21]=rb.a.UZ);return Sh.pE}}Sh.C6l=17;Sh.Kcl=22;Sh.ZN=null;Sh.pE=null;Object(m.a)(Sh,"StyleConstants",null,[]);class Or{static get Xml(){return Or.GQ||(Or.GQ=new dS.a)}static yxe(a,b){if(!a||!a.node||!b)return!1;const c=Od.a.yt(a);if(Or.mCg(c?c.RA:null,b,Sh.BSj()))return da.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.k$();return Or.mCg(a,b,Sh.zSj())?(da.ULS.sendTraceTag(51218399,324,50,"Difference in paragraph attributes b/w text selection and style"),
!0):!1}static mCg(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Qa(l)?b.Qa(l)?!Or.Xml.compare(a,b,l):!0:!1)||f;return f}}Or.GQ=null;Object(m.a)(Or,"StyleUtils",null,[]);class sE{constructor(a,b,c,f,l,u,I,T,ja,ua){this.g7a=this.MSb=null;this.Ch=a;this.YL=b;this.ZL=c;this.Sf=f;this.tja=l;this.Eu=u;this.NE=I;this.yd=T;this.$Ra=ja;this.sri=ua}get characterPropertiesEditor(){return this.Ch}get zQ(){return this.YL}get W7(){return this.ZL}get Dn(){return this.tja}get insertionPointFormatting(){return this.Eu}get Eh(){return this.Sf}get Jj(){return this.NE}get fd(){return this.yd}get cef(){return this.$Ra}get xCc(){return this.sri}get KXa(){null==
this.g7a&&(this.g7a=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.g7a}qb(){const a=A.AFrameworkApplication.Pa,b=ad.App.uOa.BTc(12);U.a.instance.ga(61)&&(a.xa(G.a.N9a,ta.a.textRange,Object(R.a)(this,this.XEi,"applyStyleToTextRange")),a.xa(G.a.Puc,ta.a.textRange,Object(R.a)(this,this.rol,"queryStyleTextRange")),a.xa(G.a.N9a,ta.a.Xf,Object(R.a)(this,this.VEi,"applyStyleToIp")),a.xa(G.a.Puc,ta.a.Xf,Object(R.a)(this,
this.pol,"queryStyleIp")));a.xa(G.a.N9a,ta.a.paragraph,Object(R.a)(this,this.WEi,"applyStyleToParagraph"));a.xa(G.a.N9a,ta.a.view,Object(R.a)(this,this.YEi,"applyStyleView"));a.pe(G.a.N9a,1036);a.xa(G.a.Puc,ta.a.view,Object(R.a)(this,this.sol,"queryStyleView"));a.xa(G.a.Puc,ta.a.paragraph,Object(R.a)(this,this.qol,"queryStyleParagraph"));a.pe(G.a.Puc,99|(U.a.instance.ga(7)?0:4));a.xa(G.a.atc,ta.a.view,b);a.xa(G.a.atc,ta.a.paragraph,Object(R.a)(this,this.atc,"populateMenuMoreStyles"));a.pe(G.a.atc,
1127);a.pa(G.a.D0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.E0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.F0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.G0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.H0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.I0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.J0d,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),
4);a.pa(G.a.ZOf,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.$Of,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);a.pa(G.a.aPf,ta.a.view,Object(R.a)(this,this.Cta,"applyStyleShortcut"),4);this.MSb=Array(10);this.W7.H8e(this.MSb)}XNj(a){switch(a){case G.a.D0d:return 0;case G.a.E0d:return 1;case G.a.F0d:return 2;case G.a.G0d:return 3;case G.a.H0d:return 4;case G.a.I0d:return 5;case G.a.J0d:return 6;case G.a.ZOf:return 7;case G.a.$Of:return 8;case G.a.aPf:return 9;
default:return-1}}Cta(a,b,c,f){a=this.XNj(a);return 0>a||a>this.MSb.length?2:(a=this.MSb[a])?A.AFrameworkApplication.Pa.Ai(b,G.a.N9a,c,!0,f,a):2}atc(a,b,c,f,l){a=!0;b.contextId!==ta.a.paragraph&&b.contextId!==ta.a.textRange&&b.contextId!==ta.a.Xf&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.W7.EM(b.node);c=U.a.instance.ga(61);A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es&&(l.MenuItems=qK.StylePreviewGenerator.Blg(b,c));l.PopulationXML=qK.StylePreviewGenerator.Lsj(b,
c);return 32}qol(a,b,c,f,l){a=!0;b.contextId!==ta.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.W7.iF(c);if(!a||!l)return da.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.rcf.fz(a);this.KXa&&(l.Pve=Or.yxe(b,a));return 32}WEi(a,b,c,f,l){if(b.contextId!==ta.a.paragraph)return 8;if(U.a.instance.ga(14)&&this.Jj.RHa(b))return this.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.ble(l,a);if(!b)return this.fd.kc(be.a.C3,
{["Reason"]:Ud.a.x9b}),8;if(2!==this.W7.Bva(b))return 2;c=new pg.GraphTransaction(15);c.rd(a);this.insertionPointFormatting.H2a();this.zQ.mca(b,a,!1);c.dispose();l=Aa.a.gM(l);f.ED=l>>>16^l&65535;return 32}rol(a,b,c,f,l){a=!0;b.contextId!==ta.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=Od.a.yt(b);a=Od.a.LAb(a);if(this.KXa){if(!l||!c)return da.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",l,c),8;a=a||this.W7.iF(c);if(!a)return da.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),
2;l.Pve=Or.yxe(b,a)}else{if(!a)return 2;if(!l)return 8}l.rcf.fz(a);return 32}XEi(a,b,c,f,l){if(b.contextId!==ta.a.textRange||!U.a.instance.ga(61))return 8;if(this.Jj.RHa(b))return this.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const u=this.ble(l,b.node);if(!u)return this.fd.kc(be.a.C3,{["Reason"]:Ud.a.x9b}),8;if(1!==this.W7.Bva(u))return 2;c=this.W7.EM(a);if(!c)return this.fd.kc(be.a.C3,{["Reason"]:Ud.a.ibg}),8;if(!c.gI(this.W7.GR(u)))return this.fd.kc(be.a.C3,
{["Reason"]:Ud.a.x9b}),8;const I=new pg.GraphTransaction(7);try{I.rd(a),this.zQ.XBc(a,c),this.cef.uPc(b,T=>{this.Eh.DEa(T);this.Eh.via(T,u)})}finally{I&&I.dispose()}b=Aa.a.gM(l);f.ED=b>>>16^b&65535;return 32}pol(a,b,c,f,l){a=!0;b.contextId!==ta.a.Xf&&(a=!1);if(1===c&&!a)return 2;c=this.zQ.Zke(b);a=b.node;if(this.KXa){if(!l||!a)return da.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",l,a),8;c=c||this.W7.iF(a);if(!c)return da.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),
2;l.Pve=Or.yxe(b,c)}else{if(!c)return 2;if(!l)return 8}l.rcf.fz(c);return 32}VEi(a,b,c,f,l){if(b.contextId!==ta.a.Xf||!U.a.instance.ga(61))return 8;if(this.Jj.RHa(b))return this.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const u=this.ble(l,b.node);if(!u)return this.fd.kc(be.a.C3,{["Reason"]:Ud.a.x9b}),8;const I=this.W7.Bva(u);if(1!==I&&2!==I)return 2;(b=this.insertionPointFormatting.bbc(b))?(c=Me.a.TTa(b),a=A.AFrameworkApplication.Pa.Ai(c,a,2,!1,f,l)):(a=new pg.GraphTransaction(7),
a.rd(c),this.zQ.I8e(u,c),a.dispose(),a=32);l=Aa.a.gM(l);f.ED=l>>>16^l&65535;return a}sol(a,b,c,f,l){if(U.a.instance.ga(61)){const u=this.xCc.x7(a,b,c,f,l,null,0);if(2!==u)return u}return this.xCc.x7(a,b,c,f,l,null,12)}YEi(a,b,c,f,l){const u={};u[this.xCc.Fra]=6168;u[this.xCc.Era]=6169;let I=12;if(U.a.instance.ga(61)){if(!b.view.xi)return 2;var T=b.view.Rb,ja=T?T.Ik:null;if(!ja)return this.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;if(U.a.instance.ga(11)&&this.Dn.Xta(vb.ImageReader.ADb,ja))return this.fd.kc(be.a.ei,
{["Reason"]:Ud.a.l6b}),8;if(U.a.instance.ga(14)&&this.Jj.A6c(ja))return this.fd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),8;ja=this.W7.WBb();if(l&&ja){var ua=ja.gI(l);ua&&(ja=this.W7.wie(ua,ja),ua=this.W7.Bva(ua),ja&&(T=T.Oa.ga(0),T.zea&&T.Ua.contextId===ta.a.textRange||2===T.length&&T.Ua.contextId===ta.a.textRange&&T.vf.contextId===ta.a.endOfParagraph)&&(ua=1,l=ja.$a(ye.a.XMb)),1===ua?I=0:3===ua&&(I=14))}}return this.xCc.x7(a,b,c,f,l,u,I)}ble(a,b){if(a&&b&&$a.ParagraphReader.ke(b))b=this.W7.EM(b);else return null;
return b.gI(a)}}Object(m.a)(sE,"StyleActor",null,[]);const rK=a=>a.contextId===ta.a.pee;class $u{static uqb(a,b,c){1!=c&&ff.ActionManager.bEb()&&(b=A.AFrameworkApplication.Pa.Vcb(b))&&ff.ActionManager.fZd(b.interactive_uid,"ContextIds",ta.a.Fv(a.contextId))}}Object(m.a)($u,"InteractivePerformanceUtils",null,[]);class oh{static get Dn(){return Uh.ContextSetEditor.instance}static get Jj(){return mi.a.instance}static get fd(){return jd.a.instance}static get Re(){return oh.kd||(oh.kd=Tb.a.instance.resolve("Box4.IFeatureHelper"))}static Yr(){return oh.yn||
(oh.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static get KN(){return oh.JH||(oh.JH=Tb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Ffc(a){return A.AFrameworkApplication.fa.getBooleanAppSetting("FontPreviewEnabled")&&(a===G.a.sMa||a===G.a.M2a||a===G.a.A7||a===G.a.fNa)}static z9(a,b,c,f,l){var u=!0;if(!b.view.xi)return 2;var I=b.view,T=I.Rb;T&&T.Oa.kb||(oh.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),u=!1);if(U.a.instance.ga(11)&&(oh.Dn.Xta(vb.ImageReader.Xec,I.Rb.Ik)&&(oh.fd.kc(be.a.ei,
{["Reason"]:Ud.a.w6d}),u=!1),oh.Dn.Xta(vb.ImageReader.ADb,I.Rb.Ik)))return oh.fd.kc(be.a.ei,{["Reason"]:Ud.a.l6b}),8;U.a.instance.ga(14)&&oh.Jj.A6c(I.Rb.Ik)&&(oh.fd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),u=!1);oh.Dn.Xta(vb.ImageReader.Ave,I.Rb.Ik)&&(oh.fd.kc(be.a.ei,{["Reason"]:Ud.a.HZf}),u=!1);oh.Dn.Xta(Zu.c,I.Rb.Ik)&&(oh.fd.kc(be.a.ei,{["Reason"]:Ud.a.IZf}),u=!1);oh.Dn.Xta(rK,I.Rb.Ik)&&(oh.fd.kc(be.a.ei,{["Reason"]:Ud.a.GZf}),u=!1);oh.Yr()&&oh.Yr().instance&&oh.Yr().instance.rY(I.Rb.Ik)&&(oh.fd.kc(be.a.ei,
{["Reason"]:Ud.a.externalSelection}),u=!1);a!==G.a.j_||U.a.instance.ga(54)||U.a.instance.ga(84)||(u=!1);var ja=null;T&&T.Oa.kb&&(ja=T.Oa.kb);a===G.a.f4l&&ja&&ja.zea&&$a.ParagraphReader.tY(ja.Ua.node)&&!Kc.ListReader.wy&&(u=!1);if(1===c||!u||!ja)return u?32:8;$u.uqb(b,a,c);u=a===G.a.ega||a===G.a.rea||a===G.a.pia||a===G.a.Yua;I=a===G.a.Fml||a===G.a.eaj||a===G.a.SCh;const ua=a===G.a.B3a||a===G.a.C3a||a===G.a.j_,Ra=new pg.GraphTransaction(15);Ra.rd(ja.Ua.node);ja=new La.a;let eb=!1;if(u||I||ua)He.a.mark(7121),
b=oh.Dn.asj(b.GF);else{He.a.mark(7119);b=gj.Zua(T.Oa,!0);if(!b)return oh.fd.kc(be.a.ama,{["Reason"]:Ud.a.IXc}),Ra.dispose(),8;T=a===G.a.bxg||a===G.a.$7j;b.ry&&T&&(eb=oh.r1j(ja,b))}b.ry&&1<b.length&&oh.s1j(b)&&(l||(l={}),l.InContextSet=!0);A.AFrameworkApplication.Pa.Ai(b,a,c,!0,f,l);eb&&oh.l0k(ja,b,l);Ra.dispose();ad.App.Ob.Gf();u||I||ua?He.a.mark(7122):He.a.mark(7120);return 32}static r1j(a,b){if(!b.ry)return!1;let c=!1,f=!1;for(let u=0;u<b.length;u++)if(b.getContext(u).El){var l=b.getContext(u).node;
if(l)if(l=oh.KN.kBb(l),2===l.specialIndentType)c=!0,a.add(u);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static l0k(a,b,c){if(b.ry)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.El)continue;f=f.node;const u=oh.KN.kBb(f);2!==u.specialIndentType||qf.a.cA(c.value,u.eP)||f.setValue(ib.a.Sm,u.eP-u.wSb)}}static yXl(a,b){let c=!0;b.contextId!==ta.a.paragraph?c=!1:U.a.instance.ga(14)&&oh.Jj.RHa(b)?(oh.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),c=!1):oh.Yr()&&oh.Yr().instance&&
oh.Yr().instance.rY(b)&&(oh.fd.kc(be.a.Kp,{["Reason"]:Ud.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,yG:c?32:8}}static MPh(a,b){let c=!0;b.contextId!==ta.a.image&&b.contextId!==ta.a.embeddedFile&&(c=!1);U.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,yG:c?32:8}}static s1j(a){if(!a.ry)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).El){var c=a.getContext(f).node;if(c)if(c=$a.ParagraphReader.zM(c),!f)b=c;else if(c!==b)return!0}return!1}}oh.kd=null;oh.yn=null;oh.JH=
null;Object(m.a)(oh,"FormattingActionHelper",null,[]);class Gt extends Dt.a{constructor(a,b,c,f,l,u,I,T){super();this.gFf=this.rD=null;this.init(a);this.Fm("FormattingViewOperation");this.eHa(A.AFrameworkApplication.Pa,b,f,l,u);this.ew=c;this.mPa=0;this.VB=!0;this.rei=I;this.yn=T}get Kua(){return this.yn.instance}Lh(){const a=this.ew.view;var b=null;a.xi&&(b=a.Rb);if(b){var c=b.Oa.kb;!c||U.a.instance.ga(14)&&Gt.Jj.Dxe(c)?(Gt.fd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),this.VB=!1):this.Kua&&this.Kua.VDb(c)&&
(Gt.fd.kc(be.a.ei,{["Reason"]:Ud.a.externalSelection}),this.VB=!1)}else Gt.fd.kc(be.a.ei,{["Reason"]:Ud.a.Sya}),this.VB=!1;1!==this.behavior&&this.VB||(this.VB&&(c=b.Oa.kb,1===b.Oa.length&&1===c.length&&Bc.SelectionEditor.Tk(c.Ua)&&We.b(c.Ua)&&(Gt.fd.kc(be.a.ei,{["Reason"]:Ud.a.MSc}),this.VB=!1)),(c=this.VB)&&this.actionId===G.a.tW&&((c=xb.AT(b.Oa.kb,Od.a.JZf))||Gt.fd.kc(be.a.ei,{["Reason"]:Ud.a.pae})),this.Op=c?32:8,this.mPa=3);0===this.mPa&&(He.a.mark(5730),this.gFf=hm.SelectionReferenceFactory.instance.fua(),
c=b.Oa.kb.Ua,this.rD=new pg.GraphTransaction(15),this.rD.rd(c.node),this.mPa=1);if(1===this.mPa){this.ox||this.Hnb(this.ew.GF);if(1===this.hqa())return;this.mPa=2}if(2===this.mPa){if(this.actionId===G.a.tW)if(b=b.Ik,b.ry)for(c=0;c<b.length;c++){const f=b.getContext(c);this.h0h(f)}else this.h0h(b);b=this.actionId===G.a.fT||this.actionId===G.a.uea||this.actionId===G.a.clearFormatting||this.actionId===G.a.FX;oh.Ffc(this.actionId)||this.gFf.hW(b);(b=Object(gb.a)(172,this.Bd))&&!b.pca||F.FocusManager.instance().Df(a.WJ);
this.rD.dispose();this.rD=null;oh.Ffc(this.actionId)||ad.App.Ob.Gf();He.a.mark(5731);this.mPa=3;this.Op=32}3===this.mPa&&(this.rei.process(this.actionId,this.ew,this.behavior,this.response),this.i_())}h0h(a){(Bc.SelectionEditor.Vu(a)||Bc.SelectionEditor.Om(a))&&ad.App.tT.lT(a.node)}static get Jj(){return mi.a.instance}static get fd(){return jd.a.instance}}Object(m.a)(Gt,"FormattingViewOperation",Dt.a,[]);var eS=d(481),fS=d(420);class Rd{constructor(a,b,c,f,l){this.CCa=new bd.ScriptSharpLegacyMap;
this.MUl=u=>{u=gf.HyperlinkReader.JCj(u,this.LE);for(const I of u)(u=I.paragraph)&&u.Sa&&(u=u.Sa.TU(I.Ra))&&u.formatting&&Rd.Eh.GGh(u.formatting)};this.Dei=a;this.jsf=b;this.jw=c;this.LE=f;if(!l)throw Error.argumentNull("interactiveViewManager");Rd.$f=l;this.Esb=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("FontPreviewEnabled")}qb(){const a=A.AFrameworkApplication.Pa,b=Object(R.a)(this,this.Qnl,"queryNonParagraphFormatting");U.a.instance.ga(105)&&(Rd.Re?Rd.Re.AHa(55):
A.AFrameworkApplication.fa.getBooleanAppSetting("Box4EndOfParagraphFormattingIsEnabled"))?(a.xa(G.a.font,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.$q,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.OG,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.rH,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.Jr,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.FX,
ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.fT,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.uea,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.bold,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.setItalic,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.underline,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.Wqa,ta.a.endOfParagraph,
Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.superscript,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.subscript,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.strikethrough,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.hu,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.tW,ta.a.endOfParagraph,Object(R.a)(this,this.eR,"applyFormattingEOP")),a.xa(G.a.clearFormatting,ta.a.endOfParagraph,
Object(R.a)(this,this.eR,"applyFormattingEOP"))):ad.App.Efb&&(a.xa(G.a.font,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.$q,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.Jr,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.FX,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),Kc.ListReader.wy&&(a.xa(G.a.bold,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),
a.xa(G.a.setItalic,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.superscript,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.subscript,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.strikethrough,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.hu,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP"))),U.a.instance.ga(94)||U.a.instance.ga(96))&&
(a.xa(G.a.OG,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")),a.xa(G.a.rH,ta.a.endOfParagraph,Object(R.a)(this,this.gea,"applyListFormattingEOP")));const c=ad.App.uOa.G0f(f=>gj.Zua(f.Oa,!0));a.pa(G.a.mDd,ta.a.textRange,Object(R.a)(this,this.mDd,"toggleChangeCase"),1028);U.a.instance.ga(77)||a.xa(G.a.Gza,ta.a.table,Object(R.a)(this,this.yol,"queryTableFormatting"));a.xa(G.a.hOb,ta.a.view,Object(R.a)(this,this.gyh,"queryCharacterFormatting"));a.xa(G.a.G_e,ta.a.view,Object(R.a)(this,
this.gyh,"queryCharacterFormatting"));a.xa(G.a.Gza,ta.a.view,c);a.xa(G.a.Gza,ta.a.paragraph,Object(R.a)(this,this.Gza,"queryParagraphFormatting"));a.xa(G.a.Gza,ta.a.image,Object(R.a)(this,this.Gnl,"queryImageFormatting"));a.xa(G.a.Gza,ta.a.unsupportedObject,b);a.pe(G.a.hOb,99|(U.a.instance.ga(7)?0:1028));a.pe(G.a.G_e,1127);a.pe(G.a.Gza,97|(U.a.instance.ga(7)?0:1028));A.AFrameworkApplication.fa.getBooleanAppSetting("RulerEnabled")&&(a.xa(G.a.kOb,ta.a.view,c),a.xa(G.a.kOb,ta.a.paragraph,Object(R.a)(this,
this.kOb,"queryParagraphIndentation")),a.pe(G.a.kOb,97|(U.a.instance.ga(7)?0:1028)));this.uD(a,G.a.font);this.uD(a,G.a.$q);this.Esb&&(this.uD(a,G.a.sMa),this.uD(a,G.a.M2a),this.uD(a,G.a.A7),this.uD(a,G.a.fNa));if(U.a.instance.ga(94)||U.a.instance.ga(96))this.uD(a,G.a.OG),this.uD(a,G.a.rH);a.PDa(G.a.Xdg,ta.a.view,Object(R.a)(this,this.p0d,"applyCharacterFormattingViewAsync"));a.pe(G.a.Xdg,1092);this.uD(a,G.a.Jr);this.uD(a,G.a.FX);this.uD(a,G.a.fT);this.uD(a,G.a.Z4b);this.uD(a,G.a.nxb);this.uD(a,G.a.oxb);
this.uD(a,G.a.y$a);this.uD(a,G.a.$4b);this.uD(a,G.a.uea);this.uD(a,G.a.bold);a.ynb(G.a.bold,Object(R.a)(this,this.Nbb,"generateActionArguments"));this.uD(a,G.a.setItalic);a.ynb(G.a.setItalic,Object(R.a)(this,this.Nbb,"generateActionArguments"));this.uD(a,G.a.underline);a.ynb(G.a.underline,Object(R.a)(this,this.Nbb,"generateActionArguments"));this.uD(a,G.a.Wqa);this.uD(a,G.a.superscript);a.ynb(G.a.superscript,Object(R.a)(this,this.Nbb,"generateActionArguments"));this.uD(a,G.a.subscript);a.ynb(G.a.subscript,
Object(R.a)(this,this.Nbb,"generateActionArguments"));this.uD(a,G.a.strikethrough);a.ynb(G.a.strikethrough,Object(R.a)(this,this.Nbb,"generateActionArguments"));this.uD(a,G.a.hu);a.ynb(G.a.hu,Object(R.a)(this,this.Nbb,"generateActionArguments"));a.pa(G.a.keb,ta.a.textRange,Object(R.a)(this,this.tPc,"applyCharacterFormatting"),96);a.PDa(G.a.tW,ta.a.view,Object(R.a)(this,this.p0d,"applyCharacterFormattingViewAsync"));a.xa(G.a.tW,ta.a.paragraph,Object(R.a)(this,this.w0d,"applyParagraphFormatting"));
a.xa(G.a.tW,ta.a.textRange,Object(R.a)(this,this.tPc,"applyCharacterFormatting"));a.xa(G.a.tW,ta.a.Xf,Object(R.a)(this,this.q0d,"applyFormattingIp"));a.xa(G.a.clearFormatting,ta.a.view,Object(R.a)(this,this.$Ti,"clearFormattingView"));a.xa(G.a.clearFormatting,ta.a.paragraph,Object(R.a)(this,this.ZTi,"clearFormattingParagraph"));a.xa(G.a.clearFormatting,ta.a.textRange,Object(R.a)(this,this.tPc,"applyCharacterFormatting"));a.xa(G.a.clearFormatting,ta.a.Xf,Object(R.a)(this,this.q0d,"applyFormattingIp"));
a.pe(G.a.clearFormatting,1028);a.xa(G.a.H$a,ta.a.textRange,Object(R.a)(this,this.H$a,"clearFormattingParagraphLevel"));a.xa(G.a.H$a,ta.a.Xf,Object(R.a)(this,this.H$a,"clearFormattingParagraphLevel"));a.xa(G.a.P4d,ta.a.view,Object(R.a)(this,this.P4d,"clearFormattingMultiParagraphLevel"));a.xa(G.a.GNa,ta.a.view,oh.z9);a.xa(G.a.GNa,ta.a.paragraph,Object(R.a)(this,this.w0d,"applyParagraphFormatting"));a.xa(G.a.GNa,ta.a.image,Object(R.a)(this,this.ePf,"applyTextDirectionToImage"));a.xa(G.a.GNa,ta.a.unsupportedObject,
Object(R.a)(this,this.fPf,"applyTextDirectionToNonParagraph"));a.pe(G.a.GNa,1028);a.xa(G.a.E3a,ta.a.view,oh.z9);a.xa(G.a.E3a,ta.a.paragraph,Object(R.a)(this,this.w0d,"applyParagraphFormatting"));a.xa(G.a.E3a,ta.a.image,Object(R.a)(this,this.ePf,"applyTextDirectionToImage"));a.xa(G.a.E3a,ta.a.unsupportedObject,Object(R.a)(this,this.fPf,"applyTextDirectionToNonParagraph"));a.pe(G.a.E3a,1028)}uD(a,b){a.PDa(b,ta.a.view,Object(R.a)(this,this.p0d,"applyCharacterFormattingViewAsync"));a.xa(b,ta.a.textRange,
Object(R.a)(this,this.tPc,"applyCharacterFormatting"));a.xa(b,ta.a.Xf,Object(R.a)(this,this.q0d,"applyFormattingIp"));a.pe(b,1028)}Nbb(){return new Q(2)}mDd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Ra,b.Pb-b.Ra);return Rd.aye(a,0,a.length)?this.qRc(b,G.a.nxb):Rd.erk(a)?this.qRc(b,G.a.y$a):this.qRc(b,G.a.oxb)}gyh(a,b,c,f,l){f=!0;b.contextId!==ta.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===G.a.G_e)a=l.formatting,l=l.$Dm;else{if(!b.view||!b.view.xi)return 2;b=b.view;if(!b.Rb||!b.Rb.Oa.kb)return 8;
a=l;l=b.Rb.Oa}this.tXi(l,a);return 32}tXi(a,b){for(const l of a){a=l.qm;for(const u of l){let I=null;if(u.contextId===ta.a.textRange){if(We.b(u))continue;I=[];var c=u.node.Sa;if(c){var f=c.length-1;const T=u.Ra,ja=u.Pb;let ua=!1;for(let Ra=0;Ra<f;Ra++){const eb=c.ga(Ra).cp,Bb=c.ga(Ra+1).cp;if(c.ga(Ra).formatting&&Math.max(eb,T)<Math.min(Bb,ja))ua=!0,Array.add(I,c.ga(Ra).formatting);else if(ua)break}c.ga(f).formatting&&u.Pb>c.ga(f).cp&&Array.add(I,c.ga(f).formatting)}}else if(u.contextId===ta.a.paragraph){if(I=
[],c=u.node.Sa)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(I,c.ga(f).formatting)}else if(u.contextId===ta.a.endOfParagraph)I=[Od.a.yt(u)];else if(u.contextId===ta.a.Xf){this.mnl(u,b);return}if(I&&0<I.length)for(const T of I)if(Od.a.NEd(b,T.cache,u,a))return}}}mnl(a,b){var c=Od.a.yt(a);if(c){c=c.cache;var f=Rd.insertionPointFormatting.bK(rb.a.bold,c.isBold);b.bold=f?1:0;f=Rd.insertionPointFormatting.bK(rb.a.italic,c.isItalic);b.italic=f?1:0;f=Rd.insertionPointFormatting.bK(rb.a.underline,
c.VD);b.underline=f?1:0;b.Yw=Rd.insertionPointFormatting.bK(rb.a.Yw,c.Yw);f=Rd.insertionPointFormatting.bK(rb.a.superscript,c.isSuperscript);b.superscript=f?1:0;f=Rd.insertionPointFormatting.bK(rb.a.subscript,c.nF);b.subscript=f?1:0;f=Rd.insertionPointFormatting.bK(rb.a.strikethrough,c.zC);b.strikethrough=f?1:0;f=Rd.insertionPointFormatting.bK(ye.a.hu,c.qY);b.hu=f?1:0;f=Rd.insertionPointFormatting.bK(rb.a.font,c.tM);b.fontName=yf.Font.sGa(f);b.rra=c.EW;b.fontSize=this.jw.ocb(Rd.insertionPointFormatting.bK(rb.a.fontSize,
c.fontSize),a.node);b.fontColor=Rd.insertionPointFormatting.bK(rb.a.fontColor,c.fontColor);b.highlight=Rd.insertionPointFormatting.bK(rb.a.highlight,c.highlight)}}p0d(a,b,c,f,l,u){return new Gt(a,b,c,f,l,u,this.Dei,Rd.Yr())}tPc(a,b,c,f,l){f=!0;let u=b;$u.uqb(b,a,c);b.contextId!==ta.a.textRange&&b.contextId!==ta.a.Xf?f=!1:(U.a.instance.ga(14)&&Rd.Jj.mwa(u)&&(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),f=!1),Rd.Yr()&&Rd.Yr().instance&&Rd.Yr().instance.rY(u)&&(f=!1),f&&Bc.SelectionEditor.Tk(b)&&We.b(u)&&
(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.MSc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===ta.a.Xf)return 2;this.jw.OQh(a)&&(b=Bc.SelectionEditor.UTb(u),Bc.SelectionEditor.nh(b)||(u=b));b=u.node;oh.Ffc(a)&&(b.mra=!0);a==G.a.Jr&&U.a.instance.ga(119)&&A.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.MUl(u);Rd.cef.uPc(u,I=>{this.wLh(I,a,l,u.Pb)});oh.Ffc(a)&&(b.mra=!1);this.wfk(a)&&this.qRc(u,a);return 32}l1c(a){if(!this.Esb||!a||!a.paragraph)return null;const b=
Rd.$f.$d;if(!b)return null;a=Object(gb.a)(489,a.paragraph.vg(b.Na));return a?(a=Object(gb.a)(214,a))?a:null:null}J3c(a){return this.Esb&&!!a&&!!a.tj}RLh(a,b,c){if(a&&a.Bd){var f={};f.StartTime=Date.now();f.ActionName=ff.ActionManager.Xda(c);f.HandlerName="SetFont";f.DataType="String";f.ModernFontPicker="Disabled";f.OtherStyling="False";var l=b.cache,u=a.Bd,I=-1;if("string"===typeof u)this.Esb&&c===G.a.A7&&this.r$a(b,l.tM,rb.a.font),a=u;else if(f.DataType="Other",this.Esb&&c===G.a.A7&&(this.r$a(b,
l.tM,rb.a.font),this.r$a(b,l.EW,ib.a.EW)),a=u.fontName,I=u.rra,yf.Font.UXa()){f.ModernFontPicker="Enabled";this.Esb&&c===G.a.A7&&(this.r$a(b,l.isBold,rb.a.bold),this.r$a(b,l.isItalic,rb.a.italic));const T=1===u.bold;u=1===u.italic;if(T||u)f.OtherStyling="True",Rd.Eh.fJ(b,T),Rd.Eh.setItalic(b,u)}a=a.substr(0,31);Rd.Eh.rW(b,a);U.a.instance.ga(53)&&(c===G.a.A7&&this.r$a(b,l.EW,ib.a.EW),Rd.Eh.HNa(b,I));f.EndTime=Date.now();this.V5(f)}}V5(a){Object(Nb.a)("TextFormattingActorTelemetry")&&da.ULS.sendTraceTag(508359109,
820,50,Qa.a.toJSON(a))}r$a(a,b,c){this.CCa.Ib(a.Qe.cp)||this.CCa.$(a.Qe.cp,new bd.ScriptSharpLegacyMap);this.CCa.ga(a.Qe.cp).Ib(c)||this.CCa.ga(a.Qe.cp).$(c,b)}P$b(a,b){if(!this.CCa.Ib(a.Qe.cp))return null;const c=this.CCa.ga(a.Qe.cp).ga(b);this.CCa.ga(a.Qe.cp).remove(b);this.CCa.ga(a.Qe.cp).count||this.CCa.remove(a.Qe.cp);return c}wLh(a,b,c,f){var l=a.cache,u=Object(gb.a)(172,c);switch(b){case G.a.bold:2===c.value&&(c.value=l.isBold?0:1);Rd.Eh.fJ(a,1===c.value);break;case G.a.setItalic:2===c.value&&
(c.value=l.isItalic?0:1);Rd.Eh.setItalic(a,1===c.value);break;case G.a.underline:2===c.value&&(c.value=l.VD?0:1);Rd.Eh.n_(a,1===c.value);break;case G.a.Wqa:Rd.Eh.Wqa(a,c);break;case G.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);Rd.Eh.m_(a,1===c.value);break;case G.a.subscript:2===c.value&&(c.value=l.nF?0:1);Rd.Eh.O7(a,1===c.value);break;case G.a.strikethrough:2===c.value&&(c.value=l.zC?0:1);Rd.Eh.l_(a,1===c.value);break;case G.a.hu:2===c.value&&(c.value=l.qY?0:1);Rd.Eh.Inb(a,1===c.value);
break;case G.a.font:this.RLh(u,a,G.a.font);break;case G.a.A7:c=this.l1c(a);this.J3c(c)&&(this.RLh(u,a,G.a.A7),c.wL(null));break;case G.a.fNa:c=this.l1c(a);this.J3c(c)&&(u=this.P$b(a,rb.a.font))&&(f=this.P$b(a,rb.a.bold),l=this.P$b(a,rb.a.italic),f&&Rd.Eh.fJ(a,f),l&&Rd.Eh.setItalic(a,l),u=u.substr(0,31),Rd.Eh.rW(a,u),f=this.P$b(a,ib.a.EW),U.a.instance.ga(53)&&f&&Rd.Eh.HNa(a,f),c.wL(null));break;case G.a.Jr:Rd.Eh.Jr(a,c,null);break;case G.a.FX:Rd.Eh.FX(a);break;case G.a.fT:Rd.Eh.Pqa(a,c);break;case G.a.uea:Rd.Eh.y5b(a);
break;case G.a.$q:Rd.Eh.$q(a,u.Bd);break;case G.a.sMa:c=this.l1c(a);this.J3c(c)&&(this.r$a(a,l.fontSize,rb.a.fontSize),Rd.Eh.$q(a,u.Bd),c.wL(null));break;case G.a.M2a:c=this.l1c(a);this.J3c(c)&&(f=this.P$b(a,rb.a.fontSize))&&(Rd.Eh.$q(a,f),c.wL(null));break;case G.a.OG:Rd.Eh.c3c(a);break;case G.a.rH:Rd.Eh.YAd(a);break;case G.a.tW:l=U.a.instance.ga(20)?ib.a.noProof:Oe.a.Rya;l=c.ra(l,!1);Rd.Eh.wxc(a,c.$a(rb.a.pu),f,l);break;case G.a.keb:Rd.Eh.bRb(a);break;case G.a.clearFormatting:Rd.Eh.DEa(a);break;
case G.a.nxb:case G.a.oxb:case G.a.Z4b:case G.a.y$a:case G.a.$4b:l.MWa&&2===l.capitalization&&Rd.Eh.J4d(a)}}H$a(a,b,c){a=!0;b.contextId!==ta.a.textRange&&b.contextId!==ta.a.Xf?a=!1:(U.a.instance.ga(14)&&Rd.Jj.mwa(b)&&(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),a=!1),a&&Bc.SelectionEditor.Tk(b)&&We.b(b)&&(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.MSc}),a=!1));if(1===c||!a)return a?32:8;Rd.paragraphEditor.C5b(b.node,!1);return 32}P4d(a,b,c,f,l){a={};a[Oi.Fra]=6168;a[Oi.Era]=6169;const u=b.view;var I=null;u.Wp&&
(I=u);var T=!0;let ja=32;I&&(I=I.Rb.Oa.kb)&&U.a.instance.ga(14)&&(Rd.Jj.Dxe(I)?(Rd.fd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),ja=8,T=!1):1===c&&(ja=32,T=!1));T&&U.a.instance.ga(54)&&(T=new pg.GraphTransaction(1===c?3:15),T.rd(u.root),ja=Oi.x7(G.a.H$a,b,c,f,l,a,12),T.dispose());return ja}q0d(a,b,c,f,l){var u=!0,I=32;b.contextId!==ta.a.Xf?u=!1:U.a.instance.ga(14)&&Rd.Jj.mwa(b)&&(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),u=!1);if(1===c||!u)return u?32:8;c=b.node;u=null;if(U.a.instance.ga(54)&&U.a.instance.ga(61)&&
a===G.a.clearFormatting){Rd.hs.Exb(c);Rd.paragraphEditor.yXf(c);const T=Wb.StyleReader.EM(c).gI(Wb.StyleReader.dPa);Rd.zQ.mca(T,c,!0)}if(a!==G.a.clearFormatting||U.a.instance.ga(49))u=Rd.insertionPointFormatting.bbc(b);if(u)I=Me.a.TTa(u),I=A.AFrameworkApplication.Pa.Ai(I,a,2,!1,f,l);else switch(f=Object(gb.a)(172,l),b=Od.a.yt(b).cache,a){case G.a.font:f&&f.Bd&&(l=f.Bd,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.rra),Rd.insertionPointFormatting.Hyd(b),U.a.instance.ga(53)&&Rd.insertionPointFormatting.HNa(f));
break;case G.a.Jr:Rd.insertionPointFormatting.Jr(l);break;case G.a.FX:Rd.insertionPointFormatting.FX();break;case G.a.fT:Rd.insertionPointFormatting.Pqa(l);break;case G.a.uea:Rd.insertionPointFormatting.y5b();break;case G.a.$q:Rd.insertionPointFormatting.$q(f.Bd);break;case G.a.OG:l=Rd.insertionPointFormatting.bK(rb.a.fontSize,b.fontSize);Rd.insertionPointFormatting.$q(Rd.Eh.OG(l));break;case G.a.rH:l=Rd.insertionPointFormatting.bK(rb.a.fontSize,b.fontSize);Rd.insertionPointFormatting.$q(Rd.Eh.rH(l));
break;case G.a.bold:l=Rd.insertionPointFormatting.bK(rb.a.bold,b.isBold);Rd.insertionPointFormatting.fJ(!l);break;case G.a.setItalic:l=Rd.insertionPointFormatting.bK(rb.a.italic,b.isItalic);Rd.insertionPointFormatting.setItalic(!l);break;case G.a.underline:l=Rd.insertionPointFormatting.bK(rb.a.underline,b.VD);Rd.insertionPointFormatting.n_(!l);break;case G.a.Wqa:Rd.insertionPointFormatting.Wqa(l);break;case G.a.superscript:l=Rd.insertionPointFormatting.bK(rb.a.superscript,b.isSuperscript);Rd.insertionPointFormatting.m_(!l);
break;case G.a.subscript:l=Rd.insertionPointFormatting.bK(rb.a.subscript,b.nF);Rd.insertionPointFormatting.O7(!l);break;case G.a.strikethrough:l=Rd.insertionPointFormatting.bK(rb.a.strikethrough,b.zC);Rd.insertionPointFormatting.l_(!l);break;case G.a.hu:l=Rd.insertionPointFormatting.bK(ye.a.hu,b.qY);Rd.insertionPointFormatting.Inb(!l);break;case G.a.clearFormatting:Rd.insertionPointFormatting.H2a();U.a.instance.ga(54)||(Rd.hs.Exb(c),Rd.paragraphEditor.C5b(c,!0),U.a.instance.ga(71)&&Rd.zQ.PRc(c));
break;case G.a.tW:l.Qa(rb.a.pu)&&Rd.insertionPointFormatting.tW(l.$a(rb.a.pu)),b=U.a.instance.ga(20)?ib.a.noProof:Oe.a.Rya,l.Qa(b)&&Rd.insertionPointFormatting.NRl(l.$a(b))}oh.Ffc(a)||ad.App.Ob.Gf();return I}Xzl(a,b){G.a.clearFormatting===b&&jb.OutlineElementNavigator.qC(a).properties.removeProperty(rb.a.UZ)}eR(a,b,c,f,l){f=Rd.fd.Cq(G.a.UPl);var u=!0;b.contextId!==ta.a.endOfParagraph&&(u=!1);if(1===c||!u)return u?32:8;c=b.node;b=mb.GraphIterator.ob(b.node);b.wf();u=b.Ima(4);if((b=!!u&&Rd.eg.Xfa(u))&&
!ad.App.Efb)return 8;const I=!$a.ParagraphReader.textLength(c);f.properties.$("Action",a.toString());f.properties.$("ListContext",b.toString());f.properties.$("IsEmptyParagraph",I.toString());da.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,I);this.jsf.KVh(b)?this.P2h(a,l,u):(b=c.Sa.last,this.Xzl(c,a),u=b.formatting,c=Rd.characterPropertiesEditor.Fbe(c),this.jsf.SDg(u)&&(c.le(c.Qe),this.wLh(c,a,l,b.cp)));f.end();return 32}P2h(a,b,c){const f=
Object(gb.a)(172,b);switch(a){case G.a.Jr:Rd.hga.Jr(c,b);break;case G.a.$q:Rd.hga.$q(c,f.Bd);break;case G.a.FX:Rd.hga.FX(c);break;case G.a.OG:Rd.hga.OG(c);break;case G.a.rH:Rd.hga.rH(c);break;case G.a.font:Rd.hga.sQl(c,f.Bd);break;case G.a.bold:a=this.LPb(b,rb.a.bold,c);Rd.hga.fJ(c,a);break;case G.a.setItalic:a=this.LPb(b,rb.a.italic,c);Rd.hga.setItalic(c,a);break;case G.a.subscript:a=this.LPb(b,rb.a.subscript,c);Rd.hga.O7(c,a);break;case G.a.superscript:a=this.LPb(b,rb.a.superscript,c);Rd.hga.m_(c,
a);break;case G.a.strikethrough:a=this.LPb(b,rb.a.strikethrough,c);Rd.hga.l_(c,a);break;case G.a.hu:a=this.LPb(b,ye.a.hu,c),Rd.hga.Inb(c,a)}}LPb(a,b,c){2===a.value&&(a.value=c?c.ra(b,!1)?0:1:0);return 1===a.value}gea(a,b,c,f,l){f=!0;const u=mb.GraphIterator.ob(b.node);u.wf();b.contextId===ta.a.endOfParagraph&&u.Ima(4)||(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.Xze}),f=!1);b=u.currentNode;if(!Rd.eg.Xfa(b))return 8;if(1===c||!f)return f?32:8;this.P2h(a,l,b);return 32}Gza(a,b,c,f,l){a=!0;b.contextId!==ta.a.paragraph&&
(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.tm?l.tm!==$a.ParagraphReader.zM(c)&&(l.tm=0):l.tm=$a.ParagraphReader.zM(c);U.a.instance.ga(54)&&(U.a.instance.ga(59)||U.a.instance.ga(34))&&(a=Rd.KN.kBb(c),l.vC?(!l.jvm&&this.t1j(l.vC,a)&&2===l.vC.specialIndentType&&(l.vC.specialIndentType=0),l.vC.E4c===a.E4c&&qf.a.cA(l.vC.eP,a.eP)||(l.vC.eP=Number.MAX_VALUE),l.vC.G4c===a.G4c&&qf.a.cA(l.vC.ZCb,a.ZCb)||(l.vC.ZCb=Number.MAX_VALUE)):l.vC=a,b=Rd.Dn.eQf(b.GF),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==
b&&(b=eS.WordSectionNavigator.instance.dSe(b),void 0!==b&&null!==b&&(b=Rd.qjf.vva(b)-(Rd.qjf.Pie(b)+Rd.qjf.Qie(b)+ad.App.dpm),a.F4c=b-a.eP,a.D4c=b-a.ZCb,l.vC.D4c=Math.min(l.vC.D4c,a.D4c),l.vC.F4c=Math.min(l.vC.F4c,a.F4c)))));if(U.a.instance.ga(54)&&U.a.instance.ga(59)||U.a.instance.ga(84))b=Rd.Cwk.dY(c),l.spacing?(l.spacing.Rr=Rd.HMf(b.Rr,l.spacing.Rr),l.spacing.Pr=Rd.HMf(b.Pr,l.spacing.Pr),l.spacing.lineSpacing.unit===b.lineSpacing.unit&&qf.a.cA(l.spacing.lineSpacing.value,b.lineSpacing.value)||
(l.spacing.lineSpacing.unit=0,l.spacing.lineSpacing.value=0)):l.spacing=b;b=new mb.GraphIterator;b.set(c);b.uc(11);if(c=b.Ug(11))l.isRtl=ge.OutlineElementReader.kn(c);c=Rd.eg.Aw(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=Rd.tyj(l.listType,b);l.oV=16===l.listType?null:c;return 32}t1j(a,b){return this.vPf(a,b)||this.vPf(b,a)}vPf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}Qnl(a,b,c,f,l){a=jb.OutlineElementNavigator.qC(b.node);l.isRtl=ge.OutlineElementReader.kn(a);
return 32}fPf(a,b,c){if(a===G.a.E3a)a=!0;else if(a===G.a.GNa)a=!1;else return 2;a&&this.PAe(b);if(1===c)return 32;b=jb.OutlineElementNavigator.qC(b.node);Rd.zi.DNa(b,a);return 32}Gnl(a,b,c,f,l){a=b.node;b=jb.OutlineElementNavigator.qC(a);l.isRtl=ge.OutlineElementReader.isRtl(b);l.tm=vb.ImageReader.zM(a);return 32}yol(a,b,c,f,l){a=b.node;b=jb.OutlineElementNavigator.qC(a);l.isRtl=ge.OutlineElementReader.isRtl(b);l.tm=Jd.TableReader.zM(a);if(-1===l.tm||0===l.tm)l.tm=l.isRtl?3:1;return 32}ePf(a,b,c){var f=
oh.MPh(c,b);({yG:c}=f);if(!f.returnValue)return c;c=b.node;switch(a){case G.a.GNa:case G.a.E3a:c=jb.OutlineElementNavigator.qC(c),f=!0,a===G.a.GNa&&(f=!1),Rd.zi.DNa(c,f),f&&this.PAe(b)}return 32}w0d(a,b,c,f,l){let u;var I=oh.yXl(c,b);({yG:u}=I);if(!I.returnValue)return u;I=b.node;switch(a){case G.a.GNa:Rd.zi.yRb(I,!1);break;case G.a.E3a:this.PAe(b);Rd.zi.yRb(I,!0);break;case G.a.tW:u=A.AFrameworkApplication.Pa.Ai(b.GF,a,c,!0,f,l),32===u&&$a.ParagraphReader.jn(b)&&Rd.Ttc&&Rd.Ttc.lT(I)}return 32}$Ti(a,
b,c,f,l){const u={};u[Oi.Fra]=6168;u[Oi.Era]=6169;var I=b.view;const T=new pg.GraphTransaction(1===c?3:15);T.rd(I.root);let ja=Oi.x7(a,b,c,f,l,u,0),ua=null;I.Wp&&(ua=I);I=!0;let Ra=null;ua&&(Ra=ua.Rb.Oa.kb)&&U.a.instance.ga(14)&&(Rd.Jj.Dxe(Ra)?(Rd.fd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),ja=8,I=!1):1===c&&(ja=32,I=!1));I&&this.krk(Ra)&&(ja=U.a.instance.ga(54)?Oi.x7(G.a.H$a,b,c,f,l,u,12):Oi.x7(a,b,c,f,l,u,12));T.dispose();return ja}ZTi(a,b,c){a=!0;b.contextId!==ta.a.paragraph&&b.contextId!==ta.a.Xf?a=!1:
U.a.instance.ga(14)&&Rd.Jj.RHa(b)&&(Rd.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),a=!1);if(1===c||!a)return a?32:8;b=b.node;c=new pg.GraphTransaction(15);c.rd(b);Rd.hs.Exb(b);Rd.paragraphEditor.C5b(b,!0);Rd.zQ.PRc(b);c.dispose();return 2}kOb(a,b,c,f,l){a=b.contextId===ta.a.paragraph;if(1===c&&!a)return 8;l.vC||(b=b.node,c=Rd.KN.kBb(b),l.vC=c,c=new mb.GraphIterator,c.set(b),c.uc(11),b=c.Ug(11),l.isRtl=b?ge.OutlineElementReader.kn(b):!1);return 32}krk(a){return!a||Bc.SelectionEditor.uy(a)||1===a.length&&Bc.SelectionEditor.Tk(a.Ua)&&
!Bc.SelectionEditor.TDb(a.Ua)?!1:!0}PAe(a){Rd.zEf.Ib(a.contextId)||(da.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",a.contextId),Rd.zEf.$(a.contextId,!0))}wfk(a){return a===G.a.Z4b||a===G.a.nxb||a===G.a.oxb||a===G.a.y$a||a===G.a.$4b}qRc(a,b){const c=a.node;b=Rd.M9l(c.characterData.substr(a.Ra,a.Pb-a.Ra),b);c.characterData=c.characterData.substr(0,a.Ra)+b+c.characterData.substr(a.Pb);return 32}static get Eh(){return Rd.Sf||(Rd.Sf=Tb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Rd.Ch||
(Rd.Ch=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Rd.hy||(Rd.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}static get Cwk(){return Rd.SQa||(Rd.SQa=Tb.a.instance.resolve("Box4.ILineSpacingHelper"))}static get zQ(){return Rd.YL||(Rd.YL=Tb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get zi(){return Rd.Rj||(Rd.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return Rd.Eu||(Rd.Eu=Tb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get hga(){return Rd.atb||
(Rd.atb=Tb.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get KN(){return Rd.JH||(Rd.JH=Tb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Yr(){return Rd.yn||(Rd.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static get Dn(){return Uh.ContextSetEditor.instance}static get Jj(){return mi.a.instance}static get fd(){return jd.a.instance}static get Re(){return Rd.kd||(Rd.kd=Tb.a.instance.ub("Box4.IFeatureHelper"))}static get Ttc(){return ad.App.tT}static get kg(){return Rd.zd||
(Rd.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g8(){return Rd.Pp||(Rd.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get cef(){return Rd.$Ra||(Rd.$Ra=Tb.a.instance.resolve("Box4.TextFormattingHelper"))}static get eg(){return Rd.qh||(Rd.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static get hs(){return Rd.ir||(Rd.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}static get qjf(){return fS.a.instance}static tyj(a,
b){return 42===a?b:a!==b||16===a?16:a}static HMf(a,b){a.LAg||(b.LAg?b=a:b.unit===a.unit&&qf.a.cA(b.value,a.value)||(b.value=-1));return b}static M9l(a,b){switch(b){case G.a.nxb:return a.toLowerCase();case G.a.oxb:return a.toUpperCase();case G.a.Z4b:case G.a.y$a:return Rd.nRi(a,b===G.a.y$a);case G.a.$4b:return Rd.xam(a);default:return a}}static xam(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static nRi(a,
b){let c,f,l=!0,u=a.length,I=0,T=Rd.aye(a,I,u);for(;0<u;){f=c=!1;var ja=u;let Ra;var ua=void 0;for(ua=0;0<ja&&Rd.bTi(a.charAt(I+ua));ua++,ja--)f=Rd.Q8c(a.charAt(I+ua));for(Ra=ua;0<ja&&!(c=Rd.Q8c(a.charAt(I+ua)))&&" "!==a.charAt(I+ua)&&"/"!==a.charAt(I+ua);ua++,ja--);ja=ua-Ra;if(0>=ja)break;I+=Ra;ua=a.substr(I,ja);ua=ua===ua.toUpperCase();if(T||!ua)a=l||f||b?a.substr(0,I)+a.charAt(I).toUpperCase()+a.substr(I+1,ja-1).toLowerCase()+a.substr(I+ja):a.substr(0,I)+a.substr(I,ja).toLowerCase()+a.substr(I+
ja);u-=ja+Ra;I+=ja;if(l=c)I++,u--,T=Rd.aye(a,I,u)}return a}static aye(a,b,c){for(;0<c&&!Rd.Q8c(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static erk(a){for(var b=0;b<a.length&&!Rd.Q8c(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static Q8c(a){return"."===a||"!"===a||"?"===a?!0:!1}static bTi(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}Rd.Sf=null;Rd.Rj=null;Rd.zEf=new al.a;Rd.$f=null;Rd.SQa=null;
Rd.Ch=null;Rd.hy=null;Rd.YL=null;Rd.Eu=null;Rd.atb=null;Rd.JH=null;Rd.yn=null;Rd.kd=null;Rd.zd=null;Rd.Pp=null;Rd.$Ra=null;Rd.qh=null;Rd.ir=null;Object(m.a)(Rd,"TextFormattingActor",null,[]);class sK{constructor(a){this.Ca=a}get zn(){return this.Ca}bRb(a,b){this.zn.Ai(a,G.a.keb,2,!0,null,void 0===b?!1:b)}tW(a){this.zn.Ia(G.a.tW,2,a)}}Object(m.a)(sK,"TextFormattingCommands",null,[1826]);class av{get Fra(){return Oi.Fra}get Era(){return Oi.Era}get TUb(){return Oi.TUb}x7(a,b,c,f,l,u,I){return Oi.x7(a,
b,c,f,l,u,I)}mlb(a,b,c,f,l,u){return Oi.mlb(a,b,c,f,l,u)}static get instance(){av.Ja||(av.Ja=new av);return av.Ja}}av.Ja=null;Object(m.a)(av,"ViewActionHandlerProxy",null,[1834]);class tK{constructor(a){this.Ca=a}get zn(){return this.Ca}JYk(a){if(4===a)a=G.a.leftArrow;else if(2===a)a=G.a.rightArrow;else if(1===a)a=G.a.upArrow;else if(3===a)a=G.a.downArrow;else return;this.zn.nb(a,2)}Jua(){this.zn.nb(G.a.Jua,2)}}Object(m.a)(tK,"SelectionCommands",null,[1825]);class uK{fh(a,b){return $d.SelectionFactory.fh(a,
b)}PO(a,b){return $d.SelectionFactory.PO(a,b)}Dv(a,b){return $d.SelectionFactory.Dv(a,void 0===b?!0:b)}U4(a,b,c){return $d.SelectionFactory.U4(a,b,c)}Nl(a){return $d.SelectionFactory.Nl(a)}YTb(a,b,c){return $d.SelectionFactory.YTb(a,b,void 0===c?!1:c)}}Object(m.a)(uK,"SelectionFactoryProxy",null,[1813]);var gS=d(906),bz=d(253),wB=d(1046);class vK extends wB.a{constructor(a,b,c,f,l,u,I,T){T=void 0===T?null:T;super(a,u,void 0===I?null:I,T);this.Yo=this.hy=null;this.msa=!1;this.A6a=A.AFrameworkApplication.fa.getBooleanAppSetting("FollowDestinationFormattingPasteIsEnabled");
this.I7a=0;this.xWd=new La.a;Qf.a(8128527,307,ge.OutlineElementReader.vh(a));this.vG=b;this.vG.ywb(this);this.zNd=c;this.ir=f;this.qh=l;this.Kfl=T;this.MSd=Kc.ListReader.hl(this.Cb)}get paragraphEditor(){return this.hy||(this.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}get cUa(){return null}get bab(){return this.MSd&&!this.vG.Jea}get uab(){return 0<this.I7a}get Cw(){return this.zNd}get hs(){return this.ir}get eg(){return this.qh}get eQc(){return this.Kfl}K2(a,b){if(!this.N_.agf(b)){Qf.a(8701077,
307,$a.ParagraphReader.Pl(this.Cb));var c=this.Cb.currentNode,f=me.a.STa(c);this.A6a&&this.Yo.Jbb&&(c=c.Sa.last,this.msa&&(c.formatting=this.Yo.Jbb.le(c),this.msa=!1),a=this.N_.Ume(a,b),this.N_.Sqa(this.Cb.currentNode,this.Yo.Tha,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}Ppa(){Qf.a(8701078,307,$a.ParagraphReader.Pl(this.Cb));const a=me.a.STa(this.Cb.currentNode);this.characterPropertiesEditor.X4c(a,b=>new Mw.a(b,Mw.a.KUc),Vg.AParagraphNode.P0)}p1a(){}Npa(){this.A6a&&(this.msa=!0)}Xya(){Qf.a(8701079,
307,$a.ParagraphReader.Pl(this.Cb))}Wya(){Qf.a(8701080,307,$a.ParagraphReader.Pl(this.Cb))}zB(a){this.vG.Jea||(this.A6a?(this.g0d(a),this.Yo.SDd(this.Cb.currentNode),a&&"P"===a.$V.bdc&&this.eQc.BNa(this.Cb.currentNode,this.Yo.Pqd),this.N_.Sqa(this.Cb.currentNode,this.Yo.Tha,a)):this.UHi(a))}yB(){this.vG.Jea||this.d5()}bza(){}LLa(){}Spa(){Qf.a(8701081,307,ge.OutlineElementReader.vh(this.Cb)||Bj.OutlineReader.Wu(this.Cb)||$a.ParagraphReader.Pl(this.Cb)&&this.vG.Jea);let a=!1;this.uab||(a=this.bab||
!0);a||(this.NN+=1);this.I7a++}Qpa(){this.I7a--;let a=!1;this.uab||(a=this.bab||!0);a||--this.NN}aza(a){Qf.a(8701082,307,ge.OutlineElementReader.vh(this.Cb)||Bj.OutlineReader.Wu(this.Cb)||$a.ParagraphReader.Pl(this.Cb)&&this.vG.Jea);Qf.a(8701083,307,0!==a.listStyleType)}Rpa(){Qf.a(8701084,307,ge.OutlineElementReader.vh(this.Cb)||$a.ParagraphReader.Pl(this.Cb)&&this.vG.Jea);this.vG.Jea||Qf.a(8701085,307,this.Cb.gK(2))}SZ(a){this.vG.SZ(a)}PZ(){this.vG.PZ()}BDd(a){this.xWd.add(a)}RZ(a){this.vG.RZ(a)}QZ(){this.vG.QZ()}OZ(a){this.vG.OZ(a)}NZ(){this.vG.NZ()}UHi(a){this.tLb(!1);
(new mb.GraphIterator).Uc(this.Cb);a=wB.a.zi.Fea(this.Cb,this.YVa(a));Qf.a(8128534,307,a===this.Cb.currentNode);Qf.a(8128535,307,$a.ParagraphReader.ke(a))}d5(){Qf.a(8128536,307,$a.ParagraphReader.Pl(this.Cb));jb.OutlineElementNavigator.$e(this.Cb)}reset(){this.A6a&&(super.reset(),this.Yo=this.Zge(!0))}g0d(a){this.tLb(!1);(new mb.GraphIterator).Uc(this.Cb);a=wB.a.zi.Fea(this.Cb,this.YVa(a));Qf.a(36577367,307,a===this.Cb.currentNode);Qf.a(36577368,307,$a.ParagraphReader.ke(a));-1!==this.Yo.oF&&this.paragraphEditor.kL(a,
this.Yo.oF);this.Yo.lineSpacing&&this.eQc.j_(a,this.Yo.lineSpacing);this.Yo.Fia&&this.eQc.DNh(a,this.Yo.Fia);this.Yo.q$c&&this.eQc.tMh(a,this.Yo.q$c);this.msa=!0;this.Yo.paragraph=a}static Z6d(a,b){let c=0;switch(b){case 3:c=Re.a.Sva(a);break;case 7:c=Ad.a.Wha(a,0);break;case 1:c=Re.a.b4d(a);break;case 5:c=Re.a.Sva(Re.a.Qrd(a));break;default:da.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(m.a)(vK,"TextOnlyBox4PasteSteward",
wB.a,[]);class tE{constructor(a,b,c,f){this.B_b=a;this.ir=b;this.qh=c;this.N_=f}create(a,b,c,f,l,u){l=void 0===l?null:l;u=void 0===u?null:u;return 1===a?new vK(b,f,this.B_b,this.ir,this.qh,l,u,this.N_):new bz.Box4PasteSteward(b,c,f,this.B_b,this.ir,this.qh,l,u,this.N_)}}Object(m.a)(tE,"Box4PasteStewardFactory",null,[1835]);class Bh{static get E5j(){return Bh.Afi}static get K5j(){return Bh.Dfi}static get J5j(){return Bh.Cfi}static Qll(a,b){const c=a.currentNode;ce.forEachCell(a,b.rowSpan,b.colSpan,
(f,l,u)=>{const I=f.currentNode;I!==c&&(I.isGhostCell=!0,Bh.T4f(f),!u&&1<=b.colSpan&&(I.colSpan=b.colSpan),Bh.YLh(f,b.Y7,l,u,b.rowSpan,b.colSpan))})}static jml(a,b){ce.forEachCell(a,b.rowSpan,b.colSpan,c=>{Bh.UEi(c);Bh.T4f(c)})}static UEi(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.pob=!0}static T4f(a){a&&(a.Gb(1),Object(gc.a)(UJ.a,a.currentNode)&&a.rj())}static kFi(a,b,c){0<b&&(a=Object(gb.a)(az.TableCellNode,a.currentNode))&&(a.width=c?b:Ad.a.Cf(b,0))}static uEi(a,b,c){if(a=Object(gb.a)(Hr.a,
a.currentNode))0<b&&(a.Sm=Ad.a.Wha(b,0)),0<c&&(a.VZ=Ad.a.Wha(c,0))}static iPf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(ib.a.ldf,Bh.K5j[b+""])}static UOf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(rb.a.Y4b,parseInt(bz.Box4PasteSteward.dab(b),16))}static TQj(a){const b=new mb.GraphIterator;b.Uc(a);return(a=Pg.OutlineNavigator.owd(b))&&Bj.OutlineReader.Wu(b)?a.$h(ib.a.RS)-a.$h(ib.a.marginLeft)-a.$h(ib.a.marginRight):0}static Yok(a){return!(void 0===a||null===
a||1===a)}static IOl(a,b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=Re.a.Prd(.25);break;case "initial":case "medium":b=Re.a.Prd(.5);break;case "thick":b=Re.a.Prd(1);break;default:b=Bh.MNj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static u7e(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,Bh.J5j[b+""])}static HOl(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(bz.Box4PasteSteward.dab(b),16))}static MNj(a,b,c){let f=
0;var l=bz.Box4PasteSteward.Zqd(a);({unit:a}=l);l=l.returnValue;switch(a){case 5:f=Re.a.Prd(l);break;case 1:f=Re.a.VQi(l);break;case 3:f=Re.a.Wwg(l);break;case 7:f=Ad.a.cgl(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static NNj(a,b){let c=0;var f=bz.Box4PasteSteward.Zqd(a);({unit:a}=f);f=f.returnValue;switch(a){case 5:c=Re.a.WI(f);break;case 1:c=Re.a.WQi(f);break;case 3:c=Re.a.gY(f);break;case 7:c=Ad.a.Cf(f,b)}return c}static syd(a,b,c,f,l,u,I){if(l&&(!I||16===l.Zi||I||14!==l.Zi)&&12!==
c){if(I)switch(f){case 7:f=ib.a.CWh;var T=ib.a.EWh;var ja=ib.a.DWh;var ua=0;break;case 6:f=ib.a.zWh;T=ib.a.BWh;ja=ib.a.AWh;ua=1;break;case 0:f=ib.a.pWh;T=ib.a.rWh;ja=ib.a.qWh;ua=0;break;case 5:f=ib.a.wWh;T=ib.a.yWh;ja=ib.a.xWh;ua=1;break;default:return}else switch(f){case 7:f=ib.a.q8l;T=ib.a.s8l;ja=ib.a.r8l;ua=0;break;case 6:f=ib.a.n8l;T=ib.a.p8l;ja=ib.a.o8l;ua=1;break;case 0:f=ib.a.h8l;T=ib.a.j8l;ja=ib.a.i8l;ua=0;break;case 5:f=ib.a.k8l;T=ib.a.m8l;ja=ib.a.l8l;ua=1;break;default:return}void 0!==l.currentNode&&
null!==l.currentNode&&(Bh.Yok(c)?(Bh.HOl(f,a,l),Bh.u7e(T,c,l),Bh.IOl(ja,b,c,ua,l)):u||I||l.currentNode.properties.setValue(T,"nil"))}}static YLh(a,b,c,f,l,u){f||(Bh.OOf(b,a,!1,!1),Bh.z0d(b,a,!0,!1));f===u-1&&Bh.z0d(b,a,!0,!1);c||Bh.gPf(b,a,!0,!1);c===l-1&&Bh.HOf(b,a,!0,!1)}static FOf(a,b,c,f){a&&(Bh.gPf(a,b,c,f),Bh.z0d(a,b,c,f),Bh.HOf(a,b,c,f),Bh.OOf(a,b,c,f))}static gPf(a,b,c,f){Bh.syd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static z0d(a,b,c,f){Bh.syd(a.borderRightColor,a.borderRightWidth,
a.borderRightStyle,6,b,c,f)}static HOf(a,b,c,f){Bh.syd(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static OOf(a,b,c,f){Bh.syd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static tyd(a,b,c){if(c&&16===c.Zi&&""!==a){switch(b){case 3:b=ib.a.fTb;var f=0;break;case 2:b=ib.a.eTb;f=1;break;case 0:b=ib.a.bTb;f=0;break;case 1:b=ib.a.cTb;f=1;break;default:return}(a=Bh.NNj(a,f))&&c.currentNode.properties.setValue(b,a)}}static eEi(a,b){b&&(Bh.fFi(b,a),Bh.PEi(b,a),Bh.fEi(b,
a),Bh.CEi(b,a))}static fFi(a,b){Bh.tyd(a.QQi,3,b)}static PEi(a,b){Bh.tyd(a.PQi,2,b)}static fEi(a,b){Bh.tyd(a.NQi,0,b)}static CEi(a,b){Bh.tyd(a.OQi,1,b)}}Bh.t_k=8;Bh.l$i="Table Grid";Bh.Afi=Qa.a.iJ("MsoNormalTable","Normal Table","MsoTableGrid",Bh.l$i,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light",
"MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3",
"Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4",
"Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3",
"MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5",
"Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6",
"Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1",
"MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5",
"MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2",
"List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3",
"MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4",
"MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");Bh.Dfi=Qa.a.iJ("0","center","1","top","2","center","3","bottom");Bh.Cfi=Qa.a.iJ("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(m.a)(Bh,"Box4TableStewardHelper",null,[]);class wK{constructor(a,b,c,f,l){this.ax=null;this.J7a=0;this.Cb=a;this.Lr=b;this.Eub=void 0===
c?!1:c;this.L_b=void 0===f?!1:f;this.JSd=void 0===l?!1:l}ywb(a){this.ax=a}get Jea(){return 0<this.J7a}SZ(a){Qf.a(7869459,307,!!this.ax);Qf.a(7869460,307,ge.OutlineElementReader.vh(this.Cb)||Bj.OutlineReader.Wu(this.Cb));Qf.c(38563978,307,50,"Table pasting started");this.ax.tLb(!0);const b=new mb.GraphIterator;b.Uc(this.Cb);Object(gb.a)(String,Bh.E5j[a.pVh]);const c=this.Lr.Cul(this.Cb,a.jW,a.Sta,this.ax.YVa(a),a.eAg);if(this.Eub&&(Qf.c(23938568,307,50,a.BTa?"Table-widths exist":"Table-widths missing, table may be invalid"),
a.idf&&Bh.FOf(a.idf,this.Cb,!1,!0),Bh.uEi(this.Cb,a.xpe.$3l,a.xpe.Z3l),a.BTa)){var f=0;const T=Array(a.BTa.length);var l=0;a.YHa&&U.a.instance.ga(63)&&(l=(l=Re.a.t0h(Bh.TQj(this.Cb)))?l:1);for(var u=0;u<a.BTa.length;u++)T[u]=0<l?l/100*a.BTa[u]:Ad.a.Cf(a.BTa[u],0),f+=T[u];l=c.$a(rb.a.Wv);var I=new mb.GraphIterator;I.Uc(this.Cb);a=0;if(se.isInTableCell(I)){if(l=ce.returnToContainingCell(I))a=l.width;u=vo.a(I);I=ce.returnToContainingTable(I);if(-1!==u&&u<=I.ETa.length){let ja=0;for(let ua=u;ua<u+l.colSpan&&
ua<I.ETa.length;ua++)ja+=I.ETa[ua];a=Math.min(a,ja);a===ja&&(a-=Ad.a.Cf(Bh.t_k,0))}}else if(l)for(u=0;u<l.length;u++)a+=l[u];if(0<a&&f>a&&f)for(f=a/f,a=0;a<T.length;a++)T[a]*=f;c.setValue(rb.a.Wv,T)}this.ax.wPc(b,!1);this.J7a++;U.a.instance.ga(63)&&Kc.ListReader.hl(b)&&this.ax.BDd(b.currentNode);Qf.a(7869461,307,Jd.TableReader.Nq(this.Cb))}PZ(){Qf.a(7869462,307,!!this.ax);Qf.a(7869463,307,Sk.l(this.Cb));Qf.c(38563979,307,50,"Table pasting finished");jb.OutlineElementNavigator.$e(this.Cb);this.J7a--}RZ(a){Qf.a(7869464,
307,!!this.ax);Jd.TableReader.Nq(this.Cb)?ce.moveToFirstRow(this.Cb):Sk.l(this.Cb)&&ce.moveToNextRow(this.Cb);this.Eub&&a.height&&this.Cb.currentNode.setValue(ib.a.wv,Ad.a.Cf(a.height,1));Qf.a(7869465,307,Sk.l(this.Cb))}QZ(){Qf.a(7869466,307,!!this.ax);Qf.a(7869467,307,se.isTableCell(this.Cb));ce.returnToContainingRow(this.Cb)}OZ(a){Qf.a(7869468,307,!!this.ax);Qf.a(7869469,307,!this.ax.NN);Sk.l(this.Cb)?ce.moveToFirstColumn(this.Cb):se.isTableCell(this.Cb)?ce.moveToNextColumn(this.Cb):Qf.a(7869471,
307,!1);if(this.L_b){if(!this.Cb.currentNode)return;var b=Object(gb.a)(az.TableCellNode,this.Cb.currentNode);Qf.a(50689760,307,!b&&16!==this.Cb.currentNode.type||!!b&&16===this.Cb.currentNode.type);if(!b)return;const c=new mb.GraphIterator;c.Uc(this.Cb);if(!a.colSpan||!a.rowSpan)return;if(a.VEb){Bh.jml(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=ce.returnToContainingTable(c);if(!f)return;f.setValue(ib.a.complexTable,!0);c.Uc(this.Cb);Bh.Qll(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.Eub&&
(Bh.UOf(this.Cb,a.Yxc),Bh.iPf(this.Cb,a.verticalAlignment),this.JSd&&Bh.eEi(this.Cb,a.nCd));this.L_b&&Bh.FOf(a.Y7,this.Cb,!a.colSpan&&!a.rowSpan,!1);this.Eub&&(this.L_b||(b=new mb.GraphIterator,b.Uc(this.Cb),ce.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{Bh.UOf(c,a.Yxc);Bh.iPf(c,a.verticalAlignment);Bh.YLh(c,a.Y7,f,l,a.rowSpan,a.colSpan)})),Bh.kFi(this.Cb,a.width,a.YHa));Qf.a(7869472,307,Bj.OutlineReader.Wu(this.Cb))}NZ(){Qf.a(7869473,307,!!this.ax);Qf.a(7869474,307,ge.OutlineElementReader.vh(this.Cb)||
se.isTableCell(this.Cb));ce.returnToCell(this.Cb);Qf.a(7869475,307,0>=this.ax.NN);this.ax.S4d()}}Object(m.a)(wK,"Box4TableSteward",null,[1831,1832]);class bv{constructor(a,b){this.ax=null;this.J7a=0;this.Cb=a;this.Lr=b}ywb(a){this.ax=a}get Jea(){return 0<this.J7a}SZ(){this.Jea&&(Qf.a(8787101,307,$a.ParagraphReader.Pl(this.Cb)),jb.OutlineElementNavigator.$e(this.Cb));Qf.a(8701086,307,!!this.ax);Qf.a(8701087,307,ge.OutlineElementReader.vh(this.Cb)||Bj.OutlineReader.Wu(this.Cb));this.J7a++}PZ(){Qf.a(8701088,
307,!!this.ax);jb.OutlineElementNavigator.$e(this.Cb);this.J7a--;if(this.Jea){this.ax.tLb(!0);const a=bv.zi.Fea(this.Cb);Qf.a(8787102,307,a===this.Cb.currentNode);Qf.a(8787103,307,$a.ParagraphReader.Pl(this.Cb))}}RZ(a){Qf.a(8701089,307,!!this.ax);this.ax.tLb(!0);const b=new mb.GraphIterator;b.Uc(this.Cb);this.ax.wPc(b,!1);U.a.instance.ga(63)&&Kc.ListReader.hl(b)&&this.ax.BDd(b.currentNode);a=bv.zi.Fea(this.Cb,this.ax.YVa(a));Qf.a(8701090,307,a===this.Cb.currentNode);Qf.a(8701091,307,$a.ParagraphReader.Pl(this.Cb))}QZ(){Qf.a(8701120,
307,!!this.ax);Qf.a(8701121,307,$a.ParagraphReader.Pl(this.Cb));jb.OutlineElementNavigator.$e(this.Cb)}OZ(){Qf.a(8701122,307,!!this.ax);Qf.a(8701123,307,$a.ParagraphReader.Pl(this.Cb));Qf.a(8701124,307,!this.ax.NN);var a=this.Cb.currentNode;$a.ParagraphReader.textLength(a)&&(a=me.a.STa(a),this.ax.characterPropertiesEditor.replaceTextRange(a,", "))}NZ(){Qf.a(8701125,307,!!this.ax);Qf.a(8701126,307,$a.ParagraphReader.Pl(this.Cb));Qf.a(8701127,307,0>=this.ax.NN);this.ax.S4d()}static get zi(){return bv.Rj||
(bv.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}}bv.Rj=null;Object(m.a)(bv,"TextOnlyBox4TableSteward",null,[1831,1832]);class uE{constructor(a,b,c,f){this.EJ=a;this.Eub=void 0===b?!1:b;this.L_b=void 0===c?!1:c;this.JSd=void 0===f?!1:f}create(a,b){return 1===a?new bv(b,this.EJ):new wK(b,this.EJ,this.Eub,this.L_b,this.JSd)}}Object(m.a)(uE,"Box4TableStewardFactory",null,[1808]);class xK{create(){return new ko.a}}Object(m.a)(xK,"Factory",null,[1814]);var vE=d(1120);class yK{constructor(){this.srd=
null;this.hXe=0}}Object(m.a)(yK,"PasteFloatieAnchorData",null,[]);class zK extends Er{constructor(a,b){super(a,b)}G$b(){return["PasteText"]}}Object(m.a)(zK,"PasteTextFloatie",Er,[]);class AK{constructor(a,b,c,f,l,u,I){this.YZg=0;this.mKe=this.d_a=this.Mkd=!1;this.yHk=100;this.QMi=61;this.YNi="PasteTextControl";this.KNi='[id*="PasteTextFloatie"]';this.GNi=86;this.j0l=(T,ja)=>{this.kz()&&this.showFloatie(ja)};this.tcj=(T,ja)=>{this.$E(ja)};this.Ijj=()=>{this.U$f()};this.him=(T,ja)=>{(null===ja||void 0===
ja?0:ja.Fyc)&&this.s2h()};this.amh=()=>{vE.a.instance.keyCode===H.a.Pca&&this.U$f()};this.e3=()=>{!this.d_a&&this.j6&&this.j6.isVisible&&this.t9i()};this.onSelectionChange=()=>{this.i1()||this.$E(new Ka(!0))};this.K=a;this.hB=b;this.xTk=c;this.rhd=f;this.oa=l;this.did=u;this.Yb=I}get XR(){return this.YZg}set XR(a){this.YZg=a}get hwa(){return!this.d_a&&this.j6&&this.j6.isVisible}Rxl(){this.rhd.Izi(this.j0l);this.rhd.Oyi(this.tcj);this.rhd.Uyi(this.Ijj);this.rhd.nzi(this.him)}Sxl(){this.Mkd||(this.oa.AG(this.onSelectionChange),
this.Yb.Qp.v9(this.e3),this.did.a_d(this.amh),this.Mkd=!0)}jgm(){this.Mkd&&(this.oa.y3e(this.onSelectionChange),this.Yb.Qp.VMa(this.e3),this.did.BBl(this.amh),this.Mkd=!1)}getName(){return"TextPaste"}JZ(a){2===a.behavior&&(a=a.actionId,a===G.a.bold||a===G.a.centerJustify||a===G.a.Jr||a===G.a.fT||a===G.a.uea||a===G.a.setItalic||a===G.a.leftJustify||a===G.a.$q||a===G.a.rH||a===G.a.OG||a===G.a.strikethrough||a===G.a.rightJustify||a===G.a.fullJustify||a===G.a.underline||a===G.a.My||a===G.a.lC||a===G.a.qL||
a===G.a.aO||a===G.a.subscript||a===G.a.superscript||a===G.a.font||a===G.a.paste||a===G.a.O2)&&(this.Yb.Qp.yve||this.$E(new Ka(!0)))}IZ(){}showFloatie(a){this.j6||(this.j6=new zK(this.K.resolve("Common.IReactContextualUILauncher"),this.K.resolve("Common.IExternalUICommandDefinitionMapping")));if((this.d_a||!this.j6.isVisible)&&a){var b=a.location?a.location:this.fBb();b&&(this.j6.N$e(b,a.Gv),this.Sxl(),this.d_a=!1)}}$E(a){this.j6&&(!this.d_a||this.j6.isVisible)&&a&&(this.j6.$E(),this.d_a=!0,a.Dde&&
(this.XR=null,this.jgm()))}fBb(){var a=this.bIj();if(!a||!a.srd)return null;var b=this.hB.$d;if(!b)return null;a=this.LCj(a,b);if(!a)return null;A.AFrameworkApplication.isRtl&&(b=this.rjg(),a.x-=b?b.width:this.GNi);return new Sys.UI.Point(a.x+a.width,a.y+a.height)}bIj(){var a;if(!this.oa||!this.oa.Oa||!this.oa.Oa.kb)return null;var b=this.oa.Oa.kb.Ua;const c=!b.Ra&&!b.Pb;let f=b.node;if(f&&c){do f=this.RIj(f);while(f&&f instanceof Vg.AParagraphNode&&(null===(a=f.characterData)||void 0===a||!a.trim().length))
}let l="";(a=f)&&a.characterData&&(l=a.characterData.length===b.Ra||c?a.characterData.trimEnd():a.characterData.substring(0,b.Ra).trimEnd());b=a&&a.characterData?l.length:b.Ra;return Object.assign(new yK,{srd:a?a:f,hXe:b})}RIj(a){const b=new mb.GraphIterator;if(!a.anchor)return null;b.set(a);if(!b.wf())return null;b.Ug(11);return b.Gva()?b.Gb(2):null}rjg(){const a=document.getElementById(this.YNi);if(!a)return null;const b=a.style.visibility,c=a.style.display;a.style.visibility="hidden";a.style.display=
"";const f=Sd.a.wi(a);a.style.display=c;a.style.visibility=b;return f}LCj(a,b){b=a.srd.vg(b.Na);if(!b)return null;let c=null;if(a.srd instanceof Vg.AParagraphNode){if(!b)return null;try{c=this.xTk.AX(a.hXe,b,0<a.hXe,!1,!1,!1),c.height+=this.QMi}catch(f){c=null}}c||(c=b.getBounds());return c}U$f(){if(!this.d_a&&this.j6&&this.j6.isVisible){var a=document.querySelector(this.KNi);a&&(a.getAttribute(Qe.a.P9a)||"")===Qe.a.Xka&&a.click()}}i1(){return this.kz()&&(Bc.SelectionEditor.Vu(this.oa.Oa.kb.Ua)||
this.oa.Oa.kb.Ua.contextId===ta.a.paragraph||this.oa.Oa.kb.Ua.contextId===ta.a.endOfParagraph)}kz(){if(!this.oa.Oa||!this.oa.Oa.kb)return!1;const a=this.oa.Oa.kb;return!!a&&a.Ua.contextId!==ta.a.outline&&!(a.Ua.contextId===ta.a.notes||this.I$(a.Ua.node))}I$(a){if(!a.anchor)return!1;const b=new mb.GraphIterator;b.set(a);return b.uc(60)}t9i(){if(!this.mKe){const a=new ne.a(3,1,this.yHk,()=>{this.s2h();this.mKe=!1},215);ln.a.instance.Jb(a);this.mKe=!0}}s2h(){!this.d_a&&this.j6&&this.j6.isVisible&&(this.$E(new Ka(!1)),
this.showFloatie(new tk(1,A.AFrameworkApplication.isRtl)))}}Object(m.a)(AK,"TextPasteFloatieManager",null,[1809,182]);class BK{fc(a){a.register(tE,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().na(()=>new tE(ut.a.wBb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(VD,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().na(()=>new VD(A.AFrameworkApplication.fa.getBooleanAppSetting("WacPasteBrAsNewParagraphIsEnabled")));
a.register(mJ.ClipboardActor,"Box4.Actors.ClipboardActor").ma().na(()=>new mJ.ClipboardActor(a.ze("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),jd.a.instance,a.resolve("Box4.IClipboardDataHelper"),Me.a.instance,A.AFrameworkApplication.Pa,a.resolve("Box4.IUndoManager"),A.AFrameworkApplication.fa));a.register(1809,"Box4.ITextPasteFloatieManager").ma().na(()=>new AK(a,a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.ITextMetricsAdapter"),a.resolve("Box4.IPasteFloatieEventHandler"),
Me.a.instance,a.resolve("Common.PressOnlyKeyEvent"),ad.App.Ob.ie));a.register(237,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().na(()=>new RC(A.AFrameworkApplication.fa));a.register(1810,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().na(()=>new kK(A.AFrameworkApplication.fa,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),Id.a.instance));a.register(1811,"Box4.Clipboard.ISystemClipboardAccessManager").ma().na(()=>
a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(1812,"Box4.Actors.ISystemClipboard").ma().na(()=>new gK(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Ha.InteractiveViewManager.instance,ad.App.Ob.ie,F.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),Id.a.instance));a.register(1758,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>new pJ);a.register(1759,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>
new lK);a.register(1813,"Box4.ISelectionFactory").ma().na(()=>new uK);a.register(1814,"Box4.IRenderOrderGraphIteratorFactory").ma().na(()=>new xK);a.register(1815,"Common.IDomElementContentStateFactory").ma().na(()=>new UI);a.register(1816,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().na(()=>new BJ(Me.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),U.a.instance.ga(71)));a.register(oE,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().na(()=>new oE(a.resolve("Box4.IClipboardDataHelper"),
ad.App.WE.zU));a.register(1817,"Box4.Actors.IClipboardOperationPasteFactory").ma().na(()=>new zJ(jd.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),cd.a.instance,Me.a.instance,A.AFrameworkApplication.Pa,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.ze("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(1744,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new oJ(A.AFrameworkApplication.Pa,jd.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),Me.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),cg.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),Id.a.instance,a.resolve("Box4.IEditingDomManager")));a.register(1818,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().na(()=>new nJ(jd.a.instance,Id.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),A.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(1819,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().na(()=>new EJ(A.AFrameworkApplication.fa));
a.register(1820,"Box4.Actors.IClipboardOperationFactory").ma().na(()=>new xJ(a.resolve("Box4.Actors.InternalClipboard"),A.AFrameworkApplication.Pa,A.AFrameworkApplication.uAd()&&!(E.a.gV&&A.AFrameworkApplication.fa.getBooleanAppSetting("ElectronClipboardAccessFix")),jd.a.instance,cg.a.instance,Id.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),
a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(1821,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().na(()=>new PJ(a.ze("Box4.Actors.IBox4PasteStewardFactory"),
a.ze("Box4.Actors.IBox4ImageStewardFactory"),a.ze("Box4.Actors.IBox4TableStewardFactory"),a.ze("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));a.register(Ci,"Box4.Actors.InternalClipboard").ma().na(()=>new Ci(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),
a.resolve("Box4.List.IListEditor"),ad.App.BQ,a.resolve("Box4.IParagraphIndentationReader"),A.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").QKh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(1822,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().na(()=>
new bK(a.resolve("Box4.Actors.InternalClipboard"),new Hc.a(()=>ad.App.Ob.ie.yo)));a.register(1823,"Box4.List.IListCommands").ma().na(()=>new mK(A.AFrameworkApplication.Pa));a.register(Gs,"Box4.Actors.PasteCoordinator").ma().na(()=>new Gs(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));U.a.instance.ga(78)||a.register(uE,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>
new uE(Tb.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PasteComplexTablesIsEnabled"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PasteTableCellMarginImprovementsIsEnabled")));a.register(gE,"Box4.Actors.ClipboardOperationWordStrategy").ma().na(()=>new gE(jd.a.instance,Me.a.instance,ad.App.ni,mi.a.instance,U.a.instance.ga(14),
U.a.instance.ga(50)));a.register(dE,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().na(()=>new dE(A.AFrameworkApplication.fa));a.register(1824,"Box4.Actors.IExternalPasteCssConverter").ma().na(()=>new FJ(A.AFrameworkApplication.fa));a.register(1825,"Box4.ISelectionCommands").ma().na(()=>new tK(A.AFrameworkApplication.Pa));a.register(1826,"Box4.ITextFormattingCommands").ma().na(()=>new sK(A.AFrameworkApplication.Pa));a.register(TD,"Box4.Actors.AccessibilityActor").ma().na(()=>
new TD(a.Ha("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(jr,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().na(()=>new jr(a.ub("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));a.register(rE,"Box4.Actors.ProofingActor").ma().na(()=>new rE(Tb.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),A.AFrameworkApplication.Pa,()=>Tb.a.instance.resolve("Box4.UI.ILanguageDialog"),
Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Tb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Me.a.instance,Tb.a.instance.Ha("Box4.IExternalSelectionManager"),cg.a.instance,Tb.a.instance.resolve("Box4.ISelectionContextMenuProvider"),mi.a.instance,jd.a.instance,Tb.a.instance.resolve("Box4.IContextMenuController"),Tb.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Tb.a.instance.Ha("Box4.Actors.IProofingErrorPresenter"),U.a.instance));a.register(sE,"Box4.Actors.StyleActor").ma().na(()=>
new sE(Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Tb.a.instance.resolve("Box4.Styles.IStyleEditor"),gS.a.instance,Tb.a.instance.resolve("Box4.IFormattingEditor"),Uh.ContextSetEditor.instance,Tb.a.instance.resolve("Box4.IInsertionPointFormatting"),mi.a.instance,jd.a.instance,Tb.a.instance.resolve("Box4.TextFormattingHelper"),av.instance));a.register(Rd,"Box4.Actors.TextFormattingActor").ma().na(()=>new Rd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),
a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),Ha.InteractiveViewManager.instance));a.register(UD,"Box4.Actors.AutoCorrectActor").ma().na(()=>new UD(A.AFrameworkApplication.Pa,jd.a.instance,()=>Tb.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(m.a)(BK,"Box4ActorsComponentConfiguration",null,[3]);const iS=(a,b,c)=>ad.App.G$d?8:2===c?(a=new Ij.StandardDialog,a.Fd=4,a.uAa(1),a.Te(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Te(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),
a.r1l(hS),32):2,hS=a=>{1===a&&A.AFrameworkApplication.Pa.nb(G.a.vae,2)},CK=(a,b,c)=>{if(ad.App.G$d)return 8;if(1===c)return b.node.Qa(rb.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===ta.a.view&&b.view.Rb&&(b=b.view.Rb.Ik),Zd.EmbeddedFileReader.Qhk(b))){a=Zd.EmbeddedFileReader.zhe(b.node);Yi.a.hVl();try{jS(a)}catch(f){da.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},jS=a=>{if(1!==ad.App.mode||!A.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteSaveFileThroughRequest")||
A.AFrameworkApplication.fa.getBooleanAppSetting("IsTeamsSession")&&E.a.gV)window.open(a);else{var b=(new Dm.QueryStringBuilder(a)).zmg("Filename"),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const I=c.response;let T=b;T||(T="GetImage",I.type&&-1!=I.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(ja=>{-1!=I.type.indexOf(ja)&&(T="GetImage."+ja)}));T=decodeURIComponent(escape(T));if(E.a.iV)"undefined"!==typeof navigator.msSaveBlob?
navigator.msSaveBlob(I,T):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(I),u=document.createElement("a");u.href=l;u.download=T;document.body.appendChild(u);u.click();setTimeout(()=>{document.body.removeChild(u);f.revokeObjectURL(l)},0)}}catch(I){window.open(a)}};c.send()}};var kS=d(567),kr=d(1294),Nw;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(Nw||
(Nw={}));Object(m.b)("ColorMenuControls",Nw);class cz{constructor(a){this.a_b=this.b_b=null;this.pEc={};this.l4=a}Ydc(){this.a_b=this.b_b=null}ifg(a,b){if(this.a_b)return this.a_b;if(!a)return null;const c=Object.assign(new Rn.a,{Id:String.format("menu{0}Color",this.l4),ExternalId:String.format("{0}Color",this.l4)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.Lsi());Array.add(c.MenuSectionList,this.Vsi());Array.add(c.MenuSectionList,this.Hwi(a,b));Array.add(c.MenuSectionList,this.owi());
return this.a_b=c}o2i(a,b){if(this.b_b)return this.b_b;a=this.ifg(a,b);return this.b_b=Hj.l(a)}KNc(a,b){Nw[a]in this.pEc||(this.pEc[Nw[a]]=b)}Lwi(a){a.zJf(Object(R.a)(this,this.Ydc,"invalidateMenu"),1)}Lsi(){let a;if(!(()=>{let f=this.WDd(1);({actionId:a}=f);return f})().returnValue)return null;const b=Object.assign(new dl.a,{Id:String.format("{0}Color",this.l4),ControlsId:String.format("{0}.Color.Menu.Controls",this.l4),DisplayMode:"Menu16",ControlList:[]}),c=Object.assign(new Eg.a,{Command:a.toString(),
LabelText:Aa.a.Fe(Box4Intl.Box4Strings.L_Automatic),Image16by16:A.AFrameworkApplication.Mm,Image16by16Class:mp.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(b.ControlList,c);return b}Vsi(){let a;if(!(()=>{let f=this.WDd(2);({actionId:a}=f);return f})().returnValue)return null;const b=Object.assign(new dl.a,{Id:String.format("{0}Color",this.l4),ControlsId:String.format("{0}.Color.Menu.Controls",this.l4),DisplayMode:"Menu16",ControlList:[]}),
c=Object.assign(new Eg.a,{Command:a.toString(),LabelText:Aa.a.Fe(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:A.AFrameworkApplication.Mm,Image16by16Class:mp.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(b.ControlList,c);return b}Hwi(a,b){let c;if(!(()=>{let u=this.WDd(3);({actionId:c}=u);return u})().returnValue)return null;const f=Object.assign(new dl.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.l4),ControlList:[]}),
l=Object.assign(new ZA.a,{Id:String.format("Theme{0}ColorPicker",this.l4),ExternalId:String.format("Theme{0}ColorPicker",this.l4),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.l4),McuLayout:!0,Command:c.toString(),Width:10});l.Colors=cz.GPj(a,b);Array.add(f.ControlList,l);return f}owi(){let a;if(!(()=>{let f=this.WDd(4);({actionId:a}=f);return f})().returnValue)return null;const b=Object.assign(new dl.a,{Id:String.format("{0}Colors",this.l4),ControlsId:String.format("{0}.Color.Menu.Controls",
this.l4),Title:Aa.a.Fe(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]}),c=Object.assign(new ZA.a,{Id:String.format("Standard{0}ColorPicker",this.l4),ExternalId:String.format("Standard{0}ColorPicker",this.l4),Command:a.toString(),Width:10,Colors:[]});c.Colors=cz.DNj();Array.add(b.ControlList,c);return b}WDd(a){a=Nw[a];return a in this.pEc?{returnValue:!0,actionId:this.pEc[a]}:{returnValue:!1,actionId:0}}static DNj(){const a=[];a.push(Object.assign(new kr.a,{Color:"0000C0",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorDarkRed),
DisplayColor:"#C00000"}));a.push(Object.assign(new kr.a,{Color:"0000FF",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new kr.a,{Color:"00C0FF",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));a.push(Object.assign(new kr.a,{Color:"00FFFF",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new kr.a,{Color:"50D092",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));
a.push(Object.assign(new kr.a,{Color:"50B000",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new kr.a,{Color:"F0B000",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));a.push(Object.assign(new kr.a,{Color:"C07000",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new kr.a,{Color:"602000",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));
a.push(Object.assign(new kr.a,{Color:"A03070",Alt:Aa.a.Fe(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static GPj(a,b){const c=a.properties.ra(ib.a.themeColors,null);a=a.properties.$a(ib.a.bYh).split(" ");const f=Array(10);f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;
f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let T=0;6>T;T++)for(let ja=0;10>ja;ja++){var u=10*T+ja,I=c[u];u=u+1<<24;I=I&4278190080|(I&255)<<16|I&65280|(I&16711680)>>>16;const ua=cz.Oam(f,T,ja,b[a[ja]],c[ja]);l.push(Object.assign(new kr.a,{Color:Aa.a.px(u,8),DisplayColor:"#"+Aa.a.px(I,6),Alt:Aa.a.Fe(ua)}))}return l}static Oam(a,b,c,f,l){if(b){var u=l&255,I=(l&65280)>>>8;l=(l&16711680)>>>16;u=Math.floor((Math.min(Math.min(u,
I),l)+Math.max(Math.max(u,I),l))/2);--b;u?255===u?(u=!0,b=[242,217,191,166,127][b]):204<u?(u=!1,b=[229,191,127,64,25][b]):51>u?(u=!0,b=[25,64,127,191,229][b]):(I=[51,102,153],l=[191,127],b=(u=b<I.length)?I[b]:l[b-I.length]):(u=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(u?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(m.a)(cz,
"ColorMenu",null,[1742]);class Pr{constructor(a){this.oEc=null;this.nji=a}get Wdg(){this.oEc||(this.oEc=new cz(Pr.ZVi),this.I$j(this.oEc));return this.oEc}I$j(a){a.KNc(1,G.a.FX);a.KNc(3,G.a.Jr);a.KNc(4,G.a.Jr);a.KNc(5,G.a.Jr);a.Lwi(this.nji)}qb(){const a=A.AFrameworkApplication.Pa;a.xa(G.a.iNb,ta.a.view,Object(R.a)(this,this.iNb,"populateFontColor"));a.pe(G.a.iNb,1127)}iNb(a,b,c,f,l){if(1===c)return 32;if(2===c&&!l)return 8;a=Pr.Il.AHj(b);if(A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es){b=
this.Wdg.ifg(a,ad.App.oYf);if(!b)return 8;l.MenuItems=b}a=this.Wdg.o2i(a,ad.App.oYf);if(!a)return 8;l.PopulationXML=a;return 32}static OBj(){return new Pr(kS.a.instance)}static get instance(){return Pr.Iu||(Pr.Iu=Pr.OBj())}static get Il(){return Iu.PageReader.instance}}Pr.ZVi="Font";Pr.Iu=null;Object(m.a)(Pr,"FontColorActor",null,[]);class Xf{constructor(a){this.Hja=this.Pp=this.Sja=null;this.JYb=!1;this.$g=Ha.InteractiveViewManager.instance.$d;this.Dk=a;Xf.iU&&Bc.SelectionEditor.Tk(a)&&(a=Bc.SelectionEditor.mBc(this.Dk),
Bc.SelectionEditor.Tk(a)?this.Dk=a:da.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Bc.SelectionEditor.UTb(this.Dk);Bc.SelectionEditor.Tk(a)&&(this.Dk=a)}get Ofa(){return this.Sja||(this.Sja=Tb.a.instance.ub("Box4.IInternalLinkManager"))}get g8(){return this.Pp||(this.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get fyg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}X$f(a,
b,c){if(b!==this.Dk.Pb||a!==this.Dk.Ra)a=$d.SelectionFactory.U4(c,a,b),this.$g.Rb.setSelection(a),this.Dk=Bc.SelectionEditor.UTb(a.Ua.clone())}tig(a){const b=gf.HyperlinkReader.abc(this.Dk);let c=this.Dk.Ra,f=this.Dk.Pb;if(!b.length)return this.Hja=a.substring(this.Dk.Ra,this.Dk.Pb),{returnValue:!0,Mxd:"",nXc:c,oXc:f,n4c:b};if(b[0].hyperlink){let l,u=0,I=Math.max(0,a.length-1),T=0;for(let ja=0;ja<b.length;ja++)b[ja].Ra>=u&&({Ra:l,Pb:u}=Xf.Uu.Y0(this.Dk,b[ja]),I=Math.min(l,I),T=Math.max(u,T));c=Math.min(I,
c);f=Math.max(T,f);this.Hja=a.substring(c,f);a="";c===I&&(a=b[0].hyperlink.url);return{returnValue:!0,Mxd:a,nXc:c,oXc:f,n4c:b}}return{returnValue:!1,Mxd:"",nXc:c,oXc:f,n4c:b}}d5c(a,b){if(this.$g.ep){var c=Xf.Pva?gf.HyperlinkReader.abc(this.Dk):gf.HyperlinkReader.HD(this.Dk,!0);var f=this.$g.Rb.Oa.kb;if(f){f=f.Ua;$a.ParagraphReader.jn(f)&&(f=me.a.createTextRange(f.node,0,$a.ParagraphReader.textLength(f.node)));if(Xf.iU&&Bc.SelectionEditor.Tk(f)){var l=Bc.SelectionEditor.mBc(f);Bc.SelectionEditor.Tk(l)?
f=l:da.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=Bc.SelectionEditor.UTb(f);Bc.SelectionEditor.Tk(l)&&(f=l);0===a||U.a.instance.ga(22)&&32!==A.AFrameworkApplication.Pa.Ai(f,G.a.insertHyperlink,1,!0,null,null)||this.Bkk(c)||!this.Dk.equals(f)?this.$g.pT():(He.a.mark(5562),U.a.instance.ga(50)&&ad.App.ni&&ad.App.ni.qy&&this.$g.Rb.v2b(),a=new pg.GraphTransaction(15),a.rd(this.Dk.node),this.Dk.node.eI().graphTransactionOperations.ala(4),
f=b.txtDisplay,b=b.txtLink.trim(),this.fDb(f,b,c),a.dispose(),He.a.mark(5563),this.K4())}else da.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}Bkk(a){return Xf.Pva?!1:1<a.length||1===a.length&&(a[0].Ra>this.Dk.Ra||a[0].Pb<this.Dk.Pb)}fDb(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=gf.HyperlinkReader.GGa(b);let l="";this.Ofa&&(()=>{let u=this.Ofa.a_h(b,!1);({vCh:l}=u);return u})().returnValue&&(b=l)}this.JYb||(a=
Xf.hyperlinkEditor.bEl(a));if((!c.length||Xf.Pva)&&b)(f=0<c.length)&&Xf.Uu.nPb(this.Dk,c),c=!0,Xf.Nkk&&(c=$a.ParagraphReader.text(this.Dk.node).substring(this.Dk.Ra,this.Dk.Pb)!==a),c&&Xf.characterPropertiesEditor.replaceTextRange(this.Dk,a,!0),c=me.a.createTextRange(this.Dk.node,this.Dk.Ra,this.Dk.Ra+a.length),Xf.hyperlinkEditor.Ala(c,b,f,!1),f=$d.SelectionFactory.fh(this.Dk.node,this.Dk.Ra+a.length);else if(0<c.length){const l=c[0];let u,I;c=(()=>{let T=Xf.Uu.Y0(this.Dk,l);({Ra:u,Pb:I}=T);return T})().returnValue;
if(b)if(l.hyperlink.QWa){if(b!==l.hyperlink.url)if(Xf.kg.KTb){const T=me.a.createTextRange(this.Dk.node,u,u+a.length);Xf.hyperlinkEditor.$ej(T,l.hyperlink,b)}else Xf.Uu.C2h(b,c);a!==this.Hja&&(Xf.Uu.eSe()&&Xf.Uu.nPb(this.Dk,c),Xf.characterPropertiesEditor.replaceTextRange(me.a.createTextRange(this.Dk.node,u,I),a,!0),f=me.a.createTextRange(this.Dk.node,u,u+a.length),Xf.Uu.eSe()&&Xf.hyperlinkEditor.Ala(f,b,!1),f=$d.SelectionFactory.fh(this.Dk.node,u+a.length))}else Xf.Uu.nPb(this.Dk,c),Xf.characterPropertiesEditor.replaceTextRange(me.a.createTextRange(this.Dk.node,
u,I),a,!0),f=me.a.createTextRange(this.Dk.node,u,u+a.length),Xf.hyperlinkEditor.Ala(f,b,!1),f=$d.SelectionFactory.fh(this.Dk.node,u+a.length);else Xf.hyperlinkEditor.eL(l.paragraph,l.hyperlink)}f&&this.$g.Rb.setSelection(f)}static get hyperlinkEditor(){return Xf.uo||(Xf.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Xf.Ch||(Xf.Ch=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get kg(){return Xf.zd||(Xf.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Uu(){return Xf.LE||
(Xf.LE=Tb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Pva(){null==Xf.u5a&&(Xf.u5a=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("HyperlinkExpandEditEnabled"):!1);return Xf.u5a}static get Nkk(){null==Xf.wOd&&(Xf.wOd=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("KeepHyperlinkFormatFixIsEnabled"):!1);return Xf.wOd}static get Feb(){null==Xf.h7a&&(Xf.h7a=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"):
!1);return Xf.h7a}static get iU(){null==Xf.kO&&(Xf.kO=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Xf.kO}}Xf.uo=null;Xf.Ch=null;Xf.zd=null;Xf.LE=null;Xf.u5a=null;Xf.wOd=null;Xf.h7a=null;Xf.kO=null;Xf.source="Source";Xf.EYf="CommandingInterface";Xf.Jab="DisplayText";Xf.url="Url";Xf.id="InsertLinkDialog";Object(m.a)(Xf,"AInsertLinkDialog",null,[106]);class dz{static get Wg(){return zi.a.oC(dz.Hq,Box4Intl.Box4Strings.l_InsertLinkDisplayText,
Box4Intl.Box4Strings.l_InsertLinkAddress)}}dz.Hq="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(m.a)(dz,"InsertLinkDialogHtml",null,[]);class DK extends Xf{constructor(a,
b){super(a,b);this.Nf=new zi.a;this.Nf.Fg=Xf.id;var c=this.Hja="";const f=$a.ParagraphReader.text(this.Dk.node);let l=this.Dk.Ra,u=this.Dk.Pb,I;Xf.Pva?{Mxd:c,nXc:l,oXc:u,n4c:I}=this.tig(f):(I=gf.HyperlinkReader.HD(this.Dk,!0),1===I.length&&I[0].Ra<=this.Dk.Ra&&I[0].Pb>=this.Dk.Pb&&I[0].hyperlink?(this.Hja=Xf.Uu.p0c(a,I[0],f),c=I[0].hyperlink.url):I.length||(this.Hja=f.substring(this.Dk.Ra,this.Dk.Pb)));(b=Object(gb.a)(Object,b))&&(b[Xf.source]&&b[Xf.source]===Xf.EYf||b[Xf.url]&&b[Xf.Jab])?this.fDb(b[Xf.Jab],
b[Xf.url],I):(Xf.Pva&&I[0]&&this.X$f(l,u,I[0].paragraph),this.Nf.Wg=dz.Wg,""===c.trim()&&this.Nf.Te(1,this.fyg),c={["txtLink"]:c,["txtDisplay"]:this.Hja},this.Nf.oVc=Object(R.a)(this,this.FU,"dialogDefaultEnterKeyHandler"),this.Nf.nVc=Object(R.a)(this,this.FU,"dialogDefaultEnterKeyHandler"),this.Nf.Vj(this.titleText,Object(R.a)(this,this.d5c,"insertLinkDialogHandler"),c),Xf.Feb&&(c=document.getElementById("txtLink"),Ae.a.addHandler(c,la.a.input,Object(R.a)(this,this.KLa,"onLinkChanged")),Ae.a.addHandler(c,
la.a.change,Object(R.a)(this,this.KLa,"onLinkChanged"))),document.getElementById("txtLink").focus(),Xf.iU?0<We.h(me.a.QTa(l,u,!1,this.Dk.node)).length&&(this.JYb=!0,document.getElementById("txtDisplay").disabled=!0):1>=I.length&&Xf.Uu.u6d(a,I[0],1===I.length)&&(this.JYb=!0,document.getElementById("txtDisplay").disabled=!0))}KLa(){if(this.Nf){const a=document.getElementById("txtLink");this.Nf.SF(1,!a||!a.value.length||gf.HyperlinkReader.Dye(a.value))}}FU(a){return this.Nf?Xf.Feb?this.Nf.Cgg(this.Nf.Jrb)?
this.Nf.FU(a):!1:this.Nf.FU(a):!1}K4(){if(Xf.Feb){const a=document.getElementById("txtLink");a&&(Ae.a.removeHandler(a,la.a.change,Object(R.a)(this,this.KLa,"onLinkChanged")),Ae.a.removeHandler(a,la.a.input,Object(R.a)(this,this.KLa,"onLinkChanged")))}this.Nf&&(this.Nf=null)}}Object(m.a)(DK,"InsertLinkDialog",Xf,[]);class EK extends Xf{constructor(a,b,c){super(a,b);const f=new zi.a(!1,!1,!0),l={};l.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.textDisplayInitialFocus=c;c=this.Hja="";const u=$a.ParagraphReader.text(this.Dk.node);let I=this.Dk.Ra,T=this.Dk.Pb,ja;Xf.Pva?{Mxd:c,nXc:I,oXc:T,n4c:ja}=this.tig(u):(ja=gf.HyperlinkReader.HD(this.Dk,!0),1===ja.length&&ja[0].Ra<=this.Dk.Ra&&ja[0].Pb>=this.Dk.Pb&&ja[0].hyperlink?(this.Hja=Xf.Uu.p0c(a,ja[0],u),c=ja[0].hyperlink.url):ja.length||(this.Hja=u.substring(this.Dk.Ra,this.Dk.Pb)));(b=Object(gb.a)(Object,b))&&(b[Xf.source]&&b[Xf.source]===Xf.EYf||b[Xf.url]&&b[Xf.Jab])?this.fDb(b[Xf.Jab],b[Xf.url],
ja):(Xf.Pva&&ja[0]&&this.X$f(I,T,ja[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.fyg),f.Te(1,b),l.txtLink=c,l.txtDisplay=this.Hja,Xf.iU?0<We.h(me.a.QTa(I,T,!1,this.Dk.node)).length&&(this.JYb=!0,l.textDisplayDisabled=!0):1>=ja.length&&Xf.Uu.u6d(a,ja[0],1===ja.length)&&(this.JYb=!0,l.textDisplayDisabled=!0),a={["id"]:Xf.id,["bodyControls"]:l},f.Vj(this.titleText,Object(R.a)(this,this.d5c,"insertLinkDialogHandler"),a))}K4(){}}Object(m.a)(EK,"ReactInsertLinkDialog",Xf,[]);class cv{constructor(){this.tsa=
!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.SD}e1f(a,b,c){this.tsa?new EK(a,b,c):new DK(a,b)}static get instance(){return cv.Ja||(cv.Ja=new cv)}}cv.Ja=null;Object(m.a)(cv,"InsertLinkDialogFactory",null,[1743]);class Jl extends zi.a{constructor(a){super();this.XL=a;this.$g=Ha.InteractiveViewManager.instance.$d;this.dLc=this.$g.Rb.Oa.kb;this.bee=a[0].Ra;this.lze=a[a.length-1].Pb;this.Fg="InsertMultiParagraphLinkDialog";a=this.dim();this.showDialog("",a)}showDialog(a,b){da.ULS.sendTraceTag(41261264,
324,50,"Insert multiple paragraph link dialog shows.");this.Wg=dz.Wg;""===b.trim()&&this.Te(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.Vj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(R.a)(this,this.d5c,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Jl.Feb&&(a=document.getElementById("txtLink"),Ae.a.addHandler(a,la.a.input,Object(R.a)(this,this.KLa,"onLinkChanged")),Ae.a.addHandler(a,
la.a.change,Object(R.a)(this,this.KLa,"onLinkChanged")))}hide(){if(Jl.Feb){const a=document.getElementById("txtLink");a&&(Ae.a.removeHandler(a,la.a.change,Object(R.a)(this,this.KLa,"onLinkChanged")),Ae.a.removeHandler(a,la.a.input,Object(R.a)(this,this.KLa,"onLinkChanged")))}super.hide()}KLa(){const a=document.getElementById("txtLink");this.SF(1,!a||!a.value.length||gf.HyperlinkReader.Dye(a.value))}FU(a){return Jl.Feb?this.Cgg(this.Jrb)?super.FU(a):!1:super.FU(a)}dim(){let a;let b;a="";const c=this.XL.length,
f=gf.HyperlinkReader.HD(this.XL[0],!1);0<f.length&&({Ra:l,Pb:b}=Jl.Uu.Y0(this.XL[0],f[0]),l<=this.XL[0].Ra&&(a=f[0].hyperlink.url),this.bee=Math.min(this.bee,l));var l=gf.HyperlinkReader.HD(this.XL[c-1],!1);0<l.length&&({Ra:l,Pb:b}=Jl.Uu.Y0(this.XL[c-1],l[l.length-1]),this.lze=Math.max(this.lze,b));this.jdm(this.bee,this.lze);return a}jdm(a,b){const c=this.XL.length;if(a!==this.XL[0].Ra||b!==this.XL[c-1].Pb){a=me.a.rk(this.XL[0].node,a);a=$d.SelectionFactory.Dv(a);b=me.a.rk(this.XL[c-1].node,b);b=
$d.SelectionFactory.PO(a,b);a=this.Rpg(b.Ua.clone());const f=this.Rpg(b.vf.clone());a&&f&&(this.XL[0]=a,this.XL[c-1]=f,this.$g.Rb.setSelection(b),this.dLc=b)}}d5c(a,b){if(this.$g.ep){var c=this.$g.Rb.Oa.kb;if(c)if(c.equals(this.dLc)&&0!==a){a=new pg.GraphTransaction(15);a.rd(this.XL[0].node);for(c=0;c<this.XL.length;c++)this.XL[c].node.eI().graphTransactionOperations.ala(4);b=b.txtLink.trim();this.L$i();this.obk(b);this.hide();a.dispose()}else this.$g.pT()}}obk(a){if(a){a=gf.HyperlinkReader.GGa(a);
for(let c=0;c<this.XL.length;c++){var b=this.XL[c];if(Jl.iU&&Bc.SelectionEditor.Tk(b)&&(b=Bc.SelectionEditor.mBc(b),!Bc.SelectionEditor.Tk(b)))continue;b=me.a.createTextRange(this.XL[c].node,b.Ra,b.Pb);Jl.hyperlinkEditor.Ala(b,a,!1)}}}Rpg(a){return $a.ParagraphReader.jn(a)&&!Bc.SelectionEditor.oY(a)&&$a.ParagraphReader.textLength(a.node)?me.a.createTextRange(a.node,0,$a.ParagraphReader.textLength(a.node)):Bc.SelectionEditor.Tk(a)?a:null}L$i(){let a=!1;for(const b of this.XL){const c=gf.HyperlinkReader.HD(b,
!1);c&&(a=Jl.Uu.nPb(b,c)||a)}}static get Uu(){return Jl.LE||(Jl.LE=Tb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get kg(){return Jl.zd||(Jl.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Jl.uo||(Jl.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get iU(){null==Jl.kO&&(Jl.kO=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Jl.kO}static get Feb(){null==
Jl.h7a&&(Jl.h7a=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"):!1);return Jl.h7a}}Jl.LE=null;Jl.zd=null;Jl.uo=null;Jl.kO=null;Jl.h7a=null;Object(m.a)(Jl,"InsertMultiParagraphLinkDialog",zi.a,[]);class cf{static get Jj(){return mi.a.instance}static get hyperlinkEditor(){return cf.uo||(cf.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Uu(){return cf.LE||(cf.LE=Tb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static Yr(){return cf.yn||
(cf.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static get kg(){return cf.zd||(cf.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get gBc(){return cf.QE||(cf.QE=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get UUb(){null==cf.UGd&&(cf.UGd=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("ViewAndOpenImageHyperlinksIsEnabled"):!1);return cf.UGd}static get Pva(){null==cf.u5a&&(cf.u5a=
A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("HyperlinkExpandEditEnabled"):!1);return cf.u5a}static get jqc(){null==cf.v5a&&(cf.v5a=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("MultiParagraphHyperlinkEditEnabled"):!1);return cf.v5a}static get iU(){null==cf.kO&&(cf.kO=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return cf.kO}static qb(){const a=A.AFrameworkApplication.Pa;
a.xa(G.a.insertHyperlink,ta.a.view,cf.KCb);a.xa(G.a.insertHyperlink,ta.a.Xf,cf.fDb);a.xa(G.a.insertHyperlink,ta.a.textRange,cf.fDb);a.pe(G.a.insertHyperlink,1028);a.xa(G.a.eL,ta.a.view,cf.KCb);a.xa(G.a.eL,ta.a.Xf,cf.cDh);a.xa(G.a.eL,ta.a.textRange,cf.cDh);a.pe(G.a.eL,1028);a.xa(G.a.pxd,ta.a.view,cf.KCb);a.xa(G.a.pxd,ta.a.Xf,cf.bKh);a.xa(G.a.pxd,ta.a.textRange,cf.bKh);a.xa(G.a.PLa,ta.a.view,cf.KCb);a.xa(G.a.PLa,ta.a.Xf,cf.Drh);a.xa(G.a.PLa,ta.a.textRange,cf.Drh);a.xa(G.a.PLa,ta.a.image,cf.kWe);a.xa(G.a.PLa,
ta.a.e$b,cf.kWe);a.xa(G.a.fdc,ta.a.view,cf.KCb);a.xa(G.a.fdc,ta.a.Xf,cf.linkText);a.xa(G.a.fdc,ta.a.textRange,cf.linkText);a.pe(G.a.fdc,1028);cf.UUb&&a.xa(G.a.PLa,ta.a.anchoredObject,cf.kWe);a.xa(G.a.dTc,ta.a.view,cf.KCb)}static KCb(a,b,c,f,l){if(cf.jqc)return cf.T5j(a,b,c,f,l);if(!b.view.xi)return 2;var u=b.view.Rb;if(!u||!u.Oa||!u.Oa.length)return 8;var I=u.Oa.kb;let T=I.Ua.clone();if(2===I.length){if(I=I.ga(1),!Bc.SelectionEditor.Tk(T)||!Bc.SelectionEditor.Om(I)||T.node!==I.node)return 8}else if(2<
I.length)return 8;if(u.Oa.rI)return 8;$a.ParagraphReader.jn(T)&&!Bc.SelectionEditor.oY(T)&&(u=T.node,T=me.a.createTextRange(u,0,$a.ParagraphReader.textLength(u)));return a===G.a.dTc?cf.O_f(b,T,c,f,l):A.AFrameworkApplication.Pa.Ai(T,a,c,!0,f,l)}static T5j(a,b,c,f,l){if(!b.view.xi)return 2;var u=b.view.Rb;if(!u||!u.Oa||!u.Oa.length||u.Oa.rI)return 8;var I=u.Oa.kb;if(u=cf.Yfc(I))I=cf.wle(I.Ua.clone(),!0);else{let T=I.ga(0).clone(),ja=1;for(;ja<I.length&&(!$a.ParagraphReader.textLength(T.node)||Bc.SelectionEditor.Om(T)||
cf.iU&&We.m(T));)T=I.ga(ja).clone(),ja++;I=cf.wle(T,!1)}return cf.iU&&Bc.SelectionEditor.Tk(I)&&We.m(I)||!Bc.SelectionEditor.Tk(I)&&!u?8:a===G.a.dTc?cf.O_f(b,I,c,f,l):A.AFrameworkApplication.Pa.Ai(I,a,c,!0,f,l)}static Yfc(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return Bc.SelectionEditor.Tk(b)&&Bc.SelectionEditor.Om(a)&&b.node===a.node?!0:!1}return!1}static hZf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=cf.wle(a.ga(f).clone(),!1);if(Bc.SelectionEditor.Tk(l))cf.iU&&
We.m(l)||Array.add(c,l);else if(!Bc.SelectionEditor.Om(l)&&!$a.ParagraphReader.jn(l))return{returnValue:!1,JTa:b}}b=rd.a.xTb(c);return{returnValue:!cf.iU||0<b.length?!0:!1,JTa:b}}static nyg(a,b,c,f){if(cf.jqc)return cf.tbk(a,b,c,f);if(!cf.N3d()||!cf.dRc(a)||Me.a.instance.Oa.rI)return 8;if(cf.UUb&&Bc.SelectionEditor.HHa(a))return 2;let l,u=cf.uYa(a,!0);({hyperlink:l}=u);if(!u.returnValue||cf.LSc())return 8;if(1===b)return 32;if(!l&&Bc.SelectionEditor.nh(a)&&Bc.SelectionEditor.QEb(a)&&(b=Bc.SelectionEditor.VUa(a,
!1))&&(Me.a.instance.setSelection(b),a=b.Ua,cf.LSc()))return 8;cv.instance.e1f(a,c,f);return 32}static tbk(a,b,c,f){const l=Me.a.instance.Oa.kb,u=cf.Yfc(l);let I;if(u)I=[a];else if(!(()=>{let ua=cf.hZf(l);({JTa:I}=ua);return ua})().returnValue)return 8;if(!cf.N3d())return 8;for(a=0;a<I.length;a++)if(!cf.dRc(I[a]))return 8;if(Me.a.instance.Oa.rI)return 8;const T=Array(I.length);let ja=null;for(let ua=0;ua<I.length;ua++)if(T[ua]=I[ua],!(()=>{let Ra=cf.uYa(T[ua],!0);({hyperlink:ja}=Ra);return Ra})().returnValue||
cf.LSc())return 8;if(f&&!cf.rtk(T[0]))return 8;if(1===b)return 32;if(!ja&&1===T.length&&u&&Bc.SelectionEditor.nh(T[0])&&Bc.SelectionEditor.QEb(T[0])&&(b=Bc.SelectionEditor.VUa(T[0],!1))&&(Me.a.instance.setSelection(b),T[0]=b.Ua,cf.LSc()))return 8;u?cv.instance.e1f(T[0],c,f):new Jl(T,c);return 32}static fDb(a,b,c,f,l){return cf.nyg(b,c,l,!1)}static linkText(a,b,c,f,l){return cf.nyg(b,c,l,!0)}static cDh(a,b,c){if(cf.jqc)return cf.Ezl(a,b,c);if(!cf.dRc(b)||cf.UUb&&Bc.SelectionEditor.HHa(b))return 2;
let f,l=cf.uYa(b,!1);({hyperlink:f}=l);if(!l.returnValue)return 2;if(2===c){c=new pg.GraphTransaction(15);try{c.Wc=a,c.rd(f.paragraph),cf.Pva?cf.tDh(b):cf.Uu.eL(b,f)}finally{c&&c.dispose()}}return 32}static Ezl(a,b,c){var f=Me.a.instance.Oa.kb;if(cf.Yfc(f))b=[b];else if(f=cf.hZf(f),{JTa:b}=f,!f.returnValue)return 8;if(!cf.N3d())return 8;for(f=0;f<b.length;f++)if(!cf.dRc(b[f]))return 8;if(1===c&&!cf.uYa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!cf.uYa(b[c],!0).returnValue)return 2;
c=new pg.GraphTransaction(15);try{const l=b[0];c.Wc=a;c.rd(l.node);for(a=0;a<b.length;a++)cf.tDh(b[a])}finally{c&&c.dispose()}}return 32}static tDh(a){const b=gf.HyperlinkReader.abc(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Ra>=c){let l=cf.Uu.Y0(a,b[f]);({Pb:c}=l);cf.Uu.nPb(a,l.returnValue)}}static bKh(a,b,c){if(cf.UUb&&vb.ImageReader.BDb(b))return 2;let f=cf.uYa(b,!1);({hyperlink:a}=f);if(!f.returnValue)return 2;if(2===c){const {Ra:l,Pb:u}=cf.Uu.Y0(b,a);Me.a.instance.setSelection($d.SelectionFactory.U4(a.paragraph,
l,u))}return 32}static Drh(a,b,c){let f;if(cf.UUb&&(()=>{let l=cf.etk(b);({hyperlink:f}=l);return l})().returnValue)da.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!(()=>{let l=cf.uYa(b,!1);({hyperlink:f}=l);return l})().returnValue)return 2;2===c&&ad.App.l$b(f.hyperlink.url);return 32}static kWe(a,b,c){a=vb.ImageReader.Y0(b.node);if(!a)return 2;2===c&&ad.App.l$b(a);return 32}static O_f(a,b,c,f,l){if(cf.UUb&&vb.ImageReader.BDb(b))return 2;const u=Ha.InteractiveViewManager.instance.editingView;
if(!u.Nm)return 2;let I;var T=cf.uYa(b,!1);({hyperlink:I}=T);if(!T.returnValue)return 2;if(1===c)return 32;const {Ra:ja,Pb:ua}=cf.Uu.Y0(b,I);Me.a.instance.setSelection($d.SelectionFactory.U4(I.paragraph,ja,ua));T=u.ownerDocument;c=u.Mo;b=new Kd.a(c);za.a.qw(c);T=T.createElement("span");c.appendChild(T);T.innerText=I.hyperlink.url;u.lNa();u.uTl();a=A.AFrameworkApplication.Pa.Ai(a,G.a.copy,2,!0,f,l);b.restore();return a}static uYa(a,b){let c;c=null;if(Bc.SelectionEditor.Tk(a)){var f=We.h(a);const l=
rd.a.all(f,u=>6===u.kr);if(0<f.length&&(!cf.iU||!l))return{returnValue:!1,hyperlink:c}}if(cf.Pva)return cf.atk(a,b);f=gf.HyperlinkReader.HD(a,!0);return 1===f.length&&f[0].Ra<=a.Ra&&f[0].Pb>=a.Pb&&f[0].hyperlink?(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static etk(a){let b;b=null;return vb.ImageReader.BDb(a)&&(b=gf.HyperlinkReader.r0c(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static atk(a,b){let c;c=null;const f=gf.HyperlinkReader.abc(a);return f.length?
f[0].hyperlink?(c=f[0],a.Ra<f[0].Ra?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static rtk(a){if(Bc.SelectionEditor.Tk(a)){var b=We.h(a),c=rd.a.all(b,f=>6===f.kr);if(0<b.length&&!c)return!1}b=gf.HyperlinkReader.HD(a,!0);if(!(1===b.length&&b[0].Ra<=a.Ra&&b[0].Pb>=a.Pb&&b[0].hyperlink))return!1;c=$a.ParagraphReader.text(a.node);a=cf.Uu.p0c(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static LSc(){if(cf.kg.Gg)for(let a=
0;a<null.count;++a)if(2===null.ga(a).stm.changeType)return!0;return!1}static N3d(){return cf.kg.Gg?!0:!U.a.instance.ga(45)||!ad.App.WE.LTb}static dRc(a){return U.a.instance.ga(14)&&cf.Jj.aab(a)||cf.Yr()&&cf.Yr().instance&&cf.Yr().instance.rY(a)?!1:!0}static wle(a,b){return $a.ParagraphReader.jn(a)&&!Bc.SelectionEditor.oY(a)&&($a.ParagraphReader.textLength(a.node)||b)?me.a.createTextRange(a.node,0,$a.ParagraphReader.textLength(a.node)):a}}cf.uo=null;cf.LE=null;cf.yn=null;cf.zd=null;cf.QE=null;cf.UGd=
null;cf.u5a=null;cf.v5a=null;cf.kO=null;Object(m.a)(cf,"HyperlinkActor",null,[]);class Ch{static get Cw(){return ut.a.wBb}static get Dn(){return Uh.ContextSetEditor.instance}static get Jj(){return mi.a.instance}static get fd(){return jd.a.instance}static Yr(){return Ch.yn||(Ch.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return Ch.hy||(Ch.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}static get v7(){return Ch.Cs||(Ch.Cs=Tb.a.instance.resolve("Box4.IParagraphReader"))}static get KN(){return Ch.JH||
(Ch.JH=Tb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get Lcl(){return Ch.paragraphEditor.Cw}static get eg(){return Ch.qh||(Ch.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static qb(){const a=A.AFrameworkApplication.Pa;a.xa(G.a.My,ta.a.view,Ch.SOf);a.xa(G.a.My,ta.a.outlineElement,Ch.ROf);a.pe(G.a.My,1028);a.xa(G.a.lC,ta.a.view,Ch.SOf);a.xa(G.a.lC,ta.a.outlineElement,Ch.ROf);a.pe(G.a.lC,1028)}static SOf(a,b,c,f,l){var u=b.view;if(!u.xi)return 2;const I=u.Rb;if(!I)return Ch.fd.kc(be.a.ei,
{["Reason"]:Ud.a.Sya}),8;var T=I.Ik;if(!T)return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.fQ}),8;if(U.a.instance.ga(62)&&1===c)return 32;if(U.a.instance.ga(11)&&Ch.Dn.Xta(Ch.T_d,T))return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.l6b}),8;if(U.a.instance.ga(14)&&Ch.Jj.A6c(T))return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.ZE}),8;if(Ch.Yr()&&Ch.Yr().instance&&Ch.Yr().instance.rY(T))return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.externalSelection}),8;T={};T[Oi.Fra]=5794;T[Oi.Era]=5795;let ja=2;if(A.AFrameworkApplication.fa.getBooleanAppSetting("Box4PartialPromoteDemoteIsEnabled")){u=
Ch.OUf(a===G.a.My,b,!0);if(1===c)return u?32:8;u&&(ja=Oi.mlb(a,b,c,f,l,T))}else ja=Oi.mlb(a,b,1,f,l,T),1!==c&&32===ja?(u.Rb.GVe(),u=new pg.GraphTransaction(15),u.rd(b.view.Zg),ja=Ch.OUf(a===G.a.My,b,!1)?Oi.mlb(a,b,c,f,l,T):8,u.dispose()):1!==c&&8===ja&&(u.Rb.GVe(),Ch.ZWi(a,b,I));return ja}static OUf(a,b,c){b=b.view.Rb;if(!b||!b.Oa.kb)return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.Fnd}),!1;if(b.Oa.rI)return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.OZf}),!1;b=gj.Zua(b.Oa,!1);if(!b)return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.IXc}),
!1;let f=!1;for(let l=0;l<b.length;l++){const u=b.getContext(l),I=new mb.GraphIterator;I.set(u.node);Bc.SelectionEditor.Bu(I);if(!ge.OutlineElementReader.vh(I))if(c)continue;else return Ch.fd.kc(be.a.ei,{["Reason"]:Ud.a.Oea}),!1;if(a?!Ch.Cw.dxb(I):!Ch.Cw.aRc(I))if(c)continue;else return Ch.fd.kc(be.a.e8b,{["Reason"]:Ud.a.mVf}),!1;f=!0}return c?f:!0}static ROf(a,b,c,f,l){if(b.contextId!==ta.a.outlineElement)return 2;if(U.a.instance.ga(14))if(f=b.clone().qbf(),Jd.TableReader.fGg(f)){if(Ch.Jj.gGg(f))return Ch.fd.kc(be.a.Kp,
{["Reason"]:Ud.a.ZE}),8}else if(Ch.Jj.RHa(f))return Ch.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),2;f=new mb.GraphIterator;f.set(b.node);Bc.SelectionEditor.Bu(f);if(!ge.OutlineElementReader.vh(f))return 2;switch(a){case G.a.My:b=Ch.Cw.dxb(f);break;case G.a.lC:b=Ch.Cw.aRc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===G.a.lC&&l&&l.ra(Oe.a.wQf,!1)&&(c|=2);switch(a){case G.a.My:Ch.Cw.Olb(f,-1,c);break;case G.a.lC:Ch.Cw.aVc(f,1)}return 32}static ZWi(a,b,c){const f=new pg.GraphTransaction(15);try{f.rd(b.view.Zg);
b=!0;var l=gj.Zua(c.Oa,!1);for(let u=0;u<l.length;u++){const I=l.getContext(u),T=new mb.GraphIterator;T.set(I.node);Bc.SelectionEditor.Bu(T);if(!ge.OutlineElementReader.vh(T))b=!1;else if(a===G.a.My?Ch.Cw.dxb(T):Ch.Cw.aRc(T))switch(b=!1,a){case G.a.My:Ch.Cw.Olb(T,-1,0);break;case G.a.lC:Ch.Cw.aVc(T,1)}}if(b){const u=c.Oa.kb;for(c=0;c<u.length;c++){const I=u.ga(c);if(I.El){const T=Ch.KN.kBb(I.node),ja=T.wSb;if(a===G.a.My?T.eP>ja:T.eP<18*ja){const ua=new mb.GraphIterator;ua.set(I.node);l=ja;l=a===G.a.My?
T.eP>=2.5*ja?T.eP-2*ja:ja:T.eP<16*ja?T.eP+2*ja:18*ja;Ch.Lcl.Lnb(ua,1,l)}}}}}finally{f&&f.dispose()}}}Ch.yn=null;Ch.hy=null;Ch.Cs=null;Ch.JH=null;Ch.qh=null;Ch.T_d=vb.ImageReader.ADb;Object(m.a)(Ch,"IndentationActor",null,[]);class Ug{static get Xoe(){return Ug.wsb||(Ug.wsb=Tb.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return Ug.hy||(Ug.hy=Tb.a.instance.resolve("Box4.IParagraphEditor"))}static get Lr(){return Ug.EJ||(Ug.EJ=Tb.a.instance.resolve("Box4.ITableEditor"))}static get Jj(){return mi.a.instance}static get fd(){return jd.a.instance}static Yr(){return Ug.yn||
(Ug.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static qb(){const a=A.AFrameworkApplication.Pa;U.a.instance.ga(77)||(a.xa(G.a.leftJustify,ta.a.table,Ug.K0d),a.xa(G.a.centerJustify,ta.a.table,Ug.K0d),a.xa(G.a.rightJustify,ta.a.table,Ug.K0d));a.xa(G.a.leftJustify,ta.a.view,oh.z9);a.xa(G.a.leftJustify,ta.a.paragraph,Ug.Uka);a.xa(G.a.leftJustify,ta.a.image,Ug.kEa);a.xa(G.a.leftJustify,ta.a.embeddedFile,Ug.kEa);a.pe(G.a.leftJustify,1028);a.xa(G.a.centerJustify,ta.a.view,oh.z9);a.xa(G.a.centerJustify,
ta.a.paragraph,Ug.Uka);a.xa(G.a.centerJustify,ta.a.image,Ug.kEa);a.xa(G.a.centerJustify,ta.a.embeddedFile,Ug.kEa);a.pe(G.a.centerJustify,1028);a.xa(G.a.rightJustify,ta.a.view,oh.z9);a.xa(G.a.rightJustify,ta.a.paragraph,Ug.Uka);a.xa(G.a.rightJustify,ta.a.image,Ug.kEa);a.xa(G.a.rightJustify,ta.a.embeddedFile,Ug.kEa);a.pe(G.a.rightJustify,1028);U.a.instance.ga(54)&&(a.xa(G.a.fullJustify,ta.a.view,oh.z9),a.xa(G.a.fullJustify,ta.a.paragraph,Ug.Uka),a.pe(G.a.fullJustify,1028),a.xa(G.a.a8b,ta.a.view,oh.z9),
a.xa(G.a.a8b,ta.a.paragraph,Ug.Uka),a.pe(G.a.a8b,1028),a.xa(G.a.Mgc,ta.a.view,oh.z9),a.xa(G.a.Mgc,ta.a.paragraph,Ug.Uka),a.pe(G.a.Mgc,1028),a.xa(G.a.Sxc,ta.a.view,oh.z9),a.xa(G.a.Sxc,ta.a.paragraph,Ug.Uka),a.pe(G.a.Sxc,1028));a.xa(G.a.ega,ta.a.view,oh.z9);a.xa(G.a.ega,ta.a.paragraph,Ug.Uka);a.xa(G.a.ega,ta.a.image,Ug.kEa);a.pe(G.a.ega,1028);a.xa(G.a.rea,ta.a.view,oh.z9);a.xa(G.a.rea,ta.a.paragraph,Ug.Uka);a.xa(G.a.rea,ta.a.image,Ug.kEa);a.pe(G.a.rea,1028);a.xa(G.a.pia,ta.a.view,oh.z9);a.xa(G.a.pia,
ta.a.paragraph,Ug.Uka);a.xa(G.a.pia,ta.a.image,Ug.kEa);a.pe(G.a.pia,1028);U.a.instance.ga(54)&&(a.xa(G.a.Yua,ta.a.view,oh.z9),a.xa(G.a.Yua,ta.a.paragraph,Ug.Uka),a.pe(G.a.Yua,1028))}static K0d(a,b,c){let f=!0;if(!b)return 8;Jd.TableReader.fGg(b)?U.a.instance.ga(14)&&Ug.Jj.gGg(b)?(Ug.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),f=!1):Ug.Yr()&&Ug.Yr().instance&&Ug.Yr().instance.rY(b)&&(Ug.fd.kc(be.a.Kp,{["Reason"]:Ud.a.externalSelection}),f=!1):(Ug.fd.kc(be.a.Kp,{["Reason"]:Ud.a.qae}),f=!1);if(1===c||!f)return f?
32:8;$u.uqb(b,a,c);b=b.node;switch(a){case G.a.leftJustify:Ug.Lr.kL(b,1);break;case G.a.centerJustify:Ug.Lr.kL(b,2);break;case G.a.rightJustify:Ug.Lr.kL(b,3)}return 32}static kEa(a,b,c){let f,l=oh.MPh(c,b);({yG:f}=l);if(!l.returnValue)return f;$u.uqb(b,a,c);b=b.node;switch(a){case G.a.leftJustify:case G.a.ega:Ug.Xoe.kL(b,1);break;case G.a.centerJustify:case G.a.rea:Ug.Xoe.kL(b,2);break;case G.a.rightJustify:case G.a.pia:Ug.Xoe.kL(b,3)}return 32}static Uka(a,b,c,f,l){f=!0;b.contextId!==ta.a.paragraph?
f=!1:U.a.instance.ga(14)&&Ug.Jj.RHa(b)?(Ug.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),f=!1):Ug.Yr()&&Ug.Yr().instance&&Ug.Yr().instance.rY(b)&&(Ug.fd.kc(be.a.Kp,{["Reason"]:Ud.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;$u.uqb(b,a,c);b=b.node;c=$a.ParagraphReader.zM(b);switch(a){case G.a.leftJustify:case G.a.ega:Ug.paragraphEditor.kL(b,1===c&&Ug.n9c(l)?6:1);break;case G.a.centerJustify:case G.a.rea:Ug.paragraphEditor.kL(b,2===c&&Ug.n9c(l)?1:2);break;case G.a.rightJustify:case G.a.pia:Ug.paragraphEditor.kL(b,
3===c&&Ug.n9c(l)?1:3);break;case G.a.fullJustify:case G.a.Yua:Ug.paragraphEditor.kL(b,6===c&&Ug.n9c(l)?1:6);break;case G.a.Mgc:Ug.paragraphEditor.kL(b,11);break;case G.a.a8b:Ug.paragraphEditor.kL(b,7);break;case G.a.Sxc:Ug.paragraphEditor.kL(b,13)}return 32}static n9c(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&U.a.instance.ga(110)}}Ug.wsb=null;Ug.EJ=null;Ug.hy=null;Ug.yn=null;Object(m.a)(Ug,"JustificationActor",null,[]);class dv{qb(){const a=
A.AFrameworkApplication.Pa;a.xa(G.a.activateRibbonTab,ta.a.view,Object(R.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.pe(G.a.activateRibbonTab,5);a.xa(G.a.vHg,ta.a.view,Object(R.a)(this,this.Gvk,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}Gvk(){ad.App.WE.zU.uHg();return 32}static get instance(){return dv.Ja||(dv.Ja=dv.JD())}static JD(){return new dv}}dv.Ja=null;Object(m.a)(dv,"RibbonActor",null,[]);class xo{constructor(a,b,c){this.mHf=!1;this.Ca=a;this.La=b;this.wGc=c}qb(){this.Ca.pa(N.a.bO,
ta.a.view,Object(R.a)(this,this.abm,"touchStartHandler"),4);this.Ca&&this.La&&(this.La.getBooleanAppSetting("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.pa(G.a.TYh,ta.a.view,Object(R.a)(this,this.Lll,"processImageOnTouchSelection"),4),this.Ca.pa(G.a.UYh,ta.a.view,Object(R.a)(this,this.Kll,"processImageOnClickSelection"),4)),this.La.getBooleanAppSetting("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.pa(N.a.t5l,ta.a.application,Object(R.a)(this,this.lml,"processStartPinchToZoom"),4),this.Ca.pa(N.a.Egj,
ta.a.application,Object(R.a)(this,this.Dll,"processEndPinchToZoom"),4)))}abm(a,b,c){if(2!==c)return 2;this.mHf||(this.mHf=!0);return 32}Lll(a,b,c,f,l){if(2!==c)return 2;this.kxh(l,!0);return 32}Kll(a,b,c,f,l){if(2!==c)return 2;this.kxh(l,!1);return 32}kxh(a,b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,xo.p7j)){for(a=a.firstChild;a;)this.YBi(a,b),a=a.nextSibling;break}a=a.nextSibling}}YBi(a,b){if(Sys.UI.DomElement.containsCssClass(a,xo.Gwg)){b&&!Sys.UI.DomElement.containsCssClass(a,
xo.v4c)?Sys.UI.DomElement.addCssClass(a,xo.v4c):!b&&Sys.UI.DomElement.containsCssClass(a,xo.v4c)&&Sys.UI.DomElement.removeCssClass(a,xo.v4c);const c="WACImageResizeHandleTouch"+this.rCj(a);b&&!Sys.UI.DomElement.containsCssClass(a,c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}m0c(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==xo.Gwg)return c}return""}rCj(a){a=
this.m0c(a);return""!==a?Aa.a.substring(a,20,a.length):""}lml(a,b,c){if(2!==c)return 2;if(!this.wGc)return 8;this.wGc.F2j();return 32}Dll(a,b,c){if(2!==c)return 2;if(!this.wGc)return 8;this.wGc.UGl();return 32}static sQj(){return new xo(A.AFrameworkApplication.Pa,A.AFrameworkApplication.fa,Qi.GrippersManager.instance)}static get instance(){return xo.Iu||(xo.Iu=xo.sQj())}}xo.Gwg="WACImageResizeHandles";xo.v4c="WACImageResizeHandlesTouch";xo.p7j="WACImgSelection";xo.Iu=null;Object(m.a)(xo,"TouchInputActor",
null,[]);class Qr{constructor(a){this.$t=null;this.n0=a}get Fo(){return this.$t||(this.$t=this.n0())}qb(){const a=A.AFrameworkApplication.Pa,b=Object(R.a)(this,this.undoRedo,"undoRedo");a.pa(G.a.undo,ta.a.view,b,1028);a.pa(G.a.redo,ta.a.view,b,1028)}undoRedo(a,b,c,f,l){b=b.view;if(!b.xi)return Qr.fd.kc(be.a.ei,{["Reason"]:Ud.a.Fnd}),8;f=a===G.a.undo?this.Fo.YU:this.Fo.Pma;if(1===c)return f?32:8;if(!f)return da.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===G.a.undo?
"undo":"redo"),Qr.fd.kc(be.a.ei,{["Reason"]:Ud.a.wfm}),2;c=new pg.GraphTransaction(3);c.rd(b.Zg);c.Cnb();a=a===G.a.undo?this.Fo.undo():this.Fo.redo();c.dispose();l&&Qi.GrippersManager.instance.e5a(l.Gv);if(a)return 32;Qr.fd.kc(be.a.e8b,{["Reason"]:Ud.a.kjh});return 8}static get instance(){return Qr.Ja||(Qr.Ja=Qr.JD())}static JD(){const a=Tb.a.instance;return new Qr(()=>a.resolve("Box4.IUndoManager"),a.ze("Box4.ICoauthCashTelemetry"))}static get fd(){return jd.a.instance}}Qr.Ja=null;Object(m.a)(Qr,
"UndoActor",null,[]);class wE{constructor(){this.Da=null}get name(){return"Box4.Actors"}fc(a){this.Da=a;(new BK).fc(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").qb();A.AFrameworkApplication.Pa.xa(G.a.eej,ta.a.embeddedFile,iS);A.AFrameworkApplication.Pa.xa(G.a.vae,ta.a.embeddedFile,CK);A.AFrameworkApplication.Pa.xa(G.a.vae,ta.a.d$b,CK);Pr.instance.qb();cf.qb();Ch.qb();Ug.qb();xo.instance.qb();this.Da.resolve("Box4.ISelectAllHandlers").qb();U.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").qb();
dv.instance.qb();const a=this.Da.ub("Box4.IFeatureHelper");a?a.mTj.continueWith(()=>{this.bCh()}):this.bCh();Lc.qb(ad.App.uOa);this.Da.resolve("Box4.Actors.TextFormattingActor").qb();Qr.instance.qb();this.Da.resolve("Box4.Actors.AccessibilityActor").n2e();this.Da.resolve("Box4.IClipboardCommands");this.Da.resolve("Box4.ITextPasteFloatieManager").Rxl();ad.App.Ob.Gf()}bCh(){U.a.instance.ga(71)&&this.Da.resolve("Box4.Actors.StyleActor").qb()}dispose(){}static main(){C.a.instance.Ac(new wE)}}Object(m.a)(wE,
"Box4ActorsPackage",null,[2,3]);class Bn{constructor(a,b){this.Y8=this.wii=null;this.zii=a;this.gsb=b}get Asd(){return this.levelText}get bhc(){return this.wii}get levelText(){return this.zii}get listStyle(){return 6}get oF(){return"left"}get wpa(){return this.Y8}get font(){return this.gsb}}Object(m.a)(Bn,"ListMarkerBullet",null,[1732]);class og{static get hs(){return og.ir||(og.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}static get eg(){return og.qh||(og.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return og.Eu||
(og.Eu=Tb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Yr(){return og.yn||(og.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}static get Dn(){return Uh.ContextSetEditor.instance}static get Jj(){return mi.a.instance}static get fd(){return jd.a.instance}static get XM(){return og.QL||(og.QL=Tb.a.instance.ub("Box4.List.ListSettings"))}static get bzc(){return og.l1b||(og.l1b=Tb.a.instance.ub("Box4.List.ISingleLevelListEditor"))}static qb(){const a=A.AFrameworkApplication.Pa;a.xa(G.a.qL,
ta.a.view,og.D3b);a.xa(G.a.qL,ta.a.outlineElement,og.Wvb);a.pe(G.a.qL,1036);a.xa(G.a.aO,ta.a.view,og.D3b);a.xa(G.a.aO,ta.a.outlineElement,og.Wvb);a.pe(G.a.aO,1036);og.eg.Gfb&&(a.xa(G.a.X0a,ta.a.view,og.D3b),a.xa(G.a.X0a,ta.a.outlineElement,og.Wvb),a.pe(G.a.X0a,1036));a.xa(G.a.POf,ta.a.view,ff.ActionManager.uh);a.xa(G.a.fXf,ta.a.view,ff.ActionManager.uh);a.xa(G.a.joinList,ta.a.view,ff.ActionManager.uh);a.xa(G.a.o0d,ta.a.view,ff.ActionManager.uh);a.xa(G.a.v0d,ta.a.view,ff.ActionManager.uh);a.xa(G.a.TVh,
ta.a.view,ff.ActionManager.uh);a.xa(G.a.UVh,ta.a.view,ff.ActionManager.uh);a.xa(G.a.Ggf,ta.a.view,ff.ActionManager.uh)}static D3b(a,b,c,f,l){if(!b.view.xi)return 2;const u=og.fd.Cq(G.a.D3b);f.ED=42;f.MO=42;const I={};I[Oi.Fra]=5796;I[Oi.Era]=5797;var T=b.view;if(U.a.instance.ga(11)){if(og.Dn.Xta(og.S6j,T.Rb.Ik))return og.fd.kc(be.a.ei,{["Reason"]:Ud.a.w6d}),u.end(),8;if(og.Dn.Xta(og.T_d,T.Rb.Ik))return og.fd.kc(be.a.ei,{["Reason"]:Ud.a.l6b}),u.end(),8}if(U.a.instance.ga(14)&&og.Jj.A6c(T.Rb.Ik))return og.fd.kc(be.a.ei,
{["Reason"]:Ud.a.ZE}),u.end(),8;if(og.Yr()&&og.Yr().instance&&og.Yr().instance.rY(b))return og.fd.kc(be.a.ei,{["Reason"]:Ud.a.externalSelection}),u.end(),8;if(1===c)return u.end(),32;l||(l=new W.DictionaryPropertySet);let ja=null;var ua=2;if(2===c){ja=new pg.GraphTransaction(15);ja.rd(b.view.Zg);og.jgc=!1;const eb=gj.Zua(T.Rb.Oa,!1);if(!eb)return ja.dispose(),og.fd.kc(be.a.ama,{["Reason"]:Ud.a.IXc}),u.end(),8;1<eb.length&&l.setValue(Oe.a.Cih,null);const Bb=l.ra(Oe.a.pV,-1),Ub=l.ra(Oe.a.pF,-1);og.XM.Wfc&&
og.bzc&&og.bzc.vtm(eb);if(og.eg.SVh){var Ra=og.XWl(Bb,Ub,eb);Ra&&(l.setValue(Oe.a.pF,16),l.setValue(Oe.a.iga,0));if(!Bc.SelectionEditor.nh(T.Rb.Ik)&&!Ra&&a!==G.a.X0a&&0<eb.length&&Bb){T=new mb.GraphIterator;Ra=Array(eb.length);for(let Xb=0;Xb<eb.length;Xb++)T.set(eb.getContext(Xb).node),Ra[Xb]=og.eg.Aw(T);og.WWl(Ra,l)&&(ua=new W.DictionaryPropertySet,ua.setValue(Oe.a.pF,16),ua.setValue(Oe.a.iga,0),ua=Oi.x7(a,b,c,f,ua,I,11),A.AFrameworkApplication.Pa.nb(G.a.UVh,2),da.ULS.sendTraceTag(38544075,393,
50,"List Actions: Switch List Style - Range Select"),og.jgc=!0)}}T=new mb.GraphIterator;T.set(eb.getContext(0).node);T=og.eg.Aw(T);og.sBk(Bb,Ub,T,eb.length)}U.a.instance.ga(63)||U.a.instance.ga(77)?ua=Oi.x7(a,b,c,f,l,I,11):U.a.instance.ga(30)&&(ua=Oi.mlb(a,b,c,f,l,I));32===ua&&l.ra(Oe.a.wQf,!1)&&(U.a.instance.ga(62)?ua=Oi.x7(G.a.lC,b,c,f,l,I,11):U.a.instance.ga(29)?ua=Oi.mlb(G.a.lC,b,c,f,l,I):U.a.instance.ga(76));ja&&ja.dispose();u.end();return ua}static WWl(a,b){let c=null;var f=!1;for(let l=a.length-
1;0<=l&&(c?(f=a[l],f=-1!==b.ra(Oe.a.pV,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.ra(Oe.a.pF,42),b=b.ra(Oe.a.pV,-3),a=a!==c.listType||0<b),f||a)?!0:!1}static sBk(a,b,c,f){0>=f||og.jgc||(a?c?(c=c.listType,-1===a&&b===c?(A.AFrameworkApplication.Pa.nb(G.a.Ggf,2),da.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(A.AFrameworkApplication.Pa.nb(0===b?G.a.v0d:G.a.o0d,
2),da.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(A.AFrameworkApplication.Pa.nb(0===b?G.a.v0d:G.a.o0d,2),da.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet")):(A.AFrameworkApplication.Pa.nb(G.a.Ggf,2),da.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static XWl(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new mb.GraphIterator;let f=null;for(let l=c.length-1;0<=
l&&!(a.set(c.getContext(l).node),f=og.eg.Aw(a));l--);return f&&b===f.listType?!0:!1}static Wvb(a,b,c,f,l){if(b.contextId!==ta.a.outlineElement)return 2;if(U.a.instance.ga(14)){var u=b.clone().qbf();if(og.Jj.RHa(u))return og.fd.kc(be.a.Kp,{["Reason"]:Ud.a.ZE}),2}const I=new mb.GraphIterator;I.set(b.node);Bc.SelectionEditor.Bu(I);if(!ge.OutlineElementReader.vh(I))return 2;if(1===c)switch(a){case G.a.qL:return 32;case G.a.aO:return 32;case G.a.X0a:return 32;default:return 2}u=og.eg.Aw(I);let T=l;if(!T)return 8;
!Kc.ListReader.wy&&a===G.a.aO&&I.Gva()&&(I.gK(4)||T.setValue(Oe.a.HYa,1),I.Up());og.eg.Gfb?(a===G.a.aO||a===G.a.qL?(T=og.hs.U9f(a,T),b=Gf.a.JO(T.$a(Oe.a.pF),T.$a(Oe.a.iga))):b=a===G.a.X0a?Gf.a.JO(0,1):null,og.$R(a,T),og.vRl(b,T)):(T=og.hs.U9f(a,T),b=Gf.a.JO(T.$a(Oe.a.pF),T.$a(Oe.a.iga)));Kc.ListReader.wy||(b.EB=T.ra(rb.a.IYa,hf.a.Wx));og.DSl(T,I);a=og.hs.Wvb(T,I,b,!1);({Rdb:b}=a);if(!a.returnValue)return og.fd.kc(be.a.Kp,{["Reason"]:Ud.a.Xze}),2;2===c&&(c=l.ra(Oe.a.pF,-1),b&&-1!==c&&((l=l.ra(ib.a.D1,
"Invalid MultiLevel Type"),u)?0!==b.listType&&1!==b.listType||og.jgc||(A.AFrameworkApplication.Pa.nb(G.a.TVh,2),da.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",c?"Bullet":"Numbering",l)):16===b.listType?(A.AFrameworkApplication.Pa.nb(G.a.fXf,2),da.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",c?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||og.jgc||(A.AFrameworkApplication.Pa.nb(G.a.POf,2),da.ULS.sendTraceTag(38544077,
393,50,"List Actions: ApplyList Style - {0}, {1}",c?"Bullet":"Numbering",l))),l=F.FocusManager.instance(),l.Je.name===P.AppFrame.wwd&&l.PF(K.AFrame.PX));f.ED=b.listType;f.MO=b.listStyle;return 32}static DSl(a,b){var c=new mb.GraphIterator;c.Uc(b);(b=c.Gb(2))&&$a.ParagraphReader.ke(b)&&(c=Me.a.instance.Oa.kb)&&c.Ua&&c.Ua.node===b&&Bc.SelectionEditor.P8c(c)&&(og.uQl(a),og.rQl(a))}static vRl(a,b){b.Qa(ib.a.D1)&&a.uRl(b.$a(ib.a.D1));a.pV=b.ra(Oe.a.pV,-1);a.Yxe?(b=og.CEj(a,b),og.ASl(a,b)):og.APl(a)}static APl(a){if(a.X7c)a.D3c&&
-1===a.pV||(a.levelText="%1.",a.propertySet.Qa(rb.a.Dj)||a.Rqa(0,1));else if(1===a.listType)a.D3c&&-1===a.pV||(a.font=hf.a.K9i,a.levelText=hf.a.defaultBullet,a.propertySet.Qa(rb.a.Dj)||a.Rqa(1,6));else return;a.oF="left"}static ASl(a,b){1===a.D1?og.JRl(a,b):og.IQl(a,b)}static JRl(a,b){a.wpa=b.wpa}static IQl(a,b){a.levelText=b.levelText;a.X7c?a.Rqa(0,b.listStyle):(a.font=b.font,a.Rqa(1,1));a.oF=b.oF}static CEj(a,b){let c=null;2===a.D1?c=a.X7c?Tb.a.instance.ub("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):
Tb.a.instance.ub("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===a.D1&&(c=Tb.a.instance.ub("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.SIg.value;a=a.pV+"";a in f||(f=c.Swk);return a in f||!b.Qa(rb.a.font)?f[a]:(b=b.ra(rb.a.font,""),new Bn(Aa.a.fromCharCode(parseInt(a)),b))}static rQl(a){og.insertionPointFormatting.Qa(rb.a.fontColor)&&a.setValue(rb.a.fontColor,og.insertionPointFormatting.fontColor())}static uQl(a){og.insertionPointFormatting.Qa(rb.a.fontSize)&&a.setValue(rb.a.fontSize,
og.insertionPointFormatting.fontSize())}static $R(a,b){a=a===G.a.qL?0:a===G.a.aO?1:a===G.a.X0a?2:-1;b=b.ra(Oe.a.pV,-1);da.ULS.sendTraceTag(22923024,324,50,"{ListType:%1, ListStyleId:%2}",a,b)}}og.S6j=vb.ImageReader.Xec;og.T_d=vb.ImageReader.ADb;og.ir=null;og.qh=null;og.Eu=null;og.yn=null;og.QL=null;og.l1b=null;og.jgc=!1;Object(m.a)(og,"ListActor",null,[]);var FK=d(1266);class ev{constructor(){this.Aii=new Hc.a(Object(R.a)(this,this.U7d,"createListMarkerDictionary"));this.Bii={}}get SIg(){return this.Aii}get Swk(){return this.Bii}}
Object(m.a)(ev,"AListMarkerGalleryLoader",null,[1789]);var GK=d(1295);class xB extends Ky.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(m.a)(xB,"ListGalleryButtonProps",Ky.a,[]);class Ht{constructor(a,b,c,f){this.DZb=null;this.xSf="BulletLibraryGallery";this.A1k="NumberingLibraryGallery";this.ZZk="MultilevelGallery";this.y7a=a;this.Cii=b;switch(a){case 0:this.DZb="BulletStyle";break;case 1:this.DZb="NumberingStyle";break;case 2:this.DZb="MultilevelStyle";break;default:this.DZb=
"BulletStyle"}this.vhi=f}get Twk(){return this.Cii}rKf(a){let b;var c=1;switch(this.y7a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new dl.a,{Id:String.format("msListMarkersPosition{0}",
b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});var u=0===this.y7a?"Size40by40":"Size48by48";c=Object.assign(new gr.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.The(this.y7a),Type:c,Width:6,ElementDimensions:u,GalleryItems:[]});l=this.Twk.SIg.value;u=hr.a(l);const I=Math.min(18,u.length);for(let T=0;T<I;T++){const ja=l[u[T]];this.vhi&&a&&((1===this.y7a||2===this.y7a)&&!ja.bhc||0===this.y7a&&ja.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||
c.GalleryItems.push(this.She(this.DZb+b+"_"+T,ja,this.y7a))}Array.add(f.ControlList,c);return f}The(a){switch(a){case 0:return this.xSf;case 1:return this.A1k;case 2:return this.ZZk;default:return this.xSf}}Ajg(a){const b={},c=Ca.FontUtils.wla(a.font);b.fontFamily=Ca.FontUtils.uvb(c,a.font,!0,!1,!1);return b}She(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=Aa.a.px(b.levelText.charCodeAt(0),4),f=Ht.uek(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=
b.font+f,l=!0);let u,I;switch(c){case 0:c=G.a.qL;u=G.a.vyh;I=Object.assign(new GK.a,{Character:b.levelText,Style:this.Ajg(b)});break;case 1:c=G.a.aO;u=G.a.Mnl;I=Object.assign(new xB,{LevelInfo:b.bhc});break;case 2:c=G.a.X0a;u=G.a.Lnl;I=Object.assign(new xB,{LevelInfo:b.bhc});b.wpa&&(f=b.wpa.description,l=!0);break;default:c=G.a.qL,u=G.a.vyh,I=Object.assign(new GK.a,{Character:b.levelText,Style:this.Ajg(b)})}I.Id=a;I.Command=c.toString();I.QueryCommand=u.toString();I.Alt=f;I.InnerHTML=Aa.a.Fe(this.Qwk(b));
I.ShouldSetTitle=l.toString();return I}Qwk(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.Cie(a),this.Bie(a))}Cie(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.Asd===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Ht.Uyg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=Ca.FontUtils.wla(a.font);b.append(Ca.FontUtils.uvb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}Bie(a){return a.Asd}static uek(a){for(let b=
0;b<Ht.NPf.length;b++)if(a===Ht.NPf[b])return!0;return!1}}Ht.Uyg="EXYdHRyjlYTe8nDSGfyW";Ht.NPf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(m.a)(Ht,"ListMarkerGalleryUtility",null,[]);class xE extends ev{constructor(){super();new FK.a(gD.a.gl())}U7d(){const a={};a["0"]=new Bn(Box4Intl.Box4Strings.L_ListStyleNone,Ht.Uyg);a["1"]=new Bn(String.fromCharCode(61623),"Symbol");a["2"]=new Bn(String.fromCharCode(111),"Courier New");a["3"]=new Bn(String.fromCharCode(61607),"Wingdings");
a["4"]=new Bn(String.fromCharCode(9643),"Courier New");a["5"]=new Bn(String.fromCharCode(61611),"Wingdings");a["6"]=new Bn(String.fromCharCode(61614),"Symbol");a["7"]=new Bn(String.fromCharCode(61483),"Symbol");a["8"]=new Bn(String.fromCharCode(61485),"Symbol");a["9"]=new Bn(String.fromCharCode(9830),"Courier New");a["10"]=new Bn(String.fromCharCode(61664),"Symbol");a["11"]=new Bn(String.fromCharCode(61558),"Wingdings");a["12"]=new Bn(String.fromCharCode(61656),"Wingdings");a["13"]=new Bn(String.fromCharCode(61514),
"Wingdings");a["14"]=new Bn(String.fromCharCode(61516),"Wingdings");a["15"]=new Bn(String.fromCharCode(61692),"Wingdings");a["16"]=new Bn(String.fromCharCode(61691),"Wingdings");a["17"]=new Bn(String.fromCharCode(61553),"Wingdings");return a}}Object(m.a)(xE,"ListMarkerBulletLoader",ev,[]);class Kl{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(Kl,"InfoAtLevel",null,[]);class fv{constructor(a){this.Y8=a}get font(){return"Calibri"}get listStyle(){return 42}get oF(){return"left"}get wpa(){return this.Y8}get Asd(){return this.Y8?
this.Hkl():this.Jkl()}get bhc(){return this.Y8?this.Ikl():null}get levelText(){return""}CBj(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Hkl(){let a="";for(let b=0;3>b;b++)a+=this.BGa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',fv.Pge(),a)}Ikl(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Kl,{textAtLevel:this.Wmg(b),styleAtLevel:this.ZNj(b)}));return a}Jkl(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
fv.Qge(),Box4Intl.Box4Strings.L_ListStyleNone)}Wmg(a){a=this.Y8.EIg[a];for(let b=0;9>b;b++)a=Aa.a.replaceAll(a,"%"+(b+1),this.CBj(this.Y8.w$c[b]));return a}ZNj(a){const b={};b.fontFamily=6===this.Y8.w$c[a]?this.Y8.Udg[a]:this.font;return b}BGa(a){const b=this.Wmg(a),c=new Sys.StringBuilder;6===this.Y8.w$c[a]&&c.append(String.format("font-family:{0};",this.Y8.Udg[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static Pge(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static Qge(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(fv,"ListMarkerMultilevel",null,[1732]);class yB{constructor(a,b,c,f,l){this.EIg=a;this.w$c=b;this.puk=f;this.Udg=c;this.description=l}}Object(m.a)(yB,"MultilevelDefInfo",null,[]);class HK{K2i(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),u=Array(9);for(let I=0;9>I;I++)b+="%"+(I+1)+".",c[I]=b,f[I]=1,l[I]="left";return new yB(c,f,u,l,a)}a5i(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new yB("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}b2i(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let u=0;9>u;u++)l[u]=String.fromCharCode(a[u]),c[u]=6,f[u]="left";return new yB(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(m.a)(HK,"MultilevelDefInfoAdaptor",null,[]);class yE extends ev{constructor(){super()}U7d(){const a=new HK,b={};b["0"]=new fv(null);b["1"]=new fv(a.K2i());b["2"]=new fv(a.a5i());b["3"]=new fv(a.b2i());return b}}Object(m.a)(yE,"ListMarkerMultilevelLoader",ev,[]);
class Wn{constructor(a,b){this.Y8=null;this.s7a=a;this.kIc=b}get font(){return"Calibri"}get listStyle(){return this.kIc}get oF(){switch(this.kIc){case 3:case 5:return"right";default:return"left"}}get wpa(){return this.Y8}get Asd(){switch(this.kIc){case 1:return this.tMa("1","2","3");case 2:return this.tMa("a","b","c");case 3:return this.tMa("i","ii","iii");case 4:return this.tMa("A","B","C");case 5:return this.tMa("I","II","III");case 0:return this.Kkl();default:return this.tMa("1","2","3")}}get bhc(){const a=
[],b={};b.fontFamily=Ca.FontUtils.wla(this.font);switch(this.kIc){case 1:return a.push(Object.assign(new Kl,{textAtLevel:this.WO("1"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("2"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Kl,{textAtLevel:this.WO("a"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("b"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Kl,{textAtLevel:this.WO("i"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("ii"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Kl,{textAtLevel:this.WO("A"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("B"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Kl,
{textAtLevel:this.WO("I"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("II"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Kl,{textAtLevel:this.WO("1"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("2"),styleAtLevel:b})),a.push(Object.assign(new Kl,{textAtLevel:this.WO("3"),styleAtLevel:b})),a}}get levelText(){return this.s7a}tMa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
Wn.Pge(),this.BGa(a),this.BGa(b),this.BGa(c))}Kkl(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Wn.Qge(),Box4Intl.Box4Strings.L_ListStyleNone)}BGa(a){a=this.WO(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}WO(a){return Aa.a.replaceAll(this.s7a,"%1",a)}static Pge(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static Qge(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(Wn,"ListMarkerNumbering",null,[1732]);class zE extends ev{constructor(){super();new FK.a(gD.a.gl())}U7d(){const a={};a["0"]=new Wn(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new Wn("%1.",5);a["2"]=new Wn("%1.",4);a["3"]=new Wn("%1.",1);a["4"]=new Wn("%1.",2);a["5"]=new Wn("%1.",3);a["6"]=new Wn("%1)",5);a["7"]=new Wn("%1)",4);a["8"]=new Wn("%1)",1);a["9"]=new Wn("%1)",
2);a["10"]=new Wn("%1)",3);a["11"]=new Wn("(%1)",5);a["12"]=new Wn("(%1)",4);a["13"]=new Wn("(%1)",1);a["14"]=new Wn("(%1)",2);a["15"]=new Wn("(%1)",3);return a}}Object(m.a)(zE,"ListMarkerNumberingLoader",ev,[]);class AE{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){og.qb()}dispose(){}fc(a){this.Da=a;this.Da.register(xE,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().na(()=>new xE);this.Da.register(zE,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().na(()=>new zE);
this.Da.register(yE,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().na(()=>new yE)}static main(){C.a.instance.Ac(new AE)}}Object(m.a)(AE,"Box4ListMarkerPackage",null,[2,3]);class BE{constructor(a){this.LHd=a}pBg(a){if(!this.LHd)return!0;a=oe.a.n0c(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.LHd.length;b++)if(a.endsWith(this.LHd[b]))return!0;return!1}}Object(m.a)(BE,"DomainAllowListManager",null,[]);class IK{constructor(a,b){this.n9d=null;this.YWd=a;this.url=b}get kif(){return oe.a.Vba(this.url)}get hD(){return this.YWd}Pef(){const a=
{},b=this.hD;a.a=this.kif;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.n9d;return a}round(a){return Math.round(1E3*a)/1E3}}Object(m.a)(IK,"PerformanceTimingEntry",null,[]);const JK=(a,b)=>{var c,f;const l={};let u=null;switch(a){case 0:u="ResourceTiming";a=b.a;null!=a&&(l.Url=a);a=b.b;null!=a&&(l.InitiatorType=a);a=null==
b.c?null:b.c.toString();null!=a&&(l.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(l.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(l.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(l.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(l.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(l.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(l.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(l.SecureConnectionStart=a);a=null==b.k?null:
b.k.toString();null!=a&&(l.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(l.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(l.ResponseEnd=a);a=b.n;null!=a&&(l.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(l.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(l.EncodedBodySize=a);a=null==b.q?null:b.q.toString();null!=a&&(l.TransferSize=a);b=null!==(f=null===(c=b.r)||void 0===c?void 0:c.toString())&&void 0!==f?f:null;null!=b&&(l.responseStatus=b);break;case 1:u=
"PerformanceTiming",c=b.a,null!=c&&(l.Url=c),c=null==b.b?null:b.b.toString(),null!=c&&(l.NavigationStart=c),c=null==b.c?null:b.c.toString(),null!=c&&(l.UnloadEventStart=c),c=null==b.d?null:b.d.toString(),null!=c&&(l.UnloadEventEnd=c),c=null==b.e?null:b.e.toString(),null!=c&&(l.RedirectStart=c),c=null==b.f?null:b.f.toString(),null!=c&&(l.RedirectEnd=c),c=null==b.g?null:b.g.toString(),null!=c&&(l.FetchStart=c),c=null==b.h?null:b.h.toString(),null!=c&&(l.DomainLookupStart=c),c=null==b.i?null:b.i.toString(),
null!=c&&(l.DomainLookupEnd=c),c=null==b.j?null:b.j.toString(),null!=c&&(l.ConnectStart=c),c=null==b.k?null:b.k.toString(),null!=c&&(l.ConnectEnd=c),c=null==b.l?null:b.l.toString(),null!=c&&(l.SecureConnectionStart=c),c=null==b.m?null:b.m.toString(),null!=c&&(l.RequestStart=c),c=null==b.n?null:b.n.toString(),null!=c&&(l.ResponseStart=c),c=null==b.o?null:b.o.toString(),null!=c&&(l.ResponseEnd=c),c=null==b.p?null:b.p.toString(),null!=c&&(l.DomLoading=c),c=null==b.q?null:b.q.toString(),null!=c&&(l.DomInteractive=
c),c=null==b.r?null:b.r.toString(),null!=c&&(l.DomContentLoadedEventStart=c),c=null==b.s?null:b.s.toString(),null!=c&&(l.DomContentLoadedEventEnd=c),c=null==b.t?null:b.t.toString(),null!=c&&(l.DomComplete=c),c=null==b.u?null:b.u.toString(),null!=c&&(l.LoadEventStart=c),c=null==b.v?null:b.v.toString(),null!=c&&(l.LoadEventEnd=c),b=b.w,null!=b&&(l.CustomText=b)}l.Table=u;return Sys.Serialization.JavaScriptSerializer.serialize(l)};var ii=d(288);class Hs{constructor(a,b,c){this.Ci=a;this.jif=this;this.Nei=
(void 0===b?null:b)||(()=>window.location.href);this.LKd=new BE(void 0===c?null:c)}Lh(){if(Hs.cTa(window.performance))try{const l=this.Nei();if(Hs.rqi.exec(l)&&this.LKd.pBg(l)){var a=new IK(window.performance.timing,l);xe.a.instance.Atl(a.hD.fetchStart);xe.a.instance.Ctl(a.hD.navigationStart);xe.a.instance.N0a(ii.a.Wqj,"connectStart","requestStart");xe.a.instance.N0a(ii.a.brj,"requestStart","responseStart");xe.a.instance.N0a(ii.a.drj,"responseStart","responseEnd");this.jif.Kfb(1,a.Pef());this.Ci.Xb(ii.a.cGa,
a.hD.fetchStart);this.Ci.Xb(ii.a.$qj,a.hD.domainLookupStart);this.Ci.Xb(ii.a.Aeg,a.hD.domainLookupEnd);this.Ci.Xb(ii.a.Yqj,a.hD.connectStart);this.Ci.Xb(ii.a.erj,a.hD.secureConnectionStart);this.Ci.Xb(ii.a.Xqj,a.hD.connectEnd);this.Ci.Xb(ii.a.Ceg,a.hD.requestStart);this.Ci.Xb(ii.a.qAb,a.hD.responseStart);this.Ci.Xb(ii.a.Beg,a.hD.responseEnd-a.hD.responseStart);this.Ci.Xb(ii.a.crj,a.hD.responseStart-a.hD.requestStart);var b=0,c=0,f=0;(()=>{let u=this.eem(l);({transferSize:b,mbe:c,w9d:f}=u);return u})().returnValue&&
(this.Ci.Xb(ii.a.frj,b),this.Ci.Xb(ii.a.Zqj,f),this.Ci.Xb(ii.a.arj,c));this.Ci.Xb(ii.a.w$b,a.hD.navigationStart)}}catch(l){da.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}eem(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,mbe:c,w9d:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,
mbe:c,w9d:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,mbe:c,w9d:f}}Kfb(a,b){da.ULS.sendTraceTag(4551815,306,50,JK(a,b))}static get instance(){return Hs.Ja||(Hs.Ja=new Hs(Mg.a.instance,null,A.AFrameworkApplication.fa.getBooleanAppSetting("PerfTimingLoggerFilterDomainsIsEnabled")?A.AFrameworkApplication.fa.hz("ResourceLoggerDomainAllowList"):null))}static cTa(a){return!(void 0===
a||null===a)&&!(void 0===a.timing||null===a.timing)}}Hs.Ja=null;Hs.rqi=RegExp("^https?://.*","i");Object(m.a)(Hs,"PerformanceTimingLogger",null,[1804]);class lr{constructor(a,b){this.n9d=null;this.YWd=a;this.behavior=b;this.url=this.hD.name}get kif(){return 2===this.behavior?this.url:oe.a.Vba(this.url)}get hD(){return this.YWd}Pef(){const a={},b=this.hD;a.a=this.kif;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);
a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(lr.CGa(b,"decodedBodySize"));a.p=this.round(lr.CGa(b,"encodedBodySize"));a.q=this.round(lr.CGa(b,"transferSize"));a.n=this.n9d;a.r=lr.CGa(b,"responseStatus")||0;return a}round(a){return Math.round(1E3*
a)/1E3}static CGa(a,b){return a[b]}}Object(m.a)(lr,"ResourceTimingEntry",null,[1833]);class KK{constructor(a,b,c){this.Tnf=a;this.GLc=void 0===b?null:b;this.tPa={};this.Rai=void 0===c?100:c}Vcm(a){var b=a.name.toLowerCase();const c=oe.a.xBb(b);this.OGh(c,b)&&(c in this.tPa?da.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.CGg(a),b.encodedsize=lr.CGa(a,"encodedBodySize"),
b.decodedsize=lr.CGa(a,"decodedBodySize"),this.tPa[c]=b))}Wcm(a){var b=a.name.toLowerCase();const c=oe.a.xBb(b);this.HGl(c,b)&&(c in this.tPa?da.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.CGg(a),b.encodedsize=lr.CGa(a,"encodedBodySize"),b.decodedsize=lr.CGa(a,"decodedBodySize"),b.it=a.initiatorType,b.ress=a.responseStart,b.cs=a.connectStart,b.ce=a.connectEnd,
b.dls=a.domainLookupStart,b.dle=a.domainLookupEnd,b.rs=a.redirectStart,b.re=a.redirectEnd,b.reqs=a.requestStart,b.scs=a.secureConnectionStart,this.tPa[c]=b))}OGh(a,b){if(this.Tnf)return Array.contains(this.Tnf,a);if(this.GLc)for(a=oe.a.GD(b),b=0;b<this.GLc.length;b++)if(this.GLc[b]&&a.endsWith(this.GLc[b]))return!0;return!1}HGl(a,b){return this.OGh(a,b)?a.endsWith(".js")||a.endsWith(".css"):!1}CGg(a){try{const b=lr.CGa(a,"transferSize");if(void 0!==b&&null!==b)return!b;da.ULS.sendTraceTag(51652510,
306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.Rai}catch(b){da.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}rul(){if(Qa.a.Ta(this.tPa))da.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var a=A.AFrameworkApplication.flightId?A.AFrameworkApplication.flightId.split(";"):
[],b=Object.assign(new Fl.a,{extendedProperties:$q.a.Yz()});b.extendedProperties.set("Flights",Fe.c(a));this.pBk(b,this.tPa,eg.Health.instance)}}Ife(a){let b=0,c=0,f=0,l=0;const u=this.tPa;for(const T in u){var I=u[T];T.endsWith(".js")&&(I=Object(gb.a)(Object,I),I.responseend<a&&(b+=1,c+=I.decodedsize,l+=I.encodedsize,f+=I.iscached?0:I.encodedsize))}a={};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=f;a.encodedBytes=l;return a}pBk(a,b,c){if(b){var f=0,l=0,u=0,I=0,T=0,ja=0,ua=0,Ra=0,eb=0,Bb=
0,Ub=0;for(const tc in b){var Xb=b[tc];try{const lc=Object(gb.a)(Object,Xb);if(!lc)continue;const Ec=lc.iscached?Boolean.parse(lc.iscached.toString()):!1,hd=lc.fetchstart?this.parseFloat(lc.fetchstart.toString()):0,yd=(lc.responseend?this.parseFloat(lc.responseend.toString()):0)-hd,Pd=lc.encodedsize?this.parseFloat(lc.encodedsize.toString()):0,pe=lc.decodedsize?this.parseFloat(lc.decodedsize.toString()):0;f+=yd;I+=Pd;ua+=pe;Bb++;Ec?(u+=yd,ja+=Pd,eb+=pe,Ub++):(l+=yd,T+=Pd,Ra+=pe)}catch(lc){da.ULS.sendTraceTag(575931856,
306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",lc.message)}}a.extendedProperties.set("StaticResources",Fe.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",u.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",I.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",
T.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ja.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",ua.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Ra.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",eb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Bb.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Ub.toString());
c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(m.a)(KK,"AppStaticResourceManager",null,[]);class LK extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(m.a)(LK,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Ow{constructor(a,b,c,f,l,u){c=void 0===c?null:c;f=void 0===f?null:f;l=void 0===l?100:
l;u=void 0===u?!1:u;this.mPd=!1;this.Wn=null;this.BWb=0;this.Ma=new uc.a;this.I5a=null;this.Tja=!1;this.eHf=0;this.je=a;this.vqf=0;this.jif=this;this.LKd=new BE(c);this.PE=b;f&&(this.I5a=new KK(null,f,l));this.B$h=u}get KRf(){try{return!(void 0===this.PE||null===this.PE)&&!(void 0===this.PE.getEntriesByType||null===this.PE.getEntriesByType)}catch(a){return da.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get I9i(){return this.vqf}get isActive(){return this.Tja}get Fef(){return this.eHf}rLf(a){this.Ma.addHandler(Ow.Ube,
a)}FDh(a){this.Ma.removeHandler(Ow.Ube,a)}fc(a,b){const c=this.Fef!==a;this.eHf=a;this.isActive&&this.je&&c&&(this.Vg(),this.Jb());this.vqf=b}activate(){!this.isActive&&this.KRf&&(this.Jb(),this.Tja=!0)}deactivate(a){this.isActive&&(this.Vg(),a&&this.flush(),this.Tja=!1)}flush(){if(this.isActive&&this.KRf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.BWb&&da.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
a.length-this.BWb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.BWb=0);const c=[];for(let f=this.BWb;f<a.length;f++)this.LKd.pBg(a[f].name)&&(this.I5a&&(this.B$h?this.I5a.Wcm(a[f]):this.I5a.Vcm(a[f])),c.push(new lr(a[f],this.I9i)));b||(this.BWb=a.length);this.Ma.raiseEvent(Ow.Ube,new LK(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.jif.Kfb(0,c[a].Pef());0<c.length&&
da.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){da.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}Kfb(a,b){da.ULS.sendTraceTag(4310804,306,50,JK(a,b))}vtl(){this.I5a.rul()}Ife(a){return this.I5a.Ife(a)}Jb(){this.je&&0<this.Fef&&(this.Wn=new ne.a(3,2,1E3*this.Fef,()=>{this.flush()},5),this.je.Jb(this.Wn),this.mPd=!0)}Vg(){this.mPd&&(this.je.Vg(this.Wn),this.Wn=null,
this.mPd=!1)}}Ow.Ube="EntriesAvailable";Object(m.a)(Ow,"ResourceTimingLogger",null,[1709,1804]);class CE{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");Hs.instance.Lh()}dispose(){}fc(a){this.Da=a;let b=null;if(A.AFrameworkApplication.fa.getBooleanAppSetting("ResourceLoggerFilterDomainsIsEnabled"))try{b=A.AFrameworkApplication.fa.hz("ResourceLoggerDomainAllowList")}catch(u){da.ULS.sendTraceTag(51652512,306,50,
"ResourceTimingPackage - failed to get logger domain allowlist")}const c=[];c.push(oe.a.GD(Kq.a.YN).toLowerCase());c.push(oe.a.GD(Kq.a.JRb).toLowerCase());const f=A.AFrameworkApplication.fa.tc("AppStaticResourceMonitorCacheThresholdInMs",100),l=A.AFrameworkApplication.fa.getBooleanAppSetting("PPTAggregateResourceTimingV2Enabled");a.register(1709,"Common.NetworkTiming.IResourceTimingLogger").ma().na(()=>new Ow(A.AFrameworkApplication.Be,window.performance,b,c,f,l))}static main(){C.a.instance.Ac(new CE)}}
Object(m.a)(CE,"ResourceTimingPackage",null,[2,3]);class Pw{}Pw.visible="visible";Pw.hidden="hidden";Object(m.a)(Pw,"PlatformVisibilityState",null,[]);var zB=d(204);class MK extends Sys.EventArgs{constructor(a,b){super();this.azf={};this.cki=a;this.Lji=b}get oldState(){return this.cki}get newState(){return this.Lji}Mmb(a,b){this.azf[a]=b}toString(){return Fe.c(this.azf)}}Object(m.a)(MK,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class DE{constructor(a,b,c,f){this.cHf=this.gSa=null;this.FFf=
!0;this.Ipd=l=>{this.PTb(l.type,this.Vle())};this.Coh=l=>{this.PTb(l.type,0)};this.Doh=l=>{3!==this.J9a&&(this.uXf(),this.PTb(l.type,2),this.PTb(l.type,3),A.AFrameworkApplication.gh.oWk())};this.s0j=()=>{this.gSa=null;this.PTb("TaskItem",this.Vle())};this.lEk=l=>{da.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",l.iLg,+new Date-+this.cHf,zB.SessionStatusManager.instance.Oma)};this.Ma=new uc.a;this.je=a;this.lMd=b;this.Cqf=c;this.zri=f;this.Owf=
!1;A.AFrameworkApplication.fa&&(this.Owf=A.AFrameworkApplication.fa.getBooleanAppSetting("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),this.FFf=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.Vnf=0;this.bHf=new Date;this.lMd()===Pw.hidden&&this.j0f();$addHandler(window,"focus",this.Coh);$addHandler(window,"blur",this.Ipd);$addHandler(document,"freeze",this.Doh);$addHandler(document,"visibilitychange",Object(R.a)(this,this.Eoh,
"onPlatformVisibilityChangeHandler"));this.FFf&&($addHandler(document,"pageshow",this.Ipd),$addHandler(document,"resume",this.Ipd))}get J9a(){return this.Vnf}get isVisible(){return 2!==this.J9a}uOc(a){this.Ma.addHandler("VST",a)}YBl(a){this.Ma.removeHandler("VST",a)}Vle(){return this.lMd()===Pw.hidden?2:document.hasFocus()?0:1}PTb(a,b){const c=this.J9a;this.Vnf=b;if(c!==this.J9a){3===c&&this.Owf&&this.HKl();const f=new Date,l=new MK(c,this.J9a);l.Mmb("FromState",mh[c]);l.Mmb("ToState",mh[b]);l.Mmb("OriginatingEvent",
a);l.Mmb("TimeInState",(+f-+this.bHf).toString());this.bHf=f;this.zri.UKg(l);this.Ma.raiseEvent("VST",l)}}Eoh(a){this.lMd()===Pw.hidden?this.gSa?this.je.G7(this.gSa,this.Cqf):this.j0f():(this.uXf(),this.PTb(a?a.type:"",this.Vle()))}dispose(){$removeHandler(window,"focus",this.Coh);$removeHandler(window,"blur",this.Ipd);$removeHandler(document,"freeze",this.Doh);$removeHandler(document,"visibilitychange",Object(R.a)(this,this.Eoh,"onPlatformVisibilityChangeHandler"))}uXf(){this.gSa&&(this.je.Vg(this.gSa),
this.gSa=null)}j0f(){this.gSa=new ne.a(4,1,this.Cqf,this.s0j,157);this.je.Jb(this.gSa)}HKl(){this.cHf=new Date;this.je.Jb(this.Z6b(0,"Realtime"));this.je.Jb(this.Z6b(1,"AboveNormal"));this.je.Jb(this.Z6b(2,"Normal"));this.je.Jb(this.Z6b(3,"Background"));this.je.Jb(this.Z6b(4,"Low"))}Z6b(a,b){return new ne.a(a,1,0,this.lEk,0,b)}}Object(m.a)(DE,"VisibilityManager",null,[484,106]);class lS{UKg(){}}Object(m.a)(lS,"NullVisibilityManagerTelemetry",null,[1042]);class AB{constructor(){this.Ma=new uc.a}UKg(a){da.ULS.sendTraceTag(590901976,
324,50,a.toString())}static create(){return new AB}}Object(m.a)(AB,"VisibilityManagerTelemetry",null,[1042]);class EE{constructor(){this.Da=null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Da.ub("Common.App.VisibilityManagement.VisibilityManager");a&&a.dispose()}fc(a){this.Da=a;this.Da.register(AB,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").na(()=>
AB.create()).ma();this.Da.register(DE,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").na(()=>new DE(A.AFrameworkApplication.Be,()=>window.document.visibilityState,6E4*A.AFrameworkApplication.fa.tc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){C.a.instance.Ac(new EE)}}Object(m.a)(EE,"VisibilityManagerPackage",null,[2,3]);var mS=d(1283);
class NK{constructor(a,b){this.ncd=new Md.a;this.rcd=new Md.a;this.lKa=b;this.qZa=a}qq(a){!a||this.ncd.Ib(a.id)||this.rcd.Ib(a.id)||this.qZa.qq(a)}MBh(a){this.fwl(a)}NBh(a){this.hwl(a)}fwl(a){var b=null;this.lKa&&a&&(this.qq(a),b=b||Object(R.a)(this,this.nUe,"onDragOver"),this.ncd.$(a.id,b),this.qZa.xb(la.a.drop,a,b))}hwl(a){var b=null;this.lKa&&a&&(this.qq(a),b=b||Object(R.a)(this,this.oUe,"onDrop"),this.rcd.$(a.id,b),this.qZa.xb(la.a.Rab,a,b))}Hb(a){this.lKa&&a&&(this.qZa.Wr(a),this.ncd.ga(a.id)&&
this.qZa.Hb(la.a.Rab,a,this.ncd.ga(a.id)),this.rcd.ga(a.id)&&this.qZa.Hb(la.a.drop,a,this.rcd.ga(a.id)))}U5j(){this.qZa&&this.qZa.dispose()}oUe(a){a=a.hc;a.preventDefault();a.stopPropagation();return!0}nUe(a){a=a.hc;a.preventDefault();a.stopPropagation();return!0}}Object(m.a)(NK,"PPTDragDropInputHelper",null,[737]);class FE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}fc(a){if(!a)throw Error.argumentNull("container");this.K=a;this.K.register(737,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().na(()=>
new NK(mS.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").h0d;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").MBh(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").NBh(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").MBh(this.K.resolve("PowerPointWebEditor.AppFrame").M3),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").NBh(this.K.resolve("PowerPointWebEditor.AppFrame").M3))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Hb(this.K.resolve("PowerPointWebEditor.AppFrame").h0d);
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").U5j()}static main(){C.a.instance.Ac(new FE)}}Object(m.a)(FE,"PPTWebEditorDragDropPackage",null,[2,3]);class OK{constructor(a){this.Bli=a}M9e(){return Math.random()<this.Bli}}Object(m.a)(OK,"RandomSampler",null,[652]);class PK{constructor(a){this.UXb=null;this.moi=a}h3b(a,b){if("ForceSample"===b||this.moi())this.UXb||(this.UXb=[]),Array.add(this.UXb,a)}getData(){return this.UXb}reset(){this.UXb=null}}Object(m.a)(PK,"SampleDataAggregator",
null,[613]);var QK=d(545);class RK{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(m.a)(RK,"PPTEventTimingData",null,[]);class mr{constructor(){this.cNe=!1;this.Naa={};this.yQk=a=>{window.requestAnimationFrame(a)};this.cHb=[];this.Naa.ArrowDown=!0;this.Naa.ArrowLeft=!0;this.Naa.ArrowRight=!0;this.Naa.ArrowUp=!0;this.Naa.Backspace=!0;this.Naa.Delete=!0;this.Naa.End=!0;this.Naa.Enter=!0;this.Naa.Home=!0;this.Naa.PageDown=!0;this.Naa.PageUp=!0;this.Naa.Tab=
!0}tyc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.Naa}SKi(a){const b={};b.key=this.tyc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();return b}EUh(a){const b=new RK;b.metadata=this.SKi(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=mr.ATa?(!mr.ATa.amIAlone).toString():"null";this.cHb.push(b);this.yxl()}TUh(a){if(this.cHb.length)for(const b of this.cHb)if(b.timeStamp===
a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}yxl(){this.cNe||(this.yQk(()=>{this.cNe=!1;window.dispatchEvent(QK.a.instance.create(la.a.M_d,this.cHb.slice(0,this.cHb.length)));this.cHb=[]}),this.cNe=!0)}keyPressedEventHandlerStart(a){mr.$6c(a)&&!this.tyc(a)&&this.EUh(a)}keyPressedEventHandlerEnd(a){mr.$6c(a)&&!this.tyc(a)&&this.TUh(a)}keyDownEventHandlerStart(a){mr.$6c(a)&&this.tyc(a)&&this.EUh(a)}keyDownEventHandlerEnd(a){mr.$6c(a)&&this.tyc(a)&&this.TUh(a)}static get ATa(){return mr.eYf||
(mr.eYf=Tb.a.instance.ub("PowerPointWebEditor.ICoauthStateGetter"))}static $6c(a){return!!a&&a.timeStamp<window.performance.now()}}mr.eYf=null;Object(m.a)(mr,"PPTEventTimingMeter",null,[743]);class Is{constructor(){this.fkc=[];this.NIb=this.Wfd=this.VJa=this.Nid=null;this.Mid=0;this.Bfd=!1}start(a){if(!this.Bfd){Array.clear(this.fkc);for(let b=0;b<Is.v$b.length;++b)this.fkc.push(0);this.Nid=window.setInterval(Object(R.a)(this,this.vFh,"reportMeasuredFrames"),1E3*a);this.Mid=window.performance.now();
this.Jhf(null);$addHandler(window,"visibilitychange",Object(R.a)(this,this.Jhf,"updateMeasureCurrentFrameLoop"));this.Bfd=!0}}stop(){this.Bfd&&($removeHandler(window,"visibilitychange",Object(R.a)(this,this.Jhf,"updateMeasureCurrentFrameLoop")),null!=this.Nid&&(window.clearInterval(this.Nid),this.Nid=null),null!=this.VJa&&(window.cancelAnimationFrame(this.VJa),this.VJa=null),this.vFh(),this.Bfd=!1)}vFh(){if(null!=this.NIb){var a={};for(var b=0;b<Is.v$b.length;++b)a[Is.v$b[b].toString()]=this.fkc[b],
this.fkc[b]=0;b=window.performance.now();var c={};c.intervalStart=this.Mid;c.duration=b-this.Mid;c.maxFrameLengthMs=this.NIb;c.frameData=a;window.dispatchEvent(QK.a.instance.create(la.a.k4e,c));this.NIb=null;this.Mid=b}}Jhf(){Is.ank&&null==this.VJa?(this.Wfd=null,this.VJa=window.requestAnimationFrame(Object(R.a)(this,this.Ugh,"measureCurrentFrame"))):null!=this.VJa&&(window.cancelAnimationFrame(this.VJa),this.VJa=null)}Ugh(a){if(null!=this.Wfd){const b=a-this.Wfd;if(null==this.NIb||this.NIb<b)this.NIb=
b;for(let c=0;c<Is.v$b.length;++c)if(b<Is.v$b[c]){++this.fkc[c];break}}this.Wfd=a;this.VJa=window.requestAnimationFrame(Object(R.a)(this,this.Ugh,"measureCurrentFrame"))}static get ank(){return"visible"===window.document.visibilityState}}Is.v$b=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(m.a)(Is,"PPTFrameTimingMeter",null,[744]);class GE{constructor(){this.Cnc=this.Qhc=null;this.lWg=this.ZVg=!1}fc(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&
(A.AFrameworkApplication.fa.getBooleanAppSetting("PodEventTimingMeterIsEnabled")&&!E.a.Gk&&(a.register(743,"Common.IEventTimingMeter").ma().na(()=>new mr),this.ZVg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&(a.register(744,"Common.IFrameTimingMeter").ma().na(()=>new Is),this.lWg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.ZVg){var a=new OK(A.AFrameworkApplication.fa.tc("PodEventTimingMeterEventSamplingPercent",0)/100);a=
new PK(Object(R.a)(a,a.M9e,"shouldBeInSample"));const b=Xq.a.XX(16,1,a);this.Qhc=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};Ae.a.addHandler(window.self,la.a.M_d,this.Qhc)}this.lWg&&(this.Cnc=b=>{b&&(b=b.rawEvent)&&ya.a.J(39706653,306,50,Fe.c(b.detail))},Ae.a.addHandler(window.self,la.a.k4e,this.Cnc))}dispose(){this.Qhc&&(Ae.a.removeHandler(window.self,la.a.M_d,this.Qhc),this.Qhc=null);this.Cnc&&(Ae.a.removeHandler(window.self,la.a.k4e,this.Cnc),this.Cnc=null)}static main(){C.a.instance.Ac(new GE)}}
Object(m.a)(GE,"PPTEventTimingMeterPackage",null,[2,3]);var HE=d(459);class SK{constructor(a){this.Kzf=new Md.a(null);this.oei=a}ga(a){let b;(()=>{let c=this.Kzf.Eg(a);({value:b}=c);return c})().returnValue||(b=this.oei(a),this.Kzf.$(a,b));return b}}Object(m.a)(SK,"MemoizedLookup",null,[800]);var nS=d(1085);class It{MZc(a,b){return new nS.a(a,b,It.eyd,ad.App.mode,ad.App.webServiceBase,void 0,void 0,It.amIAlone,It.OGl,It.XEl)}static ztl(){let a,b,c;if(ad.App.$Ub){a=wacBoot.bootSettings.g_initialResponseTime;
var f=wacBoot.bootSettings.g_initialRequestInvokedTime;b=wacBoot.bootSettings.g_initialResponseReadyTime;c=wacBoot.bootSettings.g_fastViewOpenTime}else a=window.self.g_initialResponseTime,f=window.self.g_initialRequestInvokedTime,b=window.self.g_initialResponseReadyTime,c=window.self.g_fastViewOpenTime;void 0!==f&&null!==f&&(f=f.getTime(),xe.a.instance.OAh(f),Mg.a.instance.Xb(ii.a.B9j,f));void 0!==a&&null!==a&&(xe.a.instance.NAh(a.getTime()),Mg.a.instance.Xb(ii.a.D9j,a.getTime()));void 0!==b&&null!==
b&&Mg.a.instance.Xb(ii.a.C9j,b.getTime());void 0!==c&&null!==c&&Mg.a.instance.Xb(ii.a.Nlj,c.getTime())}static XEl(a){It.ztl();ad.App.$Ub?(a.rwc=wacBoot.bootSettings.g_initialRequestResponseObject,wacBoot.bootSettings.g_initialRequestResponseObject=null,a.Et=wacBoot.bootSettings.g_initialRequestInvokedTime):(a.rwc=window.self.g_initialRequestResponseObject,window.self.g_initialRequestResponseObject=null,a.Et=window.self.g_initialRequestInvokedTime)}static OGl(){return ad.App.$Ub?wacBoot.bootSettings.g_initialResponseTime:
window.self.g_initialResponseTime}static amIAlone(){return!ad.App.ni||ad.App.ni.amIAlone}}It.eyd="OneNote.ashx";Object(m.a)(It,"BatchedServerOperationFactory",null,[1040]);var oS=d(729);class IE{constructor(a){this.uel=0;this.eQ=a}}Object(m.a)(IE,"GraphMergerResponse",null,[]);var pS=d(372);class JE extends Yg.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Reason=this.Source=0}om(){return 33}static construct(a,b,c,f,l,u,I,T,ja){const ua=new JE;ua.BaseRevisions=a;ua.TheirRevisions=b;ua.YourRevisions=c;ua.IgnoreConflictsInLastServerRevision=f;ua.MergeHint=l;ua.ObjectSpaceId=u?Ui.a(u):null;ua.RequestId=I?Ui.a(I):null;ua.Source=T;ua.Reason=ja;return ua}}Object(m.a)(JE,"CreateGraphMergeReplayRequest",Yg.a,[]);d(858);class BB{Qa(a){return a.Qa(void 0)}fng(a,b){return a.ra(b,null)}z1c(a,b){a=(a=a.ra(b,null))?Array.clone(a):[];return new fk.a(a)}ing(a,
b){return a.ra(b,"")}ZMh(a,b,c){a.setValue(b,c)}}Object(m.a)(BB,"MergeableObjectUtilities",null,[693]);class qS{constructor(a,b,c){c=void 0===c?null:c;this.OQd=(void 0===b?null:b)||new BB;c||Object(R.a)(this,this.udj,"doParagraphMergeNoOP")}udj(a,b){return{XCm:a,WCm:b}}}Object(m.a)(qS,"GraphMergeSelectionRecordUpdater",null,[]);class TK{constructor(){this.source=0;this.Rw=this.fVb=this.xOa=null;this.Jpc=0;this.q4c=!1;this.Sbf=0}}Object(m.a)(TK,"InputState",null,[]);class UK{constructor(){this.timeout=
this.succeeded=this.crash=!1;this.eQ=null}}Object(m.a)(UK,"OutputState",null,[]);class VK{constructor(){this.oZc=this.qAd=this.Eyc=!1;this.A4a=this.Ffm=this.Qlj=this.jRe=this.V0h=this.tbg=this.KQf=this.BSc=null}}Object(m.a)(VK,"RuntimeState",null,[]);class WK{constructor(){this.input=new TK;this.runtime=new VK;this.output=new UK}}Object(m.a)(WK,"MergeState",null,[]);var nd=d(1138);class ez{constructor(a,b,c){this.Tli=a;this.dki=b;this.Mji=c;this.YNd=new Hc.a(Object(R.a)(this,this.YRi,"checkIfDifferent"))}get aOb(){return this.Tli}get oldValue(){return this.dki}get newValue(){return this.Mji}get F$(){return!!this.newValue&&
!this.oldValue}get isDeleted(){return!this.newValue&&!!this.oldValue}get teb(){return this.F$||this.isDeleted||this.YNd.value}YRi(){return this.F$||this.isDeleted?!0:!nd.a.APf(this.aOb,this.oldValue,this.newValue)}}Object(m.a)(ez,"PropertyDiff",null,[]);class fz{constructor(a,b){this.aki=a;this.Jji=b;this.YNd=new Hc.a(()=>this.N6c(null));this.Vli=new Hc.a(Object(R.a)(this,this.Qij,"evaluatePropertyDiffs"))}get YLb(){return this.aki}get l7(){return this.Jji}get F$(){return!!this.l7&&!this.YLb}get isDeleted(){return!this.l7&&
!!this.YLb}get teb(){return this.F$||this.isDeleted||this.YNd.value}get T1a(){return this.Vli.value}N6c(a){let b=!1;this.T1a.forEach((c,f)=>{b=f.teb&&(!a||7!==a.ga(c));return!b});return b}Qij(){const a=new Md.a;var b=this.l7,c=this.YLb;if(this.F$){c=b.ZA();for(var f=0;f<c.length;f++){var l=c[f];a.$(nd.a.Ab(l),new ez(l,null,b.rva(l)))}}else if(this.isDeleted)for(b=c.ZA(),f=0;f<b.length;f++)l=b[f],a.$(nd.a.Ab(l),new ez(l,c.rva(l),null));else{f=c.ZA();for(l=0;l<f.length;l++){var u=f[l];let I=nd.a.Ab(u);
const T=c.rva(u),ja=b.Qa(u)?b.rva(u):null;a.$(I,new ez(u,T,ja))}f=b.ZA();for(l=0;l<f.length;l++)u=f[l],c.Qa(u)||a.$(nd.a.Ab(u),new ez(u,null,b.rva(u)))}return a}}Object(m.a)(fz,"MergeableObjectDiff",null,[]);class gz{constructor(a,b){this.i7=b?a.O$a():a;this.vMc=new Ba.a}CUl(a){this.vMc=a}ihh(a){(new fz(this.i7,a)).T1a.forEach((b,c)=>{c.teb&&!this.vMc.contains(b)&&(this.vMc.add(b),c.isDeleted?(c=this.i7,c.Qa(nd.a.Wua(b))&&c.removeProperty(nd.a.Wua(b))):this.i7.zNa(nd.a.Wua(b),c.newValue));return!0})}}
Object(m.a)(gz,"PartialMergeResult",null,[]);class XK extends Yg.a{constructor(){super();this.Location=null}om(){return 34}static construct(a){const b=new XK;b.Location=a;return b}}Object(m.a)(XK,"PlayGraphMergeReplayRequest",Yg.a,[]);class Qw{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.kCe=new It;this.fRk=a;this.gNk=b;this.x_a=c(this.Gac());this.FJk=f;this.GJk=l;this.ajd=u;this.Egd=I;this.NSg=T;this.CJk=Ra;this.DJk=ja;this.EJk=ua}yM(){return(new Date).getTime()}Wob(a,...b){return String.format.apply(null,
[a].concat(b))}w$l(a){throw Z.a.invalidOperation(a);}XAj(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)}IXj(a,b,c,f){f.$(a,new gz(b,!1));da.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.hf);return!0}Sjm(a,b){const c=new In.a;c.id=ni.a.mia;c.zNa(yb.a.swd,5===b?2:4);a.JKf(c);a.iDd().yAa(c.id,4)}nMl(a){var b=!a.output.succeeded&&(this.DJk||a.output.crash),c=!!a.input.xOa&&
0<a.input.xOa.length;if(c=this.EJk&&c&&(this.CJk||b)){b=c?Ua.a.create():Ua.a.nil;c=c?String.format(" [Merge Request Id: {0}]",b):"";Qw.GBk(a,c);var f,l;({FHi:u,q$l:f,Xpm:l}=this.A6i(a,Object(R.a)(this,this.Z1f,"createSerializedRevisionFrom")));c=Qw.gCj(a);b=JE.construct(u._list,f._list,l._list,a.input.q4c,a.input.Jpc,a.input.Rw,b,a.input.source,c);var u=a.output.eQ;3===c&&0<u.length&&(b.MergedRevision=this.Z1f(a.output.eQ.last()));a=new pS.a;a.hL=b;a.status=1;b=this.kCe.MZc(0,null);b.A4(a);b.$yb()}}Z1f(a){const b=
a.zX,c=ad.App.Ob.ie.qj;return new oS.a(a,b,c.ij,null,c.Avc,c.contextId,b?b.id:Ua.a.nil,this.ajd,!1,!0)}smd(a,b,c,f,l,u,I){c=this.J4i(a,b,f,l,u,I);f=0;const T=c.runtime.qAd;try{if(T){const ja=a.length?a.getItemAt(a.length-1):null,ua=b.length?b.getItemAt(b.length-1):null;da.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",
a.length,ja?ja.id:Ua.a.nil,ja?ja.zX?ja.zX.id:Ua.a.nil:Ua.a.nil,b.length,ua?ua.id:Ua.a.nil,ua?ua.zX?ua.zX.id:Ua.a.nil:Ua.a.nil,l,u,this.Egd,this.NSg,I)}for(a=!0;f<this.x_a.length&&a;f++)a=(0,this.x_a[f])(c);return new IE(c.output.eQ)}catch(ja){const ua=!c.output.timeout;c.output.crash=ua;const Ra=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",ua?"Crashed":"Timed Out",this.XAj(ja),!!c.output.eQ);ua?da.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Ra):
da.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",Ra);if(c.output.eQ)return new IE(c.output.eQ);throw ja;}finally{c.output.succeeded?T&&da.ULS.sendTraceTag(18613138,808,50,this.hac(c,f,"Succeeded")):c.output.timeout?da.ULS.sendTraceTag(18641178,808,15,this.hac(c,f,"Timeout")):c.output.crash?c.output.eQ?da.ULS.sendTraceTag(18613142,808,15,this.hac(c,f,"Crash - Rejection")):da.ULS.sendTraceTag(18613144,808,15,this.hac(c,f,"Crash - Failed")):T&&da.ULS.sendTraceTag(18613140,808,
50,this.hac(c,f,"Rejection")),this.nMl(c)}}hac(a,b,c){const f=a.output.eQ,l=f&&f.length?f.getItemAt(f.length-1):null;return this.Wob("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.yM()-a.input.Sbf,b,f?f.length:0,l?l.id:Ua.a.nil,l?l.zX?l.zX.id:Ua.a.nil:Ua.a.nil,a.input.source)}J4i(a,b,c,f,l,u){const I=new WK,T=I.input;T.xOa=a;T.fVb=b;T.Rw=c;T.Jpc=f;T.q4c=l;T.Sbf=this.yM();T.source=u;a=I.runtime;a.oZc=this.NSg;a.Eyc=
!0;a.qAd=!0;let ja="";a.A4a=ua=>{if(this.Egd){var Ra=this.yM()-T.Sbf,eb=Ra>this.Egd;ja+=this.Wob(" ({0}: {1})",ua,Ra);eb&&(I.output.timeout=!0,ua=this.Wob("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.Egd,ua,Ra,ja),this.w$l(ua))}};return I}Gac(){return[Object(R.a)(this,this.Dbl,"otherAuthorsHaveChangesToMerge"),Object(R.a)(this,this.rkk,"isInputValid"),Object(R.a)(this,this.Q$j,"initializeOutputMergeState"),Object(R.a)(this,this.kak,"initializeRuntimeMergeState"),
Object(R.a)(this,this.fem,"tryObjectMerge"),Object(R.a)(this,this.$ui,"addMergeResultsToOutput")]}Dbl(a){const b=a.input.xOa;a=a.output;return b?b.length?!0:(da.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.eQ=b,a.succeeded=!0,!1):(da.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.eQ=b,a.succeeded=!0,!1)}rkk(a){var b=a.input;const c=b.xOa,f=b.fVb,l=b.Rw,u=b.Jpc;b=b.q4c;
a=a.output;if(!f||!f.length)return a.eQ=c,!1;let I=!0;if(2!==u&&1!==u)return a.eQ=c,!1;l&&l!==Ua.a.nil||(I=!1);c.length<(b?2:1)&&(da.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),I=!1);I||(a.eQ=2===u?c:f);return I}kak(a){var b=a.input,c=b.xOa,f=b.fVb;const l=b.Jpc;let u,I;({p$l:u,Wpm:I,BSc:b}=this.cEj(a,c,f,b.q4c));if(!b)return da.ULS.sendTraceTag(18613185,
808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",u.id,I.id),this.GKg(u,c.length,"TheirChanges"),this.GKg(I,f.length,"YourChanges"),a.output.eQ=2===l?c:f,!1;a.runtime.BSc=b;({Dfm:c,Olj:f}=this.lbj(l,u,I));({Efm:b,Plj:c,GHi:f}=Qw.OFj(a,c,f,b));a.runtime.KQf=f;a.runtime.V0h=b;a.runtime.tbg=c;a.runtime.jRe=new Md.a;return!0}GKg(a,b,c){const f=new fk.a;for(;a;)f.add(a),a=a.zX;const l=new Sys.StringBuilder;l.append(this.Wob("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
c,b,f.length));let u=f.length,I=0;f.forEach(T=>(()=>{let ja=this.ewi(l,T,f,u,I);({jwg:u,hLg:I}=ja);return ja})().returnValue);da.ULS.sendTraceTag(18613187,808,50,l.toString())}ewi(a,b,c,f,l){a.append(this.Wob(" [{0} {1} {2}]",f,b.sna?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,jwg:f,hLg:l}):{returnValue:!0,jwg:f,hLg:l}}cEj(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.l_c(c);a.runtime.A4a("GetCommonBase");return{p$l:b,Wpm:c,
BSc:f}}lbj(a,b,c){2===a?(a=b,b=c):a=c;return{Dfm:b,Olj:a}}Q$j(a){const b=a.input,c=b.xOa,f=b.fVb;a.output.eQ=(2===b.Jpc?c:f).UVl();a.runtime.A4a("InitializeOutputMergeState");return!0}$ui(a){var b=a.input.Rw;const c=a.runtime.jRe,f=a.output.eQ;b=this.K4i(a,f.getItemAt(f.length-1),b,Ua.a.create());this.Nmj(a,b,c);this.Sjm(b,a.input.source);f.add(b);return a.output.succeeded=!0}K4i(a,b,c,f){a.runtime.qAd&&da.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
c,f);a=this.fRk(f);a.WHi(b,c);return a}Nmj(a,b,c){a.runtime.qAd&&da.ULS.sendTraceTag(18613191,808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{ni.a.mia.equals(f)||b.JKf(l.i7);return!0})}fem(a){const b=a.runtime,c=b.KQf,f=b.V0h,l=b.tbg,u=b.jRe;let I=!0;const T=a.runtime.Eyc;let ja=0,ua=0,Ra=0;f.forEach((eb,Bb)=>{T&&da.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",eb,Bb.hf);ua++;50===ua&&(ja++,a.runtime.A4a(this.Wob("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",
ja,Ra)),ua=0);if(Qw.w2l(Bb.hf))return!0;var Ub=l.get(eb);if(!Ub)return u.Ib(eb)?u.ga(eb).ihh(Bb):u.$(eb,new gz(Bb,!1)),!0;if(!c.ga(eb))return I=this.IXj(eb,Ub,Bb,u);const Xb=u.c1c(eb,new gz(c.ga(eb),!0));({Fba:Ub,returnValue:I}=this.GJk.merge(a,this.FJk,this.gNk,Xb,Ub,Bb));Ra++;I&&(a.runtime.A4a(this.Wob("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",eb,Bb.hf,Ra,ja)),Ub&&(u.Ib(Ub.i7.id)?u.ga(Ub.i7.id).ihh(Ub.i7):u.$(Ub.i7.id,Ub)));return I});T&&da.ULS.sendTraceTag(18613199,
808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",f.count,Ra);return I}A6i(a,b){const c=new fk.a,f=new fk.a,l=new fk.a;var u=a.runtime.BSc;const I=u?u.id:Ua.a.nil;this.$ze(u).forEach(T=>{c.add(b(T));return!0});u=a.input.xOa.getItemAt(a.input.xOa.length-1);this.$ze(u,I).forEach(T=>{f.add(b(T));return!0});a=a.input.fVb.getItemAt(a.input.fVb.length-1);this.$ze(a,I).forEach(T=>{l.add(b(T));return!0});return{FHi:c,q$l:f,Xpm:l}}$ze(a,b){b=void 0===b?null:b;const c=new fk.a;b||(b=Ua.a.nil);
for(;a&&!b.equals(a.id);)c.add(a),a=a.zX;c.reverse();return c}qb(){}get Kyb(){return null}set Kyb(a){}static GBk(a,b){da.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static gCj(a){return a.output.crash?2:a.output.succeeded?3:1}static OFj(a,b,c,f){let l;({result:l}=b.umd(f));a.runtime.A4a("GetUnfavoredChanges");let u;new Md.a;({result:u}=c.umd(f));5===a.input.source&&(a.runtime.Qlj=HE.a.ung(c.iDd()),a.runtime.Ffm=HE.a.ung(b.iDd()));
b=u;a.runtime.A4a("GetFavoredChanges");f=new SK(Object(R.a)(f,f.rBb,"getMergeableObject"));a.runtime.A4a("GetModifiedObjects");return{Efm:l,Plj:b,GHi:f}}static w2l(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(m.a)(Qw,"GraphMerger",null,[989,890]);class YK{get lFa(){return 8}get LMa(){return[]}get ePa(){return[nd.a.Ab(yb.a.XN),nd.a.Ab(yb.a.hAc)]}get WOa(){return[]}get tTa(){return[nd.a.Ab(rb.a.mC)]}get iUa(){return[]}pH(a){return 1074135126===a.hf}K4a(){return!0}get kFa(){return[nd.a.Ab(yb.a.cid),
nd.a.Ab(yb.a.sid)]}get O3a(){return!0}}Object(m.a)(YK,"CommentContentNodeComplexMerge",null,[988]);class ZK{get lFa(){return 8}get LMa(){return[]}get ePa(){return[nd.a.Ab(yb.a.Oxb),nd.a.Ab(yb.a.W5d),nd.a.Ab(yb.a.Mxb),nd.a.Ab(yb.a.$5b),nd.a.Ab(yb.a.dZe),nd.a.Ab(yb.a.cZe),nd.a.Ab(yb.a.XN),nd.a.Ab(yb.a.hAc),nd.a.Ab(yb.a.d5d)]}get WOa(){return[nd.a.Ab(yb.a.xea),nd.a.Ab(yb.a.Uta),nd.a.Ab(yb.a.L5d),nd.a.Ab(yb.a.a6b),nd.a.Ab(yb.a.sSc),nd.a.Ab(yb.a.reactions)]}get tTa(){return[]}get iUa(){return[]}pH(a){return 1074135127===
a.hf}K4a(){return!0}get kFa(){return[nd.a.Ab(yb.a.cid),nd.a.Ab(yb.a.sid),nd.a.Ab(yb.a.commentId),nd.a.Ab(yb.a.tza),nd.a.Ab(ib.a.M5d),nd.a.Ab(yb.a.O5d),nd.a.Ab(yb.a.a6b),nd.a.Ab(yb.a.sSc),nd.a.Ab(yb.a.reactions)]}get O3a(){return!0}}Object(m.a)(ZK,"CommentNodeComplexMerge",null,[988]);class Rw{constructor(a){this.Kjd=a}get lFa(){return 8}get LMa(){return[]}get ePa(){return this.Kjd.ePa}get WOa(){return[]}get tTa(){return[nd.a.Ab(rb.a.mC)]}get iUa(){return[]}pH(a){return 393326===a.hf}K4a(){return!0}get kFa(){const a=
new La.a;Rw.addRange(a,this.Kjd.LMa);Rw.addRange(a,this.Kjd.kFa);Rw.addRange(a,this.Kjd.WOa);Rw.addRange(a,[nd.a.Ab(yb.a.rEb),nd.a.Ab(yb.a.Ind)]);return a.toArray()}get O3a(){return!0}static addRange(a,b){for(const c of b)a.add(c)}}Object(m.a)(Rw,"NotesContentNodeComplexMerge",null,[988]);class $K{get lFa(){return 8}get LMa(){return[nd.a.Ab(yb.a.Jdj),nd.a.Ab(yb.a.Ddj),nd.a.Ab(yb.a.wdc),nd.a.Ab(yb.a.DWl)]}get ePa(){return[nd.a.Ab(yb.a.Jvb),nd.a.Ab(yb.a.Kvb),nd.a.Ab(yb.a.Uvb),nd.a.Ab(yb.a.Vvb),nd.a.Ab(yb.a.rFa),
nd.a.Ab(yb.a.ZRe),nd.a.Ab(yb.a.DRe),nd.a.Ab(yb.a.$Re),nd.a.Ab(yb.a.zPb),nd.a.Ab(yb.a.BPb),nd.a.Ab(yb.a.SCb),nd.a.Ab(yb.a.Qyb),nd.a.Ab(yb.a.rlb)]}get WOa(){return[]}get tTa(){return[nd.a.Ab(rb.a.ITa),nd.a.Ab(ib.a.appsNode)]}get iUa(){return[]}pH(a){return 393271===a.hf}get kFa(){return[nd.a.Ab(yb.a.presentationId),nd.a.Ab(yb.a.slideWidth),nd.a.Ab(yb.a.slideHeight),nd.a.Ab(yb.a.b_),nd.a.Ab(yb.a.Xba),nd.a.Ab(yb.a.rdb),nd.a.Ab(yb.a.cLb),nd.a.Ab(yb.a.DZ),nd.a.Ab(yb.a.PLb),nd.a.Ab(yb.a.Eha),nd.a.Ab(yb.a.embeddedFonts),
nd.a.Ab(yb.a.rMa)]}get O3a(){return!0}K4a(){return!0}}Object(m.a)($K,"PresentationNodeComplexMerge",null,[988]);class aL{get lFa(){return 8}get LMa(){return[nd.a.Ab(yb.a.KMa),nd.a.Ab(yb.a.WPb)]}get ePa(){return[nd.a.Ab(rb.a.font),nd.a.Ab(yb.a.ND),nd.a.Ab(yb.a.iRc),nd.a.Ab(yb.a.B1a),nd.a.Ab(yb.a.XN),nd.a.Ab(yb.a.d4a),nd.a.Ab(yb.a.Rn),nd.a.Ab(yb.a.z1a),nd.a.Ab(yb.a.UCb),nd.a.Ab(yb.a.Ifa),nd.a.Ab(yb.a.QNa),nd.a.Ab(yb.a.f3),nd.a.Ab(yb.a.Dra),nd.a.Ab(yb.a.M7b),nd.a.Ab(yb.a.nAb),nd.a.Ab(yb.a.$za),nd.a.Ab(yb.a.KAa),
nd.a.Ab(yb.a.gra),nd.a.Ab(yb.a.JAa),nd.a.Ab(yb.a.mediaType),nd.a.Ab(yb.a.B1a),nd.a.Ab(yb.a.fFb),nd.a.Ab(yb.a.Trh),nd.a.Ab(yb.a.Wrh),nd.a.Ab(yb.a.$qa),nd.a.Ab(yb.a.xia),nd.a.Ab(yb.a.ROh),nd.a.Ab(yb.a.Tzd),nd.a.Ab(rb.a.tm),nd.a.Ab(rb.a.xK),nd.a.Ab(yb.a.GXh),nd.a.Ab(yb.a.HXh),nd.a.Ab(yb.a.w4a),nd.a.Ab(yb.a.sOa),nd.a.Ab(yb.a.Aca),nd.a.Ab(yb.a.uAc),nd.a.Ab(yb.a.JN),nd.a.Ab(yb.a.outlineWidth),nd.a.Ab(Dr.a.axd),nd.a.Ab(yb.a.Nsd),nd.a.Ab(wm.a.oec),nd.a.Ab(yb.a.EO),nd.a.Ab(yb.a.mR),nd.a.Ab(yb.a.hAc),nd.a.Ab(yb.a.sSb),
nd.a.Ab(yb.a.V3a),nd.a.Ab(yb.a.rxb),nd.a.Ab(yb.a.mFb),nd.a.Ab(yb.a.zO),nd.a.Ab(yb.a.nTh),nd.a.Ab(yb.a.VCb)]}get WOa(){return[nd.a.Ab(yb.a.alt),nd.a.Ab(yb.a.jEa),nd.a.Ab(yb.a.Hba),nd.a.Ab(yb.a.Rve),nd.a.Ab(yb.a.Fye),nd.a.Ab(yb.a.Yma),nd.a.Ab(yb.a.shapeType),nd.a.Ab(yb.a.lTb),nd.a.Ab(yb.a.rotation),nd.a.Ab(yb.a.Fwc),nd.a.Ab(yb.a.Qea),nd.a.Ab(yb.a.Pea),nd.a.Ab(rb.a.zy),nd.a.Ab(rb.a.XD),nd.a.Ab(rb.a.zz),nd.a.Ab(rb.a.Az),nd.a.Ab(yb.a.eVb),nd.a.Ab(yb.a.zCb),nd.a.Ab(yb.a.Ajf),nd.a.Ab(yb.a.Cjf),nd.a.Ab(yb.a.F4),
nd.a.Ab(yb.a.AQ),nd.a.Ab(yb.a.dla),nd.a.Ab(yb.a.bla),nd.a.Ab(yb.a.fla),nd.a.Ab(yb.a.ela),nd.a.Ab(yb.a.abf),nd.a.Ab(yb.a.Pzd),nd.a.Ab(yb.a.nia),nd.a.Ab(yb.a.Rzd),nd.a.Ab(yb.a.Awa),nd.a.Ab(yb.a.POc)]}get tTa(){return[nd.a.Ab(rb.a.mC)]}get iUa(){return[]}pH(a){return 1074135132===a.hf}K4a(){return!0}get kFa(){return[nd.a.Ab(yb.a.cid),nd.a.Ab(yb.a.sid),nd.a.Ab(yb.a.shapeId),nd.a.Ab(yb.a.VXa),nd.a.Ab(yb.a.t1a),nd.a.Ab(yb.a.Cha),nd.a.Ab(yb.a.Qgk),nd.a.Ab(yb.a.SM),nd.a.Ab(yb.a.isResizable),nd.a.Ab(yb.a.isEditable),
nd.a.Ab(yb.a.twa),nd.a.Ab(yb.a.kK),nd.a.Ab(yb.a.mj),nd.a.Ab(yb.a.ZS),nd.a.Ab(yb.a.BUa),nd.a.Ab(yb.a.CUa),nd.a.Ab(yb.a.pdb),nd.a.Ab(yb.a.Zfc),nd.a.Ab(yb.a.hasText),nd.a.Ab(yb.a.mY),nd.a.Ab(yb.a.Lq),nd.a.Ab(yb.a.isConnected),nd.a.Ab(yb.a.Lf),nd.a.Ab(yb.a.lwa),nd.a.Ab(yb.a.$r),nd.a.Ab(yb.a.dA),nd.a.Ab(yb.a.Vp),nd.a.Ab(yb.a.T$),nd.a.Ab(yb.a.Sk),nd.a.Ab(yb.a.jV),nd.a.Ab(yb.a.$j),nd.a.Ab(yb.a.ig),nd.a.Ab(yb.a.v1),nd.a.Ab(yb.a.Nq),nd.a.Ab(yb.a.Xu),nd.a.Ab(yb.a.Hta),nd.a.Ab(yb.a.$Oc),nd.a.Ab(yb.a.sxb),nd.a.Ab(rb.a.kP),
nd.a.Ab(ib.a.C1),nd.a.Ab(yb.a.wdc),nd.a.Ab(yb.a.Q7f),nd.a.Ab(yb.a.Uae),nd.a.Ab(yb.a.FDl),nd.a.Ab(yb.a.yvd),nd.a.Ab(yb.a.mg),nd.a.Ab(yb.a.Cnd),nd.a.Ab(yb.a.yne),nd.a.Ab(yb.a.nne),nd.a.Ab(yb.a.fM),nd.a.Ab(yb.a.bwa),nd.a.Ab(yb.a.h4b),nd.a.Ab(yb.a.VR),nd.a.Ab(yb.a.gUb),nd.a.Ab(yb.a.embeddedFonts),nd.a.Ab(yb.a.xHa),nd.a.Ab(yb.a.tAc),nd.a.Ab(yb.a.c6h),nd.a.Ab(yb.a.Pxh),nd.a.Ab(yb.a.m$c),nd.a.Ab(yb.a.Qzd),nd.a.Ab(yb.a.Dha),nd.a.Ab(yb.a.yqa),nd.a.Ab(yb.a.F5),nd.a.Ab(yb.a.JLb),nd.a.Ab(yb.a.LLb),nd.a.Ab(yb.a.MLb),
nd.a.Ab(yb.a.Bpa),nd.a.Ab(yb.a.K5)]}get O3a(){return!0}}Object(m.a)(aL,"ShapeNodeComplexMerge",null,[988]);class hz{constructor(a,b){this.VRk=a;this.JSk=b}get lFa(){return this.JSk}get LMa(){return[]}get ePa(){return[]}get WOa(){return[]}get tTa(){return[]}get iUa(){return[]}pH(a){return this.VRk(a)}K4a(){return!1}get kFa(){return[]}get O3a(){return!1}}Object(m.a)(hz,"SimpleStrategyComplexMerge",null,[988]);class bL{get lFa(){return 8}get LMa(){return[]}get ePa(){return[nd.a.Ab(yb.a.backgroundColor),
nd.a.Ab(yb.a.Bua),nd.a.Ab(yb.a.uef),nd.a.Ab(yb.a.Sca),nd.a.Ab(yb.a.gqa),nd.a.Ab(yb.a.Yba),nd.a.Ab(yb.a.Tx),nd.a.Ab(yb.a.Ata),nd.a.Ab(yb.a.EO),nd.a.Ab(yb.a.mR),nd.a.Ab(yb.a.XN),nd.a.Ab(yb.a.MAa)]}get WOa(){return[nd.a.Ab(yb.a.G4a),nd.a.Ab(yb.a.Oj),nd.a.Ab(yb.a.xo),nd.a.Ab(yb.a.Ld),nd.a.Ab(yb.a.animations),nd.a.Ab(yb.a.mZc),nd.a.Ab(yb.a.V_d)]}get tTa(){return[nd.a.Ab(rb.a.mC),nd.a.Ab(yb.a.notesContentNode),nd.a.Ab(ib.a.commentContentNode)]}get iUa(){return[]}pH(a){return 393227===a.hf}K4a(){return!0}get kFa(){return[nd.a.Ab(yb.a.cid),
nd.a.Ab(yb.a.sid),nd.a.Ab(yb.a.jR),nd.a.Ab(yb.a.OSh),nd.a.Ab(rb.a.Hn),nd.a.Ab(yb.a.rYa),nd.a.Ab(yb.a.Cfa),nd.a.Ab(yb.a.XGa),nd.a.Ab(yb.a.Bdb),nd.a.Ab(yb.a.title),nd.a.Ab(yb.a.b_),nd.a.Ab(yb.a.Xba),nd.a.Ab(yb.a.wdc),nd.a.Ab(yb.a.Adb),nd.a.Ab(yb.a.sdb),nd.a.Ab(yb.a.mg),nd.a.Ab(yb.a.yqa)]}get O3a(){return!0}}Object(m.a)(bL,"SlideNodeComplexMerge",null,[988]);class cL{constructor(a,b){this.dRg=a;this.EHk=b}ga(a){return this.dRg.c1c(a,this.EHk)}get bce(){return this.dRg}}Object(m.a)(cL,"PropertyMergeStrategies",
null,[]);const KE=(a,b,c,f,l)=>{if(b){f=f||new BB;if(!a){a=b=b.O$a();const u=a.ZA();for(let I=0;I<u.length;I++){const T=u[I];if(bp.a.Keg(T)===bp.a.string){const ja=f.ing(a,T);f.ZMh(a,T,ja?"Redacted: "+ja.length:"null")}}}da.ULS.sendTraceTag(18613206,l,50,c,b.hDd())}else da.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class dL{constructor(a,b,c){this.RNg=new Ba.a;this.Hgd=a;this.Hxa=b;this.x_a=c(this.Gac());this.fNk=new Hc.a(Object(R.a)(this,this.bce,"evalPropertyMergeStrategies"))}fAk(a){if(!a.B5h){a.B5h=
!0;var b=a.vmd.runtime.oZc,c=a.TXk;KE(b,a.X9a.value.YLb,"Base",c,808);KE(b,a.X9a.value.l7,"Favored",c,808);KE(b,a.b4b.value.l7,"Conflict",c,808)}}aem(a,b,c,f){this.V5(a,c);const l=a.Fba;if(2===f||7===f||a.Mpc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){let I;const T=a.X9a.value;if((()=>{let ja=T.T1a.Eg(c);({value:I}=ja);return ja})().returnValue&&I.teb)return 4!==f;f=0}if(0===f){if(!b.isDeleted)return l.zNa(nd.a.Wua(c),b.newValue),!0;f=6}if(8===f){let I,T=a.GSc.value;b=!0;if((()=>{let ja=
T.T1a.Eg(c);({value:I}=ja);return ja})().returnValue&&T.teb){var u=this.Hgd.MLj(a.vmd.input.source,I);void 0!==u&&null!==u?l.zNa(nd.a.Wua(c),u):(b=!1,f=6)}if(b)return!0}if(9===f){let I,T=a.GSc.value;b=!0;(()=>{let ja=T.T1a.Eg(c);({value:I}=ja);return ja})().returnValue&&(u=this.Hgd.yqg(a.vmd.input.source,I),void 0!==u&&null!==u?l.zNa(nd.a.Wua(c),u):(b=!1,f=6));if(b)return!0}return 6===f?(l.removeProperty(nd.a.Wua(c)),!0):1===f?this.Hxa.K4a(a,c):!1}J0a(a){return a}Gac(){return[Object(R.a)(this,this.kem,
"tryPreProcessFavoredRevision"),Object(R.a)(this,this.XUi,"cloneObjectAndRemoveNeededProperties"),Object(R.a)(this,this.$dm,"tryMergeNodeInternal")]}get Qsd(){return this.fNk.value}Zdm(a){const b=a.X9a.value;da.ULS.sendTraceTag(18659235,808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.l7.id,b.l7.hf);for(let c=0;c<this.x_a.length;c++)if(!(0,this.x_a[c])(a))return da.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",
b.l7.id,b.l7.hf,c),this.fAk(a),a.Fba=null,!1;da.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.l7.id,b.l7.hf);return!0}kem(a){const b=a.X9a.value;if(!b.teb)return!0;const c=this.Qsd;let f=!0;b.T1a.forEach((l,u)=>{if(!u.teb||a.Mpc.contains(l))return!0;u=c.ga(l);if(5===u)return da.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",
b.YLb.hf,l,u),f=!1;6===u&&a.o_e.add(l);return!0});return f}XUi(a){a.Fba=a.X9a.value.l7.O$a();const b=a.o_e,c=a.Fba;b&&b.forEach(f=>{c.removeProperty(nd.a.Wua(f));return!0});return!0}$dm(a){const b=a.b4b.value,c=b.YLb.hf,f=this.Qsd;let l=!0;b.T1a.forEach((u,I)=>{if(this.Hxa.O3a&&!this.Qsd.bce.Ib(u)){var T=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",u,c);da.ULS.sendTraceTag(18970259,808,50,T)}T=f.ga(u);l=this.aem(a,I,u,T);l||(a.Fba=null,da.ULS.sendTraceTag(18659271,
808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,u,T));return l});return l}PCj(){return[nd.a.Ab(rb.a.c9f),nd.a.Ab(rb.a.lastModifiedTime),nd.a.Ab(rb.a.MF),nd.a.Ab(rb.a.$mb),nd.a.Ab(rb.a.pHh),nd.a.Ab(ye.a.yqc),nd.a.Ab(ib.a.KXi),nd.a.Ab(ib.a.P7f),nd.a.Ab(Et.a.Sx)]}bce(){var a=this.PCj(),b=this.Hxa.LMa,c=this.Hxa.ePa,f=this.Hxa.WOa,l=this.Hxa.iUa,u=this.Hxa.tTa;const I=this.Hxa.kFa,T=new Md.a(0);for(let ja=0;ja<a.length;ja++)T.$(a[ja],this.J0a(7));for(a=0;a<
b.length;a++)T.$(b[a],this.J0a(8));for(b=0;b<c.length;b++)T.$(c[b],this.J0a(7));for(c=0;c<f.length;c++)T.$(f[c],this.J0a(9));for(f=0;f<l.length;f++)T.$(l[f],this.J0a(1));for(l=0;l<u.length;l++)T.$(u[l],this.J0a(9)),this.RNg.add(u[l]);for(u=0;u<I.length;u++)T.$(I[u],this.J0a(this.Hxa.lFa));return new cL(T,this.J0a(this.Hxa.lFa))}V5(a,b){this.RNg.contains(b)&&(a=a.Fba,da.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.hf,b))}}Object(m.a)(dL,
"GraphNodeComplexMerge",null,[1026]);class eL{constructor(a,b){this.Sl=a;this.Wdd=b;this.dHk=this.G3i()}G3i(){const a=[];this.Sl.forEach(b=>{a.push(new dL(this.Wdd,b,c=>c))});return a}F3i(a){for(let b=0;b<this.Sl.length;b++)if(this.Sl[b].pH(a))return this.dHk[b];return null}}Object(m.a)(eL,"GraphNodeComplexMergeFactory",null,[888]);class fL{MLj(a,b){this.Z4h(a);return 5===a?b.newValue:b.oldValue}yqg(a,b){this.Z4h(a);return 5===a?b.oldValue:b.newValue}Z4h(a){1!==a&&5!==a&&da.ULS.sendTraceTag(18613264,
808,15,"Unexpected merge source: {0}",a)}}Object(m.a)(fL,"GraphNodeComplexMergeHelper",null,[987]);class gL{constructor(a,b,c,f,l,u){this.o_e=this.Mpc=null;this.hgc=this.B5h=!1;this.Fba=null;this.Eyc=a.runtime.Eyc;this.vmd=a;this.TXk=b;this.X9a=c;this.b4b=f;this.GSc=l;this.Erg=u}}Object(m.a)(gL,"GraphNodeComplexMergeState",null,[]);class hL{constructor(a){this.x_a=a(this.Gac())}Gac(){return[Object(R.a)(this,this.o2l,"simpleMerge"),Object(R.a)(this,this.bXi,"complexMerge")]}PVl(a,b,c,f,l,u){a=new gL(a,
c,new Hc.a(()=>new fz(f.i7,l)),new Hc.a(()=>new fz(f.i7,u)),new Hc.a(()=>new fz(u,l)),b.F3i(l));a.Mpc=f.vMc;a.o_e=new fk.a;return a}merge(a,b,c,f,l,u){a=this.PVl(a,b,c,f,l,u);b=!0;for(c=0;c<this.x_a.length&&b;c++)b=(0,this.x_a[c])(a);(b=a.hgc&&a.Fba?new gz(a.Fba,!1):null)&&b.CUl(a.Mpc);return{returnValue:a.hgc,Fba:b}}o2l(a){var b=a.Erg.Qsd;return a.b4b.value.N6c(b)&&a.GSc.value.N6c(b)?a.X9a.value.N6c(b)?!0:(b=a.b4b.value.l7,a.hgc=!0,a.Fba=b.O$a(),!1):(a.hgc=!0,!1)}bXi(a){const b=a.b4b.value.l7;a.Eyc&&
da.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.hf);const c=a.Erg.Zdm(a);a.hgc=c;da.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":"Failed",b.id,b.hf,!!a.Fba);return c}}Object(m.a)(hL,"GraphNodeMerge",null,[889]);class gv{constructor(a){this.Hgd=a}mdj(a){const b=a.GSc.value,c=a.Fba;a=a.vmd.input.source;for(const l of gv.Wwd){let u=b.T1a.Eg(l);({value:f}=u);if(u.returnValue){var f=
this.Hgd.yqg(a,f);void 0!==f&&null!==f?c.zNa(nd.a.Wua(l),f):c.removeProperty(nd.a.Wua(l))}}}get LMa(){return[nd.a.Ab(yb.a.jV),nd.a.Ab(yb.a.Tue),nd.a.Ab(yb.a.Uue),nd.a.Ab(yb.a.rue)]}get ePa(){return[]}get WOa(){return[]}get tTa(){return[]}get iUa(){return gv.Wwd}get kFa(){return[]}get O3a(){return!1}get lFa(){return 9}pH(a){return 393230===a.hf}K4a(a,b){return 0<=Array.indexOf(gv.Wwd,b)?(this.mdj(a),gv.Wwd.forEach(c=>{a.Mpc.add(c)}),!0):!1}}gv.Wwd=[nd.a.Ab(rb.a.np),nd.a.Ab(rb.a.qpb),nd.a.Ab(rb.a.vAc),
nd.a.Ab(rb.a.$Na),nd.a.Ab(rb.a.Tya),nd.a.Ab(ib.a.S1a)];Object(m.a)(gv,"ParagraphNodeComplexMerge",null,[988]);class LE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}fc(a){this.K=a;a.register(fL,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(888,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().na(()=>
{const c=new aL;return new eL([new $K,new bL,c,new gv(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new YK,new ZK,new Rw(c),new hz(f=>Array.contains(b,f.hf),9),new hz(f=>131140===f.hf,6),new hz(f=>131164===f.hf,8),new hz(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(BB,"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(889,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().na(()=>
new hL(c=>c));a.register(890,"Box4.IBrowserGraphMerger").ma().na(()=>new Qw(c=>new HE.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new $p.a(c,f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").X2c,a.resolve("PowerPointWebEditor.IApplicationSettings").pCg,a.resolve("PowerPointWebEditor.IApplicationSettings").ujk,a.resolve("PowerPointWebEditor.IApplicationSettings").sjk,
a.resolve("PowerPointWebEditor.IApplicationSettings").tjk))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");ad.App.vOa.rIi(a)}dispose(){}static main(){C.a.instance.Ac(new LE)}}Object(m.a)(LE,"PPTWebEditorGraphMergePackage",null,[2,3]);class iL{constructor(a,b){this.Sl=a;this.ES=b}Esj(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.Sl)if(f.Eek(a)){c=f;const l=this.ES.lj("UserAction",f.name);b=f.Bsj(a);l.stop();break}b||ya.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",
c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}Dsj(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.Esj(c))&&b.appendChild(a);return b}}Object(m.a)(iL,"HtmlExportProcessor",null,[885]);class ME{constructor(){this.PKc=null}get rootNode(){return this.PKc}clone(){return Object.assign(new ME,{PKc:this.rootNode})}}Object(m.a)(ME,"HtmlExportContext",null,[]);class jL{Csj(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new ME,
{PKc:f}));return c}}Object(m.a)(jL,"HtmlExportUtils",null,[887]);class kL{constructor(a){this.sEe=null;this.Ar=a}get Eej(){return this.sEe=this.sEe||document.createElement("div")}Fsj(a,b){if(!a||!a.rootNode||!b)return null;b.tEa(this.Eej);const c=this.Ar.xe(3);try{c.rd(a.rootNode),c.INa(b.Na),b.ez(a.rootNode),b.HBa()}finally{c&&c.dispose()}a=b.bag;b.detach();return a}}Object(m.a)(kL,"HtmlGenerator",null,[886]);class NE{constructor(a,b,c){this.YJk=a;this.ZJk=b;this.Ub=c}get name(){return"PPTTableHtmlExportHandler"}Eek(a){return 14===
a.rootNode.type?!0:10===a.rootNode.type?(a=Object(gb.a)(4,a.rootNode),!!a&&a.vd):!1}Bsj(a){return this.ZJk.Fsj(this.UOj(a),this.YJk)}UOj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Ub.Pc(a.rootNode);a.Gb(1);b.PKc=a.Gb(2);return b}return a}}Object(m.a)(NE,"PPTTableHtmlExportHandler",null,[981]);class OE extends bj.a{constructor(a,b){super(new fb.a,a,b)}get bag(){return this.WXh}}Object(m.a)(OE,"AHtmlExportView",bj.a,[975,418,262,106]);class PE{}PE.Vjj="ExportedPPTTable";Object(m.a)(PE,"HtmlExportConstants",
null,[]);class QE extends OE{constructor(a,b){super(a,b)}get bag(){const a=this.WXh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],PE.Vjj),a[0]):null}get Nm(){return!0}get PG(){return 480}}Object(m.a)(QE,"PPTTableHtmlExportView",OE,[]);class RE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}fc(a){this.K=a;this.K.register(885,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().na(()=>new iL([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],
this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(886,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().na(()=>new kL(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));this.K.register(887,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().na(()=>new jL);this.MYi()}init(){}dispose(){}MYi(){this.K.register(QE,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().na(()=>new QE(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));
this.K.register(NE,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().na(()=>new NE(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){C.a.instance.Ac(new RE)}}Object(m.a)(RE,"HtmlExportPackage",null,[2,3]);class CB extends zi.a{constructor(a,b){super();this.PEc=0;this.BPd=null;this.Hq="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.Pxf=a;this.Oxf=b;this.Fg="LanguageDialog"}Syc(){this.Wg=this.ofe();let a;this.PEc=(()=>{let c=this.Pxf.Zng();({Sxh:a}=c);return c})().returnValue;const b={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.Vj(Box4Intl.Box4Strings.l_Language,Object(R.a)(this,this.iRl,"setLanguageHandler"),b);this.BPd=document.getElementById("LanguageList");this.Oxf.jhl(this.BPd,this.PEc)}ofe(){return zi.a.oC(this.Hq,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}iRl(a,
b){if(U.a.instance.ga(70)){var c=jd.a.instance.Cq(G.a.hRl);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.BPd.value),this.Pxf.rNh(b,a),c.properties.$("PreviousLCID",this.PEc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.Oxf.gRl(b,this.PEc)),ad.App.Ob.Gf(!0));c.end()}}}Object(m.a)(CB,"LanguageDialog",zi.a,[1008]);class lL{constructor(){this.$tk=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(R.a)(this,this.kuk,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){ya.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}FJl(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}kuk(a,b){b=b.toLowerCase();for(const c of this.$tk)if(b===c)return;ya.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(m.a)(lL,"JSanityHelper",null,[882]);class SE extends CB{constructor(a,
b,c){super(a,c);this.JIk=b}ofe(){return this.JIk.vXa?zi.a.oC(this.Hq,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.ofe()}}Object(m.a)(SE,"PPTLanguageDialog",CB,[]);class mL{constructor(a,b,c,f){this.HRk=a;this.DHk=b;this.oMk=c;this.dH=f}getInstance(a){return new SE((a?this.HRk:this.DHk)(),this.dH,this.oMk)}}Object(m.a)(mL,"PPTLanguageDialogFactory",null,[880]);var Dj=d(120);class nL{constructor(){this.Tcf="rect,circle,ellipse,line,polyline,polygon,path";
this.dCd=[];this.Mia=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.QXe=96}Vem(a,b){b=void 0===b?null:b;try{const c=this.lke(a);if(!c)return null;const f=b?Vb.a.WH(b.DE):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const u=c[b];u.setAttribute(Dj.a.ude,f);u.setAttribute(Dj.a.Obg,l)}return a}catch(c){return ya.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",
c.message,c.stack),null}}q0h(a,b){b=void 0===b?null:b;try{const c=this.lke(a);if(!c)return null;const f=b?Vb.a.WH(b.DE):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const u=c[b];u.setAttribute(Dj.a.LBd,f);u.setAttribute(Dj.a.aVh,l)}return a}catch(c){return ya.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}Wem(a,b){try{const f=this.lke(a);if(!f)return null;var c=this.NKj(b);
let l="";for(const u of c)l+=u+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const u=f[c];u.setAttribute(Dj.a.$Uh,l);u.setAttribute(Dj.a.fcf,"miter");u.setAttribute(Dj.a.x6l,"4");switch(b){case 8:u.setAttribute(Dj.a.ecf,"round");break;case 2:case 0:u.setAttribute(Dj.a.ecf,"butt");break;default:u.setAttribute(Dj.a.ecf,"round")}}return a}catch(f){return ya.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),
null}}r0h(a,b,c,f){try{if(!a)return null;this.INh(c,b*this.QXe*f/Re.a.EFa,a);return a}catch(l){return ya.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}PKj(){if(!this.dCd||1>this.dCd.length)this.dCd=this.Tcf.split(",");return this.dCd}lke(a){if(!a)return null;a=a.querySelectorAll(this.Tcf);return 1>a.length?null:a}INh(a,b,c){if(c){var f=c.getAttribute(Dj.a.NTb)?c.getAttribute(Dj.a.NTb).toString():
"";1<f.length?(f=f.substring(f.indexOf("(")+1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.PKj())if(l===a){c.setAttribute(Dj.a.gcf,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.INh(f,b,c.children[l])}}NKj(a){switch(a){case 0:return this.Mia[0];case 1:return this.Mia[1];case 2:return this.Mia[2];
case 3:return this.Mia[3];case 4:return this.Mia[4];case 5:return this.Mia[5];case 6:return this.Mia[6];case 7:return this.Mia[7];case 8:return this.Mia[8];case 9:return this.Mia[9];case 10:return this.Mia[10];default:return ya.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.Mia[0]}}}Object(m.a)(nL,"SVGIconLocalEditor",null,[883]);class oL{constructor(a,b){this.jbh=b;this.fe=a}UD(a,b){if(!a)return!1;const c=a.X0(f=>!f.Sk).length;return!this.iXl(a.S7b,c+b)}yE(a){const b=
a.ve+1;this.fe.iI(222,c=>{c.yD=1;c.YUa=[b.toString(),this.jbh.toString()];return!1})}iXl(a,b){if(!a&&b<this.jbh)return!1;ya.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(m.a)(oL,"ShapeCountValidator",null,[881]);class TE{constructor(a,b,c,f,l,u){this.vMk=a;this.Fa=b;this.Ldh=c;this.Eb=f;this.MK=l;this.Ga=u}get Rb(){return this.vMk.value}Zng(){let a,b=0;a=!0;const c=this.Rb.Hd();1===c.length&&c[0].v8c&&(b=this.Ga.VVa(c[0]),a=!this.Ga.eje(c[0]));return{returnValue:b,Sxh:a}}rNh(a,
b){const c=this.Rb.Hd();if(1===c.length&&c[0].v8c&&this.Ldh){var f=new W.DictionaryPropertySet;f.setValue(rb.a.pu,a);f.setValue(Oe.a.Rya,b);a=this.Eb.ud(15);try{a.mc(c[0]);c[0].Vua();const l=Object(gb.a)(4,c[0]);l&&this.MK&&this.MK.Gjm(l,b);this.Ldh.tW(f);this.Fa.Gd()}finally{a&&a.dispose()}}}}Object(m.a)(TE,"ShapeLanguageEditor",null,[899]);class UE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}fc(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");
this.K.register(CB,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").na(()=>new SE(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(880,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().na(()=>new mL(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));
this.K.register(TE,"PowerPointWebEditor.ShapeLanguageEditor").ma().na(()=>new TE(this.K.ze("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.ub("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(881,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().na(()=>new oL(Tb.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),
b.td.powerPointEditServerEditableShapeCountThreshold));this.K.register(882,"PowerPointWebEditor.IJSanityHelper").ma().na(()=>new lL);this.K.register(883,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().na(()=>new nL)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){C.a.instance.Ac(new UE)}}Object(m.a)(UE,"PPTWebEditorShapeEditPackage",null,[2,3]);var pL=d(312),VE=d(251);class Jt{static get T0(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":
document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():da.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():da.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get Mec(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get N$(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||
!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(m.a)(Jt,"FullscreenUtils",null,[]);class qL{get T0(){return Jt.T0}requestFullscreen(a){Jt.requestFullscreen(a)}exitFullscreen(){Jt.exitFullscreen()}get Mec(){return Jt.Mec}get N$(){return Jt.N$}get HUf(){return this.Mec&&!E.a.vy}}Object(m.a)(qL,"FullscreenUtilsProxy",null,[871]);class rL{mDj(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(m.a)(rL,"InkButtonHelper",null,[876]);class sL{constructor(){this.menuDefinition=
null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(m.a)(sL,"FlyoutMenuExtraProps",null,[]);class iz{}iz.HMi="_136_16_N_20";iz.IMi="none";Object(m.a)(iz,"InkButtonConstants",null,[]);class DB{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(m.a)(DB,"InkButtonProps",null,[]);class WE{constructor(){this.onInkMenuActivity=
null}}Object(m.a)(WE,"IInkButtonSettings",null,[]);class tL extends WE{constructor(){super()}}Object(m.a)(tL,"InkButtonSettings",WE,[]);class uL{constructor(){this.color=this.item=null}}Object(m.a)(uL,"InkManagerActivity",null,[]);class EB{constructor(){this.fKe=!1;this.rOe=this.QOe=0;this.jEe=""}get S5(){return this.fKe}set S5(a){this.fKe=a}get startingSlideIndex(){return this.QOe}set startingSlideIndex(a){this.QOe=a}get slideCount(){return this.rOe}set slideCount(a){this.rOe=a}get Q5f(){return this.jEe}set Q5f(a){this.jEe=
a}get gyl(){const a={};a.IsStartRehearsal=this.fKe;a.StartingSlideIndex=this.QOe;a.SlideCount=this.rOe;a.DisabledRehearsalRealtimeFeaturesStr=this.jEe;return JSON.stringify(a)}}Object(m.a)(EB,"RehearsalContext",null,[874]);class FB extends zi.a{constructor(a,b,c){super(!1,!0);this.eMe=50001;this.jb=a;this.te=b;this.Ip=new EB;this.Xa=c;this.jb.Oka(Object(R.a)(this,this.Pha,"onSlideshowExitHandler"));this.jb.b3b(Object(R.a)(this,this.Iha,"onGetCurrentPositionHandler"));this.jb.getCurrentPosition();
this.GJa=!1}dispose(){super.dispose();this.GJa||this.jb.restoreFocus()}sv(){super.sv();document.getElementById("WACDialogOverlay").style.zIndex=String(this.eMe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}IB(){super.IB();var a=document.getElementById(this.ki("WACDialogPanel"));a.style.minWidth=Df.a.Rc(300);a.style.width=Df.a.Rc(300);a=document.getElementById(this.ki("WACDialogButtonPanel"));var b=document.getElementById(this.ki("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(b=document.getElementById(this.ki("WACDialogCancelButton")))b.style.color="#ffffff",b.style.font="12pt",b.style.background="#A92B1A",b.innerText="Got it";a&&b&&md.a("UseWACDialogButtonPanelNewStyles")&&(a.style.display="inline-block",a.style.padding="0px 14px 14px 0px",b.style.margin="10px 0px 0px 10px");if(a=document.getElementById(this.ki("WACDialogPanel"))){b=Df.a.we();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=Df.a.zla();c.setAttribute("href",
"https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){ya.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.te.Ok("SubtitleProactive_clearly.png");const b=this.te.Ok("SubtitleProactive_network.png"),c=this.te.Ok("SubtitleProactive_noNoise.png");this.Wg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.Vj("",Object(R.a)(this,this.Hha,"onClickHandler"),a);this.jb.setVisibility(!0)}C9(){super.C9()}sua(){super.sua()}Amb(){}Iha(){this.jb.Bmb(Object(R.a)(this,this.Iha,"onGetCurrentPositionHandler"));this.open()}Pha(){this.GJa=!0;this.jb.jia(Object(R.a)(this,
this.Pha,"onSlideshowExitHandler"));this.jb.Bmb(Object(R.a)(this,this.Iha,"onGetCurrentPositionHandler"));this.hide()}Hha(a){0===a&&(a=Date.now(),this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,3,a,this.Ip))}static lIg(a,b,c){new FB(a,b,c)}}Object(m.a)(FB,"SlideshowSubtitleProactiveDialog",zi.a,[]);var wh=d(689);class vL{constructor(){this.buttonIdDictionary=null}}Object(m.a)(vL,"SlideshowToolbarSettings",null,[]);class jz extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(m.a)(jz,"ReadOutEventArgs",Sys.EventArgs,[]);class XE{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.JHb=this.Ip=this.Mc=this.rga=this.ye=this.udd=this.GOe=this.yi=null;this.SV=this.g0a=this.i0a=this.yHb=this.IZa=this.XHe=0;this.lN=!1;this.vHe=!0;this.Led=this.sS=this.BPe=this.DCe=!1;this.Elh=()=>{ya.a.J(509157450,830,50,"ReactSlideshowToolbar.OnCameraToggleHandler");this.Ikc=!this.Ikc;this.L1h()};this.n3k=eb=>{eb=eb.id?eb.id:"";ya.a.J(508916299,830,50,`ReactSlideshowToolbar.onCameraSelectionChanged - triggered with ${""===
eb?"invalid":"valid"} id.`);this.jb.K1h(eb);this.e3h()};this.sxg=()=>{this.aOk.execute(this.Y8j);this.yi.registerButtonCallback(wh.a.OptionsButton,this.Fej)};this.Y8j=eb=>{if(!this.ihd){const Bb={onCameraMenuActivity:this.n3k,defaultCameraLabel:this.jb.getDefaultCameraLabel()};this.ihd=eb.mHj(Bb);ya.a.J(508916298,830,50,"ReactSlideshowToolbar.initOptionsButton - OptionsButtonManager created.")}this.e3h()};this.Fej=()=>{};this.jb=c;this.zf=I;this.fv=T;this.Xa=ua;this.ia=a;this.Ba=b;this.gQe=l;this.Zb=
u;this.uKk=Tb.a.instance.Ha("PowerPointWebEditor.IInkButtonHelper");this.Ba.LU&&(this.aOk=Tb.a.instance.Ha("PowerPointWebEditor.IOptionsButtonLoader"));this.te=f;this.dv=Ra}init(a,b){ya.a.J(512495955,830,50,"ReactSlideshowToolbar.Init");this.vHe=!0;this.DCe=!1;var c={};c[wh.a.MicButton]=this.Ba.isMicButtonInSlideShowToolbarEnabled;c[wh.a.PrevButton]=!0;c[wh.a.NextButton]=!0;c[wh.a.GridButton]=!0;c[wh.a.InkButton]=!0;c[wh.a.SubtitlesButton]=!0;c[wh.a.LiveButton]=!0;c[wh.a.MoreButton]=!0;c[wh.a.CameraButton]=
this.Ba.LU;c[wh.a.ExitButton]=!0;c[wh.a.OptionsButton]=this.Ba.LU;c[wh.a.CoachButton]=this.Ba.isCoachButtonInSlideShowToolbarEnabled;this.GOe=new vL;this.GOe.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.ye=document.createElement("div");this.ye.id="slideshow-toolbar";this.ye.className="ReactSlideshowToolbar";this.Ba.pptEditorVoiceUXEnabled&&(this.udd=document.getElementById("slideshowfooterContainerElement"),this.ye.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");
c.id="slideshow-toolbar-accessibility";c.style.position="absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Ba.pptEditorVoiceUXEnabled?this.udd.appendChild(this.ye):this.zf.appendChild(this.ye);this.yi=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.GOe,this.ye);if(!this.yi){ya.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");
const f=jg.a.hi(359);A.AFrameworkApplication.Lp(f);eg.Health.instance.recordQosError(jg.a.Bea(f),["SlideShowACE"],!1,!0,!0,!1,null)}this.yi.renderToolbar();this.ye.appendChild(c);this.ye.tabIndex=0}this.rga||(this.rga=document.createElement("div"),this.rga.id="SlideshowToolbarCalloutMenuContainer",this.rga.className="SlideshowToolbarCalloutMenuContainer",this.fv()&&(this.rga.style.direction=Hf.a.i4a),this.zf.appendChild(this.rga));this.Mc=a;this.Ip=b;this.yi.registerButtonCallback(wh.a.MicButton,
()=>{this.h7k()});this.yi.registerButtonCallback(wh.a.CoachButton,()=>{this.H3k()});this.Ba.LU&&(this.yi.registerButtonCallback(wh.a.CameraButton,this.Elh),this.w8j(),this.yi.registerButtonCallback(wh.a.OptionsButton,this.sxg),this.yi.showToolbarButton(wh.a.OptionsButton));this.Mc.ji||this.Zb&&this.Zb.instance&&this.Zb.instance.Xr?(this.sS=!0,this.yi.setToolbarButtonToggleState(wh.a.MicButton,this.sS),this.yi.showToolbarButton(wh.a.MicButton)):(this.sS=!1,this.yi.setToolbarButtonToggleState(wh.a.MicButton,
this.sS),this.yi.hideToolbarButton(wh.a.MicButton));this.yi.registerButtonCallback(wh.a.PrevButton,f=>{this.rMb(f)});this.yi.registerButtonCallback(wh.a.NextButton,f=>{this.mMb(f)});this.yi.registerButtonCallback(wh.a.GridButton,f=>{this.hMb(f)});this.yi.showToolbarButton(wh.a.GridButton);this.Mc.Qzb&&!this.Ip.S5&&(this.yi.registerButtonCallback(wh.a.SubtitlesButton,f=>{this.qqd(f)}),this.yi.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Mc.ji),this.yi.showToolbarButton(wh.a.SubtitlesButton));
this.yi.registerButtonCallback(wh.a.ExitButton,f=>{this.gMb(f)});this.Ba.isInkingInSlideShowEnabled&&this.Ba.isInkUIInSlideShowEnabled&&(a=DB.create(),a.icon=iz.HMi,a.selectedColor=iz.IMi,this.yi.updateElementProps(wh.a.InkButton,a),this.yi.registerButtonCallback(wh.a.InkButton,()=>{this.M8j()}),this.yi.showToolbarButton(wh.a.InkButton));this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&!this.Ip.S5&&(this.yi.registerButtonCallback(wh.a.LiveButton,()=>{this.R6k()}),this.yi.updateFlyoutButtonCallback(wh.a.LiveButton,
this.Zb.instance.Xr),this.yi.setToolbarButtonToggleState(wh.a.LiveButton,this.Zb.instance.Xr),this.yi.showToolbarButton(wh.a.LiveButton),this.Zb.instance.VLf(Object(R.a)(this,this.hrc,"onLiveSessionStarted")),this.Zb.instance.TLf(Object(R.a)(this,this.grc,"onLiveSessionEnded")),this.Zb.instance.QLf(Object(R.a)(this,this.frc,"onLiveRelaunchPausedSession")),this.Zb.instance.Eyi(Object(R.a)(this,this.Onh,"onLiveCalloutMenuDefintionChanged")));this.lUb();this.lAb();this.jb.Oka(Object(R.a)(this,this.Lpa,
"onExitHandler"));this.jb.VZd(Object(R.a)(this,this.zkb,"onBrowserEventHandler"));this.jb.mOc(Object(R.a)(this,this.Zya,"onGetCurrentSlideDimensionsHandler"));this.jb.rOc(Object(R.a)(this,this.iza,"onSpecialKeyHandler"));this.jb.YZd(Object(R.a)(this,this.Akb,"onContextMenuHandler"));this.jb.$Zd(Object(R.a)(this,this.God,"onEnterEndOfShowHandler"));this.jb.b_d(Object(R.a)(this,this.epd,"onLeaveEndOfShowHandler"));Ae.a.addHandler(this.ye,la.a.Wq,Object(R.a)(this,this.Ikb,"onMouseOverHandler"));Ae.a.addHandler(this.ye,
la.a.Rt,Object(R.a)(this,this.krc,"onMouseOutHandler"));Ae.a.addHandler(this.rga,la.a.click,Object(R.a)(this,this.Hha,"onClickHandler"));Ae.a.addHandler(this.ye,la.a.Vf,Object(R.a)(this,this.JLa,"onKeyDownHandler"))}V0l(){window.clearTimeout(this.XHe);this.XHe=window.setTimeout(Object(R.a)(this,this.H2j,"hideMouse"),3E3);this.jb.Bia(!0)}H2j(){this.lN||(window.clearTimeout(this.XHe),this.jb.Bia(!1))}SF(a,b){b?this.yi.showToolbarButton(a):this.yi.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.yi.setToolbarButtonToggleState(a,
b)}show(){if(this.fv()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.i0a+this.SV-16-this.yi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.yi.showToolbar();this.yi.enterFocusTrapZone();window.clearTimeout(this.IZa);window.clearTimeout(this.yHb);this.vHe?(this.IZa=window.setTimeout(Object(R.a)(this,this.hide,"hide"),2E3),this.vHe=!1,this.DCe=!0):this.IZa=window.setTimeout(Object(R.a)(this,this.hide,"hide"),3E3);this.jb.Bia(!0)}tSh(){if(this.fv()){const a=document.getElementById("slideshow-toolbar");
if(a){const b=(this.i0a+this.SV-16-this.yi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.yi.showToolbar();this.yi.enterFocusTrapZone();window.clearTimeout(this.IZa);window.clearTimeout(this.yHb);this.yHb=window.setTimeout(Object(R.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.lN){const a=document.getElementById("slideshow-toolbar");a&&!this.yi.isAnyToolbarElementFocused()&&document.activeElement===a&&this.L4a(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.IZa);window.clearTimeout(this.yHb);
this.yi.hideToolbar();this.jb.Bia(!1);this.ye.style.display===Hf.a.kf&&this.jb.restoreFocus()}}lAb(){this.lN||(this.DCe&&this.L4a(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.IZa),window.clearTimeout(this.yHb),this.yi.forceHideToolbar(),this.jb.Bia(!1),this.ye.style.display===Hf.a.kf&&this.jb.restoreFocus())}remove(){this.yi.closeToolbar();this.rga.style.visibility=Hf.a.Vt;this.Led=!1;this.jb.jia(Object(R.a)(this,this.Lpa,"onExitHandler"));this.jb.l3e(Object(R.a)(this,this.zkb,
"onBrowserEventHandler"));this.jb.pvd(Object(R.a)(this,this.Zya,"onGetCurrentSlideDimensionsHandler"));this.jb.svd(Object(R.a)(this,this.iza,"onSpecialKeyHandler"));this.jb.o3e(Object(R.a)(this,this.Akb,"onContextMenuHandler"));this.jb.p3e(Object(R.a)(this,this.God,"onEnterEndOfShowHandler"));this.jb.r3e(Object(R.a)(this,this.epd,"onLeaveEndOfShowHandler"));Ae.a.removeHandler(this.ye,la.a.Wq,Object(R.a)(this,this.Ikb,"onMouseOverHandler"));Ae.a.removeHandler(this.ye,la.a.Rt,Object(R.a)(this,this.krc,
"onMouseOutHandler"));Ae.a.removeHandler(this.rga,la.a.click,Object(R.a)(this,this.Hha,"onClickHandler"));Ae.a.removeHandler(this.ye,la.a.Vf,Object(R.a)(this,this.JLa,"onKeyDownHandler"));this.ye&&(this.zf.contains(this.ye)||this.udd&&this.udd.contains(this.ye))&&(this.lN=!1);this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&(this.Zb.instance.eEh(Object(R.a)(this,this.hrc,"onLiveSessionStarted")),this.Zb.instance.dEh(Object(R.a)(this,this.grc,"onLiveSessionEnded")),this.Zb.instance.aEh(Object(R.a)(this,
this.frc,"onLiveRelaunchPausedSession")),this.Zb.instance.iBl(Object(R.a)(this,this.Onh,"onLiveCalloutMenuDefintionChanged")))}Lpa(){this.remove()}L4a(a){Aa.a.Ta(a)?ya.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.gQe.Zzh(new jz(a))}Zya(a,b){try{this.i0a=b.TSh;this.g0a=b.PSh;this.SV=b.slideWidth;if("NaN"===this.i0a.toString()||"NaN"===this.g0a.toString()){ya.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");
const c=jg.a.hi(359);A.AFrameworkApplication.Lp(c);eg.Health.instance.recordQosError(jg.a.Bea(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Zb.instance&&this.Zb.instance.Xr&&!this.Led?26:0;if(this.Ba.pptEditorVoiceUXEnabled){const f=document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.fv()?(this.i0a+this.SV-16-this.yi.getToolbarWidth()).toString()+"px":(this.i0a+2).toString()+"px";f.style.left=l;if(this.Mc.ji&&"AboveSlide"===this.Mc.Xw)f.style.bottom="0px";else{const I=
za.a.Lbc();a=0;const T=document.getElementById("AppHeaderPanel");T&&(a=T.clientHeight);f.style.bottom=this.dv.N$?(I-this.g0a-c).toString()+"px":(I-this.g0a-a-c).toString()+"px"}f.style.top="auto";const u=document.getElementById("ReactToolbarInnerContainer");u&&(u.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.fv()?(this.i0a+this.SV-16-this.yi.getToolbarWidth()).toString()+"px":(this.i0a+2).toString()+"px";f.style.left=l;const u=this.Zb.instance&&
this.Zb.instance.Xr?(this.g0a+c).toString()+"px":this.g0a.toString()+"px";"AboveSlide"===this.Mc.Xw?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=u,f.style.bottom="auto");f.style.top=u}}}this.show()}catch(c){ya.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",c)}}God(){this.Led=!0}epd(){this.Led=!1}JLa(a){this.yi.isAnyCalloutMenuOpen()||(this.lN=!1);try{this.ye.style.display===
Hf.a.kl&&(a.keyCode===H.a.Cqb||a.keyCode===H.a.gG||a.keyCode===H.a.I3?this.jb.prev():a.keyCode===H.a.r5a||a.keyCode===H.a.fG||a.keyCode===H.a.H3?this.jb.next():a.keyCode===H.a.F_?this.fv()?this.jb.next():this.jb.prev():a.keyCode===H.a.LW?this.fv()?this.jb.prev():this.jb.next():a.keyCode===H.a.YOa?(this.BPe=!0,this.lAb()):a.shiftKey&&a.keyCode===H.a.Jra||a.keyCode===H.a.oVb?this.lAb():this.jb.a7e(a))}catch(b){ya.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",
b)}}iza(a,b){var c;this.yi.isAnyCalloutMenuOpen()||(this.lN=!1);b.key===H.a.oVb||b.shiftKey&&b.key===H.a.Jra?(a="off",this.ye.style.display===Hf.a.kf?(this.tSh(),a="on"):this.lAb(),ya.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)):this.Ba.LU&&b.altKey&&b.key===H.a.Dqb?(this.ihd||this.sxg(),null===(c=this.ihd)||void 0===c?void 0:c.selectNextCameraDevice()):this.Ba.LU&&b.shiftKey&&b.key===H.a.VCc&&this.Elh()}Akb(){if(this.BPe)this.BPe=
!1;else{var a="off";this.ye.style.display===Hf.a.kf?(this.tSh(),a="on"):this.yi.isAnyCalloutMenuOpen()||this.lAb();ya.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}zkb(a,b){this.V0l();b.clientY<this.g0a+8+20&&b.clientY>this.g0a-20-8&&this.show()}Ikb(a){(a=a.target)&&this.ye.contains(a)&&(this.lN=!0)}krc(a){a.target&&(this.yi.isAnyCalloutMenuOpen()?this.rga.style.visibility=Hf.a.AA:(this.lN=!1,this.show()));this.yi.isAnyCalloutMenuOpen()||
this.yi.enterFocusTrapZone()}Hha(a){this.lN=!1;window.clearTimeout(this.IZa);window.clearTimeout(this.yHb);this.rga.style.visibility=Hf.a.Vt;this.IZa=window.setTimeout(Object(R.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.yi.enterFocusTrapZone()}rMb(){ya.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.jb.prev()}mMb(){ya.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.jb.next()}gMb(){ya.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");
this.yi.closeToolbar();this.jb.exit()}Xef(a){const b=!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Xr;var c=this.Mc.Gag&&5!==a&&!b;5!==a&&(this.Mc.ji&&(Yi.a.lL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Yi.a.VK)||ya.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Mc.ji=!this.Mc.ji);this.yi.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Mc.ji);ya.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Mc.ji);this.Mc.ji&&c&&FB.lIg(this.jb,this.te,this.Xa);c||(c=Date.now(),b?this.sS||this.Zb.instance.Uzb()?this.jb.toggleTranscriberUIVisibility(null):(this.Zb.instance.Ksg(),this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,a,c,this.Ip)):this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,a,c,this.Ip));this.sS=this.Mc.ji||b;this.aFd();this.lUb()}aFd(){this.yi.setToolbarButtonToggleState(wh.a.MicButton,
this.sS);this.sS?this.yi.showToolbarButton(wh.a.MicButton):this.yi.hideToolbarButton(wh.a.MicButton)}lUb(){const a=this.Mc.ji,b=!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Xr,c=this.Ip.S5,f=32!==this.ia.nb(M.a.gia,1);a||b||c||f?this.yi.hideToolbarButton(wh.a.CoachButton):this.yi.showToolbarButton(wh.a.CoachButton)}h7k(){ya.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.sS=!this.sS;this.yi.setToolbarButtonToggleState(wh.a.MicButton,this.sS);this.jb.setMicrophoneState(!this.sS);
if(this.Zb&&this.Zb.instance&&this.Zb.instance.Xr&&this.sS&&!this.Zb.instance.Uzb()){this.Zb.instance.Ksg();const a=this.Mc.ji;this.Zb.instance.$ea=!this.Mc.ji;this.Mc.ji=!0;this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,5,Date.now(),this.Ip);this.Mc.ji=a}}vFi(){return Object(Jh.b)(this,void 0,void 0,function*(){try{return navigator.permissions?"denied"!==(yield navigator.permissions.query({name:"camera"})).state:(ya.a.J(508908556,
830,10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - insecure context."),!1)}catch(a){return ya.a.J(508885084,830,10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - exception="+a),!1}})}w8j(){Object(Jh.b)(this,void 0,void 0,function*(){(this.Ikc=yield this.vFi())||ya.a.J(508688463,830,10,"ReactSlideshowToolbar.initCameraToggleAsync - camera permissions denied.");this.L1h();this.yi.showToolbarButton(wh.a.CameraButton)})}L1h(){this.yi.setToolbarButtonToggleState(wh.a.CameraButton,
this.Ikc);this.jb.setCameraState(this.Ikc)}e3h(){Object(Jh.b)(this,void 0,void 0,function*(){const a=yield this.ihd.getControlsInMenuAsync();this.yi.updateElementProps(wh.a.OptionsButton,{menuDefinition:a,menuHostId:"SlideshowToolbarCalloutMenuContainer"})})}H3k(){ya.a.J(512495941,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.Ia(M.a.gia,2,{entryPoint:2})?this.Ba.pptEditorRehearsalSpeechClientEnabled||(this.Ip.S5=!0):ya.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}qqd(){ya.a.J(512495939,
830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.Xef(3)}hMb(){ya.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.Ia(M.a.cSb,2,null)}R6k(){this.Zb&&this.Zb.instance&&(ya.a.J(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Zb.instance.Xr),this.Zb.instance.Xr||(this.Zb.instance.qzc(3,A.AFrameworkApplication.userSessionId,this.Ba.podsWebServiceBase,this.Xa.podSessionId,A.AFrameworkApplication.mh),this.Zb.instance.$ea=!this.Mc.ji,this.Mc.Qzb&&!this.Mc.ji&&
(ya.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Mc.ji=!0,this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,5,Date.now(),this.Ip),this.Mc.ji=!1,this.sS=!0,this.aFd()),this.lN=!1,this.yi.setToolbarButtonToggleState(wh.a.LiveButton,!0)));this.lUb()}hrc(){this.yi.setToolbarButtonToggleState(wh.a.LiveButton,!0);this.$Ed(!1,!1);this.sS=!0;this.aFd();this.lUb();this.Dih()}grc(){this.yi.setToolbarButtonToggleState(wh.a.LiveButton,
!1);this.$Ed(!1,!0);this.Zb&&this.Zb.instance&&this.Zb.instance.$ea&&!this.Mc.ji&&(ya.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,5,Date.now(),this.Ip));this.Zb.instance.$ea=!1;this.Mc.ji||(this.sS=!1,this.aFd());this.lUb()}frc(){this.Zb&&this.Zb.instance&&(this.lN=!0,this.show(),this.rga.style.visibility=Hf.a.AA,this.$Ed(!0,!1),this.Dih());this.lUb()}Dih(){this.Ba.psd&&
!this.Zb.instance.Uzb()&&(this.sS=!1,this.yi.setToolbarButtonToggleState(wh.a.MicButton,this.sS),this.Mc.ji=!1,this.yi.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Mc.ji))}Onh(){this.$Ed(!1,!1)}$Ed(a,b){if(this.Zb&&this.Zb.instance){const c=new sL;c.menuDefinition=b?null:this.Zb.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.yi.updateElementProps(wh.a.LiveButton,c);this.yi.updateFlyoutButtonCallback(wh.a.LiveButton,!b)}}M8j(){this.uKk.execute(Object(R.a)(this,this.L8j,"initInkButton"));
const a=new uL;a.item="Init";this.jb.pYe(a);this.yi.registerButtonCallback(wh.a.InkButton,()=>{})}L8j(a){const b=new tL;b.onInkMenuActivity=c=>{this.r6k(c)};this.JHb=a.mDj(b);a=DB.create();a.icon=this.JHb.getIcon();a.menuDefinition=this.JHb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.yi.updateElementProps(wh.a.InkButton,a)}r6k(a){this.jb.pYe(a);a=DB.create();a.selectedColor=this.JHb.getSelectedColor();a.icon=this.JHb.getIcon();a.menuDefinition=this.JHb.getControlsInMenu();
this.yi.updateElementProps(wh.a.InkButton,a);this.lAb()}}Object(m.a)(XE,"ReactSlideshowToolbar",null,[1540,1541]);class YE{constructor(a,b){this.ul=a;this.bkc=document.createElement("div");this.bkc.id="slideshowfooterContainerElement";this.bkc.className="slideshowFooterContainer";this.ia=b}init(){ya.a.J(595198370,830,50,"SlideShowFooterContainer.Init");this.ul&&this.ul.appendChild(this.bkc)}remove(){this.ul&&this.ul.contains(this.bkc)&&this.ul.removeChild(this.bkc)}qb(){this.ia.xa(M.a.xRh,wc.a.application,
Object(R.a)(this,this.n0l,"showFooterElements"));this.ia.xa(M.a.fvg,wc.a.application,Object(R.a)(this,this.D2j,"hideFooterElements"))}n0l(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display="flex");return 32}D2j(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=Hf.a.kf);return 32}}Object(m.a)(YE,"SlideShowFooterContainer",null,[1542]);class wL{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(m.a)(wL,
"IVoiceActorSettings",null,[]);class xL{constructor(){this.kpc=this.ul=this.Ojb=null}init(){ya.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.Ojb=document.createElement("div");this.Ojb.id="voiceNotificationContainerElement";this.Ojb.className="voiceNotificationContainer";(this.ul=document.getElementById("slideshowfooterContainerElement"))&&this.ul.insertBefore(this.Ojb,this.ul.firstChild);const a=new wL;a.baseZIndex=50002;a.hostElement=this.Ojb;this.kpc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.ul&&
this.ul.contains(this.Ojb)&&this.ul.removeChild(this.Ojb)}show(a,b){this.kpc&&this.kpc.showNotification(a,b)}hide(){this.kpc&&this.kpc.hideNotification()}}Object(m.a)(xL,"SlideShowVoiceNotification",null,[877]);class ZE extends zi.a{constructor(a,b){super(!1,!0);this.moc=null;this.Cgb=this.oZa=0;this.eMe=50001;this.rIb=null;this.jb=a;this.JNk=b;this.jb.Oka(Object(R.a)(this,this.Pha,"onSlideshowExitHandler"));this.jb.b3b(Object(R.a)(this,this.Iha,"onGetCurrentPositionHandler"));this.jb.getCurrentPosition();
this.GJa=!1}get eBd(){if(void 0===this.moc||null===this.moc)this.moc=document.getElementById("GotoDlgInput");return this.moc}Hmm(){if(!RegExp("^[0-9]+$").test(this.eBd.value))return this.eBd.value=this.oZa.toString(),!1;this.Cgb=Number.parseInvariant(this.eBd.value);this.Cgb=Math.min(this.Cgb,this.JNk);this.Cgb=Math.max(this.Cgb,1);return!0}dispose(){super.dispose();this.moc=null;this.GJa||this.jb.restoreFocus()}sv(){super.sv();document.getElementById("WACDialogOverlay").style.zIndex=String(this.eMe);
const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}IB(){super.IB();const a=document.getElementById(this.ki("WACDialogPanel"));a.style.minWidth=Df.a.Rc(300);a.style.width=Df.a.Rc(300)}open(){ya.a.J(24133980,830,50,"SlideshowGoToDialog: Open");this.Wg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.oZa.toString()};
this.Vj(ResourceStrings.L_GoTo,Object(R.a)(this,this.Hha,"onClickHandler"),a);this.jb.setVisibility(!0);this.eBd.focus()}C9(){super.C9();this.rIb=Object(R.a)(this,this.JLa,"onKeyDownHandler");A.AFrameworkApplication.za.uH.Oud(la.a.Vf,window.document,this.rIb,null)}sua(){super.sua();void 0!==this.rIb&&null!==this.rIb&&A.AFrameworkApplication.za.uH.Tgf(la.a.Vf,window.document,this.rIb);this.rIb=null}Amb(){}Iha(a,b){this.jb.Bmb(Object(R.a)(this,this.Iha,"onGetCurrentPositionHandler"));this.oZa=b.slideIndex+
1;this.open()}Pha(){this.GJa=!0;this.jb.jia(Object(R.a)(this,this.Pha,"onSlideshowExitHandler"));this.jb.Bmb(Object(R.a)(this,this.Iha,"onGetCurrentPositionHandler"));this.hide()}JLa(a){a=a.hc.keyCode;return a===H.a.Mp?(this.Hmm()&&(this.uWa(this.Cgb),this.hide()),!0):a===H.a.pVb||a===H.a.ZOa||a===H.a.K4h||a===H.a.JFd?!0:!1}Hha(a){1===a&&this.uWa(this.Cgb)}uWa(a){this.jb.uWa(a-1)}static Jvk(a,b){1>=b||void 0!==lj.a.ly&&null!==lj.a.ly||new ZE(a,b)}}Object(m.a)(ZE,"SlideshowGoToDialog",zi.a,[]);class $E{constructor(a,
b,c,f,l,u,I,T,ja){this.D6=this.K=null;this.OHb=!1;this.k6=[];this.rZa=this.uF=this.gkc=null;this.jb=a;this.Tb=b;this.txa=c;this.ia=f;this.ue=l;this.zf=u;this.fv=I;this.dv=T;this.Zb=ja}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",this.K.className="SlideshowContextMenuContainer");this.D6=document.createElement("div");this.D6.className="SlideshowContextMenu cui-menu";this.D6.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";
const b=this.fv();let c=this.lM(ResourceStrings.L_Next,Object(R.a)(this,this.mMb,"onNextClickHandler"),b);Array.add(this.k6,c);a.appendChild(c);c=this.lM(ResourceStrings.L_Previous,Object(R.a)(this,this.rMb,"onPrevClickHandler"),b);Array.add(this.k6,c);a.appendChild(c);c=this.lM(ResourceStrings.l_GotoCell,Object(R.a)(this,this.b6k,"onGoToClickHandler"),b);Array.add(this.k6,c);a.appendChild(c);c=this.lM(ResourceStrings.L_GridView_SeeAllSlides,Object(R.a)(this,this.hMb,"onGridViewClickHandler"),b);
Array.add(this.k6,c);a.appendChild(c);this.dv.HUf&&(this.gkc=this.lM(this.dv.N$?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(R.a)(this,this.ILa,"onFullscreenClickHandler"),b),Array.add(this.k6,this.gkc),a.appendChild(this.gkc),this.dv.T0&&!this.uF&&(this.uF=Object(R.a)(this,this.Yqc,"onFullscreenChangeHandler"),$addHandler(this.zf,this.dv.T0,this.uF)));c=this.lM(ResourceStrings.L_EndShow,Object(R.a)(this,this.gMb,"onExitClickHandler"),b);Array.add(this.k6,c);a.appendChild(c);
this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&(this.rZa=this.lM(ResourceStrings.l_EndLivePresentation,Object(R.a)(this,this.W4k,"onEndLivePresentationClickHandler"),b),Array.add(this.k6,this.rZa));this.D6.appendChild(a);this.K.appendChild(this.D6);this.zf.appendChild(this.K);this.txa.addHandler(this.K,la.a.click,Object(R.a)(this,this.Hha,"onClickHandler"));this.txa.addHandler(this.K,la.a.contextMenu,Object(R.a)(this,this.jnh,"onHostContextMenuHandler"));this.txa.addHandler(this.D6,la.a.Wq,Object(R.a)(this,
this.Ikb,"onMouseOverHandler"));this.jb.YZd(Object(R.a)(this,this.Akb,"onContextMenuHandler"));this.jb.Oka(Object(R.a)(this,this.Lpa,"onExitHandler"))}show(){if(this.Zb&&this.Zb.instance&&this.Zb.instance.Xr&&this.rZa&&!this.rZa.parentNode){const a=this.D6.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.rZa)}this.OHb||(this.txa.addHandler(window.document,la.a.Vf,Object(R.a)(this,this.JLa,"onKeyDownHandler")),this.txa.addHandler(window.document,
la.a.rm,Object(R.a)(this,this.erc,"onKeyUpHandler")),this.OHb=!0);this.K.style.visibility=Hf.a.AA}hide(){this.txa.removeHandler(window.document,la.a.Vf,Object(R.a)(this,this.JLa,"onKeyDownHandler"));this.txa.removeHandler(window.document,la.a.rm,Object(R.a)(this,this.erc,"onKeyUpHandler"));this.OHb=!1;this.K.style.visibility=Hf.a.Vt;if(this.rZa&&this.rZa.parentNode){const a=this.D6.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.rZa)}}remove(){this.K&&
(this.txa.removeHandler(this.K,la.a.click,Object(R.a)(this,this.Hha,"onClickHandler")),this.txa.removeHandler(this.K,la.a.contextMenu,Object(R.a)(this,this.jnh,"onHostContextMenuHandler")),this.zf.contains(this.K)&&this.zf.removeChild(this.K));this.K=null;Array.clear(this.k6)}Lpa(){this.jb.jia(Object(R.a)(this,this.Lpa,"onExitHandler"));this.jb.o3e(Object(R.a)(this,this.Akb,"onContextMenuHandler"));this.gkc&&($removeHandler(this.zf,this.dv.T0,this.uF),this.uF=null);this.remove()}Hha(a){"SlideshowContextMenuContainer"===
a.target.id&&(this.hide(),this.jb.restoreFocus())}Akb(a,b){this.grh(b.clientX,b.clientY)}jnh(a){this.grh(a.clientX,a.clientY)}Ikb(a){(a=a.target)&&"li"===a.tagName.toLowerCase()&&(this.O2e(document.activeElement),this.eT(a))}JLa(a){const b=a.keyCode,c=a.shiftKey;b===H.a.zs||b===H.a.o8?this.Fih(!!(1^c)):b===H.a.J3&&this.Fih(!!(0^c));a.preventDefault()}erc(a){var b=a.keyCode;b===H.a.Mp||b===H.a.fO?(b=document.activeElement,Array.contains(this.k6,b)&&b.click()):b===H.a.E_&&this.jb.exit();a.preventDefault()}grh(a,
b){this.setPosition(a,b);this.YTi();this.show();this.D6.focus();this.ue.Yzh(new jz(ResourceStrings.L_ControlMenu))}setPosition(a,b){if(this.D6){var c=this.D6.offsetWidth,f=this.D6.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&(a-=c);b+f>l&&(b-=f);this.D6.style.top=Df.a.Rc(b);this.D6.style.left=Df.a.Rc(a)}}lM(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.txa.addHandler(f,
la.a.click,b);return f}rMb(){ya.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.jb.prev();this.hide();this.jb.restoreFocus()}mMb(){ya.a.J(24133959,830,50,"SlideshowContextMenu.OnNextClickHandler");this.jb.next();this.hide();this.jb.restoreFocus()}b6k(){ya.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();ZE.Jvk(this.jb,this.Tb.Hi())}hMb(){ya.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.Ia(M.a.cSb,2,null)}ILa(){ya.a.J(40935580,
830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.jb.Uef();this.hide();this.jb.restoreFocus()}Yqc(){this.gkc.innerText=this.dv.N$?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}gMb(){ya.a.J(24133963,830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.jb.exit()}W4k(){ya.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.jb.restoreFocus();this.Zb&&this.Zb.instance&&this.Zb.instance.Xr&&this.Zb.instance.showEndSessionDialog(()=>
{this.Zb.instance.S8b(4)},()=>{})}Fih(a){const b=document.activeElement,c=Array.indexOf(this.k6,b);a=this.k6[((-1===c?a?0:-1:a?c+1:c-1)+this.k6.length)%this.k6.length];void 0!==a&&null!==a&&(this.O2e(b),this.eT(a))}YTi(){this.k6.forEach(a=>{this.O2e(a)})}eT(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.ue.Yzh(new jz(a.innerText)))}O2e(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(m.a)($E,
"SlideshowContextMenu",null,[1541]);var rS=d(1041);class yL{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd){this.ua=new uc.a;this.uF=null;this.EOe=this.FOe=this.fkd=this.roc=-1;this.pNg=this.rNg=this.qNg=this.tIb=null;this.Lhc="";this.Cld=this.kkd=-1;this.m_g=new Date(0);this.ZZg="";this.mQg=null;this.wSg=this.chb=this.WGe=this.eJe=!1;this.mKa=this.Ip=this.Mc=null;this.Yic=-1;this.IRg=this.YRg=!1;this.dv=a;this.jb=b;this.Dga=c;this.Tb=ja;this.ka=I;this.iHk=f;this.Qi=l;this.Ms=u;this.Us=
T;this.Xa=ua;this.oA=Ra;this.fe=eb;this.sya=Bb;this.Nc=Ub;this.Kld=Xb;this.Cya=tc;this.Mv=this.Us.JG();this.Ich=this.ka.pptEditorHermesSlideShowStartTimeout;this.lQe=this.ka.slideShowWaitForRehydrationTimeoutInMs;this.Nc.aC(Object(R.a)(this,this.KF,"onSessionEnd"));this.oA.h_d(Object(R.a)(this,this.qMb,"onPodSessionUnavailable"));this.Nc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.ka.allowDisablingSlideShowButtonDueToRehydration&&(this.oA.xvb(Object(R.a)(this,this.Jha,"onPodSessionRefreshed")),
this.oA.cMf(Object(R.a)(this,this.Kpd,"onPodSessionRefreshedFromBrowser")));this.ia=lc;this.Zb=Ec;this.dkd=hd;this.xm=yd;a=document.createElement("div");a.id="HiddenFocusTrapAnchor";A.AFrameworkApplication.fa.getBooleanAppSetting("RegionComposerIsEnabled")||A.AFrameworkApplication.fa.getBooleanAppSetting("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";
a.tabIndex=-1;this.Mv.insertBefore(a,this.Mv.firstChild)}dispose(){this.Nc.F7(Object(R.a)(this,this.KF,"onSessionEnd"));this.oA.cCl(Object(R.a)(this,this.qMb,"onPodSessionUnavailable"));this.Nc.Wba(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.ka.allowDisablingSlideShowButtonDueToRehydration&&(this.oA.Fmb(Object(R.a)(this,this.Jha,"onPodSessionRefreshed")),this.oA.kEh(Object(R.a)(this,this.Kpd,"onPodSessionRefreshedFromBrowser")))}p9j(a,b,c,f){this.mQg=b;"Legacy"==this.jb.t5()&&this.jb.init(a,
b,c,this.Xa.podSessionId);this.Mc=f;this.Ip=new EB}t5(){return this.jb.t5()}bgc(){return!Aa.a.Ta(this.Lhc)}get koe(){return this.chb}set koe(a){this.chb=a}IRl(){this.IRg=!0}tBd(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){eg.Health.instance.addQosPillar("Present");this.bgc()&&ya.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled")&&(this.mKa=Tb.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&
this.mKa.Dhb&&(this.Yic=b,this.ia.nb(M.a.RAd,2,null),this.mKa.pzi(Object(R.a)(this,this.q8k,"onPresenterViewSyncMessageReceivedHandler")));const Ub=c;this.ka.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.roc=ua;this.fkd=Date.now();const Xb=document.createElement("div");Xb.id="startingSlideshowHiddenDiv";Xb.style.position="position: absolute";Xb.style.left="-10000px";Xb.style.top="auto";Xb.style.width="1px";Xb.style.height="1px";Xb.style.overflow="hidden";Xb.tabIndex=-1;Xb.setAttribute("aria-live",
"assertive");this.Mv.insertBefore(Xb,this.Mv.firstChild);Xb.innerText=ResourceStrings.l_StartingSlideShow;const tc=T+ua.toString();this.Lhc=tc;this.sya&&this.sya.Mxc(!0);this.ka.Fqk&&this.Kld&&this.Kld.Mxc(!0);this.Ip&&(this.Ip.S5=c,this.Ip.startingSlideIndex=b,this.Ip.slideCount=this.Tb.Hi(),this.Ip.Q5f=this.ka.hyl);this.ka.pptEditorVoiceUXEnabled&&this.dkd&&this.dkd.init();this.ka.pptEditorVoiceUXEnabled&&this.xm&&this.xm.execute(Ec=>{Ec.init()});this.Dga.execute(Ec=>{Ec.init(this.Mc,this.Ip)});
this.qNg=this.Mv.style.top;this.Mv.style.top=Df.a.Rc(0);this.ka.ZXa&&(this.rNg=this.Mv.style.width,this.pNg=this.Mv.style.height,this.Mv.style.width="100%",this.Mv.style.height="100%");this.jb.show();this.pIg();this.ka.YSh&&ws.a.XTb(!1);A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled")&&this.mKa&&this.mKa.Dhb&&this.jb.ySa(Object(R.a)(this,this.$pd,"onSlideChangedHandler"));this.jb.Oka(Object(R.a)(this,this.Lpa,"onExitHandler"));this.jb.MLf(Object(R.a)(this,this.ILa,"onFullscreenClickHandler"));
this.jb.qOc(Object(R.a)(this,this.bqh,"onSlideshowReadyHandler"));this.jb.JLf(Object(R.a)(this,this.Iod,"onErrorHandler"));this.jb.rOc(Object(R.a)(this,this.iza,"onSpecialKeyHandler"));this.jb.c_d(Object(R.a)(this,this.Jpd,"onPodSessionExpiredHandler"));this.jb.PLf(Object(R.a)(this,this.ipd,"onLogEndOfTranscriptionSessionHandler"));this.jb.OLf(Object(R.a)(this,this.hpd,"onLiveSubtitlesDockedViewHandler"));this.jb.gMf(Object(R.a)(this,this.Fud,"recordQosErrorHandler"));this.ka.allowDisablingSlideShowButtonDueToRehydration||
(this.oA.xvb(Object(R.a)(this,this.Jha,"onPodSessionRefreshed")),this.oA.cMf(Object(R.a)(this,this.Kpd,"onPodSessionRefreshedFromBrowser")));this.gzi(Object(R.a)(this,this.cpd,"onKeydownHandler"));c=Date.now();let lc=!this.ka.vEg||Ra;lc||(lc=this.Qi.v_c().cP());this.YRg=lc;ua=Date.now();ya.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",ua-c,lc?"True":"False",Ra?"True":"False");this.FOe=Date.now();this.Qi.v_c().forceOutbound(()=>
{ya.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.Qi.flush(()=>{this.EOe=Date.now();ya.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.EOe-this.FOe);this.Lhc===tc&&lc&&(Ra&&eb&&(ya.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=eb.$k,u=eb.podSessionId),this.qUh(a,b,f,l,u,I,T,ja,Bb,Ub),ya.a.J(512495811,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},Ec=>{ya.a.J(512495810,
830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Ec.ServerError);return!1})},(Ec,hd)=>{ya.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",hd)},null);this.Lhc!==tc||lc||(this.qUh(a,b,f,l,u,I,T,ja,Bb,Ub),ya.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}qUh(a,b,c,f,l,u,I,T,ja,ua){ua=void 0===ua?!1:ua;const Ra=kh.a.create().toString();this.ka.wCg&&this.lfl(c,l,I,Ra);const eb={};eb.SlideShowKind=
this.jb.t5();eb.IsFrameNull=this.jb?"false":"true";eb.slideshowClickTimeMs=this.roc;void 0!==window.performance.timing&&null!==window.performance.timing&&(eb.slideshowClickTimePerformanceAPI=this.roc-window.performance.timing.navigationStart);ya.a.J(590976135,830,15,"SlideshowManager:startFromInternal - "+JSON.stringify(eb));this.jb.tBd(a,b,f,l,u,I,T,Ra,this.roc);0<this.Ich&&(this.kkd=window.setTimeout(Object(R.a)(this,this.u$k,"onStartSlideshowTimeoutHandler"),this.Ich));this.Zb&&this.Zb.instance&&
this.Zb.instance.cqd(a,b,c,f,l,u,I,A.AFrameworkApplication.mh,ja);this.Mc&&this.Mc.iKl();ua&&(this.Mc.ji=!1);md.a("PresenterCoachTabFix")&&this.jb.JKh()}iza(a,b){if(b.key===H.a.E_)ya.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.Dga.execute(c=>{c.remove()}),this.jb.exit();else if(b.key===H.a.lVb)this.ia.Ia(M.a.sDd,2,null);else if(b.key===H.a.RGd&&this.ka.vna&&this.Mc&&this.Mc.PFa&&this.Ip&&this.Tb&&!this.Ip.S5&&this.ka.vsk&&this.Mc.Iag)try{this.Mc.ji&&(Yi.a.lL("PPTCaptionDiscoverabiltyDoNotShowAgain",
"true",Yi.a.VK)||ya.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));this.Mc.ji=!this.Mc.ji;ya.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Mc.ji);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Mc.ji?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=
!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Xr;if(f)this.jb.toggleTranscriberUIVisibility(null);else{const l=Date.now();this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,4,l,this.Ip)}this.Dga.execute(l=>{l.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Mc.ji);l.SF(wh.a.CoachButton,!this.Mc.ji&&!f)})}catch(c){ya.a.J(512495776,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",c)}else if(b.key===
H.a.WCc&&this.Zb&&this.Zb.instance&&this.Zb.instance.PFa&&this.Zb.instance.Dkj&&this.Ip&&!this.Ip.S5)try{if(this.Zb.instance.Xr)this.Zb.instance.showWelcomeScreen();else{this.Zb.instance.$ea=!this.Mc.ji;if(this.Mc.Qzb&&!this.Mc.ji){this.Mc.ji=!0;const c=Date.now();this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,5,c,this.Ip);this.Mc.ji=!1}this.Zb.instance.qzc(4,A.AFrameworkApplication.userSessionId,this.ka.podsWebServiceBase,this.Xa.podSessionId,
A.AFrameworkApplication.mh)}}catch(c){ya.a.J(512495775,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",c)}}q8k(a,b){b&&(a=b.slideIndex,a!==this.Yic&&(this.Yic=a,this.jb.uWa(a)))}r1a(){ya.a.J(512495774,830,15,"SlideshowManager.OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.eJe=!0}lfl(a,b,c,f){ya.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",
a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.mQg;this.Ms.Tj(a,2,null,b,!1,2,()=>{ya.a.J(512495772,830,15,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{ya.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,ro.a("14"))}Oka(a){this.ua.addHandler("OnExitSlideshow",
a)}jia(a){this.ua.removeHandler("OnExitSlideshow",a)}ySa(a){this.ua.addHandler("OnPositionChangeEventId",a)}Dmb(a){this.ua.removeHandler("OnPositionChangeEventId",a)}gzi(a){this.tIb||(this.tIb=a,Ae.a.addHandler(window.document.body,"keydown",this.tIb))}q3e(){this.tIb&&(Ae.a.removeHandler(window.document.body,"keydown",this.tIb),this.tIb=null)}Yqc(){if(this.dv.N$)ya.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.RWf();this.jb.w3e(Object(R.a)(this,
this.r1a,"onVisibilityChangeHandler"));ya.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");var a=A.AFrameworkApplication.fa.Ea(A.AFrameworkApplication.uL);a=!!a&&"teams"===a.toLowerCase();this.eJe||this.WGe||!document.hasFocus()||a||(ya.a.J(512495768,830,15,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.Dga.execute(b=>{b.remove()}),this.jb.exit());this.eJe=!1}this.WGe=!1}$pd(a,b){b&&this.Yic!==b.slideIndex&&(this.Yic=b.slideIndex,
this.mKa.fNl(b))}Lpa(a,b){ya.a.J(512495767,830,15,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.tXf();var c=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.Lhc="";this.sya&&this.sya.Mxc(!1);this.Kld&&this.Kld.Mxc(!1);this.Mc&&this.Mc.$Gl();this.jb.jia(Object(R.a)(this,this.Lpa,"onExitHandler"));this.jb.WDh(Object(R.a)(this,
this.ILa,"onFullscreenClickHandler"));this.jb.rvd(Object(R.a)(this,this.bqh,"onSlideshowReadyHandler"));this.jb.TDh(Object(R.a)(this,this.Iod,"onErrorHandler"));this.jb.svd(Object(R.a)(this,this.iza,"onSpecialKeyHandler"));this.jb.w3e(Object(R.a)(this,this.r1a,"onVisibilityChangeHandler"));this.jb.s3e(Object(R.a)(this,this.Jpd,"onPodSessionExpiredHandler"));this.jb.YDh(Object(R.a)(this,this.ipd,"onLogEndOfTranscriptionSessionHandler"));this.jb.XDh(Object(R.a)(this,this.hpd,"onLiveSubtitlesDockedViewHandler"));
this.jb.qEh(Object(R.a)(this,this.Fud,"recordQosErrorHandler"));this.q3e(Object(R.a)(this,this.cpd,"onKeydownHandler"));(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.ka.allowDisablingSlideShowButtonDueToRehydration||(this.oA.Fmb(Object(R.a)(this,this.Jha,"onPodSessionRefreshed")),this.oA.kEh(Object(R.a)(this,this.Kpd,"onPodSessionRefreshedFromBrowser")));this.ka.YSh&&(ws.a.XTb(!0),this.dv.N$||VH.a.T2a(A.AFrameworkApplication.isRtl));this.RWf();Jt.exitFullscreen();
this.Mv.style.top=this.qNg;this.ka.ZXa&&(this.Mv.style.width=this.rNg,this.Mv.style.height=this.pNg);this.Us.qv();this.ua.raiseEvent("OnExitSlideshow",b,a);this.Zb&&this.Zb.instance&&this.Zb.instance.f$k();this.Ip&&this.Ip.S5&&b.summary&&this.ia.Ia(M.a.SNa,2,b.summary);A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled")&&this.mKa&&this.mKa.Dhb&&this.ia.nb(M.a.aSc,2,null);this.Ip&&(this.Ip.S5=!1);this.ka.pptEditorVoiceUXEnabled&&this.xm&&this.xm.instance&&this.xm.instance.remove();
this.ka.pptEditorVoiceUXEnabled&&this.dkd&&this.dkd.remove();this.Wbm()}Wbm(){A.AFrameworkApplication.fa.getBooleanAppSetting("798")&&Tb.a.instance.Ha("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{ya.a.J(512495766,830,15,"SlideshowManager.Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}ILa(){this.WGe=!0;this.dv.N$?Jt.exitFullscreen():this.pIg()}pIg(){let a=this.Mv;this.ka.LU&&(a=document.documentElement);a&&this.dv.Mec&&(this.dv.T0&&!this.uF&&
(this.uF=Object(R.a)(this,this.Yqc,"onFullscreenChangeHandler"),$addHandler(a,this.dv.T0,this.uF)),this.dv.requestFullscreen(a),this.jb.$Lf(Object(R.a)(this,this.r1a,"onVisibilityChangeHandler")))}bqh(){this.tXf();var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1===this.fkd)ya.a.J(508924039,830,10,"SlideshowManager.onSlideshowReadyHandler returning early since slideshowStartTimeMs is -1");
else{b=Date.now();ya.a.J(23098073,830,15,"SlideshowManager.slideshow ready in {0} ms",b-this.fkd);a={};a.SlideshowClickTimeMs=this.roc;a.SlideshowStartTimeMs=this.fkd;a.SlideshowStartFlushTimeMs=this.FOe;a.SlideshowFinishFlushTimeMs=this.EOe;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.ka.vEg;a.NoBlockingOutBound=!this.YRg;ya.a.J(512495765,830,15,"SlideshowManager.onSlideshowReadyHandler"+JSON.stringify(a));this.Dga.execute(()=>{this.ka.lfc&&this.jb.getCurrentSlideDimensions()});!this.ka.Mg||
!this.ka.Svh&&this.ka.lfc||this.iHk.init(this.Mc,this.Ip);b=!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.OFa;a=!!this.Zb&&!!this.Zb.instance&&(this.Zb.instance.cVa||this.Zb.instance.Xr);if((this.ka.vna||this.ka.qgc)&&this.Mc&&this.Ip&&this.Tb&&(this.Mc.ji||this.Ip.S5||b||a)&&this.Mc.Iag){const c=Date.now();let f=2;A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es&&(f=1);const l=this.Mc.ji;b||a?(this.Mc.ji||(f=5),this.Zb.instance.$ea=!this.Mc.ji,this.Mc.ji=!0):this.Zb&&
this.Zb.instance&&(this.Zb.instance.$ea=!1);this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,f,c,this.Ip);this.Mc.ji=l}b&&(this.Zb.instance.OFa=!1);this.q3e(Object(R.a)(this,this.cpd,"onKeydownHandler"));this.jb.Bia(!1);this.jb.setOsfLocalStorage()}}cpd(a){27===a.keyCode&&(ya.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.q3e(Object(R.a)(this,this.cpd,"onKeydownHandler")),this.Dga.execute(b=>{b.remove()}),this.jb.exit())}ipd(a,
b){a={};try{const c=Qa.a.AM(b.Qy);for(const f of c)try{a[f]=b.Qy[f]}catch(l){ya.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",f,l)}}catch(c){ya.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}ya.a.J(512495761,830,15,"SlideshowManager.onLogEndOfTranscriptionSessionHandler"+
JSON.stringify(a));try{!(this.Ip&&this.Ip.S5||!this.ka.mjl||this.wSg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(ya.a.J(512495760,830,50,"SlideshowManager.Floodgate survey triggered for transcription."),this.wSg=!0,this.Cya.continueWith(()=>{this.Cya.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){ya.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
c)}}hpd(a,b){this.ka.lfc||((a=document.getElementById("slideshow-toolbar"))?b.egc?"BelowSlide"===b.Xw?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.Xw?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):ya.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}Jpd(a,b){ya.a.J(512495757,830,15,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",
b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Xa.podSessionId)ya.a.J(512495756,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",this.Xa.podSessionId,b.podSessionId);else{if((a=this.ka.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.m_g.getTime()+1E3*this.ka.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);
const f=new Date,l=f>c;ya.a.J(512495755,830,15,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(ya.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",b.code),this.fe.At(Object.assign(new vl.a,{Code:223,Source:4}),b.podSessionId),0<this.lQe)){ya.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",
this.lQe);this.m_g=new Date;this.ZZg=b.podSessionId;this.Cld=window.setTimeout(Object(R.a)(this,this.lyl,"rehydrationTimeout"),this.lQe);return}}else if(this.ZZg===b.podSessionId){ya.a.J(512495752,830,15,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",b.podSessionId);return}}A.AFrameworkApplication.Lp(jg.a.hi(359));eg.Health.instance.recordQosError("SlideShowPodSessionExpiredFailure",
["SlideShowACE"],!1,!1,!0,!1,null);this.ka.podExitSlideshowOnError&&(ya.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Dga.execute(f=>{f.remove()}),this.jb.exit())}}Iod(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,b.code,b.sessionId,b.correlationId,b.message,b.ny,b.hek.toString());ya.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",
a);A.AFrameworkApplication.Lp(jg.a.hi(359));eg.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.ka.podExitSlideshowOnError&&(ya.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.Dga.execute(c=>{c.remove()}),this.jb.exit())}RWf(){let a=this.Mv;this.ka.LU&&(a=document.documentElement);a&&this.uF&&(ya.a.J(512495748,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(a,this.dv.T0,
this.uF),this.uF=null)}u$k(){ya.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");A.AFrameworkApplication.Lp(jg.a.hi(360));eg.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.Dga.execute(a=>{a.remove()});this.jb.exit()}lyl(){ya.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");A.AFrameworkApplication.Lp(jg.a.hi(371));eg.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.Dga.execute(a=>
{a.remove()});this.jb.exit()}Fud(a,b){a=0<b.durationMs?Object.assign(new Fl.a,{durationMs:b.durationMs}):null;eg.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}Jha(a,b){ya.a.J(512495745,830,15,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.ka.allowDisablingSlideShowButtonDueToRehydration);this.chb=!1;this.xXf();this.bgc()||"Legacy"!=this.jb.t5()?
(ya.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.HZ,this.Xa.$k),this.jb.refreshPodSession(b.HZ,this.Xa.$k)):ya.a.J(512495744,830,15,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}Kpd(a,b){ya.a.J(512495714,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.ka.allowDisablingSlideShowButtonDueToRehydration);
this.chb=!1;this.xXf();this.bgc()||"Legacy"!=this.jb.t5()?(ya.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.HZ,this.Xa.$k),this.jb.refreshPodSession(b.HZ,this.Xa.$k)):ya.a.J(512495713,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}mo(){this.chb=!1;ya.a.J(512495711,830,15,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.ka.allowDisablingSlideShowButtonDueToRehydration)}KF(){this.chb=!0;ya.a.J(512495710,830,15,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.ka.allowDisablingSlideShowButtonDueToRehydration)}qMb(){this.chb=!0;ya.a.J(512495709,830,15,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.ka.allowDisablingSlideShowButtonDueToRehydration)}tXf(){-1!==
this.kkd&&(window.clearTimeout(this.kkd),this.kkd=-1)}xXf(){-1!==this.Cld&&(window.clearTimeout(this.Cld),this.Cld=-1)}}Object(m.a)(yL,"SlideshowManager",null,[878]);class aF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.Exa=this.lkc=this.ojb=this.dHb=this.Ngb=this.sZa=this.WIb=this.AJb=this.Ip=this.Mc=this.ye=null;this.okc=0;this.lN=!1;this.uF=null;this.jb=c;this.te=f;this.gQe=l;this.zf=I;this.fv=T;this.Xa=ua;this.dv=Ra;this.ia=a;this.Ba=b;this.WKe=null;this.EMe=ja;this.Zb=u}init(a,b){this.ye=document.createElement("div");
this.ye.id="slideshow-toolbar";this.ye.className="SlideshowToolbar";this.zf.appendChild(this.ye);this.Mc=a;this.Ip=b;this.fv()?(this.AJb=this.dua("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.WIb=this.dua("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.AJb=this.dua("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.WIb=this.dua("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.ye.appendChild(this.AJb);this.ye.appendChild(this.WIb);Ae.a.addHandler(this.AJb,la.a.click,Object(R.a)(this,this.rMb,"onPrevClickHandler"));Ae.a.addHandler(this.WIb,la.a.click,Object(R.a)(this,this.mMb,"onNextClickHandler"));this.lkc=this.dua("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.ye.appendChild(this.lkc);
Ae.a.addHandler(this.lkc,la.a.click,Object(R.a)(this,this.hMb,"onGridViewClickHandler"));this.Ngb=this.sZa=null;this.dv.HUf&&(this.sZa=this.dua("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.Ngb=this.dua("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.dv.N$,this.sZa.style.display=a?Hf.a.kf:Hf.a.kl,this.Ngb.style.display=a?Hf.a.kl:Hf.a.kf,this.ye.appendChild(this.sZa),
this.ye.appendChild(this.Ngb),Ae.a.addHandler(this.sZa,la.a.click,Object(R.a)(this,this.ILa,"onFullscreenClickHandler")),Ae.a.addHandler(this.Ngb,la.a.click,Object(R.a)(this,this.ILa,"onFullscreenClickHandler")),this.dv.T0&&!this.uF&&(this.uF=Object(R.a)(this,this.Yqc,"onFullscreenChangeHandler"),$addHandler(this.zf,this.dv.T0,this.uF)));this.ojb=null;this.Mc.Qzb&&!this.Ip.S5&&(this.ojb=this.dua("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.ye.appendChild(this.ojb),Ae.a.addHandler(this.ojb,la.a.click,Object(R.a)(this,this.qqd,"onTranscribeHandler")));this.dHb=this.dua("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.ye.appendChild(this.dHb);Ae.a.addHandler(this.dHb,la.a.click,Object(R.a)(this,this.gMb,"onExitClickHandler"));this.Exa=null;this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&!this.Ip.S5&&(this.Zb.instance.VLf(Object(R.a)(this,this.hrc,"onLiveSessionStarted")),
this.Zb.instance.TLf(Object(R.a)(this,this.grc,"onLiveSessionEnded")),this.Zb.instance.Dyi(Object(R.a)(this,this.Nnh,"onLiveCalloutDismissed")),this.Zb.instance.QLf(Object(R.a)(this,this.frc,"onLiveRelaunchPausedSession")),this.Zb.instance.obb?this.l1f():this.Zb.instance.Azi(Object(R.a)(this,this.Pnh,"onLivePresenterResourcesLoaded")));this.lN=!1;this.hide();this.jb.Oka(Object(R.a)(this,this.Lpa,"onExitHandler"));this.jb.VZd(Object(R.a)(this,this.zkb,"onBrowserEventHandler"));Ae.a.addHandler(this.ye,
la.a.Wq,Object(R.a)(this,this.Ikb,"onMouseOverHandler"));Ae.a.addHandler(this.ye,la.a.Rt,Object(R.a)(this,this.krc,"onMouseOutHandler"))}show(){this.ye.style.display=Hf.a.kl;window.clearTimeout(this.okc);this.okc=window.setTimeout(Object(R.a)(this,this.hide,"hide"),3E3);this.jb.Bia(!0)}hide(){this.lN||(window.clearTimeout(this.okc),this.ye.style.display=Hf.a.kf,this.jb.Bia(!1))}remove(){this.ye&&this.zf.contains(this.ye)&&(this.zf.removeChild(this.ye),this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&
(this.Zb.instance.eEh(Object(R.a)(this,this.hrc,"onLiveSessionStarted")),this.Zb.instance.dEh(Object(R.a)(this,this.grc,"onLiveSessionEnded")),this.Zb.instance.hBl(Object(R.a)(this,this.Nnh,"onLiveCalloutDismissed")),this.Zb.instance.OBl(Object(R.a)(this,this.Pnh,"onLivePresenterResourcesLoaded")),this.Zb.instance.aEh(Object(R.a)(this,this.frc,"onLiveRelaunchPausedSession"))),this.lN=!1)}SF(){}setToolbarButtonToggleState(){}Lpa(){this.jb.jia(Object(R.a)(this,this.Lpa,"onExitHandler"));this.jb.l3e(Object(R.a)(this,
this.zkb,"onBrowserEventHandler"));Ae.a.removeHandler(this.ye,la.a.Wq,Object(R.a)(this,this.Ikb,"onMouseOverHandler"));Ae.a.removeHandler(this.ye,la.a.Rt,Object(R.a)(this,this.krc,"onMouseOutHandler"));Ae.a.removeHandler(this.AJb,la.a.click,Object(R.a)(this,this.rMb,"onPrevClickHandler"));Ae.a.removeHandler(this.WIb,la.a.click,Object(R.a)(this,this.mMb,"onNextClickHandler"));Ae.a.removeHandler(this.dHb,la.a.click,Object(R.a)(this,this.gMb,"onExitClickHandler"));this.Exa&&Ae.a.removeHandler(this.Exa,
la.a.click,Object(R.a)(this,this.Mnh,"onLiveBroadcastHandler"));this.ojb&&Ae.a.removeHandler(this.ojb,la.a.click,Object(R.a)(this,this.qqd,"onTranscribeHandler"));this.sZa&&(Ae.a.removeHandler(this.sZa,la.a.click,Object(R.a)(this,this.ILa,"onFullscreenClickHandler")),Ae.a.removeHandler(this.Ngb,la.a.click,Object(R.a)(this,this.ILa,"onFullscreenClickHandler")),$removeHandler(this.zf,this.dv.T0,this.uF),this.uF=null);this.lkc&&Ae.a.removeHandler(this.lkc,la.a.click,Object(R.a)(this,this.hMb,"onGridViewClickHandler"));
this.remove()}zkb(){this.show()}Yqc(){const a=this.dv.N$;this.sZa.style.display=a?Hf.a.kf:Hf.a.kl;this.Ngb.style.display=a?Hf.a.kl:Hf.a.kf}Ikb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.lN=!0}krc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Mc.ji&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Zb&&!this.Zb.instance.Xr&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.Kce()||(this.lN=!1);this.Kce()||this.jb.restoreFocus()}rMb(){ya.a.J(508692442,830,50,"SlideshowToolbar.OnPrevClickHandler");this.L4a(this.AJb.title);this.jb.prev();this.jb.restoreFocus()}mMb(){ya.a.J(508692441,830,50,"SlideshowToolbar.OnNextClickHandler");this.L4a(this.WIb.title);this.jb.next();this.jb.restoreFocus()}gMb(){ya.a.J(508692440,830,50,"SlideshowToolbar.OnExitClickHandler");
this.L4a(this.dHb.title);this.jb.exit()}ILa(){ya.a.J(508692439,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.jb.Uef()}Mnh(){this.Zb&&this.Zb.instance&&(this.L4a(this.Exa.title),ya.a.J(508692438,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Zb.instance.Xr),this.Zb.instance.Xr?(this.jb.pausePresentation(),this.Zb.instance.showCallout(this.Exa)):(this.Zb.instance.qzc(3,A.AFrameworkApplication.userSessionId,this.EMe,this.Xa.podSessionId,A.AFrameworkApplication.mh),this.Zb.instance.$ea=
!this.Mc.ji,this.Mc.Qzb&&!this.Mc.ji&&(ya.a.J(508692437,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Mc.ji=!0,this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,5,Date.now(),this.Ip),this.Mc.ji=!1)),this.Fhf())}Xef(a,b){this.L4a(this.ojb.title);const c=!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Xr,f=this.Mc.Gag&&5!==a&&!c;5!==a&&(this.Mc.ji=!this.Mc.ji);ya.a.J(508692436,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Mc.ji);b&&(this.Mc.ji?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&FB.lIg(this.jb,this.te,this.Xa)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.jb.toggleTranscriberUIVisibility(null):this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,a,b,this.Ip))}qqd(a){this.Xef(3,a.target)}hMb(){ya.a.J(508692435,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.Ia(M.a.cSb,2,null)}l1f(){this.Exa||
(this.Exa=this.dua("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.ye.insertBefore(this.Exa,this.dHb),Ae.a.addHandler(this.Exa,la.a.click,Object(R.a)(this,this.Mnh,"onLiveBroadcastHandler")))}dua(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=mp.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Mc.ji?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.te.Ok("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=mp.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Zb&&this.Zb.instance&&this.Zb.instance.Xr?"Hover_40x40x32":"_40x40x32"),"prt2",this.te.Ok("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.WKe=a.children[0]),l;a=mp.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.te.Ok("prt2.png"),null,null,!0,null);l.appendChild(a);
l.title=f;return l}L4a(a){Aa.a.Ta(a)?ya.a.J(508692434,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.gQe.Zzh(new jz(a))}Kce(){return!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Tkj}Fhf(){this.Zb&&this.Zb.instance&&this.WKe&&(this.WKe.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Zb.instance.Xr?"Hover_40x40x32":"_40x40x32"))}Pnh(){this.l1f()}hrc(){this.Fhf()}grc(){this.Zb&&this.Zb.instance&&this.Zb.instance.$ea&&!this.Mc.ji&&(ya.a.J(508692433,
830,50,"Stopping subtitle for stopping live session."),this.jb.transcribe(A.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.$k,A.AFrameworkApplication.mh,5,Date.now(),this.Ip));this.Zb.instance.$ea=!1;this.Fhf()}frc(){this.Zb&&this.Zb.instance&&(this.lN=!0,this.show(),this.jb.pausePresentation(),this.Zb.instance.showCallout(this.Exa))}Nnh(){this.lN=this.Kce();this.lN||(window.clearTimeout(this.okc),this.okc=window.setTimeout(Object(R.a)(this,this.hide,"hide"),3E3))}}Object(m.a)(aF,
"SlideshowToolbar",null,[1540,1541]);class hv{constructor(a){this.AHb=this.A2=this.UKb=null;this.cPe="BelowSlide";this.Pgb=this.yRg=!1;this.Rjc=!0;this.fdd=-1;this.WRg=this.Ejc=this.TGe=!1;this.YMe=this.ePe=this.gPe=this.fPe=null;this.ka=a;A.AFrameworkApplication.fa.Ue(Object(R.a)(this,this.Pn,"onFullAppSettingsReady"));a=Fe.b(A.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.JMg=a.Ring||"Unknown";this.gNg=A.AFrameworkApplication.buildVersion||"Unknown";this.B_g=this.ka.iMa||
"Unknown";this.qfh=a.Host||"Unknown";this.pfh=a.WACDatacenter||"Unknown";this.Bch=this.mzj();this.Voc=this.pzj();this.ueh=this.H2c();this.kHb=hv.rif;switch(this.ka.wbm){case "ByUIHostName":a=A.AFrameworkApplication.fa.Ea(A.AFrameworkApplication.uL);this.Pgb=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.Pgb=A.AFrameworkApplication.isEmbedded;break;default:this.Pgb=A.AFrameworkApplication.fa.getBooleanAppSetting("IsUIEmbedMode")}ya.a.J(508692370,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.kHb,this.cPe)}Pn(){this.UKb=this.getUserId();this.A2=A.AFrameworkApplication.fa.Ea("TenantId");this.AHb=this.ka.hostAuthType||A.AFrameworkApplication.fa.Ea("HostAuthType")||"Unknown"}getUserId(){let a=A.AFrameworkApplication.fa.Ea("PptEditingUserId");Aa.a.Ta(a)&&(a=A.AFrameworkApplication.fa.Ea("LoggableUserId"),ya.a.J(508692369,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Aa.a.Ta(a)));return a}get q9b(){return this.yRg}set q9b(a){ya.a.J(508692368,830,50,
"SubtitleContext: Update FEnabledInBaseDoc to {0}",a);this.yRg=a}get ji(){return this.ka.vna&&this.q9b&&this.kHb&&!this.Pgb}set ji(a){this.kHb!==a&&(this.kHb=a,hv.rif=this.kHb)}get p9b(){return this.ka.vna&&this.Ejc}set p9b(a){this.Ejc!==a&&(this.Ejc=a)}get bbg(){return this.WRg}get Iag(){return!this.Pgb}get Wzb(){return this.TGe}set Wzb(a){this.TGe!==a&&(this.TGe=a)}get Qzb(){return this.ka.vna&&this.q9b&&this.ka.ssk&&!this.Pgb}get Gag(){const a=Yi.a.get("PPTLiveSubtitleEnabled");return this.ka.vna&&
this.ka.xsk&&Aa.a.Ta(a)&&!this.Pgb}get Gcf(){if(!this.ePe){const b=new La.a;var a=this.ka.Gvh;if(!Aa.a.Ta(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.ePe=hv.nNf(b)}return this.ePe}get Fcf(){if(!this.YMe){const b=new La.a;var a=this.ka.Gvh;if(!Aa.a.Ta(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.YMe=hv.nNf(b)}return this.YMe}get QSb(){this.fPe||(this.fPe=Aa.a.Ta(this.ka.Hvh)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.ka.Hvh,
!0));return this.fPe}get jbf(){this.gPe||(this.gPe=hv.gDi(this.QSb));return this.gPe}iKl(){this.fdd=this.kHb?1:0}$Gl(){-1!==this.fdd&&(this.ji=1===this.fdd?!0:!1,this.fdd=-1)}mzj(){try{const a=Ea.a.Oe(A.AFrameworkApplication.lcid);if(!a)return ya.a.J(508692367,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",A.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(const c of this.Gcf)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
for(const c of this.Fcf)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;this.Ejc=!0;return"en-us"}catch(a){ya.a.J(508692366,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",A.AFrameworkApplication.lcid,a)}this.Ejc=!0;return"en-us"}pzj(){try{const a=Ea.a.Oe(A.AFrameworkApplication.lcid);if(!a||Aa.a.Ta(a.name))return ya.a.J(508692365,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",
A.AFrameworkApplication.lcid),"en";const b=a.name.toLowerCase();if(!Aa.a.Ta(b)&&this.QSb[b])return b;const c=Ea.a.Oe(a.languageId);if(!c||Aa.a.Ta(c.name))return ya.a.J(508692364,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",A.AFrameworkApplication.lcid),"en";let f=c.name.toLowerCase();this.QSb[f]||(ya.a.J(508692363,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,f,A.AFrameworkApplication.lcid),f="en");return f}catch(a){ya.a.J(508692362,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",A.AFrameworkApplication.lcid,a)}return"en"}H2c(){try{if(Aa.a.Ta(this.Voc))return ya.a.J(508692361,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",A.AFrameworkApplication.lcid),"en-us";const a=this.QSb[this.Voc.toLowerCase()];
if(!Aa.a.Ta(a))return a}catch(a){ya.a.J(508692360,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.Voc,A.AFrameworkApplication.lcid,a)}return"en-us"}xwj(a){if(Aa.a.Ta(a))return ya.a.J(508692359,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return ya.a.J(508692358,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.QSb;var f=this.jbf;for(const l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;ya.a.J(508692357,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get hra(){return this.Bch}set hra(a){this.Bch=a;this.WRg=!0}get userId(){return this.UKb}set userId(a){this.UKb=a}get locale(){return this.B_g}set locale(a){this.B_g=a}get audienceGroup(){return this.JMg}set audienceGroup(a){this.JMg=
a}get buildVersion(){return this.gNg}set buildVersion(a){this.gNg=a}get identityProvider(){return this.AHb}set identityProvider(a){this.AHb=a}get wacHost(){return this.qfh}set wacHost(a){this.qfh=a}get wacDatacenter(){return this.pfh}set wacDatacenter(a){this.pfh=a}get tenantId(){return this.A2}set tenantId(a){this.A2=a}get rBa(){return this.Voc}set rBa(a){this.Voc=a}get Mpb(){return this.ueh}set Mpb(a){this.ueh=a}get Xw(){return this.cPe}set Xw(a){this.cPe=a}get U6l(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.Xw;a.SpeechLanguage=this.hra;a.TranslationLanguages=this.Mpb;a.FUseSubtitles=this.ji;return JSON.stringify(a)}get PFa(){return this.Rjc}set PFa(a){this.Rjc=a}get Lkj(){return 0<=this.ka.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.rBa)}static get rif(){const a=
Yi.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set rif(a){Yi.a.lL("PPTLiveSubtitleEnabled",a.toString(),Yi.a.VK)||ya.a.J(508692356,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static nNf(a){const b={},c=new La.a;for(const f of a)try{const l=Ea.a.Oe(f).displayName;c.add(l);b[l]=f}catch(l){ya.a.J(508692355,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));
a=new La.a;for(const f of c)f&&0<f.length&&a.add(b[f]);return a}static gDi(a){const b=Qa.a.AM(a);a={};const c=new La.a;for(var f of b)try{const l=Ea.a.Oe(f).displayName;Aa.a.Ta(l)?ya.a.J(508692354,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",f,A.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){ya.a.J(508692353,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
f,l)}c.Sc((l,u)=>l.localeCompare(u));f=new La.a;for(const l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(m.a)(hv,"SubtitleContext",null,[873]);const bF=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=zL(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=zL(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},zL=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class AL{constructor(a){this.Fp=a}FJi(){return bF()}EJi(){let a=!1;const b=this.FJi();if(b&&!this.Fp.oP(1))try{const c=document.createElement("canvas"),
f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}ya.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.Fp.nx,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(m.a)(AL,"WebGLHelperProxy",null,[872]);var BL=d(657),sS=d(740);class CL{mHj(a){return optionsButton.OptionsButtonManagerFactory.createOptionsButtonManager(a)}}
Object(m.a)(CL,"OptionsButtonLoader",null,[879]);class cF{constructor(){this.ka=this.wb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}fc(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.wb=b.JG();this.ka=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(871,"PowerPointWebEditor.IFullscreenHelper").ma().na(()=>new qL);this.K.register(872,"PowerPointWebEditor.IWebGLHelper").ma().na(()=>new AL(this.K.resolve("Common.IBrowserUtils")));
this.K.register(873,"PowerPointWebEditor.ISubtitleContext").ma().na(()=>new hv(this.ka));this.K.register(874,"PowerPointWebEditor.IRehearsalContext").ma().na(()=>new EB);this.yhc({["Type"]:"CheckBrowserStart"});a={};var c=this.ifk(a);const f=bF()&&this.ka.fYa&&c&&this.hfk(),l=this.ka.fYa&&this.gfk(),u=!f&&l;this.yhc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:u});
if(this.ka.getBooleanAppSetting("DefaultToModernSlideShow")&&(f||l)){this.K.register(875,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new sS.SlideShowCoreFrame(this.wb,this.ka,this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").nG,this.K.Ha("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ha("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),
u,this.K.resolve("PowerPoint.IPathManager"),this.K.Ha("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,A.AFrameworkApplication.Me));const ua={};ua.loadScriptStart=Date.now();a=pL.a.create(A.AFrameworkApplication.Ui("powerpoint-slideshow-strings",3));VE.a.bF(a);Promise.all([new Promise((Ra,eb)=>{const Bb=document.createElement("script");Bb.async=!1;Bb.src=A.AFrameworkApplication.Ui(String.format("slideshowcore{0}.js",
".min"),5);Bb.addEventListener("load",()=>{ya.a.J(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");Ra(Bb)});Bb.addEventListener("error",()=>{ya.a.J(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");eb(Bb)});document.head.appendChild(Bb)}),new Promise((Ra,eb)=>{const Bb=document.createElement("script");Bb.async=!1;Bb.src=A.AFrameworkApplication.Ui(String.format("podsproxy{0}.js",".min"),5);Bb.addEventListener("load",()=>{ya.a.J(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");
Ra(Bb)});Bb.addEventListener("error",()=>{ya.a.J(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");eb(Bb)});document.head.appendChild(Bb)}),new Promise((Ra,eb)=>{const Bb=document.createElement("script");Bb.async=!1;Bb.src=A.AFrameworkApplication.Ui(String.format("pptspeechclient{0}.js",".min"),5);Bb.addEventListener("load",()=>{ya.a.J(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");Ra(Bb)});Bb.addEventListener("error",()=>{ya.a.J(509636754,830,10,
"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");eb(Bb)});document.head.appendChild(Bb)})]).then(()=>{ua.loadScriptEnd=Date.now();const Ra={Type:"LoadedJS"};Qa.a.forEach(ua,(eb,Bb)=>{Ra[eb]=Bb},null);this.yhc(Ra);this.K.resolve("PowerPointWebEditor.ISlideshowManager").IRg||(ya.a.J(509636753,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(A.AFrameworkApplication.buildVersion,
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").$k,A.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.K.resolve("PowerPointWebEditor.ISlideshowManager").IRl());return null}).catch(Ra=>{this.yhc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});ya.a.J(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Ra)})}else this.ka.getBooleanAppSetting("DefaultToModernSlideShow")?
this.yhc({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):ya.a.J(512309319,830,15,"PPTWebEditorSlideShowPackage::PptDefaultToModernSlideShow is disabled"),this.K.register(875,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new rS.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.wb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ha("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),
this.K.Ha("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").nG));this.K.register(YE,"PowerPointWebEditor.SlideShowFooterContainer").na(()=>new YE(this.wb,A.AFrameworkApplication.Pa));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").qb();let I;if(!this.ka.lfc||this.ka.Svh)this.K.register(aF,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new aF(A.AFrameworkApplication.Pa,this.ka,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ha("PowerPointLive.ILivePresenter"),this.wb,()=>A.AFrameworkApplication.isRtl,this.ka.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=zs.a(this.K);c=new La.a;c.add(a("slideshowToolbar"));this.ka.$il&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Ra=>
ya.a.J(50907106,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the slideshowToolbar feature: {0}",Ra)).then(()=>this.n$k()).catch(Ra=>ya.a.J(50907136,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React slideshowToolbar: {0}",Ra));this.ka.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Ra=>ya.a.J(51218050,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the ink button feature: {0}",Ra)).then(()=>this.s6k()).catch(Ra=>ya.a.J(51218052,830,10,
"PPTWebEditorSlideShowPackage::Failed to load the React ink button: {0}",Ra)),this.K.register(876,"PowerPointWebEditor.IInkButtonHelper").ma().na(()=>new rL));this.ka.LU&&this.Sxk(a);if(this.ka.pptEditorVoiceUXEnabled){const Ra=this;a("voiceUI").catch(eb=>ya.a.J(595198419,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the voice UI feature: {0}",eb)).then(()=>Ra.o$k()).catch(eb=>ya.a.J(595198417,830,10,"PPTWebEditorSlideShowPackage::Failed to load the voice UI script: {0}",
eb));this.K.register(877,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().na(()=>new xL)}const ua=this;this.K.register(XE,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new XE(A.AFrameworkApplication.Pa,ua.ka,ua.K.resolve("PowerPointWebEditor.ISlideshowFrame"),ua.K.resolve("PowerPoint.IPathManager"),ua.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),ua.K.Ha("PowerPointLive.ILivePresenter"),ua.wb,()=>A.AFrameworkApplication.isRtl,
ua.ka.podsWebServiceBase,ua.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ua.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}I=this.K.Ha("PowerPointWebEditor.ISlideshowToolbar");const T=this;this.K.register($E,"PowerPointWebEditor.SlideshowContextMenu").na(()=>new $E(T.K.resolve("PowerPointWebEditor.ISlideshowFrame"),T.K.resolve("PowerPointWebEditor.IPresentationReader"),T.K.resolve("PowerPointWebEditor.IInputHandlerManager"),A.AFrameworkApplication.Pa,T.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
T.wb,()=>A.AFrameworkApplication.isRtl,T.K.resolve("PowerPointWebEditor.IFullscreenHelper"),T.K.Ha("PowerPointLive.ILivePresenter")));const ja=this;this.K.register(878,"PowerPointWebEditor.ISlideshowManager").ma().na(()=>new yL(ja.K.resolve("PowerPointWebEditor.IFullscreenHelper"),ja.K.resolve("PowerPointWebEditor.ISlideshowFrame"),I,ja.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),ja.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),A.AFrameworkApplication.Me,ja.ka,b,ja.K.resolve("PowerPointWebEditor.IPresentationReader"),
ja.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ja.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ja.K.resolve("PowerPointWebEditor.IErrorHandler"),Tb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ja.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),hs.a.Au(Tb.a.instance.Ha("Common.ISystemInitiatedFeedback")),A.AFrameworkApplication.Pa,Tb.a.instance.Ha("PowerPointLive.ILivePresenter"),ja.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),
ja.K.Ha("PowerPointWebEditor.ISlideShowVoiceNotification")))}Sxk(a){a("optionsButton").catch(b=>ya.a.J(508912669,830,10,"Failed to load the resources for the options menu button feature: {0}",b)).then(()=>this.F7k()).catch(b=>ya.a.J(508912668,830,10,"Failed to load the React options menu button: {0}",b));this.K.register(879,"PowerPointWebEditor.IOptionsButtonLoader").ma().na(()=>new CL)}yhc(a){ya.a.J(594583632,830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+JSON.stringify(a))}hfk(){const a=
this.ka.Ea("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.ka.Ea("SessionStartInfoJson").toString());ya.a.J(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return ya.a.J(512309316,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",
b.Browser,b.BrowserMajorVersion),!1;return!0}gfk(){const a=this.ka.Ea("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.ka.Ea("SessionStartInfoJson").toString());ya.a.J(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return ya.a.J(512309314,
830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}ifk(a){return BL.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").Ue(Object(R.a)(this,this.Pn,"onFullAppSettingsReady"))}Pn(){Cd.a.get_instance().Ij(10,null).continueWith(()=>{if(!this.ka.isCreateNew&&this.ka.Ovh&&this.ka.ukl)try{hs.a.Au(Tb.a.instance.Ha("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen","PresentTeachingUIEnabled")}),
ya.a.J(512495957,830,50,"PPTWebEditorSlideShowPackage::Present Teaching UI triggered")}catch(a){ya.a.J(512495956,830,10,"PPTWebEditorSlideShowPackage::Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}n$k(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}s6k(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}F7k(){this.K.resolve("PowerPointWebEditor.IOptionsButtonLoader")}o$k(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");
return null}dispose(){}static main(){C.a.instance.Ac(new cF)}}Object(m.a)(cF,"PPTWebEditorSlideShowPackage",null,[2,3]);var tS=d(800);class DL{constructor(){this.pjc=null}M_l(a,b){Gj.UISurfaces.BM().then(c=>{this.pjc=a.Fcj(c,a.v5i(b),b,this.pjc)});ya.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}Xyl(a){Gj.UISurfaces.BM().then(b=>{this.pjc=a.Myl(b,this.pjc)});ya.a.J(523871965,843,50,"{0} Toast is removed",this.pjc)}}Object(m.a)(DL,"DeferredNotificationCalloutVisibilityManager",
null,[]);var EL=d(1064);const uS=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=a;a={};a.telemetryGroup=b;return a},vS=(a,b,c,f)=>{const l=new Ij.StandardDialog;l.Fd=0;if(A.AFrameworkApplication.XF){const u=uS(b);l.WJf(ResourceStrings.L_GiveFeedback,void 0,void 0,u)}l.Ky(c,f,0,a?u=>{1===u?(ya.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):ya.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class dF{constructor(a,b,c,f,l,u,I){this.paa={};this.uya=
new Md.a;this.fid=this.ZMe=null;this.Cgd=this.lLe=0;this.ARg=!1;this.Ejd={};if(!I)throw Error.argumentNull("coreEventSource");this.vN=a;this.yr=c;this.vN.Ak(Object(R.a)(this,this.zph,"onShapeNodePropertyChanged"));this.vN.Pka(Object(R.a)(this,this.Brc,"onShapeNodeLoaded"));this.vN.dea(Object(R.a)(this,this.yph,"onShapeNodeConnected"));this.TOg=new DL;this.ih=l;b.MZd(Object(R.a)(this,this.WTe,"onClientError"));b.k_d(Object(R.a)(this,this.HVe,"onServerError"));A.AFrameworkApplication.hOc(Object(R.a)(this,
this.sUe,"onErrorDialogDisplayed"));this.fQg=f;this.eoa=u;this.Ng=I;this.Ng.bC(Object(R.a)(this,this.oph,"onSessionRehydratedHandler"))}dLf(a,b){this.uya.Ib(a)||this.uya.$(a,new Ba.a);const c=this.uya.ga(a);c.add(b);this.uya.$(a,c)}TCh(a,b){if(this.uya.Ib(a)){var c=this.uya.ga(a);c.remove(b);this.uya.$(a,c);this.wne(a)||this.uya.remove(a);hr.a(this.paa).length||ya.a.J(509150993,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else ya.a.J(509150994,
843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",a,b)}wne(a){return this.uya.Ib(a)&&0<this.uya.ga(a).count}cWf(a){if(a.slideId&&a.slideId.sid&&a.M$c){var b=a.M$c;a.K5?(this.ARg||(this.ARg=!0,ya.a.J(509150992,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.eoa)),b in this.paa||(this.paa[b]=new Date),this.dLf(a.slideId.sid.toString(),b)):b in this.paa&&(delete this.paa[b],this.TCh(a.slideId.sid.toString(),
b),ya.a.J(509150991,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}Brc(a,b){(a=Object(gb.a)(4,b.node))?this.cWf(a):ya.a.J(509150990,843,10,"IDeferrable object is null")}yph(a,b){(a=Object(gb.a)(4,b.node))?this.cWf(a):ya.a.J(509150989,843,10,"IDeferrable object is null")}zph(a,b){var c=Object(gb.a)(4,b.node);if(!c)ya.a.J(509150988,843,10,"IDeferrable object is null");else if((b.property===yb.a.K5||this.eoa&&c.M$c in this.paa&&!c.K5)&&c.slideId)if(b=
c.M$c,a=c.slideId.sid.toString(),c.K5)b in this.paa?ya.a.J(509150987,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",b,this.eoa):(ya.a.J(509150986,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.eoa),this.paa[b]=new Date,this.dLf(a,b));else{if(c=this.paa[b])c=(new Date).getTime()-c.getTime(),ya.a.J(509150985,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.eoa),delete this.paa[b],this.TCh(a,b),this.Cgd=c>this.Cgd?c:this.Cgd;
this.fQg&&!this.hasDeferredContent()&&(ya.a.J(509150984,843,50,"All deferred blobs loaded"),this.tta("AllDeferredBlobsLoaded","true"),this.fid&&(ya.a.J(509150983,843,50,"Previously called user requested actions triggered"),this.tta("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.fid(),this.TOg.Xyl(this.ZMe),this.ZMe=this.fid=null))}}oph(){ya.a.J(509150982,843,50,"Session rehydrated with {0} currently deferred blobs",hr.a(this.paa).length)}F$e(a,b,c){this.fQg?(this.ZMe=b,this.fid=c,this.TOg.M_l(b,
this.ih)):(c=Object(gc.a)(EL.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,b=Object(gc.a)(EL.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,vS(null,a.toString(),c,b));ya.a.J(509150979,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}tta(a,b){this.Ejd[a]&&ya.a.J(509150978,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",
a,this.Ejd[a]);this.Ejd[a]=b}WTe(a,b){this.nqa("ClientError",b)}HVe(a,b){this.nqa("ServerError",b)}sUe(a,b){(a=Object(gb.a)(tS.a,b))&&this.nqa("Crash",a.errorCode)}nqa(a,b){this.hasDeferredContent()&&ya.a.J(509150977,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.eoa)}dispose(){this.vN.tn(Object(R.a)(this,this.zph,"onShapeNodePropertyChanged"));this.vN.x2a(Object(R.a)(this,this.Brc,"onShapeNodeLoaded"));this.vN.iia(Object(R.a)(this,
this.yph,"onShapeNodeConnected"));this.Ng.Wba(Object(R.a)(this,this.oph,"onSessionRehydratedHandler"));this.log()}hasDeferredContent(){const a=hr.a(this.paa),b=this.eoa&&0<a.length||0<this.yr.Aab;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.yr.Aab.toString();c.FForceShowDeferralUI=this.eoa.toString();ya.a.J(509150976,843,50,JSON.stringify(c));this.lLe=Math.max(this.yr.Aab,this.lLe)}return b}V0j(a){return rd.a.any(a,b=>b.hasDeferredContent)?(ya.a.J(509150947,843,
50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.eoa),!0):!1}vne(a,b){return rd.a.any(a,c=>c.K5)?(ya.a.J(509150946,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.eoa),!0):!1}log(){const a=hr.a(this.paa),b={};b.MaxDeferredTime=this.Cgd.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.lLe.toString();b.FForceShowDeferralUI=this.eoa.toString();ya.a.J(509150945,843,15,"SessionLogs: {0}, PersistedLogs: {1}",
JSON.stringify(b),JSON.stringify(this.Ejd))}}Object(m.a)(dF,"DeferredContentManager",null,[961]);class eF{constructor(){this.Hx=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}fc(a){this.K=a;this.K.register(dF,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().na(()=>new dF(this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("UseToastForDeferredBlobsEnabled"),
this.K.resolve("Common.IF6Manager"),0<this.K.resolve("Common.IAppSettingsManager").tc("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.Hx=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.Hx&&this.Hx.dispose()}static main(){C.a.instance.Ac(new eF)}}Object(m.a)(eF,"PPTWebEditorPartialDocPackage",null,[2,3]);class Sw{constructor(a,b){this.shapeNode=a;this.position=b}}Object(m.a)(Sw,"MoveShapeData",null,[]);class FL{constructor(a,
b){this.QP=null;this.aq=a;this.ia=b}start(){this.QP=[];for(let a=0;a<this.aq.length;++a)Array.add(this.QP,new pd.a(this.aq[a].x,this.aq[a].y)),this.aq[a].aF(!1)}K3d(a,b){if(1!==a||this.aq.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.Mhk(b[a]))return!1;return!0}Mhk(a){for(let b=0;b<this.aq.length;b++)if(a.eb.equals(this.aq[b].eb))return!0;return!1}perform(a){for(let c=0;c<this.aq.length;c++){var b=new pd.a(this.aq[c].x,this.aq[c].y);b=pd.a.add(b,a);this.aq[c].setPosition(b.x,b.y,!0)}}end(){this.QP&&
ya.a.J(17597603,815,50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.aq.length,this.aq[0].x-this.QP[0].x,this.aq[0].y-this.QP[0].y);const a=[];for(let b=0;b<this.aq.length;++b){const c=this.aq[b].$Zc();Array.add(a,new Sw(this.aq[b].shapeNode,c));this.aq[b].QA(!1)}this.ia.Ia(M.a.mLa,2,a)}}Object(m.a)(FL,"ShapeMoveAction",null,[1589]);class GB{constructor(a,b,c,f){this.hT=a;this.f3=b;this.lzb=void 0===c?null:c;this.Shh=void 0===f?null:f}}Object(m.a)(GB,"ResizeShapeData",
null,[]);class GL{constructor(a,b){this.CIa=this.vGb=this.POe=null;this.fH=a;this.ia=b}start(){this.POe=[];this.vGb=[];this.CIa=[];for(const c of this.fH){c.RM=!0;c.aF(!1);Array.add(this.POe,c.xLa);Array.add(this.vGb,new Mi.a);var a=c.IAb(),b=pd.a.an(a.el(Ge.a.Pv),a.el(Ge.a.IF));a=pd.a.an(a.el(Ge.a.Pv),a.el(Ge.a.hJ));Array.add(this.CIa,a?b/a:1);c.shapeNode.Lf&&c.shapeNode.isEditable&&(b=c,b.Nk&&(b.Nk.visible=!0))}}K3d(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].hm||!b[a].eb.equals(this.fH[a].eb))return!1;
return!0}perform(a,b){for(let f=0;f<this.fH.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.Lhm(c,l,f));let u;(u=this.vGb[f]).right=u.right+c;let I;(I=this.vGb[f]).bottom=I.bottom+l;this.fH[f].setOffsets(Mi.a.add(this.POe[f],this.vGb[f]),!0);this.fH[f].shapeNode.Lf&&this.fH[f].shapeNode.isEditable&&(c=this.fH[f],c.aoe(),c.$3c())}}Lhm(a,b,c){if(!this.fH[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.CIa[c]:b=a/this.CIa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=
0;b<this.fH.length;b++)this.fH[b].hm||(this.fH[b].shapeNode.Lf&&this.fH[b].shapeNode.isEditable||(this.fH[b].RM=!1),this.fH[b].QA(!1),Array.add(a,new GB(this.fH[b].shapeNode,this.vGb[b])));this.ia.Ia(M.a.Qmb,2,a);this.fH=null}}Object(m.a)(GL,"ShapeResizeAction",null,[1589]);class Rp{constructor(a,b){this.shapeNode=a;this.N9d=b%Rp.Rrc}}Rp.Rrc=360;Object(m.a)(Rp,"ShapeRotateData",null,[]);class HL{constructor(a,b){this.KNg=null;this.uBe=0;this.Nd=a;this.ia=b}start(){this.Nd.aF(!1);this.KNg=this.Nd.IAb().ng()}K3d(a,
b){return 3===a&&!this.Nd.hm&&this.Nd.eb.equals(b[0].eb)}perform(a){this.uBe=(this.Nd.rotation+a)%Rp.Rrc;this.Nd.setRotation(this.uBe,this.KNg)}end(){if(!this.Nd.hm){this.Nd.QA(!1);var a=new Rp(this.Nd.shapeNode,this.uBe);this.ia.Ia(M.a.Bwc,2,a)}}}Object(m.a)(HL,"ShapeRotateAction",null,[1589]);class uq{constructor(a){this.YKa=this.aS=null;this.ia=a}ZBc(){this.YKa&&$c.a.Cxb(this.YKa);this.YKa=$c.a.nca(Object(R.a)(this,this.J8f,"endAction"),uq.$Ni)}wbe(a,b){this.aS&&!this.aS.K3d(a,b)&&(this.aS.end(),
this.aS=null);if(!this.aS){this.aS=this.vtj(a,b);if(!this.aS)throw Error.invalidOperation("Could not create keyboard action");this.aS.start()}this.ZBc();return this.aS}J8f(){this.aS&&(this.aS.end(),this.aS=null);this.YKa=null}move(a,b){a=this.wbe(1,a);b=this.F5f(b);a.perform(b)}resize(a,b){a=this.wbe(2,a);b=this.F5f(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.wbe(3,a);c=c?uq.ONi:uq.NNi;a.perform(b?c:-1*c)}F5f(a){let b=0,c=0;a.equals(Ge.a.north)?c=-1*uq.GQc:a.equals(Ge.a.east)?b=uq.GQc:a.equals(Ge.a.south)?
c=uq.GQc:a.equals(Ge.a.west)&&(b=-1*uq.GQc);return new pd.a(b,c)}vtj(a,b){return b?1===a?new FL(b,this.ia):2===a?new GL(b,this.ia):3===a&&(1<b.length&&ya.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new HL(b[0],this.ia):null:null}}uq.$Ni=1E3;uq.GQc=1;uq.NNi=15;uq.ONi=1;Object(m.a)(uq,"ShapeKeyboardDragManager",null,[1549]);var jh=d(154),Kt=d(522);const Xn=a=>{a&&$c.a.Kb&&($c.a.Kb.Nrg=
a.Lf,$c.a.Kb.vVh=a.Rg)};var nr=d(223),IL=d(506),kz=d(333);class fF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd){if(!tc)throw Error.argumentNull("ISessionInfoOwner is null");if(!lc)throw Error.argumentNull("IPPTUnitConversion is null");if(!Ec)throw Error.argumentNull("IZoomContext is null");Xb||ya.a.J(509650844,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.uf=b;this.Uq=c;this.Fa=f;this.gb=l;this.Jjd=u;this.Eb=I;this.yb=T;this.Ga=ja;this.ue=
ua;this.tq=Bb;this.kB=Ra;this.kjd=eb;this.Ba=Ub;this.Ilc=new bd.ScriptSharpLegacyMap;this.F0a=Xb;this.Xa=tc;this.Ji=lc;this.Mj=Ec;this.kj=hd;this.pxa=yd}qb(){this.ia.pa(M.a.I$a,wc.a.application,Object(R.a)(this,this.rVj,"handleDeleteSelectedShapes"),4);this.ia.pa(M.a.H7b,wc.a.application,Object(R.a)(this,this.sVj,"handleDeleteShapes"),4);this.ia.pa(M.a.IOh,wc.a.application,this.NUj.bind(this),4);this.ia.pa(M.a.mLa,wc.a.application,Object(R.a)(this,this.yXj,"handleMoveShapes"),4);this.ia.pa(M.a.Qmb,
wc.a.application,Object(R.a)(this,this.JZj,"handleResizeShapes"),4);this.ia.pa(M.a.Bwc,wc.a.application,Object(R.a)(this,this.bne,"handleRotateShape"),4);this.ia.pa(M.a.MHh,wc.a.application,Object(R.a)(this,this.cne,"handleRotateShapes"),4);this.ia.pa(M.a.KHh,wc.a.application,Object(R.a)(this,this.qtg,"handleRotateShapeAnchor"),4);this.ia.pa(M.a.LHh,wc.a.application,Object(R.a)(this,this.qtg,"handleRotateShapeAnchor"),4);this.ia.pa(M.a.cca,wc.a.application,Object(R.a)(this,this.rtg,"handleRotateShapeByDirection"),
4);this.ia.pa(M.a.z5e,wc.a.application,Object(R.a)(this,this.rtg,"handleRotateShapeByDirection"),4);md.a("FlipInMultiSelectEnabledV2")?(this.ia.pa(M.a.Dwc,wc.a.application,Object(R.a)(this,this.tsg,"handleFlipShape"),4),this.ia.pa(M.a.Cwc,wc.a.application,Object(R.a)(this,this.tsg,"handleFlipShape"),4)):(this.ia.pa(M.a.Dwc,wc.a.application,Object(R.a)(this,this.usg,"handleFlipShapeForSingleSelection"),4),this.ia.pa(M.a.Cwc,wc.a.application,Object(R.a)(this,this.usg,"handleFlipShapeForSingleSelection"),
4));this.ia.pa(M.a.U$a,wc.a.application,Object(R.a)(this,this.ZUj,"handleCommitKeyboardShapeManipulation"),4);this.ia.pa(M.a.aqc,ta.a.view,Object(R.a)(this,this.k3c,"handleMoveShapesKeyboard"),4);this.ia.pa(M.a.bqc,ta.a.view,Object(R.a)(this,this.k3c,"handleMoveShapesKeyboard"),4);this.ia.pa(M.a.cqc,ta.a.view,Object(R.a)(this,this.k3c,"handleMoveShapesKeyboard"),4);this.ia.pa(M.a.dqc,ta.a.view,Object(R.a)(this,this.k3c,"handleMoveShapesKeyboard"),4);this.ia.pa(M.a.lwc,ta.a.view,Object(R.a)(this,this.q3c,
"handleResizeShapesKeyboard"),4);this.ia.pa(M.a.mwc,ta.a.view,Object(R.a)(this,this.q3c,"handleResizeShapesKeyboard"),4);this.ia.pa(M.a.nwc,ta.a.view,Object(R.a)(this,this.q3c,"handleResizeShapesKeyboard"),4);this.ia.pa(M.a.owc,ta.a.view,Object(R.a)(this,this.q3c,"handleResizeShapesKeyboard"),4);this.ia.pa(M.a.x5e,ta.a.view,Object(R.a)(this,this.r3c,"handleRotateShapeKeyboard"),4);this.ia.pa(M.a.Fwd,ta.a.view,Object(R.a)(this,this.r3c,"handleRotateShapeKeyboard"),4);this.ia.pa(M.a.Ewd,ta.a.view,Object(R.a)(this,
this.r3c,"handleRotateShapeKeyboard"),4);this.ia.pa(M.a.Ewc,ta.a.view,Object(R.a)(this,this.r3c,"handleRotateShapeKeyboard"),4);this.ia.pa(M.a.k0e,wc.a.application,Object(R.a)(this,this.Pme,"handleIsDirectManipulationEnabled"),97);this.ia.pa(M.a.kZe,wc.a.application,Object(R.a)(this,this.dtg,"handlePreviewRotate"),4);this.ia.pa(M.a.lZe,wc.a.application,Object(R.a)(this,this.dtg,"handlePreviewRotate"),4);this.ia.pa(M.a.n5e,wc.a.application,Object(R.a)(this,this.MZj,"handleRevertPreviewRotate"),4)}Sd(){const a=
this.Fa.Kc(xc.a.Ag);a.bindAction(B.KeyInputManager.Va(H.a.o8,4),M.a.lwc);a.bindAction(B.KeyInputManager.Va(H.a.Rca,4),M.a.mwc);a.bindAction(B.KeyInputManager.Va(H.a.eja,4),M.a.nwc);a.bindAction(B.KeyInputManager.Va(H.a.J3,4),M.a.owc);a.bindAction(B.KeyInputManager.Va(H.a.Rca,5),M.a.Ewd);a.bindAction(B.KeyInputManager.Va(H.a.eja,5),M.a.Ewc);a.bindAction(B.KeyInputManager.Va(H.a.Rca,1),M.a.x5e);a.bindAction(B.KeyInputManager.Va(H.a.eja,1),M.a.Fwd);a.bindAction(B.KeyInputManager.Va(H.a.Qca,0),M.a.I$a);
a.bindAction(B.KeyInputManager.Va(H.a.eG,0),M.a.I$a);this.Fa.Kc(xc.a.Nj).bindAction(B.KeyInputManager.Va(H.a.Rca,1),N.a.Ce)}yXj(a,b,c,f,l){if(!l||!Object(gc.a)(Array,l)||1>l.length)return 8;for(const I of l)if(b=I.shapeNode,this.Xla(b),b.get_smartArtModelId()&&(b=this.Ga.Hs(b)),!this.KUf(b)||this.uf.Xc(I.shapeNode))return 16;if(1===c)return 32;if($c.a.Kb){$c.a.Kb.tk=!0;for(var u of l)if((c=u.shapeNode)&&(c.Lf||c.Rg)){Xn(c);break}}u=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{u.mc(l[0].shapeNode);
u.Wc=a;const I=this.yb.Xd;for(const T of l){const ja=new pd.a(I.Cf(T.position.x,0),I.Cf(T.position.y,1));rq.c(T.shapeNode.get_smartArtModelId()?this.Ga.Hs(T.shapeNode):T.shapeNode,ja.x,ja.y)}}finally{u&&u.dispose()}return 32}JZj(a,b,c,f,l){var u,I;if(!l||!Object(gc.a)(Array,l))return 8;ya.a.J(508601745,815,50,`ResizeShapes - Shape resized with LockAspectRatio : ${null===(I=null===(u=null===l||void 0===l?void 0:l[0])||void 0===u?void 0:u.hT)||void 0===I?void 0:I.Cha}`);if(1>l.length)return 8;for(b=
0;b<l.length;b++){if(!this.R4b(l[b].hT))return ya.a.J(509650842,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].hT.get_shapeId()),16;if(this.uf.Xc(l[b].hT))return 16}if(1===c)return 32;if($c.a.Kb){$c.a.Kb.tk=!0;for(var T of l)if((c=T.hT)&&(c.Lf||c.Rg)){Xn(c);break}}T=this.Eb.ud(15,void 0,()=>{this.gb.uj();const ja=this.Fa.Je;!ja||ja.name!==xc.a.Ag&&ja.name!==xc.a.xA||this.Fa.Gd()});try{for(T.mc(l[0].hT),T.Wc=a,a=0;a<l.length;a++)l[a].hT.QOh=
l[a].f3}finally{T&&T.dispose()}if(this.gb.UM()&&(a=this.gb.KGa(),(a=this.ik(a))&&Object(gc.a)(Kt.a,a.Nk)&&Object(gb.a)(Kt.a,a.Nk).clearChildSelection(),this.F0a&&this.Ba.r3l))for(const ja of l)this.bNl(ja);if(!this.Ba.eGa)return 32;l=l.filter(ja=>ja.hT.$j&&0!=ja.hT.get_shapeRotation()&&!ja.lzb.MDb());l.length&&ya.a.J(508393346,822,50,`ShapeManipulationActor::ResizeShapes - Number of Gc2 Rendered images having rotation and resized from center point of an edge : ${l.length} `);return 32}bNl(a){const b=
a.hT;if(b&&b.ig&&!b.Rg){var c=$c.a.Kb?$c.a.Kb.actionId:kh.a.create().toString(),f=A.AFrameworkApplication.userSessionId,l=this.Xa.podSessionId,u=this.k3l,I=this.dBd,T=I/u,ja=Ad.a.WZ(this.Ji.dJ(a.f3.left,T),0),ua=Ad.a.WZ(this.Ji.dJ(a.f3.top,T),1),Ra=Ad.a.WZ(this.Ji.dJ(a.f3.right,T),0);a=Ad.a.WZ(this.Ji.dJ(a.f3.bottom,T),1);T=Math.abs(b.get_widthPersisted()+Ra-ja);var eb=Math.abs(b.get_heightPersisted()+a-ua);Ra=Zm.o(b.slideCid,b.slideSid);a=Zm.b(b.get_shapeId(),null);var Bb=Zm.f(Ra,a);ja=Zm.m((b.get_xPersisted()+
ja).toString(),(b.get_yPersisted()+ua).toString());ja=Zm.n(T,eb,ja);ja=Zm.c(Bb,ja);ua=null;this.kj&&this.kj.highContrastColors&&(ua=Zm.k(Zm.j(this.kj.highContrastColors.foregroundTextColor),Zm.j(this.kj.highContrastColors.backgroundColor),Zm.j(this.kj.highContrastColors.linkColor)));f=Zm.d(Ra,a,1,b.mg,0,0,c,f,this.kj.isInHighContrastMode,ua,this.Ba.EKh&&this.pxa?this.pxa.MDj():null);l=Zm.e(f,[],l);l.editOps.push(ja);l=Zm.q(null,l,null,null,this.Xa.$k);f=$c.a.A_();$c.a.Kb&&f&&($c.a.Kb.Wa("editOpCorrelationId",
c),$c.a.Kb.Wa("editOpRequestStartTick",f.toString()));this.F0a.Py(l);ya.a.J(509650841,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",c,b.slideSid,b.slideCid,b.get_shapeId(),u,I,this.Ba.EKh)}}get k3l(){let a=this.Mj.PH;this.Uq&&this.Uq.Aa&&this.Uq.Aa.ey&&null!=this.Uq.Aa.ey.gt&&(a=this.Uq.Aa.ey.gt);a||(ya.a.J(509650840,815,
15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get dBd(){let a=1;if(this.Uq&&this.Uq.Aa){const b=Object(gb.a)(227,this.Uq.Aa.vg(this.yb.Na));b?a=b.cV:ya.a.J(509650839,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else ya.a.J(509650838,815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(ya.a.J(509650837,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}rtg(a,
b,c,f,l){return 1===c?32:jh.a("Rotate",a,()=>{ya.a.J(509650836,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const u=this.gb.rf();if(!u)return ya.a.J(509650835,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.kjd&&1===u.length&&this.Xla(u[0]);switch(a){case M.a.cca:ya.a.J(509650834,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");if(md.a("FixUndoRotateMultipleShapes")){var I={};I.selectedNodes=
u;I.rotateLeft=!0;this.cne(a,b,c,f,I)}else for(I of u)l=new Rp(I,Math.round(I.get_shapeRotation()+270)),this.bne(a,b,c,f,l);break;case M.a.z5e:ya.a.J(509650833,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");if(md.a("FixUndoRotateMultipleShapes"))I={},I.selectedNodes=u,I.rotateRight=!0,this.cne(a,b,c,f,I);else for(const T of u)l=new Rp(T,Math.round(T.get_shapeRotation()+90)),this.bne(a,b,c,f,l);break;default:return 8}return 32})}cne(a,b,c,f,l){if(!l)return 8;b=l.selectedNodes;
f=l.rotateData?l.rotateData:[];for(const u of b){const I=this.exb(u);if(1===c)return I?32:8;if(!I||this.uf.Xc(u))return 16}if(l.rotateLeft||l.rotateRight)for(const u of b)$c.a.Kb&&($c.a.Kb.tk=!0,u&&(u.Lf||u.Rg)&&Xn(u)),c=new Rp(u,Math.round(u.get_shapeRotation()+(l.rotateLeft?270:90))),f.push(c);l=this.Eb.ud(15,void 0,()=>{this.gb.uj();const u=this.Fa.Je;!u||u.name!==xc.a.Ag&&u.name!==xc.a.xA||this.Fa.Gd()});try{for(l.mc(b[0]),l.Wc=a,a=0;a<b.length;a++)b[a].set_shapeRotation(f[a].N9d)}finally{l&&
l.dispose()}return 32}bne(a,b,c,f,l){if(!l||!Object(gc.a)(Rp,l))return 8;b=l.shapeNode;f=this.exb(b);if(1===c)return f?32:8;if(!f||this.uf.Xc(b))return 16;$c.a.Kb&&($c.a.Kb.tk=!0,b&&(b.Lf||b.Rg)&&Xn(b));c=this.Eb.ud(15,void 0,()=>{this.gb.uj();const u=this.Fa.Je;!u||u.name!==xc.a.Ag&&u.name!==xc.a.xA||this.Fa.Gd()});try{c.mc(b),c.Wc=a,b.set_shapeRotation(l.N9d)}finally{c&&c.dispose()}return 32}qtg(){const a=this.gb.rf();return 0<a.length&&this.opk(a)?32:8}dtg(a,b,c){return this.Ba.ztc?1===c?32:jh.a("HandlePreviewRotate:",
a,()=>{var f=this.gb.rf();for(const l of f){if(!l){ya.a.J(509650831,822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.vd)continue;this.Ilc.Ib(l.get_shapeId())?this.Ilc.$(l.get_shapeId(),l.get_shapeRotation()):this.Ilc.add(l.get_shapeId(),l.get_shapeRotation());f=this.ik(l);if(!f){ya.a.J(509650830,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const u=f.IAb().ng();switch(a){case M.a.kZe:f.setRotation((l.get_shapeRotation()+
270)%Rp.Rrc,u);break;case M.a.lZe:f.setRotation((l.get_shapeRotation()+90)%Rp.Rrc,u)}}return 32}):2}MZj(a,b,c){if(!this.Ba.ztc)return 2;if(1===c)return 32;a=this.gb.rf();for(const f of a)if(!f)ya.a.J(509650829,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());else if(!f.vd)if(a=this.ik(f))if(b=a.IAb().ng(),this.Ilc.Ib(f.get_shapeId()))a.setRotation(this.Ilc.ga(f.get_shapeId()),b);else return ya.a.J(509650827,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",
f.get_shapeId()),8;else ya.a.J(509650828,822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}rVj(a,b,c,f,l){b=this.gb.rf();if(md.a("DeleteDuplicateShapeNodeFix")){if(this.uf.xC(b))return 8;b=b.filter(u=>!(null===u||void 0===u||!u.isConnected))}if(1===b.length&&this.gb.kz())return 16;f=1===b.length&&!!b[0]&&b[0].leb();f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if($c.a.Kb){$c.a.Kb.actionName="ClearPlaceholders";$c.a.Kb.tk=!0;for(const u of b)if(u.Lf||
u.Rg){Xn(u);break}}if(this.gb.UM()&&md.a("EnableSmartArtSubShapeDeletion")&&this.Kme(b[0],a,l))return 32;c=null;if(l=this.Ga.PVa(b))md.a("SmartArtSubNodeEditing")?c=this.Ga.Hs(l):(this.gb.Ivd(l),b=this.gb.rf());return this.H7b(a,b,this.gb.Pk(),c)?32:16}sVj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.Uq.presentation;if(!b)throw Error.argumentNull("Presentation is null");l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;$c.a.Kb&&($c.a.Kb.actionName="DeleteShapes",
$c.a.Kb.tk=!0);return l.length&&this.H7b(a,l,Object(gb.a)(205,b.LD(l[0].slideId)))?32:16}NUj(a,b,c,f,l){const u=this.gb.Hd().filter(I=>!!I);if(null===u||void 0===u||!u.length)return ya.a.J(508367197,815,10,"ShapeManipulationActor::HandleChangeShapes, selected nodes: null"),16;if(1===c)return 32;for(const I of u)if(I.Lf||I.Rg){Xn(I);break}return jh.a("ShapeChangeLayout",a,()=>{ya.a.J(508367196,815,50,"ShapeManipulationActor::HandleChangeShapes Change Shape operation started");for(var I of u)if(this.uf.Xc(I))return ya.a.J(508356677,
815,10,"ShapeManipulationActor::HandleChangeShapes, Graph node and parents blocked"),16;I=l?l.SourceControlId:"";if(-1===this.$Vl(I.toString()))return ya.a.J(508367195,815,10,"ShapeManipulationActor::HandleChangeShapes Change Shape operation operation called with unknown shapeName"),16;ya.a.J(508367194,815,50,"ShapeManipulationActor::HandleChangeShapes Change Shape operation called with shapeName: '{0}'",I);I=window.performance.now();var T=this.Eb.ud(15,void 0,()=>{for(const ua of u)this.Xla(ua)});
try{T.mc(u[0]),T.Wc=a}finally{T&&T.dispose()}T=$c.a.Kb;const ja=window.performance.now();T&&(T.Wa("ShapeManipulationActor::HandleChangeShapes",(ja-I).toString()),$c.a.Y2(T));ya.a.J(508367193,815,50,"ShapeManipulationActor::HandleChangeShapes Change Shape operation completed");return 32})}H7b(a,b,c,f){f=void 0===f?null:f;if(!c||!b.length||this.uf.xC(b))return!1;let l=!1;for(var u of b)if(u.xHa){l=!0;break}u=this.Eb.ud(15,void 0,()=>{this.gb.Bh()});try{f?u.rd(f):u.rd(c);u.Wc=a;u.ny[nr.a.pCb]=l;for(const I of b){if(I&&
I.Rg){const T=this.Ga.zt(I);if(T){const ja=ek.c(T,this.yb.Na);ja&&(ja.Nk.visible=!1)}}this.Ba.tlk&&ya.a.J(508376353,822,50,"ShapeManipulationActor::deleteShapes : Deleting shapeNode shapeId:{0}",I.ln)}f?f.xDh(b):c.XS(b)}finally{u&&u.dispose()}for(const I of b)this.tq.Ozh(new IL.a(I));return!0}usg(a,b,c){b=this.gb.rf();const f=0<b.length?b[0]:null,l=1===b.length&&this.L3d(f);if(1===c)return l?32:8;if(!l||this.uf.Xc(f))return 16;this.Xla(f);for(const u of b)if(u.Lf||u.Rg){Xn(u);break}return jh.a("Rotate",
a,()=>{let u,I;switch(a){case M.a.Cwc:I=f.get_isVerticallyFlipped();u=!f.get_isHorizontallyFlipped();break;case M.a.Dwc:I=!f.get_isVerticallyFlipped();u=f.get_isHorizontallyFlipped();break;default:return 8}const T=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{T.mc(f),T.Wc=a,f.set_isVerticallyFlipped(I),f.set_isHorizontallyFlipped(u)}finally{T&&T.dispose()}return 32})}tsg(a,b,c){const f=this.gb.rf();b=!0;if(!f||f&&!f.length)b=!1;for(const I of f)if(b=this.L3d(I),!b)break;if(1===c)return b?
32:8;if(!b)return ya.a.J(509650822,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const I of f){if(this.uf.Xc(I))return 16;this.Xla(I)}for(const I of f)if(I.Lf||I.Rg){Xn(I);break}const l=a===M.a.Cwc,u=a===M.a.Dwc;return l||u?jh.a("Rotate",a,()=>{const I=Array(f.length),T=Array(f.length);for(var ja=0;ja<f.length;ja++)T[ja]=!!(u^f[ja].get_isVerticallyFlipped()),I[ja]=!!(l^f[ja].get_isHorizontallyFlipped());ja=this.Eb.ud(15,void 0,
()=>{this.gb.uj();this.Fa.Gd()});try{ja.mc(f[0]);ja.Wc=a;for(let ua=0;ua<f.length;ua++)f[ua].set_isVerticallyFlipped(T[ua]),f[ua].set_isHorizontallyFlipped(I[ua])}finally{ja&&ja.dispose()}return 32}):(ya.a.J(509650821,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}ZUj(){this.Jjd.J8f();return 32}k3c(a,b,c){const f=ek.b(b);if(!f)return 16;b=this.gb.rf();if(!b.length)return 16;let l=!0;const u=[];for(const I of b)if(I.get_smartArtModelId()){u.push(this.Ga.Hs(I));break}else u.push(I);
for(const I of u)if(!this.KUf(I)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=ek.d(u,f.Na);if(this.uf.xC(b))return 16;switch(a){case M.a.aqc:a=Ge.a.south;break;case M.a.bqc:a=Ge.a.west;break;case M.a.cqc:a=Ge.a.east;break;case M.a.dqc:a=Ge.a.north;break;default:return 8}this.Jjd.move(c,a);this.kB&&this.gb.UM()&&(a=this.gb.KGa(),this.ue.gmb(new kz.a(a)));$c.a.Kb&&($c.a.Kb.tk=!0,$c.a.Kb.xG=new Date);return 32}q3c(a,b,c){const f=ek.b(b);b=this.gb.rf();const l=[];for(var u of b){if(u.get_smartArtModelId()){this.gb.Ivd(u);
Array.add(l,this.Ga.Hs(u));break}!u.isResizable||u.kK||u.vd||Array.add(l,u)}u=ek.d(l,f.Na);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.uf.xC(l))return 16;switch(a){case M.a.lwc:a=Ge.a.south;break;case M.a.mwc:a=Ge.a.west;break;case M.a.nwc:a=Ge.a.east;break;case M.a.owc:a=Ge.a.north;break;default:return 8}this.Jjd.resize(u,a);this.kB&&this.gb.UM()&&(a=this.gb.KGa(),this.ue.gmb(new kz.a(a)));$c.a.Kb&&($c.a.Kb.tk=!0,$c.a.Kb.xG=new Date);return 32}r3c(a,b,c){var f=this.gb.rf();const l=0<f.length?
f[0]:null,u=1===f.length&&this.exb(l);if(1===c)return u?32:8;if(!u||this.uf.Xc(l))return 16;b=ek.b(b);f=ek.d(f,b.Na);c=a===M.a.Fwd||a===M.a.Ewc;a=a===M.a.Ewd||a===M.a.Ewc;0<f.length&&f[0].shapeNode.Lf&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.vg(b.Na))&&b.$3c();this.Jjd.rotate(f,c,a);$c.a.Kb&&($c.a.Kb.tk=!0,$c.a.Kb.xG=new Date);return 32}Pme(a,b,c,f,l){return l&&Object(gc.a)(9,l)?this.uf.Xc(l)?16:32:8}opk(a){for(const b of a)if(!this.exb(b)&&!this.L3d(b))return!1;return!0}$Vl(a){a=a.split("_");
return 3===a.length?Number.parseInvariant(a[2]):-1}KUf(a){return!!a&&a.mK&&a.yC&&!a.kK}R4b(a){return!!a&&a.isResizable&&a.yC&&!a.kK}exb(a){return!!a&&a.SM&&!a.kK}L3d(a){return!!a&&a.Iik&&!a.kK}ik(a){return a?Object(gb.a)(178,a.sc(this.yb.Na)):null}Xla(a){a&&a.Iv&&(a=this.ik(a))&&a.qW(!1)}Kme(a,b,c){return(a=this.ik(a))&&Object(gc.a)(Kt.a,a.Nk)&&(a=Object(gb.a)(Kt.a,a.Nk))?a.Hsc(M.a.Fv(b),c):!1}}Object(m.a)(fF,"ShapeManipulationActor",null,[]);var Tw=d(431),sj=d(70);class gF extends Tw.DragSelectionDragAdapter{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){super(a,b,c);this.oa=f;this.Fa=l;this.ka=T;this.Ga=u;this.LUk=I;this.iE=ja;this.Ub=ua;this.Pq=Ra;this.bha=eb;this.Cc=Bb;this.RDc=this.SDc=null}get RQc(){return this.SDc}get QQc(){return this.RDc}Qv(a){for(var b=this.$ff(),c=a.Ec,f=c,l=this.iE.aK(f);!l&&f;){l=this.iE.aK(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||ya.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+
c.className+" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.eb;c=this.Ub.Pc(l);if(b===l||c.wf()&&c.j5a()===b){l=super.Qv(a);if(!l)return l;this.Ga.N5(b)&&(c=this.Cc.XO(Object(gb.a)(4,b)))&&c.rq()&&(c=this.bha.Ode(a.clientPoint,c,null,null))&&(f=c.sc(this.Yf.Na),this.Yf.i8(a.clientPoint,f,c,this.Yf,a.shiftKey));null!==this.Pq&&(a=this.Ga.vd(b),this.Pq.tAa(sj.a.zca),a&&(this.SDc=this.bha.Iie(b),this.RDc=this.bha.jlg(b)));return l}return!1}rv(a){super.rv(a);this.x9f();null!==this.Pq&&this.Pq.Uza();
this.RQc&&(this.SDc=null);this.QQc&&(this.RDc=null)}Uo(a){super.Uo(a);this.x9f();null!==this.Pq&&this.Pq.Uza();this.RQc&&(this.SDc=null);this.QQc&&(this.RDc=null)}NLb(a,b,c){({ft:b,graphNode:c}=super.NLb(a,b,c));if(this.ka.nFg&&(a=this.$ff())){const f=this.pxj(c);f&&f===a||(c=a,b=c.sc(this.Yf.Na))}return{ft:b,graphNode:c}}wBc(a){let b=super.wBc(a);if(!b&&this.ka.nFg){let c=this.$ff();if(c&&this.Ga.vd(c.node)){const f=this.oa.$n();this.bha.s6c(a.clientPoint,f)&&(c=this.bha.Ode(a.clientPoint,f,this.RQc,
this.QQc))}c&&(b=c.sc(this.Yf.Na))}return b}pxj(a){return a?this.Ga.Gn(a):null}$ff(){const a=this.LUk.bog(this.Yf.Na);return!a||a.rI?null:this.oa.Zn()}x9f(){(this.oa.nI()||this.oa.Js())&&this.Fa.Gd()}}Object(m.a)(gF,"PPTDragSelectionDragAdapter",Tw.DragSelectionDragAdapter,[1546,363]);class JL{constructor(a,b,c){this.gf=a;this.raa=b;this.Cc=c}s6c(a,b){if(!a||!b)return!1;b=b.sc(this.gf);return b?(b=Sd.a.wi(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}Ode(a,
b,c,f){return(a=this.lcg(a,b,void 0===c?null:c,void 0===f?null:f))?a.$z():null}lcg(a,b,c,f){c=void 0===c?null:c;f=void 0===f?null:f;if(!a||!b)return null;c&&f||(f=this.jlg(b),c=this.Iie(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.sc(this.gf);if(!l)return null;var u=Sd.a.wi(l.htmlElement);if(!u)return null;l=a.x-u.x;u=a.y-u.y;var I=0;for(a=0;a<c.length&&!(I+=c[a],I>=u);a++);for(I=u=0;I<f.length&&!(u+=f[I],u>=l);I++);a=Math.min(a,c.length-1);I=Math.min(I,f.length-1);return 0>a||a>=c.length||
0>I||I>=f.length?null:b.tf(a,I)}Iie(a){if(a){a=this.Cc.Gma(a);if(!a||!a.length)return null;const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].sc(this.gf);if(!b)return null;b=Sd.a.wi(b.htmlElement);f[l]=b.height}return f}return null}jlg(a){if(a){a=vo.b(Object(gb.a)(Zg.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.raa.Ve(a[f],0);return c}return null}}Object(m.a)(JL,"PptTableDragSelectionHelper",null,[925]);var Js=d(662),HB=d(347);class KL{constructor(a,
b,c,f,l,u,I){this.ta=this.In=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!u)throw Error.argumentNull("insertShapeOverlayViewElement");if(!I)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Jc=b;this.Ji=c;this.yb=f;this.TZa=l;this.Mga=u;this.sa=I}Ew(a){try{return a?a.xB===Sys.UI.MouseButton.rightButton?!1:
2===this.TZa.vyg?!0:!1:(ya.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),!1)}catch(b){throw ya.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}Qv(a){try{if(!a)return ya.a.J(512336008,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Ew(a))return!1;this.Mga.Dm(sj.a.ESb);this.In=Js.a(a.clientPoint,this.Jc.Ic);const b=new Mi.a;b.left=this.In.x;b.top=this.In.y;b.bottom=this.In.y+5;b.right=this.In.x+5;a={};a.offsets=b;
a.insertShapeActionId=this.Mga.iDb;a.insertLocalShape=!0;if(32!=this.ia.Ia(M.a.q5c,2,a))return!1;this.ta=a.node;return!0}catch(b){throw ya.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}Px(a){try{if(!a)return ya.a.J(512336006,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.yb.isActive)return!1;const b=Js.a(a.clientPoint,this.Jc.Ic),c=Js.b(this.jDd(Math.min(this.In.y,b.y)-this.In.y),this.jDd(Math.max(this.In.y,b.y)-this.In.y-5),this.jDd(Math.min(this.In.x,
b.x)-this.In.x),this.jDd(Math.max(this.In.x,b.x)-this.In.x-5));Object(gb.a)(HB.a,this.ta.sc(0)).setOffsets(c,!0);return!0}catch(b){throw ya.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}Uo(a){try{if(a)if(this.In){var b=Js.a(a.clientPoint,this.Jc.Ic),c=Js.b(Math.min(this.In.y,b.y),Math.max(this.In.y,b.y),Math.min(this.In.x,b.x),Math.max(this.In.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.Mga.iDb;a.insertLocalShape=!1;this.r4f();this.ia.Ia(M.a.q5c,2,a);this.jM()}else ya.a.J(512336003,
822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else ya.a.J(512336004,822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw ya.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",f),f;}}rv(){this.jM()}dispose(){this.jM()}jDd(a){return this.Ji.wQ(a,this.Jc.Ic.cV)}jM(){this.In=null;this.ta&&(this.r4f(),this.TZa.Vef(0),this.ta=null)}r4f(){this.sa.Aa.XS([this.ta])}}Object(m.a)(KL,"ShapeDrawDragAdapter",null,[363,106]);class lz{constructor(a,
b){this.vQg=null;this.UGb=-1;this.oMe=a;this.vIk=b}Qv(a){return this.vmh(a)?(this.oMe.vrd(),!0):!1}Px(a){if(!a)return!1;this.vIk?(this.vQg=a,this.DKl()):this.mUe(a);return!0}Uo(a){this.YZh()&&this.k7f(0);this.smh(a);this.oMe.uwc()}rv(){this.YZh();this.qmh();this.oMe.uwc()}DKl(){-1===this.UGb&&(this.UGb=window.requestAnimationFrame(Object(R.a)(this,this.k7f,"dragMoveTask")))}YZh(){return-1!==this.UGb?(window.cancelAnimationFrame(this.UGb),this.UGb=-1,!0):!1}k7f(){this.mUe(this.vQg);this.UGb=-1}}Object(m.a)(lz,
"ShapeDragAdapter",null,[363]);class IB extends Sys.EventArgs{constructor(a){super();this.Eaf=!1;this.Eaf=a}}Object(m.a)(IB,"RewriteViewElementsStateEventArgs",Sys.EventArgs,[]);class LL extends lz{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd){super(Ub,tc);this.ujc=0;this.rjc=this.aq=this.QP=this.rQg=null;this.FJa=!1;if(!hd)throw Error.argumentNull("viewEventSourceNotifier");this.yb=a;this.ia=b;this.P1=c;this.Gr=f;this.Pt=l;this.dE=u;this.gb=I;this.YG=T;this.iE=ja;this.Ga=ua;this.Cc=
Ra;this.ue=eb;this.toc=Bb;this.Pq=Xb;this.kB=lc;this.wq=Ec;this.yld=hd;this.wfd=yd}Ew(a){return this.lK(a).returnValue}lK(a){let b;var c=[];b=!1;if(!a||a.xB!==Sys.UI.MouseButton.leftButton||this.dE.t1)return{returnValue:!1,Wpc:c,Ngc:b};const f=Object(gb.a)(697,this.iE.aK(a.Ec));if(!f||!f.fve(a.Ec))return{returnValue:!1,Wpc:c,Ngc:b};if((b=f.isSelected)||f.shapeNode.Rg){c=[];a=Object(gb.a)(178,this.iE.aK(a.Ec));a.shapeNode.Lf&&this.gb.D4f(a.shapeNode);a=this.gb.rf();for(const l of a)if(l.get_smartArtModelId()){c.push(this.Ga.Hs(l));
break}else c.push(l);c=ek.d(c,this.yb.Na);for(const l of c)if(!this.zBg(l))return{returnValue:!1,Wpc:c,Ngc:b}}else{if(!this.zBg(f))return{returnValue:!1,Wpc:c,Ngc:b};Array.add(c,f)}return{returnValue:!0,Wpc:c,Ngc:b}}zBg(a){return a&&a.eb&&a.eb.mK&&a.eb.yC&&!a.shapeNode.kK&&32===this.ia.Ia(M.a.k0e,1,a.eb)?!0:!1}vmh(a){let b,c;if(!(()=>{let l=this.lK(a);({Wpc:b,Ngc:c}=l);return l})().returnValue)return!1;this.ia.nb(M.a.U$a,2);this.rQg=pd.a.tVa(a.clientPoint);this.rjc=Object(gb.a)(697,this.iE.aK(a.Ec));
null!==this.P1&&this.P1.Dm(3);if(!this.rjc||!b||!b.length)return!1;this.wfd&&this.yld.v1e(new IB(!1));null!==this.Pq&&this.Pq.tAa(sj.a.SAa);this.rjc.shapeNode.Iv||(this.gb.uj(),this.YG.Gd());for(var f=0;f<b.length;++f)this.LNc(b[f]);c||(this.gb.setSelection($d.SelectionFactory.Nl(this.aq[0].eb)),this.Pt.Bx());for(f=0;f<this.aq.length;++f)this.aq[f].aF(!0);this.FJa=1<this.aq.length?!1:!0;this.ujc=Date.now();this.kB&&this.gb.UM()&&this.ue.r1e();this.wq&&this.ia.nb(G.a.kma,2);return!0}LNc(a){this.aq||
(this.aq=[]);this.QP||(this.QP=[]);Array.add(this.aq,a);Array.add(this.QP,new pd.a(a.x,a.y))}mUe(a){if(a){var b=this.U0c(pd.a.tVa(a.clientPoint),this.rQg);a=null;var c=this.FJa&&!this.rjc.shapeNode.Iv;for(let f=0;f<this.aq.length;++f)a=pd.a.add(this.QP[f],b),this.aq[f].setPosition(a.x,a.y,!c);b=this.toc.tph(!1,this.FJa,this.aq[0],null);c&&!b&&a&&this.aq[0].setPosition(a.x,a.y,!0)}}U0c(a,b){a=pd.a.nT(a,b);return new pd.a(this.Gr.Tm(a.x),this.Gr.Tm(a.y))}smh(a){const b=[];for(var c=0;c<this.aq.length;++c){var f=
this.aq[c].$Zc();Array.add(b,new Sw(this.aq[c].shapeNode,f));this.aq[c].QA(!1);if(f=this.Cc.XO(this.aq[c].shapeNode))f=f.rq(),ya.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.rjc.shapeNode.Iv||(c={},a&&a.hc&&a.hc.rawEvent&&(c[Ii.a.MFa]=a.hc.rawEvent.timeStamp),this.ia.Ia(M.a.mLa,2,b,c));1===b.length&&(ya.a.J(512497683,815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.aq[0].shapeNode?this.aq[0].shapeNode.ln:"",(Date.now()-this.ujc).toString()),this.kB&&
this.gb.UM()&&(a=this.gb.KGa(),this.ue.gmb(new kz.a(a))));this.wfd&&this.yld.v1e(new IB(!0));this.Z4()}qmh(){if(this.aq){for(let a=0;a<this.aq.length;++a)this.aq[a].setPosition(this.QP[a].x,this.QP[a].y,!0),this.aq[a].QA(!0);this.Z4()}}Z4(){this.toc.wph(this.FJa);null!==this.P1&&this.P1.c3();this.yb.pT();this.QP=this.aq=null;null!==this.Pq&&this.Pq.Uza()}}Object(m.a)(LL,"ShapeMoveDragAdapter",lz,[]);class hF{constructor(a){this.ecd=this.b2=this.C2=this.zmc=this.k2=null;this.Nd=a}YRl(a,b,c,f,l){this.k2=
a;this.zmc=b;this.C2=c;this.b2=f;this.ecd=l}}Object(m.a)(hF,"ResizeShapesCalculationData",null,[]);var iF=d(638);class Ll{static x3d(a,b,c,f,l){return f?Ll.cUf(a,c):Ll.NOi(a,b,c,l)}static cUf(a,b){const c=new Mi.a;if(a.equals(Ge.a.Pv)||a.nEb(Ge.a.Pv))c.left=b.x,c.top=b.y;else if(a.equals(Ge.a.ZF)||a.nEb(Ge.a.ZF))c.right=b.x,c.bottom=b.y;return c}static NOi(a,b,c,f){b=a.MDb()?Ll.DOi(a,b,c,f):Ll.POi(a,b,c);c=new Mi.a;if(a.nEb(Ge.a.north)||a.equals(Ge.a.north))c.top=-1*b.y;if(a.nEb(Ge.a.east)||a.equals(Ge.a.east))c.right=
b.x;if(a.nEb(Ge.a.south)||a.equals(Ge.a.south))c.bottom=b.y;if(a.nEb(Ge.a.west)||a.equals(Ge.a.west))c.left=-1*b.x;return c}static DOi(a,b,c,f){var l=b.el(a),u=b.el(a.Dbb()),I=b.el(a.xpj());a=b.el(a.ypj());var T=new pd.a(l._x+c.x,l._y+c.y);const ja=iF.b(u,I,T);b=iF.b(u,a,T);c=Ll.x4d(u,I,ja);l=Ll.x4d(u,a,b);b=pd.a.an(b,T);T=pd.a.an(ja,T);I=pd.a.an(u,I);u=pd.a.an(u,a);f?(u||(ya.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),u=1),I||(ya.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),
I=1),f=I/u,!T||b/T>f?(b<Ll.I4&&(b=Ll.I4),T=b/f,T<Ll.I4&&(T=Ll.I4,b=T*f)):(T<Ll.I4&&(T=Ll.I4),b=T*f,b<Ll.I4&&(b=Ll.I4,T=b/f))):(b<Ll.I4&&(b=Ll.I4),T<Ll.I4&&(T=Ll.I4));return new pd.a(b*c-I,T*l-u)}static POi(a,b,c){var f=a.W0c();a=a.sBb();f=b.el(f);var l=b.el(a);b=b.el(a.Dbb());a=pd.a.Bcb(f,l);a.BN(c.x,c.y);c=iF.b(b,f,a);a=pd.a.an(b,c);l=pd.a.an(f,b);a<Ll.I4&&(a=Ll.I4);f=a*Ll.x4d(b,f,c)-l;return new pd.a(f,f)}static x4d(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?
-1:1}}Ll.I4=6;Object(m.a)(Ll,"ResizeHelper",null,[]);class Lt extends lz{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){super(Ra,Ub);this.Nna=this.h2=this.LJa=this.iCe=this.jCe=this.Nd=this.fH=null;this.FJa=!1;this.yS=this.mS=null;this.pcd=-1;if(!lc)throw Error.argumentNull("viewEventSourceNotifier");this.yb=a;this.ia=b;this.dE=c;this.$_a=f;this.YG=l;this.iE=u;this.Ji=I;this.ue=T;this.Ga=ja;this.toc=ua;this.kB=Xb;this.Pq=eb;this.Ye=Bb;this.wq=tc;this.yld=lc;this.wfd=Ec}Ew(a){if(!a||a.xB===
Sys.UI.MouseButton.rightButton)return!1;this.yS=[];this.Nd=Object(gb.a)(178,this.iE.aK(a.Ec));if(!this.Nd||!this.Nd.jF(a.Ec))return!1;a=this.Nd.shapeNode;if(!a||!a.isResizable||this.dE.t1)return!1;this.fH=[];if(a.dA)Array.add(this.fH,this.Nd);else{var b=this.$_a.Hd();(b=this.Ga.PVa(b))&&this.$_a.Ivd(b);a.Lf&&this.$_a.D4f(a);b=this.$_a.rf();this.fH=ek.d(b,this.yb.Na)}if(this.Ga.N5(this.Nd.shapeNode))Array.add(this.yS,new hF(this.Nd));else for(const c of this.fH){if(!this.iqk(c))return this.yS=null,
!1;c.shapeNode.isResizable&&!c.shapeNode.vd&&Array.add(this.yS,new hF(c))}return!0}iqk(a){return 32!==this.ia.Ia(M.a.k0e,1,a.eb)||this.dE.t1||!a.KR?!1:!0}vmh(a){if(!a||!this.Ew(a))return!1;this.pcd=Date.now();this.$_a.uj();this.YG.Gd();this.ia.nb(M.a.U$a,2);this.Nna=this.Nd.N$b();if(!this.Nd.jF(a.Ec))return!1;null!==this.Pq&&this.Pq.tAa(sj.a.ESb);this.mS=this.dng(this.Nd.jF(a.Ec),this.Nd,this.Nna,!1);this.wfd&&this.yld.v1e(new IB(!1));this.LJa=this.$ta(a.clientPoint);({width:this.jCe,height:this.iCe}=
this.mUf(this.Nna,this.Nd.shapeNode.v1));this.h2=new pd.a(0,0);for(const c of this.yS){var b=c.Nd.N$b();a=c.Nd;const {width:f,height:l}=this.mUf(b,this.Nd.shapeNode.v1),u=this.dng(this.mS,a,b,!0);c.YRl(b,a.xLa,f,l,u);a.RM=!0;a.aF(!0);b=ek.c(a.shapeNode,this.yb.Na);a.shapeNode.Lf&&b.Nk&&(b.Nk.visible=!0)}this.FJa=this.Ga.N5(this.Nd.shapeNode)?!0:1<this.fH.length?!1:!0;this.kB&&this.$_a.UM()&&this.ue.r1e();this.wq&&this.ia.nb(G.a.kma,2);return!0}mUe(a){if(a){var b=this.$ta(a.clientPoint),c=pd.a.nT(b,
this.LJa);this.h2=pd.a.add(this.h2,this.eng(c,this.Nna,!1));var f=null;c=this.FJa&&!this.Nd.shapeNode.Iv;for(const l of this.yS){let u=new pd.a(l.C2/this.jCe*this.h2.x,l.b2/this.iCe*this.h2.y);new Mi.a;if(l.Nd.shapeNode.dA){this.Nd.shapeNode.dA&&(u=this.h2);if(!l.ecd)continue;f=Ll.cUf(l.ecd,u)}else f=Ll.x3d(l.ecd,l.k2,this.eng(u,l.k2,!0),l.Nd.shapeNode.dA,l.Nd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Mi.a.add(l.zmc,this.tdg(f,l.k2));l.Nd.setOffsets(f,!c);l.Nd.shapeNode.Lf&&l.Nd.shapeNode.isEditable&&
l.Nd.aoe()}this.LJa=b;a=this.toc.tph(!0,this.FJa,this.Nd,this.mS);c&&!a&&f&&this.Nd.setOffsets(f,!0)}}tdg(a,b){if(this.Ga.N5(this.Nd.shapeNode))return a;const c=new Mi.a;c.left=b.g7c?a.right:a.left;c.right=b.g7c?a.left:a.right;c.top=b.Aeb?a.bottom:a.top;c.bottom=b.Aeb?a.top:a.bottom;return c}smh(a){const b=[];for(var c=0;c<this.yS.length;c++){let f=Mi.a.nT(this.yS[c].Nd.xLa,this.yS[c].zmc);f=this.tdg(f,this.yS[c].k2);Array.add(b,new GB(this.yS[c].Nd.shapeNode,f,this.mS,this.h2));this.yS[c].Nd.shapeNode.Lf&&
this.yS[c].Nd.shapeNode.isEditable||(this.yS[c].Nd.RM=!1);this.yS[c].Nd.QA(!1)}this.Nd.shapeNode.Iv?ad.App.Ob.Gf():(c={},a&&a.hc&&a.hc.rawEvent&&(c[Ii.a.MFa]=a.hc.rawEvent.timeStamp),this.Ga.N5(this.Nd.shapeNode)?(this.Nd.JFa(),this.ia.Ia(M.a.EGh,2,b,c)):(this.dEk(),this.ia.Ia(M.a.Qmb,2,b,c)));this.kB&&this.$_a.UM()&&(a=this.$_a.KGa(),this.ue.gmb(new kz.a(a)));this.jM()}qmh(){if(this.yS){for(const a of this.yS)a.Nd.setOffsets(a.zmc,!0),a.Nd.RM=!1,a.Nd.QA(!0);this.jM()}}jM(){this.toc.wph(this.FJa);
this.Nna=this.iCe=this.jCe=this.Nd=this.fH=this.yS=this.mS=this.h2=this.LJa=null;null!==this.Pq&&this.Pq.Uza()}mUf(a,b){let c;var f=b?this.gge(a):a;c=pd.a.an(f.ga(0),f.ga(1));f=pd.a.an(f.ga(0),f.ga(3));b||(a=Re.a.VS(pd.a.IJ(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(ya.a.J(508851873,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Nd.shapeNode.ln),c=1),f||(ya.a.J(508851872,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Nd.shapeNode.ln),f=1));return{width:c,
height:f}}dng(a,b,c,f){if(b.shapeNode.dA){if(this.Nd.shapeNode.dA)return a;if(a.equals(Ge.a.IF)||a.equals(Ge.a.hJ))return null;if(a.equals(Ge.a.Pv)||a.equals(Ge.a.ZF))return c.ga(0).x>c.ga(1).x?a.Dbb():a;if(b.shapeNode.v1){f=Re.a.VS(pd.a.IJ(c.ga(0),c.ga(1)));if(a.equals(Ge.a.north)||a.equals(Ge.a.south))return Math.abs(f-90)<Lt.dmc||Math.abs(f-270)<Lt.dmc?c.ga(0).y<c.ga(1).y?a:a.Dbb():null;if(a.equals(Ge.a.east)||a.equals(Ge.a.west))if(Math.abs(f-180)<Lt.dmc||360-f<Lt.dmc||f<Lt.dmc)return c.ga(0).x<
c.ga(1).x?a:a.Dbb()}return null}c=pd.a.IJ(c.ga(0),c.ga(1));c=Math.floor((c+Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.W0c().W0c():a.sBb().sBb();return a}eng(a,b,c){if(this.Nd.shapeNode.dA||this.Ga.N5(this.Nd.shapeNode))return a;var f=pd.a.IJ(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=pd.a.IJ(f,b);return c?new pd.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new pd.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*
a.x)}$ta(a){var b=this.Nd.L4(this.Ji.Tm(a.x)),c=this.Nd.L4(this.Ji.Tm(a.y));if(this.Ga.N5(this.Nd.shapeNode)){c=this.mS;this.mS.MDb()||(c=c.sBb());b=this.Ye.wi(this.Nd.USa);b.x+=jf.a.Kzd;b.y+=jf.a.Kzd;b.width-=2*jf.a.Kzd;b.height-=2*jf.a.Kzd;var f=ej.a.jfa(b);b=f.el(c);f=f.el(c.Dbb());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Nd.L4(this.Ji.Tm(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Nd.L4(this.Ji.Tm(c))}return new pd.a(b,c)}gge(a){const b=pd.a.Bcb(a.ga(0),a.ga(3));a=pd.a.Bcb(a.ga(1),
a.ga(2));return new ej.a(new pd.a(b.x,b.y),new pd.a(a.x,b.y),new pd.a(a.x,a.y),new pd.a(b.x,a.y))}dEk(){-1!==this.pcd&&(ya.a.J(508429895,815,50,"onDragEnd time spent in dragging : {0} in UserAction : ResizeShapes",Date.now()-this.pcd),this.pcd=-1)}}Lt.dmc=3;Object(m.a)(Lt,"ShapeResizeDragAdapter",lz,[]);var ML=d(195);class JB{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.BKe=this.bMe=null;this.ymc=0;this.MNe=this.$nc=null;this.Zbd=0;this.J0g=8;this.Y9g=4;this.UFk="AngleUIRendered";this.zF=this.Nd=
null;this.yb=a;this.ia=b;this.dE=f;this.P1=c;this.oa=l;this.YG=u;this.iE=I;this.Ji=T;this.nc=ja;this.te=ua;this.Pq=Ra;this.wq=eb;this.mJa=Bb}Ew(a){if(!a||a.xB!==Sys.UI.MouseButton.leftButton||this.dE.t1)return!1;this.Nd=Object(gb.a)(178,this.iE.aK(a.Ec));return this.Nd&&this.Nd.qxe(a.Ec)?(this.zF=this.Nd.shapeNode)&&this.zF.SM&&this.Nd.KR?!0:!1:!1}Qv(a){if(!a||!this.Ew(a))return!1;this.oa.uj();this.YG.Gd();this.ia.nb(M.a.U$a,2);null!==this.Pq&&this.Pq.tAa(Df.a.rR(this.te.Ok("rotatehandlecursor.cur"),
sj.a.fVh));this.ymc=this.zF.get_shapeRotation();this.$nc=this.Nd.N$b().ng();this.MNe=this.Nd.IAb().ng();this.bMe=this.$ta(a.clientPoint);this.Nd.rna=!0;this.mJa&&this.v8e(!0);this.Nd.aF(!0);this.wq&&this.ia.nb(G.a.kma,2);return!0}Px(a){if(!a)return!1;this.BKe=this.$ta(a.clientPoint);if(!this.BKe)return!1;this.Zbd=Re.a.VS(pd.a.IJ(this.BKe,this.$nc))-Re.a.VS(pd.a.IJ(this.bMe,this.$nc));let b=this.ymc+this.Zbd;this.mJa&&(b=this.xTh(b));this.Nd.setRotation(Math.round(b),this.MNe);this.mJa&&(a=this.$ta(a.clientPoint,
!1),this.Ujm(a,Math.round(b)));return!0}xTh(a){return this.dIi(a)?10*Math.round(a/10):a}dIi(a){0>a&&(a=(a+360)%360);return(a+this.Y9g/2)%90<=this.Y9g?!0:!1}Ujm(a,b){var c=this.nc.ug(this.Nd.eb);c=ek.e(c,this.yb.Na);c.Gwc.xE(2);c.Gwc.setPosition(a.x+this.J0g,a.y+this.J0g);c.Gwc.va.style.position="absolute";0>b&&(b+=360);c.Gwc.va.innerText=(b%360).toString()+"\u00b0"}v8e(a){const b=this.nc.ug(this.Nd.eb);ek.e(b,this.yb.Na).Gwc.ee(a)}Uo(a){this.mJa&&this.v8e(!1);this.Nd.rna=!1;this.Nd.QA(!1);var b=this.ymc+
this.Zbd;this.mJa&&(b=this.xTh(b));b=new Rp(this.zF,Math.round(b));const c={};a&&a.hc&&a.hc.rawEvent&&(c[Ii.a.MFa]=a.hc.rawEvent.timeStamp);this.mJa&&(c[this.UFk]=1);this.ia.Ia(M.a.Bwc,2,b,c);this.Z4()}rv(){this.$nc&&(this.Nd.setRotation(this.ymc,this.MNe),this.mJa&&this.v8e(!1),this.Nd.rna=!1,this.Nd.QA(!0),this.Z4())}$ta(a,b){b=void 0===b?!0:b;var c=this.nc.ug(this.Nd.eb);return(c=ek.e(c,this.yb.Na).Oy)?(a=pd.a.tVa(ML.a.LVa(a,c)),b?new pd.a(this.Nd.L4(this.Ji.Tm(a.x)),this.Nd.L4(this.Ji.Tm(a.y))):
a):null}Z4(){null!==this.P1&&this.P1.c3();null!==this.Pq&&this.Pq.Uza();this.yb.pT();this.bMe=null;this.ymc=0;this.$nc=null;this.Zbd=0;this.Nd=this.zF=null}static getInstance(a){return JB.JD(a)}static JD(a){return new JB(a,Tb.a.instance.resolve("Common.IActionManagerExtended"),Tb.a.instance.resolve("Common.ICursorPinningTool"),Tb.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),Tb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Tb.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),
Tb.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),Tb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Tb.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Tb.a.instance.resolve("PowerPoint.IPathManager"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Tb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,
Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").SYe)}}Object(m.a)(JB,"ShapeRotateDragAdapter",null,[363]);var mz=d(387);class NL{constructor(a,b,c,f,l){this.In=this.Ss=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Jc=b;this.yb=c;
this.TZa=f}Qhj(){if(this.Ss)return this.Ss;this.Ss=new no.a;this.Ss.ot("MarqueeDiv");this.Ss.xk(0);this.Ss.va.style.borderStyle="solid";this.Ss.va.style.borderWidth="thin";this.Ss.va.style.borderColor="black";this.Ss.va.style.opacity="0.5";this.Ss.ee(!1);return this.Ss}n0h(a,b){this.Ss&&this.Ss.Mh(a,b)}m0h(a,b){this.Ss&&this.Ss.setPosition(a,b)}jM(){this.In=null;this.Ss&&(this.Ss.ee(!1),this.Ss.mr())}q1d(a){const b=this.Jc.Ic;if(!b||!b.Ee||!b.Ee.va)return ya.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),
!1;b.Ee.va.appendChild(a.va);a.xE(2+mz.a.hja);a.ee(!0);return!0}Ew(a){try{return a?a.xB===Sys.UI.MouseButton.rightButton?!1:1===this.TZa.vyg?!0:!1:(ya.a.J(512497681,822,10,"Event argument is null in isDragPossible"),!1)}catch(b){throw ya.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",b),b;}}Qv(a){try{if(!a)return ya.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Ew(a))return!1;this.In=Js.a(a.clientPoint,this.Jc.Ic);const b=this.Qhj();if(!this.q1d(b))return!1;
this.m0h(this.In.x,this.In.y);this.n0h(0,0);return!0}catch(b){throw ya.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}Px(a){try{if(!a)return ya.a.J(512497677,822,10,"Event argument is null in OnDragMove"),!1;if(!this.yb.isActive)return!1;const b=Js.a(a.clientPoint,this.Jc.Ic),c=Math.min(this.In.x,b.x),f=Math.min(this.In.y,b.y),l=Math.max(this.In.x,b.x),u=Math.max(this.In.y,b.y);this.m0h(c,f);this.n0h(l-c,u-f);return!0}catch(b){throw ya.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",
b),b;}}Uo(a){try{if(a)if(this.In){var b=Js.a(a.clientPoint,this.Jc.Ic),c=Js.b(Math.min(this.In.y,b.y),Math.max(this.In.y,b.y),Math.min(this.In.x,b.x),Math.max(this.In.x,b.x));this.ia.Ia(M.a.A5c,2,c);md.a("TelemetryForClickAndDragOperation")&&ya.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");this.jM()}else ya.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else ya.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw ya.a.J(512497672,822,
10,"Exception {0} occured in OnDragEnd",f),f;}}rv(){this.jM()}dispose(){this.jM();this.Ss=null}}Object(m.a)(NL,"TextboxDrawDragAdapter",null,[363,106]);class Mt{constructor(a,b,c){this.mhd=0;this.QP=null;this.Ehc=!1;this.ULe=this.ocd=null;this.aJb=new pd.a(0,0);this.Yoa=1;this.Mj=a;this.Jc=b;this.oIk=c;this.oIk.kU(Object(R.a)(this,this.o1a,"onSlideNavigation"))}cxb(a){return a?!0:!1}o1a(){this.Yoa=1;this.aJb=new pd.a(0,0);this.setTransform(new pd.a(0,0))}mEb(a){if(!a)return!1;a=this.jqg(a.hc);return!!a&&
1<a.length}XVe(a){if(!a)return!1;this.mhd=this.Mj.lW;if(!this.mEb(a))return!1;this.QP=this.s1c(a.hc);return!1}Nrc(a){if(!a)return!1;this.mEb(a)?(a=this.s1c(a.hc),this.QP||(this.QP=a),this.BGd(this.dPi(this.QP,a))):this.T$k(a);return!0}T$k(a){a&&(a=this.s1c(a.hc),this.Ehc?(a=this.WTf(this.ocd,a),this.setTransform(a)):(this.Ehc=!0,this.ocd=a))}Uo(a){if(this.Ehc&&a){a=this.s1c(a.hc);var b=this.WTf(this.ocd,a);a=b.x+this.aJb.x;b=b.y+this.aJb.y;this.Ehc=!1;this.aJb=new pd.a(a,b)}}WTf(a,b){return!a||1>
a.length||!b||1>b.length?new pd.a(0,0):new pd.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Jc&&this.Jc.Ic&&this.Jc.Ic.aW){var b=this.Jc.Ic.aW;this.ULe||(this.ULe=b.style.cssText);b.style.cssText=this.ULe+"  width:100%;height:100%; transform:translate("+(a.x+this.aJb.x+"px,"+(a.y+this.aJb.y)+"px) scale("+this.Yoa+","+this.Yoa+")")}}fTl(){this.setTransform(new pd.a(0,0))}AMb(a){if(!a)return!1;this.Uo(a);this.Xam();return!1}BGd(a){this.mhd&&(a*=this.mhd,a<Mt.qhh?a=Mt.qhh:a>Mt.Ogh&&(a=Mt.Ogh),
this.Mj.hna=!1,this.Yoa=this.Mj.lW=a,this.fTl())}VTf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}dPi(a,b){a=this.VTf(a);b=this.VTf(b);return-1!==a&&-1!==b&&a?b/a:0}jqg(a){let b=null;if(!a)return null;a=a.rawEvent?a.rawEvent:a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}s1c(a){let b=null;a=this.jqg(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new pd.a(c.screenX,c.screenY));return b}Xam(){this.mhd=
0;this.QP=null;this.Ehc=!1;this.ocd=null}}Mt.qhh=1;Mt.Ogh=5;Object(m.a)(Mt,"ZoomSettingTouchAdapter",null,[978]);var wS=d(432);class OL{constructor(a,b,c,f,l,u,I){this.jLe=!1;this.In=null;this.$Je=!1;this.yb=a;this.UK=b;this.gb=c;this.Jc=f;this.Fa=l;this.sa=u;this.sQg=I;this.Ss=new no.a;this.Ss.ot("Marquee");this.Ss.xk(0);this.Ss.va.style.backgroundColor="darkgrey";this.Ss.va.style.opacity="0.5";this.Ss.ee(!1)}q1d(){this.Ss&&(this.Jc.Ic.Ee.va.appendChild(this.Ss.va),this.jLe=!0)}jM(){this.In=null;
this.Ss&&(this.Ss.ee(!1),this.Ss.mr(),this.jLe=!1);this.$Je=!1}Ew(a){if(!a||this.sQg.instance&&this.sQg.instance.isDisabled()||a.xB===Sys.UI.MouseButton.rightButton)return!1;a=new wS.a(a,this.yb);return this.yb.agc(a)}Qv(a){if(!a||!this.yb.isActive||!this.Ew(a))return!1;this.UK.Uzh(new vr(!0));a.ctrlKey||a.shiftKey?ya.a.J(508895445,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.gb.Bh();this.Fa.Gd();this.$Je=a.shiftKey?!0:!1;this.In=this.$ta(a.clientPoint);this.jLe||
this.q1d();this.Ss.setPosition(this.In.x,this.In.y);this.Ss.Mh(0,0);this.Ss.xE(1+mz.a.hja);this.Ss.ee(!0);return!0}Px(a){if(!a||!this.yb.isActive)return!1;var b=this.$ta(a.clientPoint);a=Math.min(this.In.x,b.x);const c=Math.min(this.In.y,b.y),f=Math.max(this.In.x,b.x);b=Math.max(this.In.y,b.y);this.Ss.setPosition(a,c);this.Ss.Mh(f-a,b-c);return!0}Uo(a){if(a){var b=this.$ta(a.clientPoint);a=Math.min(this.In.x,b.x);var c=Math.min(this.In.y,b.y),f=Math.max(this.In.x,b.x);b=Math.max(this.In.y,b.y);var l=
this.sa.Aa,u=l?l.yj():[];l=[];var I=[],T=this.gb.Hd();for(const ja of u)(u=Object(gb.a)(178,ja.sc(this.yb.Na)))&&u.KR&&(u.Mq?u.OAd():(u=u.Wle(!1),u.oc>=a&&u.pc>=c&&u.lc<=f&&u.jc<=b&&(this.$Je?Array.contains(T,ja)?I.push(ja):l.push(ja):Array.contains(T,ja)||l.push(ja))));0<l.length&&this.gb.$2a(l,!1);0<I.length&&this.gb.Kea(I);this.jM()}}rv(){this.In&&this.jM()}$ta(a){const b=this.Jc.Ic.Oy;return b?pd.a.tVa(ML.a.LVa(a,b)):pd.a.tVa(a)}dispose(){this.In&&this.jM();this.Ss=null}}Object(m.a)(OL,"MarqueeSelectDragAdapter",
null,[363,106]);class PL{constructor(a){this.TY=null;this.lKi(a);this.une=!1}lKi(a){null!==a&&(this.TY=Df.a.we(),this.TY.style.position=sj.a.absolute,this.TY.style.top="0px",this.TY.style.left="0px",a.appendChild(this.TY))}tAa(a){null!==a&&null!==this.TY&&null!==this.TY.parentNode&&(this.TY.style.cursor=a,this.TY.style.zIndex=String(sj.a.Ypm),this.TY.style.height="100%",this.TY.style.width="100%",this.une=!0)}Uza(){if(null!==this.TY||this.une)this.TY.style.height="0px",this.TY.style.width="0px",this.TY.style.cursor=
sj.a.fVh,this.TY.style.zIndex="-1",this.une=!1}}Object(m.a)(PL,"CursorContainerManager",null,[924]);class jF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}fc(a){this.K=a;a.register(924,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().na(()=>new PL(a.resolve("PowerPointWebEditor.AppFrame").M3));a.register(fF,"PowerPointWebEditor.ShapeManipulationActor").ma().na(()=>new fF(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new uq(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
a.resolve("PowerPointWebEditor.IApplicationSettings").y5e,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(gF,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().na(()=>
new gF(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),Ha.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?
this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(925,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().na(()=>new JL(a.resolve("Box4.IPageView").Na,a.resolve("Box4.IPageView").Xd,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.D8j();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.w9j();this.o8j()}w9j(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").ewl(new Mt(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}D8j(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),u=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),I=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),T=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja=this.K.resolve("PowerPointWebEditor.ISlideReader"),
ua=this.K.resolve("PowerPointWebEditor.IShapeReader"),Ra=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),eb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Bb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),Ub=this.K.resolve("PowerPoint.IPathManager"),Xb=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,tc=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").gPb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").gPb(1,new LL(a,b,l,T,this.K.resolve("Box4.IUndoManager"),c,f,u,I,ua,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Ra,eb,Bb,Xb,tc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").r5e),new Lt(a,b,c,f,u,I,T,Ra,ua,eb,Bb,Xb,this.K.resolve("PowerPoint.IBrowserHelperManager"),tc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").r5e),
new JB(a,b,l,c,f,u,I,T,ja,Ub,Xb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").SYe),new OL(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.Ha("PowerPointWebEditor.WetInkView")));c=
new KL(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").PBh(c);a=new NL(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),
this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").PBh(a);ya.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}o8j(){const a=this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.Sd();a.qb()}dispose(){}static main(){C.a.instance.Ac(new jF)}}Object(m.a)(jF,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var xS=d(1210),Rr=d(115);class nz{constructor(a,b,c,f,l,u,I,T){this.JKe=null;this.xKe=
new Date;this.aS=a;this.jNk=b;this.PTk=c;this.IGk=f;this.UMk=l;this.YJa=u;I.Jb(new ne.a(T,2,this.IGk,Object(R.a)(this,this.tWf,"checkTask"),90,"61"))}tWf(){this.nem()}nem(){var a=new Date;const b=+new Date-+this.JKe>this.PTk;if(!(this.xKe<this.JKe)||b){if(+a-+this.xKe<this.jNk)return;this.aS()}a=+new Date-+a;a>this.UMk&&ya.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.YJa)}ECd(){this.JKe=new Date}ACd(){this.xKe=
new Date}}Object(m.a)(nz,"PrefetchThrottler",null,[]);class Mq{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc){this.Xwd=250;this.wkc=this.Oic=null;this.dlc=this.Lkc=!1;this.KJb=[];this.hNi=5;this.pTf=10;this.LJb=[];this.iNi=5;this.G_a=!1;this.Reh=this.zK=this.wad=null;this.Kfd=!1;this.SMe=[];this.Yb=a;this.sa=b;this.HC=c;this.Wj=f;this.hZa=l;this.kA=lc;this.qha=u;this.Ba=I;this.zb=T;this.nc=ja;this.Iw=ua;this.wN=Ra;this.xd=eb;this.hSk=Bb;this.Nc=Ub;this.jh=Xb;this.um=tc;this.XRk=this.Ba.kok;
this.ZPk=A.AFrameworkApplication.fa.getBooleanAppSetting("PrefetchThrottlerNormalPriorityEnabled");this.YPk=A.AFrameworkApplication.fa.getBooleanAppSetting("PrefetchLookaheadSlideEnabled");!E.a.Aj||this.Ba.lok?this.setEnabled(this.Ba.ugk,this.Ba.ckk):this.setEnabled(!1,!1);this.Xhd=this.Ba.prefetchSlideForwardMax;this.Whd=this.Ba.prefetchSlideBackwardMax;this.OHk=A.AFrameworkApplication.fa.getBooleanAppSetting("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.qJl=A.AFrameworkApplication.fa.tc("SlidePrefetchLookaheadCount",
0);this.KI=!1;this.Nc.aC(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.D9a(Object(R.a)(this,this.Nha,"onSessionRehydrating"));this.Nc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"));A.AFrameworkApplication.fa.getBooleanAppSetting("SlidePrefetchThrottlerMinDelayReduced")&&(this.Xwd=125);this.um&&this.um.rHa(()=>{this.v5l()})}v5l(){this.Reh=new ne.a(2,1,this.Xwd,Object(R.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.Kfd=!1;const a=this.ZPk?2:3;this.Oic=new nz(Object(R.a)(this,
this.lem,"tryPrefetchContentModel"),this.Xwd,Mq.rJl,Mq.LIh,Mq.FIh,"content model",this.zb,a);this.xd.Avb(Object(R.a)(this,this.s1a,"onVisibleThumbnailsChanged"));this.jh.HJ(Object(R.a)(this,this.XC,"onActiveSlideChanged"));this.wkc=new nz(Object(R.a)(this,this.oem,"tryPrefetchImages"),this.Xwd,Mq.pJl,Mq.LIh,Mq.FIh,"image",this.zb,3);this.wN&&(this.wN.Pka(Object(R.a)(this,this.rJg,"loadedHandler")),this.wN.Ak(Object(R.a)(this,this.Uxh,"propertyChangedHandler")))}get Of(){this.wad&&this.wad.isConnected||
(this.wad=this.Yb.Of);return this.wad}get Aa(){this.zK||(this.zK=this.sa.Aa);return this.zK}setEnabled(a,b){this.Lkc=a;this.dlc=b}Znd(){this.KJb=[];this.LJb=[];this.G_a=!1}dispose(){this.xd.DEh(Object(R.a)(this,this.s1a,"onVisibleThumbnailsChanged"));this.jh.E7(Object(R.a)(this,this.XC,"onActiveSlideChanged"));this.Nc.F7(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.A3e(Object(R.a)(this,this.Nha,"onSessionRehydrating"));this.Nc.Wba(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.wN&&
(this.wN.x2a(Object(R.a)(this,this.rJg,"loadedHandler")),this.wN.tn(Object(R.a)(this,this.Uxh,"propertyChangedHandler")))}GN(){this.KI=!0}Nha(){this.Znd()}mo(){this.KI=!1}lem(){this.Lkc&&this.lQh()&&this.Kjl()}Kjl(){var a=this.Rle();const b=this.G_a?null:Xp.a(a,c=>c?c.Fb:null);(a=this.quh(0,a))?(a=a.Fb,this.Oic&&this.Oic.ECd(),this.Iw.prefetchSlide(a,b,(c,f)=>{this.G_a=!0;md.a("InvalidateThumbAfterSlideFetch")&&(ya.a.J(508903936,813,50,"prefetchBestSlide: Successfully fetched slide:{0}, isSlideStale:{1}",
c,f),(f=this.qha.MG(c))?(f=f.getImageId(),this.HC.aec(c,f)):ya.a.J(508903907,813,10,"prefetchBestSlide: ThumbnailViewElement null for prefetched slide : {0}",c))}),this.enl(a)):this.G_a||this.Iw.prefetchSlide(Vh.a.empty,b,()=>{this.G_a=!0})}XC(){this.zK=null;this.G_a=!1}s1a(){this.Dcm();this.G_a=!1}rJg(a,b){(a=Object(gb.a)(205,b.node))&&a.kF&&this.Sqc(a)}Uxh(a,b){a=b.property;b.node&&a===yb.a.cid&&(this.G_a=!1)}Sqc(a){if(a.isConnected){var b=Object(gb.a)(205,a);b&&(b.UHa=!0,this.zb.Jb(new ne.a(2,
1,0,Object(R.a)(this.wkc,this.wkc.tWf,"checkTask"),90,"60")),A.AFrameworkApplication.fa.getBooleanAppSetting("PPTOTextPreloadServiceFonts")&&(Array.clear(this.SMe),this.CZd(b.Zcg),this.CZd(b.dYh),this.CZd(b.Y0h),b=new ne.a(3,1,0,Object(R.a)(this,this.mem,"tryPrefetchFonts"),90,"114"),b.gu=this.SMe,this.zb.Jb(b)))}this.Oic&&(this.Oic.ACd(),this.KJb=[]);a.lBa=!0;this.qha.H4a()}enl(a){this.KJb.length>=this.pTf&&(this.KJb=[]);Array.add(this.KJb,a)}CZd(a){if(!Aa.a.Ta(a)){a=a.split(",");for(const b of a)this.SMe.push(b)}}quh(a,
b){b=void 0===b?null:b;const c=this.Aa;if(!c||!c.isConnected)return null;b||(b=this.Rle());return this.vGj(c,a,b)}vGj(a,b,c){for(const f of c)if(f)if(c=f.Fb,this.P1j(c))ya.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.rYl(f,b)){const l=a.Fb;a=this.nc.jbc(a);const u=this.nc.jbc(f);ya.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",
c,u,u-a,l,a,b);return f}return null}P1j(a){let b=0;for(const c of this.KJb)a.equals(c)&&(b+=1);if(b>=this.hNi)return!0;b=0;for(const c of this.LJb)a.equals(c)&&(b+=1);return b>=this.iNi}rYl(a,b){if(!a)return!1;const c=a.Fb;if(Vh.a.Cx(c))return!1;const f=!!a&&a.kF;if(0===b)return!f;if(!f||!a.UHa)return!1;b=a.dXa(new Rr.a(a.yq,a.yl));if(null===b)return ya.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.HC.odc.vwc(l).data)return!0;return a.UHa=
!1}oem(){if(this.dlc&&this.lQh()){const b=this.quh(1);if(b){var a=b.Fb;this.wkc.ECd();this.kmj(b);this.fnl(a)}}}mem(a){a=Array.isArray(a.gu)?a.gu:null;for(const b of a)this.kA.hej(b)}lQh(){return this.KI||!this.XRk&&2===this.Wj.Iea||!this.Of||this.hZa.L5(this.Of)||!this.Aa||this.Aa.QM?!1:!0}fnl(a){this.LJb.length>=this.pTf&&(this.LJb=[]);Array.add(this.LJb,a)}kmj(a){if(a){var b=a.dXa(new Rr.a(a.yq,a.yl));b&&0<b.length?this.HC.$zb(b,!0,()=>{this.wkc.ACd();this.LJb=[];a.UHa=!1},A.AFrameworkApplication.fa.getBooleanAppSetting("FetchSlideImageBatchInRealTimeEnabled")):
a.UHa=!1}}Dcm(){this.Kfd||(this.zb.Jb(this.Reh),this.Kfd=!0)}updateSlidePrefetchRange(){this.Kfd=!1;this.Iw.syncCurrentSlideIdAndPrefetchRange(this.Aa,null,this.qha.Gra,null)}oRj(){return Xp.a(this.Rle(),a=>a?a.Fb:null)}Rle(){var a=this.Aa;if(!a||!a.isConnected)return[];a=this.nc.jbc(a);var b=this.sa.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.OHk)for(var u of this.qha.Gra.D5)u!==a&&u<c&&(Array.add(l,b[u]),f[u]=!0);if(this.YPk&&
!f.length)for(u=1;u<=this.qJl;u++){const I=this.qha.Gra.lastIndex+u;I!==a&&I<c&&(Array.add(l,b[I]),f[I]=!0)}if(0<=a){a=this.hSk.Aog(a,b.length,this.Xhd,this.Whd);for(const I of a)if(void 0===f[I]||null===f[I])f[I]=!0,Array.add(l,b[I])}return l}}Mq.LIh=1E3;Mq.rJl=2E3;Mq.pJl=6E4;Mq.FIh=500;Object(m.a)(Mq,"PrefetchManager",null,[942,106]);class kF{constructor(a,b,c,f){this.Qi=b;this.JI=c;this.oa=f;this.Nc=a;this.Nc.dEa(Object(R.a)(this,this.Rkb,"onSessionEnding"))}Rkb(a,b){if(this.oa.kz()){a=this.oa.Hd();
if(!a.length){const c=this.oa.$ng();c&&a.push(c)}for(const c of a)this.Qi.P$a(c)}this.JI.Gqj(b.uE)}dispose(){this.Nc.uvd(Object(R.a)(this,this.Rkb,"onSessionEnding"))}}Object(m.a)(kF,"SessionCleanupHandler",null,[106]);var QL=d(377),yS=d(977);class lF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.cPd=this.HHc=this.nOe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ba=a;this.Tnc=a.sessionTimeoutInMs;this.zb=b;this.tF=c;this.oa=f;this.DZa=l;this.$D=
u;this.fe=I;this.sa=T;this.ic=ja;this.Kn=ua;this.hbh=Ra;this.Hp=eb;this.hOg=Bb;this.Snc=0}get nfa(){return this.DZa.instance}get s1(){return A.AFrameworkApplication.Dh}get vFg(){return 1===this.Snc}get REb(){return this.HHc}get U8c(){return this.cPd}get uE(){return this.Snc}set uE(a){this.Snc=a}get QUf(){return this.Ba.podsSeamlessFailoverEnabled&&!!this.Hp.instance}start(){if(!this.s1){var a=new ne.a(4,2,3E4,Object(R.a)(this,this.Xfh,"manageLifetime$p"),90,"56");this.zb.Jb(a)}}CVk(){this.Xfh(null)}Xfh(){if(!this.nOe){var a=
+new Date-+$c.a.Ugc;a>this.Tnc&&this.Sjj(a);A.AFrameworkApplication.WA&&A.AFrameworkApplication.fa.getBooleanAppSetting("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ba.wopiTokenRefreshMaxDurationInMs&&this.$D.Zrl()}}Sjj(a){this.s1||(this.UXf(2),this.QUf?this.hOg.instance&&this.hOg.instance.odb&&(ya.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),eg.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],
!0,!0,!1,!0,null),this.hbh.U1l()):this.hbh.T1l(),this.$D.Wql(),ya.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.Tnc,this.QUf,!!this.Hp.instance,this.Ba.podsSeamlessFailoverEnabled))}closeSession(a){this.UXf(void 0===a?1:a)}UXf(a){0===a&&ya.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.s1)try{this.HHc=!0,ya.a.J(512360774,801,
15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",QL.a[a]),this.Snc=a,this.oa.setSelection(null),A.AFrameworkApplication.Dh=!0,this.tF.Ecb().Hod=!0,this.fe.disabled=!0,lj.a.ly&&4!==a&&lj.a.ly.hide(),this.$D.c1e(new yS.a(a)),this.nfa&&0<this.nfa.UFa.count&&this.nfa.Bvc(this.tF.gWa().presentationId,"instanceId",!0,!1),this.Ba.podsSeamlessFailoverEnabled&&this.Hp.instance&&(1===a?this.Hp.instance.oYd("abortedOnExitApp"):this.Hp.instance.oYd("SessionClose_"+a)),this.zb.stop(),
this.Kn.isPaused||this.Kn.pause(),4!==a&&2!==a&&this.ic.blockContent(this.sa.presentation,"CloseSession",!0),this.$D.pud(new Dl.a(a))}finally{this.cPd=this.HHc=!1}}C2l(){this.nOe=!0}jHl(){this.nOe=!1}markSessionClosingAtForceSave(a){ya.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",QL.a[a]);this.cPd=this.HHc=!0;this.Snc=a}}Object(m.a)(lF,"SessionLifetimeManager",null,[1577]);var Sg=d(434);class RL{constructor(){this.trigger=null;this.Eca=this.Nob=this.m4a=
0;this.i7d={}}}Object(m.a)(RL,"SuggestionsInfo",null,[]);class SL{constructor(){this.SessionID=this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(m.a)(SL,"StartRtcConnectionRequest",null,[]);class TL{constructor(){this.SessionID=null}}Object(m.a)(TL,"StopRtcConnectionRequest",null,[]);var zS=d(286);class UL{constructor(a,b){this.slideId=a;this.imageId=zS.a.LTc(b)}}Object(m.a)(UL,"ThumbnailImageId",null,[]);var Nt=d(295);const VL=a=>{let b,c,f;var l;let u,I;b=null;f=c=0;u=l=null;
I=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new Nt.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new Vh.a(l),u=a[6],I=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,suggestionCount:c,Eca:f,slideID:l,trigger:u,Nob:I}):{returnValue:!1,correlationID:b,suggestionCount:c,Eca:f,slideID:l,trigger:u,Nob:I}},AS=a=>{const b=
new La.a;try{const c=Fe.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){ya.a.J(508360540,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b},BS=a=>{try{const b=a.match(RegExp("\\d+","g"));if(b&&0<b.length&&!(b.length%2)){const c=[];for(let f=0;f<b.length;f+=2)c.push(Object.assign(new Nt.a,{Sid:Number.parseInvariant(b[f]),Cid:Number.parseInvariant(b[f+1])}));return c}}catch(b){ya.a.J(508360536,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",
a,b)}return null};var KB;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(KB||(KB={}));Object(m.b)("CoauthorStatus",KB);class XL extends Sys.EventArgs{constructor(a){super();this.Tka=a}}Object(m.a)(XL,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class YL extends Sys.EventArgs{constructor(a){super();this.ZXc=a}}Object(m.a)(YL,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class ZL extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.Z2c=a;this.MXc=b;this.ojk=
c;this.confidence=f;this.imageDescription=l}}Object(m.a)(ZL,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class $L extends Sys.EventArgs{constructor(a){super();this.efc=a}}Object(m.a)($L,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class aM extends Sys.EventArgs{constructor(){super()}}Object(m.a)(aM,"CommentsChangedEventArgs",Sys.EventArgs,[]);class bM extends Sys.EventArgs{constructor(a){super();this.Xde=a}}Object(m.a)(bM,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class cM extends Sys.EventArgs{constructor(){super()}}
Object(m.a)(cM,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class dM extends Sys.EventArgs{constructor(){super()}}Object(m.a)(dM,"RealTimeEditEventArgs",Sys.EventArgs,[]);class mF extends Sys.EventArgs{constructor(a,b){b=void 0===b?null:b;super();this.QSk=a;this.rIk=b}get gWh(){return this.QSk}get hkj(){return this.rIk}}Object(m.a)(mF,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class eM extends Sys.EventArgs{constructor(a){super();this.ykl=a}}Object(m.a)(eM,"PresentationLastModifiedTimeReceivedEventArgs",
Sys.EventArgs,[]);var CS=d(903);class fM extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(m.a)(fM,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class LB extends Sys.EventArgs{constructor(a,b,c,f,l,u,I){super();this.ope=!1;this.Gzc=null;this.correlationId=a;this.m4a=b;this.Eca=c;this.trigger=l;this.slideId=u;this.xFa=I;this.bOa=f}}Object(m.a)(LB,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class oz extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=
a;this.slideId=b;this.xFa=c}}Object(m.a)(oz,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class gM extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.t_=c;this.shapeId=b;this.xFa=f}}Object(m.a)(gM,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class hM extends Sys.EventArgs{constructor(a,b,c,f,l,u){super();this.correlationId=a;this.cga=b;this.slideId=c;this.shapeId=f;this.WMa=l;this.xFa=u}}Object(m.a)(hM,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class iM extends Sys.EventArgs{constructor(a){super();
this.Cnk=a}}Object(m.a)(iM,"PictureRenderSuccessEventArgs",Sys.EventArgs,[]);var DS=d(388);class nF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug){this.SFe=this.MFe=!1;this.QZg=null;this.u0g={};this.qha=b;this.Ql=ug;this.yr=l;this.Cbd=u;this.Yb=T;this.sa=ja;this.Iw=ua;this.Vhd=Ra;this.fe=eb;this.$D=Bb;this.ue=Ub;this.Hbd=Xb;this.ks=tc;this.Xa=a;this.vS=lc;this.rJb=Ec;this.Nc=hd;this.jcd=c;this.Ba=yd;this.av=Pd;this.zb=pe;this.Mw=Se;this.rc=vf;this.aXg=this.Ba.Mg&&
this.Ba.pptNoRtcConnectWhenReadOnlyEnabled;this.Nc.dEa(Object(R.a)(this,this.KF,"onSessionEnd"));this.Nc.aC(Object(R.a)(this,this.see,"flushOnSessionEnd"));this.jcd.NLf(Object(R.a)(this,this.eoh,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.NLf(Object(R.a)(this,this.eoh,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ba.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&this.Nc.bC(Object(R.a)(this,this.Kba,"onPodSessionRehydrated"));this.aXg&&this.Nc.eea(Object(R.a)(this,this.Bz,"onUnifiedAppStateChanged"))}eoh(a,
b){this.K4k(b,this.Cbd)}K4k(a,b){let c=!1;const f=[],l=[],u=new RL;for(const T of a.items){const ja=new Date,ua=this.av.FHa;let Ra,eb,Bb,Ub,Xb,tc;if(T.Key===Sg.a.pwh)b.qie(Sg.a.pwh)>T.TimeStamp||(ya.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else if((()=>{var lc;var Ec=null;(lc=T.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&5===lc.length?(Ec=new Nt.a,Ec.Sid=Number.parseInvariant(lc[3]),Ec.Cid=Number.parseInvariant(lc[4]),Ec=new Vh.a(Ec),lc={returnValue:!0,
slideId:Ec}):lc={returnValue:!1,slideId:Ec};({slideId:eb}=lc);return lc})().returnValue){var I=Sg.a.Ble(eb.sid,eb.cid);b.qie(I)>=T.TimeStamp||(I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),Array.add(f,new CS.a(I,0<I.SnapshotTimeStamp?I.SnapshotTimeStamp:T.TimeStamp)))}else if(T.Key.startsWith(Sg.a.X7f))I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),this.yr.W2h(I),ya.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",
I);else if(T.Key===Sg.a.Cfj)I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),ya.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",T.LastRequestCorrelationID,T.TimeStamp,I.length),this.yr.j2h(I);else if(T.Key===Sg.a.zVi)I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),ya.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",
T.LastRequestCorrelationID,T.TimeStamp,KB[I]),this.yr.JBc(I);else if(T.Key===Sg.a.C_i)ya.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",T.LastEditorID,T.LastRequestCorrelationID,T.TimeStamp,T.Value,!1),this.$D.tpl(),this.Iw.HG(this.Yb.qj);else if(T.Key.startsWith(Sg.a.H4f)&&(()=>{a:{var lc=T.Value;let hd;try{const yd=lc?lc.split(","):[];if(3!==
yd.length){hd=Vh.a.Aq(0,0);ya.a.J(508360539,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",lc);var Ec={returnValue:!1,slideId:hd};break a}const Pd=Number.parseInvariant(yd[0]),pe=Number.parseInvariant(yd[1]),Se=yd[2];hd=Vh.a.Aq(Number.parseInvariant(yd[0]),Number.parseInvariant(yd[1]));ya.a.J(508360538,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",Pd,
pe,Se)}catch(yd){ya.a.J(508360537,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",lc,yd.toString());hd=Vh.a.Aq(0,0);Ec={returnValue:!1,slideId:hd};break a}Ec={returnValue:!0,slideId:hd}}({slideId:eb}=Ec);return Ec})().returnValue)ya.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",T.Value),this.ue.ypl(new fM(eb));else if(T.Key.startsWith(Sg.a.AVh)&&
(()=>{{let hd;var lc;let yd;var Ec=null;hd=0;yd=lc=null;const Pd=T.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]"));Pd&&7===Pd.length?(Ec=Pd[1],hd=Number.parseInvariant(Pd[2]),lc=Object.assign(new Nt.a,{Sid:Number.parseInvariant(Pd[3]),Cid:Number.parseInvariant(Pd[4])}),lc=new Vh.a(lc),yd=Pd[6],Ec={returnValue:!0,correlationID:Ec,suggestionCount:hd,slideID:lc,trigger:yd}):Ec={returnValue:!1,correlationID:Ec,suggestionCount:hd,slideID:lc,trigger:yd}}({correlationID:Ra,
suggestionCount:u.m4a,slideID:eb,trigger:u.trigger}=Ec);return Ec})().returnValue)ya.a.J(512497792,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",Ra),I=new LB(Ra,u.m4a,u.m4a,0,u.trigger,eb,T.Value),I.Gzc=new La.a,this.YZe(I);else if(this.Ba.designerIncrementalRenderEnabled&&T.Key.startsWith(Sg.a.qpe)&&(()=>{let lc=VL(T.Key);({correlationID:Ra,suggestionCount:u.m4a,Eca:u.Eca,slideID:eb,trigger:u.trigger,Nob:u.Nob}=lc);
return lc})().returnValue)ya.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",Ra,u.Nob,u.m4a,u.Eca),I=new LB(Ra,u.m4a,u.Eca,u.Nob,u.trigger,eb,T.Value),Ra in u.i7d||(u.i7d[Ra]=this.rOj(Ra,a.items)),I.Gzc=u.i7d[Ra],I.ope=!0,this.YZe(I);else if(T.Key.startsWith(Sg.a.jdg)&&(()=>{var lc;{var Ec=lc=null;const hd=T.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]"));
hd&&5===hd.length?(lc=hd[1],Ec=Object.assign(new Nt.a,{Sid:Number.parseInvariant(hd[2]),Cid:Number.parseInvariant(hd[3])}),Ec=new Vh.a(Ec),lc={returnValue:!0,correlationID:lc,slideID:Ec}):lc={returnValue:!1,correlationID:lc,slideID:Ec}}({correlationID:Ra,slideID:eb}=lc);return lc})().returnValue)ya.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",Ra),this.YZe(new oz(Ra,eb,T.Value));else if(T.Key.startsWith(Sg.a.Gyg)&&
(()=>{{let hd;let yd,Pd;var lc=null;hd=0;var Ec=null;Pd=yd=0;const pe=T.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]"));pe&&7===pe.length?(lc=pe[1],hd=Number.parseInvariant(pe[2]),Ec=Object.assign(new Nt.a,{Sid:Number.parseInvariant(pe[3]),Cid:Number.parseInvariant(pe[4])}),Ec=new Vh.a(Ec),yd=Number.parseInvariant(pe[5]),Pd=Number.parseInvariant(pe[6]),lc={returnValue:!0,correlationID:lc,cga:hd,slideID:Ec,shapeId:yd,WMa:Pd}):lc={returnValue:!1,correlationID:lc,cga:hd,
slideID:Ec,shapeId:yd,WMa:Pd}}({correlationID:Ra,cga:Bb,slideID:eb,shapeId:Ub,WMa:tc}=lc);return lc})().returnValue)ya.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",Ra),this.ue.Nql(new hM(Ra,Bb,eb,Ub,tc,T.Value));else if(T.Key===Sg.a.Ppm)this.w0j();else if(T.Key===Sg.a.nbg&&this.QZg!==T.Value)this.ZVj(T);else if(T.Key===Sg.a.hWh)!Aa.a.Ta(T.Value)&&Aa.a.sEb(T.Value)?(I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),
ya.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",I,this.Xa.xl,this.Xa.podSessionId),240===I?this.vS.hia(1):(432!==I||this.SFe||this.q6f(),this.rJb.$zh(new mF(I)))):(I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),ya.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",
I.Code,!!I.ExtraErrorParam,this.Xa.xl,this.Xa.podSessionId),240===I.Code?this.vS.hia(1):(432!==I.Code||this.SFe||this.q6f(),this.rJb.$zh(new mF(I.Code,I.ExtraErrorParam))));else if(T.Key===Sg.a.hIg)this.aXj(T);else if(T.Key===Sg.a.A5j)ya.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",this.Xa.xl),this.vS.hia(1);else if(T.Key===Sg.a.zkl)I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),this.Yb.Of.bZe=
I,this.ks.Eql(new eM(I));else if(T.Key.startsWith(Sg.a.UYf))ya.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",T.Key),(I=BS(T.Key))&&0<I.length&&this.$D.opl(new aM(I));else if(T.Key.startsWith(Sg.a.Fwg))this.yWj(T);else if(T.Key===Sg.a.Mbg)this.Hbd.Hpl(new YL(T.Value));else if(T.Key.startsWith(Sg.a.mwg)&&(()=>{a:{var lc=T.Key;let hd,yd,Pd;hd=null;yd=0;Pd="";try{const pe=lc.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));
if(pe&&5===pe.length){const Se=Object.assign(new Nt.a,{Sid:Number.parseInvariant(pe[1]),Cid:Number.parseInvariant(pe[2])});hd=new Vh.a(Se);yd=Number.parseInvariant(pe[3]);Pd=pe[4];var Ec={returnValue:!0,slideID:hd,shapeId:yd,nodeId:Pd};break a}}catch(pe){ya.a.J(508360535,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",lc,pe.toString())}Ec={returnValue:!1,slideID:hd,shapeId:yd,nodeId:Pd}}({slideID:eb,shapeId:Ub,
nodeId:Xb}=Ec);return Ec})().returnValue)ya.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.ue.Tpl(new gM(eb,Ub,Xb,T.Value));else if(T.Key===Sg.a.Wnj)this.rJb.Ipl(new bM(T.Value));else if(T.Key.startsWith(Sg.a.iYh)&&(()=>{var lc;var Ec=null;(lc=T.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===lc.length?(Ec=new Nt.a,Ec.Sid=Number.parseInvariant(lc[1]),Ec.Cid=Number.parseInvariant(lc[2]),Ec=new Vh.a(Ec),lc={returnValue:!0,
slideId:Ec}):lc={returnValue:!1,slideId:Ec};({slideId:eb}=lc);return lc})().returnValue)I=new UL(eb,T.Value),I.imageId&&l.push(I);else if(T.Key===Sg.a.Fdj)this.Mw.rhf(parseInt(T.Value));else if(T.Key===Sg.a.DOf)this.Hbd.cpl(new XL(T.Value));else if(T.Key===Sg.a.rDg)this.Hbd.aql(new $L("true"===T.Value.toLowerCase()));else if(T.Key===Sg.a.uIl)this.yr.UHh=T.Value,this.yr.Joh();else if(T.Key===Sg.a.sIl)try{this.yr.$zd=Boolean.parse(T.Value)}catch(lc){ya.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",
lc)}else if(T.Key===Sg.a.ZHg)I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),ya.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",I.toString()),this.$D.eql(new cM(I));else if(T.Key===Sg.a.DAh)I=Sys.Serialization.JavaScriptSerializer.deserialize(T.Value),ya.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",I.toString()),this.$D.Hql(new dM(I));else if(T.Key===
Sg.a.H7j)try{this.yr.Fue=Boolean.parse(T.Value),ya.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.yr.Fue)}catch(lc){ya.a.J(512497751,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",lc)}else if(T.Key===Sg.a.y5j)this.yr.Wsc=T.Value,ya.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.yr.Wsc);else if(T.Key===Sg.a.Zpm)ya.a.J(512497749,
817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.yr.r6h=!0;else if(T.Key===Sg.a.Iyk)ya.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",T.Value),this.yr.U5=T.Value;else if(T.Key===Sg.a.Jyk)ya.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",T.Value),this.yr.xJg=Boolean.parse(T.Value);else if(T.Key===Sg.a.Z3f)try{this.yr.Aab=
Number.parseInvariant(T.Value),ya.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.yr.Aab)}catch(lc){ya.a.J(512497745,843,15,"Can't parse the notification message: {0}",lc)}else if(T.Key===Sg.a.lNf){let lc;try{lc=Boolean.parse(T.Value),this.yr.minorVersionLimitReached=lc}catch(Ec){lc=this.yr.minorVersionLimitReached=!1}lc&&!this.MFe&&(this.Pcj(),this.MFe=!0);ya.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",
T.Value,this.MFe)}else ya.a.J(512497743,817,50,"Notification key ignored {0}",T.Key);ya.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",T.Key,$c.a.Ef(ja),(+new Date-+ja).toString());ua&&!this.av.FHa&&ya.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",T.Key);u.trigger===DS.a.insertPicture&&this.Zll(new iM(!0))}this.Ahm(c,
f,b,l)}rOj(a,b){const c=new La.a;b=Km.e(b,f=>f.Key.startsWith(Sg.a.qpe));for(const f of b)b=VL(f.Key),b.returnValue&&b.correlationID===a&&(1===b.suggestionCount?c.add(b.Nob):1<b.suggestionCount&&c.addRange(AS(f.Value)));return c}Pcj(){this.Ql.oM(24);ya.a.J(512497740,809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}q6f(){this.SFe=!0;this.Ql.oM(25);ya.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}Zll(a){this.ue.Aql(a)}YZe(a){let b;
b=Object(gc.a)(oz,a)?()=>{this.ue.raiseFixItSuggestionUpdatedEvent(Object(gb.a)(oz,a))}:()=>{this.ue.raiseDesignerSuggestionsUpdatedEvent(Object(gb.a)(LB,a))};if(this.av.FHa&&this.Ba.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new ne.a(2,1,0,()=>{b()},90,Object(gc.a)(oz,a)?"114":"92");this.zb.Jb(c)}else b()}Ahm(a,b,c,f){a&&(this.qha.MTj(),this.Vhd.instance&&this.Vhd.instance.Znd());b.forEach(l=>{const u=l.B8b.Id;c.yhm(Sg.a.Ble(u.Sid,u.Cid),l.uia)});this.qha.$Vj(b,f)}w0j(){ya.a.J(512497738,
817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Yb.qj&&this.Yb.qj.Fq&&(this.Yb.qj.Fq.enabled=0);this.fe.iI(158,a=>{a.yD=1;return!1})}ZVj(a){ya.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.$D.Gpl(new mk(!1,!0));let b=null;this.Vhd.instance&&(b=this.Vhd.instance.oRj());this.Iw.syncCurrentSlideIdAndPrefetchRange(this.sa.Aa,b,null,null);this.QZg=a.Value}aXj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);
if(this.Xa.podSessionId!==a)if(this.Ba.ignorePodSessionRefreshedFromPops)ya.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");else{const b=this.Xa.podSessionId;this.Xa.podSessionId=a;this.rJb.vzh(new ri.a(b,a))}else ya.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}yWj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);try{if(a){const b=a.split(";",6);a=!0;
for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)ya.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=Ua.a.Tf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);this.Hbd.Upl(new ZL(c,f,l,parseFloat(b[4]),b[5]))}}else ya.a.J(512497734,817,15,"Response data is null")}catch(b){ya.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}Mpj(){let a=0;const b=[],c=(new Date).getTime(),f=this.u0g;for(const u in f){var l=u;0<c-f[u]&&(a++,delete this.u0g[l])}(0<
a||0<b.length)&&ya.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,rd.a.join(b,","))}see(){this.Mpj()}AUh(){if(this.aXg&&!this.rc.OM)ya.a.J(512497730,801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=Tb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=kh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",this.Ba.podsWebServiceBase),f=
Object.assign(new SL,{BaseDocQueryStringWithoutVersion:A.AFrameworkApplication.mh,SerializedUser:this.Ba.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=A.AFrameworkApplication.userSessionId;l["X-CorrelationID"]=b;a=Fe.c(f);A.AFrameworkApplication.Me.jU(c,2,a,l,[Gg.a.w7],0,u=>{this.LKg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",u.data.cF,u.data.Et,u.data.au,u.data.Ud))},u=>{const I=Tb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");
this.LKg(10,I.n$(u))},null,void 0,void 0,void 0,void 0,ro.a("3"))}}RUh(){var a=Tb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=kh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",this.Ba.podsWebServiceBase),f={};f.PodSID=a;f["X-UserSessionId"]=A.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new TL,{SessionID:a});a=Fe.c(a);A.AFrameworkApplication.Me.jU(c,2,a,f,[Gg.a.w7],0,()=>{ya.a.J(38904456,801,50,
"StopServerRtcConnection - request succeeded")},l=>{const u=Tb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");ya.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",u.n$(l))},null,void 0,void 0,void 0,void 0,ro.a("9"))}LKg(a,b){ya.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}Kba(){this.AUh()}Bz(a,b){b.Xve&&!this.rc.OM&&(ya.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.RUh())}KF(){this.RUh()}}Object(m.a)(nF,
"CoauthNotificationManager",null,[]);class jM{constructor(a,b){this.ybi=a;this.Hpf=b}get coauthoringStartTime(){return this.ybi}get fYf(){return this.Hpf}dPl(a){this.Hpf=a}}Object(m.a)(jM,"CoauthoringDurationRecord",null,[]);var ES=d(975);class kM extends Sys.EventArgs{constructor(a,b,c){c=void 0===c?!1:c;super();this.MPf=a;this.AIg=b;this.Cik=c}}Object(m.a)(kM,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class MB{constructor(a,b,c){this.mpa=this.Uhb=null;this.lgb=[];this.bOg=new v.a;this.k0g=
new v.a;this.BLe=null;this.uRg=!1;this.tLe=0;this.HRg=this.Pcd=!1;this.Khd="";this.UHh=null;this.minorVersionLimitReached=this.r6h=this.xEg=this.$zd=this.abg=!1;this.bLe=null;this.xJg=!1;this.Aab=0;this.u8c=!1;this.KIa=a;this.Nc=b;this.Nbd=0;this.Igb=[];this.Nc.i_d(Object(R.a)(this,this.Lkb,"onPopSessionClosed"));this.uMk=c}get mE(){return this.Uhb}set mE(a){this.Uhb!==a&&(this.Uhb&&0<this.Uhb.length&&2===this.Nbd&&ya.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.Uhb,
a)),this.Uhb=a)}get userName(){return this.mpa}get Fue(){return this.Pcd}set Fue(a){(this.Pcd=a)&&!this.HRg&&eg.Health.instance&&(this.HRg=!0,eg.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.Pcd.toString()))}get Wsc(){return this.Khd}set Wsc(a){a!==this.Khd&&(this.Khd=a,ya.a.J(509670558,804,50,"CoauthStateCache - PopsHostProtocol:{0}",this.Khd))}get U5(){return this.bLe}set U5(a){this.bLe=a;(a=this.uMk.value.instance)?(a.x5d=this.bLe,ya.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",
a.x5d)):ya.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.KIa.gql()}get O0(){const a=[];Array.addRange(a,this.Igb);return a}get Zlm(){return this.O0.length?this.O0.length:1}get amIAlone(){return 2!==this.Iea}get qy(){return this.xJg}get Iea(){return this.Nbd}set Iea(a){this.Nbd!==a&&(ya.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.Nbd=a)}get MEa(){return this.bOg.task}get Mmd(){return this.k0g.task}get wYc(){return this.BLe}set wYc(a){this.BLe||
(this.BLe=a,this.k0g.Jg(a.getTime()))}j2h(a){let b,c;if((()=>{let f=this.Yhm(a);({l1d:b,leaving:c}=f);return f})().returnValue){const f=new kM(b,c,!this.u8c);this.Ntl();this.KIa.Cpl(f)}}Ntl(){const a=[],b=this.O0;for(const c of b)Array.add(a,c.ID)}JBc(a){const b=this.Iea;2===a&&(this.wYc=new Date);0!==b||this.uRg||(ya.a.J(509670553,804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.uRg=!0,this.bOg.Jg(1===a?1:0));this.Iea=a;b!==this.Iea&&(this.KIa.lpl(new ES.a(this.Iea)),this.lhm(this.Iea))}lhm(a){var b=
new Date;2===a?(b=new jM(b,new Date(9999,12,31)),Array.add(this.lgb,b)):(a=this.lgb.length,0<a&&this.lgb[a-1].dPl(b))}W2h(a){this.mE=a;ya.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.mE,this.O0.length);this.KIa.kpl()}Vpb(a){let b;a&&(a=a.toLowerCase());b=null;for(let c=0;c<this.Igb.length;c++){const f=this.Igb[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}Yhm(a){const b=[],c=[],f=[];let l=!1;const u=a?a.length:0;for(let I=0;I<u;I++){const T=
a[I];T&&T.ID&&(T.ID=T.ID.toLowerCase());let ja=null;(()=>{let ua=this.Vpb(T.ID);({editor:ja}=ua);return ua})().returnValue?(l=l||!MB.Ffj(T,ja),Array.remove(this.Igb,ja)):(T.ID!==this.Uhb?Array.add(b,T):this.mpa=T.Name,l=!0);Array.add(f,T)}Array.addRange(c,this.Igb);l=l||0<c.length;this.Igb=f;this.tLe=Math.max(this.tLe,this.Igb.length);eg.Health.instance&&eg.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.tLe.toString());return{returnValue:l,l1d:b,leaving:c}}b_c(a,b){let c=0;const f=
this.lgb.length;if(0<f&&a<this.lgb[f-1].fYf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const u=Math.max(this.lgb[l].coauthoringStartTime.getTime(),a),I=Math.min(this.lgb[l].fYf.getTime(),b);u<I&&(c+=I-u)}}return c}Joh(){this.xEg=!0;this.KIa.Dql()}Lkb(){this.Wsc=""}static Ffj(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(m.a)(MB,"CoauthStateCache",null,[1580,1581]);var iv=d(383);class lm{constructor(){this.KeyRoot=
null;this.TimeStamp=0}}Object(m.a)(lm,"KeyRootSubscription",null,[]);class Uw{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.Ooc=iv.a.empty;this.Mt=[];this.kJa=[];this.KRg=this.BFe=!1;this.jcd=a;this.$He=b;this.Sg=c;this.Yad=ua.rJi;this.qha=f;this.Cbd=l;this.Wj=u;this.RUk=I.K7d(1E3,Object(R.a)(this,this.wij,"ensureVisibleThumbnailsSubscriptionImpl"));this.Nc=T;this.xd=ja;this.Xa=ua;Ra.HYd(this);this.yid=eb;this.NJe=Bb;this.KI=!1;this.yid&&this.Nc.wyi(Object(R.a)(this,this.U2k,"onBackendChanged"));
this.Nc.aC(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"))}eza(){this.KI=!1;this.Cbd.reset();this.Qxg()}Qxg(){Array.clear(this.Mt);this.Ooc=iv.a.empty;this.XCd=this.qha.Gra;this.xd.Avb(()=>{this.XCd=this.qha.Gra});const a=new lm;a.KeyRoot=Sg.a.wgg(this.Yad);a.TimeStamp=0;this.Mt.push(a);var b=new lm;b.KeyRoot=Sg.a.owh;b.TimeStamp=0;this.Mt.push(b);b=new lm;b.KeyRoot=Sg.a.yVi;this.Mt.push(b);var c=new lm;c.KeyRoot=Sg.a.AVh;this.Mt.push(c);c=
new lm;c.KeyRoot=Sg.a.qpe;this.Mt.push(c);c=new lm;c.KeyRoot=Sg.a.Gyg;this.Mt.push(c);c=new lm;c.KeyRoot=Sg.a.H4f;this.Mt.push(c);c=new lm;c.KeyRoot=Sg.a.nbg;this.Mt.push(c);c=new lm;c.KeyRoot=Sg.a.hWh;this.Mt.push(c);const f=new lm;f.KeyRoot=Sg.a.hIg;this.Mt.push(f);const l=new lm;l.KeyRoot=Sg.a.C5j;this.Mt.push(l);var u=new lm;u.KeyRoot=Sg.a.UYf;this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.Fwg;this.Mt.push(u);u=Object.assign(new lm,{KeyRoot:Sg.a.Mbg,TimeStamp:0});this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.mwg;
this.Mt.push(u);this.NJe&&(u=new lm,u.KeyRoot=Sg.a.iYh,this.Mt.push(u));u=new lm;u.KeyRoot=Sg.a.DOf;this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.rDg;this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.ZHg;this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.DAh;this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.jdg;this.Mt.push(u);u=new lm;u.KeyRoot=Sg.a.lNf;this.Mt.push(u);const I=new lm;I.KeyRoot=Sg.a.Z3f;this.Mt.push(I);this.jcd.pzd(this.Mt);this.$He&&(Array.clear(this.kJa),this.kJa.push(b),this.kJa.push(a),this.kJa.push(c),this.kJa.push(f),
this.kJa.push(l),this.kJa.push(u),this.Sg.jH?(this.$He.pzd(this.kJa),this.BFe=!0):(this.Nc.j_d(Object(R.a)(this,this.j1a,"onPopSessionInitialized")),this.KRg=!0))}j1a(){this.BFe||(this.$He.pzd(this.kJa),this.BFe=!0)}get XCd(){return this.Ooc}set XCd(a){iv.a.equals(this.Ooc,a)||(iv.a.equals(a,iv.a.empty)?this.Ooc=iv.a.empty:this.Ooc=iv.a.tAb(a.PU,a.lastIndex),this.RUk.perform())}U2k(a,b){this.KI||(a=b.xbl)&&0<a.length&&(ya.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",
a,this.Xa.RPc),this.eza())}GN(){this.KI=!0}mo(){this.eza()}wij(){const a=this.Mt;var b=this.Cbd;const c=[];var f=null;for(const u of this.XCd.D5){var l=Sg.a.TPj(u);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new lm,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);if(l=this.qha.TBb(u))l=b.qie(Sg.a.Ble(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=l)}f&&c.push(f);Km.d(a,Object(R.a)(this,this.jlj,"fNeedResetBrowserKeySubscription"),u=>{u.TimeStamp=0},1);b=Km.e(a,u=>u.KeyRoot.startsWith(Sg.a.kYh));f=Km.a(c,b,Uw.cze);
Km.a(b,f,Uw.cze);if(b.length||c.length)Km.a(a,b,Uw.cze),Array.addRange(a,c),this.jcd.pzd(a)}jlj(a){return a.KeyRoot.startsWith(Sg.a.wgg(this.Yad))&&!this.Wj.mE?(ya.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),!0):!1}dispose(){this.Nc.F7(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.Wba(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.KRg&&this.Nc.x3e(Object(R.a)(this,this.j1a,
"onPopSessionInitialized"))}static cze(a,b){return a.KeyRoot===b.KeyRoot}}Object(m.a)(Uw,"CoauthSubscriptionManager",null,[1582,106,174]);class lM extends Sys.EventArgs{constructor(){super();this.items=null}}Object(m.a)(lM,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class mM{constructor(a,b,c,f,l,u){this.id=kh.a.create();this.lbd=a;this.ff=b;this.Xa=c;this.Ba=l;this.fe=f;this.rZ=u}DZj(a,b){this.rZ&&!this.lbd.r1&&this.rZ.iVc(a.c_);a&&a.Ys&&0<a.Ys.length&&this.ff.jLa(a.Ys);$c.a.gz(this.ff,()=>{this.lbd.fph(this.id,
a.result,a.c_,b)})}CZj(a,b,c){if(!this.lbd.r1&&(this.rZ&&this.rZ.iVc(a.c_),a&&a.error&&this.Ba.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Bn===jg.a.hi(223))){ya.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",this.Xa.podSessionId||"NULL");this.fe.At(Object.assign(new vl.a,{Code:223,Source:6}),c);return}$c.a.gz(this.ff,()=>{this.lbd.fph(this.id,null,a.c_,b)})}}Object(m.a)(mM,"LongPollingResponseHandler",null,
[]);var FS=d(902);class oF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.NJa=this.JJa=null;this.c_g=kh.a.nil;this.vKb=this.yZa=0;this.YOg=[10,100,1E3,1E4];this.q_a=null;this.gZ=[];this.g6=Ra?"GetPopWacUpdates":"GetUpdates";this.fba=a;this.Xa=c;this.Sg=f;this.Nc=l;this.zga=u;this.fe=I;this.rc=T;this.rZ=ja;this.Nc.aC(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.D9a(Object(R.a)(this,this.Nha,"onSessionRehydrating"));this.Nc.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"));Ra&&(this.Nc.j_d(Object(R.a)(this,
this.j1a,"onPopSessionInitialized")),this.Nc.i_d(Object(R.a)(this,this.Lkb,"onPopSessionClosed")));this.xPe=a.J$l;this.lfd=a.Tmk;this.tJb=a.Quh;this.sIb=[];b.Ecb().HYd(this);this.gUk=ua;this.mhi=Ra;this.Tna=!1;this.oJb=Ra?3E4:6E4}GN(){this.close("SessionClosed")}Nha(){this.q_a&&this.q_a.TDd()}mo(){this.hmb("SessionRehydrated")}fph(a,b,c,f){this.JJa=null;const l=+new Date-+this.NJa;if(this.Tna)ya.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",
this.g6);else if(a.equals(this.c_g))if(this.r1&&this.Tna)ya.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.g6);else if(a=this.Sg.dga,f&&f.length&&a!==f)ya.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",this.g6,b?"Success":"Failure",
this.Xa.xl,this.Sg.dga,f,this.vKb,this.xPe),this.vKb++,this.Uag(l,this.vKb)||this.Twc(this.xPe);else if(this.vKb=0,b){this.NJa=new Date;this.yZa=0;this.Sg.vze=this.NJa;this.Sg.uze=f;ya.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",this.g6,l,$c.a.Ef(new Date),this.r1?this.Xa.xl:"Not Applicable");c=0;f={};for(const u of b.Items)u.TimeStamp>c&&(c=u.TimeStamp),f[u.LastRequestCorrelationID]=u.LastRequestCorrelationID in
f?String.format("{0},{1}",f[u.LastRequestCorrelationID].toString(),u.Key):u.Key,Km.d(this.sIb,I=>u.Key.startsWith(I.KeyRoot),I=>{u.TimeStamp>I.TimeStamp&&(I.TimeStamp=u.TimeStamp)},1);this.Twc(this.xPe);0<Object.keys(f).length&&$c.a.Xk("RequestCorrelationIDsAndKeyRoots",Xk.c(f));c=new Date;$c.a.gz($c.a.Kb,()=>{const u=Object.assign(new lM,{items:b.Items});for(const I of this.gZ)try{I(this,u)}catch(T){ya.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",
this.g6,T.toString(),T.stack)}});$c.a.Xk("ProcessItemStartTime",$c.a.Ef(c));$c.a.Xk("ProcessItemDurationInMS",(+new Date-+c).toString());$c.a.Kb.finish()}else ya.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",this.g6,l,c?c.status:3,c?c.Ke:-1,this.Xa.podSessionId,this.r1?this.Xa.xl:"Not Applicable"),this.Uag(l,this.yZa)||(f=3<=this.yZa?this.YOg[3]:this.YOg[this.yZa],
this.yZa++,this.Twc(f),$c.a.Xk("FailureCountSinceLastSuccess",this.yZa.toString()),$c.a.Xk("NextDelayInMS",f.toString()),c&&($c.a.Xk("RequestStatus",sp.a[c.status]),$c.a.Xk("HttpStatus",c.Ke.toString()),$c.a.Xk("Duration",(+c.au-+c.Et).toString())),$c.a.Kb.finish());else ya.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",this.g6)}Uag(a,b){return this.r1&&(a>=this.tJb||b>this.fba.getHostSessionInfoMaxRetryCount)?(ya.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",
this.g6,b,this.Xa.xl,this.Sg.jH),!0):!1}close(a){ya.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.g6,a);this.Tna=!0;this.q_a&&this.q_a.TDd()}Twc(a){const b=$c.a.Zj(this.g6,2);b.Wa("DelayInMS",a.toString());this.lfd?$c.a.nca(()=>{$c.a.gz(b,Object(R.a)(this,this.guh,"performCall"))},a,0):window.setTimeout(()=>{$c.a.gz(b,Object(R.a)(this,this.guh,"performCall"))},a)}guh(){if(!this.enabled||A.AFrameworkApplication.Dh||this.JJa&&+new Date-+this.JJa<this.oJb||this.r1&&!this.rc.OM||
this.zga.P7c)ya.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",this.g6,this.enabled,A.AFrameworkApplication.Dh,this.JJa?$c.a.Ef(this.JJa):"null",$c.a.Ef(new Date),this.oJb,this.zga.P7c,!this.rc.fp,!this.rc.OM);else{var a=kh.a.create().toString();ya.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",
this.g6,this.JJa?$c.a.Ef(this.JJa):"null",$c.a.Ef(new Date),this.oJb,this.r1?this.Xa.xl:"Not Applicable",a);if(!this.r1){var b=Km.e(this.sIb,u=>u.KeyRoot===Sg.a.owh);b&&b.length&&ya.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.JJa=new Date;b=$c.a.Kb;var c=new mM(this,b,this.Xa,this.fe,this.fba,this.r1?null:this.rZ);this.c_g=c.id;this.q_a=new FS.a;var f=this.r1?this.Xa.xl:"",l=this.r1?"":this.Xa.podSessionId;b.Wa(Ii.a.hyb,a);this.gUk(f,this.Xa.presentationId.string,
this.sIb,u=>{c.DZj(u,f)},u=>{c.CZj(u,f,l)},this.q_a,{["X-CorrelationId"]:a},null,this.oJb)}}get enabled(){return 0<this.sIb.length&&!this.Tna}get r1(){return this.mhi}j1a(){this.hmb("PopSessionInitialized")}Lkb(){this.close("PopsUninitialized")}pzd(a){a||(a=[]);ya.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.g6,a.length);for(const b of a);this.sIb=a;this.NJa=new Date;this.vKb=this.yZa=0;this.Twc(0)}NLf(a){Array.add(this.gZ,a)}eza(){this.hmb("AppListener:OnReboot")}hmb(a){ya.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.g6,a,this.r1?this.Xa.xl:"Not Applicable");this.r1&&"PopSessionInitialized"===a&&this.TFl();this.Tna=!1;this.JJa=null;this.NJa=new Date;this.vKb=this.yZa=0;this.q_a&&this.q_a.TDd();this.Twc(0)}TFl(){for(const a of this.sIb)a.TimeStamp=0}dispose(){this.Nc.F7(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.A3e(Object(R.a)(this,this.Nha,"onSessionRehydrating"));this.Nc.Wba(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.r1&&
(this.Nc.lEh(Object(R.a)(this,this.Lkb,"onPopSessionClosed")),this.Nc.x3e(Object(R.a)(this,this.j1a,"onPopSessionInitialized")))}}Object(m.a)(oF,"DocNotifyClient",null,[928,106,929,174]);class pF{constructor(){this.vFb=0}}Object(m.a)(pF,"TimeStampData",null,[]);class nM{constructor(){this.axa={}}reset(){this.axa={}}copy(a){this.reset();a=a.axa;for(const f in a){var b=f,c=a[f];const l=new pF;l.vFb=c.vFb;this.axa[b]=l}}yhm(a,b){var c=a in this.axa?this.axa[a]:new pF;this.axa[a]=c;c=this.axa;for(const l in c){var f=
c[l];l.startsWith(a)&&(f.vFb=b)}}qie(a){var b=!1;b=void 0===b?!1:b;if(!b&&a in this.axa)return this.axa[a].vFb;if(b){b=0;const f=this.axa;for(const l in f){var c=f[l];l.startsWith(a)&&c.vFb>b&&(b=c.vFb)}return b}return 0}}Object(m.a)(nM,"HermesContentTimeStampManager",null,[930]);var pz=d(300);class qz{constructor(a,b,c,f){this.gwe=a;this.wha=b;this.Xpc=c;this.Aa=void 0===f?null:f}}Object(m.a)(qz,"SlideMoveData",null,[]);var GS=d(660),rk=d(299);class oM{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,
Ub){this.sjc=this.jxa=null;this.xV=0;this.ZG=null;this.LHe=0;this.mbd=null;this.uIe=this.Rfd=this.NUg=this.PUg=0;this.zK=this.FKa=this.VY=null;this.Zoa=this.Zfd=0;this.Vq=a;this.Fa=b;this.ia=c;this.Yb=f;this.sa=l;this.av=u;this.Wb=I;this.rc=T;this.fv=ja;this.l2=this.Vq.N2;this.zxa=ua;this.oa=Ra;this.Ar=eb;this.ho=Bb;this.Hwa=Ub}I9j(){this.xV=-1;this.jxa=document.createElement("div");this.jxa.style.visibility=Hf.a.Vt;this.jxa.className=rk.a.tej;this.l2.appendChild(this.jxa);this.LHe=this.Zoa=this.Zfd=
0;if(this.Hwa){this.sjc=document.createElement("div");this.sjc.className=rk.a.NSj;const a=document.createElement("span");a.className=rk.a.OSj;this.sjc.appendChild(a)}}dispose(){this.l2.removeChild(this.jxa);this.av.dG(this.l2,this);this.jxa=this.ZG=null}Ew(a){return a?this.lK(a).returnValue:!1}lK(a){if(3===a.wg||a.xB!==Sys.UI.MouseButton.leftButton||!this.l2.contains(a.Ec)||!this.rc.fp)return{returnValue:!1,mzb:null,B5:null};var b=a.clientPoint.y-this.cff+this.l2.scrollTop;a=a.clientPoint.x-this.l2.offsetLeft;
this.fv&&(a-=this.l2.offsetWidth-this.l2.clientWidth);a=this.RPj(a,b);if(!a||!a.NM)return{returnValue:!1,mzb:a,B5:null};if(this.Hwa){const f=this.oa.Xe();if(1>f.length)return{returnValue:!1,mzb:a,B5:null};for(var c of f)if(c.hP||32!==this.ia.Ia(M.a.n0e,1,c.Fb))return{returnValue:!1,mzb:a,B5:null};c=this.Vq.z_-this.oa.Xe().length+1;this.NUg=Math.min(this.Mgg(b),c);this.PUg=Math.min(a.slideIndex,c-1)}else if(b=a.slideId,Vh.a.Cx(b)||32!==this.ia.Ia(M.a.n0e,1,b))return{returnValue:!1,mzb:a,B5:null};return{returnValue:!0,
mzb:a,B5:null}}Qv(a){if(!a)return!1;this.jxa||this.I9j();this.mbd=GS.a(0,0);let b;if(!(()=>{let T=this.lK(a);({mzb:this.VY,B5:b}=T);return T})().returnValue)return!1;if(this.ho){var c=!1,f=this.VY.slideId,l=this.oa.Xe();for(var u of l)if(u.Fb.equals(f)){c=!0;break}if(c){if(this.zK=this.sa.Aa,1<l.length&&!this.Hwa)return!1}else this.oa.Bh(),this.zK=this.VY.gd,this.oa.sQ(this.VY.gd)}if(this.Hwa){this.Q3h();var I=this.VY.QCb;c=I.cloneNode(!0);f=c.getElementsByTagName("img")[0];this.$Lh(f,rk.a.ime,rk.a.hme,
rk.a.Xcg,rk.a.Xcg);c.className=rk.a.crg;l=this.oa.Xe();u=1;if(1<l.length){for(let T=0;T<l.length;T++)if(this.VY.slideIndex!==l[T].slideIndex){u++;I=this.Vq.YO(l[T].slideIndex).QCb;I=(I=I.getElementsByTagName("img"))&&0<I.length?I[0].cloneNode(!0):f.cloneNode(!0);const ja=rk.a.hme*u;this.$Lh(I,rk.a.ime-u,rk.a.hme-1,ja,ja);c.appendChild(I);if(3===u)break}c.appendChild(this.sjc);this.sjc.firstChild.innerText=this.oa.Xe().length.toString()}this.ZG?this.Vq.N2.replaceChild(c,this.ZG):this.Vq.N2.appendChild(c);
this.ZG=c}else c=this.VY.QCb,this.ZG?(c=this.ZG.getElementsByTagName("img"),f=b.cloneNode(!0),f.style.zIndex=String(rk.a.ime),this.ZG.replaceChild(f,c[0]),this.ZG.style.zIndex=String(rk.a.LSj)):(this.ZG=c.cloneNode(!0),this.Vq.N2.appendChild(this.ZG),this.ZG.className=rk.a.crg);this.LHe=parseInt(fg.a.Tu(this.ZG).height);Df.a.Oqa(this.ZG,rk.a.xsh+rk.a.Qrh+rk.a.byg,this.fv);this.ZG.style.visibility=Hf.a.AA;this.ZG.style.cursor=Hf.a.zzc;ya.a.J(512497671,819,50,"PPT drag slide start.");this.Px(a);return!0}Q3h(){this.Rfd=
this.NUg;this.uIe=this.PUg;let a=0;for(let b=0;b<this.Vq.z_;b++){const c=this.Vq.YO(b);c.isSelected?c.YBc(-2):(a===this.VY.slideIndex&&(a+=1),c.YBc(a),a++)}}$Lh(a,b,c,f,l){a.className=rk.a.KSj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}Px(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.cff+this.l2.scrollTop,f=this.LHe/2;if(this.zxa){if(E.a.iV&&!a.hc.rawEvent.buttons)return ya.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),
!1;this.ZG.style.top=Math.min(c-f,this.Hwa?pz.a.HW+(this.Vq.z_-this.oa.Xe().length)*this.Vq.yua:pz.a.HW+this.Vq.z_*this.Vq.yua)+"px"}else{a=this.Obc(this.Vq.z_)+this.Vq.yua/2;if(this.llj(b.x)||c>a)return this.FMh(),!0;this.ZG.style.top=c-f+"px"}this.ZLh(!0);this.ARi(b.y);this.HPl(Math.min(this.Mgg(c),this.Hwa?this.Vq.z_-this.oa.Xe().length+1:this.Vq.z_));this.jxa.style.visibility=this.p8c(b)&&!this.Hwa?Hf.a.AA:Hf.a.Vt;if(this.Hwa&&0<=this.xV)if(this.p8c(b)){this.ZG.style.visibility=Hf.a.AA;if(this.Rfd===
this.xV)return!0;b=this.Rfd<this.xV?0>this.xV-1?0:this.xV-1:0>this.xV?0:this.xV;c=0;for(f=0;f<this.Vq.z_;f++)a=this.Vq.YO(f),a.isSelected||(c<b?a.YBc(c):a.YBc(c+1),c++);this.Rfd=this.xV;this.uIe=b}else this.Q3h(),this.ZG.style.visibility=Hf.a.Vt;return!0}Uo(a){if(!this.sa.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.Hwa){if(a=this.oa.Xe(),0<a.length&&0<=this.xV&&this.p8c(b)){b=[];for(const c of a)c&&b.push(Object(gb.a)(267,c));this.D$l(b,this.dNj(this.uIe));
ya.a.J(512497669,819,50,"PPT drag slide succeed.")}}else 0<=this.xV&&this.VY&&this.p8c(b)&&this.VY.slideIndex!==this.xV&&this.VY.slideIndex+1!==this.xV&&(this.x$l(this.VY.slideIndex,this.xV),ya.a.J(512497668,819,50,"PPT drag slide succeed."));this.jM()}dNj(a){let b=0;for(let c=0;c<this.Vq.z_;c++)if(!this.Vq.YO(c).isSelected&&(b++,a===b))return c+1;return 0}p8c(a){a=a.x>=this.l2.offsetLeft&&a.x<=this.l2.offsetLeft+this.l2.offsetWidth;return!this.zxa||a}rv(){this.jM()}RPj(a,b){if(!this.Vq.yua)return null;
var c=Math.floor((b-pz.a.HW)/this.Vq.yua);if(0<=c&&c<=this.Vq.z_-1){c=this.Vq.YO(c);if(!c)return null;const f=c.wpb;a=this.fv?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}llj(a){return this.fv?this.mbd.width-rk.a.l7f>a||this.mbd.width<a:0>a||rk.a.l7f<a}ARi(a){const b=a-this.cff,c=this.mbd.height;if(rk.a.zQf>b)this.Zoa=-rk.a.yQf;else if(rk.a.BQf>
b)this.Zoa=-rk.a.AQf;else if(rk.a.DQf>b)this.Zoa=-rk.a.CQf;else if(c-rk.a.zQf<a)this.Zoa=rk.a.yQf;else if(c-rk.a.BQf<a)this.Zoa=rk.a.AQf;else if(c-rk.a.DQf<a)this.Zoa=rk.a.CQf;else{this.Zoa=0;return}this.fuh()}fuh(){if(0!==this.Zoa){const a=this.Zfd,b=(new Date).getTime();0<a&&(this.l2.scrollTop=Math.max(0,this.l2.scrollTop+Math.floor((b-a)*this.Zoa/1E3)));this.Zfd=b;window.setTimeout(Object(R.a)(this,this.fuh,"performAutoScrolling"),rk.a.kHi)}else this.Zfd=0}Obc(a){return this.Vq.yua*a+pz.a.HW*(this.zxa?
.75:1)}Mgg(a){a+=this.Vq.yua/2;a-=pz.a.HW;a=Math.floor(a/this.Vq.yua);return this.zxa?Math.max(0,a):a}HPl(a){this.xV!==a&&(this.xV=a,0>this.xV||(this.jxa.style.top=Df.a.Rc(this.Obc(a))))}FMh(){this.ZLh(!1)}ZLh(a){this.ZG.style.cursor=a?Hf.a.zzc:Hf.a.A6l}x$l(a,b){const c=this.sa.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.FKa=rd.a.clone(this.sa.presentation.YF))&&!(b>this.FKa.length||a>=this.FKa.length)){var f=null;a=c.Kke(a);b&&(f=c.Kke(b-1));b=new qz(!1,[a],f);this.ia.Ia(M.a.eqc,
2,b)}}D$l(a,b){const c=this.sa.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.FKa=rd.a.clone(this.sa.presentation.YF))||b>this.FKa.length||!this.Jlk(a,b)||(b=b?c.Kke(b-1):null,a=new qz(!1,a,b,this.zK),this.ia.Ia(M.a.eqc,2,a))}Jlk(a,b){const c=Object.assign(new La.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);c.Sc((l,u)=>l-u);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}jM(){this.Cgm();this.FMh();this.ZG.style.visibility=
Hf.a.Vt;this.ZG.style.top="0px";this.ZG.style.cursor=Hf.a.LB;this.jxa.style.visibility=Hf.a.Vt;if(this.Hwa){const a=this.Ar.xe(3);try{const b=this.sa.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.rd(b);a.INa(this.Vq.Na);const c=b.slides||[];for(const f of c){const l=Object(gb.a)(205,f);l&&l.anchor.Rk(this.Vq.Na,16)}}finally{a&&a.dispose()}this.Vq.V2a()}this.Zoa=0;this.VY&&(this.VY=null);this.Fa.Je&&this.Fa.Je.name===xc.a.aG||this.Fa.Df(xc.a.aG)}Cgm(){this.ho?this.zK&&(this.Yb.Aa=
this.Wb.Qk(this.zK.Fb)):this.VY&&(this.Yb.Aa=this.VY.gd)}get cff(){let a=this.l2,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(m.a)(oM,"ThumbnailNavPaneDragAdapter",null,[937,363,106]);class qF{}qF.jsi=[M.a.print,M.a.find,M.a.b3,M.a.Sab,M.a.lsd,M.a.ksd,M.a.bringForward,M.a.bringToFront,M.a.sendBackward,M.a.sendToBack,M.a.tla,M.a.YCd,M.a.ZCd,M.a.C4a,M.a.B4a,M.a.ypb,M.a.xpb,M.a.X3a,M.a.pSb,M.a.fUb,M.a.Xwc,M.a.R7,M.a.r_,M.a.pXa,M.a.Dob,M.a.Eob,M.a.Fob,M.a.Gob,M.a.lwc,M.a.mwc,M.a.nwc,M.a.owc,
M.a.Ewd,M.a.Ewc,M.a.x5e,M.a.Fwd,M.a.I$a,M.a.pVa,M.a.hfa,M.a.y3a,M.a.z3a,M.a.A3a,M.a.gyc,M.a.IRb,M.a.pRb,M.a.GRb,M.a.Wnb,M.a.job,M.a.QJ,M.a.uR,M.a.m7,M.a.hkb,M.a.ekb,M.a.gkb,M.a.fkb,M.a.P1a,M.a.O1a,M.a.O_k,M.a.Mkl,M.a.NVi,M.a.OVi,M.a.GRe,M.a.HRe,M.a.IRe,M.a.JRe,M.a.Lal,M.a.vWi,M.a.deleteComment,M.a.cDb,M.a.a5c,M.a.lEl,M.a.P_k,M.a.Nkl,M.a.HAc,M.a.BAc,M.a.DAc,M.a.CAc,M.a.GAc,M.a.FAc];Object(m.a)(qF,"ActionHandledList",null,[]);class Ot{constructor(a,b,c,f){this.v2=new al.a;this.cOe=new al.a;this.ia=
a;this.Ba=b;this.oa=c;this.ih=f;this.j9j();this.k9j()}HWj(a,b,c){c=void 0===c?null:c;this.Ba.remapShapeEditCommandEnabled&&((this.oa.nI()||this.oa.Js())&&this.v2.Ib(a)?a=this.v2.ga(a):this.oa.kz()&&this.cOe.Ib(a)&&(a=this.cOe.ga(a)));if(this.Ba.podsTableRTTEnabled&&this.Ba.podsTableCellLockEnabled&&Array.contains(Ot.XIl,a)&&(this.oa.P$()||this.oa.rlk()))return 32;if(!Array.contains(qF.jsi,a))return this.ia.Ia(a,2,b,c);const f=this.ia.oq,l=this.ia.eV;let u=this.ia.Ia(a,1,b);32===u&&(this.Ba.pptDragCancelFix&&
(this.ia.oq=f,this.ia.eV=l),u=this.ia.Ia(a,2,b,c));return u}zXl(a){return this.ih.Mzb!==a&&this.ih.Nzb!==a}dAb(a,b,c){return b&&b.name===xc.a.Ag&&!this.oa.Js()&&1===this.oa.Hd().length&&this.oa.kz()&&this.zXl(c)?a.dAb(a.Kc(b.parent),c):a.dAb(b,c)}j9j(){this.v2.$(G.a.upArrow,M.a.Gob);this.v2.$(G.a.downArrow,M.a.Dob);this.v2.$(G.a.leftArrow,M.a.Eob);this.v2.$(G.a.rightArrow,M.a.Fob);this.v2.$(G.a.KRb,M.a.owc);this.v2.$(G.a.kob,M.a.lwc);this.v2.$(G.a.J3a,M.a.mwc);this.v2.$(G.a.K3a,M.a.nwc);this.v2.$(G.a.Jua,
M.a.Xwc);this.v2.$(G.a.U0a,M.a.ypb);this.v2.$(G.a.T0a,M.a.xpb);this.v2.$(M.a.tla,M.a.Y9a);for(const a of Ot.uJl)this.v2.$(a,N.a.Ce)}k9j(){for(const a of Ot.vJl)this.cOe.$(a,N.a.Ce)}}Ot.uJl=[G.a.dFa,G.a.eFa,G.a.j7b,G.a.wyb,G.a.$Ta,G.a.aUa,G.a.oab,G.a.ZTa,G.a.dkb,G.a.XUa,G.a.jbb,G.a.ckb,G.a.WUa,G.a.ibb];Ot.vJl=[M.a.Sab,M.a.pVa,M.a.hfa,M.a.fUb];Ot.XIl=[G.a.backspace,G.a.PJ,M.a.I$a];Object(m.a)(Ot,"ProcessInputStrategy",null,[935]);class pM{get oSc(){return[361033,9175267,13924352,749464,2893476,15559503,
11745730,8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(m.a)(pM,"PPTColorTable",null,[927]);var HS=d(976);class qM{constructor(){this.mjd={}}fhe(a){return a&&a in this.mjd?this.mjd[a]:null}jSf(a,b){a&&b&&a!==b&&(a in this.mjd||(this.mjd[a]=b))}}Object(m.a)(qM,"PresenceEmailConverter",null,[1574]);var rM=d(921),rz;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";
a[a.fHasTabSwitch=3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=
12]="peoplesWellInited";a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=
20]="presence1JsLoadStart";a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";
a[a.presenceCount=30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";
a[a.receivedCompletePeristentState=39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(rz||(rz={}));Object(m.b)("EntryName",rz);class sM{constructor(a,b,c,f){this.Hp=null;this.UMe=this.Ahd=0;this.gKe=this.FVg=this.xJe=this.vfd=!1;this.LBe=this.MBe=this.WHe=this.fCe=this.sHe=0;this.qbd=this.AFe=null;this.aid=new v.a;this.$9g=new v.a;this.M1g=new v.a;this.mGe=this.rGe=!1;this.Fmc=a;this.CNe=b;this.Wj=c;f.execute(l=>{this.Hp=l});this.pZ={};wb.Task.WAA(this.Wj.MEa,
this.aid.task,this.$9g.task).continueWith(()=>{try{this.yLh(),this.LWc(this.pZ),0<Qa.a.count(this.pZ)&&da.ULS.sendTraceTag(51242144,814,15,Qa.a.toJSON(this.pZ)),this.rGe=!0}catch(l){da.ULS.sendTraceTag(508694609,814,10,l.toString())}});wb.Task.WAA(this.Wj.MEa,this.M1g.task).continueWith(()=>{try{this.yLh(),this.LWc(this.pZ),0<Qa.a.count(this.pZ)&&da.ULS.sendTraceTag(594879178,814,15,Qa.a.toJSON(this.pZ)),this.mGe=!0}catch(l){da.ULS.sendTraceTag(508694608,814,10,l.toString())}});this.dcd={};this.zHe=
{}}Fhj(a){this.HNc(a,8,"g_hermesPresenceJS");this.HNc(a,20,"g_hermesPresence1JS");this.HNc(a,18,"g_JquerySignalRMergeJS");this.HNc(a,19,"g_JquerySignalRMergeJSEnd")}HNc(a,b,c){b=rz[b];b in a||(c=this.DDj(c),0<c&&this.Gka(a,b,c))}DDj(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.Adg();this.Ppj();this.K0h();this.pZ=this.zHe=this.dcd=null}Ohj(){this.SDa(25)}Nhj(){this.SDa(12)}KCk(){this.SDa(15);0<this.appInitChromeReady&&this.SDa(16)}Jhj(a){try{this.Ahd||(this.Ahd=a,this.Ei(17,
this.Ahd),this.Ei(13,this.Wjg(this.B2I,this.Ahd)),this.M1g.sL(!0))}catch(b){da.ULS.sendTraceTag(508694607,814,10,b.toString())}}Rzk(a,b){this.Ei(6,a);this.Ei(5,b)}Khj(){this.UMe||(this.UMe=Date.now(),this.Ei(31,this.UMe),this.Adg())}Lhj(){this.SDa(28)}Mhj(){this.SDa(27)}Bdl(a){const b=[];for(const f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}Phj(a){a&&(a=this.Bdl(a),this.Ei(38,a.length),this.Ei(37,0<a.length),this.SDa(39));this.$9g.Jg(!0)}rAk(a){try{this.aid.task.isCompleted||Qa.a.Ta(a)||
(this.SDa(34),this.aid.sL(!0))}catch(b){da.ULS.sendTraceTag(508694606,814,10,b.toString())}}sAk(a){if(!(Qa.a.Ta(a)||"presenceUpdateNotificationReceived"in this.pZ)){var b=Date.now();this.Ei(33,b);this.WHe=this.Wjg(this.B2I,b);this.Ei(32,this.WHe);this.Ei(30,Qa.a.count(a));this.Hp&&this.Ei(29,this.Hp.mbg)}}rlj(){return!this.aid.task.isCompleted&&(!this.Hp||!this.Hp.mbg)&&!this.WHe}qAk(){this.SDa(35);this.Wj.wYc&&this.Ei(36,this.Wj.wYc.getTime())}dij(){this.CNe&&!this.vfd&&(this.vfd=!0,this.CNe.rLf(Object(R.a)(this,
this.vrc,"onResourceTimingEntriesAvailable")))}vrc(a,b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=oe.a.Vba(f.url);!this.xJe&&l.endsWith("rtc2/signalr/negotiate")?(this.xJe=!0,this.bOc(a,"Negotiate",f.hD)):l.endsWith("rtc2/signalr/connect")?(this.FVg=!0,this.bOc(a,"Connect",f.hD)):!this.gKe&&l.endsWith("rtc2/signalr/start")?(this.gKe=!0,this.bOc(a,"Start",f.hD)):l.endsWith("rtc2/findsession")&&(this.bOc(a,this.sHe.toString()+"_FindSession",f.hD),this.sHe++)}if(this.xJe||this.FVg||
this.gKe||0<this.sHe)this.K0h(),this.zdg(a)}catch(c){da.ULS.sendTraceTag(508694605,814,10,c.toString())}}bOc(a,b,c){this.Gka(a,b+"FS",c.fetchStart);this.Gka(a,b+"RS",c.responseStart);this.Gka(a,b+"RE",c.responseEnd)}K0h(){this.vfd&&(this.vfd=!1,this.CNe.FDh(Object(R.a)(this,this.vrc,"onResourceTimingEntriesAvailable")))}SDa(a){this.Ei(a,Date.now())}Ei(a,b){this.Tti(rz[a],b)}Tti(a,b){this.Gka(this.dcd,a,b);this.Gka(this.pZ,a,b)}Gka(a,b,c){b in a||(a[b]=c)}LWc(a){this.Fhj(a);this.Gka(a,"B2I",this.B2I);
null!=this.fHasTabSwitch&&this.Gka(a,"fHasTabSwitch",this.fHasTabSwitch);null!=this.qbd&&this.Gka(a,"firstCoauthoringStatus",this.qbd);this.appInitInteractivityReady&&this.Gka(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.Gka(a,"appInitChromeReady",this.appInitChromeReady)}yLh(){null==this.qbd&&(this.qbd=this.Wj.MEa.result)}Adg(){this.zdg({})}zdg(a){try{this.LWc(this.dcd),Qa.a.forEach(this.dcd,(b,c)=>{b in this.zHe||(this.zHe[b]=c,a[b]=c)},null),0<Qa.a.count(a)&&
da.ULS.sendTraceTag(41239941,828,50,Qa.a.toJSON(a))}catch(b){da.ULS.sendTraceTag(508694604,814,10,b.toString())}}Ppj(){da.ULS.sendTraceTag(508694603,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.rGe,this.mGe);if(!this.rGe||!this.mGe)try{this.LWc(this.pZ),0<Qa.a.count(this.pZ)&&da.ULS.sendTraceTag(508694602,814,50,Qa.a.toJSON(this.pZ))}catch(a){da.ULS.sendTraceTag(508694601,814,10,a.toString())}}get B2I(){!this.fCe&&Mg.a.instance.Ml(ii.a.contentEditable)&&(this.fCe=
Mg.a.instance.hh(ii.a.contentEditable));return this.fCe}get appInitInteractivityReady(){!this.MBe&&Mg.a.instance.Ml("AppInitStatus_interactivityReady")&&(this.MBe=Mg.a.instance.hh("AppInitStatus_interactivityReady"));return this.MBe}get appInitChromeReady(){!this.LBe&&Mg.a.instance.Ml("AppInitStatus_chromeReady")&&(this.LBe=Mg.a.instance.hh("AppInitStatus_chromeReady"));return this.LBe}get fHasTabSwitch(){null==this.AFe&&Mg.a.instance.Ml(ii.a.aGd)&&(this.AFe=Mg.a.instance.hh(ii.a.aGd));return this.AFe}Wjg(a,
b){return this.Fmc?this.Fmc.tmg(new Date(a),new Date(b)):-1}}Object(m.a)(sM,"PresencePerfLogger",null,[932,106]);class tM{constructor(a,b,c){this.wah=this.yjc=this.zcd=this.mpa=null;this.UEe=!1;this.QNe=null;this.Oi=a;this.fba=b;this.yr=c}F2c(){this.Ezb();return this.mpa}oAj(){this.Ezb();return this.zcd}tBj(){return this.Oi?this.Oi.FindSessionResponse:null}Qig(){this.Ezb();return this.yjc}GKj(){this.Ezb();return this.wah}EKj(){this.Ezb();return this.QNe}$zd(){this.Ezb();return this.UEe}HCk(){if(this.Oi){const a=
!!this.Oi.PresenceException,b=!isNaN(this.Oi.PresenceDownloadEditorTableHttpStatus)&&200!==this.Oi.PresenceDownloadEditorTableHttpStatus||!isNaN(this.Oi.PresenceFindSessionHttpStatus)&&200!==this.Oi.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.fba.presenceEarlyFindSessionEnabled;c.EditorCount=this.zcd?this.zcd.length:0;c.ShouldConnectToRtcByDefault=this.UEe;c.EditorTableHttpStatus=this.Oi.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.Oi.PresenceFindSessionHttpStatus;
c.CachedException=this.Oi.PresenceException;c.IsFindSessionResponseEmpty=!this.Oi.FindSessionResponse;c.IsEditorTableResponseEmpty=!this.Oi.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.QNe;ya.a.J(41501202,804,a||b?15:50,Qa.a.toJSON(c))}}Ezb(){if(this.Oi&&!this.mpa)try{if(this.Oi.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.Oi.CoauthHandlerResponse);this.zcd=a.EditorTable;this.mpa=a.UserName;this.yjc=a.Email;this.wah=a.RtcEndpointUrl;this.UEe=a.FConnectByDefault;
this.QNe=a.RtcBootToken;this.yr.Joh()}}catch(a){ya.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+a)}}}Object(m.a)(tM,"PresencePrepCacheParser",null,[940]);class rF{constructor(a,b,c,f){f=void 0===f?5E3:f;if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=A.AFrameworkApplication.userSessionId;this.Lwd=A.AFrameworkApplication.Lwd;this.vea=A.AFrameworkApplication.Me;this.Xx=b;this.$Kh=c;this.THh=f}}Object(m.a)(rF,"RtcParams",
null,[]);class uM{constructor(a,b,c){this.tFk=a;this.ONe=b;this.ead=c}WTi(a,b,c){za.a.qw(a);za.a.qw(b);za.a.qw(c)}F_d(a,b,c,f){return f=!a&&0>b?f+Math.abs(b):this.tFk?(c-b)/4:(c-b)/2}G_d(a,b,c){if(!this.ead||!b)return c;if(0<=b.className.indexOf(fc.a.OO))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.f2c(b,ia.a.u$c),l=this.f2c(b,ia.a.NYc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const u=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,u.y+=c,u.height-=
2*c,u;a=this.MMj(b,a);if(isNaN(a)||!a)return c;c=(a-f)/2;u.y+=c;u.height-=2*c;return u}vNj(a,b){if(!this.ead)return 0;a=this.f2c(a,ia.a.u$c);b=Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}MMj(a,b){let c=Object(gb.a)(179,b);b||(c=Object(gb.a)(179,this.ONe.Yac(a)));if(c&&this.ONe.Yfk(c))return this.f2c(a,ia.a.NYc);b=0;const f=a.getClientRects();f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.ONe.Wia(b,c,()=>a.offsetWidth/
a.offsetHeight).height);return b}f2c(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=ca.a.Ie(c,b),c=0<=c.className.indexOf(fc.a.chc)?c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(uM,"PptMeasureBoundsUsingSpansStrategy",null,[936]);class sF{constructor(){this.MKa=null}get Apc(){return this.MKa?this.MKa.Apc:0}get xyc(){return this.MKa?this.MKa.xyc:!1}get dAd(){return this.MKa?this.MKa.dAd:!1}s6b(a,b){b&&(this.MKa?this.MKa.s6b(a,b):b(null))}oIi(a){this.MKa=
a}}Object(m.a)(sF,"PPTProcessImageStrategyProxy",null,[1572,1573]);class tF{constructor(a,b){this.Lki=a;this.UBf=b}get rcl(){return this.Lki}get GWe(){return this.UBf}eSl(a){this.UBf=a}}Object(m.a)(tF,"PageHiddenRecord",null,[]);class vM{constructor(){this.Ioa=[];ya.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.FJe=window.document.hidden){const a=new tF(new Date,new Date(9999,12,31));this.Ioa.push(a)}Tb.a.instance.ub("Common.ITaskManager").Jb(new ne.a(4,2,9E5,Object(R.a)(this,this.maintainPageHiddenRecords,
"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(R.a)(this,this.onVisibilityChange,"onVisibilityChange"))}tmg(a,b){const c=this.Ioa.length;let f=0;if(0<c&&a<this.Ioa[c-1].GWe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const u=Math.max(this.Ioa[l].rcl.getTime(),a),I=Math.min(this.Ioa[l].GWe.getTime(),b);u<I&&(f+=I-u)}}return f}onVisibilityChange(){ya.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.hul()}hul(){var a=window.document.hidden,
b=new Date;this.FJe!==a&&((this.FJe=a)?(b=new tF(b,new Date(9999,12,31)),this.Ioa.push(b)):(a=this.Ioa.length,0<a&&this.Ioa[a-1].eSl(b)))}maintainPageHiddenRecords(){const a=new Date;for(;0<this.Ioa.length&&9E5<+a-+this.Ioa[0].GWe;)Array.removeAt(this.Ioa,0)}}Object(m.a)(vM,"PageHiddenMeter",null,[926]);class uF{H7(a){let b=M.a.Fv(a);return b||(b=G.a.Fv(a))?b:(b=N.a.Fv(a))?b:""}}Object(m.a)(uF,"ActionNameResolver",null,[1571]);class vF{constructor(){this.ua=new uc.a}kpl(){this.ua.raiseEvent("CIU",
Sys.EventArgs.Empty)}lpl(a){this.ua.raiseEvent("CSC",a)}Cpl(a){this.ua.raiseEvent("ETC",a)}dAh(a){this.ua.raiseEvent("TLSC",a)}Hrl(a){this.ua.raiseEvent("TCVEL",a)}Dql(){this.ua.raiseEvent("PRTCC",null)}gql(){this.ua.raiseEvent("LCK",null)}gOc(a){this.ua.addHandler("CSC",a)}lvd(a){this.ua.removeHandler("CSC",a)}NZd(a){this.ua.addHandler("ETC",a)}EDh(a){this.ua.removeHandler("ETC",a)}hBi(a){this.ua.addHandler("TLSC",a)}SCl(a){this.ua.removeHandler("TLSC",a)}$Ai(a){this.ua.addHandler("TCVEL",a)}aAi(a){this.ua.addHandler("PRTCC",
a)}mEh(a){this.ua.removeHandler("PRTCC",a)}hyi(a){this.ua.addHandler("LCK",a)}}Object(m.a)(vF,"CoauthEventSource",null,[1567,1568,1569]);class wF{constructor(){this.ua=new uc.a}Upl(a){this.ua.raiseEvent("OnImageDescriptionReady",a)}Hpl(a){this.ua.raiseEvent("FRHRE",a)}cpl(a){this.ua.raiseEvent("APIRE",a)}aql(a){this.ua.raiseEvent("IMARE",a)}czi(a){this.ua.addHandler("OnImageDescriptionReady",a)}yBl(a){this.ua.removeHandler("OnImageDescriptionReady",a)}Wyi(a){this.ua.addHandler("FRHRE",a)}tBl(a){this.ua.removeHandler("FRHRE",
a)}uyi(a){this.ua.addHandler("APIRE",a)}cBl(a){this.ua.removeHandler("APIRE",a)}fzi(a){this.ua.addHandler("IMARE",a)}ABl(a){this.ua.removeHandler("IMARE",a)}}Object(m.a)(wF,"CoreExtEventSource",null,[1564,1565,1566]);var wM=d(1070);class xF extends wM.a{constructor(a,b,c,f,l,u,I){super(f,c,a,u,I);this.$ad=new Md.a(0);this.dZa=b;this.cLe=l}$8j(a,b){let c;(c=this.$ad).$(b,c.ga(b)+1);this.e9f(a.name,Object(R.a)(this,this.txg,"initPackageCallback"),a)}a9j(a,b){let c;(c=this.$ad).$(b,c.ga(b)+1);this.f9f(a.name,
Object(R.a)(this,this.txg,"initPackageCallback"),1,a)}txg(a){a.Z8j()}$Qh(a,b){return!!a&&!!b&&a.context.CSf!==b.context.CSf}xUe(a,b){if(b>=this.cLe){const c=new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,qf.a.e_(a[f].duration,0)));da.ULS.sendTraceTag(508355285,813,50,"{0}:{1}",c.toString(),qf.a.e_(b,0))}}onh(a){const b=[];this.$ad.forEach((c,f)=>{0<f&&(b.push(c),this.$ad.$(c,0),this.dZa.Y$c(c));return!0});da.ULS.sendTraceTag(508355284,
813,50,"[{0}]:{1}",b.join(","),qf.a.e_(a,0))}}Object(m.a)(xF,"DelayLoadedPackageInitializer",wM.a,[]);class sz{constructor(a,b,c,f,l,u,I,T){this.mOe=null;this.Ba=a;this.rF=b;this.yr=c;this.Wj=f;this.ia=l;this.tI=u;this.Db=I;this.te=T;this.rF.NZd(Object(R.a)(this,this.h8f,"editorTableUpdate"))}dispose(){this.rF.EDh(Object(R.a)(this,this.h8f,"editorTableUpdate"))}h8f(){const a=this.Wj.O0;this.H9f();this.yr.u8c&&(ya.a.J(512496593,814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",
this.Wj.mE,a.length),this.ia.nb(N.a.Q$a,2))}H9f(){if(!this.yr.u8c&&this.Wj.mE){ya.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Db)throw Error.create("Presence is being loaded before the app frame");this.fcm()}catch(a){ya.a.J(512496591,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}fcm(){ya.a.J(512496590,814,50,"App::EnsurePresence: trigger download js");Tb.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.presence",
null,()=>d.e(10).then(d.bind(null,1315)))}get m2l(){this.mOe||(this.mOe=this.sFj());return this.mOe}sFj(){return this.Ba.podsUseVersionLessJqueryAndSignalR?this.te.ARj("jquery.signalr.merge.1.1"+sz.i3d):A.AFrameworkApplication.Ui("jquery.signalr.merge.1.1",2)}}sz.i3d=".min.js";Object(m.a)(sz,"PresenceLoader",null,[]);class xM{constructor(a,b,c,f,l,u,I,T,ja){this.pJa=this.rJa=!1;this.$na=this.Una=null;this.Ba=a;this.um=b;this.WY=c;this.Ga=f;this.Xgb=l;this.FHe=u;this.zb=I;this.qz=T;this.jA=ja;this.u6=
this.Ba.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.Xgb.UFg}Rud(a){if(this.u6&&a&&!a.hm&&a.CEb)if(a.tye)a.tye=!1;else if(this.Ga.V6c(a.shapeNode)){var b=this.Ga.B2c(a.shapeNode);b.length&&(this.jA&&this.jA.isEnabled||this.jA&&this.jA.isEnabled?(this.Una=this.$na=null,this.pJa=this.rJa=!1,this.jA&&this.jA.isEnabled&&this.jA.GU&&(this.jA.heb(c=>{ya.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.$na=c;this.MVc(a,b)}),this.jA.GU.ieb(()=>{ya.a.J(51217116,801,
15,"CustomFontWebRequestFailed");this.rJa=!0;this.MVc(a,b)})),this.qz&&this.qz.isEnabled&&this.qz.GU&&(this.qz.heb(c=>{ya.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.Una=c;this.MVc(a,b)}),this.qz.GU.ieb(()=>{ya.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.pJa=!0;this.MVc(a,b)}))):this.W_h(a,b,null,null))}}yHa(a){return a?!0:!1}MVc(a,b){(this.yHa(this.Una)&&this.yHa(this.$na)||this.yHa(this.Una)&&this.rJa||this.pJa&&this.yHa(this.$na)||this.pJa&&this.rJa)&&this.W_h(a,
b,this.Una,this.$na)}W_h(a,b,c,f){a&&!a.hm&&b&&b.length&&(ya.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),Promise.all(this.FHe.F5h(b,c,Object(R.a)(this.qz,this.qz.createFontUrl,"createFontUrl"),f,Object(R.a)(this.jA,this.jA.createFontUrl,"createFontUrl"),this.WY.M4h,Object(R.a)(this.WY,this.WY.createFontUrl,"createFontUrl"))).then(()=>{ya.a.J(41521288,801,50,"WebFontsLoadCompleted");this.um.rHa(()=>{this.zb.Jb(new ne.a(2,1,0,()=>{a&&!a.hm&&(ya.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),
a.JFa(),a.tye=!0,a.NB())},90,"109"))})},l=>{ya.a.J(41494541,801,10,"WebFontsLoad failed: {0}",l.toString());a&&!a.hm&&a.shapeNode&&(a.shapeNode.TWa=!0)}))}}Object(m.a)(xM,"RemoveShapeFidelityViewForEmbeddedFontController",null,[939]);class yM{constructor(a,b,c,f,l,u,I,T,ja){this.pJa=this.rJa=!1;this.$na=this.Una=null;this.Joa=new La.a;this.Mwa=a;this.fo=b;this.WY=c;this.Ga=f;this.Xgb=l;this.FHe=u;this.zb=I;this.qz=T;this.jA=ja}fzl(a){window.self.Promise&&this.Xgb.UFg?this.zb.Jb(new ne.a(2,1,0,()=>
{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){ya.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",b),this.TTb(a)}},90,"102")):this.TTb(a)}TTb(a){if(a&&a.length){for(var b of a)b.hm||(b.CEb=!0,b.NB()),this.fo.QMh();b=0;Mg.a.instance.Ml(ii.a.oR)&&(b=(new Date).getTime()-Mg.a.instance.hh(ii.a.oR));ya.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.Joa.count,b);if(0<this.Joa.count){const c=new Map;c.set("PendingFontsCount",
this.Joa.count.toString());c.set("FidelityViewDuration",b.toString());eg.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",["MissingFont"],!1,!1,!0,!1,Object.assign(new Fl.a,{extendedProperties:c}))}a.length=0;ya.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){ya.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.hm&&b.wC&&b.JFa();b=new Date;for(const c of a)if(!c.hm){const f=this.Ga.Zcb(c.shapeNode);
for(const l of f)this.Joa.contains(l)||this.Joa.add(l)}ya.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.Joa.count){if(!this.jA||!this.jA.isEnabled)if(!md.a("EnableRemoveFidelityCloudServiceCheck")||!this.qz||!this.qz.isEnabled){this.RCh(a,this.Joa,null,null);return}this.Una=this.$na=null;this.pJa=this.rJa=!1;this.jA&&this.jA.isEnabled&&(this.jA.heb(c=>{ya.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.$na=c;this.NVc(a,this.Joa)}),this.jA.GU&&this.jA.GU.ieb(()=>
{ya.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.rJa=!0;this.NVc(a,this.Joa)}));this.qz&&this.qz.isEnabled&&(this.qz.heb(c=>{ya.a.J(40429075,801,50,"CloudFontListDownloadAndParseCompleted");this.Una=c;this.NVc(a,this.Joa)}),this.qz.GU&&this.qz.GU.ieb(()=>{ya.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.pJa=!0;this.NVc(a,this.Joa)}))}else ya.a.J(40429071,801,50,"No unsupported fonts"),this.TTb(a)}yHa(a){return a?!0:!1}NVc(a,b){(this.yHa(this.Una)&&this.yHa(this.$na)||this.yHa(this.Una)&&
(this.rJa||md.a("FidelityCustomServiceDisableCheck")&&!this.jA.isEnabled)||this.pJa&&this.yHa(this.$na)||this.pJa&&this.rJa)&&this.RCh(a,b,this.Una,this.$na)}RCh(a,b,c,f){b&&b.count?(ya.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.FHe.F5h(b.toArray(),c,Object(R.a)(this.qz,this.qz.createFontUrl,"createFontUrl"),f,Object(R.a)(this.jA,this.jA.createFontUrl,"createFontUrl"),this.WY.M4h,Object(R.a)(this.WY,this.WY.createFontUrl,"createFontUrl"))).then(l=>{ya.a.J(40429079,
801,50,"WebFontsLoadCompleted");if(l)for(let u=0;u<l.length;u++)if(l[u])for(let I=0;I<l[u].length;I++)if(l[u][I]){ya.a.J(40429081,801,50,"Status {0}",l[u][I].status);const T=l[u][I].family;Aa.a.Ta(T)||l[u][I].status!==rn.loaded||-1===T.lastIndexOf("_")||b.remove(T.substring(0,T.lastIndexOf("_")))}this.TTb(a)},l=>{ya.a.J(41521304,801,10,"WebFontsLoad failed: {0}",l.toString());this.zb.Jb(new ne.a(2,1,this.Mwa.pptWaitForWebFontsLoadingTimeoutMs,()=>{ya.a.J(40429073,801,50,"Check removing Fidelity View");
this.TTb(a)},90,"103"))})):this.TTb(a)}}Object(m.a)(yM,"RemoveShapeFidelityViewOnBootController",null,[938]);class zM{constructor(a){this.ia=a}T1l(){this.rSh(ResourceStrings.l_SessionTimeoutErrorMessage)}U1l(){this.rSh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}rSh(a){const b=new Ij.StandardDialog;b.Fd=4;b.Fg="PPTTimeoutDialog";b.Te(1,ResourceStrings.L_Refresh);b.Te(2,ResourceStrings.L_Close);b.vQ(ResourceStrings.l_GenericDialogTitle,a,Object(R.a)(this,this.YNl,"sessionTimeoutDialogHandler"))}YNl(a,
b){1===a?(ya.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.BYl()?(ya.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.nb(M.a.refreshPage,2)):this.ia.Ia(M.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):(ya.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.nb(M.a.kAb,2))}BYl(){const a=A.AFrameworkApplication.Im,b=A.AFrameworkApplication.Cka;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(m.a)(zM,
"SessionTimeoutIndicator",null,[933]);class AM{constructor(){this.vlc=!1;this.uhd=[]}cdk(a){this.vlc?a():Array.contains(this.uhd,a)||Array.add(this.uhd,a)}get Ixe(){return this.vlc}set Ixe(a){if(!this.vlc&&(this.vlc=a)){for(const b of this.uhd)b();Array.clear(this.uhd)}}}Object(m.a)(AM,"SignalRLoadCompletedListener",null,[934]);var IS=d(1270);class NB{constructor(a,b,c,f,l,u,I){this.hch=this.FYg=!1;this.kha=this.xOe=null;this.M0g=this.eKe=!1;this.ich=this.jch=this.o1g=this.p1g=0;this.ia=a;this.FHk=
b;this.vq=f;this.KOe=u;this.Hc=l;this.Zf=I;this.Hc.wLf(Object(R.a)(this,this.O6k,"onLazySorterViewActorActionRegistrationHandler"))}qb(){this.Zf||(this.ia.xa(M.a.Dia,ta.a.application,Object(R.a)(this,this.J1l,"showStatusBarSorterView")),this.ia.xa(M.a.Ixb,ta.a.application,Object(R.a)(this,this.rVi,"closeStatusBarSorterView")))}J1l(a,b,c,f,l){if(2!==c)return 32;if(this.eKe)return this.KOe.instance.Dia(a,b,c,f,l);this.Hc.wLf(Object(R.a)(this,this.CTh,"sorterViewEventHandler"));this.Zxk();this.FYg||
(this.fAe(),this.M0g=!0);return 32}rVi(a,b,c,f,l){if(2!==c)return 32;this.Hc.VAl(Object(R.a)(this,this.CTh,"sorterViewEventHandler"));(this.kha=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.kha);return this.eKe?this.KOe.instance.Ixb(a,b,c,f,l):32}fAe(){this.hch||(this.hch=!0,this.xOe=this.Yxk(),this.xOe.u9(Object(R.a)(this,this.h$k,"onSlideSorterGridLoaded")),VE.a.bF(this.xOe),this.p1g=Date.now())}h$k(){this.FYg=!0;this.vq&&
this.vq.fia("SlideSoterGridDownloadFinished");this.o1g=Date.now();const a=Mg.a.instance;a&&(a.Xb("SlideSorterOnDemandLoad",this.M0g),a.Xb("SlideSorterPkgST",this.p1g),a.Xb("SlideSorterPkgET",this.o1g))}Zxk(){this.ia.nb(M.a.N5b,2);this.kha=Df.a.we();this.kha.id="SlideSorterViewLoadingElementId";this.kha.className="sorterview-ui-loading-element-class";const a=Df.a.we();a.className="sorterview-ui-loading-textmessage-class";a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=Df.a.we();
b.className="sorterview-ui-loading-spinner-class";const c=Df.a.we();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.kha.appendChild(b);this.kha.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.kha);this.jch=Date.now()}CTh(){(this.kha=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.kha);this.ich=Date.now();this.KOe.instance.Dia(M.a.Dia,null,2,null,null);const a=Mg.a.instance;
a&&(a.Xb("SlideSorterLoadingExpST",this.jch),a.Xb("SlideSorterLoadingExpET",this.ich))}O6k(){this.eKe=!0}Yxk(){var a=A.AFrameworkApplication.Ui("slidegrid"+NB.i3d,5);a=this.FHk.qyb(a);return IS.a.create("pptedit.sorterGrid",this.Zf?null:[a],()=>d.e(17).then(d.bind(null,1322)))}dispose(){}}NB.i3d=".min.js";Object(m.a)(NB,"SorterViewActorMain",null,[106,941]);class Vw{constructor(a){this.BAf=a}onBlur(a,b){this.EAe("OnBlur",a,b);(a=Ha.InteractiveViewManager.instance.$d)&&F.FocusManager.eO()&&a.endEditing(!1,
20)}setFocus(a,b){this.EAe("SetFocus",a,b);const c=this.BAf();c&&!c.isActive&&(a.name!==P.AppFrame.m2j&&a.name!==P.AppFrame.tqj||b.name!==K.AFrame.PX||(c.iAd=!1),c.vij())}onFocus(a,b){this.EAe("OnFocus",a,b);if(F.FocusManager.eO()&&(b=this.BAf())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";E.a.Aj&&(a.startsWith(lj.a.P7b)&&(Qi.GrippersManager.instance.Rcc=!0),a.startsWith(lj.a.P7b)||a===K.AFrame.akb||a===K.AFrame.cWh)&&(c=!1);c&&this.uij(b,a)}}uij(a,b){const c=a.editingView,f=F.FocusManager.instance();
f.jpe=!0;a.pT();1===c.mode&&3!==A.AFrameworkApplication.Pa.mode&&b===K.AFrame.akb&&(a.Rb.qra.Ree(),c.qnb());f.jpe=!1}EAe(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);ln.a.instance.Dx&&da.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static yZf(a){const b=new Vw(()=>a),c=a.WJ,f=F.FocusManager.instance();f.Kc(c).TDa(Object(R.a)(b,
b.onBlur,"onBlur"));f.Kc(c).cea(Object(R.a)(b,b.setFocus,"setFocus"));f.Kc(c).Zda(Object(R.a)(b,b.onFocus,"onFocus"))}}Object(m.a)(Vw,"InteractiveViewFocusScopeActions",null,[]);class yF extends Vw{constructor(a){super(()=>a);this.yb=a}xcl(){this.yb.isActive||this.yb.Zhj()}static uZi(a,b){const c=new yF(a);a=a.WJ;b.Kc(a).TDa(Object(R.a)(c,c.onBlur,"onBlur"));b.Kc(a).cea(Object(R.a)(c,c.xcl,"pageViewSetFocus"));b.Kc(a).Zda(Object(R.a)(c,c.onFocus,"onFocus"))}}Object(m.a)(yF,"PageViewInteractiveViewFocusScopeActions",
Vw,[]);class OB{constructor(){this.Ba=this.K=null;this.kYg=!1}get name(){return"PowerPointWebEditor.CoreExt"}fc(a){this.K=a;this.Ba=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ba.Dzg&&a.register(926,"PowerPointWebEditor.IPageHiddenMeter").ma().na(()=>new vM);OB.RYi(this.K);a.register(vF,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().na(()=>
new vF);a.register(wF,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().na(()=>new wF);a.register(927,"Common.IColorTable").ma().na(()=>new pM);a.register(MB,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().na(()=>new MB(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new Hc.a(()=>Tb.a.instance.Ha("Common.IRenameProps"))));a.register(928,"PowerPointWebEditor.IDocNotifyClient").ma().na(()=>new oF(this.Ba,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ba.Mg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,u,I)=>{a.resolve("PowerPointWebEditor.IPPTWebService").Mle(c,f,l,u,I)},!1));a.register(929,"PowerPointWebEditor.IPodsDocNotifyClient").ma().na(()=>new oF(this.Ba,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,u,I,T,ja,ua)=>{a.resolve("PowerPointWebEditor.IPopWebService").v1c(b,c,f,l,u,I,T,ja,ua)},!0));a.register(930,"PowerPointWebEditor.IContentTimeStampManager").ma().na(()=>new nM);a.register(Uw,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().na(()=>new Uw(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ba.Mg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ba.Y1e,this.Ba.podsPushThumbnailImageIds));a.register(nF,"PowerPointWebEditor.CoauthNotificationManager").ma().na(()=>new nF(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ba.Mg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ha("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ba,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(sz,"PowerPointWebEditor.PresenceLoader").ma().na(()=>new sz(this.Ba,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPoint.IPathManager")));a.register(qM,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();a.register(931,"PowerpointPresence.IPresenceColorProvider").ma().na(()=>
new HS.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").ook,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(932,"PowerpointPresence.IPresencePerfLogger").ma().na(()=>new sM(a.ub("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),
a.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(rF,"PowerpointPresence.RtcParams").ma().na(()=>new rF(a.resolve("PowerPointWebEditor.ICoauthStateGetter").mE,a.resolve("PowerPointWebEditor.IApplicationContext").hpg(),a.Ha("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").tc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(933,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().na(()=>new zM(a.resolve("Common.IActionManager")));a.register(934,
"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().na(()=>new AM);a.register(lF,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().na(()=>new lF(this.Ba,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ha("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ha("PowerPointWebEditor.ICommentSessionManager")));a.register(kF,"PowerPointWebEditor.SessionCleanupHandler").ma().na(()=>new kF(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(935,"Common.IProcessInputStrategy").ma().na(()=>new Ot(a.resolve("Common.IActionManager"),this.Ba,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Ba.Cm||a.register(rM.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().na(()=>
new rM.a);a.register(936,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().na(()=>new uM(this.Ba.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ba.BEg));a.register(157,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new oa);a.register(937,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().na(()=>new oM(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),A.AFrameworkApplication.isRtl,this.Ba.JEg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ba.RD,this.Ba.Zwe));a.register(938,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().na(()=>
new yM(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(939,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().na(()=>
new xM(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(uF,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().na(()=>
new uF);a.register(sF,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().na(()=>new sF);a.register(xF,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().na(()=>{let b=2;const c=Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:ya.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new xF(Tb.a.instance.resolve("Common.ITaskManager"),
Tb.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),Tb.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(940,"PowerpointPresence.IPresencePrepCacheParser").ma().na(()=>new tM(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(941,"PowerPointWebEditor.ISorterViewActorMain").na(()=>new NB(A.AFrameworkApplication.Pa,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").CHg,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ha("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Cm)).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&Mg.a.instance.Xb("FirstExtJsExecTime",a);a=new rD.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").J5&&this.zlh();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").rHa(()=>{this.K.resolve("Common.ITaskManager").Jb(new ne.a(0,1,0,Object(R.a)(this,this.h3k,"onBootComplete_DelayExecuted"),90,"21"))});this.Ba.Dzg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");yF.uZi(b,this.K.resolve("Common.IFocusManager"));b.$2i(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").h4k()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}zlh(){const a=new rD.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.kYg=!0;md.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").W2a(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Aa)}z2j(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}mEi(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.e0d("WACDocumentPanelContent","Horizontal"),this.e0d("EditingThumbnailsPanel","Horizontal"),this.e0d("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}e0d(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}Ate(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Aa;if(a){const b=new pg.GraphTransaction(2);
try{b.rd(a),a.Pfa(16)}finally{b&&b.dispose()}}}mxk(){this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.comment",null,()=>d.e(9).then(d.bind(null,1311)))}lxk(){this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1307)))}h3k(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.kYg||this.zlh();this.z2j();this.mEi();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ba.separateDownloadSignalREnabled&&
this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea(this.K.resolve("PowerPointWebEditor.PresenceLoader").m2l,(f,l)=>{ad.App.xqk()&&(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").Ixe=l.succeeded)},null);const b=()=>{ya.a.J(512360582,809,50,"Start to download chronos.js file");this.mxk();this.lxk();this.Ba.aTh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").fAe()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").pzg(()=>
{b()})};(new yv.a(this.Ba.Pba)).spk?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").nJg().continueWith(()=>{this.Ate()}).continueWith(()=>{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").Gff();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.fia("ChronosStartDownloadTime");try{if(this.Ba.wacAirSpaceResourceLink){const f=Kq.a.Qxb("wacairspaceanimationlibrary.js"),l=pL.a.create(f,null,null);VE.a.bF(l)}}catch(f){ya.a.J(512360581,
814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ba.Mg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").t$j();A.AFrameworkApplication.fa.Ue(()=>{xS.a.instance.VSi()});MSOJS.ClientUtils.InitUrls(A.AFrameworkApplication.aIl,A.AFrameworkApplication.ZHl,A.AFrameworkApplication.$Hl)}static main(){A.AFrameworkApplication.Dh&&E.a.jg?ya.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):C.a.instance.Ac(new OB)}static RYi(a){a.register(942,
"PowerPointWebEditor.IPrefetchManager").ma().na(()=>new Mq(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").Cd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(m.a)(OB,"CoreExtPackage",null,[2,3]);class BM{constructor(){this.Xbd=
this.zf=this.hd=this.wb=null;this.ua=new uc.a;this.Mb=!1}init(a,b){this.zf=a;this.hd=b;this.eC()}dispose(){this.wb&&(this.visible=!1,this.hd.Hb(la.a.click,this.wb,Object(R.a)(this,this.BLa,"onBackgroundClick")),this.zf&&this.wb&&(this.zf.removeChild(this.wb),this.wb=null),this.ua&&(this.ua.dispose(),this.ua=null))}eC(){this.wb=document.createElement("div");this.wb.className="EditingNotesDefaultView";A.AFrameworkApplication.isRtl&&(this.wb.style.direction=Hf.a.i4a);this.zf.appendChild(this.wb);this.Xbd=
document.createElement("p");this.Xbd.className="EditingNotesDefaultViewContent";this.Xbd.innerText=ResourceStrings.l_ClickToAddNotes;this.wb.appendChild(this.Xbd);this.hd.xb(la.a.click,this.wb,Object(R.a)(this,this.BLa,"onBackgroundClick"))}BLa(a){this.ua.raiseEvent("OnBackgroundClick",a);return!0}DLf(a){this.ua.addHandler("OnBackgroundClick",a)}tu(){}get visible(){return this.Mb}set visible(a){this.Mb=a;this.wb.style.display=a?sj.a.block:sj.a.none}get va(){return this.wb}}Object(m.a)(BM,"NotesPromptView",
null,[1519,1614,106]);class CM{constructor(a){this.vid=this.zf=this.wb=null;this.ied=this.Mb=!1;this.KLk=a}init(a,b){b.qEb&&(this.zf=a,this.wb=document.createElement("div"),this.wb.className="EditingNotesReadOnlyView",this.KLk&&(this.wb.style.direction=Hf.a.i4a),this.zf.appendChild(this.wb),this.vid=document.createElement("div"),this.vid.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.Ind,b=jSanity.sanitize(a),this.vid.appendChild(b),this.wb.appendChild(this.vid),this.ied=!0)}dispose(){this.ied&&
(this.visible=!1,this.zf&&this.wb&&(this.zf.removeChild(this.wb),this.wb=null),this.ied=!1)}get visible(){return this.Mb}set visible(a){this.ied&&(this.Mb=a,this.wb.style.display=a?sj.a.block:sj.a.none)}get va(){return this.wb}}Object(m.a)(CM,"NotesReadOnlyView",null,[1613,106]);var PB=d(498),zF=d(656);class Sr extends PB.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd){super(a,b);this.XIb=this.xg=this.Jh=this.Vhb=null;this.$Za=!1;this.Bxa=ad.App.Xn;this.ZJa=Object(gb.a)(747,b);
this.wb=this.Vd.container;this.mc(this.wb);this.hd=c;this.Fa=f;this.Kib=l;this.HJb=ua;this.Qm=u;this.Qi=I;this.Pt=T;this.MK=ja;this.gb=Ra;this.Pfb=eb;this.Gaa=Object(gb.a)(434,a);this.kkc=Bb;this.rc=Ub;this.KMe=Xb;this.Wxa=tc;this.DF=lc;this.te=Ec;this.Nhd=hd;this.wq=yd;this.ydd=this.te.Ok("formatpaintertext.cur");this.wq&&this.DF.q_d(Object(R.a)(this,this.Mrc,"onTextFPActiveChanged"));this.Jh||this.eC()}dispose(){this.hd.Hb(la.a.click,this.wb.parentNode,Object(R.a)(this,this.BLa,"onBackgroundClick"));
this.wq&&this.DF.F3e(Object(R.a)(this,this.Mrc,"onTextFPActiveChanged"));this.Kib&&(this.Kib.dispose(),this.Kib=null);this.HJb&&(this.HJb.dispose(),this.HJb=null);super.dispose()}Oz(a){super.Oz(a);this.LBc()}Kca(a){this.dF(this.xg,a,-1)}m8(){this.PAd()}eC(){this.Nhd&&(this.XIb=this.Vd.createElement("div"),this.XIb.className="NotesResizeHandle",ig.c(this.XIb,!0),Sys.UI.DomElement.addCssClass(this.XIb,"NotesResizeHandle"),this.htmlElement.appendChild(this.XIb),this.rp(this.XIb));this.Vhb=this.Vd.createElement("div");
this.Vhb.className="NotesContentContainer";this.Vhb.id="NotesContentContainer";this.rp(this.Vhb);this.htmlElement.appendChild(this.Vhb);this.Jh=this.Vd.createElement("div");Sys.UI.DomElement.addCssClass(this.Jh,"NotesView");Sys.UI.DomElement.addCssClass(this.Jh,"NotesEditViewVisible");this.Vhb.appendChild(this.Jh);this.rp(this.Jh);this.xg=this.Vd.createElement("div");Sys.UI.DomElement.addCssClass(this.xg,"NotesViewContent");this.Jh.appendChild(this.xg);this.rp(this.xg);A.AFrameworkApplication.isRtl&&
(this.Jh.style.direction=Hf.a.i4a);this.hd.xb(la.a.click,this.wb.parentNode,Object(R.a)(this,this.BLa,"onBackgroundClick"));this.Kib.init(this.wb.parentNode,this.hd);this.HJb.init(this.wb.parentNode,this.ZJa);this.PAd();this.Kib.DLf(Object(R.a)(this,this.l4k,"onDefaultViewClick"))}PAd(){if(this.ZJa.qEb)this.NNa(!1),this.laf(!1),this.s1l();else{var a=this.Qm.ywe(this.ZJa);a=this.$Za||!a;this.NNa(a);this.laf(!a);this.wq&&this.wE(Sr.Bga)}}Mrc(a,b){Sr.Bga=b.dZc;this.wE(Sr.Bga)}wE(a){const b=this.wb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");
if(2===a)for(this.wb.style.cursor=Df.a.rR(this.ydd,sj.a.LB),this.xg.style.cursor=Df.a.rR(this.ydd,sj.a.LB),a=0;a<b.length;a++)if(b[a].style.cursor!==Df.a.rR(this.ydd,sj.a.LB))b[a].style.cursor=Df.a.rR(this.ydd,sj.a.zca);else break;else for(this.wb.style.cursor=sj.a.LB,this.xg.style.cursor=sj.a.LB,a=0;a<b.length;a++)b[a].style.cursor=sj.a.zca}LBc(){this.htmlElement.style.zIndex="0";const a=this.Qm.cWa(this.ZJa,this.Vd.Xd),b=this.Qm.xac(this.ZJa,this.Vd.Xd);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=
c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);Sr.m8e(this.Jh,b);Sr.m8e(this.Kib.va,b);Sr.m8e(this.HJb.va,b);this.Wxa.Snb(new pd.a(a.x,a.y),A.AFrameworkApplication.isRtl,this.Jh,!0)}$kb(){this.$Za=!0;this.XV();this.startEditing()}alb(){this.$Za=!1;this.XV();this.endEditing()}hK(){return this.$Za}startEditing(){this.Uya.qEb?this.gb.uj():(this.PAd(),this.LDg()||(this.Bxa=this.Uya.lIa,this.MK.NMh(this.ZJa,!1),this.MK.Hml(this.ZJa)))}endEditing(){if(!this.Uya.qEb&&(this.Pfb.setVisibility(!1),this.PAd(),
!this.LDg())){this.Bjh.endEditing(!0,14);this.kkc.Gbe(this.Gaa);var a=this.KMe.ewa(this.Uya,this.Bxa),b=!!this.Uya&&this.Uya.isConnected;a&&(b&&this.Uya.kzd(),this.Qi.P$a(this.Uya),this.Pt.H4d());this.MK.NMh(this.ZJa,b&&this.Uya.a7c)}}l4k(a,b){this.BLa(b)}BLa(){this.Fa.qk(yj.a.H4,!0);this.NNa(!0);this.laf(!1);this.Bjh.pT();this.Aaf();this.Bxa=this.Uya.lIa;return!0}LDg(){return!this.rc.fp}get va(){return this.htmlElement}get Uya(){return this.ZJa}get Bjh(){return this.Tc}Aaf(){this.Mca(!0)}s1l(){this.HJb.visible=
!0}laf(a){this.Kib.visible=a}NNa(a){zF.b(a,this.Vhb,"NotesContentContainerHidden","NotesContentContainerVisible")}Mca(a){zF.b(a,this.Jh,"NotesEditViewHidden","NotesEditViewVisible")}static m8e(a,b){a&&(a.style.paddingTop=Df.a.Rc(b[0]),a.style.paddingRight=Df.a.Rc(b[1]),a.style.paddingBottom=Df.a.Rc(b[2]),a.style.paddingLeft=Df.a.Rc(b[3]))}static mmk(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}Sr.Bga=0;Object(m.a)(Sr,"NotesViewElement",PB.a,[1615,440]);var Ks=d(393),JS=
d(623),KS=d(861),DM=d(496),QB=d(495);class EM extends QB.a{constructor(a,b){super(a,b);this.xga=[];this.tjc=0}gPb(a,...b){Array.addRange(this.xga,b);this.tjc=a}uvc(){if(this.xga)for(const a of this.xga)this.Ru.tvc(this.container,a,this.tjc);this.Ru.dL(this.container,this.a5)}GBc(){this.Ru.dG(this.container,this.a5);for(const a of this.xga)this.Ru.dG(this.container,a)}}Object(m.a)(EM,"NotesViewDomManager",QB.a,[]);var RB=d(565);class FM extends RB.ViewSelectionChangedHandler{constructor(a,b){super(a);
this.oa=b}ryb(){return[Object(R.a)(this,this.zrc,"onSetup"),Object(R.a)(this,this.Tqc,"onEnsurePageViewElementsCreated"),Object(R.a)(this,this.Uqc,"onEnsureSelectedContentViewElementsCreated"),Object(R.a)(this,this.irc,"onMainLoop"),Object(R.a)(this,this.x7k,"onNotesContentSelect"),Object(R.a)(this,this.Pqc,"onCommit"),Object(R.a)(this,this.Lrc,"onTearDown")]}x7k(a,b){this.wia(b);a=Object(gb.a)(747,this.Qh.Zg);if(!a)return!0;a=Object(gb.a)(1615,a.sc(this.Qh.Na));if(!a)return!0;this.oa.nna()?a.hK()||
a.$kb():a.hK()&&a.alb();return!0}}Object(m.a)(FM,"NotesViewSelectionChangedHandler",RB.ViewSelectionChangedHandler,[]);class AF extends Tw.DragSelectionDragAdapter{constructor(a,b,c,f,l,u){super(a,b,c);this.Pq=f;this.oBe=u;this.Qm=l}Qv(a){if(this.oBe){var b=this.wBc(a);const c=b?b.eb:null;if(c){const f=this.Qm.NHa(c)?Object(gb.a)(747,c):this.Qm.DBb(c);if(f&&this.Qm.ywe(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Yf.M4a(a.clientPoint,b,c,this.Yf,!1))&&gf.HyperlinkReader.lna(b,!0))return!1}a=super.Qv(a);
null!==this.Pq&&a&&this.Pq.tAa(sj.a.zca);return a}rv(a){super.rv(a);null!==this.Pq&&this.Pq.Uza()}Uo(a){super.Uo(a);null!==this.Pq&&this.Pq.Uza()}lK(a){return this.Yf.isActive?super.lK(a):!1}static yac(a){return new AF(a,Tb.a.instance.resolve("Common.IActionManagerExtended"),Tb.a.instance.resolve("Common.IActivityManager"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Tb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,Tb.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(m.a)(AF,"NotesDragSelectionDragAdapter",Tw.DragSelectionDragAdapter,[]);var SB=d(237);class BF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.e1g=this.rmc=this.kQg=this.TLe=this.MJa=0;this.iba=this.ojc=this.Wgd=null;this.ric=this.uNg=this.Fgd=0;this.nEe=!1;this.Gaa=a;this.P1=b;this.Ji=c;this.Db=f;this.nB=l;this.Tg=u;this.Wb=I;this.Jc=T;
this.Eb=ja;ua.xSa(Object(R.a)(this,this.orc,"onOutboundReplication"));this.ia=Ra}Ew(a){return a&&a.xB!==Sys.UI.MouseButton.rightButton?Sr.mmk(a.Ec):!1}Qv(a){if(!this.Ew(a))return!1;this.nEe=!0;this.Wgd=this.nB.va;if(!this.Wgd)return!1;this.iba=this.Jc.Ic;if(this.iba&&(this.ojc=this.Tg.va))this.kQg=this.ojc.clientHeight;else return!1;this.Fgd=Math.floor(.75*(this.Wgd.clientHeight+this.ojc.clientHeight));this.TLe=this.Wgd.clientHeight;this.rmc=this.MJa=a.clientPoint.y;this.e1g=this.iba.cV;this.P1.Dm(7);
this.Gaa.endEditing(!0,14);return!0}Px(a){if(!a)return!1;this.MJa=a.clientPoint.y;a=this.eUf(this.MJa);this.nB.Eha=a;this.Db.qv();a=this.kQg+this.TLe-a;this.ojc.style.height=a+"px";this.iba.dSl(a-1);this.iba.lUl(this.e1g);return!0}Uo(a){this.P1.c3();this.Gaa.pT();this.ric=this.eUf(a?a.clientPoint.y:this.MJa);this.ia.Ia(M.a.h8e,2,this.ric)}rv(){this.nEe&&(this.nEe=!1,this.Uo(null))}orc(){this.ric!==this.uNg&&2===ad.App.Ob.mode&&(this.uNg=this.ric,this.Lbl(this.ric))}Lbl(a){const b=this.Wb.Fn,c=this.Eb.ud(4);
try{c.mc(b),b.PLb=4320,b.Eha=this.JOi(a)}finally{c&&c.dispose()}}eUf(a){a=this.TLe+this.Ji.Tm(this.rmc-a);0<this.Fgd&&a>this.Fgd?a=this.Fgd:a<SB.a.DUa&&a>jf.a.jWc?a=SB.a.DUa:a<jf.a.jWc&&(a=jf.a.I7f);return a}JOi(a){return this.Ji.RXe(a,1)}static yac(a){return new BF(a,Tb.a.instance.resolve("Common.CursorManager"),Tb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Tb.a.instance.resolve("Box4.IAppFrame"),Tb.a.instance.resolve("PowerPointWebEditor.INotesPane"),Tb.a.instance.resolve("PowerPointWebEditor.ISlidePane"),
Tb.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Tb.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Tb.a.instance.resolve("Common.Transaction.ITransactionFactory"),Tb.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Tb.a.instance.resolve("Common.IActionManagerExtended"))}}Object(m.a)(BF,"NotesResizeDragAdapter",null,[363]);class GM extends Ks.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){super(yj.a.H4,a,b,c,f,l,I,T,eb);this.CJe=!1;this.aLa=u;this.rc=
ja;this.og=ua;this.EP=Ra;this.oBe=Bb;this.wq=Ub}get c0d(){return A.AFrameworkApplication.fa}ez(a,b){b=void 0===b?null:b;this.wq&&this.og.xb(la.a.WK,this.container,Object(R.a)(this,this.Omd,"mouseUpHandlerFilter"));super.ez(a,b);(a=Object(gb.a)(747,a))&&a.qEb&&this.Lg&&this.Lg.Mo&&this.Lg.Mo.setAttribute("aria-readonly","true")}detach(){this.wq&&this.ep&&this.og.Hb(la.a.WK,this.container,Object(R.a)(this,this.Omd,"mouseUpHandlerFilter"));super.detach()}o4b(a,b){return new EM(a,b)}Kfa(a){a=super.Kfa(a);
a.a5=AF.yac(this);a.gPb(1,BF.yac(this));return a}Kkb(a){this.ZHc=a.wg;if(!this.evc||this.isActive||!this.oBe||(a.hc.type===la.a.mouseDown||a.hc.type===la.a.bTa)&&a.xB!==Sys.UI.MouseButton.leftButton)return!1;var b=a.Ec;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;Ks.a.K9&&(c=Ks.a.K9.wua());ad.App.WE.zU&&ad.App.WE.zU.t5e(f=>{f&&(c=!0)});b=!md.a("DeprecateIE.NotesView")&&c&&E.a.m1;a=new JS.a(a,this,!0,b);this.$ll(a);return!1}$ll(a){this.YYe();this.N7(E.a.jg||E.a.NXa);
this.Ds.raiseEvent(Ks.a.H5c,new KS.a(a.graphNode));this.SYc(a.graphNode);this.Lif();const b=[Object(R.a)(this,this.CSe,"noneClickHandler"),Object(R.a)(this,this.L0k,"notesSnapToContentClickHandler"),Object(R.a)(this,this.G0k,"notesDefaultClickHandler")];for(const c of b)if(c(a).x5){this.CJe=!0;break}}Omd(){return this.CJe&&this.EP.pYa?(this.Ca.nb(G.a.hfa,2),!0):this.CJe=!1}G0k(a){const b=Ks.a.fd.Cq(G.a.Fxb);b.properties.$(Mc.a.source,"DefaultClickHandler");this.i8(a.zW,a.ft,a.graphNode,a.Tc,a.Uj.shiftKey,
a.Uj.ctrlKey,a.Uj.wg);b.end();a.mAb&&this.N7(!0);this.editingView.Afb(a.Uj.shiftKey,a.zW,a.Uj.wg);return Ji.a.Lm(!0)}L0k(a){if(!a.ft){const b=a.ft,c=a.graphNode,f=Ks.a.fd.Cq(G.a.Fxb);f.properties.$(Mc.a.source,"SnapToContentClickHandler");this.i8(a.zW,b,c,this,a.Uj.shiftKey,a.Uj.ctrlKey,a.Uj.wg);f.end();a.mAb&&this.N7(!0);this.editingView.Afb(a.Uj.shiftKey,a.zW,a.Uj.wg);return Ji.a.Lm(!0)}return Ji.a.notHandled}Ipa(){super.Ipa();this.Lg&&this.Lg.Mo&&(this.c0d.getBooleanAppSetting("AccessibilityNotificationEnabledViaAriaLiveRegion")?
this.Lg.qxc(Qe.a.GPc):this.Lg.n7e(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Qe.a.GPc),this.Lg.Mo.setAttribute(Qe.a.Rp,ResourceStrings.l_NotesPane))}cCd(){this.pG.$d===this&&this.suspend()}hwd(){this.pG.$d===this&&this.resume()}R1c(){return new FM(this,Tb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}ZZc(){return[Object(R.a)(this,this.CSe,"noneClickHandler"),Object(R.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(R.a)(this,this.tripleClickHandler,
"tripleClickHandler"),Object(R.a)(this,this.defaultClickHandler,"defaultClickHandler")]}H_c(){return[Object(R.a)(this,this.CSe,"noneClickHandler"),Object(R.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}CSe(a){return this.rEb(a)||this.nmk()?Ji.a.Lm(!0):Ji.a.notHandled}u_c(){return[Object(R.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(R.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(R.a)(this,this.domElementSelectedContextMenuHandler,
"domElementSelectedContextMenuHandler")]}GAa(a){this.rEb(a)||super.GAa(a)}noContextMenuHandler(a){return this.rEb(a)?wn.a.Lm(null):wn.a.notHandled}rEb(a){return!!a&&!!a.graphNode&&60===a.graphNode.type&&a.graphNode.qEb}nmk(){return!this.rc.fp}Ncb(){return DM.a.oRe}get PG(){return super.PG|96}get PRb(){return!0}p8(a,b,c){c=void 0===c?null:c;this.aLa.FZ(this)&&super.p8(a,b,c)}}Object(m.a)(GM,"NotesView",Ks.a,[869,1522,418,262,106,434,435,436,437,438]);var HM=d(497),TB=d(212);class CF{constructor(a,
b,c,f){this.y0g=null;this.Jxa=a;this.sa=b;this.xq=c;this.NHe=f}K$j(){this.y0g=new HM.a(TB.App.fvb.J0k,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.Jxa.tEa(this.y0g.KBa);Vw.yZf(this.Jxa);this.ZPf(this.sa.Aa);this.xq.uxi(Object(R.a)(this,this.ilh,"onAttachNotesView"))}ilh(a,b){this.Whj();this.ZPf(b.gd)}ZPf(a){this.sa.presentation&&a&&a.isConnected&&(a=this.NHe.hjg(a,27),this.Jxa.ez(a))}Whj(){this.Jxa.ep&&(this.Jxa.editingView.disable(!0,14),this.Jxa.detach())}dispose(){this.xq.tAl(Object(R.a)(this,
this.ilh,"onAttachNotesView"))}}Object(m.a)(CF,"NotesViewHelper",null,[106]);class DF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}fc(a){this.K=a;this.K.register(869,"PowerPointWebEditor.INotesView").ma().na(()=>new GM(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),
this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ha("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(CF,
"PowerPointWebEditor.Notes.NotesViewHelper").ma().na(()=>new CF(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new Cm.a((a,b)=>Object(gc.a)(869,a)?new Sr(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
new BM,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new CM(A.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").tvh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").K$j()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){C.a.instance.Ac(new DF)}}
Object(m.a)(DF,"PPTWebEditorNotesPackage",null,[2,3]);class EF extends Tw.DragSelectionDragAdapter{constructor(a,b,c,f){super(a,b,c);this.Pq=f}Qv(a){a=super.Qv(a);null!==this.Pq&&a&&this.Pq.tAa(sj.a.zca);return a}rv(a){super.rv(a);null!==this.Pq&&this.Pq.Uza()}Uo(a){super.Uo(a);null!==this.Pq&&this.Pq.Uza()}lK(a){return this.Yf.isActive?super.lK(a):!1}static yac(a){return new EF(a,Tb.a.instance.resolve("Common.IActionManagerExtended"),Tb.a.instance.resolve("Common.IActivityManager"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?
Tb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null)}}Object(m.a)(EF,"SmartArtTextViewDragSelectionDragAdapter",Tw.DragSelectionDragAdapter,[]);class IM extends QB.a{constructor(a,b){super(a,b);this.xga=[];this.tjc=0}gPb(a,...b){Array.addRange(this.xga,b);this.tjc=a}uvc(){if(this.xga)for(const a of this.xga)this.Ru.tvc(this.container,a,this.tjc);this.Ru.dL(this.container,this.a5)}GBc(){this.Ru.dG(this.container,this.a5);for(const a of this.xga)this.Ru.dG(this.container,
a)}}Object(m.a)(IM,"SmartArtTextViewDomManager",QB.a,[]);class JM extends RB.ViewSelectionChangedHandler{constructor(a,b,c,f){super(a);this.oa=b;this.gf=c;this.YP=f}ryb(){return[Object(R.a)(this,this.zrc,"onSetup"),Object(R.a)(this,this.Tqc,"onEnsurePageViewElementsCreated"),Object(R.a)(this,this.Uqc,"onEnsureSelectedContentViewElementsCreated"),Object(R.a)(this,this.irc,"onMainLoop"),Object(R.a)(this,this.q$k,"onSmartArtContentSelect"),Object(R.a)(this,this.Pqc,"onCommit"),Object(R.a)(this,this.Lrc,
"onTearDown")]}q$k(a,b){this.wia(b);b=Object(gb.a)(4,this.Qh.Zg);if(!b)return!1;a=Object(gb.a)(976,b.sc(this.Qh.Na));b=Object(gb.a)(178,b.sc(this.gf));if(!a)return!1;this.oa.kYa()?a.hK()||(a.$kb(),this.YP.zq(!0),b&&b.$kb()):a.hK()&&(a.alb(),this.YP.zq(!1),b&&b.alb());return!0}}Object(m.a)(JM,"SmartArtTextViewSelectionChangedHandler",RB.ViewSelectionChangedHandler,[]);class KM extends Ks.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){super(xc.a.kT,a,c,f,l,I,ja,ua,Ra);this.aLa=T;this.oa=b;this.Ar=
u;this.gf=eb;this.YP=Bb;this.Fa=Ub;this.Xd.sif=!0;this.Xd.Wee=!1}get c0d(){return A.AFrameworkApplication.fa}o4b(a,b){return new IM(a,b)}Kfa(a){a=super.Kfa(a);a.a5=EF.yac(this);return a}Ipa(){super.Ipa();this.Lg&&this.Lg.Mo&&(this.c0d.getBooleanAppSetting("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Lg.qxc(Qe.a.GPc):this.Lg.n7e(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Qe.a.GPc),this.Lg.Mo.setAttribute(Qe.a.Rp,
ResourceStrings.l_SmartArtTextPane))}cCd(){this.pG.$d===this&&this.suspend()}hwd(){this.pG.$d===this&&this.resume()}R1c(){return new JM(this,Tb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.gf,this.YP)}wxb(){this.pG.$d===this&&this.oa.u4d();return!1}ZZc(){return[Object(R.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(R.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(R.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(R.a)(this,
this.defaultClickHandler,"defaultClickHandler")]}H_c(){return[Object(R.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}u_c(){return[Object(R.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(R.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.qk(xc.a.kT,!0);return a}Ncb(){return DM.a.oRe}get PG(){let a=super.PG;return a=md.a("SmartArt.ListensToRenderOverlayInvalidations")?
a|64:a|96}get PRb(){return!0}p8(a,b,c){c=void 0===c?null:c;this.aLa.FZ(this)&&super.p8(a,b,c)}tTl(a){const b=this.Ar.xe(2);try{b.rd(a);let c=null;c=$d.SelectionFactory.hk(a,!0);this.setSelection(c)}finally{b&&b.dispose()}}}Object(m.a)(KM,"SmartArtTextView",Ks.a,[268,1522,418,262,106,434,435,436,437,438]);class LM extends PB.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){super(a,b);this.xg=this.Jh=null;this.$Za=!1;this.Bxa=ad.App.Xn;this.gkd=b;this.wb=this.Vd.container;this.mc(this.wb);this.hd=c;this.Fa=
f;this.ia=l;this.Qi=u;this.Pt=I;this.MK=T;this.Pfb=ja;this.Gaa=a;this.kkc=ua;this.xd=Ra;this.eC()}dispose(){this.hd.Hb(la.a.click,this.wb.parentNode,Object(R.a)(this,this.BLa,"onBackgroundClick"));this.xd.JCl(Object(R.a)(this,this.fqh,"onSmartArtTextPaneWidthChanged"));super.dispose()}Oz(a){super.Oz(a)}Kca(a){this.dF(this.xg,a,-1)}m8(){this.NNa(!0)}eC(){this.Jh=this.Vd.createElement("div");Sys.UI.DomElement.addCssClass(this.Jh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.Jh,"SmartArtTextViewVisible");
this.htmlElement.appendChild(this.Jh);this.rp(this.Jh);this.xg=this.Vd.createElement("div");Sys.UI.DomElement.addCssClass(this.xg,"SmartArtTextViewContent");this.xg.style.width=Df.a.Rc(jf.a.gzc-2*jf.a.rSb-2*jf.a.cbf-jf.a.oTh);this.Jh.appendChild(this.xg);this.rp(this.xg);A.AFrameworkApplication.isRtl&&(this.Jh.style.direction=Hf.a.i4a);this.NNa(!0);this.hd.xb(la.a.click,this.wb.parentNode,Object(R.a)(this,this.BLa,"onBackgroundClick"));this.xd.UAi(Object(R.a)(this,this.fqh,"onSmartArtTextPaneWidthChanged"))}$kb(){this.$Za=
!0;this.XV();this.startEditing()}alb(){this.$Za=!1;this.XV();this.endEditing()}hK(){return this.$Za}startEditing(){this.NNa(!0);this.Bxa=this.Z3a.lIa;this.MK.Axc(this.gkd,!1);this.MK.Msd(this.gkd)}endEditing(){this.Pfb.setVisibility(!1);this.NNa(!0);this.qTh.endEditing(!0,14);this.kkc.Gbe(this.Gaa);const a=new gk.a(this.Z3a,this.Bxa);this.ia.Ia(M.a.Tlb,2,a);const b=!!this.Z3a&&this.Z3a.isConnected;a.ewa&&(b&&this.Z3a.kzd(),this.Qi.P$a(this.Z3a),this.Pt.H4d());this.MK.Axc(this.gkd,b&&this.Z3a.a7c)}BLa(){this.Fa.qk(xc.a.kT,
!0);this.qTh.pT();this.NNa(!0);this.Bxa=this.Z3a.lIa;return!0}get va(){return this.htmlElement}get Z3a(){return this.gkd}get qTh(){return this.Tc}NNa(a){zF.b(a,this.Jh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}fqh(a,b){this.xg.style.width=Df.a.Rc(Df.a.zo(b.width))}}Object(m.a)(LM,"SmartArtTextViewElement",PB.a,[976,440]);class MM{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.uch=this.bgb=null;this.YP=a;this.JKa=b;this.xd=c;this.Fa=f;this.Pt=l;this.vN=u;this.oa=I;this.yb=Object(gb.a)(434,
T);this.xq=ja;this.ih=ua;this.rc=Ra;this.e2=eb}pak(){this.uch=new HM.a(this.YP.K7f,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");this.JKa.tEa(this.uch.KBa);Vw.yZf(this.JKa);this.xd.LAi(Object(R.a)(this,this.Nph,"onSingleSmartArtShapeViewElementSelected"));this.xd.MAi(Object(R.a)(this,this.Oph,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.xd.TAi(Object(R.a)(this,this.eqh,"onSmartArtShapeViewElementDeselected"));this.xd.c3b(Object(R.a)(this,this.aqd,
"onSlideHtmlUpdated"));this.xd.Dxi(Object(R.a)(this,this.dqh,"onSmartArtCommentsVisibilityChanged"));this.vN.B4(Object(R.a)(this,this.Arc,"onShapeDisconneted"));this.xq.oOc(Object(R.a)(this,this.ZV,"onFocusChanged"));this.xq.iOc(Object(R.a)(this,this.ZV,"onFocusChanged"));this.yb.CSa((a,b)=>{this.aqd(a,b)})}swa(){return!this.rc.fp}uaf(a){if(this.e2){if(this.swa()||a.Bpa)return}else if(this.swa())return;a&&a.ig&&!a.get_smartArtModelId()&&a.isConnected?(ya.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),
a.$af||(this.bgb!==a&&(this.bgb=a,this.Obe(),this.$Pf(a)),this.YP.Qhf(a),this.YP.zq(!0))):ya.a.J(38618785,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}G1l(a){this.swa()||(a&&a.ig&&!a.get_smartArtModelId()&&a.isConnected?(ya.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.$af||(this.bgb!==a&&(this.bgb=a,this.Obe(),this.$Pf(a)),this.Fa.qk(xc.a.kT,!0),this.Pt.Bx(),this.JKa.tTl(a),this.YP.Qhf(a),
this.YP.zq(!0))):ya.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}h6f(){this.YP.isVisible&&(ya.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.YP.zq(!1))}Nph(a,b){this.swa()||this.uaf(b.shapeNode)}Oph(a,b){this.swa()||this.G1l(b.shapeNode)}eqh(){this.swa()||this.h6f()}aqd(){if(!this.swa()&&this.oa.UM()){const a=this.oa.KGa();ya.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&
this.YP.Qhf(a)}}ZV(a,b){this.swa()||(a=b.qkb,a===xc.a.kT?this.ih.bM(xc.a.kT):this.ih.Jec(a)&&this.ih.zp(xc.a.kT))}$Pf(a){a&&a.isConnected&&this.JKa.ez(a)}Obe(){this.JKa.ep&&(this.JKa.editingView.disable(!0,14),this.JKa.detach())}Arc(a,b){this.swa()||b.node!==this.bgb||(this.bgb=null,this.Obe(),this.YP.zq(!1))}dqh(a,b){this.swa()||((a=b.aWl)?a.ig&&this.uaf(a):(a=this.oa.KGa())?this.bgb!==a&&this.uaf(a):this.h6f())}dispose(){this.xd.BCl(Object(R.a)(this,this.Nph,"onSingleSmartArtShapeViewElementSelected"));
this.xd.CCl(Object(R.a)(this,this.Oph,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.xd.ICl(Object(R.a)(this,this.eqh,"onSmartArtShapeViewElementDeselected"));this.xd.zAl(Object(R.a)(this,this.dqh,"onSmartArtCommentsVisibilityChanged"));this.vN.Wza(Object(R.a)(this,this.Arc,"onShapeDisconneted"));this.xq.t3e(Object(R.a)(this,this.ZV,"onFocusChanged"));this.xq.mvd(Object(R.a)(this,this.ZV,"onFocusChanged"));this.xd.CEh(Object(R.a)(this,this.aqd,"onSlideHtmlUpdated"));this.yb.Ovc((a,
b)=>{this.aqd(a,b)})}}Object(m.a)(MM,"SmartArtTextViewHelper",null,[868,106]);class FF{constructor(){this.K=null;this.kB=!1}get name(){return"PowerPointWebEditor.SmartArt"}fc(a){this.K=a;this.K.register(268,"PowerPointWebEditor.ISmartArtTextView").ma().na(()=>new KM(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ha("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(868,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().na(()=>
new MM(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),
this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lma))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.Ue(()=>{if(this.kB=a.getBooleanAppSetting("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new Cm.a((b,c)=>Object(gc.a)(268,b)?(c=Object(gb.a)(4,c))&&c.ig?new LM(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").pak()})}dispose(){this.kB&&
(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){C.a.instance.Ac(new FF)}}Object(m.a)(FF,"PPTWebEditorSmartArtPackage",null,[2,3]);class NM{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(m.a)(NM,"CT_WebTextListStyle",null,[]);var Sp=d(350);
class OM{constructor(a){this.Qna=a}y0(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,u=!!(f&64)&&!!c.lastRowField,I=!!(f&128)&&!!c.firstColField,T=!!(f&256)&&!!c.lastColField,ja=l&&I&&!!c.nwCellField,ua=l&&T&&!!c.neCellField,Ra=u&&I&&!!c.swCellField,eb=u&&T&&!!c.seCellField,Bb=!!(f&512)&&!!c.band1HField,Ub=!!(f&512)&&!!c.band2HField,Xb=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var tc=!b.Ae,lc=b.rg===a.jW,Ec=!b.qe;a=b.hg===a.Sta;var hd=1===b.Ae%2===
l;b=1===b.qe%2===I;var yd=!(l&&tc)&&!(u&&lc),Pd=!(I&&Ec)&&!(T&&a);c.wholeTblField&&this.apply(c.wholeTblField);yd&&(Bb&&hd||Ub&&!hd)&&(hd?this.apply(c.band1HField):this.apply(c.band2HField));Pd&&(Xb&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&T&&this.apply(c.lastColField);Ec&&I&&this.apply(c.firstColField);lc&&u&&(this.apply(c.lastRowField),a&&eb&&this.apply(c.seCellField),Ec&&Ra&&this.apply(c.swCellField));tc&&l&&(this.apply(c.firstRowField),a&&ua&&this.apply(c.neCellField),
Ec&&ja&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=Xk.a(b);Ze.Box4ColorHelper.neb(a)||(Sp.g(this.Qna),this.Qna.solidFillField=new nu.a,Ze.Box4ColorHelper.sEi(this.Qna.solidFillField,a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.Qna;0===b||1===b?(f.latinField=Bf.tyb(b,0),f.eaField=Bf.tyb(b,1),f.csField=Bf.tyb(b,2)):ya.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&
(b=b.fontField,null!==b.latinField&&(this.Qna.latinField=b.latinField),null!==b.eaField&&(this.Qna.eaField=b.eaField),null!==b.csField&&(this.Qna.csField=b.csField));if(0===a||1===a)this.Qna.bFieldSpecified=!0,this.Qna.bField=0===a;if(0===c||1===c)this.Qna.iFieldSpecified=!0,this.Qna.iField=0===c}}}Object(m.a)(OM,"CellTextStylePartApplier",null,[]);class Pt{constructor(a){this.Zdh=a}get value(){return this.Zdh.valField/1E5}set value(a){this.Zdh.valField=Math.floor(1E5*a)}get type(){return Pt.I4b}}
Pt.I4b="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(Pt,"LineSpacingPercent",null,[1800,1801]);class Tr{constructor(a){this.$dh=a}get value(){return this.$dh.valField/100}set value(a){this.$dh.valField=Math.floor(100*a)}get type(){return Tr.I4b}}Tr.I4b="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(Tr,"LineSpacingPoint",null,[1800,1801]);class LS{constructor(){this.valField=0}}Object(m.a)(LS,"CT_TextSpacingPoint",null,
[]);class Qt{constructor(a){this.LCe=a}get lineSpacing(){return this.LCe}get value(){return this.LCe.value}set value(a){this.LCe.value=a}static O6b(a){if(a.__type===Pt.I4b)return new Qt(new Pt(a));if(a.__type===Tr.I4b)return new Qt(new Tr(a));ya.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(m.a)(Qt,"LineSpacingWrapper",null,[]);const PM=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;
case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},QM=(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&
(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=
b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&
(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},MS=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;default:return 1}};class tz{constructor(){this.qxb=Array(tz.PYh);this.MWe=Array(tz.PYh)}}tz.PYh=9;Object(m.a)(tz,"TextListStyleCache",null,[]);class RM{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(m.a)(RM,"NumberingData",null,[]);class Ww{}
Ww.M2d="\u2022";Ww.VLi="p";Ww.WLi="n";Object(m.a)(Ww,"ListFormats",null,[]);class SM{constructor(a,b,c,f){this.bfh=this.cfh=ad.App.Xn;this.tNg=null;this.nc=a;this.Qm=b;this.qN=c;this.lB=f}get caches(){return this.tNg||(this.tNg={})}Sgg(a,b,c){const f=c-1;let l=a.C1;var u;const I=!!l&&!Ua.a.nil.equals(l[f]);if(I&&(u=this.caches[l[f].toString()]))return u=u.clone(),b=Ua.a.create(),a.Zh.NF(u,b),u;if(!I)if(l)l=Array.clone(l);else for(l=Array(9),u=0;u<l.length;u++)l[u]=Ua.a.nil;const T=I?l[f]:Ua.a.create();
u=this.dXi(a,b,c);l[f]=T;this.caches[T.toString()]=u;I||(a.C1=l);a.Zh.NF(u,T);I&&(u=u.clone(),a.Zh.NF(u,Ua.a.create()));return u}dXi(a,b,c){const f=wp.a.instance.createInstance(131073);if(b){var l=b.Hgg(a.rowIndex,a.Yi,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?PM(b,c):null)||new kt;if(l){var u=c-1;c=l.qxb[u];u=l.MWe[u];if(c||u){l=b.defRPrField||new Ar;if(u){const I=Fe.a(Fe.c(u));u=I;b.algnFieldSpecified&&(u.algnFieldSpecified=!0,u.algnField=b.algnField);b.indentFieldSpecified&&(u.indentFieldSpecified=
!0,u.indentField=b.indentField);b.lvlFieldSpecified&&(u.lvlFieldSpecified=!0,u.lvlField=b.lvlField);b.marLFieldSpecified&&(u.marLFieldSpecified=!0,u.marLField=b.marLField);b.marRFieldSpecified&&(u.marRFieldSpecified=!0,u.marRField=b.marRField);b.rtlFieldSpecified&&(u.rtlFieldSpecified=!0,u.rtlField=b.rtlField);b.buAutoNumField&&(u.buAutoNumField=b.buAutoNumField);b.buCharField&&(u.buCharField=b.buCharField);b.buClrField&&(u.buClrField=b.buClrField);b.buClrTxField&&(u.buClrTxField=b.buClrTxField);
b.buFontField&&(u.buFontField=b.buFontField);b.buFontTxField&&(u.buFontTxField=b.buFontTxField);b.buNoneField&&(u.buNoneField=b.buNoneField);b.buSzPctField&&(u.buSzPctField=b.buSzPctField);b.buSzPtsField&&(u.buSzPtsField=b.buSzPtsField);b.buSzTxField&&(u.buSzTxField=b.buSzTxField);b.defRPrField&&(u.defRPrField=b.defRPrField);b.lnSpcField&&(u.lnSpcField=b.lnSpcField);b.spcAftField&&(u.spcAftField=b.spcAftField);b.spcBefField&&(u.spcBefField=b.spcBefField);b=I}c&&(c=Fe.a(Fe.c(c)),QM(c,l),b.defRPrField=
c)}}a=Object(gb.a)(267,this.nc.ug(a));this.kXi(f,b,a?a.Ld:null)}f.He(yb.a.xdc,!0);return f}kXi(a,b,c){this.jXi(a,b);if(b){if(b.algnFieldSpecified){var f=MS(b.algnField);a.setValue(rb.a.tm,f);a.setValue(rb.a.xK,f)}b.marLFieldSpecified&&a.He(ib.a.Sm,Re.a.wzb(b.marLField));b.marRFieldSpecified&&a.He(ib.a.VZ,Re.a.wzb(b.marRField));b.indentFieldSpecified&&a.He(ib.a.Qn,Re.a.wzb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(ib.a.Iyb,Re.a.wzb(b.defTabSzField));b.spcAftField&&(f=Qt.O6b(b.spcAftField.itemField),
Object(gc.a)(Pt,f.lineSpacing)?a.setValue(yb.a.Bna,2):Object(gc.a)(Tr,f.lineSpacing)&&a.setValue(yb.a.Bna,4),a.setValue(yb.a.fga,f.value));b.spcBefField&&(f=Qt.O6b(b.spcBefField.itemField),Object(gc.a)(Pt,f.lineSpacing)?a.setValue(yb.a.Cna,2):Object(gc.a)(Tr,f.lineSpacing)&&a.setValue(yb.a.Cna,4),a.setValue(yb.a.gga,f.value));b.lnSpcField&&(f=Qt.O6b(b.lnSpcField.itemField),Object(gc.a)(Pt,f.lineSpacing)?a.setValue(yb.a.EY,2):Object(gc.a)(Tr,f.lineSpacing)&&a.setValue(yb.a.EY,4),a.setValue(yb.a.Ay,
f.value))}else ya.a.J(508692641,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Kj.eXi(a,b.defRPrField,c)}oFl(a){if(a=a.C1)for(let b=0;b<a.length;b++){const c=a[b];c&&!Ua.a.nil.equals(c)&&delete this.caches[c.toString()]}}jXi(a,b){var c=this.Aw(b);a.fz(c.propertySet);b.marLFieldSpecified&&a.setValue(ib.a.Sm,Re.a.wzb(b.marLField));b.indentFieldSpecified&&a.setValue(ib.a.Qn,Re.a.wzb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&
a.setValue(rb.a.fontSize,Kj.s_f(b.defRPrField.szField));b.spcAftField&&(c=Qt.O6b(b.spcAftField.itemField),Object(gc.a)(Tr,c.lineSpacing)&&(a.setValue(yb.a.Bna,4),a.setValue(yb.a.fga,c.value)));b.spcBefField&&(b=Qt.O6b(b.spcBefField.itemField),Object(gc.a)(Tr,b.lineSpacing)&&(a.setValue(yb.a.Cna,4),a.setValue(yb.a.gga,b.value)))}Aw(a){const {eBe:b,lFk:c}=this.Fie(a),f=Gf.a.JO(b,c);0===b&&(f.EB=f.BY=a.buAutoNumField.startAtField);return f}Fie(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Ww.VLi:case Ww.WLi:c=
3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=4;break;case 15:case 11:case 13:c=5}return{eBe:b,lFk:c}}validate(a){if(Object(gb.a)(Zg.a,a)&&(this.Qm.NHa(a)||Bj.OutlineReader.xY(a))&&a.isConnected){this.cfh=new Date;var b=Array(qi.a.G9);for(var c=0;c<qi.a.G9;++c)b[c]=new RM;c=-1;var f=0,l=!1;a=ll.a.PA(a);for(a.Um(Object(R.a)(this,this.Vwk,"listOEFilter"),
null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.N5c(b,0),this.yte(b,0,0));if(11!==a.iterator.currentNode.type)continue;const u=a.iterator,I=this.rfa(u);let T=b[I].nextListId,ja=null;if(Kc.ListReader.hl(u)){this.lB.vpa(u);ja=this.lB.yie(u);const ua=this.Ouj(u);u.Dc();if(!ja){jd.a.instance.kc("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===ja.listType){if(ja.EB!==hf.a.Wx&&b[I].restartInfo!==ja.EB||ja.listStyle!==b[I].listStyle||ua!==b[I].autonumberBulletType)l=
!0,b[I].restartInfo=b[I].nextNumber=ja.EB===hf.a.Wx?1:ja.EB,T=b[I].nextListId=0,b[I].listStyle=ja.listStyle,b[I].autonumberBulletType=ua;ja.BY=b[I].nextNumber;c!==I||l?(ja.Tla=b[I].nextNumber,l=!1):ja.Tla=hf.a.Wx;this.qN.isEmpty(u,!1)?l=!0:b[I].nextNumber++}else 1!==ja.listType&&jd.a.instance.kc("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});T||(T=b[I].nextListId=++f);u.currentNode.listID=T}c=I;ja?(0===ja.listType?this.N5c(b,I+1):this.N5c(b,I),this.yte(b,I+1,T)):(this.N5c(b,I),
this.yte(b,I,0))}this.bfh=new Date;ya.a.J(508692567,820,50,"ListCore::Validate {0}",+this.bfh-+this.cfh)}}rfa(a){this.qN.vh(a)||jd.a.instance.kc("PossibleListLevelIncorrect",{["Reason"]:Ud.a.Oea});return a.currentNode.ra(ib.a.listLevel,th.a.dHa)}vEj(a){this.qN.vh(a)||jd.a.instance.kc("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Ud.a.Oea});return a.currentNode.listID}Vwk(a){return this.qN.vh(a)||Jd.TableReader.Nq(a)||Sk.l(a)||se.isTableCell(a)}N5c(a,b){for(;b<qi.a.G9;++b)a[b].nextNumber=a[b].restartInfo=
1}yte(a,b,c){for(;b<qi.a.G9;++b)a[b].nextListId=c}Ouj(a){return a.currentNode.ra(yb.a.autonumberBulletType,8)}}Object(m.a)(SM,"ListCore",null,[863]);class Nq{constructor(a,b,c){this.eg=a;this.Rj=b;this.Gu=null;this.atb=void 0===c?null:c}get EYl(){return!1}Ysl(a){return a}gRb(a){let b,c,f;b=Kc.ListReader.mbb;c=a.propertySet.ra(ib.a.listID,0);f=a.propertySet.ra(ib.a.listLevel,-1);if(U.a.instance.ga(85)||b&&0<c&&0<=f)this.Gu=a;else{let l=1;const u=a.listStyle;b&&42!==u&&0<u&&(l=u);this.Gu=Gf.a.JO(a.listType,
l,null,c,f,void 0,"")}}mSl(a){a&&(this.Gu=a)}Hae(){}createList(a){const b=jd.a.instance.Cq(G.a.createList);ge.OutlineElementReader.vh(a)||jd.a.instance.kc("PossiblyIncorrectListCreation",{["Reason"]:Ud.a.Oea});Kc.ListReader.hl(a)&&jd.a.instance.kc("PossiblyIncorrectListCreation",{["Reason"]:Ud.a.c_i});const c=this.t4i();a.$l(c,4);a.Cl(c);b.end();return c}t4i(){return Gr.a.instance.createInstance(393234)}tqa(a){const b=jd.a.instance.Cq(G.a.tqa);ge.OutlineElementReader.vh(a)||jd.a.instance.kc("PossiblyIncorrectListRemoval",
{["Reason"]:Ud.a.Oea});Kc.ListReader.hl(a)&&this.Jzl(a);b.end()}Jzl(a){this.eg.vpa(a);a.rj()}Wvb(a,b,c,f){f=void 0===f?!1:f;const l=jd.a.instance.Cq(G.a.gEi);if(!this.CUf(b,c))return{returnValue:!1,Rdb:c};this.hNh(a,c,f);f=a.Qa(Oe.a.Cih);var u=a.ra(Oe.a.uue,!1);let I=!1;1===c.D1&&c.Yxe&&!c.pV&&(I=!0);const T=c.propertySet.ra(ib.a.fhc,null);T&&T===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?I=c.Yxe&&!c.pV:0===c.listType&&(I=0===c.listStyle));u?I&&(c.Rqa(16,0),a.setValue(Oe.a.pF,16),a.setValue(Oe.a.iga,
0)):(u=this.eg.Aw(b),this.LQh(c,u,f,I,a)&&(l.properties.$("ToggledOff","true"),c.Rqa(16,0),this.xRl(a)),0===c.listType&&a.Qa(Oe.a.HYa)&&(c.EB=a.$a(Oe.a.HYa),a.removeProperty(Oe.a.HYa)));if(f&&(l.properties.$("MultipleOESelection","true"),(()=>{let ja=this.CQh(b,c);({Rdb:c}=ja);return ja})().returnValue))return l.end(),{returnValue:!1,Rdb:c};this.JBi(b,c,a);a.setValue(Oe.a.uue,!0);l.end();return{returnValue:!0,Rdb:c}}LQh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&
a.EB===hf.a.Wx;a=a.listStyle===b.listStyle&&a.EB===b.EB;this.eg.Gfb&&(a=a&&!c);return f&&(l||a)}return!1}xRl(a){a.setValue(Oe.a.pF,16);a.setValue(Oe.a.iga,0)}hNh(){}CUf(){return!0}CQh(a,b){return{returnValue:16!==b.listType&&ge.OutlineElementReader.isEmpty(a,!0),Rdb:b}}Exb(a){const b=jd.a.instance.Cq(G.a.Exb);$a.ParagraphReader.ke(a)||jd.a.instance.kc("ClearingListFromNonParagraph",{["Reason"]:Ud.a.pae});const c=new mb.GraphIterator;c.set(a);c.wf();c.eD(12);jb.OutlineElementNavigator.$e(c);this.ISa(c,
null);b.end()}t0d(){}merge(a,b,c){const f=jd.a.instance.Cq(G.a.Uwk);ge.OutlineElementReader.vh(b)||jd.a.instance.kc("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});ge.OutlineElementReader.vh(a)||jd.a.instance.kc("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});if(Kc.ListReader.hl(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=Kc.ListReader.mbb;c&&this.EYl&&Kc.ListReader.hl(a)&&this.tqa(a);(!Kc.ListReader.hl(a)||c&&l)&&c&&(c=this.xie(b),this.eg.SVh&&
c.propertySet.He(rb.a.IYa,hf.a.Wx),1===c.D1&&c.uWf(),this.ISa(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true"));Nq.XM.w8c&&this.zQi(b,a);this.tqa(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}zQi(a,b){a=$a.ParagraphReader.dBb(a.currentNode);b=this.eg.flg(b);this.Ryd(b,a,null)}xie(a){return this.eg.Aw(a)}Ryd(a,b,c){if(a){b=me.a.create(b);var f=Od.a.yt(b);this.s3a(a,rb.a.fontColor,c,f);this.s3a(a,rb.a.fontSize,c,f);if(this.atb){let l,u;(()=>{let I=this.getPropertyValue(rb.a.font,
c,f,"");({value:l}=I);return I})().returnValue&&this.atb.rW(a,l);(()=>{let I=this.getPropertyValue(ib.a.EW,c,f,-1);({value:u}=I);return I})().returnValue&&this.atb.HNa(a,u)}else this.s3a(a,rb.a.font,c,f),this.s3a(a,ib.a.EW,c,f);Nq.XM.w8c&&(this.s3a(a,rb.a.bold,c,f),this.s3a(a,rb.a.italic,c,f),this.s3a(a,rb.a.superscript,c,f),this.s3a(a,rb.a.subscript,c,f))}}XMh(){}s3a(a,b,c,f){c&&c.Qa(b)?a.setValue(b,c.$a(b)):f&&f.cache&&(c=f.cache,c.Qa(b)&&a.setValue(b,c.$a(b)))}getPropertyValue(a,b,c,f){if(b&&b.Qa(a))return f=
b.$a(a),{returnValue:!0,value:f};if(!c||!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Qa(a)?(f=b.$a(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}U9f(a,b){b.Qa(Oe.a.pF)||(a===G.a.qL?b.setValue(Oe.a.pF,1):a===G.a.aO&&b.setValue(Oe.a.pF,0));b.Qa(Oe.a.iga)||b.setValue(Oe.a.iga,0);return b}SSa(a,b,c,f,l,u,I){a=jd.a.instance.Cq(G.a.SSa);const T=this.eg.Aw(b);c=Gf.a.JO(0,c);c.EB=f;c.Ita=u;T&&c.Bne(T)&&c.EB===T.BY||(f=new pg.GraphTransaction(15),f.Jz(b),b=this.VGj(c),null!=b&&I.numbering(b)&&
(da.ULS.sendTraceTag(509747284,393,50,"Found list insert matching string "+u),Nq.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}VGj(a){var b;const c=null===(b=null===ss||void 0===ss?void 0:ss[a.listType])||void 0===b?void 0:b[a.Ita];if(null==c)return null;b=new W.DictionaryPropertySet;b.setValue(Oe.a.pF,a.listType);b.setValue(Oe.a.iga,a.listStyle);b.setValue(Oe.a.HYa,a.EB);b.setValue(rb.a.Dj,c.Dj);this.AOl(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return Nq.Ch||
(Nq.Ch=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get XM(){return Nq.QL||(Nq.QL=Tb.a.instance.ub("Box4.List.ListSettings"))}}Nq.Ch=null;Nq.QL=null;Object(m.a)(Nq,"ListEditor",null,[862]);class yo{}yo.CQe=80640;yo.DQe=0;yo.tpe=80640;yo.upe=-80640;Object(m.a)(yo,"ParagraphConstants",null,[]);var Sm=d(187);class TM extends Nq{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){super(a,b);this.Zad=[rb.a.Dj,rb.a.font];this.tgd=[rb.a.Dj,rb.a.font,rb.a.fontColor,yb.a.autonumberBulletType,
yb.a.jAb];this.cKa=c;this.Plc=f;this.eIb=l.bEg;this.qN=u;this.Qm=I;this.DI=ja;this.vB=ua;this.Pi=Ra;this.Nxa=eb;this.mlc=l.Jwe;this.whb=l.dEg;this.jN=Bb;this.Ub=Ub;this.Ga=Xb;this.yxa=l.pptCopyPasteListMarkerEnabled;this.llc=l.pptCopyPasteMarginAndIndentationEnabled;this.JXg=l.pptCopyPasteTextWithSpacingFromExternal}gRb(a){super.gRb(a);this.whb&&this.eTc(a.propertySet,this.Gu.propertySet)}Z7e(a){if(this.eIb&&this.Gu&&this.Gu.propertySet){const b=this.Gu.propertySet.ra(ib.a.listLevel,-1);-1!==b&&this.$7e(a,
b)}this.yxa&&this.Gu&&(this.Gu.sAb=!0);this.JXg&&this.LMh(a);this.u0d(a,this.Gu);this.Gu=null}xMh(a,b,c){b=this.Rj.Sdc(a);this.Rj.xSb(a,b,c,!1,!0)}CUf(a,b){if(!a||!b)return!1;if(a.Gb(4)){var c=this.eg.yie(a);this.cKa.$e(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Gb(2);const f=c.ra(ib.a.Qn,th.a.indent),l=c.ra(ib.a.Sm,th.a.leftMargin);this.cKa.$e(a);a=f;let u=l;({indent:a,margin:u}=this.u3d(Kj.qRf($a.ParagraphReader.cma(c,rb.a.fontSize,0)),b.listType,f,l,a,u));return!!(this.vlk(u)&
this.lkk(a))}nkg(a,b,c,f){if(!a)return ya.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),{Kze:c,spe:f};b&&(c=b.ra(yb.a.C7b,th.a.leftMargin),f=b.ra(yb.a.G9d,th.a.indent),(a=this.Ga.Gn(a))&&a.vd&&(c=b.ra(ib.a.Sm,th.a.leftMargin),f=b.ra(ib.a.Qn,th.a.indent)));return{Kze:c,spe:f}}TTf(a,b,c,f){if(!a||!this.qN.vh(b))return ya.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{Fde:c,Ede:f};
var l=this.BR(b,this.DI.rfa(b));if(l){const u=a.ra(ib.a.Sm,th.a.leftMargin),I=a.ra(ib.a.Qn,th.a.indent);c=u;f=I;let T=th.a.leftMargin,ja=th.a.indent;({Kze:T,spe:ja}=this.nkg(a,l,T,ja));l=Gf.a.$Ea(l,null).listType;const ua=u+(0<=I?0:I),Ra=T+(0<=ja?0:ja),eb=b.Gb(4);let Bb=16;eb&&(Bb=this.Plc.qBb(eb),b.Dc());ja&&ua===Ra&&l===Bb?(c=T,f=ja):({indent:f,margin:c}=this.u3d(this.ocb(a),Bb,I,u,f,c),c=Math.max(Math.min(c,yo.CQe),yo.DQe),f=Math.max(Math.min(f,yo.tpe),yo.upe))}return{Fde:c,Ede:f}}izj(a,b){if(!a||
!this.qN.vh(b))return ya.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),th.a.leftMargin;let c=th.a.leftMargin,f=th.a.indent;({Fde:c,Ede:f}=this.TTf(a,b,c,f));0<c&&ya.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}ezj(a,b){if(!a||!this.qN.vh(b))return ya.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),th.a.indent;let c=th.a.leftMargin,f=th.a.indent;({Fde:c,
Ede:f}=this.TTf(a,b,c,f));0<f&&ya.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}CQh(a,b){return{returnValue:!1,Rdb:b}}LQh(a,b,c,f,l){return f?!0:!b||l&&l.Qa(rb.a.Dj)?!1:a.listType===b.listType}vlk(a){return a<yo.CQe&&a>=yo.DQe}lkk(a){return a<yo.tpe&&a>=yo.upe}AOl(a,b){a.setValue(yb.a.autonumberBulletType,b)}IZl(a){return a}Hae(a,b){a.Qa(ib.a.listLevel)&&b.He(ib.a.listLevel,a.$h(ib.a.listLevel))}JEj(a,b){return Object(gc.a)(Sm.TableCellNode,a)?this.DI.Sgg(a,this.vB.p2c(a),b):this.EGj(a,
b)}EGj(a,b){--b;const c=a.ra(ib.a.C1,[]);return 0>b||b>=c.length?(ya.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",b),jd.a.instance.kc("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Zh.Ie(c[b])}Ryd(){}$7e(a,b){if(this.qN.vh(a)&&0<=b&&b<qi.a.G9){const c=a.currentNode,f=a.Gb(2);c&&c.setValue(ib.a.listLevel,b);f&&(f.setValue(ib.a.listLevel,b),a.Dc())}}ORl(a,b){if(this.qN.vh(a)&&b&&b.propertySet){var c=a.Gb(4);c&&(b.rCb&&b.caa&&(this.whb?
(this.eTc(b.propertySet,c),this.yxa&&b.propertySet.Qa(yb.a.autonumberBulletType)&&c.setValue(yb.a.autonumberBulletType,b.propertySet.$a(yb.a.autonumberBulletType))):c.setValue(rb.a.Dj,b.caa)),a.Dc())}}XMh(a){if(this.qN.vh(a)){if(this.eIb&&this.Gu&&this.Gu.propertySet){const b=this.Gu.propertySet.ra(ib.a.listLevel,-1);-1!==b&&this.$7e(a,b);this.ORl(a,this.Gu)}this.llc&&this.oRl(a);this.yxa&&(this.Gu&&this.Gu.propertySet?this.ijk(this.Gu)||(ya.a.J(512496285,820,50,"Copied from external, such as website."),
this.a8e(a)):(ya.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.a8e(a)));this.JXg&&this.LMh(a);this.Gu=null}else ya.a.J(512496288,820,10,"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}LMh(a){const b=this.DI.rfa(a),c=this.BR(a,b),f=a.Gb(2);c&&f&&0<=b&&b<qi.a.G9&&(this.Gu&&this.Gu.propertySet&&this.Gu.propertySet.Qa(yb.a.Ay)||(ya.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(yb.a.Ay,c.ra(yb.a.U9i,
th.a.lineSpacing)),f.setValue(yb.a.EY,c.ra(yb.a.V9i,2))),this.Gu&&this.Gu.propertySet&&this.Gu.propertySet.Qa(yb.a.gga)||(ya.a.J(512496283,820,50,"Get master defined line-spacing before"),f.setValue(yb.a.gga,c.ra(yb.a.i$i,th.a.HIg)),f.setValue(yb.a.Cna,c.ra(yb.a.j$i,4))),this.Gu&&this.Gu.propertySet&&this.Gu.propertySet.Qa(yb.a.fga)||(ya.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(yb.a.fga,c.ra(yb.a.g$i,th.a.GIg)),f.setValue(yb.a.Bna,c.ra(yb.a.h$i,4))));a.Dc()}ijk(a){if(a.propertySet.Qa(rb.a.Dj)){const b=
a.propertySet.$a(rb.a.Dj).length;if(1===b&&a.propertySet.Qa(rb.a.font)||3===b&&a.propertySet.Qa(yb.a.autonumberBulletType))return!0}return!1}oRl(a){var b=this.DI.rfa(a);const c=this.BR(a,b),f=a.Gb(2);c&&f&&0<=b&&b<qi.a.G9&&(this.Gu&&this.Gu.propertySet&&this.Gu.propertySet.Qa(ib.a.Sm)||(ya.a.J(512496281,820,50,"Get master defined indent-left."),c.Qa(yb.a.C7b)&&f.setValue(ib.a.Sm,c.$a(yb.a.C7b)),(b=this.Ga.Gn(f))&&b.vd&&f.setValue(ib.a.Sm,c.ra(ib.a.Sm,th.a.leftMargin))),this.Gu&&this.Gu.propertySet&&
this.Gu.propertySet.Qa(ib.a.Qn)||(ya.a.J(512496280,820,50,"Get master defined firstline indent."),c.Qa(yb.a.G9d)&&f.setValue(ib.a.Qn,c.$a(yb.a.G9d)),(b=this.Ga.Gn(f))&&b.vd&&f.setValue(ib.a.Qn,c.ra(ib.a.Qn,th.a.leftMargin))));a.Dc()}a8e(a){const b=this.DI.rfa(a),c=this.BR(a,b),f=a.Gb(4);c&&f&&0<=b&&b<qi.a.G9&&(ya.a.J(512496279,820,50,"Get master defined list marker"),c.Qa(rb.a.Dj)?(f.setValue(rb.a.Dj,c.$a(rb.a.Dj)),c.Qa(rb.a.font)?f.setValue(rb.a.font,c.$a(rb.a.font)):c.Qa(yb.a.autonumberBulletType)&&
f.setValue(yb.a.autonumberBulletType,c.$a(yb.a.autonumberBulletType))):(f.setValue(rb.a.font,gi.wSf),f.setValue(rb.a.Dj,[gi.M2d])));a.Dc()}E7c(a){return a?16!==this.DI.Fie(a).eBe:!1}Exb(){ya.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");jd.a.instance.kc("FormattingNotCleared",{["Reason"]:Ud.a.Syg})}Iyl(a){if(this.qN.vh(a)){var b=a.Gb(4);b&&(1===this.Plc.qBb(b)&&b.removeProperty(yb.a.autonumberBulletType),a.Dc())}}kSl(a){this.qN.vh(a)&&(a=
a.currentNode)&&a.setValue(yb.a.Jmk,!0)}merge(a,b,c,f){const l=this.DI.rfa(b),u=this.BR(a,this.DI.rfa(a)),I=this.BR(b,l);u&&a&&(a.Gb(2),a.currentNode&&(a.currentNode.Qa(ib.a.Sm)&&u.Qa(ib.a.Sm)&&!wi.APropertySet.V1a(ib.a.Sm.type,a.currentNode.$h(ib.a.Sm),u.$h(ib.a.Sm))&&u.He(ib.a.Sm,a.currentNode.$h(ib.a.Sm)),a.currentNode.Qa(ib.a.Qn)&&u.Qa(ib.a.Qn)&&!wi.APropertySet.V1a(ib.a.Qn.type,a.currentNode.$h(ib.a.Qn),u.$h(ib.a.Qn))&&u.He(ib.a.Qn,a.currentNode.$h(ib.a.Qn))),a.Dc());super.merge(a,b,c);c&&this.eIb&&
(this.$7e(a,l),this.kSl(a),this.Iyl(a));this.VBi(b,I,u);if(f&&(a.Gb(2),c=a.currentNode.ra(yb.a.KMa,""),a.Dc(),c.length))for(a=this.Ub.Whe(b);a.Qf(1)&&a.currentNode!==f.currentNode;)a.Gb(2),a.currentNode.setValue(yb.a.KMa,c),a.Dc();return!0}JBi(a,b,c){const f=$c.a.Kb;f&&(f.tk=!0);c.ra(Oe.a.uue,!1);this.u0d(a,b,c)}Dbm(a,b){var c=mb.GraphIterator.ob(b);this.eg.vpa(c);b=c.currentNode;c.Dc();c=this.createList(a);a.Dc();c.eab(b,yb.a.shapeId,yb.a.sza)}ISa(a,b){this.u0d(a,b)}MMf(a,b,c){this.qN.vh(a)||jd.a.instance.kc("PossibleIndentNotAdjusted",
{["Reason"]:Ud.a.Oea});const f=a.Gb(2),l=f.ra(ib.a.Qn,th.a.indent),u=f.ra(ib.a.Sm,th.a.leftMargin);this.cKa.$e(a);if(16===b)this.Nxa.Cw.Knb(f,0),0>l&&(jd.a.instance.kc("UnexpectedlyChangingLeftIdent",{["Reason"]:"NegativeLeftIndent"}),this.Rj.Lnb(a,1,Math.max(u+l,0)));else{var I=this.BR(a,this.DI.rfa(a));I||(I=new W.DictionaryPropertySet,ya.a.J(512496273,820,50,"listStyle is null"));var T=th.a.indent;let ja=th.a.leftMargin;c?{Kze:ja,spe:T}=this.nkg(f,I,ja,T):(T=I.ra(ib.a.Qn,th.a.indent),ja=I.ra(ib.a.Sm,
th.a.leftMargin));I=Gf.a.$Ea(I,null).listType;const ua=ja+(0<=T?0:T);T&&u+(0<=l?0:l)===ua&&I===b?(this.Nxa.Cw.Knb(f,T),this.Rj.Lnb(a,1,ja)):(T=l,I=u,{indent:T,margin:I}=this.u3d(this.ocb(f),b,l,u,T,I),0<this.DI.rfa(a)&&c&&(I+=ja),I=Math.max(Math.min(I,yo.CQe),yo.DQe),T=Math.max(Math.min(T,yo.tpe),yo.upe),this.Nxa.Cw.Knb(f,T),this.Rj.Lnb(a,1,I))}}ocb(a){if(!a)return 0;a=this.Qm.I$(a)?this.Qm.pPj(this.Qm.DBb(a)):$a.ParagraphReader.cma(a,rb.a.fontSize,0);return Kj.qRf(a)}u3d(a,b,c,f,l,u){let I=(b=1===
b)?.3125:.375;0<a&&(I=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);a=-1*Re.a.Sva(I);0>=c&&a<c?(u=a-c,l=c+u,u=f-u):0<c&&(l=a,u=f-a);return{indent:l,margin:u}}VBi(a,b,c){if(b&&c){jb.OutlineElementNavigator.Ti(a);var f=a.lr;if($a.ParagraphReader.Pl(a)){b=b.ra(rb.a.fontSize,Xg.fontSize);c=c.ra(rb.a.fontSize,Xg.fontSize);for(let l=0;l<f.Sa.length;++l){const u=f.Sa.ga(l);u&&u.formatting&&
u.formatting.RA&&u.formatting.RA.Qa(rb.a.fontSize)&&u.formatting.RA.$a(rb.a.fontSize)===b&&this.Pi.$q(u.formatting,c)}}jb.OutlineElementNavigator.$e(a)}}xie(a){if(this.yxa){if(a=this.eg.Aw(a))a.sAb=!0;return a}return super.xie(a)}u0d(a,b,c){c=void 0===c?null:c;if(this.qN.vh(a)){this.aCi(b,c,a);var f=a.Gb(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?Gf.a.$Ea(f,f).B5b():f=this.createList(a);a.Dc();const l=a.Gb(2);a.Dc();this.mlc&&l.ra(Oe.a.xfc,!1)||this.yxa&&b.sAb?f.eab(b.propertySet,yb.a.shapeId,
yb.a.sza,ib.a.listLevel,rb.a.Dj,Oe.a.pF):f.eab(b.propertySet,yb.a.shapeId,yb.a.sza,ib.a.listLevel,yb.a.MHa);c&&c.Qa(yb.a.autonumberBulletType)&&f.setValue(yb.a.autonumberBulletType,c.$a(yb.a.autonumberBulletType));this.yxa&&b.sAb&&b.rCb&&(3===b.caa.length&&b.propertySet.Qa(yb.a.autonumberBulletType)?(f.setValue(rb.a.Dj,b.caa),f.setValue(yb.a.autonumberBulletType,b.propertySet.$a(yb.a.autonumberBulletType)),ya.a.J(512496267,826,50,"Support CCP customized number list")):1===b.caa.length&&b.udb?(f.setValue(rb.a.Dj,
b.caa),f.setValue(rb.a.font,b.font),ya.a.J(512496266,826,50,"Support CCP customized bullet")):(ya.a.J(512496265,826,50,"Set list use dst master liststyle."),this.a8e(a)))}else return;else a.rj();b&&b.Geg||(this.mlc?(c=this.eg.Aw(a),this.MMf(a,c?c.listType:16,b?b.sAb:!1)):this.MMf(a,b?b.listType:16,b?b.sAb:!1))}else ya.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),jd.a.instance.kc("FailedToApplyListProperties",{["Reason"]:Ud.a.Oea})}aCi(a,b,c){b&&a&&(1===
a.listType||0===a.listType)&&(this.jN.fz(b,a.propertySet,this.Zad),c=this.BR(c,this.DI.rfa(c))||new W.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(Oe.a.iga,6),b.Qa(rb.a.Dj)||(a.propertySet.setValue(rb.a.font,gi.wSf),a.propertySet.setValue(rb.a.Dj,[gi.M2d]),c.Qa(rb.a.Dj)&&(b=c.$a(rb.a.Dj)[0],b!==gi.m9d&&b!==gi.uLa&&this.jN.fz(c,a.propertySet,this.Zad)))))}BR(a,b){this.qN.vh(a)||jd.a.instance.kc("PossibleLossOfListStyle",{["Reason"]:Ud.a.Oea});a=this.mPj(a);return a?this.JEj(a,1+b):
(ya.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),jd.a.instance.kc("PossibleLossOfListStyle",{["Reason"]:Ud.a.FZf}),null)}mPj(a){a=mb.GraphIterator.aI(a);a.h8(Bj.OutlineReader.tfc);const b=a.ay(16);return b?b:a.j5a()}qBb(a){return this.DI.Fie(a).eBe}hNh(a,b,c){c||0!==b.listType||(b.EB=a.ra(rb.a.IYa,hf.a.Wx))}eTc(a,b){this.jN.Y0i(a,b,this.tgd)}}Object(m.a)(TM,"ListEditor",Nq,[861,862]);class Rt{constructor(a,b){this.u4b=a;this.Kwb=b}}Object(m.a)(Rt,"BulletMarker",null,
[]);class St{constructor(a,b){this.zSf=a;this.dkh=b}}Object(m.a)(St,"ListMarkerPreview",null,[]);class Tt{constructor(a,b,c){this.Ujh=a;this.$jh=b;this.K1d=c}}Object(m.a)(Tt,"NumberingMarker",null,[]);class UM{constructor(a,b){this.Ub=a;this.IKb=b;this.BMk=new Hc.a(Object(R.a)(this,this.n4i,"createListBulletDictionary"));this.GMk=new Hc.a(Object(R.a)(this,this.u4i,"createListNumberingDictionary"));this.FMk=new Hc.a(Object(R.a)(this,this.s4i,"createListMarkerPreviewDictionary"));this.DMk=new Hc.a(Object(R.a)(this,
this.r4i,"createListMarkerAltTextDictionary"))}n4i(){const a=new Md.a;a.$(3,new Rt(8226,"Arial"));a.$(4,new Rt(111,"Courier New"));a.$(5,new Rt(167,"Wingdings"));a.$(6,new Rt(113,"Wingdings"));a.$(7,new Rt(118,"Wingdings"));a.$(8,new Rt(216,"Wingdings"));a.$(9,new Rt(252,"Wingdings"));return a}u4i(){const a=new Md.a;a.$(11,new Tt(0,".",8));a.$(12,new Tt(0,")",7));a.$(13,new Tt(1,".",15));a.$(14,new Tt(3,".",5));a.$(15,new Tt(4,")",2));a.$(16,new Tt(4,".",4));a.$(17,new Tt(2,".",14));return a}s4i(){const a=
new Md.a;a.$(1,new St("\u2022",["1.","2.","3."]));a.$(2,new St("o",["1)","2)","3)"]));a.$(3,new St("\uf0a7",["I.","II.","III."]));a.$(4,new St("\uf071",["A.","B.","C."]));a.$(5,new St("\uf076",["a)","b)","c)"]));a.$(6,new St("\uf0d8",["a.","b.","c."]));a.$(7,new St("\uf0fc",["i.","ii.","iii."]));return a}r4i(){const a=new Md.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);
a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);
return a}get FYa(){return this.BMk.value}get Snd(){return this.GMk.value}get v$c(){return this.FMk.value}get PIg(){return this.DMk.value}nPf(a,b){if(!md.a("FixListIssueForGroupedShape"))return this.U0d(a,b);if(!a)return!0;let c=!0;if(a.Lf){for(const f of a.rx())if(c=c&&this.U0d(f,b),!c)return!1;return!0}return this.U0d(a,b)}U0d(a,b){a=this.Ub.Pc(a);for(var c=a.Gb(1);c;){var f=a.Gb(4);if(f){if(1===b){if(1!==f.ra(Oe.a.pF,16))return!1}else if(2===b){if(0!==f.ra(Oe.a.pF,16))return!1}else if(c=f.ra(rb.a.Dj,
null),this.IKb.i6c(b)){f=f.ra(rb.a.font,"");const l=this.FYa.ga(b);if(!c||1!==c.length||l.u4b!==c[0]||l.Kwb!==f)return!1}else if(this.IKb.j6c(b)){if(f=this.Snd.ga(b),!c||3!==c.length||f.Ujh!==c[1]||f.$jh!==Aa.a.fromCharCode(c[2]))return!1}else return!1;a.Dc()}else if(0!==b)return!1;c=a.Qf(1)}return!0}i6c(a){return this.IKb.i6c(a)}j6c(a){return this.IKb.j6c(a)}Cbc(a){return this.IKb.Cbc(a)}t2c(a){return this.IKb.t2c(a)}}Object(m.a)(UM,"PptListMarkersLoader",null,[865,864]);class VM{Llm(a,b){if(!a)return!1;
b.Gb(2);a=b.currentNode.ra(Oe.a.xfc,!1);b.Dc();return!a}}Object(m.a)(VM,"PptMergeListEditorInOutlineElementStrategy",null,[866]);class UB{constructor(){this.ULi=[0,3,4,5,6,7,8,9];this.z1k=[0,11,12,13,14,15,16,17]}i6c(a){return 3<=a&&9>=a}j6c(a){return 11<=a&&17>=a}Cbc(a){return UB.Opg(a,this.ULi,1)}t2c(a){return UB.Opg(a,this.z1k,2)}static Opg(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(m.a)(UB,"TextBulletTypeHelper",null,[864]);class GF{get name(){return"PowerPointWebEditor.ListEditor"}fc(a){a.register(861,
"PowerPointWebEditor.IPptListEditor").ma().na(()=>new TM(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(862,"Box4.List.IListEditor").ma().na(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(863,"PowerPointWebEditor.IPptListCore").ma().na(()=>new SM(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),
a.resolve("PowerPointWebEditor.ListReader")));a.register(864,"PowerPointWebEditor.ITextBulletTypeHelper").ma().na(()=>new UB);a.register(865,"PowerPointWebEditor.IPptListMarkersLoader").ma().na(()=>new UM(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(866,"Box4.IMergeListEditorInOutlineElementStrategy").ma().na(()=>new VM)}init(){}dispose(){}static main(){C.a.instance.Ac(new GF)}}Object(m.a)(GF,"PPTWebEditorListEditorPackage",null,
[2,3]);var NS=d(908);class WM{fl(a){return Jd.TableReader.fl(a)}ej(a){return Jd.TableReader.ej(a)}I1c(a,b,c){return Jd.TableReader.I1c(a,b,c)}nu(a){return Jd.TableReader.nu(a)}kfb(a){return Jd.TableReader.kfb(a)}Ft(a){return Jd.TableReader.Ft(a)}zM(a){return Jd.TableReader.zM(a)}}Object(m.a)(WM,"TableReaderProxy",null,[1739]);class XM{bDg(){return Sk.j(void 0)}zKj(a){return Sk.c(a)}}Object(m.a)(XM,"TableRowReaderProxy",null,[1740]);class YM extends Sf.a{constructor(a,b,c,f,l){super(a,b);this.Thi=
l;this.ZL=f;a=l&&this.eb.ra(ib.a.skippedCell,!1);b=this.Vd.Tp(va.a.oXh);this.mc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.ZL.xs?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.R5f()}fW(){return J.a.wqc}Oz(){this.Thi&&this.eb.ra(ib.a.skippedCell,!1)&&this.FTl()}FTl(){this.ZL.xs&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft="",this.htmlElement.style.borderBottom=
"",this.htmlElement.style.borderRight="")}}Object(m.a)(YM,"GhostTableCellViewElement",Sf.a,[1741,489,393,106]);class ZM{constructor(a,b,c){this.sWd=a;this.ZL=b;this.Krb=c}create(a,b){return se.isGhostCellNode(b.node)?se.shouldRenderGhostCellNode(b.node)?new YM(a,b,this.sWd,this.ZL,U.a.instance.ga(63),U.a.instance.ga(77)):null:this.Krb.create(a,b)}}Object(m.a)(ZM,"GhostTableCellViewElementFactory",null,[676]);class $M{constructor(a,b,c){this.Cc=a;this.bha=b;this.C5g=c;this.WG=null;this.qHb=this.rHb=
-1}fUl(a,b){b=void 0===b?null:b;this.hUl(a);this.WG&&this.zQl(b)}rUi(){this.WG=null;this.qHb=this.rHb=-1}ihg(a,b,c){if(!a||!this.WG)return{row:b,column:c};var f=this.bha.lcg(a,this.WG,this.C5g.RQc,this.C5g.QQc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.Yi;l===b||this.bha.s6c(a,this.WG)||(l=b);var u=0,I=this.Cc.ej(this.WG)-1;let T=0,ja=this.Cc.fl(this.WG)-1;this.bha.s6c(a,this.WG)&&b>=T&&b<=ja&&c>=u&&c<=I&&(a=(u=(u=this.WG.tf(b,c))?u.$z():null)?u.rowSpan:0,I=u?u.colSpan:0,u=c,I=c+I-1,T=b,ja=
b+a-1);l>=T&&l<=ja&&f>=u&&f<=I&&(b=l,c=f);return{row:b,column:c}}p_k(a){a=this.Bpg(a);return!!a&&14===a.type&&a.rq()}gCi(a,b,c,f,l,u){if(!this.WG||!a||14!==a.type||this.WG!==a||!b)return{Peg:c,Eeg:f,yYh:l,wYh:u};this.WG.tf(c,f).isControllingCell&&({rowIndex:c,qla:f}=this.WBj(c,f));if(this.WG.tf(l,u).isControllingCell||!this.bha.s6c(b,this.WG))({row:l,column:u}=this.ihg(b,l,u));ya.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{Peg:c,Eeg:f,yYh:l,wYh:u}}hUl(a){(a=this.Bpg(a))&&
14===a.type&&(this.WG=a)}Bpg(a){return 1074135132===a.hf&&a.vd?this.Cc.XO(a):this.Cc.ybc(a)}zQl(a){this.WG&&a&&({row:this.rHb,column:this.qHb}=this.ihg(a,this.rHb,this.qHb))}WBj(a,b){if(!this.WG)return{rowIndex:a,qla:b};let c=null;0<=a&&a<this.Cc.fl(this.WG)&&0<=b&&b<this.Cc.ej(this.WG)&&(c=this.WG.tf(a,b));this.gjk(c)&&(a=this.rHb,b=this.qHb);return{rowIndex:a,qla:b}}gjk(a){if(!this.WG)return!1;let b=0;var c=this.Cc.ej(this.WG)-1;let f=0;var l=this.Cc.fl(this.WG)-1;if(a){l=a.rowIndex;c=a.Yi;const u=
a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+u-1}return this.rHb>=f&&this.rHb<=l&&this.qHb>=b&&this.qHb<=c}}Object(m.a)($M,"PptTableDragSelectionCellExtendStrategy",null,[906]);var aN=d(856),Yn=d(243);class bN{constructor(){this.Q3c=this.colSpan=this.Iwd=0}}Object(m.a)(bN,"HeightInfo",null,[]);class cN{constructor(){this.oTa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.Ytg=this.Dug=this.GCg=this.ICg=this.HCg=!1}}Object(m.a)(cN,"TableCellInfo",null,[]);class dN{constructor(){this.bbi=
[]}get cells(){return this.bbi}LYd(a){this.cells.push(a)}}Object(m.a)(dN,"TableRowInfo",null,[]);class eN{constructor(){this.oTa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.XBg=this.aDg=this.bCg=!1}}Object(m.a)(eN,"UpdateInfo",null,[]);var OS=d(1107),fN=d(569);class Xw extends fN.a{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){super(a,b,eb);this.KQa=!1;this.$6a=this.tEf=this.pUd=this.Z6a=this.MIa=null;this.VQd=0;this.UQi=1;this.SQi=16;this.JQi=256;this.MQi=4096;this.TQi=
65536;this.dHc=this.wHc=this.GHc=this.PHc=!1;this.wof=this.iHf=this.NKc=this.iIc=this.oja=0;this.cEe=this.dEe=null;this.spi=Object(gb.a)(344,b);this.wda=c;this.Qda=Ub;this.kd=Ra;this.mX=Bb;this.ZL=ua;this.YLc=T;this.gka=ja;this.fka=I;this.Cs=u;this.Ied=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("PPTOTableCellDiagonalBordersEnabled");a=this.Vd.Tp(va.a.oXh);this.mc(a);this.R_=this.Vd.Tp(va.a.div);a.appendChild(this.R_);this.R_.className="TableCellContent";this.rp(this.R_)}R$b(){return this.R_.offsetHeight+
this.R_.offsetTop}SBc(a,b,c,f){a=this.KQa?a:a+c;this.MIa||(this.MIa=this.yTc());this.MIa.style.left=a-2.5+"px";this.MIa.style.top=b+"px";this.MIa.style.height=f+"px"}R1f(){const a=this.Vd.Tp(va.a.div);ig.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}yTc(){const a=this.R1f();a.className="TableColumnResizeHandle";return a}k8d(){const a=this.Vd.Tp(va.a.div);ig.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);a.className=Te.a.pyl;return a}nhm(a,b,c,
f){f?(a=this.KQa?a:a+b,this.Z6a||(this.Z6a=this.p2i()),b=this.Z6a.style,b.top=c+"px",b.left=a+"px"):this.Z6a&&(this.TWf(this.Z6a,!1),this.Z6a=null);return this.Z6a}p2i(){const a=this.k8d(),b=this.Vd.Tp(va.a.div);ig.c(b,!0);b.className=Te.a.fqe;a.appendChild(b);return a}Wjm(a,b,c,f){this.fij();const l=this.pUd.style;l.top=c+"px";l.left=f+"px";c=this.tEf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}fij(){if(!this.pUd){const a=this.k8d(),b=this.Vd.Tp(va.a.div);ig.c(b,!0);b.className=Te.a.Zxg;a.appendChild(b);
this.pUd=a;this.tEf=b}}$jm(a,b,c){c?(this.$6a||(this.$6a=this.n6i()),c=this.$6a.style,c.top=a+b-10+"px",this.KQa?c.right="-15px":c.left="-15px"):this.$6a&&(this.TWf(this.$6a,!0),this.$6a=null);return this.$6a}n6i(){const a=this.k8d(),b=this.Vd.Tp(va.a.div);ig.c(b,!0);b.className=Te.a.gqe;a.appendChild(b);return a}LCh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}TWf(a,b){b?Yn.a.ETi(a):Yn.a.ATi(a);this.htmlElement.removeChild(a)}NCg(a){a=a?G.a.Yva:A.AFrameworkApplication.isRtl?
G.a.$db:G.a.kXa;return 8!==A.AFrameworkApplication.Pa.Ai(me.a.create(this.eb),a,1,!0,new OS.a,null)}fW(a){super.fW(a);const b=super.fW(a);this.VQd=this.OOj(a);if(this.Qda.wy&&!this.Tc.Nm){var c=ui.a.ob(a.L3,a.currentNode);c.wf();this.fka.$e(c);a=this.YLc.getContainingTable(a);this.gka.vh(c)&&a&&!this.Cs.REa(a)&&(c=c.Ur)&&c.htmlElement&&this.wda.m0f(c.htmlElement,a,this.Na)}return new J.a(b.tpa+this.iIc+wo.a.hpb,Math.max(b.minWidth,this.VQd),b.upa+this.NKc+wo.a.hpb)}OOj(a){return Jd.TableReader.ZDb(a)?
(a=this.Qda.Gwe?this.eb.ra(ye.a.Z3d,1):1,a*wo.a.kdf+(a-1)*(this.iIc+this.NKc+wo.a.hpb)):wo.a.kdf}m8(a){this.R_.style.paddingLeft=a.tpa-wo.a.hpb+"px";this.R_.style.paddingRight=a.upa-wo.a.hpb+"px";this.Qda.V7c&&this.Qda.Gwe&&(this.R_.style.minWidth=this.VQd+"px")}Kca(a){this.dF(this.R_,a,1)}Oz(){this.N1h();this.vLh();var a=mb.GraphIterator.ob(this.eb);a.uc(14);const b=ce.getContainingTable(a),c=se.isFirstCellInColumn(a);a=se.isFirstCellInRow(a);let f="";c&&Xw.iGg(b,32)&&(f="columnheader");a&&!c&&Xw.iGg(b,
128)&&(f="rowheader");""!==f?Ac.d(this.htmlElement,na.a.role,f):this.htmlElement.removeAttribute(Qe.a.Ff);this.kd&&this.kd.AHa(65)&&(this.eb.o6b?Sys.UI.DomElement.addCssClass(this.htmlElement,Vc.E5):Sys.UI.DomElement.removeCssClass(this.htmlElement,Vc.E5));this.ZL.xs&&(this.htmlElement.style.border="",this.nFl(),this.VOl(b),this.htmlElement.style.verticalAlign=this.ZL.xs.Rvj(this.eb));this.aTl();this.Qda.V7c&&this.Qda.Gwe&&(this.eb.Qa(ye.a.EVf)?this.mNh():this.htmlElement.removeAttribute("rowspan"),
this.eb.Qa(ye.a.Z3d)?this.ALh():this.htmlElement.removeAttribute("colspan"));this.Tc.Nm&&this.Qda.Erk&&(this.htmlElement.style.width=this.Vd.Xd.Ve(this.spi.width,0)+"px")}aTl(){if(this.Qda.Xnk||this.Qda.Vtk)this.eb.Kne?this.mNh():this.htmlElement.removeAttribute("rowspan"),this.eb.qdb?this.ALh():this.htmlElement.removeAttribute("colspan")}N1h(){var a=null;if(this.kd&&this.kd.AHa(65)){var b=mb.GraphIterator.ob(this.eb);b.uc(15);b=b.ay(15);if(b.hBc){Sys.UI.DomElement.addCssClass(this.htmlElement,Vc.VWh);
return}if(b.CDd){Sys.UI.DomElement.addCssClass(this.htmlElement,Vc.YWh);return}}this.eb.Qa(rb.a.Y4b)?(a=this.eb.ra(rb.a.Y4b,Vb.a.nil),a=Vb.a.WH(a),this.oja|=this.TQi):this.Qda.crk&&this.ZL.xs&&(a=this.ZL.xs.Xgg(this.eb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>Vb.a.Lwj(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.kd&&this.kd.AHa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
Vc.VWh),Sys.UI.DomElement.removeCssClass(this.htmlElement,Vc.YWh))}mNh(){let a;a=this.Qda.V7c?this.eb.ra(ye.a.EVf,1):this.eb.rowSpan;Ac.d(this.htmlElement,na.a.rowSpan,a)}ALh(){let a;a=this.Qda.V7c?this.eb.ra(ye.a.Z3d,1):this.eb.colSpan;Ac.d(this.htmlElement,na.a.colSpan,a)}nFl(){this.dHc=this.GHc=this.wHc=this.PHc=!1}VOl(a){this.ZL.xs&&(this.bRl(),this.htmlElement.style.border="0px none",this.UQb(this.eb,a,7),this.UQb(this.eb,a,5),this.UQb(this.eb,a,0),this.UQb(this.eb,a,6),this.Ied&&(this.UQb(this.eb,
a,2),this.UQb(this.eb,a,1)),Ac.d(this.htmlElement,na.a.s9d,this.oja),this.nDl())}vLh(){var a=new mb.GraphIterator;a.set(this.eb);a.uc(14);a.Ug(14);a=a.currentNode;this.iIc=wo.a.o2c(this.eb,a,ib.a.cTb,this.ZL.xs,ib.a.Q8l,0);this.NKc=wo.a.o2c(this.eb,a,ib.a.eTb,this.ZL.xs,ib.a.R8l,0);this.iHf=wo.a.o2c(this.eb,a,ib.a.fTb,this.ZL.xs,ib.a.S8l,1);this.wof=wo.a.o2c(this.eb,a,ib.a.bTb,this.ZL.xs,ib.a.M8l,1);this.R_.style.paddingLeft=this.iIc+"px";this.R_.style.paddingRight=this.NKc+"px";this.R_.style.paddingTop=
this.iHf+"px";this.R_.style.paddingBottom=this.wof+"px"}bRl(){var a=mb.GraphIterator.ob(this.eb);a.uc(14);a=this.YLc.getContainingTable(a);this.KQa=Jd.TableReader.kn(a)}UQb(a,b,c){this.mX&&this.mX.vfk(b);a=this.ZL.xs.tAj(a,c);b=a.XIi;const f=a.wTj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,f),c){case 7:this.htmlElement.style.borderTop=b;this.s7c(b)&&(this.PHc=!0);a.tVc&&(this.oja|=this.UQi);break;case 5:this.qLh(5,b);this.s7c(b)&&(this.wHc=!0);a.tVc&&(this.oja|=this.MQi);
break;case 0:this.htmlElement.style.borderBottom=b;this.s7c(b)&&(this.dHc=!0);a.tVc&&(this.oja|=this.JQi);break;case 6:this.qLh(6,b);this.s7c(b)&&(this.GHc=!0);a.tVc&&(this.oja|=this.SQi);break;case 2:this.dEe=b;break;case 1:this.cEe=b}}s7c(a){return!a||a.startsWith("0px none")?!1:!0}qLh(a,b){if(5===a&&!this.KQa||6===a&&this.KQa)this.htmlElement.style.borderLeft=b;if(5===a&&this.KQa||6===a&&!this.KQa)this.htmlElement.style.borderRight=b}nDl(){if(this.fZl()){var a=mb.GraphIterator.ob(this.eb);if(a.uc(14)){var b=
se.isFirstCellInRow(a),c=se.isLastCellInRow(a);this.PHc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.PHc=!0);this.dHc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.dHc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.ay(14);a=!Jd.TableReader.kn(a);this.wHc||(this.htmlElement.style.borderLeft=a?b:c,this.wHc=!0);this.GHc||(this.htmlElement.style.borderRight=a?c:b,this.GHc=!0)}}}fZl(){const a=this.Tc;return a.xi&&a.features.nZl?
!0:!1}get vla(){return this.R_}wL(a){super.wL(a);this.XV()}XV(){if(!this.Vd.Nm&&this.yC){const a=Object(gb.a)(1675,this.aT);a&&a.mgh(this.R_)}}get Lxb(){return this.MIa}static iGg(a,b){return null!==a&&a.Qa(ib.a.tableLook)?!!(a.properties.$a(ib.a.tableLook)&b):!1}}Object(m.a)(Xw,"TableCellViewElement",fN.a,[1690,489,393,106]);class Cn extends Sf.a{constructor(a,b,c){super(a,b);this.BT=null;this.HDc=!0;this.vn=[];this.aw=[];this.JMc=this.GH=null;this.Jpf=this.sEf=0;this.mX=c;b=this.Vd.Tp(va.a.div);
b.className="TableContainer";this.Lk=this.Vd.Tp(va.a.table);b.appendChild(this.Lk);this.Lk.className="Table";Sys.UI.DomElement.addCssClass(this.Lk,Cn.lCd);this.eIf=a;this.uDa=this.Vd.Tp(va.a.div);this.uDa.id=Ua.a.create().toString();this.uDa.className=Cn.w8l;this.uDa.setAttribute(Qe.a.JJ,Qe.a.cC);b.insertBefore(this.uDa,this.Lk);ig.c(this.uDa,!0);a.Nm&&Ac.d(this.Lk,na.a.border,this.eb.ra(rb.a.gpb,!0)?"1":"0");this.mc(b);a.Nm||(this.BT=this.Vd.Tp(va.a.HVi),this.Lk.appendChild(this.BT));this.aU=this.Vd.Tp(va.a.nXh);
this.Lk.appendChild(this.aU);this.rp(this.Lk)}get r3(){return this.aU}get table(){return this.Lk}get qSc(){return this.BT}Oz(a){this.Lk.style.borderCollapse="collapse";if(Wb.StyleReader.xs)Sys.UI.DomElement.removeCssClass(this.Lk,Cn.lCd),Sys.UI.DomElement.removeCssClass(this.Lk,Cn.ndf);else{var b=this.eb.ra(rb.a.gpb,!0);b&&!this.HDc?(Sys.UI.DomElement.removeCssClass(this.Lk,Cn.ndf),Sys.UI.DomElement.addCssClass(this.Lk,Cn.lCd),this.HDc=!0):!b&&this.HDc&&(Sys.UI.DomElement.removeCssClass(this.Lk,Cn.lCd),
Sys.UI.DomElement.addCssClass(this.Lk,Cn.ndf),this.HDc=!1)}U.a.instance.ga(71)&&Wb.StyleReader.xs&&(Ac.d(this.Lk,na.a.u9d,"Custom"),Ac.d(this.Lk,na.a.t9d,0));var c=this.BT?Jd.TableReader.ej(this.eb):0;b=this.BT?c-this.BT.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Vd.Tp(va.a.col);this.BT.appendChild(l)}for(f=0;f>b;--f)this.BT.removeChild(this.BT.firstChild);f=vo.b(this.eb);var u=0;this.mX&&(u=this.mX.$je(this.eb));l=Array(c);var I=!0;b=0;for(var T=0;T<c;++T){const ja=this.p$(T);0<=f[T]?(l[T]=
Math.max(ja,this.Vd.Xd.Ve(f[T],0)-u),this.BT.childNodes[T].style.width=l[T]+"px",b+=l[T]):(l[T]=-1,I=!1,this.BT.childNodes[T].style.width="",b+=ja)}if(U.a.instance.ga(63)||U.a.instance.ga(77))I?Sys.UI.DomElement.addCssClass(this.Lk,Cn.$5h):Sys.UI.DomElement.removeCssClass(this.Lk,Cn.$5h);if(this.vn.length===c)for(u=this.WZc(),I=0;I<c;++I)T=this.p$(I),this.vn[I].childNodes[u].style.width=0<=f[I]?Math.max(T,l[I])+"px":T+"px";c=Jd.TableReader.kn(this.eb);if(this.eb.Qa(rb.a.tm))switch(Jd.TableReader.zM(this.eb)){case 1:this.Lk.style.marginLeft=
"";this.Lk.style.marginRight="auto";break;case 2:this.Lk.style.marginLeft="auto";this.Lk.style.marginRight="auto";break;case 3:this.Lk.style.marginLeft="auto";this.Lk.style.marginRight="";break;case 14:this.Lk.style.marginLeft=c?"auto":"";this.Lk.style.marginRight=c?"":"auto";break;case 15:this.Lk.style.marginLeft=c?"":"auto";this.Lk.style.marginRight=c?"auto":"";break;default:this.Lk.style.marginLeft="",this.Lk.style.marginRight=""}else this.Lk.style.marginLeft="",this.Lk.style.marginRight="",U.a.instance.ga(63)&&
this.eb.Qa(ib.a.Sm)&&(f=Jd.TableReader.wma(a),{unit:a}=f,a=(new dr.a(a,f.returnValue)).NUb+"px",c?this.Lk.style.marginRight=a:this.Lk.style.marginLeft=a);(U.a.instance.ga(71)||U.a.instance.ga(77))&&this.dUl(Wb.StyleReader.xs,this.eb,this.Lk);this.eb.properties.ra(rb.a.AAg,!1)?(Sys.UI.DomElement.addCssClass(this.Lk,Cn.vZf),Ac.d(this.Lk,na.a.UFi,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.Lk,Cn.vZf),this.Lk.removeAttribute(Qe.a.iea));(a=Jd.TableReader.JOj(this.eb))&&this.Lk.setAttribute("title",
a);(a=Jd.TableReader.IOj(this.eb))?this.eIf.Nm&&1===this.eIf.mode?this.Lk.removeAttribute(Qe.a.iea):(this.uDa.innerText=a,this.Lk.setAttribute(Qe.a.iea,this.uDa.id)):(this.uDa.innerText="",this.Lk.removeAttribute(Qe.a.iea));Id.a.instance.Fk&&!U.a.instance.ga(30)&&(this.Lk.style.width="0px");U.a.instance.ga(30)&&(this.Lk.style.minWidth=b+"px");this.ZOl();this.iUl()}ZOl(){if(this.mX){const a=this.mX.pCm(this.eb);""!==a&&(this.Lk.style["border-spacing"]=a);this.tue&&(this.Lk.style.borderCollapse="separate")}}get tue(){return!!this.mX&&
this.mX.vfk(this.eb)}nge(a){return this.mX?this.mX.evm(this.eb,a):0}iUl(){this.Lk.style.borderTop="";this.Lk.style.borderBottom="";this.Lk.style.borderLeft="";this.Lk.style.borderRight=""}p$(a){return(Wb.StyleReader.xs?Wb.StyleReader.xs.p$(this.eb,a):wo.a.oCd)+(this.mX?this.mX.$je(this.eb):0)}dUl(a,b,c){a&&(c.style.background=a.VOj(b))}Kca(a){this.dF(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.Lk&&(this.Evc(this.htmlElement,this.Lk),this.htmlElement.appendChild(this.Lk));
this.dF(this.aU,a,1);let b=!1;this.aU.firstChild!==this.GH&&(this.GH=this.aU.firstChild,b=!0);U.a.instance.ga(30)&&Jd.TableReader.nu(a.currentNode)||!this.BT||(A.AFrameworkApplication.fa.getBooleanAppSetting("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.vn&&this.vn.length?this.vn[0].parentNode:null)!==(this.GH?this.GH.firstChild:null)&&(a=!0),this.LEh(b||a)):this.eDl(b),Yn.a.Yu||this.N3e(b))}WZc(){let a=1;(U.a.instance.ga(63)||U.a.instance.ga(30))&&Jd.TableReader.nu(this.eb)&&(a=0);
return a}dispose(){U.a.instance.ga(50)&&ad.App.ni&&ad.App.ni.qy&&this.HCh();this.aw=this.vn=this.Lk=this.aU=this.BT=this.uDa=this.GH=null;super.dispose()}fW(a){var b=vo.b(this.eb),c=null;if(a.Gb(1)){do{var f=a.Ur.TNa;c=c?Lw.eWi(c,f):f.copy()}while(a.sk(1))}c||(c=new Lw(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.zLh(f,Math.max(c.Uwj(f),this.Vd.Xd.Ve(b[f],0)));b=wo.a.hpb;c=new J.a(b,Math.max(0,c.zXk()-2*b),b);b=new mb.GraphIterator;b.set(this.eb);f=!1;b.uc(16)&&(f=!0);c=f?new J.a(0,c.total,0):new J.a(c.tpa,
c.minWidth,c.upa);a.Gb(88)&&(c=J.a.max(c,a.Ur.TNa),a.Dc());return c}Cck(){this.HCh();this.vn=[];this.aw=[]}HCh(){if(this.aw)for(var a=0;a<this.aw.length;++a)ca.a.QMa(this.aw[a]),za.a.oQ(this.aw[a]);if(this.vn)for(a=0;a<this.vn.length;++a)ca.a.QMa(this.vn[a]),this.aw&&this.aw[a]&&this.aw[a].parentNode&&za.a.oQ(this.vn[a])}LEh(a){if(this.vn&&this.GH&&this.GH.firstChild){var b=E.a.vy||E.a.gp?"":" 16 20",c=String.format("url('{0}'){1}, pointer",Lu.a.box4Image("ColumnSelect.cur"),b);b=vo.b(this.eb);var f=
b.length,l=this.GH.firstChild;if(a){a=Math.min(f,this.vn.length);for(var u=0;u<a;u++)l.insertBefore(this.vn[u],l.firstChild)}if(f>this.vn.length)for(a=this.vn.length;a<f;a++){u=this.Vd.createElement("div");u.className="TableColumnHandleAnchor";ig.c(u,!0);Array.add(this.vn,u);var I=this.Vd.createElement("div");I.className=Yn.a.mdf;I.style.cursor=c;u.appendChild(I);I=this.Vd.createElement("div");I.className="TableColumnWidthSpacer";u.appendChild(I);l.insertBefore(this.vn[a],l.firstChild)}if(f<this.vn.length){for(c=
f;c<this.vn.length;c++)ca.a.QMa(this.vn[c]),za.a.oQ(this.vn[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.vn[l]);this.vn=c}c=this.WZc();l=0;for(a=0;a<f;a++)u=this.p$(a),u=Math.max(u,this.Vd.Xd.Ve(b[a],0)),this.vn[a].childNodes[c].style.width=u+"px",this.vn[a].style.left=l+"px",this.vn[a].setAttribute("ColumnIndex",a.toString()),l+=u}}eDl(a){var b=E.a.vy||E.a.gp?"":" 16 20";b=String.format("url('{0}'){1}, pointer",Lu.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.GH.firstChild;var c=Math.min(this.GH.childNodes.length,
this.vn.length);for(var f=0;f<c;++f)a.insertBefore(this.vn[f],a.firstChild),a=a.nextSibling}a=this.GH.childNodes.length;if(a>this.vn.length){c=this.GH.firstChild;for(f=0;f<this.vn.length;++f)c.insertBefore(this.vn[f],c.firstChild),c=c.nextSibling;for(f=this.vn.length;f<a;++f){const u=this.Vd.createElement("div");u.className="TableColumnHandleAnchor";ig.c(u,!0);Array.add(this.vn,u);var l=this.Vd.createElement("div");l.className=Yn.a.mdf;l.style.cursor=b;u.appendChild(l);l=this.Vd.createElement("div");
l.className="TableColumnWidthSpacer";u.appendChild(l);c.insertBefore(u,c.firstChild);c=c.nextSibling}}else if(a<this.vn.length){for(b=a;b<this.vn.length;++b)ca.a.QMa(this.vn[b]),za.a.oQ(this.vn[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.vn[c]);this.vn=b;b=this.GH.firstChild;for(a=0;a<this.vn.length;++a)b.insertBefore(this.vn[a],b.firstChild),b=b.nextSibling}b=this.WZc();a=vo.b(this.eb);for(c=0;c<this.vn.length;++c)f=this.p$(c),this.vn[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Vd.Xd.Ve(a[c],
0))+"px":f+"px"}N3e(a){if(!this.aw.length){a=this.Vd.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Vd.createElement("div");b.className=Yn.a.sCd+" Last";a.appendChild(b);Array.add(this.aw,a);ig.c(a,!0);a=!0}if(a){a=Math.min(this.aw.length,this.GH.childNodes.length);for(b=1;b<a;++b){var c=this.GH.childNodes[b];c.insertBefore(this.aw[b],c.firstChild)}(a=this.GH.lastChild)?a.insertBefore(this.aw[0],a.firstChild):da.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=
this.GH.childNodes.length;if(a>this.aw.length){for(b=1;b<this.aw.length;++b)c=this.GH.childNodes[b],c.insertBefore(this.aw[b],c.firstChild);for(b=this.aw.length;b<a;++b){c=this.Vd.createElement("div");c.className=Yn.a.sCd;ig.c(c,!0);Array.add(this.aw,c);const f=this.GH.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.GH.lastChild;a.insertBefore(this.aw[0],a.firstChild)}else if(a<this.aw.length){for(b=a;b<this.aw.length;++b)ca.a.QMa(this.aw[b]),za.a.oQ(this.aw[b]);b=[];for(c=0;c<a;++c)Array.add(b,
this.aw[c]);this.aw=b;for(a=1;a<this.aw.length;++a)b=this.GH.childNodes[a],b.insertBefore(this.aw[a],b.firstChild);(a=this.GH.lastChild)?a.insertBefore(this.aw[0],a.firstChild):da.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}B6e(a,b){let c=-1;if(Jd.TableReader.kn(this.eb))if(b<=Sys.UI.DomElement.getLocation(this.aU.firstChild.lastChild).x)c=this.aU.firstChild.childNodes.length-1;else for(var f=0;f<this.aU.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.aU.firstChild.childNodes[f]);
if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.aU.firstChild.firstChild).x)c=0;else for(f=this.aU.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.aU.firstChild.childNodes[f]),b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=mb.GraphIterator.ob(this.eb);const u=new mb.GraphIterator;b=new pg.GraphTransaction(2);b.Jz(l);ce.moveToFirstRow(l);ce.moveToColumnByIndex(l,a);u.Uc(l);ce.moveToColumnByIndex(u,c);do(a=$d.SelectionFactory.aUc(l,u))&&Array.add(f,a),
ce.moveToNextRow(u);while(ce.moveToNextRow(l));a=new yc.SelectionCollection(f,f.length-1,0);this.Tc.Rb.VF(a);b.dispose()}Qxc(a,b){const c=this.WZc();this.vn&&a<this.vn.length&&this.vn[a]&&(this.vn[a].childNodes[c].style.width=Math.max(this.p$(a),b)+"px");this.BT.childNodes[a].style.width=Math.max(1,b)+"px"}wyj(a){return this.aU.firstChild.childNodes[a]?this.aU.firstChild.childNodes[a].offsetWidth:(da.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.aU.childNodes.length,this.aU.firstChild.childNodes.length),0)}c_c(a){a=parseInt(this.BT.childNodes[a].style.width);return isNaN(a)?wo.a.kdf:a}m8(a){super.m8(a);U.a.instance.ga(63)&&this.Yjm();this.dif()}dif(){this.JMc||(this.JMc=new ne.a(3,1,0,Object(R.a)(this,this.Nkm,"updateTableDOMElements"),119),A.AFrameworkApplication.Be.Jb(this.JMc))}Nkm(){this.JMc=null;this.r3&&(U.a.instance.ga(63)?this.vml(this.Ssl()):Yn.a.Yu&&this.UZe(this.cke()),A.AFrameworkApplication.fa.getBooleanAppSetting("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.LEh(!1))}VEd(){this.xDl()}Svj(a){return a.offsetWidth+this.nge(0)/2}cke(){const a=this.iWa(),b=a.length,c=[];let f=0,l=!1;const u=Jd.TableReader.nu(this.eb);for(let I=0;I<b;I++){const T=a[I];if(u){let ua;(()=>{let Ra=this.$Dd(T);({Kwd:ua}=Ra);return Ra})().returnValue&&(l=Sk.f(ua.eb))}const ja=T.childNodes;for(let ua=0;ua<ja.length;ua++){const Ra=ja[ua];if(void 0!==Ra.colSpan&&null!==Ra.colSpan&&void 0!==Ra.rowSpan&&null!==Ra.rowSpan){let eb;if((()=>{let Bb=this.Sff(Ra);({a4d:eb}=Bb);return Bb})().returnValue){const Bb=
Object.assign(new eN,{oTa:eb,left:Ra.offsetLeft,top:this.tue?T.offsetTop:f,width:this.Svj(Ra),height:Ra.offsetHeight,bCg:!I,aDg:I+Ra.rowSpan===b,XBg:!l&&!ua});c.push(Bb)}}}f+=T.offsetHeight}return c}Yjm(){if(this.r3){var a=new mb.GraphIterator;a.set(this.eb);if(Jd.TableReader.SZf(a)&&this.BT){a=this.BT.childNodes.length;var b=Array(a),c=[],f=this.iWa(),l=f.length,u=0;for(let I=0;I<l;I++){let T=0;const ja=f[I],ua=ja.childNodes;let Ra=0;for(let Bb=0;Bb<a;Bb++){let Ub=0;if(b[Bb]){let Xb;(Xb=b[Bb]).Q3c=
Xb.Q3c-u;let tc;(tc=b[Bb]).Iwd=tc.Iwd-1;Ub=b[Bb].colSpan;1===b[Bb].Iwd&&(T=Math.max(T,b[Bb].Q3c),b[Bb]=null)}else{const Xb=ua[Ra];Ra++;if(!Xb)continue;let tc=0,lc;(()=>{let Ec=this.Sff(Xb);({a4d:lc}=Ec);return Ec})().returnValue&&(tc=lc.R$b());Ub=Xb.colSpan;1<Xb.rowSpan?b[Bb]=Object.assign(new bN,{colSpan:Xb.colSpan,Q3c:tc,Iwd:Xb.rowSpan}):T=Math.max(T,tc)}Bb+=Ub-1}let eb;(()=>{let Bb=this.$Dd(ja);({Kwd:eb}=Bb);return Bb})().returnValue?(eb.XOl(T)&&c.push(eb),u=eb.QHh):u=0}for(const I of c)I.Xjm()}}}xDl(){const a=
this.iWa();if(ad.App.instance.R6c&&a.length&&!(a.length<=this.sEf&&a[0].childNodes.length===this.Jpf)){this.sEf=a.length;this.Jpf=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!za.a.lfa(a[c].firstChild,"DragHandle")&&(()=>{let f=this.$Dd(a[c]);({Kwd:b}=f);return f})().returnValue&&b.gDl()}}rAg(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}UZe(a){if(a)for(const b of a)b.oTa.SBc(b.left,b.top,b.width,b.height,b.bCg,b.aDg,b.XBg)}iWa(){return this.r3.children}Sff(a){let b;
b=null;a&&(a=ig.a(a),b=Object(gb.a)(Xw,a));return{returnValue:!!b,a4d:b}}$Dd(a){let b;b=null;a&&(a=ig.a(a),b=Object(gb.a)(Yu,a));return{returnValue:!!b,Kwd:b}}Ssl(){let a=0;const b=Jd.TableReader.nu(this.eb),c=this.tue,f=this.iWa(),l=[];let u=!1;for(let T=0,ja=f.length;T<ja;T++){const ua=f[T];if(!ua)continue;if(b){let Ub;(()=>{let Xb=this.$Dd(ua);({Kwd:Ub}=Xb);return Xb})().returnValue&&(u=Sk.f(Ub.eb))}const Ra=new dN,eb=!T,Bb=ua.childNodes;for(let Ub=0,Xb=Bb.length;Ub<Xb;Ub++){const tc=Bb[Ub];let lc;
if((()=>{let Ec=this.Sff(tc);({a4d:lc}=Ec);return Ec})().returnValue){var I=tc.offsetTop;const Ec=tc.rowSpan,hd=!Ub;I=Object.assign(new cN,{oTa:lc,left:tc.offsetLeft,offsetTop:I,top:c?I:a,width:tc.offsetWidth,height:tc.offsetHeight,rowSpan:Ec,HCg:eb,ICg:T+Ec===ja,GCg:!u&&hd,Dug:!hd&&this.rAg(tc,Te.a.gqe),Ytg:!eb&&this.rAg(tc,Te.a.fqe)});Ra.LYd(I)}}a+=ua.offsetHeight;l.push(Ra)}return l}vml(a){if(a.length){var b=this.nge(1)/2,c=this.nge(0)/2,f=a[0].cells[0].oTa,l=f.NCg(!1);f=f.NCg(!0);var u=[];for(var I of a[0].cells){var T=
I.oTa.nhm(I.left,I.width+c,I.offsetTop,l);T&&u.push(T)}Yn.a.Ovl(u);l=[];for(I=0;I<a.length;I++)u=a[I].cells[0],(T=u.oTa.$jm(u.height+b,u.offsetTop,f))&&l.push(T),1<u.rowSpan&&(I+=u.rowSpan-1);Yn.a.Hxl(l);for(const ja of a)for(const ua of ja.cells)a=ua.oTa,f=ua.width,l=ua.height,a.Wjm(f,l+b,ua.offsetTop,ua.left),a.SBc(ua.left,ua.top,f+c,l,ua.HCg,ua.ICg,ua.GCg),ua.Dug&&a.LCh(Te.a.gqe),ua.Ytg&&a.LCh(Te.a.fqe)}}}Cn.lCd="Border";Cn.ndf="NoBorder";Cn.vZf="Conflict";Cn.$5h="TableWordWrap";Cn.w8l="WACAltTextDescribedBy";
Object(m.a)(Cn,"TableViewElement",Sf.a,[1632,489,393,106]);class Yw extends Yu{constructor(a,b,c){super(a,b,c,null,null)}xRb(a){this.htmlElement.style.height=a+"px"}get PHh(){const a=this.eb.ra(yb.a.wv,0);return this.Vd.Xd.Ve(a,1)+"px"}static Hqg(a){a=ig.a(a);let b=null;a&&(b=Object(gb.a)(Yw,a));return b}}Object(m.a)(Yw,"TableRowViewElement",Yu,[]);class uz{constructor(a,b,c){this.XIi=a;this.wTj=b;this.tVc=void 0===c?!1:c}}Object(m.a)(uz,"TableBorderProperty",null,[]);var mm=d(508);class Oq{constructor(a,
b,c,f,l){this.raa=a;this.nc=c;this.Ub=b;this.FKb=f;this.rLk=l}CIj(a){switch(a){case 0:a=ib.a.bTb;break;case 1:a=ib.a.cTb;break;case 2:a=ib.a.eTb;break;case 3:a=ib.a.fTb;break;default:a=null}return{returnValue:!!a,OVk:a}}eva(a,b){let c=0;if(!a)return c;let f;(()=>{let l=this.CIj(b);({OVk:f}=l);return l})().returnValue&&(c=3===b||0===b?a.ra(f,.1):a.ra(f,Oq.zil));return c}aUf(a){const b=this.eva(a,1);a=this.eva(a,2);return.0555555555555556+b+a}v3d(a,b){const c=Jd.TableReader.fl(a);if(0>b||b>=c)return.0555555555555556;
a=this.Ub.Pc(a).Kq(b,1);return this.TQc(a)}TQc(a){let b=.0555555555555556;a=this.Ub.Pc(a);a.Gb(1);do{var c=a.currentNode;const f=this.eva(c,0);c=this.eva(c,3);b=Math.max(b,.0555555555555556+f+c)}while(a.Qf(1));return b}Uwb(a,b){var c=Jd.TableReader.ej(a);if(0>b||b>=c)return.0555555555555556;c=.0555555555555556;a=this.Ub.Pc(a);a.Gb(1);do{const f=a.Kq(b,1);c=Math.max(c,this.aUf(f));a.Dc()}while(a.Qf(1));return c}Ahe(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||
a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:mm.a.Hyb}lle(a,b){let c=b;if(this.rLk&&b&&b.cellShading){const f=b.cellShading;let l;(()=>{let u=this.Xff(a,f);({Ana:l}=u);return u})().returnValue&&(b=Object(gb.a)(267,this.nc.ug(b)),c=this.FKb.JGh(a,b?b.Ld:null,l))}return c}M$b(a,b){let c=mm.a.Gyb;const f=Oq.fWa(b);f.returnValue&&(a=this.lle(b,a),a.Qa(f.ZSa)&&(c=a.$a(f.ZSa)));return c}nfe(a,b,c){if(c&&c.DE===Vb.a.auto)return Dj.a.none;a=this.Qyj(a);b=this.ege(b);c=c.GW();return String.format("{0} {1}px {2}",
a,b,c)}ege(a){a=this.raa.Ve(a,0);E.a.zwa&&0<a&&1>a&&(a=1);return a}rwb(a,b,c){c=void 0===c?!1:c;let f=Vb.a.kUa.GW();if(a.solidFillField){var l=Ze.Box4ColorHelper.ZI(Ze.Box4ColorHelper.Eia(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.GW()}else if(a.gradFillField){a=Sp.f(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=l.color.g=l.color.b=255;f=a.GW()}return f}XSj(a){const b=a.currentNode.Yi;a.Dc();const c=a.NG(1);a.Kq(b,1);return c?a.currentNode:null}bTj(a){return a.NG(1)}Xff(a,b){switch(a){case 7:a=
b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,Ana:a}}Qyj(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static fWa(a){let b,c;switch(a){case 7:a=yb.a.ZAa;b=yb.a.gOa;c=yb.a.a8l;break;case 0:a=yb.a.Pia;b=yb.a.Nia;c=yb.a.W7l;break;case 5:a=yb.a.YAa;b=yb.a.fOa;c=yb.a.Z7l;break;case 6:a=yb.a.Qia;b=yb.a.Oia;c=yb.a.$7l;break;case 2:a=
yb.a.fpb;b=yb.a.dpb;c=yb.a.Y7l;break;case 1:a=yb.a.epb;b=yb.a.cpb;c=yb.a.X7l;break;default:c=b=a=null}return{returnValue:!!a,ZSa:a,c$a:b,Awb:c}}}Oq.zil=.2;Object(m.a)(Oq,"TableStyleReaderHelper",null,[911]);class HF{constructor(a,b,c){this.yZ=a;this.GNg=b;this.JUg=void 0===c?-1:c}}Object(m.a)(HF,"TableStyle",null,[]);var Ur=d(336);class VB{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.yZ=new Md.a;this.Ekd=new Md.a;this.Dkd=new Md.a;this.zkd=new Md.a;this.udf=[];this.Ub=
a;this.DI=c;this.nc=b;this.Hl=f;this.raa=l;this.z2=u;this.SKa=I;this.Wb=T;this.iPe=ja;this.iTk=ua;this.dTk=Ra;this.VSk=eb;this.Cc=Bb;this.u0a=Ub;this.RK=Xb;this.Fp=tc;this.xq=lc;this.ohb=Ec;this.Dfd=hd;this.hIb=yd;this.DJa=Pd;this.l_a=pe;this.SKa.dea(Object(R.a)(this,this.mqd,"onTableConnectedOrDisconnected"));this.SKa.B4(Object(R.a)(this,this.mqd,"onTableConnectedOrDisconnected"));this.SKa.Ak(Object(R.a)(this,this.xqh,"onTablePropertyChanged"));this.xq.mzi(Object(R.a)(this,this.soh,"onPageViewBeforeValidate"))}dispose(){this.SKa.iia(Object(R.a)(this,
this.mqd,"onTableConnectedOrDisconnected"));this.SKa.Wza(Object(R.a)(this,this.mqd,"onTableConnectedOrDisconnected"));this.SKa.tn(Object(R.a)(this,this.xqh,"onTablePropertyChanged"));this.xq.FBl(Object(R.a)(this,this.soh,"onPageViewBeforeValidate"))}Wgg(a){if(!a||!a.length)return null;const b=this.UZc(Object(gb.a)(Zg.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.UZc(Object(gb.a)(Zg.a,a[c]));if(!f||f.DE!==b.DE)return null}return b}$ke(a){let b=null;if(a=this.zbc(a))b=new qq.a,
b.He(yb.a.tableStyle,new HF(a,Number.MAX_VALUE));return b}p2c(a){if(14!==a.type){a=this.Ub.Pc(a);a.uc(14);var b=a.Ug(14)}else b=a;a=b.id;this.Dkd.Ib(a)||(b=this.ale(b),this.Dkd.$(a,this.dTk(b)));return this.Dkd.ga(a)}KEj(a){return(a=this.Wb.lbc(Object(gb.a)(267,this.nc.ug(a))))?a.TableListStyle:null}ale(a){const b=Object(gb.a)(267,this.nc.ug(a));return this.iPe(()=>a.jW,()=>a.O4,()=>a.tableLook,()=>this.KEj(a),()=>b?b.Ld:null,()=>this.zbc(a))}mqd(a,b){this.gzg(b.node)}xqh(a,b){a=b.property;b=b.node;
if(a===yb.a.cBa||a===yb.a.Yzc||a===rb.a.bBa||a===rb.a.Ria||a===rb.a.mC){if(a===rb.a.bBa||a===rb.a.mC)b.Zzc=!1;a!==yb.a.cBa&&a!==yb.a.Yzc||this.gzg(b);this.Xdc(b)}}qWk(a){Array.contains(this.udf,a)||(this.Xdc(a),this.udf.push(a))}soh(){Array.clear(this.udf)}Qck(a){this.zkd.remove(a.id)}gzg(a){a=a.id;this.yZ.remove(a);this.Ekd.remove(a);this.Dkd.remove(a)}n2c(a){const b=a.id;this.zkd.Ib(b)||this.zkd.$(b,this.VSk(this.ale(a)));return this.zkd.ga(b)}zbc(a){const b=a.id;if(this.yZ.Ib(b))return this.yZ.ga(b);
var c=a.ra(yb.a.cBa,null);if(!c)return null;let f=null;const l=Um.gag(c);l&&a.Zh&&(f=a.Zh.Ie(l));a=null;if(f)a=yl.a.HVa(f,yb.a.tableStyle);else if(c=this.z2.Cpg("{"+c.toString()+"}"))a=c.yZ;a&&this.yZ.$(b,a);return a}Nie(a){return a.tableLook}p$(a,b){a=this.Hl.Uwb(a,b);return this.raa.Ve(a,0)}Rvj(a){if(a.Qa(yb.a.AQ))switch(a.ra(yb.a.AQ,0)){case 2:return"bottom";case 1:return"middle"}return"top"}Xgg(a){var b=null;if(!a)return null;if(a.cellShading){var c=Sp.a(a.cellShading);Sp.e(c)||(b=c)}b||(b=this.Hma(a,
yb.a.cellShading,mm.a.Hyb));c=Object(gb.a)(267,this.nc.ug(a));b=this.Hl.rwb(b,c?c.Ld:null,this.ohb);a.rowIndex||1!==a.Yi||ya.a.J(509137695,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}UZc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=Sp.a(a.cellShading);Sp.e(f)||(b=f)}b||(b=this.Hma(a,yb.a.cellShading,mm.a.Hyb));a=(a=Object(gb.a)(267,this.nc.ug(a)))?a.Ld:null;(b=b.solidFillField)&&(c=Ze.Box4ColorHelper.rma(b,a));return c}Ucb(a){var b=null;var c=Object(gb.a)(5,a);
c&&(a=c.ra(ib.a.listLevel,th.a.dHa),c=this.Ub.Pc(c),c.uc(7)&&Jd.TableReader.Ft(c)&&(c=Object(gb.a)(Sm.TableCellNode,c.Ug(16))))&&(this.jwh(c),b=1+a,b=this.DI.Sgg(c,this.p2c(c),b));return{tableStyle:b,W$a:null}}VOj(a){let b=yl.a.Fi(a,yb.a.cellShading,mm.a.Hyb);if(Sp.e(b)){const c=this.zbc(a);c&&(b=this.Hl.Ahe(c))}a=Object(gb.a)(267,this.nc.ug(a));return this.Hl.rwb(b,a?a.Ld:null)}Yyj(a){return!md.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?mm.a.Gyb:mm.a.N9i}tAj(a,b){if(this.Dfd&&this.Fp.iV&&
!this.Yek(a,b))return new uz("","");var c=Object(gb.a)(650,a);var f=Oq.fWa(b);({ZSa:u,c$a:I,Awb:T}=f);if(f.returnValue)if(this.l_a&&md.a("TableBordersLocalRenderingFix")){var l=this.Hma(c,u,this.Yyj(b),!0);f=this.Hma(c,T,mm.a.Fyb,!0);var u=c.ra(u,l);l={};if(md.a("FixClearTableBorder")){const ja=this.Ub.Pc(c);ja.uc(14);if(ja.Ug(14).Qa(yb.a.cBa)){l.Color="##T,0,0,0";l=Ze.Box4ColorHelper.uT(l);l=this.Hma(c,I,l,!0);var I=yl.a.Fi(c,I,l);I=Ze.Box4ColorHelper.Eia(I);a=this.nc.ug(a);a=(a=Ze.Box4ColorHelper.ZI(I,
a?a.Ld:null))?Ze.Box4ColorHelper.Xia(a):null}else md.a("FixTableBorderColor")?(l.Color="##T,1,0,0",l=Ze.Box4ColorHelper.uT(l),l=this.Hma(c,I,l,!0),I=yl.a.Fi(c,I,l),I=Ze.Box4ColorHelper.Eia(I),a=this.nc.ug(a),a=(a=Ze.Box4ColorHelper.ZI(I,a?a.Ld:null))?Ze.Box4ColorHelper.Xia(a):null):(l.Color="#000000",a=Ze.Box4ColorHelper.uT(l),a=Ze.Box4ColorHelper.Xua(a))}else l.Color="##T,0,0,0",l=Ze.Box4ColorHelper.uT(l),l=this.Hma(c,I,l,!0),I=yl.a.Fi(c,I,l),I=Ze.Box4ColorHelper.Eia(I),a=this.nc.ug(a),a=(a=Ze.Box4ColorHelper.ZI(I,
a?a.Ld:null))?Ze.Box4ColorHelper.Xia(a):null;f=c.ra(T,f)}else f=this.Hl.lle(b,c),u=f.Qa(u)?f.$a(u):this.Hma(c,u,mm.a.Gyb,!0),a=this.Pgg(f,c,I),f=f.Qa(T)?f.$a(T):this.Hma(c,T,mm.a.Fyb,!0);else u=mm.a.Gyb,a=mm.a.IUc,f=mm.a.Fyb;5!==b||a.DE===Vb.a.auto||c.rowIndex||1!==c.Yi||ya.a.J(509137694,822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.DE,a.alpha);var T=!1;a.DE!==Vb.a.auto||7!==b&&5!==b||(l=this.Ub.Pc(c),l.uc(14),7===b?(I=yb.a.Nia,l=this.Hl.XSj(l)):(I=yb.a.Oia,l=this.Hl.bTj(l)),l&&(c=this.Hl.lle(b,
c),this.Pgg(c,l,I).DE===Vb.a.auto&&(f=mm.a.Fyb,u=mm.a.vTj,a=mm.a.uTj,T=!0)));c=this.Hl.nfe(f,u,a);return T&&7===b?new uz(c,"Top"):T&&5===b?new uz(c,"Left"):new uz(c,"")}L_c(a,b){switch(b){case 7:b=yb.a.ZAa;break;case 6:b=yb.a.Qia;break;case 0:b=yb.a.Pia;break;case 5:b=yb.a.YAa;break;default:b=null}const c=this.Hma(a,b,mm.a.Gyb,!0);return a.ra(b,c)}Yek(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Ub.Pc(a);if(!c.uc(14))return!0;var f=c.ay(14);if(!f.rq())return!0;const l=a.rowSpan,u=
a.colSpan;if(1===l&&1===u)return!0;f=this.Cc.SOj(f);const I=new Ur.a;I.Ae=this.u0a.zKj(c);I.rg=I.Ae+l;I.qe=this.RK.d_c(Object(gb.a)(650,a));I.hg=I.qe+u;switch(b){default:ya.a.J(509137693,822,15," Unknown position type: {0} ",b);break;case 5:if(!I.qe||1===l)break;if(4!==(f.xt(I.Ae,I.qe-1)&4)||8!==(f.xt(I.rg-1,I.qe-1)&8))break;for(a=I.Ae+1;a<I.rg;++a)if(4===(f.xt(a,I.qe-1)&4))return!1;break;case 6:if(I.hg===f.NS||1===l)break;if(4!==(f.xt(I.Ae,I.hg)&4)||8!==(f.xt(I.rg-1,I.hg)&8))break;for(a=I.Ae+1;a<
I.rg;++a)if(4===(f.xt(a,I.hg)&4))return!1;break;case 7:if(!I.Ae||1===u)break;if(1!==(f.xt(I.Ae-1,I.qe)&1)||2!==(f.xt(I.Ae-1,I.hg-1)&2))break;for(a=I.qe+1;a<I.hg;++a)if(1===(f.xt(I.Ae-1,a)&1))return!1;break;case 0:if(I.rg!==f.hQ&&1!==u&&1===(f.xt(I.rg,I.qe)&1)&&2===(f.xt(I.rg,I.hg-1)&2))for(a=I.qe+1;a<I.hg;++a)if(1===(f.xt(I.rg,a)&1))return!1}return!0}Pgg(a,b,c){if(this.l_a){const f=Ze.Box4ColorHelper.uT({Color:"##T,0,0,0"});a=yl.a.Fi(a,c,f);a=Ze.Box4ColorHelper.Eia(a);b=this.nc.ug(b);b=(b=Ze.Box4ColorHelper.ZI(a,
b?b.Ld:null))?Ze.Box4ColorHelper.Xia(b):null}else a.Qa(c)?(b=a.$h(c),b=Object(gc.a)(Vb.a,b)?b:new Vb.a(a.$a(c))):b=this.Hma(b,c,mm.a.IUc,!0);this.ohb&&(b=new Vb.a(0,b.alpha));return b}Xdc(a){const b=this.DJa?this.Ub.Hie(a):this.Ub.Pc(a);let c=Object(gb.a)(746,b.sj());for(a=Object(gb.a)(745,a);c;)c.Gwd=!1,c=Object(gb.a)(746,b.Up());this.Qck(a);this.DJa?this.zck(a):a.Pfa(4)}zck(a){if(a&&a.isConnected)for(a=this.Ub.Hie(a),a=ll.a.rw(a);a.moveNext();)a.currentNode.anchor.Zr(4)}rom(a){a&&(this.p2c(a),this.zbc(a),
this.n2c(a))}Hma(a,b,c,f){f=void 0===f?!1:f;if(!a)return c;var l=this.Ub.Pc(a);l.uc(14);l=l.Ug(14);var u=l.id;if(this.hIb&&f){if(!l.Qa(yb.a.cBa))return c;u=a.rowIndex;a=a.Yi;return(a=this.n2c(l).jvj(l,u,a))&&a.Qa(b)?a.$h(b):c}this.jwh(a);f=a.yW;if(!f){if(!l.Qa(yb.a.cBa))return c;f=a.rowIndex;const I=a.Yi,T=a.rowSpan,ja=a.colSpan;this.Ekd.Ib(u)||this.Ekd.$(u,this.iTk(this.ale(l)));f=this.Ekd.ga(u).kge(f,I,T,ja);a.yW=f}return f&&f.Qa(b)?f.$h(b):c}tOi(a){const b=this.Ub.SVa();b.set(a);let c=0,f=Object(gb.a)(746,
b.Gb(1));for(;f;)f.rowIndex=c,c++,f=Object(gb.a)(746,b.Up());a.Zzc=!0}nkl(a){let b=0;const c=a.rowIndex,f=this.Ub.SVa();f.set(a);let l=Object(gb.a)(650,f.Gb(1));for(;l;)l.rowIndex=c,l.Yi=b,l.yW=null,this.DI.oFl(l),l.n9f(),l=Object(gb.a)(650,f.Up()),b++;a.Gwd=!0}jwh(a){var b=this.Ub.Pc(a);b.uc(14);a=Object(gb.a)(746,b.Ug(15));(b=Object(gb.a)(745,b.Ug(14)))&&!b.Zzc&&this.tOi(b);a&&!a.Gwd&&this.nkl(a)}}Object(m.a)(VB,"TableStyleReader",null,[1692,1693,1694]);class zm extends Cn{constructor(a,b,c,f,l,
u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){super(a,b,null);this.aKb=this.$wa=this.vI=null;this.CI=!1;this.Qfd=this.Nw=null;this.Aoc=l;this.Hl=u;this.Fp=I;this.Ye=T;this.s2=[];this.Wb=f;this.yib=eb;this.rc=Bb;this.nc=Ub;this.Mj=Xb;this.kIb=ua.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.SIe=ua.pptComplexTableLayoutSyncEnabled;this.e2=ua.Lma;this.w8g=Ra;this.Cc=tc;this.Ub=lc;this.CI=ua.L$;this.iKe=ua.Rba;this.Ffd=ua.UWh;if(Ec)this.Nw=Ec;else throw Error.argumentNull("slideDimensionsHelper");if(this.Tc.Wp){if(this.vI=
ja?ja(a):null)this.vI.I0h(),this.ol&&this.ol.oW&&(this.vI.sIi(this,this.ol.oW,this.table),this.vI.Ry(!this.rc.fp));md.a("DeprecateIE.TableViewElement.ctor")||!this.Fp.Keb&&!this.Fp.Meb||(this.htmlElement.style.backgroundColor="rgba(0,0,0,0)")}this.ol&&(this.ol.Ryi(Object(R.a)(this,this.uph,"onShapeEnterTextEditing")),this.ol.lMf(Object(R.a)(this,this.Dph,"onShapeSelectionChanged")),this.ol.Tyi(Object(R.a)(this,this.vph,"onShapeExitTextEditing")),this.ol.ryi(Object(R.a)(this,this.Mkh,"onAfterDraw")),
this.ol.hAi(Object(R.a)(this,this.Poh,"onReadModeChanged")),this.ol.Pyi(Object(R.a)(this,this.nmh,"onDisplayOnActiveSlide")))}get eTi(){return this.vI}nmh(){this.fdf()}get ol(){if(this.$wa)return this.$wa;if(this.Tc.Wp){const a=ui.a.ob(this.Tc.Na,this.eb);a.wf();a.L2a();this.$wa=Object(gb.a)(178,a.gUa)}return this.$wa}Fje(){if(!this.Ffd)return 1;var a=this.nc.ug(this.eb);if(!a)return 1;var b=a.sc(this.Na);if(!b)return 1;b=!this.CI&&b.yea?b.yea.va.style.visibility===sj.a.visible:!1;var c=new Rr.a(a.yq,
a.yl);if(!this.Nw)return 1;b=this.Nw.ibc(c,b).kW;c=this.Mj.PH;a=this.Wb.a2c(a)*c;return b/a}uJh(a){if(1!==a&&this.Ffd){var b=this.Cc.Gma(this.eb);for(var c of b)b=c.ra(yb.a.wv,0),b=this.Vd.Xd.Ve(b,1)*a,c.sc(this.Na).htmlElement.style.height=b+"px";c=vo.b(this.eb);for(b=0;b<c.length;b++){const f=this.Vd.Xd.Ve(c[b],0)*a;this.qSc.childNodes[b].style.width=f+"px"}}}Oz(a){super.Oz(a);this.uJh(this.Fje());this.FYh(this.yib.LDb?!!this.ol&&this.ol.hK()&&(this.ol.wC||this.ol.Oo):!!this.ol&&this.ol.Oo)}fW(){const a=
this.Aoc,b=vo.b(this.eb),c=Jd.TableReader.ej(this.eb);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.p$(this.eb,l),this.Vd.Xd.Ve(b[l],0));return new J.a(0,f,0)}m8(a){super.m8(a);if(this.Tc.Wp&&(a=this.w8g.T1c(this.eb,this.Na))&&0!==a.P5c){const b=this.eb;if(b.lP)return;this.SIe?a.N2h(b):a.P5c&2?a.N2h(b):a.Rim(b,c=>{c&&this.fdf()})}this.fdf()}fdf(){this.vI&&this.ol&&this.ol.Oo&&this.edf()}PNh(a,b){Object(gb.a)(VB,Wb.StyleReader.xs);if(1!==b)for(var c=0;c<this.r3.childNodes.length;c++){var f=this.r3.childNodes[c];
if(!f||"TR"!==f.tagName.toUpperCase())continue;const u=f.offsetHeight*b;var l=this.Hl.v3d(this.eb,c);l=this.Vd.Xd.Ve(l,1);f.style.height=(u<l?0:u)+"px"}if(1!==a)for(b=0;b<this.qSc.childNodes.length;b++)c=Df.a.zo(this.qSc.childNodes[b].style.width),f=this.Hl.Uwb(this.eb,b),f=this.Vd.Xd.Ve(f,0),this.Qxc(b,Math.max(c*a,f))}sKj(a){a>this.r3.childNodes.length&&Error.argumentOutOfRange("rowIdx");const b=this.r3.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",
a));return Df.a.zo(b.style.height)}wbc(){return ej.a.jfa(this.Ye.wi(this.table))}get Wkk(){const a=this.w8g.T1c(this.eb,this.Na);return!a||0===a.P5c}Nng(){const a=[0];for(let b=1;b<=this.r3.childNodes.length;++b)a[b]=a[b-1]+this.r3.childNodes[b-1].offsetHeight;return a}ohg(){const a=[0];for(let b=1;b<=this.qSc.childNodes.length;++b)a[b]=a[b-1]+this.c_c(b-1);return a}N3e(a){if(14!==this.eb.type)ya.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.eb.type);
else if(this.eb.ra(yb.a.complexTable,!0))ya.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.N3e(a);a=new mb.GraphIterator;a.set(this.eb);ce.moveToFirstRow(a);ce.moveToFirstColumn(a);let b=1;const c=this.Vd.Xd.Ve(this.Hl.M$b(a.currentNode,6),0);for(;!se.isLastCellInRow(a);){ce.moveToNextColumn(a);const f=this.aw[b++],l=Df.a.Rc(-1*c);Jd.TableReader.kn(this.eb)?f.style.marginRight=l:f.style.marginLeft=l}this.aw.length!==b&&ya.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",
this.aw.length,b)}}Kca(a){super.Kca(a);this.Tc.Nm||this.zDl();this.eb.ra(yb.a.complexTable,!0)||Yn.a.Yu||this.yDl()}dispose(){super.dispose();this.vI&&(this.vI.dispose(),this.vI=null);this.ol&&(this.ol.rBl(Object(R.a)(this,this.uph,"onShapeEnterTextEditing")),this.ol.tEh(Object(R.a)(this,this.Dph,"onShapeSelectionChanged")),this.ol.sBl(Object(R.a)(this,this.vph,"onShapeExitTextEditing")),this.ol.$Al(Object(R.a)(this,this.Mkh,"onAfterDraw")),this.ol.fCl(Object(R.a)(this,this.Poh,"onReadModeChanged")),
this.ol.oBl(Object(R.a)(this,this.nmh,"onDisplayOnActiveSlide")));this.$wa=null}Mkh(){this.ol.qK&&this.edf(!0)}ZQi(){if(this.iKe){var a=this.eb,b=a.Tcb();if(a.Zzc)for(const c of b){a=c;if(!a)continue;a=a.sc(this.Na);if(!a)continue;b=this.Aoc.L_c(c,7);const f=this.Aoc.L_c(c,6),l=this.Aoc.L_c(c,0),u=this.Aoc.L_c(c,5);0===b&&a.Lud("Top");0===f&&a.Lud("Right");0===l&&a.Lud("Bottom");0===u&&a.Lud("Left")}}}Dph(a,b){this.FYh(b.isSelected);a=this.table;this.ZQi();b.isSelected?Sys.UI.DomElement.containsCssClass(a,
"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}Poh(a,b){this.vI&&this.vI.Ry(b.Nok)}FYh(a){if(this.vI)if(this.e2){const b=this.Ub.Pc(this.eb);b.wf();b.L2a().$a(yb.a.isResizable)?this.vI.visible=a:this.vI.visible=!1}else this.vI.visible=a;this.ol&&this.ol.$d&&this.ol.shapeNode&&this.ol.shapeNode.VR&&(this.ol.$d.visible=a)}yDl(){if(!this.s2.length){var a=this.XTa();Sys.UI.DomElement.addCssClass(a,
"First");this.s2.push(a);a=this.p6i();Sys.UI.DomElement.addCssClass(zm.Pjg(a),"Last");this.s2.push(a)}var b=this.iWa();a=b.length;var c=a+1-this.s2.length;if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){const l=this.XTa();this.s2.splice(this.s2.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.mPb(this.s2[f+1]);this.s2.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.s2[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.s2[a],b.firstChild);this.XBi()}}XBi(){const a=new mb.GraphIterator;a.set(this.eb);
ce.moveToFirstRow(a);ce.moveToFirstColumn(a);let b=1;for(;b<this.s2.length;){var c=this.Vd.Xd.Ve(this.Hl.M$b(a.currentNode,5),0),f=this.Vd.Xd.Ve(this.Hl.M$b(a.currentNode,0),1);let l=this.s2[b];zm.Nrk(l)&&(l=zm.Pjg(l));c=Df.a.Rc(-1*c);f=Df.a.Rc(-1*f-(b===this.s2.length-1?4:0));Jd.TableReader.kn(this.eb)?l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;ce.moveToNextRow(a);b++}}zDl(){if(!this.aKb){const a=String.format("url('{0}'), pointer",Lu.a.box4Image("RowSelect.cur"));this.aKb=this.Vd.createElement("div");
this.aKb.className=tm.a.K8l;ig.c(this.aKb,!0);const b=this.Vd.createElement("div");b.className=tm.a.odf;b.style.cursor=a;this.aKb.appendChild(b);this.table.appendChild(this.aKb)}}tKj(){return this.iWa()}XTa(){const a=this.Vd.createElement("div");a.className="TableRowResizeHandle";a.style.width="100%";ig.c(a,!0);return a}p6i(){const a=this.Vd.createElement("div");a.className="TableRowResizeAnchor";const b=this.XTa();a.appendChild(b);ig.c(a,!0);return a}mPb(a){ca.a.QMa(a);za.a.oQ(a)}KOj(a){var b=this.nc.ug(this.eb);
let c=this.Mj.PH;b&&b.ey&&null!=b.ey.gt&&(c=b.ey.gt);b=this.Wb.a2c(this.nc.ug(this.eb))*c;a=a.copy();a.move(-a.oc,-a.pc);a.scale(1/b,1/b);return a}uph(){this.table.clientWidth&&this.edf(!0);!this.yib.LDb&&this.vI&&(this.vI.visible=!0,this.ol&&this.ol.$d&&(this.ol.$d.visible=!0));this.ol&&this.ol.hK()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}vph(){this.vI&&(this.vI.visible=!1);this.ol&&this.ol.$d&&(this.ol.$d.visible=
!1)}edf(a){a=void 0===a?!1:a;var b=this.wbc();let c=Mi.a.AGd;this.Qfd&&(c=ej.a.Jac(b,this.Qfd));const f=pd.a.Djf;a=!!this.ol&&(!this.Qfd||!f.equals(pd.a.Djf)||!c.equals(Mi.a.AGd)||a);this.Qfd=b;if(a&&(a=this.ol.Zgf,b=ej.a.Jac(this.KOj(b),a),this.ol.setOffsets(b,!0),!md.a("DeprecateIE.TableViewElement.SynchronizeViews")&&this.Fp.Keb&&0<this.r3.childNodes.length))for(b=this.r3.childNodes[0].offsetWidth,a=0;a<this.s2.length;a++)this.s2[a].style.width=b+"px";this.vI&&this.vI.Gm();this.kIb||this.dif()}cke(){return this.kIb?
null:super.cke()}UZe(a){if(this.kIb){var b=this.Cc.fl(this.eb);a=Object(gb.a)(mb.GraphIterator,this.Ub.Pc(this.eb));ce.forEachCellInTable(a,(c,f,l)=>{c=c.currentNode;const u=c.sc(this.Na);u&&u.SBc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.UZe(a)}iGj(a){let b=-1;var c=Jd.TableReader.ej(this.eb),f=vo.b(this.eb);const l=Array(c);for(let u=0;u<c;u++)l[u]=Math.floor(this.Vd.Xd.Ve(f[u],0));if(Jd.TableReader.kn(this.eb))if(a<=Sys.UI.DomElement.getLocation(this.r3.firstChild.lastChild).x)b=c-1;
else{a-=Sys.UI.DomElement.getLocation(this.r3.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=Sys.UI.DomElement.getLocation(this.r3.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.r3.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}fKh(a,b,c){c=void 0===c?!0:c;const f=mb.GraphIterator.ob(this.eb),l=new mb.GraphIterator,u=new pg.GraphTransaction(2);u.Jz(f);ce.moveToFirstRow(f);
c?(ce.moveToRowByIndex(f,a),ce.moveToFirstColumn(f)):ce.moveToColumnByIndex(f,a);l.Uc(f);c?(ce.moveToRowByIndex(l,b),ce.moveToLastColumn(l)):(ce.moveToColumnByIndex(l,b),ce.moveToLastRow(l));a=$d.SelectionFactory.Y6b(f,l);this.Tc.Rb.VF(a);u.dispose()}static vKj(a){return zm.wKj(a,Yn.a.Yu)}static wKj(a,b){return b?zm.uKj(a):zm.xKj(a)}static xKj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){zm.vve(a)||zm.iwe(a)||(b=b.previousSibling);break}b=b.parentNode}return Yw.Hqg(b)}static uKj(a){let b=
a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(zm.iwe(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else zm.vve(a)||(b=b.previousSibling);break}b=b.parentNode}return b?Yw.Hqg(b):null}static T5(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static mYa(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeHandle")}static Nrk(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static vwa(a){return Sys.UI.DomElement.containsCssClass(a,
"TableColumnHandle")}static lgc(a){return Sys.UI.DomElement.containsCssClass(a,tm.a.odf)}static ROj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;a=a.parentNode}return null}static vve(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static iwe(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static YBg(a){return Sys.UI.DomElement.containsCssClass(a,"FirstLeft")}static Pjg(a){return a.firstChild}}Object(m.a)(zm,"TableViewElement",Cn,[1691,1509,1632,489,393,106]);class gN extends aN.a{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra){super(a,b);this.XSf="ShowDashedLine";this.Goa=this.me=this.Nd=this.a1g=this.V0g=this.i1g=this.gib=this.aMe=this.$Le=this.ye=this.c1g=null;this.M$g=this.L$g=this.R6=this.Q6=this.Nib=this.eha=0;this.nba=c;this.xhb=f;this.Nt=l;this.Cc=u;this.oa=I;this.vB=T;this.ia=ja;this.wq=Ra;this.flc=this.YIe=!1;this.YLk=ua}get P4e(){this.oWf();return this.ye.offsetLeft}set P4e(a){this.oWf();this.ye.style.left=Df.a.Rc(a)}get zoom(){return 1}Qv(a){const b=super.Qv(a);if(b&&this.tO){this.p3d(a.Ec);
Sys.UI.DomElement.addCssClass(this.ye,this.XSf);if(this.qda=zm.YBg(a.Ec))this.Wi=0,this.sG=this.Zl.c_c(this.Wi);this.Nd=this.Zl.ol;this.me=this.Cc.ybc(this.Nd.eb);this.flc=!1;this.J9e()&&this.Twj(a)}else b&&!this.tO&&(a=a.Ec,zm.vwa(a)&&(ya.a.J(512497184,816,50,"Drag from table column handle"),this.Wi=parseInt(a.parentNode.getAttribute("columnindex").toString())));b&&this.wq&&this.ia.nb(G.a.kma,2);return b}Px(a){this.tO?(a=this.bUf(a.clientPoint.x),this.P4e=this.c1g+(a-this.sG)*(this.qda?-1:1)):(a=
this.Zl.iGj(a.clientPoint.x),this.Zl.fKh(this.Wi,a,!1));return!0}Uo(a){if(this.tO){const f=this.nba.lj("UserAction","PPTColumnResize");a&&ya.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.Zl.eb.ra(yb.a.nLb,""),this.Zl.eb.rq()));const l=new pg.GraphTransaction(15);l.rd(this.Zl.eb);const u=this.Zl.eb.ra(rb.a.Wv,null);var b=this.bUf(a.clientPoint.x),c=this.Zl.Vd.Xd;const I=c.Cf(b,0);(this.qda||this.Wi===this.DH-1)&&this.Nt.l3a(this.Zl.eb,this.Wi,I);if(this.qda&&
b!==this.sG&&(b=this.sG-b)){this.Nd.setPosition(this.Nd.x+b,this.Nd.y,!0);b=c.Cf(this.Nd.x,0);c=c.Cf(this.Nd.y,1);const T=this.Zl.ol.shapeNode;T.zz=b;T.Az=c}!this.qda&&this.Wi<this.DH-1&&this.J8e(I,u);this.bBc();l.dispose();ad.App.Ob.Gf();this.end();this.me?this.Nt.m2a(this.me):ya.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");f&&f.stop();a&&ya.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",
this.Zl.eb.ra(yb.a.nLb,""),this.Zl.eb.rq(),this.qda))}else a&&ad.App.Ob.Q7(a.clientPoint,a.wg),super.Uo(a)}rv(a){super.rv(a);this.tO&&this.bBc()}ypg(){return null}oWf(){if(!this.ye)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!Yn.a.T5(this.ye))throw Error.invalidOperation("Element is not the table column resize handle");}p3d(a){this.ye=a;this.c1g=this.P4e;this.$Le=this.ye.style.marginLeft;this.aMe=this.ye.style.marginRight;this.gib=this.ye.style.height;
this.i1g=this.ye.style.top;this.V0g=this.ye.style.bottom;this.a1g=this.ye.style.left;this.ye.style.marginLeft=this.ye.style.marginRight="auto";this.ye.style.top="0";this.ye.style.height="auto";this.ye.style.bottom="0";this.xhb&&(a=Yn.a.Abc(a))&&(this.ye.style.top=-a.offsetTop+"px",this.ye.style.bottom=-(this.Zl.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}bBc(){this.ye&&(Sys.UI.DomElement.removeCssClass(this.ye,this.XSf),this.ye.style.marginLeft=this.$Le,this.ye.style.marginRight=this.aMe,
this.$Le=this.aMe="auto",this.ye.style.left=this.YLk?this.a1g:"auto",this.ye.style.top=this.i1g,this.ye.style.height=this.gib,this.ye.style.bottom=this.V0g,this.ye=null)}Twj(a){this.flc=this.YIe=!1;const b=a.Ec;if(Yn.a.T5(b)){var c=null,f=null;if((()=>{let u=this.Swj(b,c,f);({Cfb:c,anb:f}=u);return u})().returnValue&&this.Gxj(c,f)&&this.bke()&&this.me){a=this.Cc.ej(this.me);var l=this.Cc.fl(this.me);0<=this.eha&&this.eha<l&&0<=this.Nib&&this.Nib<l&&0<=this.Q6&&this.Q6<a&&0<=this.R6&&this.R6<a&&(this.flc=
!0)}}}Swj(a,b,c){if(!Yn.a.T5(a)||!this.me)return{returnValue:!1,Cfb:b,anb:c};var f=Yn.a.Abc(a);f=ig.a(f);this.Goa=Object(gb.a)(Sm.TableCellNode,f.eb);if(!this.Goa)return{returnValue:!1,Cfb:b,anb:c};f=this.G0c(this.Goa);if(0>f||f>=this.Cc.ej(this.me))return{returnValue:!1,Cfb:b,anb:c};const l=this.Goa.rowIndex;if(0>l||l>=this.Cc.fl(this.me))return{returnValue:!1,Cfb:b,anb:c};if(zm.YBg(a))return{returnValue:!1,Cfb:null,anb:c};b=this.me.tf(l,f);if(f===this.Cc.ej(this.me)-1)return{returnValue:!1,Cfb:b,
anb:null};c=this.me.tf(l,f+1);return{returnValue:!0,Cfb:b,anb:c}}Gxj(a,b){if(!this.me||!a||!b)return!1;this.eha=a.rowIndex;if(0>this.eha||this.eha>=this.Cc.fl(this.me))return!1;this.Nib=this.eha;this.Q6=this.aac(a);if(0>this.Q6||this.Q6>=this.Cc.ej(this.me))return!1;this.R6=this.G0c(b);if(0>this.R6||this.R6>=this.Cc.ej(this.me))return!1;var c=this.otj(a,b);a=c?this.Zuj(a,b):!1;if(c=c&&a)this.YIe=this.vhk(b.Yi);return c}vhk(a){let b=!0;if(0<this.eha)for(var c=this.eha-1;0<=c;){var f=this.me.tf(c,a);
if(f&&!f.isGhostCell){b=!1;break}--c}if(this.Nib<this.me.jW-1)for(c=this.eha+1;c<=this.me.jW-1;){if((f=this.me.tf(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}bke(){if(!this.me)return!1;const a=this.Cc.ej(this.me);if(0>this.Q6||this.Q6>=a||0>this.R6||this.R6>=a||0>this.Wi||this.Wi>=a||0>this.Wi+1||this.Wi+1>=a)return!1;this.L$g=this.Zle(this.me,this.Q6,this.Wi)-this.Yie(this.me,this.Q6);this.M$g=this.Zle(this.me,this.R6,this.Wi+1)-this.Yie(this.me,this.R6);return!0}Zle(a,b,c){if(b>c)return this.Zle(a,
c,b);if(!a||0>b||b>=this.Cc.ej(a)||0>c||c>=this.Cc.ej(a))return-1;a=a.wge;let f=0;for(;b<=c;b++)f+=a[b];return Math.floor(this.Zl.Vd.Xd.Ve(f,0))}Yie(a,b){return Wb.StyleReader.xs?Wb.StyleReader.xs.p$(a,b):wo.a.oCd}xGa(a,b){return this.Zl.Vd.Xd.Cf(this.Yie(a,b),0)}otj(a,b){if(!a||!b)return!1;a=a.T$b();const c=b.Yi;for(b=b.T$b();b&&(!b.isGhostCell||this.aac(b)===c);)this.eha--,this.Q6=Math.max(this.Q6,this.aac(a)),this.R6=Math.min(this.R6,this.G0c(b)),a=a.T$b(),b=b.T$b();return!0}Zuj(a,b){if(!a||!b)return!1;
a=a.SZc();const c=b.Yi;for(b=b.SZc();b&&(!a.isGhostCell||this.aac(b)===c);)this.Nib++,this.Q6=Math.max(this.Q6,this.aac(a)),this.R6=Math.min(this.R6,this.G0c(b)),a=a.SZc(),b=b.SZc();return!0}aac(a){return a?(a=a.$z())?a.Yi:-1:-1}G0c(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.$z());a=null;b&&(a=b.mie(2));return a?a.Yi:-1}bUf(a){this.J9e()&&this.flc?(a=this.Zl.eb.qpk?Math.floor((this.b9-a)/this.zoom)+this.sG:Math.floor((a-this.b9)/this.zoom)+this.sG,a=Math.min(a,this.sG+this.M$g),a=Math.max(a,this.sG-
this.L$g)):a=this.w3d(a);return a}J8e(a,b){if(this.J9e()&&this.flc){if(!this.oa.nI()){var c=$d.SelectionFactory.fh(Object(gb.a)(Zg.a,this.Goa.U9b),0);this.oa.setSelection(c)}let f=c=-1,l=-1;({g7f:c,z6f:f,A6f:l}=this.bAj(a-b[this.Wi],b,c,f,l));this.YIe&&(c===this.Wi&&Math.abs(f)>=this.xGa(this.me,c)||c===this.Wi+1&&c<this.Cc.ej(this.me)-1&&Math.abs(l)>=this.xGa(this.me,c+1)||c===this.Wi+1&&c===this.Cc.ej(this.me)-1)?(ya.a.J(512497182,815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.Wi.toString(),c.toString(),f.toString(),l.toString()),a=b[this.Wi]+b[this.Wi+1],c===this.Wi?(f=Math.max(f,this.xGa(this.me,c)),l=a-f):c===this.Wi+1&&(l=Math.max(l,this.xGa(this.me,c)),f=a-l),this.Nt.l3a(this.me,this.Wi,f),this.Nt.l3a(this.me,this.Wi+1,l)):(c>this.Q6&&Math.abs(f)<this.xGa(this.me,c)?(ya.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.Wi.toString(),c.toString(),
f.toString(),l.toString()),this.Zjb(c,this.Wi+1)):c<this.R6&&Math.abs(l)<this.xGa(this.me,c+1)?(ya.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.Wi.toString(),c.toString(),f.toString(),l.toString()),this.Zjb(c+1,this.Wi+1)):(ya.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.Wi.toString(),c.toString(),f.toString(),l.toString()),this.v4l(c,f,l)),this.Nt.e3e(this.me),a=mb.GraphIterator.ob(this.me),this.Nt.hhf(a),this.me.Pfa(511),this.vB.Xdc(this.me))}else this.Nt.l3a(this.me,this.Wi,a),this.Nt.l3a(this.me,this.Wi+1,b[this.Wi]+b[this.Wi+1]-a)}bAj(a,b,c,f,l){if(!a)return c=this.Wi,f=b[this.Wi],{g7f:c,z6f:f,A6f:0};f=0;if(0<a){for(c=this.Wi;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.Wi+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{g7f:c,z6f:f,A6f:l}}Zjb(a,b){if(b!==a){var c=
this.Ixj(b-1);for(let f=this.eha;f<=this.Nib;f++){const l=this.me.tf(f,b),u=this.me.tf(f,a);this.FRe(c[f],l,u)}}}FRe(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.Yi-b.Yi,u=a.colSpan+b.colSpan-l;Qm.c(Object(gb.a)(Zg.a,b),Object(gb.a)(Zg.a,c),this.Nt.$3d);Qm.c(Object(gb.a)(Zg.a,b),Object(gb.a)(Zg.a,c),[yb.a.KMa]);var I=mb.GraphIterator.ob(c);I.wf();var T=new mb.GraphIterator;T.set(Object(gb.a)(Zg.a,b));T.Gb(1)&&Qm.h(I,null,1,1,T,-1);c.isGhostCell=b.isGhostCell;this.gee(I);b.Vo(yb.a.rowSpan,
yb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=u,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}gee(a){const b=a.currentNode.$a(yb.a.rowId),c=a.currentNode.$a(yb.a.cellId);for(a=ll.a.rw(a);a.moveNext();){const f=a.currentNode.ra(yb.a.rowId,null),l=a.currentNode.ra(yb.a.cellId,null);f&&a.currentNode.setValue(yb.a.rowId,b);l&&a.currentNode.setValue(yb.a.cellId,c)}}v4l(a,b,c){var f=mb.GraphIterator.ob(this.me);ce.moveToFirstRow(f);f.Kq(a,1);this.Nt.kqe(f);if(f=this.me.ra(rb.a.Wv,null))f=
rd.a.clone(f),b<this.xGa(this.me,a)?(b=this.xGa(this.me,a),c=f[a]-b):(c=Math.max(c,this.xGa(this.me,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.me.setValue(rb.a.Wv,f);b=this.Wi+1;a+=1;a<=b&&(b+=1);this.Zjb(a,b)}Ixj(a){var b=this.Cc.fl(this.me);b=Array(b);for(let c=this.eha;c<=this.Nib;c++){const f=this.me.tf(c,a);b[c]=f.$z()}return b}J9e(){return!!this.me&&this.me.rq()&&!this.qda&&this.Wi<this.DH-1}}Object(m.a)(gN,"PowerPointColumnDragAdapter",aN.a,[]);class IF{constructor(a,b){this.Jy=this.c7=null;this.rmc=
this.bib=0;this.SJb=!1;this.Gaa=a;this.P1=b}Ew(a){if(3===a.wg)return!1;a=a.Ec;return zm.mYa(a)||zm.lgc(a)}rv(){if(this.SJb){const a=new pg.GraphTransaction(3);a.rd(this.c7.eb);this.c7.source.Dw(4,!0);a.dispose()}this.end()}end(){this.Gaa.pT()}dispose(){this.c7=null}}Object(m.a)(IF,"CommonRowHandleDragAdapter",null,[363,106]);class hN extends IF{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){super(a,b);this.rJe=this.WHb=!1;this.Y0g=this.MJa=0;this.Goa=this.me=this.Nd=this.hya=this.b1g=this.$0g=this.W0g=
this.Z0g=this.X0g=null;this.h1g=this.gf=this.K$g=this.J$g=this.P6=this.O6=this.qKa=this.p2=this.qB=0;this.nba=f;this.Gr=c;this.Hl=l;this.xhb=u;this.Nt=I;this.Cc=T;this.oa=ja;this.vB=ua;this.$Sk=Ra;this.ia=Bb;this.wq=Ub;this.s0a=null;this.glc=this.Jed=this.ted=!1;this.ns=eb}Qv(a){if(!this.Ew(a))return!1;const b=a.Ec;if(zm.lgc(b)){ya.a.J(512497178,816,50,"drag from table row handle");this.SJb=!1;var c=zm.ROj(b);if(!c)return!1;this.me=ig.a(c).eb;this.Jy=this.me.sc(this.gf);if(!this.Jy)return ya.a.J(512497177,
816,10,"OnDragStart : m_tableViewElement is null"),!1;this.h1g=this.ns.bje(this.Jy,a.clientPoint);this.P1.Grd(b);return!0}this.c7=zm.vKj(b);if(!this.c7)return!1;c=Object(gb.a)(746,this.c7.eb);this.gf=this.c7.Na;this.me=c?c.getContainingTable():null;if(!this.me)return!1;this.Jy=this.me.sc(this.gf);this.s0a=this.$Sk.Iie(this.me);if(!this.Jy||!this.s0a)return!1;this.WHb=zm.vve(b);this.rJe=zm.iwe(b);this.bib=this.c7.htmlElement.offsetHeight;this.rmc=this.MJa=a.clientPoint.y;this.P1.Dm(21);this.Gaa.endEditing(!0,
14);this.Nd=this.Jy.ol;this.Jed=this.ted=this.glc=!1;this.SJb=!0;this.K9e()&&this.DKj(b);this.p3d(b);this.wq&&this.ia.nb(G.a.kma,2);return!0}Px(a){this.SJb?(this.MJa=a.clientPoint.y,a=(this.fUf(this.MJa)-this.bib)*(this.WHb?-1:1)+this.Y0g,this.hya.style.top=a+"px"):(a=this.ns.bje(this.Jy,a.clientPoint),this.Jy.fKh(this.h1g,a));return!0}Uo(a){let b=null;a&&(b=this.nba.lj("UserAction","PPTRowResize"),ya.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.Jy.eb.ra(yb.a.nLb,
""),this.Jy.eb.rq())));if(this.SJb){var c=this.fUf(a?a.clientPoint.y:this.MJa),f=new pg.GraphTransaction(15);if(this.K9e()&&this.glc&&this.Jed)He.a.mark(11077),f.rd(this.me),this.J8e(c);else{this.c7.xRb(c);var l=this.c7.htmlElement.offsetHeight;He.a.mark(11077);var u=this.c7.eb;f.rd(u);c=this.Gaa.Xd;u.setValue(yb.a.wv,c.Cf(l,1));this.WHb&&l!==this.bib&&(l=this.bib-l)&&(this.Nd.setPosition(this.Nd.x,this.Nd.y+l,!0),l=c.Cf(this.Nd.x,0),c=c.Cf(this.Nd.y,1),u=this.Jy.ol.shapeNode,u.zz=l,u.Az=c)}this.bBc();
f.dispose();ad.App.Ob.Gf();He.a.mark(11078);this.end();this.me?this.Nt.m2a(this.me):ya.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&ya.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",this.Jy.eb.ra(yb.a.nLb,""),this.Jy.eb.rq()))}else a&&ad.App.Ob.Q7(a.clientPoint,a.wg),this.P1.c3()}rv(a){a.Hff?(super.rv(a),this.SJb&&this.bBc()):this.Uo(null)}end(){this.P1.c3();super.end()}fUf(a){a=this.bib+this.Gr.Tm(a-
this.rmc)*(this.WHb?-1:1);if(this.K9e()&&this.glc&&this.Jed)a=Math.min(a,this.bib+this.K$g),a=Math.max(a,this.bib-this.J$g);else{var b=this.Hl.TQc(this.c7.eb);b=this.c7.Vd.Xd.Ve(b,1);a=Math.max(b,a)}return a}p3d(a){this.hya=a;Sys.UI.DomElement.addCssClass(this.hya,"ShowDashedLine");this.Y0g=a.offsetTop;this.b1g=a.style.marginTop;this.$0g=a.style.width;this.X0g=a.style.left;this.Z0g=a.style.top;this.W0g=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left="0";a.style.bottom=
"auto";if(this.xhb){const b=Yn.a.Abc(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.c7.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}bBc(){Sys.UI.DomElement.removeCssClass(this.hya,"ShowDashedLine");this.hya.style.marginTop=this.b1g;this.hya.style.width=this.$0g;this.hya.style.left=this.X0g;this.hya.style.right="auto";this.hya.style.top=this.Z0g;this.hya.style.bottom=this.W0g}DKj(a){this.glc=this.ted=!1;if(this.me&&zm.mYa(a)){var b=null,c=null;if((()=>{let u=this.CKj(a,b,c);({q9a:b,
b$a:c}=u);return u})().returnValue&&this.Hxj(b,c)&&this.bke()){var f=this.Cc.ej(this.me),l=this.Cc.fl(this.me);0<=this.p2&&this.p2<f&&0<=this.qKa&&this.qKa<f&&0<=this.O6&&this.O6<l&&0<=this.P6&&this.P6<l&&(this.glc=!0);this.Jed=0<this.p2||this.qKa<f-1?!0:!1}}}CKj(a,b,c){if(!zm.mYa(a)||!this.me)return{returnValue:!1,q9a:b,b$a:c};a=Yn.a.Abc(a);a=ig.a(a);this.Goa=Object(gb.a)(Sm.TableCellNode,a.eb);if(!this.Goa)return{returnValue:!1,q9a:b,b$a:c};a=this.qB=this.Goa.rowIndex-1;if(0>a||a>=this.Cc.fl(this.me))return{returnValue:!1,
q9a:b,b$a:c};const f=this.Goa.Yi;if(0>f||f>=this.Cc.ej(this.me))return{returnValue:!1,q9a:b,b$a:c};if(this.WHb)return{returnValue:!1,q9a:null,b$a:c};b=this.me.tf(a,f);if(this.rJe)return{returnValue:!1,q9a:b,b$a:null};c=this.me.tf(a+1,f);return{returnValue:!0,q9a:b,b$a:c}}Hxj(a,b){if(!this.me||!a||!b)return!1;this.p2=a.Yi;if(0>this.p2||this.p2>=this.Cc.ej(this.me))return!1;this.qKa=this.p2;var c=a.$z();this.O6=c?c.rowIndex:-1;if(0>this.O6||this.O6>=this.Cc.fl(this.me))return!1;this.P6=this.nie(b);
if(0>this.P6||this.P6>=this.Cc.fl(this.me))return!1;a=(c=this.hEj(a,b))?this.oKj(a,b):!1;if(a=c&&a)this.ted=this.whk(b.rowIndex);return a}bke(){if(!this.me)return!1;const a=this.Cc.fl(this.me);if(0>this.O6||this.O6>=a||0>this.P6||this.P6>=a)return!1;this.J$g=this.Zhe(this.me,this.O6,this.qB)-this.XVa(this.me,this.O6);this.K$g=this.Zhe(this.me,this.P6,this.qB+1)-this.XVa(this.me,this.P6);return!0}hEj(a,b){if(!a||!b)return!1;a=a.acb();const c=b.rowIndex;for(b=b.acb();b&&a;){var f=b.$z();if(b.isGhostCell&&
f&&f.rowIndex!==c)break;this.p2--;if(f=a.$z())this.O6=Math.max(this.O6,f.rowIndex);this.P6=Math.min(this.P6,this.nie(b));a=a.acb();b=b.acb()}return!0}oKj(a,b){if(!a||!b)return!1;a=a.V0();const c=b.rowIndex;for(b=b.V0();b&&(!b.isGhostCell||b.$z().rowIndex===c);)this.qKa++,this.O6=Math.max(this.O6,a.$z().rowIndex),this.P6=Math.min(this.P6,this.nie(b)),a=a.V0(),b=b.V0();return!0}whk(a){let b=!0,c;if(0<this.p2)for((c=this.me.tf(a,this.p2))&&(c=c.acb());c;){if(!c.isGhostCell){b=!1;break}c=c.acb()}if(this.qKa<
this.me.O4-1)for((c=this.me.tf(a,this.qKa))&&(c=c.V0());c;){if(!c.isGhostCell){b=!1;break}c=c.V0()}return b}nie(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.$z());return b&&(b=b.mie(1))?b.rowIndex:-1}Zhe(a,b,c){if(b>c)return this.Zhe(a,c,b);if(!a||0>b||b>=this.Cc.fl(a)||0>c||c>=this.Cc.fl(a))return-1;for(a=0;b<=c;b++)a+=this.s0a[b];return Math.floor(a)}XVa(a,b){a=this.Hl.v3d(a,b);return Math.floor(this.Gaa.Xd.Ve(a,1))}J8e(a){if(!this.oa.nI()){var b=this.Goa.T$b().$z().U9b;b=$d.SelectionFactory.fh(Object(gb.a)(Zg.a,
b),0);this.oa.setSelection(b)}let c=b=-1;var f=-1;({h7f:b,x6f:c,y6f:f}=this.cAj(a-this.s0a[this.qB],this.s0a,b,c,f));if(this.ted&&(b===this.qB&&Math.abs(c)>=this.XVa(this.me,this.qB)||b===this.qB+1&&b<this.Cc.fl(this.me)&&Math.abs(f)>=this.XVa(this.me,this.qB+1)||b===this.qB+1&&b===this.Cc.fl(this.me)-1)){ya.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.qB.toString(),b.toString(),c.toString(),
f.toString());f=mb.GraphIterator.ob(this.me);this.iqc(f,this.qB);a=f.currentNode;var l=this.s0a[this.qB];const I=a.sc(this.gf);ce.moveToNextRow(f);f=f.currentNode;var u=this.s0a[this.qB+1];const T=f.sc(this.gf);u=l+u;l=this.Gaa.Xd;b===this.qB+1&&(c+=this.s0a[this.qB]);I.xRb(Math.floor(c));b=I.htmlElement.offsetHeight;a.setValue(yb.a.wv,l.Cf(b,1));b=u-b;b=Math.max(b,this.XVa(this.me,this.qB+1));T.xRb(Math.floor(b));f.setValue(yb.a.wv,l.Cf(T.htmlElement.offsetHeight,1))}else b>this.O6&&Math.abs(c)<
this.XVa(this.me,b)?(ya.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.qB.toString(),b.toString(),c.toString(),f.toString()),this.Zjb(b,this.qB+1)):b<this.P6&&Math.abs(f)<this.XVa(this.me,b+1)?(ya.a.J(512497170,815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.qB.toString(),b.toString(),c.toString(),
f.toString()),this.Zjb(b+1,this.qB+1)):(ya.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.qB.toString(),b.toString(),c.toString(),f.toString()),this.w4l(b,c,f)),this.Nt.e3e(this.me),b=mb.GraphIterator.ob(this.me),this.Nt.hhf(b),this.me.Pfa(511),this.vB.Xdc(this.me)}cAj(a,b,c,f,l){if(!a)return c=this.qB,f=b[this.qB],{h7f:c,x6f:f,y6f:0};f=0;if(0<a){for(c=this.qB;f<a;)c++,f+=b[c];l=f-a;f=
b[c]-l}else{for(c=this.qB+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{h7f:c,x6f:f,y6f:l}}Zjb(a,b){if(b!==a){var c=this.Jxj(b-1);b=this.me.tf(b,this.p2);a=this.me.tf(a,this.p2);for(let f=this.p2;f<=this.qKa;f++)this.FRe(c[f],b,a),b=b.V0(),a=a.V0()}}FRe(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,u=a.rowSpan+b.rowSpan-l;Qm.c(Object(gb.a)(Zg.a,b),Object(gb.a)(Zg.a,c),this.Nt.$3d);Qm.c(Object(gb.a)(Zg.a,b),Object(gb.a)(Zg.a,c),[yb.a.KMa]);var I=mb.GraphIterator.ob(c);I.wf();
var T=new mb.GraphIterator;T.set(Object(gb.a)(Zg.a,b));T.Gb(1)&&Qm.h(I,null,1,1,T,-1);c.isGhostCell=b.isGhostCell;this.gee(I);b.Vo(yb.a.rowSpan,yb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=u);a.Yi===I.lr.Yi&&(a.rowSpan=l)}}gee(a){const b=a.currentNode.$a(yb.a.rowId),c=a.currentNode.$a(yb.a.cellId);for(a=ll.a.rw(a);a.moveNext();){const f=a.currentNode.ra(yb.a.rowId,null),l=a.currentNode.ra(yb.a.cellId,null);f&&a.currentNode.setValue(yb.a.rowId,b);l&&a.currentNode.setValue(yb.a.cellId,
c)}}w4l(a,b,c){var f=mb.GraphIterator.ob(this.me);this.iqc(f,a);const l=f.currentNode;f=this.Nt.lqe(f);const u=this.Gaa.Xd,I=l.sc(this.gf);I.xRb(Math.floor(b));l.setValue(yb.a.wv,u.Cf(I.htmlElement.offsetHeight,1));c=Math.max(c,this.XVa(this.me,a+1));f.setValue(yb.a.wv,u.Cf(Math.floor(c),1));b=this.qB+1;a+=1;a<=b&&(b+=1);this.Zjb(a,b)}iqc(a,b){if(!(14!==a.Zi||0>b||b>=this.Cc.fl(a.currentNode)))for(ce.moveToFirstRow(a);0<b--;)ce.moveToNextRow(a)}Jxj(a){a=this.me.tf(a,this.p2);var b=this.Cc.ej(this.me);
b=Array(b);for(let c=this.p2;c<=this.qKa;c++)b[c]=a.$z(),a=a.V0();return b}K9e(){return!!this.me&&this.me.rq()&&!this.WHb&&!this.rJe}}Object(m.a)(hN,"PowerpointRowHandleDragAdapter",IF,[]);class JF{constructor(a,b,c,f){this.vB=f;this.gJa=a;this.gJa.Ak(Object(R.a)(this,this.ph,"onPropertyChanged"))}ph(a,b){a=b.property;(b=Object(gb.a)(650,b.node))&&(a===yb.a.colSpan||a===yb.a.rowSpan)&&(b=b.getContainingTable())&&(this.vB.qWk(b),b.w_=null)}dispose(){this.gJa.tn(Object(R.a)(this,this.ph,"onPropertyChanged"))}}
Object(m.a)(JF,"TableCellNodeBehavior",null,[106]);class iN extends zc.a{constructor(a,b){super(a,b,"TableCellSelected")}mgh(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.a3a)?Sys.UI.DomElement.addCssClass(a,this.a3a):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.a3a)&&Sys.UI.DomElement.removeCssClass(a,this.a3a)}}Object(m.a)(iN,"TableCellSelectionBehavior",zc.a,[1675,447]);class jN extends Sys.EventArgs{constructor(a){super();this.upi=a}get tableCellNode(){return this.u8l.tableCellNode}get u8l(){return this.upi}}
Object(m.a)(jN,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class KF extends Sys.EventArgs{constructor(a){super();this.U8i=a}}Object(m.a)(KF,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Pq=d(190);class Ut extends Xw{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){super(a,b,f,l,Tb.a.instance.resolve("Box4.ITableCellReader"),Tb.a.instance.resolve("Box4.IParagraphReader"),Tb.a.instance.resolve("Box4.IOutlineElementNavigator"),Tb.a.instance.resolve("Box4.ITableNavigator"),Tb.a.instance.resolve("Box4.IOutlineElementReader"),
Tb.a.instance.resolve("Box4.Styles.IStyleReader"),Tb.a.instance.ub("Box4.IFeatureHelper"),new iN(a,b),Tb.a.instance.ub("Box4.Styles.ITableCellspacingReader"),Tb.a.instance.resolve("Box4.TableCellViewElementSettings"));this.SKe=this.TKe=this.ukd=this.Akd=this.DKb=this.Vh=this.sjb=this.BP=this.MP=this.r2=null;this.roa=!1;this.Xna=null;this.Xj=Object(gb.a)(650,b);this.Ga=c;this.vB=u;this.Hl=I;this.Hc=T;this.KIa=ja;this.Cc=ua;this.xhb=Ra;this.kIb=eb;this.e2=Bb;this.Efd=Ub;this.Rkc=md.a("PPTOEnableTableDiagonalBorders");
this.oa=Xb;this.$wa=this.Ihg();(this.xhb||this.kIb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}m8(){}Oz(a){super.Oz(a);this.xhb&&!this.Vd.Nm&&this.WOl()}kGa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}mEg(){const a=this.oa.duj(),b=this.Xj.getContainingTable();return b?Array.contains(a,b):!1}ivl(a){switch(a){case "Top":this.Vh.style.top="-0.5px";this.Vh.style.borderTopWidth="1px";break;case "Right":this.Vh.style.right=
"-0.5px";this.Vh.style.borderRightWidth="1px";break;case "Bottom":this.Vh.style.bottom="-0.5px";this.Vh.style.borderBottomWidth="1px";break;case "Left":this.Vh.style.left="-0.5px",this.Vh.style.borderLeftWidth="1px"}}hvl(a){switch(a){case "Top":this.Vh.style.top="0px";this.Vh.style.borderTopWidth="0px";break;case "Right":this.Vh.style.right="0px";this.Vh.style.borderRightWidth="0px";break;case "Bottom":this.Vh.style.bottom="0px";this.Vh.style.borderBottomWidth="0px";break;case "Left":this.Vh.style.left=
"0px",this.Vh.style.borderLeftWidth="0px"}}Lud(a){this.Vh&&(this.mEg()?this.ivl(a):this.hvl(a))}UOl(a,b,c){const f=!md.a("TableBorderOutsideBorderHalfClippingDisabled");this.Pbe();var l=mb.GraphIterator.ob(this.eb);l.uc(14);var u=l.Ug(14);l=this.Cc.fl(u);u=this.Cc.ej(u);c=c?c.GW():"";switch(a){case "Top":b=this.Vd.Xd.Ve(b,1);!this.Xj.rowIndex&&f?(this.Vh.style.top="0px",this.Vh.style.borderTopWidth=b/2+"px"):(this.Vh.style.top=-b/2+"px",this.Vh.style.borderTopWidth=b+"px");this.Vh.style.borderTopColor=
c;break;case "Bottom":b=this.Vd.Xd.Ve(b,1);this.Xj.rowIndex+this.Xj.rowSpan===l&&f?(this.Vh.style.bottom="0px",this.Vh.style.borderBottomWidth=b/2+"px"):(this.Vh.style.bottom=-b/2+"px",this.Vh.style.borderBottomWidth=b+"px");this.Vh.style.borderBottomColor=c;break;case "Left":b=this.Vd.Xd.Ve(b,0);!this.Xj.Yi&&f?(this.Vh.style.left="0px",this.Vh.style.borderLeftWidth=b/2+"px"):(this.Vh.style.left=-b/2+"px",this.Vh.style.borderLeftWidth=b+"px");this.Vh.style.borderLeftColor=c;break;case "Right":b=this.Vd.Xd.Ve(b,
0);this.Xj.Yi+this.Xj.colSpan===u&&f?(this.Vh.style.right="0px",this.Vh.style.borderRightWidth=b/2+"px"):(this.Vh.style.right=-b/2+"px",this.Vh.style.borderRightWidth=b+"px");this.Vh.style.borderRightColor=c;break;case "DiagonalUp":this.Rkc&&(b=this.Vd.Xd.Ve(b,0),this.r7f(a,b,c));break;case "DiagonalDown":this.Rkc&&(b=this.Vd.Xd.Ve(b,0),this.q7f(a,b,c))}this.kOh()}r7f(a,b,c){this.p9f();this.TKe||(this.TKe=this.K0f());this.LLh(this.TKe,a,b,c)}q7f(a,b,c){this.p9f();this.SKe||(this.SKe=this.K0f());this.LLh(this.SKe,
a,b,c)}K0f(){const a=new Fm.a;this.Akd.appendChild(a.va);this.rp(a.va);return a}LLh(a,b,c,f){b=this.I2i(b);a.h_(b);a.Vv(f);a.vs(c)}I2i(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.mge(),this.oge());case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.oge(),this.mge())}ya.a.J(508694599,822,10,"CreateDAttrib : Unknown borderType "+a);return null}p9f(){this.Pbe();this.DKb||(this.DKb=this.Vd.Tp(va.a.div),this.DKb.className="PPTTableDiagonalBorder",this.sjb.appendChild(this.DKb),
this.rp(this.DKb));this.ukd||(this.ukd=new Wj.a,this.Akd=this.ukd.va,this.DKb.appendChild(this.Akd),this.rp(this.Akd));this.ukd.Yqa(String.format("0 0 {0} {1}",this.oge(),this.mge()))}Pbe(){this.sjb||(this.sjb=this.Vd.Tp(va.a.div),this.sjb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.sjb,this.htmlElement.firstChild),this.rp(this.sjb));this.Vh||(this.Vh=this.Vd.Tp(va.a.div),this.Vh.className="PPTTableBorder",this.sjb.appendChild(this.Vh),this.rp(this.Vh))}kOh(){this.Efd&&
md.a("MergeDifferentBordersFixEnabled")?this.Vh.style.zIndex=this.cFb(this.Xj)?"1":(this.AXa(this.Xj.ZAa)||this.AXa(this.Xj.Pia))&&(this.AXa(this.Xj.YAa)||this.AXa(this.Xj.Qia))?"3":"2":this.Vh.style.zIndex=(this.AXa(this.Xj.ZAa)||this.AXa(this.Xj.Pia))&&(this.AXa(this.Xj.YAa)||this.AXa(this.Xj.Qia))?"1":"0"}cFb(a){return 1<a.rowSpan||1<a.colSpan}hhk(a){return"DiagonalUp"===a||"DiagonalDown"===a}tNa(a,b,c,f){const l=this.Efd&&md.a("MergeDifferentBordersFixEnabled")&&this.cFb(this.Xj);this.Efd&&!this.hhk(a)&&
this.mEg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.gek()&&(b=0);this.Vh.style.borderTopWidth=b+"px";this.Vh.style.borderTopColor=c;this.Vh.style.borderTopStyle=f;this.Vh.style.top=-b/2+"px";break;case "Right":l&&!this.fek()&&(b=0);this.Vh.style.borderRightWidth=b+"px";this.Vh.style.borderRightColor=c;this.Vh.style.borderRightStyle=f;this.Vh.style.right=-b/2+"px";break;case "Bottom":l&&!this.$dk()&&(b=0);this.Vh.style.borderBottomWidth=b+"px";this.Vh.style.borderBottomColor=
c;this.Vh.style.borderBottomStyle=f;this.Vh.style.bottom=-b/2+"px";break;case "Left":l&&!this.bek()&&(b=0);this.Vh.style.borderLeftWidth=b+"px";this.Vh.style.borderLeftColor=c;this.Vh.style.borderLeftStyle=f;this.Vh.style.left=-b/2+"px";break;case "DiagonalUp":this.Rkc&&this.r7f(a,b,c);break;case "DiagonalDown":this.Rkc&&this.q7f(a,b,c)}}oge(){var a=0;for(let b=0;b<this.Xj.colSpan;b++)a+=this.Xj.getContainingTable().wge[this.Xj.Yi+b];a=this.Vd.Xd.Ve(a,0);return Math.round(100*a)/100}mge(){var a=this.Cc.I1c(this.Xj.getContainingTable(),
this.Xj.rowIndex,this.Xj.rowIndex+this.Xj.rowSpan-1);let b=0;for(const c of a)Object(gc.a)(746,c)?b+=c.ra(yb.a.wv,0):ya.a.J(508694598,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",c));this.Xj.marginTop+this.Xj.marginBottom>b&&ya.a.J(508694597,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.Xj.marginTop,this.Xj.marginBottom));b=Math.max(b,this.Xj.marginTop+this.Xj.marginBottom);
a=this.Vd.Xd.Ve(b,1);return Math.round(100*a)/100}gek(){if(!this.Xj.rowIndex)return!0;const a=this.Xj.getContainingTable();if(!a)return!0;const b=this.Xj.rowIndex-1;var c=this.Xj.Yi;const f=c+this.Xj.colSpan-1;for(;c<=f;c++){const l=a.tf(b,c);if(l&&(l.isGhostCell||this.cFb(l)))return!0}return!1}bek(){if(!this.Xj.Yi)return!0;const a=this.Xj.getContainingTable();if(!a)return!0;const b=this.Xj.Yi-1;var c=this.Xj.rowIndex;const f=c+this.Xj.rowSpan-1;for(;c<=f;c++){const l=a.tf(c,b);if(l&&(l.isGhostCell||
this.cFb(l)))return!0}return!1}fek(){const a=this.Xj.getContainingTable();if(!a)return!0;var b=this.Cc.ej(a);if(this.Xj.Yi+this.Xj.colSpan===b)return!0;b=this.Xj.Yi+this.Xj.colSpan;var c=this.Xj.rowIndex;const f=c+this.Xj.rowSpan-1;for(;c<=f;c++){const l=a.tf(c,b);if(l&&(l.isGhostCell||this.cFb(l)))return!0}return!1}$dk(){const a=this.Xj.getContainingTable();if(!a)return!0;var b=this.Cc.fl(a);if(this.Xj.rowIndex+this.Xj.rowSpan===b)return!0;b=this.Xj.rowIndex+this.Xj.rowSpan;var c=this.Xj.Yi;const f=
c+this.Xj.colSpan-1;for(;c<=f;c++){const l=a.tf(b,c);if(l&&(l.isGhostCell||this.cFb(l)))return!0}return!1}WOl(){var a=!md.a("TableBorderOutsideBorderHalfClippingDisabled");this.Pbe();if(a){a=mb.GraphIterator.ob(this.eb);a.uc(14);var b=a.Ug(14);a=this.Cc.fl(b);b=this.Cc.ej(b);var c=this.kGa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.tNa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.Xj.Yi?this.Vh.style.left=-c/2+"px":
(this.Vh.style.left="0px",this.Vh.style.borderLeftWidth=c/2+"px");c=this.kGa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.tNa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);this.Xj.Yi+this.Xj.colSpan===b?(this.Vh.style.right="0px",this.Vh.style.borderRightWidth=c/2+"px"):this.Vh.style.right=-c/2+"px";b=this.kGa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.tNa("Top",b,this.htmlElement.style.borderTopColor,
this.htmlElement.style.borderTopStyle);this.Xj.rowIndex?this.Vh.style.top=-b/2+"px":(this.Vh.style.top="0px",this.Vh.style.borderTopWidth=b/2+"px");b=this.kGa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);this.tNa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.Xj.rowIndex+this.Xj.rowSpan===a?(this.Vh.style.bottom="0px",this.Vh.style.borderBottomWidth=b/2+"px"):this.Vh.style.bottom=-b/2+"px"}else a=this.kGa(this.htmlElement.style.borderLeft,
this.htmlElement.style.borderLeftWidth),this.tNa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.kGa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),this.tNa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.kGa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.tNa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),
a=this.kGa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth),this.tNa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.p7f();this.Efd&&this.kOh();this.htmlElement.style.border=""}p7f(){this.Rkc&&(this.dEe&&this.KLh("DiagonalUp",this.dEe),this.cEe&&this.KLh("DiagonalDown",this.cEe))}AXa(a){return!!a}KLh(a,b){const c=b.split(" ");if(3!==c.length)ya.a.J(508694596,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",
b));else{var f=c[0];b=this.kGa(b,c[1]);this.tNa(a,b,c[2],f)}}SBc(a,b,c,f,l,u,I){if(!this.e2||this.Ga.Gn(this.Xj).$a(yb.a.isResizable))this.kIb?this.Qjm(l,u,I):this.Pjm(a,b,c,f,l,u,I)}Qjm(a,b,c){this.MIa||(this.MIa=this.yTc(),this.rp(this.MIa));this.r2||(this.r2=this.XTa(),this.rp(this.r2));a?Sys.UI.DomElement.addCssClass(this.r2,"First"):Sys.UI.DomElement.removeCssClass(this.r2,"First");b^!!this.MP&&(b?(this.MP=this.XTa(),this.rp(this.MP)):(this.mPb(this.MP),this.MP=null));this.MP&&Sys.UI.DomElement.addCssClass(this.MP,
"Last");c^!!this.BP&&(c?(this.BP=this.yTc(),this.rp(this.BP)):(this.mPb(this.BP),this.BP=null));this.BP&&Sys.UI.DomElement.addCssClass(this.BP,"FirstLeft")}Pjm(a,b,c,f,l,u,I){super.SBc(a,b,c,f,l,u,I);this.Lxb&&this.rp(this.Lxb);this.r2||(this.r2=this.XTa(),this.rp(this.r2));this.r2.style.left=a+"px";this.r2.style.top=b+"px";this.r2.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.r2,"First"):Sys.UI.DomElement.removeCssClass(this.r2,"First");u^!!this.MP&&(u?(this.MP=this.XTa(),this.rp(this.MP)):
(this.mPb(this.MP),this.MP=null));this.MP&&(this.MP.style.bottom="0",this.MP.style.left=a+"px",this.MP.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.MP,"Last"));I^!!this.BP&&(I?(this.BP=this.yTc(),this.rp(this.BP)):(this.mPb(this.BP),this.BP=null));this.BP&&(this.BP.style.left="0",this.BP.style.top=b+"px",this.BP.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.BP,"FirstLeft"));this.xhb&&(this.r2.style.left="0",this.r2.style.top="0",this.Lxb&&(this.Lxb.style.left=c+"px",this.Lxb.style.top=
"0",this.Lxb.style.height=f+"px"),this.MP&&(this.MP.style.left="0"),this.BP&&(this.BP.style.top="0"))}vLh(){var a=this.Vd.Xd,b=a.Ve(this.Hl.eva(this.eb,3),1);this.vla.style.paddingTop=b+"px";b=a.Ve(this.Hl.eva(this.eb,0),1);this.vla.style.paddingBottom=b+"px";b=a.Ve(this.Hl.eva(this.eb,1),0);this.vla.style.paddingLeft=b+"px";a=a.Ve(this.Hl.eva(this.eb,2),0);this.vla.style.paddingRight=a+"px"}YOl(a,b){const c=this.Vd.Xd;switch(b){case M.a.Wzc:a=c.g1(a.marginTop,1);this.vla.style.paddingTop=a+"px";
break;case M.a.Qzc:a=c.g1(a.marginBottom,1);this.vla.style.paddingBottom=a+"px";break;case M.a.Rzc:a=c.g1(a.marginLeft,0);this.vla.style.paddingLeft=a+"px";break;case M.a.Vzc:a=c.g1(a.marginRight,0),this.vla.style.paddingRight=a+"px"}}fW(){var a=this.Hl.eva(this.eb,1),b=this.Hl.eva(this.eb,2);const c=this.Hl.M$b(this.eb,5),f=this.Hl.M$b(this.eb,6);var l=this.Vd.Xd;a=l.Ve(a+c,0);b=l.Ve(b+f,0);l=l.Ve(this.Hl.aUf(this.eb),0);return new J.a(a,l,b)}N1h(){this.htmlElement.style.background=this.vB.Xgg(this.eb)}XV(){if(!this.Vh)super.XV();
else if(!this.Vd.Nm&&this.yC){const a=Object(gb.a)(1675,this.aT);a&&a.mgh(this.Vh)}}XTa(){const a=this.R1f();a.className="TableRowResizeHandle";return a}mPb(a){ca.a.QMa(a);za.a.oQ(a)}get tableCellNode(){return this.Xj}get E$c(){return this.Xna}get ol(){this.$wa||(this.$wa=this.Ihg());return this.$wa}set ol(a){this.$wa=a}get Mq(){return this.roa}DRb(a){this.roa=a;this.tableCellNode.FDb=a}lock(a){this.Mq&&this.Xna===a||(this.ol.eCd(),this.Xna=a,this.DRb(!0),this.Hc.Gz(new Pq.a(7)),this.KIa.dAh(new KF(a)),
this.KIa.Hrl(new jN(this)))}unlock(){this.Mq&&(this.Xna=null,this.DRb(!1),this.Hc.Gz(new Pq.a(7)),this.KIa.dAh(new KF(null)))}Ihg(){let a=null;const b=this.Ga.Gn(this.Xj);b&&(a=Object(gb.a)(178,b.vg(this.Na)));return a}}Object(m.a)(Ut,"TableCellViewElement",Xw,[1676,489,393,106]);var WB=d(298),PS=d(510);class cn extends ti{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){super(a,b);ti.E6a=()=>Um.gag(kh.a.create());this.Hl=c;this.zm=f;this.RK=u;this.u0a=l;this.Cc=I;this.b7=T;this.r0a=ja;this.hIb=ua;this.gf=Ra;
this.Ied=md.a("PPTOEnableTableDiagonalBorders")}aXf(a,b){const c=Jd.TableReader.ej(a);ti.OTi(a,b,c)}U1f(a,b,c,f,l){f=void 0===f?null:f;l=void 0===l?!1:l;const u=a.parentNode.$a(yb.a.shapeId);a.currentNode.setValue(yb.a.shapeId,u);for(var I=0;I<b;++I){var T=new PS.a;a.$l(T,1);T.setValue(yb.a.shapeId,u);T.setValue(yb.a.rowId,kh.a.create())}b=null;I=!0;a.Gb(1);do{T=a.currentNode.$a(yb.a.rowId);for(let ja=0;ja<c;++ja){const ua=this.hua();a.$l(ua,1);ua.setValue(yb.a.shapeId,u);ua.setValue(yb.a.rowId,T);
ua.setValue(yb.a.cellId,kh.a.create());({OJh:b,isFirst:I}=this.Hcg(a,ua,l,f,b,I));ce.returnToContainingRow(a)}}while(a.sk(1))}m2a(a){if(this.Ied&&a&&(a=this.Cc.LG(a)))for(const b of a)b&&!b.isGhostCell&&(a=Object(gb.a)(Ut,b.sc(this.gf)))&&a.p7f()}Q4e(a,b,c,f,l){var u=this.RK.e_c(a);for(var I=0;I<u.length;I++){const T=this.Hl.Uwb(a,I);u[I]=Math.max(T,u[I]*b)}a.setValue(rb.a.Wv,u);if(1!==c)for((new mb.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){u=l.Cf(f.sKj(c),1);I=this.Hl.v3d(a,c);u<=I&&(u=0);
b.setValue(yb.a.wv,u);if(b.bDg())break;else b=b.pLa;c++}this.m2a(a)}TOl(a,b){a=this.Cc.LG(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].pra=b}}SOl(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let u=0;u<l.length;u++){var c=l.ga(u).iterator;c.uc(16);c.Ug(16);c=c.lr;const I=c.cellShading;I.anchorField=b;c.cellShading=I;c.pra=b}}}Tdc(a,b,c,f,l){super.Tdc(a,b,c,f,l);c=[];Array.add(c,yb.a.wv);Qm.b(f,b,c);c=a.currentNode.$a(yb.a.shapeId);const u=
a.lr.$a(yb.a.sid);a=a.lr.$a(yb.a.cid);const I=Um.E_f(kh.a.create());b.setValue(yb.a.sid,u);b.setValue(yb.a.cid,a);b.setValue(yb.a.shapeId,c);b.setValue(yb.a.rowId,I);this.Zjm(f,b,l)}Gdc(a,b,c,f,l){super.Gdc(a,b,c,f,l);return this.kod(a.currentNode,b,c,f,!1,!1)}F2b(a,b,c,f,l){super.F2b(a,b,c,f,l);return this.kod(a.currentNode,b,c,f,l,!1)}get $3d(){if(!cn.eca){cn.eca=[];let a,b,c;for(const f of cn.Vad)if(this.Ied||2!==f&&1!==f)({ZSa:b,c$a:a,Awb:c}=Oq.fWa(f)),Array.add(cn.eca,b),Array.add(cn.eca,a),
Array.add(cn.eca,c);Array.add(cn.eca,rb.a.MF);Array.add(cn.eca,yb.a.cellShading);Array.add(cn.eca,ib.a.cTb);Array.add(cn.eca,ib.a.eTb);Array.add(cn.eca,ib.a.fTb);Array.add(cn.eca,ib.a.bTb);Array.add(cn.eca,yb.a.AQ)}return cn.eca}kod(a,b,c,f,l,u){c=u?this.KWj(b,c,l):this.LWj(b,c,f,l);Qm.c(c,b,this.$3d);f=a.$a(yb.a.cid);u=a.$a(yb.a.shapeId);const I=c.$a(yb.a.cellId),T=a.$a(yb.a.rowId);b.setValue(yb.a.sid,a.$a(yb.a.sid));b.setValue(yb.a.cid,f);b.setValue(yb.a.shapeId,u);b.setValue(yb.a.rowId,T);l?b.setValue(yb.a.cellId,
I):b.setValue(yb.a.cellId,b.id.rr);return c}gNf(a,b,c,f,l,u){a=a.currentNode;const I=Array(c);let T=0,ja=0,ua=0;for(;T<f;T++)I[T]=b[T],ja+=I[T];for(l=l?b[f]:b[f-1];T<f+u;T++)I[T]=l,ua+=I[T];for(;T<c;T++)I[T]=b[T-u],ja+=I[T];b=ja/(ua+ja);for(T=0;T<c;T++)I[T]=Math.max(I[T]*b,this.Hl.Uwb(a,T));return I}brc(a,b,c,f,l){super.brc(a,b,c,f,l);Jd.TableReader.ej(a);var u=a.$a(yb.a.ipb);l=Array(u.length+f);let I=0;for(;I<b;I++)l[I]=u[I];for(;I<b+f;I++)l[I]=cn.S4i();for(;I<l.length;I++)l[I]=u[I-f];a.setValue(yb.a.ipb,
l);u=c?l[b+f]:l[b-1];a=Object(gb.a)(WB.TableNode,a);this.mhm(a,u,l.slice(b,f+b),b,c);if(this.hIb)for(l=this.r0a.create(a),f=b+f,u=(!c||!b)&&b<this.Cc.ej(a)-1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.b7.kee(a,l,c,0,this.Cc.fl(a),u)}QUe(a,b,c,f){super.QUe(a,b,c,f);if(this.hIb){a=Object(gb.a)(745,a);const l=this.r0a.create(a);f=c+f;const u=(!b||!c)&&c<this.Cc.fl(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.b7.hee(a,l,b,0,this.Cc.ej(a),u)}}iUe(a,b,c){super.iUe(a,b,c);this.sUb(a,yb.a.complexTable);this.hIb&&
(a=Object(gb.a)(745,a.currentNode),c=this.r0a.create(a),this.b7.hee(a,c,b,0,this.Cc.ej(a),!0))}hUe(a,b,c){super.hUe(a,b,c);const f=a.currentNode.$a(yb.a.ipb),l=Array(f.length-c);let u=0;for(;u<b;u++)l[u]=f[u];for(;u<l.length;u++)l[u]=f[u+c];a.currentNode.setValue(yb.a.ipb,l);this.sUb(a,yb.a.complexTable);this.hIb&&(a=Object(gb.a)(745,a.currentNode),c=this.r0a.create(a),this.b7.kee(a,c,b,0,this.Cc.fl(a),!0))}Zjm(a,b,c){b.setValue(yb.a.Lul,a.$a(yb.a.rowId));b.setValue(yb.a.insertBefore,c)}mhm(a,b,c,
f,l){a=a.firstRow;do for(let u=0;u<c.length;++u){const I=mb.GraphIterator.ob(a),T=I.Kq(f+u,1);T.setValue(yb.a.Kul,b);T.setValue(yb.a.insertBefore,l);T.setValue(yb.a.cellId,c[u]);cn.$Mh(I,yb.a.cellId,c[u])}while(a=a.pLa)}hua(){const a=super.hua();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}PTe(a,b){this.mVj(a,b,c=>{c.currentNode.isGhostCell=!1;ti.Wy.Rdc(c,null,!0);const f=c.currentNode.$a(yb.a.rowId),l=c.currentNode.$a(yb.a.cellId);for(c=ll.a.rw(c);c.moveNext();){const u=c.currentNode.ra(yb.a.rowId,
null),I=c.currentNode.ra(yb.a.cellId,null);u&&c.currentNode.setValue(yb.a.rowId,f);I&&c.currentNode.setValue(yb.a.cellId,l)}})}dvd(a){Jd.TableReader.nu(a.currentNode)&&this.JCh(a,b=>b.$h(yb.a.wv),(b,c)=>{b.He(yb.a.wv,c)},yb.a.complexTable)}e3e(a){a&&(a=mb.GraphIterator.ob(a),this.dvd(a,0))}Uqa(a,b){if(a)for(a=this.zm.eua(a),a.Um(c=>15===c.Zi,null);a.moveNext();){const c=Object(gb.a)(746,a.iterator.currentNode),f=this.u0a.rcb(c);c.setValue(yb.a.wv,f*b)}}FNa(a,b){if(a&&14===a.type){const c=this.RK.e_c(a);
for(let f=0;f<c.length;f++){const l=this.Hl.Uwb(a,f);c[f]=Math.max(l,c[f]*b)}a.setValue(rb.a.Wv,c)}}MNh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(yb.a.wv,Re.a.gY(b))}LNh(a,b,c){if(a&&b&&0<b.length){const f=this.RK.e_c(a);for(let l=0;l<b.length;l++)f[b[l]]=Re.a.gY(c);a.setValue(rb.a.Wv,f)}}lqe(a){const b=new mb.GraphIterator;b.Uc(a);var c=b.currentNode;b.Gb(1);const f=a.Dc();this.ABa(a);const l=Gr.a.instance.createInstance(393251);this.Tdc(a,l,c,c,!1);a.Cl(l);c=this.Cc.ej(f);for(let u=0;u<
c;++u){const I=this.hua();super.F2b(a,I,b.currentNode,!1,!0);this.kod(l,I,b.currentNode,!1,!0,!0);b.Qf(1)}this.lRb(f,this.Cc.fl(f)+1);return a.currentNode}kqe(a){const b=mb.GraphIterator.ob(a.p4h());let c=this.Cc.ej(b.currentNode);var f=this.RK.d_c(Object(gb.a)(650,a.currentNode));a=f+1;this.ABa(b);b.Gb(1);do{const l=b.Kq(f,1);b.Dc();const u=this.hua();super.Gdc(b,u,l,!1,!1);this.kod(b.currentNode,u,l,!1,!1,!0)}while(b.sk(1));(f=b.currentNode.ra(rb.a.Wv,null))&&(f=rd.a.clone(f));this.XQb(b.currentNode,
++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(rb.a.Wv,f));this.brc(b.currentNode,a,!1,1,null)}hhf(a){this.sUb(a,yb.a.complexTable)}KWj(a,b,c){let f=b;const l=b.iLa;if(l)if(b.isGhostCell)ti.a1c(l,!c)||ti.Fnb(l.controlCell,c,ti.KAb(l.controlCell,c)+1);else{const u=ti.KAb(b,c);1<u&&(f=ti.yBj(l,!c));ti.Fnb(b,c,u+1)}else ti.Fnb(b,c,2);a.isGhostCell=!0;return f}static $Mh(a,b,c){a.currentNode.He(b,c);let f=a.sj();if(f){for(;f;)cn.$Mh(a,b,c),f=a.Up();a.Dc()}}static S4i(){return Um.E_f(kh.a.create())}}
cn.eca=null;cn.Vad=[5,6,7,0,2,1];Object(m.a)(cn,"TableEditor",ti,[1738]);const kN=(a,b,c,f,l)=>{const u=l.jW,I=l.Sta;var T=l.tableLook;const ja=0<(T&32);l=0<(T&128);const ua=0<(T&64),Ra=0<(T&256),eb=ja?1:0,Bb=l?1:0;T=a?a===u-c?ua?3:(a-eb)%2+eb:(a-eb)%2+eb:0;u-c||(T=ja?0:ua?3:(a-eb)%2+eb);a=b?b===I-f?Ra?3:(b-Bb)%2+Bb:(b-Bb)%2+Bb:0;I-f||(a=l?0:Ra?3:(b-Bb)%2+Bb);return{PTf:T,NTf:a}};class LF{constructor(a){this.w2=a;this.ugd=Array(4);for(a=0;4>a;a++)this.ugd[a]=Array(4)}Hgg(a,b,c,f){const {PTf:l,NTf:u}=
kN(a,b,c,f,this.w2);if(!this.ugd[l][u]){b=Object.assign(new Ur.a,{qe:b,hg:b+f,Ae:a,rg:a+c});a=this.ugd[l];c=this.w2;f=c.tableStyle;var I=new Ar;I.latinField=Bf.tyb(1,0);I.eaField=Bf.tyb(1,1);I.csField=Bf.tyb(1,2);I.solidFillField=Object.assign(new nu.a,{schemeClrField:Object.assign(new sn.a,{valField:1})});f&&(new OM(I)).y0(c,b);b=I;f=c.Zwk;c=new tz;f=f||new NM;for(I=1;9>=I;I++){var T=PM(f,I);const ja=I-1;c.MWe[ja]=T?Fe.a(Fe.c(T)):new kt;T=c.MWe[ja].defRPrField;c.qxb[ja]=T?Fe.a(Fe.c(T)):new Ar}for(f=
1;9>=f;f++)QM(c.qxb[f-1],b);a[u]=c}return this.ugd[l][u]}kig(a,b,c,f,l){let u=Vb.a.kUa;a&&(b=this.Hgg(b,c,f,l))&&b.qxb&&0<b.qxb.length&&(b=b.qxb[0])&&(u=Ze.Box4ColorHelper.KPb(b,a));return u}}Object(m.a)(LF,"TableListStyleCache",null,[1708]);class MF{constructor(a,b,c,f){this.gJa=a;this.ldh=b;this.gJa.Ak(Object(R.a)(this,this.ph,"onPropertyChanged"));this.gJa.dea(Object(R.a)(this,this.onConnected,"onConnected"));this.gf=c;this.hJe=f}onConnected(a,b){a=Object(gb.a)(745,b.node);this.ldh.a4h(a)}ph(a,
b){a=b.property;b=Object(gb.a)(745,b.node);a===rb.a.Wv?this.ldh.a4h(b):a===rb.a.bBa||a===rb.a.Ria||a===rb.a.mC?b.w_=null:!this.hJe||a!==yb.a.VXa&&a!==yb.a.isResizable&&a!==yb.a.SM||b.sc(this.gf).dif()}dispose(){this.gJa.tn(Object(R.a)(this,this.ph,"onPropertyChanged"));this.gJa.iia(Object(R.a)(this,this.onConnected,"onConnected"))}}Object(m.a)(MF,"TableNodeBehavior",null,[106]);var NF=d(188);class Zw{constructor(a,b,c,f,l,u,I,T){this.k2=this.mS=this.Do=this.LJa=this.h2=this.Ckd=this.$Ia=null;this.gib=
this.lhd=0;this.d1g=this.zmc=this.Nd=this.Jy=null;this.EP=a;this.ia=c;this.Gr=f;this.Nt=l;this.iE=u;this.nba=b;this.Pq=I;this.wq=T}jM(){this.k2=this.mS=this.Do=this.h2=this.LJa=null;null!==this.Pq&&this.Pq.Uza()}Ew(a){if(!a||a.xB===Sys.UI.MouseButton.rightButton||this.EP.t1)return!1;this.Nd=(this.Jy=Object(gb.a)(1509,this.iE.aK(a.Ec)))?this.Jy.ol:null;if(!this.Nd)return!1;this.$Ia=this.Jy.eTi;if(!this.$Ia)return!1;this.mS=this.$Ia.vwg(a.Ec);if(!this.mS)return!1;this.wq&&this.ia.nb(G.a.kma,2);return!0}Qv(a){if(!a||
!this.Ew(a))return!1;this.Ckd=this.Jy=this.iE.aK(this.$Ia.va);if(!this.Jy)return ya.a.J(508360534,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.nb(M.a.U$a,2);this.$Ia.aF(!0);this.Nd.aF(!0);null!==this.Pq&&this.Pq.tAa(sj.a.ESb);this.k2=this.Ckd.wbc();this.lhd=this.Gr.Tm(pd.a.an(this.k2.ga(0),this.k2.ga(1)));this.gib=this.Gr.Tm(pd.a.an(this.k2.ga(0),this.k2.ga(3)));this.LJa=this.C_f(a.clientPoint);this.h2=new pd.a(0,0);this.Do=new Mi.a;this.d1g=new pd.a(this.Nd.x+
this.lhd,this.Nd.y+this.gib);return!0}Px(a){if(!a)return!1;a=this.C_f(a.clientPoint);var b=pd.a.nT(a,this.LJa);this.h2=pd.a.add(this.h2,b);b=Ll.x3d(this.mS,this.k2,this.h2,!1,!1);this.Do=Object.assign(new Mi.a,{bottom:this.Gr.Tm(b.bottom),left:this.Gr.Tm(b.left),right:this.Gr.Tm(b.right),top:this.Gr.Tm(b.top)});const {k6h:c,p6h:f}=this.gUf();b=new NF.a;b.aea(c,f);b.UE(this.Do.left,this.Do.top);this.$Ia.Kr(b);this.LJa=a;return!0}Uo(a){let b=null;a&&(b=this.nba.lj("UserAction","PPTTableResize"),ya.a.J(508360533,
822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",this.Jy.eb.ra(yb.a.nLb,""),Jd.TableReader.nu(this.Jy.eb))));this.$Ia.QA(!1);const {k6h:c,p6h:f}=this.gUf();this.Jy.PNh(c,f);this.ddf();const l=new pg.GraphTransaction(15);l.rd(this.Jy.eb);var u=this.Jy.Vd.Xd;this.Nt.Q4e(Object(gb.a)(WB.TableNode,this.Jy.eb),c,f,this.Ckd,u);if(Zw.tHa(this.mS)||Zw.tHa(this.mS,!0)){const I=this.Jy.ol.shapeNode,T=u.Cf(this.Nd.x,0);u=u.Cf(this.Nd.y,1);I.zz=T;I.Az=u}this.Nd.QA(!1);l.dispose();this.jM();
ad.App.Ob.Gf();b&&b.stop();a&&ya.a.J(508360532,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",this.Jy.eb.ra(yb.a.nLb,""),Jd.TableReader.nu(this.Jy.eb)))}ddf(){var a=Zw.tHa(this.mS),b=Zw.tHa(this.mS,!0);if(a||b){b=this.Ckd.wbc();a=this.Gr.Tm(b.lc-b.oc);b=this.Gr.Tm(b.jc-b.pc);const c=this.d1g;c._x+=this.Do.right;c._y+=this.Do.bottom;this.Nd.setPosition(c.x-a,c.y-b,!0)}}rv(){this.h2&&(this.$Ia.QA(!0),this.$Ia.Kr(null),this.Nd.QA(!0),this.jM())}gUf(){return{k6h:this.lhd?1+(this.Do.right-
this.Do.left)/this.lhd:1,p6h:this.gib?1+(this.Do.bottom-this.Do.top)/this.gib:1}}C_f(a){a=pd.a.tVa(a);var b=this.mS;this.mS.MDb()||(b=b.sBb());const c=this.k2.el(b);b=this.k2.el(b.Dbb());return a=new pd.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static tHa(a,b){b=void 0===b?!1:b;return a.equals(Ge.a.Pv)?!0:b?a.equals(Ge.a.north)||a.equals(Ge.a.IF):a.equals(Ge.a.west)||a.equals(Ge.a.hJ)}}Object(m.a)(Zw,"TableResizeDragAdapter",null,[363]);class OF{constructor(a,
b){this.w2=a;this.FKb=b;this.Oi=Array(4);for(a=0;4>a;a++)this.Oi[a]=Array(4);this.oQe=Array(16)}kge(a,b,c,f){const {PTf:l,NTf:u}=kN(a,b,c,f,this.w2);this.Oi[l][u]||(this.Oi[l][u]=this.FKb.fGl(this.w2,a,b,c,f));c=this.Oi[l][u].clone();if(a=this.TRj(a,b))for(const I of a.ZA())c.Qa(I)||c.He(I,a.$h(I));return c}clear(){for(let a=0;4>a;a++)this.Oi[a]=Array(4);this.oQe=Array(16)}TRj(a,b){var c=a===this.w2.jW-1;const f=b===this.w2.Sta-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.oQe[l])||(this.oQe[l]=
c=this.FKb.BGl(this.w2,a,b));return c}}Object(m.a)(OF,"TableStyleCache",null,[1695]);class lN{constructor(a){this.l_a=a}fGl(a,b,c,f,l){const u=a.jW;var I=a.Sta,T=a.tableLook;const ja=a.tableStyle;a=a.Ld;const ua=new qq.a,Ra=0<(T&32),eb=0<(T&128),Bb=!b&&Ra,Ub=!c&&eb;f=b===u-f&&0<(T&64);l=c===I-l&&0<(T&256);I=!(T&512)&&!Bb&&!f;T=!(T&1024)&&!Ub&&!l;this.CGl(ja.wholeTblField,ua);I&&this.bAa((Ra?1!==(b&1):b&1)?ja.band2HField:ja.band1HField,a,ua);T&&this.bAa((eb?1!==(c&1):c&1)?ja.band2VField:ja.band1VField,
a,ua);l&&this.bAa(ja.lastColField,a,ua);Ub&&this.bAa(ja.firstColField,a,ua);f&&(this.bAa(ja.lastRowField,a,ua),l&&this.bAa(ja.seCellField,a,ua),Ub&&this.bAa(ja.swCellField,a,ua));Bb&&(this.bAa(ja.firstRowField,a,ua),l&&this.bAa(ja.neCellField,a,ua),Ub&&this.bAa(ja.nwCellField,a,ua));return ua}BGl(a,b,c){var f=a.jW;const l=a.Sta;var u=a.tableStyle;a=a.Ld;const I=new qq.a;if(u&&0<=b&&b<f&&0<=c&&c<l){const T=!c;f=b===f-1;c=c===l-1;(u=u.wholeTblField)&&u.tcStyleField&&(u=u.tcStyleField.tcBdrField)&&(this.I2a(7,
b?u.insideHField:u.topField,a,I),this.I2a(0,f?u.bottomField:u.insideHField,a,I),this.I2a(5,T?u.leftField:u.insideVField,a,I),this.I2a(6,c?u.rightField:u.insideVField,a,I))}return I}JGh(a,b,c){const f=new qq.a;this.HGh(a,c,b,f);return f}CGl(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.He(yb.a.cellShading,a.tcStyleField.fillField)}bAa(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.He(yb.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.I2a(7,a.topField,b,c),
this.I2a(0,a.bottomField,b,c),this.I2a(5,a.leftField,b,c),this.I2a(6,a.rightField,b,c))}I2a(a,b,c,f){b&&b.itemField&&this.HGh(a,b.itemField,c,f)}HGh(a,b,c,f){const {ZSa:l,c$a:u}=Oq.fWa(a);b.wFieldSpecified&&f.He(l,Re.a.fbe(b.wField));if(b.solidFillField)if(this.l_a)f.He(u,b.solidFillField);else{if(a=Ze.Box4ColorHelper.Rmb(b.solidFillField,c))a=Ze.Box4ColorHelper.Xia(a),f.He(u,a)}else b.noFillField&&(this.l_a&&md.a("TableBordersLocalRenderingFix")?(a=Ze.Box4ColorHelper.uT({Color:"##T,0,0,0"}),f.He(u,
a),f.He(l,0)):f.He(u,Vb.a.kUa))}}Object(m.a)(lN,"TableStyleResolver",null,[912]);var mN=d(382),XB=d(189);class vz{constructor(a,b,c,f){this.Kya=!1;this.GC=this.So=this.wb=this.UNg=this.jfh=null;this.gE=[];this.rl=this.iB=!1;this.t2=null;this.Gp=this.phb=!1;this.Fa=b;this.A1g=a;this.hd=void 0===f?null:f;this.AV=(this.zed=c)?10:6;this.XNe=c?2:jf.a.WF}get visible(){return this.Kya}set visible(a){this.Kya!==a&&(this.Kya=a,this.iNh())}get va(){return this.wb.viewport.va}sIi(a,b,c){this.jfh=a;this.UNg=
c;this.Cn();this.hd.xb(la.a.click,this.va,Object(R.a)(this,this.Ojh,"notifySelectShapeByClick"));b.appendChild(this.wb.viewport);this.jfh.pL(this.va,!0);this.phb=!0;this.setZIndex(2+mz.a.hja+1)}I0h(){this.phb&&this.wb&&this.hd.Hb(la.a.click,this.va,Object(R.a)(this,this.Ojh,"notifySelectShapeByClick"));this.phb=!1}setZIndex(a){this.phb&&this.wb.xE(a)}Cn(){this.wb||(this.wb=new XB.a,this.So=new Fm.a,this.So.UF(Dj.a.none),this.So.Vv(jf.a.m3),this.So.vs(jf.a.WF),this.wb.Dm(sj.a.LB),this.wb.appendChild(this.So),
this.GC=new Yo.a,this.V6b(this.GC),this.wb.appendChild(this.GC),this.wb.ee(!1),this.wb.viewport.va.setAttribute(Dj.a.fNb,Dj.a.none))}Gm(){if(this.phb){var a=this.ELj(this.UNg);this.iB?(this.t2&&this.t2.Zm(a),this.So.yu(a.points)):(a=a.points,this.So.yu(a),a=new ej.a(a[0],a[1],a[2],a[3]));this.XZ(a);this.wb.Gm()}}V6b(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new Yo.a;l.va.id=b;if(E.a.dOa){var c=new mN.a;c.va.id=b;c.va.setAttribute("class",tm.a.uCd);c.setVisibility(!1);c.setPosition(-10,
-10);c.Mh(20,20);l.appendChild(c)}c=new mN.a;c.va.id=b;c.va.setAttribute("class",tm.a.uCd);b=this.AV/2*-1;c.setPosition(b,b);c.Mh(this.AV,this.AV);this.zed&&c.lNh(this.AV/2,this.AV/2);c.UF("white");c.Vv(jf.a.m3);c.vs(this.XNe);c.HNh();l.appendChild(c);l.xk(1);this.gE[f]=l;a.appendChild(l)}}XZ(a){for(let b=0;8>b;++b){const c=this.gE[b];c.Dm(vz.Mwc[b]);this.wNa(c,a.el(new Ge.a(b)))}}ELj(a){return new ej.a(new pd.a(0,0),new pd.a(a.offsetWidth,0),new pd.a(a.offsetWidth,a.offsetHeight),new pd.a(0,a.offsetHeight))}TF(a){this.Gp||
((this.iB=a)?(this.So.UF(jf.a.m7f),this.So.Vv(jf.a.m3),this.So.vs(jf.a.WF),this.GC.ee(!1),this.A1g.endEditing(!0,14)):(this.So.UF(Dj.a.none),this.So.Vv(jf.a.m3),this.So.vs(jf.a.WF),this.GC.ee(!0),this.Fa.Df(xc.a.Ag),this.A1g.pT()))}dispose(){this.rl||(this.I0h(),this.So=this.wb=null,Array.clear(this.gE),this.GC=null,this.phb=!1,this.rl=!0)}vwg(a){if(!this.phb)return null;for(let b=0;8>b;++b)if(this.gE[b].va.id===a.id)return new Ge.a(b);return null}wNa(a,b){a.setPosition(b.x,b.y)}Ojh(a){return this.vwg(a.Ec)?
!0:!1}aF(a){this.TF(!0,a)}QA(){this.TF(!1)}Kr(a){this.t2&&this.t2.clear();this.t2=a;this.Gm()}Ry(a){this.Gp=a;this.iNh()}iNh(){this.wb&&this.wb.ee(!this.Gp&&this.Kya)}static H6b(a){return new vz(a,Tb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,A.AFrameworkApplication.za.Mz)}}vz.Mwc=[sj.a.lcf,sj.a.kcf,sj.a.jcf,sj.a.icf,sj.a.mcf,sj.a.ncf,sj.a.ocf,sj.a.pcf];Object(m.a)(vz,"DraggablePandoraChromeView",
null,[1696]);class nN{}Object(m.a)(nN,"TableStyleCategoryInfo",null,[]);class lg{static kij(){if(lg.Ah)return lg.Ah;lg.Ah=new Cc.a;lg.Ah.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);lg.Ah.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));lg.Ah.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));lg.Ah.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,3));lg.Ah.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,4));lg.Ah.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));lg.Ah.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));lg.Ah.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);lg.Ah.$("Themed Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));lg.Ah.$("Themed Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));lg.Ah.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));lg.Ah.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));lg.Ah.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,5));lg.Ah.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,6));lg.Ah.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));lg.Ah.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));lg.Ah.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,2));lg.Ah.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,3));lg.Ah.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));lg.Ah.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));lg.Ah.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));lg.Ah.$("Light Style 2",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));lg.Ah.$("Light Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));lg.Ah.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));lg.Ah.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));lg.Ah.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,4));lg.Ah.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,5));lg.Ah.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));lg.Ah.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));lg.Ah.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,1));lg.Ah.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,2));lg.Ah.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));lg.Ah.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));lg.Ah.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));lg.Ah.$("Light Style 3 - Accent 6",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));lg.Ah.$("Medium Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));lg.Ah.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));lg.Ah.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));lg.Ah.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,3));lg.Ah.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,4));lg.Ah.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));lg.Ah.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));lg.Ah.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,
2));lg.Ah.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,1));lg.Ah.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));lg.Ah.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));lg.Ah.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));lg.Ah.$("Medium Style 2 - Accent 5",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));lg.Ah.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));lg.Ah.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));lg.Ah.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));lg.Ah.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,3,2));lg.Ah.$("Medium Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));lg.Ah.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));lg.Ah.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));lg.Ah.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
3,6));lg.Ah.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,4));lg.Ah.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));lg.Ah.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));lg.Ah.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));lg.Ah.$("Medium Style 4 - Accent 4",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,4));lg.Ah.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));lg.Ah.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));lg.Ah.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));lg.Ah.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,1));lg.Ah.$("Dark Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));lg.Ah.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));lg.Ah.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));lg.Ah.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,
1,5));lg.Ah.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,6));lg.Ah.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));lg.Ah.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));lg.Ah.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,
2,2,3));lg.Ah.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,4,5));return lg.Ah}static Dpg(a){const b=lg.kij();return b.Ib(a)?b.ga(a):a}}lg.Ah=null;Object(m.a)(lg,"TableStyleNameReader",null,[]);class oN{constructor(a){this.tRg=!1;this.uGb=[];this.eIe=new Md.a(0);this.ACe=[];this.O$g=a}zbe(){this.tRg||(this.tRg=this.Mgl())}Mgl(){const a=this.O$g.instance?this.O$g.instance.O8l:null;if(a&&a.tblStyleCategoriesField){let b=
0;this.uGb=[];this.eIe=new Md.a(0);this.ACe=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.ACe,Object.assign(new nN,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const u=f.tblStylesField[l],I=new W.DictionaryPropertySet,T=new HF(u,f.idField,l);I.He(yb.a.tableStyle,T);this.uGb.push(I);this.eIe.$(u.styleIdField.toLowerCase(),b++)}}}return!0}return!1}AZc(){return this.uGb}VBb(a){return 0<=
a&&a<this.uGb.length?this.uGb[a]:null}TNj(a,b){let c=null;for(const f of this.ACe)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.VBb(a):null}cOj(a){return this.rbc(a).yZ.styleIdField}dOj(a){return(a=this.rbc(a).yZ.styleNameField)?md.a("TableStyleNameLocalization")?lg.Dpg(a):a:""}WNj(a){return this.rbc(a).GNg}rbc(a){return a.$h(yb.a.tableStyle)}Cpg(a){return(a=this.ZOj(a))?a.$h(yb.a.tableStyle):null}ZOj(a){this.zbe();return this.uGb[this.eIe.ga(a.toLowerCase())]}}Object(m.a)(oN,"TableStyleGalleryManager",
null,[913]);class pN{constructor(a,b,c,f,l){this.aN=0;f||(f=Object.assign(new Ur.a,{Ae:0,rg:c.hQ,qe:0,hg:c.NS}));this.JCe=a;this.USk=b;this.gpa=c;this.yF=f;this.cB=new Ur.a;this.WP=this.aN=-1;this.ldd=l}get $Eg(){return-1===this.WP||-1===this.aN}moveNext(){this.$Eg&&(this.WP=this.yF.Ae,this.cB.hg=this.yF.qe);for(;;){this.aN=this.cB.hg;if(this.aN>=this.yF.hg&&(this.aN=this.yF.qe,++this.WP>=this.yF.rg))return this.reset(),!1;this.cB=this.JCe.UJ(this.gpa,this.WP,this.aN);if(this.WP===this.yF.Ae||this.WP===
this.cB.Ae)if(!this.ldd||this.ldd.pYd(this))return!0}}SYk(){this.$Eg&&(this.aN=this.yF.qe,this.cB.rg=this.yF.Ae);for(;;){this.WP=this.cB.rg;if(this.WP>=this.yF.rg&&(this.WP=this.yF.Ae,++this.aN>=this.yF.hg)){this.reset();break}this.cB=this.JCe.UJ(this.gpa,this.WP,this.aN);if(this.aN===this.yF.qe||this.aN===this.cB.qe)if(!this.ldd||this.ldd.pYd(this))break}}moveTo(a,b){this.cB=this.JCe.UJ(this.gpa,a,b);if(!this.cB.Qkj(this.yF))return this.reset(),!1;this.WP=Math.min(Math.max(a,this.yF.Ae),this.yF.rg-
1);this.aN=Math.min(Math.max(b,this.yF.qe),this.yF.hg-1);return!0}reset(){this.WP=this.aN=-1}Q$b(){return this.USk.tf(this.cB.Ae,this.cB.qe)}}Object(m.a)(pN,"CellIterator",null,[1723]);class qN{constructor(a){this.Er=a}KFa(a,b,c,f){return new pN(this.Er,a,b,c,void 0===f?null:f)}}Object(m.a)(qN,"CellIteratorFactory",null,[907]);class PF{constructor(a,b,c){this.Er=b;this.gpa=c;this.cE=this.Er.pXc(this.gpa,a.yF);this.gaa=Array(this.cE.NS*(this.cE.hQ+1));this.WP=this.cE.Ae;this.mgb=this.cE.qe;this.zGb=
this.cE.qe-1;this.Fr=0;this.Ope(a)}Ope(a){const b=a.yF;for(;a.moveNext();){const f=a.cB;for(let l=f.qe;l<f.hg;l++){var c=this.jGa(f.Ae,l);this.gaa[c]=0!==this.gaa[c]?2:l<b.qe&&f.Ae>b.Ae?16:l>=b.hg&&f.Ae>b.Ae?64:1;c=this.jGa(f.rg,l);this.gaa[c]=0!==this.gaa[c]?2:l<b.qe&&f.rg<b.rg?16:l>=b.hg&&f.rg<b.rg?64:4}}}jGa(a,b){return this.cE.NS*(a-this.cE.Ae)+(b-this.cE.qe)}moveNext(){this.mgb=this.zGb;do{this.mgb++;this.mgb>=this.cE.hg&&(this.WP++,this.mgb=this.cE.qe);if(this.WP>this.cE.rg)return!1;this.Fr=
this.gaa[this.jGa(this.WP,this.mgb)]}while(0===this.Fr);for(this.zGb=this.mgb;this.zGb+1<this.cE.hg&&this.gaa[this.jGa(this.WP,this.zGb+1)]===this.Fr;)this.zGb++;return!0}Iwj(){return this.zGb+1}Zbb(){return this.Fr}static Bue(a){return!!(a&87)}}Object(m.a)(PF,"HorizontalTableBorderIterator",null,[1656,980]);class rN{constructor(a){this.Er=a}N3i(a,b){return new PF(a,this.Er,b)}}Object(m.a)(rN,"HorizontalTableBorderIteratorFactory",null,[908]);var YB;(function(a){a[a.none=0]="none";a[a.firstLayout=
1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=
11]="slideInvalidateRenderSize"})(YB||(YB={}));Object(m.b)("LayoutInvalidateTrigger",YB);class sN{constructor(){this.qla=this.i2d=this.aBc=this.E6d=0}get rowSpan(){return this.i2d-this.aBc}toString(){return String.format("C[{0}][{1}]",this.aBc,this.qla)}}Object(m.a)(sN,"CellInfo",null,[]);class Vr{constructor(){this.l6c=!1;this.$c=this.FVf=this.Ys=null;this.Bfb=this.Ayc=!1;this.wCd=null;this.Rgh=0;this.tableNode=this.Gze=this.PAa=null;this.Qce=!1}}Object(m.a)(Vr,"LayoutContext",null,[]);class tN{constructor(){this.MSh=
this.bGd=0}}Object(m.a)(tN,"LayoutTelemtry",null,[]);class QF{constructor(){this.offset=this.Qpc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",this.index,this.Qpc,this.offset)}}Object(m.a)(QF,"RowSeamInfo",null,[]);class ji{constructor(a,b,c,f,l,u,I){this.fE=null;this.NHb=[];this.vKa=[];this.cZ=0;this.rl=this.ggd=!1;this.uib=null;this.bfd=!1;this.kgd=0;this.ff=null;this.uA=a;this.zb=f;this.Hl=u;this.Ub=c;this.wZ=I;this.Wdc(1)}Ack(a,b){if(!this.ggd&&!this.bfd)try{2!==this.cZ&&
(1===this.cZ?this.NHb[0]!==a&&this.Wdc(b):(this.NHb[this.NHb.length]=a,this.cZ=1,this.kgd=b))}catch(c){this.Wdc(0),ya.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",c.toString())}}Wdc(a){this.bfd||2===this.cZ||this.ggd||(this.cZ=2,this.NHb=[],this.kgd=a)}Hne(){return 0!==this.cZ&&!this.ggd}get P5c(){return this.cZ}N2h(a){this.Hne()&&(a=Object.assign(new Vr,{tableNode:a}),this.layout(a))}Rim(a,b){this.Hne()?this.uib||(this.uib=new ne.a(3,1,0,Object(R.a)(this,this.Afl,"performLayout"),
90,"9"),this.uib.gu=Object.assign(new Vr,{tableNode:a,l6c:!0,Gze:b}),this.zb.Jb(this.uib)):b&&b(!1)}Afl(a){this.layout(Object(gb.a)(Vr,a.gu))}layout(a){this.bfd=!0;const b=new uf.a(null,Object(R.a)(this,this.E$j,"initializeLayoutState"),a);b.Bj=!a.l6c;b.Lh()}E$j(a,b){b=Object(gb.a)(Vr,b);try{this.Hhj();b.$c=this.ff;b.Ys=new tN;this.Wmm();if(!this.Hne())return a.sh(Object(R.a)(this,this.hBa,"tearDownLayout")),!0;this.cZ=0;if(!b.tableNode.isConnected)return a.sh(Object(R.a)(this,this.hBa,"tearDownLayout")),
!0;const c=Object(gb.a)(1509,b.tableNode.sc(this.uA));if(!c)return a.sh(Object(R.a)(this,this.hBa,"tearDownLayout")),!0;b.wCd=c;b.$c.Wa(ji.sGi,b.l6c.toString());b.tableNode.rq()?(b.$c.Wa(ji.xIg,YB[this.kgd]),a.sh(Object(R.a)(this,this.mkl,"prepareTableMetrics"))):(b.$c.Wa(ji.xIg,"tableComplexityChange"),b.Ayc=!0,b.Bfb=!0,a.sh(Object(R.a)(this,this.hBa,"tearDownLayout")))}catch(c){b.$c.Wa(ji.Ygc,c.message),a.sh(Object(R.a)(this,this.hBa,"tearDownLayout"))}return!0}mkl(a,b){b=Object(gb.a)(Vr,b);try{b.PAa=
new Date,this.wZ.lwh(b.tableNode,this.uA),b.$c.Wa(ji.hkl,(+new Date-+b.PAa).toString()),b.$c.Wa(ji.ZXk,this.wZ.$gk.toString()),a.sh(Object(R.a)(this,this.Pvk,"layoutBaselineTable"))}catch(c){b.$c.Wa(ji.Ygc,c.message),a.sh(Object(R.a)(this,this.hBa,"tearDownLayout"))}return!0}Pvk(a,b){b=Object(gb.a)(Vr,b);try{b.PAa=new Date;b.Qce=!0;b.Rgh=ji.gXk;this.fE=[];this.fE[this.fE.length]=Object.assign(new QF,{index:0,Qpc:0,offset:0});const c=new ui.a(this.uA);c.set(b.tableNode);if(!c.Gb(1))throw Error.invalidOperation(ji.obg);
const f=b.tableNode;let l=c.currentNode,u=l,I=0,T=0,ja=0;for(;l;){15===l.type&&(u=l,ja=I=0,l=c.Gb(1));const ua=l;if(!ua)throw ya.a.J(512495690,808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===ua.rowSpan){const Ra=Object(gb.a)(Ut,l.sc(this.uA));I=Math.max(I,this.wZ.R$b(f,Ra.vla,T,ja))}l=c.sk(1);ja++;if(!l){const Ra=Object.assign(new QF,{index:this.fE.length});let eb=u.ra(yb.a.wv,0);eb=Math.max(eb,this.Hl.TQc(u));let Bb=
b.wCd.Vd.Xd.Ve(eb,1);Bb=Math.max(Bb,I);Ra.offset=Bb+this.fE[Ra.index-1].offset;Ra.Qpc=Bb;this.fE[this.fE.length]=Ra;l=c.Qf(1);T++}}a.sh(Object(R.a)(this,this.Uvk,"layoutRowSeams"));b.$c.Wa(ji.Svk,(+new Date-+b.PAa).toString())}catch(c){b.$c.Wa(ji.Ygc,c.message),b.Ayc=!0,a.sh(Object(R.a)(this,this.hBa,"tearDownLayout"))}return!0}Uvk(a,b){b=Object(gb.a)(Vr,b);try{if(1===this.fE.length)throw Error.create(ji.Elj);let c=b.FVf;if(!c){b.PAa=new Date;c=new ui.a(this.uA);c.set(b.tableNode);if(!c.Gb(1))throw Error.invalidOperation(ji.obg);
b.FVf=c}const f=b.tableNode;let l=c.currentNode,u=0,I=0,T=0;for(;l&&u<b.Rgh;){15===l.type&&(l=c.Gb(1),I=0);const ja=l;if(!ja)throw ya.a.J(512495687,808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");u++;b.Ys.bGd++;1===ja.rowSpan||Bj.OutlineReader.isEmpty(c)?b.Ys.MSh++:this.Wvk(this.f2i(f,ja,T,I),b.$c);l=c.sk(1);I++;l||(l=c.Qf(1),T++)}l||(this.M7l(),a.sh(Object(R.a)(this,this.rpj,"fixupTableMinRowHeight")),b.$c.Wa(ji.Vvk,(+new Date-
+b.PAa).toString()))}catch(c){b.$c.Wa(ji.Ygc,c.message),b.Ayc=!0,a.sh(Object(R.a)(this,this.hBa,"tearDownLayout"))}return!0}rpj(a,b){b=Object(gb.a)(Vr,b);try{const l=b.wCd;b.PAa=new Date;const u=[];var c=new ui.a(this.uA);c.set(b.tableNode);for(var f=c.Gb(1);f;)u[u.length]=c.Ur,f=c.sk(1);if(this.vKa.length===u.length){c=[];for(f=0;f<u.length;++f)c[f]=0,1<Math.abs(this.vKa[f]-u[f].htmlElement.offsetHeight)&&(c[f]=this.vKa[f]);for(f=0;f<c.length;++f)0<c[f]&&u[f].xRb(c[f]*l.Fje())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",
this.vKa.length,u.length));a.sh(Object(R.a)(this,this.hBa,"tearDownLayout"));b.$c.Wa(ji.npj,(+new Date-+b.PAa).toString());b.Bfb=!0}catch(l){b.$c.Wa(ji.Ygc,l.message),b.Ayc=!0,a.sh(Object(R.a)(this,this.hBa,"tearDownLayout"))}return!0}hBa(a,b){a=Object(gb.a)(Vr,b);a.PAa=new Date;a.Ayc?(this.XGl(a.$c,a.tableNode,a.wCd),a.Qce=!0):a.$c&&(a.$c.Wa(ji.Yvk,a.Ys.bGd.toString()),a.$c.Wa(ji.Xvk,a.Ys.MSh.toString()));this.uib&&!a.l6c&&this.zb.Vg(this.uib);this.bfd=!1;this.uib=null;this.kgd=0;a.$c&&(a.$c.Wa(ji.Bfb,
a.Bfb.toString()),!a.Bfb&&a.$c&&a.$c.Wa(ji.tableLayout,this.wZ.Gae(a.tableNode)),a.$c.Wa(ji.k9l,(+new Date-+a.PAa).toString()),a.$c.finish());a.Bfb||(this.ggd=!0);this.fE=null;this.NHb=[];this.ff=null;this.wZ.reset();a.Gze&&a.Gze(a.Qce);return!1}XGl(a,b,c){if(b.isConnected)try{const f=new ui.a(this.uA);f.set(b);let l=f.Gb(1);for(;l;){const u=Object(gb.a)(Yw,f.gUa);if(!u)throw Error.argument("tableRowViewElement");const I=l.ra(yb.a.wv,0);let T=c.Vd.Xd.Ve(I,1);const ja=c.Fje();T*=ja;u.xRb(T);l=f.sk(1)}}catch(f){a&&
a.Wa(ji.WGl,f.message)}}Wvk(a,b){if(!a)throw Error.create(ji.Dlj);var c=this.fE[a.aBc];const f=this.fE[a.i2d];c=Math.max(this.BFj(c,f),a.E6d)-(f.offset-c.offset);if(!(0>=c)&&(this.iCi(f.index,c),f.offset<=this.fE[f.index-1].offset)){b.Wa(ji.LQi,a.toString());for(a=0;a<=f.index;++a)b.Wa(ji.aLl,this.fE[a].toString());throw Error.create(ji.Flj);}}M7l(){if(this.fE){this.vKa=[];for(let a=1;a<this.fE.length;++a)this.vKa[this.vKa.length]=this.fE[a].offset-this.fE[a-1].offset}else this.vKa=null}iCi(a,b){if(b)for(var c=
a,f=0;c<this.fE.length;){b=c===a?b:b+this.fE[c].Qpc-this.fE[c].offset+f;if(0>=b)break;f=this.fE[c].offset;this.fE[c].offset+=b;c++}}BFj(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.fE[a+1].Qpc,a++;return c}f2i(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(gb.a)(Ut,b.sc(this.uA)),u=this.Ub.Pc(b);u.uc(14);a=Object.assign(new sN,{E6d:this.wZ.R$b(a,l.vla,c,f),aBc:Sk.c(u),qla:f});a.i2d=a.aBc+b.rowSpan;return a}dispose(){this.rl||(this.NHb=this.fE=this.vKa=null,
this.cZ=0,this.rl=!0)}Wmm(){if(this.rl)throw Error.invalidOperation("table layout service is already disposed");}Hhj(){this.ff||(this.ff=$c.a.Zj("TableLayout"))}get Na(){return this.uA}}ji.gXk=25;ji.Ygc="FailureReason";ji.WGl="RestoreFailureReason";ji.tableLayout="Layout";ji.aLl="SI";ji.LQi="CI";ji.sGi="FAsync";ji.Yvk="CellVisited";ji.Xvk="CellSkipped";ji.Bfb="Succeeded";ji.Svk="LETD";ji.Vvk="LRST";ji.npj="FMTR";ji.k9l="TDLD";ji.hkl="PM";ji.xIg="Trigger";ji.ZXk="MC";ji.Dlj="CellDisconnected";ji.Elj=
"ChildOfTableNotLoaded";ji.Flj="SeamPositionInvariant";ji.obg="NoRowViewElement";Object(m.a)(ji,"PPTTableLayoutService",null,[1657,106]);class uN{constructor(a,b,c,f,l){this.Ub=a;this.zb=b;this.YSk=c;this.Hl=f;this.wZ=l}create(a,b){return new ji(a,b,this.Ub,this.zb,this.YSk,this.Hl,this.wZ)}}Object(m.a)(uN,"PPTTableLayoutServiceFactory",null,[915]);class vN{constructor(a,b,c,f,l,u,I,T,ja){this.RPk=a;this.Fp=b;this.Ub=c;this.t0a=f;this.pdh=l;this.tjb=u;this.Jmc=I;this.Qt=T;this.wed=!0;this.SIe=ja;
this.Dxa=new Cc.a;this.Fp.WD&&!this.Fp.Fk&&(this.wed=!1);this.wed&&(this.t0a.UZd(Object(R.a)(this,this.ulh,"onBeforeTableViewElementDisconnected")),this.t0a.dea(Object(R.a)(this,this.uqh,"onTableNodeConnected")),this.t0a.Ak(Object(R.a)(this,this.wqh,"onTableNodePropertyChanged")),this.t0a.B4(Object(R.a)(this,this.vqh,"onTableNodeDisconnected")),this.pdh.Ak(Object(R.a)(this,this.yqh,"onTableRowNodePropertyChanged")),this.tjb.Ak(Object(R.a)(this,this.kqd,"onTableCellNodePropertyChanged")),this.tjb.VE(Object(R.a)(this,
this.tqh,"onTableCellNodeChildTopoChanged")),this.Jmc.Ak(Object(R.a)(this,this.voh,"onParagraphNodePropertyChanged")),this.Qt.QAi(Object(R.a)(this,this.Rph,"onSlideInvalidateRenderSize")))}T1c(a,b){if(!this.wed)return null;var c=a.id.toString();this.Dxa.Ib(c)||this.Dxa.$(c,new yu.a);c=this.Dxa.ga(c);var f=a.rq();f=this.SIe?f&&Jd.TableReader.SZf(Object(gb.a)(mb.GraphIterator,this.Ub.Pc(a))):f;if(c.Ib(b))return b=c.ga(b),f||0!==b.P5c||(this.bDh(a),b=null),b;if(f)c.$(b,this.RPk.create(b,a.id));else return null;
return c.ga(b)}oDb(a,b,c){a.rq()?this.Wyg(a.id.toString(),b,c):10===c&&this.Wyg(a.id.toString(),b,c)}Wyg(a,b,c){if(this.Dxa.Ib(a))for(const f of this.Dxa.ga(a).values)b?f.Ack(b,c):f.Wdc(c)}tte(a,b,c){a.isConnected&&(a=this.Ub.Pc(a),a.uc(14)&&this.oDb(a.ay(14),b,c))}sck(a){a.isConnected&&(a=this.Ub.Pc(a),a.uc(14)&&this.oDb(a.ay(14),a.ay(16),2))}ulh(a,b){b.ft.Tc.Wp&&this.oDb(b.ft.eb,null,9)}uqh(a,b){this.oDb(b.node,null,8);a=Object(gb.a)(WB.TableNode,b.node);a=!!a&&a.rq();ya.a.J(508692320,808,50,"Render table, isComplexTable: {0}",
a)}vqh(a,b){this.bDh(b.node)}bDh(a){a=a.id.toString();if(this.Dxa.Ib(a)){const b=this.Dxa.ga(a);for(const c of b.values)c&&c.dispose();this.Dxa.remove(a)}}wqh(a,b){a=b.property;b.node.isConnected&&(a===rb.a.Wv||a===rb.a.Ria||a===rb.a.mC||a===yb.a.ipb||a===yb.a.cid||a===yb.a.cBa||a===yb.a.Yzc?this.oDb(b.node,null,7):a===yb.a.complexTable&&this.oDb(b.node,null,10))}yqh(a,b){a=b.property;b.node.isConnected&&a===yb.a.wv&&this.tte(b.node,null,4)}kqd(a,b){a=b.property;!b.node.isConnected||a!==yb.a.rowSpan&&
a!==yb.a.colSpan||this.tte(b.node,null,5)}tqh(a,b){b.node.isConnected&&1===b.vU&&this.tte(b.node,b.node,3)}voh(a,b){a=Object(gb.a)(5,b.node);b=b.property;a&&a.isConnected&&a.Qa(yb.a.cellId)&&!a.Utc&&(b===rb.a.np||b===rb.a.qpb)&&this.sck(a)}Rph(){for(const a of this.Dxa.keys)for(const b of this.Dxa.ga(a).values)b.Wdc(11)}dispose(){this.wed&&(this.t0a.k3e(Object(R.a)(this,this.ulh,"onBeforeTableViewElementDisconnected")),this.t0a.iia(Object(R.a)(this,this.uqh,"onTableNodeConnected")),this.t0a.tn(Object(R.a)(this,
this.wqh,"onTableNodePropertyChanged")),this.t0a.Wza(Object(R.a)(this,this.vqh,"onTableNodeDisconnected")),this.pdh.tn(Object(R.a)(this,this.yqh,"onTableRowNodePropertyChanged")),this.tjb.tn(Object(R.a)(this,this.kqd,"onTableCellNodePropertyChanged")),this.tjb.RN(Object(R.a)(this,this.tqh,"onTableCellNodeChildTopoChanged")),this.Jmc.tn(Object(R.a)(this,this.voh,"onParagraphNodePropertyChanged")),this.Qt.FCl(Object(R.a)(this,this.Rph,"onSlideInvalidateRenderSize")))}}Object(m.a)(vN,"PPTTableLayoutServiceManager",
null,[916,106]);class RF{constructor(a,b,c){this.Er=b;this.gpa=c;this.cE=this.Er.pXc(this.gpa,a.yF);this.gaa=Array(this.cE.hQ*(this.cE.NS+1));this.aN=this.cE.qe;this.Vib=this.cE.Ae;this.$Jb=this.cE.Ae-1;this.Fr=0;this.Ope(a)}Ope(a){const b=a.yF;for(;a.moveNext();){const f=a.cB;for(let l=f.Ae;l<f.rg;l++){var c=this.jGa(l,f.qe);this.gaa[c]=0!==this.gaa[c]?32:l<b.Ae&&f.qe>b.qe?1:l>=b.rg&&f.qe>b.qe?4:16;c=this.jGa(l,f.hg);this.gaa[c]=0!==this.gaa[c]?32:l<b.Ae&&f.hg<b.hg?1:l>=b.rg&&f.hg<b.hg?4:64}}}jGa(a,
b){return this.cE.hQ*(b-this.cE.qe)+(a-this.cE.Ae)}moveNext(){this.Vib=this.$Jb;do{this.Vib++;this.Vib>=this.cE.rg&&(this.aN++,this.Vib=this.cE.Ae);if(this.aN>this.cE.hg)return!1;this.Fr=this.gaa[this.jGa(this.Vib,this.aN)]}while(0===this.Fr);for(this.$Jb=this.Vib;this.$Jb+1<this.cE.rg&&this.gaa[this.jGa(this.$Jb+1,this.aN)]===this.Fr;)this.$Jb++;return!0}AKj(){return this.$Jb+1}Zbb(){return this.Fr}static Bue(a){return!!(a&117)}}Object(m.a)(RF,"VerticalTableBorderIterator",null,[979,980]);class nm{constructor(a,
b,c,f,l,u,I){this.Hl=a;this.Er=b;this.Ub=c;this.vB=f;this.sga=l;this.TJk=u;this.AUk=I}ihm(a,b,c){const f=b.getContainingTable();f&&(this.fdm(b,f,a,c.hg,c.Ae),this.edm(b,f,a,c.rg,c.qe))}hee(a,b,c,f,l,u){if(c&&c!==b.hQ)for(;f<l;f++)if(9===(b.xt(c-1,f)&9)&&5===(b.xt(c,f)&5)){var I=this.Er.UJ(b,c-1,f),T=this.Er.UJ(b,c,f);I=a.tf(I.Ae,I.qe);T=a.tf(T.Ae,T.qe);u?this.fyb(T,I,7,0):this.fyb(I,T,0,7)}}u7e(a,b,c,f,l){l=this.sga.KFa(a,b,c,l);c=f.kvj();if(RF.Bue(c)){const u=this.AUk.Y7i(l,b);for(;u.moveNext();)0!==
(c&u.Zbb())&&this.X8e(a,b,u.aN,u.Vib,u.AKj(),f.VBb(u.Zbb()),!0)}if(PF.Bue(c))for(l=this.TJk.N3i(l,b);l.moveNext();)0!==(c&l.Zbb())&&this.V7e(a,b,l.WP,l.mgb,l.Iwj(),f.VBb(l.Zbb()),!0)}X8e(a,b,c,f,l,u,I){I=void 0===I?!1:I;let T=this.vB.n2c(a),ja=null;0<c&&(ja=a.tf(f,c-1));let ua=null;for(c<b.NS&&(ua=a.tf(f,c));f<l;){if(ja){if(6===(b.xt(f,c-1)&6)){var Ra=this.Er.UJ(b,f,c-1),eb=a.tf(Ra.Ae,Ra.qe);I&&T?T=this.VQb(T,eb,Ra.Ae,Ra.qe,6,u):nm.Pxc(6,eb,u)}f+1<l&&(ja=a.tf(f+1,c-1))}ua&&(5===(b.xt(f,c)&5)&&(Ra=
this.Er.UJ(b,f,c),eb=a.tf(Ra.Ae,Ra.qe),I&&T?T=this.VQb(T,eb,Ra.Ae,Ra.qe,5,u):nm.Pxc(5,eb,u)),f+1<l&&(ua=a.tf(f+1,c)));f+=1}}kee(a,b,c,f,l,u){if(c&&c!==b.NS)for(;f<l;f++)if(6===(b.xt(f,c-1)&6)&&5===(b.xt(f,c)&5)){var I=this.Er.UJ(b,f,c-1),T=this.Er.UJ(b,f,c);I=a.tf(I.Ae,I.qe);T=a.tf(T.Ae,T.qe);u?this.fyb(T,I,5,6):this.fyb(I,T,6,5)}}V7e(a,b,c,f,l,u,I){I=void 0===I?!1:I;let T=this.vB.n2c(a),ja=null;0<c&&(ja=a.tf(c-1,f));let ua=null;for(c<b.hQ&&(ua=a.tf(c,f));f<l;){if(ja){if(9===(b.xt(c-1,f)&9)){var Ra=
this.Er.UJ(b,c-1,f),eb=a.tf(Ra.Ae,Ra.qe);I&&T?T=this.VQb(T,eb,Ra.Ae,Ra.qe,0,u):nm.Pxc(0,eb,u)}f+1<l&&(ja=a.tf(c-1,f))}ua&&(5===(b.xt(c,f)&5)&&(Ra=this.Er.UJ(b,c,f),eb=a.tf(Ra.Ae,Ra.qe),I&&T?T=this.VQb(T,eb,Ra.Ae,Ra.qe,7,u):nm.Pxc(7,eb,u)),f+1<l&&(ua=a.tf(c,f)));f+=1}}j_h(a,b,c,f){var l=null;let u=nm.w_h(b,c,f);({Ae:f}=u);if(!u.returnValue)return{returnValue:!1,Ana:l};l=6;0<c&&nm.XDb(b,f,c-1)?(b=this.Er.UJ(b,f,c-1),a=this.Ub.Pc(a.tf(b.Ae,b.qe))):(l=5,b=this.Er.UJ(b,f,c),a=this.Ub.Pc(a.tf(b.Ae,b.qe)));
l=this.Xkg(a,l);return{returnValue:!0,Ana:l}}f_h(a,b,c,f){const l=nm.p_h(b,c,f);if(!l.returnValue)return{returnValue:!1,Ana:null};f=0;0<c&&nm.qfb(b,l.qe,c-1)?(b=this.Er.UJ(b,c-1,l.qe),a=this.Ub.Pc(a.tf(b.Ae,b.qe))):(f=7,b=this.Er.UJ(b,c,l.qe),a=this.Ub.Pc(a.tf(b.Ae,b.qe)));return{returnValue:!0,Ana:this.Xkg(a,f)}}VQb(a,b,c,f,l,u){const I=b.rowSpan;b=b.colSpan;for(let T=c;T<c+I;T++)for(let ja=f;ja<f+b;ja++)a.VQb(T,ja,l,u);return a}Xkg(a,b){a=a.lr;if(!a||!a.cellShading)return null;let c=null;({Ana:c}=
this.Hl.Xff(b,a.cellShading));return c}fyb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=yl.a.HVa(b,yb.a.cellShading));l&&({Ana:b}=this.Hl.Xff(f,l),nm.Pxc(c,a,b))}}fdm(a,b,c,f,l){let u;l=nm.w_h(c,f,l);({Ae:u}=l);l.returnValue&&(l=6,0<f&&nm.XDb(c,u,f-1)?c=this.Er.UJ(c,u,f-1):(l=5,c=this.Er.UJ(c,u,f)),b=b.tf(c.Ae,c.qe),this.fyb(a,b,6,l))}edm(a,b,c,f,l){let u;l=nm.p_h(c,f,l);({qe:u}=l);l.returnValue&&(l=0,0<f&&nm.qfb(c,u,f-1)?c=this.Er.UJ(c,f-1,u):(l=7,c=this.Er.UJ(c,f,u)),b=b.tf(c.Ae,
c.qe),this.fyb(a,b,0,l))}static Pxc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static w_h(a,b,c){let f,l;f=c;l=c+1;if(!nm.qfb(a,b,c))return{returnValue:!1,Ae:f,rg:l};for(;0<f&&!(0<b&&nm.XDb(a,f,b-1))&&!(b<a.NS&&nm.XDb(a,f,b));f--);for(;l<a.hQ&&!(0<b&&nm.XDb(a,l,b-1))&&!(b<a.NS&&nm.XDb(a,l,b));l++);return{returnValue:!0,Ae:f,rg:l}}static p_h(a,b,c){let f;f=c;for(c+=
1;0<f&&!(0<b&&nm.qfb(a,f,b-1))&&!(b<a.hQ&&nm.qfb(a,f,b));f--);for(;c<a.NS&&!(0<b&&nm.qfb(a,c,b-1))&&!(b<a.hQ&&nm.qfb(a,c,b));c++);return{returnValue:!0,qe:f,hg:c}}static qfb(a,b,c){return 0<b&&!(a.xt(c,b-1)&2)||b<a.NS&&!(a.xt(c,b)&1)?!1:!0}static XDb(a,b,c){return 0<b&&!(a.xt(b-1,c)&8)||b<a.hQ&&!(a.xt(b,c)&4)?!1:!0}}Object(m.a)(nm,"TableBorderEditor",null,[1622,1623]);class wN{constructor(a,b,c,f){this.zCe=!1;this.w2=a;this.WSk=b;this.FKb=c;this.iKe=f;this.Oi=Array(this.w2.jW);for(a=0;a<this.w2.jW;a++)for(this.Oi[a]=
Array(this.w2.Sta),b=0;b<this.w2.Sta;b++)this.Oi[a][b]=new qq.a}jvj(a,b,c){this.zCe||(this.WSk.sGl(a,this.w2),this.zCe=!0);if(md.a("BugFixCacheInvalidIndex")){if(this.Oi&&0<=b&&b<this.Oi.length&&this.Oi[b]&&0<=c&&c<this.Oi[b].length)return this.Oi[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.Oi,b,c);this.Oi&&(a+=String.format(" m_cache.Length : {0} ",this.Oi.length),a=this.Oi[b]?a+String.format(" m_cache[ row ].Length : {0} ",
this.Oi[b].length):a+" m_cache[ row ] is null ");ya.a.J(508360525,822,15,a);return null}return this.Oi[b][c]}VQb(a,b,c,f){const l=this.FKb.JGh(c,this.w2.Ld,f);a=this.Oi[a][b];for(const u of l.ZA())a.He(u,l.$h(u));if(this.iKe&&md.a("TableBordersLocalRenderingFix")){const {ZSa:u,c$a:I,Awb:T}=Oq.fWa(c);f.wFieldSpecified&&(f.noFillField?a.He(u,0):a.He(u,Re.a.fbe(f.wField)));f.solidFillField&&a.He(I,f.solidFillField);f.prstDashField&&a.He(T,f.prstDashField)}}dispose(){this.Oi=null;this.zCe=!1}}Object(m.a)(wN,
"TableBorderStyleCache",null,[1621,106]);class SF{constructor(a){this.mMe=a?1:0}pYd(a){const b=a.cB;a=a.yF;return b.qe%2===this.mMe&&a.Pzb(b)}}Object(m.a)(SF,"BandedColumnFilter",null,[1660]);class TF{constructor(a){this.mMe=a?1:0}pYd(a){const b=a.cB;a=a.yF;return b.Ae%2===this.mMe&&a.Pzb(b)}}Object(m.a)(TF,"BandedRowFilter",null,[1660]);class xN{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}kvj(){let a=0;this.top&&(a|=1);
this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}VBb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(m.a)(xN,"TableBorderSet",null,[]);class yN{constructor(a,b){this.b7=a;this.bTk=
b}sGl(a,b){const c=b.jW,f=b.Sta;var l=b.tableLook;b=b.tableStyle;const u=this.bTk.create(a),I=!!(l&32)&&!!b.firstRowField,T=!!(l&64)&&!!b.lastRowField,ja=!!(l&128)&&!!b.firstColField,ua=!!(l&256)&&!!b.lastColField,Ra=I&&ja&&!!b.nwCellField,eb=I&&ua&&!!b.neCellField,Bb=T&&ja&&!!b.swCellField,Ub=T&&ua&&!!b.seCellField;var Xb=!(l&512)&&!!b.band1HField,tc=!(l&512)&&!!b.band2HField,lc=!(l&1024)&&!!b.band1VField;const Ec=!(l&1024)&&!!b.band2VField;l=new Ur.a;b.wholeTblField&&(l.Ae=0,l.rg=c,l.qe=0,l.hg=
f,this.apply(a,u,b.wholeTblField,l));l.Ae=I?1:0;l.rg=c-(T?1:0);l.qe=0;l.hg=f;Xb&&(Xb=new TF(I),this.apply(a,u,b.band1HField,l,Xb));tc&&(tc=new TF(!I),this.apply(a,u,b.band2HField,l,tc));l.Ae=0;l.rg=c;l.qe=ja?1:0;l.hg=f-(ua?1:0);lc&&(lc=new SF(ja),this.apply(a,u,b.band1VField,l,lc));Ec&&(lc=new SF(!Ec),this.apply(a,u,b.band2VField,l,lc));ua&&(l.Ae=0,l.rg=c,l.qe=f-1,l.hg=f,this.apply(a,u,b.lastColField,l));ja&&(l.Ae=0,l.rg=c,l.qe=0,l.hg=1,this.apply(a,u,b.firstColField,l));T&&(l.Ae=c-1,l.rg=c,l.qe=
0,l.hg=f,this.apply(a,u,b.lastRowField,l),Ub&&(l.qe=f-1,l.hg=f,this.apply(a,u,b.seCellField,l)),Bb&&(l.qe=0,l.hg=1,this.apply(a,u,b.swCellField,l)));I&&(l.Ae=0,l.rg=1,l.qe=0,l.hg=f,this.apply(a,u,b.firstRowField,l),eb&&(l.qe=f-1,l.hg=f,this.apply(a,u,b.neCellField,l)),Ra&&(l.qe=0,l.hg=1,this.apply(a,u,b.nwCellField,l)))}apply(a,b,c,f,l){l=void 0===l?null:l;if(!f.aVa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const u=new xN;c.topField&&c.topField.itemField&&(u.top=c.topField.itemField);c.bottomField&&
c.bottomField.itemField&&(u.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(u.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(u.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(u.right=c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(u.insideVer=c.insideVField.itemField);this.b7.u7e(a,b,f,u,l)}}}Object(m.a)(yN,"TableBorderStyleResolver",null,[910]);class $w{constructor(){}qQi(a,b){const c=new Ur.a;if(a.aVa())return c;
const f=$w.wcg(b,a,a.Ae,!0),l=$w.wcg(b,a,a.rg-1,!1),u=$w.Zbg(b,a,a.qe,!0);a=$w.Zbg(b,a,a.hg-1,!1);c.Ae=f;c.rg=l+1;c.qe=u;c.hg=a+1;return c}ufk(a,b){for(var c=a.Ae;c<a.rg;++c)if(!(b.xt(c,a.qe)&1&&b.xt(c,a.hg-1)&2))return!1;for(c=a.qe;c<a.hg;++c)if(!(b.xt(a.Ae,c)&4&&b.xt(a.rg-1,c)&8))return!1;return!0}Ugg(a){let b;b=null;const c=new Ur.a;if(!(a&&a.qm&&a.kb&&a.s3))return{returnValue:c,tableNode:b};var f=a.ga(0).yg.Ua,l=Object(gb.a)(Sm.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,
tableNode:b};f=l.rowIndex;l=l.Yi;var u=Object(gb.a)(Sm.TableCellNode,a.ga(0).yg.vf.node);var I=0;u&&(I=u.Yi+1);if(b.rq()&&1!==a.length){I=Object(gb.a)(Sm.TableCellNode,a.e4a.currentNode);f=Object(gb.a)(Sm.TableCellNode,a.Vla.currentNode);if(!I||!f)return{returnValue:c,tableNode:b};l=I.rowIndex;a=I.Yi;u=f.rowIndex;I=f.Yi;f=Math.min(l,u);u=Math.max(l,u)+1;l=Math.min(a,I);I=Math.max(I,a)+1}else u=f+a.length;c.Ae=f;c.rg=u;c.qe=l;c.hg=I;return{returnValue:c,tableNode:b}}UJ(a,b,c){b=Object.assign(new Ur.a,
{Ae:b,rg:b+1,qe:c,hg:c+1});return this.pXc(a,b)}pXc(a,b){const c=new Ur.a;let f=b.Ae,l=b.rg-1;for(var u=b.qe;u<b.hg;u++){for(var I=b.Ae;0<I&&!(a.xt(I,u)&4);I--);I<f&&(f=I);I=b.rg-1;for(var T=a.hQ-1;I<T&&!(a.xt(I,u)&8);I++);I>l&&(l=I)}u=b.qe;I=b.hg-1;for(T=b.Ae;T<b.rg;T++){let ja=b.qe;for(;0<ja&&!(a.xt(T,ja)&1);ja--);ja<u&&(u=ja);ja=b.hg-1;for(const ua=a.NS-1;ja<ua&&!(a.xt(T,ja)&2);ja++);ja>I&&(I=ja)}c.Ae=f;c.qe=u;c.hg=I+1;c.rg=l+1;return c}static wcg(a,b,c,f){if(f)for(;0<c;c--)for(f=b.qe;f<b.hg;++f){if(a.xt(c,
f)&4)return c}else for(f=a.hQ-1;c<f;c++)for(let l=b.qe;l<b.hg;++l)if(a.xt(c,l)&8)return c;return c}static Zbg(a,b,c,f){if(f)for(;0<c;c--)for(f=b.Ae;f<b.rg;++f){if(a.xt(f,c)&1)return c}else for(f=a.NS-1;c<f;++c)for(let l=b.Ae;l<b.rg;++l)if(a.xt(l,c)&2)return c;return c}}Object(m.a)($w,"TableCellSelectionHelper",null,[905]);class zN{constructor(a,b,c){this.eS=null;this.f6=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.me=a;this.Cc=b;this.wZ=c;this.cZ=3}Jif(){try{var a=
mb.GraphIterator.ob(this.me);ce.forEachCellInTable(a,(b,c,f)=>{var l=Object(gb.a)(650,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let u=c;u<b;++u)for(let I=f;I<l;++I)u===c&&(this.eS[u][I]|=4),u===b-1&&(this.eS[u][I]|=8),I===f&&(this.eS[u][I]|=1),I===l-1&&(this.eS[u][I]|=2)}return!0})}catch(b){a=this.wZ.Gae(this.me),ya.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.f6)throw Error.invalidOperation("cache disposed");if(0!==this.cZ){if(3===
(this.cZ&3)){const a=this.Cc.fl(this.me),b=this.Cc.ej(this.me);this.eS=Array(a);for(let c=0;c<a;++c){this.eS[c]=Array(b);for(let f=0;f<b;++f)this.eS[c][f]=0}}1===(this.cZ&1)&&this.Jif();this.cZ=0}}xt(a,b){try{this.validate();var c=this.eS[a][b]}catch(f){c=this.wZ.Gae(this.me),ya.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.hQ,this.NS,a,b,c,f.message),c=0}return c}tXa(a){this.cZ|=a}dispose(){this.f6=!0;this.eS=null}get hQ(){this.validate();return this.eS?
this.eS.length:0}get NS(){this.validate();return this.eS&&this.eS.length?this.eS[0].length:0}}Object(m.a)(zN,"TableInfoCache",null,[1655,106]);class AN{constructor(a,b){this.Cc=a;this.wZ=b}create(a){return new zN(a,this.Cc,this.wZ)}}Object(m.a)(AN,"TableInfoCacheFactory",null,[917]);class ZB{constructor(a,b,c,f,l,u){this.nRk=a;this.VGk=b;this.eTk=c;this.HMk=f;this.DTk=l;this.jTk=u}get jW(){return this.nRk()}get Sta(){return this.VGk()}get tableLook(){return this.eTk()}get Zwk(){return this.HMk()}get Ld(){return this.DTk()}get tableStyle(){return this.jTk()}static n2f(a,
b,c,f,l,u){return new ZB(a,b,c,f,l,u)}}Object(m.a)(ZB,"TableListStyleParams",null,[971]);class BN{constructor(a){this.ppa=null;this.Ued=!1;this.hPe=this.yGb=null;this.Ub=a}get $gk(){return!!this.yGb}lwh(a,b){this.hPe=a.id.toString();this.Ued=!this.Ub.fCj(a).currentNode.sc(b).a8c();this.yGb=null;this.Ued&&(a=a.sc(b),this.Uhj(),za.a.v6b(a.htmlElement,this.ppa),this.yGb=this.ioj(this.ppa))}R$b(a,b,c,f){if(a.id.toString()!==this.hPe)throw Error.argument("table","Wrong table metrics");if(this.Ued){if(!this.yGb)throw Error.invalidOperation("m_clonedTableNode is null");
a=this.yGb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(da.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",c.className),c=za.a.lfa(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){za.a.LXa(this.ppa)&&this.ppa.parentNode.removeChild(this.ppa);this.yGb=this.ppa=null;this.Ued=!1;this.hPe=null}Gae(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.ra(rb.a.bBa,
0),a.properties.ra(rb.a.Ria,0)));const c=this.Ub.Pc(a);ce.forEachCellInTable(c,(f,l,u)=>{var I=f.currentNode;f=I.rowSpan;I=I.colSpan;(1<f||1<I)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",l,u,f,I));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}Uhj(){this.ppa||(this.ppa=document.createElement("div"),this.ppa.className="TableMetricsWorkingDiv",document.body.appendChild(this.ppa));za.a.EEa(this.ppa)}ioj(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;
a=a.nextSibling}return null}}Object(m.a)(BN,"TableMetrics",null,[914]);class CN{constructor(a){this.vB=a}tGl(a,b,c){return b&&a&&c&&(a=this.vB.p2c(a).kig(c,b.rowIndex,b.Yi,b.rowSpan,b.colSpan))&&a!==Vb.a.auto?a.DE:-1}}Object(m.a)(CN,"TableThemeColorHelper",null,[918]);class DN{constructor(a){this.Er=a}Y7i(a,b){return new RF(a,this.Er,b)}}Object(m.a)(DN,"VerticalTableBorderIteratorFactory",null,[909]);class UF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}fc(a){this.K=a;this.K.register(905,
"PowerPointWebEditor.ITableCellSelectionHelper").ma().na(()=>new $w);a.register(906,"Box4.ITableDragSelectionCellExtendStrategy").ma().na(()=>new $M(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(nm,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().na(()=>
new nm(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(907,"PowerPointWebEditor.ICellIteratorFactory").ma().na(()=>
new qN(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(908,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().na(()=>new rN(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(909,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().na(()=>new DN(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(910,"PowerPointWebEditor.ITableBorderStyleResolver").ma().na(()=>new yN(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),
this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(cn,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().na(()=>new cn(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Na));this.K.register(MF,"PowerPointWebEditor.TableNodeBehavior").ma().na(()=>new MF(this.K.resolve("Box4.Graph.IGraphInstance").Cd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Na,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").vme));this.K.register(911,"PowerPointWebEditor.ITableStyleReaderHelper").ma().na(()=>new Oq(this.K.resolve("Box4.IPageView").Xd,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").f9c));this.K.register(VB,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().na(()=>
new VB(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Xd,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),ZB.n2f,b=>new OF(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),
b=>new LF(b),b=>new wN(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").Rba),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").dAg,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Crk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rba));this.K.register(912,"PowerPointWebEditor.ITableStyleResolver").ma().na(()=>new lN(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rba));this.K.register(913,"PowerPointWebEditor.ITableStyleGalleryManager").ma().na(()=>
new oN(this.K.Ha("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(914,"PowerPointWebEditor.ITableMetrics").ma().na(()=>new BN(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(915,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().na(()=>new uN(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));
this.K.register(916,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().na(()=>new vN(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(14),this.K.resolve("Box4.Graph.IGraphInstance").Cd(15),this.K.resolve("Box4.Graph.IGraphInstance").Cd(16),this.K.resolve("Box4.Graph.IGraphInstance").Cd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(JF,"PowerPointWebEditor.TableCellNodeBehavior").ma().na(()=>new JF(this.K.resolve("Box4.Graph.IGraphInstance").Cd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(WM,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(XM,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();
this.K.register(NS.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(917,"PowerPointWebEditor.ITableInfoCacheFactory").ma().na(()=>new AN(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(918,"PowerPointWebEditor.ITableThemeColorHelper").ma().na(()=>new CN(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,
b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").gPb(1,new Zw(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a),new hN(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new gN(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,
new Cm.a((c,f)=>new zm(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>vz.H6b(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new Cm.a((c,f)=>new Yw(c,f,new zc.a(c,f,zc.a.J8l))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,
new ZM(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),new Cm.a((c,f)=>new Ut(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lma,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rba,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));Wb.StyleReader.xs=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");
this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){C.a.instance.Ac(new UF)}}Object(m.a)(UF,"PPTWebEditorTablePackage",null,[2,3]);var QS=d(1296),Di=d(110);class EN{constructor(){this.podsUrl=this.fileUrl=null}}Object(m.a)(EN,"IFileInfo",null,[]);class FN extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}
Object(m.a)(FN,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class GN{constructor(){this.messageType=0;this.data=this.sender=null}}Object(m.a)(GN,"IPresentationMessage",null,[]);class HN{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(m.a)(HN,"IPresenterViewSettings",null,[]);class IN{constructor(){this.uiHost=this.userSessionId=null}}Object(m.a)(IN,"ISessionInfo",null,[]);var RS=d(546);class JN{constructor(a,
b,c){this.zP="";this.R1=null;this.Dhb=!1;this.zJb=null;this.ua=new uc.a;this.ia=a;this.ka=b;this.Hc=c;this.ckl()}qb(){this.ia.pa(M.a.QOb,wc.a.application,Object(R.a)(this,this.QOb,"queryUsePresenterView"),96);this.ia.xa(M.a.tif,wc.a.application,Object(R.a)(this,this.Bam,"toggleUsePresenterView"));this.ia.xa(M.a.RAd,ta.a.application,Object(R.a)(this,this.RAd,"showPresenterView"));this.ia.xa(M.a.aSc,wc.a.application,Object(R.a)(this,this.aSc,"closePresenterView"));this.Dhb=A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled")}QOb(a,
b,c,f,l){(a=Object(gb.a)(Di.a,l))&&a.Rf(this.Dhb);return 32}Bam(a,b,c){if(1===c&&!A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled"))return ya.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),8;2===c&&(this.Dhb=!this.Dhb,this.Hc.Gz(new Pq.a(1)));return 32}RAd(a,b,c){try{if(!A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled"))return ya.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),
2;if(2===c&&0<this.zP.length){if(!this.zJb){const f=this.ka.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),u=new EN;u.fileUrl=this.zP;u.podsUrl=f;const I=new IN;I.userSessionId=A.AFrameworkApplication.userSessionId;I.uiHost="UnifiedApp";const T=new HN;T.presenterWindowWidth=1024;T.presenterWindowHeight=576;this.zJb=new PresenterView.PresentationProxy(2,l,u,I,T)}this.zJb.startPresentation();this.zJb.subscribe(Object(R.a)(this,this.n8k,"onPresentationChannelMessageHandler"))}return 32}catch(f){return ya.a.J(512496090,
822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}aSc(a,b,c){2===c&&(ya.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.zJb.terminatePresentation());return 32}pzi(a){this.ua.addHandler("OnPresenterViewSyncMessageReceived",a)}fNl(a){a=this.fGi(a);this.zJb.sendMessage(a)}fGi(a){const b=new GN;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.OAc});
return b}n8k(a){try{if(!a||0>=a.length)ya.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||ya.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=JSON.parse(l).slideLocation.slideIndex;this.ua.raiseEvent("OnPresenterViewSyncMessageReceived",new FN({["SlideIndex"]:f}))}}}}catch(l){ya.a.J(512496086,830,10,"Exception: {0}",l)}}ckl(){var a=Tb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,
b=Tb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new QS.a(A.AFrameworkApplication.Me);this.R1=RS.b(b.$6e(a));this.R1.then(c=>{try{const f=JSON.parse(c),l=f.downloadUrl;Aa.a.Ta(l)?ya.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.zP=l}catch(f){ya.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",
f)}return null})}}Object(m.a)(JN,"PresenterViewManager",null,[860]);class VF{constructor(){this.wb=this.ka=this.K=null;this.aYg=!1}get name(){return"PowerPointWebEditor.PresenterView"}fc(a){this.K=a;this.ka=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.wb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").JG()}init(){A.AFrameworkApplication.fa.Ue(Object(R.a)(this,this.Pn,"onFullAppSettingsReady"))}Pn(){try{(this.aYg=A.AFrameworkApplication.fa.getBooleanAppSetting("PptPresenterViewEnabled"))&&
this.K.resolve("Common.IDynamicScriptLoaderProvider").nG.loadScript("presenterView").catch(a=>ya.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.p8k()).catch(a=>ya.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){da.ULS.sendTraceTag(594031830,811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}p8k(){this.I6b();return null}I6b(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type",
"text/css");a.setAttribute("href",A.AFrameworkApplication.fa.Ea("PPTPresenterViewCssUrl"));this.wb.appendChild(a);this.K.register(860,"PowerPointWebEditor.PresenterView.IPresenterViewManager").na(()=>new JN(A.AFrameworkApplication.Pa,this.ka,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").qb()}dispose(){}static main(){C.a.instance.Ac(new VF)}}Object(m.a)(VF,"PPTWebEditorPresenterViewPackage",null,[2,3]);class KN{constructor(a){this.sga=
a}z7i(a,b,c){if(c.aVa())return null;a=this.sga.KFa(a,b,c);for(b=Array(b.hQ);a.moveNext();){c=a.Q$b();var f=a.cB;b[f.Ae]||(b[f.Ae]=[]);f=b[f.Ae];f[f.length]=Mr.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new Nd.Selection(b[c],!0));return new yc.SelectionCollection(a,a.length-1,0)}}Object(m.a)(KN,"PPTSelectionFactory",null,[858]);class LN{constructor(a,b,c,f){this.PJe=this.gpa=this.ECe=null;this.xpi=a;this.abi=b;this.Er=c;this.r0a=f}get RQi(){return this.abi}get ixb(){this.ECe||
(this.ECe=this.Er.qQi(this.RQi,this.w_));return this.ECe}get tableNode(){return this.xpi}get w_(){this.gpa||(this.gpa=this.r0a.create(this.tableNode));return this.gpa}get Uok(){this.PJe||(this.PJe=this.Er.ufk(this.ixb,this.w_));return this.PJe}}Object(m.a)(LN,"TableCellSelectionInfo",null,[]);class MN{constructor(a,b){this.r0a=a;this.Er=b}create(a,b){return new LN(b,a,this.Er,this.r0a)}}Object(m.a)(MN,"TableCellSelectionInfoFactory",null,[856]);var SS=d(1048);class NN{constructor(a,b,c){this.fdh=
a;this.Er=b;this.PIa=c}xbc(a){let b=null;const c=new Date;let f=null;const l=(()=>{let I=this.Er.Ugg(a);({tableNode:f}=I);return I})().returnValue,u=!l.aVa();u&&(b=this.fdh.create(l,f),$c.a.Kb&&$c.a.Kb.Wa("CellRange",l.toString()));ya.a.J(512495623,808,u?50:10,"Table cell selection range {0}, took {1}",l.toString(),+new Date-+c);return b}LMj(a){if(!a)return null;var b=this.PIa.dC(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].El){var f=Object(gb.a)(5,b[l].node);if(f){f=f.xM();if(!f)return null;
if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new Ur.a,{Ae:a.rowIndex,qe:a.Yi});b.rg=b.Ae+1;b.hg=b.qe+1;return this.fdh.create(b,a.getContainingTable())}}Object(m.a)(NN,"TableSelectionAdapter",null,[857]);class WF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}fc(a){this.K=a;this.K.register(856,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().na(()=>new MN(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(857,"PowerPointWebEditor.ITableSelectionAdapter").ma().na(()=>new NN(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));
this.K.register(858,"PowerPointWebEditor.ISelectionFactory").ma().na(()=>new KN(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(859,"PowerPointWebEditor.ITableMergeSplitEditor").ma().na(()=>new SS.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),
this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){C.a.instance.Ac(new WF)}}
Object(m.a)(WF,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class $l{constructor(a,b,c,f,l,u,I,T){this.Fub=a;this.wWd=b;this.Ca=c;this.uWd=f;this.lm=l;this.Eu=u;this.zd=I;this.Dhi=T}qb(){this.pmb(ad.App.uOa.H0f())}pmb(a){this.Ca.xa(G.a.KOb,ta.a.view,a);this.Ca.xa(G.a.KOb,ta.a.table,Object(R.a)(this,this.KOb,"queryTableStyle"));this.Ca.pe(G.a.KOb,103);this.Ca.xa(G.a.y0,ta.a.view,Object(R.a)(this,this.rdf,"tableStyleGenericViewActionHandler"));this.Ca.xa(G.a.y0,ta.a.table,Object(R.a)(this,this.y0,
"applyTableStyle"));this.Ca.pe(G.a.y0,6);this.Ca.xa(G.a.N9a,ta.a.table,Object(R.a)(this,this.y0,"applyTableStyle"));this.Ca.xa(G.a.oU,ta.a.view,Object(R.a)(this,this.rdf,"tableStyleGenericViewActionHandler"));this.Ca.xa(G.a.oU,ta.a.table,Object(R.a)(this,this.oU,"applyTableStyleOption"));this.Ca.pe(G.a.oU,14);this.Ca.xa(G.a.Tba,ta.a.view,a);this.Ca.xa(G.a.Tba,ta.a.table,Object(R.a)(this,this.Tba,"queryTableStyleOption"));this.Ca.pe(G.a.Tba,103);this.Ca.xa(G.a.kNb,ta.a.view,a);this.Ca.xa(G.a.kNb,ta.a.table,
Object(R.a)(this,this.kNb,"populateMenuMoreTableStyles"));this.Ca.pe(G.a.kNb,102);this.Ca.xa(G.a.J$a,ta.a.view,Object(R.a)(this,this.rdf,"tableStyleGenericViewActionHandler"));this.Ca.xa(G.a.J$a,ta.a.table,Object(R.a)(this,this.J$a,"clearTableFormatting"));this.Ca.pe(G.a.J$a,4)}KOb(a,b,c,f,l){let u;if(!(()=>{let I=this.pyc(b,c,l,!0,!0);({yG:u}=I);return I})().returnValue)return u;this.wWd.y3i(l,b.node);return 32}Tba(a,b,c,f,l){return this.Htg(b,c,f,l,!0)}kNb(a,b,c,f,l){let u;if(!(()=>{let I=this.pyc(b,
c,l,!1,!0);({yG:u}=I);return I})().returnValue)return u;this.wWd.G4i(l,b.node);da.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}y0(a,b,c,f,l){let u;if(!(()=>{let ja=this.pyc(b,c,l,!1,!0);({yG:u}=ja);return ja})().returnValue)return u;const I=b.node;let T=null;(T=a===G.a.y0?this.wWd.vCd(l[Xh.a.SourceControlId],I):null)?(this.uXe(I,()=>{this.uWd.WTl(T,I)}),u=32):u=8;a===G.a.y0&&32===u&&da.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");da.ULS.shipAssertTag(541172699,324,
32===u);return u}oU(a,b,c,f,l){return this.Htg(b,c,f,l,!1)}Htg(a,b,c,f,l){let u;if(!(()=>{let Ra=this.pyc(a,b,f,l,!0);({yG:u}=Ra);return Ra})().returnValue)return u;const I=a.node,T=this.Fub.Nie(I),ja=f[Xh.a.On],ua=$l.TOj(A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es?f.MenuItemId:f[Xh.a.SourceControlId]);l?f[Xh.a.On]=$l.WYl(T,ua):(this.aFi(T,ua,ja,I),c.ED=ua,c.MO=ja?0:1,da.ULS.shipAssertTag(541172700,324,0!==ua));return 32}rdf(a,b,c,f,l){return Oi.x7(a,b,c,f,l,{},14)}uXe(a,b){const c=
this.lm.xe(15);try{c.rd(a),this.Eu.H2a(),b()}finally{c&&c.dispose()}}pyc(a,b,c,f,l){return this.Ork(a,b,c,f,l)?{returnValue:f||2===b,yG:32}:{returnValue:!1,yG:8}}Ork(a,b,c,f,l){if(a.contextId!==ta.a.table)return!1;if(f||2===b)if(l&&!c||!Object(gc.a)(Hr.a,a.node)||this.Dhi(a.node))return!1;return!0}aFi(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.uXe(f,()=>{this.uWd.yRl(l,f)})}J$a(a,b,c,f,l){let u;if(!(()=>{let T=this.pyc(b,c,l,!1,!1);({yG:u}=T);return T})().returnValue)return u;
const I=b.node;this.uXe(I,()=>{this.uWd.tUi(I)});return u=32}static As(){$l.WRa[$l.Koj]=32;$l.WRa[$l.Foj]=128;$l.WRa[$l.evk]=64;$l.WRa[$l.Xuk]=256;$l.WRa[$l.DHi]=512;$l.WRa[$l.CHi]=1024}static WYl(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static TOj(a){let b=0;a in $l.WRa&&(b=$l.WRa[a]);return b}}$l.Koj="buttonFirstRow";$l.Foj="buttonFirstColumn";$l.evk="buttonLastRow";$l.Xuk="buttonLastColumn";$l.DHi="buttonBandedRow";$l.CHi="buttonBandedColumn";$l.WRa={};Object(m.a)($l,"TableStyleActor",
null,[]);$l.As();class Tp{constructor(a){this.z2=a}WTl(a,b){a=this.z2.rbc(a);Tp.bXf(b);b.setValue(yb.a.cBa,kh.a.Tf(a.yZ.styleIdField))}yRl(a,b){b.setValue(yb.a.Yzc,a)}tUi(a){Tp.bXf(a);a.removeProperty(yb.a.cBa)}static bXf(a){if(a=Object(gb.a)(WB.TableNode,a)){a=a.Tcb();for(const b of a){b.cellShading&&((a=Sp.d(b.cellShading))?(Sp.c(a),b.cellShading=a):ya.a.J(508609610,822,15,"Encountered null cell shading."));for(const c of Tp.WIi){const {ZSa:f,c$a:l,Awb:u}=Oq.fWa(c);b.removeProperty(l);b.removeProperty(f);
b.removeProperty(u)}Tp.TTi(Object(gb.a)(Zg.a,b))}}else ya.a.J(508609611,822,10,"Casting of GraphNode to ITableNode is null")}static TTi(a){const b=new yA.a;b.set(a);for(a=b.Gb(1);a;){for(a=b.Gb(2);a;)12===a.type&&Tp.UTi(a),a=b.sk(2);a=b.sk(1)}}static UTi(a){if(a.Sa&&0<a.Sa.length)for(let b=0;b<a.Sa.length;b++)a.Sa.ga(b)&&Tp.VTi(a.Sa.ga(b))}static VTi(a){if(a=a.formatting){const f=a.paragraph.Zh;if(f){var b=a.RA,c=!1;if(b){for(let l=0;l<Tp.Ywd.length;l++)md.a("PersistFontOnTableDesignChange")&&Tp.Ywd[l]==
rb.a.fontColor||!b.Qa(Tp.Ywd[l])||(c||(c=!0,b=b.clone()),b.removeProperty(Tp.Ywd[l]));c&&(b=f.PMa(b),a.en=b.id)}}}}}Tp.Ywd=[rb.a.font,yb.a.latinFont,yb.a.eastAsianFont,yb.a.complexScriptFont,yb.a.aTb,rb.a.fontColor,rb.a.bold,rb.a.italic,yb.a.schemeColor];Tp.WIi=[5,6,7,0];Object(m.a)(Tp,"PPTTableStyleEditor",null,[950]);class XF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}fc(a){this.K=a}init(){(new $l(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),
this.K.resolve("Common.IActionManagerExtended"),new Tp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).qb()}dispose(){}static main(){C.a.instance.Ac(new XF)}}Object(m.a)(XF,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class YF{constructor(a,b,c){this.KPe=0;this.SHe=!1;this.jh=a;
this.Qs=b;this.oa=c;this.jh.uLf(Object(R.a)(this,this.OQf,"beforeForceOutboundGraphTransactionInitialize"));this.jh.$Da(Object(R.a)(this,this.Lrg,"graphTransactionDisposed"));this.Qs.Nka(Object(R.a)(this,this.d1a,"onBeforeValidatePersistence"))}dispose(){this.jh.GDh(Object(R.a)(this,this.OQf,"beforeForceOutboundGraphTransactionInitialize"));this.jh.w2a(Object(R.a)(this,this.Lrg,"graphTransactionDisposed"));this.Qs.wPb(Object(R.a)(this,this.d1a,"onBeforeValidatePersistence"))}OQf(){this.KPe++}d1a(){0<
this.KPe&&(this.SHe=!0)}Lrg(){if(!(0<--this.KPe)&&this.SHe){this.SHe=!1;var a=$c.a.Kb;if(a){const b=this.oa.Hd();let c=0;for(const f of b)f.TM&&c++;a.Wa("ShapeCount",b.length.toString());a.Wa("SupportSVGCount",c.toString())}}}}Object(m.a)(YF,"SVGShapeTelemetry",null,[106]);class ZF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}fc(a){this.K=a;this.K.register(YF,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().na(()=>new YF(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){C.a.instance.Ac(new ZF)}}Object(m.a)(ZF,"PPTWebEditorTelemetryPackage",null,[2,3]);class $B{}$B.Txh="faProofing";Object(m.a)($B,"ContextMenuControlId",null,[]);class $F{constructor(a,b,c,f,l,u,I){this.sO=b;this.r0b=a;
this.jHc=b.nhk;this.DHc=b.axe;this.Qgi=u;this.TGc=f;this.UGc=l;this.zQa=c;this.NQ=I;this.vQa=new id.a;this.vQa.$(1,"SpellingIssue_16x16x32");this.vQa.$(2,"GrammarIssue_16x16x32");this.vQa.$(3,"WritingIssue_16x16x32");this.vQa.$(4,null);this.vQa.$(0,null)}create(a,b,c){b=Object(gb.a)(Cp.a,b);if(!b)return da.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.Lkg(a);this.W6b(f,b,c,a);this.Q7d(f,b);this.Q5i(f,b,a);return f.toString()}eu(a,b,c){b=
Object(gb.a)(Cp.a,b);if(!b)return da.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.Lkg(a);this.v8d(f,b,c,a);this.R7d(f,b);this.R5i(f,b,a);return f}W6b(a,b,c,f){f=void 0===f?null:f;0===b.errorType?a.append(this.r0b.build()):1===b.errorType&&(this.SUa(b)||a.append(this.y2d(b,c,f)))}v8d(a,b,c,f){f=void 0===f?null:f;0===b.errorType?a.push(this.r0b.lSf()):1===b.errorType&&(this.SUa(b)||a.push(this.iKi(b,c,f)))}Q7d(a,b){if(!U.a.instance.ga(92)){const c=new Sys.StringBuilder;
this.eSh(b)?c.append(Hj.a("btnIgnoreAllSpellingError",(2===b.errorType?G.a.FEd:G.a.Poe).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.SUa(b)||c.append(Hj.a("btnIgrnoreSpellingError",this.hkg(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.iSh(b)&&(this.sO.Zue&&c.append(Hj.a("btnDoNotCheckForThisIssue","2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(Hj.a("btnGrammarOptions","3380187414",Aa.a.Fe(Box4Intl.Box4Strings.l_GrammarOptions),
null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}R7d(a,b){if(!U.a.instance.ga(92)){const f=Object.assign(new dl.a,{ControlList:[]});if(this.eSh(b)){var c=Object.assign(new Eg.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.SUa(b)||(c=Object.assign(new Eg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.hkg(b.errorType).toString(),
LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,c));this.iSh(b)&&(this.sO.Zue&&(b=Object.assign(new Eg.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new Eg.a,{ExternalId:"GrammerSettingsContext",Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}Lkg(a){if(!this.NQ)return null;a=this.NQ.language(this.NQ.yt(a.Ua));
return Ea.a.Oe(a).name}hkg(a){return 2===a?G.a.FEd:this.sO.zCg?G.a.s4c:G.a.Sma}Q5i(a,b,c){c=void 0===c?null:c;if(this.Q9e(b)){var f=Aa.a.Fe(b.KO.CategoryTitle);f=Hj.j($B.Txh,N.a.x9,this.vQa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.TGc,this.UGc);f=Hj.c("cgProofingOuter",[f]);a.clear();a.append(Hj.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));da.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",
b.proofingType,b.typeId)}}R5i(a,b,c){c=void 0===c?null:c;if(this.Q9e(b)){var f=Aa.a.Fe(b.KO.CategoryTitle);c=Object.assign(new ty.a,{ExternalId:String.format("{0}_{1}",$B.Txh,b.proofingType),Command:"798637440",Image16by16Class:this.vQa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,Menu:Object.assign(new Rn.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Guj(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,
MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);f=Object.assign(new dl.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);da.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}y2d(a,b,c){c=void 0===c?null:c;const f=this.IAj(a);var l=[];let u=!1;var I=a.KO.Suggestions;if(I)if(I=I.slice(0,Math.min(3,I.length)),this.jHc&&(u=!rd.a.any(I,T=>!T||!T.Description)),1===I.length&&0===I[0].Action)b=Aa.a.Fe(I[0].Text),
l.push(Hj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let T=0,ja=null;u&&(ja="font-weight: bold;");for(const ua of I){if(!ua)continue;I=null;let Ra="";const eb=Aa.a.Fe(ua.Text);u&&(I=this.Bgg(ua.Description),Ra=this.Agg(ua.Description));l.push(Hj.a("btnCorrectWord"+T,b[T].toString(),eb,null,null,null,null,null,ja,null,I,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,
f,eb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.A_f(a.token)),"ariaDescribedById",Ra));T++}}b="Menu16";0<l.length?u&&(b="Menu16DescriptionEnabled"):l=[Hj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)];return Hj.e("msUnknownWord",Hj.c(null,l),b,f,this.mFj(a),c,"ariaLabelledById")}iKi(a,b,c){c=void 0===c?null:c;var f=1!==a.proofingType&&0!==a.proofingType?a.KO.ExplanationTitle:"";f=Object.assign(new dl.a,
{Title:f,Lang:c,ControlList:[]});let l=!1;var u=a.KO.Suggestions;if(u)if(u=u.slice(0,Math.min(3,u.length)),this.jHc&&(l=!rd.a.any(u,I=>!I||!I.Description)),1===u.length&&0===u[0].Action)a=u[0],a=Object.assign(new Eg.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,a);else{let I=0;for(const T of u){if(!T)continue;u=null;let ja="";l&&(u=this.Bgg(T.Description),ja=this.Agg(T.Description));if(I>=b.length)break;u?(u=Object.assign(new mD,{ExternalId:String.format("{0}{1}_{2}_compoundButton",
"btnCorrectWord",I,a.proofingType),Command:b[I].toString(),LabelText:T.Text,Description:u,Lang:c,AriaDescription:ja}),Array.add(f.ControlList,u)):(u=Object.assign(new Eg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",I,a.proofingType),Command:b[I].toString(),LabelText:T.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,u));I++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new Eg.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));
return f}IAj(a){return Aa.a.Fe(1!==a.proofingType&&0!==a.proofingType?a.KO.ExplanationTitle:"")}mFj(a){return this.Q9e(a)?null:this.vQa.ga(a.proofingType)}Q9e(a){return this.DHc&&2!==a.errorType&&(1!==a.errorType||!this.SUa(a))}eSh(a){return this.Qgi&&0!==a.errorType&&1===a.proofingType&&!this.SUa(a)}Guj(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.A_f(a.token)):""}iSh(a){return this.sO.aYa&&this.DHc&&1===a.errorType&&(2===
a.proofingType||3===a.proofingType)}SUa(a){return 0!==a.errorType&&!!this.zQa&&this.zQa.contains(a.token,a.lcid)}Bgg(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}Agg(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,a):""}A_f(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(m.a)($F,"EditorServiceProofingContextMenuCreator",null,[]);class Qq{sca(a,b){this.$Pi&&this.H_l(a,
b,Qq.dRe,Qq.kb)}H_l(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:Qq.ffj.show(f,a,b)}}$gh(){switch(Qq.dRe){case 5:case 1:return!0;default:return!1}}Ila(){return Qq.dRe}get $Pi(){return 1!==ad.App.Ob.state}static get ffj(){return Qq.Nrf||(Qq.Nrf=Tb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static nFj(a){if(!a)return 0;if(2===ad.App.Ob.mode)if(U.a.instance.ga(17)&&1===a.length&&Bj.OutlineReader.rfc(a.Ua)&&ad.App.Ob.ie.yo&&ad.App.Ob.ie.yo.Wp){if(a=mb.GraphIterator.ob(a.Ua.node),
a.Zv(),!we.b(a))return 5}else{const b=a.Ua.node,c=mb.GraphIterator.ob(b);c.Zv();return Zu.e(c.currentNode)?2:A.AFrameworkApplication.jqb||!Zd.EmbeddedFileReader.xeb(b)||Zd.EmbeddedFileReader.PM(b)?a.Ua.contextId===ta.a.iFrame||rK(a.Ua)?6:1:3}else return 4;return 0}static get kb(){return Me.a.instance.Oa.kb}static get dRe(){return Qq.nFj(Qq.kb)}}Qq.Nrf=null;Object(m.a)(Qq,"SelectionContextMenuProvider",null,[840]);class ON{constructor(a){this.ka=a}vee(a,b,c,f,l){const u=c?A.AFrameworkApplication.Mm:
"";c=c?mp.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,u,c,Aa.a.Fe(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',a,b)}f7i(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new Py.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,
b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=Aa.a.yy(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}gSi(){var a=(new Py.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}w7i(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;var b=(new Py.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;
b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=Aa.a.yy(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(m.a)(ON,"ContextMenuHelper",null,[845]);class wz extends Er{constructor(a,b,c,f){super(a,c);this.fOg=b;this.uga=f}G$b(a){let b=null,c=!1;var f=Me.a.instance.Oa.kb;f=Tb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").sne(f,a);switch(this.uga){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=
["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;case 23:b=["LiveFeed","Comment"];c=!0;break;default:const l=!!this.fOg&&this.fOg.bFg("1898844988"),u=Tb.a.instance.resolve("Box4.ISelectionContextMenuProvider").$gh(),I=A.AFrameworkApplication.fa.getBooleanAppSetting("PPTOTableCellBordersEnabled");l?b=I?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting","Table","TableStyle",
"Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:u&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static g$j(a,b,c,f){a.nIi(()=>wz.HZi(b,c,f))}static HZi(a,b,c){return new wz(a,b,c,0)}}Object(m.a)(wz,"PowerPointReactFloatie",Er,[]);class PN{constructor(a,b){this.yQg=b;this.vDe=a}dispose(){}CB(){}g6f(){this.vDe.wua()}P7(a,b,c,f){this.yQg.DLh(f);
this.vDe.P7(a,b,c)}I_l(a,b,c,f){14===f?this.P7(a,b,c,f):(this.yQg.DLh(f),a=new wz(Tb.a.instance.ub("Common.IReactContextualUILauncher"),ad.App.WE.zU,Tb.a.instance.ub("Common.IExternalUICommandDefinitionMapping"),f),this.vDe.yAd(b,c,a,Tb.a.instance.ub("Box4.ISelectionContextMenuProvider")))}}Object(m.a)(PN,"ReactContextMenuUser",null,[843]);class aG{constructor(){this.qEf=null}get HHh(){return this.qEf||(this.qEf=Tb.a.instance.ub("Common.IRootManager"))}qb(){}Sd(){}uHg(){}hIl(){this.HHh&&this.HHh.zSc()}}
Object(m.a)(aG,"ABox4BridgeCommandUi",null,[844,106]);class QN extends aG{constructor(a,b,c,f){super();this.zOg=a;this.nv=b;this.ia=c;this.gjd=f}OB(a){Object(gb.a)(671,this.nv).nUb(a)}E3(a){return 32===this.ia.Ia(M.a.E3,2,a)}Agl(){this.zOg.clearCache();this.nv.CB()}uUb(){this.nv.uUb()}t5e(a){a?a(this.gjd.wua()):this.gjd.wua()}bFg(a){return this.zOg.Pfc(a)}uHg(){const a=Object(gb.a)(671,this.nv);a&&a.Fvk()}dispose(){}}Object(m.a)(QN,"Box4BridgeCommandUi",aG,[]);var bG=d(1173);class Wr{static get K9(){return Wr.D8||
(Wr.D8=Tb.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){Wr.K9.showContextMenu(a,b)}static P7(a,b,c){Wr.K9.P7(a,b,c)}static xAd(a,b,c,f){Wr.K9.xAd(a,b,c,void 0===f?null:f)}}Wr.D8=null;Object(m.a)(Wr,"BaseContextMenu",null,[]);class vq extends Iy{constructor(){super();this.MYd();this.AZd()}MYd(){this.addCommandToMaps(Object.assign(new Xa.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignLeft",
"2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignRight","393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));
this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterRight",
"4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",
queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopLeft_MLR","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));
this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomLeft_MLR",
"12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Xa.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Xa.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",
populationProps:new Fh("681481568",!1),previewControlIds:["buttonStyle0","buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Xa.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Xa.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Xa.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));
this.addCommandToMaps(Object.assign(new Xa.a("BulletLibrary","3552651681"),{queryCommandId:"3827179399",populationProps:new Fh("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Xa.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new Fh("462656847",!1)}));this.addCommandToMaps(Object.assign(new Xa.a("ClearFormatting",
"2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Xa.a("ClearShadingColor","3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Xa.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Xa.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Xa.a(vq.P0i,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Xa.a(vq.g9i,
"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Xa.a("DecreaseIndent","3376107472"),{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Xa.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));
this.addCommandToMaps(Object.assign(new Xa.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",populationProps:new Fh("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Xa.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Xa.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new Fh("3836866597",!0)}));this.addCommandToMaps(new Xa.a("DictationSettingsHelp",
"3819824931"));this.addCommandToMaps(new Xa.a("DictationSettingsHelpShowCommands","2729830074"));this.addCommandToMaps(Object.assign(new Xa.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Xa.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Xa.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Xa.a("FlipHorizontal",
"2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Xa.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Xa.a("FontColor","1970784898"),{legacyControlId:"fontColor",populationProps:new Fh("2077552168",!1)}));A.AFrameworkApplication.fa.getBooleanAppSetting("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Xa.a("FontName",
"3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Fh("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Xa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Xa.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Fh("179506844",
!1)})),this.addCommandToMaps(Object.assign(new Xa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Xa.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Xa.a("GrammarSettings","3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Xa.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));
this.addCommandToMaps(Object.assign(new Xa.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Xa.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Xa.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Xa.a("IncreaseIndent","4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentFirstLine","682091331"),
{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));this.addCommandToMaps(Object.assign(new Xa.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));
this.addCommandToMaps(Object.assign(new Xa.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertEmoji",
"2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new Fh("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Xa.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertPicture",
"2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Xa.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Xa.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new Fh("1256496096",
!0),a));let b;this.addCommandToMaps((b=new Xa.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Xa.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new Xa.a("Justify","1733835213"),f.legacyControlId="FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Xa.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",
l));let u;this.addCommandToMaps((u=new Xa.a("LineSpacing","2222099814"),u.legacyControlId="flyLineSpacing",u.populationProps=new Fh("2818132660",!0),u));let I;this.addCommandToMaps((I=new Xa.a("LineSpacingOptions","2465215107"),I.legacyControlId="grpParagraphDialogLauncherButton",I));let T;this.addCommandToMaps((T=new Xa.a("LockAspectRatio","3369422509"),T.legacyControlId="toggleBtnLockAspectRatio",T.queryCommandId="4201275867",T));let ja;this.addCommandToMaps((ja=new Xa.a("Margins","1451516907"),
ja.legacyControlId="flyMargins",ja));let ua;this.addCommandToMaps((ua=new Xa.a("MergeCells","4127468093"),ua.legacyControlId="btnMergeTableCells",ua));this.addCommandToMaps(new Xa.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Xa.a("MoreStyles","3340688468"));let Ra;this.addCommandToMaps((Ra=new Xa.a("MoreSymbols","3574218963"),Ra.legacyControlId="btnMoreSymbols",Ra));let eb;this.addCommandToMaps((eb=new Xa.a("MultilevelStyle1","3062940477"),eb.queryCommandId="1240192421",eb.menuItemId="MultilevelStyleMultilevelLibrary_1",
eb));let Bb;this.addCommandToMaps((Bb=new Xa.a("MultilevelStyle2","3062940477"),Bb.queryCommandId="1240192421",Bb.menuItemId="MultilevelStyleMultilevelLibrary_2",Bb));let Ub;this.addCommandToMaps((Ub=new Xa.a("MultilevelStyle3","3062940477"),Ub.queryCommandId="1240192421",Ub.menuItemId="MultilevelStyleMultilevelLibrary_3",Ub));let Xb;this.addCommandToMaps((Xb=new Xa.a("NoHighlight","562361573"),Xb.legacyControlId="noFontBackgroundColor",Xb));let tc;this.addCommandToMaps((tc=new Xa.a("NumberingLibrary",
"2213049770"),tc.queryCommandId="3488367157",tc.populationProps=new Fh("3149136033",!1),tc));let lc;this.addCommandToMaps((lc=new Xa.a("Orientation","1451516907"),lc.legacyControlId="flyOrientation",lc));let Ec;this.addCommandToMaps((Ec=new Xa.a("ParagraphOptions","2465215107"),Ec.legacyControlId="grpLayoutParagraphDialogLauncherButton",Ec));this.addCommandToMaps(new Xa.a(vq.Hel,"237279923"));let hd;this.addCommandToMaps((hd=new Xa.a(vq.Bel,"1656143904"),hd.legacyControlId="fseaNewPaste",hd));this.addCommandToMaps(new Xa.a(vq.Ael,
"1656143904"));let yd;this.addCommandToMaps((yd=new Xa.a("PageSize","1451516907"),yd.legacyControlId="flySize",yd));this.addCommandToMaps(new Xa.a("Photos","2670646631"));let Pd;this.addCommandToMaps((Pd=new Xa.a("PictureAbsoluteHeight","2808088361"),Pd.legacyControlId="spnAbsoluteHeight",Pd.queryCommandId="2181343285",Pd));let pe;this.addCommandToMaps((pe=new Xa.a("PictureAbsoluteWidth","3108736954"),pe.legacyControlId="spnAbsoluteWidth",pe.queryCommandId="1960824158",pe));this.addCommandToMaps(new Xa.a("Print",
"1588554917"));let Se;this.addCommandToMaps((Se=new Xa.a("PrintToWeb","1997662572"),Se.legacyControlId="jbtnDigitalPrint",Se));let vf;this.addCommandToMaps((vf=new Xa.a("ReadingView","3849298593"),vf.legacyControlId="btnReadingMode",vf));let ug;this.addCommandToMaps((ug=new Xa.a("Redo","4183277502"),ug.legacyControlId="btnRedo",ug));let Tg;this.addCommandToMaps((Tg=new Xa.a("ResetPicture","2916220093"),Tg.legacyControlId="btnResetPicture",Tg));let $f;this.addCommandToMaps(($f=new Xa.a("RightToLeftTextDirection",
"2632572640"),$f.legacyControlId="TextDirRTL",$f.queryCommandId="1154760330",$f));let Ve;this.addCommandToMaps((Ve=new Xa.a("RotatePictureMenu","2545543284"),Ve.legacyControlId="flyRotate",Ve));let xg;this.addCommandToMaps((xg=new Xa.a("RotateLeft90","2545543284"),xg.legacyControlId="buttonRotateLeft90",xg.menuItemId="buttonRotateLeft90",xg));let yg;this.addCommandToMaps((yg=new Xa.a("RotateRight90","2545543284"),yg.legacyControlId="buttonRotateRight90",yg.menuItemId="buttonRotateRight90",yg));let ng;
this.addCommandToMaps((ng=new Xa.a("SelectCell","111222446"),ng.legacyControlId="btnSelectCell",ng));let Wh;this.addCommandToMaps((Wh=new Xa.a("SelectColumn","2341852628"),Wh.legacyControlId="btnSelectColumn",Wh));let Ai;this.addCommandToMaps((Ai=new Xa.a("SelectRow","3508003794"),Ai.legacyControlId="btnSelectRow",Ai));let Wf;this.addCommandToMaps((Wf=new Xa.a("SelectTable","2306914518"),Wf.legacyControlId="btnSelectTable",Wf));let gg;this.addCommandToMaps((gg=new Xa.a("ShrinkFontSize","3575191971"),
gg.legacyControlId="fseaShrinkFontSize",gg));let vh;this.addCommandToMaps((vh=new Xa.a("SetProofingLanguage","510284732"),vh.legacyControlId="fseaOpenLanguageDialog",vh));let Zj;this.addCommandToMaps((Zj=new Xa.a("SpacingAfter","2322582597"),Zj.legacyControlId="spnSpacingAfter",Zj.queryCommandId="2340669283",Zj));let qj;this.addCommandToMaps((qj=new Xa.a("SpacingBefore","1804274502"),qj.legacyControlId="spnSpacingBefore",qj.queryCommandId="26138520",qj));let Ok;this.addCommandToMaps((Ok=new Xa.a("SpecialIndent",
"2798144440"),Ok.legacyControlId="flySpecialIndent",Ok));let Wl;this.addCommandToMaps((Wl=new Xa.a("Spelling","2646312425"),Wl.legacyControlId="fseaNextSpellingError",Wl));let Rm;this.addCommandToMaps((Rm=new Xa.a("StandardShadingColorPicker","2765388691"),Rm.legacyControlId="cellShadingColorTable",Rm));this.addCommandToMaps(new Xa.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Xa.a("RecentFontColorPicker","1970784898"));let Pk;this.addCommandToMaps((Pk=new Xa.a("Strikethrough",
"4169095173"),Pk.legacyControlId="fsbcStrikethrough",Pk.queryCommandId="2742230607",Pk));let Xl;this.addCommandToMaps((Xl=new Xa.a("StyleOptionsBandedColumns","1583455318"),Xl.legacyControlId="buttonBandedColumn",Xl.queryCommandId="1762426222",Xl.menuItemId="buttonBandedColumn",Xl));let wk;this.addCommandToMaps((wk=new Xa.a("StyleOptionsBandedRows","1583455318"),wk.legacyControlId="buttonBandedRow",wk.queryCommandId="1762426222",wk.menuItemId="buttonBandedRow",wk));let Qk;this.addCommandToMaps((Qk=
new Xa.a("StyleOptionsFirstColumn","1583455318"),Qk.legacyControlId="buttonFirstColumn",Qk.queryCommandId="1762426222",Qk.menuItemId="buttonFirstColumn",Qk));let qk;this.addCommandToMaps((qk=new Xa.a("StyleOptionsHeaderRow","1583455318"),qk.legacyControlId="buttonFirstRow",qk.queryCommandId="1762426222",qk.menuItemId="buttonFirstRow",qk));let Hl;this.addCommandToMaps((Hl=new Xa.a("StyleOptionsLastColumn","1583455318"),Hl.legacyControlId="buttonLastColumn",Hl.queryCommandId="1762426222",Hl.menuItemId=
"buttonLastColumn",Hl));let Qh;this.addCommandToMaps((Qh=new Xa.a("StyleOptionsTotalRow","1583455318"),Qh.legacyControlId="buttonLastRow",Qh.queryCommandId="1762426222",Qh.menuItemId="buttonLastRow",Qh));let Il;this.addCommandToMaps((Il=new Xa.a("Subscript","1455408143"),Il.legacyControlId="fsbcSubscript",Il.queryCommandId="3960255053",Il));let ym;this.addCommandToMaps((ym=new Xa.a("Superscript","1107614"),ym.legacyControlId="fsbcSuperscript",ym.queryCommandId="692901994",ym));let on;this.addCommandToMaps((on=
new Xa.a("Table","28738965"),on.legacyControlId="flyInsertTable",on));let ml;this.addCommandToMaps((ml=new Xa.a("TableStyles","4171428777"),ml.queryCommandId="2135594455",ml.populationProps=new Fh("3359297384",!1),ml.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),ml));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));
this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentLeftJustify","2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));
this.addCommandToMaps(Object.assign(new Xa.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Xa.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Xa.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Xa.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Xa.a("ThemeFontColorPickerMCU","1970784898"));this.addCommandToMaps(new Xa.a("ToggleChangeCase",
"1208649786"));this.addCommandToMaps(Object.assign(new Xa.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Xa.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Xa.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Xa.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Xa.a("EditInClient","3588168074"),{legacyControlId:"btnjEditInClient"}));
this.addCommandToMaps(Object.assign(new Xa.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let nl;this.addCommandToMaps((nl=new Xa.a("PrintDocument","1588554917"),nl.legacyControlId="jbtnDirectPrint",nl));let Bi;this.addCommandToMaps((Bi=new Xa.a("PrintToPdf","1588554917"),Bi.legacyControlId="jbtnPrintToPdf",Bi));let zg;this.addCommandToMaps((zg=new Xa.a("ProtectDocument","1642700244"),zg.legacyControlId="btnProtectDocument",zg.queryCommandId="3993403020",zg));let ci;this.addCommandToMaps((ci=
new Xa.a("TransformToWebPage","1997662572"),ci.legacyControlId="jbtnTransformToWeb",ci));let Oh;this.addCommandToMaps((Oh=new Xa.a("OpenInClientWithIcon","3588168074"),Oh.legacyControlId="btnOpenInClient",Oh));let Yd;this.addCommandToMaps((Yd=new Xa.a("BulletLibrary_MLR","3552651681"),Yd.queryCommandId="3827179399",Yd.populationProps=new Fh("2466004410",!1),Yd));let tf;this.addCommandToMaps((tf=new Xa.a("InsertPicture_MLR","2670646631"),tf.legacyControlId="fseaInsertPicture",tf));let Of;this.addCommandToMaps((Of=
new Xa.a("NumberingLibrary_MLR","2213049770"),Of.queryCommandId="3488367157",Of.populationProps=new Fh("3149136033",!1),Of));let De;this.addCommandToMaps((De=new Xa.a("PasteStandalone","237279923"),De.legacyControlId="fseaPaste",De));let nh;this.addCommandToMaps((nh=new Xa.a("Clipboard_MLR","237279923"),nh.legacyControlId="fseaNewPaste",nh));let Zi;this.addCommandToMaps((Zi=new Xa.a("InsertOnlinePictureStandalone","1685987254"),Zi.legacyControlId="fseaInsertOnlinePicture",Zi));let rj;this.addCommandToMaps((rj=
new Xa.a("InsertPictureFromHostStandalone","720118144"),rj.legacyControlId="fseaInsertOnlinePictureFromHost",rj.queryCommandId="3612507612",rj))}AZd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}vq.g9i="Cut";vq.P0i="Copy";vq.Hel="Paste";vq.Bel="PasteAsTextOnly";vq.Ael="PasteAsTextOnlyContextMenu";Object(m.a)(vq,"Box4ReactCommandDefinitionMapping",Iy,[]);class jk extends Wr{constructor(a,b,c){super();this.VCf=b;this.xn=c;this.qb(a)}qb(a){a.pa(G.a.Wrd,ta.a.application,
Object(R.a)(this,this.Suh,"populateContextMenu"),96);a.pa(G.a.Xuh,ta.a.application,Object(R.a)(this,this.Suh,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const u=this.bJj(a);if(u&&(a=a.Ua.node)&&(a=a.sc(Ha.InteractiveViewManager.instance.$d.Na))){l=ha.a.Nu(a,u.end);if(A.AFrameworkApplication.isRtl&&l.x>b.x||!A.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=ha.a.Nu(a,u.end-1);b.x=l.x+(A.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}Wr.xAd("mnuSpellingError",
new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}Suh(a,b,c,f,l){if(1===c)return 32;a=l.Gv;l=l.Bd;b=Object.assign(new Rn.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.H4i(b,a);l.MenuItems=b;return 32}sne(a,b){return this.lSh(a)||jk.XVf(G.a.mergeCells)||jk.XVf(G.a.splitCells)||this.P1l(a,b)||this.y_l(a,b)||jk.N0l()||jk.NRh(a).returnValue}lSh(a){return 2===ad.App.Ob.mode&&this.M7c(a)}W6b(a,b,c,f){f=void 0===f?null:f;if(this.lSh(a)){c=this.aJj(a);var l=Ea.a.Oe(c.lcid);l=l?
l.name:"UNKNOWN";var u=Object(gc.a)(Cp.a,c)?c.typeId:"";da.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,u,l);f?(a=this.VCf.S6b(a,c))&&f.push.apply(f,a):b.append(this.VCf.create(a,c))}}aJj(a){return this.xn.NVa(a.Ua).Rh}M7c(a){return this.xn.axc(a)}wig(){return null}bJj(a){return this.M7c(a)?this.xn.NVa(a.Ua):(a=this.wig(a))?new jm.a(a.IO,a.Pb):null}P1l(a,b){if(2!==ad.App.Ob.mode||!a||!jk.xmk&&this.Q1l(a,b))return!1;a=
ud.a.YTa(a.toArray());return!!jk.Dn.D9(a,14)}Q1l(a,b){return 2===b||3===b&&!this.M7c(a)}y_l(a,b){return 3!==b||this.M7c(a)}static get eg(){return jk.qh||(jk.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static get Dn(){return Uh.ContextSetEditor.instance}static get xmk(){return 1===ad.App.mode}static get Ujk(){null==jk.qOd&&(jk.qOd=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return jk.qOd}static get jqc(){null==jk.v5a&&
(jk.v5a=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("MultiParagraphHyperlinkEditEnabled"):!1);return jk.v5a}static get iU(){null==jk.kO&&(jk.kO=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return jk.kO}static XVf(a){return 32===A.AFrameworkApplication.Pa.nb(a,1)}static N0l(){return 2===ad.App.Ob.mode&&!!ad.App.WE.zU&&ad.App.WE.zU.bFg("510284732")}static NRh(a){let b,c;b=c=!1;if(!a)return{returnValue:!1,
SWa:b,ddc:c};if(jk.jqc)return jk.A0l(a);if(!(a.zea||jk.Ujk&&2===a.length&&a.vf.contextId===ta.a.endOfParagraph))return{returnValue:!1,SWa:b,ddc:c};a=a.Ua.clone();b=32===A.AFrameworkApplication.Pa.Ai(a,G.a.PLa,1,!0,null,null);c=32===A.AFrameworkApplication.Pa.Ai(a,G.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,SWa:b,ddc:c}}static A0l(a){let b;let c;var f=a.Ua.clone();c=jk.iU&&We.m(f);b=!c&&32===A.AFrameworkApplication.Pa.Ai(f,G.a.PLa,1,!0,null,null);if(a.zea||2===a.length&&a.vf.contextId===
ta.a.endOfParagraph)f=!c&&32===A.AFrameworkApplication.Pa.Ai(f,G.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let u=0;u<l;u++){const I=a.ga(u).clone();if(I.contextId===ta.a.paragraph||I.contextId===ta.a.textRange)(c=jk.iU&&We.m(I))||(f=32===A.AFrameworkApplication.Pa.Ai(I,G.a.insertHyperlink,1,!0,null,null)&&f);else if(I.contextId!==ta.a.endOfParagraph)return f=b=!1,{returnValue:!1,SWa:b,ddc:f}}}return{returnValue:b||f,SWa:b,ddc:f}}static T3i(a,b){let c,f=jk.NRh(a);({SWa:a,ddc:c}=
f);f.returnValue&&(a?c?b.push(jk.Uie(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(jk.Uie(["OpenHyperlink"])):c&&b.push(jk.Uie(["InsertLink"])))}static Uie(a){const b=Object.assign(new dl.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:c}));return b}}jk.qOd=null;jk.qh=null;jk.v5a=null;jk.kO=null;Object(m.a)(jk,"AEditSurfaceContextMenu",Wr,[]);class aC extends jk{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){super(a,
c,b,void 0,Ra);this.uga=0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("errorRangeEditor");if(!c)throw Error.argumentNull("proofingContextMenuSectionFactory");if(!f)throw Error.argumentNull("contextMenuHelper");if(!l)throw Error.argumentNull("contextSetEditor");if(!u)throw Error.argumentNull("applicationSettings");if(!I)throw Error.argumentNull("presenceContextMenuSectionBuilder");if(!T)throw Error.argumentNull("presenceManager");if(!ja)throw Error.argumentNull("presReader");
if(!ua)throw Error.argumentNull("selectionManager");this.wDe=f;this.PIa=l;this.ka=u;this.nid=this.ka.ZNb;this.xkc=this.ka.tdc;this.jdh=this.ka.f9c;this.qdh=this.ka.jye;this.V_a=this.ka.enb;this.RHk=this.ka.ytc;this.D7g=Ra;this.bE=b;this.A9g=I;this.AF=T;this.Tb=ja;this.oa=ua;this.oHb=Object(md.a)("FixContextMenus")}H4i(a,b){const c=[];switch(this.uga){case 4:this.Fka(c,!0);this.qKf(c);this.hui(c);this.Cui(c);this.V_a&&this.Rvi(c);this.L2b(c);this.YDa(c);break;case 7:case 8:case 13:case 23:case 15:case 11:case 14:case 16:this.Fka(c,
!1);this.XNc(c,this.uga);this.oHb&&8!==this.uga&&14!==this.uga||this.L2b(c);this.YDa(c);this.pyb(c);this.ka.yNc&&7===this.uga&&this.rJf(c);break;case 6:case 5:this.ka.ebf&&this.BKf(c);this.Fka(c,!1);this.XNc(c,this.uga);this.ka.ZNb&&this.ka.POh&&this.nKf(c);this.YDa(c);this.pyb(c);this.ka.yNc&&this.rJf(c);break;case 2:this.Fka(c,!0);this.YNc(c,!0);this.ka.Cm&&this.WNc(c);break;case 1:this.Fka(c,!1);this.YNc(c,!1);this.ka.BVh&&this.swi(c);this.qKf(c);this.gKf(c);Ny.KPh&&this.UKf(c);this.ka.Cm&&this.WNc(c);
this.L2b(c);this.YDa(c);this.pyb(c);break;case 3:this.Osi(c);this.pyb(c);break;case 19:this.lwi(c);this.YNc(c,!1);this.gKf(c);Ny.KPh&&this.UKf(c);A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewSectionMenuEnabled")&&this.WNc(c);this.L2b(c);break;case 21:this.axi(c);break;case 20:this.Fka(c,!0);this.YNc(c,!0);A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewSectionMenuEnabled")&&this.WNc(c);this.L2b(c);break;case 9:this.Fka(c,!1);this.YDa(c);break;case 24:case 25:case 26:this.oHb&&
(this.Fka(c,!1),this.XNc(c,this.uga),this.YDa(c));break;case 22:this.Fka(c,!1);this.XNc(c,this.uga);this.YDa(c);break;case 10:this.Fka(c,!1);this.cvi(c);this.YDa(c);this.pyb(c);break;case 17:this.Yui(c);break;case 18:this.Zui(c);break;case 0:if(this.Tb.Hi()){this.ka.ebf&&this.BKf(c);var f=Ha.InteractiveViewManager.instance.$d.Rb.Oa.kb;this.W6b(f,null,b,c);this.Fka(c,!1);this.ka.powerPointSmartLookupIsEnabled&&(this.kwi(c),this.wwi(c));3===b&&this.Elk(f)&&this.Iti(c);this.svi(c);jk.T3i(f,c);this.B7i(f,
c);this.A7i(f,c);this.nid&&this.nKf(c);this.y2i(c);this.YDa(c);this.pyb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.uga=0}DLh(a){this.uga=a}eu(){return Object.assign(new dl.a,{ControlList:[]})}O1l(a){if(!this.jdh&&!this.qdh||2!==ad.App.Ob.mode)return!1;a=ud.a.YTa(a.toArray());return!!this.PIa.D9(a,14)}N1l(a){if(!a||!this.RHk||2!==ad.App.Ob.mode)return!1;a=ud.a.YTa(a.toArray());return!!this.PIa.D9(a,14)}Fka(a,b){const c=this.eu();b||(Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"Cut"})),
Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"Copy"})));this.zKf(a,c)}zKf(a,b){const c=Object.assign(new dl.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new gr.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);
for(let l=1;5>=l;l++)f.GalleryItems.push(this.AAb(l));a.push(b);a.push(c)}AAb(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;
break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new bG.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}axi(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"CopyInVersionHistory"}));
a.push(b)}lwi(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"Copy"}));this.zKf(a,b)}YNc(a,b){const c=this.eu();Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"DeleteSlide"})));a.push(c)}hui(a){const b=this.eu();b.ControlList.push(Object.assign(new Eg.a,
{ExternalId:"FormatBackground"}));a.push(b)}rJf(a){const b=this.eu();b.ControlList.push(Object.assign(new Eg.a,{ExternalId:"AddAnimationInContextMenu"}));a.push(b)}Osi(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}gKf(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"HideSlide"}));this.ka.joe&&Array.add(b.ControlList,Object.assign(new Eg.a,
{ExternalId:"UnhideSlide"}));a.push(b)}UKf(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"ShareSlide"}));a.push(b)}Zui(a){const b=this.Chg();a.push(b)}WNc(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"AddSection"}));a.push(b)}XNc(a,b){const c=this.eu();7===b?(this.ka.qMa?Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"ChangePicture"})),
this.ka.JSa&&this.iui(c)):13===b?this.ka.qMa&&Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"SmartArtEditText"})):(this.oHb&&(5===b||6===b)||!this.oHb&&14!==b&&15!==b&&16!==b&&22!==b)&&Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"BeginEditShapeText"}));if(this.oHb){var f=this.oa.rf();if(11==b||10==b||26==b||0<f.length&&f[0].Rg)this.bZd(c),this.ka.X9b&&this.XYd(c)}else 22!==b&&
(this.bZd(c),this.ka.X9b&&this.XYd(c));14!==b&&(f=new Eg.a,f.ExternalId="AlternativeText",c.ControlList.push(f));!this.ka.yfk||5!==b&&6!==b||(b=new Eg.a,b.ExternalId="ChangeShapesAll",c.ControlList.push(b));this.MJf(c);this.BRf(c);this.NKh(c);a.push(c)}qKf(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:this.ka.j2a?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}nKf(a){const b=this.eu();if(this.xkc){var c=this.oa.rf();if(!this.oHb||0<c.length&&c[0].hasText)c=new Eg.a,
c.ExternalId="ImmersiveReader",Array.add(b.ControlList,c)}Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}L2b(a){if(this.xkc){var b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}NKh(a){Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"SendToBackFlyout"}))}BRf(a){Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"BringToFrontFlyout"}))}bZd(a){Array.add(a.ControlList,Object.assign(new Eg.a,
{ExternalId:"GroupAnchor"}))}MJf(a){Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"ShowHideFormatShapePane"}))}iui(a){Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"FormatPicture"}))}XYd(a){Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"FixIt"}))}cvi(a){const b=this.eu();this.bZd(b);this.ka.X9b&&this.XYd(b);this.MJf(b);this.BRf(b);this.NKh(b);const c=new Eg.a;c.ExternalId="AlternativeText";b.ControlList.push(c);a.push(b)}YDa(a){const b=this.eu();Array.add(b.ControlList,
Object.assign(new Eg.a,{ExternalId:"InsertComment"}));a.push(b)}Cui(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"DesignerHome"}));a.push(b)}Rvi(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"ShowHideRuler"}));a.push(b)}b4i(){const a=this.wDe.f7i();return Object.assign(new Eg.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}kwi(a){const b=this.eu();Array.add(b.ControlList,this.b4i());a.push(b)}wwi(a){if(!this.wDe.gSi()){var b=
this.wDe.w7i();if(b){var c=this.eu();Array.add(c.ControlList,Object.assign(new Eg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}BKf(a){const b=this.eu();b.ControlList.push(Object.assign(new Eg.a,{ExternalId:"RecommendationContextMenuFlyout"}));a.push(b)}svi(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"ParagraphOptions"}));a.push(b)}Iti(a){const b=this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"Delete"}));a.push(b)}swi(a){const b=
this.eu();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"SummarizeSlides"}));a.push(b)}y2i(a){var b=Tb.a.instance.ub("PowerPointWebEditor.IContextMenuExtensibilityHandler");b&&(b=b.qsj())&&a.push(b)}B7i(a,b){a&&this.O1l(a)&&(a=this.eu(),this.jdh&&Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"MergeTableCells"})),this.qdh&&Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"SplitTableCells"})),b.push(a))}A7i(a,b){this.N1l(a)&&(a=this.eu(),Array.add(a.ControlList,Object.assign(new Eg.a,
{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"TableDistribute"})),b.push(a))}Elk(a){return this.bE.axc(a)}Yui(a){const b=this.Chg();Array.add(b.ControlList,Object.assign(new Eg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}Chg(){const a=this.eu();Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"MoveSectionUp"}));
Array.add(a.ControlList,Object.assign(new Eg.a,{ExternalId:"MoveSectionDown"}));return a}pyb(a){this.A9g&&this.A9g.S6b(this.H$b(),a)}H$b(){return this.AF.instance?this.AF.instance.H$b():[]}}Object(m.a)(aC,"EditSurfaceContextMenu",jk,[]);class RN{constructor(a,b,c,f,l,u,I,T,ja,ua){this.Unc=null;this.ZJb=0;this.ZP=b;this.nv=c;this.b6=f;this.zb=u;this.rHk=I;this.ia=ja;this.Hc=T;this.Hc.Fxi(Object(R.a)(this,this.Dlh,"onCUIStatusChanged"));this.Hc.iOc(Object(R.a)(this,this.ZV,"onFocusChanged"));this.Hc.oOc(Object(R.a)(this,
this.Skb,"onSetFocus"));this.gjd=ua}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Hc.AAl(Object(R.a)(this,this.Dlh,"onCUIStatusChanged"));this.Hc.mvd(Object(R.a)(this,this.ZV,"onFocusChanged"));this.Hc.t3e(Object(R.a)(this,this.Skb,"onSetFocus"))}initialize(){this.qb();this.CB()}ZV(){}Skb(a,b){b.qkb!==xc.a.aca||b.ONb===K.AFrame.akb||b.ONb.endsWith("/modal")||appChrome.api.enterKeytipMode()}scm(a){this.ZJb|=a;this.Unc||(this.Unc=new ne.a(0,1,0,Object(R.a)(this,this.vUl,"setTimeOutWithCurrentActionContext"),
90,"11"),this.Unc.gu=new Date,this.zb.Jb(this.Unc))}qb(){this.ia.pa(M.a.E3,wc.a.application,Object(R.a)(this,this.LXj,"handleOpenMenu"),64)}LXj(a,b,c,f,l){return this.E3(l)?32:8}vUl(a){$c.a.ajj(Object(R.a)(this,this.CB,"poll"),Object(gb.a)(Date,a.gu));this.Unc=null}Dlh(a,b){this.scm(b.R5l)}CB(){this.rHk.clearCache();0!==(this.ZJb&1)&&this.nv.CB();0!==(this.ZJb&2)&&this.ZP.CB();0!==(this.ZJb&4)&&this.b6.CB();this.ZJb=0}E3(a){return this.gjd.E3(a)}}Object(m.a)(RN,"CUIManager",null,[842,106]);var cG=
d(1297),dG=d(1269),TS=d(1108),eG=d(1128);class Vt{constructor(){this.italic=0;this.G9c=!1;this.underline=0;this.JW=this.wEd=!1;this.superscript=0;this.YBd=!1;this.subscript=0;this.TBd=!1;this.strikethrough=0;this.KBd=!1;this.hu=0;this.ZVc=!1;this.fontName=null;this.m$b=this.VCd=this.MYc=this.LYc=!1;this.highlight=0;this.d4c=!1;this.bold=this.italic=this.underline=this.strikethrough=this.hu=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.Yw=yf.Font.xck;this.rra=
-1;this.f2d=this.G9c=this.wEd=this.JW=this.YBd=this.TBd=this.KBd=this.ZVc=this.LYc=this.MYc=this.VCd=this.m$b=this.d4c=!1}}Object(m.a)(Vt,"FormattingData",null,[]);var fG=d(851),US=d(817);class pl{constructor(){this.Jm=this.Wpa=0;this.Bd=null;this.lE=!1;this.qM=null}}Object(m.a)(pl,"CuiEnabledInfo",null,[]);class Dh{constructor(){this.Jm=this.Wpa=0;this.Bd=null;this.lE=this.bxe=this.cxe=this.yY=this.pq=this.Tne=!1;this.qM=null}}Object(m.a)(Dh,"CuiExecuteInfo",null,[]);class VS{constructor(){this.rcf=
new qq.a;this.Pve=!1}}Object(m.a)(VS,"TextRangeStyleData",null,[]);class gh{constructor(){this.hb=new Md.a;this.Zc=new Md.a;this.stf=new Vt;this.ZBf=new fG.a;this.HMd=this.GMd=!1}initialize(){gh.dWh=gh.w8d();this.hb.$(G.a.undo,gh.Fdc);this.hb.$(G.a.redo,gh.Fdc);this.hb.$(G.a.ynd,gh.Fdc);this.hb.$(G.a.Xuh,gh.Zam);this.hb.$(G.a.openInClient,gh.Val);this.hb.$(N.a.close,gh.kVi);this.hb.$(G.a.PJ,gh.Rbj);this.hb.$(G.a.font,gh.Gee);this.hb.$(G.a.$q,Object(R.a)(this,this.zfe,"genericFontSizeExecuteBridge"));
A.AFrameworkApplication.fa.getBooleanAppSetting("FontPreviewEnabled")&&(this.hb.$(G.a.A7,gh.Gee),this.hb.$(G.a.fNa,gh.Gee),this.hb.$(G.a.sMa,Object(R.a)(this,this.zfe,"genericFontSizeExecuteBridge")),this.hb.$(G.a.M2a,Object(R.a)(this,this.KHl,"revertPreviewFontSizeExecuteBridge")));this.hb.$(G.a.bold,gh.oAb);this.hb.$(G.a.setItalic,gh.oAb);this.hb.$(G.a.underline,gh.oAb);this.hb.$(G.a.strikethrough,gh.oAb);this.hb.$(G.a.superscript,gh.oAb);this.hb.$(G.a.subscript,gh.oAb);this.hb.$(G.a.auc,Object(R.a)(this,
this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.kuc,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.Yuc,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.Ouc,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.Quc,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.r0e,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.Ruc,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));
this.hb.$(G.a.$sd,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.euc,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.atd,Object(R.a)(this,this.Fza,"queryFormattingExecuteBridge"));this.hb.$(G.a.F_e,Object(R.a)(this,this.Dnl,"queryFormatPainterExecuteBridge"));this.hb.$(G.a.luc,Object(R.a)(this,this.ltd,"queryParaFormattingExecuteBridge"));this.hb.$(G.a.zuc,Object(R.a)(this,this.ltd,"queryParaFormattingExecuteBridge"));this.hb.$(G.a.duc,Object(R.a)(this,
this.ltd,"queryParaFormattingExecuteBridge"));this.hb.$(G.a.fuc,Object(R.a)(this,this.ltd,"queryParaFormattingExecuteBridge"));this.hb.$(G.a.lC,gh.v$f);this.hb.$(G.a.My,gh.v$f);this.hb.$(N.a.A5d,gh.cuc);this.hb.$(G.a.CFb,gh.Fdc);this.Zc.$(G.a.iNb,gh.rVc);this.Zc.$(G.a.jNb,gh.rVc);this.Zc.$(G.a.Zsc,gh.rVc);this.Zc.$(G.a.Ysc,gh.rVc);this.Zc.$(G.a.auc,gh.Sza);this.Zc.$(G.a.kuc,gh.Sza);this.Zc.$(G.a.Yuc,gh.Sza);this.Zc.$(G.a.Ouc,gh.Sza);this.Zc.$(G.a.Quc,gh.Sza);this.Zc.$(G.a.r0e,gh.Sza);this.Zc.$(G.a.Ruc,
gh.Sza);this.Zc.$(G.a.$sd,gh.Sza);this.Zc.$(G.a.euc,gh.Sza);this.Zc.$(G.a.atd,gh.Sza);this.Zc.$(G.a.luc,gh.Yud);this.Zc.$(G.a.duc,gh.Yud);this.Zc.$(G.a.zuc,gh.Yud);this.Zc.$(G.a.fuc,gh.Yud);this.hb.$(G.a.zYf,Object(R.a)(this,this.mbk,"insertHyperLinkBridge"));this.hb.$(G.a.J5d,Object(R.a)(this,this.yYf,"commandingInputMethodExecuteBridge"));this.hb.$(G.a.DYf,Object(R.a)(this,this.yYf,"commandingInputMethodExecuteBridge"));this.hb.$(G.a.AYf,Object(R.a)(this,this.vbk,"insertOnLinePictureExecuteBridge"));
this.hb.$(G.a.BYf,Object(R.a)(this,this.Lbk,"insertSymbolBridge"));this.hb.$(G.a.CYf,Object(R.a)(this,this.tWi,"commandingInsertTableExecuteBridge"));this.hb.$(G.a.uWi,Object(R.a)(this,this.d_k,"navToPageExecuteBridge"));this.hb.$(G.a.xYf,gh.wYf);this.hb.$(G.a.I5d,gh.wYf);A.AFrameworkApplication.fa.getBooleanAppSetting("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Zc.$(N.a.mQb,gh.gLl)}clearCache(){this.stf=new Vt;this.ZBf=new fG.a;this.HMd=this.GMd=!1}Uig(a,b,c){const f=this.hb.ga(a);f?
c=f(a,b,c):(c=new Dh,c.Bd=b);c.Wpa=a;c.Jm||(c.Jm=gh.GVk(a));fh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&this.mWi(a,b)&&(c.Bd||(c.Bd={}),"object"===typeof c.Bd&&(c.Bd.MappedCommand=!0));return c}Q_c(a,b){b=void 0===b?null:b;const c=this.Zc.ga(a);b=c?c(a,b):new pl;b.Wpa=a;b.Jm||(b.Jm=a);return b}Fza(){const a=new Dh;a.Tne=this.HMd;this.HMd=!0;a.Jm=G.a.hOb;a.Bd=this.stf;a.yY=!0;return a}ltd(){const a=new Dh;a.Tne=this.GMd;
this.GMd=!0;a.Jm=G.a.Gza;a.Bd=this.ZBf;a.bxe=!0;a.yY=!0;return a}zfe(a,b){const c=new Dh;c.pq=!0;let f=0;({number:f}=Aa.a.Zdl(b.CommandValueId||b.Value,A.AFrameworkApplication.numberFormat));if(isNaN(f))return ad.App.Ob.Gf(),c.qM=!1,c;a===G.a.sMa&&(b[Tn.a.pca]=!1);c.Bd=gh.o7d(Math.floor(2*f),b);return c}KHl(a,b){a=new Dh;a.pq=!0;b[Tn.a.pca]=!1;a.Bd=gh.o7d(0,b);return a}yYf(a){var b={Visible:!0};a===G.a.J5d?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");
a=new dG.a(b,2);b=new Dh;b.Bd=a;return b}vbk(a,b){a=new Dh;const c=new W.DictionaryPropertySet;b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(Oe.a.bW,b);a.Bd=c;return a}mbk(a,b){a=new Dh;b.Source="CommandingInterface";a.Bd=b;return a}tWi(a,b){a=new Dh;a.pq=!0;const c=new XJ;c.rows=b.Row;c.columns=b.Col;a.Bd=c;return a}Lbk(a,b){a=new Dh;a.pq=!0;b=b.Value;a.Bd=new W.DictionaryPropertySet;const c=this.m2c(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=
String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',c);a.Bd=f;return a}d_k(a,b){a=new Dh;a.Bd=b.Value?b.Value:"";return a}Dnl(){const a=new Dh;a.Bd=Tb.a.instance.ub("Box4.IFormatPainter");a.yY=!0;return a}m2c(a){return gh.dWh[a.toString()]}mWi(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Zc.ga(a)||!!this.hb.ga(a);return!A.AFrameworkApplication.Pa.RU(a)&&b}static w8d(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",
6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static G3b(a,b){var c=Object(gb.a)(Vt,a.Bd),f=Object(gb.a)(fG.a,a.Bd);let l=!0;switch(a.Wpa){default:l=!1;break;case G.a.fyh:b[Xh.a.On]=!0;break;case G.a.auc:b[Xh.a.On]=1===c.bold;break;case G.a.kuc:b[Xh.a.On]=1===c.italic;break;case G.a.Yuc:b[Xh.a.On]=1===c.underline;break;case G.a.r0e:b[pI.a.On]=
1===c.subscript;break;case G.a.Quc:b[Xh.a.On]=1===c.subscript;break;case G.a.Ruc:b[Xh.a.On]=1===c.superscript;break;case G.a.Ouc:b[Xh.a.On]=1===c.strikethrough||1===c.hu;break;case G.a.$sd:b[Po.a.IsFreeForm]=!0;b[Po.a.Value]=void 0!==c.fontName&&null!==c.fontName?Od.a.yig(c.fontName,c.rra):"";break;case G.a.euc:a="";-1!==c.fontSize&&(a=Aa.a.ZYc(c.fontSize/2,0,A.AFrameworkApplication.numberFormat));b[Po.a.IsFreeForm]=!0;b[Po.a.Value]=a;break;case G.a.atd:if(void 0!==c.fontName&&null!==c.fontName){if(a=
1===c.bold,f=1===c.italic,a=Ca.FontUtils.Enl(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===c.fontName)a=Od.a.yig(c.fontName,c.rra),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=Ca.FontUtils.isMissingFont(void 0!==a.key&&null!==
a.key&&""!==a.key?a.key:a.name));b[uo.SelectedFont]=a;break;case G.a.luc:b[Xh.a.On]=1===f.tm;break;case G.a.duc:b[Xh.a.On]=2===f.tm;break;case G.a.zuc:b[Xh.a.On]=3===f.tm;break;case G.a.fuc:b[Xh.a.On]=6===f.tm;break;case G.a.F_e:if(c=Object(gb.a)(1534,a.Bd))b[Xh.a.On]=c.JM;case N.a.A5d:}return l}static v$f(){return new Dh}static cuc(a,b){a=new Dh;a.Bd=b;a.yY=!0;return a}static Fdc(a,b,c){a=new dG.a(b,c.InvocationMethod);b=new Dh;b.Bd=a;return b}static Zam(a,b){a=new dG.a(b,3);b=new Dh;b.Bd=a;return b}static Val(a,
b,c){a=new Dh;TS.a.wJg(c.CommandLocation)||26===c.CommandLocation||(a.Bd=!1);return a}static z_e(){const a=new Dh;a.Bd=new W.DictionaryPropertySet;a.yY=!0;return a}static Rbj(){const a=new Dh;a.Bd=new W.DictionaryPropertySet;return a}static kVi(){const a=new Dh;a.Bd=hb.b;return a}static rVc(){const a=new pl;a.Bd=new W.DictionaryPropertySet;return a}static gLl(a,b){b=void 0===b?null:b;a=new pl;a.Bd=b;return a}static oAb(){const a=new Dh;a.Bd=new Q(2);a.pq=!0;return a}static Yud(){const a=new pl;a.Jm=
G.a.Gza;return a}static Sza(){const a=new pl;a.Jm=G.a.hOb;return a}static Gee(a,b){const c=new Dh;c.pq=!0;var f=b.CommandValueId?b.CommandValueId:b.Value;c.Bd=f;if(yf.Font.UXa()){const u=new Vt;var l=b.MenuItemId;l&&(u.rra=yf.Font.HPj(l));(l=Object(gb.a)(US.a,b[uo.Formatting]))&&(l.isBold||l.isItalic)&&(u.bold=l.isBold?1:0,u.italic=l.isItalic?1:0);u.fontName=f;c.Bd=u}gh.xAk(b);(a=A.AFrameworkApplication.fa.getBooleanAppSetting("FontPreviewEnabled")&&(a===G.a.A7||a===G.a.fNa))&&(b[Tn.a.pca]=!1);c.Bd=
gh.o7d(c.Bd,b);a||(Ca.FontUtils.MNc(f),f=b[uo.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,f)));return c}static xAk(a){void 0!==a[Po.a.IsFreeForm]&&null!==a[Po.a.IsFreeForm]&&a[Po.a.IsFreeForm]?da.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&da.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static wYf(a,b){a=
new Dh;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.Bd=gh.dab(b);a.pq=!0;return a}static dab(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,4)+a.substring(0,2)}static GVk(a){switch(a){case G.a.J5d:return G.a.undo;case G.a.DYf:return G.a.redo;case G.a.CYf:return G.a.insertTable;case G.a.AYf:return G.a.F9;case G.a.BYf:return G.a.qXa;case G.a.zYf:return G.a.insertHyperlink;case G.a.xYf:return G.a.Jr;case G.a.I5d:return G.a.fT;default:return a}}static o7d(a,b){const c=new eG.a(a);
return A.AFrameworkApplication.za.mb.es?new eG.a(a,b[Tn.a.pca]):c}}gh.dWh={};Object(m.a)(gh,"CuiActionBridge",null,[]);class SN{constructor(){this.C0d=this.G3b=this.mYe=this.TYe=null}}Object(m.a)(SN,"GeneralCuiUserHooks",null,[]);var WS=d(507);class ax{constructor(){this.uW=this.e2a=null;this.menuItemId=0}}Object(m.a)(ax,"QueryData",null,[]);let Tf;class Qd extends gh{constructor(a,b,c,f,l,u,I,T,ja){super();this.XQi=(ua,Ra)=>{ua=new Dh;ua.Bd=parseFloat(Ra[Ra.MenuItemId?"MenuItemId":"SourceControlId"]);
return ua};this.H2e=ua=>{let Ra;const eb=new Dh;(()=>{let Bb=this.vem(ua);({GZ:Ra}=Bb);return Bb})().returnValue&&(eb.lE=!0,eb.Jm=Ra);return eb};this.ka=a;this.oa=b;this.wFk=c;this.wJb=f;this.Cc=l;this.Tb=u;this.yb=I;this.PZa=T;if(!ja)throw Error.argumentNull("textPasteFloatieManager");this.oha=ja}initialize(){super.initialize();this.jak();this.d$j();this.Cak();this.B$j();this.nak();this.N9j();this.zak();this.T$j();this.Q9j();this.s$j();this.Z9j()}Q_c(a,b){b=void 0===b?null:b;if(A.AFrameworkApplication.fa.getBooleanAppSetting("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=
this.Zc.ga(a);b=c?c(a,b):new pl;b.Wpa=a;b.Jm||(b.Jm=a);b&&this.yb&&1===this.yb.$i&&!Qd.zue(a)&&(b.qM=!1);return b}(b=super.Q_c(a))&&this.yb&&1===this.yb.$i&&!Qd.zue(a)&&(b.qM=!1);return b}d$j(){this.Zc.$(M.a.lRc,this.umb.bind(this));this.Zc.$(M.a.oRc,this.umb.bind(this));this.Zc.$(M.a.wXc,this.umb.bind(this));this.Zc.$(M.a.tXc,this.umb.bind(this));this.Zc.$(M.a.vXc,this.umb.bind(this));this.Zc.$(M.a.uXc,this.umb.bind(this));this.Zc.$(M.a.xXc,this.umb.bind(this));this.hb.$(M.a.lRc,this.vmb.bind(this));
this.hb.$(M.a.oRc,this.vmb.bind(this));this.hb.$(M.a.wXc,this.vmb.bind(this));this.hb.$(M.a.tXc,this.vmb.bind(this));this.hb.$(M.a.vXc,this.vmb.bind(this));this.hb.$(M.a.uXc,this.vmb.bind(this));this.hb.$(M.a.xXc,this.vmb.bind(this))}umb(a,b){const c=new pl;b.originalActionId=a;c.Jm=M.a.Gme;c.Bd=b;c.Wpa=a;c.lE=!1;return c}vmb(a,b){const c=new Dh;b.originalActionId=a;c.Jm=M.a.Gme;c.Bd=b;c.Wpa=a;return c}jak(){this.Zc.$(M.a.ONa,Object(R.a)(this,this.Dvc,"remapRumTrackerEnabledBridge"));this.Zc.$(M.a.MNa,
Object(R.a)(this,this.Dvc,"remapRumTrackerEnabledBridge"));this.Zc.$(M.a.Dia,Object(R.a)(this,this.Dvc,"remapRumTrackerEnabledBridge"));this.Zc.$(M.a.NAa,Object(R.a)(this,this.Dvc,"remapRumTrackerEnabledBridge"));this.Zc.$(M.a.HCc,Object(R.a)(this,this.Dvc,"remapRumTrackerEnabledBridge"))}Cak(){this.hb.$(M.a.pOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.tOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.wOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));
this.hb.$(M.a.AMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.BMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.DMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.Wlb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.GMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.FMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.EMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.Ulb,
Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.Vlb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.qOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.uOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.CMa,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.Xlb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.sOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.rOb,Object(R.a)(this,this.OF,
"remapTextQueryExecute"));this.hb.$(M.a.b0e,Qd.qf);this.hb.$(M.a.vOb,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.Iza,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.f0e,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.qtd,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.c2a,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.hb.$(M.a.d2a,Object(R.a)(this,this.OF,"remapTextQueryExecute"));this.Zc.$(M.a.pOb,Object(R.a)(this,this.Qx,
"remapTextQueryEnabled"));this.Zc.$(M.a.tOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.wOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.AMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.BMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.DMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.Wlb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.GMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));
this.Zc.$(M.a.FMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.EMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.Ulb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.Vlb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.qOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.uOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.CMa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.Xlb,
Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.sOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.rOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.vOb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.Iza,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.f0e,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.qtd,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.c2a,Object(R.a)(this,this.Qx,
"remapTextQueryEnabled"));this.Zc.$(M.a.d2a,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.hb.$(M.a.oNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.uNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.HNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.zza,Object(R.a)(this,this.K9c,"justifyExecuteBridge"));this.hb.$(M.a.Bza,Object(R.a)(this,this.K9c,"justifyExecuteBridge"));this.hb.$(M.a.Dza,Object(R.a)(this,this.K9c,"justifyExecuteBridge"));this.hb.$(M.a.I1a,
Object(R.a)(this,this.K9c,"justifyExecuteBridge"));this.hb.$(M.a.G1a,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.yNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.BNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.H1a,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.zNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.CNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.Blb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.xlb,
Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.S2,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.R2,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.Q2,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.ENb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.wNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.Alb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.mtc,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.xNb,
Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.ntc,Qd.QIg);this.hb.$(M.a.otc,Qd.QIg);this.hb.$(M.a.eqa,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.nMa,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.FRb,Object(R.a)(this,this.RIg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(M.a.qRb,Object(R.a)(this,this.RIg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(M.a.htc,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.itc,Object(R.a)(this,this.wu,
"remapTextExecute"));this.hb.$(M.a.Aza,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.tNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.jtc,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.sNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.ANb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.rtc,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.DNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.insertHyperlink,Object(R.a)(this,
this.vyl,"remapInsertHyperlinkExecute"));this.hb.$(M.a.Cza,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.ylb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.FNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.hb.$(M.a.GNb,Object(R.a)(this,this.wu,"remapTextExecute"));this.Zc.$(M.a.oNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.uNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.HNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.zza,
Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.Bza,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.Dza,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.I1a,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.G1a,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.yNb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.BNb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.H1a,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));
this.Zc.$(M.a.zNb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.CNb,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.Zc.$(M.a.Blb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.xlb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.S2,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.R2,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.Q2,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.ENb,Object(R.a)(this,this.Ut,"remapTextEnabled"));
this.Zc.$(M.a.wNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.Alb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.mtc,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.xNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.eqa,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.nMa,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.htc,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.itc,Object(R.a)(this,this.Ut,"remapTextEnabled"));
this.Zc.$(M.a.Aza,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.tNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.jtc,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.sNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.ANb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.rtc,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.DNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.Cza,Object(R.a)(this,this.Ut,"remapTextEnabled"));
this.Zc.$(M.a.ylb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.insertHyperlink,Object(R.a)(this,this.uyl,"remapInsertHyperlinkEnabled"));this.Zc.$(M.a.c2a,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.d2a,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.FNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.GNb,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.c2a,Object(R.a)(this,this.Ut,"remapTextEnabled"));this.Zc.$(M.a.d2a,Object(R.a)(this,
this.Ut,"remapTextEnabled"))}B$j(){this.hb.$(M.a.N_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"));this.hb.$(M.a.H_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"));this.hb.$(M.a.K_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"));this.hb.$(M.a.I_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"));this.hb.$(M.a.L_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"));this.hb.$(M.a.M_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"));
this.hb.$(M.a.J_e,Object(R.a)(this,this.Slb,"queryInkControlToggledExecuteBridge"))}nak(){this.hb.$(M.a.Fuc,Qd.qf);this.hb.$(M.a.Guc,Qd.qf);this.hb.$(M.a.Iuc,Qd.qf);this.hb.$(M.a.ytd,Qd.qf);this.hb.$(M.a.xtd,Qd.qf);this.hb.$(M.a.ztd,Qd.qf);this.hb.$(M.a.Atd,Qd.qf);this.hb.$(M.a.Ctd,Qd.qf);this.hb.$(M.a.wtd,Qd.qf);this.hb.$(M.a.Etd,Qd.qf);this.hb.$(M.a.Btd,Qd.qf);this.hb.$(M.a.Ktd,Qd.qf);this.hb.$(M.a.Jtd,Qd.qf);this.hb.$(M.a.Itd,Qd.qf);this.hb.$(M.a.$lb,Qd.qf);this.hb.$(M.a.amb,Qd.qf);this.hb.$(M.a.a2a,
Object(R.a)(this,this.ftd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(M.a.b2a,Object(R.a)(this,this.ftd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(M.a.DOb,Qd.qf);this.hb.$(M.a.COb,Qd.qf);this.hb.$(M.a.Huc,Qd.qf);this.hb.$(M.a.Gtd,Qd.qf);this.hb.$(M.a.Htd,Qd.qf);this.Zc.$(M.a.Unb,Qd.Ez);this.Zc.$(M.a.Vnb,Qd.Ez);this.Zc.$(M.a.oRb,Qd.Ez);this.Zc.$(M.a.gob,Qd.Ez);this.Zc.$(M.a.HRb,Qd.Ez);this.Zc.$(M.a.p9e,Qd.Ez);this.hb.$(M.a.Unb,Object(R.a)(this,this.gqj,"fontNameExecuteBridge"));this.hb.$(M.a.Vnb,
Object(R.a)(this,this.zfe,"genericFontSizeExecuteBridge"));this.hb.$(M.a.oRb,Qd.$cf);this.hb.$(M.a.gob,Qd.$cf);this.hb.$(M.a.HRb,Qd.$cf);this.Zc.$(M.a.VOf,Qd.H3a);this.Zc.$(M.a.WOf,Qd.H3a);this.Zc.$(M.a.APc,Qd.H3a);this.Zc.$(M.a.xPc,Qd.H3a);this.Zc.$(M.a.zPc,Qd.H3a);this.Zc.$(M.a.yPc,Qd.H3a);this.Zc.$(M.a.B0d,Qd.H3a);this.Zc.$(M.a.r0d,Qd.H3a);this.hb.$(M.a.gzd,Qd.IIg);this.hb.$(M.a.$1a,Qd.tyh);this.hb.$(M.a.Dtd,Qd.tyh);this.hb.$(M.a.Ypa,Qd.IIg)}N9j(){this.hb.$(M.a.wk,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));
this.hb.$(M.a.lqa,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.Lza,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.POb,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.fmb,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.Xtd,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.Kza,Qd.eW);this.hb.$(M.a.Jk,Object(R.a)(this,this.LDd,
"transitionExecuteBridge"));this.hb.$(M.a.aob,Object(R.a)(this,this.LDd,"transitionExecuteBridge"));this.Zc.$(M.a.Jk,Qd.Ez);this.Zc.$(M.a.Vqa,Qd.Ez);this.Zc.$(M.a.AAa,Qd.Ez);this.Zc.$(M.a.Txc,Qd.Ez);this.Zc.$(M.a.bob,Qd.Ez);this.hb.$(M.a.jqa,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.W1a,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.X1a,Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.kqa,
Object(R.a)(this,this.Jza,"queryQueryTransitionResultExecuteBridge"));this.hb.$(M.a.Tx,Object(R.a)(this,this.LDd,"transitionExecuteBridge"));this.hb.$(M.a.PQb,Object(R.a)(this,this.LDd,"transitionExecuteBridge"));this.Zc.$(M.a.Tx,Qd.Ez);this.Zc.$(M.a.rAa,Qd.Ez);this.Zc.$(M.a.PQb,Qd.Ez);this.Zc.$(M.a.SQb,Qd.Ez);this.Zc.$(M.a.j3a,Qd.Ez);this.hb.$(M.a.yMa,Qd.eW);this.Zc.$(M.a.QQb,Qd.Ez);this.Zc.$(M.a.h3a,Qd.Ez);this.hb.$(M.a.zMa,Qd.eW);this.Zc.$(M.a.RQb,Qd.Ez);this.Zc.$(M.a.i3a,Qd.Ez);this.Zc.$(M.a.q3b,
Qd.Ez);this.hb.$(M.a.eOb,Qd.qf);this.Zc.$(M.a.nyd,Qd.Ez);this.Zc.$(M.a.oyd,Qd.Ez);this.Zc.$(M.a.pyd,Qd.Ez);this.Zc.$(M.a.qyd,Qd.Ez)}zak(){this.hb.$(G.a.LOb,gh.z_e);this.hb.$(M.a.g0e,gh.z_e);this.hb.$(M.a.IOb,Qd.eW);this.hb.$(M.a.JOb,Qd.eW);this.hb.$(M.a.Wuc,Qd.eW);this.hb.$(M.a.Vtd,Qd.eW);this.hb.$(M.a.Tuc,Qd.eW);this.hb.$(M.a.Uuc,Qd.eW);this.hb.$(M.a.Vuc,Qd.eW);this.hb.$(M.a.Suc,Qd.eW);this.hb.$(M.a.ktc,Object(R.a)(this,this.Xud,"remapTableExecute"));this.hb.$(G.a.S9,Object(R.a)(this,this.Xud,"remapTableExecute"));
this.hb.$(G.a.uQb,Object(R.a)(this,this.Xud,"remapTableExecute"));this.hb.$(G.a.insertTable,Object(R.a)(this,this.Xud,"remapTableExecute"));this.Zc.$(G.a.insertTable,Object(R.a)(this,this.jSi,"checkInsertTableRibbonEnabledBridge"));this.Zc.$(G.a.S9,Object(R.a)(this,this.yxb,"checkWholeTableLockEnabledBridge"));this.Zc.$(G.a.y0,Object(R.a)(this,this.yxb,"checkWholeTableLockEnabledBridge"));this.Zc.$(G.a.oU,Object(R.a)(this,this.yxb,"checkWholeTableLockEnabledBridge"));this.Zc.$(M.a.svh,Object(R.a)(this,
this.yxb,"checkWholeTableLockEnabledBridge"));this.Zc.$(M.a.y7,Object(R.a)(this,this.yxb,"checkWholeTableLockEnabledBridge"));this.Zc.$(M.a.pMa,Object(R.a)(this,this.yxb,"checkWholeTableLockEnabledBridge"));this.hb.$(G.a.y0,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(G.a.oU,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(G.a.J$a,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(M.a.utc,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));
this.hb.$(M.a.ttc,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(M.a.stc,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(M.a.y7,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(M.a.pMa,Object(R.a)(this,this.sTa,"checkSelectionBeforeExecute"));this.hb.$(M.a.H0e,Qd.qf);this.hb.$(M.a.I0e,Qd.qf);this.hb.$(M.a.J0e,Qd.qf);this.hb.$(M.a.K0e,Qd.qf);this.hb.$(M.a.L0e,Qd.qf);this.hb.$(M.a.M0e,Qd.qf);this.hb.$(M.a.N0e,Qd.qf);this.hb.$(M.a.O0e,Qd.qf);
this.hb.$(M.a.P0e,Qd.qf);this.hb.$(M.a.v0e,Qd.qf);this.hb.$(M.a.w0e,Qd.qf);this.hb.$(M.a.x0e,Qd.qf);this.hb.$(M.a.y0e,Qd.qf);this.hb.$(M.a.z0e,Qd.qf);this.hb.$(M.a.A0e,Qd.qf);this.hb.$(M.a.B0e,Qd.qf);this.hb.$(M.a.C0e,Qd.qf);this.hb.$(M.a.D0e,Qd.qf);this.hb.$(M.a.E0e,Qd.qf);this.hb.$(M.a.F0e,Qd.qf);this.hb.$(M.a.G0e,Qd.qf);this.hb.$(M.a.Ttd,Qd.qf);this.hb.$(M.a.Std,Qd.qf);this.hb.$(M.a.Rtd,Qd.qf);this.hb.$(M.a.Utd,Qd.qf)}T$j(){this.Zc.$(M.a.ttd,Qd.Ez);this.hb.$(M.a.ttd,Qd.qf);this.Zc.$(M.a.nte,Qd.tyl);
this.hb.$(M.a.mHa,Object(R.a)(this,this.erd,"parseSmartArtParametersBridge"));this.hb.$(M.a.j5b,Object(R.a)(this,this.erd,"parseSmartArtParametersBridge"));this.hb.$(M.a.k5b,Object(R.a)(this,this.erd,"parseSmartArtParametersBridge"));this.hb.$(M.a.hM,Object(R.a)(this,this.erd,"parseSmartArtParametersBridge"));this.Zc.$(M.a.Xsd,Qd.Ez);this.hb.$(M.a.Xsd,Qd.qf);this.hb.$(M.a.Nta,Object(R.a)(this,this.jRi,"changePictureStyleExecuteBridge"));this.hb.$(M.a.GOb,Qd.qf);this.hb.$(M.a.lOb,Qd.eW);this.hb.$(M.a.nOb,
Qd.eW);this.hb.$(M.a.mOb,Qd.eW);this.hb.$(M.a.ruc,Qd.eW);this.hb.$(M.a.x$a,this.XQi)}Q9j(){this.hb.$(M.a.Cyh,gh.z_e);this.hb.$(M.a.$tc,Qd.qf);this.hb.$(M.a.tuc,Qd.qf);this.hb.$(M.a.puc,Qd.qf);this.hb.$(M.a.Cuc,Qd.qf);this.hb.$(M.a.Duc,Qd.qf);this.hb.$(M.a.Buc,Qd.qf);this.hb.$(M.a.Euc,Qd.qf);this.hb.$(M.a.Nuc,Qd.qf);this.hb.$(M.a.suc,Qd.qf);this.hb.$(M.a.nuc,Qd.qf);this.hb.$(M.a.huc,Qd.qf);this.hb.$(M.a.yuc,Qd.qf)}s$j(){this.hb.$(M.a.Usd,Qd.qf);this.hb.$(M.a.ktd,Qd.qf);this.hb.$(M.a.wuc,Object(R.a)(this,
this.ftd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(M.a.xuc,Object(R.a)(this,this.ftd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(M.a.OOb,Qd.qf);this.hb.$(M.a.NOb,Qd.qf);this.hb.$(M.a.MOb,Qd.qf);this.hb.$(M.a.Ntd,Qd.qf);this.hb.$(M.a.wol,Qd.qf);this.hb.$(M.a.Fz,Qd.rtd);this.hb.$(M.a.Xuc,Qd.rtd);this.hb.$(M.a.Ftd,Qd.rtd);this.hb.$(M.a.btd,Qd.rtd);this.hb.$(M.a.Muc,Object(R.a)(this,this.wyl,"remapRumTrackerExecuteQueryBridge"));this.hb.$(M.a.jOb,Qd.qf);this.hb.$(M.a.vtd,gh.cuc);this.hb.$(M.a.jtd,
Qd.qf);this.hb.$(M.a.quc,Qd.qf);this.hb.$(M.a.fOb,Qd.qf);this.hb.$(M.a.AOb,Qd.qf);this.hb.$(M.a.HOb,Qd.qf);this.hb.$(M.a.W0e,gh.cuc);this.hb.$(M.a.Ptd,Qd.qf);this.hb.$(M.a.Otd,Qd.qf);this.hb.$(M.a.p0e,Qd.qf);this.hb.$(M.a.g2a,Qd.qf);this.hb.$(M.a.dmb,Qd.qf);this.hb.$(M.a.emb,Qd.qf);this.hb.$(M.a.cmb,Qd.qf);this.hb.$(M.a.bmb,Qd.qf);this.hb.$(M.a.xOb,Qd.qf);this.hb.$(M.a.EOb,Qd.qf);this.hb.$(M.a.yOb,Qd.qf);this.hb.$(N.a.cOb,gh.cuc);this.Zc.$(M.a.LWe,Qd.Ez);this.hb.$(M.a.ow,Qd.jBd);this.hb.$(M.a.AEa,
Qd.jBd);this.hb.$(M.a.cwb,Qd.jBd);this.hb.$(M.a.F3b,Qd.jBd);this.Zc.$(M.a.oeg,Qd.Hqj);this.hb.$(M.a.zc,Qd.Pnl);this.Zc.$(M.a.ptd,Qd.Ez);this.hb.$(M.a.ptd,Qd.qf);this.Zc.$(M.a.pVa,Object(R.a)(this,this.Qx,"remapTextQueryEnabled"));this.hb.$(M.a.HMa,gh.cuc);this.hb.$(M.a.m0e,Qd.qf);this.hb.$(M.a.Kuc,Qd.qf);this.hb.$(M.a.d0e,Qd.qf);this.hb.$(M.a.e0e,Qd.qf);this.hb.$(M.a.QOb,Qd.qf);this.hb.$(M.a.E_e,Qd.qf);this.hb.$(G.a.Wrd,gh.Fdc);this.hb.$(G.a.cut,Object(R.a)(this,this.AUc,"cutCopyPasteExecuteBridge"));
this.hb.$(G.a.copy,Object(R.a)(this,this.AUc,"cutCopyPasteExecuteBridge"));this.hb.$(G.a.paste,Object(R.a)(this,this.AUc,"cutCopyPasteExecuteBridge"));this.hb.$(G.a.O2,Object(R.a)(this,this.AUc,"cutCopyPasteExecuteBridge"));this.hb.$(G.a.openInClient,Object(R.a)(this,this.abl,"openInPowerPointExecuteBridge"));this.hb.$(G.a.etd,Qd.qf);this.hb.$(M.a.muc,Qd.qf);this.hb.$(M.a.vtc,Object(R.a)(this,this.yCh,"remapUndoRedoExecute"));this.hb.$(M.a.ptc,Object(R.a)(this,this.yCh,"remapUndoRedoExecute"));this.hb.$(M.a.qNb,
Object(R.a)(this,this.Wud,"remapCutCopyPasteExecute"));this.hb.$(M.a.pNb,Object(R.a)(this,this.Wud,"remapCutCopyPasteExecute"));this.hb.$(M.a.oMa,Object(R.a)(this,this.Wud,"remapCutCopyPasteExecute"));this.hb.$(M.a.zlb,Object(R.a)(this,this.Wud,"remapCutCopyPasteExecute"));this.hb.$(M.a.prd,this.H2e);this.hb.$(M.a.rrd,this.H2e);this.hb.$(M.a.qrd,this.H2e);this.Zc.$(M.a.vtc,Object(R.a)(this,this.xCh,"remapUndoRedoEnabled"));this.Zc.$(M.a.ptc,Object(R.a)(this,this.xCh,"remapUndoRedoEnabled"));this.Zc.$(M.a.qNb,
Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.Zc.$(M.a.pNb,Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.Zc.$(M.a.oMa,Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.Zc.$(M.a.zlb,Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.Zc.$(G.a.cut,Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.Zc.$(G.a.paste,Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.Zc.$(G.a.O2,Object(R.a)(this,this.tmb,"remapCutCopyPasteEnabled"));this.hb.$(G.a.fT,
Qd.UPf);this.hb.$(G.a.Jr,Qd.UPf);this.hb.$(G.a.qL,Object(R.a)(this,this.ZIg,"listsExecuteBridge"));this.hb.$(G.a.aO,Object(R.a)(this,this.ZIg,"listsExecuteBridge"));this.hb.$(M.a.R3a,Qd.u0l);this.hb.$(M.a.Plb,Qd.eW);this.hb.$(M.a.Qlb,Qd.eW);this.hb.$(M.a.BOb,Qd.qf);this.hb.$(M.a.gOb,Qd.qf);this.hb.$(M.a.guc,Qd.qf);this.hb.$(M.a.zOb,Qd.qf);this.ka.Ovb&&this.hb.$(M.a.Ztc,Qd.qf);this.hb.$(M.a.Juc,Qd.qf);this.hb.$(M.a.juc,Qd.qf);this.hb.$(M.a.ouc,Qd.qf);this.hb.$(M.a.dOb,Qd.qf)}Z9j(){this.Zc.$(M.a.syg,
Object(R.a)(this,this.f8b,"doPresentationCheckEnableRemap"));this.Zc.$(M.a.i4d,Object(R.a)(this,this.f8b,"doPresentationCheckEnableRemap"));this.Zc.$(M.a.d4d,Object(R.a)(this,this.f8b,"doPresentationCheckEnableRemap"));this.Zc.$(M.a.uyg,Object(R.a)(this,this.f8b,"doPresentationCheckEnableRemap"));this.Zc.$(M.a.zyg,Object(R.a)(this,this.f8b,"doPresentationCheckEnableRemap"))}f8b(a){const b=new pl;this.yb&&1===this.yb.$i&&!Qd.zue(a)?b.qM=!1:(b.lE=!0,b.Jm=M.a.Lab);return b}qyj(){const a=new SN;a.G3b=
Qd.Xhl;a.C0d=Qd.Yhl;a.TYe=Object(R.a)(this,this.xil,"powerPointPreExecCommand");a.mYe=null;return a}xil(a,b){var c=this.oa.Hd();c=1===c.length&&c[0].vd&&this.oa.nI()&&!c[0].VR;switch(a.Jm){case G.a.font:case G.a.A7:case G.a.fNa:case G.a.bold:case G.a.setItalic:case G.a.underline:case G.a.strikethrough:case G.a.Jr:case G.a.fT:case G.a.uea:case G.a.OG:case G.a.rH:case G.a.sMa:case G.a.M2a:case G.a.lC:case G.a.My:case G.a.qL:case G.a.aO:case G.a.rea:case G.a.ega:case G.a.pia:case G.a.Yua:case M.a.Ypa:case M.a.S2:case M.a.R2:case M.a.Q2:case G.a.pFa:case G.a.Sma:case G.a.dBa:case G.a.eBa:case G.a.fBa:case G.a.lOa:case G.a.mOa:case G.a.oU:case G.a.y0:case M.a.y7:case M.a.pMa:case M.a.D3a:case M.a.ENa:case M.a.Uqa:case M.a.FNa:case M.a.mBd:case M.a.lBd:b||
(b={}),b[Ii.a.pNc]=!(this.oa.kYa()||c),b[Ii.a.TIf]=!!this.oa.Fma()}return null}RIg(a,b,c){const f=new Dh;b=b.MenuItemId;f.Bd=this.BQe(b,a);b&&ya.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}BQe(a,b){a=a?parseInt(a):-1;switch(b){case M.a.FRb:case G.a.qL:case M.a.wuc:case M.a.a2a:return this.wJb.Cbc(a);case M.a.qRb:case G.a.aO:case M.a.xuc:case M.a.b2a:return this.wJb.t2c(a);default:return 18}}gqj(a,b){a=new Dh;a.Bd=b.CommandValueId;return a}ftd(a,b){const c=
new Dh,f=new ax;f.e2a=new Di.a;f.menuItemId=this.BQe(b.MenuItemId,a);c.Bd=f;c.yY=!0;return c}Jza(a,b){a=new Dh;const c={};c.queryResult=new Di.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.Bd=c;a.yY=!0;return a}LDd(a,b){a=new Dh;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.Bd=c;return a}jRi(a,b){a=new Dh;a.Bd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}Slb(a){const b=new Dh,c={},f=new Di.a;switch(a){case M.a.N_e:f.Rf(this.PZa.isEnabled(ie.iHa));break;case M.a.H_e:f.Rf(this.PZa.isEnabled(ie.Vva));break;case M.a.K_e:f.Rf(this.PZa.isEnabled(ie.C$));break;case M.a.I_e:f.Rf(this.PZa.isEnabled(ie.iY));break;case M.a.L_e:f.Rf(this.PZa.isEnabled(ie.jz));break;case M.a.M_e:f.Rf(this.PZa.isEnabled(ie.UA));break;case M.a.J_e:f.Rf(this.PZa.isEnabled(ie.TA));break;case M.a.pyh:f.Rf(this.PZa.isEnabled(ie.Zma))}c.queryResult=
f;b.Bd=c;b.yY=!0;return b}ZIg(a,b,c){const f=new Dh;f.Bd=new W.DictionaryPropertySet;b=b.MenuItemId;this.Wim(f.Bd,a,this.BQe(b,a));b&&ya.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}jSi(){return Object.assign(new pl,{Bd:new Di.a,qM:!!this.wFk.Aa})}yxb(){const a=new pl,b=this.oa.$n();if(!b)return a;this.Cc.bue(b)&&(a.lE=!1,a.qM=!1,a.Jm=ff.ActionManager.L8b);return a}Wim(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===G.a.qL?(l=f=1,this.wJb.i6c(c)&&(b=this.wJb.FYa.ga(c),
a.setValue(rb.a.Dj,[b.u4b]),a.setValue(rb.a.font,b.Kwb))):b===G.a.aO&&(f=0,l=1,a.setValue(rb.a.IYa,1),a.setValue(yb.a.autonumberBulletType,8),this.wJb.j6c(c)&&(b=this.wJb.Snd.ga(c),a.setValue(yb.a.autonumberBulletType,b.K1d),a.setValue(rb.a.Dj,[65533,b.Ujh,Aa.a.charCodeAt(b.$jh,0)])));a.setValue(Oe.a.pF,f);a.setValue(Oe.a.iga,l)}iEd(a){let b;if(this.bQh()||this.oa.Fma()){if((()=>{let c=Qd.dEd(a,this.oa.kz());({Le:b}=c);return c})().returnValue)return{returnValue:!0,GZ:b}}else if(this.dYl()&&(()=>
{let c=Qd.G_h(a);({Le:b}=c);return c})().returnValue)return{returnValue:!0,GZ:b};b=0;return{returnValue:!1,GZ:b}}ogf(a){let b;b=0;a===M.a.vtc?b=M.a.P1a:a===M.a.ptc&&(b=M.a.O1a);return{returnValue:!!b,GZ:b}}ngf(a){let b;b=0;this.bQh()?a===M.a.qNb?b=G.a.cut:a===M.a.pNb?b=G.a.copy:a===M.a.oMa?b=G.a.paste:a===M.a.zlb&&(b=G.a.O2):(a===M.a.qNb&&(b=M.a.Dyb),a===M.a.pNb?b=M.a.z6b:a===M.a.oMa?b=M.a.aqa:a===M.a.zlb&&(b=M.a.pasteAsPlainText));return{returnValue:!!b,GZ:b}}U_h(a){switch(a){case G.a.S9:return a=
M.a.rNb,{returnValue:!0,Le:a};case G.a.uQb:return a=M.a.CYe,{returnValue:!0,Le:a};case G.a.insertTable:return a=M.a.wvh,{returnValue:!0,Le:a}}a=ff.ActionManager.o7;return{returnValue:!1,Le:a}}wu(a){let b,c=new Dh;if((()=>{let f=this.yDb(a);({result:c}=f);return f})().returnValue)return c;(()=>{let f=this.iEd(a);({GZ:b}=f);return f})().returnValue&&(c.lE=!0,c.Jm=b);return c}wPh(a){switch(a){case M.a.H1a:case M.a.zNb:case M.a.CNb:case M.a.xlb:case M.a.Blb:case M.a.ylb:if(this.oa.nna()||this.oa.UM())return Object.assign(new pl,
{lE:!1,qM:!1});break;case M.a.sOb:case M.a.rOb:case M.a.yNb:case M.a.BNb:case M.a.G1a:if(this.oa.nna())return Object.assign(new pl,{lE:!1,qM:!1});break;case M.a.nMa:case M.a.eqa:case M.a.msd:case M.a.zza:case M.a.Bza:case M.a.Dza:case M.a.I1a:case M.a.ANb:case M.a.sNb:if(this.oa.UM())return Object.assign(new pl,{lE:!1,qM:!1});break;case M.a.DNb:case M.a.rtc:if(this.oa.UM()){var b=this.oa.Oa.kb;if(b)for(const c of b)if(c&&c.node&&(b=c.node.ra(ib.a.listLevel,0),a===M.a.DNb&&!b||qi.a.$Bg(c.node)))return Object.assign(new pl,
{lE:!1,qM:!1})}}return null}Ut(a){let b=new pl;if((()=>{let c=this.Tte(a);({result:b}=c);return c})().returnValue)return this.Tyd(b,a);b=this.wPh(a);if(!b){let c;b=new pl;(()=>{let f=this.iEd(a);({GZ:c}=f);return f})().returnValue&&(b.lE=!0,b.Jm=c)}return this.Tyd(b,a)}Dvc(a,b){const c={};c.OriginalActionId=a;c.Properties=void 0===b?null:b;return Object.assign(new pl,{Wpa:a,Jm:M.a.G5e,Bd:c})}wyl(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Dh,{Jm:M.a.G5e,Bd:c,yY:!0})}OF(a){let b,
c=new Dh;if((()=>{let f=this.yDb(a);({result:c}=f);return f})().returnValue)return c;(()=>{let f=this.iEd(a);({GZ:b}=f);return f})().returnValue?(c.lE=!0,c.Jm=b):(c.Bd=new Di.a,c.yY=!0);return c}Qx(a){let b=new pl;if((()=>{let c=this.Tte(a);({result:b}=c);return c})().returnValue)return this.Tyd(b,a);b=this.wPh(a);if(!b){let c;b=new pl;(()=>{let f=this.iEd(a);({GZ:c}=f);return f})().returnValue?(b.lE=!0,b.Jm=c):b.Bd=new Di.a}return this.Tyd(b,a)}yCh(a){let b;const c=new Dh;(()=>{let f=this.ogf(a);
({GZ:b}=f);return f})().returnValue&&(c.lE=!0,c.Jm=b);return c}xCh(a){let b;const c=new pl;(()=>{let f=this.ogf(a);({GZ:b}=f);return f})().returnValue&&(c.lE=!0,c.Jm=b);return c}uyl(){const a=new pl;a.lE=!0;a.Jm=M.a.wYe;return a}vyl(){const a=new Dh;a.lE=!0;a.Jm=M.a.wYe;return a}vem(a){let b;b=0;const c=this.oha.XR;if(c===M.a.aqa||c===M.a.pasteAsPlainText||c===M.a.xza)a==M.a.prd?b=M.a.ovc:a==M.a.rrd?b=M.a.mvc:a==M.a.qrd&&(b=M.a.nvc);return{returnValue:!!b,GZ:b}}Wud(a){let b,c=new Dh;if((()=>{let f=
this.yDb(a);({result:c}=f);return f})().returnValue)return c;(()=>{let f=this.ngf(a);({GZ:b}=f);return f})().returnValue&&(c.lE=!0,c.Jm=b);return c}Xud(a){let b,c=new Dh;if((()=>{let f=this.yDb(a);({result:c}=f);return f})().returnValue)return c;(()=>{let f=this.U_h(a);({Le:b}=f);return f})().returnValue&&(c.lE=!0,c.Jm=b);return c}sTa(a,b){let c=new Dh;if((()=>{let f=this.yDb(a);({result:c}=f);return f})().returnValue)return c;if(this.oa.Js())return c.lE=!0,c.Jm=ff.ActionManager.L8b,c;c.Jm=a;c.Bd=
b;return c}tmb(a){let b,c=new pl;if(!this.Tb.Hi())return c.qM=!1,c;if((()=>{let f=this.Tte(a);({result:c}=f);return f})().returnValue)return c;(()=>{let f=this.ngf(a);({GZ:b}=f);return f})().returnValue&&(c.lE=!0,c.Jm=b);return c}bQh(){return this.oa.kz()}dYl(){return this.oa.nI()}erd(a,b){const c=new Dh;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new WS.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==M.a.mHa&&a!==M.a.k5b||ya.a.J(512493024,
801,50,(a===M.a.mHa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.Bd=b;return c}K9c(a,b,c){return this.wu(a,b,c)}AUc(a){let b=new Dh;if((()=>{let c=this.yDb(a);({result:b}=c);return c})().returnValue)return b;b.pq=this.ka.r6c||this.ka.vBg&&this.ka.Bhk&&E.a.gp;return b}abl(a,b,c){a=new Dh;ya.a.J(512493023,801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}yDb(a){const b=new Dh;return this.xzg(a)?(b.lE=!1,b.qM=!1,b.Jm=ff.ActionManager.L8b,
{returnValue:!0,result:b}):{returnValue:!1,result:b}}Tte(a){const b=new pl;return this.xzg(a)?(b.lE=!1,b.qM=!1,b.Jm=ff.ActionManager.L8b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}xzg(a){return this.rdk(a)}rdk(a){return this.ka.podsTableCellLockEnabled&&this.ka.podsTableRTTEnabled&&Qd.DMi.contains(a)?this.oa.P$()?!0:!1:!1}Tyd(a,b){if(md.a("SetMappedCommandActionData")){let c=0;if((()=>{let f=Qd.dEd(b,this.oa.kz());({Le:c}=f);return f})().returnValue||(()=>{let f=Qd.G_h(b);({Le:c}=f);return f})().returnValue||
(()=>{let f=this.ogf(b);({GZ:c}=f);return f})().returnValue||(()=>{let f=this.ngf(b);({GZ:c}=f);return f})().returnValue||(()=>{let f=this.U_h(b);({Le:c}=f);return f})().returnValue)a.Bd||(a.Bd={}),a.Bd.MappedCommand=c}return a}static zue(a){const b=Qd.uNj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static uNj(){Qd.uoc||(Qd.uoc=[M.a.vtc,M.a.ptc,M.a.oMa,M.a.YLa,M.a.ZLa,M.a.pNb,M.a.deleteObject,M.a.Iae,M.a.Lab,M.a.ypa,M.a.Scc,M.a.Ngf,M.a.uR,M.a.print,M.a.Vkl,M.a.pZe,M.a.rZe,M.a.qtc,M.a.AYe,
M.a.BYe,M.a.downloadACopy,M.a.m8b,M.a.n8b,M.a.o8b,M.a.ow,M.a.htd,M.a.AEa,M.a.nzd,M.a.mzd,M.a.mWe,M.a.mNb,M.a.POb,M.a.Kza,M.a.fmb,M.a.wk,M.a.lqa,M.a.Jk,M.a.aob,M.a.Txc,M.a.bob,M.a.Vqa,M.a.zSb,M.a.NAa,M.a.BOa,M.a.g2a,M.a.Ilb,M.a.M1a,M.a.Gtc,M.a.yOb,M.a.N1a,M.a.xOb,M.a.EOb,M.a.Qtd,M.a.ulb,M.a.vlb,M.a.CTb,M.a.dmb,M.a.DTb,M.a.emb,M.a.BTb,M.a.cmb,M.a.ATb,M.a.bmb,M.a.zTb,M.a.AOb,M.a.gia,M.a.xvc,M.a.QOb,M.a.tif,M.a.cpe,N.a.x9,N.a.Tsd,M.a.openInClient,N.a.Xyc,N.a.GMb,N.a.SNb,N.a.kSb,N.a.lSb,M.a.MNa,M.a.Dia,
M.a.zqd,M.a.jOb,M.a.Mzc,M.a.Nzc,G.a.Wrd,M.a.Sgl,M.a.m7,M.a.oeg,M.a.uR,M.a.QJ,M.a.xvd,M.a.$2e,M.a.Vmd,M.a.Umd,M.a.Whf,M.a.z9a,M.a.z4c,G.a.copy,G.a.paste,M.a.Dyb,M.a.z6b,M.a.aqa,M.a.P1a,M.a.O1a,M.a.Uzd,N.a.bfa,N.a.kia,N.a.ASc,N.a.maf,M.a.Ftc,M.a.gZe,M.a.Msc,M.a.Htc,M.a.yvc,M.a.n4a,N.a.Tef,N.a.Ce,M.a.jma,M.a.Xrd,M.a.wRe,M.a.YYc,M.a.XYc,M.a.Ibb,M.a.s$b,M.a.t$b]);Qd.uoc.push(M.a.Nxc);if(A.AFrameworkApplication.fa.getBooleanAppSetting("ReactNewSlideLayoutEnabled")){const a=[M.a.lNb,M.a.itd,M.a.B5c];let b;
(b=Qd.uoc).push.apply(b,a)}return Qd.uoc}static Yhl(a,b){const c=a.Wpa;let f=!0,l=null;if(null===a||null===a.Bd)return!1;a=a.Bd;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.uca)switch(c){case M.a.Kza:case M.a.IOb:case M.a.JOb:case M.a.Wuc:case M.a.Vtd:case M.a.Tuc:case M.a.Uuc:case M.a.Vuc:case M.a.Suc:case M.a.lOb:case M.a.nOb:case M.a.mOb:case M.a.ruc:case M.a.Plb:case M.a.Qlb:case M.a.yMa:case M.a.zMa:a=parseFloat(l.uca);0<a||c===M.a.Kza||c===M.a.lOb||c===M.a.nOb||c===M.a.mOb||
c===M.a.ruc||c===M.a.Plb||c===M.a.Qlb||c===M.a.yMa||c===M.a.zMa||0<=a&&(c===M.a.Tuc||c===M.a.Uuc||c===M.a.Vuc||c===M.a.Suc)?(b[Un.Text]=l.uca,b[Un.Number]=a):(b[Un.Text]="",b[Un.Number]=Number.NaN);b[Un.UnitType]=c===M.a.Kza||c===M.a.yMa||c===M.a.zMa?8:3;break;default:f=!1}return f}static Xhl(a,b){if(gh.G3b(a,b))return!0;if(!a||!a.Bd)return!1;var c=null;Object(gc.a)(Di.a,a.Bd)?c=a.Bd:Object(gc.a)(ax,a.Bd)?(c=a.Bd,b.SourceControlId=c.uW,c=c.e2a):Object(gc.a)(Object,a.Bd)&&(a=a.Bd,a.queryResult&&(c=
a.queryResult));c&&(b[Xh.a.On]=c.lDd?c.lDd.value:!1,c.rSc&&(b[Po.a.IsFreeForm]=c.rSc.value),c.fGa&&(b[an.a.InnerHTML]=c.fGa),c.zAb&&(b[an.a.Alt]=c.zAb),c.rZc&&(b[an.a.On]=c.rZc.value),void 0!==c.H0&&null!==c.H0&&(b[Po.a.Value]=c.H0),void 0!==c.tQc&&null!==c.tQc&&(b[cG.a.LabelText]=c.tQc),c.k5&&(b[an.a.GalleryButtonProps]=c.k5),c.ISf&&(b[cG.a.Image32by32Class]=c.ISf),void 0!==c.Mbb&&null!==c.Mbb&&(b[bn.a.labelText]=c.Mbb));return!0}static Ez(){const a=new pl;a.Bd=new Di.a;return a}static qf(){const a=
new Dh;a.Bd=new Di.a;a.yY=!0;return a}static QIg(a,b,c){ya.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new Dh;a.Bd=b;return a}static $cf(a,b){a=new Dh;a.Bd=b.Color;return a}static UPf(a,b){a=new Dh;a.Bd=b.Color;a.pq=!0;return a}static u0l(){const a=new Dh;a.Bd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static rtd(a,b){a=new Dh;const c=new ax;c.e2a=new Di.a;c.uW=b.SourceControlId;a.Bd=c;a.yY=!0;return a}static jBd(a,b){a=new Dh;a.Bd=b.SourceControlId;return a}static eW(){const a=
new Dh,b={},c=new Di.a;b.queryResult=c;a.Bd=b;a.cxe=!0;return a}static H3a(a){const b=new pl;switch(a){case M.a.VOf:b.Jm=M.a.lEa;break;case M.a.WOf:b.Jm=M.a.hea;break;case M.a.APc:b.Jm=M.a.LSa;break;case M.a.xPc:b.Jm=M.a.L9a;break;case M.a.zPc:b.Jm=M.a.M9a;break;case M.a.yPc:b.Jm=M.a.Vka;break;case M.a.B0d:b.Jm=M.a.cwb;break;case M.a.r0d:b.Jm=M.a.F3b}return b}static Hqj(){const a=new pl;a.Jm=M.a.jma;return a}static Pnl(){const a=new Dh,b={},c=new Di.a;c.Rf(!1);b.queryResult=c;a.Bd=b;a.yY=!0;return a}static dEd(a,
b){switch(a){case M.a.oNb:return a=G.a.bold,{returnValue:!0,Le:a};case M.a.zza:return a=G.a.rea,{returnValue:!0,Le:a};case M.a.G1a:return a=G.a.font,{returnValue:!0,Le:a};case M.a.yNb:return a=G.a.A7,{returnValue:!0,Le:a};case M.a.BNb:return a=G.a.fNa,{returnValue:!0,Le:a};case M.a.Aza:return a=G.a.Jr,{returnValue:!0,Le:a};case M.a.tNb:return a=G.a.fT,{returnValue:!0,Le:a};case M.a.jtc:return a=G.a.uea,{returnValue:!0,Le:a};case M.a.uNb:return a=G.a.setItalic,{returnValue:!0,Le:a};case M.a.Bza:return a=
G.a.ega,{returnValue:!0,Le:a};case M.a.wNb:return a=M.a.LWe,{returnValue:!0,Le:a};case M.a.Alb:return a=G.a.jNb,{returnValue:!0,Le:a};case M.a.H1a:return a=G.a.$q,{returnValue:!0,Le:a};case M.a.zNb:return a=G.a.sMa,{returnValue:!0,Le:a};case M.a.CNb:return a=G.a.M2a,{returnValue:!0,Le:a};case M.a.Blb:return a=G.a.rH,{returnValue:!0,Le:a};case M.a.xlb:return a=G.a.OG,{returnValue:!0,Le:a};case M.a.ENb:return a=G.a.strikethrough,{returnValue:!0,Le:a};case M.a.mtc:return a=M.a.wsh,{returnValue:!0,Le:a};
case M.a.xNb:return a=M.a.jMa,{returnValue:!0,Le:a};case M.a.Dza:return a=G.a.pia,{returnValue:!0,Le:a};case M.a.I1a:return a=G.a.Yua,{returnValue:!0,Le:a};case M.a.HNb:return a=G.a.underline,{returnValue:!0,Le:a};case M.a.ANb:return a=G.a.My,{returnValue:!0,Le:a};case M.a.sNb:return a=G.a.lC,{returnValue:!0,Le:a};case M.a.DNb:return a=G.a.My,{returnValue:!0,Le:a};case M.a.rtc:return a=G.a.lC,{returnValue:!0,Le:a};case M.a.eqa:return a=G.a.qL,{returnValue:!0,Le:a};case M.a.nMa:return a=G.a.aO,{returnValue:!0,
Le:a};case M.a.Cza:return a=M.a.Ypa,{returnValue:!0,Le:a};case M.a.ylb:return a=M.a.Pze,{returnValue:!0,Le:a};case M.a.pVa:return a=G.a.$Yc,{returnValue:!0,Le:a};case M.a.FNb:return a=G.a.subscript,{returnValue:!0,Le:a};case M.a.GNb:return a=G.a.superscript,{returnValue:!0,Le:a}}return b?Qd.Ydm(a):Qd.F_h(a)}static G_h(a){switch(a){case M.a.oNb:return a=M.a.y3a,{returnValue:!0,Le:a};case M.a.zza:return a=M.a.GRb,{returnValue:!0,Le:a};case M.a.G1a:return a=M.a.Unb,{returnValue:!0,Le:a};case M.a.H1a:return a=
M.a.Vnb,{returnValue:!0,Le:a};case M.a.uNb:return a=M.a.z3a,{returnValue:!0,Le:a};case M.a.Bza:return a=M.a.Wnb,{returnValue:!0,Le:a};case M.a.Dza:return a=M.a.job,{returnValue:!0,Le:a};case M.a.I1a:return a=M.a.pRb,{returnValue:!0,Le:a};case M.a.HNb:return a=M.a.A3a,{returnValue:!0,Le:a};case M.a.eqa:return a=M.a.FRb,{returnValue:!0,Le:a};case M.a.htc:return a=M.a.fyc,{returnValue:!0,Le:a};case M.a.itc:return a=M.a.Ozd,{returnValue:!0,Le:a};case M.a.Aza:return a=M.a.oRb,{returnValue:!0,Le:a};case M.a.tNb:return a=
M.a.gob,{returnValue:!0,Le:a};case M.a.jtc:return a=M.a.HRb,{returnValue:!0,Le:a};case M.a.nMa:return a=M.a.qRb,{returnValue:!0,Le:a};case M.a.Alb:return a=M.a.p9e,{returnValue:!0,Le:a};case M.a.Blb:return a=M.a.IRb,{returnValue:!0,Le:a};case M.a.xlb:return a=M.a.gyc,{returnValue:!0,Le:a};case M.a.ENb:return a=M.a.rRb,{returnValue:!0,Le:a};case M.a.S2:return a=M.a.jzd,{returnValue:!0,Le:a};case M.a.R2:return a=M.a.izd,{returnValue:!0,Le:a};case M.a.Q2:return a=M.a.hzd,{returnValue:!0,Le:a};case M.a.mtc:case M.a.wNb:return Qd.dEd(a,
!0);case M.a.xNb:return Qd.dEd(a,!0);case M.a.Cza:return a=M.a.gzd,{returnValue:!0,Le:a};case M.a.ylb:return a=M.a.n9e,{returnValue:!0,Le:a};case M.a.FNb:return a=M.a.jyc,{returnValue:!0,Le:a};case M.a.GNb:return a=M.a.kyc,{returnValue:!0,Le:a}}return Qd.F_h(a)}static Ydm(a){switch(a){case M.a.pOb:return a=G.a.auc,{returnValue:!0,Le:a};case M.a.AMa:return a=G.a.duc,{returnValue:!0,Le:a};case M.a.tOb:return a=G.a.kuc,{returnValue:!0,Le:a};case M.a.sOb:return a=N.a.x9,{returnValue:!0,Le:a};case M.a.rOb:return a=
N.a.x9,{returnValue:!0,Le:a};case M.a.Ulb:return a=G.a.$sd,{returnValue:!0,Le:a};case M.a.Vlb:return a=G.a.euc,{returnValue:!0,Le:a};case M.a.BMa:return a=G.a.luc,{returnValue:!0,Le:a};case M.a.DMa:return a=G.a.zuc,{returnValue:!0,Le:a};case M.a.Wlb:return a=G.a.fuc,{returnValue:!0,Le:a};case M.a.GMa:return a=M.a.OOb,{returnValue:!0,Le:a};case M.a.FMa:return a=M.a.NOb,{returnValue:!0,Le:a};case M.a.EMa:return a=M.a.MOb,{returnValue:!0,Le:a};case M.a.wOb:return a=G.a.Yuc,{returnValue:!0,Le:a};case M.a.qOb:return a=
M.a.Usd,{returnValue:!0,Le:a};case M.a.uOb:return a=M.a.ktd,{returnValue:!0,Le:a};case M.a.CMa:return a=M.a.wuc,{returnValue:!0,Le:a};case M.a.Xlb:return a=M.a.xuc,{returnValue:!0,Le:a};case M.a.vOb:return a=G.a.Ouc,{returnValue:!0,Le:a};case M.a.Iza:return a=M.a.$1a,{returnValue:!0,Le:a};case M.a.c2a:return a=G.a.Quc,{returnValue:!0,Le:a};case M.a.d2a:return a=G.a.Ruc,{returnValue:!0,Le:a}}a=ff.ActionManager.o7;return{returnValue:!1,Le:a}}static F_h(a){switch(a){case M.a.pOb:return a=M.a.Fuc,{returnValue:!0,
Le:a};case M.a.AMa:return a=M.a.wtd,{returnValue:!0,Le:a};case M.a.tOb:return a=M.a.Guc,{returnValue:!0,Le:a};case M.a.Ulb:return a=M.a.ztd,{returnValue:!0,Le:a};case M.a.Vlb:return a=M.a.Atd,{returnValue:!0,Le:a};case M.a.BMa:return a=M.a.Ctd,{returnValue:!0,Le:a};case M.a.DMa:return a=M.a.Etd,{returnValue:!0,Le:a};case M.a.Wlb:return a=M.a.Btd,{returnValue:!0,Le:a};case M.a.GMa:return a=M.a.Ktd,{returnValue:!0,Le:a};case M.a.FMa:return a=M.a.Jtd,{returnValue:!0,Le:a};case M.a.EMa:return a=M.a.Itd,
{returnValue:!0,Le:a};case M.a.wOb:return a=M.a.Iuc,{returnValue:!0,Le:a};case M.a.qOb:return a=M.a.$lb,{returnValue:!0,Le:a};case M.a.sOb:return a=M.a.ytd,{returnValue:!0,Le:a};case M.a.rOb:return a=M.a.xtd,{returnValue:!0,Le:a};case M.a.uOb:return a=M.a.amb,{returnValue:!0,Le:a};case M.a.CMa:return a=M.a.a2a,{returnValue:!0,Le:a};case M.a.Xlb:return a=M.a.b2a,{returnValue:!0,Le:a};case M.a.vOb:return a=M.a.Huc,{returnValue:!0,Le:a};case M.a.Iza:return a=M.a.Dtd,{returnValue:!0,Le:a};case M.a.c2a:return a=
M.a.Gtd,{returnValue:!0,Le:a};case M.a.d2a:return a=M.a.Htd,{returnValue:!0,Le:a}}a=ff.ActionManager.o7;return{returnValue:!1,Le:a}}static tyl(a){const b=new pl;switch(a){case M.a.nte:b.Jm=M.a.mHa}return b}static IIg(a,b){a=new Dh;if(!b)throw Error.argumentNull();a.Bd=Qd.Ykg(b.MenuItemId);return a}static tyh(a,b){a=new Dh;const c={},f=new Di.a;f.Rf(!1);c.queryResult=f;c.MenuItemId=Qd.Ykg(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.Bd=c;a.yY=!0;a.bxe=!0;return a}static Ykg(a){return parseFloat(a)}}
Qd.uoc=null;Qd.DMi=(Tf=new La.a,Tf.add(G.a.cut),Tf.add(G.a.paste),Tf.add(G.a.O2),Tf.add(G.a.S9),Tf.add(G.a.fT),Tf.add(G.a.I5d),Tf.add(G.a.uea),Tf.add(G.a.A7),Tf.add(G.a.fNa),Tf.add(G.a.sMa),Tf.add(G.a.M2a),Tf.add(M.a.pOb),Tf.add(M.a.tOb),Tf.add(M.a.wOb),Tf.add(M.a.AMa),Tf.add(M.a.BMa),Tf.add(M.a.DMa),Tf.add(M.a.Wlb),Tf.add(M.a.GMa),Tf.add(M.a.FMa),Tf.add(M.a.EMa),Tf.add(M.a.Ulb),Tf.add(M.a.Vlb),Tf.add(M.a.qOb),Tf.add(M.a.uOb),Tf.add(M.a.CMa),Tf.add(M.a.Xlb),Tf.add(M.a.sOb),Tf.add(M.a.rOb),Tf.add(M.a.vOb),
Tf.add(M.a.Iza),Tf.add(M.a.c2a),Tf.add(M.a.d2a),Tf.add(M.a.Dyh),Tf.add(M.a.Fyh),Tf.add(M.a.Eyh),Tf.add(M.a.f0e),Tf.add(M.a.qtd),Tf.add(M.a.oNb),Tf.add(M.a.uNb),Tf.add(M.a.HNb),Tf.add(M.a.zza),Tf.add(M.a.Bza),Tf.add(M.a.Dza),Tf.add(M.a.I1a),Tf.add(M.a.tNb),Tf.add(M.a.jtc),Tf.add(M.a.G1a),Tf.add(M.a.yNb),Tf.add(M.a.BNb),Tf.add(M.a.H1a),Tf.add(M.a.zNb),Tf.add(M.a.CNb),Tf.add(M.a.Blb),Tf.add(M.a.xlb),Tf.add(M.a.S2),Tf.add(M.a.R2),Tf.add(M.a.Q2),Tf.add(M.a.ENb),Tf.add(M.a.wNb),Tf.add(M.a.Alb),Tf.add(M.a.mtc),
Tf.add(M.a.xNb),Tf.add(M.a.ntc),Tf.add(M.a.otc),Tf.add(M.a.eqa),Tf.add(M.a.nMa),Tf.add(M.a.FRb),Tf.add(M.a.gob),Tf.add(M.a.HRb),Tf.add(M.a.qRb),Tf.add(M.a.htc),Tf.add(M.a.itc),Tf.add(M.a.Aza),Tf.add(M.a.sNb),Tf.add(M.a.ANb),Tf.add(M.a.insertHyperlink),Tf.add(M.a.Cza),Tf.add(M.a.ylb),Tf.add(M.a.FNb),Tf.add(M.a.GNb),Tf.add(M.a.qNb),Tf.add(M.a.oMa),Tf.add(M.a.zlb),Tf.add(M.a.rNb),Tf.add(M.a.gsd),Tf.add(M.a.ktc),Tf.add(M.a.utc),Tf.add(M.a.ttc),Tf.add(M.a.stc),Tf);Object(m.a)(Qd,"CuiActionBridge",gh,[]);
class TN{constructor(a,b,c,f,l,u,I){this.hic=!1;this.Irc=(ja,ua)=>{2===ua.vU&&this.CB()};this.Hkm=ja=>{this.Db&&this.hic&&this.Db.OB(ja)};if(!(a&&b&&c&&f&&l&&u&&I))throw Error.argumentNull("Invalid or Null arguments passed to ReactStatusBarUserLite constructor");this.Xxa=a;this.Hc=f;this.ka=c;this.MOk=l;this.v1g=b;this.Db=I;this.BQk=u;this.Xxa.RUl(this.Hkm);this.v1g.VE(this.Irc);this.Hc.oLf(()=>{this.hic=!0;this.CB()});const T=()=>{const ja=()=>{this.Srd(this.B1c("PptEditingStatusBar.GiveFeedback"));
this.Srd(this.B1c("PptEditingStatusBar.GiveFeedbackPane"))};this.ka.getBooleanAppSetting("FeedbackPaneExperienceIsEnabled")&&this.ka.getBooleanAppSetting("HelpTabIsEnabled")?(this.dT("OpenFeedbackDialog",!this.ka.getBooleanAppSetting("ShowFeedback")),this.dT("GiveFeedbackPane",!0)):(this.dT("GiveFeedbackPane",!this.ka.getBooleanAppSetting("ShowFeedback")),this.dT("OpenFeedbackDialog",!0));this.hic?ja():this.Hc.oLf(ja)};this.Xxa.adk(()=>{this.MOk.sDb(T)})}dispose(){this.v1g.RN(this.Irc)}CB(){this.Xxa&&
this.hic&&this.Xxa.CB()}dT(a,b){this.Xxa&&this.Xxa.dT(this.B1c(a),!b)}B1c(a){const b=this.BQk.phe(a);return b&&0<b.count?b.ga(0):a}Srd(a){this.Xxa&&this.hic&&this.Xxa.Srd(this.B1c(a))}}Object(m.a)(TN,"ReactStatusBarUserLazy",null,[841]);class gG{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}fc(a){this.K=a;this.K.register(840,"Box4.ISelectionContextMenuProvider").ma().na(()=>new Qq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").uEb;E.a.Fk&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").BAa);
this.K.register(aC,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().na(()=>new aC(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),
this.K.Ha("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),b));this.K.register(841,"PowerPointWebEditor.IStatusBarUser").ma().na(()=>new TN(this.K.resolve("PowerPointWebEditor.IStatusBarUserLite").Xxa,this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),A.AFrameworkApplication.fa,
this.K.resolve("Common.IExternalUICommandDefinitionMapping"),ad.App.Ob));a.register(842,"PowerPointWebEditor.ICUIManager").ma().na(()=>new RN(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(Qd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().na(()=>new Qd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager"),a.resolve("Box4.ITextPasteFloatieManager")));a.register(My,"CommandUI.ReactRibbonRoot").ma().na(()=>new My(ys.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(843,"PowerPointWebEditor.IContextMenuUser").ma().na(()=>new PN(a.resolve("Box4.IContextMenuController"),Object(gb.a)(aC,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(844,
"Box4.IBox4BridgeCommandUi").ma().na(()=>new QN(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),a.resolve("Common.IRibbonExternal")));this.K.register(845,"PowerPointWebEditor.IContextMenuHelper").ma().na(()=>new ON(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register($F,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().na(()=>new $F(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),
a.ub("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").Ok("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){Mg.a.instance.Xb("PPTWebEditorUIPackageInit",(new Date).getTime());this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").kIi(this.K.resolve("Box4.IBox4BridgeCommandUi"));
this.K.resolve("PowerPointWebEditor.View.IViewEventSource").gpl()}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){C.a.instance.Ac(new gG)}}Object(m.a)(gG,"PPTWebEditorUIPackage",null,[2,3]);class UN{constructor(a){this.Ebi="FontPicker";this.xOd=null;this.Yzb=b=>{this.xOd=b.isEnabled;b=appChrome.actions.updateFontPickerLicenseState(this.Ebi,
b.isEnabled);appChrome.api.dispatch(b)};this.vPa=a;this.QFc=this.vPa.OMa(xs.a.AYa,this.Yzb);this.vPa.isFeatureEnabled(xs.a.AYa,!1).then(b=>{this.xOd=b})}get isLicensed(){return this.xOd}dispose(){this.vPa.s2a(xs.a.AYa,this.QFc)}}Object(m.a)(UN,"ModernFontPickerFeatureHelper",null,[248,106]);class bC{constructor(a){this.jKa=null;a?Object.getType(a)===String?this.jKa=bC.deserialize(a):this.jKa=a:(da.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.jKa=[]);this.tJa=!1}get isDirty(){return this.tJa}get Hrd(){return Array.clone(this.jKa)}dui(a){Array.contains(this.jKa,
a)||(Array.add(this.jKa,a),this.tJa=!0)}jzl(a){Array.contains(this.jKa,a)&&(Array.remove(this.jKa,a),this.tJa=!0)}serialize(){return JSON.stringify(this.jKa)}tFl(){this.tJa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return da.ULS.sendTraceTag(543475147,3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(m.a)(bC,"PinnedFontStore",null,[]);class VN{constructor(a,b,c,f){this.ia=a;this.ka=c;this.rah=b;this.zb=f;this.I6=null}initialize(){this.ia.xa(N.a.Lsc,Le.a.frame,Object(R.a)(this,
this.Lsc,"pinOrUnpinFont"));this.ia.pa(N.a.Zdg,Le.a.frame,Object(R.a)(this,this.bnh,"onFontPickerMenuClose"),96);this.rah.Qle("getPPTPinnedFontsSettings").continueWith(Object(R.a)(this,this.b9k,"onRoamingSettingLoaded"))}lpk(a){return a.Ao?!1:a.Pm?(da.ULS.sendTraceTag(543273993,3021,10,"Load setting failed with exception {0}",a.Ni),!1):!0}b9k(a){this.lpk(a)?this.I6=new bC(a.result||this.Tmg()):this.I6=new bC(this.Tmg());this.cyh()}cyh(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",
this.Hrd))}get Hrd(){return this.I6?this.I6.Hrd:[]}Tmg(){return this.ka.Ea("RecommendedFonts")}Lsc(a,b,c,f,l){if(!this.I6)return da.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.I6.dui(a):this.I6.jzl(a));return 32}bnh(){if(!this.I6||!this.I6.isDirty)return 32;const a=ne.a.VTc(10,Object(R.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.zb.Jb(a);return 32}updatePinnedFonts(){this.I6&&(this.cyh(),this.jJh(),this.I6.tFl())}jJh(){if(this.I6&&
this.I6.isDirty){var a=this.I6.serialize();this.rah.VUl(a)}}dispose(){this.jJh();this.ia.YI(N.a.Lsc,Le.a.frame,Object(R.a)(this,this.Lsc,"pinOrUnpinFont"));this.ia.YI(N.a.Zdg,Le.a.frame,Object(R.a)(this,this.bnh,"onFontPickerMenuClose"))}}Object(m.a)(VN,"FontPinningHandler",null,[839,106]);class or{static get Mqd(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}or.$Fa="fontInfoTaskPane";or.Qjj="modernfontpicker";Object(m.a)(or,"FontInfoPaneConstants",null,[]);class WN{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(m.a)(WN,"FontInfoTaskPaneProps",null,[]);var jv=d(661);class cC{constructor(a,b,c,f){this.c9a=this.ZW=this.QFc=null;this._state=this.Wsb=0;this.onOpen=()=>{this._state=2;this.dr()};this.onShow=l=>{0!==this._state&&(this._state=2,1===l&&(this.Wsb=l),this.dr())};this.onClose=()=>{this.Wsb=this._state=0;this.blur()};this.onHide=()=>{this._state=1;this.Wsb=
0};this.onUpsellButtonClicked=()=>{this.vPa.launchUpsellExperience(or.Qjj)};this.hii=a;this.vPa=b;this.vai=c;this.Wd=void 0===f?null:f}get zn(){return this.hii.value}initialize(){this.zn.xa(N.a.r4e,Le.a.frame,Object(R.a)(this,this.r4e,"requestFontInfo"));this.QFc=this.vPa.OMa(xs.a.AYa,Object(R.a)(this,this.Yzb,"featureStateChangeCallback"));this.eob()}Jl(a){a=void 0===a?!1:a;const b=Gj.UISurfaces.qr(),c=this.vPa.isFeatureEnabled(xs.a.AYa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(or.$Fa,
this.Hea(l[1]));a&&this.dr()})}j3h(a){Gj.UISurfaces.qr().then(b=>{b.updateTaskPane(or.$Fa,this.Hea(a));return null})}Yzb(a){this.j3h(a.isEnabled)}r4e(a,b,c,f,l){this.ZW=l.CommandValueId;this.c9a=l.Trigger;this.Wsb=l.InputMethod;this.Jl(2===this._state&&1===this.Wsb);return 32}Hea(a){const b=new WN;b.onUpsellButtonClicked=this.onUpsellButtonClicked;b.fontName=this.ZW;b.isLicensed=a;b.trigger=this.c9a;b.helpArticleUrl=this.KZi();b.paneId=or.$Fa;a=this.u9j();a.contentProps=b;return a}u9j(){return Object.assign(new jv.a,
{title:or.Mqd,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:this.onOpen,onClose:this.onClose,onShow:this.onShow,onHide:this.onHide})}eob(){if(this.Wd){var a=this.Wd.Kc(or.$Fa);a.parent=K.AFrame.Nj;a.uK=!0}}dr(){this.Wd&&1===this.Wsb&&this.Wd.Df(or.$Fa)}blur(){this.Wd&&this.Wd.Je&&this.Wd.Je.name===or.$Fa&&this.Wd.Df(this.Wd.R9)}dispose(){this.vPa.s2a(xs.a.AYa,this.QFc)}KZi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",
this.vai,this.wCj(),"PPWAENDUSER",A.AFrameworkApplication.lcid)}wCj(){switch(this.c9a){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return cC.RJi(this.ZW)}static RJi(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=Aa.a.charAt(a,c);if(255<a.charCodeAt(c)||Aa.a.Izg(f))b+=f}return b}}Object(m.a)(cC,"FontInfoPane",null,[243,106]);class XN extends cC{constructor(a,
b,c,f){super(a,b,c.Ea("FontInfoHelpBaseUrl"),f)}Yzb(a){this.j3h(a.isEnabled)}}Object(m.a)(XN,"PPTFontInfoPane",cC,[]);class hG{constructor(){this.Ngd=this.$jc=this.akc=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}fc(a){this.K=a;this.K.register(248,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().na(()=>new UN(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(839,"Box4.IFontPinningStore").ma().na(()=>new VN(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.ITaskManager")));this.K.register(243,"Common.ModernFontPicker.IFontInfoPane").ma().na(()=>new XN(new Hc.a(()=>A.AFrameworkApplication.Pa),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.Ue(()=>{this.K.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>
{a.getBooleanAppSetting("PPTOModernFontPickerIsEnabled")&&(this.Ngd=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.$jc=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.$jc.initialize(),b.isFeatureEnabled(xs.a.AYa,!1).then(c=>{!A.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser")&&c&&(this.akc=this.K.resolve("Box4.IFontPinningStore"),this.akc.initialize())}),ad.App.Ob.Gf())})})}dispose(){this.$jc&&(this.$jc.dispose(),this.$jc=null);this.akc&&
(this.akc.dispose(),this.akc=null);this.Ngd&&(this.Ngd.dispose(),this.Ngd=null)}static main(){C.a.instance.Ac(new hG)}}Object(m.a)(hG,"PPTModernFontPickerPackage",null,[2,3]);var iG=d(1121);class YN{constructor(a){this.nba=a;this.mjb=this.nba.fLb("UserAction","ImageProcessor");this.tGk=67}fJg(a,b){if(b)if(a&&this.Esk){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}wSh(a,b,c){c-=this.tGk;if(0>=c||!a)return null;let f=a.width,
l=a.height;if(0>=f||0>=l)return null;let u=null,I=1,T=0;try{const ja=Math.ceil(1.37*b);if(c<=ja){const ua=Math.sqrt(c/(1.3*ja));f=Math.floor(a.width*ua);l=Math.floor(a.height*ua)}if(u=this.M6f(a,f,l))if(T=u.length,u.length>=c){const ua=this.zog(a.width,a.height);ua*Math.floor(a.width)*ua*Math.floor(a.height)>=f*l?u=null:(I++,(u=this.h2l(a))&&u.length>=c&&(u=null))}}catch(ja){u=null,da.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+ja.message+", Call stack: "+ja.stack)}a=
String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",b,I,T,u?u.length:0);da.ULS.sendTraceTag(20841026,826,50,a);return u}h2l(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.zog(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.M6f(a,c,f)}catch(u){da.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+u.message+", Call stack: "+u.stack)}}return b}M6f(a,b,c){if(0>=b||0>=c)return null;let f;this.mjb.start();
var l=document.createElement("canvas");l.width=b;l.height=c;var u=l.getContext("2d");f=this.mjb.Qr;u.drawImage(a,0,0,b,c);u=this.mjb.Qr-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,u,this.mjb.Qr-(f+u));da.ULS.sendTraceTag(20841028,813,50,a);return l}zog(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get Esk(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||
window.webkitURL}}Object(m.a)(YN,"ImageProcessor",null,[1776]);class jG{constructor(a,b,c,f,l){this.Ca=a;this.Gai=b;this.Fai=c;this.Cof=f;this.Wki=l}get zn(){return this.Ca}nJi(a){this.zn.Dsd(a,this.Gai,null,null)}lJi(a){this.zn.Dsd(a,this.Fai,null,null)}F9(a,b,c){c?this.zn.Dsd(a,this.Cof,b,null):this.zn.Ia(this.Cof,2,b)}xth(a,b){b=void 0===b?!1:b;const c=new W.DictionaryPropertySet;c.setValue(Oe.a.bW,a);c.setValue(Oe.a.urd,!0);c.setValue(Oe.a.yeb,b);this.zn.Ia(this.Wki,2,c)}}Object(m.a)(jG,"ClipboardCommands",
null,[1749]);class kG{c9b(){}}Object(m.a)(kG,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1870]);class pr{constructor(a,b,c,f,l,u){this.NE=a;this.Ch=b;this.yv=c;this.yn=f;this.Pp=l;this.zd=u}sbk(a,b){a=b.view;b=b.GF;if(!b||U.a.instance.ga(14)&&!this.NE.DBg(b,!0)||this.yn&&this.yn.instance&&this.yn.instance.rY(b))return 2;var c=pr.vW?!pr.Uu.lna(b):!0;this.yv&&c&&this.yv.aUb(b.node,H.a.Mp,b.Ra);this.Ch.X4c(b,l=>new Mw.a(l,Mw.a.KUc),Vg.AParagraphNode.P0);if(this.zd.Gg&&this.zd.wD){c=new pg.GraphTransaction(15);
try{c.rd(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Pb+1;" "===$a.ParagraphReader.text(f).charAt(c)&&(f=me.a.createTextRange(f,c,c+1),this.Ch.replaceTextRange(f,"\u00a0"));b=me.a.rk(b.node,c);a.Rb.setSelection($d.SelectionFactory.Dv(b));return 32}static get Uu(){return pr.LE||(pr.LE=Tb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get vW(){null==pr.DJ&&(pr.DJ=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled"):!1);return pr.DJ}}
pr.LE=null;pr.DJ=null;Object(m.a)(pr,"InsertLineBreakStrategy",null,[]);class zo{static get zi(){return zo.Rj||(zo.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Dn(){return Uh.ContextSetEditor.instance}static get g8(){return zo.Pp||(zo.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get kg(){return zo.zd||(zo.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static zbk(a,b,c,f,l){if(l&&l.Qa(Oe.a.targetObject)){var u=
b.view.Zg.Zh.Ie(l.$a(Oe.a.targetObject));u=me.a.create(u)}else u=zo.Dn.D9(b.GF,11);if(!u)return 8;a=A.AFrameworkApplication.Pa.Ai(u,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.xi)return 2;b=b.view;f=b.Rb.Ik;if(f=zo.Dn.D9(f,11)){c=new ko.a;c.set(f.node);c.wf();if(l&&l.Qa(Oe.a.targetObject))for(l=l.$h(Oe.a.targetObject);!c.currentNode.id.equals(l)&&c.Dc()&&(jb.OutlineElementNavigator.$e(c),11===c.Zi););jb.OutlineElementNavigator.Pya(c,!1,!1);l=Bc.SelectionEditor.dma(c,!0);l=$a.ParagraphReader.rt(l)?$d.SelectionFactory.fh(l,
0):$d.SelectionFactory.Nl(l);b.Rb.setSelection(l)}}return a}static sqe(a,b,c,f,l){a=a===G.a.Odc;b=b.node;if(l&&l.Qa(Oe.a.targetObject)&&!b.id.equals(l.$h(Oe.a.targetObject)))return 2;if(1===c)return 32;c=new mb.GraphIterator;c.set(b);c.uc(10);zo.zi.Nfa(c,a,!0);zo.kg.Gg&&zo.kg.wD&&jb.OutlineElementNavigator.Ti(c);return 32}}zo.Rj=null;zo.Pp=null;zo.zd=null;Object(m.a)(zo,"InsertOutlineElementStrategy",null,[]);var XS=d(424);class dC{constructor(a,b,c,f,l,u,I,T){this.yv=b;this.Ldi=a;this.Eu=l;this.ir=
f;this.Rj=c;this.NE=u;this.Vc=I;this.v8a=T}E_k(a,b,c,f,l){if(!b.view.xi)return 2;b=b.view;let u=null;b.Wp&&(u=b);const I=b.Rb.Ik;let T=!0,ja=!1,ua=null;if(!I)return 2;const Ra=new pg.GraphTransaction(15);Ra.rd(b.Zg);let eb=null;2===c&&(eb=new ko.a,eb.set(I.node),eb.wf(),ua=new Xy(eb),2===ad.App.mode&&Bc.SelectionEditor.nh(I)&&(eb.eD(11)&&Kc.ListReader.hl(eb)&&ge.OutlineElementReader.isEmpty(eb,!1)&&(T=!1),T&&ad.App.ni.qy&&ge.OutlineElementReader.QD(eb,I,!1)&&!ge.OutlineElementReader.QD(eb,I,!0)&&
(T=!1)),jb.OutlineElementNavigator.$e(eb),ge.OutlineElementReader.isEmpty(eb,!1)&&(XS.a.Lmk(eb)&&(T=!1),1===ad.App.mode&&Kc.ListReader.hl(eb)&&(ja=!0)));a=A.AFrameworkApplication.Pa.Ai(I,a,c,!1,f,l);T&&32===a&&2===c&&(ja||jb.OutlineElementNavigator.nLa(eb,!1,!Bc.SelectionEditor.nh(I),!1),ja&&ua&&ua.restore(eb),U.a.instance.ga(101)&&this.Eu.freeze(),b.Rb.setSelection($d.SelectionFactory.hk(eb.currentNode,!0)),U.a.instance.ga(101)&&this.Eu.qef(),this.Ldi.Fo.Bx());u&&(T||u.kAa());Qi.GrippersManager.instance.e5a(1);
Ra.dispose();return a}WC(a,b,c){a=!1;if(vb.ImageReader.HHa(b)||vb.ImageReader.ADb(b))b=this.e0i(b),a=!0;const f=b;b=Bc.SelectionEditor.nh(b);if(1===c)return 32;const l=f.node,u=new mb.GraphIterator;u.set(l);u.wf();jb.OutlineElementNavigator.$e(u);c=new pg.GraphTransaction(15);c.Jz(u);b?(b=!0,U.a.instance.ga(101)&&$a.ParagraphReader.ke(l)&&f.Ra===$a.ParagraphReader.textLength(l)&&We.n(f)&&9===$a.ParagraphReader.g1c(l)&&this.Eu.$0i(f),1===ad.App.mode&&ge.OutlineElementReader.isEmpty(u,!1)&&Kc.ListReader.hl(u)&&
(b=!1),this.ir.xMh(u,b,f,l),this.yv&&this.yv.aUb(l,H.a.Mp,f.Ra),a&&(jb.OutlineElementNavigator.XK(u,!1,!1),a=u.Gb(2),(a=this.v8a.fh(a,0))&&this.Vc.setSelection(a))):this.Rj.Nfa(u,!0,!0);c.dispose();ad.App.Ob&&ad.App.Ob.Gf();return 32}e0i(a){if(vb.ImageReader.HHa(a))var b=me.a.rk(a.node,a.Ra);else b=$a.ParagraphReader.REa(a.node),a=dC.eyj(a.node.properties.$a(ib.a.runId),b.properties.$h(ib.a.f_),b.Sa),b=me.a.rk(b,a);return b}static Xnj(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static eyj(a,
b,c){let f=0;a=dC.Xnj(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<c.length;){b=c.ga(l);if(b.formatting&&b.formatting.Cg===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(m.a)(dC,"NewLineStrategy",null,[]);class kv{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.$t=null;this.n0=a;this.JFc=u;this.TIc=new dC(this,b,c,f,l,I,ua,Ra);this.pvf=new pr(I,T,b,ja,eb,Bb)}get Fo(){return this.$t||(this.$t=this.n0())}qb(){const a=A.AFrameworkApplication.Pa,b=Object(R.a)(this.TIc,this.TIc.WC,"newLine");
a.pa(G.a.enter,ta.a.view,Object(R.a)(this.JFc.value,this.JFc.value.Aij,"enterView"),1124);a.pa(G.a.myc,ta.a.view,Object(R.a)(this.JFc.value,this.JFc.value.IWl,"shiftEnterView"),1124);a.xa(G.a.WC,ta.a.view,Object(R.a)(this.TIc,this.TIc.E_k,"newLineView"));a.xa(G.a.WC,ta.a.Xf,b);a.xa(G.a.WC,ta.a.image,b);a.xa(G.a.WC,ta.a.textRange,b);a.xa(G.a.WC,ta.a.anchoredObject,b);a.xa(G.a.WC,ta.a.embeddedFile,b);a.xa(G.a.WC,ta.a.ink,b);a.xa(G.a.WC,ta.a.paragraph,b);a.xa(G.a.WC,ta.a.iFrame,b);a.xa(G.a.WC,ta.a.unsupportedObject,
b);a.pe(G.a.WC,1124);a.pa(G.a.Mdc,ta.a.view,Object(R.a)(this.pvf,this.pvf.sbk,"insertLineBreakView"),1028);a.xa(G.a.Odc,ta.a.view,zo.zbk);a.xa(G.a.Odc,ta.a.outlineElement,zo.sqe);a.pe(G.a.Odc,1092)}static get instance(){return kv.Ja||(kv.Ja=kv.JD())}static JD(){return new kv(()=>Tb.a.instance.resolve("Box4.IUndoManager"),Tb.a.instance.ub("Box4.IAutoCorrectScheduler"),Tb.a.instance.resolve("Box4.IOutlineElementEditor"),Tb.a.instance.resolve("Box4.List.IListEditor"),Tb.a.instance.resolve("Box4.IInsertionPointFormatting"),
Tb.a.instance.ze("Box4.Actors.IEnterViewStrategy"),mi.a.instance,Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Tb.a.instance.Ha("Box4.IExternalSelectionManager"),Me.a.instance,Tb.a.instance.resolve("Box4.ISelectionFactory"),Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}kv.Ja=null;Object(m.a)(kv,"EnterActor",null,[]);class ZN{KVh(a){return a}SDg(){return!0}}Object(m.a)(ZN,"EopFormattingStrategy",
null,[1755]);var $N=d(155);class lG{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.tRa=this.K_b=this.lrb=null;this.IVd=0;this.ONd=!1;this.Ma=new uc.a;this.QXb=null;this.YL=a;this.Eu=b;this.Sf=c;this.hy=f;this.Cs=l;this.ir=u;this.qh=I;this.Ch=T;this.NE=ja;this.kd=ua;this.zd=Ra;this.Pp=eb;this.$Ra=Bb}get Cgj(){return U.a.instance.ga(105)?this.kd?this.kd.isFeatureEnabled(55):A.AFrameworkApplication.fa.getBooleanAppSetting("Box4EndOfParagraphFormattingIsEnabled"):!1}get ifa(){return this.QXb||(this.QXb=
Tb.a.instance.resolve("Box4.IFormatPainterStrategy"))}get JM(){return this.ONd}set JM(a){this.ONd!==a&&(this.ONd=a,this.Ma.raiseEvent("FormatPainterBrushActiveStatusChanged"))}zxi(a){this.Ma.addHandler("FormatPainterBrushActiveStatusChanged",a)}suh(a){const b=a.Ua;da.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.yDg(a);if(this.ifa.jQh(b.contextId,a))try{this.tRa=this.Cs.wva(c)}catch(f){throw da.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",
f.message),f;}this.K_b=Wb.StyleReader.iF(c);c=Od.a.yt(b);c.RA&&(this.lrb=Object(gb.a)(qq.a,c.RA.clone()));this.IVd=a?ta.a.paragraph:b.contextId;this.ifa.LMf(b.node,this.tRa,this.lrb)}MOf(a){const b=U.a.instance.ga(14),c=this.yDg(a);for(let T=0;T<a.length;T++){var f=a.ga(T);if(f.El){var l=void 0;if(f.contextId===ta.a.Xf||f.contextId===ta.a.textRange)l=b&&this.NE.mwa(f);else if(f.contextId===ta.a.paragraph)l=b&&this.NE.c8c(f);else if(f.contextId===ta.a.endOfParagraph)l=b&&this.NE.Y6c(f);else{da.ULS.sendTraceTag(22832033,
354,50,"Skipped applying format to context: {0}",f.contextId);continue}da.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)da.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(gb.a)(Vg.AParagraphNode,f.node);var u=!1;l&&(u=f.contextId===ta.a.textRange&&!!l&&!f.Ra&&f.Pb===this.Cs.textLength(l));if(u=this.ifa.zPh(this.IVd,f.contextId,c,u))try{$a.ParagraphReader.ke(l)?(this.K_b&&this.YL.mca(this.K_b,l,!0),this.hy.QOf(l,
this.tRa)):da.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",f.node.type)}catch(ja){throw da.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",ja.message),ja;}var I=f;f.contextId===ta.a.paragraph?I=me.a.createTextRange(l,0,$a.ParagraphReader.textLength(l)):f.contextId===ta.a.Xf&&(I=this.Eu.bbc(f),I=Me.a.TTa(I));if(I&&I.contextId===ta.a.textRange)try{this.rEi(I,this.lrb,u?null:this.K_b)}catch(ja){throw da.ULS.sendTraceTag(22832066,
354,10,"ApplyFormattingsToTextRange error: {0}",ja.message),ja;}if(f.contextId===ta.a.paragraph||f.contextId===ta.a.endOfParagraph){u=new mb.GraphIterator;u.set(l);u.wf();u.Ug(11);I=Kc.ListReader.hl(u);const ja=!$a.ParagraphReader.textLength(l);da.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",I,ja);I?(this.qh.vpa(u),f=u.currentNode,this.qh.Xfa(f)&&this.ir.Ryd(f,l,this.lrb)):this.Cgj&&this.qEi(f,this.lrb)}}}else da.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",
f.contextId)}}qEi(a,b){b&&(a=this.Ch.Fbe(a.node),a.le(a.Qe),this.NOf(a,b,null))}rEi(a,b,c){if(b||c)0<We.h(a).length&&da.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.$Ra.uPc(a,f=>{this.NOf(f,b,c)})}NOf(a,b,c){this.Sf.DEa(a);a.RA&&a.RA.removeProperty(rb.a.highlight);this.Sf.IRc(a);this.fz(a,c);this.fz(a,b)}fz(a,b){if(b){var c=a.paragraph.Zh;if(c){var f=a.RA;f=f?Object(gb.a)($N.a,f.clone()):qq.a.PEa(1179725);for(const u of b.ZA())if(u!==ib.a.SH&&u!==ib.a.fieldInstruction&&
u!==rb.a.ou&&u!==rb.a.n1&&u!==ib.a.qeb&&u!==rb.a.pu&&u!==ib.a.languageHint&&u!==ib.a.noProof){if(u===ye.a.D0){var l=b.ra(ye.a.D0,Ua.a.nil);if(l!==Ua.a.nil&&(l=Object(gb.a)(qq.a,c.Ie(l)),l=Wb.StyleReader.l2c(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=Wb.StyleReader.EM(a.paragraph).VNj(l);f.fz(l);continue}}f.setValue(u,b.$h(u))}f.efb?b=c.PMa(f):(c.NF(f),b=f);a.en=b.id}}}yDg(a){return!a.zea&&a.vf.contextId!==ta.a.endOfParagraph}reset(){this.tRa=this.K_b=this.lrb=null;this.IVd=ta.a.none}}Object(m.a)(lG,
"FormatPainter",null,[1534]);class eC{constructor(a){this.wl=this.transaction=null;this.Yf=a;this.ayb=this.ar=0}}Object(m.a)(eC,"SelectAllArguments",null,[]);class Ls{constructor(a,b,c,f,l){this.Kki=a;this.Wja=b;this.lm=c;this.cOd=f;this.eZb=l}get EWe(){return this.Kki}get Fo(){return this.Wja.value}get sLl(){return this.cOd?this.eZb?Object(R.a)(this,this.Mjj,"expandSelectionOneNote"):Object(R.a)(this,this.Njj,"expandSelectionWord"):Object(R.a)(this,this.VJh,"selectAllInOutline")}get WJh(){return this.eZb?
Object(R.a)(this,this.mxd,"selectAllOutlines"):null}qb(){const a=A.AFrameworkApplication.Pa;this.WJh&&a.pa(G.a.mxd,ta.a.view,this.WJh,2);a.xa(G.a.sca,Le.a.frame,Ls.iRh);a.xa(G.a.Wzd,Le.a.frame,Ls.iRh);a.pa(G.a.Jua,ta.a.view,this.sLl,2);a.pa(G.a.qNf,ta.a.view,K.AFrame.Ce,100);a.pa(G.a.ORe,ta.a.view,Ls.ORe,4)}Mjj(a,b,c){return this.Jua(b,c,null)}Jua(a,b,c){if(1===b)return 32;if(!a.view.xi)return 2;b=a.view;if(!b.Rb)return 8;const f=b.Rb.Oa;if(!f||!f.length)return 8;He.a.mark(5798);ad.App.Ob.ie.isEditingAllowed||
ad.App.Ob.ie.eA?a=Bc.SelectionEditor.dje(f):(F.FocusManager.instance().PF(K.AFrame.PX),a=$d.SelectionFactory.z6e(b.Zg));if(!a)return 8;this.cOd&&!f.iua&&da.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.EWe.Ueb(Bc.SelectionEditor.Yhg(a))?c=c(b):(c=new eC(b),c.wl=a,c=new uf.a(null,Object(R.a)(this,this.UNb,"processSetSelection"),c),c.Fm("ExpandSelection"),c.Lh());return c.f1?1:32}Njj(a,b,c,f,l){return b.view.Wp?this.Jua(b,c,Object(R.a)(this,this.vUh,"startOperationOfSelectAllInOutline")):
this.VJh(a,b,c,f,l)}UNb(a,b){return 0===b.ar?(b.transaction=this.lm.xe(2),b.transaction.rd(b.Yf.Zg),b.ar=1,!0):1===b.ar?(b.Yf.Rb.nRb(b.wl,a),b.ar=2,!0):2===b.ar?(b.Yf.Rb.Oa.iua=b.wl.iua,this.Fo.Bx(),b.transaction.pW(a),b.ar=3,b.transaction.dispose(),He.a.mark(5799),!0):!1}VJh(a,b,c){if(1===c)return 32;if(!b.view.xi)return 2;a=b.view;return a.Rb&&a.Rb.Oa&&a.Rb.Oa.kb?this.vUh(a).f1?1:32:8}vUh(a){this.cOd&&a.Wp&&da.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");a=new uf.a(null,Object(R.a)(this,
this.fml,"processSelectAllInOutline"),new eC(a));a.Fm("SelectAllInOutline");a.Lh();return a}fml(a,b){if(0===b.ar)return b.wl=$d.SelectionFactory.tLl(b.Yf.Rb.Oa.kb),b.transaction=this.lm.xe(2),b.transaction.rd(b.Yf.Zg),b.ar=1,!0;if(1===b.ar){if(!b.ayb)return U.a.instance.ga(77)&&U.a.instance.ga(104)&&b.wl.qm?(b.Yf.Rb.nRb(b.wl,a),b.ayb=b.wl.length):(b.Yf.Rb.setSelection(b.wl.ga(0),a),++b.ayb),!0;if(b.ayb<b.wl.length)return b.Yf.Rb.PKf(b.wl.ga(b.ayb),a),++b.ayb,!0;b.ar=2}return 2===b.ar?(b.Yf.Rb.Oa.iua=
b.wl.iua,this.Fo.Bx(),b.transaction.pW(a),b.ar=3,b.transaction.dispose(),!0):!1}mxd(a,b,c){if(1===c)return 32;if(!b.view.xi)return 2;b=b.view;a=$d.SelectionFactory.z6e(b.Zg);if(!a)return 8;b=new eC(b);b.wl=a;a=new uf.a(null,Object(R.a)(this,this.UNb,"processSetSelection"),b);a.Fm("ExpandSelection");a.Lh();return a.f1?1:32}static get tnb(){return Ls.u8a||(Ls.u8a=Tb.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static ORe(a,b,c){if(1===c)return 32;if(!b.view.xi)return 8;a=b.view;b=$d.SelectionFactory.hk(a.root.graphNode,
!0);if(!b)return 8;a.Rb.setSelection(b);return 32}static iRh(){if(!U.a.instance.ga(75))return 2;var a=ad.App.Ob.ie.dM;if(!a.xi)return 2;if(a.xi&&1!==ad.App.Ob.state){He.a.mark(4668);var b=a.Rb.Oa.kb;if(!b&&A.AFrameworkApplication.fa.getBooleanAppSetting("ContextMenuOnSelectionFixIsEnabled"))return 2;b=Bc.SelectionEditor.gla(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;Ls.tnb.sca(new Sys.UI.Point(c,
f),1);He.a.mark(4669)}return 32}}Ls.u8a=null;Object(m.a)(Ls,"SelectAllHandlers",null,[1756]);class mG{constructor(a){this.Sf=a}S7e(a,b){this.Sf.rW(a,b.cache.tM);this.Sf.$q(a,b.cache.fontSize)}E7e(){}uie(){return null}dY(){return null}mWa(){return null}o$(){return null}DQh(){return!1}}Object(m.a)(mG,"FormattingStewardBridge",null,[1745]);var aO=d(751),YS=d(700);class bO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.Sd=()=>{};this.OGa=()=>{const Ub=this.gb.Pk();return Ub?Ub.OGa():null};this.onShapeSelected=
(Ub,Xb)=>{this.tq.B3e(this.onShapeSelected);Xb.shapeNode.z1?32!==this.ia.nb(M.a.Y9a,2)&&ya.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):ya.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")};this.XJh=()=>{const Ub=this.OGa();return Ub?(this.tq.o_d(this.onShapeSelected),this.gb.selectShape(Ub,!0),!0):!1};this.xBg=()=>{const Ub=this.gb.Xe();return!!Ub&&1===Ub.length&&!!this.OGa()};this.wFg=()=>{var Ub=this.gb.Hd();
if(1!==Ub.length)return!1;Ub=Ub[0];return!Ub.z1&&!Ub.Lf&&!Ub.Rg&&!Ub.ig&&Ub.hasText&&0<Ub.textLength()};this.DTj=(Ub,Xb,tc,lc,Ec)=>{if(1===tc)return 32;var hd=this.OGa();const yd=this.gb.Hd(),Pd=1===yd.length?yd[0]:null;0<yd.length&&Pd!==hd?this.wFg()?(hd=3,Ub=this.vtg(Ub,Xb,tc,lc,Ec)):(hd=4,Ub=32):this.xBg()?(hd=1,Ub=this.msg(Ub,Xb,tc,lc,Ec)):this.Czg()?(hd=2,Ub=this.Qrg(Ub,Xb,tc,lc,Ec)):(ya.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),hd=5,Ub=8);lc&&(lc.ED=hd);
return Ub};this.msg=(Ub,Xb,tc)=>1===tc?this.xBg()?32:2:this.XJh()?32:8;this.Rrg=(Ub,Xb,tc)=>{if(1===Xb)return this.Czg()?32:2;Xb=new Date;const lc=this.Eb.ud(15,void 0,void 0,()=>{const Ec=this.gb.Xe();if(Ec&&1===Ec.length){const hd=new Date;let yd=0;yd=window.setInterval(()=>{this.XJh()?window.clearInterval(yd):2E3<+new Date-+hd&&(ya.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(yd))},100)}});try{ya.a.J(509724643,
822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",tc);lc.mc(this.K6.Of);lc.Wc=Ub;for(const Ec of this.gb.Xe())Ec&&!Ec.OGa()&&(Ec.OHa=tc)}finally{lc&&lc.dispose()}Ub=new Date;ya.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",tc);if(tc=$c.a.Kb)tc.Xm("AddSlideTitleStart",Xb),tc.Xm("AddSlideTitleEnd",Ub),tc.tk=!1,tc.gq=!0,$c.a.Y2(tc);return 32};this.Qrg=(Ub,Xb,tc)=>this.Rrg(Ub,tc,!1);this.FTj=(Ub,Xb,tc)=>this.Rrg(Ub,tc,!0);this.vtg=(Ub,Xb,tc)=>{if(1===tc)return this.wFg()?
32:2;tc=this.gb.Pk();const lc=this.gb.Hd();if(1!==lc.length)return ya.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;Xb=new Date;const Ec=this.Eb.ud(15);try{ya.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",tc.Fb.cid,lc[0].get_shapeId()),Ec.mc(tc),Ec.Wc=Ub,tc.JNa=lc[0].get_shapeId()}finally{Ec&&Ec.dispose()}Ub=new Date;ya.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",tc.Fb.cid,
lc[0].get_shapeId());if(tc=$c.a.Kb)tc.Xm("SetAsSlideTitleStart",Xb),tc.Xm("SetAsSlideTitleEnd",Ub),tc.tk=!1,tc.gq=!0,$c.a.Y2(tc);32!==this.ia.nb(M.a.Y9a,2)&&ya.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32};this.uWj=(Ub,Xb,tc)=>this.gb.i1()?this.ia.nb(G.a.fdc,tc):this.ia.nb(M.a.iWc,tc);this.BTj=(Ub,Xb,tc)=>{if(1===tc)return 32;Ub={};this.nad&&(Ub.query="AssetID="+this.nad);Xb={};Xb.BA=ResourceStrings.L_Help;Xb.assetId="FA000000012";Xb.nonPersistedSettings=
Ub;Xb.vif=!1;return this.ia.Ia(M.a.Aia,2,Xb)};this.tkk=()=>{if(!this.gpc)return!1;const Ub=this.gb.rf();return 1!==Ub.length?!1:Ub[0].sK};this.Ktg=(Ub,Xb,tc)=>{const lc=this.sa.Aa;if(!lc||this.ic.Xc(lc))return 8;if(1===tc)return this.tkk()?32:2;Xb=$c.a.Zj("Captions::Insert");try{return YS.a.Baf(".vtt",aO.e,()=>aO.d(Ub,this.gbk,"captions",this.Pe,lc),"captions",lc,this.sa.presentation,this.ic,this.fe,Xb,!1,this.Thb,50,10,3),Xb&&Xb.Wa("CaptionsDialogInitialized","true"),32}catch(Ec){ya.a.J(509724637,
818,10,"Error while rendering new captions selection dialog.")}Xb&&(Xb.Wa("CaptionsDialogInitialized","false"),Xb.finish(),Xb=null);return 8};this.gbk=(Ub,Xb,tc,lc,Ec,hd,yd)=>{lc.iP(tc)&&ya.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+tc.ula);lc.vL(tc);Ec&&Ec.Wa("CaptionsUploadToRC","true");Object(md.a)("FixForInsertMediaSlideNavigationIssue")||(yd=this.sa.Aa);if(yd&&yd.isConnected&&(hd=hd.files[0].name,lc=tc=
"",yd=hd.split("."),2<=yd.length&&(lc=yd[yd.length-2]),Ea.a.Oe(lc)||(tc=hd.lastIndexOf("."),tc=0<=tc?hd.substring(0,tc):hd,lc=""),hd=this.gb.rf(),1===hd.length)){hd=hd[0];yd=this.Eb.ud(15);try{yd.mc(hd),yd.Wc=Ub,Ec&&Ec.Wa("InsertCaptionsInProgress","true"),hd.lxb=Xb,hd.jxb=tc,hd.kxb=lc}finally{yd&&yd.dispose()}Ec&&(Ec.Wa("InsertCaptionsSuccessful","true"),Ec.finish())}};this.Vok=()=>{if(!this.gpc)return!1;const Ub=this.gb.rf();return 1!==Ub.length?!1:Ub[0].sK};this.wZj=(Ub,Xb,tc)=>{if(1===tc)return this.Vok()?
32:2;Xb=this.gb.rf();if(1!==Xb.length)return 16;tc=Xb[0];Xb=new Date;const lc=this.Eb.ud(15);try{ya.a.J(509724635,822,50,"RemoveAllCaptions started"),lc.mc(tc),lc.Wc=Ub,tc.EEb=!0}finally{lc&&lc.dispose()}Ub=new Date;ya.a.J(509724634,822,50,"RemoveAllCaptions completed");if(tc=$c.a.Kb)tc.Xm("RemoveAllCaptionsStart",Xb),tc.Xm("RemoveAllCaptionsEnd",Ub),tc.tk=!1,tc.gq=!0,$c.a.Y2(tc);return 32};this.isInHighContrastMode=()=>window.matchMedia("screen and (forced-colors: active)").matches;this.VWj=(Ub,
Xb,tc,lc)=>{if(this.isInHighContrastMode())return 2;if(1===tc)return 32;Ub=document.getElementById("WACDocumentPanel");(Xb=Sys.UI.DomElement.containsCssClass(Ub,"GrayscaleDocumentContent"))?Sys.UI.DomElement.removeCssClass(Ub,"GrayscaleDocumentContent"):Sys.UI.DomElement.addCssClass(Ub,"GrayscaleDocumentContent");this.nv.CB();lc&&(lc.ED=Xb?0:1);return 32};this.juc=(Ub,Xb,tc,lc,Ec)=>{Ec.Rf(Sys.UI.DomElement.containsCssClass(document.getElementById("WACDocumentPanel"),"GrayscaleDocumentContent")&&!this.isInHighContrastMode());
return 32};this.nKh=()=>{const Ub=this.gb.rf();return 0===Ub.length?!1:!Ub.some(Xb=>!Xb||!Xb.KM)};this.iXj=(Ub,Xb,tc,lc)=>{Xb=this.gb.rf();if(1===tc)return 0<Xb.length?32:2;tc=new Date;const Ec=this.Eb.ud(15);try{ya.a.J(509092049,822,50,"handleMarkAsDecorative started");Ec.mc(this.gb.Pk());Ec.Wc=Ub;const hd=this.nKh();for(const yd of Xb)yd&&yd.KM===hd&&(yd.KM=!hd);lc&&(lc.ED=hd?0:1)}finally{Ec&&Ec.dispose()}Ub=new Date;ya.a.J(509092048,822,50,"HandleMarkAsDecorative completed");if(lc=$c.a.Kb)lc.Xm("MarkAsDecorativeStart",
tc),lc.Xm("MarkAsDecorativeEnd",Ub),lc.tk=!1,lc.gq=!1,$c.a.Y2(lc);return 32};this.ouc=(Ub,Xb,tc,lc,Ec)=>{Ec.Rf(this.nKh());return 32};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("pptSelectionManager");if(!c)throw Error.argumentNull("transactionFactory");if(!f)throw Error.argumentNull("pptWorkspace");if(!l)throw Error.argumentNull("graphOperationEventSource");if(!u)throw Error.argumentNull("graphTopologyManager");if(!I)throw Error.argumentNull("graphActionBlockingManager");
if(!T)throw Error.argumentNull("errorHandler");if(!ja)throw Error.argumentNull("sessionInfo");if(!ua)throw Error.argumentNull("ribbonUser");this.ia=a;this.gb=b;this.Eb=c;this.K6=f;this.tq=l;this.sa=u;this.ic=I;this.fe=T;this.Pe=ja;this.nv=ua;this.nad=Ra;this.gpc=eb;this.Thb=Bb}qb(){this.ia.pa(M.a.OJf,wc.a.application,this.DTj,12);this.ia.pa(M.a.editSlideTitle,wc.a.application,this.msg,4);this.ia.pa(M.a.addSlideTitle,wc.a.application,this.Qrg,4);this.ia.pa(M.a.fKf,wc.a.application,this.FTj,4);this.ia.pa(M.a.setAsSlideTitle,
wc.a.application,this.vtg,4);this.ia.pa(M.a.vvh,wc.a.application,this.uWj,4);this.ia.xa(M.a.NIf,wc.a.application,this.BTj);this.ia.pa(M.a.gyg,ta.a.application,this.Ktg,4);this.ia.pa(M.a.hyg,ta.a.application,this.Ktg,4);this.ia.pa(M.a.CCh,wc.a.application,this.wZj,4);this.ia.pa(M.a.Cyg,ta.a.application,this.VWj,12);this.ia.pa(M.a.juc,ta.a.application,this.juc,96);this.ia.pa(M.a.IQe,ta.a.application,this.iXj,12);this.ia.pa(M.a.ouc,ta.a.application,this.ouc,96)}Czg(){for(const a of this.gb.Xe())if(a&&
!a.OGa())return!0;return!1}}Object(m.a)(bO,"AccessibleAuthoringActor",null,[948]);var ZS=d(136),$S=d(182);class cO{constructor(a,b,c,f){this.sed=!1;this.oaa="";this.SHb=!1;this.e0a=null;this.Dbd=-1;this.$Hb=!1;this.Fna=[];this.Lb=b;this.ka=c;this.lld=f;a&&this.Lb.Ue(()=>{a.AG(Object(R.a)(this,this.w9k,"onSelectionChangeFinished"))})}qb(){}Sd(){}Zac(a,b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}x1c(a){const b=[];for(let c=
0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}Ung(a){const b=[];let c=!1;if(a){switch(this.oaa){case "FormatPicture":Array.addRange(b,this.x1c("PictureStyles"));c=!0;break;case "Table":this.$Hb||Array.addRange(b,this.x1c("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,
this.x1c("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.x1c("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.Zac(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.Zac(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",0)),Array.addRange(b,this.Zac(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.$Hb&&(a=0),Array.addRange(b,this.Zac(this.e0a,"DropLabel",
a)),a=this.e0a.slice(0,this.e0a.length).reverse(),Array.addRange(b,this.Zac(a,"MoveToOverflow",null)))}else for(const f of this.e0a)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}Kge(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.vIa("Error","GetModelType failed for "+c),null}return b}Yge(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}mUb(a){this.lld&&
(a=this.Kge(a))&&this.lld(a)}Ggm(a){if(a.length){if(this.lld){var b=this.Kge(a);if(!b)return;var c=this.Yge(this.oaa);if(0<c.length&&!this.SHb){for(var f of c)this.Fna.push(appChrome.actions.updateGroupHiddenState(f,!0));this.SHb=!0}else if(this.SHb&&!c.length){c=[];f=this.Yge("FormatPicture");for(var l of f)this.Fna.push(appChrome.actions.updateGroupHiddenState(l,!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.Kge(c))for(const u in l)b[u]=l[u];this.SHb=!1}this.lld(b)}this.e0a=
a;b=[];for(const u of a)appChrome.selectors.isControlDisabled(u)&&b.push(u);0<b.length&&this.vIa("Disabled",b.join(","));0<this.e0a.length&&(this.Fna.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.Fna.push(appChrome.actions.updateControlsInGroup("Adaptive",this.e0a)),Array.addRange(this.Fna,this.Ung(!0)),this.sed=!0)}}mGh(a){""!==this.oaa&&this.oaa!==a&&Array.addRange(this.Fna,this.Ung(!1))}bhf(a,b){if(a||this.sed)if(this.Fna.push(appChrome.actions.updateGroupHiddenState("Adaptive",
!a)),this.sed=a,b=this.Yge(b),a&&0<b.length||this.SHb){for(var c of b)this.Fna.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.mUb(c));this.SHb=a}}k6f(){0<this.Fna.length&&(appChrome.api.dispatch(this.Fna),this.Fna=[])}BSi(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.mUb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;
a=!1;if("Table"===b&&Pj.a.instance.kb){const c=!Pj.a.instance.kb.qm&&!Pj.a.instance.kb.h9c;if(a=(""===this.oaa||this.oaa===b)&&c!==this.$Hb)this.$Hb=c}a?this.mGh("TableCellEdit"):this.mGh(b);this.oaa=b;return!0}ALl(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();for(const f of a)if(this.BSi(c,f)){b=!0;break}return b?this.oaa:""}Fuj(){switch(this.oaa){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Table":return this.$Hb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");
case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}w9k(a,
b){if(!this.ka.DAa&&"Home"===appChrome.selectors.getSelectedTabId()&&b.wl&&b.wl.kb&&b.wl.length){var c=()=>{const f=this.oaa;""===this.ALl()?this.bhf(!1,f):this.$Hb||""===f||f!==this.oaa?this.Ggm(this.Fuj()):this.sed||(this.mUb(this.e0a),this.bhf(!0,this.oaa));this.k6f()};-1!==this.Dbd&&window.clearTimeout(this.Dbd);this.Dbd=window.setTimeout(()=>{this.Dbd=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.bhf(!1,this.oaa),this.k6f()}vIa(a,
b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};ZS.a.sendActivityEvent(Object.assign(new $S.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:jD.a.YH(a),durationMs:window.performance.now()}))}}Object(m.a)(cO,"AdaptiveTabGroupUpdaterActor",null,[948]);class dO{constructor(a){this.kfa=()=>this.lJa?this.lJa:this.lJa=Tb.a.instance.ub("PowerPointWebEditor.IImageDescriptionPane");this.PTj=(b,c,f,l)=>{if(b!==M.a.aPc)return 16;if(!this.kfa())return 8;if(1===
f)return 32;this.kfa().t0l();l&&(l.ED=this.kfa().isVisible?1:0);return 32};this.dOb=(b,c,f,l,u)=>{if(b!==M.a.dOb)return 16;u&&u.Rf(this.kfa()?this.kfa().isVisible:!1);return 32};this.pUj=(b,c,f,l)=>{if(b!==M.a.BPc)return 16;if(!this.kfa())return 8;if(1===f)return 32;this.kfa().lFi();l&&(l.ED=1);return 32};this.HVj=(b,c,f)=>{if(b!==M.a.iWc)return 16;if(!this.kfa())return 8;if(1===f)return 32;this.kfa().D7f();return 32};if(!a)throw Error.argumentNull("actionManager");this.ia=a}qb(){this.ia.pa(M.a.aPc,
ta.a.view,this.PTj,12);this.ia.pa(M.a.dOb,ta.a.application,this.dOb,96);this.ia.pa(M.a.BPc,ta.a.view,this.pUj,12);this.ia.pa(M.a.iWc,ta.a.view,this.HVj,4)}Sd(){}}Object(m.a)(dO,"AltTextActor",null,[948]);class eO{constructor(a,b,c,f,l,u,I,T){this.qF=null;this.ia=a;this.gb=b;this.Fa=c;this.Eb=f;this.cgb=l;this.uxa=u;this.rc=T;this.cgb&&this.cgb.execute(ja=>{this.qF=ja})}qb(){this.ia.pa(M.a.LPc,wc.a.application,Object(R.a)(this,this.rUj,"handleAudioPlay"),96);this.ia.pa(M.a.U3b,wc.a.application,Object(R.a)(this,
this.qUj,"handleAudioPause"),96);this.ia.pa(M.a.kQf,wc.a.application,Object(R.a)(this,this.TGi,"audioPlayPauseCommandHandler"),96);this.ia.pa(M.a.oLh,wc.a.application,Object(R.a)(this,this.ncc,"handleSetAudioOptions"),96);this.ia.pa(M.a.$tc,wc.a.application,Object(R.a)(this,this.$tc,"queryAudioOptions"),96);this.ia.pa(M.a.playAcrossSlides,wc.a.application,Object(R.a)(this,this.ncc,"handleSetAudioOptions"),96);this.ia.pa(M.a.suc,wc.a.application,Object(R.a)(this,this.suc,"queryPlayAcrossSlides"),96);
this.ia.pa(M.a.loopUntilStopped,wc.a.application,Object(R.a)(this,this.ncc,"handleSetAudioOptions"),96);this.ia.pa(M.a.nuc,wc.a.application,Object(R.a)(this,this.nuc,"queryLoopUntilStopped"),96);this.ia.pa(M.a.hideDuringShow,wc.a.application,Object(R.a)(this,this.ncc,"handleSetAudioOptions"),96);this.ia.pa(M.a.huc,wc.a.application,Object(R.a)(this,this.huc,"queryHideDuringShow"),96);this.ia.pa(M.a.rewindAfterPlaying,wc.a.application,Object(R.a)(this,this.ncc,"handleSetAudioOptions"),96);this.ia.pa(M.a.yuc,
wc.a.application,Object(R.a)(this,this.yuc,"queryRewindAfterPlaying"),96);this.ia.xa(M.a.playInBackground,wc.a.application,Object(R.a)(this,this.wtg,"handleSetAudioStyles"));this.ia.xa(M.a.noAudioStyle,wc.a.application,Object(R.a)(this,this.wtg,"handleSetAudioStyles"));this.ia.pa(M.a.tuc,wc.a.application,Object(R.a)(this,this.tuc,"queryPlayInBackground"),96);this.ia.pa(M.a.puc,wc.a.application,Object(R.a)(this,this.puc,"queryNoAudioStyle"),96);this.ia.pa(M.a.setVolume,wc.a.application,Object(R.a)(this,
this.occ,"handleSetVolume"),96);this.ia.pa(M.a.Dzd,wc.a.application,Object(R.a)(this,this.occ,"handleSetVolume"),96);this.ia.pa(M.a.Cuc,wc.a.application,Object(R.a)(this,this.Cuc,"querySetVolumeLow"),96);this.ia.pa(M.a.Ezd,wc.a.application,Object(R.a)(this,this.occ,"handleSetVolume"),96);this.ia.pa(M.a.Duc,wc.a.application,Object(R.a)(this,this.Duc,"querySetVolumeMedium"),96);this.ia.pa(M.a.Czd,wc.a.application,Object(R.a)(this,this.occ,"handleSetVolume"),96);this.ia.pa(M.a.Buc,wc.a.application,Object(R.a)(this,
this.Buc,"querySetVolumeHigh"),96);this.ia.pa(M.a.Fzd,wc.a.application,Object(R.a)(this,this.occ,"handleSetVolume"),96);this.ia.pa(M.a.Euc,wc.a.application,Object(R.a)(this,this.Euc,"querySetVolumeMute"),96);this.ia.pa(M.a.cUh,wc.a.application,Object(R.a)(this,this.G_j,"handleStartAudio"),96);this.ia.pa(M.a.Nuc,wc.a.application,Object(R.a)(this,this.Nuc,"queryStartAudio"),96)}Sd(){}rUj(a,b,c,f,l){b=this.gb.Hd();if(1<b.length||!this.qF)return 16;const u=this.qF.vM(b[0]);if(!u||!u.isPlayerReady())return 16;
if(1===c)return 32;let I=!1;l&&(I=!!l.ActionFromPlayer);return jh.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",I.toString(),a,()=>{u&&!I&&u.startPlaying();const T=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(T);return 32})}qUj(a,b,c,f,l){const u=this.gb.Hd();if(1<u.length||!this.qF)return 16;if(1===c)return 32;let I=
!1;l&&(I=!!l.ActionFromPlayer);return jh.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",I.toString(),a,()=>{var T=this.qF.vM(u[0]);T&&!I&&T.pause();T=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(T);return 32})}TGi(){var a=this.gb.$1c();if(!a||!this.qF)return 2;(a=this.qF.vM(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?
this.ia.nb(M.a.U3b,2):this.ia.nb(M.a.LPc,2));return 32}ncc(a,b,c,f,l){if(1===c)return 32;if(!l)return ya.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const u=l.On;return jh.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const I=this.gb.rf();if(I&&0<I.length){const T=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{T.mc(I[0]);for(const ja of I){if(!ja||!ja.media)continue;const ua=ja.media;switch(a){case M.a.playAcrossSlides:ua.plyAcrssSldsField=
u;break;case M.a.loopUntilStopped:ua.repeatField=u;break;case M.a.hideDuringShow:ua.hideDrngShwField=u;break;case M.a.rewindAfterPlaying:ua.rewindField=u}ja.media=ua;if(this.uxa&&this.qF&&(a===M.a.loopUntilStopped||a===M.a.rewindAfterPlaying)){const Ra=this.qF.vM(ja);Ra&&(a===M.a.loopUntilStopped?Ra.setRepeat(ua.repeatField):a===M.a.rewindAfterPlaying&&Ra.setRewind(ua.rewindField))}}}finally{T&&T.dispose()}}return 32})}wtg(a,b,c,f,l){return 1===c?32:l?jh.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",
l.SourceControlId,a,()=>{const u=this.gb.rf();if(u&&0<u.length){const I=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{I.mc(u[0]);for(const T of u){if(!T||!T.media||T.Rg)continue;const ja=T.media;switch(a){case M.a.playInBackground:ja.plyAcrssSldsField=!0;ja.repeatField=!0;ja.hideDrngShwField=!0;ja.strtField=0;break;case M.a.noAudioStyle:ja.plyAcrssSldsField=!1,ja.repeatField=!1,ja.hideDrngShwField=!1,ja.strtField=2}T.media=ja}}finally{I&&I.dispose()}}return 32}):(ya.a.J(512500761,822,
10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),8)}G_j(a,b,c,f,l){if(1===c)return 32;if(!l)return ya.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const u=l.CommandValueId;return jh.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",u,a,()=>{if(!u||""===u.trim())return 32;const I=this.gb.rf();if(I&&0<I.length){const T=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{T.mc(I[0]);for(const ja of I){if(!ja||!ja.media||
ja.Rg)continue;const ua=ja.media;ua.strtField="Automatically"===u?0:2;ja.media=ua}}finally{T&&T.dispose()}}return 32})}tuc(a,b,c,f,l){return this.Hza(l,1)}puc(a,b,c,f,l){return this.Hza(l,0)}occ(a,b,c,f,l){return 1===c?32:l?jh.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const u=this.gb.rf();if(u&&0<u.length){const I=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{I.mc(u[0]);for(const T of u){if(!T||!T.media)continue;const ja=T.media;switch(a){case M.a.Fzd:ja.mteField=
!0;break;case M.a.Dzd:ja.vlmField=.2;ja.mteField=!1;break;case M.a.Ezd:ja.vlmField=.5;ja.mteField=!1;break;case M.a.Czd:ja.vlmField=.8,ja.mteField=!1}this.rc.OM&&(T.media=ja);const ua=l.ActionFromPlayer;if(this.uxa&&this.qF&&!ua){const Ra=this.qF.vM(T);Ra&&(Ra.setMute(ja.mteField),Ra.setVolume(ja.vlmField))}}}finally{I&&I.dispose()}}return 32}):(ya.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}Cuc(a,b,c,f,l){return this.Hza(l,2)}Duc(a,b,c,f,l){return this.Hza(l,
3)}Buc(a,b,c,f,l){return this.Hza(l,4)}Euc(a,b,c,f,l){return this.Hza(l,5)}Nuc(a,b,c,f,l){if(a=Object(gb.a)(Di.a,l))c=this.gb.rf(),b=this.tEg(c,2),c=this.tEg(c,0),b?(a.H0=ResourceStrings.L_AudioStartWhenClickedOn,a.kxc()):c&&(a.H0=ResourceStrings.L_AudioStartAutomatically,a.kxc());return 32}$tc(){this.Vfc()&&ad.App.Ob.OB({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}suc(a,b,c,f,l){return this.Hza(l,
6)}nuc(a,b,c,f,l){return this.Hza(l,7)}huc(a,b,c,f,l){return this.Hza(l,9)}yuc(a,b,c,f,l){return this.Hza(l,8)}igj(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}ggj(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}tEg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}Hza(a,b){if(a=Object(gb.a)(Di.a,a)){const c=this.gb.rf();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=
this.ggj(l);break;case 1:f=this.igj(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Rf(f)}}return 32}Vfc(){return!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es}}
Object(m.a)(eO,"AudioPlaybackOptionsActor",null,[948]);class fO{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(m.a)(fO,"AudioSettingsTaskPaneProps",null,[]);class lv{constructor(){this.text=
this.key=null;this.itemType=0;this.selected=!1}}Object(m.a)(lv,"DropdownOption",null,[]);class gO{constructor(a,b,c,f,l){this.uN=null;this.zJa=this.Mb=!1;a("audio-settings-strings").then(()=>{this.zJa=!0;ya.a.J(509138197,833,50,"audio-settings-strings loaded successfully")}).catch(u=>{ya.a.J(509138196,833,10,"Failed to load audio-settings-strings "+u.toString())});this.ia=b;this.YG=f;this.Mc=c;this.vP=l}qb(){this.ia.xa(M.a.BAd,wc.a.application,Object(R.a)(this,this.BAd,"showHideAudioSettingsPane"));
this.ia.pa(M.a.EOb,wc.a.application,Object(R.a)(this,this.EOb,"queryShowHideAudioSettingsPane"),96)}Sd(){}BAd(a,b,c){return b.contextId===wc.a.application&&this.zJa?1===c?32:jh.a("AudioSettingsPaneToggle",a,()=>{(this.Mb=!this.Mb)?(this.Jl(),this.vP.vxi(Object(R.a)(this,this.jlh,"onAudioDevicesChanged")),ya.a.J(509138195,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.vP.uAl(Object(R.a)(this,this.jlh,"onAudioDevicesChanged")),this.FO(),ya.a.J(509138194,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));
return 32}):2}EOb(a,b,c,f,l){if(!Object(gc.a)(Di.a,l))return 8;l.Rf(this.Mb);return 32}Jl(a){(a=void 0===a?!1:a)||this.SA();const b=Object.assign(new jv.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.uN,onOpen:()=>{},onClose:()=>{this.Mb=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.YG.Lfa(xc.a.oEa,xc.a.Nj,c,()=>{this.FB(!0)},()=>{this.FB(!1)});Gj.UISurfaces.qr().then(f=>{a?this.Mb&&f.updateTaskPane(xc.a.oEa,b):
f.showTaskPane(xc.a.oEa,b);return null}).catch(f=>{ya.a.J(509138193,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}FO(){Gj.UISurfaces.qr().then(a=>{a.hideTaskPane(xc.a.oEa,2);return null}).catch(a=>{ya.a.J(509138192,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}SA(){this.uN=Object.assign(new fO,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.BNj(),availableSubtitleLanguages:this.lOj(),onMicrophoneUpdated:Object(R.a)(this,
this.ejm,"updateMicrophone"),onSpeakersUpdated:Object(R.a)(this,this.Akm,"updateSpeaker"),onSpokenLanguageUpdated:Object(R.a)(this,this.Dkm,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(R.a)(this,this.Jkm,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.vP.enumerateDevices(Object(R.a)(this,this.Vqc,"onEnumerateDevicesSuccess"),Object(R.a)(this,this.h1a,"onDevicesFailure"),Object(R.a)(this,this.q1a,"onUnsupported"))}FB(a){const b=
document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");a&&b&&b.focus()}Vqc(a){if(0!==a.length)if(Aa.a.Ta(a[0].label))this.vP.requestPermission(Object(R.a)(this,this.V8k,"onRequestPermissionSuccess"),Object(R.a)(this,this.h1a,"onDevicesFailure"),Object(R.a)(this,this.q1a,"onUnsupported")),ya.a.J(509138191,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new La.a,c=new La.a;for(const f of a)Aa.a.Ta(f.deviceId)||(a=Object.assign(new lv,{key:f.deviceId,
text:Aa.a.Ta(f.label)?f.deviceId:f.label}),"audiooutput"===f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.uN.deviceMicrophones=b.toArray();this.uN.deviceSpeakers=c.toArray();this.uN.disableDeviceDropdown=!1;this.uN.showDeviceErrorMessage=!1;this.Jl(!0)}}V8k(){this.vP.enumerateDevices(Object(R.a)(this,this.Vqc,"onEnumerateDevicesSuccess"),Object(R.a)(this,this.h1a,"onDevicesFailure"),Object(R.a)(this,this.q1a,"onUnsupported"));
ya.a.J(509138190,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}h1a(a){this.uN.disableDeviceDropdown=!0;this.uN.showDeviceErrorMessage=!0;this.Jl(!0);ya.a.J(509138189,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}q1a(){this.uN.disableDeviceDropdown=!0;this.Jl(!0);ya.a.J(509138188,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",E.a.nx)}ejm(a){this.vP.microphoneDeviceId=
a.key;ya.a.J(509138187,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}Akm(){ya.a.J(509138186,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}jlh(a,b){b.lXk&&this.vP.enumerateDevices(Object(R.a)(this,this.Vqc,"onEnumerateDevicesSuccess"),Object(R.a)(this,this.h1a,"onDevicesFailure"),Object(R.a)(this,this.q1a,"onUnsupported"))}BNj(){const a=new La.a;for(const b of this.Mc.Gcf)a.add(Object.assign(new lv,{key:b,text:Ea.a.Oe(b).displayName,selected:this.Mc.hra.toLowerCase()===
b.toLowerCase()}));a.add(Object.assign(new lv,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new lv,{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(const b of this.Mc.Fcf)a.add(Object.assign(new lv,{key:b,text:Ea.a.Oe(b).displayName,selected:this.Mc.hra.toLowerCase()===b.toLowerCase()}));return a.toArray()}lOj(){const a=new La.a;for(const b of this.Mc.jbf)a.add(Object.assign(new lv,{key:b,text:Ea.a.Oe(b).displayName,selected:this.Mc.rBa.toLowerCase()===
b.toLowerCase()}));return a.toArray()}Dkm(a){this.Mc.hra=a.key;ya.a.J(509138185,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}Jkm(a){this.Mc.rBa=a.key;this.Mc.Mpb=this.Mc.H2c();ya.a.J(509138184,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(m.a)(gO,"AudioSettingsPaneActor",null,[948]);class hO{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;
this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(m.a)(hO,"CaptionDiscoverabilityTaskPaneProps",null,[]);class bx{constructor(a,b,c,f,l,u,I,T,ja,ua){this.MYg=!1;a("powerpoint-discoverability-strings").then(()=>{this.MYg=!0;ya.a.J(509138209,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Ra=>{ya.a.J(509138208,801,10,"Failed to load powerpoint-discoverability-strings "+Ra.toString())});this.ia=b;this.Hc=c;this.Wb=f;this.te=
l;this.YG=u;this.Mc=I;this.vP=T;this.qMk=ua;this.tSk=ja;this.Cbh=Yi.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.Vkc=!1;this.Hc.BSa(Object(R.a)(this,this.Mha,"onRibbonTabSwitched"))}dispose(){this.Hc.Nvc(Object(R.a)(this,this.Mha,"onRibbonTabSwitched"))}qb(){this.ia.xa(M.a.Iyc,wc.a.application,Object(R.a)(this,this.Iyc,"showCaptionDiscoverabilityPane"))}Sd(){}Iyc(a,b,c){if(b.contextId!==wc.a.application||!this.MYg)return 2;if(1===c)return 32;if(bx.Wve||bx.fae||!this.hlj()||!this.glj())return 8;
this.Vkc||this.zRi(a);return 32}zRi(a){jh.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.Vkc=!0;this.vP.enumerateDevices(Object(R.a)(this,this.Q2k,"onAudioInputAvailable"),Object(R.a)(this,this.h1a,"onDevicesFailure"),Object(R.a)(this,this.q1a,"onUnsupported"));return 32})}Q2k(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.tSk.jYa()){bx.Wve=!0;this.Jl();break}this.Vkc=!1}}h1a(a){this.Vkc=!1;ya.a.J(509138207,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",
a.toString())}q1a(){this.Vkc=!1;ya.a.J(509138206,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",E.a.nx)}Jl(){const a=this.SA(),b=Object.assign(new jv.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{ya.a.J(509138205,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{ya.a.J(509138204,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.YG.Lfa(xc.a.kTa,
xc.a.Nj,null,()=>{},()=>{});Gj.UISurfaces.qr().then(c=>{c.showTaskPane(xc.a.kTa,b);return null}).catch(c=>{ya.a.J(509138203,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",c.toString())})}ur(){Gj.UISurfaces.qr().then(a=>{a.hideTaskPane(xc.a.kTa,2);return null}).catch(a=>{ya.a.J(509138202,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}SA(){return Object.assign(new hO,{podiumPresentationImageUrl:this.te.Ok("CaptionDiscoverabilityPromptViewImage.png"),
enableDoNotShowAgain:this.Cbh,onTurnOnButtonClicked:Object(R.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(R.a)(this,this.onDismissButtonClicked,"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(R.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){jh.a("CaptionDiscoverabilityPaneTurnOn",M.a.BOa,()=>{let a=8;this.Mc.ji||(a=this.ia.Ia(M.a.BOa,2,{}));this.qMk&&8!==a||this.ur();return a})}onDismissButtonClicked(){this.Cbh&&
(bx.fae=!0,ya.a.J(509138201,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.ur()}onLaunchSlideShowButtonClicked(){jh.a("CaptionDiscoverabilityPaneLaunchSlideshow",M.a.zSb,()=>{this.ur();return this.ia.nb(M.a.zSb,2)})}Mha(a,b){2!==b.Gv&&3!==b.Gv&&4!==b.Gv||!b.zha||"SlideShow"!==b.zha||jh.a("OnRibbonTabSwitched",M.a.Iyc,()=>this.ia.nb(M.a.Iyc,2))}glj(){let a=0,b=!1,c=!1;for(var f of this.Wb.hGa()){if(f.Hn){b=!0;break}if(f.XGa&&(a+=f.vR.length,4<=a))break;if(f.Bdb){c=!0;break}}f=c||b||
4<=a;ya.a.J(509138200,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",f.toString(),a.toString(),b.toString(),c.toString());return f}hlj(){return!this.Mc.ji&&this.Pkj()}Pkj(){const a=Ea.a.Oe(A.AFrameworkApplication.lcid);return!a||Aa.a.Ta(a.name)?!1:a.name.toLowerCase()===this.Mc.hra}static get Wve(){var a=Yi.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));
return 14>(+b-+a)/864E5}static set Wve(a){Yi.a.lL("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),Yi.a.VK)||ya.a.J(509138199,822,10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get fae(){const a=Yi.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set fae(a){Yi.a.lL("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),Yi.a.VK)||ya.a.J(509138198,822,10,"Failed to set cookie for discoverability opt out to {0}",
a.toString())}}Object(m.a)(bx,"CaptionDiscoverabilityPaneActor",null,[948]);var iO=d(749);class Wt{constructor(a,b){this.id=a;this.version=b}}Object(m.a)(Wt,"PackageAccessKey",null,[]);const cx=a=>a?Fe.c({["I"]:a.id,["V"]:a.version}):null;var wq=d(338),jO=d(981);class xz extends jO.a{constructor(a,b,c){super(a,b);this.oca=c}}Object(m.a)(xz,"ClipServiceShapeCopyParams",jO.a,[]);var nG=d(692),oG=d(730),pG=d(452);class yz{constructor(a,b,c){this.ia=a;this.Fa=b;this.fKa=c}yR(a){a=yz.jac(a);return this.fKa.iec(this.Fa)&&
!!a&&!!a.src}paste(a){A.AFrameworkApplication.YR?pG.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.ia.Ia(M.a.Asc,2,a)}static jac(a){if(!a||!a.Rn)return ya.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.Rn.getElementsByTagName(Df.a.C5);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(m.a)(yz,"ImagePasteHandler",null,[1856]);var dn=d(443);class qG{constructor(){this.Bwh=this.rae=null}}Object(m.a)(qG,"PasteSlideAsImageData",
null,[]);class rG{constructor(){this.pastedContent=this.vza=null}}Object(m.a)(rG,"PasteSlideAsImageFromRibbonData",null,[]);var fC=d(547);class sG extends Sys.EventArgs{constructor(a,b,c){super();this.nq=a;this.FQi=b;this.GQi=c}}Object(m.a)(sG,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class kO{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(m.a)(kO,"CopiedShape",null,[]);class lO{constructor(){this.Cid=this.Sid=0}}Object(m.a)(lO,"CopiedSlide",null,[]);class tG extends Yg.a{constructor(){super();
this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=null}om(){return 65}}Object(m.a)(tG,"CopyRequest",Yg.a,[]);class zz{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve){this.CKe=this.Ixa=null;this.ia=a;this.wP=f;this.Fa=l;this.ic=u;this.sa=I;this.Eb=T;this.iN=Ec;this.Qi=ja;this.Yb=ua;this.Dy=Ra;this.RIa=eb;this.yb=Bb;this.Lj=Ub;this.ka=b;this.oa=Xb;this.INg=tc;this.qOk=hd;this.De=lc;this.Tb=
yd;this.rOk=Pd;this.Ht=pe;this.JNe=this.ka.yHh;this.tq=Se;this.Fc=vf;this.oB=ug;this.Lw=Tg;this.H1g=$f;this.uI=Ve;if(!this.oB)throw ya.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");}qb(){this.ia.pa(M.a.g7d,wc.a.application,Object(R.a)(this,this.hVj,"handleCopySlidesToClipService"),0);this.ia.pa(M.a.ord,wc.a.application,Object(R.a)(this,this.Xme,"handlePasteSlidesFromClipService"),4);this.ia.pa(M.a.Bsc,wc.a.application,Object(R.a)(this,
this.bYj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.pa(M.a.bNb,wc.a.application,Object(R.a)(this,this.cYj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.pa(M.a.a0e,wc.a.application,Object(R.a)(this,this.ntd,"queryPasteOptions"),97);this.ia.pa(M.a.T_f,wc.a.application,Object(R.a)(this,this.gVj,"handleCopyShapesToClipService"),0);this.ia.pa(M.a.Fth,wc.a.application,Object(R.a)(this,this.ZXj,"handlePasteShapesFromClipService"),4);this.ia.pa(M.a.Hth,wc.a.application,
Object(R.a)(this,this.Wme,"handlePasteSlideFromDesktop"),4);this.ia.pa(M.a.nrd,wc.a.application,Object(R.a)(this,this.$Xj,"handlePasteSlideAsImage"),4);this.ia.pa(M.a.Gth,wc.a.application,Object(R.a)(this,this.aYj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.pa(M.a.g3f,wc.a.application,Object(R.a)(this,this.iVj,"handleCutShapes"),4);this.ia.pa(M.a.rce,wc.a.application,Object(R.a)(this,this.rce,"expandPasteFloatieMenu"),96);this.ia.pa(M.a.h3f,ta.a.application,Object(R.a)(this,this.jVj,"handleCutSlides"),
4);this.ia.pa(M.a.Kth,ta.a.application,Object(R.a)(this,this.SXj,"handlePasteCancelledByUser"),2048)}Sd(){}aYj(a,b,c,f,l){ya.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(gb.a)(rG,l);if(!a||!a.vza)return ya.a.J(512356639,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.vza.$b;b=this.Fc.yQ(2,1,"HandlePasteSlideAsImageFromRibbon");this.Fc.Ei("PasteSlideAsImageFromRibbon",c,b);a.vza.$b=b;this.oB.paste(a.vza,a.pastedContent,
!0);return 32}$Xj(a,b,c,f,l){a=Object(gb.a)(qG,l);if(!a||!a.rae)return ya.a.J(512356638,826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.oB.nrd(a.rae,a.Bwh);return 32}rce(a,b,c){if(1===c)return 32;this.qOk.Fpl();return 32}ntd(a,b,c,f,l){if(!this.Ht||!this.Ht.ilb)return 8;a=this.Ht.ilb.HB;l.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[Xh.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[Xh.a.On]=
null!=a&&a));return 32}cYj(a,b,c,f){if(1===c)return 32;const l=this.Ht.ilb;if(!l)return 8;const u=l.Cv,I=l.ON;if(!u&&!I)return 8;if(null!=l.HB&&l.HB)return 32;l.$b=this.Fc.yQ(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");l.HB=!0;const T=this.Tb.oy(this.Ht.bXe);ya.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(I)return I.skipUndo=!0,I.selectionSlide=T,this.Wme(a,b,c,f,l);u.skipUndo=!0;u.selectionSlide=T;return this.Xme(a,b,c,f,l)}bYj(a,
b,c,f){if(1===c)return 32;const l=this.Ht.ilb;if(!l)return 8;const u=l.Cv,I=l.ON;if(!u&&!I)return 8;if(null!=l.HB&&!l.HB)return 32;l.$b=this.Fc.yQ(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.HB=!1;const T=this.Tb.oy(this.Ht.bXe);ya.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(I)return I.skipUndo=!0,I.selectionSlide=T,this.Wme(a,b,c,f,l);u.skipUndo=!0;u.selectionSlide=T;return this.Xme(a,b,c,f,l)}gVj(a,b,c,f,l){a=Object(gb.a)(xz,
l);if(!a)return ya.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.Cv;c=a.oca;if(!b||!c||!c.length)return ya.a.J(512356634,307,50,"Copied shapes are empty."),this.Fc.Xg(!1,a.$b,23),8;if(this.ic.EXa())return this.Fc.Xg(!1,a.$b,2),16;if(rd.a.any(c,I=>I.K5))return ya.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];for(var u of c)f.push(Object.assign(new kO,{Sid:u.slideSid,Cid:u.slideCid,ShapeId:u.get_shapeId()}));u=Object.assign(new tG,{CcpId:b.nq,
Location:b.location,Shapes:f,CcpCorrelation:a.$b,PackageAccessKey:cx(new Wt(a.Cv.Cz,b.version))});this.iXc(u,2,a.$b);return 32}ZXj(a,b,c,f,l){b=Object(gb.a)(dn.a,l);if(!b)return 8;3!==b.Cv.dataType?this.Fc.fD(2,b.$b):(this.Fc.fD(7,b.$b),this.Fc.Uv(5,b.$b));c=b.Cv;if(!c)return this.Fc.Xg(!1,b.$b,16),ya.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.Cv.dataType&&this.Fc.Uv(oG.ClipboardHelper.uAg(c)?2:3,b.$b);f=this.sa.Aa;if(!f||!f.isConnected)return this.Fc.Xg(!1,
b.$b,3),ya.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",f?"not null":"null"),16;if(this.ic.Xc(f))return this.Fc.Xg(!1,b.$b,3),ya.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),2;if(!this.Lj.UD(f,c.objectCount))return this.Fc.Xg(!1,b.$b,8),ya.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.Lj.yE(f),16;this.KYd(c.nq,b.$b);$c.a.wBa("PasteShapesFromClipService",
!0);$c.a.CQ(!1,!1);this.CKe&&this.CKe===c.nq||(this.Ixa=new Md.a(0));f.EO=c.nq;f.mR=c.location;f.M4=c.EE;f.E0=zz.Ief(c.Lua);f.Cz=cx(new Wt(c.Cz,c.version));l=null;this.Fc.Ofc(b.$b)&&(l=yz.jac(b));if(this.JNe&&3===b.Cv.dataType)try{let u=0;this.Ixa&&this.Ixa.Ib(f.Fb)&&(u=this.Ixa.ga(f.Fb));this.ic.Z1d(f,a,u);ya.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(u){ya.a.J(512356627,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.RIa.m8i(f,
c,this.Ixa,a,b.$b,l);this.CKe=c.nq;this.Fc.Xg(!0,b.$b);return 32}iVj(a,b,c,f,l){if(this.ic.EXa())return 16;if(1===c)return 32;$c.a.CQ(!0,!0);const u=this.oa.rf();b=this.oa.Pk();var I=f=c=null;let T=[];l=Object(gb.a)(xz,l);if(!l)return 8;if(l.Cv){var ja=l.Cv;T=l.oca;if(!T||!T.length)return 8;c=ja.nq;I=ja.version;f=ja.location;I=cx(new Wt(ja.Cz,I))}else for(ja of u)ja.d9c&&T.push(ja);for(var ua of T)if(ua.Lf||ua.Rg){Xn(ua);break}ua=this.Eb.ud(15,void 0,()=>{this.oa.Bh()});try{ua.mc(b),ua.Wc=a,this.INg.fAh(new sG(c,
f,I)),b.$b=l.$b,b.XS(T)}finally{ua&&ua.dispose()}for(const Ra of T)this.tq.Ozh(new IL.a(Ra));this.wP.kze=c;return 32}jVj(a,b,c,f,l){b=this.oa.Xe();if(!b||!b.length||!this.sa.Aa)return 16;for(var u of b)if(!u||this.ic.Xc(u)||!u.isConnected)return 16;if(1===c)return 32;$c.a.Kb&&($c.a.Kb.actionName="CutSlide",$c.a.Kb.gq=!1,$c.a.Kb.tk=!0,$c.a.Kb.xG=new Date,$c.a.Kb.Wa("SlideCount",b.length.toString()));f=u=c=null;var I=[];l=Object(gb.a)(nG.a,l);if(!l)return 8;if(l.Cv){f=l.Cv;I=l.VSh;if(!I||!I.length)return 8;
c=f.nq;I=f.version;u=f.location;f=cx(new Wt(f.Cz,I))}I=this.Yb.Of;if(!I)return 16;const T=this.Eb.ud(15,void 0,()=>{this.oa.Bh()});try{this.INg.fAh(new sG(c,u,f));T.mc(I);for(const ja of b)ja&&!ja.Fb.equals(this.sa.Aa.Fb)&&I.QJ(ja);I.QJ(this.sa.Aa);T.Wc=a;I.$b=l.$b}finally{T&&T.dispose()}this.ka.unblockContentWhenDeletingSlideEnabled||this.ic.mx(I,a);this.tq?this.tq.rud(new fC.a(b)):ya.a.J(512356626,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.wP.kze=c;return 32}iXc(a,
b){this.wP.Y2k(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",wq.a.type,iO.a(b))];$c.a.Xk("CcpId",a.CcpId);c=new Kh.a(a,()=>{this.g4k(a)},f=>this.f4k(f,a,b),f=>0===f.StatusCode,void 0,c);ya.a.J(512356625,307,50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.Qi.Jb(c)}g4k(a){this.wP.Lkh(!0,a)}f4k(a,b,c){ya.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",iO.a(c),b.CcpId,a.StatusCode));this.wP.Lkh(!1,b);return!0}KYd(a,
b){const c=$c.a.Kb;c&&(c.Wa("CcpId",a),this.Fc.Ei("CcpId",a,b))}hVj(a,b,c,f,l){a=Object(gb.a)(nG.a,l);if(!a||!a.Cv)return ya.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",a?"not null":"null"),8;ya.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.Cv.nq);b=a.VSh;if(!b||!b.length||0>=Km.e(b,u=>Object(gc.a)(205,u)).length)return ya.a.J(512356621,307,50,"HandleCopySlidesToClipService: no slide is copied"),
8;if(rd.a.any(b,u=>u.hasDeferredContent))return ya.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),8;b=Object.assign(new tG,{CcpId:a.Cv.nq,Location:a.Cv.location,MultiSlideCopy:!0,Slides:Km.c(b,u=>Object.assign(new lO,{Sid:u.sid,Cid:u.cid})),CcpCorrelation:a.$b,PackageAccessKey:cx(new Wt(a.Cv.Cz,a.Cv.version))});this.iXc(b,1,a.$b);return 32}Wme(a,b,c,f,l){if(1===c)return 32;b=Object(gb.a)(dn.a,l);if(!b)return ya.a.J(512356619,
826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.ON;if(!c||Aa.a.Ta(c.ccpid)||Aa.a.Ta(c.data))return ya.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",c?c.ccpid:"null")),this.Fc.Xg(!1,b.$b,28),8;$c.a.wBa("PasteSlideFromDesktop",!0);this.KYd(c.ccpid,b.$b);this.Fc.Uv(12,b.$b);f={};f.CcpCorrId=b.$b;return this.$sg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.HB?b.HB:!0,c.ccpid,null,null,A.AFrameworkApplication.userSessionId,
0,f,c.data,c.isDataCompressed)}Xme(a,b,c,f,l){if(1===c)return 32;b=Object(gb.a)(dn.a,l);if(!b)return ya.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;$c.a.wBa("PasteSlidesFromClipService",!0);c=b.Cv;if(!c)return this.Fc.Xg(!1,b.$b,16),ya.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.Fc.Uv(oG.ClipboardHelper.uAg(c)?2:3,b.$b);this.KYd(c.nq,b.$b);f=this.Dy.Pue(c);return!this.ka.GEg&&f?(this.Fc.Xg(!1,b.$b,17),
ya.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.$sg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.HB?b.HB:!0,c.nq,c.location,c.EE,c.Cz,c.version,c.Lua,null,!1)}$sg(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.Fc.fD(19,a.$b);const Xb=this.sa.presentation;if(!Xb)return this.Fc.Xg(!1,a.$b,3),ya.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.ic.Xc(Xb))return this.Fc.Xg(!1,a.$b,3),ya.a.J(512356615,
307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var tc=this.sa.Aa;if(tc&&!tc.isConnected)return this.Fc.Xg(!1,a.$b,3),ya.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),16;ya.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),u.toString()));this.Dy.bAg(a)||this.rOk.$vi();this.Ht.W9c=Date.now();this.iN.pY(this.Tb.Fn)&&ya.a.J(512356612,307,50,"cross session paste slide happened before last action server result is not returned");
$c.a.CQ(!1,!1);let lc;var Ec=null;tc=this.ka.fBd&&!Aa.a.Ta(Bb)&&1!==this.yb.$i;if(c)Ec=f,lc=null;else{Ec=this.sa.presentation;if(!Ec)throw Error.argumentNull("Presentation is null");lc=Array.isArray(Ec.e2f(l,a.$b,tc))?Ec.e2f(l,a.$b,tc):null;f=Ec=this.aIj();this.Ht.position=null;this.Ht.bXe=Ec?Ec.slideIndex:md.a("DestinationThemeCCPFix")?-1:0}l=null;c||(l=()=>{let hd;(hd=this.oa).sQ.apply(hd,lc)});l=this.Eb.ud(15,void 0,()=>{this.Fa.Df(xc.a.aG)},l);try{if(l.mc(Xb),l.Wc=c?Xb.sfb?M.a.bNb:M.a.Bsc:b,tc?
(Xb.dwa=!0,this.Lw.init(I)):(Xb.EO=I,Xb.sfb=u,Xb.$We=Ec?Ec.Fb:null,Xb.mR=T,Xb.M4=ja,Xb.E0=zz.Ief(eb),Xb.skipUndo=c,Xb.Cz=cx(new Wt(ua,Ra)),Xb.wEb=null==Ub?!1:Ub,Xb.Csc=Bb,Xb.$b=a.$b),!c){T=Ec;for(ja=0;ja<lc.length;ja++)this.ka.Cm?Xb.eeb(lc[ja],T,null,!0):Xb.eeb(lc[ja],T,null),T=lc[ja],tc&&(lc[ja].dwa=!0,this.Lw.Jma.add(lc[ja].id));this.Yb.Aa=lc[lc.length-1];this.De.abb=!0}}finally{l&&l.dispose()}tc?(this.Lw.IEd(!0),this.ic.blockContent(Xb,b)):this.ic.mx(Xb,b);this.Ht.ilb=a;this.Ht.XRb=!0;this.Ht.bMa=
null;this.De.abb=!0;this.Ht.o7b=this.Tb.Fn.YF;tc&&(this.Fc.Ei("DisplayNewPasteProgressUX","true",a.$b),this.q9i(Bb,A.AFrameworkApplication.userSessionId,Ec,c,u,I,eb,Ub,a.$b));this.Fc.Xg(!0,a.$b);return 32}q9i(a,b,c,f,l,u,I,T,ja){const ua=this.Fc.yQ(2,0,"DataUploadInit");this.Fc.Uv(13,ua);this.Fc.fD(19,ua);this.Fc.Ei("DataUploadInitOldCcpCorrId",ja,ua);this.Lw.hhm(ua);const Ra=(new Date).getTime();this.H1g.J5l(a,b,u,()=>{const eb=(new Date).getTime()-Ra;ya.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",
u,eb);this.Fc.Ei("DataUploadTime",eb.toString(),ua);this.p9i(ua,b,c,f,l,u,I,T)},eb=>{ya.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",u,pc.a[eb.error.Code],(new Date).getTime()-Ra);this.kVj();this.Fc.Xg(!1,ua,30)})}p9i(a,b,c,f,l,u,I,T){const ja=this.sa.presentation;if(ja){this.Lw.U0k();$c.a.CQ(!1,!1);ya.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Lw.Jma.toArray().join(",").toString());var ua=this.Eb.ud(15);try{ua.mc(ja),ua.Wc=
M.a.bNb,ja.$We=c?c.Fb:null,ja.u5b=b,ja.Dsc=this.Lw.Jma.toArray().join(",").toString(),ja.EO=u,ja.E0=zz.Ief(I),ja.skipUndo=f,ja.wEb=null==T?!1:T,ja.sfb=l,ja.$b=a}finally{ua&&ua.dispose()}this.Fc.Xg(!0,a)}else ya.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}SXj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return ya.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;ya.a.J(512356578,
307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.H1g.oQi(a);this.Fc.Xg(!1,l,31);return 32}kVj(){this.Lw.dVf(!0);this.uI.rca(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,20,!1,null)}S3l(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}aIj(){const a=this.oa.Xe();return 0<a.length&&(this.S3l(a),a[0])?a[0]:this.sa.Aa}static Ief(a){return JSON.stringify(a)}}Object(m.a)(zz,"ClipServiceActor",null,[948]);class uG{constructor(){this.actionId=
0;this.context=null;this.behavior=0;this.Bd=this.gL=null}}Object(m.a)(uG,"AActionArgs",null,[]);class vG extends uG{constructor(){super()}}Object(m.a)(vG,"ActionArgs$2",uG,[]);class wG extends vG{constructor(){super()}}Object(m.a)(wG,"ActionArgs$1",vG,[]);var qr=d(400),mv=d(394);class Xt{constructor(a,b){this.NAg=!0;this.$b=null;this.dataType=0;this.elj=a;this.Sfa=void 0===b?!1:b}}Object(m.a)(Xt,"CutCopyParams",null,[]);var dx=d(451),mO=d(389);class gC{constructor(a,b,c,f){this.ia=a;this.zMk=f;this.fKa=
c;this.Fa=b}yR(a){return this.fKa.iec(this.Fa)&&!!gC.mjg(a)}paste(a){this.zMk?pG.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(ya.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),this.ia.Ia(M.a.wza,2,a))}static mjg(a){return a&&a.Rn?(a=a.Rn.getElementsByTagName(Df.a.kpb))&&a.length?a[0]:null:null}}Object(m.a)(gC,"TablePasteHandler",null,[1856]);class Ml{static get MB(){return Tb.a.instance.ub("PowerPointWebEditor.ISystemClipboard")}}
Object(m.a)(Ml,"SystemClipboardFactory",null,[]);class nO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg,yg,ng,Wh,Ai){this.Ixa=this.Sfd=null;this.XQg=0;this.Hfd=!1;this.oZj=(Wf,gg,vh,Zj,qj)=>{if(1===vh)return 32;Wf=this.oha.XR;qj&&qj.SourceControlId&&("PasteAsPlainText"==qj.SourceControlId?qj[Xh.a.On]=Wf===G.a.O2||Wf===G.a.n2a||Wf===M.a.pasteAsPlainText:"PasteTextKeepingSourceFormatting"==qj.SourceControlId?qj[Xh.a.On]=Wf===G.a.F9||Wf===G.a.paste||Wf===
G.a.reformatPastedContent||Wf===M.a.aqa:"PasteTextMergeFormatting"==qj.SourceControlId&&(qj[Xh.a.On]=Wf===G.a.bPb||Wf===M.a.xza));return 32};this.iYj=(Wf,gg,vh)=>{if(2==vh){gg=this.oha.XR;if(gg===G.a.O2||gg===G.a.n2a)return 32;gg=Date.now();this.ia.nb(G.a.n2a,vh);A.AFrameworkApplication.Pa.XOb(Wf,"Box4ReformatPasteToPlainDuration",Date.now()-gg)}return 32};this.gYj=(Wf,gg,vh)=>{if(2==vh){Wf=this.oha.XR;if(Wf===G.a.F9||Wf===G.a.paste||Wf===G.a.reformatPastedContent)return 32;this.ia.nb(G.a.reformatPastedContent,
vh)}return 32};this.sZj=(Wf,gg,vh)=>{if(1==vh||this.oha.XR===M.a.pasteAsPlainText)return 32;this.EZd(Wf);this.Pt.undo();return 32};this.uZj=(Wf,gg,vh)=>{if(1==vh||this.oha.XR===M.a.aqa)return 32;this.EZd(Wf);this.Pt.undo();return 32};this.tZj=(Wf,gg,vh)=>{if(1==vh||this.oha.XR===M.a.xza)return 32;this.EZd(Wf);this.Pt.undo();return 32};this.hYj=(Wf,gg,vh)=>{if(1==vh)return 32;if(2==vh){if(this.oha.XR===G.a.bPb)return 32;this.ia.nb(G.a.bPb,vh)}return 32};this.hJh=(Wf,gg)=>{Wf=gg.node;null!=Wf&&Wf==
this.yIb&&(this.yIb=Wf,this.VZg=gg.revisionId.toString())};this.rJh=(Wf,gg)=>{gg&&gg.revisionId&&(this.CIb=gg.revisionId.toString())};this.GZh=(Wf,gg)=>{gg.tE&&gg.tE.Id&&gg.tE.Id==this.CIb&&(this.hZa.L5(this.Yb.Of)||setTimeout(()=>{this.ia.nb(M.a.pasteAsPlainText,2);this.f3e(M.a.mvc);this.CIb=null},0))};this.HZh=(Wf,gg)=>{gg.tE&&gg.tE.Id&&gg.tE.Id==this.CIb&&(this.hZa.L5(this.Yb.Of)||setTimeout(()=>{this.ia.nb(M.a.aqa,2);this.f3e(M.a.ovc);this.CIb=null},0))};this.FZh=(Wf,gg)=>{gg.tE&&gg.tE.Id&&gg.tE.Id==
this.CIb&&(this.hZa.L5(this.Yb.Of)||setTimeout(()=>{this.ia.nb(M.a.xza,2);this.f3e(M.a.nvc);this.CIb=null},0))};this.Vhh=(Wf,gg)=>{gg.tE&&gg.tE.Id&&this.VZg==gg.tE.Id&&(null==this.yIb||this.hZa.L5(this.yIb)||setTimeout(()=>{this.ia.nb(M.a.Y9a,2);if(this.oha.hwa){const vh=new rh.a;vh.Fyc=!0;this.kJb.SOb(vh)}else this.kJb.o1e(new tk(1,A.AFrameworkApplication.isRtl));this.zzl();this.VZg=this.yIb=null},0))};if(!$f)throw Error.argumentNull("DeferredContentManager");if(!xg)throw Error.argumentNull("pasteFloatieEventSource");
if(!yg)throw Error.argumentNull("coldHotManager");if(!ng)throw Error.argumentNull("shapeGraphNodeEventHandlers");if(!Wh)throw Error.argumentNull("graphOperationEventHandler");if(!Ai)throw Error.argumentNull("undoManager");this.ia=a;this.Fa=b;this.oa=c;this.oh=Bb;this.ic=ua;this.aoa=Ra;this.oB=eb;this.Yb=f;this.Uq=l;this.Hx=$f;this.Eb=u;this.fB=I;this.Cr=ja;this.RIa=Ub;this.Tb=Xb;this.Vk=tc;this.yb=lc;this.QPg=Ec;this.kgb=hd;this.Lj=yd;this.fS=Pd;this.RZa=Se;this.zb=vf;this.Faa=ug;this.Fc=Tg;this.ka=
T;this.oha=Ve;this.kJb=xg;this.hZa=yg;this.boc=ng;this.Wf=Wh;this.Pt=Ai}qb(){this.ka.r6c?(this.ia.pa(M.a.Dyb,wc.a.application,Object(R.a)(this,this.hsg,"handleCutCopyToSystemClipboardAsync"),4),this.ia.pa(M.a.z6b,wc.a.application,Object(R.a)(this,this.hsg,"handleCutCopyToSystemClipboardAsync"),0),this.ia.pa(M.a.aqa,wc.a.application,Object(R.a)(this,this.kCb,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(M.a.YLa,wc.a.application,Object(R.a)(this,this.kCb,"handlePasteFromSystemClipboardAsync"),
4),this.ia.pa(M.a.ZLa,wc.a.application,Object(R.a)(this,this.kCb,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(M.a.w1a,wc.a.application,Object(R.a)(this,this.kCb,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(M.a.pasteAsPlainText,wc.a.application,Object(R.a)(this,this.kCb,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(M.a.xza,wc.a.application,Object(R.a)(this,this.kCb,"handlePasteFromSystemClipboardAsync"),4)):(this.ia.pa(M.a.Dyb,wc.a.application,Object(R.a)(this,this.gsg,"handleCutCopyToSystemClipboard"),
4),this.ia.pa(M.a.z6b,wc.a.application,Object(R.a)(this,this.gsg,"handleCutCopyToSystemClipboard"),0),this.ia.pa(M.a.aqa,wc.a.application,Object(R.a)(this,this.jCb,"handlePasteFromSystemClipboard"),4),this.ia.pa(M.a.YLa,wc.a.application,Object(R.a)(this,this.jCb,"handlePasteFromSystemClipboard"),4),this.ia.pa(M.a.ZLa,wc.a.application,Object(R.a)(this,this.jCb,"handlePasteFromSystemClipboard"),4),this.ia.pa(M.a.w1a,wc.a.application,Object(R.a)(this,this.jCb,"handlePasteFromSystemClipboard"),4),this.ia.pa(M.a.pasteAsPlainText,
wc.a.application,Object(R.a)(this,this.jCb,"handlePasteFromSystemClipboard"),4),this.ia.pa(M.a.xza,wc.a.application,Object(R.a)(this,this.jCb,"handlePasteFromSystemClipboard"),4));this.ia.pa(M.a.S_f,wc.a.application,Object(R.a)(this,this.fVj,"handleCopyShapes"),0);this.ia.pa(M.a.lrd,ta.a.application,Object(R.a)(this,this.YXj,"handlePasteShapes"),4);this.ia.pa(M.a.Asc,wc.a.application,Object(R.a)(this,this.XXj,"handlePastePicture"),4);this.ia.pa(M.a.wza,ta.a.application,Object(R.a)(this,this.eYj,"handlePasteTable"),
4);this.ia.pa(M.a.mrd,wc.a.application,Object(R.a)(this,this.dYj,"handlePasteSlides"),4);this.ia.pa(M.a.eXe,wc.a.application,Object(R.a)(this,this.fYj,"handlePasteTextIntoNewShape"),4);this.ia.gU(M.a.qvh,wc.a.application,Object(R.a)(this,this.BUj,"handleBrowserCut"),4);this.ia.gU(M.a.esd,wc.a.application,Object(R.a)(this,this.AUj,"handleBrowserCopy"),0);this.ia.gU(M.a.fsd,wc.a.application,Object(R.a)(this,this.CUj,"handleBrowserPaste"),4);this.ia.gU(M.a.Avh,wc.a.application,Object(R.a)(this,this.VXj,
"handlePasteGivenText"),4);this.ia.pa(M.a.rth,wc.a.application,Object(R.a)(this,this.UXj,"handlePasteContentFromPandora"),4);this.ia.pa(M.a.bqa,ta.a.application,Object(R.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.pa(M.a.jrd,ta.a.application,Object(R.a)(this,this.WXj,"handlePasteHtmlAsync"),4);this.ia.pa(M.a.e7d,Le.a.frame,Object(R.a)(this,this.TXj,"handlePasteChartAsImage"),4);this.ia.xa(M.a.r9d,Le.a.frame,Object(R.a)(this,this.fsg,"handleCutCopyThroughShortcuts"));this.ia.xa(M.a.V_f,
Le.a.frame,Object(R.a)(this,this.fsg,"handleCutCopyThroughShortcuts"));this.ia.pa(M.a.Jth,Le.a.frame,Object(R.a)(this,this.jYj,"handlePasteThroughShortcuts"),4);this.ia.pa(M.a.prd,Le.a.frame,this.gYj,4);this.ia.pa(M.a.rrd,Le.a.frame,this.iYj,4);this.ia.pa(M.a.Wtd,Le.a.frame,this.oZj,4);this.ia.pa(M.a.mvc,wc.a.application,this.sZj,4);this.ia.pa(M.a.ovc,wc.a.application,this.uZj,4);this.ia.pa(M.a.qrd,wc.a.application,this.hYj,4);this.ia.pa(M.a.nvc,wc.a.application,this.tZj,4)}Sd(){if(md.a("ShortcutsFixInMac")&&
E.a.JEb){const a=[this.Fa.Kc(yj.a.XE),this.Fa.Kc(xc.a.Ag)];for(const b of a)b.bindAction(B.KeyInputManager.Va(H.a.Ira,B.KeyInputManager.Ze),M.a.V_f),b.bindAction(B.KeyInputManager.Va(H.a.lPa,B.KeyInputManager.Ze),M.a.Jth)}}fsg(a){a=M.a.r9d===a;const b=this.Fc.yQ(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.aoa.Aua(Object.assign(new Xt(!1,a),{$b:b}));return 32}jYj(){const a=this.Fc.yQ(2,0,"OnBrowserPaste");this.oB.paste(Object.assign(new dn.a(!0),{$b:a}),null,!1);return 32}hsg(a,b,c,f){let l,u;if(!(()=>
{let I=this.h_f(c,a);({yG:l,zUc:u}=I);return I})().returnValue)return l;if(!Ml.MB)return this.Fc.Xg(!1,u.$b,1),8;this.Vea(a,b,c,f,!0,u.$b);return 32}kCb(a,b,c,f){if(1===c)return this.oa.yXa()?2:a===M.a.YLa?2:a===M.a.ZLa?this.lob(!1):a===M.a.w1a?this.lob(!0):a===M.a.pasteAsPlainText?this.lob(!1,!0):32;const l=this.Fc.yQ(2,1,"HandlePasteFromSystemClipboardAsync");if(this.oa.P$())return this.Fc.Xg(!1,l,3),16;if(!Ml.MB)return this.Fc.Xg(!1,l,1),8;this.Vea(a,b,c,f,!1,l);$c.a.CQ(!0,!1);return 32}lob(a,
b){b=void 0===b?!1:b;ya.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.oa.i1()?(ya.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.oB.vRi(a,b)?32:2}F6f(a,b){a===M.a.Dyb?this.aoa.Aua(Object.assign(new Xt(!1,!0),{$b:b})):a===M.a.z6b?this.aoa.Aua(Object.assign(new Xt(!1),{$b:b})):a===M.a.aqa?this.oB.paste(Object.assign(new dn.a(!1),{$b:b}),null,!1):a===M.a.YLa?this.oB.paste(Object.assign(new dn.a(!1),{$b:b,HB:!1}),null,!1):a===M.a.ZLa?
this.oB.paste(Object.assign(new dn.a(!1),{$b:b,HB:!0}),null,!1):a===M.a.w1a?this.oB.paste(Object.assign(new dn.a(!1),{$b:b,pbb:!0}),null,!1):a===M.a.pasteAsPlainText?this.oB.paste(Object.assign(new dn.a(!1),{$b:b,s9b:!0}),null,!1):a===M.a.xza?(a=new dn.a(!1),a.$b=b,a.t9b=!0,this.oB.paste(a,null,!1)):(ya.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.Fc.Xg(!1,b,5))}Vea(a,b,c,f,l,u){Ml.MB.Vea(l);l=Ml.MB.I7;null!=l&&l?this.F6f(a,u):(a=new uf.a(null,Object(R.a)(this,this.djf,"waitingForEnsureAccessOperationResult"),
Object.assign(new wG,{actionId:a,context:b,behavior:c,gL:f,Bd:u})),a.Fm("ClipboardPreProcess"),this.XQg=Date.now(),a.Lh())}djf(a,b){a=!0;let c=!1;const f=b.Bd.toString(),l=Ml.MB.I7,u=Ml.MB.mz;null!=l?(a=!1,l?this.F6f(b.actionId,f):c=!0):Date.now()-this.XQg>this.ka.EWf&&null!=u&&(ya.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),a=!1,c=!0);c&&this.Fc.Xg(!1,f,29);return a}gsg(a,b,c){let f,l;if(!(()=>{let u=this.h_f(c,a);({yG:f,
zUc:l}=u);return u})().returnValue)return f;this.aoa.Aua(l);return 32}h_f(a,b){let c=32;const f=M.a.Dyb===b;b=new Xt(!1,f);const l=!!this.aoa&&this.aoa.yR(b);if(1===a)return c=this.oa.yXa()?2:l?32:16,{returnValue:!1,yG:c,zUc:b};a=this.Fc.yQ(f?1:0,1,"HandleCutCopyToSystemClipboard");this.Fc.Uv(1,a);b.$b=a;return!l||this.ic.EXa()?(this.Fc.Xg(!1,a,2),{returnValue:!1,yG:16,zUc:b}):{returnValue:!0,yG:c,zUc:b}}jCb(a,b,c){if(1===c)return this.oa.yXa()?2:a===M.a.YLa?this.lob(!1):a===M.a.ZLa?this.lob(!1):
a===M.a.w1a?this.lob(!0):a===M.a.pasteAsPlainText?this.lob(!1,!0):32;b=this.Fc.yQ(2,1,"HandlePasteFromSystemClipboard");c=this.Uq.Aa;if(!c||this.ic.Xc(c)||this.oa.P$())return this.Fc.Xg(!1,b,3),16;c=null;let f=!1,l=!1,u=!1;a===M.a.YLa?c=!1:a===M.a.ZLa?c=!0:a===M.a.w1a?f=!0:a===M.a.pasteAsPlainText?l=!0:a===M.a.xza&&(u=!0);this.oB.paste(Object.assign(new dn.a(!1),{$b:b,HB:c,pbb:f,s9b:l,t9b:u}),null,!1);return 32}fVj(a,b,c){if(this.ic.EXa())return 16;if(1===c)return 32;a=this.oa.rf();for(const f of a)if(f.Lf||
f.Rg){Xn(f);break}this.Pim(a);return 32}Pim(a){if(!a||!a.length)this.Ixa=this.Sfd=null;else if(!this.Sfd||!this.GFi(this.Sfd,a)){const b=[];for(const c of a)b.push(c);this.Ixa=new Md.a(0);this.Ixa.$(b[0].slideId,1);this.Sfd=b}}GFi(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}hMj(a,b,c,f){let l;l=b?b.uBb(110,75):this.Tb.Ama(c.clientWidth,c.clientHeight);a=this.Vk.d8d(a.Fb.cid,a.Fb.sid,!0,l._x,l._y,c.width,c.height,a.wt()+1,c.src,c.alt&&c.alt.length?
c.alt:"image",f);b&&(a.J4=b.id);return a}XXj(a,b,c,f,l){b=this.Uq.Aa;if(!b)return ya.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.ic.Xc(b)?16:32;if(!l)return 16;this.Fc.fD(5,l.$b);if(!this.Lj.UD(b,1))return this.Fc.Xg(!1,l.$b,8),this.Lj.yE(b),16;$c.a.wBa("PastePicture",!1);f=yz.jac(l);if(!f||!f.src)return this.Fc.Xg(!1,l.$b,10),8;if((c=b.U0(this.oa.Hd()))&&this.ic.Xc(c))return this.Fc.Xg(!1,l.$b,3),16;const u=this.hMj(b,c,f,l.$b);f=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.Fa.Gd()},
()=>{this.oa.selectShape(u,!0)});try{f.mc(b),f.Wc=a,f.ny[nr.a.Ccc]=!0,c&&b.XS([c]),b.ZB(u)}finally{f&&f.dispose()}this.Fc.Xg(!0,l.$b);return 32}dvj(){if(!this.Uq.Aa)return null;const a=this.Uq.Aa.yj();for(const b of a)if(b.cRc)return b;return null}eYj(a,b,c,f,l){b=this.Uq.Aa;if(!b)return ya.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.ic.Xc(b)?32:16;if(!l)return 8;this.Fc.fD(6,l.$b);if(!this.Lj.UD(b,1))return this.Lj.yE(b),this.Fc.Xg(!1,l.$b,8),16;const u=this.dvj();if(u){if(this.ic.Xc(u))return this.Fc.Xg(!1,
l.$b,3),16;if(u.kK)return ya.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",u.id),this.Fc.Xg(!1,l.$b,3),32}f=gC.mjg(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName(Df.a.pCd).length))return this.Fc.Xg(!1,l.$b,24),8;c=document.createElement("div");if(!c)return this.Fc.Xg(!1,l.$b,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.Fc.Xg(!1,l.$b,24),8;ya.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",
f.rows.length,c.length);var I=this.zkg();f=I.x-55;I=I.y-37.5;if(u){b=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.oa.selectShape(u,!0)});try{b.mc(u),b.Wc=a,b.ny[nr.a.Dcc]=!0,u.$b=l.$b,u.z1a=c}finally{b&&b.dispose()}this.ic.mx(u,a)}else c=b.w5i(f,I,b.wt()+1,c,l.$b),c.$b=l.$b,this.fB.NU([Object(gb.a)(4,c)],Object(gb.a)(205,b),a);this.Fc.Xg(!0,l.$b);return 32}WXj(a,b,c,f,l){if(1===c)return 32;b=l?Object(gb.a)(mO.a,l):null;if(!b)return ya.a.J(512356569,826,50,"Html paste context should not be null."),
8;c=this.Uq.Aa;if(!c)return ya.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.ic.Xc(c))return this.Fc.Xg(!1,b.$b,3),16;$c.a.wBa("PasteHtmlAsync",!0);ya.a.J(512356567,826,50,"Paste html start");return this.K6f(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.oa.yXa()?2:32;const u=l?Object(gb.a)(mO.a,l):null;if(!u)return ya.a.J(512356566,826,50,"Html paste context should not be null"),8;b=this.Uq.Aa;if(!b)return ya.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.ic.Xc(b))return this.Fc.Xg(!1,
u.$b,3),16;ya.a.J(512356564,826,50,"Paste html start");$c.a.CQ(!1,!1);$c.a.wBa("PasteHtml",!0);$c.a.Xk(Ii.a.Lel,"Image:"+u.Gfa.length.toString()+",Table:"+u.t4a.length.toString()+",Text:"+(u.AW?u.AW.length.toString():"0"));f=this.oa.Hd();a=qr.a.kGh(0<u.Gfa.length?!0:!1,!1,0<u.t4a.length?!0:!1,!1,this.ka.tBa,a);if(u.qob)return ya.a.J(512356563,826,50,"Will replace text"),this.Fc.fD(1,u.$b),a=this.xdj(u,f[0],a),16!==a?this.Fc.Xg(!0,u.$b):this.Fc.Xg(!1,u.$b,15),a;ya.a.J(512356562,826,50,"Will paste html into new shapes");
if(u.j8c){if(this.ka.EEg){const I=$c.a.Kb;this.zb.Jb(new ne.a(2,1,0,()=>{$c.a.gz(I,()=>{this.ia.Ia(M.a.jrd,c,u)})},90,"66"));return 64}return this.K6f(u,b,a)}return this.vdj(u,b,f,a)}xdj(a,b,c){if(this.ic.Xc(b))return 16;if(a.AW&&0<a.AW.length){ya.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.RIa.y3d([b])));if(this.wGg(a.AW))return 16;this.ic.mx(b,c);const f=this.Eb.ud(15);try{b.$b=a.$b,f.mc(b),f.Wc=c,b.CPb=a.AW,Object(gc.a)(1497,f)&&b.id&&(Object(gb.a)(1497,f).ny[nr.a.Rth]=b.id.toString())}finally{f&&
f.dispose()}}return 32}vdj(a,b,c,f){const l=[],u=b.wt();var I=this.zkg(),T=I.x,ja=I.y;I=0;for(var ua=0;ua<a.t4a.length;++ua)I=this.Vk.e8d(!0,b.cid,b.sid,!1,T,ja,110,75,u+1,a.t4a[ua],a.$b),l.push(I),I=6;T=a.Gfa;ja=1===T.length?0:qr.a.tU;for(ua=0;ua<T.length;ua++){const Ra=this.Vk.d8d(b.cid,b.sid,!1,ja,ja,T[ua].width,T[ua].height,u+1,T[ua].src,T[ua].alt,a.$b);l.push(Ra);ja+=qr.a.tU;I=0===I?5:20}if(a.AW&&0<a.AW.length)if(ya.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.RIa.y3d(c))),
!this.wGg(a.AW))c=this.Vk.f8d(b.cid,b.sid,u+1,a.AW,a.$b),l.push(c),I=0===I?1:20;else if(!l.length)return this.Fc.fD(1,a.$b),this.Fc.Xg(!1,a.$b,7),16;this.Fc.fD(I,a.$b);if(0<l.length){if(!this.Lj.UD(b,l.length))return this.Lj.yE(b),this.Fc.Xg(!1,a.$b,8),16;1===l.length&&a&&this.ka.insertVideoWithPasteEnabled?(c=a.AW,this.Faa.aHg(c)?(this.Fc.fD(8,a.$b),ya.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.fB.NU(l,b,f),this.Faa.Udm(c,Object(R.a)(this,
this.Anm,"videoInsertionFail"))):(1===I&&(this.oKf(),this.yIb=l[0],this.oha.XR=a.yfc?M.a.pasteAsPlainText:a.zfc?M.a.xza:M.a.aqa),this.fB.NU(l,b,f),this.ic.mx(b,f))):(1===I&&1===l.length&&a&&(this.oKf(),this.yIb=l[0],this.oha.XR=a.yfc?M.a.pasteAsPlainText:a.zfc?M.a.xza:M.a.aqa),this.fB.NU(l,b,f),this.ic.mx(b,f));this.Fc.Xg(!0,a.$b)}else this.Fc.Xg(!1,a.$b,9);return 32}oKf(){this.pJe||(this.boc.Nka(this.hJh),this.Wf.ASa(this.Vhh),this.pJe=!0)}EZd(a){this.Hfd||(this.Wf.uMf(this.rJh),a===M.a.mvc?this.Wf.ASa(this.GZh):
a===M.a.ovc?this.Wf.ASa(this.HZh):a===M.a.nvc&&this.Wf.ASa(this.FZh),this.Hfd=!0)}f3e(a){this.Hfd&&(this.Wf.EEh(this.rJh),a===M.a.mvc?this.Wf.xPb(this.GZh):a===M.a.ovc?this.Wf.xPb(this.HZh):a===M.a.nvc&&this.Wf.xPb(this.FZh),this.Hfd=!1)}zzl(){this.pJe&&(this.boc.wPb(this.hJh),this.Wf.xPb(this.Vhh),this.pJe=!1)}Anm(){ya.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}K6f(a,b,c){this.Fc.fD(5,a.$b);if(rd.a.Ta(a.Gfa))return this.Fc.Xg(!1,a.$b,10),
16;if(!b)return 16;var f=Object(gb.a)(227,b.sc(this.yb.Na));if(!f)return this.Fc.Xg(!1,a.$b,3),8;var l=$c.a.Kb;l&&(l.actionName="SinglePicturePaste",l.gq=!0,l.tk=!0,l.Wa("PreloadImageDuration",a.dXe.toString()));l=a.Gfa[0];const u=b.U0(this.oa.Hd());var I=b.wt();const {ede:T,gD:ja}=this.RZa.k6d(u,l.width,l.height);I=this.Vk.d8d(b.cid,b.sid,!1,ja.x,ja.y,T.width,T.height,I+1,l.src,l.alt,a.$b);$c.a.Xk("ImageSrcSize",l.src.length.toString());f=this.RZa.j2d(this.yb.Xd,T,ja,f.cV);I.ZS=f;u&&(I.J4=u.id);
I.isResizable=!0;I.ifc=!0;I.SM=!0;I.Cha=!0;I.lga=l.src;this.fB.NU([I],b,c,null,u);this.Fc.Xg(!0,a.$b);return 32}wGg(a){return 65535<a.length?(ya.a.J(512356556,826,50,"Exceed text size limit: {0}",a.length),!0):!1}YXj(a,b,c,f,l){b=this.Uq.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(gb.a)(dn.a,l);if(!c)return 8;f=c.kY;if(rd.a.Ta(f))return this.Fc.Xg(!1,c.$b,11),8;this.Fc.fD(2,c.$b);this.Fc.Uv(2,c.$b);l=this.Uq.Aa;if(!l||this.ic.Xc(l))return this.Fc.Xg(!1,
c.$b,3),16;$c.a.wBa("PasteShape",!1);if(!this.Lj.UD(l,f.length))return this.Lj.yE(l),this.Fc.Xg(!1,c.$b,8),16;ya.a.J(512356555,826,50,"Start Handle paste shapes");const u=Xp.a(f,Ra=>Ra.shapeNode);this.Hx.vne(u,"HandlePasteShapes");for(var I of f){if(!I||!I.shapeNode.isConnected)return ya.a.J(512356554,826,50,"Paste deleted shapes"),this.QPg.Zyc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.Fc.Xg(!1,c.$b,12),16;if(this.ic.iP(I.shapeNode))return this.Fc.Xg(!1,
c.$b,3),16;if(!I.shapeNode.get_shapeId())return this.Fc.Xg(!1,c.$b,12),16}const T=[];for(I=0;I<f.length;I++)T.push(f[I].shapeNode);for(var ja of T)if(ja.Lf||ja.Rg){Xn(ja);break}ja=Object(gb.a)(205,b.LD(f[0].shapeNode.slideId));this.RIa.Eth(ja,l,T,this.Ixa,a,c.$b);let ua;ya.a.J(512356553,826,50,(()=>{let Ra=this.RIa.z3d(T);({contentType:ua}=Ra);return Ra})().returnValue);this.Fc.fD(ua,c.$b);$c.a.CQ(!0,!0);this.Fc.Xg(!0,c.$b);return 32}TXj(a,b,c,f,l){(a=Object(gb.a)(dn.a,l))&&this.oB.Eel(a.$b);return 32}dYj(a,
b,c,f,l){if(1===c)return 32;b=Object(gb.a)(dn.a,l);if(!b)return 8;this.Fc.fD(19,b.$b);this.Fc.Uv(2,b.$b);if(rd.a.Ta(b.kY))return this.Fc.Xg(!1,b.$b,11),8;$c.a.wBa("PasteSlide",!0);if(c=Array.isArray(b.kY)?b.kY:null){let I=0;c.forEach(T=>{T.gd&&T.gd.hasDeferredContent&&I++});0<I&&ya.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,I)}c=[];for(var u of b.kY){f=Object(gb.a)(dx.a,u);if(!f)return this.Fc.Xg(!1,b.$b,11),8;f=f.gd;if(!f||!f.isConnected)return ya.a.J(512356551,
826,50,"Paste deleted slide"),this.QPg.Zyc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.erh&&(this.Cr.Vr=null),this.Fc.Xg(!1,b.$b,13),16;if(this.ic.Xc(f))return this.Fc.Xg(!1,b.$b,3),16;Array.add(c,f)}u=Array.clone(this.oa.Xe());u.sort((I,T)=>I.ve-T.ve);u=u[u.length-1];if(!u)return ya.a.J(512356550,826,50,"Paste slides with no slide selected"),this.Fc.Xg(!1,b.$b,13),8;$c.a.Xk("SlideCount",c.length.toString());u=this.fB.A$f(c,
a,u,b.$b,!1);c=!0;for(const I of u)if(!I.nP){c=!1;break}c||this.ic.mx(this.Yb.Of,a);$c.a.CQ(!0,!0);this.Fc.Xg(!0,b.$b);return 32}c$e(){return this.oa.Js()||this.oa.nI()}eYl(){if(this.oa.Js())return!0;if(this.oa.nI()){const a=this.oa.Hd();return 1!==a.length||!a[0].isEditable}return!1}BUj(a,b,c,f,l,u){const I=this.Fc.yQ(1,0,"HandleBrowserCut");this.Fc.fD(1,I);this.c$e()?(a=this.kgb(a,this.ia,b,c,f,l,u,this.Fc,I),a.V$a(16)):($c.a.CQ(!0,!0),this.Fc.vpc(I),a=this.kgb(a,this.ia,G.a.l4b,c,f,l,u,this.Fc,
I),a.I4c());return a}AUj(a,b,c,f,l,u){const I=this.Fc.yQ(0,0,"HandleBrowserCopy");this.Fc.fD(1,I);this.c$e()?(a=this.kgb(a,this.ia,b,c,f,l,u,this.Fc,I),2===f&&this.aoa.Aua(Object.assign(new Xt(!0),{NAg:!1,$b:I})),a.V$a(32)):(this.Fc.vpc(I),a=this.kgb(a,this.ia,G.a.gQc,c,f,l,u,this.Fc,I),a.I4c());return a}CUj(a,b,c,f,l,u){const I=this.Fc.yQ(2,0,"HandleBrowserPaste"),T=this.c$e();a=this.kgb(a,this.ia,T?b:G.a.F9,c,f,l,u,this.Fc,I);u=Object(gb.a)(10,u);$c.a.CQ(!0,!1);if(this.oa.P$())return a.V$a(16),
this.Fc.Xg(!1,I,3),a;u&&u.Qa(Oe.a.bW)?2===f&&this.gEd(u,I)?a.V$a(32):T?(2===f&&this.oB.paste(Object.assign(new dn.a(!0),{oEg:!1}),u.$a(Oe.a.bW),!1),a.V$a(32)):a.I4c():(ya.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),a.V$a(16),this.Fc.Xg(!1,I,14));return a}VXj(a,b,c,f,l,u){$c.a.wBa("PasteGivenText",!1);this.eYl()?(a=this.kgb(a,this.ia,b,c,f,l,u,this.Fc,""),a.V$a(16)):($c.a.CQ(!0,!0),a=this.kgb(a,this.ia,G.a.ird,c,f,l,u,this.Fc,""),a.I4c());return a}fYj(a,
b,c,f,l){if(1===c)return 32;if((b=this.oa.Hd())&&0<b.length)return ya.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",this.RIa.y3d(b)),16;ya.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");if(!(l&&l.Rn&&l.Rn.innerHTML&&l.Rn.innerHTML.length))return ya.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;$c.a.wBa("PasteTextIntoNewShape",!0);b=this.Uq.Aa;
if(!b)return ya.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;l=this.Vk.f8d(b.cid,b.sid,b.wt()+1,l.Rn.innerHTML,l.$b);this.fB.NU([l],b,a);return 32}zkg(){const a=this.Tb.Bw();return new pd.a(Math.floor(a.width/2),Math.floor(a.height/2))}UXj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(mv.a.AVf).toString());this.Fc.gFb(a)||(a=this.Fc.yQ(2,1,"HandlePasteContentFromPandora"));b=this.ia.nb(M.a.tla,2);if(32!==b)return this.Fc.Xg(!1,
a,15),ya.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new dn.a(!0),{$b:a});this.fS.pjk(l)?a.Rn=l:(Df.a.z5b(this.oh),this.oh.contentWindow.document.body.appendChild(l));this.oB.paste(a,null,!1);ya.a.J(512356515,826,50,null);return 32}gEd(a,b){if(a){if(this.ka.que){const c=a.ra(Oe.a.u4c,"");if(c.startsWith("data:image/"))return this.Fc.fD(5,b),this.oB.cXe(c,b)}a=a.$a(Oe.a.bW);Aa.a.Ta(a)||(a=this.fS.WLa(a),this.Fc.kUl(a,b))}return!1}}Object(m.a)(nO,"ClipboardActor",null,[948]);var xq=
d(1181);class oO{constructor(a,b){this.ia=a;this.yr=b;this.qb()}qb(){this.ia.pa(M.a.hyh,Le.a.frame,Object(R.a)(this,this.JBc,"updateCoauthStatus"),96)}Sd(){}JBc(a,b,c,f,l){if(1===c)return 32;a=this.yr.Wsc;Aa.a.Ta(a)&&(a="NotConnected");this.yr.Aab&&(a=String.format("{0} ~:{1}",a,this.yr.Aab));l[xq.a.Value]=a;l[bn.a.labelText]=a;l[xq.a.Visible]=!0;return 32}}Object(m.a)(oO,"CoauthActor",null,[948]);var Yt=d(233),ql=d(354);class pO{constructor(a,b,c,f){this.yJa=!1;a("powerpoint-editor-intl").then(()=>
{ya.a.J(509117583,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{ya.a.J(509117582,801,50,"Color Picker Manager script is loaded successfully");this.yJa=!0}).catch(l=>{ya.a.J(509117581,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>{ya.a.J(509117580,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Fa=c;this.Yb=f}qb(){this.ia.xa(M.a.renderColorPicker,wc.a.application,Object(R.a)(this,this.renderColorPicker,
"renderColorPicker"));this.ia.xa(M.a.Gme,wc.a.application,this.VVj.bind(this));this.ia.xa(M.a.WDa,wc.a.application,Object(R.a)(this,this.WDa,"addRecentColor"))}Sd(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.yJa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.dDl(b,c,a);return 32}WDa(a,b,c,f,l){if(a=Yt.a.parse(l.Color)){b=this.Yb.Of;if(!b)return ya.a.J(509117579,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.He(yb.a.Z8i,a.RGBColor);b.He(yb.a.wea,JSON.stringify(ql.g(b.wea,
a.RGBColor)))}else return ya.a.J(509117578,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}VVj(a,b,c,f,l){let u;a=window.EyeDropper;if(!a||!l)return 8;switch(l.originalActionId){case M.a.lRc:u=M.a.eOa;break;case M.a.oRc:u=M.a.gtc;break;case M.a.tXc:u=M.a.H3b;break;case M.a.vXc:u=M.a.vNb;break;case M.a.uXc:u=M.a.SLh;break;case M.a.xXc:u=M.a.I3b;break;case M.a.wXc:u=M.a.jsd;break;default:return ya.a.J(508847688,822,15,"handleEyeDropperColor: unrecognized original action id: {0}",
l.Wpa),8}if(1===c)return this.ia.Ia(u,1,l);ya.a.J(508355811,822,50,"handleEyeDropperColor: Eyedropper button clicked with original action id: {0}",l.Wpa);c=new a;l=new AbortController;const I=this;c.open({signal:l.signal}).then(T=>{const ja={};ja.Color=T.sRGBHex;ja.sourceControlId="EyeDropper";jh.a("EyeDropper_ColorApplied",u,function(){return I.ia.Ia(u,2,ja)})}).catch(T=>{ya.a.J(508847687,822,10,"handleEyeDropperColor: Failed to apply eyedropper color. Exception: {0}",T.toString())});return 32}dDl(a,
b,c){let f="#000000",l=100;a&&(f=Vb.a.WH(a.DE),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),this.Fa.O4c(xc.a.S5b,xc.a.Nj,a));const u=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(u)if(u.addEventListener("onColorChange",ja=>{const ua={};ua.Color=ja;ua.sourceControlId="CustomColors";let Ra=8;jh.a("ColorPicker_ColorApplied",b,()=>Ra=this.ia.Ia(b,2,ua));
32===Ra?ya.a.J(509117576,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):ya.a.J(509117575,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",b);this.Fa.qk(xc.a.S5b,!1)}),u.addEventListener("onCancel",()=>{this.Fa.qk(xc.a.S5b,!1)}),jh.a("ColorPicker_DialogInvocation",b,()=>{u.render("colorPickerDiv",f,l,c);return 32}),ya.a.J(509117574,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",
b),this.Fa.qk(xc.a.S5b,!0),a=this.Fa.Kc(xc.a.S5b)){a.uK=!0;var I=B.KeyInputManager.Va(H.a.zs,0),T=B.KeyInputManager.Va(H.a.zs,4);a.Sy(I);a.Sy(T);a.bindAction(I,N.a.zua);a.bindAction(T,N.a.zua)}else ya.a.J(509117573,822,10,"RenderColorPickerDialog: colorPickerScope is null");else ya.a.J(509117577,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(m.a)(pO,"ColorPickerActor",null,[948]);var aT=d(1081);class qO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("designModeManager");if(!c)throw Error.argumentNull("dialogManager");if(!f)throw Error.argumentNull("contextMenuUser");if(!l)throw Error.argumentNull("pptWorkspace");if(!u)throw Error.argumentNull("graphTopologyManager");if(!I)throw Error.argumentNull("shapeReader");if(!T)throw Error.argumentNull("selectionManager");if(!ja)throw Error.argumentNull("focusManager");if(!ua)throw Error.argumentNull("offlineModalCallout");if(!Ra)throw Error.argumentNull("pageView");if(!eb)throw Error.argumentNull("applicationSettings");
this.ia=a;this.fjc=b;this.kS=c;this.x0a=l.EAc;this.b6=f;this.sa=u;this.Ga=I;this.oa=T;this.Fa=ja;this.j2=ua;this.yb=Ra;this.$Kk=eb.pptContextMenuOnSelectionFixIsEnabled;this.Zf=eb.Cm;this.DK=eb.enableCameoInEditor}qb(){this.ia.xa(M.a.RSc,wc.a.application,Object(R.a)(this,this.Z_j,"handleThumbnailPanelContextMenu"));this.ia.xa(M.a.N6d,wc.a.application,Object(R.a)(this,this.B_j,"handleSorterViewThumbnailContextMenu"));this.ia.xa(M.a.d_f,wc.a.application,Object(R.a)(this,this.A_j,"handleSorterViewBlankSpaceMenu"));
this.ia.xa(M.a.K6d,wc.a.application,Object(R.a)(this,this.TZj,"handleSectionContextMenu"));this.ia.xa(M.a.M6d,ta.a.view,Object(R.a)(this,this.r_j,"handleSlidePanelContextMenu"));this.ia.xa(M.a.L6d,ta.a.view,Object(R.a)(this,this.BXj,"handleMultiSelectShapeContextMenu"));this.ia.xa(M.a.f_f,wc.a.application,Object(R.a)(this,this.r0j,"handleVersionHistoryThumbnailContextMenu"));this.ia.pe(M.a.RSc,2048)}Sd(){this.$Kk&&E.a.Fk&&(this.Fa.Kc(P.AppFrame.QX).bindAction(B.KeyInputManager.Va(H.a.YOa,0),G.a.sca),
this.Fa.Kc(P.AppFrame.B1e).bindAction(B.KeyInputManager.Va(H.a.YOa,0),G.a.sca))}Kpb(a,b,c){var f;md.a("EnableContextMenuTracker")&&(c=ff.ActionManager.E4a(null===(f=c.hc)||void 0===f?void 0:f.rawEvent,ff.ActionManager.MDa?ff.ActionManager.MDa(a):"",void 0))&&ff.ActionManager.fZd(c,"ContextIds",ta.a.Fv(b.contextId))}Z_j(a,b,c,f,l){if(1===c)return 32;if(this.ia.wY)return this.j2.show(1,-1),32;this.fjc.Fbb();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Cf.a.iEa))return 16;if(this.kS.h1||!l.Ec)return 32;
this.Kpb(a,b,l);2===l.wg||3===l.wg?(a=l.clientPoint.y-Hf.a.iHj(this.x0a.N2)+this.x0a.N2.scrollTop,a=this.x0a.Uce(a),b=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):(a=0>this.x0a.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.x0a.N2),b=new Sys.UI.Point(b.x+jf.a.Zta,b.y+jf.a.Zta));this.b6.value.P7(jf.a.Cua,b,l.wg,a);return 32}r0j(a,b,c,f,l){if(1===c)return 32;if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Cf.a.iEa))return 16;if(!l.Ec)return 32;this.Kpb(a,b,l);a=new Sys.UI.Point(l.clientPoint.x,
l.clientPoint.y);this.b6.value.P7(jf.a.Cua,a,l.wg,21);return 32}A_j(a,b,c,f,l){if(1===c)return 32;this.Kpb(a,b,l);a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);b=20;this.Zf&&0===this.yb.$i&&(b=2);this.b6.value.P7(jf.a.Cua,a,l.wg,b);return 32}B_j(a,b,c,f,l){if(1===c)return 32;if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Cf.a.iEa))return 16;if(this.kS.h1||!l.Ec)return 32;if(2===l.wg||3===l.wg||1===l.wg)this.Kpb(a,b,l),a=19,this.Zf&&0===this.yb.$i&&(a=1),b=md.a("ContextMenuPositionBugFixed")&&
1===l.wg?this.Hfg():new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.b6.value.P7(jf.a.Cua,b,l.wg,a);return 32}TZj(a,b,c,f,l){if(1===c)return 32;A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewSectionMenuEnabled")&&(c=l.contextMenuArgs,this.Kpb(a,b,l),a=md.a("ContextMenuPositionBugFixed")&&1===c.wg?this.Hfg():new Sys.UI.Point(c.clientPoint.x,c.clientPoint.y),l.isEmptySection?this.b6.value.P7(jf.a.Cua,a,c.wg,17):this.b6.value.P7(jf.a.Cua,a,c.wg,18));return 32}r_j(a,b,c,f,l){if(1===
c)return 32;this.fjc.Fbb();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Cf.a.iEa))return 16;if(this.kS.h1||!l.Ec)return 32;this.Kpb(a,b,l);if(2===l.wg||3===l.wg)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=ek.b(b);a=ek.e(this.sa.Aa,a.Na);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.Oy);a=new Sys.UI.Point(a.x+jf.a.Zta,a.y+jf.a.Zta)}this.b6.value.P7(jf.a.Cua,a,l.wg,4);return 32}BXj(a,b,c,f,l){if(1===c||l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,jf.a.rDi))return 32;this.fjc.Fbb();
if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Cf.a.iEa))return 16;if(this.kS.h1||!l.Ec)return 32;f=ek.b(b);let u;if(!(f&&f.Rb&&(u=this.oa.rf())&&u.length))return 16;c=this.CGj(u);this.Kpb(a,b,l);if(2===l.wg||3===l.wg)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=ek.c(u[0],f.Na);if(!a||!a.va)return 16;a=Sd.a.wi(a.va.va);b=Sd.a.wi(f.container);f=a.x+jf.a.Zta<b.x?b.x:a.x+jf.a.Zta;a=a.y+jf.a.Zta<b.y?b.y:a.y+jf.a.Zta;f=f>b.x+b.width?b.x+b.width:f;a=a>b.y+b.height?b.y+b.height:a;a=new Sys.UI.Point(f,
a)}1===l.wg||4===c?this.b6.value.P7(jf.a.Cua,a,l.wg,c):this.b6.value.I_l(jf.a.Cua,a,l.wg,c);return 32}Hfg(){const a=document.activeElement.getBoundingClientRect();return new Sys.UI.Point(a.x,a.y)}CGj(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ga.Hs(b));const c=md.a("FixContextMenus");return 1<a.length?this.Ga.WOc(a)?11:10:b.dA||!b.twa||!c&&b.Lf?5:!b.get_isSVGBlipFilled()||this.DK&&b.lF?this.DK&&b.lF?23:b.$j||1===b.mediaType?7:b.ig?8:b.Xu?6:b.$r?22:b.Lq?c?24:9:c&&b.lwa?25:c&&b.Lf?26:b.vd?14:b.Vp?
15:b.F5?16:0:13}}Object(m.a)(qO,"ContextMenuActor",null,[948]);class rO{constructor(a,b,c,f,l,u,I,T,ja){this.kfa=()=>this.lJa?this.lJa:this.lJa=Tb.a.instance.ub("PowerPointWebEditor.IImageDescriptionPane");this.cxk=()=>this.DK?this.WCi(this.oa.rf())?32:8:2;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("selectionManager");if(!c)throw Error.argumentNull("shapeReader");if(!f)throw Error.argumentNull("accCheckPane");this.ia=a;this.oa=b;this.Ga=c;this.Qfb=f;this.CLk=l;
this.KIe=u;this.DV=I;this.DK=T;this.BLk=ja}qb(){this.ia.pa(M.a.yuh,wc.a.application,Object(R.a)(this,this.Vfl,"pictureToolsTabViewHandler"),this.BLk?2052:4);this.ia.pa(M.a.w7f,wc.a.application,Object(R.a)(this,this.zej,"drawingToolsTabViewHandler"),4);this.ia.pa(M.a.lQf,wc.a.application,Object(R.a)(this,this.UGi,"audioPlaybackToolsTabViewHandler"),4);this.ia.pa(M.a.jQf,wc.a.application,Object(R.a)(this,this.SGi,"audioFormatToolsTabViewHandler"),4);this.ia.pa(M.a.mQf,wc.a.application,Object(R.a)(this,
this.VGi,"audioSettingsTabViewHandler"),4);this.ia.pa(M.a.myh,wc.a.application,Object(R.a)(this,this.tTj,"graphicsTabViewHandler"),100);this.ia.pa(M.a.g0e,wc.a.application,Object(R.a)(this,this.T8l,"tableTabViewHandler"),100);this.ia.pa(M.a.Cyh,wc.a.application,Object(R.a)(this,this.RGi,"audioContextualGroupHandler"),100);this.ia.pa(M.a.gNc,wc.a.application,Object(R.a)(this,this.csi,"accessibleAuthoringViewHandler"),4);this.DK&&this.ia.pa(M.a.bJg,wc.a.application,this.cxk,4)}Sd(){}Vfl(){return this.DK&&
this.Qeb(this.oa.rf())?8:this.xjk()?32:this.sEg(this.oa.rf())?32:8}zej(){const a=this.oa.rf();return a&&a.length?this.DK&&this.Qeb(a)?8:1===a.length?this.lCg(a)?32:16:this.XCi(a)||this.yek(a)&&this.lCg(a)?32:this.Lvb(a)||this.Alk(a)?16:32:16}UGi(){return this.KIe?this.DK&&this.Qeb(this.oa.rf())?8:this.o7c()?32:this.Lvb(this.oa.rf())?32:8:2}SGi(){return this.DV?this.DK&&this.Qeb(this.oa.rf())?8:this.o7c()?32:this.Lvb(this.oa.rf())?32:8:2}VGi(){return this.DV&&this.KIe?this.DK&&this.Qeb(this.oa.rf())?
8:this.o7c()?32:this.Lvb(this.oa.rf())?32:8:2}tTj(){return this.CLk?this.DK&&this.Qeb(this.oa.rf())?8:this.yjk()?32:this.Ga.Lzc(this.oa.rf())?32:16:2}T8l(){const a=this.oa.Hd();return a&&1===a.length&&a[0].vd?32:8}RGi(){return this.DV||this.KIe?this.DK&&this.Qeb(this.oa.rf())?8:this.o7c()?32:this.Lvb(this.oa.rf())?32:8:2}csi(){const a=this.kfa()&&this.kfa().isVisible;return this.Qfb&&this.Qfb.isVisible||a?32:2}Alk(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Vp||1===c.mediaType)return!0;c.$j||
(b=!1)}return b}XCi(a){if(!a)return!1;for(const b of a)if(!b.Vp)return!1;return!0}sEg(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.$j&&!c.get_isSVGBlipFilled())b=!0;else if(c.Vp)return!1;return b}Lvb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}WCi(a){return null!==a&&void 0!==a&&a.length?!a.filter(b=>!!b).some(b=>!b.lF):!1}yek(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}lCg(a){if(!a)return!1;for(const b of a)if(b&&
(b.iwa||b.F5))return!0;return!1}xjk(){return this.Ove(this.oa.rf())&&this.sEg(this.oa.pQ(this.oa.Hd()))}yjk(){return this.Ove(this.oa.rf())&&this.tpk(this.oa.pQ(this.oa.Hd()))}o7c(){return this.Ove(this.oa.rf())&&this.Lvb(this.oa.pQ(this.oa.Hd()))}Qeb(a){return null===a||void 0===a?void 0:a.some(b=>null===b||void 0===b?void 0:b.lF)}tpk(a){if(!a)return!1;for(const b of a)if(b&&b.Rg&&b.get_isSVGBlipFilled())return!0;return!1}Ove(a){if(!a)return!1;for(const b of a)if(b&&b.Lf)return!0;return!1}}Object(m.a)(rO,
"ContextualTabsActor",null,[948]);class sO{constructor(a,b,c,f){this.INe=null;this.ia=a;this.sa=b;this.Eb=c;this.pRg=f;this.pRg.Ak(Object(R.a)(this,this.jph,"onRichApiResponseReceived"))}qb(){this.ia.pa(M.a.hXc,ta.a.application,Object(R.a)(this,this.TVj,"handleExecuteAddinBatchOperation"),4)}Sd(){}dispose(){this.pRg.tn(Object(R.a)(this,this.jph,"onRichApiResponseReceived"))}jph(a,b){this.INe&&(a=Object(gb.a)(793,b.node))&&a.Tmb&&this.INe(a.Tmb)}TVj(a,b,c,f,l){b=this.sa.presentation;if(1===c)return b?
32:8;if(!b)return ya.a.J(509364444,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return ya.a.J(509364443,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.INe=l.promiseToResolve;c=this.Eb.ud(15,void 0,void 0,void 0,!0);try{c.mc(b),c.Wc=a,b.mZd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(m.a)(sO,"ExtensibilityActor",null,[948]);var Az;(function(a){a[a.height=0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=
3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(Az||(Az={}));Object(m.b)("FormatPaneProperty",Az);class hC{constructor(a,b){this.hT=a;this.Cba=b}}Object(m.a)(hC,"MarginShapeData",null,[]);class xG{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=
this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0;this.lockAspectRatioEnabled=!1}}Object(m.a)(xG,"FormatShapeTaskPaneProps",null,[]);class tO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.YKa=this.U_a=this.hZ=this.gya=null;this.f_g=0;this.Mb=!1;this.wKa=null;this.nJa=this.poa=!1;this.i_j=(yd,Pd,pe,Se,vf)=>{if(!vf)return 8;if(1===pe)return 32;Pd=vf.selectedShapes;vf=vf["lockAspectRatioEnabled "];pe=this.Eb.ud(15);
try{pe.mc(Pd),pe.Wc=yd,0<(null===Pd||void 0===Pd?void 0:Pd.length)&&(Pd[0].Cha=vf)}finally{null===pe||void 0===pe?void 0:pe.dispose()}return 32};if(!b)throw Error.argumentNull("pptSelectionManager");if(!c)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("actionManager");if(!Ec)throw Error.argumentNull("transactionFactory");if(!l)throw Error.argumentNull("focusManager");if(!I)throw Error.argumentNull("graphOperationEventHandler");if(!T)throw Error.argumentNull("viewElementEventHandlers");
if(!ja)throw Error.argumentNull("viewEventSource");if(!ua)throw Error.argumentNull("pageView");if(!Ra)throw Error.argumentNull("unitConversion");if(!eb)throw Error.argumentNull("workspace");this.tLk=!0;this.gb=b;this.Db=c;this.ia=f;this.Eb=Ec;this.Fa=l;this.Wf=I;this.xd=T;this.Hc=ja;this.yb=ua;this.wIa=Ra;this.Yb=eb;this.Wf.HJ(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));this.Wf.$Da(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));this.Hc.zSa(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));
this.xd.eEa(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));this.Db.QH(Object(R.a)(this,this.St,"onAppFrameModeSwitched"));this.sVg=Ub;this.Ulc=hd.getBooleanAppSetting("PPTOLockAspectRatioEnabled");this.Ecd=Xb;this.Ga=Bb;this.e2=tc;this.fo=lc;md.a("FixHeightAndWidthButtonValues")&&this.fo&&this.fo.OZd(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"))}dispose(){this.Wf.E7(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));this.Wf.w2a(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));
this.Hc.Emb(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));this.xd.Gmb(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"));this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"));md.a("FixHeightAndWidthButtonValues")&&this.fo.nvd(Object(R.a)(this,this.Yya,"onChangeRenderFormatShapePane"))}qb(){this.ia.pa(M.a.Oyc,wc.a.application,Object(R.a)(this,this.Oyc,"showHideFormatShapePane"),4);this.ia.pa(M.a.iyd,wc.a.application,Object(R.a)(this,this.iyd,"setAbsoluteHeight"),4);
this.ia.pa(M.a.sbf,wc.a.application,Object(R.a)(this,this.sbf,"spinAbsoluteHeight"),4);this.ia.pa(M.a.Plb,wc.a.application,Object(R.a)(this,this.Plb,"queryAbsoluteHeight"),100);this.ia.pa(M.a.jyd,wc.a.application,Object(R.a)(this,this.jyd,"setAbsoluteWidth"),4);this.ia.pa(M.a.tbf,wc.a.application,Object(R.a)(this,this.tbf,"spinAbsoluteWidth"),4);this.ia.pa(M.a.Qlb,wc.a.application,Object(R.a)(this,this.Qlb,"queryAbsoluteWidth"),100);this.ia.pa(M.a.gOb,wc.a.application,Object(R.a)(this,this.gOb,"queryFormatShapePane"),
96);this.Ulc&&this.ia.pa(M.a.wNh,wc.a.application,this.i_j,4)}Sd(){}Yya(){this.Mb&&this.Jl(!0)}St(a){1===a.mode&&this.Mb&&(this.Mb=!1,this.ur(),this.Fa.qk(xc.a.VX,this.Mb))}bjk(a){return this.Yb.isEditingAllowed&&this.tLk&&!this.f$e(a)}gOb(a,b,c,f,l){(a=Object(gb.a)(Di.a,l))&&a.Rf(this.Mb);return 32}Oyc(a,b,c){b=this.gb.rf();return 1===c?b.length&&this.bjk(b)?32:8:jh.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Mb.toString(),a,()=>{(this.Mb=!this.Mb)?this.Jl():this.ur();return 32})}iyd(a,
b,c,f,l){b=this.gb.rf();return 1===c?this.GPh(b)?8:32:jh.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return ya.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const u=l.Number;void 0===u||null===u||isNaN(u)||this.dza(u,0);return 32})}sbf(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.dza(0,0),this.K9a());return 32}Plb(a,b,c,f,l){if(!l)return ya.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),8;if(a=l.queryResult)b=
this.SA(),a.uca=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.uca="");return 32}jyd(a,b,c,f,l){b=this.gb.rf();return 1===c?this.GPh(b)?8:32:jh.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return ya.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const u=l.Number;void 0===u||null===u||isNaN(u)||this.dza(u,1);return 32})}tbf(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.dza(0,1),this.K9a());return 32}Qlb(a,b,c,f,l){if(!l)return ya.a.J(512500577,
822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.SA(),a.uca=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.uca="");return 32}Jl(a){a=void 0===a?!1:a;const b=this.SA(),c=Object.assign(new jv.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Mb=!1},isModernPane:!0});Gj.UISurfaces.qr().then(f=>{a?f.updateTaskPane(xc.a.VX,c):f.showTaskPane(xc.a.VX,c);return null})}ur(){Gj.UISurfaces.qr().then(a=>
{a.hideTaskPane(xc.a.VX,2);return null})}SA(){var a;const b=this.gb.rf();var c=[];for(var f of b)f.Lf?c=Array.isArray(c.concat.apply(c,this.Ga.rx(f)))?c.concat.apply(c,this.Ga.rx(f)):null:c.push(f);if(!(f=this.ik(b[0]))||this.f$e(b))return this.nJa=!0,this.VLh(0,0,0,0,0,0,0,127,127);var l=this.getBounds(b[0]),u=f.Jd;f=this.$he(l);f=this.XSc(f,1,u);l=this.$le(l);l=this.XSc(l,0,u);this.poa=this.Ulc&&(null===(a=null===b||void 0===b?void 0:b[0])||void 0===a?void 0:a.Cha);this.nJa=0===f||0===l?!0:!1;a=
Math.round(b[0].get_shapeRotation());a=0>a&&md.a("fixBugOfNegativeAngle")?a+360:a;c=this.ik(c[0]);let I=u=0,T=0,ja=0;c&&(u=c.fXa[0],I=c.fXa[1],T=c.fXa[2],ja=c.fXa[3]);f=this.VLh(f,l,a,u,I,T,ja,this.Qzj(b),0);this.Jjm(b,f);return f}Qzj(a){let b=[];for(var c of a)c.Lf?b=Array.isArray(b.concat.apply(b,this.Ga.rx(c)))?b.concat.apply(b,this.Ga.rx(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.exb(a[f])||(c|=4),this.e2&&!this.R4b(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].eFb){c|=120;break}return c}exb(a){return!!a&&
a.SM&&!a.kK}R4b(a){return!!a&&a.isResizable&&!a.kK}GPh(a){if(0>=a.length)return!0;let b=!1;if(this.e2){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.R4b(a[c])){b=!1;break}}return b||this.f$e(a)}f$e(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].vd){b=!0;break}return b}Jjm(a,b){if(this.Ecd){var c=[];for(var f of a)f.Lf?c=Array.isArray(c.concat.apply(c,this.Ga.rx(f)))?c.concat.apply(c,this.Ga.rx(f)):null:c.push(f);var l=f=!0,u=!0,I=!0;if(2<=c.length)for(var T=1;T<c.length;T++){var ja=
c[T];if(!ja)continue;if(!this.getBounds(ja))continue;ja=this.ik(ja);let ua=0,Ra=0,eb=0,Bb=0;ja&&(ua=ja.fXa[0],Ra=ja.fXa[1],eb=ja.fXa[2],Bb=ja.fXa[3]);f&&b.leftMargin!==ua&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Ra&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);u&&b.topMargin!==eb&&(b.topMargin=0,b.emptyValueFields|=32,u=!1);I&&b.bottomMargin!==Bb&&(b.bottomMargin=0,b.emptyValueFields|=64,I=!1);if(!(f||l||u||I))break}}if(!(2>a.length))for(l=f=c=!0,u=1;u<a.length;u++)if(I=a[u])if(T=
this.getBounds(I))if(ja=this.ik(I).Jd,I=this.$he(T),I=this.XSc(I,1,ja),T=this.$le(T),T=this.XSc(T,0,ja),ja=a[u].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(I.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(T.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==ja&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}wQl(a,b,c,f,l,u,I,T,ja){const ua=new xG,Ra=Object(gb.a)(Object,fh.e().numberFormatInfo);ua.numberFormatInfo=
Ra;ua.height=a;ua.width=b;ua.rotation=c;ua.leftMargin=f;ua.rightMargin=l;ua.topMargin=u;ua.bottomMargin=I;ua.disabled=T;ua.onChange=Object(R.a)(this,this.dza,"onPropertyChange");ua.emptyValueFields=ja;ua.isAspectRatioLocked=this.poa;ua.isAspectRatioDisabled=this.nJa;ua.onToggleAspectRatio=Object(R.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");ua.isAspectRatioFeatureEnabled=this.sVg;ua.isMarginFieldEnabled=this.Ecd;return ua}xQl(a,b,c,f,l){const u=new xG,I=Object(gb.a)(Object,fh.e().numberFormatInfo);
u.numberFormatInfo=I;u.height=a;u.width=b;u.rotation=c;u.disabled=f;u.onChange=Object(R.a)(this,this.dza,"onPropertyChange");u.emptyValueFields=l;u.isAspectRatioLocked=this.poa;u.isAspectRatioDisabled=this.nJa;u.onToggleAspectRatio=Object(R.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");u.isAspectRatioFeatureEnabled=this.sVg;return u}VLh(a,b,c,f,l,u,I,T,ja){return this.Ecd?this.wQl(a,b,c,f,l,u,I,T,ja):this.xQl(a,b,c,T,ja)}dza(a,b){const c=this.gb.rf();this.f_g!==b&&(this.K9a(),this.f_g=b);
switch(b){case 0:case 1:this.resize(a,c,b);break;case 3:case 4:case 5:case 6:this.cRi(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.poa=a;this.Ulc&&(a={["lockAspectRatioEnabled "]:a,["selectedShapes"]:this.gb.rf()},this.ia.Ia(M.a.wNh,2,a))}UTf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}cRi(a,b,c){let f=[];for(const u of b)u.Lf?f=Array.isArray(f.concat.apply(f,this.Ga.rx(u)))?f.concat.apply(f,this.Ga.rx(u)):null:f.push(u);this.wKa=b=f;let l=!0;this.hZ||(this.hZ=[],l=
!1);jh.b("FormatShapePaneActor::ChangeMargin Property:",Az[c]+"; AspectRatioLocked: "+(!this.nJa&&this.poa),M.a.Rxc,()=>{for(let u=0;u<b.length;u++){const I=b[u],T=this.ik(I);if(!T)continue;l||this.hZ.push(new hC(I,new Mi.a));this.hZ.length===u&&this.hZ.push(new hC(I,new Mi.a));this.hZ[u]||(this.hZ[u]=new hC(I,new Mi.a));const ja=this.hZ[u];ja.Cba.left=I.dla;ja.Cba.right=I.ela;ja.Cba.top=I.fla;ja.Cba.bottom=I.bla;3===c&&(this.hZ[u].Cba.left=a);4===c&&(this.hZ[u].Cba.right=a);5===c&&(this.hZ[u].Cba.top=
a);6===c&&(this.hZ[u].Cba.bottom=a);T.BBa(this.hZ[u].Cba)}return 32});this.ZBc()}resize(a,b,c){this.wKa=b;let f=!0;const l=[],u=[];this.gya||(this.gya=[],f=!1);0===a&&(this.nJa=!0);jh.b("FormatShapePaneActor::Resize Property:",Az[c]+"; AspectRatioLocked: "+(!this.nJa&&this.poa),M.a.Qmb,()=>{for(let ua=0;ua<b.length;ua++){var I=b[ua];const Ra=this.ik(I);if(this.e2){if(!Ra||!this.R4b(I))continue}else if(!Ra)continue;var T=this.getBounds(I),ja=this.$he(T);T=this.$le(T);f||(Array.add(this.gya,new GB(I,
new Mi.a)),Ra.RM=!0,Ra.aF(!1));Array.add(l,Ra.xLa);Array.add(u,new Mi.a);Ra.shapeNode.Lf&&Ra.shapeNode.isEditable&&Ra.Nk&&(Ra.Nk.visible=!0);I=Ra.Jd;if(0===c){I=this.v_f(a,1,I);I=Math.round(I-ja);u[ua].bottom=I;let eb;(eb=this.gya[ua].f3).bottom=eb.bottom+I;if(!this.nJa&&this.poa){ja=this.UTf(T,ja,0,I);u[ua].right=ja;let Bb;(Bb=this.gya[ua].f3).right=Bb.right+ja}}else{I=this.v_f(a,0,I);I=Math.round(I-T);u[ua].right=I;let eb;(eb=this.gya[ua].f3).right=eb.right+I;if(!this.nJa&&this.poa){ja=this.UTf(T,
ja,I,0);u[ua].bottom=ja;let Bb;(Bb=this.gya[ua].f3).bottom=Bb.bottom+ja}}Ra.setOffsets(Mi.a.add(l[ua],u[ua]),!0);Ra.shapeNode.Lf&&Ra.shapeNode.isEditable&&(Ra.aoe(),Ra.$3c())}return 32});this.ZBc()}rotate(a,b){this.wKa=b;let c=!0;a=Math.round(a);this.U_a||(this.U_a=[],c=!1);jh.a("FormatShapePaneActor::Rotate",M.a.Bwc,()=>{for(let f=0;f<b.length;f++){const l=b[f],u=this.ik(l);if(!u)continue;const I=u.IAb().ng(),T=a%Rp.Rrc;c||(u.aF(!1),Array.add(this.U_a,new Rp(l,T)));this.U_a[f].N9d=T;u.setRotation(T,
I)}return 32});this.ZBc()}ik(a){return a?Object(gb.a)(HB.a,a.vg(this.yb.Na)):(ya.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.ik(a);if(!b)return ya.a.J(512500575,822,10,"shapeViewElement == null"),null;b=b.N$b();a.v1&&(b=this.gge(b));return b}v_f(a,b,c){return this.wIa.wQ(this.yb.Xd.g1(a,b),c)}XSc(a,b,c){a=this.yb.Xd.Cf(this.wIa.dJ(a,c),b);return Re.a.Ov(a)}$he(a){a=pd.a.an(a.el(Ge.a.Pv),a.el(Ge.a.hJ));return 1>=a?0:a}$le(a){a=pd.a.an(a.el(Ge.a.Pv),a.el(Ge.a.IF));return 1>=
a?0:a}K9a(){this.Ecd&&this.hZ&&(this.ia.Ia(M.a.Rxc,2,this.hZ),this.hZ=null);if(this.gya){for(var a=0;a<this.wKa.length;a++){var b=this.ik(this.wKa[a]);b&&!b.hm&&(b.shapeNode.Lf&&b.shapeNode.isEditable||(b.RM=!1),b.QA(!1))}this.ia.Ia(M.a.Qmb,2,this.gya);this.gya=null}if(this.U_a){a=[];for(b=0;b<this.wKa.length;b++){const c=this.ik(this.wKa[b]);c&&!c.hm&&(c.QA(!1),md.a("FixUndoRotateMultipleShapes")?a.push(this.wKa[b]):this.ia.Ia(M.a.Bwc,2,this.U_a[b]))}md.a("FixUndoRotateMultipleShapes")&&(b={},b.selectedNodes=
a,b.rotateData=this.U_a,this.ia.Ia(M.a.MHh,2,b));this.U_a=null}this.YKa=this.wKa=null}ZBc(){this.YKa&&$c.a.Cxb(this.YKa);this.YKa=$c.a.nca(Object(R.a)(this,this.K9a,"applyPendingChangesToServerIfRequired"),1E3)}gge(a){const b=pd.a.Bcb(a.ga(0),a.ga(3));a=pd.a.Bcb(a.ga(1),a.ga(2));return new ej.a(new pd.a(b.x,b.y),new pd.a(a.x,b.y),new pd.a(a.x,a.y),new pd.a(b.x,a.y))}}Object(m.a)(tO,"FormatShapePaneActor",null,[106,948]);class iC{constructor(a,b,c,f,l,u,I){this.type="FormatTableTaskPaneProps";this.onChange=
this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const T=Object(gb.a)(Object,fh.e().numberFormatInfo);if(!T)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=T;this.cellHeight=b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=
a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=u;this.emptyValueFields=I}}Object(m.a)(iC,"FormatTableTaskPaneProps",null,[]);class uO{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.uwh=this.xwh=this.wwh=this.vwh=-1}}Object(m.a)(uO,"Margins",null,[]);class vO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb){this.poa=this.Mb=!1;this.TMi=320;this.W_a=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");
if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!u)throw Error.argumentNull("graphOperationEventHandler");if(!I)throw Error.argumentNull("viewElementEventHandlers");if(!T)throw Error.argumentNull("viewEventSource");if(!ja)throw Error.argumentNull("pageView");if(!ua)throw Error.argumentNull("unitConversion");if(!Ra)throw Error.argumentNull("workspace");if(!Bb)throw Error.argumentNull("tableReader");
if(!Ub)throw Error.argumentNull("rowReader");if(!Xb)throw Error.argumentNull("columnReader");if(!eb)throw Error.argumentNull("loadScript");eb("powerpoint-editor-intl").then(()=>{this.W_a=!0}).catch(tc=>{ya.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+tc.toString())});this.gb=a;this.Db=b;this.ia=c;this.Fa=f;this.Wf=u;this.xd=I;this.Hc=T;this.Wf.HJ(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));this.Wf.$Da(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));this.Hc.zSa(Object(R.a)(this,
this.e1a,"onChangeRenderFormatTablePane"));this.xd.eEa(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));this.Db.QH(Object(R.a)(this,this.St,"onAppFrameModeSwitched"));this.RK=Xb;this.u0a=Ub;this.Cc=Bb}dispose(){this.Wf.E7(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));this.Wf.w2a(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));this.Hc.Emb(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));this.xd.Gmb(Object(R.a)(this,this.e1a,"onChangeRenderFormatTablePane"));
this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"))}qb(){this.ia.pa(M.a.Pyc,wc.a.application,Object(R.a)(this,this.Pyc,"showHideReactFormatTablePane"),4);this.ia.pa(M.a.zOb,wc.a.application,Object(R.a)(this,this.zOb,"queryReactFormatTablePane"),96)}Sd(){}e1a(){this.Mb&&this.Jl(!0)}St(a){1===a.mode&&this.Mb&&(this.Mb=!1,this.ur(),this.Fa.qk(xc.a.aBa,this.Mb))}zOb(a,b,c,f,l){(a=Object(gb.a)(Di.a,l))&&a.Rf(this.Mb);return 32}Pyc(a,b,c){if(!this.W_a)return 8;b=this.gb.rf();if(1===c)return b.length?
32:8;this.Mb=!this.Mb;return jh.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Mb.toString(),a,()=>{this.Mb?this.Jl():this.ur();return 32})}Jl(a){a=void 0===a?!1:a;const b=this.SA(),c=Object.assign(new jv.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.TMi,location:2,contentProps:b,onOpen:()=>{ya.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},onClose:()=>{this.Mb=!1;ya.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},
isModernPane:!0});Gj.UISurfaces.qr().then(f=>{a?f.updateTaskPane(xc.a.aBa,c):f.showTaskPane(xc.a.aBa,c);return null}).catch(f=>{ya.a.J(512500571,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}ur(){Gj.UISurfaces.qr().then(a=>{a.hideTaskPane(xc.a.aBa,2);return null}).catch(a=>{ya.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+a.toString())})}SA(){var a=this.gb.$n();const b=new uO;if(!a)return a=
new iC(b,0,0,0,0,!0,255),this.Q7e(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.iJj(a,c,f));const l=Re.a.Ov(this.Cc.qle(a)),u=Re.a.Ov(this.Cc.sle(a));let I=this.gb.yw();I&&I.length||(I=this.Cc.LG(a));if(!I||!I.length)return a=new iC(b,c,f,l,u,!0,255),this.Q7e(a);this.hJj(I,b);a=new iC(b,c,f,l,u,!1,0);this.Q7e(a);this.Ijm(a);return a}Q7e(a){a.onChange=Object(R.a)(this,this.dza,"onPropertyChange");a.isAspectRatioLocked=this.poa;a.onToggleAspectRatio=Object(R.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");
return a}iJj(a,b,c){let f=this.gb.P1c(),l=this.gb.OBb();f&&f.length||(f=this.Cc.Gma(a));l&&l.length||(l=this.YBb(a));f.length&&(b=Re.a.Ov(this.u0a.Bhg(f)));l.length&&(c=Re.a.Ov(this.RK.Dhg(a,l)));return{cellHeight:b,cellWidth:c}}hJj(a,b){let c=!0,f=!0,l=!0,u=!0;for(const I of a)I&&!I.isGhostCell&&({o6c:c,cellMargin:b.leftMargin,zsd:b.vwh}=this.KEd(c,b.leftMargin,I.marginLeft,b.vwh),{o6c:f,cellMargin:b.rightMargin,zsd:b.wwh}=this.KEd(f,b.rightMargin,I.marginRight,b.wwh),{o6c:l,cellMargin:b.topMargin,
zsd:b.xwh}=this.KEd(l,b.topMargin,I.marginTop,b.xwh),{o6c:u,cellMargin:b.bottomMargin,zsd:b.uwh}=this.KEd(u,b.bottomMargin,I.marginBottom,b.uwh))}KEd(a,b,c,f){a&&(b=Re.a.Ov(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{o6c:a,cellMargin:b,zsd:f}}Ijm(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}dza(a,b){const c=
{};c.Number=a;switch(b){case 0:this.ia.Ia(M.a.D3a,2,c);break;case 1:this.ia.Ia(M.a.ENa,2,c);break;case 2:this.ia.Ia(M.a.Uqa,2,c);break;case 3:this.ia.Ia(M.a.FNa,2,c);break;case 4:this.ia.Ia(M.a.Rzc,2,c);break;case 5:this.ia.Ia(M.a.Vzc,2,c);break;case 6:this.ia.Ia(M.a.Wzc,2,c);break;case 7:this.ia.Ia(M.a.Qzc,2,c)}}onToggleAspectRatio(a){this.poa=a;this.ia.Ia(M.a.xxc,2,null)}YBb(a){let b=null;a&&14===a.type&&(b=this.Cc.nle(a.firstRow));return b}}Object(m.a)(vO,"FormatTablePaneActor",null,[106,948]);
class jC{constructor(a,b,c){this.oa=a;this.yb=b;this.Ga=c}process(a,b,c,f){2===c&&32===f&&b.contextId===ta.a.view&&Array.contains(jC.dJl,a)&&(a=this.oa.Hd(),0<a.length&&0<this.Ga.textLength(a[0])&&this.BRi(a[0]))}BRi(a){if(!a.Hba){var b=$d.SelectionFactory.Nl(a);b=Bc.SelectionEditor.M9b(b);var c=Bc.SelectionEditor.L9b(b,!1);b=$d.SelectionFactory.PO(b,c.Ua,!1);if((c=this.oa.Oa)&&c.kb&&c.kb.contains(b)&&2===a.zA){var f=Object(gb.a)(178,a.sc(this.yb.Na));if(f){b=a.zA;c=a.o3;var l=a.p3;a.zA=1;a.o3=1;
a.p3=0;f=f.i9f();f.YQf();f.aQf();f.HBa();f.Eag()&&(a.zA=b,a.o3=c,a.p3=l);f.detach();f.Lgf()}}}}}jC.dJl=[G.a.$q,G.a.OG,G.a.rH];Object(m.a)(jC,"FormattingViewOperationFinishedStageProcessor",null,[1778]);var bT=d(630);class wO extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(m.a)(wO,"SectionNodeChangedArgs",Sys.EventArgs,[]);class xO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.gS=null;this.Rq=a;this.Eb=b;this.Yb=c;this.oa=f;this.Fa=l;this.ka=T;this.ho=this.ka.RD;this.De=I;this.Rga=
this.ka.Zwe;this.Tb=u;this.Jfd=this.ka.tgc;this.ic=ja;this.ks=ua;this.sa=Ra;this.yb=eb;Bb.execute(Ub=>{this.gS=Ub})}sjj(a,b,c){if(a&&a.length){for(var f of a)if(!f||Vh.a.Cx(f.Fb))return;f=this.ka.Cm?!0:A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewEnabled")&&!!this.yb&&1===this.yb.$i;var l=this.Eb.ud(15,void 0,()=>{this.Fa.Df(yj.a.XE);this.oa.Bh()});try{l.mc(this.Rq),this.Rga?this.Rq.URe(a,b,c,f):this.Rq.TRe(a[0],b,c,f)}finally{l&&l.dispose()}}}E$f(a,b){var c=this.Tb.Fn;if(c&&c.Yq)if(b&&
!a||!b&&a===c.Yq.length-1)ya.a.J(509364431,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=md.a("FixSectionMoveBug")?c.lLl:c.Yq;var l=Date.now(),u=this.Eb.ud(15,void 0,()=>{},()=>{});try{u.mc(this.Rq);const I=f[a],T=b?f[a-1]:f[a+1];c.setValue(yb.a.$Yk,I);c.setValue(yb.a.FYk,T);if(I&&T){let ja=-1,ua=-1;for(let Ra=0;Ra<f.length&&!(I===f[Ra]&&(ja=Ra),T===f[Ra]&&(ua=Ra),0<=ja&&0<=ua);Ra++);Array.removeAt(f,ja);Array.insert(f,ua,I);c.anchor?c.anchor.bpb(f,
34,!1):ya.a.J(509364430,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{u&&u.dispose()}this.sa.Ou=b?0<=a-1?a-1:0:a+1;c=Date.now();ya.a.J(509364429,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.ks?this.ks.m1e():ya.a.J(509364428,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(509364432,
808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}Zij(a,b){if(a||md.a("AllowSectionAfterLastSlide")){var c=this.Tb.Fn;if(c){var f=c.Yq;f&&f.length||ya.a.J(509364425,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Eb.ud(15,void 0,()=>{},()=>{});try{l.mc(this.Rq);l.Wc=b;const u=f&&f.length?a?this.De.FR(a.Fb):f.length-1:0;this.Rq.z9a(a,u)}finally{l&&l.dispose()}this.ic.mx(this.Rq,b);b=Date.now();ya.a.J(509364424,822,
50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",a.slideIndex,c,b,b-c);this.ks?this.ks.m1e():ya.a.J(509364423,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(509364426,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else ya.a.J(509364427,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}Gjj(a){var b=this.Tb.Fn;if(b&&
b.Yq){var c=b.Yq;if(!a||a.sectionIndex>=c.length)ya.a.J(509364421,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=b.Yng(a.sectionIndex);c=null;f&&(c=Object(gb.a)(bT.a,b.cLj(f.sectionId)));b=Date.now();f=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{});try{f.mc(c),c.title=a.slm}finally{f&&f.dispose()}c=Date.now();ya.a.J(509364420,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",
a.sectionIndex,b,c,c-b)}}else ya.a.J(509364422,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}yjj(a,b){const c=this.Tb.Fn;if(c&&c.Yq){var f=c.Yq,l=this.sa.x4,u=Date.now(),I=f.length,T=this.Eb.ud(15,void 0,()=>{},()=>{});try{T.mc(this.Rq);T.Wc=b;if(a){const ua=this.Tb.NBb(a-1);let Ra=l.JB;if(ua&&Ra){const eb=ua.JB?ua.JB:[];for(var ja=0;ja<eb.length;ja++)if(md.a("AddSlideNodeToPreviousSection")){const Bb=this.Tb.Qk(ua.YF[ja]);Bb&&this.oa.ZDa(Bb)}for(ja=0;ja<Ra.length;ja++)Array.insert(eb,
eb.length,Ra[ja]);Ra=[];ua.JB=eb}}Array.removeAt(f,a);c.v4f(l)}finally{T&&T.dispose()}this.sa.Ou=0<=a-1?a-1:0;this.ic.mx(this.Rq,b);b=Date.now();ya.a.J(509364418,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",a,u,b,b-u,I,f.length);this.ks?this.ks.Tql(new wO(l)):ya.a.J(509364417,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(509364419,
808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}lXc(a,b,c,f){if(!b||!this.Jfd&&!c)return null;let l=null;const u=this.Eb.ud(15,void 0,()=>{md.a("FixDocumentFocusIssue")||this.Fa.Gd();this.oa.Bh()},()=>{1!==this.yb.$i&&(md.a("FixDocumentFocusIssue")?this.Fa.Df(this.Fa.Je.name):this.Fa.Df(yj.a.XE))});try{let I;I=this.ka.Cm?!0:A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewEnabled")&&!!this.yb&&1===this.yb.$i;let T;T=md.a("SlideSorterInsertionAfterFirstSlide")?
!!this.yb&&(1===this.yb.$i||md.a("IPBeforeFirstSlideFix")&&this.ka.Cm&&0==this.yb.$i)&&-1===this.Yb.yza:!!this.yb&&1===this.yb.$i&&!this.Yb.yza;const ja=this.sa.x4;if(I&&ja&&(!ja.YF||!ja.YF.length)||T)T&&(this.Yb.yza=-1),a=null;u.mc(this.Yb.Of);u.Wc=f;l=Object(gb.a)(205,this.Rq.O2b(a,ja,b,c,I));this.ho&&this.oa.sQ(l);this.Yb.Aa=l;this.Yb.Of.removeProperty(yb.a.aXe)}finally{u&&u.dispose()}return l}rjj(a,b,c,f,l,u){if(5!==f)throw Error.invalidOperation();const I=Object(gb.a)(205,this.Rq.t8d(a,b,c));
if(!I)return ya.a.J(509364416,822,10,"CreateSlideNodeForInsertion returned null"),null;b=this.ka.Cm?!0:A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewEnabled")&&!!this.yb&&1===this.yb.$i;c=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{this.ho&&this.oa.sQ(I);this.Fa.Df(yj.a.XE)});try{c.mc(this.Yb.Of),c.Wc=u,this.Rq.eeb(I,a,null,b),l&&(this.Yb.Aa=I)}finally{c&&c.dispose()}return I}ljj(a,b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");c||(c=a);let f;f=this.ka.Cm?
!0:A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewEnabled")&&!!this.yb&&1===this.yb.$i;let l=null;const u=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{1!==this.yb.$i&&(this.ka.Cm?this.Fa.Df(xc.a.KB):this.Fa.Df(yj.a.XE))});try{u.mc(this.Yb.Of),u.Wc=b,l=Object(gb.a)(205,this.Rq.uR(Object(gb.a)(267,a),Object(gb.a)(267,c),f,!0)),this.gS&&this.gS.c5f([l]),this.ho&&this.oa.sQ(l),this.Yb.Aa=l}finally{u&&u.dispose()}return l}A$f(a,b,c,f,l){const u={},I={};u.ST=(new Date).getTime();
if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const T=[];a=Array.clone(a);a.sort((Ra,eb)=>eb.ve-Ra.ve);c||(c=a[0]);let ja;ja=this.ka.Cm?!0:A.AFrameworkApplication.fa.getBooleanAppSetting("PPTSorterViewEnabled")&&!!this.yb&&1===this.yb.$i;const ua=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{1!==this.yb.$i&&(this.ka.Cm?this.Fa.Df(xc.a.KB):this.Fa.Df(yj.a.XE))});try{ua.mc(this.Yb.Of);ua.Wc=b;u.TBA=(new Date).getTime();for(let eb=0;eb<a.length;eb++){if(!a[eb])continue;const Bb=
Object(gb.a)(205,this.Rq.uR(Object(gb.a)(267,a[eb]),Object(gb.a)(267,c),ja,l));Aa.a.Ta(f)||(Bb.$b=f);Array.add(T,Bb)}u.TAA=(new Date).getTime();I.SrcSlidesCount=a.length;0<T.length&&this.gS&&this.gS.c5f(T);I.BeforeSlideNodeColl=(new Date).getTime();let Ra;(Ra=this.oa).sQ.apply(Ra,T);this.Yb.Aa=T[T.length-1];this.De.abb=!0}finally{I.BeforeTxn=(new Date).getTime(),ua&&ua.dispose()}u.ET=(new Date).getTime();u.DATA=Qa.a.toJSON(I);u.ACT=ff.ActionManager.Xda(b);u.FUNC="GraphTransactionHelperProxy::executeDuplicateSlidesGraphTransaction";
ya.a.J(508359425,813,50,Qa.a.toJSON(u));return T}NU(a,b,c,f,l,u){f=void 0===f?null:f;l=void 0===l?null:l;u=void 0===u?!0:u;if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let I=null;u&&1!==this.yb.$i&&(I=()=>{this.oa.$2a(a,!0)});u=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},I);try{u.mc(b);u.Wc=c;this.Twi(u,
a);const T=new Sys.StringBuilder;for(c=0;c<a.length;c++){const ja=f?f[c]:null;a[c]&&(b.ZB(a[c],ja),a[c].id&&T.append(a[c].id.toString()+";"))}u.ny[nr.a.Rth]=T.toString();l&&b.XS([l])}finally{u&&u.dispose()}}Twi(a,b){if(1!==b.length||!b[0].vd&&Aa.a.Ta(b[0].z1a))for(const c of b){if(c.Xeb||c.$j)a.ny[nr.a.Ccc]=!0;if(c.Vp||2===c.mediaType||1===c.mediaType)a.ny[nr.a.G3c]=!0;c.Lq&&(a.ny[nr.a.F3c]=!0)}else a.ny[nr.a.Dcc]=!0}gbb(a,b){if(!(1>b.length)){var c=this.Eb.ud(15);try{c.mc(b[0]);const f=this.oa.pQ(Array.isArray(b)?
b:null);for(const l of f)a(l)}finally{c&&c.dispose()}}}Yla(a,b){this.gbb(c=>{(c=Object(gb.a)(4,c))&&a(c)},b)}}Object(m.a)(xO,"GraphTransactionHelperProxy",null,[1746]);var yG=d(296),Rq=d(297);class yO{constructor(a,b,c,f){this.Jwc=a;this.Kwc=b;this.P9c=c;this.Q9c=f}Nhf(a,b,c,f){a<this.Jwc&&(this.Jwc=a);b<this.Kwc&&(this.Kwc=b);a+c>this.P9c&&(this.P9c=a+c);b+f>this.Q9c&&(this.Q9c=b+f)}}Object(m.a)(yO,"GroupShapeOffset",null,[]);class zO{constructor(a,b,c,f,l,u,I,T,ja,ua){this.ia=a;this.Eb=b;this.oa=
c;this.Ga=f;this.sa=l;this.Vk=u;this.yb=I;this.Ji=T;this.GP=ja;this.ka=ua}qb(){this.ia.pa(M.a.vYe,wc.a.application,Object(R.a)(this,this.qWj,"handleGroupShapes"),4);this.ia.pa(M.a.DYe,wc.a.application,Object(R.a)(this,this.e0j,"handleUngroupShapes"),4);this.ia.pa(M.a.uYe,wc.a.application,Object(R.a)(this,this.pWj,"handleGroupFlyoutAnchor"),4)}Sd(){const a=this.GP.Bp.Kc(xc.a.Ag);a.bindAction(B.KeyInputManager.Va(H.a.lVb,B.KeyInputManager.Ze),M.a.vYe);a.bindAction(B.KeyInputManager.Va(H.a.lVb,B.KeyInputManager.Ze|
4),M.a.DYe)}GUf(a){let b=1<a.length&&!a[0].Rg&&!a[1].Rg;if(b)for(const c of a)if(this.ka.Lma){if(c.LLb||c.Sk||c.vd||this.ka.enableCameoInEditor&&c.lF){b=!1;break}}else if(c.Sk||c.vd){b=!1;break}return b}MGj(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}qWj(a,b,c){const f=this.oa.Hd();return this.GUf(f)?1===c?32:jh.a("GroupOperations_GroupShapes",a,()=>{const l=[];for(var u of f)l.push(u.id);u=Object(gb.a)(205,this.sa.Aa);if(!u)throw Error.argumentNull("ActiveSlide is null");
const I=u.wt(),T=new yO(u.yq,u.yl,0,0);var ja=0;let ua=ja=0;for(var Ra of f)(ja=this.MGj(Ra),Ra.dA)?(ja=Ra.zz,ua=Ra.Az,T.Nhf(ja,ua,Ra.Qea,Ra.Pea)):ja?90===ja&&(ja=Ra.zz+Ra.zy/2-Ra.XD/2,ua=Ra.Az+Ra.XD/2-Ra.zy/2,T.Nhf(ja,ua,Ra.XD,Ra.zy)):(ja=Ra.zz,ua=Ra.Az,T.Nhf(ja,ua,Ra.zy,Ra.XD));const eb=this.Vk.cFa(!1,u.Fb.cid,u.Fb.sid,0,10,T.Jwc,T.Kwc,T.P9c-T.Jwc,T.Q9c-T.Kwc,I+1);ya.a.J(508826962,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.Dbk(eb,u.Fb,T.P9c-
T.Jwc,T.Q9c-T.Kwc);u.ZB(eb);Ra=this.Eb.ud(15,void 0,void 0,()=>{this.oa.selectShape(eb,!0)});try{Ra.mc(u),Ra.Wc=a,1<l.length&&(u.y$=l)}finally{Ra&&Ra.dispose()}return 32}):8}WUf(a){for(const b of a)if(this.ka.Lma){if(b.Lf&&!b.MLb)return!0}else if(b.Lf)return!0;return!1}e0j(a,b,c){const f=this.oa.Hd();return this.WUf(f)?1===c?32:jh.a("GroupOperations_UngroupShapes",a,()=>{const l=[];var u=[];for(const T of f)if(T.Lf){l.push(T.id);const ja=this.Ga.rx(T);for(const ua of ja)u.push(ua);this.oa.T9(T)}for(var I of u)u=
ek.c(I,this.yb.Na),this.oa.T9(I),u.Qma(),u.sQb=!0;I=this.sa.Aa;ya.a.J(508826961,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);u=this.Eb.ud(15);try{u.mc(I),u.Wc=a,I.zra=l}finally{u&&u.dispose()}return 32}):8}pWj(a,b,c){b=this.oa.Hd();a=this.GUf(b);b=this.WUf(b);return 1===c?a||b?32:8:32}Dbk(a,b,c,f){var l=Object(gb.a)(227,Object(gb.a)(205,this.sa.Aa).vg(this.yb.Na));const u=this.yb.Xd,I=Math.round(this.Ji.wQ(u.Ve(c,0),l.cV));l=Math.round(this.Ji.wQ(u.Ve(f,
1),l.cV));a.setValue(rb.a.zy,c);a.setValue(rb.a.XD,f);a.setValue(yb.a.eVb,c);a.setValue(yb.a.zCb,f);a.isEditable=!0;a.Lf=!0;a.setValue(yb.a.fM,4);a.setValue(yb.a.yvd,!0);a.Qea=Ad.a.gMa(I,0);a.Pea=Ad.a.gMa(l,1);a.setValue(yb.a.BUa,0);a.setValue(yb.a.CUa,0);a.setValue(yb.a.VXa,!0);a.setValue(yb.a.isResizable,!0);a.setValue(yb.a.SM,!0);a.kP=!0;a.QXa=!0;a.SM=!0;a.isResizable=!0;a.tH=Vh.a.Aq(b.sid,b.cid);a.Kob=a.get_shapeId();a.setValue(yb.a.bwa,!0);b=Object.assign(new yG.a,{TopLeft:Object.assign(new Rq.a,
{X:0,Y:0}),TopRight:Object.assign(new Rq.a,{X:I,Y:0}),BottomLeft:Object.assign(new Rq.a,{X:0,Y:l}),BottomRight:Object.assign(new Rq.a,{X:I,Y:l})});a.ZS=b;this.Ga.TM(a)&&$c.a.Kb&&($c.a.Kb.tk=!0)}}Object(m.a)(zO,"GroupUngroupShapesActor",null,[948]);class AO{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(m.a)(AO,"FooterPaneInfo",null,[]);var BO=d(628);class zG{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=
0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(m.a)(zG,"PresFooterInfo",null,[]);var CO=d(658);class DO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.koa=null;a("powerpoint-editor-intl").then(()=>{ya.a.J(509117598,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{ya.a.J(509117597,801,50,"Header Footer Pane Manager script is loaded successfully");this.koa=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();
this.Iwl()}).catch(Ub=>{ya.a.J(509117596,801,10,"Failed to load headerfooter pane manager "+Ub.toString())})}).catch(Ub=>{ya.a.J(509117595,801,10,"Failed to load powerpoint-editor-intl "+Ub.toString())});this.gb=b;this.Db=c;this.ia=f;this.Yb=l;this.sa=u;this.Fa=I;this.Hw=T;this.Wf=ja;this.xd=ua;this.Hc=Ra;this.Eb=eb;this.Wf.HJ(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.F9a(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.$Da(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));
this.Hc.zSa(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.xd.eEa(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Db.QH(Object(R.a)(this,this.St,"onAppFrameModeSwitched"));this.lA=null;this.SIb=!1;this.nKb=Bb}dispose(){this.Wf.E7(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.Qvc(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.w2a(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Hc.Emb(Object(R.a)(this,this.YK,
"onChangeRenderHeaderFooterPane"));this.xd.Gmb(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"))}Sd(){}qb(){this.ia.pa(M.a.aeb,wc.a.application,Object(R.a)(this,this.aeb,"insertFooterFlyoutMenu"),4);this.ia.pa(M.a.r_,wc.a.application,Object(R.a)(this,this.r_,"showHideHeaderFooterPane"),4);this.ia.pa(M.a.pXa,wc.a.application,Object(R.a)(this,this.pXa,"insertSlideNumber"),4);this.ia.pa(M.a.guc,wc.a.application,Object(R.a)(this,
this.guc,"queryHeaderFooterPane"),96)}guc(a,b,c,f,l){(a=Object(gb.a)(Di.a,l))&&a.Rf(this.Hw.isVisible);return 32}aeb(){return this.koa&&this.Yb&&this.sa.Aa&&this.Yb.isEditingAllowed?32:8}r_(a,b,c){if(1===c)return this.Hw&&this.sa.Aa?32:8;if(!this.Hw)return 8;this.lA=null;this.Hw.isVisible=!this.Hw.isVisible;this.Hw.isVisible?(jh.a("FooterPaneOpen",a,()=>{this.Tvc();return 32}),this.nKb||(this.Fa.qk(xc.a.iK,!0),this.koa.focus())):this.Fa.qk(xc.a.iK,!1);return 32}pXa(a,b,c,f,l){return 1===c?this.sa.Aa?
32:8:jh.a("FooterPaneInsertSldNumber",a,()=>{const u=this.$sc();this.VBc(u.OmitOnTitlePh,u.IsFooterInsert,u.SFooterName,!0);return this.r_(a,b,c,f,l)})}St(a){1===a.mode&&this.Hw&&this.Hw.isVisible&&(this.lA=null,this.Hw.isVisible=!1,this.Fa.qk(xc.a.iK,!1))}Bje(a){const b=new La.a;a=a.aA();for(const c of a)(a=$a.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}$sc(){const a=new BO.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.sa.Aa;if(!b)return a;
if((b=b.yj(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.Sk&&(5===c.mj?a.IsSlideNumInsert=!0:6===c.mj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.VA?this.Bje(c):"",0<b.length?a.SFooterName=b:ya.a.J(509117594,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Yb.Of.ALa;return a}isMultipleSlidesSelected(){const a=this.gb.Xe();return a&&1<a.length?!0:!1}Tvc(){if(this.Hw.isVisible)if(this.sa.Aa){var a=this.$sc(),b=this.isMultipleSlidesSelected();if(!this.lA||a.IsFooterInsert!==this.lA.IsFooterInsert||
a.IsSlideNumInsert!==this.lA.IsSlideNumInsert||a.OmitOnTitlePh!==this.lA.OmitOnTitlePh||a.SFooterName.localeCompare(this.lA.SFooterName)||b!==this.SIb){this.lA=a;this.SIb=b;var c=new AO;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.koa.renderHeaderFooterTaskPane(CO.a.Ioe,c)}}else this.Hw.isVisible=!1,this.lA=null}YK(){this.Tvc()}Iwl(){this.koa.addCloseHeaderFooterPaneEventListener(()=>
{this.Hw.isVisible=!1;this.lA=null});this.koa.addFocusHeaderFooterPaneListener(()=>{this.Fa.qk(xc.a.iK,!0)});this.koa.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.yhf(a,b,c,f,l)});this.koa.addUpdateMultiSlideHeaderFooterListener((a,b,c,f)=>{this.Khf(a,b,c,f)})}yhf(a,b,c,f,l){this.sa.Aa&&(l?this.Rhf(a,b,c,f):this.VBc(a,b,c,f))}Khf(a,b,c,f){this.sa.Aa&&jh.a("FooterPaneMultiSlide",M.a.r_,()=>{const l=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{l.mc(this.sa.Aa);const u=this.gb.Xe();if(u&&1<u.length){for(const I of u){const T=
I.a$;T.IsSlideNumInsert=f;T.IsFooterInsert=b;T.OmitOnTitlePh=a;T.SFooterName=c;T.IsToggled=!T.IsToggled;I.a$=T}this.Yb.Of.ALa=a}}finally{l&&l.dispose()}return 32})}VBc(a,b,c,f){let l="FooterPaneSingleSlide";const u=this.sa.Aa,I=u.a$;if(a||b||f)I.OmitOnTitlePh!==a?l+="_OPH":I.IsSlideNumInsert!==f?l+="_ISN":I.IsFooterInsert!==b&&(l+="_IFT");jh.a(l,M.a.r_,()=>{const T=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{T.mc(this.sa.Aa),I.IsSlideNumInsert=f,I.IsFooterInsert=b,I.OmitOnTitlePh=a,I.SFooterName=
c,I.IsToggled=!I.IsToggled,this.Yb.Of.ALa=a,u.a$=I}finally{T&&T.dispose()}return 32})}Rhf(a,b,c,f){jh.a("FooterPaneAllSlides",M.a.r_,()=>{const l=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{const u=this.Yb.Of;l.mc(u);let I=u.rMa;I||(I=new zG);const T=this.sa.Aa;I.ActiveSlideCid=T.cid;I.ActiveSlideSid=T.sid;I.IsSlideNumInsert=f;I.IsFooterInsert=b;I.IsOmitOnTitlePh=a;I.SFooterName=c;I.IsToggled=!I.IsToggled;u.ALa=a;u.rMa=I}finally{l&&l.dispose()}return 32})}}Object(m.a)(DO,"HeaderFooterPaneActor",
null,[948]);class EO{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(m.a)(EO,"FooterPaneInfo",null,[]);class FO{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(m.a)(FO,"HeaderFooterContentProps",null,[]);class GO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.Vdd=!1;Bb?this.Vdd=!0:a("powerpoint-editor-intl").then(()=>
{ya.a.J(509117590,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{ya.a.J(509117589,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{ya.a.J(509117588,801,50,"Header Footer Pane script is loaded successfully");this.Vdd=!0}).catch(()=>{ya.a.J(509117587,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{ya.a.J(509117586,801,10,"Failed to load Ribbon script")})}).catch(Ub=>{ya.a.J(509117585,801,10,"Failed to load powerpoint-editor-intl "+
Ub.toString())});this.gb=b;this.Db=c;this.ia=f;this.Yb=l;this.sa=u;this.Hw=T;this.Wf=ja;this.xd=ua;this.Hc=Ra;this.Eb=eb;this.Wf.HJ(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.F9a(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.$Da(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Hc.zSa(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.xd.eEa(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Db.QH(Object(R.a)(this,
this.St,"onAppFrameModeSwitched"));this.lA=null;this.SIb=!1;this.nKb=Bb}dispose(){this.Wf.E7(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.Qvc(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Wf.w2a(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Hc.Emb(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.xd.Gmb(Object(R.a)(this,this.YK,"onChangeRenderHeaderFooterPane"));this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"))}Sd(){}qb(){this.ia.pa(M.a.aeb,
wc.a.application,Object(R.a)(this,this.aeb,"insertFooterFlyoutMenu"),4);this.ia.pa(M.a.r_,wc.a.application,Object(R.a)(this,this.r_,"showHideHeaderFooterPane"),4);this.ia.pa(M.a.pXa,wc.a.application,Object(R.a)(this,this.pXa,"insertSlideNumber"),4)}aeb(){return this.Yb&&this.sa.Aa&&this.Yb.isEditingAllowed?32:8}r_(a,b,c){if(1===c)return this.Vdd?32:8;if(!this.Hw)return 8;this.lA=null;this.Hw.isVisible=!this.Hw.isVisible;this.Hw.isVisible?jh.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.nKb.toString(),
a,()=>{this.Tvc();return 32}):this.ur();return 32}St(a){1===a.mode&&this.Hw&&this.Hw.isVisible&&(this.lA=null,this.Hw.isVisible=!1,this.ur())}Jl(a){a=void 0===a?!1:a;const b=this.SA(),c=Object.assign(new jv.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Hw.isVisible=!1},isModernPane:!0});this.nKb?Gj.UISurfaces.qr().then(f=>{a?f.updateTaskPane(xc.a.iK,c):f.showTaskPane(xc.a.iK,c);return null}):(this.Hw.isVisible=!0,taskPanes.taskPane.renderTaskPane(CO.a.Ioe,
c))}ur(){this.nKb&&Gj.UISurfaces.qr().then(a=>{a.hideTaskPane(xc.a.iK,2);return null})}SA(){const a=new EO;a.isFooterInsert=this.lA.IsFooterInsert;a.sFooterName=this.lA.SFooterName;a.isSlideNumInsert=this.lA.IsSlideNumInsert;a.omitOnTitle=this.lA.OmitOnTitlePh;a.isMultipleSlidesSelected=this.SIb;const b=new FO;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(R.a)(this,this.yhf,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(R.a)(this,this.Khf,"updateMultiSlidesFooterInfo");return b}pXa(a,
b,c,f,l){return 1===c?this.Vdd?32:8:jh.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.nKb.toString(),a,()=>{const u=this.$sc();this.VBc(u.OmitOnTitlePh,u.IsFooterInsert,u.SFooterName,!0);return this.r_(a,b,c,f,l)})}Bje(a){const b=new La.a;a=a.aA();for(const c of a)(a=$a.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}$sc(){const a=new BO.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.sa.Aa;if(!b)return a;if((b=b.yj(!0))&&0<b.length)for(const c of b)!c.isLocal&&
c.Sk&&(5===c.mj?a.IsSlideNumInsert=!0:6===c.mj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.VA?this.Bje(c):"",0<b.length?a.SFooterName=b:ya.a.J(509117584,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Yb.Of.ALa;return a}isMultipleSlidesSelected(){const a=this.gb.Xe();return a&&1<a.length?!0:!1}Tvc(a){a=void 0===a?!1:a;if(this.Hw.isVisible)if(this.sa.Aa){var b=this.$sc(),c=this.isMultipleSlidesSelected();if(!this.lA||b.IsFooterInsert!==this.lA.IsFooterInsert||b.IsSlideNumInsert!==this.lA.IsSlideNumInsert||
b.OmitOnTitlePh!==this.lA.OmitOnTitlePh||b.SFooterName.localeCompare(this.lA.SFooterName)||c!==this.SIb)this.lA=b,this.SIb=c,this.Jl(a)}else this.Hw.isVisible=!1,this.lA=null}YK(){this.Tvc(!0)}yhf(a,b,c,f,l){this.sa.Aa&&(f?this.Rhf(a,b,l,c):this.VBc(a,b,l,c))}Khf(a,b,c,f){this.sa.Aa&&jh.a("FooterPaneMultiSlide",M.a.r_,()=>{const l=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{l.mc(this.sa.Aa);const u=this.gb.Xe();if(u&&1<u.length){for(const I of u){const T=I.a$;T.IsSlideNumInsert=c;T.IsFooterInsert=
b;T.OmitOnTitlePh=a;T.SFooterName=f;T.IsToggled=!T.IsToggled;I.a$=T}this.Yb.Of.ALa=a}}finally{l&&l.dispose()}return 32})}VBc(a,b,c,f){let l="FooterPaneSingleSlide";const u=this.sa.Aa,I=u.a$;if(a||b||f)I.OmitOnTitlePh!==a?l+="_OPH":I.IsSlideNumInsert!==f?l+="_ISN":I.IsFooterInsert!==b&&(l+="_IFT");jh.a(l,M.a.r_,()=>{const T=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{T.mc(this.sa.Aa),I.IsSlideNumInsert=f,I.IsFooterInsert=b,I.OmitOnTitlePh=a,I.SFooterName=c,I.IsToggled=!I.IsToggled,this.Yb.Of.ALa=
a,u.a$=I}finally{T&&T.dispose()}return 32})}Rhf(a,b,c,f){jh.a("FooterPaneAllSlides",M.a.r_,()=>{const l=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{const u=this.Yb.Of;l.mc(u);let I=u.rMa;I||(I=new zG);const T=this.sa.Aa;I.ActiveSlideCid=T.cid;I.ActiveSlideSid=T.sid;I.IsSlideNumInsert=f;I.IsFooterInsert=b;I.IsOmitOnTitlePh=a;I.SFooterName=c;I.IsToggled=!I.IsToggled;u.ALa=a;u.rMa=I}finally{l&&l.dispose()}return 32})}}Object(m.a)(GO,"HeaderFooterPaneWacActor",null,[948]);class HO{constructor(a,b,c,
f,l){this.ms=a;this.ia=b;this.Yb=c;this.sa=f;this.ic=l}qb(){this.ia.pa(M.a.a5c,ta.a.application,Object(R.a)(this,this.MWj,"handleInsertContentFromStream"),4)}Sd(){}MWj(a,b,c,f,l){b=this.sa.Aa;if(this.ic.Xc(b))return 16;if(1===c)return 32;$c.a.Xk("SlideCount","1");c=this.ms.rjj(b,l.streamUrl,l.formatType,l.objectType,l.renderAfterInsert,a);l.renderAfterInsert&&c&&!c.nP&&this.ic.mx(this.Yb.Of,a);return 32}}Object(m.a)(HO,"InsertContentFromStreamActor",null,[948]);class IO{constructor(a,b){this.Ji=a;
this.Tb=b}j2d(a,b,c,f){const l=I=>this.Ji.wQ(a.Ve(Ad.a.Cf(I,0),0),f),u=Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new yG.a,{TopLeft:Object.assign(new Rq.a,{X:0,Y:0}),TopRight:Object.assign(new Rq.a,{X:u,Y:0}),BottomLeft:Object.assign(new Rq.a,{X:0,Y:b}),BottomRight:Object.assign(new Rq.a,{X:u,Y:b})})}k6d(a,b,c){var f=a?a.Wne:9;const l=Ad.a.Ve(a?a.ljf:6,0,!1);f=Ad.a.Ve(f,1,!1);b=this.EXi(l,f,b,c);a=a?a.uBb(b.width,b.height,!0):
this.Tb.Ama(b.width,b.height);return{ede:b,gD:a}}EXi(a,b,c,f){let l=0,u=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),u=Math.max(f*a,1));return new Rr.a(l,u)}}Object(m.a)(IO,"InsertImageHelper",null,[1782]);var ve=d(696),kC=d(695);class JO{oog(a,b,c,f){b=a.right-a.left;a=a.bottom-a.top;b=Math.max(b,1);a=Math.max(a,1);return{TOh:f.wQ(b,c),LOh:f.wQ(a,c)}}t0f(a,b,c){return Object.assign(new yG.a,{TopLeft:Object.assign(new Rq.a,{X:0,Y:0}),TopRight:Object.assign(new Rq.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new Rq.a,
{X:0,Y:b*c}),BottomRight:Object.assign(new Rq.a,{X:a*c,Y:b*c})})}vMh(){}GMh(){}}Object(m.a)(JO,"InsertInkActorHelper",null,[1303]);var cT=d(511);class lC{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.Daa=Bb;this.ms=a;this.ia=b;this.sa=c;this.ic=f;this.yb=l;this.Dr=T;this.Vk=ja;this.Lj=ua;this.Ga=Ra;this.Ji=eb}dispose(){}qb(){this.ia.pa(M.a.myg,ta.a.application,Object(R.a)(this,this.NWj,"handleInsertInk"),4)}Sd(){}NWj(a,b,c,f,l){if(!l)return 16;b=l.gd;if(!b)return ya.a.J(508704470,822,15,"HandleInsertInk was called with invalid slideNode!"),
8;f=b.Fb;if(Vh.a.Cx(f)||this.ic.Xc(b))return 16;if(1===c)return 32;c=this.Xbb(a);if(!c)return 8;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;var u=l.rbk;if(!u)return ya.a.J(508704469,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!u.count)return ya.a.J(508704468,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new La.a;for(const Ra of u){u=Ra.$Ii;if(!u)return 16;var I=b.ey;I=I&&null!=I.gt?I.gt:1;u.right=u.left+(u.right-u.left)/(1/I);u.bottom=u.top+(u.bottom-u.top)/(1/
I);var T=u.right-u.left,ja=u.bottom-u.top;T=Math.max(T,1);ja=Math.max(ja,1);var ua=this.yb.Xd;T=Ad.a.Cf(T,0);ja=Ad.a.Cf(ja,1);const eb=ua.Cf(u.left,0);ua=ua.Cf(u.top,1);const Bb=b.wt();u=kC.a.bUc(f,c,I,u,new JO,eb,ua,T,ja,Bb,this.Ga,this.Vk,this.yb,this.sa,this.Ji);u.setValue(yb.a.Yma,Ra.json);u.setValue(yb.a.lwa,!0);$c.a.Kb&&($c.a.Kb.actionName=lC.b3c);u.KJ=new cT.a([Ra.stroke],Ra.json,!1);l.add(u)}this.ms.NU(l.toArray(),b,a,void 0,void 0,!1);for(const Ra of l)this.Daa.registerInkWithStrokeCollection(Ra.KJ.QAa,
Ra.id);this.Dr.YA=l.ga(l.count-1);return 32}Xbb(){return new ve.a(4,10,1,1)}}lC.b3c="InsertInk";Object(m.a)(lC,"InsertInkActor",null,[948,106]);class KO{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra){this.pk=null;this.Eed=!1;this.yb=a;this.Vk=b;this.Fa=c;this.sa=f;this.Tb=l;this.oa=I;this.Dr=T;this.Lj=ja;this.Eb=ua;this.ic=Ra;this.ka=u;this.Blm=u.insertOnlineVideoUrlPatterns;this.bGh=u.insertOnlineVideoEndpoint;this.Ms=A.AFrameworkApplication.Me;this.U$l=3E4}get startTime(){return this.pk}xkj(a){if(!a)return null;
const b=a.trim();this.Yjk(b)&&(ya.a.J(508616856,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.ykj(b));return a}aHg(a){if(!a)return!1;a=a.trim();for(const b of this.Blm)if((new RegExp(b)).test(a))return!0;return!1}Atk(a){if(!a)return!1;a=a.trim();a=oe.a.GD(a).toLowerCase();return"flipgrid.com"===a||"www.flipgrid.com"===a?!1:!0}Udm(a,b){this.requestVideoData(a,c=>{this.Ayg(c)},b)}requestVideoData(a,b,c){this.Eed?ya.a.J(508616855,352,15,"[Insert Online Video] Multiple videos at the same time!"):
(this.Eed=!0,c=c||Object(R.a)(this,this.tdj,"doNothingCallback"),this.pk=new Date,a=Aa.a.We(a),a=this.bGh+(0<this.bGh.indexOf("?")?"&":"?")+"url="+a,this.Ms.Tj(a,1,null,null,!1,2,f=>{b(f);this.Eed=!1},f=>{c(f);this.Eed=!1},null,void 0,void 0,void 0,this.U$l,ro.a("1")))}Ayg(a){var b=+new Date-+this.startTime;ya.a.J(508616854,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);$c.a.Xk("HubbleCallDuration",b.toString());if((b=this.sa.Aa)&&!this.ic.Xc(b)&&this.Lj.UD(b,1))try{const T=
b.U0(this.oa.Hd());if(!T||!this.ic.Xc(T)){var c=this.Pcb(b,T),f=JSON.parse(a.data.Ud),l=f.width,u=f.height;c.k8e(f.embed_url,f.thumbnail_url,f.title,f.description,0<l?l:0,0<u?u:0);var I=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.oa.selectShape(c,!0)});try{I.rd(b),this.ka.acm&&(I.Wc=M.a.Xva,I.ny[nr.a.Rea]=nr.a.Xkb),T&&b.XS([T]),b.ZB(c)}finally{I&&I.dispose()}this.ic.mx(b,"InsertOnlineVideo");this.Dr.YA=c;ya.a.J(508616853,352,50,"[Insert Online Video] Video inserted")}}catch(T){ya.a.J(508616852,
352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",T.message,T.stack)}else this.Lj.yE(b)}tdj(){}Pcb(a,b){var c=void 0===c?0:c;if(!a)return null;var f=a.Fb;a=a.wt();let l;const u=jf.a.KS,I=jf.a.EZ;l=b?b.uBb(jf.a.KS,jf.a.EZ):this.Tb.Ama(jf.a.KS,jf.a.EZ);c=b?0:c*qr.a.tU;f=this.Vk.Cla(!0,f.cid,f.sid,0,l.x+c,l.y+c,u,I,a+1,!0);b&&(f.J4=b.id);return f}ykj(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return ya.a.J(508616851,
352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}Yjk(a){return a?RegExp(".*iframe.*").test(a):!1}Iig(a){if(!a)return"NA";let b=a.indexOf(".com/");if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(m.a)(KO,"InsertOnlineVideoDialogHelper",null,[1747]);var LO=d(1066);class el{constructor(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.PIb=this.UJa=0;if(!lc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!hd)throw Error.argumentNull("appFrame");if(!yd)throw Error.argumentNull("viewEventNotifier");this.ms=a;this.ia=b;this.Fa=c;this.oa=f;this.yP=0;this.sa=ja;this.ic=l;this.yb=u;this.RIa=I;this.Dr=Ra;this.x9g=T;this.Wf=ua;this.Rq=ja.presentation;this.Vk=eb;this.Lj=Bb;this.b0a=Ub;this.Ga=Xb;this.Ji=tc;this.TZa=lc;this.Mga=Ec;this.Db=hd;this.ue=yd;this.hZa=
Pd;this.boc=pe;this.Wf.HJ(Object(R.a)(this,this.o1a,"onSlideNavigation"));this.x9g.Ak(Object(R.a)(this,this.Nkb,"onPresentationPropertyChanged"));this.Db.QH(Object(R.a)(this,this.St,"onAppFrameModeSwitched"));this.ue.BSa(Object(R.a)(this,this.Mha,"onRibbonTabSwitched"));this.ue.sLf(Object(R.a)(this,this.Fmh,"onEscapeKeyPressed"));el.Hnd.push(M.a.x5c);el.Hnd.push(M.a.v5c);this.ZTf()}dispose(){this.x9g.tn(Object(R.a)(this,this.Nkb,"onPresentationPropertyChanged"));this.Wf.E7(Object(R.a)(this,this.o1a,
"onSlideNavigation"));this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"));this.ue.Nvc(Object(R.a)(this,this.Mha,"onRibbonTabSwitched"));this.ue.DAl(Object(R.a)(this,this.Fmh,"onEscapeKeyPressed"))}qb(){for(const a of el.O9l)this.ia.pa(a,ta.a.application,Object(R.a)(this,this.Esg,"handleInsertShape"),4);for(const a of el.Gnd)this.ia.pa(a,ta.a.application,Object(R.a)(this,this.Esg,"handleInsertShape"),4);this.ia.pa(M.a.q5c,ta.a.application,Object(R.a)(this,this.PWj,"handleInsertShapeAtSpecifiedLocation"),
4);this.ia.pa(M.a.A5c,ta.a.application,Object(R.a)(this,this.QWj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.pa(M.a.kQi,ta.a.application,Object(R.a)(this,this.Yrg,"handleCancelInsertShape"),4);this.ia.pa(M.a.cVf,ta.a.application,Object(R.a)(this,this.Yrg,"handleCancelInsertShape"),4);this.ia.pa(M.a.Sab,ta.a.application,Object(R.a)(this,this.EVj,"handleDuplicateShape"),4)}Sd(){this.Fa.Kc(xc.a.Ag).bindAction(B.KeyInputManager.Va(H.a.jPa,B.KeyInputManager.Ze),M.a.Sab);this.Fa.Kc(xc.a.wR).bindAction(B.KeyInputManager.Va(H.a.jPa,
B.KeyInputManager.Ze),M.a.Sab)}ZTf(){if(this.Rq){var a=Math.min(this.Rq.eTh,this.Rq.RSh);a=Math.max(a-50,0);this.UJa=Math.floor(a/(2*qr.a.tU))-1;this.UJa=Math.max(this.UJa,0);this.PIb=-1*this.UJa}else this.UJa=1,this.PIb=-1}Nkb(a,b){b.property!==yb.a.slideWidth&&b.property!==yb.a.slideHeight||this.ZTf()}o1a(){this.yP=0;this.Yia(0)}St(a){1===a.mode&&this.Yia(0)}Mha(){this.Yia(0)}Fmh(){this.Yia(0)}Yia(a){1===a&&this.Fa.Gd();this.TZa.Vef(a)}Esg(a,b,c,f,l){b=this.sa.Aa;if(!b)return 16;f=b.Fb;if(Vh.a.Cx(f)||
this.ic.Xc(b))return 16;if(1===c)return 32;c=this.Xbb(a);if(!c)return 8;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;const u=this.b0a.qI;var I=b.Ld.HasDefaultShape,T=b.Ld.HasDefaultLine,ja=95===c.Hia||97===c.Hia||Array.contains(kC.a.Oze,c.Hia);T=T&&ja;I=I&&!ja;ja=!1;l&&(Tn.a.Gv in l?l=l[Tn.a.Gv]:(ya.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),l=0),ja=!Array.contains(el.A0k,l));if(ja){if(a===M.a.oXa)return this.Yia(1),this.Mga.instance.iDb=-1,32;if(u&&!Array.contains(el.Hnd,
a)&&!I&&!T){this.Yia(2);if(null==this.Mga.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.Mga.instance.iDb=a;return 32}}this.Yia(0);let ua,Ra;var eb=this.Rq.slideWidth,Bb=this.Rq.slideHeight;ja=new pd.a((eb-c.width*Re.a.kE)/2,(Bb-c.height*Re.a.kE)/2);l=ja.x+Ad.a.Cf(this.yP*qr.a.tU,0);Ra=ja.y+Ad.a.Cf(this.yP*qr.a.tU,1);u?(ja=c.width*Re.a.kE,ua=c.height*Re.a.kE):(ja=Ad.a.Cf(el.G4b,0),ua=Ad.a.Cf(el.F4b,1),l=eb/2-Ad.a.Cf(el.G4b/2-this.yP*qr.a.tU,0),Ra=Bb/2-Ad.a.Cf(el.F4b/2-this.yP*
qr.a.tU,1));this.yP++;this.yP>this.UJa&&(this.yP=this.PIb);eb=b.wt();Bb=Object(gb.a)(227,this.sa.Aa.vg(this.yb.Na));$c.a.Kb&&(T||I)&&$c.a.Kb.Wa(Ii.a.Yce,T?"HasDefaultLine":"HasDefaultShape");!u||a===M.a.oXa||Array.contains(el.Hnd,a)||I||T?f=this.Vk.cFa(!1,f.cid,f.sid,0,c.shapeType,l,Ra,ja,ua,eb+1):(f=kC.a.bUc(f,c,Bb.cV,null,new LO.a,l,Ra,ja,ua,eb,this.Ga,this.Vk,this.yb,this.sa,this.Ji),$c.a.Kb&&($c.a.Kb.actionName=el.b3c));md.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===M.a.oXa&&(this.pKf(),
this.Ihb=f);f.isEditable=!Array.contains(el.Gnd,a);this.ms.NU([f],b,a);this.Dr.YA=f;this.kBc();return 32}pKf(){this.qJe||(this.boc.Nka(this.iJh.bind(this)),this.Wf.ASa(this.Uhh.bind(this)),this.qJe=!0)}Azl(){this.qJe&&(this.boc.wPb(this.iJh.bind(this)),this.Wf.xPb(this.Uhh.bind(this)),this.qJe=!1)}iJh(a,b){a=b.node;null!=a&&a==this.Ihb&&(this.Ihb=a,this.WZg=b.revisionId.toString())}Uhh(a,b){b.tE&&b.tE.Id&&this.WZg==b.tE.Id&&(null==this.Ihb||this.hZa.L5(this.Ihb)||setTimeout(()=>{this.ia.Ia(M.a.WSa,
2,new Ln.a(this.Ihb,!0,null));this.Azl();this.WZg=this.Ihb=null},0))}QWj(a,b,c,f,l){if(1===c)return 2;this.Yia(0);b=this.sa.Aa;if(!b)return 16;f=b.Fb;if(Vh.a.Cx(f)||this.ic.Xc(b))return 16;c=this.Xbb(a);if(!c)return 16;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;this.yP++;this.yP>this.UJa&&(this.yP=this.PIb);if(!md.a("IsAnyOffsetZeroForTextbox")){if(!(l&&l.left&&l.right&&l.bottom&&l.top))return ya.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return ya.a.J(512336011,829,10,"Invalid offsets"),
16;const u=this.sa.Aa.ey.gt;let I=Ad.a.Cf(this.Ji.wQ(l.right-l.left,u),0),T=Ad.a.Cf(this.Ji.wQ(l.bottom-l.top,u),1);T||I||(I=c.width*Re.a.kE,T=c.height*Re.a.kE);I=I?I:Ad.a.Cf(el.mNi,0);T=T?T:Ad.a.Cf(el.lNi,1);const ja=Ad.a.Cf(this.Ji.wQ(l.left,u),0);l=Ad.a.Cf(this.Ji.wQ(l.top,u),1);l=this.Vk.cFa(!1,f.cid,f.sid,0,c.shapeType,ja,l,I,T,b.wt()+1);if(!l)return ya.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;md.a("FixNarratorTextBoxBug")&&(l.setValue(yb.a.fM,c.Hia),
l.setValue(yb.a.Xu,!0));md.a("MoveCursorToTextboxAfterInsert")&&this.pKf();l.isEditable=!Array.contains(el.Gnd,a);this.Ihb=l;this.ms.NU([l],b,a);this.Dr.YA=l;this.kBc();ya.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");return 32}PWj(a,b,c,f,l){if(1===c)return ya.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.Yia(0);b=this.sa.Aa;if(!b)return ya.a.J(512349510,829,10,"slideNode is null"),16;c=b.Fb;if(Vh.a.Cx(c))return ya.a.J(512349509,829,10,"slideNode is fake"),
16;if(this.ic.Xc(b))return ya.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;f=this.Xbb(l.insertShapeActionId);if(!f)return ya.a.J(512349507,829,10,"autoShapeProps is null"),16;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;var u=l.offsets;if(!u)return ya.a.J(512349788,829,10,"Invalid offsets"),16;const I=this.sa.Aa.vg(this.yb.Na);let T=this.yb.Xd.Cf(u.right-u.left,0),ja=this.yb.Xd.Cf(u.bottom-u.top,1);ja||T||(T=f.width*Re.a.kE,ja=f.height*Re.a.kE);const ua=this.yb.Xd.Cf(u.left,0);u=this.yb.Xd.Cf(u.top,
1);f.height=ja/Re.a.kE;f.width=T/Re.a.kE;const Ra=b.wt();c=kC.a.bUc(c,f,I.cV,null,new LO.a,ua,u,T,ja,Ra,this.Ga,this.Vk,this.yb,this.sa,this.Ji);$c.a.Kb&&($c.a.Kb.actionName=el.b3c);if(!c)return ya.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(el.Gnd,a);l.insertLocalShape?b.ZB(c,null):(this.ms.NU([c],b,a),this.Mga.instance.iDb=-1,this.Dr.YA=c,this.kBc());l.node=c;ya.a.J(512349786,829,50,"Successfully inserted the shape at specified location");
return 32}Yrg(a,b,c){if(1===c)return 32;this.Yia(0);return 32}Xbb(a){switch(a){case M.a.oXa:return new ve.a(4,16,.5,3);case M.a.A5c:return new ve.a(4,16,.5,3);case M.a.kre:return new ve.a(34,9,1,1);case M.a.fte:return new ve.a(2,17,1,1.16);case M.a.Bse:return new ve.a(3,55,1,1);case M.a.kse:return new ve.a(6,56,1,1.33);case M.a.ete:return new ve.a(7,57,1.33,1);case M.a.Zqe:return new ve.a(5,58,1,1);case M.a.Hse:return new ve.a(9,59,1,1.05);case M.a.tre:return new ve.a(10,60,1,1.16);case M.a.sre:return new ve.a(11,
61,1,1);case M.a.gse:return new ve.a(12,62,1,1);case M.a.Vqe:return new ve.a(13,63,1,1);case M.a.cre:return new ve.a(14,64,1,1);case M.a.mse:return new ve.a(39,65,1,1);case M.a.Gqe:return new ve.a(87,66,1,1);case M.a.cte:return new ve.a(35,67,1,1);case M.a.pre:return new ve.a(83,68,1,1);case M.a.qre:return new ve.a(84,69,1,1);case M.a.wre:return new ve.a(85,70,1,1);case M.a.Yqe:return new ve.a(86,71,1,1);case M.a.Mqe:return new ve.a(130,72,1,1);case M.a.nse:return new ve.a(33,73,1,1);case M.a.Dqe:return new ve.a(73,
7,1.33,1);case M.a.Nqe:return new ve.a(72,8,1.33,1.33);case M.a.Bqe:return new ve.a(82,74,1.14,1.14);case M.a.dre:return new ve.a(41,75,1,1);case M.a.ese:return new ve.a(42,76,1,1);case M.a.Cqe:return new ve.a(40,77,1,1);case M.a.ore:return new ve.a(81,78,1,1);case M.a.Jse:return new ve.a(78,79,1,1);case M.a.rre:return new ve.a(75,18,1,1);case M.a.Fre:return new ve.a(74,80,1,1);case M.a.bte:return new ve.a(76,81,1,1);case M.a.cse:return new ve.a(77,82,1,.5);case M.a.Iqe:return new ve.a(120,83,1,1);
case M.a.yqe:return new ve.a(88,84,1,1);case M.a.fre:return new ve.a(93,85,1,1);case M.a.ere:return new ve.a(94,86,1,1.17);case M.a.Are:return new ve.a(89,87,1,.08);case M.a.Ase:return new ve.a(90,88,1,.08);case M.a.zre:return new ve.a(91,89,1,.17);case M.a.zse:return new ve.a(92,90,1,.17);case M.a.ase:return new ve.a(175,19,1,1);case M.a.Yre:return new ve.a(176,20,1,1);case M.a.Zre:return new ve.a(177,21,1,1);case M.a.Wre:return new ve.a(178,22,1,1);case M.a.Xre:return new ve.a(179,23,1,1);case M.a.$re:return new ve.a(180,
24,1,1);case M.a.x5c:return new ve.a(95,12,1,1);case M.a.y5c:return new ve.a(95,13,1,1);case M.a.z5c:return new ve.a(95,14,1,1);case M.a.v5c:return new ve.a(97,26,1,1);case M.a.u5c:return new ve.a(97,155,1,1);case M.a.w5c:return new ve.a(97,156,1,1);case M.a.s5c:return new ve.a(101,25,1,1);case M.a.r5c:return new ve.a(101,153,1,1);case M.a.t5c:return new ve.a(101,154,1,1);case M.a.hre:return new ve.a(46,0,1.07,.53);case M.a.xre:return new ve.a(44,1,.53,1.07);case M.a.Bre:return new ve.a(50,2,.53,
1.33);case M.a.xse:return new ve.a(43,3,.53,1.07);case M.a.hte:return new ve.a(45,4,1.07,.53);case M.a.jte:return new ve.a(51,5,1.33,.53);case M.a.Dre:return new ve.a(53,27,.93,1.33);case M.a.zqe:return new ve.a(62,28,.95,.89);case M.a.gte:return new ve.a(63,29,.96,.97);case M.a.Ere:return new ve.a(52,30,.93,.93);case M.a.Aqe:return new ve.a(49,31,.8,.93);case M.a.Rqe:return new ve.a(67,32,1.33,.8);case M.a.Qqe:return new ve.a(68,33,1.33,.8);case M.a.Sqe:return new ve.a(69,34,.8,1.33);case M.a.Oqe:return new ve.a(70,
46,.8,1.33);case M.a.$se:return new ve.a(47,35,.53,1.07);case M.a.fse:return new ve.a(48,36,.53,1.07);case M.a.lse:return new ve.a(36,37,.53,1.07);case M.a.Fqe:return new ve.a(37,38,.53,.53);case M.a.yse:return new ve.a(56,39,1,1);case M.a.ire:return new ve.a(58,40,1,1);case M.a.yre:return new ve.a(55,41,1,1);case M.a.ite:return new ve.a(57,42,1,1);case M.a.Cre:return new ve.a(59,43,.63,1.33);case M.a.tse:return new ve.a(61,44,1.33,1.33);case M.a.Hqe:return new ve.a(64,45,1.07,1.07);case M.a.sse:return new ve.a(54,
47,1.33,1.33);case M.a.vse:return new ve.a(4,10,1,1);case M.a.Fse:return new ve.a(25,11,1,1);case M.a.Cse:return new ve.a(28,48,1,1);case M.a.Dse:return new ve.a(27,49,1,1);case M.a.Ese:return new ve.a(26,50,1,1);case M.a.Lse:return new ve.a(29,51,1,1);case M.a.Kse:return new ve.a(32,52,1,1);case M.a.Mse:return new ve.a(31,53,1,1);case M.a.Nse:return new ve.a(30,54,1,1);case M.a.wse:return new ve.a(116,91,.67,1);case M.a.Gse:return new ve.a(117,6,.67,1);case M.a.jse:return new ve.a(118,92,.67,1);
case M.a.Jqe:return new ve.a(119,93,.67,1);case M.a.Gre:return new ve.a(104,94,.67,1);case M.a.Kre:return new ve.a(105,95,.67,1);case M.a.Ore:return new ve.a(106,96,.67,1);case M.a.Hre:return new ve.a(107,97,.67,1);case M.a.Lre:return new ve.a(108,98,.67,1);case M.a.Qre:return new ve.a(109,99,.67,1);case M.a.Ire:return new ve.a(110,100,.67,1);case M.a.Mre:return new ve.a(111,101,.67,1);case M.a.Rre:return new ve.a(112,102,.67,1);case M.a.Jre:return new ve.a(113,103,.67,1);case M.a.Nre:return new ve.a(114,
104,.67,1);case M.a.Sre:return new ve.a(115,105,.67,1);case M.a.lre:return new ve.a(79,106,1,1);case M.a.mre:return new ve.a(80,107,1,1);case M.a.Use:return new ve.a(15,108,1,1);case M.a.Vse:return new ve.a(16,15,1,1);case M.a.Wse:return new ve.a(17,109,1,1);case M.a.Xse:return new ve.a(18,110,1,1);case M.a.Yse:return new ve.a(19,111,1,1);case M.a.Pse:return new ve.a(20,112,1,1);case M.a.Qse:return new ve.a(21,113,1,1);case M.a.Rse:return new ve.a(22,114,1,1);case M.a.Sse:return new ve.a(23,115,1,
1);case M.a.Tse:return new ve.a(24,116,1,1);case M.a.kte:return new ve.a(122,117,.67,1.33);case M.a.jre:return new ve.a(121,118,.67,1.33);case M.a.Tqe:return new ve.a(124,119,.83,1.33);case M.a.Pqe:return new ve.a(123,120,.83,1.33);case M.a.lte:return new ve.a(126,121,1.25,1.13);case M.a.ure:return new ve.a(127,122,1.13,1.25);case M.a.mte:return new ve.a(128,123,1,1);case M.a.gre:return new ve.a(129,124,1,1);case M.a.qse:return new ve.a(131,125,.67,1);case M.a.xqe:return new ve.a(158,126,.67,1);case M.a.Wqe:return new ve.a(132,
127,.67,1);case M.a.Uqe:return new ve.a(133,128,.67,1);case M.a.ose:return new ve.a(134,129,.67,1);case M.a.vre:return new ve.a(135,130,.67,.67);case M.a.bre:return new ve.a(136,131,.67,1);case M.a.dse:return new ve.a(137,132,.83,1.16);case M.a.dte:return new ve.a(138,133,.33,1);case M.a.pse:return new ve.a(139,134,.67,1.16);case M.a.Ure:return new ve.a(140,135,.5,1);case M.a.Vre:return new ve.a(141,136,.67,1);case M.a.Lqe:return new ve.a(142,137,.5,.5);case M.a.hse:return new ve.a(159,138,.67,.67);
case M.a.Eqe:return new ve.a(143,139,.88,1);case M.a.rse:return new ve.a(144,140,.88,1);case M.a.ate:return new ve.a(145,141,.67,.67);case M.a.ise:return new ve.a(146,142,.67,.67);case M.a.Kqe:return new ve.a(147,143,1,.5);case M.a.Ose:return new ve.a(148,144,1,.5);case M.a.nre:return new ve.a(149,145,.75,.75);case M.a.bse:return new ve.a(150,146,.75,.75);case M.a.Zse:return new ve.a(152,147,.67,1);case M.a.Xqe:return new ve.a(157,148,.67,.67);case M.a.Ise:return new ve.a(153,149,.67,.67);case M.a.Tre:return new ve.a(154,
150,.67,1);case M.a.$qe:return new ve.a(155,151,.75,1);case M.a.are:return new ve.a(156,152,.67,1);default:return null}}EVj(a,b,c){b=this.oa.rf();if(!(b&&0<b.length&&qr.a.PLl(b)))return 16;if(1===c)return 32;c=this.sa.Aa;if(!c)return 16;if(!this.Lj.UD(c,b.length))return this.Lj.yE(c),16;if(this.ic.Xc(c))return 16;this.RIa.Eth(c,c,b,null,a);return 32}kBc(){try{const a=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){ya.a.J(512349783,
829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}el.G4b=110;el.F4b=75;el.mNi=4;el.lNi=4;el.b3c="InsertShape";el.O9l=[M.a.ase,M.a.Yre,M.a.Zre,M.a.Wre,M.a.Xre,M.a.$re,M.a.oXa,M.a.kre,M.a.fte,M.a.Bse,M.a.kse,M.a.ete,M.a.Zqe,M.a.Hse,M.a.tre,M.a.sre,M.a.gse,M.a.Vqe,M.a.cre,M.a.mse,M.a.Gqe,M.a.cte,M.a.pre,M.a.qre,M.a.wre,M.a.Yqe,M.a.Mqe,M.a.nse,M.a.Dqe,M.a.Nqe,M.a.Bqe,M.a.dre,M.a.ese,M.a.Cqe,M.a.ore,M.a.Jse,M.a.rre,M.a.Fre,M.a.bte,M.a.cse,M.a.Iqe,M.a.yqe,M.a.fre,M.a.ere,
M.a.Are,M.a.Ase,M.a.zre,M.a.zse,M.a.vse,M.a.Fse,M.a.Cse,M.a.Dse,M.a.Ese,M.a.Lse,M.a.Kse,M.a.Mse,M.a.Nse,M.a.wse,M.a.Gse,M.a.jse,M.a.Jqe,M.a.Gre,M.a.Kre,M.a.Ore,M.a.Hre,M.a.Lre,M.a.Qre,M.a.Jre,M.a.Nre,M.a.Sre,M.a.Ire,M.a.Mre,M.a.Rre,M.a.lre,M.a.mre,M.a.Use,M.a.Vse,M.a.Wse,M.a.Xse,M.a.Yse,M.a.Pse,M.a.Qse,M.a.Rse,M.a.Sse,M.a.Tse,M.a.kte,M.a.jre,M.a.Tqe,M.a.Pqe,M.a.lte,M.a.ure,M.a.mte,M.a.gre,M.a.qse,M.a.xqe,M.a.Wqe,M.a.Uqe,M.a.ose,M.a.vre,M.a.bre,M.a.dse,M.a.dte,M.a.pse,M.a.Ure,M.a.Vre,M.a.Lqe,M.a.hse,
M.a.Eqe,M.a.rse,M.a.ate,M.a.ise,M.a.Kqe,M.a.Ose,M.a.nre,M.a.bse,M.a.Zse,M.a.Xqe,M.a.Ise,M.a.Tre,M.a.$qe,M.a.are,M.a.xse,M.a.hre,M.a.xre,M.a.hte,M.a.jte,M.a.Bre,M.a.Dre,M.a.zqe,M.a.gte,M.a.Ere,M.a.Aqe,M.a.Rqe,M.a.Qqe,M.a.Oqe,M.a.Sqe,M.a.$se,M.a.fse,M.a.lse,M.a.Fqe,M.a.yse,M.a.ire,M.a.yre,M.a.ite,M.a.Cre,M.a.tse,M.a.Hqe,M.a.sse];el.Gnd=[M.a.x5c,M.a.y5c,M.a.z5c,M.a.s5c,M.a.r5c,M.a.t5c,M.a.v5c,M.a.u5c,M.a.w5c];el.Hnd=[M.a.y5c,M.a.z5c,M.a.s5c,M.a.r5c,M.a.t5c,M.a.u5c,M.a.w5c];el.A0k=[1,5];Object(m.a)(el,
"InsertShapeActor",null,[948,106]);class MO{constructor(a,b,c,f){this.rKe=null;this.A6k=(l,u)=>{this.rKe&&((l=Object(gb.a)(792,u.node))&&l.Tmb?this.rKe(l.Tmb):ya.a.J(508901219,803,10,"onJOfcCommandPayloadResponseReceived: Cannot resolve promise"))};this.UVj=(l,u,I,T,ja)=>{u=this.sa.presentation;if(1===I)return u?32:8;if(!u)return ya.a.J(508908367,803,10,"handleExecuteInternalBatchCommands with null IPageManifestNode."),16;if(!ja)return ya.a.J(508908366,803,10,"handleExecuteInternalBatchCommands with null action data."),
16;this.rKe=ja.promiseToResolve;I=this.Eb.ud(15,void 0,void 0,void 0,!0);try{I.mc(u),I.Wc=l,u.nZd(ja.requestBody)}catch(ua){return ya.a.J(508901218,803,10,"handleExecuteInternalBatchCommands: Exception: {0}.",ua.toString()),16}finally{I&&I.dispose()}return 32};this.ia=a;this.sa=b;this.Eb=c;this.iMk=f;this.iMk.Ak(this.A6k)}qb(){this.ia.pa(M.a.NFa,ta.a.application,this.UVj,4)}Sd(){}}Object(m.a)(MO,"JOfcCommandPayloadActor",null,[948]);class NO{constructor(){this.type="LivePollTaskPaneProps";this.formsUrl=
this.onCloseButtonClicked=null}}Object(m.a)(NO,"LivePollTaskPaneProps",null,[]);class OO{constructor(a,b,c,f,l,u,I,T){this.uN=null;this.zJa=this.Mb=!1;a("powerpoint-live-strings").then(()=>{this.zJa=!0;ya.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(ja=>{ya.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+ja.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");
if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!u)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!I)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!T)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.gJk=b;this.hJk=c;this.ia=f;this.sa=u;this.uf=l;this.oa=I;this.Lj=T;this.x1g=Object(R.a)(this,
this.c9l,"taskPaneMessageHandler")}qb(){this.ia.xa(M.a.DAd,wc.a.application,Object(R.a)(this,this.DAd,"showHideLivePollPane"))}Sd(){}DAd(a,b,c){return b.contextId===wc.a.application&&this.zJa?1===c?32:jh.a("LivePollPaneToggle",a,()=>{(this.Mb=!this.Mb)?(this.Jl(),ya.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.FO(),ya.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}Jl(){this.SA();const a=Object.assign(new jv.a,{title:ResourceStrings.L_LivePollTaskPane,
hideHeader:!1,width:320,location:2,contentProps:this.uN,onOpen:()=>{},onClose:()=>{this.Mb=!1},isModernPane:!0});Gj.UISurfaces.qr().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.x1g,!1);return null}).catch(b=>{ya.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}FO(){Gj.UISurfaces.qr().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.x1g);return null}).catch(a=>{ya.a.J(512500511,
833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}SA(){this.uN=Object.assign(new NO,{onCloseButtonClicked:Object(R.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.TBj()})}TBj(){return String.format("{0}{1}{2}",this.gJk,"&auth_upn=",A.AFrameworkApplication.fa.Ea("UserPrincipalName"))}onCloseButtonClicked(){this.FO()}c9l(a){if("data"in a){let b=Fe.d(a.data);({Ev:a}=b);b.returnValue&&a&&"type"in a&&"PollCreated"===a.type&&"payload"in a&&(a=a.payload,"formId"in
a&&(a=String.format("{0}{1}{2}{3}{4}",this.hJk,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",A.AFrameworkApplication.fa.Ea("UserPrincipalName")),this.OWj(a)))}}OWj(a){const b=this.sa.Aa;if(b&&!this.uf.Xc(b))if(this.Lj.UD(b,1)){var c=b.Fb;b.b5i(c.sid,c.cid,a,b.wt());b.U0(this.oa.Hd())}else this.Lj.yE(b)}}Object(m.a)(OO,"LivePollPaneActor",null,[948]);var dT=d(993);class Bz{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.nB=f;this.Jxa=l;this.ia=a;this.ic=b;this.Fa=c;this.GP=T;this.Yb=u;this.sa=I;this.Jc=
ja;this.Db=ua;this.sya=Ra;this.yb=eb}qb(){this.ia.xa(M.a.ONa,wc.a.application,Object(R.a)(this,this.ONa,"showHideNotes"));this.ia.pa(M.a.jtd,wc.a.application,Object(R.a)(this,this.Rnl,"queryNotesPaneState"),96);this.ia.pa(M.a.lsd,wc.a.application,Object(R.a)(this,this.qsh,"pageScrollNotesPane"),64);this.ia.pa(M.a.ksd,wc.a.application,Object(R.a)(this,this.qsh,"pageScrollNotesPane"),64);this.ia.xa(M.a.h8e,wc.a.application,Object(R.a)(this,this.K0k,"notesResize"))}Sd(){const a=this.Fa.Kc(yj.a.H4);a.bindAction(B.KeyInputManager.Va(H.a.gG,
0),M.a.lsd);a.bindAction(B.KeyInputManager.Va(H.a.fG,0),M.a.ksd)}ONa(a,b,c,f,l){if(this.yb&&0!==this.yb.$i)return 2;a=this.Yb.Of;if(!this.sa.Aa||!a||this.ic.iP(a))return 16;if(1===c)return 32;l&&Object(gc.a)(dT.a,l)?l.Byc?this.nB.gaf():this.nB.I2j():(this.nB.Q$k(),this.nB.K3b()&&this.Jxa.ep?this.Fa.qk(yj.a.H4,!0):this.Fa.qk(yj.a.H4,!1));this.GP.mdb();return 32}Rnl(a,b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return 8;l.Rf(this.nB.K3b());return 32}qsh(a,b,c){return 1===c?32:this.nB?(a===M.a.ksd?this.nB.va.scrollTop+=
Bz.ETf:a===M.a.lsd&&(this.nB.va.scrollTop-=Bz.ETf),32):8}K0k(a,b,c,f,l){ya.a.J(37524685,822,50,"Notes Resize Begin");if(!this.nB||!l||"number"!==typeof l)return ya.a.J(37524687,822,50,"Notes Resize Fail"),8;this.nB.Eha=l;this.Jc.Ic.ANh(1);this.Db.qv();this.sya.cnm();ya.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.nB.I0k?"On":"Off",this.nB.Eha);return 32}}Bz.ETf=80;Object(m.a)(Bz,"NotesActor",null,[948]);class PO{constructor(a,b,c,f){this.ia=a;this.qmc=b;this.ka=
c;this.k_g=0;this.ZP=f}Sd(){}qb(){this.ia.pa(M.a.wyh,Le.a.frame,Object(R.a)(this,this.Snl,"queryOfflineStatusHandler"),2144)}Snl(a,b,c,f,l){if(1===c)return 32;switch(this.qmc.status){case 0:1===this.k_g&&(l[xq.a.Value]=CommonUIStrings.L_Connected,l[bn.a.labelText]=CommonUIStrings.L_Connected,l[xq.a.Visible]=!0,this.hideIcon(),ln.a.instance.Jb(new ne.a(2,1,this.ka.offlineLabelTimeoutInMs,()=>{this.C0l();this.ZP.dT("GetOfflineStatus",!1);this.ZP.CB()},90,"108")));break;case 2:l[xq.a.Value]=CommonUIStrings.L_Disconnected;
l[bn.a.labelText]=CommonUIStrings.L_Disconnected;l[xq.a.Visible]=!0;break;case 1:l[xq.a.Value]=CommonUIStrings.L_Reconnecting,l[bn.a.labelText]=CommonUIStrings.L_Reconnecting,l[xq.a.Visible]=!0}this.k_g=this.qmc.status;return 32}hideIcon(){this.gMh(sj.a.hidden)}C0l(){this.gMh(sj.a.visible)}gMh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(m.a)(PO,"OfflineStatusLabelActor",null,[948]);class QO{constructor(a,b,c,f,l,u,I,T){this.rYg=!1;this.SDe=
null;this.ia=a;this.uf=b;this.GP=c;this.Fa=c.Bp;this.Eb=f;this.oa=l;this.Ga=u;this.Uq=I;this.X1=T}qb(){this.ia.pa(M.a.bringForward,wc.a.application,Object(R.a)(this,this.l3c,"handleOrganizeAction"),4);this.ia.pa(M.a.bringToFront,wc.a.application,Object(R.a)(this,this.l3c,"handleOrganizeAction"),4);this.ia.pa(M.a.sendBackward,wc.a.application,Object(R.a)(this,this.l3c,"handleOrganizeAction"),4);this.ia.pa(M.a.sendToBack,wc.a.application,Object(R.a)(this,this.l3c,"handleOrganizeAction"),4);this.ia.pa(M.a.zRf,
wc.a.application,Object(R.a)(this,this.vsg,"handleFrontBackFlyout"),4);this.ia.pa(M.a.MKh,wc.a.application,Object(R.a)(this,this.vsg,"handleFrontBackFlyout"),4);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&md.a("DelayRegisterArrangeShapesAction")?this.SDe=()=>{this.ia.pa(M.a.hwb,wc.a.application,Object(R.a)(this,this.Xsg,"handleOrganizeShapeAnchor"),4)}:this.ia.pa(M.a.hwb,wc.a.application,Object(R.a)(this,this.Xsg,"handleOrganizeShapeAnchor"),
4)}Sd(){const a=this.GP.Bp.Kc(xc.a.Ag);a.bindAction(B.KeyInputManager.Va(H.a.rCc,B.KeyInputManager.Ze),M.a.bringForward);a.bindAction(B.KeyInputManager.Va(H.a.rCc,B.KeyInputManager.Ze|4),M.a.bringToFront);a.bindAction(B.KeyInputManager.Va(H.a.pCc,B.KeyInputManager.Ze),M.a.sendBackward);a.bindAction(B.KeyInputManager.Va(H.a.pCc,B.KeyInputManager.Ze|4),M.a.sendToBack)}vsg(a,b,c){return 1===c?this.oa.H5()?32:8:32}Xsg(){const a=this.oa.rf();return this.Ga.PVa(a)&&!md.a("SelectSmartArtParent")?8:this.rYg?
32:this.oa.H5()?32:16}l3c(a,b,c){b=this.Uq.presentation;if(!b)throw Error.argumentNull("Presentation is null");let f=this.oa.rf();var l=this.Ga.PVa(f);if(l)if(md.a("SelectSmartArtParent"))this.oa.Ivd(l),f=this.oa.rf();else return 8;if(!this.oa.H5()||this.uf.xC(f))return 16;if(1===c)return 32;switch(a){case M.a.bringForward:c=1;break;case M.a.bringToFront:c=0;break;case M.a.sendBackward:c=3;break;case M.a.sendToBack:c=2;break;default:return 8}$c.a.Kb&&($c.a.Kb.gq=!1,$c.a.Kb.tk=!0);1===f.length?ya.a.J(508694553,
815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&ya.a.J(508694552,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",f.length);l=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{l.mc(f[0]);l.Wc=a;const u=Object(gb.a)(205,b.LD(f[0].slideId));this.wbl(u,f,c)}finally{l&&l.dispose()}return 32}TYk(a,b){const c=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{const f=this.Uq.Aa,l=f.KD(a),u=f.KD(b);c.mc(l);this.UYk(f,l.id,
u.id)}finally{c&&c.dispose()}}sTl(){this.rYg=!0;md.a("DelayRegisterArrangeShapesAction")&&this.SDe&&this.SDe()}wbl(a,b,c){a&&b&&0<b.length&&ya.a.J(508694551,815,50,"OrganizeShapes has invalid params");let f=rd.a.clone(a.$a(rb.a.mC));const l=[];let u=null;rd.a.MBa(b,I=>!I.Rg).length||(u=this.Ga.zt(b[0]))&&(f=rd.a.clone(u.$a(rb.a.mC)));for(const I of b)l.push(I.id);a.r9b(c,f,l)&&(u&&u.anchor?u.anchor.bpb(f,1,!1):a.anchor?a.anchor.bpb(f,1,!1):ya.a.J(508694550,815,50,"slideNode/groupNode should have valid anchor"))}vbl(a,
b,c){var f=this.oa.Hd(),l=this.vAj(f,b);a.reverse();b=new La.a;f=[];let u=-1,I=!1;for(let ja=0;ja<a.length;ja++){let ua=!1;for(var T of l)if(T.equals(a[ja])){b.add(T);ua=I=!0;break}ua||f.push(a[ja]);c.equals(a[ja])&&(u=ja)}if(I)if(-1===u)ya.a.J(508694548,815,10,"Invalid param endShapeId"),I=!1;else{c=0;T=a.length;for(l=0;c<u;)a[c++]=f[l++];for(const ja of b)a[c++]=ja;for(;c<T;)a[c++]=f[l++]}a.reverse();return I}vAj(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&(f=!0),c.push(l.id);f||(c=[],c.push(b));
return c}UYk(a,b,c){if(a){var f=rd.a.clone(a.$a(rb.a.mC));var l=this.X1.tfa(b);var u=this.X1.tfa(c);l=this.Ga.zt(l);u=this.Ga.zt(u);l?u===l&&(f=rd.a.clone(l.$a(rb.a.mC))):u&&(c=u.id);this.vbl(f,b,c)&&(ya.a.J(508694546,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.bpb(f,1,!1):ya.a.J(508694545,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.bpb(f,1,!1):ya.a.J(508694544,815,10,"slideNode should have valid anchor"))}else ya.a.J(508694547,815,10,"MoveShapeOnTopOfShape has invalid params")}}
Object(m.a)(QO,"OrganizeShapesActor",null,[948]);class RO extends Dt.a{constructor(a,b,c,f,l,u,I,T,ja){super();this.ikd=0;this.ff=f;this.Fc=T;this.HNg=ja;this.init(a);this.Fm("PPTClipboardActionOperation");(a=Object(gb.a)(10,I))||(a=new W.DictionaryPropertySet);a.setValue(wm.a.$b,ja);this.eHa(b,c,l,u,a)}I4c(){this.Hnb(this.ff)}V$a(a){this.Op=a;this.ikd=1}Lh(){if(0===this.ikd){if(1===this.hqa())return;this.ikd=1}1===this.ikd&&this.i_();this.Fc.cfk(this.HNg)&&this.Fc.Xg(!0,this.HNg)}}Object(m.a)(RO,
"PPTClipboardActionOperation",Dt.a,[1866,375,376]);var SO=d(376),AG=d(548);class nv{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg){this.gWj=(yg,ng,Wh,Ai,Wf)=>{if(1===Wh)return this.ia.Ia(G.a.fT,Wh,Wf);if(!Wf)return ya.a.J(508380426,820,10,"HandleFontHighlightColor: actionData is null"),16;yg=Yt.a.parse(Wf.Color);return yg?this.ia.Ia(G.a.fT,Wh,yg.UQf):(ya.a.J(508380425,820,10,"HandleFontHighlightColor: failed to parse colorinfo, colorInfo is null"),8)};
this.ia=a;this.oa=b;this.Fa=c;this.lB=f;this.Nhb=l;this.Eb=u;this.xTg=I;this.Ub=T;this.Yga=ja;this.dJb=ua;this.Ga=Ra;this.PIa=eb;this.mN=Bb;this.pfd=Ub;this.h_a=Xb;this.XGk=tc;this.slc=lc;this.Cc=Ec;this.wq=hd;this.Nt=yd;this.dS=Pd;this.Db=pe;this.Yb=Se;this.EP=vf;this.VZa=ug;this.PV=Tg;if(md.a("RulerIndentBugFix")){if(!$f)throw Error.argumentNull("paragraphIndentationReader");if(!Ve)throw Error.argumentNull("paragraphEditor");}this.Uaa=$f;this.Nxa=Ve;this.V_a=xg}qb(){this.ia.pa(M.a.LWe,wc.a.application,
Object(R.a)(this,this.qYj,"handlePopulateFontColorDropdown"),101);this.ia.pa(M.a.wsh,wc.a.application,Object(R.a)(this,this.sYj,"handlePopulateFontSizeDropdown"),100);this.ia.pa(M.a.tla,wc.a.application,Object(R.a)(this,this.aVj,"handleCommitShapeText"),4);this.ia.pa(M.a.Usd,wc.a.application,Object(R.a)(this,this.uyh,"queryListCommonLevel"),96);this.ia.pa(M.a.ktd,wc.a.application,Object(R.a)(this,this.uyh,"queryListCommonLevel"),96);this.ia.pa(M.a.wuc,wc.a.application,Object(R.a)(this,this.Pyh,"queryTextListMarkerGallery"),
96);this.ia.pa(M.a.xuc,wc.a.application,Object(R.a)(this,this.Pyh,"queryTextListMarkerGallery"),96);this.ia.pa(M.a.ntc,wc.a.application,Object(R.a)(this,this.ctg,"handlePopulateListMarkerDropdown"),100);this.ia.pa(M.a.otc,wc.a.application,Object(R.a)(this,this.ctg,"handlePopulateListMarkerDropdown"),100);this.ia.pa(M.a.Pze,ta.a.view,Object(R.a)(this,this.gXj,"handleLineSpacingMenuOpen"),68);this.ia.pa(M.a.Phh,wc.a.application,Object(R.a)(this,this.qXj,"handleMoreFontColors"),96);this.ia.pa(M.a.vNb,
wc.a.application,Object(R.a)(this,this.rXj,"handleMoreFontColorsResponse"),96);this.ia.pa(M.a.SLh,wc.a.application,this.gWj,4);this.ia.xa(M.a.$1a,ta.a.paragraph,Object(R.a)(this,this.$1a,"queryLineSpacing"));this.ia.xa(M.a.$1a,ta.a.view,this.Yga);this.ia.pe(M.a.$1a,96);this.ia.xa(M.a.Ypa,ta.a.paragraph,Object(R.a)(this,this.j_,"setLineSpacing"));this.ia.xa(M.a.Ypa,ta.a.view,this.Yga);this.ia.pe(M.a.Ypa,68);this.ia.xa(M.a.jMa,wc.a.application,Object(R.a)(this,this.jMa,"populateLineSpacingFlyout"));
this.ia.xa(M.a.vsh,wc.a.application,Object(R.a)(this,this.PXj,"handlePandoraEscapeKeyPressed"));this.ia.xa(M.a.C3a,ta.a.paragraph,Object(R.a)(this,this.YOf,"applySpacingToParagraph"));this.ia.xa(M.a.C3a,ta.a.view,this.Yga);this.ia.pe(M.a.C3a,4);this.ia.xa(M.a.B3a,ta.a.paragraph,Object(R.a)(this,this.YOf,"applySpacingToParagraph"));this.ia.xa(M.a.B3a,ta.a.view,this.Yga);this.ia.pe(M.a.B3a,4);this.ia.xa(M.a.Uma,ta.a.paragraph,Object(R.a)(this,this.awb,"applyIndentationToParagraph"));this.ia.xa(M.a.Uma,
ta.a.view,this.Yga);this.ia.pe(M.a.Uma,4);this.ia.xa(M.a.Xnb,ta.a.paragraph,Object(R.a)(this,this.awb,"applyIndentationToParagraph"));this.ia.xa(M.a.Xnb,ta.a.view,this.Yga);this.ia.pe(M.a.Xnb,4);this.ia.xa(M.a.Ynb,ta.a.paragraph,Object(R.a)(this,this.awb,"applyIndentationToParagraph"));this.ia.xa(M.a.Ynb,ta.a.view,this.Yga);this.ia.pe(M.a.Ynb,4);this.ia.xa(M.a.Znb,ta.a.paragraph,Object(R.a)(this,this.awb,"applyIndentationToParagraph"));this.ia.xa(M.a.Znb,ta.a.view,this.Yga);this.ia.pe(M.a.Znb,4);
this.V_a&&(this.ia.xa(M.a.tRb,ta.a.paragraph,Object(R.a)(this,this.awb,"applyIndentationToParagraph")),this.ia.xa(M.a.tRb,ta.a.view,this.Yga),this.ia.pe(M.a.tRb,4),this.ia.xa(M.a.uRb,ta.a.paragraph,Object(R.a)(this,this.awb,"applyIndentationToParagraph")),this.ia.xa(M.a.uRb,ta.a.view,this.Yga),this.ia.pe(M.a.uRb,4));this.ia.pa(M.a.ovh,wc.a.application,Object(R.a)(this,this.zYj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.pa(M.a.msd,wc.a.application,Object(R.a)(this,this.AYj,"handlePowerPointTextAnchoringAnchor"),
4);this.ia.xa(M.a.S2,ta.a.view,this.dJb);this.ia.xa(M.a.R2,ta.a.view,this.dJb);this.ia.xa(M.a.Q2,ta.a.view,this.dJb);this.ia.xa(M.a.S2,ta.a.outline,Object(R.a)(this,this.Zme,"handlePowerPointTextAnchoring"));this.ia.xa(M.a.R2,ta.a.outline,Object(R.a)(this,this.Zme,"handlePowerPointTextAnchoring"));this.ia.xa(M.a.Q2,ta.a.outline,Object(R.a)(this,this.Zme,"handlePowerPointTextAnchoring"));this.ia.pe(M.a.S2,4);this.ia.pe(M.a.R2,4);this.ia.pe(M.a.Q2,4);this.ia.xa(M.a.OOb,ta.a.view,this.dJb);this.ia.xa(M.a.OOb,
ta.a.outline,Object(R.a)(this,this.R0e,"queryTextAnchoring"));this.ia.pe(M.a.OOb,96);this.ia.xa(M.a.NOb,ta.a.view,this.dJb);this.ia.xa(M.a.NOb,ta.a.outline,Object(R.a)(this,this.R0e,"queryTextAnchoring"));this.ia.pe(M.a.NOb,96);this.ia.xa(M.a.MOb,ta.a.view,this.dJb);this.ia.xa(M.a.MOb,ta.a.outline,Object(R.a)(this,this.R0e,"queryTextAnchoring"));this.ia.pe(M.a.MOb,96);this.wq&&(this.ia.pa(G.a.$Yc,ta.a.view,Object(R.a)(this,this.iWj,"handleFormatPainterPick"),4),this.ia.pa(M.a.afe,ta.a.view,Object(R.a)(this,
this.aUj,"handleApplyFormatToText"),4),this.ia.pa(G.a.kma,ta.a.view,Object(R.a)(this,this.hWj,"handleFormatPainterCancel"),4),this.dS.zxi(()=>{this.EP.pYa=this.dS.JM;this.Db.Gf()}))}Sd(){var a=this.Fa.Kc(xc.a.wR);const b=this.Fa.Kc(yj.a.H4),c=this.Fa.Kc(xc.a.kT),f=B.KeyInputManager.Va(H.a.E_,0);a.bindAction(B.KeyInputManager.Va(H.a.QCc,0),M.a.tla);a.bindAction(f,M.a.vsh);c.bindAction(f,M.a.tla);b.bindAction(B.KeyInputManager.Va(H.a.YCc,2),N.a.Ce);a.bindAction(B.KeyInputManager.Va(H.a.YCc,2),N.a.Ce);
this.h_a&&(a.bindAction(B.KeyInputManager.Va(H.a.eja,5),M.a.lC),a.bindAction(B.KeyInputManager.Va(H.a.Rca,5),M.a.My));this.wq&&(a=this.Fa.Kc(yj.a.XE),a.Sy(f),a.bindAction(f,G.a.kma))}iWj(a,b,c){a=this.oa.Zn();b=!1;let f=null,l=this.oa.Oa.kb;const u=!!this.oa.Oa&&this.oa.Oa.qm;u&&(l=this.oa.Oa.ga(0));l&&(f=l.Ua);if(f){switch(f.contextId){case ta.a.textRange:case ta.a.paragraph:case ta.a.endOfParagraph:case ta.a.Xf:b=!0}b&&Bc.SelectionEditor.Tk(f)&&We.b(f)&&(b=!1);f.contextId===ta.a.outline&&a.vd&&
(b=!0);a&&!a.IVh&&(b=!1)}if(1===c||!b)return b?32:8;6!==this.ia.oq?(this.dS.JM?ya.a.J(508694658,820,50,"User deactivated the Format Painter button"):(ya.a.J(508694659,820,50,"User activated the Format Painter button"),this.ruh(l,u,a)),this.dS.JM=!this.dS.JM):(ya.a.J(508694657,820,50,"User picked format from keyboard shortcut"),this.ruh(l,u,a));return 32}ruh(a,b,c){this.dS.suh(a);var f=a.Ua,l=Object(gb.a)(Vg.AParagraphNode,f.node),u=Object(gb.a)(1482,this.Db.ie);let I=null;if(l&&u&&(I=u.qj)){u=this.Eb.xe(4);
const ja=I.ij;u.mc(I);var T=this.Ub.Pc(l);T.uc(8);const ua=this.Cc.Ft(T);let Ra=f.Ra,eb=f.Pb-f.Ra;a=!a.zea&&a.vf.contextId!==ta.a.endOfParagraph;b?(Ra=0,eb=$a.ParagraphReader.textLength(l)+1):({selectionStart:Ra,oKh:eb}=this.hUf(f,l,T,Ra,eb,null,!1),a&&f.contextId===ta.a.textRange&&eb++);b=this.PV.FGa(ja);f=null;ua&&(T.Ug(16),f=Object(gb.a)(650,T.currentNode));T.eD(8);T=Object(gb.a)(205,T.currentNode);l=l.ra(yb.a.MHa,!1);this.PV.Uhf(b,!0,l,T,c,f,null,Ra,eb);(c=ja.Wtc(b))&&I.KFb(c);u.dispose()}}hUf(a,
b,c,f,l,u,I){switch(a.contextId){case ta.a.Xf:l=null;I&&(l=this.VZa.bbc(a))?(l=l.Ua,f=l.Ra,l=l.Pb-l.Ra):(f=0<f?f-1:0,l=1);break;case ta.a.paragraph:f=0;l=$a.ParagraphReader.textLength(b)+1;break;case ta.a.endOfParagraph:f=$a.ParagraphReader.textLength(b),l=1}for(c.eD(11);c.Gva();)c.Gb(2),(a=Object(gb.a)(Vg.AParagraphNode,c.currentNode))&&(f+=$a.ParagraphReader.textLength(a)+1),c.eD(11);if(I)for(c=1;c<u.length;c++)if((I=Object(gb.a)(me.a,u.ga(c)))&&$a.ParagraphReader.ke(I.node))switch(I.contextId){case ta.a.textRange:l+=
I.Pb-I.Ra;break;case ta.a.Xf:l+=1;break;case ta.a.paragraph:l+=$a.ParagraphReader.textLength(I.node)+1;break;case ta.a.endOfParagraph:l+=1}return{selectionStart:f,oKh:l}}aUj(a){if(6===this.ia.oq||this.dS.JM){ya.a.J(508694656,820,50,"User applied the Format Painter from command location: {0}",this.ia.oq);const I=this.oa.Zn();if(I&&!nv.oqk(I))return 2;var b=this.oa.Oa.kb;if(b&&b.Ua){var c=b.Ua;const T=Object(gb.a)(Vg.AParagraphNode,c.node);var f=Object(gb.a)(1482,this.Db.ie),l=null;if(T&&f&&(l=f.qj)){f=
this.Eb.xe(15);f.mc(l);f.Wc=a;const ja=this.oa.Oa.qm;a=T.ra(yb.a.MHa,!1);if(ja)for(var u of this.oa.Oa)this.dS.MOf(u);else this.dS.MOf(b);$c.a.Kb&&($c.a.Kb.tk=!1,$c.a.Kb.actionName="FormatPainterApplyToText",$c.a.Kb.xG=new Date);const ua=this.Ub.Pc(T);ua.uc(8);u=c.Ra;let Ra=c.Pb-c.Ra;ja?u=Ra=-1:{selectionStart:u,oKh:Ra}=this.hUf(c,T,ua,u,Ra,b,!0);ua.Ug(8);b=Object(gb.a)(205,ua.currentNode);c=this.oa.yw();l=this.PV.FGa(l.ij);this.PV.Uhf(l,!1,a,b,I,null,c,u,Ra);6!==this.ia.oq&&(this.dS.JM=!1);f.dispose()}}}return 32}PXj(a,
b,c,f,l){this.wq&&this.ia.Ia(G.a.kma,c,l);md.a("PandoraEscapeKeyPressed")&&this.ia.Ia(M.a.tla,c,l);return 32}hWj(){this.EP.pYa&&(this.dS.JM=!1);return 32}zYj(){return this.C8f()}AYj(){return this.C8f()}Zme(a,b,c){let f=!1;b=this.xTg.iMj(b);var l=this.oa.$n();if(b&&b.eFb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case M.a.S2:c=0;break;case M.a.R2:c=1;break;case M.a.Q2:c=2;break;default:return 8}if(l)this.oa.nI()?this.Nt.TOl(l,c):(b=this.Eb.xe(15),b.mc(l),b.Wc=a,this.Nt.SOl(this.oa.Oa,c),
b.dispose());else{l=this.Eb.xe(15);try{l.mc(b),l.Wc=a,b.setValue(yb.a.AQ,c)}finally{l&&l.dispose()}}return 32}R0e(a,b,c,f,l){c=!1;b=this.xTg.Ljg(b);const u=this.oa.Oa;let I=0;f=this.oa.$n();if(b.Qa(yb.a.AQ)||f){switch(a){case M.a.OOb:c=f?(()=>{let T=this.Cc.YDd(u);({oza:I}=T);return T})().returnValue&&0===I:0===b.$a(yb.a.AQ);break;case M.a.NOb:c=f?(()=>{let T=this.Cc.YDd(u);({oza:I}=T);return T})().returnValue&&1===I:1===b.$a(yb.a.AQ);break;case M.a.MOb:c=f?(()=>{let T=this.Cc.YDd(u);({oza:I}=T);
return T})().returnValue&&2===I:2===b.$a(yb.a.AQ)}l.Rf(c);return 32}return 8}uyh(a,b,c,f,l){if(this.oa.Js())return l.Rf(!1),32;b=this.PIa.dC(this.oa.Ik);c=!0;for(const u of b)if((b=u.El?u.node:null)?(c=this.Ub.Pc(b),c.set(b),c.uc(11),c.Ug(11),c=(b=this.lB.Aw(c))?a===M.a.Usd?1===b.listType:a===M.a.ktd?0===b.listType:!1:!1):c=!1,!c)break;l.Rf(c);return 32}Pyh(a,b,c,f,l){b=l.e2a;l=l.menuItemId;if(this.oa.Js())return b.Rf(!1),32;f=this.PIa.dC(this.oa.Ik);c=!0;for(const I of f){if(f=I.El?I.node:null){var u=
this.Ub.Pc(f);u.set(f);u.uc(11);u.Ug(11);if(f=this.lB.Aw(u)){if(0===l){c=!1;break}a===M.a.wuc?(c=this.mN.FYa.ga(l).u4b,u=this.mN.FYa.ga(l).Kwb,c=f.rCb&&0<f.caa.length&&f.caa[0]===c&&f.udb&&f.font===u):a===M.a.xuc?(c=this.mN.Snd.ga(l).K1d,c=!!f.propertySet&&f.propertySet.Qa(yb.a.autonumberBulletType)&&f.propertySet.$a(yb.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Rf(c);return 32}sYj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}qXj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.renderColorPicker,1,l);A.AFrameworkApplication.Pa.Ia(G.a.hOb,2,l);a=new Vb.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=M.a.vNb;b.hideAlphaSlider=!0;return this.ia.Ia(M.a.renderColorPicker,2,b)}rXj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.Jr,c,l);if(!l)return ya.a.J(508694624,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=Yt.a.parse(l.Color))return a=this.ia.Ia(M.a.Jr,
c,"@"+a.RGBColor),32===a&&this.ia.Ia(M.a.WDa,c,l),a;ya.a.J(508694623,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}qYj(a,b,c,f,l){if(1===c)return 32;a=(a=this.oa.Pk())?a.Ld:null;b=M.a.Aza;var u=M.a.vNb;c=this.Yb.Of.wea;if(!l.MenuId||0>Aa.a.Dg(l.MenuId).indexOf("floatie")){f=b.toString();u=u.toString();b=Object.assign(new Rn.a,{Id:"menuFontColor",MenuSectionList:[]});const I=md.a("ColorPickerHighlighterFix")?AG.a.themeColors:"Colors";Array.add(b.MenuSectionList,
ql.e(a,I,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.slc));Array.add(b.MenuSectionList,ql.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,ql.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",u,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,ql.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(md.a("ColorPickerHighlighterFix")&&(c=new Vt,32===A.AFrameworkApplication.Pa.Ia(G.a.hOb,2,c)&&c))if(c.m$b)md.a("CurrentColorHighlighterfix")&&ql.h(b,null,a);else if(c=c.fontColor,-1===c)ql.h(b,null,a);else if(c=Jk.i(c)||"",c=Yt.a.parse(c))c=Ze.Box4ColorHelper.rma(c.mBa(),
a),ql.h(b,c,a);l.MenuItems=b}else a=this.XGk.rhg(a,!this.slc),l.PopulationXML=a.TLi(b,c,M.a.vNb);return 32}aVj(a,b,c){if(!this.oa.kz())return 16;if(1===c)return 32;a=this.oa.Hd();if(!a||1!==a.length)return 16;this.oa.selectShape(a[0],!0);this.Fa.Gd();return 32}gXj(){return 32}jMa(a,b,c,f,l){if(1===c)return 32;a=new Rn.a;a.MenuSectionList=[];b=Object.assign(new dl.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new aB.a,{Id:"buttonLineSpacing"+nv.Qze[c].replace(".","_"),LabelText:nv.Qze[c].substring(0,
3),ExternalId:"LineSpacingButton"+nv.Qze[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}ctg(a,b,c,f,l){if(1===c)return 32;a=a===M.a.ntc?1:a===M.a.otc?0:14;$c.a.Kb&&(1===a?$c.a.Kb.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&($c.a.Kb.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>Aa.a.Dg(l.MenuId).indexOf("floatie")?l.MenuItems=this.fXi(a):l.PopulationXML=this.gXi(a);return 32}$1a(a,b,c,f,l){var u=
l.MenuItemId;a=l.queryResult;c=l.LineSpacingValue;f=l.LineSpacingUnit;let I=!1;b=this.Nhb.dY(b.node);u=qf.a.cA(b.lineSpacing.value,u)&&2===b.lineSpacing.unit;if(-1===c)f=b.lineSpacing.unit,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.unit)c=f=0;0!==f&&(I=u);a.Rf(I);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}j_(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return ya.a.J(508694622,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Eb.xe(15);
b=b.node;c.mc(b);c.Wc=a;b.setValue(yb.a.EY,2);a=l;this.pfd&&(a+=this.Ga.Ufe(this.Ga.Gn(b)));b.setValue(yb.a.Ay,a);c.dispose();return 32}YOf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new SO.a(l.unit,l.value);l=c.unit;c=c.value;switch(a){case M.a.C3a:b.setValue(yb.a.gga,c);b.setValue(yb.a.Cna,l);break;case M.a.B3a:b.setValue(yb.a.fga,c),b.setValue(yb.a.Bna,l)}return 32}awb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new dr.a(l.unit,l.value)).hO;c=this.Uaa.o$(b).hO;f=this.Uaa.mWa(b);switch(a){case M.a.Uma:b.setValue(ib.a.Sm,
l);break;case M.a.Xnb:b.setValue(ib.a.Qn,l);break;case M.a.Ynb:b.setValue(ib.a.Qn,-l);break;case M.a.Znb:b.setValue(ib.a.Qn,0);break;case M.a.tRb:this.V_a&&b.setValue(ib.a.Qn,l-c);break;case M.a.uRb:this.V_a&&(this.Nxa.Cw.Knb(b,(1===f.specialIndentType?c+f.hO:c-f.hO)-l),this.Nxa.Cw.Kyd(b,1,l))}return 32}gXi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=M.a.eqa;l=M.a.CMa;break;case 0:c="NumberingLibrary_";f=M.a.nMa;l=M.a.Xlb;break;default:c="BulletsLibrary_",f=M.a.eqa,l=M.a.CMa}for(let u=0;8>u;++u)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+u,f,l,Aa.a.Fe(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.Cie(a,u),this.Bie(a,u))),this.blg(a,u),u));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}fXi(a){const b=Object.assign(new Rn.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.rKf(a));return b}rKf(a){var b="",c="";let f="",l=M.a.eqa,u=M.a.CMa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=M.a.eqa;u=M.a.CMa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=M.a.nMa,u=M.a.Xlb,c="NumberingLibrarySection"}b=Object.assign(new dl.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new gr.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.The(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let I=0;8>I;++I)c.GalleryItems.push(this.She(a,I,f+I,l.toString(),u.toString(),this.blg(a,I)));Array.add(b.ControlList,c);return b}The(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}She(a,b,c,f,l,u){a=
Object.assign(new xB,{LevelInfo:this.kEj(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=u;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}kEj(a,b){const c=[],f={};f.fontFamily=Ca.FontUtils.wla("Calibri");if(!b)return Object.assign(new Kl,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=Ca.FontUtils.wla(this.dlg(a,b));1===a?(a=this.mN.v$c.ga(b).zSf,c.push(Object.assign(new Kl,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Kl,{textAtLevel:a,styleAtLevel:f})),
c.push(Object.assign(new Kl,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.mN.v$c.ga(b).dkh,c.push(Object.assign(new Kl,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Kl,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Kl,{textAtLevel:a[2],styleAtLevel:f})));return c}blg(a,b){return 1===a?this.mN.PIg.ga(this.mN.Cbc(b)):0===a?this.mN.PIg.ga(this.mN.t2c(b)):""}Bie(a,b){return b?1===a?(a=this.mN.v$c.ga(b).zSf,this.tMa([a,a,a])):0===a?(a=this.mN.v$c.ga(b).dkh,this.tMa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}tMa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.BGa(a[0]),this.BGa(a[1]),this.BGa(a[2])):""}BGa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}Cie(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(Ca.FontUtils.wla(this.dlg(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}dlg(a,b){return 1===a?this.mN.FYa.ga(this.mN.Cbc(b)).Kwb:0===a?"Calibri":""}C8f(){let a=16;if(this.oa.P$())return 16;const b=this.oa.Zn(),c=this.oa.$n();if(b&&b.eFb||c)a=32;return a}static oqk(a){return!!a&&(a.HVh||a.vd)}}nv.Qze=["1.00","1.50","2.00","2.50","3.00"];Object(m.a)(nv,"PandoraActor",null,[948]);const TO=a=>{const b=new Sys.StringBuilder;
for(const c of a.keys)b.append(String.format('"{0}": "{1}"',c,a.ga(c)));return"{"+b.toString(",")+"}"};var eT=d(771);class Ms{constructor(a,b){this.eNd=this.N6a=null;this.$qc=c=>{this.N6a=c;this.OHe&&(this.eNd.instance=c);da.ULS.sendTraceTag(536987589,306,this.LR?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.LR))};this.Ca=a;this.yCa=b;if(this.OHe=A.AFrameworkApplication.fa.getBooleanAppSetting("HandleRaceConditionInHostManagerInit"))this.eNd=
eT.a.create();this.uO=Tb.a.instance.Ha("Common.ISystemInitiatedFeedback")}get LR(){return this.N6a}qb(){this.Ca.pa(N.a.close,Le.a.frame,Object(R.a)(this,this.closeDocument,"closeDocument"),2176);this.Ca.pa(N.a.D9b,Le.a.frame,Object(R.a)(this,this.D9b,"fileProperties"),128);this.Ca.xa(N.a.bfa,Le.a.frame,Object(R.a)(this,this.bfa,"fileSharing"));this.Ca.xa(N.a.v5d,Le.a.frame,Object(R.a)(this,this.v5d,"coEditInTeams"));this.Ca.pa(N.a.eyb,Le.a.frame,Object(R.a)(this,this.eyb,"copyAndEdit"),128);this.Ca.pa(N.a.FPb,
Le.a.frame,Object(R.a)(this,this.FPb,"replyWithChanges"),128);this.Ca.pa(N.a.Lyc,Le.a.frame,Object(R.a)(this,this.Kmj,"fileVersion"),128);this.Ca.xa(N.a.downloadACopy,Le.a.frame,Object(R.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.xa(N.a.bej,Le.a.frame,ff.ActionManager.uh);this.Ca.pa(N.a.h4e,Le.a.frame,Object(R.a)(this,this.h4e,"reportAbuseLink"),128);this.Ca.pa(N.a.$Ad,Le.a.frame,Object(R.a)(this,this.$yc,"signInInternal"),128);this.Ca.xa(N.a.workflow,Le.a.frame,Object(R.a)(this,this.workflow,
"workflow"));A.AFrameworkApplication.fa.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.pa(N.a.Tsd,Le.a.frame,Object(R.a)(this,this.Tsd,"queryBreadcrumbDocName"),96);this.Ca.pa(N.a.x_e,Le.a.frame,Object(R.a)(this,this.x_e,"queryCopyAndEditButton"),96);A.AFrameworkApplication.fa.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.pa(N.a.u_e,Le.a.frame,Object(R.a)(this,this.u_e,"queryBuildVersion"),2144),this.Ca.pa(N.a.j0e,Le.a.frame,Object(R.a)(this,this.j0e,
"querySessionId"),2144));this.Ca.xa(N.a.conversation,Le.a.frame,Object(R.a)(this,this.conversation,"conversation"));this.yCa.execute(this.$qc);da.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}closeDocument(a,b,c,f,l){a=2===c;c=hb.h;l&&(c=l);return b&&a&&!this.XPc(c)?8:this.jVi(a,c)}XPc(){return!0}jVi(a,b){if(A.AFrameworkApplication.za.mb.N9e("3033402446"))return da.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),
this.Lqa(a,le.a.Ebg,!0,{});if(A.AFrameworkApplication.awc&&b&&b===hb.f)return da.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),A.AFrameworkApplication.za.DN(a,A.AFrameworkApplication.awc);if(A.AFrameworkApplication.isEmbedded)return a&&da.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(A.AFrameworkApplication.XXf){if(!a)return 32;da.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");
try{return window.top.close(),32}catch(l){return da.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=A.AFrameworkApplication.bSc;if(!c)return a&&da.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=hb.h);if(b===hb.c||b===hb.h)return A.AFrameworkApplication.za.DN(a,c);let f;if(A.AFrameworkApplication.z2a)return a&&da.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),
f=b===hb.d||b===hb.b?this.Lqa(a,le.a.FPb,A.AFrameworkApplication.hCc,{["event_source"]:b}):2,32!==f?(c=b?oe.a.Xi(A.AFrameworkApplication.z2a,hb.e,b):A.AFrameworkApplication.z2a,A.AFrameworkApplication.za.DN(a,c)):f;a&&da.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===hb.b?this.Lqa(a,le.a.Ebg,A.AFrameworkApplication.nif,null):2;return 32!==f?A.AFrameworkApplication.za.DN(a,c):f}$yc(a,b,c,f,l){a=this.Lqa(2===c,le.a.$Ad,!0,l);8===a&&(window.top.location=
A.AFrameworkApplication.signInUrl,a=32);return a}D9b(a,b,c){a=this.Lqa(2===c,le.a.D9b,A.AFrameworkApplication.o4h,null);return 32!==a?A.AFrameworkApplication.za.DN(2===c,A.AFrameworkApplication.Kbg):a}bfa(a,b,c,f,l){if(1===c)return zB.SessionStatusManager.instance.Oma?8:32;a=N.a.rWl;b=kh.a.create().toString();f={};f.event_source=l;f[ok.a.lyc]=b;var u=l?l.nav:null;u&&(f[ok.a.uWl]=u);(u=l?l.scenarioId:null)&&(f[ok.a.vWl]=u);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=N.a.qWl);l&&"ManageAccess"===
l.SourceControlId&&(l.mode="manageAccess",a=N.a.sWl);l&&"ShareTopBar"===l.SourceControlId&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1)&&Ms.Ds.raiseEvent(Ms.JRi);(u=l?l.mode:null)&&(f[ok.a.tWl]=u);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",!1)){var I=l?l.additionalData:null;I&&(f[ok.a.FBi]=I)}2===c&&(I={},I[ok.a.lyc]=b,u&&(I.mode=u),da.ULS.sendTraceTag(38278995,306,50,Fe.c(I)));
b=this.Lqa(2===c,le.a.FWl,A.AFrameworkApplication.pif,f);if(32!==b){if(A.AFrameworkApplication.E9b)return l=l?oe.a.Xi(A.AFrameworkApplication.E9b,hb.e,l):A.AFrameworkApplication.E9b,A.AFrameworkApplication.za.DN(2===c,l,!0);da.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}c=Yi.a.YX("PPTIsSimplifiedRibbonOn",!1);da.ULS.sendTraceTag(509441175,306,15,"ActionName=FileSharing;SimplifiedRibbonMode={0}",c);hp.c(a);this.uO&&
this.uO.execute(T=>{T.logActivity("WordWebOnlineShareActivity",null)});return b}v5d(a,b,c){da.ULS.sendTraceTag(509613976,230,50,"Attempting to Launch the currently active document in the browser tab in a Word Live Teams Meeting");try{var f=kh.a.create().toString(),l=Ms.cpm,u=A.AFrameworkApplication.fa.Ea("LiveInTeamsWordAppSharingUrl");const Xb=new Dm.QueryStringBuilder("https://teams.microsoft.com/l/meeting-share");Xb.zg("deeplinkId",f);Xb.zg("lm","deeplink");a=Xb;var I=a.zg;const tc=new Cc.a;var T=
tc.$;const lc=new Dm.QueryStringBuilder(u);lc.zg("auth","2");lc.zg("flight","officeunihost");lc.zg("source","TEAMS-ELECTRON.meetingStage.deeplink");const Ec=new Cc.a;Ec.$("fileType",Aa.a.AR(A.AFrameworkApplication.fileName).substring(1,A.AFrameworkApplication.fileName.length));Ec.$("objectUrl",A.AFrameworkApplication.fa.Ea("EditDocInClientUrl"));Ec.$("baseUrl",A.AFrameworkApplication.Qu.breadcrumbBrandUrl);u=Ec;var ja=u.$;{let yd=A.AFrameworkApplication.fa.Ea("RootFileId"),Pd=decodeURIComponent(yd);
for(;yd!==Pd;)yd=Pd,Pd=decodeURIComponent(yd);if(32>yd.length){da.ULS.sendTraceTag(509440723,230,15,"Decoded fileId does not match expected format. Decoded id: ${fullyDecodedId}");var ua=""}else{var Ra=yd.substring(yd.length-32,yd.length),eb=Ra.substring(0,8)+"-"+Ra.substring(8,12)+"-"+Ra.substring(12,16)+"-"+Ra.substring(16,20)+"-"+Ra.substring(20,32);RegExp("^(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}$").test(eb)?ua=eb:(da.ULS.sendTraceTag(509203084,
230,15,"Unable to parse the fileId from the WOPISrc ParsedFileId: ${fileIdGuid}"),ua="")}}ja.call(u,"fileId",ua);const hd=Fe.c(TO(Ec));lc.zg("subEntityId",hd.substring(1,hd.length-1));T.call(tc,"appSharingUrl",lc.toString());tc.$("appId",l);var Bb=TO(tc);I.call(a,"appContext",Bb);var Ub=Xb.toString();da.ULS.sendTraceTag(509138050,230,50,"Launched the currently active document in the browser tab in a Word Live Teams Meeting");return A.AFrameworkApplication.za.DN(2===c,Ub)}catch(Xb){return da.ULS.sendTraceTag(509138049,
230,10,"Failed to launch the currently active document in a Word Live Teams Meeting {0}",Xb),8}}conversation(a,b,c){return this.Lqa(2===c,le.a.conversation,!0,{})}workflow(a,b,c){a=this.Lqa(2===c,le.a.workflow,A.AFrameworkApplication.xif,{["WorkflowType"]:A.AFrameworkApplication.ECc});if(32!==a){if(A.AFrameworkApplication.uGd)return A.AFrameworkApplication.za.DN(2===c,A.AFrameworkApplication.uGd,!0);da.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}h4e(a,
b,c){a=2===c;return b&&a&&!this.XPc(hb.f)?8:A.AFrameworkApplication.za.DN(a,A.AFrameworkApplication.awc)}eyb(a,b,c){a={};2===c&&(a=A.AFrameworkApplication.za.mb.Nhg());a=this.Lqa(2===c,le.a.eyb,A.AFrameworkApplication.n4h,a);return 32!==a?A.AFrameworkApplication.za.DN(2===c,A.AFrameworkApplication.c7d,A.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?A.AFrameworkApplication.Tw||A.AFrameworkApplication.TR||zB.SessionStatusManager.instance.Oma?8:32:A.AFrameworkApplication.za.DN(2===
c,A.AFrameworkApplication.xUa,!0)}FPb(a,b,c){a=2===c;if(b&&a&&!this.XPc(hb.d))return 8;b=this.Lqa(a,le.a.FPb,A.AFrameworkApplication.hCc,{["event_source"]:hb.d});return 32!==b?(b=oe.a.Xi(A.AFrameworkApplication.z2a,hb.e,hb.d),A.AFrameworkApplication.za.DN(a,b)):b}Kmj(a,b,c){a=this.Lqa(2===c,le.a.Lmj,A.AFrameworkApplication.qif,null);return 32!==a?A.AFrameworkApplication.za.DN(2===c,A.AFrameworkApplication.tde):a}Tsd(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=Aa.a.dI(A.AFrameworkApplication.Qu.iy)}return 32}u_e(a,
b,c,f,l){if(2===c){if(!l)return 8;l.Text=A.AFrameworkApplication.instance.nbj}return 32}j0e(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=A.AFrameworkApplication.instance.obj}return 32}Lqa(a,b,c,f){return this.OHe?this.VMl(a,b,c,f):c?a?this.LR.sendMessage(b,f)?32:8:32:2}VMl(a,b,c,f){return c?a?this.LR?this.LR.sendMessage(b,f)?32:8:(da.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),this.eNd.execute(()=>{da.ULS.sendTraceTag(528234242,
306,50,"HostPostmessenger now available. Executing the request.");this.LR.sendMessage(b,f)}),32):32:2}x_e(a,b,c,f,l){if(2===c){if(!l)return 8;A.AFrameworkApplication.fa.getBooleanAppSetting("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}Ms.Ds=new uc.a;Ms.JRi="CheckEditorSuggestions";Ms.cpm="d7958adf-f419-46fa-941b-1b946497ef84";Object(m.a)(Ms,"WebAppFrameCommandUIActor",null,[]);class UO extends Ms{constructor(a,b,c,f,l,u,I){super(a,b);this.Kx=c;this.JI=f;this.oa=l;
this.Ba=u;this.Xa=I}qb(){super.qb();this.Ba.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.xa(M.a.Cvh,Le.a.frame,Object(R.a)(this,this.OYe,"pptoShowFileVersion"))}OYe(a,b,c){return 1===c&&this.Xa.Vfa?2:this.Ca.nb(N.a.Lyc,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.oa.Bh();this.Kx.Faf(!0,ResourceStrings.l_Loading,a);ya.a.J(20187205,801,50,"PPT save and launch workflow");this.JI.b$(!1,!0,()=>{this.sPi(l)},Object(R.a)(this,this.hAa,"saveFailureCallback"));return 32}XPc(a){return a!==
hb.a||A.AFrameworkApplication.isEmbedded||A.AFrameworkApplication.XXf||A.AFrameworkApplication.bSc||this.rmk()?!0:(ya.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.Ia(M.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}rmk(){var a=A.AFrameworkApplication.fa.Ea(A.AFrameworkApplication.uL);a=A.AFrameworkApplication.ofb&&!!a&&"teams"===a.toLowerCase();return md.a("ReactDialogsProtocolLaunchingTeamsFix")&&
this.Ba.ibe&&a&&A.AFrameworkApplication.za.mb.N9e("3033402446")}sPi(a){this.Kx.hide();super.workflow(0,null,2,null,a)}hAa(){this.Kx.hide();return!1}}Object(m.a)(UO,"PptWebAppFrameCommandUIActor",Ms,[]);class VO{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.Wb=c}qb(){this.ia.pa(M.a.Evd,wc.a.application,Object(R.a)(this,this.Evd,"replaceFonts"),4)}Sd(){const a=
[this.Fa.Kc(yj.a.XE),this.Fa.Kc(yj.a.H4),this.Fa.Kc(xc.a.Ag),this.Fa.Kc(xc.a.wR)];for(const b of a)b.bindAction(B.KeyInputManager.Va(H.a.nVb,B.KeyInputManager.Ze),M.a.Evd)}Evd(a,b,c){return b.contextId!==wc.a.application?2:1===c?this.Wb.Hi()?32:8:32}}Object(m.a)(VO,"ReplaceFontsActor",null,[]);class WO extends Sys.EventArgs{constructor(a,b,c){super();this.ykh=a;this.zha=b;this.Gv=c}}Object(m.a)(WO,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class XO{constructor(a,b,c,f,l,u,I,T){if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");if(!I)throw Error.argumentNull("ribbonExternal");this.Fa=f;this.ia=a;this.GP=b;this.nv=c;this.yOg=l;this.ue=u;this.TFk=T}qb(){this.ia.xa(N.a.u5e,Le.a.frame,Object(R.a)(this,this.$8k,"onRibbonFocus"));this.ia.pa(N.a.VHl,Le.a.frame,Object(R.a)(this,this.PZj,"handleRibbonStateChanged"),64);this.ia.xa(N.a.uDd,wc.a.application,Object(R.a)(this,this.uDd,"toggleRibbonState"));
this.ia.xa(N.a.xHh,ta.a.view,Object(R.a)(this,this.QZj,"handleRibbonTabSwitched"));this.ia.xa(N.a.xwd,ta.a.view,Object(R.a)(this,this.xwd,"ribbonModeToggledToMLR"));this.ia.xa(N.a.ywd,ta.a.view,Object(R.a)(this,this.ywd,"ribbonModeToggledToSLR"));Cd.a.get_instance().Ij(7,Object(R.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}Sd(){const a=F.FocusManager.instance().Kc(yj.a.TSf);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.RCc,B.KeyInputManager.Ze),N.a.uDd);K.AFrame.Yk(a,B.KeyInputManager.Va(E.a.Fl?
H.a.Pca:H.a.PFd,1),N.a.u5e);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.ZOa,E.a.Fl?2:1),N.a.u5e);this.TFk&&(this.GP.tfb.Oud(la.a.rm,window.document,Object(R.a)(this,this.I6j,"ignoreAltKeyUpOnDocument")),iG.a.instance().a_d(Object(R.a)(this,this.D7k,"onOnlyAltKeyPressed")))}xwd(a,b,c){try{if(1===c)return 32;md.a("ReactMLRReuseSLRCookieForMLR")?this.oNh(!1):this.Fxc(!0);ya.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.GP.mdb()}catch(f){ya.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",
f)}return 32}ywd(a,b,c){try{if(1===c)return 32;md.a("ReactMLRReuseSLRCookieForMLR")||this.Fxc(!1);this.oNh(!0);ya.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.GP.mdb()}catch(f){ya.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}oNh(a){Yi.a.lL(A.AFrameworkApplication.fa.Ea("IsSimplifiedRibbonOnCookieName"),a.toString(),Yi.a.VK)}Fxc(a){Yi.a.lL(A.AFrameworkApplication.fa.Ea("ReactRibbonMLRPreferenceCookieName"),a.toString(),Yi.a.VK)}PZj(a,
b,c){if(1===c)return 32;this.GP.mdb();return 32}uDd(){return 32}QZj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[Tn.a.Gv]&&(a=l[Tn.a.Gv]),this.ue.Rql(new WO(l.OldContextId,l.NewContextId,a)));this.Fa.Je&&2===l[Tn.a.Gv]&&this.Fa.Je.name===xc.a.aca&&(b=b.view)&&!Aa.a.Ta(b.WJ)&&this.Fa.Df(b.WJ);return 32}D7k(){vE.a.instance.keyCode===H.a.XOa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.ptg())}I6j(a){return a.hc.keyCode===
H.a.XOa}ptg(){if(document.activeElement&&document.activeElement.id!==jf.a.K5b)return this.Fa.HYh(!this.yOg.inKeytipMode,!1),32;this.Fa.Je&&this.Fa.HYh(this.Fa.Je.name===xc.a.aca||this.yOg.inKeytipMode,!0);return 32}$8k(a,b,c){return 1===c?32:this.ptg()}registerOnShyRibbonStateChange(){A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.Xp&&fh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)ya.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),
this.GP.mdb()})}}Object(m.a)(XO,"RibbonStateActor",null,[948]);class mC{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(m.a)(mC,"SelectSectionAndSlidesData",null,[]);class YO{constructor(a,b,c,f,l,u,I,T,ja,ua){this.Z_a=null;if(ja){if(!u)throw Error.argumentNull("SectionActor.workspace");if(!I)throw Error.argumentNull("SectionActor.presentationReader");if(!T)throw Error.argumentNull("SectionActor.selectionManager");}this.ia=a;this.fB=b;this.sa=c;this.fnc=f;this.ks=l;this.Yb=u;this.Wb=
I;this.oa=T;this.tZ=ja;this.ho=ua;this.fnc.VE(Object(R.a)(this,this.ZC,"onChildTopologyChanged"));this.sa.presentation&&(this.Z_a=this.sa.presentation.Yq)}qb(){this.ia.pa(M.a.$2e,ta.a.application,Object(R.a)(this,this.yZj,"handleRemoveSection"),4);this.ia.pa(M.a.Vmd,ta.a.application,Object(R.a)(this,this.wXj,"handleMoveSectionUp"),4);this.ia.pa(M.a.Umd,ta.a.application,Object(R.a)(this,this.vXj,"handleMoveSectionDown"),4);this.ia.pa(M.a.Whf,ta.a.application,Object(R.a)(this,this.k0j,"handleUpdateSectionTitle"),
4);this.ia.pa(M.a.z9a,ta.a.application,Object(R.a)(this,this.ITj,"handleAddSection"),4)}Sd(){}k0j(a,b,c,f,l){if(1===c)return(a=this.sa.presentation)&&a.Yq&&a.Yq.length?32:8;if(!l)return ya.a.J(509368192,822,10,"HandleUpdateSectionTitle with null action data."),8;this.fB.Gjj(l);return 32}yZj(a,b,c){b=this.sa.Ou;const f=this.sa.x4;if(1===c){const l=this.sa.presentation;if(!l||!l.Yq||!l.Yq.length)return 8;if(!b&&1<l.Yq.length)return f&&!f.YF.length?32:8}if(2===c){ya.a.J(509368163,822,50,"HandleRemoveSection called.");
try{f&&this.fB.yjj(b,a),this.Z_a=this.sa.presentation.Yq,this.ia.Ia(M.a.Gxd,2,new mC(this.sa.Ou,this.sa.Aa.slideIndex))}catch(l){ya.a.J(509368162,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}wXj(a,b,c){a=this.sa.Ou;if(1===c)return c=this.sa.presentation,!c||!c.Yq||!c.Yq.length||0>=a?8:32;if(2===c){ya.a.J(509368161,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.fB.E$f(a,!0),this.ia.Ia(M.a.Gxd,2,new mC(this.sa.Ou,this.sa.Aa.slideIndex)))}catch(f){ya.a.J(509368160,
822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}vXj(a,b,c){a=this.sa.Ou;if(1===c)return(c=this.sa.presentation)&&c.Yq&&c.Yq.length&&a!==c.Yq.length-1&&-1!==a?32:8;if(2===c){ya.a.J(509368159,822,50,"HandleMoveSectionDown called.");try{-1!==a&&(this.fB.E$f(a,!1),this.ia.Ia(M.a.Gxd,2,new mC(this.sa.Ou,this.sa.Aa.slideIndex)))}catch(f){ya.a.J(509368158,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",f)}}return 32}ITj(a,b,c){var f;if(1===c)return 0!=(null===
(f=this.sa.presentation)||void 0===f?void 0:f.slideCount)&&this.SLl()?32:8;if(2===c){b=-1;c=this.sa.Ou;ya.a.J(509368157,822,50,"HandleAddSection called.");try{let l;l=this.tZ&&0<=this.Yb.yza?this.Wb.oy(this.Yb.yza+1):this.sa.Aa;this.fB.Zij(l,a);b=this.sa.Ou;if(this.tZ&&(-1!==this.Yb.yza&&(this.Yb.yza=-1,this.Yb.Aa=l),this.ho)){const u=this.Wb.gGa(b).map(T=>this.Wb.oy(T));let I;(I=this.oa).sQ.apply(I,u)}}catch(l){ya.a.J(509368156,822,10,"SectionActor: Exception in HandleAddSection: {0}.",l)}-1!==b&&
b!==c&&this.ia.nb(M.a.Fff,2)}return 32}SLl(){if(!md.a("AddSectionOptionCheck"))return!0;const a=this.oa.cuj();var b=this.oa.Xe().map(c=>c.slideIndex);if(2>b.length)return!0;b=b.slice().sort((c,f)=>c-f);if(b[b.length-1]-b[0]!==b.length-1)return!1;b=this.Wb.FR(a[0]);for(const c of a)if(this.Wb.FR(c)!=b)return!1;return!0}ZC(a,b){try{if(34===b.vU&&!b.node.isDirty){const c=this.Z_a?Array.clone(this.Z_a):null;this.Z_a=Array.clone(this.sa.presentation.Yq);if(!c&&this.Z_a||c.length<this.Z_a.length)2===this.Z_a.length&&
-1===this.sa.Ou&&(this.sa.Ou=1),this.ks?this.ks.m1e():ya.a.J(509368155,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.nb(M.a.Fff,2)}}catch(c){ya.a.J(509368154,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.fnc.RN(Object(R.a)(this,this.ZC,"onChildTopologyChanged"))}}Object(m.a)(YO,"SectionActor",null,[948]);var ZO=d(642);class $O{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){if(!Ec)throw Error.argumentNull("viewEventNotifier");
this.ia=a;this.uf=b;this.Fa=c;this.kS=f;this.Yb=l;this.sa=u;this.gb=I;this.dE=T;this.Tb=ja;this.ZYa=ua;this.De=Ra;this.ho=eb;this.UK=Bb;this.Ga=Ub;this.Ix=Xb;this.xba=tc;this.uxa=lc;this.ue=Ec;this.UKk=hd}qb(){this.ia.xa(M.a.YCd,wc.a.application,Object(R.a)(this,this.rQb,"selectNextSlideHandler"));this.ia.xa(M.a.ZCd,wc.a.application,Object(R.a)(this,this.rQb,"selectNextSlideHandler"));this.ia.xa(M.a.C4a,wc.a.application,Object(R.a)(this,this.rQb,"selectNextSlideHandler"));this.ia.xa(M.a.B4a,wc.a.application,
Object(R.a)(this,this.rQb,"selectNextSlideHandler"));this.ia.xa(M.a.ypb,wc.a.application,Object(R.a)(this,this.rQb,"selectNextSlideHandler"));this.ia.xa(M.a.xpb,wc.a.application,Object(R.a)(this,this.rQb,"selectNextSlideHandler"));this.ho&&(this.ia.xa(M.a.HAc,wc.a.application,Object(R.a)(this,this.hCb,"handleKeyboardMultiSelectSlides")),this.ia.xa(M.a.BAc,wc.a.application,Object(R.a)(this,this.hCb,"handleKeyboardMultiSelectSlides")),this.ia.xa(M.a.DAc,wc.a.application,Object(R.a)(this,this.hCb,"handleKeyboardMultiSelectSlides")),
this.ia.xa(M.a.CAc,wc.a.application,Object(R.a)(this,this.hCb,"handleKeyboardMultiSelectSlides")),this.ia.xa(M.a.GAc,wc.a.application,Object(R.a)(this,this.hCb,"handleKeyboardMultiSelectSlides")),this.ia.xa(M.a.FAc,wc.a.application,Object(R.a)(this,this.hCb,"handleKeyboardMultiSelectSlides")),this.ia.xa(M.a.nxd,wc.a.application,Object(R.a)(this,this.vLl,"selectAllSlidesHandler")),this.ia.xa(M.a.V2a,wc.a.application,Object(R.a)(this,this.SZj,"handleScrollSelectedThumbnailsIntoView")));this.ia.xa(M.a.lnb,
wc.a.application,Object(R.a)(this,this.RZj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.xa(M.a.X3a,wc.a.application,Object(R.a)(this,this.cKh,"selectNextShapeHandler"));this.ia.xa(M.a.pSb,wc.a.application,Object(R.a)(this,this.cKh,"selectNextShapeHandler"));this.ia.xa(M.a.fUb,wc.a.application,Object(R.a)(this,this.tgm,"unselectShapesHandler"));this.ia.xa(M.a.Xwc,wc.a.application,Object(R.a)(this,this.uLl,"selectAllShapesHandler"));this.ia.xa(M.a.KOh,wc.a.application,Object(R.a)(this,this.YVl,
"shapeEscapeKeyPressedHandler"));this.ia.xa(M.a.Dob,wc.a.application,Object(R.a)(this,this.t3c,"handleSlideScopeArrowKeyboard"));this.ia.xa(M.a.Eob,wc.a.application,Object(R.a)(this,this.t3c,"handleSlideScopeArrowKeyboard"));this.ia.xa(M.a.Fob,wc.a.application,Object(R.a)(this,this.t3c,"handleSlideScopeArrowKeyboard"));this.ia.xa(M.a.Gob,wc.a.application,Object(R.a)(this,this.t3c,"handleSlideScopeArrowKeyboard"));this.ia.xa(M.a.HTh,wc.a.application,Object(R.a)(this,this.C_j,"handleSpaceKeyPressed"));
this.ia.xa(M.a.Buh,wc.a.application,Object(R.a)(this,this.hgl,"playVideoCommandHandler"))}Sd(){var a=this.Fa.Kc(yj.a.XE);const b=this.Fa.Kc(xc.a.Ag),c=this.Fa.Kc(xc.a.wR);a.bindAction(B.KeyInputManager.Va(H.a.zs,0),M.a.YCd);a.bindAction(B.KeyInputManager.Va(H.a.zs,4),M.a.ZCd);a.bindAction(B.KeyInputManager.Va(H.a.gG,0),M.a.C4a);a.bindAction(B.KeyInputManager.Va(H.a.I3,0),M.a.C4a);a.bindAction(B.KeyInputManager.Va(H.a.fG,0),M.a.B4a);a.bindAction(B.KeyInputManager.Va(H.a.H3,0),M.a.B4a);a.bindAction(B.KeyInputManager.Va(H.a.lJ,
0),M.a.ypb);a.bindAction(B.KeyInputManager.Va(H.a.Pz,0),M.a.xpb);this.ho&&(a.bindAction(B.KeyInputManager.Va(H.a.I3,4),M.a.HAc),a.bindAction(B.KeyInputManager.Va(H.a.H3,4),M.a.BAc),a.bindAction(B.KeyInputManager.Va(H.a.lJ,4),M.a.DAc),a.bindAction(B.KeyInputManager.Va(H.a.Pz,4),M.a.CAc),a.bindAction(B.KeyInputManager.Va(H.a.gG,4),M.a.GAc),a.bindAction(B.KeyInputManager.Va(H.a.fG,4),M.a.FAc),a.bindAction(B.KeyInputManager.Va(H.a.iPa,2),M.a.nxd));b.bindAction(B.KeyInputManager.Va(H.a.gG,0),M.a.C4a);
b.bindAction(B.KeyInputManager.Va(H.a.fG,0),M.a.B4a);b.bindAction(B.KeyInputManager.Va(H.a.lJ,0),M.a.ypb);b.bindAction(B.KeyInputManager.Va(H.a.Pz,0),M.a.xpb);b.bindAction(B.KeyInputManager.Va(H.a.zs,0),M.a.X3a);b.bindAction(B.KeyInputManager.Va(H.a.zs,4),M.a.pSb);b.bindAction(B.KeyInputManager.Va(H.a.E_,0),M.a.KOh);b.bindAction(B.KeyInputManager.Va(H.a.iPa,2),M.a.Xwc);b.bindAction(B.KeyInputManager.Va(H.a.o8,0),M.a.Dob);b.bindAction(B.KeyInputManager.Va(H.a.Rca,0),M.a.Eob);b.bindAction(B.KeyInputManager.Va(H.a.eja,
0),M.a.Fob);b.bindAction(B.KeyInputManager.Va(H.a.J3,0),M.a.Gob);a=B.KeyInputManager.Va(H.a.gG,0);c.Sy(a);c.bindAction(a,M.a.C4a);a=B.KeyInputManager.Va(H.a.fG,0);c.Sy(a);c.bindAction(a,M.a.B4a);b.bindAction(B.KeyInputManager.Va(H.a.fO,0),M.a.HTh)}rQb(a,b,c){if(this.kS.h1||this.uf.Xc(this.Yb.Of))return 16;if(1===c)return 32;if(!this.Yb.Of||!this.sa.Aa)return 16;32===this.ia.nb(M.a.gqc,1)&&this.ia.nb(M.a.fqc,2);b=this.BGj(this.sa.Aa,a);if(b===this.sa.Aa.ve)return 32;if(this.Ix&&a!==M.a.ypb&&a!==M.a.xpb&&
(a=this.De.YO(b),!a||!a.NM))return 16;this.Fa.N9===xc.a.Ag&&this.Fa.Gd();return this.De.RI(b)}BGj(a,b){a=a.ve;const c=this.Tb.Hi();switch(b){case M.a.B4a:a=Math.min(a+1,c-1);break;case M.a.YCd:a=a+1>c-1?0:a+1;break;case M.a.C4a:a=Math.max(a-1,0);break;case M.a.ZCd:a=0>a-1?c-1:a-1;break;case M.a.ypb:a=0;break;case M.a.xpb:a=c-1}return a}hCb(a,b,c){if(this.kS.h1||this.uf.Xc(this.Yb.Of)||!this.Yb.Of||!this.sa.Aa)return 16;if(1===c)return 32;32===this.ia.nb(M.a.gqc,1)&&this.ia.nb(M.a.fqc,2);if(1>=this.Tb.Hi())return 32;
ya.a.J(508432864,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case M.a.HAc:case M.a.BAc:case M.a.DAc:case M.a.CAc:this.i0j(a);break;case M.a.GAc:case M.a.FAc:this.OXj(a);break;default:return ya.a.J(508432863,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}hNj(a,b){const c=[];var f=this.Tb.Hi();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Tb.oy(a))&&c.push(f);return c}i0j(a){if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");
const b=this.gb.Xe();b.sort((Ra,eb)=>Ra.ve-eb.ve);const c=b[0].ve,f=b[b.length-1].ve,l=this.sa.Aa.ve,u=this.Tb.Hi();var I=[];let T=l,ja=l,ua=l;I=!0;switch(a){case M.a.HAc:1===b.length?ua=T=0<=l-1?l-1:l:l===c?ja=0<=f-1?f-1:f:c?ua=T=c-1:I=!1;break;case M.a.BAc:1===b.length?ua=ja=l<u-1?l+1:l:l===c&&f<u-1?ua=ja=f+1:l===c&&f===u-1?I=!1:T=c+1;break;case M.a.DAc:T=0;break;case M.a.CAc:ja=u-1}if(this.Ix&&ua!==l&&(a=this.De.YO(ua),!a||!a.NM))return;if(I){I=this.hNj(T,ja);let Ra;(Ra=this.gb).sQ.apply(Ra,I);
this.De.lAa(T===l?ja:T)}}OXj(a){const b=this.gb.Xe();b.sort((ja,ua)=>ja.ve-ua.ve);const c=b[0].ve,f=b[b.length-1].ve,l=this.sa.Aa;if(!l)throw Error.argumentNull("ActiveSlide is null");const u=l.ve,I=this.Tb.Hi();let T=null;if(!(1>=I)){switch(a){case M.a.GAc:if(!u)break;(T=this.Tb.oy(u-1))&&1<b.length&&u===f&&this.ewb(b)&&this.gb.Ivc(l);break;case M.a.FAc:u!==I-1&&(T=this.Tb.oy(u+1))&&1<b.length&&u===c&&this.ewb(b)&&this.gb.Ivc(l)}if(T){if(this.Ix&&(a=T.vg(this.De.Na),!a||!a.NM))return;this.Yb.Aa=
T;this.gb.ZDa(T);this.De.lAa(T.ve)}}}ewb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].ve-a[b].ve)return!1;return!0}SZj(a,b,c){if(!this.Yb.Of||!this.sa.Aa||this.uf.Xc(this.Yb.Of))return 16;2===c&&this.De.V2a();return 32}RZj(a,b,c){if(!this.Yb.Of||!this.sa.Aa||this.uf.Xc(this.Yb.Of))return 16;2===c&&this.De.ixd();return 32}t3c(a,b,c){return this.gb.H5()?this.xXj(a,c):this.ZZj(a,c)}ZZj(a,b){if(this.ho&&1!==this.gb.Xe().length)return 8;let c;switch(a){case M.a.Dob:case M.a.Fob:a=
M.a.B4a;c="ThumbnailPageDownNavigation";break;case M.a.Gob:case M.a.Eob:a=M.a.C4a;c="ThumbnailPageUpNavigation";break;default:return ya.a.J(508432860,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),8}$c.a.Kb&&($c.a.Kb.actionName=c,$c.a.Kb.tk=!1,$c.a.Kb.gq=!0);return this.ia.nb(a,b)}xXj(a,b){switch(a){case M.a.Dob:a=M.a.aqc;break;case M.a.Eob:a=M.a.bqc;break;case M.a.Fob:a=M.a.cqc;break;case M.a.Gob:a=M.a.dqc;break;default:return ya.a.J(508432859,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),
8}return this.ia.nb(a,b)}cKh(a,b,c,f,l){if(this.kS.h1)return 16;if(1===c)return 32;b=this.sa.Aa;if(!b)return 16;c=b.yj();if(!c||!c.length)return 16;this.Gd();f=this.gb.rf();if(this.gb.xQb){if(c=this.gb.xQb.vg(this.Yb.dM.Na))c.goe(),c.eLh(!1);f.length||f.push(this.gb.xQb);this.gb.xQb=null}f&&this.RNa(f,!1);c=null;a===M.a.X3a?c=l?l:b.Dcb(f,!1,0):a===M.a.pSb&&(c=b.Dcb(f,!0,0));if(!c)return da.ULS.sendTraceTag(508432856,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),
16;if(this.UKk){l=Object(gb.a)(HB.a,c.vg(this.Yb.dM.Na));if(c.lF&&l&&a===M.a.pSb){const u=document.getElementById(ZO.a.xWe+l.aV);if(u&&document.activeElement!==u)return l.RNa(),u.focus(),32}if(f.length&&(l=f[0],f=Object(gb.a)(HB.a,l.vg(this.Yb.dM.Na)),l.lF&&f&&a===M.a.X3a&&(a=document.getElementById(ZO.a.xWe+f.aV))&&document.activeElement!==a))return a.focus(),32}return this.yxh(c,b)}uLl(a,b,c){if(this.kS.h1)return 16;if(1===c)return 32;a=this.sa.Aa;if(!a)return 16;b=a.yj();if(!b.length)return 16;
a=[];for(const f of b)(b=Object(gb.a)(178,f.vg(this.Yb.dM.Na)))&&b.Mq?b.RNa():(b&&b.shapeNode&&b.shapeNode.Iv&&b.qW(!1),a.push(f));this.gb.$2a(a,!0);this.UK.vrl();this.RNa(a,!0);this.Gd();return 32}vLl(a,b,c){if(1===c)return 32;a=this.sa.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;ya.a.J(508432855,816,50,"Selected All Slides");let f;(f=this.gb).sQ.apply(f,a);this.De.lAa(this.Tb.Hi()-1);return 32}YVl(a,b,c){if(1===c)return 32;md.a("InkEscapeKeyPressedHandling")||
this.ia.nb(M.a.eqe,2);this.ia.nb(M.a.fUb,2);md.a("RaiseEscapeKeyPressedEvent")&&this.ue.Dpl();return 32}tgm(a,b,c){if(!this.gb.nI())return 16;if(1===c)return 32;this.dE.jTa();a=this.gb.Hd();if(b=this.Ga.PVa(a))return a=this.Ga.Hs(b),this.yxh(a,this.sa.Aa);this.RNa(a,!1);this.gb.Bh();this.Gd();return 32}C_j(){this.ia.nb(M.a.Buh,2);this.uxa&&this.ia.nb(M.a.kQf,2);return 32}hgl(){if(!this.gb.rFi()&&!this.gb.sFi())return 2;const a=this.gb.Hd();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=
this.xba.sWa(a[b]);c&&c.startPlaying()}return 32}yxh(a,b){const c=a.vg(this.Yb.dM.Na);if(c){if(c.Mq)return this.gb.Bh(),c.RNa(),c.eLh(!0),c.eT(),b=null,c.E$c?b=String.format(ResourceStrings.L_CannotEditHint,c.E$c.userName):ya.a.J(508432853,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.ZYa.CAh(a,b),this.gb.xQb=a,32}else return da.ULS.sendTraceTag(508432851,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),
8;this.gb.selectShape(a,!0);(a=b.vg(this.Yb.dM.Na))&&a.kAa();c&&(c.RNa(),c.eT());return 32}Gd(){this.Yb.dM.Wp||this.Fa.Gd()}RNa(a,b){for(const c of a)(a=c.vg(this.Yb.dM.Na))&&(b?a.RNa():a.goe())}}Object(m.a)($O,"SelectionActor",null,[948]);class nC{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(m.a)(nC,"SelectionPaneShapeNode",null,[]);var fT=d(915);class aP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,
lc){this.imc=this.BS=null;a("powerpoint-editor-intl").then(()=>{ya.a.J(512500438,801,50,"Icons and strings script is loaded successfully");a("selectionPaneManager").then(()=>{ya.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");this.BS=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.Jxl();ja.sTl()}).catch(Ec=>{ya.a.J(512500436,801,10,"Failed to load selectionPaneManager "+Ec.toString())})}).catch(Ec=>{ya.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+
Ec.toString())});this.gb=b;this.Db=c;this.ia=f;this.sa=l;this.Fa=u;this.tB=I;this.ubh=T;this.bOk=ja;this.Wf=ua;this.xd=Ra;this.Hc=eb;this.nba=Bb;this.GP=Ub;this.Ga=Xb;this.uA=tc;this.Eb=lc;this.sLg=!1;this.Wf.HJ(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.Wf.$Da(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.Hc.zSa(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.xd.eEa(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.Db.QH(Object(R.a)(this,
this.St,"onAppFrameModeSwitched"));this.RYa=!1;this.M9g=null}dispose(){this.Wf.E7(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.Wf.w2a(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.Hc.Emb(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.xd.Gmb(Object(R.a)(this,this.f1a,"onChangeRenderSelectionPane"));this.Db.a_(Object(R.a)(this,this.St,"onAppFrameModeSwitched"))}Sd(){const a=this.Fa.Kc(xc.a.bJ);a.bindAction(B.KeyInputManager.Va(H.a.kVb,6),M.a.Sxd);a.bindAction(B.KeyInputManager.Va(H.a.kPa,
6),M.a.fQc)}Sxd(a){return jh.a("SelectionPaneBringBackward",a,()=>{this.RYa=!0;this.ia.nb(M.a.sendBackward,2);ya.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}fQc(a){return jh.a("SelectionPaneBringForward",a,()=>{this.RYa=!0;this.ia.nb(M.a.bringForward,2);ya.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}qb(){this.ia.pa(M.a.R7,wc.a.application,Object(R.a)(this,this.R7,"showHideSelectionPane"),4);this.ia.pa(M.a.BOb,
wc.a.application,Object(R.a)(this,this.BOb,"querySelectionPane"),96);this.ia.xa(M.a.Sxd,wc.a.application,Object(R.a)(this,this.Sxd,"sendBackwardSelectionPane"));this.ia.xa(M.a.fQc,wc.a.application,Object(R.a)(this,this.fQc,"bringForwardSelectionPane"))}BOb(a,b,c,f,l){(a=Object(gb.a)(Di.a,l))&&a.Rf(this.tB.isVisible);return 32}R7(a,b,c){return 1===c?this.BS&&this.sa.Aa?32:8:jh.a("SelectionPaneOpen",a,()=>{this.tB.isVisible=!this.tB.isVisible;this.YEh();this.tB.isVisible?(this.GP.notesPane&&this.GP.notesPane.K3b()&&
this.Fa.Gd(),this.Fa.qk(xc.a.bJ,!0),this.BS.focusShowAllButton()):this.Fa.qk(xc.a.bJ,!1);return 32})}St(a){1===a.mode&&this.tB&&this.tB.isVisible&&(this.tB.isVisible=!1,this.Fa.qk(xc.a.bJ,!1))}RZi(){const a={};this.imc=new bd.ScriptSharpLegacyMap;var b=this.sa.Aa,c=b?b.yj(!0):null;b=this.gb.rf();const f=new La.a;let l=0;if(c){c.reverse();for(const I of c)if(!I.isLocal)if(c=this.dog(I,b),I.Lf){if(l++,c=this.Ga.rx(I)){c.reverse();for(const T of c){c=this.dog(T,b);let ja=null;for(const ua of T.uC){var u=
void 0;ua.ShapeId.toString()in a?(u=Object(gb.a)(nC,a[ua.ShapeId.toString()]),this.imc.ga(ua.ShapeId).push(T.get_shapeId())):(u=[T.get_shapeId()],this.imc.add(ua.ShapeId,u),u=this.DLj(ua,b),a[ua.ShapeId.toString()]=u,ja?ja.children.push(u):f.add(u));ja=u}ja.children.push(c)}}}else f.add(c)}0<l&&!this.sLg&&(ya.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.sLg=!0);return f}dog(a,b){const c=new nC;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=
a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}DLj(a,b){const c=new nC;c.shapeId=a.ShapeId;c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const f=this.sa.Aa;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.KD(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}YEh(){if(!this.sa.Aa)this.tB.isVisible=!1;else if(this.tB.isVisible){var a=this.RZi();if(this.wPf(a?
a.toArray():null,this.M9g)){this.M9g=a?a.toArray():null;var b=this.nba.lj("UserAction","SelectionPane Rendering started");this.BS.renderSelectionPane(fT.a.pKh,a.toArray());a=b.Qr.toString();b.stop();ya.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else ya.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}wPf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=
b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||f.isFocussedShape!==l.isFocussedShape||this.wPf(f.children,l.children))return!0}return!1}f1a(){this.YEh();this.RYa&&(this.tB.isVisible?this.Fa.qk(xc.a.bJ,!0):this.Fa.qk(xc.a.bJ,!1));this.RYa=!1}S$e(a,b,c){let f;const l=c.uC.length,u=[];f=!1;for(let I=0;I<l;I++){const T=c.uC[I];T.ShapeId===a&&(2===b?(T.IsHidden=!T.IsHidden,f=T.IsHidden):0===b?f=T.IsHidden=!0:1===b&&(f=T.IsHidden=
!1));u.push(T)}return{returnValue:u,Slk:f}}dRi(a){var b=this.sa.Aa;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=this.imc.ga(a);if(!c||1>=c.length)ya.a.J(512500429,801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.KD(c[0]);if(f){var l=!1,u=(()=>{let I=this.S$e(a,2,f);({Slk:l}=I);return I})().returnValue;for(const I of c){const T=(c=b.KD(I))?Object(gb.a)(178,c.sc(this.uA)):null;T&&(l?(T.Qma(),this.gb.zY(c)&&this.gb.T9(c)):!l&&T.xBa())}b=this.Eb.ud(15);
try{b.mc(f),f.uC=u}finally{b&&b.dispose()}}else ya.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}DRh(a){const b=this.sa.Aa;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.yj(!0),f=[];for(const l of c)if(l.Lf){const u=this.Ga.rx(l);f=f.concat.apply(f,u)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.gb.uj(),this.gb.Kea(c));for(const l of c)!a&&l.isHiddenShape?Object(gb.a)(178,l.sc(this.uA)).xBa():a&&!l.isHiddenShape&&Object(gb.a)(178,l.sc(this.uA)).Qma();
f=this.Eb.ud(15);try{f.mc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(const l of this.imc)if(!b.KD(l.key)){const u=l.value;if(!u||1>=u.length){ya.a.J(512500427,801,10,"There should be atleast 2 child shapes in the nested group");continue}const I=b.KD(u[0]);I?(c=[],c=a?this.S$e(l.key,0,I).returnValue:this.S$e(l.key,1,I).returnValue,I.uC=c):ya.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&
f.dispose()}}}Jxl(){this.BS.addCloseSelectionPaneEventListener(()=>{ya.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.tB.isVisible=!1});this.BS.addFocusSelectionPaneListener(()=>{ya.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.qk(xc.a.bJ,!0)});this.BS.addSelectShapeEventListener(a=>{ya.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.sa.Aa;if(!b)throw Error.argumentNull("ActiveSlide is null");
(a=b.KD(a))&&(a.isHiddenShape||this.gb.selectShape(a,!0))});this.BS.addSelectMultipleShapesEventListener(a=>{ya.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");const b=this.sa.Aa;if(!b)throw Error.argumentNull("ActiveSlide is null");jh.a("SelectionPaneMultiSelect",M.a.R7,()=>{if(!a.length){var c=this.gb.Hd();this.gb.Kea(c)}c=0;for(const f of a){const l=b.KD(f);l&&!l.isHiddenShape&&(c?this.gb.selectShape(l,!1):(this.gb.selectShape(l,!0),c++))}return 32})});
this.BS.addToggleVisibilityListener(a=>{ya.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.sa.Aa;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=b.KD(a);b="";if(!c||c.Rg||c.Lf)b="Group";jh.b("SelectionPaneToggleVisibilty",b,M.a.R7,()=>{c?this.ubh.vam(a):this.dRi(a);return 32})});this.BS.addShapeRenameListener((a,b)=>{ya.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.sa.Aa;if(!c)throw Error.argumentNull("ActiveSlide is null");
c=c.KD(a);let f="";if(!c||c.Rg||c.Lf)f="Group";jh.b("SelectionPaneRename",f,M.a.R7,()=>{this.ubh.zTl(a,b);return 32})});this.BS.addShapeReorderListener((a,b)=>{ya.a.J(512500419,822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.sa.Aa;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.KD(a);let l="";if(!f||f.Rg||f.Lf)l="Group";else if(c=c.KD(b),!c||c.Rg||c.Lf)l="Group";jh.b("SelectionPaneReorder",l,M.a.R7,()=>{this.bOk.TYk(a,b);return 32})});this.BS.addShowAllButtonEventListener(()=>
{this.RYa=!0;ya.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");jh.a("SelectionPaneShowAll",M.a.R7,()=>{this.DRh(!1);return 32})});this.BS.addHideAllButtonEventListener(()=>{this.RYa=!0;ya.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");jh.a("SelectionPaneHideAll",M.a.R7,()=>{this.DRh(!0);return 32})});this.BS.addBringForwardButtonEventListener(()=>{this.RYa=!0;ya.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");
jh.a("SelectionPaneBringForward",M.a.R7,()=>{this.ia.nb(M.a.bringForward,2);return 32})});this.BS.addBringBackwardButtonEventListener(()=>{this.RYa=!0;ya.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");jh.a("SelectionPaneBringBackward",M.a.R7,()=>{this.ia.nb(M.a.sendBackward,2);return 32})});ya.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(m.a)(aP,"SelectionPaneActor",null,[948]);class bP{constructor(a,b,
c,f){this.pga=!1;this.Nlc="ShapeAlignToSelectedObjects";this.ia=a;this.yb=c;this.gb=b;this.e2=f}qb(){ya.a.J(508694535,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");this.ia.pa(M.a.hNf,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.FOh,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.Izd,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.cyc,wc.a.application,Object(R.a)(this,
this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.Jzd,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.$xc,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.ayc,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.byc,wc.a.application,Object(R.a)(this,this.IWa,"handleShapesAlignment"),4);this.ia.pa(M.a.wFa,wc.a.application,Object(R.a)(this,this.ytg,"handleShapesDistribution"),4);this.ia.pa(M.a.$7b,
wc.a.application,Object(R.a)(this,this.ytg,"handleShapesDistribution"),4);this.ia.pa(M.a.DOb,wc.a.application,Object(R.a)(this,this.DOb,"queryShapeAlignToSlide"),96);this.ia.xa(M.a.XAc,wc.a.application,Object(R.a)(this,this.XAc,"toggleShapeAlignToSlide"));this.ia.pa(M.a.COb,wc.a.application,Object(R.a)(this,this.COb,"queryShapeAlignToSelectedObjects"),96);this.ia.xa(M.a.WAc,wc.a.application,Object(R.a)(this,this.WAc,"toggleShapeAlignToSelectedObjects"))}Sd(){}Vfc(){return A.AFrameworkApplication.za&&
A.AFrameworkApplication.za.mb.es?!0:!1}IWa(a,b,c){if(this.e2){b=this.gb.Hd();for(const l of b)if(!l.$a(yb.a.VXa))return 16}const f=this.gb.rf();return f?1===c?f.length?32:8:jh.a("Align",a,()=>{ya.a.J(508694533,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],u=1===f.length||this.pga?this.ucg(a):this.tcg(a,f);if(null===u)return ya.a.J(508694532,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const I of f)l.push(new Sw(I,
this.XFj(a,I,u)));if(!l[0].shapeNode.Rg)for(const I of l)this.ik(I.shapeNode).setPosition(I.position.x,I.position.y,!0);this.ia.Ia(M.a.mLa,2,l);return 32}):(ya.a.J(508694534,822,10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}DOb(a,b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return ya.a.J(508694531,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Rf(this.pga);ya.a.J(508694530,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");
return 32}XAc(a,b,c,f,l){a=this.gb.rf();if(1===c)return 2>a.length&&(this.pga=!0,this.Nlc="ShapeAlignToSlide",ya.a.J(508694529,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),32;if(!l||"object"!==typeof l)return ya.a.J(508694528,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.y1h(l)&&(this.pga=!0,ya.a.J(508692707,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}COb(a,
b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return ya.a.J(508692706,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),8;l.Rf(!this.pga);ya.a.J(508692705,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");return 32}WAc(a,b,c,f,l){a=this.gb.rf();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return ya.a.J(508692704,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.y1h(l)&&
(this.pga=!1,ya.a.J(508692703,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}XFj(a,b,c){let f=null;var l=this.ik(b);b=l.$Zc();l=l.Gs();switch(a){case M.a.Izd:ya.a.J(508692702,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");f=new pd.a(b.x-l.oc+c,b.y);break;case M.a.cyc:ya.a.J(508692701,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new pd.a(b.x+(c-l.lc),b.y);break;case M.a.Jzd:ya.a.J(508692700,
822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new pd.a(b.x,b.y-l.pc+c);break;case M.a.$xc:ya.a.J(508692699,822,50,"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new pd.a(b.x,b.y+(c-l.jc));break;case M.a.ayc:ya.a.J(508692698,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");f=new pd.a(b.x+(c-l.ng().x),b.y);break;case M.a.byc:ya.a.J(508692697,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new pd.a(b.x,
b.y+(c-l.ng().y))}return f}ytg(a,b,c){const f=this.gb.rf();return f?1===c?!f.length||2===f.length&&!this.pga?8:32:jh.a("Align",a,()=>{ya.a.J(508692695,822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.ibf(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.pga?this.ucg(a):this.tcg(a,f);if(null===l)return ya.a.J(508692694,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var u=l-this.ZOi(a,f);l=this.HOi(f,u);
u=this.LOi(a,f,u,l);this.gdj(a,f,f.length-1,l,u);return 32}):(ya.a.J(508692696,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),16)}ZOi(a,b){return a===M.a.wFa?this.$Oi(b):this.aPi(b)}$Oi(a){let b=0;for(const c of a)a=this.ik(c),b+=a.Gs().jc-a.Gs().pc;return b}aPi(a){let b=0;for(const c of a)a=this.ik(c),b+=a.Gs().lc-a.Gs().oc;return b}LOi(a,b,c,f){if(1===b.length||this.pga)return 0<c?f:0;b=this.ik(b[0]);return a===M.a.wFa?b.Gs().jc+f:b.Gs().lc+f}HOi(a,b){return(1===a.length||
this.pga)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}gdj(a,b,c,f,l){var u=0;const I=[];1<b.length&&!this.pga?(ya.a.J(508692693,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),u++,c--):ya.a.J(508692692,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===M.a.wFa?ya.a.J(508692691,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):ya.a.J(508692690,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");u<=
c;u++){const ja=b[u];if(!ja)continue;const ua=this.ik(ja);if(ua){var T=ua.$Zc();a===M.a.wFa?(T=new pd.a(T.x,l),I.push(new Sw(ja,T)),l+=ua.Gs().jc-ua.Gs().pc+f):(T=new pd.a(l,T.y),I.push(new Sw(ja,T)),l+=ua.Gs().lc-ua.Gs().oc+f)}}if(I[0]&&!I[0].shapeNode.Rg)for(const ja of I)this.ik(ja.shapeNode).setPosition(ja.position.x,ja.position.y,!0);this.ia.Ia(M.a.mLa,2,I)}ucg(a){const b=Object(gb.a)(227,this.gb.Pk().sc(this.yb.Na));if(!b)return ya.a.J(508692689,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",
a),null;switch(a){case M.a.cyc:case M.a.$7b:return b.Oy.clientWidth;case M.a.$xc:case M.a.wFa:return b.Oy.clientHeight;case M.a.ayc:return b.Oy.clientWidth/2;case M.a.byc:return b.Oy.clientHeight/2;default:return ya.a.J(508692688,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",a),0}}tcg(a,b){switch(a){case M.a.Izd:var c=Number.MAX_VALUE;for(const u of b)b=this.ik(u),c=Math.min(b.Gs().oc,c);return c;case M.a.cyc:c=-Number.MAX_VALUE;for(const u of b)b=
this.ik(u),c=Math.max(b.Gs().lc,c);return c;case M.a.Jzd:c=Number.MAX_VALUE;for(const u of b)b=this.ik(u),c=Math.min(b.Gs().pc,c);return c;case M.a.$xc:c=-Number.MAX_VALUE;for(const u of b)b=this.ik(u),c=Math.max(b.Gs().jc,c);return c;case M.a.ayc:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.ik(c),f=Math.min(b.Gs().oc,f),l=Math.max(b.Gs().lc,l);return f+(l-f)/2;case M.a.byc:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.ik(f),c=Math.min(b.Gs().pc,c),l=Math.max(b.Gs().jc,
l);return c+(l-c)/2;case M.a.wFa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.ik(l),c=Math.min(c,b.Gs().pc),f=Math.max(b.Gs().jc,f);return f-c;case M.a.$7b:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const u of b)b=this.ik(u),c=Math.min(c,b.Gs().oc),f=Math.max(b.Gs().lc,f);return f-c;default:return ya.a.J(508692687,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}ibf(a,
b,c,f){if(!(c>=f)){var l=this.wel(a,b,c,f);this.ibf(a,b,c,l-1);this.ibf(a,b,l+1,f)}}wel(a,b,c,f){if(b===M.a.wFa)return this.yel(a,c,f);if(b===M.a.$7b)return this.xel(a,c,f);ya.a.J(508692686,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}yel(a,b,c){var f=this.ik(a[c]).Gs().ng().y;let l=b-1;for(;b<=c-1;b++)if(this.ik(a[b]).Gs().ng().y<f){l++;const u=a[l];a[l]=a[b];a[b]=u}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}xel(a,b,c){var f=this.ik(a[c]).Gs().ng().x;
let l=b-1;for(;b<=c-1;b++)if(this.ik(a[b]).Gs().ng().x<f){l++;const u=a[l];a[l]=a[b];a[b]=u}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}y1h(a){const b=a.SourceControlId;return a[Xh.a.On]&&this.Nlc!==b?(this.pga="ShapeAlignToSelectedObjects"===this.Nlc,this.Vfc()&&(a={},a[b]="ToggleButtonModel",a[this.Nlc]="ToggleButtonModel",ad.App.Ob.OB(a)),this.Nlc=b,!0):!1}ik(a){return a?Object(gb.a)(178,a.sc(this.yb.Na)):null}}Object(m.a)(bP,"ShapeAlignmentActor",null,[948]);var cP=d(509),gT=d(987);class Cz{}Object(m.a)(Cz,
"CT_NoFillProperties",null,[]);var hT=d(988);class oC{constructor(a,b){this.z9l=a;this.gAc=b}}Object(m.a)(oC,"FormatPainterData",null,[]);var dP=d(750);class $i{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.x7l="data:image/svg+xml;charset=utf8,";this.QXe=96;this.ia=a;this.oa=I;this.te=f;this.Eb=c;this.Fa=b;this.dE=l;this.ic=u;this.YHe=ja;this.AK=T;this.sKe=Ra;this.NYg=(a=!Ec||!Ec.isInHighContrastMode)&&lc.lue;this.dZ=lc.powerPointGraphicToolTabIsEnabled;this.VJe=a&&lc.svgIconLocalEditingIsEnabled;
this.qjb=ua;this.uA=pe;this.Ga=eb;this.dS=Bb;this.PV=Ub;this.Yb=Xb;this.sa=tc;this.Cc=hd;this.wq=lc.pptTextFormatPainterIsEnabled;this.FSg=lc.formatPainterApplyRemappedIsEnabled;this.zYg=lc.W8c;this.Chb=lc.zjl;this.DV=lc.INb;this.ka=lc;this.Mj=yd;this.Hlc=new bd.ScriptSharpLegacyMap;this.vB=Pd}qb(){this.ia.pa(M.a.gYe,wc.a.application,Object(R.a)(this,this.uYj,"handlePopulateShapeFillMenu"),96);this.ia.pa(M.a.vRe,wc.a.application,Object(R.a)(this,this.pXj,"handleMoreFillColors"),96);this.ia.pa(M.a.xRe,
wc.a.application,Object(R.a)(this,this.uXj,"handleMoreOutlineColors"),96);this.ia.pa(M.a.lEa,wc.a.application,Object(R.a)(this,this.Urg,"handleApplyShapeFillColor"),4);this.ia.pa(M.a.H3b,wc.a.application,Object(R.a)(this,this.hUj,"handleApplyShapeFillCustomColor"),4);this.ia.pa(M.a.Zvb,wc.a.application,Object(R.a)(this,this.Urg,"handleApplyShapeFillColor"),4);this.ia.pa(M.a.hvd,wc.a.application,Object(R.a)(this,this.gtg,"handleRemoveShapeFill"),4);this.ia.pa(M.a.P2e,wc.a.application,Object(R.a)(this,
this.gtg,"handleRemoveShapeFill"),4);this.ia.pa(M.a.ctc,wc.a.application,Object(R.a)(this,this.vYj,"handlePopulateShapeOutlineMenu"),96);this.ia.pa(M.a.hea,wc.a.application,Object(R.a)(this,this.Vrg,"handleApplyShapeOutlineColor"),4);this.ia.pa(M.a.I3b,wc.a.application,Object(R.a)(this,this.iUj,"handleApplyShapeOutlineCustomColor"),4);this.ia.pa(M.a.$vb,wc.a.application,Object(R.a)(this,this.Vrg,"handleApplyShapeOutlineColor"),4);this.ia.pa(M.a.LSa,wc.a.application,Object(R.a)(this,this.mUj,"handleApplyShapeOutlineWidth"),
4);this.ia.pa(M.a.L9a,wc.a.application,Object(R.a)(this,this.jUj,"handleApplyShapeOutlineDashStyle"),4);this.zYg&&this.ia.pa(M.a.M9a,wc.a.application,Object(R.a)(this,this.lUj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.pa(M.a.Vka,wc.a.application,Object(R.a)(this,this.kUj,"handleApplyShapeOutlineEndStyle"),4);this.ia.pa(M.a.ivd,wc.a.application,Object(R.a)(this,this.htg,"handleRemoveShapeOutline"),4);this.ia.pa(M.a.Q2e,wc.a.application,Object(R.a)(this,this.htg,"handleRemoveShapeOutline"),4);
this.ia.pa(M.a.pVa,wc.a.application,Object(R.a)(this,this.a0j,"handleToggleFormatPainterActive"),4);this.ia.pa(M.a.hfa,wc.a.application,Object(R.a)(this,this.ZTj,"handleApplyFormat"),4);this.ia.pa(M.a.$ee,wc.a.application,Object(R.a)(this,this.$Tj,"handleApplyFormatToShape"),5);this.ia.pa(M.a.ptd,wc.a.application,Object(R.a)(this,this.NYj,"handleQueryFormatPainter"),97);this.ia.pa(M.a.PNb,wc.a.application,Object(R.a)(this,this.BYj,"handlePreviewShapeFillColor"),4);this.ia.pa(M.a.VPb,wc.a.application,
Object(R.a)(this,this.NZj,"handleRevertPreviewShapeFillColor"),4)}Sd(){const a=this.Fa.Kc(xc.a.Ag);a.bindAction(B.KeyInputManager.Va(H.a.Ira,6),M.a.pVa);const b=this.Fa.Kc(xc.a.wR);let c=B.KeyInputManager.Va(H.a.Ira,6);b.Sy(c);this.wq?b.bindAction(c,G.a.$Yc):b.bindAction(c,M.a.pVa);ya.a.J(512500379,815,50,"formatPainterApplyRemapped: {0}",this.FSg);this.FSg||(c=B.KeyInputManager.Va(H.a.lPa,6),a.bindAction(c,M.a.hfa),b.Sy(c),this.wq?b.bindAction(c,M.a.afe):b.bindAction(c,M.a.hfa))}gBb(a,b){const c=
[];if(a)for(const f of a)(f.iwa||b&&f.get_isSVGBlipFilled()||f.$j||this.DV&&1===f.mediaType)&&c.push(f);return c}pcb(a,b){const c=[];if(a)for(const f of a)(f.iwa&&!f.dA||b&&f.get_isSVGBlipFilled()&&(!this.ka.enableCameoInEditor||!f.lF)||this.Chb&&f.vd)&&c.push(f);return c}uYj(a,b,c,f,l){if(!this.oa.H5()||this.ic.xC(this.oa.Hd()))return 16;if(1===c)return 32;if(!l)return 8;b=this.sa.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.wea;b=(c=this.oa.Zn())?b.LD(c.slideId):null;
if(!b)return 16;var u=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=u?M.a.Zvb:M.a.lEa;f=u?M.a.P2e:M.a.hvd;const I=M.a.vRe;if(l.MenuId&&"fill"===l.MenuId){var T=new dP.a(b.Ld);u=new Sys.StringBuilder;u.append(String.format($i.tTf,"PptRibbon.Drawing.ShapeFill"));if(!b.Ld)return 8;u.append(T.cme(c,a,M.a.H3b));u.append($i.ATf);u.append(String.format($i.yTf,f,A.AFrameworkApplication.Mm,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));u.append($i.zTf);u.append($i.sNi);u.append(String.format($i.qNi,
I,A.AFrameworkApplication.Mm,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));u.append($i.rNi);u.append($i.sTf);l.PopulationXML=u.toString()}else{T=Object.assign(new Rn.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const ja=u?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",ua=u?"GraphicNoFill":"ShapeNoFill";Array.add(T.MenuSectionList,ql.f(b.Ld,AG.a.themeColors,"Color.Menu.Controls","themeColor",u?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",
c.toString(),1));Array.add(T.MenuSectionList,ql.d("Standard Colors","Color.Menu.Controls","standardColor",ja,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(T.MenuSectionList,ql.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(T.MenuSectionList,ql.b("Remove Color",
"Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",ua,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(T.MenuSectionList,ql.a("More Fill Color","Color.Menu.Controls",I.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));md.a("ColorPickerHighlighterFix")&&(a=this.oLj(b.Ld),ql.h(T,a,b.Ld));l.MenuItems=T}return 32}vYj(a,
b,c,f,l){a=this.sa.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.oa.H5()||this.ic.xC(this.oa.Hd()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.oa.Zn())?a.LD(c.slideId):null;if(!c||!c.Ld)return 8;a=a.wea;var u=this.te.Ok("pegal.png"),I=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=I?M.a.$vb:M.a.hea;f=I?M.a.Q2e:M.a.ivd;const T=M.a.xRe;if(l.MenuId&&"outline"===l.MenuId){var ja=new Sys.StringBuilder;ja.append(String.format($i.tTf,"PptRibbon.Drawing.ShapeOutline"));
c=new dP.a(c.Ld);ja.append(c.cme(b,a,M.a.I3b));ja.append($i.ATf);ja.append(String.format($i.yTf,f,A.AFrameworkApplication.Mm,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));ja.append($i.zTf);ja.append($i.vNi);ja.append(String.format($i.tNi,T,A.AFrameworkApplication.Mm,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));ja.append($i.uNi);c=this.oa.Hd();a=$i.OKj(c,this.dZ);if(!a||!a.length||c&&c.length!==a.length)ja.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),
ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.APc,M.a.LSa,A.AFrameworkApplication.Mm,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,u,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.xPc,M.a.L9a,A.AFrameworkApplication.Mm,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,u,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.zYg&&ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.zPc,M.a.M9a,A.AFrameworkApplication.Mm,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,u,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.yPc,M.a.Vka,A.AFrameworkApplication.Mm,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,u,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),ja.append("</Controls></MenuSection>");
ja.append($i.sTf);l.PopulationXML=ja.toString()}else{u=I?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";ja=I?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const ua=I?"GraphicNoOutline":"ShapeNoOutline";I=Object.assign(new Rn.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(I.MenuSectionList,ql.f(c.Ld,"Theme Colors","Color.Menu.Controls","themeColor",u,b.toString(),1));Array.add(I.MenuSectionList,ql.d("Standard Colors","standardColor","Standard Colors",
ja,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(I.MenuSectionList,ql.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(I.MenuSectionList,ql.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
ua,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(I.MenuSectionList,ql.a("More Outline Color","Color.Menu.Controls",T.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));md.a("ColorPickerHighlighterFix")&&(a=this.nLj(c.Ld),ql.h(I,a,c.Ld));l.MenuItems=I}return 32}BYj(a,b,c,f,l){if(!l)return ya.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.ka.xtc)return 2;b=this.oa.rf();const u=this.pcb(b,this.dZ);return u&&u.length?this.Chb&&1===u.length&&u[0].vd?(ya.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):jh.a("HandlePreviewShapeFillColor:",a,()=>{const I=this.oa.pQ(u),T=this.AK.uT(l),ja=Object.assign(new cP.a,{});ja.solidFillField=T;for(const ua of I)ua?ua.vd||(this.Hlc.Ib(ua.get_shapeId())?this.Hlc.$(ua.get_shapeId(),ua.fill):this.Hlc.add(ua.get_shapeId(),ua.fill),ua.fill=
ja,ua.nia=null):ya.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",ua.get_shapeId());return 32}):(ya.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}NZj(a,b,c,f,l){if(!l)return ya.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.ka.xtc)return 2;a=this.oa.rf();a=this.pcb(a,this.dZ);if(!a||!a.length)return ya.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.Chb&&1===a.length&&a[0].vd)return ya.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.oa.pQ(a);for(const u of a)if(!u)ya.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",u.get_shapeId());else if(!u.vd)if(this.Hlc.Ib(u.get_shapeId()))u.fill=this.Hlc.ga(u.get_shapeId()),u.nia=null;else return ya.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}Urg(a,b,c,f,l){var u=this.sa.presentation;if(!u)throw Error.argumentNull("Presentation is null");f=this.oa.rf();b=this.pcb(f,this.dZ);const I={type:"ColorPickerPayload",color:""};l&&(I.color=l.Color);if(!(b&&0<b.length||this.oa.UM()&&this.JFg(f[0],a,I))||this.ic.xC(b))return 16;const T=this.oa.Zn();u=T?u.LD(T.slideId):null;if(!u||!u.Ld||!u.Ld.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.Chb&&1===b.length&&b[0].vd)return ya.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.Ia(M.a.y7,c,l);c=$i.Xqd(l);if(!c)return 8;1<f.length?ya.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):ya.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var ja of f)if(ja.Lf||ja.Rg){Xn(ja);break}if(this.oa.UM()&&this.JFg(f[0],a,I)&&this.Kme(f[0],a,I))return 32;ja=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{ja.mc(b[0]);ja.Wc=a;const ua=this.AK.uT(l),Ra=this.oa.pQ(b);
for(const eb of Ra)if(eb.vd){if(!this.Chb)continue;ya.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const Bb=this.Cc.XO(eb);if(!Bb){ya.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const Ub=Bb.Tcb();for(const Xb of Ub){const tc=Xb.cellShading;Sp.b(tc);tc.solidFillField=ua;Xb.cellShading=tc}}else{const Bb=this.O9f(eb);Bb&&(this.AK.LUa(Bb),Bb.solidFillField=ua,eb.fill=Bb,eb.nia=null,this.x3h(eb,Bb));eb.xia=JSON.stringify(c);this.NQb(eb)}}finally{ja&&
ja.dispose()}return 32}pXj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.renderColorPicker,1,l);a=this.lLj();b={};b.currentColor=a;b.handleCommand=M.a.H3b;return this.ia.Ia(M.a.renderColorPicker,2,b)}hUj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.lEa,c,l);if(!l)return ya.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.Ia(M.a.lEa,c,l);32===a&&this.ia.Ia(M.a.WDa,c,l);return a}uXj(a,b,c,f,l){a=this.oa.rf();a=md.a("FixColorPickerPictureBorderColor")?this.gBb(a,this.dZ):
this.pcb(a,this.dZ);a=this.oa.pQ(a);if(1===c)return this.ia.Ia(M.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].Awa&&(c=Ze.Box4ColorHelper.Xua(a[0].Awa));l={};l.currentColor=c;l.handleCommand=M.a.I3b;return this.ia.Ia(M.a.renderColorPicker,2,l)}gtg(a,b,c,f,l){f=this.oa.rf();b=this.pcb(f,this.dZ);const u=!!b&&0<b.length;if(this.ic.xC(b))return 16;if(1===c)return u?32:8;if(!u)return 16;1<f.length?ya.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",f.length):
ya.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.Chb&&1===b.length&&b[0].vd)return ya.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.Ia(M.a.pMa,c,l);c=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{c.mc(b[0]);c.Wc=a;const I=this.oa.pQ(b);for(const T of I)if(T.vd){if(!this.Chb)continue;ya.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const ja=this.Cc.XO(T);if(!ja){ya.a.J(512500353,815,
10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const ua=ja.Tcb();for(const Ra of ua){const eb=Ra.cellShading;Sp.b(eb);eb.noFillField=new Cz;Ra.cellShading=eb}}else{const ja=this.O9f(T);ja&&(this.AK.LUa(ja),ja.noFillField=new Cz,T.fill=ja,T.nia=null,this.x3h(T,ja));T.gzl();this.NQb(T)}}finally{c&&c.dispose()}return 32}Vrg(a,b,c,f,l){var u=this.sa.presentation;if(!u)throw Error.argumentNull("Presentation is null");f=this.oa.rf();b=this.gBb(f,this.dZ);if(!(b&&0<b.length)||this.ic.xC(b))return 16;
const I=this.oa.Zn();u=I?u.LD(I.slideId):null;if(!u||!u.Ld||!u.Ld.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=$i.Xqd(l);if(!c)return 8;1<f.length?ya.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):ya.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var T of f)if(T.Lf||T.Rg){Xn(T);break}T=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{T.mc(b[0]);
T.Wc=a;const ja=this.oa.pQ(b);for(const ua of ja){const Ra=this.Nbe(ua);if(Ra){this.AK.LUa(Ra);const eb=this.AK.uT(l);Ra.solidFillField=eb;ua.lineStyle=Ra;ua.Awa=null;this.nFd(ua,Ra)}ua.$qa=JSON.stringify(c);this.NQb(ua)}}finally{T&&T.dispose()}return 32}iUj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.hea,c,l);if(!l)return ya.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.Ia(M.a.hea,c,l);32===a&&this.ia.Ia(M.a.WDa,c,l);return a}mUj(a,b,c,f,l){f=this.oa.rf();
b=this.gBb(f,this.dZ);if(!(b&&0<b.length)||this.ic.xC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.A2c(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=$i.PIh.length||0>c)return 8;1<f.length?ya.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):ya.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{l.mc(b[0]);
l.Wc=a;const u=this.oa.pQ(b);for(const I of u){const T=this.Nbe(I);T&&(T.wField=$i.BJl[c],T.wFieldSpecified=!0,this.nFd(I,T),this.F9f(T),I.lineStyle=T);I.outlineWidth=$i.PIh[c];this.NQb(I)}}finally{l&&l.dispose()}return 32}NQb(a){this.Ga.TM(a)&&$c.a.Kb&&($c.a.Kb.tk=!0)}O9f(a){if(!this.NYg)return null;let b=a.fill;b||!a.TM&&!a.get_isSVGBlipFilled()||(b=new cP.a);return b}Nbe(a){var b=this.sa.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.NYg)return null;let c=a.lineStyle;
if(this.VJe&&a.F8c()&&c&&c.wFieldSpecified){b=Object(gb.a)(205,b.LD(a.slideId));var f=this.Mj.PH;b&&b.ey&&null!=b.ey.gt&&(f=b.ey.gt);b=c.wField/f;f=this.ebc(a);if(!f||!f.USa||!f.QPc)return c.wField=b,c;var l;(l=f.Nk&&f.Nk.sI&&f.Nk.sI.MM()&&1===f.Nk.sI.va.childNodes.length?f.Nk.sI.va.childNodes[0].getAttribute("width"):f.USa.getAttribute("width"))&&!Aa.a.Ta(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.pHi*f.QPc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.TM&&!a.get_isSVGBlipFilled()||
(c=new gT.a);return c}F9f(a){if(a.noFillField||Sp.e(a))a.noFillField=null,a.solidFillField=Object.assign(new nu.a,{schemeClrField:Object.assign(new sn.a,{valField:1})})}jUj(a,b,c,f,l){f=this.oa.rf();b=this.gBb(f,this.dZ);if(!(b&&0<b.length)||this.ic.xC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.A2c(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?ya.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):ya.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{l.mc(b[0]);l.Wc=a;const u=this.oa.pQ(b);for(const I of u){const T=this.Nbe(I);T&&(T.prstDashField=T.prstDashField||new hT.a,T.prstDashField.valField=this.NIj(c),T.prstDashField.valFieldSpecified=!0,T.custDashField=null,this.nFd(I,T),this.F9f(T),I.lineStyle=T);I.JN=c;this.NQb(I)}}finally{l&&l.dispose()}return 32}NIj(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}kUj(a,b,c,f,l){f=this.oa.rf();b=$i.rEj(f);if(!(b&&0<b.length)||this.ic.xC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.A2c(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=$i.BIh.length)return 8;c=$i.BIh[l];l=$i.xJl[l];1<f.length?ya.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):ya.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{f.mc(b[0]);f.Wc=a;const u=this.oa.pQ(Array.isArray(b)?b:null);for(const I of u)I.ATl(c,l)}finally{f&&f.dispose()}return 32}htg(a,b,c){const f=this.oa.rf();b=this.gBb(f,this.dZ);if(!(b&&0<b.length)||this.ic.xC(b))return 16;if(1===c)return 32;1<f.length?ya.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):ya.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{c.mc(b[0]);c.Wc=a;const l=this.oa.pQ(b);for(const u of l){const I=u.lineStyle;I&&(this.AK.LUa(I),I.noFillField=new Cz,u.lineStyle=I,u.Awa=null,this.nFd(u,I));u.Nzl();this.NQb(u)}}finally{c&&c.dispose()}return 32}lUj(a,b,c,f,l){f=this.oa.rf();b=this.gBb(f,this.dZ);if(!(b&&0<b.length)||$i.QLl(f))return 8;if(this.ic.xC(b))return 16;if(1===c)return 32;if(!l)return ya.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.A2c(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return ya.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?ya.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):ya.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{l.mc(b[0]);l.Wc=a;for(const u of b)u.$rc=c,
u.setValue(yb.a.Zfc,!0)}finally{l&&l.dispose()}return 32}a0j(a,b,c){b=this.oa.rf();a=this.oa.Zn();if(!(this.dE.isActive||1===b.length&&a&&a.IVh||this.wq&&this.oa.nna()))return 16;if(1===c)return 32;if(this.ic.Xc(a))return 16;c=32;if(this.dE.isActive)this.dE.jTa();else if(this.wq)if(this.dS.JM)this.dS.JM=!1;else{b=this.oa.Oa.kb;var f=null;if(b&&(f=b.Ua)&&(f.contextId===ta.a.Xf||f.contextId===ta.a.textRange||f.contextId===ta.a.endOfParagraph||f.contextId===ta.a.paragraph))c=this.ia.nb(G.a.$Yc,2);else if(a.vd&&
this.oa.u1(this.oa.Oa)){if(b=a.XBb())if(b=b.tf(0,0)){b.vQl(this.dS);var l=b.U9b;f=-1;l&&(f=$a.ParagraphReader.textLength(Object(gb.a)(Zg.a,l))+1);if(l=this.Yb.qj){const u=this.Eb.xe(4),I=l.ij;u.mc(l);const T=this.PV.FGa(I),ja=Object(gb.a)(205,this.YHe.Hog(b));this.PV.Uhf(T,!0,!1,ja,a,b,null,0,f);(a=I.Wtc(T))&&l.KFb(a);u.dispose()}}}else this.dE.vuh(a)}else this.dE.vuh(a);ad.App.Ob.Gf();return c}ZTj(a,b,c){return this.wq&&(a=this.oa.Oa.kb)&&(a=a.Ua)&&(a.contextId===ta.a.Xf||a.contextId===ta.a.textRange||
a.contextId===ta.a.endOfParagraph||a.contextId===ta.a.paragraph)?(this.dE.jTa(),this.ia.nb(M.a.afe,2)):(a=this.oa.Zn())?this.ia.Ia(M.a.$ee,c,new oC(this.dE.y9l,a)):16}$Tj(a,b,c,f,l){if(!l||!Object(gc.a)(oC,l))return ya.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.wq&&this.dS.JM)return this.dS.JM=!1,16;b=l.gAc;if(!(this.dE.isActive&&b&&b.HVh))return this.dE.jTa(),16;if(this.ic.Xc(b))return 16;if(1===c)return 32;$c.a.Kb&&($c.a.Kb.tk=!1,$c.a.Kb.actionName=
"FormatPainterApplyToShape",$c.a.Kb.gq=!0);c=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{c.mc(l.gAc),c.Wc=a,l.gAc.nAb=l.z9l.id}finally{c&&c.dispose()}this.dE.jTa();return 32}NYj(a,b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return 8;l.Rf(this.dE.isActive||(this.wq?this.dS.JM:!1));return 32}Fnl(a,b,c){return(a=this.ebc(a))&&Object(gc.a)(Kt.a,a.Nk)&&(a=Object(gb.a)(Kt.a,a.Nk))?a.w_e(M.a.Fv(b),c):!1}Kme(a,b,c){return(a=this.ebc(a))&&Object(gc.a)(Kt.a,a.Nk)&&(a=Object(gb.a)(Kt.a,a.Nk))?a.Hsc(M.a.Fv(b),
c):!1}A2c(a){return a.split(",")[1]}x3h(a,b){if(this.VJe&&a.F8c()){var c=this.ebc(a),f=this.z_f(c,a);a=b.noFillField?null:this.ZI(b,a);f=this.qjb.Vem(f,a);this.VNf(c,f)}}nFd(a,b){var c=this.sa.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.VJe&&a.F8c()){var f=this.ebc(a),l=this.z_f(f,a);if(null!==l){if(b.noFillField)l=this.qjb.q0h(l);else{if(b.wFieldSpecified){var u=Object(gb.a)(205,c.LD(a.slideId)),I=this.Mj.PH;u&&u.ey&&null!=u.ey.gt&&(I=u.ey.gt);l=this.qjb.r0h(l,b.wField,
f.Jd,I)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.qjb.Wem(l,b.prstDashField.valField));if(b.solidFillField){b=this.ZI(b,a);l=this.qjb.q0h(l,b);if(!l)return;b=l.querySelectorAll(this.qjb.Tcf);u=!0;for(I=0;I<b.length;++I){const T=b[I].getAttribute("stroke-width");if(T&&!Aa.a.Ta(T.toString())){u=!1;break}}u&&(a=Object(gb.a)(205,c.LD(a.slideId)),c=this.Mj.PH,a&&a.ey&&null!=a.ey.gt&&(c=a.ey.gt),l=this.qjb.r0h(l,Re.a.YXe/this.QXe,f.Jd,c))}}this.VNf(f,l)}}}ZI(a,b){const c=this.sa.presentation;
if(!c)throw Error.argumentNull("Presentation is null");b=c.LD(b.slideId);return this.AK.KPb(a,b.Ld)}VNf(a,b){if(b&&a&&a.Nk){a.Nk.A0.ee(!1);var c=a.Nk.sI.va.childNodes;for(let f=0;f<c.length;++f)a.Nk.sI.va.removeChild(c[f]);a.Nk.sI.va.appendChild(b);(b=a.USa.getAttribute("transform"))&&a.Nk.sI.va.setAttribute("transform",b.toString());a.Nk.sI.ee(!0);$c.a.Kb&&($c.a.Kb.tk=!0,$c.a.Kb.xG=new Date)}}JFg(a,b,c){return md.a("EnableSmartArtFillColor")&&this.Fnl(a,b,c)}lLj(){var a=this.oa.rf();a=this.pcb(a,
this.dZ);var b=this.oa.pQ(a),c=null;a=null;md.a("FixColorPickerSelectedColor")&&(a=this.sa.Aa);if(1===b.length){if(b[0].nia)c=Ze.Box4ColorHelper.Xua(b[0].nia);else if(b[0].vd&&md.a("FixColorPickerSelectedColor")){const f=this.oa.yw();if(!f||!f.length){if(b=this.oa.$n())b=b.tf(0,0),c=Ze.Box4ColorHelper.rma(b.cellShading.solidFillField,a.Ld);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?Ze.Box4ColorHelper.rma(c.cellShading.solidFillField,a.Ld):this.vB.UZc(Object(gb.a)(Zg.a,c))}!c&&
md.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=Ze.Box4ColorHelper.rma(b[0].fill.solidFillField,a.Ld))}return c}vam(a){var b=this.sa.Aa;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.KD(a).isHiddenShape;this.CTl(a,b)}uam(a,b){a.isHiddenShape=!b;const c=Object(gb.a)(178,a.sc(this.uA));b?c.xBa():(c.Qma(),this.oa.zY(a)&&this.oa.T9(a))}CTl(a,b){const c=this.Eb.ud(15,void 0,()=>{this.oa.uj()});try{const f=this.sa.Aa;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.KD(a);c.mc(l);this.uam(l,b)}finally{c&&c.dispose()}}zTl(a,b){const c=this.Eb.ud(15,void 0,()=>{this.oa.uj()});try{const f=this.sa.Aa;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.KD(a);c.mc(l);l.shapeName=b}finally{c&&c.dispose()}}jLj(){var a=this.oa.rf();a=this.pcb(a,this.dZ);return this.oa.pQ(a)}oLj(a){const b=this.jLj();return b&&1===b.length?b[0].vd?this.vB.Wgg(this.oa.yw()):b[0].fill&&b[0].fill.solidFillField?Ze.Box4ColorHelper.rma(b[0].fill.solidFillField,a):null:
null}nLj(a){const b=this.oa.rf();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?Ze.Box4ColorHelper.rma(b[0].lineStyle.solidFillField,a):null}ebc(a){return a?Object(gb.a)(178,a.sc(this.uA)):null}z_f(a,b){try{if(!(a&&a.USa&&a.Nk&&a.Nk.sI))return null;if(a.Nk.sI.MM()){if(!a.Nk.sI.va)return null;const l=a.Nk.sI.va.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.USa.getAttribute(Dj.a.qdc))return null;let c=a.USa.getAttribute(Dj.a.qdc).toString();
if(!c.toLowerCase().startsWith(this.x7l))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.sKe.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.VWa=!0,null)}catch(c){return ya.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static OKj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static rEj(a){if(!a)return null;const b=[];for(const c of a)c.dA&&
Array.add(b,c);return b}static QLl(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static Xqd(a){return Yt.a.parse(a.Color)}}$i.PIh=[.5,1,2.25,4.5];$i.BJl=[6350,12700,28575,57150];$i.BIh=[0,0,2,2,0,1,1];$i.xJl=[0,2,0,2,1,0,1];$i.tTf='<Menu Id="{0}">';$i.ATf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';$i.yTf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
$i.zTf="</Controls> </MenuSection>";$i.sNi='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';$i.qNi='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';$i.rNi="</Controls> </MenuSection>";$i.vNi='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';$i.tNi='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
$i.uNi="</Controls> </MenuSection>";$i.sTf="</Menu>";Object(m.a)($i,"ShapesFormatActor",null,[948]);var Lj=d(232);class hj{constructor(a,b,c){this.Ijd=Array(hj.CX);this.rgd=Array(hj.CX);this.qBe=Array(hj.CX);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.JK=a;this.rn=b;this.wld=c;this.cya={}}dispose(){Array.clear(this.Ijd);Array.clear(this.rgd);this.rn=this.JK=null;const a=Qa.a.AM(this.cya);
a.length&&appChrome.api.unregisterIcons(a);this.cya=null}get Oj(){return this.JK.MasterId}Qac(a,b,c){const f=Object.assign(new Rn.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new dl.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var u=c?"GraphicsStyleSection":"ApplyShapeStyleSection",I=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";u=
Object.assign(new gr.a,{Id:"ControlsShapeStyles",ExternalId:u,ExternalGalleryId:I,Type:4,Width:hj.CX,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,u);l=hj.CX*(a?hj.SSf:hj.WSf);c&&(l=hj.CX*hj.VSf);for(I=0;I<l;++I){const T=c?"ApplyGraphicsStyle"+I:"ApplyShapeStyle"+I;Array.add(u.GalleryItems,c?this.wfe(T,I,a,b,!0):this.wfe(T,I,a,b,!1))}return f}wfe(a,b,c,f,l){if(l){var u=this.JK?this.JK.SVGStyles[b]:null;c="SVGStyle";u=u?u.ToolTip:""}else u=this.JK?this.JK.ShapeStyles[b]:
null,c=c?"LineStyle":"ShapeStyle",u=u?this.Eke(u.StyleId):"";return Object.assign(new bG.a,{Id:a,ExternalId:a,Icon:hj.Rac(c,f,b),PreviewIconStyle:hj.PIj(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:u})}Pud(a){this.addIconToMap(this.JK.ShapeStyles,"ShapeStyle");this.addIconToMap(this.JK.LineStyles,"LineStyle");a&&this.addIconToMap(this.JK.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.cya)}YLj(a){if(a<hj.CX&&this.Ijd[a])return this.Ijd[a];if(a>=
this.JK.ShapeStyles.length)return"";var b=this.JK.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.Eke(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.ihe(this.wld.resolve(Gg.a.ozb,
b.Icon.ImgId,"StyleGallery")),l,f);a<hj.CX&&(this.Ijd[a]=b);return b}MKj(a){if(a<hj.CX&&this.qBe[a])return this.qBe[a];if(a>=this.JK.SVGStyles.length)return"";var b=this.JK.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),
l=this.Ong(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.ihe(this.wld.resolve(Gg.a.ozb,b.Icon.ImgId,"StyleGallery")),l,f);a<hj.CX&&(this.qBe[a]=b);return b}pEj(a){if(a<hj.CX&&this.rgd[a])return this.rgd[a];if(a>=this.JK.LineStyles.length)return"";var b=this.JK.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-
b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.Zkg(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.ihe(this.wld.resolve(Gg.a.ozb,b.Icon.ImgId,"StyleGallery")),l,f);a<hj.CX&&(this.rgd[a]=b);return b}Eke(a){let b=null;switch(parseInt(String(a/hj.CX))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;
break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,ZXh:c}=this.qhg(a));return String.format(b,a.toString(),c)}Ong(a){return(a=this.JK?this.JK.SVGStyles[a]:null)?a.ToolTip:""}Zkg(a){let b=null;switch(parseInt(String(a/hj.CX))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;
break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,ZXh:c}=this.qhg(a));return String.format(b,a.toString(),c)}ihe(a){return null===a?"":Aa.a.adc(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=hj.Rac(b,this.Oj,f),u={},I={};I.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);I.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);I.position="absolute";u.root=I;c=appChrome.buildImageIconFromUrl(this.wld.resolve(Gg.a.ozb,c.Icon.ImgId,"StyleGallery"),u);this.cya[l]=
c}}qhg(a){let b,c;c=b=null;a%=hj.CX;switch(a){case 0:b=Lj.Color.Fj(this.rn.Dark1);c=String.format(ResourceStrings.l_DarkFormat,1);break;case 1:b=Lj.Color.Fj(this.rn.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=Lj.Color.Fj(this.rn.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=Lj.Color.Fj(this.rn.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=Lj.Color.Fj(this.rn.Accent4);c=String.format(ResourceStrings.L_AccentFormat,
a);break;case 5:b=Lj.Color.Fj(this.rn.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=Lj.Color.Fj(this.rn.Accent6),c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,ZXh:c}}static get vIi(){return hj.VIl}static get tIi(){return hj.TIl}static get uIi(){return hj.UIl}static PIj(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;
return a}static bge(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');a*=hj.CX;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?M.a.F3b:M.a.cwb,b?M.a.btd:M.a.Ftd));c.append("</Gallery> </MenuSection>");c.append("</Menu>");
return c.toString()}static Rac(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}hj.CX=7;hj.WSf=6;hj.VSf=4;hj.SSf=3;hj.VIl=hj.bge(hj.WSf,!1);hj.UIl=hj.bge(hj.SSf,!1);hj.TIl=hj.bge(hj.VSf,!0);Object(m.a)(hj,"StyleGalleryBuilder",null,[106]);class eP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.zKb="";this.vHb=[];this.ia=a;this.Uq=b;this.uf=c;this.Fa=l;this.Eb=f;this.Kv=u;this.TJb=I;this.oa=T;this.Ga=ja;this.Xa=ua;this.dZ=Ra;eb.bC(Object(R.a)(this,this.mo,"onSessionRehydrated"));this.Xa.ULf(Object(R.a)(this,
this.Xpd,"onSessionInfoChanged"))}qb(){this.ia.pa(M.a.Ftd,wc.a.application,Object(R.a)(this,this.QYj,"handleQueryShapesStyle"),97);this.ia.pa(M.a.hYe,wc.a.application,Object(R.a)(this,this.wYj,"handlePopulateShapesStyles"),96);this.ia.pa(M.a.cwb,wc.a.application,Object(R.a)(this,this.nUj,"handleApplyShapesStyle"),4);this.ia.pa(M.a.btd,wc.a.application,Object(R.a)(this,this.OYj,"handleQueryGraphicsStyle"),97);this.ia.pa(M.a.eYe,wc.a.application,Object(R.a)(this,this.tYj,"handlePopulateGraphicsStyles"),
96);this.ia.pa(M.a.F3b,wc.a.application,Object(R.a)(this,this.bUj,"handleApplyGraphicsStyle"),4)}Sd(){}OYj(a,b,c,f,l){return this.K$f(l,!0)}QYj(a,b,c,f,l){return this.K$f(l,!1)}K$f(a,b){var c=this.Uq.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(!a||!Object(gc.a)(ax,a))return 8;var f=a.uW.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.uW.substr(f.length));if(isNaN(f)||0>f)return ya.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",
b?"Graphics":"Shapes"),8;var l=this.oa.rf();if(!l||!l.length)return 16;const u=a.e2a;if(!u)return 8;var I=c.LD(l[0].slideId);if(!I)return 16;c=I.Oj;I=this.Jjg(I);a.uW.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.zKb=(l=this.j3b(l))?"SGT_Line":"SGT_Shape",u.k5=I?I.wfe(a.uW,f,l,c,b?!0:!1):null):I?(this.j3b(l)?(this.zKb="SGT_Line",u.fGa=I.pEj(f),u.zAb=I.Zkg(f)):b?(this.zKb="SGT_SVG",u.fGa=I.MKj(f),u.zAb=I.Ong(f)):(this.zKb="SGT_Shape",u.fGa=I.YLj(f),u.zAb=I.Eke(f)),u.sW(!1)):(u.fGa="",
u.zAb="");return 32}tYj(a,b,c,f,l){return this.I$f(c,l,!0)}wYj(a,b,c,f,l){return this.oa.yXa()?8:this.I$f(c,l,!1)}I$f(a,b,c){var f=this.Uq.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return ya.a.J(509678937,822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.oa.rf();f=a[0]?f.LD(a[0].slideId):null;const l=this.Jjg(f);if(b.MenuId&&"style"===b.MenuId)this.j3b(a)?b.PopulationXML=hj.uIi:b.PopulationXML=c?hj.tIi:hj.vIi;
else{this.zKb=(a=this.j3b(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.Qac(a,f.Oj,c?!0:!1):null}return 32}bUj(a,b,c,f,l){if(md.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.pLj().length)return 8}else if(!this.Ga.Lzc(this.oa.rf()))return 16;return this.Wrg(a,c,l,!0)}pLj(){var a=this.oa.Hd();const b=[];let c=!1;for(const f of a){if(!f)return b.length=0,b;f.Rg&&(c=!0)}if(c)for(const f of a)f.Rg&&this.Ga.Lzc([f])&&b.push(f);else for(const f of a)if(this.Ga.Lzc([f]))b.push(f);
else if(f.Lf){a=this.Ga.rx(f);for(const l of a)this.Ga.Lzc([l])&&b.push(l)}return b}nUj(a,b,c,f,l){return this.dWl(this.oa.rf())?this.Wrg(a,c,l,!1):16}Wrg(a,b,c,f){var l=this.Uq.presentation;if(!l)throw Error.argumentNull("Presentation is null");const u=this.oa.rf();if(!u||!u.length||this.uf.xC(u))return 16;l=l.LD(u[0].slideId);var I=this.Kv.plg(l);if(!I)return this.Kv.m5l(l),ya.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;
if(!c)return ya.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.j3b(u)?I.LineStyles.length:I.ShapeStyles.length;I=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(I.length));if(isNaN(c)||0>c||c>=b)return ya.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===u.length?ya.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",
f?"Graphics":"Shapes",f?"SVG":"Shape"):1<u.length&&ya.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":"Shapes",u.length,f?"SVGs":"Shapes");f=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.uj()});try{f.mc(Object(gb.a)(205,l));f.Wc=a;const T=this.oa.pQ(Array.isArray(u)?u:null);for(const ja of T)ja&&ja.BTl(c,this.zKb)}finally{f&&f.dispose()}return 32}Xpd(){for(const a of this.vHb)a.dispose();Array.clear(this.vHb)}Jjg(a){const b=this.Kv.plg(a);if(!b||
!a)return ya.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.vHb)if(c.Oj===a.Oj)return c;a=new hj(b,a.Ld,this.TJb);Array.add(this.vHb,a);a.Pud(this.dZ);return a}dWl(a){if(!a||!a.length||this.Ga.WOc(a))return!1;for(const b of a)if(b.iwa)return!0;return!1}j3b(a){if(!a)return!1;for(const b of a)if(!b.dA)return!1;return!0}mo(){this.eza()}eza(){this.Kv.clearCache();for(const a of this.vHb)a.dispose();Array.clear(this.vHb)}}
Object(m.a)(eP,"ShapesStyleActor",null,[948,174]);class ex{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.Ey=this.km=-1;this.ms=a;this.ia=b;this.Fa=c;this.uf=f;this.kA=l;this.oa=u;this.Pi=I;this.Ga=T;this.XKk=ja;this.bLk=ua;this.qoa=Ra;this.Cc=eb}get Rb(){return this.oa}qb(){this.ia.pa(M.a.y3a,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.z3a,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.A3a,wc.a.application,Object(R.a)(this,
this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.gyc,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.IRb,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.rRb,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.oRb,wc.a.application,Object(R.a)(this,this.hcc,"handleFont"),5);this.ia.pa(M.a.Unb,wc.a.application,Object(R.a)(this,this.hcc,"handleFont"),5);this.ia.pa(M.a.Vnb,wc.a.application,
Object(R.a)(this,this.hcc,"handleFont"),5);this.ia.pa(M.a.p9e,wc.a.application,Object(R.a)(this,this.rYj,"handlePopulateFontNameDropdown"),97);this.ia.pa(M.a.gob,wc.a.application,Object(R.a)(this,this.hcc,"handleFont"),4);this.ia.pa(M.a.HRb,wc.a.application,Object(R.a)(this,this.hcc,"handleFont"),4);this.ia.pa(M.a.kyc,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.jyc,wc.a.application,Object(R.a)(this,this.zWa,"handleFontFormatAction"),4);this.ia.pa(M.a.Fuc,
wc.a.application,Object(R.a)(this,this.lCb,"handleQueryFontToggleButton"),97);this.ia.pa(M.a.Guc,wc.a.application,Object(R.a)(this,this.lCb,"handleQueryFontToggleButton"),97);this.ia.pa(M.a.Iuc,wc.a.application,Object(R.a)(this,this.lCb,"handleQueryFontToggleButton"),97);this.ia.pa(M.a.Huc,wc.a.application,Object(R.a)(this,this.lCb,"handleQueryFontToggleButton"),97);this.ia.pa(M.a.ytd,wc.a.application,Object(R.a)(this,this.m3c,"handleQueryFont"),100);this.ia.pa(M.a.xtd,wc.a.application,Object(R.a)(this,
this.m3c,"handleQueryFont"),100);this.ia.pa(M.a.ztd,wc.a.application,Object(R.a)(this,this.m3c,"handleQueryFont"),97);this.ia.pa(M.a.Atd,wc.a.application,Object(R.a)(this,this.m3c,"handleQueryFont"),97);this.ia.pa(M.a.Htd,wc.a.application,Object(R.a)(this,this.lCb,"handleQueryFontToggleButton"),97);this.ia.pa(M.a.Gtd,wc.a.application,Object(R.a)(this,this.lCb,"handleQueryFontToggleButton"),97)}Sd(){const a=this.Fa.Kc(xc.a.Ag);a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_Bold),M.a.y3a);a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_Italic),
M.a.z3a);a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_Underline),M.a.A3a);a.bindAction(B.KeyInputManager.Va(H.a.ZOa,B.KeyInputManager.Ze|4),M.a.gyc);a.bindAction(B.KeyInputManager.Va(H.a.JFd,B.KeyInputManager.Ze|4),M.a.IRb)}m3c(a,b,c,f,l){c=this.Rb.rf();if(!c||1>c.length)return 16;f=this.Ga.a1(c);var u=this.Rb.Fma();if(1>f.length&&!u)return 16;b=null;this.km=Date.now();u&&(b=this.Cc.Hhg(u,new Vt),this.Ey=Date.now(),ya.a.J(512500294,815,50,"Query table shape font timespan by {0}",(this.Ey-
this.km).toString()));c=u?[c[0]]:f;for(const I of c){switch(a){case M.a.ytd:case M.a.xtd:break;case M.a.ztd:c=this.kA.Cac(I.vd&&b?b.fontName:I.mTb);if(l.H0&&l.H0!==c){l.H0="";break}l.H0=c;l.kxc();break;case M.a.Atd:c="";I.vd&&b?-1!==b.fontSize&&(c=Aa.a.ZYc(b.fontSize/2,0,A.AFrameworkApplication.numberFormat)):c=I.Aca?ex.Fhg(I).toString():"";f=parseFloat(c);if(!isNaN(f)&&(u=l.H0)&&u!==c){u=Math.min(f,parseFloat(u)).toString()+"+";l.H0=u;break}l.H0=c;l.kxc();break;default:return ya.a.J(512500293,820,
10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.H0&&!l.H0.length)break}return 32}lCb(a,b,c,f,l){b=this.Rb.rf();if(!b||1>b.length)return 16;b=this.Ga.a1(b);c=this.Rb.Fma();if(1>b.length&&!c)return 16;a=c?this.Aol(c,a,new Vt):this.Gyh(b,a);l.Rf("select"===a);return"disable"!==a?32:8}hcc(a,b,c,f,l){b=this.Rb.rf();if(!b||1>b.length)return 16;const u=this.Rb.Fma();f=this.Ga.a1(b);if(1>f.length&&!u||this.uf.xC(f)||this.uf.xC([u]))return 16;if(1===c)return 32;this.Rb.uj();this.Fa.Gd();switch(a){case M.a.oRb:const T=
this.zva(l,!0);if(!T)return 8;1<b.length?ya.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):ya.a.J(512500291,815,50,"Set one shape font color.");for(const eb of b)if(eb.Lf||eb.Rg){Xn(eb);break}this.ms.Yla(eb=>{eb.sOa=T},f);break;case M.a.gob:case M.a.HRb:let ja;if(a===M.a.gob){if(ja=this.zva(l,!1),!ja)return 8}else ja="";1<b.length?ya.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):ya.a.J(512500289,815,50,"Set one shape highlight.");this.ms.Yla(eb=>{eb.highlight=ja},f);break;
case M.a.Unb:if(!l)return 8;const ua=this.kA.Cac(l);if(ua.length){1<b.length?ya.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):ya.a.J(512500259,815,50,"Set one shape font name.");var I=null;for(const eb of b)if(eb.Lf||eb.Rg)Xn(eb),eb.Lf&&(I=eb);if(1>this.Alg(f,a,ua).length)return 16;this.ms.Yla(eb=>{eb.mTb=ua},f);I&&(I.mTb=ua);this.kA.MNc(l)}break;case M.a.Vnb:l=Object(gb.a)(eG.a,l);if(!l||!l.Bd)return 8;const Ra=this.Pi.i6b(l.Bd);if(isNaN(Ra))return 8;1<b.length?ya.a.J(512500258,815,
50,"Set {0} shapes font size.",b.length):ya.a.J(512500257,815,50,"Set one shape font size.");l=null;for(I of b)if(I.Lf||I.Rg)Xn(I),I.Lf&&(l=I);if(1>this.Alg(f,a,Ra*dk.a.Fdb).length)return 16;this.ms.Yla(eb=>{eb.RNh(Ra)},f);l&&l.RNh(Ra);break;default:return ya.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}zWa(a,b,c){b=this.Rb.rf();if(!b||1>b.length)return 16;const f=this.Rb.Fma(),l=this.Ga.a1(b);if(1>l.length&&!f||this.uf.xC(l)||this.uf.xC([f]))return 16;if(1===c)return 32;
const u="select"!==this.Gyh(this.Ga.a1(b),a);this.Rb.uj();this.Fa.Gd();switch(a){case M.a.y3a:1<b.length?ya.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):ya.a.J(512500254,815,50,"Set one shape bold.");f&&Object(md.a)("FixTableModifyFontShortcut")&&this.ia.nb(M.a.bold,2);this.ms.Yla(T=>{T.isBold=u},l);break;case M.a.z3a:1<b.length?ya.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):ya.a.J(512500252,815,50,"Set one shape italic.");f&&Object(md.a)("FixTableModifyFontShortcut")&&this.ia.nb(M.a.setItalic,
2);this.ms.Yla(T=>{T.isItalic=u},l);break;case M.a.A3a:1<b.length?ya.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):ya.a.J(512500250,815,50,"Set one shape underline.");f&&Object(md.a)("FixTableModifyFontShortcut")&&this.ia.nb(M.a.underline,2);this.ms.Yla(T=>{T.VD=u},l);break;case M.a.rRb:1<b.length?ya.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):ya.a.J(512500248,815,50,"Set one shape strikethrough.");this.ms.Yla(T=>{T.zC=u},l);break;case M.a.gyc:case M.a.IRb:const I=
a===M.a.IRb?!1:!0;1<b.length?ya.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):ya.a.J(512500246,815,50,"Step one shape font size.");this.ms.Yla(T=>{T.fFb=I},l);break;case M.a.kyc:1<b.length?ya.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):ya.a.J(512500244,815,50,"Step one shape superscript.");this.ms.Yla(T=>{T.zO=u?3E4:0},l);break;case M.a.jyc:1<b.length?ya.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):ya.a.J(512500242,815,50,"Step one shape subscript.");
this.ms.Yla(T=>{T.zO=u?-25E3:0},l);break;default:return 8}return 32}rYj(a,b,c,f,l){if(1===c)return 32;yf.Font.Upe(b);l.MenuItems=Ca.FontUtils.mfg(ex.oAd,ex.bZc,this.XKk,this.qoa,this.bLk);return 32}Gyh(a,b){let c="select";for(const f of a){switch(b){case M.a.Fuc:case M.a.y3a:c=f.isBold?"select":"normal";break;case M.a.Guc:case M.a.z3a:c=f.isItalic?"select":"normal";break;case M.a.Iuc:case M.a.A3a:c=f.VD?"select":"normal";break;case M.a.Huc:case M.a.rRb:c=f.zC?"select":"normal";break;case M.a.Htd:case M.a.kyc:c=
0<f.zO?"select":"normal";break;case M.a.Gtd:case M.a.jyc:c=0>f.zO?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}Aol(a,b,c){this.km=Date.now();c=this.Cc.Hhg(a,c);switch(b){case M.a.Fuc:a=1===c.bold?"select":"normal";break;case M.a.Guc:a=1===c.italic?"select":"normal";break;case M.a.Iuc:a=1===c.underline?"select":"normal";break;case M.a.Huc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.Ey=Date.now();ya.a.J(512500241,815,50,"Query table shape font state timespan by {0}",
(this.Ey-this.km).toString());return a}Alg(a,b,c){const f=[];for(const l of a)switch(b){case M.a.y3a:l.isBold!==c&&Array.add(f,l);break;case M.a.z3a:l.isItalic!==c&&Array.add(f,l);break;case M.a.A3a:l.VD!==c&&Array.add(f,l);break;case M.a.rRb:l.zC!==c&&Array.add(f,l);break;case M.a.Unb:l.mTb!==c&&Array.add(f,l);break;case M.a.Vnb:ex.Fhg(l)!==c&&Array.add(f,l);break;case M.a.kyc:0<l.zO!==c&&Array.add(f,l);break;case M.a.jyc:0>l.zO!==c&&Array.add(f,l);break;default:ya.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",
b)}return f}zva(a,b){if(b)return b=Wg.SchemeColor.parse(a),b&&b.Hva?Jk.i(Jk.g(b.kR)):(ya.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=Yt.a.parse(a);return b&&b.RGBColor?b.RGBColor:(ya.a.J(512500238,820,10,"Color '{0}' is incorrect",a),null)}static bZc(a,b){return b}static oAd(){return!1}static Fhg(a){const b=a.F4;return qf.a.cA(b,1)?a.Aca:Math.round(a.Aca)*b}}Object(m.a)(ex,"ShapesTextFontActor",null,[948]);class fP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.Ey=this.km=-1;
this.ms=a;this.ia=b;this.Fa=c;this.uf=f;this.oa=l;this.Ga=u;this.Nhb=I;this.mN=T;this.Ub=ja;this.Eb=ua;this.fad=Ra;this.Cc=eb;this.lB=Bb}get Rb(){return this.oa}qb(){this.ia.pa(M.a.FRb,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.qRb,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.Wnb,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.GRb,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),
4);this.ia.pa(M.a.job,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.pRb,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.fyc,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.Ozd,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.jzd,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.izd,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),
4);this.ia.pa(M.a.hzd,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.gzd,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.n9e,wc.a.application,Object(R.a)(this,this.etg,"handleQueryLineSpacing"),4);this.ia.pa(M.a.Rxc,wc.a.application,Object(R.a)(this,this.z$,"handleFormatAction"),4);this.ia.pa(M.a.$lb,wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.amb,wc.a.application,Object(R.a)(this,this.AWa,
"handleQueryToggleButton"),97);this.ia.pa(M.a.a2a,wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.b2a,wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.Ctd,wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.wtd,wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.Etd,wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.Btd,
wc.a.application,Object(R.a)(this,this.AWa,"handleQueryToggleButton"),97);this.ia.pa(M.a.Ktd,wc.a.application,Object(R.a)(this,this.$me,"handleQueryTextAnchoring"),97);this.ia.pa(M.a.Jtd,wc.a.application,Object(R.a)(this,this.$me,"handleQueryTextAnchoring"),97);this.ia.pa(M.a.Itd,wc.a.application,Object(R.a)(this,this.$me,"handleQueryTextAnchoring"),97);this.ia.pa(M.a.Dtd,wc.a.application,Object(R.a)(this,this.etg,"handleQueryLineSpacing"),97)}Sd(){const a=this.Fa.Kc(xc.a.Ag);a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_FullJustify),
M.a.pRb);a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_CenterJustify),M.a.GRb);E.a.Fl?(a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_LeftJustify_Mac),M.a.Wnb),a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_RightJustify_Mac),M.a.job)):(a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_LeftJustify),M.a.Wnb),a.bindAction(B.KeyInputManager.vx(ResourceStrings.l_HK_RightJustify),M.a.job))}AWa(a,b,c,f,l){const u=this.Rb.rf();if(!u||1>u.length)return 16;b=this.Rb.Fma();const I=
this.Ga.a1(u);if(1>I.length&&!b)return 16;f=c=null;let T=a===M.a.$lb?1:a===M.a.amb?2:18;Object(gc.a)(Di.a,l)?f=l:Object(gc.a)(ax,l)&&(f=l.e2a,T=l.menuItemId);l=b?[u[0]]:I;this.km=Date.now();for(const ja of l){switch(a){case M.a.$lb:c=ja.vd?this.rle(T,a):this.Ake(T,ja,a);break;case M.a.amb:c=ja.vd?this.rle(T,a):this.Ake(T,ja,a);break;case M.a.a2a:case M.a.b2a:c=ja.vd?this.rle(T,a):this.Ake(T,ja,a);break;case M.a.Ctd:c=ja.vd?1===this.Cc.m_c(b)?"select":"normal":1===ja.tm?"select":"normal";break;case M.a.wtd:c=
ja.vd?2===this.Cc.m_c(b)?"select":"normal":2===ja.tm?"select":"normal";break;case M.a.Etd:c=ja.vd?3===this.Cc.m_c(b)?"select":"normal":3===ja.tm?"select":"normal";break;case M.a.Btd:c=ja.vd?6===this.Cc.m_c(b)?"select":"normal":4===ja.tm?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Rf("select"===c);this.Ey=Date.now();b&&ya.a.J(512500237,815,50,"Query table shape timespan by {0}",(this.Ey-this.km).toString());return"disable"!==c?32:8}Ake(a,b,c){return c===M.a.a2a||c===M.a.$lb||
c===M.a.b2a||c===M.a.amb?this.mN.nPf(b,a)?"select":"normal":"normal"}rle(a,b){var c=!0,f=this.Rb.Fma();f=$d.SelectionFactory.ITc(Object(gb.a)(Zg.a,f));for(const l of f){if(c=l.El?l.node:null)if(f=this.Ub.Pc(c),f.set(c),f.uc(11),f.Ug(11),c=this.lB.Aw(f)){if(0===a){c=!1;break}if(b===M.a.$lb)c=1===c.listType;else if(b===M.a.amb)c=0===c.listType;else if(b===M.a.a2a){f=this.mN.FYa.ga(a).u4b;const u=this.mN.FYa.ga(a).Kwb;c=c.rCb&&0<c.caa.length&&c.caa[0]===f&&c.udb&&c.font===u}else b===M.a.b2a?(f=this.mN.Snd.ga(a).K1d,
c=!!c.propertySet&&c.propertySet.Qa(yb.a.autonumberBulletType)&&c.propertySet.$a(yb.a.autonumberBulletType)===f):c=!1}else c=0===a?b===M.a.a2a||b===M.a.b2a?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}z$(a,b,c,f,l){f=this.Rb.rf();if(!f||1>f.length)return 16;b=this.Ga.a1(f);const u=this.Rb.Fma(),I=!!u&&(a===M.a.fyc||a===M.a.Ozd);if(!b.length&&!u||I||this.uf.xC(b)||this.uf.xC([u]))return 16;if(1===c)return 32;this.Rb.uj();a!==M.a.Rxc&&this.Fa.Gd();switch(a){case M.a.FRb:case M.a.qRb:if(Object.getType(l)!==
Number)return 8;this.yTl(f,b,l);break;case M.a.Wnb:case M.a.GRb:case M.a.job:case M.a.pRb:var T=this.C4f(b);this.wTl(b,a,l);T&&this.oa.selectShape(T,!1);$c.a.CQ(!0,!1);break;case M.a.fyc:case M.a.Ozd:l=[];const ja=a===M.a.fyc?1:2;for(T of b)Array.add(l,T);1<f.length?ya.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):ya.a.J(512500235,815,50,"Set one shape text direction.");this.ms.gbb(Ra=>{if(Ra=Object(gb.a)(4,Ra))Ra.lTb=ja},l);break;case M.a.Rxc:if(!l||!Object(gc.a)(Array,l)||1>l.length)return 8;
$c.a.Kb&&($c.a.Kb.tk=!0);b=this.Eb.ud(15);try{for(b.mc(l[0].hT),b.Wc=a,a=0;a<l.length;a++)l[a].hT.dla=l[a].Cba.left,l[a].hT.ela=l[a].Cba.right,l[a].hT.fla=l[a].Cba.top,l[a].hT.bla=l[a].Cba.bottom}finally{b&&b.dispose()}$c.a.CQ(!0,!1);break;case M.a.jzd:case M.a.izd:case M.a.hzd:l=[];let ua=1;switch(a){case M.a.jzd:ua=0;break;case M.a.izd:ua=1;break;case M.a.hzd:ua=2}for(const Ra of b)Array.add(l,Ra);ya.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",f.length);this.ms.gbb(Ra=>{if(Ra=Object(gb.a)(4,
Ra))Ra.pra=ua},l);$c.a.CQ(!0,!1);break;case M.a.gzd:if(!l||Object.getType(l)!==Number)return 8;T=this.C4f(b);this.xTl(b,l,a);T&&this.oa.selectShape(T,!1);$c.a.CQ(!0,!1);break;default:return 8}return 32}$me(a,b,c,f,l){b=this.Rb.rf();if(!b||1>b.length)return 16;b=this.Rb.b0c(b);c=b.eFb;let u=0;const I=this.Rb.Fma();if(!c&&!I)return 16;c=null;switch(a){case M.a.Ktd:c=I?(()=>{let T=this.Cc.Tff(I);({oza:u}=T);return T})().returnValue&&0===u?"select":"normal":0===b.pra?"select":"normal";break;case M.a.Jtd:c=
I?(()=>{let T=this.Cc.Tff(I);({oza:u}=T);return T})().returnValue&&1===u?"select":"normal":1===b.pra?"select":"normal";break;case M.a.Itd:c=I?(()=>{let T=this.Cc.Tff(I);({oza:u}=T);return T})().returnValue&&2===u?"select":"normal":2===b.pra?"select":"normal";break;default:c="disable"}l.Rf("select"===c);return"disable"!==c?32:8}etg(a,b,c,f,l){c=this.Rb.rf();if(!c||1>c.length)return 16;b=this.Rb.Fma();c=this.Ga.a1(c);if(!c.length&&!b)return 16;this.km=Date.now();switch(a){case M.a.n9e:break;case M.a.Dtd:a=
new SO.a;a.unit=2;a.value=l.MenuItemId;f=!0;b&&(f=this.HZl(b,l),this.Ey=Date.now(),ya.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.Ey-this.km).toString()));for(const u of c){b=this.Ga.zke(u);if(!b||!this.Nhb.tPf(b,a)){f=!1;break}this.fad&&2===b.unit&&(b.value=Math.max(0,b.value-this.Ga.Ufe(u)))}l.queryResult.Rf(f);break;default:return 8}return 32}xTl(a,b,c){const f=this.Eb.ud(15);try{f.mc(a[0]);f.Wc=c;for(const l of a)l.Vua();this.ia.Ia(M.a.Ypa,2,b)}finally{f&&f.dispose()}}wTl(a,
b,c){const f=[];let l=0,u=0;switch(b){case M.a.Wnb:l=1;u=G.a.ega;break;case M.a.GRb:l=2;u=G.a.rea;break;case M.a.job:l=3;u=G.a.pia;break;case M.a.pRb:l=4,u=G.a.Yua}a=this.oa.pQ(a);for(const I of a)I.tm!==l&&Array.add(f,I);if(u&&f.length){for(const I of a)if(I.Lf||I.Rg){Xn(I);break}a=this.Eb.ud(15);try{a.mc(f[0]);for(const I of f)I.Vua(),I.mUl(l);this.ia.Ia(u,2,c)}finally{a&&a.dispose()}}}yTl(a,b,c){const f=[];let l=1===c||2===c;for(const I of b)this.mN.nPf(I,c)||(l=!1,Array.add(f,I));1<a.length?ya.a.J(512500231,
815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):ya.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const I of a)if(I.Lf||I.Rg){Xn(I);break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const u=this.mN.FYa.ga(c);0<a.length&&this.ms.gbb(I=>{I.setValue(yb.a.w4a,c);u&&(I.setValue(yb.a.HXh,u.Kwb),I.setValue(yb.a.GXh,u.u4b))},a)}HZl(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=$d.SelectionFactory.ITc(Object(gb.a)(Zg.a,a));for(const u of a){if(a=
u.El?u.node:null){a=this.Nhb.dY(a);const I=qf.a.cA(a.lineSpacing.value,f)&&2===a.lineSpacing.unit;if(-1===l)b=a.lineSpacing.unit,l=a.lineSpacing.value;else if(l!==a.lineSpacing.value||b!==a.lineSpacing.unit)l=b=0,c=!1;0!==b&&(c=I)}if(!c)break}return c}C4f(a){return 0<a.length&&a[0].Rg&&(a=this.Ga.zt(a[0]))?(this.oa.T9(a),a):null}}Object(m.a)(fP,"ShapesTextParagraphActor",null,[948]);var iT=d(697);class gP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.ia=a;this.uf=b;this.Eb=c;this.fB=f;this.Fa=
l;this.oa=u;this.Yb=I;this.sa=T;this.Tb=ja;this.Ba=ua;this.ks=Ra;this.yb=eb;this.jHk=Ub;if(!Bb)throw Error.argumentNull("GraphOperationEventHandler is null");this.Wf=Bb}qb(){this.ia.pa(M.a.deleteObject,ta.a.application,Object(R.a)(this,this.lVj,"handleDelete"),4);this.Ba.podsEnableSlideScoreCard&&this.ia.pa(M.a.Iyh,Le.a.frame,Object(R.a)(this,this.vkm,"updateSlideScore"),96);this.ia.pa(M.a.Iae,wc.a.application,Object(R.a)(this,this.DVj,"handleDuplicate"),4);this.ia.pa(M.a.YJf,wc.a.application,Object(R.a)(this,
this.ETj,"handleAddFirstSlide"),4);this.Ba.fok?(this.ia.pa(M.a.QJ,ta.a.application,Object(R.a)(this,this.uVj,"handleDeleteSlides"),4),this.ia.pa(M.a.uR,wc.a.application,Object(R.a)(this,this.GVj,"handleDuplicateSlides"),4),this.Ba.joe?(this.ia.pa(M.a.Scc,wc.a.application,Object(R.a)(this,this.tWj,"handleHideSlides"),4),this.ia.pa(M.a.Ngf,wc.a.application,Object(R.a)(this,this.f0j,"handleUnhideSlides"),4),this.Wf.F9a(Object(R.a)(this,this.m3l,"slidesSelectionChangedHandler"))):this.ia.pa(M.a.Scc,wc.a.application,
Object(R.a)(this,this.Lme,"handleHideSlidesOld"),4),this.ia.pa(M.a.Ntd,ta.a.application,Object(R.a)(this,this.TYj,"handleQuerySlidesHidden"),96)):(this.ia.pa(M.a.QJ,ta.a.application,Object(R.a)(this,this.tVj,"handleDeleteSlide"),4),this.ia.pa(M.a.uR,wc.a.application,Object(R.a)(this,this.FVj,"handleDuplicateSlide"),4),this.ia.pa(M.a.Scc,wc.a.application,Object(R.a)(this,this.sWj,"handleHideSlide"),4),this.ia.pa(M.a.Ntd,ta.a.application,Object(R.a)(this,this.SYj,"handleQuerySlideHidden"),96));this.ia.pa(M.a.W9d,
ta.a.application,Object(R.a)(this,this.nVj,"handleDeleteFakeSlides"),2048);this.ia.pa(M.a.XWf,ta.a.application,Object(R.a)(this,this.TUj,"handleClearAndResizeSlideCanvas"),2048);this.ia.xa(M.a.Uzd,wc.a.application,Object(R.a)(this,this.m_j,"handleShareSlide"));this.ia.pa(M.a.n0e,ta.a.application,Object(R.a)(this,this.Pme,"handleIsDirectManipulationEnabled"),97)}Sd(){const a=this.Fa.Kc(yj.a.XE);a.bindAction(B.KeyInputManager.Va(H.a.Qca,0),M.a.QJ);a.bindAction(B.KeyInputManager.Va(H.a.eG,0),M.a.QJ);
a.bindAction(B.KeyInputManager.Va(H.a.jPa,B.KeyInputManager.Ze),M.a.uR)}lVj(a,b,c,f,l){if(this.Fa.Je)if(this.Fa.N9===yj.a.XE||1===this.yb.$i||this.Ba.Cm&&this.Fa.N9===xc.a.KB)a=M.a.QJ;else if(this.Fa.N9===xc.a.Ag)a=M.a.I$a;else return 8;else return 8;return this.ia.Ia(a,c,l)}tVj(a,b,c){b=this.sa.Aa;if(!b||this.uf.Xc(b)||this.Ba.RD&&1!==this.oa.Xe().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;$c.a.Kb&&($c.a.Kb.actionName="DeleteSlide",$c.a.Kb.gq=!1,$c.a.Kb.tk=!0,$c.a.Kb.Wa("SlideCount",
"1"));c=this.Yb.Of;if(!c)return 16;const f=this.Eb.ud(15,void 0,()=>{this.oa.Bh()});try{f.mc(c),f.Wc=a,c.QJ(b)}finally{f&&f.dispose()}this.uf.mx(c,a);a=[];a.push(b);this.ks?this.ks.rud(new fC.a(a)):ya.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}TUj(a,b,c){a=this.Tb.oy(this.sa.V9c?this.sa.V9c.slideIndex:0);if(!a)return ya.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(gb.a)(227,a.sc(this.yb.Na));if(!a)return ya.a.J(512313373,
822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;ya.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.n8e(!1);a.updateOffSlideView(0,!0);return 32}nVj(a,b,c){b=[];for(const f of this.Tb.hGa())f.hP&&Array.add(b,f);if(!b.length||!this.sa.Aa)return ya.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;ya.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.y4f(b,"DeleteFakeSlide",
a)}uVj(a,b,c){b=this.oa.Xe();if(!b||!b.length||!this.sa.Aa)return 16;for(const f of b)if(!f||this.uf.Xc(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;return this.y4f(b,"DeleteSlide",a)}y4f(a,b,c){$c.a.Kb&&($c.a.Kb.actionName=b,$c.a.Kb.gq=!1,$c.a.Kb.tk=!0,$c.a.Kb.Wa("SlideCount",a.length.toString()));1<a.length?ya.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):ya.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Yb.Of;
if(!b)return 16;this.$$i(b,a,c,()=>{this.oa.Bh()});return 32}$$i(a,b,c,f){f=this.Eb.ud(15,void 0,f);try{f.mc(a);for(const l of b)l&&!l.Fb.equals(this.sa.Aa.Fb)&&a.QJ(l);a.QJ(this.sa.Aa);this.Ba.getBooleanAppSetting("CopilotDesignerEnableMetricsTracker")&&this.jHk.wpl();f.Wc=c}finally{f&&f.dispose()}this.Ba.unblockContentWhenDeletingSlideEnabled||this.uf.mx(a,c);this.ks?this.ks.rud(new fC.a(b)):ya.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}SYj(a,
b,c,f,l){a=this.sa.Aa;if(!a)return 16;l.Rf(a.Hn);return 32}TYj(a,b,c,f,l){a=this.oa.Xe();if(!a||!a.length)return 16;a=this.W0d(a);l.Rf(a);return 32}m_j(a,b,c,f,l){a=this.sa.Aa;if(!a||this.uf.Xc(a)||1!==this.oa.Xe().length)return 16;if(1===c)return 32;$c.a.Kb&&($c.a.Kb.gq=!1,$c.a.Kb.Wa("SlideCount","1"));c=a.Fb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=iT.a(c);l.mode="copy";ya.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.Ia(N.a.bfa,2,l);return 32}sWj(a,b,
c){b=this.sa.Aa;if(!b||this.uf.Xc(b)||this.Ba.RD&&1!==this.oa.Xe().length)return 16;if(1===c)return 32;$c.a.Kb&&($c.a.Kb.gq=!1,$c.a.Kb.Wa("SlideCount","1"));c=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{1!==this.yb.$i&&(this.Ba.Cm?this.Fa.Df(xc.a.KB):this.Fa.Df(yj.a.XE))});try{c.mc(b),c.Wc=a,b.Hn=!b.Hn}finally{c&&c.dispose()}return 32}Lme(a,b,c){b=this.oa.Xe();if(!b||!b.length)return 16;for(var f of b)if(!f||this.uf.Xc(f))return 8;if(1===c)return 32;ya.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",
b.length);$c.a.Kb&&($c.a.Kb.gq=!1,$c.a.Kb.Wa("SlideCount",b.length.toString()));c=!this.W0d(b);f=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{1!==this.yb.$i&&(this.Ba.Cm?this.Fa.Df(xc.a.KB):this.Fa.Df(yj.a.XE))});try{f.mc(this.Yb.Of);f.Wc=a;for(const l of b)l.Hn=c}finally{f&&f.dispose()}return 32}tWj(a,b,c,f,l){const u=this.oa.Xe();if(!u||!u.length)return 16;for(const I of u)if(!I||this.uf.Xc(I))return 8;if(this.W0d(u))return this.w3c(),32;this.Lme(a,b,c,f,l);this.w3c();return 32}f0j(a,
b,c,f,l){const u=this.oa.Xe();if(!u||!u.length)return 16;for(const I of u)if(!I||this.uf.Xc(I))return 8;if(1===c)return 32;this.Lme(a,b,c,f,l);this.w3c();return 32}w3c(){var a=this.oa.Xe();if(a&&a.length){for(var b of a)if(!b||this.uf.Xc(b))return;if(fh.c()){b=!0;for(const c of a)if(!c.Hn){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else ya.a.J(512313362,
822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}m3l(){this.w3c()}vkm(a,b,c,f,l){if(1===c)return 32;this.sa.Aa&&(a="Slide Complex: "+this.sa.Aa.ra(yb.a.yqa,0).toString(),l[xq.a.Value]=a,l[bn.a.labelText]=a,l[xq.a.Visible]=!0);return 32}DVj(a,b,c,f,l){if(this.Fa.Je)if(this.Fa.N9===yj.a.XE)a=M.a.uR;else if(this.Fa.N9===xc.a.Ag)a=M.a.Sab;else return 8;else return 8;return this.ia.Ia(a,c,l)}FVj(a,b,c){b=this.sa.Aa;if(!b||this.uf.Xc(b)||this.Ba.RD&&1!==this.oa.Xe().length)return 16;if(1===
c)return 32;$c.a.Xk("SlideCount","1");this.fB.ljj(b,a).nP||this.uf.mx(this.Yb.Of,a);return 32}GVj(a,b,c){b={};b.ST=(new Date).getTime();const f=this.oa.Xe();if(!f||!f.length)return 16;for(var l of f)if(!l||this.uf.Xc(l))return 16;if(1===c)return 32;1<f.length?ya.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",f.length):ya.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");b.TBA=(new Date).getTime();$c.a.Xk("SlideCount",f.length.toString());c=this.fB.A$f(f,
a,null,null,!0);b.TAA=(new Date).getTime();l=!0;for(const u of c)if(!u.nP){l=!1;break}l||this.uf.mx(this.Yb.Of,a);b.ET=(new Date).getTime();b.ACT=ff.ActionManager.Xda(a);b.FUNC="SlideActor::handleDuplicateSlides";ya.a.J(508359425,813,50,Qa.a.toJSON(b));return 32}ETj(){try{ya.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");const a=this.Tb.YJ();a&&0<a.length&&this.fB.lXc(null,a[0].Id,this.Ba.tgc?0:a[0].ContentMasters[0].Id,M.a.FLb);return 32}catch(a){return ya.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",
a),8}}Pme(a,b,c,f,l){return l&&Object(gc.a)(Vh.a,l)?this.uf.Xc(this.Tb.Qk(l))?16:32:8}W0d(a){for(const b of a)if(!b.Hn)return!1;return!0}}Object(m.a)(gP,"SlideActor",null,[948]);var jT=d(1180);const BG=()=>{appChrome.PRIToastManager.dismissToast()};class CG{constructor(a,b,c){this.slideId=a;this.iVk=b;this.v_i=c}}Object(m.a)(CG,"NewSlideWithLayoutData",null,[]);class Mj{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.Cxa=0;this.bed={};this.Sah=this.Tah=0;this.pHa={};this.ia=a;this.ic=b;this.Fa=
c;this.fLk=Mj.zhk(f);this.oa=l;this.Eb=u;this.fB=I;this.Yb=T;this.sa=ja;this.Tb=ua;this.eEe=Ra;this.Kv=eb;this.Kv.nOc(Object(R.a)(this,this.lrh,"openIgnoredDialog"));this.Ba=Bb;this.TJb=Ub;this.cya={}}qb(){this.Ba.eok?this.ia.pa(M.a.lla,wc.a.application,Object(R.a)(this,this.Ctg,"handleSlidesChangeLayout"),4):this.ia.pa(M.a.lla,wc.a.application,Object(R.a)(this,this.KUj,"handleChangeLayout"),4);this.ia.pa(M.a.ypa,wc.a.application,Object(R.a)(this,this.Ssg,"handleNewSlideWithLayoutOptions"),4);this.ia.pa(M.a.m7,
wc.a.application,Object(R.a)(this,this.Rsg,"handleNewSlideWithDefaultLayout"),4);this.ia.pa(M.a.FLb,wc.a.application,Object(R.a)(this,this.Rsg,"handleNewSlideWithDefaultLayout"),4);this.ia.pa(M.a.pnd,wc.a.application,Object(R.a)(this,this.GXj,"handleNewSlideWithLayout"),4);this.ia.pa(M.a.lNb,wc.a.application,Object(R.a)(this,this.Ssg,"handleNewSlideWithLayoutOptions"),4);this.ia.pa(M.a.B5c,wc.a.application,Object(R.a)(this,this.qZj,"handleReactInsertSlideWithLayout"),4);this.ia.pa(M.a.bYe,wc.a.application,
Object(R.a)(this,this.Ctg,"handleSlidesChangeLayout"),4);this.ia.pa(M.a.j4d,wc.a.application,Object(R.a)(this,this.pZj,"handleReactChangeSlideLayout"),4);this.ia.pa(M.a.itd,wc.a.application,Object(R.a)(this,this.itd,"queryNewSlideLayout"),4);this.ia.pa(M.a.v_e,wc.a.application,Object(R.a)(this,this.v_e,"queryChangeSlideLayout"),4)}Sd(){const a=this.Fa.Kc(yj.a.XE),b=this.Fa.Kc(yj.a.H4),c=this.Fa.Kc(xc.a.Ag),f=this.Fa.Kc(xc.a.wR);a.bindAction(B.KeyInputManager.Va(H.a.Mp,0),M.a.m7);a.bindAction(B.KeyInputManager.Va(H.a.OBa,
B.KeyInputManager.Ze),M.a.m7);c.bindAction(B.KeyInputManager.Va(H.a.OBa,B.KeyInputManager.Ze),M.a.m7);b.bindAction(B.KeyInputManager.Va(H.a.OBa,B.KeyInputManager.Ze),M.a.m7);f.bindAction(B.KeyInputManager.Va(H.a.OBa,B.KeyInputManager.Ze),M.a.m7)}Cyc(){return this.fLk||this.Tb.xne()}KUj(a,b,c){const f=this.sa.Aa;if(!f||this.ic.Xc(f)||this.Ba.RD&&1!==this.oa.Xe().length)return 16;a=f.Oj;if(!a)return 8;b=this.Tb.YJ();if(!this.Ba.iYa){if(!b)return ya.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),
8;if(!this.lqb(b,a))return 8}if(1===c)return 32;if((!this.Ba.iYa||b&&this.lqb(b,a))&&this.Kv.dQ.Ib(a)&&this.Hze()){this.Cxa=0;c=f.xo;if(!c)return ya.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.eEe.D7d(0,this.Tb.Bw(),b,this.Kv.dQ,a,Object(R.a)(this,this.j4d,"changeSlideLayout"),this.Cyc(),A.AFrameworkApplication.isRtl).NAd(c)}else ya.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.Kv.Gbf(a),
this.Cxa=M.a.lla;return 32}Ctg(a,b,c,f,l){b=this.oa.Xe();if(!b||!b.length)return 8;f=0;const u=[],I=this.Tb.YJ();if(!I)return ya.a.J(512500226,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var T of b){if(this.ic.Xc(T)||!T)return 16;f=T.Oj;if(!f)return ya.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;u.push(f);if(!this.Ba.iYa&&!this.lqb(I,f))return ya.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),
8}if(1===c&&!this.Ba.j2a)return 32;for(const ja of u)if(this.Ba.iYa&&!this.lqb(I,f)||!this.Kv.dQ.Ib(ja)){ya.a.J(512500195,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.Kv.Gbf(f);if(this.Ba.j2a)return this.ine(a,c,()=>{this.Kv.nOc(BG)},l);this.Cxa=M.a.lla;return 32}T=this.Cxa=0;for(const ja of b)if(T=ja.xo,!T)return ya.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?ya.a.J(512500193,
822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):ya.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(T=0);if(!this.Hze())return ya.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),md.a("RaiseFirstMasterRetrievedEvent")?this.ine(a,c,()=>{this.Kv.Xyi(BG)},l):8;if(this.Ba.j2a){if(1===c)return 32;if(!l)return 8;this.Sah=T;this.Yrd(l,I,f,!0)}else this.eEe.D7d(0,this.Tb.Bw(),I,this.Kv.dQ,f,Object(R.a)(this,this.NVf,
"changeSlidesLayout"),this.Cyc(),A.AFrameworkApplication.isRtl).NAd(T);return 32}j4d(a,b){const c=this.sa.Aa;if(c){var f=()=>{this.Fa.Gd();this.oa.Bh()},l=()=>{this.Fa.Df(yj.a.XE)};a=parseInt(a);b=parseInt(b);if(a!==c.Oj||b!==c.xo){const u=$c.a.Kb;$c.a.lEd("ChangeSlideLayout");$c.a.Kb&&($c.a.Kb.gq=!0,$c.a.Kb.Wa("SlideCount","1"));f=this.Eb.ud(15,void 0,f,l);try{f.mc(c),f.Wc=M.a.lla,c.Oj=a,c.xo=b}finally{f&&f.dispose()}this.ic.mx(c,"ChangeSlideLayout");$c.a.Kb=u}}}NVf(a,b){const c=this.oa.Xe();if(c&&
c.length){a=parseInt(a);b=parseInt(b);var f=$c.a.Kb;$c.a.lEd("ChangeSlidesLayout");$c.a.Kb.gq=!0;var l=[];for(var u of c)a===u.Oj&&b===u.xo||l.push(u);if(l.length){$c.a.Xk("SlideCount",l.length.toString());u=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},()=>{this.Fa.Df(yj.a.XE)});try{u.mc(this.sa.Aa);u.Wc=M.a.lla;for(const I of l)I.Oj=a,I.xo=b}finally{u&&u.dispose()}for(const I of c)this.ic.mx(I,"ChangeSlidesLayout");$c.a.Kb=f}}}pZj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{const u=
l.SourceControlId;let I,T;if(!(()=>{let ja=this.kgf(u);({masterId:I,layoutId:T}=ja);return ja})().returnValue)return 8;ya.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.NVf(I,T)}catch(u){return ya.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",u),8}return 32}Ssg(a,b,c,f,l){f=this.Yb.Of;if((b=this.sa.Aa)&&this.ic.Xc(b)||this.ic.Xc(f))return ya.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),
16;f=this.Tb.YJ();if(!f||!f.length)return ya.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let u=0;if(b){if(u=b.Oj,!u)return ya.a.J(512500185,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else u=f[0].Id;let I=0;({Oj:u,xo:I}=this.z_c(f,b));if(!this.Ba.iYa&&!this.lqb(f,u))return ya.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Tb.Hi())return 8;
if(!this.Ba.j2a)return 32}if(this.Ba.iYa&&!this.lqb(f,u)||!this.Kv.dQ.Ib(u)||!this.Hze()){ya.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.Kv.Gbf(u);if(this.Ba.j2a)return this.ine(a,c,()=>{this.Kv.nOc(BG)},l);this.Cxa=M.a.ypa}else if(this.Cxa=0,this.Ba.j2a){if(1===c)return 32;if(!l)return 8;this.Tah=I;this.Yrd(l,f,u,!1)}else this.eEe.D7d(1,this.Tb.Bw(),f,this.Kv.dQ,u,Object(R.a)(this,this.B5c,"insertSlideWithLayout"),this.Cyc(),
A.AFrameworkApplication.isRtl).NAd(I);return 32}Yrd(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=md.a("ReactSlideLayoutSectionsAPIEnabled")?this.Qac(b,c,f):this.yJj(b,c,f));ya.a.J(512500182,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}nke(){const a=this.Tb.Bw();if(!a||!a.width||!a.height)return ya.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new Rr.a(Mj.nTf,Mj.ZMi);const b=Mj.nTf;return new Rr.a(b,a.height/a.width*b)}h0c(){const a=
{},b={},c=this.nke();b.root=this.n8d(c.width+Mj.vTf,c.height+Mj.vTf+Mj.RMi+Mj.gNi);b.flexContainer={flexDirection:"column"};b.label={"margin-top":"5px","max-width":"100px","font-size":"10px"};a.galleryButtonInExpanded=b;return a}n8d(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}yJj(a,b,c){this.Pud();const f=Object.assign(new Rn.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,u=!1;const I=a.length;if(!I||
1===I&&a&&a[0]&&!a[0].InContent)return f;for(var T=0;T<I;T++)a[T].Id===b&&(l=T,u=!0);u&&(b=this.tlg(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<I;b++)u&&b===l||(T=this.tlg(a[b],a[b].Id,c,b),Array.add(f.MenuSectionList,T));return f}tlg(a,b,c,f){const l=Object.assign(new dl.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.Kv.dQ&&this.Kv.dQ.Ib(a.Id)))return l;var u=this.h0c(),I=c?"ChangeLayout":"NewSlide",T=c?"ChangeLayoutControls":"NewSlideLayoutControls";Mj.ild++;f=md.a("ReactSlideLayoutUniqueIdFix")?
f.toString():b.toString()+"_"+Mj.ild.toString();u=Object.assign(new gr.a,{Id:T,ExternalId:I+"_"+f,Type:4,Title:a.Name,GalleryStyle:u,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return l;I=a.length;for(T=0;T<I;T++)f=a[T],!f||!this.Cyc()&&this.Tb.ueb(f)||Array.add(u.GalleryItems,this.AAb(f,b,c));Array.add(l.ControlList,u);return l}bUi(){try{const a=[],b=this.cya;for(const c in b)a.push(c);this.cya={};this.bed={};appChrome.api.unregisterIcons(a)}catch(a){ya.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",
a)}}Pud(){this.bUi();try{const a=this.Tb.YJ();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.Kv.dQ&&this.Kv.dQ.count&&this.Kv.dQ.Ib(c.Id)&&this.addIconToMap(this.Kv.dQ.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.cya)}}catch(a){ya.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",a)}}Rac(a,b){a=String.format("{0}_{1}_{2}",Mj.a6j,a,b);a in this.bed||(Mj.ild++,this.bed[a]=a+"_"+Mj.ild.toString());return this.bed[a]}addIconToMap(a,
b){if(this.sa.Aa&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.Rac(b,c.LayoutId),u={},I={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(I.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),A.AFrameworkApplication.isRtl&&md.a("ReactSlideLayoutRTLFix")?I.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):I.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left));I.position="absolute";const T={},ja={},ua=this.nke();ja.height=ua.height.toString()+"px";ja.width=ua.width.toString()+
"px";ja.position="relative";ja.overflow="hidden";ja.display="inline-block";T.root=ja;u.root=I;this.TJb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.TJb.resolve(Gg.a.ozb,c.Icon.ImgId,Mj.UNi),u,T),this.cya[l]=c)}}Qac(a,b,c){this.Pud();const f=Object.assign(new Rn.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});var l=Object.assign(new dl.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":
"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var u=this.h0c();u=Object.assign(new gr.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:u,Width:3,Type:4,GallerySections:[]});Array.add(l.ControlList,u);l=0;let I=!1;const T=a.length;ya.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",T);if(!T||1===T&&a&&a[0]&&
!a[0].InContent)return ya.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,T,1===T&&!!a&&!!a[0]&&a[0].InContent),f;for(var ja=0;ja<T;ja++)a[ja].Id===b&&(l=ja,I=!0);I&&(b=this.Yuh(a[l],b,c),u.GallerySections.push(b));for(b=0;b<T;b++)I&&b===l||(ja=this.Yuh(a[b],a[b].Id,c),u.GallerySections.push(ja));return f}Yuh(a,b,c){const f=Object.assign(new jT.a,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});
if(!(a.InContent&&this.Kv.dQ&&this.Kv.dQ.Ib(a.Id)))return ya.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.Kv.dQ&&this.Kv.dQ.Ib(a.Id)),f;a=a.ContentMasters;if(!a)return ya.a.J(512500175,822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;
for(let u=0;u<l;u++){const I=a[u];!I||!this.Cyc()&&this.Tb.ueb(I)||Array.add(f.GalleryButtons,this.AAb(I,b,c))}return f}nGa(a,b,c){return md.a(Mj.KVf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}AAb(a,b,c){const f=a.Id,l=this.nGa(b.toString(),f.toString(),c),u={},I={},T=this.nke();I.width=T.width.toString()+"px";I.height=T.height.toString()+"px";md.a("ReactNewSlideLayoutIconBorderFix")||(I.border="#858585 1px solid");u.root=I;return Object.assign(new bG.a,{Id:l,ExternalId:l,
Icon:this.Rac(b,f),Command:c?"3430900587":"1579226270",QueryCommand:md.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:u,Alt:a.Name})}Rsg(a,b,c){this.pHa={};this.pHa.ST=(new Date).getTime();if(this.ic.iP(this.Yb.Of))return 16;b=this.Tb.YJ();if(!b)return 8;let f=null;if(this.Ba.RD){const I=this.oa.Xe();1<=I.length&&(I.sort((T,ja)=>T.ve-ja.ve),a!==M.a.FLb&&(f=I[I.length-1]))}else a!==M.a.FLb&&(f=this.sa.Aa);if(this.ic.Xc(f))return 16;const {Oj:l,xo:u}=
this.z_c(b,this.sa.Aa);if(!this.lqb(b,l))return 8;if(1===c)return 32;this.pHa.TBA=(new Date).getTime();c=this.fB.lXc(Object(gb.a)(205,f),l,u,a);this.pHa.TAA=(new Date).getTime();this.kKf(l,u);c.nP||this.ic.mx(c,a);this.pHa.ET=(new Date).getTime();this.pHa.ACT=ff.ActionManager.Xda(a);this.pHa.FUNC="SlideLayoutActor::handleNewSlideWithDefaultLayout";this.UDk();return 32}GXj(a,b,c,f,l){if(this.ic.iP(this.Yb.Of))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.iVk;l=l.v_i;f=null;this.Ba.RD?
(c=this.oa.Xe(),1<=c.length&&(c.sort((u,I)=>u.ve-I.ve),f=c[c.length-1])):f=this.Tb.Qk(c);c=this.fB.lXc(f,b,l,a);this.kKf(b,l);c.nP||this.ic.mx(c,a);return 32}dispose(){this.Kv.DBl(Object(R.a)(this,this.lrh,"openIgnoredDialog"));this.cya=null}B5c(a,b){const c=this.sa.Aa;let f=Vh.a.empty;c&&(f=c.Fb);const l=this.Tb.YJ();l&&("0"===a||"0"===b?{Oj:a,xo:b}=this.z_c(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.Ia(M.a.pnd,2,new CG(f,a,b)))}qZj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;const u=l.SourceControlId;
let I,T;if(!(()=>{let ja=this.kgf(u);({masterId:I,layoutId:T}=ja);return ja})().returnValue)return 8;b=this.sa.Aa;a=Vh.a.empty;b&&(a=b.Fb);c=this.Tb.YJ();if(!c)return 8;"0"===I||"0"===T?{Oj:b,xo:c}=this.z_c(c,b):(b=parseInt(I),c=parseInt(T));ya.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.Ia(M.a.pnd,2,new CG(a,b,c))}z_c(a,b){let c,f;f=c=0;if(!this.Ikj(a))return{Oj:c,xo:f};if(b){c=b.Oj;if(!c)return{Oj:c,xo:f};if(!this.Ba.tgc||
this.flj(c)){f=b.xo;if(!f)return{Oj:c,xo:f};if(b.rYa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ba.tgc?0:a[0].ContentMasters[0].Id;return{Oj:c,xo:f}}J$f(a,b,c){if(1===a)return 32;a=this.kgf(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[an.a.On]=a.layoutId===(c?this.Sah.toString():this.Tah.toString()));return 32}itd(a,b,c,f,l){return this.J$f(c,l,!1)}v_e(a,b,c,f,l){return this.J$f(c,
l,!0)}kgf(a){let b,c;c=b=null;if(!a)return ya.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");const f=md.a(Mj.KVf),l=f?1:0,u=f?2:1;if(!a||a.length!==(f?3:2))return ya.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[u];return{returnValue:!0,masterId:b,layoutId:c}}Ikj(a){if(0===a.length)return!1;for(let b=
0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}lrh(){this.Cxa&&(ya.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.Cxa===M.a.lla?"ChangeLayout":"NewSlide"),this.ia.nb(this.Cxa,2));this.Cxa=0}lqb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}kKf(a,b){$c.a.Xk("MainMasterId",a.toString());$c.a.Xk("ContentMasterId",b.toString());const c=this.Tb.YJ(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",
c[l].Id,c[l].ContentMasters.length));ya.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",c.length,f,a,b)}}UDk(){ya.a.J(508359425,813,50,Qa.a.toJSON(this.pHa));this.pHa={}}Hze(){return this.Kv.XPf()}flj(a){if(0===a)return!1;const b=this.Tb.DAb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}ine(a,b,c,f){this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},A.AFrameworkApplication.eNb.handleCommand(ff.ActionManager.Xda(a),b),f||c(),a=2):a=8:a=8;return a}static zhk(a){return a===Mj.bNi||a===Mj.cNi||a===Mj.$Mi||a===Mj.dNi||a===Mj.aNi}}Mj.bNi=1041;Mj.cNi=1042;Mj.$Mi=2052;Mj.dNi=1028;Mj.aNi=3076;Mj.a6j="LayoutIcon";Mj.KVf="ReactSlideLayoutButtonIdChange";Mj.UNi="SlideLayoutActor";Mj.nTf=145;Mj.ZMi=82;Mj.vTf=24;Mj.RMi=14;Mj.gNi=5;Mj.ild=1;Object(m.a)(Mj,"SlideLayoutActor",
null,[948,106]);class hP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.cH=this.Waa=this.vib=this.Xaa=null;this.ia=a;this.kS=b;this.Fa=c;this.ic=f;this.fB=l;this.Yb=u;this.ks=I;this.sa=T;this.Wb=ja;this.De=ua;this.UDe=Ra(500,Object(R.a)(this,this.Ard,"performKeyboardThumbnailReorder"));this.oa=eb;this.ho=Bb;this.Rga=Ub}qb(){this.ia.pa(M.a.eqc,ta.a.application,Object(R.a)(this,this.zXj,"handleMoveSlide"),4);this.ia.pa(M.a.aih,ta.a.application,Object(R.a)(this,this.AXj,"handleMoveSlideById"),4);
this.ia.pa(M.a.hkb,wc.a.application,Object(R.a)(this,this.p3c,"handleReorderSlide"),4);this.ia.pa(M.a.ekb,wc.a.application,Object(R.a)(this,this.p3c,"handleReorderSlide"),4);this.ia.pa(M.a.gkb,wc.a.application,Object(R.a)(this,this.p3c,"handleReorderSlide"),4);this.ia.pa(M.a.fkb,wc.a.application,Object(R.a)(this,this.p3c,"handleReorderSlide"),4);this.ia.pa(M.a.fqc,wc.a.application,Object(R.a)(this,this.$Uj,"handleCommitPendingMoveSlideData"),4);this.ia.pa(M.a.gqc,wc.a.application,Object(R.a)(this,
this.KYj,"handleQueryCommitMoveSlideDataEnabled"),100)}Sd(){const a=this.Fa.Kc(yj.a.XE);a.bindAction(B.KeyInputManager.Va(H.a.I3,B.KeyInputManager.Ze),M.a.hkb);a.bindAction(B.KeyInputManager.Va(H.a.H3,B.KeyInputManager.Ze),M.a.ekb);a.bindAction(B.KeyInputManager.Va(H.a.I3,B.KeyInputManager.Ze|4),M.a.gkb);a.bindAction(B.KeyInputManager.Va(H.a.H3,B.KeyInputManager.Ze|4),M.a.fkb)}AXj(a,b,c,f,l){a=this.sa.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.Rga&&(this.ho&&1<this.oa.Xe().length||
this.ic.EXa()))return 16;if(1===c)return 32;if(!l)return ya.a.J(508356296,822,10,"HandleMoveSlideById with no null action data."),8;b=l.wha;c=[];for(var u of b)(b=a.LD(u))?c.push(b):ya.a.J(508356295,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",u.sid,u.cid);u=l.Aa?a.LD(l.Aa):null;b=a.LD(l.Xpc);f=null;0<=l.sectionIndex&&(f=a.Yng(l.sectionIndex));return this.Psg(c,b,u,f,l.gwe)}zXj(a,b,c,f,l){return!this.Rga&&(this.ho&&1<this.oa.Xe().length||this.ic.EXa())?16:1===c?32:
l?this.Psg(l.wha,l.Xpc,l.Aa,null,l.gwe):8}Psg(a,b,c,f,l){var u;if(this.Rga)for(var I of a)if(!I||this.ic.Xc(this.Wb.Qk(I.Fb)))return 16;I=[];for(var T of a){if(!T)continue;const ja=this.Wb.Qk(T.Fb);ja?I.push(ja):ya.a.J(508356293,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",T.Fb.sid,T.Fb.cid)}if(T=$c.a.Kb)T.tk=!0,T.xG||(T.xG=new Date),I&&T.Wa("SlideCount",a.length.toString());T=null;l||(this.Rga?c&&(T=c):a&&0<a.length&&(T=a[0]),T&&!this.Yb.Aa.Fb.equals(T.Fb)&&(this.Yb.Aa=
this.Wb.Qk(T.Fb)));a=b?this.Wb.Qk(b.Fb):null;this.fB.sjj(I,a,f);null===(u=this.ks)||void 0===u?void 0:u.Arl(new fC.a(I));return 32}p3c(a,b,c){if(this.kS.h1||!this.sa.Aa||this.ic.Xc(this.Yb.Of)||!this.Rga&&this.ho&&1<this.oa.Xe().length)return 16;if(1===c)return 32;if(this.Rga){b=this.oa.Xe();if(!b||!b.length)return 16;this.E$l(b,a)}else this.y$l(this.sa.Aa,a);return 32}$Uj(a,b,c){if(this.ic.Xc(this.Yb.Of)||!this.lWf())return 16;if(1===c)return 32;this.Ard();return 32}KYj(){return this.Xaa?32:16}ewb(a){if(!a||
!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}y$l(a,b){var c=this.sa.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.De.z_;if(!(1>=f)){var l=!1;this.vib||(this.vib=a,this.cH=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.cH[c]&&this.vib.Fb.equals(this.cH[c].Fb)){a=c;break}if((b!==M.a.hkb&&b!==M.a.gkb||a)&&(b!==M.a.ekb&&b!==M.a.fkb||a!==f-1)){switch(b){case M.a.hkb:b=a-1;break;case M.a.ekb:b=
a+1;break;case M.a.gkb:b=0;break;case M.a.fkb:b=f-1;break;default:return}Array.removeAt(this.cH,a);Array.insert(this.cH,b,this.vib);for(l=0;l<f;l++)this.cH[l]?this.cH[l].ve=l:ya.a.J(508356292,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",l,f);this.De.lAa(b);f=new qz(!0,[this.vib],0<b?this.cH[b-1]:null);this.cQf(f)}else l&&(this.cH=this.vib=null)}}E$l(a,b){var c=this.sa.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.De.z_;if(!(1>=
f)&&(a.sort((u,I)=>u.slideIndex-I.slideIndex),this.ewb(a))){var l=!1;this.Waa||(this.Waa=a,this.cH=c.slides||[],l=!0);a=this.b2c(this.Waa[0],this.cH);c=this.b2c(this.Waa[this.Waa.length-1],this.cH);if((b!==M.a.hkb&&b!==M.a.gkb||a)&&(b!==M.a.ekb&&b!==M.a.fkb||c!==f-1)){l=null;switch(b){case M.a.hkb:l=0<=a-2?this.cH[a-2]:null;b=a-1;break;case M.a.ekb:b=a+this.Waa.length<f?a+this.Waa.length:f-1;l=this.cH[b];break;case M.a.gkb:l=null;b=0;break;case M.a.fkb:l=this.cH[f-1];b=f-1;break;default:return}for(a=
this.Waa.length-1;0<=a;a--)this.oCi(this.Waa[a],l);for(a=0;a<f;a++)this.cH[a]?this.cH[a].ve=a:ya.a.J(508356291,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.De.lAa(b);f=new qz(!0,this.Waa,l);this.cQf(f)}else l&&(this.cH=this.Waa=null)}}oCi(a,b){const c=this.b2c(a,this.cH);Array.removeAt(this.cH,c);b=this.b2c(b,this.cH)+1;Array.insert(this.cH,b,a)}b2c(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Fb.equals(b[c].Fb))return c;return-1}KFi(a,b){if(!a||
!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Fb.equals(f.Fb)){a=!0;break}if(!a)return!1}return!0}cQf(a){if(!a)throw Error.argumentNull("moveData");this.Rga?this.KFi(this.Waa,a.wha)||this.Ard():this.Xaa&&this.Xaa.wha&&a.wha&&this.Xaa.wha[0]&&a.wha[0]&&!this.Xaa.wha[0].Fb.equals(a.wha[0].Fb)&&this.Ard();this.Xaa=a;this.UDe.perform()}Ard(){if(this.lWf()){var a=this.Xaa;this.Waa=this.vib=this.Xaa=null;Array.clear(this.cH);this.ia.Ia(M.a.eqc,
2,a)}}lWf(){const a=this.sa.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.Xaa)return!1;let b=!0,c=!this.Xaa.Xpc;for(let f=0;f<this.Xaa.wha.length;f++)b=!!a.LD(this.Xaa.wha[f].Fb)&&b;c||(c=!!a.LD(this.Xaa.Xpc.Fb));return b&&c}}Object(m.a)(hP,"SlideMoveActor",null,[948]);class Dz extends Ky.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(Dz,"TableGalleryButtonProps",Ky.a,[]);class iP extends Dz{constructor(){super()}get Type(){return 8}}
Object(m.a)(iP,"ChangeColorsGalleryButtonProps",Dz,[]);class jP{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(m.a)(jP,"SmartArtInfo",null,[]);var Zt=d(500);class zj{constructor(a,b,c){this.aH=a;this.oOk=b;this.aRk=c}get id(){return this.aH}get parameter(){return this.oOk}get NGh(){return this.aRk}}Object(m.a)(zj,"SmartArtColorInfo",null,[]);class kP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb){this.Tq=[];this.ia=a;this.ic=
b;this.gb=c;this.Eb=f;this.Fa=l;this.sa=u;this.Dr=I;this.Tb=T;this.yb=ua;this.Lj=Ra;this.Ga=eb;this.yhl()}qb(){this.ia.pa(M.a.mHa,ta.a.view,Object(R.a)(this,this.RWj,"handleInsertSmartArt"),4);this.ia.pa(M.a.rTh,ta.a.application,Object(R.a)(this,this.z_j,"handleSmartArtToolsTabViewHandler"),4);this.ia.pa(M.a.k5b,ta.a.application,Object(R.a)(this,this.QUj,"handleChangeSmartArtLayout"),4);this.ia.pa(M.a.avh,ta.a.application,Object(R.a)(this,this.xYj,"handlePopulateSmartArtColorStyles"),96);this.ia.pa(M.a.j5b,
ta.a.application,Object(R.a)(this,this.OUj,"handleChangeSmartArtColor"),4);this.ia.pa(M.a.OVf,ta.a.application,Object(R.a)(this,this.PUj,"handleChangeSmartArtColorAnchor"),4);this.ia.pa(M.a.hM,ta.a.application,Object(R.a)(this,this.RUj,"handleChangeSmartArtStyle"),4);this.ia.pa(M.a.$za,ta.a.application,Object(R.a)(this,this.HZj,"handleResetSmartArt"),4);this.ia.pa(M.a.l5e,ta.a.application,Object(R.a)(this,this.LZj,"handleReverseSmartArt"),4);this.ia.pa(M.a.ttd,ta.a.application,Object(R.a)(this,this.PYj,
"handleQueryReverseSmartArt"),97);this.ia.pa(M.a.L7f,ta.a.application,Object(R.a)(this,this.IVj,"handleEditSmartArtText"),4);this.ia.pa(M.a.Xsd,ta.a.application,Object(R.a)(this,this.LYj,"handleQueryEditSmartArtText"),96)}Sd(){}RWj(a,b,c,f,l){b=this.sa.Aa;if(!b||this.ic.Xc(b))return 16;if(1===c)return 32;this.drd(l,a);if(!l)return 8;if((c=b.U0(this.gb.Hd()))&&this.ic.Xc(c))return 16;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;const u=this.mNj(b,c,l);l=this.Eb.ud(15,void 0,()=>{this.gb.Pu();this.gb.Bh();
this.Fa.Gd()},()=>{this.gb.selectShape(Object(gb.a)(4,u),!0)});try{l.mc(b),l.Wc=a,c&&b.XS([c]),b.ZB(Object(gb.a)(4,u))}finally{l&&l.dispose()}this.Dr.YA=Object(gb.a)(4,u);return 32}z_j(){return Object(gb.a)(749,this.vBa())?32:16}QUj(a,b,c,f,l){b=this.vBa();if(!b||this.ic.Xc(b))return 16;if(1===c)return 32;c=this.gb.Hd();for(var u of c){if(u.ig){b=u;break}if(u.get_smartArtModelId()){b=this.Ga.Hs(u);this.gb.T9(u);this.gb.selectShape(b,!1);break}}this.drd(l,a);u=this.Eb.ud(15,void 0,()=>{this.gb.uj();
this.Fa.Gd()});try{u.mc(b),u.Wc=a,Object(gb.a)(749,b).ensureModelData().get_elementCollection().documentElement.gra=l}finally{u&&u.dispose()}return 32}xYj(a,b,c,f,l){if(!this.vBa())return 16;a=this.gb.Pk();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.ALi(a):l.MenuItems=this.nLi(a);return 32}OUj(a,b,c,f,l){b=this.vBa();if(!b||this.ic.Xc(b))return 16;if(1===c)return 32;this.drd(l,a);c=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{c.mc(b),
c.Wc=a,Object(gb.a)(749,b).ensureModelData().get_elementCollection().documentElement.JAa=l}finally{c&&c.dispose()}return 32}PUj(){return this.vBa()?32:16}RUj(a,b,c,f,l){b=this.vBa();if(!b||this.ic.Xc(b))return 16;if(1===c)return 32;this.drd(l,a);c=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{c.mc(b),c.Wc=a,Object(gb.a)(749,b).ensureModelData().get_elementCollection().documentElement.KAa=l}finally{c&&c.dispose()}return 32}HZj(a,b,c){b=Object(gb.a)(749,this.vBa());if(!b||this.ic.Xc(Object(gb.a)(4,
b)))return 16;if(1===c)return 32;c=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{c.mc(b),c.Wc=a,b.$za=!0}finally{c&&c.dispose()}return 32}LZj(a,b,c){b=this.vBa();if(!b||!b.Rxe||this.ic.Xc(b))return 16;if(1===c)return 32;c=new jP;c.fReverseEnabled=b.Rxe;c.fReverseChecked=!b.Qxe;const f=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{f.mc(b),f.Wc=a,Object(gb.a)(749,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=c}finally{f&&f.dispose()}return 32}PYj(a,
b,c,f,l){a=this.vBa();a=!!a&&a.Qxe;if(!Object(gc.a)(Di.a,l))return 8;l.Rf(a);return 32}IVj(a,b,c){a=this.vBa();if(!a||this.ic.Xc(a))return 16;if(1===c)return 32;this.ia.Ia(M.a.WSa,2,new Ln.a(a,!0,null));return 32}LYj(a,b,c,f,l){a=this.gb.kz();if(!Object(gc.a)(Di.a,l))return 8;l.Rf(a);return 32}mNj(a,b,c){if(!a)return null;const f=a.wt();let l;l=b?b.uBb(jf.a.KS,jf.a.EZ):this.Tb.Ama(jf.a.KS,jf.a.EZ);return a.u8d(!0,0,b,c,l.x,l.y,jf.a.KS,jf.a.EZ,f+1)}vBa(){const a=this.gb.Hd();for(const b of a){if(b.ig)return b;
if(b.get_smartArtModelId())return this.Ga.Hs(b)}return null}yhl(){Array.add(this.Tq,new zj(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.Tq,new zj(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.Tq,new zj(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.Tq,new zj(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.Tq,new zj(4,"colorful2,colorful",ResourceStrings.L_SmartArtColorful2));
Array.add(this.Tq,new zj(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.Tq,new zj(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.Tq,new zj(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.Tq,new zj(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.Tq,new zj(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.Tq,new zj(10,"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));
Array.add(this.Tq,new zj(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.Tq,new zj(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.Tq,new zj(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.Tq,new zj(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.Tq,new zj(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));Array.add(this.Tq,new zj(16,"accent2_4,accent2",
ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.Tq,new zj(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.Tq,new zj(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.Tq,new zj(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.Tq,new zj(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.Tq,new zj(21,"accent3_4,accent3",ResourceStrings.L_SmartArtGradientLoop3));
Array.add(this.Tq,new zj(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.Tq,new zj(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.Tq,new zj(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.Tq,new zj(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.Tq,new zj(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));Array.add(this.Tq,new zj(27,"accent4_5,accent4",
ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.Tq,new zj(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.Tq,new zj(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.Tq,new zj(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.Tq,new zj(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.Tq,new zj(32,"accent5_5,accent5",ResourceStrings.L_SmartArtTransparentGradientRange5));
Array.add(this.Tq,new zj(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.Tq,new zj(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.Tq,new zj(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.Tq,new zj(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.Tq,new zj(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}nLi(a){const b=Object.assign(new Rn.a,
{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new dl.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=Lj.Color.Fj(a.Ld.Light1),l=Lj.Color.Fj(a.Ld.Dark1),u=Lj.Color.Fj(a.Ld.Light2),I=Lj.Color.Fj(a.Ld.Dark2),T=Array(6);T[0]=Lj.Color.Fj(a.Ld.Accent1);T[1]=Lj.Color.Fj(a.Ld.Accent2);T[2]=Lj.Color.Fj(a.Ld.Accent3);T[3]=Lj.Color.Fj(a.Ld.Accent4);T[4]=Lj.Color.Fj(a.Ld.Accent5);T[5]=Lj.Color.Fj(a.Ld.Accent6);let ja=0;Array.add(c.ControlList,
(()=>{let ua=this.hLi(ja,f,l,u,I);({jdc:ja}=ua);return ua})().returnValue);Array.add(c.ControlList,(()=>{let ua=this.cKi(ja,f,T);({jdc:ja}=ua);return ua})().returnValue);Array.addRange(c.ControlList,(()=>{let ua=this.KJi(ja,f,T);({jdc:ja}=ua);return ua})().returnValue);return b}hLi(a,b,c,f,l){const u=Object.assign(new gr.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,
Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(u.GalleryItems,this.tpc(b,c,a++));Array.add(u.GalleryItems,this.tpc(b,l,a++));Array.add(u.GalleryItems,this.tpc(l,f,a++));return{returnValue:u,jdc:a}}cKi(a,b,c){const f=Object.assign(new gr.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.Vld(c[1],
c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,this.AQe(c[l],c[l+1],b,a++));return{returnValue:f,jdc:a}}KJi(a,b,c){const f=[];for(let I=0;6>I;I++){const T=Object.assign(new gr.a,{Id:"ColorfulGallery"+(I+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(I+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,I+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new Lj.Color;l.r=l.g=l.b=255;var u=new Lj.Color;
l=Lj.Color.C0(c[I],l,.5);u=Lj.Color.C0(c[I],u,.25);Array.add(T.GalleryItems,this.tpc(b,c[I],a++));Array.add(T.GalleryItems,this.tpc(c[I],b,a++));Array.add(T.GalleryItems,this.AQe(c[I],l,b,a++));Array.add(T.GalleryItems,this.vVk(u,c[I],l,b,a++));Array.add(T.GalleryItems,this.AQe(c[I],l,b,a++));Array.add(f,T)}return{returnValue:f,jdc:a}}tpc(a,b,c){return this.Vld(a,a,a,a,a,a,b,c)}AQe(a,b,c,f){const l=Zt.a.C0(a,b,2/6),u=Zt.a.C0(a,b,.5),I=Zt.a.C0(a,b,4/6),T=Zt.a.C0(a,b,5/6);return this.Vld(a,l,u,I,T,
b,c,f)}vVk(a,b,c,f,l){const u=Lj.Color.C0(b,c,.5);return this.Vld(a,b,u,c,u,b,f,l)}Vld(a,b,c,f,l,u,I,T){T=this.Oog(T);const ja="ChangeSmartArtColor__"+T.parameter.replace(",","__");return Object.assign(new iP,{Id:ja,ExternalId:ja,MenuItemId:T.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:T.NGh,TableCellStyles:[this.dLb(a,I),this.dLb(b,I),this.dLb(c,I),this.dLb(f,I),this.dLb(l,I),this.dLb(u,I)]})}dLb(a,b){const c={};c.backgroundColor=this.rYf(a);c.border=String.format("1px solid {0}",
this.rYf(b));return c}rYf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",a.r,a.g,a.b)}ALi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new Lj.Color;c.r=c.g=c.b=255;const f=new Lj.Color,l=Lj.Color.Fj(a.Ld.Light1);var u=Lj.Color.Fj(a.Ld.Dark1),I=Lj.Color.Fj(a.Ld.Light2),T=Lj.Color.Fj(a.Ld.Dark2);const ja=Array(6);ja[0]=Lj.Color.Fj(a.Ld.Accent1);ja[1]=Lj.Color.Fj(a.Ld.Accent2);ja[2]=Lj.Color.Fj(a.Ld.Accent3);ja[3]=Lj.Color.Fj(a.Ld.Accent4);ja[4]=Lj.Color.Fj(a.Ld.Accent5);
ja[5]=Lj.Color.Fj(a.Ld.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.spc(b,l,u,a++);this.spc(b,l,T,a++);this.spc(b,T,I,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');
this.Rld(b,ja[1],ja[2],ja[3],ja[4],ja[5],ja[1],l,a++);for(u=1;5>u;u++)this.wQe(b,ja[u],ja[u+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(u=0;6>u;u++)I=String.format(ResourceStrings.L_AccentFormat,u+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',u+1,I)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',u+1)),I=Lj.Color.C0(ja[u],c,.5),T=Lj.Color.C0(ja[u],f,.25),this.spc(b,l,ja[u],a++),this.spc(b,ja[u],l,a++),
this.wQe(b,ja[u],I,l,a++),this.qVk(b,T,ja[u],I,l,a++),this.wQe(b,ja[u],I,l,a++),b.append("</Gallery>"),b.append("</MenuSection>");b.append("</Menu>");return b.toString()}spc(a,b,c,f){this.Rld(a,b,b,b,b,b,b,c,f)}wQe(a,b,c,f,l){const u=Zt.a.C0(b,c,2/6),I=Zt.a.C0(b,c,.5),T=Zt.a.C0(b,c,4/6),ja=Zt.a.C0(b,c,5/6);this.Rld(a,b,u,I,T,ja,c,f,l)}qVk(a,b,c,f,l,u){const I=Lj.Color.C0(c,f,.5);this.Rld(a,b,c,I,f,I,c,l,u)}Rld(a,b,c,f,l,u,I,T,ja){ja=this.Oog(ja);a.append('<GalleryButton Id="');a.append(ja.parameter);
a.append('" Command="');a.append(M.a.j5b.toString());a.append('" QueryCommand="');a.append(M.a.zc.toString());a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.eLb(a,b,T,8,-1);this.eLb(a,c,T,34,-1);this.eLb(a,f,T,8,16);this.eLb(a,l,T,34,16);this.eLb(a,u,T,8,33);this.eLb(a,I,T,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(ja.NGh);a.append('"/>')}drd(a,b){a.Uri=b===M.a.j5b?"urn:microsoft.com/office/officeart/2005/8/colors/"+
a.Uri:b===M.a.hM?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}Oog(a){let b;for(let c=0;c<this.Tq.length;c++)if(b=
this.Tq[c],b.id===a)return b;return new zj(-1,"","")}eLb(a,b,c,f,l){a.append("&lt;div style=&quot;");b.Oce()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.Oce()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}
Object(m.a)(kP,"SmartArtActor",null,[948]);class Ez{constructor(a,b,c,f){this.HOe="BottomOverlaid";this.ia=a;this.Mc=f;this.Wb=b;this.Hc=c;this.IOe="productionSpokenLanguages_"+this.Mc.hra;this.JOe="productionSubtitleLanguages_"+this.Mc.rBa}qb(){ya.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Mc.ji);this.ia.pa(M.a.g2a,wc.a.application,Object(R.a)(this,this.g2a,"querySubtitleIsEnabled"),96);this.ia.xa(M.a.BOa,wc.a.application,Object(R.a)(this,this.BOa,
"toggleUseSubtitles"));this.ia.pa(M.a.Qtd,wc.a.application,Object(R.a)(this,this.tol,"querySubtitleSettingsIsEnabled"),96);this.ia.pa(M.a.vlb,wc.a.application,Object(R.a)(this,this.vlb,"populateTranscriptionSubtitleLanguage"),96);this.ia.pa(M.a.ulb,wc.a.application,Object(R.a)(this,this.ulb,"populateTranscriptionSpokenLanguage"),96);this.ia.xa(M.a.zam,wc.a.application,Object(R.a)(this,this.b0j,"handleToggleTranscriptionSpokenLanguage"));this.ia.xa(M.a.Aam,wc.a.application,Object(R.a)(this,this.c0j,
"handleToggleTranscriptionSubtitleLanguage"));this.ia.pa(M.a.U0e,wc.a.application,Object(R.a)(this,this.U0e,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.pa(M.a.V0e,wc.a.application,Object(R.a)(this,this.V0e,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.pa(M.a.dmb,wc.a.application,Object(R.a)(this,this.dmb,"querySubtitlesBottomOverlay"),96);this.ia.xa(M.a.CTb,wc.a.application,Object(R.a)(this,this.CTb,"toggleSubtitlesBottomOverlay"));this.ia.pa(M.a.emb,wc.a.application,Object(R.a)(this,
this.emb,"querySubtitlesTopOverlay"),96);this.ia.xa(M.a.DTb,wc.a.application,Object(R.a)(this,this.DTb,"toggleSubtitlesTopOverlay"));this.ia.pa(M.a.cmb,wc.a.application,Object(R.a)(this,this.cmb,"querySubtitlesBelowSlide"),96);this.ia.xa(M.a.BTb,wc.a.application,Object(R.a)(this,this.BTb,"toggleSubtitlesBelowSlide"));this.ia.pa(M.a.bmb,wc.a.application,Object(R.a)(this,this.bmb,"querySubtitlesAboveSlide"),96);this.ia.xa(M.a.ATb,wc.a.application,Object(R.a)(this,this.ATb,"toggleSubtitlesAboveSlide"))}Sd(){}g2a(a,
b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return 8;l.Rf(this.Mc.ji);return 32}tol(a,b,c,f,l){return 1===c?this.Wb.Hi()?32:8:l&&"object"===typeof l?this.Mc&&this.Mc.q9b?32:(ya.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(ya.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}dmb(a,b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return ya.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Rf("BottomOverlay"===
this.Mc.Xw);ya.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.Mc.Xw);return 32}emb(a,b,c,f,l){if(!l||!Object(gc.a)(Di.a,l))return 8;l.Rf("TopOverlay"===this.Mc.Xw);ya.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Mc.Xw);return 32}cmb(a,b,c,f,l){try{l&&l.Rf("BelowSlide"===this.Mc.Xw)}catch(u){ya.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",u)}return 32}bmb(a,b,c,f,l){try{l&&l.Rf("AboveSlide"===
this.Mc.Xw)}catch(u){ya.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",u)}return 32}BOa(a,b,c,f,l){if(1===c)return this.Wb.Hi()?32:8;if(!l||"object"!==typeof l)return 8;this.Mc.ji&&(Yi.a.lL("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Yi.a.VK)||ya.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Mc.ji=!this.Mc.ji;ya.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",
this.Mc.ji);ad.App.Ob.OB({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}vlb(a,b,c,f,l){try{if(1===c)return 32;if(!l)return ya.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.Zuh(l,!1)}catch(u){ya.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",u)}return 32}ulb(a,b,c,f,l){try{if(1===c)return 32;if(!l)return ya.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.Zuh(l,
!0)}catch(u){ya.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",u)}return 32}c0j(a,b,c,f,l){try{if(l){this.Mc.rBa=l.MenuItemId;this.Mc.Mpb=this.Mc.H2c();const u=l.SourceControlId;this.JOe!==u&&(a={},a[u]="ToggleButtonModel",a[this.JOe]="ToggleButtonModel",ad.App.Ob.OB(a),this.JOe=u)}}catch(u){ya.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",u)}return 32}V0e(a,b,c,f,l){try{l&&(l[Xh.a.On]=l.MenuItemId.toLowerCase()===this.Mc.rBa.toLowerCase())}catch(u){ya.a.J(512500121,
822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",u)}return 32}b0j(a,b,c,f,l){try{if(l){this.Mc.hra=l.MenuItemId;const u=l.SourceControlId;this.IOe!==u&&(a={},a[u]="ToggleButtonModel",a[this.IOe]="ToggleButtonModel",ad.App.Ob.OB(a),this.IOe=u)}}catch(u){ya.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",u)}return 32}U0e(a,b,c,f,l){try{l&&(l[Xh.a.On]=l.MenuItemId.toLowerCase()===this.Mc.hra.toLowerCase())}catch(u){ya.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",
u)}return 32}CTb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[Xh.a.On]&&(this.Mc.Xw="BottomOverlay",ya.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.pFd(l.SourceControlId);return 32}DTb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),
8;l[Xh.a.On]&&(this.Mc.Xw="TopOverlay",ya.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.pFd(l.SourceControlId);return 32}BTb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[Xh.a.On]&&(this.Mc.Xw="BelowSlide",ya.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.pFd(l.SourceControlId);return 32}ATb(a,
b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[Xh.a.On]&&(this.Mc.Xw="AboveSlide",ya.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.pFd(l.SourceControlId);return 32}Zuh(a,b){a.MenuItems=Object.assign(new Rn.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Mc.Gcf)&&0<b.count&&(b=Ez.g2f(b,"productionSpokenLanguages",
""),Array.add(a.MenuItems.MenuSectionList,b)),(b=this.Mc.Fcf)&&0<b.count&&(b=Ez.g2f(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Mc.QSb)&&0<Qa.a.count(b)&&(b=Ez.r7i(this.Mc.jbf),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=Hj.l(a.MenuItems)}pFd(a){if(this.HOe!==a){const b={};b[a]="ToggleButtonModel";b[this.HOe]="ToggleButtonModel";ad.App.Ob.OB(b);this.HOe=a;this.Hc.Gz(new Pq.a(1))}}static g2f(a,
b,c){c=Object.assign(new dl.a,{DisplayMode:"Menu",Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(const f of a)try{const l=f.toLowerCase(),u=Object.assign(new aB.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:Ea.a.Oe(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Qe.a.gwb});Array.add(c.ControlList,u)}catch(l){ya.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static r7i(a){const b=
Object.assign(new dl.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(const c of a)try{const f=Object.assign(new aB.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:Ea.a.Oe(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Qe.a.gwb});Array.add(b.ControlList,f)}catch(f){ya.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,f)}return b}}Object(m.a)(Ez,"SubtitleActor",null,[948]);var kT=d(415);class Ro{constructor(a){this.Wy=this.$t=this.yv=this.BL=this.BJ=null;this.n0=a}get $3b(){return this.BL||(this.BL=Tb.a.instance.ub("Box4.IAutoCorrectRules"))}get kea(){return this.yv||(this.yv=Tb.a.instance.ub("Box4.IAutoCorrectScheduler"))}get $K(){return this.BJ||(this.BJ=Tb.a.instance.ub("Box4.Pages.IPageContentEditor"))}get $C(){return this.Wy||(this.Wy=Tb.a.instance.ub("Box4.IOutlineEditor"))}get Fo(){return this.$t||(this.$t=
this.n0())}DFb(a,b,c){if(this.$C&&Ro.Eh){var f=Uh.ContextSetEditor.lie(b);a=f.node;Bc.SelectionEditor.Om(f)&&(f=me.a.rk(a,$a.ParagraphReader.textLength(a)));var l=Od.a.language(Od.a.yt(f));f=mb.GraphIterator.ob(c.Zg);Ro.Rm.eNa(f);var u=a=null;if(f)for(let I=f.Gb(1);I&&!u;I=f.sk(1))Bj.OutlineReader.xY(I)&&(u=I);if(f&&!u){if(!this.$K||!this.$C)return;a=new pg.GraphTransaction(7);a.Jz(f);u=this.$K.P6b(f);this.$C.Vyd(u,c.Nbc());this.$C.uX(f,!0);l&&(jb.OutlineElementNavigator.Ti(f),f=me.a.rk(f.currentNode,
0),Ro.Eh.q3a(Od.a.yt(f),l))}l=$d.SelectionFactory.hk(u,!0);c.Rb.setSelection(l);Bc.SelectionEditor.nh(b)&&(c=mb.GraphIterator.ob(b.node),c.Zv(),Pg.OutlineNavigator.owd(c),this.$3b&&this.kea&&Bj.OutlineReader.QD(c,b,!0)&&(b=this.$3b.Mde(b,-1,!1,H.a.zs))&&this.kea.zJh(b));this.Fo&&this.Fo.Bx();a&&a.dispose()}}Tbe(a,b,c){a=mb.GraphIterator.ob(c.Zg);a=kT.a(a);a=$d.SelectionFactory.hk(a,!1);c.Rb.setSelection(a)}static get Eh(){return Ro.Sf||(Ro.Sf=Tb.a.instance.ub("Box4.IFormattingEditor"))}static get instance(){return Ro.Ja||
(Ro.Ja=Ro.JD())}static JD(){return new Ro(()=>Tb.a.instance.ub("Box4.IUndoManager"))}static get Rm(){return Tm.PageNavigator.instance}}Ro.Ja=null;Ro.Sf=null;Object(m.a)(Ro,"TitleViewEditor",null,[]);class ov{constructor(a,b,c,f,l,u,I,T,ja){this.$t=null;this.WHf=!1;this.n0=a;this.qWd=b;this.yn=c;this.BL=void 0===f?null:f;this.yv=void 0===l?null:l;this.kd=void 0===T?null:T;this.lm=void 0===ja?null:ja}get Fo(){return this.$t||(this.$t=this.n0())}qb(){const a=A.AFrameworkApplication.Pa,b=Object(R.a)(this,
this.U7l,"tabView");a.pa(G.a.tab,ta.a.view,b,1124);a.pa(G.a.oyc,ta.a.view,b,1124);a.xa(G.a.ayg,ta.a.view,ff.ActionManager.uh)}U7l(a,b,c,f,l){if(1===c)return 32;const u=a===G.a.oyc;if(!b.view.xi)return 2;const I=b.view,T=I.Rb;var ja=T.Ik;if(!ja||U.a.instance.ga(14)&&ov.Jj.aab(ja))return 2;if(this.yn&&this.yn.instance&&this.yn.instance.rY(ja))return 4;var ua=null,Ra=ff.ActionManager.o7,eb=!1,Bb=Bc.SelectionEditor.nh(ja);if(ja.ry){if(T.Oa.rI&&(Ra=ja.getContext(0),ua=new mb.GraphIterator,ua.set(Ra.node),
ua.Zv(),Ra=u?G.a.L6e:G.a.Fxd),Ra=this.qWd.Zkl(Ra,u?G.a.My:G.a.lC),Ra===ff.ActionManager.o7){var Ub=ov.Dn.D9(ja,16);if(Ub)u&&(Ra=G.a.jnd),ua=new mb.GraphIterator,ua.set(Ub.node),ua.wf();else{if(U.a.instance.ga(77))return 2;if(ov.Cgk(ja)){if(u)return 2;Ra=G.a.DFb}else Ra=u?G.a.My:G.a.lC}}}else if(ja.El)ua=new mb.GraphIterator,ua.set(ja.node),Bc.SelectionEditor.Bu(ua),Bj.OutlineReader.ona(ja)?Ra=u?G.a.L6e:G.a.Fxd:(Ra=u?this.qWd.pTj(ua,ja,Ra):this.qWd.oTj(ua,ja,Ra),ge.OutlineElementReader.vh(ua)&&ja.contextId===
ta.a.Xf&&(eb=ge.OutlineElementReader.QD(ua,ja,!1)),(Ub=Kc.ListReader.hl(ua)&&eb)&&da.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Ra===G.a.lC),Ra!==ff.ActionManager.o7||se.isTableCellOrInside(ua)||Ub||(this.WHf||(da.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.WHf=!0),A.AFrameworkApplication.Pa.nb(G.a.ayg,2),this.kd&&this.kd.isFeatureEnabled(84)&&this.kd.isFeatureEnabled(83)));else return 2;if(!u&&Ra===ff.ActionManager.o7&&
se.isTableCellOrInside(ua))if(ce.returnToCell(ua),se.isLastCellInTable(ua)||Jd.TableReader.ZDb(ua)&&se.isLastCellInTableIgnoringGhostCells(ua)){if(Ra=this.wYd(ua,ja),!Ra)return 2}else Ra=G.a.Gih;if(Ra===ff.ActionManager.o7)return 2;switch(Ra){case G.a.DFb:Ro.instance.DFb(a,ja,b.view);ja=32;break;case G.a.Tbe:Ro.instance.Tbe(a,ja,b.view);ja=32;break;case G.a.Gih:case G.a.jnd:eb=Ra===G.a.jnd;this.BL&&this.yv&&(Bb&&(Bb=this.BL.Mde(ja,-1,!0,H.a.zs))&&this.yv.zJh(Bb),Object(Nb.a)("autoCorrectOnTabInTable")&&
this.yv.aUb(null===ua||void 0===ua?void 0:ua.currentNode,H.a.zs));ja=32;ce.returnToCell(ua);ce.moveToNextOrPreviousCell(ua,eb)&&(Bb=!0,eb=!1,Bj.OutlineReader.E3c(ua)||(Pg.OutlineNavigator.WRe(ua,!1),jb.OutlineElementNavigator.Ti(ua),$a.ParagraphReader.rt(ua.currentNode)&&(Bb=!1,$a.ParagraphReader.textLength(ua.currentNode)||(eb=!0)),eb||ce.returnToCell(ua)),eb?ua=$d.SelectionFactory.fh(ua.currentNode,0):(ua=$d.SelectionFactory.Nl(ua.currentNode),!Bb&&Bc.SelectionEditor.Om(ua.vf)&&(Bb=ua.toArray(),
Array.removeAt(Bb,Bb.length-1),ua=new Nd.Selection(Bb,ua.Kf))),T.setSelection(ua));break;case G.a.L6e:case G.a.Fxd:Ra===G.a.Fxd?Pg.OutlineNavigator.iih(ua,!1):Pg.OutlineNavigator.iih(ua,!0);T.setSelection($d.SelectionFactory.Nl(ua.currentNode));ja=32;break;case G.a.$3a:ja=A.AFrameworkApplication.Pa.Ai(b,Ra,c,!0,f,l);1===ad.App.mode&&ce.moveToNextOrPreviousCell(ua,!1)&&(ce.returnToCell(ua),ua=$d.SelectionFactory.hk(ua.currentNode,!0),Bc.SelectionEditor.Om(ua.vf)&&(Bb=ua.toArray(),Array.removeAt(Bb,
Bb.length-1),ua=new Nd.Selection(Bb,ua.Kf)),T.setSelection(ua));break;default:if(ja=A.AFrameworkApplication.Pa.Ai(b,Ra,c,!0,f,l),!eb&&Bb&&(Ra===G.a.My||Ra===G.a.lC)){const Xb=Bc.SelectionEditor.gla(T.Oa.kb).y;ad.App.zvl(()=>{this.RYk(T,I,Xb)})}}32===ja&&b.view.xi&&this.Fo.Bx();return ja}RYk(a,b,c){if(a&&b){var f=a.Oa.kb;Bc.SelectionEditor.gla(f).y<c?(b=Bc.SelectionEditor.I9b(b,f,!1),b=Bc.SelectionEditor.Rua(b,!1,!1,!1,!0)):b=Bc.SelectionEditor.mYc(b,f,!1);a.setSelection(b)}}wYd(){return G.a.Yva}Xhh(a,
b,c){if(a&&b){var f=a.Oa.kb;Bc.SelectionEditor.gla(f).y<c?(b=Bc.SelectionEditor.I9b(b,f,!1),b=Bc.SelectionEditor.Rua(b,!1,!1,!1,!0)):b=Bc.SelectionEditor.Rua(f,!1,!1,!1,!0);a.setSelection(b)}}static get Jj(){return mi.a.instance}static get Dn(){return Uh.ContextSetEditor.instance}static Cgk(a){a=ov.Dn.D9(a,10);return!!a&&we.a(a)}}Object(m.a)(ov,"TabActor",null,[]);class lP extends ov{constructor(a,b,c,f){Object(md.a)("autoCorrectOnTabInTable")?super(a,b,c,Tb.a.instance.ub("Box4.IAutoCorrectRules"),
Tb.a.instance.ub("Box4.IAutoCorrectScheduler")):super(a,b,c);this.ka=f}wYd(a,b){return this.ka.dFb?super.wYd(a,b):0}}Object(m.a)(lP,"Box4TabActor",ov,[]);class mP{constructor(a,b,c,f){this.TSk=new lP(a,b,c,f)}qb(){this.TSk.qb()}Sd(){}}Object(m.a)(mP,"TabActor",null,[948]);class nP{constructor(a,b,c){this.IUg=b;this.oa=a;this.PIa=c}Zkl(a,b){const c=this.oa.Ik;return c&&this.PIa.D9(c,16)?a:this.T9e(b)?b:N.a.Ce}pTj(a,b,c){(c=Object(gb.a)(5,b.node))&&c.Ft()?c=G.a.jnd:(jb.OutlineElementNavigator.$e(a),
c=(Bc.SelectionEditor.Tk(b)||Bc.SelectionEditor.nh(b)&&ge.OutlineElementReader.QD(a,b,!1))&&this.IUg.dxb(a)&&this.T9e(G.a.My)?G.a.My:N.a.Ce,ya.a.J(508692636,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",c===G.a.My?"Promote":"DoNothing"));return c}oTj(a,b,c){const f=Object(gb.a)(5,a.lr);if(f&&f.Ft())return c;jb.OutlineElementNavigator.$e(a);c=(Bc.SelectionEditor.Tk(b)||Bc.SelectionEditor.nh(b)&&ge.OutlineElementReader.QD(a,b,!1))&&this.IUg.aRc(a)&&this.T9e(G.a.lC)?G.a.lC:
N.a.Ce;ya.a.J(508692635,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===G.a.My?"Demote":"DoNothing");return c}T9e(a){var b=this.oa.Oa.kb;let c=!1;if(b)for(const f of b)if(f&&f.node)if($a.ParagraphReader.tY(f.node)){if(b=f.node.ra(ib.a.listLevel,0),a===G.a.lC&&b>=qi.a.G9-1||a===G.a.My&&!b||this.oa.UM()&&qi.a.$Bg(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(m.a)(nP,"TabActorPromoteDemoteStrategy",null,[1864]);var oP=d(405),lT=d(881),pP=d(995);class fx extends zi.a{constructor(a,
b,c,f,l,u,I,T,ja){super(void 0,void 0,!0);this.gxa=null;this.NHk=b;this.c0g=f;this.a0g=l;this.W_g=u;this.Q_g=I;this.OOg=T;this.NOg=ja;this.Fya=a;this.hgb=c}zAd(){this.Fg=this.NHk;const a={};a.bodyControls=this.cge();this.Vj(this.Fya,Object(R.a)(this,this.u$d,"dialogResultHandler"),a)}u$d(a,b){1===a&&this.hgb(parseInt(this.iWa(b)),parseInt(this.Wwj(b)));this.dispose()}cge(){this.gxa=fx.$ge();const a={};this.YYi(a);this.bYi(a);return a}YYi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,
this.c0g,this.W_g),c=[pP.a("None",0,this.c0g,this.W_g,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.OOg,["validUnits"]:c,["numberFormatInfo"]:this.gxa,["validReservedValues"]:[""]}}bYi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.a0g,this.Q_g),c=[pP.a("None",0,this.a0g,this.Q_g,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",
["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.NOg,["validUnits"]:c,["numberFormatInfo"]:this.gxa,["validReservedValues"]:[""]}}iWa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.OOg.toString()}Wwj(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.NOg.toString()}static $ge(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",
["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(m.a)(fx,"AReactTableSizeDialog",zi.a,[]);class qP extends fx{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,"InsertTableDialog",a,1,1,35,35,2,5)}}Object(m.a)(qP,"ReactInsertTableDialog",fx,[]);class rP extends fx{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(m.a)(rP,"ReactSplitTableCellsDialog",fx,[]);var gx=d(633),sP=
d(979);class rH{constructor(a){this.yIa=a;if(!a)throw Error.argumentNull("m_actionData");}Js(){return!1}$n(){return this.yIa.TableNode}yw(){var a;return null!==(a=this.yIa.CellNodes)&&void 0!==a?a:this.$n().Tcb()}p_(a){return a&&!!a.Aa}}Object(m.a)(rH,"TableActionDataContextHelper",null,[1871]);class sH{constructor(a){this.oa=a;if(!a)throw Error.argumentNull("m_selectionManager");}Js(){return this.oa.Js()}$n(){return this.oa.$n()}yw(){return this.oa.yw()}p_(a){let b=!1;a&&a.Aa&&(a=this.oa.Zn(),b=
!!a&&a.vd);return b}}Object(m.a)(sH,"TableSelectionManagerContextHelper",null,[1871]);class pv{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f){this.VYa={};this.Tlc=!1;this.Uhd=null;this.OA=[0,.25,.5,.75,1,1.5,2.25,3,4.5,6];this.QG=new bd.ScriptSharpLegacyMap;this.PJj=(Ve,xg,yg)=>{const ng=new Fs;ng.response=8;Ve=Ve.XBb();if(!Ve)return ng;xg=xg||yg?Ve.firstRow:Ve.Mng(Ve.jW-1);if(!xg)return ng;yg=[me.a.create(xg)];ng.DB=yg;ng.U3a=xg;ng.Yn=Ve;ng.vLa=yg.length;if(this.Ba.Yu||
!Jd.TableReader.nu(ng.Yn))ng.response=32;return ng};this.IJj=(Ve,xg,yg)=>{const ng=new Fs;ng.response=8;Ve=Ve.XBb();if(!Ve)return ng;xg=xg||!yg?Ve.tf(0,0):Ve.tf(0,Ve.O4-1);if(!xg)return ng;yg=[me.a.create(xg)];ng.DB=yg;ng.U3a=xg;ng.Yn=Ve;ng.vLa=1;if(this.Ba.Yu||!Jd.TableReader.nu(ng.Yn))ng.response=32;return ng};this.Yb=Ub;this.sa=Xb;this.Ub=b;this.ia=a;this.uf=c;this.oa=tc;this.Fa=f;this.lB=l;this.Ga=u;this.Nt=Ra;this.Vk=ua;this.Ba=eb;this.Eb=Bb;this.RK=ja;this.u0a=T;this.Cc=I;this.Lj=lc;this.EKb=
Ec;this.kdh=hd;this.sga=yd;this.yb=Pd;this.wIa=pe;this.Dr=Se;this.wZ=vf;this.JWg=ug;this.LI=1;this.Lx=Ze.Box4ColorHelper.uT({Color:"##T,1,0,0"});this.nv=Tg;this.vB=$f}qb(){this.VYa["465284484"]=0;this.VYa["212166888"]=1;this.VYa["530759702"]=2;this.VYa["1915511548"]=0;this.VYa["2003354004"]=1;this.VYa["2257534378"]=2;Lc.ike=Object(R.a)(this,this.hke,"getRowOrColumnsForDelete");Lc.Wje=Object(R.a)(this,this.QJj,"getRefRowWhenInsertRow");Lc.Tje=Object(R.a)(this,this.JJj,"getRefCellWhenInsertColumn");
Lc.Uje=Object(R.a)(this,this.LJj,"getRefColumnFromRefCell");Lc.Vje=Object(R.a)(this,this.NJj,"getRefColumnsWhenSelectColumn");Lc.Xje=Object(R.a)(this,this.SJj,"getRefRowsWhenSelectRow");Lc.nme=Object(R.a)(this,this.gTj,"gotoFocusCellAfterInsertColumn");Lc.tBb=Object(R.a)(this,this.Jlg,"getNewOutlineElementInfoFromCell");Lc.IEb=a=>this.Ba.Yu||!Jd.TableReader.ZDb(a);this.ia.pa(M.a.rNb,wc.a.application,Object(R.a)(this,this.vVj,"handleDeleteTable"),4);this.ia.pa(M.a.ktc,ta.a.view,Object(R.a)(this,this.xVj,
"handleDeleteTableRow"),4);this.ia.pa(M.a.gsd,ta.a.view,Object(R.a)(this,this.wVj,"handleDeleteTableColumn"),4);this.ia.pa(M.a.CYe,wc.a.application,Object(R.a)(this,this.$Zj,"handleSelectTable"),4);this.ia.pa(M.a.hsd,wc.a.application,Object(R.a)(this,this.SWj,"handleInsertTable"),4);this.ia.pa(M.a.xYe,wc.a.application,Object(R.a)(this,this.TWj,"handleInsertTableDialog"),4);this.ia.pa(M.a.wvh,wc.a.application,Object(R.a)(this,this.UWj,"handleInsertTableFromRibbon"),4);this.ia.pa(M.a.Ail,wc.a.application,
br.a.jI,4);this.ia.pa(M.a.Bil,wc.a.application,br.a.jI,4);this.ia.pa(M.a.Ynl,wc.a.application,br.a.V2,96);this.ia.pa(M.a.Znl,wc.a.application,br.a.V2,96);this.ia.pa(M.a.Fyh,ta.a.view,Object(R.a)(this,this.Q0e,"queryTableCellAnchoring"),96);this.ia.pa(M.a.Eyh,ta.a.view,Object(R.a)(this,this.Q0e,"queryTableCellAnchoring"),96);this.ia.pa(M.a.Dyh,ta.a.view,Object(R.a)(this,this.Q0e,"queryTableCellAnchoring"),96);this.ia.xa(M.a.utc,ta.a.view,Lc.pma);this.ia.xa(M.a.ttc,ta.a.view,Lc.pma);this.ia.xa(M.a.stc,
ta.a.view,Lc.pma);this.ia.xa(M.a.utc,ta.a.tableCell,Object(R.a)(this,this.gne,"handleTableCellAnchoring"));this.ia.xa(M.a.ttc,ta.a.tableCell,Object(R.a)(this,this.gne,"handleTableCellAnchoring"));this.ia.xa(M.a.stc,ta.a.tableCell,Object(R.a)(this,this.gne,"handleTableCellAnchoring"));this.ia.pe(M.a.utc,4);this.ia.pe(M.a.ttc,4);this.ia.pe(M.a.stc,4);this.ia.xa(M.a.svh,ta.a.view,Object(R.a)(this,this.GUj,"handleCellShadingMenuOpen"));this.ia.pa(M.a.Bvh,ta.a.view,Object(R.a)(this,this.oYj,"handlePopulateCellShadingColor"),
96);this.ia.xa(M.a.y7,ta.a.view,Lc.pma);this.ia.xa(M.a.y7,ta.a.tableCell,Object(R.a)(this,this.EUj,"handleCellShadingColor"));this.ia.xa(M.a.yvh,ta.a.view,Object(R.a)(this,this.oXj,"handleMoreCellShadingColor"));this.ia.xa(M.a.gtc,ta.a.view,Lc.pma);this.ia.xa(M.a.gtc,ta.a.tableCell,Object(R.a)(this,this.FUj,"handleCellShadingCustomColor"));this.ia.xa(M.a.pMa,ta.a.view,Lc.pma);this.ia.xa(M.a.pMa,ta.a.tableCell,Object(R.a)(this,this.xZj,"handleRemoveCellShading"));this.ia.pe(M.a.y7,4);this.ia.pe(M.a.pMa,
4);this.ia.pa(M.a.muc,ta.a.application,Object(R.a)(this,this.muc,"queryLockAspectRatio"),96);this.ia.pa(M.a.xxc,ta.a.application,Object(R.a)(this,this.xxc,"setLockAspectRatio"),4);this.ia.pa(M.a.JOb,ta.a.view,Object(R.a)(this,this.JOb,"queryTableRowHeight"),96);this.ia.pa(M.a.IOb,ta.a.view,Object(R.a)(this,this.IOb,"queryTableColumnWidth"),96);this.ia.pa(M.a.D3a,ta.a.view,Object(R.a)(this,this.D3a,"setTableRowHeight"),4);this.ia.pa(M.a.ENa,ta.a.view,Object(R.a)(this,this.ENa,"setTableColumnWidth"),
4);this.ia.pa(M.a.mBd,ta.a.view,Object(R.a)(this,this.D3a,"setTableRowHeight"),4);this.ia.pa(M.a.lBd,ta.a.view,Object(R.a)(this,this.ENa,"setTableColumnWidth"),4);this.ia.pa(M.a.EGh,wc.a.application,Object(R.a)(this,this.IZj,"handleResizeFallbackTable"),4);this.ia.pa(M.a.Wuc,ta.a.view,Object(R.a)(this,this.Oyh,"queryTableSize"),96);this.ia.pa(M.a.Vtd,ta.a.view,Object(R.a)(this,this.Oyh,"queryTableSize"),96);this.ia.pa(M.a.Uqa,ta.a.view,Object(R.a)(this,this.NNh,"setTableSize"),4);this.ia.pa(M.a.FNa,
ta.a.view,Object(R.a)(this,this.NNh,"setTableSize"),4);this.ia.pa(M.a.mergeTableCells,ta.a.view,Object(R.a)(this,this.lXj,"handleMergeTableCells"),4);this.ia.pa(M.a.splitTableCells,ta.a.view,Object(R.a)(this,this.F_j,"handleSplitTableCells"),4);this.ia.pa(M.a.C6f,ta.a.view,Object(R.a)(this,this.ksg,"handleDistributeRows"),4);this.ia.pa(M.a.B6f,ta.a.view,Object(R.a)(this,this.zVj,"handleDistributeColumns"),4);this.ia.pa(M.a.QWh,ta.a.view,Object(R.a)(this,this.ksg,"handleDistributeRows"),4);this.ia.pa(M.a.Ruh,
ta.a.view,Object(R.a)(this,this.nYj,"handlePopulateCellBorderColorMenu"),96);this.ia.pa(M.a.rvh,ta.a.view,Object(R.a)(this,this.DUj,"handleCellBorderRecentColor"),96);this.ia.pa(M.a.Ohh,ta.a.view,Object(R.a)(this,this.nXj,"handleMoreCellBorderColors"),96);this.ia.pa(M.a.GWh,ta.a.view,Object(R.a)(this,this.R_j,"handleTableBorderWidthAnchor"),4);this.ia.pa(M.a.XAa,ta.a.view,Object(R.a)(this,this.b_j,"handleSelectTableBorderWidth"),4);this.ia.pa(M.a.sWh,ta.a.view,Object(R.a)(this,this.P_j,"handleTableBorderColorAnchor"),
4);this.ia.pa(M.a.eOa,ta.a.view,Object(R.a)(this,this.a_j,"handleSelectTableBorderColor"),4);this.ia.pa(M.a.FWh,ta.a.view,Object(R.a)(this,this.Q_j,"handleTableBorderTypeAnchor"),4);this.ia.pa(M.a.ora,ta.a.view,Object(R.a)(this,this.s3c,"handleSelectTableBorderType"),4);this.ia.pa(M.a.uWh,ta.a.view,Object(R.a)(this,this.XZj,"handleSelectInsideTableBorderType"),4);this.ia.pa(M.a.tWh,ta.a.view,Object(R.a)(this,this.ttg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.pa(M.a.vWh,ta.a.view,Object(R.a)(this,
this.utg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.pa(M.a.H0e,ta.a.view,Object(R.a)(this,this.fZj,"handleQueryTableBorderWidth_1"),96);this.ia.pa(M.a.I0e,ta.a.view,Object(R.a)(this,this.gZj,"handleQueryTableBorderWidth_2"),96);this.ia.pa(M.a.J0e,ta.a.view,Object(R.a)(this,this.hZj,"handleQueryTableBorderWidth_3"),96);this.ia.pa(M.a.K0e,ta.a.view,Object(R.a)(this,this.iZj,"handleQueryTableBorderWidth_4"),96);this.ia.pa(M.a.L0e,ta.a.view,Object(R.a)(this,this.jZj,"handleQueryTableBorderWidth_5"),
96);this.ia.pa(M.a.M0e,ta.a.view,Object(R.a)(this,this.kZj,"handleQueryTableBorderWidth_6"),96);this.ia.pa(M.a.N0e,ta.a.view,Object(R.a)(this,this.lZj,"handleQueryTableBorderWidth_7"),96);this.ia.pa(M.a.O0e,ta.a.view,Object(R.a)(this,this.mZj,"handleQueryTableBorderWidth_8"),96);this.ia.pa(M.a.P0e,ta.a.view,Object(R.a)(this,this.nZj,"handleQueryTableBorderWidth_9"),96);this.ia.pa(M.a.C0e,ta.a.view,Object(R.a)(this,this.aZj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.pa(M.a.F0e,ta.a.view,
Object(R.a)(this,this.dZj,"handleQueryTableBorderType_RightBorder"),96);this.ia.pa(M.a.G0e,ta.a.view,Object(R.a)(this,this.eZj,"handleQueryTableBorderType_TopBorder"),96);this.ia.pa(M.a.w0e,ta.a.view,Object(R.a)(this,this.VYj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.pa(M.a.y0e,ta.a.view,Object(R.a)(this,this.XYj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.pa(M.a.x0e,ta.a.view,Object(R.a)(this,this.WYj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.pa(M.a.A0e,
ta.a.view,Object(R.a)(this,this.ZYj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.pa(M.a.B0e,ta.a.view,Object(R.a)(this,this.$Yj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.pa(M.a.z0e,ta.a.view,Object(R.a)(this,this.YYj,"handleQueryTableBorderType_InsideBorder"),96);this.ia.pa(M.a.E0e,ta.a.view,Object(R.a)(this,this.cZj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.pa(M.a.v0e,ta.a.view,Object(R.a)(this,this.UYj,"handleQueryTableBorderType_AllBorder"),
96);this.ia.pa(M.a.D0e,ta.a.view,Object(R.a)(this,this.bZj,"handleQueryTableBorderType_NoBorder"),96)}Sd(){}Dta(a){return a.rq()?md.a("TableBordersComplexTableFixEnabled"):!0}p_(){var a=!1;this.sa.Aa&&(a=this.oa.Zn(),a=!!a&&a.vd);return a}GUj(){return this.p_()?32:8}oYj(a,b,c,f,l){if(!this.p_())return 16;if(1===c)return 32;if(!l)return 8;a=this.sa.Aa;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Yb.Of.wea;b=Object.assign(new Rn.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});
Array.add(b.MenuSectionList,ql.f(a.Ld,AG.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,ql.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,ql.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));
c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,ql.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!0));md.a("ColorPickerHighlighterFix")&&(c=this.vB.Wgg(this.oa.yw()),ql.h(b,c,a.Ld));l.MenuItems=b;return 32}oXj(a,b,c,f,l){if(!this.p_())return ya.a.J(512500107,822,
10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ia(M.a.renderColorPicker,1,l);a=this.hLj();b={};b.currentColor=a;b.handleCommand=M.a.gtc;return this.ia.Ia(M.a.renderColorPicker,2,b)}FUj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.y7,c,l);if(!l)return ya.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),16;a=this.ia.Ia(M.a.y7,c,l);32===a&&this.ia.Ia(M.a.WDa,c,l);return a}EUj(a,b,c,f,l){if(!this.p_())return 16;if(1===c)return 32;
if(!l)return 8;b=b.node;l=Ze.Box4ColorHelper.uT(l);if(!l)return 8;c=this.Eb.xe(15);c.mc(b);c.Wc=a;a=b.cellShading;Sp.b(a);a.solidFillField=l;b.cellShading=a;c.dispose();ya.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",oP.a[this.ia.oq]));return 32}xZj(a,b,c){if(!this.p_())return 16;if(1===c)return 32;b=b.node;c=this.Eb.xe(15);c.mc(b);c.Wc=a;a=yl.a.Fi(b,yb.a.cellShading,new lT.a);Sp.b(a);a.noFillField=new Cz;b.cellShading=a;c.dispose();return 32}R_j(){const a=this.oa.$n();
return a&&this.p_()&&this.Ba.KNb&&this.Dta(a)?32:8}b_j(a,b,c,f,l){a=this.oa.$n();if(!(a&&this.p_()&&this.Dta(a)&&this.Ba.KNb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.LI=this.OA[1];break;case "TableBorderWidth_2":this.LI=this.OA[2];break;case "TableBorderWidth_3":this.LI=this.OA[3];break;case "TableBorderWidth_4":this.LI=this.OA[4];break;case "TableBorderWidth_5":this.LI=this.OA[5];break;case "TableBorderWidth_6":this.LI=this.OA[6];break;
case "TableBorderWidth_7":this.LI=this.OA[7];break;case "TableBorderWidth_8":this.LI=this.OA[8];break;case "TableBorderWidth_9":this.LI=this.OA[9]}this.nv.CB();return 32}xMa(a,b){return(a=Object(gb.a)(Di.a,a))?(this.LI===b?a.Rf(!0):a.Rf(!1),32):8}fZj(a,b,c,f,l){return this.xMa(l,this.OA[1])}gZj(a,b,c,f,l){return this.xMa(l,this.OA[2])}hZj(a,b,c,f,l){return this.xMa(l,this.OA[3])}iZj(a,b,c,f,l){return this.xMa(l,this.OA[4])}jZj(a,b,c,f,l){return this.xMa(l,this.OA[5])}kZj(a,b,c,f,l){return this.xMa(l,
this.OA[6])}lZj(a,b,c,f,l){return this.xMa(l,this.OA[7])}mZj(a,b,c,f,l){return this.xMa(l,this.OA[8])}nZj(a,b,c,f,l){return this.xMa(l,this.OA[9])}P_j(){const a=this.oa.$n();return a&&this.p_()&&this.Ba.Dlb&&this.Dta(a)?32:8}a_j(a,b,c,f,l){a=D(this.oa,l);b=a.$n();if(!(b&&a.p_(this.sa)&&this.Dta(b)&&this.Ba.Dlb))return 16;if(1===c)return 32;if(!l)return 8;this.Lx=Ze.Box4ColorHelper.uT(l);this.nv.CB();return 32}nYj(a,b,c,f,l){a=this.oa.$n();if(!(a&&this.p_()&&this.Dta(a)))return 16;if(1===c)return 32;
if(!l)return 8;c=this.sa.Aa;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Yb.Of.wea;b=Object.assign(new Rn.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,ql.f(c.Ld,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,ql.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",
!1)),Array.add(b.MenuSectionList,ql.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));l.MenuItems=b;return 32}DUj(a,b,c,f,l){if(1===c)return this.ia.Ia(M.a.eOa,c,l);if(!l)return ya.a.J(512500100,822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.Ia(M.a.eOa,c,l);32===a&&this.ia.Ia(M.a.WDa,c,l);return a}nXj(a,b,c,f,l){a=this.oa.$n();if(!(a&&
this.p_()&&this.Ba.Dlb&&this.Dta(a)))return ya.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ia(M.a.renderColorPicker,1,l);c=null;md.a("TableBorderPenColorPickerFix")?(b=this.sa.Aa,c=Ze.Box4ColorHelper.rma(this.Lx,b?b.Ld:null)):b.El&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=Ze.Box4ColorHelper.Xua(b.cellShading.solidFillField));b={};b.currentColor=c;b.handleCommand=M.a.eOa;return this.ia.Ia(M.a.renderColorPicker,
2,b)}Q_j(){const a=this.oa.$n();return a&&this.p_()&&this.Ba.Rba&&this.Dta(a)?32:8}XZj(a,b,c,f,l){if(2===c)return this.s3c(a,b,c,f,l);const u=this.ttg(a,b,c,f,l);a=this.utg(a,b,c,f,l);return 32===u||32===a?32:8}ttg(a,b,c,f,l){if(2===c)return this.s3c(a,b,c,f,l);c=this.oa.$n();a=!!c&&this.p_()&&this.Ba.Rba&&this.Dta(c);if(!a)return 8;if(this.oa.Js())return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.Cc.LG(c));if(!b||!b.length)return 16;a=!1;c=b[0].rowIndex;for(const u of b)if(c!==u.rowIndex){a=
!0;break}return a?32:8}utg(a,b,c,f,l){if(2===c)return this.s3c(a,b,c,f,l);c=this.oa.$n();a=!!c&&this.p_()&&this.Ba.Rba&&this.Dta(c);if(!a)return 8;if(this.oa.Js())return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.Cc.LG(c));if(!b||!b.length)return 16;a=!1;c=b[0].Yi;for(const u of b)if(c!==u.Yi){a=!0;break}return a?32:8}s3c(a,b,c,f,l){var u;b=D(this.oa,l);if(b.Js())return 16;const I=b.$n();if(!I)return 16;if(1===c)return this.Dta(I)?32:8;if(!l)return ya.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),
16;let T=b.yw();if(!T)return 16;T.length||(T=this.VFa(this.Cc.LG(I)));if(!T||!T.length)return ya.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;c=this.LI;let ja=Re.a.WI(c),ua=null!==(u=l.BorderColor)&&void 0!==u?u:this.Lx;const Ra=l.SourceControlId,eb=!!l.DoNotCreateTransaction;if(!Ra||!ua)return ya.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),8;this.QG.Ib(Ra)&&this.QG.ga(Ra)&&(ja=c=0,ua=Yt.a.parse("000000").mBa());
return pv.qjj(a,Ra,c.toString(),this.w0i(ua),oP.a[this.ia.oq],()=>{let Bb;eb||(Bb=this.Eb.xe(15),Bb.mc(I),Bb.Wc=a);this.Lkm(a,Ra,I,T,ja,ua);Bb&&Bb.dispose();return 32})}Lkm(a,b,c,f,l,u){switch(b){case "TableBordersTopBorder":this.HWa(c,f,l,u,!1,!1);break;case "TableBordersBottomBorder":this.CWa(c,f,l,u,!1,!1);break;case "TableBordersLeftBorder":this.FWa(c,f,l,u,!1,!1);break;case "TableBordersRightBorder":this.GWa(c,f,l,u,!1,!1);break;case "TableBordersInsideHorizontalBorder":this.DWa(c,f,l,u,!1,!1,
!1);break;case "TableBordersInsideVerticalBorder":this.EWa(c,f,l,u,!1,!1,!1);break;case "TableBordersInsideBorders":this.DWa(c,f,l,u,!1,!1,!1);this.EWa(c,f,l,u,!1,!1,!1);break;case "TableBordersOutsideBorders":this.HWa(c,f,l,u,!1,!1);this.CWa(c,f,l,u,!1,!1);this.FWa(c,f,l,u,!1,!1);this.GWa(c,f,l,u,!1,!1);break;case "TableBordersNoBorder":l=0;u=Yt.a.parse("000000").mBa();this.HWa(c,f,l,u,!1,!1);this.CWa(c,f,l,u,!1,!1);this.FWa(c,f,l,u,!1,!1);this.GWa(c,f,l,u,!1,!1);this.DWa(c,f,l,u,!1,!1,!1);this.EWa(c,
f,l,u,!1,!1,!1);this.Ba.QYe&&(this.Trg(f,l,u),this.Srg(f,l,u));break;case "TableBordersAllBorders":this.HWa(c,f,l,u,!1,!1);this.CWa(c,f,l,u,!1,!1);this.FWa(c,f,l,u,!1,!1);this.GWa(c,f,l,u,!1,!1);this.DWa(c,f,l,u,!1,!1,!1);this.EWa(c,f,l,u,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.Trg(f,l,u);break;case "TableBordersDiagonalDownBorder":this.Srg(f,l,u);break;default:ya.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",
b,a))}}VFa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}aZj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.FWa(a,b,c,this.Lx,!0,!1)?(this.QG.$("TableBordersLeftBorder",!0),l.Rf(!0)):(this.QG.$("TableBordersLeftBorder",!1),l.Rf(!1)),32):8}dZj(a,
b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.GWa(a,b,c,this.Lx,!0,!1)?(this.QG.$("TableBordersRightBorder",!0),l.Rf(!0)):(this.QG.$("TableBordersRightBorder",!1),l.Rf(!1)),32):8}eZj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||
(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.HWa(a,b,c,this.Lx,!0,!1)?(this.QG.$("TableBordersTopBorder",!0),l.Rf(!0)):(this.QG.$("TableBordersTopBorder",!1),l.Rf(!1)),32):8}VYj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),
16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.CWa(a,b,c,this.Lx,!0,!1)?(this.QG.$("TableBordersBottomBorder",!0),l.Rf(!0)):(this.QG.$("TableBordersBottomBorder",!1),l.Rf(!1)),32):8}ZYj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.Cc.LG(a));if(!b||!b.length)return ya.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.DWa(a,b,c,
this.Lx,!0,!1,!1)?(this.QG.$("TableBordersInsideHorizontalBorder",!0),l.Rf(!0)):(this.QG.$("TableBordersInsideHorizontalBorder",!1),l.Rf(!1)),32):8}$Yj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.Cc.LG(a));if(!b||!b.length)return ya.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.EWa(a,b,c,this.Lx,!0,!1,!1)?(this.QG.$("TableBordersInsideVerticalBorder",
!0),l.Rf(!0)):(this.QG.$("TableBordersInsideVerticalBorder",!1),l.Rf(!1)),32):8}XYj(a,b,c,f,l){return this.ftg(l,"TableBordersDiagonalUpBorder")}WYj(a,b,c,f,l){return this.ftg(l,"TableBordersDiagonalDownBorder")}ftg(a,b){if(!this.Ba.QYe)return 8;const c=this.oa.$n();if(!c||!a)return 16;var f=this.oa.yw();if(!f)return 16;f.length||(f=this.VFa(this.Cc.LG(c)));if(!f||!f.length)return ya.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",
b)),16;a=Object(gb.a)(Di.a,a);if(null===a)return 8;f=this.Wek(b,f,Re.a.WI(this.LI));this.QG.$(b,f);a.Rf(f);return 32}Wek(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.jBg(b,c,this.Lx,!1);case "TableBordersDiagonalDownBorder":return this.iBg(b,c,this.Lx,!1);default:return ya.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}YYj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.Cc.LG(a));if(!b||!b.length)return ya.a.J(512500058,
822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(1<b.length&&this.EWa(a,b,c,this.Lx,!0,!1,!0)&&this.DWa(a,b,c,this.Lx,!0,!1,!0)?(this.QG.$("TableBordersInsideBorders",!0),l.Rf(!0)):(this.QG.$("TableBordersInsideBorders",!1),l.Rf(!1)),32):8}cZj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),
16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.HWa(a,b,c,this.Lx,!0,!1)&&this.GWa(a,b,c,this.Lx,!0,!1)&&this.CWa(a,b,c,this.Lx,!0,!1)&&this.FWa(a,b,c,this.Lx,!0,!1)?(this.QG.$("TableBordersOutsideBorders",!0),l.Rf(!0)):(this.QG.$("TableBordersOutsideBorders",!1),l.Rf(!1)),32):8}UYj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(this.HWa(a,b,c,this.Lx,!0,!1)&&this.GWa(a,b,c,this.Lx,!0,!1)&&this.CWa(a,b,c,this.Lx,!0,!1)&&this.FWa(a,b,c,this.Lx,!0,!1)&&this.DWa(a,b,c,this.Lx,!0,!1,!0)&&this.EWa(a,b,c,this.Lx,!0,!1,!0)?(this.QG.$("TableBordersAllBorders",!0),l.Rf(!0)):(this.QG.$("TableBordersAllBorders",!1),l.Rf(!1)),32):8}bZj(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.yw();if(!b)return 16;b.length||(b=this.VFa(this.Cc.LG(a)));if(!b||!b.length)return ya.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(gb.a)(Di.a,l);c=Re.a.WI(this.LI);return l?(f=!0,this.Ba.QYe&&(f=this.jBg(b,c,this.Lx,!0)&&this.iBg(b,c,this.Lx,!0)),f&&this.HWa(a,b,c,this.Lx,!0,!0)&&this.GWa(a,b,c,this.Lx,!0,!0)&&this.CWa(a,b,c,this.Lx,!0,!0)&&this.FWa(a,b,c,this.Lx,!0,!0)&&this.DWa(a,b,c,this.Lx,!0,!0,!0)&&this.EWa(a,b,c,this.Lx,!0,!0,!0)?(this.QG.$("TableBordersNoBorder",!0),l.Rf(!0)):(this.QG.$("TableBordersNoBorder",!1),l.Rf(!1)),32):8}ZGa(a,
b){if(!a)return!1;const c=Ze.Box4ColorHelper.Eia(a),f=Ze.Box4ColorHelper.Eia(b);a=Ze.Box4ColorHelper.Xua(a);b=Ze.Box4ColorHelper.Xua(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.DE===b.DE:!1}w0i(a){a=Ze.Box4ColorHelper.Eia(a);const b=this.sa.Aa;return(a=Ze.Box4ColorHelper.ZI(a,b?b.Ld:null))&&Ze.Box4ColorHelper.Xia(a)?Ze.Box4ColorHelper.Xia(a).GW():null}nzb(a,b,c,f){if(a=Object(gb.a)(Ut,a.sc(this.yb.Na))){f=
Ze.Box4ColorHelper.Eia(f);var l=this.sa.Aa;f=(f=Ze.Box4ColorHelper.ZI(f,l?l.Ld:null))?Ze.Box4ColorHelper.Xia(f):null;a.UOl(b,c,f)}}mw(a,b,c,f){if(a)switch(b){case "Top":a.ZAa=c;a.gOa=f;this.nzb(a,"Top",c,f);break;case "Right":a.Qia=c;a.Oia=f;this.nzb(a,"Right",c,f);break;case "Bottom":a.Pia=c;a.Nia=f;this.nzb(a,"Bottom",c,f);break;case "Left":a.YAa=c;a.fOa=f;this.nzb(a,"Left",c,f);break;case "DiagonalUp":a.fpb=c;a.dpb=f;this.nzb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.epb=c,a.cpb=f,this.nzb(a,
"DiagonalDown",c,f)}}HWa(a,b,c,f,l,u){const I=new bd.ScriptSharpLegacyMap;let T=Number.MAX_VALUE,ja=-1;for(const ua of b)b=ua.Yi,T=Math.min(T,b),ja=Math.max(ja,b),I.Ib(b)?I.$(b,Math.min(I.ga(b),ua.rowIndex)):I.$(b,ua.rowIndex);if(l)return this.qsk(a,c,f,T,ja,I,u);this.oUj(a,c,f,T,ja,I);return!0}oUj(a,b,c,f,l,u){if(md.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const T=a.tf(u.ga(f),f);this.mw(T,"Top",b,c);let ja=f;const ua=f+T.colSpan;for(;ja<ua;){var I=a.tf(u.ga(f)-1,ja);I?I.isGhostCell?(I=
I.$z(),I.Yi<f?ja+=1:(this.mw(I,"Bottom",b,c),ja+=I.colSpan)):(this.mw(I,"Bottom",b,c),ja+=I.colSpan):ja+=1}f+=T.colSpan}else for(;f<=l;++f)this.mw(a.tf(u.ga(f),f),"Top",b,c),this.mw(a.tf(u.ga(f)-1,f),"Bottom",b,c)}qsk(a,b,c,f,l,u,I){for(;f<=l;){const T=a.tf(u.ga(f),f),ja=T.gOa,ua=Re.a.CN(T.ZAa),Ra=Re.a.CN(b);if(I){if(ua!==this.OA[0])return!1}else if(ua!==Ra||!this.ZGa(ja,c))return!1;f+=T.colSpan}return!0}CWa(a,b,c,f,l,u){const I=new bd.ScriptSharpLegacyMap;let T=Number.MAX_VALUE,ja=-1;for(const ua of b)b=
ua.Yi,T=Math.min(T,b),ja=Math.max(ja,b),I.Ib(b)?I.$(b,Math.max(I.ga(b),ua.rowIndex)):I.$(b,ua.rowIndex);if(l)return this.Zek(a,c,f,T,ja,I,u);this.YTj(a,c,f,T,ja,I);return!0}YTj(a,b,c,f,l,u){if(md.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const T=a.tf(u.ga(f),f);this.mw(T,"Bottom",b,c);let ja=f;const ua=f+T.colSpan;for(;ja<ua;){var I=a.tf(u.ga(f)+T.rowSpan,ja);I?I.isGhostCell?(I=I.$z(),I.Yi<f?ja+=1:(this.mw(I,"Top",b,c),ja+=I.colSpan)):(this.mw(I,"Top",b,c),ja+=I.colSpan):ja+=1}f+=T.colSpan}else for(;f<=
l;++f)this.mw(a.tf(u.ga(f),f),"Bottom",b,c),this.mw(a.tf(u.ga(f)+1,f),"Top",b,c)}Zek(a,b,c,f,l,u,I){for(;f<=l;){const T=a.tf(u.ga(f),f),ja=T.Nia,ua=Re.a.CN(T.Pia),Ra=Re.a.CN(b);if(I){if(ua!==this.OA[0])return!1}else if(ua!==Ra||!this.ZGa(ja,c))return!1;f+=T.colSpan}return!0}FWa(a,b,c,f,l,u){const I=new bd.ScriptSharpLegacyMap;let T=Number.MAX_VALUE,ja=-1;for(const ua of b)b=ua.rowIndex,T=Math.min(T,b),ja=Math.max(ja,b),I.Ib(b)?I.$(b,Math.min(I.ga(b),ua.Yi)):I.$(b,ua.Yi);if(l)return this.Ykk(a,c,f,
T,ja,I,u);this.eUj(a,c,f,T,ja,I);return!0}eUj(a,b,c,f,l,u){if(md.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const T=a.tf(f,u.ga(f));this.mw(T,"Left",b,c);let ja=f;const ua=f+T.rowSpan;for(;ja<ua;){var I=a.tf(ja,u.ga(f)-1);I?I.isGhostCell?(I=I.$z(),I.rowIndex<f?ja+=1:(this.mw(I,"Right",b,c),ja+=I.rowSpan)):(this.mw(I,"Right",b,c),ja+=I.rowSpan):ja+=1}f+=T.rowSpan}else for(;f<=l;++f)this.mw(a.tf(f,u.ga(f)),"Left",b,c),this.mw(a.tf(f,u.ga(f)-1),"Right",b,c)}Ykk(a,b,c,f,l,u,I){for(;f<=l;){const T=
a.tf(f,u.ga(f)),ja=T.fOa,ua=Re.a.CN(T.YAa),Ra=Re.a.CN(b);if(I){if(ua!==this.OA[0])return!1}else if(ua!==Ra||!this.ZGa(ja,c))return!1;f+=T.rowSpan}return!0}GWa(a,b,c,f,l,u){const I=new bd.ScriptSharpLegacyMap;let T=Number.MAX_VALUE,ja=-1;for(const ua of b)b=ua.rowIndex,T=Math.min(T,b),ja=Math.max(ja,b),I.Ib(b)?I.$(b,Math.max(I.ga(b),ua.Yi)):I.$(b,ua.Yi);if(l)return this.kpk(a,c,f,T,ja,I,u);this.fUj(a,c,f,T,ja,I);return!0}fUj(a,b,c,f,l,u){if(md.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const T=
a.tf(f,u.ga(f));this.mw(T,"Right",b,c);let ja=f;const ua=f+T.rowSpan;for(;ja<ua;){var I=a.tf(ja,u.ga(f)+T.colSpan);I?I.isGhostCell?(I=I.$z(),I.rowIndex<f?ja+=1:(this.mw(I,"Left",b,c),ja+=I.rowSpan)):(this.mw(I,"Left",b,c),ja+=I.rowSpan):ja+=1}f+=T.rowSpan}else for(;f<=l;++f)this.mw(a.tf(f,u.ga(f)),"Right",b,c),this.mw(a.tf(f,u.ga(f)+1),"Left",b,c)}kpk(a,b,c,f,l,u,I){for(;f<=l;){const T=a.tf(f,u.ga(f)),ja=T.Oia,ua=Re.a.CN(T.Qia),Ra=Re.a.CN(b);if(I){if(ua!==this.OA[0])return!1}else if(ua!==Ra||!this.ZGa(ja,
c))return!1;f+=T.rowSpan}return!0}EWa(a,b,c,f,l,u,I){b=this.oa.OBb();if(!b)return!1;b.length||(b=this.Cc.LG(a));if(!b||!b.length)return ya.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const T=new bd.ScriptSharpLegacyMap,ja=new bd.ScriptSharpLegacyMap;let ua=Number.MAX_VALUE,Ra=-1;for(const eb of b)b=eb.rowIndex,ua=Math.min(ua,b),Ra=Math.max(Ra,b),T.Ib(b)?T.$(b,Math.min(T.ga(b),eb.Yi)):T.$(b,eb.Yi),ja.Ib(b)?ja.$(b,Math.max(ja.ga(b),eb.Yi)):ja.$(b,eb.Yi);
if(l)return this.wkk(a,c,f,ua,Ra,T,ja,u,I);this.dUj(a,c,f,ua,Ra,T,ja);return!0}dUj(a,b,c,f,l,u,I){if(md.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(u.Ib(f)&&I.Ib(f))for(var T=u.ga(f),ja=I.ga(f);T<ja;){const Ra=a.tf(f,T);if(!Ra.isGhostCell&&Ra.Yi+Ra.colSpan<=ja){this.mw(Ra,"Right",b,c);let eb=f;const Bb=f+Ra.rowSpan;for(;eb<Bb;){var ua=a.tf(eb,T+Ra.colSpan);ua?ua.isGhostCell?(ua=ua.$z(),ua.rowIndex<f?eb+=1:(this.mw(ua,"Left",b,c),eb+=ua.rowSpan)):(this.mw(ua,"Left",b,c),eb+=ua.rowSpan):
eb+=1}}T+=Ra.colSpan}}else for(;f<=l;++f)for(T=u.ga(f),ja=I.ga(f);T<ja;++T)this.mw(a.tf(f,T),"Right",b,c),this.mw(a.tf(f,T+1),"Left",b,c)}wkk(a,b,c,f,l,u,I,T,ja){if(md.a("TableBordersComplexTableFixEnabled")){for(var ua=!1;f<=l;f++)if(u.Ib(f)&&I.Ib(f))for(var Ra=u.ga(f),eb=I.ga(f);Ra<eb;){var Bb=a.tf(f,Ra);if(!Bb.isGhostCell&&Bb.Yi+Bb.colSpan<=eb){var Ub=Bb.Oia;const Xb=Re.a.CN(Bb.Qia),tc=Re.a.CN(b);ua=!0;if(T){if(Xb!==this.OA[0])return!1}else if(Xb!==tc||!this.ZGa(Ub,c))return!1}Ra+=Bb.colSpan}return ua?
!0:ja}for(ua=f;ua<=l;++ua){eb=u.ga(ua);f=I.ga(ua);if(eb===f)return ja?!0:!1;for(;eb<f;++eb)if(Bb=a.tf(ua,eb),Ra=Bb.Oia,Bb=Re.a.CN(Bb.Qia),Ub=Re.a.CN(b),T){if(Bb!==this.OA[0])return!1}else if(Bb!==Ub||!this.ZGa(Ra,c))return!1}return!0}DWa(a,b,c,f,l,u,I){b=this.oa.OBb();if(!b)return!1;b.length||(b=this.Cc.LG(a));if(!b||!b.length)return ya.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const T=new bd.ScriptSharpLegacyMap,ja=new bd.ScriptSharpLegacyMap;
let ua=Number.MAX_VALUE,Ra=-1;for(const eb of b)b=eb.Yi,ua=Math.min(ua,b),Ra=Math.max(Ra,b),T.Ib(b)?T.$(b,Math.min(T.ga(b),eb.rowIndex)):T.$(b,eb.rowIndex),ja.Ib(b)?ja.$(b,Math.max(ja.ga(b),eb.rowIndex)):ja.$(b,eb.rowIndex);if(l)return this.vkk(a,c,f,ua,Ra,T,ja,u,I);this.cUj(a,c,f,ua,Ra,T,ja);return!0}cUj(a,b,c,f,l,u,I){if(md.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(u.Ib(f)&&I.Ib(f))for(var T=u.ga(f),ja=I.ga(f);T<ja;){const Ra=a.tf(T,f);if(!Ra.isGhostCell&&Ra.rowIndex+Ra.rowSpan<=
ja){this.mw(Ra,"Bottom",b,c);let eb=f;const Bb=f+Ra.colSpan;for(;eb<Bb;){var ua=a.tf(T+Ra.rowSpan,eb);ua?ua.isGhostCell?(ua=ua.$z(),ua.Yi<f?eb+=1:(this.mw(ua,"Top",b,c),eb+=ua.colSpan)):(this.mw(ua,"Top",b,c),eb+=ua.colSpan):eb+=1}}T+=Ra.rowSpan}}else for(;f<=l;++f)for(T=u.ga(f),ja=I.ga(f);T<ja;++T)this.mw(a.tf(T,f),"Bottom",b,c),this.mw(a.tf(T+1,f),"Top",b,c)}vkk(a,b,c,f,l,u,I,T,ja){if(md.a("TableBordersComplexTableFixEnabled")){for(var ua=!1;f<=l;f++)if(u.Ib(f)&&I.Ib(f))for(var Ra=u.ga(f),eb=I.ga(f);Ra<
eb;){var Bb=a.tf(Ra,f);if(!Bb.isGhostCell&&Bb.rowIndex+Bb.rowSpan<=eb){var Ub=Bb.Nia;const Xb=Re.a.CN(Bb.Pia),tc=Re.a.CN(b);ua=!0;if(T){if(Xb!==this.OA[0])return!1}else if(Xb!==tc||!this.ZGa(Ub,c))return!1}Ra+=Bb.rowSpan}return ua?!0:ja}for(ua=f;ua<=l;++ua){eb=u.ga(ua);f=I.ga(ua);if(eb===f)return ja?!0:!1;for(;eb<f;++eb)if(Bb=a.tf(eb,ua),Ra=Bb.Nia,Bb=Re.a.CN(Bb.Pia),Ub=Re.a.CN(b),T){if(Bb!==this.OA[0])return!1}else if(Bb!==Ub||!this.ZGa(Ra,c))return!1}return!0}Trg(a,b,c){for(const f of a)this.mw(f,
"DiagonalUp",b,c)}jBg(a,b,c,f){for(const l of a)if(!this.iFg(Re.a.CN(l.fpb),Re.a.CN(b),l.dpb,c,f))return!1;return!0}Srg(a,b,c){for(const f of a)this.mw(f,"DiagonalDown",b,c)}iBg(a,b,c,f){for(const l of a)if(!this.iFg(Re.a.CN(l.epb),Re.a.CN(b),l.cpb,c,f))return!1;return!0}iFg(a,b,c,f,l){if(l){if(a!==this.OA[0])return!1}else if(a!==b||!this.ZGa(c,f))return!1;return!0}Q0e(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[Xh.a.On]=!1;a=this.VYa[a.toString()];if(!this.oa||!this.oa.Oa.kb||this.oa.P$())return 16;
const u=this.oa.Oa;let I=0;(()=>{let T=this.Cc.YDd(u);({oza:I}=T);return T})().returnValue&&I===a&&(l[Xh.a.On]=!0);return 32}Dxc(a,b){a=a.queryResult;null!==a&&(a.uca=parseFloat(b.toFixed(2)).toString())}muc(a,b,c,f,l){if(!l)return 16;l.Rf(this.Tlc);return 32}xxc(a,b,c){if(1===c)return 32;2===c&&(this.Tlc=!this.Tlc);ad.App.Ob.OB({SetLockAspectRatio:"CheckboxModel"});return 32}Oyh(a,b,c,f,l){if(!l)return 16;b=this.oa.$n();if(!b)return 8;a=a===M.a.Wuc?this.Cc.qle(b):this.Cc.sle(b);this.Dxc(l,Re.a.Ov(a));
return 32}NNh(a,b,c,f,l){const u=this.oa.$n();return a!==M.a.Uqa&&a!==M.a.FNa||!u?16:1===c?32:jh.a(String.format("{0}::Entry point:{1}",M.a.Fv(a),this.ia.oq),a,()=>{if(!l)return ya.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var I=Re.a.gY(l.Number);var T=a===M.a.Uqa?this.Cc.qle(u):this.Cc.sle(u);if(I<gx.a.Dmd||T<gx.a.Dmd)return 16;I/=T;T=this.Eb.xe(15);try{T.mc(u),T.Wc=a,a===M.a.Uqa?(this.Nt.Uqa(u,I),this.Tlc&&this.Nt.FNa(u,I)):(this.Nt.FNa(u,I),this.Tlc&&this.Nt.Uqa(u,I)),
this.Nt.m2a(u)}finally{T&&T.dispose()}return 32})}JOb(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.P1c();if(!b)return 16;b.length||(b=this.Cc.Gma(a));if(!b.length)return 16;a=this.u0a.Bhg(b);this.Dxc(l,Re.a.Ov(a));return 32}D3a(a,b,c,f,l){const u=this.oa.$n();return u?1===c?32:jh.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.oq),a,()=>{if(null===l)return ya.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let I=this.oa.P1c();if(!I)return ya.a.J(512500050,
822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),16;I.length||(I=this.Cc.Gma(u));if(!I.length)return 16;let T=gx.a.xhh;a!==M.a.mBd&&(T=l.Number);const ja=this.Eb.xe(15);try{ja.mc(u),ja.Wc=a,this.Nt.MNh(I,T)}finally{ja&&ja.dispose()}this.Nt.m2a(u);return 32}):16}IOb(a,b,c,f,l){a=this.oa.$n();if(!a)return 16;b=this.oa.OBb();if(!b)return 16;b.length||(b=this.YBb(a));if(!b.length)return 16;a=this.RK.Dhg(a,b);this.Dxc(l,Re.a.Ov(a));return 32}ENa(a,b,c,f,l){const u=this.oa.$n();
return u?1===c?32:jh.a(String.format("SetTableColumnWidth::Entry point:{0}",this.ia.oq),a,()=>{if(null===l)return ya.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var I=this.oa.OBb();if(!I)return ya.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;I.length||(I=this.YBb(u));if(!I.length)return 16;let T=gx.a.whh;a!==M.a.lBd&&(T=l.Number);I=this.RK.Cge(I);const ja=this.Eb.xe(15);try{ja.mc(u),ja.Wc=a,this.Nt.LNh(u,I,T)}finally{ja&&
ja.dispose()}this.Nt.m2a(u);return 32}):16}ksg(a,b,c,f,l){const u=this.oa.$n();return u?1===c?md.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:u.rq()?8:32:jh.a("HandleDistributeRows:Entry point:"+this.ia.oq,a,()=>{if(2===c){if(null===l)return 16;let ja=this.oa.P1c();if(!ja)return 16;var I=this.oa.yw();if(!I)return 16;ja.length&&1!==I.length||(ja=this.Cc.Gma(u));if(!ja)return 16;if(!ja.length)return ya.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;I=0;
for(var T of ja)T&&(I+=this.u0a.rcb(T));T=this.zFj(ja,u);const ua=ja.length;I=I<ua*T?T:I/ua;T=this.Eb.xe(15);try{T.mc(u),T.Wc=a,this.Nt.MNh(ja,Re.a.Ov(I))}finally{T&&T.dispose()}ya.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",Re.a.Ov(I),this.ia.oq);this.Nt.m2a(u)}return 32}):16}zFj(a,b){let c=Re.a.gY(gx.a.xhh);for(const l of a){a=this.Cc.Scb(l);for(const u of a)if(u&&(a=u.U9b)&&(a=$a.ParagraphReader.text(a))&&0<a.length){var f=u.rowIndex;
const I=u.Yi;if(a=Object(gb.a)(Ut,u.sc(this.yb.Na)))this.wZ.lwh(b,this.yb.Na),f=this.wZ.R$b(b,a.vla,f,I),a=a.Vd.Xd.Cf(f,1),md.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<u.rowSpan&&(a/=u.rowSpan),c=Math.max(c,a)}}return c}zVj(a,b,c,f,l){const u=this.oa.$n();return u?1===c?md.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:u.rq()?8:32:jh.a("HandleDistributeColumns:Entry point:"+this.ia.oq,a,()=>{if(2===c){if(null===l)return 16;var I=this.oa.OBb();I.length||(I=this.YBb(u));if(!I)return 16;
var T=this.oa.yw();if(!T)return 16;I.length&&1!==T.length||(I=this.YBb(u));if(!I.length)return ya.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;T=0;I=this.RK.Cge(I);if(!I)return ya.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var ja=u.wge;if(!ja)return ya.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let ua=0;ua<I.length;ua++)T+=ja[I[ua]];T/=I.length;if(Re.a.Ov(T)<gx.a.whh)return 16;
ja=this.Eb.xe(15);try{ja.mc(u),ja.Wc=a,this.Nt.LNh(u,I,Re.a.Ov(T))}finally{ja&&ja.dispose()}ya.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",Re.a.Ov(T),this.ia.oq);this.Nt.m2a(u)}return 32}):16}gne(a,b,c,f,l){if(!this.Ba.eye||this.oa.P$())return 16;if(1===c)return 32;if(!l)return 8;c=this.VYa[a.toString()];b=b.node;f=this.Eb.xe(15);f.mc(b);f.Wc=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.pra=c;f.dispose();return 32}SWj(a,b,
c,f,l){b=this.sa.Aa;if(!b||this.uf.Xc(b))return 16;if(!this.Lj.UD(b,1))return this.Lj.yE(b),16;c=l.Rows;f=l.Columns;l=l.From;var u=b.Fb;u=b.T4(u.sid,u.cid,0,c,f,b.wt());var I=b.U0(this.oa.Hd());if(I){if(this.uf.Xc(I)||this.Ga.kK(I))return 16;this.Vk.QOl(u,I.id);this.uf.mx(I,a)}I=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()});try{I.mc(b),I.Wc=a,b.ZB(u)}finally{I&&I.dispose()}this.oa.selectShape(u,!0);ya.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Dr.YA=u;return 32}TWj(){(new qP((a,
b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.Ia(M.a.hsd,2,c)})).zAd();return 32}UWj(a,b,c,f,l){l.From="Ribbon";return this.ia.Ia(M.a.hsd,c,l)}vVj(a,b,c){b=this.sa.Aa;if(!b||this.oa.P$())return 16;const f=this.oa.Zn();if(!f||!f.vd||this.uf.Xc(f))return 16;if(1===c)return 32;$c.a.CQ(!0,!0);c=this.Eb.ud(15,void 0,()=>{this.oa.setSelection(null);this.Fa.Gd()});try{c.mc(b),c.Wc=a,this.Vk.zVc(f)}finally{c&&c.dispose()}this.uf.mx(b,a);return 32}xVj(a,b,c,f,l){if(this.oa.Js())return 16;
a=this.hke(this.oa.Ik,!0,this.oa);return this.dek(a)?16:32!==a.response?8:a.DB&&a.DB.length===Jd.TableReader.fl(a.Yn)?this.ia.nb(M.a.rNb,c):this.ia.Ai(b,G.a.deleteRow,c,!1,f,l)}wVj(a,b,c,f,l){if(this.oa.Js())return 16;a=this.hke(this.oa.Ik,!1,this.oa);return this.cek(a)?16:32!==a.response?8:a.DB&&a.DB.length===Jd.TableReader.ej(a.Yn)?this.ia.nb(M.a.rNb,c):this.ia.Ai(b,G.a.mFa,c,!1,f,l)}$Zj(a,b,c,f,l){return 1===c?32:this.ia.Ai(b,M.a.tla,c,!1,f,l)}lXj(a,b,c){if(this.oa.Js()||this.oa.P$()||!this.Ba.f9c)return 16;
b=this.oa.Oa;if(!b||!b.qm||1===b.length&&1===b.ga(0).length)return 16;b=this.EKb.xbc(b);if(!b)return ya.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.Uok)return 16;if(1===c)return 32;$c.a.Kb&&($c.a.Kb.tk=!0,$c.a.Kb.xG=new Date);ya.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Eb.xe(15);c.mc(f);c.Wc=a;a=this.kdh.merge(f,b.ixb,b.w_);a=Mr.TableNodeContext.create(a);a=$d.SelectionFactory.U6b($d.SelectionFactory.Dv(a));this.oa.VF(a);c.dispose();ya.a.J(36721630,
822,50,"Table merge cells succeeded");return 32}F_j(a,b,c,f,l){if(this.oa.Js()||this.oa.P$()||!this.Ba.jye)return 16;a=null;a=this.oa.Oa.qm?this.EKb.xbc(this.oa.Oa):this.EKb.LMj(b.view.Rb.Ik);if(!a)return 16;const u=a.tableNode.vg(this.yb.Na);if(u&&!u.Wkk)return ya.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const I=Object(gb.a)(745,a.tableNode);if(this.Cc.bue(I))return 16;const T=a.ixb;let ja,ua;if(!(()=>{let Xb=this.Gdm(I,T);({rows:ja,cols:ua}=Xb);return Xb})().returnValue)return 8;
if(1===c)return 1<ja||1<ua?32:16;const Ra=a.w_;b=new Date;const {rows:eb,cols:Bb}=this.nwj(I,Ra,T,u);if(c=$c.a.Kb)c.Wa("GetClientSplitLimit",(+new Date-+b).toString()),c.gq=!1;const Ub=(Xb,tc)=>{this.kdh.y4l(I,T,Xb,tc,Ra,u,this.yb.Xd,Object(R.a)(this,this.Jlg,"getNewOutlineElementInfoFromCell"),()=>{})};l&&l.rows&&l.columns&&!Number.isNaN(l.rows)&&!Number.isNaN(l.columns)?(b=Number.parseInt(l.rows),l=Number.parseInt(l.columns),l>Bb&&(l=Bb),b>eb&&(b=eb),Ub(b,l)):(new rP((Xb,tc)=>{Ub(Xb,tc)},Math.min(ja,
eb),Math.min(ua,Bb))).zAd();return 32}IZj(a,b,c,f,l){if(!l||!Object(gc.a)(Array,l))return 8;if(1!==l.length)return ya.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.uf.Xc(l[0].hT))return 16;b=l[0].hT;if(!(b&&b.isConnected&&b.isResizable&&b.vd)||b.kK)return ya.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(gb.a)(178,b.sc(this.yb.Na));if(!f)return ya.a.J(512500034,822,50,
"Fallback table resize fail: shape {0} has no shapeviewelement",b.get_shapeId()),8;const u=this.Cc.XO(b);if(!u)return ya.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const I=u.sc(this.yb.Na);if(!I)return ya.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].lzb)return f&&f.setOffsets(new Mi.a,!0),ya.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),
8;if(1===c)return 32;let T=c=1;try{f.Nk.wJh.Vxb.length||(this.Uhd=new Mi.a);f.setOffsets(new Mi.a,!0);var ja=I.wbc();const ua=this.wIa.Tm(ja.lc-ja.oc),Ra=this.wIa.Tm(ja.jc-ja.pc),eb=new pd.a(f.x+ua,f.y+Ra),Bb=new pd.a(f.tia(l[0].Shh.x),f.tia(l[0].Shh.y)),Ub=Ll.x3d(l[0].lzb,ja,Bb,!1,!1);c=ua?1+(Ub.right-Ub.left)/ua:1;T=Ra?1+(Ub.bottom-Ub.top)/Ra:1;I.PNh(c,T);const Xb=I.wbc();let tc=ej.a.Jac(Xb,ja);tc.Pj(1/f.Jd);this.Uhd&&(tc=Mi.a.add(tc,this.Uhd));f.setOffsets(tc,!0);this.Uhd=tc;l[0].f3.Pj(f.Jd);this.ddf(l[0].lzb,
f,Xb,eb,l[0].f3)}catch(ua){return ya.a.J(512500002,822,50,"Fallback table resize fail: ",ua.toString()),8}ja=this.Eb.xe(15);ja.mc(u);ja.Wc=a;a=I.Vd.Xd;this.Nt.Q4e(u,c,T,I,a);if(pv.tHa(l[0].lzb)||pv.tHa(l[0].lzb,!0))l=a.Cf(f.x,0),a=a.Cf(f.y,1),b.zz=l,b.Az=a;ja.dispose();return 32}Gdm(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.Cc.fl(a))/b.hQ)+1),f=Math.max(1,Math.floor((35-this.Cc.ej(a))/b.NS)+1),{returnValue:!0,rows:c,cols:f}}catch(l){ya.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",
l.toString())}return{returnValue:!1,rows:c,cols:f}}nwj(a,b,c,f){a=this.sga.KFa(a,b,c);b=f.Nng();f=f.ohg();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const u=a.cB;l=Math.min(l,b[u.rg]-b[u.Ae]);c=Math.min(c,f[u.hg]-f[u.qe])}return{rows:Math.max(1,Math.floor(l/sP.a)),cols:Math.max(1,Math.floor(c/sP.a))}}Jlg(a){const b=ti.omg(a,!1);b.style||(b.style=new qq.a);a=Object(gb.a)(mb.GraphIterator,this.Ub.Pc(a));a.Zv();if(a.tC(1)){if(Kc.ListReader.hl(a)){const f=this.lB.Aw(a),l=Gf.a.JO(f.listType,f.listStyle);
0===l.listType&&(l.EB=l.BY=f.EB);f.propertySet.Qa(rb.a.Dj)&&l.propertySet.setValue(rb.a.Dj,f.propertySet.$a(rb.a.Dj));f.propertySet.Qa(rb.a.font)&&l.propertySet.setValue(rb.a.font,f.propertySet.$a(rb.a.font));f.propertySet.Qa(yb.a.autonumberBulletType)&&l.propertySet.setValue(yb.a.autonumberBulletType,f.propertySet.$a(yb.a.autonumberBulletType));b.style.fz(l.propertySet)}var c;(c=b.style).eab.apply(c,[a.currentNode].concat(Um.gme()));if(c=a.tC(2)){let f;(f=b.style).eab.apply(f,[c].concat(Um.gme()));
a.Dc()}}return b}QJj(a,b,c){const f=new Fs;f.response=8;if(!a)return f;var l=Uh.ContextSetEditor.instance.dC(a);if(1===l.length&&l[0].El&&(a=l[0].node)&&a.vd)return this.PJj(a,b,c);let u=a=null,I=!1;const T=[];for(var ja=0;ja<l.length;++ja)if(l[ja].El){var ua=Object(gb.a)(5,l[ja].node);if(!ua||!ua.Ft())return f;ua=ua.xM();a||(a=b?ua.getContainingTable().firstRow:ua.o_c());u?u!==ua&&(I=!0):u=ua}if(!a)return f;ja=a.getContainingTable();if(!ja)return f;if(I){c=new La.a;if(this.JWg){l=this.EKb.xbc(this.oa.Oa).ixb;
if(l.aVa())return f;if(b)c.add(0);else for(b=l.Ae;b<l.rg;b++)c.add(b);ya.a.J(5125E5,822,50,"Insert {0} rows",c.count)}else if(c=this.ixj(l),1!==c.count)return f;b=ja.Mng(c.ga(0));for(l=0;l<c.count;l++)if(!md.a("TableHeaderUndoFix")||b)Array.add(T,me.a.create(Object(gb.a)(Zg.a,b))),b=b.pLa}else{if(!c)for(b=u.rowSpan;0<--b;)a=a.pLa;Array.add(T,me.a.create(Object(gb.a)(Zg.a,a)))}f.DB=T;f.U3a=Object(gb.a)(Zg.a,a);f.Yn=Object(gb.a)(Zg.a,ja);f.vLa=T.length;if(this.Ba.Yu||!Jd.TableReader.nu(f.Yn))f.response=
32;return f}JJj(a,b,c){const f=new Fs;f.response=8;if(!a)return f;var l=Uh.ContextSetEditor.instance.dC(a);if(1===l.length&&l[0].El&&(a=l[0].node)&&a.vd)return this.IJj(a,b,c);var u=null;let I=null,T=!1;a=[];for(let ua=0;ua<l.length;++ua)if(l[ua].El){var ja=Object(gb.a)(5,l[ua].node);if(!ja||!ja.Ft())return f;ja=ja.xM();u||(u=b?ja.getContainingTable().tf(0,0):ja.Jhg());I?I!==ja&&(T=!0):I=b?ja.getContainingTable().tf(0,0):ja}if(!I||!u)return f;u=u.getContainingTable();if(!u)return f;if(T){c=new La.a;
if(this.JWg){l=this.EKb.xbc(this.oa.Oa).ixb;if(l.aVa())return f;if(b)c.add(0);else for(b=l.qe;b<l.hg;b++)c.add(b);ya.a.J(512499998,822,50,"Insert {0} columns",c.count)}else if(b?c.add(0):c=this.gxj(l),1!==c.count)return f;I=u.tf(0,c.ga(0));for(b=0;b<c.count;b++)Array.add(a,me.a.create(Object(gb.a)(Zg.a,I))),I=I.V0()}else c&&(I=u.tf(0,I.Yi+I.colSpan-1)),Array.add(a,me.a.create(Object(gb.a)(Zg.a,I)));f.DB=a;f.U3a=Object(gb.a)(Zg.a,I);f.Yn=Object(gb.a)(Zg.a,u);f.vLa=a.length;if(this.Ba.Yu||!u.rq())f.response=
32;return f}ixj(a){const b=new La.a,c=new bd.ScriptSharpLegacyMap;let f=0;for(let I=0;I<a.length;++I)if(a[I].El){var l=Object(gb.a)(5,a[I].node);if(l&&l.Ft()){f++;var u=l.xM();l=u.rowIndex;for(u=l+u.rowSpan;l<u;l++)if(c.Ib(l)){let T;c.$(T=l,c.ga(T)+1)}else c.add(l,1)}}for(const I of c.keys)c.ga(I)===f&&b.add(I);return b}gxj(a){const b=new La.a,c=new bd.ScriptSharpLegacyMap;let f=0;for(let I=0;I<a.length;++I)if(a[I].El){var l=Object(gb.a)(5,a[I].node);if(l&&l.Ft()){f++;var u=l.xM();l=u.Yi;for(u=l+
u.colSpan;l<u;l++)if(c.Ib(l)){let T;c.$(T=l,c.ga(T)+1)}else c.add(l,1)}}for(const I of c.keys)c.ga(I)===f&&b.add(I);return b}LJj(a){return vo.a(a)}NJj(a){const b=new Fs;b.response=8;if(!a)return b;if(a.qm){var c=a.e4a;a=a.Vla;if(!c||!a)return b;c=Object(gb.a)(650,c.currentNode);a=Object(gb.a)(650,a.currentNode);if(!c||!a)return b;var f=c.Yi;a=a.Yi;if(f>a){var l=f;f=a;a=l}}else{c=Me.a.Jwb(a);c=Uh.ContextSetEditor.instance.dC(c);if(!c||1>c.length||!c[0].El)return b;c=Object(gb.a)(5,c[0].node);if(!c||
!c.Ft())return b;c=c.xM();a=f=c.Yi}l=this.Cc.ybc(c);if(!l||14!==l.type||0>f||0>a)return b;const u=[];let I=l.tf(0,f);if(!I)return b;for(;f<=a;)Array.add(u,me.a.create(Object(gb.a)(Zg.a,I))),I=I.V0(),f++;b.DB=u;b.U3a=Object(gb.a)(Zg.a,c);b.Yn=Object(gb.a)(Zg.a,l);b.vLa=u.length;if(this.Ba.Yu||!l.rq())b.response=32;return b}SJj(a){const b=new Fs;b.response=8;if(!a)return b;if(a.qm){var c=a.e4a;a=a.Vla;if(!c||!a)return b;var f=Sk.c(c);a=Sk.c(a);c=Object(gb.a)(Sm.TableCellNode,c.currentNode);if(f>a){var l=
f;f=a;a=l}}else{a=Me.a.Jwb(a);a=Uh.ContextSetEditor.instance.dC(a);if(!a||1>a.length||!a[0].El)return b;a=Object(gb.a)(5,a[0].node);if(!a||!a.Ft())return b;c=a.xM();a=f=c.rowIndex}if(!c)throw ya.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const u=[];let I=l.tf(f,0).o_c();for(;f<=a;)Array.add(u,me.a.create(Object(gb.a)(Zg.a,I))),I=I.pLa,f++;b.DB=u;b.U3a=Object(gb.a)(Zg.a,
c);b.Yn=Object(gb.a)(Zg.a,l);b.vLa=u.length;if(this.Ba.Yu||!Jd.TableReader.nu(b.Yn))b.response=32;return b}gTj(a,b){if(a=Object(gb.a)(Sm.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.V0();else a=a.acb();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().tf(b.rowIndex,a.Yi),a=a.$z(),mb.GraphIterator.ob(Object(gb.a)(Zg.a,a)))}}hke(a,b,c){const f=new Fs;f.response=8;if(!a||!c||!c.Oa)return f;const l=[],u=[];c=c.Oa;if(c.qm){if(c=this.EKb.xbc(c))if(a=c.ixb,c=c.tableNode.firstRow,
b)for(b=0;b<=a.sze;b++){var I=c.rowIndex;I>=a.$cg&&I<=a.sze&&l.push(c);c=c.pLa}else for(b=c.Scg,c=0;c<=a.jze;c++)I=b.Yi,I>=a.Tcg&&I<=a.jze&&u.push(b),b=b.V0()}else for(a=Uh.ContextSetEditor.instance.dC(a),c=0;c<a.length;++c)if(a[c].El){I=Object(gb.a)(5,a[c].node);if(!I||!I.Ft())return f;var T=I.xM();if(b)for(I=T.rowSpan,T=T.o_c();0<I--;)Array.contains(l,T)||l.push(T),T=T.pLa;else for(I=T.colSpan,T=T.Jhg();0<I--;)Array.contains(u,T)||u.push(T),T=T.V0()}if(!l.length&&!u.length)return f;b=[];for(a=0;a<
l.length;a++)Array.add(b,me.a.create(Object(gb.a)(Zg.a,l[a])));for(a=0;a<u.length;a++)Array.add(b,me.a.create(Object(gb.a)(Zg.a,u[a])));f.DB=b;f.U3a=0<l.length?Object(gb.a)(Zg.a,l[0]):Object(gb.a)(Zg.a,u[0]);f.Yn=0<l.length?Object(gb.a)(Zg.a,l[0].getContainingTable()):Object(gb.a)(Zg.a,u[0].getContainingTable());if(this.Ba.Yu||!Object(gb.a)(745,f.Yn).rq())f.response=32;return f}dek(a){if(!a.DB)return!1;for(let c=0;c<a.DB.length;c++){var b=Object(gb.a)(me.a,a.DB[c]);if(b&&(b=Object(gb.a)(746,b.node))){b=
this.Cc.Scb(b);for(const f of b)if(f&&f.FDb)return!0}}return!1}cek(a){if(!a.DB)return!1;var b=Object(gb.a)(745,a.Yn);if(!b)return!1;var c=Object(gb.a)(me.a,a.DB[0]);if(!c)return!1;c=Object(gb.a)(650,c.node);if(!c)return!1;c=Object(gb.a)(mb.GraphIterator,this.Ub.Pc(c));c.uc(14);b=this.Cc.fl(b);a=a.DB.length;const f=new mb.GraphIterator;f.Uc(c);for(let l=0;l<b;l++){for(let u=0;u<a;u++){const I=Object(gb.a)(650,c.currentNode);if(I&&I.FDb)return!0;c.Qf(1)}ce.moveToNextRow(f);c.Uc(f)}return!1}YBb(a){let b=
null;a&&14===a.type&&(b=this.Cc.nle(a.firstRow));return b}ddf(a,b,c,f,l){var u=pv.tHa(a);a=pv.tHa(a,!0);if(u||a)u=this.wIa.Tm(c.lc-c.oc),c=this.wIa.Tm(c.jc-c.pc),f._x+=this.wIa.Tm(l.right),f._y+=this.wIa.Tm(l.bottom),b.setPosition(f.x-u,f.y-c,!0)}hLj(){var a=null;const b=this.sa.Aa;var c=this.oa.yw();if(md.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.oa.$n())a=c.tf(0,0),a=Ze.Box4ColorHelper.rma(a.cellShading.solidFillField,b.Ld);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?
Ze.Box4ColorHelper.rma(c.cellShading.solidFillField,b.Ld):this.vB.UZc(Object(gb.a)(Zg.a,c)))}return a}static qjj(a,b,c,f,l,u){const I=$c.a.Zj("HandleSelectTableBorderType");I.Wa("CommandId",a.toString());I.Wa("BorderType",b);I.Wa("BorderWidth",c);I.Wa("BorderColor",f);I.Wa("CommandLocation",l);try{return u()}finally{I.finish(!0)}}static tHa(a,b){b=void 0===b?!1:b;return a.equals(Ge.a.Pv)?!0:b?a.equals(Ge.a.north)||a.equals(Ge.a.IF):a.equals(Ge.a.west)||a.equals(Ge.a.hJ)}}Object(m.a)(pv,"TableActor",
null,[948]);class hx{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(m.a)(hx,"TableCellMargin",null,[]);class ix{constructor(a,b,c,f,l,u,I,T){this.RKa=null;this.Pfd=0;this.$pm=Re.a.Qrd(2);this.L3f=Object.assign(new hx,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.K3f=Object.assign(new hx,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.J3f=Object.assign(new hx,{marginTop:.05,marginBottom:.05,marginLeft:.05,marginRight:.05});
this.W3f=Object.assign(new hx,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.d1h=Object.assign(new hx,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(u){if(!I)throw ya.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!T)throw ya.a.J(512499989,822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw ya.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw ya.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");
else throw ya.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw ya.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw ya.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw ya.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ba=b;this.Eb=c;this.sa=f;this.oa=l;this.Cc=u;this.tHk=I.K7d(50,Object(R.a)(this,this.K9a,"applyPendingChangesToServerIfRequired"));this.yb=T}qb(){this.ia.pa(M.a.jdf,ta.a.view,Object(R.a)(this,
this.pcc,"handleTableCellMargins"),4);this.ia.pa(M.a.Uzc,ta.a.tableCell,Object(R.a)(this,this.pcc,"handleTableCellMargins"),4);this.ia.pa(M.a.Ttd,wc.a.application,Object(R.a)(this,this.o3c,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(M.a.Tzc,ta.a.tableCell,Object(R.a)(this,this.pcc,"handleTableCellMargins"),4);this.ia.pa(M.a.Std,wc.a.application,Object(R.a)(this,this.o3c,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(M.a.Szc,ta.a.tableCell,Object(R.a)(this,this.pcc,"handleTableCellMargins"),
4);this.ia.pa(M.a.Rtd,wc.a.application,Object(R.a)(this,this.o3c,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(M.a.Xzc,ta.a.tableCell,Object(R.a)(this,this.pcc,"handleTableCellMargins"),4);this.ia.pa(M.a.Utd,wc.a.application,Object(R.a)(this,this.o3c,"handleQueryTableCellDefaultMargins"),96);this.ia.xa(M.a.Uzc,ta.a.view,Lc.pma);this.ia.xa(M.a.Tzc,ta.a.view,Lc.pma);this.ia.xa(M.a.Szc,ta.a.view,Lc.pma);this.ia.xa(M.a.Xzc,ta.a.view,Lc.pma);this.ia.pa(M.a.Rzc,ta.a.view,Object(R.a)(this,this.v3c,
"handleTableCellCustomMargins"),4);this.ia.pa(M.a.Tuc,ta.a.view,Object(R.a)(this,this.n3c,"handleQueryTableCellCustomMargins"),96);this.ia.pa(M.a.Vzc,ta.a.view,Object(R.a)(this,this.v3c,"handleTableCellCustomMargins"),4);this.ia.pa(M.a.Uuc,ta.a.view,Object(R.a)(this,this.n3c,"handleQueryTableCellCustomMargins"),96);this.ia.pa(M.a.Wzc,ta.a.view,Object(R.a)(this,this.v3c,"handleTableCellCustomMargins"),4);this.ia.pa(M.a.Vuc,ta.a.view,Object(R.a)(this,this.n3c,"handleQueryTableCellCustomMargins"),96);
this.ia.pa(M.a.Qzc,ta.a.view,Object(R.a)(this,this.v3c,"handleTableCellCustomMargins"),4);this.ia.pa(M.a.Suc,ta.a.view,Object(R.a)(this,this.n3c,"handleQueryTableCellCustomMargins"),96)}Sd(){}pcc(a,b,c,f,l){return this.NPh(a)?1===c?32:jh.a("HandleTableCellMargins:Entry point:"+this.ia.oq,a,()=>{if(!l)return ya.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return ya.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),
16;const u=b.node,I=this.lkj(a);if(!I)return ya.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const T=this.Eb.xe(15);T.mc(u);T.Wc=a;this.LOf(u,I);T.dispose();ya.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.oq,a);return 32}):(ya.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}o3c(a,b,c,f,l){if(!this.Ba.gTb)return 8;b=Object(gb.a)(Di.a,l);if(!b)return 16;f=this.oa.$n();if(!f)return ya.a.J(512499983,
822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.oa.yw();if(!c)return 16;c.length||(c=this.Cc.LG(f));if(!c||!c.length)return ya.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case M.a.Ttd:f=this.k_c(c,this.L3f);break;case M.a.Std:f=this.k_c(c,this.K3f);break;case M.a.Rtd:f=this.k_c(c,this.J3f);break;case M.a.Utd:f=this.k_c(c,this.W3f)}b.Rf(f);return 32}k_c(a,b){for(const c of a)if(c&&!c.isGhostCell&&
(Re.a.Ov(c.marginTop)!==b.marginTop||Re.a.Ov(c.marginBottom)!==b.marginBottom||Re.a.Ov(c.marginLeft)!==b.marginLeft||Re.a.Ov(c.marginRight)!==b.marginRight))return!1;return!0}lkj(a){let b=Xk.b(this.d1h);switch(a){case M.a.Uzc:b=this.L3f;break;case M.a.Tzc:b=this.K3f;break;case M.a.Szc:b=this.J3f;break;case M.a.Xzc:b=this.W3f}return b}LOf(a,b){0<=b.marginLeft&&(a.marginLeft=Re.a.gY(b.marginLeft));0<=b.marginRight&&(a.marginRight=Re.a.gY(b.marginRight));0<=b.marginTop&&(a.marginTop=Re.a.gY(b.marginTop));
0<=b.marginBottom&&(a.marginBottom=Re.a.gY(b.marginBottom))}nCi(a,b){b=Math.max(Re.a.gY(this.$pm+b.marginLeft+b.marginRight),a);qf.a.cA(b,a)||(a={},a.Number=Re.a.Ov(b),this.ia.Ia(M.a.ENa,2,a))}NPh(a){if(!this.sa.Aa)return!1;const b=this.oa.Zn();return!!b&&b.vd&&(this.Ba.gTb&&Array.contains(ix.QIl,a)||this.Ba.jpb&&Array.contains(ix.$Il,a))}n3c(a,b,c,f,l){if(!this.Ba.jpb)return 8;b=this.oa.$n();if(!b)return ya.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),
16;c=this.oa.yw();if(!c)return ya.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.Cc.LG(b));if(!c||!c.length)return ya.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.uLj(c,a);this.Dxc(l,Re.a.Ov(b));ya.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.oq,a);return 32}uLj(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case M.a.Tuc:c=
l.marginLeft;break;case M.a.Uuc:c=l.marginRight;break;case M.a.Vuc:c=l.marginTop;break;case M.a.Suc:c=l.marginBottom}if(0<=f&&f!==c)return-1;f=c}return c}Dxc(a,b){a=a.queryResult;null!==a&&(a.uca=parseFloat(b.toFixed(2)).toString())}v3c(a,b,c,f,l){return this.NPh(a)?1===c?32:jh.a("HandleTableCellCustomMargins:Entry point:"+this.ia.oq,a,()=>{if(!l)return ya.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const u=this.oa.$n();if(!u)return ya.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),
16;let I=this.oa.yw();if(!I)return ya.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;I.length||(I=this.Cc.LG(u));this.i4k(a,I,l);ya.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.oq,a);return 32}):(ya.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}i4k(a,b,c){this.Pfd!==a&&(this.K9a(),this.Pfd=a);this.RKa||(this.RKa=[]);jh.a("OnCustomMarginChange:Entry point:"+
this.ia.oq,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const u=Object(gb.a)(Ut,f.sc(this.yb.Na));if(u){this.RKa[l]||(this.RKa[l]=new Zh.a(f,this.MOj(f)));f=this.RKa[l];switch(a){case M.a.Rzc:f.second.marginLeft=c.Number;break;case M.a.Vzc:f.second.marginRight=c.Number;break;case M.a.Wzc:f.second.marginTop=c.Number;break;case M.a.Qzc:f.second.marginBottom=c.Number}u.YOl(f.second,a)}}return 32});this.tHk.perform()}K9a(){this.Ba.jpb&&this.RKa&&this.RKa.length&&(jh.a("ApplyPendingChangesToServerIfRequired:Entry point:"+
this.ia.oq,this.Pfd,()=>{const a=this.Eb.xe(15);try{a.Wc=this.Pfd;let b=null;for(const c of this.RKa)b||(b=c.first.getContainingTable(),a.mc(b)),this.LOf(c.first,c.second),this.nCi(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.RKa=null)}MOj(a){const b=Xk.b(this.d1h);b.marginLeft=Re.a.Ov(a.marginLeft);b.marginRight=Re.a.Ov(a.marginRight);b.marginTop=Re.a.Ov(a.marginTop);b.marginBottom=Re.a.Ov(a.marginBottom);return b}}ix.QIl=[M.a.jdf,M.a.Uzc,M.a.Tzc,M.a.Szc,M.a.Xzc];ix.$Il=
[M.a.Rzc,M.a.Vzc,M.a.Wzc,M.a.Qzc];Object(m.a)(ix,"TableCellMarginActor",null,[948]);class rr{constructor(a,b,c,f,l,u,I,T){this.rn=this.zoc=null;this.idh=0;this.Rdd=!1;this.VKe=this.aPe=this.Idh=this.SMg=this.Hdh=this.RMg=null;this.vB=a;this.Hl=b;this.YHe=c;this.z2=f;this.iPe=l;this.hTk=u;this.cTk=I;this.l_a=T}P8l(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');this.Wpe(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',
this.Hl.rwb(this.Hl.Ahe(this.zoc),this.rn)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.aPe.kge(a,b,1,1),l=this.ujg(this.VKe,this.rn,a,b),u=f.Qa(yb.a.cellShading)?f.$h(yb.a.cellShading):mm.a.Hyb,I=this.Hl.rwb(u,this.rn),T=new Sys.StringBuilder;for(let ja=0;ja<rr.jic.length;ja++){const ua=Oq.fWa(rr.Vad[ja]),Ra=f.ra(ua.c$a,mm.a.IUc),eb=f.ra(ua.Awb,mm.a.Fyb);T.append(rr.jic[ja]);if(Ra.DE===Vb.a.auto){const Bb=this.Hl.ege(.0277777777777778);T.append(String.format("inset {0}px transparent",
Bb))}else T.append(this.Hl.nfe(eb,.0277777777777778,Ra));T.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,I,T));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.Rdd&&this.WGh()}return c.toString()}Qvj(a,b){const c=[];this.Wpe(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.aPe.kge(a,b,1,1),u=this.ujg(this.VKe,this.rn,a,b);f.color=u;const I=l.Qa(yb.a.cellShading)?l.$h(yb.a.cellShading):
mm.a.Hyb,T=this.Hl.rwb(I,this.rn);f["background-color"]=T;f.overflow="visible";for(let ja=0;ja<rr.jic.length;ja++){let ua=null,Ra=null,eb=null;({ZSa:ua,c$a:Ra,Awb:eb}=Oq.fWa(rr.Vad[ja]));let Bb;if(this.l_a){const Ec=Ze.Box4ColorHelper.uT({Color:"##T,0,0,0"}),hd=yl.a.Fi(l,Ra,Ec),yd=Ze.Box4ColorHelper.Eia(hd),Pd=Ze.Box4ColorHelper.ZI(yd,this.rn);Bb=Pd?Ze.Box4ColorHelper.Xia(Pd):null}else Bb=l.ra(Ra,mm.a.IUc);const Ub=l.ra(eb,mm.a.Fyb),Xb=rr.jic[ja].substring(0,rr.jic[ja].length-1),tc=l.ra(ua,mm.a.Gyb),
lc=this.l_a&&md.a("TableBordersLocalRenderingFix");if(lc&&!tc||!lc&&Bb.DE===Vb.a.auto){const Ec=this.Hl.ege(.0277777777777778);f[Xb]=String.format("inset {0}px transparent",Ec)}else f[Xb]=this.Hl.nfe(Ub,.0277777777777778,Bb)}c.push(f)}}finally{this.Rdd&&this.WGh()}return c}q2c(a,b){this.Wpe(a,b);a={};a.background=this.Hl.rwb(this.Hl.Ahe(this.zoc),this.rn);return a}Wpe(a,b){this.zoc=this.z2.rbc(a).yZ;this.idh=this.vB.Nie(b);this.rn=this.YHe.Hog(b).Ld;this.Rdd=this.V1j(this.zoc);this.RMg=this.rn.PresetSchemeColorMapping.Background1;
this.Hdh=this.rn.PresetSchemeColorMapping.Text1;this.SMg=this.rn.PresetSchemeColorMapping.Background2;this.Idh=this.rn.PresetSchemeColorMapping.Text2;this.Rdd&&(this.rn.PresetSchemeColorMapping.Background1=this.rn.PresetSchemeColorMapping.Light1,this.rn.PresetSchemeColorMapping.Text1=this.rn.PresetSchemeColorMapping.Dark1,this.rn.PresetSchemeColorMapping.Background2=this.rn.PresetSchemeColorMapping.Light2,this.rn.PresetSchemeColorMapping.Text2=this.rn.PresetSchemeColorMapping.Dark2);a=this.iPe(()=>
5,()=>5,()=>this.idh,()=>null,()=>this.rn,()=>this.zoc);this.aPe=this.hTk(a);this.VKe=this.cTk(a)}WGh(){this.rn.PresetSchemeColorMapping.Background1=this.RMg;this.rn.PresetSchemeColorMapping.Text1=this.Hdh;this.rn.PresetSchemeColorMapping.Background2=this.SMg;this.rn.PresetSchemeColorMapping.Text2=this.Idh}V1j(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}ujg(a,
b,c,f){let l="black";a&&(l=a.kig(b,c,f,1,1).GW());return l}}rr.jic=["border-top:","border-left:","border-bottom:","border-right:"];rr.Vad=[7,5,0,6];Object(m.a)(rr,"TableStylePreviewGenerator",null,[1774]);class DG extends Dz{constructor(){super()}get Type(){return 6}}Object(m.a)(DG,"TableStyleGalleryButtonProps",Dz,[]);class EG{}EG.u0k=2147483647;Object(m.a)(EG,"TableStyleUtil",null,[]);class Up{constructor(a,b,c,f,l){this.X4d="Clear";this.lbb=null;this.Fub=a;this.Ktf=c;this.Ltf=f;this.Yei=l;this.vWd=
b;this.dP=A.AFrameworkApplication.dP;this.Mm=A.AFrameworkApplication.Mm}Y8b(){}mui(a,b){this.Y8b();const c=this.AZc(),f=c.length;if(!(0>=f)){var l=EG.u0k,u=null;for(let ua=0;ua<f;ua++){var I=c[ua],T=this.Yei(I);l!==T&&(l=Object.assign(new dl.a,{Id:"msMoreTableStyles"+T,Title:this.YOj(T),ControlList:[]}),u=Object.assign(new gr.a,{Type:6,Id:"galleryMoreTableStyles"+T,ExternalGalleryId:"TableStylesGallery",Width:Up.tVh,ElementDimensions:"Size64by48",GalleryItems:[]}),A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es&&
this.lbb&&(u.ExternalId=this.lbb[T.toString()]),Array.add(l.ControlList,u),Array.add(b.MenuSectionList,l),l=T);var ja=this.Ltf(I);I=Up.qdf+ua;T=!!A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es;ja=Object.assign(new DG,{Id:I,ExternalId:I,Command:"4171428777",QueryCommand:"2135594455",LabelText:ja?Aa.a.Fe(ja):"",Alt:T?ja:null,VerticalCenterAlign:"true"});T&&(ja.TableCellStyles=this.Apg(I,a),ja.TableStyles=this.q2c(I,a));u&&u.GalleryItems.push(ja)}}}jui(a){const b=Object.assign(new dl.a,
{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new Eg.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:Aa.a.Fe(this.X4d),Alt:Aa.a.Fe(this.X4d),Image16by16:this.Mm,Image16by16Class:mp.getImageClassWithCluster(this.dP,Up.sUi),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}y3i(a,b){this.Y8b();const c=a[Xh.a.SourceControlId],f=this.vCd(c,b);if(f){var l=
this.Fub.$ke(b);l=l?this.Ktf(l):null;var u=this.Ltf(f),I=this.Ktf(f);a[an.a.Alt]=u;a[an.a.On]=I===l;A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es?(b=Object.assign(new DG,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.Apg(c,b),TableStyles:this.q2c(c,b),Alt:u}),a[an.a.GalleryButtonProps]=b):(b=this.vWd.P8l(f,b),a[an.a.InnerHTML]=b)}else a[an.a.InnerHTML]=null,a[an.a.Alt]=null,a[an.a.On]=!1,a[an.a.GalleryButtonProps]=null}Apg(a,b){this.Y8b();return(a=
this.vCd(a,b))?this.vWd.Qvj(a,b):null}q2c(a,b){this.Y8b();return(a=this.vCd(a,b))?this.vWd.q2c(a,b):null}G4i(a,b){A.AFrameworkApplication.za&&A.AFrameworkApplication.za.mb.es?a.MenuItems=this.Clg(b):a.PopulationXML=Hj.l(this.Clg(b))}Clg(a){const b=Object.assign(new Rn.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.mui(a,b);this.jui(b);return b}vCd(a,b){return a?a.startsWith(Up.qdf)?this.eOj(parseInt(a.substr(Up.qdf.length))):this.pGl(parseInt(a.substr(Up.N8l.length)),b):null}}Up.qdf="buttonTableStyleMenu";
Up.N8l="buttonTableStyleRibbon";Up.tVh=7;Up.sUi="ClearTableStyle_16x16x32";Object(m.a)(Up,"ATableStyleRibbonControl",null,[1775]);class tP extends Up{constructor(a,b,c,f,l){super(a,l,Object(R.a)(f,f.cOj,"getStyleIdFromStyleContainer"),Object(R.a)(f,f.dOj,"getStyleNameFromStyleContainer"),Object(R.a)(f,f.WNj,"getStyleCatogeryFromStyleContainer"));this.vB=a;this.z2=f;this.X4d=ResourceStrings.L_ClearTableStyle;this.dP=jf.a.Fsc;this.Mm=c.Ok(jf.a.xrd);this.Xgl()}YOj(a){switch(a){case 1:return ResourceStrings.L_Themed;
case 2:return ResourceStrings.L_Light;case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}pGl(a,b){let c=null;(b=this.vB.zbc(b))&&(c=this.z2.Cpg(b.styleIdField));return c?this.z2.TNj(c.GNg,c.JUg-c.JUg%Up.tVh+a):this.z2.VBb(a)}AZc(){return this.z2.AZc()}eOj(a){return this.z2.VBb(a)}Y8b(){this.z2.zbe()}Xgl(){this.lbb={};this.lbb["1"]="TableStylesBestMatch";this.lbb["2"]="TableStylesLight";this.lbb["3"]=
"TableStylesMedium";this.lbb["4"]="TableStylesDark"}}Object(m.a)(tP,"TableStyleRibbonControls",Up,[]);class uP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd){this.qF=this.w0a=null;this.ia=a;this.uf=b;this.Ba=c;this.Fa=f;this.oa=l;this.Pt=u;this.Oc=I;this.Whc=T;this.yb=ja;this.Ga=ua;this.ue=Ra;this.bha=Bb;this.Cc=Ub;this.lha=Xb;this.F0a=lc;this.kB=eb;tc.execute(yd=>{this.w0a=yd});this.Ba.iR&&Ec.execute(yd=>{this.qF=yd});this.Ba.Cbb&&hd.execute(yd=>{this.vjc=yd})}get Kd(){return this.Oc.instance}get CG(){return this.Whc.value}qb(){this.ia.pa(M.a.RQf,
wc.a.application,Object(R.a)(this,this.tUj,"handleBeginEditShapeTextByF2"),4);this.ia.pa(M.a.Y9a,wc.a.application,Object(R.a)(this,this.sUj,"handleBeginEditShapeText"),4);this.ia.pa(M.a.WSa,ta.a.view,Object(R.a)(this,this.uUj,"handleBeginEditShapeTextForShapeMoniker"),5)}Sd(){const a=this.Fa.Kc(xc.a.Ag),b=this.Fa.Kc(yj.a.H4);a.bindAction(B.KeyInputManager.Va(H.a.QCc,0),M.a.RQf);a.bindAction(B.KeyInputManager.Va(H.a.Mp,0),M.a.Y9a);b.bindAction(B.KeyInputManager.Va(H.a.QCc,0),M.a.THi)}sUj(a,b,c){if(this.lha&&
this.lha.isVisible())return ya.a.J(508694666,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.lha.hide(2,!0),32;if(1===c&&this.oa.yXa())return 2;a=this.oa.Zn();if(!a)return 16;b=Object(gb.a)(4,a.GBj(md.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ga.Hs(a);else{if(a.ig&&b)return this.ia.Ia(M.a.X3a,c,b);if(a.Lf){var f=this.Ga.rx(a);if(0<f.length)return this.ia.Ia(M.a.X3a,c,f[0])}else if(this.Ba.iR&&1===a.mediaType&&!a.Rg&&
this.qF)return(f=this.qF.vM(a))&&f.setFocusOnPlayer(),32}return this.ia.Ia(M.a.WSa,c,new Ln.a(a,!1))}tUj(a,b,c){a=this.oa.Zn();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Ga.Hs(a));return this.ia.Ia(M.a.WSa,c,new Ln.a(a,!1))}uUj(a,b,c,f,l){if(!l||!Object(gc.a)(Ln.a,l))return ya.a.J(508694665,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.Dha||a.$r)||this.uf.Xc(a))return 16;if(1===c)return 32;a.vd&&(c=this.Cc.XO(a),c=!!c&&c.rq(),ya.a.J(508694664,820,50,"Entering table edit mode, isComplexTable:{0}",
c),this.ia.nb(M.a.U$a,2));if(a.$r){if(this.CG&&this.Kd)return l=this.CG.Q4(a),this.Kd.notifyAgave(l.id,11),32;ya.a.J(508694663,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.vg(this.yb.Na);if(!c)return 16;this.Ba.Cbb&&(this.vjc?this.vjc.y5l(a):ya.a.J(508696141,820,15,"this.m_editSurfaceLayoutManager is not resolved yet, so will not use linebox layout on edit start"));this.w0a&&this.w0a.bde(a,!0);this.F0a&&this.Ba.qNl&&this.F0a.ping();$c.a.Kb&&($c.a.Kb.actionName="BeginEditShapeText",
(a.Lf||a.Rg)&&Xn(a));if(this.kB&&a.ig&&c.hK())$c.a.Xk(Ii.a.pNc,"false"),this.ue.Szh(new kz.a(a));else{this.Fa.Df(xc.a.Ag,l.AXl);this.Pt.Bx();c.Aaf();if(a.vd&&l.TRc&&(c=this.Cc.XO(a))&&c.rq())return(a=this.bha.Ode(l.TRc.clientPoint,c,null,null))?(c=a.sc(this.yb.Na),this.yb.i8(l.TRc.clientPoint,c,a,this.yb,!1,!1,0),32):8;a.Rg&&(c=this.Ga.zt(a))&&(c=c.vg(this.yb.Na))&&c.$d&&c.$d.cRb(!0);this.yb.MLl(a,l.TRc)}return 32}}Object(m.a)(uP,"TextEditorLaunchingActor",null,[948]);class FG{constructor(a,b,c,f,
l,u,I,T){this.ia=a;this.Fa=b;this.Ga=c;this.ms=f;this.uf=l;this.oa=u;this.VZa=I;this.Uh=T}qb(){this.ia.xa(M.a.IVf,wc.a.application,Object(R.a)(this,this.IUj,"handleChangeCaseMenu"));this.ia.xa(M.a.wYe,wc.a.application,Object(R.a)(this,this.yYj,"handlePowerPointInsertHyperlink"));this.ia.pa(M.a.clearFormatting,wc.a.application,Object(R.a)(this,this.UUj,"handleClearFormatting"),4)}Sd(){this.Fa.Kc(xc.a.wR).bindAction(B.KeyInputManager.Va(H.a.fO,2),M.a.clearFormatting)}IUj(){var a=this.oa.Oa.kb;return a&&
(a=a.Ua)&&(a.contextId===ta.a.Xf||a.contextId===ta.a.textRange)?32:this.c5h(!0)?32:8}yYj(a,b,c,f,l){return(a=this.oa.Oa.kb)&&this.oa.Zik()?8:!a||this.oa.kYa()&&!FG.Yfc(a)?8:this.ia.Ia(M.a.insertHyperlink,c,l)}UUj(a,b,c){if(!this.c5h(!1))return 16;a=this.oa.Oa.kb;if(!a)return 8;2===c&&this.DEa(a);return 32}DEa(a){ya.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.oa.Hd();let c;if((c=this.wMj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){ya.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");
return}if(b.contextId===ta.a.Xf){this.hEi(b,c[0]);return}if(b.contextId===ta.a.textRange||b.contextId===ta.a.paragraph){this.jEi(a,c);return}}this.iEi(c)}else b.length?this.OSc(b)?ya.a.J(593892317,820,50,"ClearFormatting on table(s)"):ya.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):ya.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}wMj(a){a=this.Ga.a1(a,!1);const b=[];let c=!0;for(const f of a)f.Lf&&(c=!1,1!==a.length&&this.nWl(f,
a)?b.push.apply(b,this.VCh(f,a,!1)):b.push.apply(b,this.VCh(f,a,!0)));return c?a:b}nWl(a,b){for(const c of b)if(c&&!c.Lf&&(b=c.zt(),!b||a!==b))return!1;return!0}VCh(a,b,c){c=void 0===c?!1:c;const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const u=this.Ga.a1(this.oa.pQ(b),!1);f.push.apply(f,u)}return f}iEi(a){this.ms.gbb(b=>{this.x7e(b,0,this.pMj(b))},a)}jEi(a,b){const c=a.Ua,f=this.tkg(c,b[0]);if(c.contextId===ta.a.paragraph||-1!==f){var l=this.DPj(a);this.ms.gbb(u=>{this.x7e(u,f,l)},b)}}hEi(a,
b){const c=this.VZa.bbc(a);if(c){var f=c.Ua,l=this.tkg(a,b)+f.Ra;this.ms.gbb(u=>{this.x7e(u,l,f.Pb-f.Ra)},[b])}}x7e(a,b,c){a.He(yb.a.clearFormatting,!0);a.He(yb.a.oef,b);a.He(yb.a.nef,c)}tkg(a,b){let c=0,f=!1;if(!this.Uh.ke(a.node))return-1;const l=a.node;this.Ga.lH(b,u=>{u===l?f=!0:f||(c+=this.Uh.textLength(u)+1)});return f?a.contextId===ta.a.paragraph||a.contextId===ta.a.Xf?c:c+a.Ra:-1}DPj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===ta.a.textRange?b+=f.Pb-f.Ra:f.contextId===
ta.a.paragraph?b+=this.Uh.textLength(f.node)+1:f.contextId===ta.a.endOfParagraph&&b++}return b}pMj(a){let b=0;if(a.VA)return 1;this.Ga.lH(a,c=>{b+=this.Uh.textLength(c)+1});return b}OSc(a){for(const b of a)if(b.vd)return!0;return!1}c5h(a){const b=this.oa.Hd();if(!b||1>b.length)return!1;const c=this.oa.$n();if(c&&!a&&1===b.length)return!1;a=this.Ga.a1(b);return 1>a.length&&!c||this.uf.xC(a)||this.uf.xC([c])?!1:!0}static Yfc(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!Bc.SelectionEditor.Tk(b)||
!Bc.SelectionEditor.Om(a)||b.node!==a.node)}return!1}}Object(m.a)(FG,"TextOperationsActor",null,[948]);class GG{Z9d(a,b,c){return 1===c?32:GG.X$i(b.node)}static X$i(a){const b=new mb.GraphIterator;b.set(a);b.Zv();if(we.b(b))return 2;a=new pg.GraphTransaction(7);a.Jz(b);b.rj();a.dispose();return 32}}Object(m.a)(GG,"DeleteOutlineLevelContentStrategy",null,[]);class am{constructor(){this.Pci=new GG}qb(a){const b=Object(R.a)(this.TUc,this.TUc.$9d,"deleteView"),c=Object(R.a)(this,this.Z9d,"deleteOutlineLevelContent"),
f=Object(R.a)(this.s4f,this.s4f.Y$i,"deleteParagraphContent");a.xa(G.a.backspace,ta.a.Xf,f);a.xa(G.a.backspace,ta.a.textRange,f);a.xa(G.a.backspace,ta.a.endOfParagraph,ff.ActionManager.vw);a.xa(G.a.backspace,ta.a.outline,c);a.xa(G.a.backspace,ta.a.view,b);a.pe(G.a.backspace,1124);a.xa(G.a.oFa,ta.a.Xf,ff.ActionManager.vw);a.xa(G.a.oFa,ta.a.textRange,f);a.xa(G.a.oFa,ta.a.endOfParagraph,ff.ActionManager.vw);a.xa(G.a.oFa,ta.a.outline,c);a.xa(G.a.oFa,ta.a.view,b);a.pa(G.a.nab,ta.a.view,b,1124);a.xa(G.a.PJ,
ta.a.Xf,f);a.xa(G.a.PJ,ta.a.textRange,f);a.xa(G.a.PJ,ta.a.endOfParagraph,ff.ActionManager.vw);a.xa(G.a.PJ,ta.a.outline,c);a.xa(G.a.PJ,ta.a.view,b);a.pe(G.a.PJ,1124);a.pa(G.a.vyb,ta.a.view,b,1124);a.pa(G.a.nFa,ta.a.view,am.nFa,1028);a.xa(G.a.oUa,ta.a.view,Object(R.a)(this.TUc,this.TUc.oUa,"deleteFromInputEvent"));a.xa(G.a.oUa,ta.a.textRange,f);a.pe(G.a.oUa,1028)}Z9d(a,b,c,f,l){return this.Pci.Z9d(a,b,c,f,l)}static get Rm(){return Tm.PageNavigator.instance}static get zi(){return am.Rj||(am.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get $K(){return am.BJ||
(am.BJ=Tb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get W$i(){return am.k6a||(am.k6a=Tb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get $C(){return am.Wy||(am.Wy=Tb.a.instance.resolve("Box4.IOutlineEditor"))}static get Re(){return am.kd||(am.kd=Tb.a.instance.ub("Box4.IFeatureHelper"))}static nFa(a,b,c,f,l){f=b.view;if(!f.Rb||!f.Rb.Oa.kb||Bc.SelectionEditor.uy(f.Rb.Oa.kb))return 8;if(1===c)return 32;c=f.Rb.Oa;const u=c.kb;var I=u.Ua;let T=!1;var ja=
null,ua=!1;if(c.rI)if(we.a(I))T=!0;else{if(I.contextId===ta.a.outline&&1===c.length){for(a=mb.GraphIterator.ob(I.node);a.sj();)a.rj();am.$C.uX(a,!0);jb.OutlineElementNavigator.Ti(a);a=$d.SelectionFactory.fh(a.currentNode,0);f.Rb.setSelection(a);return 32}var Ra=I.node;ja=null;if(Zu.c(I)){var eb=Ra.sc(f.Na);eb&&(eb=eb.GCm)&&0<=eb.width&&0<=eb.height&&(ja=new Ju.a(Ad.a.Cf(eb.x,0),Ad.a.Cf(eb.y,1)));ja||(ja=rq.b(Ra))}else ja=rq.b(I.node);I=mb.GraphIterator.ob(I.node);I.Zv();am.Rm.eNa(I);Ra=am.$K.P6b(I);
rq.c(Ra,ja.x,ja.y);am.$C.uX(I,!0);ja=$d.SelectionFactory.hk(Ra,!0)}else if(1===c.length){ua=c.last;I=Me.a.TTa(ua);if(am.Re&&am.Re.isFeatureEnabled(33)&&Uh.ContextSetEditor.instance.Haf(I).returnValue)return 2;ua=ua.vf;ua=!we.a(ua)&&!c.qm&&(Bc.SelectionEditor.Om(ua)||$a.ParagraphReader.jn(ua)||Bc.SelectionEditor.oY(ua))}ua&&(ua=Bc.SelectionEditor.Km(u,!1,!1,void 0,am.W$i.X9e(null,1)),f.Rb.setSelection(ua),A.AFrameworkApplication.Pa.Ai(b,G.a.WC,2,!1,null,l),ja=f.Rb.Oa.kb,f.Rb.setSelection(u));l||(l=
new W.DictionaryPropertySet);l.setValue(Oe.a.ezb,!0);A.AFrameworkApplication.Pa.Ai(b,G.a.PJ,2,!0,null,l);if(ja&&ja.Ua.isValid)return f.Rb.setSelection(ja),32;c.rI&&(T||Ro.instance.DFb(a,b.GF,f));Bc.SelectionEditor.uy(f.Rb.Oa.kb)||A.AFrameworkApplication.Pa.Ai(b,G.a.WC,2,!1,null,l);return 32}}am.BJ=null;am.Rj=null;am.k6a=null;am.Wy=null;am.kd=null;Object(m.a)(am,"ADeleteActor",null,[]);class Nl{get Jj(){return mi.a.instance}Y$i(a,b,c,f,l){$u.uqb(b,a,c);if(1===c)return 32;f=a===G.a.backspace||a===G.a.oUa;
if(Nl.Yr()&&Nl.Yr().instance&&Nl.Yr().instance.rY(b))return 4;c=b.node;var u=b.Ra;b=b.Pb;const I=$a.ParagraphReader.text(c),T=I.length;let ja=!1;if(u===b){if(f&&!u||!f&&u===T)return 2;f?(U.a.instance.ga(14)&&({cp:u,returnValue:ja}=this.Jj.QYk(c,u)),ja||(u--,Aa.a.yy(I,u)&&u--),a=G.a.rEa):(U.a.instance.ga(14)&&({cp:b,returnValue:ja}=this.Jj.PYk(c,b)),ja||(b++,Aa.a.yy(I,b)&&b++),a=G.a.nUa)}u=u===b?me.a.rk(c,u):me.a.createTextRange(c,u,b);f=new pg.GraphTransaction(15);f.Wc=a;f.rd(c);c=Object(gc.a)(Ft,
l)&&l.r$b;if(Nl.kg.Gg&&Nl.kg.wD&&!c){c=Nl.kg.vwb();try{let ua;if((()=>{let Ra=null.rqg();({type:ua}=Ra);return Ra})().returnValue){const Ra=Object(gb.a)(10,l);if(Ra&&Ra.ra(Et.a.dBg,!1)||1===ua)Nl.kg.Yth=ua}l=0;for(let Ra=null.length-1;0<=Ra;--Ra){let eb;const Bb=(()=>{let Ub=null.getContext(Ra);({FGg:eb}=Ub);return Ub})().returnValue;eb?(Nl.hyperlinkEditor.OLb(Bb,null),l+=0,Nl.g8.l7d=b+l):this.t4f(Bb)}}finally{c&&c.dispose()}}else this.t4f(u);f.dispose();return 32}static get kg(){return Nl.zd||(Nl.zd=
Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g8(){return Nl.Pp||(Nl.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get gBc(){return Nl.QE||(Nl.QE=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Nl.uo||(Nl.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static Yr(){return Nl.yn||(Nl.yn=Tb.a.instance.Ha("Box4.IExternalSelectionManager"))}}Nl.zd=null;
Nl.Pp=null;Nl.QE=null;Nl.uo=null;Nl.yn=null;Object(m.a)(Nl,"ADeleteParagraphContentStrategy",null,[]);class jx extends Nl{constructor(){super()}t4f(a){jx.characterPropertiesEditor.replaceTextRange(a,"")}static get characterPropertiesEditor(){return jx.rIh||(jx.rIh=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}jx.rIh=null;Object(m.a)(jx,"DeleteParagraphContentStrategy",Nl,[]);var mT=d(476);class vP{constructor(a,b,c,f){this.Qif=a;this.gL=c;this.Bd=f;this.actionId=b}}Object(m.a)(vP,"DeleteActionData",
null,[]);class Mf{get SUi(){return Mf.zpf||(Mf.zpf=Tb.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}gbm(a){return!Bc.SelectionEditor.Tk(a)}FLj(a,b,c){if(!a)return null;if(!c)return a;b=Bc.SelectionEditor.jVa(a,!1,!b,!0,!0,!0);return $d.SelectionFactory.PO(a,b.Ua,!1)}$9d(a,b,c,f,l){if(1===c)return 32;var u=!1;a===G.a.vyb&&(a=G.a.PJ,u=!0);a===G.a.nab&&(a=G.a.backspace,u=!0);a===G.a.oFa&&(b=new fE.a(ad.App.Ob.ie.yo));var I=b;if(!I.view.xi)return 2;var T=I.view.Rb;Qi.GrippersManager.instance.setVisibility(!1);
I=a===G.a.PJ;T=0<T.Oa.length?T.Oa.ga(0):null;u=this.FLj(T,I,u);return this.B4f(a,b,c,f,l,u,I)}B4f(a,b,c,f,l,u,I){const T=b.view,ja=T.Rb;var ua=l;let Ra=l;a===G.a.oFa&&(Ra=ua=null,u=new Nd.Selection(l,!0));if(!u)return 32;const eb=new vP(b,a,f,Ra),Bb=this.gXl(ua,I,ja);let Ub=!1;if((()=>{let Pd=this.iQh(a,Bb,ja);({FXa:Ub}=Pd);return Pd})().returnValue)return a=Ub?G.a.mFa:G.a.deleteRow,A.AFrameworkApplication.Pa.Ai(b,a,c,!1,f,l);let Xb;I?He.a.mark(Xb=5009):He.a.mark(Xb=5011);c=new pg.GraphTransaction(15);
c.Wc=a;c.rd(T.Zg);let tc=null,lc=(()=>{let Pd=this.Exj(a,l,ja,u);({oKl:tc}=Pd);return Pd})().returnValue,Ec=null;(()=>{let Pd=Uh.ContextSetEditor.instance.Haf(lc);({ZAd:Ec}=Pd);return Pd})().returnValue&&(lc=Ec);if(!lc)return c.dispose(),32;this.$Yh(lc);const hd=this.Qtj(u,I);let yd=null;I?yd=new Nr(u):hd&&(yd=new Nr(hd));ua=!1;if(Bc.SelectionEditor.nh(lc)){if(a===G.a.oUa)return 2;const Pd=si.Y0c(T.Zg,Bb);Mf.AU.bL(()=>{this.O$i(b,f,l,lc,I,yd,u,Pd,ja,Bb,eb,hd)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else Mf.kg.Gg&&
Mf.kg.wD?(this.fbm(a,T.Zg,lc,I,u,ja,Bb,eb,yd),ua=!0):ua=this.iuh(a,T.Zg,lc,ja,Bb,eb,yd,tc);Mf.Roj(ja);this.uGh(lc);c.dispose();He.a.mark(Xb+1);return a===G.a.oFa?ua?32:8:32}oUa(a,b,c,f,l){return b.view.xi?this.B4f(a,b,c,f,null,l,!1):2}iuh(a,b,c,f,l,u,I,T){b=si.Y0c(b,l);this.gbm(c)&&b.vra(c);a=Mf.fd.Cq(a);a.properties.$("CountOfParagraphsDeleted",Mf.v7.j7d(c).toString());c=Mf.Acj(Mf.kXl,Object(R.a)(this,this.jXl,"shouldDispatchNoSpecialize"),c,f,l,b,u,I,T);a.end();return c}fbm(a,b,c,f,l,u,I,T,ja){var ua=
0,Ra=null;const eb=Uh.ContextSetEditor.instance.dC(c),Bb=eb[eb.length-1];if(Bb.contextId===ta.a.paragraph||Bb.contextId===ta.a.endOfParagraph){var Ub=mb.GraphIterator.ob(Bb.node);Ub.wf();jb.OutlineElementNavigator.$e(Ub);jb.OutlineElementNavigator.XK(Ub,!0,!1)&&(Ra=jb.OutlineElementNavigator.Ti(Ub))&&(ua=Mf.v7.textLength(Ra))}else ua=Mf.v7.textLength(Bb.node)-Bb.Pb;if((Ub=Object(gb.a)(10,T.Bd))&&Ub.ra(Et.a.dBg,!1))this.huh(a,b,c,u,I,T,ja,!1);else{Ub=Mf.kg.vwb();try{this.huh(a,b,c,u,I,T,ja,!0)}finally{Ub&&
Ub.dispose()}}if(f){if(c.ry){a=eb.length-1;do l=eb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!Mf.v7.ke(l.node))return;switch(Bb.contextId){case ta.a.paragraph:case ta.a.endOfParagraph:ua=Ra&&Ra.isConnected?0:ua;break;case ta.a.Xf:case ta.a.textRange:break;default:ua=0}ua=$d.SelectionFactory.fh(l.node,Mf.v7.textLength(l.node)-ua);l.lSa===ua.Ua.Ra&&(ua.Ua.uU=l.uU)}else{ua=l.Ua.node;if(!Mf.v7.ke(ua))return;Ra=l.Ua.contextId===ta.a.paragraph?0:l.Ua.contextId===ta.a.endOfParagraph?Mf.v7.textLength(ua):
l.Ua.Ra;ua=$d.SelectionFactory.fh(ua,Ra)}Me.a.instance.setSelection(ua)}huh(a,b,c,f,l,u,I,T){c=this.$rj(f,c);let ja;!(()=>{let ua=null.rqg();({type:ja}=ua);return ua})().returnValue||T&&1!==ja||(Mf.kg.Yth=ja);for(let ua=null.length-1;0<=ua;--ua){let Ra;c=(()=>{let eb=null.getContext(ua);({FGg:Ra}=eb);return eb})().returnValue;Ra?Mf.hyperlinkEditor.OLb(c,2):this.iuh(a,b,c,f,l,u,I,null)}}$rj(a,b){if(Object(gc.a)(mT.a,b)){a=gj.Zua(a.Oa,!0);for(let c=0;c<a.length;c++)if(a.getContext(c).contextId===ta.a.table)return a}return b}Exj(a,
b,c,f){a===G.a.oFa?(c=ud.a.YTa(b),a=hm.SelectionReferenceFactory.instance.fua()):(a=null,c=1===c.Oa.length?Me.a.TTa(f):c.Ik);return{returnValue:c,oKl:a}}KPi(a){return!a.El||a.contextId!==ta.a.paragraph||!Mf.v7.ke(a.node)||Mf.kg.Gg&&Mf.kg.wD||U.a.instance.ga(14)&&Mf.Jj.c8c(a)?!1:!0}$Yh(a){if(a.ry)for(let b=0;b<a.length;b++)this.$Yh(a.getContext(b));else this.KPi(a)&&(a.node.$Qc=!0)}uGh(a){if(a.ry)for(let b=0;b<a.length;b++)this.uGh(a.getContext(b));else a.El&&(a=a.node)&&Mf.v7.ke(a)&&(a.$Qc=!1)}O$i(a,
b,c,f,l,u,I,T,ja,ua,Ra,eb){const Bb=new mb.GraphIterator,Ub=f.node;Bb.set(Ub);Bb.wf();Bc.SelectionEditor.QD(Bb.currentNode,f,l)?this.T$i(a,b,c,f,l,u,I,T,ja,Ra,eb,Bb,Ub):Mf.U$i(f,l,u,I,T,ja,ua,Ra)}j3c(a,b,c,f){return!a&&Kc.ListReader.hl(b)?(f=Mf.tqa(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}AWj(a,b,c,f,l,u){return U.a.instance.ga(65)&&!a&&0<ge.OutlineElementReader.cBb(b)?(u=A.AFrameworkApplication.Pa.Ai(c,G.a.SCh,2,!1,f,l),{returnValue:!0,response:u}):{returnValue:!1,response:u}}v0j(a,
b,c,f,l,u){return U.a.instance.ga(54)&&!a&&0<ge.OutlineElementReader.qcb(b)?(u=A.AFrameworkApplication.Pa.Ai(c,G.a.nzl,2,!1,f,l),{returnValue:!0,response:u}):{returnValue:!1,response:u}}GYj(a,b,c,f,l,u){return U.a.instance.ga(80)&&!a&&Mf.Cw.dxb(b)?(u=A.AFrameworkApplication.Pa.Ai(c,G.a.My,2,!1,f,l),{returnValue:!0,response:u}):{returnValue:!1,response:u}}LTj(a,b,c,f,l,u,I,T,ja,ua,Ra){const eb=new ko.a;eb.Uc(b);if(jb.OutlineElementNavigator.nLa(eb,!1,!a,!1)){Ra=!0;ua=32;const Bb=new mb.GraphIterator;
Bb.Uc(eb);jb.OutlineElementNavigator.Ti(eb);u&&f&&Bc.SelectionEditor.oY(f.Ua)?(c.vra(l),Mf.zi.Syl(b.currentNode)):eb.currentNode.nY?(U.a.instance.ga(68)&&c.vra(l),jb.OutlineElementNavigator.$e(eb),eb.rj()):U.a.instance.ga(66)&&a&&u?Mf.Jj.jEg(T)&&!(()=>{let Ub=this.hxh(a,T,eb.currentNode,f,Ra);({EAa:Ra}=Ub);return Ub})().returnValue&&(c.vra(l),Mf.hs.tqa(b),b.rj()):Jd.TableReader.Nq(eb)?(c.vra(l),this.A4f&&({response:ua,returnValue:Ra}=this.A4f.fum(a,Bb,b,eb,I,ja,ua))):Mf.v7.ke(eb.currentNode)&&((()=>
{let Ub=this.hxh(a,T,eb.currentNode,f,Ra);({EAa:Ra}=Ub);return Ub})().returnValue||this.u4f&&this.u4f.P$i(a,c,l,b,T,eb));return{returnValue:!0,response:ua,EAa:Ra}}return{returnValue:!1,response:ua,EAa:Ra}}hxh(a,b,c,f,l){return Mf.kg.Gg&&Mf.kg.wD&&(a=(a?b:c).Sa.last,b=A.AFrameworkApplication.userName,!a.vp||a.vp.authorName!==b)?(f&&(Me.a.instance.setSelection(f),l=!1),{returnValue:!0,EAa:l}):{returnValue:!1,EAa:l}}T_j(a,b,c,f,l,u,I,T){return U.a.instance.ga(67)&&ge.OutlineElementReader.ZBg(b,a)?(se.isInTableCell(b)&&
(ce.returnToContainingCell(b),se.isEmpty(b)&&c.vra(f),{hYl:a,returnValue:T}=Mf.AYk(b,I,a,l,u),a||(T=2)),{returnValue:!0,response:T}):{returnValue:!1,response:T}}XWj(a,b,c,f,l,u,I,T){ge.OutlineElementReader.ZBg(b,a)||({response:I,EAa:T}=Mf.ldj(c,f,a,u,l,I,T));return{returnValue:!1,response:I,EAa:T}}T$i(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){let Ub=!1,Xb=2;const tc=Mf.v7.isEmpty(eb),lc=eb.currentNode;jb.OutlineElementNavigator.$e(eb);(()=>{let Ec=this.j3c(l,eb,ua,Xb);({response:Xb}=Ec);return Ec})().returnValue||
(()=>{let Ec=this.AWj(l,eb,a,b,c,Xb);({response:Xb}=Ec);return Ec})().returnValue||(()=>{let Ec=this.v0j(l,eb,a,b,c,Xb);({response:Xb}=Ec);return Ec})().returnValue||(()=>{let Ec=this.GYj(l,eb,a,b,c,Xb);({response:Xb}=Ec);return Ec})().returnValue||(()=>{let Ec=this.LTj(l,eb,T,Ra,f,tc,lc,Bb,ja,Xb,Ub);({response:Xb,EAa:Ub}=Ec);return Ec})().returnValue||(()=>{let Ec=this.T_j(l,eb,T,f,ja,ua,lc,Xb);({response:Xb}=Ec);return Ec})().returnValue||(()=>{let Ec=this.XWj(l,eb,b,c,T,I,Xb,Ub);({response:Xb,
EAa:Ub}=Ec);return Ec})();Mf.qjh(T,32===Xb);Ub&&Mf.hW(ja,u)}gXl(a,b,c){return a&&a.Qa(Oe.a.ezb)?this.SUi.FPh()||a.$a(Oe.a.ezb)?!a.ra(Oe.a.ezb,!1):this.nig(!1,c):this.nig(b,c)}iQh(){return{returnValue:!1,FXa:!1}}static get characterPropertiesEditor(){return Mf.Ch||(Mf.Ch=Tb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get eg(){return Mf.qh||(Mf.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}static get v7(){return Mf.Cs||(Mf.Cs=Tb.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return Mf.uo||
(Mf.uo=Tb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get hs(){return Mf.ir||(Mf.ir=Tb.a.instance.resolve("Box4.List.IListEditor"))}static get zi(){return Mf.NBf||(Mf.NBf=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get kJ(){return Rl.a.instance}static get Cw(){return ut.a.wBb}static get kg(){return Mf.zd||(Mf.zd=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g8(){return Mf.Pp||(Mf.Pp=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get gBc(){return Mf.QE||
(Mf.QE=Tb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get fd(){return jd.a.instance}static get Jj(){return mi.a.instance}static get Uu(){return Mf.LE||(Mf.LE=Tb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get AU(){return Xe.a.instance}static Roj(a){if(1===a.Oa.length&&(a=a.Oa.ga(0),Bc.SelectionEditor.uy(a))){var b=a.Ua;a=b.node;b=b.Ra;var c=Mf.v7.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&Mf.characterPropertiesEditor.replaceTextRange(me.a.createTextRange(a,
b-1,b),"\u00a0")}}static wHi(a,b){if(!b.hyperlink.$Db){const c=new pg.GraphTransaction(15);try{c.rd(a.node),Mf.Uu.eL(a,b)}finally{c&&c.dispose()}}}static tqa(a,b){a=Mf.eg.Aw(a).X7c?G.a.aO:G.a.qL;return A.AFrameworkApplication.Pa.Ai(b.Qif,a,2,!1,b.gL,b.Bd)}static ldj(a,b,c,f,l,u,I){if(c=Bc.SelectionEditor.jVa(f,!1,!c,!1,!1,!0)){f=$d.SelectionFactory.PO(f,c.Ua);u=32;for(c=0;c<f.length;++c){l.vra(f.ga(c));const T=A.AFrameworkApplication.Pa.Ai(f.ga(c),G.a.PJ,2,!0,a,b);2!==T&&(u=T)}32===u&&(I=!0)}return{response:u,
EAa:I}}static Acj(a,b,c,f,l,u,I,T,ja){let ua=!1;a(c)?(ua=Mf.R$d(c,!0,f,l,u,I))&&Mf.SOa(T,f,ja):b(c)?(ua=Mf.R$d(c,!1,f,l,u,I))&&Mf.SOa(T,f,ja):(u.normalize(),Mf.SOa(T,f,ja));return ua}static SOa(a,b,c){c&&c.hW()||Mf.hW(b,a)}static R$d(a,b,c,f,l,u){f||Bj.OutlineReader.ona(a)||(c=Mf.Pem(c))&&l.cUl(c);a=32===A.AFrameworkApplication.Pa.Ai(a,u.actionId,2,b,u.gL,u.Bd);Mf.qjh(l,a);return a}static qjh(a,b){b?a.normalize():a.cancel()}static hW(a,b){b&&(b=b.restore())&&a.setSelection(b)}static U$i(a,b,c,f,l,
u,I,T){let ja;var ua;if(ua=!b)ua=Mf.Uu.Neb(a),{edc:ja}=ua,ua=ua.returnValue;ua?(c=new Nr(f),Mf.wHi(a,ja),l.normalize(),Mf.hW(u,c)):Mf.R$d(a,!1,u,I,l,T)&&(b&&Mf.kg.Gg&&Mf.kg.wD?(b=Mf.g8.l7d)?(u.setSelection($d.SelectionFactory.fh(a.node,b)),Mf.g8.l7d=null):Mf.hW(u,c):Mf.hW(u,c))}static AYk(a,b,c,f,l){let u,I=2;u=!0;if(se.isEmpty(a)){const T=ce.getContainingTable(a),ja=Jd.TableReader.fl(T),ua=Jd.TableReader.ej(T);1===ja&&1===ua?(I=A.AFrameworkApplication.Pa.Ai(me.a.create(T),G.a.S$a,2,!1,l.gL,l.Bd),
f.setSelection($d.SelectionFactory.fh(b,0)),u=!1):1===ja?I=A.AFrameworkApplication.Pa.Ai(l.Qif,G.a.mFa,2,!1,l.gL,l.Bd):(b=se.isEmptyIncludingTheRestOfTheRow(a),se.isFirstCellInRow(a)&&b?I=A.AFrameworkApplication.Pa.Ai(l.Qif,G.a.deleteRow,2,!1,l.gL,l.Bd):!c&&b&&(I=32,a=Bc.SelectionEditor.Sua(f.Oa.kb,!1,!1,!1,!0),f.setSelection(a),u=!1))}return{returnValue:I,hYl:u}}static kXl(a){return a.ry||Bj.OutlineReader.ona(a)||Mf.v7.jn(a)}static Pem(a){return(a=gj.Zua(a.Oa,!0))&&1===a.length&&(a=a.getContext(0).node,
Jd.TableReader.kfb(a))?a:null}}Mf.qh=null;Mf.Ch=null;Mf.NBf=null;Mf.Cs=null;Mf.uo=null;Mf.ir=null;Mf.zd=null;Mf.Pp=null;Mf.QE=null;Mf.zpf=null;Mf.LE=null;Object(m.a)(Mf,"ADeleteViewStrategy",null,[]);class qv{constructor(a,b){this.Ub=a;this.Uh=b}P$i(a,b,c,f,l,u){l=this.Ub.Pc(l);a&&!this.Uh.isEmpty(l)?(jb.OutlineElementNavigator.$e(u),b.bZh(u.currentNode),qv.zi.merge(f,u,!1,!1)):(jb.OutlineElementNavigator.$e(u),b.vra(c),qv.zi.merge(u,f,!1,!1))}static get zi(){return qv.Rj||(qv.Rj=Tb.a.instance.resolve("Box4.IOutlineElementEditor"))}}
qv.Rj=null;Object(m.a)(qv,"DeleteParagraphNodeStrategy",null,[1872]);class wP extends Mf{constructor(a,b,c,f){super();this.JHk=new qv(c,f);this.ka=a;this.k1g=b;this.Ub=c}get A4f(){throw Error.notImplemented();}get u4f(){return this.JHk}Qtj(a,b){return Bc.SelectionEditor.jVa(a,!0,!b,!1,!1,!0)}jXl(a){return Bc.SelectionEditor.Tk(a)}nig(a,b){if(!this.ka.fye||!this.ka.dFb||!this.ka.gye||a)return!1;a=this.WOj(b);return 1===(a&1)&&2!==(a&2)}WOj(a){var b=a.Oa;if(!b.length)return 0;a=Object(gb.a)(5,b.ga(0).Ua.node);
if(!a||!a.Ft())return 0;a=(a=(a=a.xM())?a.gqg():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var u=gj.$_c(l,!0),I=gj.$_c(l,!1);if(u&&I){if(Bc.SelectionEditor.Vu(u)&&!Bc.SelectionEditor.TDb(u)||!$a.ParagraphReader.uve(u.node)||u!==I&&Bc.SelectionEditor.Vu(I)&&!Bc.SelectionEditor.TDb(I)||!$a.ParagraphReader.Skk(I.node))return 0;if(l=Object(gb.a)(ud.a,Uh.ContextSetEditor.instance.y$b(ud.a.YTa(l.toArray()),16,!1)))for(u=0;u<l.length;++u)I=
Object(gb.a)(Sm.TableCellNode,l.getContext(u).node),a.rq()&&I.isControllingCell?this.Uck(I,c):I.isGhostCell||Array.add(c,I)}}}if(!c.length)return 0;b=a.jW;f=a.O4;u=l=0;I=Array(b);const T=Array(f);for(var ja=0;ja<b;++ja)I[ja]=0;for(ja=0;ja<f;++ja)T[ja]=0;for(ja=0;ja<c.length;++ja){const ua=c[ja].gqg();++I[ua.rowIndex]===f&&++l;++T[ua.Yi]===b&&++u}if(0<l&&0<u){if(l===b&&u===f)return 3}else if(l||u){if(0<l){if(!a.rq())for(a=0;a<f;++a)if(T[a]!==l)return 0;return 1}if(0<u){if(!a.rq())for(a=0;a<b;++a)if(I[a]!==
u)return 0;return 1}}return 0}Uck(a,b){se.foreachMergedCells(Object(gb.a)(Zg.a,a),c=>{Array.add(b,c)})}j3c(a,b,c,f){if(!a&&Kc.ListReader.hl(b)){var l=this.Ub.SVa();l.Uc(b);if((l=Object(gb.a)(4,l.Ug(10)))&&l.ig){if(this.k1g.dxb(b))this.k1g.Olb(b,-1,0),f=32;else if(b.NG(1)){if(b.Qf(1),(()=>{let u=super.j3c(a,b,c,f);({response:f}=u);return u})().returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.j3c(a,b,c,f)}return{returnValue:!1,response:f}}iQh(a,
b,c){if(!(b&&a===G.a.backspace&&c.Oa&&c.Oa.length&&c.Oa.qm))return{returnValue:!1,FXa:!1};b=c.$n();if(!b||!b.rq())return{returnValue:!1,FXa:!1};a=b.jW;b=b.O4;let f=a,l=0,u=b,I=0;c=Uh.ContextSetEditor.instance.dC(c.Ik);for(let ua=0;ua<c.length;ua++){if(!c[ua].El)return a=!1,{returnValue:!1,FXa:a};var T=Object(gb.a)(5,c[ua].node);if(!T||!T.Ft())return a=!1,{returnValue:!1,FXa:a};var ja=(T=T.xM())?T.$z():null;if(!ja)return a=!1,{returnValue:!1,FXa:a};T=ja.rowIndex;const Ra=ja.Yi,eb=ja.rowSpan;ja=ja.colSpan;
f=Math.min(f,T);l=Math.max(l,T+eb-1);u=Math.min(u,Ra);I=Math.max(I,Ra+ja-1)}return l-f+1!==a&&I-u+1!==b?{returnValue:!1,FXa:!1}:{returnValue:!0,FXa:l-f+1===a?!0:!1}}}Object(m.a)(wP,"DeleteViewStrategy",Mf,[]);class xP extends am{constructor(a,b,c,f){super();this.KHk=new wP(a,b,c,f);this.IHk=new jx}get TUc(){return this.KHk}get s4f(){return this.IHk}}Object(m.a)(xP,"Box4DeleteActor",am,[]);class yP{constructor(a,b,c,f,l){this.ia=a;this.HHk=new xP(b,c,f,l);Ha.InteractiveViewManager.instance.editingView.F7b=
!0}qb(){this.HHk.qb(this.ia)}Sd(){var a=G.a.backspace;const b=F.FocusManager.instance().Kc(P.AppFrame.QX);b.bindAction(B.KeyInputManager.Va(H.a.eG,0),a);b.bindAction(B.KeyInputManager.Va(H.a.eG,4),G.a.backspace);b.bindAction(B.KeyInputManager.Va(H.a.eG,4|B.KeyInputManager.Ze),N.a.Ce);b.bindAction(B.KeyInputManager.Va(H.a.eG,B.KeyInputManager.Ze),G.a.nab);b.bindAction(B.KeyInputManager.Va(H.a.Qca,0),G.a.PJ);b.bindAction(B.KeyInputManager.Va(H.a.Qca,B.KeyInputManager.Ze),G.a.vyb);E.a.Fl&&(b.bindAction(B.KeyInputManager.Va(H.a.eG,
3),G.a.backspace),b.bindAction(B.KeyInputManager.Va(H.a.eG,7),G.a.backspace),b.bindAction(B.KeyInputManager.Va(H.a.eG,5),G.a.backspace),b.bindAction(B.KeyInputManager.Va(H.a.eG,1),G.a.nab))}}Object(m.a)(yP,"DeleteActor",null,[948]);class zP{constructor(a){this.xGk=a}qb(){this.xGk.qb()}Sd(){}}Object(m.a)(zP,"EnterActor",null,[948]);class Sq{constructor(a,b,c){this.yv=a;this.a2b=b;this.yn=c}get Fo(){return this.a2b.value}Aij(a,b,c,f,l){let u,I,T;if(!(()=>{let eb=this.mQh(b,c,!1);({Yf:u,selected:I,yG:T}=
eb);return eb})().returnValue)return T;He.a.mark(5013);var ja=Sq.Dn.dC(I);for(var ua=0;ua<ja.length;++ua)if(ja[ua].isValid){var Ra=ja[ua].iterator;Ra.Zv();if(Bj.OutlineReader.Wu(Ra))return this.W9f(u,Ra);if(we.b(Ra))return Ro.instance.DFb(a,I,u),this.Fo.Bx(),He.a.mark(5014),32}ja=this.MAj(I);if(I.ry||Bc.SelectionEditor.Tk(I)||$a.ParagraphReader.jn(I)&&!Bc.SelectionEditor.oY(I)){if(Sq.Re&&Sq.Re.isFeatureEnabled(33)&&Uh.ContextSetEditor.instance.Haf(I).returnValue)return 8;T=this.X9f(b,u,a,f,l,ja)}else if(Bc.SelectionEditor.Om(I))T=
this.V9f(b,u,a,f,l,ja);else if(Bc.SelectionEditor.nh(I)){ua=new mb.GraphIterator;ua.set(I.node);ua.uc(10);if(this.r_k()&&(Ra=gf.HyperlinkReader.HD(I,!1),0<Ra.length)){if(!Ra[0].hyperlink)return da.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",Ra[0].Ra,Ra[0].Pb),8;ad.App.l$b(Ra[0].hyperlink.url);return 32}if(se.isInTableCell(ua)&&!U.a.instance.ga(77)&&(ce.returnToContainingCell(ua),U.a.instance.ga(30)&&se.isLastCellInTable(ua)&&!Bj.OutlineReader.E3c(ua)&&Bj.OutlineReader.QD(ua,
I,!0)&&(Pg.OutlineNavigator.Gba(ua),Kc.ListReader.hl(ua)||(ja=G.a.Yva),ce.returnToCell(ua)),se.isFirstCellInRow(ua)))if(Ra=new mb.GraphIterator,Ra.Uc(ua),ce.returnToContainingRow(Ra),U.a.instance.ga(30)&&Sk.j(Ra)&&Sk.e(Ra)&&1<Jd.TableReader.fl(ce.getContainingTable(Ra)))ja=G.a.deleteRow;else if(Bj.OutlineReader.QD(ua,I,!1)){const eb=I;Sk.g(Ra)&&0>=eb.uU?(ja=G.a.Odc,ce.returnToContainingTable(ua),jb.OutlineElementNavigator.$e(ua),l||(l=new W.DictionaryPropertySet),l.He(Oe.a.targetObject,ua.currentNode.id)):
U.a.instance.ga(30)&&(ja=G.a.nXa)}T=this.Z9f(b,u,a,f,l,ja)}else Bc.SelectionEditor.oY(I)&&(T=A.AFrameworkApplication.Pa.Ai(b,G.a.WC,2,!1,f,l));He.a.mark(5014);return T}mQh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Yf:f,selected:l,yG:32};if(!a.view.xi)return{returnValue:!1,Yf:f,selected:l,yG:2};f=a.view;l=f.Rb.Ik;return!l||U.a.instance.ga(14)&&!Sq.Jj.DBg(l,c)?{returnValue:!1,Yf:f,selected:l,yG:2}:this.yn&&this.yn.instance&&this.yn.instance.rY(l)?{returnValue:!1,Yf:f,selected:l,yG:4}:{returnValue:!0,
Yf:f,selected:l,yG:2}}IWl(a,b,c,f,l){let u,I,T;if(!(()=>{let ua=this.mQh(b,c,!0);({Yf:u,selected:I,yG:T}=ua);return ua})().returnValue)return T;const ja=Sq.Dn.dC(I);for(let ua=0;ua<ja.length;++ua){if(!ja[ua].isValid)continue;const Ra=ja[ua].iterator;Ra.Zv();if(Bj.OutlineReader.Wu(Ra))return this.W9f(u,Ra)}I.ry||Bc.SelectionEditor.Tk(I)?T=this.X9f(b,u,a,f,l,G.a.Mdc):Bc.SelectionEditor.Om(I)?T=this.V9f(b,u,a,f,l,G.a.Mdc):Bc.SelectionEditor.nh(I)?T=this.Z9f(b,u,a,f,l,G.a.Mdc):Bc.SelectionEditor.oY(I)&&
(T=A.AFrameworkApplication.Pa.Ai(b,G.a.WC,2,!1,f,l));return T}W9f(a,b){a.Rb.setSelection($d.SelectionFactory.hk(b.currentNode,!1));return 32}X9f(a,b,c,f,l,u){const I=new pg.GraphTransaction(15);I.Wc=c;I.rd(b.Zg);b=new W.DictionaryPropertySet;b.setValue(Oe.a.ezb,!0);b=A.AFrameworkApplication.Pa.Ai(a,G.a.PJ,2,!0,f,b);32===b&&(b=A.AFrameworkApplication.Pa.Ai(a,u,2,!1,f,l));I.dispose();return b}V9f(a,b,c,f,l,u){const I=new pg.GraphTransaction(15);I.Wc=c;I.rd(b.Zg);b.Rb.setSelection(Bc.SelectionEditor.Km(b.Rb.Oa.ga(0),
!1,!1));a=A.AFrameworkApplication.Pa.Ai(a,u,2,!1,f,l);I.dispose();return a}Z9f(a,b,c,f,l,u){const I=new pg.GraphTransaction(15,c);I.Wc=c;I.rd(b.Zg);a=A.AFrameworkApplication.Pa.Ai(a,u,2,!1,f,l);I.dispose();return a}static get Dn(){return Uh.ContextSetEditor.instance}static get Jj(){return mi.a.instance}static get Re(){return Sq.kd||(Sq.kd=Tb.a.instance.ub("Box4.IFeatureHelper"))}}Sq.kd=null;Object(m.a)(Sq,"AEnterViewStrategy",null,[1867]);class $t extends Sq{constructor(a,b,c){super(a,b,c)}MAj(a){let b=
G.a.WC;if(a&&(a=Sq.Dn.dC(a))&&0<a.length){const c=new mb.GraphIterator;c.set(a[0].node);c.uc(10);(a=c.j5a())&&a.Qa(yb.a.mj)&&(a=a.$a(yb.a.mj),0===a||2===a)&&(b=G.a.Mdc)}return b}r_k(){return $t.vW?!1:!0}static get vW(){null==$t.DJ&&($t.DJ=A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled"):!1);return $t.DJ}}$t.DJ=null;Object(m.a)($t,"EnterViewStrategy",Sq,[]);class HG{constructor(a){this.fJk=a}Hyd(a,b){this.fJk.rW(a,b)}}Object(m.a)(HG,
"PPTFontNameFormattingStrategy",null,[1863]);class AP{FPh(){return!1}}Object(m.a)(AP,"PptClipboardOperationCutStrategy",null,[1758]);class BP{constructor(a,b){this.qN=a;this.oa=b}lnk(a){return 10===a.Zi||16===a.Zi||60===a.Zi}JPi(a){if(this.qN.Peb(a)&&this.qN.WDb(a))return!1;let b=a=null;this.oa.Oa.kb&&(b=this.oa.Oa.kb.Ua,a=this.oa.Oa.kb.vf);return this.Jye(b)&&this.Jye(a)}Jye(a){if(a){if(a.contextId===ta.a.paragraph)return!0;if(a.contextId===ta.a.endOfParagraph&&(a=a.node))return Aa.a.Ta(a.characterData)}return!1}WXl(a,
b){return this.X9e(a,b)}X9e(a,b){let c=null;this.oa.Oa.kb&&(c=this.oa.Oa.kb.Ua);return this.Jye(c)?!!a&&this.qN.WDb(a)||1===b:!1}}Object(m.a)(BP,"PptDeleteOutlineElementNodeStrategy",null,[1757]);class CP{constructor(a,b,c){this.Er=a;this.RK=b;this.gb=c}t$f(a){if(this.gb.Oa&&this.gb.Oa.qm){const f=this.Er.Ugg(this.gb.Oa).returnValue;if(!f.aVa()&&a.ry){a=new ud.a;var b=this.gb.yw();for(const l of b)if(b=Object(gb.a)(Sm.TableCellNode,l)){var c=mb.GraphIterator.ob(b);if(c.wf()){const u=Sk.c(c);c=this.RK.d_c(Object(gb.a)(650,
c.currentNode));f.Hkj(u,c)&&a.addContext(Me.a.TTa($d.SelectionFactory.Nl(b)))}}}}return a}}Object(m.a)(CP,"PptDeleteTableSegmentStrategy",null,[1759]);class DP{KVh(){return!1}SDg(a){return!!a&&!a.en.equals(Ua.a.nil)}}Object(m.a)(DP,"PptEopFormattingStrategy",null,[1755]);class EP{constructor(a,b,c){this.Mfd=!1;this.Ga=a;this.IK=b;this.oa=c}f0h(a,b){a&&b&&(b.Rr&&(a.setValue(yb.a.gga,b.Rr.value),a.setValue(yb.a.Cna,b.Rr.unit)),b.Pr&&(a.setValue(yb.a.fga,b.Pr.value),a.setValue(yb.a.Bna,b.Pr.unit)),b.lineSpacing&&
(a.setValue(yb.a.Ay,b.lineSpacing.value),a.setValue(yb.a.EY,b.lineSpacing.unit)));return!0}CPh(){return!1}pQh(){return!1}yPh(){return!this.Mfd}jQh(a,b){return a===ta.a.paragraph||a===ta.a.endOfParagraph||b}zPh(a,b,c){this.oa.Oa&&this.oa.Oa.kb&&(c=!this.oa.Oa.kb.zea);return a!==ta.a.textRange&&(b===ta.a.paragraph||c)}LMf(a,b,c){this.Mfd=!1;if(a.Ft()&&this.oa.Oa.kb){var f=this.oa.Oa.kb.Ua;this.oa.Oa&&this.oa.Oa.qm&&this.oa.Oa.ga(0)&&(f=this.oa.Oa.ga(0).Ua);if(f=Od.a.yt($a.ParagraphReader.ke(f.node)?
f:$d.SelectionFactory.Nl(a).Ua))if(f=f.cache)!c.Qa(yb.a.latinFont)&&f.Qa(yb.a.latinFont)&&c.setValue(yb.a.latinFont,f.tM),!c.Qa(rb.a.fontColor)&&f.y5&&c.setValue(rb.a.fontColor,f.fontColor),!c.Qa(rb.a.fontSize)&&f.Iva&&c.setValue(rb.a.fontSize,f.fontSize),!c.Qa(rb.a.bold)&&f.LWa&&c.setValue(rb.a.bold,f.isBold)}if(b){if(f=a.BR(this.IK)){b.oV||a.ra(yb.a.rue,!1)||f.ra(yb.a.rue,!1)||(this.Mfd=!0);const l=b.spacing;l&&(!l.Rr||l.Rr.value||f.Qa(yb.a.gga)||(l.Rr=null),!l.Pr||l.Pr.value||f.Qa(yb.a.fga)||(l.Pr=
null),l.lineSpacing&&2===l.lineSpacing.unit&&1===l.lineSpacing.value&&!f.Qa(yb.a.Ay)&&(l.lineSpacing=null))}this.Mfd||(b.oV||(b.oV=Gf.a.JO(16,0)),b.oV.Geg=!0)}if((f=a.kog())&&!f.Hba&&(c.Qa(rb.a.fontSize)&&(f=this.Ga.lGa(this.Ga.Gn(a)),c.setValue(rb.a.fontSize,c.$a(rb.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.unit)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Ga.QAb(this.Ga.Gn(a))}c.ra(rb.a.ou,!1)&&c.setValue(rb.a.ou,!1);c.ra(rb.a.n1,!1)&&c.setValue(rb.a.n1,
!1)}}Object(m.a)(EP,"PptFormatPainterStrategy",null,[1631]);class FP extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.Mgf=b;this.pfb=c}}Object(m.a)(FP,"UndoRedoEventArgs",Sys.EventArgs,[]);class GP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.ia=a;this.uf=b;this.oa=c;this.Fa=f;this.Pt=l;this.gfd=u;this.fPk=I;this.H9g=T;this.AF=ja;this.ujb=ua;this.yK=Ra;this.NJk=eb;this.ue=Ub}qb(){this.ia.pa(M.a.P1a,wc.a.application,Object(R.a)(this,this.Jtg,"handleUndoRedo"),4);this.ia.pa(M.a.O1a,
wc.a.application,Object(R.a)(this,this.Jtg,"handleUndoRedo"),4)}Sd(){const a=this.Fa.Kc(xc.a.Nj);a.aQc(B.KeyInputManager.Va(H.a.Eqb,B.KeyInputManager.Ze),M.a.P1a,()=>!0);a.bindAction(B.KeyInputManager.Va(H.a.ZCc,B.KeyInputManager.Ze),M.a.O1a)}Jtg(a,b,c,f,l){b=!0;a===M.a.O1a&&(b=!1);if(this.uf.Xc(this.H9g)||!this.SWl(b,l))return 16;if(!this.TWl())return this.Pt.Fqa(),16;if(1===c)return 32;if(c=!this.Pt.Tgk(b))this.oa.uj(),this.yFl();f=this.Pt.x_c(b);(l=this.yK.H7(f))&&$c.a.Xk("UndoRedoActionName",
l);this.ujb.eod(!c);this.ue.Nrl(new FP(a,f,b));(f=this.Pt.Uge(b))&&f.V7!==Ua.a.nil&&$c.a.Xk("UndoRedoRevision",$c.a.Kcb(f.V7.toString()).toString());this.NJk.eod(f,l,b);if(b?!this.Pt.undo():!this.Pt.redo())return da.ULS.sendTraceTag(512499928,801,10,"User perform {0} failed!!",a===M.a.undo?"undo":"redo"),8;c&&this.uf.mx(this.H9g,a);return 32}SWl(a,b){a&&!this.Pt.YU&&b&&da.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.Pt.Heb());return(a?this.Pt.YU:
this.Pt.Pma)&&!(this.Fa.Je&&this.Fa.Je.name===xc.a.hDi)&&this.UWl()}TWl(){return this.gfd||!this.dkk()}dkk(){return!this.fPk.iGa&&!!this.AF.instance&&this.AF.instance.pok()}UWl(){return!this.ekk()}ekk(){const a=this.oa.Zn();return a?a.Iv:!1}yFl(){const a=this.Fa.Je;!a||a.name!==xc.a.Ag&&a.name!==xc.a.Dpa||this.Fa.Gd()}}Object(m.a)(GP,"UndoRedoActor",null,[948]);class HP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug,Tg,$f,Ve,xg,yg,ng,Wh,Ai,Wf,gg){this.bJa=this.Qxa=
this.Yid=null;this.QIb=0;this.XTg=this.aJe=!1;if(Ub.Cm&&!gg)throw Error.argumentNull("sorterViewActorLazy");this.JI=u;this.ia=a;this.Hic=b;this.Fa=c;this.ih=f;this.oa=l;this.uf=I;this.te=T;this.Yb=ja;this.sa=ua;this.Tb=Ra;this.npc=eb;this.Lb=Bb;this.ka=Ub;this.Kx=Xb;this.Xa=tc;this.uB=lc;this.De=Ec;this.IKa=hd;this.t1g=yd;this.Iw=Pd;this.zb=pe;this.Ms=Se;this.Lfd=vf;this.wWg=Ub.wCg;this.Hc=ug;this.ogb=Tg;this.Hp=$f;this.Mc=Ve;this.Zb=xg;this.yb=yg;this.ZP=ng;this.Db=Wh;this.MI=Ai;this.Hx=Wf;this.lba=
gg;this.SRi()}qb(){this.ia.pa(M.a.fOb,wc.a.application,Object(R.a)(this,this.fOb,"queryEdit"),96);this.ia.pa(M.a.HOb,wc.a.application,Object(R.a)(this,this.HOb,"querySorterView"),96);this.ia.pa(M.a.Muc,wc.a.application,Object(R.a)(this,this.Muc,"querySlideInformation"),96);this.ia.xa(M.a.zud,wc.a.application,Object(R.a)(this,this.F7l,"switchToReadingMode"));this.ia.xa(M.a.zSb,wc.a.application,Object(R.a)(this,this.F5l,"startSlideShowFromBegnning"));this.ia.xa(M.a.ysd,wc.a.application,Object(R.a)(this,
this.ysd,"present"));this.ia.xa(M.a.Ftc,wc.a.application,Object(R.a)(this,this.Ftc,"presentDropDown"));this.ia.xa(M.a.Msc,wc.a.application,Object(R.a)(this,this.Msc,"playFromBeginningTopBar"));this.ia.xa(M.a.NAa,wc.a.application,Object(R.a)(this,this.NAa,"startSlideShowFromCurrentSlide"));this.ia.xa(M.a.kAb,wc.a.application,Object(R.a)(this,this.kAb,"forceClose"));this.ia.xa(M.a.gia,wc.a.application,Object(R.a)(this,this.gia,"rehearsePresentation"));this.ia.xa(M.a.yvc,wc.a.application,Object(R.a)(this,
this.yvc,"rehearsePresentationTopBar"));this.ka.pptEditorRehearsalSpeechClientEnabled&&(this.ia.xa(M.a.DWc,wc.a.application,Object(R.a)(this,this.DWc,"enableSubtitlesKeyboardShortcut")),this.ia.xa(M.a.CWc,wc.a.application,Object(R.a)(this,this.CWc,"enableLivePresenterKeyboardShortcut")));this.Uui();this.ia.xa(M.a.MNa,wc.a.application,Object(R.a)(this,this.MNa,"showEditTriPaneView"));this.Lb.getBooleanAppSetting("PPTSorterViewEnabled")&&(this.aJe=this.Lb.getBooleanAppSetting("FeedbackPaneExperienceIsEnabled")&&
this.Lb.getBooleanAppSetting("HelpTabIsEnabled"),this.ia.xa(M.a.N5b,wc.a.application,Object(R.a)(this,this.N5b,"closeEditTriPaneView")));this.ka.p7c&&this.IKa.p9j(A.AFrameworkApplication.buildVersion,this.Xa.$k,A.AFrameworkApplication.userSessionId,this.Mc)}Sd(){if(this.Lb.getBooleanAppSetting("SlideShowByShortcutEnabled")){const a=this.Fa.Kc(K.AFrame.Nj);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.SCc,B.KeyInputManager.Ze|4),M.a.NAa);K.AFrame.Yk(a,B.KeyInputManager.Va(H.a.SCc,B.KeyInputManager.Ze),M.a.zSb)}}Uui(){this.ia.xa(M.a.M1a,
wc.a.application,Object(R.a)(this,this.M1a,"presentLive"));this.ia.xa(M.a.Htc,wc.a.application,Object(R.a)(this,this.Htc,"presentLiveTopBar"));this.ia.xa(M.a.N1a,wc.a.application,Object(R.a)(this,this.N1a,"presentLiveSetAccessControlAnyone"));this.ia.xa(M.a.Gtc,wc.a.application,Object(R.a)(this,this.Gtc,"presentLiveSetAccessControlOrganization"));this.ia.pa(M.a.xOb,wc.a.application,Object(R.a)(this,this.xOb,"queryPresentLiveAccessControlAnyone"),96);this.ia.pa(M.a.yOb,wc.a.application,Object(R.a)(this,
this.yOb,"queryPresentLiveAccessControlOrganization"),96);Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.UO("L_PublicLivePresentations",!0).then(b=>{b||(ya.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.ia.YI(M.a.N1a,ta.a.application,Object(R.a)(this,this.N1a,"presentLiveSetAccessControlAnyone")),ad.App.Ob.ROa(M.a.N1a,Object(R.a)(new vq,(new vq).hva,"getCommandById")));return null},b=>{ya.a.J(512499925,
822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}Muc(a,b,c,f,l){a=(a=this.sa.Aa)?a.ve+1:0;a=(b=this.Tb.Hi())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[xq.a.Value]=a;l[bn.a.labelText]=a;return 32}fOb(a,b,c,f,l){this.yb&&0!==this.yb.$i?l.Rf(!1):l.Rf(!0);return 32}HOb(a,b,c,f,l){(a=Object(gb.a)(Di.a,l))&&(1!==this.yb.$i?a.Rf(!1):a.Rf(!0));return 32}MNa(a,b,c){try{if(1===c)return 32;2===c&&0!==this.yb.$i&&(ya.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),
this.yb.$i=0,this.Db&&(this.Db.slidePane.Jl(),this.ka.Cm||this.Db.thumbnailPane.Jl(),this.Db.notesPane.Jl(),this.MI&&this.MI.setVisibility(!0)),this.ia.nb(M.a.lnb,2),this.ia.nb(M.a.Ixb,2),this.ZP.dT("PptEditingStatusBar.Notes",!0),this.ZP.dT("PptEditingStatusBar.ZoomScale",!0),this.ZP.dT("PptEditingStatusBar.FitToWindow",!0),this.aJe?this.ZP.dT("PptEditingStatusBar.GiveFeedbackPane",!0):this.ZP.dT("PptEditingStatusBar.GiveFeedback",!0),this.Hc.Gz(new Pq.a(2)),this.Hc.Gz(new Pq.a(1)),this.ka.Cm||this.ih.bM(xc.a.aG),
this.ih.bM(xc.a.Dpa),this.ih.bM(xc.a.Ag),this.ih.bM(xc.a.wR))}catch(f){ya.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}N5b(a,b,c){try{if(1===c)return 32;2===c&&(this.Db&&(this.Db.slidePane.ur(),this.Db.thumbnailPane.ur(),this.Db.notesPane.ur(),this.MI&&this.MI.setVisibility(!1)),this.ZP.dT("PptEditingStatusBar.Notes",!1),this.ZP.dT("PptEditingStatusBar.ZoomScale",!1),this.ZP.dT("PptEditingStatusBar.FitToWindow",!1),this.aJe?this.ZP.dT("PptEditingStatusBar.GiveFeedbackPane",
!1):this.ZP.dT("PptEditingStatusBar.GiveFeedback",!1),this.Hc.Gz(new Pq.a(2)),this.Hc.Gz(new Pq.a(1)),this.ka.Cm||this.ih.zp(xc.a.aG),this.ih.zp(xc.a.Dpa),this.ih.zp(xc.a.Ag),this.ih.zp(xc.a.wR),this.oa.Bh())}catch(f){ya.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",f)}return 32}F7l(a,b,c){if(this.uf.Xc(this.Yb.Of))return 16;if(1===c)return this.sa.Aa?32:16;b=(new Date).getTime();let f=oe.a.Xi(window.document.URL,Gg.a.Xsh,Gg.a.readingView,!0);if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");
c=this.sa.Aa.Fb;f=oe.a.Xi(f,Gg.a.wsc,c?c.sid.toString():"",!0);f=this.Hic.instance&&this.Hic.instance.isVisible?oe.a.Xi(f,Gg.a.Vsh,"1",!0):oe.a.removeParameter(f,Gg.a.Vsh,!0);this.RRi();f=oe.a.Xi(f,A.AFrameworkApplication.Imd,b.toString(),!0);this.oa.Bh();this.Fa.Gd();this.Kx.show(!0,a);this.JI.b$(!1,!0,()=>{this.yUh(f)},()=>{ya.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.yUh(f);return!0});return 32}yUh(a){this.npc.openWindow(1,a,!1)||this.Kx.hide()}ysd(a,b,c){return this.Oob(a,
c,null)}Ftc(a,b,c){return this.Oob(a,c,null)}Msc(a,b,c){return this.Oob(a,c,null)}F5l(a,b,c){return this.Oob(a,c,null)}NAa(a,b,c){return this.Oob(a,c,this.sa.Aa?this.sa.Aa.Fb:null)}Oob(a,b,c,f,l){f=void 0===f?!1:f;l=void 0===l?!1:l;if(!this.ka.p7c)return this.k5l(a,b,c);if(this.uf.Xc(this.Yb.Of)||!this.Tb.Hi()||this.ka.preventDuplicateSlideShowLaunches&&this.IKa.bgc()||this.ka.allowDisablingSlideShowButtonDueToRehydration&&this.IKa.koe)return 16;if(1===b)return this.QRb()?32:8;this.ka.rBg&&!md.a("DummyChangeGateForTest")&&
ya.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.Hx.hasDeferredContent()&&ya.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");this.E5l(c,f,l);return 32}E5l(a,b,c){this.QIb=(new Date).getTime();this.oa.Bh();this.Fa.Df(xc.a.vD);this.Hc.Wzh();ya.a.J(512499918,830,15,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.IKa.koe);const f=a?a.sid:-1;a=(a=a?Object(gb.a)(267,this.Tb.LGa(a.sid)):null)?a.ve+1:-1;let l=!1;this.Hp.instance?
l=this.Hp.instance.S0?!0:!1:ya.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.IKa.tBd(f,a,b,this.Lb.Ea("361"),this.Xa.$k,this.Xa.podSessionId,this.Lb.Ea("387"),A.AFrameworkApplication.userSessionId,this.ka.nok,this.QIb,l,this.Xa,c);this.IKa.Oka(Object(R.a)(this,this.Jod,"onExitSlideshowHandler"));this.uB.C2l()}yvc(a,b,c,f){return this.gia(a,b,c,f,{entryPoint:4})}gia(a,b,c,f,l){switch(c){case 2:if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");this.ka.pptEditorRehearsalSpeechClientEnabled&&
(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.Ia(M.a.tzc,2,b),this.Mc&&(this.Mc.PFa=!1),this.Zb&&this.Zb.instance&&(this.Zb.instance.PFa=!1));return this.IKa.bgc()?(this.Mc&&(this.Mc.ji=!1),32):this.Oob(a,c,this.sa.Aa.Fb,!0);case 1:if(0<this.Tb.Hi())if(this.ka.pptEditorRehearsalSpeechClientEnabled){if(32===this.ia.nb(M.a.SNa,1)&&32===this.ia.nb(M.a.tzc,1)&&this.QRb())return 32;break}else return this.QRb()?this.ia.nb(M.a.SNa,1):8;else break;default:ya.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}DWc(a,
b,c){switch(c){case 2:if(this.ka.pptEditorRehearsalSpeechClientEnabled&&this.Mc)return this.Mc.PFa=!0,32;break;case 1:return this.ka.pptEditorRehearsalSpeechClientEnabled?32:8;default:ya.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}CWc(a,b,c){switch(c){case 2:if(this.ka.pptEditorRehearsalSpeechClientEnabled&&this.Zb&&this.Zb.instance)return this.Zb.instance.PFa=!0,32;break;case 1:return this.ka.pptEditorRehearsalSpeechClientEnabled?32:8;default:ya.a.J(512499914,
822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}Htc(a,b,c,f,l){return this.M1a(a,b,c,f,l)}M1a(a,b,c){if(this.XTg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){ya.a.J(512499913,833,10,"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.obb&&this.QRb()?0<this.Tb.Hi()?32:8:8;this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&
(this.Zb.instance.OFa=!0);if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");return this.Oob(a,c,this.sa.Aa.Fb,!1,!0)}N1a(a,b,c){if(1===c)return this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.obb&&this.QRb()?32:8;this.Zb.instance.Xr&&0!==this.Zb.instance.accessControl?this.Zb.instance.showEndSessionDialog(()=>{this.Zb.instance.S8b(5);this.Zb.instance.accessControl=0;this.Hc.Gz(new Pq.a(1))},()=>{}):(this.Zb.instance.accessControl=0,this.Hc.Gz(new Pq.a(1)));return 32}Gtc(a,
b,c){if(1===c)return this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.obb&&this.Zb.instance.Pag&&this.QRb()?32:8;this.Zb.instance.Xr&&1!==this.Zb.instance.accessControl?this.Zb.instance.showEndSessionDialog(()=>{this.Zb.instance.S8b(5);this.Zb.instance.accessControl=1;this.Hc.Gz(new Pq.a(1))},()=>{}):(this.Zb.instance.accessControl=1,this.Hc.Gz(new Pq.a(1)));return 32}xOb(a,b,c,f,l){try{const u=Object(gb.a)(Di.a,l);u&&this.Zb.instance&&u.Rf(0===this.Zb.instance.accessControl)}catch(u){ya.a.J(512499912,
833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",u)}return 32}yOb(a,b,c,f,l){try{const u=Object(gb.a)(Di.a,l);u&&this.Zb.instance&&u.Rf(1===this.Zb.instance.accessControl)}catch(u){ya.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",u)}return 32}k5l(a,b,c){if(this.uf.Xc(this.Yb.Of))return 16;if(1===b)return this.Tb.Hi()?32:16;this.QIb=(new Date).getTime();this.oa.Bh();this.Fa.Df(xc.a.vD);this.Hc.Wzh();
this.Kx.show(!0,a);this.JI.b$(!1,!0,()=>{this.cJh(c,this.QIb)},()=>{ya.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.cJh(c,this.QIb);return!0});return 32}Jod(a,b){a=((new Date).getTime()-this.QIb).toString();ya.a.J(512499909,830,15,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",a,this.Hx.hasDeferredContent(),b.slideId?this.Hx.wne(b.slideId.toString()):"Missing slideId");this.Hx.hasDeferredContent()||
b.slideId&&this.Hx.wne(b.slideId.toString())?this.Hx.tta("DeferredExitSlideshowDuration",a):this.Hx.tta("ExitSlideshowDuration",a);this.IKa.jia(Object(R.a)(this,this.Jod,"onExitSlideshowHandler"));(this.Qxa=b)&&!this.Qxa.Oek&&!this.Qxa.fjk&&0<this.Qxa.slideId&&0<=this.Qxa.slideIndex&&this.e_k(this.Qxa.slideId,this.Qxa.slideIndex);this.Fa.Gd();this.wWg?(this.bJa=$c.a.Zj("ExitSlideshow"),this.uf.blockContent(this.Yb.Of,"ExitSlideshow"),this.t1g.Ak(Object(R.a)(this,this.qoh,"onPageManifestNodePropertyChanged")),
this.bJa.Wa("UnlockPodsSessionStartTime",$c.a.Ef(new Date)),this.unlockPodsSession(c=>{this.bJa&&(this.bJa.Wa("UnlockPodsSessionWithMerge",c.toString()),this.bJa.Wa("UnlockPodsSessionEndTime",$c.a.Ef(new Date)));c?this.Iw.yqj():this.Y4e()})):this.Y4e()}Y4e(a){if(void 0===a?0:a)this.Yid=null;this.Qxa&&(this.wWg&&(this.t1g.tn(Object(R.a)(this,this.qoh,"onPageManifestNodePropertyChanged")),this.uf.vL(this.Yb.Of),this.bJa&&(this.bJa.Wa("InboundPresentationEndTime",$c.a.Ef(new Date)),this.bJa.finish(),
this.bJa=null)),this.Qxa=null,this.uB.jHl())}unlockPodsSession(a){const b=kh.a.create().toString();ya.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",A.AFrameworkApplication.fa.appSettings["361"],this.Xa.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=A.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Xa.$k;
this.PKh(c,f,0,a)}PKh(a,b,c,f){this.Ms.Tj(a,2,null,b,!1,2,l=>{this.Ofm(l,c,f)},l=>{this.a1h(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,ro.a("2"))}Ofm(a,b,c){if(b)ya.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",b);else{b=!1;try{a.data.Ud&&0<a.data.Ud.length&&(b=JSON.parse(a.data.Ud).FMerged)}catch(f){ya.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",a.toString())}c(b)}}a1h(a,b,c,f,l){f||
l(!1);3>f?this.PKh(b,c,f+1,l):ya.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.Lfd.n$(a),f)}qoh(a,b){this.Yid||b.property!==yb.a.wdc||(this.Yid=new ne.a(2,1,0,Object(R.a)(this,this.Y4e,"resumeEditor"),90,"65"),this.zb.Jb(this.Yid))}cJh(a,b){this.Kx.hide();let c=!0,f=!1,l=this.te.slideShowUrl;l||(l=oe.a.Xi(window.document.URL,Gg.a.Xsh,Gg.a.slideShowView,!0),f=!0);l=oe.a.removeParameter(l,Gg.a.kdl);l=a?oe.a.Xi(l,Gg.a.wsc,a.sid.toString(),
!0):oe.a.removeParameter(l,Gg.a.wsc);0<b&&(l=oe.a.Xi(l,A.AFrameworkApplication.Imd,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);b=null;try{b=this.npc.nWe(4,l,"SlideShowWindow",a,f,!1)}catch(u){ya.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",u),c=!1}b||(ya.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),
c=!1);$c.a.Xk("Window Opened",c.toString());$c.a.UDd()}kAb(a,b,c){if(2!==c)return this.ia.nb(N.a.close,c);a=this.ia.nb(N.a.close,2);32!==a&&(ya.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location="about:blank");return 32}e_k(a,b){ya.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Tb.LGa(a))?this.ka.Cm?this.lba.value.RI(a.ve):this.De.RI(a.ve):(ya.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",
b),a=this.Tb.Hi()-1,b=b>a?a:b,0>b||(this.ka.Cm?this.lba.value.RI(b):this.De.RI(b)))}RRi(){this.ogb.instance&&this.ogb.instance.HXa&&(this.ogb.instance.rUc.FD?this.ogb.instance.endCommentSession(this.ogb.instance.rUc.FD.draftId,7):this.ogb.instance.endCommentSession("",7),this.ogb.instance.CKf())}QRb(){return this.Lb.getBooleanAppSetting("DisableSlideShowEntryPointsForLegacy")?"Modern"==this.IKa.t5():!0}SRi(){this.ka.powerPointLiveBroadcastEnabled&&Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>
{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(ya.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.XTg=!0);return null})})}}Object(m.a)(HP,"ViewSwitchingActor",null,[948]);class IP{constructor(a,b){this.mDe=null;this.Xa=a;this.opa=b;this.PRf();this.Xa.ULf(Object(R.a)(this,this.Xpd,"onSessionInfoChanged"))}PRf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Xa.presentationId.string));a.append(String.format("&{0}={1}",
Gg.a.ONl,this.Xa.pzb));a.append(String.format("&{0}={1}",Gg.a.Zpa,"368"in A.AFrameworkApplication.fa.appSettings?void 0===this.Xa.sessionInfo||null===this.Xa.sessionInfo?"undefined":this.Xa.sessionInfo:this.Xa.sessionInfo));this.Xa.$k&&a.append(String.format("&{0}={1}",Gg.a.Ysh,this.Xa.$k));this.Xa.podSessionId&&a.append(String.format("&{0}={1}",Gg.a.Mba,this.Xa.podSessionId));this.mDe=a.toString()}Xpd(){this.PRf()}resolve(a,b,c){if(!b||!b.length)return null;if(b.startsWith("./"+a))return b;const f=
md.a("FixInvalidOperationErrorInEditImageHandler")?encodeURIComponent(b):b;return c?this.opa+a+this.mDe+`&cl=${c}&${Gg.a.Tsh}=${f}`:this.opa+a+this.mDe+String.format("&{0}={1}",Gg.a.Tsh,b)}dispose(){this.Xa.RBl(Object(R.a)(this,this.Xpd,"onSessionInfoChanged"))}}Object(m.a)(IP,"ResourceViewElementResolver",null,[1784,106]);var nT=d(1080),oT=d(980);class JP{constructor(a,b){this.uad=this.zI=0;this.LZg=null;this.MZg=-1;this.NZg=null;this.Wwa=a;this.Fc=b}get Nue(){return 0<this.uad}get SHg(){return this.LZg}Y2k(a){this.uad++;
this.Fc.wUh(a.CcpId,a.CcpCorrelation)}get kze(){return this.NZg}set kze(a){this.NZg=a}Lkh(a,b){if(!a){const c=this.yRj(b);c>this.MZg&&(this.MZg=c,this.LZg=b.CcpId)}0<this.uad?this.uad--:ya.a.J(20760084,307,15,"ClipServiceManager - bad state");this.Fc.V8f(b.CcpId,a,0)}wTc(a,b,c,f){c=void 0===c?!1:c;f=void 0===f?!1:f;a=Object.assign(new oT.a,{IX:32,nq:kh.a.create().toString(),version:this.zI++,location:this.Wwa.ccpInfo,EE:this.Wwa.$k||wq.a.x5h,dataType:a,objectCount:b,BHa:c,zHa:f,Cz:kh.a.create().toString()});
ya.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}yRj(a){a:{var b=a.PackageAccessKey;let f;f=null;if(b)try{const l=Fe.a(b);if(l&&"I"in l&&"V"in l){f=new Wt(l.I,parseInt(l.V));var c={returnValue:!0,Cz:f};break a}}catch(l){}c={returnValue:!1,Cz:f}}b=c;({Cz:c}=b);if(b.returnValue&&c)return c.version;ya.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(m.a)(JP,"ClipServiceManager",null,[1773]);
class KP{constructor(a,b,c,f,l,u,I,T,ja){this.oh=a;this.hkc=c;this.CKb=f;this.tCe=l;this.Rs=u;this.Fc=I;this.j2=T;this.ia=ja;this.Sl=b;this.qga=this.oh.contentWindow.document.body;this.Rs.addHandler(this.qga,la.a.cut,Object(R.a)(this,this.Blh,"onBrowserCut"));this.Rs.addHandler(this.qga,la.a.copy,Object(R.a)(this,this.Alh,"onBrowserCopy"))}get Ic(){return this.hkc.Ic}dispose(){this.oh&&this.oh.contentWindow&&(this.Rs.removeHandler(this.qga,la.a.cut,Object(R.a)(this,this.Blh,"onBrowserCut")),this.Rs.removeHandler(this.qga,
la.a.copy,Object(R.a)(this,this.Alh,"onBrowserCopy")));this.oh=null}Blh(){if(Ml.MB&&!Ml.MB.Jce){var a=this.Fc.yQ(1,0,"OnBrowserCut");this.Aua(Object.assign(new Xt(!0,!0),{$b:a}))}}Alh(){if(Ml.MB&&!Ml.MB.Jce){var a=this.Fc.yQ(0,0,"OnBrowserCopy");this.Aua(Object.assign(new Xt(!0),{$b:a}))}}yR(a){if((A.AFrameworkApplication.cD||A.AFrameworkApplication.Tw)&&!A.AFrameworkApplication.MUa)return!1;for(let b=0;b<this.Sl.length;b++)if(this.Sl[b].yR(a))return!0;return!1}Aua(a){if(this.ia.wY)this.j2?(this.j2.show(5,
-1),this.Fc.Xg(!1,a.$b,26)):ya.a.J(509444690,826,10,"m_offlineModalCallout is null");else if(!A.AFrameworkApplication.cD&&!A.AFrameworkApplication.Tw||A.AFrameworkApplication.MUa){var b=0,c=!1;for(var f=0;f<this.Sl.length;f++)if(this.Sl[f].yR(a)){c=!0;this.Sl[f].Aua(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;case 1:f=19;break;default:f=0}this.Fc.fD(f,a.$b);if(c){if(a.NAg&&(this.tCe.Z2a(this.oh),!a.elj)){if(!this.CKb){this.Fc.Xg(!1,a.$b,1);return}this.CKb.copy(this.oh)||0!==b||(b=22)}this.Fc.Xg(0===
b,a.$b,b)}else this.Fc.Xg(!1,a.$b,20)}else this.Fc.Xg(!1,a.$b,32)}}Object(m.a)(KP,"CutCopyManager",null,[1769,106]);var pT=d(935);class LP{constructor(a,b,c){this.sZ=a;this.sZ.Ak(Object(R.a)(this,this.ph,"onPropertyChanged"));this.wN=b;this.wN.Ak(Object(R.a)(this,this.ph,"onPropertyChanged"));this.Cr=c}ph(a,b){this.Cr.Vr&&0<this.Cr.Vr.length&&(this.Cr.Vr=rd.a.MBa(this.Cr.Vr,c=>!(Ua.a.fR(c.id,b.node.id)||Object(gc.a)(dx.a,c))));this.Cr.Vr&&!this.Cr.Vr.length&&(this.Cr.Vr=null)}}Object(m.a)(LP,"GraphNodeChangeListener",
null,[]);class MP{constructor(a,b){this.Wic=null;a&&b&&new LP(a,b,this)}get Vr(){return this.Wic}set Vr(a){const b=this.Wic&&0<this.Wic.length?this.Wic[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.oNf;this.Wic=a;c&&(c.oNf=f,c.IXf=f&&b?b.IXf:pT.a.create().toString())}}Object(m.a)(MP,"InternalClipboard",null,[1768]);class NP{constructor(a,b,c,f,l,u,I,T,ja,ua){this.aNg=a;this.Pi=b;this.aha=c;this.eKa=f;this.Uaa=l;this.Ga=u;this.EJe=I;this.rlc=T;this.DLk=ja;this.ofd=ua}E7e(a,b,c){this.aNg.E7e(a,
b,c);b=new $N.a;this.EJe&&c||(b.setValue(rb.a.bold,!1),b.setValue(rb.a.underline,!1),b.setValue(rb.a.Yw,yf.Font.JW),b.setValue(rb.a.strikethrough,!1),b.setValue(rb.a.italic,!1),b.setValue(rb.a.ou,!1),b.setValue(rb.a.n1,!1));this.Pi.L8e(a,b)}S7e(a,b,c){const f=b.cache;if(this.ofd){var l=this.dzj(b);Aa.a.Ta(l)||c?f.propertySet.Qa(rb.a.font)&&(f.ra(yb.a.I6c,!1)||c)&&this.Pi.rW(a,f.tM):this.Pi.rW(a,l);f.Iva&&this.Pi.$q(a,f.fontSize)}else this.aNg.S7e(a,b,c);(!this.rlc||this.EJe&&c)&&f.y5&&(this.Pi.un(a,
rb.a.fontColor,f.fontColor),this.rlc&&(l=Wg.SchemeColor.create(null,f.fontColor),this.Pi.un(a,yb.a.schemeColor,l.toString())));this.EJe&&c&&(this.Pi.fJ(a,f.isBold),this.Pi.setItalic(a,f.isItalic),this.Pi.l_(a,f.zC),this.Pi.Inb(a,f.qY),this.Pi.n_(a,f.VD),this.Pi.Wqa(a,f.Yw),this.Pi.r3a(a,f.ou),this.Pi.Mnb(a,f.n1),this.Pi.O7(a,f.nF),this.Pi.m_(a,f.isSuperscript),this.Pi.xAa(a,f.Hn));this.Pi.r3a(a,!1);this.GSl(a,b)}uie(a){return this.aha.dWa(a)}dY(a){return this.aha.dY(a)}mWa(a){return this.eKa.mWa(a)}o$(a){return this.Uaa.o$(a)}GSl(a,
b){b=b.RA;if(null!==b&&b.Qa(yb.a.KMa)){b=b.$a(yb.a.KMa);var c=a.RA;null===c?this.Pi.un(a,yb.a.KMa,b):c.setValue(yb.a.KMa,b)}}DQh(a){return this.DLk&&a&&(a=a.paragraph)&&(a=this.Ga.Gn(a))&&a.ig?!0:!1}dzj(a){if(!this.ofd||!a)return null;let b="";var c=a.paragraph;if(!c)return null;var f=this.Ga.Gn(c);if(!f)return null;a=f.ra(ib.a.C1,[]);c=c.ra(ib.a.listLevel,th.a.dHa);a&&0<=c&&c<a.length&&(f=f.Zh)&&(a=f.Ie(a[c]))&&(a.Qa(yb.a.H9d)?b=a.$a(yb.a.H9d):a.Qa(yb.a.E9d)?b=a.$a(yb.a.E9d):a.Qa(yb.a.B9d)?b=a.$a(yb.a.B9d):
a.Qa(yb.a.L9d)&&(b=a.$a(yb.a.L9d)));return b}}Object(m.a)(NP,"PPTFormattingStewardBridge",null,[1745]);class OP{constructor(a,b,c,f){this.nc=c;this.vB=f}}Object(m.a)(OP,"PPTFormattingStewardHelper",null,[1754]);class PP{constructor(a,b,c,f,l){this.lOk=[ib.a.Sm,ib.a.Qn];this.ka=a;this.pGb=b;this.JSg=c;this.IK=f;this.Ub=l;this.whb=a.dEg;this.yxa=a.pptCopyPasteListMarkerEnabled;this.llc=a.pptCopyPasteMarginAndIndentationEnabled}agf(a){return this.pGb.Ymk(a)}Ume(a,b){return this.pGb.Kij(a,b)}Sqa(a,b,
c,f,l){f=void 0===f?null:f;l=void 0===l?null:l;if(this.JSg.krd)if(this.pGb.tBg(c))a.setValue(Oe.a.EBg,!0);else if(this.pGb.Pl(c)){if(this.llc&&a&&b){var u=this.Ub.Pc(a);u.uc(11);u.Ug(11);c=Kc.ListReader.hl(u);const I=this.IK.izj(a,u);u=this.IK.ezj(a,u);c&&(f||(ya.a.J(41219841,826,50,"Default marginLeft for internal"),b[ib.a.Sm.id.toString()]=I),l||(ya.a.J(41219843,826,50,"Default textIndent for internal"),b[ib.a.Qn.id.toString()]=u));f&&ya.a.J(41018240,826,50,"Customized marginLeft");l&&ya.a.J(41018242,
826,50,"Customized textIndent")}this.JSg.Sqa(a,b)}if(this.ka.y7c&&!$a.ParagraphReader.tY(a))for(const I of this.lOk)void 0===a.$h(I)&&a.He(I,0)}gRb(a,b,c){if(this.whb){var f=b.propertySet.Qa(rb.a.Dj)?b.propertySet.$a(rb.a.Dj).length:1;if(a=this.IK.BR(a,b.propertySet.ra(ib.a.listLevel,0)))if(this.yxa&&(0<c.Gwb||c.rTa&&0<c.rTa.length)){f="";b.udb&&!b.sug&&(f=c.font);let l=null;c.rTa&&0<c.rTa.length&&(l=c.rTa,1===c.rTa.length&&ya.a.J(41219847,826,50,"Customized bullet."));let u=-1;0<c.Gwb&&(u=c.Gwb,
ya.a.J(41219849,826,50,"Customized number list."));this.IK.eTc(a,b.propertySet);l&&b.propertySet.setValue(rb.a.Dj,l);Aa.a.Ta(f)||b.propertySet.setValue(rb.a.font,f);0<u&&b.propertySet.setValue(yb.a.autonumberBulletType,u)}else a.ra(rb.a.Dj,[]).length===f&&this.IK.eTc(a,b.propertySet)}}k7c(a){return this.pGb.k7c(a)}get h8c(){return this.pGb.h8c}j_(a,b){2===b.unit?(a.setValue(yb.a.EY,2),a.setValue(yb.a.Ay,b.value)):ya.a.J(36779851,826,50,"the un-support text spacing unit")}BNa(a,b){b.Rr.value&&(a.setValue(yb.a.gga,
b.Rr.value),a.setValue(yb.a.Cna,4));b.Pr.value&&(a.setValue(yb.a.fga,b.Pr.value),a.setValue(yb.a.Bna,4))}DNh(a,b){const c=(new dr.a(b.unit,b.value)).hO;1===b.specialIndentType?a.setValue(ib.a.Qn,c):2===b.specialIndentType?a.setValue(ib.a.Qn,-c):0===b.specialIndentType&&a.setValue(ib.a.Qn,0)}tMh(a,b){b=(new dr.a(b.unit,b.value)).hO;a.setValue(ib.a.Sm,b)}get GQh(){return!0}}Object(m.a)(PP,"PPTPasteStewardBridge",null,[1752]);class QP extends Er{constructor(a,b){super(a,b)}G$b(){return["PasteSlide"]}}
Object(m.a)(QP,"PasteSlideReactFloatie",Er,[]);class RP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.Vtg=!1;this.AS=[];this.Jnc=[];this.GBe=[];this.pEe=0;this.Jcd=!1;this.Wb=c;this.oa=f;this.wjb=l;this.hd=T;this.xd=a;this.CTk=b;this.jh=Ra;this.aQk=ja;this.Yb=eb;this.Fa=Bb;this.Ht=Ub;this.HJk=Xb;this.zJk=tc;this.ic=lc;this.lah=Ec;this.Lb=hd;this.did=yd;this.oh=pe;this.lZa=Tb.a.instance.ub("Common.IReactContextualUILauncher");this.eHb=Tb.a.instance.ub("Common.IExternalUICommandDefinitionMapping");
this.Pkd=(this.Zf=hd.getBooleanAppSetting("ReplaceThumbnailWithSlideSorter"))?document.getElementById("pptonline-sorter-view-id"):u.va}getName(){return"PasteFloat"}JZ(a){if(2===a.behavior)switch(a.actionId){case M.a.ow:case M.a.AEa:case M.a.ypa:case M.a.m7:case M.a.lla:case M.a.uR:case M.a.insertPicture:case M.a.ypa:case M.a.jma:case M.a.Yee:case M.a.XYc:case M.a.Ibb:case M.a.YYc:case M.a.Xee:case M.a.insertPicture:case M.a.s$b:case M.a.t$b:case M.a.Xrd:case M.a.mrd:this.$E(null,new Ka(!0))}}IZ(){}$vi(){this.Vtg||
(this.oa.AG(Object(R.a)(this,this.onSelectionChange,"onSelectionChange")),this.CTk.Cd(7).VE(Object(R.a)(this,this.ZC,"onChildTopologyChanged")),this.xd.eEa(Object(R.a)(this,this.TZ,"onThumbnailDrawCompleted")),Ae.a.addHandler(this.Pkd,"scroll",Object(R.a)(this,this.U2a,"scrollHandler")),Ae.a.addHandler(this.Zf?this.Pkd:this.oh.contentWindow.document.body,la.a.Vf,Object(R.a)(this,this.onKeyDown,"onKeyDown")),this.Zf||this.hd.xb(la.a.click,this.Pkd,Object(R.a)(this,this.xD,"clickHandler")),A.AFrameworkApplication.za.v9(Object(R.a)(this,
this.e3,"resizeHandler")),this.aQk.E9a(Object(R.a)(this,this.J2,"onSlidePresenceChanged")),this.jh.aMf(Object(R.a)(this,this.KVe,"onSlidesIdReturned")),this.HJk.ASa(Object(R.a)(this,this.Tpd,"onRevisionProcessedOnServerHandler")),this.zJk.Cyi(Object(R.a)(this,this.g3k,"onBlockingHandler")),this.did.a_d(Object(R.a)(this,this.E7k,"onOnlyKeyPressed")),this.Vtg=!0)}E7k(){if(vE.a.instance.keyCode===H.a.Pca&&this.lZa.hwa){const c=document.getElementById("PasteSlideControl-Floatie");if(c){var a=Sd.a.wi(c),
b=this.lah.va.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+SB.a.Pgf?ya.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Qe.a.P9a)||"",Qe.a.Xka===a&&c.click(),!this.Jcd&&this.Zf&&(Ae.a.addHandler(c,la.a.Vf,this.onKeyDown.bind(this)),this.Jcd=!0))}else ya.a.J(512497816,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===H.a.E_&&(this.Jcd&&(a=document.getElementById("PasteSlideControl-Floatie"),Ae.a.removeHandler(a,la.a.Vf,this.onKeyDown.bind(this)),
this.Jcd=!1),this.$E(null,new Ka(!0)))}g3k(a,b){1===b.block?this.$E(a,null):2===b.block&&this.$E(a,new Ka(!0))}Tpd(a,b){b&&(a=b.tE)&&a.ActionInformation.ActionId!==""+M.a.Bsc&&a.ActionInformation.ActionId!==""+M.a.bNb&&a.ActionInformation.ActionId!==""+M.a.ord&&this.Ht.W9c&&this.Ht.W9c<parseInt(a.ActionInformation.ActionTime)&&this.$E(null,new Ka(!0))}J2(a,b){this.ycg(b.slideId.sid,this.AS)&&(this.$E(null,new Ka(!0)),this.Ht.XRb=!1)}ycg(a,b){for(const c of b)if(c.sid===a)return!0;return!1}KVe(a,b){if(b&&
b.Z0a){if(this.GBe.length>=b.Z0a.length&&!this.lZa.hwa&&(this.setSelection(b.Z0a),this.AS.length===b.Z0a.length)){this.showFloatie({},new tk(1,A.AFrameworkApplication.isRtl));let c;(c=this.oa).ZDa.apply(c,this.AS)}this.Ht.bMa.length||(this.Ht.bMa=b.Z0a,Array.clear(this.AS),Array.clear(this.Jnc))}}onSelectionChange(a,b){if(this.Ht.XRb){for(a=0;a<b.LF.length;a++)if(Object(gb.a)(4,b.LF[a].context.node)){this.$E(null,new Ka(!0));return}!this.Fa.Je||this.Fa.Je.name!==yj.a.H4&&this.Fa.Je.name!==yj.a.USf&&
this.Fa.Je.name!==yj.a.RSf&&this.Fa.Je.name!==xc.a.bJ&&this.Fa.Je.name!==xc.a.iK&&this.Fa.Je.name!==xc.a.VX||this.$E(null,new Ka(!0))}}e3(){this.F1e()}U2a(){this.F1e()}xD(){this.F1e();return!0}F1e(){if(this.lZa.hwa){const a=new tk(1,A.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}TZ(a,b){a=this.Ht.bMa;this.GBe.push(b.gd);if(!this.lZa.hwa&&this.Ht.XRb&&a&&a.length>=this.Jnc.length&&b.succeeded)for(var c of a)if((b=this.Wb.Qk(new Vh.a(c)))&&!this.ycg(b.sid,this.Jnc)&&(this.Jnc.push(b),this.pEe++,
b=a.length,this.pEe===b)){this.oa.qUa();this.setSelection(a);var f=void 0;(f=this.oa).ZDa.apply(f,this.AS);if(c=this.DBj())this.Yb.Aa=c;this.pEe=0;c=!0;for(f=0;f<b;f++)(a=this.AS[f].vg(this.wjb))&&a.Hlb&&a.Hlb.r$()&&0<a.Hlb.r$().length&&(c=!1);c&&this.showFloatie({},new tk(1,A.AFrameworkApplication.isRtl));break}}DBj(){let a=this.AS.length;if(!a&&(this.setSelection(this.Ht.bMa),a=this.AS.length,!a))return ya.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.AS[0];
for(let c=1;c<a;c++)b.slideIndex>this.AS[c].slideIndex&&(b=this.AS[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.AS);for(const b of a)(a=this.Wb.Qk(new Vh.a(b)))?this.AS.push(a):ya.a.J(512497813,826,50,"Cannot find the slide")}}Nkg(){let a=this.AS.length;if(!a&&(this.setSelection(this.Ht.bMa),a=this.AS.length,!a))return ya.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;ya.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.AS[0];
for(let c=1;c<a;c++)b.slideIndex<this.AS[c].slideIndex&&(b=this.AS[c]);return b}showFloatie(a,b){b.location=this.fBb();if(b.location){const c=this.ic.Xc(this.Wb.Fn);if(!c||c&&a)ya.a.J(512497810,826,50,"ShowFloatie number"),this.Lb.getBooleanAppSetting("ReactSlidePasteFloatieEnabled")&&(new QP(this.lZa,this.eHb)).N$e(b.location,b.Gv),Array.clear(this.GBe)}}$E(a,b){this.lZa.hwa&&(this.lZa.$E(),b&&(this.Ht.XRb=!b.Dde,b.Dde&&this.Ht.ilb&&(a=this.Ht.ilb.HB,null!=a&&ya.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",
a.toString()))),this.Ht.XRb||(this.Ht.W9c=0)))}WWi(a){if(!this.Ht.o7b)return!0;a=a.YF;if(a.length!==this.Ht.o7b.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Ht.o7b[c])||!a[c]&&this.Ht.o7b[c])if(b++,b>this.Jnc.length)return!0;return!1}ZC(a,b){this.lZa.hwa&&(a=Object(gb.a)(688,b.node))&&this.WWi(a)&&this.$E(null,null)}fBb(){var a=this.Zf?this.PPj():this.QPj();if(!a)return null;a=Sd.a.wi(a);const b=a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Pkd.style.height;
var l=this.lah.va.style.height;l=parseInt(l.substr(0,l.length-2))+SB.a.Pgf;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.$E(null,new Ka(!1)),null;this.Ht.position=new Sys.UI.Point(b,c);return this.Ht.position}PPj(){const a=this.Nkg();if(!a)return ya.a.J(509089690,826,50,null),null;const b=document.querySelectorAll("#pptonline-sorter-view-id .grid-content-thumbnail-view-visible-class");return b&&b.length>a.slideIndex?b[a.slideIndex]:null}QPj(){var a=this.Nkg();if(!a)return ya.a.J(512497808,
826,50,null),null;a=a.vg(this.wjb);return a?a.wpb:(ya.a.J(512497807,826,50,null),null)}}Object(m.a)(RP,"PasteFloatieHelper",null,[1753,182]);class IG{constructor(){this.XRb=!1;this.W9c=0;this.ilb=null;this.bXe=md.a("DestinationThemeCCPFix")?-1:0;this.pib=[];this.position=this.o7b=null}get bMa(){return this.pib}set bMa(a){a?this.pib=a:Array.clear(this.pib)}}Object(m.a)(IG,"PasteFromFloatieArgs",null,[]);var qT=d(1078);class SP{iec(a){a=a.N9;return a===xc.a.Ag||a===xc.a.aG||a===xc.a.KB}}Object(m.a)(SP,
"PasteHandlerUtil",null,[1771]);class TP{constructor(a,b,c,f,l,u){this.wV=0;this.ia=a;this.C6=b;this.fKa=c;this.Dy=f;this.RHb=l;this.aLk=u}yR(a){if(!this.fKa.iec(this.C6.value))return!1;if(this.Dy.Iek(a)){a=Array.isArray(a.kY)?a.kY:null;if(this.W0j(a)&&!this.v1j(a))return!1;this.wV=1}else if(this.RHb&&(this.Dy.Gek(a)||this.Dy.Fek(a))){a=this.Dy.Pue(a.Cv);if(!this.aLk&&a)return da.ULS.sendTraceTag(508359428,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.wV=0,!1;this.wV=
2}else this.wV=0;return 0!==this.wV}paste(a){1===this.wV?this.ia.Ia(M.a.lrd,2,a):2===this.wV&&this.ia.Ia(M.a.Fth,2,a)}W0j(a){for(const b of a)if(!b.isConnected)return!0;return!1}v1j(a){for(const b of a)if(a=b.shapeNode,!a.$j&&!a.vd)return!0;return!1}}Object(m.a)(TP,"ShapePasteHandler",null,[1856]);class UP{constructor(a,b,c){this.wV=0;this.ia=a;this.Dy=b;this.ZZa=c}yR(a){this.Dy.bAg(a)?this.wV=1:this.ZZa&&this.Dy.Hek(a)?this.wV=2:this.wV=this.Dy.Kek(a)?3:0;return 0!==this.wV}paste(a){a.HB=null!=a.HB?
a.HB:!0;md.a("UseClipServiceForDestinationThemePaste")&&1===this.wV&&!a.HB&&a.Cv&&(this.wV=2);1===this.wV?this.ia.Ia(M.a.mrd,2,a):2===this.wV?(a.Cv?ya.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.HB):ya.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.Ia(M.a.ord,2,a)):3===this.wV&&this.ia.Ia(M.a.Hth,2,a)}}Object(m.a)(UP,"SlidePasteHandler",null,[1856]);class JG{constructor(a,b,c,f){this.dQg=[Df.a.wwg,
Df.a.kpb,Df.a.$Wh,Df.a.pCd];this.ia=a;this.Fa=b;this.fKa=c;this.Dy=f}yR(a){if(!this.fKa.iec(this.Fa)||JG.snk(a)||this.Dy.htk(a))return!1;a.yR=!this.$Zi(a.Rn);return a.yR}$Zi(a){for(let b=0;b<this.dQg.length;++b)if(0<a.getElementsByTagName(this.dQg[b]).length)return!0;return!1}paste(a){ya.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");this.ia.Ia(M.a.eXe,2,a)}static snk(a){if(!a||!a.Rn)return ya.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),
!0;a=Ac.b(a.Rn);return a&&a.length?!1:(ya.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(m.a)(JG,"TextPasteHandler",null,[1856]);var rT=d(909),sT=d(982),tT=d(450),pC=d(691);class VP{constructor(a,b){this.vza=a;this.pastedContent=b}}Object(m.a)(VP,"PasteContext",null,[]);class WP{constructor(a){this.EKe=0;this.MKb=null;this.GSk=a;this.mjb=this.GSk.fLb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.mjb.start()}P2b(a){if(a&&0<a.length){this.MKb||
(this.MKb={});const b=this.mjb.Qr;this.MKb[a]=b-this.EKe;this.EKe=b}}flush(a){a=void 0===a?null:a;let b="";a&&0<a.length&&(b=a+":");if(this.MKb){a=this.MKb;for(const c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&ya.a.J(508694610,826,50,b);this.reset()}reset(){this.EKe=0;this.MKb=null}}Object(m.a)(WP,"TimingLogger",null,[]);class Tq{constructor(){this.objectCount=0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=
null;this.skipUndo=!1;this.selectionSlide=null}static E5i(a){if(!a)return null;a=a.getData(Tq.pMi);return Tq.uxg(Tq.AAh(a))}static F5i(a){return a?Tq.uxg(Tq.AAh(a.pptSlide)):null}static uxg(a){if(!a||0===a.contentType)return ya.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/Tq.kMi:Number.MAX_VALUE;a.skipUndo=!1;ya.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",
a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static ntk(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static AAh(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(Tq.ntk(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){ya.a.J(541405765,826,15,"ReadPicklingData exception occured in parsing")}return null}}Tq.kMi=1048576;Tq.pMi="ppt/slides";Object(m.a)(Tq,
"PicklingClipboardObject",null,[]);var uT=d(693);class ph{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe){this.MJe=!1;this.w9g=0;this.c0a=null;this.goc=!1;this.DKe=null;this.GJe=!1;this.C6=a;this.oh=b;this.Cr=c;this.IIa=l;this.ka=f;this.Sl=u;this.Rs=I;this.qga=this.oh.contentWindow.document.body;this.Rs.addHandler(this.qga,la.a.paste,Object(R.a)(this,this.LTe,"onBrowserPaste"));this.fe=T;this.Fp=ja;this.vkc=Bb;this.kpa=new WP(ua);this.Ona=eb;this.Omc=null;this.Gfd=f.Xrk;this.nYg=
this.Fp.oP(7);this.Dy=Ra;this.wP=Ub;this.fS=Xb;this.Ga=lc;this.nc=tc;this.Fc=Ec;this.j2=hd;this.ia=yd;this.sa=pe;this.sLe=f.pptEditingImageMaxSizeInBytes;this.T_g=Math.floor(f.pptEditingImageMaxSizeInBytes*ph.JQf);this.Hkc=f.hAg;this.ZZa=f.xue;this.Aed=f.Kfk;this.Ebh=f.Mok&&this.Fp.m1;this.aKe=this.Afd=!1;this.RHb=f.wue;this.Skc=f.vBg&&this.Fp.gp;this.URk=f.ECj&&this.Fp.jg;this.uFk=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&this.Fp.$Ha;this.Ped=this.ka.Fik;this.uI=Pd}dispose(){this.oh&&this.Rs.removeHandler(this.qga,
la.a.paste,Object(R.a)(this,this.LTe,"onBrowserPaste"));this.kpa=this.oh=null}Eel(a){a===this.DKe.$b&&this.ia.Ia(M.a.Asc,2,this.DKe)}LTe(a){const b=this.Fc.yQ(2,0,"OnBrowserPaste");this.kpa.start();this.Afd=this.GJe=!1;if(Ml&&Ml.MB&&!Ml.MB.Jce){!this.Fp.WD||this.Fp.Fk||this.uFk?Df.a.z5b(this.oh):this.IIa.Z2a(this.oh);var c=this.fS.mfa(a);c=this.Dy.i8c()?Tq.E5i(c):null;var f=new qG;f.rae=a;f.Bwh=b;null!=this.c0a&&(this.Fc.Ei(ph.aTf,"menu",b),this.Fc.Ei(ph.$Sf,this.c0a?ph.uMi:ph.sMi,b));this.goc&&(this.Fc.Ei(ph.aTf,
"menu",b),this.Fc.Ei(ph.$Sf,ph.tMi,b));var l=this.fOe,u=this.gOe;this.goc||l||u||!c||!this.tth(c,null,b,M.a.nrd,f)?(this.sth(a,b),this.c0a=null,this.gOe=this.fOe=this.goc=!1):this.c0a=null}}sth(a,b){var c,f=this.fS.mfa(a);const l=this.fS.sag(f);this.Fc.K8e(l,b);if(!this.$cm(a,b)){var u=Object.assign(new dn.a(!0),{$b:b,HB:this.c0a});u.s9b=this.fOe;u.t9b=this.gOe;var I=null;a=md.a("SectionPaste")&&0<(null===(c=this.sa.x4)||void 0===c?void 0:c.YF.length);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",
!1)&&(document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")||document.activeElement.classList.contains("section-view-vertical-title-span-class")&&a)&&(ya.a.J(509669642,826,50,"Getting html from dom event for slide sorter"),(I=c=this.fS.pac(f))||(I=f.getData("text/plain")));this.URk&&(ya.a.J(512356507,826,50,"OnBrowserPaste::Getting html data from Clipboard"),f=this.fS.pac(f),c=this.fS.WLa(f),f?(this.vWf(c)&&(this.Cr.Vr[0].N$a=c.firstChild.className,u.kY=null),u.Rn=c):
ya.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.DKe=u;$c.a.nca(()=>{this.kTe(void 0,u,I)},0,this.ka.Vmk?0:2)}}vRi(a,b){let c=!1;Ml.MB.E$a(f=>{ya.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",f);null!=f&&f&&(c=this.CRi(a,b))});return c}CRi(a,b){const c=Date.now();let f=!1;Ml.MB.mfa(this.oh,a,l=>{ya.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-c));if(l){if(!a&&!b)l.html&&l.html.length<=
ph.jNi?-1!==l.html.indexOf(ph.FTf)&&(f=!0):l.pptSlide&&l.pptSlide.length&&(f=!0);else if(b)l.text&&0<l.text.length?f=!0:this.y1j(l.html)&&(f=!0);else if(l.img||l.isImageAvailable)f=!0;f&&(l=[],a?(l.push(appChrome.actions.updateControlEnabledDisabledState(ph.BNi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.ANi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.zNi,!1))):b?(l.push(appChrome.actions.updateControlEnabledDisabledState(ph.ENi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.DNi,
!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.CNi,!1))):(l.push(appChrome.actions.updateControlEnabledDisabledState(ph.KMi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.RNi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.MMi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.TNi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.LMi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(ph.SNi,!1))),
appChrome.api.dispatch(l));ya.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",f,Date.now()-c)}else ya.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});return f}y1j(a){if(!a||0==a.length||0<=a.indexOf(ph.PNi)||0<=a.indexOf(ph.FTf))return!1;a=this.fS.WLa(a);if(!a)return ya.a.J(509089756,826,15,"hasOnlyTextContent:: html element is null"),!1;const b=a.getElementsByTagName(Df.a.kpb).length;
return 0===a.getElementsByTagName(Df.a.C5).length&&0===b}tth(a,b,c,f,l){b||(b=Object.assign(new dn.a(!0),{$b:c,HB:this.c0a}));b.ON=a;this.Fc.Ei(ph.objectCount,a.objectCount.toString(),c);this.Fc.Ei(ph.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),c);this.Fc.Ei(ph.FNi,(b.ON.packageSize?null==b.ON.packageSize?0:b.ON.packageSize/ph.JQf:b.ON.dataSize).toString(),b.$b);return 0!==b.ON.errorInCopying?(ya.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",
b.ON.ccpid,b.ON.objectCount,b.ON.errorInCopying),this.tRh(b.ON.errorInCopying,f,l,b),!0):this.Dy.znk(b.ON.dataSize)?this.U$d(b):(ya.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.ON.ccpid,b.ON.dataSize,b.ON.objectCount),this.tRh(1,f,l,b),!0)}tRh(a,b,c,f){switch(a){case 1:this.Fc.Xg(!1,f.$b,27);this.uI.rca(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,
!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,ph.yQc,!1,null);break;default:this.Fc.Xg(!1,f.$b,28),this.uI.rca(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,ph.yQc,!1,null)}}nrd(a,b){ya.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.Fc.yQ(2,0,"PasteSlideAsImage");this.Fc.Ei("PasteSlideAsImage",b,c);this.kpa.start();this.Afd=this.GJe=!1;this.sth(a,c)}HSi(a){a=a.split("+");const b=this.nc.ug(this.Cr.Vr[0].gd).Fb;
return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}$cm(a,b){let c=!1;const f=this.goc,l=this.fS.tge(a.rawEvent,this.oh.contentWindow);if(l){const {ndc:u,Yjh:I}=this.fS.ZDd(l,this.ka.clipboardDataImageBlobNumberLimitaton,this.Hkc?50*ph.n8h:this.T_g);this.kpa.P2b("GetBlob");0<I&&(ya.a.J(512356498,826,50,"Blob is too large"),this.LAd(b),c=!0);u&&1===u.length&&($c.a.nca(()=>{this.hPi(u,b,f)},0),this.Ebh&&a.preventDefault(),c=!0)}else this.Gfd&&this.nYg&&(this.Omc=this.Ona.Cdm(a.rawEvent));c&&this.Fc.fD(5,
b);return c}hPi(a,b,c){if(c||a&&(this.fS.CFd(this.qga)||this.Ebh)){const f=a[0],l=$c.a.Kb;$c.a.Xk(Ii.a.xIi,f.size.toString());this.Hkc&&f.size>=this.T_g?(this.aKe&&ya.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),this.vkc.fJg(f,u=>{$c.a.gz(l,()=>{u&&this.g2l(u,f.size,b)||(this.Afd=!0,this.kTe(b));this.aKe=!1})}),this.aKe=!0):(new rT.a).q_h(a,u=>{$c.a.gz(l,()=>{this.bDj(u,b)})})}else this.kTe(b)}bDj(a,b){this.kpa.P2b("GetDataUrl");this.iem(a,b)||(ya.a.J(512356496,826,15,"Paste image data uri failed"),
this.paste(Object.assign(new dn.a(!0),{$b:b}),null,!1))}kTe(a,b,c){a=void 0===a?"":a;c=void 0===c?null:c;this.paste((void 0===b?null:b)||Object.assign(new dn.a(!0),{$b:a}),c,!1)}Nel(a,b){if(Ml.MB){ya.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",a.$b);var c=Date.now();Ml.MB.mfa(this.oh,a.pbb,f=>{a.pbb&&(f.html=null,f.pptSlide=null,f.text=null);this.pzk(f,c);if(f=Tq.F5i(f)){var l=new rG;l.pastedContent=b;l.vza=a;this.tth(f,a,a.$b,M.a.Gth,l)}else this.paste(a,b,!0)})}}pzk(a,
b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;ya.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-b,c,f,l,a)}else ya.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.wY)this.j2.show(5,-1),this.Fc.Xg(!1,a.$b,26);else if(a.Gce)this.Vme(a,b);else if(Ml.MB){var f=this.Fp.gV&&A.AFrameworkApplication.fa.getBooleanAppSetting("ElectronClipboardAccessFix");
this.ka.r6c&&!f||this.Skc?(a.ON=null,this.Dy.i8c()&&!c?this.Nel(a,b):(ya.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.Skc,this.ka.r6c),this.K5e(a,b))):(this.c0a=a.HB,this.goc=a.pbb,this.fOe=a.s9b,this.gOe=a.t9b,this.Dy.i8c()&&Ml.MB.qcm(this.oh,a.$b)?(this.Fc.Ei(ph.Wel,"true",a.$b),this.Fc.Xg(!0,a.$b)):(this.c0a=null,(()=>{let l=Ml.MB.paste(this.oh,this.C6.value,a.$b,!1);({content:b}=l);return l})().returnValue?this.Vme(a,
b):(Ml.MB.Vea(!1),c=Ml.MB.mz,null==c?(c=new uf.a(null,Object(R.a)(this,this.xlj,"fWaitForAsyncAPIResult"),Object.assign(new wG,{Bd:a.$b})),c.Fm("ClipboardPreProcessForAsyncAPI"),c.Lh()):null!=c&&c&&this.K5e(a,null))))}else this.Fc.Xg(!1,a.$b,1)}xlj(a,b){a=Ml.MB.mz;if(null==a)return!0;b=b.Bd.toString();a?this.K5e(Object.assign(new dn.a(!1),{$b:b}),null):this.Fc.Xg(!1,b,29);return!1}K5e(a,b){this.w9g=Date.now();this.MJe=!1;Ml.MB.prepareForPaste(a.pbb,c=>{this.Fc.Ei("isPasteFromAsyncApi",c.toString(),
a.$b);this.MJe=!0});b=new VP(a,b);(new uf.a(null,Object(R.a)(this,this.prepareForPaste,"prepareForPaste"),b)).Lh()}cXe(a,b){return a&&0<a.length?(a=Object.assign(new dn.a(!0),{$b:b,Uoe:a,GXc:!0}),this.U$d(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.MJe){let f;(()=>{let l=Ml.MB.paste(this.oh,this.C6.value,b.vza.$b,b.vza.pbb);({content:f}=l);return l})().returnValue&&f?this.Vme(b.vza,f):c=!0;a=!1}else Date.now()-this.w9g>this.ka.EWf&&(ya.a.J(512356491,826,50,null),a=!1,c=!0,Ml.MB.reset());
c&&this.Fc.Xg(!1,b.vza.$b,29);return a}get IXl(){return this.Fp.Gk&&this.ka.mfk}Vme(a,b){if(!a.Rn)if(ya.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.oEg&&this.IXl)if(this.lYl()){b=Df.a.DD();b.src=this.Omc;this.Omc=null;var c=Df.a.we();c.appendChild(b);a.Rn=c}else this.vWf(this.qga)&&(ya.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),this.Cr.Vr[0].N$a=this.qga.firstChild.className,a.kY=null),ya.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),
a.Rn=this.qga;else ya.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=Df.a.we(),sT.a.Myd(c,b,"PasteManager"),a.Rn=c;this.z2d(a);b=this.Dy.Uhk(a.Rn.firstChild);c=this.Dy.Xhk(a.Rn.firstChild);if(b||c)ya.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",b,c),this.Fc.Xg(!0,a.$b);else if(this.Qoj(a.Rn),b=a.Rn.innerHTML.startsWith("<img"),c=a.Rn.innerHTML.length,a.Gce&&
b&&(this.kpa.P2b("ConvertDataUrlToDOMNode"),this.kpa.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.Fp.nx,c,this.GJe))),!c&&this.Afd)this.LAd(a.$b);else{var f=0,l=!1;({h5d:f,Mce:l}=this.Ycm(a));1===f?(ya.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.Fc.Xg(!1,a.$b,25)):!a.kY&&!a.Cv&&c>this.sLe?(md.a("PasteManagerOacr73010Fix")?(this.oh.contentWindow.document.body.innerText="",a.Rn.innerText=""):(this.oh.contentWindow.document.body.innerHTML=
null,a.Rn.innerHTML=null),b?(ya.a.J(512356484,826,50,"Image too large"),this.LAd(a.$b)):(ya.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",c)),this.Fc.Xg(!1,a.$b,7))):(a.Cv?(ya.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.HB),this.Fc.Ei(wq.a.nq,a.Cv.nq,a.$b)):ya.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),this.U$d(a))}}z2d(a){a?a.Rn?a.Rn.firstChild?
a.Rn.firstChild.getAttribute||ya.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):ya.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):ya.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):ya.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}vWf(a){if(!(this.Aed&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&a.firstChild.getAttribute(wq.a.type)&&
a.firstChild.getAttribute(wq.a.hob)&&this.Cr.Vr))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(wq.a.sessionId).toString()===this.Cr.Vr[0].sessionId&&b.startsWith("CID")&&b!==this.Cr.Vr[0].N$a&&(Object(gc.a)(pC.a,this.Cr.Vr[0])&&"shape"===a.firstChild.getAttribute(wq.a.type).toString()&&this.FSi(a.firstChild.getAttribute(wq.a.hob).toString())||Object(gc.a)(dx.a,this.Cr.Vr[0])&&"slide"===a.firstChild.getAttribute(wq.a.type).toString()&&this.HSi(a.firstChild.getAttribute(wq.a.slideId).toString()))}FSi(a){a=
a.split(",");let b=0;if(a.length!==this.Cr.Vr.length)return!1;for(const c of a)for(const f of this.Cr.Vr)if(c===this.Ga.RBb(f.shapeNode).toString()){b++;break}return b===a.length}U$d(a){let b=!1;for(let c=0;c<this.Sl.length;c++)if(this.Sl[c].yR(a)){b=!0;this.Sl[c].paste(a);break}b||this.Fc.Xg(!1,a.$b,19);return b}g2l(a,b,c){if(a){const f=new uT.a("ShrinkImage",!0);a=this.vkc.wSh(a,b,this.sLe);f.stop();if(a)return this.kpa.P2b("LoadAndShrinkImage"),this.kpa.flush(String.format("Browser={0}, Length={1}",
this.Fp.nx,a.length)),$c.a.Xk(Ii.a.s7j,f.vca.toFixed(0)),$c.a.Xk(Ii.a.r7j,f.eWc.toFixed(0)),$c.a.Xk(Ii.a.t7j,a.length.toString()),this.cXe(a,c)}return!1}Qoj(a){this.Ped&&a&&(a=a.ownerDocument)&&(a=a.getElementById(wq.a.Owg))&&a.parentNode&&a.parentNode.removeChild(a)}Ycm(a){let b,c;b=0;c=!1;if(a&&a.Rn&&a.Rn.firstChild&&a.Rn.firstChild.getAttribute){var f=a.Rn.firstChild;const l=f.getAttribute(wq.a.nq),u=this.Cr.Vr;if(u&&0<u.length&&u[0]&&Sys.UI.DomElement.containsCssClass(f,u[0].N$a)){let I=!1;(this.ZZa&&
Object(gc.a)(dx.a,u[0])||this.RHb&&Object(gc.a)(pC.a,u[0]))&&this.zkk(u)&&(this.Pfk(l)?I=!0:(a.erh=!1,ya.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",a.$b)),ya.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.$b,I));if(I)ya.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",
a.$b),this.Cr.Vr=null;else if(ya.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.$b),a.kY=u,!md.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,h5d:b,Mce:c}}else ya.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.$b);f=this.Dy.mkj(f,a.$b);b=f.MTa;c=1===f.dataType;if(this.Dy.Zsk(f)&&void 0!==f&&null!==f&&32===f.IX)return a.Cv=f,ya.a.J(512356443,826,
50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.HB),{returnValue:!0,h5d:b,Mce:c};ya.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",f?f.toString():"(null)")}ya.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,h5d:b,Mce:c}}iem(a,b){let c=!1;if(this.Ona.QFg(a))if(a.length>=this.sLe)this.LAd(b),c=!0;else{if(a=this.Ona.mdm(a))this.kpa.P2b("ExtractDataUri"),
this.kpa.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.Fp.nx,a.length));c=this.cXe(a,b)}return c}zkk(a){for(const b of a)if(b.NDg)return!0;return!1}Pfk(a){if(this.wP.Nue)return ya.a.J(512356439,826,50,"Cannot predict copy result due to incompletion"),!1;ya.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.wP.SHg);return!!a&&a!==this.wP.SHg}LAd(a){this.Fc.Xg(!1,a,18);this.fe.iI(60,null)}lYl(){let a=!1;if(this.Omc&&0<this.Omc.length&&this.nYg){const b=this.qga.getElementsByTagName(Df.a.C5);
if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}ya.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}ph.n8h=1048576;ph.JQf=.75;ph.jNi=5E3;ph.Wel="PasteViaTriggeringEvent";ph.objectCount="ObjectCount";ph.isDataCompressed="IsDataCompressed";ph.FNi="PastedObjectDataSize";ph.$Sf="ActionName";ph.aTf="CcpMethod";ph.uMi="PasteKeepingSourceFormatting";ph.sMi="PasteKeepingDestinationTheme";ph.tMi="PasteAsImage";
ph.FTf='data-clipservice-type="slide"';ph.PNi='data-clipservice-type="shape"';ph.KMi="ContextMenu.PasteKeepingDestinationTheme";ph.RNi="ContextMenu.PasteKeepingSourceFormatting";ph.MMi="PasteKeepingDestinationTheme";ph.TNi="PasteKeepingSourceFormatting";ph.LMi="PasteKeepingDestinationThemeMLR";ph.SNi="PasteKeepingSourceFormattingMLR";ph.yQc=20;ph.BNi="PasteAsImageSLR";ph.ANi="PasteAsImageMLR";ph.zNi="ContextMenu.PasteAsImage";ph.ENi="PasteTextOnlySLR";ph.DNi="PasteTextOnlyMLR";ph.CNi="ContextMenu.PasteTextOnly";
Object(m.a)(ph,"PasteManager",null,[1770,106]);class XP{constructor(a,b){this.KOg=a;this.Ba=b}J5l(a,b,c,f,l){this.KOg.s_(this.Ba.fTi,a,b,c,this.Ba.gTi,this.Ba.hTi,this.Ba.iTi,f,l)}oQi(a){this.KOg.nQi(a)}}Object(m.a)(XP,"PastedDataUploader",null,[1766]);class KG{static create(a){const b=new KG;b.yFg=Xp.a(a,c=>c.isEditable);return b}}Object(m.a)(KG,"ShapeCopyPasteParams",null,[]);class YP{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf){if(!a)throw Error.argumentNull("selectionManager");
if(!b)throw Error.argumentNull("clipboardTarget");if(!c)throw Error.argumentNull("lazyFocusManager");if(!l)throw Error.argumentNull("internalClipBoard");if(!f)throw Error.argumentNull("activeSlideViewManager");if(!u)throw Error.argumentNull("ccpUtils");if(!I)throw Error.argumentNull("clipboardHelper");if(!T)throw Error.argumentNull("clipServiceManager");if(!ja)throw Error.argumentNull("actionManager");if(!ua)throw Error.argumentNull("htmlExportProcessor");if(!Ra)throw Error.argumentNull("htmlExportUtils");
if(!Ec)throw Error.argumentNull("shapeReader");if(!hd)throw Error.argumentNull("clipboardTelemetry");if(!Pd)throw Error.argumentNull("pptFileReaderHelper");if(!Se)throw Error.argumentNull("systemClipboard");if(!vf)throw Error.argumentNull("browserHelperManager");if(!yd)throw Error.argumentNull("deferredContentManager");this.oa=a;this.oh=b;this.C6=c;this.Cr=l;this.hkc=f;this.Ona=u;this.Dy=I;this.wP=T;this.ia=ja;this.WJk=ua;this.XJk=Ra;this.Jkc=eb;this.Okc=Bb;this.Bed=Ub;this.VKk=Xb;this.VIe=tc;this.xKa=
lc;this.Ga=Ec;this.Fc=hd;this.Hx=yd;this.bnc=Pd;this.fJe=pe;this.CKb=Se;this.IIa=vf}yR(a){const b=this.oa.rf();let c=!1;b&&0<b.length&&this.C6.value.N9===xc.a.Ag&&(a.dataType=2,c=a.Sfa?this.Akj(b):!this.oa.yXa());return c}Akj(a){let b=!0;for(const c of a){if(c.d9c&&!c.isLocal)return!0;c.VA||(b=!1)}return b}Aua(a){const b=this.oa.rf();if(!b||!b.length)return this.Cr.Vr=null,!1;let c,f=(()=>{let u=this.Ona.z3d(b);({contentType:c}=u);return u})().returnValue;this.Fc.fD(c,a.$b);let l;a.Sfa?({fob:f,returnValue:l}=
this.ndj(b,a,f),f="Cut:"+f):({fob:f,returnValue:l}=this.kdj(b,a,f),f="Copy:"+f);this.Hx.vne(b,"DoCutCopy")&&(ya.a.J(509210822,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.Sfa?this.Hx.tta("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.Hx.tta("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));ya.a.J(509210821,307,50,f);return l}ndj(a,b,c){let f=!0,l=[];for(var u of a)u.d9c&&l.push(u),u.VA||(f=!1);l=f?a:l;u=(()=>{let I=this.d6h(l,l,!0,!0,c,b.$b,f);({fob:c}=
I);return I})().returnValue;this.R_f(l,b.Sfa);this.Okc&&this.U_f(a);return{returnValue:32===this.ia.Ia(M.a.g3f,2,u),fob:c}}kdj(a,b,c){if(this.Jkc&&this.Dgk(this.kMj(),a))return{returnValue:!0,fob:c};const f=[];for(var l of a)l.d9c&&f.push(l);l=(()=>{let u=this.d6h(a,f,this.Jkc,!1,c,b.$b);({fob:c}=u);return u})().returnValue;l.Cv&&this.ia.Ia(M.a.T_f,2,l);this.R_f(a,b.Sfa);this.Okc&&this.U_f(a);return{returnValue:32===this.ia.nb(M.a.S_f,2),fob:c}}Dgk(a,b){if(!this.wP.Nue||a.length!==b.length)return!1;
for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}Qfk(a,b){if(!a.length)return!1;let c=!1;var f=!0;for(var l=0;l<a.length;l++){const u=a[l];if(u.isLocal)return!1;c||(c=u.vd);f&&(f=u.vd)}if(f)return!1;for(f=0;f<a.length;f++)if(l=a[f],l.$j&&!l.get_isSVGBlipFilled()&&!l.isGif){if(this.Bed||this.VKk&&!c&&b&&0!=l.get_shapeRotation())return!0}else if(!l.vd)return!0;return!1}vDj(a){const b=[];for(const c of a)c&&(a=new pC.a(c),a.sessionId=this.xKa,b.push(a));return b}kMj(){const a=
[];if(this.Cr.Vr&&this.Cr.Vr.length)for(const b of this.Cr.Vr){const c=Object(gb.a)(pC.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}d6h(a,b,c,f,l,u,I){I=void 0===I?!1:I;let T=new xz(null,u,null);this.Cr.Vr=this.vDj(a);c&&this.Qfk(b,f)?(this.Ona.ATh(b),c=this.wP.wTc(2,b.length,f,I),c.Dqc=KG.create(b),this.VIe&&this.Hx.vne(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.MTa=1,c.IX=8),this.Fc.Ei(mv.a.nq,c.nq,u),l+=String.format(", CcpId={0}",c.nq),this.Dy.vGd(this.oh,
this.Cr.Vr,c,this.xKa,this.pog(a),null,u),T=new xz(c,u,b)):(c&&(ya.a.J(509210820,307,50,"Clip service shapes cut/copy is throttled"),this.Fc.Ei(mv.a.FXf,"true",u)),this.Dy.vGd(this.oh,this.Cr.Vr,null,this.xKa,this.pog(a),null,u));return{returnValue:T,fob:l}}pog(a){const b=[];for(const c of a)Array.add(b,this.Ga.RBb(c));return b}R_f(a,b){for(const c of a)if(c&&c.$j&&(a=ek.c(c,this.hkc.Ic.Na))&&!a.hm&&(a=a.USa))if(md.a("FixForIpadImageCCP")){let f;this.fJe&&(f=this.vqg(a));f||(f=a.getAttribute(Dj.a.qdc));
f&&(a=f.toString())&&(a.startsWith("data:image/")?this.f0d(a,c):this.ikg(a,c,b))}else(a=this.fJe?this.vqg(a):a.getAttribute(Dj.a.qdc))&&(this.fJe?this.ikg(a,c,b):this.f0d(a.toString(),c))}ikg(a,b,c){try{fetch(a).then(f=>{f.blob().then(l=>{this.bnc.wAh(l,u=>{u=u.target.result;c&&Df.a.z5b(this.oh);this.f0d(u,b);this.IIa.Z2a(this.oh);this.CKb.copy(this.oh)})}).catch(l=>{ya.a.J(509207576,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in getting blob from response: {0}",l.toString())})}).catch(f=>
{ya.a.J(509207575,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob from url: {0}",f.toString())})}catch(f){ya.a.J(509210634,826,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob: {0}",f)}}vqg(a){if((a=a.querySelectorAll("image"))&&a.length&&(a=a[0].getAttribute("href")))try{const b=new URL(a);if("blob:"===b.protocol||"data:"===b.protocol)return a}catch(b){ya.a.J(509207881,826,10,"Exception {0} while converting to URL.",b)}return null}f0d(a,b){const c=
Df.a.DD();c.src=a;md.a("PersistAltOnCutPaste")&&(c.alt=b.R_d);b.get_shapeRotation()||this.Ona.QQl(c,b.zy,b.XD);c.className+=this.Cr.Vr[0].N$a;this.oh.contentWindow.document.body.appendChild(c)}U_f(a){(a=this.XJk.Csj(a,b=>!!b&&b.vd))&&0<a.length&&(a=this.WJk.Dsj(a))&&this.oh.contentWindow.document.body.appendChild(a)}}Object(m.a)(YP,"ShapeCutCopyHandler",null,[1855]);class Ns{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb){this.oh=b;this.C6=c;this.Cr=f;this.sa=l;this.ia=u;this.Dy=I;this.wP=T;this.Ced=
ja;this.VIe=ua;this.oa=a;this.xKa=Ra;this.Fc=eb;this.Hx=Bb}yR(a){var b=this.C6.value.N9;if(b=!!this.sa.Aa&&!!b&&b===yj.a.XE||b===xc.a.Ag&&!this.oa.Hd().length||b===xc.a.KB)a.dataType=1;return b}Aua(a){this.Fc.fD(19,a.$b);return this.f9i(a)}get Rb(){return this.oa}f9i(a){var b=this.Rb.Xe();if(!b||!b.length)return this.Cr.Vr=null,da.ULS.sendTraceTag(512497806,826,10,"Tried to copy slides but no slides were selected."),!1;var c=Ns.Ghg(b,!0);if(!c.length)return a=this.Jog(b).join(","),da.ULS.sendTraceTag(512497805,
826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=Ns.Ghg(b,!1),b=this.Jog(b).join(","),da.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=Ns.getSlides(this.Cr),l=Ns.f4i(this.xKa,c);this.Cr.Vr=Ns.eam(l);b=(b=c[0])?b.Fb:null;const u=this.Hx.V0j(c);this.Ced?this.v$e(f,l)?(ya.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.$b),this.Fc.Ei(mv.a.FXf,
"true",a.$b)):(f=this.wP.wTc(1,c.length,a.Sfa),c=new nG.a(f,a.$b,c),this.Fc.Ei(mv.a.nq,f.nq,a.$b),l=8,u?this.VIe&&(f.MTa=1,f.IX=8):a.Sfa||(l=this.ia.Ia(M.a.g7d,2,c),f.IX=l),this.Dy.vGd(this.oh,this.Cr.Vr,f,this.xKa,null,b,a.$b),!u&&a.Sfa&&(l=this.ia.Ia(M.a.h3f,2,c)),ya.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",a.Sfa,f.IX,f.nq),a.Sfa?this.Hx.tta("DeferredSlideCutStatus",f.IX.toString()):this.Hx.tta("DeferredSlideCopyStatus",f.IX.toString())):(this.Dy.vGd(this.oh,
this.Cr.Vr,null,this.xKa,null,b,a.$b),ya.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.$b));return!0}Jog(a){return Km.c(a,b=>b?b.Fb.toString():null)}v$e(a,b){if(!b||!b.length||Ns.pFi(b))return!0;if(this.wP.Nue){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!Ns.IFi(a[c],b[c]))return!1;return!0}return!1}static Ghg(a,b){const c=new La.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.Vr||!a.Vr.length)return b;
for(let c=0;c<a.Vr.length;c++)b.push(Object(gb.a)(dx.a,a.Vr[c]));return b}static IFi(a,b){return!a&&!b||!!a&&!a.gd&&!!b&&!b.gd||!!a&&!!a.gd&&!!b&&!!b.gd&&(!a.gd.id&&!b.gd.id||!!a.gd.id&&!!b.gd.id&&a.gd.id.equals(b.gd.id))}static pFi(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].gd&&!Vh.a.Cx(a[b].gd.Fb))return!1;return!0}static eam(a){const b=[];for(const c of a)b.push(c);return b}static f4i(a,b){const c=[];for(const f of b)c.push(Object.assign(new dx.a(f),{sessionId:a}));return c}}Object(m.a)(Ns,"SlideCopyHandler",
null,[1855]);class ZP{constructor(a,b,c,f){this.foa=this.MGe=!1;this.A1b=null;this.IIa=a;this.SSk=b;this.fjc=c;this.Fc=f}get $N(){this.A1b||(this.A1b=this.SSk.create());return this.A1b}get Jce(){return this.foa}Vea(a){this.$N.Vea(a)}E$a(a){this.$N.E$a(a)}get I7(){return this.$N.I7}get mz(){return this.$N.mz}prepareForPaste(a,b){this.foa=!0;this.$N.prepareForPaste(b,a,this.fjc.HEa.contentWindow.document)}mfa(a,b,c){this.foa=!0;this.$N.mfa(a,b,c);this.foa=!1}reset(){this.foa=!1}qcm(a,b){if(!this.qOa(a,
b))return!1;try{const c=a.contentWindow.document;let f=c.body;za.a.qw(f);this.$N.ebb(c,f);return!0}catch(c){ya.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.Df(xc.a.Ag);if(!this.qOa(a,c)&&(null==this.mz||null!=this.mz&&!this.mz))return{returnValue:!1,content:f};b=a.contentWindow.document;let l=b.body;this.foa=!0;za.a.qw(l);let u=!1;try{this.IIa.Z2a(a),l=this.$N.ebb(b,l),f=l.innerHTML,
u=!0}catch(I){this.fcc(c)}this.foa=!1;return{returnValue:u,content:f}}copy(a){a.contentWindow.focus();this.foa=!0;let b;try{this.$N.jXc(a.contentWindow.document),b=!0}catch(c){b=!1}this.foa=!1;return b?!0:!1}qOa(a,b){if(this.MGe)return!0;this.foa=!0;let c=!1;try{c=this.$N.qOa(a.contentWindow.document.body,()=>{za.a.qw(a.contentWindow.document.body)},()=>{this.IIa.Z2a(a)})}catch(f){}this.foa=!1;c?this.MGe=!0:E.a.Gk||null==this.mz||this.mz||this.fcc(b);return c}fcc(a){this.MGe=!1;ir.instance.kyb(null,
null);this.Fc.Xg(!1,a,29)}}Object(m.a)(ZP,"SystemClipboard",null,[1767]);class $P{constructor(a,b,c,f,l,u,I,T){this.yJe=!0;this.DSg=!1;l.pptOfflineModeEnabled&&a.SZd(Object(R.a)(this,this.lMb,"onNetworkHealthStateChanged"));this.Us=b;this.ia=c;this.j2=f;this.ka=l;this.ZP=u;this.iN=I;this.sa=T;this.LH=0;this.BJa=!1;this.jbd=0;this.j_g=new Date}get status(){return this.LH}lMb(a,b){this.yJe=b.xwe;this.DSg||this.eMh(this.yJe,"NetworkHealthStateChanged")}ieg(a){this.DSg=!a;this.yJe&&this.eMh(a,"PodSeamlessFailoverManager")}eMh(a,
b){a&&this.BJa&&(this.j2.Byc=!1,this.LH=1,this.ZP.CB());const c=!a,f=this.jbd+1;ln.a.instance.Jb(new ne.a(2,1,c?this.ka.switchToOfflineDelayInMs:this.ka.switchToOnlineDelayInMs,()=>{this.u3a(c,f)},90,"107"));this.jbd++;da.ULS.sendTraceTag(508913122,813,50,Xk.c({["Current state"]:this.BJa.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}u3a(a,b){this.jbd===b&&this.BJa!==a&&(this.j2.Byc=a,a&&3!==this.ia.mode||((this.BJa=a)?(this.LH=2,this.ZP.CB(),this.iN.pY(this.sa.presentation)&&
this.j2.show(0,-1)):(this.LH=0,this.j2.dismiss(),this.ZP.CB()),md.a("PersistSelectionInOfflineMode")?this.Us.Bnb(a,!0):this.Us.u3a(a),da.ULS.sendTraceTag(508913121,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.jbd,$c.a.Ef(this.j_g)),this.j_g=new Date))}}Object(m.a)($P,"PPTOfflineManager",null,[1786]);class aQ{Zyc(a,b,c){pG.a(a,b,c)}}Object(m.a)(aQ,"WarningDialogProxy",null,[1764]);var vT=d(282);class Fz extends zi.a{constructor(a,
b,c,f,l,u,I,T,ja){super();this.Ncd=!1;this.Aic=null;this.Mhb=0;this.lgd=this.Blc=this.igd=this.fgd=this.ijd=this.pgd=this.lcd=this.kld=this.s_a=this.QKe=this.kLe=this.u2=this.B6=null;this.dpa=a;this.Wlc=b;this.JK=c;this.SMk=f;this.nFk=l;this.EIk=ja;this.Fa=u;this.Ibh=T;this.Wb=I}dispose(){this.QKe=this.kLe=this.u2=this.B6=null;super.dispose()}qRh(a){this.p1h();this.Vj(a,Object(R.a)(this,this.zgj,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}aKh(a){if(a)for(let b=0;b<this.s_a.length;b++){const c=
document.getElementById(this.s_a[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.oQb(c);break}}}sv(){super.sv();Df.a.we().appendChild(this.h4i());const a=document.getElementById(this.ki("WACDialogPanel"));a&&a.removeAttribute(Qe.a.iea)}IB(){super.IB();var a=document.getElementById(this.ki("WACDialogPanel"));a.style.width=Df.a.Rc(532);a=parseInt(fg.a.Tu(a).top);this.B6.style.height=Df.a.Rc(Math.min(Math.max(0,lj.a.jQ-a-100),398));this.Wg=this.B6.parentNode.innerHTML}C9(){super.C9();this.kLe=
document.getElementById("MasterId");this.QKe=document.getElementById("LayoutId");this.Blc=Object(R.a)(this,this.ufb,"keyPressHandler");A.AFrameworkApplication.za.uH.Oud(la.a.Vf,window.document,this.Blc,null);this.fgd=Object(R.a)(this,this.Qvk,"layoutClickHandler");this.igd=Object(R.a)(this,this.Rvk,"layoutDoubleClickHandler");this.lgd=Object(R.a)(this,this.Tvk,"layoutOnFocus");for(let a=0;a<this.s_a.length;a++){const b=document.getElementById(this.s_a[a]);this.to.xb(la.a.click,b,this.fgd);this.to.xb(la.a.doubleClick,
b,this.igd);Ae.a.addHandler(b.firstChild,"focus",this.lgd)}}sua(){super.sua();this.Blc&&A.AFrameworkApplication.za.uH.Tgf(la.a.Vf,window.document,this.Blc);this.Blc=null;for(let a=0;a<this.s_a.length;a++){const b=document.getElementById(this.s_a[a]);this.to.Hb(la.a.click,b,this.fgd);this.to.Hb(la.a.doubleClick,b,this.igd);Ae.a.removeHandler(b.firstChild,"focus",this.lgd)}this.lgd=this.igd=this.fgd=null}h4i(){if(this.B6)return this.B6;this.B6=Df.a.we();this.B6.id="LayoutPickerDiv";this.B6.className=
"LayoutPicker";this.Mhb=0;this.s_a=[];var a=this.Wlc.length;if(!a||1===a&&!this.Wlc[0].InContent)return ya.a.J(509654401,822,10,"Legacy LayoutDialog:: Master not loaded."),this.B6;var b=0;let c=!1;for(var f=0;f<a;f++)this.Wlc[f].Id===this.SMk&&(b=f,c=!0);c&&this.IJf(this.Wlc[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.IJf(this.Wlc[f],1!==a);a=Df.a.MTc();a.id="MasterId";a.type="hidden";b=Df.a.MTc();b.id="LayoutId";b.type="hidden";this.B6.appendChild(a);this.B6.appendChild(b);return this.B6}IJf(a,b){a.InContent&&
this.JK.Ib(a.Id)&&(b&&this.B6.appendChild(this.B4i(a)),this.B6.appendChild(this.u2i(a)))}B4i(a){const b=Df.a.we();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}u2i(a){const b=a.Id;a=a.ContentMasters;if(!this.JK.Ib(b))return null;const c=this.JK.ga(b),f=Df.a.we();f.className="LayoutTableContainer";var l=Df.a.l2f();const u=Df.a.y7i();let I=null;f.appendChild(l);l.appendChild(u);l=this.dpa.width;let T=this.dpa.height,ja;l||(l=1);T||(T=1);ja=T/l*145;let ua=0;const Ra=a.length;for(var eb=
0;eb<Ra;eb++)!this.Ibh&&this.Wb.ueb(a[eb])||ua++;eb=1;for(let lc=0;lc<Ra;lc++){var Bb=a[lc];if(!this.Ibh&&this.Wb.ueb(Bb))continue;1===eb%3&&(I=Df.a.x8d(),u.appendChild(I));var Ub=Bb.Id.toString();const Ec=Bb.Name,hd=Df.a.cUc();hd.id="Layout"+this.Mhb;hd.setAttribute("LayoutIndex",this.Mhb);hd.setAttribute("MasterId",b);hd.setAttribute("LayoutId",Ub);hd.setAttribute(Qe.a.Ff,Qe.a.gR);Array.add(this.s_a,hd.id);var Xb=null;if(Ub=!!c.LayoutIcons&&c.LayoutIcons.length>lc&&!!c.LayoutIcons[lc].Icon){Xb=
-1;for(var tc=0;tc<c.LayoutIcons.length;tc++)if(c.LayoutIcons[tc].LayoutId===Bb.Id){Xb=tc;break}-1===Xb&&(Xb=lc);Xb=c.LayoutIcons[Xb].Icon;tc=new vT.a(Xb.Clip.Bounds.Left,Xb.Clip.Bounds.Top,145,ja);Bb=Df.a.DD();Bb.src=Tb.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(Gg.a.ozb,Xb.ImgId,"LayoutPicker");Bb.title=Ec;Bb.style.clip=this.Hul(tc);Bb.style.left=Df.a.Rc(-tc.s5a);Bb.style.overflow=Hf.a.Vt;Bb.style.position=Hf.a.Iia;Bb.style.top=Df.a.Rc(-tc.t5a);Bb.style.zIndex="0";l<T&&(Bb.style.height=
Df.a.Rc(ja));Bb.setAttribute(Qe.a.Ff,Qe.a.PSa);Xb=document.createElement("span");Xb.style.width=Df.a.Rc(145);Xb.style.height=Df.a.Rc(ja);Xb.setAttribute("Unselectable","on");Xb.style.zIndex="0";Xb.style.overflow=Hf.a.Vt;Xb.style.display=Hf.a.B6l;Xb.style.position=Hf.a.Dzc;Xb.appendChild(Bb);Xb.setAttribute(Qe.a.JJ,Qe.a.cC)}Bb=Df.a.we();Bb.id="title_Layout"+this.Mhb;Bb.className="LayoutTitle LayoutTitleHighContrast";Bb.innerText=Ec;tc=Df.a.zla();tc.setAttribute("tabindex","0");tc.setAttribute("onclick",
"return false;");tc.setAttribute("unselectable","on");tc.setAttribute(Qe.a.Rp,Ec);tc.setAttribute(Qe.a.Ff,Qe.a.PSa);tc.setAttribute(Qe.a.i1d,eb);tc.setAttribute(Qe.a.j1d,ua);Ub&&tc.appendChild(Xb);tc.appendChild(Bb);I.appendChild(hd);hd.appendChild(tc);this.Mhb++;eb++}Ra%3&&(this.Mhb+=3-Ra%3);return f}Hul(a){let b;b="rect( "+(Df.a.Rc(a.t5a)+", ");b+=Df.a.Rc(a.K9h)+", ";b+=Df.a.Rc(a.L9h)+", ";return b+=Df.a.Rc(a.s5a)+")"}zgj(a,b){this.Ncd&&($c.a.Cxb(this.Aic),this.Ncd=!1,this.Aic=null);1===a&&this.nFk(b.MasterId,
b.LayoutId)}Tvk(a){a=a.target.parentNode;this.u2&&a.id===this.u2.id||this.oQb(a)}ufb(a){a=a.hc;var b=this.hGj(a);if(b===H.a.pVb)return!0;if(b===H.a.Mp)return(a=this.Fa.gm())&&"WACDialogCancelButton"!==a.jk.L0.id?(this.ysa(1),this.hide(),!0):!1;a.preventDefault();if(!this.u2)return a=document.getElementById("Layout0"),this.oQb(a),!0;a=parseInt(this.u2.getAttribute("LayoutIndex"));b=this.fEj(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.oQb(f);break}}return!0}hGj(a){let b=
H.a.pVb;switch(a.keyCode){case H.a.I3:b=H.a.I3;break;case H.a.H3:b=H.a.H3;break;case H.a.F_:b=H.a.F_;break;case H.a.LW:b=H.a.LW;break;case H.a.Mp:b=H.a.Mp}this.EIk&&(b===H.a.LW?b=H.a.F_:b===H.a.F_&&(b=H.a.LW));return b}fEj(a){let b=[0];switch(a){case H.a.I3:if(!this.kld)for(this.kld=Array(3),a=0;3>a;a++)this.kld[a]=-3-a;b=this.kld;break;case H.a.F_:if(!this.pgd)for(this.pgd=Array(3),a=0;3>a;a++)this.pgd[a]=-1-a;b=this.pgd;break;case H.a.LW:if(!this.ijd)for(this.ijd=Array(3),a=0;3>a;a++)this.ijd[a]=
a+1;b=this.ijd;break;case H.a.H3:if(!this.lcd)for(this.lcd=Array(3),a=0;3>a;a++)this.lcd[a]=3-a;b=this.lcd}return b}Qvk(a){this.oQb(a.hC);return!0}Rvk(a){a=a.hC;a!==this.u2&&this.oQb(a);this.ysa(1);this.hide();return!0}oQb(a){this.p1h();this.u2=a;const b=this.Fa.gm();b?b.jk.bG(a.firstChild):ya.a.J(509654368,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");Sys.UI.DomElement.addCssClass(this.u2,"Selected");this.Chm();this.Ncd=!0;this.Aic||(this.Aic=$c.a.nca(Object(R.a)(this,this.CLl,
"selectElement_Finish"),0))}CLl(){this.u2&&this.XKl(this.u2);this.Ncd=!1;this.Aic=null}p1h(){this.u2&&(Sys.UI.DomElement.removeCssClass(this.u2,"Selected"),this.u2=null)}XKl(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=Df.a.rkh(b,a)._y,u=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+c,l=u+l,l>a&&(b.scrollTop=c+(l-a)))}}Chm(){this.kLe.value=this.u2.getAttribute("MasterId");this.QKe.value=this.u2.getAttribute("LayoutId")}}
Object(m.a)(Fz,"LayoutPicker",zi.a,[]);class bQ extends Fz{constructor(a,b,c,f,l,u,I,T,ja){super(a,b,c,f,l,u,I,T,ja)}dispose(){super.dispose()}NAd(a){this.qRh(ResourceStrings.l_NewSlideTitle);this.aKh(a)}sv(){this.Te(1,ResourceStrings.l_AddSlide);super.sv()}}Object(m.a)(bQ,"AddSlideDialog",Fz,[1862]);class cQ extends Fz{constructor(a,b,c,f,l,u,I,T,ja){super(a,b,c,f,l,u,I,T,ja)}dispose(){super.dispose()}NAd(a){this.qRh(ResourceStrings.L_SlideLayoutDialog);this.aKh(a)}sv(){this.Te(1,ResourceStrings.L_ChangeLayout);
super.sv()}}Object(m.a)(cQ,"ChangeLayoutDialog",Fz,[1862]);class dQ{constructor(a,b){this.Fa=a;this.Wb=b}D7d(a,b,c,f,l,u,I,T){switch(a){case 1:return new bQ(b,c,f,l,u,this.Fa,this.Wb,I,T);case 0:return new cQ(b,c,f,l,u,this.Fa,this.Wb,I,T);default:return null}}}Object(m.a)(dQ,"DialogFactory",null,[1854]);class eQ{constructor(a,b,c,f,l){this.hpa=null;this.ia=a;this.vN=b;this.Qt=c;this.EP=f;this.wq=l;this.vN.B4(Object(R.a)(this,this.Arc,"onShapeDisconneted"));this.Qt.p_d(Object(R.a)(this,this.Frc,"onSlideBackgroundClicked"));
this.Qt.zAi(Object(R.a)(this,this.Hph,"onShapeViewElementBackgroundClicked"))}vuh(a){if(!a)throw Error.argumentNull("template");this.hpa=a;ya.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.EP.t1=!0}oEi(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.hpa||a.id.equals(this.hpa.id)?b=!0:a.get_isSVGBlipFilled()&&(this.hpa.Xu||!this.hpa.Yfa&&!this.hpa.get_isSVGBlipFilled())&&(b=!0);b?this.jTa():(ya.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",
this.hpa.get_shapeId(),a.get_shapeId()),this.ia.Ia(M.a.$ee,2,new oC(this.hpa,a)))}jTa(){this.isActive&&(ya.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.hpa=null,this.EP.t1=!1)}dispose(){this.vN.Wza(Object(R.a)(this,this.Arc,"onShapeDisconneted"));this.Qt.AEh(Object(R.a)(this,this.Frc,"onSlideBackgroundClicked"));this.Qt.uCl(Object(R.a)(this,this.Hph,"onShapeViewElementBackgroundClicked"))}Arc(a,b){b.node===this.hpa&&this.jTa()}Frc(){const a=this.isActive;this.jTa();this.wq&&a&&this.ia.nb(G.a.kma,
2)}Hph(a,b){this.isActive&&this.oEi(b.Vx.shapeNode)}get isActive(){return this.EP.t1}get y9l(){return this.hpa}}Object(m.a)(eQ,"FormatPainter",null,[1783,106]);var wT=d(1211),qC;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(qC||(qC={}));Object(m.b)("OfflineModalCalloutTrigger",qC);
class fQ{constructor(a){this.hp=null;this.Byc=!1;this.Db=a;a=document.createElementNS(Dj.a.Ucf,"polyline");a.setAttribute(Dj.a.Muh,"1,1 15,14 30,1");a.setAttribute(Dj.a.LBd,"rgb(234,234,234)");a.setAttribute(Dj.a.gcf,"2");a.setAttribute(Dj.a.ude,"white");a.setAttribute(Dj.a.fcf,"bevel");this.lCe=new Wj.a;this.lCe.Mh(32,16);this.lCe.va.appendChild(a);this.uic=document.createElement("p");this.uic.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.uic.style.width="258px";this.uic.style.color=
"black";this.uic.style.fontSize="14px"}dismiss(){this.hp&&(this.hp.dismiss(),this.hp=null)}show(a,b){da.ULS.sendTraceTag(512497097,813,50,"OfflineModalCallout.Show is triggered by {0}",qC[a]);if(this.Byc){if(this.hp){if(this.hp.MM)return;this.hp.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");md.a("OfflineModalCalloutCrashFix")&&!c?da.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=Sd.a.wi(c),this.hp=wT.a.X7d(a,
c,this.Db.BBd,2),this.hp.B0=4,0<b&&(this.hp.Def=b),this.hp.Is=!0,this.hp.content=this.uic,this.hp.q5d=()=>{da.ULS.sendTraceTag(512497095,813,50,"The user clicks the button to close the callout.");this.hp&&(this.hp.dispose(),this.hp=null)},this.hp.Zpd=()=>{if(this.hp&&this.hp.content){this.hp.content.parentNode.style.width="258px";this.hp.ZK.style.borderColor="rgb(234,234,234)";for(var f=this.hp.twb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.lCe.va);this.hp.E8e()}else da.ULS.sendTraceTag(512497094,
813,50,"callout content is empty in OnShowCallback")},this.hp.show(),da.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}Object(m.a)(fQ,"OfflineModalCallout",null,[1785]);var gQ=d(264),rC=d(200);class hQ{constructor(a,b,c){this.zh=this.HP=this.Bb=null;this.Mb=!0;this.ta=a;this.Vgb=b;this.RLe=a.Szb?a.lga:null;this.Pga=c}dispose(){this.Pga&&this.HP&&($removeHandler(this.HP.va,"error",Object(R.a)(this,this.rnh,"onImageLoadError")),this.HP.dispose(),this.HP=null);this.Bb&&this.Bb.mr();
this.HP=this.zh=this.Bb=null;this.RLe&&(this.Vgb.revokeObjectURL(this.RLe),this.RLe=null)}Cn(a){this.Bb=new XB.a;this.Bb.sAa(sj.a.scf);a.appendChild(this.Bb.viewport);this.HP=new gQ.a;this.HP.xk(0);this.Bb.appendChild(this.HP);this.HP.Uv(this.ta.lga);$addHandler(this.HP.va,"error",Object(R.a)(this,this.rnh,"onImageLoadError"));a=this.ta.Ko;const b=ej.a.AYh(a);this.HP.setPosition(a.oc,a.pc);this.HP.Mh(b.width,b.height);this.HP.ee(!0);this.zh=new Fm.a;this.zh.xk(1);this.zh.setVisibility(!1);this.zh.va.setAttribute("class",
"ShapeMoveHandle");this.zh.ee(!0);this.zh.yu(a.points);this.zh.lca("cursor: move");this.Bb.appendChild(this.zh);this.Bb.Gm()}rnh(){ya.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ta.Xeb)}setPosition(a,b){this.Bb.setPosition(a,b)}wE(){}Pj(a){this.Bb.Pj(a)}Kr(a){this.Bb.oH(a,rC.a.nea)}Tv(a){this.Bb.oH(a,rC.a.Swb)}setZIndex(a){this.Bb.xE(a)}Xz(){}jF(){return null}bD(){return[]}draw(){}TF(){}Jq(){return this.Mb?this.Bb.Jq():null}get visible(){return this.Mb}set visible(a){this.Mb=
a;this.Bb.ee(this.Mb)}get Zq(){return this.zh}get Ee(){return this.Bb}aP(a){return a.Ec===this.Zq.va}Ry(){}setSelection(){}}Object(m.a)(hQ,"LocalImageView",null,[1861,805,806,106]);class iQ{constructor(a,b){this.Vgb=a;this.iKk=b}create(a){return new hQ(a,this.Vgb,this.iKk)}}Object(m.a)(iQ,"Factory",null,[1779]);class jQ{constructor(a){this.Mb=!0;this.bZa=this.LZa=this.Bb=null;this.Nd=a}dispose(){this.Bb&&this.Bb.mr();this.LZa=this.bZa=this.Bb=null;this.Mb=!1}Cn(a){this.Bb=new XB.a;this.Bb.sAa(sj.a.scf);
a.appendChild(this.Bb.viewport);this.bZa=new Fm.a;this.Bb.appendChild(this.bZa);this.bZa.UF(Dj.a.none);a=this.Nd.shapeNode.Ko;this.bZa.Vv(jf.a.m3);this.bZa.vs(jf.a.WF);this.bZa.Tqa("2,2");this.bZa.yu(a.points);this.LZa=new gQ.a;this.LZa.xk(0);this.Bb.appendChild(this.LZa);this.LZa.Uv(Kq.a.GO(jf.a.iqa));a=ej.a.AYh(a);const b=jf.a.XNb,c=jf.a.Lsd;this.LZa.setPosition(a.width/2-b/2,a.height/2-c/2);this.LZa.Mh(b,c);this.LZa.ee(!0);this.Bb.Gm()}setPosition(a,b){this.Bb.setPosition(a,b)}wE(){}Pj(){}Kr(a){this.Bb.oH(a,
rC.a.nea)}Tv(a){this.Bb.oH(a,rC.a.Swb)}setZIndex(a){this.Bb.xE(a)}Xz(){}jF(){return null}bD(){return[]}draw(){}TF(){}Jq(){return this.Mb?this.Bb.Jq():null}get visible(){return this.Mb}set visible(a){this.Mb=a;this.Bb.ee(this.Mb)}get Ee(){return this.Bb}aP(){return!1}Ry(){}setSelection(){}}Object(m.a)(jQ,"ShapeProgressIndicatorView",null,[1860,805,806,106]);class kQ{create(a){return new jQ(a)}}Object(m.a)(kQ,"Factory",null,[1780]);var Os=d(331);class LG{constructor(){this.bA=null;this.Pta=this.BO=
this.Qta=0;this.startTime=this.Ksd=this.nr=this.$I=this.ND=this.B9b=null}vqc(){return this.BO<this.bA.jK?Object.assign(new LG,{bA:this.bA,Qta:this.BO,BO:this.BO+Math.min(this.Pta,this.bA.jK-this.BO),Pta:this.Pta,B9b:this.B9b,ND:this.ND,$I:this.$I,nr:this.nr,Ksd:this.Ksd}):null}}Object(m.a)(LG,"ChunkUploadingContext",null,[]);var Ps=d(513);class kx{constructor(a,b,c,f){this.Jf=this.SK=this.QI=null;this.Alc=b;this.zic=c;this.xib=f;this.zb=a}get Y$(){return!!this.QI}s_(a,b,c,f,l,u,I,T,ja){T=void 0===
T?null:T;ja=void 0===ja?null:ja;this.Y$?I(new Ps.a(Object.assign(new Os.a,{Code:59}))):(ja&&ja.register(Object(R.a)(this,this.abort,"abort")),0<l&&(this.SK=Object.assign(new ne.a(2,1,l,Object(R.a)(this,this.HN,"onTimeout"),90,"85"),{gu:I}),this.zb.Jb(this.SK)),(this.QI=Object.assign(new LG,{bA:a,B9b:c,Qta:0,BO:0,Pta:b,ND:f,$I:u,nr:I,Ksd:T,startTime:new Date}).vqc())?this.EUb(this.QI):I(new Ps.a(Object.assign(new Os.a,{Code:92}))))}EUb(a){this.Alc();if(this.zic()||!this.Y$)this.reset();else{this.L1a();
var b=a.bA,c=a.ND,f=a.Qta,l=a.BO,u=a.Pta,I=!f&&l===b.jK,T=new FormData;T.append("Type","2");T.append("FileName",a.bA.fileName);c&&T.append("ImageToken",c);T.append("Content-Range","bytes "+f+"-"+(l-1)+"/"+b.jK);ya.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",f,l,u,b.jK);this.Jf.onreadystatechange=()=>{this.Jf&&4===this.Jf.readyState&&this.TTe(a,this.Jf.status)};b=I?a.B9b:a.B9b.slice(f,l);T.append("chunk",b);this.Jf.send(T)}}TTe(a,
b){let c=Object.assign(new Os.a,{Code:94});if(200===b){this.xib.IBc(this.Jf.getResponseHeader(kx.R3d));b=a.Ksd;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.Jf.responseText)}catch(l){ya.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&f.Result){const l=f.Result;a.ND=l.ItemId;const u=a.vqc();a.Qta===l.XOffset&&l.ItemId?u?(b&&b.t8k(100*a.BO/a.bA.jK,!1),c=null,this.EUb(u)):(b&&b.t8k(100,!0),c=null,ya.a.J(34420812,
818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.$I(new Em.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else ya.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.ND||"");c&&(this.reset(),a.nr(new Ps.a(c)))}L1a(){this.Jf=new XMLHttpRequest;this.Jf.open("POST",this.xib.$cb(),!0);A.AFrameworkApplication.accessToken&&(this.Jf.setRequestHeader("X-AccessToken",A.AFrameworkApplication.accessToken),
this.Jf.setRequestHeader("X-AccessTokenTtl",A.AFrameworkApplication.q9.toString()));A.AFrameworkApplication.gC&&this.Jf.setRequestHeader(kx.cQi,A.AFrameworkApplication.gC)}HN(a){ya.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.SK=null;this.abort();(a=a.gu)&&a(new Ps.a(Object.assign(new Os.a,{Code:299})))}abort(){if(this.Y$){ya.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.Jf;this.reset();a&&a.abort()}}reset(){this.SK&&(this.zb.Vg(this.SK),
this.SK=null);this.QI=this.Jf=null}}kx.cQi="X-Key";kx.R3d="X-NewKey";Object(m.a)(kx,"ChunkedPictureUploader",null,[1763]);class lQ{constructor(a,b,c,f){this.zb=a;this.NIk=b;this.vkc=c;this.rLe=f.pptEditingImageMaxSizeInBytes;this.b0g=Math.floor(.75*this.rLe);this.XMk=52428800;this.xYg=f.hAg&&f.que;this.Gkc=f.que;this.Qed=f.Gik;this.qlc=f.EEg}get Apc(){return this.xYg?this.XMk:this.b0g}get xyc(){return this.Gkc}get dAd(){return this.Qed}s6b(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.b0g?
this.convertToBase64AndCallback(a,b):this.xYg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.NIk.create();this.Gkc?c.Ddm(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.rLe&&(l=null);this.qlc?b(l):this.zb.Jb(new ne.a(2,1,0,()=>{b(l)},90,"83"))}):c.q_h(a,b)}shrinkToBase64AndCallback(a,b){this.vkc.fJg(a,c=>{const f=this.vkc.wSh(c,a.size,this.rLe);this.qlc?b(f):this.zb.Jb(new ne.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(m.a)(lQ,"PPTProcessImageStrategy",
null,[1573]);var xT=d(1175);class sC{static get Wg(){return zi.a.oC(sC.Hq,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}sC.Hq="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(m.a)(sC,"InsertImageDialogHtml",
null,[]);class mQ extends zi.a{constructor(a){super();this.wm=null;this.ix=[];this.pB=a;this.JGf=!1;this.SZa=A.AFrameworkApplication.fa.getBooleanAppSetting("InsertLocalPictureMultiSelectionEnabled")}G0l(a){this.Wg=sC.Wg;this.Te(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(R.a)(this,this.pbk,"insertImageDialogHandler"));if(this.wm=document.getElementById("fileInput"))this.wm.setAttribute("accept","image/*"),this.SZa&&a&&this.wm.setAttribute("multiple","multiple");
a=[];this.wm&&(Ae.a.addHandler(this.wm,la.a.Vf,Object(R.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.wm));var b=this.PZc(1);b&&a.push(b);(b=this.PZc(0))&&a.push(b);this.ix=a;this.ajm()}validate(){const a=this.pB.QFd(this.wm.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.pB.UAj(a);b.style.display="inline-block";return!1}return!0}dispose(){this.wm&&Ae.a.removeHandler(this.wm,la.a.Vf,Object(R.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}pbk(a){1===a&&this.pB.c8k(this.wm);
this.wm=null}ajm(){if(0<this.ix.length){const a=new xT.a(this.ix),b=F.FocusManager.instance().gm();b&&(this.ix[0].focus(),b.jk=a,b.IY=!0)}}onKeyDown(a){4!==F.FocusManager.instance().lxh(a)&&a.preventDefault()}}Object(m.a)(mQ,"InsertImageDialog",zi.a,[]);class MG{constructor(){this.t4c=this.file=this.fileName=null;this.$ag=!1;this.VLb=null;this.jK=this.imageHeight=this.imageWidth=0;this.Hce=!1}}Object(m.a)(MG,"ImageType",null,[]);class nQ{constructor(a,b,c,f,l,u,I,T,ja,ua){this.FUb=0;this.ccd=this.Vmc=
this.z_g=this.mob=!1;this.gN=[];this.QZa="image/*";this.ia=a;this.kib=b?b.va:null;this.$Ka=null;this.fe=c;this.bnc=f;this.WPe=l;this.Ehd=T.pptEditingUploadedImageMaxSizeInBytes;this.Vgb=u;this.LGk=I;this.AMe=T.pptEditingUploadLargeImageMaxSizeInBytes;this.vOk=T.pptEditingUploadLargeImageChunkSizeInBytes;this.wOk=1E3*T.pptEditingUploadLargeImageTimeoutInSeconds;if(this.Gjb=T.Yfl)this.QZa=this.Gjb.join(",");this.SZa=T.ubk;this.xib=ja;this.Pe=ua;this.ljc=T.Zbj}get D$c(){return this.z_g}set D$c(a){this.z_g=
a;this.Vmc=0<this.AMe&&this.Vgb.smk&&a}get Xfl(){return this.Vmc}c8k(a){this.CJf(a);this.kib&&this.WPe.D8d(this.kib,a,Object(R.a)(this,this.bWe,"onUploadFrameInitialized"),Object(R.a)(this,this.Jje,"getPictureUploadEndPoint"),this.QZa,!1,!1)}LUf(){return!(void 0===window.self.FormData||null===window.self.FormData)}Oxh(a){if(this.kib){if(this.ljc){if(this.LUf()){this.WPe.D8d(this.kib,null,Object(R.a)(this,this.bWe,"onUploadFrameInitialized"),Object(R.a)(this,this.Jje,"getPictureUploadEndPoint"),this.QZa,
a&&this.SZa,!0);this.ccd=!1;return}ya.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}E.a.Gk||E.a.KEb||E.a.GDb&&72>E.a.GRc?(this.WPe.D8d(this.kib,null,Object(R.a)(this,this.bWe,"onUploadFrameInitialized"),Object(R.a)(this,this.Jje,"getPictureUploadEndPoint"),this.QZa,!1,!1),this.ccd=!1):((new mQ(this)).G0l(a),this.ccd=!0)}else ya.a.J(18643099,822,15,"PictureUploader initialize failed.")}sej(a){this.zFd&&(Array.addRange(this.gN,a),this.e4h())}get zFd(){return 1>
this.gN.length}e4h(){if(!this.zFd){const a=new MG,b=this.gN[0];b?(a.fileName=this.Bce(b.name),a.Hce=!0,this.yAh(a)):(ya.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.gN.length.toString()),Array.clear(this.gN))}}Jje(){return this.xib.$cb()}bWe(a){this.$Ka=a;if(!this.ccd){if(this.ljc&&this.LUf()){a.eae(Object(R.a)(this,this.s7k,"onMultipleFileChosen"));return}if(E.a.WD){a.eae(Object(R.a)(this,this.d$k,"onSingleFileChosen"));return}a=a.eae(null);if(!a)return;
this.gN.push(a.files[0])}this.J_d()}CJf(a){if(a)if(this.SZa)for(const b of a.files)this.gN.push(b);else this.gN.push(a.files[0])}s7k(a){this.CJf(a);this.J_d()}Bdj(a){a=this.QFd(a.fileName);return 0!==a?(this.$Ka&&this.$Ka.PUc(),2!==a&&3!==a||this.zu(90,a),!1):!0}G9b(a){let b=!0;this.D$c&&a.t4c&&!this.Fmm(a)&&(this.$Ka&&(this.$Ka.wgc=!1),b=!1);!a.VLb||!this.mob&&b||(this.Vgb.revokeObjectURL(a.VLb),a.VLb=null);if(b){switch(this.FUb){case 0:this.ia.Ia(M.a.iYc,2,a);break;case 1:this.ia.Ia(M.a.Xee,2,a)}this.e4h()}else Array.clear(this.gN)}Bce(a){if(a){let b=
-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}Fmm(a){if(a.jK>this.Ehd){if(this.Vmc&&a.jK<this.AMe)return ya.a.J(34420823,822,50,"Upload large image: {0}",a.jK),a.Hce=!0;ya.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.jK/1024/1024,this.Ehd/1024/1024);this.zu(87,4);return!1}return!0}pag(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+1)}Mbf(a,b,c,f){f=void 0===f?null:f;if(a.Hce||this.SZa&&
1<this.gN.length){const l=this.$Ka,u=this.gN[0];Array.remove(this.gN,u);const I=$c.a.Kb;I&&I.Wa("FChuckedPictureUpload","True");this.LGk().s_(a,this.vOk,u,f,this.wOk,T=>{l&&(l.wgc=!1,l.dispose());b(T)},T=>{l&&(l.wgc=!1,l.dispose());Array.clear(this.gN);c(T)})}else this.$Ka&&(a=this.AIj(f),this.$Ka.L6l(b,c,a)),Array.clear(this.gN)}AIj(a){const b=new Cc.a;b.$("PresentationId",this.Pe.presentationId.string);b.$(Gg.a.Zpa,this.Pe.sessionInfo);b.$("Canary",A.AFrameworkApplication.gC);b.$("access_token",
A.AFrameworkApplication.accessToken);b.$("Type",this.FUb.toString());a&&b.$("ImageToken",a);return b}d$k(a){a&&(Array.add(this.gN,a.files[0]),this.J_d())}J_d(){if(this.zFd||!this.gN[0])Array.clear(this.gN);else{var a=new MG;a.fileName=this.Bce(this.gN[0].name);this.$Ka.wgc=!0;this.yAh(a)}}yAh(a){this.Bdj(a)?this.D$c?this.Osl(a):this.G9b(a):Array.clear(this.gN)}QFd(a,b){b=void 0===b?!1:b;if(a&&a.length){if(1===this.FUb&&this.xrk(a))return ya.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),
3;if(this.Nug(a))return 0;this.pag(a)?ya.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):ya.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.FUb?3:2}return 1}xrk(a){return!!a&&0<a.length&&Aa.a.Dg(a).endsWith(".svg")}UAj(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.ZFg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;
case 3:return ResourceStrings.l_InvalidImageErrorMessage;default:return""}}ZFg(){return this.Nug(".svg")}Nug(a){a=Aa.a.Dg(a);for(let b=0;b<this.Gjb.length;++b)if(this.Gjb[b]&&0<this.Gjb[b].length&&a.endsWith(this.Gjb[b].trim().toLowerCase()))return!0;return!1}zu(a,b){if(87===a){const c=this.Vmc?this.AMe:this.Ehd;this.fe.iI(a,f=>{f.yD=1;f.YUa=[(c/1024/1024).toString()];return!1})}else{const c=this.TAj(b);this.fe.iI(a,f=>{f.yD=1;f.message=c;return!1})}}TAj(a){return 2===a&&this.ZFg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.Gjb.join(", ")):ResourceStrings.invalidImageFileError}Osl(a){let b=this.gN[0];if(b){a.jK=b.size;a.file=b;if(b.size>this.Ehd&&this.Vmc)try{b=b.slice(0,6),a.$ag=!0}catch(c){ya.a.J(34420828,822,50,"File.slice throw exception"),this.mob=!0,this.G9b(a)}this.bnc.wAh(b,c=>{this.Uuj(c,a)})}}Uuj(a,b){try{let c=a.target.result;b.t4c=c;b.$ag&&(c=this.Vgb.createObjectURL(b.file),b.VLb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.Vdk(b.t4c)&&(this.mob=!0,ya.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.G9b(b)};f.onerror=()=>{ya.a.J(20828428,822,50,"Read image failed");this.mob=!0;this.G9b(b)};f.src=c}catch(c){ya.a.J(20828430,822,50,"GetBase64Image throw exception"),this.mob=!0,this.G9b(b)}}Vdk(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(m.a)(nQ,"PictureUploader",null,[1762]);class oQ{constructor(a){this.Pe=a}$cb(){let a="pptPictureUpload.ashx";if(ad.App.webServiceBase)a=ad.App.webServiceBase+
a;else if(E.a.jg||E.a.zwa)a=oe.a.$ua(a);a+=String.format("?{0}&{1}&{2}",A.AFrameworkApplication.jWa(),this.Pe.presentationId.string,A.AFrameworkApplication.O$b());this.Pe.podSessionId&&(a+=String.format("&{0}={1}",Gg.a.Mba,this.Pe.podSessionId));this.Pe.$k&&(a+=String.format("&waccluster={0}",this.Pe.$k));return a}IBc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}A.AFrameworkApplication.gC=a;A.AFrameworkApplication.OFb&&
ya.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(m.a)(oQ,"PictureUploaderHelper",null,[1761]);class tC{constructor(a,b,c,f,l,u,I,T,ja,ua){this.wgc=!1;this.BV=null;this.noa=!1;this.Jf=this.kZ=this.C_a=this.Vjc=this.bpc=this.wm=this.Gy=this.iHe=null;this.zf=a;this.tKk=f;this.Pe=c;this.saa=l;this.XHb=u;b&&(this.wm=b.cloneNode(!0));this.wJk=I;this.QZa=T;this.vNk=ja;(this.Ggb=ua)?this.y9f():this.D1i()}D1i(){this.BV=document.createElement("iframe");
this.BV.style.visibility=sj.a.hidden;this.BV.id=tC.eOi;this.BV.className="ObjectInDialog";this.zf.appendChild(this.BV);this.bpc=Object(R.a)(this,this.Uqh,"onUploadFrameLoad");Ae.a.addHandler(this.BV,"load",this.bpc);E.a.WD&&this.Uqh(null)}eae(a){A.AFrameworkApplication.za.Glb();if(!this.wm)return null;this.Ggb?Ae.a.addHandler(this.wm,"change",()=>{this.zmj(a)}):E.a.WD&&(this.iHe=a,this.Vjc=Object(R.a)(this,this.VXc,"fileInputChange"),Ae.a.addHandler(this.wm,"change",this.Vjc));try{this.wm.click()}catch(b){const c=
String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",b.message,b.stack);ya.a.J(508692502,818,10,c);return null}return this.wm}zmj(a){a&&a(this.wm)}VXc(){this.iHe&&this.iHe(this.wm)}L6l(a,b,c){a||ya.a.J(508692500,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||ya.a.J(508692499,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.C_a=a;this.kZ=b;if(c.Ib("ImageToken")||c.Ib("AudioToken"))a=this.Gy.action,a+=String.format("&{0}={1}",
Gg.a.$cl,1),this.Pe.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),this.Gy.action=a;for(const f of c.keys)this.xui(f,c.ga(f));this.Ggb?this.M6l():this.Gy.submit()}M6l(){try{ya.a.J(508692496,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Gy);this.UMl(a)}catch(a){ya.a.J(508692493,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.cCc("SubmitFormWithRequest failed to send the request with exception "+
a.message),this.PUc()}}UMl(a){if(a){const b=this.Gy.action;this.Jf=new XMLHttpRequest;this.Jf.open("POST",b);this.Jf.onreadystatechange=Object(R.a)(this,this.jal,"onUploadResponseReceived");this.Jf.send(a)}}jal(){4===this.Jf.readyState&&(this.Jf.status===ah.a.Zw?this.cCc(this.Jf.responseText):(ya.a.J(508692492,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.Jf.status,this.Jf.responseText?!1:!0),this.cCc("Upload request failed")),this.PUc())}dispose(){this.saa(this);this.Ggb&&
this.zf?this.zf.removeChild(this.Gy):this.zf&&this.BV&&(this.zf.contains(this.BV)&&this.zf.removeChild(this.BV),this.bpc&&Ae.a.removeHandler(this.BV,"load",this.bpc),this.bpc=null);this.Vjc&&(Ae.a.removeHandler(this.wm,"change",this.Vjc),this.Vjc=null);this.BV=this.wm=this.Gy=this.zf=null}xui(a,b){const c=this.a4i();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Gy.appendChild(c)}a4i(){return this.Ggb?document.createElement("input"):this.BV.contentWindow.document.createElement("input")}Uqh(a){try{if(!this.BV.contentWindow.document.body)return}catch(b){ya.a.J(508692491,
818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",b.toString());this.cCc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.noa?this.C_a?(this.cCc(this.PQj(this.BV.contentWindow.document.body)),this.PUc()):ya.a.J(508692490,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.y9f()}y9f(){if(!this.noa){const a=this.wJk();this.Ggb?(this.Gy=document.createElement("form"),
this.zf.appendChild(this.Gy)):(this.Gy=this.BV.contentWindow.document.createElement("form"),this.BV.contentWindow.document.body.appendChild(this.Gy));this.k3i();this.Gy.id="formId";this.Gy.method="post";this.Gy.encoding="multipart/form-data";this.Gy.action=a;this.Gy.appendChild(this.wm);this.noa=!0;this.tKk(this)}}k3i(){this.wm||(this.Ggb?(this.wm=document.createElement("input"),this.wm.style.opacity="0",this.vNk&&(this.wm.multiple="multiple")):this.wm=this.BV.contentWindow.document.createElement("input"),
this.wm.type="file",this.wm.accept=this.QZa,this.wm.id="fileInputId",this.wm.name="fileInputId")}H$i(){this.dispose()}PUc(){const a=new ne.a(2,1,0,Object(R.a)(this,this.H$i,"delayedDispose"),90,"82");A.AFrameworkApplication.Be.Jb(a)}cCc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){ya.a.J(508692489,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.C_a?this.C_a(new Em.a(b.Result)):ya.a.J(508692488,
818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new Os.a,{Code:94}),this.kZ?this.kZ(new Ps.a(a)):ya.a.J(508692487,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}lXl(){return this.noa&&!this.wgc}PQj(a){let b=null;this.XHb?(this.Bzl(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=E.a.Gk?a.innerText:a.innerHTML;return b||"No response got from server"}Bzl(a,
b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}tC.eOi="ppt_uploadframe";Object(m.a)(tC,"UploadFrame",null,[1857,1858,1859]);class pQ{constructor(a,b){this.pHb=[];this.Pe=a;this.XHb=b}D8d(a,b,c,f,l,u,I){if(0<this.pHb.length)for(let T=this.pHb.length-1;0<=T;T--)this.pHb[T].lXl()&&this.pHb[T].dispose();a=new tC(a,b,this.Pe,c,Object(R.a)(this,this.Wcj,"disposeHandler"),this.XHb,f,l,u,I);Array.add(this.pHb,a)}Wcj(a){Array.remove(this.pHb,a)}}Object(m.a)(pQ,"UploadFrameFactory",null,
[1760]);class qQ extends jr{constructor(a,b,c,f,l){super(a,b);this.nc=c;this.oa=f;this.Nkc=l}Jr(a){var b="";if(this.Nkc){const c=Wg.SchemeColor.parse(a);c&&(c.color&&!c.Hva&&(b=Object(gb.a)(267,this.nc.ug(this.oa.Oa.kb.Ua.node)),(b=c.resolve(b?b.Ld:null))?c.kR=Jk.g(b.N2a):ya.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Jk.c(a))),b=c.toString());ya.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Jk.c(b));
this.Kl.setValue(yb.a.schemeColor,b);c&&c.Hva&&(a=Jk.i(c.kR))}Aa.a.Ta(a)||super.Jr(a)}}Object(m.a)(qQ,"PptInsertionPointFormatting",jr,[]);class NG{constructor(){this.Pta=this.BO=this.Qta=0;this.packageKey=this.Ty=this.Cra=null;this.RPb=this.M0a=this.z0=0;this.startTime=this.nr=this.$I=null}vqc(){return this.BO<this.Cra.length?Object.assign(new NG,{Qta:this.BO,BO:this.BO+Math.min(this.Pta,this.Cra.length-this.BO),Pta:this.Pta,Cra:this.Cra,Ty:this.Ty,packageKey:this.packageKey,$I:this.$I,nr:this.nr,
z0:0,M0a:this.M0a,RPb:this.RPb,startTime:new Date}):null}}Object(m.a)(NG,"ChunkContext",null,[]);class rQ{constructor(a,b,c,f,l){this.Jf=this.SK=this.QI=null;this.Alc=b;this.zic=c;this.zb=a;this.Pe=f;this.Lw=l}get Y$(){return!!this.QI}s_(a,b,c,f,l,u,I,T,ja){this.Y$?(ya.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.QI.Ty,f),ja&&ja(new Ps.a(Object.assign(new Os.a,{Code:59})))):(0<l&&(this.SK=Object.assign(new ne.a(2,
1,l,Object(R.a)(this,this.HN,"onTimeout"),90,"85"),{gu:ja}),this.zb.Jb(this.SK)),(this.QI=Object.assign(new NG,{Qta:0,BO:0,Pta:a,Cra:b,packageKey:c,Ty:f,$I:T,nr:ja,z0:0,M0a:u,RPb:I,startTime:new Date}).vqc())?this.EUb(this.QI):(ya.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),ja&&ja(new Ps.a(Object.assign(new Os.a,{Code:437})))))}nQi(a){this.Y$&&(ya.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",
this.QI.Ty),this.QI.Ty===a&&this.abort())}EUb(a){this.Alc();if(this.zic()||!this.Y$)ya.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",a.Ty),this.reset();else{var b=this.L1a(a);this.Jf.onreadystatechange=()=>{this.Jf&&4===this.Jf.readyState&&this.TTe(a,this.Jf.status)};this.Jf.send(b)}}TTe(a,b){let c=Object.assign(new Os.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.Jf.responseText)}catch(f){ya.a.J(512496898,
818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Ty)}if(b&&!b.Error&&b.Result){const f=a.vqc();f?(this.Lw.QOa(100*a.BO/a.Cra.length),this.EUb(f)):(ya.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Ty),this.Lw.QOa(100),this.reset(),a.$I&&a.$I(new Em.a(b.Result)))}b&&(c=b.Error)}else ya.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",
b,a.Ty);c&&(a.z0<a.M0a?(ya.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Qta,a.BO,a.Ty),window.setTimeout(()=>{a.z0++;this.EUb(a)},a.RPb)):(ya.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Qta,a.BO,a.Ty),this.reset(),a.nr&&a.nr(new Ps.a(c))))}L1a(a){this.Jf=new XMLHttpRequest;this.Jf.open("POST",
this.$cb(),!0);A.AFrameworkApplication.accessToken&&(this.Jf.setRequestHeader("X-AccessToken",A.AFrameworkApplication.accessToken),this.Jf.setRequestHeader("X-AccessTokenTtl",A.AFrameworkApplication.q9.toString()));const b=a.packageKey,c=a.Qta,f=a.BO,l=!c&&f===a.Cra.length,u=new FormData;u.append("FileName",a.Ty);b&&u.append("PackageKey",b);u.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.Cra.length);ya.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",
c,f,a.Cra.length,a.Ty);a=l?a.Cra:a.Cra.slice(c,f);u.append("ChunkData",a);return u}$cb(){let a="PastedDataUpload.ashx";if(ad.App.webServiceBase)a=ad.App.webServiceBase+a;else if(E.a.jg||E.a.zwa)a=oe.a.$ua(a);a+=String.format("?{0}&{1}&{2}",A.AFrameworkApplication.jWa(),this.Pe.presentationId.string,A.AFrameworkApplication.O$b());this.Pe.podSessionId&&(a+=String.format("&{0}={1}",Gg.a.Mba,this.Pe.podSessionId));this.Pe.$k&&(a+=String.format("&waccluster={0}",this.Pe.$k));return a}HN(a){ya.a.J(512496864,
818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.QI.Ty);this.SK=null;this.abort();(a=a.gu)&&a(new Ps.a(Object.assign(new Os.a,{Code:299})))}abort(){if(this.Y$){ya.a.J(512496863,818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.QI.Ty);const a=this.Jf;this.reset();a&&a.abort()}}reset(){this.SK&&(this.zb.Vg(this.SK),this.SK=null);this.QI=this.Jf=null}}Object(m.a)(rQ,"ChunkedDataUploader",null,[1765]);class sQ{constructor(){this.zIk=new Hc.a(Object(R.a)(this,
this.efk,"isBrowerSupportObjectUrl"))}get smk(){return this.zIk.value}efk(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||window.webkitURL}}Object(m.a)(sQ,"PPTFileApiHelper",null,[1781]);class tQ{jfk(){return window.FileReader?!0:!1}wAh(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}Bce(a){var b=
null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(m.a)(tQ,"PPTFileReaderHelper",null,[1777]);var yT=d(994),zT=d(635),So;(function(a){a.Accent1="#4472C4";a.Accent2="#ED7D31";a.Accent3="#A5A5A5";a.Accent4="#FFC000";a.Accent5="#5B9BD5";a.Accent6="#70AD47";a.Hyperlink="#0563C1";a.ClickedHyperlink="#954F72";a.LightBackground="#FFFFFF";a.DarkBackground="#000000";a.TextColorLight="#E7E6E6";a.TextColorDark="#44546A";a.ColorPaletteName=
"Office"})(So||(So={}));Object(m.b)("DefaultOfficeThemeColorScheme",So);var uC;(function(a){a.ThemeFamilyId="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}";a.VariantId="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"})(uC||(uC={}));Object(m.b)("DefaultOfficeThemeFamily",uC);const Am=a=>{if(a)return"#"+(16777216+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1);ya.a.J(509207453,811,10,"Color is null")};var AT=d(1003),BT=d(341),CT=d(453),DT=d(302),uQ=d(549),au=d(385),vC=d(134);class lx extends au.a{constructor(){super();
this.contextId=this.context=this.numSlides=this.prompt=null;this.H_=Object.assign(new vC.a,{T_:lx.getTypeName(),B_:lx.getBaseTypes()})}static getTypeName(){return"AugLoop_Storyteller_StorytellerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(m.a)(lx,"StorytellerSignal",au.a,[]);class ET{}Object(m.a)(ET,"StorytellerDebugParams",null,[]);class FT{constructor(){this.colorsModel=this.outlineModel=null}}Object(m.a)(FT,"StorytellerSettingParams",null,[]);const jo=new Map;var rv;(function(a){a[a.Success=
0]="Success";a[a.OffensiveContentInput=1]="OffensiveContentInput";a[a.OffensiveContentOutput=2]="OffensiveContentOutput";a[a.EmptyResponse=3]="EmptyResponse";a[a.ErrorInExecution=4]="ErrorInExecution";a[a.ResourcesNotAvailable=5]="ResourcesNotAvailable";a[a.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput";a[a.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput";a[a.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList";a[a.OutputBlockedByDynamicGuardList=
9]="OutputBlockedByDynamicGuardList";a[a.InputAttackDetected=10]="InputAttackDetected";a[a.OutputAttackDetected=11]="OutputAttackDetected";a[a.PartialResult=13]="PartialResult";a[a.ModelContentFilter=14]="ModelContentFilter";a[a.Unknown=15]="Unknown";a[a.Overloaded=16]="Overloaded";a[a.Timeout=17]="Timeout";a[a.TooLargeRequest=18]="TooLargeRequest";a[a.BadRequest=19]="BadRequest";a[a.InternalServerError=20]="InternalServerError";a[a.UserNotAuthenticated=21]="UserNotAuthenticated";a[a.UserNotAuthorized=
22]="UserNotAuthorized"})(rv||(rv={}));var vQ;(function(a){a.System="system";a.User="user";a.Assistant="assistant"})(vQ||(vQ={}));var wQ;(function(a){a.NotStarted="NotStarted";a.Running="Running";a.Succeeded="Succeeded"})(wQ||(wQ={}));class xQ{constructor(a){this.hZe=new Promise((b,c)=>{this.lGl=f=>{y("AugLoopPresentationOutlineSucceeded",new Date);ya.a.J(508909145,817,50,`AugLoopGetPresentationOutlineSucceeded: ${JSON.stringify({events:jo})}`);b(f)};this.tCh=f=>{y("AugLoopPresentationOutlineFailed",
new Date);ya.a.J(508909144,817,50,`AugLoopGetPresentationOutlineFailed: ${JSON.stringify({reason:f?f.toString():"Unknown",events:jo})}`);c(f)}});this.Lxh=new Promise((b,c)=>{this.oGl=f=>{y("AugLoopGetQuestionsSucceeded",new Date);ya.a.J(509118087,817,50,`AugLoopGetQuestionsSucceeded: ${JSON.stringify({events:jo})}`);b(f)};this.D2e=f=>{y("AugLoopGetQuestionsFailed",new Date);ya.a.J(509118086,817,10,`AugLoopGetQuestionsFailed: ${JSON.stringify({reason:f?f.toString():"Unknown",events:jo})}`);c(f)}});
this.oQk=new Promise((b,c)=>{this.kGl=f=>{y("AugLoopGetOutlineSucceeded",new Date);ya.a.J(509118085,817,50,`AugLoopGetOutlineSucceeded: ${JSON.stringify({events:jo})}`);b(f)};this.sCh=f=>{y("AugLoopGetOutlineFailed",new Date);ya.a.J(509118084,817,10,`AugLoopGetOutlineFailed: ${JSON.stringify({reason:f?f.toString():"Unknown",events:jo})}`);c(f)}});this.nQk=new Promise((b,c)=>{this.cGl=f=>{y("AugLoopGetColorsSucceeded",new Date);ya.a.J(509118083,817,50,`AugLoopGetColorsSucceeded: ${JSON.stringify({events:jo})}`);
b(f)};this.qCh=f=>{y("AugLoopGetColorsFailed",new Date);ya.a.J(509118082,817,10,`AugLoopGetColorsFailed: ${JSON.stringify({reason:f?f.toString():"Unknown",events:jo})}`);c(f)}});this.pQk=new Promise((b,c)=>{this.vGl=f=>{y("AugLoopGetTemplatesSucceeded",new Date);ya.a.J(509118081,817,50,`AugLoopGetTemplatesSucceeded: ${JSON.stringify({events:jo})}`);b(f)};this.uCh=f=>{y("AugLoopGetTemplatesFailed",new Date);ya.a.J(509118080,817,10,`AugLoopGetTemplatesFailed: ${JSON.stringify({reason:f?f.toString():
"Unknown",events:jo})}`);c(f)}});this.promise=Promise.allSettled([this.oQk,this.nQk,this.pQk]);this.eOk=window.setTimeout(()=>{ya.a.J(508651594,817,10,`Timeout outlinePromise after ${a.Urh} ms`);this.sCh("General")},a.Urh);this.YGk=window.setTimeout(()=>{ya.a.J(508651593,817,10,`Timeout colorsPromise after ${a.sYf} ms`);this.qCh("General")},a.sYf);this.qTk=window.setTimeout(()=>{ya.a.J(508651592,817,10,`Timeout templatesPromise after ${a.EXh} ms`);this.uCh("General")},a.EXh);this.wQk=window.setTimeout(()=>
{ya.a.J(508651591,817,10,`Timeout questionsPromise after ${a.Ryh} ms`);this.D2e("General")},a.Ryh);this.eQk=window.setTimeout(()=>{ya.a.J(508651590,817,10,`Timeout presentationOutlinePromise after ${a.rwh} ms`);this.tCh("General")},a.rwh)}}Object(m.a)(xQ,"DeferredStorytellerAugLoopPromise",null,[]);class wC{constructor(a,b){this.ygb=new Map;this.Xfb=new Map;this.Veh=!1;this.ka=a;this.xr=b;this.xr.execute(c=>{this.ka.getBooleanAppSetting("StoryTellerShowQuestions")&&(c.aM("AugLoop_Storyteller_StorytellerQuestionsResponse"),
c.Z2("AugLoop_Storyteller_StorytellerQuestionsResponse",this.FM.bind(this)));this.ka.getBooleanAppSetting("StoryTellerUsePresentationOutlineJSON")?(ya.a.J(508908557,817,50,"StorytellerAugLoopManager: activating and registering presentationOutlineAnnotation"),c.aM("AugLoop_Storyteller_PresentationOutlineResponse"),c.Z2("AugLoop_Storyteller_PresentationOutlineResponse",this.FM.bind(this))):(c.aM("AugLoop_Storyteller_StorytellerOutlineResponse"),c.Z2("AugLoop_Storyteller_StorytellerOutlineResponse",
this.FM.bind(this)),c.aM("AugLoop_Storyteller_StorytellerColorsResponse"),c.Z2("AugLoop_Storyteller_StorytellerColorsResponse",this.FM.bind(this)),c.aM("AugLoop_Storyteller_StorytellerTemplatesResponse"),c.Z2("AugLoop_Storyteller_StorytellerTemplatesResponse",this.FM.bind(this)))})}set mif(a){this.Veh=a}eNl(a,b,c,f){if(a.contextId){var l=this.ka.getBooleanAppSetting("StoryTellerUsePresentationOutlineJSON"),u=Object.assign(new lx,Object.assign(Object.assign({},a),{debugParams:{debugMetadataEnabled:this.ka.JXa},
settingParams:{templateId:this.ka.getBooleanAppSetting("StorytellerRespectTheme")||this.Veh?"mockTemplate":this.ka.a8}})),I=Object.assign(new Uj.a,{parentPath:["Signal",lx.getTypeName()],items:[Object.assign(new sl.a,{body:u})]});u=new xQ({rwh:this.ka.tc("StorytellerPresentationOutlineAnnotationTimeout",3E4),Ryh:this.ka.tc("StoryTellerQuestionsAnnotationTimeout",1E4),Urh:this.ka.tc("StoryTellerOutlineAnnotationTimeout",2E4),sYf:this.ka.tc("StoryTellerColorsAnnotationTimeout",1E4),EXh:this.ka.tc("StoryTellerTemplatesAnnotationTimeout",
1E4)});this.ka.getBooleanAppSetting("StoryTellerShowQuestions")||u.D2e("GeneralAdjust");Promise.allSettled([u.Lxh,u.promise]).then(()=>{this.ygb.delete(a.contextId);this.Xfb.delete(a.contextId)});u.hZe.then(T=>wC.ZGg(T)?f(T.presentationOutline,T.storytellerError,T.designerOptions):(ya.a.J(508909143,817,10,"StorytellerAugLoopManager:sendStorytellerSignal Promise rejected"),f(void 0,T.storytellerError,void 0))).catch(T=>{T=this.ka.JXa?"":JSON.stringify(T);ya.a.J(508909142,817,10,`StorytellerAugLoopManager:sendStorytellerSignal presentationOutlinePromise Exception ${T}`);
return f(void 0,void 0)});u.Lxh.then(T=>b(T.questionsResponse,T.storytellerError)).catch(T=>{T=this.ka.JXa?"":JSON.stringify(T);ya.a.J(509214794,817,10,`StorytellerAugLoopManager:sendStorytellerSignal questionsPromise Exception ${T}`)});u.promise.then(T=>{var [ja,ua,Ra]=T,eb,Bb,Ub,Xb,tc,lc,Ec,hd,yd,Pd,pe,Se,vf,ug;if("rejected"==ja.status){if(ya.a.J(509195422,817,10,`StorytellerAugLoopManager:sendStorytellerSignal Promise rejected - outline:${ja.status}, colors:${ua.status}, templates:${Ra.status}`),
!l)return c(void 0,"GeneralAdjust")}else if(T={ColorScheme:"fulfilled"==ua.status?{Accent1:null===(eb=ua.value.colorPalette)||void 0===eb?void 0:eb.accent1,Accent2:null===(Bb=ua.value.colorPalette)||void 0===Bb?void 0:Bb.accent2,Accent3:null===(Ub=ua.value.colorPalette)||void 0===Ub?void 0:Ub.accent3,Accent4:null===(Xb=ua.value.colorPalette)||void 0===Xb?void 0:Xb.accent4,Accent5:null===(tc=ua.value.colorPalette)||void 0===tc?void 0:tc.accent5,Accent6:null===(lc=ua.value.colorPalette)||void 0===lc?
void 0:lc.accent6,Hyperlink:null===(Ec=ua.value.colorPalette)||void 0===Ec?void 0:Ec.hyperlink,ClickedHyperlink:null===(hd=ua.value.colorPalette)||void 0===hd?void 0:hd.clickedHyperlink,LightBackground:null===(yd=ua.value.colorPalette)||void 0===yd?void 0:yd.lightBackground,DarkBackground:null===(Pd=ua.value.colorPalette)||void 0===Pd?void 0:Pd.darkBackground,TextColorLight:null===(pe=ua.value.colorPalette)||void 0===pe?void 0:pe.textColorLight,TextColorDark:null===(Se=ua.value.colorPalette)||void 0===
Se?void 0:Se.textColorDark}:{},PresOutline:{Title:null===(vf=ja.value.presentation)||void 0===vf?void 0:vf.title,Slides:null===(ug=ja.value.presentation)||void 0===ug?void 0:ug.slides.map(Tg=>{var $f;return{Title:Tg.title,Notes:Tg.notes,KeyPoints:Tg.keyPoints,ImagesQuery:this.ka.getBooleanAppSetting("StoryTellerEnableHubbleImageSearch")?Tg.images:void 0,Images:null===($f=Tg.imageUrls)||void 0===$f?void 0:$f.map(Ve=>({Url:Ve,Format:""}))}})},ThemeIds:"fulfilled"==Ra.status?Ra.value.templateIds:void 0},
!l)return c(T)}).catch(T=>{T=this.ka.JXa?"":JSON.stringify(T);ya.a.J(509214863,817,10,`StorytellerAugLoopManager:sendStorytellerSignal outlinePromise Exception ${JSON.stringify(T)}`)});this.ygb.set(a.contextId,u);this.Xfb.set(a.contextId,new Date);this.xr.execute(T=>{T.submitOperation(I);y("AugLoopOpSubmitted",new Date)})}else ya.a.J(509214865,817,10,"StorytellerAugLoopManager:sendStorytellerSignal No contextId")}FM(a){var b;if(a.contextId){var c=this.ygb.get(a.contextId),f=this.Xfb.get(a.contextId);
if(c&&f){var l=null!==(b=a.loggableMetadata)&&void 0!==b?b:{};l.annotationType=a.ownerId;l.zEm=(+new Date-+f).toString();ya.a.J(509207583,817,15,`StorytellerAugLoopManager:handleAnnotationEvent ${JSON.stringify(l)}`);a.debugMetadata&&0<Object.keys(a.debugMetadata).length&&console.log(`Storyteller Debug Info for ${a.ownerId}: ${JSON.stringify(a.debugMetadata)}`);return wC.ZGg(a)?this.$vd(!0,a,c):this.$vd(!1,a,c)}ya.a.J(509214861,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No deferredPromise found")}else ya.a.J(509214862,
817,10,"StorytellerAugLoopManager:handleAnnotationEvent No contextId")}$vd(a,b,c){switch(b.ownerId){case "StorytellerQuestions":clearTimeout(c.wQk);a?c.oGl(b):c.D2e(this.wwc(b));break;case "StorytellerOutline":clearTimeout(c.eOk);a?c.kGl(b):c.sCh(this.wwc(b));break;case "StorytellerColors":clearTimeout(c.YGk);a?c.cGl(b):c.qCh(this.wwc(b));break;case "StorytellerTemplates":clearTimeout(c.qTk);a?c.vGl(b):c.uCh(this.wwc(b));break;case "Storyteller":clearTimeout(c.eQk);a?c.lGl(b):c.tCh(this.wwc(b));break;
default:ya.a.J(509214860,817,10,`StorytellerAugLoopManager:resolveOrRejectDeferredPromise Invalid type:${b.ownerId}, resolve:${a}`)}}wwc(a){switch(a.status.code){case rv.RaiUnsupportedLanguageInContentInput:case rv.RaiUnsupportedLanguageInContentOutput:return"UnsupportedLanguage";case rv.UserNotAuthenticated:case rv.UserNotAuthorized:return"General";default:return"GeneralAdjust"}}static ZGg(a){if(!a)return ya.a.J(509214859,822,10,"StorytellerAugLoopManager:isValidStorytellerAnnotation annotationItem is undefined."),
!1;const b=null===a||void 0===a?void 0:a.status;if(!b||b.code!==rv.Success)return ya.a.J(509214858,817,10,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} error response. status: ${b?JSON.stringify(b):""}`),!1;ya.a.J(509214857,817,15,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} is valid.`);return!0}dispose(){}}Object(m.a)(wC,"StorytellerAugLoopManager",null,[]);var yQ=d(491),Xr=d(294);class Gz extends au.a{constructor(){super();this.H_=Object.assign(new vC.a,
{T_:Gz.getTypeName(),B_:Gz.getBaseTypes()})}static getTypeName(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]}}Object(m.a)(Gz,"ClientConfigSignal",au.a,[]);class GT extends yQ.a{}Object(m.a)(GT,"SessionConfig",yQ.a,[]);class HT extends Xr.a{}Object(m.a)(HT,"ClientConfig",Xr.a,[]);class OG extends Xr.a{}Object(m.a)(OG,"EntityConfig",Xr.a,[]);class IT extends OG{}Object(m.a)(IT,"EccEntityConfig",
OG,[]);class PG extends Xr.a{}Object(m.a)(PG,"EccFeatureConfig",Xr.a,[]);class Hz extends Xr.a{}Object(m.a)(Hz,"FeatureConfig",Xr.a,[]);class JT extends PG{}Object(m.a)(JT,"EccConfig",PG,[]);class KT extends Hz{}Object(m.a)(KT,"BestMatchConfig",Hz,[]);class LT extends Hz{}Object(m.a)(LT,"ScopeConfig",Hz,[]);class MT extends Xr.a{}Object(m.a)(MT,"ClientMetadata",Xr.a,[]);var zQ=d(743);class AQ{constructor(a){this.promise=new Promise((b,c)=>{this.eGl=f=>{y("AugLoopTextPredictSucceeded",new Date);ya.a.J(508675160,
817,50,`AugLoopTextPredictSucceeded: ${JSON.stringify({events:jo})}`);b(f)};this.rCh=f=>{y("AugLoopTextPredictFailed",new Date);ya.a.J(508675159,817,10,`AugLoopTextPredictFailed: ${JSON.stringify({reason:f,events:jo})}`);c(f)}});this.qQk=window.setTimeout(()=>{this.rCh(`Timeout text predict after ${a.Mxh} ms`)},a.Mxh)}}Object(m.a)(AQ,"DeferredStorytellerTextPredictorPromise",null,[]);class BQ{constructor(a,b){this.ygb=new Map;this.Xfb=new Map;this.ka=a;this.xr=b;this.xr.execute(c=>{c.aM("AugLoop_ObservationalAssistance_EccResultAnnotation");
c.Z2("AugLoop_ObservationalAssistance_EccResultAnnotation",this.FM.bind(this));this.sMl(c)})}gNl(a,b){const c=kh.a.create().toString();a=Object.assign(new zQ.a,{startOfSentence:!0,text:`@${a}`,userInitQuery:!0,languageId:"en-US",timestamp:Date.now()});const f=Object.assign(new Uj.a,{parentPath:["Signal",zQ.a.getTypeName()],items:[Object.assign(new sl.a,{body:a,id:c})]});a=new AQ({Mxh:this.ka.tc("StoryTellerQuestionsAnnotationTimeout",1E4)});Promise.allSettled([a.promise]).then(()=>{this.ygb.delete(c);
this.Xfb.delete(c)});a.promise.then(l=>b(l)).catch(l=>{l=this.ka.JXa?"":JSON.stringify(l);ya.a.J(508675158,817,10,`StorytellerTextPredictorAugLoopManager:sendStorytellerSignal promise Exception ${l}`)});this.ygb.set(c,a);this.Xfb.set(c,new Date);this.xr.execute(l=>{l.submitOperation(f);y("TextPredictAugLoopOpSubmitted",new Date)})}sMl(a){const b=Object.assign(new Uj.a,{parentPath:["Signal",Gz.getTypeName()],items:[Object.assign(new sl.a,{body:Object.assign(new Gz,{sessionConfig:{clientConfig:{ecc:{enabled:!0,
entities:[{enabled:!0,entityType:"File",queryPrefix:["@"]},{enabled:!1,entityType:"Loop"}],bestMatch:{enabled:!1},scopes:{enabled:!1}},flag:{enabled:!1,entities:[]},nudge:{enabled:!1,entities:[]},prediction:{enabled:!1,entities:[]},metadata:{appScenario:"Copilot"}},cum:{}}})})]});a.submitOperation(b)}FM(a){var b=a.parentPath;if(!b||3>b.length)ya.a.J(508675161,817,10,"StorytellerTextPredictorAugLoopManager:handleAnnotationEvent annotation parentPath is null or empty");else{var c=b[2];b=this.ygb.get(c);
c=this.Xfb.get(c);if(b&&c)return ya.a.J(508675156,817,15,"StorytellerTextPredictorAugLoopManager:handleAnnotationEvent"),a.debugInfo&&0<Object.keys(a.debugInfo).length&&console.log(`StorytellerTextPredictorAugLoopManager debug Info for ${a.ownerId}: ${JSON.stringify(a.debugInfo)}`),this.$vd(!0,a,b);ya.a.J(508675157,817,10,"StorytellerTextPredictorAugLoopManager:handleAnnotationEvent No deferredPromise found")}}$vd(a,b,c){clearTimeout(c.qQk);a?c.eGl(b):c.rCh(b)}dispose(){}}Object(m.a)(BQ,"StorytellerTextPredictorAugLoopManager",
null,[]);class sv extends Sys.EventArgs{constructor(a){super();this.nlj=a}}Object(m.a)(sv,"QueueShowingPanesEventEventArgs",Sys.EventArgs,[]);class Iz extends Sys.EventArgs{constructor(a){super();this.DSb=a}}Object(m.a)(Iz,"StoryTellerEventArgs",Sys.EventArgs,[]);class QG{ZQh(){return this.ka.getBooleanAppSetting("StoryTellerWaitForThumbnailRefreshForDismissDialog")}constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.bid=5;this.lid=new Date;this.WBe=0;this.UHb=this.edd=this.Tgb=!1;this.G$e=(Xb,tc,
lc)=>{if(1==lc){if(md.a("currentSlideCountCheckInShowDialogAction"))if(this.mAd()&&this.WOe)this.IAd(!0);else return this.IAd(!1),8;return 32}this.showDialog("Ribbon");return 32};this.showDialog=Xb=>{Object(md.a)("StorytellerRaiseDialogShownEvent")&&this.njb.Frl();const tc=this.ZIa.icb();Xb=JSON.stringify({entryPoint:Xb,isCreateNew:tc.isCreateNew,isDocDirty:tc.isDocDirty,slideCount:tc.slideCount});ya.a.J(508397024,817,15,`StorytellerView:showDialog called with showDialogInfo: ${Xb}`);this.WOe&&this.WOe.showDialog()};
this.jza=()=>{this.xd.G3e(this.jza);this.edd=!0};this.Y8k=()=>{hp.c(M.a.CHl,!0)};this.onClose=()=>{this.Tgb=!0;this.ka.getBooleanAppSetting("StoryTellerRaiseQueueShowingPanesEvent")&&this.ue.TOb(new sv(!1));this.ZQh()&&(this.xd.G3e(this.jza),this.edd=!1);Object(md.a)("StoryTellerToSDXTransition")&&this.njb.sud(new Iz({query:this.L_a,status:this.UHb?"Cancelled":"NotHandled"}));hp.c(M.a.hVi,!0)};this.MVe=(Xb,tc)=>{Object(md.a)("StorytellerResetUserClosed")&&(this.Tgb=!1);hp.c(M.a.K6l,!0);void 0!=this.L_a&&
this.ka.getBooleanAppSetting("StoryTellerShowQuestions")||(this.L_a=Xb,this.WBe++,this.lid=new Date,y("PromptSubmitted",this.lid));this.bid=6;this.UHb=!0;const lc=kh.a.create().toString();let Ec=()=>{},hd=()=>{};const yd=new Promise((Pd,pe)=>{Ec=(Se,vf)=>{ya.a.J(509158928,817,15,`Storyteller${vf}Succeeded: ${JSON.stringify({totalDurationMs:+new Date-+this.lid,augLoopContextId:lc,attemptCount:this.WBe,presentationLength:this.bid,events:jo})}`);"PromptToOutlineFlow"===vf&&jo.clear();Pd(Se)};hd=Se=>
{ya.a.J(509158927,817,10,`StorytellerFailed: ${JSON.stringify({reason:Se?Se.toString():"Unknown",totalDurationMs:+new Date-+this.lid,augLoopContextId:lc,attemptCount:this.WBe,presentationLength:this.bid,events:jo})}`);this.UHb=!1;Object(md.a)("StoryTellerToSDXTransition")&&this.njb.sud(new Iz({query:this.L_a,status:"Fail"}));jo.clear();pe(Se)}});(this.ka.getBooleanAppSetting("CopilotTransformEnabled")||this.ka.JXa)&&Xb.startsWith("http")&&tc.additionalContext&&(this.ka.getBooleanAppSetting("StoryTellerAccessBumblebeeFlowFromInitialDialog")||
tc.additionalContext.startsWith("bb"))?this.WTk.Cfl({fileUrl:Xb,correlationId:lc,contentType:"fileurl",fileType:"docx"},(Pd,pe,Se)=>{Se=void 0===Se?"GeneralAdjust":Se;return Object(Jh.b)(this,void 0,void 0,function*(){this.qwh(Ec,hd,Pd,Se,pe,lc)})}):(tc=Object.assign(new lx,{prompt:this.L_a,numSlides:this.bid,context:null===tc||void 0===tc?void 0:tc.additionalContext,contextId:lc}),this.okd.eNl(tc,(Pd,pe)=>{pe=void 0===pe?"GeneralAdjust":pe;return Object(Jh.b)(this,void 0,void 0,function*(){this.Lol(Ec,
hd,Xb,pe,Pd)})},(Pd,pe)=>{pe=void 0===pe?"GeneralAdjust":pe;return Object(Jh.b)(this,void 0,void 0,function*(){this.Obl(Ec,hd,Xb,pe,Pd)})},(Pd,pe,Se)=>{pe=void 0===pe?"GeneralAdjust":pe;return Object(Jh.b)(this,void 0,void 0,function*(){this.qwh(Ec,hd,Pd,pe,Se,lc)})}));return yd};this.OAj=Xb=>new Promise(tc=>{this.HSk.gNl(Xb,lc=>{tc({status:lc.status,entityResults:lc.entityResults,conversationId:lc.conversationId})})});if(!(a&&b&&f&&l&&u&&I&&T&&ja&&Ra&&ua&&eb&&Bb&&Ub))throw Error("Required parameters for StorytellerView are null");
this.jS=a;this.okd=b;this.HSk=c;this.WTk=f;this.ka=l;this.ue=u;this.xd=I;this.njb=T;this.Ng=ja;this.wcd=ua;this.ia=Ra;this.Wb=eb;this.jh=Bb;this.ZIa=Ub;this.wcd.execute(Xb=>{Xb.vvb(this.eMb.bind(this))});md.a("currentSlideCountCheckInShowDialogAction")&&(this.ia.pa(M.a.aTc,ta.a.application,this.G$e,4),Object(md.a)("StorytellerUpdateRibbonInLoadDialog")||Cd.a.get_instance().Ij(7,()=>Object(Jh.b)(this,void 0,void 0,function*(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CopilotStart",
!1));appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("CopilotStart",!0))})));this.jh.wvb(this.MZ.bind(this));this.Ng.jOc(this.eMb.bind(this));this.Ng.wOc(this.eMb.bind(this));a=this.Wb.Hi();this.ka.isCreateNew||0!=a&&1!=a||!md.a("currentSlideCountCG")||!md.a("currentSlideCountForceAugLoopTemplate")||(this.okd.mif=!0);this.ka.isCreateNew&&this.ZIa&&!this.ZIa.icb().NDb&&(this.okd.mif=!0)}MZ(){const a=this.Wb.Hi();this.ka.isCreateNew||0!=a&&1!=a||!md.a("currentSlideCountCG")||
(this.okd.mif=!0,this.IAd(!0))}IAd(a){try{a?(this.ka.getBooleanAppSetting("StorytellerEnableThumbnailEntryPoint")&&(this.koc&&document.contains(this.yoc)?this.jSh():this.n9j()&&this.jSh()),this.ka.getBooleanAppSetting("StorytellerEnableRibbonEntryPoint")&&(fh.c()?(md.a("currentSlideCountCheckInShowDialogAction")||this.ia.pa(M.a.aTc,ta.a.application,this.G$e,4),appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("CopilotStart",!1))):ya.a.J(508609603,817,15,"Copilot Start: Tried to set Copilot Start ribbon icon to disabled:false but appChrome not loaded"))):
(this.ka.getBooleanAppSetting("StorytellerEnableThumbnailEntryPoint")&&this.O2j(),this.ka.getBooleanAppSetting("StorytellerEnableRibbonEntryPoint")&&(fh.c()?(md.a("currentSlideCountCheckInShowDialogAction")||this.ia.YI(M.a.aTc,ta.a.application,this.G$e),appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("CopilotStart",!0))):ya.a.J(508609602,817,15,"Copilot Start: Tried to set Copilot Start ribbon icon to disabled:true but appChrome not loaded")))}catch(b){ya.a.J(508430167,
817,10,`Copilot Start: Error setting display status of storytellerEntryPoints, status:${a}, error:${b}`)}}eMb(){const a=this.Wb.Hi();(0!=a&&1!=a||!md.a("currentSlideCountCG"))&&this.IAd(!1)}mAd(){const a=this.ZIa.icb();if(a.isIrm)return!1;const b=this.Wb.Hi();return a.isCreateNew?a.isDocDirty?0==b||1==b:!0:0==b||1==b}dispose(){}rxk(){y("LoadDialog",new Date);Object(md.a)("StorytellerUpdateRibbonInLoadDialog")&&Cd.a.get_instance().Ij(7,()=>Object(Jh.b)(this,void 0,void 0,function*(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CopilotStart",
!1));appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("CopilotStart",!0))}));const a=document.createElement("div");a.style.height="0px";a.style.width="0px";a.style.display="none";document.body.appendChild(a);const b={enableTryAgainButton:this.ka.getBooleanAppSetting("StoryTellerEnableTryAgainButton"),promptCharacterLimit:this.ka.tc("StoryTellerPromptCharacterLimit",200),disableBlankInputOnInitialPrompt:this.ka.getBooleanAppSetting("StoryTellerDisableBlankInputOnInitialPrompt"),
disableInputFieldEditOnBlur:this.ka.getBooleanAppSetting("StoryTellerDisableInputFieldEditOnBlur"),enablePromptCharacterLimit:this.ka.getBooleanAppSetting("StoryTellerEnablePromptCharacterLimit"),copilotUXRefresh:this.ka.getBooleanAppSetting("CopilotStartEnableUXRefresh"),ciqEnabled:this.ka.getBooleanAppSetting("StorytellerCiqEnabled"),pptDisabledChangeGates:this.ka.Ea("PPTDisabledChangeGates")};this.UHb=!1;"undefined"!==typeof storytellerDialog&&(this.WOe=new storytellerDialog.StorytellerDialogManager(a,
this.MVe,this.OAj,{settings:b},this.onClose,this.Y8k));this.yoc=document.getElementById("ppt-slidegrid-copilot-start-anchor-element")}n9j(){if(!this.ka.getBooleanAppSetting("StorytellerEnableThumbnailEntryPoint"))return!1;document.contains(this.yoc)||(this.yoc=document.getElementById("ppt-slidegrid-copilot-start-anchor-element"));return this.yoc&&"undefined"!==typeof storytellerDialog?(this.koc=new storytellerDialog.SkittleManager(this.yoc,()=>this.showDialog("ThumbnailPane"),"ppt-storyteller-skittle-button-id",
this.ka.Ea("PPTDisabledChangeGates")),!0):!1}jSh(){if(this.koc){const a=document.getElementById("ppto-grid-content-lower-boundary-element-copilot-ux");a&&(a.style.marginTop="40px");this.koc.showSkittle()}}O2j(){if(this.koc){const a=document.getElementById("ppto-grid-content-lower-boundary-element-copilot-ux");a&&(a.style.marginTop="");this.koc.hideSkittle()}}nom(a,b){return Object(Jh.b)(this,void 0,void 0,function*(){function c(l){l=void 0===l?1E3:l;return new Promise(u=>{setTimeout(u,l)})}let f=
0;for(;!this.edd&&f<a;)yield c(b),f+=b;this.edd||ya.a.J(509141907,817,10,`StorytellerView:waitForThumbnailRefresh never received thumbnail refresh event; maxWaitTimeMs: ${a}`);ya.a.J(509141906,817,50,`StorytellerView:waitForThumbnailRefresh finished; currentWaitTimeMs: ${f}`)})}Wxl(){this.xd.BOc(this.jza)}qwh(a,b,c,f,l,u){Object(Jh.b)(this,void 0,void 0,function*(){try{yield this.hZe(c,l,f,u),this.njb.mzh(),this.UHb=!1,Object(md.a)("StoryTellerToSDXTransition")&&this.njb.sud(new Iz({query:this.L_a,
status:"Success"})),a({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(I){y("PresentationOutlinePromiseFailed",new Date),this.ka.getBooleanAppSetting("StoryTellerRaiseQueueShowingPanesEvent")&&this.ue.TOb(new sv(!1)),b(f)}})}Ejj(a,b,c){return Object(Jh.b)(this,void 0,void 0,function*(){try{const f=[{data:a,name:"CreatePresentationCmd"}],l={correlationId:c,entryPoint:"Storyteller",scenarioName:"CreatePresentation",startTime:(new Date).toISOString()},u=Object(md.a)("StoryTellerDesignerOptionEnabled");
return JSON.parse(yield this.jS.applyJOfcCommands(JSON.stringify(f),u&&null!==b&&void 0!==b?JSON.stringify(b):"",md.a("PassScenarioOptionsForStoryteller")?JSON.stringify(l):"","","Storyteller")).FSuccess}catch(f){return ya.a.J(508846987,817,10,"StorytellerView::executeStorytellerJOfcCommand error: {0}, commandName: {1}",f,"CreatePresentationCmd"),!1}})}hZe(a,b,c,f){return Object(Jh.b)(this,void 0,void 0,function*(){return new Promise((l,u)=>Object(Jh.b)(this,void 0,void 0,function*(){if(this.Tgb)return ya.a.J(508895438,
817,15,"StorytellerView:onSubmit:presentationOutlinePromise User closed StoryTeller dialog before slides generated"),y("UserClosedBeforeSlidesGenerated",new Date),u(c);if(!a)return ya.a.J(509195420,817,10,"StorytellerView:onSubmit:presentationOutlinePromise presentationOutlineAnnotation failed"),y("AugLoopGetPresentationOutlineFailed",new Date),u(c);try{let I=!1;(I=Object(md.a)("StoryTellerUseSharedJOfcCommandCall")?yield this.Ejj(a,b,f):yield this.jS.D$f(JSON.stringify(a),"CreatePresentationCmd"))?
l():u(c)}catch(I){return ya.a.J(508895437,817,10,`StorytellerView:onSubmit:presentationOutlinePromise Exception ${I}`),u(c)}}))})}Obl(a,b,c,f,l){Object(Jh.b)(this,void 0,void 0,function*(){if(this.Tgb)return ya.a.J(509118089,817,15,"StorytellerView:onSubmit:outlineCallback User closed StoryTeller dialog before Augloop response"),y("UserClosedBeforeOutlineCallback",new Date),b(f);if(!l)return ya.a.J(508895436,817,10,"StorytellerView:onSubmit:outlineCallback outlineAnnotation failed"),y("AugLoopGetOutlineFailed",
new Date),b(f);if(this.L_a!=c||!this.ka.getBooleanAppSetting("ShowStoryTellerQuestions"))try{const u={ClientName:"StoryTeller",MergeAction:"ReplaceAll"};y("Send2ndOutlineToPPT",new Date);const I=yield this.jS.sfe(l,u);y("Send2ndMergeSlides",new Date);if(this.Tgb)return ya.a.J(509118088,817,15,"StorytellerView:onSubmit:outlineCallback User closed StoryTeller dialog before Merge request"),y("UserClosedBeforeMergeOutlineCallback",new Date),b(f);if(!(yield this.jS.iRe(I,u)))return b(f);this.njb.mzh();
this.ka.getBooleanAppSetting("StoryTellerRaiseQueueShowingPanesEvent")&&this.ue.TOb(new sv(!1));this.ZQh()&&(this.Wxl(),yield this.nom(this.ka.tc("StoryTellerDialogDismissTimeoutMs",3E3),this.ka.tc("StoryTellerDialogDismissPollIntervalMs",200)));y("2ndMergeSlidesSucceeded",new Date);this.UHb=!1;Object(md.a)("StoryTellerToSDXTransition")&&this.njb.sud(new Iz({query:this.L_a,status:"Success"}));return a({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(u){return ya.a.J(509211013,817,10,`StorytellerView:onSubmit:outlineCallback Exception ${u}`),
y("OutlineCallbackFailed",new Date),this.ka.getBooleanAppSetting("StoryTellerRaiseQueueShowingPanesEvent")&&this.ue.TOb(new sv(!1)),b(f)}})}Lol(a,b,c,f,l){Object(Jh.b)(this,void 0,void 0,function*(){if(!this.ka.getBooleanAppSetting("StoryTellerShowQuestions"))return ya.a.J(509159458,817,10,"StorytellerView:onSubmit:questionsCallback ShowStoryTellerQuestions disabled"),b(f);if(this.Tgb)return ya.a.J(509118091,817,15,"StorytellerView:onSubmit:questionsCallback User closed StoryTeller dialog before Augloop response"),
y("UserClosedBeforeQuestionsCallback",new Date),b(f);if(!l)return ya.a.J(509195421,817,10,"StorytellerView:onSubmit:questionsCallback questionsAnnotation failed"),y("AugLoopGetQuestionsFailed",new Date),b(f);if(this.L_a==c){const u={ColorScheme:{},PresOutline:{Title:void 0,Slides:[{Title:l.slide.title,Notes:l.slide.notes,KeyPoints:l.slide.keyPoints,ImagesQuery:this.ka.getBooleanAppSetting("StoryTellerEnableHubbleImageSearch")?l.slide.images:void 0}]},ThemeIds:void 0};try{const I={ClientName:"StoryTeller",
MergeAction:"ReplaceAll"};y("Send1stOutlineToPPT",new Date);const T=yield this.jS.sfe(u,I);y("Send1stMergeSlides",new Date);if(this.Tgb)return ya.a.J(509118090,817,15,"StorytellerView:onSubmit:questionsCallback User closed StoryTeller dialog before Merge request"),y("UserClosedBeforeMergeQuestionsCallback",new Date),b(f);this.jS.iRe(T,I)}catch(I){return ya.a.J(509211014,817,10,`StorytellerView:onSubmit:questionsCallback Exception ${I}`),y("QuestionsCallbackFailed",new Date),b(f)}y("QuestionsCallbackSucceeded",
new Date);return a({prompts:l.qList,fShouldDismiss:!1},"PromptToQuestionFlow")}})}}Object(m.a)(QG,"StorytellerView",null,[]);class RG{constructor(){this.ua=new uc.a}mzh(){var a=new Sys.EventArgs;this.ua.raiseEvent("MSS",a)}izi(a){this.ua.addHandler("MSS",a)}ZDh(a){this.ua.removeHandler("MSS",a)}Frl(){var a=new Sys.EventArgs;this.ua.raiseEvent("STDS",a)}Nzi(a){this.ua.addHandler("STDS",a)}sud(a){this.ua.raiseEvent("STEC",a)}Ozi(a){this.ua.addHandler("STEC",a)}}Object(m.a)(RG,"StorytellerEventSource",
null,[807,808]);class CQ{constructor(a,b,c,f,l){this.VOe=[];this.FUg=!1;this.Wnh=()=>{this.Lch.ZDh(this.Wnh);this.zTg.f_d(this.nqh);this.Nc.dEa(this.DLa)};this.nqh=()=>{this.FUg=!0;this.zTg.hEh(this.nqh);this.Wb.hGa().forEach(u=>{this.VOe.push(Vh.a.Aq(u.sid,u.cid))});setTimeout(()=>{this.uFh("onTimer")},1E3*this.Lb.tc("StoryTellerReportKeptRateTimerInSeconds",300))};this.DLa=(u,I)=>{this.Nc.uvd(this.DLa);this.FUg?this.uFh("onSessionEnd"):ya.a.J(509125888,817,15,`StorytellerKeepRateTracker::onBeforeSessionEnd session ended before inbound happen, sessionCloseReason: ${I.uE}`)};
this.uFh=u=>{let I=0;for(const T of this.VOe)this.Wb.Qk(T)&&I++;ya.a.J(509125859,817,15,`StorytellerKeepRateTracker::reportKeptSlideCount source:${u}, addedSlideCount:${this.VOe.length}, keptSlideCount:${I}`)};this.Lb=a;this.Lch=b;this.zTg=c;this.Wb=f;this.Nc=l;this.Lch.izi(this.Wnh)}}Object(m.a)(CQ,"StorytellerKeepRateTracker",null,[]);var NT=d(460);class Jz extends au.a{constructor(){super();this.sourceContent=this.correlationId=null;this.H_=Object.assign(new vC.a,{T_:Jz.getTypeName(),B_:Jz.getBaseTypes()})}static getTypeName(){return"AugLoop_ContentProcessing_ContentProcessingSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(Jz,"ContentProcessingSignal",au.a,[]);class OT{}Object(m.a)(OT,"ICTEnterpriseSourceContent",null,[]);var SG;(function(a){a.Web="web";a.Pdf="pdf";a.Html="html";a.Mhtml="mhtml";a.FileUrl="fileurl"})(SG||(SG={}));Object(m.b)("ICTDocSources",SG);class PT{constructor(){this.targetLengthInMinutes=0;this.language="en"}}Object(m.a)(PT,"ICTRequestForSegmentationConfig",null,[]);class mx extends au.a{constructor(){super();this.segmentBlobs=this.correlationId=null;this.H_=Object.assign(new vC.a,
{T_:mx.getTypeName(),B_:mx.getBaseTypes()})}static getTypeName(){return"AugLoop_SegmentToSlide_SegmentToSlideSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(m.a)(mx,"SegmentToSlideSignal",au.a,[]);const QT=(a,b)=>b?a.error?(nx(a.ownerId,`Annotation contains error: ${JSON.stringify(a.error)}`),!1):a.presentationOutline&&0===a.presentationOutline.slides.length||!(a.presentationOutline||a.slideResponses&&0!==a.slideResponses.length)?(nx(a.ownerId,"Annotation empty slideResponses"),
!1):DQ(a,b):(nx(a.ownerId,`Empty ongoingTranformCorrelationId, annotation CorrelationId:${a.correlationId}`),!1),DQ=(a,b)=>{let c;a?a.correlationId?b!==a.correlationId&&(c=`Annotation correlationId: ${a.correlationId} doesn't match ongoingTransformCorrelationId: ${b}.`):c="Annotation correlationID undefined.":c="Annotation is undefined.";c&&nx(a.ownerId,c);return!0},nx=(a,b)=>{ya.a.J(508859922,817,b?10:15,`TransformAugLoopManager:isValidTransformAnnotation type:${a} is ${b?"invalid: "+b:"valid"}.`)};
class RT{}Object(m.a)(RT,"TransformParams",null,[]);class ST{}Object(m.a)(ST,"SegmentToSlideParams",null,[]);class EQ{constructor(a,b){this.GEe=!1;this.ka=a;this.xr=b;this.xr.execute(c=>{c.aM("AugLoop_ContentProcessing_ContentProcessingAnnotation");c.Z2("AugLoop_ContentProcessing_ContentProcessingAnnotation",this.cVj.bind(this));c.aM("AugLoop_SegmentToSlide_SegmentToSlideAnnotation");c.Z2("AugLoop_SegmentToSlide_SegmentToSlideAnnotation",this.VZj.bind(this))})}Cfl(a,b){a.correlationId?(y("BeginTransform",
new Date),this.GEe=!1,this.XTk=(c,f,l)=>{this.GEe||(b(c,f,l),this.GEe=!0)},this.XLe=a.correlationId,this.I6l(a)):ya.a.J(508859919,817,10,"StorytellerAugLoopManager:sendStorytellerSignal No correlationId")}I6l(a){a=Object.assign(new Jz,{correlationId:a.correlationId,sourceContent:[{contentType:a.contentType,source:"",fileType:a.fileType,url:a.fileUrl}],entryPoint:"Start"});const b=Object.assign(new Uj.a,{parentPath:["Signal",Jz.getTypeName()],items:[Object.assign(new sl.a,{body:a})]});this.xr.execute(c=>
{const f=this.ka.tc("CopilotTransformContentProcessingAnnotationTimeoutMs",1E4);this.pOg=window.setTimeout(()=>{ya.a.J(508651589,817,10,`ContentProcessing timeout after ${f}MS.`);this.Q9b(void 0,void 0,"General")},f);y("ContentProcessingAugLoopSignalSubmitted",new Date);c.submitOperation(b)})}Y_i(a){if(a.errors)for(const b of a.errors)switch(b.errorType){case "DocumentDownloadFailed":return"StartFromFileDocumentDownload";case "InvalidInput":return"InvalidInput";case "Unauthorized":return"StartFromFilePermissions";
case "DocumentTooLarge":return"StartFromFileSize";case "DocumentIrmProtected":return"StartFromFileIRMProtected";case "DocumentNotFound":return"StartFromFileDoesNotExist"}return"GeneralAdjust"}cVj(a){clearTimeout(this.pOg);y("ContentProcessingAugLoopAnnotationReceived",new Date);var b=this.XLe;var c;b?0<(null===(c=a.errors)||void 0===c?void 0:c.length)?(nx(a.ownerId,`Annotation contains error: ${JSON.stringify(a.errors)}`),b=!1):b=DQ(a,b):(nx(a.ownerId,`Empty ongoingTranformCorrelationId, annotation CorrelationId:${a.correlationId}`),
b=!1);if(!b)return this.Q9b(void 0,void 0,this.Y_i(a));this.O6l({segmentBlobs:a.segmentBlobs,correlationId:a.correlationId})}O6l(a){let b=null;b=Object(md.a)("PptoStartUseBBCreateNewPresentation")?Object.assign(new mx,{correlationId:a.correlationId,segmentBlobs:a.segmentBlobs,language:a.language,entryPoint:"Start",fCreateNewPresentation:!0}):Object.assign(new mx,{correlationId:a.correlationId,segmentBlobs:a.segmentBlobs,language:a.language,entryPoint:"Start"});const c=Object.assign(new Uj.a,{parentPath:["Signal",
mx.getTypeName()],items:[Object.assign(new sl.a,{body:b})]});this.xr.execute(f=>{const l=this.ka.tc("CopilotTransformSegmentToSlideAnnotationTimeoutMs",2E4);this.Rah=window.setTimeout(()=>{ya.a.J(508651588,817,10,`SegmentToSlide timeout after ${l}MS.`);this.Q9b(void 0,void 0,"General")},l);y("SegmentToSlideAugLoopSignalSubmitted",new Date);f.submitOperation(c)})}k0i(a){switch(a.error.errorType){case "InvalidInput":return"InvalidInput";case "Unauthorized":return"StartFromFilePermissions";default:return"GeneralAdjust"}}VZj(a){clearTimeout(this.Rah);
y("SegmentToSlideAugLoopAnnotationReceived",new Date);if(!QT(a,this.XLe))return this.Q9b(void 0,void 0,this.k0i(a));if(Object(md.a)("PptoStartUseBBCreateNewPresentation")&&a.presentationOutline)var b=a.presentationOutline;else{b=[];for(let c=0;c<a.slideResponses.length;c++){const f=a.slideResponses[c];f.error?ya.a.J(508859921,817,10,`SlideResponse slide ${c} has error. type: ${f.error.errorType}; message: ${f.error.message}`):f.slide&&b.push(f.slide)}b={version:"1.0.0",slides:b}}return this.Q9b(b,
a.designerOptions,null)}Q9b(a,b,c){y("FinishTransform",new Date);this.XLe="";clearTimeout(this.pOg);clearTimeout(this.Rah);ya.a.J(508859920,817,c?10:50,`TransformAugLoopManager: Transform ${c?"failed due to "+c.toString():"succeeded"}.  ${JSON.stringify({events:jo})}`);return this.XTk(a,b,c)}dispose(){}}Object(m.a)(EQ,"TransformAugLoopManager",null,[]);class Kz{get name(){return"PowerPointWebEditor.Storyteller"}fc(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),c=this.K.resolve("PowerPointWebEditor.IPresentationReader");
Kz.mAd(b,c.Hi());this.K.register(RG,"PowerPointWebEditor.IStorytellerEventNotifier").as("PowerPointWebEditor.IStorytellerEventListener").ma().na(()=>new RG);this.K.register(QG,"PowerPointWebEditor.StorytellerView").as("PowerPointWebEditor.IStorytellerView").ma().na(()=>new QG(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),new wC(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),new BQ(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),new EQ(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IStorytellerEventNotifier"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.Ha("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("Common.IActionManagerExtended"),c,this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ICopilotDocumentStateTracker")));this.K.resolve("PowerPointWebEditor.ICopilotEnableStateChecker").Sxj().then(f=>{0===f?this.cyk(b):ya.a.J(508409416,817,15,`Storyteller was disabled by ${f}`)})}static mAd(a,b){return a.JXa?!0:A.AFrameworkApplication.cD||A.AFrameworkApplication.Tw?
!1:a.isCreateNew?a.getBooleanAppSetting("StorytellerTemplatesEnabled")||""==a.a8||"blank"==a.a8?!0:!1:md.a("currentSlideCountOnBootCG")&&md.a("currentSlideCountCG")&&(0==b||1==b)?!0:!1}cyk(a){a.getBooleanAppSetting("CopilotStartMasterSwitch")?(a.getBooleanAppSetting("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").TOb(new sv(!0)),this.loadScript()):ya.a.J(508900953,817,50,"PPTWebEditorStorytellerPackage: not loading Storyteller script since Copilot Start master switch disabled.")}loadScript(){y("LoadDialogScript",
new Date);Cd.a.get_instance().Ij(7,()=>Object(Jh.b)(this,void 0,void 0,function*(){const a=zs.a(this.K);yield a("storytellerDialog");a("storytellerDialog").then(()=>{this.K.resolve("PowerPointWebEditor.IStorytellerView").rxk()}).catch(b=>{ya.a.J(509154954,817,10,`PPTWebEditorStorytellerPackage:loadScript Exception while loading storytellerDialog ${JSON.stringify(b)}`);this.K.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").TOb(new sv(!1))})}))}init(){this.ISk=
this.K.resolve("PowerPointWebEditor.IStorytellerView");Object(md.a)("EnableStoryTellerKeepRateTracker")&&new CQ(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IStorytellerEventListener"),NT.a.instance,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"))}dispose(){this.ISk.dispose()}static main(){C.a.instance.Ac(new Kz)}}Object(m.a)(Kz,"PPTWebEditorStorytellerPackage",null,[2,3]);var tv;(function(a){a.Insert=
"Insert";a.ReplaceAll="ReplaceAll"})(tv||(tv={}));Object(m.b)("MergeAction",tv);var yq;(function(a){a.ChatPPTExitClicked="ChatPPTExitClicked";a.ChatPPTLikeClicked="ChatPPTLikeClicked";a.ChatPPTDislikeClicked="ChatPPTDislikeClicked";a.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked";a.ChatPPTShowDesigner="ChatPPTShowDesigner";a.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart";a.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete";a.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation";
a.ChatPPTInsertSlideCompleted="ChatPPTInsertSlideCompleted";a.ChatPPTSearchClicked="ChatPPTSearchClicked";a.ChatPPTSearchCompleted="ChatPPTSearchCompleted";a.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful";a.ChatPPTQueryAppState="ChatPPTQueryAppState";a.ChatPPTAppStateResponse="ChatPPTAppStateResponse"})(yq||(yq={}));Object(m.b)("ChatPPTEvents",yq);class FQ{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){this.sB={};this.JVg=!1;this.kKe=Object(md.a)("SupportTenantAdminCheck");
this.x6=!1;this.jib=null;this.UOe=[];this.HVg=this.$ed=this.Dld=!1;this.lqh=(hd,yd)=>{var Pd;if(yd&&yd.DSb){if("NotHandled"!==yd.DSb.status&&this.UOe.push(yd.DSb),"Success"===yd.DSb.status||"NotHandled"===yd.DSb.status||"Cancelled"===yd.DSb.status)null===(Pd=this.TOe)||void 0===Pd?void 0:Pd.ZDh(this.lqh),this.showTaskPane(!0),this.UOe=[],this.ka.getBooleanAppSetting("ChatPPTAutoOpenTaskPane")&&this.Db.QH(pe=>{this.St(pe)})}else ya.a.J(509097375,811,15,"Copilot Chat: StoryTellerEventArgs is null")};
this.w$k=()=>{this.x6&&(this.X$c(!1),this.t5d())};this.St=hd=>{this.ka.getBooleanAppSetting("ChatPPTAutoOpenTaskPane")&&Object(md.a)("ToggleRibbonModeOnModeSwitch")&&1!==hd.mode&&!this.x6&&this.showTaskPane(!1)};this.F9k=hd=>{hd&&(this.x6=!1,ya.a.J(509166466,811,50,"Copilot Chat: Close SDX in offline mode"))};this.YUe=()=>{this.G2h()};this.U$e=(hd,yd,Pd)=>{if(1==Pd)return this.pAg()?this.JPh()?32:8:32;this.x6?(this.X$c(!1),this.t5d()):(this.X$c(!0),this.showTaskPane(!1));return 32};this.Juc=(hd,yd,
Pd,pe,Se)=>{if(!Se)return 8;null===Se||void 0===Se?void 0:Se.Rf(this.x6);return 32};this.BEa=(hd,yd,Pd)=>{if(1==Pd)return 32;this.jQl();return 32};this.Fhe=()=>{var hd,yd;const Pd={};Object(md.a)("useLocalizedTitleString")?(Pd.BA=null!==(hd=ResourceStrings.l_CopilotPaneTitlePreview)&&void 0!==hd?hd:"Copilot (Preview)",Pd.Bdf=null!==(yd=ResourceStrings.l_CopilotPaneTitlePreview)&&void 0!==yd?yd:"Copilot (Preview)"):(Pd.BA="Copilot (Preview)",Pd.Bdf="Copilot (Preview)");Pd.assetId=this.NNg;Pd.nonPersistedSettings=
this.sB;Pd.q7=this.Jkb;Object(md.a)("AddClassOnSDXPaneContainer")&&(Pd.iXh="ActionAITaskPane");Object(md.a)("AddInPaneHeaderEnhancement")&&(Pd.jXh="PPTCoPilot_24");return Pd};this.MLa=(hd,yd)=>{yd&&(hd=yd.zj)&&hd.length&&this.jib===hd&&(this.x6=!1,this.jib=null,Object(md.a)("EnableChatPPTEventListenerFromSDX")&&this.U5l())};this.Jkb=()=>{this.jib=this.UVa();this.x6=!0;Object(md.a)("EnableChatPPTEventListenerFromSDX")&&this.Z4l()};this.jQl=()=>{Gj.UISurfaces.qr().then(hd=>{const yd=this.UVa();yd&&
hd.setSelectedTaskPane(yd);return null}).catch(hd=>{ya.a.J(509354912,811,10,"Copilot Chat: SelectPane exception: {0}",hd.toString())})};this.Gil=hd=>Object(Jh.b)(this,void 0,void 0,function*(){var yd,Pd,pe,Se,vf,ug,Tg,$f,Ve=hd.slides;const xg=[];for(var yg of Ve){var ng=yg;Ve=this.ka.getBooleanAppSetting("ChatPPTEnableHubbleImageSearch");var Wh=this.ka.getBooleanAppSetting("ChatPPTEnableTextToImage");if(!ng)throw Error.argumentNull("slideData");var Ai=ng.Images,Wf=[],gg=[];for(var vh of Ai)vh&&(Wf.push(vh.Prompt),
gg.push({Url:vh.Url,Format:void 0}));Ai=ng.Title;const Zj=ng.KeyPoints;ng=ng.Notes;Ai&&Zj||ya.a.J(509207452,811,15,"Copilot:InvalidOutlineInfo={0}{1}",Ai?"":"slideTitle;",Zj?"":"keyPoints;");xg.push({Title:Ai,ImagesQuery:Ve?Wf:void 0,Images:Wh?gg:void 0,KeyPoints:Zj,Notes:ng})}vh={Title:"",Slides:xg};Ve=this.sa.Aa;yg=this.sa.currentSlideIndex;Ve||ya.a.J(509207493,811,15,"Copilot Chat: Slide Node is Null. Using Office Default Theme Values");Wh=this.ka.getBooleanAppSetting("ChatPPTUseColorSwapFix");
Ve&&Ve.Ld?Wh=Wh?{["Accent1"]:Am(Ve.Ld.Accent1),["Accent2"]:Am(Ve.Ld.Accent2),["Accent3"]:Am(Ve.Ld.Accent3),["Accent4"]:Am(Ve.Ld.Accent4),["Accent5"]:Am(Ve.Ld.Accent5),["Accent6"]:Am(Ve.Ld.Accent6),["Hyperlink"]:Am(Ve.Ld.Hyperlink),["ClickedHyperlink"]:Am(Ve.Ld.FollowedHyperlink),["TextColorLight"]:Am(Ve.Ld.Light1),["TextColorDark"]:Am(Ve.Ld.Dark1),["LightBackground"]:Am(Ve.Ld.Light2),["DarkBackground"]:Am(Ve.Ld.Dark2),["ColorPaletteName"]:Object(md.a)("PptOutlineToPptUsesColorSchemeName")?Ve.Ld.ColorSchemeName:
void 0}:{["Accent1"]:Am(Ve.Ld.Accent1),["Accent2"]:Am(Ve.Ld.Accent2),["Accent3"]:Am(Ve.Ld.Accent3),["Accent4"]:Am(Ve.Ld.Accent4),["Accent5"]:Am(Ve.Ld.Accent5),["Accent6"]:Am(Ve.Ld.Accent6),["Hyperlink"]:Am(Ve.Ld.Hyperlink),["ClickedHyperlink"]:Am(Ve.Ld.FollowedHyperlink),["LightBackground"]:Am(Ve.Ld.Light1),["DarkBackground"]:Am(Ve.Ld.Dark1),["TextColorLight"]:Am(Ve.Ld.Light2),["TextColorDark"]:Am(Ve.Ld.Dark2),["ColorPaletteName"]:Object(md.a)("PptOutlineToPptUsesColorSchemeName")?Ve.Ld.ColorSchemeName:
void 0}:(ya.a.J(509207489,811,50,"Slide Node is Null. Using Default Office Theme Color Scheme"),Wh={["Accent1"]:So.Accent1,["Accent2"]:So.Accent2,["Accent3"]:So.Accent3,["Accent4"]:So.Accent4,["Accent5"]:So.Accent5,["Accent6"]:So.Accent6,["Hyperlink"]:So.Hyperlink,["ClickedHyperlink"]:So.ClickedHyperlink,["LightBackground"]:So.LightBackground,["DarkBackground"]:So.DarkBackground,["TextColorLight"]:So.TextColorLight,["TextColorDark"]:So.TextColorDark,["ColorPaletteName"]:Object(md.a)("PptOutlineToPptUsesColorSchemeName")?
So.ColorPaletteName:void 0});Wf=this.sa;Ve&&(null===Wf||void 0===Wf?0:Wf.presentation)&&Wf.presentation.lbc(Ve)?Wf="{"+Wf.presentation.lbc(Ve).ThemeFamilyId+"}":(ya.a.J(509207490,811,50,"Slide Node is Null. Using Default Office Theme Family Id"),Wf=uC.ThemeFamilyId);Wf=[Wf];ng=gg=void 0;Ai=hd.mergeAction?hd.mergeAction:tv.Insert;Object(md.a)("PptOutlineToPptUseFontName")&&Ai==tv.Insert&&(gg=null===(Se=null===(pe=null===(Pd=null===(yd=null===Ve||void 0===Ve?void 0:Ve.Ld)||void 0===yd?void 0:yd.FontScheme)||
void 0===Pd?void 0:Pd.majorFontField)||void 0===pe?void 0:pe.latinField)||void 0===Se?void 0:Se.typefaceField,ng=null===($f=null===(Tg=null===(ug=null===(vf=null===Ve||void 0===Ve?void 0:Ve.Ld)||void 0===vf?void 0:vf.FontScheme)||void 0===ug?void 0:ug.minorFontField)||void 0===Tg?void 0:Tg.latinField)||void 0===$f?void 0:$f.typefaceField);yd={OutlineInput:{ColorScheme:Wh,PresOutline:vh,ThemeIds:Wf,MajorFont:gg,MinorFont:ng,FRenderFirstThumb:!0},RequestOptions:{ClientName:"ChatPPT",MergeAction:Ai,
CorrelationId:void 0,InsertPosition:{ReferenceSlide:{Cid:null===Ve||void 0===Ve?void 0:Ve.cid,Sid:null===Ve||void 0===Ve?void 0:Ve.sid},InsertBefore:!1}}};ya.a.J(509166875,811,15,"Copilot Chat:MergeAction={0}",hd.mergeAction);yd=yield this.jS.gfg(yd);return{slideIndex:-1===yg||hd.mergeAction===tv.ReplaceAll?xg.length-1:yg+xg.length,success:yd}});this.sUl=hd=>{hd||ya.a.J(509166874,811,10,"Copilot Chat: SetThumbnailFocus - No data received from SDX");try{const yd=JSON.parse(hd),Pd=yd.mergeAction===
tv.ReplaceAll?1:yd.slideIndex;!Pd||!this.Wb.Hi()||Pd>this.Wb.Hi()?ya.a.J(509166371,811,10,"Copilot Chat: Invalid Slide Index provided to set focus"):this.ka.Cm?this.lba.value.RI(Pd):this.De.RI(Pd)}catch(yd){ya.a.J(509166873,811,10,"Copilot Chat: Unexpected Error Occurred setting slideIndex:{0}",yd.toString())}};this.Hbk=hd=>{if(null==hd)ya.a.J(509207492,811,10,"Copilot Chat: InsertSlideEventHandler - No message received from SDX");else if(Object(md.a)("pptCreatorServiceForCopilotEnabled")){let yd;
try{yd=JSON.parse(hd)}catch(Pd){ya.a.J(509207491,811,10,"Copilot Chat: InsertSlideEventHandler - Unexpected error parsing sdx request data {0}",Pd.toString());return}this.Gil(yd).then(Pd=>{Pd?(ya.a.J(509211359,811,15,"Copilot Chat: InsertSlideEventHandler - InsertSlideSuccessful={0}",Pd.success),Pd={type:yq.ChatPPTInsertSlideCompleted,message:JSON.stringify(Pd)},this.zKh(Pd)):ya.a.J(509166872,811,10,"Copilot Chat: InsertSlideEventHandler - No Response From creator service")}).catch(Pd=>{ya.a.J(509211358,
811,10,"Copilot Chat: InsertSlideEventHandler - Unexpected error in insert slide operation from copilot?: {0}",Pd.toString())})}};this.JYj=hd=>{var yd;hd||ya.a.J(508839042,811,10,"Copilot Chat: handleQueryAppState - No data received from SDX");try{const Pd=JSON.parse(hd),pe={scenario:Pd.scenario,appState:{}};switch(Pd.scenario){case "CreatePresentation":const vf=null===(yd=this.oHk)||void 0===yd?void 0:yd.Rzj();"None"===vf?pe.appState.enabled=!0:(pe.appState.enabled=!1,pe.appState.disabledReason=
vf.toString());ya.a.J(508831951,811,50,`Copilot Chat: handleQueryAppState: CreatePresentation disabledReason:${vf}`);break;default:ya.a.J(508839041,811,10,`Copilot Chat: handleQueryAppState: app cannot handle ${Pd.scenario}`)}const Se={type:yq.ChatPPTAppStateResponse,message:JSON.stringify(pe)};this.zKh(Se)}catch(Pd){ya.a.J(508839040,811,10,`Copilot Chat: handleQueryAppState: Unexpected Error: ${Pd}`)}};this.zKh=hd=>{if(this.jib){var yd=document.getElementById(this.jib);null==yd?ya.a.J(509196E3,811,
10,"Copilot Chat: SDX pane not found. IsPaneVisible={0}",this.x6):yd.contentWindow&&yd.contentWindow.postMessage(hd,"*")}else ya.a.J(509166871,811,10,"Copilot Chat: SDX instance id is null",this.x6)};this.WVf=hd=>{if(null!==hd&&void 0!==hd&&hd.data)switch(hd.data.type){case yq.ChatPPTExecuteInsertSlideOperation:this.Hbk(hd.data.message);break;case yq.ChatPPTShowDesigner:this.ia.nb(M.a.wrh,2);break;case yq.ChatPPTLikeClicked:Object(md.a)("EnableFeedbackInChatPPTMode")&&this.M0i(hd.data.message);break;
case yq.ChatPPTDislikeClicked:Object(md.a)("EnableFeedbackInChatPPTMode")&&this.L0i(hd.data.message);break;case yq.ChatPPTSearchClicked:this.B5l(hd.data.message);break;case yq.ChatPPTSlideUpdateCheckSuccessful:Object(md.a)("SetFocusFromSDX")&&this.sUl(hd.data.message);break;case yq.ChatPPTQueryAppState:Object(md.a)("CreatePresentationEnabledState")&&this.JYj(hd.data.message)}};if(!I)throw Error.argumentNull("graphTopologyManager");if(!T)throw Error.argumentNull("copilotProxy");if(!l)throw Error.argumentNull("appSettings");
if(l.Cm&&!ja)throw Error.argumentNull("sorterViewActorLazy");if(!l.Cm&&!ua)throw Error.argumentNull("thumbnailNavigationPaneView");if(!Ra)throw Error.argumentNull("presentationReader");if(!c)throw Error.argumentNull("appFrame");if(!Xb)throw Error.argumentNull("futurePolicyManager");if(!tc)throw Error.argumentNull("futureAugLoopRuntimeManager");if(!Ec)throw Error.argumentNull("cloudPolicySettingsHelperFuture");this.ia=a;this.Oc=b;this.ka=l;this.ZRk=u;this.MLg=f;this.Db=c;this.sa=I;this.jS=T;this.De=
ua;this.lba=ja;this.Wb=Ra;this.TOe=eb;this.oHk=Bb;this.ZIa=Ub;this.NNg=this.ka.Kgk?"FA000000129":"FA000000121";this.tHb=Xb;this.sHb=tc;this.JVg=lc;this.UCe=Ec;this.kKe||(this.ps(),this.vxg());this.FLh();this.sHb.execute(hd=>{hd.S2k(()=>{this.W1h()})})}qb(){this.kKe?this.ka.Ue(()=>{this.UCe.execute(a=>Object(Jh.b)(this,void 0,void 0,function*(){const b=Date.now();let c=!1;try{c=yield a.UO("CopilotContentGeneration",!0)}catch(f){ya.a.J(508417310,822,10,"Exception getting OCPS for CopilotContentGeneration")}ya.a.J(508417312,
822,15,`{"CopilotGenerationDisabledByPolicy": ${c}, "OCPSCheckLatency": ${Date.now()-b}}`);this.HVg=c;this.ps();this.vxg();this.pmb()}))}):this.pmb()}Sd(){}pmb(){this.ia.xa(M.a.uxb,ta.a.view,this.U$e);this.ia.xa(M.a.uxb,ta.a.notes,this.U$e);this.ia.xa(M.a.uxb,ta.a.Xf,this.U$e);this.ia.pe(M.a.uxb,4);Object(md.a)("ShowEnabledStateOfChatPPT")&&this.ia.pa(M.a.Juc,ta.a.application,this.Juc,96);this.ia.xa(M.a.BEa,ta.a.view,this.BEa);this.ia.xa(M.a.BEa,ta.a.notes,this.BEa);this.ia.xa(M.a.BEa,ta.a.Xf,this.BEa);
this.ia.pe(M.a.BEa,4)}ps(){var a,b;this.Oc.execute(c=>{c.lOc(this.MLa)});Object(md.a)("EnableChatPPTPaneOnEditingMode")&&!this.gfb()&&this.Db.QH(c=>{this.St(c)});Object(md.a)("EnhancementOfSDXPaneBootTime")&&Cd.a.get_instance().Ij(8,()=>{this.FLh();this.ka.getBooleanAppSetting("ChatPPTAutoOpenTaskPane")&&(this.gfb()||this.showTaskPane(!1))});Object(md.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Db.cEa(this.F9k);Object(md.a)("StoryTellerToSDXTransition")&&this.gfb()&&(null===(a=this.TOe)||void 0===
a?void 0:a.Ozi(this.lqh));Object(md.a)("ClosePaneOnStoryTellerDialogShown")&&this.gfb()&&(null===(b=this.TOe)||void 0===b?void 0:b.Nzi(this.w$k));this.pAg()&&(this.tHb.execute(c=>{c.Z2b(this.YUe)}),this.G2h())}vxg(){var a;Object(md.a)("PptChatPaneUseALOverrideIfSet")?this.sB.AugloopClouldALServiceUrl=null!==(a=Object(AT.a)(this.ka))&&void 0!==a?a:this.ka.Ea("AugLoopCloudALServiceUrl"):this.sB.AugloopClouldALServiceUrl=this.ka.Ea("AugLoopCloudALServiceUrl");this.sB.ShouldUseEnvSpecificALUrl=this.ZRk.toString();
this.sB.PPTCreatorEnabled=Object(md.a)("pptCreatorServiceForCopilotEnabled").toString();this.sB.PPTClientOrigin=window.location.origin;this.sB.PPTCopilotSearchEnabled=(!Object(md.a)("pptCopilotSearch")).toString();this.sB.PPTCopilotEnableTextToImage=this.ka.getBooleanAppSetting("ChatPPTEnableTextToImage").toString();this.sB.PPTShowSuggestionsPill=this.ka.getBooleanAppSetting("ChatPPTSuggestionsPillEnabled").toString();this.sB.PPTBBPresOutlineEnabled=this.ka.getBooleanAppSetting("PPTBBPresOutlineEnabled").toString();
this.sB.PPTCIQDocMenuEnabled=this.ka.getBooleanAppSetting("ChatPPTCIQDocMenuEnabled").toString();this.sB.PPTEnableFluentVisualRefresh=(this.ka.LHa&&this.ka.getBooleanAppSetting("EnablePPTOBgColorRefresh")).toString();this.sB.PPTCopilotScnCreatePresFromPrompt=this.ka.getBooleanAppSetting("PPTCopilotScnCreatePresFromPrompt").toString();this.sB.PPTCopilotScnCreatePresQueryAppState=this.ka.getBooleanAppSetting("PPTCopilotScnCreatePresQueryAppState")&&Object(md.a)("CreatePresentationEnabledState")?"true":
"false";this.sB.PPTCopilotScnCreatePresFromDoc=this.ka.getBooleanAppSetting("PPTCopilotScnCreatePresFromDoc").toString();this.sB.PPTCopilotScnAddSlide=this.ka.getBooleanAppSetting("PPTCopilotScnAddSlide").toString();this.sB.PPTCopilotScnInsertImage=this.ka.getBooleanAppSetting("PPTCopilotScnInsertImage").toString();this.sB.PPTCopilotScnAnimate=this.ka.getBooleanAppSetting("PPTCopilotScnAnimate").toString();this.sB.PPTCopilotScnBeautify=this.ka.getBooleanAppSetting("PPTCopilotScnBeautify").toString();
this.sB.PPTCopilotScnOrganize=this.ka.getBooleanAppSetting("PPTCopilotScnOrganize").toString();this.sB.PPTCopilotUseOfficeAIAugLoopWorkflow=this.ka.getBooleanAppSetting("PPTCopilotUseOfficeAIAugLoopWorkflow").toString();this.sB.PPTCopilotDebugJOfcPayload=this.ka.getBooleanAppSetting("PPTCopilotDebugJOfcPayload").toString();this.sB.PPTCopilotDebugODSLInput=this.ka.getBooleanAppSetting("PPTCopilotDebugODSLInput").toString();Object(md.a)("PptApplyJOfcCommandsUseScenarioOptionsTelemetry")&&(this.sB.PPTCopilotUseScenarioOptionsTelemetry=
"true");this.kKe&&(this.sB.PPTContentGenerationDisabledByAdmin=this.HVg)}gfb(){return Object(md.a)("ActionAiStoryTellerAlwaysEnabled")?!0:Object(md.a)("StoryTellerToSDXTransition")&&this.JVg&&Kz.mAd(this.ka,this.Wb.Hi())}pAg(){return Object(md.a)("ChatPPTCheckIRMStateInActor")}G2h(){this.ZIa?this.$ed=this.ZIa.icb().isIrm:(ya.a.J(508442525,811,15,"Copilot Chat: updateIrmState - documentStateTracker is not enabled"),this.$ed=A.AFrameworkApplication.cD||A.AFrameworkApplication.Tw);this.W1h();this.$ed&&
this.x6&&(this.X$c(!1),this.t5d())}JPh(){return!Object(md.a)("EnableChatButtonAfterALSessionCreated")||this.sHb.instance&&this.sHb.instance.tVg?!this.$ed:!1}W1h(){const a=!this.JPh();fh.c()?appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("ChatPPTPane",a)):ya.a.J(508442524,811,15,`Copilot Chat: Tried to set Copilot ribbon button to isDisabled:${a} but appChrome not loaded`)}FLh(){fh.c()?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ChatPPTPane",!1)):
ya.a.J(508875333,811,15,"Copilot Chat: Tried to set Copilot ribbon icon to isHidden:false but appChrome not loaded")}X$c(a){Object(md.a)("logTelemetryForOpenClosePane")&&ya.a.J(509613323,811,15,"Copilot Chat: Pane-IsOpen:"+a)}showTaskPane(a){if(this.x6)return 8;this.sB.ChatPPTSessionID=kh.a.create().toString();this.sB.PPTStoryTellerExecutionResponse=a?JSON.stringify(this.UOe):"[]";a=Object(md.a)("StoryTellerToSDXTransition")&&this.Ps?this.Ps:this.Ps=this.Fhe();if(!a)return 8;if(this.ZIa){const b=
this.ZIa.icb();a.nonPersistedSettings.PPTDocumentState=JSON.stringify({["isDocDirty"]:b.isDocDirty,["isCreateNew"]:b.isCreateNew,["isIrm"]:b.isIrm,["hasSection"]:b.hasSection,["slideCount"]:b.slideCount,["isCreateNewFromBlank"]:b.NDb})}this.ia.Ia(M.a.Aia,2,a);return 32}t5d(){this.x6&&this.jib?this.ia.Ia(M.a.Gxb,2,this.jib):this.x6=!1}UVa(){var a;if(null!==(a=this.Oc)&&void 0!==a&&a.instance)return a=this.Oc.instance.TO(this.NNg),null===a||void 0===a?void 0:a.zj;ya.a.J(509207495,811,10,"Copilot Chat: m_appForOfficeManager Instance is null")}M0i(a){ya.a.J(508904391,
811,15,"Copilot Chat: Like button clicked for {0}",a);this.bSb(!0,a)}L0i(a){ya.a.J(508904390,811,15,"Copilot Chat: Dislike button clicked for {0}",a);this.bSb(!1,a)}bSb(a,b){if(this.MLg)try{this.MLg.bSb(a,b,null)}catch(c){ya.a.J(508904389,811,10,"Copilot Chat: Feedback dialog failed to open with error={0}; isLikeDialog={1}; featureArea={2}",c.toString(),a,b)}else ya.a.J(509613464,811,10,"Copilot Chat: ActionAIFeedback is received as null")}B5l(a){a&&!Object(md.a)("pptCopilotSearch")&&(a=Object.assign(new BT.a,
{selection:Object.assign(new CT.a,{neighborhood:a,mentionStart:0,mentionLength:null===a||void 0===a?void 0:a.length}),launchData:Object.assign(new DT.a,{landingTab:Object(md.a)("pptCopilotSearchLandingTab")?"File":"All"}),entryPoint:Object(md.a)("Microsoft.Office.SharedOnline.ChangeGate.UseCopilotEntrypointForDeckGen")?uQ.a.Zhl:uQ.a.bLl}),this.ia.Ia(N.a.W5c,2,a),a=document.getElementById(this.UVa()),null==a&&ya.a.J(509196033,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.x6),a.contentWindow.postMessage({type:yq.ChatPPTSearchCompleted,
message:"1"},"*"))}Z4l(){this.Dld||(window.addEventListener("message",this.WVf),this.Dld=!0)}U5l(){this.Dld&&(window.removeEventListener("message",this.WVf),this.Dld=!1)}}Object(m.a)(FQ,"ActionAIActor",null,[948]);class GQ{constructor(a,b){this.Khm=(c,f,l,u,I)=>{if(1===l)return 32;c=this.ka.iFa?"DataSync: Fluid":"DataSync: Box4";I[xq.a.Value]=c;I[bn.a.labelText]=c;I[xq.a.Visible]=!0;return 32};if(!a||!b)throw da.ULS.sendTraceTag(509384847,844,10,"DataSyncActor:IActor: ActionManager or appSettings should not be null."),
Error.argumentNull("actionManager and appSettings cannot be null.");this.ia=a;this.ka=b}qb(){this.ia.pa(M.a.iyh,Le.a.frame,this.Khm,96)}Sd(){}}Object(m.a)(GQ,"DataSyncActor",null,[948]);class HQ{constructor(a){this.cjc=a}bSb(a,b,c){const f=this.lzj(b);f.initialFeedbackType=a?"Smile":"Idea";this.showDialog(f,a,b,c)}showDialog(a,b,c,f){function l(I){ya.a.J(508904388,811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",I,c,b);f&&f(I,c)}const u=this.nr;Gj.UISurfaces.$0c().then(I=>
{I.initializeFeedbackModal(a,l,u)})}nr(a){ya.a.J(509613318,811,10,"Error in submitting feedback: "+a)}lzj(a){var b={};A.AFrameworkApplication.fa.M2b(b);b=this.cjc.getContext(b)||{};b.uiType="Modal";b.screenshot=!0;b.showEmailAddress=!0;const c=b.telemetryGroup||{};c.processSessionId=b.sessionId;c.officeBuild=b.build;c.featureArea=a;b.telemetryGroup=c;return b}}Object(m.a)(HQ,"ActionAIFeedback",null,[]);var TT=d(1059),UT=d(1327);class IQ{constructor(a){this.n4a=(b,c,f)=>{var l;c=new TT.a(new Hc.a(()=>
ad.App.Ob?ad.App.Ob.ie.qj:null),Ha.InteractiveViewManager.instance,Tb.a.instance.ub("Box4.ISelectionFactory"),Tb.a.instance.ub("PowerPointWebEditor.ISlideReader"),Tb.a.instance.ub("PowerPointWebEditor.IPPTWorkspace"),Tb.a.instance.ub("PowerPointWebEditor.Graph.IGraphTopologyManager"),new UT.a,Tb.a.instance.ub("Common.IActionManagerExtended"),Tb.a.instance.ub("PowerPointWebEditor.IPptSelectionManager"),Tb.a.instance.ub("PowerPointWebEditor.IClipServiceManager"),Tb.a.instance.ub("PowerPointWebEditor.IPresentationReader"));
b=b===M.a.n4a?c.getSelectedSlidesAsPPTXStream():c.getAllSlidesAsPPTXStream();if(null===(l=null===b||void 0===b?void 0:b.selectedSlideIDs)||void 0===l||!l.length)return 16;if(1===f)return 2>b.selectedSlideIDs.length?16:32;this.ia.Ia(N.a.$5c,2,b);return 32};if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.qb()}qb(){this.ia.xa(M.a.n4a,wc.a.application,this.n4a);this.ia.xa(M.a.Dcf,wc.a.application,this.n4a)}Sd(){}}Object(m.a)(IQ,"AICopilotActor",null,[948]);var JQ=d(1079),VT=d(1042),WT=
d(1001),ox=d(992),XT=d(1084);class KQ{constructor(a,b,c,f,l,u,I){this.xid=[];this.rZj=()=>{this.xFl();this.submitOperation(this.VTa(this.getSelectedText()));return 32};this.mCb=(T,ja,ua,Ra,eb)=>{2==ua&&this.Ajb&&(T=JSON.stringify(this.xid[(Number(eb.SourceControlId.substring(eb.SourceControlId.length-1))-1).toString()].data),this.Ajb.OEi(T));return 32};this.Ige=()=>{const T=this.SLe.Ige();return JSON.stringify(T)};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("augLoopRunTimeManager");
if(!c)throw Error.argumentNull("pptSelectionManager");if(!f)throw Error.argumentNull("appOfficeManager");if(!l)throw Error.argumentNull("shapeReader");if(!u)throw Error.argumentNull("appSettingsManager");if(!I)throw Error.argumentNull("transformer");this.ia=a;this.xr=b;this.xr.execute(T=>{T.aM(ox.ActionRecommendationAnnotation.getTypeName());T.Z2(ox.ActionRecommendationAnnotation.getTypeName(),this.FM.bind(this))});this.gb=c;this.fGk=f;this.Ga=l;this.Lb=u;this.SLe=new WT.a(this.fGk,this.gb,this.Ga);
this.PPk=new XT.a(this.gb,this.Ga,this.Lb);this.Ajb=I;this.qb()}qb(){this.ia.xa(M.a.UIf,wc.a.application,this.mCb);this.ia.xa(M.a.VIf,wc.a.application,this.mCb);this.ia.xa(M.a.WIf,wc.a.application,this.mCb);this.ia.xa(M.a.XIf,wc.a.application,this.mCb);this.ia.xa(M.a.YIf,wc.a.application,this.mCb);this.ia.xa(M.a.ZIf,wc.a.application,this.mCb);this.ia.xa(M.a.HAh,wc.a.application,this.rZj)}Sd(){}FM(a){try{var b=a.modelResult;a=[];let c=1;this.xid&&(this.xid=[]);const f=[];for(let l of b)if(this.Lkk(l)){l=
JSON.parse(l);for(const u of l){const I=u.scenario;b=u;if(I){this.xid.push({query:I,data:b});const T="ActionRecommendation"+c.toString();f.push(T);appChrome.api.dispatch(appChrome.actions.setControlLabel(T,I.charAt(0).toUpperCase()+I.substr(1)));c++}}}a.push(appChrome.api.menuSection(f,"",null,null));appChrome.api.dispatch(appChrome.actions.updateMenu("RecommendationContextMenuFlyout",a))}catch(c){}}Lkk(a){try{JSON.parse(a)}catch(b){return!1}return!0}submitOperation(a){this.xr.execute(b=>{b.submitOperation(a)})}VTa(a){const b=
this.t_c();return Object.assign(new Uj.a,{parentPath:["Signal",ox.ActionRecommendationSignal.getTypeName()],items:[Object.assign(new sl.a,{body:Object.assign(new ox.ActionRecommendationSignal,{query:a,context:this.Ige(),useDirectLLMCall:!0,NEm:A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ContentRecommendationFetchImageEnabled",!1),trigger:"Paragraph"===b?ox.ActionRecommendationTrigger.TextSelection:"TextBoxSelection"})})]})}getSelectedText(){const a=JSON.parse(this.Ajb.EJj(ox.ActionRecommendationTrigger.TextSelection));
return a.shapeText?a.shapeText:a.selectedText}t_c(){const a=this.PPk.contentType.split(",");for(const b of a)if("Paragraph"===b||"SlideTextBox"===b||"SlideShape"===b)return b;return"Unknown"}xFl(){appChrome.api.dispatch(appChrome.actions.updateMenu("RecommendationContextMenuFlyout",[]))}}Object(m.a)(KQ,"SmartRecommendationActor",null,[948]);var LQ=d(991),MQ=d(986),NQ=d(989),OQ=d(1082),PQ=d(985),QQ=d(339),RQ=d(990);class SQ{constructor(a){this.$$k=()=>{};this.n4k=()=>{};this.Fbd=a;this.Fbd.ZLf(this.$$k);
this.Fbd.Kyi(this.n4k)}}Object(m.a)(SQ,"CopilotDesignerKeptRateTracker",null,[1805]);class TQ{constructor(a){this.t7k=()=>{};this.Fbd=a;this.Fbd.lzi(this.t7k)}}Object(m.a)(TQ,"CopilotDesignerSeenTracker",null,[1805]);class TG{constructor(){this.ua=new uc.a}wpl(){var a=new Sys.EventArgs;this.ua.raiseEvent("CDD",a)}Kyi(a){this.ua.addHandler("CDD",a)}lzi(a){this.ua.addHandler("CDN",a)}ZLf(a){this.ua.addHandler("CDU",a)}}Object(m.a)(TG,"CopilotDesignerMetricsEventSource",null,[1806,1807]);const UQ=ad.App.Ob;
class VQ{constructor(a){this.chk=!1;if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.eJg();this.oQg=document.getElementById("WACDocumentPanelContent");this.VHk=document.getElementById("WACDocumentPanel");this.pQg=document.getElementById("pptonline-sorter-view-id");this.X9j()}Sd(){}qb(){this.ia.xa(M.a.oDd,ta.a.view,this.oDd.bind(this));this.ia.xa(M.a.Vsd,ta.a.view,this.Vsd.bind(this))}X9j(){Object(Jh.b)(this,void 0,void 0,function*(){if(this.Sue())try{yield this.eJg(),this.c2h()&&ya.a.J(508441996,
822,50,"Switched to Dark mode as user preference was set true")}catch(a){ya.a.J(508629986,822,10,"Failed to load header api hence could not switch to dark mode on boot, given user preference was set true",a)}})}eJg(){return Object(Jh.b)(this,void 0,void 0,function*(){try{this.UHe=yield appChrome.getHeaderApi()}catch(a){ya.a.J(508442070,822,10,"Failed to load header api",a)}})}c2h(){return this.toggleSharedUXDarkMode()&&this.ram()&&this.yam()&&this.tam()?!0:(ya.a.J(508629985,822,10,"Failed to toggle Dark Mode"),
this.b2h(UQ),!1)}oDd(a,b,c){if(1===c)return 32;if(!this.c2h())return ya.a.J(508442069,822,10,"Failed to toggle Dark Mode"),8;this.Sue()?this.ILh(!1):this.ILh(!0);this.b2h(UQ);ya.a.J(508629983,822,50,"Switched to Dark mode");return 32}toggleSharedUXDarkMode(){if(!fh.a("toggleSharedUXDarkMode"))return ya.a.J(508610583,822,10,"Dark Mode Toggle failed as the API does not exist"),!1;if(!this.UHe||!this.UHe.hasOwnProperty("refreshThemeOverride"))return ya.a.J(508629984,822,10,"Dark Mode Toggle failed as either the header API or its property does not exist"),
!1;appChrome.api.toggleSharedUXDarkMode();this.UHe.refreshThemeOverride();return!0}ram(){if(!this.oQg)return ya.a.J(508610587,822,10,"Dark Mode toggle for canvas failed: the element could not be found"),!1;this.pDd(this.oQg);this.pDd(this.VHk);ya.a.J(508610586,822,50,"Switched Canvas to Dark mode");return!0}yam(){if(!this.pQg)return ya.a.J(508598022,822,10,"Dark Mode toggle for thumbnail pane and sorter view failed: the element could not be found"),!1;this.pDd(this.pQg);ya.a.J(508598021,822,50,"Switched new thumbnail pane and sorter view to Dark mode");
return!0}tam(){const a=document.getElementsByClassName("EditingNotesPanel EditMode");if(!a)return ya.a.J(508560033,822,10,"Dark Mode toggle for notes pane failed: the elements could not be found"),!1;if(1!==a.length)return!1;this.pDd(a[0]);ya.a.J(508560032,822,50,"Switched notes pane to Dark mode");return!0}pDd(a){a?a.classList.contains("DarkModeTheme")?a.classList.remove("DarkModeTheme"):a.classList.add("DarkModeTheme"):ya.a.J(508610585,822,10,"Dark Mode toggle failed: The specified element could not be found")}Vsd(a,
b,c,f,l){if(1===c)return 32;if(!l)return ya.a.J(508610584,822,10,"DarkModeActor::QueryDarkModeToggle requires actionData"),8;l[Xh.a.On]=this.Sue();return 32}b2h(a){a.OB({ToggleDarkMode:"ToggleButtonModel"})}Sue(){return Yi.a.YX("PPT_DarkModeOn",this.chk)}ILh(a){Yi.a.lL("PPT_DarkModeOn",a.toString(),Yi.a.VK)||ya.a.J(508442071,822,10,"Failed to set cookie for dark mode preference",a.toString())}}Object(m.a)(VQ,"DarkModeActor",null,[948]);class WQ{constructor(a,b,c,f,l,u,I){this.zV=this.Ega=null;this.clc=
!1;if(!b)throw Error.argumentNull("actionManager");if(!c)throw Error.argumentNull("viewPanelContainer");if(!f)throw Error.argumentNull("activeSlideViewManager");if(!l)throw Error.argumentNull("browserHelper");if(!u)throw Error.argumentNull("presentationReader");if(!a)throw Error.argumentNull("appFrame");if(!I)throw Error.argumentNull("viewCoreEventHandlers");this.ia=b;this.yba=c;this.Jc=f;this.Ye=l;this.Wb=u;this.Db=a;this.DF=I}Sd(){}qb(){this.ia.xa(M.a.CAd,ta.a.view,this.CAd.bind(this));this.ia.xa(M.a.ctd,
ta.a.view,this.ctd.bind(this))}bhe(a){return Math.round(a*window.devicePixelRatio)+0}CAd(a,b,c){return 1===c?32:this.clc?this.Vcj():this.Fwl()}ctd(a,b,c,f,l){if(!l)return 8;l[Xh.a.On]=this.clc;return 32}v2h(a){a.OB({ShowHideGridlines:"ToggleButtonModel"})}Fwl(){this.Db.WZd(this.Myc.bind(this));this.DF.Y2b(this.Myc.bind(this));this.Myc()}Vcj(){var a,b;this.clc&&(this.clc=!1,this.v2h(ad.App.Ob),this.Db.m3e(this.Myc.bind(this)),this.DF.Kvc(this.Myc.bind(this)),null===(a=this.Ega)||void 0===a?void 0:
a.removeChild(this.zV),null===(b=this.yba)||void 0===b?void 0:b.removeChild(this.Ega),this.Ega=this.zV=null)}Myc(){ya.a.J(508428323,822,50,"showGridlines function is called");this.rui();var a=this.Ye.wi(this.Jc.Ic.Oy);const b=this.bhe(a.width)/(Re.a.Ov(this.Wb.Fn.$a(yb.a.slideWidth))/1);this.ROl(this.zV,a.height,a.width);this.sim();a=this.zV.getContext("2d");this.s7f(this.zV.height,this.zV.width,b,a,!0);this.s7f(this.zV.height,this.zV.width,b,a,!1);this.clc=!0;this.v2h(ad.App.Ob)}rui(){this.Ega=this.K3i();
this.Ega.appendChild(this.J3i());this.yba.appendChild(this.Ega)}K3i(){if(this.Ega)return this.Ega;this.Ega=document.createElement("div");this.Ega.id="gridlinesContainerDiv";this.Ega.style.pointerEvents="none";return this.Ega}J3i(){if(this.zV)return this.zV;this.zV=document.createElement("canvas");this.zV.id="gridlinesCanvasDiv";this.zV.style.position="relative";this.zV.style.zIndex="9999";return this.zV}s7f(a,b,c,f,l){f.strokeStyle="black";f.lineWidth=1;f.setLineDash([4,16]);const u=l?b/2:a/2;for(let I=
0;u+I*c<=(l?b:a);I++)l?(this.v7f(u+I*c,a,f),this.v7f(u-I*c,a,f)):(this.t7f(u+I*c,b,f),this.t7f(u-I*c,b,f))}v7f(a,b,c){c.beginPath();c.moveTo(a,0);c.lineTo(a,b);c.stroke()}t7f(a,b,c){c.beginPath();c.moveTo(0,a);c.lineTo(b,a);c.stroke()}ROl(a,b,c){if(a=a.getContext("2d")){var f=window.devicePixelRatio;c=this.bhe(c);b=this.bhe(b);if(a.canvas.height!==b||a.canvas.width!==c)a.canvas.width=c,a.canvas.height=b,a.canvas.style.width=c/f+"px",a.canvas.style.height=b/f+"px"}}sim(){const a=this.Jc.Ic;a&&a.Oy&&
window.requestAnimationFrame(()=>{const b=Sd.a.qGa(a.Oy),c=Sd.a.qGa(this.yba),f=document.getElementById("WACHorizontalRuler");this.zV.style.marginLeft=this.Ye.Rc(b.x-c.x+1);this.zV.style.marginTop=this.Ye.Rc(b.y-c.y+1-(f?f.offsetHeight:0))})}}Object(m.a)(WQ,"GridlinesActor",null,[948]);class XQ{constructor(){this.BZg=this.oRg=this.tjd=this.vIe=this.wIe=this.sOe=this.oB=this.aoa=this.K=null}get name(){return"PowerPointWebEditor.Actor"}fc(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");
a.resolve("PowerPointWebEditor.IApplicationSettings").Kjk?a.register(1745,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new NP(new mG(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").uEb,a.resolve("PowerPointWebEditor.IApplicationSettings").FEg,
a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(1745,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new mG(a.resolve("Box4.IFormattingEditor")));md.a("EnhancementOfSDXPaneBootTime")&&a.register(JQ.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").na(()=>new JQ.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();a.register(1746,"PowerPointWebEditor.IGraphTransactionHelper").ma().na(()=>new xO(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Ha("PowerPointWeb.Comments.ICommentFrame")));a.register(1747,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().na(()=>
new KO(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(1748,"Box4.IInsertionPointFormatting").ma().na(()=>new qQ(a.ub("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").r8c));a.register(1749,"Box4.IClipboardCommands").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?
new jG(A.AFrameworkApplication.Pa,M.a.qvh,M.a.esd,M.a.fsd,M.a.Avh):new jG(A.AFrameworkApplication.Pa,G.a.l4b,G.a.gQc,G.a.F9,G.a.ird));a.register(1750,"HtmlImport.IHtmlNormalizerSettings").ma().na(()=>new mE(!1,a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled")));a.register(1751,"HtmlImport.IHtmlTranslatorSettings").ma().na(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new aE(c.bEg&&a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("ListMarkerIsEnabled"),
void 0,void 0,void 0,!1,c.pptCopyPasteTextWithHighlight,void 0,c.pptCopyPasteMarginAndIndentationEnabled,a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,f=>f.vec&&c.Jwe,()=>c.Xwe,()=>!0)});a.register(1752,"Box4.Actors.IBox4PasteStewardBridge").ma().na(()=>new PP(a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(iG.a,"Common.PressOnlyKeyEvent").ma().na(()=>iG.a.instance());a.register(IG,"PowerPointWebEditor.PasteFromFloatieArgs").ma().na(()=>new IG);a.register(1753,"PowerPointWebEditor.IPasteFloatieHelper").ma().na(()=>new RP(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),
a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").HEa));
a.register(kG,"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().na(()=>new kG);a.register(320,"Box4.IContextSetEditor").ma().na(()=>Uh.ContextSetEditor.instance);a.register(1754,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().na(()=>new OP(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));
a.register($t,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().na(()=>new $t(a.ub("Box4.IAutoCorrectScheduler"),a.ze("Box4.IUndoManager"),a.Ha("Box4.IExternalSelectionManager")));a.register(HG,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().na(()=>new HG(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(1755,"Box4.Actors.IEopFormattingStrategy").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").Efb?
Object(gb.a)(1755,new DP):Object(gb.a)(1755,new ZN));a.register(1756,"Box4.ISelectAllHandlers").ma().na(()=>new Ls(Iu.PageReader.instance,a.ze("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(1757,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().na(()=>new BP(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(1631,"Box4.IFormatPainterStrategy").ma().na(()=>new EP(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(1758,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>new AP);a.register(1759,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new CP(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(1760,"PowerPointWebEditor.IUploadFrameFactory").ma().na(()=>new pQ(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IApplicationSettings").Hik));a.register(1761,"PowerPointWebEditor.IPictureUploaderHelper").ma().na(()=>new oQ(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1762,"PowerPointWebEditor.IPictureUploader").ma().na(()=>new nQ(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),
a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1763,"PowerPointWebEditor.IChunkedPictureUploader").na(()=>new kx(a.resolve("Common.ITaskManager"),()=>{$c.a.iIa()},Object(R.a)(bo.a.instance,bo.a.instance.C$a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));
a.register(1764,"PowerPointWebEditor.IWarningDialog").ma().na(()=>new aQ);a.register(1065,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().na(()=>new nT.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").va));a.register(1765,"PowerPointWebEditor.IDataUploader").na(()=>new rQ(a.resolve("Common.ITaskManager"),()=>{$c.a.iIa()},Object(R.a)(bo.a.instance,bo.a.instance.C$a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(1766,"PowerPointWebEditor.IPastedDataUploader").ma().na(()=>new XP(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(771,"PowerPointWebEditor.IMediaUploader").na(()=>new zT.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
()=>{$c.a.iIa()},bo.a.instance.C$a.bind(bo.a.instance)));a.register(1767,"PowerPointWebEditor.ISystemClipboard").ma().na(()=>new ZP(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1768,"PowerPointWebEditor.IInternalClipboard").ma().na(()=>new MP(a.resolve("PowerPointWebEditor.IApplicationSettings").eCg?
a.resolve("Box4.Graph.IGraphInstance").Cd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").eCg?a.resolve("Box4.Graph.IGraphInstance").Cd(8):null));a.register(1769,"PowerPointWebEditor.ICutCopyManager").ma().na(()=>new KP(a.resolve("PowerPointWebEditor.IDesignModeManager").HEa,[new YP(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").HEa,a.ze("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").Sfk,a.resolve("PowerPointWebEditor.IApplicationSettings").Ngk,a.resolve("PowerPointWebEditor.IApplicationSettings").Rfk,
a.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("ClipServiceCopySelectiveImages"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("UseToastForDeferredBlobsEnabled"),A.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").eGa,
a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager")),new Ns(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").HEa,a.ze("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),
a.resolve("PowerPointWebEditor.IApplicationSettings").Tfk,a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("UseToastForDeferredBlobsEnabled"),A.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(1770,"PowerPointWebEditor.IPasteManager").ma().na(()=>new ph(a.ze("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").HEa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new TP(a.resolve("Common.IActionManagerExtended"),
a.ze("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").wue,a.resolve("PowerPointWebEditor.IApplicationSettings").GEg),new UP(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").xue),new qT.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").onk,a.resolve("PowerPointWebEditor.IApplicationSettings").Zok,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),
new yz(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new gC(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),A.AFrameworkApplication.YR),new JG(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],
a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));a.register(1320,"PowerPointWebEditor.ICopyPasteUtility").ma().na(()=>new qr.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(1771,"PowerPointWebEditor.IPasteHandlerUtil").ma().na(()=>new SP);a.register(1772,"PowerPointWebEditor.IClipboardHelper").ma().na(()=>new oG.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),
b.gWa().$k||wq.a.x5h,a.resolve("Common.IAppSettingsManager").Ea("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").tc("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1773,"PowerPointWebEditor.IClipServiceManager").ma().na(()=>new JP(b.gWa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1774,"Box4.TableEditors.ITableStylePreviewGenerator").ma().na(()=>
new rr(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),ZB.n2f,c=>new OF(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),c=>new LF(c),a.resolve("PowerPointWebEditor.IApplicationSettings").Rba));a.register(1775,"Box4.TableEditors.ITableStyleRibbonControls").ma().na(()=>new tP(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(1776,"Common.App.ImageProcessor.IImageProcessor").ma().na(()=>new YN(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));a.register(1777,"PowerPointWebEditor.IPPTFileReaderHelper").ma().na(()=>new tQ);a.register(1778,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().na(()=>
new jC(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(1779,"PowerPointWebEditor.ILocalImageViewFactory").ma().na(()=>new iQ(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Geb));a.register(1780,"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().na(()=>new kQ);a.register(1210,"PPTe.IColorPickerBuilderFactory").ma().na(()=>new aT.a);a.register(1781,
"PowerPointWebEditor.IFileApiHelper").ma().na(()=>new sQ);a.register(1782,"PowerPointWebEditor.IInsertImageHelper").ma().na(()=>new IO(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(lG,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().na(()=>new lG(a.resolve("Box4.Styles.IStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),
a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),mi.a.instance,a.ub("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(1783,"PowerPointWebEditor.IFormatPainter").ma().na(()=>new eQ(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").Cd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(1784,"PPTe.IResourceViewElementResolver").ma().na(()=>new IP(b.gWa(),ad.App.webServiceBase));a.register(1785,"PowerPointWebEditor.IOfflineModalCallout").ma().na(()=>new fQ(a.resolve("Box4.IAppFrame")));a.register(1786,"PowerPointWebEditor.IPPTOfflineManager").ma().na(()=>new $P(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));a.register(1787,"PowerPointWebEditor.IClipboardTelemetry").ma().na(()=>new mv.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").Cd(8),a.resolve("Box4.Graph.IGraphInstance").Cd(10),a.resolve("Box4.Graph.IGraphInstance").Cd(12),a.resolve("Box4.Graph.IGraphInstance").Cd(60),a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",
!1)&&(a.register(QQ.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").ma().na(()=>new QQ.a(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.ICharacterPropertiesEditor"))),a.register(PQ.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").ma().na(()=>new PQ.a(a.Ha("PowerPointWebEditor.AppForOfficeManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),a.register(MQ.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").ma().na(()=>new MQ.a(a.Ha("PowerPointWebEditor.AppForOfficeManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
a.resolve("PowerPointWebEditor.IRibbonChangeManager"))),a.register(NQ.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").ma().na(()=>new NQ.a(a.Ha("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),a.register(OQ.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").ma().na(()=>
new OQ.a(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),a.register(RQ.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").ma().na(()=>new RQ.a(a.Ha("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"))),a.register(LQ.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").ma().na(()=>
new LQ.a(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));
a.register(TG,"PowerPointWebEditor.ICopilotDesignerMetricsEventNotifier").as("PowerPointWebEditor.ICopilotDesignerMetricsEventListener").ma().na(()=>new TG)}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.nU;var f=b.Qp;const l=c.td;var u=f.llb;const I=a.resolve("Common.IActionManagerExtended"),T=a.resolve("PowerPointWebEditor.IFrameContext"),ja=a.resolve("PowerPointWebEditor.IFocusManager");var ua=a.resolve("PowerPointWebEditor.IFormatPainter");const Ra=a.resolve("PowerPointWebEditor.CoauthManager"),
eb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),Bb=Tb.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Ub=Tb.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Xb=Tb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),tc=Tb.a.instance.resolve("Box4.ISelectionManager"),lc=Tb.a.instance.Ha("Box4.IExternalSelectionManager"),Ec=Tb.a.instance.resolve("PowerPoint.IPathManager");var hd=Tb.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");
const yd=f.ie,Pd=Tb.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=Tb.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const pe=Tb.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Se=Tb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),vf=Tb.a.instance.resolve("PowerPointWebEditor.INotesView"),ug=Tb.a.instance.resolve("Box4.IFormatPainter"),Tg=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),$f=a.resolve("Common.Transaction.ITransactionFactory"),
Ve=a.resolve("PowerPointWebEditor.IPresentationReader"),xg=a.resolve("PowerPointWebEditor.IShapeReader"),yg=a.resolve("PowerPointWebEditor.Graph.ITableReader"),ng=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),Wh=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var Ai=a.resolve("PowerPointWebEditor.ITableEditor");const Wf=Tb.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),gg=Tb.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),vh=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
Zj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),qj=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),Ok=Tb.a.instance.resolve("Box4.List.IListReader"),Wl=a.resolve("Box4.Graph.IGraphIteratorFactory"),Rm=a.resolve("PPTe.IColorPickerBuilderFactory"),Pk=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.aoa=Tb.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.oB=Tb.a.instance.resolve("PowerPointWebEditor.IPasteManager");const Xl=Tb.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),
wk=Tb.a.instance.resolve("PPTe.IResourceViewElementResolver");Tb.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");Tb.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const Qk=Tb.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),qk=Tb.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Hl=a.resolve("Common.Utils.IHighContrastDetector"),Qh=Tb.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Il=a.resolve("PowerPointWebEditor.IRibbonUser"),
ym=a.resolve("Box4.CloudFontService"),on=a.resolve("Box4.CustomFontService");this.sOe=new Mj(I,Bb,ja,T.LCID,Xb,$f,gg,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ve,new dQ(Tb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Tb.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),Xl,l,wk);this.wIe=new el(gg,I,ja,Xb,Bb,Pk,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Pd,Wf,qk,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.Ha("PowerPointWebEditor.IInsertShapeOverlayViewElement"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),
a.resolve("Box4.Graph.IGraphInstance").Cd(10));this.vIe=new lC(gg,I,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Bb,Pk,a.resolve("Box4.Graph.IGraphInstance").Cd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,Pd,Wf,qk,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));hd=new nO(I,ja,a.resolve("PowerPointWebEditor.IPptSelectionManager"),yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
$f,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),hd,Bb,this.aoa,this.oB,a.resolve("PowerPointWebEditor.IDesignModeManager").HEa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Ve,Wf,Pk,a.resolve("PowerPointWebEditor.IWarningDialog"),(zg,ci,Oh,Yd,tf,Of,De,nh,Zi)=>new RO(zg,ci,Oh,Yd,tf,Of,De,nh,Zi),qk,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),
a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),a.resolve("Box4.ITextPasteFloatieManager"),Tb.a.instance.resolve("Box4.IPasteFloatieEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(10),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.IUndoManager"));
const ml=new $i(I,ja,$f,u,ua,Bb,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),ug,Tg,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),Hl,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Na),nl=new QO(I,Bb,T,$f,Xb,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));u=new zO(I,$f,Xb,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),T,a.resolve("PowerPointWebEditor.IApplicationSettings"));ua=[new dO(I),hd,new zz(I,l,A.AFrameworkApplication.fa.getBooleanAppSetting("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),ja,Bb,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),$f,vh,yd,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Pk,qk,a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Qk,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.oB,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new qO(I,Tb.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),Ub,a.ze("PowerPointWebEditor.IContextMenuUser"),yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),ja,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
l),new rO(I,Xb,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.Tvh,l.INb,l.enableCameoInEditor,l.getBooleanAppSetting("PictureBGREnabled")),...(l.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.DarkModeEnabled",!1)&&l.Cm?[new VQ(I)]:[]),new yP(I,l,ut.a.wBb,Wl,a.resolve("Box4.IParagraphReader")),...(l.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.GridlinesFeatureEnabled",!1)?[new WQ(f,I,f.WUb,
a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))]:[]),new zP(kv.instance),this.wIe,this.vIe,u,new Bz(I,Bb,ja,T.notesPane,vf,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),T,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,Tb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView")),
new PO(I,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),nl,new XO(I,T,Il,ja,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").getBooleanAppSetting("AltForKeytipEnabled")),new $O(I,Bb,ja,Ub,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
ua,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.RD,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.iR,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.v$a),ml,new eP(I,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Bb,$f,ja,Xl,wk,Xb,xg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new ex(gg,I,ja,Bb,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),xg,!!ym&&ym.isEnabled,!!on&&on.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new fP(gg,I,ja,Bb,Xb,xg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),$f,l.Ywe,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.sOe,new gP(I,Bb,$f,gg,ja,Xb,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Ve,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ICopilotDesignerMetricsEventNotifier")),new hP(I,Ub,ja,Bb,gg,yd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ve,pe,(zg,ci)=>new yT.a(zg,ci),a.resolve("PowerPointWebEditor.IPptSelectionManager"),l.RD,
l.Zwe),new kP(I,Bb,Xb,$f,ja,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pd,Ve,Wf,Pk,qk,a.resolve("PowerPointWebEditor.IShapeReader")),new mP(()=>Se,new nP(tc,ut.a.wBb,a.resolve("Box4.IContextSetEditor")),lc,l),new uP(I,Bb,l,ja,Xb,Se,a.Ha("PowerPointWebEditor.IAppForOfficeManager"),a.ze("PowerPointWebEditor.IAppforOfficeClassFactory"),Pk,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ha("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Ha("PowerPointWebEditor.IAudioManagerStore"),this.K.Ha("PowerPointWebEditor.EditSurfaceLayoutManager")),new HP(I,a.Ha("PowerPointWebEditor.ICommentsPane"),ja,a.resolve("Common.IF6Manager"),Xb,Zj,Bb,Ec,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Ve,a.resolve("PowerPointWebEditor.IWindowUtils"),A.AFrameworkApplication.fa,l,b,c.gWa(),eb,pe,Tb.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),Tb.a.instance.resolve("Box4.Graph.IGraphInstance").Cd(7),Tb.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),Tb.a.instance.resolve("Common.ITaskManager"),A.AFrameworkApplication.Me,Tb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),Tb.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ha("PowerPointWeb.Comments.ICommentFrame"),
a.Ha("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),Qh,Tb.a.instance.Ha("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),l.Cm?a.ze("PowerPointWebEditor.ISorterViewActorLazy"):null)];Ai=new pv(I,Wl,Bb,ja,Ok,xg,yg,Wh,ng,Wf,Ai,l,$f,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Xb,
qk,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Il,a.resolve("Box4.Styles.ITableStyleReader"));
ua.push(new nv(I,Xb,ja,Ok,a.resolve("Box4.ILineSpacingHelper"),$f,qj,Wl,ad.App.uOa.BTc(12),ad.App.uOa.BTc(10),xg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),l.Ywe,l.isPromoteDemoteOnParagraphEnabled,Rm,l.r8c,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),ug,f,yd,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),
a.resolve("Box4.IInsertionPointFormatting"),Tg,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").enb));ua.push(Ai);f=new FG(I,ja,xg,gg,Bb,Xb,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));ua.push(f);l.SDl&&ua.push(new VO(I,ja,a.resolve("PowerPointWebEditor.IPresentationReader")));l.qjl&&ua.push(new oO(I,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.gTb||l.jpb)&&ua.push(new ix(I,
l,$f,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Xb,yg,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.zsi&&ua.push(new cO(Xb,A.AFrameworkApplication.fa,l,Object(R.a)(TB.App.fvb,TB.App.fvb.leg,"forceUpdateRibbonControls")));md.a("EnhancementOfSDXPaneBootTime")&&ua.push(new VT.a(l,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),I,yd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
$f,this.K.ze("PowerPointWebEditor.IClassFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory"),this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),Wl,Bb,qk));l.getBooleanAppSetting("CopilotDesignerEnableMetricsTracker")&&(new SQ(this.K.resolve("PowerPointWebEditor.ICopilotDesignerMetricsEventListener")),new TQ(this.K.resolve("PowerPointWebEditor.ICopilotDesignerMetricsEventListener")));l.BVh&&ua.push(new IQ(I));l.ebf&&ua.push(new KQ(I,this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ha("PowerPointWebEditor.IAppForOfficeManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Common.IAppSettingsManager"),a.resolve("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations")));md.a("DataSyncModeOnStatusBar")&&"inner"===A.AFrameworkApplication.fa.Ea("Microsoft365Ring")&&ua.push(new GQ(I,l));for(const zg of ua)zg.qb(),zg.Sd();Tb.a.instance.Ha("PowerPointWebEditor.ISorterViewActorMain").execute(zg=>{zg.qb()});
a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").oIi(new lQ(a.resolve("Common.ITaskManager"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const Bi=this;A.AFrameworkApplication.fa.Ue(()=>{const zg=zs.a(a),ci=[new GP(I,Bb,Xb,ja,Se,l.Nlk,Ra,yd.Of,a.Ha("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),
a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],Oh=A.AFrameworkApplication.fa.getBooleanAppSetting("LiveSubtitlesEnabled");l.vna&&Oh&&ci.push(new Ez(I,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Qh));Bi.tjd=new YO(I,gg,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Cd(7),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPresentationReader"),Xb,a.resolve("PowerPointWebEditor.IApplicationSettings").Cm,a.resolve("PowerPointWebEditor.IApplicationSettings").RD);ci.push(Bi.tjd);ci.push(new bP(I,Xb,Pk,a.resolve("PowerPointWebEditor.IApplicationSettings").Lma));ci.push(new aP(zg,Xb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),I,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
ja,a.resolve("PowerPointWebEditor.View.ISelectionPane"),ml,nl,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),T,xg,a.resolve("Box4.IPageView").Na,a.resolve("Common.Transaction.ITransactionFactory")));ci.push(new tO(zg,Xb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),I,ja,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),xg,l.Jqj,l.eWl,l.Lma,a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings")));
ci.push(new vO(Xb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),I,ja,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),zs.a(this.K),yg,Wh,ng));l.cEg?
ci.push(new GO(zg,Xb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),I,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),$f,l.NYe)):ci.push(new DO(zg,Xb,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),I,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
ja,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),$f,l.NYe));ci.push(new pO(zg,I,ja,yd));l.powerPointSmartLookupIsEnabled&&ci.push(new HO(gg,I,yd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Bb));l.njl&&ci.push(new gO(zs.a(this.K),I,a.resolve("PowerPointWebEditor.ISubtitleContext"),
a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));ci.push(new eO(I,Xb,ja,$f,a.Ha("PowerPointWebEditor.IAudioManagerStore"),l.iR,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));ci.push(new bO(I,Xb,$f,yd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),Il,l.bsi,l.Cnm,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));l.tjl&&ci.push(new OO(zs.a(this.K),l.rjl,l.sjl,I,Bb,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Xb,qk));l.pptoCaptionDiscoverabilityPaneEnabled&&ci.push(new bx(zs.a(this.K),I,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),
a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.ojl));Bi.oRg=new sO(I,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),$f,a.resolve("Box4.Graph.IGraphInstance").Cd(82));ci.push(Bi.oRg);md.a("PptJOfcBrowserGraphNode")&&(Bi.BZg=new MO(I,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),$f,a.resolve("Box4.Graph.IGraphInstance").Cd(83)),
ci.push(Bi.BZg));for(const Yd of ci)Yd.qb(),Yd.Sd();Qh.q9b=Oh});a.resolve("PowerPointWebEditor.ICopilotEnableStateChecker").Lge().then(zg=>{0===zg?(zg=l.getBooleanAppSetting("CopilotStartMasterSwitch")&&l.getBooleanAppSetting("CopilotStartLicenseCheckEnabled"),this.w1i(l,zg).qb()):ya.a.J(508565586,817,50,`CopilotChat was disabled by ${zg}`)});(new UO(c.bI(),c.aie(),b,Zj,Xb,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).qb()}dispose(){this.aoa.dispose();
this.oB.dispose();this.sOe.dispose();this.wIe.dispose();this.vIe.dispose();this.tjd&&this.tjd.dispose();const a=this.K.Ha("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}w1i(a,b){var c=null;Object(md.a)("EnableFeedbackInChatPPTMode")&&(c=this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),c=new HQ(c));let f=!1;Object(md.a)("NewSettingsForChatPPT")&&(f=a.tqk);return new FQ(this.K.resolve("Common.IActionManagerExtended"),this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
c,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ICopilotProxy"),a.Cm?this.K.ze("PowerPointWebEditor.ISorterViewActorLazy"):null,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b?this.K.resolve("PowerPointWebEditor.IStorytellerEventListener"):null,Object(md.a)("CreatePresentationEnabledState")?this.K.resolve("PowerPointWebEditor.ICreatePresentationEnabledState"):
void 0,Object(md.a)("DocumentStateTrackerEnabled")?this.K.resolve("PowerPointWebEditor.ICopilotDocumentStateTracker"):void 0,this.K.Ha("Common.App.Policy.Contracts.IPolicyManager"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b,this.K.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"))}}Object(m.a)(XQ,"ActorPackage",null,[2,3]);class YQ{constructor(a,b,c,f,l,u,I,T,ja,ua){this.KI=!1;this.Yb=a;this.sa=b;this.Wf=c;this.HC=f;this.Tb=l;this.Iw=u;this.zb=
I;this.Lxa=T;this.Ybh=ja;this.Nc=ua;this.RMe=[0,1,2,3];this.U6=new Md.a;for(const Ra of this.RMe)this.U6.$(Ra,[]);this.U6.$(4,[]);this.Wf.HJ(Object(R.a)(this,this.XC,"onActiveSlideChanged"));this.Lxa.Ak(Object(R.a)(this,this.jpd,"onMainMastersLoaded"));this.Ybh.Pka(Object(R.a)(this,this.JVe,"onSlideLoaded"));this.Ybh.Ak(Object(R.a)(this,this.Upa,"onSlidePropertyChanged"));this.Nc.aC(Object(R.a)(this,this.GN,"onSessionClosed"));this.Nc.D9a(Object(R.a)(this,this.Nha,"onSessionRehydrating"));this.Nc.bC(Object(R.a)(this,
this.mo,"onSessionRehydrated"));this.v9g=new nz(Object(R.a)(this,this.Pjl,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.zb,3);this.u9g=new nz(Object(R.a)(this,this.Ojl,"prefetchSlideMasterImage"),250,6E4,8E3,500,"slide master image",this.zb,3);this.XC(null,null)}XC(){this.ybe()}ybe(){const a=this.sa.Aa;a&&8===a.type&&a.Qa(yb.a.Oj)&&a.Qa(yb.a.xo)&&this.pem(a.Oj,a.xo)}Pjl(){if(!this.KI){var a=this.U6.ga(0),b=this.U6.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.Oqk(f.first,
f.second)&&(Array.removeAt(a,c),Array.add(b,f),this.v9g.ECd(),this.Iw.Njl(f.first,f.second))}}}Ojl(){if(!this.KI){this.IDd(1,2,c=>!!this.Tb.zbb(c.first,c.second));var a=this.U6.ga(2);if(0<a.length){const c=a[0];var b=this.Tb.zbb(c.first,c.second);b&&this.h$e(b)?(b=b.TCb(new Rr.a(b.yq,b.yl)),this.u9g.ECd(),Array.removeAt(a,0),Array.add(this.U6.ga(3),c),this.HC.$zb(b,!0,()=>{this.IDd(3,4,f=>!this.h$e(this.Tb.zbb(f.first,f.second)));this.u9g.ACd()})):(Array.removeAt(a,0),Array.add(this.U6.ga(4),c))}this.IDd(3,
4,c=>!this.h$e(this.Tb.zbb(c.first,c.second)))}}nXf(){for(const a of this.RMe)Array.clear(this.U6.ga(a));Array.clear(this.U6.ga(4))}JVe(a,b){(a=Object(gb.a)(205,b.node))&&a.kF&&this.Sqc(a)}Upa(a,b){a=b.property;b.node&&a===yb.a.xo&&b.node===this.sa.Aa&&this.ybe()}Sqc(a){if(this.Lqk(a)&&a){const b=a.Oj,c=a.xo;b&&c&&(this.IDd(1,2,f=>f.first===b&&f.second===c),this.v9g.ACd())}}jpd(a,b){a=b.property;if(a===yb.a.cLb||a===yb.a.b_)this.nXf(),this.ybe()}GN(){this.KI=!0}Nha(){this.nXf()}mo(){this.KI=!1}pem(a,
b){this.Mqk(a,b)||this.Nqk(a,b)||Array.add(this.U6.ga(0),new Zh.a(a,b))}Nqk(a,b){for(const c of this.RMe)for(const f of this.U6.ga(c))if(f.first===a&&f.second===b)return!0;return!1}Mqk(a,b){for(const c of this.U6.ga(4))if(c.first===a&&c.second===b)return!0;return!1}IDd(a,b,c){a=this.U6.ga(a);b=this.U6.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}h$e(a){if(!a)return!1;a=a.TCb(new Rr.a(a.yq,a.yl));if(null===a)return!1;for(const b of a)if(!this.HC.odc.vwc(b).data)return!0;
return!1}Lqk(a){const b=this.Yb.Of.ra(yb.a.USh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}Oqk(a,b){var c=this.Tb.YJ();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(m.a)(YQ,"SlideMasterPrefetchManager",null,[837]);var YT=d(1004);class ZQ{constructor(a,b,c,f,l,u,I){this.Mb=!1;this.RY=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");
if(!u)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.zb=u;this.Zu=a;this.Db=b;this.fv=c;this.Pw=f;this.xd=l;this.EVg=I;this.LQk=new ne.a(0,1,0,Object(R.a)(this,this.fDl,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Mb}B1l(){if(!this.Mb&&this.Zu&&this.Zu.va){this.RY=this.eKi();this.EVg||this.Zu.va.appendChild(this.RY);this.Zu.setVisibility(!0);this.EVg&&this.xd.ELf(Object(R.a)(this,this.rod,"onCommentContainersChanged"));
var a=new YT.a(!0);this.Pw.azh(a);this.Db.rLa(1);this.Mb=!0}}rod(){this.Db.pOc(Object(R.a)(this,this.NEh,"renderCommentShimmerOnSlideResize"));this.xd.kBl(Object(R.a)(this,this.rod,"onCommentContainersChanged"))}NEh(){this.zb.Jb(this.LQk);this.Db.qvd(Object(R.a)(this,this.NEh,"renderCommentShimmerOnSlideResize"))}fDl(){!this.RY||this.Fag()?ya.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.Zu.va.appendChild(this.RY)}qvg(){if(this.Mb&&this.Zu&&
this.Zu.va&&this.Fag()){this.Zu.va.removeChild(this.RY);this.RY=null;this.Mb=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();ya.a.J(523352018,809,50,Qa.a.toJSON(a))}}Alj(){this.Mb&&this.Zu&&this.Zu.va&&(this.RY.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(R.a)(this,this.qvg,"hideShimmerUX"),600))}eKi(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.fKi());return a}fKi(){const a=document.createElement("div");
a.className=this.fv?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const u=document.createElement("div");u.className="CommentShimmerActionStyles";
a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(u);return a}Fag(){return!!document.getElementById("CommentShimmerContainer")}}Object(m.a)(ZQ,"CommentShimmerView",null,[838]);class UG{constructor(a,b){this.Db=a;this.Iya=b;this.Iya.iMf(Object(R.a)(this,this.tJh,"scaleOnUIChanged"))}dispose(){this.Iya.sEh(Object(R.a)(this,this.tJh,"scaleOnUIChanged"))}getName(){return"UpdateCommand"}JZ(){}IZ(a){2===a.behavior&&(a=a.actionId,a!==M.a.S2&&a!==M.a.R2&&a!==M.a.Q2&&a!==M.a.Ypa||
this.Gf())}tJh(){this.Gf()}Gf(){this.Db.Gf()}}Object(m.a)(UG,"UpdateCommandUIActionListener",null,[182,106]);class VG{constructor(){this.correlationId=this.sessionId=this.uTd=null;this.actionId=0;this.Bd=null}get Mf(){return this.uTd?this.uTd:""}set Mf(a){this.uTd=a}}Object(m.a)(VG,"AssistanceSearchVariableUrlParameterSet",null,[]);class Yr{constructor(){this.RQ=!1;this.QQ=!0;this.QEf=this.EVb=null}get isInitialized(){return this.RQ}initialize(a,b){const c=!!a&&!!b;c&&(this.EVb=a,this.QEf=b);this.RQ=
c;A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>{f.UO("Enabled").then(l=>{this.QQ=l;return null},()=>null)})}qb(a){a||(a=A.AFrameworkApplication.Pa);A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)&&(this.QQ=A.AFrameworkApplication.XF,Tb.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",!0).then(c=>{this.QQ=A.AFrameworkApplication.XF&&c;(c=A.AFrameworkApplication.za)&&c.Gf();return null},()=>null)}));a.xa(N.a.mQb,Le.a.frame,Object(R.a)(this,this.y1l,"showSearchResults"))}y1l(a,b,c,f,l){if(1===c)return A.AFrameworkApplication.fa.getBooleanAppSetting("IsFeedbackExperiencesAvailable")||(this.QQ=!1),l&&"SourceControlId"in
l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.QQ)?8:zB.SessionStatusManager.instance.Oma?8:32;da.ULS.sendTraceTag(4761738,1302,50,"");He.a.mark(4771);if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new VG,{actionId:N.a.mQb,Bd:l});if(void 0!==a&&null!==a)l=Yr.RQj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=
N.a.w5;break;case "btnContactSupport":case "ContactSupport":l.actionId=N.a.s6d;break;case "btnShowTraining":case "Training":l.actionId=N.a.dZh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=N.a.I5h}this.EVb.D_l(this.QEf,l);He.a.mark(4772);return 32}He.a.mark(4772);return 8}dispose(){this.EVb&&(this.EVb.dispose(),this.EVb=null)}static get instance(){Yr.Ja||(Yr.Ja=new Yr);return Yr.Ja}static RQj(a){const b=new VG,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=
a.substring(c+1,f);b.Mf=a.substr(f+1);return b}}Yr.Ja=null;Object(m.a)(Yr,"AssistanceActor",null,[106]);class WG{constructor(){this.bof=this.La=this.Xqb=null;this.ySd=!1}D_l(a,b){if(b.actionId!==N.a.w5||A.AFrameworkApplication.XF)if(this.ySd&&!A.AFrameworkApplication.vua)this.Xqb||(this.Xqb=this.bof()),this.Xqb.Jl(a,b);else if(b.actionId===N.a.w5)this.o_l();else{a=a.E2c(b);b=null;try{Aa.a.O$(a)&&(b=Sd.a.qo(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw da.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?da.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):da.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else da.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.Xqb&&(this.Xqb.dispose(),this.Xqb=null)}zOh(a,b,c){c&&Yj.b(a)?this.ySd=!1:(this.bof=a,this.ySd=c);this.La=b}o_l(){A.AFrameworkApplication.Pa.nb(N.a.w5,2)}static createInstance(a,b,c){c=void 0===c?null:c;const f=new WG;null==c?f.zOh(a,b,A.AFrameworkApplication.QPf||b.getBooleanAppSetting("HelpTabIsEnabled")):f.zOh(a,b,c);return f}}Object(m.a)(WG,"AssistanceDisplayManager",null,
[548,106]);class px{constructor(a,b,c,f,l){this.IH=a;this.Cji=b;this.tIc=c;this.R$h=f;this.Xyf=l}get lcid(){return this.IH}get namespace(){return this.Cji}get gLa(){return this.tIc}get mFi(){return this.R$h}get locale(){return this.Xyf}static yQj(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:px.mGi}static createInstance(a){return new px(A.AFrameworkApplication.lcid,a,px.yQj(A.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
Ea.a.Oe(A.AFrameworkApplication.lcid).name)}}px.mGi=16;Object(m.a)(px,"AssistanceSearchUrlParameterSet",null,[]);class XG{constructor(a,b){a=new Dm.QueryStringBuilder(a);a.zg("clid",b.lcid.toString());a.zg("p1",b.namespace);a.zg("ver",b.gLa.toString());a.zg("apps",b.mFi);a.zg("lc",b.locale);this._url=a.toString()}E2c(a){const b=new Dm.QueryStringBuilder(this._url);b.zg("src","TellMe");b.zg("query",a.Mf);b.zg("sessionid",a.sessionId);b.zg("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new XG(A.AFrameworkApplication.RPf,
a)}}Object(m.a)(XG,"AssistanceSearchUrlProvider",null,[540]);class YG{fc(){}init(){A.AFrameworkApplication.kwb&&!A.AFrameworkApplication.XSb&&Yr.instance.qb(A.AFrameworkApplication.Pa)}dispose(){Yr.instance.dispose()}Axg(a){Yr.instance.initialize(WG.createInstance(a,A.AFrameworkApplication.fa),XG.createInstance(px.createInstance("PPWAEndUser")))}}Object(m.a)(YG,"AssistancePackage",null,[2,3]);var ZT=d(722);class $Q{constructor(a,b,c,f,l,u){this.ia=a;this.Oc=b;this.cjc=c;this.vHk=f;this.gHe=l;this.Nwa=
u}Jl(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case N.a.s6d:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case N.a.w5:a.feedback=this.GZi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case N.a.dZh:a.query="showtraining";c=ResourceStrings.L_Training;break;case N.a.I5h:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.Mf,c=ResourceStrings.L_Help}const f={};f.BA=c;f.assetId="FA000000012";this.Nwa.T7c&&b.actionId===N.a.w5&&(f.sourceLocationOverrideResourceId=
"Help.GiveFeedback.Url");f.nonPersistedSettings=a;f.vif=!1;b.actionId==N.a.s6d&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.Ia(M.a.Aia,2,f)}}ur(){const a=this.yBb();a&&this.ia&&this.ia.Ia(M.a.Gxb,2,a)}dispose(){}yBb(){if(this.Oc.instance){const a=this.Oc.instance.TO("FA000000012");if(a)return a.zj}return null}GZi(a){this.Nwa.T7c||(this.gHe?this.gHe.hZb?this.rVf():this.vHk.wae(Object(R.a)(this,this.Wlj,"feedbackDownloaded")):ya.a.J(512324302,1302,15,"feedbackFormManager is undefined"));
a=a.Bd?a.Bd:{};A.AFrameworkApplication.fa.M2b(a);a=this.cjc.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}rVf(){if(ZT.BrowserFeedbackControlOCV.mkh())ya.a.J(512324300,
1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(R.a)(this,this.mvh,"postScreenshotData"));return}catch(a){ya.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(R.a)(this,this.mvh,"postScreenshotData"))}catch(a){ya.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}Wlj(a){a&&
(this.gHe.AHg(a),this.rVf())}mvh(a){a=a.toDataURL("image/jpeg");const b=this.yBb(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(m.a)($Q,"AgaveAssistancePane",null,[542,106]);class aR extends YG{constructor(){super();this.Ynf=this.Gsf=this.qqf=this.$Ec=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}fc(a){this.Da=a}load(){this.init()}init(){super.init();!A.AFrameworkApplication.kwb&&A.AFrameworkApplication.XSb?
ya.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(ya.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),A.AFrameworkApplication.fa.getBooleanAppSetting("HelpTabIsEnabled")?(this.$Ec=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.qqf=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.Gsf=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
this.Ynf=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Axg(()=>new $Q(this.Da.resolve("Common.IActionManagerExtended"),this.Da.Ha("PowerPointWebEditor.IAppForOfficeManager"),this.$Ec,this.qqf,this.Gsf,this.Ynf))):this.Axg(null))}}Object(m.a)(aR,"PowerPointAssistancePackage",YG,[1788]);class ZG{roj(a,b,c){return a?this.qnj(b,c):this.soj(b,c)}scg(a,b,c){return a?this.Tnj(b,c):this.Lnj(b,c)}Jnj(a){var b=a.Kf?a.yg.vf:a.yg.Ua;const c=new mb.GraphIterator;a.Xq?c.Uc(a.Xq):c.set(b.node);
c.uc(14);a=new mb.GraphIterator;a.Uc(c);a.uc(14);b=se.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!se.isLastCellInRow(a)){do if((f=ce.moveToNextColumn(a))&&se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!se.isLastCellInRow(a))}if(!l&&!se.isLastCellInColumn(c)){do if((f=ce.moveToNextRow(c))&&se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!se.isLastCellInColumn(c))}return l?f:null}Rnj(a){var b=a.Kf?a.yg.vf:a.yg.Ua;const c=new mb.GraphIterator;a.Xq?c.Uc(a.Xq):
c.set(b.node);c.uc(14);a=new mb.GraphIterator;a.Uc(c);a.uc(14);b=se.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!se.isFirstCellInRow(a)){do if((f=ce.moveToPreviousColumn(a))&&se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!se.isFirstCellInRow(a))}if(!l&&!se.isFirstCellInColumn(c)){do if((f=ce.moveToPreviousRow(c))&&se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!se.isFirstCellInColumn(c))}return l?f:null}qYc(a,b){var c=a.Kf?a.yg.vf:a.yg.Ua;const f=new mb.GraphIterator;
a.Xq?f.Uc(a.Xq):f.set(c.node);f.uc(14);a=se.findControllingCellFromNode(c.node);c=null;if(b){do{if(se.isFirstCellInColumn(f))break;c=ce.moveToPreviousRow(f)}while(c&&se.findControllingCellFromNode(c)===a)}else{do{if(se.isLastCellInColumn(f))break;c=ce.moveToNextRow(f)}while(c&&se.findControllingCellFromNode(c)===a)}return c}rcg(a,b){if(!Sk.l(a))return null;a=mb.GraphIterator.ob(a.currentNode);a.uc(14);let c;const f=Jd.TableReader.nu(a.origin);do c=b?ce.moveToPreviousRow(a):ce.moveToNextRow(a);while(f&&
c&&Sk.h(a));return c}W0a(a,b,c,f,l){let u=null;jb.OutlineElementNavigator.$e(a);const I=ge.OutlineElementReader.isRtl(a.currentNode);if(c)if(ce.returnToCell(a),b=se.isLastCellInRow(a),c=se.isFirstCellInRow(a),l||!I&&c||I&&f&&b)ce.returnToContainingRow(a),(f=this.rcg(a,!0))?u=$d.SelectionFactory.hk(f,!b):l&&(jb.OutlineElementNavigator.$e(a),l=new ko.a,l.Uc(a),(a=jb.OutlineElementNavigator.Pya(l,!1,!1))&&(u=$d.SelectionFactory.hk(a,!1)));else{do I?ce.moveToNextColumn(a):ce.moveToPreviousColumn(a);while(se.isGhostCell(a)&&
!se.isFirstCellInColumn(a));se.isGhostCell(a)||(u=$d.SelectionFactory.hk(a.currentNode,!I))}else ge.OutlineElementReader.QD(a,b,I)||Bc.SelectionEditor.nh(b)||ce.returnToCell(a),u=$d.SelectionFactory.hk(a.currentNode,!I);return u}V0a(a,b,c,f,l){let u=null;jb.OutlineElementNavigator.$e(a);const I=ge.OutlineElementReader.isRtl(a.currentNode);if(c)if(ce.returnToCell(a),c=se.isLastCellInRow(a),b=se.isFirstCellInRow(a),l||!I&&f&&c||I&&!f&&b)ce.returnToContainingRow(a),(f=this.rcg(a,!1))?u=$d.SelectionFactory.hk(f,
b):(jb.OutlineElementNavigator.$e(a),f=new ko.a,f.Uc(a),(a=jb.OutlineElementNavigator.XK(f,!1,!1))&&(u=$d.SelectionFactory.hk(a,!0)));else{do I?ce.moveToPreviousColumn(a):ce.moveToNextColumn(a);while(se.isGhostCell(a)&&!se.isLastCellInRow(a));se.isGhostCell(a)||(u=$d.SelectionFactory.hk(a.currentNode,I))}else ge.OutlineElementReader.QD(a,b,!I)||Bc.SelectionEditor.nh(b)||ce.returnToCell(a),u=$d.SelectionFactory.hk(a.currentNode,I);return u}}Object(m.a)(ZG,"ATableCellSelectionStrategy",null,[1869]);
class $G extends ZG{constructor(){super()}Lnj(a,b){var c=a.kb;let f=null;if(a.qm){let l=null;if(b){if(c.Xq=a.Vla,a=Object(gb.a)(Sm.TableCellNode,this.Jnj(c)))a.isGhostCell&&(l=a,a=a.$z()),f=c.TH.isValid&&c.TH.node&&a===c.TH.node?$d.SelectionFactory.hk(c.TH.node,!c.Kf):$d.SelectionFactory.Dv(Mr.TableNodeContext.create(Object(gb.a)(Zg.a,a)),c.Kf)}else if(c=a.ga(Math.max(0,Math.min(a.Hla,a.$Aa))),c=Object(gb.a)(Sm.TableCellNode,c.yg.vf.node),c.isControllingCell&&(c=c.mie(2)),a=c.V0(),b=c.o_c().pLa,!a&&
b&&(c=b.Scg),a=c)a.isGhostCell&&(l=a,a=a.$z()),f=Bc.SelectionEditor.Km($d.SelectionFactory.Nl(Object(gb.a)(Zg.a,a)),!0,!1);f&&l&&(f.Xq=mb.GraphIterator.ob(l))}return f}Tnj(a,b){let c=a.kb,f=null;a.qm&&(b?(c.Xq=a.Vla,a=Object(gb.a)(Sm.TableCellNode,this.Rnj(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.$z()),(f=c.TH&&c.TH.isValid&&a===Object(gb.a)(650,c.TH.node)?$d.SelectionFactory.hk(c.TH.node,!c.Kf):$d.SelectionFactory.Dv(Mr.TableNodeContext.create(Object(gb.a)(Zg.a,a)),c.Kf))&&b&&(f.Xq=mb.GraphIterator.ob(Object(gb.a)(Zg.a,
b))))):(a.Hla>a.$Aa?(c=a.s3,c.Xq=c.Kf?a.e4a:null):c.Xq=c.Kf?null:a.Vla,f=Bc.SelectionEditor.Km($d.SelectionFactory.Nl(c.yg.Ua.node),!0,!1),f.Xq=c.Xq));return f}soj(a,b){let c=a.kb;var f=null;if(a.qm){const l=a.Hla>a.$Aa;let u=null;if(b){if(c.Xq=a.Vla,a=Object(gb.a)(Sm.TableCellNode,this.qYc(c,!0)))a.isGhostCell&&(u=a,a=a.$z()),f=l&&c.TH&&c.TH.isValid&&a===c.TH.node?$d.SelectionFactory.hk(c.TH.node,!c.Kf):$d.SelectionFactory.Dv(Mr.TableNodeContext.create(Object(gb.a)(Zg.a,a)),c.Kf)}else l?(c=a.s3,
c.Kf&&(c=c.gAb(),c.Xq=a.e4a)):c.Kf?c=c.gAb():c.Xq=a.Vla,f=Object(gb.a)(Sm.TableCellNode,this.qYc(c,!0)),f?f.isGhostCell&&(u=f,f=f.$z()):(f=Object(gb.a)(Sm.TableCellNode,c.yg.Ua.node),u=c.Xq?Object(gb.a)(Sm.TableCellNode,c.Xq.currentNode):null),f=$d.SelectionFactory.hk(Object(gb.a)(Zg.a,f),!0);f&&u&&(f.Xq=mb.GraphIterator.ob(Object(gb.a)(Zg.a,u)))}return f}qnj(a,b){let c=a.kb;var f=null;if(a.qm){const l=a.Hla<a.$Aa;let u=null;if(b){if(c.Xq=a.Vla,a=Object(gb.a)(Sm.TableCellNode,this.qYc(c,!1)))a.isGhostCell&&
(u=a,a=a.$z()),f=l&&c.TH&&c.TH.isValid&&a===Object(gb.a)(650,c.TH.node)?$d.SelectionFactory.hk(c.TH.node,!c.Kf):$d.SelectionFactory.Dv(Mr.TableNodeContext.create(Object(gb.a)(Zg.a,a)),c.Kf)}else l?(c=a.s3,c.Kf&&(c=c.gAb(),c.Xq=a.e4a)):c.Kf?c=c.gAb():c.Xq=a.Vla,f=Object(gb.a)(Sm.TableCellNode,this.qYc(c,!1)),f?f&&f.isGhostCell&&(u=f,f=f.$z()):(f=Object(gb.a)(Sm.TableCellNode,c.yg.Ua.node),u=c.Xq?Object(gb.a)(Sm.TableCellNode,c.Xq.currentNode):null),f=$d.SelectionFactory.hk(Object(gb.a)(Zg.a,f),!0);
f&&u&&(f.Xq=mb.GraphIterator.ob(Object(gb.a)(Zg.a,u)))}return f}}Object(m.a)($G,"TableCellSelectionStrategy",ZG,[]);class bR extends kB{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){super(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,lc,Ec);this.vni=l;this.hgi=c;this.hEc=tc}x6b(a,b){var c=Object(gb.a)(Qp,b);c&&c.U1a&&this.WRi(this.hgi.ref)&&(c=c.U1a.ra(wm.a.$b,""),this.hEc.vpc(c),this.hEc.fD(6,c));return super.x6b(a,b)}WRi(a){const b=new lE;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;
a=mb.GraphIterator.ob(a);let c=a.sj();for(;c;)b.enqueue(c),c=a.Up()}return!1}RUc(a,b){var c=Object(gb.a)(Qp,b);if(c&&c.U1a){c=c.U1a.ra(wm.a.$b,"");const f=Object(gb.a)(5,this.vni.Oa.kb.vf.node);f&&(f.$b=c)}return super.RUc(a,b)}}Object(m.a)(bR,"PPTClipboardOperationCutCopy",kB,[]);class cR{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc,lc,Ec){this.Ca=a;this.yd=b;this.ht=c;this.m0=u;this.Vc=l;this.Rj=f;this.Cs=I;this.Bf=T;this.fka=ja;this.OL=ua;this.gka=Ra;this.Jtb=eb;this.v8a=Bb;this.La=Ub;this.Kk=
Xb;this.hEc=tc;this.Ed=lc;this.jd=Ec}create(){return new bR(this.Ca,this.yd,this.ht,this.Rj,this.Vc,this.m0,this.Cs,this.Bf,this.fka,this.OL,this.gka,this.Jtb,this.v8a,this.La,this.Kk,this.hEc,this.Ed,this.jd)}}Object(m.a)(cR,"Factory",null,[1744]);class dR{constructor(){}get Frd(){return!1}ywb(){}get Lgh(){return!1}set Lgh(a){}get ZWk(){return!1}Opa(){}m1a(){}get Xjh(){return-1}get gVc(){return null}}Object(m.a)(dR,"NoImageSteward",null,[1868]);class aH{constructor(a){this.olc=a}create(a,b){return this.olc||
1!==a?new dR(b):null}}Object(m.a)(aH,"PPTImageStewardFactory",null,[1865]);class sr extends Gs{constructor(a,b,c,f,l,u,I){super(a,b,c);this.ia=f;this.Dy=l;this.Fc=I;this.xLk=u.Fel;this.ZZa=u.xue;this.WKk=u.wue;this.olc=u.uEb;this.yLk=u.Ynk}awe(a,b,c){const f=sr.Ogg(c);a=(!U.a.instance.ga(82)||this.Wmk(a,b,f))&&super.awe(a,b,c);3===c.NTa?this.Fc.Uv(2,f):2===c.NTa&&this.Fc.Uv(3,f);a&&(this.Fc.vpc(f),this.M1h(b,f));return a}O9e(a,b,c){const f=sr.Ogg(c);a.setAttribute(mv.a.AVf,f);let l=!1;const u=sr.Umk(a);
if(u)ya.a.J(508625102,826,50,null),l=!0;else if(this.yLk&&1===a.getElementsByTagName("Table").length&&!b.iterator.uc(60))this.Fc.fD(6,f),l=!0;else{const I=Ac.b(a);I&&I.length||!sr.jac(a)||(ya.a.J(508625101,826,50,null),l=!0)}l&&!sr.AIh&&(sr.AIh=!0);if(!this.xLk)return!0;l&&(this.olc&&this.pEg(c)?ya.a.J(508625100,826,50,"Paste text only action."):(ya.a.J(508625099,826,50,null),this.vjj(a.cloneNode(!0),u)));if(a=!l&&super.O9e(a,b,c))this.Fc.vpc(f),this.Fc.fD(1,f),this.M1h(b,f);return a}vjj(a,b){b&&
a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.ZZa||this.WKk)&&this.Dy.UUi(a.firstChild,a));$c.a.nca(()=>{this.ia.Ia(M.a.rth,2,a)},100)}Wmk(a,b,c){if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("ComplexTableCellPasteWithFormattingIsEnabled")){a=sr.$Oj(a);if(1!==a.count)return!1;this.Fc.fD(6,c);a=a.ga(0);return!A.AFrameworkApplication.fa.getBooleanAppSetting("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.Q0j(a)?!1:sr.pnk(b)}c=
Object(gb.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.xM())?c.getContainingTable():null);return!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanAppSetting("PPTInternalPasteTableInTableIsEnabled")&&b.El&&b.node.Qa(yb.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.rq()}Q0j(a){a=a.getElementsByTagName("Table");if(1===a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");if(!f||
!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}M1h(a,b){if(Object(gb.a)(5,a.node)&&a.iterator)if(a.iterator.uc(10)){if(a=Object(gb.a)(4,a.iterator.ay(10)))a.$b=b}else a.iterator.uc(60)&&(a=Object(gb.a)(747,a.iterator.ay(60)))&&(a.$b=b)}static $Oj(a){a=a.getElementsByTagName("Table");if(1===a.length){var b;return b=new La.a,b.add(a[0]),b}b=new La.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=
a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static pnk(a){return a.El&&a.node.Qa(yb.a.cellId)&&a.iterator.uc(14)?!0:!1}static jac(a){a=a.getElementsByTagName(Df.a.C5);if(!a.length)return null;a=a[0];return a.src?a:null}static Umk(a){return!!a.firstChild&&!!a.firstChild.className&&tT.a.wzg(a.firstChild.className)}static Ogg(a){let b="";a&&a.U1a&&(b=a.U1a.ra(wm.a.$b,""));return b}}sr.AIh=!1;Object(m.a)(sr,"PPTPasteCoordinator",Gs,[]);class eR{constructor(){}ywb(){}get Jea(){return!1}SZ(){}PZ(){}RZ(){}QZ(){}OZ(){}NZ(){}}
Object(m.a)(eR,"TextOnlyTableSteward",null,[1831,1832]);class bH{constructor(a){this.olc=a}create(a,b){return this.olc||1!==a?new eR(b):null}}Object(m.a)(bH,"PPTTableStewardFactory",null,[1808]);class cH{constructor(a,b,c){this.lJk=a;this.tMk=b;this.ka=c}n2e(){this.lJk.execute(a=>{this.ka.Mwe&&a.y2e(this.tMk.value)})}}Object(m.a)(cH,"AccessibilityActor",null,[]);class uv{get key(){return"LIST"}get J9(){return Box4Intl.Box4Strings.l_ListContentTitle}Uff(a){let b;b=null;const c=uv.eg.Aw(a);if(!c)return{returnValue:!1,
Yxb:b};a=this.xEj(a,c);b=Object.assign(new gB,{T2:this.key,contentId:a.listId,nR:a});return{returnValue:!0,Yxb:b}}s_c(a,b){a=a.nR;const c=this.BDj(a.oV),f=new fk.a;b?(b=b.nR,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c)):b.id.equals(a.id)&&b.oV.listType===a.oV.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));
return f.toArray().join(" ")}BDj(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.BY);else if(1===a.listType)switch(c){case 1:b=this.ASf;break;case 2:b=this.XLi;break;case 3:b=this.YLi;break;default:b=this.ASf}return b}static get eg(){return uv.qh||(uv.qh=Tb.a.instance.resolve("Box4.List.IListReader"))}}uv.qh=null;Object(m.a)(uv,"ListDetailsProvider",null,[1830,1063]);class fR{constructor(){this.oV=this.listId=this.id=null;this.level=
0}}Object(m.a)(fR,"ListItemInfo",null,[]);class dH extends uv{constructor(a){super();this.DI=a}get ASf(){return ResourceStrings.l_BulletStyle1}get XLi(){return ResourceStrings.l_BulletStyle1}get YLi(){return ResourceStrings.l_BulletStyle1}xEj(a,b){const c=this.DI.rfa(a),f=this.DI.vEj(a);return Object.assign(new fR,{id:a.currentNode.id,listId:new Ua.a(kh.a.nil,f),oV:b,level:c+1})}}Object(m.a)(dH,"ListDetailsProvider",uv,[]);class gR{constructor(){this.tI=this.K=null}dispose(){}fc(a){this.K=a;this.tI=
this.K.resolve("Common.AFrameworkApplication");a.register(aH,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().na(()=>new aH(a.resolve("PowerPointWebEditor.IApplicationSettings").uEb));a.register(bH,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>new bH(a.resolve("PowerPointWebEditor.IApplicationSettings").uEb));a.register(Gs,"Box4.Actors.PasteCoordinator").ma().na(()=>new sr(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1744,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new cR(A.AFrameworkApplication.Pa,jd.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
Me.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),cg.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),Id.a.instance,a.resolve("Box4.IEditingDomManager")));
a.register(dH,"PowerPointWebEditor.ListDetailsProvider").na(()=>new dH(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(cH,"PowerPointWebEditor.AccessibilityActor").ma().na(()=>new cH(a.Ha("Box4.Accessibility.IAccessibilityContextManager"),a.ze("PowerPointWebEditor.ListDetailsProvider"),this.tI.nU.td));a.register($G,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().na(()=>new $G)}init(){const a=ad.App.WE.zU;wz.g$j(this.tI.Qp,this.K.resolve("Common.IReactContextualUILauncher"),
a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));this.K.resolve("PowerPointWebEditor.AccessibilityActor").n2e()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(m.a)(gR,"Box4DelayedLoadedPackage",null,[2,3]);class hR{constructor(a,b,c,f,l,u,I,T){this.tgb=this.maa=null;this.sad=0;this.oad=new Md.a(0);this.uZa=this.EEe=this.Cjc=null;this.pad=!1;this.gRg=[la.a.contextMenu,la.a.pBa,la.a.bO,la.a.mouseDown,la.a.BB,la.a.bTa,la.a.kkb,la.a.paste];this.Ceh=[la.a.Vf,la.a.rm,
la.a.nz,la.a.click,la.a.doubleClick,la.a.US,la.a.s2d,la.a.WK,la.a.fnd];this.yK=a;this.vBe=c||[];this.GFk=f||[];this.bDe=l||[];this.Dbh=u;this.Nc=b;this.Nc.qxi(Object(R.a)(this,this.alh,"onAppClosing"));this.Nc.aC(Object(R.a)(this,this.KF,"onSessionEnd"));this.Hhd=I;T&&(Ie.EventHandlerManager.instance.t2e(this.gRg,Object(R.a)(this,this.Z2k,"onBeforeEventActionContextCreated")),Ie.EventHandlerManager.instance.ZBh(this.gRg,Object(R.a)(this,this.k2k,"onAfterEventActionContextCreated")),Ie.EventHandlerManager.instance.t2e(this.Ceh,
Object(R.a)(this,this.$2k,"onBeforeEventTriggered")),Ie.EventHandlerManager.instance.ZBh(this.Ceh,Object(R.a)(this,this.l2k,"onAfterEventTriggered")));this.zJe=!1}getName(){return"ActionContext"}JZ(a){var b;if(2===a.behavior){var c=a.actionId,f=this.getCommandName(c);(null===(b=this.maa)||void 0===b?0:b.Otg(f))&&Lc.qUi();if(this.bra(c)){ya.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.Hoe(a,f,"",!1)+"; Current Event: "+(this.uZa||"")+"; Current ActionContext: "+($c.a.Kb?$c.a.Kb.toString():
""));if(!this.sad)if(this.pad=!0,this.bXl(a)){this.maa=$c.a.lEd(f);this.zJe=!0;b=a.telemetryData;var l=this.Cjc;let u=this.EEe;null===l&&b&&b[Ii.a.MFa]&&(l=b[Ii.a.MFa],u=$c.a.Wpb(l));null!==u&&(this.maa.Wa(Ii.a.r9a,u.toFixed(2)),null!==l&&this.maa.Wa(Ii.a.MFa,l.toFixed(2)));b&&Qa.a.forEach(b,(I,T)=>{this.maa.uBa(I,(null===T||void 0===T?void 0:T.toString())||"")},null);l=!1;Array.contains(jn.VLl,c)?l=!0:this.maa.gq=!0;l=l||this.tk(c,b);this.maa.tk=l}else this.maa=$c.a.Kb;md.a("EnableTelemetryInActionContextListener")&&
ya.a.J(508424595,817,50,"ActionContextListener::OnBeforeAction {0}; Current Event: {1}; Current ActionContext: {2}",this.Hoe(a,f,"",!1),this.uZa||"",$c.a.Kb?$c.a.Kb.toString():"")}this.sad++}}IZ(a){var b;if(2===a.behavior){var c=a.actionId,f=this.getCommandName(c);(null===(b=this.maa)||void 0===b?0:b.Otg(f))&&this.maa.jLa(Lc.HOj());this.bra(c)&&(f=(b=$c.a.Kb)?b.rL(Ii.a.TIf).toString():"",ya.a.J(18956762,817,50,"ActionContextListener::OnAfterAction "+this.Hoe(a,this.getCommandName(c),f,!0)+";Result:"+
a.response.toString()+";Current Event:"+(this.uZa||"")+";Current ActionContext:"+(b?b.toString():"")+";RevisionId: "+(b?b.rL(Ii.a.d_).toString():"")));this.BZl(c)&&(b=this.oad.c1c(c,0),this.oad.add(c,b+1));this.sad--;0<this.sad||!$c.a.Kb||!this.maa||($c.a.Xk(Ii.a.osi,a.response.toString()),$c.a.Kb!==this.maa||this.tgb||this.Vkh(),this.maa=null)}}Vkh(){const a=$c.a.Kb;if(a){var b=new Date;a.tk&&!a.URb&&null===a.xG&&(a.xG=b);a.uBa(Ii.a.isi,(+b-+a.RE).toString());a.gq?0<a.rL(Ii.a.d_).length&&$c.a.Y2(a):
$c.a.UDd();this.zJe&&($c.a.Kb=null,this.zJe=!1)}}bra(a){if(!this.Dbh)return!1;if(Array.contains(this.vBe,a))return!0;a=A.AFrameworkApplication.Pa.RU(a);return!!a&&!(a.flags[32]||a.flags[64])}tk(a,b){return Array.contains(this.GFk,a)?b&&Ii.a.pNc in b?b[Ii.a.pNc]:!0:!1}BZl(a){return this.Dbh&&Array.contains(this.bDe,a)}bXl(a){return this.Hhd?!$c.a.Kb:!$c.a.Kb&&a.Bj}Hoe(a,b,c,f){if(null===a)return"null";b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.YPc+", InvocationMethod="+
a.eV+", CommandLocation="+a.oq+", CommandTabName="+a.Tta;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.yK?this.yK.H7(a):null;return b?b:a.toString()}alh(){if(!(1>this.oad.count)){var a={};this.oad.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});ya.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",Fe.c(a));this.Nc.sAl(Object(R.a)(this,this.alh,"onAppClosing"))}}KF(){$c.a.sTi()}Z2k(a){this.uZa=a.type;this.tgb=$c.a.lEd(this.uZa);this.tgb.tk=!0;this.pad=
!1;a=$c.a.XDd(a);null!==a&&$c.a.Rcm(a)&&this.tgb.Wa(Ii.a.MFa,a.toFixed(2))}k2k(){this.tgb&&$c.a.Kb===this.tgb&&this.pad&&this.Vkh();$c.a.Kb=null;this.pad=!1;this.tgb=this.uZa=null}$2k(a){this.uZa=a.type;this.Cjc=$c.a.XDd(a);null!==this.Cjc&&(this.EEe=$c.a.Wpb(this.Cjc))}l2k(){this.uZa=this.EEe=this.Cjc=null}}Object(m.a)(hR,"ActionContextListener",null,[182]);var $T=d(379);class eH{constructor(){this.K=null;this.gQg=[];this.jh=null;this.Sxa="";this.iLk=!1;this.lZ=[new gR,new XQ];this.Iaa=!!window.performance&&
!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}fc(a){this.Sxa=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());Mg.a.instance.Xb("EditingPackageConfigureStart",Date.now());this.K=a;this.qb();for(const b of this.lZ)b.fc(a);this.K.resolve("PowerPointWebEditor.IApplicationSettings").vCg&&this.K.register(837,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().na(()=>new YQ(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(UG,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().na(()=>
new UG(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}CVj(a,b,c){return 1===c?32:2===c?(this.C$j(),ya.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").nb(M.a.Txg,2),32):8}V9j(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");a.qv();this.K.resolve("Box4.IGeneralCuiUser");a.Gf()}Mxg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.y2f=!0;b.RVh=a;
b.nJg()}exk(a,b,c){ya.a.J(512497351,835,50,"Init GC2 started");const f=new Date,l=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader"),u=this.K.resolve("PowerPointWebEditor.IApplicationSettings");l.Ixk().continueWith(I=>{var T=new Date;ya.a.J(512497350,813,50,"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",$c.a.Ef(f),$c.a.Ef(T),+T-+f);if(6===I.status){I=BL.a({});const ja=(T=bF())&&I&&(b||a);ya.a.J(512497349,835,50,"{0}",
{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:I,["browserSupportsWebGL"]:T,["shouldUseShapeBuilder"]:ja});I=ja?document.createElement("canvas"):null;l.v$j(I,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(I=>{6!==I.status&&(ya.a.J(512497348,835,10,"Exception: {0}",I.Ni),u.nma&&(ya.a.J(508409427,835,50,"EditingPackage::appBootCompletedListener isGc2DependencyLoadedAndInitialized event invoked"),
c.Nec=!0))})}Iak(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").qJg()}C$j(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").Hfb().continueWith(()=>{this.K.resolve("PowerPointWebEditor.WetInkView")})}qb(){this.K.resolve("Common.IActionManagerExtended").xa(M.a.DFh,Le.a.frame,Object(R.a)(this,this.CVj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;this.Sxa=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",
this.Sxa,(new Date).getTime(),a);Mg.a.instance.Xb("EditingPackageInitStart",Date.now());a?(this.jh=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.jh.eMf(Object(R.a)(this,this.nxg,"initEditingPackage"))):this.oxg()}nxg(){this.jh.oEh(Object(R.a)(this,this.nxg,"initEditingPackage"));this.oxg()}oxg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Sxa=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",this.Sxa,a.J5,(new Date).getTime());
a.rHa(()=>{this.G8j(a)});a.pzg(()=>{this.vZi()})}G8j(a){this.Sxa=String.format("{0}, InitStartInternal:{1}",this.Sxa,(new Date).getTime());Mg.a.instance.Xb("EditingPackageInitStartInternal",Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new aR;f.fc(this.K);f.load(b);for(const u of this.lZ)u.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(Tb.a.instance.resolve("PowerPointWebEditor.IImageViewManager").Mob(),
c.TXa&&(b.Qp.Vcc(),ya.a.J(508409426,809,50,"EditingPackage::wire frame slide hidden as isMinimalBootEnabled is enabled")));this.V9j();this.K.resolve("Common.IActionManagerExtended").a3(new hR(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),jn.DJg,jn.Dyk,c.oWi,c.dnk,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.lLa){let u=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Aa)?(b=
ek.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na))?u=b.yea:ya.a.J(512497347,809,10,"slideViewElement is null."):ya.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").Hi());this.K.register(838,"PowerPointWebEditor.ICommentShimmerView").ma().na(()=>new ZQ(u,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),A.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("Common.ITaskManager"),c.JWi))}this.K.resolve("Common.IActionManagerExtended").a3(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.j1||(xe.a.instance.H1e((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&c.lLa&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),$T.a.xtl(),this.K.resolve("PowerPointWebEditor.ISessionState").fia("AppInteractive"),
this.Iaa&&Mg.a.instance.Xb("ContentEditablePerfMark",window.performance.now()),md.a("UpdateSlideSubcomponentLoggingForCanvasTTVR")&&this.K.resolve("PowerPointWebEditor.IPPTRumTracker").MS("canvas","slide"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").Epa("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(TB.App.FQb(null,ii.a.contentEditable),this.hzk()),Cd.a.get_instance().eJ(4),a.j1=!0);!c.L$&&c.lLa&&this.Vte()&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").B1l(),ya.a.J(512497345,
809,50,"CommentLandingSlide: true"));A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CommentTTVRImprovementIsEnabled",!1)&&this.ggk()&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Sjl();this.iLk&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.extcommon",null,()=>d.e(12).then(d.t.bind(null,1303,7)));this.Iak();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&ya.a.J(512497315,
809,50,"HighContrastMode enabled");!c.lue||a&&a.isInHighContrastMode?c.Ype&&c.lue&&this.Mxg(!1):this.Mxg(!0);a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");c.$bc?(this.gQg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.exk(c.pZc,c.Rrj,a)):(ya.a.J(508404226,835,50,"EditingPackage::graphicalContentComponents is disabled"),c.nma&&(ya.a.J(508409425,835,50,"EditingPackage::appBootCompletedListener isGc2DependencyLoadedAndInitialized event invoked"),
a.Nec=!0));c.nma&&(a=this.Vte(),b=this.Sdj(),c.eGa&&!a&&b||(this.K.resolve("Common.AFrameworkApplication").Qp.Vcc(),ya.a.J(508409424,809,50,"EditingPackage::wire frame slide hidden as landingSlideHasComments:{0}, landingSlideHasShapes:{1}",a,b)));A.AFrameworkApplication.Zx||(A.AFrameworkApplication.Zx=ya.a.N6b());c.vCg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.ub("Common.IFrameTimingMeter");l&&(ya.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),
l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Jb(new ne.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,()=>{l.stop()},90,"93")));this.Sxa=String.format("{0}, InitDone:{1}",this.Sxa,(new Date).getTime());Mg.a.instance.Xb("EditingPackageInitDone",Date.now());ya.a.J(512497313,809,50,this.Sxa)}Vte(){var a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Aa;
return a&&(a=a.fF(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").Ptg(a))?!0:!1}Sdj(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Aa;return 0<(null===a||void 0===a?void 0:a.yj().length)}ggk(){return this.K.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("IsDeepLinkSession")||this.Vte()}vZi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");ya.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);
const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.W2h("{"+A.AFrameworkApplication.userSessionId+"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").oAj();f&&(c.JBc(0<f.length?2:1),c.j2h(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").Rzk(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").H9f();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").Qxg();
ya.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&A.AFrameworkApplication.fa.Ue(Object(R.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").AUh,"startServerRtcConnection"))}hzk(){if(Mg.a.instance.xdb)ya.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[ii.a.cGa,
ii.a.Aeg,ii.a.Ceg,ii.a.qAb,ii.a.Beg,ii.a.Qvb,ii.a.hPc,ii.a.Nea,ii.a.oR,ii.a.contentEditable,ii.a.kCc,"UserClickTime","DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","DocPageNavigationRedirects","BootJsStartTime","BootJsEndTime",ii.a.awd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount",
"ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime","EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",ii.a.yYc,ii.a.zYc,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource",
"SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime","OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd",
"FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart","ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])Mg.a.instance.Ml(b)&&(a[b]=Mg.a.instance.hh(b));
A.AFrameworkApplication.fa.Ea("PodSID")&&(a.PodSessionID=A.AFrameworkApplication.fa.Ea("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:Mg.a.instance.Ml("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=Mg.a.instance.hh("ThumbnailShimmerHideTime"));ya.a.J(39184516,809,50,"Perf metrics: "+Qa.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
b.slk&&this.DCk(a,b)}}DCk(a,b){if(a[ii.a.oR])if(a[ii.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[ii.a.contentEditable]-a[ii.a.oR]>b.qHi){var c=new Map;c.set("ContentEditable",a[ii.a.contentEditable].toString());c.set("ContentViewable",a[ii.a.oR].toString());eg.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new Fl.a,{extendedProperties:c}))}c=b.Oij;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[ii.a.oR]-b>c&&
(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[ii.a.oR].toString()),eg.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],!1,!0,!1,!1,Object.assign(new Fl.a,{extendedProperties:c})))}else ya.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else ya.a.J(512497309,809,15,"ContentEditable is null");else ya.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.lZ)a.dispose();for(const a of this.gQg)a.dispose();
this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();ya.a.J(38876352,809,50,"EditingPackage::Register time:{0}",a);Mg.a.instance.Xb("EditingPackageRegisterTime",a);C.a.instance.Ac(new eH)}}Object(m.a)(eH,"EditingPackage",null,[2,3]);var aU=d(590),iR=d(524);class fH{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub,Xb,tc){this.uoa=this.Laa=!1;this.uN={};this.o6=this.FK=null;this.CI=!1;this.UBc=()=>{this.Db.OB({ShowHideRuler:"ToggleButtonModel"})};
this.kza=()=>{this.Laa&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");if(!u)throw Error.argumentNull("shapeReader");if(!I)throw Error.argumentNull("pageView");if(!T)throw Error.argumentNull("actionManager");if(!ja)throw Error.argumentNull("slideDimensionsHelper");if(!ua)throw Error.argumentNull("presentationReader");
if(!Ra)throw Error.argumentNull("transactionFactory");if(!eb)throw Error.argumentNull("pptPageView");if(!Bb)throw Error.argumentNull("applicationSettings");if(!Ub)throw Error.argumentNull("viewElementEventHandlers");if(!Xb)throw Error.argumentNull("viewCoreEventHandlers");this.Db=a;this.Jc=b;this.Ye=c;this.yba=f;this.oa=l;this.Ga=u;this.yb=I;this.ia=T;this.fv=tc;this.Nw=ja;this.Wb=ua;this.Eb=Ra;this.F_a=eb;this.LNe=Bb.cIh;this.NNe=Bb.bIh;this.CI=Bb.L$;this.xd=Ub;this.DF=Xb}get Pjb(){return document.getElementById(P.AppFrame.r5h)}dispose(){this.Laa=
!1;this.Db.m3e(Object(R.a)(this,this.renderRuler,"renderRuler"));Ae.a.removeHandler(this.Pjb,la.a.scroll,Object(R.a)(this,this.dqb,"updateRulerLocation"));Object(iR.i)("RulerStateUpdate")&&Ae.a.removeHandler(this.Pjb,la.a.contextMenu,this.UBc);this.xd.C3e(Object(R.a)(this,this.Oqc,"onCloseTextEditView"));this.xd.Pvc(Object(R.a)(this,this.nrc,"onOpenTextEditView"));this.DF.Kvc(this.kza);this.FK&&this.o6?(za.a.SMa(this.FK,"ShowWACHorizontalRulerContainer"),za.a.RJ(this.FK,"HideWACHorizontalRulerContainer"),
Gj.UISurfaces.J1c().then(a=>{a.dispose(this.o6);return null}),this.FK.removeChild(this.o6),this.yba.removeChild(this.FK),this.o6=this.FK=null):ya.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.FK&&this.o6){za.a.SMa(this.FK,"HideWACHorizontalRulerContainer");za.a.RJ(this.FK,"ShowWACHorizontalRulerContainer");var b=this.Jc.Ic;if(b&&b.gd){var c=b.gd;c=new Rr.a(c.yq,c.yl);b=this.Nw.ibc(c,!this.CI&&b.yea?b.yea.va.style.visibility===sj.a.visible:
!1).width;c=this.Ye.wi(this.Jc.Ic.Oy).width;1===this.F_a.$i||0>=b||0>=c?ya.a.J(512496003,824,50,"Ruler should not be rendered"):(this.uN.rulerCanvasProps=this.Ngl(Ad.a.Wha(b,0)),c=Object(R.a)(this,this.o6k,"onIndentChange"),this.uN.onIndentChange=c,this.uN.indents=this.uN.rulerCanvasProps.textEditableArea?this.thl():null,this.uN.rtl=this.uoa?!this.fv:this.fv,this.uN.inverted=this.uoa?!this.fv:this.fv,this.o6.style.width=this.Ye.Rc(b),this.dqb(null),Gj.UISurfaces.J1c().then(f=>{f.renderRuler(this.o6,
this.uN);return null}),b=window.performance.now(),ya.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else ya.a.J(512496004,824,50,"Unable to get slideViewElement")}else ya.a.J(512496005,824,50,"Ruler container div / Ruler div null")}Ngl(a){const b={},c=Re.a.Ov(this.Wb.Fn.$a(yb.a.slideWidth));var f=a/2;let l=0,u=Ad.a.tL(a,0);b.zeroScale=Ad.a.tL(f,0);this.uoa=!1;b.textEditableArea=!1;if(this.oa.i1()&&!this.oa.kYa()){f=this.oa.Z0();var I=f.sc(this.yb.Na),T=I.rotation;T>this.LNe&&
T<this.NNe&&(this.uoa=!0);const ja=I.htmlElement.querySelector(".ShapeViewContent"),ua=this.Ga.I0c(f,this.yb.Xd);T=0;f.Rg&&(T=f.zt().sc(this.yb.Na).htmlElement.offsetLeft);T+=I.htmlElement.offsetLeft+ja.parentNode.offsetLeft+(ua?ua.e:0);I=T+ja.offsetWidth;f=(this.uoa?!this.fv:this.fv)?I:T;T>=l&&T<=u&&I>=l&&I<=u&&(l=T,u=I,b.zeroScale=f,b.textEditableArea=!0)}T=Re.a.Sva(c)/a;a=T*Ad.a.Wha(u-l,0);T*=Ad.a.Wha(l,0);b.leftMargin=l;b.rightMargin=u;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=
Re.a.JOa(a);b.leftBoundary=Re.a.JOa(T);return b}nrc(){this.Laa&&this.renderRuler()}Oqc(){this.Laa&&this.renderRuler()}thl(){var a={};if(32!==this.ia.Ia(G.a.kOb,2,a))return ya.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};a=a.vC;if(!a)return ya.a.J(512496E3,824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?Re.a.JOa(a.wSb+a.eP):2===a.specialIndentType?Re.a.JOa(a.eP-a.wSb):Re.a.JOa(a.eP);
c.value=Re.a.JOa(a.eP);f.value=Re.a.JOa(a.eP);return[b,c,f]}o6k(a,b){const c=new aU.a;c.unit=1;c.value=Re.a.Sva(b);this.a8j(a,c)}a8j(a,b){var c=this.oa.Z0();if(a&&b&&c){var f=window.performance.now(),l=this.Eb.xe(15);l.mc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.Ia(M.a.tRb,2,b);l.Wc=M.a.tRb;break;case "HangingIndent":c=this.ia.Ia(M.a.uRb,2,b);l.Wc=M.a.uRb;break;case "LeftIndent":c=this.ia.Ia(M.a.Uma,2,b);l.Wc=M.a.Uma;break;default:ya.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();
b=window.performance.now();ya.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&ya.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else ya.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}nQ(){this.rZd();this.Laa=!0;this.Db.WZd(Object(R.a)(this,this.renderRuler,"renderRuler"));Ae.a.addHandler(this.Pjb,la.a.scroll,Object(R.a)(this,this.dqb,"updateRulerLocation"));Object(iR.i)("RulerStateUpdate")&&Ae.a.addHandler(this.Pjb,la.a.contextMenu,
this.UBc);this.xd.zOc(Object(R.a)(this,this.Oqc,"onCloseTextEditView"));this.xd.zvb(Object(R.a)(this,this.nrc,"onOpenTextEditView"));this.DF.Y2b(this.kza)}dqb(){if(this.Laa){var a=this.Jc.Ic;a&&a.Oy&&window.requestAnimationFrame(()=>{const b=Sd.a.qGa(a.Oy),c=Sd.a.qGa(this.yba);this.o6.style.marginLeft=this.Ye.Rc(b.x-c.x+1)})}else ya.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}vhj(){if(this.FK)return this.FK;this.FK=document.createElement("div");this.FK.id="WACHorizontalRulerContainer";
this.FK.className="WACHorizontalRulerContainer";this.FK.setAttribute(Qe.a.Rp,"ruler");this.FK.setAttribute(Qe.a.Ff,Qe.a.mEa);Sys.UI.DomElement.addCssClass(this.FK,"HideWACHorizontalRulerContainer");return this.FK}whj(){if(this.o6)return this.o6;this.o6=document.createElement("div");this.o6.className="WACHorizontalRuler";this.o6.id="WACHorizontalRuler";return this.o6}rZd(){this.FK=this.vhj();this.FK.appendChild(this.whj());this.yba.insertBefore(this.FK,this.yba.firstChild)}}Object(m.a)(fH,"HorizontalRuler",
null,[949]);var bU=d(371);class gH{constructor(a,b,c,f,l){this.dhk=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Db=b;this.zah=c;this.Ydd=f;this.rld=l}qb(){this.ia.pa(M.a.HAd,ta.a.application,Object(R.a)(this,this.HAd,"showHideRuler"),4);this.ia.pa(M.a.utd,ta.a.application,Object(R.a)(this,
this.utd,"queryRulerToggle"),96)}e9j(){this.E8c()&&(ya.a.J(523351431,824,15,"Ruler init is called"),this.zah.Lxg())}HAd(a,b,c){return this.E8c()?this.N2j(c):this.x1l(c)}UBc(){this.Db.OB({ShowHideRuler:"ToggleButtonModel"})}x1l(a){if(1===a)return 32;ya.a.J(523351432,824,15,"ShowRuler called");this.zah.Lxg();this.nNh(!0);this.Db.qv();this.UBc();return 32}N2j(a){if(1===a)return 32;ya.a.J(523351433,824,15,"HideRuler called");this.adj();this.nNh(!1);this.Db.qv();this.UBc();return 32}adj(){this.E8c()&&
(this.Ydd.dispose(),this.rld.dispose(),this.Db.qv())}utd(a,b,c,f,l){l&&(l[Xh.a.On]=this.E8c());return 32}E8c(){return Yi.a.YX(bU.a.Pvh,this.dhk)}nNh(a){Yi.a.lL(A.AFrameworkApplication.fa.Ea("IsRulerOnCookieName"),a.toString(),Yi.a.VK)}}Object(m.a)(gH,"RulerActor",null,[]);class jR{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");this.Ydd=a;this.rld=b;this.Db=c}Lxg(){this.Ydd.nQ();this.rld.nQ();
this.Db.qv();this.Ydd.renderRuler();this.rld.renderRuler()}}Object(m.a)(jR,"RulerFactory",null,[836]);class tr{constructor(a,b,c,f,l,u,I,T,ja,ua,Ra,eb,Bb,Ub){this.d3d="HideWACVerticalRulerContainer";this.HTf="ShowWACVerticalRulerContainer";this.CI=this.uoa=this.Laa=!1;this.f7=this.TK=null;this.kza=()=>{this.Laa&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!l)throw Error.argumentNull("selectionManager");
if(!u)throw Error.argumentNull("shapeReader");if(!I)throw Error.argumentNull("pageView");if(!T)throw Error.argumentNull("slideDimensionsHelper");if(!ja)throw Error.argumentNull("presentationReader");if(!ua)throw Error.argumentNull("pptPageView");if(!Ra)throw Error.argumentNull("applicationSettings");if(!eb)throw Error.argumentNull("viewElementEventHandlers");if(!Bb)throw Error.argumentNull("viewCoreEventHandlers");this.Db=a;this.Jc=b;this.Ye=c;this.yba=f;this.oa=l;this.yb=I;this.Wb=ja;this.fv=Ub;
this.Nw=T;this.F_a=ua;this.LNe=Ra.cIh;this.NNe=Ra.bIh;this.CI=Ra.L$;this.xd=eb;this.DF=Bb}get Pjb(){return document.getElementById(P.AppFrame.r5h)}dispose(){this.Laa=!1;Ae.a.removeHandler(this.Pjb,la.a.scroll,Object(R.a)(this,this.dqb,"updateRulerLocation"));this.Db.m3e(Object(R.a)(this,this.renderRuler,"renderRuler"));this.xd.C3e(Object(R.a)(this,this.Oqc,"onCloseTextEditView"));this.xd.Pvc(Object(R.a)(this,this.nrc,"onOpenTextEditView"));this.DF.Kvc(this.kza);this.TK&&this.f7?(za.a.SMa(this.TK,
this.HTf),za.a.RJ(this.TK,this.d3d),Gj.UISurfaces.J1c().then(a=>{a.dispose(this.f7);return null}),this.TK.removeChild(this.f7),this.yba.removeChild(this.TK),this.f7=this.TK=null):ya.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.TK&&this.f7){za.a.SMa(this.TK,this.d3d);za.a.RJ(this.TK,this.HTf);var b=this.Jc.Ic;if(b&&b.gd){var c=b.gd;c=new Rr.a(c.yq,c.yl);b=this.Nw.ibc(c,!this.CI&&b.yea?b.yea.va.style.visibility===sj.a.visible:!1).height;
c=this.Ye.wi(this.Jc.Ic.Oy).height;if(1===this.F_a.$i||0>=b||0>=c)ya.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.vhl(Ad.a.Wha(b,1));f.rtl=this.uoa?!this.fv:this.fv;f.inverted=this.uoa?!this.fv:this.fv;this.f7.style.height=this.Ye.Rc(b);this.dqb(null);Gj.UISurfaces.J1c().then(l=>{l.renderRuler(this.f7,f);return null});b=window.performance.now();ya.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else ya.a.J(512495964,824,50,"Unable to get slideViewElement")}else ya.a.J(512495965,
824,50,"Ruler container div / Ruler div null")}vhl(a){const b={},c=Re.a.Ov(this.Wb.Fn.$a(yb.a.slideHeight));var f=a/2;let l=0;a=Ad.a.tL(a,0);b.zeroScale=Ad.a.tL(f,0);this.uoa=!1;b.textEditableArea=!1;if(this.oa.i1()&&!this.oa.kYa()){f=this.oa.Z0();var u=f.sc(this.yb.Na);const T=u.htmlElement.querySelector(".ShapeViewContent");var I=u.rotation;I>this.LNe&&I<this.NNe&&(this.uoa=!0);I=0;f.Rg&&(I=f.zt().sc(this.yb.Na).htmlElement.offsetTop);I+=u.htmlElement.offsetTop+T.parentNode.offsetTop+T.offsetTop;
u=I+T.offsetHeight;f=(this.uoa?!this.fv:this.fv)?u:I;I>=l&&I<=a&&u>=l&&u<=a&&(l=I,a=u,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}nQ(){this.rZd();this.Laa=!0;Ae.a.addHandler(this.Pjb,la.a.scroll,Object(R.a)(this,this.dqb,"updateRulerLocation"));this.Db.WZd(Object(R.a)(this,this.renderRuler,"renderRuler"));this.xd.zOc(Object(R.a)(this,this.Oqc,"onCloseTextEditView"));this.xd.zvb(Object(R.a)(this,this.nrc,"onOpenTextEditView"));
this.DF.Y2b(this.kza)}dqb(){if(this.Laa){var a=this.Jc.Ic;a&&a.Oy&&window.requestAnimationFrame(()=>{const b=Sd.a.qGa(a.Oy),c=Sd.a.qGa(this.yba);this.f7.style.marginTop=this.Ye.Rc(b.y-c.y+1)})}else ya.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}nrc(){this.Laa&&this.renderRuler()}Oqc(){this.Laa&&this.renderRuler()}rZd(){this.TK=this.sij();this.TK.appendChild(this.tij());this.yba.insertBefore(this.TK,this.yba.firstChild)}sij(){if(this.TK)return this.TK;this.TK=document.createElement("div");
this.TK.id=tr.hOi;this.TK.className=tr.gOi;this.TK.setAttribute(Qe.a.Rp,"ruler");this.TK.setAttribute(Qe.a.Ff,Qe.a.mEa);Sys.UI.DomElement.addCssClass(this.TK,this.d3d);return this.TK}tij(){if(this.f7)return this.f7;this.f7=document.createElement("div");this.f7.className=tr.fOi;this.f7.id=tr.iOi;return this.f7}}tr.hOi="WACVerticalRulerContainer";tr.gOi="WACVerticalRulerContainer";tr.iOi="WACVerticalRuler";tr.fOi="WACVerticalRuler";Object(m.a)(tr,"VerticalRuler",null,[949]);class hH{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.Ruler"}fc(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").enb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(fH,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().na(()=>new fH(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.WUb:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
A.AFrameworkApplication.isRtl));this.K.register(tr,"PowerPointWebEditor.Ruler.VerticalRuler").ma().na(()=>new tr(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.WUb:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),A.AFrameworkApplication.isRtl));this.K.register(836,"PowerPointWebEditor.Ruler.IRulerFactory").ma().na(()=>new jR(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(gH,
"PowerPointWebEditor.Ruler.RulerActor").ma().na(()=>new gH(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").qb();Cd.a.get_instance().Ij(8,()=>{this.JTe()})}}JTe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").e9j()}dispose(){}static main(){C.a.instance.Ac(new hH)}}
Object(m.a)(hH,"PPTWebEditorRulerPackage",null,[2,3]);class xC{static get gqm(){return xC.hqm}}xC.hqm="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(m.a)(xC,"ZoomDialogHtml",null,[]);class Lz extends zi.a{constructor(a,b,c,f,l){super(!1,!1,void 0===l?!1:l);this.q2b=this.p2b=this.Da=this.hDc=
null;this.bqm="ZoomDialogBoxGroup";this.dqm=(u,I)=>{if(1===u)for(u=0;u<this.kSa.length;u++)if(I[this.Zuc+u]){this.GIf(this.fNc[u]);break}};this.Ytd=u=>{this.JYc(u.target)};this.cqm=u=>{u=u.Ec;if(!u||!u.parentNode||"label"!==u.tagName.toLowerCase()&&!u.className.startsWith(this.Uyh))return!1;u=this.pkg(u);u=document.getElementById(this.Zuc+u);this.JYc(u);return!0};this.iqm=(u,I)=>{1===u&&(u=Number.parseInvariant(I.selectedOption.toString()),this.GIf(this.fNc[u]))};this.eqm=u=>{u=u.hc.keyCode;if(u!==
Sys.UI.Key.down&&u!==Sys.UI.Key.right&&u!==Sys.UI.Key.up&&u!==Sys.UI.Key.left)return!1;let I=this.pkg(this.r9);const T=this.kSa.length-1;if(u===Sys.UI.Key.down||u===Sys.UI.Key.right)I=I<T?I+1:0;else if(u===Sys.UI.Key.up||u===Sys.UI.Key.left)I=0<I?I-1:T;u=document.getElementById(this.Zuc+I);this.JYc(u);return!0};this.kSa=a;this.fNc=b;this.GIf=c;this.Wd=f;this.Wg=this.mKi();this.Fd=1;this.Fg="ZoomDialog"}get a1e(){return"ListRadioBox"}get Zuc(){return"radiobox"}get Uyh(){return"WACZoomDialogRadioRow"}get $0e(){return"WACZoomDialogRadioRow-highlight"}get Bp(){return this.Wd}get r9(){return this.hDc}vSh(a,
b){if(this.$L)this.f2l(a,b);else{const c={};for(let f=0;f<this.kSa.length;f++)c[this.Zuc+f]=this.fNc[f]===b?!0:!1;this.Vj(a,this.dqm,c);this.E1e();this.p2e()}}f2l(a,b){const c=Array(this.kSa.length);let f="";for(let l=0;l<this.kSa.length;l++){const u=l.toString();c[l]={["key"]:u,["text"]:this.kSa[l]};b===this.fNc[l]&&(f=u)}b={};b.dialogChoiceGroupProps={["id"]:this.bqm,["defaultSelectedKey"]:f,["options"]:c};this.Vj(a,this.iqm,{["id"]:"OptionsDialog",["bodyControls"]:b})}FLl(){this.hDc=document.getElementsByName(this.a1e)[0];
this.JYc(this.r9)}C9(){this.Da||(this.Da=document.getElementById("WACDialogText"));this.Da&&(this.p2b||(this.p2b=this.cqm,this.to.xb(la.a.click,this.Da,this.p2b)),this.q2b||(this.q2b=this.eqm,this.lh.xb(la.a.Vf,this.Da,this.q2b)));super.C9();this.Nb&&this.lh.xb(la.a.rm,this.Nb,Object(R.a)(this,this.FU,"dialogDefaultEnterKeyHandler"))}E1e(){this.Bp.gm().scope.Sy(F.FocusManager.instance().ata);this.Bp.gm().scope.Sy(F.FocusManager.instance().bta);this.Bp.gm().scope.bindAction(F.FocusManager.instance().ata,
N.a.GCc);this.Bp.gm().scope.bindAction(F.FocusManager.instance().bta,N.a.FCc)}p2e(){const a=document.getElementsByName(this.a1e);for(let b=0;b<a.length;b++){const c=a[b];Ae.a.addHandler(c,la.a.focus,this.Ytd);c.checked&&(this.hDc=c)}}FU(a){return a.eventName===la.a.rm&&a.hc.keyCode===Sys.UI.Key.enter?(super.FU(a),!0):!1}JYc(a){a&&(a.checked=!0,this.Bp.Je&&this.Bp.Je.name===this.uM||this.Bp.Df(this.uM),this.Bp.gm().jk.bG(a),a.focus(),this.r9&&Sys.UI.DomElement.removeCssClass(this.r9.parentNode,this.$0e),
Sys.UI.DomElement.addCssClass(a.parentNode,this.$0e),this.hDc=a)}pkg(a){return Number.parseInvariant(Aa.a.substr(a.id,a.id.length-1,1))}IB(){super.IB();const a=document.getElementById(this.ki("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);a.style.width=String.format("{0}px",200)}mKi(){let a="";for(let b=0;b<this.kSa.length;b++)a+=zi.a.oC(Lz.fqm,b.toString(),this.kSa[b],this.a1e);return a}dispose(){this.Da&&(this.to&&this.p2b&&this.to.Hb(la.a.click,this.Da,this.p2b),this.lh&&this.q2b&&
this.lh.Hb(la.a.Vf,this.Da,this.q2b));this.to&&this.Nb&&this.lh.Hb(la.a.rm,this.Nb,Object(R.a)(this,this.FU,"dialogDefaultEnterKeyHandler"));super.dispose()}}Lz.fqm=xC.gqm;Object(m.a)(Lz,"ZoomDialog",zi.a,[972]);class iH{constructor(){this.Nf=null}create(a,b,c,f){return this.Nf=new Lz(a,b,c,f)}}Object(m.a)(iH,"ZoomDialogFactory",null,[1010]);class jH{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}fc(a){this.Da=a;this.Da.register(iH,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").na(()=>
new iH).ma()}static main(){C.a.instance.Ac(new jH)}}Object(m.a)(jH,"ZoomPackage",null,[2,3]);class kR{constructor(a,b,c,f,l,u,I,T){this.aVk=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%","50%","33%"];this.Mld="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.Nf=null;this.ia=a;this.Fa=b;this.Wb=l;this.Mj=c;this.Db=f;this.jm=u;this.AMg=I;this.yb=T}qb(){this.ia.pa(M.a.W0e,wc.a.application,Object(R.a)(this,this.Jol,"queryZoom"),96);this.ia.xa(M.a.oWe,wc.a.application,Object(R.a)(this,
this.x0j,"handleZoomConfig"));this.ia.xa(M.a.HCc,wc.a.application,Object(R.a)(this,this.y0j,"handleZoomToFit"));this.ia.xa(N.a.GCc,Le.a.frame,Object(R.a)(this,this.s6h,"zoomDialogTabFocusHandler"));this.ia.xa(N.a.FCc,Le.a.frame,Object(R.a)(this,this.s6h,"zoomDialogTabFocusHandler"));A.AFrameworkApplication.fa.getBooleanAppSetting("ZoomSliderIsEnabled")&&(this.ia.xa(N.a.Eyb,Le.a.frame,Object(R.a)(this,this.Eyb,"decreaseZoom")),this.ia.xa(N.a.XCb,Le.a.frame,Object(R.a)(this,this.XCb,"increaseZoom")),
this.ia.xa(N.a.jqm,Le.a.frame,Object(R.a)(this,this.Bal,"onZoomToPercentage")),this.ia.pa(N.a.Kol,Le.a.frame,Object(R.a)(this,this.z8k,"onQueryZoomPercentage"),96),md.a("ZoomShortCutsEnabled")&&(this.ia.xa(G.a.D2f,Le.a.frame,ff.ActionManager.uh),this.ia.xa(G.a.C2f,Le.a.frame,ff.ActionManager.uh)))}Sd(){if(A.AFrameworkApplication.fa.getBooleanAppSetting("ZoomSliderIsEnabled")&&md.a("ZoomShortCutsEnabled")){const a=this.Fa.Kc(xc.a.Nj);a.bindAction(B.KeyInputManager.Va(H.a.LFd,B.KeyInputManager.Ze),
N.a.XCb);a.bindAction(B.KeyInputManager.Va(H.a.OFd,B.KeyInputManager.Ze),N.a.XCb);a.bindAction(B.KeyInputManager.Va(H.a.MFd,B.KeyInputManager.Ze),N.a.Eyb);a.bindAction(B.KeyInputManager.Va(H.a.qCc,B.KeyInputManager.Ze),N.a.Eyb);this.AMg&&Ta.a.instance.xb(la.a.pLb,this.AMg,Object(R.a)(this,this.uCi,"adjustZoomOnMouseWheel"))}}uCi(a){var b;if(!a)return!1;if(a.I0){if(md.a("ZoomShortCutsDisabledForSlideSorterViewV2")&&1==(null===(b=this.yb)||void 0===b?void 0:b.$i))return!0;0<a.J5h?this.UOa(this.hjh):
0>a.J5h&&this.UOa(this.ijh);return!0}return!1}get rab(){return Math.round(100*this.Mj.lW)}get ijh(){return Math.floor(this.rab/10)/10+.1}get hjh(){return Math.ceil(this.rab/10)/10-.1}Jol(a,b,c,f,l){if(!l||isNaN(this.rab)||0==this.rab)return 8;l[cG.a.LabelText]=Math.round(100*this.Mj.lW)+"%";this.jm&&(this.jm.MS(this.jm.wca,this.jm.Ejf),this.jm.Epa(this.jm.wca,this.jm.Ejf));return 32}x0j(a,b,c,f,l){if(1===c)return this.Wb.Hi()?32:8;if(!l)return 8;this.Nf=new Lz(this.aVk,this.Mld,Object(R.a)(this,this.BGd,
"zoomSettingAction"),F.FocusManager.instance(),!0);this.Nf.vSh(CommonUIStrings.l_ZoomDialogTitle,this.Mj.hna?this.Mld[0]:this.Mj.lW.toString());return 32}BGd(a){if(a!==this.Mld[0]){const b=parseFloat(a);if(isNaN(b)){ya.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.Mj.hna=!1;this.Mj.lW=b;this.Mj.qqb=2}else this.Mj.hna=!0;this.Db.qv();ya.a.J(512288458,827,50,"Succeeded to Zoom: {0}",a)}y0j(a,b,c,f,l){if(1===c)return this.Wb.Fn&&!this.Wb.Hi()?8:32;if(!l)return 8;if(!this.Wb.Fn)return ya.a.J(509212699,
827,50,"Content Editable hasn't reached yet as presentation node hasn't been set"),8;this.BGd(this.Mld[0]);return 32}s6h(a){if(!this.Nf)return 8;var b=this.Nf.Bp.gm().jk.L0;if(b===this.Nf.ex&&a===N.a.GCc||b===this.Nf.HE&&a===N.a.FCc)this.Nf.r9||this.Nf.FLl(),this.Nf.Bp.gm().jk.bG(this.Nf.r9);else if(b.id.startsWith(this.Nf.Zuc)||b.className.startsWith(this.Nf.Uyh))b=null,a===N.a.GCc?b=this.Nf.HE:a===N.a.FCc&&(b=this.Nf.ex),this.Nf.Bp.gm().jk.bG(b),Sys.UI.DomElement.removeCssClass(this.Nf.r9.parentNode,
this.Nf.$0e);else if(a===N.a.GCc)this.Nf.Bp.gm().sLb();else if(a===N.a.FCc)this.Nf.Bp.gm().qLb();else return 16;return 32}XCb(a,b,c){var f;if(1===c||md.a("ZoomShortCutsDisabledForSlideSorterViewV2")&&1==(null===(f=this.yb)||void 0===f?void 0:f.$i))return 32;this.UOa(this.ijh);ya.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");return 32}Eyb(a,b,c){var f;if(1===c||md.a("ZoomShortCutsDisabledForSlideSorterViewV2")&&1==(null===(f=this.yb)||void 0===f?void 0:f.$i))return 32;this.UOa(this.hjh);
ya.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}Bal(a,b,c,f,l){if(1===c)return 32;a=l.value/100;this.UOa(a);ya.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.ED=Math.floor(100*a));return 32}z8k(a,b,c,f,l){if(isNaN(this.rab)||0==this.rab)return 8;l.MinValue=10;l.MaxValue=400;l.value=this.rab;return 32}UOa(a){.1>a?a=.1:4<a&&(a=4);this.Mj.hna=!1;this.Mj.lW=a;this.Mj.qqb=2;this.Db.qv()}}Object(m.a)(kR,"ZoomActor",null,[948]);class kH{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}fc(a){this.K=
a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");const b=this.K.resolve("Common.IActionManagerExtended"),c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new kR(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.h0d,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"));a.qb();a.Sd()}dispose(){}static main(){C.a.instance.Ac(new kH)}}Object(m.a)(kH,"PPTWebEditorZoomPackage",
null,[2,3]);var lR=d(525);class mR{constructor(a){this.te=a}X0f(a,b,c,f,l,u){const I=this.te.Ok(c+".png");c=mp.getImageClassWithCluster(c,f);return mp.createClusteredImageFromClusterWithImageClass(a,b,c,I,32===a&&32===b?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,l,null,u)}}Object(m.a)(mR,"ShapeGlyphImageFactory",null,[725]);var nR=d(701);class oR{constructor(a,b){this.sdd=this.V1=null;this.QDe=this.w_g=0;this.Ye=a;this.Jc=b}dispose(){this.clear();this.V1.parentNode.removeChild(this.V1)}add(a,
b){this.M7e(!1);a=this.Sui(a,b);this.Oik()||this.Qqk(a)?this.L7e(-1*(Math.ceil(a.offsetWidth)+2)):this.L7e(this.QDe);this.M7e(!0)}clear(){this.Ye.qw(this.sdd);this.M7e(!1);this.L7e(0)}fTa(a,b,c){this.w_g=c;this.QDe=b;this.V1=this.Ye.we();this.V1.className="prFlyout UISmallFont";a.appendChild(this.V1);this.sdd=this.Ye.a7b();this.V1.appendChild(this.sdd)}Sui(a,b){const c=this.Ye.j1f();c.style.backgroundColor=a;c.style.lineHeight=this.Ye.Rc(this.w_g);this.Ye.yA(c,b);this.sdd.appendChild(c);return c}Qqk(a){a=
this.Ye.wi(a);const b=this.Ye.wi(this.Jc.Ic.Oy);return a.x+a.width+this.QDe>b.x+b.width}Oik(){return 0>this.Ye.zo(this.V1.style.left)}M7e(a){this.V1.style.visibility=a?sj.a.visible:sj.a.hidden}L7e(a){this.V1.style.left=this.Ye.Rc(a)}}Object(m.a)(oR,"ShapePawnFlyout",null,[831]);var cU=d(1006),dU=d(1328),eU=d(1319);class lH{constructor(a,b,c,f,l){this.V2d=1;this.inc=[];this.sgb=null;this.Tic=this.yJb=!1;this.Nnc=this.ul=this.jv=null;(this.Jw=A.AFrameworkApplication.fa.getBooleanAppSetting("PPTCanvasPresenceBubbleUXEnabled"))?
(this.ul=a,this.Nnc=l,this.N5i()):this.xz=Object(gb.a)(nR.a,f.a2f(a,b,c,Object(R.a)(this,this.FN,"onPointerOver"),Object(R.a)(this,this.hH,"onPointerOut"),l))}r$(){if(this.Jw)return this.KIj();const a=Array.clone(this.Yha);if(this.LX){let b=!1;for(const c of this.Yha)if(c.clientId===this.LX.clientId){b=!0;break}b||Array.add(a,this.LX)}return a}dispose(){this.Jw?this.Scj():(this.inc=this.sgb=null,this.xz.dispose())}$B(a){if(this.Jw)this.$wi(a);else if(a){for(const b of this.Yha)if(b.clientId===a.clientId)return;
Array.add(this.Yha,a);this.refresh()}}qQ(a){if(this.Jw)this.kAl(a);else if(a)for(const b of this.Yha)if(b.clientId===a.clientId){Array.remove(this.Yha,b);this.refresh();break}}clear(){this.Jw?this.KTi():(this.inc=[],this.xz.clear())}get LX(){return this.sgb}set LX(a){this.sgb!==a&&(this.sgb=a,this.sgb||(this.Tic=!1),this.Jw||this.refresh())}K$e(){this.Jw||(this.LX?(this.Tic=!0,this.ePb()):ya.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}kaf(){this.Jw?
this.k1l():(this.yJb=!0,this.sgb&&(this.Tic=!0),this.ePb())}foe(){this.Jw?this.M2j():(this.yJb=!1,this.ePb())}setZIndex(a){this.Jw?this.kVl(a):this.xz.setZIndex(a)}get A1a(){return this.LX?this.LX.color:this.Yha&&this.Yha.length?this.Yha[this.Yha.length-1].color:Dj.a.none}z3c(){return!!this.sgb||0<this.inc.length}get Yha(){return this.Jw?this.jv.NNb:this.inc}C2j(){this.xz.W4e();this.xz.N4d()}hH(){this.z3c()&&(this.yJb=!1,this.ePb());return!0}FN(){this.z3c()&&(this.yJb=!0,this.ePb());return!0}qim(){this.z3c()?
this.xz.aMh(1<this.inc.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.A1a):this.xz.vTa()}refresh(){this.qim();this.ePb()}ePb(){this.C2j();if(this.yJb)if(this.LX){this.xz.K2b(this.LX.color,String.format(ResourceStrings.l_TypingHint,this.LX.userName));for(const a of this.Yha)this.LX.clientId!==a.clientId&&this.xz.K2b(a.color,a.userName)}else for(const a of this.Yha)this.xz.K2b(a.color,a.userName);else this.Tic&&(this.LX?this.xz.K2b(this.LX.color,String.format(ResourceStrings.l_TypingHint,
this.LX.userName)):ya.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.yJb||this.Tic)&&this.xz.XQe()}BRb(a,b){this.jv&&this.jv.BRb(a,b)}Scj(){this.jv&&this.jv.dispose()}eZe(){return Df.a.wi(document.body)}$wi(a){a?this.jv?(ya.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",a.clientId),this.jv.$B(a)):ya.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):
ya.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}kAl(a){a?this.jv?(ya.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",a.clientId),this.jv.qQ(a.clientId)):ya.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):ya.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}KTi(){if(this.jv){ya.a.J(42472543,814,
50,"ShapePresencePawn:Clear at PresencePawn ");var a=this.r$();if(a)for(const b of a)this.qQ(b);else ya.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else ya.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}KIj(){return this.jv?this.jv.NNb:null}k1l(){this.jv&&(this.jv.PNa(),this.jv.LNa())}M2j(){this.jv&&this.jv.PNa()}kVl(a){this.ul.style.zIndex=String(a)}hQj(a){const b=new dU.a;b.add(0,mp.getImageClassWithCluster(A.AFrameworkApplication.dP,
"MoreUsersGlyph_16x16x32"));b.add(5,A.AFrameworkApplication.Mm);b.add(1,mp.getImageClassWithCluster(A.AFrameworkApplication.dP,"DoughboyWhiteGlyph_20x20x32"));b.add(4,A.AFrameworkApplication.Mm);b.add(6,20);b.add(8,A.AFrameworkApplication.isRtl);b.add(12,a);b.add(11,!1);b.add(16,Object(R.a)(this,this.eZe,"presenceViewportBoundsCallback"));return new eU.a(b)}N5i(){this.jv=this.hQj(this.rlg()).J6b(this.ul);Sys.UI.DomElement.addCssClass(this.jv.element,"ShapePawnContainer")}xUi(){const a=this.r$();if(a)for(const b of a)this.BRb(b.clientId,
!1)}rlg(){return this.V2d+mz.a.hja+mz.a.hja}XQe(){this.Nnc.va.style.zIndex=String(this.rlg())}}Object(m.a)(lH,"ShapePresencePawn",null,[829,830,106,723]);var fU=d(1005);class pR{constructor(a,b,c,f,l){this.Ts=a;this.hd=b;this.Ye=c;this.bjb=f;this.Jc=l}F6i(a,b,c,f){this.Ye.addCssClass(a,"ShapeModernCatchupPawnContainer");return new fU.a(a,b,"pegal",this,c,f)}D6i(a,b,c){this.Ye.addCssClass(a,"ShapePawnContainer");return new lH(a,b,"per",this,c)}a2f(a,b,c,f,l,u){return new nR.a(a,b,c,f,l,null,this,this.bjb,
this.Ye,this.Ts,this.hd,u)}B6i(){return new oR(this.Ye,this.Jc)}C6i(){return new cU.a(this.Ye)}}Object(m.a)(pR,"ShapePawnFactory",null,[724]);var To=d(655);class qR{constructor(a,b,c,f,l,u){this.wVg=!1;this.Eo=null;this.uhb=!1;this.qpc=this.VC=this.UC=0;this.Jd=1;this.Ojc=!1;this.Mb=this.kic=!0;this.iB=!1;this.FV=!0;this.IEe=!1;this.q6=void 0===u?16:u;this.BKa=new no.a;this.K1=new XB.a;this.By=new Fm.a;this.$G=new Fm.a;this.BI=new Fm.a;this.H6=new no.a;this.eH=new NF.a;this.Nv=new NF.a;this.gb=a;
this.xz=b?b(this.H6.va,this.q6,l):null;this.ta=c;this.saa=f}dispose(){this.saa();this.BKa&&(this.BKa.va.parentNode&&this.BKa.mr(),this.K1&&this.K1.viewport&&this.K1.viewport.mr(),this.By&&this.By.mr(),this.$G&&this.$G.mr(),this.BI&&this.$G.mr());this.xz&&this.xz.dispose();this.H6=this.BI=this.$G=this.By=this.K1=this.BKa=null;this.Mb=!1}get OOh(){return this.xz}get shape(){return this.ta}get meb(){return this.wVg}set meb(a){this.q6=a?20:16;this.wVg=a}get wDg(){return this.uhb}set wDg(a){this.q6=16;
this.uhb=a}Cn(a){this.BKa.appendChild(this.K1.viewport);this.BKa.appendChild(this.H6);this.By.UF(Dj.a.none);this.uhb?this.By.vs(jf.a.o9e):this.By.vs(jf.a.r9e);this.$G.UF(Dj.a.none);this.$G.vs(To.a.vSc);this.BI.UF(Dj.a.none);this.BI.vs(To.a.Q5d);this.K1.appendChild(this.BI);this.K1.appendChild(this.$G);this.K1.appendChild(this.By);this.setVisibility();this.o7f();a.appendChild(this.BKa)}wE(){}Jq(){return this.K1.Jq()}EDb(){return!1}Ry(){}setVisibility(){const a=this.Mb&&(!this.iB||!this.FV);this.H6.ee(a);
this.By.ee(a);this.$G.ee(a);this.BI.ee(a);this.BKa.ee(this.Mb)}Xz(){}jF(){return null}bD(){return[]}o7f(){this.Eo=this.ta.Ko.copy();this.By.vs(this.IEe?To.a.TYf:this.uhb?jf.a.o9e:jf.a.r9e);this.$G.vs(To.a.vSc);this.BI.vs(To.a.Q5d);this.$s();this.setVisibility()}draw(){this.visible=!0;this.o7f()}get visible(){return this.Mb}set visible(a){this.Mb!==a&&(this.Mb=a,this.setVisibility(),this.$s())}get Bwb(){return this.kic}set Bwb(a){this.kic=a;this.By.ee(this.Mb&&this.kic);this.$G.ee(this.Mb&&this.kic);
this.BI.ee(this.Mb&&this.kic)}setPosition(a,b){this.UC=a;this.VC=b;this.$s()}Pj(a){this.Jd=a;this.$s()}Kr(a){this.eH=a;this.$s()}Tv(a){this.Nv=a;this.$s()}setZIndex(a){this.qpc=a;this.BKa.xE(this.qpc);this.K1.xE(this.qpc);this.H6.xE(this.qpc);this.xz&&this.xz.setZIndex(this.qpc)}TF(a,b){this.iB=a;this.FV=b;this.setVisibility()}iUb(a){this.xz&&this.By.Vv((void 0===a?null:a)||this.xz.A1a);this.By&&(this.By.Tqa(""),this.By.UF(Dj.a.none),this.uhb?this.By.vs(jf.a.o9e):this.By.vs(jf.a.r9e),this.By.lca(""))}HTi(){this.By&&
this.$G&&this.BI&&(this.IEe=!1,this.By.lca(""),this.$G.lca(""),this.By.Vv(Dj.a.none),this.By.zAa(0),this.$G.Vv(Dj.a.none),this.$G.zAa(0),this.BI.Vv(Dj.a.none),this.BI.zAa(0))}chf(a,b){b=void 0===b?!1:b;if(this.By&&this.$G&&this.BI){this.IEe=!0;var c=0===a;this.By.vs(To.a.TYf);this.$G.vs(2===a?To.a.DWi:To.a.vSc);this.BI.vs(To.a.Q5d);this.By.Vv(c?Dj.a.none:To.a.BWi);this.$G.Vv(c?Dj.a.none:To.a.xWi);switch(a){case 2:this.BI.Vv(To.a.AWi);break;case 1:this.BI.Vv(To.a.yWi);break;default:this.BI.Vv(To.a.zWi)}1===
a?this.dbg():b?this.dbg():(this.By.zAa(1),this.$G.zAa(1),this.BI.zAa(1))}}dbg(){this.ebg(0)}ebg(a){this.By&&this.$G&&this.BI&&!(1<a)&&(a+=.05,this.By.zAa(a),this.$G.zAa(a),this.BI.zAa(a),window.setTimeout(()=>{this.ebg(a)},10))}$s(){if(this.Eo){var a=this.Eo.copy();this.eH.Zm(a);this.Nv.Zm(a);a.move(this.UC,this.VC);a.scale(this.Jd,this.Jd);this.ahm(a);this.xjm(a)}}ahm(a){if(this.By&&this.$G&&this.BI&&a){var b=this.YTf(To.a.CWi,a),c=this.YTf(To.a.vSc,b);this.BI.yu(c.points);this.K1.Gm();this.BI.ee(this.Mb&&
(!this.iB||!this.FV));this.$G.yu(b.points);this.K1.Gm();this.$G.ee(this.Mb&&(!this.iB||!this.FV));this.By.yu(a.points);this.K1.Gm();this.By.ee(this.Mb&&(!this.iB||!this.FV));E.a.Meb&&this.ta&&this.ta.vd&&this.gb.Kzg()&&this.K1.viewport.Mh(this.K1.viewport.width,0)}}$pc(){if(this.meb){var a=this.H6.x,b=this.H6.y;this.gb.zY(this.ta)&&!this.Ojc&&(this.H6.setPosition(a,b-18),this.Ojc=!0)}}RRe(){if(this.meb){var a=this.H6.x,b=this.H6.y;this.Ojc&&!this.gb.zY(this.ta)&&(this.H6.setPosition(a,b+18),this.Ojc=
!1)}}YTf(a,b){var c=b.el(Ge.a.IF),f=b.el(Ge.a.Pv);c=Re.a.VS(pd.a.IJ(f,c));new pd.a(0,0);let l;new pd.a(0,0);let u;new pd.a(0,0);new pd.a(0,0);b.rotate(-c);const I=b.points;f=new pd.a(I[0]._x+a,I[0]._y+a);l=new pd.a(I[1]._x-a,I[1]._y+a);u=new pd.a(I[2]._x-a,I[2]._y-a);a=new pd.a(I[3]._x+a,I[3]._y-a);a=new ej.a(f,l,u,a);a.rotate(c);b.rotate(c);return a}xjm(a){if(a){var b=a.el(Ge.a.IF),c=a.el(Ge.a.Pv),f=Re.a.VS(pd.a.IJ(c,b));b=a.el(Ge.a.IF);c=a.el(Ge.a.Pv);90<=f&&(b=a.el(Ge.a.Pv),c=a.el(Ge.a.hJ));180<=
f&&(b=a.el(Ge.a.hJ),c=a.el(Ge.a.ZF));270<=f&&(b=a.el(Ge.a.ZF),c=a.el(Ge.a.IF));f=pd.a.IJ(c,b);var l=this.fIj(f);a=Math.cos(f)*l;f=Math.sin(f)*l;l=this.meb?this.q6/2-1:this.uhb?this.q6/2:this.q6;this.uhb?this.H6.setPosition(c.x-l,c.y-l):this.H6.setPosition(b.x-a,b.y-f-l);this.H6.ee(this.Mb&&(!this.iB||!this.FV));this.meb&&(this.Ojc=!1,this.$pc())}}fIj(a){return(this.meb?10:15)-Re.a.VS(a)/6}}Object(m.a)(qR,"ShapePawnView",null,[828]);class rR{s8d(a,b,c,f,l){return new qR(a,b,c,f,l,16)}}Object(m.a)(rR,
"ShapePawnViewFactory",null,[726]);class sR extends Sys.EventArgs{constructor(a){super();this.shape=a}}Object(m.a)(sR,"ShapeViewElementPresenceStateChangedEventArgs",Sys.EventArgs,[]);class tR{constructor(a,b){this.Og=a;this.ta=this.Og.shape;this.ta.Bt=!1;this.nNg=new sR(this.ta);this.Kj=Object(gb.a)(lH,this.Og.OOh);this.kfh=b;(this.sRg=A.AFrameworkApplication.fa.getBooleanAppSetting("PPTCanvasPresenceBubbleUXEnabled"))&&this.Og&&(this.Og.meb=!0)}Cn(a){this.Og.Cn(a)}wE(a){this.Og.wE(a)}Jq(){return this.Og.Jq()}aP(a){return this.Og.EDb(a)}Ry(a){this.Og.Ry(a)}$pc(){this.Og.$pc()}RRe(){this.Og.RRe()}dispose(){this.Og.dispose()}Xz(){this.Og.Xz()}jF(a){return this.Og.jF(a)}bD(a){return this.Og.bD(a)}draw(a,
b){this.Og.draw(a,b)}get visible(){return this.Og.visible}set visible(a){this.Og.visible=a}setPosition(a,b){this.Og.setPosition(a,b)}Pj(a){this.Og.Pj(a)}Kr(a){this.Og.Kr(a)}Tv(a){this.Og.Tv(a)}setZIndex(a){this.Og.setZIndex(a)}TF(a,b){this.Og.TF(a,b)}setSelection(){}Mka(a){a&&(this.VSa(),this.Kj.$B(a),this.Og.iUb(),this.Og.setVisibility(),ya.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",a.clientId,this.Kj.A1a,this.ta?this.ta.ln:"null_moniker"))}u2a(a){if(a&&
this.Kj){this.Kj.qQ(a);this.Og.iUb();var b=this.Kj.r$();b&&b.length?ya.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",a.clientId,this.Kj.A1a,this.ta?this.ta.ln:""):ya.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",a.clientId,this.ta?this.ta.ln:"null_moniker");this.Og.setVisibility();this.hEa()}}oXf(){this.Kj.clear();
this.Og.iUb();this.hEa()}K$e(){this.Kj.K$e()}k_l(){this.Kj.kaf()}Efa(){this.Kj.foe()}oFd(a){a&&this.VSa();this.Kj&&(this.Kj.LX=a);this.Og.iUb();this.sRg&&this.Kj&&(this.Kj.LX?this.Kj.BRb(a.clientId,!0):this.Kj.xUi());a||this.hEa()}get Hlb(){return this.Kj}get Ine(){return this.Kj.z3c()}get Bwb(){return this.Og.Bwb}set Bwb(a){this.Og.Bwb=a}VSa(){this.ta.Bt||this.Ine||(this.ta.Bt=!0,this.kfh.Qzh(this.nNg))}hEa(){this.ta.Bt&&!this.Ine&&(this.ta.Bt=!1,this.kfh.Qzh(this.nNg))}}Object(m.a)(tR,"ShapePresenceView",
null,[804,805,806,106]);var gU=d(342);class yC{get name(){return"PowerPointWebEditor.ShapePresence"}fc(a){Object(Ti.a)("ShapePresence");a.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().na(()=>new gU.a((b,c)=>{let f=null;const l=Object(gb.a)(178,b.sc(a.resolve("Box4.IPageView").Na));l&&!l.hm&&(b=a.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").s8d(a.resolve("PowerPointWebEditor.IPptSelectionManager"),(u,I,
T)=>Object(gb.a)(723,a.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").D6i(u,I,T)),b,c,l.oW),f=new tR(b,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),f.Cn(l.oW),l.vta(f,1),f.visible=l.KR||l.Oo);return f}));a.register(724,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().na(()=>new pR(a.resolve("Common.IPointerInputManager"),a.resolve("Common.IClickInputManager"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
a.resolve("PowerPointWebEditor.IActiveSlideViewManager")));a.register(725,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().na(()=>new mR(a.resolve("PowerPoint.IPathManager")));a.register(726,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().na(()=>new rR)}init(){Object(Ti.b)("ShapePresence")}dispose(){}static main(){C.a.instance.Ac(new yC)}}Object(m.a)(yC,"PPTWebEditorShapePresencePackage",null,[2,3]);class mH{constructor(){this.K=null;this.lZ=[new yC]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}fc(a){this.K=
a;for(const b of this.lZ)b.fc(a)}init(){for(const a of this.lZ)a.init();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").OBg=!0;Mg.a.instance.Xb(lR.a.vce,(new Date).getTime())}dispose(){}static main(){Mg.a.instance.Xb(lR.a.wce,(new Date).getTime());C.a.instance.Ac(new mH)}}Object(m.a)(mH,"PptExtCommonPackage",null,[2,3]);var hU=d(556),zC=d(690),AC=d(245);class nH{get name(){return"Common.App.OAuth.OAuthPackage"}fc(a){a.register(768,"Common.App.OAuth.IOAuthManager").ma().na(()=>new hU.OAuthManager)}init(){const a=
Tb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Oem(a);this.Nem(a)}Nem(a){if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var b=A.AFrameworkApplication.fa.Ea("FileSource");if(A.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost")||A.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost")||"WopiTest"===b){var c=AC.a.iTc;if(c&&c.IsEnabled){var f=c.Application,
l=AC.a.authority;if(void 0!==f&&null!==f&&f.length&&void 0!==l&&null!==l&&l.length){var u=zC.a[a.vT],I=E.a.nx,T=a.pC(),ja=Sd.a.jj();a.vH("CAETest",f).then(ua=>{const Ra=Math.floor(Sd.a.jj()-ja);u=zC.a[a.vT];I=E.a.nx;T=a.pC();da.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Ra,ua.IsSuccess,u,ua.ErrorCode,b,I,T);if(ua.IsSuccess){ua="Bearer "+
ua.Token;A.AFrameworkApplication.Me.eGd=ua;var eb=c.Endpoint;if(eb){var Bb=Sd.a.jj();ua={["Authorization"]:ua};eb=oe.a.Xi(eb,"ReturnRawToken","1");eb=oe.a.Xi(eb,"EnforceCAE","1");A.AFrameworkApplication.Me.y9a(eb,1,null,ua,2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Ub=>{var Xb=Math.floor(Sd.a.jj()-Bb),tc=null;Ub.Ao?Ub="Canceled":Ub.Pm?Ub="Faulted":(tc=Ub.result,Ub=tc.succeeded?"Completed":"Failed");Xb={["TaskResult"]:Ub,["BrowserTokenDurationMS"]:Ra,["BrowserValidationDurationMS"]:Xb};
tc&&(Xb.HttpStatus=tc.Hj.data.Ke,tc.succeeded&&(tc=Fe.a(tc.Hj.data.Ud),Xb.ServerValidationDurationMS=tc.ElapsedMilliseconds,Xb.ServerValidationResult=tc.ValidatedToken,Xb.KMSI=tc.KMSI,Xb.Scopes=tc.Scopes,Xb.TokenExpirationS=Math.floor(parseInt(tc.Expiration)-(new Date).getTime()/1E3)));da.ULS.sendTraceTag(508950354,3E3,"Completed"===Ub?50:15,Qa.a.toJSON(Xb))})}}else da.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",ua.ErrorCode,ua.ErrorMessage)}).catch(ua=>
{const Ra=Math.floor(Sd.a.jj()-ja);da.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",ua.toString(),Ra)})}}}}}Oem(a){const b=A.AFrameworkApplication.fa.Ea("FileSource");if(A.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost")||A.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost")||"WopiTest"===b){var c=AC.a.iTc;if(c&&c.IsEnabled){var f=c.Application,l=AC.a.authority;if(void 0!==f&&null!==f&&f.length&&void 0!==l&&null!==l&&l.length){var u=
zC.a[a.vT],I=E.a.nx,T=a.pC();try{var ja=new Map;void 0!==ja&&null!==ja?(ja.set("SupportStatus",u),ja.set("Browser",I),ja.set("AuthStrategy",T)):ja=null}catch(Ra){ja=null}eg.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ja);var ua=Sd.a.jj();a.vH("Core",f).then(Ra=>{const eb=Math.floor(Sd.a.jj()-ua);u=zC.a[a.vT];I=E.a.nx;T=a.pC();da.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
eb,Ra.IsSuccess,u,Ra.ErrorCode,b,I,T);ja&&(ja.set("SupportStatus",u),ja.set("Browser",I),ja.set("AuthStrategy",T));var Bb=Object.assign(new Fl.a,{durationMs:eb,extendedProperties:ja});if(Ra.IsSuccess){if(eg.Health.instance.recordKpiSuccess("WacCorePFT",Bb),Ra="Bearer "+Ra.Token,A.AFrameworkApplication.Me.eGd=Ra,Bb=c.Endpoint){var Ub=Sd.a.jj();A.AFrameworkApplication.Me.y9a(Bb,1,null,{["Authorization"]:Ra},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Xb=>{var tc=Math.floor(Sd.a.jj()-
Ub),lc=null;Xb.Ao?Xb="Canceled":Xb.Pm?Xb="Faulted":(lc=Xb.result,Xb=lc.succeeded?"Completed":"Failed");tc={["TaskResult"]:Xb,["BrowserTokenDurationMS"]:eb,["BrowserValidationDurationMS"]:tc};lc&&(tc.HttpStatus=lc.Hj.data.Ke,lc.succeeded&&(lc=Fe.a(lc.Hj.data.Ud),tc.ServerValidationDurationMS=lc.ElapsedMilliseconds,tc.ServerValidationResult=lc.ValidatedToken,tc.KMSI=lc.KMSI,tc.Scopes=lc.Scopes,tc.TokenExpirationS=Math.floor(parseInt(lc.Expiration)-(new Date).getTime()/1E3)));da.ULS.sendTraceTag(520632322,
3E3,"Completed"===Xb?50:15,Qa.a.toJSON(tc))})}}else eg.Health.instance.recordKpiFailure("WacCorePFT",Ra.ErrorCode,!1,!1,Bb)}).catch(Ra=>{var eb=Math.floor(Sd.a.jj()-ua);eb=Object.assign(new Fl.a,{durationMs:eb,extendedProperties:ja});eg.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Ra.toString(),!1,!1,eb)})}}}}dispose(){}static main(){C.a.instance.Ac(new nH)}}Object(m.a)(nH,"OAuthPackage",null,[2,3]);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");
Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");
Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");
Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");
Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");
Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.ShapePresence");window.g_hermesExtJS=
Date.now();Object(Ti.d)("Ext");ba.main();sa.main();Za.main();Ic.main();Sl.main();Jg.main();jj.main();pj.main();Kz.main();Zn.main();hl.main();Je.main();Wo.main();Gm.main();Eo.main();eo.main();zp.main();cq.main();Bq.main();Dq.main();Av.main();Type.registerNamespace("Common.App.AccountSwitching");gs.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");
kq.main();Type.registerNamespace("Common");Fv.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Hv.main();Type.registerNamespace("Common.App.ImageProcessor");Type.registerNamespace("Common.App.NewAndOpen.Core");C.a.instance.Ac(new zx);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Bx.main();to.main();ot.main();Type.registerNamespace("Common.App.People");ns.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=
Dd;qy.main();Type.registerNamespace("Common");C.a.instance.Ac(new lA);Type.registerNamespace("CAUI");zn.main();Type.registerNamespace("Common.App.SaveStatus");C.a.instance.Ac(new mA);Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1200).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");jH.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"},AddinFlyoutFeedbackSurvey:{campaignId:"327596a8-5cb9-4b12-b62a-b976921fc4ec",commentQuestion:"Please tell us what kind of add-ins would be useful to you.",
isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"Please let us know why you didn\u2019t try any add-ins at this time.",ratingValuesAscending:["Skipped it for now, will take a look later","Need bigger selection of add-ins ","These add-ins aren\u2019t useful to me","Need more info about each add-in","Not interested in add-ins"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We\u2019d love your feedback on the new look for add-ins!"}};
vy.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");ww.main();Cy.main();Fy.main();Cw.main();Lq.main();rs.main();Ef.main();Qg.main();QC.main();window.PowerPointEditingJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",
LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",
Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",
LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",
Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",
Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",
Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",
LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",
Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",
Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",
Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",
Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",
Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",
LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",
LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",
LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",
attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",
Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},
{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",
attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};
AD.main();Type.registerNamespace("Common.App.Insights");C.a.instance.Ac(new JI);Type.registerNamespace("Common.App.Activities");ED.main();Type.registerNamespace("Common.App.ActivityAggregator");JD.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Kr;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");KD.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");
LD.main();Type.registerNamespace("Common.App.EventsCacheManager");MD.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");PD.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");SD.main();wE.main();AE.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");CE.main();Type.registerNamespace("Common.App.VisibilityManagement");
EE.main();Type.registerNamespace("Common.ModernFontPicker");FE.main();GE.main();LE.main();RE.main();UE.main();cF.main();eF.main();jF.main();OB.main();DF.main();FF.main();GF.main();UF.main();VF.main();WF.main();XF.main();ZF.main();gG.main();hG.main();Type.registerNamespace("Common.App.OAuth");nH.main();eH.main();hH.main();kH.main();Type.registerNamespace("Common.App.CollabControls");mH.main();yC.main();Object(Ti.c)("Ext")},1319:function(L,V,d){L=d(0);var k=d(395),e=d(303),n=d(304),r=d(7);class w{static Oyj(oa){return w.Pyj(oa)}static Pyj(oa){const sa=
document.createElementNS(w.Bjf,"svg");sa.setAttribute("viewBox",String.format(w.k9i,w.k5h,w.j5h));sa.appendChild(w.AOj(oa));return sa}static AOj(oa){const sa=w.k5h/oa,Ca=2*sa,Ta=w.j5h/2;oa=(oa-12-8)*sa/2;const R=document.createElementNS(w.Bjf,"g");Sys.UI.DomElement.addCssClass(R,w.j9i);for(let Ha=1;3>=Ha;Ha++)R.appendChild(w.kwj(Ha,Ca,oa+(6*Ha-2)*sa,Ta));return R}static kwj(oa,sa,Ca,Ta){const R=document.createElementNS(w.Bjf,"circle");Sys.UI.DomElement.addCssClass(R,String.format("{0}-{1}",w.jTi,
oa));R.setAttribute("cx",String.format("{0}",Ca));R.setAttribute("cy",String.format("{0}",Ta));R.setAttribute("r",String.format("{0}",sa));return R}}w.Bjf="http://www.w3.org/2000/svg";w.j9i="prDancingDots";w.jTi="prAnimateCircle";w.k9i="0 0 {0} {1}";w.j5h=40;w.k5h=120;Object(L.a)(w,"ModernPresenceTooltipDancingDots",null,[]);var D=d(25),y=d(176),m=d(78),C=d(67),E=d(142),F=d(228),B=d(99),H=d(46),K=d(3);class A extends e.a{constructor(oa,sa){super(oa);this.RHf=this.fQa=this.nJd=this.d0=this.V_=this.LA=
this.er=null;this.Lda=sa.get(8,!1);this.yja=sa.get(6,0);this.bri=sa.get(15,!1);this.nd=sa;this.zsf=0;this.element=oa;this.element.className=A.j$b;this.ZT=document.createElement("span");this.element.appendChild(this.ZT);this.rdi=w.Oyj(sa.get(6,0));this.nQ(sa);this._state=5}t9(oa){this.addHandler(n.a.Ax,oa)}xqa(oa){this.removeHandler(n.a.Ax,oa)}get user(){return this.RHf}get state(){return this._state}dispose(){this.element&&(this.er.Hb(C.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),
this.er.Hb(C.a.doubleClick,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.LA.Hb(C.a.BB,this.element,Object(r.a)(this,this.Kkb,"onPointerDown")),this.LA.Hb(C.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut")),this.LA.Hb(C.a.aD,this.element,Object(r.a)(this,this.FN,"onPointerOver")),this.V_.Hb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}nQ(oa){this.er=oa.get(10);this.er.xb(C.a.click,this.element,
Object(r.a)(this,this.onClick,"onClick"));this.er.xb(C.a.doubleClick,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior"));this.LA=oa.get(9);this.LA.xb(C.a.aD,this.element,Object(r.a)(this,this.FN,"onPointerOver"));this.LA.xb(C.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut"));this.LA.xb(C.a.BB,this.element,Object(r.a)(this,this.Kkb,"onPointerDown"));this.V_=oa.get(13);this.V_.xb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior"))}hide(oa,
sa,Ca){oa=void 0===oa?null:oa;sa=void 0===sa?0:sa;Ca=void 0===Ca?0:Ca;this.bri&&oa?this.D0l(oa,sa,Ca):(3===this.state&&this.QCh(),this.visible=!1,this._state=5)}D0l(oa,sa,Ca){this.show(oa,sa,15,4,void 0,void 0===Ca?0:Ca)}hRh(oa,sa,Ca,Ta,R,Ha){this.show(oa,sa,20,(void 0===Ca?0:Ca)?2:(void 0===Ta?0:Ta)?1:0,void 0===R?!1:R,void 0===Ha?0:Ha)}Z_l(oa,sa,Ca,Ta,R){this.show(oa,sa,Ca+20,3,void 0===Ta?!1:Ta,void 0===R?0:R)}show(oa,sa,Ca,Ta,R,Ha){Ta=void 0===Ta?3:Ta;Ha=void 0===Ha?0:Ha;!oa||Ta===this.state&&
this.K1j(sa,Ca)||(this.Usi(Ta,void 0===R?!1:R,Ha),this.$B(oa,Ta,Ha),this._state=Ta,4===Ha||0===Ha&&!this.Lda?this.element.style.left=sa+"px":this.element.style.right=sa+"px",this.element.style.top=Ca+"px",this.visible=!0)}$B(oa,sa,Ca){this.RHf=oa;B.a.qw(this.ZT);F.a.oUi(this.ZT);this.ZT.id="fly_"+oa.clientId;this.ZT.style.backgroundColor=oa.color;4!==sa?(this.ZT.style.height=this.yja+"px",this.ZT.style.lineHeight=this.yja+"px",F.a.lca(this.ZT,"border-radius",this.yja+"px")):4===Ca||0===Ca&&!this.Lda?
this.ZT.style.left="0px":this.ZT.style.right="0px";2!==sa&&(4===sa?B.a.yA(this.ZT,""):1===sa?this.ZT.appendChild(this.rdi):(this.ZT.setAttribute("dir","auto"),Ca=H.a.xkg(oa.userName,!1),(!oa.isAnonymous||D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&Ca||0!==sa?(oa=oa.userName,0===sa&&(oa=Ca,F.a.lca(this.ZT,"text-align","center")),B.a.yA(this.ZT,oa)):(this.d0||(this.d0=this.L1i()),this.ZT.appendChild(this.d0),F.a.lca(this.ZT,"text-align",
"start"))))}onClick(oa){if(0===this.state)return this.raiseEvent(n.a.Ax,new n.a(1,oa)),!0;3===this.state&&k.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}hH(oa){3===this.state&&this.raiseEvent(n.a.Ax,new n.a(3,oa));return!1}FN(oa){3!==oa.wg&&this.raiseEvent(n.a.Ax,new n.a(2,oa));return!1}Kkb(oa){if(3!==oa.wg)return!0;this.raiseEvent(n.a.Ax,new n.a(4,oa));return!1}L1i(){const oa=document.createElement("img");oa.src=y.a.GO("doughperson_white_glyph.svg");oa.setAttribute("Unselectable",
"on");E.a.bT(oa,E.a.Ff,E.a.gR);return m.createClusteredImageFromClusterWithImageClass(this.yja,this.yja,null,null,A.Wpj,"",!1,"",this.element.ownerDocument,oa)}Usi(oa,sa,Ca){sa=void 0===sa?!1:sa;Ca=void 0===Ca?0:Ca;if(!this.sec(this.state)||!this.sec(oa))switch(Sys.UI.DomElement.removeCssClass(this.element,this.nJd),this.state){case 4:3===oa?this.QDa(A.xee,A.Hdg):this.sec(oa)&&this.QDa(A.wee,A.Hdg);break;case 3:4===oa?this.QDa(A.zee,A.Gdg):this.sec(oa)&&(sa&&this.QCh(),this.QDa(A.wee,A.Gdg,sa?A.Vpj:
""));break;case 0:case 1:case 2:4===oa?this.QDa(A.zee,A.yee):3===oa&&(sa&&this.Yti(),this.QDa(A.xee,A.yee,sa?A.Idg:"",3===Ca?A.Ypj:A.Xpj));break;default:4===oa?this.QDa(A.zee):3===oa?this.QDa(A.xee):this.sec(oa)&&this.QDa(A.wee)}}QDa(...oa){this.nJd=oa.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.nJd)}Yti(){this.zsf=window.setTimeout(()=>{this.element&&(this.fQa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.fQa),this.element.style.zIndex="2",this.fQa.style.zIndex=
"1")},300)}QCh(){window.clearTimeout(this.zsf);this.fQa&&(Sys.UI.DomElement.removeCssClass(this.fQa,A.yee+" "+A.Idg),Sys.UI.DomElement.addCssClass(this.fQa,A.Upj),K.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.fQa.parentNode&&this.element.parentNode.removeChild(this.fQa)}),F.a.c3e(this.element,"z-index"))}sec(oa){return 0===oa||1===oa||2===oa}K1j(oa,sa){const Ca=F.a.$pa(this.element.style.top);return F.a.$pa(this.element.style.left)===oa&&Ca===sa}A4e(oa){3===oa&&
F.a.EX(this.element,"left")?(oa=F.a.$pa(this.element.style.left),F.a.c3e(this.element,"left"),this.element.style.right=-1*oa+"px"):4===oa&&F.a.EX(this.element,"right")&&(oa=F.a.$pa(this.element.style.right),F.a.c3e(this.element,"right"),this.element.style.left=-1*oa+"px")}}A.j$b="prModernFlyout UIFont";A.zee="flyoutIdle";A.xee="flyoutExpanded";A.wee="flyoutCollapsed";A.Hdg="flyoutFromIdle";A.Gdg="flyoutFromExpanded";A.yee="flyoutFromCollapsed";A.Idg="flyoutStacked";A.Vpj="flyoutFromStacked";A.Upj=
"flyoutFadeOut";A.Wpj="cui-img-cont-float cui-img-20by20";A.Xpj="flyoutLtrDir";A.Ypj="flyoutRtlDir";Object(L.a)(A,"ModernPresenceTooltipFlyoutControl",e.a,[]);class W{constructor(oa,sa,Ca,Ta){this.offsetTop=oa;this.offsetLeft=sa;this.f5h=void 0===Ca?2:Ca;this.Ovg=void 0===Ta?4:Ta}}Object(L.a)(W,"FlyoutsPositioningInfo",null,[]);var N=d(64);class P{constructor(oa,sa){this.Ll=void 0===oa?!1:oa;this.QLd=void 0===sa?!1:sa}eEj(oa,sa,Ca,Ta,R){const Ha=R.y,da=R.height;var Ba=this.pvj(Ta);const za=Ba+sa,
Aa=oa*Ca+2*(oa-1);Ca=null;1===oa||this.LPi(Ba,Aa,Ha,da)?oa=new W(0,0,2):(oa=this.Poj(za,Aa,Ha,da),oa.offsetTop-=Ba);this.QLd?Ca=new W(0,0,void 0,this.Ll?4:3):(Ta=this.ovj(Ta,R),Ba=Math.max(0,R.x),R=R.width,sa=Ta+sa,this.MPi(Ta,Ba,R)?Ca=new W(0,0,void 0,this.Ll?3:4):this.NPi(sa,Ba)&&(Ca=new W(0,0,void 0,this.Ll?4:3)),Ca||(Ca=this.Ooj(Ta,sa,Ba,R)));return new W(oa.offsetTop,Ca.offsetLeft,oa.f5h,Ca.Ovg)}pvj(oa){return N.a.hge(oa)}ovj(oa,sa){return this.Ll?sa.width-N.a.nvj(oa):N.a.fge(oa)}LPi(oa,sa,Ca,
Ta){return oa+sa<=Ca+Ta}Poj(oa,sa,Ca,Ta){let R=1,Ha=Math.max(Ca,oa-sa);sa>oa-Ca&&(R=2,Ha=sa<Ta?Ta-sa:Ca);return new W(Ha,0,R)}MPi(oa,sa,Ca){return oa+150<=sa+Ca}NPi(oa,sa){return 150<=oa-sa}Ooj(oa,sa,Ca,Ta){Ta-sa>=oa-Ca?oa=4:(sa=oa,oa=3);return new W(0,sa,void 0,oa)}}Object(L.a)(P,"ModernPresenceTooltipPositioner",null,[]);class U{constructor(oa,sa,Ca,Ta,R,Ha,da){this.b0=oa;this._parent=sa;this.Kpf=Ca;this.Abi=Ta;this.Jfi=R;this.Hub=Ha;this.Lda=da;this._element=document.createElement("div");this.element.className=
"prTouchTarget"}get element(){return this._element}update(oa,sa){if(3!==oa)if(5!==oa&&this.b0&&this.b0.length){if(4===oa){var Ca=this.Jfi;var Ta=(this.Hub-Ca)/2;this.element.style.height=this.Hub+"px";this.element.style.width=this.Hub+"px";oa=F.a.$pa(this.b0[0].element.style.top);sa=F.a.$pa(this.Lda?this.b0[0].element.style.right:this.b0[0].element.style.left)}else Ca=this.Kpf,Ta=(this.Hub-Ca)/2,this.element.style.height=this.Hub+"px",this.element.style.width=this.Jwj()+2*Ta+"px",oa=F.a.$pa(this.b0[this.b0.length-
1].element.style.top),sa=this.YOi(this.b0[this.b0.length-1].element,Ca,sa);F.a.lca(this.element,"border-radius",this.Hub+"px");this.element.style.top=oa-Ta-Ca+"px";this.Lda?this.element.style.right=sa-Ta+"px":this.element.style.left=sa-Ta+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}YOi(oa,sa,Ca){return this.Lda&&!Ca?F.a.$pa(oa.style.right):this.Lda||Ca?this.Lda&&Ca?-F.a.$pa(oa.style.left)-
sa:-F.a.$pa(oa.style.right)-sa:F.a.$pa(oa.style.left)}Jwj(){return this.b0&&this.b0.length?this.Kpf+Math.min(this.b0.length-1,2)*this.Abi:0}}Object(L.a)(U,"ModernPresenceTooltipTarget",null,[]);var Q=d(65),G=d(124),Y=d(197);class ba extends e.a{constructor(oa,sa,Ca){super(oa);this.Ktb=this.rsa=this.fvf=this.C6a=!1;this.Ph=[];this.LZ=(Ta,R)=>{Ta=this.D4a;this.AIi()||2!==R.type&&(4!==R.type||3===Ta)?4===R.type&&3===Ta?(this.rsa&&(this.rsa=!1),this.B5d()):3!==R.type||3!==Ta||this.C6a||(1<this.ZFa?(this.rsa=
!0,K.Task.delay(250).continueWith(()=>{this.R$a(!0);this.rsa=!1})):this.B5d()):(this.rsa&&(this.rsa=!1),3!==Ta&&(this.V$f(),3===R.Uj.wg&&this.B5d(2E3)));this.raiseEvent(n.a.Ax,R)};this.iMb=Ta=>{3===Ta.wg?this.LZ(this,new n.a(4,Ta)):Ta.eventName===C.a.aD?this.LZ(this,new n.a(2,Ta)):Ta.eventName===C.a.qE&&this.LZ(this,new n.a(3,Ta));return!1};this.QGc={};this.nd=Ca;this.Ll=Ca.get(8,!1);this.uuf=Ca.get(15,!1);this.Hci=Ca.get(12,0);this.dTa=Ca.get(6,0);this.oub=sa;this.hIf=Ca.get(16);this.QLd=Ca.get(17,
!1);this.Kfi=Ca.get(19,!1);this.rli=Ca.get(20,!1);this.$Hc=0;this.nli=new P(this.Ll,this.QLd);this.vVb=this.jig();this.RSd=!1;this.PBa=[];this.uYb=[];this.element.id=ba.E$b();this.element.className=e.a.p8d(this.Ll);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Ll;this.mxc(sa);this.Eja=this.createElement("div");this.Eja.className="prFlyoutContainer";this.element.appendChild(this.Eja);this.b0=[];this.sQa=new U(this.QU,this.element,this.dTa,4,6,32,this.Ll);this.LA=Ca.get(9);this.LA.xb(C.a.BB,
this.sQa.element,this.iMb);this.LA.xb(C.a.aD,this.sQa.element,this.iMb);this.LA.xb(C.a.qE,this.sQa.element,this.iMb)}get NNb(){return Y.a.clone(this.Ph)}get QU(){return this.b0}get defaultZIndex(){return this.Hci}get ZFa(){return this.QU?this.QU.length:0}get D4a(){return 0<this.ZFa?this.QU[0].state:5}get rve(){return 3===this.D4a&&!this.C6a}t9(oa){this.addHandler(n.a.Ax,oa)}xqa(oa){this.removeHandler(n.a.Ax,oa)}dispose(){if(this.rve)this.RSd=!0;else{if(this.QU)for(const oa of this.QU)oa.xqa(this.LZ),
G.a.Iz(oa);this.b0=null;this.LA.Hb(C.a.BB,this.sQa.element,this.iMb);this.LA.Hb(C.a.aD,this.sQa.element,this.iMb);this.LA.Hb(C.a.qE,this.sQa.element,this.iMb);super.dispose()}}PNa(){this.R$a();this.visible=!0}JAd(){this.visible=!0;this.V$f();this.C6a=!0}LNa(){this.JAd()}hide(){this.jDh();this.eY();this.sQa.update(this.D4a,this.Ktb)}$B(oa){const sa=this.D4a,Ca=this.C6a;oa.clientId||(oa.clientId=(ba.DQa++).toString());if(oa.clientId in this.QGc){var Ta=this.fma(oa.clientId);if(0<=Ta){Ta=this.Ph[Ta];
if(Ta.color===oa.color&&Ta.userName===oa.userName)return;this.qQ(oa.clientId)}}this.hide();Ta=new A(this.createElement("div"),this.nd);Ta.t9(this.LZ);this.Eja.insertBefore(Ta.element,this.Eja.firstChild);this.QGc[oa.clientId]=Ta;Array.add(this.Ph,oa);Array.add(this.QU,Ta);this.T3h(sa,Ca);this.visible=!0}qQ(oa){if(this.rve)Array.add(this.uYb,oa);else{var sa=this.D4a,Ca=this.C6a;this.hide();this.v2a(oa);this.T3h(sa,Ca)}}dnd(oa){const sa=this.fma(oa);if(!(0>=sa)){var Ca=this.Ph[sa];oa=this.QGc[oa];Array.removeAt(this.Ph,
sa);Array.insert(this.Ph,0,Ca);Array.removeAt(this.QU,sa);Array.insert(this.QU,0,oa);this.Eja.removeChild(oa.element);this.Eja.appendChild(oa.element);this.R$a()}}T3h(oa,sa){0>=this.Ph.length?this.hide():3===oa&&sa?this.JAd():this.PNa()}BRb(oa,sa){sa?this.Csi(oa):this.BCh(oa)}dXc(oa){if(this.rve&&this.Kfi)return!1;oa=ba.Tac(oa);if(this.Eja!==oa&&B.a.GXa(this.Eja,oa))return!0;for(const sa of this.QU)if(B.a.GXa(sa.element,oa))return!0;return!1}position(oa,sa){this.element.style.top=sa+"px";this.element.style.left=
oa+"px"}R$a(oa){if(void 0===oa||!oa||this.rsa){this.fvf&&this.vNh(!0);var sa=Math.min(3,this.ZFa)-1;oa=0;var Ca=1,Ta=0;this.Ktb&&(oa=this.vVb,Ca=-1,Ta=-this.dTa);for(let R=this.ZFa-1;R>sa;R--)this.QU[R].hRh(this.Ph[R],-4*sa*Ca+Ta,!0,!1,!0,oa);for(;0<=sa;sa--)this.QU[sa].hRh(this.Ph[sa],-4*sa*Ca+Ta,0<sa,Array.contains(this.PBa,this.Ph[sa].clientId),sa!==this.$Hc,oa);this.$Hc=0;this.sQa.update(0,this.Ktb);this.zIndex=this.defaultZIndex;this.C6a=!1;this.jDh(0);this.RSd&&this.dispose()}}V$f(){this.fvf&&
this.vNh(!1);this.zIndex=this.defaultZIndex+1;const {offsetX:oa,offsetY:sa,Nvg:Ca}=this.lRl();for(let Ta=0;Ta<this.ZFa;Ta++)this.QU[Ta].Z_l(this.Ph[Ta],oa,sa+(this.dTa+2)*Ta,Ta!==this.$Hc,Ca)}eY(){let oa=0,sa=0;this.Ktb&&(oa=this.vVb,sa=-6);for(let Ca=0;Ca<this.ZFa;Ca++)this.QU[Ca].hide(this.Ph[Ca],sa,oa);this.zIndex=this.defaultZIndex;this.visible=this.C6a=!1;this.RSd&&this.dispose()}B5d(oa){(oa=void 0===oa?0:oa)?(this.rsa=!0,K.Task.delay(oa).continueWith(()=>{this.uuf?this.R2j():this.R$a(!0);this.rsa=
!1})):this.uuf?this.hide():this.R$a()}R2j(){this.rsa&&this.hide()}AIi(){if(D.AFrameworkApplication.za&&D.AFrameworkApplication.za.mb.Zfa&&Q.c()){const oa=appChrome.selectors.getShyState();return oa.isActive&&0!==oa.state}return!1}mxc(oa){this.element.style.width=oa+"px";this.element.style.height=this.dTa+"px"}v2a(oa){this.BCh(oa);oa=this.fma(oa);if(!(0>oa)){var sa=this.Ph[oa];Array.removeAt(this.Ph,oa);delete this.QGc[sa.clientId];sa=this.QU[oa];this.Eja.removeChild(sa.element);this.nd.get(18,!1)&&
sa.xqa(this.LZ);Array.removeAt(this.QU,oa);sa.dispose()}}jDh(oa){oa=void 0===oa?5:oa;if(this.uYb.length){this.visible&&this.eY();for(let sa=0;sa<this.uYb.length;sa++)this.v2a(this.uYb[sa]);Array.clear(this.uYb);0>=this.Ph.length||5===oa?this.hide():0===oa&&this.PNa()}}fma(oa){for(let sa=0;sa<this.Ph.length;sa++)if(this.Ph[sa].clientId===oa)return sa;return-1}Csi(oa){if(-1===this.fma(oa))k.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.PBa,
oa)){if(this.Ph[0].clientId===oa)return;Array.remove(this.PBa,oa)}Array.add(this.PBa,oa);this.dnd(oa);1!==this.D4a&&this.R$a()}}BCh(oa){-1===this.fma(oa)?k.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.PBa,oa)&&(Array.remove(this.PBa,oa),this.Ph[0].clientId===oa&&0<this.PBa.length&&this.dnd(this.PBa[this.PBa.length-1]),this.Ph[0].clientId===oa&&1===this.D4a&&this.R$a())}vNh(oa){oa?Sys.UI.DomElement.addCssClass(this.Eja,"prBackgroundSelection"):
Sys.UI.DomElement.removeCssClass(this.Eja,"prBackgroundSelection")}lRl(){let oa,sa;sa=oa=0;var Ca=this.vVb;if(this.hIf){const Ta=this.hIf(this);if(!Ta)return{offsetX:oa,offsetY:sa,Nvg:Ca};const R=4===this.D4a;Ca=this.nli.eEj(this.ZFa,R?6:this.dTa,this.dTa,this.element,Ta);sa=Ca.offsetTop;this.$Hc=this.jDj(Ca.f5h,Ca.offsetTop);Ca=Ca.Ovg;Ca!==this.vVb&&(this.A4e(Ca),this.element.dir=3===Ca?"rtl":"ltr",this.vVb=Ca);Ca!==this.jig()?(oa=this.rli?-2:R?-6:-this.dTa,this.Ktb=!0):this.Ktb=!1}return{offsetX:oa,
offsetY:sa,Nvg:Ca}}jDj(oa,sa){if(1===oa)return this.ZFa-1;oa=Math.abs(sa);return 0<oa?oa/(this.dTa+2):0}A4e(oa){for(let sa=0;sa<this.ZFa;sa++)this.QU[sa].A4e(oa)}jig(){return this.Ll?3:4}static E$b(){return String.format("{0}-{1}","presencetooltip",ba.DQa++)}static Tac(oa){return oa.hc.rawEvent.relatedTarget}}ba.DQa=0;Object(L.a)(ba,"ModernPresenceTooltipControl",e.a,[536,106]);var ha=d(240),ka=d(319),ca=d(285);d.d(V,"a",function(){return ia});class ia{constructor(oa){this.nd=oa;this.nd.u0(10,ha.a.instance);
this.nd.u0(9,ca.a.instance);this.nd.u0(6,20);this.nd.u0(13,ka.a.instance);this.nd.u0(17,!1)}G7d(oa,sa){this.nd.u0(15,!1);return new ba(oa,sa,this.nd)}J6b(oa){this.nd.u0(15,!1);return new ba(oa,20,this.nd)}}Object(L.a)(ia,"ModernPresenceTooltipFactory",null,[531])},1327:function(L,V,d){L=d(0);class k{constructor(n,r,w,D){this.$bi=n;this.Tmi=r;this.Smi=w;this.Umi=D}get J_i(){return this.$bi}get eHl(){return this.Tmi}get bHl(){return this.Smi}get resultType(){return this.Umi}}Object(L.a)(k,"SearchContext",
null,[1203]);d.d(V,"a",function(){return e});class e{u6i(n,r,w){var D=w-r;let y;if(100<=D)D=r,y=w;else{D=Math.max(0,r+Math.ceil(D/2)-50);y=Math.min(n.length,D+100);D=Math.max(0,y-100);let C;if(D&&" "!==n.charAt(D-1)){C=Math.min(r,D+10);for(var m=D;m<C;++m)if(" "===n.charAt(m)){D=m+1;break}}if(y!==n.length&&" "!==n.charAt(y))for(C=Math.max(w,y-10),m=y-1;m>=C;--m)if(" "===n.charAt(m)){y=m;break}}return new k(n.substring(D,y),r-D,w-D,"")}}Object(L.a)(e,"SearchContextFactory",null,[1155])},1328:function(L,
V,d){L=d(0);var k;(function(n){n[n.uBm=0]="multipleBrowsersImageClassName";n[n.bCm=1]="peopleImageClassName";n[n.cCm=4]="peopleImageClusterPath";n[n.tBm=5]="multipleBrowserImageClusterPath";n[n.A5=6]="imageDimension";n[n.rtl=8]="rtl";n[n.Psc=9]="pointerInputManager";n[n.K$a=10]="clickInputManager";n[n.vertical=11]="vertical";n[n.zIndex=12]="zIndex";n[n.I6d=13]="contextMenuInputManager";n[n.svm=14]="imageDomElement";n[n.OEm=15]="useIdleTooltip";n[n.TEm=16]="viewportBoundsCallback";n[n.Num=17]="flipHorizontalDirection";
n[n.Mum=18]="fixRemoveFadeOutElementCrash";n[n.rvm=19]="ignoreEventOnExpandedTooltip";n[n.Fvm=20]="ipWidthAdjustForFlyout"})(k||(k={}));Object(L.b)("PresenceTooltipSettingKeys",k);d.d(V,"a",function(){return e});class e{constructor(){this.c4={}}get(n,r){n=k[n];return"number"===typeof(void 0===r?null:r)?(r=this.c4[n])?Number.parseInvariant(r.toString()):0:this.c4[n]}add(n,r){this.c4[k[n]]=r}u0(n,r){k[n]in this.c4||(this.c4[k[n]]=r)}remove(n){delete this.c4[k[n]]}}Object(L.a)(e,"PresenceTooltipSettings",
null,[])},154:function(L,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return n});var k=d(41);const e=(r,w,D)=>{r=k.a.Zj(r);r.Wa("CommandId",w.toString());try{return D()}finally{r.finish(!0)}},n=(r,w,D,y)=>e(r+w,D,y)},201:function(L,V,d){d.d(V,"a",function(){return r});L=d(0);var k=d(25),e=d(1174),n=d(46);class r{static qjg(){return r.xBi+"_"+e.a.Wcc+"_"+n.a.gM(k.AFrameworkApplication.userName)+"_"}static wZc(w){return w+"_"+e.a.Wcc+"_"+n.a.gM(k.AFrameworkApplication.userName)+"_"}static $mg(){return r.ill+
"_"+e.a.Wcc+"_"+n.a.gM(k.AFrameworkApplication.userName)+"_"}}r.Qka="ack0";r.Rka="ack1";r.FOc="ack2";r.xBi="ack3";r.wMf="ack4";r.xMf="ack7";r.jIg="ack8";r.gRh="ack9";r.J1d="ack10";r.eRh="ack13";r.Fvb="AddinDetailsRefreshed";r.LOc="AddinServiceUserState";r.vBi="DdaMethod";r.uBi="ControlId";r.KOc="SecurityOrigin";r.G9a="ak0";r.t_d="ak1";r.w_d="ak2";r.IOc="ak4";r.vMf="Office.AutoShowTaskpaneWithDocument";r.s_d="refreshRequired";r.yMf="value";r.BBi="errorCode";r.Mae="SolutionId";r.Kae="MethodData";r.Lae=
"DynamicAddinCommandsMethodDispatchId";r.Pej="SourceControlId";r.Nej="OsfControl";r.Oej="RibbonUpdaterData";r.WCd="AddinShared";r.ill="__OSF_PRIVATECATALOG_ADDINIDS";Object(L.a)(r,"AddinConstantsString",null,[])},224:function(L,V,d){d.r(V);var k;(function(Ca){Ca[Ca.Undefined=0]="Undefined";Ca[Ca.Created=10]="Created";Ca[Ca.Sent=20]="Sent";Ca[Ca.Duplicated=30]="Duplicated";Ca[Ca.Seen=40]="Seen";Ca[Ca.Tried=50]="Tried";Ca[Ca.Kept=60]="Kept";Ca[Ca.Rejected=70]="Rejected"})(k||(k={}));var e;(function(Ca){Ca[Ca.None=
0]="None";Ca[Ca.Added=1]="Added";Ca[Ca.Updated=2]="Updated";Ca[Ca.Deleted=3]="Deleted"})(e||(e={}));var n;(function(Ca){Ca[Ca.ContentChanged=0]="ContentChanged";Ca[Ca.ContentWasEmpty=1]="ContentWasEmpty";Ca[Ca.FormattingChanged=2]="FormattingChanged";Ca[Ca.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(n||(n={}));var r;(function(Ca){Ca[Ca.None=0]="None";Ca[Ca.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";Ca[Ca.AlCodedLocation=2]="AlCodedLocation"})(r||(r={}));var w;(function(Ca){Ca[Ca.NewDocument=
0]="NewDocument";Ca[Ca.EditDocument=1]="EditDocument";Ca[Ca.ViewOnlyDocument=2]="ViewOnlyDocument"})(w||(w={}));class D{}D.lowerIndexBound=1;D.maxNumberOfRows=1048576;D.maxNumberOfColumns=16384;D.firstColumnName="A";D.lastColumnName="XFD";var y=d(330);class m{constructor(Ca){y.a.assign(m,this,Ca)}get metadata(){return this.M_}set metadata(Ca){this.M_=Ca}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[m.getTypeName()])}}
m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class C{constructor(Ca){y.a.assign(C,this,Ca)}get metadata(){return this.M_}set metadata(Ca){this.M_=Ca}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class E{constructor(Ca){y.a.assign(E,this,Ca)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,
[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class F{constructor(Ca){y.a.assign(F,this,Ca)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};var B=d(944);class H{constructor(Ca){y.a.assign(H,this,Ca)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,
[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class K{constructor(Ca){y.a.assign(K,this,Ca)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class A{constructor(Ca){y.a.assign(A,this,Ca)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,
[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class W{constructor(Ca){y.a.assign(W,this,Ca)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class N{constructor(Ca){y.a.assign(N,this,Ca)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[N.getTypeName()])}}
N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class P{constructor(Ca){y.a.assign(P,this,Ca)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class U{constructor(Ca){y.a.assign(U,this,Ca)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,
[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class Q{constructor(Ca){y.a.assign(Q,this,Ca)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class G{constructor(Ca){y.a.assign(G,this,Ca)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[G.getTypeName()])}}
G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class Y{constructor(Ca){y.a.assign(Y,this,Ca)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class ba{constructor(Ca){y.a.assign(ba,this,Ca)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[ba.getTypeName()])}}
ba.H_={T_:ba.getTypeName(),B_:ba.getBaseTypes()};class ha{constructor(Ca){y.a.assign(ha,this,Ca)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[ha.getTypeName()])}}ha.H_={T_:ha.getTypeName(),B_:ha.getBaseTypes()};class ka{constructor(Ca){y.a.assign(ka,this,Ca)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[ka.getTypeName()])}}
ka.H_={T_:ka.getTypeName(),B_:ka.getBaseTypes()};class ca{constructor(Ca){y.a.assign(ca,this,Ca)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[ca.getTypeName()])}}ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};class ia{constructor(Ca){y.a.assign(ia,this,Ca)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,
[ia.getTypeName()])}}ia.H_={T_:ia.getTypeName(),B_:ia.getBaseTypes()};class oa{constructor(Ca){y.a.assign(oa,this,Ca)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,[oa.getTypeName()])}}oa.H_={T_:oa.getTypeName(),B_:oa.getBaseTypes()};class sa{constructor(Ca){y.a.assign(sa,this,Ca)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(Ca){return y.a.matchesTypesFor(Ca,
[sa.getTypeName()])}}sa.H_={T_:sa.getTypeName(),B_:sa.getBaseTypes()};d.d(V,"AnnotationState",function(){return k});d.d(V,"ItemOperation",function(){return e});d.d(V,"ItemChanges",function(){return n});d.d(V,"ecsMetadataBlockHeight",function(){return 512});d.d(V,"ecsMetadataBlockWidth",function(){return 32});d.d(V,"BlobRefType",function(){return r});d.d(V,"OpenType",function(){return w});d.d(V,"GridConstants",function(){return D});d.d(V,"Annotation",function(){return m});d.d(V,"BinaryClassificationAnnotation",
function(){return C});d.d(V,"Event",function(){return E});d.d(V,"UserCommand",function(){return F});d.d(V,"ItemDelta",function(){return B.f});d.d(V,"ItemChangesDelta",function(){return B.e});d.d(V,"Operation",function(){return B.i});d.d(V,"OperationWithSiblingContext",function(){return B.j});d.d(V,"AddOperation",function(){return B.a});d.d(V,"MoveOperation",function(){return B.h});d.d(V,"UpdateAnnotationMetaDataOperation",function(){return B.m});d.d(V,"UpdateOperation",function(){return B.n});d.d(V,
"DeleteOperation",function(){return B.b});d.d(V,"PurgeOperation",function(){return B.k});d.d(V,"FocusOperation",function(){return B.d});d.d(V,"VisibilityOperation",function(){return B.o});d.d(V,"DeltaUpdateOperation",function(){return B.c});d.d(V,"MicroSyncOperation",function(){return B.g});d.d(V,"SignalOperation",function(){return B.l});d.d(V,"SchemaObject",function(){return y.a});d.d(V,"Signal",function(){return H});d.d(V,"DirtyAreaSignal",function(){return K});d.d(V,"Blob",function(){return A});
d.d(V,"Binary",function(){return W});d.d(V,"TileGroup",function(){return N});d.d(V,"Session",function(){return P});d.d(V,"Document",function(){return U});d.d(V,"SubDocument",function(){return Q});d.d(V,"GridCell",function(){return G});d.d(V,"GridNeighborhoodContext",function(){return Y});d.d(V,"ItemFilter",function(){return ba});d.d(V,"DynamicContext",function(){return ha});d.d(V,"ContextHolder",function(){return ka});d.d(V,"UserContextHolder",function(){return ca});d.d(V,"TenantContextHolder",function(){return ia});
d.d(V,"EventsHolder",function(){return oa});d.d(V,"UserCommandsHolder",function(){return sa})},238:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.TOc="AfterValidate";k.autoCorrect="AutoCorrect";k.QHi="BeforeValidate";k.d9i="CutAction";k.kfj="EditingElementContainerDisconnectingFromView";k.endEditing="EndEditing";k.yoj="FinishingSelectionValidation";k.x7j="ImeTypingEnd";k.z7j="ImeTypingStart";k.mdk="IpMode";k.nz="KeyPress";k.Vf="KeyDown";k.v0k="NotFinishingSelectionValidation";k.icl=
"OvertypeEnd";k.kcl="OvertypeStart";k.ncl="PaddingChanged";k.Hsh="ParagraphContentUpdated";k.zel="PasteAction";k.GRl="SetMode";k.KOa="TypingProcess";k.QUi="ClipboardModeBegin";k.RUi="ClipboardModeEnd";Object(L.a)(k,"EditEventKeys",null,[])},252:function(L,V,d){L=d(0);var k=d(528),e=d(134);class n extends k.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(L.a)(n,"OperationWithSiblingContext",k.a,[]);d.d(V,"a",function(){return r});class r extends n{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(L.a)(r,"AddOperation",n,[])},253:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(54),n=d(25),r=d(46),w=d(593),D=
d(1273),y=d(18);d(1264);var m=d(1046),C=d(28),E=d(76),F=d(130),B=d(33),H=d(42),K=d(39),A=d(77),W=d(53),N=d(73),P=d(59),U=d(87);d(427);var Q=d(50),G=d(429);class Y{constructor(ca,ia,oa,sa,Ca){this.ASd=ca;this.bqi=oa;this.aqi=ia;this.Cei=sa;this.Yji=Ca}ZJl(ca,ia){ia.$Jl(ca,this.ASd,this.aqi,this.bqi,this.Cei,this.Yji)}}Object(L.a)(Y,"MathPropertyObject",null,[]);var ba=d(32),ha=d(107);d.d(V,"Box4PasteSteward",function(){return ka});class ka extends m.a{constructor(ca,ia,oa,sa,Ca,Ta,R,Ha,da){super(ca,
R,void 0===Ha?null:Ha,void 0===da?null:da);this.Yo=this.Sja=null;this.msa=!1;this.O6a=null;this.ssb=-1;this.I7a=0;this.xWd=new y.a;ha.a(4223754,307,P.OutlineElementReader.vh(ca));this.S6a=ia;this.S6a.ywb(this);this.vG=oa;this.vG.ywb(this);this.zNd=sa;this.ir=Ca;this.Nii=Ta;this.MSd=A.ListReader.hl(this.Cb);ka.R$j();ka.F$j();ka.xak()}get Ofa(){return this.Sja||(this.Sja=e.a.instance.ub("Box4.IInternalLinkManager"))}get cUa(){return this.Yo}get bab(){return this.MSd&&!this.vG.Jea}get uab(){return 0<
this.I7a}get Cw(){return this.zNd}get hs(){return this.ir}get aad(){return this.Nii}get cJi(){return!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.getBooleanAppSetting("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.Yo=this.Zge(!1)}g0d(ca){ha.a(4223762,307,P.OutlineElementReader.vh(this.Cb)||N.OutlineReader.Wu(this.Cb));this.tLb(!1);var ia=new ba.GraphIterator;ia.Uc(this.Cb);ca=m.a.zi.Fea(this.Cb,this.YVa(ca));this.wPc(ia,!1);ha.a(4223763,307,ca===this.Cb.currentNode);
ha.a(4223764,307,B.ParagraphReader.ke(ca));-1!==this.Yo.oF&&ka.paragraphEditor.kL(ca,this.Yo.oF);if(ka.paragraphEditor.Cw&&!this.N_.GQh){if(this.Yo.textIndent){let sa;({unit:oa,returnValue:sa}=ka.Zqd(this.Yo.textIndent));let Ca=!1;if(sa||!A.ListReader.mbb){0>sa&&(Ca=!0,sa*=-1);var oa=ka.Z6d(sa,oa);Ca||ka.paragraphEditor.Cw.Knb(ca,oa)}}if(this.Yo.marginLeft&&!ka.XM.w8c&&!A.ListReader.hl(ia)){const {unit:sa,returnValue:Ca}=ka.Zqd(this.Yo.marginLeft);ia=ka.Z6d(Ca,sa);ka.paragraphEditor.Cw.Kyd(ca,1,ia)}}(ka.kg.Gg&&
ka.kg.wD||K.a.instance.ga(45)&&C.App.WE.LTb)&&ca.setValue(H.a.kfc,!0);this.Yo.lineSpacing&&ka.paragraphEditor.j_(ca,this.Yo.lineSpacing);this.Yo.paragraph=ca;this.msa=!0}wPc(ca,ia){ha.a(8128518,307,!ia);this.NN&&!K.a.instance.ga(76)&&(0<this.NN&&this.Cw.aVc(ca,this.NN),0>this.NN&&this.Cw.Olb(ca,this.NN,0));K.a.instance.ga(29)&&(this.Cb.Uc(ca),W.OutlineElementNavigator.Ti(this.Cb));!this.bab||2===C.App.mode&&this.aad.Xtc?ca&&this.hs.Z7e(ca,this.uab):this.hs.XMh(ca);this.NN=0}BDd(ca){this.xWd.add(ca)}S4d(){this.NN=
0}K2(ca,ia){ia=void 0===ia?null:ia;ha.a(4223772,307,B.ParagraphReader.Pl(this.Cb));const oa=this.Cb.currentNode;this.Yo.Off(oa);if(!this.N_.agf(ia)){var sa=oa.Sa.last,Ca=Q.a.STa(oa),Ta=!1;this.msa&&(sa.formatting=this.Yo.Jbb.le(sa),K.a.instance.ga(57)&&oa.$v(),this.msa=!1,Ta=!0);ca=this.N_.Ume(ca,ia);this.N_.Sqa(this.Cb.currentNode,this.Yo.Tha,ia);this.characterPropertiesEditor.replaceTextRange(Ca,ca);this.cJi&&Ta&&(ca=oa.Dzb(Ca.Ra),ca.formatting=this.Yo.Jbb.le(ca));K.a.instance.ga(2)}}Ppa(ca){this.N_.h8c&&
this.N_.k7c(ca)?(this.yB(),this.zB(ca)):(ha.a(4223773,307,B.ParagraphReader.Pl(this.Cb)),ca=Q.a.STa(this.Cb.currentNode),this.characterPropertiesEditor.X4c(ca,ia=>new G.a(ia,G.a.KUc),E.AParagraphNode.P0))}p1a(){}Opa(ca){this.S6a.Opa(ca)}Npa(ca){this.Yo=ca;this.msa=!0}Xya(ca){ha.a(4223774,307,B.ParagraphReader.Pl(this.Cb));ha.a(4223775,307,!this.O6a);ha.a(4223776,307,0>this.ssb);this.O6a=ca;this.ssb=B.ParagraphReader.textLength(this.Cb.currentNode)}Wya(){ha.a(4223777,307,B.ParagraphReader.Pl(this.Cb));
ha.a(4223778,307,!!this.O6a);ha.a(4223779,307,0<=this.ssb);let ca=Q.a.createTextRange(this.Cb.currentNode,this.ssb,B.ParagraphReader.textLength(this.Cb.currentNode)),ia="",oa="";this.Ofa&&(()=>{let sa=this.Ofa.a_h(F.HyperlinkReader.GGa(this.O6a),!0);({vCh:ia,jrj:oa}=sa);return sa})().returnValue&&(this.O6a=ia,oa&&(this.characterPropertiesEditor.replaceTextRange(ca,oa),ca=Q.a.createTextRange(this.Cb.currentNode,this.ssb,B.ParagraphReader.textLength(this.Cb.currentNode))));ka.hyperlinkEditor.Ala(ca,
this.O6a,!1);this.msa=!0;this.O6a=null;this.ssb=-1}zB(ca){this.g0d(ca);this.Yo.SDd(this.Cb.currentNode);ca&&"P"===ca.$V.bdc&&ka.paragraphEditor.BNa(this.Cb.currentNode,this.Yo.Pqd);this.N_.Sqa(this.Cb.currentNode,this.Yo.Tha,ca,this.Yo.marginLeft,this.Yo.textIndent)}yB(){ha.a(4223808,307,B.ParagraphReader.Pl(this.Cb));ka.hyperlinkEditor.zhj(this.Cb.currentNode);W.OutlineElementNavigator.$e(this.Cb)}l1a(){}k1a(){}bza(){}LLa(){}Spa(){ha.a(4223809,307,P.OutlineElementReader.vh(this.Cb)||N.OutlineReader.Wu(this.Cb));
let ca=!1;this.uab||(ca=this.bab||!0);ca||(this.NN+=1);this.I7a++}Qpa(){this.I7a--;let ca=!1;this.uab||(ca=this.bab||!0);ca||--this.NN}aza(ca){ha.a(4223810,307,P.OutlineElementReader.vh(this.Cb)||N.OutlineReader.Wu(this.Cb));ha.a(4223811,307,0!==ca.listStyleType);this.hs.gRb(this.Nwk(ca))}Rpa(){ha.a(4223813,307,P.OutlineElementReader.vh(this.Cb));if(ka.XM.w8c&&A.ListReader.hl(this.Cb)){const ca=B.ParagraphReader.dBb(this.Cb.currentNode),ia=this.aad.flg(this.Cb);this.hs.Ryd(ia,ca,null)}}m1a(ca){this.S6a.m1a(ca)}SZ(ca){this.vG.SZ(ca)}PZ(){this.vG.PZ()}RZ(ca){this.vG.RZ(ca)}QZ(){this.vG.QZ()}OZ(ca){this.vG.OZ(ca)}NZ(){this.vG.NZ()}static get paragraphEditor(){return ka.hy||
(ka.hy=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ka.uo||(ka.uo=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get kg(){return ka.zd||(ka.zd=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get PSb(){return ka.DGf}static get XM(){return ka.QL||(ka.QL=e.a.instance.ub("Box4.List.ListSettings"))}static R$j(){const ca=K.a.instance.ga(61);ka.VLa[1]=ca?U.StyleReader.mGd:U.StyleReader.FSb;ka.VLa[2]=ca?U.StyleReader.nGd:U.StyleReader.GSb;
ka.VLa[3]=ca?U.StyleReader.oGd:U.StyleReader.HSb;ka.VLa[4]=ca?U.StyleReader.pGd:U.StyleReader.ISb;ka.VLa[5]=ca?U.StyleReader.qGd:U.StyleReader.JSb;ka.VLa[6]=ca?U.StyleReader.rGd:U.StyleReader.KSb;ka.VLa[7]=ca?null:U.StyleReader.Azc}static F$j(){ka.jga.unspecified=0;ka.jga.defaultUnordered=1;ka.jga.defaultOrdered=1;ka.jga.none=0;ka.jga.disc=1;ka.jga.circle=2;ka.jga.square=3;ka.jga.decimal=1;ka.jga.lowerAlpha=2;ka.jga.lowerRoman=3;ka.jga.upperAlpha=4;ka.jga.upperRoman=5}static xak(){ka.DGf=U.StyleReader.WBb()}static dab(ca){return r.a.substring(ca,
4,6)+r.a.substring(ca,2,4)+r.a.substring(ca,0,2)}static Zqd(ca){let ia,oa;ia=0;const sa=ca.length;oa=parseFloat(r.a.substring(ca,0,sa-2));ca=r.a.substr(ca,sa-2,2);switch(ca){case "in":ia=3;break;case "px":ia=7;break;case "cm":ia=1;break;case "pt":ia=5;break;default:k.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ca),oa=0}return{returnValue:oa,unit:ia}}static Z6d(ca,ia){let oa=0;switch(ia){case 3:oa=w.a.Sva(ca);break;case 7:oa=
D.a.Wha(ca,0);break;case 1:oa=w.a.b4d(ca);break;case 5:oa=w.a.Sva(w.a.Qrd(ca));break;default:k.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ca,ia)}return oa}}ka.hy=null;ka.uo=null;ka.zd=null;ka.VLa=Array(8);ka.jga={};ka.DGf=null;ka.QL=null;Object(L.a)(ka,"Box4PasteSteward",m.a,[])},267:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.body=this.contextId=this.revId=this.sourceTimestamp=this.source=
this.id=null}}Object(L.a)(k,"Item",null,[])},270:function(L,V,d){d.r(V);L=d(0);d(395);var k=d(950);d(951);var e=d(25),n=d(99),r=d(54),w=d(36);class D{}Object(L.a)(D,"RibbonUpsellButtonCreator",null,[]);class y extends Sys.EventArgs{constructor(G){super();this.Nom=G}}Object(L.a)(y,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(396);var m=d(430);d(176);var C=d(132);d(316);d(78);var E=d(240),F=d(164),B=d(67);class H{constructor(G,Y){this.cluster=G;this.lUc=Y}}Object(L.a)(H,"ImageInfo",null,[]);class K{constructor(G,
Y,ba,ha,ka,ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba,za){Ba=void 0===Ba?null:Ba;za=void 0===za?null:za;this.id=G;this.jNc=Y;this.nNc=ba;this.mNc=ha;this.lNc=ka;this.kNc=ca;this.oNc=ia;this.vYd=oa;this.nSb=new H(sa,Ca);this.aBd=new H(Ta,R);this.hnd=new H(Ha,da);Ba&&za&&new H(Ba,za)}}Object(L.a)(K,"PeoplesWellBaseSettings",null,[]);class A{constructor(){this.vRf=null}}Object(L.a)(A,"BreadcrumbControls",null,[]);class W{constructor(G){this.id=G}}new W("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32",
"WACSkypeDocChatUnread_16x16x32");Object(L.a)(W,"ChatButtonSettings",null,[]);class N{constructor(){this.id=this.image=this.label=this.command=null}}Object(L.a)(N,"SkypeButtonInfo",null,[]);class P{constructor(){this.Aif=this.uYh=this.n2d=null}}Object(L.a)(P,"TopRowControls",null,[]);var U=d(197);d(46);d.d(V,"CuiHelper",function(){return Q});class Q{constructor(G,Y,ba,ha,ka){ba=void 0===ba?null:ba;this.Mja=G;this.igi=U.a.SXk(Y,void 0===ka?null:ka);this.igi.push(CommonUIStrings);k.b();Q.Ca=void 0===
ba||null===ba?e.AFrameworkApplication.Pa:ba}static get k2j(){return Q.psa||(Q.psa=r.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static hIj(G,Y,ba){return new K(Q.qXe,w.a.AVi,w.a.A5d,w.a.DVi,w.a.CVi,w.a.BVi,w.a.EVi,w.a.Q$a,G,"per_SingleCollabUserGlyph_16x16x32",Y,"per_SingleCollabUserGlyph_32x32x32",ba,"per_MoreUsersGlyph_16x16x32",null,null)}static ddj(G){G.n2d&&(Q.cdj(G.n2d),G.n2d=null);G.uYh&&(Q.bdj(),G.uYh=null);G.Aif&&(Q.edj(G.Aif),G.Aif=null);Q.k2j.qql();let Y=m.a.XTb(!1);({Mcc:G}=
Y);Y.returnValue&&n.a.EEa(G)}static Bdc(){e.AFrameworkApplication.Pa.nb(w.a.Bdc,2)}static bdj(){e.AFrameworkApplication.YVc&&F.EventHandlerManager.instance.DEd(e.AFrameworkApplication.YVc)}static addButton(G,Y,ba,ha,ka,ca,ia,oa){Y=C.a(G,Y,ba,ha,null,null,null,ca,null,null,void 0,void 0,ka);(G=oa.hostControl(G,Y,ca))&&ia.appendChild(G);return G}static tTc(G,Y,ba){let ha;ha=document.createElement("span");ha.className="BreadcrumbItem";ha.id=Y;ha.innerText=ba;ha.setAttribute("dir","auto");G.appendChild(ha);
return ha}static cdj(G){G.vRf&&F.EventHandlerManager.instance.Ufm(G.vRf)}static edj(G){E.a.instance.j1h(B.a.click,G,Q.$9k,!0)}static $9k(){e.AFrameworkApplication.wif?(e.AFrameworkApplication.za.$yc(e.AFrameworkApplication.za.mb.Bog()),e.AFrameworkApplication.wif=!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static q9c(){return!!e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.q9c}}Q.psa=null;Q.pWl="ShareServerWhite_20x20x32";Q.Ace="ExternalHeaderFullTopBars";Q.p2j="HeaderTopBars";
Q.o2d="BreadcrumbBrand";Q.p2d="BreadcrumbFolder";Q.q2d="BreadcrumbTitle";Q.Tdg="FolderSeparator";Q.Wdf="sbTellMe";Q.Maf="TellMe-SearchBox";Q.orh="btnOpenInClient";Q.v9e="btnFileSharing";Q.E2l="BasicChat";Q.Kvd="btnReplyWithChanges";Q.vbg="jbtnGiveFeedback";Q.qXe="PeoplesWellControl";Q.N7f="EditableBreadcrumbItem";Q.Ca=null;Q.Pgf=50;Q.i2j=null;Object(L.a)(Q,"CuiHelper",null,[241])},301:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.alt="Alt";k.iconColor="IconColor";k.PCb="Image16by16Class";
k.P6j="Image30by30Class";k.bHa="Image32by32Class";k.Toe="Image48by48Class";k.labelText="LabelText";k.Suk="LabelTextUserGeneratedPlaceholderReplacements";k.visible="Visible";k.uW="SourceControlId";k.customTooltip="CustomTooltip";k.Icon="Icon";k.IconSet="IconSet";k.nBh="ReduxActions";Object(L.a)(k,"SharedControlCommandProperties",null,[])},302:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.data=this.landingTab=null}}Object(L.a)(k,"LaunchData",null,[])},303:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);d=d(75);class k extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=
String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}$F(){return!0}static p8d(e){return"prControl"+(e?"Rtl":"")}}Object(L.a)(k,"BasePresenceControl",d.a,[106,239])},304:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e,n){super();this.type=e;this.Uj=n}}k.Ax="InteractivityChanged";Object(L.a)(k,
"InteractivityChangedEventArgs",Sys.EventArgs,[])},306:function(L,V,d){L=d(0);var k=d(54),e=d(396),n=d(597),r=d(129),w=d(395),D=d(99),y=d(668),m=d(408),C=d(46),E=d(228),F=d(55),B=d(1153),H=d(25),K=d(167);class A{constructor(da,Ba){this.cp=da;this.distance=Ba}}Object(L.a)(A,"CpDistanceResult",null,[]);class W{constructor(){this.WGa=0;this.gs=null;this.Ayb=this.Byb=this.fUa=this.fFa=0;this.rAc=this.pIa=this.ZNa=null;this.wFb=this.dfa=this.hmd=0;this.ejf=this.y$d=!1;this.q7b=this.YFa=this.Ela=this.W4=
this.Mtc=0;this.u6h=this.ddg=this.lzc=this.tSb=!1;this.result=null;this.G6b=this.m7d=this.fab=this.L9=this.Cea=0;this.gna=this.oTc=!1;this.rQ=null}}Object(L.a)(W,"CpFromPointState",null,[]);class N{constructor(da,Ba,za,Aa,na,la,va,Pa,Qa,Ua){this.WEa=this.cp=this.Ra=0;this.F6b=-1;this.deltaX=this.c0f=Number.MAX_VALUE;this.b1a=0;this.DYa=-Number.MAX_VALUE;this.BYa=-Number.MAX_VALUE;this.Zce=this.i9b=this.xwb=this.cUe=!1;this.element=da;this.point=za;this.Dfb=Aa;this.k2e=na;this.j2e=la;this.Kyg=va;this.ila=
void 0===Pa?null:Pa;this.q$a=void 0===Qa?0:Qa;this.originalText=Ba;this.RLa=this.originalText.length;this.Pb=this.RLa-1;this.afc=4===this.Dfb||3===this.Dfb;this.rQ=void 0===Ua?null:Ua}}Object(L.a)(N,"CpFromPointElementState",null,[]);var P=d(43);class U{constructor(da,Ba,za){this.CpBegin=da;this.CpEnd=Ba;this.IsEop=za}}Object(L.a)(U,"CpFromPointResult",null,[]);class Q{constructor(da,Ba,za){this.LineBounds=da;this.ClientRects=Ba;this.IsRangeMultipleLines=za}}Object(L.a)(Q,"LineCoordinateResult",null,
[]);var G=d(216);class Y{constructor(da,Ba,za,Aa,na,la){this.crb={};this.GYb=!0;this.THg=this.fJc=this.CLc=this.tub=this.I8a=null;this.H6l=5;this.yd=da;this.c0=Ba;this.Jhi=za?za.getBooleanAppSetting("TextFidelityLayoutFixesEnabled"):!1;this.Pgi=za?za.getBooleanAppSetting("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.Bgi=za?za.getBooleanAppSetting("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.aRa=Aa)||w.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");this.WQ=
na;this.Zpi=la}Qfa(){this.GYb=!1}gab(da,Ba,za,Aa){Aa=void 0===Aa?null:Aa;this.THg=[];var na=da.c8;if(!da.textLength)return this.OVj(da,Ba,za,Aa);Aa=Object.assign(new W,{ZNa:Array(na.length),pIa:Array(na.length),rAc:Array(na.length),y$d:!0,gs:na,rQ:Aa});for(var la=0;la<=na.length;la++){Aa.fFa=0;Aa.fUa=0;Aa.Byb=0;Aa.Ayb=0;Aa.WGa=0;Aa.tSb=!1;Aa.lzc=!1;if(la<na.length){if(!this.Gnj(da,Aa,la))continue}else{Aa.wFb=la-1;break}if(this.joj(Ba,Aa,la))break}if(Aa.ejf&&Aa.Mtc<Ba.y&&Ba.y<Aa.W4)return this.hLl(da,
Ba,za,Aa);Aa.result=null;Aa.Cea=-1;Aa.L9=Aa.YFa;Aa.fab=Number.MAX_VALUE;Aa.m7d=0;Aa.G6b=0;Aa.oTc=!1;Aa.gna=!1;for(na=Aa.dfa;na<=Aa.wFb;na++)if(la=this.hoj(da,Ba,za,na,Aa))return la;return this.vUj(da,Ba,za,Aa)}OVj(da,Ba,za,Aa){const na=da.isRtl;if(!za)return new U(0,0,!1);da=this.aTa(da,Aa);return!na&&Ba.x>da.x+da.width/2||na&&Ba.x<da.x+da.width/2?new U(-1,-1,!0):new U(0,0,!0)}Gnj(da,Ba,za){var Aa=void 0===Aa?!0:Aa;if(this.vSi(Ba.gs[za].htmlElement)||Ba.gs[za].CDb)return!1;var na=this.l2d(Ba.gs[za],
Ba.rQ);if(!na.width&&!Aa)return!1;Ba.ZNa[za]=na;Aa=na.y;let la=na.y+na.height;if(Ba.gs[za].BBg||Ba.gs[za].gna||Ba.gs[za].I5&&!Ba.gs[za].OXa)({W2f:Aa,V2f:la}=this.KMf(Ba.gs[za].htmlElement,Aa,la)),Ba.fFa=Ba.Byb=Aa,Ba.fUa=Ba.Ayb=la,Ba.pIa[za]=la-Aa,Ba.rAc[za]=Ba.pIa[za];else{if(this.TZl(da,za))na=this.Nu(da,Ba.q7b,void 0,void 0,void 0,Ba.rQ),Aa=this.sac(Ba.gs[za].htmlElement),da=1<Aa?this.Nu(da,Ba.q7b+Aa-1,void 0,void 0,void 0,Ba.rQ):na,Ba.fFa=Aa=na.y,Ba.fUa=na.y+na.height,Ba.Byb=da.y,Ba.Ayb=da.y+da.height,
Ba.pIa[za]=na.height,Ba.rAc[za]=na.height;else{da=this.Zpi.tPj(Ba.gs[za].htmlElement);let va=0;Object(G.a)("cursorPositioningForSubScriptFix")&&Ba.gs[za].htmlElement&&-1!==Ba.gs[za].htmlElement.className.indexOf("Subscript")&&(va=parseFloat(Ba.gs[za].htmlElement.style.verticalAlign.toString())-this.H6l);Ba.WGa=this.aRa.vNj(Ba.gs[za].htmlElement,da);({W2f:Aa,V2f:la}=this.KMf(Ba.gs[za].htmlElement,Aa,la));Ba.u6h=1<Math.abs(na.width-this.GCj(Ba.gs[za].htmlElement))||1<Math.abs(na.height-this.FCj(Ba.gs[za].htmlElement));
Ba.u6h&&this.c0.instance&&(da=Math.round(da*this.c0.instance.X4),Ba.WGa=Math.round(Ba.WGa*this.c0.instance.X4));Ba.fFa=Aa-Ba.WGa;Ba.fUa=Aa+da+Ba.WGa+va;Ba.Byb=la-da-Ba.WGa;Ba.Ayb=la+Ba.WGa;Ba.pIa[za]=da+2*Ba.WGa;Ba.rAc[za]=da}Ba.hmd=Math.max(Ba.hmd,Ba.pIa[za])}Ba.ddg||(Ba.W4=Ba.fFa,Ba.Ela=Ba.fUa,Ba.ddg=!0);Ba.lzc=Ba.Byb>(Ba.fFa+Ba.fUa)/2;za=Y.cva(Ba.hmd);this.Jhi&&(za=this.F_d(Ba,za));Ba.tSb=this.bfk(Ba.W4,Ba.Ela,Aa,za);return!0}bfk(da,Ba,za,Aa){return da===Ba?za>Ba:za>=Ba-Aa}F_d(da,Ba){return Ba=
this.aRa.F_d(!!da.rQ&&da.rQ.HEb,da.fFa,da.fUa,Ba)}joj(da,Ba,za){if(Ba.tSb||Ba.lzc){Ba.tSb?Ba.wFb=za-1:(Ba.W4=Math.min(Ba.W4,Ba.fFa),Ba.Ela=Math.max(Ba.Ela,Ba.fUa),Ba.wFb=za);Array.add(this.THg,Ba.Ela);if(da.y<=Ba.Ela)return!0;Ba.Mtc=Ba.Ela;Ba.W4=Ba.Byb;Ba.Ela=Ba.Ayb;Ba.dfa=za;Ba.YFa=Ba.q7b;Ba.y$d=Ba.tSb;Ba.ejf=Ba.lzc;Ba.hmd=Ba.gs[za].gna||Ba.gs[za].I5&&!Ba.gs[za].OXa?0:Ba.pIa[za]}else Ba.W4=Math.min(Ba.W4,Ba.fFa),Ba.Ela=Math.max(Ba.Ela,Ba.Ayb);da.y>Ba.Mtc&&da.y<Ba.W4&&!Ba.gs[Ba.dfa].gna&&!Ba.gs[Ba.dfa].I5&&
Ba.W4-Ba.Mtc<Ba.rAc[Ba.dfa]/2&&(Ba.W4=da.y);Ba.q7b+=this.T8i(Ba.gs[za]);return!1}hLl(da,Ba,za,Aa){if(Aa.gs[Aa.dfa].I5)return za?new U(Aa.YFa,Aa.YFa,!1):new U(Aa.YFa,Aa.YFa+1,!1);if(za=this.b0f(Aa.gs[Aa.dfa].htmlElement,Aa.ZNa[Aa.dfa],Ba,Aa.y$d?4:3,Aa.Mtc,Aa.W4,Aa.pIa[Aa.dfa],da.isRtl,da.ila,Aa.YFa,Aa.rQ))return za=Aa.YFa+za.cp,za=this.GMf(da,Ba,za,Aa.dfa,Aa.YFa,void 0,void 0,Aa.rQ),new U(za,za,!1);this.yd.kc(y.a.W_k,{["Reason"]:n.a.lbg});return null}hoj(da,Ba,za,Aa,na){if(na.gs[Aa].CDb)return null;
const la=na.gs[Aa].I5,va=na.gs[Aa].gna;let Pa=!1;if(la){if(na.ZNa[Aa].y>=na.W4&&(na.gs[Aa].OXa||na.gs[Aa].$7c)){var Qa=na.ZNa[Aa];const Ua=Qa.x+Qa.width/2,Ya=Math.abs(Ba.x-Ua);if(Ya<na.fab||!Qa.width&&Ya===na.fab)na.oTc=!0,na.fab=Ya,na.gna=!1,na.Cea=!za||!da.isRtl&&Ba.x<Ua||da.isRtl&&Ba.x>Ua?na.L9:na.L9+1}if(!na.gs[Aa].OXa&&!na.gs[Aa].$7c){Qa=na.ZNa[Aa];if(!za&&Ba.x>Qa.x&&Ba.x<Qa.x+Qa.width&&!na.gs[Aa].Vjk)return new U(na.L9,na.L9+1,!1);na.result=Ba.x<Qa.x+Qa.width/2?new A(da.isRtl?1:0,Math.max(Qa.x-
Ba.x,0)):new A(da.isRtl?0:1,Math.max(Ba.x-Qa.x-Qa.width,0))}}else va?(da=this.aTa(da,na.rQ),Pa=1>da.width,na.result=new A(-1,m.a.IVc(Ba,da))):na.result=this.b0f(na.gs[Aa].htmlElement,na.ZNa[Aa],Ba,Aa===na.dfa&&na.ejf?1:Aa===na.wFb&&!na.tSb&&na.lzc?0:2,na.W4,na.Ela,na.pIa[Aa],da.isRtl,da.ila,na.L9,na.rQ);na.result&&(na.result.distance<na.fab||Pa&&na.result.distance<=na.fab+1)&&(na.Cea=na.result.cp+na.L9,na.gna=va,na.fab=na.result.distance,na.m7d=na.L9,na.G6b=Aa,na.oTc=la);na.L9=la?na.L9+1:na.L9+this.sac(na.gs[Aa].htmlElement);
return null}vUj(da,Ba,za,Aa){if(-1===Aa.Cea)return this.yd.kc(y.a.rck,{["Reason"]:n.a.gbg}),null;const na=da.textLength;if(Aa.gna){if(za)return za=Aa.ZNa[Aa.ZNa.length-1],!da.isRtl&&Ba.x<za.x+za.width/2||da.isRtl&&Ba.x>za.x+za.width/2?new U(na,na,!1):new U(-1,-1,!0);Aa.Cea=na}Aa.Cea>na&&(Aa.Cea=na);!Aa.oTc&&Aa.Cea<na&&(Aa.Cea=this.GMf(da,Ba,Aa.Cea,Aa.G6b,Aa.m7d,Aa.G6b===Aa.dfa,Aa.G6b===Aa.wFb,Aa.rQ));return new U(Aa.Cea,Aa.Cea,!1)}GMf(da,Ba,za,Aa,na,la,va,Pa){la=void 0===la?!1:la;va=void 0===va?!1:
va;Pa=void 0===Pa?null:Pa;const Qa=da.isRtl,Ua=da.characterData,Ya=da.textLength;za=C.a.yy(Ua,za)?za-1:za;const Ea=C.a.Ojk(Ua,za)?za+2:za+1,La=this.Nu(da,za,void 0,void 0,void 0,Pa);Ba=Ba.x>La.x+La.width/2;if(za-na===this.sac(da.c8[Aa].htmlElement)&&da.c8.length>Aa+1&&da.c8[Aa+1].I5)return za;if(da.c8[Aa].sgk)return++za;if(da.c8[Aa].rgk)return za;let xb=null,dc=!1;0<za&&(xb=this.Nu(da,C.a.yy(Ua,za-1)?za-2:za-1,void 0,void 0,void 0,Pa),0<za-na?dc=xb.y+xb.height/2>La.y:la||da.c8[Aa-1].I5||(dc=!0));
la=null;let gb=!1;if(this.Bgi?Ea<=Ya:Ea<Ya)la=this.Nu(da,Ea,void 0,void 0,void 0,Pa),Ea-na<this.sac(da.c8[Aa].htmlElement)?gb=la.y+la.height/2<La.y+La.height:va||da.c8[Aa+1].OXa||da.c8[Aa+1].$7c||(gb=!0);dc&&gb?xb.x<=La.x&&la.x>=La.x?Ba&&(za=Ea):xb.x>=La.x&&la.x<=La.x?Ba||(za=Ea):xb.x<la.x?Ba||(za=Ea):la.x<xb.x&&Ba&&(za=Ea):dc||(gb?la.x>=La.x&&Ba?za=Ea:la.x<=La.x&&!Ba&&(za=Ea):!C.a.fA(Ua.charCodeAt(za))&&(!Qa&&Ba||Qa&&!Ba)&&(za=Ea));return za}DCj(da){return D.a.zw(da)}FCj(da){return da.offsetHeight}GCj(da){return da.offsetWidth}vSi(da){return!da.parentNode}sac(da){return D.a.kcb(da)}TZl(da,
Ba){Ba=da.c8[Ba];if(Ba.I5)return!1;da=da.htmlElement;Sys.UI.DomElement.containsCssClass(da,"Paragraph")||(da=da.firstChild);return""!==da.style.lineHeight&&da.style.lineHeight!==Ba.htmlElement.style.lineHeight}T8i(da){return da.I5?1:D.a.kcb(da.htmlElement)}KMf(da,Ba,za){za=new Sys.UI.Bounds(0,Ba,0,za-Ba);this.PBi(da,[za]);Ba=za.y;za=za.y+za.height;return{W2f:Ba,V2f:za}}PBi(da,Ba){if(da=E.a.Tu(da)){var za=da.borderTopWidth,Aa=za.indexOf("px");if(-1<Aa)for(za=parseInt(za.substr(0,Aa)),Aa=0;Aa<Ba.length;Aa++)Ba[Aa].y+=
za,Ba[Aa].height-=za;da=da.borderBottomWidth;za=da.indexOf("px");if(-1<za)for(da=parseInt(da.substr(0,za)),za=0;za<Ba.length;za++)Ba[za].height-=da}}b0f(da,Ba,za,Aa,na,la,va,Pa,Qa,Ua,Ya){Ya=void 0===Ya?null:Ya;if(this.Aik(da))return this.yd.kc(y.a.Eoj,{["Reason"]:n.a.kbg}),new A(0,m.a.IVc(za,Ba));if(this.zik(da))return this.yd.kc(y.a.vYc,{["Reason"]:n.a.vYc}),null;da=this.D2i(da,za,Aa,na,la,va,Qa,Ua,Ya);if(1>=da.RLa)return new A(0,m.a.IVc(da.point,Ba));this.aHl(da);do{if(da.Ra>da.Pb)return this.OPb(),
this.yd.kc(y.a.V_k,{["Reason"]:n.a.jjh}),null;this.WYk(da)}while(!da.cUe);for(da.WEa=!Pa&&da.b1a<da.point.x||Pa&&da.b1a>da.point.x?da.Pb:da.Ra;!da.xwb&&!this.jIi(da););if(da.Zce)for(da.cp=da.Ra;da.cp<=da.Pb&&!this.Fwk(da);da.cp++);return this.uTi(da)}D2i(da,Ba,za,Aa,na,la,va,Pa,Qa){return new N(da,this.DCj(da),Ba,za,Aa,na,la,va,Pa,void 0===Qa?null:Qa)}Aik(da){return!da.firstChild}zik(da){return 3!==da.firstChild.nodeType}aHl(da){let Ba;if(0===da.Dfb){da.DYa=da.k2e;da.BYa=da.j2e;for(var za=40;za<da.RLa;za+=
40)if(Ba=this.$Sa(da.element,da.originalText,za,da.ila,da.q$a,void 0,void 0,da.rQ),Ba.height&&Ba.y+Ba.height/2>da.BYa){da.Pb=za;break}}else if(1===da.Dfb)for(da.Pb=da.RLa-1,da.DYa=da.k2e,da.BYa=da.j2e,za=da.RLa-40;0<=za;za-=40){if(Ba=this.$Sa(da.element,da.originalText,za,da.ila,da.q$a,void 0,void 0,da.rQ),Ba.height&&Ba.y+Ba.height/2<da.DYa){da.Ra=za;break}}else if(2===da.Dfb)da.Pb=da.RLa-1,da.DYa=da.k2e,da.BYa=da.j2e;else if(3===da.Dfb||4===da.Dfb)for(za=0;za<da.RLa+40;za+=40){const Aa=za<da.RLa?
za:da.RLa-1;Ba=this.$Sa(da.element,da.originalText,Aa,da.ila,da.q$a,void 0,void 0,da.rQ);if(Ba.height&&(Ba.y+Ba.height<da.point.y&&(da.Ra=Aa),Ba.y>da.point.y)){da.Pb=Aa;break}}}WYk(da){const Ba=Math.floor((da.Ra+da.Pb)/2);da.cp=Ba;let za=this.$Sa(da.element,da.originalText,da.cp,da.ila,da.q$a,void 0,void 0,da.rQ);for(;da.cp<da.Pb&&!za.height;)da.cp++,za=this.$Sa(da.element,da.originalText,da.cp,da.ila,da.q$a,void 0,void 0,da.rQ);da.cp!==da.Pb||za.height?!da.afc&&za.y+za.height/2<da.DYa||da.afc&&za.y+
da.Kyg<da.point.y?da.Ra=da.cp+1:!da.afc&&za.y+za.height/2>da.BYa||da.afc&&za.y>da.point.y?da.Pb=da.cp-1:za.x<=da.point.x&&za.x+za.width>=da.point.x?(da.xwb=!0,da.i9b=!0,da.cUe=!0):(da.cUe=!0,da.b1a=za.x+za.width/2,da.F6b=da.cp,da.deltaX=Math.abs(da.b1a-da.point.x),da.afc&&(da.DYa=za.y,da.BYa=za.y+da.Kyg)):da.Pb=Ba-1}jIi(da){var Ba=Math.abs(da.WEa-da.cp);if(Ba<da.c0f)da.c0f=Ba;else return da.xwb=!0,da.Zce=!0;Ba=Math.floor((da.cp+da.WEa)/2);Ba===da.cp&&(Ba=da.WEa);var za=this.$Sa(da.element,da.originalText,
Ba,da.ila,da.q$a,void 0,void 0,da.rQ);if(0<za.height&&za.y+za.height/2<=da.DYa||za.y+za.height/2>=da.BYa)da.WEa=da.cp<da.WEa?Ba-1:Ba+1;else if(za.x<=da.point.x&&za.x+za.width>=da.point.x)da.cp=Ba,da.i9b=!0,da.xwb=!0;else{za=za.x+za.width/2;const Aa=Math.abs(da.b1a-za),na=Math.abs(da.b1a-da.point.x),la=Math.abs(za-da.point.x);la<da.deltaX&&(da.F6b=Ba,da.deltaX=la);Aa+la===na?(da.cp=Ba,da.b1a=za):na+la===Aa?(da.WEa=da.cp<da.WEa?da.cp+1:da.cp-1,da.cp=Ba,da.b1a=za):Aa+na===la&&(da.xwb=!0,da.Zce=!0)}da.WEa===
da.cp&&(da.xwb=!0);return!1}Fwk(da){var Ba=this.$Sa(da.element,da.originalText,da.cp,da.ila,da.q$a,void 0,void 0,da.rQ);if(0<Ba.height&&Ba.y+Ba.height/2<=da.DYa||Ba.y+Ba.height/2>=da.BYa)return!1;if(Ba.x<=da.point.x&&Ba.x+Ba.width>=da.point.x)return da.i9b=!0;Ba=Math.abs(Ba.x+Ba.width/2-da.point.x);Ba<da.deltaX&&(da.F6b=da.cp,da.deltaX=Ba);return!1}uTi(da){if(!da.i9b&&-1===da.F6b)return this.OPb(),this.yd.kc(y.a.X_k,{["Reason"]:n.a.hbg}),null;da.i9b?da.deltaX=0:da.cp=da.F6b;C.a.yy(da.originalText,
da.cp)&&da.cp--;this.OPb();return new A(da.cp,da.deltaX)}Nu(da,Ba,za,Aa,na,la){za=void 0===za?!1:za;Aa=void 0===Aa?!1:Aa;na=void 0===na?!1:na;la=void 0===la?null:la;let va,Pa,Qa,Ua;da||w.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ya=(()=>{let Ac=this.Wog(da,Ba,na);({i:va,gs:Pa,L9:Qa,v_k:Ua}=Ac);return Ac})().returnValue;Ba=Ua;let Ea="";Ea=da.ila;let La=D.a.zw(Ya.htmlElement),xb=La.length,dc,gb=!1;if(!xb)if(dc=Sys.UI.DomElement.getBounds(Ya.htmlElement),gb=!0,!dc.height&&va<Pa.length-
1)va++,Ya=Pa[va],La=K.b(Ya.htmlElement),xb=La.length;else if(!Ya.htmlElement.firstChild||Ya.BBg)return this.WQ.Wia(dc,la,()=>Ya.htmlElement.offsetWidth/Ya.htmlElement.offsetHeight);let gc=!1;!gb&&Ba>=xb&&(Ba=xb-1,gc=!0);if(dc=Ya.I5||!Ya.htmlElement.firstChild||Ya.GAg?this.l2d(Ya,la):this.$Sa(Ya.htmlElement,La,Ba,Ea,Qa,za,Aa,la))gb?dc.width=1:gc&&(dc.x+=dc.width,dc.width=1);this.OPb();return dc}MGa(da,Ba,za,Aa){return this.Wog(da,Ba,void 0===za?!1:za,void 0===Aa?!0:Aa).returnValue}Sfc(da,Ba){return Ba.y>
da.y+da.height-Y.cva(da.height)}Wog(da,Ba,za,Aa){za=void 0===za?!1:za;Aa=void 0===Aa?!0:Aa;let na=da;da=da.c8;let la=0,va;for(va=0;va<da.length;va++){if(da[va].CDb)continue;let Pa;if(da[va].I5){if(!Ba){za||this.Xkk(da,va)?na=da[va]:(na=da[va-1],Ba=Pa=D.a.kcb(na.htmlElement),la-=Pa);break}Ba--;la++;continue}Pa=D.a.kcb(da[va].htmlElement);let Qa=!1;if(this.Pgi){const Ua=da[va].htmlElement,Ya=Ua.nextSibling;Ya&&(Qa=Sys.UI.DomElement.containsCssClass(Ua,"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(Ya,
"Hyperlink"))}if(Ba<Pa||!Ba&&Aa&&!Qa||va>=da.length-1){na=da[va];break}else Ba-=Pa,la+=Pa}return{returnValue:na,i:va,gs:da,L9:la,v_k:Ba}}Xkk(da,Ba){if(!Ba)return!0;const za=this.Cwb(da[Ba-1].htmlElement);da=this.Cwb(da[Ba].htmlElement);return this.Sfc(za,da)}$Sa(da,Ba,za,Aa,na,la,va,Pa){la=void 0===la?!1:la;va=void 0===va?!1:va;Pa=void 0===Pa?null:Pa;let Qa=za+1;za||Ba.length?C.a.yy(Ba,za)?za--:C.a.yy(Ba,Qa)&&Qa++:Qa=0;if(""!==Aa)if(Aa=na+za+"-"+Aa,this.GYb){if(na=this.crb[Aa],void 0!==na&&null!==
na)return Aa=this.WQ.Wia(na,Pa,()=>this.WQ.$gg(da,za)),Aa=this.aRa.G_d(Pa,da,Aa)}else this.crb={},this.GYb=!0;na=this.eCc(da,za,Qa);la=la&&(F.a.Gk||F.a.gp);if(!na&&!va||la)Ba=this.jXk(da,Ba,za,Qa),na||(na=Ba),la&&na&&(na.y=Ba.y,na.height=Ba.height);""!==Aa&&na&&(this.crb[Aa]=new Sys.UI.Bounds(na.x,na.y,na.width,na.height));Aa=this.WQ.Wia(na,Pa,()=>this.WQ.$gg(da,za));return Aa=this.aRa.G_d(Pa,da,Aa)}eCc(da,Ba,za){let Aa=null;if(this.sac(da)<za)return null;F.a.oT&&(Aa=this.iXk(da,Ba,za));!Aa&&F.a.Gk&&
(Aa=this.kXk(da,Ba,za));return Aa}nRf(da,Ba){return this.Cwb(da.htmlElement.firstChild,void 0===Ba?null:Ba)}l2d(da,Ba){Ba=void 0===Ba?null:Ba;return da.OXa?this.nRf(da,Ba):this.Cwb(da.htmlElement,Ba)}Cwb(da,Ba){Ba=void 0===Ba?null:Ba;var za=Sys.UI.DomElement.getBounds(da);za=this.WQ.Wia(za,Ba,()=>da.offsetWidth/da.offsetHeight);return za=this.aRa.G_d(Ba,da,za)}AX(da,Ba,za,Aa,na,la){return da!==Ba.characterData.length||za?this.bJi(da,Ba,za,Aa,na,la):this.aJi(Ba)}aJi(da){const Ba=this.aTa(da);return this.djg(Ba,
!da.isRtl)}bJi(da,Ba,za,Aa,na,la){var va=Ba.textLength;if(F.a.iV&&za&&0<da&&da<va){var Pa=this.MGa(Ba,da-1,!0),Qa=this.MGa(Ba,da,!0);Pa===Qa&&(za=!1)}var Ua=za?da-1:da;C.a.yy(Ba.characterData,Ua)&&--Ua;var Ya=!0;Qa=this.MGa(Ba,Ua,!0,!1);if(Qa.I5)if(Qa.OXa){if(za)return this.AX(da,Ba,!1,Aa,!1,la);Pa=this.nRf(Qa)}else if(Qa.$7c){if(za)return this.AX(da,Ba,!1,Aa,!1,la);if(da)return this.AX(da,Ba,!0,Aa,!1,la);Pa=this.l2d(Qa)}else Pa=this.Cwb(Qa.htmlElement),Qa.mkk&&(Ya=!1);else{Qa=Ua;do{Pa=this.Nu(Ba,
Qa,na,la);if(!Pa)return null;Qa+=1}while(!Pa.height&&Qa<=va)}Qa=va=Ba.isRtl;if(Ya){Ya=this.NOc(Ba,Ua,-1,na,la);na=this.NOc(Ba,Ua,1,na,la);la=new Sys.UI.Point(Pa.x+Pa.width/2,Pa.y+Pa.height/2);Ua=Pa.y;var Ea=Pa.y+Pa.height;Ua=!Ya||Ya.y+Ya.height<=Ua;Ea=!na||na.y>=Ea;let La=!1;Ua||Ea?Ua||C.a.fA(Ba.characterData.charCodeAt(da))?Ea||(na.x>=la.x?Qa=!1:na.x<=la.x&&(Qa=!0),La=Qa!==va):(Ya.x<=la.x?Qa=!1:Ya.x>=la.x&&(Qa=!0),La=Qa!==va):Ya.x<=la.x&&la.x<=na.x?Qa=!1:na.x<=la.x&&la.x<=Ya.x?Qa=!0:Ya.x<na.x?(Qa=
!0,La=za?la.x<Ya.x:Ya.x<la.x):na.x<Ya.x&&(Qa=!1,La=za?Ya.x<la.x:la.x<Ya.x);if(La&&F.a.WD){if(za&&!Aa)return this.AX(da,Ba,!1,!1);da||(Pa=this.Mzj(Ba,va))}}return this.djg(Pa,Qa===za)}NOc(da,Ba,za,Aa,na){if(0>za&&0>=Ba||0<za&&Ba>=da.characterData.length-1)return null;const la=Ba+za;return C.a.yy(da.characterData,la)?this.NOc(da,la,za,Aa,na):this.MGa(da,Ba,!0,!1).OXa?null:(Ba=this.Nu(da,la,Aa,na))?Ba.height&&Ba.width?Ba:this.NOc(da,la,za,Aa,na):null}Mzj(da,Ba){let za=null;for(var Aa=0;Aa<da.c8.length;Aa++){const na=
da.c8[Aa];if(!na.CDb){za=na.htmlElement;break}}for(Aa=za.childNodes[0];Aa&&1===Aa.nodeType;)za=Aa,Aa=za.childNodes[0];Aa=D.a.zw(za);D.a.yA(za,(Ba?"\u202e":"\u202d")+Aa);this.Qfa();da=this.Nu(da,0);D.a.yA(za,Aa);this.Qfa();return da}djg(da,Ba){return new Sys.UI.Bounds(Ba?da.x:da.x+da.width,da.y,0,da.height)}aTa(da,Ba){return this.Cwb(da.$9f.htmlElement,void 0===Ba?null:Ba)}iXk(da,Ba,za){this.OPb();try{const Aa=da.firstChild,na=Aa.ownerDocument.createRange();na.setStart(Aa,Ba);na.setEnd(Aa,za);const la=
this.ZGj(na,(va,Pa)=>(0<va||Ba===za)&&0<Pa);if(!la||!la.length)return null;this.FMf(Aa,la[0]);na.detach();return la[0]}catch(Aa){return null}}ZGj(da,Ba){this.OPb();try{let za;za=da.getClientRects();da=[];for(let Aa=0;Aa<za.length;Aa++){const na=za[Aa];if(na){const la=Math.floor(na.width/1),va=Math.floor(na.height/1);if(Ba(la,va)){const Pa=new Sys.UI.Bounds(Math.floor(na.left/1),Math.floor(na.top/1),la,va);Array.add(da,Pa)}}}return da}catch(za){return null}}kXk(da,Ba,za){if(!F.a.WSb)return null;let Aa=
null;try{Aa=da.ownerDocument.body.createTextRange(),Aa.moveToElementText(da)}catch(na){return null}if(Aa.collapse&&Aa.move&&Aa.moveEnd)Aa.collapse(),Aa.move("character",Ba),Aa.moveEnd("character",za-Ba);else return null;Ba=new Sys.UI.Bounds(Aa.boundingLeft,Aa.boundingTop,Aa.boundingWidth,Aa.boundingHeight);if(!(Ba.x||Ba.y||Ba.width||Ba.height))return null;this.FMf(da,Ba);da=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==da&&(Ba.x=Math.round(Ba.x/da),Ba.y=Math.round(Ba.y/da),Ba.width=Math.round(Ba.width/
da),Ba.height=Math.round(Ba.height/da));return Ba}jXk(da,Ba,za,Aa){this.I8a&&this.I8a.ownerDocument===da.ownerDocument||(this.I8a=da.ownerDocument.createElement("SPAN"),this.tub=da.ownerDocument.createElement("SPAN"),this.CLc=da.ownerDocument.createElement("SPAN"));da.firstChild!==this.I8a&&(this.fJc=new B.a(da),D.a.qw(da),this.aRa&&this.aRa.WTi(this.I8a,this.tub,this.CLc),da.appendChild(this.I8a),da.appendChild(this.tub),da.appendChild(this.CLc));D.a.yA(this.I8a,C.a.substring(Ba,0,za));D.a.yA(this.tub,
C.a.substring(Ba,za,Aa));D.a.yA(this.CLc,C.a.substring(Ba,Aa,Ba.length));H.AFrameworkApplication.fa.getBooleanAppSetting("ChromiumSpanIssueFixIsEnabled")&&F.a.Fk&&F.a.Ifk&&" "===C.a.substring(Ba,za,Aa)&&Sys.UI.DomElement.addCssClass(this.tub,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.tub)}FMf(da,Ba){this.KBi(da,[Ba])}KBi(da,Ba){try{if(void 0!==da.ownerDocument.parentWindow){var za=da.ownerDocument.parentWindow.frameElement;if(za&&("0"===za.frameBorder||"no"===za.frameBorder))for(da=
0;da<Ba.length;da++)Ba[da].x+=2,Ba[da].y+=2}}catch(Aa){}}OPb(){this.fJc&&this.fJc.restore();this.fJc=null}Dwb(da,Ba){if(""!==Ba){let za;if(this.GYb){if(za=this.crb["VE-"+Ba])return da=new Sys.UI.Bounds(za.x,za.y,za.width,za.height)}else this.crb={},this.GYb=!0;za=Sys.UI.DomElement.getBounds(da);this.crb["VE-"+Ba]=za;return da=new Sys.UI.Bounds(za.x,za.y,za.width,za.height)}return Sys.UI.DomElement.getBounds(da)}static get instance(){return Y.Ja||(Y.Ja=new Y(e.a.instance,k.a.instance.Ha("Common.IZoomManager"),
H.AFrameworkApplication.fa,k.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),k.a.instance.resolve("Box4.IRotatingCoordinateConverter"),k.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static cva(da){return P.SelectionEditor.cva(da)}}Y.Ja=null;Object(L.a)(Y,"TextMetrics",null,[]);var ba=d(98);class ha{get OXa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.chc)}get I5(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.AO)}get $7c(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
ba.a.pcl)}get mkk(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.Uak)||Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.Tak)||Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.Rak)}get BBg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.ebe)}get GAg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.XZf)}}Object(L.a)(ha,"ATextMetricsElement",null,[398]);var ka=d(33),ca=d(153);class ia extends ha{constructor(da){super();this.OQ=da}get htmlElement(){return this.OQ}get gna(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
ba.a.OO)}get CDb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ca.a.wX)}get Vjk(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.odk)}get sgk(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.zIi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.Wak)}get rgk(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.yIi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,ba.a.Vak)}}Object(L.a)(ia,"TextMetricsLeafElement",ha,[432,398]);
var oa=d(53),sa=d(59);class Ca extends ha{constructor(da){super();this.ttb=da;this.vj=this.ttb.eb;this.H1b=Array(da.qu.length);for(da=0;da<this.ttb.qu.length;da++){const Ba=new ia(this.ttb.qu[da]);this.H1b[da]=Ba}}get c8(){return this.H1b}get paragraphId(){return this.vj.id.toString()}get htmlElement(){return this.ttb.htmlElement}get ila(){return this.ttb.Tc.xi?this.ttb.eb.id.toString():""}get textLength(){return ka.ParagraphReader.textLength(this.vj)}get isRtl(){return sa.OutlineElementReader.kn(oa.OutlineElementNavigator.qC(this.vj))}get rt(){return ka.ParagraphReader.ke(this.vj)&&
!this.vj.nY}get characterData(){return this.vj.characterData}get $9f(){return this.H1b.length?this.H1b[this.H1b.length-1]:null}static mab(da){return new Ca(da)}}Object(L.a)(Ca,"TextMetricsParagraphElement",ha,[397,398]);var Ta=d(50),R=d(34);d.d(V,"a",function(){return Ha});class Ha{static get E6b(){return Ha.PB||(Ha.PB=k.a.instance.ub("Box4.CharacterPointConverter"))}static get fd(){return e.a.instance}static Nu(da,Ba,za,Aa,na,la){za=void 0===za?!1:za;Aa=void 0===Aa?!1:Aa;na=void 0===na?!1:na;la=
void 0===la?null:la;da=Ca.mab(da);return Y.instance.Nu(da,Ba,za,Aa,na,la)}static eCc(da,Ba,za){return Y.instance.eCc(da,Ba,za)}static Dwb(da,Ba){return Y.instance.Dwb(da,Ba)}static AX(da,Ba,za,Aa,na,la){na=void 0===na?!1:na;la=void 0===la?!1:la;Ba=Ca.mab(Ba);return Y.instance.AX(da,Ba,za,Aa,na,la)}static aTa(da,Ba){Ba=void 0===Ba?null:Ba;da=Ca.mab(da);return Y.instance.aTa(da,Ba)}static Qfa(){Y.instance.Qfa()}static gab(da,Ba,za,Aa){Aa=void 0===Aa?null:Aa;let na=null,la=null;try{const va=Ca.mab(da);
let Pa=null;na=Ha.fd.Cq(R.a.Zvj);(Pa=Y.instance.gab(va,Ba,za,Aa))&&(la=Ha.E6b?Ha.E6b.Stm(Pa,da.eb):Ta.a.QTa(Pa.CpBegin,Pa.CpEnd,Pa.IsEop,da.eb))}catch(va){Ha.fd.kc(r.a.Qpm,{["Reason"]:n.a.Xij,["ExceptionMessage"]:va.message,["ExceptionCallstack"]:va.stack}),la=null}na&&na.end();return la}static MGa(da,Ba,za,Aa){za=void 0===za?!1:za;Aa=void 0===Aa?!0:Aa;da=Ca.mab(da);return Y.instance.MGa(da,Ba,za,Aa).htmlElement}static Sfc(da,Ba){return Y.instance.Sfc(da,Ba)}}Ha.PB=null;Object(L.a)(Ha,"TextMetricsAdapter",
null,[])},315:function(L,V,d){L=d(0);var k=d(395),e=d(25),n=d(1292);const r=(D,y)=>{const m={};let C=null;switch(D){case 0:C="HtmlProcessor";var E=y.a;null!=E&&(m.SessionID=E);var F=y.b.toString();null!=F&&(m.Elements=F);var B=y.c.toString();null!=B&&(m.PrunedElements=B);var H=y.d.toString();null!=H&&(m.TransparentElements=H);var K=y.e.toString();null!=K&&(m.VoidElements=K);var A=y.f.toString();null!=A&&(m.UnknownElements=A);break;case 1:C="WordConverter";var W=y.a;null!=W&&(m.SessionID=W);var N=
y.b.toString();null!=N&&(m.BulletsConverted=N);var P=y.c.toString();null!=P&&(m.NumberedConverted=P);break;case 2:C="FormattingSteward";var U=y.a;null!=U&&(m.SourceApp=U);var Q=y.b;null!=Q&&(m.Browser=Q);var G=y.c;null!=G&&(m.OperationId=G);var Y=y.d.toString();null!=Y&&(m.Lang=Y);var ba=y.e.toString();null!=ba&&(m.TextDir=ba);var ha=y.f.toString();null!=ha&&(m.Bold=ha);var ka=y.g.toString();null!=ka&&(m.Math=ka);var ca=y.h.toString();null!=ca&&(m.Italics=ca);var ia=y.i.toString();null!=ia&&(m.Underline=
ia);var oa=y.j.toString();null!=oa&&(m.Strikethrough=oa);var sa=y.k.toString();null!=sa&&(m.Subscript=sa);var Ca=y.l.toString();null!=Ca&&(m.Superscript=Ca);var Ta=y.m.toString();null!=Ta&&(m.Fontsize=Ta);var R=y.n.toString();null!=R&&(m.Fontface=R);var Ha=y.o.toString();null!=Ha&&(m.GrowFontsize=Ha);var da=y.p.toString();null!=da&&(m.ShrinkFontsize=da);var Ba=y.q.toString();null!=Ba&&(m.FontColor=Ba);var za=y.r.toString();null!=za&&(m.FontHighlight=za);var Aa=y.s.toString();null!=Aa&&(m.ParagraphStyle=
Aa);var na=y.t.toString();null!=na&&(m.TextAlign=na);var la=y.u.toString();null!=la&&(m.TextIndent=la);var va=y.v.toString();null!=va&&(m.MarginLeft=va);var Pa=y.w.toString();null!=Pa&&(m.ParagraphSpaceBefore=Pa);var Qa=y.x.toString();null!=Qa&&(m.ParagraphSpaceAfter=Qa);var Ua=y.y.toString();null!=Ua&&(m.LineSpace=Ua);var Ya=y.z.toString();null!=Ya&&(m.CellShadingColor=Ya);break;case 3:C="SemanticEvents";var Ea=y.a;null!=Ea&&(m.SessionID=Ea);var La=y.b.toString();null!=La&&(m.Text=La);var xb=y.c.toString();
null!=xb&&(m.LineBreak=xb);var dc=y.d.toString();null!=dc&&(m.Image=dc);var gb=y.e.toString();null!=gb&&(m.File=gb);var gc=y.f.toString();null!=gc&&(m.FormattingChange=gc);var Ac=y.g.toString();null!=Ac&&(m.Anchor=Ac);var $b=y.h.toString();null!=$b&&(m.Paragraph=$b);var jc=y.i.toString();null!=jc&&(m.Math=jc);var pb=y.j.toString();null!=pb&&(m.List=pb);var $a=y.k.toString();null!=$a&&(m.ListItem=$a);var zc=y.l.toString();null!=zc&&(m.RenderAugmentation=zc);var rb=y.m.toString();null!=rb&&(m.Span=
rb);break;case 4:C="SemanticTableEvents";var ib=y.a;null!=ib&&(m.SessionID=ib);var Vb=y.b.toString();null!=Vb&&(m.Tables=Vb);var Od=y.c.toString();null!=Od&&(m.TableRow=Od);var jb=y.d.toString();null!=jb&&(m.TableCell=jb);var Wb=y.e.toString();null!=Wb&&(m.TablePart=Wb);break;case 5:C="HtmlEvents";var qb=y.a;null!=qb&&(m.OperationId=qb);var Ga=y.b;null!=Ga&&(m.SourceApp=Ga);var cb=y.c;null!=cb&&(m.Browser=cb);var Ob=null==y.d?null:y.d.toString();null!=Ob&&(m.Text=Ob);var Db=null==y.e?null:y.e.toString();
null!=Db&&(m.A=Db);var mb=null==y.f?null:y.f.toString();null!=mb&&(m.Abbr=mb);var Vc=null==y.g?null:y.g.toString();null!=Vc&&(m.Acronym=Vc);var Zb=null==y.h?null:y.h.toString();null!=Zb&&(m.Address=Zb);var fc=null==y.i?null:y.i.toString();null!=fc&&(m.Applet=fc);var ob=null==y.j?null:y.j.toString();null!=ob&&(m.Area=ob);var ub=null==y.k?null:y.k.toString();null!=ub&&(m.B=ub);var bc=null==y.l?null:y.l.toString();null!=bc&&(m.Base=bc);var ic=null==y.m?null:y.m.toString();null!=ic&&(m.Basefont=ic);var Rc=
null==y.n?null:y.n.toString();null!=Rc&&(m.Bdo=Rc);var Fb=null==y.o?null:y.o.toString();null!=Fb&&(m.Big=Fb);var Qb=null==y.p?null:y.p.toString();null!=Qb&&(m.Blockquote=Qb);var hc=null==y.q?null:y.q.toString();null!=hc&&(m.Body=hc);var Pc=null==y.r?null:y.r.toString();null!=Pc&&(m.Br=Pc);var uc=null==y.s?null:y.s.toString();null!=uc&&(m.Button=uc);var zb=null==y.t?null:y.t.toString();null!=zb&&(m.Caption=zb);var ac=null==y.u?null:y.u.toString();null!=ac&&(m.Center=ac);var Jb=null==y.v?null:y.v.toString();
null!=Jb&&(m.Cite=Jb);var Yc=null==y.w?null:y.w.toString();null!=Yc&&(m.Code=Yc);var dd=null==y.x?null:y.x.toString();null!=dd&&(m.Col=dd);var id=null==y.y?null:y.y.toString();null!=id&&(m.Colgroup=id);var Cc=null==y.z?null:y.z.toString();null!=Cc&&(m.Dd=Cc);var Nb=null==y.ba?null:y.ba.toString();null!=Nb&&(m.Del=Nb);var nc=null==y.bb?null:y.bb.toString();null!=nc&&(m.Dfn=nc);var Kc=null==y.bc?null:y.bc.toString();null!=Kc&&(m.Dir=Kc);var xd=null==y.bd?null:y.bd.toString();null!=xd&&(m.Div=xd);var Xc=
null==y.be?null:y.be.toString();null!=Xc&&(m.Dl=Xc);var Tb=null==y.bf?null:y.bf.toString();null!=Tb&&(m.Dt=Tb);var he=null==y.bg?null:y.bg.toString();null!=he&&(m.Em=he);var re=null==y.bh?null:y.bh.toString();null!=re&&(m.Fieldset=re);var ee=null==y.bi?null:y.bi.toString();null!=ee&&(m.Font=ee);var Yf=null==y.bj?null:y.bj.toString();null!=Yf&&(m.Form=Yf);var ke=null==y.bk?null:y.bk.toString();null!=ke&&(m.Frame=ke);var ef=null==y.bl?null:y.bl.toString();null!=ef&&(m.Frameset=ef);var yf=null==y.bm?
null:y.bm.toString();null!=yf&&(m.H=yf);var Rf=null==y.bn?null:y.bn.toString();null!=Rf&&(m.Head=Rf);var Za=null==y.bo?null:y.bo.toString();null!=Za&&(m.Hr=Za);var Kb=null==y.bp?null:y.bp.toString();null!=Kb&&(m.Html=Kb);var Ic=null==y.bq?null:y.bq.toString();null!=Ic&&(m.I=Ic);var Hc=null==y.br?null:y.br.toString();null!=Hc&&(m.Iframe=Hc);var jd=null==y.bs?null:y.bs.toString();null!=jd&&(m.Img=jd);var Id=null==y.bt?null:y.bt.toString();null!=Id&&(m.Input=Id);var ze=null==y.bu?null:y.bu.toString();
null!=ze&&(m.Ins=ze);var Ie=null==y.bv?null:y.bv.toString();null!=Ie&&(m.Isindex=Ie);var Cd=null==y.bw?null:y.bw.toString();null!=Cd&&(m.Kbd=Cd);var ue=null==y.bx?null:y.bx.toString();null!=ue&&(m.Label=ue);var Ee=null==y.by?null:y.by.toString();null!=Ee&&(m.Legend=Ee);var Xe=null==y.bz?null:y.bz.toString();null!=Xe&&(m.Li=Xe);var Sd=null==y.ca?null:y.ca.toString();null!=Sd&&(m.Link=Sd);var ad=null==y.cb?null:y.cb.toString();null!=ad&&(m.Map=ad);var af=null==y.cc?null:y.cc.toString();null!=af&&(m.Math=
af);var pf=null==y.cd?null:y.cd.toString();null!=pf&&(m.Menu=pf);var xf=null==y.ce?null:y.ce.toString();null!=xf&&(m.Meta=xf);var gf=null==y.cf?null:y.cf.toString();null!=gf&&(m.Noframes=gf);var me=null==y.cg?null:y.cg.toString();null!=me&&(m.Noscript=me);var ag=null==y.ch?null:y.ch.toString();null!=ag&&(m.Object=ag);var de=null==y.ci?null:y.ci.toString();null!=de&&(m.Ol=de);var wa=null==y.cj?null:y.cj.toString();null!=wa&&(m.Optgroup=wa);var ta=null==y.ck?null:y.ck.toString();null!=ta&&(m.Option=
ta);var Eb=null==y.cl?null:y.cl.toString();null!=Eb&&(m.P=Eb);var qc=null==y.cm?null:y.cm.toString();null!=qc&&(m.Param=qc);var Sc=null==y.cn?null:y.cn.toString();null!=Sc&&(m.Pre=Sc);var td=null==y.co?null:y.co.toString();null!=td&&(m.Q=td);var je=null==y.cp?null:y.cp.toString();null!=je&&(m.S=je);var Te=null==y.cq?null:y.cq.toString();null!=Te&&(m.Samp=Te);var Hd=null==y.cr?null:y.cr.toString();null!=Hd&&(m.Script=Hd);var mg=null==y.cs?null:y.cs.toString();null!=mg&&(m.Select=mg);var fg=null==y.ct?
null:y.ct.toString();null!=fg&&(m.Small=fg);var $e=null==y.cu?null:y.cu.toString();null!=$e&&(m.Span=$e);var oj=null==y.cv?null:y.cv.toString();null!=oj&&(m.Strike=oj);var Me=null==y.cw?null:y.cw.toString();null!=Me&&(m.Strong=Me);var we=null==y.cx?null:y.cx.toString();null!=we&&(m.Style=we);var Zc=null==y.cy?null:y.cy.toString();null!=Zc&&(m.Sub=Zc);var te=null==y.cz?null:y.cz.toString();null!=te&&(m.Sup=te);var ne=null==y.da?null:y.da.toString();null!=ne&&(m.Tables=ne);var Zf=null==y.db?null:y.db.toString();
null!=Zf&&(m.Tbody=Zf);var cd=null==y.dc?null:y.dc.toString();null!=cd&&(m.Td=cd);var aj=null==y.dd?null:y.dd.toString();null!=aj&&(m.Textarea=aj);var Qc=null==y.de?null:y.de.toString();null!=Qc&&(m.Tfoot=Qc);var Mc=null==y.df?null:y.df.toString();null!=Mc&&(m.Th=Mc);var Ig=null==y.dg?null:y.dg.toString();null!=Ig&&(m.Thead=Ig);var wg=null==y.dh?null:y.dh.toString();null!=wg&&(m.Title=wg);var fe=null==y.di?null:y.di.toString();null!=fe&&(m.Tr=fe);var Qe=null==y.dj?null:y.dj.toString();null!=Qe&&(m.Tt=
Qe);var ig=null==y.dk?null:y.dk.toString();null!=ig&&(m.U=ig);var Ph=null==y.dl?null:y.dl.toString();null!=Ph&&(m.Ul=Ph);var $g=null==y.dm?null:y.dm.toString();null!=$g&&(m.Var=$g);var Vg=null==y.dn?null:y.dn.toString();null!=Vg&&(m.Unknown=Vg);break;case 6:C="List";var Fg=y.a;null!=Fg&&(m.SessionID=Fg);var bf=y.b.toString();null!=bf&&(m.MaxListLevel=bf)}m.Table=C;return Sys.Serialization.JavaScriptSerializer.serialize(m)};d.d(V,"a",function(){return w});class w{static get Q$(){null==w.i7a&&(w.i7a=
!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("UsageEditorLoggingIsDisabled"));return w.i7a}static get nDg(){null==w.AOd&&(w.AOd=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("WordUsageEditorLoggingIsEnabled"));return w.AOd}static $R(D){k.ULS.sendTraceTag(5822145,307,50,D)}static akg(D){const y={};y.a=D;y.b=0;y.c=0;y.d=0;y.e=0;y.f=0;return y}static UAk(D){w.Q$||w.$R(r(0,D))}static ame(D){const y={};y.a=D;y.b=0;y.c=0;return y}static WEk(D){w.Q$||
w.$R(r(1,D))}static $jg(D,y){const m={};m.c=n.a[D];m.a=y;return m}static TAk(D,y){w.nDg&&D&&(D.b=y,w.$R(r(5,D)))}static fog(D){const y={};y.a=D;y.b=0;y.c=0;y.d=0;y.e=0;y.f=0;y.g=0;y.h=0;y.i=0;y.j=0;y.k=0;y.l=0;y.m=0;return y}static KDk(D){w.Q$||w.$R(r(3,D))}static gog(D){const y={};y.a=D;y.b=0;y.c=0;y.d=0;y.e=0;return y}static LDk(D){w.Q$||w.$R(r(4,D))}static Qhe(D,y){const m={};m.b=n.a[D];m.c=y;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;m.m=0;m.n=0;m.o=0;m.p=0;m.q=0;m.r=0;m.s=0;m.t=0;
m.w=0;m.x=0;m.y=0;m.z=0;m.u=0;m.v=0;return m}static zAk(D,y){w.nDg&&D&&(D.a=y,w.$R(r(2,D)))}static MEj(D){const y={};y.a=D;y.b=-1;return y}static tBk(D){!w.Q$&&D&&0<=D.b&&w.$R(r(6,D))}}w.i7a=null;w.AOd=null;Object(L.a)(w,"UsageEditor",null,[])},336:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.Ae=this.rg=this.qe=this.hg=0}Qkj(e){return e.Ae<this.rg&&this.Ae<e.rg&&e.qe<this.hg&&this.qe<e.hg}Pzb(e){return e.Ae>=this.Ae&&e.rg<=this.rg&&e.qe>=this.qe&&e.hg<=this.hg}Hkj(e,
n){return e>=this.$cg&&e<=this.sze&&n>=this.Tcg&&n<=this.jze}aVa(){return 0>=this.hQ||0>=this.NS}equals(e){return e.Ae===this.Ae&&e.rg===this.rg&&e.qe===this.qe&&e.hg===this.hg}clone(){return Object.assign(new k,{Ae:this.Ae,rg:this.rg,qe:this.qe,hg:this.hg})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.Ae,this.rg,this.qe,this.hg)}get hQ(){return this.rg-this.Ae}get NS(){return this.hg-this.qe}get sze(){return this.rg-1}get jze(){return this.hg-
1}get $cg(){return this.Ae}get Tcg(){return this.qe}}Object(L.a)(k,"CellRange",null,[])},337:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"OAuthResult",null,[])},338:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.IX="data-copystatus";k.MTa="data-copyfailedreason";k.nq="data-clipservice-ccpid";k.version="data-clipservice-version";k.location="data-clipservice-location";k.EE="data-clipservice-dc";k.type="data-clipservice-type";k.bTe="data-clipservice-param";
k.count="data-clipservice-count";k.BHa="data-clipservice-cut";k.zHa="data-clipservice-isEmptyPlaceholder";k.client="data-clipservice-client";k.MUi="data-clipboardasbytes-url";k.x5h="wacserver";k.sessionId="data-SessionId";k.hob="data-ShapeIds";k.slideId="data-SlideId";k.timeStamp="data-TimeStamp";k.A7j="data-willexpire";k.Owg="ClipboardAsImage";k.Cz="data-pkey";Object(L.a)(k,"ClipServiceConstants",null,[])},339:function(L,V,d){d.d(V,"a",function(){return D});L=d(0);var k=d(32),e=d(50),n=d(18),r=d(33),
w=d(460);class D{constructor(y,m,C,E){this.Ub=y;this.hib=m;this.cKa=C;this.BK=E;if(!y)throw Error.argumentNull("m_graphIteratorFactory");if(!m)throw Error.argumentNull("m_outlineEditor");if(!C)throw Error.argumentNull("m_outlineElementNavigator");if(!E)throw Error.argumentNull("m_characterPropertiesEditor");}dCj(y,m,C){y=this.hCj(y,m,C);m=new n.a;for(const E of y)m.add(e.a.create(E));return m}hCj(y,m,C){const E=new k.GraphIterator;E.set(m);m=new n.a;this.j0c(y,E,C,!1,m);return m}j0c(y,m,C,E,F){let B=
null;if(m&&(B=m.sj())){do{switch(B.type){case 12:break;case 35:E&&this.j0c(y,m,C,E,F);break;case 14:C&&this.j0c(y,m,C,E,F);break;default:this.j0c(y,m,C,E,F)}if(y===B.type&&12===y){if(null===B)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");F.add(B)}}while(B=m.Up());m.Dc()}}E6e(y,m,C){for(const E of m){if(12===y&&(E.VA||E.Yfa&&0===E.aA().length)){m=this.Ub.Pc(E);E.deleteParagraph();this.hib.uX(m,!0);this.cKa.Ti(m);m=m.currentNode;const F=r.ParagraphReader.textLength(m);m=
e.a.createTextRange(m,0,F);this.BK.replaceTextRange(m,"")}C.push(...this.dCj(y,E,14===y).toArray())}}pQb(y,m,C){for(const E of m)this.E6e(y,E.yj(),C)}}D.x$=(y,m,C)=>{C=void 0===C?!1:C;const E=()=>{if(m){var F=C?m.XBb():m;y(F);w.a.instance.hEh(E)}};w.a.instance.f_d(E);return E};Object(L.a)(D,"ODSLGraphHelper",null,[])},340:function(L,V,d){d.d(V,"a",function(){return E});L=d(0);var k=d(1264),e=d(42),n=d(486),r=d(158),w=d(38),D=d(57),y=d(27),m=d(999),C=d(1E3);class E{constructor(F){this.zF=F}get node(){return this.zF}get propertySet(){return this.zF}get $y(){if(1074135132===
this.zF.hf)return 0;if(1074135137===this.zF.hf)return 1;y.a.J(508842136,802,10,"Invalid AppType {0}",n.a[this.zF.hf]);return-1}get id(){return 0===this.$y?this.propertySet.ra(w.a.w0,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.ra(w.a.w0,null)}get N6f(){return this.propertySet.ra(e.a.d0d,null)}get visibility(){return this.propertySet.ra(e.a.x3b,!1)}get width(){return this.propertySet.ra(e.a.IDi,320)}get row(){return this.propertySet.ra(e.a.HDi,0)}get Ezg(){return this.propertySet.ra(r.a.isForUILessAction,
!1)}get pqa(){return this.propertySet.ra(e.a.Rvb,null)}get version(){return this.propertySet.ra(e.a.nPc,null)}get store(){return this.propertySet.ra(e.a.mPc,null)}get storeType(){return this.propertySet.$a(w.a.u3b)}get assetId(){return this.propertySet.ra(w.a.s3b,null)}get assetStoreId(){return this.propertySet.ra(w.a.cPc,null)}get ownerAddinSolutionId(){return this.propertySet.ra(w.a.esh,null)}get sharedRuntimeId(){return this.propertySet.ra(r.a.sharedRuntimeId,null)}get settings(){const F={};m.a(this.node,
(B,H)=>{C.b(H,F)});return F}get slideId(){return 0===this.$y?D.a.Aq(this.zF.$a(w.a.sid),this.zF.$a(w.a.cid)):null}get shapeId(){const F=Object(k.a)(4,this.zF);return 0===this.$y&&F?F.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.ra(w.a.ownerAddinStoreType,null)}get qwb(){return this.propertySet.ra(w.a.qwb,-1)}get W9a(){return this.propertySet.ra(w.a.W9a,null)}}Object(L.a)(E,"AppReader",null,[1335])},341:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(25);class e{constructor(){this.currentDocumentPath=
k.AFrameworkApplication.fa.Ea("EditDocInClientUrl")}}Object(L.a)(e,"SmartLookupApplicationInterface",null,[])},342:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(1061);class e{constructor(n){this.Ir=new k.a;this.ifh=n}$J(n){const r=n.id;let w=null;this.Ir.Ib(r)?w=this.Ir.ga(r):(this.ifh&&(w=this.ifh(n,()=>{this.azl(r)})),w&&this.Ir.$(r,w));return w}dK(n){n=n.id;return this.Ir.Ib(n)?this.Ir.ga(n):null}azl(n){this.Ir.remove(n)}}Object(L.a)(e,"ShapeComponentViewManager",null,[722])},
350:function(L,V,d){var k=d(18),e=d(113),n=d(509),r=d(151),w=d(232);L=d(0);var D=d(221),y=d(27);class m{constructor(P,U,Q,G){this.type=P;this.stops=U;this.angle=Q;this.hfl=G}GW(){const P=D.a(this.stops,U=>U.GW()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",this.angle,P);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.hfl.GW(),P);y.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",this.type));
return w.Color.auto.GW()}static createLinearGradient(P,U){return new m(0,P,U,null)}static x5i(P,U){return new m(1,P,0,U)}}Object(L.a)(m,"GradientFill",null,[]);class C{constructor(P,U){this.left=P;this.top=U}GW(){return String.format("{0}% {1}%",this.left,this.top)}}Object(L.a)(C,"GradientPathCenter",null,[]);class E{constructor(P,U){this.color=P;this.position=U}GW(){return String.format("{0} {1}%",this.color.GW(),this.position)}}Object(L.a)(E,"GradientStop",null,[]);d.d(V,"a",function(){return F});
d.d(V,"g",function(){return B});d.d(V,"e",function(){return H});d.d(V,"b",function(){return K});d.d(V,"c",function(){return A});d.d(V,"f",function(){return W});d.d(V,"d",function(){return N});const F=P=>{P?(P=e.a(P),P=Object.assign(new n.a,{blipFillField:P.blipFillField||null,gradFillField:P.gradFillField||null,grpFillField:P.grpFillField||null,noFillField:P.noFillField||null,pattFillField:P.pattFillField||null,solidFillField:P.solidFillField||null})):P=null;return P},B=P=>{r.Box4ColorHelper.LUa(P)},
H=P=>{P=e.a(P);return!P||!P.blipFillField&&!P.gradFillField&&!P.grpFillField&&!P.noFillField&&!P.pattFillField&&!P.solidFillField},K=P=>{r.Box4ColorHelper.LUa(P)},A=P=>{K(P);P&&(P.cell3DField=null,P.extLstField=null,P.lnBField=null,P.lnBlToTrField=null,P.lnLField=null,P.lnRField=null,P.lnTField=null,P.lnTlToBrField=null)},W=(P,U)=>{if(!P)return null;var Q=P.gsLstField;if(Q){var G=new k.a;for(const Y of Q)Q=r.Box4ColorHelper.sXc(Y),r.Box4ColorHelper.neb(Q)?y.a.J(18397184,822,15,"Encountered invalid gradient stop color."):
G.add(new E(r.Box4ColorHelper.ZI(Q,U),Y.posField/1E3));U=G.toArray()}else U=null;if(P.linField)return G=90,P.linField.angFieldSpecified&&(G=(P.linField.angField/6E4+90)%360),m.createLinearGradient(U,G);if(P.pathField)return G=new C(50,50),P.pathField.fillToRectField&&(G=new C(P.pathField.fillToRectField.lField/1E3,P.pathField.fillToRectField.tField/1E3)),m.x5i(U,G);y.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");return m.createLinearGradient(U,90)},N=P=>e.b(P)},353:function(L,
V,d){L=d(0);var k=d(395),e=d(276),n=d(676),r=d(28),w=d(531);class D{}Object(L.a)(D,"ProofingFeedbackLoopRequestObject",null,[]);var y=d(532),m=d(34),C=d(530);d.d(V,"a",function(){return E});class E extends n.a{constructor(F,B,H,K,A){A=void 0===A?null:A;super(B);this.F8=F;this.phi=H;this.Kli=K;this.Yuf=!1;this.La=A;this.errorType=1===(this.F8.CritiqueActions&1)?0:1}get proofingType(){return w.b(this.F8)}get traceId(){return this.F8.TraceId}get vNf(){return this.F8.AnnotationId}get typeId(){return this.F8.TypeId}get KO(){return this.F8}get suggestions(){const F=
[];if(this.F8.Suggestions)for(const B of this.F8.Suggestions)F.push(B.Text);return F}get metadata(){const F=[];if(this.F8.Metadata&&0<this.F8.Metadata.length)for(const B of this.F8.Metadata)B.Name&&B.Value&&F.push(B);return F}DOa(F,B){B=void 0===B?0:B;this.YCf.track(()=>Object.assign(new y.a,{E:2,T:this.proofingType,A:F,I:B,G:this.typeId}));if(this.phi){var H=e.a.Oe(this.lcid);let K="";H?K=H.name:k.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);H=null;
k.ULS.sendTraceTag(39416218,375,50,"Sending proofing context with feedback loop API");H=Object.assign(new D,{AppId:C.a[r.App.mode]+"_online",TraceId:this.traceId,LanguageId:K,CritiqueTypeId:this.typeId,EventId:this.KVk(F),FlaggedText:this.token,SuggestionText:this.tOj(F),PreContextBegin:this.Sba,PostContextEnd:this.lMa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.F8.Priority,Metadata:this.F8.Metadata});14!==H.EventId&&this.Kli.xMl(H)}}KVk(F){switch(F){case m.a.Sma:return 0;
case m.a.Poe:return 1;case m.a.pFa:return 3;case m.a.dBa:return 4;case m.a.eBa:return 5;case m.a.fBa:return 6;case m.a.dzb:return 13;default:return 14}}tOj(F){switch(F){case m.a.dBa:return this.suggestions[0];case m.a.eBa:return this.suggestions[1];case m.a.fBa:return this.suggestions[2];case m.a.lOa:return this.suggestions[3];case m.a.mOa:return this.suggestions[4];default:return""}}get aHa(){return this.Yuf}set aHa(F){this.Yuf=F}}Object(L.a)(E,"EditorServiceErrorDetails",n.a,[419,556])},354:function(L,
V,d){var k=d(279),e=d(815),n=d(1294),r=d(46),w=d(218),D=d(25);L=d(0);class y{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(L.a)(y,"RecentColor",null,[]);var m=d(232),C=d(233),E=d(234),F=d(269),B=d(1081),H=d(548),K=d(27);d.d(V,"f",function(){return A});d.d(V,"e",function(){return W});d.d(V,"d",function(){return N});d.d(V,"c",function(){return P});d.d(V,"g",function(){return U});d.d(V,"b",function(){return Q});d.d(V,"a",function(){return G});d.d(V,"h",function(){return Y});const A=(ha,
ka,ca,ia,oa,sa,Ca)=>W(ha,ka,ca,ia,oa,sa,Ca,!1),W=(ha,ka,ca,ia,oa,sa,Ca,Ta)=>{ka=Object.assign(new k.a,{Id:ka,ControlsId:ca,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});ia=Object.assign(new e.a,{Id:ia,ExternalId:oa,McuExternalId:String.format("{0}MCU",oa),McuLayout:!0,Command:sa,Width:10});if(ha)if(oa=[],1===Ca||2===Ca){Ta=(new B.a).Qwj(ha);({themeColors:ha,XXh:Ca}=ba(Ta,ha));for(var R=0;6>R;R++)for(var Ha=0;Ha<ha.length;Ha++){sa=oa;ca=sa.push;var da=Ta;var Ba=ha[Ha][R],za=ha[Ha][0],Aa=
Ca[Ha],na=R,la=Ha;Ba=r.a.px(Ba.r,2)+r.a.px(Ba.g,2)+r.a.px(Ba.b,2);const {lSc:va,JTb:Pa}=da.Bge(za,Ba,Aa,na,la);da=Object.assign(new n.a,{Color:"#"+va,DisplayColor:"#"+Ba,Alt:Pa});ca.call(sa,da)}}else for(Ta=(new B.a).rhg(ha,Ta),{themeColors:ha,XXh:Ca}=ba(Ta,ha),R=0;6>R;R++)for(Ha=0;Ha<ha.length;Ha++){sa=oa;ca=sa.push;da=Ta;Ba=ha[Ha][R];za=ha[Ha][0];Aa=Ca[Ha];na=R;la=Ha;Ba=r.a.px(Ba.r,2)+r.a.px(Ba.g,2)+r.a.px(Ba.b,2);const {lSc:va,JTb:Pa}=da.Bge(za,Ba,Aa,na,la),{SHl:Qa,LKl:Ua,JTb:Ya}={SHl:Ba,LKl:va,
JTb:Pa};da=Object.assign(new n.a,{Color:Ua,DisplayColor:"#"+Qa,Alt:Ya});ca.call(sa,da)}else oa=null;ia.Colors=oa;Array.add(ka.ControlList,ia);return ka},N=(ha,ka,ca,ia,oa,sa)=>{ha=Object.assign(new k.a,{Id:ha,ControlsId:ka,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});ca=Object.assign(new e.a,{Id:ca,ExternalId:ia,Command:oa,Width:10,Colors:[]});sa?(ca.Colors.push(Object.assign(new n.a,{Color:"0000C0",Alt:r.a.Fe(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),ca.Colors.push(Object.assign(new n.a,
{Color:"0000FF",Alt:r.a.Fe(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),ca.Colors.push(Object.assign(new n.a,{Color:"00C0FF",Alt:r.a.Fe(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),ca.Colors.push(Object.assign(new n.a,{Color:"00FFFF",Alt:r.a.Fe(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),ca.Colors.push(Object.assign(new n.a,{Color:"50D092",Alt:r.a.Fe(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),ca.Colors.push(Object.assign(new n.a,
{Color:"50B000",Alt:r.a.Fe(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),ca.Colors.push(Object.assign(new n.a,{Color:"F0B000",Alt:r.a.Fe(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),ca.Colors.push(Object.assign(new n.a,{Color:"C07000",Alt:r.a.Fe(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),ca.Colors.push(Object.assign(new n.a,{Color:"602000",Alt:r.a.Fe(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),ca.Colors.push(Object.assign(new n.a,
{Color:"A03070",Alt:r.a.Fe(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(ca.Colors.push(Object.assign(new n.a,{Color:"#C00000",Alt:r.a.Fe(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),ca.Colors.push(Object.assign(new n.a,{Color:"#FF0000",Alt:r.a.Fe(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),ca.Colors.push(Object.assign(new n.a,{Color:"#FFC000",Alt:r.a.Fe(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),ca.Colors.push(Object.assign(new n.a,
{Color:"#FFFF00",Alt:r.a.Fe(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),ca.Colors.push(Object.assign(new n.a,{Color:"#92D050",Alt:r.a.Fe(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),ca.Colors.push(Object.assign(new n.a,{Color:"#00B050",Alt:r.a.Fe(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),ca.Colors.push(Object.assign(new n.a,{Color:"#00B0F0",Alt:r.a.Fe(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),ca.Colors.push(Object.assign(new n.a,
{Color:"#0070C0",Alt:r.a.Fe(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),ca.Colors.push(Object.assign(new n.a,{Color:"#002060",Alt:r.a.Fe(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),ca.Colors.push(Object.assign(new n.a,{Color:"#7030A0",Alt:r.a.Fe(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(ha.ControlList,ca);return ha},P=(ha,ka,ca,ia,oa,sa,Ca)=>{ka=Object.assign(new k.a,{Id:ka,ControlsId:ca,Title:ResourceStrings.L_RecentColors,ControlList:[]});
ia=Object.assign(new e.a,{Id:ia,ExternalId:oa,Command:sa,Width:10,Colors:[]});if(Ca)for(Ca=0;ha&&Ca<ha.length&&ha[Ca];Ca++)oa=ha[Ca],ia.Colors.push(Object.assign(new n.a,{Color:oa.hex,Alt:r.a.Fe(oa.hex),DisplayColor:oa.hex}));else for(Ca=0;ha&&Ca<ha.length&&ha[Ca];Ca++)oa=ha[Ca],ia.Colors.push(Object.assign(new n.a,{Color:"#"+oa.hex,Alt:r.a.Fe("#"+oa.hex),DisplayColor:"#"+oa.hex}));Array.add(ka.ControlList,ia);return ka},U=(ha,ka)=>{if(!ka)return ha;var ca=new y;ca.hex=ka;const ia=[];let oa=0;ia[oa++]=
ca;for(ca=0;ha&&ca<ha.length&&10>ca&&10>oa&&ha[ca];ca++)ha[ca].hex!==ka&&(ia[oa++]=ha[ca]);return ia},Q=(ha,ka,ca,ia,oa,sa,Ca,Ta)=>{ha=Object.assign(new k.a,{Id:ha,ControlsId:ka,DisplayMode:"Menu16",ControlList:[]});ca=Object.assign(new w.a,{Command:ca,LabelText:ia,Image16by16:D.AFrameworkApplication.Mm,Image16by16Class:Ca,Id:oa,ExternalId:sa,KeyTip:Ta});Array.add(ha.ControlList,ca);return ha},G=(ha,ka,ca,ia,oa,sa,Ca,Ta)=>{ha=Object.assign(new k.a,{Id:ha,ControlsId:ka,DisplayMode:"Menu16",ControlList:[]});
ca=Object.assign(new w.a,{Command:ca,LabelText:ia,Image16by16:D.AFrameworkApplication.Mm,Image16by16Class:Ca,Id:oa,ExternalId:sa,KeyTip:Ta});Array.add(ha.ControlList,ca);return ha},Y=(ha,ka,ca)=>{for(let da=0;da<ha.MenuSectionList.length;da++){var ia=ha.MenuSectionList[da],oa=ia.ControlList;if(oa&&0<oa.length&&(oa=oa[0]))if(ka)if(ia.Id===H.a.themeColors&&ca){var sa=E.i(ka.DE)||"";ia=ca;var Ca=oa.Colors,Ta="#";if(Ca&&Ca.length)if(r.a.Ta(sa))K.a.J(508694662,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");
else for(var R=0;R<Ca.length;R++){var Ha=Ca[R].Color;if(!r.a.Ta(Ha)&&(Ha=(Ha=C.a.parse(Ca[R].Color))?Ha.RAc():F.SchemeColor.parse(Ca[R].Color),ia&&Ha&&Ha.a2e(ia)&&Ha.Hva&&(Ha=E.i(Ha.kR),Ha.toLowerCase()===sa.toLowerCase()))){Ta=Ca[R].Color;break}}ia=Ta;oa.SelectedColorId=ia}else{Ca=E.i(E.g(ka.DE))||"";ia=oa.Colors;sa="#";if(ia&&ia.length)if(r.a.Ta(Ca))K.a.J(508694661,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ta=0;Ta<ia.length;Ta++)if(R=ia[Ta].DisplayColor,
!r.a.Ta(R)&&R.replace("#","").toLowerCase()===Ca.toLowerCase()){sa=ia[Ta].Color;break}ia=sa;oa.SelectedColorId=ia}else oa.SelectedColorId="#"}},ba=(ha,ka)=>{const ca=Array(10);ca[0]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Background1));ca[1]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Text1));ca[2]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Background2));ca[3]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Text2));ca[4]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Accent1));ca[5]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Accent2));
ca[6]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Accent3));ca[7]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Accent4));ca[8]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Accent5));ca[9]=ha.wM(m.Color.Fj(ka.PresetSchemeColorMapping.Accent6));ha=Array(10);ha[0]=ResourceStrings.l_ThemeLabel1;ha[1]=ResourceStrings.l_ThemeLabel2;ha[2]=ResourceStrings.l_ThemeLabel3;ha[3]=ResourceStrings.l_ThemeLabel4;ha[4]=ResourceStrings.l_ThemeLabel5;ha[5]=ResourceStrings.l_ThemeLabel6;ha[6]=ResourceStrings.l_ThemeLabel7;
ha[7]=ResourceStrings.l_ThemeLabel8;ha[8]=ResourceStrings.l_ThemeLabel9;ha[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:ca,XXh:ha}}},384:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.mZf="CU";k.oXi="CS";k.lXi="CE";k.bze="KP";k.R9l="TI";k.mBk="L";Object(L.a)(k,"CharacterBlockTrackerKeys",null,[])},385:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);V=d(294);var k=d(134);class e extends V.a{constructor(){super();this.timestamp=this.targetObject=null;this.H_=Object.assign(new k.a,
{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}}Object(L.a)(e,"Signal",V.a,[])},386:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(35);class e{constructor(n,r){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=n;this.Flight=r}serialize(){return k.c([this.om(),this])}}Object(L.a)(e,"ACommonHandlerRequest",null,[])},387:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.hja=
1E5;Object(L.a)(k,"ViewConstants",null,[])},388:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.$Ac="ToolbarButton";k.ITb="ToolbarButtonHome";k.insertPicture="InsertPicture";k.Yaf="SlideNavigationDesignMode";k.Xmb="Retrigger";k.refresh="Refresh";k.Nz="Typing";k.E4f="DesignElementsDeleted";k.k4d="ChangeSlideSize";k.dwb="ApplyTheme";k.Taf="SlideChangeLayout";k.ypa="NewSlide";k.e4d="ChangeIconInSmartArt";k.pxb="ChangeIcon";k.insertTable="InsertTable";k.wza="PasteTable";k.Y4c="InsertChart";
k.y0d="ApplyReplaceObject";k.moreIdeas="MoreIdeas";k.newDocument="NewDocument";k.h$d="DesignTab";k.makeItVisual="MakeItVisual";k.$La="PasteText";k.$6d="ConvertedToPPT";k.L_d="AgendaToPPT";Object(L.a)(k,"DesignerTrigger",null,[])},389:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.t4a=this.Gfa=this.AW=null;this.j8c=this.qob=!1;this.dXe=0;this.$b=null;this.zfc=this.gAg=this.yfc=!1;this.reset()}reset(){this.Gfa=[];this.AW=null;this.t4a=[];this.j8c=this.qob=!1;this.dXe=
0;this.$b=null;this.zfc=this.gAg=this.yfc=!1}}Object(L.a)(k,"HtmlPasteContext",null,[])},394:function(L,V,d){L=d(0);var k=d(55),e=d(25),n=d(46),r=d(103),w=d(1292),D=d(7),y=d(1264),m;(function(ha){ha[ha.none=0]="none";ha[ha.noSystemClipboardAccess=1]="noSystemClipboardAccess";ha[ha.cutCopyDisallowed=2]="cutCopyDisallowed";ha[ha.pasteDisallowed=3]="pasteDisallowed";ha[ha.invalidPasteContext=4]="invalidPasteContext";ha[ha.invalidCcpOperation=5]="invalidCcpOperation";ha[ha.multiSlideCcpDisallowed=6]=
"multiSlideCcpDisallowed";ha[ha.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";ha[ha.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";ha[ha.noShapesPasted=9]="noShapesPasted";ha[ha.invalidImagePasteArgs=10]="invalidImagePasteArgs";ha[ha.invalidClipboardData=11]="invalidClipboardData";ha[ha.invalidCopiedShapes=12]="invalidCopiedShapes";ha[ha.invalidCopiedSlides=13]="invalidCopiedSlides";ha[ha.invalidHtmlContent=14]="invalidHtmlContent";ha[ha.textEditFailed=15]="textEditFailed";ha[ha.clipServiceDataInvalid=
16]="clipServiceDataInvalid";ha[ha.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";ha[ha.imageTooLarge=18]="imageTooLarge";ha[ha.noAvailablePasteHandler=19]="noAvailablePasteHandler";ha[ha.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";ha[ha.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";ha[ha.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";ha[ha.copyObjectEmpty=23]="copyObjectEmpty";ha[ha.tableInvalid=24]="tableInvalid";ha[ha.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";
ha[ha.userOffline=26]="userOffline";ha[ha.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";ha[ha.picklingInvalidCopyData=28]="picklingInvalidCopyData";ha[ha.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";ha[ha.chunkUploaderFailure=30]="chunkUploaderFailure";ha[ha.pasteCancelledByUser=31]="pasteCancelledByUser";ha[ha.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(m||(m={}));Object(L.b)("CcpFailure",m);var C=d(963),E=d(113),F=d(27),B=d(338),H;(function(ha){ha[ha.none=
0]="none";ha[ha.text=1]="text";ha[ha.shape=2]="shape";ha[ha.textbox=3]="textbox";ha[ha.normalShape=4]="normalShape";ha[ha.image=5]="image";ha[ha.table=6]="table";ha[ha.chart=7]="chart";ha[ha.video=8]="video";ha[ha.list=9]="list";ha[ha.ink=10]="ink";ha[ha.addin=11]="addin";ha[ha.smartArt=12]="smartArt";ha[ha.group=13]="group";ha[ha.placeholder=14]="placeholder";ha[ha.line=15]="line";ha[ha.activeX=16]="activeX";ha[ha.oleObject=17]="oleObject";ha[ha.media=18]="media";ha[ha.slide=19]="slide";ha[ha.mixed=
20]="mixed"})(H||(H={}));Object(L.b)("ClipboardContentType",H);var K;(function(ha){ha[ha.keyboard=0]="keyboard";ha[ha.menu=1]="menu";ha[ha.floatie=2]="floatie";ha[ha.ribbon=3]="ribbon"})(K||(K={}));Object(L.b)("ClipboardMethod",K);var A;(function(ha){ha[ha.copy=0]="copy";ha[ha.cut=1]="cut";ha[ha.paste=2]="paste"})(A||(A={}));Object(L.b)("ClipboardOperation",A);var W;(function(ha){ha[ha.other=0]="other";ha[ha.pptOnline=1]="pptOnline";ha[ha.pptOnlineSameSession=2]="pptOnlineSameSession";ha[ha.pptOnlineCrossSession=
3]="pptOnlineCrossSession";ha[ha.wordOnline=4]="wordOnline";ha[ha.xlOnline=5]="xlOnline";ha[ha.oneNoteOnline=6]="oneNoteOnline";ha[ha.pptWin32=7]="pptWin32";ha[ha.wordWin32=8]="wordWin32";ha[ha.xlWin32=9]="xlWin32";ha[ha.oneNoteWin32=10]="oneNoteWin32";ha[ha.googleDocs=11]="googleDocs";ha[ha.pptDesktop=12]="pptDesktop";ha[ha.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(W||(W={}));Object(L.b)("ClipboardSource",W);class N{constructor(){this.data={};this.rRf=!1;this.Sob=null}}Object(L.a)(N,
"TelemetryEntry",null,[]);var P=d(1078),U=d(443),Q=d(41),G=d(29),Y=d(71);d.d(V,"a",function(){return ba});class ba{constructor(ha,ka,ca,ia,oa,sa,Ca,Ta,R,Ha,da,Ba){this.bNg=k.a.nx;this.pah=this.aUg=this.Wbd="";this.ES=ha;this.fS=ka;this.Ow=new Y.a;this.uba=new Y.a;ia.ASa(Object(D.a)(this,this.BVe,"onRevisionProcessedOnServer"));oa.Nka(Object(D.a)(this,this.tbm,"trackSlideCcpRevision"));sa.Nka(Object(D.a)(this,this.sbm,"trackShapeCcpRevision"));Ca.Nka(Object(D.a)(this,this.pbm,"trackParagraphCcpRevision"));
Ta.Nka(Object(D.a)(this,this.obm,"trackNotesCcpRevision"));R&&R.Nka(Object(D.a)(this,this.qbm,"trackPresentationCcpRevision"));this.uI=da;this.ia=Ha;this.ELg=ca.fBd;this.Lw=Ba;if(ha=e.AFrameworkApplication.ld)this.aUg=Object(y.a)(String,ha.Host)||"",this.pah=Object(y.a)(String,ha.Ring)||"",this.Wbd=Object(y.a)(String,ha.WACDatacenter)||""}gFb(ha){return this.Ow.Ib(ha)}fD(ha,ka){n.a.Ta(ka)||(this.gFb(ka)?ba.contentType in this.Ow.ga(ka).data&&!this.vgk(ka,ha)||this.rX(ba.contentType,H[ha],ka):F.a.J(50393377,
826,15,"attempted to update clipboard telemetry before tracking started "+ka))}Wcb(ha,ka){if(!this.Ow.Ib(ha))return null;let ca=null;if(this.Ow.ga(ha)&&!(ka in this.Ow.ga(ha).data))switch(ka){case ba.contentType:ca="none";break;case ba.source:ca="other"}return ca?ca:this.Ow.ga(ha).data[ka].toString()}t_c(ha){return this.Wcb(ha,ba.contentType)}khg(ha){return this.Wcb(ha,ba.source)}swj(ha){return this.Wcb(ha,ba.operation)}Ofc(ha){return"xlOnline"===this.khg(ha)&&"chart"===this.t_c(ha)}$8c(ha){return"slide"===
this.t_c(ha)&&"paste"===this.swj(ha)}Fdl(ha){const ka=H;for(const ia in ka){var ca=ka[ia];if(ia.toLowerCase()===ha.toLowerCase())return ca}return 0}Gdl(ha){const ka=W;for(const ia in ka){var ca=ka[ia];if(ia.toLowerCase()===ha.toLowerCase())return ca}return 0}vgk(ha,ka){ha=this.Fdl(this.Ow.ga(ha).data[ba.contentType].toString());return ka>ha}Uv(ha,ka){n.a.Ta(ka)||(this.gFb(ka)?ba.source in this.Ow.ga(ka).data&&!this.Xqk(ka,ha)||this.rX(ba.source,W[ha],ka):F.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+
ka))}Xqk(ha,ka){ha=this.Gdl(this.Ow.ga(ha).data[ba.source].toString());return ka>ha}Ei(ha,ka,ca){n.a.Ta(ca)||this.rX(ha,ka,ca)}yQ(ha,ka,ca){const ia=Q.a.Kb&&!n.a.Ta(Q.a.Kb.actionName)?Q.a.Kb.actionName:ca,oa=r.a.create().toString();this.Ow.$(oa,Object.assign(new N,{Sob:this.ES.lj("UserAction","ClipboardTelemetry")}));this.rX(ba.BVf,oa,oa);this.rX(ba.actionName,ia,oa);this.rX("ActualActionName",ca,oa);this.rX("CcpOperation",A[ha],oa);this.rX("CcpMethod",K[ka],oa);this.rX("CcpBrowser",this.bNg,oa);
this.rX("CcpHost",this.aUg,oa);this.rX("CcpDatacenter",this.Wbd,oa);this.rX("CcpRing",this.pah,oa);F.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.bNg,oa,K[ka],A[ha],ia);return oa}Xg(ha,ka,ca){ca=void 0===ca?0:ca;if(n.a.Ta(ka))F.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(n.a.Ta(ka)||!this.gFb(ka))F.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",
ka);else{var ia=this.Ow.ga(ka);this.rX("CcpTotalMs",ia.Sob.Qr.toString(),ka);this.rX(ba.CVf,ha.toString(),ka);0!==ca&&(this.rX("CcpFailureReason",m[ca],ka),this.Ofc(ka)?16===ca?this.uI.rca(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,ba.axb,!1,null):(ha=Object.assign(new U.a(!0),{$b:ka}),this.uI.rca(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,
!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,G.a.P_f,G.a.e7d,null,ha,!0,ba.axb,!1,null)):25===ca&&(F.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ka),this.uI.rca(ResourceStrings.l_DeferredContentPasteDialogTitle,ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,ba.axb,!1,null)));F.a.J(50733397,826,50,E.c(ia.data));this.Ofc(ka)||this.$8c(ka)||this.Ow.remove(ka)}}kUl(ha,ka){n.a.Ta(ka)||(this.Uv(0,ka),
this.ONh(ha,ka,0))}ONh(ha,ka,ca){if(ha){if(ca>=P.a.vQc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",P.a.vQc));if(1===ha.nodeType){for(var ia=ha.firstChild;ia;)this.ONh(ia,ka,ca+1),ia=ia.nextSibling;this.K8e(ha,ka)}}}K8e(ha,ka){const {ClipboardHelper:ca}=d(730);if(!n.a.Ta(ka))if(!this.gFb(ka))F.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ka);else if(ha)if("head"===ha.tagName.toLowerCase()){var ia=this.fS.uag(ha);n.a.Ta(ia)||this.TTl(ia,
ka)}else{ia=0;var oa=ha.getAttribute(B.a.sessionId);oa?ia=ca.jFg(oa.toString())?2:3:ha.getAttribute(C.a.k3f)?ia=5:ha.getAttribute(C.a.l3f)||ha.getAttribute(C.a.p3f)?ia=1:ha.id&&ha.id.startsWith&&ha.id.startsWith(C.a.urg)&&(ia=11);if(ha.className&&ha.className.split)for(const sa of ha.className.split(" "))if(sa.startsWith(k.a.k4b)&&sa.length===k.a.k4b.length+1&&(ha=parseInt(n.a.substring(sa,sa.length-1,sa.length)),isNaN(ha)||this.rX("CcpSourceBrowser",w.a[ha],ka)),0===ia)if(sa.startsWith(C.a.zvh))ia=
1;else if(sa.startsWith(C.a.$qh))ia=6;else if(sa.startsWith(C.a.U5h))ia=4;else if(sa===C.a.Aih||sa===C.a.Bih)ia=8,this.fD(9,ka);0!==ia&&this.Uv(ia,ka)}}TTl(ha,ka){switch(ha){case "PowerPoint.Slide":this.Uv(7,ka);break;case "Word.Document":this.Uv(8,ka);break;case "Excel.Sheet":this.Uv(9,ka);break;case "OneNote.File":this.Uv(10,ka)}}rX(ha,ka,ca){this.Ow.Ib(ca)&&(this.Ow.ga(ca).data[ha]=ka)}BVe(ha,ka){ka.tE&&!n.a.Ta(ka.tE.Id)&&this.uba.Ib(ka.tE.Id)&&this.V8f(ka.tE.Id,!ka.tE.Error,ka.tE.Error?ka.tE.Error.Code:
0)}tbm(ha,ka){this.fBc(ca=>{let ia=null;if(ca=Object(y.a)(205,ca.node))ia=ca.$b,ca.$b=null;return ia},ka)}sbm(ha,ka){this.fBc(ca=>{let ia=null;if(ca=Object(y.a)(4,ca.node))ia=ca.$b,ca.$b=null;return ia},ka)}pbm(ha,ka){this.fBc(ca=>{let ia=null;if(ca=Object(y.a)(5,ca.node))ia=ca.$b,ca.$b=null;return ia},ka)}obm(ha,ka){this.fBc(ca=>{let ia=null;if(ca=Object(y.a)(747,ca.node))ia=ca.$b,ca.$b=null;return ia},ka)}qbm(ha,ka){this.fBc(ca=>{let ia=null;if(ca=Object(y.a)(688,ca.node))ia=ca.$b,ca.$b=null;return ia},
ka)}fBc(ha,ka){ka.revisionId&&ka.node&&(ha=ha(ka),n.a.Ta(ha)||this.wUh(ka.revisionId.toString(),ha))}wUh(ha,ka){n.a.Ta(ha)||n.a.Ta(ka)||this.uba.$(ha,ka)}V8f(ha,ka,ca){if(!n.a.Ta(ha)&&this.uba.Ib(ha)){this.ELg&&"pptDesktopWithDataUpload"===this.khg(this.uba.ga(ha))&&this.Lw.pbe();var ia={};ia[ba.BVf]=this.uba.ga(ha);ia[ba.CVf]=ka;ia[ba.OUi]=ca;this.Ofc(this.uba.ga(ha))?(ia[ba.source]="xlOnline",ia[ba.contentType]="chart",0!==ca&&(ka=Object.assign(new U.a(!0),{$b:this.uba.ga(ha)}),this.uI.rca(ResourceStrings.l_CopyPasteErrorCalloutTitle,
ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,G.a.P_f,G.a.e7d,null,ka,!0,ba.axb,!1,null))):433===ca?(this.$8c(this.uba.ga(ha))&&this.ia.nb(G.a.QJ,2),this.uI.rca(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,ba.axb,!1,null)):434===ca&&(this.$8c(this.uba.ga(ha))&&(this.ELg?this.ia.nb(G.a.W9d,2):this.ia.nb(G.a.QJ,
2)),this.uI.rca(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,ba.axb,!1,null));F.a.J(50733400,826,50,E.c(ia));(this.Ofc(this.uba.ga(ha))||this.$8c(this.uba.ga(ha)))&&this.Ow.remove(this.uba.ga(ha));this.uba.remove(ha)}}cfk(ha){return!n.a.Ta(ha)&&this.Ow.Ib(ha)?this.Ow.ga(ha).rRf:!1}vpc(ha){n.a.Ta(ha)||(this.gFb(ha)?this.Ow.ga(ha).rRf=!0:F.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+
ha))}}ba.source="CcpSource";ba.contentType="CcpContentType";ba.operation="CcpOperation";ba.CVf="CcpSuccess";ba.actionName="ActionName";ba.axb=20;ba.BVf="CcpCorrelation";ba.R0i="CcpCopyIframeContent";ba.FXf="ClipServiceThrottled";ba.AVf="data-corr-id";ba.nq="CcpId";ba.OUi="ClipServiceFailureReason";Object(L.a)(ba,"ClipboardTelemetry",null,[1787])},400:function(L,V,d){L=d(0);var k=d(46),e=d(197),n=d(1273),r=d(1264),w=d(58);class D{constructor(){this.shapeType=this.PQe=this.Sgh=this.tkh=this.skh=0;this.Lq=
this.Nq=this.Vp=this.$j=!1;this.SPc=null}}Object(L.a)(D,"ShapeProperties",null,[]);var y=d(27),m=d(41),C=d(106),E=d(215);d.d(V,"a",function(){return F});class F{constructor(B,H,K,A,W,N,P,U,Q){this.ms=B;this.Vk=H;this.Ga=P;this.Tjd=N.wZl;this.vQk=this.T5i();this.Uq=K;this.iN=A;this.gf=W.Na;this.cMk=N.tBa;this.Tb=Q}Eth(B,H,K,A,W,N){N=void 0===N?null:N;if(H){var P=this.Ga.PVa(K);P&&(Array.remove(K,P),Array.add(K,this.Ga.Hs(P)));this.ATh(K);var U=K.length;P=Array(U);A=this.Plg(H,A);for(var Q=0;Q<U;Q++){var G=
K[Q],Y=this.AGj(G,A);P[Q]=Object.assign(new D,{skh:Y.x,tkh:Y.y,Sgh:G.zy,PQe:G.XD,shapeType:G.shapeType,$j:G.$j,Vp:G.Vp||2===G.mediaType||1===G.mediaType,Nq:G.vd,Lq:G.Lq,SPc:""});P[Q].$j&&(Y=Object(r.a)(178,G.sc(this.gf)),P[Q].SPc=Y?Y.lbf:"",y.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",G.Fne,this.iN.pY(G),0<P[Q].SPc.length))}Q=H.Fb;G=H.wt();Y=[];A=!0;var ba=B.Oj===H.Oj,ha=B.xo===H.xo,ka=!1;B!==H&&(ba?(ka=B.Adb||H.Adb,ha||(ka=B.sdb||H.sdb||ka),A=!ka):A=!1,!A||B.yq===H.yq&&
B.yl===H.yl||(A=!1));for(var ca=0;ca<U;ca++)this.vZl(K[ca])||(Y.push(K[ca]),A&&(A=this.qXl(K[ca],ha)));K=Y;y.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:A,["SameSlide"]:B===H,["SameMaster"]:ba,["SameLayout"]:ha,["ThemeOverrides"]:ka});U=[];ca=ka=ha=ba=Y=!1;for(let ia=0;ia<K.length;ia++){const oa=P[ia],sa=this.Vk.Z2i(Q.cid,Q.sid,oa.skh,oa.tkh,oa.Sgh,1>oa.PQe?1:oa.PQe,G+K[ia].get_zIndex(),B.id,K[ia],oa.shapeType,oa.$j,oa.SPc,A);k.a.Ta(N)||(sa.$b=N);U.push(sa);Y=Y||oa.$j;ba=ba||oa.Vp;ha=ha||oa.Nq;
ka=ka||oa.Lq;ca=ca||this.cMk&&F.Mnk(sa)}W=F.kGh(Y,ba,ha,ka,ca,W);if(0<U.length&&(B=A?K:null,this.ms.NU(U,H,W,B),A&&m.a.Kb)){if(B){H="";for(const ia of B)H+=this.Ga.Uac(ia)+",";m.a.Kb.Wa(C.a.K0i,H);m.a.Kb.Wa(C.a.VVl,B.length.toString())}m.a.Kb.tk=!0;m.a.Kb.URb=!0}}}m8i(B,H,K,A,W,N){var P=this.Plg(B,K);K=[];const U=H.Dqc,Q=!!U&&!e.a.Ta(U.yFg);N=this.zGj(N,P);for(P=0;P<H.objectCount;P++){const G=this.Vk.l2i(B.cid,B.sid,N.x,N.y,W);G.isEditable=Q&&U.yFg[P];K.push(G)}0<K.length&&this.ms.NU(K,B,A)}zGj(B,
H){const K=H*F.tU;H*=F.tU;let A=new w.a(K,H);B&&(A=this.Tb.Ama(B.clientWidth,B.clientHeight))&&(A.x+=K,A.y+=H);return A}vZl(B){return B.VA&&this.Tjd||!B.PAg}qXl(B,H){return B.Fne||this.iN.pY(B)||B.Sk&&B.hasText&&!H&&10!==B.mj&&12!==B.mj||B.$r?!1:!0}ATh(B){B.sort((H,K)=>H.get_zIndex()-K.get_zIndex())}Eok(B){return B?this.vQk.contains(B):!1}Plg(B,H){if(!B)return 0;if(!H)return F.NMi;let K,A;return H.$(K=B.Fb,(A=H.ga(K))+1),A}AGj(B,H){var K=this.Uq.presentation;if(!K)throw Error.argumentNull("Presentation is null");
let A=B.zz,W=B.Az;B=K.cNj(K.LD(B.slideId));K=Math.round(F.tU/B)*B;B=n.a.Cf(K,0);for(K=n.a.Cf(K,1);0<H;)A+=B,W+=K,H--;return new w.a(A,W)}Cdm(B){try{if(B&&B.clipboardData){const H=B.clipboardData.types;for(let K=0;K<H.length;K++){const A=B.clipboardData.getData(H[K]);if(this.rfk(A))return A}}}catch(H){}return null}rfk(B){return!!B&&0<B.length&&this.Usk(B)}Usk(B){B=B.trim().toLowerCase();return B.startsWith("http:")||B.startsWith("https:")}QQl(B,H,K){B&&(B.setAttribute(F.kTf,H.toString()),B.setAttribute(F.jTf,
K.toString()),B.setAttribute(F.lTf,"true"))}T5i(){const B=new E.a;B.add("param");B.add("map");B.add("area");B.add("script");B.add("noscript");B.add("col");B.add("colgroup");B.add("caption");B.add("head");B.add("title");B.add("link");B.add("meta");B.add("style");B.add("base");B.add("input");B.add("textarea");B.add("select");B.add("option");B.add("optgroup");B.add("button");B.add("hr");return B}aDj(B){return this.O_h(B,F.kTf)}TCj(B){return this.O_h(B,F.jTf)}$jk(B){return B?"true"===B.getAttribute(F.lTf):
!1}mdm(B){if(this.QFg(B)){const H=B.indexOf('"')+1,K=B.lastIndexOf('"');if(1<H&&K>H&&(B=B.slice(H,K),B.startsWith(F.UMi)))return B}return null}QFg(B){return!!B&&B.length>F.yNi&&B.startsWith(F.VMi)}O_h(B,H){let K=0;this.$jk(B)&&(K=parseFloat(B.getAttribute(H)));return isNaN(K)?0:K}y3d(B){return this.z3d(B).returnValue}z3d(B){let H;H=2;let K=0,A=0,W=0,N=0,P=0,U=0,Q=0,G=0,Y=0,ba=0,ha=0,ka=0,ca=0,ia=0,oa=0,sa=0,Ca=0;for(const Ta of B)Ta.vd?(H=2===H?6:20,K++):Ta.ig?(H=2===H?12:20,A++):Ta.Lq?(H=2===H?7:
20,W++):Ta.Lf?(H=2===H?13:20,N++):22===Ta.Zbc?(H=2===H?10:20,P++):Ta.$j?(H=2===H?5:20,U++):Ta.Xu?(H=2===H?3:20,Q++):Ta.z1?(H=2===H?14:20,Ta.VA&&Y++,G++):Ta.Sk?(H=2===H?14:20,Ta.VA&&ha++,ba++):Ta.dA?(H=2===H?15:20,ka++):Ta.mY?(H=2===H?16:20,ca++):Ta.Vp?(H=2===H?18:20,ia++):Ta.$r?(H=2===H?11:20,oa++):Ta.T$?(H=2===H?17:20,sa++):(H=2===H?4:20,Ca++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
B.length,K,A,W,N,P,U,Q,G,Y,ba,ha,ka,ca,ia,oa,sa,Ca),contentType:H}}static PLl(B){for(const H of B)if(!H.PAg||H.isLocal)return!1;return!0}static Mnk(B){return B&&4===B.fM?(!B.fill||!!B.fill.noFillField)&&(!B.lineStyle||!!B.lineStyle.noFillField):!1}static kGh(B,H,K,A,W,N){return B||H||K||A||W?N:0}}F.lTf="data-from-ppt-online";F.kTf="data-image-width-mu";F.jTf="data-image-height-mu";F.UMi="data:image/";F.VMi="<img src=";F.yNi=14;F.NMi=1;F.tU=15;Object(L.a)(F,"CopyPasteUtility",null,[1320])},445:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.open="open";k.refresh="refresh";k.$5e="saveAs";k.translate="translate";k.modeSwitch="modeSwitch";k.Q4i="createNew";k.convert="convert";Object(L.a)(k,"ReasonList",null,[])},446:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(L.a)(k,"Lambda",null,[1205])},447:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.ezc="SlideTextTile";k.u9e=
"ShapeTextTile";Object(L.a)(k,"AugmentationSchemas",null,[])},448:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{static qb(){}static V2(e,n,r,w,D){return 1===r?32:k.onl(e,D)?32:8}static jI(e,n,r,w,D){return 1===r?32:k.T0k(e,D)?32:8}static T0k(e,n){const r=k.bci[e.toString()];if(void 0===r||null===r)return!1;r(e,n);return!0}static onl(e,n){const r=k.fci[e.toString()];if(void 0===r||null===r)return!1;r(e,n);return!0}}k.bci={};k.fci={};Object(L.a)(k,"DialogCuiControlActor",null,[])},
449:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.description=this.title=this.nR=this.T2=null}}Object(L.a)(k,"CpContentDetails",null,[1084])},450:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(103);class e{constructor(){this.oNf=!1;this.sessionId=this.IXf=null;this.N$a=e.Tsj()}static Tsj(){return"CID"+k.a.create().toString()}static wzg(n){return n&&n.length?n.startsWith("CID")&&k.a.isValid(n.substring(3,n.length))?!0:!1:!1}}Object(L.a)(e,"InternalClipboardObject",
null,[])},451:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(450);class k extends d.a{constructor(e){super();this.gd=e}get NDg(){return!this.gd||!this.gd.isConnected}get id(){return this.gd.id}get isConnected(){return this.gd.isConnected}}Object(L.a)(k,"InternalClipboardSlide",d.a,[])},452:function(L,V,d){d.d(V,"a",function(){return e});var k=d(111);const e=(n,r,w)=>{const D=new k.StandardDialog;D.Fd=0;D.vQ(n,r,w);return D}},453:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}
Object(L.a)(k,"SmartLookupSelection",null,[])},462:function(L,V,d){L=d(0);var k=d(395),e=d(7),n=d(25),r=d(193),w=d(78),D=d(67),y=d(183),m=d(88),C=d(165);d(65);class E{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(L.a)(E,"MessageBarProps",null,[]);class F{constructor(U,Q){this.onExecute=
this.label=this.type=null;this.label=U;this.type="AppButtonProps";this.onExecute=Q}}Object(L.a)(F,"AppButtonProps",null,[]);var B=d(144),H=d(808),K=d(142),A=d(202),W=d(103),N=d(36);d.d(V,"a",function(){return P});class P{constructor(U,Q,G){this._message=this.qD=null;this.FOd=this.prb=!1;this.oId=0;this.Lja="";this.NT=0;this.iG=this.zT=this.Xra=this.Q8=this.w7a=this.QVb=this.PVb=this.OVb=this.NVb=this.vO=this.v8=this.hta=this.AQa=null;this.grb=this.frb=!1;this.Fof=this.HId="";this.FId=!1;this.Gof=
this.LId="";this.JId=!1;this.KId=this.GId=null;this.CZb=!1;this.Nyf=this.$sb="";this.v7a=null;this.IYb=this.yvf=!1;this.QEa=this.xU=this.Hfa=this.OQ=this.businessBar=null;this.errorCode=0;this.sNf=this.visible=!1;this.JSf=Y=>{this.GId(Y.CE);this.GY("ButtonOne",N.a.DSf,"Mouse",2);this.FId&&(this.GY("Close",N.a.Lwb,"Mouse_ButtonOne",2),this.close(Y));return!0};this.KSf=Y=>{this.KId(Y.CE);this.GY("ButtonTwo",N.a.ESf,"Mouse",2);this.JId&&(this.GY("Close",N.a.Lwb,"Mouse_ButtonTwo",2),this.close(Y));return!0};
this.JIg=Y=>{this.v7a(Y.CE);this.GY("Link",N.a.HSf,"Mouse",2);return!0};this.b7k=()=>{this.v7a(null)};this.Lnh=Y=>Y.hc.keyCode!==y.a.Mp||Y.hc.altKey?!1:(this.v7a(Y.CE),this.GY("Link",N.a.HSf,"Keyboard",1),!0);this.HTe=Y=>Y.hc.keyCode===y.a.Mp&&!Y.hc.altKey&&this.jeb?(this.jeb(Y.CE,Y),this.GY("Invoke",N.a.GSf,"Keyboard",1),!0):!1;this.title=U;this.message=Q;this.jeb=G;this.id=0;this.image=1;this.jfc=!0;this.IQf=5}get htmlElement(){return this.OQ}get jfc(){return this.FOd}set jfc(U){this.FOd=U}get IQf(){return this.oId}set IQf(U){this.oId=
U}get title(){return this.qD}set title(U){this.qD!==U&&(this.qD=U,this.hta&&(this.hta.innerText=this.qD))}get message(){return this._message}set message(U){this._message!==U&&(this._message=U,this.v8&&(this.v8.innerText=this._message))}get image(){return this.NT}set image(U){this.NT=U;4!==this.NT&&(this.Hfa="")}get cHa(){return this.Lja}set cHa(U){this.Lja=U}get closeable(){return this.prb}set closeable(U){this.prb!==U&&(this.prb=U,this.Xra&&(this.Xra.style.display=this.prb?"table-cell":"none"))}get cvc(){return n.AFrameworkApplication.fa.getBooleanAppSetting("ReactBusinessBarIsEnabled")}get Emm(){return n.AFrameworkApplication.fa.getBooleanAppSetting("Fluent2StyleIsEnabled")}addButton(U,
Q,G,Y){this.HId=U;this.GId=Q;this.frb=!0;this.Fof=G;this.FId=void 0===Y?!1:Y}sZd(U,Q){this.LId=U;this.KId=Q;this.grb=!0;this.Gof="";this.JId=!1}hZd(U,Q){this.$sb=U;this.v7a=Q;this.CZb=!0}V5i(){var U=A.a.YX(n.AFrameworkApplication.fa.Ea("VNextStyleOptOutCookieName"),!1);U=this.Emm&&!U;this.OQ=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",P.Eof,P.hmi,U?P.ori:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.QEa&&null!==this.QEa&&(this.htmlElement.id=
this.QEa);U=()=>{B.UISurfaces.uFj().then(Q=>{this.businessBar.exe||(Q.initializeMessageBarInStore(),this.businessBar.exe=!0);const G=Object.assign(new E,{message:this._message,messageTitle:this.qD,isMultiline:this.FOd,messageBarType:this.oId});if(this.prb){G.closeable=!0;let Y=this._message+". "+CommonUIStrings.l_DialogClose;this.qD&&(Y=this.qD+". "+Y);G.dismissButtonAriaLabel=Y;G.onDismiss=()=>{this.s5d(this)}}4===this.NT&&(G.messageBarIconProps={["iconName"]:this.Hfa});this.CZb&&(G.linkProps={["type"]:"AppLinkProps",
["text"]:this.$sb,["handler"]:{["href"]:this.Nyf,["target"]:"_blank"}},this.v7a&&(G.linkProps.handler=this.b7k));this.frb&&(G.firstActionButtonProps=new F(this.HId,()=>{this.bMi(this)}));this.grb&&(G.secondActionButtonProps=new F(this.LId,()=>{this.dMi(this)}));Q.createNewMessageBarWithCallback?Q.createNewMessageBarWithCallback(this.htmlElement,G,()=>{n.AFrameworkApplication.za.qv()}):Q.createNewMessageBar(this.htmlElement,G);return null}).catch(()=>{k.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");
return null})};r.a.get_instance().isCompleted(7)?U():r.a.get_instance().Ij(7,U);this.jeb&&(n.AFrameworkApplication.za.Mz.xb(D.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),n.AFrameworkApplication.za.uH.gW(D.a.rm,this.htmlElement,this.HTe,this),this.yvf&&!this.IYb&&(n.AFrameworkApplication.za.Bca.xb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.IYb=!0));return this.htmlElement}createElement(){if(this.cvc)return this.V5i();this.OQ=document.createElement("div");
this.htmlElement.className=P.Eof;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.QEa&&null!==this.QEa&&(this.htmlElement.id=this.QEa);this.AQa=null;if(0!==this.NT){this.AQa=document.createElement("span");this.AQa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.AQa);var U=null;let Q=null;switch(this.NT){case 2:U=P.Qdi;Q=CommonUIStrings.l_DialogError;break;case 1:U=P.Bri;Q=CommonUIStrings.l_DialogWarning;break;case 3:U=P.Xfi;Q=CommonUIStrings.l_DialogInfo;break;case 4:U=
this.Hfa,Q=this.Lja}this.AQa.title=Q;this.AQa.setAttribute(K.a.Ff,K.a.EPf);this.AQa.appendChild(w.createClusteredImage(24,24,U,P.Nfi,!0,""))}U=W.a.create().toString();this.vO=document.createElement("div");this.vO.id="BBTitleAndBody"+U;this.vO.className=P.Pai;this.vO.tabIndex=0;this.qD&&(this.hta=document.createElement("p"),this.hta.innerText=this.qD,this.hta.className=P.Qai+" UIFontBold",this.hta.id="BBTitle"+U,this.hta.setAttribute("UNSELECTABLE","on"),this.vO.setAttribute(K.a.E4,this.hta.id),this.vO.appendChild(this.hta));
this.v8=document.createElement("p");this.v8.className=P.Kai;this.v8.innerText=this._message;this.v8.id="BBBody"+U;this.v8.setAttribute("UNSELECTABLE","on");this.v8.style.width="100%";this.vO.setAttribute(K.a.iea,this.v8.id);this.frb&&this.HJf(this.v8,this.Fof);this.grb&&this.HJf(this.v8,this.Gof);this.vO.appendChild(this.v8);U=document.createElement("div");U.setAttribute(K.a.Ff,K.a.c1d);U.appendChild(this.vO);this.htmlElement.appendChild(U);this.frb&&(this.OVb=document.createElement("span"),this.NVb=
document.createElement("button"),this.v0f(this.OVb,this.NVb,this.HId,this.JSf));this.grb&&(this.QVb=document.createElement("span"),this.PVb=document.createElement("button"),this.v0f(this.QVb,this.PVb,this.LId,this.KSf));this.CZb&&(this.w7a=document.createElement("span"),this.w7a.className=P.Oai,this.Q8=document.createElement("a"),this.Q8.className=H.a.Nai,this.Q8.innerText=this.$sb,this.v7a?(this.Q8.tabIndex=0,n.AFrameworkApplication.za.Mz.gW(D.a.click,this.Q8,this.JIg,this),n.AFrameworkApplication.za.uH.gW(D.a.rm,
this.Q8,this.Lnh,this)):(this.Q8.href=this.Nyf,this.Q8.target="_blank"),this.w7a.appendChild(this.Q8),this.htmlElement.appendChild(this.w7a));n.AFrameworkApplication.za.Mz.xb(D.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));n.AFrameworkApplication.za.uH.gW(D.a.rm,this.vO,this.HTe,this);this.yvf&&!this.IYb&&(n.AFrameworkApplication.za.Bca.xb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.IYb=!0);this.prb&&(this.Xra=document.createElement("span"),this.Xra.className=
P.ubi,this.zT=document.createElement("a"),this.zT.className=P.vbi,this.zT.tabIndex=0,this.zT.title=CommonUIStrings.l_DialogClose,this.zT.setAttribute(K.a.Ff,K.a.jx),this.iG=w.createClusteredImage(16,16,P.wbi,"",!0,""),this.zT.appendChild(this.iG),this.Xra.style.display="table-cell",this.Xra.appendChild(this.zT),this.htmlElement.appendChild(this.Xra),n.AFrameworkApplication.za.Mz.gW(D.a.click,this.zT,Object(e.a)(this,this.Plh,"onCloseClick"),this),n.AFrameworkApplication.za.uH.gW(D.a.rm,this.zT,Object(e.a)(this,
this.Qlh,"onCloseKeyUp"),this));return this.htmlElement}U_l(){this.vO&&this.vO.setAttribute(K.a.JJ,K.a.Xka)}HJf(U,Q){if(Q&&""!==Q){var G=document.createElement("span");G.className=P.nni;G.innerText=Q;U.appendChild(G)}}v0f(U,Q,G,Y){U.className=P.Mai;Q.setAttribute("type","button");Q.className=P.Lai;Q.innerText=G;U.appendChild(Q);this.htmlElement.appendChild(U);n.AFrameworkApplication.za.Mz.gW(D.a.click,Q,Y,this)}FGh(){this.cvc||(this.vO.style.whiteSpace="nowrap",this.closeable?this.Xra.style.width=
"auto":this.CZb?this.w7a.style.width="auto":this.grb?this.QVb.style.width="auto":this.frb?this.OVb.style.width="auto":this.vO.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.vO.style.whiteSpace="normal":this.closeable?this.Xra.style.width="100%":this.CZb?this.w7a.style.width="100%":this.grb?this.QVb.style.width="100%":this.frb?this.OVb.style.width="100%":this.vO.style.width="100%")}Fgf(U,Q){if(C.a.WLb()){var G={};G.WacSessionId=n.AFrameworkApplication.userSessionId;
G.ActionName="BusinessBar"+U;G.InputMethod=Q;k.ULS.sendTraceTag(35489761,207,50,JSON.stringify(G))}}GY(U,Q,G,Y){this.Fgf(U,G);C.a.tYa()&&m.c(Q,!0,m.e,Y,10)}bMi(U){this.GId(U);this.GY("ButtonOne",N.a.DSf,"Mouse",2);this.FId&&(this.GY("Close",N.a.Lwb,"Mouse_ButtonOne",2),this.s5d(U))}dMi(U){this.KId(U);this.GY("ButtonTwo",N.a.ESf,"Mouse",2);this.JId&&(this.GY("Close",N.a.Lwb,"Mouse_ButtonTwo",2),this.s5d(U))}dispose(){this.htmlElement&&(n.AFrameworkApplication.za.Mz.Hb(D.a.click,this.htmlElement,Object(e.a)(this,
this.onClick,"onClick")),this.IYb&&n.AFrameworkApplication.za.Bca.Hb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick")));this.zT&&(n.AFrameworkApplication.za.Mz.Hb(D.a.click,this.zT,Object(e.a)(this,this.Plh,"onCloseClick")),n.AFrameworkApplication.za.uH.Hb(D.a.rm,this.zT,Object(e.a)(this,this.Qlh,"onCloseKeyUp")));this.NVb&&n.AFrameworkApplication.za.Mz.Hb(D.a.click,this.NVb,this.JSf);this.PVb&&n.AFrameworkApplication.za.Mz.Hb(D.a.click,this.PVb,this.KSf);this.Q8&&this.v7a&&(n.AFrameworkApplication.za.Mz.Hb(D.a.click,
this.Q8,this.JIg),n.AFrameworkApplication.za.uH.Hb(D.a.rm,this.Q8,this.Lnh));this.vO&&n.AFrameworkApplication.za.uH.Hb(D.a.rm,this.vO,this.HTe);this.businessBar=this.zT=this.Xra=this.iG=this.w7a=this.Q8=this.QVb=this.PVb=this.OVb=this.NVb=this.vO=this.v8=this.OQ=this.hta=this.AQa=this.Lja=null}onClick(U){this.GY("Invoke",N.a.GSf,"Mouse",2);return!!this.jeb&&this.jeb(this,U)}Plh(U){this.GY("Close",N.a.Lwb,"Mouse",2);this.close(U);return!0}Qlh(U){return U.hc.keyCode!==y.a.Mp||U.hc.altKey?!1:(this.GY("Close",
N.a.Lwb,"Keyboard",1),this.close(U),!0)}close(U){const Q=U.CE;this.businessBar.removeEntry(Q);this.izg(Q,U.wg)}izg(U,Q){if(U.xU){const G=n.AFrameworkApplication.Pa;G.oq=10;G.eV=Q;U.xU(U);G.oq=0;G.eV=0}}s5d(U){U&&this.businessBar&&(this.businessBar.removeEntry(U),this.izg(U,0))}}P.Eof="WACBusinessBarEntry";P.Qai="WACBusinessBarTitle";P.Kai="WACBusinessBarBody";P.Pai="WACBusinessBarTitleBodyHolder";P.Mai="WACBusinessBarButtonHolder";P.Lai="WACBusinessBarButton";P.Oai="WACBusinessBarLinkHolder";P.vbi=
"WACBusinessBarClose";P.ubi="WACBusinessBarCloseHolder";P.wbi="BusinessBarClose_16x16x32";P.Nfi="WACBusinessBarImage";P.nni="WACScreenReaderOnly";P.Qdi="CancelRequest_24x24x32";P.Bri="Risks_24x24x32";P.Xfi="Info_24x24x32";P.hmi="ReactBusinessBarEntry";P.ori="VNextBusinessBarEntry";Object(L.a)(P,"BusinessBarEntry",null,[517,106])},526:function(L,V,d){d.d(V,"a",function(){return r});L=d(0);var k=d(64),e=d(527),n=d(938);class r{U5b(w,D){if(1===w.nodeType&&D){var y=this.ZX(D);w=this.Bcg(w,y);this.iWi(y,
w,D)}}Bcg(w,D){const {CombineHelper:y}=d(1209),m=[];let C=null;for(let F=0;F<w.childNodes.length;F++){var E=w.childNodes[F];3===E.nodeType?(C||(C=new y(w,F,D)),C.Fwi(F)):(C&&(C.end(m,F-1),C=null),E=this.Bcg(E,D),Array.addRange(m,E))}C&&C.end(m,w.childNodes.length-1);return m}iWi(w,D,y){w=w.clone();let m=!1;for(let C=D.length-1;0<=C;C--){const E=D[C].hWi();m=w.merge(E)||m}m&&this.setSelection(w,y)}setSelection(w,D){D=k.a.oGa(D);D.setStart(w.start.element,w.start.offset);D.setEnd(w.end.element,w.end.offset)}ZX(w){return(w=
k.a.oGa(w))?Object.assign(new n.a,{start:Object.assign(new e.a,{element:w.startContainer,offset:w.startOffset}),end:Object.assign(new e.a,{element:w.endContainer,offset:w.endOffset})}):new n.a}}r.unused=-1;Object(L.a)(r,"TextNodeCombiner",null,[532])},527:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new k,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===
e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(L.a)(k,"SelectionSide",null,[])},528:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);V=d(294);var k=d(134);class e extends V.a{constructor(){super();this.items=this.parentRevId=this.parentPath=null;this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}}Object(L.a)(e,"Operation",V.a,[])},529:function(L,V,d){d.d(V,
"a",function(){return e});L=d(0);V=d(528);var k=d(134);class e extends V.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(L.a)(e,"UpdateOperation",V.a,[])},530:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=
3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(k||(k={}));Object(L.b)("AppMode",k)},531:function(L,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return n});d.d(V,"c",function(){return r});const k=w=>{switch(w){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=w=>k(r(w.Priority,w.Tag)),n=w=>r(w.Priority,w.Tag),r=(w,D)=>{switch(w){case 0:return 1;case 1:return 2;case 2:return D&1?5:3;case 3:return 4;default:return 0}}},532:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(L.a)(k,"ProofingTraceMetrics",null,[])},533:function(L,V,d){d.d(V,"a",function(){return n});d.d(V,"b",function(){return r});d.d(V,"c",function(){return w});var k=d(25),e=d(534);const n=()=>{const D=k.AFrameworkApplication.za.mb.Ej;return(3===D||1===D||2===D||4===D)&&k.AFrameworkApplication.fa.getBooleanAppSetting("PremiumUpsellIsEnabled")},r=(D,y,m,C)=>{y=1===y;
1===D&&(y=2===k.AFrameworkApplication.za.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[D],y?"Editor":"Viewer",(void 0===C?0:C)?"Dime":"Unknown",m?m:"dimedefault")},w=D=>{switch(D){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},534:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=
2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.Rnm=5]="visio"})(k||(k={}));Object(L.b)("OfficeAppType",k)},535:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.nQf="AugEditorServiceTileCheckRequest";k.t1d="AugEditorServiceTileCheckResponse";k.yfj="EditorServiceTileCheckRequest";k.YXf="Proofing.ProofingRequest";k.cSc="Proofing.ProofingResponse";Object(L.a)(k,"ProofingAugmentationSchemaNames",null,[])},536:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.slideId=
null;this.swh=this.dzc=0}}Object(L.a)(k,"SlidePresenceInfo",null,[])},537:function(L,V,d){d.d(V,"a",function(){return r});L=d(0);var k=d(395),e=d(1104),n=d(35);class r{execute(w,D,y){y=void 0===y?null:y;k.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",w.om());const m=new e.a,C=this.Y9(w,D,y);C.continueWith(()=>{if(C.Pm)m.wH(C.Ni);else if(C.Ao)m.A3();else{const E=C.result;if(E&&!E.succeeded&&E.Hj&&E.Hj.data&&5===C.result.Hj.data.status){const F=this.Y9(w,D,y);F.continueWith(()=>{F.Pm?m.wH(F.Ni):F.Ao?
m.A3():m.sL(F.result)})}else m.sL(E)}});return m.task}Y9(w,D,y){y=this.OLj(y);return D(y,{"Content-Type":"application/json; charset=utf-8"},w.serialize())}OLj(w){return w?String.format("{0}/{1}",w,"people.ashx"):"people.ashx"}static Pyb(w){if(!w)return k.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return n.a(w)}catch(D){k.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",D.message)}return null}}Object(L.a)(r,"CommonHandlerRequestManager",
null,[])},538:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(395);class e{equals(n,r){if(!n||!r)return!n&&!r;if(n.UserId!==r.UserId){if(!e.R6f(n.Provider)||!e.R6f(r.Provider))return!1;const D=n.UserId.startsWith(e.B2b);var w=r.UserId.startsWith(e.B2b);if(D&&w){if(n.Provider!==r.Provider)return k.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",n.Provider,r.Provider),!1;w=e.mag(n.UserId);r=e.mag(r.UserId);return!!w&&w===r}n=
n.Email&&""!==n.Email?n.Email:D?e.nbb(n.UserId):n.UserId;r=r.Email&&""!==r.Email?r.Email:w?e.nbb(r.UserId):r.UserId;return!!n&&n===r}return n.Provider!==r.Provider?!1:n.Provider&&""!==n.Provider||n.UserId&&""!==n.UserId?!0:n.DisplayName===r.DisplayName}bY(){return 0}static R6f(n){return"O365"===n||"AD"===n}static nbb(n){if(!n.startsWith(e.B2b))return null;n=n.substr(e.B2b.length);const r=n.lastIndexOf("::");return-1===r?null:n.substr(0,r)}static mag(n){if(!n.startsWith(e.B2b))return null;var r=n.lastIndexOf("::");
if(-1===r)return null;r+=2;return r>=n.length?null:n.substr(r)}}e.B2b="S::";Object(L.a)(e,"CommentTaskPersonIdentityComparer",null,[355])},539:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(L.a)(k,"CrossDocumentMessage",null,[])},540:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(L.a)(k,"OtelTelemetryEvent",
null,[])},541:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.type=null;this.type=e}}Object(L.a)(k,"CustomContentProps",null,[])},542:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=e;this.commandId=n}}Object(L.a)(k,"CommandMetadata",
null,[])},543:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(301);class k{}k.CommandValueId="CommandValueId";k.Description="Description";k.Image16by16Class=d.a.PCb;k.Image30by30Class=d.a.P6j;k.Image32by32Class=d.a.bHa;k.Image48by48Class=d.a.Toe;k.On="On";k.LabelText=d.a.labelText;k.Visible=d.a.visible;k.SourceControlId="SourceControlId";k.DisplayMode="DisplayMode";k.Alt=d.a.alt;Object(L.a)(k,"ToggleButtonCommandProperties",null,[])},544:function(L,V,d){d.d(V,"a",function(){return k});
L=d(0);class k{}k.Gv="InputMethod";k.pca="ShouldCanvasTakeFocus";k.tEd="UILocation";Object(L.a)(k,"ReactRibbonConstants",null,[])},545:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{static get instance(){const {NewCustomEventFactory:e}=d(1169),{IECustomEventFactory:n}=d(1170);k.Ja||(k.Ja="function"===typeof window.CustomEvent?new e:new n);return k.Ja}}k.Ja=null;Object(L.a)(k,"CustomEventFactory",null,[])},546:function(L,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return r});
var k=d(9);d(1104);const e=D=>n(D),n=D=>new Promise((y,m)=>{D.continueWith(C=>{C.Pm?m(C.Ni.message):C.Ao?m(k.a.vTc()):y(null)})}),r=D=>w(D),w=D=>new Promise((y,m)=>{D.continueWith(()=>{D.Pm?m(D.Ni.message):D.Ao?m(k.a.vTc()):y(D.result)})})},547:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.W3a=e}}Object(L.a)(k,"SlidesChangedArgs",Sys.EventArgs,[])},548:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.themeColors="Theme Colors";
Object(L.a)(k,"ReactColorConstants",null,[])},549:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.other=0]="other";e[e.sDm=1]="searchBoxSearch";e[e.nDm=2]="searchBoxDictionary";e[e.rDm=3]="searchBoxQuickAnswer";e[e.YDm=4]="smartLookupRibbon";e[e.E3l=5]="smartLookupContextMenu";e[e.entity=6]="entity";e[e.jum=7]="dictionary";e[e.VEm=8]="web";e[e.fCm=9]="pictures";e[e.files=10]="files";e[e.bookmarks=11]="bookmarks";e[e.Dfa=12]="help";e[e.ttm=13]="chartRecommendation";e[e.Svm=
14]="linkSkill";e[e.pDm=15]="searchBoxFindInDocument";e[e.oDm=16]="searchBoxEntity";e[e.uDm=17]="searchSkill";e[e.Rtm=18]="controlF";e[e.cDm=19]="ribbonFindButton";e[e.ZCm=20]="reuseSlides";e[e.data=21]="data";e[e.Ktm=22]="contextMenuDictionary";e[e.Ntm=23]="contextMenuSearchSuggestion";e[e.Qtm=24]="contextMenuSynonyms";e[e.Mtm=25]="contextMenuSearchBoxSearch";e[e.tDm=26]="searchBoxSearchZeroTerm";e[e.Otm=27]="contextMenuSearchZeroTerm";e[e.ABm=28]="note";e[e.XDm=29]="smartLookupAutoLaunch";e[e.Ptm=
30]="contextMenuSmartLookupInSubMenu";e[e.aum=31]="dataDisambiguate";e[e.Rvm=32]="linkFiles";e[e.qDm=33]="searchBoxNoteL2";e[e.Ltm=34]="contextMenuLaunchL2Document";e[e.Ksm=35]="actionAI";e[e.$Bm=36]="pasteAsNewSlide";e[e.WDm=37]="slidesCompression";e[e.bLl=38]="searchBoxGenerateDeck";e[e.Zhl=39]="powerPointCopilot";e[e.nEm=40]="tellMeService";e[e.kCm=99]="prefetch"})(k||(k={}));Object(L.b)("EntryPoint",k)},556:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(1285),n=d(690),r;(function(Ba){Ba[Ba.external=
0]="external";Ba[Ba.awm=1]="msa";Ba[Ba.Ism=2]="aad"})(r||(r={}));Object(L.b)("AuthorityType",r);var w=d(337);class D{constructor(Ba){this.vji=Ba}initialize(){return Promise.resolve(0)}y$c(){return Promise.resolve(0)}vH(){k.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new w.a,{IsSuccess:!0,Token:this.vji}))}cEd(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}$Bd(){return!1}qbc(){return"MockAuthTokenStrategy"}}
Object(L.a)(D,"MockAuthTokenStrategy",null,[826]);var y=d(744);class m{static get(Ba,za,Aa){if(!Aa)return Ba;let na=0;return Promise.race([Ba,new Promise(la=>{na=window.setTimeout(()=>{la(za)},Aa)})]).then(la=>{window.clearTimeout(na);return Promise.resolve(la)}).catch(()=>{window.clearTimeout(na);return Promise.resolve(za)})}}Object(L.a)(m,"PromiseWithTimeout",null,[]);var C=d(25),E=d(245);class F{constructor(Ba,za,Aa,na,la){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=Ba;this.scope=za;this.silentLogin=Aa;this.options=na;this.correlationId=la}}Object(L.a)(F,"TokenRequestParameters",null,[920]);var B=d(55),H=d(54);class K{constructor(){this.tIf=null;let Ba=C.AFrameworkApplication.fa.Ea(C.AFrameworkApplication.uL),za=C.AFrameworkApplication.fa.Ea(C.AFrameworkApplication.D0h);this.zub=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Ba&&""!==Ba?Ba:"Unspecified",za&&""!==za?za:"Unspecified")}initialize(){return new Promise(Ba=>
{H.a.instance.Ha("Common.App.WopiIdentity.IWopiIdentity").execute(za=>{this.tIf=za;Ba(0)})})}Kc(Ba){const za=["HTTPS:","API:"];let Aa=!1;const na=Ba.toLocaleUpperCase();for(const la of za)if(na.startsWith(la)){Aa=!0;break}return Aa||this.Cjk(Ba)?Ba+"/.default":Ba}Cjk(Ba){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Ba)}y$c(){return Promise.resolve(0)}vH(Ba,za,Aa,na,la,va,Pa){if(B.a.gIa){la=E.a.com;if(!la)return za=Object.assign(new w.a,{IsSuccess:!1,
ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(za);if(!Array.contains(la,Ba))return za=Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Ba}),Promise.resolve(za)}Ba=this.Kc(Aa);Aa=new F(Aa,Ba,!na,null,C.AFrameworkApplication.userSessionId);return this.tIf.getAccessToken(Aa,za,Pa).then(Qa=>Object.assign(new w.a,{IsSuccess:!0,Token:Qa.accessToken}),Qa=>Object.assign(new w.a,{IsSuccess:!1,ErrorCode:Qa}))}cEd(){return Promise.resolve(Object.assign(new w.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}$Bd(){return!1}qbc(){return this.zub}}Object(L.a)(K,"ParentFrameTokenStrategy",null,[826]);var A=d(462),W=d(18);class N{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Kxh=this.LQf=null}}Object(L.a)(N,"PromiseWrapper",null,[]);class P{constructor(Ba){Ba=void 0===Ba?0:Ba;this.nO=0;this.P_b=!1;this.Av=new W.a;this._timeout=
Ba}enqueue(Ba){return new Promise((za,Aa)=>{this.Av.add(Object.assign(new N,{Kxh:Ba,resolve:za,reject:Aa}));this.process()})}process(){if(this.P_b||this.nO===this.Av.count)return!1;const Ba=this.Av.ga(this.nO++);try{this.P_b=!0,Ba.Kxh().then(za=>{this.P_b=!1;this.d6d(Ba,za,null,!0)}).catch(za=>{this.P_b=!1;this.d6d(Ba,null,za,!1)})}catch(za){this.P_b=!1,this.d6d(Ba,null,za,!1)}return!0}d6d(Ba,za,Aa,na){if(na){const la=()=>{Ba.resolve(za);this.process()};0<this._timeout?window.setTimeout(()=>{la()},
this._timeout):la()}else{const la=()=>{Ba.reject(Aa);this.process()};0<this._timeout?window.setTimeout(()=>{la()},this._timeout):la()}}}Object(L.a)(P,"PromiseQueue",null,[]);class U{constructor(){this.correlationId=this.resolve=null}}Object(L.a)(U,"ResolveWithCorrelation",null,[]);var Q=d(1264),G=d(83),Y=d(539),ba=d(127);class ha extends G.a{constructor(Ba,za,Aa,na,la,va){super(!1,!1,!0);this.Xqf=this.uja=null;this.Y9k=()=>{this.jeg()};this.v3i=()=>this.WB;this.wWl=Pa=>{0===Pa&&(this.xqi.reject(Object.assign(new w.a,
{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.d7a(null))};this.Nda=Ba;this.Eli=Aa;this.jG=na;this.xqi=la;this.d7a=va;this.WB=document.createElement("iframe");this.WB.id="SharedAuthInteractiveFrame";this.WB.setAttribute("name","SharedAuthInteractiveFrame");this.WB.setAttribute("title","SharedAuthInteractiveFrame");this.WB.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.WB.style.border="0";this.WB.style.height=
"48px";this.WB.style.width="190px";$addHandler(this.WB,"error",this.Y9k);Ba=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Nda,za,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",C.AFrameworkApplication.userType);this.WB.src=Ba;this.Uci=new Promise(Pa=>{this.Xqf=Pa});this.Yqf=!1}zia(){this.uja={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.Eli,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:C.AFrameworkApplication.isRtl,
["frameLoaded"]:!1,["createFrame"]:this.v3i,["resolveDialogStyles"]:this.Xqf}};this.Fd=5;this.Vj(CommonUIStrings.l_SignIn,this.wWl,this.uja)}p3h(Ba,za){var Aa=!0;Aa=void 0===Aa?!1:Aa;Ba=void 0===Ba?!1:Ba;za=void 0===za?5:za;this.uja&&this.uja.bodyControls&&(Aa!==Object(Q.a)(Object,this.uja.bodyControls).frameLoaded&&(Object(Q.a)(Object,this.uja.bodyControls).frameLoaded=Aa),Ba!==Object(Q.a)(Object,this.uja.bodyControls).frameLoadSuccess&&(Object(Q.a)(Object,this.uja.bodyControls).frameLoadSuccess=
Ba),za!==this.uja.dialogButtonsOption&&(this.uja.dialogButtonsOption=null,this.Fd=za),this.update(this.uja))}D1l(Ba,za){const Aa=new Y.a(ba.a.AWl);Aa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:C.AFrameworkApplication.isRtl,["messageCorrelationId"]:Ba,["dialogStyles"]:za};this.jG.vnb(Aa,this.WB.contentWindow,this.Nda)}jeg(){this.p3h(!1,6)}get VOh(){return this.WB}get Abj(){return this.Uci.then(Ba=>{this.Yqf=!0;return Ba})}get Bbj(){return this.Yqf}}
Object(L.a)(ha,"SharedAuthConsentDialog",G.a,[922]);var ka=d(681),ca=d(97),ia=d(214),oa=d(64),sa=d(103),Ca=d(89);class Ta{constructor(){this.WB=null;this.OGc=0;this.ftb=this.Uub=this.eId=this.d7a=this.l0=this.qHf=null;this.j6k=()=>{const Ba=oa.a.jj()-this.OGc;k.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Ba)};this.LUe=Ba=>{const {OAuthManager:za}=d(556),Aa=oa.a.jj()-this.OGc,na=Object.assign(new Ca.a,{durationMs:Aa});ca.Health.instance.recordKpiFailure(za.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,na);k.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Aa,this.$rf?JSON.stringify(Ba):"")};this.t9k=Ba=>{const {OAuthManager:za}=d(556),Aa=this.ARa.loadFrame;var na=oa.a.jj()-Aa.startTime,la=Ba.Values.AuthLibrary.toString();Ba=Ba.Values.Success.toString();k.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Ba,la,na);la&&(this.zub="SharedAuthTokenStrategy "+
la);la=Boolean.parse(Ba);la||(Ba=ia.a.Yz(),void 0!==Ba&&null!==Ba&&(Ba.set("AuthLibrary",this.qbc()),na=Object.assign(new Ca.a,{durationMs:na,extendedProperties:Ba}),ca.Health.instance.recordKpiFailure(za.kpiName,"SharedAuthStrategyInitFailed",!1,!0,na)));Aa.resolve(la?0:1)};this.s9k=Ba=>{if(Ba.Values.interactive&&this.Uub&&this.Uub.Values.messageCorrelationId){const Aa=this.Uub.Values.messageCorrelationId.toString();if(Ba.Values.interactive&&this.l0){this.l0.Abj.then(na=>{this.jG.vnb(this.Uub,this.l0.VOh.contentWindow,
this.Nda);this.l0.D1l(Aa,na);this.l0.p3h(!0);this.Uub=null});return}}Ba=this.ARa.initFrame;const za=oa.a.jj()-Ba.startTime;k.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",za);Ba.resolve(0)};this.R5k=Ba=>{if(Ba.Values.messageCorrelationId&&Ba.Values.messageCorrelationId.toString()){var za=Ba.Values.messageCorrelationId.toString(),Aa=this.ARa[za];if(Aa){var na=oa.a.jj()-Aa.startTime;k.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
na);Ba.Values.isSuccess&&Ba.Values.isSuccess?Aa.resolve(Ba.Values.response):Aa.reject(Ba.Values.response);this.Y_h(za)}else k.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else k.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.x6k=()=>{if(this.l0.Bbj)this.l0.jeg();else if(this.eId&&this.l0){const Ba=new Y.a(ba.a.YOh);Ba.Values=this.pQf(this.eId,
!0);this.jG.vnb(Ba,this.l0.VOh.contentWindow,this.Nda)}};this.f6k=()=>{this.l0&&this.l0.hoe()};this.E3k=Ba=>{Ba.Values.cancelled&&Ba.Values.cancelled&&Ba.Values.messageCorrelationId&&this.Y_h(Ba.Values.messageCorrelationId.toString());this.l0&&this.l0.hide()};this.W6k=Ba=>{if(Ba.Values.messageCorrelationId&&Ba.Values.messageCorrelationId.toString()){var za=this.ARa[Ba.Values.messageCorrelationId.toString()];if(za){var Aa=oa.a.jj()-za.startTime;k.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",
Aa);Ba.Values.isSuccess&&Ba.Values.isSuccess?za.resolve(Ba.Values.response):za.reject(Ba.Values.response)}else k.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else k.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.jG=new ka.a(null,null);this.zub="SharedAuthTokenStrategy Unloaded";this.Nda=E.a.yWl;this.AFf=E.a.xWl;this.$rf=E.a.enableConsoleLogging;
this.Hdi=C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.Hoi=C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.fri=C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.ARa={};this.ggi=new P(1500)}qbc(){return this.zub}initialize(){var {OAuthManager:Ba}=d(556);if("loadFrame"in this.ARa)return this.ARa.loadFrame.LQf;
if(!this.Nda)return ca.Health.instance.recordKpiFailure(Ba.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),k.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Ba=this.HBd("loadFrame");this.OGc=oa.a.jj();var za=this.Nda+this.AFf+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+C.AFrameworkApplication.userSessionId+"&WacUserType="+C.AFrameworkApplication.userType;this.fri&&(za+="&webworker=1");this.WB=document.createElement("iframe");
this.Q4c(this.WB);this.WB.style.cssText="height:0;width:0;display:none;";this.WB.id="SharedAuthFrame";this.WB.setAttribute("name","SharedAuthFrame");this.WB.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.WB.setAttribute("title","SharedAuthFrame");this.WB.src=za;document.body.appendChild(this.WB);za=oa.a.jj()-this.OGc;k.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",za,this.WB.src);
return Ba}y$c(Ba){this.eId=Ba;const za=new Y.a(ba.a.YOh);za.Values=this.pQf(Ba);Ba=this.HBd("initFrame");this.jG.vnb(za,this.WB.contentWindow,this.Nda);k.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Ba}vH(Ba,za,Aa,na,la,va){const Pa=new Y.a(ba.a.BWl),Qa=this.Ang();Pa.Values=this.t_h(Ba,za,Aa,na,la,va,Qa);Ba=this.HBd(Qa);na&&C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.ggi.enqueue(()=>
new Promise(Ua=>{this.Kdm(va,Pa,Ua,Qa)})):(this.jG.vnb(Pa,this.WB.contentWindow,this.Nda),k.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",za));return Ba}Kdm(Ba,za,Aa,na){const la=this.ARa[na];la&&(this.Uub=za,this.d7a=Object.assign(new U,{resolve:Aa,correlationId:na}),this.l0=new ha(this.Nda,this.AFf,Ba,this.jG,la,Aa),this.l0.zia())}Ang(){return sa.a.create().toString()}t_h(Ba,za,Aa,na,la,va,Pa){const Qa={};Qa.appName=Ba;Qa.appId=za;Qa.target=
Aa;Qa.withPopup=na;Qa.claims=la;Qa.promptMessage=va;Qa.messageCorrelationId=Pa;return Qa}Q4c(Ba){$addHandler(Ba,"load",this.j6k);$addHandler(Ba,"error",this.LUe);this.jG.ODa(this.Nda);this.jG.Bv(ba.a.aPh);this.jG.dD(ba.a.aPh,this.t9k);this.jG.Bv(ba.a.$Oh);this.jG.dD(ba.a.$Oh,this.s9k);this.jG.Bv(ba.a.WOh);this.jG.dD(ba.a.WOh,this.R5k);this.jG.Bv(ba.a.bPh);this.jG.dD(ba.a.bPh,this.W6k);this.jG.Bv(ba.a.ZOh);this.jG.dD(ba.a.ZOh,this.x6k);this.jG.Bv(ba.a.XOh);this.jG.dD(ba.a.XOh,this.f6k);this.jG.Bv(ba.a.UOh);
this.jG.dD(ba.a.UOh,this.E3k)}HBd(Ba){const za=new N;za.startTime=oa.a.jj();const Aa=new Promise((na,la)=>{za.resolve=na;za.reject=la});za.LQf=Aa;this.ARa[Ba]=za;return Aa}pQf(Ba,za){za=void 0===za?!1:za;const Aa={};Aa.appIds=this.yuj();Aa.upn=Ba.loginHint;Aa.authority=Ba.authority;Aa.authorityType=Object(e.a)(r,Ba.authorityType);Aa.tenantId=Ba.tenantId;Aa.correlationId=C.AFrameworkApplication.userSessionId;Aa.enableConsoleLogging=this.$rf;Aa.enablePopupFlash=this.Hdi;Aa.skipUpnCheck=this.Hoi;Aa.interactive=
za;return Aa}yuj(){const Ba=[],za=E.a.Y_d;for(const na in za){var Aa=za[na];Array.contains(Ba,Aa)||Array.add(Ba,Aa)}return Ba}cEd(Ba,za,Aa,na,la,va){const Pa=new Y.a(ba.a.zWl),Qa=this.Ang();Pa.Values=this.t_h(Ba,za,Aa,na,la,va,Qa);this.qHf=Pa;Ba=this.HBd(Qa);k.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",za);this.q_l();return Ba}$Bd(){return!0}q_l(){this.ftb||(this.ftb=new A.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,
null),this.ftb.id=16,this.ftb.jfc=!1,this.ftb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{k.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.jG.vnb(this.qHf,this.WB.contentWindow,this.Nda)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),C.AFrameworkApplication.za.mb.BNc(this.ftb,!0)||k.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Y_h(Ba){this.d7a&&this.d7a.correlationId===
Ba&&(this.d7a.resolve(null),this.d7a=null)}}Object(L.a)(Ta,"SharedAuthTokenStrategy",null,[826]);class R{constructor(Ba){this.GTd=Ba;this.zub="UnsupportedAuthTokenStrategy Reason="+n.a[this.GTd]}initialize(){return Promise.resolve(0)}y$c(){return Promise.resolve(0)}vH(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:n.a[this.GTd],ErrorMessage:"Unable to get a token. Reason: ["+n.a[this.GTd]+"]"}))}cEd(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}$Bd(){return!1}qbc(){return this.zub}}Object(L.a)(R,"UnsupportedAuthTokenStrategy",null,[826]);var Ha=d(201);d.d(V,"OAuthManager",function(){return da});class da{constructor(Ba){Ba=void 0===Ba?null:Ba;this.vT=0;this.L_=null;this.l8a=0;this.Mwf=!!window.location.search.match(RegExp("wdpa=1","gi"));const za=oa.a.jj();this.Yfi=this.Xaj(Ba).then(Aa=>Aa?this.s8j():(k.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.pC(),Math.floor(oa.a.jj()-za)),Aa=ia.a.Yz(),void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.pC()),Aa=Object.assign(new Ca.a,{durationMs:Math.floor(oa.a.jj()-za),extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,"StrategyPickFailed",!1,!0,Aa)),Promise.resolve(1))).then(Aa=>0!==Aa?Promise.resolve(Aa):this.fxk())}Yaj(){if(this.Mwf)this.vT=5,this.L_=new R(this.vT);else{var Ba=E.a.sYk;Ba&&0<Ba.length?(this.vT=1,this.L_=new D(Ba)):C.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost")||
C.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost")?C.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser")?(this.vT=2,this.L_=new R(this.vT)):(Ba=y.a.getAuthContext().loginHint)&&Ba.length?E.a.Ddb?(this.vT=1,this.L_=new K):(this.vT=1,this.L_=new Ta):(this.vT=3,this.L_=new R(this.vT)):(this.vT=4,this.L_=new R(this.vT))}}pC(){return this.L_?this.L_.qbc()||"Unknown":"None"}Xaj(Ba){Ba=void 0===Ba?null:Ba;k.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const za=
oa.a.jj();return C.AFrameworkApplication.fa.YBj().then(Aa=>{Aa?(this.Yaj(),Ba&&(this.L_=Ba),k.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",E.a.clientVersion,E.a.appVersion,E.a.Idj,this.pC(),Math.floor(oa.a.jj()-za))):k.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oa.a.jj()-za));
return Promise.resolve(Aa)},()=>{k.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oa.a.jj()-za));return Promise.resolve(!1)})}s8j(){k.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.pC());const Ba=oa.a.jj();return m.get(this.L_.initialize(),2,E.a.l_e).then(za=>{if(0===za)k.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.pC(),Math.floor(oa.a.jj()-
Ba));else if(1===za){k.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.pC(),Math.floor(oa.a.jj()-Ba));var Aa=ia.a.Yz();void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.pC()),Aa=Object.assign(new Ca.a,{durationMs:Math.floor(oa.a.jj()-Ba),extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,"StrategyInitFailed",!1,!0,Aa))}else 2===za&&(k.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.pC(),Math.floor(oa.a.jj()-Ba)),Aa=ia.a.Yz(),void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.pC()),Aa=Object.assign(new Ca.a,{durationMs:Math.floor(oa.a.jj()-Ba),extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,"StrategyInitTimedOut",!1,!0,Aa)));return Promise.resolve(za)},()=>{k.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pC(),Math.floor(oa.a.jj()-Ba));return Promise.resolve(1)})}fxk(){k.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.pC());const Ba=oa.a.jj();return m.get(this.L_.y$c(y.a.getAuthContext()),2,E.a.l_e).then(za=>{if(0===za)k.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.pC(),Math.floor(oa.a.jj()-Ba));else if(1===za){k.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pC(),Math.floor(oa.a.jj()-Ba));var Aa=ia.a.Yz();void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.pC()),Aa=Object.assign(new Ca.a,
{durationMs:Math.floor(oa.a.jj()-Ba),extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,"StrategyLoadFailed",!1,!0,Aa))}else 2===za&&(k.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.pC(),Math.floor(oa.a.jj()-Ba)),Aa=ia.a.Yz(),void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.pC()),Aa=Object.assign(new Ca.a,{durationMs:Math.floor(oa.a.jj()-Ba),extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,
"StrategyLoadTimedOut",!1,!0,Aa)));return Promise.resolve(za)},()=>{k.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pC(),Math.floor(oa.a.jj()-Ba));return Promise.resolve(1)})}vH(Ba,za,Aa){return this.$Tb(Ba,za,!1,null,"",void 0===Aa?null:Aa)}u_h(Ba,za,Aa,na,la){return this.$Tb(Ba,za,!0,Aa,na,void 0===la?null:la)}$Tb(Ba,za,Aa,na,la,va,Pa){Pa=void 0===Pa?0:Pa;Pa+=1;k.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
Ba,this.hnb(Ba,za),this.pC(),Pa);var Qa=ia.a.Yz();void 0!==Qa&&null!==Qa&&(Qa.set("AuthLibrary",this.pC()),Qa.set("AppName",Ba),Qa.set("Target",this.hnb(Ba,za)),ca.Health.instance.recordKpiUsage(da.kpiName,0,"WacOAuthFC",Qa));if(!E.a.isEnabled||this.Mwf){var Ua;return this.xAe((Ua=new w.a,Ua.IsSuccess=!1,Ua.Token=null,Ua.ErrorCode="NotEnabled",Ua.ErrorMessage="OAuthManager is disabled.",Ua),Ba)}const Ya=E.a.Y_d[Ba];if(void 0===Ya||null===Ya){k.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
Ba);var Ea;return this.xAe((Ea=new w.a,Ea.IsSuccess=!1,Ea.Token=null,Ea.ErrorCode="DisallowedApp",Ea.ErrorMessage="Disallowed appName: "+Ba,Ea),Ba)}const La=oa.a.jj();let xb=La;const dc=this;Qa=this.Yfi.then($b=>{xb=oa.a.jj();return dc.ldk(Ba,Ya,za,Aa,na,la,va,$b)});Ua=Aa?0:E.a.l_e;let gb;Ea=(gb=new w.a,gb.IsSuccess=!1,gb.Token=null,gb.ErrorCode="authTokenStrategy_timeout",gb.ErrorMessage="Auth Strategy timed out after ["+Ua+"] ms when fetching token",gb);const gc=this,Ac=this;return m.get(Qa,Ea,
Ua).then($b=>Pa<=da.cXk&&($b.ErrorCode===da.rYh||$b.ErrorCode===da.o6l)?(k.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Pa,Math.floor(oa.a.jj()-La)),gc.$Tb(Ba,za,Aa,na,la,va,Pa)):$b.ErrorCode===da.oHg&&!Aa&&(k.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Pa,da.x8f),da.egj&&gc.L_.$Bd()&&gc.L_.cEd(Ba,Ya,za,Aa,na,la).then(jc=>Promise.resolve(gc.S$c(jc,Ba,za,Ya,La,xb))).catch(()=>
{let jc;const pb=(jc=new w.a,jc.IsSuccess=!1,jc.Token=null,jc.ErrorCode="authTokenStrategy_failure",jc.ErrorMessage="LoginPopup failed, GetToken could not be called",jc);return Promise.resolve(gc.S$c(pb,Ba,za,Ya,La,xb))}),da.x8f)?gc.$Tb(Ba,za,!0,na,la,va,Pa):Promise.resolve(gc.S$c($b,Ba,za,Ya,La,xb))).catch(()=>{let $b;const jc=($b=new w.a,$b.IsSuccess=!1,$b.Token=null,$b.ErrorCode="authTokenStrategy_failure",$b.ErrorMessage="Auth Strategy failed with an unknown error",$b);return Promise.resolve(Ac.S$c(jc,
Ba,za,Ya,La,xb))})}ldk(Ba,za,Aa,na,la,va,Pa,Qa){return 1===Qa||2===Qa?this.xAe(Object.assign(new w.a,{IsSuccess:!1,Token:null,ErrorCode:1===Qa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Ba):this.L_.vH(Ba,za,Aa,na,la,va,Pa).then(Ua=>Promise.resolve(this.rjh(Ua,!0,Ba))).catch(Ua=>Promise.resolve(this.rjh(Ua,!1,Ba)))}S$c(Ba,za,Aa,na,la,va){const Pa={},Qa=oa.a.jj()-va;Pa.IsSuccess=Ba.IsSuccess;Pa.ErrorCode=Ba.IsSuccess?"Success":Ba.ErrorCode||"";Pa.ErrorMessage=
Ba.IsSuccess?"Success":this.hnb(za,Ba.ErrorMessage||"");Pa.Target=this.hnb(za,Aa||"");Pa.TimeInMS=Math.floor(Qa);Pa.LoadTimeInMS=Math.floor(va-la);Pa.AuthLibrary=this.pC();Pa.AppName=za;Pa.AuthorityType=Object(e.a)(r,y.a.KZc());Pa.UserType=this.iRj(y.a.getAuthContext());Pa.IsAuthSupportedInSession=n.a[this.vT];Pa.RequestCount=++this.l8a;Pa.AppId=na;k.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Pa));Ba.IsSuccess||(Aa=ia.a.Yz(),void 0!==Aa&&null!==Aa&&(Aa.set("AppName",za),Aa.set("AuthLibrary",
this.pC()),Aa.set("ErrorCode",Ba.ErrorCode),Aa.set("ErrorMessage",this.hnb(za,Ba.ErrorMessage)),za=Object.assign(new Ca.a,{durationMs:Qa,extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,"TryGetTokenFailure",!1,!0,za)));return Ba}xAe(Ba,za){k.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",za,this.hnb(za,Ba.ErrorMessage));const Aa=ia.a.Yz();void 0!==Aa&&null!==Aa&&(Aa.set("AppName",za),Aa.set("AuthLibrary",this.pC()),
Aa.set("ErrorCode",Ba.ErrorCode),Aa.set("ErrorMessage",this.hnb(za,Ba.ErrorMessage)),za=Object.assign(new Ca.a,{extendedProperties:Aa}),ca.Health.instance.recordKpiFailure(da.kpiName,"FailureBeforeGetToken",!1,!0,za));return Promise.resolve(Ba)}iCg(Ba){return Ba===Ha.a.WCd}hnb(Ba,za){return this.iCg(Ba)&&za?"REDACTED":za}iRj(Ba){return C.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser")?"anonymous":!Ba.loginHint||1>Ba.loginHint.length?"empty":-1<Ba.loginHint.indexOf("guest#")?"guest":
-1<Ba.loginHint.indexOf("ext#")?"external":0>Ba.upn.indexOf("@")?"no-at":"supported"}zek(){return 1===this.vT}rjh(Ba,za,Aa){let na=null,la=null,va=null,Pa=null;Ba?Ba.ErrorCode||Ba.ErrorMessage?(la=Ba.ErrorCode?Ba.ErrorCode:da.s$f,va=Ba.ErrorMessage?Ba.ErrorMessage:"No message"):Ba.Token?za?na=Ba.Token:(la=da.nyl,va="A rejected promise returned a token."):(la=da.s$f,va=JSON.stringify(Ba)):(la=da.a0k,va="No result came from Auth Token Strategy");Ba&&Ba.Telemetry&&!this.iCg(Aa)&&(Pa=Ba.Telemetry,k.ULS.sendTraceTag(579166408,
3E3,50,JSON.stringify(Pa)));if(la===da.DYk||la===da.Iam)la=da.rYh,va="Auth Library Timed Out";la===da.$Gi&&-1<va.indexOf(da.Rri)&&(la=da.oHg);if(la||va)na=null;return Object.assign(new w.a,{IsSuccess:!!na,Token:na,ErrorCode:la,ErrorMessage:va,Telemetry:Pa})}static get x8f(){return C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get egj(){return C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}da.Iam="token_renewal_error";da.s$f="Exception";da.a0k="NoResult";da.nyl="RejectToken";da.DYk="monitor_window_timeout";da.rYh="Timeout";da.o6l="authTokenStrategy_timeout";da.$Gi="login_required";da.Rri="AADSTS50058";da.oHg="Cookies Disabled";da.kpiName="OAuthManager";da.cXk=2;Object(L.a)(da,"OAuthManager",null,[768])},560:function(L,V,d){L=d(0);var k=d(395),e=d(409),n=d(54),r=d(67),w=d(183),D=d(94),y=d(25);d(7);var m=d(35),C=d(49),E=d(100);class F{constructor(){this.Flb=this.z7=null;this.NYh=
0}}Object(L.a)(F,"CandidateManager",null,[]);var B=d(671),H=d(669),K=d(670);class A{constructor(){this.keyCode=0;this.fpm=this.epm=null}}Object(L.a)(A,"PredictionKeptState",null,[]);class W{constructor(){this.values={}}$wg(Aa,na,la){Aa=this.epg(Aa);Aa[na]=na in Aa?Aa[na]+la:la}add(Aa,na,la){this.epg(Aa)[na]=la}ga(Aa){return this.values[Aa]}$(Aa,na){return this.values[Aa]=na}LZf(Aa){return Aa in this.values?!0:!1}epg(Aa){let na;Aa in this.values?na=this.values[Aa]:(na={},this.values[Aa]=na);return na}}
Object(L.a)(W,"PredictionState",null,[]);class N{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(L.a)(N,"TypeAheadRoamingSettings",null,[]);var P=d(197),U=d(1264),Q=d(18),G=d(942),Y=d(672);d(673);var ba=d(943);class ha{constructor(Aa){this.yDc=null;this.IE=Aa;Aa=n.a.instance.resolve("Common.IDynamicScriptLoaderProvider").nG;const na=n.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Aa,na)}initialize(Aa,na){const la=new Y.a;
return Aa?na?this.yDc?this.yDc:y.AFrameworkApplication.za.mb.MBg?this.yDc=new Promise((va,Pa)=>{const Qa=y.AFrameworkApplication.Ui("al",2);na.LFb(Qa).continueWith(Ua=>{Ua.Pm?(this.Qnh(),Pa(Ua.Ni.message)):(this.Cxg(la),va({}))})}):this.yDc=Aa.loadScript("al").then(()=>{this.Cxg(la)}).catch(va=>{this.Qnh();return Promise.reject(va)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}Cxg(Aa){ha.AU.bL(()=>{k.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");
const na=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let la=y.AFrameworkApplication.fa.Ea("OfficeApplicationName")||"";la=la.replace("Web","");Aa.appName=Aa.appName||la;Aa.serviceUrl=Aa.serviceUrl||y.AFrameworkApplication.fa.Ea("AugLoopCloudALServiceUrl");Aa.appVersion=Aa.appVersion||y.AFrameworkApplication.fa.Ea("BuildVersion")||"";Aa.releaseAudienceGroup=Aa.releaseAudienceGroup||(y.AFrameworkApplication.ld?Object(U.a)(String,y.AFrameworkApplication.ld.AudienceGroup)||"":"");Aa.sessionId=
Aa.sessionId||y.AFrameworkApplication.fa.Ea("SessionId")||"";Aa.uiLanguage=Aa.uiLanguage||y.AFrameworkApplication.uiCulture;Aa.flights=this.Juj();Aa.initSession=Aa.initSession||!0;na.initialize(Aa);na.activateAnnotation(Object.assign(new G.a,{annotationType:ba.a.getTypeName(),handler:this.IE}))},"WordPredictionAL:Initialize")}Qnh(){k.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}Juj(){var Aa=y.AFrameworkApplication.fa.Ea("FlightId"),na=y.AFrameworkApplication.fa.hz("AugLoopFlightKeywordList");
Aa=this.yde(Aa,na);na="";0<Aa.length&&(na=P.a.join(Aa,";"),k.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Aa.length].concat(Aa)));return na}yde(Aa,na){const la=new Q.a;if(Aa&&""!==Aa&&na&&0<na.length){for(let va=0;va<na.length;va++)na[va]=na[va].toLowerCase();Aa=Aa.toLowerCase().split(";");for(const va of Aa)P.a.any(na,Pa=>-1<va.indexOf(Pa))&&la.add(va)}return la.toArray()}static get AU(){return e.a.instance}}Object(L.a)(ha,"WordPredictionAugLoopHandler",null,
[685]);var ka=d(136),ca=d(182),ia=d(109);class oa{constructor(Aa,na,la,va){this.x7b=null;this.maxWords=Aa;this.LNl=la;this.pQi=va;this.tNl=na;this.DUc=Array(Aa);this.oGh();this.BGh()}V7j(Aa,na,la){Aa>this.maxWords-1||this.Zwg(this.DUc[Aa],na,la)}Pdb(Aa,na){this.Zwg(this.x7b,Aa,na)}QYd(Aa,na){this.x7b[Aa]=na}flush(){oa.AU.bL(()=>{for(let Aa=0;Aa<this.DUc.length;Aa++){const na=this.Ctj(Aa);na&&(na.dataFields.push(Object.assign(new ia.a,{name:H.a.DQ,int64:Aa})),ka.a.sendActivityEvent(na))}this.oGh()},
"WPT:F")}Qpj(){oa.AU.bL(()=>{const Aa=this.Btj();Aa&&ka.a.sendActivityEvent(Aa);this.BGh()},"WPT:FSD")}Lpj(Aa){oa.AU.bL(()=>{const na=this.Atj(Aa);na&&ka.a.sendActivityEvent(na)},"WPT:FCD")}Btj(){const Aa=this.cje(this.LNl);for(var na=0;na<K.a.xVa.length;na++)this.RYd(K.a.xVa[na],this.x7b,Aa.dataFields);for(na=0;na<K.a.I$b.length;na++)this.A9a(K.a.I$b[na],this.x7b,Aa.dataFields);return Aa.dataFields.length?Aa:null}Ctj(Aa){const na=this.cje(this.tNl);for(let la=0;la<H.a.xVa.length;la++)this.RYd(H.a.xVa[la],
this.DUc[Aa],na.dataFields);return na.dataFields.length?na:null}Atj(Aa){const na=this.cje(this.pQi);for(var la=0;la<B.a.xVa.length;la++)this.RYd(B.a.xVa[la],Aa,na.dataFields);for(la=0;la<B.a.I$b.length;la++)this.A9a(B.a.I$b[la],Aa,na.dataFields);return na.dataFields.length?na:null}Zwg(Aa,na,la){Aa[na]=na in Aa?Aa[na]+la:la}cje(Aa){const na=new ca.a;na.name=Aa;na.dataFields=[];return na}RYd(Aa,na,la){Aa in na&&Array.add(la,Object.assign(new ia.a,{name:Aa,int64:na[Aa]}))}A9a(Aa,na,la){Aa in na&&Array.add(la,
Object.assign(new ia.a,{name:Aa,string:na[Aa]}))}oGh(){for(let Aa=0;Aa<this.maxWords;Aa++)this.DUc[Aa]={}}BGh(){this.x7b={}}static get AU(){return e.a.instance}}Object(L.a)(oa,"WordPredictionTelemetryHandler",null,[686]);var sa=d(63),Ca=d(33),Ta=d(393),R=d(306),Ha=d(91);d(238);var da=d(50),Ba=d(34);d(252);d(267);d(743);d.d(V,"a",function(){return za});class za{static get AU(){return e.a.instance}static get YE(){za.XDc||(za.XDc=new F);return za.XDc}static set YE(Aa){za.XDc=Aa}static get s8c(){return za.zIf}static set s8c(Aa){za.zIf=
Aa}static get V5h(){za.dYd||(za.dYd=za.M5i());return za.dYd}static get settings(){za.lLc||(za.lLc=Object.assign(new N,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return za.lLc}static set settings(Aa){za.lLc=Aa}static get J1a(){za.fTd||(za.fTd=new W);return za.fTd}static get q9l(){return za.n$i}static get Z7(){za.fYd||(za.fYd=new oa(za.q9l,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));
return za.fYd}static get V8i(){return za.p9a?za.p9a.instance?za.p9a.instance.X4:1:(za.p9a=n.a.instance.Ha("Common.IZoomManager"),za.p9a&&za.p9a.instance?za.p9a.instance.X4:1)}static get characterPropertiesEditor(){za.eJd||(za.eJd=n.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return za.eJd}static get Osd(){za.qTd||n.a.instance.Ha("Box4.Proofing.IProofingSentenceSeparator").execute(Aa=>{Aa&&(za.qTd=Aa)});return za.qTd}static get gpm(){za.eYd||(za.eYd=n.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));
return za.eYd}static mKl(){window.setTimeout(()=>{const Aa={};Aa.WordPredIsEnabled=za.settings.WordPredIsEnabled;Aa.PredictionSeenCount=za.settings.PredictionSeenCount;Aa.PredictionAccepted=za.settings.PredictionAccepted;za.gpm.jDm(m.c(Aa))},za.C3f)}static Qme(Aa,na){if(!Aa||!na||Aa.eventName!==r.a.sEa)return!1;const la=Aa.hc.keyCode;if(za.lAg(na)){za.pwl();na=na.node;if((la===w.a.LW||la===w.a.zs)&&za.$Xa)return D.a.vo(Aa.hc),za.Gbk(na),za.Djm(la),k.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),
!0;if(la===w.a.fO)za.s8c&&(za.s8c=!1);else if(la===w.a.E_&&za.$Xa)za.s8c=!0,k.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),za.$Wa();else if(la===w.a.Eqb&&Aa.hc.ctrlKey&&za.eTd)return k.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),za.zGh(),!1}if(la===w.a.kqb&&Aa.hc.shiftKey||la===w.a.Pca&&Aa.hc.ctrlKey||la===w.a.XOa&&Aa.hc.altKey)return!1;na=za.YE.z7;const va=la===w.a.J3||la===w.a.o8||la===w.a.eja||la===w.a.Rca;if(va||va&&(Aa.hc.ctrlKey||Aa.hc.shiftKey)||la!==w.a.Pca&&Aa.hc.ctrlKey||
la!==w.a.XOa&&Aa.hc.altKey||la===w.a.eG||za.$Xa&&na&&0<na.w$.length&&!na.w$.toLowerCase().startsWith(String.fromCharCode(la).toLowerCase()))za.$Wa(),za.YE.z7=null,k.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");za.zGh();return!1}static UZj(){5>za.settings.PredictionSeenCount&&(za.settings.PredictionSeenCount+=1)}static $Wa(){Ta.a.$Wa();za.$Xa=!1}static Gbk(Aa){za.AU.bL(()=>{var na=document.getElementById("inlinePredictedWord");
if(na){var la=na.innerText;if(la&&0<la.length&&(Aa=Aa?Aa:za.FHj())){var va=new C.GraphTransaction(7);va.rd(Aa);var Pa=Aa.Sa.last,Qa=da.a.STa(Aa),Ua=Ha.a.yt(Qa);Pa.formatting=Ua.le(Pa);za.characterPropertiesEditor.replaceTextRange(Qa,la,!0,!0,Ba.a.Nz);va.dispose();la=E.InteractiveViewManager.instance.$d;va=Aa.vg(la.Na);va=R.a.Nu(va,Ca.ParagraphReader.textLength(Aa));Pa=new Sys.UI.Point(va.x,va.y);Pa.y+=va.height;la.i8(Pa,null,null,la,!1);za.$Xa=!1;na.innerText="";(na=document.getElementById("inlinePlaceholderTab"))&&
za.Ftg()&&(na.className="hidePanel")}}},"WPT:IIG")}static HRl(Aa){za.sFf=Aa;za.Z7.QYd(K.a.modelId,Aa.modelId);za.Z7.QYd(K.a.modelVersion,Aa.modelVersion);za.Z7.QYd(K.a.configId,Aa.configId)}static LFj(){return za.sFf}static x0d(Aa,na){const la=za.V5h;var va=document.getElementById("inlinePredictedWord");va&&(va.innerText=na,(na=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<na.length&&(na=na[na.length-1],va.style.fontSize=na.style.fontSize,
va.style.fontFamily=na.style.fontFamily,va.style.color=na.style.color,va.style.whiteSpace="pre",va=va.parentNode,Aa="suggestion: "+Aa,na=document.getElementById("inlinePlaceholderTab"),na.className="hidePanel",na&&za.Ftg()&&(na.className="inlinePlaceholderTab",Aa+=". Tab to accept"),va.parentNode.setAttribute("aria-label",Aa)),la&&(la.className="textareaCaretTracker"),za.uSl()&&(za.$Xa=!0,k.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static lAg(Aa){Aa||(Aa=za.Axj());if(Aa){const na=
Aa.node;try{return Ca.ParagraphReader.textLength(na)<=Aa.Ra}catch(la){}}return!1}static bzk(Aa){Aa=za.J1a.ga(Aa);Aa=Aa[K.a.X_d]-Aa[K.a.azc];300<Aa?(za.Z7.Pdb(K.a.j4f,Aa),za.Z7.Pdb(K.a.i4f,1)):(za.Z7.Pdb(K.a.oQf,Aa),za.Z7.Pdb(K.a.xNf,1))}static ree(Aa){za.fCg("TextPredictionTelemetryIsEnabled")&&za.Z7.Lpj(Aa)}static VJg(Aa,na){Aa=za.J1a.ga(Aa);const la=Aa[K.a.azc];na?za.Z7.Pdb(K.a.CSh,Aa[K.a.yNf]-la):za.Z7.Pdb(K.a.BSh,Aa[K.a.wNf]-la)}static rhc(Aa){za.Z7.Pdb(Aa,1)}static Bwa(Aa,na,la){za.Z7.V7j(Aa,
na,la)}static Yvd(){za.YE.z7=null;za.YE.Flb=null}static Hjl(){za.Ppb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");za.UZj();za.jdk()}static Ppb(Aa,na){za.fCg(na)&&window.setTimeout(()=>{const la=n.a.instance.Ha("Common.ISystemInitiatedFeedback");la&&la.execute(va=>{va.logActivity(Aa,na)})},za.C3f)}static fCg(Aa){return!!y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.getBooleanAppSetting(Aa)}static M5i(){var Aa=document.body;const na=document.createElement("div");if(Aa){Aa.appendChild(na);
na.setAttribute("id","textareaCaretTracker");na.className="hidePanel";na.setAttribute("role","alert");Aa=document.createElement("button");const la=document.createElement("span");Aa.setAttribute("disabled",!0);Aa.setAttribute("aria-disabled",!0);Aa.setAttribute("aria-hidden",!0);la.setAttribute("aria-disabled",!0);la.setAttribute("aria-hidden",!0);la.setAttribute("id","inlinePredictedWord");la.className="inlinePredictedWord";Aa.className="inlinePredictedWordButton";Aa.appendChild(la);na.appendChild(Aa);
na.appendChild(za.x7i());(Aa=document.getElementById("WACViewPanel"))&&$addHandler(Aa,"scroll",za.QXj)}return na}static uSl(){const Aa=za.V5h;var na=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");na=(na=na?na.getElementsByClassName("EOP")[0]:null)?na.getBoundingClientRect():null;return Aa&&na?(Aa.style.cssText="transform: scale("+za.V8i+"); transform-origin: 0% 0%",Aa.style.top=na.top+"px",Aa.style.left=na.left+"px",!0):!1}static Ftg(){return!za.settings.PredictionAccepted}static jdk(){5!==
za.settings.PredictionSeenCount||za.settings.PredictionAccepted||(za.Ppb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),za.mKl())}static x7i(){const Aa=document.createElement("button");Aa.setAttribute("aria-hidden",!0);Aa.className="hidePanel";Aa.id="inlinePlaceholderTab";Aa.disabled=!0;Aa.innerText="Tab";return Aa}static QXj(){za.$Wa()}static FHj(){const Aa=sa.a.instance.Oa.kb;return Aa&&Aa.vf?Aa.vf.node:null}static pwl(){za.BWd||(za.BWd=window.setTimeout(za.fWj,6E4*za.m$i))}static fWj(){za.Z7.flush();
za.Z7.Qpj();za.BWd=0}static Qkg(Aa){return Aa&&0<Aa.length&&(Aa=Aa.split(" "),0<Aa.length)?Aa[Aa.length-1].length:-1}static Djm(Aa){const na=za.YE.z7,la=za.YE.Flb;na&&(za.eTd=Object.assign(new A,{keyCode:Aa,epm:na,fpm:la}))}static Axj(){const Aa=sa.a.instance.Oa.kb;return Aa&&Aa.vf?Aa.vf:null}static zGh(){za.eTd=null}}za.n$i=30;za.m$i=5;za.C3f=5E3;za.dYd=null;za.qTd=null;za.eJd=null;za.p9a=null;za.zIf=!1;za.BWd=0;za.fYd=null;za.fTd=null;za.eTd=null;za.eYd=null;za.lLc=null;za.sFf=null;za.XDc=null;
za.$Xa=!1;Object(L.a)(za,"WordPredictionHandler",null,[])},668:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.V_k="NoCharacterPositionOnLine";k.X_k="NoCharacterPositionOnSpan";k.W_k="NoCharacterPositionOnMultilineSpan";k.e8b="DoNothingResult";k.ama="FailedProcessingStep";k.rbb="FailedResult";k.vYc="FirstChildNotText";k.Eoj="FirstChildNull";k.rck="InvalidCharacterPositionResult";k.ei="NoExecute";k.Kp="NoApply";k.C3="UnexpectedState";Object(L.a)(k,"ActivityEventName",null,[])},669:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.DQ="WordIndex";k.dFh="RenderedCandidateCount";k.tjh="NotRenderedCandidateCount";k.lVf="CandidateListCount";k.H2f="CumulativeIndexOfSeen";k.F8i="CumulativeIndexOfRejected";k.E8i="CumulativeIndexOfKept";k.G2f="CumulativeIndexOfCorrect";k.D8i="CumulativeIndexOfAcceptedCandidate";k.UJh="SeenCount";k.oyl="RejectedCount";k.yuk="KeptCount";k.w0h="TypedThroughCount";k.G8i="CumulativeScoreOfKept";k.H8i="CumulativeScoreOfRejected";k.J2f="CumulativeScoreOfTypeThrough";
k.eFh="RenderedCharSum";k.xuk="KeptCharSum";k.wuk="KeptCandidateTokenSum";k.yfm="UndoOfKeptCount";k.Bfm="UndoneKeptCharCount";k.x0h="TypedThroughLastMatchingCharCount";k.language="Language";k.xVa=[k.dFh,k.tjh,k.lVf,k.H2f,k.F8i,k.E8i,k.G2f,k.D8i,k.UJh,k.oyl,k.yuk,k.w0h,k.G8i,k.H8i,k.J2f,k.eFh,k.xuk,k.wuk,k.yfm,k.Bfm,k.x0h,k.language];Object(L.a)(k,"DataFieldsPerSentence",null,[])},670:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.modelId="ModelId";k.configId="ConfigId";k.modelVersion=
"ModelVersion";k.Fjl="PredictionAcceptedByTab";k.Ejl="PredictionAcceptedByRightArrow";k.oQf="AugLoopResponseTime";k.CSh="SignalRenderedTime";k.BSh="SignalNotRenderedTime";k.j4f="DelayedResponseTime";k.k2l="SignalGeneratedCount";k.xNf="AnnotationReceivedCount";k.cwh="PredictionRenderedCount";k.bwh="PredictionNotRenderedCount";k.dbe="EmptyPredictionResponseCount";k.NSh="SkippedPredictionResponseCount";k.i4f="DelayedResponseCount";k.g0k="NonEnglishSkipCount";k.azc="SignalGenerationTime";k.X_d="AnnotationReceivedTime";
k.yNf="AnnotationRenderedTime";k.wNf="AnnotationNotRenderedTime";k.xVa=[k.Ejl,k.Fjl,k.oQf,k.CSh,k.BSh,k.j4f,k.k2l,k.xNf,k.cwh,k.bwh,k.dbe,k.NSh,k.i4f,k.g0k];k.I$b=[k.modelId,k.configId,k.modelVersion];Object(L.a)(k,"DataFieldsPerSession",null,[])},671:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.language="Language";k.m4d="CharIndex";k.wRc="CharIndexRendered";k.HHg="KeptCharCount";k.modelId="ModelId";k.awh="PredictionLength";k.dwh="PredictionTokenCount";k.score="Score";k.status=
"Status";k.Bgf="TypedThroughCharCount";k.DQ="WordIndex";k.modelVersion="ModelVersion";k.oYh="TimeTakenAugloop";k.dDd="TimeToRender";k.configId="ConfigId";k.xVa=[k.m4d,k.wRc,k.HHg,k.awh,k.dwh,k.score,k.status,k.Bgf,k.DQ,k.oYh,k.dDd];k.I$b=[k.language,k.modelId,k.configId,k.modelVersion];Object(L.a)(k,"DataFieldsPerCandidate",null,[])},672:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(L.a)(k,"InitializeParameters",null,[])},673:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.operation=
null}}Object(L.a)(k,"SubmitOperationParameters",null,[])},674:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.tJa=!0;this.Wad=this.hjd=this.Ykd=this.ogd=null;this.Nna=e}copy(){return new k(this.Nna.copy())}move(e,n){this.tJa=!0;this.Nna.move(e,n)}setOffsets(e){this.tJa=!0;this.Nna.setOffsets(e)}ng(){return this.Nna.ng()}get oc(){this.JEd();return this.ogd}get pc(){this.JEd();return this.Ykd}get lc(){this.JEd();return this.hjd}get jc(){this.JEd();return this.Wad}JEd(){if(this.tJa){var e=
this.Nna.points;this.ogd=this.hjd=e[0].x;this.Ykd=this.Wad=e[0].y;for(const n of e)this.ogd=Math.min(this.ogd,n.x),this.Ykd=Math.min(this.Ykd,n.y),this.hjd=Math.max(this.hjd,n.x),this.Wad=Math.max(this.Wad,n.y);this.tJa=!1}}}Object(L.a)(k,"Boundary",null,[])},675:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.uE=e}}Object(L.a)(k,"SessionEndedEventArgs",Sys.EventArgs,[])},676:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=
d(54);class e{constructor(n){this.sJg=this.errorType=0;this.originalText=this.token=null;this.lMa=this.Sba=this.lcid=0;this.C5h=!1;this.YCf=n}Tve(){const n=this.token?this.token:null;return 0!==this.errorType&&e.H6j.contains(n,this.lcid)}static get H6j(){return e.zQa||(e.zQa=k.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.zQa=null;Object(L.a)(e,"ProofingErrorDetails",null,[593])},677:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.Load=0]="Load";e[e.Edit=
1]="Edit"})(k||(k={}));Object(L.b)("UserAction",k)},678:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);V=d(114);class k extends V.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}om(){return 4}static srj(e,n){const r=new k;k.cYe(r,e,n);r.UserActionType=e.paragraphNode.NYb?"Edit":"Load";return r}static cYe(e,n,r){e.Lcid=n.range.lcid;e.Input=n.Xpa.substring(n.range.begin,n.range.end);e.ApplicationMode=
r;0<=n.range.Sba&&(e.PreContextText=n.Xpa.substring(n.range.Sba,n.range.begin));0<=n.range.lMa&&(e.PostContextText=n.Xpa.substring(n.range.end,n.range.lMa))}static LLj(e,n,r,w,D,y,m,C){const {SpellingRequestObjectUpdatedV2:E}=d(1159),{SpellingRequestObjectUpdated:F}=d(1160);return C?E.jfe(n,r):e?F.jfe(n,r,w,D,y,m):k.srj(n,r)}}Object(L.a)(k,"SpellingRequestObject",V.a,[])},679:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n,r,w,D,y){this.DisplayName=this.ClientId=this.Provider=
this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=void 0===n?null:n;this.DisplayName=void 0===r?null:r;this.Email=void 0===w?null:w;this.IsAnonymous=void 0===D?!1:D;this.ClientId=void 0===y?null:y}}Object(L.a)(k,"Person",null,[])},680:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(80);class e{static B9a(n,r,w){w=new k.a(2,1,0,()=>{r()},92,void 0===w?"GenericCommentsTask":w);n.Jb(w)}static fu(n){return Error.create("SDXHostAPI Error : "+n,{["SDXHostAPIErrorCode"]:n})}}
Object(L.a)(e,"OfficeSharedCommentsUtils",null,[])},681:function(L,V,d){d.d(V,"a",function(){return r});L=d(0);var k=d(395);V=d(748);var e=d(1077),n=d(948);class r extends V.a{constructor(w,D,y){super(w,D,(void 0===y?null:y)||e.a.instance,r.S9j)}static S9j(){n.a.sendTraceTag=r.nNl;n.a.debugAssertTag=r.u9i}static nNl(w,D,y,...m){k.ULS.sendTraceTag.apply(null,[w,204,r.l8i(D),y].concat(m))}static u9i(){}static l8i(w){switch(w){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;
default:return 100}}}r.oZe="wdPreviousSession";r.S2f="wdUserSession";Object(L.a)(r,"CommonCrossDocumentMessenger",V.a,[])},682:function(L,V,d){d.d(V,"a",function(){return n});L=d(0);var k=d(395),e=d(25);class n{static Ple(r,w){let D=null;if(r&&0<r.length&&w&&0<w.length){const y=window[w];y?y&&r in y?D=y[r]:k.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+r+" from dictionary "+w):k.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+w)}return D}static Bve(){const r=
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",!1);r?k.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):k.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return r}}Object(L.a)(n,"CommonUtils",null,[])},683:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(301);class k{}k.LabelText=d.a.labelText;k.LabelTextUserGeneratedPlaceholderReplacements=d.a.Suk;k.Visible=d.a.visible;k.ImageIsVisible=
"ImageIsVisible";k.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";k.Image16by16Class=d.a.PCb;k.Image32by32Class=d.a.bHa;k.Image48by48Class=d.a.Toe;k.ImageBackColor="ImageBackColor";k.On="On";k.SourceControlId="SourceControlId";Object(L.a)(k,"FlyoutAnchorCommandProperties",null,[])},684:function(L,V,d){d.d(V,"a",function(){return y});L=d(0);var k=d(270),e=d(25),n=d(430),r=d(228),w=d(99),D=d(64);class y{static T2a(m){const {Pam:C,Qam:E}=y.onj();y.rKl(C,E,m)}static onj(){({Mcc:C}=n.a.XTb(!e.AFrameworkApplication.fY));
var m=$get(k.CuiHelper.p2j);if(C)var C=document.getElementById(k.CuiHelper.Ace);else C=m.childNodes[0],m=m.childNodes[1];return{Pam:C,Qam:m}}static rKl(m,C,E){if(m&&C&&0<C.clientHeight){const F=-1!==C.parentNode.parentNode.className.indexOf("cui-ribbon");y.sJh(m,C,E,F)}}static sJh(m,C,E,F){let B=null,H=null,K=null,A=null,W=null,N=null,P=null,U=null,Q=null,G=null,Y=null,ba=null,ha=null,ka=null,ca=null,ia=null,oa=null,sa=null,Ca=null,Ta=null;({n8f:B,m8f:H,o8f:K,Wab:A,Xab:W,HUa:N,KU:P,ww:U,IUa:Q,xR:G,
JUa:Y,p8f:Ta}=y.ecg(m,B,H,K,A,W,N,P,U,Q,G,Y,Ta));({I8b:ba,$H:ha,l8f:ka,j8f:ca,Yab:ia,tzb:oa,uzb:sa,k8f:Ca}=y.Dcg(C,ba,ha,ka,ca,ia,oa,sa,Ca));m=[B,H,K,A,W,N,P,U,Q,G,Y,ka,ca,ia,oa,sa,Ca,Ta];for(var R of m)y.R_l(R);R=[B,H,K,W,P,U,G,Y,ca,oa,sa,Ca];for(const Ha of R)y.ahf(Ha);y.yGh(H);y.dMh(ha,0);y.Vhj(B,H,K,A,W,N,P,U,Q,G,Y,ba,ha,ka,ca,ia,oa,sa,Ca,Ta,F,E);y.NBi(N,P)}static uKl(m,C){y.sJh(m,null,C,!1)}static NBi(m,C){m&&C&&(m.style.marginTop=(C.offsetHeight-m.offsetHeight)/2+"px")}static ecg(m,C,E,F,B,
H,K,A,W,N,P,U,Q){for(let G=0;m&&G<m.childNodes.length;G++){const Y=m.childNodes[G],ba=w.a.sma(Y),ha=!!Y.id;-1!==ba.indexOf("cui-QATRowLeft")?C=Y:-1!==ba.indexOf("cui-QATRowCenter")?E=Y:-1!==ba.indexOf("cui-QATRowRight")?F=Y:-1!==ba.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?B=Y:Y.id===k.CuiHelper.o2d?H=Y:Y.id===k.CuiHelper.Tdg?K=Y:Y.id===k.CuiHelper.p2d?A=Y:Y.id===k.CuiHelper.q2d?W=Y:ha&&y.Nhk(Y)?N=Y:-1!==ba.indexOf("UsernameNameContainer")?P=Y:-1!==ba.indexOf("UsernameNameItem")?U=Y:-1!==ba.indexOf("FreemiumUpsellButton")&&
(Q=Y);({n8f:C,m8f:E,o8f:F,Wab:B,Xab:H,HUa:K,KU:A,ww:W,IUa:N,xR:P,JUa:U,p8f:Q}=y.ecg(Y,C,E,F,B,H,K,A,W,N,P,U,Q))}return{n8f:C,m8f:E,o8f:F,Wab:B,Xab:H,HUa:K,KU:A,ww:W,IUa:N,xR:P,JUa:U,p8f:Q}}static Dcg(m,C,E,F,B,H,K,A,W){for(let N=0;m&&N<m.childNodes.length;N++){const P=m.childNodes[N],U=w.a.sma(P),Q=!!P.id;-1!==U.indexOf("cui-jewel-container")?C=P:-1!==U.indexOf("cui-tts")?E=P:-1!==U.indexOf("cui-TabRowInline")?B=P:-1!==U.indexOf("cui-TabRowRight")?W=P:-1!==U.indexOf("cui-separator")?F=P:Q&&P.id.startsWith(k.CuiHelper.orh)&&
!H?H=P:Q&&P.id.startsWith(k.CuiHelper.vbg)?K=P:Q&&P.id.startsWith(k.CuiHelper.qXe)&&(A=P);({I8b:C,$H:E,l8f:F,j8f:B,Yab:H,tzb:K,uzb:A,k8f:W}=y.Dcg(P,C,E,F,B,H,K,A,W))}return{I8b:C,$H:E,l8f:F,j8f:B,Yab:H,tzb:K,uzb:A,k8f:W}}static qKl(m,C,E,F,B,H,K,A,W){y.WS(m,C,W)&&(y.P3c(C),y.WS(m,C,W)&&y.P3c(C));y.WS(C,F,W)&&(y.GM(E),y.GM(B),y.WS(C,F,W)&&(y.P3c(C),y.WS(C,F,W)&&(y.P3c(C),y.WS(C,F,W)&&y.GM(F))));y.WS(F,A,W)&&(y.GM(E),y.GM(B));m=[H,K,A];y.cvg(F,A,m,W);y.cvg(C,A,m,W)}static cvg(m,C,E,F){let B=0;for(;B<
E.length&&y.WS(m,C,F);)y.GM(E[B]),B++}static VKj(m){if(!m)return 0;if(void 0===m._scaleStep||null===m._scaleStep){let C=0;-1!==m.className.indexOf("cui-tts-scale1")?C=1:-1!==m.className.indexOf("cui-tts-scale2")&&(C=2);m._scaleStep=C}return parseInt(m._scaleStep)}static P3c(m){let C=y.VKj(m);2>C&&y.dMh(m,++C)}static dMh(m,C){m&&(m.className=y.UHl[C],m._scaleStep=C)}static WS(m,C,E){return m&&C?D.a.BIg(D.a.wi(m),D.a.wi(C),E):!1}static KMb(m,C,E){let F=0;m&&C&&(F=D.a.Jze(D.a.wi(m),D.a.wi(C),E));return F}static O6d(m){for(let C=
0;m&&C<m.childNodes.length;C++)if(-1!==m.childNodes[C].className.indexOf("cui-cg"))return!0;return!1}static Dhe(m){let C=null;for(let E=m.childNodes.length-1;m&&0<=E;E--){const F=m.childNodes[E];if(-1===F.className.indexOf("cui-cg"))break;C=F}return C}static VTb(m,C,E){if(m&&!y.Hn(m)){var F=r.a.Tu(m);F=w.a.LN(F.paddingLeft)+w.a.LN(F.paddingRight);E=m.offsetWidth-E-F;let B=0;for(;C&&C!==m;)(F=r.a.Tu(C))&&(B+=w.a.LN(F.paddingLeft)+w.a.LN(F.paddingRight)),C=C.parentNode;E=Math.max(E,75+B);m.style.width=
E+"px"}}static QEl(m,C,E){if(m&&C){let F=0,B=0;({left:F,top:B}=D.a.Oig(C,F,B));y.KYk(m,E?F-m.offsetWidth:F+C.offsetWidth)}}static Vhj(m,C,E,F,B,H,K,A,W,N,P,U,Q,G,Y,ba,ha,ka,ca,ia,oa,sa){oa&&y.qKl(U,Q,G,Y,ba,ha,ka,ca,sa);y.O6d(Q)?y.zKl(Q,m,C,E,F,B,H,K,A,W,N,P,ia,sa):y.yKl(m,C,E,F,B,H,K,A,W,N,P,ia,sa)}static yKl(m,C,E,F,B,H,K,A,W,N,P,U,Q){const G=!!B,Y=!!K,ba=!!A;let ha=0;if((Y||ba)&&0<(ha=y.KMb(m,C,Q))){let ka=Y;ba&&(!Y||A.offsetWidth>K.offsetWidth)&&(ka=!1);y.VTb(ka?K:A,ka?K:A,ka?ha:2*ha);Y&&ba&&
0<(ha=y.KMb(m,C,Q))&&y.VTb(ka?K:A,ka?K:A,ka?ha:2*ha)}if(Y&&y.WS(K,C,Q)||G&&y.WS(B,C,Q))y.GM(F),y.GM(B),y.GM(H),y.GM(K),ba&&(y.ahf(C),y.ahf(A));y.zCh(C,E,A,W,N,P,U,Q);ba&&y.pVf(A,m,E,Q)}static zKl(m,C,E,F,B,H,K,A,W,N,P,U,Q,G){const Y=!!A,ba=!!W,ha=!!N,ka=!!Q,ca=y.Dhe(m);0<(C=y.KMb(C,ca,G))&&(Y&&y.VTb(A,A,C),!Y||y.WS(A,ca,G))&&(y.GM(B),y.GM(H),y.GM(K),y.GM(A));y.WS(m,E,G)&&y.QEl(E,m,G);y.zCh(E,F,W,N,P,U,Q,G);0<(C=y.KMb(m,F,G))&&(y.VTb(P,U,C),ka&&y.WS(m,F,G)&&y.GM(Q),ha&&y.WS(m,F,G)&&y.GM(N));ba&&!y.Hn(E)&&
y.pVf(W,m,F,G)}static zCh(m,C,E,F,B,H,K,A){const W=!!E,N=!!F,P=!!B,U=!!K;let Q=0;if((W||P)&&0<(Q=y.KMb(m,C,A))){const G=!!m&&"absolute"!==m.style.position;let Y=W;P&&(!W||B.offsetWidth>E.offsetWidth)&&(Y=!1);y.VTb(Y?E:B,Y?E:H,Y&&G?2*Q:Q);W&&P?(0<(Q=y.KMb(m,B,A))&&(Y=!Y,y.VTb(Y?E:B,Y?E:H,Y&&G?2*Q:Q)),y.WS(m,B,A)&&y.GM(m)):W&&y.WS(m,C,A)&&y.GM(m)}U&&y.WS(m,C,A)&&y.GM(K);N&&y.WS(m,C,A)&&y.GM(F)}static Hn(m){if(!m)return!0;m=m._isHidden;return!(void 0===m||null===m||"0"===m)}static GM(m){m&&!y.Hn(m)&&
(m.style.display="none",m._isHidden="1")}static R_l(m){m&&y.Hn(m)&&(m.style.display="",m._isHidden="0")}static ahf(m){m&&(m.style.width="auto",m.style.maxWidth="none")}static KYk(m,C){m&&(m.style.position="absolute",m.style.left=C+"px")}static yGh(m){m&&(m.style.position="static",m.style.left="auto")}static pVf(m,C,E,F){if(m&&m.parentNode&&m.parentNode.parentNode){var B=y.Efl(m);"auto"!==m.parentNode.style.width&&(m.style.width=m.parentNode.offsetWidth-B+"px");var H=F?E:C;C=F?C:E;E=D.a.wi(m.parentNode.parentNode);
H=H?D.a.wi(H):new Sys.UI.Bounds(E.x,0,0,0);C=C?D.a.qGa(C):new Sys.UI.Point(E.x+E.width,0);"absolute"===m.parentNode.style.position?B=C.x-(H.x+H.width)-B-1:(E=D.a.wi(m.nextSibling?m.parentNode:m),E=E.x+E.width/2,B=2*Math.min(E-(H.x+H.width),C.x-E)-B-1);m.style.maxWidth=B+"px"}}static Efl(m){var C=r.a.Tu(m);C=C?w.a.LN(C.paddingLeft)+w.a.LN(C.paddingRight):0;var E=r.a.Tu(m.parentNode);E=E?w.a.LN(E.paddingLeft)+w.a.LN(E.paddingRight):0;let F=0;for(;m.nextSibling;)m=m.nextSibling,F+=m.offsetWidth;return C+
E+F}static Nhk(m){return!!m.id&&(m.id.startsWith(k.CuiHelper.v9e)||m.id.startsWith(k.CuiHelper.Kvd))}}y.UHl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(L.a)(y,"RibbonTabScalingActor",null,[])},685:function(L,V,d){d.d(V,"a",function(){return m});L=d(0);var k=d(395),e=d(7),n=d(25),r=d(136),w=d(54),D=d(182),y=d(109);class m{constructor(){this.s4=null}kEd(){try{this.s4||(this.s4=w.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(C){k.ULS.sendTraceTag(51689674,1300,10,
"Unable to resolve ISearchOAuthManager: "+C)}}Ile(C,E){return this.s4?this.s4.getToken(C,E):new Promise(F=>{w.a.instance.Ha("Common.App.SearchCommon.ISearchOAuthManager").execute(B=>{B?(this.s4=B,this.s4.getToken(C,E).then(H=>F(H))):F(null)})})}WEj(){this.kEd();return this.s4?this.s4.getToken("Search",n.AFrameworkApplication.dBe):null}ppg(){if("Dev Box"===n.AFrameworkApplication.fa.Ea("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(C=>
{window.setTimeout(()=>{C(window.TellMeSubstrateTokenOverride)},750)});this.kEd();return this.s4?this.s4.getToken("Search",n.AFrameworkApplication.zcf):null}hPj(){this.kEd();return this.s4?this.s4.getToken("Search",this.ePj()):null}ePj(){return n.AFrameworkApplication.fa.Ea("TellMeServiceAuthEndpointForSearch")}IMj(){if("Dev Box"===n.AFrameworkApplication.fa.Ea("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(C=>
{window.setTimeout(()=>{C(window.TellMeSubstrateTokenOverride)},750)});this.kEd();return this.s4?this.s4.getToken("SmartLookup",this.HMj()):null}HMj(){return n.AFrameworkApplication.fa.Ea("SmartLookupShredderServiceEndpoint")}XEj(){return Object(e.a)(this,this.WEj,"getLokiTokenPromise")}kOj(){return Object(e.a)(this,this.ppg,"getSubstrateTokenPromise")}RRb(){return!!n.AFrameworkApplication.za&&n.AFrameworkApplication.za.mb.RRb}eQj(){const C={};this.RRb()&&(C.Loki=this.XEj(),C.Substrate=this.kOj());
return C}zhc(C){r.a.oNa(Object.assign(new D.a,{name:"Events",dataFields:[Object.assign(new y.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new y.a,{name:"Status",bool:C})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}fyk(){return n.AFrameworkApplication.fa.getBooleanAppSetting("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.zhc(!1);return!1}).then(()=>{this.zhc(!0);return!0}):new Promise((C,E)=>{const F=w.a.instance.resolve("Common.IDynamicScriptLoaderProvider").nG;
F?F.loadScript("tellme-strings").then(()=>{this.zhc(!0);C(!0)}).catch(()=>{this.zhc(!1);E(!1)}):(this.zhc(!1),E(!1))})}static Lpk(){return!!n.AFrameworkApplication.za&&(n.AFrameworkApplication.za.mb.mgc||n.AFrameworkApplication.za.mb.TEb)}static J8c(){return!!n.AFrameworkApplication.za&&n.AFrameworkApplication.za.mb.TEb}}Object(L.a)(m,"ReactSharedHeaderSearchUtils",null,[])},686:function(L,V,d){d.d(V,"a",function(){return m});L=d(0);var k=d(395),e=d(46),n=d(962),r=d(28),w=d(43),D=d(76),y=d(33);class m{constructor(C){this.$Qa=
void 0===C?2E3:C}Ugk(){const C=m.ZX();return this.dtk(C)}dtk(C){return 0<this.Q1c(C).mentionLength}getSelectedText(){const C=m.ZX();return this.Q1c(C)}Q1c(C){return this.wLj(C)}wLj(C){var E=null;C&&C.zea&&w.SelectionEditor.nh(C.Ua)&&w.SelectionEditor.QEb(C.Ua)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),E=w.SelectionEditor.VUa(C.Ua,!1));E&&(C=E);if(!C)return Object.assign(new n.a,{neighborhood:"",mentionStart:0,mentionLength:0});const F=new Sys.StringBuilder;
let B=E=0;const H=[],K=C.length;for(let W=0;W<K;W++){const N=C.ga(W);if(!y.ParagraphReader.ke(N.node)||Array.contains(H,N.node.MOa))continue;H.push(N.node.MOa);let P=y.ParagraphReader.text(N.node),U=0;var A=y.ParagraphReader.uva(N.node,!0,!0,!0);let Q=y.ParagraphReader.uva(N.node,!1,!0,!0),G=0;for(;P.length<this.$Qa&&(A||Q);){if(!(G%2)&&A){const Y=y.ParagraphReader.text(A);P=Y+" "+P;U+=Y.length+1;A=y.ParagraphReader.uva(A,!0,!0,!0)}1===G%2&&Q&&(P=P+" "+y.ParagraphReader.text(Q),Q=y.ParagraphReader.uva(Q,
!1,!0,!0));G++}A=W===K-1;W||-1===N.Ra||(E=N.Ra);B+=A&&-1!==N.Pb?N.Pb:P.length;F.append(P);E+=U;B+=U;A||(F.append(" "),B++)}for(C=D.AParagraphNode.fvd(F.toString()," ");E<B&&e.a.fA(C.charCodeAt(E));)E++;for(;B>E&&e.a.fA(C.charCodeAt(B-1));)B--;return this.kCi(C,E,B)}kCi(C,E,F){if(C.length>this.$Qa){var B=F-E;if(B>this.$Qa)C=C.substr(E,this.$Qa),F=this.$Qa,E=0;else{B=Math.max(E-Math.floor((this.$Qa-B)/2),0);let H;H=Math.min(B+this.$Qa,C.length);B=Math.max(H-this.$Qa,0);E-=B;F-=B;C=C.substring(B,H)}}return Object.assign(new n.a,
{neighborhood:C,mentionStart:E,mentionLength:F-E})}static ZX(){var C=r.App.Ob.ie.yo;if(!C)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;C=C.Rb;return C&&C.Oa&&C.Oa.length?C.Oa.kb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(L.a)(m,"Box4InsightsSelection",null,[1011,1012])},687:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(L.a)(k,
"NewOutlineElementInfo",null,[])},688:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Knd="Listening";k.QLb="Warning";k.$0a="Error";Object(L.a)(k,"VoiceNotificationResourceStrings",null,[])},689:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.CoachButton="coachButton";k.MicButton="micButton";k.PrevButton="prevButton";k.NextButton="nextButton";k.GridButton="gridButton";k.InkButton="inkButton";k.SubtitlesButton="subButton";k.LiveButton="liveButton";k.MoreButton="moreButton";
k.ExitButton="exitButton";k.CameraButton="cameraButton";k.OptionsButton="optionsButton";Object(L.a)(k,"SlideshowToolbarButtonIDs",null,[])},690:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.PEm=2]="userUnsupportedAnonymous";e[e.QEm=3]="userUnsupportedNoLoginHint";e[e.qvm=4]="hostUnsupported";e[e.dCm=5]="perfAutomation"})(k||(k={}));Object(L.b)("SupportStatus",k)},691:function(L,V,d){d.d(V,"a",function(){return k});
L=d(0);d=d(450);class k extends d.a{constructor(e){super();this.shapeNode=e}get NDg(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}Object(L.a)(k,"InternalClipboardShape",d.a,[])},692:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(981);class k extends d.a{constructor(e,n,r){super(e,n);this.VSh=r}}Object(L.a)(k,"ClipServiceSlideCopyParams",d.a,[])},693:function(L,V,d){d.d(V,"a",function(){return e});
L=d(0);var k=d(41);class e{constructor(n,r){this.ljb=!1;this.TKd=this.mGf=-1;this.gy=n;r&&this.start()}start(){this.ljb=!0;this.TKd=-1;const n=k.a.A_();n&&(this.mGf=n)}stop(){this.ljb=!1;const n=k.a.A_();n&&0<this.vca&&n>=this.vca&&(this.TKd=n-this.vca)}get operation(){return this.gy}get eWc(){return this.TKd}get vca(){return this.mGf}}Object(L.a)(e,"PPTStopwatch",null,[])},694:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(232);class e{}var n=e;e.sIh={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",
aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",
darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",
hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",
linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",
palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",
steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e.DTa=r=>{r=r.toLowerCase().trim().replace(/\s/g,"");return e.sIh[r]?e.sIh[r]:""};e.VUf=r=>r?""!==n.DTa(r):!1;e.Owj=r=>{var w=/^#([0-9a-f])*$/i;if(!r||!r.match(w))throw Error("invalid hex color string provided");w=new k.Color;switch(r.length){case 7:w.a=1;w.r=parseInt(r.substring(1,3),16);
w.g=parseInt(r.substring(3,5),16);w.b=parseInt(r.substring(5,7),16);break;case 9:w.r=parseInt(r.substring(1,3),16);w.g=parseInt(r.substring(3,5),16);w.b=parseInt(r.substring(5,7),16);w.a=parseInt(r.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return w};Object(L.a)(e,"ColorTranslator",null,[])},695:function(L,V,d){d.d(V,"a",function(){return D});L=d(0);var k=d(1273),e=d(40),n=d(38),r=d(57),w=d(41);class D{static bUc(y,m,C,E,F,B,H,K,A,W,N,P,U,Q,G){B=P.cFa(!1,y.cid,
y.sid,0,m.shapeType,B,H,K,A,W+1);B.setValue(n.a.fM,m.Hia);const {TOh:Y,LOh:ba}=F.oog(E,m,C,G,U,Q);E=U.Xd;B.setValue(e.a.zy,E.Cf(G.dJ(Y,C),0));B.setValue(e.a.XD,E.Cf(G.dJ(ba,C),1));B.setValue(n.a.eVb,B.zy);B.setValue(n.a.zCb,B.XD);B.setValue(n.a.yvd,!0);B.Qea=k.a.gMa(Y,0);B.Pea=k.a.gMa(ba,1);B.setValue(n.a.BUa,0);B.setValue(n.a.CUa,0);B.setValue(n.a.VXa,!0);B.setValue(n.a.isResizable,!0);B.setValue(n.a.SM,!0);B.kP=!0;B.QXa=!0;G=(E=95===m.Hia||97===m.Hia)||Array.contains(D.Oze,m.Hia);B.SM=!E;B.isResizable=
!0;B.setValue(n.a.dA,E);B.setValue(n.a.v1,95===m.Hia);B.tH=r.a.Aq(y.sid,y.cid);B.Kob=B.get_shapeId();B.setValue(n.a.bwa,!0);y=F.t0f(Y,ba,C);B.ZS=y;(N.TM(B)||N.jna(B))&&w.a.Kb&&(w.a.Kb.tk=!0);G?F.vMh(B):F.GMh(B);return B}}D.Oze=[88,93,94,89,90,91,92];Object(L.a)(D,"InsertContentShapeNodeFactory",null,[])},696:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n,r,w){this.Hia=e;this.shapeType=n;this.height=r;this.width=w}}Object(L.a)(k,"AutoShapeProps",null,[])},697:function(L,
V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return n});var k=d(46);const e=r=>{r=btoa(r);r=r.replace(RegExp("\\+","g"),"-");r=r.replace(RegExp("\\/","g"),"_");return r=r.replace(RegExp("\\=+$","g"),"")},n=r=>{if(k.a.Ta(r))return null;const w=RegExp("%([0-9A-F]{2})","g");r=encodeURIComponent(r);let D="",y=0,m;for(;m=w.exec(r);){const C=w.lastIndex-3;C>y&&(D+=r.substring(y,C));D+=k.a.fromCharCode(parseInt(String("0x"+m[1])));y=w.lastIndex}y<r.length&&(D+=r.substring(y,r.length));return btoa(D)}},
698:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Lzb="extId";k.Sxb="ComponentType";k.Vta="ComponentId";k.x5j="HostProps";k.Zkb="OptionalProps";Object(L.a)(k,"ActionPropertyNames",null,[])},699:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.OK=0]="OK";e[e.yBm=1]="notReady";e[e.dEm=2]="storeDisabled";e[e.Evm=3]="invokeFailure";e[e.BDm=4]="serviceDisabled"})(k||(k={}));Object(L.b)("AddinDetailsQueryError",k)},700:function(L,V,d){d.d(V,"a",function(){return y});
L=d(0);var k=d(25),e=d(160),n=d(94),r=d(7);V=d(18);var w=d(27),D=d(70);class y{constructor(m,C,E,F,B,H,K,A,W,N,P,U,Q,G){this.e7=this.wm=this.Gy=null;this.DUf=!0;this.QZa=m;this.xUk=C;this.tJk=E;this.Wjc=F;this.L6=H;this.ic=K;this.fe=A;this.ff=W;this.kUk=N;this.Thb=P;this.eNk=U;this.dNk=Q;this.cNk=G;this.zK=B}openDialog(){this.u3i();k.AFrameworkApplication.za.Glb();try{this.wm.click()}catch(m){const C=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",m.message,m.stack);
w.a.J(509727820,818,10,C);throw m;}}submit(){const m=this.wm.files[0];this.e7=this.tJk();this.e7.FTe&&this.e7.FTe(this.L6,this.ic,this.fe,this.ff);if(this.kUk)this.wlm(m);else{const C=new FormData;for(const F of this.e7.D_d)C.append(F.key,F.value);C.append("fileInputId",m,m.name);const E=new XMLHttpRequest;E.onreadystatechange=()=>{this.BMb(E)};E.open("POST",this.e7.gvh);E.send(C)}}BMb(m){if(4===m.readyState){const C=m.status;!C||C>=e.a.Zw&&C<e.a.BHi?this.e7.uu&&this.e7.uu(m.responseText,this.L6,
this.ic,this.fe,this.ff,this.wm):this.e7.wA&&this.e7.wA(m.responseText,this.L6,this.ic,this.fe,this.ff);this.dispose()}}wlm(m){this.Thb().s_(this.Wjc,this.zK,m.size,m,this.e7.D_d.ga("MediaToken"),this.ff,this.eNk,this.dNk,this.cNk,C=>{this.e7.uu&&this.e7.uu(C.result,this.L6,this.ic,this.fe,this.ff,this.wm)},C=>{this.e7.wA&&this.e7.wA(C.error.Code.toString(),this.L6,this.ic,this.fe,this.ff)})}dispose(){this.Gy&&(n.a.removeHandler(this.wm,"change",Object(r.a)(this,this.VXc,"fileInputChange")),document.body.removeChild(this.Gy),
this.wm=this.Gy=null,y.hif.remove(this))}u3i(){this.Gy||(this.Gy=document.createElement("form"),this.Gy.id="uploadFormId",this.Gy.style.visibility=D.a.hidden,this.Gy.method="post",this.Gy.encoding="multipart/form-data",this.Gy.action="",this.wm=document.createElement("input"),this.wm.style.visibility=D.a.hidden,this.wm.type="file",this.wm.id="uploadFileInputId",this.wm.name="uploadFileInputId",this.wm.accept=this.QZa,this.Gy.appendChild(this.wm),document.body.appendChild(this.Gy),n.a.addHandler(this.wm,
"change",Object(r.a)(this,this.VXc,"fileInputChange")))}VXc(){this.wm.value&&this.wm.value.length?(this.DUf=!1,this.xUk(this.wm,this.fe,this.ff,this.Wjc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static Baf(m,C,E,F,B,H,K,A,W,N,P,U,Q,G){for(const Y of y.hif)Y.DUf&&Y.dispose();m=new y(m,C,E,F,B,H,K,A,W,N,P,U,Q,G);y.hif.add(m);m.openDialog()}}y.hif=new V.a;Object(L.a)(y,"UploadFileDialog",null,[])},701:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(67),e=d(7),
n=d(387),r=d(120);class w{constructor(D,y,m,C,E,F,B,H,K,A,W,N){this.V2d=1;this.q6=y;this.ul=D;this.SGk=m;this.Ye=K;this.Ts=A;this.hd=W;this.bjb=H;this.fhd=E;this.ghd=C;this.F6=F;this.Ye.addCssClass(this.ul,"prControl");this.ul.style.width=this.Ye.Rc(y);this.Gw=B.C6i();this.rdd=B.B6i();this.Gw.fTa(D);this.rdd.fTa(D,y,y);this.Nnc=N;this.NMa()}dispose(){this.Hgf();this.clear();this.Gw.dispose();this.rdd.dispose();this.Ye.removeCssClass(this.ul,"prControl")}get A1a(){return r.a.none}clear(){this.vTa();
this.N4d();this.W4e()}setZIndex(D){this.ul.style.zIndex=String(D)}XQe(){this.Nnc.va.style.zIndex=String(this.V2d+n.a.hja)}W4e(){this.Nnc.va.style.zIndex="0"}aMh(D,y,m){D=this.bjb.X0f(this.q6,this.q6,this.SGk,D,"",void 0===m?null:m);this.Gw.xNa(D,y)}K2b(D,y){this.rdd.add(D,y)}N4d(){this.rdd.clear()}vTa(){this.Gw.clear()}onClick(){return!0}NMa(){this.ghd&&this.Ts.xb(k.a.aD,this.ul,this.ghd);this.fhd&&this.Ts.xb(k.a.qE,this.ul,this.fhd);this.F6?this.hd.xb(k.a.click,this.ul,this.F6):this.hd.xb(k.a.click,
this.ul,Object(e.a)(this,this.onClick,"onClick"));this.hd.xb(k.a.doubleClick,this.ul,Object(e.a)(this,this.onClick,"onClick"))}Hgf(){this.ghd&&this.Ts.Hb(k.a.aD,this.ul,this.ghd);this.fhd&&this.Ts.Hb(k.a.qE,this.ul,this.fhd);this.F6?this.hd.Hb(k.a.click,this.ul,this.F6):this.hd.Hb(k.a.click,this.ul,Object(e.a)(this,this.onClick,"onClick"));this.hd.Hb(k.a.doubleClick,this.ul,Object(e.a)(this,this.onClick,"onClick"))}}Object(L.a)(w,"ShapePawn",null,[723])},720:function(L,V,d){d.r(V);L=d(0);var k=d(395),
e=d(181),n=d(956),r=d(1135),w=d(25),D=d(1134),y=d(7),m=d(1265),C=d(1264),E=d(28),F=d(471);class B extends F.a{constructor(R,Ha,da,Ba,za,Aa){super();this.init(R);this.Fm("DummyClipboardOperation");this.eHa(w.AFrameworkApplication.Pa,Ha,Ba,za,Aa);this.ew=da;this.Op=8;this.i_()}Lh(){this.EQa=!0;this.Hnb(this.ew);this.hqa();this.Op=32}}Object(L.a)(B,"DummyClipboardOperation",F.a,[]);var H=d(99),K=d(129),A=d(118),W=d(60);class N{constructor(R,Ha,da){k.ULS.shipAssertTag(6305502,307,!!R);this.properties=
R;this.yd=Ha;this.Xsa=da}get fd(){return this.yd}Bmg(){return this.properties.ra(W.a.bW,"")}hwh(){return!0}o_h(){let R,Ha=!1;R=null;const da=this.Bmg();if(this.Xsa||""!==da)try{({Oab:R,returnValue:Ha}=this.jgf(da))}catch(Ba){k.ULS.shipAssertTag(4203138,307,!1),this.fd.kc(K.a.ama,{["Reason"]:A.a.DRf}),H.a.EEa(R)}else k.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.fd.kc(K.a.C3,{["Reason"]:A.a.sce});return{returnValue:Ha,QSc:R}}}Object(L.a)(N,"AStringInputImportStrategy",null,[1845]);
class P extends N{constructor(R,Ha,da,Ba,za){super(R,Ha,za);this.Kk=da;this.mVd=Ba}jgf(R){const {ClipboardActor:Ha}=d(720);let da;if(this.Xsa&&!R)return k.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Oab:null};da=null;if(this.Xsa)return da=this.Kk.WLa(R),{returnValue:!0,Oab:da};if(this.mVd){const Ba=this.properties.ra(W.a.iXe,"");Ba&&(da=this.Kk.WLa(Ba))}da||(k.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),
da=Ha.Cth,da.innerHTML=R);return{returnValue:!0,Oab:da}}}Object(L.a)(P,"HtmlStringImportStrategy",N,[]);var U=d(46);class Q extends N{constructor(R,Ha,da){super(R,Ha,da)}jgf(R){let Ha;if(this.Xsa&&!R)return k.ULS.sendTraceTag(541172642,307,10,"No htmlDomContent"),{returnValue:!1,Oab:null};Ha=document.createElement("div");R=R.split(RegExp("\r\n|\r|\n"));for(var da=0;da<R.length-1;da++){const Ba=document.createElement("p");Ba.innerText=this.Rze(R[da]);Ha.appendChild(Ba)}da=document.createElement("span");
da.innerText=U.a.lbe(R[R.length-1]);Ha.appendChild(da);return{returnValue:!0,Oab:Ha}}Rze(R){return U.a.lbe(R.length?R:" ")}}Object(L.a)(Q,"MultiLineTextImportStrategy",N,[]);class G extends Q{constructor(R,Ha,da){super(R,Ha,da)}Bmg(){return this.properties.ra(W.a.klb,"")}Rze(R){R=super.Rze(R);return R.length&&" "!==R?R:"\u00a0"}}Object(L.a)(G,"MultiLinePlainTextImportStrategy",Q,[]);class Y extends N{constructor(R,Ha,da){super(R,Ha,da)}jgf(R){var {ClipboardActor:Ha}=d(720);if(this.Xsa&&!R)return k.ULS.sendTraceTag(541172641,
307,10,"No htmlDomContent"),{returnValue:!1,Oab:null};Ha=Ha.Cth;Ha.innerText=R;return{returnValue:!0,Oab:Ha}}}Object(L.a)(Y,"PlainTextImportStrategy",N,[]);var ba=d(396);class ha{constructor(R){this.Bg=this.$we=!1;this.m0=R}hwh(){this.$we||(this.$we=!0,this.Bg=!1,this.m0.prepareForPaste(()=>{this.Bg=!0}));return this.Bg}o_h(){this.$we=!1;const R=this.m0.paste();return R?R.hasChildNodes()?{returnValue:!0,QSc:R}:(k.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),ha.fd.kc(K.a.C3,{["Reason"]:A.a.sce}),
{returnValue:!1,QSc:R}):(k.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),ha.fd.kc(K.a.rbb,{["Reason"]:A.a.gdf}),{returnValue:!1,QSc:R})}static get fd(){return ba.a.instance}}Object(L.a)(ha,"SystemClipboardImportStrategy",null,[1845]);var ka=d(63),ca=d(39),ia=d(50),oa=d(37),sa=d(34),Ca=d(266);d.d(V,"ClipboardActor",function(){return Ta});class Ta{constructor(R,Ha,da,Ba,za,Aa,na,la){this.Iof=null;this.tZb=0;this.sbi=R;this.m0=Ha;this.yd=da;this.Kk=Ba;this.Vc=za;this.Ca=Aa;this.$t=
na;this.nxf=!!la&&la.getBooleanAppSetting("SupportImageDragDropExternalIsEnabled");this.xVd=!!la&&la.getBooleanAppSetting("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.ML=new Ca.a;this.ML.$(sa.a.paste,257);this.ML.$(sa.a.O2,8449);this.ML.$(sa.a.F9,1);this.ML.$(sa.a.Pyg,513);this.ML.$(sa.a.reformatPastedContent,4097);this.ML.$(sa.a.bPb,20481);this.ML.$(sa.a.n2a,12289);this.ML.$(sa.a.ird,7);this.ML.$(sa.a.hrd,1);this.ML.$(sa.a.wth,8193);this.ML.$(sa.a.copy,272);this.ML.$(sa.a.gQc,16);this.ML.$(sa.a.cut,
304);this.ML.$(sa.a.l4b,48);this.ML.$(sa.a.Wmd,64);this.ML.$(sa.a.Xmd,64);this.ML.$(sa.a.showPlaceholderGlossary,65536);this.nxf&&this.ML.$(sa.a.f7f,1)}get HXf(){return this.sbi.value}get MB(){return this.m0}qb(){this.Ca.pa(sa.a.Tnl,oa.a.application,Object(y.a)(this,this.ntd,"queryPasteOptions"),97);this.Ca.pa(sa.a.Unl,oa.a.application,Object(y.a)(this,this.ntd,"queryPasteOptions"),97);this.xVd?this.Ca.pa(sa.a.zyh,oa.a.application,Object(y.a)(this,this.h0e,"queryReformatPasteOptions"),97):this.Ca.pa(sa.a.Ayh,
oa.a.application,Object(y.a)(this,this.h0e,"queryReformatPasteOptions"),97);this.Ca.pa(sa.a.Byh,oa.a.application,Object(y.a)(this,this.h0e,"queryReformatPasteOptions"),97);this.Ca.gU(sa.a.l4b,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.cut,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.PDa(sa.a.gQc,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"));this.Ca.PDa(sa.a.copy,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"));this.nxf&&this.Ca.gU(sa.a.f7f,
oa.a.view,Object(y.a)(this,this.Aej,"dropBrowserContent"),1028);this.Ca.gU(sa.a.F9,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.paste,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.O2,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.wth,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.hrd,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.ird,oa.a.view,Object(y.a)(this,
this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.bPb,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),4);this.Ca.gU(sa.a.reformatPastedContent,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.gU(sa.a.n2a,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"),1028);this.Ca.xa(sa.a.Rvd,oa.a.view,e.ActionManager.uh);this.Ca.xa(sa.a.ffl,oa.a.view,e.ActionManager.uh);this.Ca.xa(sa.a.Oth,oa.a.view,e.ActionManager.uh);this.Ca.xa(sa.a.Pth,oa.a.view,e.ActionManager.uh);this.Ca.xa(sa.a.Qth,
oa.a.view,e.ActionManager.uh);this.Ca.xa(sa.a.Nth,oa.a.view,e.ActionManager.uh);this.Ca.PDa(sa.a.Wmd,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"));this.Ca.PDa(sa.a.Xmd,oa.a.view,Object(y.a)(this,this.Xmd,"moveSelectedContentWithinCurrentParagraph"));this.Ca.PDa(sa.a.Pyg,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"));this.Ca.PDa(sa.a.showPlaceholderGlossary,oa.a.view,Object(y.a)(this,this.wU,"clipboardAction"));this.Ca.xa(sa.a.E2f,oa.a.view,e.ActionManager.uh);this.Ca.xa(sa.a.f3f,
oa.a.view,e.ActionManager.uh)}ntd(R,Ha,da,Ba,za){if(1===da)return 32;za[n.a.On]=!1;return 32}Aej(R,Ha,da,Ba,za,Aa){k.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var na=Aa.DataTransfer;Aa=na.getData("text/html");na=na.getData("text/plain");let la=!1;const va=new r.DictionaryPropertySet;0<Aa.length?(k.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),va.setValue(W.a.bW,Aa),la=!0):0<na.length&&(k.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),
va.setValue(W.a.klb,na),la=!0);if(la){const Pa=this.ML.ga(Ha);return this.HXf.create(R,Ha,Pa,new m.a(()=>this.b5f(Pa,va)),da,Ba,za,va)}return null}h0e(R,Ha,da,Ba,za){if(Ha=Object(C.a)(Object,za))!this.xVd&&R===sa.a.Ayh||this.xVd&&R===sa.a.zyh?(R=this.tZb!==sa.a.reformatPastedContent&&this.tZb!==sa.a.n2a,Ha[n.a.On]=this.tZb===sa.a.reformatPastedContent||R):R===sa.a.Byh&&(Ha[n.a.On]=this.tZb===sa.a.n2a);return 32}wU(R,Ha,da,Ba,za,Aa){const na=Date.now();if((w.AFrameworkApplication.cD||w.AFrameworkApplication.Tw)&&
!w.AFrameworkApplication.MUa||ca.a.instance.ga(83))return new B(R,Ha,da,Ba,za,Aa);const la=this.ML.ga(Ha);1!==Ba&&la&1&&(this.tZb=Ha);1!==Ba&&Aa&&la&1&&(this.Iof=Aa);1!==Ba&&!Aa&&la&4096&&(Aa=this.Iof);R=this.HXf.create(R,Ha,la,new m.a(()=>this.b5f(la,Aa)),da,Ba,za,Aa);w.AFrameworkApplication.Pa.XOb(Ha,"Box4ClipboardActionHandlerDuration",Date.now()-na);return R}Xmd(R,Ha,da,Ba,za,Aa){Aa=ia.a.rk(ka.a.instance.Oa.kb.Ua.node,Aa);return this.wU(R,Ha,da,Ba,za,Aa)}b5f(R,Ha){return R&256?new ha(this.MB):
R&2?R&4096?new P(Ha,this.yd,this.Kk,E.App.instance.Tec,E.App.instance.NRb):new Y(Ha,this.yd,E.App.instance.NRb):Ha&&Ha.Qa(W.a.klb)?new G(Ha,this.yd,E.App.instance.NRb):new P(Ha,this.yd,this.Kk,E.App.instance.Tec,E.App.instance.NRb)}static get Cth(){return D.a.Mcb("Box4PasteScratchPad")}}Object(L.a)(Ta,"ClipboardActor",null,[])},722:function(L,V,d){d.r(V);L=d(0);var k=d(395),e=d(1264),n=d(1268),r=d(1267),w=d(122),D=d(25),y=d(721),m=d(206),C=d(277),E=d(96),F=d(254),B=d(311),H=d(35),K=d(123),A=d(55),
W=d(46);class N{constructor(){this.cvFlights=this.uiHost=this.productName=null;this.isCopilotLicenseEnabled=this.isCVSurveyEnabled=!1}}Object(L.a)(N,"CustomerVoiceSurveyParams",null,[]);var P=d(136),U=d(540);class Q{sendTelemetryEvent(ca){const ia=new U.a;ia.otelEvent=ca;P.a.sendOtelEvent(ia)}}Object(L.a)(Q,"OtelTelemetrySink",null,[618]);class G{constructor(){this.userFactName=this.props=this.dedupIntervalSeconds=null}}Object(L.a)(G,"UserFactManifestParams",null,[]);class Y{sendTelemetryEvent(ca){const {BrowserFeedbackControlOCV:ia}=
d(722);try{ca&&ia.qml(ca)}catch(oa){k.ULS.Kqa(508871177,356,15,oa,"Telemetry Listener Error: "+oa.toString())}}}Object(L.a)(Y,"OCVTelemetryListener",null,[618]);var ba=d(583),ha=d(54);d.d(V,"BrowserFeedbackControlOCV",function(){return ka});class ka{static init(ca,ia,oa,sa,Ca){Ca.onDismiss=ca;Ca.onError=ia;ca=null;OfficeBrowserFeedback.initOptions?("screenshot"in Ca&&(OfficeBrowserFeedback.initOptions.screenshot=Ca.screenshot),"showEmailAddress"in Ca&&(OfficeBrowserFeedback.initOptions.showEmailAddress=
Ca.showEmailAddress),"feedbackForumUrl"in Ca&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=Ca.feedbackForumUrl),ca=Ca):OfficeBrowserFeedback.initOptions=Ca;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=ka.H1f());OfficeBrowserFeedback.multiFeedback(ca).then(()=>{k.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(Ta=>k.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+Ta.toString()))}static Ipe(ca,ia,oa,sa){k.ULS.sendTraceTag(36546398,
356,50,"BFCOCV.Entered InitSIFeedback");if(ka.Y6a===ka.iXa)return Promise.resolve(1);if(ka.Y6a===ka.Oxg)return ka.Pxg||(ka.Pxg=!0,k.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(ka.Y6a!==ka.error){ka.Y6a=ka.Oxg;k.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");if(ka.f9j(ca,ia,oa,sa))return D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)?ka.F8j(oa).then(()=>
ka.qxg()):ka.qxg();ka.Y6a=ka.error;Promise.reject(ka.hkh)}return Promise.reject(0)}static qxg(){try{return y.a.Ytl(ka.PDj(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>ka.Dbf())).catch(ca=>{let ia=10;ca&&ca.toString()&&K.a(ca.toString(),ka.Eyk)&&(ia=15);k.ULS.sendTraceTag(36546402,356,ia,"BFCOCV Floodgate initialize error:"+ca.toString())})}catch(ca){return k.ULS.Kqa(590975881,356,15,ca,"BFCOCV Floodgate initialize error:"+ca.toString()),Promise.reject(ka.I1k)}}static PDj(){return Object.assign(new ba.a,
{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static Dbf(){return OfficeBrowserFeedback.floodgate.start().then(()=>{ka.Epj()}).catch(ca=>{k.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+ca.toString())})}static Epj(){ka.Y6a=ka.iXa;k.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSendUserFacts",!1)&&D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTelemetryListener",
!1)&&P.a.addSink(new Y);try{const ca=D.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const ia of ca.split("|"))ia&&ka.logActivity(ia,null)}catch(ca){k.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static wwa(){let ca=!1;const ia=D.AFrameworkApplication.fa;ia&&(ca="teams"===(ia.Ea(D.AFrameworkApplication.uL)||"").toLowerCase());return A.a.gIa||ca}static Jgk(){return xR(function*(){try{yield ka.hGd();if(!(yield ka.vCi()))return!1;
try{if(yield ka.l1j())return ka.MAg=!0,k.ULS.sendTraceTag(508368331,356,50,"Promise - hasLicense resolved succesfully - true"),!0;k.ULS.sendTraceTag(508368330,356,50,"Promise - hasLicense resolved succesfully - false");return!1}catch(ca){return k.ULS.sendTraceTag(508368329,356,10,"Error resolving Promise for hasLicense "+(ca?ca.toString():"")),!1}}catch(ca){k.ULS.sendTraceTag(508368328,356,10,"Error resolving Promise for isCopilotLicenseConfigurationSuccessful "+(ca?ca.toString():""))}}())}static hGd(){return xR(function*(){return new Promise((ca,
ia)=>{try{D.AFrameworkApplication.fa.Ue(()=>{ca(!0);k.ULS.sendTraceTag(508368327,356,50,"Promise - waitFullAppSettingReady resolved succesfully")})}catch(oa){k.ULS.sendTraceTag(508368326,356,10,"Error resolving Promise for waitFullAppSettingReady "+(oa?oa.toString():"")),ia(oa)}})}())}static vCi(){return xR(function*(){try{const ca=ha.a.instance.Ha("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),ia=yield(yield ka.Nxh(ca)).UO("CopilotContentGeneration",!0);k.ULS.sendTraceTag(508368325,
356,50,"Promise - adminControlCopilotPolicyEnabled resolved succesfully");return!ia}catch(ca){k.ULS.sendTraceTag(508368324,356,10,"Error resolving Promise for adminControlCopilotPolicyEnabled "+(ca?ca.toString():""))}}())}static l1j(){const ca=this;return xR(function*(){const ia=ha.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");return(yield ka.Nxh(ia)).isFeatureEnabled(ca.vwk,!1)}())}static Nxh(ca){return new Promise((ia,oa)=>{try{ca.execute(sa=>ia(sa)),k.ULS.sendTraceTag(508368323,
356,50,"Promise - promisifyFuture resolved succesfully")}catch(sa){k.ULS.sendTraceTag(508368322,356,10,"Error resolving Promise for promisifyFuture "+(sa?sa.toString():"")),oa(sa)}})}static mkh(){return"undefined"==typeof OfficeBrowserFeedback}static f9j(ca,ia,oa,sa){let Ca=!0;try{if(ka.mkh())return k.ULS.sendTraceTag(39900617,356,15,ka.hkh),!1;OfficeBrowserFeedback.initOptions||(oa.onDismiss=sa,oa.onError=ia,oa=ka.MDi(oa),OfficeBrowserFeedback.initOptions=oa);OfficeBrowserFeedback.initOptions.telemetrySink||
(OfficeBrowserFeedback.initOptions.telemetrySink=ka.H1f());const Ha=ka.dAk;ia={};sa={};const da={};sa.onSurveyActivated=ka.B$k;sa.onTeachingCampaignRender=oa.onTeachingCampaignRender;da.LogExperimentTrigger=Ha;ia.onSurveyActivatedCallback=sa;ia.onDismiss=ca;ia.autoDismiss=oa.FloodgateUIAutoDismissTimeEnum;ia.telemetryGroup=oa.telemetryGroup;ia.uIStringGetter=oa.uIStringGetter;ia.authTokenCallback=oa.authTokenCallback;ia.augLoopCallback=oa.augLoopCallback;ia.campaignFlights="";ia.governanceServiceEnabled=
oa.governanceServiceEnabled;ia.governanceServiceConfig=oa.governanceServiceConfig;ia.personalizerEnabled=oa.personalizerEnabled;ia.messagingServiceSettings=oa.messagingServiceSettings;ia.isPriorityEnabled=oa.isPriorityEnabled;ia.enableWebCampaignGovernance=oa.enableWebCampaignGovernance;ia.logExperimentTrigger=da;ia.userFactsReadConfig=oa.userFactsReadConfig;D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.AppGovernanceProviderForSurveys",!1)&&D.AFrameworkApplication.vY&&(ka.Rbg.add(ka.dnj),
ca={},ca.getDecision=ka.Uyj,ia.appGovernanceProvider=ca);D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&("surveyEnabled"in oa&&(ia.surveyEnabled=oa.surveyEnabled),"showEmailAddress"in oa&&(ia.showEmailAddress=oa.showEmailAddress));ia.isEudbUxEnabled=!1;D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(ia.isEudbUxEnabled=!0);var Ta=ka.yyj(oa);const Ba=ka.sjg(Ta);let za=ka.Zyj(oa);
for(const na in Ba){Ta=na;var R=Ba[na];-1!==Ta.toLowerCase().indexOf("flight")?ia.campaignFlights+=R+";":za=za+Ta+"="+R+"&"}k.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+ia.campaignFlights+" campaignQueryParameters: "+za);ia.campaignQueryParameters=za;const Aa=ka.MAg;k.ULS.sendTraceTag(508368321,356,50,"isCopilotLicenseEnabled= "+Aa.toString());ia.customerVoiceSurveyParams=ka.Myj(oa.Application.toString(),ka.wwa()?ka.h9l:"",Aa);ka.I_c()&&(ia.dynamicUxConfig=oa.dynamicUxConfig);OfficeBrowserFeedback.floodgate.initOptions=
ia}catch(Ha){Ca=!1,k.ULS.sendTraceTag(39900618,356,15,Ha.toString())}return Ca}static Uyj(ca){if(ca=ca.getTags())for(const ia of ca)if(ka.Rbg.has(ia))return!0;return!1}static MDi(ca){try{const ia=ca.applicationGroup?ca.applicationGroup:{},oa=ia.appData,sa=oa?H.a(H.a('"'+oa+'"')):{};sa.fgUIAutoDismiss=ca.FloodgateUIAutoDismissTimeEnum;ia.appData=H.c(sa);ca.applicationGroup=ia}catch(ia){k.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",ia.toString())}return ca}static yyj(ca){ca=
Array.isArray(ca.Flights)?ca.Flights:null;ca||(ca=(ca=D.AFrameworkApplication.fa.Ea("FlightId"))?ca.toString().split(";"):null);if(D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const ia=D.AFrameworkApplication.fa.b$b;if(ia)for(const oa in ia){const sa={key:oa,value:ia[oa]};-1!==(sa&&sa.key?sa.key.toLowerCase():"").indexOf("floodgateflight")&&"unset"!==(sa&&sa.value?sa.value.toString().toLowerCase():"")&&ca.push(sa.key)}}return ca}static sjg(ca){const ia=
{SelfTriggerActivity:""};if(!ca||!ca.length)return ia;try{for(let Ca=0;Ca<ca.length;Ca++){let Ta=ca[Ca]?ca[Ca].toLowerCase():"";if(-1===Ta.indexOf("floodgateflight"))continue;const R=Ta.lastIndexOf(".");-1!==R&&(Ta=Ta.substring(R+1,Ta.length));if(-1!==("AppFlights"in ia?ia.AppFlights:"").indexOf(Ta))continue;ia.AppFlights="AppFlights"in ia?ia.AppFlights+(";"+Ta):Ta;const Ha=W.a.replaceAll(Ta,"-",""),da=D.AFrameworkApplication.fa.Ea(Ha);if(da)try{const Ba=H.a(da);Ba&&Ba.SelfTriggerActivity||(ia.SelfTriggerActivity+=
";"+Ha);if(Ba)for(const za in Ba){var oa=za,sa=Ba[za];oa in ia?ia[oa]!==sa&&(ia[oa]=ia[oa]+";"+sa):ia[oa]=sa}}catch(Ba){k.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+Ha+" json data",Ba.toString())}else ia.SelfTriggerActivity+=";"+Ha}}catch(Ca){k.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",Ca.toString())}return ia}static Zyj(ca){let ia="";const oa={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};
for(const Ta in oa){var sa=Ta,Ca=oa[Ta];let R=ca[Object(e.a)(String,Ca)];R||(R=D.AFrameworkApplication.fa.Ea(Object(e.a)(String,Ca)));R&&(ia+=sa+"="+encodeURIComponent(R)+"&")}return ia}static xPl(ca){ka.o9d=ca}static B$k(ca,ia,oa){if(ca)try{const Ca=ia?ia.getCampaignId():"",Ta=ia?ia.getLauncherType():"",R=oa?oa.contextInfo:null;var sa=ia?ia.getSurveyInfo():null;const Ha=sa?sa.getPreferredLaunchType():null,da=sa?sa.getMetadata():null,Ba=da?da.getContentMetadata():null,za=Ba?Ba.customSurveyName:null,
Aa=Ba?Ba.telemetryEventName:null;ka.qfk(Ca)?k.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+Ca):(D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.AppGovernanceProviderForSurveys",!1)&&D.AFrameworkApplication.vY&&k.ULS.sendTraceTag(512312960,356,50,"BFCOCV.onSurveyActivated Initiated survey activation for campaign - {0} during Live session",Ca),sa={},sa.campaignId=Ca,sa.surveyName=za,sa.launcherType=Ta,sa.contextInfoLength=R?R.length.toString():
"-1",sa.preferredLaunchType=Ha,sa.telemetryEventName=Aa,k.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(sa)),Ta&&"coachingux"===Ta.toLowerCase()&&Ha&&"default"!==Ha.toLowerCase()&&ka.Etg(Ba,ia,oa)?k.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(sa)):(ca.launch(oa),ka.AOh()))}catch(Ca){k.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(Ca?Ca.toString():
""))}else k.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static Ghe(ca){if(!ca||D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const ia=(D.AFrameworkApplication.fa.Ea("FlightId")||"").toLocaleLowerCase(),oa=ca.toString().toLocaleLowerCase().split(";");for(const sa of oa)if(-1!==ia.indexOf(sa))return sa}catch(ia){k.ULS.sendTraceTag(508961430,306,50,"Error retrieving flightId of campaign event -"+
(ia?ia.toString():""))}return null}static dAk(ca){for(const ia of ca){ca=ia.eventInfo;if(ia.triggerEvent){const oa=ka.Ghe(ia.triggerEvent);oa&&(ca.flightId=oa);D.AFrameworkApplication.F1(ia.triggerEvent)}k.ULS.sendTraceTag(509100380,306,50,"Web Campaign UI launched. "+JSON.stringify(ca))}}static qml(ca){ka.Y6a===ka.iXa&&OfficeBrowserFeedback.processTelemetryEvent(ca)}static U_j(ca){ca=ca?ca.surfaceContext:null;if(!ca||!ca.surveyForm)return k.ULS.sendTraceTag(555071516,356,10,"Missing activation arguments"),
!1;try{const ia=ca.surveyForm.getSurveyInfo(),oa=ia?ia.getMetadata():null,sa=oa?oa.getContentMetadata():null;return ka.Etg(sa,ca.surveyForm,ca.surveyParams)}catch(ia){k.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(ia?ia.toString():""))}return!1}static Etg(ca,ia,oa){if(!ca||!ca.customSurveyName||!ia)return k.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(ca?ca.customSurveyName:null)),!1;const sa=ia.getCampaignId();if(ca.telemetryEventName){var Ca=
{["action"]:"Opened",["id"]:sa,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:ca.customSurveyName,["telemetryEventName"]:ca.telemetryEventName};ka.o9d?ka.o9d(ca.telemetryEventName,Ca):(D.AFrameworkApplication.KYa(ca.telemetryEventName),k.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(Ca)))}Ca=ka.bJf.Ib(ca.customSurveyName)?ka.bJf.ga(ca.customSurveyName):null;if(!Ca)return k.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+
ca.customSurveyName+", "+sa),!1;(ca=Ca(ia,oa))&&ca.then(Ta=>{k.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(Ta))}).catch(Ta=>{k.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(Ta?Ta.toString():""))});return!0}static qfk(ca){try{return-1!==D.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((ca||"").toLowerCase())}catch(ia){k.ULS.sendTraceTag(539015368,356,
10,"Error checking if campaign is disabled - "+ca)}return!1}static logActivity(ca,ia){ia=void 0===ia?null:ia;if(ka.w4d(ca,"LogActivity")){var oa=ka.Hhe();oa&&(k.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+ca),oa.logActivity(ca,1,ia))}}static Cob(ca){ca?(k.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(ca),ka.AOh()):k.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static AOh(){ka.Jka(ka.qee);
ka.I_c()&&null===document.getElementById(ka.qee)&&ka.j$j(ka.Dpj)}static n$j(ca,ia,oa){var sa=[3,2,5,1],Ca=!0,Ta=!0,R=!0;Ca=void 0===Ca?!0:Ca;Ta=void 0===Ta?!1:Ta;R=void 0===R?!1:R;const Ha=E.FocusManager.instance(),da=Ha.Kc(ca);da.parent=w.AFrame.Nj;da.uK=R;C.a.instance.y4(ca,Ca);ia&&da.Zda(ia);if(oa){F.a.instance.s9(ca,oa,!1,Ta);B.a.instance.s9(ca,oa,!1,Ta);ca=new m.DOMFocusListing(()=>oa);for(ia=0;ia<sa.length;++ia)ca.xp(sa[ia]);Ha.hla(()=>oa,da,ca).IY=!0}}static Jka(ca){const ia=document.getElementById(ca);
ia?ka.n$j(ca,ka.r5k,ia):k.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+ca)}static r5k(ca,ia){k.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(ca?ca.name:"")+" NextScopeName "+(ia?ia.name:""));ia&&(ca=E.FocusManager.instance().DR(ia.name))&&ca.Qmd()}static j$j(ca){ka.t5b=ka.clearInterval(ka.t5b);ka.cve=!1;ka.fWc=10;ka.t5b=window.setInterval(()=>{ka.JPl(ca)},ka.Qej)}static JPl(ca){null!==document.getElementById(ca)&&(ka.Jka(ca),ka.cve=!0);ka.fWc--;if(ka.cve||
0>=ka.fWc)ka.t5b=ka.clearInterval(ka.t5b),0>=ka.fWc&&k.ULS.sendTraceTag(508384545,356,15,"BFCOCV.Could not find dynamic ux container "+ca)}static clearInterval(ca){ca!==ka.JGd&&window.clearInterval(ca);return ka.JGd}static ohc(ca){if(ka.w4d(ca,"LogActivityStart")){var ia=ka.Hhe();ia&&(k.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+ca),ia.logActivityStartTime(ca))}}static zJg(ca){if(ka.w4d(ca,"LogActivityEnd")){var ia=ka.Hhe();ia&&(k.ULS.sendTraceTag(37856262,356,50,
"BFCOCV.Calling OCV's logActivityStopTime "+ca),ia.logActivityStopTime(ca,new Date))}}static Fpj(){OfficeBrowserFeedback.floodgate.start()}static Gpj(){OfficeBrowserFeedback.floodgate.stop()}static F8j(ca){try{const ia=ca.telemetryGroup,oa=new Map;oa.set("Agent",ka.Sej);oa.set("Platform","Web");oa.set("Host",ca.Host||"");oa.set("Audience",ia.audienceGroup||"");oa.set("TenantId",ia.tenantId||"");D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestEnabled",
!1)&&(D.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestAudience","Dogfood"),oa.set("Audience","Dogfood"),oa.set("SurveyValidation","true"));const sa={};sa.appName=ca.Application||"";sa.language=ca.locale||"";sa.appVersion=ia.officeBuild||"";sa.host=ka.Rej;sa.filters=oa;sa.localStorageProvider=OfficeBrowserFeedback.floodgate.getStorageProvider();const Ca=new FloodgateDynamicCampaign.Client(sa);Ca.telemetryEvents.subscribe((Ta,R)=>{k.ULS.sendTraceTag(508912419,
356,50,"Floodgate Ecs Telemetry Event: "+Ta+", details: "+JSON.stringify(R))});return Ca.start().then(()=>{const Ta={enabled:!0};Ta.ecsClient=Ca;OfficeBrowserFeedback.floodgate.initOptions.dynamicCampaignConfig=Ta}).catch(Ta=>{k.ULS.sendTraceTag(508912418,356,10,"EcsClient starts with Error: "+(Ta?Ta.toString():""))})}catch(ia){return k.ULS.sendTraceTag(508912417,356,15,"Initialized EcsClient failed with error: "+ia.toString()),Promise.resolve(0)}}static w4d(ca,ia){ca||k.ULS.sendTraceTag(36546433,
356,10,"BFCOCV.Error. null 'name' in method "+ia);return!!ca}static Hhe(){let ca=null;const ia=OfficeBrowserFeedback.floodgate.getEngine();ia?(ca=ia.getActivityListener())||k.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):ka.Sjh||(ka.Sjh=!0,k.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));return ca}static H1f(){return new Q}static Myj(ca,ia,oa){return Object.assign(new N,{productName:ca,uiHost:ia,cvFlights:"",isCVSurveyEnabled:!0,isCopilotLicenseEnabled:oa})}static rWa(ca){return Object.assign(new G,
{dedupIntervalSeconds:86400,props:[],userFactName:ca})}static I_c(){return D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyDynamicUxEnabled",!1)}}ka.qee="obf-ToastContainer";ka.Dpj="obf-FloodgateDynamicUxContainer";ka.y0k=0;ka.Oxg=1;ka.iXa=2;ka.error=-1;ka.Y6a=ka.y0k;ka.Sjh=!1;ka.Pxg=!1;ka.Eyk="window.localStorage is not available";ka.hkh="OFB still undefined";ka.I1k="OFB Floodgate is undefined or does not contain initialize function";ka.h9l="Teams";
ka.dnj="Live";ka.Rej="https://config.edge.skype.com";ka.Sej="ChillWAC";ka.Rbg=new Set;ka.bJf=new n.a(r.a.gl());ka.o9d=null;ka.vwk="Copilot";ka.MAg=!1;ka.Qej=1E3;ka.JGd=-1;ka.t5b=ka.JGd;ka.cve=!1;ka.fWc=10;Object(L.a)(ka,"BrowserFeedbackControlOCV",null,[])},725:function(L,V,d){L=d(0);var k=d(18),e=d(7),n=d(405),r=d(406);class w{constructor(H,K,A,W,N,P,U){this.commandId=H;this.controlId=K;this.timeStamp=A;this.commandSurface=n.a[void 0===W?0:W];this.Gv=r.a[void 0===N?0:N];this.contentType=void 0===
P?null:P;this.HCd=void 0===U?null:U}}Object(L.a)(w,"CommandActionInfo",null,[]);class D{constructor(){this.g$h=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))");this.cci=RegExp("(CoauthorsRendered|DoNothing|MenuClose|MenuOpen|ZeroTermContextMenuClose|SmartLookupContextMenu|TabSwitch|((TellMe).+))")}isNullOrUndefined(H){return null===H||"undefined"===typeof H}utk(H){return!this.g$h.exec(H)}vtk(H){return this.isNullOrUndefined(H)||!H.trim().length?
!1:!this.cci.exec(H)}}Object(L.a)(D,"EventsCacheLoggingUtils",null,[]);class y{constructor(H,K,A,W){this.CmdId=this.ParentTcid=this.Tcid=null;this.Time=0;this.Tcid=H;this.ParentTcid=K;this.CmdId=A;this.Time=W}}Object(L.a)(y,"MRUControl",null,[]);var m=d(25),C=d(1166),E=d(777),F=d(202);d.d(V,"a",function(){return B});class B{constructor(){this.QZb=null;this.Dzf=this.DQd=20;this.QIc=this.zda=this.XFc=this.V5a=this.vWb=null;this.IFf=this.BOd=!1;this.lWi=(H,K)=>{this.vWb.insert(0,new w(K.commandId,K.controlId,
K.time,K.commandSurface,K.Gv,K.contentType,K.ZMb));this.Jff(this.vWb);this.BOd&&this.QZb.vtk(K.controlId)&&this.Dti(K)}}init(){this.QZb=new D;this.vWb=new k.a;this.V5a=new k.a;this.XFc=new k.a;this.DQd=m.AFrameworkApplication.fa.tc("MaxCommandClickedEventQueueSize",20);C.a.Gyi(this.lWi);E.a.instance.yLf(Object(e.a)(this,this.ltl,"recordActionEvent"));this.BOd=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserMRUActionsCookieEnabled",!1);this.IFf=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPreferParentControls",
!0);this.BOd&&(this.zda=new k.a,this.QIc="UserRecentActions_"+this.FZc(),this.Pxk())}FZc(){switch(m.AFrameworkApplication.za.mb.Ej){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Pxk(){var H=F.a.get(this.QIc);if(!this.QZb.isNullOrUndefined(H)&&0<H.length){let K=null;try{K=JSON.parse(decodeURIComponent(H))}catch(A){F.a.remove(this.QIc);return}H=0;for(const A of K)this.zda.insert(H++,A)}}Dti(H){const K=this.IFf&&
!this.QZb.isNullOrUndefined(H.ZMb)&&0<H.ZMb.length;if(0<this.zda.count){for(var A=0;A<this.zda.count&&3>A;A++){var W=this.zda.ga(A);if(K&&W.ParentTcid===H.ZMb||W.Tcid===H.controlId)return}for(A=3;A<this.zda.count;A++)if(W=this.zda.ga(A),K&&W.ParentTcid===H.ZMb||W.Tcid===H.controlId){this.zda.remove(W);break}}this.zda.insert(0,new y(H.controlId,H.ZMb,H.commandId,H.time));this.zda.count>this.Dzf&&this.zda.removeAt(this.Dzf);H=JSON.stringify(this.zda.toArray());F.a.lL(this.QIc,H,F.a.VK)}Jff(H){H.count>
this.DQd&&H.removeAt(this.DQd)}ltl(H,K){this.V5a.insert(0,new w(K.actionName,K.controlId,K.timeStamp,K.commandSurface,K.Gv,K.contentType,K.HCd));this.Jff(this.V5a);this.QZb.utk(K.actionName)&&(this.XFc.insert(0,new w(K.actionName,K.controlId,K.timeStamp,K.commandSurface,K.Gv,K.contentType,K.HCd)),this.Jff(this.XFc))}static get instance(){return B.Ja||(B.Ja=new B)}}B.Ja=null;Object(L.a)(B,"CommandClickEventsCache",null,[])},730:function(L,V,d){d.r(V);L=d(0);var k=d(736),e=d(25),n=d(46),r=d(55),w=d(103),
D=d(1268),y=d(1267),m=d(19),C=d(338);const E=(Q,G)=>{if(Q){Q=Q.trim().toLowerCase();if("true"===Q)return!0;if("false"===Q)return!1}return G};var F=d(749),B=d(27),H=d(980),K;(function(Q){Q[Q.none=0]="none";Q[Q.internal=1]="internal";Q[Q.clipService=2]="clipService"})(K||(K={}));Object(L.b)("ClipboardIframeContent",K);var A=d(394),W=d(691),N=d(451),P=d(48);d.d(V,"ClipboardHelper",function(){return U});class U{constructor(Q,G,Y,ba,ha,ka){this.NGk=[C.a.IX,C.a.nq,C.a.location,C.a.EE,C.a.type,C.a.bTe,C.a.count,
C.a.BHa,C.a.zHa,C.a.hob,C.a.slideId,C.a.sessionId,C.a.timeStamp,C.a.Cz];this.gNe=new k.a;this.zMe=new D.a(y.a.gl());this.Cr=Q;this.BOg=G;this.Fc=ka;if(Y&&0<Y.length){Q=Y.split(";");for(const ca of Q)Q=this.Slg(ca),0<Q.length&&this.gNe.add(Q)}this.OGk=ba;this.cKe=ha;if(this.i8c()){ba=e.AFrameworkApplication.fa.Ea("PicklingAPIMaxPackageSizeInMB").split(";");for(const ca of ba)ba=ca.split(":"),2===ba.length&&0<ba[0].length&&0<ba[1].length&&this.zMe.add(ba[0],parseInt(ba[1]))}}vGd(Q,G,Y,ba,ha,ka,ca){if(Q.contentWindow&&
Q.contentWindow.document&&Q.contentWindow.document.body){P.a.z5b(Q);const oa=P.a.zla();var ia=document.createTextNode(P.a.ASe);oa.appendChild(ia);ia=null;let sa=0;if(!G)B.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",ca),Sys.UI.DomElement.addCssClass(oa,P.a.bbe);else if(G.length&&G[0]&&G[0].N$a&&(Sys.UI.DomElement.addCssClass(oa,this.Cr.Vr[0].N$a),sa=1,Y)){n.a.Ta(Y.EE)&&B.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",
Y.nq);sa=2;G=F.a(Y.dataType);oa.setAttribute(C.a.IX,Y.IX);oa.setAttribute(C.a.MTa,Y.MTa);oa.setAttribute(C.a.nq,Y.nq);oa.setAttribute(C.a.version,Y.version);oa.setAttribute(C.a.location,Y.location);oa.setAttribute(C.a.EE,Y.EE);oa.setAttribute(C.a.type,G);oa.setAttribute(C.a.count,Y.objectCount.toString());oa.setAttribute(C.a.BHa,Y.BHa);oa.setAttribute(C.a.zHa,Y.zHa);oa.setAttribute(C.a.Cz,Y.Cz);const Ca=(new Date).toUTCString();B.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",
G,Y.BHa,Ca);oa.setAttribute(C.a.timeStamp,Ca);if(1===Y.dataType||2===Y.dataType)G=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ea("361"))+"?Id="+n.a.We(Y.nq)+"&DC="+n.a.We(Y.EE)+"&pkey="+n.a.We(Y.Cz)+"&wdwaccluster="+n.a.We(Y.EE)+"&DataType="+G,oa.setAttribute(C.a.MUi,G);Y.Dqc&&oa.setAttribute(C.a.bTe,this.CNl(Y.Dqc));1===Y.dataType&&this.cKe&&(ia=P.a.DD(),ia.id=C.a.Owg,ia.setAttribute(C.a.A7j,"true"),Y=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ea("361"))+
"?Id="+n.a.We(Y.nq)+"&DC="+n.a.We(Y.EE)+"&pkey="+n.a.We(Y.Cz)+"&wdwaccluster="+n.a.We(Y.EE),ia.src=Y)}oa.setAttribute(C.a.sessionId,ba);oa.setAttribute(C.a.hob,ha?ha.join(","):"");ka?oa.setAttribute(C.a.slideId,ka.cid.toString()+"+"+ka.sid.toString()):oa.setAttribute(C.a.slideId,"");Q.contentWindow.document.body.appendChild(oa);ia&&Q.contentWindow.document.body.appendChild(ia);this.Fc.Ei(A.a.R0i,K[sa],ca)}}znk(Q){var G="";r.a.Fk?G="Chromium":r.a.jg?G="Firefox":r.a.JEb&&(G="Safari");G=this.zMe.Ib(G)?
this.zMe.ga(G):0;(G=Math.ceil(Q)<=G)||B.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",r.a.nx,Q);return G}Uhk(Q){return Q&&Sys.UI.DomElement.containsCssClass(Q,P.a.bbe)?!0:!1}Xhk(Q){return!!Q&&!!Q.getAttribute&&E(Q.getAttribute(C.a.zHa),!1)}htk(Q){return!!Q&&!!Q.Rn&&!!Q.Rn.firstChild&&!!Q.Rn.firstChild.className&&this.itk(Q.Rn.firstChild.className)}itk(Q){return!!Q&&Q.startsWith("CID")&&w.a.isValid(Q.substring(3,Q.length))}Zsk(Q){return!!Q&&!!Q.nq&&!!Q.EE&&0!==
Q.dataType&&0<Q.objectCount&&!!Q.Cz}mYl(Q){if(!this.Ndk(Q))return B.a.J(512329174,307,50,"DC '{0}' is not allowed",Q.EE),!1;if(Q.Lua&&"TimeStamp"in Q.Lua){var G=new Date(Date.parse(Q.Lua.TimeStamp));Q=60*this.OGk-5;G=U.XTf(G);if(G>=Q)return B.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",Q,G),!1}return!0}Slg(Q){return Q?Q.trim().toUpperCase():""}Ndk(Q){return!this.Pue(Q)||this.gNe.contains(this.Slg(Q.EE))||this.gNe.contains("ALL")}aAg(Q){return!!Q&&!!Q.kY&&
!!Q.kY.length&&!!Q.kY[0]}bAg(Q){return this.aAg(Q)&&Object(m.a)(N.a,Q.kY[0])}Iek(Q){return this.aAg(Q)&&Object(m.a)(W.a,Q.kY[0])}mue(Q){return!!Q&&!!Q.Cv&&this.mYl(Q.Cv)}Hek(Q){return this.mue(Q)&&1===Q.Cv.dataType}Gek(Q){return this.mue(Q)&&2===Q.Cv.dataType}Fek(Q){return this.mue(Q)&&3===Q.Cv.dataType}Jek(Q){return!!Q&&!!Q.ON}Kek(Q){return this.Jek(Q)&&1===Q.ON.contentType}i8c(){return!(r.a.vy||r.a.JEb)&&e.AFrameworkApplication.fa.getBooleanAppSetting("PicklingAPISlidePasteEnabled")}UUi(Q,G){if(Q&&
G&&Q.getAttribute)for(const Y of this.NGk){const ba=Q.getAttribute(Y);ba&&G.setAttribute(Y,ba)}}Pue(Q){if(Q.EE!==this.BOg)return B.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",F.a(Q.dataType),Q.EE,this.BOg,Q.nq)),!0;B.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",F.a(Q.dataType),Q.EE,Q.nq));return!1}mkj(Q,G){var Y=Q.getAttribute(C.a.nq),ba=parseInt(Q.getAttribute(C.a.version)),ha=Q.getAttribute(C.a.Cz),
ka=parseInt(Q.getAttribute(C.a.IX)),ca=parseInt(Q.getAttribute(C.a.MTa)),ia=Q.getAttribute(C.a.type);ia=ia?F.b(ia):2;var oa=Object,sa=oa.assign,Ca=new H.a;ka=isNaN(ka)?32:ka;ca=isNaN(ca)?0:ca;ba=isNaN(ba)?0:ba;var Ta=Q.getAttribute(C.a.location),R=Q.getAttribute(C.a.EE),Ha=Q.getAttribute(C.a.count);Ha=parseInt(Ha);Y=sa.call(oa,Ca,{IX:ka,MTa:ca,nq:Y,version:ba,location:Ta,EE:R,dataType:ia,objectCount:isNaN(Ha)?-1:Ha,BHa:E(Q.getAttribute(C.a.BHa),!1),zHa:E(Q.getAttribute(C.a.zHa),!1),Cz:ha});ha=U.skj(Q);
ia=U.wkj(Q);Y.Lua={["SessionId"]:ha,["TimeStamp"]:ia?ia.toUTCString():""};G=U.z2d(Y,ia,this.Fc,G);B.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",G);if(Q=Q.getAttribute(C.a.bTe))Y.Dqc=this.uaj(Q);return Y}CNl(Q){return JSON.stringify(Q)}uaj(Q){try{return JSON.parse(Q)}catch(G){return B.a.J(512329169,826,15,"{0} when parse json string: {1}",G.toString(),Q),null}}static uAg(Q){return Q&&Q.Lua&&"SessionId"in Q.Lua?U.jFg(Q.Lua.SessionId.toString()):!1}static jFg(Q){return n.a.Ta(Q)||
n.a.Ta(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===Q.toLowerCase()}static z2d(Q,G,Y,ba){const ha=F.a(Q.dataType);Q=String.format("A {0} ClipServiceObject was just created: '{1}'",ha,Q);G&&(G=U.XTf(G),Q+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",G),Y.Ei("CopyPasteElapsedSec",G.toString(),ba));return Q}static skj(Q){Q=Q.getAttribute(C.a.sessionId);return void 0===Q||null===Q?"":Q}static wkj(Q){Q=Q.getAttribute(C.a.timeStamp);
return void 0===Q||null===Q?null:new Date(Date.parse(Q))}static XTf(Q){var G=new Date;if(!Q)throw Error.argumentNull("fromTime");if(!G)throw Error.argumentNull("toTime");return(G.getTime()-Q.getTime())/1E3}}Object(L.a)(U,"ClipboardHelper",null,[1772])},740:function(L,V,d){d.r(V);var k=d(92);L=d(0);var e=d(470),n=d(75),r=d(136),w=d(94),D=d(67),y=d(319),m=d(25),C=d(46),E=d(55),F=d(54),B=d(97),H=d(31),K=d(27),A=d(30),W=d(85),N=d(974),P=d(966),U=d(964),Q=d(967),G=d(968),Y=d(971),ba=d(972),ha=d(969),ka=
d(965),ca=d(973),ia=d(970);class oa{createAuthProviderAsync(R){F.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").mla();return new Promise(Ha=>{F.a.instance.Ha("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(da=>{da=da.X1i(R);Ha(da)})})}}Object(L.a)(oa,"SlideShowAppForOfficeAuthFactory",null,[]);var sa=d(1044),Ca=d(69);d.d(V,"SlideShowCoreFrame",function(){return Ta});class Ta{constructor(R,Ha,da,Ba,za,Aa,na,la,va,Pa,Qa,Ua,Ya,Ea){this.Wk=this.onc=this.Fhd=null;this.Uga=
new e.a;this.ua=new n.a;this.kQe="";this.Fx=null;this.Ald="";this.DOe=this.UUg=this.qoc=this.zP=this.kba=this.jba=this.rxa=this.K=null;this.soc=!0;this.r_a=Date.now();this.p_a=Date.now();this.hoa=this.Gch=0;this.gBe=this.bIb=!1;this.R4k=()=>{K.a.J(512309270,830,50,"SlideShowCoreFrame::OnEditHappened");this.p_a=Date.now()};this.J6k=()=>{K.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.p_a=Date.now()};this.E8k=()=>{K.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");
this.p_a=Date.now()};this.nvl=La=>{Object(k.b)(this,void 0,void 0,function*(){if(this.fic){var xb=(new Date).getTime();try{const dc=yield this.fic.vH("Hubble",La);dc.IsSuccess?this.Wk.setAadToken(dc.Token):this.Wk.setAadToken("");K.a.J(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${dc.IsSuccess} time: ${(new Date).getTime()-xb}`)}catch(dc){K.a.J(508949123,830,10,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-
xb} error: ${dc}`),this.Wk.setAadToken("")}}else K.a.J(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),this.Wk.setAadToken("")})};this.zf=R;this.ka=Ha;this.Mc=da;this.VGb=Ba;this.xm=za;this.Zb=Aa;this.vP=la;this.dv=na;this.YPe=va;this.te=Pa;this.wcd=Qa;this.Ng=Ua;this.UP=Ya;this.Ms=Ea;this.nTk=r.a.getInstance();this.wcd&&this.wcd.execute(La=>{La.vvb(this.R4k)});this.Ng&&(this.Ng.jOc(this.J6k),this.Ng.wOc(this.E8k));try{const La=
this.fba=JSON.parse(this.ka.Ea("Settings"))||{};La.slideshowcore||(La.slideshowcore={});La.slideshowcore&&La.slideshowcore.forceSvg&&"true"===La.slideshowcore.forceSvg.toString().toLowerCase()?this.YPe=!0:this.YPe&&(La.slideshowcore.forceSvg="True");La.slideshowcore.enableCameoInPPTOSlideShow=this.ka.LU.toString()}catch(La){K.a.J(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",La),this.fba={}}}preloadShaders(){this.h9e();this.Hzd();SlideShowCore.SlideShowCore.preloadShaders()}init(R,
Ha,da,Ba){return Object(k.b)(this,void 0,void 0,function*(){this.kQe=da;this.UP=Ba;this.Ald=Ha;if(this.Fx)K.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.zkc);else{this.rxa=document.getElementById("HiddenFocusTrapAnchor");this.Fx=document.createElement("div");this.Fx.id="SlideShowBackground";this.Fx.className="SlideShowBackground";this.Fx.style.visibility=Ca.a.Vt;this.Fx.tabIndex=-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";
this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";w.a.addHandler(this.Fx,D.a.Nya,na=>{this.p7k(na)});y.a.instance.xb(this.Fx,na=>this.Akb(na));this.Fx.appendChild(this.K);A.a("PresenterCoachTabFix")&&this.rxa?this.zf.insertBefore(this.Fx,this.rxa):this.zf.appendChild(this.Fx);var za=this.ka.Ea("pptSlideShowCoreCssUrl"),Aa=document.createElement("link");Aa.setAttribute("rel","stylesheet");Aa.setAttribute("type","text/css");Aa.setAttribute("href",
za);this.K.appendChild(Aa);sa.a.instance.init(this.ka,this.Fx,this.Mc,this,this.xm,this.Zb,this.vP);this.jba=document.getElementById("slideshowBeginningFocusTrap");this.kba=document.getElementById("slideshowEndFocusTrap");this.jba||this.kba||(this.jba=document.createElement("div"),this.jba.id="slideshowBeginningFocusTrap",this.jba.className="FocusTrap",this.jba.tabIndex=0,w.a.addHandler(this.jba,D.a.focus,na=>{this.Grc(na)}),this.kba=document.createElement("div"),this.kba.id="slideshowEndFocusTrap",
this.kba.className="FocusTrap",this.kba.tabIndex=0,w.a.addHandler(this.kba,D.a.focus,na=>{this.Grc(na)}),A.a("PresenterCoachTabFix")&&this.rxa?(this.zf.insertBefore(this.jba,this.zf.firstChild),this.zf.insertBefore(this.kba,this.rxa.nextSibling)):(za=document.getElementById("slideshow-toolbar"),this.zf.insertBefore(this.jba,this.Fx),this.zf.insertBefore(this.kba,za)));this.zkc=this.Rog(1)}yield this.zkc})}Rog(R){return Object(k.b)(this,void 0,void 0,function*(){const Ha=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.ka.podsWebServiceBase,this.UP),da={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};da["X-UserSessionId"]=m.AFrameworkApplication.userSessionId;const Ba=new Date;return new Promise((za,Aa)=>{this.Ms.Tj(Ha,1,"",da,!1,0,na=>Object(k.b)(this,void 0,void 0,function*(){yield this.HUe(na,Ba);K.a.J(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");za()}),na=>Object(k.b)(this,void 0,void 0,function*(){yield this.GUe(na,R);K.a.J(509636750,830,
10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");Aa()}),null,null)})})}HUe(R,Ha){return Object(k.b)(this,void 0,void 0,function*(){K.a.J(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+Ha);const da=JSON.parse(R.data.Ud);this.zP=da.downloadUrl;C.a.Ta(this.zP)?K.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",da):(this.r_a=Date.now(),yield this.o9j())})}kng(){const R={};
R.settings=this.fba;R.retryCount=this.ka.tc("GetItemsRetryCount",3);R.retryOnCategories=this.ka.Ea("GetItemsRetryCategories").split(";");const Ha={};Ha.Slide=ResourceStrings.l_Slide;Ha.AnimNum=ResourceStrings.l_AccSsAnimNum;Ha.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;Ha.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Ha.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Ha.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;R.localizedStrings=Ha;return R}o9j(){return Object(k.b)(this,
void 0,void 0,function*(){this.h9e();this.Hzd();this.Fhd=new PodsProxy.PodsProxy(this.ka.ycb?this.ka.A0c:this.ka.podsWebServiceBase,{DownloadUrl:this.zP,DocID:m.AFrameworkApplication.mh,CustomFontCatalogUrl:this.ka.Ea("CustomFontCatalogURL")},this.ka.hMa?C.a.AR(this.ka.hMa).toLowerCase():"",this.Uga,this.Hmg(),this.Jmg());this.onc=new SlideShowCore.DefaultResourceProviders(this.Fhd,this.Uga,this.kng());const R={};R.initTime=Ta.q$();R.uiHost="Unified App";R.serverUrl=C.a.We(this.ka.podsWebServiceBase);
R.userSessionId=this.kQe;R.jsScriptsBasePath=this.ka.Ea("StaticContentHost")+"pptscripts/ssapp/";R.fileHost=this.ka.Ea("FileHost");R.isRtl=m.AFrameworkApplication.isRtl;R.applicationLcid=m.AFrameworkApplication.lcid;R.applicationLocaleName=m.AFrameworkApplication.uiCulture;R.areThirdPartyAddInsAllowed=m.AFrameworkApplication.Wka;R.theWsaClient=m.AFrameworkApplication.fj;R.appForOfficeContextActivationParameters=N.a.gpg(this.te);R.hubbleVideoEndpoint=this.ka.insertOnlineVideoEndpoint;R.acceptLanguage=
m.AFrameworkApplication.uiCulture;R.appForOfficeAuthFactory=new oa;const Ha={};Ha.settings=this.fba;Ha.transitionResourceCDNPath=this.ka.d3f;Ha.transitionDisabledList=this.ka.FOa;Ha.clickTargetEnabled=!0;Ha.mediaEnabled=!0;Ha.gifEnabled=!0;Ha.convertGifToVideo=!0;Ha.crossSlideAudioEnabled=!0;Ha.editAudioEnabled=this.ka.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Ha.flipgridVideoEnabled=this.ka.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");Ha.useNewYoutubePlayer=!0;Ha.useNewVimeoPlayer=
!0;Ha.useOnlineVideoPlayer=!0;Ha.tedVideoEnabled=this.ka.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");Ha.isStream2Enabled=this.ka.getBooleanAppSetting("IsStream2VideoEnabled");Ha.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Ha.enableSVGAsWebGLTexture=!E.a.jg&&this.ka.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");Ha.maxSvgTextureSize=this.ka.tc("ShapeBuilderMaxSvgTextureSize",2048);Ha.enableSlideSizeAdjust=this.ka.getBooleanAppSetting("EnableSlideSizeAdjust");Ha.slideSizeMax=
{["x"]:this.ka.tc("SlideShowMaxWidth",1504),["y"]:this.ka.tc("SlideShowMaxHeight",849)};Ha.slideSizeMin={["x"]:this.ka.tc("SlideShowMinWidth",348),["y"]:this.ka.tc("SlideShowMinHeight",261)};Ha.slideSizeDefault={["x"]:this.ka.tc("SlideShowDefaultWidth",1504),["y"]:this.ka.tc("SlideShowDefaultHeight",849)};Ha.streamVideoUseThinEmbed=this.ka.getBooleanAppSetting("StreamVideoUseThinEmbed");Ha.slideMetadataEnabled=this.ka.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Ha.disabledChangeGates=
this.ka.Ea("PPTDisabledChangeGates");Ha.combineBootRequest=!0;Ha.localVideoTelemetryEnabled=this.ka.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Ha.imageSettings={["imageAppendOption"]:"all"};const da={["slideShowCoreSettings"]:Ha,["appSettings"]:R};this.Wk=new SlideShowCore.SlideShowCore(this.K,this.onc,this.Uga,da);new SlideShowCore.PrefetchAddon(this.Wk,this.Uga,{["forwardPrefechCount"]:this.ka.tc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.ka.tc("PptModernSlideShowBackwardPrefetchCount",
5),["forwardPrerenderCount"]:this.ka.tc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.ka.tc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Wk,this.Uga);this.Gch=Date.now();this.DOe=this.Wk.init();this.Wk.events.on("slideLocationChanged",()=>{this.Lpd()});this.Wk.events.on("animationStateChanged",()=>{this.Lpd()});this.Wk.events.on("slideDimensionsChanged",()=>{this.getCurrentSlideDimensions()});this.Wk.events.on("exitFromEndOfShow",
()=>{this.tUe(!0)});this.Wk.events.on("blankSlideStateChanged",Ba=>{this.f3k(Ba)});this.Wk.events.on("slideshowError",Ba=>{this.Iod(Ba)});this.ka.getBooleanAppSetting("IsStream2VideoEnabled")&&(this.fic=F.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.Wk.events.on("aadTokenRequest",Ba=>{this.nvl(Ba)}));return new Promise(Ba=>Object(k.b)(this,void 0,void 0,function*(){yield this.DOe;this.soc=!1;this.UUg=new SlideShowCore.InputsAddon(this.Wk,this.K,m.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Wk,
da,this.Uga);new SlideShowCore.TransitionLoggerAddon(this.Wk,da,this.Uga);new SlideShowCore.PerfCheckerAddon(this.Wk,da,this.Uga);this.qoc=new SlideShowCore.SlideShowInkAddon(this.Wk,this.Uga,this.K,()=>this.VGb.loadScript("slideshowink"),{["telemetryLogger"]:this.nTk});this.ka.LU&&(this.poc=new SlideShowCore.CameoWebcamAddon(this.Wk));this.UUg.events.on("keydown",za=>{this.JLa(za)});K.a.J(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");Ba()}))})}Jmg(){const R={};R.timeout=
this.ka.tc("PptModernSlideShowGetItemsTimeoutMs",3E4);R.throwHttpErrors=!1;R.enableServerSpecificErrorCode=A.a("SSCore.EnableServerSpecificErrorCode");return R}Hzd(){try{const R=this.fba;if(R.slideshowcore){const Ha={};Ha.settings=R;Ha.logger=this.Uga;Ha.disabledChangeGates=this.ka.Ea("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Ha)}}catch(R){K.a.J(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",R)}}h9e(){try{const R=this.fba;
if(R.podsproxy){const Ha={};Ha.settings=R;window.PodsProxy.setupGlobals_PodsProxy(Ha)}}catch(R){K.a.J(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",R)}}K3h(R,Ha){return Object(k.b)(this,void 0,void 0,function*(){this.h9e();this.Hzd();if(this.Wk){this.Fhd=new PodsProxy.PodsProxy(this.ka.ycb?this.ka.A0c:this.ka.podsWebServiceBase,{DownloadUrl:this.zP,DocID:m.AFrameworkApplication.mh,CustomFontCatalogUrl:this.ka.Ea("CustomFontCatalogURL")},this.ka.hMa?C.a.AR(this.ka.hMa).toLowerCase():
"",this.Uga,this.Hmg(),this.Jmg());var da=this.onc;this.onc=new SlideShowCore.DefaultResourceProviders(this.Fhd,this.Uga,this.kng());yield this.Wk.updateResourceProviders(this.onc,{shouldRerenderSlide:!0});da&&da.dispose();K.a.J(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",R,Ha,Date.now(),this.jYa())}else K.a.J(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}GUe(R,
Ha){return Object(k.b)(this,void 0,void 0,function*(){const da=R.data?R.data.Ke:-1;0<Ha--?(K.a.J(512309281,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",da),yield this.Rog(Ha)):K.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",da)})}tBd(R,Ha,da,Ba,za,Aa,na,la,va){Object(k.b)(this,void 0,void 0,function*(){var Pa=0;if(this.zkc){K.a.J(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",
this.zkc);var Qa=Ta.q$();yield this.zkc;Pa=Ta.q$()-Qa;this.jYa()||this.show()}C.a.Ta(this.zP)?(K.a.J(508924042,830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.zP),this.jYa()&&(Qa=W.a.hi(410),m.AFrameworkApplication.Lp(Qa),B.Health.instance.recordQosError(W.a.Bea(Qa),["SlideShowACE"],!1,!0,!0,!0,null),this.Wk&&this.Wk.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"}),this.exit())):this.Wk?(Qa={},A.a("SSLaunchUnifiedTelemetry")&&(Qa.initPromiseTimeMs=
Pa),this.p_a>this.r_a||this.soc?(this.fba.slideshowcore.vetoBootDurationMs=this.ka.tc("PptModernSlideShowEditVetoBootDurationMs",8E3),Qa.BootScenario=this.p_a>this.r_a?"AfterEdit":"Init",K.a.J(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.ka.tc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.p_a,this.r_a,this.soc)):(this.fba.slideshowcore.vetoBootDurationMs=this.ka.tc("PptModernSlideShowCachedVetoBootDurationMs",
2E3),Qa.BootScenario="Relaunch",K.a.J(509703458,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.ka.tc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.p_a,this.r_a,this.soc)),this.Hzd(),Pa=0,this.p_a>this.r_a&&(Pa=Ta.q$(),this.Wk.showLoadingSpinner(),yield this.L3h(1),Pa=Ta.q$()-Pa),A.a("SSLaunchUnifiedTelemetry")&&(Qa.SSCoreUpdateAfterEditMs=Pa),Qa.startFromTime=va-window.performance.timing.navigationStart,
Qa.SSCoreFrameStartTime=Ta.q$(),A.a("SSEUPLBugTelemetry")&&(Qa.WindowNavigationStart=window.performance.timing.navigationStart,Qa.WindowTimeOrigin=window.performance.timeOrigin,Qa.SlideShowClickTime=va),sa.a.instance.hAl(),this.K.style.top="0",this.jba&&this.kba&&(this.jba.tabIndex=0,this.kba.tabIndex=0),Pa={["slideId"]:{["sid"]:R,["cid"]:0}},Pa.slideIndex=Ha-1,this.dv.Mec&&!this.dv.N$?this.VRi(Pa,Qa):this.Ncg(Pa,Qa)):K.a.J(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}prev(){return Object(k.b)(this,
void 0,void 0,function*(){this.Wk&&(yield this.Wk.prevStep("0_anim"))})}next(){return Object(k.b)(this,void 0,void 0,function*(){this.Wk&&(yield this.Wk.nextStep("0_anim",3))})}show(){this.VAc(!0)}jYa(){return this.Fx&&this.Fx.style.visibility===Ca.a.AA?!0:!1}t5(){return"Modern"}VAc(R){sa.a.instance.setVisibility(R&&this.Mc.ji);this.Fx&&(R?(this.Fx.style.visibility=Ca.a.AA,$addHandler(window,"visibilitychange",Ha=>{this.r1a(Ha)})):(this.Fx.style.visibility=Ca.a.Vt,$removeHandler(window,"visibilitychange",
Ha=>{this.r1a(Ha)})))}exit(){this.tUe(!1)}nZc(){this.tUe(!1)}transcribe(R,Ha,da,Ba,za,Aa,na){const la=!!this.Zb&&!!this.Zb.instance&&(this.Zb.instance.cVa||this.Zb.instance.Xr);(this.Zb&&this.Zb.instance&&this.Zb.instance.Es&&this.Zb.instance.OFa||la)&&!this.Zb.instance.Uzb()?K.a.J(512495900,830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(sa.a.instance.transcribe(R,Ha,da,Ba,za,Aa,na),this.Mc.ji&&this.Wk.recordSessionStats({["metadata"]:"subtitles"}),this.iae())}Ncg(R,
Ha){Object(k.b)(this,void 0,void 0,function*(){this.Wk.clearNavigationState();const da={navigationType:"init"};da.startFromTime=Ha.startFromTime;Ha.waitedForInit=this.soc;Ha.startInitTime=this.Gch;Ha.beforeInitPromise=Ta.q$();yield this.DOe;Ha.afterInitPromise=Ta.q$();da.bootMetrics=Ha;if(0>R.slideIndex)yield this.Wk.gotoFirstSlide(!0,da),this.K.style.height="100%",this.K.style.width="100%",K.a.J(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",
JSON.stringify(R));else{const Ba={};Ba.actionContext=da;Ba.fSkipTransition=!0;yield this.Wk.gotoSlide(R,Ba);this.K.style.height="100%";this.K.style.width="100%";K.a.J(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(R))}this.ua.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}VRi(R,Ha){const da=this.ka.tc("PptModernSlideShowCheckFullscreenCounter",10),Ba=Ta.q$();let za=da,Aa=4;A.a("fixEUPLBugEnabled")&&0!=this.hoa&&(K.a.J(508411976,
830,15,"Clearing check full screen interval if it is already running:{0}.",this.hoa),this.ka.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&(window.clearInterval(this.hoa),this.hoa=0));this.hoa=window.setInterval(()=>{if(this.ka.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&this.gBe)K.a.J(508404055,830,15,"SlideShowCoreFrame::checkFullscreenBeforeFinishStartFrom - Already CheckingFullScreen, exiting this iteration. checkFullscreenCounter: {0}.",za);else{this.gBe=!0;za--;K.a.J(512495899,
830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",za);var na=Ta.q$();if(this.dv.N$||0>=za){const va=Ta.q$();window.clearInterval(this.hoa);this.hoa=0;if(A.a("fixEUPLBugEnabled")&&0==za%5&&0<=Aa){Aa--;var la=H.Debug.ku();K.a.J(508409102,830,15,"CallStack before checkFullscreenBeforeFinishStartFrom : {0}",la)}la=20*(da-za);A.a("SSLaunchUnifiedTelemetry")||(Ha.checkFullscreenMs=la);K.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms. Time taken in FullScreen API: {1}ms",
la,(va-na).toString());A.a("SSLaunchUnifiedTelemetry")&&!Ha.checkFullscreenMs&&(Ha.checkFullscreenMs=Ta.q$()-Ba);this.Ncg(R,Ha)}this.gBe=!1}},20)}iae(){let R=0,Ha=100;this.Mc.ji&&sa.a.instance.isVisible()&&("AboveSlide"===this.Mc.Xw?(R=15,Ha=85):"BelowSlide"===this.Mc.Xw&&(Ha=85));const da=document.getElementById("LiveURLBarLayerHost");this.bIb&&da?(this.K.style.top=String.format("calc({0}% + {1})",R.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",Ha.toString(),"26px")):(this.K.style.top=
R.toString()+"%",this.K.style.height=Ha.toString()+"%")}setMicrophoneState(R){sa.a.instance.setMicrophoneState(R)}setCameraState(R){var Ha;null===(Ha=this.poc)||void 0===Ha?void 0:Ha.setCameraState(R)}K1h(R){this.poc&&R&&this.poc.updateWebcamDevice(R)}getDefaultCameraLabel(){var R,Ha;return null!==(Ha=null===(R=this.poc)||void 0===R?void 0:R.getDefaultCameraLabel())&&void 0!==Ha?Ha:""}FTb(R,Ha){this.bIb=R;sa.a.instance.IYh(R,void 0===Ha?"":Ha);this.iae()}toggleTranscriberUIVisibility(R){sa.a.instance.setVisibility(R);
sa.a.instance.OOc();this.iae()}Uef(){this.ua.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}restoreFocus(){this.Fx&&this.Fx.style.visibility!==Ca.a.Vt&&!this.gve()&&this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.Wk){const R=this.Wk.getSlideLocation();R?this.ua.raiseEvent("OnGetCurrentPosition",new Q.a({["SlideId"]:R.slideId.sid,["SlideIndex"]:R.slideIndex})):K.a.J(512495897,830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.Wk){const R=
this.Wk.getSlideLocation();if(R){const Ha=this.Wk.getAnimationState(!0),da=Ha.timelineStates,Ba=[];for(let za=0;za<da.length;za+=1)Ba.push({["TimeLineId"]:da[za].timelineId,["Step"]:da[za].step,["LastClickTime"]:da[za].lastClickTime,["StartTimeOffset"]:Ha.startTimeOffset});this.ua.raiseEvent("OnGetCurrentPosition",new Q.a({["SlideId"]:R.slideId.sid,["SlideIndex"]:R.slideIndex,["TimeLineMappings"]:Ba}))}else K.a.J(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.Wk&&
this.Fx&&this.Fx.style.visibility!==Ca.a.Vt){const R=document.getElementById(this.YPe?"svg-canvas":"webgl-canvas");R&&this.ua.raiseEvent("OnGetCurrentSlideDimensions",new G.a({["SlideHeight"]:R.offsetHeight,["SlideWidth"]:R.offsetWidth,["SlideLeftBound"]:R.offsetLeft,["SlideBottomBound"]:R.offsetTop+R.offsetHeight}))}}uWa(R){Object(k.b)(this,void 0,void 0,function*(){this.Wk&&(yield this.Wk.gotoSlide({["slideIndex"]:R},{actionContext:{navigationType:"goto"},fSkipTransition:!1}))})}rrg(R,Ha){Object(k.b)(this,
void 0,void 0,function*(){if(this.Wk){const Ba={};var da=[];let za=0;for(let Aa=0;Aa<Ha.length;Aa+=1){const na={};na.timelineId=Ha[Aa].TimeLineId;na.step=Ha[Aa].Step;na.lastClickTime=Ha[Aa].LastClickTime;za=Ha[Aa].StartTimeOffset;da.push(na)}Ba.timelineStates=da;Ba.startTimeOffset=za;da={actionContext:{navigationType:"goto"}};da.animationState=Ba;da.fSkipTransition=!1;yield this.Wk.gotoSlide({["slideIndex"]:R},da)}})}L3h(R){return Object(k.b)(this,void 0,void 0,function*(){K.a.J(512309260,830,15,
"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.UP);const Ha=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.ka.podsWebServiceBase,this.UP),da={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};da["X-UserSessionId"]=m.AFrameworkApplication.userSessionId;const Ba=new Date;return new Promise((za,Aa)=>{this.Ms.Tj(Ha,1,"",da,!1,0,na=>Object(k.b)(this,void 0,void 0,function*(){yield this.$5k(na,Ba);K.a.J(509636748,
830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");za()}),na=>Object(k.b)(this,void 0,void 0,function*(){yield this.Y5k(na,R);K.a.J(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");Aa()}),null,null)})})}$5k(R,Ha){return Object(k.b)(this,void 0,void 0,function*(){const da=new Date;K.a.J(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",+da-+Ha);const Ba=JSON.parse(R.data.Ud);
this.zP=Ba.downloadUrl;C.a.Ta(this.zP)?K.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",Ba):(this.r_a=Date.now(),yield this.K3h(Ha,da))})}Y5k(R,Ha){return Object(k.b)(this,void 0,void 0,function*(){const da=R.data?R.data.Ke:-1;0<Ha--?(K.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",da),yield this.L3h(Ha)):K.a.J(512309276,
830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",da)})}refreshPodSession(R,Ha,da){da=void 0===da?1:da;return Object(k.b)(this,void 0,void 0,function*(){K.a.J(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.UP,R);this.UP=R;this.Ald=Ha;const Ba=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.ka.podsWebServiceBase,this.UP),za={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};za["X-UserSessionId"]=m.AFrameworkApplication.userSessionId;const Aa=new Date;return new Promise((na,la)=>{this.Ms.Tj(Ba,1,"",za,!1,0,va=>Object(k.b)(this,void 0,void 0,function*(){yield this.a6k(va,Aa);na()}),va=>Object(k.b)(this,void 0,void 0,function*(){yield this.Z5k(va,da);la()}),null,null)})})}a6k(R,Ha){return Object(k.b)(this,void 0,void 0,function*(){var da=new Date;K.a.J(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",
+da-+Ha);const Ba=JSON.parse(R.data.Ud);this.zP=Ba.downloadUrl;C.a.Ta(this.zP)?(K.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",Ba),this.jYa()&&(da=W.a.hi(413),m.AFrameworkApplication.Lp(da),B.Health.instance.recordQosError(W.a.Bea(da),["SlideShowACE"],!1,!0,!0,!0,null),this.Wk&&this.Wk.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.r_a=Date.now(),yield this.K3h(Ha,da))})}Z5k(R,
Ha){return Object(k.b)(this,void 0,void 0,function*(){const da=R.data?R.data.Ke:-1;0<Ha--?(K.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",da),yield this.refreshPodSession(this.UP,this.Ald,Ha)):(K.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",da),this.jYa()&&this.exit())})}setVisibility(R){this.VAc(R)}Bia(R){this.Fx&&
(this.Fx.style.cursor=R?"default":"none");sa.a.instance.Bia(R)}setOsfLocalStorage(){}pYe(R){if(this.qoc)this.qoc.onInkManagerActivity(R)}JLa(R){this.a7e(R)}a7e(R){this.ua.raiseEvent("OnSpecialKey",new ka.a({["Key"]:R.keyCode,["ShiftKey"]:R.shiftKey,["AltKey"]:R.altKey}))}JKh(){}Grc(){this.Fx&&this.restoreFocus()}Hmg(){const R=new Map;R.set("X-UserSessionId",this.kQe);R.set("X-WacNoAuth","1");R.set("X-WacCluster",this.Ald);R.set("Client","Unified App");this.ka.CDj&&R.set("UseDocCache","True");return R}tUe(R){R=
void 0===R?!1:R;var Ha;this.hoa&&(K.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.hoa),window.clearInterval(this.hoa),this.hoa=0);this.qoc&&this.qoc.resetInkCanvas();null===(Ha=this.poc)||void 0===Ha?void 0:Ha.setCameraState(!1);this.jba&&this.kba&&(this.jba.tabIndex=-1,this.kba.tabIndex=-1);this.Wk&&(Ha=this.Wk.getSlideLocation(),this.Wk.endSession(Ta.q$()),Ha?this.ua.raiseEvent("OnExit",new U.a({["SlideId"]:Ha.slideId.sid,["IsBeforeReady"]:!1,
["SlideIndex"]:Ha.slideIndex,["IsFromEndOfSlideshow"]:R})):(this.ua.raiseEvent("OnExit",new U.a({["IsFromEndOfSlideshow"]:R})),K.a.J(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")));this.K&&(this.K.style.width=window.screen.width+"px",this.K.style.height=window.screen.height+"px");this.VAc(!1);sa.a.instance.Ybf()}Lpd(){if(this.Wk&&this.Fx&&this.Fx.style.visibility!==Ca.a.Vt){const R=this.Wk.getSlideLocation();if(R){const Ha=this.Wk.getAnimationState(!0),
da=Ha.timelineStates,Ba=[];for(let za=0;za<da.length;za+=1)Ba.push({["TimeLineId"]:da[za].timelineId,["Step"]:da[za].step,["LastClickTime"]:da[za].lastClickTime,["StartTimeOffset"]:Ha.startTimeOffset});this.ua.raiseEvent("OnPositionChangeEventId",new ba.a({["SlideId"]:R.slideId.sid,["SlideIndex"]:R.slideIndex,["TimeLineMappings"]:Ba}))}else K.a.J(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}f3k(R){if(this.Wk&&this.Fx&&this.Fx.style.visibility!==Ca.a.Vt)switch(R){case "Hidden":this.ua.raiseEvent("OnLeaveEndOfShowEventId",
Sys.EventArgs.Empty);break;case "EndOfShow":this.ua.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:K.a.J(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",R)}}Iod(R){if(this.Wk){K.a.J(512495886,830,10,"SlideshowCoreFrame.OnErrorHandler {0}",R);let Ha;R.startsWith("Server")&&(R="GetItemsRequestFailed");switch(R){case "GetItemsFailedDownloadFile":K.a.J(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",
this.UP);this.ua.raiseEvent("OnPodSessionExpired",new Y.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.UP}));return;case "LoadFailed":Ha=407;break;case "GetItemsFailedInvalidResponse":Ha=408;break;case "GetItemsRequestFailed":Ha=409;break;case "GetItemsTimeout":Ha=411;break;case "EnsureSlideFailed":Ha=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Ha=414;break;default:Ha=359}if(0!==Ha)if(this.jYa()){const da=W.a.hi(Ha);m.AFrameworkApplication.Lp(da);
R=409===Ha?R:W.a.Bea(da);B.Health.instance.recordQosError(R,["SlideShowACE"],!1,!0,!0,!0,null);this.Wk.recordSessionStats({["errorName"]:R})}else K.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",R)}}rqd(R){K.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Wk&&this.Fx&&this.Fx.style.visibility!==Ca.a.Vt&&this.ua.raiseEvent("OnTranscriberStartedEventId",new ca.a({["TranscriberSessionId"]:R}));this.Mc.Wzb=!0}r1a(){K.a.J(512495882,
830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.ua.raiseEvent("OnVisibilityChangeEventId",new ia.a(!1))}gve(){return!!this.Zb&&!!this.Zb.instance&&this.Zb.instance.Kag}qOc(R){this.ua.addHandler("OnSlideshowReady",R)}rvd(R){this.ua.removeHandler("OnSlideshowReady",R)}VZd(R){this.ua.addHandler("OnBrowserEvent",R)}l3e(R){this.ua.removeHandler("OnBrowserEvent",R)}MLf(R){this.ua.addHandler("OnFullscreenClick",R)}WDh(R){this.ua.removeHandler("OnFullscreenClick",R)}YZd(R){this.ua.addHandler("OnSlideshowContextMenu",
R)}o3e(R){this.ua.removeHandler("OnSlideshowContextMenu",R)}Oka(R){this.ua.addHandler("OnExit",R)}jia(R){this.ua.removeHandler("OnExit",R)}JLf(R){this.ua.addHandler("OnSlideshowError",R)}TDh(R){this.ua.removeHandler("OnSlideshowError",R)}mOc(R){this.ua.addHandler("OnGetCurrentSlideDimensions",R)}pvd(R){this.ua.removeHandler("OnGetCurrentSlideDimensions",R)}b3b(R){this.ua.addHandler("OnGetCurrentPosition",R)}Bmb(R){this.ua.removeHandler("OnGetCurrentPosition",R)}rOc(R){this.ua.addHandler("OnSpecialKey",
R)}svd(R){this.ua.removeHandler("OnSpecialKey",R)}$Lf(R){this.ua.addHandler("OnVisibilityChangeEventId",R)}w3e(R){this.ua.removeHandler("OnVisibilityChangeEventId",R)}c_d(R){this.ua.addHandler("OnPodSessionExpired",R)}s3e(R){this.ua.removeHandler("OnPodSessionExpired",R)}PLf(R){this.ua.addHandler("OnLogEndOfTranscriptionSession",R)}YDh(R){this.ua.removeHandler("OnLogEndOfTranscriptionSession",R)}ySa(R){this.ua.addHandler("OnPositionChangeEventId",R)}Dmb(R){this.ua.removeHandler("OnPositionChangeEventId",
R)}OLf(R){this.ua.addHandler("OnLiveSubtitlesDockedViewEventId",R)}XDh(R){this.ua.removeHandler("OnLiveSubtitlesDockedViewEventId",R)}$Zd(R){this.ua.addHandler("OnEnterEndOfShowEventId",R)}p3e(R){this.ua.removeHandler("OnEnterEndOfShowEventId",R)}b_d(R){this.ua.addHandler("OnLeaveEndOfShowEventId",R)}r3e(R){this.ua.removeHandler("OnLeaveEndOfShowEventId",R)}XLf(R){this.ua.addHandler("OnSubtitleUpdatedEventId",R)}gEh(R){this.ua.removeHandler("OnSubtitleUpdatedEventId",R)}YLf(R){this.ua.addHandler("OnTranscriberStartedEventId",
R)}iEh(R){this.ua.removeHandler("OnTranscriberStartedEventId",R)}gMf(R){this.ua.addHandler("RecordQosErrorEventId",R)}qEh(R){this.ua.addHandler("RecordQosErrorEventId",R)}p7k(R){this.ua.raiseEvent("OnBrowserEvent",new P.a({["ClientX"]:R.clientX,["ClientY"]:R.clientY}))}Akb(R){this.ua.raiseEvent("OnSlideshowContextMenu",new ha.a({["ClientX"]:R.clientPoint.x,["ClientY"]:R.clientPoint.y}));return!0}static q$(){return Math.round(window.performance.now())}}Object(L.a)(Ta,"SlideShowCoreFrame",null,[875])},
743:function(L,V,d){L=d(0);var k=d(385),e=d(134);class n extends k.a{constructor(){super();this.languageId=null;this.startOfSentence=!1;this.queryRange=this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(L.a)(n,"TextPredictorSignalBase",k.a,[]);d.d(V,"a",function(){return r});class r extends n{constructor(){super();
this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static getBaseTypes(){return["AugLoop_Signals_TextPredictorSignalBase","AugLoop_Signals_Signal"]}}Object(L.a)(r,"TextPredictorSignal",n,[])},744:function(L,V,d){L=d(0);class k{}Object(L.a)(k,"AuthContext",null,[]);var e=d(25),n=d(245);d.d(V,"a",function(){return r});class r{static getAuthContext(){const w=e.AFrameworkApplication.fa.Ea("UserPrincipalName")||"";let D=
w;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(D=n.a.B1k||w);return Object.assign(new k,{upn:w,loginHint:D,authority:n.a.authority,authorityType:r.KZc(),tenantId:e.AFrameworkApplication.fa.Ea("TenantId")||""})}static KZc(){let w=0;const D=r.kgg();"aad"===D.toLowerCase()?w=2:"msa"===D.toLowerCase()&&(w=1);return w}static kgg(){return e.AFrameworkApplication.fa.Ea("HostAuthType")||""}}Object(L.a)(r,"OAuthIdentity",null,[])},748:function(L,
V,d){L=d(0);var k=d(25),e=d(74),n=d(55),r=d(46),w=d(103);class D{constructor(B,H){this.message=B;this.Uj=H}}Object(L.a)(D,"CrossDocumentEventArgs",null,[]);var y=d(539),m=d(177),C=d(584),E=d(948);d.d(V,"a",function(){return F});class F{constructor(B,H,K,A){this._name="";this.oPa={};this.Rzf=null;this.ackMessageHandler=W=>{W=W.CorrelationId;""!==W&&W in this.oPa&&(E.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.oPa[W],W),this.oPa[W]="ACK_RECEIVED")};this.WXk=W=>{const N=
this.vFj(W);if(!N)return!1;if(this.W8[N.MessageId])return this.e_b.R5c(this.W8[N.MessageId],N),!0;if(this.kda[N.MessageId]){const P=this.kda[N.MessageId];W=new D(N,W);this.e_b.Vck(P,W);return!0}return!1};this.i0b=[];this.VXb=[];this.WXb=[];this.v_b=[];this.QGf=B;this.PGf=H;this.W8={};this.kda={};this.e_b=K;F._id++;A&&A();this.FH=this.enable()}get nOa(){return this.PGf}get eXh(){return this.QGf}enable(){if(!C.a())return E.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.lck();
E.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.FH}lck(){E.a.debugAssertTag(5018253,!!this.e_b,null);this.Rzf=this.WXk;this.e_b.BGi(this.Rzf)}disable(){this.FH=!1;this.i0b=[];this.VXb=[];this.WXb=[];this.v_b=[];this.QGf=null;this.PGf="";this.e_b.Raj();this.W8={};this.kda={}}dispose(){this.disable()}qwe(B){return!!this.i0b&&Array.contains(this.i0b,B)||this.vDg(B)}vDg(B){return!!this.VXb&&Array.contains(this.VXb,B)}Bv(B){E.a.debugAssertTag(5018259,!!this.i0b,null);Array.add(this.i0b,
B);E.a.sendTraceTag(5018260,2,"Allow receiving : {0}",B)}oJf(B){E.a.debugAssertTag(5018261,!!this.VXb,null);Array.add(this.VXb,B);E.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",B)}Blk(B){return!!this.WXb&&Array.contains(this.WXb,B)}pJf(B){E.a.debugAssertTag(5018263,!!this.WXb,null);Array.add(this.WXb,B);E.a.sendTraceTag(5018264,2,"Allow free sending: {0}",B)}qfc(B){B=e.a.CR(B);return!!B&&!!this.v_b&&Array.contains(this.v_b,B)}ODa(B){E.a.debugAssertTag(5018265,!!this.v_b,null);if(B===F.r3b)return E.a.debugAssertTag(5018266,
!1,null),!1;let H=e.a.CR(B);if(!H)return E.a.sendTraceTag(5018267,4,"Get origin fail:{0}",B),!1;k.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(H=r.a.Dg(H));Array.add(this.v_b,H);E.a.sendTraceTag(5018268,2,"Add origin:{0}",H);return!0}send(B,H){H=void 0===H?null:H;let K=this.nOa;if(H){H=e.a.CR(H);if(!H)return!1;K=H}return this.vnb(B,this.eXh,K)}sendMessage(B,H,K){K=(K=void 0===K?"":K)&&""!==K?K:w.a.create().toString();return this.send(this.AWe(B,
H,K,k.AFrameworkApplication.userSessionId))}postMessage(B){const H=w.a.create().toString();if(!k.AFrameworkApplication.fa.getBooleanAppSetting("RetryablePostMessagingIsEnabled")||!B.gAd)return this.send(this.AWe(B.messageId,B.values,H,B.userSessionId));this.W8[B.hNc]||(this.Bv(B.hNc),this.dD(B.hNc,this.ackMessageHandler));this.oPa[H]="";return this.kvh(B,H,1)}kvh(B,H,K){if(""!==H&&H in this.oPa&&"ACK_RECEIVED"===this.oPa[H])return delete this.oPa[H],!0;if(K>B.Mya)return E.a.sendTraceTag(40716250,
4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',B.hNc,H),delete this.oPa[H],!1;E.a.sendTraceTag(40716251,1<K?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',B.Mya-K,B.messageId,H);K++;window.setTimeout(()=>{this.kvh(B,H,K)},B.esi);B.values[m.a.dsi]=!0;return this.send(this.AWe(B.messageId,B.values,H,B.userSessionId))}AWe(B,H,K,A){B=new y.a(B);B.CorrelationId=K;H&&(B.Values=H);B.Values.wdUserSession=A;return B}vnb(B,H,K){E.a.debugAssertTag(5018269,
!!B,null);if(!this.FH)return!1;E.a.debugAssertTag(5018270,!!H,null);E.a.debugAssertTag(5018271,!!K,null);if(!H||!K)return E.a.debugAssertTag(5018272,!1,null),!1;if(K===F.r3b&&!this.Blk(B.MessageId))return E.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:B.MessageId}),!1;B.SendTime=(new Date).getTime();let A="";try{A=Sys.Serialization.JavaScriptSerializer.serialize(B)}catch(W){return E.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:W.message}),!1}H=F.sendMessage(H,A,
K);E.a.sendTraceTag(5018275,2,"Send {0}. {1}",H?"succeeded":"failed",{["id"]:B.MessageId,["origin"]:K});return H}dD(B,H){E.a.debugAssertTag(5018304,!!H,null);E.a.debugAssertTag(5018305,!!this.W8&&!!this.kda,null);this.FH&&(this.qwe(B)?this.W8[B]!==H&&(E.a.debugAssertTag(5018307,!this.W8[B]&&!this.kda[B],null),this.W8[B]=H,delete this.kda[B]):E.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:B}))}p2a(B,H){E.a.debugAssertTag(40420062,!!H,null);E.a.debugAssertTag(40420063,!!this.kda&&!!this.W8,
null);this.FH&&(this.qwe(B)?this.kda[B]!==H&&(E.a.debugAssertTag(40420065,!this.W8[B]&&!this.kda[B],null),this.kda[B]=H,delete this.W8[B]):E.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:B}))}Vfm(B){this.FH&&(this.W8[B]&&delete this.W8[B],this.kda[B]&&delete this.kda[B])}vFj(B){const H=new Date;this.kDk(B);if(!B.origin||!B.source||void 0===B.data||null===B.data)return E.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const K=this.muk(B.data);if(!K)return null;
if(!this.qfc(B.origin)){if(!this.vDg(K.MessageId))return E.a.sendTraceTag(5018309,1,"{0}",{["id"]:K.MessageId}),null;if(!n.a.Leb&&B.source!==this.eXh)return E.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}E.a.debugAssertTag(5018311,!!K.Values,null);K.Values.m_Source=B.source;K.Values.m_Origin=B.origin;K.Values.m_ReceivedTime=H.getTime();return K}muk(B){if(!B)return null;let H=null;try{H=Sys.Serialization.JavaScriptSerializer.deserialize(B,!0)}catch(W){return 2>
F.Jqf&&(E.a.sendTraceTag(5018312,2,"Deser failed"),F.Jqf++),null}if(!H)return E.a.debugAssertTag(5018313,!1,null),null;for(B=0;B<F.kUc.length;B++)if(!H[F.kUc[B]])return"MessageId"!==F.kUc[B]&&E.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",F.kUc[B]),null;if(H.Values)try{H.Values}catch(W){return E.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",W.message),null}else E.a.sendTraceTag(41502556,2,"No values in message");B=H.MessageId;if(!this.qwe(B))return E.a.sendTraceTag(5018315,
1,"Ignore recvd {0}",{["id"]:B}),null;const K=H.SendTime,A=(new Date).getTime()-K;if(0>K)return E.a.sendTraceTag(520435660,2,"{0}",{["t"]:K,["id"]:B}),null;6E4<A&&E.a.sendTraceTag(520435659,2,"{0}",{["t"]:K,["delta"]:A,["id"]:B});-300>A&&E.a.sendTraceTag(520435658,2,"{0}",{["t"]:K,["delta"]:A,["id"]:B});B=new y.a;B.MessageId=H.MessageId;B.SendTime=H.SendTime;B.CorrelationId=H.CorrelationId;H.Values&&(B.Values=H.Values);E.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",
B.MessageId,B.SendTime,B.CorrelationId);return B}kDk(B){E.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:B.origin,["data"]:B.data,["source"]:B.source}))}static sendMessage(B,H,K){if(!C.a())return E.a.debugAssertTag(5018319,!1,null),!1;try{return B.postMessage(H,K),!0}catch(A){E.a.sendTraceTag(5018320,4,"{0}",{["exception"]:A.message})}return!1}}F.kUc=["MessageId","SendTime"];F.r3b="*";F._id=0;F.Jqf=0;Object(L.a)(F,"CrossDocumentMessenger",null,[106,225])},749:function(L,V,d){L=
d(0);class k{}k.slideType="slide";k.shapeType="shape";k.sxb="chart";Object(L.a)(k,"ClipserviceDataConstants",null,[]);d.d(V,"b",function(){return e});d.d(V,"a",function(){return n});const e=r=>r===k.slideType?1:r===k.shapeType?2:r===k.sxb?3:0,n=r=>1===r?k.slideType:2===r?k.shapeType:""},750:function(L,V,d){L=d(0);var k=d(18),e=d(46),n=d(867),r=d(232),w=d(233),D=d(234),y=d(500);class m{constructor(E,F){this.N2a=E;this.description=F}}Object(L.a)(m,"ColorEntry",null,[]);d.d(V,"a",function(){return C});
class C{constructor(E){this.aDe={};this.NOe=null;this.rn=E}get V4l(){if(!this.NOe){const E=new Sys.StringBuilder;for(const F of this.standardColors)E.append(String.format(C.k3d,this.zYh(F.N2a),this.Jef(F.N2a),F.description));this.NOe=E.toString()}return this.NOe}get standardColors(){let E;return E=new k.a,E.add(new m(12582912,ResourceStrings.L_FontColorDarkRed)),E.add(new m(16711680,ResourceStrings.L_FontColorRed)),E.add(new m(16760832,ResourceStrings.L_FontColorOrange)),E.add(new m(16776960,ResourceStrings.L_FontColorYellow)),
E.add(new m(9621584,ResourceStrings.L_FontColorLightGreen)),E.add(new m(45136,ResourceStrings.L_FontColorDarkGreen)),E.add(new m(45296,ResourceStrings.L_FontColorLightBlue)),E.add(new m(28864,ResourceStrings.L_FontColorBlue)),E.add(new m(8288,ResourceStrings.L_FontColorDarkBlue)),E.add(new m(7352480,ResourceStrings.L_FontColorPurple)),E}zYh(E){return String.format("#{0}",D.i(E))}Jef(E){return D.i(E)}RAc(E){return Object.assign(new w.a,{ThemeColor:E.ThemeColor,ColorLuminance:E.ColorLuminance,FTintColor:E.FTintColor}).toString()}cme(E,
F,B){const H=new Sys.StringBuilder;H.append(this.x2d("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,E));this.Iwi(H);H.append(this.w2d());H.append(this.x2d("StandardColors",ResourceStrings.L_StandardFontColor,!1,E));H.append(this.V4l);H.append(this.w2d());F&&0<F.length&&(H.append(this.x2d("RecentColors",ResourceStrings.L_RecentColors,!1,B)),H.append(this.DJj(F)),H.append(this.w2d()));return H.toString()}DJj(E){const F=new Sys.StringBuilder;for(let B=0;B<E.length;B++){const H=E[B];F.append(String.format(C.k3d,
"#"+H.hex,H.hex,"#"+H.hex))}return F.toString()}x2d(E,F,B,H){return String.format(C.FMi,E,F,"ColorPicker",B?'McuLayout = "true" ':"",H)}w2d(){return C.EMi}Iwi(E){const F=Array(10);F[0]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Background1));F[1]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Text1));F[2]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Background2));F[3]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Text2));F[4]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Accent1));
F[5]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Accent2));F[6]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Accent3));F[7]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Accent4));F[8]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Accent5));F[9]=this.wM(r.Color.Fj(this.rn.PresetSchemeColorMapping.Accent6));const B=Array(10);B[0]=ResourceStrings.l_ThemeLabel1;B[1]=ResourceStrings.l_ThemeLabel2;B[2]=ResourceStrings.l_ThemeLabel3;B[3]=ResourceStrings.l_ThemeLabel4;B[4]=ResourceStrings.l_ThemeLabel5;
B[5]=ResourceStrings.l_ThemeLabel6;B[6]=ResourceStrings.l_ThemeLabel7;B[7]=ResourceStrings.l_ThemeLabel8;B[8]=ResourceStrings.l_ThemeLabel9;B[9]=ResourceStrings.l_ThemeLabel10;for(let H=0;5>=H;H++)for(let K=0;K<F.length;K++)E.append(this.Psj(F[K][H],F[K][0],B[K],H,K))}wM(E){const F=e.a.px(E.r,2)+e.a.px(E.g,2)+e.a.px(E.b,2);if(this.aDe[F])return this.aDe[F];const B=y.a.rVa(E),H=[];Array.add(H,E);if(E.Oce())for(var K=0;K<n.a.K5h.length;++K)E=y.a.x$b(B),E.darken(n.a.K5h[K]/100),Array.add(H,E.zva());
else if(E.Rkj())for(K=0;K<n.a.$Qf.length;++K)E=y.a.x$b(B),E.lighten(n.a.$Qf[K]/100),Array.add(H,E.zva());else if(B.lum<C.oMi)for(K=0;K<n.a.qLg.length;++K)E=y.a.x$b(B),E.lighten(n.a.qLg[K]/100),Array.add(H,E.zva());else if(B.lum>C.nMi)for(K=0;K<n.a.pLg.length;++K)E=y.a.x$b(B),E.darken(n.a.pLg[K]/100),Array.add(H,E.zva());else for(K=0;K<n.a.nSc.length+n.a.pYf.length;++K)E=y.a.x$b(B),K<n.a.nSc.length?E.lighten(n.a.nSc[K]/100):E.darken(n.a.pYf[K-n.a.nSc.length]/100),Array.add(H,E.zva());return this.aDe[F]=
H}Psj(E,F,B,H,K){E=this.Jef(E.N2a);const {lSc:A,JTb:W}=this.Bge(F,E,B,H,K);return String.format(C.k3d,A,E,W)}Bge(E,F,B,H,K){var A;var W=A=null;if(0>H)return{lSc:A,JTb:W};F=Object.assign(new w.a,{RGBColor:F,ThemeColor:K,ColorLuminance:0,FTintColor:!1});H?(K=y.a.rVa(E),W=H-1,K.lum?1===K.lum?(H=!1,W=[242,217,191,166,127][W]):.8<K.lum?(H=!1,W=[229,191,127,64,25][W]):.2>K.lum?(H=!0,W=[25,64,127,191,229][W]):(K=[51,102,153],A=[191,127],W=(H=W<K.length)?K[W]:A[W-K.length]):(H=!0,W=[127,166,191,217,242][W]),
W=255-W,W=Math.round(100*W/255),F.ColorLuminance=100-W,F.FTintColor=H,W=String.format(H?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,E.toString(),B,W)):W=String.format(ResourceStrings.l_ColorPickerTooltipBase,E.toString(),B);A=this.RAc(F);return{lSc:A,JTb:W}}}C.FMi='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';C.EMi="</Colors></ColorPicker></Controls></MenuSection>";C.k3d='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';
C.oMi=.2;C.nMi=.8;Object(L.a)(C,"ColorPickerBuilder",null,[])},751:function(L,V,d){var k=d(103),e=d(55),n=d(74),r=d(25),w=d(35),D=d(86),y=d(28),m=d(235),C=d(331),E=d(27),F=d(1002);L=d(0);class B{constructor(){this.wA=this.uu=this.FTe=this.D_d=this.gvh=null}}Object(L.a)(B,"UploadFileDialogData",null,[]);var H=d(71),K=d(30);L=d(75);d.d(V,"d",function(){return W});d.d(V,"e",function(){return N});d.d(V,"a",function(){return G});d.d(V,"c",function(){return Y});d.d(V,"b",function(){return ba});const A=
new L.a,W=(ha,ka,ca,ia,oa)=>{const sa=String.format("{0}{1}",ca,k.a.create().toString());return Object.assign(new B,{D_d:Q(sa,ia),gvh:U(ca,ia),FTe:(Ca,Ta)=>{switch(ca){case "video":Ta.blockContent(oa,ha);break;default:Ta.blockContent(Ca,"Insert Media")}},uu:(Ca,Ta,R,Ha,da,Ba)=>{ka(ha,sa,Ta,R,da,Ba,oa)},wA:(Ca,Ta,R,Ha,da)=>{R.iP(Ta)?E.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+Ta.ula):R.iP(oa)&&E.a.J(509666848,822,
15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+oa.ula);K.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(ca)?R.vL(oa):R.vL(Ta);Ta=null;try{const Ba=w.a(Ca);Ta=Ba?Ba.Error:null}catch(Ba){E.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",Ca)}if(!Ta){let Ba;K.a("FixHideShimmerIssueOnUploadFailure")&&Ca&&!isNaN(parseInt(Ca))&&(Ba=Enum.parse(m.a,m.a[parseInt(Ca)],!0));Ta=Object.assign(new C.a,
{Code:Ba?Ba:444})}da&&(da.finish(),da=null);E.a.J(509727821,822,10,"Upload media failed");G(ca)?Y(ResourceStrings.l_FileInsertFailedMessageTitle,Ta&&449===Ta.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):P(Ha,da,Ta.Code,null)}})},N=(ha,ka,ca,ia)=>new Promise((oa,sa)=>{const Ca=new F.a(ia);E.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}",ha&&ha.value?ha.files.length:0,F.a.uhe(ha));ca&&ca.Wa("MediaFileValidationStarts",
String.format("Number of media files: {0}, media file extension: {1}",ha&&ha.value?ha.files.length:0,F.a.uhe(ha)));if(ha&&ha.value&&ha.value.length)if(Ca.Umm(ha.value)){var Ta=ha.files[0];if(Ca.Vmm(Ta.size))Ca.aSi(Ta).then(R=>{R?(ca&&ca.Wa("MediaFileValidationPassedOnUI","true"),oa(!0)):(G(ia)?Y(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Ca.npa.join(", ")]):P(ka,ca,443,[Ca.npa.join(", ")]),sa(443))},()=>{E.a.J(509727825,822,10,"Invalid media file, fileType:{0}",
ia);G(ia)?Y(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Ca.npa.join(", ")]):P(ka,ca,443,[Ca.npa.join(", ")]);sa(443)});else{E.a.J(509727826,822,10,"video"===ia?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${Ta.size}`);Ta=K.a("FetchMediaSizeLimitFromValidationHelper")?Ca.amc.toString():"16";const R="video"===ia?450:442;G(ia)?Y(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,
[Ta]):P(ka,ca,R,[Ta]);sa(442)}}else E.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===ia||void 0===ia?void 0:ia.toString(),F.a.uhe(ha)),G(ia)?Y(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Ca.npa.join(", ")]):P(ka,ca,441,[Ca.npa.join(", ")]),sa(441);else G(ia)?Y(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):P(ka,ca,440,null),sa(440)}),P=(ha,ka,ca,ia)=>{ka&&(ka.Wa("MediaFileValidationPassedOnUI",
"false"),ca&&ka.Wa("ErrorCode",ca.toString()),ka.finish());ha.iI(ca,oa=>{oa.yD=1;oa.YUa=ia;return!1})},U=(ha,ka)=>{let ca="MediaUpload.ashx";if(y.App.webServiceBase)ca=y.App.webServiceBase+ca;else if(e.a.jg||e.a.zwa)ca=n.a.$ua(ca);let ia="";switch(ha){case "audio":ia="audio";break;case "captions":ia="captions";break;case "video":ia="video";break;default:E.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}ca+=String.format("?MediaType={0}&{1}&{2}&{3}",ia,r.AFrameworkApplication.jWa(),
ka.presentationId.string,r.AFrameworkApplication.O$b());ka.podSessionId&&(ca+=String.format("&{0}={1}",D.a.Mba,ka.podSessionId));ka.$k&&(ca+=String.format("&waccluster={0}",ka.$k));return ca},Q=(ha,ka)=>{const ca=new H.a;ca.$("PresentationId",ka.presentationId.string);ca.$(D.a.Zpa,ka.sessionInfo);ca.$("Canary",r.AFrameworkApplication.gC);ca.$("access_token",r.AFrameworkApplication.accessToken);ca.$("MediaToken",ha);return ca},G=ha=>K.a("EnableCalloutNotificationsForVideos")&&"video".match(ha)?!0:
!1,Y=(ha,ka,ca)=>{const ia=new C.a;ia.Title=ha;ia.Message=ka;ia.ExtraErrorParam=ca;A.raiseEvent("videoCalloutNotificationEvent",ia)},ba=ha=>{A.addHandler("videoCalloutNotificationEvent",ha)}},937:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.wSe="TraceIdNoBar";k.p$c="TraceIdLeftBar";k.Awd="TraceIdRightBar";k.dQc="TraceIdBothBar";Object(L.a)(k,"ConsistencyCheckTraceIdType",null,[])},938:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(527);class e{constructor(){this.start=
new k.a;this.end=new k.a}clone(){return Object.assign(new e,{start:this.start.clone(),end:this.end.clone()})}merge(n){let r=!1;n.start&&(r=this.start.merge(n.start));n.end&&(r=this.end.merge(n.end)||r);return r}}Object(L.a)(e,"TextNodeSelection",null,[])},939:function(L,V,d){d.d(V,"a",function(){return 19})},940:function(L,V,d){d.r(V);d.d(V,"WordPredictionAugLoopResponseManager",function(){return C});L=d(0);V=d(18);var k=d(409),e=d(941),n=d(671),r=d(669),w=d(670),D=d(560),y=d(63),m=d(33);class C{mcc(E){C.AU.bL(()=>
{this.oXl(E)||(this.rff(E),this.Rkm(),this.LEi())},"WPT:PR")}LEi(){var E=!0;E=void 0===E?!1:E;const F=D.a.YE.z7,B=D.a.YE.Flb;if(F){var H=y.a.instance.Oa.kb;if(H&&H.vf&&D.a.lAg(H.vf)){H=H.vf.node;var K=m.ParagraphReader.text(H);K=K.substring(F.cyd,K.length);H=this.Vhe(H,F,K);"string"===typeof H?H.length?(F.w$=H,F.mSb+=1,D.a.x0d(F.text,H),E&&(this.Ojm(),F.OWe=K,this.Njm(F))):B&&0===B[n.a.status]?(this.X2h(),D.a.Yvd()):this.hlm():(this.X2h(),D.a.Yvd())}}}Njm(E){C.TGd.count>=C.cji&&C.TGd.removeAt(0);
C.TGd.add(this.TUi(E))}TUi(E){return Object.assign(new e.a,{id:E.id,IAa:E.IAa,Ly:E.Ly,cyd:E.cyd,text:E.text,w$:E.w$,m5b:E.m5b,A$a:E.A$a,score:E.score,$ef:E.$ef,Zef:E.Zef,DQ:E.DQ,mSb:E.mSb,OWe:E.OWe})}oXl(E){if(E&&E.parentPath&&7===E.parentPath.length){const F=E.parentPath[6];D.a.J1a.add(F,w.a.X_d,(new Date).getTime());D.a.bzk(F)}else return D.a.rhc(w.a.dbe),!0;return D.a.$Xa?(E=this.lqg(E),E=this.iwh(E[0]),E[n.a.status]=5,D.a.ree(E),D.a.rhc(w.a.NSh),!0):!1}rff(E){(E=this.lqg(E))&&E.length?(D.a.YE.z7=
E[0],D.a.YE.NYh=E.length,D.a.YE.Flb=this.iwh(E[0])):(D.a.Yvd(),D.a.rhc(w.a.dbe))}lqg(E){if(!E||!E.items||!E.parentPath||7!==E.parentPath.length)return null;var F=E.items[0];let B;try{B=F.body}catch(N){return null}F=E.parentPath[2];const H=parseInt(E.parentPath[3]),K=parseInt(E.parentPath[4]),A=E.parentPath[5];E=E.parentPath[6];if(!B.predictions.length)return null;D.a.HRl(B.modelInfo);const W=Array(B.predictions.length);for(let N=0;N<B.predictions.length;N++){const P=B.predictions[N];if(P.text){const U=
P.characterRange,Q=P.tokenRange;W[N]=Object.assign(new e.a,{id:A,IAa:E,Ly:F,cyd:H,text:P.text,w$:P.text.substr(U.start),m5b:U.start,A$a:U.length,score:P.score,$ef:Q.start,Zef:Q.length,DQ:K,mSb:0})}}return W}iwh(E){const F={};F[n.a.language]="en-US";const B=D.a.LFj();F[n.a.modelId]=B.modelId;F[n.a.modelVersion]=B.modelVersion;F[n.a.configId]=B.configId;F[n.a.m4d]=E.A$a;F[n.a.wRc]=E.A$a;F[n.a.HHg]=E.w$.length;F[n.a.awh]=E.text.length;F[n.a.dwh]=E.text.split(" ").length;F[n.a.score]=E.score;F[n.a.status]=
0;F[n.a.Bgf]=E.w$.length;F[n.a.DQ]=E.DQ;E=D.a.J1a.ga(E.IAa);F[n.a.oYh]=E[w.a.X_d]-E[w.a.azc];F[n.a.dDd]=0;return F}Rkm(){const E=D.a.YE.z7;E&&(D.a.Bwa(E.DQ,r.a.lVf,D.a.YE.NYh),D.a.Bwa(E.DQ,r.a.G2f,E.A$a))}Ojm(){const E=D.a.YE.z7,F=D.a.YE.Flb;if(E&&1===E.mSb){const B=(new Date).getTime();D.a.J1a.$wg(E.IAa,w.a.yNf,B);D.a.VJg(E.IAa,!0);D.a.rhc(w.a.cwh);const H=D.a.J1a.ga(E.IAa)[w.a.azc];F[n.a.dDd]=B-H;F[n.a.status]=1;F[n.a.wRc]=E.text.length-E.w$.length;D.a.Bwa(E.DQ,r.a.UJh,1);D.a.Bwa(E.DQ,r.a.dFh,1);
D.a.Bwa(E.DQ,r.a.eFh,E.w$.length);D.a.Bwa(E.DQ,r.a.H2f,E.text.length-E.w$.length);D.a.Hjl()}}hlm(){const E=D.a.YE.z7,F=D.a.YE.Flb;E&&(F[n.a.status]=3,F[n.a.wRc]=0,F[n.a.Bgf]=E.text.length-F[n.a.m4d],D.a.ree(F),D.a.Bwa(E.DQ,r.a.w0h,1),D.a.Bwa(E.DQ,r.a.J2f,E.score),D.a.Bwa(E.DQ,r.a.x0h,E.text.length-E.A$a),D.a.Yvd())}X2h(){const E=D.a.YE.z7,F=D.a.YE.Flb;if(E){if(0===F[n.a.status]){const B=(new Date).getTime();D.a.J1a.$wg(E.IAa,w.a.wNf,B);D.a.VJg(E.IAa,!1);D.a.rhc(w.a.bwh);const H=D.a.J1a.ga(E.IAa)[w.a.azc];
F[n.a.dDd]=B-H;D.a.Bwa(E.DQ,r.a.tjh,1);F[n.a.status]=6}D.a.ree(F)}}Vhe(E,F,B){let H=null;F.Ly===E.id.toString()&&B&&F.m5b<B.length&&(E=B.substring(0,F.m5b)+F.text,E=E.replace(RegExp("\\u00a0","g")," "),B=B.replace(RegExp("\\u00a0","g")," "),0<E.length&&0<B.length&&(E.indexOf(B)||(H=E.substring(B.length,E.length))));return H}static get AU(){return k.a.instance}}C.cji=4;C.TGd=new V.a;Object(L.a)(C,"WordPredictionAugLoopResponseManager",null,[])},941:function(L,V,d){d.d(V,"a",function(){return k});L=
d(0);class k{constructor(){this.Ly=this.IAa=this.id=null;this.DQ=this.cyd=0;this.w$=this.text=null;this.mSb=this.Zef=this.$ef=this.score=this.A$a=this.m5b=0;this.OWe=null}}Object(L.a)(k,"Candidate",null,[])},942:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(L.a)(k,"ActivateAnnotationParameters",null,[])},943:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);V=d(491);var k=d(134);class e extends V.a{constructor(){super();
this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(L.a)(e,"TextPredictionAnnotation",V.a,[])},944:function(L,V,d){d.d(V,"f",function(){return e});d.d(V,"e",function(){return n});d.d(V,"i",function(){return r});d.d(V,"j",function(){return w});d.d(V,"a",function(){return D});d.d(V,
"h",function(){return y});d.d(V,"m",function(){return m});d.d(V,"n",function(){return C});d.d(V,"b",function(){return E});d.d(V,"k",function(){return F});d.d(V,"d",function(){return B});d.d(V,"o",function(){return H});d.d(V,"c",function(){return K});d.d(V,"g",function(){return A});d.d(V,"l",function(){return W});var k=d(330);class e{constructor(N){k.a.assign(e,this,N)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(N){return k.a.matchesTypesFor(N,
[e.getTypeName()])}}e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class n{constructor(N){k.a.assign(n,this,N)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(N){return k.a.matchesTypesFor(N,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(N){k.a.assign(r,this,N)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(N){return k.a.matchesTypesFor(N,
[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{constructor(N){k.a.assign(w,this,N)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class D{constructor(N){k.a.assign(D,this,N)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class y{constructor(N){k.a.assign(y,this,N)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class m{constructor(N){k.a.assign(m,this,N)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,
[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class C{constructor(N){k.a.assign(C,this,N)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class E{constructor(N){k.a.assign(E,this,N)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,
[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class F{constructor(N){k.a.assign(F,this,N)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class B{constructor(N){k.a.assign(B,this,N)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,
[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class H{constructor(N){k.a.assign(H,this,N)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class K{constructor(N){k.a.assign(K,this,N)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,
[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class A{constructor(N){k.a.assign(A,this,N)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class W{constructor(N){k.a.assign(W,this,N)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(N){return k.a.matchesTypesFor(N,
[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()}},945:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e,n,r){super();this.actionId=e;this.iEb=n;this.revisionId=r}}Object(L.a)(k,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},946:function(L,V,d){d.d(V,"c",function(){return w});d.d(V,"b",function(){return D});d.d(V,"a",function(){return y});var k=d(18),e=d(395),n=d(25),r=d(35);const w=m=>{if(!m)return null;let C;try{C=r.b(m)}catch(E){C=
null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",E)}return C},D=(m,C)=>{let E=[];if(m.breadcrumbs&&0<m.breadcrumbs.length)E=m.breadcrumbs;else{const F=m.service_info;F&&F.friendly_service_name&&Array.add(E,F.friendly_service_name);m.display_path&&Array.addRange(E,m.display_path)}return E.join(C?" \u00ab ":" \u200f\u00bb ")},y=(m,C)=>{C=void 0===C?!1:C;if(!m)return[];if(!m.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),
[];if(!m.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];m=m.documents.items;const E=new k.a;for(let B=0;B<m.length;B++){const H=m[B];var F=H.web_url;if(!F){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!H.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}F=String.format("{0}?web=1",H.url)}const K={};K.DocumentUrl=F;K.MruId=H.mru_id;{F=H;let A=F.title;A?(F.extension&&(A=String.format("{0}.{1}",A,F.extension)),F=A):(e.ULS.sendTraceTag(578352837,
202,15,"empty file title"),F="")}K.FileName=F;K.IsPinned=H.is_pinned;K.Path=D(H,n.AFrameworkApplication.isRtl);C&&(K.App=H.app,K.TimeStamp=H.time_stamp);E.add(K)}return E.toArray()}},947:function(L,V,d){d.d(V,"a",function(){return m});L=d(0);var k=d(395),e=d(1061),n=d(1264),r=d(7),w=d(18),D=d(40),y=d(30);class m{constructor(C,E,F,B,H,K,A,W,N){this.lQ=new e.a;this.mU=P=>P.KM?ResourceStrings.L_AccMessageDecorative:P.get_altTitle();this.D9g=C;this.Tb=E;this.DC=H;this.Ga=F;this.Oc=K;this.Whc=A;this.Qm=
B;this.Uh=W;this.ka=N;this.b9j()}get Kd(){return this.Oc.instance}get CG(){return this.Whc.value}b9j(){var C;this.lQ.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.lQ.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.lQ.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.lQ.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.lQ.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);
this.lQ.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.lQ.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.lQ.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.lQ.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.lQ.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.lQ.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.lQ.$(6,[ResourceStrings.l_PhTypeFooter,
ResourceStrings.l_ClickToAddFooter]);this.lQ.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber]);(null===(C=this.ka)||void 0===C?0:C.BXa)&&this.lQ.$(16,[ResourceStrings.l_PhTypeCameo,ResourceStrings.l_ClickToAddCameo])}nog(C,E){C&&(this.u$(C,E),C.Yfa?E.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.Kje(C,null,E));return null}lMj(C){if(!this.D9g.instance||!C)return null;C=this.D9g.instance.rog(C);if(!C||!C.length)return null;const E=C.length;return 1===
E?String.format(ResourceStrings.l_ShapePresenceForOneUser,C[0].userName):2===E?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,C[0].userName,C[1].userName):3===E?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,C[0].userName,C[1].userName,C[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,E)}yle(C){let E="";C&&C.NM&&C.image.title&&0<C.image.title.length&&(E=C.image.title);C&&(E=String.format(ResourceStrings.l_ThumbnailInfoNew,C.slideIndex+1,this.Tb.Hi(),
E),C=this.SPj(C),0<C.length&&(E+=C));return E}SPj(C){const E=new Sys.StringBuilder;C.isSelected&&E.append(ResourceStrings.L_SlideIsSelected);C.Hn&&E.append(ResourceStrings.l_SlideIsHidden);const F=Object(n.a)(205,C.gd);if(F){var B=F.aWa();B&&!this.Qm.ywe(B)&&E.append(ResourceStrings.l_SlideHasNotes);(B=F.fF())&&this.DC.instance&&this.DC.instance.Ztg(B)&&(B=this.DC.instance.j_c(B),E.append(1===B?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,B)))}C.bP&&
E.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(C.Hlb&&(C=C.Hlb.r$())&&0<C.length)if(1===C.length)E.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,C[0].userName));else{B="";for(const H of C)B+=H.userName+",";E.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,B))}F&&F.isUnread&&E.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return E.toString()}Ccb(C,E){return String.format(ResourceStrings.l_MultipleSlidesSelected,C,E)}xzj(C,
E){return String.format(ResourceStrings.l_DesignerSuggestionSelected,C+1,E)}RMj(){return ResourceStrings.l_SlidePanel}eGj(){return ResourceStrings.l_MultipleShapes}axl(C){C&&(this.ka.v$a&&C.C7(Object(r.a)(this,this.Jvj,"getCameoAccMessage")),C.C7(Object(r.a)(this,this.GOj,"getTableAccMessage")),C.C7(Object(r.a)(this,this.QCj,"getImageAccMessage")),C.C7(Object(r.a)(this,this.lFj,"getMediaAccMessage")),C.C7(Object(r.a)(this,this.$vj,"getChartAccMessage")),this.cAd?(C.C7(Object(r.a)(this,this.Nog,"getSmartArtAccMessage")),
C.C7(Object(r.a)(this,this.Kje,"getPlaceHolderAccMessage"))):(C.C7(Object(r.a)(this,this.Kje,"getPlaceHolderAccMessage")),C.C7(Object(r.a)(this,this.Nog,"getSmartArtAccMessage"))),C.C7(Object(r.a)(this,this.FPj,"getTextboxAccMessage")),C.C7(Object(r.a)(this,this.aMj,"getShapeGroupAccMessage")),C.C7(Object(r.a)(this,this.XLj,"getShapeAccMessage")),C.C7(Object(r.a)(this,this.Ktj,"getAddinAccMessage")),C.C7(Object(r.a)(this,this.ltj,"get3DAccMessage")))}Kje(C,E,F,B){B=void 0===B?null:B;if(C&&F&&C.Sk&&
(this.v2c(C,F),this.lQ.Ib(C.mj))){B&&B(String.format("{0} {1}",this.lQ.ga(C.mj)[0],ResourceStrings.l_Placeholder));if(C.jV||!F.count){F=this.lQ.ga(C.mj)[0];E="";if(!this.cAd||C.jV)E=this.lQ.ga(C.mj)[1];return String.format(C.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,F,this.mU(C),E,C.get_alt())}C=String.format(C.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.lQ.ga(C.mj)[0],this.mU(C),
C.get_alt());F.insert(0,document.createTextNode(C))}return null}FPj(C,E,F,B){B=void 0===B?null:B;if(C&&F&&C.Xu)if(this.v2c(C,F),B&&B(ResourceStrings.L_TextBox),0<F.count)C=String.format(C.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.mU(C),C.get_alt()),F.insert(0,document.createTextNode(C));else return String.format(C.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,this.mU(C),C.get_alt());return null}Nog(C,
E,F,B){B=void 0===B?null:B;if(C&&F&&C.ig)if(this.v2c(C,F),B&&B(ResourceStrings.L_SmartArt),0<F.count)C=String.format(C.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.Pog(C)||"",this.mU(C),C.get_alt()),F.insert(0,document.createTextNode(C));else return String.format(C.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.Pog(C)||"",this.mU(C),C.get_alt());return null}u$(C,E){C&&E&&this.Ga.lH(C,
F=>{F.Qa(D.a.np)&&this.Mkg(F,E)})}v2c(C,E){if(C&&E){const F=this.cAd?new w.a:E;let B=!1;this.Ga.lH(C,H=>{const K=this.Uh.tY(H),A=this.Uh.flb(H);K&&F.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,A)));B=this.Mkg(H,F)||B});this.cAd&&B&&E.addRange(F);E.count||(C=C.Zdf)&&E.add(document.createTextNode(C))}}get cAd(){return y.a("AriaMessageHelper.FixAccMessageForEmptyList")}Mkg(C,E){let F;const B=C.ra(D.a.vAc,null),H=C.ra(D.a.np,"");if(H&&E){if(B){let K=0,A=null,W;for(let N=
0;N<B.length+1;N++)W=this.Ga.E0c(C,N),A&&A!==W&&(F=document.createElement("span"),F.setAttribute("lang",A),F.innerText=H.substring(K,B[N-1]),K=B[N-1],E.add(F)),A=W;F=document.createElement("span");A&&F.setAttribute("lang",A);F.innerText=H.substring(K,H.length)}else F=document.createElement("span"),(C=this.Ga.E0c(C,0))&&F.setAttribute("lang",C),F.innerText=H;E.add(F)}return!!H&&0<H.length}GOj(C,E,F,B){B=void 0===B?null:B;return C&&C.vd?(B&&B(ResourceStrings.L_Table),String.format(C.get_alt()?ResourceStrings.l_AccMessageTableAlt:
ResourceStrings.l_AccMessageTable,this.mU(C),C.get_alt())):null}QCj(C,E,F,B){B=void 0===B?null:B;return C&&C.$j?(B&&B(ResourceStrings.l_Image),String.format(C.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,this.mU(C),C.get_alt())):null}Jvj(C,E,F,B){B=void 0===B?null:B;if(!C||!C.lF)return null;B&&B(ResourceStrings.l_Cameo);return C.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.mU(C),C.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,
this.mU(C),ResourceStrings.l_CameoLearnMoreMessage)}lFj(C,E,F,B){B=void 0===B?null:B;if(C){if(0===C.mediaType)return null;if(1===C.mediaType)return B&&B(ResourceStrings.l_Audio),this.ka.iR?String.format(ResourceStrings.l_AccMessageCanvasAudio,C.shapeName):String.format(C.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.mU(C),C.get_alt());if(2===C.mediaType)return B&&B(ResourceStrings.l_Video),String.format(C.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,
this.mU(C),C.get_alt())}return null}$vj(C,E,F,B){B=void 0===B?null:B;return C&&C.Lq?(B&&B(ResourceStrings.l_Chart),String.format(C.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.awj(C)||"",this.mU(C),C.get_alt())):null}aMj(C,E,F,B){B=void 0===B?null:B;return C&&C.Lf?(B&&B(ResourceStrings.L_GroupObjects),y.a("GroupShapeAltTitleFixEnabled")?String.format(C.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,C.rx().length,
C.get_alt()):String.format(C.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.mU(C),C.get_alt())):null}XLj(C,E,F,B){B=void 0===B?null:B;if(C&&F&&C.Yfa&&!C.Xu)if(this.v2c(C,F),E=this.Ga.uog(C),C.xHa&&(E=ResourceStrings.l_DecorativeLabel),B&&B(E||ResourceStrings.l_TextShape),0<F.count)C=String.format(C.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,E||ResourceStrings.l_TextShape,this.mU(C),C.get_alt()),F.insert(0,
document.createTextNode(C));else return String.format(C.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,E||ResourceStrings.l_TextShape,this.mU(C),C.get_alt());return null}Ktj(C,E,F,B){B=void 0===B?null:B;return C&&C.$r&&this.Kd&&this.CG?(C=this.CG.Q4(C),C=this.Kd.GAb(C.id),B&&B(C?C.fea:null),C?C.fea:null):null}ltj(C,E,F,B){B=void 0===B?null:B;return C&&C.F5?(B&&B(ResourceStrings.l_3DModel),String.format(C.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,
this.mU(C),C.get_alt())):null}Pog(C){return C.smartArtInfo?m.yke(C.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(k.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",C.slideId?C.slideId.toString():"",C.get_shapeId()),null)}awj(C){return m.yke(C.sxb,0,102,"L_ChartType")}mMj(C,E){return(C=this.Ga.H1c(C))&&E?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,E,C):null}static EPj(C){return m.yke(C,1,177,"L_SAType")}static yke(C,E,F,B){return C>=E&&C<=F&&(C=ResourceStrings[B+
C])?C:null}}Object(L.a)(m,"AriaMessageHelper",null,[145])},948:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{static oNl(){}static v9i(){}}k.sendTraceTag=k.oNl;k.debugAssertTag=k.v9i;Object(L.a)(k,"BULS",null,[])},949:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(1050),e=d(25),n=d(168),r=d(54);class w{constructor(D,y,m,C,E,F){this.Dda=D;this.Eda=y;this.kNd=m;this.FQ=C;this.kFc=E;this.Vqb=F}get ARh(){return!this.Eda&&!this.kNd}get lkh(){return 2===this.Vqb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get e$f(){return CommonUIStrings.l_OICErrorMessageNoOffice}get iwg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get XWa(){return CommonUIStrings.l_OICErrorHelpLink}get Vug(){return"OICFailure"}get icon(){return 3}get RIf(){return 2===this.Vqb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Qla(){return CommonUIStrings.l_DefaultDialogTitle}ssl(D){this.wkh(D)}owk(D){this.wkh(D)}wkh(D){let y=
10;1===D?(r.a.instance.resolve("Common.IOfficeTrialExperience").Cze(this.Vqb),y=3):2===D&&((!this.kNd||this.kNd(this.FQ))&&this.Eda&&k.a.instance.e5i(this.Eda,this.Dda,this.FQ),y=5);(0===D||1===D)&&this.Dda&&this.Dda(this.FQ);e.AFrameworkApplication.Nmb(n.a.srh,this.kFc,y);this.dispose()}dispose(){this.FQ=this.Eda=this.Dda=null}}Object(L.a)(w,"AOICErrorDialogWithTrial",null,[106])},950:function(L,V,d){d.d(V,"b",function(){return r});d.d(V,"g",function(){return w});d.d(V,"d",function(){return D});
d.d(V,"f",function(){return m});d.d(V,"e",function(){return C});d.d(V,"c",function(){return E});d.d(V,"a",function(){return F});var k=d(25);d(734);var e=d(1163),n=d(533);d(801);const r=()=>k.AFrameworkApplication.isEmbedded,w=()=>{const B=k.AFrameworkApplication.za.mb.mP;return!r()&&!k.AFrameworkApplication.hideHeader&&n.a()&&(B||1===k.AFrameworkApplication.hrj)},D=()=>k.AFrameworkApplication.fa.getBooleanAppSetting("DiscoverPremiumButtonEnabled"),y=()=>k.AFrameworkApplication.BQh&&!r()&&!k.AFrameworkApplication.hideHeader,
m=()=>y()&&"officecomhwa"!==(k.AFrameworkApplication.fa.Ea(k.AFrameworkApplication.uL)||"").toLowerCase()&&!k.AFrameworkApplication.Zug,C=()=>!k.AFrameworkApplication.doe&&y(),E=()=>!r()&&!k.AFrameworkApplication.hideHeader&&k.AFrameworkApplication.fa.getBooleanAppSetting("BasicChatIsEnabled"),F=()=>{if(k.AFrameworkApplication.rvg)return null;var B=!!k.AFrameworkApplication.za&&k.AFrameworkApplication.za.mb.mP;if((k.AFrameworkApplication.nxe&&k.AFrameworkApplication.z2a||k.AFrameworkApplication.hCc)&&
B)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(270).CuiHelper.Kvd});if(k.AFrameworkApplication.workflowEnabled){B="";switch(k.AFrameworkApplication.ECc){case "Assign":B=CommonUIStrings.l_Assign;break;case "Submit":B=CommonUIStrings.l_Submit}if(""!==B)return Object.assign(new e.a,{command:"2988588587",label:B,id:"btnWorkflow"})}return null}},951:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"RibbonPeripheralSection",
null,[])},952:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(L.a)(k,"ImageProps",null,[])},953:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=
this.primaryButtonProps=this.title=this.content=this.target=null}}Object(L.a)(k,"CalloutParameters",null,[])},954:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"ICalloutProps",null,[])},955:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.IsFreeForm="IsFreeForm";k.Value="Value";k.Key="Key";k.FontStyle="FontStyle";Object(L.a)(k,"ComboBoxCommandProperties",null,[])},956:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Alt="Alt";k.CommandValueId=
"CommandValueId";k.InnerHTML="InnerHTML";k.On="On";k.IsRtl="IsRtl";k.GalleryButtonProps="GalleryButtonProps";k.Text="Text";k.HighlightOn="HighlightOn";Object(L.a)(k,"GalleryButtonCommandProperties",null,[])},957:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(242);class k extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(L.a)(k,"ErrorViewProps",d.a,[])},958:function(L,V,d){d.d(V,
"a",function(){return k});L=d(0);d=d(242);class k extends d.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}Object(L.a)(k,"MultiActionButtonProps",d.a,[])},959:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"PersonaInfo",null,
[])},960:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"PersonaIdentifiers",null,[])},961:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.Hm=e}Dfe(e){const n=[];if(e)for(const D in e){var r=D,w=e[D];const y=this.Hm.phe(r);if(y)for(const m of y)n.push(appChrome.actions.updateControlHiddenState(m,w));else if(r=this.Hm.oCj(r))for(const m of r)if(m.externalUxCommandIds)for(const C of m.externalUxCommandIds)n.push(appChrome.actions.updateControlHiddenState(C,
w));else n.push(appChrome.actions.updateGroupHiddenState(m.externalUxGroupId,w))}return n}ytj(e){const n=[];if(e)for(const r in e){if(!e[r])continue;const w=r;w&&n.push(appChrome.actions.deactivateRibbonTab(w))}return n}}Object(L.a)(k,"ReactRibbonTrimmingHelper",null,[])},962:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(L.a)(k,"InsightsParameters",null,[])},963:function(L,V,d){d.d(V,"a",function(){return k});
L=d(0);class k{}k.k3f="data-ccp-timestamp";k.l3f="data-clipservice-ccpid";k.p3f="data-shapeids";k.urg="docs-internal-guid-";k.$qh="SCXO";k.zvh="SCXP";k.U5h="SCXW";k.Aih="MsoListParagraphCxSpFirst";k.Bih="MsoListParagraphCxSpLast";Object(L.a)(k,"HtmlContentMetadataConstants",null,[])},964:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Oek=e.IsBeforeReady;this.fjk=e.IsFromEndOfSlideshow;
this.summary=e.Summary}}Object(L.a)(k,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},965:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey;this.altKey=e.AltKey}}Object(L.a)(k,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},966:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(L.a)(k,"OnBrowserEventArgs",
Sys.EventArgs,[])},967:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.OAc=e.TimeLineMappings}}Object(L.a)(k,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},968:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.TSh=e.SlideLeftBound;this.PSh=e.SlideBottomBound}}
Object(L.a)(k,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},969:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(L.a)(k,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},970:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(L.a)(k,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},
971:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(L.a)(k,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},972:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.OAc=e.TimeLineMappings}}Object(L.a)(k,"OnPositionChangedEventArgs",Sys.EventArgs,[])},
973:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(1264);class e extends Sys.EventArgs{constructor(n){super();this.eZh=null;this.eZh="string"===typeof n?Object(k.a)(String,n):n.TranscriberSessionId}}Object(L.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},974:function(L,V,d){d.d(V,"a",function(){return m});L=d(0);var k=d(395),e=d(276),n=d(25),r=d(176),w=d(55),D=d(46),y=d(245);class m{static gpg(C){const E={};E.appSettings=m.Q1i();E.singleSignOnSettings=m.Cog();E.appVersion=
"16";E.appUILocale=e.a.Oe(n.AFrameworkApplication.lcid).pAb;E.dataLocale=e.a.Oe(n.AFrameworkApplication.lcid).pAb;E.osfOmexBaseUrl=n.AFrameworkApplication.fa.Ea("50");E.firstPartyManifestCDNUrl=n.AFrameworkApplication.fa.Ea("565");E.sdxCdnUrl=n.AFrameworkApplication.fa.Ea("649");E.sdx1CdnUrl=n.AFrameworkApplication.fa.Ea("Sdx1CdnUrl");E.sdxDmsUrl=n.AFrameworkApplication.fa.Ea("650");E.forceUseSdx1Cdn=n.AFrameworkApplication.fa.getBooleanAppSetting("ForceUseSdx1Cdn");E.sovereignFederationDMSToken=
n.AFrameworkApplication.fa.Ea("SovereignFederationDMSToken");E.sovereignFederationDMSTokenSuffix=n.AFrameworkApplication.fa.Ea("SovereignFederationDMSTokenSuffix");E.sdxAssetsToPrefetchMapping=n.AFrameworkApplication.fa.Ea("974");E.docUrl=C?C.documentUrl:"";E.pageBaseUrl=r.a.YN;E.lcid=n.AFrameworkApplication.lcid.toString();E.allowExternalMarketplace=n.AFrameworkApplication.fa.getBooleanAppSetting("51");E.localizedScriptsUrl=(n.AFrameworkApplication.jjf?n.AFrameworkApplication.fa.Ea("StaticContentHostNonOverriden"):
r.a.YN)+n.AFrameworkApplication.fa.Ea("52");C=C?C.Dwg:"";E.localizedImagesUrl=r.a.YN+C;E.localizedStylesUrl=r.a.YN+C;E.localizedResourcesUrl=r.a.Vri(C);E.enableAddinCommands=n.AFrameworkApplication.fa.getBooleanAppSetting("203");E.enableMyApps=n.AFrameworkApplication.fa.getBooleanAppSetting("186");E.enableMyOrg=n.AFrameworkApplication.fa.getBooleanAppSetting("InsertAgaveMyOrgEnabledForHost");E.enableUploadFileDevCatalog=n.AFrameworkApplication.fa.getBooleanAppSetting("203")&&!n.AFrameworkApplication.fa.getBooleanAppSetting("847");
E.enableDevCatalog=n.AFrameworkApplication.fa.getBooleanAppSetting("221");E.devCatalogUrl=n.AFrameworkApplication.fa.Ea("220");E.enablePrivateCatalog=n.AFrameworkApplication.fa.getBooleanAppSetting("305");E.showSignOutFromPrivateCatalogMessage=n.AFrameworkApplication.fa.getBooleanAppSetting("307");E.enableBlackForestRedirect=n.AFrameworkApplication.fa.getBooleanAppSetting("348");E.enableSingleSignOnForAddin=n.AFrameworkApplication.fa.getBooleanAppSetting("342")&&n.AFrameworkApplication.oek;E.enableTaskpaneUpgradeToAppCommand=
n.AFrameworkApplication.fa.getBooleanAppSetting("381");E.hideAppsExtensionUrl=n.AFrameworkApplication.hideAppsExtensionUrl;E.enableAnonymousUseLegacyCatalogService=n.AFrameworkApplication.fa.getBooleanAppSetting("549");E.enableInsertDialogAccessibilityFix=n.AFrameworkApplication.fa.getBooleanAppSetting("584");E.enableFirstPartySDXErrorMessages=n.AFrameworkApplication.fa.getBooleanAppSetting("677");E.disableAppsForOfficeThirdParty=n.AFrameworkApplication.fa.getBooleanAppSetting("569");E.wacSessionId=
n.AFrameworkApplication.userSessionId;E.disableLogging=!n.AFrameworkApplication.fa.getBooleanAppSetting("AriaLoggingIsEnabled");E.loggableUserId=n.AFrameworkApplication.fa.Ea("LoggableUserId");E.sessionStartInfoJson=n.AFrameworkApplication.fa.Ea("SessionStartInfoJson");E.wopiHostOriginFromPostMessage=n.AFrameworkApplication.wopiHostOriginFromPostMessage;E.wopiHostOriginFromWacPropBag=n.AFrameworkApplication.fa.Ea("PostMessageOrigin");E.wacIsEmbedded=n.AFrameworkApplication.fa.getBooleanAppSetting("IsEmbedded");
E.accessibilityAllowFocusAddinTaskpane=n.AFrameworkApplication.fa.getBooleanAppSetting("1055");E.disableMicrophonePermission=w.a.oP(1)&&n.AFrameworkApplication.fa.getBooleanAppSetting("TranscriberSafariEnabled")&&n.AFrameworkApplication.fa.getBooleanAppSetting("RehearsalSafariEnabled");E.isHostFrameTrustCheckEnabledForAddIns=n.AFrameworkApplication.fa.getBooleanAppSetting("1100");E.isHostFrameTrusted=n.AFrameworkApplication.isHostFrameTrusted;E.hostAllowedSdxEmbedding=n.AFrameworkApplication.fa.getBooleanAppSetting("HostAllowedSdxEmbedding");
E.hostAllowedOfficeStore=n.AFrameworkApplication.fa.getBooleanAppSetting("HostAllowedOfficeStore");E.hostInstallAddIns=n.AFrameworkApplication.fa.Ea("HostInstallAddIns");E.hostInstallAddInsIsEnabled=n.AFrameworkApplication.fa.getBooleanAppSetting("HostInstallAddInsIsEnabled");E.approvedAddIns=n.AFrameworkApplication.fa.Ea("ApprovedAddIns");E.isUpnCheckEnabled=n.AFrameworkApplication.fa.getBooleanAppSetting("1132");E.wacUpn=n.AFrameworkApplication.fa.Ea("UserPrincipalName");E.isReactRibbonEnabled=
!0;E.enableSetFocusOnTaskpaneOnUserAction=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);E.enableMyOrg&&E.docUrl&&(C=E.docUrl.split("/"),E.spBaseUrl=2<C.length?C[0]+"//"+C[2]:null,E.spBaseUrl||k.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",E.docUrl)));E.userNameHashCode=D.a.gM(n.AFrameworkApplication.userName);E.envCode=n.AFrameworkApplication.fa.tc("312",0).toString();
return E}static Q1i(){const C={};C.AddinRibbonIdAllowUnknown=n.AFrameworkApplication.fa.getBooleanAppSetting("AddinRibbonIdAllowUnknown");C.AddinRibbonNativeGroupControlIsEnabled=!0;C.AddinRibbonTabAutoFocusIsEnabled=!0;C.AddinRibbonTabPositionIsEnabled=!0;C.AgaveAddinUploadEnabled=n.AFrameworkApplication.fa.getBooleanAppSetting("AgaveAddinUploadEnabled");C.DevConsoleEnabled=n.AFrameworkApplication.fa.getBooleanAppSetting("AddinDevConsoleLog");C.ManifestParserDevConsoleEnabled=!0;C.flightingTreatmentVariables=
n.AFrameworkApplication.fa.b$b;C.DisabledChangeGates=n.AFrameworkApplication.fa.Ea("DisabledChangeGates");C.DmsSdxListPresentation=n.AFrameworkApplication.D6f;return C}static Cog(){try{const C={};w.a.gIa&&y.a.Ddb&&(C.UiHostSupportsAuthTokenAddinList=m.xYc);C.UiHostSupportsAuthToken=y.a.Ddb;return C}catch(C){k.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",C.message)}return null}}m.xYc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
Object(L.a)(m,"AppForOfficeHelper",null,[])},975:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.rSe=e}}Object(L.a)(k,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},976:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n,r){this.B0a={};this.zhd=e;this.rfd=n;this.Qkc=r}Dva(e,n,r){let w=k.O3f;if(this.rfd)if(this.Qkc){const D=e.UserId?e.UserId.toLowerCase():null;n=n?n.toLowerCase():null;w=D&&D in this.B0a?
this.B0a[D]:n&&n in this.B0a?this.B0a[n]:this.zhd.Dva(e,r);!D||D in this.B0a||(this.B0a[D]=w);!n||n in this.B0a||(this.B0a[n]=w)}else w=this.zhd.Dva(e,r);return w}}k.O3f="#C0C0C0";Object(L.a)(k,"PresenceColorProvider",null,[931])},977:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.uE=e}}Object(L.a)(k,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},978:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(1210),e=d(25),n=d(35),
r=d(74);class w{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}HQb(){return n.c([this.om(),this])}execute(D,y,m){let C="RoamingAppsHandler.ashx";k.a.instance.BHh&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(C=r.a.Xi(C,"wdEnableRoaming","1"));e.AFrameworkApplication.Me.Tj(C,2,this.HQb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.HBb(),D,y,m,void 0,void 0,void 0,void 0,"6")}}Object(L.a)(w,"ARoamingAppsRequest",null,[])},979:function(L,V,d){d.d(V,"a",
function(){return 2});d.d(V,"c",function(){return k});d.d(V,"b",function(){return e});const k=(n,r,w)=>{w=void 0===w?2:w;let D;if(0>r||r>n[n.length-1])throw Error.argumentOutOfRange("y");D=!0;let y=0,m;const C=n.length-1;for(m=0;m<C;m++){const E=y;y=n[m+1];if(r<y){y-r<w&&m<C-1?m++:r-E>=w&&(D=!1);break}}return{returnValue:m<C?m:-1,Dwe:D}},e=(n,r,w)=>{w=void 0===w?2:w;let D;if(0>r||r>n[n.length-1])throw Error.argumentOutOfRange("x");D=!0;let y=0,m;const C=n.length-1;for(m=0;m<C;m++){const E=y;y=n[m+
1];if(r<y){y-r<w&&m<C-1?m++:r-E>=w&&(D=!1);break}}return{returnValue:m<C?m:-1,Dwe:D}}},980:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.MTa=this.IX=0;this.skipUndo=!1;this.nq=this.selectionSlide=null;this.version=0;this.EE=this.location=null;this.dataType=0;this.Dqc=null;this.objectCount=0;this.zHa=this.BHa=!1;this.Cz=this.Lua=this.nodes=null}toString(){const e=JSON.stringify(this.Lua);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",
this.nq,this.version,this.EE,this.dataType,this.objectCount,this.BHa,this.zHa,e,this.IX)}}Object(L.a)(k,"ClipServiceObject",null,[])},981:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.Cv=e;this.$b=n}}Object(L.a)(k,"ClipServiceCopyParams",null,[])},982:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(395),e=d(99);V=d(983);var n=d.n(V),r=d(216);class w{static Myd(D,y,m){if(D&&m&&(e.a.EEa(D),y&&""!==y))try{r.a("HtmlStringSanitizeByDomPurify")&&(y=
n.a.sanitize(y));const C=w.idi.parseFromString(y,"text/html");if(C&&C.body){const E=C.body.childNodes;for(y=0;y<E.length;y+=1)D.appendChild(E[y].cloneNode(!0))}}catch(C){k.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",m,C.message)}}}w.idi=new DOMParser;Object(L.a)(w,"DOMParserHelper",null,[])},983:function(L){(function(V,d){L.exports=d()})(this,function(){function V(jc,pb){if("object"!==d(jc)||"function"!==typeof jc.createPolicy)return null;var $a=null;pb.currentScript&&
pb.currentScript.hasAttribute("data-tt-policy-suffix")&&($a=pb.currentScript.getAttribute("data-tt-policy-suffix"));pb="dompurify"+($a?"#"+$a:"");try{return jc.createPolicy(pb,{createHTML:function(zc){return zc},createScriptURL:function(zc){return zc}})}catch(zc){return console.warn("TrustedTypes policy "+pb+" could not be created."),null}}function d(jc){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(pb){return typeof pb}:function(pb){return pb&&
"function"==typeof Symbol&&pb.constructor===Symbol&&pb!==Symbol.prototype?"symbol":typeof pb},d(jc)}function k(jc,pb){k=Object.setPrototypeOf||function($a,zc){$a.__proto__=zc;return $a};return k(jc,pb)}function e(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.NDm)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(jc){return!1}}function n(jc,pb,$a){n=e()?Reflect.construct:function(zc,
rb,ib){var Vb=[null];Vb.push.apply(Vb,rb);zc=new (Function.bind.apply(zc,Vb));ib&&k(zc,ib.prototype);return zc};return n.apply(null,arguments)}function r(jc){var pb=Array.isArray(jc)?w(jc):void 0;pb||(pb="undefined"!==typeof Symbol&&null!=jc[Symbol.iterator]||null!=jc["@@iterator"]?Array.from(jc):void 0);if(!pb)a:{if(jc){if("string"===typeof jc){pb=w(jc,void 0);break a}pb=Object.prototype.toString.call(jc).slice(8,-1);"Object"===pb&&jc.constructor&&(pb=jc.constructor.name);if("Map"===pb||"Set"===
pb){pb=Array.from(jc);break a}if("Arguments"===pb||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(pb)){pb=w(jc,void 0);break a}}pb=void 0}if(!(jc=pb))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return jc}function w(jc,pb){if(null==pb||pb>jc.length)pb=jc.length;for(var $a=0,zc=Array(pb);$a<pb;$a++)zc[$a]=jc[$a];return zc}function D(jc){return function(pb){for(var $a=arguments.length,zc=
Array(1<$a?$a-1:0),rb=1;rb<$a;rb++)zc[rb-1]=arguments[rb];return Q(jc,pb,zc)}}function y(jc,pb,$a){$a=$a?$a:ka;B&&B(jc,null);for(var zc=pb.length;zc--;){var rb=pb[zc];if("string"===typeof rb){var ib=$a(rb);ib!==rb&&(H(pb)||(pb[zc]=ib),rb=ib)}jc[rb]=!0}return jc}function m(jc){var pb=P(null),$a;for($a in jc)Q(F,jc,[$a])&&(pb[$a]=jc[$a]);return pb}function C(jc,pb){for(;null!==jc;){var $a=A(jc,pb);if($a){if($a.get)return D($a.get);if("function"===typeof $a.value)return D($a.value)}jc=K(jc)}return function(zc){console.warn("fallback value for",
zc);return null}}function E(){function jc(we){var Zc,te;$a("beforeSanitizeAttributes",we,null);var ne=we.attributes;if(ne){var Zf={attrName:"",gQf:"",EHg:!0,Qsm:Yf};for(te=ne.length;te--;){var cd=Zc=ne[te],aj=cd.name;cd=cd.namespaceURI;Zc="value"===aj?Zc.value:Ca(Zc.value);var Qc=td(aj);Zf.attrName=Qc;Zf.gQf=Zc;Zf.EHg=!0;Zf.Cqj=void 0;$a("uponSanitizeAttribute",we,Zf);Zc=Zf.gQf;if(!Zf.Cqj&&(Vb(aj,we),Zf.EHg))if(Ta(/\/>/i,Zc))Vb(aj,we);else{Hc&&(Zc=oa(Zc,Cc," "),Zc=oa(Zc,Nb," "),Zc=oa(Zc,nc," "));
var Mc=td(we.nodeName);a:{var Ig=Mc;var wg=Qc,fe=Zc;if(ue&&("id"===wg||"name"===wg)&&(fe in cb||fe in Te))Ig=!1;else{if(!Kb||Rf[wg]||!Ta(Kc,wg))if(!Za||!Ta(xd,wg))if(!Yf[wg]||Rf[wg]){if(!(0<Ig.indexOf("-")&&(ef.t3 instanceof RegExp&&Ta(ef.t3,Ig)||ef.t3 instanceof Function&&ef.t3(Ig))&&(ef.T9a instanceof RegExp&&Ta(ef.T9a,wg)||ef.T9a instanceof Function&&ef.T9a(wg))||"is"===wg&&ef.XOc&&(ef.t3 instanceof RegExp&&Ta(ef.t3,fe)||ef.t3 instanceof Function&&ef.t3(fe)))){Ig=!1;break a}}else if(!(me[wg]||
Ta(he,oa(fe,Tb,""))||("src"===wg||"xlink:href"===wg||"href"===wg)&&"script"!==Ig&&0===sa(fe,"data:")&&xf[Ig]||Ic&&!Ta(Xc,oa(fe,Tb,"")))&&fe){Ig=!1;break a}Ig=!0}}if(Ig){!Ee||"id"!==Qc&&"name"!==Qc||(Vb(aj,we),Zc="user-content-"+Zc);if(Pc&&"object"===d(ic)&&"function"===typeof ic.getAttributeType&&!cd)switch(ic.getAttributeType(Mc,Qc)){case "TrustedHTML":Zc=Pc.createHTML(Zc);break;case "TrustedScriptURL":Zc=Pc.createScriptURL(Zc)}try{cd?we.setAttributeNS(cd,aj,Zc):we.setAttribute(aj,Zc),ba(Wb.removed)}catch(Qe){}}}}$a("afterSanitizeAttributes",
we,null)}}function pb(we){$a("beforeSanitizeElements",we,null);if(we instanceof ub&&("string"!==typeof we.nodeName||"string"!==typeof we.textContent||"function"!==typeof we.removeChild||!(we.attributes instanceof ob)||"function"!==typeof we.removeAttribute||"function"!==typeof we.setAttribute||"string"!==typeof we.namespaceURI||"function"!==typeof we.insertBefore||"function"!==typeof we.hasChildNodes)||Ta(/[\u0080-\uFFFF]/,we.nodeName))return Od(we),!0;var Zc=td(we.nodeName);$a("uponSanitizeElement",
we,{tagName:Zc,Rsm:re});if(!(!we.hasChildNodes()||zc(we.firstElementChild)||zc(we.content)&&zc(we.content.firstElementChild))&&Ta(/<[/\w]/g,we.innerHTML)&&Ta(/<[/\w]/g,we.textContent)||"select"===Zc&&Ta(/<template/i,we.innerHTML))return Od(we),!0;if(!re[Zc]||yf[Zc]){if(!yf[Zc]&&0<Zc.indexOf("-")&&(ef.t3 instanceof RegExp&&Ta(ef.t3,Zc)||ef.t3 instanceof Function&&ef.t3(Zc)))return!1;if(Xe&&!af[Zc]){Zc=hc(we)||we.parentNode;var te=Qb(we)||we.childNodes;if(te&&Zc)for(var ne=te.length-1;0<=ne;--ne)Zc.insertBefore(Rc(te[ne],
!0),Fb(we))}Od(we);return!0}if(te=we instanceof Vc){(te=hc(we))&&te.tagName||(te={namespaceURI:de,tagName:"template"});ne=ka(we.tagName);var Zf=ka(te.tagName);te=!(ta[we.namespaceURI]&&("http://www.w3.org/2000/svg"===we.namespaceURI?"http://www.w3.org/1999/xhtml"===te.namespaceURI?"svg"===ne:"http://www.w3.org/1998/Math/MathML"===te.namespaceURI?"svg"===ne&&("annotation-xml"===Zf||Hd[Zf]):$e[ne]:"http://www.w3.org/1998/Math/MathML"===we.namespaceURI?"http://www.w3.org/1999/xhtml"===te.namespaceURI?
"math"===ne:"http://www.w3.org/2000/svg"===te.namespaceURI?"math"===ne&&mg[Zf]:oj[ne]:"http://www.w3.org/1999/xhtml"===we.namespaceURI?"http://www.w3.org/2000/svg"===te.namespaceURI&&!mg[Zf]||"http://www.w3.org/1998/Math/MathML"===te.namespaceURI&&!Hd[Zf]?0:!oj[ne]&&(fg[ne]||!$e[ne]):"application/xhtml+xml"===qc&&ta[we.namespaceURI]))}if(te||("noscript"===Zc||"noembed"===Zc)&&Ta(/<\/no(script|embed)/i,we.innerHTML))return Od(we),!0;Hc&&3===we.nodeType&&(Zc=we.textContent,Zc=oa(Zc,Cc," "),Zc=oa(Zc,
Nb," "),Zc=oa(Zc,nc," "),we.textContent!==Zc&&(ha(Wb.removed,{element:we.cloneNode()}),we.textContent=Zc));$a("afterSanitizeElements",we,null);return!1}function $a(we,Zc,te){id[we]&&Y(id[we],function(ne){ne.call(Wb,Zc,te,je)})}function zc(we){return"object"===d(mb)?we instanceof mb:we&&"object"===d(we)&&"number"===typeof we.nodeType&&"string"===typeof we.nodeName}function rb(we){return ac.call(we.ownerDocument||we,we,Zb.SHOW_ELEMENT|Zb.SHOW_COMMENT|Zb.SHOW_TEXT,null,!1)}function ib(we){if(Id)we="<remove></remove>"+
we;else var Zc=(Zc=ia(we,/^[\r\n\t ]+/))&&Zc[0];"application/xhtml+xml"===qc&&"http://www.w3.org/1999/xhtml"===de&&(we='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+we+"</body></html>");var te=Pc?Pc.createHTML(we):we;if("http://www.w3.org/1999/xhtml"===de)try{var ne=(new bc).parseFromString(te,qc)}catch(Zf){}if(!ne||!ne.documentElement){ne=zb.createDocument(de,"template",null);try{ne.documentElement.innerHTML=wa?"":te}catch(Zf){}}te=ne.body||ne.documentElement;we&&Zc&&te.insertBefore(cb.createTextNode(Zc),
te.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===de?Yc.call(ne,jd?"html":"body")[0]:jd?ne.documentElement:te}function Vb(we,Zc){try{ha(Wb.removed,{attribute:Zc.getAttributeNode(we),from:Zc})}catch(te){ha(Wb.removed,{attribute:null,from:Zc})}Zc.removeAttribute(we);if("is"===we&&!Yf[we])if(ze||Ie)try{Od(Zc)}catch(te){}else try{Zc.setAttribute(we,"")}catch(te){}}function Od(we){ha(Wb.removed,{element:we});try{we.parentNode.removeChild(we)}catch(Zc){try{we.outerHTML=uc}catch(te){we.remove()}}}
function jb(we){return we instanceof RegExp||we instanceof Function}function Wb(we){return E(we)}var qb=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;Wb.version="2.4.1";Wb.removed=[];if(!qb||!qb.document||9!==qb.document.nodeType)return Wb.c9c=!1,Wb;var Ga=qb.document,cb=qb.document,Ob=qb.DocumentFragment,Db=qb.HTMLTemplateElement,mb=qb.Node,Vc=qb.Element,Zb=qb.NodeFilter,fc=qb.NamedNodeMap,ob=void 0===fc?qb.NamedNodeMap||qb.Drm:fc,ub=qb.HTMLFormElement,
bc=qb.DOMParser,ic=qb.trustedTypes;fc=Vc.prototype;var Rc=C(fc,"cloneNode"),Fb=C(fc,"nextSibling"),Qb=C(fc,"childNodes"),hc=C(fc,"parentNode");"function"===typeof Db&&(Db=cb.createElement("template"),Db.content&&Db.content.ownerDocument&&(cb=Db.content.ownerDocument));var Pc=V(ic,Ga),uc=Pc?Pc.createHTML(""):"";Db=cb;var zb=Db.implementation,ac=Db.createNodeIterator,Jb=Db.createDocumentFragment,Yc=Db.getElementsByTagName,dd=Ga.importNode;Db={};try{Db=m(cb).documentMode?cb.documentMode:{}}catch(we){}var id=
{};Wb.c9c="function"===typeof hc&&zb&&"undefined"!==typeof zb.createHTMLDocument&&9!==Db;var Cc=Ya,Nb=Ea,nc=La,Kc=xb,xd=dc,Xc=gc,Tb=Ac,he=gb,re=null,ee=y({},[].concat(r(Ha),r(da),r(Ba),r(Aa),r(la))),Yf=null,ke=y({},[].concat(r(va),r(Pa),r(Qa),r(Ua))),ef=Object.seal(Object.create(null,{t3:{writable:!0,configurable:!1,enumerable:!0,value:null},T9a:{writable:!0,configurable:!1,enumerable:!0,value:null},XOc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),yf=null,Rf=null,Za=!0,Kb=!0,Ic=!1,Hc=!1,
jd=!1,Id=!1,ze=!1,Ie=!1,Cd=!1,ue=!0,Ee=!1,Xe=!0,Sd=!1,ad={},af=null,pf=y({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),xf=null,gf=y({},"audio video img source image track".split(" ")),me=null,ag=y({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),de="http://www.w3.org/1999/xhtml",wa=!1,ta=null,Eb=y({},["http://www.w3.org/1998/Math/MathML",
"http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],ca),qc,Sc=["application/xhtml+xml","text/html"],td,je=null,Te=cb.createElement("form"),Hd=y({},["mi","mo","mn","ms","mtext"]),mg=y({},["foreignobject","desc","title","annotation-xml"]),fg=y({},["title","style","font","a","script"]),$e=y({},da);y($e,Ba);y($e,za);var oj=y({},Aa);y(oj,na);var Me=function te(Zc){var ne,Zf=rb(Zc);for($a("beforeSanitizeShadowDOM",Zc,null);ne=Zf.nextNode();)$a("uponSanitizeShadowNode",ne,null),pb(ne)||(ne.content instanceof
Ob&&te(ne.content),jc(ne));$a("afterSanitizeShadowDOM",Zc,null)};Wb.sanitize=function(Zc){var te=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(wa=!Zc)&&(Zc="\x3c!--\x3e");if("string"!==typeof Zc&&!zc(Zc)){if("function"!==typeof Zc.toString)throw R("toString is not a function");Zc=Zc.toString();if("string"!==typeof Zc)throw R("dirty is not a string, aborting");}if(!Wb.c9c){if("object"===d(qb.Nef)||"function"===typeof qb.Nef){if("string"===typeof Zc)return qb.Nef(Zc);if(zc(Zc))return qb.Nef(Zc.outerHTML)}return Zc}je&&
je===te||(te&&"object"===d(te)||(te={}),te=m(te),qc=-1===Sc.indexOf(te.G8h)?qc="text/html":qc=te.G8h,td="application/xhtml+xml"===qc?ca:ka,re="ALLOWED_TAGS"in te?y({},te.nqm,td):ee,Yf="ALLOWED_ATTR"in te?y({},te.lqm,td):ke,ta="ALLOWED_NAMESPACES"in te?y({},te.mqm,ca):Eb,me="ADD_URI_SAFE_ATTR"in te?y(m(ag),te.Ijf,td):ag,xf="ADD_DATA_URI_TAGS"in te?y(m(gf),te.kqm,td):gf,af="FORBID_CONTENTS"in te?y({},te.lkf,td):pf,yf="FORBID_TAGS"in te?y({},te.Pqm,td):{},Rf="FORBID_ATTR"in te?y({},te.Oqm,td):{},ad=
"USE_PROFILES"in te?te.Bsm:!1,Za=!1!==te.pqm,Kb=!1!==te.qqm,Ic=te.rqm||!1,Hc=te.Zrm||!1,jd=te.Gsm||!1,ze=te.Srm||!1,Ie=te.Trm||!1,Cd=te.Urm||!1,Id=te.Qqm||!1,ue=!1!==te.$rm,Ee=te.asm||!1,Xe=!1!==te.qrm,Sd=te.crm||!1,he=te.oqm||he,de=te.Frm||"http://www.w3.org/1999/xhtml",te.gPa&&jb(te.gPa.t3)&&(ef.t3=te.gPa.t3),te.gPa&&jb(te.gPa.T9a)&&(ef.T9a=te.gPa.T9a),te.gPa&&"boolean"===typeof te.gPa.XOc&&(ef.XOc=te.gPa.XOc),Hc&&(Kb=!1),Ie&&(ze=!0),ad&&(re=y({},r(la)),Yf=[],!0===ad.html&&(y(re,Ha),y(Yf,va)),!0===
ad.w7l&&(y(re,da),y(Yf,Pa),y(Yf,Ua)),!0===ad.iEm&&(y(re,Ba),y(Yf,Pa),y(Yf,Ua)),!0===ad.Xvm&&(y(re,Aa),y(Yf,Qa),y(Yf,Ua))),te.F6h&&(re===ee&&(re=m(re)),y(re,te.F6h,td)),te.E6h&&(Yf===ke&&(Yf=m(Yf)),y(Yf,te.E6h,td)),te.Ijf&&y(me,te.Ijf,td),te.lkf&&(af===pf&&(af=m(af)),y(af,te.lkf,td)),Xe&&(re["#text"]=!0),jd&&y(re,["html","head","body"]),re.table&&(y(re,["tbody"]),delete yf.nXh),W&&W(te),je=te);Wb.removed=[];"string"===typeof Zc&&(Sd=!1);if(Sd){if(Zc.nodeName&&(te=td(Zc.nodeName),!re[te]||yf[te]))throw R("root node is forbidden and cannot be sanitized in-place");
}else if(Zc instanceof mb){var ne=ib("\x3c!----\x3e");te=ne.ownerDocument.importNode(Zc,!0);1===te.nodeType&&"BODY"===te.nodeName?ne=te:"HTML"===te.nodeName?ne=te:ne.appendChild(te)}else{if(!ze&&!Hc&&!jd&&-1===Zc.indexOf("<"))return Pc&&Cd?Pc.createHTML(Zc):Zc;ne=ib(Zc);if(!ne)return ze?null:Cd?uc:""}ne&&Id&&Od(ne.firstChild);for(var Zf=rb(Sd?Zc:ne);te=Zf.nextNode();)if((3!==te.nodeType||te!==cd)&&!pb(te)){te.content instanceof Ob&&Me(te.content);jc(te);var cd=te}if(Sd)return Zc;if(ze){if(Ie)for(cd=
Jb.call(ne.ownerDocument);ne.firstChild;)cd.appendChild(ne.firstChild);else cd=ne;Yf.MDm&&(cd=dd.call(Ga,cd,!0));return cd}cd=jd?ne.outerHTML:ne.innerHTML;jd&&re["!doctype"]&&ne.ownerDocument&&ne.ownerDocument.doctype&&ne.ownerDocument.doctype.name&&Ta($b,ne.ownerDocument.doctype.name)&&(cd="<!DOCTYPE "+ne.ownerDocument.doctype.name+">\n"+cd);Hc&&(cd=oa(cd,Cc," "),cd=oa(cd,Nb," "),cd=oa(cd,nc," "));return Pc&&Cd?Pc.createHTML(cd):cd};return Wb}var F=Object.hasOwnProperty,B=Object.setPrototypeOf,H=
Object.isFrozen,K=Object.getPrototypeOf,A=Object.getOwnPropertyDescriptor,W=Object.freeze,N=Object.seal,P=Object.create,U="undefined"!==typeof Reflect&&Reflect,Q=U.apply,G=U.construct;Q||(Q=function(jc,pb,$a){return jc.apply(pb,$a)});W||(W=function(jc){return jc});N||(N=function(jc){return jc});G||(G=function(jc,pb){return n(jc,r(pb))});var Y=D(Array.prototype.forEach),ba=D(Array.prototype.pop),ha=D(Array.prototype.push),ka=D(String.prototype.toLowerCase),ca=D(String.prototype.toString),ia=D(String.prototype.match),
oa=D(String.prototype.replace),sa=D(String.prototype.indexOf),Ca=D(String.prototype.trim),Ta=D(RegExp.prototype.test),R=function(jc){return function(){for(var pb=arguments.length,$a=Array(pb),zc=0;zc<pb;zc++)$a[zc]=arguments[zc];return G(jc,$a)}}(TypeError),Ha=W("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
da=W("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),Ba=W("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
za=W("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Aa=W("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),na=W("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
la=W(["#text"]),va=W("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
Pa=W("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Qa=W("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Ua=W(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ya=N(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ea=N(/<%[\w\W]*|[\w\W]*%>/gm),La=N(/\${[\w\W]*}/gm),xb=N(/^data-[\-\w.\u00B7-\uFFFF]/),dc=N(/^aria-[\-\w]+$/),gb=N(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),gc=N(/^(?:\w+script|data):/i),Ac=N(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$b=N(/^html$/i);return E()})},984:function(L,V,d){d.d(V,"a",function(){return r});L=d(0);var k=
d(78),e=d(67),n=d(142);class r extends Sys.UI.Control{constructor(w,D,y,m){super(document.createElement("div"));this.A8=this.y8=this.iG=this.a6a=this.MT=this.BPa=this.rRa=null;this.fYb=this.qQa=!1;this.content=this.qD=null;this.Uca=0;this.MQf=null;this.B0=0;this.Zpd=null;this.xU=()=>{this.dismiss();return!0};this.OGf=w;this.utb=D;this.SQ=y;this.q5d=m;this.Mi=D.ownerDocument;this.Jcc=this.Is=this.KYb=!1}get ZK(){this.rRa||(this.rRa=this.Mi.createElement("div"),this.rRa.id=this.ki("WACCalloutOuter"),
this.rRa.className="WACCalloutOuter",this.rRa.setAttribute(n.a.Ff,n.a.f1d),this.rRa.style.width=this.Uca+"px");return this.rRa}get twb(){if(!this.BPa){this.BPa=this.Mi.createElement("div");this.BPa.id=this.ki("WACCalloutBeakContainer");this.BPa.className="WACCalloutBeakContainer";var w="CalloutBeakTopFilled_32x16x32";if(5===this.B0||6===this.B0||4===this.B0)w="CalloutBeakBottomFilled_32x16x32";w=k.createClusteredImage(32,16,w,"WACCalloutBeak",!0,"");this.BPa.appendChild(w)}return this.BPa}set twb(w){this.BPa=
w}get MM(){return this.KYb}get title(){return this.qD}set title(w){this.qD!==w&&(this.qD=w,this.y8&&(this.y8.innerText=this.qD))}get Is(){return this.qQa}set Is(w){this.qQa!==w&&(this.qQa=w,this.MT&&(this.MT.contains(this.iG)&&!this.qQa?this.MT.removeChild(this.iG):!this.MT.contains(this.iG)&&this.qQa&&this.DJf()))}get Jcc(){return this.fYb}set Jcc(w){this.fYb!==w&&(this.fYb=w,this.MT&&(this.MT.contains(this.y8)&&!this.fYb?this.MT.removeChild(this.y8):!this.MT.contains(this.y8)&&this.fYb&&this.ZKf()))}show(){this.KYb||
(this.X2i(),this.zGi(),this.utb.appendChild(this.ZK),this.ZK.style.display="Block",this.E8e(),this.KYb=!0,this.Zpd&&this.Zpd())}dismiss(){this.KYb&&(this.Paj(),this.utb.removeChild(this.ZK),this.KYb=!1,this.q5d&&this.q5d())}dispose(){this.dismiss();this.y8=this.iG=this.a6a=this.BPa=this.MT=this.rRa=null;Sys.Component.prototype.dispose.call(this)}ki(w){return this.get_element().id+w}X2i(){this.MT=this.Mi.createElement("div");this.MT.id=this.ki("WACCalloutHeader");this.MT.className="WACCalloutHeader";
this.Is&&this.DJf();this.Jcc&&this.ZKf();this.a6a=this.Mi.createElement("div");this.a6a.id=this.ki("WACCalloutContent");this.a6a.className="WACCalloutContent";this.a6a.style.width=190<this.Uca?this.Uca-26+"px":"164px";this.a6a.appendChild(this.content);this.ZK.appendChild(this.twb);this.ZK.appendChild(this.MT);this.ZK.appendChild(this.a6a)}DJf(){this.iG=this.Mi.createElement("a");this.iG.className="WACCalloutCloseAnchor";this.iG.id=this.ki("WACCalloutCloseAnchor");this.iG.href="#";this.MT.appendChild(this.iG);
const w=k.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.iG.appendChild(w)}ZKf(){this.y8=this.Mi.createElement("div");this.y8.className="WACCalloutTitle UIFontBold";this.y8.style.width=190<this.Uca?this.Uca-30+"px":"160px";this.y8.id=this.ki("WACCalloutTitle");this.y8.innerText=this.title;this.MT.contains(this.iG)?this.MT.insertBefore(this.y8,this.iG):this.MT.appendChild(this.y8)}E8e(){var w=this.OGf;let D;if(1===this.B0){var y=this.MQf.y+
16;D=-16}else 2===this.B0||3===this.B0||0===this.B0?(y=w.y+w.height+15,D=-15):(y=w.y-this.ZK.clientHeight-15-2,D=this.ZK.clientHeight-1);this.ZK.style.top=y+"px";this.twb.style.top=D+"px";1===this.B0?(w=this.MQf.x-16,this.ZK.style.left="50%",this.ZK.style.marginLeft=-this.Uca/2+"px",y=Sys.UI.DomElement.getBounds(this.ZK),this.twb.style.left=w-y.x+"px"):(y=w.x+this.OGf.width/2,2===this.B0||5===this.B0?(w=20,y-=36):0===this.B0||4===this.B0?(w=this.Uca/2-16,y-=this.Uca/2):(w=this.Uca-20-32,y=y-this.Uca+
36),this.ZK.style.left=y+"px",this.twb.style.left=w+"px")}zGi(){this.Is&&!this.A8&&(this.A8=this.xU,this.SQ.xb(e.a.click,this.iG,this.A8,null))}Paj(){this.Is&&this.A8&&(this.SQ.Hb(e.a.click,this.iG,this.A8),this.A8=null)}}Object(L.a)(r,"Callout",Sys.UI.Control,[592])},985:function(L,V,d){d.d(V,"a",function(){return K});var k=d(92);L=d(0);var e=d(33),n=d(37),r=d(32),w=d(91),D=d(184),y=d(50),m=d(38),C=d(731),E=d(1047),F=d(284),B=d(694),H=d(339);class K{constructor(A,W,N,P,U,Q,G,Y){this.rV=A;this.oa=
W;this.Pi=N;this.Nxa=P;this.Ga=U;this.IK=Q;this.BK=G;this.aKa=Y;this.select=ba=>{var {scope:ha,text:ka,index:ca}=ba;return Object(k.b)(this,void 0,void 0,function*(){var ia=[];let oa=[];var sa=null!==ha&&void 0!==ha?ha:"Selection";if("Selection"===sa){var Ca=this.oa.Oa.kb;Ca?(Ca=Ca.toArray().filter(Ta=>e.ParagraphReader.ke(Ta.node)),0<Ca.length?ia.push(...Ca):(Ca=this.oa.Hd(),0<Ca.length&&this.aKa.E6e(12,Ca,ia))):this.aKa.pQb(12,this.oa.Xe(),ia);0!==ia.length||ha||(sa="Presentation")}if(Array.isArray(sa)&&
0<sa.length&&sa[0]instanceof F.a)this.aKa.pQb(12,sa,ia);else if(Array.isArray(sa)&&0<sa.length&&sa[0]instanceof E.a)this.aKa.E6e(12,sa,ia);else if("Presentation"===sa&&this.Oc){sa=this.Oc.$O.presentation.slides;if(null===sa)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.aKa.pQb(12,sa,ia)}if(ka)for(const Ta of ia){ia=e.ParagraphReader.text(Ta.node);ia=this.matchAll(ia,ka);for(const R of ia)R[0]&&void 0!==R.index&&(ia=R.index,sa=R.index+R[0].length,Ca=y.a.rk(Ta.node,
ia),this.BK.ubf(Ca),Ca=y.a.rk(Ta.node,sa+1),this.BK.ubf(Ca),oa.push(y.a.createTextRange(Ta.node,ia,sa)))}else oa=ia;if("number"===typeof ca){0>ca&&(ca=oa.length+ca);if(0<=ca&&ca<oa.length)return[oa[ca]];throw Error.argumentOutOfRange("index");}return oa})};this.MOl=(ba,ha)=>{const ka=new r.GraphIterator;ka.set(ba);ka.uc(11);ka.Ug(11);ba=ba.eg.Aw(ka);const ca=ha?1:16;ha=ha?1:0;ba?ba.Rqa(ca,ha):(ha=D.a.JO(ca,ha),this.IK.ISa(ka,ha))};this.GQl=(ba,ha)=>{switch(ha){case "Left":ha=1;break;case "Center":ha=
2;break;case "Right":ha=3;break;case "Distributed":ha=7;break;case "Justify":ha=6;break;default:ha=1}this.Nxa.kL(ba,ha)};this.$Ul=(ba,ha)=>{if(ba=this.Ga.Gn(ba)){switch(ha){case "Top":ha=0;break;case "Middle":ha=1;break;case "Bottom":ha=2;break;default:ha=0}ba.setValue(m.a.AQ,ha)}};this.format=ba=>{var {textRanges:ha,color:ka,bold:ca,italic:ia,underline:oa,fontName:sa,size:Ca,bulleted:Ta,horizontalAlignment:R,verticalAlignment:Ha}=ba;return Object(k.b)(this,void 0,void 0,function*(){if(!ha)throw Error.argumentNull("textRanges");
const da=[];if(ha&&0<ha.length){for(const za of ha){var Ba=[];if(za.contextId===n.a.paragraph){const Aa=w.a.Qfg(za.node,!1);for(const na of Aa)Ba.push(na.formatting)}else Ba.push(w.a.yt(za));for(const Aa of Ba)Aa&&(ka&&(Ba=B.a.DTa(ka),ka=""===Ba?ka:Ba,this.Pi.Jr(Aa,ka,null)),void 0!==ca&&this.Pi.fJ(Aa,ca),void 0!==ia&&this.Pi.setItalic(Aa,ia),oa&&this.Pi.n_(Aa,"None"!==oa),sa&&this.Pi.rW(Aa,sa),void 0!==Ca&&this.Pi.$q(Aa,2*Ca),void 0!==Ta&&this.MOl(za.node,Ta),R&&this.GQl(za.node,R),Ha&&this.$Ul(za.node,
Ha));da.push(new Promise(Aa=>H.a.x$(Aa,za.node).bind(this)))}yield Promise.all(da)}})};this.$Dl=(ba,ha)=>Object(k.b)(this,void 0,void 0,function*(){const ka=(new DOMParser).parseFromString(ha,"text/html");if(0<ka.body.innerHTML.trim().length)return ba.CPb=ka.body.innerHTML.trim(),new Promise(ca=>H.a.x$(ca,ba).bind(this))});this.insert=ba=>{var {precededBy:ha,text:ka}=ba;return Object(k.b)(this,void 0,void 0,function*(){if(!ha)throw Error.argumentNull("precededBy");const ca=[];for(var ia of ha){var oa=
ia.node,sa=-1===ia.Pb?oa.characterData.length:ia.Pb+1;sa=ia.contextId===n.a.Xf?ia:y.a.rk(oa,sa);this.BK.replaceTextRange(sa,ka,!0);oa=y.a.createTextRange(oa,ia.Pb+1,ia.Pb+ka.length);ca.push(oa)}ia=[];for(const Ca of ca)ia.push(new Promise(Ta=>H.a.x$(Ta,Ca).bind(this)));return Promise.all(ia)})};this.delete=ba=>{var {textRanges:ha}=ba;return Object(k.b)(this,void 0,void 0,function*(){if(!ha)throw Error.argumentNull("textRanges");const ka=[],ca=[];for(let ia of ha){ia.node instanceof C.a&&ia.contextId!==
n.a.textRange&&(ia=y.a.createTextRange(ia.node,0,ia.node.characterData.length));this.BK.replaceTextRange(ia,"",!0);const oa=y.a.rk(ia.node,ia.Ra);ka.push(oa);ca.push(new Promise(sa=>H.a.x$(sa,ia.node).bind(this)))}yield Promise.all(ca);return 0===ka.length?[]:[ka[0]]})};if(!A)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!W)throw Error.argumentNull("m_selectionManager");if(!N)throw Error.argumentNull("m_formattingEditor");if(!P)throw Error.argumentNull("m_paragraphEditor");if(!U)throw Error.argumentNull("m_shapeReader");
if(!Q)throw Error.argumentNull("m_listEditor");if(!G)throw Error.argumentNull("m_characterPropertiesEditor");if(!Y)throw Error.argumentNull("m_odslGraphUtils");this.rV&&this.rV.execute(ba=>{this.Oc=ba})}matchAll(A,W){W=W instanceof RegExp?W:new RegExp(W,"g");const N=[];let P;for(;null!==(P=W.exec(A));)N.push(P);return N}}Object(L.a)(K,"ODSLText",null,[1273])},986:function(L,V,d){d.d(V,"a",function(){return U});var k=d(92);L=d(0);var e=d(593),n=d(1273),r=d(1298),w=d(54),D=d(1264),y=d(284),m=d(57),
C=d(58),E=d(400),F=d(695),B=d(41),H=d(106),K=d(1066),A=d(696),W=d(233),N=d(694),P=d(339);class U{constructor(Q,G,Y,ba,ha,ka,ca,ia,oa,sa,Ca){this.rV=Q;this.oa=G;this.Lj=Y;this.b0a=ba;this.TZa=ha;this.Ga=ka;this.Vk=ca;this.Ji=ia;this.yb=oa;this.ms=sa;this.Dr=Ca;this.PIb=this.UJa=0;this.M6e=(Ta,R)=>{for(const Ha of Ta)R.push(...Ha.yj())};this.select=Ta=>{var {scope:R,name:Ha,index:da=-1}=Ta;return Object(k.b)(this,void 0,void 0,function*(){const Ba=[],za=[];var Aa=null!==R&&void 0!==R?R:"Selection";
if("Selection"===Aa){const na=this.oa.Hd();0<na.length?Ba.push(...na):this.M6e(this.oa.Xe(),Ba);0!==Ba.length||R||(Aa="Presentation")}if("Presentation"===Aa&&this.Oc){Aa=this.Oc.$O.presentation.slides;if(null===Aa)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.M6e(Aa,Ba)}else Array.isArray(Aa)&&0<Aa.length&&Aa[0]instanceof y.a&&this.M6e(Aa,Ba);if(Ha)for(const na of Ba)na.shapeName===Ha&&za.push(na);else za.push(...Ba);if("number"===typeof da){0>da&&(da=za.length+
da);if(0<=da&&da<za.length)return[za[da]];throw Error.argumentOutOfRange("index");}return za})};this.format=Ta=>{var {shapes:R,left:Ha,top:da,height:Ba,width:za,lineColor:Aa,lineDashStyle:na,lineWeight:la,lineTransparency:va,fillColor:Pa,fillTransparency:Qa}=Ta;return Object(k.b)(this,void 0,void 0,function*(){if(!R)throw Error.argumentNull("shapes");if(R&&0<R.length){const Ya=[];for(const Ea of R){void 0!==Ha&&(Ea.zz=Ha);void 0!==da&&(Ea.Az=da);void 0!==Ba&&(Ea.XD=Ba);void 0!==za&&(Ea.zy=za);if(Aa){var Ua=
N.a.DTa(Aa);Aa=""===Ua?Aa:Ua;Ua=W.a.parse(Aa);Ea.$qa=JSON.stringify(Ua)}if(na)switch(na){case "Dash":Ea.JN=0;break;case "DashDot":Ea.JN=1;break;case "DashDotDot":Ea.JN=2;break;case "LongDash":Ea.JN=3;break;case "LongDashDot":Ea.JN=4;break;case "RoundDot":Ea.JN=5;break;case "Solid":Ea.JN=6;break;case "SquareDot":Ea.JN=7;break;case "LongDashDotDot":Ea.JN=8;break;case "SystemDash":Ea.JN=9;break;case "SystemDot":Ea.JN=10;break;case "SystemDashDot":Ea.JN=11;break;default:Ea.JN=6}void 0!==la&&(Ea.outlineWidth=
la);void 0!==va&&(Ua=W.a.parse(Ea.$qa),Ua.Alpha=100*va,Ea.$qa=JSON.stringify(Ua));Pa&&(Pa=""===N.a.DTa(Pa)?Pa:N.a.DTa(Pa),Ua=W.a.parse(Pa),Ea.xia=JSON.stringify(Ua));void 0!==Qa&&(Ua=W.a.parse(Ea.xia),Ua.Alpha=100*Qa,Ea.xia=JSON.stringify(Ua));Ya.push(new Promise(La=>P.a.x$(La,Ea).bind(this)))}yield Promise.all(Ya)}})};this.insert=Ta=>{var {slides:R,shapeType:Ha}=Ta;if(!R)throw Error.argumentNull("slides");if(!this.Oc)throw Error("Cannot insert shapes without appForOfficeManager instance.");Ta=[];
for(var da of R){const Pa=da;if(!Pa)throw Error("Cannot find selected slide to insert shape.");const Qa=Pa.Fb;if(m.a.Cx(Qa))throw Error("Cannot insert on fake slide node.");const Ua=this.Xbb(Ha);if(!Ua)throw Error("Could not load props for shapeType.");if(!this.Lj.UD(Pa,1))throw this.Lj.yE(Pa),Error("Too many shapes on the slide.");const Ya=this.b0a.qI;var Ba=Pa.Ld.HasDefaultShape,za=Pa.Ld.HasDefaultLine,Aa=95===Ua.Hia||97===Ua.Hia||Array.contains(F.a.Oze,Ua.Hia);za=za&&Aa;Ba=Ba&&!Aa;this.Yia(0);
var na=void 0;let Ea,La;var la=this.Oc.$O.presentation.slideWidth,va=this.Oc.$O.presentation.slideHeight;na=new C.a((la-Ua.width*e.a.kE)/2,(va-Ua.height*e.a.kE)/2);Aa=na.x+n.a.Cf(this.yP*E.a.tU,r.a.horizontal);La=na.y+n.a.Cf(this.yP*E.a.tU,r.a.vertical);Ya?(na=Ua.width*e.a.kE,Ea=Ua.height*e.a.kE):(na=n.a.Cf(U.G4b,r.a.horizontal),Ea=n.a.Cf(U.F4b,r.a.vertical),Aa=la/2-n.a.Cf(U.G4b/2-this.yP*E.a.tU,r.a.horizontal),La=va/2-n.a.Cf(U.F4b/2-this.yP*E.a.tU,r.a.vertical));this.yP++;this.yP>this.UJa&&(this.yP=
this.PIb);la=Pa.wt();va=Object(D.a)(227,this.Oc.$O.Aa.vg(this.yb.Na));B.a.Kb&&(za||Ba)&&B.a.Kb.Wa(H.a.Yce,za?"HasDefaultLine":"HasDefaultShape");let xb=null;xb=!Ya||"TextBox"===Ha||Ba||za?this.Vk.cFa(!1,Qa.cid,Qa.sid,0,Ua.shapeType,Aa,La,na,Ea,la+1):F.a.bUc(Qa,Ua,va.cV,null,new K.a,Aa,La,na,Ea,la,this.Ga,this.Vk,this.yb,this.Oc.$O,this.Ji);this.ms.NU([xb],Pa,null);this.Dr.YA=xb;this.kBc();Ta.push(xb)}da=[];for(const Pa of Ta)da.push(new Promise(Qa=>P.a.x$(Qa,Pa).bind(this)));return Promise.all(da)};
this.delete=Ta=>{var {shapes:R}=Ta;return Object(k.b)(this,void 0,void 0,function*(){if(!R)throw Error.argumentNull("shapes");for(const Ha of R)this.Vk.zVc(Ha);return new Promise(Ha=>P.a.x$(Ha,this.Oc.$O.Aa).bind(this))})};if(!Q)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!G)throw Error.argumentNull("m_selectionManager");if(!Y)throw Error.argumentNull("m_shapeCountValidator");if(!ba)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.rV&&this.rV.execute(Ta=>{this.Oc=Ta});this.yP=
0}Yia(Q){this.TZa.Vef(Q)}kBc(){const Q=w.a.instance.Ha("Common.ISystemInitiatedFeedback");Q&&Q.execute(G=>{G.logActivity("InsertShapeActivity",null)})}Xbb(Q){switch(Q){case "Textbox":return new A.a(34,16,.5,3);case "Ellipse":return new A.a(34,9,1,1);case "Triangle":return new A.a(2,17,1,1.16);case "RightTriangle":return new A.a(3,55,1,1);case "Parallelogram":return new A.a(6,56,1,1.33);case "Trapezoid":return new A.a(7,57,1.33,1);case "Diamond":return new A.a(5,58,1,1);case "SPentagon":return new A.a(9,
59,1,1.05);case "Hexagon":return new A.a(10,60,1,1.16);case "Heptagon":return new A.a(11,61,1,1);case "Octagon":return new A.a(12,62,1,1);case "Decagon":return new A.a(13,63,1,1);case "Dodecagon":return new A.a(14,64,1,1);case "Pie":return new A.a(39,65,1,1);case "Chord":return new A.a(87,66,1,1);case "Teardrop":return new A.a(35,67,1,1);case "Frame":return new A.a(83,68,1,1);case "HalfFrame":return new A.a(84,69,1,1);case "LShape":return new A.a(85,70,1,1);case "DiagonalStripe":return new A.a(86,
71,1,1);case "Cross":return new A.a(130,72,1,1);case "Plaque":return new A.a(33,73,1,1);case "Can":return new A.a(73,7,1.33,1);case "Cube":return new A.a(72,8,1.33,1.33);case "Bevel":return new A.a(82,74,1.14,1.14);case "Donut":return new A.a(41,75,1,1);case "NoSymbol":return new A.a(42,76,1,1);case "BlockArc":return new A.a(40,77,1,1);case "FoldedCorner":return new A.a(81,78,1,1);case "SmileyFace":return new A.a(78,79,1,1);case "Heart":return new A.a(75,18,1,1);case "LightningBolt":return new A.a(74,
80,1,1);case "Sun":return new A.a(76,81,1,1);case "Moon":return new A.a(77,82,1,.5);case "Cloud":return new A.a(120,83,1,1);case "Arc":return new A.a(88,84,1,1);case "DoubleBracket":return new A.a(93,85,1,1);case "DoubleBrace":return new A.a(94,86,1,1.17);case "LeftBracket":return new A.a(89,87,1,.08);case "RightBracket":return new A.a(90,88,1,.08);case "LeftBrace":return new A.a(91,89,1,.17);case "RightBrace":return new A.a(92,90,1,.17);case "MathPlus":return new A.a(175,19,1,1);case "MathMinus":return new A.a(176,
20,1,1);case "MathMultiply":return new A.a(177,21,1,1);case "MathDivide":return new A.a(178,22,1,1);case "MathEqual":return new A.a(179,23,1,1);case "MathNotEqual":return new A.a(180,24,1,1);case "StraightConnector":return new A.a(95,12,1,1);case "StraightConnectorArrow":return new A.a(95,13,1,1);case "StraightConnectorTwoArrow":return new A.a(95,14,1,1);case "ElbowConnector":return new A.a(97,26,1,1);case "ElbowArrowConnector":return new A.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new A.a(97,
156,1,1);case "CurvedConnector":return new A.a(101,25,1,1);case "CurvedArrowConnector":return new A.a(101,153,1,1);case "CurvedDoubleArrowConnector":return new A.a(101,154,1,1);case "DownArrow":return new A.a(46,0,1.07,.53);case "LeftArrow":return new A.a(44,1,.53,1.07);case "LeftRightArrow":return new A.a(50,2,.53,1.33);case "RightArrow":return new A.a(43,3,.53,1.07);case "UpArrow":return new A.a(45,4,1.07,.53);case "UpDownArrow":return new A.a(51,5,1.33,.53);case "LeftRightUpArrow":return new A.a(53,
27,.93,1.33);case "BentArrow":return new A.a(62,28,.95,.89);case "UTurnArrow":return new A.a(63,29,.96,.97);case "LeftUpArrow":return new A.a(52,30,.93,.93);case "BentUpArrow":return new A.a(49,31,.8,.93);case "CurvedRightArrow":return new A.a(67,32,1.33,.8);case "CurvedLeftArrow":return new A.a(68,33,1.33,.8);case "CurvedUpArrow":return new A.a(69,34,.8,1.33);case "CurvedDownArrow":return new A.a(70,46,.8,1.33);case "StripedRightArrow":return new A.a(47,35,.53,1.07);case "NotchedRightArrow":return new A.a(48,
36,.53,1.07);case "Pentagon":return new A.a(36,37,.53,1.07);case "Chevron":return new A.a(37,38,.53,.53);case "RightArrowCallout":return new A.a(56,39,1,1);case "DownArrowCallout":return new A.a(58,40,1,1);case "LeftArrowCallout":return new A.a(55,41,1,1);case "UpArrowCallout":return new A.a(57,42,1,1);case "LeftRightArrowCallout":return new A.a(59,43,.63,1.33);case "QuadArrowCallout":return new A.a(61,44,1.33,1.33);case "CircularArrow":return new A.a(64,45,1.07,1.07);case "QuadArrow":return new A.a(54,
47,1.33,1.33);case "Rectangle":return new A.a(4,10,1,1);case "RoundedRectangle":return new A.a(25,11,1,1);case "RoundDiagonalCornerRectangle":return new A.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new A.a(27,49,1,1);case "RoundSingleCornerRectangle":return new A.a(26,50,1,1);case "SnipRoundSingleCornerRectangle":return new A.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new A.a(32,52,1,1);case "SnipSameSideCornerRectangle":return new A.a(31,53,1,1);case "SnipSingleCornerRectangle":return new A.a(30,
54,1,1);case "RectangularCallout":return new A.a(116,91,.67,1);case "RoundedRectangleCallout":return new A.a(117,6,.67,1);case "OvalCallout":return new A.a(118,92,.67,1);case "CloudCallout":return new A.a(119,93,.67,1);case "LineCallout1":return new A.a(104,94,.67,1);case "LineCallout2":return new A.a(105,95,.67,1);case "LineCallout3":return new A.a(106,96,.67,1);case "LineCallout1Accent":return new A.a(107,97,.67,1);case "LineCallout2Accent":return new A.a(108,98,.67,1);case "LineCallout3Accent":return new A.a(109,
99,.67,1);case "LineCallout1BorderAccent":return new A.a(110,100,.67,1);case "LineCallout2BorderAccent":return new A.a(111,101,.67,1);case "LineCallout3BorderAccent":return new A.a(112,102,.67,1);case "LineCallout1NoBorder":return new A.a(113,103,.67,1);case "LineCallout2NoBorder":return new A.a(114,104,.67,1);case "LineCallout3NoBorder":return new A.a(115,105,.67,1);case "Explosion1":return new A.a(79,106,1,1);case "Explosion2":return new A.a(80,107,1,1);case "Star4":return new A.a(15,108,1,1);case "Star5":return new A.a(16,
15,1,1);case "Star6":return new A.a(17,109,1,1);case "Star7":return new A.a(18,110,1,1);case "Star8":return new A.a(19,111,1,1);case "Star10":return new A.a(20,112,1,1);case "Star12":return new A.a(21,113,1,1);case "Star16":return new A.a(22,114,1,1);case "Star24":return new A.a(23,115,1,1);case "Star32":return new A.a(24,116,1,1);case "UpRibbon":return new A.a(122,117,.67,1.33);case "DownRibbon":return new A.a(121,118,.67,1.33);case "CurvedUpRibbon":return new A.a(124,119,.83,1.33);case "CurvedDownRibbon":return new A.a(123,
120,.83,1.33);case "VerticalScroll":return new A.a(126,121,1.25,1.13);case "HorizontalScroll":return new A.a(127,122,1.13,1.25);case "Wave":return new A.a(128,123,1,1);case "DoubleWave":return new A.a(129,124,1,1);case "Process":return new A.a(131,125,.67,1);case "AlternateProcess":return new A.a(158,126,.67,1);case "Decision":return new A.a(132,127,.67,1);case "Data":return new A.a(133,128,.67,1);case "PredefinedProcess":return new A.a(134,129,.67,1);case "InternalStorage":return new A.a(135,130,
.67,.67);case "Document":return new A.a(136,131,.67,1);case "Multidocument":return new A.a(137,132,.83,1.16);case "Terminator":return new A.a(138,133,.33,1);case "Preparation":return new A.a(139,134,.67,1.16);case "ManualInput":return new A.a(140,135,.5,1);case "ManualOperation":return new A.a(141,136,.67,1);case "Connector":return new A.a(142,137,.5,.5);case "OffpageConnector":return new A.a(159,138,.67,.67);case "Card":return new A.a(143,139,.88,1);case "PunchedTape":return new A.a(144,140,.88,
1);case "SummingJunction":return new A.a(145,141,.67,.67);case "Or":return new A.a(146,142,.67,.67);case "Collate":return new A.a(147,143,1,.5);case "Sort":return new A.a(148,144,1,.5);case "Extract":return new A.a(149,145,.75,.75);case "Merge":return new A.a(150,146,.75,.75);case "StoredData":return new A.a(152,147,.67,1);case "Delay":return new A.a(157,148,.67,.67);case "SequentialActionStorage":return new A.a(153,149,.67,.67);case "MagneticDisk":return new A.a(154,150,.67,1);case "DirectAccessStorage":return new A.a(155,
151,.75,1);case "Display":return new A.a(156,152,.67,1);default:return null}}}U.G4b=110;U.F4b=75;Object(L.a)(U,"ODSLShape",null,[1273])},987:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=
this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(L.a)(k,"CT_LineProperties",null,[])},988:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(L.a)(k,"CT_PresetLineDashProperties",null,[])},989:function(L,V,d){d.d(V,"a",function(){return D});var k=d(92);L=d(0);var e=d(1264),n=d(284),r=d(547),w=d(339);class D{constructor(y,m,C,E){this.rV=y;this.oa=m;this.uf=C;this.ks=E;
this.select=F=>{var {scope:B,index:H=-1}=F;return Object(k.b)(this,void 0,void 0,function*(){const K=[];var A=null!==B&&void 0!==B?B:"Selection";if("Selection"===A){const W=this.oa.Xe();0<W.length&&K.push(...W);0!==K.length||B||(A="Presentation")}if("Presentation"===A&&this.Oc){A=this.Oc.$O.presentation.slides;if(null===A)throw Error("Could not cast from ISlide to ISlide on presentation slides.");K.push(...A)}return-1!==H&&H<K.length?[K[H]]:K})};this.format=()=>Object(k.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");
});this.ahe=F=>F?F.Oj:this.Oc.$O.presentation.DZ[0].Id;this.xxj=F=>{const B=this.Oc.$O.presentation.DZ;for(let H=0;H<B.length;H++)if(F===B[H].Id)return B[H].ContentMasters[0].Id;return 0};this.yxj=(F,B)=>{const H=this.Oc.$O.presentation.DZ.find(K=>K.Id===B).ContentMasters.find(K=>K.Name===F);if(!H)throw Error("Could not find content master for layout "+F);return H.Id};this.insert=F=>{var {slides:B,layout:H}=F;return Object(k.b)(this,void 0,void 0,function*(){if(!B)throw Error("Could not insert slide due to invalid preceding slides");
if(!this.Oc)throw Error("Cannot insert slides without appForOfficeManager instance.");const K=[];for(var A of B){var W=this.ahe(A);const N=H?this.yxj(H,W):this.xxj(W);W=this.Oc.$O.presentation.O2b(A,null,W,N);K.push(Object(e.a)(n.a,W))}A=[];for(const N of K)A.push(new Promise(P=>w.a.x$(P,N).bind(this)));return Promise.all(A)})};this.delete=F=>{var {slides:B}=F;return Object(k.b)(this,void 0,void 0,function*(){if(!B)throw Error.argumentNull("slides");if(!this.Oc)throw Error("Cannot delete slides without appForOfficeManager instance.");
for(const H of B){const K=H;K&&!this.uf.Xc(K)&&K.isConnected&&(this.oa.Bh(),this.Oc.$O.presentation.QJ(K),this.ks.rud(new r.a([K])))}return new Promise(H=>w.a.x$(H,this.Oc.$O.presentation).bind(this))})};if(!y)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!m)throw Error.argumentNull("m_selectionManager");if(!C)throw Error.argumentNull("m_actionBlockingManager");if(!E)throw Error.argumentNull("m_graphOperationEventNotifier");this.rV&&this.rV.execute(F=>{this.Oc=F})}}Object(L.a)(D,"ODSLSlide",
null,[1273])},990:function(L,V,d){d.d(V,"a",function(){return n});var k=d(92);L=d(0);var e=d(339);class n{constructor(r,w){this.rV=r;this.oa=w;this.select=()=>Object(k.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.format=()=>Object(k.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.insert=D=>{var {slides:y,imageData:m}=D;return Object(k.b)(this,void 0,void 0,function*(){if(!y)throw Error.argumentNull("slides");if(!m)throw Error("Could not get imageData in Base64.");
if(!this.Oc)throw Error("Cannot insert images without appForOfficeManager instance.");this.ttk(m)&&(m=yield n.Tuj(m));const C=[];for(const E of y)this.oa.sQ.apply(this.oa,E),this.Oc.Lu.sNh(m,!0,null,null,null,null,0,""),C.push(new Promise(F=>e.a.x$(F,E).bind(this)));yield Promise.all(C)})};this.delete=()=>Object(k.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});if(!r)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!w)throw Error.argumentNull("m_selectionManager");
this.rV&&this.rV.execute(D=>{this.Oc=D})}static Tuj(r){return Object(k.b)(this,void 0,void 0,function*(){try{r.startsWith("//")&&(r="https:"+r);const w=yield fetch(r);if(w.ok){const D=yield w.arrayBuffer();return btoa((new Uint8Array(D)).reduce((y,m)=>y+String.fromCharCode(m),""))}}catch(w){}return""})}ttk(r){try{return new URL(r),!0}catch(w){return!1}}}Object(L.a)(n,"ODSLImage",null,[1273])},991:function(L,V,d){d.d(V,"a",function(){return m});var k=d(92);L=d(0);var e=d(1300),n=d(1301),r=d(37),w=
d(27),D=d(52),y=d(992);d.n(y);class m{constructor(C,E,F,B,H,K,A,W){this.oa=C;this.sa=E;this.Eb=F;this.Kxa=B;this.$hb=H;this.bhd=K;this.F0g=A;this.D0g=W;if(!this.oa)throw Error.argumentNull("m_selectionManager");if(!this.sa)throw Error.argumentNull("m_graphTopologyManager");if(!this.Eb)throw Error.argumentNull("m_transactionFactory");if(!this.Kxa)throw Error.argumentNull("m_odslText");if(!this.$hb)throw Error.argumentNull("m_odslShape");if(!this.bhd)throw Error.argumentNull("m_odslSlide");if(!this.F0g)throw Error.argumentNull("m_odslTable");
if(!this.D0g)throw Error.argumentNull("m_odslImage");}EJj(C){switch(C){case y.ActionRecommendationTrigger.TextSelection:case y.ActionRecommendationTrigger.TextBoxSelection:return this.CPj();default:throw Error.argumentOutOfRange("trigger");}}OEi(C){Object(k.b)(this,void 0,void 0,function*(){const E=JSON.parse(C),F=this.Eb.xe(15),B=E.scenario;try{if(!B)throw Error("No scenario provided in modelData");F.mc(this.sa.presentation);switch(B){case "textToTable":const H=Object.assign({},E);this.s0i(H);break;
case "summarizeText":const K=Object.assign({},E);if(!K.summarizeText)throw Error("No summarizeText provided in modelData");this.L0d(B,K.summarizeText);break;case "rewriteText":const A=Object.assign({},E);if(!A.rewriteText)throw Error("No rewriteText provided in modelData");this.L0d(B,A.rewriteText);break;case "continueText":const W=Object.assign({},E);if(!W.continueText)throw Error("No continueText provided in modelData");this.L0d(B,W.newWholeText);break;case "slideGeneration":const N=Object.assign({},
E);this.JEi(N);break;default:throw Error.argumentOutOfRange("scenario");}}catch(H){w.a.J(509085824,e.a.qZk,n.a.warning,`SmartRecommendation: Exception thrown while applying recommendation. ${H}`)}finally{F&&F.dispose()}})}CPj(){const C=this.oa.Hd().map(B=>B.aA().map(H=>H.characterData).join("\n")).join("\n");let E="";const F=this.oa.Oa.kb;F&&(E=F.toArray().filter(B=>B.contextId===r.a.textRange).map(B=>B.node.characterData.substring(B.lSa,B.gvb)).join("\n"));return JSON.stringify({shapeText:C,selectedText:E})}s0i(C){Object(k.b)(this,
void 0,void 0,function*(){if(!C)throw Error.argumentNull("modelData");if(!C.transformedData)throw Error("No transformedData provided in modelData");if(C.usedData){var E=C.usedData.split("\n");for(var F of E)E=yield this.Kxa.select({text:F}),yield this.Kxa.delete({textRanges:E})}else F=yield this.$hb.select({}),yield this.$hb.delete({shapes:F});F=yield this.bhd.select({});yield this.F0g.insert({slides:F,html:C.transformedData})})}L0d(C,E){Object(k.b)(this,void 0,void 0,function*(){if("summarizeText"===
C||"rewriteText"===C)var F=yield this.Kxa.select({});else"continueText"===C&&(F=yield this.$hb.select({}),F=yield this.Kxa.select({scope:F}));F=yield this.Kxa.delete({textRanges:F});F=yield this.Kxa.insert({precededBy:F,text:E});0<F.length&&(F=F[F.length-1],this.oa.setSelection(D.SelectionFactory.fh(F.node,F.Pb)))})}JEi(C){Object(k.b)(this,void 0,void 0,function*(){if(!C)throw Error.argumentNull("modelData");var E=yield this.bhd.select({});E=yield this.bhd.insert({slides:E,layout:"Two Content"});
var F=E[0];this.oa.qUa();this.sa.Aa=F;C.title&&(F=yield this.$hb.select({scope:E,index:0}),F=yield this.Kxa.select({scope:F}),yield this.Kxa.insert({precededBy:F,text:C.title}));if(C.text){F=yield this.$hb.select({scope:E,index:1});const B=`<ul>${C.text.map(H=>`<li>${H}</li>`).join("")}</ul>`;yield this.Kxa.$Dl(F[0],B)}C.image&&(F=(yield this.$hb.select({scope:E,index:2}))[0],this.oa.setSelection(D.SelectionFactory.Nl(F)),yield this.D0g.insert({slides:E,imageData:C.image}))})}}Object(L.a)(m,"SmartRecommendations",
null,[])},992:function(L,V,d){var k=this&&this.WGd||(Object.create?function(n,r,w,D){void 0===D&&(D=w);var y=Object.getOwnPropertyDescriptor(r,w);if(!y||("get"in y?!r.q8:y.writable||y.configurable))y={enumerable:!0,get:function(){return r[w]}};Object.defineProperty(n,D,y)}:function(n,r,w,D){void 0===D&&(D=w);n[D]=r[w]}),e=this&&this.__exportStar||function(n,r){for(var w in n)"default"===w||Object.prototype.hasOwnProperty.call(r,w)||k(r,n,w)};Object.defineProperty(V,"__esModule",{value:!0});e(d(1176),
V);e(d(1177),V);e(d(1178),V);e(d(1179),V)},993:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.YRk=e}get Byc(){return this.YRk}}Object(L.a)(k,"ShowHideNotesData",null,[])},994:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(918);class k extends d.a{constructor(e,n){super(n);this.l0g=e;this.Ghb=0}Sag(){const e=(new Date).getTime(),n=e-this.Ghb;if(0<this.Ghb&&0>=this.l0g-n)return this.Ghb=0,this.V3d(),!0;this.Ghb=e;this.V3d();this.setTimeout(this.l0g);return!1}}
Object(L.a)(k,"FunctionDelayer",d.a,[])},995:function(L,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return n});d.d(V,"c",function(){return r});var k=d(46);d(408);d(28);d(60);const e=(w,D)=>{const y=[];if(w.length!==D.length)return y;for(let m=0;m<w.length;m++){const C={};C.key=D[m];C.text=w[m];C.type="AppComboBoxItem";y[m]=C}return y},n=(w,D,y,m,C)=>({["unitType"]:w,["unitPlaceholder"]:k.a.TXe(D),["minValue"]:y,["maxValue"]:m,["step"]:C}),r=w=>"1.00"===w?1:"1.50"===w?1.5:"2.00"===w?
2:0},996:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{static add(e,n,r,w,D){k.BMg[k.xfg(e,n,r,w,D)]=!0}static contains(e,n,r,w,D){return k.xfg(e,n,r,w,D)in k.BMg}static xfg(e,n,r,w,D){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),n,r.toLowerCase(),w.toLowerCase(),D.toLowerCase())}}k.BMg={};Object(L.a)(k,"AppsInsertedStorage",null,[])},997:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.taskPaneWidth="TaskPaneWidth";k.sourceLocationOverrideResourceId=
"SourceLocationOverrideResourceId";k.BA="TaskPaneTitle";k.nonPersistedSettings="NonPersistedSettings";k.onTaskPaneClose="OnTaskPaneClose";k.onExtensionLaunchCallback="OnExtensionLaunchCallback";k.q7="OnRenderedCallback";k.lVc="DialogIsModal";k.pVc="DialogShowTitleBar";k.dialogWidth="DialogWidth";k.dialogHeight="DialogHeight";k.dialogLeft="DialogLeft";k.Q7b="DialogRight";k.dialogTop="DialogTop";k.N7b="DialogBottom";k.Qla="DialogTitle";k.O7b="DialogCloseCallback";k.t$d="DialogParentId";k.showLoadingSpinner=
"ShowLoadingSpinner";Object(L.a)(k,"PropertyNames",null,[])},998:function(L,V,d){d.d(V,"a",function(){return E});L=d(0);var k=d(104),e=d(1264),n=d(40),r=d(42),w=d(32),D=d(82),y=d(248),m=d(38),C=d(999);class E{static O1i(F,B,H){F=Object(e.a)(D.a,F.createInstance(1074135137));E.yKf(F,B,H);return F}static oSa(F,B,H){w.GraphIterator.ob(F).$l(B,H)}static yKf(F,B,H){F.setValue(r.a.iPc,0===B.targetType);F.setValue(r.a.Rvb,B.solutionId);F.setValue(r.a.nPc,B.version);F.setValue(r.a.v3b,B.storeType);F.setValue(r.a.mPc,
B.storeId);F.setValue(m.a.u3b,H.YSc(B.storeType));B.assetId&&F.setValue(m.a.s3b,B.assetId);F.setValue(m.a.cPc,B.assetStoreId);void 0===B.isAddinCommands?F.setValue(m.a.isAddinCommands,!1):F.setValue(m.a.isAddinCommands,B.isAddinCommands);B.sharedRuntimeId&&-1!==B.backgroundState&&(F.setValue(m.a.qwb,B.backgroundState),F.setValue(m.a.W9a,B.sharedRuntimeId));0===B.targetType&&(F.setValue(m.a.$r,!0),H=B.height?B.height:200,F.setValue(n.a.zy,B.width?B.width:200),F.setValue(n.a.XD,H))}static B1h(F,B,H){const K=
k.a.Zxc(H);C.b(B,W=>{W=W.$a(r.a.kPc);return!!W&&!(W in K)});C.a(B,(W,N)=>{const P=N.$a(r.a.kPc);P&&P in K&&(E.Agm(N,K[P],W),delete K[P])});const A=w.GraphIterator.ob(B);k.a.forEach(K,(W,N)=>{A.$l(E.P1i(F,W,N),21)},null)}static P1i(F,B,H){F=Object(e.a)(D.a,F.createInstance(1074135139));F.setValue(r.a.kPc,B);F.setValue(r.a.lPc,H);return F}static Agm(F,B,H){F.setValue(r.a.lPc,B);H.ra(r.a.iPc,!0)?y.d(H,F,E.ZIl):y.d(H,F,E.yJl)}}E.ZIl=[m.a.sid,m.a.cid,m.a.shapeId];E.yJl=[r.a.Rvb];Object(L.a)(E,"AppEditor",
null,[])},999:function(L,V,d){d.d(V,"a",function(){return n});d.d(V,"b",function(){return r});var k=d(32),e=d(1E3);const n=(w,D)=>{const y=new k.GraphIterator;y.set(w);let m=y.Gb(21);for(;m;)e.a(m)&&D(w,m),m=y.Qf(21)},r=(w,D)=>{const y=new k.GraphIterator;y.set(w);let m=y.Gb(21);for(;m&&m!==w;)m=e.a(m)&&D(m)?y.sUa(21):y.sk(21)}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.ext.js.map
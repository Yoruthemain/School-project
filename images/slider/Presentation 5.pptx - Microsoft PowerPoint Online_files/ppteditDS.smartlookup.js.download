'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1313:function(L,V,d){d.r(V);var k=d(0),e=d(1265),n=d(1327),r=d(25),w=d(277),D=d(96),y=d(68),m=d(18);class C{constructor(wa){wa.Ha("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(k.a)(C,"DocumentContentExtractionManager",null,[1278]);var E=d(395),F=d(7),B=d(1104);class H{}H.F3l="mso_smartLookup";H.channelId="SmartLookup";H.D3l="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
H.tTh="https://uci.edog.cdn.office.net/mirrored/smartlookup/";H.uTh="https://uci.cdn.office.net/mirrored/smartlookup/";H.C3l="https://hedwigtestserver.blob.core.windows.net/builds/";H.B3l="http://localhost:8080/";H.hzc="current";H.sTh="next";H.zcl=2;H.Mqd=CommonUIStrings.L_SmartLookupPaneTitle;H.x_="InsightsTaskPane";H.width=400;H.uXh="appCorrelationId";H.vXh="message";Object(k.a)(H,"InsightsConstants",null,[]);var K=d(962),A=d(165);class W{}Object(k.a)(W,"ActivityContractInfo",null,[]);class N{}
Object(k.a)(N,"BrowserPaneDataField",null,[]);class P{}Object(k.a)(P,"BrowserPaneTelemetryEvent",null,[]);var U=d(136),Q=d(54),G=d(182),Y=d(166);class ba{static xu(wa,ta){const Eb=new P;Eb.eventName="Diagnostics";Eb.isActivity=!1;Eb.activityContract=Object.assign(new W,{success:!0});const qc=[],Sc=new N;Sc.name="Message";Sc.dataType=0;Sc.value=wa;wa=new N;wa.name="Level";wa.dataType=0;wa.value=ba.lEj(ta);Array.add(qc,Sc);Array.add(qc,wa);Eb.dataFields=qc;ba.sendTelemetryEvent(Eb)}static Wxd(wa,ta){const Eb=
new P;Eb.eventName=wa;Eb.isActivity=!1;Eb.activityContract=Object.assign(new W,{success:!0});wa=[];const qc=new N;qc.name="AppCorrelationId";qc.dataType=0;qc.value=ta;Array.add(wa,qc);Eb.dataFields=wa;ba.sendTelemetryEvent(Eb)}static FMl(wa,ta,Eb,qc,Sc,td){const je=new P;je.eventName="LaunchPaneWithError";je.isActivity=!1;je.activityContract=Object.assign(new W,{success:!0});const Te=[],Hd=new N;Hd.name="IsNetworkConnected";Hd.dataType=0;Hd.value=wa?"true":"false";wa=new N;wa.name="IsHostruntimeAvailable";
wa.dataType=0;wa.value=ta?"true":"false";ta=new N;ta.name="EntryPoint";ta.dataType=0;ta.value=Eb;Eb=new N;Eb.name="RuntimeVersion";Eb.dataType=0;Eb.value=qc;qc=new N;qc.name="IsFirstRelease";qc.dataType=1;qc.value=Sc?"true":"false";Sc=new N;Sc.name="IsZeroTerm";Sc.dataType=1;Sc.value=td?"true":"false";td=new N;td.name="IsClientSideRendering";td.dataType=1;td.value="false";Array.add(Te,Hd);Array.add(Te,ta);Array.add(Te,wa);Array.add(Te,Eb);Array.add(Te,qc);Array.add(Te,Sc);Array.add(Te,td);je.dataFields=
Te;ba.sendTelemetryEvent(je)}static S6e(wa,ta,Eb){const qc=new P;qc.eventName="CDNDownloadLatency";qc.isActivity=!0;qc.activityContract=Object.assign(new W,{duration:Eb,success:!0});Eb=[];const Sc=new N;Sc.name="CDNHostname";Sc.dataType=0;Sc.value=wa;wa=new N;wa.name="Filename";wa.dataType=0;wa.value=ta;Array.add(Eb,Sc);Array.add(Eb,wa);qc.dataFields=Eb;ba.sendTelemetryEvent(qc,1)}static fxc(wa,ta,Eb,qc,Sc,td,je,Te){const Hd=new P;Hd.eventName="LaunchPane";Hd.isActivity=!0;Hd.activityContract=Object.assign(new W,
{duration:ta,success:!0});ta=[];const mg=new N;mg.name="AppCorrelationId";mg.dataType=0;mg.value=wa;wa=new N;wa.name="EntryPoint";wa.dataType=0;wa.value=Eb;Eb=new N;Eb.name="IsServerSideRendering";Eb.dataType=1;Eb.value="true";const fg=new N;fg.name="UxVersion";fg.dataType=0;fg.value=qc;qc=new N;qc.name="FeatureGates";qc.dataType=0;qc.value=Sc;Sc=new N;Sc.name="IsFirstRelease";Sc.dataType=1;Sc.value=td?"true":"false";td=new N;td.name="IsZeroTerm";td.dataType=1;td.value=je?"true":"false";je=new N;
je.name="IsClientSideRendering";je.dataType=1;je.value=Te?"true":"false";Array.add(ta,mg);Array.add(ta,wa);Array.add(ta,Eb);Array.add(ta,fg);Array.add(ta,qc);Array.add(ta,Sc);Array.add(ta,td);Array.add(ta,je);Hd.dataFields=ta;ba.sendTelemetryEvent(Hd)}static sendTelemetryEvent(wa,ta=2){if(wa.isFeedbackActivity)ba.kAk(wa.eventName);else{var Eb=-1<wa.eventName.indexOf(ba.tXh)?wa.eventName:ba.tXh+wa.eventName,qc=ba.Ryj(wa.dataFields);wa.isActivity?(wa=Object.assign(new G.a,{name:Eb,samplingPolicy:ta,
dataFields:qc,succeeded:wa.activityContract.success,durationMs:wa.activityContract.duration}),U.a.sendActivityEvent(wa)):(wa=Object.assign(new Y.a,{name:Eb,samplingPolicy:ta,dataFields:qc}),U.a.sendTelemetryEvent(wa))}}static lEj(wa){switch(wa){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static Ryj(wa){const ta=[];if(wa&&0<wa.length)for(const Eb of wa)(wa=A.a.W0(Eb.name,Eb.value,ba.H0i(Eb.dataType)))&&Array.add(ta,wa);return ta}static H0i(wa){switch(wa){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static kAk(wa){const ta=Q.a.instance.ub("Common.ISystemInitiatedFeedback");ta?ta.logActivity(wa,null):E.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}ba.tXh="Office.Insights.SmartLookup.";Object(k.a)(ba,"TelemetryUtils",null,[]);var ha=d(549),ka=d(341),ca=d(453),ia=d(204),oa=d(35),sa=d(103);class Ca{static MR(wa,ta,Eb,qc,Sc,td){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;if(Sc.value.GZl())return ba.xu("Skipping Serplet launch",
10),32;ta=td;if(!ta)return 8;wa=Ca.Vbb();if(Eb=ta.CommandValueId)try{ta=oa.a(Eb)}catch(je){return E.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",Eb),8}Eb=ta;ta.selection||(ta.neighborhood?Eb=Object.assign(new ka.a,{selection:ta}):(ta=Sc.value.scb(),Eb.selection=Object.assign(new ca.a,{neighborhood:ta.neighborhood,mentionStart:ta.mentionStart,mentionLength:ta.mentionLength})));Eb.selection.clientDetectedLanguage=null;return Ca.Kzb(td,null,Eb,
wa,0,Sc)}static Kzb(wa,ta,Eb,qc,Sc,td){const je={};je.controlId=wa?wa.SourceControlId:"shortcut";Eb&&(je.entryPoint=ha.a[Eb.entryPoint]);E.ULS.sendTraceTag(594044172,1303,50,Ca.lma("Show insights",qc,je));ta?td.value.K0l(ta,qc,Sc):Eb&&(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?td.value.i_l(Eb,qc):td.value.L0l(Eb,qc,Sc));return 32}static lma(wa,ta,Eb=null){wa={["appCorrelationId"]:ta,["message"]:wa};if(Eb)for(const qc in Eb)wa[qc]=Eb[qc];
return oa.c(wa)}static Vbb(){return sa.a.create().toString()}}Object(k.a)(Ca,"InvokingPaneUtils",null,[]);class Ta{}Object(k.a)(Ta,"LaunchDataInDoc",null,[]);class R{}Object(k.a)(R,"LaunchDataPasteAsSlide",null,[]);class Ha{}Object(k.a)(Ha,"LaunchDataSlidesCompression",null,[]);var da=d(401),Ba=d(122),za=d(65),Aa=d(302),na=d(80),la=d(64),va=d(72),Pa=d(543),Qa=d(36);class Ua{constructor(wa,ta,Eb,qc,Sc,td,je,Te,Hd){this.XWb=this.IGc=this.Go=null;this.yGa=mg=>{this.Go||3!==mg.state||(this.Go=mg,this.IGc=
this.Go.SS)};this.Sz=wa;this.Ca=ta||r.AFrameworkApplication.Pa;this.KL=Eb;this.Wd=qc;this.$wf=Te;this.mRa=Sc;this.La=td;this.je=je;this.m$j();this.Ija=new e.a(()=>new da.a(Hd.value,this.yGa))}qb(){this.Ca.xa(Qa.a.Wbk,va.a.frame,Object(F.a)(this,this.I0l,"showInsights"));this.Ca.xa(Qa.a.Xbk,va.a.frame,Object(F.a)(this,this.J0l,"showInsightsForTellMe"));this.Ca.xa(Qa.a.definitions,va.a.frame,Object(F.a)(this,this.N_l,"showDefinitions"));this.Ca.xa(Qa.a.v$i,va.a.frame,Object(F.a)(this,this.O_l,"showDefinitionsForTellMe"));
this.Ca.xa(Qa.a.Z$e,va.a.frame,Object(F.a)(this,this.Z$e,"showInsightsForSuggestion"));this.$wf&&(this.Ca.xa(Qa.a.W5c,va.a.frame,Object(F.a)(this,this.MR,"invokeSmartLookupPane")),this.Ca.xa(Qa.a.Ite,va.a.frame,Object(F.a)(this,this.Ite,"invokeInDocSerplet")),this.Ca.xa(Qa.a.Z5c,va.a.frame,Object(F.a)(this,this.Z5c,"invokeSerpletRibbon")),this.Ca.xa(Qa.a.Y5c,va.a.frame,Object(F.a)(this,this.Y5c,"invokeSerpletContextMenu")),this.Ca.xa(Qa.a.Ote,va.a.frame,Object(F.a)(this,this.Ote,"invokeSerpletTellMeZeroTerm")),
this.Ca.xa(Qa.a.Nte,va.a.frame,Object(F.a)(this,this.Nte,"invokeSerpletTellMeNotes")),this.Ca.xa(Qa.a.Hte,va.a.frame,Object(F.a)(this,this.Hte,"invokeImageSerpletContextMenu")),this.Ca.xa(Qa.a.a6c,va.a.frame,Object(F.a)(this,this.a6c,"invokeSynonymsSerpletContextMenu")),this.Ca.xa(Qa.a.Fte,va.a.frame,Object(F.a)(this,this.Fte,"invokeDictionarySerpletContextMenu")),this.Ca.xa(Qa.a.Pte,va.a.frame,Object(F.a)(this,this.Pte,"invokeZeroTermSerpletContextMenu")),this.Ca.xa(Qa.a.Ete,va.a.frame,Object(F.a)(this,
this.Ete,"invokeDefinitionSearchFromFloatie")),this.Ca.xa(Qa.a.X5c,va.a.frame,Object(F.a)(this,this.X5c,"invokeSerpletBrowseFiles")),this.Ca.xa(Qa.a.Jte,va.a.frame,Object(F.a)(this,this.Jte,"invokeInDocSerpletWithLaunchData")),this.Ca.xa(Qa.a.T0e,va.a.frame,Object(F.a)(this,this.T0e,"queryToggleSerplet")),this.Ca.xa(Qa.a.W7e,va.a.frame,Object(F.a)(this,this.W7e,"setInDocSearchParameter")),this.Ca.xa(Qa.a.$5c,va.a.frame,Object(F.a)(this,this.$5c,"invokeSerpletSlidesCompression")),this.Ca.xa(Qa.a.Mte,
va.a.frame,Object(F.a)(this,this.Mte,"invokeSerpletPasteAsNewSlide")),r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.Ca.xa(Qa.a.idk,va.a.frame,Object(F.a)(this,this.kdk,"invokeSmartLookupPaneConversations")),this.Ca.xa(Qa.a.Dte,va.a.frame,Object(F.a)(this,this.Dte,"invokeAutoLaunchSearchRequest"))),this.nwl().continueWith(()=>{r.AFrameworkApplication.za&&r.AFrameworkApplication.za.Gf(!0)}))}XJf(){this.Ca.pa(Qa.a.qDb,va.a.frame,Object(F.a)(this,
this.qDb,"invokeFilesSerplet"),4);this.Ca.pa(Qa.a.kzg,va.a.frame,Object(F.a)(this,this.qDb,"invokeFilesSerplet"),4);this.Ca.pa(Qa.a.mzg,va.a.frame,Object(F.a)(this,this.Yck,"invokeLinkFilesSerplet"),4);if(this.La.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled")&&this.La.getBooleanAppSetting("SmartLookupTokenPrefetchIsEnabled")){const wa=na.a.VTc(0,Object(F.a)(this,this.fwh,"prefetchToken"),0,177);this.je.Jb(wa)}}DZd(){za.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.Ca.xa(Qa.a.qDb,va.a.frame,Object(F.a)(this,this.Gte,"invokeFilesSerpletUnavailable")),this.Ca.xa(Qa.a.kzg,va.a.frame,Object(F.a)(this,this.Gte,"invokeFilesSerpletUnavailable")),this.Ca.xa(Qa.a.mzg,va.a.frame,Object(F.a)(this,this.Gte,"invokeFilesSerpletUnavailable")))}fwh(wa){E.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",wa.interval,!!wa.data);this.$Tb().then(ta=>{let Eb=1;if(ta)E.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.b7e("SmartLookupFiles: Token prefetch succeeded",!0),ta=6E4*this.La.tc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{E.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.b7e("SmartLookupFiles: Token prefetch failed",!1);Eb=parseInt(wa.data||"1");if(Eb>this.La.tc("SmartLookupTokenRenewalRetryThreshold",5)){E.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.b7e("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}ta=6E4*this.La.tc("SmartLookupTokenRetryWaitDurationInMinutes",10);Eb++}ta=new na.a(3,1,ta,Object(F.a)(this,this.fwh,"prefetchToken"),177);ta.data=Eb.toString();this.je.Jb(ta)})}b7e(wa="",ta=!1){this.mRa.execute(Eb=>{Eb&&Eb.EQb("PrefetchToken",ta,0,"SmartLookup",wa)})}$Tb(){return this.mRa?new Promise(wa=>{this.mRa.execute(ta=>{if(ta){var Eb=Date.now();ta.getToken("SmartLookup",this.La.Ea("SmartLookupShredderServiceEndpoint")).then(qc=>{wa(!!qc&&0<qc.length);ta.EQb("TryGetTokenInternal",
!!qc&&0<qc.length,Date.now()-Eb,"SmartLookup")})}else wa(!1)})}):Promise.resolve(!1)}nwl(){const wa=new B.a;if(this.La.getBooleanAppSetting("BrowserSupportsInsightsPaneSSO"))this.XJf(),wa.Jg(!0);else{if(!this.mRa)return E.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),wa.Jg(!1),this.DZd(),wa.task;this.mRa.execute(ta=>{ta?ta.getToken("SmartLookup",this.La.Ea("SmartLookupShredderServiceEndpoint")).then(Eb=>{E.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!Eb&&0<Eb.length);
Eb&&0<Eb.length?(this.XJf(),wa.Jg(!0)):this.DZd()}):(E.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),wa.Jg(!1),this.DZd())})}return wa.task}I0l(wa,ta,Eb,qc,Sc){if(1===Eb)return r.AFrameworkApplication.za&&r.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteDelayLoadContextActivationManager")&&!r.AFrameworkApplication.q6b?8:this.Sz.value.QCg()?32:8;wa=Ca.Vbb();ta=this.Sz.value.scb();return this.$wf?(ta=Object.assign(new ca.a,{neighborhood:ta.neighborhood,mentionStart:ta.mentionStart,
mentionLength:ta.mentionLength}),ta=Object.assign(new ka.a,{selection:ta,userIntent:null,entryPoint:0,launchData:Object.assign(new Aa.a,{landingTab:"All"})}),Ca.Kzb(Sc,null,ta,wa,0,this.Sz)):Ca.Kzb(Sc,ta,null,wa,0,this.Sz)}N_l(wa,ta,Eb,qc,Sc){if(1===Eb)return this.Sz.value.QCg()?32:8;wa=Ca.Vbb();ta=this.Sz.value.scb();return Ca.Kzb(Sc,ta,null,wa,1,this.Sz)}J0l(wa,ta,Eb,qc,Sc){return 1===Eb?32:this.P$f(Sc,0)}O_l(wa,ta,Eb,qc,Sc){return 1===Eb?32:this.P$f(Sc,1)}P$f(wa,ta){const Eb=Ca.Vbb(),qc=wa.CommandValueId;
let Sc;try{Sc=oa.a(qc)}catch(td){return E.ULS.sendTraceTag(6295941,1303,15,Ca.lma(String.format("Insights parameters [{0}] is not in proper format.",qc),Eb)),8}return Ca.Kzb(wa,Sc,null,Eb,ta,this.Sz)}Z$e(wa,ta,Eb,qc,Sc){if(1===Eb)return 32;if(!Sc)return 8;wa=Sc.query?Sc.query:"";ta=Ca.Vbb();Eb=new K.a;Eb.neighborhood=wa;Eb.mentionStart=0;Eb.mentionLength=wa.length;return Ca.Kzb(Sc,Eb,null,ta,0,this.Sz)}Yck(wa,ta,Eb,qc){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;const Sc=r.AFrameworkApplication.fa.getBooleanAppSetting("InsertFileLinkSerpletIsEnabled"),
td=this.Sz.value.TVa();return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:td.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Aa.a,{landingTab:"File"}),entryPoint:Sc?32:10}))}qDb(wa,ta,Eb,qc){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;const Sc=r.AFrameworkApplication.fa.getBooleanAppSetting("InvokeReuseSlidesSerpletIsEnabled"),td=this.Sz.value.TVa();return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,
{neighborhood:td.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Aa.a,{landingTab:Sc?"Slide":"File"}),entryPoint:Sc?20:10}))}Gte(){return 2}Ite(wa,ta,Eb,qc,Sc){if(1===Eb)return ia.SessionStatusManager.instance.Oma?8:32;const td=this.Sz.value.TVa();Sc=void 0===Sc||null===Sc?18:19;return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:td.neighborhood,mentionStart:td.mentionStart,mentionLength:td.mentionLength}),launchData:Object.assign(new Aa.a,
{landingTab:"Indoc"}),entryPoint:Sc}))}Jte(wa,ta,Eb,qc,Sc){Sc=Sc.CommandValueId;if(!Sc||Sc&&this.XWb&&Sc.query===this.XWb.query&&Sc.matchCase===this.XWb.matchCase&&Sc.matchWholeWordOnly===this.XWb.matchWholeWordOnly)return 32;const td=this.Sz.value.TVa();return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:td.neighborhood,mentionStart:td.mentionStart,mentionLength:td.mentionLength}),launchData:Object.assign(new Aa.a,{landingTab:"Indoc",data:Object.assign(new Ta,
{type:4,query:Sc.query,matchCase:Sc.matchCase,matchWholeWord:Sc.matchWholeWordOnly})}),entryPoint:18}))}T0e(wa,ta,Eb,qc,Sc){Sc&&(Sc[Pa.a.On]=this.Sz.value.vfc);return 32}W7e(wa,ta,Eb,qc,Sc){if(wa=Sc.CommandValueId)this.XWb=wa;return 32}kdk(wa,ta,Eb){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;wa=this.Sz.value.TVa();wa=Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:wa.neighborhood,mentionStart:wa.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Aa.a,
{landingTab:"All"})});this.Sz.value.Dze(wa);return 32}Dte(wa,ta,Eb){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;wa=this.Sz.value.TVa();wa=Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:wa.neighborhood,mentionStart:wa.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Aa.a,{landingTab:"All",data:r.AFrameworkApplication.xUa})});ta=Ca.Vbb();this.Sz.value.Zxd(wa,ta);return 32}Z5c(wa,ta,Eb,qc){if(1===Eb)return ia.SessionStatusManager.instance.p1?
32:8;const Sc=this.Sz.value.sDj();return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:Sc.neighborhood,mentionStart:Sc.mentionStart,mentionLength:Sc.mentionLength}),entryPoint:4,launchData:Object.assign(new Aa.a,{landingTab:"All"})}))}Y5c(wa,ta,Eb,qc){return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{entryPoint:5,launchData:Object.assign(new Aa.a,{landingTab:"All"})}))}Ote(wa,ta,Eb,qc){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;const Sc=
this.Sz.value.TVa();return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:Sc.neighborhood,mentionStart:Sc.mentionStart,mentionLength:0}),launchData:Object.assign(new Aa.a,{landingTab:"All"}),entryPoint:26}))}Fte(wa,ta,Eb,qc){return 1===Eb?(wa=this.Sz.value.scb())&&0<wa.mentionLength?32:8:this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{entryPoint:22,launchData:Object.assign(new Aa.a,{landingTab:"All"})}))}Ete(wa,ta,Eb,qc){return 1===Eb?(wa=this.Sz.value.scb())&&
0<wa.mentionLength?32:8:this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{entryPoint:7,launchData:Object.assign(new Aa.a,{landingTab:"All"})}))}Hte(wa,ta,Eb,qc){return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{launchData:Object.assign(new Aa.a,{landingTab:"Image"}),entryPoint:9}))}a6c(wa,ta,Eb,qc){return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{launchData:Object.assign(new Aa.a,{landingTab:"All"}),entryPoint:24}))}Nte(wa,ta,Eb,qc){return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{launchData:Object.assign(new Aa.a,
{landingTab:"Notes"}),entryPoint:33}))}Pte(wa,ta,Eb,qc){if(1===Eb)return ia.SessionStatusManager.instance.p1?32:8;const Sc=this.Sz.value.TVa();return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:Sc.neighborhood,mentionStart:Sc.mentionStart,mentionLength:0}),launchData:Object.assign(new Aa.a,{landingTab:"All"}),entryPoint:27}))}$5c(wa,ta,Eb,qc,Sc){if(!Sc)return 8;const td=Sc.url;Sc=Sc.selectedSlideIDs;return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{launchData:Object.assign(new Aa.a,
{landingTab:"All",data:Object.assign(new Ha,{type:6,url:td,selectedSlideIDs:Sc})}),entryPoint:37}))}Mte(wa,ta,Eb,qc,Sc){if(!Sc)return 8;const td=Sc.Selection;Sc=Sc.CurrentDocTitle;return this.MR(wa,ta,Eb,qc,Object.assign(new ka.a,{launchData:Object.assign(new Aa.a,{landingTab:"All",data:Object.assign(new R,{type:5,selection:td,currentDocTitle:Sc})}),entryPoint:36}))}MR(wa,ta,Eb,qc,Sc){return Ca.MR(wa,ta,Eb,qc,this.Sz,Sc)}X5c(wa,ta,Eb){if(1===Eb)return 32;this.Go||this.Ija.value.Gi("Browse File from Search pane",
!0);if(!this.IGc||""===this.IGc)return E.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;la.a.qo(this.IGc,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}m$j(){const wa=this.Wd.Kc(H.x_);wa.parent=Ba.AFrame.Nj;wa.cea(Object(F.a)(this,this.X6e,"sendIFrameTakeFocusMessage"));this.KL.Hka(H.x_)}X6e(){document.activeElement.blur();r.AFrameworkApplication.za&&r.AFrameworkApplication.za.mb.REg||(this.Sz.value.N7e(),this.Sz.value.CMl())}dispose(){this.Sz.value&&
this.Sz.value.dispose()}}Object(k.a)(Ua,"InsightsActor",null,[106]);var Ya=d(1264),Ea=d(707),La=d(55),xb=d(276),dc=d(46);const gb=wa=>{wa=wa.split("-");return wa[wa.length-1]},gc=wa=>18===wa||19===wa||15===wa,Ac=()=>{var wa=$a();if(wa)return Promise.resolve(wa);wa=ib().replace("SearchWeb","searchweb");wa=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?wa+H.sTh+"/":wa+H.hzc+"/";wa+="version.json";if(La.a.vy)return $b(wa);try{const ta=
new Sys.Net.WebRequest;ta.set_httpVerb("GET");ta.set_url(wa);wa={};wa.method=ta.get_httpVerb();return"function"!==typeof window.fetch?(ba.xu("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(ta.getResolvedUrl(),wa).then(Eb=>Eb.json()).catch(()=>{ba.xu("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(Eb=>{Eb=oa.b(JSON.stringify(Eb));return Eb.version?Eb.version:""},Eb=>{ba.xu("InsightsUtils - Failed to deserialize version: "+
Eb.toString(),10);E.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+Eb.toString());return""}).then(Eb=>Eb)}catch(ta){return ba.xu("InsightsUtils - Failed to download version.json: "+ta.toString(),10),E.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+ta.toString()),Promise.resolve("")}},$b=wa=>{const ta=r.AFrameworkApplication.Me;return new Promise(Eb=>{const qc=new Ea.a(wa,1,null,null,!0,2,null);ta.send(qc).qmb(Sc=>{Sc&&Sc.data?Sc.data.Ud||
(ba.xu("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+Sc.data.Ke,10),Eb("")):(ba.xu("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),Eb(""));try{const td=oa.b(Sc.data.Ud);td.version&&Eb(td.version)}catch(td){ba.xu("InsightsUtils - Failed to deserialize version: "+td.toString(),10),Eb("")}},Sc=>{Sc&&Sc.data?ba.xu("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
Sc.data.Ke,10):ba.xu("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);Eb("")})})},jc=()=>r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableLocalOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),pb=()=>{const wa=ib();return jc()||r.AFrameworkApplication.fa.Ea("SmartLookupPRClientVersion")?wa+$a()+"/":r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?wa+H.sTh:wa+H.hzc},$a=()=>jc()?"dev":r.AFrameworkApplication.fa.Ea("SmartLookupPRClientVersion")?r.AFrameworkApplication.fa.Ea("SmartLookupPRClientVersion").split("/")[1]:r.AFrameworkApplication.fa.Ea("SmartLookupClientVersion"),zc=wa=>{var ta=3===r.AFrameworkApplication.za.mb.Ej?"wordwac":2===r.AFrameworkApplication.za.mb.Ej?"pptwac":"excelwac";var Eb=xb.a.Oe(r.AFrameworkApplication.lcid);const qc=Eb?Eb.name:"en-us";Eb=ib();const Sc=Od();ta="main_ssr_wac.html?appName="+ta+"&culture="+qc;return"LOCAL"===
Sc?Eb+ta:Eb+((""!==wa?wa:H.hzc)+"/")+ta},rb=wa=>ib()+(""!==wa?wa:H.hzc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",ib=()=>{switch(Od()){case "LOCAL":return H.B3l;case "PR":const wa=r.AFrameworkApplication.fa.Ea("SmartLookupPRClientVersion").split("/");return H.C3l+wa[0]+"/";case "INT":return H.D3l;case "EDOG":return H.tTh;default:return H.uTh}},Vb=()=>{if(!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(Od()){case "EDOG":return H.tTh;
case "PROD":return H.uTh;default:return""}},Od=()=>{if(r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",
!1))return"PROD";if(r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(r.AFrameworkApplication.fa.Ea("SmartLookupPRClientVersion")&&r.AFrameworkApplication.fa.Ea("SmartLookupPRIntentSvc"))return"PR";if(jc())return"LOCAL";switch(Object(Ya.a)(String,r.AFrameworkApplication.ld.AudienceGroup)||""){case "Dogfood":if(r.AFrameworkApplication.fa&&
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let wa=r.AFrameworkApplication.fa.Ea("UserPrincipalName");wa=dc.a.Dg(wa);const ta=r.AFrameworkApplication.fa.du("SmartLookupINTEnabledForSKITeam")?r.AFrameworkApplication.fa.hz("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(ta,wa))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},jb=()=>{let wa;wa=r.AFrameworkApplication.fa.getBooleanAppSetting("IntentSvcEnableEdogSourceLocationOverride")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":r.AFrameworkApplication.fa.getBooleanAppSetting("IntentSvcEnableProdSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":r.AFrameworkApplication.fa.getBooleanAppSetting("IntentSvcEnableIntSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",
!1)?"INT":Od();const ta=r.AFrameworkApplication.fa.Ea("IntentServiceEndpoint"),Eb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===wa&&""!==ta)return ta+"searchendpointv2/";switch(wa){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return r.AFrameworkApplication.fa.Ea("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(Eb?"wss://entity.osi.office-int.net/officeaugmentation/":
"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(Eb?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},Wb=()=>{const wa=Od(),ta=r.AFrameworkApplication.fa.Ea("IntentServiceEndpoint");switch(wa){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";
default:return"PROD"===wa&&""!==ta?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class qb{sendTelemetryEvent(wa){ba.sendTelemetryEvent(wa)}}Object(k.a)(qb,"OtelTelemetrySink",null,[1506]);class Ga{}Object(k.a)(Ga,"ApplicationProperties",null,[]);class cb{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(k.a)(cb,"CurrentDocumentProperties",null,[]);class Ob{}Object(k.a)(Ob,
"EnterpriseUserInfo",null,[]);class Db{}Object(k.a)(Db,"FeatureGates",null,[]);var mb=d(74);class Vc{constructor(wa,ta){this.zr=this.Fh=null;this.t8="Search";this.cWg=!0;this.l9a=ta;this.AH=wa;this.AH.execute(Eb=>{Eb.isFeatureEnabled("mso_sendASmile",!0).then(qc=>{this.cWg=qc}).catch(qc=>{ba.xu("SearchHelper - Failed to check if Feedback feature is enabled: "+qc.toString(),15)})});wa=jb();ta=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentSearch")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1);if(r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupFeatureGateV2")){this.zr={};const Eb=this.KLj();if(Eb&&0<Eb.length)for(let qc=0;qc<Eb.length;qc++){const Sc=Eb[qc],td=this.CMj(Sc);switch(td.toLowerCase()){case "true":this.zr[Sc]=!0;break;case "false":this.zr[Sc]=!1;break;default:this.zr[Sc]=td}}this.zr.EnableInDocumentSearch=ta;this.zr.EnableInDocumentSearchReplace=!0;this.zr.EnableInDocumentParamLocalSearch=!0;this.zr.EnableInDocumentQuerySuggest=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentQuerySuggest")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.zr.EnableInDocumentQuestionGeneration=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentQuestionGeneration")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.zr.EnableInDocumentExperiment1=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment1")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.zr.EnableInDocumentExperiment2=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment2")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.zr.EnableInDocumentExperiment3=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment3")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.zr.EnableZeroTermAutoRefresh=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.zr.EnableTap3SZeroTerm=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableTap3SZeroTerm")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.zr.EnableLocalSearch=
!0;this.zr.EnableInDocumentStickyFilters=!0;this.zr.IntentServiceEndpoint=wa;this.zr.EnablePDFShredding=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableSharepointPDFIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.zr.FilterNonPPTFilesForReuseSlides=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupFilterNonPPTFilesForReuseSlides");this.zr.UXBundleVersion=$a();this.zr.SmartLookupServicePath=
pb();this.zr.EnableAcronymSearch=!0;this.zr.UseAltAnswerEndpoint1=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.zr.UseAltAnswerEndpoint2=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint2")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);
this.zr.UseAltAnswerEndpoint3=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.zr.UseNextUXVersion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.zr.IgnoreNeighborhoodContext=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupIgnoreNeighborhoodContextIsEnabled");
this.zr.ShowDebugInfo="INT"===Od();this.zr.DebugCommands=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.zr.ChangeGates=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.zr.QnaInMixSection=!0;this.zr.EnableNoteSearch=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1);this.zr.EnableWikiL2=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.zr.EnableFilteringOutRedundantKPE=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.zr.EnableZeroTermEntitySuggestion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.zr.RankingModels=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",
"");this.zr.EnableClientSideRendering=!0}else this.Fh=new Db,this.Fh.EnableInDocumentSearch=ta,this.Fh.EnableInDocumentSearchReplace=!0,this.Fh.EnableInDocumentParamLocalSearch=!0,this.Fh.EnableInDocumentQuerySuggest=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentQuerySuggest")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Fh.EnableInDocumentQuestionGeneration=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentQuestionGeneration")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Fh.EnableInDocumentExperiment1=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Fh.EnableInDocumentExperiment2=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment2")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Fh.EnableInDocumentExperiment3=ta&&r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Fh.EnableZeroTermAutoRefresh=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",
!1),this.Fh.EnableTap3SZeroTerm=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableTap3SZeroTerm")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1),this.Fh.EnableLocalSearch=!0,this.Fh.EnableInDocumentStickyFilters=!0,this.Fh.IntentServiceEndpoint=wa,this.Fh.EnablePDFShredding=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableSharepointPDFIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",
!1),this.Fh.FilterNonPPTFilesForReuseSlides=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Fh.UXBundleVersion=$a(),this.Fh.SmartLookupServicePath=pb(),this.Fh.EnableAcronymSearch=!0,this.Fh.UseAltAnswerEndpoint1=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Fh.UseAltAnswerEndpoint2=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint2")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Fh.UseAltAnswerEndpoint3=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Fh.UseNextUXVersion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Fh.IgnoreNeighborhoodContext=
r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Fh.ShowDebugInfo="INT"===Od(),this.Fh.DebugCommands=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",""),this.Fh.ChangeGates=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Fh.QnaInMixSection=!0,this.Fh.EnableNoteSearch=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Fh.EnableWikiL2=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Fh.EnableFilteringOutRedundantKPE=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Fh.EnableZeroTermEntitySuggestion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",
!1),this.Fh.RankingModels=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Fh.EnableClientSideRendering=!0,this.Fh.SharedSerpletFeatureGate1=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.Fh.SharedSerpletFeatureGate2=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Fh.SharedSerpletFeatureGate3=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",
!1),this.Fh.SharedSerpletFeatureGate4=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Fh.SharedSerpletFeatureGate5=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.Fh.SharedSerpletFeatureGate6=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Fh.SharedSerpletFeatureGate7=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",
!1),this.Fh.SharedSerpletFeatureGate8=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Fh.SharedSerpletFeatureGate9=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.Fh.SharedSerpletFeatureGate10=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Fh.SharedSerpletFeatureGate11=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",
!1),this.Fh.SharedSerpletFeatureGate12=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Fh.SharedSerpletFeatureGate13=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.Fh.SharedSerpletFeatureGate14=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Fh.SharedSerpletFeatureGate15=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",
!1),this.Fh.SharedSerpletFeatureGate16=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Fh.SharedSerpletFeatureGate17=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.Fh.SharedSerpletFeatureGate18=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Fh.SharedSerpletFeatureGate19=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",
!1),this.Fh.SharedSerpletFeatureGate20=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Fh.SharedSerpletFeatureGate21=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.Fh.SharedSerpletFeatureGate22=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Fh.SharedSerpletFeatureGate23=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",
!1),this.Fh.SharedSerpletFeatureGate24=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Fh.SharedSerpletFeatureGate25=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.Fh.SharedSerpletFeatureGate26=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Fh.SharedSerpletFeatureGate27=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",
!1),this.Fh.SharedSerpletFeatureGate28=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Fh.SharedSerpletFeatureGate29=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.Fh.SharedSerpletFeatureGate30=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Fh.SharedSerpletFeatureGate31=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",
!1),this.Fh.SharedSerpletFeatureGate32=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Fh.SharedSerpletFeatureGate33=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.Fh.SharedSerpletFeatureGate34=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Fh.SharedSerpletFeatureGate35=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",
!1),this.Fh.SharedSerpletFeatureGate36=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Fh.SharedSerpletFeatureGate37=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.Fh.SharedSerpletFeatureGate38=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Fh.SharedSerpletFeatureGate39=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",
!1),this.Fh.SharedSerpletFeatureGate40=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.UZb=Q.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.Ukc=Vc.isEnterpriseUser();this.ioc=r.AFrameworkApplication.fa.Ea("SmartLookupShredderServiceEndpoint");this.rTk=mb.a.GD(r.AFrameworkApplication.fa.Ea("AppCatalogUrl")||"");this.mUk=r.AFrameworkApplication.fa.Ea("UserPrincipalName");this.Ukc&&this.yog()}CMj(wa){return r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline."+
wa,"")}KLj(){const wa=r.AFrameworkApplication.fa.b$b,ta=r.AFrameworkApplication.fa.hz("SmartLookupFlightKeywordList"),Eb=[];if(wa&&ta&&0<ta.length)for(const Sc in wa){var qc={key:Sc,value:wa[Sc]};qc=qc&&qc.key?qc.key:"";for(let td=0;td<ta.length;td++)if(-1<qc.toLowerCase().indexOf(ta[td].toLowerCase())){const je=qc.split(".");je&&4===je.length&&Array.add(Eb,je[je.length-1])}}return Eb}obc(wa,ta,Eb,qc){return new Promise(Sc=>{this.Vqk().then(td=>{const je=new Ga;je.anid="";je.applicationName=3===r.AFrameworkApplication.za.mb.Ej?
"WORD":"POWERPNT";je.applicationVersion=r.AFrameworkApplication.buildVersion;je.appCorrelationId=wa?wa:Ca.Vbb();je.themePlatform="web";je.lcid=r.AFrameworkApplication.lcid;je.launchUtcTime=(new Date).toUTCString();r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupFeatureGateV2")?je.featureGates=oa.c(this.zr):je.featureGates=oa.c(this.Fh);var Te=xb.a.Oe(r.AFrameworkApplication.lcid);Te=Te?Te.name:null;je.market=gb(Te);je.uiLanguage=Te;je.sessionId=r.AFrameworkApplication.userSessionId;je.themeId=
Eb;je.parentalControl="yes";je.processorOnlyMode=td;je.isEditingAllowed=ta.isEditingAllowed();je.isFeedbackEnabled=this.cWg;je.isClientSideRendering=gc(qc);je.disableClipboard=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&r.AFrameworkApplication.Tw&&!r.AFrameworkApplication.MUa;je.accessToken=this.Ukc?this.yog():"";td=new Ob;td.CountryCode=gb(Te);td.ServiceEndpoint=this.ioc;td.IsGoLocal=r.AFrameworkApplication.fa.getBooleanAppSetting("IsGoLocalEnvironment");
td.IsEnabled=this.Ukc;td.IsEnterpriseEnabled=this.Ukc;td.TenantRoot=this.rTk;td.Upn=this.mUk;Te=Od();td.IsEUDB="PROD"===Te&&""!==r.AFrameworkApplication.fa.Ea("IntentServiceEndpoint");je.enterpriseUserInfo=td;td=new cb;td.filePath=r.AFrameworkApplication.fa.Ea("EditDocInClientUrl");td.docName=r.AFrameworkApplication.fa.Ea("FileName");td.author=99!==qc?ta.author():null;td.createdDate=99!==qc?ta.createdDate():null;je.currentDocument=td;Sc(je)})})}Vqk(){return new Promise(wa=>{this.AH?this.AH.execute(ta=>
{ta.isFeatureEnabled(H.F3l,!0).then(Eb=>{wa(!Eb)}).catch(Eb=>{ba.xu("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+Eb.toString(),10);wa(!0)})}):wa(!0)})}euh(wa){this.UZb&&this.Ukc&&this.y2c(this.ioc).then(ta=>{wa(ta)})}yog(){return"Dev Box"===r.AFrameworkApplication.fa.Ea("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.UZb?this.UZb.cQj(this.t8,
this.ioc):""}y2c(wa){return"Dev Box"===r.AFrameworkApplication.fa.Ea("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(ta=>{ta(window.SearchPaneShredderTokenOverride)}):this.UZb?this.UZb.getToken(this.t8,wa):Promise.resolve("")}Qcb(){return this.l9a?this.l9a.getVersion():""}ajg(){return r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupFeatureGateV2")?oa.c(this.zr):oa.c(this.Fh)}static isEnterpriseUser(){const wa=
r.AFrameworkApplication.fa.Ea("SovereignEnvironmentName"),ta=r.AFrameworkApplication.fa.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled");return(!wa||!wa.length)&&ta}}Object(k.a)(Vc,"SearchHelper",null,[1279]);class Zb{constructor(){Zb.Ja=""}getVersion(){return Zb.Ja}YUl(wa){Zb.Ja=wa}}Zb.Ja=null;Object(k.a)(Zb,"SmartLookupVersion",null,[]);class fc{}Object(k.a)(fc,"ConfigurationProvider",null,[]);class ob{constructor(wa){ob.Ja=wa}bie(){return ob.Ja}}ob.Ja=null;Object(k.a)(ob,"SearchHostRuntime",
null,[]);var ub=d(141),bc=d(251),ic=d(312),Rc=d(255);class Fb{constructor(){this.PL=this.Mqb=this.Da=null}get name(){return"Common.App.Insights"}fc(wa){this.Da=wa;const ta=Rc.a.Au(Q.a.instance.Ha("Common.IEventEmitter<Common.IGetMoreInfoResult>")),Eb=r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableNativePane")||r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupIsEnabled");wa.register(Ua,"Common.App.Insights.InsightsActor").ma().na(()=>new Ua(wa.ze("Common.App.Insights.IInsightsManager"),
r.AFrameworkApplication.Pa,w.a.instance,D.FocusManager.instance(),wa.Ha("Common.App.SearchCommon.ISearchOAuthManager"),r.AFrameworkApplication.fa,ub.a.instance,Eb,new e.a(()=>ta.result)));wa.register(1278,"Common.App.Insights.IDocumentContentExtractionManager").ma().na(()=>new C(wa));Eb&&(wa.register(Zb,"Common.App.Insights.SmartLookupVersion").ma().na(()=>new Zb),wa.register(1279,"Common.App.SearchCommon.ISearchHelper").ma().na(()=>new Vc(Q.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
wa.ub("Common.App.Insights.SmartLookupVersion"))))}init(){r.AFrameworkApplication.oHa&&(this.Mqb=this.Da.ub("Common.App.Insights.InsightsActor"),this.Mqb.qb())}fvl(){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var wa=r.AFrameworkApplication.fa.Ea("SmartLookupShredderServiceEndpoint");this.Da.resolve("Common.App.SearchCommon.ISearchHelper").y2c(wa).then(ta=>{var Eb={};Eb.Authorization="Bearer "+ta;ta=Wb();const qc=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",
!0);Eb=new Ea.a(ta+("?isTelemetryOnly="+qc),1,null,Eb,!0,2,null);r.AFrameworkApplication.Me.send(Eb).qmb(()=>{ba.xu("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+qc,50)},Sc=>{ba.xu("InsightsPackage - Failed to send refreshmemory API request. Error: "+Sc.toString(),10)})})}}lej(){this.kck();this.fvl()}kck(){Ac().then(wa=>{if(""!==wa){const ta=this.Da.ub("Common.App.Insights.SmartLookupVersion");ta&&ta.YUl(wa)}this.aWc();this.Mqb=this.Da.resolve("Common.App.Insights.InsightsActor");
wa=rb(wa);wa=ic.a.create(wa);wa.u9((ta,Eb)=>{Eb.succeeded?this.LVl()&&this.prefetchZeroTerm():ba.xu("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+Eb.uv,10);this.Mqb.qb()});bc.a.bF(wa)})}LVl(){const wa=Object.assign(new fc,{channelId:H.channelId,approvedOriginPattern:jc()?"^(http)?://(localhost:8080)$":r.AFrameworkApplication.fa.Ea("SmartLookupApprovedOriginPattern")});var ta=this.Da.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const Eb=this.Da.resolve("Common.App.SearchCommon.ISerpletExecutor"),
qc=this.Da.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Sc=new m.a;ta&&Sc.add(ta);Eb&&Sc.add(Eb);qc&&Sc.add(qc);ta=jb();try{const td=new qb,je=SmartLookupHostRuntime.setup(wa,Sc.toArray(),!0,ta,td);this.Da.register(ob,"Common.App.SearchCommon.SearchHostRuntime").ma().na(()=>new ob(je));return!0}catch(td){return ba.xu("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+td,10),!1}}prefetchZeroTerm(){if(r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableInDocumentSearch")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var wa=Q.a.instance.ub("Common.App.SearchCommon.SearchHostRuntime");if(wa){const ta=this.Da.resolve("Common.App.SearchCommon.ISearchHelper"),Eb=this.Da.resolve("Common.App.SearchCommon.IDocumentHelper");ta.obc(null,Eb,0,99).then(qc=>{wa.bie().prefetchZeroTerm(qc,r.AFrameworkApplication.userSessionId,pb(),!0,"Indoc",null)})}else ba.xu("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",
15)}}aWc(){var wa=this.Da.resolve("Common.App.SearchCommon.ISearchHelper");const ta=zc(wa.Qcb());wa=wa.Qcb();wa=ib()+(""!==wa?wa:H.hzc)+"/scripts/microsoft.office.smartlookup.ssr.js";const Eb=Vb();La.a.vy?this.kej(ta,wa):(this.iej(ta,Eb),this.jej(wa,Eb))}iej(wa,ta){const Eb=new Sys.Net.WebRequest;Eb.set_httpVerb("GET");const qc={};qc.method=Eb.get_httpVerb();Eb.set_url(wa);const Sc=(new Date).getTime();try{window.fetch(Eb.getResolvedUrl(),qc).then(()=>{""!==ta&&ba.S6e(ta,wa,(new Date).getTime()-Sc);
this.Da.ub("Common.App.Insights.SmartLookupVersion")})}catch(td){ba.xu("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+td.toString(),10)}}jej(wa,ta){var Eb=new Sys.Net.WebRequest;Eb.set_httpVerb("GET");const qc={};qc.method=Eb.get_httpVerb();Eb.set_url(wa);let Sc=-1;if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))Eb=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",
3E5),ub.a.instance.Jb(new na.a(5,1,Eb,()=>{const td=ic.a.create(wa);td.xLf(()=>{Sc=Date.now()});td.u9((je,Te)=>{Te.succeeded?""!==ta&&ba.S6e(ta,wa,Date.now()-Sc):ba.xu("InsightsPackage - Failed to prefetch JS file.",10)});bc.a.bF(td)}));else{Sc=Date.now();try{window.fetch(Eb.getResolvedUrl(),qc).then(()=>{""!==ta&&ba.S6e(ta,wa,Date.now()-Sc)})}catch(td){ba.xu("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+td.toString(),10)}}}kej(wa,ta){if(La.a.vy){var Eb=r.AFrameworkApplication.Me;
wa=new Ea.a(wa,1,null,null,!0,2,null);Eb.send(wa).qmb(qc=>{qc&&qc.data?qc.data.Ud?this.Da.ub("Common.App.Insights.SmartLookupVersion"):ba.xu("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+qc.data.Ke,10):ba.xu("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},qc=>{qc&&qc.data?ba.xu("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+qc.data.Ke,10):ba.xu("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",
10)});r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupPrefetchJSIsEnabled")&&(ta=new Ea.a(ta,1,null,null,!0,2,null),Eb.send(ta).qmb(qc=>{qc&&qc.data?qc.data.Ud||ba.xu("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+qc.data.Ke,10):ba.xu("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},qc=>{qc&&qc.data?ba.xu("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+
qc.data.Ke,10):ba.xu("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.Mqb&&this.Mqb.dispose()}}Object(k.a)(Fb,"InsightsPackage",null,[2,3]);var Qb=d(28),hc=d(100),Pc=d(686),uc=d(1135),zb=d(551),ac=d(60),Jb=d(34);class Yc{constructor(wa,ta,Eb,qc=!0){this.streamUrl=wa;this.objectType=ta;this.formatType=Eb;this.renderAfterInsert=qc}}Object(k.a)(Yc,"InsertContentFromStreamData",null,[]);var dd=d(389),id=d(29);class Cc{constructor(wa,
ta,Eb){this.ia=wa;this.oa=ta;this.sa=Eb}insertOnlinePicture(wa){const ta=Object(Ya.a)(267,this.sa.Aa);wa&&ta&&(wa=Object.assign(new zb.a,{Action:"Insert",Caption:wa.caption,OriginalUrl:wa.sourceUrl,Height:wa.height,Width:wa.width,LicenseDisplayName:wa.licenseDisplayName,LicenseUrl:wa.licenseUrl,ThumbnailUrl:wa.thumbnailUrl,PageUrl:wa.pageUrl}),this.ia.Ia(id.a.deb,2,wa))}insertHtmlText(wa){if(wa)if(1===this.oa.Hd().length){const ta=new uc.DictionaryPropertySet;ta.setValue(ac.a.bW,wa.htmlText);ta.setValue(ac.a.urd,
!1);8===this.ia.Ia(Jb.a.hrd,2,ta)&&this.kyg(wa)}else this.kyg(wa)}kyg(wa){wa=Object.assign(new dd.a,{qob:!1,AW:wa.htmlText});this.ia.Ia(id.a.bqa,2,wa)}insertContentFromStreamUrl(wa){wa&&(wa=new Yc(wa.streamUrl,wa.objectType,wa.formatType,wa.renderAfterInsert),this.ia.Ia(id.a.a5c,2,wa))}getId(){return"InsertContentExecutor"}}Object(k.a)(Cc,"InsertContentExecutor",null,[1217,946]);var Nb=d(1059),nc=d(192);class Kc{}Object(k.a)(Kc,"CommandMetadataResponse",null,[]);class xd{constructor(){this.Koe=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){nc.PrivacyDialogManager.wAd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(wa){const ta=
new Kc;wa.iconNames&&(ta.svgData=this.getCommandIconSvg(wa.iconNames));if(!wa.commandId||""===wa.commandId)return ta.isVisible=!1,ta;try{ta.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),wa.commandId);ta.isDisabled=appChrome.selectors.isControlDisabled(wa.commandId);ta.label=appChrome.selectors.getControlLabel(wa.commandId);if(ta.svgData&&""!==ta.svgData)return ta;const Eb=appChrome.selectors.getControlIconSet(wa.commandId),qc=Array(2);qc[0]=Eb["default"];qc[1]=Eb.icon32;ta.svgData=
this.getCommandIconSvg(qc)}catch(Eb){return null}return ta}getCommandIconSvg(wa){if(!this.Koe)return"";for(let ta=0;ta<wa.length;ta++){const Eb=wa[ta];if(Eb in this.Koe)return this.Koe[Eb]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(wa){const ta={SourceControlId:"GiveFeedback"};ta.feedbackType="true"===wa.IsPosFeedback?0:1;const Eb={};Eb.featureArea=xd.Xlj;ta.telemetryGroup=Eb;ta.appData=wa;return ta}}
xd.r2j="FA000000012";xd.queryPrefix="AssetID=";xd.Xlj="SearchPane";Object(k.a)(xd,"BaseSerpletExecutor",null,[1216,946]);var Xc=d(27);class Tb extends xd{constructor(wa,ta,Eb){super();this.ia=wa;this.E0g=ta;this.SLe=Eb;if(!wa)throw Error.argumentNull("m_actionManager");}openFeedbackPane(wa){this.ia.Ia(Qa.a.mQb,2,this.createFeedbackPropertiesFromData(wa))}openHelpTaskPane(wa){const ta={};ta.query=xd.queryPrefix+wa;wa={};wa.assetId=xd.r2j;wa.nonPersistedSettings=ta;this.ia.Ia(id.a.Aia,2,wa)}browseFiles(){this.ia.Ia(Qa.a.X5c,
2,null)}executeCommand(wa){if(wa)switch(wa.CommandId){case 3:appChrome.api.executeCommand(wa.Data.CommandId,wa.Data.Payload);break;case 4:if(this.E0g&&this.SLe)try{this.E0g.mck(wa.Data.AST)}catch(ta){Xc.a.J(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${ta}`)}}}}Object(k.a)(Tb,"PPTSerpletExecutor",xd,[]);class he{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(k.a)(he,"BaseDocumentHelper",null,[944]);
class re extends he{constructor(){super()}isEditingAllowed(){return Qb.App.Ob.ie.isEditingAllowed}}Object(k.a)(re,"PptDocumentHelper",he,[]);class ee{constructor(){this.HEc=this.wJ=null}p7d(){return null}TVa(){return this.scb()}sDj(){return this.scb()}K0l(wa,ta,Eb){this.wJ||(this.wJ=this.NTc());this.wJ.Jl(wa,ta,Eb)}L0l(wa,ta,Eb){this.wJ||(this.wJ=this.NTc());this.wJ.haf(wa,ta,Eb)}i_l(wa,ta){this.HEc||(this.HEc=this.p7d());this.HEc&&this.HEc.haf(wa,ta)}Zxd(wa,ta){this.wJ||(this.wJ=this.NTc());this.wJ.Zxd(wa,
ta)}Dze(wa){this.wJ||(this.wJ=this.NTc());this.wJ.Dze(wa)}CMl(){this.wJ&&this.wJ.X6e()}N7e(){this.wJ&&this.wJ.mQl()}GZl(){var wa=r.AFrameworkApplication.fa.tc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);wa=window.performance.now()-ee.eIg<=wa;wa||(ee.eIg=window.performance.now());return wa}dispose(){this.wJ&&(this.wJ.dispose(),this.wJ=null)}get vfc(){return this.wJ?this.wJ.isVisible:!1}}ee.eIg=0;Object(k.a)(ee,"InsightsManager",null,[242,106]);class Yf{constructor(wa,ta,Eb,qc,Sc,td=!0,
je=null,Te=null){this.AL=this.kq=this.Pja=null;this.LQa=!1;this.PL=null;this.Wd=ta;this.$Od=td;this.YWb=Te?Te:new he;this.AH=je;this.KL=wa;this.$Od&&(Q.a.instance.ub("Common.App.SearchCommon.SearchHostRuntime")&&(this.PL=Q.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").bie()),this.lX=Q.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.l9a=this.lX.Qcb())}Gkb(wa){if(this.$Od){wa=wa.rawEvent;try{var ta=oa.a(wa.data)}catch(Eb){E.ULS.sendTraceTag(595161728,1303,15,this.lma("Message data from Serplet [{0}] failed to deserialize.",
wa.data));return}switch(ta.actionType){case 101:wa=0;this.kq&&(wa=this.kq.entryPoint);this.lX.obc(this.AL,this.YWb,this.nWa(),wa).then(Eb=>{ta.data=Eb;this.nNb(ta)});break;case 118:ta.data=this.kq?this.kq:Object.assign(new ka.a,{selection:Object.assign(new ca.a,{neighborhood:this.Pja.neighborhood,mentionStart:this.Pja.mentionStart,mentionLength:this.Pja.mentionLength})});this.nNb(ta);break;case 103:wa=oa.a(Object(Ya.a)(String,ta.data));ba.sendTelemetryEvent(wa);break;case 206:this.lX.y2c(ta.data).then(Eb=>
{ta.data=Eb;this.nNb(ta)});break;case 112:ta.data.shiftPressed?(La.a.jg&&document.activeElement.blur(),this.KL.f3c(0,null,2,null,null),E.ULS.sendTraceTag(592545156,1303,50,this.lma("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.KL.yWa(0,null,2,null,null),E.ULS.sendTraceTag(592545155,1303,50,this.lma("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.ur()}}}pnb(wa){if(this.PL){var ta=0;this.kq&&(ta=this.kq.entryPoint);this.lX.obc(this.AL,this.YWb,this.nWa(),ta).then(Eb=>{ba.Wxd("SearchFromHost",
this.AL);this.kq.launchData||(this.kq.launchData=new Aa.a);const qc=pb();try{this.PL.search(this.kq,Eb,r.AFrameworkApplication.userSessionId,qc,wa),this.lX.euh(Sc=>{ba.Wxd("SearchFromHostWithToken",this.AL);this.PL.searchAuthenticatedProviders(this.kq,Eb,r.AFrameworkApplication.userSessionId,qc,null,Sc)})}catch(Sc){ba.xu("BaseSmartLookupPane - Fail to search from host. Error: "+Sc,10)}}).catch(Eb=>{ba.xu("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+Eb.toString(),
10)})}}fxc(wa){this.$Od&&ba.fxc(this.AL,Math.round(window.performance.now()-wa),this.kq?ha.a[this.kq.entryPoint]:"",this.lX.Qcb(),this.lX.ajg(),r.AFrameworkApplication.YOc,this.LQa,gc(this.kq?this.kq.entryPoint:0))}}Object(k.a)(Yf,"BaseSmartLookupPane",null,[1340,106]);class ke{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(k.a)(ke,"SmartLookupTaskPaneProps",null,[]);var ef=d(661);class yf{}Object(k.a)(yf,"ActionDescriptor",null,[]);var Rf=d(99);class Za extends Yf{constructor(wa,ta,Eb,
qc=null,Sc=null,td=null,je=!0,Te=null,Hd=null){super(ta,Eb,qc,Sc,td,je,Te,Hd);this.zWd=!!r.AFrameworkApplication.za&&!!r.AFrameworkApplication.za.mb&&r.AFrameworkApplication.za.mb.mye;this.Psb=this.MTd=!1;this.hji=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.gji=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.lji=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.kji=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);this.Eqh=()=>{if(this.PL)this.PL.onPaneThemeChanged(this.nWa());return za.a("getTheme")?appChrome.api.getTheme():null};this.LUe=()=>{ba.xu("ReactSmartLookupPane - Iframe component failed to load.",10)};this.i6k=()=>{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||ba.xu("ReactSmartLookupPane - Onload detected no network.",
50)};je||ba.xu("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.Fsa=wa;this.Quf=zc(this.l9a)}get isVisible(){return this.Psb}Zxd(wa,ta){this.kq=wa;this.Pja=wa=Object.assign(new K.a,{neighborhood:wa.selection.neighborhood,mentionStart:wa.selection.mentionStart,mentionLength:wa.selection.mentionLength});this.LQa=!wa.mentionLength;this.AL=ta;this.pnb(!1)}Dze(wa){this.kq=wa;this.HAa(Object.assign(new K.a,{neighborhood:wa.selection.neighborhood,mentionStart:wa.selection.mentionStart,
mentionLength:wa.selection.mentionLength}),!1)}Jl(wa,ta){this.AL=ta;this.HAa(wa,!0)}haf(wa,ta,Eb){this.kq=wa;this.Jl(Object.assign(new K.a,{neighborhood:wa.selection.neighborhood,mentionStart:wa.selection.mentionStart,mentionLength:wa.selection.mentionLength}),ta,Eb)}ur(){this.Fyd();this.Fsa.hideTaskPane()}HAa(wa,ta){ia.SessionStatusManager.instance.p1&&this.PL?(this.Pja=wa,this.LQa=!wa.mentionLength,wa=window.performance.now(),this.initialize(),this.isVisible?r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupDisableRefreshPaneIsEnabled")?
(this.Fsa.updateTaskPane(null),ta&&this.cNl()):(ta&&this.pnb(!1),this.MTd=!this.MTd,this.Fsa.updateTaskPane(this.Hea())):(ta&&this.pnb(this.isVisible),this.Fsa.showTaskPane(this.Hea())),this.fxc(wa)):(this.Fsa.showTaskPane(this.Hea()),ba.FMl(ia.SessionStatusManager.instance.p1,!!this.PL,this.kq?ha.a[this.kq.entryPoint]:"",this.lX.Qcb(),r.AFrameworkApplication.YOc,this.LQa))}cNl(){if(!this.kq){const wa=Object.assign(new ca.a,{neighborhood:this.Pja.neighborhood,mentionStart:this.Pja.mentionStart,mentionLength:this.Pja.mentionLength});
this.kq=Object.assign(new ka.a,{selection:wa,userIntent:null,entryPoint:0,launchData:null})}this.pnb(this.isVisible)}OMl(){const wa=new yf;wa.transactionId=this.AL;wa.actionType=15;wa.channelId=H.channelId;this.nNb(wa)}Gkb(wa){const ta=wa.rawEvent;document.getElementById(H.x_)&&ta.source!==document.getElementById(H.x_).contentWindow||this.tsl(wa)}tsl(wa){const ta=wa.rawEvent;let Eb;try{Eb=oa.b(ta.data)}catch(qc){E.ULS.sendTraceTag(545604257,1303,15,this.lma("Message data from Serplet [{0}] failed to deserialize.",
ta.data));return}switch(Eb.actionType){case 32:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Rf.a.Mbc()>=this.hji?this.Fsa.updateTaskPane(this.y8d(this.gji)):Rf.a.Mbc()>=this.lji&&this.Fsa.updateTaskPane(this.y8d(this.kji)));break;case 33:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.Fsa.updateTaskPane(this.y8d(Eb.data));break;case 42:this.Fsa.updateTaskPane(this.H7i(Eb.data));
break;case 43:this.Fsa.updateTaskPane(this.Hea());break;default:super.Gkb(wa)}}dispose(){}initialize(){this.eob()}eob(){const wa=this.Wd.Kc(H.x_);wa.parent=Ba.AFrame.Nj;wa.uK=!0}Gyd(){this.Wd.Df(H.x_)}Fyd(){this.lye()&&this.Wd.Df(this.Wd.R9)}r2e(){$addHandler(window,"message",Object(F.a)(this,this.Gkb,"onIFrameMessage"))}Ugf(){$removeHandler(window,"message",Object(F.a)(this,this.Gkb,"onIFrameMessage"))}lye(){return!!this.Wd.Je&&this.Wd.Je.name===H.x_}nNb(wa){wa=oa.c(wa);document.getElementById(H.x_)&&
document.getElementById(H.x_).contentWindow.postMessage(wa,mb.a.CR(this.Quf))}lma(wa,...ta){const Eb={};this.AL&&(Eb[H.uXh]=this.AL);Eb[H.vXh]=String.format.apply(null,[wa].concat(ta));return oa.c(Eb)}nWa(){return za.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}X6e(){}mQl(){document.getElementById(H.x_)&&D.FocusManager.dr(document.getElementById(H.x_).contentWindow)}gAj(){return this.kq?10===this.kq.entryPoint?2===r.AFrameworkApplication.za.mb.Ej?CommonUIStrings.l_ReuseSlidesPaneTitle:
CommonUIStrings.l_ReuseFilesPaneTitle:18===this.kq.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.kq.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.kq.entryPoint||38===this.kq.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}Hea(){var wa=CommonUIStrings.L_SmartLookupPaneTitle;r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(wa=this.gAj());const ta=new ke;ta.src=
this.Quf;ta.id=H.x_;ta.refreshPane=this.MTd;ta.onError=this.LUe;ta.onLoad=this.i6k;ta.title=wa;ia.SessionStatusManager.instance.p1?this.PL||(ta.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,ta.errorType=1):(ta.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,ta.errorType=0);wa=Object.assign(new ef.a,{title:wa,hideHeader:!1,width:H.width,location:H.zcl,contentProps:ta,isModernPane:!0,onOpen:()=>{this.Gyd();this.Psb=!0;this.r2e();za.a("registerOnThemeChangeCallback")&&
appChrome.api.registerOnThemeChangeCallback(this.Eqh);r.AFrameworkApplication.za.Gf();if(this.PL)this.PL.onPaneStateChanged(!0)},onClose:()=>{this.OMl();this.Fyd();this.Psb=!1;this.Ugf();za.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.Eqh);r.AFrameworkApplication.za.Gf();if(this.PL)this.PL.onPaneStateChanged(!1)}});this.zWd&&(wa.enableResize=!0,wa.minResizeWidth=320,wa.maxResizeWidth=920);return wa}H7i(wa){const ta=this.Hea();ta.title=wa;ta.contentProps.title=wa;
return ta}y8d(wa){const ta=this.Hea();ta.resizeWidth=wa;return ta}}Object(k.a)(Za,"ReactSmartLookupPane",Yf,[]);var Kb=d(144);class Ic{constructor(){this.gxf=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(wa){Kb.UISurfaces.qr().then(ta=>{this.gxf||(wa.enableResize=!1);ta.showTaskPane(H.x_,wa);return null})}updateTaskPane(wa=null){Kb.UISurfaces.qr().then(ta=>{ta.setSelectedTaskPane(H.x_);wa&&(this.gxf||(wa.enableResize=
!1),ta.updateTaskPane(H.x_,wa));return null})}hideTaskPane(){Kb.UISurfaces.qr().then(wa=>{wa.hideTaskPane(H.x_,2);return null})}}Object(k.a)(Ic,"PptReactSmartLookupPaneHandler",null,[1302]);class Hc{static Uke(){switch(r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")?"PROD":r.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")?
"INT":Hc.KAj()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static KAj(){switch(Object(Ya.a)(String,r.AFrameworkApplication.ld.AudienceGroup)||""){case "Dogfood":if(r.AFrameworkApplication.fa){let wa=r.AFrameworkApplication.fa.Ea("UserPrincipalName");wa=dc.a.Dg(wa);const ta=r.AFrameworkApplication.fa.du("SmartLookupINTEnabledForSKITeam")?r.AFrameworkApplication.fa.hz("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ta,wa)?"INT":"EDOG"}return"EDOG";
default:return"PROD"}}}Object(k.a)(Hc,"Utils",null,[]);class jd{constructor(wa,ta=null){this.AL=this.kq=this.Pja=null;this.LQa=!1;this.PL=null;this.KL=wa;this.YWb=ta?ta:new he;Q.a.instance.ub("Common.App.SearchCommon.SearchHostRuntime")&&(this.PL=Q.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").bie());this.lX=Q.a.instance.resolve("Common.App.SearchCommon.ISearchHelper");this.l9a=this.lX.Qcb()}pnb(wa){if(this.PL){var ta=0;this.kq&&(ta=this.kq.entryPoint);this.lX.obc(this.AL,this.YWb,
this.nWa(),ta).then(Eb=>{ba.Wxd("SearchFromHost",this.AL);this.kq.launchData||(this.kq.launchData=new Aa.a);const qc=pb();try{this.PL.search(this.kq,Eb,r.AFrameworkApplication.userSessionId,qc,wa),this.lX.euh(Sc=>{ba.Wxd("SearchFromHostWithToken",this.AL);this.PL.searchAuthenticatedProviders(this.kq,Eb,r.AFrameworkApplication.userSessionId,qc,null,Sc)})}catch(Sc){ba.xu("BaseSmartLookupPane - Fail to search from host. Error: "+Sc,10)}}).catch(Eb=>{ba.xu("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+
Eb.toString(),10)})}}r2e(){$addHandler(window,"message",Object(F.a)(this,this.Gkb,"onIFrameMessage"))}Ugf(){$removeHandler(window,"message",Object(F.a)(this,this.Gkb,"onIFrameMessage"))}nNb(wa){wa=oa.c(wa);document.getElementById(this.yBb())&&document.getElementById(this.yBb()).contentWindow.postMessage(wa,mb.a.CR(ib()))}Gkb(wa){let ta;wa=wa.rawEvent;try{ta=oa.b(wa.data)}catch(Eb){E.ULS.sendTraceTag(509614105,1303,15,this.lma("Message data from Serplet [{0}] failed to deserialize.",wa.data));return}switch(ta.actionType){case 103:wa=
oa.b(Object(Ya.a)(String,ta.data));ba.sendTelemetryEvent(wa);break;case 206:this.lX.y2c(ta.data).then(Eb=>{ta.data=Eb;this.nNb(ta)});break;case 112:ta.data.shiftPressed?(La.a.jg&&document.activeElement.blur(),this.KL.f3c(0,null,2,null,null),E.ULS.sendTraceTag(509614104,1303,50,this.lma("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.KL.yWa(0,null,2,null,null),E.ULS.sendTraceTag(509614103,1303,50,this.lma("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.ur()}}lma(wa,...ta){const Eb=
{};this.AL&&(Eb[H.uXh]=this.AL);Eb[H.vXh]=String.format.apply(null,[wa].concat(ta));return oa.c(Eb)}fxc(wa){ba.fxc(this.AL,Math.round(window.performance.now()-wa),this.kq?ha.a[this.kq.entryPoint]:"",this.lX.Qcb(),this.lX.ajg(),r.AFrameworkApplication.YOc,this.LQa,gc(this.kq?this.kq.entryPoint:0))}}jd.FDi="AppProperties";jd.A3l="SmartLookupApplicationInterface";Object(k.a)(jd,"BaseCopilotAddin",null,[1337,106]);class Id extends jd{constructor(wa,ta,Eb,qc){if(!wa)throw Error.argumentNull("actionManager");
if(!ta)throw Error.argumentNull("appForOfficeManager");if(!qc)throw Error.argumentNull("f6Manager");super(qc,Eb);this.Mb=!1;this.hWg=!0;this.EMg="FA000000006";this.ia=wa;this.Oc=ta;this.Ps={};this.ASk=Hc.Uke();this.Ps.sourceLocationOverrideResourceId=this.ASk;this.Ps.BA="Copilot";this.Ps.assetId=this.EMg}haf(wa,ta){this.kq=wa;const Eb=Object.assign(new K.a,{neighborhood:wa.selection.neighborhood,mentionStart:wa.selection.mentionStart,mentionLength:wa.selection.mentionLength});this.AL=ta;this.Pja=
Eb;this.LQa=!Eb.mentionLength;ia.SessionStatusManager.instance.p1&&this.PL?(this.pnb(!1),this.lX.obc(this.AL,this.YWb,this.nWa(),wa.entryPoint).then(qc=>{qc.isFirstLaunch=this.hWg;this.hWg=!1;const Sc={};Sc[jd.A3l]=this.kq;Sc[jd.FDi]=qc;this.Ps.nonPersistedSettings=Sc;this.Ps.q7=Object(F.a)(this,this.Jkb,"onPaneRendered");this.ia.Ia(id.a.Aia,2,this.Ps);this.Mb=!0})):(this.ia.Ia(id.a.Aia,2,this.Ps),this.Mb=!0)}Jkb(){this.r2e()}ur(){const wa=this.yBb();this.Ugf();wa&&this.ia&&this.ia.Ia(id.a.Gxb,2,
wa);this.Mb=!1}Zxd(wa,ta){this.kq=wa;this.Pja=wa=Object.assign(new K.a,{neighborhood:wa.selection.neighborhood,mentionStart:wa.selection.mentionStart,mentionLength:wa.selection.mentionLength});this.LQa=!wa.mentionLength;this.AL=ta;this.pnb(!1)}dispose(){}yBb(){if(this.Oc.instance){const wa=this.Oc.instance.TO(this.EMg+"."+this.Ps.sourceLocationOverrideResourceId);if(wa)return wa.zj;Xc.a.J(509433935,1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else Xc.a.J(509433934,1313,15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");
return null}nWa(){return za.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.Mb}}Object(k.a)(Id,"PptCopilotAddin",jd,[]);class ze extends ee{constructor(wa,ta,Eb,qc,Sc){super();this.Uah=wa;this.Lb=Eb;this.ia=qc;this.Oc=Sc}NTc(){const wa=this.Lb.getBooleanAppSetting("822");return new Za(new Ic,w.a.instance,D.FocusManager.instance(),Q.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Q.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Q.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),wa,Q.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}p7d(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?new Id(this.ia,this.Oc,null,w.a.instance):super.p7d()}scb(){return this.Uah.getSelectedText()}QCg(){return this.Uah.Ugk()}}Object(k.a)(ze,"SmartLookupManager",ee,[]);var Ie=d(92);class Cd{constructor(wa,ta,Eb,qc,Sc,td,je){this.rV=wa;this.Eb=ta;this.yTk=
Eb;this.KRk=qc;this.sSk=Sc;this.lKk=td;this.rdh=je;this.aJa=new Map;if(!wa)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!ta)throw Error.argumentNull("m_transactionFactory");if(!Eb)throw Error.argumentNull("m_textODSLEntity");if(!qc)throw Error.argumentNull("m_shapeODSLEntity");if(!Sc)throw Error.argumentNull("m_slideODSLEntity");if(!td)throw Error.argumentNull("m_imageODSLEntity");if(!je)throw Error.argumentNull("m_tablesODSLEntity");this.rV&&this.rV.execute(Te=>{this.Oc=Te});this.aJa=
new Map;this.aJa.set("text",this.yTk);this.aJa.set("shapes",this.KRk);this.aJa.set("slides",this.sSk);this.aJa.set("images",this.lKk);this.aJa.set("tables",this.rdh);this.aJa.set("table",this.rdh)}LZi(wa,ta){return Object.assign({},...wa.map(Eb=>ta.has(Eb.value)?{[Eb.name]:ta.get(Eb.value)}:{[Eb.name]:JSON.parse(Eb.value)}))}mck(wa){Object(Ie.b)(this,void 0,void 0,function*(){if(this.Oc){var ta=this.Eb.xe(15);try{ta.mc(this.Oc.$O.presentation);const Eb=new Map;for(const qc of wa.statements){const Sc=
qc.name.split("_");if(2!==Sc.length)throw Error.argumentOutOfRange("statement",Sc,"Provided ODSL statement does not have expected format of action_entity.");const td=Sc[0],je=Sc[1];if(!this.aJa.has(je))throw Error.argumentOutOfRange("entityName",je,"Provided entity name in ODSL statement is not supported.");const Te=this.aJa.get(je);if(!Te)throw Error.argumentOutOfRange("entity",Te,"Could not access entity for provided ODSL statement.");const Hd=this.LZi(qc.arguments,Eb);if(!Hd)throw Error.argumentOutOfRange("args",
Hd,"Could not construct ODSL statement input from provided args.");let mg;switch(td){case "select":mg=yield Te.select(Hd);break;case "format":mg=yield Te.format(Hd);break;case "insert":mg=yield Te.insert(Hd);break;case "delete":mg=yield Te.delete(Hd);break;case "default":throw Error.argumentOutOfRange("action",td,"Provided action in ODSL statement is not supported.");}qc.returnVariable&&mg&&Eb.set(qc.returnVariable,mg)}}catch(Eb){Xc.a.J(509440020,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Eb}`)}finally{ta&&
ta.dispose()}}else Xc.a.J(509440021,1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")})}}Object(k.a)(Cd,"ODSLInterpreter",null,[1272]);var ue=d(47),Ee;(function(wa){wa.Idle="Idle";wa.TranscribingVoice="TranscribingVoice";wa.EndPending="EndPending";wa.EndPendingWithCancel="EndPendingWithCancel";wa.CancelPending="CancelPending"})(Ee||(Ee={}));Object(k.b)("DictationState",Ee);class Xe{constructor(wa,ta,Eb,qc,Sc){this.Yb=wa;this.ia=ta;
this.ih=Eb;this.Fa=qc;this.nHe=[];this.Iad=[];this.CK=Ee.Idle;this.dfd=!1;this.pgb=ue.a.b7d;this.onAction=td=>{if(td)switch(td.actionType){case "SubmitQuery":this.X_j(td.query);break;case "ToggleDictation":this.mXj();break;case "CancelQuery":this.W_j()}};this.Sge=()=>[this.nHe.join(" "),this.Iad.join()].join(" ");if(!this.Yb)throw Error.argumentNull("m_workspace");if(!this.ia)throw Error.argumentNull("m_actionManager");if(!this.ih)throw Error.argumentNull("m_f6Manager");if(!this.Fa)throw Error.argumentNull("m_focusManager");
if(!Sc)throw Error.argumentNull("actorFuture");Sc.execute(()=>{this.start().catch(td=>{E.ULS.sendTraceTag(509440287,1313,10,`Unable to start Copilot UX, error: ${td}`)})})}vle(){this.V_j();return""}Mpg(){return""}wzc(){this.H_j();return!0}HFa(){this.QVj()}aOf(wa){this.WTj(wa);return!0}jyg(wa){this.bWj(wa);return!0}Lhh(){}HPb(wa){var ta,Eb;E.ULS.sendTraceTag(509113183,1313,15,`Unexpected "${wa}" called for Dictation FSM state: "${this.CK}". Listening: "${this.dfd}"`);this.dfd?(this.CK=Ee.EndPending,
this.qDd()):(this.CK=Ee.Idle,null===(Eb=null===(ta=this.QIa)||void 0===ta?void 0:ta.setMicState)||void 0===Eb?void 0:Eb.call(ta,!1))}U2h(wa){var ta,Eb;null===(Eb=null===(ta=this.QIa)||void 0===ta?void 0:ta.setMicState)||void 0===Eb?void 0:Eb.call(ta,wa)}V_j(){this.CK!==Ee.Idle&&this.CK!==Ee.EndPending?this.HPb("handleTextBeforeSelection"):(this.CK=Ee.TranscribingVoice,this.U2h(!0))}H_j(){this.CK!==Ee.TranscribingVoice&&this.CK!==Ee.EndPending?this.HPb("handleStartTurn"):this.CK=Ee.TranscribingVoice}QVj(){switch(this.CK){case Ee.EndPending:case Ee.EndPendingWithCancel:this.U2h(!1);
const wa=this.Sge();0<wa.length&&this.CK===Ee.EndPending&&this.Ooh(wa);this.nHe=[];this.Iad=[];this.CK=Ee.Idle;break;case Ee.CancelPending:this.CK=Ee.EndPendingWithCancel;break;case Ee.TranscribingVoice:this.CK=Ee.EndPending;break;case Ee.Idle:break;default:this.HPb("handleEndTurn")}}$_j(){this.CK!==Ee.TranscribingVoice?this.HPb("handleTimeout"):this.CK=Ee.CancelPending}WTj(wa){var ta,Eb;this.CK!==Ee.TranscribingVoice?this.HPb("handleAppendText"):this.QIa&&(this.Iad.push(wa),null===(Eb=(ta=this.QIa).setQuery)||
void 0===Eb?void 0:Eb.call(ta,this.Sge()))}bWj(wa){var ta,Eb;this.CK!==Ee.TranscribingVoice?this.HPb("handleFinalText"):(this.Iad=[],""===wa?this.$_j():this.QIa&&(this.nHe.push(wa),null===(Eb=(ta=this.QIa).setQuery)||void 0===Eb?void 0:Eb.call(ta,this.Sge())))}X_j(wa){this.CK!=Ee.Idle?this.qDd():this.Ooh(wa)}W_j(){this.CK!==Ee.Idle&&(this.qDd(),this.CK=Ee.CancelPending)}mXj(){this.qDd()}qDd(){this.ia.Ia(Jb.a.UAc,2,{s5f:Xe.F7h});this.dfd=!this.dfd}Ooh(wa){wa=Object.assign(new ka.a,{selection:Object.assign(new ca.a,
{neighborhood:wa,mentionStart:0,mentionLength:wa.length}),launchData:Object.assign(new Aa.a,{landingTab:"Copilot"}),entryPoint:0});this.ia.Ia(Qa.a.W5c,2,wa)}Rxj(){var wa;this.dhb||(this.dhb=document.createElement("div"),this.dhb.id="copilotHost",(null!==(wa=document.getElementById(Xe.jOi))&&void 0!==wa?wa:document.body).appendChild(this.dhb));return this.dhb}KVl(){this.Fa.R2b(this.pgb);const wa=this.Fa.Kc(this.pgb);wa.parent=Ba.AFrame.Nj;wa.uK=!0;wa.cea(()=>{var ta;null===(ta=this.QIa)||void 0===
ta?void 0:ta.focus()});this.ih.Hka(this.pgb);this.ih.bM(this.pgb);this.dhb.addEventListener("focusin",ta=>{var Eb;ta.preventDefault();ta.stopPropagation();(null===(Eb=this.Fa.Je)||void 0===Eb?void 0:Eb.name)!==this.pgb&&this.Fa.dW(this.pgb,!1)});this.dhb.addEventListener("focusout",ta=>{var Eb,qc,Sc;ta.preventDefault();ta.stopPropagation();for(ta=null!==(Eb=ta.relatedTarget)&&void 0!==Eb?Eb:document.activeElement;ta;){if(ta===this.dhb)return;ta=ta.parentElement}null===(Sc=null===(qc=this.QIa)||void 0===
qc?void 0:qc.collapse)||void 0===Sc?void 0:Sc.call(qc);this.Fa.P2(this.pgb,!1)})}start(){return Object(Ie.b)(this,void 0,void 0,function*(){const wa=this.Rxj();this.QIa=yield(yield Kb.UISurfaces.Qxj()).renderCopilot(wa,{onAction:this.onAction});if(!this.QIa)throw Error("Copilot control interface is not returned.");this.KVl()})}}Xe.jOi="WACViewPanelContainer";Xe.F7h="PowerPointWebEditor.SmartLookup.FABDictationHost";Object(k.a)(Xe,"PptCopilot",null,[1025]);var Sd=d(990),ad=d(986),af=d(989),pf=d(1082),
xf=d(985),gf=d(1001),me=d(339),ag=d(991);class de extends Fb{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){r.AFrameworkApplication.LAa&&this.lej()}fc(wa){super.fc(wa);wa.register(Pc.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new Pc.a);wa.register(ze,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").ma().na(()=>new ze(wa.resolve("Common.App.Insights.IInsightsSelection"),
wa,wa.resolve("Common.IAppSettingsManager"),wa.resolve("Common.IActionManagerExtended"),wa.Ha("PowerPointWebEditor.IAppForOfficeManager")));wa.register(945,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").ma().na(()=>new Nb.a(new e.a(()=>Qb.App.Ob?Qb.App.Ob.ie.qj:null),hc.InteractiveViewManager.instance,wa.resolve("Box4.ISelectionFactory"),wa.resolve("PowerPointWebEditor.ISlideReader"),wa.resolve("PowerPointWebEditor.IPPTWorkspace"),wa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
new n.a,wa.resolve("Common.IActionManagerExtended"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("PowerPointWebEditor.IClipServiceManager"),wa.resolve("PowerPointWebEditor.IPresentationReader")));r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(wa.register(me.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").ma().na(()=>new me.a(wa.resolve("Box4.Graph.IGraphIteratorFactory"),
wa.resolve("Box4.IOutlineEditor"),wa.resolve("Box4.IOutlineElementNavigator"),wa.resolve("Box4.ICharacterPropertiesEditor"))),wa.register(xf.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").ma().na(()=>new xf.a(wa.Ha("PowerPointWebEditor.AppForOfficeManager"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("Box4.IFormattingEditor"),wa.resolve("Box4.IParagraphEditor"),wa.resolve("PowerPointWebEditor.IShapeReader"),
wa.resolve("Box4.List.IListEditor"),wa.resolve("Box4.ICharacterPropertiesEditor"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),wa.register(ad.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").ma().na(()=>new ad.a(wa.Ha("PowerPointWebEditor.AppForOfficeManager"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),wa.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),
wa.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),wa.resolve("PowerPointWebEditor.IShapeReader"),wa.resolve("PowerPointWebEditor.IShapeEditor"),wa.resolve("PowerPointWebEditor.IPPTUnitConversion"),wa.resolve("PowerPointWebEditor.View.IPPTPageView"),wa.resolve("PowerPointWebEditor.IGraphTransactionHelper"),wa.resolve("PowerPointWebEditor.IRibbonChangeManager"))),wa.register(af.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").ma().na(()=>
new af.a(wa.Ha("PowerPointWebEditor.AppForOfficeManager"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),wa.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),wa.register(Sd.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").ma().na(()=>new Sd.a(wa.Ha("PowerPointWebEditor.AppForOfficeManager"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"))),
wa.register(pf.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").ma().na(()=>new pf.a(wa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),wa.resolve("PowerPointWebEditor.IFocusManager"),wa.resolve("PowerPointWebEditor.IShapeEditor"),wa.resolve("PowerPointWebEditor.IRibbonChangeManager"),wa.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
wa.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),wa.resolve("Common.IActionManagerExtended"),wa.resolve("PowerPointWebEditor.IGraphTransactionHelper"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),wa.register(gf.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLContext").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext").ma().na(()=>new gf.a(wa.Ha("PowerPointWebEditor.AppForOfficeManager"),wa.resolve("PowerPointWebEditor.IPptSelectionManager"),
wa.resolve("PowerPointWebEditor.IShapeReader"))),wa.register(Cd,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter").ma().na(()=>new Cd(wa.Ha("PowerPointWebEditor.AppForOfficeManager"),wa.resolve("Common.Transaction.ITransactionFactory"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),
wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"))),wa.register(ag.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").ma().na(()=>new ag.a(wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa.resolve("Common.Transaction.ITransactionFactory"),
wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),wa.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));wa.register(1216,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").ma().na(()=>new Tb(wa.resolve("Common.IActionManagerExtended"),
wa.ub("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter"),wa.ub("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext")));wa.register(1217,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").ma().na(()=>new Cc(r.AFrameworkApplication.Pa,wa.resolve("PowerPointWebEditor.IPptSelectionManager"),wa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));wa.register(944,"Common.App.SearchCommon.IDocumentHelper").ma().na(()=>new re);
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(wa.register(Xe,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.FABDictationHost").ma().na(()=>new Xe(wa.resolve("PowerPointWebEditor.IPPTWorkspace"),wa.resolve("Common.IActionManagerExtended"),w.a.instance,D.FocusManager.instance(),wa.Ha("Common.App.Insights.InsightsActor"))),wa.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){y.a.instance.Ac(new de)}}
Object(k.a)(de,"PptSmartLookupPackage",Fb,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");de.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.smartlookup.js.map
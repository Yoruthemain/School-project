var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.PowerPoint=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}({16:function(e,t,i){"use strict";i.r(t);var n=[[/!/g,"%21"],[/'/g,"%27"],[/\(/g,"%28"],[/\)/g,"%29"],[/\*/g,"%2A"]],o=["eurppc"];function r(e){return 8===e.toLowerCase().indexOf("ffc")}function s(e){return 8===e.toLowerCase().indexOf("ppc")}function a(e,t){if(!t||-1===o.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function c(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function u(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function d(e,t,i){i&&(e[t.toLowerCase()]=i)}function l(e,t){e[t.toLowerCase()]=""}function f(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function h(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var u=c.index+1,d=o.indexOf("&",u);o=o.substring(0,u)+a+i+(-1===d?"":o.substring(d))}return o}return o.concat(s,a,i)}function p(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}function m(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}function v(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function w(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!!o&&(!i||o[1]===i)}function g(e,t){var i=f(e,t);return i?decodeURI(i):i}function S(e){return f(window.location.href,e)}function I(e){var t=encodeURIComponent(e);return n.forEach((function(e){t=t.replace(e[0],e[1])})),t}function b(e){var t=(e+"===").substring(0,e.length+(4-e.length%4)%4);return t=(t=t.replace(/-/g,"+")).replace(/_/g,"/"),atob(t)}function C(e){var t=document.createElement("a");t.href=e;var i=t.port||80,n=window.location.port||80;return t.hostname===window.location.hostname&&i===n}function _(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function y(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}function T(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return E&&(!t||t(e))},preconnect:function(t){return y(e?v(t):t)}}}var A,U,P,E=!0;function O(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(A||(A={})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=225]="msoulscat_MSOSP_OTelJS",e[e.A=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.U=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.P=301]="msoulscat_Wac_WordViewer",e[e.O=306]="msoulscat_Wac_BrowserGeneral",e[e.F=320]="msoulscat_Wac_TaskPane",e[e.N=339]="msoulscat_Wac_OneNoteGeneral",e[e.R=340]="msoulscat_Wac_Ribbon",e[e.k=356]="msoulscat_Wac_WacFeedback",e[e.B=379]="msoulscat_Wac_WopiPendingApplication",e[e.H=383]="msoulscat_Wac_Telemetry",e[e.J=391]="msoulscat_Wac_WacCatchUpActivities",e[e.j=394]="msoulscat_Wac_Dictation",e[e.q=395]="msoulscat_Wac_OneNoteSync",e[e.K=700]="msoulscat_Wac_VisioApp",e[e.Z=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.$=800]="msoulscat_Wac_PptAnimation",e[e.X=833]="msoulscat_Wac_PptLive",e[e.Y=834]="msoulscat_Wac_PptMWeb",e[e.ee=844]="msoulscat_Wac_PptDataSync",e[e.te=848]="msoulscat_Wac_PptFluidRuntime",e[e.ie=815]="msoulscat_Wac_PptShape",e[e.ne=817]="msoulscat_Wac_PptSession",e[e.oe=830]="msoulscat_Wac_PptSlideshow",e[e.re=822]="msoulscat_Wac_PptView",e[e.se=2300]="msoulscat_Wac_VersionHistory",e[e.ae=302]="msoulscat_Wac_WordPresence",e[e.ce=3e3]="msoulscat_Wac_OAuth",e[e.ue=3005]="msoulscat_Wac_WordVersionHistory",e[e.de=3006]="msoulscat_Wac_LivePersonaCard",e[e.le=3012]="msoulscat_Wac_CatchUpFlyout",e[e.fe=3016]="msoulscat_Wac_WordDesigner",e[e.he=3021]="msoulscat_Wac_ModernFontPicker",e[e.pe=3027]="msoulscat_Wac_UnifiedUiHost",e[e.me=3033]="msoulscat_Wac_EquationTools",e[e.ve=1401]="msoulscat_Osf_Latency",e[e.we=1402]="msoulscat_Osf_Notification",e[e.ge=1403]="msoulscat_Osf_Runtime",e[e.Se=3041]="msoulscat_Wac_AiMaker",e[e.Ie=3043]="msoulscat_Wac_AiRewrite",e[e.be=3044]="msoulscat_Wac_AiInsert",e[e.Ce=3047]="msoulscat_Wac_AiSummarize",e[e._e=3048]="msoulscat_Wac_CopilotCompose",e[e.ye=3049]="msoulscat_Wac_Skittles"}(U||(U={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(P||(P={}));var F={BUILD_NUMBER:"###VERSION###"};function N(){try{return"20230804.9"}catch(e){return F.BUILD_NUMBER}}var R;function k(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t,payloadJson:JSON.stringify(i)};O(JSON.stringify(o),e,n)}(e,"JSAPI_STATE",{application:t,build:N(),state:i})}function x(e,t,i,n){var o=[],r=e.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,n,o)})),s=function(e,t,i,n,o){var r={};r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o);return r.V=1,r}(n,r,t,i,o);return JSON.stringify(s)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(R||(R={}));var D,W=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function M(){return W?window.performance.now():Date.now()}function B(){if(!D){var e=window.performance;D=W&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return D()}var H,L,V=function(){function e(e){var t=this;this.Te=3e4,this.Ae=30,this.Ue=0,this.Pe=[],this.Ee=B(),this.Oe=[],this.Fe="",this.Ne=0,this.flushOnClose=function(){t.Re(!1,!1)},this.flush=function(){t.ke()},this.flushAndSetNewEndpoint=function(e,i){var n,o=t.xe(e);o.localeCompare(null!==(n=t.De)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t.Oe.push((function(){t.De=o,i&&i()})),t.Re(!0,!0))},this.xe=function(e){return e+"?usid="+t.Fe+"&officeserverversion="+N()},this.ke=function(){window.setTimeout((function(){return t.Re(!0,!0)}),0)},this.Re=function(e,i){var n=M();if(window.clearTimeout(t.We),t.De){if(t.Pe.length>0)t.Ue+=1,O(x(t.Pe.splice(0,e?t.Ae:t.Pe.length),t.Fe,t.Ue,t.Ee),t.De,i),t.Ee=B();0===t.Pe.length&&t.Oe.length>0&&(t.Oe.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.Oe=[]),e&&(t.We=window.setTimeout((function(){t.ke()}),t.Pe.length>t.Ae||t.Oe.length>0?1e3:t.Te)),t.Ne+=M()-n}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Ne},e.prototype.addLoggingTime=function(e){this.Ne+=e},e.prototype.configure=function(e){var t=this,i=M();if(e.uploadCadenceInMs&&(this.Te=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.Ae=e.uploadTriggerSize),e.sessionId&&(this.Fe=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.De)throw new Error("Remote ULS endpoint is already set");this.De=this.xe(e.remoteUlsEndpoint),this.Ee=B(),window.setTimeout((function(){return t.Re(!0,!0)}),0)}this.Ne+=M()-i},e.prototype.handleTrace=function(e){var t=M();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Pe.push(e),(this.Pe.length>this.Ae||e.level===P.Error)&&this.ke(),this.Ne+=M()-t},e}(),J=[];!function(e){e.Me="BootstrapperMaxUlsHeartbeatTime",e.Be="BootstrapperNoCompleteWarning1Time",e.He="BootstrapperNoCompleteWarning2Time",e.Le="RemoteUlsETag",e.Ve="RemoteUlsSuppressions",e.Je="BootstrapperSettingsFetchPeriod",e.je="timestamp",e.ze="BootstrapperUlsHeartbeatIntervalMs",e.Ge="BootstrapperUlsHeartBeatIsEnabled",e.qe="BootstrapperUlsUploadCadenceMs",e.Ke="WordConsumptionViewToEditRedirectIsEnabled",e.Ze="RequestedCallThrottlingDefaultToViewMinimumValue",e.$e="BulsEndpointUrl",e.Xe="EnableCommonHostDiagnosticsParams",e.Qe="EnableOnSubmitCallbackForWacFrame"}(L||(L={}));var j;function z(e){var t=new V(e);function i(e,i,n,o){var r=M();if(!function(e){return 1===J[e]}(e)){var s={timestamp:B(),category:i,tag:e,level:n,type:R.Trace,message:o,correlationId:""};t.addLoggingTime(M()-r),t.handleTrace(s)}}return{ULS:{Ye:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,o){n&&i(e,t,P.Error,o)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.et.getValue(L.Ve,""),n=e.et.getValue(L.Le,""),H&&n===H||(J=[],H=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(J[t]=1)}))),t.configure({uploadCadenceInMs:e.et.getValue(L.qe,6e4)});var o=e.et.getValue(L.$e,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},flushAndSetNewEndpoint:function(e,i){t.flushAndSetNewEndpoint(e,i)}}}function G(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function q(e,t){return void 0===t?null:t}function K(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}function Z(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(!t)return;try{return t(e)}catch(e){i&&i.ULS.Ye(594883024,U.B,P.Error,"IsFeatureEnabled callback error: "+K(e))}return}(i,e,t)}}}function $(e,t){var i={};if(Object.keys(j).forEach((function(t){var n=e.isFeatureEnabled(j[t]);void 0!==n&&(i[j[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[j.tt]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}!function(e){e.tt="EnterpriseTemplates",e.it="ExcelAdaptiveLayoutDownload",e.nt="ExcelLandingPageOfflineTelemetry",e.ot="ExcelLandingPageObserverRetry",e.rt="H2StaticContent",e.st="HashedUrl",e.ct="ODCShareLinkPreload",e.ut="OfficeComExcelJsApiV2",e.dt="OfficeComPptJsApiV2",e.lt="OfficeComUiHost",e.ft="OfficeComWordJsApiV2",e.ht="OfficeHwaUiHost",e.pt="OfficeUnifiedUiHostTeams",e.vt="WordViewToUnifiedRead",e.wt="FrameSizeFixForUiHostTeams"}(j||(j={}));var X,Q,Y,ee,te,ie,ne=function(){function e(){this.gt=[]}return e.prototype.add=function(e){e&&this.gt.push(e)},e.prototype.remove=function(e){if(e){var t=this.gt.indexOf(e);t>-1&&this.gt.splice(t,1)}},e.prototype.removeAll=function(){this.gt=[]},e.prototype.dispatch=function(e,t){this.gt.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),oe=function(){function e(e,t){var i=this;this.St=0,this.It=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.bt);if(!e)return;var t=JSON.parse(e);i.Ct(t)}catch(e){i._t.ULS.Ye(592836768,U.B,P.Warning,"Failed to get settings from localStorage: "+K(e))}},this.Ct=function(e){return!!i.yt(e)&&(i.Tt=e,i.At.dispatch({et:i},(function(e){i._t.ULS.Ye(592836769,U.B,P.Error,"Settings listener error: "+K(e))})),!0)},this.yt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(L.je)&&!isNaN(e.timestamp))return!0;i._t.ULS.Ye(592836770,U.B,P.Error,"Received invalid settings")}return!1},this.Ut=function(){if(i.Pt){var e=new XMLHttpRequest;e.open("GET",i.Pt),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.Et(e.response),i.St=0):(i._t.ULS.Ye(592836771,U.B,P.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.St)),i.St+=1),!(i.St>7)){var t=i.getValue(L.Je,3e5);i.St>3&&(t+=(i.St-3+1)*(t/2)),i.Ot=window.setTimeout(i.Ut,t)}}}},this.Et=function(e){"requestIdleCallback"in window?(i.Ft&&self.cancelIdleCallback(i.Ft),i.Ft=window.requestIdleCallback((function(){return i.Nt(e)}),{timeout:1e4})):window.setTimeout((function(){return i.Nt(e)}),0)},this.Nt=function(e){if(i.Ct(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.bt,t)}catch(e){i._t.ULS.Ye(592836800,U.B,P.Warning,"Failed to set localStorage: "+K(e))}}},this.Rt=e,this.bt="Prod"+e+"Settings",this._t=t,this.At=new ne,this.It()}return e.prototype.initializePeriodicFetch=function(e,t){this.bt=(r(e)?"FF":"Prod")+this.Rt+"Settings",this.It(),this.Pt=e+"AppSettingsHandler.ashx?app="+this.Rt+"&usid="+t+"&build="+N(),this.Ot||(this.Ot=window.setTimeout(this.Ut,3e4))},e.prototype.getValue=function(e,t){if(this.Tt||this.It(),!this.Tt||!this.Tt.hasOwnProperty(e))return t;var i=this.Tt[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.At.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.At.remove(e)},e.prototype.dispose=function(){this.Ot&&window.clearTimeout(this.Ot),this.Ft&&self.cancelIdleCallback(this.Ft),this.Ot=void 0,this.Ft=void 0,this.Tt=void 0,this.At.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete"}(X||(X={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared"}(Q||(Q={})),function(e){e.kt="App_AccessibilityLoopComplete",e.xt="Wac_ActionComplete",e.Dt="WacInitialize_Ready",e.Wt="Wac_AppFailed",e.Mt="Wac_AppBootState",e.Bt="Wac_AppCompleted",e.Ht="BrowserEvent",e.Lt="UI_Close",e.Vt="App_CloseTab",e.Jt="UI_Conversation",e.jt="UI_CopyAndEdit",e.zt="App_CreateNewDocument",e.Gt="Wac_AppDataSavedStatus",e.qt="UI_Download",e.Kt="UI_Edit",e.Zt="Error",e.$t="UI_FileEmbed",e.Xt="UI_FileProperties",e.Qt="File_Rename",e.Yt="File_RenameFailed",e.ei="UI_FileVersions",e.ti="StateChanged",e.ii="App_IsFrameTrusted",e.ni="GetAccessToken",e.oi="App_GetAuthToken",e.ri="App_GetCustomAuthConfig",e.si="App_GetHostKeyValue",e.ai="App_WopiInfoFromUrl",e.ci="App_DavUrlFromIds",e.di="App_LoadingStatus",e.li="App_SwitchMode",e.fi="App_MoveToFolder",e.hi="UI_OpenInMobileApp",e.pi="UI_OpenInBrowser",e.mi="UI_OpenInClient",e.vi="PageChanged",e.wi="App_PushCommentContext",e.gi="App_PushState",e.Si="App_DocReboot",e.Ii="UI_RedeemForCommenting",e.bi="App_RefreshSessionInfo",e.Ci="UI_ReplyWithChanges",e._i="UI_ReportAbuse",e.yi="App_FilePicker",e.Ti="UI_SaveStatus",e.Ai="WopiSession_Complete_Ack",e.Ui="SetOverlayContent",e.Pi="UI_Sharing",e.Ei="UI_ShareForm",e.Oi="UI_SignIn",e.Fi="App_StoreHostKeyValue",e.Ni="App_Unloaded",e.Ri="App_UlsLog",e.ki="Wac_UnloadingApp",e.xi="App_UpdateBootComplete",e.Di="PageCount",e.Wi="UI_CheckUserAccessAndGrantPermissions",e.Mi="User_Activity",e.Bi="Edit_Notification",e.Hi="UI_Workflow",e.Li="ZoomChanged",e.Vi="CAAEMessage",e.Ji="Excel_HostFrameCacheSave",e.ji="Excel_HostFrameCacheEvict",e.zi="Excel_RegenerateFileBundle",e.Gi="App_SwitchToWacFrame",e.qi="App_SaveSSRData",e.Ki="App_PurgeDataInHostCache",e.Zi="App_SaveHostRenderingV2Data",e.$i="App_SaveHostUtilsData",e.Xi="AcquireOAuthTokenTeams",e.Qi="App_SwitchNotebook",e.Yi="FailedBoot_CheckFileInfo",e.en="GetTeamsUsers",e.tn="SendTeamsUserMention",e.in="NavigateBackToHost",e.nn="App_GetClientUrlComplete",e.on="App_GetWebUrlComplete",e.rn="App_CopyLinkComplete",e.sn="App_SendConversationId",e.an="CloseTeamsConversation",e.cn="PageLoaded",e.un="Visio_BRS",e.dn="Visio_SendLicenseInfo",e.ln="Visio_Consumption_CLTComplete",e.fn="Visio_SwitchMode_FromViewFrame",e.hn="Visio_ModeSwitch_ToHost_Ack",e.pn="Visio_UpdateEditUrl",e.mn="Visio_PageViewLoaded",e.vn="Visio_ActiveAppFrameLoadFailed",e.wn="Visio_DisposeBkgFrame",e.gn="Visio_ReadyToReceiveDocData",e.Sn="Visio_DocReboot_HostNav",e.In="Visio_SwitchToVisioFrame",e.bn="WacAppPerfMetric",e.Cn="App_ModifyURLState"}(Y||(Y={})),function(e){e._n="Ack",e.yn="WacInitialize_Ready_Ack",e.Tn="Wac_BeforeUnloadApp",e.An="Blur_Focus",e.Un="Wac_AppFailed_Ack",e.Pn="Wac_AppCompleted_Ack",e.En="WopiStartSession_Complete",e.On="WopiPendingSession_Complete",e.Fn="Host_AccessibilityLoopComplete",e.ii="Host_IsFrameTrusted",e.Nn="Grab_Focus",e.Rn="HostCacheDiagnostic",e.kn="Host_KeyValue",e.xn="JsApiDiagnostics",e.fi="Host_MoveToFolder",e.Dn="PageChanged_Ack",e.Wn="App_PopState",e.Mn="Host_SendChannelId",e.Bn="Host_SendConversationId",e.Hn="GetTeamsUsers_Reply",e.Ln="SendTeamsUserMention_Reply",e.Vn="Host_BackButtonPressed",e.Jn="Host_GetClientUrl",e.jn="Host_GetWebUrl",e.zn="File_Rename",e.yi="Host_FilePicker",e.Gn="PostAccessToken",e.qn="Host_SetAuthToken",e.Kn="Host_SetCustomAuthConfig",e.Zn="App_PushCommentContext",e.$n="CanEmbed",e.Xn="Host_RefreshSessionInfo",e.Qn="CheckUserAccessAndGrantPermissions_Result",e.Yn="Host_WopiInfoFromUrl",e.eo="Host_DavUrlFromIds",e.to="SetCurrentPage",e.io="SetZoomLevel",e.no="WopiPendingSession_Fail",e.oo="SetOverlayContent",e.ro="WopiPendingApplicationComplete_Received",e.so="Host_SwitchMode",e.ao="Host_Unload",e.co="PageCount_Ack",e.uo="ZoomChanged_Ack",e.do="Host_ShareUI",e.lo="Host_Telemetry",e.fo="Visio_ConsumptionCLTComplete_Ack",e.ho="Visio_SwitchMode_FromHF_Ack",e.po="Visio_SwitchMode_FromHostFrame",e.mo="Visio_FallbackToLegacySwitch",e.vo="Visio_DocumentData"}(ee||(ee={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(te||(te={}));var re=((ie={})[Q.boot]={wo:X.boot},ie[Q.createNew]={wo:X.createNew},ie[Q.dispose]={wo:X.dispose},ie[Q.rename]={wo:X.rename},ie[Q.switchMode]={wo:X.switchMode},ie[Y.Mt]={wo:X.handleBootState},ie[Y.Vt]={wo:X.closeTab},ie[Y.ii]={wo:X.frameTrust},ie[Y.oi]={wo:X.getAuthToken},ie[Y.si]={wo:X.getHostKeyValue},ie[Y.Si]={wo:X.appReboot},ie[Y.Ui]={wo:X.setOverlayContent},ie[Y.Fi]={wo:X.storeHostKeyValue},ie[Y.xi]={wo:X.updateBootComplete},ie[Q.blurFocus]={So:ee.An},ie[Q.continueAccessibilityLoop]={So:ee.Fn},ie[Q.grabFocus]={So:ee.Nn},ie[Q.moveToFolder]={So:ee.fi},ie[Q.popState]={So:ee.Wn},ie[Q.sendChannelId]={So:ee.Mn},ie[Q.sendConvId]={So:ee.Bn},ie[Q.teamsUsersReply]={So:ee.Hn},ie[Q.teamsUserMentionReply]={So:ee.Ln},ie[Q.backButtonPressed]={So:ee.Vn},ie[Q.getClientUrl]={So:ee.Jn},ie[Q.getWebUrl]={So:ee.jn},ie[Q.sendAccessToken]={So:ee.Gn},ie[Q.sendAuthToken]={So:ee.qn},ie[Q.sendHWRTelemetry]={So:ee.lo},ie[Q.sendCustomAuthConfig]={So:ee.Kn},ie[Q.sendDavUrl]={So:ee.eo},ie[Q.sendEmbeddedViewUrl]={So:ee.$n},ie[Q.sendFrameTrustResult]={So:ee.ii},ie[Q.sendSessionInfo]={So:ee.Xn},ie[Q.sendUserAccessAndPermissions]={So:ee.Qn},ie[Q.sendWopiInfo]={So:ee.Yn},ie[Q.signalShared]={So:ee.do},ie[Q.completeSharedFilePicker]={So:ee.yi},ie[Y.kt]={Io:te.AccessibilityLoopCompleted},ie[Y.xt]={Io:te.ActionCompleted},ie[Y.Ht]={Io:te.BrowserEvent},ie[Y.Vi]={Io:te.CAAEMessage},ie[Y.Lt]={Io:te.Close},ie[Y.Jt]={Io:te.Conversation},ie[Y.jt]={Io:te.CopyAndEdit},ie[Y.zt]={Io:te.CreateNewDocument},ie[Y.qt]={Io:te.Download},ie[Y.Kt]={Io:te.Edit},ie[Y.Zt]={Io:te.Error},ie[Y.$t]={Io:te.FileEmbed},ie[Y.Xt]={Io:te.FileProperties},ie[Y.Qt]={Io:te.FileRenamed},ie[Y.ei]={Io:te.FileVersions},ie[Y.ni]={Io:te.GetAccessToken},ie[Y.ci]={Io:te.GetDavUrlFromIds},ie[Y.ri]={Io:te.GetCustomAuthConfig},ie[Y.ai]={Io:te.GetWopiInfoFromUrl},ie[Y.ti]={Io:te.FrameStateChanged},ie[Y.li]={Io:te.ModeSwitched},ie[Y.fi]={Io:te.MoveToFolder},ie[Y.hi]={Io:te.OpenInMobileApp},ie[Y.pi]={Io:te.OpenInBrowser},ie[Y.mi]={Io:te.OpenInClient},ie[Y.vi]={Io:te.PageChanged},ie[Y.gi]={Io:te.PushState},ie[Y.Ii]={Io:te.RedeemForCommenting},ie[Y.bi]={Io:te.RefreshSessionInfo},ie[Y.Ci]={Io:te.ReplyWithChanges},ie[Y.yi]={Io:te.SharedFilePicker},ie[Y._i]={Io:te.ReportAbuse},ie[Y.Ti]={Io:te.SaveStatus},ie[Y.Pi]={Io:te.Share},ie[Y.Ei]={Io:te.ShareForm},ie[Y.Oi]={Io:te.SignIn},ie[Y.Wi]={Io:te.UserAccessAndPermissions},ie[Y.Mi]={Io:te.UserActivity},ie[Y.Bi]={Io:te.UserEditActivity},ie[Y.Hi]={Io:te.Workflow},ie[Y.Li]={Io:te.ZoomChanged},ie[Y.Xi]={Io:te.AcquireOAuthTokenTeams},ie[Y.di]={Io:te.LoadingStatus},ie[Y.Qi]={Io:te.SwitchNotebook},ie[Y.Yi]={Io:te.FailedBootCheckFileInfo},ie[Y.en]={Io:te.GetTeamsUsers},ie[Y.tn]={Io:te.SendTeamsUserMention},ie[Y.in]={Io:te.NavigateBackToHost},ie[Y.nn]={Io:te.GetClientUrlComplete},ie[Y.on]={Io:te.GetWebUrlComplete},ie[Y.rn]={Io:te.CopyLinkComplete},ie[Y.sn]={Io:te.SendConversationId},ie[Y.an]={Io:te.CloseTeamsConversation},ie[Y.cn]={Io:te.PageLoaded},ie);function se(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(K(e)))}}t.perfNow=W;for(var n=0;n<e.length;n+=1){try{if(W){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(K(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}function ae(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,ce)}function ce(){var e=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):Math.floor(16*Math.random()).toString(16)}var ue=function(e,t){return(ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};var de=function(){return(de=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function le(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function fe(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;var he;Object.create;!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(he||(he={}));var pe=window.navigator,me=pe?pe.userAgent:void 0;function ve(){if(me){if(me.indexOf("Firefox")>-1)return he.Firefox;if(me.indexOf("Opera")>-1||me.indexOf("OPR")>-1)return he.Opera;if(me.indexOf("Trident")>-1)return he.IE;if(me.indexOf("Electron")>-1&&me.indexOf("Teams")>-1)return he.TeamsElectron;if(me.indexOf("Edg")>-1)return he.Edge;if(me.indexOf("Chrome")>-1)return he.Chrome;if(me.indexOf("Safari")>-1)return he.Safari}return he.Unknown}function we(){try{return!!me&&me.indexOf("iPad")>=0||!!me&&me.indexOf("Macintosh")>=0&&ye()&&!be()||!!me&&me.indexOf("Android")>=0||ye()}catch(e){return!1}}function ge(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function Se(){return ve()===he.IE&&!function(){if(ve()!==he.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function Ie(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function be(){return!!me&&me.indexOf("iPhone")>=0}function Ce(){return be()||/android.+mobile/i.test(pe.userAgent)}function _e(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1}function ye(){return!!pe&&pe.maxTouchPoints>0}function Te(e,t){t&&Object.keys(t).forEach((function(i){e[i]=t[i]}))}function Ae(e,t){try{if(void 0===window.performance)return void t.ULS.Ye(595948609,U.B,P.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.Ye(595948610,U.B,P.Info,"No resources under performance");for(var n=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),o=i.length-1;o>=0;o-=1){var r=i[o],s=r.name.match(n);if(s){var a=JSON.stringify(r);return a=a.replace(new RegExp(r.name,"g"),s[0]),void t.ULS.Ye(595948616,U.B,P.Info,a)}}t.ULS.Ye(595948484,U.B,P.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.Ye(595948617,U.B,P.Info,"Could not trace the resource timing: ".concat(K(e)))}}function Ue(e){var t,i,n=de(de({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=de({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c,u,d=e.wopi;return{accessToken:d?{length:d.accessToken.length,expiry:d.expiry}:"N/A",bootParams:e.bootParams,build:N(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:(c=e.appBaseUrl,u=c.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i),u&&u[1]?u[1]:"public"),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function Pe(){var e={perfNowSupported:W,browser:he[ve()],touchMode:we(),highContrast:ge(),windows10x:Ie()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function Ee(){try{return localStorage.setItem("Test","Test"),localStorage.removeItem("Test"),!0}catch(e){return!1}}var Oe;function Fe(e,t){try{var i=parseInt(e,10);if(!i)return;if(i<=B()-6e4)t.ULS.Ye(558155805,U.B,P.Warning,"Bad userClickTime or host took 60+s to kick off the session from click");else if(Ee()){var n=i.toString(),o=localStorage.getItem("lastUserClickTime");if(o){var r=parseInt(o,10);r&&i<=r?t.ULS.Ye(558155806,U.B,P.Warning,"Bad userClickTime: less than or equal to lastUserClickTime, delta: "+(r-i)):localStorage.setItem("lastUserClickTime",n)}else localStorage.setItem("lastUserClickTime",n)}}catch(e){t.ULS.Ye(558155807,U.B,P.Error,"Error when tracking userClickTime: "+K(e))}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(Oe||(Oe={}));var Ne=function(){function e(e,t){this.bo=function(){return Re(e,"OnBeforeUnload",t)},this.Co=function(){return Re(e,"OnPageHide",t)},this._o=function(){return Re(e,"VisibilityChange_"+document.visibilityState,t)},this.yo=function(){return Re(e,"OnUnload",t)},window.addEventListener("beforeunload",this.bo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Co,{capture:!0}),window.addEventListener("visibilitychange",this._o,{capture:!0}),window.addEventListener("unload",this.yo,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.bo,{capture:!0}),window.removeEventListener("pagehide",this.Co,{capture:!0}),window.removeEventListener("visibilitychange",this._o,{capture:!0}),window.removeEventListener("unload",this.yo,{capture:!0})},e}();function Re(e,t,i){e.ULS.Ye(595957843,U.B,P.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var ke=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com"],xe=function(){function e(e){var t=this;this.To={},this.Ao=[],this.Uo=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var n=JSON.parse(i),o=n.AddinTrustId;o&&"AddinTrustedOrigin"===n.MessageId&&(t._t.ULS.Ye(560754784,U.B,P.Info,"didReceiveMessage addinTrustId ".concat(o)),t.To[o]=e.origin,t.Ao.forEach((function(t){t(o,e.origin)})))}}catch(e){t._t.ULS.Ye(560754785,U.B,P.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this._t=e,window.addEventListener("message",this.Uo)}return e.prototype.isResourceTrustedForMessage=function(e){return le(this,void 0,void 0,(function(){var t,i,n,o,r,s,a,c,u=this;return fe(this,(function(d){switch(d.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(n=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=ke;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,n]:this.To[i]?[2,De(t,this.To[i])]:(r=new Promise((function(e){o=function(n,o){i===n&&e(De(t,o))},u.Ao.push(o)})),s=-1,2e3,a=new Promise((function(e){s=window.setTimeout((function(){u._t.ULS.Ye(560754786,U.B,P.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([r,a])])):[2,!1];case 1:return c=d.sent(),this.Ao=this.Ao.filter((function(e){return e!==o})),window.clearTimeout(s),[2,c]}}))}))},e.prototype.dispose=function(){this.To={},this.Ao=[],window.removeEventListener("message",this.Uo)},e}();function De(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var We=function(){function e(e,t,i,n,o,r,s){var a,c=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.Po={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},n=c.Po[t];if(n&&n.length>0)c.Eo(t,i);else{var o=re[t];if(o){var r=o.wo,s=o.Io;r?(c.logger.ULS.Ye(574654543,U.B,P.Info,"Running flow: ".concat(r)),c.Oo[r](t,i,c,c.Fo[r]).catch((function(e){c.No(r,e)}))):s&&c.raiseEvent(s,i)}}},this.No=function(e,t){c.logger.ULS.Ye(596459925,U.B,P.Error,"".concat(e," flow error: ").concat(K(t))),c.remoteTelemetryUrl&&k(c.remoteTelemetryUrl,c.appInfo.name,"flowException")},this.Eo=function(e,t){c.logger.ULS.Ye(574654544,U.B,P.Info,"Dispatching action: ".concat(e));for(var i=c.Po[e].slice().reverse(),n=i.length-1;n>-1;n-=1)try{i[n](e,t)}catch(t){c.logger.ULS.Ye(596444186,U.B,P.Error,"".concat(e," action handler error: ").concat(K(t)))}return Promise.resolve({completion:"success"})},this.state=A.Unknown;var u=se(),d=u[0],l=u[1];this.logger=z(),this.logger.ULS.Ye(593506837,U.B,P.Info,JSON.stringify(l)),this.sessionId=d,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=n,this.appInfo=t,this.session=o,this.featureManager=Z(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.et=new oe(t.name,this.logger),this.preloader=t.preloader,a=r(this.featureManager),this.Oo=a[0],this.Fo=a[1],this.Ro=s,this.et.addSettingsChangeListener(this.logger.settingsChangeHandler),this.clientDiagnostics=Pe(),this.pageStateObserver=new Ne(this.logger,!0),this.authTokenTrustValidator=new xe(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.Ye(574654541,U.B,P.Info,"Raising event: ".concat(e));try{this.Ro(e,t)}catch(e){this.logger.ULS.Ye(593506838,U.B,P.Error,"Event handler error: ".concat(K(e)))}},e.prototype.addActionHandler=function(e,t){this.Po[e]||(this.Po[e]=[]),this.Po[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.Po[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var n=this;if(this.state===A.Disposed&&this.backgroundSession)return this.logger.ULS.Ye(525203609,U.B,P.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var o=[],r=this.Po[e];if(r&&r.length>0)o.push(this.Eo(e,t));else{var s=re[e];if(s){var a=s.wo,c=s.So;if(a){this.logger.ULS.Ye(574654542,U.B,P.Info,"Running flow: ".concat(a));var u=this.Oo[a](e,t,this,this.Fo[a],i).catch((function(e){return n.No(a,e),{completion:"failure",error:e}}));o.push(u)}else c&&(this.container&&this.container.postMessage(c,t),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.Ye(593500189,U.B,P.Warning,"Unhandled command: ".concat(e))}return Promise.race(o)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.et.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.Po={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}();var Me,Be=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i);this.ko=new We(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.ko.state=A.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.ko.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.ko.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.ko.run(e,t,i)},e.prototype.boot=function(e,t){return this.ko.run(Q.boot,e,t)},e.prototype.dispose=function(e){return this.ko.run(Q.dispose,void 0,e)},e}(),He=function(){function e(e,t,i){var n,o,r=this;this.xo="",this.Do="",this.Wo=!1,this.Mo=!1,this.Bo=!1,this.Ho=!1,this.Lo=function(e){var t,i=!1,n=!0,o="",s=!1;if(r.Vo&&r.Vo.contentWindow&&(i=!0,n=e.source===r.Vo.contentWindow),e.origin&&(s=(o=u(e.origin,2).toLowerCase())===r.Do),!r.Wo&&(!r.Mo||s&&n)||r._t.ULS.Ye(593232850,U.B,P.Info,"Window: available["+i+"] valid["+n+"]; Origin: valid["+s+"] expected["+r.Do+"] actual["+o+"]"),s&&(!r.Bo||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void r._t.ULS.Ye(593232851,U.B,P.Info,"Failed to parse event data: ".concat(K(e)))}var c=a.MessageId;if(c){if(r._t.ULS.Ye(593232854,U.B,P.Info,"Received message: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==Y.Bt&&c!==Y.di||r.setTargetOrigin(e.origin),a.Values&&a.Values.ackExpected&&r.postMessage(ee._n,void 0,a.CorrelationId),r.Ho&&c===Y.bn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);if(r.Jo)try{r.Jo(a)}catch(e){r._t.ULS.Ye(594556386,U.B,P.Error,"Message handler error: ".concat(K(e)))}else r._t.ULS.Ye(591933923,U.B,P.Error,"No message handler")}else(r.Wo||r.Mo)&&r._t.ULS.Ye(593232853,U.B,P.Info,"Missing message id")}},this._t=t,this.setTargetOrigin(e),i&&this.setMessageHandler(i),this.Ho=!!(null===(o=null===(n=window.location)||void 0===n?void 0:n.search)||void 0===o?void 0:o.match(/wdpa=1/gi)),window.addEventListener("message",this.Lo,!1)}return e.prototype.setTargetOrigin=function(e){var t=c(e).toLowerCase();this.xo&&this.xo!==t&&this._t.ULS.Ye(593232847,U.B,P.Warning,"Updating origin: [".concat(_(this.xo),"]->[").concat(_(t),"]")),this.xo=t,this.Do=u(t,2),this.Wo=r(t),this.Mo=s(t)},e.prototype.setTargetFrame=function(e,t){this.Vo=e,this.Bo=!!t},e.prototype.setMessageHandler=function(e){this.Jo=e},e.prototype.removeMessageHandler=function(){this.Jo=void 0},e.prototype.postMessage=function(e,t,i){if(this.Vo&&this.Vo.contentWindow){this._t.ULS.Ye(593232849,U.B,P.Info,"Sending message: "+e);var n={MessageId:e,SendTime:B(),CorrelationId:i,Values:t};this.Vo.contentWindow.postMessage(JSON.stringify(n),this.xo)}else this._t.ULS.Ye(593232848,U.B,P.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.Lo,!1),this.Jo=void 0},e}();!function(e){e.jo="access_token",e.zo="access_token_ttl",e.Go="bundleSrc",e.qo="bundleStaleness",e.Ko="DocID",e.Zo="SiteID",e.$o="WebID",e.Xo="ETag",e.Qo="feature_status",e.Yo="fileExtension",e.er="fileGetUrl",e.tr="customFontCatalogUrl",e.ir="fileName",e.nr="fileSize",e.or="forceSLR",e.rr="frameHeightPx",e.sr="frameWidthtPx",e.ar="highContrast",e.cr="highDpi",e.ur="host_diagnostics",e.dr="hostName",e.lr="huictrls",e.hr="owner_id",e.pr="sc",e.mr="softBlockedBrowser",e.vr="templateUrl",e.wr="touchMode",e.gr="user_id",e.Sr="hfck",e.Ir="hfcv",e.br="timeZoneId",e.Cr="darkCssMedia",e._r="caae",e.yr="meetingId",e.Tr="meetingTitle",e.Ar="meetingType",e.Ur="scheduledStartTime",e.Pr="scheduledEndTime",e.Er="isPresenter",e.Or="meetingOrganizerId",e.Fr="meetingJoinUrl",e.Nr="isMeetingTeamsRoom",e.Rr="jsapibuild",e.kr="owlver",e.xr="owlro",e.Dr="caaemode"}(Me||(Me={}));function Le(e,t){ve()===he.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function Ve(e,t,i){d(t,Me.rr,String(i?window.outerHeight:e.offsetHeight)),d(t,Me.sr,String(i?window.outerWidth:e.offsetWidth)),d(t,Me.wr,String(we())),d(t,Me.ar,String(ge())),d(t,Me.or,String(Ie())),d(t,Me.Cr,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function Je(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.Ye(591525084,U.B,P.Info,"Trust check error: ".concat(K(t))),!1}}function je(e){return!(!e||!e.parentNode)&&(e.id?!!document.getElementById(e.id):void 0!==e.isConnected?e.isConnected:document.body.contains(e))}var ze=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.Wr=e,this.Mr=t,this.Br=t+"_Form",this.Hr=Je(),this.Lr=!1}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Wr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.Br},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.Hr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCallbackOnSubmitEnabled",{get:function(){return this.Lr},set:function(e){this.Lr=e},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,n){var o=this;this._t=i,this.Vr=new He(e,i,this.Jo);var r=n.useAdditionalDiv,s=n.permissionsPolicy;this.Jr&&!r?(this.Jr.setAttribute("allow",s),this._t.ULS.Ye(588793045,U.B,P.Info,"Wac frame reused")):(this.Jr=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,u=c.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",i),Le(u,s),n&&(e.style.minHeight=n,u.style.minHeight=n),o&&(e.style.minWidth=o,u.style.minWidth=o),a&&u.setAttribute("role","none"),r){var d=c.createElement("div");d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.backgroundColor="#393a3d",d.style.backfaceVisibility="hidden",n&&(d.style.minHeight=n),o&&(d.style.minWidth=o),d.appendChild(u),e.appendChild(d)}else e.appendChild(u);return u}(this.Wr,this.Mr,s,n.minHeight,n.minWidth,r,n.isInvisible,n.setNoneRole),this._t.ULS.Ye(588793046,U.B,P.Info,"Wac frame created")),this.Vr.setTargetFrame(this.Jr,n.enforceSameWindow),r&&(this.jr=this.Jr.parentElement),n.useFrameFixForTeams&&i.ULS.Ye(509143245,U.B,P.Info,"Frame fix enabled for teams uiHost"),Ve(this.Jr,t,n.useFrameFixForTeams),this.zr=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Wr,this.Mr,this.Br,e,t),this.Lr?(this.zr.onsubmit=function(){var e;null===(e=o._t)||void 0===e||e.ULS.Ye(509161933,U.B,P.Info,"WAC Frame submitted")},this.zr.requestSubmit(null)):this.zr.submit()},e.prototype.setVisibility=function(e){this.Jr&&Le(this.Jr,e)},e.prototype.setMessageHandler=function(e){this.Jo=e,this.Vr&&this.Vr.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Gr=e},e.prototype.removeMessageHandler=function(){this.Jo=void 0,this.Vr&&this.Vr.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Gr?this.Gr(e,t):this.Vr&&this.Vr.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.zr&&(i.Wr.removeChild(i.zr),i.zr=void 0),i.Vr&&(i.Vr.dispose(),i.Vr=void 0,i.Jo=void 0),i.Gr&&(i.Gr=void 0),i._t=void 0,!i.Jr||!i.jr&&e)n();else{var o=function(){i.jr?(i.jr.removeChild(i.Jr),i.Wr.removeChild(i.jr)):i.Wr.removeChild(i.Jr),i.Jr=void 0,i.jr=void 0,n()};t?o():(i.Jr.src="about:blank",window.setTimeout(o,0))}}))},e}();var Ge=function(){function e(e,t,i){var n,o=this;this.sessions=[],this.containers=[],this.qr=function(e){o.Kr.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.Zr=e,this.$r=t,this.Xr=i,this.Kr=new ne,(n=e.host.owlVersion)&&(F.BUILD_NUMBER=n),"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}return Object.defineProperty(e.prototype,"name",{get:function(){return this.$r.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return N()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.Kr.add(e)},e.prototype.removeEventListener=function(e){this.Kr.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.$r.name,"_").concat(this.containers.length),i=new ze(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Be(this.Zr,this.$r,e,this,this.qr,this.Xr);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.Kr.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}();function qe(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}function Ke(e){return function(e,t){var i={};t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]}));return e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),e)}function Ze(e,t,i){var n=de(de(de({},p(e.appUrl)),function(e){var t={};d(t,"jsapi","1"),d(t,"jsapiver","v2"),d(t,"corrid",e.sessionId),d(t,"usid",e.sessionId),d(t,"newsession","1"),d(t,"sftc","1"),e.hostSessionId&&d(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&d(t,"uih",i.uiHostName),i.uiHostIntegrationType&&d(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&d(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&d(t,"accloop","1"),n.rebootDoc&&d(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&d(t,"scnd","1"),n.authToken&&d(t,"sat","1"),n.customAuthConfig&&d(t,"cac","1"),n.refreshAccessToken&&d(t,"rat","1"),n.atMentions&&d(t,"sams","1"),n.moveToFolder&&d(t,"mtf","1"),n.noBrowserModalDialogs&&d(t,"nbmd","1"),n.commonFilePicker&&d(t,"sfp","1"),n.directDownload&&d(t,"sdd","1"),n.directPrint&&d(t,"sdp","1"));var o=e.ui;o.language&&d(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&d(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&d(t,"hhdr","1"),o.highContrast&&d(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&d(t,"hodflp","1"),o.hideAppLauncherInHeader&&d(t,"halh","1"),o.hideChatInHeader&&d(t,"hch","1"),o.hideMeInHeader&&d(t,"hmh","1"),o.hideSearchInHeader&&d(t,"hsh","1"),o.hideWorkflowInHeader&&d(t,"hwfh","1"),o.hideSettingsInHeader&&d(t,"hsth","1"),o.showAppIconInHeader&&d(t,"sih","1"),o.useNeutralColorInHeader&&d(t,"unh","1"),o.openLinksInNewWindow&&d(t,"onw","1"),o.useDarkTheme&&d(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||d(t,"readOnly","1");var r=e.wopi;r&&r.source&&d(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&d(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&d(t,"readonly","1"),s.disableChat&&d(t,"dchat","1"),s.cookieCompliant&&d(t,"mscc","1"),s.isNewFile&&(d(t,"new","1"),s.isFromHostTemplate&&d(t,"wdtpl","fromhost"))),e.user.isLicensed&&d(t,"islicenseduser","1"),e.user.isSynthetic&&d(t,"syn","1"),e.actNavId&&d(t,"actnavid",e.actNavId),e.sessionContext&&d(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)d(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&d(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&d(t,"preseededwacsessionid",encodeURIComponent(u.id)));var f=e.throttling;f&&(f.protection&&d(t,"ctp",f.protection),f.request&&d(t,"rct",f.request));var h=e.hostInitDiagnostics;h&&(h.entryPoint&&d(t,"wdorigin",encodeURI(h.entryPoint)),h.userClickTime&&d(t,"wdhostclicktime",h.userClickTime.toString()));var p=e.rebootOverride;return p&&p.previousSessionId&&d(t,"wdprevioussession",p.previousSessionId),l(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=de(de({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function $e(e,t){var i=function(e){var t={};d(t,"highdpi",String(window.devicePixelRatio>1.24)),d(t,"softblockedbrowser",String(Se())),d(t,"hostname",e.hostName),d(t,"feature_status",$(e.featureManager,e.wdParams)),d(t,"jsapibuild",N());var i=e.wopi;i&&(d(t,"access_token",i.accessToken),d(t,"access_token_ttl",i.expiry.toString()));var n=e.customFontCatalogUrl;n&&d(t,"customfontcatalogurl",n);var o=e.contentBundle;if(o&&o.url){d(t,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&d(t,Me.qo,r.toString()),e.logger.ULS.Ye(577783775,U.B,P.Info,"Content bundle staleness: "+(s?r:"N/A"))}var a=e.file,c=a.name;if(c){d(t,"filename",c);var u=G(c);u&&d(t,"fileextension",u)}a.getUrl&&d(t,"filegeturl",a.getUrl),a.size&&d(t,"filesize",a.size.toString()),a.eTag&&d(t,"etag",a.eTag),a.cTag&&d(t,"revid",a.cTag),a.uniqueId&&d(t,"docid",a.uniqueId);var l=e.newFileTemplate;l&&(l.getUrl&&d(t,"templateurl",l.getUrl),l.size&&d(t,"filesize",l.size.toString()),l.eTag&&d(t,"etag",l.eTag),l.uniqueId&&d(t,"docid",l.uniqueId)),e.user.id&&d(t,"user_id",e.user.id),e.ownerId&&d(t,"owner_id",e.ownerId),e.sessionContext&&d(t,"sc",e.sessionContext);var f=e.ui;f.controls&&d(t,"huictrls",JSON.stringify(f.controls)),"Templatization"!==f.contentAssemblyMode&&"DocGen"!==f.contentAssemblyMode&&"ContentAssemblyEdit"!==f.contentAssemblyMode&&"ContentAssemblyView"!==f.contentAssemblyMode||d(t,"caae","1"),f.contentAssemblyMode&&d(t,"caaemode",f.contentAssemblyMode);var h=e.meeting;h&&(h.id&&d(t,"meetingId",h.id),h.title&&d(t,"meetingTitle",h.title),h.type&&d(t,"meetingType",h.type),h.scheduledStartTime&&d(t,"scheduledStartTime",h.scheduledStartTime),h.scheduledEndTime&&d(t,"scheduledEndTime",h.scheduledEndTime),h.isPresenter&&d(t,"isPresenter",h.isPresenter.toString()),h.organizerId&&d(t,"meetingOrganizerId",h.organizerId),h.joinUrl&&d(t,"meetingJoinUrl",encodeURIComponent(h.joinUrl)),h.isMeetingTeamsRoom&&d(t,"isMeetingTeamsRoom",h.isMeetingTeamsRoom.toString()));var p=e.host;return p.owlVersion&&d(t,"owlver",p.owlVersion),p.owlRollout&&d(t,"owlro",p.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var Xe;function Qe(e,t){var i=function(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);if(!n||n.length<2)return"";return n[1]}(e);return"true"===i||"false"!==i&&t}function Ye(e,t,i,n,o){void 0===n&&(n=Xe.none);var r=e+"="+t,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var u=r+s+(";SameSite="+Xe[n]);return document.cookie=o?u+"; Secure":u,!(!document.cookie||-1===document.cookie.indexOf(r))||n===Xe.none&&Ye(e,t,i,Xe.doNotSet,o)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Xe||(Xe={}));var et=function(){function e(e,t,i,n,o){this.Qr=0,this.Yr=[],this.Wo=!1,this.Wo=e,this.es=t,this._t=i,this.ts=n,this.ns=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.es.getValue(L.Ge,!1);this.Qr=M()+(this.ns?this.ns:this.es.getValue(L.Me,6e5));var i=this.Wo?3e3:5e3;this.os=window.setInterval((function(){t&&e._t.ULS.Ye(595724178,U.B,P.Info,"Boot_HeartBeat"),M()>e.Qr&&(e.stop(),tt(e._t),e.ts&&e.ts())}),this.es.getValue(L.ze,i)),this.Yr.push(window.setTimeout(tt,this.es.getValue(L.Be,6e4),this._t,1)),this.Yr.push(window.setTimeout(tt,this.es.getValue(L.He,18e4),this._t,2))},e.prototype.stop=function(){this.Qr=0,this.os&&(window.clearInterval(this.os),this.os=void 0),this.Yr.forEach((function(e){window.clearTimeout(e)})),this.Yr=[]},e}();function tt(e,t){e.ULS.Ye(594901218,U.B,P.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}var it=function(e,t,i,n,o){return e!==Q.boot?Promise.reject("Wrong flow"):new Promise((function(e){var s,u=B();if(i.state=A.Booting,i.pendingReboot=!1,function(e,t){if(!e)throw new TypeError("SessionBootParams");var i=e.appUrl,n=e.appBaseUrl;if(!i&&!n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(i&&"string"!=typeof i)throw new TypeError("AppUrl");if(n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");var o=e.file;if(!o||!o.name)throw new TypeError("FileInfo");var r=e.container;if(!r||!(r instanceof ze)&&!r.appendChild)throw new TypeError("Container");if(!t&&!qe(e.wopi))throw new TypeError("WopiInfo")}(t,i.skipWopiValidation),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=Ke(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=de(de({},t.diagnostics),{hostInitializeCallTime:u}),i.et.getValue(L.Xe,!1)&&function(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var i=window.performance.navigation;if(i){void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount);var n="UNKNOWN";switch(i.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}e.hostPageNavigationType=n}}(i.hostInitDiagnostics),t.appUrl){var d=t.appUrl;i.appUrl=d;var l=i.bootParams;if(w(d,"new")&&(l.isNewFile=!0),!l.dataLanguage)(h=g(d,"rs"))&&(l.dataLanguage=h);var h,p=i.ui;if(w(d,"uiembed")&&(p.uiEmbed=!0),!p.language)(h=g(d,"ui"))&&(p.language=h);if(!i.hostInitDiagnostics.entryPoint){var m=g(d,"wdorigin");m&&(i.hostInitDiagnostics.entryPoint=m)}if(!i.host.uiHostName){var S=g(d,"uih");S&&(i.host.uiHostName=S)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():c(t.appUrl).toLowerCase(),i.appBaseUrl=a(i.appBaseUrl,f(i.appUrl,"region")),n.initializeAppContext(i,e,t),i.appBasePath=n.buildAppBasePath(i),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),k(i.remoteTelemetryUrl,i.appInfo.name,"init");var I=!1,b=i.preseededSession;i.appInfo.usePreseededSessionId&&b&&b.id&&(i.sessionId=b.id,I=!0);var C,_=!1,y=t.hostGeneratedSessionId;!I&&y&&(i.sessionId=y,_=!0),t.rebootOverride&&(I||_||(s=se(),i.sessionId=s[0],C=s[1]),i.et.addSettingsChangeListener(i.logger.settingsChangeHandler),i.pageStateObserver=new Ne(i.logger,!0),i.authTokenTrustValidator=new xe(i.logger)),i.logger.ULS.Ye(38580693,U.B,P.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(I,", is host generated: ").concat(_));var T=i.et.getValue(L.$e,"").toString();if(""===T&&(T=i.appBasePath+"RemoteUls.ashx"),i.logger.configure({remoteUlsEndpoint:T,sessionId:i.sessionId}),i.et.initializePeriodicFetch(i.appBasePath,i.sessionId),C&&i.logger.ULS.Ye(590966790,U.B,P.Info,JSON.stringify(C)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.Ye(558155803,U.B,P.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.Ye(596444237,U.B,P.Info,JSON.stringify({session:Ue(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.Ye(558155804,U.B,P.Error,"Failed to log init info: ".concat(K(t)))}}(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:N(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var E=t.container;i.container=E instanceof ze?E:i.application.createContainer(E)}i.container.setMessageHandler(i.onMessage);var O=i.et.getValue(L.Qe,!1);i.container.isCallbackOnSubmitEnabled=O;var F=!!n.ignoreCompletionMessage&&n.ignoreCompletionMessage(i),R=function(e,t){i.successTime=B(),F||(i.container.postMessage(ee.Pn,void 0),Te(i.appInitDiagnostics,t.Diagnostics)),n.onSuccess&&n.onSuccess(i,t),i.logger.ULS.Ye(596448985,U.B,P.Info,JSON.stringify(i.diagnostics)),k(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(ee.xn,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=A.Booted,D({completion:"success"}),Ae(i.appInfo.name,i.logger)},x=function(e,t){i.failureTime=B(),n.onFailure&&n.onFailure(i,t.Error),i.logger.ULS.Ye(596448986,U.B,P.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),k(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=A.Failed,D({completion:"failure"}),Ae(i.appInfo.name,i.logger)},D=function(t){F||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(Y.Bt,R),i.removeActionHandler(Y.Wt,x)),e(t)};o&&o.subscribe((function(){D({completion:o.reason||"cancelled"})})),F||(i.addActionHandler(Y.Bt,R),i.addActionHandler(Y.Wt,x)),function(e){return"wdjs"in e||"wd1js"in e}(i.wdParams)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?Ye("sideLoadingIsEnabled","false",0):Qe("sideLoadingIsEnabled",!1)||Ye("sideLoadingIsEnabled","true",1));var W=n.buildBootRequestParams(i),M=Ze(i,W.appPageName,W.queryParamsOverrides),H=$e(i,W.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(M))try{n.beforePreload&&n.beforePreload(i);var V=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(j.rt)&&(i.logger.ULS.Ye(590966791,U.B,P.Info,"HTTP2 preload enabled"),V=v(V)),i.preloader.preload(V,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.Ye(590966792,U.B,P.Error,K(e))}n.beforeContainerBoot&&n.beforeContainerBoot(i,M),i.appInitDiagnostics.officeFrameCreateTime=B(),i.container.boot(M,H,i.logger,n.buildContainerBootParams(i)),F?R(Y.Bt,{Diagnostics:{}}):(i.bootHeartBeat=new et(r(i.appBaseUrl),i.et,i.logger,(function(){i.timeoutTime=B(),n.onTimeout&&n.onTimeout(i),k(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),D({completion:"timeout"}),o&&o.cancel()}),o&&n.overrideBootTimeout?Math.min(o.timeoutInMs,n.overrideBootTimeout(i)):o?o.timeoutInMs:n.overrideBootTimeout?n.overrideBootTimeout(i):void 0),n.beforeBootCompletionMessage&&n.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=B(),n.onException&&n.onException(i,e),i.remoteTelemetryUrl&&k(i.remoteTelemetryUrl,i.application.name,"bootException"),e}))},nt=function(e,t,i){return new Promise((function(t){i.logger.ULS.Ye(590111070,U.B,P.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))};var ot=function(e,t,i,n,o){return e!==Q.createNew?Promise.reject("Wrong flow"):new Promise((function(r){var s={wopiPendingInitializeTime:B()},a=!!(n&&n.parallelizeStartSessionRequest&&n.buildStartSessionRequestParams)&&n.parallelizeStartSessionRequest(i),c=!1,u=!1,d=!1,l=!1,f=void 0,h=void 0,p=!1,m=!1;if(ve()===he.IE||n&&n.fallBackToSingleStepBootFlow&&n.fallBackToSingleStepBootFlow(i,t))!function(){i.logger.ULS.Ye(578074079,U.B,P.Info,"Waiting for WOPI info to start boot");var e=function(e,r){if(c)i.logger.ULS.Ye(578074080,U.B,P.Warning,"completeCreateNew already called");else{if(c=!0,s.wopiPendingCompleteTime=B(),"failure"===r.state)return O(r.reason),i.state=A.Failed,void n({completion:"failure"});rt(r.newFile),i.run(Q.boot,de(de({},t),{wopi:r.wopi}),o).then((function(e){n(e)}))}};i.addActionHandler(Q.completeCreateNew,e);var n=function(t){i.removeActionHandler(Q.completeCreateNew,e),r(t)};o&&o.subscribe((function(){n({completion:"cancelled"})}))}();else{var v=function(e,t){c?i.logger.ULS.Ye(587236372,U.B,P.Warning,"completeCreateNew already called"):(c=!0,s.wopiPendingCompleteTime=B(),"failure"!==t.state?qe(f=t.wopi)?(i.wopi=f,i.logger.ULS.Ye(587286030,U.B,P.Info,"WOPI info received. Access token: "+JSON.stringify({length:f.accessToken.length,expiry:f.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:a,wacFrameLoaded:u,wacCanAcceptStartSessionResponse:d})),!a||u&&!d?u&&C():g(),u&&i.container&&i.container.postMessage(ee.ro,void 0),rt(t.newFile)):w("InvalidWopiInfo"):w(t.reason))},w=function(e){O(e),u&&i.container&&i.container.postMessage(ee.no,void 0)},g=function(){i.logger.ULS.Ye(587233056,U.B,P.Info,"Making parallelized StartSession request");var t=n.buildStartSessionRequestParams(i,e,f),o=Ze(i,t.appPageName,t.queryParamsOverrides),r={"Content-Type":"application/x-www-form-urlencoded"},a="access_token="+encodeURIComponent(f.accessToken)+"&access_token_ttl="+encodeURIComponent(f.expiry.toString());s.startSessionStartTime=B(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(o,a,r,S)},S=function(e){var t=B();s.startSessionCompleteTime=t,i.logger.ULS.Ye(587233057,U.B,P.Info,"StartSession request completed. Status code: ".concat(e.status,", time: ").concat(t)),h={RequestStatus:e.status,ResponseText:e.responseText},u&&d?b():i.logger.ULS.Ye(587233058,U.B,P.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:u,wacCanAcceptStartSessionResponse:d,wopiInfoSent:p,startSessionResponseSent:m}))},I=function(e,t){s.readyMessageReceiveTime=B(),i.container&&i.container.postMessage(ee.yn,void 0),u||(u=!0,d=t.CanAcceptStartSessionComplete,i.logger.ULS.Ye(587321567,U.B,P.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:a,wacCanAcceptStartSessionResponse:d,startSessionResponseAvailable:!!h,wopiInfoAvailable:!!f})),c&&i.container&&i.container.postMessage(f?ee.ro:ee.no,void 0),a&&d?b():C(),Te(i.appInitDiagnostics,t.Diagnostics))},b=function(){m||p||!h||(200===h.RequestStatus?(m=!0,s.completeMessageCreateTime=B(),_(ee.En,{StartSessionResponse:h,Diagnostics:s},3)):C())},C=function(){m||p||!f||(p=!0,s.completeMessageCreateTime=B(),n&&n.sendCreateNewWopiInfo?n.sendCreateNewWopiInfo(i):_(ee.On,{WopiDetails:{WopiSrc:f.source,AccessToken:f.accessToken,AccessTokenTtl:f.expiry.toString()},Diagnostics:s},3))},_=function(e,t,n){var o=B();n<=0?i.logger.ULS.Ye(587233165,U.B,P.Error,"Attempted to complete but no ack. Time: ".concat(o)):(i.logger.ULS.Ye(587233166,U.B,P.Info,"Sending complete message. Retries left: ".concat(n-1,", Time: ").concat(o)),s.completeMessageSendTime=o,i.container&&i.container.postMessage(e,t),window.setTimeout(y,1e3,e,t,n-1))},y=function(e,t,n){l||(i.logger.ULS.Ye(587233167,U.B,P.Info,"Timeout session complete ack. Retries left: ".concat(n)),_(e,t,n))},T=function(e,t){l=!0},E=function(e){i.removeActionHandler(Q.completeCreateNew,v),i.removeActionHandler(Y.Dt,I),i.removeActionHandler(Y.Ai,T),r(e)};i.addActionHandler(Q.completeCreateNew,v),i.addActionHandler(Y.Dt,I),i.addActionHandler(Y.Ai,T),o&&o.subscribe((function(){E({completion:"cancelled"})})),i.skipWopiValidation=!0,i.wopi=void 0,i.run(Q.boot,t,o).then((function(e){i.skipWopiValidation=!1,i.wopi=f,E(e)}))}function O(e){i.logger.ULS.Ye(596444188,U.B,P.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}}))};function rt(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}var st=function(){function e(e){var t=this;this.rs=!1,this.ss="",this.as=[],this.cs=function(e){t.rs||(t.rs=!0,t.ss=e?"timeout":"cancelled",t.as.map((function(e){return e()})),t.as=[])},this.us=e,window.setTimeout((function(){return t.cs(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.rs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.us},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.ss},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.cs(!1)},e.prototype.subscribe=function(e){this.rs?e():this.as.push(e)},e}();function at(e){return new st(e)}var ct=function(e,t,i,n,o){return e!==Q.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.Ye(595714433,U.B,P.Info,"start disposing the application");var r=i.host.requireExplicitUnload,s={disposeStartTime:B(),forceAppUnload:r};i.state=A.Disposing;var a=function(){i.state=A.Disposed,e({completion:"success"})},c=function(e){n&&n.disposeAppSpecificResources&&n.disposeAppSpecificResources(i,t),i.dispose(),s.disposeEndTime=B(),function(e,t,i){if(i){var n=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-t.appUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.Ye(592524822,U.B,P.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,s,e),i.container?i.container.dispose(i.pendingReboot,r).then(a):a()};if(r){s.appUnloadStartTime=B();i.addActionHandler(Y.Ni,(function(e,t){s.appUnloadEndTime=B(),c(t)})),(o||new st(5e3)).subscribe((function(){i.state===A.Disposing&&(s.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(ee.ao,void 0)}else c()}))};var ut=function(e,t,i,n,o){return e!==Y.ii?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(te.FrameTrust,t);else{var n=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.Ye(592445957,U.B,P.Info,"Top frame is trusted: ".concat(n)),i.container&&i.container.postMessage(ee.ii,{isTopFrameTrusted:n})}e({completion:"success"})}))},dt=function(e,t,i,n,o){return e!==Y.oi?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(te.GetAuthToken,t):(i.container.postMessage(ee.qn,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(ee.qn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},lt=function(e,t,i,n,o){return e!==Y.Mt?Promise.reject("Wrong flow"):new Promise((function(e){var o=t&&t.state?t.state:"Unknown";i.logger.ULS.Ye(592839750,U.B,P.Info,"Boot state: [".concat(o,"]")),n&&n.beforeComplete&&n.beforeComplete(o),e({completion:"success"})}))},ft=function(e,t,i,n,o){return e!==Q.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(Y.Qt,n),i.removeActionHandler(Y.Yt,r),e(t)};i.addActionHandler(Y.Qt,n),i.addActionHandler(Y.Yt,r),(o||new st(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(ee.zn,t)}))};var ht,pt=function(e,t,i,n,o){return e!==Y.Ui?Promise.reject("Wrong flow"):new Promise((function(e){!function(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)t.virtualKeyboard.overlaysContent=e}(t.overlayContent),i.container&&i.container.postMessage(ee.oo,void 0),e({completion:"success"})}))};!function(e){e[e.NotCreateNew=0]="NotCreateNew",e[e.UnifiedCreateNew=1]="UnifiedCreateNew",e[e.LegacyCreateNew=2]="LegacyCreateNew"}(ht||(ht={}));var mt,vt="powerpoint.officeapps.live.com",wt="https://ffc-"+vt,gt="https://ppc-"+vt,St="https://eurppc-"+vt,It="https://usc-"+vt,bt="https://euc-"+vt,Ct="https://cac-"+vt,_t="https://ukc-"+vt,yt="https://auc-"+vt,Tt="https://jpc-"+vt,At="https://inc-"+vt,Ut="https://krc-"+vt,Pt="https://frc-"+vt,Et="https://sgc-"+vt,Ot="https://zac-"+vt,Ft="https://aec-"+vt,Nt="https://gbc-"+vt,Rt="https://dec-"+vt,kt="https://chc-"+vt,xt="https://noc-"+vt,Dt="https://brc-"+vt,Wt="https://sec-"+vt,Mt="https://qtc-"+vt,Bt="https://plc-"+vt,Ht="https://"+vt,Lt="https://cnc-powerpoint.partner.officewebapps.cn",Vt="https://powerpoint.gov.online.office365.us",Jt="https://powerpoint.dod.online.office365.us",jt="https://powerpoint.wac.online.office.eaglex.ic.gov",zt="https://powerpoint.wac.online.office.microsoft.scloud",Gt="https://c4-powerpoint-15.cdn.office.net/pods/s/",qt="https://c1-powerpoint-15.cdn.office.net/pods/s/",Kt=((mt={})[wt]=Zt(wt,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),mt[gt]=Zt(gt,Gt),mt[St]=Zt(St,Gt),mt[Ht]=Zt(Ht),mt[It]=Zt(It),mt[bt]=Zt(bt),mt[Ct]=Zt(Ct),mt[_t]=Zt(_t),mt[yt]=Zt(yt),mt[Tt]=Zt(Tt),mt[At]=Zt(At),mt[Ut]=Zt(Ut),mt[Pt]=Zt(Pt),mt[Et]=Zt(Et),mt[Ot]=Zt(Ot),mt[Ft]=Zt(Ft),mt[Rt]=Zt(Rt),mt[kt]=Zt(kt),mt[xt]=Zt(xt),mt[Dt]=Zt(Dt),mt[Wt]=Zt(Wt),mt[Mt]=Zt(Mt),mt[Bt]=Zt(Bt),mt["https://powerpoint.online.office.de"]=Zt("https://powerpoint.online.office.de","https://powerpoint.cdn.office.de/pods/s/"),mt[Lt]=Zt(Lt,"https://cdn.partner.officewebapps.cn/pods/s/"),mt[Vt]=Zt(Vt,"https://powerpoint.cdn.office365.us/pods/s/"),mt[Nt]=Zt(Nt,"https://powerpoint.cdn.office365.us/pods/s/"),mt[Jt]=Zt(Jt,"https://powerpoint.dod.cdn.office365.us/pods/s/"),mt[jt]=Zt(jt,"https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/"),mt[zt]=Zt(zt,"https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/"),mt);function Zt(e,t){return void 0===t&&(t=qt),{PodsUrl:e+"/pods/",WacCdnStaticServer:t}}function $t(e){var t=e.substring(0,e.indexOf("/p/"));return Kt[t.toLowerCase()]}var Xt=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"];function Qt(e,t,i){if(!t)return e;var n=e,o=null==i,r=n.indexOf("?");if(-1===r)return o?e:n+"?"+t+"="+i;for(var s=n.substr(r+1),a=s.split("&"),c=t+"=",u=!1,d=0;d<a.length;d+=1)if(0===a[d].indexOf(c)){n=n.replace(a[d],o?"":c+i),u=!0;break}return u||o||(s.length>0&&(n+="&"),n+=c+i),n}function Yt(e,t){return!e||"wd"!==e.substring(0,2)||Xt.indexOf(e)>=0?"":e+"="+t}function ei(e){for(var t=e,i="",n=0,o=window.location.search.substring(1).split("&");n<o.length;n++){"wdoverrides"===(u=o[n].split("="))[0]&&(i=u[1]);var r=Yt(u[0],u[1]);r&&(t+="&"+r)}for(var s=[],a=0,c=(i=i||"").split(/,|%2C/);a<c.length;a++){var u;2===(u=c[a].split(/:|%3A/)).length&&"devicepixelratio"!==u[0].toLowerCase()&&s.push(u[0]+":"+u[1])}return s.push("devicepixelratio:"+_e()),s.push("RenderGifSlideShow:true"),t=Qt(t,"wdoverrides",s.join(","))}function ti(e){var t=S("wdPodsUrl");return t&&!C(t)&&(t=""),t||(t=e),"/"!==t.substr(t.length-1)&&(t+="/"),t}function ii(e,t){var i=e.bootParams,n=e.file;if(!i.isNewFile){if(!n.getUrl)throw Error("Missing FileGetUrl");if(!n.name)throw Error("Missing FileName")}var o=e.preseededSession;o&&o.key&&("_._._."===o.key.slice(0,6)&&"-.-.-."===o.key.slice(-6)||(o.key="_._._."+o.key+"-.-.-."));var r=e.appContext;r.wopiInfoSent=!1,r.bootComplete=!1,r.bootFlowResolve=t,r.bootRecorded=!1;var s=Kt[e.appBaseUrl];e.appBasePath=s?s.PodsUrl:e.appBaseUrl+"/pods/";var a=e.wdParams,c=a.wdpodsurl;c&&!C(c)&&(c=""),c||(c=e.appBasePath);var u=/\/$/;if(u.test(c)||(c+="/"),!c)throw Error("Invalid PODS URL");r.podsUrl=c;var d=a.wdpopsurl;if(d&&!C(d)&&(d=""),d||(d=(d=c).substring(0,d.indexOf("/pods/"))),u.test(d)||(d+="/"),!d)throw Error("Invalid POPS URL");if(r.popsUrl=d,e.bootstrapperUrl){r.cdnBasePath=e.bootstrapperUrl.split("/pods/s/")[0]+"/pods/s/"}else r.cdnBasePath=s?s.WacCdnStaticServer:qt;r.createNewScenario=function(e,t,i,n){var o=ht.NotCreateNew,r="NotCreateNew";t.isNewFile?i.size?(o=ht.LegacyCreateNew,r="CreateNewWithNonZeroByteFile"):(o=ht.UnifiedCreateNew,r="IsNewFile"):t.isFromHostTemplate?(o=ht.UnifiedCreateNew,r="CreateNewFromHostTemplate"):n&&n.getUrl&&(o=ht.UnifiedCreateNew,r="CreateNewFromTemplateSourceUrl");var s={CreateNewScenario:ht[o],reason:r};return e.ULS.Ye(34932951,U.B,P.Info,JSON.stringify(s)),o}(e.logger,i,n,e.newFileTemplate),r.shouldUsePods=function(e,t,i,n,o,r,s){var a=!1,c=!1,u="";t?(a="false"!==t,c=!0,u="wdPodsEnabled is available"):i?e===ht.LegacyCreateNew?(a=!1,c=!1,u="Legacy Create New Scenario because non-zero file size"):n?(a=!1,c=!1,u="Embed View fallback to WAC"):(a=!0,c=!0,u="Supported Region"):(a=!1,c=!1,u="Wac region not currently supported by PODS",s.ULS.Ye(589168768,U.B,P.Warning,u+": "+r));o||e!==ht.NotCreateNew||(a=!1,c=!1,u+=" | FileGetUrl is empty");var d={ShouldUsePodsOrCached:a,ShouldUsePods:a,CanUsePods:c,ApplicationUrl:r,Reason:u,CreateNewScenario:ht[e]};return s.ULS.Ye(561640788,U.B,P.Info,JSON.stringify(d)),a}(r.createNewScenario,a.wdpodsenabled,!!s,w(e.appUrl,"embed"),!!n.getUrl,_(e.appBaseUrl),e.logger);var l=e.hostInitDiagnostics;l&&l.userClickTime&&Fe(l.userClickTime,e.logger),function(e){var t=e.hostInitDiagnostics,i=e.bootParams,n=e.file,o=!!n.getUrl,r=!!e.customFontCatalogUrl,s=e.contentBundle,a={BootstrapperType:"TypeScript",JsApiVersion:"v2",Preview:!1,Scenario:"Unified App",ApplicationUrl:_(e.appBaseUrl),IsDeepLink:!!S("nav"),BootstrapperInstanceId:ae(),IsMobileView:Ce(),ApplicationCustomSettings:{OnDemandServer:_(e.appBasePath),EnableWacFallback:!0},SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:i.dataLanguage,DocumentClickTime:t.userClickTime,CurrentTime:B(),UiHost:e.host.uiHostName,WdParams:e.wdParams},Diagnostics:{EntryPoint:t.entryPoint,FileHost:e.host.storageHostName,PodsRing:"",UnifiedUiHostDiagnostics:t.unifiedUiHostDiagnostics},WopiPrecheckInfo:{FileSize:n.size,FileGetUrlBool:o,CustomFontCatalogBool:r,FileGetUrlLength:o?n.getUrl.length:null,FileNameBool:!!n.name,ReadOnly:i.readOnly,IrmEnabled:i.irmEnabled,SupportsDecryptedContentDownload:i.supportsDecryptedContentDownload,ViewOnly:i.viewOnly,PreseededSessionKey:!!e.preseededSession&&!!e.preseededSession.key,FileExtension:G(n.name)||null,BundleInfo:s?{MajorVersion:s.majorVersion,URLBool:!!s.url}:{}},AppInfo:{AppVersionMajor:1,AppVersionMinor:20230804009,Environment:"wac",UserAgent:window.navigator.userAgent},AdditionalTelemetry:{PostMessageToken:e.sessionId}};e.logger.ULS.Ye(22357763,U.B,P.Info,JSON.stringify(a,q))}(e)}function ni(e){return e.appBasePath}function oi(e){return t=e.appBasePath,i=e.sessionId,t+"RemoteTelemetry.ashx"+(i?"?usid="+i:"");var t,i}function ri(e){return!e.appContext.shouldUsePods}var si="\n  @media screen and (-ms-high-contrast:active)\n  {\n   div#".concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n   {\n  \tbackground-image: none !important;\n   }\n  }\n  \n  div#").concat("highContrastDetectionDiv","\n  {\n   background-color: Window;\n   position: absolute;\n   top: 0px;\n   left: -99999px;\n   width: 1px;\n   height: 1px;\n   opacity: 0;\n   overflow: hidden;\n  }\n  \n  div#").concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n  {\n   background-image: url('data:image/png;base64,").concat("highcontrastdetectordefault","');\n  }\n");function ai(e){var t=e.ownerDocument.createElement("div");t.id="highContrastDetectionDiv",t.ariaHidden="true";var i=e.ownerDocument.createElement("a");i.id="highContrastDetectionAnchor",i.setAttribute("href","#"),i.ariaHidden="true",t.appendChild(i),e.appendChild(t);var n=e.ownerDocument.createElement("style");n.innerHTML=si,e.ownerDocument.head.appendChild(n);var o=function(){e.ownerDocument.head.removeChild(n),e.removeChild(t)},r=di(t),s=di(i);if(r&&s){if(-1===s.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")){var a=function(e,t,i){var n=ci(e),o=ci(t),r=ci(i);if(!n||!o||!r)return;return{foregroundTextColor:n,backgroundColor:o,linkColor:r}}(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),s.color.toLowerCase());return o(),{isInHighContrastMode:!0,highContrastColors:a}}return o(),{isInHighContrastMode:!1}}o()}function ci(e){return new RegExp("#[0-9A-Fa-f]{6}").test(e)?e:"transparent"===e||"window"===e?"transparent":function(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(t&&4===t.length){var i=t[1],n=t[2],o=t[3];return function(e,t,i){return"#"+ui(Number(e),2)+ui(Number(t),2)+ui(Number(i),2)}(i,n,o)}return}(e)}function ui(e,t){for(var i=e.toString(16);i.length<t;)i="0"+i;return i.toLowerCase()}function di(e){if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)return e.ownerDocument.defaultView.getComputedStyle(e)}var li;function fi(){var e,t,i,n=(e={width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight-50},t={width:e.width,height:e.height},(i=t.width<320)&&(t.height-=17),t.height<256&&(t.width-=17),!i&&t.width<320&&(i=!0,t.height-=17),t.width=Math.max(t.width,320),t.height=Math.max(t.height,256),t);return(""+document.cookie).indexOf("WACRibbonMinimizedPPT=true")>=0&&(n.height-=we()?108:94),n.height-=30,n.height-=23,n}function hi(e){var t,i,n={height:e.height-32-1,width:e.width-238-1-17};return(i={width:(t=n).width-20,height:t.height-20}).width<424?i.width=424:i.width>1696&&(i.width=1696),i.height<238.5?i.height=238.5:i.height>954&&(i.height=954),i}function pi(e){if(!e.ApplicationUrl)return null;var t=g(e.ApplicationUrl,"wdOrigin");return t||(e.Diagnostics&&e.Diagnostics.entryPoint?e.Diagnostics.entryPoint:null)}function mi(e,t,i){if(e)for(var n=0;n<e.length;n+=1){var o=e[n];if(o.name.indexOf(t)>=0)return o.name.toLowerCase()!==t.toLowerCase()&&i.ULS.Ye(38147726,U.B,P.Info,"Found partial match for bootstrapper URL perf entry"),o}}function vi(e,t){if(t)try{if(!e)return void t.ULS.Ye(557454687,U.B,P.Info,"Missing BootstrapperUrl");if(!window.performance)return void t.ULS.Ye(557454688,U.B,P.Info,"Performance API not found on browser");var i=void 0;if(window.performance.getEntriesByName&&(i=mi(window.performance.getEntriesByName(e),e,t)),!i&&window.performance.getEntries&&(t.ULS.Ye(557454689,U.B,P.Info,"Searching all entries for bootstrapper timing entry"),i=mi(window.performance.getEntries(),e,t)),!i)return void t.ULS.Ye(557454690,U.B,P.Info,"Unable to extract Bootstrapper perf info");var n={name:e,logReason:"UnifiedTSBoot",nameMatchesExpected:i.name===e,connectEnd:i.connectEnd,connectStart:i.connectStart,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,fetchStart:i.fetchStart,initiatorType:i.initiatorType,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,duration:i.duration,entryType:i.entryType,startTime:i.startTime,nextHopProtocol:i.nextHopProtocol,workerStart:i.workerStart,secureConnectionStart:i.secureConnectionStart,transferSize:i.transferSize,encodedBodySize:i.encodedBodySize,decodedBodySize:i.decodedBodySize};t.ULS.Ye(34928845,U.B,P.Info,JSON.stringify(n))}catch(e){t.ULS.Ye(557454691,U.ne,P.Warning,"Exception extracting Bootstrapper perf info: ".concat(K(e)))}}function wi(e){return!e||e.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):e}function gi(e,t){var i=e,n=function(e){if(e.SessionInformation.UiLocale)return e.SessionInformation.UiLocale;return g(e.ApplicationUrl,"ui")}(t);n&&(i=Qt(i,"ui",n));var o=function(e){if(e.SessionInformation.DataLocale)return e.SessionInformation.DataLocale;return g(e.ApplicationUrl,"rs")}(t);o&&(i=Qt(i,"rs",o));var r=f(t.ApplicationUrl,"mscc");r&&(i=Qt(i,"mscc",r));var s=f(t.ApplicationUrl,"wdFR");s&&(i=Qt(i,"wdFR",s));var a=pi(t);a&&(i=Qt(i,"wdOrigin",I(a)));var c=wi(t.PostMessageToken);return t.PostMessageToken&&(i+="&postMessageToken="+c),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=Qt(i,"dchat","1")),i=function(e,t){var i=t.indexOf("?");if(-1===i)return e;for(var n=e,o=0,r=t.substring(i+1).split("&");o<r.length;o++){var s=r[o].split("=");if(""===f(e,s[0])){var a=Yt(s[0],s[1]);a&&(n+="&"+a)}}return n}(i,t.ApplicationUrl)}function Si(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return e;default:return""}}function Ii(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return e}}function bi(e,t,i){if(e){var n="Page lifecycle: "+t+" fired.";i&&(n+="Flushing ULS logger",e.ULS.flushOnClose()),e.ULS.Ye(579384268,U.B,P.Warning,n)}}function Ci(e){return e.toLocaleLowerCase().indexOf("pod")>=0||e.toLocaleLowerCase().indexOf("pop")>=0}function _i(e){var t="";for(var i in e)Ci(i)||(t+="&"+i+"="+e[i]);return t}function yi(e){var t=e.wdParams,i=Ce(),n="true"===t.wdembedview||w(e.appUrl,"embed"),o=e.appContext,r=i?"pptmobileapp.aspx":n?"pptembed.aspx":"ppt.aspx",s={},a={};Xt.forEach((function(e){l(s,e)}));var c=["devicepixelratio:"+_e(),"RenderGifSlideShow:true"],u=t.wdoverrides;u&&u.split(/,|%2C/).forEach((function(e){var t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&c.push(t[0]+":"+t[1])})),d(s,"wdoverrides",c.join(",")),n&&(l(s,"corrid"),l(s,"usid")),we()&&d(a,"touchdevice","1");var h=window.document.documentElement;h&&(void 0!==h.clientWidth&&d(a,"windowwidth",h.clientWidth.toString()),void 0!==h.clientHeight&&d(a,"windowheight",h.clientHeight.toString()));var p=S("previoussessionid");p&&d(a,"previoussessionid",p),Ee()&&d(a,"lssupported","1");var m=e.host.capabilities;m&&(m.rebootDoc&&(d(a,"sdr",m.rebootDoc.toString()),l(s,"sdr")),m.createNewDoc&&(d(a,"scnd","1"),l(s,"scnd")),m.authToken&&(d(a,"sat","1"),l(s,"sat")),m.customAuthConfig&&(d(a,"cac","1"),l(s,"cac")),m.refreshAccessToken&&(d(a,"rat","1"),l(s,"rat")),m.atMentions&&(d(a,"sams","1"),l(s,"sams")),m.moveToFolder&&(d(a,"mtf","1"),l(s,"mtf")),m.noBrowserModalDialogs&&(d(a,"nbmd","1"),l(s,"nbmd")),m.commonFilePicker&&(d(a,"sfp","1"),l(s,"sfp")),m.directDownload&&(d(a,"sdd","1"),l(s,"sdd")),m.directPrint&&(d(a,"sdp","1"),l(s,"sdp")));var v=e.ui;(v.hideHeader||"DocGen"===v.contentAssemblyMode||"Templatization"===v.contentAssemblyMode||"ContentAssemblyEdit"===v.contentAssemblyMode||"ContentAssemblyView"===v.contentAssemblyMode)&&(d(a,"hhdr","1"),l(s,"hhdr")),v.hideFileLocationPicker&&(d(a,"hodflp","1"),l(s,"hodflp")),v.hideAppLauncherInHeader&&(d(a,"halh","1"),l(s,"halh")),v.hideChatInHeader&&(d(a,"hch","1"),l(s,"hch")),v.hideMeInHeader&&(d(a,"hmh","1"),l(s,"hmh")),v.hideSearchInHeader&&(d(a,"hsh","1"),l(s,"hsh")),v.hideWorkflowInHeader&&(d(a,"hwfh","1"),l(s,"hwfh")),v.hideSettingsInHeader&&(d(a,"hsth","1"),l(s,"hsth")),v.showAppIconInHeader&&(d(a,"sih","1"),l(s,"sih")),v.useNeutralColorInHeader&&(d(a,"unh","1"),l(s,"unh")),e.hostName&&d(a,"filesrc",e.hostName),e.user.id&&d(a,"userid",e.user.id),v.openLinksInNewWindow&&(d(a,"onw","1"),l(s,"onw")),v.useDarkTheme&&(d(a,"udt","1"),l(s,"udt"));var g=e.viewMode;g&&g.hideToolbar&&d(a,"hvt","1");var C=e.file;C.name&&(d(s,"filename",I(C.name)),l(a,"filename")),C.getUrl&&(d(a,"fileurl",C.getUrl),l(a,"filegeturl")),d(s,"filegeturlbool",C.getUrl?"true":"false"),C.size&&(d(s,"fs",C.size.toString()),l(a,"filesize"));var _=e.newFileTemplate;_&&_.size&&(d(s,"fs",_.size.toString()),l(a,"filesize"));var y=e.contentBundle;y&&y.url&&(d(a,"bundleurl",y.url),l(a,"bundlesrc"));var T=e.bootParams;T.irmEnabled&&d(a,"irmenabled",T.irmEnabled.toString()),T.supportsDecryptedContentDownload&&d(a,"supportsdecryptedcontentdownload",T.supportsDecryptedContentDownload.toString()),T.readOnly&&l(s,"readonly"),d(s,"ro",T.readOnly?T.readOnly.toString():"false"),T.viewOnly&&d(a,"viewonly",T.viewOnly.toString()),T.openViewByDefault&&d(a,"ovbd",T.openViewByDefault.toString());var A=e.preseededSession;A&&(A.key&&(n||d(a,"preseededsessionkey",A.key),l(s,"preseededsessionkey")),A.id&&l(s,"preseededwacsessionid"));var E=e.throttling;E&&(E.protection&&(d(a,"ctp",E.protection),l(s,"ctp")),E.request&&(d(a,"rct",E.request),l(s,"rct")));var O=S("nav");if(O||(O=e.actNavId?e.actNavId:f(e.appUrl,"actnavid")),O){try{var F=b(O),N=JSON.parse(F),R=N.sId;R&&(d(s,"wdslideid",R),d(s,"dc","1"));var k=N.commentId;k&&"null"!==k&&d(s,"wdcommentid",k);var x=N.openMode;x&&"null"!==x&&d(s,"wdopenmode",x)}catch(t){e.logger.ULS.Ye(560329684,U.B,P.Error,"Failed to parse navigation id: ".concat(O))}l(s,"actnavid")}if(o.shouldUsePods){e.appBasePath=o.podsUrl,l(s,"powerpointview"),d(s,"wdpodsurl",I(o.podsUrl)),d(s,"wdpopsurl",I(o.popsUrl)),d(s,"fastboot","true"),d(s,"noauth","1");var D=fi(),W=hi(D);d(s,"thpanel",D.height.toString()),d(s,"sw",W.width.toString()),d(s,"sh",W.height.toString());var M=t.wdfs;M&&d(s,"fslide",M);var B=t.wdfsection;B&&d(s,"fsection",B),(M||B||t.wdincludehosturl&&"false"!==t.wdincludehosturl)&&d(s,"frameurl",I(window.location.href));var H=S("automation");H&&d(s,"automation",H);var L=S("startrehearsal");if(L&&d(s,"startrehearsal",L),d(s,"postmessagetoken",e.sessionId),d(a,"postmessagetoken",e.sessionId),e.wdParams){var V=_i(e.wdParams);V&&d(a,"wdparams",V)}if(d(a,"jsapiversionminor",20230804009..toString()),(j=e.wopi)&&j.source&&(d(a,"wopisrc",j.source),l(s,"wopisrc")),e.container){var J=ai(e.container.element);J&&J.isInHighContrastMode&&(d(a,"isinhighcontrastmode","true"),J.highContrastColors&&d(a,"clientcolorsettings",J.highContrastColors.foregroundTextColor+"_"+J.highContrastColors.backgroundColor+"_"+J.highContrastColors.linkColor))}}else{e.appBasePath||d(s,"nolog","True");var j,z=e.appUrl.substring(0,e.appUrl.indexOf("?")),G=z.lastIndexOf("/")+1;if(e.appBasePath=z.substring(0,G),r=z.substring(G),(j=e.wopi)&&j.source){var q=j.source;q.toLowerCase().indexOf("powerpointframe.aspx")>=0&&(q=decodeURIComponent(f(q,"wopisrc"))),d(s,"wopisrc",I(q))}d(s,"wdenableroaming","1"),d(s,"wdo","1")}return{appPageName:r,queryParamsOverrides:s,postDataOverrides:a}}function Ti(e){if(e.appContext.shouldUsePods){var t=function(i,n){Ai(e),e.removeActionHandler(Y.Dt,t)};e.addActionHandler(Y.Dt,t);e.addActionHandler(Y.Ri,(function(t,i){t===Y.Ri&&function(e,t){var i=t;if(!i||"number"!=typeof i.Tag||"number"!=typeof i.Category||"number"!=typeof i.Level||"string"!=typeof i.Message)return;try{e.logger.ULS.Ye(i.Tag,i.Category,i.Level,i.Message)}catch(t){e.logger.ULS.Ye(512235072,U.B,P.Error,"ulsLog exception: "+t)}}(e,i)}))}vi(e.bootstrapperUrl,e.logger),window.setTimeout((function(){e.logger.ULS.flush()}),1e4)}function Ai(e){var t,i=e.appContext;if(!i.wopiInfoSent&&e.wopi){i.wopiInfoSent=!0;var n="";e.wdParams&&(n=Object.keys(e.wdParams).filter((function(e){return!/po[d/p]/i.test(e)})).reduce((function(t,i){return"".concat(t,"&").concat(i,"=").concat(e.wdParams[i])}),""));var o=e.bootParams,r=e.wopi,s=e.hostInitDiagnostics,a={WopiSrc:r.source,AccessToken:r.accessToken,AccessTokenTTL:r.expiry,ReadOnly:o.readOnly,IrmEnabled:o.irmEnabled,SupportsDecryptedContentDownload:o.supportsDecryptedContentDownload,FileName:e.file.name,SessionContext:e.sessionContext,WdParams:n,DocumentURL:window.location.href,PreviousSessionID:S("PreviousSessionID"),FirstPageFlushTime:window.WOPIPerf_FirstPageFlush,BootJsStartTime:window.WOPIPerf_BootJsStartTime,BootJsEndTime:window.WOPIPerf_BootJsEndTime,InitializeWacTime:window.WOPIPerf_InitializeWac,UserClickTime:null!==(t=window.WOPIPerf_UserClick)&&void 0!==t?t:s.userClickTime,UnifiedUiHostDiagnostics:s.unifiedUiHostDiagnostics,ClientDiagnostics:e.clientDiagnostics};if(window.performance){var c=window.performance.timing;c&&(a.NavigationStart=c.navigationStart,a.FetchStart=c.fetchStart,a.RequestStart=c.requestStart,a.ResponseStart=c.responseStart,a.ResponseEnd=c.responseEnd);var u=window.performance.navigation;u&&(a.NavigationType=u.type,a.NavigationRedirects=u.redirectCount)}e.container.postMessage(ee.On,a)}}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(li||(li={}));var Ui="WebApplicationFrame";function Pi(e,t){var i=document.createElement("input");return i.type="hidden",i.name=e,i.value=t,i}var Ei,Oi=function(){function e(e){this.ds=e}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return N()},e.prototype.GetSessionId=function(){return this.ds},e.prototype.RegisterEventHandler=function(){},e.prototype.RemoveEventHandler=function(){},e.prototype.RegisterErrorHandler=function(){},e.prototype.RemoveErrorHandler=function(){},e.prototype.PostCommand=function(){},e.prototype.Dispose=function(){},e}();function Fi(e,t){if(!e.IsFileNew){if(!e.WopiPrecheckInfo.FileGetUrl)throw Error("Missing FileGetUrl from contentParams");if(!e.WopiPrecheckInfo.FileName)throw Error("Null or Empty Filename")}var i=ti(e.OnDemandServer);if(!i)throw Error("Invalid Pods URL");var n,o,r=(n=e.OnDemandServer,(o=S("wdPopsUrl"))&&!C(o)&&(o=""),o||(o=(o=ti(n)).substr(0,o.indexOf("/pods/"))),"/"!==o.substr(o.length-1)&&(o+="/"),o);if(!r)throw Error("Invalid Pops URL");var s=fi(),a=hi(s),c="true"===S("wdEmbedView")||w(e.ApplicationUrl,"embed"),u=c?"pptembed.aspx":"ppt.aspx",d=Ce();t.ULS.Ye(51380293,U.B,P.Info,"IsRequestForMobileView:".concat(d));var l=i+(u=d?"pptmobileapp.aspx":u)+"?wdPodsUrl="+I(i)+"&wdPopsUrl="+I(r)+"&fastBoot=true&sw="+a.width+"&sh="+a.height+"&thPanel="+s.height+"&ro="+e.WopiPrecheckInfo.ReadOnly+"&sftc=1&NoAuth=1&jsApi=1&jsapiver=v1";e.WopiPrecheckInfo.FileName&&(l+="&fileName="+I(e.WopiPrecheckInfo.FileName)),"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||(l+="&readonly=1");var h=S("wdfs");h&&(l+="&fslide="+h);var p=S("wdfsection");p&&(l+="&fsection="+p);var m=S("wdIncludeHostUrl");(h||p||m&&"false"!==m)&&(l=Qt(l,"frameURL",I(window.location.href))),l=gi(l=ei(l),e),e.IsFileNew&&(l+="&new=1"),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileSize?l+="&fs="+e.NewFileTemplateSource.FileSize:e.WopiPrecheckInfo.FileSize&&(l+="&fs="+e.WopiPrecheckInfo.FileSize);var v,_=!(v=e.SessionInformation.HostSessionId)||v.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):v;e.SessionInformation.HostSessionId&&(l+="&hid="+_);var y=S("Automation");y&&(l+="&Automation="+y);var T=S("StartRehearsal");T&&(l+="&StartRehearsal="+T),c||(l+="&usid="+e.SessionId),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&(l+="&uiEmbed=1"),e.SessionInformation.SupportsAccessibilityLoop&&(l+="&accloop=1"),e.SessionInformation.IsSynthetic&&(l+="syn=1");var A=g(e.ApplicationUrl,"uih");A&&(l+="&uih="+A),e.SessionInformation.UiHostIntegrationType&&(l+="&uihit="+I(e.SessionInformation.UiHostIntegrationType)),e.SessionInformation.MetaUiHostVersion&&(l+="&muv="+I(e.SessionInformation.MetaUiHostVersion)),e.SessionInformation.HighContrastMode&&(l+="&hcm="+I(e.SessionInformation.HighContrastMode));var E=S("nav");if(E||(E=f(e.ApplicationUrl,"actNavId")),E)try{var O=b(E),F=JSON.parse(O),R=F.sId;R&&(l=Qt(l,"wdSlideId",R),l=Qt(l,"DC","1"));var k=F.commentId;k&&"null"!==k&&(l=Qt(l,"wdCommentId",k));var x=F.openMode;x&&"null"!==x&&(l=Qt(l,"wdOpenMode",x))}catch(e){t.ULS.Ye(38580688,U.B,P.Error,"Failed to parse navigation ID: ".concat(E))}var D=e.Container;if(D){var W=document.createElement("iframe");W.id=Ui,W.name="wac_frame",W.title="Office Online Frame",W.frameBorder="0",W.style.top="0",W.style.bottom="0",W.style.left="0",W.style.right="0",W.style.height="100%",W.style.width="100%",W.style.minHeight="200px",W.style.minWidth="300px",W.style.position="absolute",W.setAttribute("allowfullscreen","true"),W.setAttribute("allowTransparency","true");var M="";if(ve()===he.Safari)M+="autoplay;",M+="microphone;",M+="camera;",M+="clipboard-read;",M+="clipboard-write;",M+="display-capture;";else{var B=i+" "+function(e,t){if(t){return t.split("/pods/s/")[0]+"/pods/s/"}if(e){var i=$t(e);if(i)return i.WacCdnStaticServer;throw Error("Application url provided but region not in region allow list")}return qt}(e.ApplicationUrl,e.BootstrapperUrl)+";";M+="autoplay "+B,M+="microphone "+B,M+="camera "+B,M+="clipboard-read "+B,M+="clipboard-write "+B,M+="display-capture "+B}W.setAttribute("allow",M),D.style.top="0",D.style.bottom="0",D.style.left="0",D.style.right="0",D.style.height="100%",D.style.width="100%",D.style.minHeight="200px",D.style.minWidth="300px",D.appendChild(W);var H=Date.now(),L=e.WopiPrecheckInfo.FileGetUrl;t.ULS.Ye(38580689,U.B,P.Info,L?L.toString().length.toString():"null"),l+="&fileGetUrlBool="+!!L;var V=document.createElement("form");if(V.name="frameForm",V.id="frameForm",V.target="wac_frame",V.action=l,V.method="post",D.appendChild(V),e.WopiInfo){var J=e.WopiInfo.WopiSrc;J&&V.appendChild(Pi("WOPISrc",J));var j=e.WopiInfo.AccessToken;j&&V.appendChild(Pi("access_token",I(j)));var z=e.WopiInfo.AccessTokenExpiry;z&&V.appendChild(Pi("access_token_ttl",z.getTime().toString()))}var G=e.SessionInformation.SessionContext;if(G&&V.appendChild(Pi("sc",G)),e.SessionInformation.WdParams){var q=_i(e.SessionInformation.WdParams);q&&V.appendChild(Pi("wdparams",q))}V.appendChild(Pi("jsapiversionminor",20230804009..toString())),e.SessionInformation.HideViewerToolbar&&V.appendChild(Pi("hvt","1")),L&&V.appendChild(Pi("fileUrl",L));var K=e.WopiPrecheckInfo.CustomFontCatalogUrl;K&&V.appendChild(Pi("customFontCatalogUrl",K)),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileGetUrl&&V.appendChild(Pi("templateUrl",e.NewFileTemplateSource.FileGetUrl)),e.SessionInformation.UserId&&(V.appendChild(Pi("UserID",e.SessionInformation.UserId)),V.appendChild(Pi("user_id",e.SessionInformation.UserId))),e.WopiPrecheckInfo.IrmEnabled&&V.appendChild(Pi("irmEnabled",e.WopiPrecheckInfo.IrmEnabled.toString())),e.WopiPrecheckInfo.SupportsDecryptedContentDownload&&V.appendChild(Pi("SupportsDecryptedContentDownload",e.WopiPrecheckInfo.SupportsDecryptedContentDownload.toString())),e.WopiPrecheckInfo.ViewOnly&&V.appendChild(Pi("ViewOnly",e.WopiPrecheckInfo.ViewOnly.toString())),e.NewFileTemplateSource&&e.NewFileTemplateSource.ETag?V.appendChild(Pi("ETag",e.NewFileTemplateSource.ETag)):e.WopiPrecheckInfo.ETag&&V.appendChild(Pi("ETag",e.WopiPrecheckInfo.ETag)),e.WopiPrecheckInfo.CTag&&V.appendChild(Pi("RevID",e.WopiPrecheckInfo.CTag)),e.NewFileTemplateSource&&e.NewFileTemplateSource.DocUniqueId?V.appendChild(Pi("DocID",e.NewFileTemplateSource.DocUniqueId)):e.WopiPrecheckInfo.DocUniqueId&&V.appendChild(Pi("DocID",e.WopiPrecheckInfo.DocUniqueId)),e.WopiPrecheckInfo.BundleInfo&&e.WopiPrecheckInfo.BundleInfo.Url&&V.appendChild(Pi("bundleUrl",e.WopiPrecheckInfo.BundleInfo.Url)),e.WopiPrecheckInfo.PreseededSessionKey&&!c&&V.appendChild(Pi("PreseededSessionKey",e.WopiPrecheckInfo.PreseededSessionKey)),e.SessionInformation.HostName&&V.appendChild(Pi("fileSrc",e.SessionInformation.HostName)),e.ApplicationCustomSettings&&e.ApplicationCustomSettings.HostUIControls&&V.appendChild(Pi("huictrls",JSON.stringify(e.ApplicationCustomSettings.HostUIControls))),V.appendChild(Pi("feature_status",$(e.FeatureManager,{wdFlights:S("wdFlights")}))),we()&&V.appendChild(Pi("touchDevice","1")),window.document.documentElement&&(void 0!==window.document.documentElement.clientWidth&&V.appendChild(Pi("windowWidth",window.document.documentElement.clientWidth.toString())),void 0!==window.document.documentElement.clientHeight&&V.appendChild(Pi("windowHeight",window.document.documentElement.clientHeight.toString())));var Z=S("PreviousSessionID");if(Z&&V.appendChild(Pi("PreviousSessionID",Z)),Ee()&&V.appendChild(Pi("LSSupported","1")),V.appendChild(Pi("postMessageToken",e.PostMessageToken)),(e.SessionInformation.HideHeader||"teams"===A&&"UnifiedUiHostTeams"!==e.SessionInformation.UiHostIntegrationType&&"TeamsModern"!==e.SessionInformation.UiHostIntegrationType||"owa"===A||"DocGen"===e.SessionInformation.ContentAssemblyMode||"Templatization"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.SessionInformation.ContentAssemblyMode)&&V.appendChild(Pi("hhdr","1")),e.SessionInformation.HideAppLauncherInHeader&&V.appendChild(Pi("halh","1")),e.SessionInformation.HideSearchInHeader&&V.appendChild(Pi("hsh","1")),e.SessionInformation.HideMeInHeader&&V.appendChild(Pi("hmh","1")),e.SessionInformation.HideChatInHeader&&V.appendChild(Pi("hch","1")),e.SessionInformation.HideWorkflowInHeader&&V.appendChild(Pi("hwfh","1")),e.SessionInformation.HideSettingsInHeader&&V.appendChild(Pi("hsth","1")),e.SessionInformation.ShowAppIconInHeader&&V.appendChild(Pi("sih","1")),e.SessionInformation.UseNeutralColorInHeader&&V.appendChild(Pi("unh","1")),e.SessionInformation.SupportsAuthToken&&V.appendChild(Pi("sat","1")),e.SessionInformation.SupportsCustomAuthConfig&&V.appendChild(Pi("cac","1")),e.SessionInformation.SupportsCreateNewDocument&&V.appendChild(Pi("scnd","1")),e.SessionInformation.UseDarkTheme&&V.appendChild(Pi("udt","1")),e.SessionInformation.SupportsDirectPrint&&V.appendChild(Pi("sdp","1")),e.SessionInformation.SupportsDirectDownload&&V.appendChild(Pi("sdd","1")),"Templatization"!==e.SessionInformation.ContentAssemblyMode&&"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||V.appendChild(Pi("caae","1")),e.SessionInformation.ContentAssemblyMode&&V.appendChild(Pi("caaemode",e.SessionInformation.ContentAssemblyMode)),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&e.SessionInformation.SupportsDocReboot&&V.appendChild(Pi("sdr",!0===e.SessionInformation.SupportsDocReboot?"1":e.SessionInformation.SupportsDocReboot.toString())),e.SessionInformation.HideWACOneDriveFileLocationPicker&&V.appendChild(Pi("hodflp","1")),e.SessionInformation.SupportsAtMentions&&V.appendChild(Pi("sams","1")),e.WopiPrecheckInfo.RequestedCallThrottling){var X=e.WopiPrecheckInfo.RequestedCallThrottling;V.appendChild(Pi("rct",X))}if(e.WopiPrecheckInfo.ClientThrottlingProtection){var Q=e.WopiPrecheckInfo.ClientThrottlingProtection;V.appendChild(Pi("ctp",Q))}e.WopiPrecheckInfo.OpenViewByDefault&&V.appendChild(Pi("ovbd",e.WopiPrecheckInfo.OpenViewByDefault.toString())),e.SessionInformation.SupportsMoveToFolder&&V.appendChild(Pi("mtf","1")),e.SessionInformation.NoBrowserModalDialogs&&V.appendChild(Pi("nbmd","1")),e.SessionInformation.SupportsCommonFilePicker&&V.appendChild(Pi("sfp","1")),e.SessionInformation.OpenLinksInNewWindow&&V.appendChild(Pi("onw","1"));var Y=ai(D);Y&&Y.isInHighContrastMode&&(V.appendChild(Pi("IsInHighContrastMode","true")),Y.highContrastColors&&V.appendChild(Pi("ClientColorSettings",Y.highContrastColors.foregroundTextColor+"_"+Y.highContrastColors.backgroundColor+"_"+Y.highContrastColors.linkColor)));var ee=e.SessionInformation.OwlVersion;ee&&V.appendChild(Pi("owlver",ee));var te=e.SessionInformation.OwlRollout;return te&&V.appendChild(Pi("owlro",te)),V.appendChild(Pi("jsapibuild",N())),V.submit(),{IFrameElement:W,FrameCreateTime:H}}}function Ni(e,t,i,n,o){i.ULS.Ye(38147724,U.B,P.Info,"Launching Wac Fallback");var r=document.createElement("iframe");r.id=Ui,r.name="wac_frame",r.title="Office Online Frame",r.frameBorder="0",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.height="100%",r.style.width="100%",r.style.minHeight="200px",r.style.minWidth="300px",r.style.position="absolute",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),r.style.minHeight="150px";var s=t.Container;s.style.top="0",s.style.bottom="0",s.style.left="0",s.style.right="0",s.style.height="100%",s.style.width="100%",s.style.minHeight="150px";var a=document.createElement("div");a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight="150px",a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden";var c=document.createElement("form");c.name="wac_form",c.id="wac_form",c.target="wac_frame",c.action=function(e,t){if(e.WopiSrc.indexOf("PowerPointFrame.aspx")>=0){var i=e.WopiSrc.substr(e.WopiSrc.indexOf("WOPISrc=")+8),n=i.indexOf("&");e.WopiSrc=n<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,n))}var o=t.ApplicationUrl,r=o.indexOf("?"),s=o.substring(0,r);return s=Qt(s+="?wdEnableRoaming=1&wdo=1","PowerPointView",f(o,"PowerPointView")),w(o,"new")&&(s=Qt(s,"New","1")),w(o,"embed")&&(s=Qt(s,"Embed","1")),t.OnDemandServer||(s=Qt(s,"noLog","True")),e.WopiSrc&&(s=Qt(s,"WOPISrc",I(e.WopiSrc))),s=ei(s)}(e,t),c.method="post",c.appendChild(Pi("access_token",e.AccessToken)),c.appendChild(Pi("access_token_ttl",e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0")),s.appendChild(c),s.appendChild(a),a.appendChild(r),c.submit();var u={};n.stop();var d=n.getVisibilityChangeEvents();d&&d.length>0&&(u.documentLoadedWithTabSwitch=!0,i.ULS.Ye(38147725,U.B,P.Info,"Visibility Change Events:"+JSON.stringify(d))),t.FnOnInitializeSuccess(new Oi(o),u)}function Ri(e){var t=e.appContext,i="";if(ve()===he.Safari)i+="autoplay;microphone;camera;clipboard-read;clipboard-write;display-capture;";else{var n=t.podsUrl+" "+t.cdnBasePath+";";i+="autoplay "+n,i+="microphone "+n,i+="camera "+n,i+="clipboard-read "+n,i+="clipboard-write "+n,i+="display-capture "+n}return{permissionsPolicy:i,minHeight:t.shouldUsePods?"200px":"150px",minWidth:"300px",useAdditionalDiv:!t.shouldUsePods}}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Ei||(Ei={}));function ki(e,t){return e+"RemoteTelemetry.ashx"+(t?"?usid="+t:"")}function xi(e,t){return ki(Di(e),t)}function Di(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}var Wi={errorType:Ei.AppInitError,errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:5,ErrorName:"TimeoutInitialize",EventType:13,ExtraInfo:"Initialization timeout"},Mi=function(e,t){var i=this;if(this.ls=0,this.fs=0,this.hs=0,this.ps=0,this.ms=!1,this.vs=function(e,t){i.ls=B();var n=6e5,o=S("wdOnSuccessTimeout");o&&parseInt(o,10).toString()===o&&(n=parseInt(o,10),t.ULS.Ye(527521921,U.B,P.Warning,"App Timeout is overridden with url override param wdOnSuccessTimeout: ".concat(n))),n&&window.setTimeout((function(){return i.ws(e,t)}),n)},this.gs=function(e,t,n,o){var r={Message:"Received ".concat(e," callback after timeout had elapsed"),timeoutTimeMs:i.ps,successTimeMs:i.fs,startTimeMs:i.ls,appInitDiagnostics:n,error:o};t&&t.ULS.Ye(38589660,U.B,P.Info,JSON.stringify(r))},this.ws=function(e,t){if(!(i.hs||i.fs||i.ps)){i.ps=B();try{if(je(e.Container)){if(t){var n="Timed out waiting for FnOnInitializeSuccess to be called. startMs:".concat(i.ls,", timeoutMs:").concat(i.ps,", scenario:Unified, hostSessionId:").concat(e.SessionInformation.HostSessionId,", host: ").concat(e.SessionInformation.HostName);t.ULS.Ye(38589661,U.B,P.Error,n),Bi(e,5,"TimeoutInitialize",n,t,i.ps,!0)}e.FnOnInitializeFailure&&e.FnOnInitializeFailure(Wi)}else t&&(t.ULS.Ye(579604899,U.B,P.Warning,"App container is unloaded. Scenario: Unified"),Bi(e,7,"AppContainerUnloadedTimeout","App container is unloaded",t,i.ps,!1))}catch(e){t&&t.ULS.Ye(579604898,U.B,P.Error,"timeoutIfSuccessNotCalled exception: "+K(e))}}},e.FnOnInitializeSuccess){var n=e.FnOnInitializeSuccess;e.FnOnInitializeSuccess=function(o,r){i.fs=B(),i.ms||(i.ms=!0,i.ps?i.gs("success",t,r):(t&&(t.ULS.Ye(38836226,U.B,P.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),Bi(e,void 0,void 0,void 0,t,B(),!1,r)),n(o,r)))}}if(e.FnOnInitializeFailure){var o=e.FnOnInitializeFailure;e.FnOnInitializeFailure=function(n,r){i.hs=B(),i.ms||(i.ms=!0,i.ps&&n!==Wi?i.gs("failure",t,r,n):(t&&(Bi(e,n.Code,n.ErrorName,n.errorObject,t,B(),!1,r),t.ULS.Ye(38836227,U.B,P.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")),o(n,r)))}}this.vs(e,t)};function Bi(e,t,i,n,o,r,s,a){var c=null==t&&null==i&&null==n&&!s,u=e.SessionInformation,d=e.WopiPrecheckInfo,l=d.BundleInfo,f=0;null!=u.DocumentClickTime&&u.DocumentClickTime.getTime&&(f=u.DocumentClickTime.getTime());var h={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:d.FileSize,ApiStartTime:0,HostInitTime:u.HostInitTime,AppVersion:"1.20230804009",UseBabylon:"",EntryPoint:pi(e),SessionId:e.SessionId,UserAgent:window.navigator.userAgent,WACRegion:_(e.ApplicationUrl),FileHost:Ii(u.HostName),Host:u.HostName,PodsRing:"",UiHost:Si(u.HostName)},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:f,BootSuccess:c,BootTime:r,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!d.FileGetUrl,FileNameBool:!!d.FileName,ReadOnly:d.ReadOnly,SupportsDecryptedContentDownload:d.SupportsDecryptedContentDownload,ViewOnly:d.ViewOnly,PreseededSessionKey:d.PreseededSessionKey,BundleInfo:l?{MajorVersion:l.MajorVersion,URLBool:!!l.Url}:""},AppBootTimings:a?a.appBootTimingDict:""};o.ULS.Ye(s?592007955:587843200,U.B,s?P.Error:P.Info,JSON.stringify(h)),k(xi(e.ApplicationUrl,e.SessionId),"PowerPoint",c?"bootSuccess":"bootFailure")}function Hi(e){var t=6e5,i=e.wdParams.wdonsuccesstimeout;return i&&parseInt(i,10).toString()===i&&(t=parseInt(i,10)),t}function Li(e){e.appContext.bootComplete=!0,Vi(e),e.logger.ULS.Ye(34932955,U.B,P.Warning,JSON.stringify(e.diagnostics)),Ji(e)}function Vi(e){if(e.appContext.shouldUsePods){var t=e.appInitDiagnostics;t.officeFrameServerDocumentFlushTime=t.documentFlushTime,t.officeFrameServerFirstFlushTime=t.serverFirstFlushTime,t.officeFrameServerStartTime=t.serverStartTime,t.officeServerDocumentProcessStartTime=t.bootStartMs,t.officeServerDocumentProcessEndTime=t.bootEndMs,t.fileRequestsData=[{browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest",correlationId:t.downloadCorrelation,startTime:t.downloadStartMs,endTime:t.downloadEndMs,size:t.downloadSize,incremental:t.incDownload}],delete t.documentFlushTime,delete t.serverFirstFlushTime,delete t.serverStartTime,delete t.bootStartMs,delete t.bootEndMs,delete t.downloadCorrelation,delete t.downloadStartMs,delete t.downloadEndMs,delete t.downloadSize,delete t.incDownload}}function Ji(e,t,i,n){var o=e.appContext;if(!o.bootRecorded){o.bootRecorded=!0;var r=void 0!==t||void 0!==i||void 0!==n,s=!!e.timeoutTime,a=!!e.failureTime,c=!(!e.successTime||s||a||r),u=c?e.successTime:a?e.failureTime:e.timeoutTime,d=e.file,l=e.hostInitDiagnostics,f=e.bootParams,h=e.contentBundle,p=e.preseededSession,m=e.appInitDiagnostics,v={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:d.size,ApiStartTime:0,HostInitTime:l.hostInitializeCallTime,AppVersion:"1.20230804009",UseBabylon:"",EntryPoint:l.entryPoint,SessionId:e.sessionId,UserAgent:window.navigator.userAgent,WACRegion:_(e.appBasePath),FileHost:e.host.storageHostName,Host:e.hostName,PodsRing:"",UiHost:e.host.uiHostName},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:l.userClickTime,BootSuccess:c,BootTime:u,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!d.getUrl,FileNameBool:!!d.name,ReadOnly:f.readOnly,SupportsDecryptedContentDownload:f.supportsDecryptedContentDownload,ViewOnly:f.viewOnly,PreseededSessionKey:p?p.key:void 0,BundleInfo:h?{MajorVersion:h.majorVersion,URLBool:!!h.url}:""},AppBootTimings:m?m.appBootTimingDict:""};e.logger.ULS.Ye(s?592007955:587843200,U.B,s?P.Error:P.Info,JSON.stringify(v))}}function ji(e,t){Ji(e,void 0,t.errorType,K(t.errorObject))}function zi(e){try{var t=!e.container||!je(e.container.element),i=t?7:5,n=t?"AppContainerUnloadedTimeout":"TimeoutInitialize",o=t?"App container is unloaded":"Timed out waiting for boot success. startMs:".concat(e.hostInitDiagnostics.hostInitializeCallTime,", timeoutMs:").concat(e.timeoutTime,", scenario:Unified, hostSessionId:").concat(e.hostSessionId,", host: ").concat(e.hostName);if(t)e.failureTime=e.timeoutTime,e.timeoutTime=0;else if(e.appContext.shouldUsePods){var r=function(t,i){Te(e.appInitDiagnostics,i.Diagnostics),Vi(e);var n=de({message:"Received success message after timeout had elapsed",timeoutTime:e.timeoutTime,currentTime:B()},e.diagnostics);e.logger.ULS.Ye(558195677,U.B,P.Info,JSON.stringify(n)),e.removeActionHandler(Y.Bt,r)};e.addActionHandler(Y.Bt,r)}Ji(e,i,n,o)}catch(t){e.logger.ULS.Ye(558893250,U.B,P.Error,"onTimeout exception: "+K(t))}}function Gi(e,t){Ji(e,void 0,"AppInitError",K(t))}function qi(){return!1}function Ki(e){e.appContext.shouldUsePods&&Ai(e)}var Zi=function(e,t,i,n,o){return e!==Y.Si?Promise.reject("Wrong flow"):i.ui.uiEmbed?function(e,t,i,n,o){return e!==Y.Si?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var n=void 0;if(t.queryOverrides)try{n=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.Ye(592217694,U.B,P.Error,"Failed to parse queryOverrides: ".concat(n))}i.raiseEvent(te.Reboot,de(de({},t),{previousSessionId:i.sessionId,queryOverrides:n})),e({completion:"success"})}))}(e,t,i):new Promise((function(e){var n=window.location.href;w(n,"wdccsoff")&&(n=m(n,"wdccsoff")),n=h(n,"previoussessionid",i.sessionId,!0),t.controllerServicesParam&&(n=h(n,t.controllerServicesParamName,t.controllerServicesParam)),i.logger.ULS.Ye(560740507,U.B,P.Info,"Updating window.location.href"),window.location.href=n,e({completion:"success"})}))},$i=function(e,t,i,n,o){return e!==Y.xi?Promise.reject("Wrong flow"):new Promise((function(e){var n=i.appContext;"FatalError"===t.Reason?function(e,t){var i=e.hostInitDiagnostics,n={ErrorName:t,BootCompleted:e.appContext.bootComplete,SessionInfo:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:e.bootParams.dataLanguage,DocumentClickTime:i.userClickTime,HostInitTime:i.hostInitializeCallTime,UiHost:e.host.uiHostName,WdParams:e.wdParams}};e.logger.ULS.Ye(587236555,U.B,P.Error,JSON.stringify(n))}(i,t.ErrorName):i.logger.ULS.Ye(558421913,U.B,P.Info,"Updating boot complete - reason [".concat(t.Reason,"]")),n.bootComplete||(i.bootHeartBeat&&i.bootHeartBeat.stop(),n.bootFlowResolve({completion:"success"})),i.successTime=B(),Ji(i),e({completion:"success"})}))};var Xi,Qi=function(){var e,t;return[(e={},e[X.appReboot]=Zi,e[X.boot]=it,e[X.closeTab]=nt,e[X.createNew]=ot,e[X.dispose]=ct,e[X.frameTrust]=ut,e[X.getAuthToken]=dt,e[X.getHostKeyValue]=nt,e[X.handleBootState]=lt,e[X.rename]=ft,e[X.setOverlayContent]=pt,e[X.storeHostKeyValue]=nt,e[X.switchMode]=nt,e[X.updateBootComplete]=$i,e),(t={},t[X.boot]={initializeAppContext:ii,buildAppBasePath:ni,buildRemoteTelemetryUrl:oi,ignoreCompletionMessage:ri,buildBootRequestParams:yi,beforeContainerBoot:Ti,buildContainerBootParams:Ri,overrideBootTimeout:Hi,onSuccess:Li,onFailure:ji,onTimeout:zi,onException:Gi},t[X.createNew]={parallelizeStartSessionRequest:qi,sendCreateNewWopiInfo:Ki},t)]};!function(e){e[e.AppPageLoading=0]="AppPageLoading",e[e.AppReadyForPostMessage=1]="AppReadyForPostMessage",e[e.AppBootComplete=2]="AppBootComplete",e[e.DEPRECATED=3]="DEPRECATED",e[e.RefreshPage=4]="RefreshPage",e[e.UpdateInitializationComplete=6]="UpdateInitializationComplete",e[e.ProfileClientResourceUsage=7]="ProfileClientResourceUsage",e[e.ULSLog=8]="ULSLog"}(Xi||(Xi={}));var Yi=function(){function e(){var t=this;this.Ss={},this.Is=function(e,i){for(var n in t.Ss){var o=t.Ss[n];o&&o.log(e,i)}},this.bs=function(t){var i;try{i=JSON.parse(t.data)}catch(e){i=null}if(i){var n=i.m_id||i.Token;if(n){var o=e.getInstance(),r=o.get(n);r?r.onMessage(i,t.source):o.Is("Message received with no targetApi. Id: "+n.toString(),t.data)}}},window.addEventListener("message",this.bs)}return e.getInstance=function(){return this.Cs||(this.Cs=new e),this.Cs},e.prototype.add=function(e,t){this.Ss[e]=t},e.prototype.get=function(e){return this.Ss[e]},e.prototype.remove=function(e){this.Ss[e]=null},e}();function en(e,t,i,n){return{ShouldUsePODS:e,CanUsePODS:t,Reason:i,CreateNewScenario:n}}function tn(e,t){var i,n,o=e.WopiPrecheckInfo,r=e.ApplicationUrl,s=function(e,t,i,n){var o,r;e.CreateNewInfo?(r=ht.UnifiedCreateNew,o="CreateNewInfo"):e.IsNewFile?(r=ht.UnifiedCreateNew,o="CreateNewInfoIsNewFile"):e.IsNewFileFromHostTemplate?(r=ht.UnifiedCreateNew,o="CreateNewInfoFromHostTemplate"):i&&i.FileGetUrl?(r=ht.UnifiedCreateNew,o="CreateNewInfoFromTemplateSourceUrl"):w(t,"new")?0!==e.FileSize?(r=ht.LegacyCreateNew,o="ApplicationUrlContainsNewAndNonZeroByteFile"):(r=ht.UnifiedCreateNew,o="ApplicationUrlContainsNew"):(r=ht.NotCreateNew,o="NotCreateNew");var s={};return s.CreateNewScenario=ht[r],s.reason=o,n.ULS.Ye(34932951,U.B,P.Info,JSON.stringify(s)),r}(o,r,e.NewFileTemplateSource,t),a=S("wdPodsEnabled");return i=o.FileGetUrl,n=a?en("false"!==a,!0,"wdPodsEnabled is available",s):function(e,t,i){if($t(e))return t===ht.LegacyCreateNew?en(!1,!1,"Legacy Create New Scenario because application url contains new, but non-zero file size",t):-1!==e.indexOf("&Embed=1")?en(!1,!1,"Embed View fallback to WAC",t):en(!0,!0,"Supported Region",t);var n="Wac region not currently supported by PODS: "+(_(e)||"");return i.ULS.Ye(589168768,U.B,P.Warning,n),en(!1,!1,n,t)}(r,s,t),i||n.CreateNewScenario!==ht.NotCreateNew?n:en(!1,!1,n.Reason+"| FileGetUrl is empty",n.CreateNewScenario)}var nn,on,rn=function(){function e(){var e=this;if(this._s=[],this.ys=[],this.Ts=function(){var t={visibility:document.visibilityState,time:B(),initialState:!1};e._s.push(t);for(var i=0,n=e.ys;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:B(),initialState:!0};this._s.push(t)}document.addEventListener("visibilitychange",this.Ts)}return e.prototype.registerEventHandler=function(e){this.ys.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.ys.indexOf(e);this.ys.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.Ts)},e.prototype.getVisibilityChangeEvents=function(){return this._s},e.prototype.dispose=function(){this.stop(),this.ys=[],this._s=[]},e}(),sn=((nn={})[Q.blurFocus]=ee.An,nn[Q.continueAccessibilityLoop]=ee.Fn,nn[Q.grabFocus]=ee.Nn,nn[Q.moveToFolder]=ee.fi,nn[Q.popState]=ee.Wn,nn[Q.rename]=ee.zn,nn[Q.sendAccessToken]=ee.Gn,nn[Q.sendAuthToken]=ee.qn,nn[Q.sendCustomAuthConfig]=ee.Kn,nn[Q.sendEmbeddedViewUrl]=ee.$n,nn[Q.sendSessionInfo]=ee.Xn,nn[Q.sendUserAccessAndPermissions]=ee.Qn,nn[Q.sendWopiInfo]=ee.Yn,nn[Q.sendDavUrl]=ee.eo,nn[Q.completeSharedFilePicker]=ee.yi,nn[Q.switchMode]=ee.so,nn[Q.signalShared]=ee.do,nn),an=function(){function e(e,t){var i,n,o=this;if(this.As=!1,this.ys={},this.xo="",this.Do="",this.Bo=!1,this.Wo=!1,this.Mo=!1,this.Ho=!1,this.Us=[],this.Ps=!0,this.Es=function(e,t,i){if(e){var n={MessageId:ee._n,CorrelationId:i,SendTime:B()};o._t.ULS.Ye(595732176,U.B,P.Info,"Sending Ack back"),e.postMessage(JSON.stringify(n),t)}else o._t.ULS.Ye(595736136,U.B,P.Info,"Missing target to send Ack back")},this.Os=function(e){var t,i=!1,n=!0,r="",s=!1;if(o.Fs&&o.Fs.contentWindow&&(i=!0,n=e.source===o.Fs.contentWindow),e.origin&&(s=(r=u(e.origin,2).toLowerCase())===o.Do),!o.Wo&&(!o.Mo||s&&n)||o._t.ULS.Ye(595730526,U.B,P.Info,"Window is available: ".concat(i,", window is valid: ").concat(n,", origin is valid: ").concat(s,", expected origin: ").concat(o.Do,", actual origin: ").concat(r)),s&&(!o.Bo||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void o._t.ULS.Ye(596464282,U.B,P.Info,"Failed to parse event data: ".concat(K(e),"."))}var c=a.MessageId;if(c){if(o._t.ULS.Ye(595714715,U.B,P.Info,"Received messageId: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==Y.Bt&&c!==Y.di||o.Ns(e.origin),o.Ho&&c===Y.bn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);a.Values&&a.Values.ackExpected&&o.Es(e.source,e.origin,a.CorrelationId);var d=o.ys[c];if(!d)return o._t.ULS.Ye(596464289,U.B,P.Info,"No handler found for message id: ".concat(c)),void(o.Ps&&c===Y.oi&&(o.Us.push(a),o._t.ULS.Ye(543207888,U.B,P.Info,"Kept for later process: ".concat(c))));o._t.ULS.Ye(596464288,U.B,P.Info,"Processing message: ".concat(c));try{d(a.Values||{})}catch(e){o._t.ULS.Ye(593773704,U.B,P.Error,"Handler error: ".concat(K(e)))}0}else(o.Wo||o.Mo)&&o._t.ULS.Ye(595730520,U.B,P.Info,"Could not find message id")}},this.Rs=function(){o.Ps=!1,o.Us.forEach((function(e){var t=e.MessageId,i=o.ys[t];if(i){o._t.ULS.Ye(543207890,U.B,P.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){o._t.ULS.Ye(543207891,U.B,P.Error,"Handler error: ".concat(K(e)))}}else o._t.ULS.Ye(543207889,U.B,P.Info,"No handler found after boot complete: ".concat(t))})),o.Us=[]},this.ks=function(e,t,i){e.postMessage(t,i)},this.Ns=function(e){var t=e.toLowerCase();o.xo&&o.xo!==t&&o._t.ULS.Ye(596128131,U.B,P.Warning,"Updating origin: [".concat(_(o.xo),"]->[").concat(_(t),"]")),o.xo=t,o.Do=u(t,2),o.Wo=r(t),o.Mo=s(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.Wo=r(e),this.Mo=s(e),this._t=t,this.Ns(e),this.Ho=!!(null===(n=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===n?void 0:n.match(/wdpa=1/gi))}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.ys[e])throw new Error("Duplicate registration!");this.ys[e]=t},e.prototype.removeMessageHandler=function(e){delete this.ys[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this._t.ULS.Ye(596464334,U.B,P.Info,"Sending message: "+t);var n={MessageId:t,SendTime:B(),Values:i};this.ks(e.contentWindow,JSON.stringify(n),this.xo)}else this._t.ULS.Ye(595948308,U.B,P.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.Fs=e,this.Bo=!!t,this.As||(window.addEventListener("message",this.Os,!1),this.As=!0)},e.prototype.postMessageForCommand=function(e,t,i){var n=sn[t];n?(this._t.ULS.Ye(595702598,U.B,P.Info,"Sending message ".concat(n," for command ").concat(t)),this.sendPostMessage(e,n,i)):this._t.ULS.Ye(595702599,U.B,P.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.ys={},this.As&&(window.removeEventListener("message",this.Os,!1),this.As=!1)},e}();!function(e){e.BrowserEvent="BrowserEvent",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(on||(on={}));var cn=!1,un=!1;function dn(e,t,i,n,o,r,s){if(t.ULS.Ye(595714433,U.B,P.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(cn,"; unloading:").concat(un)),cn||un&&e)t.ULS.Ye(595714908,U.B,P.Info,"Application is already disposed or unloading");else{var a,c={logger:t,postMessenger:i,innerApplicationFrame:n,onDisposed:o,onFrameRemoved:r,unloadTimeoutInMs:s||1e3,forceAppUnload:!1,disposeStartTime:B(),appUnloadTimedOut:!1};if(e&&n)return un=!0,c.forceAppUnload=!0,(a=c).forceAppUnloadStartTime=B(),a.logger.ULS.Ye(595855490,U.B,P.Info,"Sending postmessage to unload app"),a.logger.ULS.flush(),a.postMessenger.registerMessagePayloadHandler(Y.Ni,(function(e){return function(e,t){e.forceAppUnloadEndTime=B(),e.appUnloadedMessageValues=t,e.logger.ULS.Ye(595855491,U.B,P.Info,"AppUnloaded received from app"),ln(e)}(a,e)})),a.postMessenger.sendPostMessage(a.innerApplicationFrame,ee.ao,{}),void window.setTimeout((function(){return function(e){!un&&cn||(e.appUnloadTimedOut=!0,e.logger.ULS.Ye(595855492,U.B,P.Info,"ApplicationUnload timed out, forcing dispose"),ln(e))}(a)}),a.unloadTimeoutInMs);ln(c)}}function ln(e){if(!cn)try{cn=!0,un=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:B(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,n=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-e.forceAppUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.Ye(595855436,U.B,P.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.Ye(595714434,U.B,P.Error,"Error disposing: ".concat(K(t)))}}var fn=function(){function e(e,t,i,n,o){var r=this;this.ys={},this.xs=function(){r.Ds.registerMessagePayloadHandler(Y.Si,r.Ws),r.Ds.registerMessagePayloadHandler(Y.ai,r.Ms),r.Ds.registerMessagePayloadHandler(Y.ci,r.Bs),r.Ds.registerMessagePayloadHandler(Y.oi,r.Hs),r.Ds.registerMessagePayloadHandler(Y.Pi,r.Ls),r.Ds.registerMessagePayloadHandler(Y.ri,r.Vs),r.Ds.registerMessagePayloadHandler(Y.fi,r.Js),r.Ds.registerMessagePayloadHandler(Y.yi,r.js)},this.zs=function(e,t){var i=r.ys[e];if(i)try{i(t||{})}catch(e){r._t.ULS.Ye(593773706,U.B,P.Error,"Handler error: ".concat(K(e)))}},this.Ws=function(e){e.previousSessionId=r.ds,r.zs(on.DocumentReboot,e)},this.Ms=function(e){r.zs(on.WopiInfoFromUrl,e)},this.Bs=function(e){r.zs(on.DavUrlFromIds,e)},this.Hs=function(e){Promise?r.Gs.isResourceTrustedForMessage(e).then((function(t){t?r.zs(on.GetAuthToken,e):r.Ds.sendPostMessage(r.Fs,ee.qn,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){r.Ds.sendPostMessage(r.Fs,ee.qn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):r.Ds.sendPostMessage(r.Fs,ee.qn,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.Ls=function(e){r.zs(on.FileShare,e)},this.Vs=function(e){r.zs(on.GetCustomAuthConfig,e)},this.Js=function(e){r.zs(on.MoveToFolder,e)},this.js=function(e){r.zs(on.SharedFilePicker,e)},this.ds=e,this._t=t,this.Fs=o.innerApplicationFrame,this.Ds=i,this.qs=n,this.Gs=new xe(t),this.xs(),cn=!1}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return N()},e.prototype.GetSessionId=function(){return this.ds},e.prototype.RegisterEventHandler=function(e,t){switch(e){case on.Unloaded:case on.Disposed:case on.DocumentReboot:case on.WopiInfoFromUrl:case on.DavUrlFromIds:case on.GetAuthToken:case on.GetCustomAuthConfig:case on.MoveToFolder:case on.SharedFilePicker:case on.SetOverlayContent:case on.FileShare:if(this.ys[e])throw new Error("Duplicate registration");this.ys[e]=t;break;default:this.Ds.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case on.Unloaded:case on.Disposed:case on.DocumentReboot:case on.FileShare:case on.WopiInfoFromUrl:case on.DavUrlFromIds:case on.GetAuthToken:case on.GetCustomAuthConfig:case on.MoveToFolder:case on.SharedFilePicker:case on.SetOverlayContent:if(this.ys[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.ys[e];break;default:this.Ds.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.Ds.postMessageForCommand(this.Fs,e,t)},e.prototype.Dispose=function(e,t){var i=this;dn(e||!1,this._t,this.Ds,this.Fs,(function(){delete i.Fs,i.qs(),i.Ds.dispose(),i.zs(on.Unloaded,{})}),(function(){try{i.zs(on.Disposed,{}),i.ys={}}catch(e){i._t.ULS.Ye(589108815,U.B,P.Error,"onFrameRemoved error: ".concat(K(e)))}}),t)},e}();var hn,pn=function(e){function t(t,i,n,o,r){var s=e.call(this,t,i,n,o,r)||this;return s.Ks={},s.Zs=!1,s.$s=!1,s.Xs=function(){s.$s||(s.$s=!0,s.Zs=!1,s.qs&&s.qs(),s.zs(on.Unloaded,{}),s.zs(on.Disposed,{}),s.Ks.disposeEndTime=B(),s._t.ULS.Ye(41710159,U.B,P.Info,JSON.stringify(s.Ks)),s.ys={})},s.Qs=function(e){s.Ks.appUnloadEndTime=B(),e&&(s.Ks.wacDisposeTelemetry=e),s.Xs()},s.Ys=function(){!s.Zs&&s.$s||(s._t.ULS.Ye(41710160,U.B,P.Warning,"Unload timed out"),s.Ks.appUnloadTimedOut=!0),s.Xs()},s.Ds.registerMessagePayloadHandler(Y.Ni,s.Qs),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}ue(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.Dispose=function(e,t){if(!(this.$s||this.Zs&&e))if(this.Ks.disposeStartTime=B(),e){this.Zs=!0,this.Ks.appUnloadStartTime=B(),this.Ks.forceAppUnload=e,this.Ds.sendPostMessage(this.Fs,ee.ao,{});var i=t||1e3;window.setTimeout(this.Ys,i)}else this.Xs()},t}(fn),mn=function(){function e(){this.hasAppBooted=!1}return e.prototype.getIfAllFieldsSet=function(){if(this.wopiInfo&&this.hasAppBooted&&this.iframe&&this.podsUrl)return{wopiInfo:this.wopiInfo,iframe:this.iframe,podsUrl:this.podsUrl,readonly:this.readonly,hasAppBooted:this.hasAppBooted,irmEnabled:this.irmEnabled,supportsDecryptedContentDownload:this.supportsDecryptedContentDownload,fileName:this.fileName}},e}(),vn=function(){function e(e,t,i,n,o){var r,s=this;this.ea=new mn,this.ta=!1,this.ia=new rn,this.na=function(){var e=Yi.getInstance();e&&s.oa&&e.remove(s.oa.PptInitParams.PostMessageToken),s.Vr&&s.Vr.dispose(),s.ra&&s.ra.parentElement&&s.ra.parentElement.removeChild(s.ra),s.ra&&delete s.ra,s.sa(),s._t.ULS.Ye(587552790,U.B,P.Warning,"PPTUnifiedSessionLoader::dispose:: App dispose"),s.ia.stop()},this.aa=function(){var e=s.ea&&s.ea.getIfAllFieldsSet();if(!s.ca&&e&&e.iframe.contentWindow){var t={};t.WopiSrc=e.wopiInfo.WopiSrc,t.AccessToken=e.wopiInfo.AccessToken,t.AccessTokenTTL=e.wopiInfo.AccessTokenExpiry?e.wopiInfo.AccessTokenExpiry.getTime():0,t.ReadOnly=e.readonly,t.IrmEnabled=e.irmEnabled,t.SupportsDecryptedContentDownload=e.supportsDecryptedContentDownload,t.FileName=e.fileName,t.SessionContext=s.ua,t.WdParams=s.da,t.DocumentURL=window.location.href;var i=S("PreviousSessionID");i&&(t.PreviousSessionID=i),s.la(t),e.iframe.contentWindow.postMessage(JSON.stringify(t),e.podsUrl),s.ca=!0}},this.la=function(e){var t,i,n,o=window.WOPIPerf_FirstPageFlush;o&&(e.FirstPageFlushTime=o);var r=window.WOPIPerf_BootJsStartTime;r&&(e.BootJsStartTime=r);var a=window.WOPIPerf_BootJsEndTime;a&&(e.BootJsEndTime=a);var c=window.WOPIPerf_InitializeWac;c&&(e.InitializeWacTime=c);var u=window.WOPIPerf_UserClick,d=s.oa&&s.oa.AppInitDiagnostics&&s.oa.AppInitDiagnostics.userClickTime;if(u?e.UserClickTime=u:d&&(e.UserClickTime=d),window.performance){var l=window.performance.timing;l&&(e.NavigationStart=l.navigationStart,e.FetchStart=l.fetchStart,e.RequestStart=l.requestStart,e.ResponseStart=l.responseStart,e.ResponseEnd=l.responseEnd);var f=window.performance.navigation;f&&(e.NavigationType=f.type,e.NavigationRedirects=f.redirectCount)}e.UnifiedUiHostDiagnostics=null===(i=null===(t=s.oa)||void 0===t?void 0:t.AppInitDiagnostics)||void 0===i?void 0:i.unifiedUiHostDiagnostics,e.ClientDiagnostics=null===(n=s.oa)||void 0===n?void 0:n.PptInitParams.ClientDiagnostics,s.fa(e)},this.fa=function(e){var t;if(window.performance&&window.performance.getEntriesByType){var i=null===(t=window.performance.getEntriesByType("navigation")[0])||void 0===t?void 0:t.toJSON();i&&i.name&&(delete i.name,e.HostPerfNavigationTelemetry=i)}},this.ha=function(e,t,i){s.ea&&(s.ea.wopiInfo=e),t===ht.UnifiedCreateNew&&function(e){if(e&&e.NewFilePath)window.history.replaceState(null,"",e.NewFilePath),e.UpdatedPageTitle&&(window.document.title=e.UpdatedPageTitle);else if(window.location.href.indexOf("action=editnew")>=0){var t=window.location.href.replace("action=editnew","action=edit");window.history.replaceState(null,window.document.title||"",t)}}(i),window.setTimeout(s.aa,1)},this.sa=function(){window.removeEventListener("beforeunload",s.bo,{capture:!0}),window.removeEventListener("pagehide",s.Co,{capture:!0}),window.removeEventListener("visibilitychange",s._o,{capture:!0})},this.pa=function(){var e=Je(s._t);s.Vr?s.Vr.sendPostMessage(s.ra,ee.ii,{isTopFrameTrusted:e}):s._t.ULS.Ye(51237655,U.B,P.Error,"Trust frame request received but the wac frame is null")};var u,d=void 0;try{var l=void 0,h=!1;e.WopiPrecheckInfo&&e.WopiPrecheckInfo.PreseededWacSessionId?(u=e.WopiPrecheckInfo.PreseededWacSessionId,h=!0):i?u=i:(u=(r=se())[0],l=r[1]),k(xi(e.ApplicationUrl,u),"PowerPoint","init"),function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){!e.WopiPrecheckInfo.PreseededSessionKey||"_._._."===e.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)&&"-.-.-."===e.WopiPrecheckInfo.PreseededSessionKey.slice(-6)||(e.WopiPrecheckInfo.PreseededSessionKey="_._._."+e.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.")}(e),e.ApplicationUrl=a(e.ApplicationUrl,f(e.ApplicationUrl,"region")),e.ApplicationUrl=m(e.ApplicationUrl,"region");var p=function(e){if(e){var t=$t(e);return t?t.PodsUrl:e.substring(0,e.toLowerCase().indexOf("powerpointframe.aspx")).replace("/p/","/pods/")}return""}(e.ApplicationUrl);d=t||z({remoteUlsEndpoint:p+"RemoteUls.ashx",sessionId:u}),this._t=d;var v=wi(e.SessionInformation.HostSessionId),w=de(de({},e),{SessionId:u,PostMessageToken:v,OnDemandServer:p,FeatureManager:n||Z(e.FnIsFeatureEnabled,d),SettingsManager:o||new oe("PowerPoint",d),UsePodsDetails:tn(e,d),ClientDiagnostics:Pe()});o||(w.SettingsManager.addSettingsChangeListener(d.settingsChangeHandler),w.SettingsManager.initializePeriodicFetch(p,u)),new Mi(w,d),d.ULS.Ye(38580693,U.B,P.Warning,"PPTBootstrapper - initializing session. Build version: ".concat(N(),"; UserSessionId: ").concat(u,"; IsSessionIdPreseeded: ").concat(h,"; IsSessionIdToUseProvided: ").concat(!!i)),d.ULS.Ye(38580694,U.B,P.Info,"Bootstrapper Init Time: ".concat((new Date).getTime())),l&&d.ULS.Ye(572618978,U.B,P.Info,JSON.stringify(l)),window.addEventListener("unload",(function(){d.ULS.Ye(41157219,U.B,P.Warning,"Unloading bootstrapper window."),d.ULS.flushOnClose()})),this.bo=function(){return bi(d,"OnBeforeUnload",!0)},this.Co=function(){return bi(d,"OnPageHide",!0)},this._o=function(){return bi(d,"VisibilityChange_"+document.visibilityState,!0)},window.addEventListener("beforeunload",this.bo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Co,{capture:!0}),window.addEventListener("visibilitychange",this._o,{capture:!0}),d.ULS.Ye(38580695,U.B,P.Info,"Application.InitializeWopiPending"),function(e,t){var i={BootstrapperType:"TypeScript",JsApiVersion:"v1",Preview:!1,Scenario:"Unified App",ApplicationUrl:_(e.ApplicationUrl)||null,IsDeepLink:!!S("nav"),BootstrapperInstanceId:ae(),IsMobileView:Ce()};i.ApplicationCustomSettings={OnDemandServer:_(e.OnDemandServer)||null,EnableWacFallback:!0};var n=e.SessionInformation,o=e.Diagnostics,r=o&&o.userClickTime?o.userClickTime:n.DocumentClickTime?n.DocumentClickTime.getTime():null;i.SessionInformation={HostName:n.HostName,HostSessionId:n.HostSessionId,UiLocale:n.UiLocale,DataLocale:n.DataLocale,DocumentClickTime:r,HostInitTime:n.HostInitTime,CurrentTime:B(),UiHost:Si(n.HostName),WdParams:n.WdParams},i.Diagnostics={EntryPoint:pi(e),FileHost:Ii(e.SessionInformation.HostName),PodsRing:"",UnifiedUiHostDiagnostics:o?o.unifiedUiHostDiagnostics:null};var s=e.WopiPrecheckInfo,a=!!s.FileGetUrl,c=!!s.CustomFontCatalogUrl;i.WopiPrecheckInfo={FileSize:s.FileSize,FileGetUrlBool:a,CustomFontCatalogBool:c,FileGetUrlLength:a?s.FileGetUrl.length:null,FileNameBool:!!s.FileName,ReadOnly:s.ReadOnly,IrmEnabled:s.IrmEnabled,SupportsDecryptedContentDownload:s.SupportsDecryptedContentDownload,ViewOnly:s.ViewOnly,PreseededSessionKey:!!s.PreseededSessionKey,FileExtension:G(s.FileName)||null,BundleInfo:s.BundleInfo?{MajorVersion:s.BundleInfo.MajorVersion,URLBool:!!s.BundleInfo.Url}:{}},i.AppInfo={AppVersionMajor:1,AppVersionMinor:20230804009,Environment:"wac",UserAgent:window.navigator.userAgent},i.AdditionalTelemetry={PostMessageToken:e.PostMessageToken},t.ULS.Ye(22357763,U.B,P.Info,JSON.stringify(i,q))}(w,d);var g=w.UsePodsDetails;!function(e,t,i){var n={ShouldUsePodsOrCached:e.ShouldUsePODS,ShouldUsePods:e.ShouldUsePODS,CanUsePods:e.CanUsePODS,ApplicationUrl:_(t)||null,Reason:e.Reason,CreateNewScenario:ht[e.CreateNewScenario]};i.ULS.Ye(38580687,U.B,P.Info,JSON.stringify(n))}(g,w.ApplicationUrl,d);var I=g.ShouldUsePODS;if(I){w.Diagnostics&&w.Diagnostics.userClickTime&&Fe(w.Diagnostics.userClickTime,d),w.IsFileNew=g.CreateNewScenario!==ht.NotCreateNew,w.WopiPrecheckInfo.ReadOnly=w.WopiPrecheckInfo.ReadOnly||!1;var b=Fi(w,d);if(!b){var C={Message:"Error creating IFrame",HostSessionId:w.SessionInformation.HostSessionId};throw d.ULS.Ye(38580696,U.B,P.Error,JSON.stringify(C)),Error("Error Creating IFrame")}d.ULS.Ye(50376725,U.B,P.Warning,"Assigning wopiBootParams"),this.ra=b.IFrameElement,this.ea&&(this.ea.iframe=b.IFrameElement,this.ea.podsUrl=ti(w.OnDemandServer),this.ea.readonly=w.WopiPrecheckInfo.ReadOnly,this.ea.irmEnabled=w.WopiPrecheckInfo.IrmEnabled,this.ea.supportsDecryptedContentDownload=w.WopiPrecheckInfo.SupportsDecryptedContentDownload,this.ea.fileName=w.WopiPrecheckInfo.FileName),this.Vr=new an(c(w.ApplicationUrl),d),this.Vr.activate(b.IFrameElement),w.SessionInformation.SupportsFrameTrustCheck||this.Vr.registerMessagePayloadHandler(Y.ii,this.pa),this.ua=w.SessionInformation.SessionContext?w.SessionInformation.SessionContext:"",this.da="",w.SessionInformation.WdParams&&(this.da=_i(w.SessionInformation.WdParams)),this.da&&d.ULS.Ye(539837381,U.B,P.Warning,"Non-empty WdParams Assigned");var y=de(de({},w.Diagnostics),{hostName:w.SessionInformation.HostName});y.officeFrameCreateTime=b.FrameCreateTime,y.cacheHit=!1,this.oa={AppInitDiagnostics:y,PptInitParams:w};var T=Yi.getInstance();T&&T.add(v,this)}d.ULS.Ye(50376727,U.B,P.Warning,"Creating WopiPendingApplication"),this.ma={Complete:function(e,t){I?s.ha(e,g.CreateNewScenario,t):Ni(e,w,d,s.ia,v)},Fail:function(e){s._t.ULS.Ye(38293905,U.B,P.Info,"Host failed to give us WopiInfo")},Dispose:function(e,t){s.na(),t&&t()}},vi(w.BootstrapperUrl,d),window.setTimeout((function(){d&&d.ULS.flush()}),1e4)}catch(t){d&&(d.ULS.Ye(38580697,U.B,P.Error,Ei.AppInitError+": "+K(t)),d.ULS.flushOnClose()),e&&(e.ApplicationUrl&&k(xi(e.ApplicationUrl,u),"PowerPoint","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Ei.AppInitError,errorObject:t}))}}return e.prototype.log=function(e){this._t.ULS.Ye(39978262,U.B,P.Info,e)},e.prototype.onMessage=function(e,t){try{if(!e||!this.oa)return void this._t.ULS.Ye(39978263,U.B,P.Error,"Missing message data: "+!e+" or appData: "+!this.oa);switch(this.ra&&this.ra.contentWindow===t||this._t.ULS.Ye(39978264,U.B,P.Error,"Message with the right postMessageToken came from an unexpected iframe"),!e.Data.officeSessionId&&this.oa.AppInitDiagnostics.officeSessionId&&(e.Data.officeSessionId=this.oa.AppInitDiagnostics.officeSessionId),e.Data.messageType||(e.Data.messageType=e.Type),this._t.ULS.Ye(38580691,U.B,P.Warning,JSON.stringify(e.Data)),e.Type){case Xi.AppPageLoading:break;case Xi.AppReadyForPostMessage:this.ea&&(this.ea.hasAppBooted=!0),e.Data.officeSessionId&&(this.oa.AppInitDiagnostics.officeSessionId=e.Data.officeSessionId),window.setTimeout(this.aa,1);break;case Xi.AppBootComplete:if(this.ta=!0,this.oa.PptInitParams.FnOnInitializeSuccess){this.oa.AppInitDiagnostics.officeBootstrapperVersion=N(),e.Data.officeAppEndpoint&&(this.oa.AppInitDiagnostics.officeAppEndpoint=e.Data.officeAppEndpoint),e.Data.officeServerVersion&&(this.oa.AppInitDiagnostics.officeServerVersion=e.Data.officeServerVersion),e.Data.documentLoadedTime&&(this.oa.AppInitDiagnostics.documentLoadedTime=e.Data.documentLoadedTime,this.oa.AppInitDiagnostics.appCompletedTime=e.Data.documentLoadedTime),e.Data.officeFrameFirstFlushTime&&(this.oa.AppInitDiagnostics.officeFrameFirstFlushTime=e.Data.officeFrameFirstFlushTime),e.Data.officeFrameDocumentFlushTime&&(this.oa.AppInitDiagnostics.officeFrameDocumentFlushTime=e.Data.officeFrameDocumentFlushTime),e.Data.documentFlushTime&&(this.oa.AppInitDiagnostics.officeFrameServerDocumentFlushTime=e.Data.documentFlushTime),e.Data.serverFirstFlushTime&&(this.oa.AppInitDiagnostics.officeFrameServerFirstFlushTime=e.Data.serverFirstFlushTime),e.Data.serverStartTime&&(this.oa.AppInitDiagnostics.officeFrameServerStartTime=e.Data.serverStartTime),e.Data.bootStartMs&&(this.oa.AppInitDiagnostics.officeServerDocumentProcessStartTime=e.Data.bootStartMs),e.Data.bootEndMs&&(this.oa.AppInitDiagnostics.officeServerDocumentProcessEndTime=e.Data.bootEndMs),e.Data.cacheHit&&(this.oa.AppInitDiagnostics.cacheHit=e.Data.cacheHit);var i={browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest"};e.Data.downloadCorrelation&&(i.correlationId=e.Data.downloadCorrelation),e.Data.downloadStartMs&&(i.startTime=e.Data.downloadStartMs),e.Data.downloadEndMs&&(i.endTime=e.Data.downloadEndMs),e.Data.downloadSize&&(i.size=e.Data.downloadSize),e.Data.incDownload&&(i.incremental=e.Data.incDownload),this.oa.AppInitDiagnostics.fileRequestsData=[i],this.ia.stop();var n=this.ia.getVisibilityChangeEvents();if(n&&n.length>0&&(this.oa.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,this._t.ULS.Ye(38580692,U.B,P.Info,"Visibility Change Events:"+JSON.stringify(n))),this._t.ULS.Ye(34932955,U.B,P.Warning,JSON.stringify(this.oa.AppInitDiagnostics)),!this.Vr)throw this._t.ULS.Ye(51448022,U.B,P.Warning,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),Error("m_postMessageHandler");this.va=new pn(this.oa.PptInitParams.PostMessageToken,this._t,this.Vr,this.na,{innerApplicationFrame:this.ra}),this.oa.PptInitParams.FnOnInitializeSuccess(this.va,this.oa.AppInitDiagnostics),this.Vr.Rs()}break;case Xi.RefreshPage:if(this.oa.PptInitParams.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&this.oa.PptInitParams.SessionInformation.SupportsDocReboot)break;var o=window.location.href;-1!==o.indexOf("&wdccsoff=1")&&(o=m(o,"wdccsoff")),e.Data.officeSessionId&&(o=Qt(o,"PreviousSessionID",e.Data.officeSessionId)),e.Data.ControllerServicesParam&&(o=Qt(o,e.Data.ControllerServicesParamName,e.Data.ControllerServicesParam)),this._t.ULS.Ye(594068673,U.B,P.Info,"PPTUnifiedSessionLoader::onMessage::RefreshPage Updating window.location.href"),window.location.href=o;break;case Xi.UpdateInitializationComplete:try{if("FatalError"===e.Data.Reason){var r={ErrorName:e.Data.ErrorName,BootCompleted:this.ta,SessionInfo:(a=this.oa.PptInitParams,u=a.SessionInformation,d=a.Diagnostics,{HostName:u.HostName,HostSessionId:u.HostSessionId,UiLocale:u.UiLocale,DataLocale:u.DataLocale,DocumentClickTime:d&&d.userClickTime?d.userClickTime:u.DocumentClickTime?u.DocumentClickTime.getTime():void 0,HostInitTime:u.HostInitTime,UiHost:Si(u.HostName),WdParams:u.WdParams})};this._t.ULS.Ye(587236555,U.B,P.Error,JSON.stringify(r))}else this._t.ULS.Ye(576583120,U.B,P.Info,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete - Reason: ".concat(e.Data.Reason))}catch(e){this._t.ULS.Ye(576582732,U.B,P.Error,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete Caught exception: "+e)}this.Vr||(this._t.ULS.Ye(51448024,U.B,P.Info,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),this.Vr=new an(c(this.oa.PptInitParams.ApplicationUrl),this._t),this.Vr.activate(this.ra)),this.va=new pn(this.oa.PptInitParams.PostMessageToken,this._t,this.Vr,this.na,{innerApplicationFrame:this.ra}),this.oa.PptInitParams.FnOnInitializeSuccess(this.va,this.oa.AppInitDiagnostics),this.Vr.Rs();break;case Xi.ProfileClientResourceUsage:this._t.ULS.Ye(541388952,U.B,P.Info,JSON.stringify(e.Data));break;case Xi.ULSLog:var s=e.Data;if(!s||"number"!=typeof s.Tag||"number"!=typeof s.Category||"number"!=typeof s.Level||"string"!=typeof s.Message)break;try{this._t.ULS.Ye(s.Tag,s.Category,s.Level,s.Message)}catch(e){this._t.ULS.Ye(512235073,U.B,P.Error,"PPTUnifiedSessionLoader::onMessage ULSLog exception: "+e)}}}catch(e){this._t.ULS.Ye(594121922,U.B,P.Error,"PPTUnifiedSessionLoader::onMessage Caught exception: "+e)}var a,u,d},e.prototype.getWopiPendingApplication=function(){return this.ma},e}(),wn=function(){function e(){}return e.prototype.GetVersion=function(){return N()},e.prototype.GetMinContentVersion=function(){return 1},e.prototype.Prefetch=function(){},e.prototype.InitializeWopiPending=function(e,t,i,n,o,r){return new vn(e,t,i,o,r).getWopiPendingApplication()},e}();!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(hn||(hn={})),i.d(t,"Application",(function(){return gn})),i.d(t,"createApplication",(function(){return Sn})),i.d(t,"DocRebootSupportMode",(function(){return hn})),i.d(t,"CommandIds",(function(){return Q})),i.d(t,"EventIds",(function(){return te})),i.d(t,"createCancellationToken",(function(){return at}));var gn=new wn,Sn=function(e){var t={name:"PowerPoint",usePreseededSessionId:!0,preconnector:T()};return new Ge(e,t,Qi)}}});
//# sourceMappingURL=powerpoint.app.boot.9fdd12b43dcddf7338a5.js.map
var SlideGrid=function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModelBinding=t.ViewBinding=t.ViewModelBindingParam=t.ViewBindingParam=void 0;t.ViewBindingParam=function(){};t.ViewModelBindingParam=function(){};var n=function(){function e(e,t){var i=this;this._bindingList=[],null!=e&&null!=t&&null!=Object(e)[t]&&(delete Object(e)[t].get,delete Object(e)[t].set),Object.defineProperty(e,t,{set:function(n){Object(e)["_".concat(t)]=n,i._bindingList.forEach((function(e){e.attribute&&""!==e.attribute&&(Object(e.element)[e.attribute]=n),null!=e.onValueChanged&&e.onValueChanged(n)}))},get:function(){return Object(e)["_".concat(t)]},configurable:!0})}return e.prototype.addBinding=function(e){this._bindingList.push(e)},e}();t.ViewBinding=n;var r=function(){function e(e,t){var i=this;this._bindingList=[],null!=e&&null!=t&&null!=Object(e)[t]&&(delete Object(e)[t].get,delete Object(e)[t].set),Object.defineProperty(e,t,{set:function(n){Object(e)["_".concat(t)]=n,i._bindingList.forEach((function(e){Object(e.target)[t]=n,null!=e.onValueChanged&&e.onValueChanged(n)}))},get:function(){return Object(e)["_".concat(t)]},configurable:!0})}return e.prototype.addBinding=function(e){this._bindingList.push(e)},e}();t.ViewModelBinding=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(21))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(){this.subs=[]}return e.prototype.signal=function(e,t){this.subs.forEach((function(i){i(e,t)}))},e.prototype.subscribe=function(e){this.subs.push(e)},e.prototype.unsubscribe=function(e){var t=this.subs.indexOf(e);return-1!==t&&(this.subs.splice(t,1),!0)},e}();t.Event=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var n=function(){function e(e){this.m_genericViewClassName="generic-view-class",this._parent=e,this._container=document.createElement("div"),this._container.classList.add(this.m_genericViewClassName),this._parent.appendChild(this._container)}return e.prototype.dispose=function(){try{this._parent.removeChild(this._container)}catch(e){}},Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),e}();t.View=n},function(e,t,i){var n=i(23),r=i(24),o=r;o.v1=n,o.v4=r,e.exports=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModel=void 0;var n=function(){function e(e){null!=this._parent&&(this._parent=e)}return e.prototype.dispose=function(){null!=this._view&&this._view.dispose()},e}();t.ViewModel=n},function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectData=t.DragDropObjectType=void 0,(n=t.DragDropObjectType||(t.DragDropObjectType={}))[n.Slide=0]="Slide",n[n.Section=1]="Section",n[n.SlidePlaceholder=2]="SlidePlaceholder";var r=function(){function e(e,t){this.m_index=t,this.m_type=e}return e.prototype.isEqual=function(e){return this.m_index===e.index&&this.dragDropObjectType===e.dragDropObjectType},Object.defineProperty(e.prototype,"index",{get:function(){return this.m_index},set:function(e){this.m_index=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDropObjectType",{get:function(){return this.m_type},enumerable:!1,configurable:!0}),e}();t.ObjectData=r},function(e,t,i){"use strict";var n,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.PresenceTouchTargetTrigger=t.SectionSelectionTrigger=t.SlideSelectionTrigger=void 0,(n=t.SlideSelectionTrigger||(t.SlideSelectionTrigger={}))[n.Click=0]="Click",n[n.DoubleClick=1]="DoubleClick",n[n.RightClick=2]="RightClick",n[n.EnterKey=3]="EnterKey",n[n.ActiveSlideChange=4]="ActiveSlideChange",n[n.MouseDown=5]="MouseDown",n[n.ActiveSectionChange=6]="ActiveSectionChange",n[n.ArrowKey=7]="ArrowKey",n[n.CtrlAKey=8]="CtrlAKey",n[n.ShiftHomeKey=9]="ShiftHomeKey",n[n.ShiftEndKey=10]="ShiftEndKey",n[n.TabKey=11]="TabKey",(r=t.SectionSelectionTrigger||(t.SectionSelectionTrigger={}))[r.Click=0]="Click",r[r.RightClick=2]="RightClick",r[r.ActiveSectionChange=3]="ActiveSectionChange",(o=t.PresenceTouchTargetTrigger||(t.PresenceTouchTargetTrigger={}))[o.MouseOver=0]="MouseOver",o[o.MouseOut=1]="MouseOut"},function(e,t,i){"use strict";var n=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataUtils=void 0;var r=i(1),o=function(){function e(){}return e.MoveSlideByIndex=function(e,t,i,o,s,a){var l=e.filter((function(e){return 0<=i.indexOf(e.slideOrderIndex)})),d=l.map((function(e){return e.slideID})),c=e.slice();l=l.sort((function(e,t){return e.slideOrderIndex-t.slideOrderIndex}));for(var u=function(i){var n=null!=c.filter((function(e){return e.slideID===l[i].slideID}))?c.filter((function(e){return e.slideID===l[i].slideID}))[0]:null;if(n){var r=c.map((function(e){return e.slideID})).indexOf(l[i].slideID);if(0<=o){var a=t[n.sectionIndex];a.slideIdList.splice(a.slideIdList.indexOf(n.slideID),1);var d=0<=s?s:e[o].sectionIndex;n.sectionIndex=d,null==t[d].slideIdList&&(t[d].slideIdList=[]),t[d].slideIdList.push(n.slideID)}n.slideOrderIndex,c.splice(r,1)}},g=0;g<l.length;g+=1)u(g);var p=r.ChangeGate.isChangeGateEnabled("slideMoveToEmptySectionBugFix")?0:-1;for(g=0;g<c.length;g+=1)c[g].slideOrderIndex===o&&(p=g);for(p=a?p+1:p,c.splice.apply(c,n([p,0],l,!1)),c.forEach((function(e,t){e.slideOrderIndex=t})),g=0;g<e.length;g+=1)e[g]=c[g];return e.filter((function(e){return 0<=d.indexOf(e.slideID)})).map((function(e){return e.slideOrderIndex}))},e.isFirstSlideOfSection=function(e,t){if(t<0||null==e||0===e.length||t>e.length-1)return!1;var i=e[t];return t===e.filter((function(e){return e.sectionIndex===i.sectionIndex})).map((function(e){return e.slideOrderIndex})).reduce((function(e,t){return Math.min(e,t)}))},e.isLastSlideOfSection=function(e,t){if(t<0||null==e||0===e.length||t>e.length-1)return!1;var i=e[t];return t===e.filter((function(e){return e.sectionIndex===i.sectionIndex})).map((function(e){return e.slideOrderIndex})).reduce((function(e,t){return Math.max(e,t)}))},e.MoveSlideById=function(t,i,n,r,o,s){var a=t.filter((function(e){return e.slideID.slideSid===n.slideSid&&e.slideID.slideCid===n.slideCid}))[0].slideOrderIndex,l=t.filter((function(e){return e.slideID.slideSid===r.slideSid&&e.slideID.slideCid===r.slideCid}))[0].slideOrderIndex;e.MoveSlideByIndex(t,i,[a],l,o,s)},e.NearestPreviousNonSourceSlide=function(e,t,i){var n=0,r=e.filter((function(e){return e.slideOrderIndex<=i&&0===t.filter((function(t){return t===e.slideOrderIndex})).length}));return 0<r.length&&0<(r=r.sort((function(e,t){return t.slideOrderIndex-e.slideOrderIndex}))).length&&(n=r[0].slideOrderIndex),n},e.NearestPreviousNonSourceSlideBySection=function(e,t,i,n){var r=t.filter((function(e){return e.sectionIndex<=n&&null!=e.slideIdList&&0<e.slideIdList.length})).sort((function(e,t){return t.sectionIndex-e.sectionIndex})),o=0;if(null!=r&&0<r.length){var s=e.filter((function(e){return 0<r.filter((function(t){return t.sectionIndex===e.sectionIndex})).length&&0===i.filter((function(t){return t===e.slideOrderIndex})).length}));0<(s=s.sort((function(e,t){return t.slideOrderIndex-e.slideOrderIndex}))).length&&(o=s[0].slideOrderIndex)}return o},e.IsSlideIdListEmpty=function(e){return null!=e&&null!=e.slideIdList&&0===e.slideIdList.length},e.IsSlideIdListNotEmpty=function(e){return null!=e&&null!=e.slideIdList&&0<e.slideIdList.length},e.isSlideIDEqual=function(e,t){return e.slideSid===t.slideSid&&e.slideCid===t.slideCid},e.isSlideIDPartialEqual=function(t,i){return!!e.isSlideIDEqual(t,i)||!t.slideCid&&t.slideSid===i.slideSid},e}();t.DataUtils=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragDropManager=t.DropContainerPosition=void 0;var n,r,o=i(40),s=i(41),a=i(2),l=i(6),d=i(43);(r=n=t.DropContainerPosition||(t.DropContainerPosition={}))[r.ContainerLeft=0]="ContainerLeft",r[r.ContainerRight=1]="ContainerRight",r[r.ContainerTop=2]="ContainerTop",r[r.ContainerBottom=3]="ContainerBottom";var c=function(){function e(e){this.m_openedFirstSlidePlaceHolder=!1,this.m_shouldScrollRootContainer=!1,this.m_draggableList=[],this.m_dropContainerList=[],this.m_hasDraggingElement=!1,this.m_dragReadyElements=[],this.m_currentDraggables=[],this.m_dragDropOperationCompletedEvent=new a.Event,this.m_dragDropMoveOverEvent=new a.Event,this.m_dragDropMoveEvent=new a.Event,this.m_dragDropOperationStartedEvent=new a.Event,this.m_dragDropVisualFactory=new d.DragDropVisualFactory(this.m_dragReadyElements),this.m_dragDropSettings=e}return e.prototype.addNewDraggable=function(e,t){var i=this,n=new s.Draggable(e,t,this.m_dragDropVisualFactory,this.m_dragDropSettings.scrollThresholdInPx);return this.m_draggableList.push(n),n.dragStartEvent.subscribe((function(e,t){i.onDragStart(t)})),n.dragMoveEvent.subscribe((function(e,t){i.onDragMove(t)})),n.dragStopEvent.subscribe((function(e,t){i.onDragStop(t),i.m_shouldScrollRootContainer=!1})),n.dragToTopEvent.subscribe((function(){i.scrollRootContainer(!0),i.m_shouldScrollRootContainer=!0})),n.dragToBottomEvent.subscribe((function(){i.scrollRootContainer(!1),i.m_shouldScrollRootContainer=!0})),n.dragToCenterEvent.subscribe((function(){i.m_shouldScrollRootContainer=!1})),n},e.prototype.onDragStop=function(e){if(this.m_hasDraggingElement){var t=[],i=[],n=this.updateInRangeContainerStatusLists(e,t,i),r=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.Section);if(n){var o={draggableObjectDataList:this.m_currentDraggables.map((function(e){return e.objectData})),dropTargetObjectDataList:t.map((function(e){return e.objectData})),dropContainerPositionList:i,hasValidDropTarget:!0,sectionObjectData:-1<r?t[r].objectData:null};this.m_dragDropOperationCompletedEvent.signal(null,o)}n||this.m_dragDropOperationCompletedEvent.signal(null,{hasValidDropTarget:!1}),this.m_currentDraggables=[],this.m_hasDraggingElement=null!=this.m_dragReadyElements&&0<this.m_dragReadyElements.length,this.m_openedFirstSlidePlaceHolder=!1}},e.prototype.onDragMove=function(e){this.m_hasDraggingElement=!0;var t=[],i=[];if(this.updateInRangeContainerStatusLists(e,t,i)){var r=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.Slide),o=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.SlidePlaceholder),s=t.map((function(e){return e.objectData.dragDropObjectType})).indexOf(l.DragDropObjectType.Section);if(0<=r){var a=t[r].objectData;i[r]===n.ContainerLeft&&this.m_openedFirstSlidePlaceHolder&&(a=new l.ObjectData(t[r].objectData.dragDropObjectType,t[r].objectData.index+1));var d={draggableObjectData:e.objectData,hasValidDropTarget:!0,dropTargetObjectData:a,sectionObjectData:0<=s?t[s].objectData:null};this.m_dragDropMoveOverEvent.signal(null,d),this.m_openedFirstSlidePlaceHolder=!0}else o<0&&(d={draggableObjectData:e.objectData,dropTargetObjectData:t[0].objectData,hasValidDropTarget:!0,sectionObjectData:0<=s?t[s].objectData:null},this.m_dragDropMoveOverEvent.signal(null,d))}else this.m_dragDropMoveOverEvent.signal(null,{hasValidDropTarget:!1});for(var c=0;c<this.m_dragReadyElements.length;c+=1)this.m_currentDraggables.indexOf(this.m_dragReadyElements[c])<0&&this.m_currentDraggables.push(this.m_dragReadyElements[c]),this.m_dragDropMoveEvent.signal(null,{draggableObjectData:this.m_dragReadyElements[c].objectData})},e.prototype.onDragStart=function(e){this.m_dragDropOperationStartedEvent.signal(null,{draggableObjectData:e.objectData})},e.prototype.addNewDropContainer=function(e,t){var i=new o.DropContainer(e,t);return this.m_dropContainerList.push(i),i},Object.defineProperty(e.prototype,"initialDragReadyElements",{set:function(e){for(var t=this.m_draggableList.map((function(e){return e.objectData})),i=0;i<t.length;i+=1)0<=e.indexOf(t[i])&&(this.m_dragReadyElements.push(this.m_draggableList[i]),this.m_draggableList[i].isDragReady=!0);this.m_dragDropVisualFactory.dragReadyElements=this.m_dragReadyElements},enumerable:!1,configurable:!0}),e.prototype.removeDraggable=function(e){var t=-1;null!=this.m_currentDraggables&&-1!==(t=this.m_currentDraggables.indexOf(e))&&this.m_currentDraggables.splice(t,1),null!=this.m_dragReadyElements&&-1!==(t=this.m_dragReadyElements.indexOf(e))&&(this.m_dragReadyElements.splice(t,1),this.dragReadyElements=this.m_dragReadyElements),-1!==(t=this.m_draggableList.indexOf(e))&&this.m_draggableList.splice(t,1)},e.prototype.removeDropContainer=function(e){var t=this.m_dropContainerList.indexOf(e);return-1!==t&&(this.m_dropContainerList.splice(t,1),!0)},Object.defineProperty(e.prototype,"dragDropOperationCompletedEvent",{get:function(){return this.m_dragDropOperationCompletedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDropMoveOverEvent",{get:function(){return this.m_dragDropMoveOverEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDropOperationStartedEvent",{get:function(){return this.m_dragDropOperationStartedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDropMoveEvent",{get:function(){return this.m_dragDropMoveEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDropRootContainer",{set:function(e){this.m_dragDropRootContainer=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragReadyElements",{get:function(){return this.m_dragReadyElements},set:function(e){this.m_dragReadyElements=e;for(var t=0;t<this.m_draggableList.length;t+=1)0<=this.m_dragReadyElements.indexOf(this.m_draggableList[t])?this.m_draggableList[t].isDragReady=!0:this.m_draggableList[t].isDragReady=!1;this.m_dragDropVisualFactory.dragReadyElements=this.m_dragReadyElements},enumerable:!1,configurable:!0}),e.prototype.updateInRangeContainerStatusLists=function(e,t,i){var n=!1;if(new l.ObjectData(l.DragDropObjectType.Slide,-1),null!=e)for(var r=0;r<this.m_dropContainerList.length;r+=1)if(void 0!==e.pageX&&void 0!==e.pageY&&this.m_dropContainerList[r].isDraggableInRange(e.pageX,e.pageY)){var o=this.m_dropContainerList[r].dropContainerPosition(e.pageX,e.pageY);n=!0,this.m_dropContainerList[r].objectData,i.push(o),t.push(this.m_dropContainerList[r])}return n},e.prototype.scrollRootContainer=function(e){var t=this,i=e?-1:1;this.m_dragDropRootContainer.scrollTop+i<=this.m_dragDropRootContainer.scrollHeight&&0<=this.m_dragDropRootContainer.scrollTop+i&&(this.m_dragDropRootContainer.scrollTop=this.m_dragDropRootContainer.scrollTop+i),this.m_shouldScrollRootContainer&&setTimeout((function(){return t.scrollRootContainer(e)}),this.m_dragDropSettings.scrollTimeoutInMs)},e}();t.DragDropManager=c},function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SlideGridHighContrastMode=void 0,(n=t.SlideGridHighContrastMode||(t.SlideGridHighContrastMode={})).None="None",n.HighContrastBlack="HighContrastBlack"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideGridFocusMoveUtils=t.SectionMoveType=t.SlideMoveType=t.FocusMoveType=void 0;var n,r,o,s,a=i(8),l=i(1);(r=n=t.FocusMoveType||(t.FocusMoveType={})).None="none",r.Up="up",r.Down="down",r.Left="left",r.Right="right",r.Start="start",r.End="end",(o=t.SlideMoveType||(t.SlideMoveType={})).MoveSlideUp="moveSlideUp",o.MoveSlideToStart="moveSlideToStart",o.MoveSlideDown="moveSlideDown",o.MoveSlideToEnd="moveSlideToEnd",(s=t.SectionMoveType||(t.SectionMoveType={})).MoveSectionUp="moveSectionUp",s.MoveSectionDown="moveSectionDown";var d=function(){function e(e){this.m_slideGridSettings=e}return e.prototype.handleSlideFocusMove=function(e,t,i,r,o){var s=-1;switch(e){case n.Up:s=this.handleSlideFocusMoveUp(t,i,r,o);break;case n.Down:s=this.handleSlideFocusMoveDown(t,i,r,o);break;case n.Left:s=this.handleSlideFocusMoveLeft(t);break;case n.Right:s=this.handleSlideFocusMoveRight(t,r.length)}return s},e.prototype.handleSectionFocusMove=function(e,t,i,r,o,s){var a=-1;switch(e){case n.Up:a=this.handleSectionFocusMoveUp(i,t,o,s,r);break;case n.Down:a=this.handleSectionFocusMoveDown(i,t,o,s,r);break;case n.Left:a=this.handleSectionFocusMoveLeft(i,t,o,s);break;case n.Right:a=this.handleSectionFocusMoveRight(i,t,o,s)}return a},e.prototype.handleSlideFocusMoveFromSectionFocus=function(e,t,i,r,o){return-1===t?a.DataUtils.IsSlideIdListEmpty(o[i])?-1:this.getFirstSlideInSection(r,i):-1===i?e===n.Up||e===n.Left?0<t?a.DataUtils.IsSlideIdListEmpty(o[t-1])?-1:this.getLastSlideInSection(r,t-1):-1:a.DataUtils.IsSlideIdListEmpty(o[t])?-1:this.getFirstSlideInSection(r,t):a.DataUtils.IsSlideIdListEmpty(o[i])?-1:this.getFirstSlideInSection(r,i)},e.prototype.handleSlideFocusMoveUp=function(e,t,i,n){if(e<0||t<1||null==i||i.length<=0||e>=i.length)return-1;var r=e-t;if(1===t&&!this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering)return 0<=r?r:0;var o=i.filter((function(t){return t.sectionIndex===i[e].sectionIndex}));if(null==o||o.length<=0)return-1;var s=e>=o[0].slideOrderIndex&&e<o[0].slideOrderIndex+t,a=i[e].sectionIndex<=0;if(s){if(a)return e;var l=this.nextNonEmptySectionIndex(!0,n,i[e].sectionIndex);if(-1===l)return e;var d=i.filter((function(e){return e.sectionIndex===l})).length,c=Math.ceil(d/t)*t-d;if(null!=i[r+=c]&&i[r].sectionIndex===l)return r;var u=i.filter((function(e){return e.sectionIndex===l}));return u[u.length-1].slideOrderIndex}return r},e.prototype.handleSlideFocusMoveDown=function(e,t,i,n){if(e<0||t<1||null==i||i.length<=0||e>=i.length)return-1;var r=e+t;if(1===t)return r<i.length?r:i.length-1;var o=i.filter((function(t){return t.sectionIndex===i[e].sectionIndex}));if(null==o||o.length<=0)return-1;var s=this.isSlideInSectionLastRow(e,o[0].slideOrderIndex,o.length,t),a=i[e].sectionIndex>=n.length-1;if(s){if(a)return e;o.length%t!=0&&(r-=o.length>t?t-o.length%t:t-o.length);var l=this.nextNonEmptySectionIndex(!1,n,i[e].sectionIndex);return-1===l?e:null!=i[r]&&i[r].sectionIndex===l?r:i.filter((function(e){return e.sectionIndex===l}))[0].slideOrderIndex}return null!=i[r]&&i[r].sectionIndex===i[e].sectionIndex?r:o[o.length-1].slideOrderIndex},e.prototype.handleSlideFocusMoveLeft=function(e){return e<0?-1:0<e?e-1:0},e.prototype.handleSlideFocusMoveRight=function(e,t){return e<0?-1:e<t-1?e+1:t-1},e.prototype.handleSectionFocusMoveUp=function(e,t,i,n,r){if(null===i||0===i.length||null==n||0===n.length||r<0)return-1;if(-1===t)return 0===e?e:a.DataUtils.IsSlideIdListEmpty(n[e-1])?e-1:-1;var o=i.filter((function(e){return e.sectionIndex===i[t].sectionIndex}));if(null==o||o.length<=0)return-1;var s=t>=o[0].slideOrderIndex&&t<o[0].slideOrderIndex+r,l=0===e;return-1===e?s?i[t].sectionIndex:-1:e===i[t].sectionIndex?l?e:a.DataUtils.IsSlideIdListEmpty(n[e-1])?e-1:-1:-1},e.prototype.handleSectionFocusMoveDown=function(e,t,i,n,r){if(null===i||0===i.length||null==n||0===n.length||r<0)return-1;if(-1===t)return e===n.length-1?e:e+1;var o=i.filter((function(e){return e.sectionIndex===i[t].sectionIndex}));if(null==o||o.length<=0)return-1;var s=this.isSlideInSectionLastRow(t,o[0].slideOrderIndex,o.length,r),d=i[t].sectionIndex,c=d>=n.length-1;return-1===e?s?c?-1:d+1:-1:e===i[t].sectionIndex||a.DataUtils.IsSlideIdListEmpty(n[e])?c?null==o||o.length<=0?e:-1:l.ChangeGate.isChangeGateEnabled("MoveToNextSectionBugFix")?a.DataUtils.IsSlideIdListEmpty(n[e])?e+1:-1:a.DataUtils.IsSlideIdListEmpty(n[e+1])||a.DataUtils.IsSlideIdListEmpty(n[e])?e+1:-1:-1},e.prototype.handleSectionFocusMoveRight=function(e,t,i,n){if(null===i||0===i.length||null==n||0===n.length)return-1;if(-1===t)return e===n.length-1?e:e+1;if(-1!==e)return a.DataUtils.IsSlideIdListNotEmpty(n[e])?-1:e<n.length-1?e+1:-1;var r=i[t].sectionIndex;return t===this.getLastSlideInSection(i,r)&&r<n.length-1?r+1:-1},e.prototype.handleSectionFocusMoveLeft=function(e,t,i,n){if(null===i||0===i.length||null==n||0===n.length)return-1;if(t<0)return 0===e?e:a.DataUtils.IsSlideIdListEmpty(n[e-1])?e-1:-1;var r=i[t].sectionIndex;return-1!==e?0===e?0:a.DataUtils.IsSlideIdListEmpty(n[e-1])?e-1:-1:t===this.getFirstSlideInSection(i,r)?i[t].sectionIndex:-1},e.prototype.nextNonEmptySectionIndex=function(e,t,i){for(var n=e?-1:t.length,r=e?-1:1,o=i+r;o!==n;o+=r)if(a.DataUtils.IsSlideIdListNotEmpty(t[o]))return o;return-1},e.prototype.getFirstSlideInSection=function(e,t){return e.filter((function(e){return e.sectionIndex===t})).map((function(e){return e.slideOrderIndex})).sort((function(e,t){return e-t}))[0]},e.prototype.getLastSlideInSection=function(e,t){var i=e.filter((function(e){return e.sectionIndex===t})).map((function(e){return e.slideOrderIndex}));return i.sort((function(e,t){return e-t}))[i.length-1]},e.prototype.isSlideInSectionLastRow=function(e,t,i,n){var r=!1;if(n<=0||e<0||t<0||i<=0)return!1;if(i<=n)return!0;var o,s=(i-i%n)/n;return(o=i%n==0?t+n*(s-1):t+n*s)<=e&&o<t+i&&(r=!0),r},e}();t.SlideGridFocusMoveUtils=d},function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(22),t)},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridContentBoundaryViewModel=void 0;var o=i(5),s=i(35),a=i(0),l=function(e){function t(t,i,n,r){var o=e.call(this,t)||this;return o._events=r,o._view=new s.GridContentBoundaryView(t,i,n),new a.ViewModelBinding(o,"isSelected").addBinding({target:o._view}),new a.ViewModelBinding(o,"slideIndex").addBinding({target:o._view}),new a.ViewModelBinding(o,"shouldDisplaySection").addBinding({target:o._view}),new a.ViewModelBinding(o,"isVisible").addBinding({target:o._view}),new a.ViewModelBinding(o,"displayCopilotUXEntryPoint").addBinding({target:o._view}),o._view.onViewClick.subscribe((function(e,t){o._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:t.insertIndex})})),o}return r(t,e),t}(o.ViewModel);t.GridContentBoundaryViewModel=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideGridFactory=void 0,i(51);var n=i(17),r=function(){function e(){}return e.CreateSlideGrid=function(e,t){return new n.SlideGrid(e,t)},e}();t.SlideGridFactory=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideGrid=void 0;var n=i(18),r=i(44),o=i(9),s=i(6),a=i(1),l=i(12),d=function(){function e(e,t){if(e.disabledChangeGates&&a.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),l.Settings.load(e.settings?e.settings.slidegrid:{}),this._parent=t,this._events=new r.SlideGridEvents,this.slideGridSettings=e,this.slideGridSettings.allowMoveSlide){var i={scrollThresholdInPx:e.dragDropScrollThresholdInPx,scrollTimeoutInMs:e.dragDropScrollTimeoutInMs};this.m_dragDropManager=new o.DragDropManager(i)}this._sectionListViewModel=new n.SectionListViewModel(this.slideGridSettings,this._parent,this._events,this.m_dragDropManager)}return e.prototype.updateSlideData=function(e){this._sectionListViewModel&&this._sectionListViewModel.updateSlideData(e)},e.prototype.show=function(e,t,i,n){if(null!=this._sectionListViewModel){if(null!=i&&(this._sectionListViewModel.slideDataList=i),null!=n&&(this._sectionListViewModel.sectionDataList=n,this.slideGridSettings.isUsingSlideGridInThumbnail||this._events.onVisibleSlideRangeChanged.signal(null,null)),0<=e.length&&(this._sectionListViewModel.currentSelectedSlideIndexes=e,this._sectionListViewModel.activeFocusSlideIndex=t),this.slideGridSettings.allowMoveSlide){var r=e.map((function(e){return new s.ObjectData(s.DragDropObjectType.Slide,e)}));this.m_dragDropManager.initialDragReadyElements=r}this._sectionListViewModel.shouldDisplayCollabMarkersHint=!1}},Object.defineProperty(e.prototype,"presenceInfoList",{get:function(){return this._sectionListViewModel.presenceInfoList},set:function(e){this._sectionListViewModel.presenceInfoList=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedSectionIndex",{get:function(){return this._sectionListViewModel.currentSelectedSectionIndex},set:function(e){this._sectionListViewModel.currentSelectedSectionIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editableSectionTitleIndex",{set:function(e){this._sectionListViewModel.currentEditableSectionIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplaySections",{set:function(e){this._sectionListViewModel.shouldDisplaySections=e},enumerable:!1,configurable:!0}),e.prototype.restoreFocusToGrid=function(){this._sectionListViewModel.activeFocusSlideIndex=this._sectionListViewModel.activeFocusSlideIndex},Object.defineProperty(e.prototype,"slideDataList",{get:function(){return this._sectionListViewModel.slideDataList},set:function(e){this._sectionListViewModel.slideDataList=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sectionDataList",{get:function(){return this._sectionListViewModel.sectionDataList},set:function(e){this._sectionListViewModel.sectionDataList=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleSlideRange",{get:function(){return this._sectionListViewModel.visibleSlideRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeFocusSlideIndex",{set:function(e){this._sectionListViewModel.activeFocusSlideIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedSlideIndexes",{get:function(){return this._sectionListViewModel.currentSelectedSlideIndexes},set:function(e){this._sectionListViewModel.currentSelectedSlideIndexes=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertBetweenSlideIndex",{set:function(e){this._sectionListViewModel.insertBetweenSlidesIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highContrastMode",{get:function(){return this._sectionListViewModel.highContrastMode},set:function(e){this._sectionListViewModel.highContrastMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedSlidesContentAreaRect",{get:function(){return this._sectionListViewModel.selectedSlidesContentAreaRect},enumerable:!1,configurable:!0}),e}();t.SlideGrid=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.SectionListViewModel=void 0;var o=i(19),s=i(25),a=i(5),l=i(7),d=i(0),c=i(10),u=i(11),g=i(8),p=i(9),h=i(6),m=i(1),v=function(e){function t(t,i,n,r){var s=e.call(this,i)||this;return s._highContrastMode=c.SlideGridHighContrastMode.None,s._copilotUXHasFocus=!1,s._events=n,s.m_slideGridSettings=t,s.m_slideGridFocusMoveUtils=new u.SlideGridFocusMoveUtils(s.m_slideGridSettings),s.m_dragDropManager=r,s._view=new o.SectionListView(s.m_slideGridSettings,i,s._events),s._sectionViewModelList=[],new d.ViewModelBinding(s,"highContrastMode").addBinding({target:s._view}),new d.ViewModelBinding(s,"copilotUXHasFocus").addBinding({target:s._view}),null!=s.m_slideGridSettings.highContrastMode&&(s.highContrastMode=s.m_slideGridSettings.highContrastMode),s._view.onViewAreaChanged.subscribe((function(){s.visibleSlideRange,n.onVisibleSlideRangeChanged.signal(null,null)})),s._view.onViewScrolled.subscribe((function(){n.onSlideGridScrolled.signal(null,null)})),s._events.onMoveSlide.subscribe((function(e,t){var i=t.dragStartIndexes,n=t.dropTargetIndex,r=null!=t.sectionIndex?t.sectionIndex:-1,o=!0;void 0!==t.shouldInsertSlideAfter&&(o=t.shouldInsertSlideAfter);var a=g.DataUtils.MoveSlideByIndex(s._slideDataList,s._sectionDataList,i,n,r,o);s.slideDataList=s._slideDataList,s.sectionDataList=s._sectionDataList,s._currentSelectedSlideIndexes=a})),s._events.onSlideSelectionChanged.subscribe((function(e,i){s.m_slideGridSettings.isCopilotUXEntryPointEnabled&&s.m_slideGridSettings.isUsingSlideGridInThumbnail&&i.slideSelectionTrigger!==l.SlideSelectionTrigger.EnterKey&&(s.copilotUXHasFocus=!1);var n=i.slideIndex,r=0<=s._currentSelectedSlideIndexes.indexOf(i.slideIndex);if(s.m_slideGridSettings.isDeselectWithCtrlEnabled&&i.isCtrlKeyPressed&&!i.isSelectingRange&&r){var o=s._currentSelectedSlideIndexes.indexOf(i.slideIndex);s._currentSelectedSlideIndexes.splice(o,1),s.currentSelectedSlideIndexes=s._currentSelectedSlideIndexes,0==s.currentSelectedSlideIndexes.length?s.activeFocusSlideIndex=-1:s.activeFocusSlideIndex=s.currentSelectedSlideIndexes[s.currentSelectedSlideIndexes.length-1]}else{if(s.m_slideGridSettings.allowMultipleSelect&&i.isSelectingMultiple){if(!(0<=s._currentSelectedSlideIndexes.indexOf(i.slideIndex)&&i.slideSelectionTrigger===l.SlideSelectionTrigger.MouseDown)){if(i.isSelectingRange){s._currentSelectedSlideIndexes=[];var a=s.activeFocusSlideIndex<=n?s.activeFocusSlideIndex:n,d=s.activeFocusSlideIndex<=n?n:s.activeFocusSlideIndex;i.slideSelectionTrigger===l.SlideSelectionTrigger.CtrlAKey&&(a=0,d=s.slideDataList.length-1);for(var c=a;c<=d;c+=1)s._currentSelectedSlideIndexes.push(c);s.m_shiftArrowKeyFocusIndex=n}else s._currentSelectedSlideIndexes.indexOf(n)<0&&s._currentSelectedSlideIndexes.push(n);s.currentSelectedSlideIndexes=s._currentSelectedSlideIndexes}}else 0<=s._currentSelectedSlideIndexes.indexOf(i.slideIndex)&&i.slideSelectionTrigger===l.SlideSelectionTrigger.MouseDown&&!i.isSelectingRange||(s.currentSelectedSlideIndexes=[n]);i.isSelectingRange&&1!==s._currentSelectedSlideIndexes.length||(s.activeFocusSlideIndex=n)}(s.m_slideGridSettings.enableRevisionTrackingInfo||s.m_slideGridSettings.isDisplayPresenceIcon)&&(i.slideSelectionTrigger!==l.SlideSelectionTrigger.ActiveSlideChange&&i.slideSelectionTrigger!==l.SlideSelectionTrigger.ActiveSectionChange||i.isSelectingRange||1!==s._currentSelectedSlideIndexes.length||-1!==s.currentActiveSectionIndex?s.shouldDisplayCollabMarkersHint=!1:s.shouldDisplayCollabMarkersHint=!0),i.slideSelectionTrigger!==l.SlideSelectionTrigger.ActiveSectionChange&&(s.currentActiveSectionIndex=-1),t.enableSelectionBetweenSlides&&(s.insertBetweenSlidesIndex=-1,s._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:-1})),i.isSelectingRange||(s.m_shiftArrowKeyFocusIndex=-1)})),s._events.onSectionSelectionChanged.subscribe((function(e,i){i.clickedAway?(s._sectionViewModelList.forEach((function(e){e.isSelected=!1})),s.currentActiveSectionIndex=-1):(s._sectionViewModelList.forEach((function(e){e.isSelected=e.sectionIndex===i.sectionIndex})),s.currentActiveSectionIndex=i.sectionIndex),t.enableSelectionBetweenSlides&&(i.clickedAway||(s.insertBetweenSlidesIndex=-1,s._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:-1})))})),s.m_slideGridSettings.enableSelectionBetweenSlides&&s._events.onInsertBetweenSlidesPositionChanged.subscribe((function(e,t){s.insertBetweenSlidesIndex=t.insertIndex,-1!==s.insertBetweenSlidesIndex&&(s.currentSelectedSlideIndexes=[],s.activeFocusSlideIndex=-1)})),s._view.onCurrentActiveFocusChanged.subscribe((function(e,t){s.currentActiveFocusChangedHandler(t)})),s._view.onCtrlArrowKey.subscribe((function(e,t){s.ctrlArrowKeyHandler(t)})),s._view.onEnterKey.subscribe((function(){s._events.onSlideSelectionChanged.signal(null,{slideIndex:s.activeFocusSlideIndex,slideSelectionTrigger:l.SlideSelectionTrigger.EnterKey,copilotUXHasFocus:s.copilotUXHasFocus})})),s._view.onCtrlAkey.subscribe((function(){s._events.onSlideSelectionChanged.signal(null,{slideIndex:s.activeFocusSlideIndex,slideSelectionTrigger:l.SlideSelectionTrigger.CtrlAKey,isSelectingRange:s.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:s.m_slideGridSettings.allowMultipleSelect})})),s._view.onShiftArrowKey.subscribe((function(e,t){try{if(!t||!s.m_slideGridSettings.isUsingSlideGridInThumbnail&&(t.focusMoveType===u.FocusMoveType.Up||t.focusMoveType===u.FocusMoveType.Down))return;var i,n=-1===s.m_shiftArrowKeyFocusIndex?s.activeFocusSlideIndex:s.m_shiftArrowKeyFocusIndex;i=t.focusMoveType===u.FocusMoveType.Left||t.focusMoveType===u.FocusMoveType.Up?0===n?n:n-1:n===s._slideDataList.length-1?n:n+1,s._events.onSlideSelectionChanged.signal(null,{slideIndex:i,slideSelectionTrigger:l.SlideSelectionTrigger.ArrowKey,isSelectingRange:s.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:s.m_slideGridSettings.allowMultipleSelect}),m.ChangeGate.isChangeGateEnabled("ShiftArrowScrollFix")&&s._events.onShiftArrowKeyScroll.signal(null,{slideIndex:i})}catch(e){return}})),s._view.onShiftHomeKey.subscribe((function(){s._events.onSlideSelectionChanged.signal(null,{slideIndex:0,slideSelectionTrigger:l.SlideSelectionTrigger.ShiftHomeKey,isSelectingRange:s.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:s.m_slideGridSettings.allowMultipleSelect})})),s._view.onShiftEndKey.subscribe((function(){s._events.onSlideSelectionChanged.signal(null,{slideIndex:s.slideDataList.length-1,slideSelectionTrigger:l.SlideSelectionTrigger.ShiftEndKey,isSelectingRange:s.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:s.m_slideGridSettings.allowMultipleSelect})})),s._view.onTabKey.subscribe((function(e,t){if(s.m_slideGridSettings.isCopilotUXEntryPointEnabled&&s.m_slideGridSettings.isUsingSlideGridInThumbnail){if(s.copilotUXHasFocus)return s.activeFocusSlideIndex=0,s.currentSelectedSlideIndexes=[0],void(s.copilotUXHasFocus=!1);if(0===s.activeFocusSlideIndex&&s.m_slideGridSettings.copilotUXTabStopId){var i=document.getElementById(s.m_slideGridSettings.copilotUXTabStopId);if(i)return i.focus(),s.copilotUXHasFocus=!0,s.activeFocusSlideIndex=-1,void(s.currentSelectedSlideIndexes=[])}}else{var n;n=t.isShiftKey?0===s.activeFocusSlideIndex?u.FocusMoveType.End:u.FocusMoveType.Up:s.activeFocusSlideIndex===s.slideDataList.length-1?u.FocusMoveType.Start:u.FocusMoveType.Down,s._view.onCurrentActiveFocusChanged.signal(null,{focusMoveType:n})}})),s.m_slideGridSettings.allowMoveSlide&&(s.m_dragDropManager.dragDropOperationCompletedEvent.subscribe((function(e,t){s.dragDropOperationCompletedHandler(t)})),s.m_dragDropManager.dragDropRootContainer=s._view.container),s._events.onActiveSectionFocusChanged.subscribe((function(e,t){var i=t.currentActiveFocusSectionIndex;if(-1!==i&&0<s.sectionDataList[i].slideIdList.length){var n=s.slideDataList.filter((function(e){return e.sectionIndex===i})).map((function(e){return e.slideOrderIndex}));0<n.length&&(s.currentSelectedSlideIndexes=n)}})),s}return r(t,e),Object.defineProperty(t.prototype,"currentSelectedSectionIndex",{set:function(e){this.currentActiveSectionIndex=e,this._sectionViewModelList.forEach((function(t){t.isSelected=t.sectionIndex===e}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentEditableSectionIndex",{set:function(e){e<0||e>=this._sectionViewModelList.length||(this._sectionViewModelList[e].titleEditMode=!0,this._currentEditableSectionIndex=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplaySections",{get:function(){return this.m_shouldDisplaySections},set:function(e){this._sectionViewModelList.forEach((function(t){t.shouldDisplaySection=e})),this.m_shouldDisplaySections=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"presenceInfoList",{get:function(){return this.presenceInfoList},set:function(e){this.m_slideGridSettings.isDisplayPresenceIcon&&(this._presenceInfoList=e,this._sectionViewModelList.forEach((function(t){var i=t.slideDataList.map((function(e){return e.slideID}));t.presenceInfoList=e.filter((function(e){return i.some((function(t){return g.DataUtils.isSlideIDEqual(e.slideID,t)}))}))})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slideDataList",{get:function(){return this._slideDataList},set:function(e){var t=this;this._slideDataList=e,this._sectionViewModelList.forEach((function(e){e.slideDataList=t._slideDataList.filter((function(t){return t.sectionIndex===e.sectionIndex})),e.totalSlideCount=t._slideDataList.length}))},enumerable:!1,configurable:!0}),t.prototype.updateSlideData=function(e){var t=this._sectionViewModelList.find((function(t){return t.sectionIndex==e.sectionIndex}));if(t&&t.updateSlideData(e)){var i=this._slideDataList.findIndex((function(t){return g.DataUtils.isSlideIDPartialEqual(t.slideID,e.slideID)}));-1!==i&&this._slideDataList.splice(i,1,e)}},Object.defineProperty(t.prototype,"sectionDataList",{get:function(){return this._sectionDataList},set:function(e){var t=this;this._sectionDataList=e,this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this._view.setZeroSectionVerticalThumbnailClass(this._sectionDataList.length);var i=0;this._currentSelectedSlideIndexesVMDB=new d.ViewModelBinding(this,"currentSelectedSlideIndexes"),this._activeFocusSlideIndexVMDB=new d.ViewModelBinding(this,"activeFocusSlideIndex"),(this.m_slideGridSettings.enableRevisionTrackingInfo||this.m_slideGridSettings.isDisplayPresenceIcon)&&(this._shouldDisplayCollabMarkersHintVMDB=new d.ViewModelBinding(this,"shouldDisplayCollabMarkersHint")),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(this._currentActiveSectionIndexVMDB=new d.ViewModelBinding(this,"currentActiveSectionIndex")),this.m_slideGridSettings.enableSelectionBetweenSlides&&(this._insertBetweenSlidesIndexVMDB=new d.ViewModelBinding(this,"insertBetweenSlidesIndex")),this._activeFocusSlideIndexVMDB.addBinding({target:this._view,onValueChanged:function(){t.m_shiftArrowKeyFocusIndex=-1}}),this._sectionDataList.forEach((function(e){var n;null==t._sectionViewModelList[i]?(n=new s.SectionViewModel(t.m_slideGridSettings,t._view.container,t._events,t.m_dragDropManager),t._sectionViewModelList.push(n)):n=t._sectionViewModelList[i],n.sectionTitle=e.sectionTitle,n.sectionIndex=e.sectionIndex,n.slideDataList=t._slideDataList.filter((function(t){return t.sectionIndex===e.sectionIndex})),n.activeSectionIndex=t.currentActiveSectionIndex,t._currentSelectedSlideIndexesVMDB.addBinding({target:n}),t._activeFocusSlideIndexVMDB.addBinding({target:n}),t.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&t._currentActiveSectionIndexVMDB.addBinding({target:n}),t.m_slideGridSettings.enableSelectionBetweenSlides&&t._insertBetweenSlidesIndexVMDB.addBinding({target:n}),(t.m_slideGridSettings.enableRevisionTrackingInfo||t.m_slideGridSettings.isDisplayPresenceIcon)&&t._shouldDisplayCollabMarkersHintVMDB.addBinding({target:n}),i+=1,t.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&n.onCurrentActiveSectionChanged.subscribe((function(e,i){i.hasFocus?t.currentActiveSectionIndex=i.sectionIndex:t.currentActiveSectionIndex=-1}))})),this._sectionViewModelList.length>i&&(this._sectionViewModelList.slice(i).forEach((function(e){e.dispose()})),this._sectionViewModelList=this._sectionViewModelList.slice(0,i))},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._sectionViewModelList=[]},Object.defineProperty(t.prototype,"visibleSlideRange",{get:function(){var e=this,t=[];return this._sectionViewModelList.forEach((function(i){var n=e._view.renderAreaRect,r=i.getVisibleSlideRange(n);t=t.concat(r)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedSlidesContentAreaRect",{get:function(){var e=[];return this._sectionViewModelList.forEach((function(t){var i=t.getSelectedSlidesContentAreaRect();e=e.concat(i)})),e},enumerable:!1,configurable:!0}),t.prototype.ctrlArrowKeyHandler=function(e){if(e.moveType===u.SlideMoveType.MoveSlideUp||e.moveType===u.SlideMoveType.MoveSlideToStart||e.moveType===u.SlideMoveType.MoveSlideDown||e.moveType===u.SlideMoveType.MoveSlideToEnd){var t=this.sectionDataList.length,i=this.slideDataList.length;if(0<=this.currentActiveSectionIndex&&this.currentActiveSectionIndex<t)return void(e.moveType!==u.SlideMoveType.MoveSlideUp&&e.moveType!==u.SlideMoveType.MoveSlideDown||this._events.onMoveSection.signal(null,{sectionIndex:this.currentActiveSectionIndex,moveType:e.moveType===u.SlideMoveType.MoveSlideUp?u.SectionMoveType.MoveSectionUp:u.SectionMoveType.MoveSectionDown}));var n=this.currentSelectedSlideIndexes;if(!n||!n.length)return;if(1<this.currentSelectedSlideIndexes.length)return void(m.ChangeGate.isChangeGateEnabled("MultipleSlideReOrdering")&&this.multipleSlideReordering(e));if(0==this.activeFocusSlideIndex&&0==this.slideDataList[this.activeFocusSlideIndex].sectionIndex&&(e.moveType==u.SlideMoveType.MoveSlideUp||e.moveType==u.SlideMoveType.MoveSlideToStart))return;if(this.activeFocusSlideIndex==i-1&&this.slideDataList[this.activeFocusSlideIndex].sectionIndex==t-1&&(e.moveType==u.SlideMoveType.MoveSlideDown||e.moveType==u.SlideMoveType.MoveSlideToEnd))return;var r=this.currentSelectedSlideIndexes,o=this.activeFocusSlideIndex,s=!0,a=this.activeFocusSlideIndex,l=-1;switch(e.moveType){case u.SlideMoveType.MoveSlideUp:0==this.activeFocusSlideIndex&&0<this.slideDataList[this.activeFocusSlideIndex].sectionIndex?(o=a=0,l=this.slideDataList[this.activeFocusSlideIndex].sectionIndex-1,s=!1):this.slideDataList[this.activeFocusSlideIndex].sectionIndex!=this.slideDataList[this.activeFocusSlideIndex-1].sectionIndex?(a=0<this.activeFocusSlideIndex?this.activeFocusSlideIndex-1:this.activeFocusSlideIndex,o=(s=0<this.activeFocusSlideIndex)?a+1:a,l=this.slideDataList[this.activeFocusSlideIndex].sectionIndex-1):(o=a=this.activeFocusSlideIndex-1,l=this.slideDataList[this.activeFocusSlideIndex].sectionIndex,s=!1);break;case u.SlideMoveType.MoveSlideDown:this.activeFocusSlideIndex==i-1&&this.slideDataList[this.activeFocusSlideIndex].sectionIndex<t-1?(o=1+(a=this.activeFocusSlideIndex-1),l=this.slideDataList[this.activeFocusSlideIndex].sectionIndex+1):this.slideDataList[this.activeFocusSlideIndex].sectionIndex==this.slideDataList[this.activeFocusSlideIndex+1].sectionIndex?(o=a=this.activeFocusSlideIndex+1,l=this.slideDataList[this.activeFocusSlideIndex].sectionIndex):(a=0<this.activeFocusSlideIndex?this.activeFocusSlideIndex-1:0,l=this.slideDataList[this.activeFocusSlideIndex].sectionIndex+1,o=(s=0<this.activeFocusSlideIndex)?a+1:a);break;case u.SlideMoveType.MoveSlideToStart:l=a=0,o=a,s=!1;break;case u.SlideMoveType.MoveSlideToEnd:o=a=i-1,l=t-1;break;default:return}return this._events.onMoveSlide.signal(null,{dropTargetIndex:a,dragStartIndexes:r,sectionIndex:l,shouldInsertSlideAfter:s}),this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,void(this.activeFocusSlideIndex=o)}},t.prototype.isContinuous=function(e){return e[e.length-1]-e[0]==e.length-1},t.prototype.belongToSameSection=function(e){return this.slideDataList[e[0]].sectionIndex===this.slideDataList[e[e.length-1]].sectionIndex},t.prototype.multipleSlideReordering=function(e){for(var t=this.sectionDataList.length,i=this.slideDataList.length,n=this.currentSelectedSlideIndexes.length,r=this.currentSelectedSlideIndexes.slice().sort((function(e,t){return e-t})),o=r[0],s=r[n-1],a=-1,l=0;l<n;l++)if(r[l]==this.activeFocusSlideIndex){a=l;break}if((!(1<this.currentSelectedSlideIndexes.length)||this.belongToSameSection(r)&&this.isContinuous(r))&&(0!=o||0!=this.slideDataList[o].sectionIndex||e.moveType!=u.SlideMoveType.MoveSlideUp&&e.moveType!=u.SlideMoveType.MoveSlideToStart)&&(s!=i-1||this.slideDataList[s].sectionIndex!=t-1||e.moveType!=u.SlideMoveType.MoveSlideDown&&e.moveType!=u.SlideMoveType.MoveSlideToEnd)){var d=!0,c=-1,g=-1,p=e.moveType==u.SlideMoveType.MoveSlideUp||e.moveType==u.SlideMoveType.MoveSlideToStart?r[0]:r[r.length-1];switch(e.moveType){case u.SlideMoveType.MoveSlideUp:var h=0==p||this.slideDataList[p].sectionIndex!=this.slideDataList[p-1].sectionIndex;c=h?p:p-1,g=h?this.slideDataList[p].sectionIndex-1:this.slideDataList[p].sectionIndex,d=!1;break;case u.SlideMoveType.MoveSlideDown:p==i-1&&this.slideDataList[p].sectionIndex<t-1?(c=p=r[0],g=this.slideDataList[p].sectionIndex+1,d=!1):this.slideDataList[p].sectionIndex==this.slideDataList[p+1].sectionIndex?(c=p+1,g=this.slideDataList[p].sectionIndex):(c=0<(p=r[0])?p-1:0,g=this.slideDataList[p].sectionIndex+1,d=0<p);break;case u.SlideMoveType.MoveSlideToStart:g=c=0,d=!1;break;case u.SlideMoveType.MoveSlideToEnd:c=i-1,g=t-1;break;default:return}this._events.onMoveSlide.signal(null,{dropTargetIndex:c,dragStartIndexes:this.currentSelectedSlideIndexes,sectionIndex:g,shouldInsertSlideAfter:d}),this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,this.activeFocusSlideIndex=this._currentSelectedSlideIndexes[a]}},t.prototype.currentActiveFocusChangedHandler=function(e){var t=e.focusMoveType;if(this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this.copilotUXHasFocus)t===u.FocusMoveType.Up?(this.activeFocusSlideIndex=0,this.currentSelectedSlideIndexes=[0],this.copilotUXHasFocus=!1):t===u.FocusMoveType.Down&&(this.slideDataList.length<=1||(this.activeFocusSlideIndex=1,this.currentSelectedSlideIndexes=[1],this.copilotUXHasFocus=!1));else{this.m_slideGridSettings.isRTL&&(t===u.FocusMoveType.Left?t=u.FocusMoveType.Right:t===u.FocusMoveType.Right&&(t=u.FocusMoveType.Left));var i=this.activeFocusSlideIndex,n=!1;if(this.m_slideGridSettings.enableSelectionBetweenSlides){if(this.insertBetweenSlidesIndex===this.slideDataList.length&&(t===u.FocusMoveType.Down||t===u.FocusMoveType.Right)&&this.slideDataList[this.slideDataList.length-1].sectionIndex===this.sectionDataList[this.sectionDataList.length-1].sectionIndex)return;this.activeFocusSlideIndex<0&&0<=this.insertBetweenSlidesIndex&&(i=0===this.insertBetweenSlidesIndex?0:this.insertBetweenSlidesIndex-1,n=!0)}var r=i;if(!n||!(t===u.FocusMoveType.Left||this.m_slideGridSettings.isDisplayVertical&&t===u.FocusMoveType.Up)||0===r){if(this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&this.shouldDisplaySections){var o=void 0===this.currentActiveSectionIndex?-1:this.currentActiveSectionIndex,s=o,a=this.m_slideGridFocusMoveUtils.handleSectionFocusMove(t,i,o,this.slideCapacityPerRow,this.slideDataList,this.sectionDataList);if(this.currentActiveSectionIndex=a,this.currentActiveSectionIndex!==s||0===this.currentActiveSectionIndex||this.currentActiveSectionIndex===this.sectionDataList.length-1){var d=this.m_slideGridFocusMoveUtils.handleSlideFocusMoveFromSectionFocus(t,s,this.currentActiveSectionIndex,this.slideDataList,this.sectionDataList);return this._events.onSlideSelectionChanged.signal(null,{slideIndex:d,slideSelectionTrigger:l.SlideSelectionTrigger.ActiveSectionChange}),this._events.onSectionSelectionChanged.signal(null,{clickedAway:this.currentActiveSectionIndex<0,sectionSelectionTrigger:l.SectionSelectionTrigger.ActiveSectionChange,sectionIndex:this.currentActiveSectionIndex}),void this._events.onActiveSectionFocusChanged.signal(null,{currentActiveFocusSectionIndex:this.currentActiveSectionIndex,newActiveSlideIndex:d})}}r=t===u.FocusMoveType.Start?0:t===u.FocusMoveType.End?this.slideDataList.length-1:this.m_slideGridFocusMoveUtils.handleSlideFocusMove(t,i,this.slideCapacityPerRow,this.slideDataList,this.sectionDataList)}-1<r&&(this.m_slideGridSettings.enableTriggerSelectionFromActiveSlideChange?this._events.onSlideSelectionChanged.signal(null,{slideIndex:r,slideSelectionTrigger:l.SlideSelectionTrigger.ActiveSlideChange}):this.activeFocusSlideIndex=r)}},t.prototype.dragDropOperationCompletedHandler=function(e){if(e.hasValidDropTarget){if(1===e.dropTargetObjectDataList.length&&e.dropTargetObjectDataList[0].dragDropObjectType===h.DragDropObjectType.Section){var t=this._sectionViewModelList[e.dropTargetObjectDataList[0].index],i=null==t.slideDataList||0===t.slideDataList.length;if(e.dropTargetObjectDataList[0].dragDropObjectType===h.DragDropObjectType.Section)if(i){var n=e.draggableObjectDataList.map((function(e){return e.index})),r=e.dropTargetObjectDataList[0].index;this.handleDragDropIntoEmptySection(n,r)}else{var o=e.draggableObjectDataList.map((function(e){return e.index})),s=t.slideDataList[t.slideDataList.length-1].slideOrderIndex,a=g.DataUtils.NearestPreviousNonSourceSlide(this._slideDataList,o,s),l=!0;r=0<=t.sectionIndex?t.sectionIndex:-1,this._events.onMoveSlide.signal(null,{dropTargetIndex:a,dragStartIndexes:o,sectionIndex:r,shouldInsertSlideAfter:l})}}else{for(var d=-1,c=0;c<e.dropTargetObjectDataList.length;c+=1)e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.Section&&(d=c);if(-1===d)return;for(c=0;c<e.dropTargetObjectDataList.length;c+=1)if(e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.Slide||e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.SlidePlaceholder){o=e.draggableObjectDataList.map((function(e){return e.index})),a=e.dropTargetObjectDataList[c].index;var u=g.DataUtils.isFirstSlideOfSection(this.slideDataList,a),m=e.dropTargetObjectDataList[d].index;if(l=void 0,e.dropTargetObjectDataList[c].dragDropObjectType===h.DragDropObjectType.SlidePlaceholder){var v=a-1;l=null!=this.slideDataList[v],null!=this.slideDataList[v]&&(a=v)}else l=!(u&&e.dropContainerPositionList[c]===p.DropContainerPosition.ContainerLeft);a=g.DataUtils.NearestPreviousNonSourceSlide(this._slideDataList,o,a),this._events.onMoveSlide.signal(null,{dropTargetIndex:a,dragStartIndexes:o,sectionIndex:m,shouldInsertSlideAfter:l});break}}this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,this.activeFocusSlideIndex=this._currentSelectedSlideIndexes[0]}},t.prototype.handleDragDropIntoEmptySection=function(e,t){if(null!=this._sectionDataList[t]&&(null==!this._sectionDataList[t].slideIdList||0===this._sectionDataList[t].slideIdList.length)){var i=g.DataUtils.NearestPreviousNonSourceSlideBySection(this._slideDataList,this._sectionDataList,e,t);this._events.onMoveSlide.signal(null,{dragStartIndexes:e,dropTargetIndex:i,sectionIndex:t,shouldInsertSlideAfter:0<i})}},Object.defineProperty(t.prototype,"slideCapacityPerRow",{get:function(){for(var e=this._view.renderAreaRect,t=-1,i=0,n=this._sectionViewModelList;i<n.length&&!(0<(t=n[i].getSlideCapacityPerRow(e)));i++);return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"copilotUXHasFocus",{get:function(){return this._copilotUXHasFocus},set:function(e){this._copilotUXHasFocus=e},enumerable:!1,configurable:!0}),t}(a.ViewModel);t.SectionListViewModel=v},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.SectionListView=void 0;var o=i(2),s=i(3),a=i(20),l=i(10),d=i(11),c=i(0),u=i(12),g=i(1),p=i(4),h=function(e){function t(t,i,n){var r=e.call(this,i)||this;r.visibleStyleClassName="section-list-view-visible-class",r.visibleStyleZeroSectionVerticalThumbClassName="section-list-view-visible-zero-vertical-thumbnail-section-class",r.hiddenStyleClassName="section-list-view-hidden-class",r.rtlStyleClassName="rtl-class",r.displayHorizontalStyleClassName="display-horizontal-class",r.highContrastBlackModeClassName="slidegrid-high-contrast-black",r._elementId="section-list-view-id".concat((0,p.v4)()),r._highContrastMode=l.SlideGridHighContrastMode.None,r._container.id=r._elementId,r._container.classList.add(r.visibleStyleClassName),r._onViewAreaChanged=new o.Event,r._onViewScrolled=new o.Event,r._onCurrentActiveFocusChanged=new o.Event,r._onEnterKey=new o.Event,r._onCtrlAKey=new o.Event,r._onCtrlArrowKey=new o.Event,r._onShiftArrowKey=new o.Event,r._onShiftHomeKey=new o.Event,r._onShiftEndKey=new o.Event,r._onTabKey=new o.Event,r._events=n,r.slideGridSettings=t,r.slideGridSettings.isRTL&&r._container.classList.add(r.rtlStyleClassName),r.slideGridSettings.isDisplayHorizontal&&r._container.classList.add(r.displayHorizontalStyleClassName),new c.ViewBinding(r,"highContrastMode").addBinding({element:r._parent,onValueChanged:r.handleHighContrastModeChange.bind(r)});var s=function(e){null!=e&&e.preventDefault(),r._onViewAreaChanged.signal(null,null)},h=function(e){null!=e&&e.preventDefault(),r._events.onVisibleSlideRangeChanged.signal(null,{eventName:e.type})};return t.isMobileScreenReader?(r._container.setAttribute("role","menu"),r._container.setAttribute("aria-label",t.mobileThumbnailSlideAriaLabel)):(r._container.setAttribute("role","listbox"),t.isUsingSlideGridInThumbnail&&t.thumbnailSlideSorterListBoxAriaLabel&&r._container.setAttribute("aria-label",t.thumbnailSlideSorterListBoxAriaLabel)),r.slideGridSettings.isUsingSlideGridInThumbnail&&g.ChangeGate.isChangeGateEnabled("ScrollFixInNewPane")?(r._container.addEventListener("scroll",h),window.addEventListener("resize",h)):(r._container.addEventListener("scroll",a.EventThrottlerFactory.CreateThrottler(s,r.slideGridSettings.throttleTimeoutInMs).bind(r)),r._container.addEventListener("scroll",a.EventDebouncerFactory.CreateDebouncer(s,r.slideGridSettings.debounceWaitTimeInMs).bind(r)),g.ChangeGate.isChangeGateEnabled("SG.FrequentScrollEvent")&&r._container.addEventListener("scroll",a.EventThrottlerFactory.CreateThrottler((function(e){null!=e&&e.preventDefault(),r._onViewScrolled.signal(null,null)}),u.Settings.readNumberOrDefault("gridViewScrollThrottleTimeoutMs",100)).bind(r)),window.addEventListener("resize",a.EventThrottlerFactory.CreateThrottler(s,r.slideGridSettings.throttleTimeoutInMs).bind(r)),window.addEventListener("resize",a.EventDebouncerFactory.CreateDebouncer(s,r.slideGridSettings.debounceWaitTimeInMs).bind(r))),r._container.addEventListener("keydown",(function(e){var t=e.key.toLowerCase(),i=e.shiftKey,n=e.ctrlKey;switch(t){case"up":case"arrowup":e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail?!n&&i&&r.slideGridSettings.allowMultipleSelect?r._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Up}):n&&!i?r._onCtrlArrowKey.signal(null,{moveType:d.SlideMoveType.MoveSlideUp}):n&&i?r._onCtrlArrowKey.signal(null,{moveType:d.SlideMoveType.MoveSlideToStart}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Up}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Up});break;case"down":case"arrowdown":e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail?!n&&i&&r.slideGridSettings.allowMultipleSelect?r._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Down}):n&&!i?r._onCtrlArrowKey.signal(null,{moveType:d.SlideMoveType.MoveSlideDown}):n&&i?r._onCtrlArrowKey.signal(null,{moveType:d.SlideMoveType.MoveSlideToEnd}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Down}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Down});break;case"left":case"arrowleft":e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail||(i&&r.slideGridSettings.allowMultipleSelect?r._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Left}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Left}));break;case"right":case"arrowright":e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail||(i&&r.slideGridSettings.allowMultipleSelect?r._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Right}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Right}));break;case"enter":r.copilotUXHasFocus&&r.slideGridSettings.isUsingSlideGridInThumbnail||e.preventDefault(),r._onEnterKey.signal(null,null);break;case"a":e.preventDefault(),n&&r.slideGridSettings.allowMultipleSelect&&r._onCtrlAKey.signal(null,null);break;case"tab":if(r.slideGridSettings.allowDefaultTabBehavior)break;e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail&&r._onTabKey.signal(null,{isShiftKey:i});break;case"pagedown":e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail&&(i?r._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Down}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Down}));break;case"pageup":e.preventDefault(),r.slideGridSettings.isUsingSlideGridInThumbnail&&(i?r._onShiftArrowKey.signal(null,{focusMoveType:d.FocusMoveType.Up}):r._onCurrentActiveFocusChanged.signal(null,{focusMoveType:d.FocusMoveType.Up}));break;case"home":r.slideGridSettings.isUsingSlideGridInThumbnail&&i&&(e.preventDefault(),r.slideGridSettings.allowMultipleSelect&&r._onShiftHomeKey.signal(null,null));break;case"end":r.slideGridSettings.isUsingSlideGridInThumbnail&&i&&(e.preventDefault(),r.slideGridSettings.allowMultipleSelect&&r._onShiftEndKey.signal(null,null))}})),r.slideGridSettings.isDisplayHorizontal&&r.slideGridSettings.allowHorizontalScrollWithMouseWheel&&r._container.addEventListener("wheel",(function(e){var t=e.deltaY<0&&0<r._container.scrollLeft,i=0<e.deltaY&&r._container.scrollLeft<r._container.scrollWidth-r._container.clientWidth;(t||i)&&(e.preventDefault(),r._container.scrollLeft+=e.deltaY)})),r}return r(t,e),Object.defineProperty(t.prototype,"onViewAreaChanged",{get:function(){return this._onViewAreaChanged},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onViewScrolled",{get:function(){return this._onViewScrolled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCurrentActiveFocusChanged",{get:function(){return this._onCurrentActiveFocusChanged},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onEnterKey",{get:function(){return this._onEnterKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCtrlAkey",{get:function(){return this._onCtrlAKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCtrlArrowKey",{get:function(){return this._onCtrlArrowKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onShiftArrowKey",{get:function(){return this._onShiftArrowKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onShiftHomeKey",{get:function(){return this._onShiftHomeKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onShiftEndKey",{get:function(){return this._onShiftEndKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTabKey",{get:function(){return this._onTabKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){var e=this._parent.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}},enumerable:!1,configurable:!0}),t.prototype.handleHighContrastModeChange=function(e){switch(e){case l.SlideGridHighContrastMode.None:this._parent.classList.remove(this.highContrastBlackModeClassName),this._container.classList.remove(this.highContrastBlackModeClassName);break;case l.SlideGridHighContrastMode.HighContrastBlack:this._parent.classList.add(this.highContrastBlackModeClassName),this._container.classList.add(this.highContrastBlackModeClassName)}},t.prototype.setZeroSectionVerticalThumbnailClass=function(e){e<=1?this._container.classList.add(this.visibleStyleZeroSectionVerticalThumbClassName):this._container.classList.remove(this.visibleStyleZeroSectionVerticalThumbClassName)},t}(s.View);t.SectionListView=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDebouncerFactory=t.EventThrottlerFactory=void 0;var n=function(){function e(){}return e.CreateThrottler=function(e,t){var i=0;return function(n){(0===i||i+t-Date.now()<0)&&(e(n),i=Date.now())}},e}();t.EventThrottlerFactory=n;var r=function(){function e(){}return e.CreateDebouncer=function(e,t){var i;return function(n){clearTimeout(i),i=setTimeout((function(){e(n)}),t)}},e}();t.EventDebouncerFactory=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var n=function(){function e(){}return e.load=function(t){for(var i in t)e.m_settings[i]=t[i]},e.readBooleanOrDefault=function(t,i){var n=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===n?"true"===e.m_settings[t].toLowerCase():"boolean"===n?e.m_settings[t]:i},e.readNumberOrDefault=function(t,i){var n=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===n||"number"===n?Number(e.m_settings[t]):i},e.readStringOrDefault=function(t,i){return void 0===e.m_settings||"string"!=typeof e.m_settings[t]?i:e.m_settings[t]},e.addOrUpdateSettingsFromUrl=function(t,i){var n=i.get("wdset");if(!n)return t;for(var r=0,o=n.split(",");r<o.length;r++){var s=o[r].split(":"),a=s[0].split("."),l=a[0],d=a[1],c=s[1];d&&c&&e.addOrUpdateSetting(t,l,d,c)}return t},e.addOrUpdateSetting=function(e,t,i,n){"__proto__"!==t&&(e[t]||(e[t]={}),e[t][i]=n)},e.m_settings={},e}();t.Settings=n},function(e,t,i){var n,r,o=i(13),s=i(14),a=0,l=0;e.exports=function(e,t,i){var d=t&&i||0,c=t||[],u=(e=e||{}).node||n,g=void 0!==e.clockseq?e.clockseq:r;if(null==u||null==g){var p=o();null==u&&(u=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==g&&(g=r=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:l+1,v=h-a+(m-l)/1e4;if(v<0&&void 0===e.clockseq&&(g=g+1&16383),(v<0||a<h)&&void 0===e.nsecs&&(m=0),1e4<=m)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=h,r=g;var _=(1e4*(268435455&(h+=122192928e5))+(l=m))%4294967296;c[d++]=_>>>24&255,c[d++]=_>>>16&255,c[d++]=_>>>8&255,c[d++]=255&_;var f=h/4294967296*1e4&268435455;c[d++]=f>>>8&255,c[d++]=255&f,c[d++]=f>>>24&15|16,c[d++]=f>>>16&255,c[d++]=g>>>8|128,c[d++]=255&g;for(var S=0;S<6;++S)c[d+S]=u[S];return t||s(c)}},function(e,t,i){var n=i(13),r=i(14);e.exports=function(e,t,i){var o=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||r(s)}},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.SectionViewModel=void 0;var o=i(26),s=i(27),a=i(0),l=i(5),d=i(2),c=i(6),u=function(e){function t(t,i,n,r){var l=e.call(this,i)||this;l.m_dragDropCompletedHandlerBound=l.dragDropCompletedHandler.bind(l),l.m_dragDropMoveOverHandlerBound=l.dragDropMoveOverHandler.bind(l),l.m_dragDropMoveHandlerBound=l.dragDropMoveHandler.bind(l),l._events=n,l.m_slideGridSettings=t,l.m_dragDropManager=r,l.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(l.m_currentActiveSectionChangedEvent=new d.Event),l._view=new o.SectionView(t,i),l._gridListViewModel=new s.GridListViewModel(l.m_slideGridSettings,l._view.container,l._events,l.m_dragDropManager),new a.ViewModelBinding(l,"sectionTitle").addBinding({target:l._view}),new a.ViewModelBinding(l,"currentSelectedSlideIndexes").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"insertBetweenSlidesIndex").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"totalSlideCount").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"activeSectionIndex").addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"isSelected").addBinding({target:l._view}),new a.ViewModelBinding(l,"titleEditMode").addBinding({target:l._view});var u=new a.ViewModelBinding(l,"shouldDisplaySection");u.addBinding({target:l._view}),u.addBinding({target:l._gridListViewModel}),new a.ViewModelBinding(l,"activeFocusSlideIndex").addBinding({target:l._gridListViewModel}),l.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&new a.ViewModelBinding(l,"currentActiveSectionIndex").addBinding({target:l._view});var g=new a.ViewModelBinding(l,"sectionIndex");return g.addBinding({target:l._gridListViewModel,onValueChanged:function(e){l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer.objectData.index=e)}}),g.addBinding({target:l._view}),l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer=l.m_dragDropManager.addNewDropContainer(l._view.container,new c.ObjectData(c.DragDropObjectType.Section,l.sectionIndex)),l.m_dragDropManager.dragDropOperationCompletedEvent.subscribe(l.m_dragDropCompletedHandlerBound),l.m_dragDropManager.dragDropMoveOverEvent.subscribe(l.m_dragDropMoveOverHandlerBound),l.m_dragDropManager.dragDropMoveEvent.subscribe(l.m_dragDropMoveHandlerBound),l.m_draggingSlideIndexes=[]),t.allowSectionEdit&&(l._view.onViewUpdateSectionTitle.subscribe((function(e,t){t&&l._events.onSectionTitleUpdate.signal(null,{sectionIndex:l.sectionIndex,sectionTitleBefore:t.sectionTitleBefore,sectionTitleAfter:t.sectionTitleAfter})})),l._view.onViewSelectSection.subscribe((function(e,t){l._events.onSectionSelectionChanged.signal(null,{clickedAway:t.clickedAway,sectionSelectionTrigger:t.sectionSelectionTrigger,sectionIndex:l.sectionIndex})}))),t.allowSectionsInKeyboardFocusOrdering&&l._view.onCurrentActiveSectionChanged.subscribe((function(e,t){l.m_currentActiveSectionChangedEvent.signal(null,t)})),l}return r(t,e),Object.defineProperty(t.prototype,"presenceInfoList",{get:function(){return this._presenceInfoList},set:function(e){this._presenceInfoList=e,this._gridListViewModel.presenceInfoList=this._presenceInfoList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplayCollabMarkersHint",{get:function(){return this._shouldDisplayCollabMarkersHint},set:function(e){this._shouldDisplayCollabMarkersHint=e,this._gridListViewModel.shouldDisplayCollabMarkersHint=this._shouldDisplayCollabMarkersHint},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slideDataList",{get:function(){return this._gridListViewModel.slideDataList},set:function(e){this.m_slideGridSettings.isHideEmptySection&&0===e.length&&(this._view.shouldDisplaySection=!1),this._gridListViewModel.slideDataList=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplaySection",{set:function(e){this.m_slideGridSettings.isHideEmptySection&&0===this.slideDataList.length?this._view.shouldDisplaySection=!1:this._shouldDisplaySection=e},enumerable:!1,configurable:!0}),t.prototype.updateSlideData=function(e){return this._gridListViewModel.updateSlideData(e)},t.prototype.getVisibleSlideRange=function(e){return this._gridListViewModel.getVisibleSlideRange(e)},t.prototype.getSlideCapacityPerRow=function(e){return this._gridListViewModel.getSlideCapacityPerRow(e)},t.prototype.getSelectedSlidesContentAreaRect=function(){return this._gridListViewModel.getSelectedSlidesContentAreaRect()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&(this.m_dragDropManager.removeDropContainer(this.m_dropContainer),this.m_dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveOverEvent.unsubscribe(this.m_dragDropMoveOverHandlerBound),this.m_dragDropManager.dragDropMoveEvent.unsubscribe(this.m_dragDropMoveHandlerBound))},t.prototype.dragDropMoveOverHandler=function(e,t){!t.hasValidDropTarget||null!=this.slideDataList&&this.slideDataList.length-this.m_draggingSlideIndexes.length!=0||t.dropTargetObjectData.index!==this.sectionIndex||t.dropTargetObjectData.dragDropObjectType!==c.DragDropObjectType.Section?this._view.isDragOver=!1:this._view.isDragOver=!0},t.prototype.dragDropMoveHandler=function(e,t){t.draggableObjectData&&null!=t.draggableObjectData.index&&-1===this.m_draggingSlideIndexes.indexOf(t.draggableObjectData.index)&&0<=this.slideDataList.map((function(e){return e.slideOrderIndex})).indexOf(t.draggableObjectData.index)&&this.m_draggingSlideIndexes.push(t.draggableObjectData.index)},t.prototype.dragDropCompletedHandler=function(e,t){this._view.isDragOver=!1,this.m_draggingSlideIndexes=[]},Object.defineProperty(t.prototype,"onCurrentActiveSectionChanged",{get:function(){return this.m_currentActiveSectionChangedEvent},enumerable:!1,configurable:!0}),t}(l.ViewModel);t.SectionViewModel=u},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.SectionView=void 0;var o=i(0),s=i(3),a=i(2),l=i(7),d=i(4),c=i(1),u=function(e){function t(t,i){var n=e.call(this,i)||this;return n.visibleStyleClassName="section-view-visible-class",n.sectionTitleDefaultClassName="section-view-title-default-class",n.sectionTitleEditClassName="section-view-edit-title-class",n.verticalSectionTitleEditClassName="section-view-edit-title-vertical-class",n.sectionTitleInputClassName="section-view-title-input-class",n.sectionTitleSpanClassName="section-view-title-span-class",n.sectionTitleVerticalSpanClassName="section-view-vertical-title-span-class",n.sectionDragOverDivClassName="section-view-drag-over-div-class",n.sectionDragOverDivVisibleClassName="section-view-drag-over-div-visible-class",n.sectionTitleFocusStyleClassName="section-view-title-focus-class",n.sectionTitleSelectedClassName="section-view-title-selected-class",n.editableSectionGridStyleClassName="section-content-editable-cursor-hide-class",n.sectionSpanClassName="section-span-class",n.sectionTitleInputDblClickColorName="rgba(255, 255, 255, 0.7)",n.sectionTitleInputDblClickBorderName="1px solid rgb(200, 198, 196)",n._elementId="section-view-id".concat((0,d.v4)()),n.m_isSectionPasteEnabled=!1,n.m_slideGridSettings=t,n._container.id=n._elementId,n._container.className=n.visibleStyleClassName,t.isUsingSlideGridInThumbnail&&t.isPasteViaKeyboardEnabled&&c.ChangeGate.isChangeGateEnabled("SectionPasteSupport")&&t.allowSectionEdit&&(n.m_isSectionPasteEnabled=!0),n.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(n.m_onCurrentActiveSectionChanged=new a.Event),n.createBasicSectionDom(),n.m_slideGridSettings.allowSectionEdit&&n.createSectionDomWithEdit(),n}return r(t,e),Object.defineProperty(t.prototype,"onViewUpdateSectionTitle",{get:function(){return this.m_viewUpdateSectionTitle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onViewSelectSection",{get:function(){return this.m_viewSelectSection},enumerable:!1,configurable:!0}),t.prototype.createBasicSectionDom=function(){var e=this;this.m_sectionTitleDiv=document.createElement("div"),this.m_sectionTitleSpan=document.createElement("span"),this.m_slideGridSettings.disableAutomaticTabStops||(this.m_sectionTitleSpan.tabIndex=0,this.m_sectionTitleSpan.setAttribute("aria-hidden","false")),this.m_isSectionPasteEnabled&&(this.m_sectionSpan=document.createElement("span"),this.m_slideGridSettings.disableAutomaticTabStops||(this.m_sectionSpan.tabIndex=0,this.m_sectionSpan.setAttribute("aria-hidden","false")),this.m_sectionSpan.className=this.sectionSpanClassName,this._spanElement=document.createElement("span"),this._spanElement.innerText=".",this._spanElement.ariaReadOnly="false",this._spanElement.contentEditable="true",this._spanElement.ariaHidden="true",this.m_sectionTitleSpan.appendChild(this._spanElement),this.m_sectionTitleSpan.appendChild(this.m_sectionSpan),this.m_sectionTitleSpan.setAttribute("contenteditable","true")),this.m_sectionTitleDiv.className=this.sectionTitleDefaultClassName,this.m_sectionTitleDiv.appendChild(this.m_sectionTitleSpan),this._activeSpan=this.m_isSectionPasteEnabled?this.m_sectionSpan:this.m_sectionTitleSpan,new o.ViewBinding(this,"sectionTitle").addBinding({element:this._activeSpan,attribute:"innerText",onValueChanged:function(t){e.m_sectionTitleSpan.setAttribute("aria-label",t)}}),new o.ViewBinding(this,"isSelected").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){t?e.m_sectionTitleDiv.classList.add(e.sectionTitleSelectedClassName):e.m_sectionTitleDiv.classList.remove(e.sectionTitleSelectedClassName)}}),new o.ViewBinding(this,"shouldDisplaySection").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){e.m_sectionTitleDiv.style.display=t?"block":"none",t?(e.m_isSectionPasteEnabled&&e.m_sectionSpan.setAttribute("aria-hidden","false"),e.m_sectionTitleSpan.setAttribute("aria-hidden","false"),e.m_sectionTitleSpan.setAttribute("aria-label",e._sectionTitle),e._container.setAttribute("aria-hidden","false")):(e.m_isSectionPasteEnabled&&e.m_sectionSpan.setAttribute("aria-hidden","true"),e.m_sectionTitleSpan.setAttribute("aria-hidden","true"),e.m_slideGridSettings.isUsingSlideGridInThumbnail||e._container.setAttribute("aria-hidden","true"))}}),new o.ViewBinding(this,"titleEditMode").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){t&&e.enableEditMode()}}),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&new o.ViewBinding(this,"currentActiveSectionIndex").addBinding({element:this.m_sectionTitleDiv,onValueChanged:function(t){t===e.sectionIndex?(e.m_sectionTitleSpan.focus(),e.m_sectionTitleDiv.classList.add(e.sectionTitleFocusStyleClassName)):e.m_sectionTitleDiv.classList.remove(e.sectionTitleFocusStyleClassName)}}),new o.ViewBinding(this,"isDragOver").addBinding({element:this.m_sectionDragOverDiv,onValueChanged:function(t){t?e.m_sectionDragOverDiv.classList.add(e.sectionDragOverDivVisibleClassName):e.m_sectionDragOverDiv.classList.remove(e.sectionDragOverDivVisibleClassName)}}),this._container.appendChild(this.m_sectionTitleDiv),this._container.classList.add(this.visibleStyleClassName),this.m_slideGridSettings.allowMoveSlide&&(this.m_sectionDragOverDiv=document.createElement("div"),this.m_sectionDragOverDiv.className=this.sectionDragOverDivClassName,this._container.appendChild(this.m_sectionDragOverDiv))},t.prototype.updateSectionTitle=function(){this.isEmptyTitle(this.m_sectionTitleInput.value)||this.m_sectionTitleInput.readOnly?(this._activeSpan.innerText=this.sectionTitle,this.m_sectionTitleInput.readOnly=!0):this.setSectionTitle(),this.m_isSectionPasteEnabled&&this.m_sectionSpan.setAttribute("aria-hidden","false"),this._activeSpan.style.visibility="",this.m_sectionTitleSpan.setAttribute("aria-hidden","false"),this.m_sectionTitleInput.setAttribute("aria-hidden","true")},t.prototype.enableEditMode=function(){this.m_sectionTitleInput.setAttribute("aria-hidden","false"),this.m_sectionTitleInput.readOnly=!1,this.m_sectionTitleInput.style.background=this.sectionTitleInputDblClickColorName,this.m_sectionTitleInput.style.border=this.sectionTitleInputDblClickBorderName,this._activeSpan.setAttribute("aria-hidden","true"),this._activeSpan.style.visibility="hidden",""===this.m_sectionTitleInput.value&&(this.m_sectionTitleInput.value=this.sectionTitle),this.m_sectionTitleInput.select()},t.prototype.isEmptyTitle=function(e){return""===e||0===e.trim().length},t.prototype.setSectionTitle=function(){var e=this.sectionTitle;this.sectionTitle=this.m_sectionTitleInput.value,this.m_sectionTitleInput.value="",this.m_sectionTitleInput.readOnly=!0,this.m_viewUpdateSectionTitle.signal(null,{sectionTitleBefore:e,sectionTitleAfter:this.sectionTitle})},t.prototype.createSectionDomWithEdit=function(){var e=this;this.m_viewUpdateSectionTitle=new a.Event,this.m_viewSelectSection=new a.Event,this.m_sectionTitleDiv.classList.add(this.sectionTitleEditClassName),this.m_slideGridSettings.isDisplayVertical&&this.m_sectionTitleDiv.classList.add(this.verticalSectionTitleEditClassName),this.m_sectionTitleInput=document.createElement("input"),this.m_sectionTitleInput.className=this.sectionTitleInputClassName,this.m_sectionTitleInput.maxLength=this.m_slideGridSettings.sectionTitleMaxLength,this.m_sectionTitleInput.readOnly=!0,this.m_sectionTitleInput.style.width="".concat(this.m_slideGridSettings.slideWidth,"px"),this.m_slideGridSettings.isDisplayVertical?(this.m_sectionTitleSpan.classList.add(this.sectionTitleVerticalSpanClassName),this.m_isSectionPasteEnabled&&(this.m_sectionTitleSpan.setAttribute("contenteditable","true"),this.m_sectionTitleSpan.style.cursor="default",this.m_sectionTitleSpan.classList.add(this.editableSectionGridStyleClassName))):this.m_sectionTitleSpan.classList.add(this.sectionTitleSpanClassName),this.m_sectionTitleDiv.appendChild(this.m_sectionTitleInput),this.m_sectionTitleDiv.classList.remove(this.sectionTitleDefaultClassName),this.m_sectionTitleInput.setAttribute("aria-hidden","true"),this.m_sectionTitleDiv.onclick=function(){e.m_viewSelectSection.signal(null,{clickedAway:!1,sectionSelectionTrigger:l.SectionSelectionTrigger.Click})},this.m_sectionTitleDiv.oncontextmenu=function(){e.m_viewSelectSection.signal(null,{clickedAway:!1,sectionSelectionTrigger:l.SectionSelectionTrigger.RightClick})},this.m_sectionTitleDiv.onmousedown=function(){e.m_mouseDown=!0},this.m_sectionTitleDiv.onmouseup=function(){e.m_mouseDown=!1},this._container.onclick=function(t){t.target!==e.m_sectionTitleDiv&&t.target!==e.m_sectionTitleInput&&t.target!==e._activeSpan&&e.m_viewSelectSection.signal(null,{clickedAway:!0})},this.m_sectionTitleDiv.onfocus=function(t){t.preventDefault(),e.m_mouseDown||e.m_onCurrentActiveSectionChanged.signal(null,{hasFocus:!0,sectionIndex:e.sectionIndex})},this.m_sectionTitleDiv.onblur=function(t){t.preventDefault(),e.m_onCurrentActiveSectionChanged.signal(null,{hasFocus:!1,sectionIndex:e.sectionIndex})},this.m_sectionTitleDiv.ondblclick=function(t){t.preventDefault(),e.enableEditMode()},this.m_sectionTitleInput.onclick=function(e){e.preventDefault()},this.m_sectionTitleInput.onblur=function(t){t.preventDefault(),e.m_sectionTitleInput.style.background="",e.m_sectionTitleInput.style.border="",e.m_sectionTitleInput.readOnly||e.updateSectionTitle()},this.m_sectionTitleInput.onkeyup=function(){e.isEmptyTitle(e.m_sectionTitleInput.value)||(e.sectionTitle=e.m_sectionTitleInput.value)},this.m_isSectionPasteEnabled&&this.m_sectionTitleSpan.addEventListener("input",(function(){e._spanElement.innerText="."})),this.m_sectionTitleInput.onkeydown=function(t){if(!e.m_sectionTitleInput.readOnly){if(13===t.keyCode||27===t.keyCode)e.updateSectionTitle(),e.m_slideGridSettings.isUsingSlideGridInThumbnail&&e.m_sectionTitleSpan.focus(),e.m_sectionTitleInput.style.background="",e.m_sectionTitleInput.style.border="",e.m_slideGridSettings.isPasteViaKeyboardEnabled&&t.preventDefault();else{e.isEmptyTitle(e.m_sectionTitleInput.value)||(e.sectionTitle=e.m_sectionTitleInput.value);var i=null!=e.m_sectionTitleSpan.offsetWidth?e.m_sectionTitleSpan.offsetWidth:0,n=0<i?i.toString():0,r=Number(n)+e.m_sectionTitleInput.offsetHeight,o=null!=e._container.offsetWidth?e._container.offsetWidth:-1,s=0<o?o.toString():"inf";null!=i&&r>e.m_slideGridSettings.slideWidth&&r<=Number(s)?(e.m_sectionTitleInput.style.width="".concat(r,"px"),e._activeSpan.style.overflow=""):r<e.m_slideGridSettings.slideWidth?e.m_sectionTitleInput.style.width="".concat(e.m_slideGridSettings.slideWidth,"px"):r>Number(s)&&(e.m_sectionTitleInput.style.width=s,e._activeSpan.style.width=s,e._activeSpan.style.overflow="hidden")}t.stopPropagation()}}},Object.defineProperty(t.prototype,"onCurrentActiveSectionChanged",{get:function(){return this.m_onCurrentActiveSectionChanged},enumerable:!1,configurable:!0}),t}(s.View);t.SectionView=u},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridListViewModel=void 0;var o=i(28),s=i(29),a=i(5),l=i(38),d=i(15),c=i(6),u=i(0),g=i(8),p=i(4),h=function(e){function t(t,i,n,r){var s=e.call(this,i)||this;s._currentSelectedSlideIndexes=[],s.m_totalSlideCount=0,s.m_firstSlideIndex=-1,s.m_activeSectionIndex=-1,s.m_dragDropMoveOverHandlerBound=s.dragDropMoveOverHandler.bind(s),s.m_dragDropCompletedHandlerBound=s.dragDropCompletedHandler.bind(s),s._events=n,s.m_slideGridSettings=t,s._dragDropManager=r,s.m_slideGridSettings.allowMoveSlide&&(s.m_draggingSlideIndexList=[]),s._view=new o.GridListView(i,t);var a=(0,p.v4)(),l=i.getElementsByTagName("span")[0];return l&&(l.setAttribute("id","".concat(a)),s._view.container.setAttribute("aria-labelledby","".concat(a))),s._gridFrameViewModelList=[],s._dragOverFrameViewModelList=[],s.m_slideGridSettings.enableSelectionBetweenSlides&&s._view.onViewClick.subscribe((function(e,t){var i=s.calculateInsertionIndex(t.clientX,t.clientY);-1!==i&&s._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:i})})),s.m_slideGridSettings.allowMoveSlide&&(s._dragDropManager.dragDropMoveOverEvent.subscribe(s.m_dragDropMoveOverHandlerBound),s._dragDropManager.dragDropOperationCompletedEvent.subscribe(s.m_dragDropCompletedHandlerBound)),s}return r(t,e),t.prototype.updateSlideData=function(e){var t=this._gridFrameViewModelList.find((function(t){return g.DataUtils.isSlideIDPartialEqual(t.slideID,e.slideID)}));if(!t)return!1;t.slideID=e.slideID,t.isHiddenSlide=e.isHiddenSlide,t.contentImage=e.thumbnailImage,t.slideTitle=e.slideTitle,t.slideAriaLabel=e.slideAriaLabel,this.m_slideGridSettings.commentsEnabled&&(t.displayCommentIcon=!1,t.numComments="",null!=e.numComments&&0<e.numComments&&(t.numComments="".concat(e.numComments),t.commentsToolTipValue=e.commentsToolTipValue,t.displayCommentIcon=!0)),this.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&(t.displayTransitionOrAnimationIcon=e.hasTransitionOrAnimation,t.transitionOrAnimationToolTipValue=e.transitionOrAnimationToolTipValue),this.m_slideGridSettings.enableRevisionTrackingInfo&&(t.displayRevisionTrackingInfo=e.hasUnreadChanges);var i=this._slideDataList.findIndex((function(t){return g.DataUtils.isSlideIDPartialEqual(t.slideID,e.slideID)}));return-1!==i&&this._slideDataList.splice(i,1,e),!0},Object.defineProperty(t.prototype,"slideDataList",{get:function(){return this._slideDataList},set:function(e){var t=this;this._slideDataList=e,this.m_slideGridSettings.allowMoveSlide&&(this.m_draggingSlideIndexList=[]),0===this.sectionIndex&&0===this._slideDataList.length&&this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isVisible=!1);var i=0;if(this._slideDataList.forEach((function(e){var n,r;if(0===i&&(t.m_firstSlideIndex=e.slideOrderIndex),0===t.sectionIndex&&t.m_slideGridSettings.enableSelectionBetweenSlides&&0<t._slideDataList.length&&(null==t.m_firstSlideInFirstSectionBoundary&&(t.m_firstSlideInFirstSectionBoundary=new d.GridContentBoundaryViewModel(t._view.container,t.m_slideGridSettings,!0,t._events),new u.ViewModelBinding(t,"shouldDisplaySection").addBinding({target:t.m_firstSlideInFirstSectionBoundary}),t.m_firstSlideInFirstSectionBoundary.shouldDisplaySection=t.shouldDisplaySection,t.m_firstSlideInFirstSectionBoundary.slideIndex=0),t.m_firstSlideInFirstSectionBoundary.isVisible=!0),null==t._gridFrameViewModelList[i]){var o=void 0;if(0===i&&(o=new l.DragOverFrameViewModel(t.m_slideGridSettings,t._view.container,t._dragDropManager,e.slideOrderIndex),t._dragOverFrameViewModelList.push(o)),n=new s.GridFrameViewModel(t.m_slideGridSettings,t._view.container,t._events,t._dragDropManager),t._gridFrameViewModelList.push(n),t.m_slideGridSettings.allowMoveSlide){var a=0;0===i&&(a=1),r=new l.DragOverFrameViewModel(t.m_slideGridSettings,t._view.container,t._dragDropManager,e.slideOrderIndex+a),n.onFrameInDragState.subscribe((function(e,i){var n=i.index;t.m_draggingSlideIndexList.push(n)})),t._dragOverFrameViewModelList.push(r)}}else n=t._gridFrameViewModelList[i],t.m_slideGridSettings.allowMoveSlide&&(0===i&&(t._dragOverFrameViewModelList[i].slideIndex=e.slideOrderIndex,null!=t._dragOverFrameViewModelList[i+1]&&(t._dragOverFrameViewModelList[i+1].slideIndex=e.slideOrderIndex+1)),t._dragOverFrameViewModelList[i+1].slideIndex=e.slideOrderIndex+1);n.slideIndex=e.slideOrderIndex,n.slideID=e.slideID,n.isHiddenSlide=e.isHiddenSlide,n.contentImage=e.thumbnailImage,n.slideTitle=e.slideTitle,n.slideAriaLabel=e.slideAriaLabel,n.totalSlideCount=t.m_totalSlideCount,n.displayTransitionOrAnimationIcon=!1,n.displayCommentIcon=!1,n.activeSectionIndex=t.m_activeSectionIndex,n.displayCopilotUXEntryPoint=0===e.slideOrderIndex&&t.m_slideGridSettings.isCopilotUXEntryPointEnabled,t.m_slideGridSettings.commentsEnabled&&(n.displayCommentIcon=!1,n.numComments="",null!=e.numComments&&0<e.numComments&&(n.numComments="".concat(e.numComments),t.m_slideGridSettings.isUsingSlideGridInThumbnail&&(n.commentsToolTipValue=e.commentsToolTipValue),n.displayCommentIcon=!0)),t.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&(n.displayTransitionOrAnimationIcon=e.hasTransitionOrAnimation,t.m_slideGridSettings.isUsingSlideGridInThumbnail&&(n.transitionOrAnimationToolTipValue=e.transitionOrAnimationToolTipValue)),t.m_slideGridSettings.enableRevisionTrackingInfo&&(n.displayRevisionTrackingInfo=e.hasUnreadChanges),i+=1})),this._gridFrameViewModelList.length>i&&(this._gridFrameViewModelList.slice(i).forEach((function(e){e.dispose()})),this._gridFrameViewModelList=this._gridFrameViewModelList.slice(0,i),this.m_slideGridSettings.allowMoveSlide&&this._dragOverFrameViewModelList.length>i+1)){var n=0===i?0:i+1;this._dragOverFrameViewModelList.slice(n).forEach((function(e){e.dispose()})),this._dragOverFrameViewModelList=this._dragOverFrameViewModelList.slice(0,n)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"presenceInfoList",{get:function(){return this._presenceInfoList},set:function(e){this._presenceInfoList=e,this._gridFrameViewModelList.forEach((function(t){var i=e.filter((function(e){return g.DataUtils.isSlideIDEqual(e.slideID,t.slideID)}));t.presenceUserList=i.map((function(e){return e.presenceUser}))}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplayCollabMarkersHint",{get:function(){return this._shouldDisplayCollabMarkersHint},set:function(e){var t=this;this._shouldDisplayCollabMarkersHint=e,this._gridFrameViewModelList.forEach((function(e){var i=e.slideIndex;e.shouldDisplayCollabMarkersHint=!(t._activeFocusSlideIndex!==i||!t._shouldDisplayCollabMarkersHint)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"insertBetweenSlidesIndex",{set:function(e){var t=this;this._gridFrameViewModelList.forEach((function(i){i.isShowingRedLine=e===i.slideIndex+1,t.m_firstSlideInFirstSectionBoundary&&(t.m_firstSlideInFirstSectionBoundary.isSelected=!1)})),0===e&&this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!0)},enumerable:!1,configurable:!0}),t.prototype.calculateInsertionIndex=function(e,t){for(var i=this._gridFrameViewModelList.length-1;0<=i;i-=1)if(e>=this._gridFrameViewModelList[i].renderAreaRect.right&&this._gridFrameViewModelList[i].renderAreaRect.bottom>=t&&this._gridFrameViewModelList[i].renderAreaRect.top<=t)return this._slideDataList[i].slideOrderIndex+1;return-1},Object.defineProperty(t.prototype,"m_currentLastSlideOfSection",{get:function(){var e=this,t=this._slideDataList.map((function(e){return e.slideOrderIndex}));if(this.m_draggingSlideIndexList&&0<this.m_draggingSlideIndexList.length){var i=t.filter((function(t){return e.m_draggingSlideIndexList.indexOf(t)<0}));return i[i.length-1]}return t[t.length-1]},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._gridFrameViewModelList=[],this.m_slideGridSettings.allowMoveSlide&&null!=this._dragDropManager&&(this._dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this._dragDropManager.dragDropMoveOverEvent.unsubscribe(this.m_dragDropMoveOverHandlerBound))},t.prototype.getVisibleSlideRange=function(e){var t=this,i=[];return e.bottom-e.top<=0||e.right-e.left<=0||this._gridFrameViewModelList.forEach((function(n){var r=n.renderAreaRect;if(t.m_slideGridSettings.isDisplayHorizontal){if(r.left>e.right)return;if(r.right<e.left)return}else{if(r.top>e.bottom)return;if(r.bottom<e.top)return}i.push(n.slideID)})),i},t.prototype.getSlideCapacityPerRow=function(e){var t=-1,i=e.right-e.left;if(i<=0)return-1;for(var n=0,r=this._gridFrameViewModelList;n<r.length;n++){var o=r[n].renderAreaRect;if(null!=o){var s=o.right-o.left;if(0<(t=Math.floor(i/s)))break}}return t},t.prototype.getSelectedSlidesContentAreaRect=function(){var e=[];return this._gridFrameViewModelList.forEach((function(t){t.isSelected&&e.push(t.contentAreaRect)})),e},Object.defineProperty(t.prototype,"currentSelectedSlideIndexes",{set:function(e){var t=this;this._currentSelectedSlideIndexes=e,this._gridFrameViewModelList.forEach((function(e){var i=e.slideIndex;e.isSelected=0<=t._currentSelectedSlideIndexes.indexOf(i)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeFocusSlideIndex",{set:function(e){var t=this;this._activeFocusSlideIndex=e,this._gridFrameViewModelList.forEach((function(e){var i=e.slideIndex;e.hasActiveFocus=t._activeFocusSlideIndex===i}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalSlideCount",{set:function(e){this.m_totalSlideCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeSectionIndex",{set:function(e){this.m_activeSectionIndex=e},enumerable:!1,configurable:!0}),t.prototype.dragDropCompletedHandler=function(){this._dragOverFrameViewModelList.forEach((function(e){e.isHidden=!0,e.isShowingDragOverRedLine=!1}))},t.prototype.dragDropMoveOverHandler=function(e,t){var i=this;if(t.hasValidDropTarget){var n=t.dropTargetObjectData.index;if(t.dropTargetObjectData.dragDropObjectType!==c.DragDropObjectType.Section)for(var r=0;r<this._dragOverFrameViewModelList.length;r+=1){var o=n===this._dragOverFrameViewModelList[r].slideIndex&&null!=t.sectionObjectData&&t.sectionObjectData.index===this.sectionIndex;this._dragOverFrameViewModelList[r].isHidden=!o,this._dragOverFrameViewModelList[r].isShowingDragOverRedLine=n===this.m_currentLastSlideOfSection+1&&o}else this._dragOverFrameViewModelList.forEach((function(e){var t=e.slideIndex===i.m_currentLastSlideOfSection+1&&i.sectionIndex===n;e.isHidden=!t,e.isShowingDragOverRedLine=t}))}else this._dragOverFrameViewModelList.forEach((function(e){e.isHidden=!0,e.isShowingDragOverRedLine=!1}))},t}(a.ViewModel);t.GridListViewModel=h},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridListView=void 0;var o=i(3),s=i(2),a=i(4),l=function(e){function t(t,i){var n=e.call(this,t)||this;return n.visibleStyleClassName="grid-list-view-visible-class",n.verticalVisibleStyleClassName="grid-list-view-vertical-visible-class",n._elementId="grid-list-view-id".concat((0,a.v4)()),n._container.id=n._elementId,n._container.classList.add(n.visibleStyleClassName),i.isDisplayVertical&&n._container.classList.add(n.verticalVisibleStyleClassName),n._onViewClick=new s.Event,n.container.onclick=function(e){n.raiseEventFromClick(e)},n.container.oncontextmenu=function(e){e.preventDefault(),n.raiseEventFromClick(e)},n}return r(t,e),t.prototype.raiseEventFromClick=function(e){e.preventDefault();var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null,i=new RegExp("grid-list-view");null!=t&&0<(t.getAttribute("class")||"").search(i)&&this._onViewClick.signal(null,{clientX:e.clientX,clientY:e.clientY})},Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._onViewClick},enumerable:!1,configurable:!0}),t}(o.View);t.GridListView=l},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridFrameViewModel=void 0;var o=i(30),s=i(31),a=i(0),l=i(5),d=i(2),c=i(7),u=i(15),g=i(6),p=i(36),h=i(1),m=function(e){function t(t,i,n,r){var l=e.call(this,i)||this;l.m_dragDropCompletedHandlerBound=l.dragDropCompletedHandler.bind(l),l.m_dragDropMoveHandlerBound=l.dragDropMoveHandler.bind(l),l.m_presenceHoverHandlerBound=l.presenceHoverHandler.bind(l),l._presenceIconExpanded=!1,l._events=n,l.m_dragDropManager=r,l.m_slideGridSettings=t,l._onFrameDragOver=new d.Event,l._onFrameInDragState=new d.Event,l._view=new o.GridFrameView(t,i,l._events),l._gridContentViewModel=new s.GridContentViewModel(l.m_slideGridSettings,l._view.innerContainer,l._events,l.m_dragDropManager),l.m_slideGridSettings.enableSelectionBetweenSlides&&(l._gridContentBoundaryViewModel=new u.GridContentBoundaryViewModel(l._view.container,l.m_slideGridSettings,!1,l._events)),l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer=l.m_dragDropManager.addNewDropContainer(l._view.container,new g.ObjectData(g.DragDropObjectType.Slide,l.slideIndex)),l.m_dragDropManager.dragDropOperationCompletedEvent.subscribe(l.m_dragDropCompletedHandlerBound),l.m_dragDropManager.dragDropMoveEvent.subscribe(l.m_dragDropMoveHandlerBound)),l.m_slideGridSettings.enableRevisionTrackingInfo&&(l._revisionTrackingViewModel=new p.RevisionTrackingViewModel(l._view.slideInfoContainer,l.m_slideGridSettings,l._events));var m=new a.ViewModelBinding(l,"slideIndex");m.addBinding({target:l._view,onValueChanged:function(e){l.m_slideGridSettings.allowMoveSlide&&(l.m_dropContainer.objectData.index=e),h.ChangeGate.isChangeGateEnabled("ThumbnailCatchupBlueDot")&&l._revisionTrackingViewModel&&(l._revisionTrackingViewModel.slideIndex=e)}});var v=new a.ViewModelBinding(l,"displayCopilotUXEntryPoint");v.addBinding({target:l._gridContentViewModel}),v.addBinding({target:l._gridContentBoundaryViewModel}),m.addBinding({target:l._gridContentViewModel}),l.m_slideGridSettings.enableSelectionBetweenSlides&&m.addBinding({target:l._gridContentBoundaryViewModel}),new a.ViewModelBinding(l,"totalSlideCount").addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"activeSectionIndex").addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"isHiddenSlide").addBinding({target:l._view});var _=new a.ViewModelBinding(l,"isSelected");_.addBinding({target:l._view}),_.addBinding({target:l._gridContentViewModel});var f=new a.ViewModelBinding(l,"hasActiveFocus");return h.ChangeGate.isChangeGateEnabled("ThumbnailCatchupBlueDot")?f.addBinding({target:l._view,onValueChanged:function(e){l._revisionTrackingViewModel&&(l._revisionTrackingViewModel.hasActiveFocus=e)}}):f.addBinding({target:l._view}),f.addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"slideTitle").addBinding({target:l._gridContentViewModel}),new a.ViewModelBinding(l,"slideAriaLabel").addBinding({target:l._gridContentViewModel}),t.commentsEnabled&&(new a.ViewModelBinding(l,"displayCommentIcon").addBinding({target:l._view}),new a.ViewModelBinding(l,"numComments").addBinding({target:l._view}),t.isUsingSlideGridInThumbnail&&new a.ViewModelBinding(l,"commentsToolTipValue").addBinding({target:l._view})),t.shouldRenderAnimationOrTransitionInfo&&(new a.ViewModelBinding(l,"displayTransitionOrAnimationIcon").addBinding({target:l._view}),t.isUsingSlideGridInThumbnail&&new a.ViewModelBinding(l,"transitionOrAnimationToolTipValue").addBinding({target:l._view})),t.enableRevisionTrackingInfo&&new a.ViewModelBinding(l,"displayRevisionTrackingInfo").addBinding({target:l._revisionTrackingViewModel}),l._view.onViewClick.subscribe((function(e,i){if(l._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:l.slideIndex}),t.isMobileScreenReader){var n=l._slideIndex;l._events.onSlideSelectionChanged.signal(null,{slideIndex:n,slideSelectionTrigger:null!=i?i.slideSelectionTrigger:c.SlideSelectionTrigger.Click})}})),l}return r(t,e),t.prototype.presenceHoverHandler=function(e,t){null!=t&&null!=t.presenceTouchTargetTrigger&&(t.presenceTouchTargetTrigger===c.PresenceTouchTargetTrigger.MouseOut?this.presenceMouseOutHandler():t.presenceTouchTargetTrigger===c.PresenceTouchTargetTrigger.MouseOver&&this.presenceMouseOverHandler())},t.prototype.presenceMouseOutHandler=function(){this.shouldDisplayCollabMarkersHint||(this._view.presenceCollapseStyling(),this._presenceIconExpanded=!1,null!=this._pendingPresenceUserList&&0<this._pendingPresenceUserList.length&&(this.presenceUserList=this._pendingPresenceUserList,this._pendingPresenceUserList=[]))},t.prototype.presenceMouseOverHandler=function(){this._view.presenceExpandStyling(),this._presenceIconExpanded=!0},Object.defineProperty(t.prototype,"presenceUserList",{set:function(e){if(this._presenceIconExpanded)this._pendingPresenceUserList=e;else{var t=this._presenceUserList?this._presenceUserList.length:0,i=e.length;0===t&&0<i&&this._view.onPresenceHover.subscribe(this.m_presenceHoverHandlerBound),0<t&&0===i&&this._view.onPresenceHover.unsubscribe(this.m_presenceHoverHandlerBound),this._presenceUserList=e,this._view.presenceUserList=this._presenceUserList}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldDisplayCollabMarkersHint",{get:function(){return this._shouldDisplayCollabMarkersHint},set:function(e){this._shouldDisplayCollabMarkersHint=e,void 0!==this._revisionTrackingViewModel&&(this._revisionTrackingViewModel.shouldDisplayRevisionTrackingHint=this._shouldDisplayCollabMarkersHint),this.m_slideGridSettings.isDisplayPresenceIcon&&(e?this.presenceMouseOverHandler():this.presenceMouseOutHandler())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isShowingRedLine",{set:function(e){this._gridContentBoundaryViewModel.isSelected=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentImage",{set:function(e){this._gridContentViewModel.contentImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){return this._view.renderAreaRect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slideID",{get:function(){return this._slideID},set:function(e){this._slideID=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFrameDragOver",{get:function(){return this._onFrameDragOver},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFrameInDragState",{get:function(){return this._onFrameInDragState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentAreaRect",{get:function(){return this._gridContentViewModel.renderAreaRect},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._gridContentViewModel.dispose(),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&(this.m_dragDropManager.removeDropContainer(this.m_dropContainer),this.m_dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveEvent.unsubscribe(this.m_dragDropMoveHandlerBound)),this.m_slideGridSettings.isDisplayPresenceIcon&&this._view.onPresenceHover.unsubscribe(this.m_presenceHoverHandlerBound)},t.prototype.dragDropCompletedHandler=function(){this._view.isInDragState=!1},t.prototype.dragDropMoveHandler=function(e,t){this._slideIndex===t.draggableObjectData.index&&(this._view.isInDragState=!0,this.onFrameInDragState.signal(null,{index:this._slideIndex}))},t}(l.ViewModel);t.GridFrameViewModel=m},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridFrameView=void 0;var o,s,a,l,d=i(0),c=i(3),u=i(2),g=i(7),p=i(4),h=i(1);(s=o||(o={}))[s["presence-flyout-collapsed-class-0"]=0]="presence-flyout-collapsed-class-0",s[s["presence-flyout-collapsed-class-1"]=1]="presence-flyout-collapsed-class-1",s[s["presence-flyout-collapsed-class-2"]=2]="presence-flyout-collapsed-class-2",(l=a||(a={}))["#498205"]="persona-color-498205",l["#e3008c"]="persona-color-e3008c",l["#0078d4"]="persona-color-0078d4",l["#986f0b"]="persona-color-986f0b",l["#a4262c"]="persona-color-a4262c",l["#4f6bed"]="persona-color-4f6bed",l["#c239b3"]="persona-color-c239b3",l["#038387"]="persona-color-038387",l["#393939"]="persona-color-393939",l["#0b6a0b"]="persona-color-0b6a0b",l["#8764b8"]="persona-color-8764b8",l["#750b1c"]="persona-color-750b1c",l["#7a7574"]="persona-color-7a7574",l["#004e8c"]="persona-color-004e8c",l["#8e562e"]="persona-color-8e562e",l["#69797e"]="persona-color-69797e",l["#881798"]="persona-color-881798",l["#005b70"]="persona-color-005b70";var m=function(e){function t(t,i,n){var r,o=e.call(this,i)||this;(o.visibleStyleClassName="grid-frame-view-visible-class",o.verticalVisibleStyleClassName="grid-frame-view-vertical-visible-class",o.visibleStyleClassNameForUsingSlideGridInThumbnail="grid-frame-view-visible-thumbnail-class",o.hiddenStyleClassName="grid-frame-view-hidden-class",o.dragStyleClassName="grid-frame-view-in-drag-class",o.selectedStyleClassName="grid-frame-view-selected-class",o.activeFocusStyleClassName="grid-frame-view-active-focus-class",o.hiddenSlideStyleClassName="grid-frame-view-hidden-slide-class",o.slideInfoContainerClassName="grid-frame-view-slide-info-container-class",o.verticalSlideInfoContainerClassName="grid-frame-view-slide-info-container-vertical-class",o.slideIndexContainerClassName="grid-frame-view-slide-index-container-class",o.slideIndexContainerClassNameForUsingSlideGridInThumbnail="grid-frame-view-slide-index-container-thumbnail-class",o.containerRenderedAsGridStyleClassName="container-rendered-as-grid-class",o.transitionOrAnimationIconContainerClassName="grid-frame-view-transition-or-animation-icon-container-class",o.transitionOrAnimationIconContainerVeticalClassName="grid-frame-view-transition-or-animation-icon-container-vertical-class",o.gridFrameViewInnerContainerClassName="grid-frame-view-inner-container-class",o.gridFrameViewInnerContainerVerticalClassName="grid-frame-view-inner-container-vertical-class",o.commentIconContainerClassName="grid-frame-view-num-comments-with-icon-container-class",o.numCommentsOnCommentIconClassName="grid-frame-view-num-comments-on-comment-icon",o.commentIconClassName="comment-icon-class",o.presenceHiddenClassName="presence-collapsed-hidden-class",o.presenceOuterContainerClassName="presence-outer-container-class",o.presenceOuterContainerVerticalClassName="presence-outer-container-vertical-class",o.presenceOuterContainerVerticalThumbnailClassName="presence-outer-container-vertical-thumbnail-class",o.presenceOuterContainerVerticalRTLThumbnailClassName="presence-outer-container-vertical-rtl-thumbnail-class",o.presenceInnerContainerClassName="presence-inner-container-class",o.presenceTouchTargetClassName="presence-touch-target-class",o.presenceFlyoutContainerClassName="presence-flyout-container-class",o.presenceFlyoutsCollapsedClassName="presence-flyouts-collapsed-class",o.presenceFlyoutCollapsedTextName="presence-flyout-collapsed-text-class",o.presenceFlyoutsExpandedClassName="presence-flyout-expanded-class",o.presenceFlyoutExpandedTextName="presence-flyout-expanded-text-class",o.presenceExpandedContainerClassName="presence-flyout-expanded-container-class",o.postionRelativeClassName="grid-frame-view-postion-relative-class",o.transitionOrAnimationIconClassName="transition-or-animation-icon-class",o.c_transitionOrAnimationIconStarPath="M 809 1703 l 158 -547 l -455 -374 h 569 l 185 -526 l 194 527 h 570 l -450 368 l 167 544 l -472 -319 z",o.c_transitionOrAnimationIconGlitterPath="M 392 619 l -392 -120 l 50 -98 l 387 122 m -53 640 h -384 v -128 h 384 m -364 668 l 373 -150 l 55 100 l -368 150 z",o.c_collabMarkerViewBox="0 0 2048 2048",o.c_commentIconPath="M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 z",o._elementId="grid-frame-view-id".concat((0,p.v4)()),o._presenceFlyouts=new Array,o._totalPresenceUsers=0,o._currentPresenceUsers=0,o._presenceUserList=new Array,o._events=n,o._container.id=o._elementId,o._container.classList.add(o.visibleStyleClassName),(o.m_slideGridSettings=t).isDisplayVertical&&o._container.classList.add(o.verticalVisibleStyleClassName),t.isUsingSlideGridInThumbnail&&o._container.classList.add(o.visibleStyleClassNameForUsingSlideGridInThumbnail),o._onViewClick=new u.Event,o._innerContainer=document.createElement("div"),o._container.appendChild(o._innerContainer),o._innerContainer.className=o.gridFrameViewInnerContainerClassName,t.isDisplayVertical&&(o._innerContainer.className=o.gridFrameViewInnerContainerVerticalClassName),o.m_slideGridSettings.isDisplayPresenceIcon&&o._innerContainer.classList.add(o.postionRelativeClassName),o._slideIndexContainer=document.createElement("div"),o._slideIndexContainer.classList.add(o.slideIndexContainerClassName),t.isUsingSlideGridInThumbnail&&o._slideIndexContainer.classList.add(o.slideIndexContainerClassNameForUsingSlideGridInThumbnail),o._slideIndexContainer.setAttribute("aria-hidden","true"),o._slideIndexSpan=document.createElement("span"),o._slideIndexContainer.appendChild(o._slideIndexSpan),t.isDisplayPresenceIcon&&(o._onPresenceHover=new u.Event,o._presenceOuterContainer=document.createElement("div"),o._presenceOuterContainer.classList.add(o.presenceOuterContainerClassName),t.isDisplayVertical&&(o._presenceOuterContainer.classList.add(o.presenceOuterContainerVerticalClassName),t.isUsingSlideGridInThumbnail&&(o._presenceOuterContainer.classList.add(o.presenceOuterContainerVerticalThumbnailClassName),t.isRTL&&o._presenceOuterContainer.classList.add(o.presenceOuterContainerVerticalRTLThumbnailClassName))),o._presenceOuterContainer.style.width="".concat(o.m_slideGridSettings.slideWidth.toString(),"px"),o._presenceOuterContainer.style.height="".concat(o.m_slideGridSettings.slideHeight.toString(),"px"),o._innerContainer.appendChild(o._presenceOuterContainer),o._presenceInnerContainer=document.createElement("div"),o._presenceInnerContainer.classList.add(o.presenceInnerContainerClassName),o._presenceOuterContainer.appendChild(o._presenceInnerContainer),o._presenceTouchtarget=document.createElement("div"),o._presenceTouchtarget.classList.add(o.presenceTouchTargetClassName),o._presenceInnerContainer.appendChild(o._presenceTouchtarget),o._presenceFlyoutContainer=document.createElement("div"),o._presenceFlyoutContainer.classList.add(o.presenceFlyoutContainerClassName),o._presenceInnerContainer.appendChild(o._presenceFlyoutContainer),h.ChangeGate.isChangeGateEnabled("PresenceFlyoutDisplayStyle")&&(o._presenceOuterContainer.style.display="none")),t.enableRevisionTrackingInfo||t.commentsEnabled||t.shouldRenderAnimationOrTransitionInfo?(o._slideInfoContainer=document.createElement("div"),o._slideInfoContainer.classList.add(o.slideInfoContainerClassName),t.isDisplayVertical&&(o._slideInfoContainer.classList.add(o.verticalSlideInfoContainerClassName),o._slideInfoContainer.style.height="".concat(o.m_slideGridSettings.slideHeight.toString(),"px")),o._container.classList.add(o.containerRenderedAsGridStyleClassName),o._slideIndexContainer.classList.add(o.containerRenderedAsGridStyleClassName),o._innerContainer.appendChild(o._slideInfoContainer),o._slideInfoContainer.appendChild(o._slideIndexContainer)):o._innerContainer.appendChild(o._slideIndexContainer),t.shouldRenderAnimationOrTransitionInfo&&(o._transitionOrAnimationIconContainer=document.createElement("div"),o._transitionOrAnimationIconContainer.classList.add(o.transitionOrAnimationIconContainerClassName),t.isDisplayVertical&&o._transitionOrAnimationIconContainer.classList.add(o.transitionOrAnimationIconContainerVeticalClassName),o._transitionOrAnimationIconContainer.setAttribute("aria-hidden","true"),o._transitionOrAnimationIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),void 0===o._transitionOrAnimationIcon.classList?(r=-1===(r=o._transitionOrAnimationIcon.getAttribute("class")||"").split(" ").indexOf(o.transitionOrAnimationIconClassName)?r.concat(" ",o.transitionOrAnimationIconClassName):r,o._transitionOrAnimationIcon.setAttribute("class",r)):o._transitionOrAnimationIcon.classList.add(o.transitionOrAnimationIconClassName),o._transitionOrAnimationIcon.setAttribute("viewBox",o.c_collabMarkerViewBox),o._transitionOrAnimationIconStarPath=document.createElementNS("http://www.w3.org/2000/svg","path"),o._transitionOrAnimationIconStarPath.setAttribute("d",o.c_transitionOrAnimationIconStarPath),o._transitionOrAnimationIconGlitterPath=document.createElementNS("http://www.w3.org/2000/svg","path"),o._transitionOrAnimationIconGlitterPath.setAttribute("d",o.c_transitionOrAnimationIconGlitterPath),o._transitionOrAnimationIcon.appendChild(o._transitionOrAnimationIconStarPath),o._transitionOrAnimationIcon.appendChild(o._transitionOrAnimationIconGlitterPath),o._transitionOrAnimationIconContainer.appendChild(o._transitionOrAnimationIcon),t.isDisplayVertical||o._slideInfoContainer.appendChild(o._transitionOrAnimationIconContainer)),t.commentsEnabled)&&(o._numCommentsSpan=document.createElement("span"),o._commentIconContainer=document.createElement("div"),o._commentIconContainer.classList.add(o.commentIconContainerClassName),o._commentIconContainer.setAttribute("aria-hidden","true"),o.m_slideGridSettings.isUsingSlideGridInThumbnail&&(o._commentIconContainer.onclick=function(e){e&&(o._events.onSlideSelectionChanged.signal(null,{slideIndex:o._slideIndex,slideSelectionTrigger:g.SlideSelectionTrigger.DoubleClick,isSelectingRange:!1,isSelectingMultiple:!1,isCommentCountClicked:!0}),o._events.onCommentCountClick.signal(null,{}))}),o._commentIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),void 0===o._commentIcon.classList?(r=(r=o._commentIcon.getAttribute("class")||"").concat(" ",o.commentIconClassName),o._commentIcon.setAttribute("class",r)):o._commentIcon.classList.add(o.commentIconClassName),o._commentIcon.setAttribute("viewBox",o.c_collabMarkerViewBox),o._commentIconPath=document.createElementNS("http://www.w3.org/2000/svg","path"),o._commentIconPath.setAttribute("d",o.c_commentIconPath),o._commentIcon.appendChild(o._commentIconPath),o._commentIconContainer.appendChild(o._commentIcon),o._numCommentsSpan.classList.add(o.numCommentsOnCommentIconClassName),o._slideInfoContainer.appendChild(o._commentIconContainer),o._commentIconContainer.appendChild(o._numCommentsSpan));return t.shouldRenderAnimationOrTransitionInfo&&t.isDisplayVertical&&o._slideInfoContainer.appendChild(o._transitionOrAnimationIconContainer),new d.ViewBinding(o,"slideIndex").addBinding({element:o._slideIndexSpan,onValueChanged:function(){var e="".concat(o._slideIndex+1);o._slideIndexSpan.innerText=e}}),new d.ViewBinding(o,"isInDragState").addBinding({element:o._container,attribute:"display",onValueChanged:function(e){e?o._container.classList.add(o.dragStyleClassName):o._container.classList.remove(o.dragStyleClassName)}}),t.commentsEnabled&&(new d.ViewBinding(o,"numComments").addBinding({element:o._numCommentsSpan,attribute:"innerText"}),t.isUsingSlideGridInThumbnail&&new d.ViewBinding(o,"commentsToolTipValue").addBinding({element:o._numCommentsSpan,attribute:"title"}),new d.ViewBinding(o,"displayCommentIcon").addBinding({element:o._commentIconContainer,attribute:"display",onValueChanged:function(e){e?o._commentIconContainer.classList.remove("grid-frame-view-Comments-icon-hidden-class"):o._commentIconContainer.classList.add("grid-frame-view-Comments-icon-hidden-class")}})),t.shouldRenderAnimationOrTransitionInfo&&(new d.ViewBinding(o,"displayTransitionOrAnimationIcon").addBinding({element:o._transitionOrAnimationIconContainer,attribute:"display",onValueChanged:function(e){e?o._transitionOrAnimationIconContainer.classList.remove("grid-frame-view-transition-or-animation-icon-hidden-class"):o._transitionOrAnimationIconContainer.classList.add("grid-frame-view-transition-or-animation-icon-hidden-class")}}),t.isUsingSlideGridInThumbnail&&new d.ViewBinding(o,"transitionOrAnimationToolTipValue").addBinding({element:o._transitionOrAnimationIconContainer,attribute:"title"})),t.enableSelectionBetweenSlides&&(o._container.onclick=function(e){o.raiseEventFromClick(e)},o._container.oncontextmenu=function(e){e.preventDefault(),o.raiseEventFromClick(e)}),t.isMobileScreenReader&&o._container.addEventListener("click",(function(e){e.preventDefault(),o._onViewClick.signal(null,{slideSelectionTrigger:g.SlideSelectionTrigger.Click})})),t.isDisplayPresenceIcon&&(h.ChangeGate.isChangeGateEnabled("PresencePillFix")?o._presenceTouchtarget.addEventListener("mouseout",(function(e){o.isMouseInPresenceFlyoutRegion(e)||o._onPresenceHover.signal(null,{presenceTouchTargetTrigger:g.PresenceTouchTargetTrigger.MouseOut})})):o._presenceTouchtarget.addEventListener("mouseout",(function(){o._onPresenceHover.signal(null,{presenceTouchTargetTrigger:g.PresenceTouchTargetTrigger.MouseOut})})),o._presenceTouchtarget.addEventListener("mouseover",(function(){o._onPresenceHover.signal(null,{presenceTouchTargetTrigger:g.PresenceTouchTargetTrigger.MouseOver})})),h.ChangeGate.isChangeGateEnabled("PresencePillFix")&&o._presenceFlyoutContainer.addEventListener("mouseout",(function(e){o.isMouseInPresenceFlyoutRegion(e)||o._onPresenceHover.signal(null,{presenceTouchTargetTrigger:g.PresenceTouchTargetTrigger.MouseOut})}))),h.ChangeGate.isChangeGateEnabled("ShiftArrowScrollFix")&&o._events.onShiftArrowKeyScroll.subscribe((function(e,t){t.slideIndex===o.slideIndex&&o._container.scrollIntoView({block:"nearest"})})),o}return r(t,e),t.prototype.isMouseInPresenceFlyoutRegion=function(e){var t=e.clientX,i=e.clientY,n=this._presenceFlyoutContainer.getBoundingClientRect();return t>n.left&&t<n.right&&i>n.top&&i<n.bottom},t.prototype.raiseEventFromClick=function(e){var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null,i=new RegExp("grid-frame-view");null!=t&&0<(t.getAttribute("class")||"").search(i)&&this._onViewClick.signal(null,null)},Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){var e=this._container.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"presenceUserList",{set:function(e){for(this._presenceUserList=e,this._totalPresenceUsers=this._presenceUserList.length;this._currentPresenceUsers<this._totalPresenceUsers;){var t=document.createElement("div");this._presenceFlyoutContainer.appendChild(t),this._presenceFlyouts.push(t),this._currentPresenceUsers+=1}for(;this._currentPresenceUsers>this._totalPresenceUsers;){var i=this._presenceFlyoutContainer.firstChild;i&&(this._presenceFlyoutContainer.removeChild(i),this._presenceFlyouts.splice(0,1)),this._currentPresenceUsers-=1}h.ChangeGate.isChangeGateEnabled("PresenceFlyoutDisplayStyle")&&(this._presenceOuterContainer.style.display=0<this._totalPresenceUsers?"block":"none"),this.presenceCollapseStyling()},enumerable:!1,configurable:!0}),t.prototype.presenceExpandStyling=function(){var e=this;if(this._currentPresenceUsers===this._totalPresenceUsers&&(null===this._presenceUserList||this._currentPresenceUsers===this._presenceUserList.length)){var t=this._totalPresenceUsers-1;this._presenceFlyoutContainer.classList.add(this.presenceExpandedContainerClassName),this._presenceFlyouts.forEach((function(i){i.classList.remove(e.presenceFlyoutsCollapsedClassName),i.classList.remove(e.presenceFlyoutCollapsedTextName),i.classList.remove(o[0]),i.classList.remove(o[1]),i.classList.remove(o[2]),i.classList.remove(e.presenceHiddenClassName),i.classList.add(e.presenceFlyoutsExpandedClassName),i.classList.add(e.presenceFlyoutExpandedTextName),i.innerText=e._presenceUserList[t].userName?e._presenceUserList[t].userName:"";var n=a[e._presenceUserList[t].color];i.classList.add(n),t-=1}))}},t.prototype.presenceCollapseStyling=function(){var e=this;if(this._currentPresenceUsers===this._totalPresenceUsers&&(null===this._presenceUserList||this._currentPresenceUsers===this._presenceUserList.length)){var t=this._totalPresenceUsers-1;this._presenceFlyoutContainer.classList.remove(this.presenceExpandedContainerClassName),this._presenceFlyouts.forEach((function(i){i.classList.remove(e.presenceFlyoutsExpandedClassName),i.classList.remove(e.presenceFlyoutExpandedTextName),i.classList.add(e.presenceFlyoutsCollapsedClassName),i.classList.add(e.presenceFlyoutCollapsedTextName),e.presenceCollapseStylingHelper(t,i);var n=a[e._presenceUserList[t].color];i.classList.add(n),t-=1}))}},t.prototype.presenceCollapseStylingHelper=function(e,t){switch(e){case 0:t.innerText=this._presenceUserList[e].initials?this._presenceUserList[e].initials:"",t.classList.add(o[0]),t.classList.remove(o[1]),t.classList.remove(o[2]),t.classList.remove(this.presenceHiddenClassName);break;case 1:t.innerText="",t.classList.remove(o[0]),t.classList.add(o[1]),t.classList.remove(o[2]),t.classList.remove(this.presenceHiddenClassName);break;case 2:t.innerText="",t.classList.remove(o[0]),t.classList.remove(o[1]),t.classList.add(o[2]),t.classList.remove(this.presenceHiddenClassName);break;default:t.innerText="",t.classList.remove(o[0]),t.classList.remove(o[1]),t.classList.remove(o[2]),t.classList.add(this.presenceHiddenClassName)}},Object.defineProperty(t.prototype,"isSelected",{set:function(e){this._isSelected=e,this._isSelected?this._container.classList.add(this.selectedStyleClassName):this._container.classList.remove(this.selectedStyleClassName)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._onViewClick},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onPresenceHover",{get:function(){return this._onPresenceHover},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasActiveFocus",{set:function(e){this._hasActiveFocus=e,this._hasActiveFocus?(this.m_slideGridSettings.isDisplayVertical||this._container.classList.add(this.activeFocusStyleClassName),this.m_slideGridSettings.allowScrollIntoView&&this._container.scrollIntoView({block:"nearest"})):this.m_slideGridSettings.isDisplayVertical||this._container.classList.remove(this.activeFocusStyleClassName)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHiddenSlide",{set:function(e){this._isHiddenSlide=e,this._isHiddenSlide?this._container.classList.add(this.hiddenSlideStyleClassName):this._container.classList.remove(this.hiddenSlideStyleClassName)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerContainer",{get:function(){return this._innerContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slideInfoContainer",{get:function(){return this._slideInfoContainer},enumerable:!1,configurable:!0}),t}(c.View);t.GridFrameView=m},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridContentViewModel=void 0;var o=i(32),s=i(33),a=i(0),l=i(7),d=i(5),c=i(6),u=i(1),g=function(e){function t(t,i,n,r){var d=e.call(this,i)||this;d._events=n,d._dragDropManager=r,d.m_slideGridSettings=t,d._view=new o.GridContentView(d.m_slideGridSettings,i),d._contentImageViewModel=new s.ContentImageViewModel(d._view.container,d._events,d.m_slideGridSettings),t.allowMoveSlide&&(d._draggable=d._dragDropManager.addNewDraggable(d._view.container,new c.ObjectData(c.DragDropObjectType.Slide,d._slideIndex))),new a.ViewModelBinding(d,"slideIndex").addBinding({target:d._view,onValueChanged:function(e){d.m_slideGridSettings.allowMoveSlide&&(d._draggable.objectData.index=e)}}),new a.ViewModelBinding(d,"totalSlideCount").addBinding({target:d._view}),new a.ViewModelBinding(d,"activeSectionIndex").addBinding({target:d._view}),new a.ViewModelBinding(d,"slideAriaLabel").addBinding({target:d._view});var u=new a.ViewModelBinding(d,"slideTitle");return u.addBinding({target:d._view}),u.addBinding({target:d._contentImageViewModel}),new a.ViewModelBinding(d,"hasActiveFocus").addBinding({target:d._view}),new a.ViewModelBinding(d,"isSelected").addBinding({target:d._view,onValueChanged:function(e){if(d.m_slideGridSettings.allowMoveSlide){var t=d._dragDropManager.dragReadyElements;if(e)t.indexOf(d._draggable)<0&&(t.push(d._draggable),d._dragDropManager.dragReadyElements=t);else{var i=t.indexOf(d._draggable);0<=i&&(t.splice(i,1),d._dragDropManager.dragReadyElements=t)}}}}),new a.ViewModelBinding(d,"displayCopilotUXEntryPoint").addBinding({target:d._view}),d._view.onViewClick.subscribe((function(e,t){var i=d._slideIndex,n=t.isSelectingMultiple,r=t.isSelectingRange,o=t.isCtrlKeyPressed;d.m_slideGridSettings.allowMoveSlide&&t.slideSelectionTrigger===l.SlideSelectionTrigger.RightClick&&d.m_slideGridSettings.allowMultipleSelect&&(d._dragDropManager.dragReadyElements.indexOf(d._draggable)<0?d._dragDropManager.dragReadyElements=[d._draggable]:n=!0),d._events.onSlideSelectionChanged.signal(null,{slideIndex:i,slideSelectionTrigger:null!=t?t.slideSelectionTrigger:l.SlideSelectionTrigger.Click,isSelectingMultiple:n,isSelectingRange:r,isCtrlKeyPressed:o})})),d}return r(t,e),Object.defineProperty(t.prototype,"contentImage",{set:function(e){if(this.m_slideGridSettings.isUsingSlideGridInThumbnail&&u.ChangeGate.isChangeGateEnabled("ThumbnailScrollShimmer")){var i=this.m_slideGridSettings.isRTL;e?i?this._view.container.classList.remove(t.thumbnailShimmerEffectClassName,t.thumbnailShimmerEffectRTLClassName):this._view.container.classList.remove(t.thumbnailShimmerEffectClassName):i?this._view.container.classList.add(t.thumbnailShimmerEffectClassName,t.thumbnailShimmerEffectRTLClassName):this._view.container.classList.add(t.thumbnailShimmerEffectClassName)}this._contentImageViewModel.image=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){return this._view.renderAreaRect},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.m_slideGridSettings.allowMoveSlide&&null!=this._dragDropManager&&this._dragDropManager.removeDraggable(this._draggable)},t.thumbnailShimmerEffectClassName="thumbsShimmerEffect",t.thumbnailShimmerEffectRTLClassName="thumbsShimmerEffectRTL",t}(d.ViewModel);t.GridContentViewModel=g},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridContentView=void 0;var o=i(2),s=i(3),a=i(7),l=i(0),d=i(4),c=i(1),u=function(e){function t(t,i){var n=e.call(this,i)||this;n.visibleStyleClassName="grid-content-view-visible-class",n.thumbnailVisibleStyleClassName="grid-content-thumbnail-view-visible-class",n.thumbnailzIndexVisibleStyleClassName="grid-content-thumbnail-zIndex-view-visible-class",n.containerRenderedAsGridStyleClassName="container-rendered-as-grid-class",n.hiddenStyleClassName="grid-content-view-hidden-class",n.editableGridStyleClassName="grid-content-editable-cursor-hide-class",n.copilotUXAnchorId="ppt-slidegrid-copilot-start-anchor-element",n.copilotUXStyleClassName="ppt-slidegrid-copilot-ux-class",n._elementId="grid-content-view-id".concat((0,d.v4)()),n._container.classList.add(n.visibleStyleClassName),t.isUsingSlideGridInThumbnail&&n._container.classList.add(n.thumbnailVisibleStyleClassName),t.isUsingSlideGridInThumbnail&&c.ChangeGate.isChangeGateEnabled("zIndexIssueOnRibbonFlyoutFix")&&n._container.classList.add(n.thumbnailzIndexVisibleStyleClassName),n._container.id=n._elementId,n.m_slideGridSettings=t,n.m_slideGridSettings.commentsEnabled&&n._container.classList.add(n.containerRenderedAsGridStyleClassName),n._viewClickEvent=new o.Event,n._container.style.width="".concat(n.m_slideGridSettings.slideWidth.toString(),"px"),n._container.style.height="".concat(n.m_slideGridSettings.slideHeight.toString(),"px"),n._container.tabIndex=n.m_slideGridSettings.disableAutomaticTabStops?-1:0,t.isUsingSlideGridInThumbnail||n._container.setAttribute("aria-level","1"),t.isMobileScreenReader?n._container.setAttribute("role","menuitem"):n._container.setAttribute("role","option");var r=function(e){if(n._displayCopilotUXEntryPoint&&n.m_slideGridSettings.isCopilotUXEntryPointEnabled){var t=e.target;if(t&&(t.id===n.copilotUXAnchorId||t.id===n.m_slideGridSettings.copilotUXTabStopId))return!0}return!1};n._container.onclick=function(e){if(e.preventDefault(),!r(e)){var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&n.m_slideGridSettings.allowMultipleSelect,i=e.shiftKey,o=e.ctrlKey;n.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.Click,isSelectingMultiple:t,isSelectingRange:i,isCtrlKeyPressed:o})}},n.m_slideGridSettings.allowMoveSlide&&(n._container.onmousedown=function(e){if(0===e.button){if(e.preventDefault(),r(e))return;var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&n.m_slideGridSettings.allowMultipleSelect,i=e.shiftKey,o=e.ctrlKey;if(n.m_slideGridSettings.isDeselectWithCtrlEnabled&&o)return;n.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.MouseDown,isSelectingMultiple:t,isSelectingRange:i,isCtrlKeyPressed:o})}}),n.m_slideGridSettings.enableTriggerSelectionFromRightClick&&(n._container.oncontextmenu=function(e){if(e.preventDefault(),!r(e)){var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&n.m_slideGridSettings.allowMultipleSelect,i=e.shiftKey;c.ChangeGate.isChangeGateEnabled("ContextMenuViaKeyboardFix")&&-1==e.button||n.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.RightClick,isSelectingMultiple:t,isSelectingRange:i})}}),n.m_slideGridSettings.enableTriggerSelectionFromDoubleClick&&(n._container.ondblclick=function(e){if(e.preventDefault(),!r(e)){var t=(e.metaKey||e.ctrlKey||e.shiftKey)&&n.m_slideGridSettings.allowMultipleSelect,i=e.shiftKey;n.onViewClick.signal(null,{slideSelectionTrigger:a.SlideSelectionTrigger.DoubleClick,isSelectingMultiple:t,isSelectingRange:i})}}),new l.ViewBinding(n,"totalSlideCount").addBinding({element:n._container,onValueChanged:function(){n._container.setAttribute("aria-setsize",n._totalSlideCount.toString())}});var s=new l.ViewBinding(n,"slideTitle");return n.m_slideGridSettings.isCopilotUXEntryPointEnabled&&c.ChangeGate.isChangeGateEnabled("CopilotUXThumbnailCustomTooltip")||s.addBinding({element:n._container,onValueChanged:function(e){n._container.title=e}}),new l.ViewBinding(n,"slideAriaLabel").addBinding({element:n._container,onValueChanged:function(e){n._container.setAttribute("aria-label",null!=e&&""!==e?e:n._slideTitle)}}),new l.ViewBinding(n,"slideIndex").addBinding({element:n._container,onValueChanged:function(){var e="".concat(n._slideIndex+1);n._container.setAttribute("aria-posinset",e)}}),new l.ViewBinding(n,"isSelected").addBinding({element:n._container,onValueChanged:function(){n._container.setAttribute("aria-selected",n._isSelected.toString())}}),t.isPasteViaKeyboardEnabled&&(n._container.classList.add(n.editableGridStyleClassName),n._container.ariaReadOnly="false",n._container.contentEditable="true"),n}return r(t,e),Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._viewClickEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slideIndex",{set:function(e){this._slideIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasActiveFocus",{set:function(e){this._hasActiveFocus=e,this._hasActiveFocus&&this._container.focus()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayCopilotUXEntryPoint",{set:function(e){this._displayCopilotUXEntryPoint=e,this._displayCopilotUXEntryPoint&&!this._copilotUXAnchorElement&&(this._copilotUXAnchorElement=document.createElement("div"),this._copilotUXAnchorElement.id=this.copilotUXAnchorId,this._copilotUXAnchorElement.classList.add(this.copilotUXStyleClassName),c.ChangeGate.isChangeGateEnabled("CopilotUXAbsolutePositioning")&&(this._copilotUXAnchorElement.style.position="absolute",this._copilotUXAnchorElement.style.top="".concat(this.m_slideGridSettings.slideHeight.toString(),"px")),0==this.slideIndex&&this._container&&this._container.appendChild(this._copilotUXAnchorElement))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAreaRect",{get:function(){var e=this._container.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}},enumerable:!1,configurable:!0}),t}(s.View);t.GridContentView=u},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.ContentImageViewModel=void 0;var o=i(34),s=i(0),a=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r._events=i,r._view=new o.ContentImageView(t,n),new s.ViewModelBinding(r,"image").addBinding({target:r._view}),new s.ViewModelBinding(r,"slideTitle").addBinding({target:r._view}),r}return r(t,e),t}(i(5).ViewModel);t.ContentImageViewModel=a},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.ContentImageView=void 0;var o=i(0),s=i(3),a=i(4),l=i(1),d=function(e){function t(t,i){var n=e.call(this,t)||this;n.visibleStyleClassName="content-image-view-visible-class",n.hiddenStyleClassName="content-image-view-hidden-class",n.contenteditableClassName="content-editable-class",n._elementId="content-image-view-id".concat((0,a.v4)()),n._imageElement=document.createElement("img"),n._container.id=n._elementId,n._container.classList.add(n.visibleStyleClassName),i.isPasteViaKeyboardEnabled&&(n._spanElement=document.createElement("span"),n._spanElement.innerText=".",n._spanElement.ariaReadOnly="false",n._spanElement.contentEditable="true",n._spanElement.classList.add(n.contenteditableClassName),n._container.appendChild(n._spanElement)),n._container.appendChild(n._imageElement),n._container.setAttribute("aria-hidden","true"),new o.ViewBinding(n,"image").addBinding({element:n._imageElement,attribute:"src",onValueChanged:n.handleImageChange.bind(n)});var r=new o.ViewBinding(n,"slideTitle");return i.isCopilotUXEntryPointEnabled&&l.ChangeGate.isChangeGateEnabled("CopilotUXThumbnailCustomTooltip")&&r.addBinding({element:n._container,onValueChanged:function(e){n._container.title=e}}),n}return r(t,e),t.prototype.handleImageChange=function(e){null==e||""===e?(this._container.classList.remove(this.visibleStyleClassName),this._container.classList.add(this.hiddenStyleClassName)):(this._container.classList.remove(this.hiddenStyleClassName),this._container.classList.add(this.visibleStyleClassName))},t}(s.View);t.ContentImageView=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.GridContentBoundaryView=void 0;var o=i(3),s=i(0),a=i(2),l=i(4),d=i(1),c=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r.gridContentPaddingLength=23,r.defaultStyleClassName="grid-content-boundary-view-default-class",r.defaultVerticalStyleClassName="grid-content-boundary-vertical-view-default-class",r.deselectedStyleClassName="grid-content-boundary-view-deselected-class",r.defaultStyleClassNameForUsingSlideGridInThumbnail="grid-content-boundary-view-default-thumbnail-class",r.selectedStyleClassName="grid-content-boundary-view-selected-class",r.hiddenStyleClassName="grid-content-boundary-view-hidden-class",r.firstSlideLeftBoundaryWithSectionsStyleClassName="grid-content-boundary-view-first-slide-with-sections-class",r.firstSlideLeftBoundaryWithoutSectionsStyleClassName="grid-content-boundary-view-first-slide-without-sections-class",r.editableGridStyleClassName="grid-content-editable-cursor-hide-class",r.contenteditableClassName="content-editable-class",r.marginTopCopilotUX=40,r._elementId="grid-content-boundary-view".concat((0,l.v4)()),r.gridContentBoundaryIdCopilotStart="ppto-grid-content-lower-boundary-element-copilot-ux",r.m_isBeforeFirstSlideBoundary=!0,r._container.id=r._elementId,r._container.classList.add(r.defaultStyleClassName),r.m_slideGridSettings=i,r.m_slideGridSettings.isDisplayVertical&&r._container.classList.add(r.defaultVerticalStyleClassName),r.m_slideGridSettings.isUsingSlideGridInThumbnail&&r._container.classList.add(r.defaultStyleClassNameForUsingSlideGridInThumbnail),d.ChangeGate.isChangeGateEnabled("NextStylesBackgroundFix")||r._container.classList.add(r.deselectedStyleClassName),r._onViewClick=new a.Event,r.m_isBeforeFirstSlideBoundary=n,r._container.setAttribute("aria-hidden","true"),r.m_slideGridSettings.isPasteViaKeyboardEnabled&&(r._container.contentEditable="true",r._container.style.cursor="default",r._container.classList.add(r.editableGridStyleClassName),r._container.classList.add(r.contenteditableClassName)),new s.ViewBinding(r,"isSelected").addBinding({element:r._container,onValueChanged:function(e){e?(d.ChangeGate.isChangeGateEnabled("NextStylesBackgroundFix")||r._container.classList.remove(r.deselectedStyleClassName),r._container.classList.add(r.selectedStyleClassName),r._container.tabIndex=0,r._container.focus()):(r._container.classList.remove(r.selectedStyleClassName),d.ChangeGate.isChangeGateEnabled("NextStylesBackgroundFix")||r._container.classList.add(r.deselectedStyleClassName),r._container.tabIndex=-1,r._container.blur())}}),new s.ViewBinding(r,"isVisible").addBinding({element:r._container,onValueChanged:function(e){e?r._container.classList.remove(r.hiddenStyleClassName):(r.isSelected=!1,r._container.classList.add(r.hiddenStyleClassName))}}),n&&!i.isDisplayVertical&&new s.ViewBinding(r,"shouldDisplaySection").addBinding({element:r._container,onValueChanged:function(e){e?(r._container.classList.add(r.firstSlideLeftBoundaryWithSectionsStyleClassName),r._container.classList.remove(r.firstSlideLeftBoundaryWithoutSectionsStyleClassName)):(r._container.classList.add(r.firstSlideLeftBoundaryWithoutSectionsStyleClassName),r._container.classList.remove(r.firstSlideLeftBoundaryWithSectionsStyleClassName))}}),r._container.onclick=function(e){r.raiseEventFromClick(e)},r._container.oncontextmenu=function(e){e.preventDefault(),r.raiseEventFromClick(e)},i.isDisplayVertical?(r._container.style.width="".concat((i.slideWidth+r.gridContentPaddingLength).toString(),"px"),r.m_isBeforeFirstSlideBoundary&&(r._container.style.margin="0px",r._container.style.paddingTop="0px",r._container.style.marginLeft="4px")):r._container.style.height="".concat((r.m_slideGridSettings.slideHeight+r.gridContentPaddingLength).toString(),"px"),r}return r(t,e),t.prototype.raiseEventFromClick=function(e){e.preventDefault();var t=this.m_isBeforeFirstSlideBoundary?0:this.slideIndex+1;this.onViewClick.signal(null,{insertIndex:t})},Object.defineProperty(t.prototype,"displayCopilotUXEntryPoint",{set:function(e){this._displayCopilotUXEntryPoint=e,this._displayCopilotUXEntryPoint&&0===this.slideIndex&&this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&(this._container.id=this.gridContentBoundaryIdCopilotStart)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onViewClick",{get:function(){return this._onViewClick},enumerable:!1,configurable:!0}),t}(o.View);t.GridContentBoundaryView=c},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.RevisionTrackingViewModel=void 0;var o=i(5),s=i(37),a=i(0),l=i(1),d=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r._view=new s.RevisionTrackingView(t,i,n),new a.ViewModelBinding(r,"displayRevisionTrackingInfo").addBinding({target:r._view}),new a.ViewModelBinding(r,"shouldDisplayRevisionTrackingHint").addBinding({target:r._view,onValueChanged:function(e){r.displayRevisionTrackingInfo&&(e?r._view.showRevisionTrackingFlyout():r._view.hideRevisionTrackingFlyout())}}),l.ChangeGate.isChangeGateEnabled("ThumbnailCatchupBlueDot")&&(new a.ViewModelBinding(r,"slideIndex").addBinding({target:r._view,onValueChanged:function(e){r._view.slideIndex=e}}),new a.ViewModelBinding(r,"hasActiveFocus").addBinding({target:r._view,onValueChanged:function(e){r._view.hasActiveFocus=e}})),r}return r(t,e),t}(o.ViewModel);t.RevisionTrackingViewModel=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.RevisionTrackingView=void 0;var o=i(3),s=i(0),a=i(7),l=i(1),d=function(e){function t(t,i,n){var r=e.call(this,t)||this;if(r.c_revisionTrackingBackgroundLeftOut=8,r.c_revisionTrackingBackgroundRightOut=8,r.c_revisionTrackingBackgroundTopOut=8,r.c_revisionTrackingBackgroundBottomOut=32,r.revisionTrackingBackGroundViewClassName="revisiontracking-background-view-class",r.revisionTrackingContainerClassName="revisiontracking-container-class",r.verticalRevisionTrackingContainerClassName="revisiontracking-container-vertical-class",r.revisionTrackingPawnContainerClassName="revisiontracking-pawn-container-class",r.revisionTrackingPawnClassName="revisiontracking-pawn-class",r.revisionTrackingIconClassName="revisiontracking-icon-class",r.revisionTrackingFlyoutContainerClassName="revisiontracking-flyout-container-class",r.revisionTrackingViewHiddenClass="revisiontracking-view-hidden-class",r.c_revisionTrackingIconPathAttribute="M13,7.5c0,0.5-0.4,0.9-0.9,0.9H9.7l2.6,2.6c0.4,0.4,0.4,0.9,0,1.3c-0.4,0.4-0.9,0.4-1.3,0L8.4,9.7v2.4C8.4,12.6,8,13,7.5,13c-0.5,0-0.9-0.4-0.9-0.9V9.7L4,12.3c-0.4,0.4-0.9,0.4-1.3,0c-0.4-0.4-0.4-0.9,0-1.3l2.6-2.6H2.9C2.4,8.4,2,8,2,7.5C2,7,2.4,6.6,2.9,6.6h2.4L2.7,4c-0.4-0.4-0.4-0.9,0-1.3c0.4-0.4,0.9-0.4,1.3,0l2.6,2.6V2.9C6.6,2.4,7,2,7.5,2C8,2,8.4,2.4,8.4,2.9v2.4L11,2.7c0.4-0.4,0.9-0.4,1.3,0c0.4,0.4,0.4,0.9,0,1.3L9.7,6.6h2.4C12.6,6.6,13,7,13,7.5z M7.5,5.6c-1,0-1.8,0.8-1.8,1.8c0,1,0.8,1.8,1.8,1.8c1,0,1.8-0.8,1.8-1.8C9.3,6.4,8.5,5.6,7.5,5.6z",r.modernRevisionTrackingIconClassName="modern-revisiontracking-icon-class",r.c_modernRevisionTrackingIconPathAttribute="M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0",r.modernRevisionTrackingIconPathClassName="modern-revisiontracking-svg-path-class",r.modernRevisionTrackingFlyoutContainerClassName="modern-revisiontracking-flyout-container-class",r.pointerRevisionTrackingPawnInThumbnailPane="pointer",i.shouldDisplayModernCatchupUx||(r._revisionTrackingBackGroundView=document.createElement("div"),r._revisionTrackingBackGroundView.classList.add(r.revisionTrackingBackGroundViewClassName),r._revisionTrackingBackGroundView.style.width="".concat((i.slideWidth+r.c_revisionTrackingBackgroundLeftOut+r.c_revisionTrackingBackgroundRightOut).toString(),"px"),r._revisionTrackingBackGroundView.style.height="".concat((i.slideHeight+r.c_revisionTrackingBackgroundTopOut+r.c_revisionTrackingBackgroundBottomOut).toString(),"px"),t.appendChild(r._revisionTrackingBackGroundView)),r._revisionTrackingContainer=document.createElement("div"),r._revisionTrackingContainer.classList.add(r.revisionTrackingContainerClassName),i.isDisplayVertical&&r._revisionTrackingContainer.classList.add(r.verticalRevisionTrackingContainerClassName),r._revisionTrackingContainer.setAttribute("aria-label",i.revisionTrackingFlyoutContent),r._revisionTrackingPawnContainer=document.createElement("div"),r._revisionTrackingPawnContainer.classList.add(r.revisionTrackingPawnContainerClassName),r._revisionTrackingPawnContainer.setAttribute("aria-hidden","true"),r._revisionTrackingPawn=document.createElement("div"),r._revisionTrackingPawn.classList.add(r.revisionTrackingPawnClassName),l.ChangeGate.isChangeGateEnabled("ThumbnailCatchupBlueDot")&&(i.isUsingSlideGridInThumbnail&&(r._revisionTrackingPawn.style.cursor=r.pointerRevisionTrackingPawnInThumbnailPane),r._revisionTrackingPawn.onclick=function(e){if(e){var t=r.hasActiveFocus;n.onSlideSelectionChanged.signal(null,{slideIndex:r.slideIndex,slideSelectionTrigger:a.SlideSelectionTrigger.DoubleClick,isSelectingRange:!1,isSelectingMultiple:!1,isCatchup:!0}),n.onCatchupEvent.signal(null,{catchupClick:!0,wasActiveFocusSlide:t})}}),r._revisionTrackingIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),i.shouldDisplayModernCatchupUx)r._revisionTrackingIcon.setAttribute("class",r.modernRevisionTrackingIconClassName),r._revisionTrackingIcon.setAttribute("viewBox","0 0 10 10");else{if(void 0===r._revisionTrackingIcon.classList){var o=r._revisionTrackingIcon.getAttribute("class")||"";o=-1===o.split(" ").indexOf(r.revisionTrackingIconClassName)?o.concat(" ",r.revisionTrackingIconClassName):o,r._revisionTrackingIcon.setAttribute("class",o)}else r._revisionTrackingIcon.classList.add(r.revisionTrackingIconClassName);r._revisionTrackingIcon.setAttribute("viewBox","0 0 16 16")}r._revisionTrackingIconPath=document.createElementNS("http://www.w3.org/2000/svg","path"),i.shouldDisplayModernCatchupUx?(r._revisionTrackingIconPath.setAttribute("d",r.c_modernRevisionTrackingIconPathAttribute),r._revisionTrackingIconPath.setAttribute("class",r.modernRevisionTrackingIconPathClassName)):r._revisionTrackingIconPath.setAttribute("d",r.c_revisionTrackingIconPathAttribute),r._revisionTrackingIcon.appendChild(r._revisionTrackingIconPath),r._revisionTrackingPawn.appendChild(r._revisionTrackingIcon),r._revisionTrackingPawnContainer.appendChild(r._revisionTrackingPawn),r._revisionTrackingContainer.appendChild(r._revisionTrackingPawnContainer),r._revisionTrackingFlyoutContainer=document.createElement("div"),i.shouldDisplayModernCatchupUx?r._revisionTrackingFlyoutContainer.classList.add(r.modernRevisionTrackingFlyoutContainerClassName):r._revisionTrackingFlyoutContainer.classList.add(r.revisionTrackingFlyoutContainerClassName),r._revisionTrackingFlyoutContainer.setAttribute("aria-hidden","true"),r._revisionTrackingFlyout=document.createElement("span"),r._revisionTrackingFlyout.innerText=null!=i.revisionTrackingFlyoutContent?i.revisionTrackingFlyoutContent:"",r._revisionTrackingFlyoutContainer.appendChild(r._revisionTrackingFlyout),r._revisionTrackingContainer.appendChild(r._revisionTrackingFlyoutContainer),t.appendChild(r._revisionTrackingContainer),r.hideRevisionTrackingFlyout();var d=new s.ViewBinding(r,"displayRevisionTrackingInfo");return d.addBinding({element:r._revisionTrackingContainer,onValueChanged:function(e){e?(r.shouldDisplayRevisionTrackingHint||r.hideRevisionTrackingFlyout(),r._revisionTrackingContainer.classList.remove(r.revisionTrackingViewHiddenClass)):r._revisionTrackingContainer.classList.add(r.revisionTrackingViewHiddenClass)}}),i.shouldDisplayModernCatchupUx||d.addBinding({element:r._revisionTrackingBackGroundView,onValueChanged:function(e){e?r._revisionTrackingBackGroundView.classList.remove(r.revisionTrackingViewHiddenClass):r._revisionTrackingBackGroundView.classList.add(r.revisionTrackingViewHiddenClass)}}),r._revisionTrackingPawn.onmouseover=function(e){e.preventDefault(),r.showRevisionTrackingFlyout(),l.ChangeGate.isChangeGateEnabled("ThumbnailCatchupBlueDot")&&e&&r.hasActiveFocus&&n.onCatchupEvent.signal(null,{catchupMouseOver:!0})},r._revisionTrackingPawn.onmouseout=function(e){e.preventDefault(),r.hideRevisionTrackingFlyout(),l.ChangeGate.isChangeGateEnabled("ThumbnailCatchupBlueDot")&&e&&r.hasActiveFocus&&n.onCatchupEvent.signal(null,{catchupMouseOut:!0})},r}return r(t,e),t.prototype.showRevisionTrackingFlyout=function(){this._revisionTrackingFlyoutContainer.classList.remove(this.revisionTrackingViewHiddenClass)},t.prototype.hideRevisionTrackingFlyout=function(){this._revisionTrackingFlyoutContainer.classList.add(this.revisionTrackingViewHiddenClass)},t}(o.View);t.RevisionTrackingView=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.DragOverFrameViewModel=void 0;var o=i(5),s=i(39),a=i(0),l=i(6),d=function(e){function t(t,i,n,r){var o=e.call(this,i)||this;return o._view=new s.DragOverFrameView(t,i),new a.ViewModelBinding(o,"isHidden").addBinding({target:o._view}),new a.ViewModelBinding(o,"isShowingDragOverRedLine").addBinding({target:o._view}),new a.ViewModelBinding(o,"slideIndex").addBinding({target:o._view,onValueChanged:function(e){o.m_dropContainer.objectData.index=e}}),o._slideIndex=r,o.m_dragDropManager=n,(o.m_slideGridSettings=t).allowMoveSlide&&(o.m_dropContainer=o.m_dragDropManager.addNewDropContainer(o._view.container,new l.ObjectData(l.DragDropObjectType.SlidePlaceholder,o._slideIndex))),o.isHidden=!0,o}return r(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&this.m_dragDropManager.removeDropContainer(this.m_dropContainer)},t}(o.ViewModel);t.DragOverFrameViewModel=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.DragOverFrameView=void 0;var o=i(3),s=i(0),a=i(4),l=function(e){function t(t,i){var n=e.call(this,i)||this;return n.visibleStyleClassName="drag-over-frame-view-visible-class",n.hiddenStyleClassName="drag-over-frame-view-hidden-class",n.redlineStyleClassName="drag-over-frame-view-indicator-class",n.innerRedlineStyleClassName="drag-over-frame-view-inner-indicator-class",n._elementId="drag-over-frame-view-id".concat((0,a.v4)()),n.innerRedlinePaddingLength=23,n._container.id=n._elementId,n._container.classList.add(n.hiddenStyleClassName),n.m_dragOverRedLineDiv=document.createElement("div"),n.m_dragOverRedLineInnerDiv=document.createElement("div"),n.m_dragOverRedLineDiv.appendChild(n.m_dragOverRedLineInnerDiv),n._container.appendChild(n.m_dragOverRedLineDiv),new s.ViewBinding(n,"isHidden").addBinding({element:n._container,onValueChanged:function(e){n._container.style.height=e?(n._container.classList.remove(n.visibleStyleClassName),n._container.classList.add(n.hiddenStyleClassName),n._container.style.width="0px"):(n._container.classList.remove(n.hiddenStyleClassName),n._container.classList.add(n.visibleStyleClassName),n._container.style.width="".concat(t.slideWidth+34,"px"),"".concat(t.slideHeight+50,"px"))}}),new s.ViewBinding(n,"isShowingDragOverRedLine").addBinding({element:n.m_dragOverRedLineDiv,onValueChanged:function(e){e?(n.m_dragOverRedLineDiv.classList.add(n.redlineStyleClassName),n.m_dragOverRedLineInnerDiv.classList.add(n.innerRedlineStyleClassName)):(n.m_dragOverRedLineDiv.classList.remove(n.redlineStyleClassName),n.m_dragOverRedLineInnerDiv.classList.remove(n.innerRedlineStyleClassName))}}),n.m_dragOverRedLineInnerDiv.style.height="".concat((t.slideHeight+n.innerRedlinePaddingLength).toString(),"px"),n}return r(t,e),t}(o.View);t.DragOverFrameView=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropContainer=void 0;var n=i(9),r=function(){function e(e,t){this.m_objectData=t,this.m_container=e}return Object.defineProperty(e.prototype,"objectData",{get:function(){return this.m_objectData},set:function(e){this.m_objectData=e},enumerable:!1,configurable:!0}),e.prototype.dropContainerPosition=function(e,t){var i=this.m_container.getBoundingClientRect(),r=i.left+(i.right-i.left)/2,o=i.top+.1*(i.bottom-i.top),s=i.bottom-.1*(i.bottom-i.top);return t<o?n.DropContainerPosition.ContainerTop:s<=t?n.DropContainerPosition.ContainerBottom:e<r?n.DropContainerPosition.ContainerLeft:n.DropContainerPosition.ContainerRight},e.prototype.isDraggableInRange=function(e,t){var i=this.m_container.getBoundingClientRect();return i.top<=t&&i.bottom>t&&i.right>=e&&i.left<e},e}();t.DropContainer=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Draggable=void 0;var n=i(42),r=i(2),o=function(){function e(e,t,i,o){var s=this;this.draggableContainer=null,this.originalSourceContainer=e,this.m_objectData=t,this.m_dragStartEvent=new r.Event,this.m_dragMoveEvent=new r.Event,this.m_dragStopEvent=new r.Event,this.m_dragToTopEvent=new r.Event,this.m_dragToBottomEvent=new r.Event,this.m_dragToCenterEvent=new r.Event,this.m_dragDropVisualFactory=i,this.m_scrollThreshold=o,this.sensor=new n.MouseSensor(this.originalSourceContainer,this.m_scrollThreshold),this.sensor.dragStartSensorEvent.subscribe((function(){s.m_isDragReady&&s.onDragStart()})),this.sensor.dragMoveSensorEvent.subscribe((function(e,t){s.onDragMove(t)})),this.sensor.dragStopSensorEvent.subscribe((function(e,t){s.onDragStop(t)})),this.sensor.dragDismissSensorEvent.subscribe((function(e,t){s.onDragDismiss(t)})),this.sensor.dragToTopSensorEvent.subscribe((function(){s.onDragToTop()})),this.sensor.dragToBottomSensorEvent.subscribe((function(){s.onDragToBottom()})),this.sensor.dragToCenterSensorEvent.subscribe((function(){s.onDragToCenter()}))}return e.prototype.onDragToCenter=function(){this.m_dragToCenterEvent.signal(null,null)},e.prototype.onDragToBottom=function(){this.m_dragToBottomEvent.signal(null,null)},e.prototype.onDragToTop=function(){this.m_dragToTopEvent.signal(null,null)},e.prototype.onDragStart=function(){this.m_dragStartEvent.signal(null,{objectData:this.m_objectData}),this.draggableContainer=this.m_dragDropVisualFactory.createDragDropVisual(this.originalSourceContainer),this.sensor.draggableContainer=this.draggableContainer},e.prototype.onDragMove=function(e){null!=this.draggableContainer&&(document.body.appendChild(this.draggableContainer),this.m_dragMoveEvent.signal(null,{pageX:e.pageX,pageY:e.pageY,objectData:this.m_objectData}))},e.prototype.onDragStop=function(e){try{this.m_dragStopEvent.signal(null,{objectData:this.m_objectData,pageX:e.pageX,pageY:e.pageY}),null!=this.draggableContainer&&(document.body.removeChild(this.draggableContainer),this.draggableContainer=null)}catch(e){}},e.prototype.onDragDismiss=function(e){try{this.m_dragStopEvent.signal(null,e),null!=this.draggableContainer&&(document.body.removeChild(this.draggableContainer),this.draggableContainer=null)}catch(e){}},Object.defineProperty(e.prototype,"dragStartEvent",{get:function(){return this.m_dragStartEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragMoveEvent",{get:function(){return this.m_dragMoveEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragStopEvent",{get:function(){return this.m_dragStopEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragToBottomEvent",{get:function(){return this.m_dragToBottomEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragToTopEvent",{get:function(){return this.m_dragToTopEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragToCenterEvent",{get:function(){return this.m_dragToCenterEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"objectData",{get:function(){return this.m_objectData},set:function(e){this.m_objectData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDragReady",{get:function(){return this.m_isDragReady},set:function(e){this.m_isDragReady=e},enumerable:!1,configurable:!0}),e}();t.Draggable=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MouseSensor=void 0;var n=i(2),r=i(1),o=function(){function e(e,t){this.m_dismissTimeoutHandle=-1,this.m_mouseLeaveHandlerBound=this.onMouseLeaveHandler.bind(this),this.m_mouseEnterHandlerBound=this.onMouseEnterHandler.bind(this),this.m_originalSourceContainer=e,this.m_dragMoveSensorEvent=new n.Event,this.m_dragStartSensorEvent=new n.Event,this.m_dragStopSensorEvent=new n.Event,this.m_dragDismissSensorEvent=new n.Event,this.m_dragToBottomSensorEvent=new n.Event,this.m_dragToTopSensorEvent=new n.Event,this.m_dragToCenterSensorEvent=new n.Event,this.m_isDragging=!1,this.m_scrollThreshold=t,this.onMouseDownHandler=this.onMouseDownHandler.bind(this),this.onMouseUpHandler=this.onMouseUpHandler.bind(this),this.onMouseMoveHandler=this.onMouseMoveHandler.bind(this),this.m_originalSourceContainer.addEventListener("mousedown",this.onMouseDownHandler)}return e.prototype.onMouseDownHandler=function(e){e.preventDefault(),0===e.button&&(document.addEventListener("mousemove",this.onMouseMoveHandler),document.addEventListener("mouseup",this.onMouseUpHandler),document.addEventListener("mouseleave",this.m_mouseLeaveHandlerBound),document.addEventListener("mouseenter",this.m_mouseEnterHandlerBound),this.m_horizontalShift=e.pageX-this.m_originalSourceContainer.getBoundingClientRect().left,this.m_verticalShift=e.pageY-this.m_originalSourceContainer.getBoundingClientRect().top,this.m_dragStartSensorEvent.signal(null,{pageX:e.pageX-this.m_horizontalShift,pageY:e.pageY-this.m_verticalShift}),this.m_originalSourceContainer.removeEventListener("mousedown",this.onMouseDownHandler),this.m_mouseDownX=e.pageX,this.m_mouseDownY=e.pageY)},e.prototype.onMouseMoveHandler=function(e){e.preventDefault();var t=!1;if(1<Math.abs(e.pageX-this.m_mouseDownX)&&1<Math.abs(e.pageY-this.m_mouseDownY)){t=!0;var i=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;null!==i&&(this.m_draggableContainer.style.left="".concat(e.pageX-this.m_horizontalShift,"px"),this.m_draggableContainer.style.top="".concat(e.pageY-this.m_verticalShift,"px"),this.m_dragMoveSensorEvent.signal(null,{pageX:this.m_horizontalMidpoint,pageY:this.m_verticalMidpoint,target:i})),this.m_isDragging=!0,this.clearDismissTimeoutHandler()}!t&&r.ChangeGate.isChangeGateEnabled("SlideGridDragFix")||(e.pageY>window.innerHeight-this.m_scrollThreshold?this.m_dragToBottomSensorEvent.signal(null,null):e.pageY<this.m_scrollThreshold?this.m_dragToTopSensorEvent.signal(null,null):this.m_dragToCenterSensorEvent.signal(null,null))},e.prototype.onMouseUpHandler=function(e){if(e.preventDefault(),this.m_isDragging){var t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;null!==t?(this.m_dragStopSensorEvent.signal(null,{target:t,pageX:this.m_horizontalMidpoint,pageY:this.m_verticalMidpoint}),this.m_isDragging=!1):this.m_dragDismissSensorEvent.signal(null,null)}this.finishMouseSensing()},e.prototype.onMouseLeaveHandler=function(e){e.preventDefault(),this.registerDismissTimeoutHandler()},e.prototype.onMouseEnterHandler=function(e){e.preventDefault(),this.registerDismissTimeoutHandler()},e.prototype.registerDismissTimeoutHandler=function(){var e=this;this.clearDismissTimeoutHandler(),this.m_dismissTimeoutHandle=window.setTimeout((function(){e.m_dragDismissSensorEvent.signal(null,null),e.finishMouseSensing()}),500)},e.prototype.clearDismissTimeoutHandler=function(){0<=this.m_dismissTimeoutHandle&&window.clearTimeout(this.m_dismissTimeoutHandle)},Object.defineProperty(e.prototype,"m_horizontalMidpoint",{get:function(){var e=this.m_draggableContainer.getBoundingClientRect().right-this.m_draggableContainer.getBoundingClientRect().left;return this.m_draggableContainer.getBoundingClientRect().left+Math.round(e/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"m_verticalMidpoint",{get:function(){var e=this.m_draggableContainer.getBoundingClientRect().bottom-this.m_draggableContainer.getBoundingClientRect().top;return this.m_draggableContainer.getBoundingClientRect().top+Math.round(e/2)},enumerable:!1,configurable:!0}),e.prototype.finishMouseSensing=function(){this.clearDismissTimeoutHandler(),document.removeEventListener("mousemove",this.onMouseMoveHandler),document.removeEventListener("mouseup",this.onMouseUpHandler),document.removeEventListener("mouseleave",this.m_mouseLeaveHandlerBound),document.removeEventListener("mouseenter",this.m_mouseEnterHandlerBound),this.m_originalSourceContainer.addEventListener("mousedown",this.onMouseDownHandler),this.m_isDragging=!1,this.m_mouseDownX=-1,this.m_mouseDownY=-1},Object.defineProperty(e.prototype,"dragStopSensorEvent",{get:function(){return this.m_dragStopSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragMoveSensorEvent",{get:function(){return this.m_dragMoveSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragStartSensorEvent",{get:function(){return this.m_dragStartSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDismissSensorEvent",{get:function(){return this.m_dragDismissSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragToBottomSensorEvent",{get:function(){return this.m_dragToBottomSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragToTopSensorEvent",{get:function(){return this.m_dragToTopSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragToCenterSensorEvent",{get:function(){return this.m_dragToCenterSensorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"draggableContainer",{set:function(e){this.m_draggableContainer=e},enumerable:!1,configurable:!0}),e}();t.MouseSensor=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragDropVisualFactory=void 0;var n=function(){function e(e){this.singleDraggableStyleClassName="single-select-draggable-class",this.multipleDraggableOuterContainerStyleClassName="multiple-select-draggable-outer-container-class",this.multipleDraggableInnerContainerStyleClassName="multiple-select-draggable-inner-container-class",this.clonedSlideStyleClassName="draggable-cloned-style-class",this.clonedImageStyleClassName="draggable-cloned-image-style-class",this.draggableContainerCountStyleClassName="draggable-count-container-class",this.primarytabbedDraggableStyleClassName="primary-tabbed-draggable-container-class",this.secondarytabbedDraggableStyleClassName="secondary-tabbed-draggable-container-class",this.m_dragReadyElements=e}return Object.defineProperty(e.prototype,"dragReadyElements",{get:function(){return this.m_dragReadyElements},set:function(e){this.m_dragReadyElements=e},enumerable:!1,configurable:!0}),e.prototype.createDragDropVisual=function(e){var t;if(this.m_dragReadyElements&&1<this.m_dragReadyElements.length){(t=document.createElement("div")).className=this.multipleDraggableOuterContainerStyleClassName;var i=e.cloneNode(!0),n=document.createElement("div");n.className=this.multipleDraggableInnerContainerStyleClassName,i.children[0].className=this.clonedSlideStyleClassName,i.children[0].children[0].className=this.clonedImageStyleClassName;var r=document.createElement("div");r.className=this.draggableContainerCountStyleClassName;var o=document.createElement("span");o.innerText=this.m_dragReadyElements.length.toString();var s=document.createElement("div");if(s.className=this.primarytabbedDraggableStyleClassName,2<this.m_dragReadyElements.length){var a=document.createElement("div");a.className=this.secondarytabbedDraggableStyleClassName,n.appendChild(a)}r.appendChild(o),n.appendChild(i),n.appendChild(r),n.appendChild(s),t.appendChild(n)}else(t=e.cloneNode(!0)).className=this.singleDraggableStyleClassName;return t.setAttribute("aria-hidden","true"),t},e}();t.DragDropVisualFactory=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideGridEvents=void 0;var n=i(2),r=function(){function e(){this._onSlideSelectionChanged=new n.Event,this._onMoveSection=new n.Event,this._onCommentCountClick=new n.Event,this._onCatchupEvent=new n.Event,this._onShiftArrowKeyScroll=new n.Event,this._onVisibleSlideRangeChanged=new n.Event,this._onSlideGridScrolled=new n.Event,this._onMoveSlide=new n.Event,this._onSectionTitleUpdate=new n.Event,this._onActiveSectionFocusChanged=new n.Event,this._onSectionSelectionChanged=new n.Event,this._onInsertBetweenSlidesPositionChanged=new n.Event}return Object.defineProperty(e.prototype,"onSlideSelectionChanged",{get:function(){return this._onSlideSelectionChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMoveSection",{get:function(){return this._onMoveSection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCommentCountClick",{get:function(){return this._onCommentCountClick},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCatchupEvent",{get:function(){return this._onCatchupEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onShiftArrowKeyScroll",{get:function(){return this._onShiftArrowKeyScroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSectionSelectionChanged",{get:function(){return this._onSectionSelectionChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onVisibleSlideRangeChanged",{get:function(){return this._onVisibleSlideRangeChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSlideGridScrolled",{get:function(){return this._onSlideGridScrolled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMoveSlide",{get:function(){return this._onMoveSlide},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSectionTitleUpdate",{get:function(){return this._onSectionTitleUpdate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onActiveSectionFocusChanged",{get:function(){return this._onActiveSectionFocusChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onInsertBetweenSlidesPositionChanged",{get:function(){return this._onInsertBetweenSlidesPositionChanged},enumerable:!1,configurable:!0}),e}();t.SlideGridEvents=r},,,,,,,function(e,t){}]);
//# sourceMappingURL=SlideGrid.js.map
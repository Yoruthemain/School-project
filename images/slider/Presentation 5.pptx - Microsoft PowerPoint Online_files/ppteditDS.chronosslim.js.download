/*
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource>  The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1007:function(L){var V=function(){return this}();try{V=V||(new Function("return this"))()}catch(d){"object"===typeof window&&(V=window)}L.exports=V},1008:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.message=this.title=null;this.Aug=!1;this.RNb=null;this.Fug=!1;this.kxd=null;this.iLl=this.Tkl=0;this.jLl=this.Ukl=null;this.timeoutInSeconds=0;this.f1j=!1;this.Z5j=null}}Object(L.a)(k,
"CalloutNotificationMessageAttributes",null,[])},1009:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.handler=null}}Object(L.a)(k,"SetAnnotationResultCallbackParameters",null,[])},1087:function(L,V,d){L=d(0);class k{constructor(n,r,w){this.QXc=n;this.$0h=r;this.Oif=w}}Object(L.a)(k,"ThemeData",null,[]);d.d(V,"a",function(){return e});class e{}e.UAa=[new k("2e142a2c-cd16-42d6-873a-c26d2a0506fa","OfficeTheme2023",4),new k("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",
4),new k("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new k("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new k("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new k("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new k("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new k("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new k("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new k("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new k("98dff888-2449-4d28-977c-6306c017633e",
"Banded",4),new k("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new k("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new k("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new k("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new k("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new k("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new k("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new k("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new k("4c5440d6-04d2-4954-96cf-f251137069b2",
"Metropolitan",8),new k("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new k("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new k("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new k("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(L.a)(e,"DesignManager_data",null,[])},1183:function(L,V,d){(function(k){d.d(V,"a",function(){return E});var e=d(92),n=d(0),r=d(29),w=d(37),D=d(27),y=d(1300),m=d(1301),C=d(30);class E{constructor(F,B,H,K,A,W,N,P,U,Q,G){this.V6=this.hv=null;this.gvd=(Y,
ba,ha,ka,ca)=>{this.actionId=Y;this.hv=this.oa.Zn();return this.APh(!0)?1===ha?32:ca?2===ha&&(this.aic.Bnb(!0,!1),Y={},D.a.J(508908313,y.a.lkb,m.a.info,"PictureBackgroundActor::removePictureBackground triggered."),this.Tgj(Y),this.lWj(this.hv,Y))?32:16:16:8};this.ewd=(Y,ba,ha,ka,ca)=>{const ia=this.oa.Zn();if(!this.APh(!1))return 8;if(1===ha)return 32;if(!ca)return 16;D.a.J(508703427,y.a.lkb,m.a.info,"PictureBackgroundActor::restorePictureBackground triggered.");this.aic.Bnb(!0,!1);this.V6=this.sa.Aa;
ba=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.Dr.YA=ia;this.oa.selectShape(ia,!0)});try{this.hv=ia,ba.mc(this.V6),ba.Wc=Y,this.hv.Zeb=!1}finally{ba&&ba.dispose(),this.aic.Bnb(!1,!1)}return 32};if(!F)throw Error.argumentNull("actionManager");if(!B)throw Error.argumentNull("appOfflineSetter");if(!H)throw Error.argumentNull("selectionManager");if(!K)throw Error.argumentNull("imageManager");this.ia=F;this.aic=B;this.oa=H;this.HC=K;this.yb=A;this.sa=W;this.Eb=P;this.Fa=
N;this.Dr=U;this.c7j=Q;this.uI=G}qb(){this.ia.pa(r.a.gvd,w.a.application,this.gvd,4);this.ia.pa(r.a.ewd,w.a.application,this.ewd,4)}Sd(){}lWj(F,B){return(F=this.ik(F))&&F.Nk&&(F=F.Nk)?F.Hsc("RemoveBackgroundAction",B):!1}ik(F){return F?F.sc(this.yb.Na):null}Tgj(F){F.type="RemoveBackgroundPayload";F.useMask=!0;F.downsample=!0;var B=this.zbg(this.sa.Aa,this.hv,13,-1),H=500,K=500;B&&B.Base64Data&&(K=this.zbg(this.sa.Aa,this.hv,1,this.hv.mg),H=new URL(B.Base64Data),F.originalUrl=H,H=K?K.Height:B.Height,
K=K?K.Width:B.Width);B={};H=new URL(`data:image/svg+xml;base64, ${k.from(this.nIj(H,K)).toString("base64")}`,window.location.origin);B.url=H;B.renderAsSvg=!0;B.overlay=!0;B.cropToGeometry=!0;F.placeholder=B;F.resultHandler=this.mll.bind(this);F.updatePicture=!1}nIj(F,B){F=this.fel(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" style="width:100%;" viewBox="0 0 ${B} ${F}">
    <defs>
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_1_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
       values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_0_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
      values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animate attributeType="XML" attributeName="opacity" dur="1s" from="0" to="1" xlink:href="#time_group" />
    </defs>
    <g id="_R_G">
      <rect width="100%" height="100%" fill="rgba(179,179,179,0.5)" filter='blur(12px)' />
      <g id="_R_G_L_1_G" transform=" translate(${B/2}, ${F/2})
     translate(0, 0)" />
      <g id="_R_G_L_0_G" transform=" translate(${B/2}, ${F/2})
     translate(-14, -14)">
        <g id="_R_G_L_0_G_L_1_G_N_2_T_0" transform=" translate(14, 14) scale(2, 2)">
          <g id="_R_G_L_0_G_L_1_G">
            <path id="_R_G_L_0_G_L_1_G_D_0_P_0" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="3" stroke-opacity="1"
             d=" M0 -12 C6.62,-12 12,-6.62 12,0 C12,6.62 6.62,12 0,12 C-6.62,
             12 -12,6.62 -12,0 C-12,-6.62 -6.62,-12 0,-12z " />
          </g>
        </g>
        <g id="_R_G_L_0_G_L_0_G_N_2_T_0" transform=" translate(14, 14)">
          <g id="_R_G_L_0_G_L_0_G" transform=" rotate(3.724)
      scale(0.2, 0.2)">
            <path id="_R_G_L_0_G_L_0_G_D_0_P_0" fill="#C43E1C" fill-opacity="1" fill-rule="nonzero"
            d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,-127.25 -55.5,-123 C-63.75,-118.75 -71.87,
            -114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,-100.25 -99,-92.5 C-105.62,-84.75 -110.5,
            -79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,-46.75 C-129.5,-39.87 -133.14,
            -27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,8.38 -134.87,12 -134.5,
            16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
            17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,
            -20.37 C-102.12,-26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,
            -55 C-86.12,-60.62 -83.12,-64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,
            -83.37 C-59.25,-86.62 -51.25,-91.87 -46,-94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,
            -99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
            <path id="_R_G_L_0_G_L_0_G_D_1_P_0" stroke="#C43E1C" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="1" stroke-opacity="1" d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,
             -127.25 -55.5,-123 C-63.75,-118.75 -71.87,-114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,
             -100.25 -99,-92.5 C-105.62,-84.75 -110.5,-79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,
             -46.75 C-129.5,-39.87 -133.14,-27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,
             8.38 -134.87,12 -134.5,16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
             17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,-20.37 C-102.12,
             -26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,-55 C-86.12,-60.62 -83.12,
             -64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,-83.37 C-59.25,-86.62 -51.25,-91.87 -46,
             -94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,-99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
          </g>
        </g>
      </g>
    </g>
    <g id="time_group" />
  </svg>`);return this.DNl(F)}fel(F){F=(new DOMParser).parseFromString(F,"image/svg+xml");if(0!==F.querySelectorAll("parsererror").length)throw Error("The XML could not be read");return F.firstElementChild}DNl(F){return(new XMLSerializer).serializeToString(F)}mll(F){var B,H;return Object(e.b)(this,void 0,void 0,function*(){F.succeeded?(D.a.J(508921416,y.a.lkb,m.a.info,"PictureBackgroundActor::processBackgroundRemovalResults Success. Status: '{0}', ExecutionTime: '{1}' ms.",F.succeeded,null===(B=F.Hal)||
void 0===B?void 0:B.toFixed(2)),this.tHi=F.result.picture.url,yield this.n0j(this.actionId,this.tHi)):(this.aic.Bnb(!1,!1),this.V_l(),D.a.J(508921415,y.a.lkb,m.a.error,"PictureBackgroundActor::processBackgroundRemovalResults Failed. Status: '{0}', ExecutionTime: '{1}' ms.",F?F.message:"unknown",null===(H=F.Hal)||void 0===H?void 0:H.toFixed(2)))})}n0j(F,B){return Object(e.b)(this,void 0,void 0,function*(){this.V6=this.sa.Aa;const H=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},
()=>{this.Dr.YA=this.hv;this.oa.selectShape(this.hv,!0)});try{H.mc(this.V6),H.Wc=F,C.a("PPTOImgSrcBgrAttr")?this.hv.Ifa=B.href:this.hv.sdc=B.href,this.hv.Zeb=!0}finally{H&&H.dispose(),this.aic.Bnb(!1,!1)}})}APh(F){var B,H,K;const A=this.oa.Hd();return A?1==A.length&&(null===(B=A[0])||void 0===B?void 0:B.$j)&&(null===(H=A[0])||void 0===H?void 0:H.Twe)&&(null===(K=A[0])||void 0===K?void 0:K.Zeb)!==F:!1}zbg(F,B,H,K){const A=F?F.Fb:null;B=B.get_shapeId();F=this.c7j.V1c(A,B,H,F.yq,F.yl,K);D.a.J(508908312,
y.a.lkb,m.a.info,"PictureBackgroundActor::fetchImageData fetching image data.");({data:F}=this.HC.odc.vwc(F));if(F)return F;D.a.J(508923986,y.a.lkb,m.a.error,"PictureBackgroundActor::fetchImageData image data cannot be fetched for image id")}V_l(){this.uI.rca(ResourceStrings.l_UnexpectedBEHTitle,ResourceStrings.l_GenericErrorMessage,!1,null,!1,null,0,0,null,null,!0,E.yQc,!1,null)}}E.yQc=20;Object(n.a)(E,"PictureBackgroundActor",null,[948])}).call(this,d(706).GGd)},1184:function(L,V){function d(r){var w=
r.length;if(0<w%4)throw Error("Invalid string. Length must be a multiple of 4");r=r.indexOf("=");-1===r&&(r=w);return[r,r===w?0:4-r%4]}V.byteLength=function(r){r=d(r);var w=r[1];return 3*(r[0]+w)/4-w};V.Z$l=function(r){var w=d(r);var D=w[0];w=w[1];var y=new n(3*(D+w)/4-w),m=0,C=0<w?D-4:D,E;for(E=0;E<C;E+=4)D=e[r.charCodeAt(E)]<<18|e[r.charCodeAt(E+1)]<<12|e[r.charCodeAt(E+2)]<<6|e[r.charCodeAt(E+3)],y[m++]=D>>16&255,y[m++]=D>>8&255,y[m++]=D&255;2===w&&(D=e[r.charCodeAt(E)]<<2|e[r.charCodeAt(E+1)]>>
4,y[m++]=D&255);1===w&&(D=e[r.charCodeAt(E)]<<10|e[r.charCodeAt(E+1)]<<4|e[r.charCodeAt(E+2)]>>2,y[m++]=D>>8&255,y[m++]=D&255);return y};V.Deg=function(r){for(var w=r.length,D=w%3,y=[],m=0,C=w-D;m<C;m+=16383){for(var E=y,F=E.push,B,H=r,K=m+16383>C?C:m+16383,A=[],W=m;W<K;W+=3)B=(H[W]<<16&16711680)+(H[W+1]<<8&65280)+(H[W+2]&255),A.push(k[B>>18&63]+k[B>>12&63]+k[B>>6&63]+k[B&63]);B=A.join("");F.call(E,B)}1===D?(r=r[w-1],y.push(k[r>>2]+k[r<<4&63]+"==")):2===D&&(r=(r[w-2]<<8)+r[w-1],y.push(k[r>>10]+k[r>>
4&63]+k[r<<2&63]+"="));return y.join("")};var k=[],e=[],n="undefined"!==typeof Uint8Array?Uint8Array:Array;for(L=0;64>L;++L)k[L]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[L],e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(L)]=L;e[45]=62;e[95]=63},1185:function(L,V){V.read=function(d,k,e,n,r){var w=8*r-n-1;var D=(1<<w)-1,y=D>>1,m=-7;r=e?r-1:0;var C=e?-1:1,E=d[k+r];r+=C;e=E&(1<<-m)-1;E>>=-m;for(m+=w;0<m;e=256*e+d[k+r],r+=C,m-=8);w=e&(1<<-m)-1;
e>>=-m;for(m+=n;0<m;w=256*w+d[k+r],r+=C,m-=8);if(0===e)e=1-y;else{if(e===D)return w?NaN:Infinity*(E?-1:1);w+=Math.pow(2,n);e-=y}return(E?-1:1)*w*Math.pow(2,e-n)};V.write=function(d,k,e,n,r,w){var D,y=8*w-r-1,m=(1<<y)-1,C=m>>1,E=23===r?Math.pow(2,-24)-Math.pow(2,-77):0;w=n?0:w-1;var F=n?1:-1,B=0>k||0===k&&0>1/k?1:0;k=Math.abs(k);isNaN(k)||Infinity===k?(k=isNaN(k)?1:0,n=m):(n=Math.floor(Math.log(k)/Math.LN2),1>k*(D=Math.pow(2,-n))&&(n--,D*=2),k=1<=n+C?k+E/D:k+E*Math.pow(2,1-C),2<=k*D&&(n++,D/=2),n+
C>=m?(k=0,n=m):1<=n+C?(k=(k*D-1)*Math.pow(2,r),n+=C):(k=k*Math.pow(2,C-1)*Math.pow(2,r),n=0));for(;8<=r;d[e+w]=k&255,w+=F,k/=256,r-=8);n=n<<r|k;for(y+=r;0<y;d[e+w]=n&255,w+=F,n/=256,y-=8);d[e+w-F]|=128*B}},1186:function(L){var V={}.toString;L.exports=Array.isArray||function(d){return"[object Array]"==V.call(d)}},1204:function(L,V,d){L=d(0);var k=d(1264),e=d(303),n=d(304),r=d(7),w=d(67),D=d(99);class y extends e.a{constructor(N,P){super(N);this.Ph=null;this.Lda=P.get(8,!1);this.yja=P.get(6,0);this.element=
N;this.element.className=y.j$b;this.e9a=this.createElement("ul");this.element.appendChild(this.e9a);this.er=P.get(10);this.er.xb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick"));this.LA=P.get(9);this.LA.xb(w.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut"));this.LA.xb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior"));this.V_=P.get(13);this.V_.xb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior"))}t9(N){this.addHandler(n.a.Ax,
N)}xqa(N){this.removeHandler(n.a.Ax,N)}get Oca(){return this.Ph}dispose(){this.element&&(this.er.Hb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.LA.Hb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.LA.Hb(w.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut")),this.V_.Hb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(N,P,U){this.hide();!N||
0>=N.length||(this.Lda?this.element.style.right=P+"px":this.element.style.left=P+"px",this.element.style.top=U+"px",this.IZd(N),this.visible=!0)}IZd(N){this.Ph=N;D.a.qw(this.e9a);for(let P=N.length-1;0<=P;P--)this.$B(N[P])}$B(N){const P=document.createElement("li");P.style.backgroundColor=N.color;P.style.height=this.yja+"px";P.id="fly_"+N.clientId;P.style.lineHeight=this.yja+"px";D.a.yA(P,N.userName);P.setAttribute("dir","auto");this.e9a.appendChild(P)}onClick(){this.hide();return!1}hH(N){this.raiseEvent(n.a.Ax,
new n.a(3,N));return!1}}y.j$b="prFlyout UIFont";Object(L.a)(y,"PresenceTooltipFlyoutControl",e.a,[]);var m=d(78);class C extends e.a{constructor(N,P,U){super(N);this.d0=null;this.Ph=[];this.element.className="prGlyph";this.nd=P;this.f9=this.nd.get(9);this.to=this.nd.get(10);this.V_=this.nd.get(13);this.soe();this.$B(U);this.f7a=!1}get gQ(){return this.Ph.length}get Oca(){return this.Ph}t9(N){this.addHandler(n.a.Ax,N)}xqa(N){this.removeHandler(n.a.Ax,N)}dispose(){this.Ogf();super.dispose()}$B(N){Array.add(this.Ph,
N);2===this.gQ?this.Lca(!0):1===this.gQ?this.Lca(!1):this.Lca(this.f7a)}qQ(N){this.Gde(N)&&(1<this.gQ&&this.Lca(!0),1===this.gQ?this.Lca(!1):1>this.gQ&&this.hide())}show(){this.Lca(2<=this.gQ);this.visible=!0}hide(){this.visible=!1}hie(N){return N?this.V$b(0,5):this.V$b(1,4)}Gde(N){for(let P=0;P<this.gQ;P++)if(this.Ph[P].clientId===N)return N=this.Ph[P],Array.removeAt(this.Ph,P),N;return null}Lca(N){this.f7a!==N&&(this.d0&&this.element.removeChild(this.d0),this.d0=this.hie(N),this.element.appendChild(this.d0),
this.f7a=N);this.d0.childNodes[0].style.backgroundColor=this.Ph[this.Ph.length-1].color}V$b(N,P){const U=this.nd.get(6,0),Q=this.nd.get(14);return m.createClusteredImageFromClusterWithImageClass(U,U,this.nd.get(N),this.nd.get(P),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,Q?Q.cloneNode(!0):null)}FN(N){3!==N.wg&&this.raiseEvent(n.a.Ax,new n.a(2,N));return!1}onClick(N){this.raiseEvent(n.a.Ax,new n.a(1,N));return!0}hH(N){3!==N.wg&&this.raiseEvent(n.a.Ax,new n.a(3,N));return!1}Ogf(){this.element&&
(this.f9.Hb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.f9.Hb(w.a.aD,this.element,Object(r.a)(this,this.FN,"onPointerOver")),this.f9.Hb(w.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut")),this.to.Hb(w.a.doubleClick,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.to.Hb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.V_.Hb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")))}soe(){this.element&&
(this.f9.xb(w.a.BB,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.f9.xb(w.a.aD,this.element,Object(r.a)(this,this.FN,"onPointerOver")),this.f9.xb(w.a.qE,this.element,Object(r.a)(this,this.hH,"onPointerOut")),this.to.xb(w.a.doubleClick,this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")),this.to.xb(w.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.V_.xb(this.element,Object(r.a)(this,this.$F,"stopPropagationAndPreventDefaultBehavior")))}}
Object(L.a)(C,"PresenceTooltipGlyph",e.a,[]);var E=d(124);d(64);var F=d(197);class B extends e.a{constructor(N,P,U){super(N);this.Ph=[];this.Wm=[];this.zJ=0;this.ska=this.K8=!1;this.wVb=null;this.LZ=(Q,G)=>{var Y=Object(k.a)(C,Q);Y=Y?this.H9b(Y):-1;if(2===G.type||1===G.type&&-1!==Y&&!this.qx[Y].visible)this.kMa(Q);else if(1===G.type)this.eY(),this.K8=!1;else if(3===G.type){if(this.dXc(G.Uj))return;this.K8||this.eY()}this.raiseEvent(n.a.Ax,G)};this.Kja={};this.nd=U;this.Ll=U.get(8,!1);this.HH=U.get(11,
!1);N=U.get(12,0);this.A5=U.get(6,0);this.oub=P;this.element.id=B.E$b();this.element.className=e.a.p8d(this.Ll);N&&(this.zIndex=N);this.rtl=this.Ll;this.mxc(P);this.GA=this.createElement("div");this.GA.className=this.HH?"prContainerV":"prContainerHr";this.element.appendChild(this.GA);this.KXb=Array(this.zJ);for(P=0;P<this.zJ;P++)this.qx[P]=new y(this.createElement("div"),this.nd),this.qx[P].t9(this.LZ),this.element.appendChild(this.qx[P].element)}get NNb(){return F.a.clone(this.Ph)}getGlyph(N){return this.Kja[N]}get qx(){return this.KXb}get A2b(){return this.wVb}get YNa(){return this.A5+
2}get width(){return this.HH?this.YNa:this.oub}get height(){return this.HH?this.oub:this.YNa}t9(N){this.addHandler(n.a.Ax,N)}xqa(N){this.removeHandler(n.a.Ax,N)}dispose(){if(this.qx)for(const N of this.qx)N.xqa(this.LZ),E.a.Iz(N);E.a.Zwd(this.Wm);this.Wm=this.KXb=null;super.dispose()}PNa(){this.eY();this.wob();this.visible=!0;this.K8=!1}JAd(){!this.Wm||1>this.Wm.length||(this.eY(),this.visible=!0,this.wob(),this.kMa(this.Wm[this.Wm.length-1]),this.K8=!0)}LNa(){if(this.Wm&&!(1>this.Wm.length)){this.visible=
!0;this.wob();var N=0;for(const P of this.Wm)this.kMa(P,N++);this.K8=!1;this.ska=!0}}hide(){this.visible=!1;this.eY();for(let N=0;N<this.Wm.length;N++)this.Wm[N].hide();this.K8=!1}s5b(){if(!this.ska)return!1;let N=0;for(const P of this.qx)P.visible&&N++;return this.ska=0<N&&(this.Ph.length<=this.zJ?N===this.Ph.length:N===this.zJ)}$B(N){if(!(0>=this.zJ)){N.clientId||(N.clientId=(B.DQa++).toString());if(N.clientId in this.Kja){var P=this.fma(N.clientId);if(0<=P){P=this.Ph[P];if(P.color===N.color&&P.userName===
N.userName)return;this.qQ(N.clientId)}}P=this.s5b();var U=0;if(this.Ph.length<this.zJ){var Q=new C(this.createElement("div"),this.nd,N);Q.t9(this.LZ);this.Ll&&!this.HH&&0<this.Ph.length?this.GA.insertBefore(Q.element,this.GA.firstChild):(this.GA.appendChild(Q.element),U=this.Wm.length);Array.add(this.Wm,Q)}else this.Ll&&!this.HH?Q=this.Wm[0]:(U=this.Wm.length-1,Q=this.Wm[U]),Q.$B(N);Q.show();this.Kja[N.clientId]=Q;Array.add(this.Ph,N);this.PBc(Q,U);P&&this.LNa()}}qQ(N){const P=this.s5b();P&&this.eY();
this.v2a(N);this.Ph.length>=this.zJ&&this.Wm.length<this.zJ&&this.G1e();0>=this.Ph.length?this.hide():P&&this.LNa()}dnd(){}v2a(N){var P=this.fma(N);0>P||(N=this.Ph[P],Array.removeAt(this.Ph,P),P=this.Kja[N.clientId],delete this.Kja[N.clientId],P.qQ(N.clientId),this.PBc(P),0>=P.gQ&&(this.GA.removeChild(P.element),Array.remove(this.Wm,P),P.dispose()))}BRb(){}G1e(){var N=this.rje();!N||1>=N.Oca.length||(N=Array.clone(this.Ph),N.forEach(P=>{this.v2a(P.clientId)}),N.forEach(P=>{this.$B(P)}))}fma(N){for(let P=
0;P<this.Ph.length;P++)if(this.Ph[P].clientId===N)return P;return-1}rje(){return this.Ll&&!this.HH?this.Wm[0]:this.Wm[this.Wm.length-1]}position(N,P){this.element.style.top=P+"px";this.element.style.left=N+"px"}wob(){for(let N=0;N<this.Wm.length;N++)this.Wm[N].show()}eY(){for(let N=0;N<this.zJ;N++)this.qx[N].hide();this.ska=!1}kMa(N,P=0){if(N)if(this.wVb=N,this.HH){const U=this.A5;if(1<N.Oca.length)this.qx[P].show(N.Oca,U,this.height-this.A5);else{const Q=this.GA.children.length;for(let G=0;G<this.GA.children.length;G++)N.element===
this.GA.children[G]&&this.qx[P].show(N.Oca,U,this.height-(Q-G)*this.YNa+2)}}else this.qx[P].show(N.Oca,this.width,0)}dXc(N){N=B.Tac(N);let P=!1;for(const U of this.qx)if(D.a.GXa(U.element,N)){P=!0;break}return this.GA!==N&&D.a.GXa(this.GA,N)||P}PBc(N,P=0){const U=this.Ute(N);U&&0>=N.gQ?this.qx[P].hide():U?this.kMa(N):this.qx[P].hide()}H9b(N){let P=0;for(const U of this.Wm){if(N===U)return P;P++}return-1}Ute(N){const P=this.H9b(N);return!!this.A2b&&N===this.A2b&&-1!==P&&this.qx[P].visible}mxc(N){this.zJ=
N===this.A5?1:Math.floor(N/this.YNa);this.HH?(this.element.style.height=N+"px",this.element.style.width=this.A5+"px"):(this.element.style.width=N+"px",this.element.style.height=this.A5+"px")}static E$b(){return String.format("{0}-{1}","presencetooltip",B.DQa++)}static Tac(N){N=N.hc.rawEvent;return N.relatedTarget||N.toElement}}B.DQa=0;Object(L.a)(B,"PresenceTooltipControl",e.a,[536,106]);var H=d(240),K=d(319),A=d(285);d.d(V,"a",function(){return W});class W{constructor(N){this.nd=N;this.nd.u0(10,
H.a.instance);this.nd.u0(9,A.a.instance);this.nd.u0(6,16);this.nd.u0(13,K.a.instance)}G7d(N,P){return new B(N,P,this.nd)}J6b(N){return new B(N,16,this.nd)}}Object(L.a)(W,"PresenceTooltipFactory",null,[531])},1218:function(L,V,d){L=d(0);class k{}k.taskPaneWidth=330;Object(L.a)(k,"AppsForOfficeConstants",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.showLoadingSpinner=!1;this.Vta=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.N7b=this.dialogTop=
this.Q7b=this.dialogLeft=null;this.taskPaneWidth=k.taskPaneWidth;this.BA=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onExtensionLaunchCallback=this.onTaskPaneClose=null;this.showResizeChatButton=this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.pVc=this.lVc=!0}}Object(L.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1302:function(L,V,d){d.d(V,"a",function(){return D});L=d(0);var k=d(83),e=d(122),n=d(25),
r=d(96),w=d(225);class D extends k.a{constructor(y,m=!1){super(y,!1,m)}get kEb(){return!1}get uM(){return w.a.P7b+"/modeless"}get yFb(){return null}set yFb(y){}get tFb(){return null}set tFb(y){}Vj(y,m=null,C=null){this.$L&&(C.isModal=!1);super.Vj(y,m,C)}hide(){if(n.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Nb)this.M2h(),n.AFrameworkApplication.za.Yx.zp(e.AFrame.j7),super.hide()}Xti(){const y=n.AFrameworkApplication.za.Yx,
m=n.AFrameworkApplication.za.Zs;y.y4(this.uM);y.Hka(this.uM);m.Kc(this.uM).parent=e.AFrame.Nj}Jka(){r.FocusManager.eO()&&(super.Jka(),this.Xti(),n.AFrameworkApplication.za.Yx.bM(e.AFrame.j7))}Amb(){if(r.FocusManager.eO()&&!n.AFrameworkApplication.Dh){const y=r.FocusManager.instance();y.P2(this.uM);const m=y.DR(this.uM);m&&m.jk.bG(null);y.rPb(this.uM)}}Uba(){"DL"===this.nta||"DP"===this.nta?super.Uba():n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.getBooleanAppSetting("WacAutoFitNonModalDialogIsEnabled")?
(this.M2h(),this.xQf()&&this.HSh(this.Nb.clientHeight,this.Nb.clientWidth)):this.IB()}IB(){this.HSh(k.a.yqf,k.a.Bqf)}HSh(y,m){if(this.tFb&&this.yFb){let C,E;C=w.a.etc+this.yFb;E=w.a.dtc+this.tFb;C+y>this.zma()&&(C=this.zma()-y);E+m>this.vva()&&(E=this.vva()-m);this.bBd(C,E)}else super.IB()}jje(y){if(!y)return null;y.endsWith("px")&&(y=y.substring(0,y.length-2));return w.a.sEb(y)?((y=parseInt(y))||(y=1),y):null}M2h(){if(this.Nb&&this.Nb.style){var y=this.jje(this.Nb.style.top);y&&(this.yFb=y-w.a.etc);
if(y=n.AFrameworkApplication.isRtl?this.jje(this.Nb.style.right):this.jje(this.Nb.style.left))this.tFb=y-w.a.dtc}}}Object(L.a)(D,"ModelessCustomDialog",k.a,[])},1307:function(L,V,d){d.r(V);var k=d(0),e=d(395),n=d(1268),r=d(1267),w=d(1264),D;(function(z){z[z.ctm=0]="applicationFeatureHelperHandler";z[z.Etm=1]="cloudPolicySettings";z[z.Ssm=2]="alternateAuthToken"})(D||(D={}));Object(k.b)("ApplicationFeatureHelperRequestType",D);class y{constructor(){this.message=null;this.lu=0}}Object(k.a)(y,"HttpRequstToPromiseRejectData",
null,[]);var m=d(97),C=d(74),E=d(160),F=d(411);class B{constructor(z,Z){this.La=z;this.Bi=Z}kab(z,Z,pa,Fa=null,Ma=null,tb=null,Hb=null,rc=null){const yc=D[pa],xc=yc+"RequestFailure";m.Health.instance.recordKpiUsage(xc,0,"jpittsdirects",null);return new Promise((ld,wd)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",yc);const t=null!=Hb?Hb:this.La.tc("ApplicationFeatureHelperRequestQueueTimeout",15E3),aa=null!=rc?rc:this.La.tc("ApplicationFeatureHelperRequestSentTimeout",
3E4);this.Bi.jU(z,1,null,this.oac(pa,Fa),tb,1,ra=>{e.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",yc);try{if(void 0===ra||null===ra||void 0===ra.data||null===ra.data||void 0===ra.data.Ud||null===ra.data.Ud){m.Health.instance.recordKpiFailure(xc,"Invalid RequestSucceededEventArgs",!1,!0,null);const db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
yc);wd(this.VU(db,ra))}else if(ra.data.Ke!==E.a.Zw){m.Health.instance.recordKpiFailure(xc,"HttpStatusCode_"+ra.data.Ke.toString(),!1,!0,null);const db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",ra.data.Ke,yc);wd(this.VU(db,ra))}else{void 0!==Ma&&null!==Ma&&void 0!==ra.data.gk&&null!==ra.data.gk&&Ma(ra.data.gk);var Na=Z(ra.data.Ud);if(Na)e.ULS.sendTraceTag(50622690,3004,
50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",yc),ld(Na);else{m.Health.instance.recordKpiFailure(xc,"Parse Failure",!1,!0,null);const db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",yc);wd(this.VU(db,ra))}}}catch(db){m.Health.instance.recordKpiFailure(xc,"Unexpected Failure",!1,!0,null),Na=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
db,yc),wd(this.VU(Na,ra))}},ra=>{if(ra.data){m.Health.instance.recordKpiFailure(xc,"HttpStatusCode_"+ra.data.Ke.toString(),!1,!0,null);var Na=F.a.Ocb(ra.data.Ud||"No Data");Na=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",ra.data.Ke,Na,yc)}else m.Health.instance.recordKpiFailure(xc,"Invalid RequestFailedEventArgs",!1,!0,null),Na=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
yc);wd(this.VU(Na,ra))},null,void 0,void 0,t,aa)})}VU(z,Z){const pa=new y;pa.message=z;pa.lu=Z&&Z.data?Z.data.Ke:-1;return pa}oac(z,Z){const pa={};pa["x-UserDataSignature"]=this.La.Ea("UserDataSignature");pa["x-LicensingIsEnabled"]=this.La.getBooleanAppSetting("LicensingIsEnabled").toString();pa["x-CacheIsEnabled"]=this.La.getBooleanAppSetting("LicensingRedisIsEnabled").toString();pa["x-OcpsIsEnabled"]=this.La.getBooleanAppSetting("OcpsIsEnabled").toString();pa["x-LicensingAADIdIsEnabled"]=this.La.getBooleanAppSetting("LicensingAadIdIsEnabled").toString();
0===z&&(pa["x-LicenseCheckOnTenantEnabled"]="true",pa["x-SupportUserConsentDependentFeatures"]="true",pa["x-AFHUserConsentGroupValue"]="0",pa["x-UseShellServiceForUserConsentGroup"]="true",pa["x-SMBUserLicensingEnabled"]="true",pa["x-AFHPIPLComplianceEnabled"]=C.a.VO(window.location.href,"wd_afhpipl")||"false",pa["x-ConsumerLicensingSNICertIsEnabled"]=this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),pa["x-MSGraphInLicensingIsEnabled"]=
this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(Z)for(const Fa of Z.keys)pa[Fa]=Z.ga(Fa);return pa}}Object(k.a)(B,"HttpRequestToPromiseUtility",null,[]);var H=d(25),K;(function(z){z[z.dFk=0]="loki";z[z.etm=1]="augloopACLP"})(K||(K={}));Object(k.b)("AlternateAuthSupportApp",K);var A=d(245),W=d(35);class N{constructor(){this.Token=null;this.ExpirationTime=0}}Object(k.a)(N,"WacAlternateAuthToken",null,[]);class P{constructor(z,Z){this.Ham=
3E5;this.wdl=pa=>{let Fa=null;({Ev:Fa}=W.d(pa));return Fa};if(void 0===z||null===z||void 0===Z||null===Z)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.La=z;this.qDc=new n.a(r.a.gl());this.nYb=new B(z,Z);void 0!==A.a.cBe&&null!==A.a.cBe&&void 0!==A.a.$$c&&null!==A.a.$$c&&0<A.a.$$c&&(z=new N,z.Token=A.a.cBe,z.ExpirationTime=A.a.$$c,this.qDc.$("loki",z))}luj(){let z=null;this.qDc.Ib(K[0])&&(z=this.qDc.ga(K[0]));return void 0===z||null===z||this.nsk(z)?this.lmj():Promise.resolve(z.Token)}nsk(z){return z.ExpirationTime-
Date.now()<this.Ham}lmj(){const z=new n.a(r.a.gl());z.$("X-AlternateAuthApp",K[0]);return this.nYb.kab(this.mva("/afhs/AlternateAuthHelperHandler.ashx"),this.wdl,2,z).then(Z=>{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",K[0]);this.qDc.$(K[0],Z);return Z.Token},Z=>{Z=Object(w.a)(y,Z);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Z.message,
Z.lu);return null})}mva(z){const Z=this.La.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")?this.La.Ea("SuiteOrigin"):this.La.Ea("WebServiceBase");return String.format("{0}{1}?{2}",Z,z,H.AFrameworkApplication.mh)}}Object(k.a)(P,"AlternateAuthHelper",null,[1022]);var U=d(1106);class Q{constructor(z,Z,pa){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=z;this.isEnabled=Z;this.tierName=pa}}Object(k.a)(Q,"FeatureStateChangeArgs",null,[]);var G=d(214),Y=d(205),ba=d(55),ha=d(104),
ka=d(103),ca;(function(z){z[z.Enabled=0]="Enabled";z[z.Disabled=1]="Disabled"})(ca||(ca={}));Object(k.b)("FeatureState",ca);var ia=d(54),oa=d(36),sa=d(89);class Ca{constructor(z,Z,pa=null,Fa=null,Ma=null){this.gVa=this.iX=this.MDf=this.RQa=this.JLc=null;this.Adl=tb=>{(tb=W.b(tb))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",tb)):e.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return tb.Features};this.yVj=()=>{e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.gVa.then(tb=>{this.vBh(tb)}).catch(()=>{this.vBh({})})};this.lll=tb=>{try{tb&&"Date"in tb&&(this.iX=new Date(tb.Date),e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.iX.toString()))}catch(Hb){e.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Hb)}};this.nYb=new B(z,Z);this.La=
z;this.xii=z.tc("LicensingMaxRetryAttempts",0);this.BHc=z.getBooleanAppSetting("IsO365ConsumerHost");this.HOd=z.getBooleanAppSetting("IsO365CommercialHost");this.nOd=z.getBooleanAppSetting("PremiumUpsellIsEnabled");this.Gsb=!1;this.aQd=0;this.Dpf=pa;this.ZHf=Fa;this.Ca=Ma;this.QQa=z.getBooleanAppSetting("LicensingIsEnabled");this.Q7a=z.getBooleanAppSetting("OcpsIsEnabled")&&this.HOd;this.MXd=z.getBooleanAppSetting("ShowPrivacyDialog")&&!!Fa;this.MNd=z.getBooleanAppSetting("IsAnonymousUser");this.OXc=
new Promise(tb=>{tb(!1)});this.I4a=new Promise(tb=>{tb(!0)});this.fVa=new n.a(r.a.gl());this.TMc=!0;this.Iyf=this.oEj();this.zwe()&&!this.MNd?(void 0!==H.AFrameworkApplication.za&&null!==H.AFrameworkApplication.za&&(this.JLc=H.AFrameworkApplication.za.DW,void 0!==this.JLc&&null!==this.JLc&&(this.RQa=this.JLc.fLb("WebServiceCall","ApplicationFeatureHelperService"))),this.gVa=this.dgf()):this.gVa=new Promise(tb=>{tb({})});this.gVa.catch(tb=>{tb=Object(w.a)(y,tb);e.ULS.sendTraceTag(42513088,3004,10,
"ApplicationFeatureHelper initialization failed, HttpStatus={0}",tb?tb.lu.toString():"Unknown")});this.TMc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(tb=>{this.Gsb=tb;return null})}oEj(){const z=this.La.du("AllLicensedFeatures")?this.La.hz("AllLicensedFeatures"):[],Z=new U.a;for(let pa=0;pa<z.length;pa++)Z.add(z[pa]);return Z}zwe(){return this.HOd||this.BHc}dgf(z=0,Z=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Z);const pa=G.a.Yz();
pa&&(pa.set("retryAttempt",z.toString()),pa.set("forceRefresh",Z.toString()),pa.set("isO365ConsumerHost",this.BHc.toString()),pa.set("isO365CommercialHost",this.HOd.toString()),pa.set("isFreemiumUpsellSettingEnabled",this.nOd.toString()));m.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",pa);m.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",pa);void 0!==this.RQa&&null!==this.RQa&&this.RQa.start();let Fa=null;Z&&(Fa=new n.a(r.a.gl()),
Fa.$("x-LicensingForceRefresh","true"));this.MDf=new Date;return(this.QQa?this.nYb.kab(this.mva("/afhs/ApplicationFeatureHelperHandler.ashx"),this.Adl,0,Fa,this.lll,["Date"]):Promise.resolve({})).then(Ma=>{const tb=Object.assign(new sa.a,{durationMs:this.OUh()});tb.extendedProperties=pa;tb.extendedProperties&&Ma&&(tb.extendedProperties.set("featureCount",ha.a.count(Ma).toString()),tb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Ma).toString()),tb.extendedProperties.set("msoPremiumBadgeEnabled",
("MsoPremiumBadge"in Ma).toString()),"FreemiumUpsell"in Ma&&tb.extendedProperties.set("isFreemiumUpsellEnabled",Ma.FreemiumUpsell.toString()),this.iX&&tb.extendedProperties.set("fromCache",(this.iX<this.MDf).toString()));m.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",tb);return Ma},Ma=>{const tb=Object.assign(new sa.a,{durationMs:this.OUh()}),Hb=Object(w.a)(y,Ma);if(!Hb)return e.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),
m.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,tb),new Promise((rc,yc)=>{yc(Ma)});tb.extendedProperties=pa;tb.extendedProperties&&tb.extendedProperties.set("status",Hb.lu.toString());m.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,tb);return 408===Hb.lu&&++z<=this.xii?this.dgf(z):new Promise((rc,yc)=>{yc(Hb)})})}mva(z){var Z=this.La.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")?this.La.Ea("SuiteOrigin"):
this.La.Ea("WebServiceBase");Z=String.format("{0}{1}",Z,z);this.La.du("ApplicationFeatureHelperHttpCachingEnabled")&&this.La.getBooleanAppSetting("ApplicationFeatureHelperHttpCachingEnabled")&&(z=Ca.M0c(this.La))&&0<z.length&&(this.TMc&&(z+="ucbf"),Z=new Y.QueryStringBuilder(Z),Z.zg("afhskey",z),Z=Z.toString());return Z}isFeatureEnabled(z,Z){if(!this.Q7a&&!this.MXd&&!this.QQa)return this.I4a;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
z);if("ConnectedServices"===z){var pa=this.Q7a?this.Dpf.UO("ControllerConnectedServicesEnabled"):this.I4a;const tb=this.MXd?this.ZHf.getSettings().then(Hb=>2!==Hb.BD,()=>Z):this.I4a;return pa.then(Hb=>Hb?tb:this.OXc)}if("FreemiumUpsell"===z&&(!this.nOd||!this.BHc||this.MNd))return this.OXc;pa=null;pa=this.Q7a?this.Dpf.isFeatureEnabled(z):this.I4a;let Fa=null;Fa=this.QQa?this.nik(z,Z):this.I4a;let Ma=null;Ma=this.MXd?this.ZHf.isFeatureEnabled(z):this.I4a;return pa.then(tb=>tb?Ma.then(Hb=>Hb?Fa:this.OXc):
this.OXc).then(tb=>{this.ZJg(z,tb,!0);return tb},()=>{this.ZJg(z,Z,!1);return Z})}ZJg(z,Z,pa){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",z,Z,pa)}getFeatureTier(z,Z){if(!this.QQa)return new Promise(pa=>{pa(2)});e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",z);return this.gVa.then(pa=>this.x2c(z,pa,Z),()=>Z)}isFreemiumUpsellEnabled(){if(this.nOd&&this.BHc&&!this.MNd){if(this.Gsb&&2!==this.aQd||
!this.Gsb&&1!==this.aQd)e.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.Gsb.toString()),this.aQd=this.Gsb?2:1;return this.Gsb}return!1}launchUpsellExperience(z,Z=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",z));var pa=G.a.Yz();pa&&(pa.set("experienceId",z),Z&&pa.set("campaignId",Z));m.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",pa);(pa=ia.a.instance.ub("Common.IInProductMessagingUIManager"))?pa.mIg(z,this.yVj,Z):(e.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),m.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.Ia(oa.a.fZc,2,{["experience"]:z}))}OMa(z,Z){if(!this.QQa)return null;if(!z||!Z)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const pa=ka.a.create().toString();this.fVa.Ib(z)||this.fVa.$(z,new n.a(r.a.gl()));this.fVa.ga(z).add(pa,Z);e.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",pa,z));return pa}s2a(z,Z){this.QQa&&(z&&this.fVa.Ib(z)?Z&&ka.a.isValid(Z)?this.fVa.ga(z).Ib(Z)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
Z,z)),this.fVa.ga(z).remove(Z)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Z,z)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Z,z)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
z)))}x2c(z,Z,pa){return this.TMc?z in Z?Z[z].LicenseTier:pa:z in Z?this.lel(Z[z],pa):pa}lel(z,Z){switch(z.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Z}}vBh(z){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const Z=this.dgf(0,!0);Z.then(pa=>{this.gVa=Z;ha.a.count(pa)>ha.a.count(z)?m.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):m.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"FeatureCountNotIncreased",!1,!0,null);for(const Fa of this.fVa.keys)if(Fa in pa){const Ma=this.x2c(Fa,pa,0);Fa in z?this.x2c(Fa,z,0)!==Ma&&this.NSe(Fa,!0,Ma):this.NSe(Fa,!0,Ma)}else Fa in z&&this.NSe(Fa,!1,this.x2c(Fa,z,0))}).catch(pa=>{m.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(pa))})}NSe(z,Z,pa){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
z,Z,pa);Z=new Q(z,Z,pa);pa=this.fVa.ga(z);for(const Fa of pa)try{Fa.value(Z)}catch(Ma){e.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",z,Fa.key,Ma.message))}}mik(z,Z){if(this.QQa){const pa=this.Iyf.contains(z);let Fa=!0,Ma="",tb=!1;return this.gVa.then(Hb=>{z in Hb?(Hb=Hb[z],Ma=ca[Hb.FeatureState],Fa=1!==Hb.FeatureState):Fa=!pa;this.iKg(z,pa,Ma,tb,Z,Fa);
return Fa},()=>{tb=!0;pa&&(Fa=Z);this.iKg(z,pa,Ma,tb,Z,Fa);return Fa})}return this.I4a}iKg(z,Z,pa,Fa,Ma,tb){e.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",z,Z,Fa,pa,Ma,tb)}nik(z,Z){if(this.TMc)return this.mik(z,Z);if(this.QQa){if(this.Iyf.contains(z))return this.gVa.then(pa=>z in pa,()=>Z);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
z)}return this.I4a}OUh(){if(void 0!==this.RQa&&null!==this.RQa){const z=this.RQa.Qr;this.RQa.stop();return z}return null}static M0c(z){try{if(ba.a.Mcf){const Z=z.Ea("UserDataSignature").split(".");if(1<Z.length){const pa=window.self.atob(Z[1]),Fa=JSON.parse(pa).LocalStorageKey;if(void 0!==Fa&&null!==Fa&&0<Fa.length)return Fa}}}catch(Z){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",Z.toString())}return null}}Object(k.a)(Ca,"ApplicationFeatureHelper",null,[1023]);var Ta=
d(18);class R{constructor(z,Z){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=z.PolicySettings;z=new Date;z.setMinutes(z.getMinutes()+Z);this.ExpirationTime=z.getTime()}}Object(k.a)(R,"CloudPolicySettingsCacheData",null,[]);var Ha=d(334),da=d(251),Ba=d(312);class za{static ASh(){return H.AFrameworkApplication.fa.getBooleanAppSetting("SideCarIsEnabled")?za.hxd&&za.Q6c?new Promise(z=>{z(!0)}):new Promise((z,Z)=>{za.hxd=Ba.a.create(H.AFrameworkApplication.fa.Ea("SideCarUrl"));da.a.bF(za.hxd);
za.hxd.u9((pa,Fa)=>{(za.Q6c=Fa.succeeded)?z(Fa.succeeded):Z(Fa.succeeded)})}):new Promise(z=>{z(!1)})}}za.Q6c=!1;za.hxd=null;Object(k.a)(za,"SideCarLoader",null,[]);class Aa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(k.a)(Aa,"CloudPolicySettingsData",null,[]);class na{constructor(z,Z){this.hJd=0;this.dSc=null;this.Hdl=pa=>{let Fa=null;({Ev:Fa}=W.d(pa));pa=!!Fa;e.ULS.sendTraceTag(50622687,3004,pa?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
pa);return Fa};this.tll=pa=>{try{if(void 0!==pa&&null!==pa&&"CheckIn-Interval"in pa){const Fa=parseInt(pa["CheckIn-Interval"]);void 0!==Fa&&null!==Fa&&0<Fa&&(this.hJd=Fa)}}catch(Fa){e.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Fa)}};this.nYb=new B(z,Z);this.La=z;Z=z.Ea("HostAuthType");this.Q7a=z.getBooleanAppSetting("OcpsIsEnabled")&&z.getBooleanAppSetting("IsO365CommercialHost")&&!(void 0===Z||null===Z)&&"aad"===Z.toLowerCase();this.$Af=W.b(z.Ea("OcpsDefaultSettings")||
"{}");this.JZb=this.M0c();Z=this.La.du("ServicesControlsMicrosoftControllerServicesList")?this.La.hz("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.FEc=new U.a;for(let pa=0;pa<Z.length;pa++)this.FEc.add(Z[pa]);this.Q7a&&!z.getBooleanAppSetting("IsAnonymousUser")&&z.getBooleanAppSetting("SideCarIsEnabled")?this.dSc=this.Tdm():this.dSc=this.cgf(this.Q7a,this.mva("/afhs/CloudPolicySettings.ashx"),this.Hdl);this.dSc.then(()=>null).catch(pa=>{pa=Object(w.a)(y,pa);e.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",pa?pa.lu.toString():"Unknown")})}UO(z,Z=!0,pa=!0){if(!this.Q7a){const Hb=this;return new Promise(rc=>{rc(Hb.Iac(z))})}const Fa=this,Ma=this,tb=this.dSc.then(Hb=>{try{let rc=null;Hb.PolicySettings&&"unknown"in Hb.PolicySettings&&(rc=Hb.PolicySettings.unknown);if(rc){if(z in rc&&void 0!==rc[z]&&null!==rc[z])return new Promise(xc=>{xc("0"!==rc[z])});const yc=z.toLowerCase();if(yc in rc&&void 0!==rc[yc]&&null!==rc[yc])return new Promise(xc=>
{xc("0"!==rc[yc])});if(pa)return e.ULS.sendTraceTag(51512667,3004,50,"Policy"+z+" not found, using default"),new Promise(xc=>{xc(Fa.Iac(z))});e.ULS.sendTraceTag(508395746,3004,50,"Policy"+z+" not found, returning PolicyNotConfigured error");return new Promise((xc,ld)=>{ld("PolicyNotConfigured")})}return new Promise(yc=>{yc(Fa.Iac(z))})}catch(rc){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+z+" policy value. Error Message: {0}",rc.message),Fa.handleError(rc.toString(),Z,Fa.Iac(z))}},
Hb=>Ma.handleError(Hb,Z,Ma.Iac(z)));tb.then(Hb=>{e.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",z,Hb);return null});return tb}isFeatureEnabled(z,Z=!0){if(this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.pik(z,Z);let pa=new Promise(Ma=>{Ma(!0)}),Fa="";this.FEc.contains(z)&&(Fa="ControllerConnectedServicesEnabled",pa=this.UO(Fa,Z));pa.then(Ma=>{e.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",z,Ma,Fa);return null});return pa}pik(z,Z=!0){let pa=new Promise(Ma=>{Ma(!0)}),Fa="";"mso_sendASmile"===z?Fa="Enabled":"Survey"===z||"FloodgateSurvey"===z?Fa="SurveyEnabled":this.FEc.contains(z)&&(Fa="ControllerConnectedServicesEnabled");""!==Fa&&(pa=this.UO(Fa,Z));pa.then(Ma=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
z,Ma,Fa);return null});return pa}handleError(z,Z,pa){return Z?new Promise(Fa=>{Fa(pa)}):new Promise((Fa,Ma)=>{Ma(z)})}cgf(z,Z,pa){if(!z)return Promise.resolve(new Aa);let Fa=!1,Ma=null;m.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let tb=this.s7d("GetCloudPolicySettings");return(new Promise((Hb,rc)=>{if(void 0!==this.JZb&&null!==this.JZb&&0<this.JZb.length){const yc=this.Adm();if(void 0!==yc&&null!==yc){Fa=!0;Hb(yc);return}}this.nYb.kab(Z,pa,1,null,this.tll,["CheckIn-Interval"],
this.La.tc("CloudPolicySettingsRequestQueueTimeout",15E3),this.La.tc("CloudPolicySettingsRequestSentTimeout",3E4)).then(yc=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Hem(yc);Hb(yc);return yc},yc=>{rc(yc);return null})})).then(Hb=>{({Lz:tb,returnValue:Ma}=this.CBd(tb));var rc=G.a.Yz();rc&&rc.set("FromCache",Fa.toString());rc=Object.assign(new sa.a,{durationMs:Ma,extendedProperties:rc});m.Health.instance.recordKpiSuccess("GetCloudPolicySettings",rc);return Hb})}Tdm(){return za.ASh().then(()=>
{e.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}mva(z){const Z=this.La.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")?this.La.Ea("SuiteOrigin"):this.La.Ea("WebServiceBase");return String.format("{0}{1}",Z,z)}Iac(z){return z in this.$Af?"0"!==this.$Af[z]:!0}Adm(){try{const z=Ha.a.instance.getItem(this.JZb);if(void 0===z||null===z)return e.ULS.sendTraceTag(51662936,
3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",z);const Z=JSON.parse(z);if(void 0===Z||null===Z)return e.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===Z.ExpirationTime||null===Z.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),
null;if((new Date(Z.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const pa=new Aa;pa.PolicySettings=Z.PolicySettings;pa.ControllerConnectedServicesFeatureNames=new Ta.a;this.La.du("ServicesControlsMicrosoftControllerServicesList")&&this.La.hz("ServicesControlsMicrosoftControllerServicesList");for(const Fa of this.FEc)pa.ControllerConnectedServicesFeatureNames.add(Fa);e.ULS.sendTraceTag(51662941,3004,
50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return pa}catch(z){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",z.toString()),null}}Hem(z){try{if(void 0===z||null===z||void 0===z.PolicySettings||null===z.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.hJd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const Z=new R(z,this.hJd),pa=JSON.stringify(Z);e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",pa);Ha.a.instance.setItem(this.JZb,pa);e.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(Z){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",Z.toString())}}M0c(){const z=Ca.M0c(this.La);return z&&0<z.length?"OCPS"+z:null}s7d(z){const Z=ia.a.instance.ub("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==Z&&null!==Z?Z.lj("WebServiceCall",z):null}CBd(z){if(void 0!==z&&null!==z){const Z=z.Qr;z.stop();return{returnValue:Z,Lz:null}}return{returnValue:null,Lz:z}}}Object(k.a)(na,"CloudPolicySettingsHelper",null,[1020]);class la{constructor(){this.Y6f=this.z4h=this.BD=0;this.Z6f=this.A4h=this.cab="";this.PVd=this.EBa=2}clone(){const z=new la;z.BD=this.BD;z.z4h=this.z4h;z.Y6f=this.Y6f;z.cab=this.cab;z.A4h=this.A4h;z.Z6f=this.Z6f;z.EBa=this.EBa;z.PVd=this.src;return z}get src(){return this.PVd}serialize(z=
null){const Z={};if(!z||z.contains(la.wkb))Z[la.wkb]=this.BD;if(!z||z.contains(la.Gqc))Z[la.Gqc]=this.cab;if(!z||z.contains(la.Hqc))Z[la.Hqc]=this.EBa;return JSON.stringify(Z)}static create(z,Z=null){const pa=new la;pa.PVd=z;void 0!==Z&&null!==Z&&(la.wkb in Z&&(pa.BD=Z[la.wkb]),la.Gqc in Z&&(pa.cab=Z[la.Gqc]),la.Hqc in Z&&(pa.EBa=Z[la.Hqc]));return pa}static deserialize(z,Z){try{const pa=JSON.parse(z);if(void 0!==pa&&null!==pa)return la.create(Z,pa);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
z);throw Error.argument("settingsData");}catch(pa){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",pa.toString()),pa;}}}la.wkb="CCS";la.Gqc="CCSTime";la.Hqc="OfficePrivacyRoamedNoticeShown";Object(k.a)(la,"UserPrivacySettings",null,[]);var va=d(202);class Pa{constructor(z,Z){if(void 0===z||null===z||void 0===Z||null===Z)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.La=z;this.Bi=Z;this.gVd=this.nd=null}mva(z){var Z=String.format("{0}RoamingServiceHandler.ashx?action=",
this.La.appSettings.RoamingServiceHandlerWebServiceBase||"");Z=new Sys.StringBuilder(Z);Z.append(z);Z.append("&");Z.append(H.AFrameworkApplication.mh);return Z.toString()}executeRequest(z,Z,pa,Fa=null){return this.Bi.y9a(z,Z,Fa,null,2,pa,"33",!1,null,6E4)}saveSettings(z){return new Promise((Z,pa)=>{try{if(void 0===this.nd||null===this.nd||void 0===z||null===z)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),pa("Can't determine setting changes to save");
else{var Fa=this.nd.BD!==z.BD;if(2===this.nd.src&&Fa)this.hKl(z),Z(!0);else{var Ma=this.ENl(z);if(void 0===Ma||null===Ma||!Ma.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),pa("No changes to save");else if(1===this.nd.src)Z(this.a0h(Ma));else if(0===this.nd.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Ma);const tb=this.executeRequest(this.mva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Ma);tb.continueWith(()=>{if(tb.Ao||tb.Pm)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Z(!1);else{var Hb=tb.result;void 0!==Hb.Hj&&null!==Hb.Hj&&void 0!==Hb.Hj.data&&null!==Hb.Hj.data&&Hb.Hj.data.Ke===E.a.Zw?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Z(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Z(!1))}})}}}}catch(tb){e.ULS.sendTraceTag(50860930,3004,
10,"SaveUserPrivacySettings: Exception = {0}",tb.toString()),Z(!1)}})}ENl(z){if(void 0===this.nd||null===this.nd||void 0===z||null===z)throw Error.invalidOperation("User Privacy settings have not been initialized");const Z=new Ta.a;0===z.src?(this.nd.BD!==z.BD&&(Z.add(la.wkb),Z.add(la.Gqc)),this.nd.EBa!==z.EBa&&Z.add(la.Hqc)):1===z.src&&this.nd.BD!==z.BD&&Z.add(la.wkb);return Z.count?z.serialize(Z):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.gVd){const z=
this;this.gVd=new Promise(Z=>{try{z.nd?Z(z.nd.clone()):z.Jdm().then(pa=>{z.nd=pa;Z(z.nd.clone());return null},()=>{z.Hdm().then(pa=>{z.nd=pa;Z(z.nd.clone());return null},()=>{z.Idm().then(pa=>{z.nd=pa;Z(z.nd.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");z.nd=new la;Z(z.nd.clone());return null});return null});return null})}catch(pa){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
pa.toString()),z.nd=new la,Z(z.nd.clone())}})}return this.gVd}Jdm(){return new Promise((z,Z)=>{try{const Fa=-1!==window.location.href.indexOf("&wd_pn=2");if(this.La.getBooleanAppSetting("PrivacyDialogShouldCheckRoaming")||Fa){var pa=this.executeRequest(this.mva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");pa.continueWith(()=>{try{if(pa.Ao||pa.Pm)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Ma=pa.result;if(Ma&&Ma.Hj&&
Ma.Hj.data)if(Ma.Hj.data.Ke!==E.a.Zw)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ma.Hj.data.Ke);else{if(Ma.Hj.data.Ud){z(Pa.parse(Ma.Hj.data.Ud,0));e.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ma.Hj.data.Ud);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
Z("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ma){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ma.toString()),Z("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Z("Roaming should not be used")}catch(Fa){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
Fa.toString()),Z("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Hdm(){return new Promise((z,Z)=>{try{const pa=va.a.get("WacUPToggleState");let Fa=null;void 0!==pa&&null!==pa&&0<pa.length&&(Fa=decodeURIComponent(pa));if(void 0!==Fa&&null!==Fa&&0<Fa.length){const Ma=Pa.parse(Fa,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ma.toString());z(Ma)}else{const Ma=la.create(1),tb=new Ta.a;tb.add(la.wkb);const Hb=Ma.serialize(tb);
this.a0h(Hb)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Hb),z(Ma)):(e.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Hb),Z("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(pa){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",pa.toString()),Z("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Idm(){return new Promise(z=>
{try{var Z=-1!==window.location.href.indexOf("&wdccsoff=1");const pa=la.create(2);Z?(pa.BD=2,H.AFrameworkApplication.I5f(),e.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",pa.toString())):(pa.BD=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",pa.toString()));z(pa)}catch(pa){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",pa.toString()),
Z=la.create(2),Z.BD=1,z(Z)}})}hKl(z){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===z.BD?H.AFrameworkApplication.I5f():H.AFrameworkApplication.Xfj();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",z)}a0h(z){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",z);const Z=this.La.Ea("PrivacyCookieDomain")||"";if(!Z||!Z.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",z);return va.a.iOh("WacUPToggleState",z,va.a.VK,Z)}catch(Z){return e.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Z.toString()),!1}}isFeatureEnabled(z){return this.getSettings().then(Z=>{const pa=this.La.du("ServicesControlsMicrosoftControllerServicesList")?this.La.hz("ServicesControlsMicrosoftControllerServicesList"):[],Fa=new U.a;for(let Ma=0;Ma<pa.length;Ma++)Fa.add(pa[Ma]);return Fa.contains(z)?
2!==Z.BD:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",z);return!0})}static parse(z,Z){try{return e.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",z,Z),la.deserialize(z,Z)}catch(pa){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",pa.toString()),pa;}}}Object(k.a)(Pa,"UserPrivacySettingsHelper",null,[1021]);var Qa=d(68);class Ua{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}fc(z){this.Da=
z;this.Da.register(1020,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().na(()=>new na(H.AFrameworkApplication.fa,H.AFrameworkApplication.Me));this.Da.register(1021,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().na(()=>new Pa(H.AFrameworkApplication.fa,H.AFrameworkApplication.Me));this.Da.register(1022,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().na(()=>new P(H.AFrameworkApplication.fa,H.AFrameworkApplication.Me));this.Da.register(1023,
"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().na(()=>new Ca(H.AFrameworkApplication.fa,H.AFrameworkApplication.Me,this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),H.AFrameworkApplication.Pa))}init(){H.AFrameworkApplication.fa.Ue(()=>{const z=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");H.AFrameworkApplication.fa.getBooleanAppSetting("LicensingIsEnabled")&&
(z.isFeatureEnabled("LicensingTestFeature",!1).then(Z=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Z,H.AFrameworkApplication.fa.Ea("IsAnonymousUser"));return null}),z.getFeatureTier("LicensingTestFeature",0).then(Z=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Z,H.AFrameworkApplication.fa.Ea("IsAnonymousUser"));
return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.B9l()})}dispose(){}B9l(){try{H.AFrameworkApplication.fa.getBooleanAppSetting("SideCarIsEnabled")&&za.ASh().then(z=>{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",z);return z})}catch(z){}}static main(){Qa.a.instance.Ac(new Ua)}}Object(k.a)(Ua,"ApplicationFeatureHelperPackage",null,[2,3]);var Ya=d(520),Ea=d(6);class La{constructor(z,Z){this.Bi=z;
this.PE=Z}Py(z,Z,pa,Fa=null){return this.ydj(z,Fa,Ma=>this.Bi.y9a(Ma,2,pa,Z,2,void 0,void 0,void 0,void 0,void 0,"2"))}ydj(z,Z,pa){const Fa=!!Z&&""!==Z;let Ma=z;Fa&&(Ma=C.a.sSa(z,"perfTag",Z));const tb=new Date;return Ya.a.then(pa(Ma),Hb=>{const rc=+new Date-+tb;if(!Hb||!Hb.Hj||!Hb.Hj.data)return Hb;Fa&&Hb.Hj.data.request&&this.RMl(Hb.Hj.data.request.getResolvedUrl(),Z,rc);return Hb})}RMl(z,Z,pa){z=this.PE.dKj(z);if(z.count&&(z=Ea.last(z))){const Fa={Message:"Request durations for activities calls."};
Fa.PerfTag=Z;Fa.CustomDuration=pa;Fa.PerformanceDuration=z.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Fa))}}}Object(k.a)(La,"CatchUpNetworkingWrapper",null,[238]);var xb=d(386);class dc extends xb.a{constructor(z,Z){super(z,Z)}om(){return 6}}Object(k.a)(dc,"GetActivityFeedRequest",xb.a,[]);class gb extends xb.a{constructor(z,Z,pa,Fa,Ma,tb){super(z,Z);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=pa;this.ActivityStatesToSet=
Fa;this.ActivityStatesToReset=Ma;this.ResetUnseenCount=tb}om(){return 7}}Object(k.a)(gb,"UpdateActivityFeedStateRequest",xb.a,[]);var gc=d(537);class Ac{constructor(z,Z,pa){this.vAf=z;this.M5a=Z;this.W5a=pa}Dtj(z){return Ya.a.then(this.W5a.execute(new dc(this.M5a(),null),(Z,pa,Fa)=>this.vAf.Py(Z,pa,Fa,"ActivityFeed"),z),Z=>{if(!Z)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!Z.Hj)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),
null;Z=Z.Hj.data;if(!Z)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(Z.Ke!==E.a.Zw)return e.ULS.sendTraceTag(508929507,3012,10,"GetActivityFeed: Response status code {0}",Z.Ke),null;if(!Z.Ud)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;Z=gc.a.Pyb(Z.Ud);return Z?Z:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}Fgm(z,Z,pa,Fa,Ma){return Ya.a.then(this.W5a.execute(new gb(this.M5a(),
null,Z,pa,Fa,Ma),(tb,Hb,rc)=>this.vAf.Py(tb,Hb,rc,"UpdateActivityFeedState"),z),tb=>{try{return tb.succeeded}catch(Hb){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception {0}",Hb.message),!1}})}}Object(k.a)(Ac,"CatchUpRequestHandler",null,[537]);var $b=d(215);class jc{constructor(z){this.nub=z;this.fzf=new $b.a}mzk(){this.vAk()}vAk(){if(this.nub){var z=Z=>{this.fzf.contains("CatchUpChangesFeedback")||(this.fzf.add("CatchUpChangesFeedback"),Z.logActivity("CatchUpChangesFeedback",
null))};this.nub.execute(Z=>{window.setTimeout(()=>{z(Z)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(k.a)(jc,"FloodgateEventLogger",null,[]);class pb{constructor(z){this.dli=z}get duration(){return this.dli.duration}}Object(k.a)(pb,"PerformanceResourceTimingWrapper",null,[]);class $a{constructor(z){this.PE=z}dKj(z){const Z=new Ta.a;if(!this.PE)return Z;z=this.PE.getEntriesByName(z,"resource");if(!z)return Z;for(const pa of z)Z.add(new pb(pa));
return Z}}Object(k.a)($a,"PerformanceWrapper",null,[]);class zc{constructor(){this.Da=null}get name(){return"Common.App.CatchUpActivity"}fc(z){this.Da=z;this.Da.register(La,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().na(()=>new La(H.AFrameworkApplication.Me,new $a(window.performance)));this.Da.register(Ac,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().na(()=>
new Ac(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>H.AFrameworkApplication.mh,new gc.a));this.Da.register(jc,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().na(()=>new jc(this.Da.Ha("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){Qa.a.instance.Ac(new zc)}}Object(k.a)(zc,"CatchUpActivityPackage",null,
[2,3]);var rb=d(1265),ib=d(7),Vb=d(111);class Od{constructor(z,Z,pa){this.daf=this.eaf=this.faf=!1;this.raf=!z&&!Z;this.saf=!z&&!pa;this.raf||this.saf||(this.faf=!z,this.eaf=!Z,this.daf=!pa)}}Object(k.a)(Od,"RenameDisabledDialogInfo",null,[]);class jb extends Vb.StandardDialog{constructor(z,Z,pa,Fa,Ma){super();this.$df=[];this.h4=new Od(z,Z,pa);this.hSa=Fa;this.JQa=Ma;this.Fg="RenameDisabledDialog";this.Fd=0;this.Te(1,CommonUIStrings.l_DialogClose);this.nUl();this.wDl()}nUl(){this.h4.raf?this.Uyc(this.hSa?
this.JQa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.h4.saf?this.Uyc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Tui();this.wNc(this.$df)}Uyc(z){Array.add(this.$df,z)}Tui(){const z=[];this.h4.faf||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.h4.eaf||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.h4.daf||Array.add(z,
CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<z.length&&Array.add(this.$df,z)}}Object(k.a)(jb,"ReactRenameDisabledDialogBase",Vb.StandardDialog,[]);class Wb extends jb{constructor(z,Z,pa,Fa,Ma){super(z,Z,pa,Fa,Ma)}wDl(){this.Opc(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(k.a)(Wb,"ReactRenameDisabledDialog",jb,[]);var qb=d(83);class Ga{static get Wg(){return qb.a.oC(Ga.Hq,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Ga.Hq="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(k.a)(Ga,"RenameDisabledDialogHtml",null,[]);class cb extends qb.a{constructor(z,Z,pa,Fa,Ma){super();this.h4=new Od(z,Z,pa);this.hSa=Fa;this.JQa=Ma;this.Fg="RenameDisabledDialog";this.Fd=0;this.Te(1,CommonUIStrings.l_DialogClose);this.Wg=Ga.Wg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.M7("RenameRow")}$ya(){if(this.h4.raf){let z;z=this.hSa?this.JQa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;cb.Uyc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),z)}else this.h4.saf?cb.Uyc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Q2j()}Q2j(){this.h4.faf&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.h4.eaf&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.h4.daf&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Uyc(z,Z,pa){z.style.display="none";Z.innerText=pa}}Object(k.a)(cb,"RenameDisabledDialog",qb.a,[]);var Ob=d(46),Db=d(72);class mb{constructor(z,Z){this.D7a=0;this.ASc=(pa,Fa,Ma,tb,Hb)=>{if(1===Ma)return this.Ca.nb(oa.a.kia,1);pa=Ob.a.dI(this.esa.iy);Hb=(0,Hb.getNewDocumentTitle)();Hb.length>this.D7a&&(Hb=Hb.substr(0,this.D7a));if(32!==this.Ca.Ia(oa.a.kia,2,Hb))return this.BUb(pa),8;this.BUb(Hb);
return 32};this.Ca=z;this.esa=Z}initialize(z){if(!this.Ca||!this.esa)return!1;this.D7a=z;this.qb();return!0}qb(){this.Ca.xa(oa.a.ASc,Db.a.frame,this.ASc)}BUb(z){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(z))}static JD(){return new mb(H.AFrameworkApplication.Pa,H.AFrameworkApplication.Qu)}}Object(k.a)(mb,"ReactRenameUIHandler",null,[1129]);var Vc=d(270),Zb=d(684),fc=d(586),ob=d(67),ub=d(194),bc=d(285),ic=d(142),Rc=d(64);class Fb{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd){this._initialized=
!1;this._element=null;this.D7a=0;this.SUd=this.oNd=!1;this.Ca=z;this.rId=Z;this.lh=pa;this.LA=Fa;this.esa=Ma;this.NEf=tb;this.bLc=Hb;this.oJd=rc;this.psa=yc;this.Hwf=xc;this.Qj=ld;this.iOd=wd}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(z,Z,pa){if(!(this.Ca&&this.esa&&this.NEf&&this.bLc&&this.oJd&&Z)||0>=z)return!1;this._element=Z;this._element.title=pa;this._element.setAttribute(ic.a.Ff,ic.a.jx);this._element.setAttribute("Unselectable","on");this.D7a=z;
this.nQ();return this._initialized=!0}nQ(){this.rId&&(this.rId.xb(ob.a.blur,this._element,Object(ib.a)(this,this.onBlur,"onBlur")),this.rId.xb(ob.a.paste,this._element,Object(ib.a)(this,this.Z7k,"onPaste")));this.lh.xb(ob.a.Vf,this._element,Object(ib.a)(this,this.onKeyDown,"onKeyDown"));this.LA.xb(ob.a.BB,this._element,Object(ib.a)(this,this.Kkb,"onPointerDown"));this.LA.xb(ob.a.US,this._element,Object(ib.a)(this,this.qVe,"onPointerUp"))}onBlur(){this.isActive&&!this.oNd&&(this.Hwf||this.oJd(this._element),
this.XYf(),this.v9d(!1));return this.oNd=!1}Z7k(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(z){return this.isActive?this.E6k(z):this.F6k(z)}E6k(z){let Z=!1;switch(z.hc.keyCode){case Sys.UI.Key.enter:this.XYf();this.v9d(this.Qj||this.iOd);Z=!0;break;case Sys.UI.Key.tab:this.Hwf&&this.oJd(this._element);break;case Sys.UI.Key.esc:this.U4e(),this.v9d(this.Qj||this.iOd),Z=!0}return Z}F6k(z){let Z=!1;switch(z.hc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.VZh(this.iOd),
this.isActive&&this.bLc(this._element),Z=!0}return Z}Kkb(){this.isActive||(this.VZh(!1),this.isActive&&(this._element.focus(),this.bLc(this._element),this.SUd=!0));return!1}qVe(){return this.SUd?(this.bLc(this._element),this.SUd=!1,!0):!1}FEb(){return 32===this.Ca.nb(oa.a.kia,1)}XYf(){const z=Ob.a.dI(this.esa.iy);let Z=this._element.innerText.trim();Z.length>this.D7a&&(Z=Z.substr(0,this.D7a));Z!==z&&""!==Z?32!==this.Ca.Ia(oa.a.kia,2,Z)?this.U4e():this.BUb(Z):this.U4e()}U4e(){this.BUb(Ob.a.dI(this.esa.iy))}BUb(z){this._initialized&&
(this._element.innerText=z,this.NEf())}VZh(z){this.FEb()?this.isActive||(z&&(this.oNd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ic.a.Ff,ic.a.JPf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Vc.CuiHelper.N7f),this.psa&&this.psa.execute(Z=>{Z.Dzh(!0)}),z&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.nb(oa.a.jSb,
2)}v9d(z){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ic.a.Ff,ic.a.jx);Sys.UI.DomElement.removeCssClass(this._element,Vc.CuiHelper.N7f);this.psa&&this.psa.execute(Z=>{Z.Dzh(!1)});z&&(this._element.blur(),this._element.focus())}static T2a(){Zb.a.T2a(H.AFrameworkApplication.isRtl)}static JD(){return new Fb(H.AFrameworkApplication.Pa,fc.a.instance,ub.KeyInputManager.instance,bc.a.instance,H.AFrameworkApplication.Qu,Fb.T2a,
Rc.a.wLl,Rc.a.sXf,ia.a.instance.Ha("Common.App.Header.HeaderEventSource"),ba.a.TG,ba.a.Aj,ba.a.jg)}}Object(k.a)(Fb,"RenameUIHandler",null,[1129]);class Qb{static get instance(){return H.AFrameworkApplication.za.mb.mP?Qb.Ja||(Qb.Ja=mb.JD()):Qb.Ja||(Qb.Ja=Fb.JD())}}Qb.Ja=null;Object(k.a)(Qb,"RenameUIHandlerFactory",null,[]);class hc{constructor(){this.oSe=this.x_k=this.L8i=null}}Object(k.a)(hc,"RenameMruEntryProperties",null,[]);var Pc=d(177),uc=d(127),zb=d(445),ac;(function(z){z[z.unknown=-1]="unknown";
z[z.success=0]="success";z[z.DCm=1]="renameInvalidFileName";z[z.CCm=2]="renameInCoauthNotSupported";z[z.ECm=3]="renameNotSupportedInViewMode";z[z.permissionDenied=4]="permissionDenied";z[z.zDm=5]="serverCommunicationFailure";z[z.Kum=6]="fileNameTooLong"})(ac||(ac={}));Object(k.b)("CommonOperationResult",ac);class Jb{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd){this.Bdc=()=>Qb.instance.initialize(H.AFrameworkApplication.XXc,H.AFrameworkApplication.YVc,H.AFrameworkApplication.FEh||CommonUIStrings.l_RenameFileTooltip)?
32:8;this.jSb=()=>{const t=this.Xlm(),aa=this.gri();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.t7a,aa,t,this.hSa);H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.SD&&H.AFrameworkApplication.fa.getBooleanAppSetting("ReactRenameDisabledDialogIsEnabled")?new Wb(this.t7a,!aa,!t,this.hSa,this.JQa()):new cb(this.t7a,!aa,!t,this.hSa,
this.JQa());return 32};this.kia=(t,aa,ra,Na,db)=>{if(1===ra)return this.FEb();if(!H.AFrameworkApplication.fbb)return 8;if(8===this.FEb())return this.zn.nb(oa.a.jSb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");H.AFrameworkApplication.fbb(db,Object(ib.a)(this,this.urc,"onRenameFileSuccess"),this.Q8k);H.AFrameworkApplication.ZCl=!0;return 32};this.Q8k=t=>{const aa=new Vb.StandardDialog;aa.Fd=0;switch(t){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");
aa.yob(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");aa.yob(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:t}),aa.yob(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}H.AFrameworkApplication.WU().execute(ra=>
{ra.sendMessage(uc.a.Fmj,{["FailureMessage"]:ac[t]})});this.SGh()};this.cvl=(t,aa,ra)=>{if(1===ra)return this.FEb();if(!H.AFrameworkApplication.Hua)return 8;H.AFrameworkApplication.Hua(Object(ib.a)(this,this.tMb,"onRefreshFilenameSuccess"),Object(ib.a)(this,this.Qpd,"onRefreshFilenameFailure"),!1);return 32};this.Zmd=(t,aa,ra,Na,db)=>{if(1===ra)return H.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsMoveToFolder")?this.FEb():8;if(2===ra){if(!H.AFrameworkApplication.dxc)return m.Health.instance.recordKpiFailure("MoveToFolder",
"Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!db)return m.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(db[Pc.a.Sgk])if(db[Pc.a.b4h])if(t=db[Pc.a.b4h].toLowerCase(),aa=H.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"),ra=H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),aa&&H.AFrameworkApplication.ofb&&ra){const kb={};kb[Pc.a.WOb]="1";kb[Pc.a.documentUrl]=t;kb[Pc.a.reason]=
zb.a.$5e;m.Health.instance.recordKpiSuccess("MoveToFolder",null);H.AFrameworkApplication.WU().execute(Ib=>{Ib.sendMessage(uc.a.yFa,kb)})}else if(!H.AFrameworkApplication.ofb&&ra)m.Health.instance.recordKpiSuccess("MoveToFolder",null),Rc.a.qo(t,Rc.a.Vca(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return m.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else m.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else H.AFrameworkApplication.Hua(Object(ib.a)(this,
this.tMb,"onRefreshFilenameSuccess"),Object(ib.a)(this,this.Qpd,"onRefreshFilenameFailure"),!1),H.AFrameworkApplication.dxc(),m.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.Twf=z;this.Ca=Z;this.LPa=pa;this.lG=Fa;this.t7a=Ma;this.gri=tb;this.hSa=Hb;this.HHf=rc;this.zmi=yc;this.JQa=xc;this.La=ld;this.ymi=wd}qb(){H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.mP||this.zn.xa(oa.a.Bdc,Db.a.frame,this.Bdc);this.zn.xa(oa.a.jSb,Db.a.frame,this.jSb);this.zn.xa(oa.a.kia,
Db.a.frame,this.kia);this.zn.pa(oa.a.bAb,Db.a.frame,this.cvl,64);this.zn.pa(oa.a.Zmd,Db.a.frame,this.Zmd,64);this.zn.xa(oa.a.ikb,Db.a.frame,Object(ib.a)(this,this.ikb,"moveToFolder"));(H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||H.AFrameworkApplication.za&&(H.AFrameworkApplication.fa.getBooleanAppSetting("PostMessageEmbedded")||H.AFrameworkApplication.fa.getBooleanAppSetting("IsJsApi"))&&H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&H.AFrameworkApplication.WU().execute(z=>{z.Bv(uc.a.fih);z.dD(uc.a.fih,Jb.ctl);z.Bv(uc.a.mde);z.dD(uc.a.mde,Jb.atl)})}FEb(){return 0===this.ymi.vng()?32:8}Xlm(){return this.jC?this.hSa?this.jC.nae:this.jC.iGa:!0}urc(z,Z){z?0!==z.OperationResult?this.psg(z.OperationResult):(this.JMl(Z,z.NewName),this.Rgm(z,Object(ib.a)(H.AFrameworkApplication.za.mb,H.AFrameworkApplication.za.mb.c3h,"updateOpenInClientDocumentUrl")),H.AFrameworkApplication.fa.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&
H.AFrameworkApplication.za.Gf(),this.zmi.x1h()):this.psg(5)}JMl(z,Z){const pa={};pa[Pc.a.Gmj]=Z;z.sendMessage(uc.a.mde,pa)}Rgm(z,Z){this.bhm(z);H.AFrameworkApplication.sVc=z.DirectInvokeDavUrl;Z=Z(z.EditDocInClientUrl);const pa=new hc;pa.oSe=this.lG.iy;pa.L8i=Z;pa.x_k=z.EditDocInClientUrl;this.zn.Ia(oa.a.GEh,2,pa)}psg(z){switch(z){case 1:z=new Vb.StandardDialog,z.Fd=0,z.vQ(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.SGh()}}bhm(z){this.lG.iy=Jb.NDi(this.lG.iy,
z.NewName);z.BreadcrumbFolderName&&(this.lG.breadcrumbFolderName=z.BreadcrumbFolderName);z.BreadcrumbFolderUrl&&(this.lG.breadcrumbFolderUrl=z.BreadcrumbFolderUrl);this.HHf(z.NewName)}ikb(z,Z,pa,Fa,Ma){if(1===pa)return H.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsMoveToFolder")?32:8;if(2===pa){const tb={};z=H.AFrameworkApplication.ofb;Z=H.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");z=(!z||z&&Z)&&H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);tb[Pc.a.c7l]=z;Ma&&Ma.MoveButtonClickedTime&&(tb[Pc.a.HYk]=Ma.MoveButtonClickedTime.getTime());H.AFrameworkApplication.WU().execute(Hb=>{Hb.sendMessage(uc.a.ikb,tb)});Ma&&Ma.MoveButtonClickedTime&&((z=G.a.Yz())&&z.set("MovePostDuration",((new Date).getTime()-Ma.MoveButtonClickedTime.getTime()).toString()),m.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",z));return 32}return 8}PZl(z,Z){return z&&Z?z!==this.lG.breadcrumbFolderName||Z!==this.lG.breadcrumbFolderUrl:!1}tMb(z,Z){z&&(z.NewName!==
Ob.a.dI(this.lG.iy)||this.PZl(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl))&&this.urc(z,Z)}Qpd(){}SGh(){this.HHf(Ob.a.dI(this.lG.iy))}get zn(){return this.Ca.value}get jC(){return this.LPa.value}static get instance(){return Jb.Ja||(Jb.Ja=Jb.Tbb())}static Tbb(){return new Jb(H.AFrameworkApplication.Jfc,new rb.a(()=>H.AFrameworkApplication.Pa),new rb.a(()=>H.AFrameworkApplication.jC),H.AFrameworkApplication.Qu,H.AFrameworkApplication.YR,()=>H.AFrameworkApplication.lCc,H.AFrameworkApplication.Svc,Object(ib.a)(Qb.instance,
Qb.instance.BUb,"updateTitle"),ia.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>H.AFrameworkApplication.kV,H.AFrameworkApplication.fa,ia.a.instance.resolve("Common.IRenameProps"))}static NDi(z,Z){z=Ob.a.AR(z);return Z+z}static ctl(z){const Z=z.Values[Pc.a.Klk];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Z);Z?H.AFrameworkApplication.Pa.Ia(oa.a.Zmd,2,z.Values):m.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,
!1,null)}static atl(z){H.AFrameworkApplication.Pa.Ia(oa.a.kia,2,z.Values.NewName)}}Jb.Ja=null;Object(k.a)(Jb,"RenameActor",null,[]);var Yc=d(396),dd=d(668),id=d(597),Cc=d(204);class Nb{constructor(z,Z){this.Ca=z;this.tKd=Z}qb(){this.Ca.xa(oa.a.maf,Db.a.frame,Object(ib.a)(this,this.u1l,"showRenameDialogAction"))}u1l(z,Z,pa){z=32;if(1===pa)return Cc.SessionStatusManager.instance.Oma||H.AFrameworkApplication.TR?8:32;2===pa&&(32!==this.Ca.nb(oa.a.kia,1)?(this.Ca.nb(oa.a.jSb,2),Yc.a.instance.kc(dd.a.ama,
{["Reason"]:id.a.YCl}),z=8):32===this.Ca.nb(oa.a.Tyc,1)?this.Ca.nb(oa.a.Tyc,2):this.tKd.value.create().zia());return z}}Object(k.a)(Nb,"RenameDialogActor",null,[1100]);class nc{constructor(z,Z,pa){this.dialog=null;this.Ca=z;this.lG=Z;this.hQa=pa}YJj(){const z={};z.nameInputProps={["type"]:"AppInputProps",["id"]:nc.gzb,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ob.a.dI(this.lG.iy),["maxLength"]:this.hQa};return z}zia(){const z={["id"]:"RenameDialog",["bodyControls"]:this.YJj()};this.dialog=
new qb.a(!1,!1,!0);this.dialog.Fd=1;this.dialog.Fg="RenameDialog";this.dialog.Vj(CommonUIStrings.l_RenameDialogTitle,Object(ib.a)(this,this.I3e,"renameDialogHandler"),z)}I3e(z,Z){if(Z&&1===z){if(Z[nc.gzb]&&(z=Ob.a.dI(this.lG.iy),Z=(Z[nc.gzb]||"").trim(),Z!==z&&""!==Z)){this.Ca.Ia(oa.a.kia,2,Z);return}Yc.a.instance.kc(dd.a.e8b,{["Reason"]:id.a.Jbg})}}}nc.gzb="txtDocumentName";Object(k.a)(nc,"ReactRenameDialog",null,[1130]);class Kc{static get Wg(){return qb.a.oC(Kc.Hq,CommonUIStrings.l_RenameDialogLabel)}}
Kc.Hq="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(k.a)(Kc,"RenameDialogHtml",null,[]);class xd extends qb.a{constructor(z,Z,pa){super();this.Ca=z;this.lG=Z;this.hQa=pa;this.Fg="RenameDialog";this.Wg=Kc.Wg}zia(){var z={["txtDocumentName"]:Ob.a.dI(this.lG.iy)};this.Vj(CommonUIStrings.l_RenameDialogTitle,Object(ib.a)(this,
this.I3e,"renameDialogHandler"),z);z=document.getElementById(xd.gzb);0<this.hQa&&(z.maxLength=this.hQa);z.focus()}I3e(z,Z){if(1===z&&(z=Ob.a.dI(this.lG.iy),Z=(Z[xd.gzb]||"").trim(),Z!==z&&""!==Z)){this.Ca.Ia(oa.a.kia,2,Z);return}Yc.a.instance.kc(dd.a.e8b,{["Reason"]:id.a.Jbg})}}xd.gzb="txtDocumentName";Object(k.a)(xd,"RenameDialog",qb.a,[1130]);class Xc{constructor(z){this.esa=null;this.hQa=0;this.Ca=z;this._initialized=!1}initialize(z,Z){this.esa=z;this.hQa=Z;this._initialized=!0}create(){return this._initialized?
H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.SD&&H.AFrameworkApplication.fa.getBooleanAppSetting("ReactRenameDialogIsEnabled")?new nc(this.Ca,this.esa,this.hQa):new xd(this.Ca,this.esa,this.hQa):null}}Object(k.a)(Xc,"RenameDialogFactory",null,[1099]);var Tb=d(122),he=d(88),re=d(65),ee=d(80),Yf=d(141);class ke{constructor(z,Z){this.Ca=z;this.Wd=Z}qb(){this.Ca.xa(oa.a.Tyc,Db.a.frame,Object(ib.a)(this,this.v1l,"showRenameFlyoutAction"))}WPi(){return re.d("setDocumentTitleFlyoutOpened")&&
H.AFrameworkApplication.za.mb.mP}v1l(z,Z,pa){if(1===pa)return this.WPi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}cwi(){ke.vqk&&H.AFrameworkApplication.nwa&&Yf.a.instance.Jb(new ee.a(5,1,5E3,()=>{32===this.Ca.nb(oa.a.Tyc,1)&&this.Wd&&this.Wd.Je.name===Tb.AFrame.PX&&(he.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Ca.nb(oa.a.Tyc,2))}))}static get vqk(){ke.IHc&&null!=ke.IHc||(H.AFrameworkApplication.F1("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),
ke.IHc=H.AFrameworkApplication.fa?H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ke.IHc}}ke.IHc=null;Object(k.a)(ke,"RenameFlyoutActor",null,[1098]);class ef{constructor(z,Z,pa,Fa,Ma){this.x5d=null;this.LPa=Ma;this.Uwf=pa;this.Twf=Fa;this.iri=z;this.JQa=Z}get jC(){return this.LPa.value}vng(){if(!this.Twf())return 5;if(this.JQa())return 1;if(this.jC){if(this.Uwf&&!this.jC.nae)return 3;if(!this.Uwf&&!this.jC.iGa)return 4}return this.iri()?
0:2}}Object(k.a)(ef,"RenameProps",null,[1097]);var yf=d(71);class Rf{constructor(z,Z,pa,Fa,Ma,tb){this.VB=!1;this.TPd=new yf.a;this.Qrb=Z;this.XEc=pa;this.kEc=Fa;this.La=Ma;this.uka=tb}enable(){this.VB||(this.x1h(),this.Kbf(),this.VB=!0)}generateKey(z,Z,pa){return String.format("{0}/{1}/{2}",pa,z,Z)}HDj(){const z=Ob.a.dI(this.Qrb().iy);return this.generateKey(this.Qrb().breadcrumbFolderName,this.Qrb().breadcrumbFolderUrl,z)}IDj(z,Z,pa){return z&&Z?this.generateKey(z,Z,pa):pa}Sbj(z,Z,pa){return z&&
z!==this.Qrb().breadcrumbFolderName||Z&&Z!==this.Qrb().breadcrumbFolderUrl?!0:pa!==Ob.a.dI(this.Qrb().iy)}x1h(){const z=this.HDj();this.TPd.$(z,new Date)}wXe(z){this.pYl(z)&&this.QIf(z)}pYl(z){const Z=this.kEc();return Z?this.uka&&this.uka.Oeb||!Z.tve||!H.AFrameworkApplication.Hua?(this.SUh(z),this.VB=!1):!0:!1}cqh(z,Z,pa,Fa){const Ma=this.Sbj(z,Z,pa);z=this.IDj(z,Z,pa);Z=this.TPd.Eg(z).returnValue;Ma&&!Z&&(this.ssg(Fa),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Dwa));Ma||
this.TPd.$(z,this.XEc())}}Object(k.a)(Rf,"ARenamedFileChecker",null,[1068]);class Za extends Rf{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc){super(z,Z,pa,Fa,Ma,tb);this.xtg=(yc,xc)=>{xc&&xc.uqc&&xc.U1k&&(xc.SEb("BreadcrumbDocName")||xc.SEb("BreadcrumbFolderName")||xc.SEb("BreadcrumbFolderUrl")||xc.SEb("DirectInvokeDAVUrl")||xc.SEb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Dwa),this.wXe(xc))};this.tDf=Ma;this.xmi=Hb;this.dNd=rc}get Dwa(){return"RenamedFileCheckerUsingSettingsRefresh"}Kbf(){this.tDf.e_d(this.xtg)}SUh(){this.tDf.fEh(this.xtg)}QIf(z){if(z&&
z.uqc){const Z=z.uqc;this.cqh(Z.Ea("BreadcrumbFolderName"),Z.Ea("BreadcrumbFolderUrl"),Z.Ea("BreadcrumbDocName"),z)}}ssg(z){const Z={OperationResult:0,classId:1};z=z.uqc;Z.BreadcrumbFolderName=z.Ea("BreadcrumbFolderName");Z.BreadcrumbFolderUrl=z.Ea("BreadcrumbFolderUrl");Z.DirectInvokeDavUrl=z.Ea("DirectInvokeDAVUrl");Z.EditDocInClientUrl=z.Ea("EditDocInClientUrl");z=z.Ea("BreadcrumbDocName");Z.NewName=H.AFrameworkApplication.TVc?z:Ob.a.dI(z);this.dNd.execute(pa=>{this.hdk(Z,pa)})}hdk(z,Z){this.xmi().urc(z,
Z)}}Object(k.a)(Za,"RenamedFileCheckerUsingSettingsRefresh",Rf,[]);class Kb extends Rf{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc){super(z,pa,Fa,Ma,tb,yc);this.p0b=this.aNc=null;this.ili=Z;this.Ca=Hb;this.je=rc;xc&&xc.execute(ld=>{this.dyl(ld)})}get Dwa(){return"RenamedFileCheckerUsingTask"}dyl(z){this.aNc=z;this.aNc.uOc(Object(ib.a)(this,this.vcc,"handleVisibilityChange"))}vcc(z,Z){!this.VB||0!==Z.newState&&1!==Z.newState||this.p0b||(this.Kbf(),this.wXe(this.p0b))}Kbf(){this.p0b=new ee.a(3,2,this.ili(),
Object(ib.a)(this,this.wXe,"performRenameFileCheckTick"),89);this.je.Jb(this.p0b)}SUh(z){this.je.Vg(z)}QIf(z){this.aNc&&2===this.aNc.J9a?this.kzl(z):H.AFrameworkApplication.Hua(Object(ib.a)(this,this.tMb,"onRefreshFilenameSuccess"),Object(ib.a)(this,this.Qpd,"onRefreshFilenameFailure"),!0)}kzl(z){this.je.Vg(z);this.p0b=null}tMb(z){z&&this.cqh(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl,z.NewName,null)}ssg(){this.Ca.nb(oa.a.bAb,2)}Qpd(){}}Object(k.a)(Kb,"RenamedFileCheckerUsingTask",Rf,[]);var Ic=
d(96);class Hc{constructor(){this.La=this.Da=null;this.Pn=()=>{const z=H.AFrameworkApplication.za.mb.mP;H.AFrameworkApplication.Jfc()&&Qb.instance.initialize(H.AFrameworkApplication.XXc,z?null:H.AFrameworkApplication.YVc,z?null:H.AFrameworkApplication.FEh||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(ef,"Common.App.Rename.RenameProps").as("Common.IRenameProps").na(()=>new ef(()=>H.AFrameworkApplication.lCc,()=>H.AFrameworkApplication.kV,H.AFrameworkApplication.Svc,H.AFrameworkApplication.Jfc,
new rb.a(()=>H.AFrameworkApplication.jC))).ma(),Jb.instance.qb(),this.La.getBooleanAppSetting("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(H.AFrameworkApplication.Qu,H.AFrameworkApplication.XXc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").qb()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").qb(),H.AFrameworkApplication.Svc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").cwi())}}get name(){return"Common.App.RenameFile"}fc(z){this.Da=
z;this.La=H.AFrameworkApplication.fa;this.Da.register(Nb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").na(()=>new Nb(H.AFrameworkApplication.Pa,this.Da.ze("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(Xc,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").na(()=>new Xc(H.AFrameworkApplication.Pa)).ma();this.Da.register(1068,"Common.App.Rename.IRenamedFileChecker").na(()=>this.Z5i()).ma();this.Da.register(ke,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").na(()=>new ke(H.AFrameworkApplication.Pa,Ic.FocusManager.instance())).ma()}Z5i(){if(this.La.getBooleanAppSetting("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const z=this.Da.ub("Common.IRefreshableAppSettings");if(z&&z.Sok)return new Za(()=>z.tc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>H.AFrameworkApplication.Qu,()=>new Date,()=>H.AFrameworkApplication.jC,z,this.Da.ub("Common.ISessionStatus"),()=>Jb.instance,
this.Da.Ha("Postmessage.IHostPostmessenger"))}return new Kb(()=>this.La.tc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.La.tc("RenamedFileCheckerPingIntervalInMs",12E4),()=>H.AFrameworkApplication.Qu,()=>new Date,()=>H.AFrameworkApplication.jC,H.AFrameworkApplication.fa,H.AFrameworkApplication.Pa,H.AFrameworkApplication.Be,this.Da.ub("Common.ISessionStatus"),this.Da.Ha("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.La.Ue(this.Pn)}dispose(){}}Object(k.a)(Hc,"PackageManager",
null,[2,3]);const jd=z=>{try{return W.a(z)}catch(Z){}return null};class Id{constructor(z,Z,pa,Fa,Ma,tb){this.e4=!1;this.XT=null;this.USd=!1;this.L1d=Hb=>{const rc=Hb.yN.task;rc.continueWith(()=>{this.XT=rc.result;this.USd&&(this.XT.gca(2,null,!0),this.USd=!1);this.XT.fEa((yc,xc)=>{2===xc.type&&this.zn.nb(oa.a.bAb,2)});this.XT.C9a((yc,xc)=>{2===xc.newState&&this.zn.nb(oa.a.bAb,2)});2===this.XT.connectionState&&this.zn.nb(oa.a.bAb,2)})};this.tMb=Hb=>{this.e4=!1;const rc=jd(Hb.data.Ud);Hb.data.state.uu(rc,
this.Fyf.value)};this.K8k=Hb=>{5!==Hb.data.status||this.e4?this.Uoh(Hb):(this.e4=!0,this.L$f(Hb.data.state,!1))};this.Uoh=Hb=>{Hb.data.state.wA(-1)};this.urc=Hb=>{this.e4=!1;const rc=jd(Hb.data.Ud);Hb.data.state.uu(rc,this.Fyf.value);this.Jjh()};this.R8k=Hb=>{5!==Hb.data.status||this.e4?this.aph(Hb):(this.e4=!0,this.M$f(Hb.data.state,!1))};this.aph=Hb=>{Hb.data.state.wA(-1)};this.Ca=z;this.Bi=Z;this.LPa=pa;this.Fyf=Fa;this.La=Ma;this.qii=tb}init(z,Z){Z&&z.Ha("Common.Interface.IRtcBasicProvider").execute(this.L1d)}Hua(z){this.L$f(z,
!0)}L$f(z,Z){const pa=this.oLi(z.JSh),Fa={};Fa[Id.ZZf]=Id.$Zf;this.YFh.Tj(pa,2,"",Fa,!1,2,this.tMb,Z?this.K8k:this.Uoh,z)}fbb(z){this.M$f(z,!0)}M$f(z,Z){const pa=this.pLi(),Fa={};Fa[Id.ZZf]=Id.$Zf;Fa[Id.B0j]=Ob.a.We(z.gGh);Fa[Id.z0j]=this.qii.value.x5d;this.YFh.Tj(pa,2,"",Fa,!1,2,this.urc,Z?this.R8k:this.aph,z)}pLi(){return this.oSf()}oLi(z){let Z=this.oSf();return Z=C.a.Xi(Z,Id.F0j,z?"2":"1")}oSf(){let z=(this.La.value.appSettings.RenameWebServiceBase||"")+Id.A0j;z=C.a.Xi(z,Id.C0j,Ob.a.We(H.AFrameworkApplication.mh));
this.jC&&this.jC.tve&&(z=C.a.Xi(z,Id.E0j,"1"));return z}Jjh(){this.XT?this.XT.gca(2,null,!0):this.USd=!0}get zn(){return this.Ca.value}get YFh(){return this.Bi.value}get jC(){return this.LPa.value}static get instance(){return Id.Ja||(Id.Ja=Id.Tbb())}static Tbb(){return new Id(new rb.a(()=>H.AFrameworkApplication.Pa),new rb.a(()=>H.AFrameworkApplication.Me),new rb.a(()=>H.AFrameworkApplication.jC),new rb.a(()=>ia.a.instance.resolve("Postmessage.IHostPostmessenger")),new rb.a(()=>H.AFrameworkApplication.fa),
new rb.a(()=>ia.a.instance.resolve("Common.IRenameProps")))}}Id.ZZf="Content-Type";Id.$Zf="application/json; charset=utf-8";Id.A0j="renamehandler.ashx";Id.C0j="qs";Id.B0j="n";Id.E0j="sl";Id.z0j="X-CoauthLockId";Id.F0j="u";Id.Ja=null;Object(k.a)(Id,"ExecuteRenameFileHandler",null,[]);class ze{constructor(){this.wA=this.uu=null;this.JSh=!1}}Object(k.a)(ze,"ExecuteRefreshFilenameData",null,[]);class Ie{constructor(){this.wA=this.uu=this.gGh=null}}Object(k.a)(Ie,"ExecuteRenameFileData",null,[]);class Cd{constructor(){this.Da=
null;this.tLd=Id.instance;this.Pn=()=>{H.AFrameworkApplication.Jfc()&&(Id.instance.init(this.Da,H.AFrameworkApplication.Svc),H.AFrameworkApplication.fbb=Object(ib.a)(this,this.fbb,"executeRenameFile"),H.AFrameworkApplication.Hua=Object(ib.a)(this,this.Hua,"executeRefreshFilename"),H.AFrameworkApplication.dxc=Object(ib.a)(this,this.dxc,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}fc(z){this.Da=z}init(){H.AFrameworkApplication.fa.Ue(this.Pn)}fbb(z,
Z,pa){const Fa=new Ie;Fa.gGh=z;Fa.uu=Z;Fa.wA=pa;this.tLd.fbb(Fa)}Hua(z,Z,pa){const Fa=new ze;Fa.uu=z;Fa.wA=Z;Fa.JSh=pa;this.tLd.Hua(Fa)}dxc(){this.tLd.Jjh()}dispose(){}}Object(k.a)(Cd,"PackageManager",null,[2,3]);class ue{constructor(z,Z,pa,Fa,Ma,tb){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=z;this.WebAffinitizedUrl=Z;this.PolicyCookie=pa;this.PolicyCookieTTL=Fa;this.WasServiceDown=
Ma;this.AffinitizedUrl=tb}}Object(k.a)(ue,"SafeLinksData",null,[]);class Ee{constructor(z,Z){this.zCd=z;this.Lz=Z}}Object(k.a)(Ee,"SafeLinksGetUrlReputationRequestData",null,[]);class Xe{constructor(z,Z,pa,Fa){this.T5k=Ma=>{let tb="OnGetUrlReputationSuccessCallback: ",Hb=10;const rc=Ma.data.state;try{const yc=W.b(Ma.data.Ud).reputationResults[0],xc=yc.navigateUrl.length,ld=rc.zCd.length,wd=yc.navigateUrl===rc.zCd;yc.navigateUrl&&0<yc.navigateUrl.length&&(rc.zCd=yc.navigateUrl);tb+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",
Ma.data.Ke,yc.verdict,ld.toString(),xc.toString(),wd.toString());Hb=50}catch(yc){tb+=String.format("Exception {0}",yc.message)}this.xsg(rc,tb,Hb)};this.S5k=Ma=>{let tb="OnGetUrlReputationFailureCallback: ";const Hb=Ma.data.state;try{tb+=String.format("HttpStatus {0}",Ma.data.Ke)}catch(rc){tb+=String.format("Exception {0}",rc.message)}this.xsg(Hb,tb,10)};this.La=z;this.Bi=Z;this.afi=pa;Xe.Di=Fa}eEd(z,Z,pa){try{var Fa=null;Xe.Di&&(Fa=Xe.Di.lj("WebServiceCall","SafeLinksGetUrlReputation"));const Ma=
new Ee(Z,Fa);Fa={};Fa.AffinitizedUrl=z;Fa.TargetUrl=Z;Fa.PolicyCookie=pa;const tb=W.c(Fa);this.Bi.Tj(this.afi,2,tb,null,!1,2,this.T5k,this.S5k,Ma,void 0,void 0,3E3,3E3,"36");return!0}catch(Ma){e.ULS.sendTraceTag(588788033,378,10,Ma.message)}return!1}xsg(z,Z,pa){z.Lz&&(z.Lz.stop(),z.Lz=null);e.ULS.sendTraceTag(588788034,378,pa,Z);Rc.a.qo(z.zCd,void 0,"noopener,noreferrer","SafeLinksNav")}}Xe.Di=null;Object(k.a)(Xe,"SafeLinksNavigationHelper",null,[]);var Sd;(function(z){z[z.Bum=0]="enabledByPolicy";
z[z.kum=1]="disabledByPolicy";z[z.mum=2]="disabled_GetPolicyFailure";z[z.num=3]="disabled_PendingGetPolicyRequest"})(Sd||(Sd={}));Object(k.b)("SafeLinksNavigationState",Sd);var ad=d(504);class af{constructor(z,Z,pa,Fa=!1,Ma=null,tb=null){this.I6a=this.H6a=0;this.Oec=this.tGc=!1;this.vRa=null;this.Osb=!0;this.jLc=null;this.RKj=yc=>{let xc=E.a.r0k,ld="";try{this.tGc=this.Oec=!1;var wd=yc.data.state;const Rb=({Lz:wd}=this.CBd(wd)).returnValue,Cb=Object.assign(new sa.a,{durationMs:Rb});m.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",
Cb);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",yc.data.Ke,yc.data.Ud.length,Rb);if(yc.data.Ke!==E.a.Zw)ld="Unexpected httpStatus: "+yc.data.Ke.toString();else{wd=null;try{wd=W.b(yc.data.Ud)}catch(cc){ld="Exception:"+cc.toString()+" deserializing response";return}if(wd){var t=wd.IsSafeLinksEnabled;if(void 0===t||null===t||0>=t.length)ld="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,
"Retrieved isSafeLinksEnabledString {0}",t);var aa=af.YWe(t);if(void 0===wd.WebAffinitizedUrl||null===wd.WebAffinitizedUrl||0>=wd.WebAffinitizedUrl.length)ld="Invalid WebAffinitizedUrl";else if(void 0===wd.PolicyCookie||null===wd.PolicyCookie||0>=wd.PolicyCookie.length)ld="Invalid PolicyCookie";else if(void 0===wd.PolicyCookieTTL||null===wd.PolicyCookieTTL)ld="Invalid PolicyCookieTTL";else{var ra=wd.WebAffinitizedUrl,Na=wd.PolicyCookie,db=wd.AffinitizedUrl,kb=new Date;kb.setMinutes(kb.getMinutes()+
(5<wd.PolicyCookieTTL?wd.PolicyCookieTTL-5:0));var Ib=new ue(t,ra,Na,kb.getTime(),!1,db);this.sLh(Ib);xc=yc.data.Ke;this.vRa&&(aa?(this.K_h(this.vRa),this.I6a=this.H6a=0):(e.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),m.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Rc.a.KYc(this.vRa)),this.vRa=null)}}}else ld="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Rb){ld="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+
Rb.toString()}finally{xc!==E.a.Zw&&this.wsg(xc,ld)}};this.QKj=yc=>{this.tGc=!1;let xc=500,ld="";try{let wd=yc.data.state;const t=({Lz:wd}=this.CBd(wd)).returnValue,aa=Object.assign(new sa.a,{durationMs:t});xc=yc.data.Ke;m.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+xc.toString(),!1,!0,aa);ld="Request Failed, Status="+ad.a[yc.data.status]+" Duration: "+t}catch(wd){ld="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+wd.toString()}finally{this.wsg(xc,
ld)}};e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.La=z;this.Bi=Z;this.t8=pa;af.Di=tb;this.Cri=Fa?this.La.Ea("SafeLinksHandlerWebServiceBase"):this.La.Ea("WebServiceBase");this.jri=this.La.Ea("SafeLinksHashedUserId");this.Hpm=this.La.Ea("SafeLinksWorkloadIdHeaderValue");this.wIc=this.La.tc("SafeLinksMaxGetPolicyBootRetries",2);this.xIc=this.La.tc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.nHc=this.wpk();this.mHc=this.vpk();af.YHf=this.La.Ea("UserPrincipalName")||
"";af.VGf=this.La.Ea("TenantId")||"";e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.nHc,this.mHc);if(this.nHc&&this.mHc){Z=(z=this.CVa())?z.IsSafeLinksEnabled.toLowerCase():"";pa=this.Vwe();e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",Z,pa);var Hb=!z||"unknown"===Z||z.WasServiceDown||pa,rc=G.a.Yz();rc&&(rc.set("shouldGetSafeLinksDataFromServer",Hb.toString()),rc.set("isSafeLinksEnabledCacheValue",
Z.toString()));Ma?(this.Osb=!1,Ma.execute(yc=>{yc.isFeatureEnabled("MsoUrlreputation",!0).then(xc=>{this.Osb=xc;rc.set("isUserLicensedForSafeLinks",this.Osb.toString());m.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",rc);this.Osb&&Hb&&this.K1c(!0);return null})})):(m.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",rc),Hb&&this.K1c(!0))}}get appName(){return this.t8}get iGd(){return this.Cri}get userId(){return this.jri}get wqg(){try{if(""===af.sMd){const z=
{};z["X-AppName"]=this.appName;z["X-AppVersion"]=H.AFrameworkApplication.buildVersion;z.OS=this.La.Ea("PlatformNameAndVersion")||"";const Z=JSON.stringify(z);af.sMd=window.self.btoa(Z)}}catch(z){e.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",z.message)}return af.sMd}get wIj(){const z=this.iGd?this.iGd+"/":"",Z=new Y.QueryStringBuilder("SafeLinksHandler.ashx");Z.zg("app",this.appName);this.La.getBooleanAppSetting("SafeLinksUseDebugHeader")&&Z.zg("action","debug");
this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&Z.zg("s2satpop","1");this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&Z.zg("s2se03","1");return String.format("{0}{1}&{2}",z,Z.toString(),H.AFrameworkApplication.mh)}get SQj(){const z=this.iGd?this.iGd+"/":"",Z=new Y.QueryStringBuilder("SafeLinksHandler.ashx");Z.zg("app",this.appName);this.La.getBooleanAppSetting("SafeLinksUseDebugHeader")&&Z.zg("action","debug");this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&Z.zg("s2satpop","1");this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&Z.zg("s2saat","1");this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&Z.zg("s2se03","1");this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&Z.zg("sladpar",this.wqg);Z.zg("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",z,Z.toString(),H.AFrameworkApplication.mh)}get k_k(){af.CUd||(af.CUd=new Xe(this.La,
this.Bi,this.SQj,af.Di));return af.CUd}eEd(z){if(!z)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var Z=this.Tjk(z);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",Z,this.nHc,this.mHc,this.Osb);if(!(Z&&this.nHc&&this.mHc&&this.Osb))return!1;Z=0;const pa=({state:Z}=this.NZl()).returnValue;e.ULS.sendTraceTag(595079385,378,
50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Sd[Z]);const Fa=G.a.Yz();Fa&&Fa.set("SafeLinksNavigationState",Sd[Z]);m.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",Fa);if(!pa)return 2!==Z&&3!==Z||m.Health.instance.recordKpiFailure("SafeLinksNavigations",Sd[Z],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.a_l())return this.Vwe()?!1:this.k_k.eEd(this.Ttj(),z,this.Mmg());if(!this.Vwe())return this.K_h(z),
!0;this.vRa=z;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.Oec=!1;this.K1c();return!0}Tjk(z){z=z.toLowerCase();const Z=this.La.hz("SafeLinksUnsupportedProtocols");if(Z)for(let pa=0;pa<Z.length;pa++)if(z.startsWith(Z[pa]))return!1;return!0}K1c(z=!1){var Z=G.a.Yz();Z&&Z.set("isOnBootRequest",z.toString());m.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",Z);m.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",
0,"jpittsdirects",Z);Z=this.s7d("SafeLinksGetPolicy");this.Bi.Tj(this.wIj,1,null,null,!0,2,this.RKj,this.QKj,Z,void 0,void 0,void 0,void 0,"23");this.Oec=z;this.tGc=!0;z?this.H6a++:this.I6a++}wsg(z,Z=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",z,Z),this.H6a<this.wIc&&this.I6a<this.xIc)this.K1c(this.Oec);else{this.Oec=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.H6a,this.I6a,z,Z);Z=null;const pa=G.a.Yz();pa&&(pa.set("HttpStatus",z.toString()),Z=Object.assign(new sa.a,{extendedProperties:pa}));m.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,Z);const Fa=new ue("false","","",0,!0,"");this.sLh(Fa);this.vRa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),m.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Rc.a.KYc(this.vRa),this.vRa=null)}}catch(pa){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",pa.toString())}}K_h(z){const Z=this.Mmg(),pa=this.QRj(),Fa={};Fa.Url=z;Fa.SafeLinksCookie=Z;Fa.CorrelationId=ka.a.create().toString();Fa.WorkloadId=this.Hpm;Fa.UserAgentInfo=ba.a.nx+"|"+this.appName;this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(Fa.User=af.YHf,Fa.TenantId=af.VGf,Fa.AdditionalProperties=this.wqg);e.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",Fa.CorrelationId);Rc.a.dsd(Rc.a.Vca(4),pa,Fa)}wpk(){const z=this.La.Ea("IsSafeLinksEnabledForUser");return z?af.YWe(z):!1}vpk(){const z=this.La.hz("SafeLinksDisabledBrowsers");if(ba.a.gV){if(this.La.du("SafeLinksForTeamsIsEnabled")&&this.La.getBooleanAppSetting("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(z,"Electron"))return!1}else if(Array.contains(z,ba.a.nx))return!1;return"officecomhwa"===(this.La.Ea(H.AFrameworkApplication.uL)||
"").toLowerCase()?!1:!0}a_l(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&ba.a.gfc?!0:ba.a.gV}NZl(){let z;z=0;const Z=this.CVa(),pa=Z?Z.IsSafeLinksEnabled:"";if(""!==pa)return Z.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===pa.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),
{returnValue:!1,state:1}):{returnValue:af.YWe(pa),state:z};if(this.tGc)return z=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:z};if(this.H6a>=this.wIc||this.I6a>=this.xIc)return z=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.H6a,this.wIc,this.I6a,this.xIc),{returnValue:!1,state:z};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.wIc+this.xIc-(this.H6a+this.I6a));return{returnValue:!0,state:z}}Mmg(){const z=this.CVa();return z?z.PolicyCookie:""}QRj(){const z=this.CVa();return z?z.WebAffinitizedUrl:""}Ttj(){const z=this.CVa();return z?z.AffinitizedUrl:""}$Aj(){const z=new Date;try{const Z=this.CVa();z.setTime(Z?Z.PolicyCookieTTL:0)}catch(Z){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",Z)}return z}Vwe(){const z=this.$Aj();return!!z&&z.getTime()<Date.now()}CVa(){if(!this.jLc){const z=
Ha.a.instance.getItem(this.userId);if(!z||""===z)return null;this.jLc=JSON.parse(z)}return this.jLc}sLh(z){if(void 0===z||null===z)throw Error.argumentNull("safeLinksData");if(void 0===z.IsSafeLinksEnabled||null===z.IsSafeLinksEnabled||0>=z.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.jLc=z;z.WasServiceDown||this.Opm(z)}Opm(z){z=JSON.stringify(z);Ha.a.instance.setItem(this.userId,z)}s7d(z){return void 0!==af.Di&&null!==af.Di?af.Di.lj("WebServiceCall",
z):null}CBd(z){if(void 0!==z&&null!==z){const Z=z.Qr;z.stop();return{returnValue:Z,Lz:null}}return{returnValue:null,Lz:z}}static YWe(z){return"false"!==z.toLowerCase()?!0:!1}}af.Di=null;af.CUd=null;af.VGf="";af.YHf="";af.sMd="";Object(k.a)(af,"SafeLinksManager",null,[1043]);const pf=z=>{switch(z){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},xf=z=>{switch(z){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};
var gf=d(213);class me{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}fc(z){this.K=z}init(){H.AFrameworkApplication.fa.Ue(Object(ib.a)(this,this.Pn,"onFullAppSettingsReady"))}Pn(){const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Z=z?z.Mg:!1;z.pptSafeLinksIsEnabled&&(this.K.register(af,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().na(()=>new af(H.AFrameworkApplication.fa,H.AFrameworkApplication.Me,String.format("{0}-{1}",
pf(H.AFrameworkApplication.za.mb.Ej),xf(H.AFrameworkApplication.za.mb.wLa)),Z)).ma(),this.K.ub("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){Qa.a.instance.Ac(gf.a(new me,0))}}Object(k.a)(me,"SafeLinksPackage",null,[2,3]);var ag=d(310),de=d(288),wa=d(1270),ta=d(86),Eb=d(28),qc=d(183),Sc=d(94),td=d(1071);class je{constructor(z,Z,pa,Fa,Ma,tb){this.IH=z;this._id=Z;this.HKd=Fa;this.gdi=Ma;this.hdi=tb;this.hFc=this.Cyb;void 0!==pa&&null!==pa&&(this.Cyb=pa)}get defaultValue(){return this.hFc}get lcid(){return this.IH}get id(){return this._id}get Cyb(){return(this.gdi||
je.Hrf)(this.HKd)}set Cyb(z){(this.hdi||je.Irf)(this.HKd,z)}get tg(){return this.HKd}static As(){je.Hrf=()=>null;je.Irf=()=>{}}}je.Hrf=null;je.Irf=null;Object(k.a)(je,"GrammarSettingOption",null,[1158]);je.As();class Te{constructor(z,Z,pa){this.cee=z;this.s6e=Z;this.D_k=pa}}Object(k.a)(Te,"TwoLevelCacheKey",null,[]);var Hd=d(34),mg=d(219),fg=d(3);class $e extends qb.a{constructor(z,Z,pa,Fa){super();this.ZTd=this.r9=this.ttf=this.EWb=null;this.Bp=Fa;this.RJd=z;this.Fg=$e.id;this.jki=()=>{this.EWb=
pa?ha.a.Zxc(pa):{};this.ttf=pa?ha.a.Zxc(pa):{};const Ma=this.MJi(),tb=$e.G2i(Ma,$e.dyd(Object(ib.a)(this,this.F2i,"createCritiqueTypeSettingsTracker"))($e.cXi(rc=>this.EWb=rc)));tb(pa||{});var Hb=$e.dyd($e.Q7i())(rc=>rc.cloneNode(!0));$e.H2i(Ma,$e.e2i($e.c6i(Z),$e.E2i(Hb))(pa))(z.toString());this.ZTd=this.rLi();Hb=rc=>{if("click"===rc.type||rc.keyCode===qc.a.Mp||rc.keyCode===qc.a.MUb)this.EWb[z.toString()]={},Ma.reset(),$e.lFl(tb)};Sc.a.addHandler(this.G2a,ob.a.click,Hb);Sc.a.addHandler(this.G2a,
ob.a.Vf,Hb)};this.Wg=""}get G2a(){return this.ZTd}Rsk(){var z=$e.M2e(this.EWb),Z=$e.M2e(this.ttf);if(!z&&!Z)return!1;let pa;try{pa=z?Object(w.a)(Object,z[this.RJd.toString()]):{};var Fa=Z?Object(w.a)(Object,Z[this.RJd.toString()]):{}}catch(Hb){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!pa&&!Fa)return!1;pa=pa?pa:{};Fa=Fa?Fa:{};z=String.format("language: {0}",this.RJd.toString());Z=!1;for(const Hb in pa){var Ma=Hb,tb=pa[Hb];Ma in Fa&&Fa[Ma]===tb||(Z=!0,z=String.format("{0}, [{1}, {2}]",
z,Ma,tb))}for(const Hb in Fa)Fa=Hb,Fa in pa||(Z=!0,z=String.format("{0}, [{1}, default]",z,Fa));Z&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",z);return Z}Vj(z,Z,pa){super.Vj(z,Z,pa);this.Zsl()}FU(z){return z.Ec.id===$e.nGh?!1:super.FU(z)}ELl(){this.Bp.gm().Qmd();this.r9=this.Bp.gm().jk.L0}Zsl(){this.Bp.gm().scope.Sy(Ic.FocusManager.instance().ata);this.Bp.gm().scope.Sy(Ic.FocusManager.instance().bta);this.Bp.gm().scope.bindAction(Ic.FocusManager.instance().ata,Hd.a.Ybc);this.Bp.gm().scope.bindAction(Ic.FocusManager.instance().bta,
Hd.a.Xbc);this.Bp.gm().scope.bindAction(ub.KeyInputManager.Va(qc.a.Rca,0),Hd.a.V2c);this.Bp.gm().scope.bindAction(ub.KeyInputManager.Va(qc.a.eja,0),Hd.a.U2c);this.Bp.gm().scope.bindAction(ub.KeyInputManager.Va(qc.a.J3,0),Hd.a.V2c);this.Bp.gm().scope.bindAction(ub.KeyInputManager.Va(qc.a.o8,0),Hd.a.U2c)}get settings(){return $e.M2e(this.EWb)}$ya(){super.$ya();this.jki()}MJi(){const z=$e.kKi(),Z=$e.n4b("WACDialogRow",z);this.aR.insertBefore(Z,this.aR.firstChild);return z}F2i(z){const Z=td.a.merge(null,
z);return pa=>{pa.Cyb===(z&&z[pa.lcid]?z[pa.lcid][pa.id]:null)||pa.Cyb!==pa.defaultValue?$e.jmg(Z,pa.lcid)[pa.id]=pa.Cyb:delete $e.jmg(Z,pa.lcid)[pa.id];this.r9=this.LBj(pa.tg);return Z}}LBj(z){return z?(z=z.getElementsByTagName(Sys.UI.DomElement.containsCssClass(z,$e.Tuk)?"select":"input"))?z[0]:null:null}dispose(){this.G2a&&(Sc.a.DCh(this.G2a),this.ZTd=null);super.dispose()}rLi(){const z=document.createElement("input");z.id=$e.nGh;z.type="reset";z.setAttribute("form",$e.neg);z.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";
z.value=CommonUIStrings.l_ResetAll;const Z=$e.n4b("GrammarSettingsDialogResetButtonContainer",z),pa=document.getElementById("WACDialogButtonPanel");pa.parentNode.insertBefore(Z,pa);return z}static get e7b(){return"CritiqueType"}static cXi(z){return Z=>pa=>z(Z(pa))}static dyd(z){return Z=>pa=>Z(z(pa))}static M2e(z){const Z={};ha.a.forEach(z,(pa,Fa)=>{0<mg.a(Fa).length&&(Z[pa]=Fa)},null);return Z}static kKi(){const z=document.createElement("form");z.id=$e.neg;Sys.UI.DomElement.addCssClass(z,"WACDialogList");
Sys.UI.DomElement.addCssClass(z,$e.k8i);return z}static G2i(z,Z){const pa=$e.esl(z,ob.a.change);return Fa=>{const Ma=Z(Fa);pa(tb=>{tb=tb.target.parentNode;Sys.UI.DomElement.containsCssClass(tb,$e.e7b)&&Ma(tb[$e.bQf])})}}static esl(z,Z){let pa=null;return Fa=>{pa&&Sc.a.removeHandler(z,Z,pa);Sc.a.addHandler(z,Z,Fa);pa=Fa}}static jmg(z,Z){return z[Z]=z[Z]||{}}static lFl(z){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");z(null)}static c6i(z){let Z=null;return pa=>{Z=pa;return z.request(Number.parseInvariant(pa)).CWRCo(Fa=>
Z===pa?Fa.result:null,$e.y9d)}}static H2i(z,Z){const pa=$e.Nuj(Fa=>$e.bam(Fa.children));return Fa=>{const Ma=pa(Fa,z);z.innerHTML="";(Ma?fg.Task.ju(Ma):Z(Fa)).continueWith(tb=>{tb=tb.result;for(let Hb=0;Hb<tb.length;Hb++)z.appendChild(tb[Hb])},$e.y9d)}}static e2i(z,Z){return pa=>Fa=>z(Fa).CWRCo(Ma=>Ea.toArray(Ea.select(Ea.asEnumerable(Ma.result),tb=>Z(pa,tb,Fa))),$e.y9d)}static bam(z){const Z=[];for(let pa=0;pa<z.length;pa++)Z.push(z[pa]);return Z}static Nuj(z){const Z={};let pa=null;return(Fa,Ma)=>
{pa&&!Z[pa]&&(Ma=z(Ma))&&(Z[pa]=Ma);pa=Fa;return Z[Fa]}}static Q7i(){const z={};return Z=>{z[Z.cee]=z[Z.cee]||{};const pa=z[Z.cee];pa[Z.s6e]=pa[Z.s6e]||Z.D_k();return pa[Z.s6e]}}static E2i(z){return(Z,pa,Fa)=>{const Ma=z(new Te(Fa,pa.Id,()=>$e.WJi(pa)));Ma.setAttribute("role","group");const tb=$e.yVf+pa.Name;Ma.setAttribute("aria-labelledby",tb);for(const Hb of pa.CritiqueTypeInfoList){const rc=$e.msj(Fa,Hb,Z,z);Ma.appendChild(rc);rc.setAttribute("aria-labelledby",tb)}return Ma}}static msj(z,Z,pa,
Fa){Fa=Fa(new Te(z,Z.Id,()=>Z.IsBinaryCritiqueType?$e.SJi(Z):$e.bLi(Z)));z=new je(z,Z.Id,pa&&pa[z]?pa[z][Z.Id]:null,Fa,Z.IsBinaryCritiqueType?Ma=>Ma.children[0].checked:Ma=>Ma.children[1].selectedIndex,Z.IsBinaryCritiqueType?(Ma,tb)=>{Ma.children[0].checked=tb}:(Ma,tb)=>{Ma.children[1].selectedIndex=tb});Fa[$e.bQf]=z;return Fa}static WJi(z){z=$e.YJi(z.Name);z.className="WACWritingStylesDialogCategoryTitle";return $e.n4b("CritiqueCategory",z)}static SJi(z){const Z=$e.ZJi();Z.id=z.Id;0<z.DefaultCritiqueValue&&
Z.setAttribute("checked","checked");z=$e.aSf(z.Name,z.Id);z.className="WACDialogLabel";const pa=$e.n4b($e.e7b,Z,z);pa.appendChild(Z);pa.appendChild(z);return pa}static bLi(z){z=$e.MKi(z.Id,z.Name,$e.gLi(z.CritiqueTypeValues,z.DefaultCritiqueValue),z.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(z,$e.e7b);return z}static gLi(z,Z){return Ea.toArray(Ea.Si(Ea.asEnumerable(z||[]),(pa,Fa)=>{pa=$e.fLi(pa,Fa.toString());Fa===Z&&pa.setAttribute("selected","selected");return pa}))}static MKi(z,Z,pa,Fa){Z=
$e.aSf(Z,z);const Ma=document.createElement("select");Ma.id=z;Ma.className="WACDialogList";pa=pa||[];for(z=0;z<pa.length;z++)Ma.appendChild(pa[z]),Fa===z&&(pa[z].selected=!0);return $e.n4b("GrammarSettingsDialogLabeledInlineList",Z,Ma)}static fLi(z,Z){const pa=document.createElement("option");pa.text=z;pa.value=Z;return pa}static ZJi(){const z=document.createElement("input");z.type="checkbox";z.className="WACDialogCheckBox";return z}static aSf(z,Z){const pa=document.createElement("label");pa.innerText=
z;pa.setAttribute("for",Z);return pa}static YJi(z){const Z=document.createElement("div");Z.innerText=z;Z.id=$e.yVf+z;return Z}static n4b(z=null,...Z){const pa=document.createElement("div");pa.className=z;for(const Fa of Z)pa.appendChild(Fa);return pa}}$e.id="GrammarSettingsDialog";$e.neg="CritiqueTypeSettings";$e.k8i="CritiquesList";$e.Tuk="GrammarSettingsDialogLabeledInlineList";$e.nGh="ResetButton";$e.yVf="WritingStylesCategory_";$e.y9d=11;$e.bQf="CritiqueType";Object(k.a)($e,"GrammarSettingsDialog",
qb.a,[]);var oj=d(144),Me=d(321),we=d(1173),Zc=d(37),te=d(354),ne=d(61),Zf=d(154),cd=d(47),aj=d(916),Qc=d(27),Mc=d(29);class Ig{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(k.a)(Ig,"EffectDataInfo",null,[]);var wg=d(876);class fe{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(k.a)(fe,"AddAnimationInfo",null,[]);class Qe{constructor(){this.TargetEffects=null}}Object(k.a)(Qe,"DeleteAnimationInfo",
null,[]);class ig{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(k.a)(ig,"TargetEffect",null,[]);class Ph{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(k.a)(Ph,"ReplaceAnimationInfo",null,[]);class $g{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(k.a)($g,"ModifyAnimationInfo",null,[]);class Vg{constructor(){this.StartType=0;this.TargetEffects=
null}}Object(k.a)(Vg,"ChangeAnimationRelationshipInfo",null,[]);var Fg=d(318),bf=d(151),Ag=d(90);class ff{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(k.a)(ff,"ChangeAnimationBuildTypeInfo",null,[]);class Fe{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(k.a)(Fe,"ReorderAnimationEffectsInfo",null,[]);var Pf=d(30),Md=d(38),vg=d(41),Ye=d(109),Cf=d(1061),Bg=d(279),Ae=d(479);class Uf{constructor(){this.effectId=this.effectType=0;this.labelText=this.ef=this.effectData=
this.No=null}}Object(k.a)(Uf,"AnimInfo",null,[]);class Jd{constructor(){this.uk=this.labelText=this.ef=this.id=null}}Object(k.a)(Jd,"EffectOption",null,[]);class We extends Jd{constructor(){super();this.value=null}}Object(k.a)(We,"EffectData",Jd,[]);class fd{constructor(z){this.YYa=z;fd.nm||(fd.nm=new Cf.a,fd.nm.add("FromBottom",Object.assign(new Jd,{id:"FromBottom",ef:fd.yf("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,uk:CommonUIStrings.l_AnimationFromBottomKeytip})),
fd.nm.add("FromBottomLeft",Object.assign(new Jd,{id:"FromBottomLeft",ef:fd.yf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,uk:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),fd.nm.add("FromLeft",Object.assign(new Jd,{id:"FromLeft",ef:fd.yf("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,uk:CommonUIStrings.l_AnimationFromLeftKeytip})),fd.nm.add("FromTopLeft",Object.assign(new Jd,{id:"FromTopLeft",ef:fd.yf("AnimEffectPropFromTopLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,uk:CommonUIStrings.l_AnimationFromTopLeftKeytip})),fd.nm.add("FromTop",Object.assign(new Jd,{id:"FromTop",ef:fd.yf("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,uk:CommonUIStrings.l_AnimationFromTopKeytip})),fd.nm.add("FromTopRight",Object.assign(new Jd,{id:"FromTopRight",ef:fd.yf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,uk:CommonUIStrings.l_AnimationFromTopRightKeytip})),
fd.nm.add("FromRight",Object.assign(new Jd,{id:"FromRight",ef:fd.yf("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,uk:CommonUIStrings.l_AnimationFromRightKeytip})),fd.nm.add("FromBottomRight",Object.assign(new Jd,{id:"FromBottomRight",ef:fd.yf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,uk:CommonUIStrings.l_AnimationFromBottomRightKeytip})),fd.nm.add("ToBottom",Object.assign(new Jd,{id:"ToBottom",ef:fd.yf("AnimEffectPropFromTop"),
labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,uk:CommonUIStrings.l_AnimationFromBottomKeytip})),fd.nm.add("ToBottomLeft",Object.assign(new Jd,{id:"ToBottomLeft",ef:fd.yf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,uk:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),fd.nm.add("ToLeft",Object.assign(new Jd,{id:"ToLeft",ef:fd.yf("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,uk:CommonUIStrings.l_AnimationFromLeftKeytip})),
fd.nm.add("ToTopLeft",Object.assign(new Jd,{id:"ToTopLeft",ef:fd.yf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,uk:CommonUIStrings.l_AnimationFromTopLeftKeytip})),fd.nm.add("ToTop",Object.assign(new Jd,{id:"ToTop",ef:fd.yf("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,uk:CommonUIStrings.l_AnimationFromTopKeytip})),fd.nm.add("ToTopRight",Object.assign(new Jd,{id:"ToTopRight",ef:fd.yf("AnimEffectPropFromBottomLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,uk:CommonUIStrings.l_AnimationFromTopRightKeytip})),fd.nm.add("ToRight",Object.assign(new Jd,{id:"ToRight",ef:fd.yf("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,uk:CommonUIStrings.l_AnimationFromRightKeytip})),fd.nm.add("ToBottomRight",Object.assign(new Jd,{id:"ToBottomRight",ef:fd.yf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,uk:CommonUIStrings.l_AnimationFromBottomRightKeytip})),
fd.nm.add("Horizontal",Object.assign(new Jd,{id:"Horizontal",ef:fd.yf("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,uk:CommonUIStrings.l_AnimationHorizontalKeytip})),fd.nm.add("HorizontalIn",Object.assign(new Jd,{id:"HorizontalIn",ef:fd.yf("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,uk:CommonUIStrings.l_AnimationHorizontalInKeytip})),fd.nm.add("HorizontalOut",Object.assign(new Jd,{id:"HorizontalOut",ef:fd.yf("AnimEffectPropHorizontalOut"),
labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,uk:CommonUIStrings.l_AnimationHorizontalOutKeytip})),fd.nm.add("Vertical",Object.assign(new Jd,{id:"Vertical",ef:fd.yf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,uk:CommonUIStrings.l_AnimationVerticalKeytip})),fd.nm.add("VerticalIn",Object.assign(new Jd,{id:"VerticalIn",ef:fd.yf("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,uk:CommonUIStrings.l_AnimationVerticalInKeytip})),
fd.nm.add("VerticalOut",Object.assign(new Jd,{id:"VerticalOut",ef:fd.yf("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,uk:CommonUIStrings.l_AnimationVerticalOutKeytip})),fd.nm.add("LeftDown",Object.assign(new Jd,{id:"LeftDown",ef:fd.yf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,uk:CommonUIStrings.l_AnimationLeftDownKeytip})),fd.nm.add("LeftUp",Object.assign(new Jd,{id:"LeftUp",ef:fd.yf("AnimEffectPropFromBottomRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,uk:CommonUIStrings.l_AnimationLeftUpKeytip})),fd.nm.add("RightDown",Object.assign(new Jd,{id:"RightDown",ef:fd.yf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,uk:CommonUIStrings.l_AnimationRightDownKeytip})),fd.nm.add("RightUp",Object.assign(new Jd,{id:"RightUp",ef:fd.yf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,uk:CommonUIStrings.l_AnimationRightUpKeytip})),
fd.nm.add("In",Object.assign(new Jd,{id:"In",ef:fd.yf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,uk:CommonUIStrings.l_AnimationInKeytip})),fd.nm.add("InBottom",Object.assign(new Jd,{id:"InBottom",ef:fd.yf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,uk:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),fd.nm.add("InCenter",Object.assign(new Jd,{id:"InCenter",ef:fd.yf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,
uk:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),fd.nm.add("InSlightly",Object.assign(new Jd,{id:"InSlightly",ef:fd.yf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,uk:CommonUIStrings.l_AnimationInSlightlyKeytip})),fd.nm.add("Out",Object.assign(new Jd,{id:"Out",ef:fd.yf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,uk:CommonUIStrings.l_AnimationOutKeytip})),fd.nm.add("OutBottom",Object.assign(new Jd,{id:"OutBottom",ef:fd.yf("AnimEffectPropOut"),
labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,uk:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),fd.nm.add("OutCenter",Object.assign(new Jd,{id:"OutCenter",ef:fd.yf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,uk:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),fd.nm.add("OutSlightly",Object.assign(new Jd,{id:"OutSlightly",ef:fd.yf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,uk:CommonUIStrings.l_AnimationOutSlightlyKeytip})),
fd.nm.add("FloatUp",Object.assign(new Jd,{id:"FloatUp",ef:fd.yf("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,uk:CommonUIStrings.l_AnimationOutKeytip})),fd.nm.add("FloatDown",Object.assign(new Jd,{id:"FloatDown",ef:fd.yf("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,uk:CommonUIStrings.l_AnimationDownKeytip})),fd.nm.add("ObjectCenter",Object.assign(new Jd,{id:"ObjectCenter",ef:fd.yf("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
uk:CommonUIStrings.l_AnimationObjectCenterKeytip})),fd.nm.add("SlideCenter",Object.assign(new Jd,{id:"SlideCenter",ef:fd.yf("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,uk:CommonUIStrings.l_AnimationSlideCenterKeytip})),fd.nm.add("ObjectCenterOut",Object.assign(new Jd,{id:"ObjectCenterOut",ef:fd.yf("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,uk:CommonUIStrings.l_AnimationObjectCenterKeytip})),fd.nm.add("SlideCenterOut",
Object.assign(new Jd,{id:"SlideCenterOut",ef:fd.yf("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,uk:CommonUIStrings.l_AnimationSlideCenterKeytip})),fd.nm.add("Clockwise",Object.assign(new Jd,{id:"Clockwise",ef:fd.yf("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,uk:CommonUIStrings.l_AnimationClockWiseKeytip})),fd.nm.add("CounterClockwise",Object.assign(new Jd,{id:"CounterClockwise",ef:fd.yf("AnimEffectPropCounterclockwise"),
labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,uk:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),fd.nm.add("Across",Object.assign(new Jd,{id:"Across",ef:fd.yf("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,uk:CommonUIStrings.l_AnimationAcrossKeytip})),fd.nm.add("Up",Object.assign(new Jd,{id:"Up",ef:fd.yf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,uk:CommonUIStrings.l_AnimationUpKeytip})),fd.nm.add("Down",
Object.assign(new Jd,{id:"Down",ef:fd.yf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,uk:CommonUIStrings.l_AnimationDownKeytip})),fd.nm.add("GrowShrinkHorizontal",Object.assign(new Jd,{id:"GrowShrinkHorizontal",ef:fd.yf("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,uk:CommonUIStrings.l_AnimationHorizontalKeytip})),fd.nm.add("GrowShrinkVertical",Object.assign(new Jd,{id:"GrowShrinkVertical",ef:fd.yf("AnimEffectPropGrowShrinkVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,uk:CommonUIStrings.l_AnimationVerticalKeytip})),fd.nm.add("GrowShrinkBoth",Object.assign(new Jd,{id:"GrowShrinkBoth",ef:fd.yf("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,uk:CommonUIStrings.l_AnimationBothKeytip})));fd.IU||(fd.IU=new Cf.a,fd.IU.add("Spin_Quarter",Object.assign(new We,{id:"Spin_Quarter",ef:fd.yf("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",uk:CommonUIStrings.l_AnimationQuarterSpinKeytip})),
fd.IU.add("Spin_Half",Object.assign(new We,{id:"Spin_Half",ef:fd.yf("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",uk:CommonUIStrings.l_AnimationHalfSpinKeytip})),fd.IU.add("Spin_Full",Object.assign(new We,{id:"Spin_Full",ef:fd.yf("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",uk:CommonUIStrings.l_AnimationFullSpinKeytip})),fd.IU.add("Spin_Two",Object.assign(new We,{id:"Spin_Two",ef:fd.yf("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,
value:"720",uk:CommonUIStrings.l_AnimationTwoSpinKeytip})),fd.IU.add("Transparency_25",Object.assign(new We,{id:"Transparency_25",ef:fd.yf("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",uk:CommonUIStrings.l_Animation25PerKeytip})),fd.IU.add("Transparency_50",Object.assign(new We,{id:"Transparency_50",ef:fd.yf("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",uk:CommonUIStrings.l_Animation50PerKeytip})),
fd.IU.add("Transparency_75",Object.assign(new We,{id:"Transparency_75",ef:fd.yf("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",uk:CommonUIStrings.l_Animation75PerKeytip})),fd.IU.add("Transparency_100",Object.assign(new We,{id:"Transparency_100",ef:fd.yf("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",uk:CommonUIStrings.l_Animation100PerKeytip})),fd.IU.add("GrowShrink_Tiny",Object.assign(new We,
{id:"GrowShrink_Tiny",ef:fd.yf("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",uk:CommonUIStrings.l_AnimationTinyKeytip})),fd.IU.add("GrowShrink_Smaller",Object.assign(new We,{id:"GrowShrink_Smaller",ef:fd.yf("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",uk:CommonUIStrings.l_AnimationSmallerKeytip})),fd.IU.add("GrowShrink_Larger",Object.assign(new We,{id:"GrowShrink_Larger",ef:fd.yf("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,
value:"150",uk:CommonUIStrings.l_AnimationLargerKeytip})),fd.IU.add("GrowShrink_Huge",Object.assign(new We,{id:"GrowShrink_Huge",ef:fd.yf("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",uk:CommonUIStrings.l_AnimationHugeKeytip})));if(!fd.Ym)if(fd.Ym=new Cf.a,fd.Ym.add("Existing",Object.assign(new Uf,{effectType:-1,effectId:-1,ef:fd.yf("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,No:[],effectData:[]})),fd.Ym.add("None",Object.assign(new Uf,
{effectType:0,effectId:0,ef:fd.yf("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,No:[],effectData:[]})),fd.Ym.add("Appear",Object.assign(new Uf,{effectType:0,effectId:1,ef:fd.yf("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,No:[],effectData:[]})),fd.Ym.add("FadeIn",Object.assign(new Uf,{effectType:0,effectId:10,ef:fd.yf("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,No:[],effectData:[]})),this.YYa){fd.Ym.add("FlyIn",Object.assign(new Uf,{effectType:0,
effectId:2,ef:fd.yf("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,No:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),effectData:[]}));fd.Ym.add("Wipe",Object.assign(new Uf,{effectType:0,effectId:22,ef:fd.yf("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,No:["FromBottom","FromLeft","FromRight","FromTop"],effectData:[]}));fd.Ym.add("Zoom",Object.assign(new Uf,{effectType:0,effectId:53,ef:fd.yf("AnimFxEntranceFadedZoom"),
labelText:ResourceStrings.L_AnimationZoom,No:["ObjectCenter","SlideCenter"],effectData:[]}));fd.Ym.add("Checkerboard",Object.assign(new Uf,{effectType:0,effectId:5,ef:fd.yf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,No:["Across","Down"],effectData:[]}));fd.Ym.add("BasicZoom",Object.assign(new Uf,{effectType:0,effectId:23,ef:fd.yf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,No:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),
effectData:[]}));fd.Ym.add("Blinds",Object.assign(new Uf,{effectType:0,effectId:3,ef:fd.yf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,No:["Horizontal","Vertical"],effectData:[]}));let Z;fd.Ym.add("Box",(Z=new Uf,Z.effectType=0,Z.effectId=4,Z.ef=fd.yf("AnimFxEntranceShape"),Z.labelText=ResourceStrings.L_AnimationBox,Z.No=["In","Out"],Z.effectData=[],Z));let pa;fd.Ym.add("PeekIn",(pa=new Uf,pa.effectType=0,pa.effectId=12,pa.ef=fd.yf("AnimFxEntranceGeneric"),pa.labelText=ResourceStrings.L_AnimationPeekIn,
pa.No=["FromBottom","FromLeft","FromRight","FromTop"],pa.effectData=[],pa));let Fa;fd.Ym.add("Expand",(Fa=new Uf,Fa.effectType=0,Fa.effectId=55,Fa.ef=fd.yf("AnimFxEntranceGeneric"),Fa.labelText=ResourceStrings.L_AnimationExpand,Fa.No=[],Fa.effectData=[],Fa));let Ma;fd.Ym.add("GrowAndTurn",(Ma=new Uf,Ma.effectType=0,Ma.effectId=31,Ma.ef=fd.yf("AnimFxEntranceGrowAndTurn"),Ma.labelText=ResourceStrings.L_AnimationGrowAndTurn,Ma.No=[],Ma.effectData=[],Ma));let tb;fd.Ym.add("RandomBars",(tb=new Uf,tb.effectType=
0,tb.effectId=14,tb.ef=fd.yf("AnimFxEntranceRandomBars"),tb.labelText=ResourceStrings.L_AnimationRandomBars,tb.No=["Horizontal","Vertical"],tb.effectData=[],tb));let Hb;fd.Ym.add("RiseUp",(Hb=new Uf,Hb.effectType=0,Hb.effectId=37,Hb.ef=fd.yf("AnimFxEntranceGeneric"),Hb.labelText=ResourceStrings.L_AnimationRiseUp,Hb.No=[],Hb.effectData=[],Hb));let rc;fd.Ym.add("Split",(rc=new Uf,rc.effectType=0,rc.effectId=16,rc.ef=fd.yf("AnimFxEntranceSplit"),rc.labelText=ResourceStrings.L_AnimationSplit,rc.No=["HorizontalIn",
"HorizontalOut","VerticalIn","VerticalOut"],rc.effectData=[],rc));let yc;fd.Ym.add("Strips",(yc=new Uf,yc.effectType=0,yc.effectId=18,yc.ef=fd.yf("AnimFxEntranceGeneric"),yc.labelText=ResourceStrings.L_AnimationStrips,yc.No=["LeftDown","LeftUp","RightDown","RightUp"],yc.effectData=[],yc));let xc;fd.Ym.add("Stretch",(xc=new Uf,xc.effectType=0,xc.effectId=17,xc.ef=fd.yf("AnimFxEntranceGeneric"),xc.labelText=ResourceStrings.L_AnimationStretch,xc.No=["Across","FromBottom","FromLeft","FromRight","FromTop"],
xc.effectData=[],xc));let ld;fd.Ym.add("Exit_Disappear",(ld=new Uf,ld.effectType=1,ld.effectId=1,ld.ef=fd.yf("AnimFxExitDisappear"),ld.labelText=ResourceStrings.L_AnimationDisappear,ld.No=[],ld.effectData=[],ld));let wd;fd.Ym.add("Exit_Fade",(wd=new Uf,wd.effectType=1,wd.effectId=10,wd.ef=fd.yf("AnimFxExitFadeOut"),wd.labelText=ResourceStrings.L_AnimationFade,wd.No=[],wd.effectData=[],wd));let t;fd.Ym.add("Exit_FlyOut",(t=new Uf,t.effectType=1,t.effectId=2,t.ef=fd.yf("AnimFxExitFlyOut"),t.labelText=
ResourceStrings.L_AnimationFlyOut,t.No="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),t.effectData=[],t));let aa;fd.Ym.add("Exit_Wipe",(aa=new Uf,aa.effectType=1,aa.effectId=22,aa.ef=fd.yf("AnimFxExitWipe"),aa.labelText=ResourceStrings.L_AnimationWipe,aa.No=["FromBottom","FromLeft","FromRight","FromTop"],aa.effectData=[],aa));let ra;fd.Ym.add("Exit_Zoom",(ra=new Uf,ra.effectType=1,ra.effectId=53,ra.ef=fd.yf("AnimFxExitFadedZoom"),ra.labelText=ResourceStrings.L_AnimationZoom,
ra.No=["ObjectCenterOut","SlideCenterOut"],ra.effectData=[],ra));let Na;fd.Ym.add("Exit_Checkerboard",(Na=new Uf,Na.effectType=1,Na.effectId=5,Na.ef=fd.yf("AnimFxExitGeneric"),Na.labelText=ResourceStrings.L_AnimationCheckerboard,Na.No=["Across","Up"],Na.effectData=[],Na));let db;fd.Ym.add("Exit_BasicZoom",(db=new Uf,db.effectType=1,db.effectId=23,db.ef=fd.yf("AnimFxExitGeneric"),db.labelText=ResourceStrings.L_AnimationBasicZoom,db.No="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),db.effectData=
[],db));let kb;fd.Ym.add("Exit_Blinds",(kb=new Uf,kb.effectType=1,kb.effectId=3,kb.ef=fd.yf("AnimFxExitGeneric"),kb.labelText=ResourceStrings.L_AnimationBlinds,kb.No=["Horizontal","Vertical"],kb.effectData=[],kb));let Ib;fd.Ym.add("Exit_Box",(Ib=new Uf,Ib.effectType=1,Ib.effectId=4,Ib.ef=fd.yf("AnimFxExitShape"),Ib.labelText=ResourceStrings.L_AnimationBox,Ib.No=["In","Out"],Ib.effectData=[],Ib));let Rb;fd.Ym.add("Exit_PeekOut",(Rb=new Uf,Rb.effectType=1,Rb.effectId=12,Rb.ef=fd.yf("AnimFxExitGeneric"),
Rb.labelText=ResourceStrings.L_AnimationPeekOut,Rb.No=["ToBottom","ToLeft","ToRight","ToTop"],Rb.effectData=[],Rb));let Cb;fd.Ym.add("Exit_RandomBars",(Cb=new Uf,Cb.effectType=1,Cb.effectId=14,Cb.ef=fd.yf("AnimFxExitRandomBars"),Cb.labelText=ResourceStrings.L_AnimationRandomBars,Cb.No=["Horizontal","Vertical"],Cb.effectData=[],Cb));let cc;fd.Ym.add("Exit_Split",(cc=new Uf,cc.effectType=1,cc.effectId=16,cc.ef=fd.yf("AnimFxExitSplit"),cc.labelText=ResourceStrings.L_AnimationSplit,cc.No=["HorizontalIn",
"HorizontalOut","VerticalIn","VerticalOut"],cc.effectData=[],cc));let Fc;fd.Ym.add("Exit_Strips",(Fc=new Uf,Fc.effectType=1,Fc.effectId=18,Fc.ef=fd.yf("AnimFxExitGeneric"),Fc.labelText=ResourceStrings.L_AnimationStrips,Fc.No=["LeftDown","LeftUp","RightDown","RightUp"],Fc.effectData=[],Fc));let ed;fd.Ym.add("Exit_Stretchy",(ed=new Uf,ed.effectType=1,ed.effectId=17,ed.ef=fd.yf("AnimFxExitGeneric"),ed.labelText=ResourceStrings.L_AnimationStretchy,ed.No=[],ed.effectData=[],ed));let Td;fd.Ym.add("Exit_Zoom",
(Td=new Uf,Td.effectType=1,Td.effectId=53,Td.ef=fd.yf("AnimFxExitFadedZoom"),Td.labelText=ResourceStrings.L_AnimationZoom,Td.No=["ObjectCenterOut","SlideCenterOut"],Td.effectData=[],Td));let rf;fd.Ym.add("Emphasis_Spin",(rf=new Uf,rf.effectType=2,rf.effectId=8,rf.ef=fd.yf("AnimFxEmphasisSpin"),rf.labelText=ResourceStrings.L_AnimationSpin,rf.No=["Clockwise","CounterClockwise"],rf.effectData=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],rf));let sf;fd.Ym.add("Emphasis_Transparency",(sf=new Uf,
sf.effectType=2,sf.effectId=9,sf.ef=fd.yf("AnimFxEmphasisTransparency"),sf.labelText=ResourceStrings.L_AnimationTransparency,sf.No=[],sf.effectData=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],sf));let Hg;fd.Ym.add("Emphasis_GrowShrink",(Hg=new Uf,Hg.effectType=2,Hg.effectId=6,Hg.ef=fd.yf("AnimFxEmphasisGrowShrink"),Hg.labelText=ResourceStrings.L_AnimationGrowShrink,Hg.No=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],Hg.effectData=["GrowShrink_Tiny",
"GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],Hg));let uh;fd.Ym.add("Emphasis_FillColor",(uh=new Uf,uh.effectType=2,uh.effectId=1,uh.ef=fd.yf("AnimFxEmphasisChangeFillColor"),uh.labelText=ResourceStrings.L_AnimationFillColor,uh.No=[],uh.effectData=[],uh));let fj;fd.Ym.add("Emphasis_FontColor",(fj=new Uf,fj.effectType=2,fj.effectId=3,fj.ef=fd.yf("AnimFxEmphasisChangeFontColor"),fj.labelText=ResourceStrings.L_AnimationFontColor,fj.No=[],fj.effectData=[],fj));let Wi;fd.Ym.add("Emphasis_LineColor",
(Wi=new Uf,Wi.effectType=2,Wi.effectId=7,Wi.ef=fd.yf("AnimFxEmphasisChangeLineColor"),Wi.labelText=ResourceStrings.L_AnimationLineColor,Wi.No=[],Wi.effectData=[],Wi))}else fd.Ym.add("FlyIn",Object.assign(new Uf,{effectType:0,effectId:2,ef:fd.yf("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,No:["FromBottom","FromLeft","FromTop","FromRight"],effectData:[]}))}EAb(z,Z){let pa=null;fd.Ym.forEach((Fa,Ma)=>{Ma.effectType===z&&Ma.effectId===Z&&(pa=Ma);return!0});return pa}e2c(z,Z){let pa=
null;fd.Ym.forEach((Fa,Ma)=>{Ma.effectType===z&&Ma.effectId===Z&&(pa=Fa);return!0});return pa}C1c(z,Z,pa,Fa,Ma){const tb=Object.assign(new Bg.a,{Id:"MenuSectionEffectOptions"+pa,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});z=this.EAb(Z,z);if(!z)return tb;if((z=fd.rAj(z,pa))&&z.length)for(Z=0;Z<z.length;Z++){const Hb=fd.sAj(z[Z],pa),rc="AnimationEffectOptions"+("Direction"===pa?"Direction":"Data")+Hb.id;Array.add(tb.ControlList,Object.assign(new Ae.a,
{Command:Fa,Id:Hb.id,ExternalId:rc,QueryCommand:Ma}))}return tb}J_c(z){var Z;return(Z=fd.Ym.ga(z))?(z=Z.effectType,Z=Z.effectId,{returnValue:!0,effectType:z,effectId:Z}):{returnValue:!1,effectType:-1,effectId:-1}}K_c(z){let Z,pa;Z=fd.yf("AnimFxMultiple");pa=ResourceStrings.L_AnimationExisting;if(z=fd.Ym.ga(z))Z=z.ef,pa=z.labelText;return{image:Z,label:pa}}T6c(z,Z){if(0===z){if(0!==Z&&1!==Z&&2!==Z&&10!==Z)return!0}else if(0<z)return!0;return!1}web(z,Z){return z&&Z?this.YYa?(Z=Z.leb()?z.IsTrigger:z.HasTrigger,
!!this.EAb(z.EffectType,z.EffectId)&&!Z):!z.HasExisting:!0}N8c(z){return z?this.SDb(Array(z)):!0}SDb(z){if(!z||!z.length)return!0;for(const Z of z)if(null==this.EAb(Z.EffectType,Z.EffectId))return!1;return!0}wwe(z,Z){return Z&&z&&this.YYa?Z.leb()?!1:z.HasMultiple:!1}Dec(z){if(!z||!z.length)return!1;const Z=z[0].EffectId,pa=z[0].EffectType;for(let Fa=1;Fa<z.length;Fa++){const Ma=z[Fa];if(Ma.EffectId!=Z||Ma.EffectType!=pa)return!0}return!1}xAg(z){if(z&&this.YYa&&2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}xye(z){if(!z)return!1;
if(2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}czj(z){z=fd.Ym.ga(z);return this.eac(z.No[0])}$yj(z){return(z=fd.Ym.ga(z))&&z.effectData.length?this.ghe(z.effectData[0]):""}eac(z){switch(z){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;
case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;
case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;default:return 0}}ghe(z){return(z=fd.IU.ga(z))?z.value:""}aZf(z,Z){return(Z=fd.IU.ga(Z))&&parseFloat(z)===parseFloat(Z.value)?!0:!1}rke(z){switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;
case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}yPi(z){if(null===z)throw Error.argumentNull("animation");const Z=this.EAb(z.EffectType,z.EffectId);return!!Z&&(0<Z.No.length||0<Z.effectData.length||this.xAg(z))}zPi(z){if(!z)return!1;const Z=this.EAb(z.EffectType,z.EffectId);return!!Z&&(0<Z.No.length||0<Z.effectData.length||this.xye(z))}APi(z,Z,pa){return this.web(pa,z)&&!this.wwe(pa,z)&&(this.yPi(pa)||this.uUf(z,Z,pa)||this.G3d(z,Z,pa)||this.sUf(z,Z,pa)||this.H3d(z,pa))}BPi(z,
Z,pa){if(!(z&&Z&&pa&&pa.length&&this.SDb(pa)))return!1;z=fd.n0f(z,pa);Z=this.vUf(Z,z)||this.xUf(Z,z)||this.tUf(Z,z)||this.zUf(z);let Fa;this.Dec(pa)||(Fa=this.zPi(pa[0]));return Fa||Z}zJj(z,Z,pa){const Fa=Object.assign(new Bg.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});this.uUf(z,Z,pa)&&Array.add(Fa.ControlList,Object.assign(new Ae.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",
QueryCommand:"1125291975"}));this.sUf(z,Z,pa)&&this.YYa&&Array.add(Fa.ControlList,Object.assign(new Ae.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.G3d(z,Z,pa)&&Array.add(Fa.ControlList,Object.assign(new Ae.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.H3d(z,pa)&&Array.add(Fa.ControlList,Object.assign(new Ae.a,{Command:"1486892994",Id:"OneByOne",
ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return Fa}AJj(z,Z,pa){const Fa=new Bg.a;Fa.Id="MenuSectionEffectOptionsSequence";Fa.ControlsId="MenuSectionEffectOptionsSequence.Controls";Fa.DisplayMode="Menu32";Fa.ControlList=[];if(!(z&&z.length&&Z&&pa&&pa.length))return Fa;z=fd.n0f(z,pa);this.vUf(Z,z)&&(pa=new Ae.a,pa.Command="1850236812",pa.Id="AsOneObject",pa.ExternalId="AnimationEffectOptionsSequenceAsOneObject",pa.QueryCommand="1125291975",Fa.ControlList.push(pa));
this.tUf(Z,z)&&(pa=new Ae.a,pa.Command="2048458448",pa.Id="AllAtOnce",pa.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",pa.QueryCommand="1125291975",Fa.ControlList.push(pa));this.xUf(Z,z)&&(Z=new Ae.a,Z.Command="3467781846",Z.Id="ByParagraph",Z.ExternalId="AnimationEffectOptionsSequenceByParagraph",Z.QueryCommand="1125291975",Fa.ControlList.push(Z));this.zUf(z)&&(Z=new Ae.a,Z.Command="1486892994",Z.Id="OneByOne",Z.ExternalId="AnimationEffectOptionsSequenceOneByOne",Z.QueryCommand="1125291975",
Fa.ControlList.push(Z));return Fa}zpk(z){let Z=!0,pa=0;if(!z)return!1;for(const Fa of z)if(Z)pa=Fa.EffectId,Z=!1;else if(Fa.EffectId!==pa)return!1;return!0}WFj(z,Z,pa){const Fa={isEnabled:!1,Gud:null};if(!z||!Z||!Z.length)return Fa;for(var Ma of Z)if(Ma.IsTrigger)return Fa;z=fd.eFj(z);if(!z.length||fd.Zdk(z,Z))return Fa;Ma=z.map(tb=>tb.EffectNodeId);Z=Z.map(tb=>tb.EffectNodeId).sort((tb,Hb)=>tb-Hb);if(!fd.Opk(Z,Ma))return Fa;if(pa){pa=Ma.indexOf(Z[Z.length-1]);if(-1==pa||pa==Ma.length-1)return Fa;
Fa.isEnabled=!0;Fa.Gud=fd.Hpg(z[pa+1])}else{pa=Ma.indexOf(Z[0]);if(-1==pa||0==pa)return Fa;Fa.isEnabled=!0;Fa.Gud=fd.Hpg(z[pa-1])}return Fa}ILj(z){const Z=[];if(!z||!z.animations||!z.animations.Sequences)return Z;let pa=0;for(const Fa of z.animations.Sequences)Fa.Effects&&(Z.push({isTriggerSequence:Fa.IsTriggerSeq,sequenceIndex:Fa.SequenceIndex,description:Fa.Description,animationCount:Fa.Effects.length,sequenceStartIndex:pa}),pa+=Fa.Effects.length);return Z}aBj(z,Z){const pa=[];if(!z||!z.length)return pa;
const Fa=new Map;if(Pf.a("DisableControlsInAnimationCardBasedOnShapeType")){if(null===Z||void 0===Z||!Z.length)return pa;Z.forEach(rc=>{Fa.set(rc.id.toString(),rc)})}Z=new Map;for(var Ma of z.filter(rc=>!rc.IsTrigger&&-1!==rc.GroupId)){var tb=`${Ma.ShapeId}${","}${Ma.GroupId}`;if(Z.has(tb)){var Hb=Z.get(tb);Z.set(tb,Hb+1)}else Z.set(tb,1)}Ma=new Set;for(const rc of z)z=fd.e3i(rc),Pf.a("DisableControlsInAnimationCardBasedOnShapeType")&&(tb=Fa.get(rc.ShapeId),this.EPl(z,tb)),rc.IsTrigger||(-1===rc.GroupId?
z.IsGroupAnimation=0<Ma.size:(z.IsGroupAnimation=!0,tb=`${rc.ShapeId}${","}${rc.GroupId}`,0===Ma.size&&(z.IsFirstGroupAnimation=!0),Ma.has(tb)||Ma.add(tb),Hb=Z.get(tb),Hb--,Z.set(tb,Hb),0===Hb&&Ma.delete(tb),0===Ma.size&&(z.IsLastGroupAnimation=!0)),z.IsDraggable=!z.IsGroupAnimation||z.IsFirstGroupAnimation&&z.IsLastGroupAnimation),pa.push(z);return pa}EPl(z,Z){const pa=this.EAb(z.EffectType,z.EffectId);fd.qFg([Z])&&!pa?z.DisabledAnimationControls.push(0):fd.xxe([Z])&&!pa&&(z.DisabledAnimationControls.push(1),
z.DisabledAnimationControls.push(2))}static e3i(z){return Object.assign(Object.assign({},z),{IsDraggable:!1,IsFirstGroupAnimation:!1,IsGroupAnimation:!1,IsLastGroupAnimation:!1,DisabledAnimationControls:[]})}static n0f(z,Z){const pa=new Map;for(const Fa of z)pa.set(Fa.id.toString(),Fa);z=new Map;for(const Fa of Z)Z=Fg.a.Tf(Fa.ShapeId),Z=pa.get(Z.toString()),z.set(Fa,Z);return z}static Hpg(z){const Z=new ig;Z.EffectNodeId=z.EffectNodeId;Z.ShapeId=z.ShapeId;return Z}static Opk(z,Z){if(!(z&&z.length&&
Z&&Z.length)||z.length>Z.length)return!1;const pa=z[z.length-1],Fa=Z.indexOf(z[0]);return Z.indexOf(pa)-Fa+1==z.length}static eFj(z){const Z=[];if(!z)return Z;z=z.animations;if(!z||!z.Sequences)return Z;for(const pa of z.Sequences[0].Effects)Z.push(pa);return Z.sort((pa,Fa)=>pa.EffectNodeId-Fa.EffectNodeId)}static Zdk(z,Z){if(!z||!Z)return!1;const pa=new Map;for(const Fa of z.filter(Ma=>-1!==Ma.GroupId))if(z=`${Fa.ShapeId}${","}${Fa.GroupId}`,pa.has(z)){const Ma=pa.get(z);pa.set(z,Ma+1)}else pa.set(z,
1);for(const Fa of Z.filter(Ma=>-1!==Ma.GroupId))if(Z=`${Fa.ShapeId}${","}${Fa.GroupId}`,pa.has(Z)&&1<pa.get(Z))return!0;return!1}uUf(z,Z,pa){return 0!==pa.SequenceId&&0!==pa.EffectId&&this.web(pa,z)&&(z.ig||2!==pa.EffectType||1!==pa.EffectId&&7!==pa.EffectId)&&(z.z1||this.H3d(z,pa)||this.G3d(z,Z,pa))}DPi(z,Z,pa){return z&&0!==pa.BuildType&&0!==pa.EffectId&&this.N8c(pa)&&(z.ig||2!==pa.EffectType||1!==pa.EffectId&&7!==pa.EffectId)&&(z.z1||this.yUf(z,pa)||this.wUf(z,Z,pa))}vUf(z,Z){for(const [pa,Fa]of Z)if(!this.DPi(Fa,
z,pa))return!1;return!0}sUf(z,Z,pa){return 0!==pa.SequenceId&&!z.z1&&!z.vd&&0!==pa.EffectId&&this.web(pa,z)&&(z.ig||2!==pa.EffectType||1!==pa.EffectId&&7!==pa.EffectId)&&(z.Sk||z.ig||z.isEditable&&0<Z.u$(z).length)}CPi(z,Z,pa){return z&&0!==pa.BuildType&&!z.z1&&!z.vd&&0!==pa.EffectId&&this.N8c(pa)&&(z.ig||2!==pa.EffectType||1!==pa.EffectId&&7!==pa.EffectId)&&(z.Sk||z.ig||z.isEditable&&0<Z.u$(z).length)}tUf(z,Z){for(const [pa,Fa]of Z)if(!this.CPi(Fa,z,pa))return!1;return!0}G3d(z,Z,pa){return 0!==pa.SequenceId&&
!z.ig&&!z.z1&&!z.vd&&0!==pa.EffectId&&this.web(pa,z)&&(2!==pa.EffectType||1!==pa.EffectId&&7!==pa.EffectId)&&(z.Sk||z.isEditable&&0<Z.u$(z).length)}wUf(z,Z,pa){return z&&0!==pa.BuildType&&!z.ig&&!z.z1&&!z.vd&&0!==pa.EffectId&&this.N8c(pa)&&(2!==pa.EffectType||1!==pa.EffectId&&7!==pa.EffectId)&&(z.Sk||z.isEditable&&0<Z.u$(z).length)}xUf(z,Z){for(const [pa,Fa]of Z)if(!this.wUf(Fa,z,pa))return!1;return!0}H3d(z,Z){return 0!==Z.SequenceId&&z.ig&&0!==Z.EffectId&&this.web(Z,z)}yUf(z,Z){return z&&0!==Z.BuildType&&
z.ig&&0!==Z.EffectId&&this.N8c(Z)}zUf(z){for(const [Z,pa]of z)if(!this.yUf(pa,Z))return!1;return!0}static yf(z){return ne.a.Fsc+"_"+z+"_32x32x32"}static rAj(z,Z){switch(Z){case "Direction":return z.No;case "EffectData":return z.effectData;default:return null}}static sAj(z,Z){switch(Z){case "Direction":return fd.nm.ga(z);case "EffectData":return fd.IU.ga(z);default:return null}}}fd.nm=null;fd.IU=null;fd.Ym=null;fd.qFg=z=>{if(!z||0==z.length)return!1;for(const Z of z)if(Z.F5)return!0;return!1};fd.xxe=
z=>{if(!z||0==z.length)return!1;for(const Z of z)if(1===Z.mediaType||2===Z.mediaType)return!0;return!1};Object(k.a)(fd,"AnimationHelper",null,[1110]);const ui=(Mc.a.Tx&65535^Mc.a.Tx>>>16)<<16,bj="SetAnimation SetAnimationDuration SetAnimationDelay AnimationStart MoveAnimationEarlier MoveAnimationLater SetAnimationColorEffect SetAnimationDirection SetAnimationEffectData SetAnimationSequenceAllAtOnce SetAnimationSequenceAsOneObject SetAnimationSequenceByParagraph SetAnimationSequenceOneByOne SetAnimationColor".split(" ");
class nf{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd,t,aa,ra,Na,db){this.U7="Existing";this.WNa="ExistingInMenu";this.mbf="AnimationExisting";this.nbf="AnimationExistingInMenu";this.c2=!1;this.E1a=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;Ib=this.oa.Pk();if(!Ib||!kb||!kb.length)return 8;if(1===Rb)return 32;Rb=this.Cma(kb,Ib);cc.MenuItems=this.OJi(kb,Ib,Rb);return 32};this.jqa=(kb,Ib,Rb,Cb,cc)=>{kb=cc.queryResult;cc=cc.SourceControlId;Cb=Ib=-1;cc!==this.U7&&({effectType:Cb,effectId:Ib}=this.Uk.J_c(cc));var Fc=
this.vk.Iy;if(!this.oa.Pk())return 8;if(1!==Rb)return 32;Rb=this.Uk.K_c(cc);var ed=Rb.label;if(cc===this.U7||cc===this.WNa)ed=ResourceStrings.L_ExistingButtonDescription;this.Pbb(cc,Rb.image,Rb.label,kb,ed);let Td=ed=!1;const rf=0==Fc.length?0:Fc[0].EffectId,sf=0==Fc.length?0:Fc[0].EffectType,Hg=!this.Uk.SDb(Fc);Fc=this.Uk.Dec(Fc);Hg||Fc||(ed=Ib===rf&&Cb===sf,Td=this.Uk.T6c(sf,rf));cc===this.U7?(Td=this.ynl(this.U7,kb,Fc,Td,Hg,Rb.image,sf,rf),kb.sW(Hg||Fc||Td)):cc===this.WNa?(Td=nf.wnl(kb,Fc,Hg,Td),
kb.sW(Hg||Fc||Td)):kb.sW(ed);return 32};this.Tx=(kb,Ib,Rb,Cb,cc)=>{Ib=this.vk.Iy;var Fc=this.oa.Pk();let ed=!0;var Td=this.getSelectedShapes();if(!Td||!Td.length)if(ed=!1,Td=this.Cma(Ib,Fc),!Td||!Td.length)return Pf.a("StopFalseLoggingSetAnimation")||Qc.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;Pf.a("FixAddAnimationCrashForGroupedShape")&&(Td=this.Cig(Td));if(!nf.Rpk(Fc,Td)||this.rwa(Td))return 8;if(1===Rb)return Cb=0<Ib.length&&!this.Uk.SDb(Ib),Fc=fd.qFg(Td),
Cb&&Fc?8:kb===Mc.a.SQb||kb===Mc.a.j3a?(Td=0<Ib.length&&this.Uk.Dec(Ib),Fc=!1,Cb||Td||(Fc=this.Uk.T6c(0<Ib.length?Ib[0].EffectType:-1,0<Ib.length?Ib[0].EffectId:-1)),kb===Mc.a.j3a&&(Fc=Cb?!0:!1),Cb||Td||Fc?32:16):kb===Mc.a.PQb?nf.Qpk(Td)?32:16:32;kb=cc.SourceControlId;if(!kb)return 8;if(kb===this.U7||kb===this.WNa||kb===this.mbf||kb===this.nbf)return 32;kb=this.Uk.J_c(kb);(Ib=nf.suj(Td,kb.effectId,kb.effectType,ed,Ib))&&this.OU(Fc,Ib,!0);Cb&&(Cb.ED=kb.effectId,Cb.MO=kb.effectType+100);return 32};this.Thh=
(kb,Ib,Rb)=>{const Cb=this.vk.Iy;Ib=this.oa.Pk();if(!Ib||!Cb||!Cb.length)return 8;var cc=this.Cma(Cb,Ib);if(!cc||!cc.length)return Qc.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),8;if(this.rwa(cc))return 8;switch(kb){case Mc.a.Ypc:kb=!1;break;case Mc.a.Zpc:kb=!0;break;default:return 8}cc=this.Uk.WFj(Ib,Cb,kb);if(1===Rb)return cc.isEnabled?32:8;if(!cc.Gud)return Qc.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),
8;Rb=nf.$0(Cb);Rb=nf.l8d(Rb,cc.Gud,kb);this.OU(Ib,Rb,!0);return 32};this.rAa=(kb,Ib,Rb,Cb,cc)=>{Ib=this.vk.Iy;kb=this.oa.Pk();if(!kb||!Ib||!Ib.length)return 8;var Fc=this.Cma(Ib,kb);if(!Fc||!Fc.length)return Qc.a.J(509677842,800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.rwa(Fc))return 8;if(1===Rb)return 32;Rb=bf.Box4ColorHelper.uT(cc);if(!Rb)return Qc.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;Rb=bf.Box4ColorHelper.Rmb(Rb,kb.Ld);
if(!Rb)return Qc.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;cc=new wg.a;cc.AnimationAction=1;Fc=new $g;Fc.TargetEffects=nf.$0(Ib);Fc.ModifyAnimPropType=3;Ib=new Ig;Ib.Color=[Rb.r,Rb.g,Rb.b];Ib.EffectDataPropType=1;Fc.EffectData=Ib;cc.ModifyAnimationInfo=Fc;this.OU(kb,cc,!0);Cb&&(Cb.MO=1);return 32};this.A_e=()=>{const kb=this.vk.Iy;var Ib=this.oa.Pk();if(!Ib||!kb||!kb.length)return 8;Ib=this.Cma(kb,Ib);return Ib&&Ib.length?this.Uk.BPi(Ib,this.Ga,kb)?32:16:(Qc.a.J(509677839,
800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.h3a=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;Ib=this.oa.Pk();if(!Ib||!kb||!kb.length)return 8;var Fc=this.Cma(kb,Ib);if(!Fc||!Fc.length)return Qc.a.J(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.rwa(Fc))return 8;if(1===Rb)return 32;Rb=this.Uk.eac(cc.MenuItemId);cc=new wg.a;cc.AnimationAction=1;Fc=new $g;Fc.TargetEffects=nf.$0(kb);Fc.ModifyAnimPropType=2;Fc.Direction=Rb;
cc.ModifyAnimationInfo=Fc;this.OU(Ib,cc,!0);Cb&&(Cb.MO=1);return 32};this.W1a=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;if(!this.oa.Pk()||!kb||!kb.length)return 8;Ib=cc.queryResult;cc=this.Uk.eac(cc.MenuItemId);nf.Ydk(kb)&&Ib.Rf(kb[0].Direction===cc);return 32};this.rNa=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;Ib=this.oa.Pk();if(!Ib||!kb||!kb.length)return 8;var Fc=this.Cma(kb,Ib);if(!Fc||!Fc.length)return Qc.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.rwa(Fc))return 8;
if(1===Rb)return 32;Rb=cc.MenuItemId;cc=new wg.a;cc.AnimationAction=5;Fc=new ff;Fc.TargetEffects=nf.$0(kb);Fc.BuildType=nf.wvj(Rb);cc.ChangeAnimationBuildTypeInfo=Fc;this.OU(Ib,cc,!0);Cb&&(Cb.MO=1);return 32};this.kqa=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;if(!this.oa.Pk()||!kb||!kb.length)return 8;Ib=cc.queryResult;cc=this.Uk.rke(cc.MenuItemId);nf.Wdk(kb)&&Ib.Rf(kb[0].BuildType===cc);return 32};this.i3a=(kb,Ib,Rb,Cb,cc)=>{Ib=this.vk.Iy;kb=this.oa.Pk();if(!kb||!Ib||!Ib.length)return 8;var Fc=this.Cma(Ib,
kb);if(!Fc||!Fc.length)return Qc.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.rwa(Fc))return 8;if(1===Rb)return 32;Fc=cc.MenuItemId;Rb=new wg.a;Rb.AnimationAction=1;cc=new $g;cc.TargetEffects=nf.$0(Ib);cc.ModifyAnimPropType=3;Ib=this.pAj(Fc);if(!Ib)return Qc.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;cc.EffectData=Ib;Rb.ModifyAnimationInfo=cc;this.OU(kb,Rb,!0);Cb&&(Cb.MO=1);return 32};this.X1a=
(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;if(!this.oa.Pk()||!kb||!kb.length)return 8;cc.queryResult.Rf(this.Uk.aZf(nf.qAj(kb[0].EffectData),cc.MenuItemId));return 32};this.pOl=(kb,Ib,Rb,Cb,cc)=>{Ib=this.vk.Iy;kb=this.oa.Pk();if(!kb||!Ib||!Ib.length)return 8;Cb=this.Cma(Ib,kb);if(!Cb||!Cb.length)return Qc.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.rwa(Cb))return 8;if(1===Rb)return 32;Rb=cc.CommandValueId;if(!Rb||!Rb.trim().length)return Qc.a.J(509703438,
800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;Rb=nf.HNj(Rb);if(3==Rb)return Qc.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;for(var Fc of Ib)Fc.StartType=Rb;Fc=nf.$0(Ib);Fc=nf.w0f(Fc,Rb);this.OU(kb,Fc,!1);return 32};this.eOb=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;if(!this.oa.Pk()||!kb||!kb.length)return nf.r7e(cc,3),32;Ib=kb[0].StartType;Rb=!0;for(const Fc of kb)if(Ib!=Fc.StartType){Rb=!1;break}Rb?nf.r7e(cc,
Ib):nf.r7e(cc,3);return 32};this.oOl=(kb,Ib,Rb,Cb,cc)=>{kb=this.oa.Pk();Ib=this.vk.Iy;if(!kb||!Ib||!Ib.length)return 8;Cb=this.Cma(Ib,kb);if(!Cb||!Cb.length)return Qc.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.rwa(Cb))return 8;const Fc=!this.Uk.SDb(Ib);if(fd.xxe(Cb)&&Fc)return 8;if(1===Rb)return 32;(Rb=Math.floor(1E3*cc.Number))||(Rb=10);for(var ed of Ib)ed.Duration=Rb;ed=nf.$0(Ib);ed=nf.ETc(ed,1,Rb);this.OU(kb,ed,!1);return 32};this.zMa=
(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;if(!this.oa.Pk()||!kb||!kb.length)return this.TQb(cc,"0.00"),32;Ib=kb[0].Duration;Rb=!0;for(const Fc of kb)if(Ib!=Fc.Duration){Rb=!1;break}Rb?this.TQb(cc,Number(Ib/1E3).toFixed(2)):this.TQb(cc,"0.01");return 32};this.Gsi=(kb,Ib,Rb)=>{if(!this.oa.Pk())return 8;kb=this.getSelectedShapes();if(!kb||1!==kb.length)return Qc.a.J(508687070,800,10,"AnimationActor::addAnimationInContextMenuHandler: selected shape count is not 1"),8;if(this.rwa(kb))return 8;if(1===Rb)return 32;
this.nv.selectRibbonTabById("AnimationsTab");this.c2||(this.aSb(!1),this.c2=!0);Rb=this.vk.Iy;(null===Rb||void 0===Rb?0:Rb.length)||this.zme();return 32};this.o_j=(kb,Ib,Rb)=>1==Rb?32:Zf.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.c2.toString(),kb,()=>{(this.c2=!this.c2)?this.aSb(!1):this.$ne();return 32});this.Ztc=(kb,Ib,Rb,Cb,cc)=>{cc&&cc.Rf(this.c2);return 32};this.aSb=kb=>{const Ib=this.SA();var Rb=Object(ib.a)(this,this.RTj,"applyAnimationAction");Ib.onAnimationAction=Rb;Rb=
Object(ib.a)(this,this.TTj,"handleAnimationSelectionChangeFromPane");Ib.onSelectionChange=Rb;Rb=this.getSelectedShapes();Ib.isAddAnimationButtonDisabled=!Rb||!Rb.length;if(Rb=Pf.a("FixAnimationRibbonBugs")?this.vk.$u:this.oa.Pk()){Ib.isZeroStateAnimationPane=!Rb.XGa;var Cb=Rb.yj(),cc=Rb.DZc(Cb).sort((ed,Td)=>ed.EffectNodeId-Td.EffectNodeId);Ib.animations=this.Uk.aBj(cc,Cb);Ib.selectedAnimationNodeIds=this.vk.Iy.map(ed=>ed.EffectNodeId);Ib.sequencesInfo=this.Uk.ILj(Rb);var Fc={title:ResourceStrings.L_AnimationGalleryGroup,
hideHeader:!1,width:Ib.paneWidth,location:2,contentProps:Ib,onOpen:()=>{},onClose:()=>{this.c2=!1},isModernPane:!0};oj.UISurfaces.qr().then(ed=>{kb?this.c2&&ed.updateTaskPane(cd.a.HSa,Fc):ed.showTaskPane(cd.a.HSa,Fc);return null}).catch(ed=>{Qc.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",ed.toString())})}else Qc.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.onSelectionChange=()=>{if(this.vk&&this.vk.ZM){var kb=this.vk.$u;kb?(kb=
kb.yj())&&kb.length&&(this.vk.C3h(),this.c2&&this.vk.xlc&&this.aSb(!0)):Qc.a.J(509145116,800,10,"AnimationActor::onSelectionChange: current active slide is null")}};this.onActiveSlideDomReady=(kb,Ib)=>{Ib&&this.vk&&((kb=this.vk.$u)?(Ib=Object(w.a)(205,Ib.Aa))&&kb.Fb!==Ib.Fb&&(this.vk.dkm(Ib),this.c2&&this.aSb(!0)):Qc.a.J(509145115,800,10,"AnimationActor::onActiveSlideDomReady: current active slide is null"))};this.hza=(kb,Ib)=>{const Rb=this.sa.Aa;Rb&&Rb.nP&&(kb=this.vk.$u)&&Rb===kb&&(Ib=Ib.Vx)&&
Ib.shapeNode&&this.eIa(kb.Fb,Ib.shapeNode)&&this.vk.Nza(this.vk.ZM)};this.Mha=(kb,Ib)=>{Ib&&this.vk&&(this.vk.ckm(Ib.zha),this.c2&&(this.vk.ZM||this.$ne()))};this.ph=(kb,Ib)=>{if(Ib&&Ib.property===Md.a.V_d&&this.vk&&this.vk.ZM){kb=!1;if(Pf.a("FixAnimationSelectionCachingIssue"))for(var Rb of bj){const Cb=vg.a.WJj(Rb);if(Cb&&0<Cb.length){kb=!0;break}}Rb=this.vk.$u;Rb?this.nc.ug(Ib.node)===Rb&&(this.vk.ARb(!1),this.vk.bkm(kb),this.vk.ARb(!0),this.c2&&this.aSb(!0)):Qc.a.J(509145114,800,10,"AnimationActor::onPropertyChanged: current active slide is null")}};
this.RTj=kb=>{if(Pf.a("FixAnimationPaneActionContextNullIssue")){const Ib=vg.a.Zj("SetAnimation",1);Ib.gq=!0;switch(kb.actionType){case 0:vg.a.gz(Ib,()=>{this.zme()});break;case 2:vg.a.gz(Ib,()=>{this.ktg(kb)});break;case 1:vg.a.gz(Ib,()=>{this.jsg(kb)});break;case 3:this.Osg(kb);break;case 4:Ib.actionName="AnimationStart";vg.a.gz(Ib,()=>{this.$rg(kb)});break;case 5:break;case 6:this.jtg(kb);break;default:Qc.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}}else switch(kb.actionType){case 0:this.zme();
break;case 2:this.ktg(kb);break;case 1:this.jsg(kb);break;case 3:this.Osg(kb);break;case 4:this.$rg(kb);break;case 5:break;case 6:this.jtg(kb);break;default:Qc.a.J(508829901,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};this.TTj=kb=>{const Ib=this.oa.Pk();Ib&&kb?(this.vk.ARb(!1),this.vk.Kea(),this.vk.tZd(kb,Ib),this.vk.ARb(!0)):Qc.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.TAe=
(kb,Ib,Rb)=>{kb=[Object.assign(new Ye.a,{name:"CustomData1",int64:ui+kb}),Object.assign(new Ye.a,{name:"CustomData2",int64:ui+Ib+100})];he.d(Mc.a.Tx,!0,void 0,0,30,Rb,kb)};this.zme=()=>{var kb=Date.now(),Ib=this.getSelectedShapes();const Rb=this.oa.Pk();if(Rb&&Ib&&Ib.length){if(Pf.a("FixAddAnimationCrashForGroupedShape")){const Cb=this.Cig(Ib);Ib.length=0;Ib.push(...Cb)}if(Ib=nf.Kfg(Ib,10,0,!1))this.OU(Rb,Ib,!0),this.XZa&&(kb=Date.now()-kb,this.TAe(10,0,kb))}else Qc.a.J(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};
this.ktg=kb=>{var Ib=Date.now();if(kb&&kb.replaceAnimationInfo){var Rb=kb.replaceAnimationInfo.effectId;kb=kb.replaceAnimationInfo.effectType;var Cb=this.vk.Iy,cc=this.oa.Pk();if(cc&&Cb&&Cb.length){if(Cb=nf.xng(Cb,Rb,kb))this.OU(cc,Cb,!0),this.XZa&&(Ib=Date.now()-Ib,this.TAe(Rb,kb,Ib))}else Qc.a.J(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else Qc.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};this.jsg=
kb=>{var Ib=Date.now();if(kb&&kb.deleteAnimationInfo){var Rb=this.oa.Pk();kb=kb.deleteAnimationInfo.animationIds;Rb&&kb&&kb.length?(kb=nf.bPj(kb),kb=nf.I0f(kb),this.OU(Rb,kb,!0),this.XZa&&(Ib=Date.now()-Ib,this.TAe(0,0,Ib))):Qc.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else Qc.a.J(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.SA=()=>({type:"AnimationPaneProps",paneWidth:aj.a,isPreviewAnimationButtonDisabled:!0});
this.Qgm=()=>{if(this.c2)return this.aSb(!0),32};this.$ne=()=>{oj.UISurfaces.qr().then(kb=>{kb.hideTaskPane(cd.a.HSa,2);return null}).catch(kb=>{Qc.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",kb.toString())})};this.nOl=(kb,Ib,Rb,Cb,cc)=>{Ib=this.vk.Iy;kb=this.oa.Pk();if(!kb||!Ib||!Ib.length)return 8;Cb=this.Cma(Ib,kb);if(!Cb||!Cb.length)return Qc.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.rwa(Cb))return 8;const Fc=
!this.Uk.SDb(Ib);if(fd.xxe(Cb)&&Fc)return 8;if(1===Rb)return 32;Rb=Math.floor(1E3*cc.Number);for(var ed of Ib)ed.Delay=Rb;ed=nf.$0(Ib);ed=nf.ETc(ed,0,Rb);this.OU(kb,ed,!1);return 32};this.yMa=(kb,Ib,Rb,Cb,cc)=>{kb=this.vk.Iy;if(!this.oa.Pk()||!kb||!kb.length)return this.TQb(cc,"0.00"),32;Ib=kb[0].Delay;Rb=!0;for(const Fc of kb)if(Ib!=Fc.Delay){Rb=!1;break}Rb?this.TQb(cc,Number(Ib/1E3).toFixed(2)):this.TQb(cc,"0.00");return 32};this.OJi=(kb,Ib,Rb)=>{var Cb;const cc=new Me.a;cc.Id="AnimationMenuEffectOptions";
cc.UpdateDynamically=!0;cc.Title=ResourceStrings.L_EffectOptions;cc.MenuSectionList=[];if(!this.Uk.Dec(kb)){const Fc=kb[0];cc.MenuSectionList.push(this.Uk.C1c(Fc.EffectId,Fc.EffectType,"Direction","2289594085","3782857737"));if(this.Uk.xye(Fc))if(cc.MenuSectionList.push(te.f(Ib.Ld,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),cc.MenuSectionList.push(te.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker",
"679168237",!1)),this.Xdk(kb)){const ed=null===(Cb=Fc.EffectData)||void 0===Cb?void 0:Cb.Color;Cb=new Ag.a(Ag.a.qHh(ed));te.h(cc,Cb,Ib.Ld)}else te.h(cc,null,Ib.Ld);cc.MenuSectionList.push(this.Uk.C1c(Fc.EffectId,Fc.EffectType,"EffectData","2949363495","4132852551"))}cc.MenuSectionList.push(this.Uk.AJj(Rb,this.Ga,kb));return cc};this.pAj=kb=>{const Ib=new Ig,Rb=this.Uk.ghe(kb);return kb.toLowerCase().startsWith("spin")?(Ib.Degree=parseFloat(Rb),Ib.EffectDataPropType=0,Ib):kb.toLowerCase().startsWith("transparency")?
(Ib.Transparency=parseFloat(Rb),Ib.EffectDataPropType=2,Ib):kb.toLowerCase().startsWith("growshrink")?(Ib.Scale=parseFloat(Rb),Ib.EffectDataPropType=3,Ib):null};this.ynl=(kb,Ib,Rb,Cb,cc,Fc,ed,Td)=>{if(cc)return!1;if(Rb)return this.Pbb(kb,Fc,ResourceStrings.L_AnimationMultiple,Ib,ResourceStrings.L_AnimationMultiple),Cb;Cb&&(Fc=this.Uk.e2c(ed,Td),{image:Fc,label:Rb}=this.Uk.K_c(Fc),this.Pbb(kb,Fc,Rb,Ib,Rb));return Cb};this.Pbb=(kb,Ib,Rb,Cb,cc)=>{let Fc;Fc=kb===this.U7?"298832323":kb===this.WNa?"1264919631":
"2676673376";Ib=Ib.substring((ne.a.Fsc+"_").length,Ib.length-6);const ed=new we.a;ed.Id=kb;ed.ExternalId="Animation"+kb;ed.Icon=Ib;ed.Command=Fc;ed.QueryCommand="1852964326";ed.LabelText=Rb;ed.FullIconStyle={root:{width:"32px",height:"32px"}};ed.PreviewIconStyle={root:{width:"24px",height:"24px"}};ed.Alt=cc;Cb.k5=ed};this.getSelectedShapes=()=>{const kb=[],Ib=this.oa.Hd();if(!Ib)return kb;for(const Rb of Ib)Rb.get_smartArtModelId()?kb.push(this.Ga.Hs(Rb)):Rb.Rg?kb.push(this.Ga.zt(Rb)):kb.push(Rb);
return kb};this.Cma=(kb,Ib)=>{const Rb=[];if(!kb||!kb.length||!Ib)return Rb;const Cb=Ib.yj();if(!Cb||!Cb.length)return Rb;Ib=new Map;for(const cc of Cb)Ib.set(cc.id.toString(),cc);for(const cc of kb){kb=Fg.a.Tf(cc.ShapeId);kb=Ib.get(kb.toString());if(!kb)return[];Rb.push(kb)}return Rb};this.OU=(kb,Ib,Rb)=>{vg.a.Xk("AnimationCommandType",String(Ib.AnimationAction));const Cb=this.Eb.ud(15,void 0,()=>{this.oa.uj();Rb&&this.Fa.Gd()});try{Cb.mc(kb),kb.Ata=Ib}finally{Cb&&Cb.dispose()}};this.rwa=kb=>{if(!kb||
0==kb.length)return!1;for(const Ib of kb)if(this.ic.Xc(Ib))return!0;return!1};this.TQb=(kb,Ib)=>{kb.queryResult.uca=Ib};if(!z)throw Error.argumentNull("actionManager");if(!Z)throw Error.argumentNull("selectionManager");if(!pa)throw Error.argumentNull("focusManager");if(!Fa)throw Error.argumentNull("transactionFactory");if(!Ma)throw Error.argumentNull("animationHelper");if(!tb)throw Error.argumentNull("graphActionBlockingManager");if(!Hb)throw Error.argumentNull("shapeReader");if(!rc)throw Error.argumentNull("pathManager");
if(!yc)throw Error.argumentNull("effectSelectionManager");if(!xc)throw Error.argumentNull("viewElementEventHandler");if(!ld)throw Error.argumentNull("graphNodeEventHandlers");if(!wd)throw Error.argumentNull("viewEventNotifier");if(!t)throw Error.argumentNull("slideReader");if(!aa)throw Error.argumentNull("graphTopologyManager");if(Na){if(!ra)throw Error.argumentNull("ribbonUser");this.nv=ra;this.QKk=Na}if(Pf.a("FixAnimationPaneVisibilityInViewMode")){if(!db)throw Error.argumentNull("appFrame");this.Db=
db}this.ia=z;this.oa=Z;this.Fa=pa;this.Eb=Fa;this.Pmc=rc.Ok(ne.a.xrd);this.Uk=Ma;this.ic=tb;this.Ga=Hb;this.vk=yc;this.Qt=xc;this.Qs=ld;this.ue=wd;this.nc=t;this.sa=aa;this.XZa=Pf.a("AnimationPaneTelemetryEnabled")}qb(){this.ia.pa(Mc.a.q3b,Zc.a.application,this.pOl,4);this.ia.pa(Mc.a.eOb,Zc.a.application,this.eOb,97);this.ia.pa(Mc.a.RQb,Zc.a.application,this.oOl,4);this.ia.pa(Mc.a.zMa,Zc.a.application,this.zMa,97);this.ia.pa(Mc.a.ERh,Zc.a.application,this.o_j,4);this.ia.pa(Mc.a.Ztc,Zc.a.application,
this.Ztc,96);this.ia.pa(Mc.a.QQb,Zc.a.application,this.nOl,4);this.ia.pa(Mc.a.yMa,Zc.a.application,this.yMa,97);this.ia.pa(Mc.a.jqa,Zc.a.application,this.jqa,97);this.ia.pa(Mc.a.Tx,Zc.a.application,this.Tx,13);this.ia.pa(Mc.a.PQb,Zc.a.application,this.Tx,13);this.ia.pa(Mc.a.SQb,Zc.a.application,this.Tx,5);this.ia.pa(Mc.a.j3a,Zc.a.application,this.Tx,5);this.ia.pa(Mc.a.Zsd,Zc.a.application,this.A_e,100);this.ia.pa(Mc.a.h3a,Zc.a.application,this.h3a,13);this.ia.pa(Mc.a.W1a,Zc.a.application,this.W1a,
97);this.ia.pa(Mc.a.i3a,Zc.a.application,this.i3a,12);this.ia.pa(Mc.a.X1a,Zc.a.application,this.X1a,96);this.ia.pa(Mc.a.nyd,Zc.a.application,this.rNa,13);this.ia.pa(Mc.a.oyd,Zc.a.application,this.rNa,13);this.ia.pa(Mc.a.pyd,Zc.a.application,this.rNa,13);this.ia.pa(Mc.a.qyd,Zc.a.application,this.rNa,13);this.ia.pa(Mc.a.kqa,Zc.a.application,this.kqa,97);this.ia.pa(Mc.a.E1a,Zc.a.application,this.E1a,96);this.ia.pa(Mc.a.rAa,Zc.a.application,this.rAa,12);this.ia.pa(Mc.a.Ypc,Zc.a.application,this.Thh,4);
this.ia.pa(Mc.a.Zpc,Zc.a.application,this.Thh,4);this.ia.pa(Mc.a.HEd,Zc.a.application,this.Qgm,4);this.oa.AG(this.onSelectionChange);this.Qt.p_d(this.onSelectionChange);this.Qt.kU(this.onActiveSlideDomReady);this.Qs.Ak(this.ph);this.ue.BSa(this.Mha);Pf.a("FixMarkersForShapeDeleteAndUndo")&&this.Qt.yvb(this.hza);this.QKk&&this.ia.pa(Mc.a.qJf,Zc.a.application,this.Gsi,4);Pf.a("FixAnimationPaneVisibilityInViewMode")&&this.Db.QH(z=>{this.St(z)})}Sd(){}St(z){1===z.mode&&this.c2&&this.$ne()}Cig(z){if(null===
z||void 0===z||!z.length)return[];const Z=new Set,pa=[];z.forEach(Fa=>{Z.has(Fa.id)||(Z.add(Fa.id),pa.push(Fa))});return pa}eIa(z,Z){return z&&Z?z.equals(Z.slideId):!1}$rg(z){var Z=Date.now();if(z&&z.changeAnimationRelationshipInfo){var pa=this.vk.Iy,Fa=this.oa.Pk();Fa&&pa&&pa.length?(z=z.changeAnimationRelationshipInfo,pa=nf.$0(pa),pa=nf.w0f(pa,z.startType),this.OU(Fa,pa,!1),this.XZa&&(Z=Date.now()-Z,he.c(Mc.a.q3b,!0,void 0,0,30,Z))):Qc.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else Qc.a.J(509444174,
800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}Osg(z){const Z=Date.now();if(z&&z.modifyAnimationInfo){var pa=this.vk.Iy,Fa=this.oa.Pk();if(Fa&&pa&&pa.length)if(Pf.a("FixAnimationPaneActionContextNullIssue")){var Ma=vg.a.Zj("SetAnimationDuration",1);0==z.modifyAnimationInfo.modifyAnimationType&&(Ma.actionName="SetAnimationDelay");Ma.gq=!0;vg.a.gz(Ma,()=>{var tb=nf.$0(pa);if(tb=nf.uhg(z.modifyAnimationInfo,tb)){if(this.OU(Fa,tb,!1),this.XZa){tb=null;
switch(z.modifyAnimationInfo.modifyAnimationType){case 0:tb=Mc.a.QQb;break;case 1:tb=Mc.a.RQb}if(tb){const Hb=Date.now()-Z;he.c(tb,!0,void 0,0,30,Hb)}}}else Qc.a.J(509444170,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")})}else if(Ma=nf.$0(pa),Ma=nf.uhg(z.modifyAnimationInfo,Ma)){if(this.OU(Fa,Ma,!1),this.XZa){Ma=null;switch(z.modifyAnimationInfo.modifyAnimationType){case 0:Ma=Mc.a.QQb;break;case 1:Ma=Mc.a.RQb}if(Ma){const tb=Date.now()-
Z;he.c(Ma,!0,void 0,0,30,tb)}}}else Qc.a.J(508829900,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed");else Qc.a.J(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else Qc.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}jtg(z){const Z=Date.now(),pa=z.reorderAnimationInfo;if(z&&pa){var Fa=this.vk.Iy,Ma=z.reorderAnimationInfo.refAnimationId,tb=this.oa.Pk();
if(tb&&Fa&&Fa.length&&Ma)if(Pf.a("FixAnimationPaneActionContextNullIssue"))z=vg.a.Zj("MoveAnimationEarlier",1),z.gq=!0,z.actionName=Ma.effectNodeId<Fa[0].EffectNodeId?"MoveAnimationEarlier":"MoveAnimationLater",vg.a.gz(z,()=>{var Hb=new ig;Hb.EffectNodeId=Ma.effectNodeId;Hb.ShapeId=Ma.shapeId;const rc=nf.$0(Fa);Hb=nf.l8d(rc,Hb,pa.isLater);this.OU(tb,Hb,!0);this.XZa&&(Hb=Date.now()-Z,he.c(Ma.effectNodeId<Fa[0].EffectNodeId?Mc.a.Ypc:Mc.a.Zpc,!0,void 0,0,30,Hb))});else{z=new ig;z.EffectNodeId=Ma.effectNodeId;
z.ShapeId=Ma.shapeId;const Hb=nf.$0(Fa);z=nf.l8d(Hb,z,pa.isLater);this.OU(tb,z,!0);this.XZa&&(z=Date.now()-Z,he.c(Ma.effectNodeId<Fa[0].EffectNodeId?Mc.a.Ypc:Mc.a.Zpc,!0,void 0,0,30,z))}else Qc.a.J(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else Qc.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static uhg(z,Z){switch(z.modifyAnimationType){case 0:return nf.ETc(Z,0,z.delay);case 1:return nf.ETc(Z,
1,z.duration);default:return null}}Xdk(z){var Z;if(!(z&&z.length&&!this.Uk.Dec(z)&&this.Uk.xye(z[0])&&z[0].EffectData&&z[0].EffectData.Color))return!1;const pa=null===(Z=z[0].EffectData)||void 0===Z?void 0:Z.Color;for(const Fa of z){if(!Fa.EffectData||!Fa.EffectData.Color)return!1;z=Fa.EffectData.Color;if(z[0]!=pa[0]||z[1]!=pa[1]||z[2]!=pa[2])return!1}return!0}static w0f(z,Z){const pa=new wg.a;pa.AnimationAction=4;const Fa=new Vg;Fa.TargetEffects=z;Fa.StartType=Z;pa.ChangeAnimationRelationshipInfo=
Fa;return pa}static ETc(z,Z,pa){const Fa=new wg.a;Fa.AnimationAction=1;const Ma=new $g;Ma.TargetEffects=z;Ma.ModifyAnimPropType=Z;1===Z?Ma.Duration=pa:Ma.Delay=pa;Fa.ModifyAnimationInfo=Ma;return Fa}static l8d(z,Z,pa){const Fa=new wg.a;Fa.AnimationAction=6;const Ma=new Fe;Ma.TargetEffects=z;Ma.IsLater=pa;Ma.RefEffect=Z;Fa.ReorderAnimationEffectsInfo=Ma;return Fa}static r7e(z,Z){let pa="";switch(Z){case 0:pa=ResourceStrings.l_AnimationStartOptionOnClick;break;case 1:pa=ResourceStrings.l_AnimationStartOptionWithPrevious;
break;case 2:pa=ResourceStrings.l_AnimationStartOptionAfterPrevious}z.H0=pa;z.kxc()}}nf.bPj=z=>{const Z=[];if(!z||!z.length)return Z;for(const pa of z)z=new ig,z.EffectNodeId=pa.effectNodeId,z.ShapeId=pa.shapeId,Z.push(z);return Z};nf.wvj=z=>{switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};nf.suj=(z,Z,pa,Fa,Ma)=>0==Z&&0==pa?nf.szj(Ma):Fa?nf.Kfg(z,Z,pa,!0):nf.xng(Ma,Z,pa);nf.xng=(z,Z,pa)=>{const Fa=new wg.a;Fa.AnimationAction=
2;const Ma=new Ph;if(!z||!z.length)return Qc.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;Ma.TargetEffects=nf.$0(z);Ma.EffectId=Z;Ma.EffectType=pa;Fa.ReplaceAnimationInfo=Ma;return Fa};nf.szj=z=>z&&z.length?nf.I0f(nf.$0(z)):(Qc.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null);nf.Kfg=(z,Z,pa,Fa)=>{const Ma=new wg.a;Ma.AnimationAction=0;const tb=new fe;tb.EffectId=Z;tb.EffectType=
pa;tb.ShapeIds=[];tb.FRemoveExisting=Fa;for(const Hb of z)tb.ShapeIds.push(Hb.id.toString());Ma.AddAnimationInfo=tb;return Ma};nf.I0f=z=>{const Z=new wg.a;Z.AnimationAction=3;const pa=new Qe;pa.TargetEffects=z;Z.DeleteAnimationInfo=pa;return Z};nf.HNj=z=>{switch(z.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};nf.$0=z=>{if(!z||!z.length)return null;const Z=[];for(const pa of z)z=new ig,z.EffectNodeId=pa.EffectNodeId,z.ShapeId=pa.ShapeId,
Z.push(z);return Z};nf.Rpk=(z,Z)=>{if(!z||!Z||!Z.length)return!1;for(const pa of Z)if(pa.mY||pa.$r||Pf.a("FixAnimationRibbonBugs")?0:pa.Vp)return!1;return!0};nf.Qpk=z=>{if(!z||!z.length)return!1;for(const Z of z)if(Z.vd||Z.Lq||Pf.a("FixAnimationRibbonBugs")?0:Z.Vp)return!1;return!0};nf.Ydk=z=>{if(!z||!z.length)return!1;const Z=z[0].Direction;for(let pa=1;pa<z.length;pa++)if(z[pa].Direction!=Z)return!1;return!0};nf.Wdk=z=>{if(!z||!z.length)return!1;const Z=z[0].BuildType;for(let pa=1;pa<z.length;pa++)if(z[pa].BuildType!=
Z)return!1;return!0};nf.qAj=z=>{if(!z)return"";switch(z.EffectDataPropType){case 0:return z.Degree.toString();case 3:return z.Scale.toString();case 2:return z.Transparency.toString()}return""};nf.wnl=(z,Z,pa,Fa)=>{pa?(z.Mbb=ResourceStrings.L_AnimationExisting,Fa&&(Fa=!1)):Z&&(z.Mbb=ResourceStrings.L_AnimationMultiple);return Fa};Object(k.a)(nf,"AnimationActor",null,[948]);class ki{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=
this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(k.a)(ki,"EditAnimationInfo",null,[]);var qf;(function(z){z[z.invalid=0]="invalid";z[z.basicBlockList=1]="basicBlockList";z[z.alternatingHexagons=2]="alternatingHexagons";z[z.pictureCaptionList=3]="pictureCaptionList";z[z.linedList=4]="linedList";z[z.verticalBulletList=
5]="verticalBulletList";z[z.verticalBoxList=6]="verticalBoxList";z[z.verticalBracketList=7]="verticalBracketList";z[z.varyingWidthList=8]="varyingWidthList";z[z.tabList=9]="tabList";z[z.horizontalBulletList=10]="horizontalBulletList";z[z.squareAccentList=11]="squareAccentList";z[z.pictureAccentList=12]="pictureAccentList";z[z.bendingPictureAccentList=13]="bendingPictureAccentList";z[z.stackedList=14]="stackedList";z[z.increasingCircleProcess=15]="increasingCircleProcess";z[z.pieProcess=16]="pieProcess";
z[z.detailedProcess=17]="detailedProcess";z[z.groupedList=18]="groupedList";z[z.horizontalPictureList=19]="horizontalPictureList";z[z.continuousPictureList=20]="continuousPictureList";z[z.pictureStrips=21]="pictureStrips";z[z.verticalPictureList=22]="verticalPictureList";z[z.alternatingPictureBlocks=23]="alternatingPictureBlocks";z[z.verticalPictureAccentList=24]="verticalPictureAccentList";z[z.titledPictureAccentList=25]="titledPictureAccentList";z[z.verticalBlockList=26]="verticalBlockList";z[z.verticalChevronList=
27]="verticalChevronList";z[z.verticalAccentList=28]="verticalAccentList";z[z.verticalArrowList=29]="verticalArrowList";z[z.trapezoidList=30]="trapezoidList";z[z.descendingBlockList=31]="descendingBlockList";z[z.tableList=32]="tableList";z[z.segmentedProcess=33]="segmentedProcess";z[z.verticalCurvedList=34]="verticalCurvedList";z[z.pyramidList=35]="pyramidList";z[z.targetList=36]="targetList";z[z.hierarchyList=37]="hierarchyList";z[z.verticalCircleList=38]="verticalCircleList";z[z.tableHierarchy=
39]="tableHierarchy";z[z.architectureLayout=40]="architectureLayout";z[z.basicProcess=41]="basicProcess";z[z.stepUpProcess=42]="stepUpProcess";z[z.stepDownProcess=43]="stepDownProcess";z[z.accentProcess=44]="accentProcess";z[z.pictureAccentProcess=45]="pictureAccentProcess";z[z.alternatingFlow=46]="alternatingFlow";z[z.continuousBlockProcess=47]="continuousBlockProcess";z[z.increasingArrowsProcess=48]="increasingArrowsProcess";z[z.interconnectedBlockProcess=49]="interconnectedBlockProcess";z[z.continuousArrowProcess=
50]="continuousArrowProcess";z[z.convergingText=51]="convergingText";z[z.processArrows=52]="processArrows";z[z.circleAccentTimeline=53]="circleAccentTimeline";z[z.basicTimeline=54]="basicTimeline";z[z.circleProcess=55]="circleProcess";z[z.basicChevronProcess=56]="basicChevronProcess";z[z.chevronAccentProcess=57]="chevronAccentProcess";z[z.closedChevronProcess=58]="closedChevronProcess";z[z.chevronList=59]="chevronList";z[z.subStepProcess=60]="subStepProcess";z[z.phasedProcess=61]="phasedProcess";
z[z.randomtoResultProcess=62]="randomtoResultProcess";z[z.verticalProcess=63]="verticalProcess";z[z.staggeredProcess=64]="staggeredProcess";z[z.processList=65]="processList";z[z.circleArrowProcess=66]="circleArrowProcess";z[z.basicBendingProcess=67]="basicBendingProcess";z[z.repeatingBendingProcess=68]="repeatingBendingProcess";z[z.verticalBendingProcess=69]="verticalBendingProcess";z[z.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";z[z.upwardArrow=71]="upwardArrow";z[z.descendingProcess=
72]="descendingProcess";z[z.circularBendingProcess=73]="circularBendingProcess";z[z.equation=74]="equation";z[z.verticalEquation=75]="verticalEquation";z[z.funnel=76]="funnel";z[z.gear=77]="gear";z[z.arrowRibbon=78]="arrowRibbon";z[z.opposingArrows=79]="opposingArrows";z[z.convergingArrows=80]="convergingArrows";z[z.divergingArrows=81]="divergingArrows";z[z.basicCycle=82]="basicCycle";z[z.textCycle=83]="textCycle";z[z.blockCycle=84]="blockCycle";z[z.nondirectionalCycle=85]="nondirectionalCycle";z[z.continuousCycle=
86]="continuousCycle";z[z.multidirectionalCycle=87]="multidirectionalCycle";z[z.segmentedCycle=88]="segmentedCycle";z[z.basicPie=89]="basicPie";z[z.hexagonRadial=90]="hexagonRadial";z[z.radialCycle=91]="radialCycle";z[z.basicRadial=92]="basicRadial";z[z.divergingRadial=93]="divergingRadial";z[z.radialVenn=94]="radialVenn";z[z.cycleMatrix=95]="cycleMatrix";z[z.radialCluster=96]="radialCluster";z[z.organizationChart=97]="organizationChart";z[z.pictureOrganizationChart=98]="pictureOrganizationChart";
z[z.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";z[z.halfCircleOrganizationChart=100]="halfCircleOrganizationChart";z[z.circlePictureHierarchy=101]="circlePictureHierarchy";z[z.hierarchy=102]="hierarchy";z[z.labeledHierarchy=103]="labeledHierarchy";z[z.horizontalOrganizationChart=104]="horizontalOrganizationChart";z[z.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";z[z.horizontalHierarchy=106]="horizontalHierarchy";z[z.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";
z[z.balance=108]="balance";z[z.circleRelationship=109]="circleRelationship";z[z.hexagonCluster=110]="hexagonCluster";z[z.opposingIdeas=111]="opposingIdeas";z[z.plusandMinus=112]="plusandMinus";z[z.reverseList=113]="reverseList";z[z.counterbalanceArrows=114]="counterbalanceArrows";z[z.segmentedPyramid=115]="segmentedPyramid";z[z.nestedTarget=116]="nestedTarget";z[z.convergingRadial=117]="convergingRadial";z[z.radialList=118]="radialList";z[z.tabbedArc=119]="tabbedArc";z[z.basicTarget=120]="basicTarget";
z[z.basicVenn=121]="basicVenn";z[z.linearVenn=122]="linearVenn";z[z.stackedVenn=123]="stackedVenn";z[z.interconnectedRings=124]="interconnectedRings";z[z.basicMatrix=125]="basicMatrix";z[z.titledMatrix=126]="titledMatrix";z[z.gridMatrix=127]="gridMatrix";z[z.basicPyramid=128]="basicPyramid";z[z.invertedPyramid=129]="invertedPyramid";z[z.accentedPicture=130]="accentedPicture";z[z.circularPictureCallout=131]="circularPictureCallout";z[z.radialPictureList=132]="radialPictureList";z[z.snapshotPictureList=
133]="snapshotPictureList";z[z.spiralPicture=134]="spiralPicture";z[z.captionedPictures=135]="captionedPictures";z[z.bendingPictureCaption=136]="bendingPictureCaption";z[z.pictureFrame=137]="pictureFrame";z[z.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";z[z.bendingPictureBlocks=139]="bendingPictureBlocks";z[z.bendingPictureCaptionList=140]="bendingPictureCaptionList";z[z.titledPictureBlocks=141]="titledPictureBlocks";z[z.pictureGrid=142]="pictureGrid";z[z.pictureAccentBlocks=
143]="pictureAccentBlocks";z[z.themePictureAccent=144]="themePictureAccent";z[z.themePictureGrid=145]="themePictureGrid";z[z.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";z[z.alternatingPictureCircles=147]="alternatingPictureCircles";z[z.titlePictureLineup=148]="titlePictureLineup";z[z.pictureLineup=149]="pictureLineup";z[z.framedTextPicture=150]="framedTextPicture";z[z.bubblePictureList=151]="bubblePictureList";z[z.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";
z[z.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";z[z.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";z[z.accentHomeChevronProcess=155]="accentHomeChevronProcess";z[z.basicProcessNew=156]="basicProcessNew";z[z.basicTimelineNew=157]="basicTimelineNew";z[z.chevronBlockProcess=158]="chevronBlockProcess";z[z.hexagonTimeline=159]="hexagonTimeline";z[z.horizontalActionList=160]="horizontalActionList";z[z.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";z[z.roundedRectangleTimeline=
162]="roundedRectangleTimeline";z[z.verticalDownArrowProcess=163]="verticalDownArrowProcess";z[z.verticalHollowActionList=164]="verticalHollowActionList";z[z.verticalSolidActionList=165]="verticalSolidActionList";z[z.dropPinTimeline=166]="dropPinTimeline";z[z.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";z[z.horizontalPathTimeline=168]="horizontalPathTimeline";z[z.iconLabelList=169]="iconLabelList";z[z.iconCircleList=170]="iconCircleList";z[z.iconLabelDescriptionList=171]="iconLabelDescriptionList";
z[z.iconVerticalSolidList=172]="iconVerticalSolidList";z[z.iconCircleLabelList=173]="iconCircleLabelList";z[z.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";z[z.iconLeafLabelList=175]="iconLeafLabelList";z[z.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";z[z.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(qf||(qf={}));Object(k.b)("SmartArtLayout",qf);var be;(function(z){z[z.title=0]="title";z[z.body=1]="body";z[z.centerTitle=2]="centerTitle";z[z.subTitle=
3]="subTitle";z[z.slideNum=5]="slideNum";z[z.footer=6]="footer";z[z.object=8]="object";z[z.graph=9]="graph";z[z.table=10]="table";z[z.clipArt=11]="clipArt";z[z.orgChart=12]="orgChart";z[z.media=13]="media";z[z.picture=15]="picture";z[z.cameo=16]="cameo"})(be||(be={}));Object(k.b)("PlaceholderType",be);class Ud{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc){this.U7="Existing";this.WNa="ExistingInMenu";this.mbf="AnimationExisting";this.nbf="AnimationExistingInMenu";this.ia=z;this.Uq=Z;this.oa=pa;this.Pmc=
xc.Ok(ne.a.xrd);this.Eb=Ma;this.Fa=Fa;this.Uk=tb;this.ic=Hb;this.SKk=rc.pptAnimationMarkersEnabled;this.Ga=yc;this.YJe=Pf.a("SetAnimationTelemetryCustomDataEnabled")}qb(){this.ia.pa(Mc.a.jqa,Zc.a.application,Object(ib.a)(this,this.jqa,"queryAnimationGallery"),97);this.ia.pa(Mc.a.Y_e,Zc.a.application,Object(ib.a)(this,this.Y_e,"queryMoreAnimationGallery"),96);this.ia.pa(Mc.a.Tx,Zc.a.application,Object(ib.a)(this,this.Tx,"setAnimation"),5|(this.YJe?8:0));this.ia.pa(Mc.a.PQb,Zc.a.application,Object(ib.a)(this,
this.Tx,"setAnimation"),5|(this.YJe?8:0));this.ia.pa(Mc.a.SQb,Zc.a.application,Object(ib.a)(this,this.Tx,"setAnimation"),5);this.ia.pa(Mc.a.j3a,Zc.a.application,Object(ib.a)(this,this.Tx,"setAnimation"),5);this.ia.pa(Mc.a.Zsd,Zc.a.application,Object(ib.a)(this,this.A_e,"queryEffectOptions"),100);this.ia.pa(Mc.a.h3a,Zc.a.application,Object(ib.a)(this,this.h3a,"setAnimationDirection"),5);this.ia.pa(Mc.a.W1a,Zc.a.application,Object(ib.a)(this,this.W1a,"queryAnimationDirection"),97);this.ia.pa(Mc.a.i3a,
Zc.a.application,Object(ib.a)(this,this.i3a,"setAnimationEffectData"),4);this.ia.pa(Mc.a.X1a,Zc.a.application,Object(ib.a)(this,this.X1a,"queryAnimationEffectData"),96);this.ia.pa(Mc.a.nyd,Zc.a.application,Object(ib.a)(this,this.rNa,"setAnimationSequence"),5);this.ia.pa(Mc.a.oyd,Zc.a.application,Object(ib.a)(this,this.rNa,"setAnimationSequence"),5);this.ia.pa(Mc.a.pyd,Zc.a.application,Object(ib.a)(this,this.rNa,"setAnimationSequence"),5);this.ia.pa(Mc.a.qyd,Zc.a.application,Object(ib.a)(this,this.rNa,
"setAnimationSequence"),5);this.ia.pa(Mc.a.kqa,Zc.a.application,Object(ib.a)(this,this.kqa,"queryAnimationSequence"),97);this.ia.pa(Mc.a.W3e,Zc.a.application,Object(ib.a)(this,this.Yba,"reorderAnimation"),4);this.ia.pa(Mc.a.X3e,Zc.a.application,Object(ib.a)(this,this.Yba,"reorderAnimation"),4);this.ia.pa(Mc.a.E1a,Zc.a.application,Object(ib.a)(this,this.E1a,"populateAnimationEffectOptions"),96);this.ia.pa(Mc.a.rAa,Zc.a.application,Object(ib.a)(this,this.rAa,"setAnimationColor"),4)}Sd(){}E1a(z,Z,pa,
Fa,Ma){z=this.s$();Z=this.oa.Pk();if(!Z||!z)return 8;if(1===pa)return 32;pa=Ud.s5(Z,z);if(!pa||0===pa.EffectId)return 16;Ma.MenuItems=this.NJi(pa,Z,z);return 32}jqa(z,Z,pa,Fa,Ma){z=Ma.queryResult;Ma=Ma.SourceControlId;var tb=Fa=-1;Ma!==this.U7&&({effectType:tb,effectId:Fa}=this.Uk.J_c(Ma));Z=this.s$();var Hb=this.oa.Pk();if(!Hb||!Z)return 8;if(1!==pa)return 32;const {image:rc,label:yc}=this.Uk.K_c(Ma);pa=yc;if(Ma===this.U7||Ma===this.WNa)pa=ResourceStrings.L_ExistingButtonDescription;this.Pbb(Ma,
rc,yc,z,pa);var xc=Ud.s5(Hb,Z);pa=xc?xc.EffectId:0;const ld=xc?xc.EffectType:0,wd=!this.Uk.web(xc,Z);xc=this.Uk.wwe(xc,Z);this.SKk&&(Hb=Hb?Hb.kWa(Z):null,xc=xc&&!this.Uk.zpk(Hb));Fa=!wd&&!xc&&Fa===pa&&tb===ld;tb=wd?!1:this.Uk.T6c(ld,pa);Ma===this.U7||Ma===this.WNa?(tb=Ma===this.U7?this.znl(this.U7,z,xc,tb,rc,ld,pa):Ud.xnl(z,xc,tb),z.sW(wd||xc||tb)):Z&&z.sW(Fa);return 32}znl(z,Z,pa,Fa,Ma,tb,Hb){pa?this.Pbb(z,Ma,ResourceStrings.L_AnimationMultiple,Z,ResourceStrings.L_AnimationMultiple):Fa&&(Ma=this.Uk.e2c(tb,
Hb),{image:Ma,label:pa}=this.Uk.K_c(Ma),this.Pbb(z,Ma,pa,Z,pa));return Fa}Pbb(z,Z,pa,Fa,Ma){let tb;tb=z===this.U7?"298832323":z===this.WNa?"1264919631":"2676673376";Z=Z.substring((ne.a.Fsc+"_").length,Z.length-6);z=Object.assign(new we.a,{Id:z,ExternalId:"Animation"+z,Icon:Z,Command:tb,QueryCommand:"1852964326",LabelText:pa,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ma});Fa.k5=z}Y_e(z,Z){if(Z.contextId!==Zc.a.application)return 2;z=this.s$();
return!this.oa.Pk()||!z||z.mY||z.$r||z.Vp?8:this.ic.Xc(z)?16:32}Tx(z,Z,pa,Fa,Ma){Z=this.s$();var tb=this.oa.Pk();if(!tb||!Z||Z.mY||Z.$r||Z.Vp)return 8;if(this.ic.Xc(Z))return 16;var Hb=Ud.s5(tb,Z);const rc=Hb?Hb.EffectId:-1,yc=Hb?Hb.EffectType:-1;if(1===pa)return z===Mc.a.SQb||z===Mc.a.j3a?(Fa=this.Uk.T6c(yc,rc),tb=!!Hb&&!this.Uk.web(Hb,Z),z===Mc.a.j3a&&(Fa=tb?!0:!1),Z=!!Hb&&this.Uk.wwe(Hb,Z),Z=tb||Z,Fa||Z?32:16):z===Mc.a.PQb?Z.vd||Z.Lq||Z.Vp?16:32:32;z=Ma.SourceControlId;if(!z)return 8;if(z===this.U7||
z===this.WNa||z===this.mbf||z===this.nbf)return 32;const {effectType:xc,effectId:ld}=this.Uk.J_c(z);pa=this.Uk.czj(z);Ma=this.Uk.$yj(z);Fa&&this.YJe&&(Fa.ED=ld,Fa.MO=xc);Hb=Z.leb()?Ud.dbc(tb,Z):Hb;Hb||(Hb=new ki,Hb.Id=Z.id.toString(),Hb.BuildIds=[tb.w8b+1],Hb.HasTrigger=!1,Hb.BuildId=tb.w8b+1,Hb.SequenceIndex=0,Hb.IsTextRangeType=!1);Hb.HasExisting=!1;Hb.HasMultiple=!1;Hb.EffectType=xc;Hb.SequenceId=1;Hb.EffectId=ld;Hb.Direction=pa;Hb.EffectData=Ma;Hb.IsTrigger=!1;this.m9b(tb,Z,Hb);e.ULS.sendTraceTag(512500802,
800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",z,tb.Fb.sid,Z.id);this.TDk(tb);return 32}rAa(z,Z,pa,Fa,Ma){Z=this.Uq.presentation;if(!Z)throw Error.argumentNull("Presentation is null");z=this.s$();if(!z)return 8;Z=Object(w.a)(205,Z.LD(z.slideId));if(!Z)return 8;Fa=Ud.s5(Z,z);if(!(Fa&&Ma&&Z&&z))return 8;if(this.ic.Xc(z))return 16;if(1===pa)return 32;pa=bf.Box4ColorHelper.uT(Ma);pa=bf.Box4ColorHelper.Rmb(pa,Z.Ld);if(!pa)return 8;Fa.EffectData=String.format("{0},{1},{2}",
pa.r.toString(16),pa.g.toString(16),pa.b.toString(16));this.m9b(Z,z,Fa);return 32}A_e(){const z=this.s$();var Z=this.oa.Pk();return Z&&z?this.ic.Xc(z)?16:(Z=Ud.s5(Z,z))&&this.Uk.APi(z,this.Ga,Z)?32:16:8}Yba(z,Z,pa){Z=this.s$();const Fa=this.oa.Pk();if(!Fa||!Z)return 8;if(this.ic.Xc(Z))return 16;const Ma=Ud.dbc(Fa,Z);let tb;switch(z){case Mc.a.W3e:tb=!1;break;case Mc.a.X3e:tb=!0;break;default:return 8}let Hb=!1;if(Z&&(Hb=!!Ma&&!Ma.HasTrigger&&1===Ma.BuildIds.length)){let rc=!1,yc=!1;({O4b:rc,Q4b:yc}=
Ud.FPi(Fa,Ma));Hb=tb?yc&&Hb:rc&&Hb}if(1===pa)return Hb?32:8;if(Hb){pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{pa.mc(Fa),pa.Wc=z,Fa.Yba(Z,tb)}finally{pa&&pa.dispose()}}return 32}h3a(z,Z,pa,Fa,Ma){z=this.s$();Z=this.oa.Pk();if(!Z||!z)return 8;if(1===pa)return 32;if(this.ic.Xc(z))return 16;pa=Ud.dbc(Z,z);if(!pa)return 8;Ma=Ma.MenuItemId;pa.Direction=this.Uk.eac(Ma);this.m9b(Z,z,pa);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",
this.Uk.e2c(pa.EffectType,pa.EffectId),Ma,Z.sid,z.id);return 32}W1a(z,Z,pa,Fa,Ma){Z=this.s$();Fa=this.oa.Pk();if(!Fa||!Z)return 8;z=Ma.queryResult;Ma=this.Uk.eac(Ma.MenuItemId);Z=Ud.s5(Fa,Z);1===pa&&Z&&z.Rf(Z.Direction===Ma);return 32}rNa(z,Z,pa,Fa,Ma){z=Ma.MenuItemId;Z=this.s$();Fa=this.oa.Pk();if(!Fa||!Z)return 8;if(1===pa)return 32;if(this.ic.Xc(Z))return 16;pa=Ud.dbc(Fa,Z);if(!pa)return 8;pa.SequenceId=this.Uk.rke(z);this.m9b(Fa,Z,pa);return 32}kqa(z,Z,pa,Fa,Ma){z=this.s$();Z=this.oa.Pk();if(!Z||
!z)return 8;z=Ud.s5(Z,z);Z=Ma.queryResult;Ma=this.Uk.rke(Ma.MenuItemId);1===pa&&z&&Z.Rf(z.SequenceId===Ma);return 32}i3a(z,Z,pa,Fa,Ma){z=this.s$();Z=this.oa.Pk();if(!Z||!z)return 8;if(1===pa)return 32;if(this.ic.Xc(z))return 16;pa=Ud.dbc(Z,z);if(!pa)return 8;if(!Ma)return 2;pa.EffectData=this.Uk.ghe(Ma.MenuItemId);this.m9b(Z,z,pa);return 32}X1a(z,Z,pa,Fa,Ma){z=this.s$();Z=this.oa.Pk();if(!Z||!z)return 8;z=Ud.s5(Z,z);1===pa&&z&&Ma.queryResult.Rf(this.Uk.aZf(z.EffectData,Ma.MenuItemId));return 32}m9b(z,
Z,pa){const Fa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{Fa.mc(z),z.Jxc(Z,pa)}finally{Fa&&Fa.dispose()}}NJi(z,Z,pa){const Fa=Object.assign(new Me.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});Array.add(Fa.MenuSectionList,this.Uk.C1c(z.EffectId,z.EffectType,"Direction","2289594085","3782857737"));this.Uk.xAg(z)&&(Array.add(Fa.MenuSectionList,te.f(Z.Ld,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker",
"679168237",2)),Array.add(Fa.MenuSectionList,te.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(Fa.MenuSectionList,this.Uk.C1c(z.EffectId,z.EffectType,"EffectData","2949363495","4132852551"));Array.add(Fa.MenuSectionList,this.Uk.zJj(pa,this.Ga,z));return Fa}TDk(z){if(z){var Z=z.yj(),pa=String.format("{0}#{1}",z.sid,z.cid);if(Z&&0<Z.length)for(const Fa of Z)if(Z=z.JGa(Fa)){const Ma=Z.EffectId,tb=Z.EffectType,Hb=Z.Direction,
rc=this.Uk.e2c(tb,Ma),yc=this.Ga.Njg(Fa),xc=Ud.nMj(Fa,yc);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",rc,Ma,tb,Hb,Fa.aA().length,yc,xc,Z.SequenceId,pa,Fa.id)}}}s$(){const z=this.oa.Zn();return z?z.get_smartArtModelId()?this.Ga.Hs(z):z.Rg?this.Ga.zt(z):z:null}static xnl(z,Z,pa){Z?z.Mbb=ResourceStrings.L_AnimationMultiple:(z.Mbb=ResourceStrings.L_AnimationExisting,
pa&&(pa=!1));return pa}static FPi(z,Z){let pa,Fa;if(!Z)return{O4b:!1,Q4b:!1};const Ma=z.Oae,tb=z.w8b,Hb=Z.BuildIds[0];Fa=pa=!0;0===Z.StartType?pa=Hb>Ma?!0:!1:Fa=Hb<tb?!0:!1;if(Hb===Ma||Hb===tb){if(!Hb)return{O4b:!1,Q4b:Fa};for(const rc of z.vR)if(rc.Id!==Z.Id)for(const yc of rc.BuildIds)if(0===Z.StartType){if(yc>=Hb)return Fa=!0,{O4b:pa,Q4b:Fa}}else if(yc===Hb)return pa=!0,{O4b:pa,Q4b:Fa};0===Z.StartType?Fa=!1:pa=!1}return{O4b:pa,Q4b:Fa}}static s5(z,Z){return z&&Z?z.s5(Z):null}static dbc(z,Z){return z&&
Z?z.JGa(Z):null}static nMj(z,Z){return 24===Z?qf[z.smartArtInfo.SmartArtLayout]:1===Z?z.shapeType.toString():14===Z?be[z.mj]:"Unknown"}}Object(k.a)(Ud,"AnimationActorLegacy",null,[948]);class Ei{constructor(z,Z,pa,Fa){this.Nf=null;this.Ca=z;this.xrb=Z;this.hfi=pa;this.oTd=Fa;this.oTd.init();this.xrb.init()}qb(){this.Ca.pa(Hd.a.FMb,Zc.a.application,Object(ib.a)(this,this.FMb,"openGrammarSettings"),1028);this.Ca.xa(Hd.a.Ybc,Db.a.frame,Object(ib.a)(this,this.Arg,"grammarDialogTabFocusHandler"));this.Ca.xa(Hd.a.Xbc,
Db.a.frame,Object(ib.a)(this,this.Arg,"grammarDialogTabFocusHandler"));this.Ca.xa(Hd.a.V2c,Db.a.frame,Object(ib.a)(this,this.zrg,"grammarDialogOptionFocusHandler"));this.Ca.xa(Hd.a.U2c,Db.a.frame,Object(ib.a)(this,this.zrg,"grammarDialogOptionFocusHandler"))}FMb(z,Z,pa,Fa,Ma){z=this.Vhg();if(1===pa)return this.oTd.request(z).result&&this.oTd.request(z).result.length?6===this.xrb.z7a.status?32:8:8;this.Nf=this.hfi(z,this.xrb.z7a.result);this.Nf.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,
tb=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===tb?"OK":0===tb?"Cancel":"");1===tb&&(this.Nf.Rsk()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.xrb.saveSettings(this.Nf.settings)):e.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});z=pa="";Ma&&(pa+=Ma.SourceControlId,z+=Ma.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+pa+", Alt: "+z);return 32}Vhg(){return H.AFrameworkApplication.lcid}Arg(z){if(!this.Nf)return 2;
var Z=this.Nf.Bp.gm().jk.L0;if(Z===this.Nf.ex&&z===Hd.a.Ybc||Z===this.Nf.G2a&&z===Hd.a.Xbc)this.Nf.r9?this.Nf.Bp.gm().jk.bG(this.Nf.r9):this.Nf.ELl();else if(Sys.UI.DomElement.containsCssClass(Z,$e.e7b)||Z.parentNode&&Sys.UI.DomElement.containsCssClass(Z.parentNode,$e.e7b))Z=null,z===Hd.a.Ybc?Z=this.Nf.G2a:z===Hd.a.Xbc&&(Z=this.Nf.ex),this.Nf.Bp.gm().jk.bG(Z);else if(z===Hd.a.Ybc)this.Nf.Bp.gm().sLb();else if(z===Hd.a.Xbc)this.Nf.Bp.gm().qLb();else return 2;return 32}zrg(z){if(!this.Nf)return 2;let Z=
this.Nf.Bp.gm().jk.L0;if(Z===this.Nf.ex||Z===this.Nf.G2a||Z===this.Nf.HE)return 2;z===Hd.a.U2c&&this.Nf.Bp.gm().sLb();z===Hd.a.V2c&&this.Nf.Bp.gm().qLb();Z=this.Nf.Bp.gm().jk.L0;Z===this.Nf.G2a?this.Nf.Bp.gm().qLb():Z===this.Nf.ex?this.Nf.Bp.gm().sLb():this.Nf.r9=Z;return 32}}Object(k.a)(Ei,"GrammarSettingsActor",null,[]);class ei extends Ei{constructor(z,Z,pa,Fa,Ma,tb,Hb){super(z,Z,pa,Fa);this.gb=Ma;this.tKe=tb;this.Ga=Hb}Vhg(){let z=H.AFrameworkApplication.lcid;if(this.gb.u1(this.gb.Oa)){var Z=
this.gb.Hd();Z&&1===Z.length&&(Z=this.Ga.VVa(Z[0]),0<Z&&(z=Z))}else this.gb.Oa.kb&&(Z=this.tKe.F0c(this.gb.Ik),0<Z&&(z=Z));return z}}Object(k.a)(ei,"EditorSettingsActor",Ei,[]);var Aj=d(57),tj=d(331),Pi=d(233),Eh=d(452),Th=d(223);class Qi{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd){this.l5b=null;this.Dtg=(t,aa,ra)=>{this.l5b=this.sa.Aa;t=this.oa.Xe();if(!t||!t.length)return 16;for(const Na of t)if(!Na||this.ic.Xc(Na)||Aj.a.Cx(Na.Fb))return 16;if(1===ra)return 32;this.XAd(!1);return 32};this.x_j=
(t,aa,ra)=>{t=this.sa.Aa;if(!t||this.ic.Xc(t))return 8;if(1===ra)return 32};this.w_j=(t,aa,ra,Na,db)=>{if(!this.Ba.pptInsertOnlinePictureEnabled)return 8;if(null===db||void 0===db||!db.OriginalUrl)return Qc.a.J(508675585,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages : Image Url is absent."),8;this.l5b=this.sa.Aa;aa=this.oa.Xe().filter(kb=>!!kb);if(aa.every(kb=>this.ic.Xc(kb)))return Qc.a.J(508650910,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages : SlideNode is blocked."),
8;if(null===aa||void 0===aa||!aa.length)return Qc.a.J(508678344,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages: selected slides are empty"),16;if(1===ra)return 32;ra=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()});try{ra.mc(this.l5b);ra.Wc=t;ra.ny[Th.a.Rea]=Th.a.Xkb;for(const kb of aa)kb.O1d=db.OriginalUrl}finally{return null===ra||void 0===ra?void 0:ra.dispose(),32}};this.s_j=(t,aa,ra)=>{var Na;aa=this.oa.Xe();if(!aa||!aa.length)return Qc.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),
8;for(const db of aa)if(!db||this.ic.Xc(db))return Qc.a.J(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.tXl(aa))return Qc.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),8;if(1===ra)return 32;null===(Na=vg.a.Kb)||void 0===Na?void 0:Na.Wa("SlideCount",aa.length.toString());ra=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()});try{ra.mc(this.sa.Aa);ra.Wc=t;for(const db of aa)db.hwc=
!0}finally{ra&&ra.dispose()}return 32};this.ia=z;this.Fa=Z;this.ic=pa;this.oa=Fa;this.Eb=Ma;this.K6=tb;this.sa=Hb;this.pB=rc;this.uS=yc;this.RKe=xc;this.fe=ld;this.Ba=wd}qb(){this.ia.pa(Mc.a.jma,Zc.a.application,Object(ib.a)(this,this.y_j,"handleSlidesSolidFill"),4);this.Ba.b9c?(this.ia.pa(Mc.a.YYc,Zc.a.application,this.x_j,4),this.ia.pa(Mc.a.XYc,Zc.a.application,this.Dtg,4),this.ia.pa(Mc.a.Zee,Zc.a.application,this.w_j,4)):this.ia.pa(Mc.a.Yee,Zc.a.application,this.Dtg,4);this.ia.pa(Mc.a.Xee,Zc.a.application,
Object(ib.a)(this,this.t_j,"handleSlidesFinalizePicture"),4);this.ia.pa(Mc.a.s$b,Zc.a.application,Object(ib.a)(this,this.XTj,"handleApplyAll"),4);this.ia.pa(Mc.a.Xrd,Zc.a.application,Object(ib.a)(this,this.pYj,"handlePopulateFillMenu"),96);this.ia.pa(Mc.a.wRe,Zc.a.application,Object(ib.a)(this,this.sXj,"handleMoreFormatBackgroundColors"),96);this.ia.pa(Mc.a.jsd,Zc.a.application,Object(ib.a)(this,this.tXj,"handleMoreFormatBackgroundColorsResponse"),4);this.ia.pa(Mc.a.t$b,Zc.a.application,this.s_j,
4)}Sd(){}pYj(z,Z,pa,Fa,Ma){Fa=this.sa.Aa;if(!Fa||this.ic.Xc(Fa))return 16;if(1===pa)return 32;if(!Ma)return Qc.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;pa=Fa.Ld;if(!pa)return Qc.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;z=this.K6.Of.wea;Z=Object.assign(new Me.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(Z.MenuSectionList,te.f(pa,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors",
"3049223287",1));Array.add(Z.MenuSectionList,te.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));Pf.a("BackgroundColorHighlightFix")&&(Fa=Pi.a.parse(Fa.jR),Fa=bf.Box4ColorHelper.rma(Fa.mBa(),pa),te.h(Z,Fa,pa));z&&0<z.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(Z.MenuSectionList,te.c(z,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",
"1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(Z.MenuSectionList,te.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ma.MenuItems=Z;return 32}y_j(z,Z,pa,Fa,Ma){Z=this.oa.Xe();if(!Z||!Z.length)return 16;
for(const tb of Z)if(!tb||this.ic.Xc(tb))return 16;if(1===pa)return 32;pa=Qi.Xqd(Ma);if(!pa)return 8;vg.a.Kb&&vg.a.Kb.Wa("SlideCount",Z.length.toString());Ma=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()});try{Ma.mc(this.sa.Aa);Ma.Wc=z;for(const tb of Z)tb.swb=pa}finally{Ma&&Ma.dispose()}return 32}XTj(z,Z,pa){Z=this.sa.Aa;if(!Z||this.ic.Xc(Z))return 16;if(1===pa)return 32;pa=Z.Fb;Z=this.K6.Of;if(!Z)return 8;const Fa=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()});try{Fa.mc(Z),Fa.Wc=z,
Z.Uvb=pa}finally{Fa&&Fa.dispose()}return 32}tXl(z){const Z=this.K6.Of;if(!Z)return Qc.a.J(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const Fa of z)if((z=Fa.jR)&&-1==z.indexOf("/BgSource/ContentMaster")&&-1==z.indexOf("/BgSource/MainMaster")){var pa=Z.foj(Fa.Oj,Fa.xo);if(!pa)return Qc.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),!0;pa=pa.jR;if(!pa||!z.match(pa))return!0}return!1}t_j(z,
Z,pa,Fa,Ma){Z=this.oa.Xe();if(!Z||!Z.length)return 16;for(const Hb of Z)if(!Hb||!Hb.isConnected)return 16;if(1===pa)return 32;this.uS.olb=new Date;const tb=vg.a.Kb;this.pB.Mbf(Ma,Hb=>{vg.a.TJ(tb,()=>{this.v_j(Hb,z)})},Hb=>{this.ucc(Hb.error)});this.sa.Aa===this.l5b&&(this.Fa.Gd(),this.oa.Bh());return 32}sXj(z,Z,pa,Fa,Ma){z=this.sa.Aa;if(!z||this.ic.Xc(z))return Qc.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ba.RD&&Pf.a("MoreColorBackgroundForMultipleSlidesEnabled")?
1>this.oa.Xe().length:1!==this.oa.Xe().length)return 16;if(1===pa)return this.ia.Ia(Mc.a.renderColorPicker,1,Ma);pa=Pi.a.parse(z.jR);if(!pa)return 8;Ma=pa.mBa();pa=null;Ma&&(pa=bf.Box4ColorHelper.Xua(Ma));Ma={};Ma.currentColor=pa;Ma.handleCommand=Mc.a.jsd;return this.ia.Ia(Mc.a.renderColorPicker,2,Ma)}tXj(z,Z,pa,Fa,Ma){if(1===pa)return this.ia.Ia(Mc.a.jma,pa,Ma);if(!Ma)return Qc.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;z=this.ia.Ia(Mc.a.jma,pa,Ma);32===
z&&this.ia.Ia(Mc.a.WDa,pa,Ma);return z}XAd(z){this.RKe?Eh.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.pB&&(this.pB.FUb=1,this.pB.Oxh(z))}v_j(z,Z){this.uS.C1a=new Date;(z=z.result)?this.mRi(z,Z):(Z=Object.assign(new tj.a,{Code:94}),this.ucc(Z))}mRi(z,Z){const pa=this.oa.Xe(),Fa=this.Eb.ud(15);try{Fa.mc(this.l5b);Fa.Wc=Z;for(const Ma of pa)Ma.ND=z.ItemId}finally{Fa&&Fa.dispose()}if(z=vg.a.Kb)z.actionName="FormatBackgroundPicture",z.Wa("PictureUploadStart",vg.a.Ef(this.uS.olb)),
z.Wa("PictureUploadDurationMS",(+this.uS.C1a-+this.uS.olb).toString())}ucc(z){this.uS.C1a=new Date;this.fe.iI(z.Code,Z=>{Z.yD=1;Z.YUa=z.ExtraErrorParam;return!1})}static Xqd(z){return Pi.a.parse(z.Color)}}Object(k.a)(Qi,"FormatBackgroundActor",null,[948]);var fi=d(76),Ng=d(33),$d=d(427),Qf=d(32),Cg=d(157);const rh=z=>{let Z=z.isBold?"b:1;":"";Z+=z.isItalic?"i:1;":"";Z+=z.VD?"u:1;":"";Z+=z.zC?"s:1;":"";Z+=z.isSuperscript?"sup:1;":"";return Z+=z.nF?"sub:1;":""},ge=(z,Z,pa)=>{let Fa=null;for(var Ma,
tb=Ng.ParagraphReader.text(z),Hb=0;z.Sa&&Hb<z.Sa.length;){var rc=z.Sa.ga(Hb),yc=rc.cp;Ma=Hb<z.Sa.length-1?z.Sa.ga(Hb+1).cp:Ng.ParagraphReader.textLength(z);if(-1!==Z&&Ma<=Z)Hb++;else{if(-1!==pa&&yc>pa)break;var xc="";rc.formatting?xc=rh(rc.formatting.cache):(rc=$d.c(z.Sa,rc.cp).$9c)&&(xc=rh(rc.cache));rc=yc;-1!==Z&&(rc=Math.max(Z,yc));yc=Ma;-1!==pa&&(yc=Math.min(pa,Ma));yc=Ob.a.substring(tb,rc,yc);0<yc.length&&(Ma=document.createElement("span"),Ma.setAttribute("style",xc),Ma.innerText=yc,Fa||(Fa=
document.createElement("p")),Fa.appendChild(Ma));Hb++}}if(Fa&&Ng.ParagraphReader.tY(z)){Z=Fa;pa=Z.setAttribute;Hb=new Qf.GraphIterator;Hb.set(z);Hb.uc(11);Hb.Ug(11);tb="";if(z.eg.Aw(Hb))switch(Hb=z.eg.Aw(Hb),z=Ng.ParagraphReader.flb(z),xc=Hb.BY,Hb.listType){case 0:switch(Hb.listStyle){case 1:tb="decimal";break;case 2:tb="loweralpha";break;case 3:tb="lowerroman";break;case 4:tb="upperalpha";break;case 5:tb="upperroman";break;default:tb="decimal"}tb=String.format("lt:{0};in:{1};li:{2}",tb,z,xc);break;
case 1:switch(Hb.listStyle){case 1:tb="disc";break;case 2:tb="circle";break;case 3:tb="square";break;default:tb="disc"}tb=String.format("lt:{0};in:{1}",tb,z)}pa.call(Z,"style",tb)}return Fa},bi=z=>{if(z){var Z;(Z=ia.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?Z=Z.XO(z):(Qc.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),Z=null);if(Z){z=null;Z=Z.Tcb();for(let pa=0;pa<Z.length;pa++){const Fa=Og(Object(w.a)(fi.AParagraphNode,Z[pa].U9b));z=Ki(Fa,z)}return z}z=Array.isArray(z.aA())?
z.aA():null;return Og(z&&0<z.length?z[0]:null)}return null},Og=z=>{let Z=null;for(;z;){const pa=ge(z,-1,-1);Z=Ki(pa,Z);z=Ng.ParagraphReader.uva(z,!1,!0,!1)}return Z},Ki=(z,Z)=>{z&&(Z||(Z=document.createElement("div")),Z.appendChild(z));return Z},sk=z=>{const Z=Object.assign(new Cg.a,{Source:6});ia.a.instance.resolve("PowerPointWebEditor.IErrorHandler").At(Z,z,pa=>{pa.yD=1;pa.GEa=0;pa.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;pa.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;
return!1})};class kk{constructor(z,Z,pa,Fa,Ma){this.DUg=!1;this.xjd="";if(!z)throw Error.argumentNull("actionManager");if(!Z)throw Error.argumentNull("focusManager");if(!pa)throw Error.argumentNull("pptSelectionManager");if(!Ma)throw Error.argumentNull("appSettingsManager");this.ia=z;this.Fa=Z;this.gb=pa;const tb=new Date;Fa("immersiveReader").then(()=>{this.DUg=!0;Qc.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+tb)}).catch(Hb=>{const rc=+new Date-
+tb;Qc.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",rc,Hb.toString());const yc=new Map;yc.set("JSLoadDurationInMs",rc.toString());yc.set("Exception",Hb.toString());m.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new sa.a,{extendedProperties:yc}))})}qb(){this.ia.xa(Mc.a.z4c,Zc.a.view,Object(ib.a)(this,this.Rwg,"immersiveReaderHandler"));this.ia.xa(Mc.a.cpe,Zc.a.view,Object(ib.a)(this,this.Rwg,"immersiveReaderHandler"))}Sd(){this.Fa.Kc(cd.a.wR).bindAction(ub.KeyInputManager.Va(qc.a.mVb,
ub.KeyInputManager.Ze|4),Mc.a.z4c)}euj(z){let Z="";for(z=Object(w.a)(fi.AParagraphNode,z.node);z;){const pa=Ng.ParagraphReader.uva(z,!0,!0,!1);if(pa)z=pa;else break}for(;z;)Z+="\n"+Ng.ParagraphReader.text(z),z=Ng.ParagraphReader.uva(z,!1,!0,!1);return Z}DKi(){var z=this.gb.Xe();let Z=null;if(!z)return null;for(const pa of z)if(z=pa.lWa())for(const Fa of z)z=bi(Fa),Z=Ki(z,Z);return Z}CKi(){let z=null;var Z=this.gb.Oa;if(!Z)return null;for(const Ma of Z)if(Ma)for(Z=0;Z<Ma.length;Z++){var pa=Ma.ga(Z),
Fa=null;if(pa.contextId===Zc.a.outline||pa.contextId===Zc.a.Xf)if(Ng.ParagraphReader.ke(pa.node)){for(pa=Object(w.a)(fi.AParagraphNode,pa.node);pa;)if(Fa=Ng.ParagraphReader.uva(pa,!0,!0,!1))pa=Fa;else break;Fa=Og(pa)}else Fa=bi(Object(w.a)(4,pa.node));else pa.contextId!==Zc.a.endOfParagraph&&Ng.ParagraphReader.ke(pa.node)&&(Fa=ge(Object(w.a)(fi.AParagraphNode,pa.node),pa.Ra,pa.Pb));z=Ki(Fa,z)}return z}HKi(){let z;return(z=this.gb.Js()?this.DKi():this.CKi())?z.innerHTML:""}rPj(){let z="";const Z=this.gb.Oa.kb;
if(Z)for(let pa=0;pa<Z.length;pa++){const Fa=Z.ga(pa),Ma=Fa.Ra,tb=Fa.Pb-Ma;let Hb;if(Ng.ParagraphReader.ke(Fa.node))switch(Hb=Fa.node.characterData,Fa.contextId){case Zc.a.paragraph:z+=Hb+"\r";break;case Zc.a.textRange:0<tb&&(z+=Hb.substr(Ma,tb));break;case Zc.a.endOfParagraph:z+="\r";break;case Zc.a.Xf:z+=this.euj(Fa)}}return z}qIg(){const z=new XMLHttpRequest,Z=ia.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var pa=ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
pa=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",pa,Z);z.open("GET",pa,!0);const Fa=ka.a.create().toString();z.setRequestHeader("X-UserSessionId",H.AFrameworkApplication.userSessionId);z.setRequestHeader("X-CorrelationID",Fa);z.setRequestHeader("X-WacCluster",ia.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").$k);let Ma=null;const tb=new Map;z.onreadystatechange=()=>{var Hb;if(4===z.readyState)if(200===z.status){var rc=+new Date-+Ma;Qc.a.J(512500567,822,
50,"ImmersiveReader: auth token received. Duration (ms): {0}",rc);tb.set("AuthTokenDurationInMs",rc.toString());rc=z.responseText.replace('"',"");const ld=new Date;var yc=Pf.a("EnableSendingHTMLToIR")?[{["content"]:this.xjd,["mimeType"]:"text/html"}]:[{["content"]:this.xjd}];yc={["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:yc};var {["launchAsync"]:xc}=window.immersiveReader;if(Pf.a("EnableUseUpdatedImmersiveReaderVersion")){const {["v0_7_1"]:{["launchAsync"]:wd,["CookiePolicy"]:t}}=
window.immersiveReader;yc=Object.assign({},yc);xc={["uiLang"]:null===(Hb=this.Lb)||void 0===Hb?void 0:Hb.appSettings.UICulture,["cookiePolicy"]:t.Enable,["allowFullscreen"]:!0};wd(rc,yc,xc).then(aa=>{aa=aa?aa.sessionId:"";const ra=+new Date-+ld,Na=+new Date-+Ma;Qc.a.J(508695828,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",ra,aa);tb.set("LaunchAsyncDurationInMs",ra.toString());tb.set("IRResponseSessionId",aa);tb.set("UserPerceivedDurationInMs",
Na.toString());m.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new sa.a,{extendedProperties:tb}))}).catch(aa=>{sk(Z);const ra=+new Date-+ld,Na=+new Date-+Ma;Qc.a.J(508695827,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",ra,aa);tb.set("LaunchAsyncDurationInMs",ra.toString());tb.set("ErrorJson",aa.toString());tb.set("UserPerceivedDurationInMs",Na.toString());m.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",
!1,!0,Object.assign(new sa.a,{extendedProperties:tb}))})}else xc(rc,null,yc,null).then(wd=>{wd=(wd=Object(w.a)(Object,wd))?wd.sessionId:"";const t=+new Date-+ld,aa=+new Date-+Ma;Qc.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",t,wd);tb.set("LaunchAsyncDurationInMs",t.toString());tb.set("IRResponseSessionId",wd);tb.set("UserPerceivedDurationInMs",aa.toString());m.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",
Object.assign(new sa.a,{extendedProperties:tb}))}).catch(wd=>{sk(Z);const t=+new Date-+ld,aa=+new Date-+Ma;Qc.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",t,wd);tb.set("LaunchAsyncDurationInMs",t.toString());tb.set("ErrorJson",wd.toString());tb.set("UserPerceivedDurationInMs",aa.toString());m.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new sa.a,{extendedProperties:tb}))})}else sk(Z),Hb=+new Date-
+Ma,Qc.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Hb,z.status,Fa),tb.set("CorrelationId",Fa),tb.set("StatusCode",z.status.toString()),tb.set("UserPerceivedDurationInMs",Hb.toString()),m.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","RequestForAuthTokenFailed",!1,!0,Object.assign(new sa.a,{extendedProperties:tb}));else Qc.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",
Fa,z.status)};Ma=new Date;Qc.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",Ma.getTime(),Fa);pa=new Map;pa.set("CorrelationId",Fa);pa.set("Info","RequestingAuthToken");m.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,pa);z.send(null)}Rwg(z,Z,pa){if(1===pa||6===this.ia.oq){if(!this.DUg)return 8;this.xjd=Pf.a("EnableSendingHTMLToIR")?this.HKi():this.rPj();if(""===this.xjd)return 8}2===pa&&this.qIg();return 32}}Object(k.a)(kk,
"ImmersiveReaderActor",null,[948]);var Nj=d(594),rl=d(811);class cj{constructor(z){this.gu=null;this.zR=z}}Object(k.a)(cj,"PropertySetChangedState",null,[]);class bh{static qll(z,Z,pa){if(z&&Z){var Fa=new cj(Z),Ma=(tb,Hb,rc)=>{pa.pll(tb,Hb,rc,Fa)};z=new rl.a(Z,z);z.EOc=Ma;z.vRc=Ma;z.wvd=Ma;z.Zha()}}}Object(k.a)(bh,"PropertySetChangedManager",null,[]);class vi{constructor(z){this.Sli=z}pll(z,Z,pa,Fa){const Ma=this.Sli[z.id.toString()];Ma&&Ma(z,Z,pa,Fa)}}Object(k.a)(vi,"PropertyChangedProcessor",null,
[]);var xh=d(1135),hh=d(448),zf=d(60),Yh=d(593),Oa=d(408),sb=d(995);class Pb{constructor(){this.p_e=this.x$c=this.M4c=null}}Object(k.a)(Pb,"ParagraphDialogResults",null,[]);class kc extends qb.a{constructor(z,Z,pa){super(void 0,void 0,!0);this.gxa=null;if(null===z)throw Error.argumentNull("properties");this.Kga=z.clone();this.Paa=z.clone();this.IC=pa;this.ia=Z;this.tQk=new rb.a(Object(ib.a)(this,this.S5i,"createPropertyChangedHandlers"))}zAd(){this.Fg="ParagraphDialog";const z={};z.bodyControls=this.cge();
this.Vj(ResourceStrings.L_ParagraphDialogTitle,Object(ib.a)(this,this.u$d,"dialogResultHandler"),z)}u$d(z,Z){1===z&&(this.Hjm(Z),z=Object.assign(new Pb,{M4c:this.Kga,x$c:this.Paa,p_e:this.tQk}),this.ia.Ia(Mc.a.YYf,2,z));this.dispose()}cge(){this.gxa=kc.$ge();const z={};this.BYi(z);this.PXi(z);var Z=sb.a("Inch",3,0,56,.1);const pa=sb.a("Character",2,0,56,.1);Z=[Z,pa];this.dZi(z,Z);this.UXi(z,Z);Z=[sb.a("Point",5,0,1584,1)];this.VXi(z,Z);this.OXi(z,Z);this.CYi(z);return z}Hjm(z){this.Kgm(z);this.Bkm(z);
this.Zgm(z);this.$gm(z);this.Igm(z);this.Uim(z)}S5i(){const z={};z[zf.a.oF.id.toString()]=Object(ib.a)(this.IC,this.IC.quk,"justificationChangedHandler");z[zf.a.NMb.id.toString()]=Object(ib.a)(this.IC,this.IC.zsh,"paraIndentLeftChangedHandler");z[zf.a.OMb.id.toString()]=Object(ib.a)(this.IC,this.IC.zsh,"paraIndentLeftChangedHandler");z[zf.a.Fia.id.toString()]=Object(ib.a)(this.IC,this.IC.pbf,"specialIndentChangedHandler");z[zf.a.uSb.id.toString()]=Object(ib.a)(this.IC,this.IC.pbf,"specialIndentChangedHandler");
z[zf.a.vSb.id.toString()]=Object(ib.a)(this.IC,this.IC.pbf,"specialIndentChangedHandler");z[zf.a.Ay.id.toString()]=Object(ib.a)(this.IC,this.IC.Bwk,"lineSpacingChangedHandler");z[zf.a.RMb.id.toString()]=Object(ib.a)(this.IC,this.IC.Csh,"paraSpacingAfterChangedHandler");z[zf.a.QMb.id.toString()]=Object(ib.a)(this.IC,this.IC.Csh,"paraSpacingAfterChangedHandler");z[zf.a.UMb.id.toString()]=Object(ib.a)(this.IC,this.IC.Esh,"paraSpacingBeforeChangedHandler");z[zf.a.TMb.id.toString()]=Object(ib.a)(this.IC,
this.IC.Esh,"paraSpacingBeforeChangedHandler");return z}CYi(z){var Z=kc.sEj(this.Kga),pa="multiple"===Z;z.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:sb.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:Z,["allowFreeForm"]:!1};Z=0;let Fa=!1;this.Kga.Qa(zf.a.Ay)&&pa&&(Z=this.Kga.$a(zf.a.Ay),0<=Z&&(Fa=!0));pa=[sb.a("none",0,0,9.99,.5)];pa={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:pa,["numberFormatInfo"]:this.gxa,
["validReservedValues"]:[""]};pa.value=Fa?Z:"";z.atSpinButtonProps=pa}OXi(z,Z){const pa=kc.qgg(this.Kga,zf.a.RMb,zf.a.QMb);z.afterSpacingSpinButtonProps=kc.Bzd(pa,{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Yh.a.u6b(5),["validUnits"]:Z,["numberFormatInfo"]:this.gxa,["validReservedValues"]:[""]})}VXi(z,Z){const pa=kc.qgg(this.Kga,zf.a.UMb,
zf.a.TMb);z.beforeSpacingSpinButtonProps=kc.Bzd(pa,{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Yh.a.u6b(5),["validUnits"]:Z,["numberFormatInfo"]:this.gxa,["validReservedValues"]:[""]})}UXi(z,Z){const {Nrh:pa,Orh:Fa}=kc.lkg(this.Kga,zf.a.OMb,zf.a.NMb,!1);Z={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Yh.a.u6b(Fa),["validUnits"]:Z,["numberFormatInfo"]:this.gxa,["validReservedValues"]:[""]};Z=kc.Bzd(pa,Z);z.beforeTextSpinButtonProps=Z}dZi(z,Z){const pa={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:sb.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,
Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},Fa=this.Kga.Qa(zf.a.Fia)?this.Kga.$a(zf.a.Fia):-1;kc.LFg(Fa)?pa.selectedKey=Fa.toString():pa.defaultSelectedKey="";z.specialIndentationComboBoxProps=pa;const {Nrh:Ma,Orh:tb}=kc.lkg(this.Kga,zf.a.vSb,zf.a.uSb,1!==Fa&&2!==Fa);Z={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:Yh.a.u6b(tb),["validUnits"]:Z,["numberFormatInfo"]:this.gxa};Z=kc.Bzd(Ma,Z);z.bySpinButtonProps=Z}PXi(z){const Z={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:sb.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],
["1","2","3","6"]),["allowFreeForm"]:!1},pa=this.Kga.Qa(zf.a.oF)?this.Kga.$a(zf.a.oF):0;kc.Mkk(pa)?Z.selectedKey=pa.toString():Z.defaultSelectedKey="";z.alignmentComboBoxProps=Z}BYi(z){z.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};z.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};
z.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}Uim(z){if(z.lineSpacingComboBoxProps){var Z=z.lineSpacingComboBoxProps;const pa=Z.selectedKey?Z.selectedKey.toString():"";Z=sb.c(pa);"multiple"===pa&&(z=z.atSpinButtonProps)&&(Z=parseFloat(z.value.toString()));this.Paa.setValue(zf.a.Ay,Z);this.Paa.setValue(zf.a.EY,2)}}Igm(z){if(z.afterSpacingSpinButtonProps){z=z.afterSpacingSpinButtonProps;var Z=Yh.a.t6b(z.unitType.toString().toLowerCase());
""!==z.value.toString()&&(Z=4===Z?2:4,this.Paa.setValue(zf.a.RMb,parseInt(z.value.toString())),this.Paa.setValue(zf.a.QMb,Z))}}$gm(z){if(z.beforeSpacingSpinButtonProps){z=z.beforeSpacingSpinButtonProps;var Z=Yh.a.t6b(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(Z=4===Z?2:4,this.Paa.setValue(zf.a.UMb,parseInt(z.value.toString())),this.Paa.setValue(zf.a.TMb,Z))}}Zgm(z){if(z.beforeTextSpinButtonProps){var Z=z.beforeTextSpinButtonProps;z=Yh.a.t6b(Z.unitType.toString().toLowerCase());
if(""!==Z.value.toString()){Z=parseFloat(Z.value.toString());let pa;2===z?pa=2:(pa=1,Z=Yh.a.s0h(Z,z));this.Paa.setValue(zf.a.OMb,Z);this.Paa.setValue(zf.a.NMb,pa)}}}Bkm(z){var Z=z.bySpinButtonProps,pa=z.didChangeSpecialIndentationComboBoxValue;if(Z&&""!==Z.value.toString()||pa)if(z.specialIndentationComboBoxProps&&(z=z.specialIndentationComboBoxProps,pa=-1,z.selectedKey&&(z=z.selectedKey.toString(),pa=parseInt(z)),kc.LFg(pa)&&this.Paa.setValue(zf.a.Fia,pa)),Z){z=parseFloat(Z.value.toString());Z=Yh.a.t6b(Z.unitType.toString().toLowerCase());
if(0>z||isNaN(z))z=0;2===Z?pa=2:(pa=1,z=Yh.a.s0h(z,Z));this.Paa.setValue(zf.a.vSb,z);this.Paa.setValue(zf.a.uSb,pa)}}Kgm(z){z.alignmentComboBoxProps&&(z=z.alignmentComboBoxProps,z.selectedKey&&(z=parseInt(z.selectedKey.toString()),0<=z&&this.Paa.setValue(zf.a.oF,z)))}static qgg(z,Z,pa){if(z.Qa(Z)&&z.Qa(pa)){pa=z.$a(pa);if(2!==pa&&4!==pa)return Number.NaN;z=z.$a(Z);2===pa&&(z*=kc.sgl);return z}return Number.NaN}static Bzd(z,Z){Z.value=isNaN(z)?"":z;return Z}static $ge(){return{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static lkg(z,Z,pa,Fa){let Ma=3;Pf.a("BySpinButtonDefaultvalueFix")&&Fa?Z=0:z.Qa(Z)&&z.Qa(pa)&&!Fa?(Z=z.$a(Z),2===z.$a(pa)?Ma=2:Z=Yh.a.fnm(Z,Ma)):Z=Number.NaN;return{Nrh:Z,Orh:Ma}}static Mkk(z){return 1===z||2===z||3===z||6===z}static LFg(z){return 1===z||2===z||0===z}static sEj(z){if(kc.n1j(z)){z=z.$a(zf.a.Ay);var Z="multiple";Oa.a.cA(z,1)?Z="1.00":Oa.a.cA(z,
1.5)?Z="1.50":Oa.a.cA(z,2)&&(Z="2.00");return Z}}static n1j(z){return z.Qa(zf.a.Ay)&&z.Qa(zf.a.EY)&&2===z.$a(zf.a.EY)?!0:!1}}kc.sgl=72;Object(k.a)(kc,"ReactParagraphDialog",qb.a,[]);class Wc{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld){this.fEe=[];this.ia=z;this.oa=Z;this.aha=pa;this.Uaa=Fa;this.Eb=Ma;this.Uh=tb;this.eKa=Hb;this.Ga=rc;this.IC=yc;this.Yga=xc;this.zdh=ld}qb(){this.ia.pa(Mc.a.CFb,Zc.a.application,Object(ib.a)(this,this.Icl,"paragraphDialogHandler"),4);this.ia.pa(Mc.a.YYf,Zc.a.application,
Object(ib.a)(this,this.QWi,"commitParagraphDialogHandler"),4);this.ia.pa(Mc.a.xyh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.nyh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.Lyh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.Myh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.Kyh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.Jyh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.ryh,Zc.a.view,hh.a.V2,96);this.ia.pa(Mc.a.syh,Zc.a.view,hh.a.V2,96);this.ia.xa(Mc.a.yrh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.OTh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.cxg,Zc.a.view,
hh.a.jI);this.ia.xa(Mc.a.RTh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.QTh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.zrh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.Arh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.urh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.PTh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.trh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.Crh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.Brh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.STh,Zc.a.view,hh.a.jI);this.ia.xa(Mc.a.mtd,Zc.a.paragraph,Object(ib.a)(this,this.dJj,"getPropertiesForParagraphDialog"));this.ia.xa(Mc.a.mtd,
Zc.a.view,this.Yga);this.ia.pe(Mc.a.mtd,96)}Sd(){}Icl(z,Z,pa){if(this.oa.Js()||this.oa.P$())return 16;z=this.oa.Hd();if(!this.Ga.a1(z,!0).length&&!this.oa.nna())return 16;if(1===pa)return 32;this.zdh&&Qc.a.J(508360609,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.oq,"PptRibbon.Home"===this.ia.Tta);Array.clear(this.fEe);this.ia.nb(Mc.a.mtd,2);return(pa=Nj.APropertySet.xDj(this.fEe))?((new kc(pa,this.ia,this.IC)).zAd(),32):16}QWi(z,Z,pa,Fa,Ma){if(1===pa)return 32;
if(!(Ma&&Ma.M4c&&Ma.x$c&&Ma.p_e))return 16;Z=this.oa.Pk();this.IC.I8j();pa=this.Eb.xe(15);try{pa.mc(Z),pa.Wc=z,Ma.M4c.equals(Ma.x$c)||this.pVi(),bh.qll(Ma.M4c,Ma.x$c,new vi(Ma.p_e.value))}finally{pa&&pa.dispose()}if(this.zdh){const {a8h:tb,b8h:Hb,d8h:rc,c8h:yc,$7h:xc,e8h:ld}=this.IC.o9l();Qc.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",tb,Hb,rc,yc,xc,ld)}vg.a.CQ(!0,
!0);return 32}dJj(z,Z,pa){if(1===pa)return 32;Z=Z.node;z=new xh.DictionaryPropertySet;z.setValue(zf.a.oF,this.Uh.zM(Z));pa=this.aha.dWa(Z);z.setValue(zf.a.EY,pa.unit);z.setValue(zf.a.Ay,pa.value);pa=this.aha.dY(Z);z.setValue(zf.a.TMb,pa.Rr.unit);z.setValue(zf.a.UMb,pa.Rr.value);z.setValue(zf.a.QMb,pa.Pr.unit);z.setValue(zf.a.RMb,pa.Pr.value);pa=this.Uaa.o$(Z);z.setValue(zf.a.NMb,1);z.setValue(zf.a.OMb,pa.hO);Z=this.eKa.mWa(Z);z.setValue(zf.a.Fia,Z.specialIndentType);z.setValue(zf.a.uSb,Z.unit);z.setValue(zf.a.vSb,
Z.value);this.fEe.push(z);return 32}pVi(){if(this.oa.nI()){var z=this.oa.Hd();z=this.Ga.a1(z);for(const Z of z)Z.Vua()}}}Object(k.a)(Wc,"ParagraphDialogActor",null,[948]);var Xd;(function(z){z[z.unspecified=-1]="unspecified";z[z.none=0]="none";z[z.left=1]="left";z[z.center=2]="center";z[z.right=3]="right";z[z.inner=4]="inner";z[z.outer=5]="outer";z[z.both=6]="both";z[z.distribute=7]="distribute";z[z.margin=8]="margin";z[z.highKashida=9]="highKashida";z[z.lowKashida=10]="lowKashida";z[z.mediumKashida=
11]="mediumKashida";z[z.numTab=12]="numTab";z[z.thaiDistribute=13]="thaiDistribute";z[z.start=14]="start";z[z.end=15]="end"})(Xd||(Xd={}));Object(k.b)("Justification",Xd);var Gd=d(590);class Pe{constructor(){this.value=this.unit=0}}Object(k.a)(Pe,"ParagraphSpacingCommandData",null,[]);class Lf{constructor(){this.KTh=this.Ash=this.Dsh=this.Fsh=!1}}Object(k.a)(Lf,"PptPropertySetChangedState",null,[]);class Nf{constructor(z){this.Uxe=this.Yve=this.Sxe=this.Txe=this.lwe=this.fwe=!1;this.zlc={};this.ia=
z;this.N8j()}quk(z,Z,pa){pa&&(z=this.zlc[Xd[pa]],void 0!==z&&null!==z&&(this.ia.nb(z,2),this.fwe=!0))}Bwk(z,Z,pa){void 0!==pa&&null!==pa&&(this.ia.Ia(Mc.a.Ypa,2,pa),this.lwe=!0)}Esh(z,Z,pa,Fa){void 0!==pa&&null!==pa&&(z=Nf.OZc(Fa),!z.Fsh&&null!==Fa&&Fa.zR.Qa(zf.a.TMb)&&Fa.zR.Qa(zf.a.UMb)&&(Z=Fa.zR.$a(zf.a.UMb),Fa=Fa.zR.$a(zf.a.TMb),z.Fsh=!0,this.ia.Ia(Mc.a.C3a,2,Object.assign(new Pe,{value:Z,unit:Fa})),this.Txe=!0))}Csh(z,Z,pa,Fa){void 0!==pa&&null!==pa&&(z=Nf.OZc(Fa),!z.Dsh&&null!==Fa&&Fa.zR.Qa(zf.a.QMb)&&
Fa.zR.Qa(zf.a.RMb)&&(Z=Fa.zR.$a(zf.a.RMb),Fa=Fa.zR.$a(zf.a.QMb),z.Dsh=!0,this.ia.Ia(Mc.a.B3a,2,Object.assign(new Pe,{value:Z,unit:Fa})),this.Sxe=!0))}zsh(z,Z,pa,Fa){void 0!==pa&&null!==pa&&(Z=Nf.OZc(Fa),!Z.Ash&&null!==Fa&&Fa.zR.Qa(zf.a.NMb)&&Fa.zR.Qa(zf.a.OMb)&&(z=Fa.zR.$a(zf.a.OMb),Fa=Fa.zR.$a(zf.a.NMb),Z.Ash=!0,Z=new Gd.a,Z.unit=Fa,Z.value=z,this.ia.Ia(Mc.a.Uma,2,Z),this.Yve=!0))}pbf(z,Z,pa,Fa){void 0!==pa&&null!==pa&&(pa=Nf.OZc(Fa),!pa.KTh&&null!==Fa&&Fa.zR.Qa(zf.a.uSb)&&Fa.zR.Qa(zf.a.vSb)&&(Z=
0,Fa.zR.Qa(zf.a.Fia)&&(Z=Fa.zR.$a(zf.a.Fia)),z=Fa.zR.$a(zf.a.vSb),Fa=Fa.zR.$a(zf.a.uSb),pa.KTh=!0,pa=0,1===Z?pa=Mc.a.Xnb:2===Z?pa=Mc.a.Ynb:0===Z&&(pa=Mc.a.Znb),Z=new Gd.a,Z.unit=Fa,Z.value=z,this.ia.Ia(pa,2,Z),this.Uxe=!0))}o9l(){return{a8h:this.fwe,b8h:this.lwe,d8h:this.Txe,c8h:this.Sxe,$7h:this.Yve,e8h:this.Uxe}}I8j(){this.Uxe=this.Yve=this.Sxe=this.Txe=this.lwe=this.fwe=!1}N8j(){this.zlc.left=Hd.a.leftJustify;this.zlc.center=Hd.a.centerJustify;this.zlc.right=Hd.a.rightJustify;this.zlc.both=Hd.a.fullJustify}static OZc(z){z.gu||
(z.gu=new Lf);return z.gu}}Object(k.a)(Nf,"ParagraphLevelPropertyChangedHandlers",null,[1072]);var dg=d(543),Pg=d(197),pi=d(276),li=d(353),Ri=d(40),Ih=d(50),ij=d(82),Fi=d(158);class Da{constructor(z,Z){this.Hzb=z;this.Rh=Z}}Object(k.a)(Da,"DoNotCheckCritiqueTypeActionData",null,[]);var Wa=d(19);class lb{D$a(z){return(z=Object(w.a)(Da,z))?Object(Wa.a)(li.a,z.Rh):!1}QVe(z,Z){if(Z=Object(w.a)(Da,Z)){const pa=Z.Rh;pa&&(pa.DOa(z,Z.Hzb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",
Z.Hzb))}}}Object(k.a)(lb,"DoNotCheckCritiqueTypeCallback",null,[1157]);var Lb=d(471),oc=d(49);class Jc extends Lb.a{constructor(z,Z,pa,Fa,Ma,tb,Hb){super();this.JPe=null;this.init(z);this.Fm("WholePresentationOperation");this.eHa(H.AFrameworkApplication.Pa,Z,pa,Fa,Ma);this.eib=0;this.Bfh=Hb;this.wTg=tb;this.yIa=Ma;this.Ihc=Z;this.D$a()?1===this.behavior&&(this.Op=32,this.i_()):(this.Op=8,this.i_())}Lh(){0===this.eib&&this.l9e();1===this.eib&&this.XZe();2===this.eib&&this.Edf();3===this.eib&&this.$de()}D$a(){return this.Bfh.D$a(this.yIa)}QVe(){this.Bfh.QVe(this.Ihc,
this.yIa)}l9e(){this.JPe=new oc.GraphTransaction(3);this.JPe.mc(this.wTg.node);this.eib=1}XZe(){this.ox||this.Hnb(this.wTg.GF);1!==this.hqa()&&(this.eib=2)}Edf(){this.QVe();this.JPe.dispose();this.eib=3}$de(){this.i_()}}Object(k.a)(Jc,"WholePresentationOperation",Lb.a,[]);var bd=d(51);class rd{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd){this.$Ga=!1;this.ia=z;this.ALg=Z;this.dH=pa;this.Eb=Fa;this.Ibd=Ma;this.sa=tb;this.Ga=Hb;this.aba=ld;this.tKe=rc;this.bE=yc;this.gb=wd;this.Ljd=xc.POh;this.PLk=
xc.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.mLk=xc.pptHideProofingErrorIsEnabled;this.x$j()}get f7b(){return this.dH.aYa?this.Ibd.instance:null}qb(){this.ia.pa(Mc.a.jOb,bd.a.application,Object(ib.a)(this,this.jOb,"queryLanguage"),96);this.ia.pa(Mc.a.zqd,bd.a.application,Object(ib.a)(this,this.jbl,"openPPTLanguageDialogView"),4);this.dH.zCg&&this.ia.pa(Hd.a.s4c,Zc.a.Xf,Object(ib.a)(this,this.s4c,"ignoreProofingError"),4);this.dH.Zue&&(this.PLk?(this.ia.xa(Hd.a.dzb,Zc.a.paragraph,Object(ib.a)(this,
this.H6f,"doNotCheckThisCritiqueTypeForNode")),this.ia.xa(Hd.a.dzb,Zc.a.section,Object(ib.a)(this,this.H6f,"doNotCheckThisCritiqueTypeForNode")),this.ia.gU(Hd.a.dzb,Zc.a.Xf,Object(ib.a)(this,this.rdj,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.pa(Mc.a.c8b,Zc.a.Xf,Object(ib.a)(this,this.c8b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.pa(Hd.a.dzb,Zc.a.Xf,Object(ib.a)(this,this.c8b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.mLk&&(this.ia.pa(Mc.a.dtd,bd.a.application,Object(ib.a)(this,
this.dtd,"queryHideProofingErrors"),100),this.ia.pa(Mc.a.ovg,bd.a.application,Object(ib.a)(this,this.sam,"toggleHideProofingErrors"),4))}Sd(){}x$j(){this.$Ga=rd.ioe;e.ULS.sendTraceTag(508694594,375,50,"Initialized with hide proofing errors: {0}",this.$Ga);this.$Ga&&this.lvg(this.$Ga)}dtd(z,Z,pa,Fa,Ma){if(1===pa)return 32;if(!Ma)return 8;Ma[dg.a.On]=this.$Ga;return 32}sam(z,Z,pa,Fa,Ma){if(1===pa)return 32;if(!(Ma&&dg.a.On in Ma))return 8;this.$Ga=Ma[dg.a.On];rd.ioe=this.$Ga;this.lvg(this.$Ga);e.ULS.sendTraceTag(508694593,
375,50,"User hide proofing errors: {0}",this.$Ga);return 32}H6f(z,Z,pa,Fa,Ma){if(!Z)return 8;z=Z.node;if(!z)return 8;if(Z.contextId===Zc.a.section&&!z.ra(Fi.a.ove,!1))return 32;if(Z.contextId===Zc.a.paragraph&&z.ra(Fi.a.R5,!1)){Z=Object(w.a)(Da,Ma);if(!Z)return 8;Ma=Z.Rh;if(!Ma)return 8;Z.Hzb+=this.iDh(z,Ma.typeId,Ma.lcid)}return 2}rdj(z,Z,pa,Fa,Ma){var tb=this.Dyj();tb=new Da(0,tb);this.ia.Ai(pa,Mc.a.c8b,Fa,!1,Ma,tb);pa=Ih.a.create(Object(w.a)(ij.a,this.sa.presentation));e.ULS.sendTraceTag(508694592,
375,50,"User click do not check this critique for whole doc with behavior: {0}",Fa);return new Jc(z,Z,Fa,Ma,tb,pa,new lb)}c8b(z,Z,pa,Fa,Ma){z=Object(w.a)(Da,Ma);if(!z)return 8;Fa=z.Rh;if(!Fa)return 8;if(1===pa)return 32;if(!Z.node)return 8;e.ULS.sendTraceTag(508694563,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",Fa.lcid,Fa.typeId);z.Hzb+=this.Tzl(Fa.typeId,Fa.lcid);this.f7b&&this.f7b.ccj(Fa.lcid.toString(),Fa.typeId);return 32}s4c(z,Z,pa){if(1===pa)return 32;
e.ULS.sendTraceTag(508694562,375,50,"Ignore proofing error triggerred");pa=this.bE.NVa(Z);if(!pa||!pa.Rh)return 8;Z=Z.node;var Fa=this.sa.Aa;if(!Z||!Fa)return 8;Fa=this.Eb.xe(rd.uQj(pa));try{Fa.mc(Z),this.bE.TMa(Z,[pa],!0),Z.setValue(Ri.a.MZf,!0)}finally{Fa&&Fa.dispose()}pa.Rh.DOa(z,1);this.gb.kYa()||vg.a.CQ(!0,!1);e.ULS.sendTraceTag(508694561,375,50,"Ignore proofing error action succeeded");return 32}lvg(z){this.aba.Z9e=z}Dyj(){var z=this.gb.Oa.kb;if(!z)return null;z=this.bE.NVa(z.Ua);if(!z||!z.Rh)return null;
z=Object(w.a)(li.a,z.Rh);return!z||0>=z.lcid?null:z}Tzl(z,Z){const pa=new Date;if(!this.sa.Aa)return 0;const Fa=this.sa.Aa.yj();if(!Fa)return 0;let Ma=0,tb=0;const Hb=this.Eb.xe(3);try{Hb.mc(this.sa.Aa);for(const rc of Fa)this.Ga.lH(rc,yc=>{++tb;yc.Qa(Ri.a.np)&&yc.ra(Fi.a.R5,!1)&&(Ma+=this.iDh(yc,z,Z))})}finally{Hb&&Hb.dispose()}e.ULS.sendTraceTag(508694560,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-
+pa,tb,Fa.length,Ma);return Ma}iDh(z,Z,pa){const Fa=this.bE.KG(z,Ma=>{Ma=Object(w.a)(li.a,Ma.Rh);return!!Ma&&Ma.typeId===Z&&Ma.lcid===pa});if(Pg.a.Ta(Fa))return 0;this.bE.TMa(z,Fa);return Fa.length}jOb(z,Z,pa,Fa,Ma){Ma.tQc=this.VDj();return 32}VDj(){let z=H.AFrameworkApplication.lcid;if(this.gb.u1(this.gb.Oa)){var Z=this.gb.Hd();if(1<Z.length||1!==Z.length)return"";Z=this.Ga.VVa(Z[0]);0<Z&&(z=Z)}else this.gb.Oa.kb&&(Z=this.tKe.F0c(this.gb.Ik),0<Z&&(z=Z));return pi.a.Oe(z)?pi.a.Oe(z).displayName:pi.a.Oe(H.AFrameworkApplication.lcid).displayName}hqk(){const z=
this.gb.Hd();return 1===z.length&&z[0].v8c}jbl(z,Z,pa){if(2!==pa)return 32;this.Ljd&&this.gb.u1(this.gb.Oa)&&this.hqk()?(e.ULS.sendTraceTag(508694558,806,50,"Set proofing language on shape level."),this.ALg.value.getInstance(!0).Syc()):this.gb.Oa.kb&&(e.ULS.sendTraceTag(508694557,806,50,"Set proofing language in text edit view."),this.ALg.value.getInstance(!1).Syc());return 32}static get ioe(){const z=va.a.get("PowerPointHideProofingErrors");return z?"true"===z.toLowerCase():!1}static set ioe(z){va.a.lL("PowerPointHideProofingErrors",
z.toString(),30)||e.ULS.sendTraceTag(508694556,375,10,"Failed to set cookie for hide proofing errors to {0}",z.toString())}static uQj(z){return 1===z.Rh.proofingType?15:3}}Object(k.a)(rd,"ProofingActor",null,[948]);var Zd=d(193),ea=d(595);class Ka{constructor(z,Z){this.Ld=z.toLowerCase();this.variant=Z}}Object(k.a)(Ka,"ThemeVariant",null,[]);var bb=d(1087);class vb{xtk(z){return!vb.iBb(vb.gnm)||z>vb.Oif?!0:!1}static iBb(z){return(z=document.getElementById(z))?z:null}static BJg(){const z=ia.a.instance.Ha("Common.ISystemInitiatedFeedback");
null!=z&&(e.ULS.sendTraceTag(508614482,813,50,"ThemeHelper::TriggerFpsForNewDefaultTheme Floodgate survey triggered"),z.execute(Z=>{Z.logActivity("NewDefaultThemeActivity","EnablePPTONewThemeFloodgateSurvey")}))}}vb.gnm="PptRibbon.Design.ThemeVariants-MaxSize";vb.Oif=4;Object(k.a)(vb,"ThemeHelper",null,[1108]);class Yb{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd,t,aa){this.tcd=null;this.ucd=0;this.DRg=this.scd=!1;this.l_g=null;this.Owb=new Ka("",0);this.Okd={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",
["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=z;this.Fa=Z;this.ic=pa;this.oa=Ma;this.Eb=Fa;this.Yb=Hb;this.sa=rc;this.Wb=yc;this.ETk=xc;this.hfd=ld;this.pVg=wd;this.cLk=t;Yb.b3d=aa.tc("NewThemeFloodgateSurveyDelayTime",3E5);t&&(this.Okd.ThemesOfficeTheme2023="2e142a2c-cd16-42d6-873a-c26d2a0506fa",aa.a8&&
aa.a8!=Yb.XNi||Zd.a.get_instance().Ij(8,()=>{window.setTimeout(()=>{vb.BJg()},Yb.b3d)}))}qb(){this.ia.pa(Mc.a.ow,bd.a.application,Object(ib.a)(this,this.Itg,"handleThemeChange"),4);this.ia.pa(Mc.a.AEa,bd.a.application,Object(ib.a)(this,this.Itg,"handleThemeChange"),4);this.ia.pa(Mc.a.htd,bd.a.application,Object(ib.a)(this,this.htd,"queryMoreThemeGallery"),96);this.ia.pa(Mc.a.Z_e,bd.a.application,Object(ib.a)(this,this.Z_e,"queryMoreVariantGallery"),96);this.ia.pa(Mc.a.Fz,bd.a.application,Object(ib.a)(this,
this.Fz,"queryThemes"),97);this.ia.pa(Mc.a.Xuc,bd.a.application,Object(ib.a)(this,this.Xuc,"queryThemeVariants"),97);this.ia.pa(Mc.a.$rd,bd.a.application,Object(ib.a)(this,this.$rd,"populateVariantGallery"),96)}Sd(){}Fz(z,Z,pa,Fa,Ma){Ma&&Ma.uW&&(z=this.Okd[Ma.uW]===this.pGa().Ld,Ma.e2a.Rf(z));return 32}Xuc(z,Z,pa,Fa,Ma){if(Ma&&Ma.uW){z=this.pGa();Z=z.Ld;pa=Ma.uW;try{var tb=Number.parseInvariant(pa.substring(pa.length-1,pa.length))}catch(Hb){tb=0}Ma=Ma.e2a;Ma.Rf(z.variant===tb);tb=Yb.Cfg(pa,tb,Z);
Ma.k5=tb}return 32}htd(z,Z,pa){if(Z.contextId!==Zc.a.application)return 2;z=this.oa.Pk();var Fa=this.pGa();Z=Yb.ZBb(Fa.Ld);Fa=Fa.variant-1;return this.ic.Xc(z)?16:1!==pa||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",Z,Fa),this.Wb.Hi())?32:8}Z_e(z,Z,pa){if(Z.contextId!==Zc.a.application)return 2;var Fa=this.oa.Pk();Z=this.pGa();z=Yb.ZBb(Z.Ld);Z=Z.variant-1;if(this.ic.Xc(Fa))return 16;if(1===pa)if(pa=Yb.Ibc(this.pGa().Ld),
Fa=this.ETk.xtk(pa),pa&&Fa)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",z,Z);else return 16;return 32}Itg(z,Z,pa,Fa,Ma){Z=this.oa.Xe();Fa=this.sa.Aa;if(!Fa||z===Mc.a.AEa&&this.pGa()===this.Owb||this.ic.Xc(Fa))return 16;if(1===pa)return 32;pa=Object(w.a)(String,Ma);if(null===pa)return 8;Ma=this.Okd[pa];return z===Mc.a.ow?this.xfl(Fa,Ma,Z):z===Mc.a.AEa?this.yfl(Fa,pa,Z):8}xfl(z,Z,pa){if(!z)return 16;1>=this.a0f()||
this.pVg&&pa&&1<pa.length?(this.N0d(z,Z,0,!1,pa),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Yb.ZBb(Z),0,z.Fb.sid)):(this.tcd=Z,this.ucd=0,this.scd=!1,z=new Vb.StandardDialog,z.Fd=1,z.vQ(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(ib.a)(this,this.QVf,"changeThemeHandler")));this.cLk&&this.Okd.ThemesOfficeTheme2023==Z&&window.setTimeout(()=>{vb.BJg()},Yb.b3d);return 32}yfl(z,Z,pa){if(!z)return 16;
const Fa=this.pGa();let Ma;try{if(Ma=Number.parseInvariant(Z.substring(7,Z.length))-1,0>Ma||Ma>Yb.Ibc(Fa.Ld))Ma=-1}catch(tb){Ma=-1}1>=this.a0f()||Pf.a("ApplyThemeVariantOnSelectedSlide")&&pa&&1<pa.length?(this.N0d(z,Fa.Ld,Ma,!0,pa),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Yb.ZBb(Fa.Ld),Ma,z.Fb.sid)):(this.tcd=Fa.Ld,this.ucd=Ma,this.scd=!0,z=new Vb.StandardDialog,z.Fd=1,z.vQ(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,
Object(ib.a)(this,this.QVf,"changeThemeHandler")));return 32}pGa(){let z=null;var Z=this.sa.Aa;if(Z){Z=Z.Oj;const Fa=this.Wb.YJ();if(Fa&&Z)for(var pa of Fa)if(pa.Id===Z){z=pa;break}}if(!z)return this.DRg?this.l_g:this.Owb;if(Object(Pf.a)("EnableNonEmptyGuidFixForThemeActor")){if(!z.ThemeFamilyId||Yb.ZBb(z.ThemeFamilyId)===Yb.KTf)return this.Owb}else if(!z.ThemeFamilyId||z.ThemeFamilyId===Yb.xNi)return this.Owb;pa="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===z.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===
z.ThemeFamilyId;return!this.hfd&&pa?this.Owb:new Ka(z.ThemeFamilyId,z.VariantIndex+1)}a0f(){const z=this.Wb.YJ();let Z=0;if(z)for(const pa of z)pa.InContent&&(Z+=1);return Z}QVf(z){const Z=this.sa.Aa;if(Z){var pa=this.tcd,Fa=this.ucd,Ma=this.scd;this.tcd=null;this.ucd=-1;this.scd=!1;1===z&&(this.N0d(Z,pa,Fa,Ma,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Yb.ZBb(pa),Fa,Z.Fb.sid))}}N0d(z,Z,pa,Fa,Ma){this.l_g=(this.DRg=Fa)?
new Ka(Z,0):this.Owb;const tb=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()},void 0,!0);try{if(tb.mc(z),tb.Wc=Fa?Mc.a.AEa:Mc.a.ow,this.pVg&&Ma)for(const Hb of Ma)Hb.setValue(Md.a.uef,Z),Hb.setValue(Md.a.Sca,pa),Hb.setValue(Md.a.dFi,1<Ma.length);else z.setValue(Md.a.uef,Z),z.setValue(Md.a.Sca,pa)}finally{tb&&tb.dispose()}this.ic.i4b(this.Yb.Of,z,"ChangeTheme")}$rd(z,Z,pa,Fa,Ma){if(1===pa)return 32;z=Math.max(Yb.Ibc(this.pGa().Ld),4);Z=this.pGa().Ld;Ma.MenuItems=Yb.CJj(z,Z);return 32}static Ibc(z){for(let Z=
0;Z<bb.a.UAa.length;++Z)if(bb.a.UAa[Z].QXc===z)return bb.a.UAa[Z].Oif;return 0}static ZBb(z){for(let Z=0;Z<bb.a.UAa.length;++Z)if(bb.a.UAa[Z].QXc===z)return bb.a.UAa[Z].$0h;return Yb.KTf}static Llj(z){let Z="";for(let pa=0;pa<bb.a.UAa.length;++pa)bb.a.UAa[pa].QXc===z&&(Z=bb.a.UAa[pa].$0h.replace(" ",""));return Z}static CJj(z,Z){const pa=Object.assign(new Me.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var Fa=Object.assign(new Bg.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",
DisplayMode:"Size85by48",ControlList:[]});Array.add(pa.MenuSectionList,Fa);const Ma=Object.assign(new ea.a,{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(Fa.ControlList,Ma);for(Fa=1;Fa<=z;++Fa)Array.add(Ma.GalleryItems,Yb.Cfg("Variant"+Fa,Fa,Z));return pa}static Cfg(z,Z,pa){pa=!Yb.Ibc(pa)||Z>Yb.Ibc(pa)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",
Yb.Llj(pa),Z);return Object.assign(new we.a,{Id:z,ExternalId:z,Icon:pa,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,Z),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}Yb.xNi="00000000-0000-0000-0000-000000000000";Yb.KTf="Unsupported Theme";Yb.XNi="blankNew";Yb.b3d=3E5;Object(k.a)(Yb,"ThemeActor",null,[948]);class Gc{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld){this.ia=z;this.Yb=
Z;this.sa=pa;this.oa=Ma;this.Fa=tb;this.Eb=Fa;this.lo=Hb;this.ic=rc;this.hYg=yc.Xmk;this.ho=yc.RD;this.qfd=yc.gok;this.Pmc=xc.Ok(ne.a.xrd);this.yb=ld}qb(){this.qfd?(this.hYg?(this.ia.pa(Mc.a.Jk,Zc.a.application,Object(ib.a)(this,this.OTl,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.pa(Mc.a.wk,Zc.a.application,Object(ib.a)(this,this.mol,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.pa(Mc.a.Vqa,Zc.a.application,Object(ib.a)(this,this.PTl,"setSlidesTransitionGalleryExisting"),5),
this.ia.pa(Mc.a.AAa,Zc.a.application,Object(ib.a)(this,this.QTl,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.pa(Mc.a.lqa,Zc.a.application,Object(ib.a)(this,this.nol,"querySlidesTransitionGalleryExisting"),97),this.ia.pa(Mc.a.Lza,Zc.a.application,Object(ib.a)(this,this.ool,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.pa(Mc.a.Jk,Zc.a.application,Object(ib.a)(this,this.F8e,"setSlidesTransitionGallery"),5),this.ia.pa(Mc.a.wk,Zc.a.application,Object(ib.a)(this,this.q0e,"querySlidesTransitionGallery"),
97),this.ia.pa(Mc.a.Vqa,Zc.a.application,Object(ib.a)(this,this.F8e,"setSlidesTransitionGallery"),5),this.ia.pa(Mc.a.AAa,Zc.a.application,Object(ib.a)(this,this.F8e,"setSlidesTransitionGallery"),5),this.ia.pa(Mc.a.lqa,Zc.a.application,Object(ib.a)(this,this.q0e,"querySlidesTransitionGallery"),97),this.ia.pa(Mc.a.Lza,Zc.a.application,Object(ib.a)(this,this.q0e,"querySlidesTransitionGallery"),97)),this.ia.pa(Mc.a.Txc,Zc.a.application,Object(ib.a)(this,this.NTl,"setSlidesTransitionEffectOption"),5),
this.ia.pa(Mc.a.Xtd,Zc.a.application,Object(ib.a)(this,this.kol,"querySlidesTransitionEffectOption"),97),this.ia.pa(Mc.a.fmb,Zc.a.application,Object(ib.a)(this,this.lol,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.pa(Mc.a.mNb,Zc.a.application,Object(ib.a)(this,this.xhl,"populateSlidesTransitionEffectOptions"),96),this.ia.pa(Mc.a.Kza,Zc.a.application,Object(ib.a)(this,this.jol,"querySlidesTransitionDuration"),97),this.ia.pa(Mc.a.bob,Zc.a.application,Object(ib.a)(this,this.MTl,"setSlidesTransitionDuration"),
5)):(this.hYg?(this.ia.pa(Mc.a.Jk,Zc.a.application,Object(ib.a)(this,this.HUl,"setTransitionGalleryExceptExisting"),5),this.ia.pa(Mc.a.wk,Zc.a.application,Object(ib.a)(this,this.Fol,"queryTransitionGalleryExceptExisting"),97),this.ia.pa(Mc.a.Vqa,Zc.a.application,Object(ib.a)(this,this.IUl,"setTransitionGalleryExisting"),5),this.ia.pa(Mc.a.AAa,Zc.a.application,Object(ib.a)(this,this.JUl,"setTransitionGalleryExistingInMenu"),5),this.ia.pa(Mc.a.lqa,Zc.a.application,Object(ib.a)(this,this.lqa,"queryTransitionGalleryExisting"),
97),this.ia.pa(Mc.a.Lza,Zc.a.application,Object(ib.a)(this,this.Lza,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.pa(Mc.a.Jk,Zc.a.application,Object(ib.a)(this,this.T8e,"setTransitionGallery"),5),this.ia.pa(Mc.a.wk,Zc.a.application,Object(ib.a)(this,this.wk,"queryTransitionGallery"),97),this.ia.pa(Mc.a.Vqa,Zc.a.application,Object(ib.a)(this,this.T8e,"setTransitionGallery"),5),this.ia.pa(Mc.a.AAa,Zc.a.application,Object(ib.a)(this,this.T8e,"setTransitionGallery"),5),this.ia.pa(Mc.a.lqa,Zc.a.application,
Object(ib.a)(this,this.wk,"queryTransitionGallery"),97),this.ia.pa(Mc.a.Lza,Zc.a.application,Object(ib.a)(this,this.wk,"queryTransitionGallery"),97)),this.ia.pa(Mc.a.Txc,Zc.a.application,Object(ib.a)(this,this.GUl,"setTransitionEffectOption"),5),this.ia.pa(Mc.a.Xtd,Zc.a.application,Object(ib.a)(this,this.Eol,"queryTransitionEffectOption"),97),this.ia.pa(Mc.a.fmb,Zc.a.application,Object(ib.a)(this,this.fmb,"queryTransitionEffectOptionsAnchor"),100),this.ia.pa(Mc.a.mNb,Zc.a.application,Object(ib.a)(this,
this.mNb,"populateTransitionEffectOptions"),96),this.ia.pa(Mc.a.Kza,Zc.a.application,Object(ib.a)(this,this.Kza,"queryTransitionDuration"),97),this.ia.pa(Mc.a.bob,Zc.a.application,Object(ib.a)(this,this.bob,"setTransitionDuration"),5));this.ia.pa(Mc.a.aob,Zc.a.application,Object(ib.a)(this,this.aob,"setTransitionApplyAll"),4);this.ia.pa(Mc.a.POb,Zc.a.application,Object(ib.a)(this,this.POb,"queryTransitionApplyAll"),96)}Sd(){}mNb(z,Z,pa,Fa,Ma){if(this.ho&&1!==this.oa.Xe().length)return 16;if(1===pa)return 32;
z=(z=this.sa.Aa)?z.qp:null;if(!z)return 16;if(!Ma)return 8;z=this.lo.aCb(z);z.next&&(Ma.MenuItems=this.tSf(z));return 32}wk(z,Z,pa,Fa,Ma){if(!Ma)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;Z=this.lo.HR(Ma);if(!Z)return 8;z.fGa=Gc.rfe(Z.Bc,Z.wc,this.Pmc);Z=this.sa.Aa;if(!Z)return 16;1===pa&&((pa=Z.qp)?(pa=this.lo.qWa(pa),z.sW(!pa&&"TransitionExisting"===Ma||pa===Ma)):z.sW("TransitionNone"===Ma));return 32}Fol(z,Z,pa,Fa,Ma){if(!Ma||z!==Mc.a.wk)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;Z=this.lo.HR(Ma);
if(!Z)return 8;Fa=Z.Bc.split("_")[1]+"_24";Z=Gc.vVa(Ma,Ma,Fa,"2024601249","149145197",Z.wc,Z.wc);z.k5=Z;Z=this.sa.Aa;if(!Z)return 16;1===pa&&((pa=Z.qp)?(pa=this.lo.qWa(pa),z.sW(pa===Ma)):z.sW("TransitionNone"===Ma));return 32}lqa(z,Z,pa,Fa,Ma){if(!Ma||z!==Mc.a.lqa)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;if(!Ma||"TransitionExisting"!==Ma)return 16;Z=this.lo.HR(Ma);if(!Z)return 8;Fa=Z.Bc.split("_")[1]+"_24";Z=Gc.vVa(Ma,Ma,Fa,"3752636652","3476251476",Z.wc,Z.wc);z.k5=Z;Z=this.sa.Aa;if(!Z)return 16;
if(1===pa&&(pa=Z.qp)){pa=this.lo.qWa(pa);Z=this.lo.r9c(pa,this.lo.iBb());if(pa&&!Z){Fa=this.lo.HR(pa);if(!Fa)return 8;const tb=Fa.Bc.split("_")[1]+"_24";Ma=Gc.vVa(Ma,Ma,tb,"3752636652","3476251476",Fa.wc,Fa.wc);z.k5=Ma}z.sW(!pa||!!pa&&!Z)}return 32}Lza(z,Z,pa,Fa,Ma){if(!Ma||z!==Mc.a.Lza)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;if(!Ma||"TransitionExistingInMenu"!==Ma)return 16;Z=this.lo.HR(Ma);if(!Z)return 8;Fa=Z.Bc.split("_")[1]+"_24";Ma=Gc.vVa(Ma,Ma,Fa,"4036532528","2831233208",Z.wc,Z.wc);
z.k5=Ma;Ma=this.sa.Aa;if(!Ma)return 16;1===pa&&(pa=Ma.qp)&&(pa=this.lo.qWa(pa),z.sW(!pa));return 32}fmb(z,Z,pa){z=this.sa.Aa;if(!z)return 16;z=this.lo.aCb(z.qp);return!z||!z.next||this.ho&&1!==this.oa.Xe().length?16:1===pa?32:8}T8e(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=Ma.SourceControlId;Ma=z===Mc.a.Vqa||z===Mc.a.AAa;Fa=this.sa.Aa;if(!Fa||this.ic.Xc(Fa)||this.ho&&1!==this.oa.Xe().length)return 16;var tb=Fa.qp;const Hb=!!this.lo.pWa(tb);if(Ma&&(!tb||Hb))return 16;if(1===pa)return 32;tb=this.lo.HR(Z);if(!tb)return 8;
if(!Ma&&2===pa&&Z){vg.a.Xk("SlideCount","1");pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{pa.mc(Fa),pa.Wc=z,Fa.qp=tb.yc}finally{pa&&pa.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Z,tb.next||"null",Fa.Fb.sid)}return 32}HUl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=Ma.SourceControlId;Fa=this.sa.Aa;if(!Fa)return 16;if(z!==Mc.a.Jk)return 8;if(this.ic.Xc(Fa)||this.ho&&1!==this.oa.Xe().length)return 16;
if(1===pa)return 32;Ma=this.lo.HR(Z);if(!Ma)return 8;if(2===pa&&Z){vg.a.Xk("SlideCount","1");pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{pa.mc(Fa),pa.Wc=z,Fa.qp=Ma.yc}finally{pa&&pa.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Z,Ma.next||"null",Fa.Fb.sid)}return 32}IUl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=this.sa.Aa;if(!Z)return 16;if(z!==Mc.a.Vqa)return 8;if(this.ho&&1!==
this.oa.Xe().length)return 16;if(1!==pa)return 8;z=Z.qp;pa=!!this.lo.pWa(z);Z=this.lo.aCb(z);Z=this.lo.r9c(Z?Z.parent:null,this.lo.iBb());return z&&!pa||!Z?32:16}JUl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=this.sa.Aa;if(!Z)return 16;if(z!==Mc.a.AAa)return 8;if(this.ho&&1!==this.oa.Xe().length)return 16;if(1!==pa)return 8;z=Z.qp;pa=!!this.lo.pWa(z);return!z||pa?16:32}aob(z,Z,pa){Z=this.sa.Aa;if(!Z||this.ic.Xc(Z)||this.ho&&1!==this.oa.Xe().length)return 16;if(1===pa)return 32;vg.a.Xk("SlideCount","1");pa=this.Yb.Of;
const Fa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{Fa.mc(pa),Fa.Wc=z,pa.Vvb=Z.Fb}finally{Fa&&Fa.dispose()}e.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}POb(z,Z,pa,Fa,Ma){z=this.sa.Aa?!0:!1;if(!Ma)return 8;Ma=Ma.queryResult;Ma.fGa=Gc.rfe("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.Pmc);Ma.sW(z);return z?32:16}GUl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=Ma.MenuItemId;if(this.ho&&1!==this.oa.Xe().length)return 16;
if(1===pa)return 32;pa=this.sa.Aa;if(!pa||this.ic.Xc(pa))return 16;Fa=pa?pa.qp:null;Ma=this.lo.HR(Z);if(!Fa||!Ma||!Ma.yc)return 16;Fa.TransitionType=Ma.yc.TransitionType;Fa.Direction=Ma.yc.Direction;Fa.Duration=Ma.yc.Duration;vg.a.Xk("SlideCount","1");const tb=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{tb.mc(pa),tb.Wc=z,pa.qp=Fa}finally{tb&&tb.dispose()}e.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
Ma.parent,Z,pa.Fb.sid);return 32}Eol(z,Z,pa,Fa,Ma){if(!Ma)return 8;z=Ma.queryResult;Ma=Ma.MenuItemId;Z=this.sa.Aa;if(!Z)return 16;1===pa&&z.Rf(this.lo.pWa(Z.qp)===Ma);return 32}Kza(z,Z,pa,Fa,Ma){z=this.sa.Aa;if(!z)return 16;if(!Ma)return 8;z=z.qp;if(Ma=Ma.queryResult)Ma.uca=z?(z.Duration/1E3).toString():"0";return 32}bob(z,Z,pa,Fa,Ma){Z=this.sa.Aa;if(!Z||this.ic.Xc(Z))return 16;if(!Ma)return 8;if(this.ho&&1!==this.oa.Xe().length)return 16;Fa=Math.floor(1E3*Ma.Number);Ma=Z.qp;if(!Ma)return 16;vg.a.Kb&&
(vg.a.Kb.actionName="SetTransitionDuration");if(1===pa)return"TransitionNone"===this.lo.qWa(Ma)?16:32;if(2===pa){Ma.Duration=Fa;const tb=this.Fa.Je;vg.a.Xk("SlideCount","1");pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();!tb||tb.name!==cd.a.Ag&&tb.name!==cd.a.xA||this.Fa.Gd()});try{pa.mc(Z),pa.Wc=z,Z.qp=Ma}finally{pa&&pa.dispose()}}return 32}xhl(z,Z,pa,Fa,Ma){if(1===pa)return 32;if(!Ma)return 8;Z=this.oa.Xe();if(!Z||!Z.length)return 16;z=Z[0].qp;if(!z)return 16;z=this.lo.aCb(z);if(1<Z.length)for(const tb of Z){Z=
tb.qp;if(!Z)return 16;Z=this.lo.aCb(Z);if(z.parent!==Z.parent)return 16}z.next&&(Ma.MenuItems=this.tSf(z));return 32}q0e(z,Z,pa,Fa,Ma){if(!Ma)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;Z=this.lo.HR(Ma);if(!Z)return 8;z.fGa=Gc.rfe(Z.Bc,Z.wc,this.Pmc);Z=this.oa.Xe();if(!Z||!Z.length)return 16;1===pa&&(pa="",({wra:pa}=this.vUa(Z)).returnValue&&z.sW(!pa&&"TransitionExisting"===Ma||pa===Ma));return 32}mol(z,Z,pa,Fa,Ma){if(!Ma||z!==Mc.a.wk)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;Z=this.lo.HR(Ma);
if(!Z)return 8;Fa=Z.Bc.split("_")[1]+"_24";Z=Gc.vVa(Ma,Ma,Fa,"2024601249","149145197",Z.wc,Z.wc);z.k5=Z;Z=this.oa.Xe();if(!Z||!Z.length)return 16;1===pa&&(pa="",({wra:pa}=this.vUa(Z)).returnValue&&z.sW(pa===Ma));return 32}nol(z,Z,pa,Fa,Ma){if(!Ma||z!==Mc.a.lqa)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;if(!Ma||"TransitionExisting"!==Ma)return 16;Z=this.lo.HR(Ma);if(!Z)return 8;Fa=Z.Bc.split("_")[1]+"_24";Z=Gc.vVa(Ma,Ma,Fa,"3752636652","3476251476",Z.wc,Z.wc);z.k5=Z;Z=this.oa.Xe();if(!Z||!Z.length)return 16;
if(1===pa&&(pa="",({wra:pa}=this.vUa(Z)).returnValue)){Z=this.lo.r9c(pa,this.lo.iBb());if(pa&&!Z){Fa=this.lo.HR(pa);if(!Fa)return 8;const tb=Fa.Bc.split("_")[1]+"_24";Ma=Gc.vVa(Ma,Ma,tb,"3752636652","3476251476",Fa.wc,Fa.wc);z.k5=Ma}z.sW(!pa||!!pa&&!Z)}return 32}ool(z,Z,pa,Fa,Ma){if(!Ma||z!==Mc.a.Lza)return 8;z=Ma.queryResult;Ma=Ma.SourceControlId;if(!Ma||"TransitionExistingInMenu"!==Ma)return 16;Z=this.lo.HR(Ma);if(!Z)return 8;Fa=Z.Bc.split("_")[1]+"_24";Ma=Gc.vVa(Ma,Ma,Fa,"4036532528","2831233208",
Z.wc,Z.wc);z.k5=Ma;Ma=this.oa.Xe();if(!Ma||!Ma.length)return 16;1===pa&&(pa="",({wra:pa}=this.vUa(Ma)).returnValue&&z.sW(!pa));return 32}lol(z,Z,pa){z=this.oa.Xe();if(!z||!z.length)return 16;Z=this.lo.aCb(z[0].qp);return!Z||!Z.next||1<z.length&&!this.vUa(z).returnValue?16:1===pa?32:8}F8e(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=Ma.SourceControlId;Ma=z===Mc.a.Vqa||z===Mc.a.AAa;Fa=this.oa.Xe();if(!Fa||!Fa.length)return 16;for(var tb of Fa)if(this.ic.Xc(tb))return 16;tb="";const Hb=({wra:tb}=this.vUa(Fa)).returnValue;
if(Ma&&(!Hb||tb))return 16;if(1===pa)return 32;tb=this.lo.HR(Z);if(!tb)return 8;if(!Ma&&2===pa&&Z){vg.a.Xk("SlideCount",Fa.length.toString());pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{pa.mc(this.Yb.Of);pa.Wc=z;for(const rc of Fa)rc.qp=tb.yc}finally{pa&&pa.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",Z,tb.next||"null")}return 32}OTl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=Ma.SourceControlId;
if(z!==Mc.a.Jk)return 8;Fa=this.oa.Xe();if(!Fa||!Fa.length)return 16;for(var tb of Fa)if(this.ic.Xc(tb))return 16;if(1===pa)return 32;tb=this.lo.HR(Z);if(!tb)return 8;if(2===pa&&Z){vg.a.Xk("SlideCount",Fa.length.toString());pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()},()=>{1===this.yb.$i&&this.Fa.qk(cd.a.KB,!0)});try{pa.mc(this.Yb.Of);pa.Wc=z;for(const Hb of Fa)Hb.qp=tb.yc}finally{pa&&pa.dispose()}e.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
Z,tb.next||"null")}return 32}PTl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=this.oa.Xe();if(!Z||!Z.length)return 16;if(z!==Mc.a.Vqa||1!==pa)return 8;Fa="";z=({wra:Fa}=this.vUa(Z)).returnValue;pa=!!Fa;Z=Fa&&0<Fa.length?this.lo.HR(Fa):null;Z=this.lo.r9c(Z?Z.parent:null,this.lo.iBb());return!z||pa&&Z?16:32}QTl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=this.oa.Xe();if(!Z||!Z.length)return 16;if(z!==Mc.a.AAa||1!==pa)return 8;z="";return!({wra:z}=this.vUa(Z)).returnValue||z?16:32}NTl(z,Z,pa,Fa,Ma){if(!Ma)return 8;Z=Ma.MenuItemId;
if(1===pa)return 32;pa=this.oa.Xe();if(!pa||!pa.length)return 16;Fa=Pf.a("NoTransitionForEffectCmdFixEnabled");for(var tb of pa){if(this.ic.Xc(tb))return 16;Ma=tb.qp;if(!Fa&&!Ma)return 16}tb=this.lo.HR(Z);if(!tb||!tb.yc)return 16;vg.a.Xk("SlideCount",pa.length.toString());Ma=this.Eb.ud(15,void 0,()=>{this.oa.uj();this.Fa.Gd()});try{Ma.mc(this.Yb.Of);Ma.Wc=z;for(const Hb of pa){const rc=!Fa||Hb.qp?Hb.qp:tb.yc;rc.TransitionType=tb.yc.TransitionType;rc.Direction=tb.yc.Direction;rc.Duration=tb.yc.Duration;
Hb.qp=rc}}finally{Ma&&Ma.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",tb.parent,Z);return 32}kol(z,Z,pa,Fa,Ma){if(!Ma)return 8;z=Ma.queryResult;Ma=Ma.MenuItemId;Z=this.oa.Xe();if(!Z||!Z.length)return 16;1===pa&&(pa="",({wra:pa}=this.zdj(Z)).returnValue&&z.Rf(pa===Ma));return 32}jol(z,Z,pa,Fa,Ma){if(!Ma)return 8;z=this.oa.Xe();if(!z||!z.length)return 16;if(Ma=Ma.queryResult)z=Gc.lNj(z),Ma.uca=z;return 32}MTl(z,
Z,pa,Fa,Ma){if(!Ma)return 8;Z=this.oa.Xe();if(!Z||!Z.length)return 16;for(const tb of Z)if(this.ic.Xc(tb))return 16;Ma=Math.floor(1E3*Ma.Number);for(const tb of Z)if(!tb.qp)return 16;vg.a.Kb&&(vg.a.Kb.actionName="SetTransitionDuration");if(1===pa){for(const tb of Z)if("TransitionNone"===this.lo.qWa(tb.qp))return 16;return 32}if(2===pa){const tb=this.Fa.Je;vg.a.Xk("SlideCount",Z.length.toString());pa=this.Eb.ud(15,void 0,()=>{this.oa.uj();!tb||tb.name!==cd.a.Ag&&tb.name!==cd.a.xA||this.Fa.Gd()});try{pa.mc(this.Yb.Of);
pa.Wc=z;for(const Hb of Z){const rc=Hb.qp;rc.Duration=Ma;Hb.qp=rc}}finally{pa&&pa.dispose()}}return 32}vUa(z){let Z;Z="";if(!z||!z.length)return{returnValue:!1,wra:Z};Z=this.lo.qWa(z[0].qp);let pa=!0;if(1<z.length)for(const Fa of z)if(z=this.lo.qWa(Fa?Fa.qp:null),Z!==z){pa=!1;break}pa||(Z="");return{returnValue:pa,wra:Z}}zdj(z){let Z;Z="";if(!z||!z.length)return{returnValue:!1,wra:Z};Z=this.lo.pWa(z[0].qp);let pa=!0;if(1<z.length)for(const Fa of z)if(z=this.lo.pWa(Fa?Fa.qp:null),Z!==z){pa=!1;break}pa||
(Z="");return{returnValue:pa,wra:Z}}tSf(z){const Z=Object.assign(new Me.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),pa=Object.assign(new Bg.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(Z.MenuSectionList,pa);let Fa=null;for(z=({key:Fa}=this.lo.Qlg(z)).returnValue;z;)Array.add(pa.ControlList,Object.assign(new Ae.a,{Command:"961566706",Id:Fa,
ExternalId:"TransitionEffectOptions"+Fa,QueryCommand:"3535869262"})),{key:Fa,returnValue:z}=this.lo.Qlg(z);return Z}static lNj(z){let Z;if(!z||!z.length)return"0";const pa=z[0].qp;Z=pa?(pa.Duration/1E3).toString():"0";let Fa=!0;if(1<z.length)for(const Ma of z)if((z=Ma?Ma.qp:null)||pa){if(!z&&pa||z&&!pa){Fa=!1;break}if(Z!==(z.Duration/1E3).toString()){Fa=!1;break}}Fa||(Z="0");return Z}static rfe(z,Z,pa){z=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',
z,pa);Z=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',Z);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',z,Z)}static vVa(z,Z,pa,Fa,Ma,tb,Hb){return Object.assign(new we.a,{Id:z,ExternalId:Z,Icon:pa,Command:Fa,QueryCommand:Ma,LabelText:tb,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Hb})}}Object(k.a)(Gc,"TransitionActor",null,[948]);class ud{constructor(z,Z,pa,Fa,Ma,tb,
Hb){this.qF=null;this.hdf=!1;this.Doa=pa;this.oa=z;(this.uxa=Fa)&&Ma.execute(rc=>{this.qF=rc});this.ta=Hb;this.ia=Z;this.moa=tb}selectShape(){this.oa&&!this.oa.zY(this.ta)&&this.oa.selectShape(this.ta,!0)}onVolumeChanged(z){const Z={ActionFromPlayer:!0};.2>=z?(Z.SourceControlId="SetVolumeLow",this.ia.Ia(Mc.a.Dzd,2,Z)):.2<z&&.8>z?(Z.SourceControlId="SetVolumeMedium",this.ia.Ia(Mc.a.Ezd,2,Z)):.8<=z&&(Z.SourceControlId="SetVolumeHigh",this.ia.Ia(Mc.a.Czd,2,Z));this.selectShape()}onPlayToggled(z){const Z=
{ActionFromPlayer:!0};z?this.ia.Ia(Mc.a.LPc,2,Z):this.ia.Ia(Mc.a.U3b,2,Z);this.selectShape()}onMuteToggled(z){if(z)this.ia.Ia(Mc.a.Fzd,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(z){z&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(z){z||this.oa.Jxe(this.ta)||(z=this.vM())&&z.showHidePlayer(!1)}onPlayerClicked(){this.uxa&&
this.ia.nb(Mc.a.fUb,2)}onPlayerError(z){Qc.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",z);z&&-1<z.indexOf("PIPELINE_ERROR_READ")&&this.Doa.P0c(this.moa.podSessionId,this.ta).then(Z=>{const pa=this.vM();pa&&pa.setAudioSrc(Z)})}onKeyDown(z){z===qc.a.GBa?(z=this.vM())&&z.removeFocusFromPlayer():z===qc.a.zs&&(this.hdf=!0)}onBlur(){const z=this.vM();z&&(this.hdf?z.setFocusOnPlayer():z.removeFocusFromPlayer());this.hdf=!1}vM(){return this.uxa&&this.qF?this.qF.vM(this.ta):
null}}Object(k.a)(ud,"AudioLibraryCallback",null,[1156]);class Nd{constructor(z,Z,pa,Fa,Ma,tb){this.Doa=z;this.oa=Z;this.ia=pa;this.uxa=Fa;this.cgb=tb;this.moa=Ma}U1i(z){return new ud(this.oa,this.ia,this.Doa,this.uxa,this.cgb,this.moa,z)}}Object(k.a)(Nd,"AudioLibraryCallbackFactory",null,[1074]);class Bc{constructor(z,Z,pa,Fa){this.volume=z;this.mute=Z;this.repeat=pa;this.rewind=Fa}}Object(k.a)(Bc,"MediaProperties",null,[]);class qe{constructor(z,Z,pa,Fa){this.lGk=z;this.XKe=Z;this.Doa=pa;this.moa=
Fa}createAudioManager(z,Z,pa){return new Promise((Fa,Ma)=>{this.XKe("audioPlayback").then(()=>{window.self.audioPlayback?(Qc.a.J(512497818,801,50,"audio script is loaded successfully"),Fa(this.V1i(z,Z,pa))):(Qc.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),Ma("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(tb=>{Qc.a.J(512497817,801,10,"Failed to load audio script "+tb.toString());Ma("Failed to load audio script ")})})}V1i(z,
Z,pa){const Fa=Z.media;let Ma=null;Fa&&(Ma=new Bc(Fa.vlmField,Fa.mteField,Fa.repeatField,Fa.rewindField));const tb=audioPlayback.pptAudioFactoryGlobal.createAudioManager(z,pa,this.lGk.U1i(Z),Ma);this.Doa.P0c(this.moa.podSessionId,Z).then(Hb=>{tb&&tb.setAudioSrc(Hb)});return tb}}Object(k.a)(qe,"AudioManagerFactory",null,[1075]);var qg=d(1325);class Jf{constructor(){this.lGb=new qg.a}Ivl(z,Z){Z&&this.lGb.$(Z.id,z)}f1h(z){z&&this.lGb.Ib(z.id)&&(this.lGb.ga(z.id).dispose(),this.lGb.remove(z.id))}vM(z){return z&&
this.lGb.Ib(z.id)?this.lGb.ga(z.id):null}}Object(k.a)(Jf,"AudioManagerStore",null,[1073]);class Bd{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=0}}Object(k.a)(Bd,"EditTransitionInfo",null,[]);class Ld{constructor(){this.next=this.parent=this.yc=this.Ny=this.Bc=this.wc=null}}Object(k.a)(Ld,"Transition",null,[]);class sd{}sd.none=0;sd.Rpj=5;sd.Spj=4;sd.t$l=1;sd.eTj=1;sd.eIi=2;sd.c$=0;sd.qVa=1;sd.dGa=2;sd.vAb=3;sd.iZc=4;sd.hZc=5;sd.lZc=6;sd.kZc=7;sd.R2c=2;
sd.sXa=1;sd.USj=1;sd.LSf=0;sd.fMi=1;sd.eMi=2;sd.WSj=0;sd.VSj=1;sd.trg=2;sd.fTj=3;sd.lme=0;sd.Qbc=1;sd.Q2c=0;sd.edb=1;sd.wIi=1;sd.bRf=0;sd.vTh=2;sd.G3l=0;sd.v$l=3;sd.u$l=1;sd.wheel=1;sd.AHh=29;sd.Meg=0;sd.mrj=1;sd.vrj=2;sd.Frj=3;sd.Leg=8;sd.lrj=9;sd.urj=10;sd.Erj=11;sd.Neg=12;sd.prj=13;sd.xrj=14;sd.Irj=15;sd.Oeg=4;sd.qrj=5;sd.yrj=6;sd.Jrj=7;sd.wrj=0;sd.Grj=1;sd.Arj=2;sd.nrj=3;sd.Heg=4;sd.Hrj=5;sd.Brj=6;sd.orj=7;Object(k.a)(sd,"TransitionEffectOptions",null,[]);class qd{}qd.none=0;qd.cut=0;qd.random=
1;qd.blinds=2;qd.C4d=3;qd.VEa=4;qd.dissolve=5;qd.fade=6;qd.LOa=7;qd.w1e=8;qd.kGd=9;qd.wipe=10;qd.MOh=11;qd.split=13;qd.WVl=17;qd.bWl=18;qd.wedge=19;qd.push=20;qd.G5d=21;qd.mNf=23;qd.wheel=26;qd.JOh=27;qd.yCc=28;qd.$Pb=29;qd.UGa=30;qd.zwc=39;qd.Wcf=42;qd.flip=43;qd.PN=44;qd.Kom=47;qd.Xce=48;qd.Bae=49;qd.Y8i=50;qd.mjf=51;qd.Akl=52;qd.Vqj=53;qd.n8i=54;qd.lXe=55;qd.jsh=56;qd.FWe=57;qd.N_d=58;qd.sWe=59;qd.morph=60;qd.pan=36;qd.mfe=38;qd.a7d=37;qd.tae=33;qd.window=34;qd.h$b=32;qd.zoom=31;qd.aqm=22;Object(k.a)(qd,
"TransitionTypes",null,[]);class Kd{constructor(z){let Z=0;this.Gc=new Cf.a;this.Gc.$("TransitionExisting",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionExisting,Bc:Kd.Lc("TransitionFlash"),parent:"TransitionExisting"}));this.Gc.$("TransitionExistingInMenu",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionExisting,Bc:Kd.Lc("TransitionFlash"),parent:"TransitionExisting"}));this.Gc.$("TransitionNone",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionNone,Bc:Kd.Lc("TransitionNone"),yc:Object.assign(new Bd,
{TransitionType:qd.none,Direction:sd.eIi,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Gc.$("TransitionFade",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFade,Bc:Kd.Lc("TransitionFadeSmoothly"),yc:Object.assign(new Bd,{TransitionType:qd.mNf,Direction:sd.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Gc.$("TransitionFadeSmoothly",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionSmoothly,Ny:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,
Bc:Kd.Lc("TransitionFadeSmoothly"),yc:Object.assign(new Bd,{TransitionType:qd.mNf,Direction:sd.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Gc.$("TransitionFadeThroughBlack",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionThroughBlack,Ny:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,Bc:Kd.Lc("TransitionFadeThroughBlack"),yc:Object.assign(new Bd,{TransitionType:qd.fade,Direction:sd.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));
let pa=[];if(z){pa=z.toLowerCase().split(",");for(let Fa=0;Fa<pa.length;Fa++)pa[Fa]=pa[Fa].trim()}Array.contains(pa,"push")||(this.Gc.$("TransitionPush",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionPush,Bc:Kd.Lc("TransitionPushUp"),yc:Object.assign(new Bd,{TransitionType:qd.push,Direction:sd.qVa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Gc.$("TransitionPushFromBottom",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottom,Ny:CommonUIStrings.l_TransitionPushFromBottomKeytip,
Bc:Kd.Lc("TransitionPushUp"),yc:Object.assign(new Bd,{TransitionType:qd.push,Direction:sd.qVa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Gc.$("TransitionPushFromLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromLeft,Ny:CommonUIStrings.l_TransitionPushFromLeftKeytip,Bc:Kd.Lc("TransitionPushRight"),yc:Object.assign(new Bd,{TransitionType:qd.push,Direction:sd.dGa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),
this.Gc.$("TransitionPushFromRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromRight,Ny:CommonUIStrings.l_TransitionPushFromRightKeytip,Bc:Kd.Lc("TransitionPushLeft"),yc:Object.assign(new Bd,{TransitionType:qd.push,Direction:sd.c$,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Gc.$("TransitionPushFromTop",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTop,Ny:CommonUIStrings.l_TransitionPushFromTopKeytip,Bc:Kd.Lc("TransitionPushDown"),
yc:Object.assign(new Bd,{TransitionType:qd.push,Direction:sd.vAb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(pa,"cut")||(this.Gc.$("TransitionCut",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionCut,Bc:Kd.Lc("TransitionCut"),yc:Object.assign(new Bd,{TransitionType:qd.cut,Direction:sd.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Gc.$("TransitionCutNone",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionNone,
Ny:CommonUIStrings.l_TransitionCutNoneKeytip,Bc:Kd.Lc("TransitionCut"),yc:Object.assign(new Bd,{TransitionType:qd.cut,Direction:sd.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.Gc.$("TransitionCutThroughBlack",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionThroughBlack,Ny:CommonUIStrings.l_TransitionCutThroughBlackKeytip,Bc:Kd.Lc("TransitionCutThroughBlack"),yc:Object.assign(new Bd,{TransitionType:qd.cut,Direction:sd.t$l,Duration:500,
IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(pa,"wipe")||(this.Gc.$("TransitionWipe",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionWipe,Bc:Kd.Lc("TransitionWipeLeft"),yc:Object.assign(new Bd,{TransitionType:qd.wipe,Direction:sd.c$,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Gc.$("TransitionWipeFromRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromRight,Ny:CommonUIStrings.l_TransitionWipeFromRightKeytip,Bc:Kd.Lc("TransitionWipeLeft"),
yc:Object.assign(new Bd,{TransitionType:qd.wipe,Direction:sd.c$,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Gc.$("TransitionWipeFromTop",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTop,Ny:CommonUIStrings.l_TransitionWipeFromTopKeytip,Bc:Kd.Lc("TransitionWipeDown"),yc:Object.assign(new Bd,{TransitionType:qd.wipe,Direction:sd.vAb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Gc.$("TransitionWipeFromLeft",
Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromLeft,Ny:CommonUIStrings.l_TransitionWipeFromLeftKeytip,Bc:Kd.Lc("TransitionWipeRight"),yc:Object.assign(new Bd,{TransitionType:qd.wipe,Direction:sd.dGa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Gc.$("TransitionWipeFromBottom",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottom,Ny:CommonUIStrings.l_TransitionWipeFromBottomKeytip,Bc:Kd.Lc("TransitionWipeUp"),yc:Object.assign(new Bd,
{TransitionType:qd.wipe,Direction:sd.qVa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Gc.$("TransitionWipeFromTopRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTopRight,Ny:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,Bc:Kd.Lc("TransitionStripsLeftDown"),yc:Object.assign(new Bd,{TransitionType:qd.kGd,Direction:sd.lZc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Gc.$("TransitionWipeFromBottomRight",
Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottomRight,Ny:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,Bc:Kd.Lc("TransitionStripsLeftUp"),yc:Object.assign(new Bd,{TransitionType:qd.kGd,Direction:sd.iZc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Gc.$("TransitionWipeFromTopLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTopLeft,Ny:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,Bc:Kd.Lc("TransitionStripsRightDown"),
yc:Object.assign(new Bd,{TransitionType:qd.kGd,Direction:sd.kZc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Gc.$("TransitionWipeFromBottomLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottomLeft,Ny:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,Bc:Kd.Lc("TransitionStripsRightUp"),yc:Object.assign(new Bd,{TransitionType:qd.kGd,Direction:sd.hZc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(pa,
"morph")||(this.Gc.$("TransitionMorph",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionMorph,Bc:Kd.Lc("TransitionByObject"),yc:Object.assign(new Bd,{TransitionType:qd.morph,Direction:sd.LSf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Gc.$("TransitionMorphByObject",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionByObject,Ny:CommonUIStrings.l_TransitionMorphObjectsKeytip,Bc:Kd.Lc("TransitionByObject"),yc:Object.assign(new Bd,{TransitionType:qd.morph,
Direction:sd.LSf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Gc.$("TransitionMorphByWord",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionByWord,Ny:CommonUIStrings.l_TransitionMorphWordsKeytip,Bc:Kd.Lc("TransitionByWord"),yc:Object.assign(new Bd,{TransitionType:qd.morph,Direction:sd.fMi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Gc.$("TransitionMorphByChar",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionByChar,
Ny:CommonUIStrings.l_TransitionMorphCharactersKeytip,Bc:Kd.Lc("TransitionByChar"),yc:Object.assign(new Bd,{TransitionType:qd.morph,Direction:sd.eMi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(pa,"split")||(this.Gc.$("TransitionSplit",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionSplit,Bc:Kd.Lc("TransitionSplitOutVertical"),yc:Object.assign(new Bd,{TransitionType:qd.split,Direction:sd.trg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),
this.Gc.$("TransitionSplitVerticalOut",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionVerticalOut,Ny:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,Bc:Kd.Lc("TransitionSplitOutVertical"),yc:Object.assign(new Bd,{TransitionType:qd.split,Direction:sd.trg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Gc.$("TransitionSplitHorizontalIn",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionHorizontalIn,Ny:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,
Bc:Kd.Lc("TransitionSplitInHorizontal"),yc:Object.assign(new Bd,{TransitionType:qd.split,Direction:sd.VSj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Gc.$("TransitionSplitHorizontalOut",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionHorizontalOut,Ny:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,Bc:Kd.Lc("TransitionSplitOutHorizontal"),yc:Object.assign(new Bd,{TransitionType:qd.split,Direction:sd.WSj,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Gc.$("TransitionSplitVerticalIn",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionVerticalIn,Ny:CommonUIStrings.l_TransitionSplitVerticalInKeytip,Bc:Kd.Lc("TransitionSplitInVertical"),yc:Object.assign(new Bd,{TransitionType:qd.split,Direction:sd.fTj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(pa,"randombars")){this.Gc.$("TransitionRandomBars",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionRandomBars,
Bc:Kd.Lc("TransitionRandomBarsVertical"),yc:Object.assign(new Bd,{TransitionType:qd.w1e,Direction:sd.edb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.Gc.$("TransitionRandomBarsVertical",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionVertical,Ny:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,Bc:Kd.Lc("TransitionRandomBarsVertical"),yc:Object.assign(new Bd,{TransitionType:qd.w1e,Direction:sd.edb,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let Fa,Ma;this.Gc.$("TransitionRandomBarsHorizontal",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionHorizontal,Ma.Ny=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Ma.Bc=Kd.Lc("TransitionRandomBarsHorizontal"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.w1e,Fa.Direction=sd.Q2c,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionRandomBars",Ma))}if(!Array.contains(pa,"shape")){let Fa,Ma;this.Gc.$("TransitionShape",(Ma=
new Ld,Ma.wc=ResourceStrings.L_TransitionShape,Ma.Bc=Kd.Lc("TransitionShapeCircle"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.JOh,Fa.Direction=sd.none,Fa.Duration=800,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionShape",Ma.next="TransitionShapeCircle",Ma));let tb,Hb;this.Gc.$("TransitionShapeCircle",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionCircle,Hb.Ny=CommonUIStrings.l_TransitionShapeCircleKeytip,Hb.Bc=Kd.Lc("TransitionShapeCircle"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.JOh,tb.Direction=sd.none,
tb.Duration=800,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionShape",Hb.next="TransitionShapeDiamond",Hb));let rc,yc;this.Gc.$("TransitionShapeDiamond",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionDiamond,yc.Ny=CommonUIStrings.l_TransitionShapeDiamondKeytip,yc.Bc=Kd.Lc("TransitionShapeDiamond"),yc.yc=(rc=new Bd,rc.TransitionType=qd.WVl,rc.Direction=sd.none,rc.Duration=800,rc.IsManualAdvance=!0,rc),yc.parent="TransitionShape",yc.next="TransitionShapePlus",yc));let xc,ld;this.Gc.$("TransitionShapePlus",
(ld=new Ld,ld.wc=ResourceStrings.L_TransitionPlus,ld.Ny=CommonUIStrings.l_TransitionShapePlusKeytip,ld.Bc=Kd.Lc("TransitionShapePlus"),ld.yc=(xc=new Bd,xc.TransitionType=qd.bWl,xc.Direction=sd.none,xc.Duration=1E3,xc.IsManualAdvance=!0,xc),ld.parent="TransitionShape",ld.next="TransitionShapeIn",ld));let wd,t;this.Gc.$("TransitionShapeIn",(t=new Ld,t.wc=ResourceStrings.L_TransitionIn,t.Ny=CommonUIStrings.l_TransitionShapeInKeytip,t.Bc=Kd.Lc("TransitionBoxIn"),t.yc=(wd=new Bd,wd.TransitionType=qd.MOh,
wd.Direction=sd.Qbc,wd.Duration=1200,wd.IsManualAdvance=!0,wd),t.parent="TransitionShape",t.next="TransitionShapeOut",t));let aa,ra;this.Gc.$("TransitionShapeOut",(ra=new Ld,ra.wc=ResourceStrings.L_TransitionOut,ra.Ny=CommonUIStrings.l_TransitionShapeOutKeytip,ra.Bc=Kd.Lc("TransitionBoxOut"),ra.yc=(aa=new Bd,aa.TransitionType=qd.MOh,aa.Direction=sd.lme,aa.Duration=1200,aa.IsManualAdvance=!0,aa),ra.parent="TransitionShape",ra))}if(!Array.contains(pa,"reveal")){let Fa,Ma;this.Gc.$("TransitionReveal",
(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionReveal,Ma.Bc=Kd.Lc("TransitionRevealSmoothlyFromRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.zwc,Fa.Direction=sd.vTh,Fa.Duration=3400,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionReveal",Ma.next="TransitionRevealSmoothlyFromRight",Ma));let tb,Hb;this.Gc.$("TransitionRevealSmoothlyFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionSmoothlyFromRight,Hb.Bc=Kd.Lc("TransitionRevealSmoothlyFromRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.zwc,tb.Direction=
sd.vTh,tb.Duration=3400,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionReveal",Hb.next="TransitionRevealSmoothlyFromLeft",Hb));let rc,yc;this.Gc.$("TransitionRevealSmoothlyFromLeft",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionSmoothlyFromLeft,yc.Bc=Kd.Lc("TransitionRevealSmoothlyFromLeft"),yc.yc=(rc=new Bd,rc.TransitionType=qd.zwc,rc.Direction=sd.G3l,rc.Duration=3400,rc.IsManualAdvance=!0,rc),yc.parent="TransitionReveal",yc.next="TransitionRevealFromRight",yc));let xc,ld;this.Gc.$("TransitionRevealFromRight",
(ld=new Ld,ld.wc=ResourceStrings.L_TransitionThroughBlackFromRight,ld.Bc=Kd.Lc("TransitionRevealFromRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.zwc,xc.Direction=sd.v$l,xc.Duration=3400,xc.IsManualAdvance=!0,xc),ld.parent="TransitionReveal",ld.next="TransitionRevealFromLeft",ld));let wd,t;this.Gc.$("TransitionRevealFromLeft",(t=new Ld,t.wc=ResourceStrings.L_TransitionThroughBlackFromLeft,t.Bc=Kd.Lc("TransitionRevealFromLeft"),t.yc=(wd=new Bd,wd.TransitionType=qd.zwc,wd.Direction=sd.u$l,wd.Duration=
3400,wd.IsManualAdvance=!0,wd),t.parent="TransitionReveal",t))}if(!Array.contains(pa,"cover")){let Fa,Ma;this.Gc.$("TransitionCover",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionCover,Ma.Bc=Kd.Lc("TransitionCoverLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.VEa,Fa.Direction=sd.c$,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionCover",Ma.next="TransitionCoverFromRight",Ma));let tb,Hb;this.Gc.$("TransitionCoverFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionCoverLeft"),
Hb.yc=(tb=new Bd,tb.TransitionType=qd.VEa,tb.Direction=sd.c$,tb.Duration=1E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionCover",Hb.next="TransitionCoverFromTop",Hb));let rc,yc;this.Gc.$("TransitionCoverFromTop",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromTop,yc.Bc=Kd.Lc("TransitionCoverDown"),yc.yc=(rc=new Bd,rc.TransitionType=qd.VEa,rc.Direction=sd.vAb,rc.Duration=1E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionCover",yc.next="TransitionCoverFromLeft",yc));let xc,ld;this.Gc.$("TransitionCoverFromLeft",
(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromLeft,ld.Bc=Kd.Lc("TransitionCoverRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.VEa,xc.Direction=sd.dGa,xc.Duration=1E3,xc.IsManualAdvance=!0,xc),ld.parent="TransitionCover",ld.next="TransitionCoverFromBottom",ld));let wd,t;this.Gc.$("TransitionCoverFromBottom",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromBottom,t.Bc=Kd.Lc("TransitionCoverUp"),t.yc=(wd=new Bd,wd.TransitionType=qd.VEa,wd.Direction=sd.qVa,wd.Duration=1E3,wd.IsManualAdvance=!0,wd),t.parent=
"TransitionCover",t.next="TransitionCoverFromTopRight",t));let aa,ra;this.Gc.$("TransitionCoverFromTopRight",(ra=new Ld,ra.wc=ResourceStrings.L_TransitionFromTopRight,ra.Bc=Kd.Lc("TransitionCoverLeftDown"),ra.yc=(aa=new Bd,aa.TransitionType=qd.VEa,aa.Direction=sd.lZc,aa.Duration=1E3,aa.IsManualAdvance=!0,aa),ra.parent="TransitionCover",ra.next="TransitionCoverFromBottomRight",ra));let Na,db;this.Gc.$("TransitionCoverFromBottomRight",(db=new Ld,db.wc=ResourceStrings.L_TransitionFromBottomRight,db.Bc=
Kd.Lc("TransitionCoverLeftUp"),db.yc=(Na=new Bd,Na.TransitionType=qd.VEa,Na.Direction=sd.iZc,Na.Duration=1E3,Na.IsManualAdvance=!0,Na),db.parent="TransitionCover",db.next="TransitionCoverFromTopLeft",db));let kb,Ib;this.Gc.$("TransitionCoverFromTopLeft",(Ib=new Ld,Ib.wc=ResourceStrings.L_TransitionFromTopLeft,Ib.Bc=Kd.Lc("TransitionCoverRightDown"),Ib.yc=(kb=new Bd,kb.TransitionType=qd.VEa,kb.Direction=sd.kZc,kb.Duration=1E3,kb.IsManualAdvance=!0,kb),Ib.parent="TransitionCover",Ib.next="TransitionCoverFromBottomLeft",
Ib));let Rb,Cb;this.Gc.$("TransitionCoverFromBottomLeft",(Cb=new Ld,Cb.wc=ResourceStrings.L_TransitionFromBottomLeft,Cb.Bc=Kd.Lc("TransitionCoverRightUp"),Cb.yc=(Rb=new Bd,Rb.TransitionType=qd.VEa,Rb.Direction=sd.hZc,Rb.Duration=1E3,Rb.IsManualAdvance=!0,Rb),Cb.parent="TransitionCover",Cb))}if(!Array.contains(pa,"uncover")){let Fa,Ma;this.Gc.$("TransitionUncover",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionUncover,Ma.Bc=Kd.Lc("TransitionUncoverLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.LOa,Fa.Direction=
sd.c$,Fa.Duration=750,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionUncover",Ma.next="TransitionUncoverFromRight",Ma));let tb,Hb;this.Gc.$("TransitionUncoverFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionUncoverLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.LOa,tb.Direction=sd.c$,tb.Duration=750,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionUncover",Hb.next="TransitionUncoverFromTop",Hb));let rc,yc;this.Gc.$("TransitionUncoverFromTop",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromTop,
yc.Bc=Kd.Lc("TransitionUncoverDown"),yc.yc=(rc=new Bd,rc.TransitionType=qd.LOa,rc.Direction=sd.vAb,rc.Duration=750,rc.IsManualAdvance=!0,rc),yc.parent="TransitionUncover",yc.next="TransitionUncoverFromLeft",yc));let xc,ld;this.Gc.$("TransitionUncoverFromLeft",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromLeft,ld.Bc=Kd.Lc("TransitionUncoverRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.LOa,xc.Direction=sd.dGa,xc.Duration=750,xc.IsManualAdvance=!0,xc),ld.parent="TransitionUncover",ld.next="TransitionUncoverFromBottom",
ld));let wd,t;this.Gc.$("TransitionUncoverFromBottom",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromBottom,t.Bc=Kd.Lc("TransitionUncoverUp"),t.yc=(wd=new Bd,wd.TransitionType=qd.LOa,wd.Direction=sd.qVa,wd.Duration=750,wd.IsManualAdvance=!0,wd),t.parent="TransitionUncover",t.next="TransitionUncoverFromTopRight",t));this.Gc.$("TransitionUncoverFromTopRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTopRight,Bc:Kd.Lc("TransitionUncoverLeftDown"),yc:Object.assign(new Bd,{TransitionType:qd.LOa,
Direction:sd.lZc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Gc.$("TransitionUncoverFromBottomRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottomRight,Bc:Kd.Lc("TransitionUncoverLeftUp"),yc:Object.assign(new Bd,{TransitionType:qd.LOa,Direction:sd.iZc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.Gc.$("TransitionUncoverFromTopLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTopLeft,
Bc:Kd.Lc("TransitionUncoverRightDown"),yc:Object.assign(new Bd,{TransitionType:qd.LOa,Direction:sd.kZc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Gc.$("TransitionUncoverFromBottomLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottomLeft,Bc:Kd.Lc("TransitionUncoverRightUp"),yc:Object.assign(new Bd,{TransitionType:qd.LOa,Direction:sd.hZc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(pa,
"menusectionexciting")){if(!Array.contains(pa,"fallover")){this.Gc.$("TransitionFallOver",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFallOver,Bc:Kd.Lc("TransitionFallOverLeft"),yc:Object.assign(new Bd,{TransitionType:qd.Xce,Direction:sd.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let Fa,Ma;this.Gc.$("TransitionFallOverLeft",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionGoLeft,Ma.Bc=Kd.Lc("TransitionFallOverLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=
qd.Xce,Fa.Direction=sd.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionFallOver",Ma.next="TransitionFallOverRight",Ma));let tb,Hb;this.Gc.$("TransitionFallOverRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionGoRight,Hb.Bc=Kd.Lc("TransitionFallOverRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.Xce,tb.Direction=sd.sXa,tb.Duration=2E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionFallOver",Hb))}if(!Array.contains(pa,"drape")){let Fa,Ma;this.Gc.$("TransitionDrape",(Ma=new Ld,Ma.wc=
ResourceStrings.L_TransitionDrape,Ma.Bc=Kd.Lc("TransitionDrapeLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.Bae,Fa.Direction=sd.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionDrape",Ma.next="TransitionDrapeLeft",Ma));let tb,Hb;this.Gc.$("TransitionDrapeLeft",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionGoLeft,Hb.Bc=Kd.Lc("TransitionDrapeLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.Bae,tb.Direction=sd.none,tb.Duration=2E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionDrape",Hb.next=
"TransitionDrapeRight",Hb));let rc,yc;this.Gc.$("TransitionDrapeRight",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionGoRight,yc.Bc=Kd.Lc("TransitionDrapeRight"),yc.yc=(rc=new Bd,rc.TransitionType=qd.Bae,rc.Direction=sd.sXa,rc.Duration=2E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionDrape",yc))}if(!Array.contains(pa,"curtains")){let Fa,Ma;this.Gc.$("TransitionCurtains",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionCurtains,Ma.Bc=Kd.Lc("TransitionCurtains"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.Y8i,
Fa.Direction=sd.none,Fa.Duration=6E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionCurtains",Ma))}if(!Array.contains(pa,"wind")){let Fa,Ma;this.Gc.$("TransitionWind",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionWind,Ma.Bc=Kd.Lc("TransitionWindRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.mjf,Fa.Direction=sd.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionWind",Ma.next="TransitionWindRight",Ma));let tb,Hb;this.Gc.$("TransitionWindRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionGoRight,
Hb.Bc=Kd.Lc("TransitionWindRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.mjf,tb.Direction=sd.none,tb.Duration=2E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionWind",Hb.next="TransitionWindLeft",Hb));let rc,yc;this.Gc.$("TransitionWindLeft",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionGoLeft,yc.Bc=Kd.Lc("TransitionWindLeft"),yc.yc=(rc=new Bd,rc.TransitionType=qd.mjf,rc.Direction=sd.sXa,rc.Duration=2E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionWind",yc))}if(!Array.contains(pa,"prestige")){let Fa,
Ma;this.Gc.$("TransitionPrestige",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionPrestige,Ma.Bc=Kd.Lc("TransitionPrestige"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.Akl,Fa.Direction=sd.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionPrestige",Ma))}if(!Array.contains(pa,"fracture")){let Fa,Ma;this.Gc.$("TransitionFracture",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionFracture,Ma.Bc=Kd.Lc("TransitionFracture"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.Vqj,Fa.Direction=sd.none,Fa.Duration=
2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionFracture",Ma))}if(!Array.contains(pa,"crush")){let Fa,Ma;this.Gc.$("TransitionCrush",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionCrush,Ma.Bc=Kd.Lc("TransitionCrush"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.n8i,Fa.Direction=sd.none,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionCrush",Ma))}if(!Array.contains(pa,"peeloff")){let Fa,Ma;this.Gc.$("TransitionPeelOff",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionPeelOff,Ma.Bc=Kd.Lc("TransitionPeelOffLeft"),
Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.lXe,Fa.Direction=sd.none,Fa.Duration=1250,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionPeelOff",Ma.next="TransitionPeelOffLeft",Ma));let tb,Hb;this.Gc.$("TransitionPeelOffLeft",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionGoLeft,Hb.Bc=Kd.Lc("TransitionPeelOffLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.lXe,tb.Direction=sd.none,tb.Duration=1250,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionPeelOff",Hb.next="TransitionPeelOffRight",Hb));let rc,yc;this.Gc.$("TransitionPeelOffRight",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionGoRight,yc.Bc=Kd.Lc("TransitionPeelOffRight"),yc.yc=(rc=new Bd,rc.TransitionType=qd.lXe,rc.Direction=sd.sXa,rc.Duration=1250,rc.IsManualAdvance=!0,rc),yc.parent="TransitionPeelOff",yc))}if(!Array.contains(pa,"pagecurl")){let Fa,Ma;this.Gc.$("TransitionPageCurl",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionPageCurl,Ma.Bc=Kd.Lc("TransitionTwoPageCurlFromRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.FWe,Fa.Direction=sd.none,Fa.Duration=1250,Fa.IsManualAdvance=
!0,Fa),Ma.parent="TransitionPageCurl",Ma.next="TransitionPageCurlDoubleLeft",Ma));let tb,Hb;this.Gc.$("TransitionPageCurlDoubleLeft",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,Hb.Bc=Kd.Lc("TransitionTwoPageCurlFromRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.FWe,tb.Direction=sd.none,tb.Duration=1250,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionPageCurl",Hb.next="TransitionPageCurlDoubleRight",Hb));let rc,yc;this.Gc.$("TransitionPageCurlDoubleRight",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionEffectOptionDoubleRight,
yc.Bc=Kd.Lc("TransitionTwoPageCurlFromLeft"),yc.yc=(rc=new Bd,rc.TransitionType=qd.FWe,rc.Direction=sd.sXa,rc.Duration=1250,rc.IsManualAdvance=!0,rc),yc.parent="TransitionPageCurl",yc.next="TransitionPageCurlSingleLeft",yc));let xc,ld;this.Gc.$("TransitionPageCurlSingleLeft",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionEffectOptionSingleLeft,ld.Bc=Kd.Lc("TransitionPageCurlFromRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.jsh,xc.Direction=sd.none,xc.Duration=1250,xc.IsManualAdvance=!0,xc),ld.parent=
"TransitionPageCurl",ld.next="TransitionPageCurlSingleRight",ld));let wd,t;this.Gc.$("TransitionPageCurlSingleRight",(t=new Ld,t.wc=ResourceStrings.L_TransitionEffectOptionSingleRight,t.Bc=Kd.Lc("TransitionPageCurlFromLeft"),t.yc=(wd=new Bd,wd.TransitionType=qd.jsh,wd.Direction=sd.sXa,wd.Duration=1250,wd.IsManualAdvance=!0,wd),t.parent="TransitionPageCurl",t))}if(!Array.contains(pa,"airplane")){let Fa,Ma;this.Gc.$("TransitionAirplane",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionAirplane,Ma.Bc=Kd.Lc("TransitionAirplaneRight"),
Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.N_d,Fa.Direction=sd.none,Fa.Duration=1250,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionAirplane",Ma.next="TransitionAirplaneRight",Ma));let tb,Hb;this.Gc.$("TransitionAirplaneRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionGoRight,Hb.Bc=Kd.Lc("TransitionAirplaneRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.N_d,tb.Direction=sd.none,tb.Duration=1250,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionAirplane",Hb.next="TransitionAirplaneLeft",Hb));let rc,yc;this.Gc.$("TransitionAirplaneLeft",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionGoLeft,yc.Bc=Kd.Lc("TransitionAirplaneLeft"),yc.yc=(rc=new Bd,rc.TransitionType=qd.N_d,rc.Direction=sd.sXa,rc.Duration=1250,rc.IsManualAdvance=!0,rc),yc.parent="TransitionAirplane",yc))}if(!Array.contains(pa,"origami")){let Fa,Ma;this.Gc.$("TransitionOrigami",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionOrigami,Ma.Bc=Kd.Lc("TransitionOrigamiRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.sWe,Fa.Direction=sd.none,Fa.Duration=3250,Fa.IsManualAdvance=!0,Fa),
Ma.parent="TransitionOrigami",Ma.next="TransitionOrigamiRight",Ma));let tb,Hb;this.Gc.$("TransitionOrigamiRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionGoRight,Hb.Bc=Kd.Lc("TransitionOrigamiRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.sWe,tb.Direction=sd.none,tb.Duration=3250,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionOrigami",Hb.next="TransitionOrigamiLeft",Hb));let rc,yc;this.Gc.$("TransitionOrigamiLeft",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionGoLeft,yc.Bc=Kd.Lc("TransitionOrigamiLeft"),
yc.yc=(rc=new Bd,rc.TransitionType=qd.sWe,rc.Direction=sd.sXa,rc.Duration=3250,rc.IsManualAdvance=!0,rc),yc.parent="TransitionOrigami",yc))}Array.contains(pa,"dissolve")||this.Gc.$("TransitionDissolve",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionDissolve,Bc:Kd.Lc("TransitionDissolve"),yc:Object.assign(new Bd,{TransitionType:qd.dissolve,Direction:sd.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(pa,"checker")||(this.Gc.$("TransitionChecker",Object.assign(new Ld,
{wc:ResourceStrings.L_TransitionChecker,Bc:Kd.Lc("TransitionCheckerboardAcross"),yc:Object.assign(new Bd,{TransitionType:qd.C4d,Direction:sd.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Gc.$("TransitionCheckerFromLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromLeft,Bc:Kd.Lc("TransitionCheckerboardAcross"),yc:Object.assign(new Bd,{TransitionType:qd.C4d,Direction:sd.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",
next:"TransitionCheckerFromTop"})),this.Gc.$("TransitionCheckerFromTop",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTop,Bc:Kd.Lc("TransitionCheckerboardDown"),yc:Object.assign(new Bd,{TransitionType:qd.C4d,Direction:sd.USj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(pa,"blinds")){this.Gc.$("TransitionBlinds",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionBlinds,Bc:Kd.Lc("TransitionBlindsVertical"),yc:Object.assign(new Bd,{TransitionType:qd.blinds,
Direction:sd.bRf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let Fa,Ma;this.Gc.$("TransitionBlindsVertical",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionVertical,Ma.Bc=Kd.Lc("TransitionBlindsVertical"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.blinds,Fa.Direction=sd.bRf,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionBlinds",Ma.next="TransitionBlindsHorizontal",Ma));let tb,Hb;this.Gc.$("TransitionBlindsHorizontal",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionHorizontal,
Hb.Bc=Kd.Lc("TransitionBlindsHorizontal"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.blinds,tb.Direction=sd.wIi,tb.Duration=1600,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionBlinds",Hb))}if(!Array.contains(pa,"wheel")){let Fa,Ma;this.Gc.$("TransitionWheel",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionWheel,Ma.Bc=Kd.Lc("TransitionWheelClockwise1"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.wheel,Fa.Direction=sd.wheel,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionWheel",Ma.next="TransitionWheelClockwise",
Ma));let tb,Hb;this.Gc.$("TransitionWheelClockwise",(Hb=new Ld,Hb.wc=ResourceStrings.l_TransitionWheelClockWise,Hb.Bc=Kd.Lc("TransitionWheelClockwise1"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.wheel,tb.Direction=sd.wheel,tb.Duration=1E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionWheel",Hb.next="TransitionWheelCounterclockwise",Hb));let rc,yc;this.Gc.$("TransitionWheelCounterclockwise",(yc=new Ld,yc.wc=ResourceStrings.l_TransitionWheelCounterClockWise,yc.Bc=Kd.Lc("TransitionWheelCounterclockwise1"),
yc.yc=(rc=new Bd,rc.TransitionType=qd.Kom,rc.Direction=sd.wheel,rc.Duration=1E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionWheel",yc.next="TransitionWheelWedge",yc));let xc,ld;this.Gc.$("TransitionWheelWedge",(ld=new Ld,ld.wc=ResourceStrings.l_TransitionWheelWedge,ld.Bc=Kd.Lc("TransitionWedge"),ld.yc=(xc=new Bd,xc.TransitionType=qd.wedge,xc.Direction=sd.none,xc.Duration=1E3,xc.IsManualAdvance=!0,xc),ld.parent="TransitionWheel",ld))}if(!Array.contains(pa,"ripple")){let Fa,Ma;this.Gc.$("TransitionRipple",
(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionRipple,Ma.Bc=Kd.Lc("TransitionRipple"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.$Pb,Fa.Direction=sd.AHh,Fa.Duration=1400,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionRipple",Ma.next="TransitionRippleCenter",Ma));let tb,Hb;this.Gc.$("TransitionRippleCenter",(Hb=new Ld,Hb.wc=ResourceStrings.L_EffectOptionsDirectionCenter,Hb.Bc=Kd.Lc("TransitionRipple"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.$Pb,tb.Direction=sd.AHh,tb.Duration=1400,tb.IsManualAdvance=!0,tb),
Hb.parent="TransitionRipple",Hb.next="TransitionRippleBottomLeft",Hb));let rc,yc;this.Gc.$("TransitionRippleBottomLeft",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromBottomLeft,yc.Bc=Kd.Lc("TransitionRippleBottomLeft"),yc.yc=(rc=new Bd,rc.TransitionType=qd.$Pb,rc.Direction=sd.hZc,rc.Duration=1500,rc.IsManualAdvance=!0,rc),yc.parent="TransitionRipple",yc.next="TransitionRippleBottomRight",yc));let xc,ld;this.Gc.$("TransitionRippleBottomRight",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromBottomRight,
ld.Bc=Kd.Lc("TransitionRippleBottomRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.$Pb,xc.Direction=sd.iZc,xc.Duration=1500,xc.IsManualAdvance=!0,xc),ld.parent="TransitionRipple",ld.next="TransitionRippleTopRight",ld));let wd,t;this.Gc.$("TransitionRippleTopRight",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromTopRight,t.Bc=Kd.Lc("TransitionRippleTopRight"),t.yc=(wd=new Bd,wd.TransitionType=qd.$Pb,wd.Direction=sd.lZc,wd.Duration=1500,wd.IsManualAdvance=!0,wd),t.parent="TransitionRipple",t.next="TransitionRippleTopLeft",
t));let aa,ra;this.Gc.$("TransitionRippleTopLeft",(ra=new Ld,ra.wc=ResourceStrings.L_TransitionFromTopLeft,ra.Bc=Kd.Lc("TransitionRippleTopLeft"),ra.yc=(aa=new Bd,aa.TransitionType=qd.$Pb,aa.Direction=sd.kZc,aa.Duration=1500,aa.IsManualAdvance=!0,aa),ra.parent="TransitionRipple",ra))}if(!Array.contains(pa,"glitter")){let Fa,Ma;this.Gc.$("TransitionGlitter",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionGlitter,Ma.Bc=Kd.Lc("TransitionGlitterHexagonLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.UGa,Fa.Direction=
sd.Heg,Fa.Duration=3900,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionGlitter",Ma.next="TransitionGlitterHexagonLeft",Ma));let tb,Hb;this.Gc.$("TransitionGlitterHexagonLeft",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionHexagonsFromLeft,Hb.Bc=Kd.Lc("TransitionGlitterHexagonLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.UGa,tb.Direction=sd.Heg,tb.Duration=3900,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionGlitter",Hb.next="TransitionGlitterHexagonTop",Hb));let rc,yc;this.Gc.$("TransitionGlitterHexagonTop",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionHexagonsFromTop,yc.Bc=Kd.Lc("TransitionGlitterHexagonTop"),yc.yc=(rc=new Bd,rc.TransitionType=qd.UGa,rc.Direction=sd.Hrj,rc.Duration=3900,rc.IsManualAdvance=!0,rc),yc.parent="TransitionGlitter",yc.next="TransitionGlitterHexagonRight",yc));let xc,ld;this.Gc.$("TransitionGlitterHexagonRight",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionHexagonsFromRight,ld.Bc=Kd.Lc("TransitionGlitterHexagonRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.UGa,xc.Direction=sd.Brj,
xc.Duration=3900,xc.IsManualAdvance=!0,xc),ld.parent="TransitionGlitter",ld.next="TransitionGlitterHexagonBottom",ld));let wd,t;this.Gc.$("TransitionGlitterHexagonBottom",(t=new Ld,t.wc=ResourceStrings.L_TransitionHexagonsFromBottom,t.Bc=Kd.Lc("TransitionGlitterHexagonBottom"),t.yc=(wd=new Bd,wd.TransitionType=qd.UGa,wd.Direction=sd.orj,wd.Duration=3900,wd.IsManualAdvance=!0,wd),t.parent="TransitionGlitter",t.next="TransitionGlitterDiamondLeft",t));let aa,ra;this.Gc.$("TransitionGlitterDiamondLeft",
(ra=new Ld,ra.wc=ResourceStrings.L_TransitionDiamondsFromLeft,ra.Bc=Kd.Lc("TransitionGlitterDiamondLeft"),ra.yc=(aa=new Bd,aa.TransitionType=qd.UGa,aa.Direction=sd.wrj,aa.Duration=3900,aa.IsManualAdvance=!0,aa),ra.parent="TransitionGlitter",ra.next="TransitionGlitterDiamondTop",ra));let Na,db;this.Gc.$("TransitionGlitterDiamondTop",(db=new Ld,db.wc=ResourceStrings.L_TransitionDiamondsFromTop,db.Bc=Kd.Lc("TransitionGlitterDiamondTop"),db.yc=(Na=new Bd,Na.TransitionType=qd.UGa,Na.Direction=sd.Grj,Na.Duration=
3900,Na.IsManualAdvance=!0,Na),db.parent="TransitionGlitter",db.next="TransitionGlitterDiamondRight",db));let kb,Ib;this.Gc.$("TransitionGlitterDiamondRight",(Ib=new Ld,Ib.wc=ResourceStrings.L_TransitionDiamondsFromRight,Ib.Bc=Kd.Lc("TransitionGlitterDiamondRight"),Ib.yc=(kb=new Bd,kb.TransitionType=qd.UGa,kb.Direction=sd.Arj,kb.Duration=3900,kb.IsManualAdvance=!0,kb),Ib.parent="TransitionGlitter",Ib.next="TransitionGlitterDiamondBottom",Ib));let Rb,Cb;this.Gc.$("TransitionGlitterDiamondBottom",(Cb=
new Ld,Cb.wc=ResourceStrings.L_TransitionDiamondsFromBottom,Cb.Bc=Kd.Lc("TransitionGlitterDiamondBottom"),Cb.yc=(Rb=new Bd,Rb.TransitionType=qd.UGa,Rb.Direction=sd.nrj,Rb.Duration=3900,Rb.IsManualAdvance=!0,Rb),Cb.parent="TransitionGlitter",Cb))}if(!Array.contains(pa,"vortex")){let Fa,Ma;this.Gc.$("TransitionVortex",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionVortex,Ma.Bc=Kd.Lc("TransitionVortexFromLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.yCc,Fa.Direction=sd.dGa,Fa.Duration=4E3,Fa.IsManualAdvance=
!0,Fa),Ma.parent="TransitionVortex",Ma.next="TransitionVortexFromLeft",Ma));let tb,Hb;this.Gc.$("TransitionVortexFromLeft",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromLeft,Hb.Bc=Kd.Lc("TransitionVortexFromLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.yCc,tb.Direction=sd.dGa,tb.Duration=4E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionVortex",Hb.next="TransitionVortexFromTop",Hb));let rc,yc;this.Gc.$("TransitionVortexFromTop",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromTop,yc.Bc=Kd.Lc("TransitionVortexFromTop"),
yc.yc=(rc=new Bd,rc.TransitionType=qd.yCc,rc.Direction=sd.vAb,rc.Duration=4E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionVortex",yc.next="TransitionVortexFromRight",yc));let xc,ld;this.Gc.$("TransitionVortexFromRight",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromRight,ld.Bc=Kd.Lc("TransitionVortexFromRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.yCc,xc.Direction=sd.c$,xc.Duration=4E3,xc.IsManualAdvance=!0,xc),ld.parent="TransitionVortex",ld.next="TransitionVortexFromBottom",ld));let wd,t;
this.Gc.$("TransitionVortexFromBottom",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromBottom,t.Bc=Kd.Lc("TransitionVortexFromBottom"),t.yc=(wd=new Bd,wd.TransitionType=qd.yCc,wd.Direction=sd.qVa,wd.Duration=4E3,wd.IsManualAdvance=!0,wd),t.parent="TransitionVortex",t))}Array.contains(pa,"switch")||(this.Gc.$("TransitionSwitch",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionSwitch,Bc:Kd.Lc("TransitionSwitchRight"),yc:Object.assign(new Bd,{TransitionType:qd.Wcf,Direction:sd.R2c,Duration:1250,IsManualAdvance:!0}),
parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Gc.$("TransitionSwitchRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionGoRight,Bc:Kd.Lc("TransitionSwitchRight"),yc:Object.assign(new Bd,{TransitionType:qd.Wcf,Direction:sd.R2c,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Gc.$("TransitionSwitchLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionGoLeft,Bc:Kd.Lc("TransitionSwitchLeft"),yc:Object.assign(new Bd,{TransitionType:qd.Wcf,
Direction:sd.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(pa,"flip")){this.Gc.$("TransitionFlip",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFlip,Bc:Kd.Lc("TransitionFlipRight"),yc:Object.assign(new Bd,{TransitionType:qd.flip,Direction:sd.R2c,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Gc.$("TransitionFlipRight",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionGoRight,Bc:Kd.Lc("TransitionFlipRight"),
yc:Object.assign(new Bd,{TransitionType:qd.flip,Direction:sd.R2c,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let Fa,Ma;this.Gc.$("TransitionFlipLeft",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionGoLeft,Ma.Bc=Kd.Lc("TransitionFlipLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.flip,Fa.Direction=sd.none,Fa.Duration=1250,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionFlip",Ma))}if(!Array.contains(pa,"galleryicon")){let Fa,Ma;this.Gc.$("TransitionGalleryIcon",
(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionGallery,Ma.Bc=Kd.Lc("TransitionGalleryRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.mfe,Fa.Direction=sd.c$,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionGalleryIcon",Ma.next="TransitionGalleryIconFromRight",Ma));let tb,Hb;this.Gc.$("TransitionGalleryIconFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionGalleryRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.mfe,tb.Direction=sd.c$,tb.Duration=1600,tb.IsManualAdvance=
!0,tb),Hb.parent="TransitionGalleryIcon",Hb.next="TransitionGalleryIconFromLeft",Hb));let rc,yc;this.Gc.$("TransitionGalleryIconFromLeft",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromLeft,yc.Bc=Kd.Lc("TransitionGalleryLeft"),yc.yc=(rc=new Bd,rc.TransitionType=qd.mfe,rc.Direction=sd.dGa,rc.Duration=1600,rc.IsManualAdvance=!0,rc),yc.parent="TransitionGalleryIcon",yc))}if(!Array.contains(pa,"cube")){let Fa,Ma;this.Gc.$("TransitionCube",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionCube,Ma.Bc=Kd.Lc("TransitionCubeFromRight"),
Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.PN,Fa.Direction=sd.Meg,Fa.Duration=1200,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionCube",Ma.next="TransitionCubeFromRight",Ma));let tb,Hb;this.Gc.$("TransitionCubeFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionCubeFromRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.PN,tb.Direction=sd.Meg,tb.Duration=1200,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionCube",Hb.next="TransitionCubeFromBottom",Hb));let rc,yc;this.Gc.$("TransitionCubeFromBottom",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromBottom,yc.Bc=Kd.Lc("TransitionCubeFromBottom"),yc.yc=(rc=new Bd,rc.TransitionType=qd.PN,rc.Direction=sd.mrj,rc.Duration=1200,rc.IsManualAdvance=!0,rc),yc.parent="TransitionCube",yc.next="TransitionCubeFromLeft",yc));let xc,ld;this.Gc.$("TransitionCubeFromLeft",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromLeft,ld.Bc=Kd.Lc("TransitionCubeFromLeft"),ld.yc=(xc=new Bd,xc.TransitionType=qd.PN,xc.Direction=sd.vrj,xc.Duration=1200,xc.IsManualAdvance=!0,
xc),ld.parent="TransitionCube",ld.next="TransitionCubeFromTop",ld));let wd,t;this.Gc.$("TransitionCubeFromTop",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromTop,t.Bc=Kd.Lc("TransitionCubeFromTop"),t.yc=(wd=new Bd,wd.TransitionType=qd.PN,wd.Direction=sd.Frj,wd.Duration=1200,wd.IsManualAdvance=!0,wd),t.parent="TransitionCube",t))}if(!Array.contains(pa,"doors")){let Fa,Ma;this.Gc.$("TransitionDoors",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionDoors,Ma.Bc=Kd.Lc("TransitionDoorsVertical"),Ma.yc=(Fa=
new Bd,Fa.TransitionType=qd.tae,Fa.Direction=sd.edb,Fa.Duration=1400,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionDoors",Ma.next="TransitionDoorsVertical",Ma));let tb,Hb;this.Gc.$("TransitionDoorsVertical",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionVertical,Hb.Bc=Kd.Lc("TransitionDoorsVertical"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.tae,tb.Direction=sd.edb,tb.Duration=1400,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionDoors",Hb.next="TransitionDoorsHorizontal",Hb));let rc,yc;this.Gc.$("TransitionDoorsHorizontal",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionHorizontal,yc.Bc=Kd.Lc("TransitionDoorsHorizontal"),yc.yc=(rc=new Bd,rc.TransitionType=qd.tae,rc.Direction=sd.Q2c,rc.Duration=1400,rc.IsManualAdvance=!0,rc),yc.parent="TransitionDoors",yc))}if(!Array.contains(pa,"box")){let Fa,Ma;this.Gc.$("TransitionBox",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionBox,Ma.Bc=Kd.Lc("TransitionBoxFromRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.PN,Fa.Direction=sd.Leg,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),Ma.parent=
"TransitionBox",Ma.next="TransitionBoxFromRight",Ma));let tb,Hb;this.Gc.$("TransitionBoxFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionBoxFromRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.PN,tb.Direction=sd.Leg,tb.Duration=1600,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionBox",Hb.next="TransitionBoxFromBottom",Hb));let rc,yc;this.Gc.$("TransitionBoxFromBottom",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromBottom,yc.Bc=Kd.Lc("TransitionBoxFromBottom"),
yc.yc=(rc=new Bd,rc.TransitionType=qd.PN,rc.Direction=sd.lrj,rc.Duration=1600,rc.IsManualAdvance=!0,rc),yc.parent="TransitionBox",yc.next="TransitionBoxFromLeft",yc));let xc,ld;this.Gc.$("TransitionBoxFromLeft",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromLeft,ld.Bc=Kd.Lc("TransitionBoxFromLeft"),ld.yc=(xc=new Bd,xc.TransitionType=qd.PN,xc.Direction=sd.urj,xc.Duration=1600,xc.IsManualAdvance=!0,xc),ld.parent="TransitionBox",ld.next="TransitionBoxFromTop",ld));let wd,t;this.Gc.$("TransitionBoxFromTop",
(t=new Ld,t.wc=ResourceStrings.L_TransitionFromTop,t.Bc=Kd.Lc("TransitionBoxFromTop"),t.yc=(wd=new Bd,wd.TransitionType=qd.PN,wd.Direction=sd.Erj,wd.Duration=1600,wd.IsManualAdvance=!0,wd),t.parent="TransitionBox",t))}if(!Array.contains(pa,"comb")){let Fa,Ma;this.Gc.$("TransitionComb",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionComb,Ma.Bc=Kd.Lc("TransitionCombHorizontal"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.G5d,Fa.Direction=sd.none,Fa.Duration=1E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionComb",
Ma.next="TransitionCombHorizontal",Ma));let tb,Hb;this.Gc.$("TransitionCombHorizontal",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionHorizontal,Hb.Bc=Kd.Lc("TransitionCombHorizontal"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.G5d,tb.Direction=sd.Q2c,tb.Duration=1E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionComb",Hb.next="TransitionCombVertical",Hb));let rc,yc;this.Gc.$("TransitionCombVertical",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionVertical,yc.Bc=Kd.Lc("TransitionCombVertical"),yc.yc=(rc=new Bd,
rc.TransitionType=qd.G5d,rc.Direction=sd.edb,rc.Duration=1E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionComb",yc))}if(!Array.contains(pa,"zoom")){let Fa,Ma;this.Gc.$("TransitionZoom",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionZoom,Ma.Bc=Kd.Lc("TransitionZoomIn"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.zoom,Fa.Direction=sd.Qbc,Fa.Duration=900,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionZoom",Ma.next="TransitionZoomIn",Ma));let tb,Hb;this.Gc.$("TransitionZoomIn",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionIn,
Hb.Bc=Kd.Lc("TransitionZoomIn"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.zoom,tb.Direction=sd.Qbc,tb.Duration=900,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionZoom",Hb.next="TransitionZoomOut",Hb));let rc,yc;this.Gc.$("TransitionZoomOut",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionOut,yc.Bc=Kd.Lc("TransitionZoomOut"),yc.yc=(rc=new Bd,rc.TransitionType=qd.zoom,rc.Direction=sd.lme,rc.Duration=900,rc.IsManualAdvance=!0,rc),yc.parent="TransitionZoom",yc.next="TransitionZoomAndRotate",yc));let xc,ld;this.Gc.$("TransitionZoomAndRotate",
(ld=new Ld,ld.wc=ResourceStrings.L_TransitionZoomAndRotate,ld.Bc=Kd.Lc("TransitionNewsFlash"),ld.yc=(xc=new Bd,xc.TransitionType=qd.aqm,xc.Direction=sd.none,xc.Duration=1500,xc.IsManualAdvance=!0,xc),ld.parent="TransitionZoom",ld))}if(!Array.contains(pa,"random")){let Fa,Ma;this.Gc.$("TransitionRandom",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionRandom,Ma.Bc=Kd.Lc("TransitionRandom"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.random,Fa.Direction=sd.eTj,Fa.Duration=1500,Fa.IsManualAdvance=!0,Fa),Ma.parent=
"TransitionRandom",Ma))}}if(!Array.contains(pa,"menusectiondynamiccontent")){if(!Array.contains(pa,"pan")){let Fa,Ma;this.Gc.$("TransitionPan",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionPan,Ma.Bc=Kd.Lc("TransitionPanFromBottom"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.pan,Fa.Direction=sd.qVa,Fa.Duration=1300,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionPan",Ma.next="TransitionPanFromBottom",Ma));this.Gc.$("TransitionPanFromBottom",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromBottom,
Bc:Kd.Lc("TransitionPanFromBottom"),yc:Object.assign(new Bd,{TransitionType:qd.pan,Direction:sd.qVa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Gc.$("TransitionPanFromLeft",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromLeft,Bc:Kd.Lc("TransitionPanFromLeft"),yc:Object.assign(new Bd,{TransitionType:qd.pan,Direction:sd.dGa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Gc.$("TransitionPanFromRight",
Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromRight,Bc:Kd.Lc("TransitionPanFromRight"),yc:Object.assign(new Bd,{TransitionType:qd.pan,Direction:sd.c$,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Gc.$("TransitionPanFromTop",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionFromTop,Bc:Kd.Lc("TransitionPanFromTop"),yc:Object.assign(new Bd,{TransitionType:qd.pan,Direction:sd.vAb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(pa,
"conveyor")){this.Gc.$("TransitionConveyor",Object.assign(new Ld,{wc:ResourceStrings.L_TransitionConveyor,Bc:Kd.Lc("TransitionConveyorRight"),yc:Object.assign(new Bd,{TransitionType:qd.a7d,Direction:sd.c$,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let Fa,Ma;this.Gc.$("TransitionConveyorFromRight",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionFromRight,Ma.Bc=Kd.Lc("TransitionConveyorRight"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.a7d,Fa.Direction=
sd.c$,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionConveyor",Ma.next="TransitionConveyorFromLeft",Ma));let tb,Hb;this.Gc.$("TransitionConveyorFromLeft",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromLeft,Hb.Bc=Kd.Lc("TransitionConveyorLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.a7d,tb.Direction=sd.dGa,tb.Duration=1600,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionConveyor",Hb))}if(!Array.contains(pa,"rotate")){let Fa,Ma;this.Gc.$("TransitionRotate",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionRotate,
Ma.Bc=Kd.Lc("TransitionRotateLeft"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.PN,Fa.Direction=sd.Oeg,Fa.Duration=2E3,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionRotate",Ma.next="TransitionRotateFromRight",Ma));let tb,Hb;this.Gc.$("TransitionRotateFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionRotateLeft"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.PN,tb.Direction=sd.Oeg,tb.Duration=2E3,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionRotate",Hb.next="TransitionRotateFromBottom",
Hb));let rc,yc;this.Gc.$("TransitionRotateFromBottom",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromBottom,yc.Bc=Kd.Lc("TransitionRotateTop"),yc.yc=(rc=new Bd,rc.TransitionType=qd.PN,rc.Direction=sd.qrj,rc.Duration=2E3,rc.IsManualAdvance=!0,rc),yc.parent="TransitionRotate",yc.next="TransitionRotateFromLeft",yc));let xc,ld;this.Gc.$("TransitionRotateFromLeft",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromLeft,ld.Bc=Kd.Lc("TransitionRotateRight"),ld.yc=(xc=new Bd,xc.TransitionType=qd.PN,xc.Direction=
sd.yrj,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),ld.parent="TransitionRotate",ld.next="TransitionRotateFromTop",ld));let wd,t;this.Gc.$("TransitionRotateFromTop",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromTop,t.Bc=Kd.Lc("TransitionRotateBottom"),t.yc=(wd=new Bd,wd.TransitionType=qd.PN,wd.Direction=sd.Jrj,wd.Duration=2E3,wd.IsManualAdvance=!0,wd),t.parent="TransitionRotate",t))}if(!Array.contains(pa,"window")){let Fa,Ma;this.Gc.$("TransitionWindow",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionWindow,
Ma.Bc=Kd.Lc("TransitionWindowVertical"),Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.window,Fa.Direction=sd.edb,Fa.Duration=1500,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionWindow",Ma.next="TransitionWindowVertical",Ma));let tb,Hb;this.Gc.$("TransitionWindowVertical",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionVertical,Hb.Bc=Kd.Lc("TransitionWindowVertical"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.window,tb.Direction=sd.edb,tb.Duration=1500,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionWindow",Hb.next=
"TransitionWindowHorizontal",Hb));let rc,yc;this.Gc.$("TransitionWindowHorizontal",(yc=new Ld,yc.wc=ResourceStrings.L_TransitionHorizontal,yc.Bc=Kd.Lc("TransitionWindowHorizontal"),yc.yc=(rc=new Bd,rc.TransitionType=qd.window,rc.Direction=sd.Q2c,rc.Duration=1500,rc.IsManualAdvance=!0,rc),yc.parent="TransitionWindow",yc))}if(!Array.contains(pa,"orbit")){let Fa,Ma;this.Gc.$("TransitionOrbit",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionOrbit,Ma.Bc=Kd.Lc("TransitionOrbitFromRight"),Ma.yc=(Fa=new Bd,
Fa.TransitionType=qd.PN,Fa.Direction=sd.Neg,Fa.Duration=1600,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionOrbit",Ma.next="TransitionOrbitFromRight",Ma));let tb,Hb;this.Gc.$("TransitionOrbitFromRight",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionFromRight,Hb.Bc=Kd.Lc("TransitionOrbitFromRight"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.PN,tb.Direction=sd.Neg,tb.Duration=1600,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionOrbit",Hb.next="TransitionOrbitFromBottom",Hb));let rc,yc;this.Gc.$("TransitionOrbitFromBottom",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionFromBottom,yc.Bc=Kd.Lc("TransitionOrbitFromBottom"),yc.yc=(rc=new Bd,rc.TransitionType=qd.PN,rc.Direction=sd.prj,rc.Duration=1600,rc.IsManualAdvance=!0,rc),yc.parent="TransitionOrbit",yc.next="TransitionOrbitFromLeft",yc));let xc,ld;this.Gc.$("TransitionOrbitFromLeft",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionFromLeft,ld.Bc=Kd.Lc("TransitionOrbitFromLeft"),ld.yc=(xc=new Bd,xc.TransitionType=qd.PN,xc.Direction=sd.xrj,xc.Duration=1600,xc.IsManualAdvance=
!0,xc),ld.parent="TransitionOrbit",ld.next="TransitionOrbitFromTop",ld));let wd,t;this.Gc.$("TransitionOrbitFromTop",(t=new Ld,t.wc=ResourceStrings.L_TransitionFromTop,t.Bc=Kd.Lc("TransitionOrbitFromTop"),t.yc=(wd=new Bd,wd.TransitionType=qd.PN,wd.Direction=sd.Irj,wd.Duration=1600,wd.IsManualAdvance=!0,wd),t.parent="TransitionOrbit",t))}if(!Array.contains(pa,"flythrough")){let Fa,Ma;this.Gc.$("TransitionFlyThrough",(Ma=new Ld,Ma.wc=ResourceStrings.L_TransitionFlyThrough,Ma.Bc=Kd.Lc("TransitionFlyThroughIn"),
Ma.yc=(Fa=new Bd,Fa.TransitionType=qd.h$b,Fa.Direction=sd.Qbc,Fa.Duration=800,Fa.IsManualAdvance=!0,Fa),Ma.parent="TransitionFlyThrough",Ma.next="TransitionFlyThroughIn",Ma));let tb,Hb;this.Gc.$("TransitionFlyThroughIn",(Hb=new Ld,Hb.wc=ResourceStrings.L_TransitionIn,Hb.Bc=Kd.Lc("TransitionFlyThroughIn"),Hb.yc=(tb=new Bd,tb.TransitionType=qd.h$b,tb.Direction=sd.Qbc,tb.Duration=800,tb.IsManualAdvance=!0,tb),Hb.parent="TransitionFlyThrough",Hb.next="TransitionFlyThroughOut",Hb));let rc,yc;this.Gc.$("TransitionFlyThroughOut",
(yc=new Ld,yc.wc=ResourceStrings.L_TransitionOut,yc.Bc=Kd.Lc("TransitionFlyThroughOut"),yc.yc=(rc=new Bd,rc.TransitionType=qd.h$b,rc.Direction=sd.lme,rc.Duration=800,rc.IsManualAdvance=!0,rc),yc.parent="TransitionFlyThrough",yc.next="TransitionFlyThroughInWithBounce",yc));let xc,ld;this.Gc.$("TransitionFlyThroughInWithBounce",(ld=new Ld,ld.wc=ResourceStrings.L_TransitionInWithBounce,ld.Bc=Kd.Lc("TransitionFlyThroughIn"),ld.yc=(xc=new Bd,xc.TransitionType=qd.h$b,xc.Direction=sd.Rpj,xc.Duration=900,
xc.IsManualAdvance=!0,xc),ld.parent="TransitionFlyThrough",ld.next="TransitionFlyThroughOutWithBounce",ld));let wd,t;this.Gc.$("TransitionFlyThroughOutWithBounce",(t=new Ld,t.wc=ResourceStrings.L_TransitionOutWithBounce,t.Bc=Kd.Lc("TransitionFlyThroughOut"),t.yc=(wd=new Bd,wd.TransitionType=qd.h$b,wd.Direction=sd.Spj,wd.Duration=900,wd.IsManualAdvance=!0,wd),t.parent="TransitionFlyThrough",t))}}this.Gc.forEach((Fa,Ma)=>{Fa===Ma.parent&&++Z;return!0})}pWa(z){let Z=null;z?this.Gc.forEach((pa,Fa)=>{Fa.yc&&
Fa.yc.TransitionType===z.TransitionType&&Fa.yc.Direction===z.Direction&&(Z=pa);return!0}):Z="TransitionNone";return Z}HR(z){return this.Gc.ga(z)}aCb(z){return(z=this.pWa(z))?this.Gc.ga(this.Gc.ga(z).parent):null}qWa(z){return(z=this.pWa(z))?this.Gc.ga(z).parent:null}Qlg(z){let Z,pa=null;Z=null;z&&z.next&&(Z=z.next,pa=this.HR(Z));return{returnValue:pa,key:Z}}iBb(){var z=[Kd.Vrj,Kd.msl,Kd.nsl];for(const Z of z)if(z=document.getElementById(Z))return z;return null}r9c(z,Z){return z&&Z&&Z.childNodes?z.startsWith(Kd.Wrj)?
Z.contains(document.getElementById(z)):!1:!Z&&z?"TransitionExisting"===z||"TransitionNone"===z||"TransitionMorph"===z||"TransitionCut"===z||"TransitionFade"===z||"TransitionPush"===z||"TransitionWipe"===z:!1}static Lc(z){return ne.a.Fsc+"_"+z+"_32x32x32"}}Kd.Vrj="PptRibbon.Transition.Gallery-MaxSize-1-0";Kd.msl="Transitions";Kd.nsl="Transitions-previewWrapper";Kd.Wrj="Transition";Object(k.a)(Kd,"TransitionHelper",null,[1107]);var Gk=d(180),of=d(1183),om=d(879);class mi{constructor(z,Z,pa,Fa,Ma,tb){this.kFd=
(Hb,rc,yc,xc,ld)=>{if(1===yc)return 32;if(!ld)return 16;rc=this.gb.Hd();if(1!=(null===rc||void 0===rc?void 0:rc.length))return 16;rc=rc[0];xc=new om.a(rc.Nba.brightness,rc.Nba.contrast,rc.Nba.saturation,rc.Nba.transparency);if(2===yc){yc=ld.Number;ld=ld.prm;switch(Hb){case Mc.a.fhf:xc.KOl(yc);break;case Mc.a.ihf:xc.mPl(yc);break;case Mc.a.Vhf:xc.eTl(yc);break;case Mc.a.gif:xc.KUl(yc)}rc.Nba=xc;this.ka.Veg&&this.oim(rc);!ld&&this.ka.Veg||this.cjj(rc,Hb)}return 32};if(!z)throw Error.argumentNull("actionManager");
if(!Z)throw Error.argumentNull("selectionManager");if(!pa)throw Error.argumentNull("pageView");if(!Fa)throw Error.argumentNull("focusManager");if(!Ma)throw Error.argumentNull("transactionFactory");if(!tb)throw Error.argumentNull("appSettings");this.ia=z;this.gb=Z;this.yb=pa;this.Fa=Fa;this.Eb=Ma;this.ka=tb}qb(){this.ia.pa(Mc.a.fhf,Zc.a.application,this.kFd,4);this.ia.pa(Mc.a.ihf,Zc.a.application,this.kFd,4);this.ia.pa(Mc.a.Vhf,Zc.a.application,this.kFd,4);this.ia.pa(Mc.a.gif,Zc.a.application,this.kFd,
4)}Sd(){}oim(z){var Z;null===(Z=this.ik(z).Nk)||void 0===Z?void 0:Z.handleShapeNodeGC2ModelSync()}ik(z){return null===z||void 0===z?void 0:z.sc(this.yb.Na)}cjj(z,Z){const pa=this.Eb.ud(15,void 0,()=>{this.gb.uj()});try{pa.mc(z),pa.Wc=Z}finally{null===pa||void 0===pa?void 0:pa.dispose()}}}Object(k.a)(mi,"PictureEffectsActor",null,[948]);class Oe{constructor(){this.yh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}fc(z){this.K=z;this.yh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").AGa(0,
this.name);this.K.register(1072,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().na(()=>new Nf(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").iR){const Z=Gk.a(this.K);this.K.register(1073,"PowerPointWebEditor.IAudioManagerStore").ma().na(()=>new Jf);this.K.register(1074,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().na(()=>new Nd(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").iR,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Ha("PowerPointWebEditor.IAudioManagerStore")));this.K.register(1075,"PowerPointWebEditor.IAudioManagerFactory").ma().na(()=>new qe(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),Z,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");
this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let z=this.yh.Mu("resolve");var Z=this.K.resolve("Common.AFrameworkApplication");const pa=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Fa=pa.td;Z=Z.Qp;const Ma=this.K.resolve("Common.IActionManagerExtended"),tb=this.K.resolve("PowerPointWebEditor.IFocusManager");Z=Z.ie;const Hb=this.K.resolve("Common.Transaction.ITransactionFactory"),rc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),yc=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
xc=this.K.resolve("PowerPointWebEditor.PictureContext"),ld=this.K.resolve("PowerPoint.IPathManager");var wd=this.K.resolve("PowerPointWebEditor.IPresentationReader");const t=this.K.resolve("PowerPointWebEditor.IShapeReader"),aa=this.K.resolve("PowerPointWebEditor.IPictureUploader"),ra=this.K.ze("PowerPointWebEditor.IPPTLanguageDialogFactory"),Na=this.K.resolve("Box4.IParagraphReader");this.yh.Su(z);z=this.yh.Mu("regactors");wd=[new Wc(Ma,rc,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),
this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),Na,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),t,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),Eb.App.uOa.BTc(12),Fa.telemetryForPptParagraphSettingEnabled),new Yb(Ma,tb,yc,Hb,rc,ld,Z,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wd,new vb,Fa.BDg,this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("ChangingThemeSelectedSlidesEnabled"),
this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("EnableDefaultThemeRefresh"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")),new Gc(Ma,Z,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Hb,rc,tb,new Kd(Fa.FOa),yc,Fa,ld,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];Fa.Ovb?wd.push(new nf(Ma,rc,tb,Hb,new fd(Fa.S0d),yc,t,ld,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Fa.yNc,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"))):wd.push(new Ud(Ma,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),rc,tb,Hb,new fd(Fa.S0d),yc,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
t,ld));Fa.powerPointFormatBackgroundEnabled&&wd.push(new Qi(Ma,tb,yc,rc,Hb,Z,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),aa,xc,H.AFrameworkApplication.YR,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Fa));Fa.JSa&&wd.push(new mi(Ma,rc,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));Fa.xAb&&H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureBGREnabled",
!1)&&wd.push(new of.a(Ma,this.K.resolve("PowerPointWebEditor.Core.IAppOfflineSetter"),rc,this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),this.K.resolve("PowerPointWebEditor.IImageIdHelper"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));
for(const db of wd)db.qb(),db.Sd();this.yh.Su(z);H.AFrameworkApplication.fa.Ue(()=>{z=this.yh.Mu("regfullactors");const db=[],kb=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");kb.aYa=this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("299");pa.td.ZNb&&db.push(new rd(Ma,ra,kb,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.Ha("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),rc));this.K.resolve("PowerPointWebEditor.IApplicationSettings").tdc&&db.push(new kk(Ma,tb,rc,Gk.a(this.K),this.K.resolve("Common.IAppSettingsManager")));for(const Ib of db)Ib.qb(),Ib.Sd();kb.aYa&&(new ei(Ma,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(Ib,Rb)=>new $e(Ib,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),
Rb,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),rc,this.K.resolve("Box4.ILanguageReader"),t)).qb();this.yh.Su(z)})}dispose(){}}Object(k.a)(Oe,"AdvancedPackage",null,[2,3]);class Ol{get container(){return ia.a.instance.resolve("PowerPointWebEditor.IRibbonPane").va}}Object(k.a)(Ol,"PPTFloatPaneContainer",null,[1009]);class pm{constructor(z,Z,pa=null){this.Djb=new Cf.a(0);this.C1a=null;this.olb=this.C1a=Eb.App.Xn;this.tGe=z;this.Ueh=1E3*Z;this.oTg=
pa||(()=>(new Date).getTime())}cIi(z){this.tGe&&this.Djb.add(z,(new Date).getTime())}a9f(z){this.tGe&&(this.Djb.remove(z),this.Uam(this.oTg()-this.Ueh))}Uam(z){if(this.Djb.count){var Z=[];this.Djb.forEach((pa,Fa)=>{Fa<z&&Z.push(pa);return!0});for(const pa of Z)this.Djb.remove(pa)}}get VBg(){return this.olb<=this.C1a}I0j(){if(!this.tGe||!this.Djb.count)return!1;let z=!1;const Z=this.oTg();this.Djb.forEach((pa,Fa)=>Z-Fa<this.Ueh?(z=!0,!1):!0);return z}}Object(k.a)(pm,"PictureContext",null,[1079]);var tk=
d(930),Oj=d(525);class yk{constructor(){this.Ehb=this.eLe=this.I_g=this.J_g=!1;this.yh=this.M6=this.nJb=this.e0g=this.K=null;this.djc=[new Oe];this.lZ=[]}get name(){return"PowerPointWebEditor.Chronos"}fc(z){this.K=z;this.M6=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.yh=this.M6.AGa(0,this.name);for(let Z=0;Z<this.djc.length;++Z)Array.add(this.lZ,gf.a(this.djc[Z],0));for(const Z of this.lZ)Z.fc(z);yk.kYi(z);this.K.register(pm,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().na(()=>
new pm(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}vrc(z,Z){z=ag.a.instance;for(let Fa=0;Fa<Z.entries.length;Fa++){var pa=Z.entries[Fa];pa.url=C.a.removeParameter(pa.url,H.AFrameworkApplication.fU);const Ma=C.a.Vba(pa.url);let tb=!1;if("about:blank"===pa.url||Ma.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Ma&&"2"===C.a.VO(pa.url,
"u")||this.Ehb&&(tb=Ma.endsWith("PowerPoint.ashx"))&&pa.url.endsWith("ib=1"))pa.behavior=1;else{if(tb||Ma.endsWith("PowerPoint.ashx")||Ma.endsWith("GetUpdates")||Ma.endsWith("images.ashx")||Ma.endsWith("GetThumb"))pa.behavior=2;if(!this.J_g&&Ma.endsWith("PowerPoint.ashx")&&"true"===C.a.VO(pa.url,ta.a.edl))pa=pa.hD,z.Xb(de.a.D6d,parseInt(String(pa.fetchStart))),z.Xb(de.a.A_i,parseInt(String(pa.responseStart))),z.Xb(de.a.s_i,parseInt(String(pa.responseEnd-pa.responseStart))),this.J_g=!0;else if(!this.I_g&&
Ma.endsWith("PowerPoint.ashx")&&"true"===C.a.VO(pa.url,"dSlide")){this.I_g=!0;pa=pa.hD;z.Xb("SlideImageFetchStart",parseInt(String(pa.fetchStart)));z.Xb("SlideImageResponseStart",parseInt(String(pa.responseStart)));z.Xb("SlideImageDownloadDuration",parseInt(String(pa.responseEnd-pa.responseStart)));let Hb;({transferSize:Hb}=yk.j0h(pa)).returnValue&&z.Xb("SlideImageSize",Hb)}else if(!this.eLe&&Ma.endsWith("images.ashx")&&"true"===C.a.VO(pa.url,"minimalboot")&&C.a.VO(pa.url,"index")===this.e0g){this.eLe=
!0;pa=pa.hD;z.Xb("MBootFetchStart",parseInt(String(pa.fetchStart)));z.Xb("MBootResponseStart",parseInt(String(pa.responseStart)));z.Xb("MBootDownload",parseInt(String(pa.responseEnd-pa.responseStart)));let Hb;({transferSize:Hb}=yk.j0h(pa)).returnValue&&z.Xb("MBootSize",Hb)}}}}DRl(){const z=window.self.FirstSlideRequestIndex;void 0===z||null===z?this.eLe=!0:this.e0g=z.toString()}init(){Qc.a.J(512497358,809,50,"ChronosPackage::Init");const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
Z=this.K.resolve("Common.ITaskManager");for(var pa of this.lZ)this.yh.Mu(pa.name),pa.init(),this.yh.Su(pa.name);this.K.resolve("Common.IAppSettingsManager").Ue(()=>{if(z.podsAnimationSuggestionEnabled){const Fa=this.yh.Mu("animationpreview");this.M9j();this.yh.Su(Fa)}});this.K.resolve("Common.IActionManagerExtended").a3(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));pa=ia.a.instance.resolve("Box4.IProofingManager");if(null!==pa){const Fa=this.yh.Mu("proofingresume");pa.resume();this.yh.Su(Fa)}if(z.owa||
!z.iYa)pa=this.yh.Mu("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").sUh(),this.yh.Su(pa);this.DRl();this.Ehb=z.podsUseRealtimeCoauthReplicationTimerForInbound;pa=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");pa.fc(30,0);pa.rLf(Object(ib.a)(this,this.vrc,"onResourceTimingEntriesAvailable"));pa.activate();z.TXa&&(this.nJb=window.self.PerfMeterData,void 0!==this.nJb&&null!==this.nJb&&(Z.Jb(new ee.a(3,2,6E4,Object(ib.a)(this,this.collectPerfMeterData,
"collectPerfMeterData"),90,"67")),Qc.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").aC(()=>{this.collectPerfMeterData(null)})));this.K.resolve("Common.IActionManagerExtended").a3(this.K.resolve("Box4.ITextPasteFloatieManager"));z.Cbb&&this.K.resolve("Common.IActionManagerExtended").a3(this.K.resolve("PowerPointWebEditor.EditSurfaceLayoutManager"));this.jxk()}jxk(){Qc.a.J(512497356,809,50,"Start to download chronos1 js file");
this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1312)))}collectPerfMeterData(){if(0<this.nJb.length){const z=[];for(const Z of this.nJb)z.push({["Id"]:Z.Id,["Value"]:Z.Value.toFixed(2),["Start"]:Z.Start.toFixed(2),["Duration"]:Z.Duration.toFixed(2)});Qc.a.J(512497355,813,50,JSON.stringify(z));this.nJb.length=0}}dispose(){for(var z of this.lZ)z.dispose();z=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");z.deactivate(!0);
z.FDh(Object(ib.a)(this,this.vrc,"onResourceTimingEntriesAvailable"))}M9j(){const z=wa.a.create("pptedit.animationpreview",null,()=>d.e(19).then(d.bind(null,1330)));try{da.a.bF(z)}catch(Z){Qc.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",Z.toString())}}static kYi(z){z.register(1009,"Common.IFloatPaneContainer").ma().na(()=>new Ol)}static j0h(z){z=parseInt(String(tk.a(z,"transferSize")));return{returnValue:!z.toString().startsWith("NaN"),
transferSize:z}}static main(){H.AFrameworkApplication.Dh&&ba.a.jg?Qc.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(ag.a.instance.Xb(Oj.a.E4d,(new Date).getTime()),Qa.a.instance.Ac(gf.a(new yk,0)))}}Object(k.a)(yk,"ChronosPackage",null,[2,3]);class bm{constructor(z,Z,pa,Fa,Ma,tb,Hb){this.iKb=this.ZM=!1;this.sa=z;this.nc=Z;this.Qs=pa;this.Qt=Fa;this.Vfb=tb;this.ue=Ma;this.$u=this.sa.Aa;this.Jc=Hb}initialize(){this.Qs.Ak(Object(ib.a)(this,this.ph,"onPropertyChanged"));
this.ue.BSa(Object(ib.a)(this,this.Mha,"onRibbonTabSwitched"));this.Qt.kU(Object(ib.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Qt.yvb(Object(ib.a)(this,this.hza,"onShapeViewElementAdded"));this.Qt.GAi(Object(ib.a)(this,this.Iph,"onShapesAllSelected"))}dispose(){this.Qs.tn(Object(ib.a)(this,this.ph,"onPropertyChanged"));this.ue.Nvc(Object(ib.a)(this,this.Mha,"onRibbonTabSwitched"));this.Qt.wqa(Object(ib.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Qt.vvd(Object(ib.a)(this,
this.hza,"onShapeViewElementAdded"));this.Qt.zCl(Object(ib.a)(this,this.Iph,"onShapesAllSelected"))}ph(z,Z){Z.property===Md.a.mZc&&this.ZM&&this.nc.ug(Z.node)===this.$u&&this.Nza(this.ZM)}Mha(z,Z){if(this.ZM=!!Z.zha&&0<=Z.zha.indexOf("Animation"))this.iKb=!0;this.Nza(this.ZM)}hza(z,Z){(z=this.sa.Aa)&&z.nP&&z===this.$u&&(Z=Z.Vx)&&Z.shapeNode&&this.$u&&this.eIa(this.$u.Fb,Z.shapeNode)&&this.Nza(this.ZM)}eIa(z,Z){return z&&Z?z.equals(Z.slideId):!1}onActiveSlideDomReady(z,Z){(z=Object(w.a)(205,Z.Aa))&&
this.$u&&this.$u.Fb!==z.Fb&&(this.$u=z,this.Nza(this.ZM))}Iph(){this.fca()}fca(){if(this.ZM&&this.$u&&this.$u.XGa&&this.iKb){var z=this.$u.yj();if(z&&0<z.length)for(const Z of z)Z&&Z.leb()&&(z=this.Vfb.$J(Z))&&(z.x5b(),z.fca(!0))}}Nza(z){if(this.iKb&&this.$u&&this.$u.nP&&this.Jc.Ic&&this.Jc.Ic.bPc){var Z=this.$u.yj();if(Z&&0<Z.length)for(const pa of Z)pa&&(Z=this.Vfb.$J(pa))&&(Z.visible=z,Z.omb())}}}Object(k.a)(bm,"AnimationMarkerManagerLegacy",null,[106]);var Hk=d(75),Af=d(58);class rg{constructor(z,
Z){this.height=z;this.top=Z}}Object(k.a)(rg,"ParagraphProperties",null,[]);var Li=d(48),Vf=d(70),Ej=d(139),Tj=d(162),dj=d(199),Pl=d(189);class Si{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd,t,aa,ra){this.hmc=this.iB=this.cKb=this.rl=this.Mb=!1;this.ua=new Hk.a;this.Amc=this.Jd=1;this.Nn=this.Mn=this.zh=this.Bb=this.wb=null;this.Cn=Na=>{Na&&this.OP?(this.wb=new Ej.a,this.wb.ot("AnimationMarkerView"),this.OP.appendChild(this.wb.va),this.Bb=new Pl.a,this.Bb.xk(0),this.wb.appendChild(this.Bb.viewport),
this.zh=new Tj.a,this.zh.xk(1),this.zh.setVisibility(!1),this.Bb.appendChild(this.zh),this.Mn=new Ej.a,this.Mn.ot("ShapeAnimationMarkerContainer"),this.Mn.va.id=this.ta.id.toString(),this.Mn.Mh(20,this.wb.va.clientHeight),this.Mn.xk(1),this.wb.appendChild(this.Mn),this.Nn=new Ej.a,this.Nn.ot("TextAnimationMarkerContainer"),this.Nn.va.id=this.ta.id.toString(),this.Nn.Mh(20,this.wb.va.clientHeight),this.Nn.xk(1),this.wb.appendChild(this.Nn),this.og.xb(ob.a.Wq,this.Mn.va,this.nE),this.og.xb(ob.a.Rt,
this.Mn.va,this.nE),this.og.xb(ob.a.Wq,this.Nn.va,this.nE),this.og.xb(ob.a.Rt,this.Nn.va,this.nE),this.og.xb(ob.a.WK,this.Mn.va,this.xWa),this.og.xb(ob.a.WK,this.Nn.va,this.xWa),this.og.xb(ob.a.mouseDown,this.Mn.va,this.xWa),this.og.xb(ob.a.mouseDown,this.Nn.va,this.xWa),this.hd.xb(ob.a.click,this.Nn.va,this.d3c),this.hd.xb(ob.a.click,this.Mn.va,this.d3c),this.setVisibility()):Qc.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",Na?"m_markerViewParentElement":"parent")};this.aP=()=>!0;this.xWa=
Na=>{if(!Na&&!Na.Ec.id.startsWith(ne.a.I9a)&&!Na.Ec.id.startsWith("overlappedMarker"))return Qc.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;Na.eventName==ob.a.WK&&this.aVe(Na);Na=Na.hc;Na.preventDefault();Na.stopPropagation();return!0};this.d3c=Na=>{Na=Na.hc;Na.preventDefault();Na.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let Na=this.Mb&&!this.iB;this.ta&&this.ta.isHiddenShape&&(Na=!1);this.wb&&this.wb.ee(Na);
this.Mn&&this.Mn.ee(Na);this.Nn&&this.Nn.ee(Na)};this.fca=Na=>{if(this.R$()){this.cKb=Na;Na=[this.Mn.va.childNodes,this.Nn.va.childNodes];for(const db of Na)for(Na=0;db&&Na<db.length;Na++)this.Ywc(db[Na],this.cKb)}};this.HLl=Na=>{if(this.R$()){var db=[this.Mn.va.childNodes,this.Nn.va.childNodes];for(const kb of db)for(db=0;kb&&db<kb.length;db++){const Ib=this.FAb(kb[db]);if(!Pf.a("FixAnimationMarkerAttributeNullCrash")||Ib)for(const Rb of Na)Ib.includes(Rb)&&this.Ywc(kb[db],!0)}}};this.FAb=Na=>{if(!Na||
!this.ta)return null;Na=Na.getAttribute("AnimProps");if(!Na||!Na.toString()||!Na.toString().trim().length)return null;Na=Na.toString().split(" ");if(!Na||!Na.length)return null;const db=[];for(const kb of Na){if(!kb||!kb.trim().length)return null;db.push(Number.parseInvariant(kb.trim()))}return db};this.R$=()=>{const Na=!!this.ta&&!!this.OP&&!!this.Mn&&!!this.Nn;Na||Qc.a.J(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return Na};this.wTa=()=>{this.nla(!0);this.nla(!1)};this.nla=
Na=>{if(this.og&&this.hd&&this.R$()&&(Na=Na?this.Nn.va:this.Mn.va)&&Na.childNodes&&0<Na.childNodes.length){const db=Na.childNodes;for(const kb=0;kb<db.length;)Na.removeChild(db[kb])}};this.FYd=()=>{if(this.R$()){var Na=this.nc.ug(this.ta);if(Na){var db=Na.hBb(this.ta);if(db&&db.length){var kb=!1;Na=!1;var Ib=[];for(var Rb of db)Rb.IsTextRangeType?Na=!0:(kb=!0,Ib.push(Rb));this.hmc=kb&&Na;this.OOa(!0);this.OOa(!1);this.nla(!1);0<Ib.length&&(Rb=0,Ib.sort((Cb,cc)=>Cb.EffectNodeId-cc.EffectNodeId),(Rb=
Pf.a("FixOverlappedAnimationMarkers")?this.s8b(Ib,this.Ji.dJ(this.ta.Ko.pc,this.Jd),this.Ji.dJ(this.ta.Ko.jc-this.ta.Ko.pc,this.Jd),!1,-1):this.n7f(Ib,this.Ji.dJ(this.ta.Ko.pc,this.Jd),this.Ji.dJ(this.ta.Ko.jc-this.ta.Ko.pc,this.Jd),!1))||Qc.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));Na?this.Rbe():this.nla(!0)}else this.wTa()}else Qc.a.J(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.Rbe=()=>{const Na=new ee.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,
90,"26");this.zb.Jb(Na)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.rl||(this.DEe(),this.t8b())};this.t8b=()=>{this.nla(!0);if(this.Pne()){var Na=this.Dke();if(Na&&Na.length){var db;if(({top:db}=this.Mke()).returnValue){var kb=0;for(let Rb=0;Rb<Na.length;Rb++){var Ib=this.nc.ug(this.ta);if(!Ib){Qc.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(Ib=Ib.tje(this.ta,Rb))&&0<Ib.length&&Na[Rb]&&(Ib.sort((Cb,cc)=>Cb.EffectNodeId-cc.EffectNodeId),kb=
Pf.a("FixOverlappedAnimationMarkers")?kb+this.s8b(Ib,Na[Rb].top-db,Na[Rb].height,!0,Rb):kb+this.n7f(Ib,Na[Rb].top-db,Na[Rb].height,!0))}kb||Qc.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Qc.a.J(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Qc.a.J(509682576,800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.Dke=()=>{const Na=[];var db=Qf.GraphIterator.ob(this.ta);db=this.zm.R4(db,db.currentNode);for(var kb;db.moveNext();)(kb=
db.currentNode)&&this.Uh.ke(kb)&&kb&&(kb=kb.sc(this.uA))&&kb.htmlElement&&(kb=this.wva(kb.htmlElement))&&kb.height&&Na.push(kb);return Na};this.wva=Na=>{if(!Na)return Qc.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;Na=Na.querySelectorAll(".TextRun");if(!Na||!Na.length)return null;let db=0,kb=0;let Ib,Rb=!1;for(let cc=0;cc<Na.length&&Na[cc];cc++){var Cb=Na[cc].getClientRects();({top:Cb,bottom:Ib}=this.Hde(Cb)).returnValue&&(cc?(db=db>Cb?Cb:db,kb=kb<Ib?Ib:
kb):(db=Cb,kb=Ib),Rb=!0)}if(Rb)return new rg(kb-db,db);Qc.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.pL=()=>{this.kPe(this.wb.va,!0)};this.Pne=()=>{var Na=this.nc.ug(this.ta);if(!Na)return Qc.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;Na=Na.hBb(this.ta);if(!Na||!Na.length)return!1;for(const db of Na)if(db.IsTextRangeType)return!0;return!1};this.OOa=Na=>{if(this.R$()){var db=Na?this.Mn.va:this.Nn.va,
kb,Ib;db&&({x:kb,y:Ib}=this.Rie(Na)).returnValue&&(db.style.position=Vf.a.absolute,db.style.left=Li.a.Rc(kb),db.style.zIndex="20000",Na?db.style.top=Li.a.Rc(Ib):this.t8b())}};this.aVe=Na=>{if(this.ua&&Na&&this.Fa&&Na.Ec){var db=Pf.a("FixOverlappedAnimationMarkers")?Na.Ec.id.startsWith("overlappedMarker")&&Na.Ec.parentElement?Na.Ec.parentElement:Na.Ec:Na.Ec.id.startsWith("overlappedMarker")&&Na.Ec.offsetParent?Na.Ec.offsetParent:Na.Ec;(db=this.FAb(db))?(Na.ctrlKey?this.vk.STj(db,this.nc.ug(this.ta)):
(this.vk.ARb(!1),this.vk.Kea(),this.vk.ARb(!0),this.vk.tZd(db,this.nc.ug(this.ta))),this.ua.raiseEvent("OnMarkerClick",Na),this.Fa.Gd()):Qc.a.J(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.Gm=()=>{this.Bb&&(this.yUb(),this.Bb.Gm())};this.yUb=()=>{if(this.ta&&this.zh){var Na=this.ta.Ko.points;Na=Si.xta(Na,this.PBb());this.zh.yu(Na)}};this.PBb=()=>{let Na=ne.a.zQb;this.ta.ig||!this.ta.twa&&!this.ta.Sk||(Na+=6);return Na};this.Jq=()=>{this.Bb&&this.Amc!==
this.Jd&&this.omb();return null};this.Kr=()=>{};this.Tv=()=>{};this.Pj=Na=>{this.Amc=this.Jd;this.Jd=Na};this.setZIndex=Na=>{this.Bb&&this.Bb.xE(Na)};this.draw=()=>{this.omb()};this.omb=()=>{this.wb&&this.OP&&this.Mb&&!this.iB&&(this.wTa(),this.FYd());this.setVisibility()};this.nE=Na=>{if(!this.ua||!Na)return!1;this.ua.raiseEvent("OnSelectionAreaHover",Na);Na.eventName===ob.a.Wq?this.k3(Na.Ec,"animMarkerHovered",1):Na.eventName===ob.a.Rt&&this.k3(Na.Ec,"animMarkerHovered",2);return!0};this.Ywc=(Na,
db)=>{Na?db?(this.k3(Na,"animMarkerUnselected",2),this.k3(Na,"animMarkerSelected",1)):(this.k3(Na,"animMarkerSelected",2),this.k3(Na,"animMarkerUnselected",1)):Qc.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.k3=(Na,db,kb)=>{const Ib=this.A3c(Na);switch(kb){case 0:Na.setAttribute(Vf.a.I9,db);Ib&&Na.lastChild.setAttribute(Vf.a.I9,db);break;case 1:Sys.UI.DomElement.addCssClass(Na,db);Ib&&Sys.UI.DomElement.addCssClass(Na.lastChild,db);break;case 2:Sys.UI.DomElement.removeCssClass(Na,
db),Ib&&Sys.UI.DomElement.removeCssClass(Na.lastChild,db)}};this.A3c=Na=>!!Na&&!!Na.lastChild&&!!Na.lastChild.id&&"overlappedMarker"===Na.lastChild.id;this.setPosition=()=>{};this.TF=Na=>{this.iB=Na;this.iB||(this.$s(),this.fca(!0));this.setVisibility()};this.jF=()=>null;this.Ry=()=>{};this.bD=()=>[];this.Xz=()=>{};this.wE=()=>{};this.$s=()=>{!this.rl&&this.OP&&(this.OOa(!0),this.OOa(!1))};this.gUc=()=>{const Na=new dj.a;Na.Mh(10,10);Na.va.setAttribute(Vf.a.I9,"pointer-events-none");Na.Yqa("0 0 2048 2048");
const db=new Tj.a;db.h_("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");db.UF("#E67E22");db.Vv("#FFFF00");db.vs(5);Na.appendChild(db);return Na.va};if(!z)throw Error.argumentNull("shapeNode");if(!Z)throw Error.argumentNull("slideReader");if(!pa)throw Error.argumentNull("traverserFactory");if(!Fa)throw Error.argumentNull("paragraphReader");
if(!Hb)throw Error.argumentNull("activeSlideViewManager");if(!rc)throw Error.argumentNull("mouseInputManager");if(!yc)throw Error.argumentNull("clickInputManager");if(!xc)throw Error.argumentNull("focusManagers");if(!ra)throw Error.argumentNull("effectSelectionManager");if(!wd)throw Error.argumentNull("pptUnitConversion");this.ta=z;this.nc=Z;this.zm=pa;this.Uh=Fa;this.uA=tb;this.kPe=Ma;this.OP=Hb.Ic?Hb.Ic.bPc:null;this.pOe=Hb.Ic?Hb.Ic.czc:null;this.og=rc;this.hd=yc;this.Fa=xc;this.zb=ld;this.saa=
t;this.DEe=aa;this.Ji=wd;this.vk=ra}dispose(){this.rl||(this.saa(),this.rl=!0,this.Mb=!1,this.wTa(),this.hd&&this.Mn&&this.hd.Hb(ob.a.click,this.Mn.va,this.d3c),this.og&&this.Mn&&(this.og.Hb(ob.a.Wq,this.Mn.va,this.nE),this.og.Hb(ob.a.Rt,this.Mn.va,this.nE),this.og.Hb(ob.a.WK,this.Mn.va,this.xWa),this.og.Hb(ob.a.mouseDown,this.Mn.va,this.xWa)),this.Mn=null,this.hd&&this.Nn&&this.hd.Hb(ob.a.click,this.Nn.va,this.d3c),this.og&&this.Nn&&(this.og.Hb(ob.a.Wq,this.Nn.va,this.nE),this.og.Hb(ob.a.Rt,this.Nn.va,
this.nE),this.og.Hb(ob.a.WK,this.Nn.va,this.xWa),this.og.Hb(ob.a.mouseDown,this.Nn.va,this.xWa)),this.Fa=this.Uh=this.ta=this.zm=this.nc=this.Ji=this.vk=this.Bb=this.zh=this.OP=this.wb=this.Nn=null)}get visible(){return this.Mb}set visible(z){this.Mb=z}get Oy(){return this.Bb}get Zq(){return this.zh}get Ee(){return this.wb}Mke(){return this.getClientRects(this.pOe)}getClientRects(z){let Z,pa;Z=pa=0;if(!z)return Qc.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,
left:Z,top:pa};z=z.getClientRects();if(!z||!z.length||!z[0])return Qc.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:Z,top:pa};pa=Math.round(z[0].top);Z=Math.round(z[0].left);return{returnValue:!0,left:Z,top:pa}}Hde(z){let Z,pa;Z=pa=0;if(!z||!z.length||!z[0])return Qc.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:Z,bottom:pa};Z=z[0].top;pa=z[0].bottom;for(let Fa=1;Fa<z.length&&z[Fa];Fa++)Z=z[Fa].top>Z?
Z:z[Fa].top,pa=z[Fa].bottom<pa?pa:z[Fa].bottom;return{returnValue:!0,top:Z,bottom:pa}}n7f(z,Z,pa,Fa){if(!this.R$()||!z||!z.length)return 0;const Ma=Fa?this.Nn.va:this.Mn.va;pa=(pa=Math.floor(this.Ji.Tm(pa)/21))?pa:1;let tb=0,Hb=null,rc=null,yc=!0,xc=!1;for(let t=0;t<z.length;t++){const aa=z[t];var ld=new Ej.a;ld.va.id=ne.a.I9a+aa.ClickOrder;ld.Mh(20,16);ld.xk(1);if(aa.IsTrigger){var wd=this.gUc();ld.va.appendChild(wd)}else ld.va.innerText=aa.ClickOrder.toString();let ra=wd=!1;t<pa?(Fa&&(ld.va.style.position=
Vf.a.absolute,ld.va.style.top=Li.a.Rc(this.Ji.Tm(Z)+21*tb)),xc=this.vk.Xxb(aa.EffectNodeId),ld.va.setAttribute(Vf.a.I9,xc?"animMarkerSelected":"animMarkerUnselected"),Ma.appendChild(ld.va),tb++):t===pa?(yc=yc&&aa.EffectId===Hb.EffectId,wd=!0,ra=Hb.IsTrigger):yc=yc&&aa.EffectId===Hb.EffectId;wd&&rc.va.appendChild(this.oQc(ra,yc,xc));Hb=aa;rc||(rc=ld);Fa?(ld=[],(wd=this.FAb(rc.va))&&ld.push(...wd),ld.push(aa.EffectNodeId),rc.va.setAttribute("AnimProps",ld.join(" "))):ld.va.setAttribute("AnimProps",
aa.EffectNodeId)}this.pL();return tb}s8b(z,Z,pa,Fa){var Ma;if(!this.R$()||!z||!z.length)return 0;const tb=Fa?this.Nn.va:this.Mn.va;pa=(pa=Math.floor(this.Ji.Tm(pa)/21))?pa:1;let Hb=0,rc=null,yc=new Ej.a,xc=!0,ld=!1,wd=!1;for(let Na=0;Na<z.length;Na++){var t=z[Na],aa=new Ej.a;aa.va.id=ne.a.I9a+t.ClickOrder;aa.Mh(20,16);aa.xk(1);if(t.IsTrigger){var ra=this.gUc();aa.va.appendChild(ra)}else aa.va.innerText=t.ClickOrder.toString();Na<pa?(Fa&&(aa.va.style.position=Vf.a.absolute,aa.va.style.top=Li.a.Rc(this.Ji.Tm(Z)+
21*Hb)),aa.va.setAttribute("AnimProps",t.EffectNodeId),ld=this.vk.Xxb(t.EffectNodeId),aa.va.setAttribute(Vf.a.I9,ld?"animMarkerSelected":"animMarkerUnselected"),tb.appendChild(aa.va),Hb++):Na===pa&&yc.va?(xc=xc&&t.EffectId===rc.EffectId,wd=!0,ra=rc.IsTrigger,wd&&yc.va.appendChild(this.oQc(ra,xc,ld))):xc=xc&&t.EffectId===rc.EffectId;if(wd){aa=[];(ra=this.FAb(yc.va))&&aa.push(...ra);aa.push(t.EffectNodeId);yc.va.setAttribute("AnimProps",aa.join(" "));if(Pf.a("FixAnimationMarkerOverlapSelectionIssue"))for(const db of aa){if(ld=
this.vk.Xxb(db))break}else ld=this.vk.Xxb(t.EffectNodeId);yc.va.setAttribute(Vf.a.I9,ld?"animMarkerSelected":"animMarkerUnselected");(t=yc.va.lastElementChild)&&(null===(Ma=null===t||void 0===t?void 0:t.id)||void 0===Ma?0:Ma.startsWith("overlappedMarker"))&&t.setAttribute(Vf.a.I9,"overlappedMarker "+(ld?"animMarkerSelected":"animMarkerUnselected"))}else yc=aa,rc=t}this.pL();return Hb}oQc(z,Z,pa){const Fa=new Ej.a;Fa.va.id="overlappedMarker";Pf.a("FixOverlappedAnimationMarkers")?Fa.va.style.marginTop=
"-13px":Fa.va.style.marginTop=z?"3px":"-13px";Fa.va.setAttribute(Vf.a.I9,"overlappedMarker "+(pa?"animMarkerSelected":"animMarkerUnselected"));Z&&this.k3(Fa.va,"SameEffectOverlapped",1);return Fa.va}Rie(z){let Z,pa;Z=pa=0;if(!this.ta)return{returnValue:!1,x:Z,y:pa};var Fa=Object(w.a)(178,this.ta.sc(this.uA));if(!Fa)return{returnValue:!1,x:Z,y:pa};Fa=Fa.Gs();if(!Fa)return{returnValue:!1,x:Z,y:pa};Z=z?Fa.oc-(this.hmc?61:35):Fa.oc-20-15;pa=Fa.pc;return{returnValue:!0,x:Z,y:pa}}}Si.xta=(z,Z)=>[new Af.a(z[0]._x-
Z,z[0]._y-Z),new Af.a(z[1]._x+Z,z[1]._y-Z),new Af.a(z[2]._x+Z,z[2]._y+Z),new Af.a(z[3]._x-Z,z[3]._y+Z)];Object(k.a)(Si,"AnimationMarkerView",null,[1078,805,806,106]);class Le{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd,t,aa){this.ffd=this.cKb=this.rl=this.Mb=!1;this.fZa=this.Bic=-1;this.hmc=this.iB=!1;this.ua=new Hk.a;this.Amc=this.Jd=1;this.Nn=this.Mn=this.zh=this.Bb=this.wb=null;this.ta=z;this.nc=Z;this.zm=pa;this.Uh=Fa;this.uA=tb;this.kPe=Ma;this.OP=Hb.Ic?Hb.Ic.bPc:null;this.pOe=Hb.Ic?Hb.Ic.czc:
null;this.og=rc;this.hd=yc;this.Fa=xc;this.zb=ld;this.saa=t;this.DEe=aa;this.Ji=wd}dispose(){this.rl||(this.saa(),this.rl=!0,this.Mb=!1,this.x5b(),this.wTa(),this.og&&this.Mn&&(this.og.Hb(ob.a.Wq,this.Mn.va,Object(ib.a)(this,this.nE,"onSelectionAreaHover")),this.og.Hb(ob.a.Rt,this.Mn.va,Object(ib.a)(this,this.nE,"onSelectionAreaHover"))),this.Mn=null,this.og&&this.Nn&&(this.og.Hb(ob.a.Wq,this.Nn.va,Object(ib.a)(this,this.nE,"onSelectionAreaHover")),this.og.Hb(ob.a.Rt,this.Nn.va,Object(ib.a)(this,
this.nE,"onSelectionAreaHover"))),this.Bb=this.zh=this.OP=this.wb=this.Nn=null)}get visible(){return this.Mb}set visible(z){this.Mb=z}get Oy(){return this.Bb}get Zq(){return this.zh}get Ee(){return this.wb}Cn(z){z&&this.OP?(this.wb=new Ej.a,this.wb.ot("AnimationMarkerView"),this.OP.appendChild(this.wb.va),this.Bb=new Pl.a,this.Bb.xk(0),this.wb.appendChild(this.Bb.viewport),this.zh=new Tj.a,this.zh.xk(1),this.zh.setVisibility(!1),this.Bb.appendChild(this.zh),this.Mn=new Ej.a,this.Mn.ot("ShapeAnimationMarkerContainer"),
this.Mn.va.id=this.ta.id.toString(),this.Mn.Mh(20,this.wb.va.clientHeight),this.Mn.xk(1),this.wb.appendChild(this.Mn),this.Nn=new Ej.a,this.Nn.ot("TextAnimationMarkerContainer"),this.Nn.va.id=this.ta.id.toString(),this.Nn.Mh(20,this.wb.va.clientHeight),this.Nn.xk(1),this.wb.appendChild(this.Nn),this.og.xb(ob.a.Wq,this.Mn.va,Object(ib.a)(this,this.nE,"onSelectionAreaHover")),this.og.xb(ob.a.Rt,this.Mn.va,Object(ib.a)(this,this.nE,"onSelectionAreaHover")),this.og.xb(ob.a.Wq,this.Nn.va,Object(ib.a)(this,
this.nE,"onSelectionAreaHover")),this.og.xb(ob.a.Rt,this.Nn.va,Object(ib.a)(this,this.nE,"onSelectionAreaHover")),this.setVisibility()):Qc.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",z?"m_markerViewParentElement":"parent")}aP(z){let Z=!1;z&&z.Ec.id.startsWith(ne.a.I9a)||z.Ec.id.startsWith("overlappedMarker")?(this.aVe(z),Z=!0):(this.x5b(),this.fca(!0));return Z}setSelection(z){if(z&&!this.ffd||!z)this.fca(z),this.x5b()}setVisibility(){let z=this.Mb&&!this.iB;this.ta&&this.ta.isHiddenShape&&
(z=!1);this.wb&&this.wb.ee(z);this.Mn&&this.Mn.ee(z);this.Nn&&this.Nn.ee(z)}fca(z){if(this.R$()){this.cKb=z;z=[this.Mn.va.childNodes,this.Nn.va.childNodes];for(const Z of z)for(z=0;Z&&z<Z.length;z++)this.Ywc(Z[z],this.cKb)}}FAb(z){if(!z||!this.ta)return null;z=z.getAttribute("AnimProps");if(!z||!z.toString()||!z.toString().trim().length)return null;z=z.toString().split(" ");if(!z||4!==z.length)return null;const Z=[];for(const pa of z){if(!pa||!pa.trim().length)return null;Z.push(Number.parseInvariant(pa.trim()))}return Z}R$(){const z=
!!this.ta&&!!this.OP&&!!this.Mn&&!!this.Nn;z||Qc.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return z}wTa(){this.nla(!0);this.nla(!1)}nla(z){if(this.og&&this.hd&&this.R$()&&(z=z?this.Nn.va:this.Mn.va)&&z.childNodes&&0<z.childNodes.length){const Z=z.childNodes;for(const pa=0;pa<Z.length;)z.removeChild(Z[pa])}}FYd(){if(this.R$()){var z=this.Wfg(this.ta);if(z&&z.length){var Z=!1,pa=!1,Fa=[];for(const Ma of z)Ma.IsTextRangeType?pa=!0:(Z=!0,Fa.push(Ma));this.hmc=Z&&pa;this.OOa(!0);
this.OOa(!1);this.nla(!1);0<Fa.length&&(Qc.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.s8b(Fa,this.Ji.dJ(this.ta.Ko.pc,this.Jd),this.Ji.dJ(this.ta.Ko.jc-this.ta.Ko.pc,this.Jd),!1,-1)||Qc.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));pa?this.Rbe():this.nla(!0);if(!pa&&-1!==this.fZa||-1!==this.fZa&&-1===this.fZa&&!Z)this.W4d(),this.fca(!0)}else this.wTa()}}Rbe(){const z=new ee.a(2,1,0,Object(ib.a)(this,this.ensureTextIsRenderedAndDrawMarkers,
"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.zb.Jb(z)}ensureTextIsRenderedAndDrawMarkers(){this.rl||(this.DEe(),this.t8b())}t8b(){this.nla(!0);if(this.Pne(this.ta)){var z=this.Dke();if(z&&z.length){var Z;if(({top:Z}=this.Mke()).returnValue){var pa=0;Qc.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let Ma=0;Ma<z.length;Ma++){var Fa=this.nc.ug(this.ta);if(!Fa)return;(Fa=Fa.j1c(this.ta,Ma))&&0<Fa.length&&z[Ma]&&(pa+=this.s8b(Fa,z[Ma].top-Z,z[Ma].height,!0,
Ma))}pa||Qc.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Qc.a.J(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Qc.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}Dke(){const z=[];var Z=Qf.GraphIterator.ob(this.ta);Z=this.zm.R4(Z,Z.currentNode);for(var pa;Z.moveNext();)(pa=Z.currentNode)&&this.Uh.ke(pa)&&pa&&(pa=pa.sc(this.uA))&&pa.htmlElement&&(pa=this.wva(pa.htmlElement))&&pa.height&&z.push(pa);
return z}Mke(){return this.getClientRects(this.pOe)}getClientRects(z){let Z,pa;Z=pa=0;if(!z)return Qc.a.J(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:Z,top:pa};z=z.getClientRects();if(!z||!z.length||!z[0])return Qc.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:Z,top:pa};pa=Math.round(z[0].top);Z=Math.round(z[0].left);return{returnValue:!0,left:Z,top:pa}}wva(z){if(!z)return Qc.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),
null;z=z.querySelectorAll(".TextRun");if(!z||!z.length)return null;let Z=0,pa=0;let Fa,Ma=!1;for(let Hb=0;Hb<z.length&&z[Hb];Hb++){var tb=z[Hb].getClientRects();({top:tb,bottom:Fa}=this.Hde(tb)).returnValue&&(Hb?(Z=Z>tb?tb:Z,pa=pa<Fa?Fa:pa):(Z=tb,pa=Fa),Ma=!0)}if(Ma)return new rg(pa-Z,Z);Qc.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}Hde(z){let Z,pa;Z=pa=0;if(!z||!z.length||!z[0])return Qc.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:Z,bottom:pa};Z=z[0].top;pa=z[0].bottom;for(let Fa=1;Fa<z.length&&z[Fa];Fa++)Z=z[Fa].top>Z?Z:z[Fa].top,pa=z[Fa].bottom<pa?pa:z[Fa].bottom;return{returnValue:!0,top:Z,bottom:pa}}s8b(z,Z,pa,Fa,Ma){if(!this.R$()||!z||!z.length)return 0;const tb=Fa?this.Nn.va:this.Mn.va;pa=(pa=Math.floor(this.Ji.Tm(pa)/21))?pa:1;let Hb=0,rc=null,yc=new Ej.a,xc=!1,ld=!1;const wd=Ma===this.fZa&&z.length<this.Bic+1;for(let aa=0;aa<z.length;aa++){const ra=z[aa],Na=new Ej.a;Na.va.id=ne.a.I9a+ra.BuildId;
Na.Mh(20,16);Na.xk(1);if(ra.IsTrigger){var t=this.gUc();Na.va.appendChild(t)}else Na.va.innerText=ra.BuildId.toString();let db=t=!1;aa<pa?(Fa&&(Na.va.style.position=Vf.a.absolute,Na.va.style.top=Li.a.Rc(this.Ji.Tm(Z)+21*Hb)),Na.va.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",aa,Ma,ra.BuildId,ra.EffectId)),ld=this.cKb||wd&&z.length-1===aa||this.ffd&&this.Bic===aa&&this.fZa===Ma,Na.va.setAttribute(Vf.a.I9,ld?"animMarkerSelected":"animMarkerUnselected"),tb.appendChild(Na.va),Hb++):aa===pa&&
yc.va?(xc=xc&&ra.EffectId===rc.EffectId,t=!0,db=rc.IsTrigger):xc=xc&&ra.EffectId===rc.EffectId;t&&yc.va.appendChild(this.oQc(db,xc,ld));yc=Na;rc=ra}this.pL();return Hb}oQc(z,Z,pa){const Fa=new Ej.a;Fa.va.id="overlappedMarker";Fa.va.style.marginTop=z?"3px":"-13px";Fa.va.setAttribute(Vf.a.I9,"overlappedMarker "+(pa?"animMarkerSelected":"animMarkerUnselected"));Z&&this.k3(Fa.va,"SameEffectOverlapped",1);return Fa.va}pL(){this.kPe(this.wb.va,!0)}Wfg(z){if(!z)return null;const Z=this.nc.ug(z);return Z?
Z.kWa(z):null}Pne(z){z=this.Wfg(z);if(!z||!z.length)return!1;for(const Z of z)if(Z.IsTextRangeType)return!0;return!1}OOa(z){if(this.R$()){var Z=z?this.Mn.va:this.Nn.va,pa,Fa;Z&&({x:pa,y:Fa}=this.Rie(z)).returnValue&&(Z.style.position=Vf.a.absolute,Z.style.left=Li.a.Rc(pa),Z.style.zIndex="20000",z?Z.style.top=Li.a.Rc(Fa):this.t8b())}}Rie(z){let Z,pa;Z=pa=0;if(!this.ta)return{returnValue:!1,x:Z,y:pa};var Fa=Object(w.a)(178,this.ta.sc(this.uA));if(!Fa)return{returnValue:!1,x:Z,y:pa};Fa=Fa.Gs();if(!Fa)return{returnValue:!1,
x:Z,y:pa};Z=z?Fa.oc-(this.hmc?61:35):Fa.oc-20-15;pa=Fa.pc;return{returnValue:!0,x:Z,y:pa}}aVe(z){if(this.ua&&z&&this.Fa&&z.Ec){var Z=z.Ec.id.startsWith("overlappedMarker")&&z.Ec.offsetParent?z.Ec.offsetParent:z.Ec;this.bPl(Z);this.A3c(Z)&&!this.Apk(Z)&&this.W4d();this.fca(!1);this.Ywc(Z,!0);this.ua.raiseEvent("OnMarkerClick",z);this.Fa.Gd()}}x5b(){this.ffd=!1;this.fZa=this.Bic=-1;this.W4d()}bPl(z){(z=this.FAb(z))?(this.ffd=!0,this.Bic=z[0],this.fZa=z[1],this.ta.mAa=this.Bic,this.ta.nNa=this.fZa):
Qc.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}W4d(){this.ta&&(this.ta.mAa=-1,this.ta.nNa=-1)}Gm(){this.Bb&&(this.yUb(),this.Bb.Gm())}yUb(){if(this.ta&&this.zh){var z=this.ta.Ko.points;z=Le.xta(z,this.PBb());this.zh.yu(z)}}PBb(){let z=ne.a.zQb;this.ta.ig||!this.ta.twa&&!this.ta.Sk||(z+=6);return z}Jq(){this.Bb&&this.Amc!==this.Jd&&this.omb();return null}Kr(){}Tv(){}Pj(z){this.Amc=this.Jd;this.Jd=z}setZIndex(z){this.Bb&&this.Bb.xE(z)}draw(){this.omb()}omb(){this.wb&&
this.OP&&this.Mb&&!this.iB&&this.FYd();this.setVisibility()}nE(z){if(!this.ua||!z)return!1;this.ua.raiseEvent("OnSelectionAreaHover",z);z.eventName===ob.a.Wq?this.k3(z.Ec,"animMarkerHovered",1):z.eventName===ob.a.Rt&&this.k3(z.Ec,"animMarkerHovered",2);return!0}Ywc(z,Z){z&&(Z?(this.k3(z,"animMarkerUnselected",2),this.k3(z,"animMarkerSelected",1)):(this.k3(z,"animMarkerSelected",2),this.k3(z,"animMarkerUnselected",1)))}k3(z,Z,pa){const Fa=this.A3c(z);switch(pa){case 0:z.setAttribute(Vf.a.I9,Z);Fa&&
z.lastChild.setAttribute(Vf.a.I9,Z);break;case 1:Sys.UI.DomElement.addCssClass(z,Z);Fa&&Sys.UI.DomElement.addCssClass(z.lastChild,Z);break;case 2:Sys.UI.DomElement.removeCssClass(z,Z),Fa&&Sys.UI.DomElement.removeCssClass(z.lastChild,Z)}}A3c(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&"overlappedMarker"===z.lastChild.id}Apk(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&0<=z.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}TF(z){(this.iB=z)?this.x5b():(this.$s(),this.fca(!0));
this.setVisibility()}jF(){return null}Ry(){}bD(){return[]}Xz(){}wE(){}$s(){!this.rl&&this.OP&&(this.OOa(!0),this.OOa(!1))}gUc(){const z=new dj.a;z.Mh(10,10);z.va.setAttribute(Vf.a.I9,"pointer-events-none");z.Yqa("0 0 2048 2048");const Z=new Tj.a;Z.h_("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");Z.UF("#E67E22");Z.Vv("#FFFF00");
Z.vs(5);z.appendChild(Z);return z.va}static xta(z,Z){return[new Af.a(z[0]._x-Z,z[0]._y-Z),new Af.a(z[1]._x+Z,z[1]._y-Z),new Af.a(z[2]._x+Z,z[2]._y+Z),new Af.a(z[3]._x-Z,z[3]._y+Z)]}}Object(k.a)(Le,"AnimationMarkerViewLegacy",null,[1077,805,806,106]);var uj=d(342),Tk=d(1299),bk;(function(z){z.None="None";z.Njf="ButtonModel";z.Dqm="CheckboxModel";z.Hqm="ColorPickerModel";z.Rjf="ComboBoxModel";z.Iqm="CompoundButtonModel";z.Nqm="ErrorViewModel";z.M7h="GalleryModel";z.Sqm="FileMenu";z.rkf="FlyoutAnchorModel";
z.erm="IconGalleryButtonModel";z.irm="InkButtonModel";z.jrm="InkFlyoutAnchorModel";z.orm="InsertTableModel";z.mrm="InputBoxModel";z.rrm="LabelModel";z.Nrm="PageNumberGalleryButtonModel";z.wrm="ListGalleryButtonModel";z.Cqm="CharacterCodeGalleryButtonModel";z.Yqm="FontStyleGalleryButtonModel";z.lrm="InkThicknessGalleryButtonModel";z.psm="TableStyleGalleryButtonModel";z.Aqm="ChangeColorsGalleryButtonModel";z.Orm="PeopleWell";z.P8h="PreviewGalleryModel";z.ism="SliderModel";z.PCc="SpinButtonModel";z.ksm=
"SplitButtonModel";z.qsm="TellMe";z.zsm="ToggleButtonModel";z.msm="StatefulSplitButtonModel";z.Lqm="DocumentTitleModel";z.yrm="MRUCompoundButtonModel";z.Grm="NewBlankDocumentModel";z.Jqm="CustomTemplateModel";z.Gqm="CoauthorGallery";z.osm="SyncStatus";z.Prm="PersonaButtonModel";z.Wqm="FontPickerModel";z.Erm="MultiActionButtonModel"})(bk||(bk={}));Object(k.b)("ModelType",bk);var Ql=d(190);class lk{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc){this.iKb=this.ZM=!1;this.Iy=[];this.wjd=new Set;this.xlc=!0;if(!z)throw Error.argumentNull("actionManager");
if(!Z)throw Error.argumentNull("graphTopologyManager");if(!pa)throw Error.argumentNull("slideReader");if(!Fa)throw Error.argumentNull("viewEventNotifier");if(!Ma)throw Error.argumentNull("animationMarkerViewManager");if(!tb)throw Error.argumentNull("activeSlideViewManager");if(!Hb)throw Error.argumentNull("selectionManager");if(!rc)throw Error.argumentNull("activeAppFrame");this.ia=z;this.sa=Z;this.nc=pa;this.Vfb=Ma;this.ue=Fa;this.$u=this.sa.Aa;this.Jc=tb;this.oa=Hb;this.Xkc=Pf.a("FixAnimationRibbonCrashIssue");
this.Db=rc}initialize(){}dispose(){this.ia=this.wjd=this.Iy=this.$u=this.nc=this.oa=this.ue=null}ARb(z){this.xlc=z}C3h(){if(!this.Xkc||this.$u){var z=this.oa.Hd();this.uTa();var Z=this.$u.yj(),pa=new Set;if(this.Xkc){if(!Z)return;if(z)for(const Fa of z)pa.add(Fa.id)}else for(const Fa of z)pa.add(Fa.id);for(const Fa of Z)pa.has(Fa.id)?this.wZd(Fa):this.a3e(Fa)}}bkm(z){this.Nza(this.ZM);Pf.a("FixAnimationSelectionCachingIssue")?this.gkm(z):this.F3h();Pf.a("FixAnimationRibbonControlsRefreshLogic")?this.$1e():
this.ue.Gz(new Ql.a(7))}STj(z,Z){if(Z&&z&&z.length){var pa=this.Xxb(z[0]);this.xlc=!1;pa?(Z=this.Iy.filter(Fa=>!z.includes(Fa.EffectNodeId)),this.uTa(),this.Kea(),this.uZd(Z)):(Z=this.nc.Xfg(z,Z),this.UYd(Z),Z=Object.assign([],this.Iy),this.uTa(),this.Kea(),this.uZd(Z));this.xlc=!0;this.ia.Ia(Mc.a.HEd,Tk.a.execute,null)}}Kea(){const z=this.oa.Hd();this.oa.Kea(z)}tZd(z,Z){Z&&z&&(this.uTa(),z=this.nc.Xfg(z,Z),this.uZd(z),Pf.a("FixRedundantSelectionChange")?this.xlc&&this.ia.Ia(Mc.a.HEd,Tk.a.execute,
null):this.ia.Ia(Mc.a.HEd,Tk.a.execute,null))}Xxb(z){return this.wjd.has(z)}ckm(z){if(this.ZM=!!z&&0<=z.indexOf("Animation"))this.iKb=!0;this.Nza(this.ZM);this.ZM?(this.C3h(),Pf.a("FixAnimationRibbonControlsRefreshLogic")?this.$1e():this.ue.Gz(new Ql.a(7))):this.uTa()}dkm(z){this.$u=z;this.uTa();this.Nza(this.ZM)}gkm(z){if(!this.Xkc||this.$u)if(z)this.F3h();else if((z=this.oa.Hd())&&z.length){var Z=this.$u.yj();if(Z&&Z.length){this.uTa();var pa=new Set;for(const Fa of z)pa.add(Fa.id);for(const Fa of Z)pa.has(Fa.id)?
this.wZd(Fa):this.a3e(Fa)}}}F3h(){if(!this.Xkc||this.$u){var z=this.oa.Hd();this.uTa();var Z=this.$u.yj();if(Z&&Z.length)if(z&&z.length){var pa=new Set;for(const Fa of z)pa.add(Fa.id);for(const Fa of Z)pa.has(Fa.id)?this.wZd(Fa):this.a3e(Fa)}else z=this.$u.DZc(Z),z.length&&(z=z.filter(Fa=>Fa.IsModifiedPreviously).map(Fa=>Fa.EffectNodeId),this.tZd(z,this.$u))}}uZd(z){if(z&&this.$u){this.UYd(z);if(Pf.a("RefreshMarkersInsteadOfComputeEffectSelection"))this.Nza(this.ZM);else{var Z=this.$u.yj();if(!Z||
!Z.length)return;z=new Map;for(var pa of this.Iy){var Fa=Fg.a.Tf(pa.ShapeId);if(!Fa){Qc.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");return}Fa=Fa.toString();z.has(Fa)||z.set(Fa,new Set);Fa=z.get(Fa);null===Fa||void 0===Fa?void 0:Fa.add(pa.EffectNodeId)}for(const Ma of Z)if(pa=this.Vfb.$J(Ma))pa.fca(!1),Z=Ma.id.toString(),(Z=z.has(Z)?z.get(Z):null)&&Z.size&&pa.HLl(Array.from(Z))}Pf.a("FixAnimationRibbonControlsRefreshLogic")?this.$1e():this.ue.Gz(new Ql.a(7))}}$1e(){const z=
{};z.SetAnimationDuration=bk.PCc;z.SetAnimationDurationMLR=bk.PCc;z.SetAnimationDelay=bk.PCc;z.SetAnimationDelayMLR=bk.PCc;z.AnimationStart=bk.Rjf;z.AnimationStartMLR=bk.Rjf;z.MoveEarlier=bk.Njf;z.MoveLater=bk.Njf;z.AnimationEffectOptions=bk.rkf;z.AnimationEffectOptionsMLR=bk.rkf;z.Animations=bk.P8h;z.AnimationGallery=bk.M7h;this.Db.OB(z)}wZd(z){if(z){var Z=this.nc.ug(z);Z&&(Z=Z.hBb(z),this.UYd(Z),z=this.Vfb.$J(z),this.Xkc&&!z||z.fca(!0))}}a3e(z){z&&(z=this.Vfb.$J(z))&&z.fca(!1)}UYd(z){if(z&&z.length)for(const Z of z)this.Xxb(Z.EffectNodeId)||
(this.Iy.push(Z),this.wjd.add(Z.EffectNodeId))}Nza(z){if(this.iKb&&this.$u&&this.$u.nP&&this.Jc.Ic&&this.Jc.Ic.bPc){var Z=this.$u.yj();if(Z&&Z.length)for(const pa of Z)if(Z=this.Vfb.$J(pa))Z.visible=z,Z.omb()}}uTa(){this.wjd.clear();this.Iy.length=0}}Object(k.a)(lk,"EffectSelectionManager",null,[1039,106]);class qm{constructor(){this.K=null;this.PHb=!1}get name(){return"PowerPointWebEditor.Animations"}fc(z){this.K=z;(this.PHb=this.K.resolve("PowerPointWebEditor.IApplicationContext").td.Ovb)?(this.K.register(722,
"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().na(()=>new uj.a((Z,pa)=>{let Fa=null;const Ma=Object(w.a)(178,Z.sc(this.K.resolve("Box4.IPageView").Na));Ma&&!Ma.hm&&Ma.va&&(Fa=new Si(Z,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(ib.a)(Ma,Ma.pL,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),H.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),pa,()=>{Ma.JFa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),Fa.Cn(Ma.va),Fa.setZIndex(4),Fa.visible=!1,Ma.pL(Fa.Ee.va,!0),Ma.vta(Fa,4));return Fa})),this.K.register(lk,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().na(()=>new lk(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IAppFrame")))):(this.K.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().na(()=>
new uj.a((Z,pa)=>{let Fa=null;const Ma=Object(w.a)(178,Z.sc(this.K.resolve("Box4.IPageView").Na));Ma&&!Ma.hm&&Ma.va&&(Fa=new Le(Z,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(ib.a)(Ma,Ma.pL,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),H.AFrameworkApplication.Be,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),pa,()=>{Ma.JFa()}),Fa.Cn(Ma.va),Fa.setZIndex(4),Fa.visible=!1,Ma.pL(Fa.Ee.va,!0),Ma.vta(Fa,4));return Fa})),this.K.register(bm,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().na(()=>new bm(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.PHb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.PHb?
this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){Qa.a.instance.Ac(gf.a(new qm,0))}}Object(k.a)(qm,"PPTWebEditorAnimationsPackage",null,[2,3]);var cm=d(1080),Uh=d(126);class cg{constructor(z,Z,pa,Fa,Ma,tb){this.ia=z;this.Fa=Z;this.rHe=pa;this.Wb=Fa;this.F_a=Ma;this.tZ=tb}qb(){this.ia.xa(Mc.a.find,Zc.a.view,Object(ib.a)(this,this.findText,"findText"));this.ia.xa(Mc.a.find,
Zc.a.notes,Object(ib.a)(this,this.findText,"findText"));this.ia.xa(Mc.a.find,Zc.a.Xf,Object(ib.a)(this,this.findText,"findText"));this.ia.xa(oa.a.Nde,Zc.a.view,Object(ib.a)(this,this.Nde,"findInDocument"));this.ia.pe(Mc.a.find,0);this.ia.xa(Mc.a.b3,Zc.a.view,Object(ib.a)(this,this.b3,"replaceText"));this.ia.xa(Mc.a.b3,Zc.a.notes,Object(ib.a)(this,this.b3,"replaceText"));this.ia.xa(Mc.a.b3,Zc.a.Xf,Object(ib.a)(this,this.b3,"replaceText"));this.ia.pe(Mc.a.b3,4)}Sd(){const z=[this.Fa.Kc(this.tZ&&Pf.a("FindReplaceInNewThumbnail")?
cd.a.KB:Uh.a.XE),this.Fa.Kc(Uh.a.H4),this.Fa.Kc(cd.a.Ag),this.Fa.Kc(cd.a.wR)];for(const Z of z)Z.bindAction(ub.KeyInputManager.Va(qc.a.kPa,ub.KeyInputManager.Ze),Mc.a.find),Z.bindAction(ub.KeyInputManager.Va(qc.a.Bqb,ub.KeyInputManager.Ze),Mc.a.b3)}findText(z,Z,pa){return Z.contextId!==Zc.a.view&&Z.contextId!==Zc.a.notes&&Z.contextId!==Zc.a.Xf?2:1===pa?this.Wb.Hi()?32:8:Pf.a("FindReplaceInNewThumbnail")&&1===this.F_a.$i?2:2===pa?(this.rHe.pUh(Z),Qc.a.J(539773087,820,50,"FindTextDialog is initialized."),
32):8}b3(z,Z,pa){return Z.contextId!==Zc.a.view&&Z.contextId!==Zc.a.notes&&Z.contextId!==Zc.a.Xf?2:1===pa?this.Wb.Hi()?32:8:Pf.a("FindReplaceInNewThumbnail")&&1===this.F_a.$i?2:2===pa?(this.rHe.z5l(Z),Qc.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}Nde(z,Z,pa,Fa,Ma){if(Z.contextId!==Zc.a.view&&Z.contextId!==Zc.a.notes&&Z.contextId!==Zc.a.Xf)return 2;if(1===pa)return 32;if(2===pa){if(!Ma)return 8;z=Ma.CommandValueId||"";Qc.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",
z.length);this.rHe.g5l(Z,z);Qc.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(k.a)(cg,"FindReplaceTextActor",null,[948]);var Pj=d(1302);class Rl extends Pj.a{constructor(z,Z,pa){super(!1,!0);this.$Ee=!1;this.sjd=null;this.MIb=!1;this.aRg=this.kSg=null;this.qHe=!0;this.BHe=this.CHe=this.AHe=!1;this.Uoa=null;this.Jid=!1;this.sNe=!0;this.Pbh=this.OJe=!1;this.o$g=this.q$g=null;this.$_g=0;this.Fa=z;this.qaa=Z;this.tTk="FindReplaceTextDialog";this.lS=ResourceStrings.l_FindTextTitle;
pa&&(this.lS=ResourceStrings.l_ReplaceTextTitle);this.RJe=pa;this.bX=!1}zia(){this.Vj(this.lS,this.qaa,this.i$());this.$Ee=!1}dispose(){super.dispose();this.$Ee=!0}ecj(){this.AHe=this.qHe=!1;this.l8(this.lS,this.qaa,this.i$())}v8f(z){z&&(this.Fa.Df(Tb.AFrame.j7),this.AHe=!0);this.qHe=!0;this.l8(this.lS,this.qaa,this.i$())}Qcc(){this.hide()}oPl(z){this.sjd=z.searchString;this.MIb=z.matchCase;this.Uoa=z.replaceString}hm(){return this.$Ee}t3a(z,Z){this.aRg=z;this.$_g=Z;this.Pbh=0===Z;this.l8(this.lS,
this.qaa,this.i$())}Dyd(z){this.kSg=z;this.l8(this.lS,this.qaa,this.i$())}bzd(z){this.q$g=z;this.l8(this.lS,this.qaa,this.i$())}t8e(z){this.o$g=z;this.l8(this.lS,this.qaa,this.i$())}get X2a(){return this.sjd}set X2a(z){this.sjd=z}get matchCase(){return this.MIb}set matchCase(z){this.MIb=z}get b4e(){return this.Uoa}set b4e(z){this.Uoa=z}mgj(z){z&&(this.Fa.Df(Tb.AFrame.j7),this.CHe=!0);this.Jid=!0;this.l8(this.lS,this.qaa,this.i$())}H$d(){this.CHe=this.Jid=!1;this.l8(this.lS,this.qaa,this.i$())}lgj(z){z&&
(this.Fa.Df(Tb.AFrame.j7),this.BHe=!0);this.sNe=!0;this.l8(this.lS,this.qaa,this.i$())}gcj(){this.BHe=this.sNe=!1;this.l8(this.lS,this.qaa,this.i$())}G7l(){this.lS=ResourceStrings.l_ReplaceTextTitle;this.RJe=!0;this.Jid=!1;this.l8(this.lS,this.qaa,this.i$());this.Fa.Df(Tb.AFrame.j7)}kgj(){this.OJe=!0;this.l8(this.lS,this.qaa,this.i$())}gvj(){return{["searchString"]:this.sjd,["findNextButtonAriaLabel"]:this.kSg,["errorMessage"]:this.aRg,["findNextButtonIsEnabled"]:this.qHe,["focusFindNextButton"]:this.AHe,
["focusDialog"]:Object(ib.a)(this,this.Zpj,"focusDialog"),["isReplaceActive"]:this.RJe,["replaceButtonIsEnabled"]:this.Jid,["replaceAllButtonIsEnabled"]:this.sNe,["showMessageAsError"]:this.Pbh,["messageStatus"]:this.$_g,["focusReplaceButton"]:this.CHe,["focusReplaceAllButton"]:this.BHe,["replaceButtonAriaLabel"]:this.q$g,["replaceAllButtonAriaLabel"]:this.o$g,["readOnlyModeEnabled"]:this.OJe}}i$(){return{["id"]:this.tTk,["bodyControls"]:this.gvj(),["isModal"]:!1}}Zpj(){this.Fa.Df(Tb.AFrame.j7)}}
Object(k.a)(Rl,"ReactFindReplaceTextDialog",Pj.a,[1085]);class Uk{constructor(z){this.Fa=z}getInstance(z,Z){return new Rl(this.Fa.value,z,Z)}}Object(k.a)(Uk,"FindReplaceTextDialogFactory",null,[1006]);class Sl{constructor(){this.b8=this.Sia=this.paragraphIndex=this.iT=this.slideIndex=0}reset(){this.slideIndex=this.iT=this.paragraphIndex=0;this.Sia=this.b8=-1}clone(){const z=new Sl;z.slideIndex=this.slideIndex;z.iT=this.iT;z.paragraphIndex=this.paragraphIndex;z.Sia=this.Sia;z.b8=this.b8;return z}}
Object(k.a)(Sl,"TextPosition",null,[]);class Ti{constructor(){this.yKe=this.Obd=null;this.xQ=new Sl;this.$m=new Sl;this.state=this.slideCount=0;this.$wb=this.hce=!1;this.pattern=this.n7b=this.p7b=null;this.matchCase=!1;this.reset()}reset(){this.slideCount=0;this.xQ.reset();this.$m.reset();this.state=0;this.$wb=this.hce=!1;this.yKe=this.dUa=this.n7b=this.p7b=null}get dUa(){return this.Obd}set dUa(z){if(this.Obd=z)this.yKe=this.Obd}get $uk(){return this.yKe}}Object(k.a)(Ti,"FindContext",null,[]);var Jg=
d(52),Uj=d(95);class sl{constructor(){this.ShouldMatchCase=!1}}Object(k.a)(sl,"MatchTextInfo",null,[]);class Bm{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(k.a)(Bm,"ReplaceAllTextInfo",null,[]);var yb=d(993),zk=d(171),ya=d(1008),md=d(333);class tl{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd,t,aa,ra,Na,db,kb,Ib,Rb,Cb,cc,Fc){this.kKa=this.nn=this.tF=null;this.Md=new Ti;this.Uoa=this.bH="";this.Ylc=!1;this.QJb=this.fib=0;this.PJb=Date.now();
this.Iid=-1;this.pHe=0;this.eid=-1;this.ia=z;this.Xjc=Z;this.Fa=pa;this.xq=Fa;this.Wb=Ma;this.Ga=tb;this.Qm=Hb;this.Jxa=rc;this.yb=yc;this.zb=xc;this.Yb=ld;this.sa=wd;this.Ub=t;this.Eb=Na;this.ue=aa;this.Ar=ra;this.BK=db;this.JKa=kb;this.t_g=Ib;this.Gib=Rb;this.QPk=Cb;this.uI=Fc;this.p$g=cc}pUh(z){this.tF=z;this.nn=this.t_g.value.getInstance(Object(ib.a)(this,this.vcg,"findReplaceTextDialogResultHandler"),!1);this.bH&&(this.nn.X2a=this.bH,this.eid=-1);this.nn.zia();3!=this.ia.mode&&this.nn.kgj();
this.cYa()&&this.F$d()}g5l(z,Z){this.cYa()||(this.bH=Z);this.pUh(z);this.cYa()||(this.nn.X2a=this.bH,this.nn.zia(),this.Bff(Z,!1))}z5l(z){this.tF=z;this.nn=this.t_g.value.getInstance(Object(ib.a)(this,this.vcg,"findReplaceTextDialogResultHandler"),!0);this.bH&&(this.nn.X2a=this.bH);this.nn.zia();this.cYa()&&this.F$d()}vcg(z,Z){if(Z)switch(this.nn.oPl(Z),z){case 1:this.z3k();break;case 2:this.A3k();break;case 3:this.B3k(this.nn.b4e);break;default:this.u_l(),this.clearSelection(),this.Md.reset(),this.nn.Qcc()}else Qc.a.J(512496416,
820,10,"Got null control value for findreplace dialog")}Qtg(){return this.Md.p7b&&this.AYd!==this.Md.p7b.ve}Bff(z,Z){this.K5f();if(0===this.Md.state||3===this.Md.state||z!==this.bH||Z!==this.Ylc||this.Qtg())this.J8j(z,Z),this.eid=-1;this.Md.$wb=!1;this.Lod()}get AYd(){return this.sa.Aa?this.sa.Aa.ve:0}J8j(z,Z){const pa=z===this.bH&&3===this.Md.state&&!this.Qtg(),Fa=this.Md.xQ.clone();this.Md.reset();this.bH=z;this.Ylc=Z;pa?this.Md.xQ=Fa.clone():(this.Md.xQ.slideIndex=this.AYd,this.FBj());this.Md.$m=
this.Md.xQ.clone()}Lod(){this.moj(this.bH,this.Ylc)?4!==this.Md.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.R8b())}moj(z,Z){var pa=this.sa.presentation;if(!pa)throw Error.argumentNull("Presentation is null");if(pa=pa.slides||[],pa.length){this.Md.slideCount=pa.length;const Fa=pa.length+this.Md.xQ.slideIndex;for(;this.Md.$m.slideIndex<=Fa;){const Ma=this.Md.$m.slideIndex%pa.length,tb=this.ooj(pa[Ma],z,Z,this.Md.$m.slideIndex===Fa?this.Md.xQ.iT:tl.QQe);if(tb&&
(this.Md.p7b=this.Wb.Qk(tb.Fb)))return!0;if(7===this.Md.state)return this.Md.$wb&&(Qc.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.Md.state=0),this.wfl(pa[Ma]?pa[Ma].Fb:null,z,Z);if(3===this.Md.state)break;let Hb;(Hb=this.Md.$m).slideIndex=Hb.slideIndex+1;this.Md.$m.iT=0}}else this.Md.state=1;return!1}ooj(z,Z,pa,Fa){if(!z)return null;var Ma=this.Wb.Qk(z.Fb),tb=this.Ub.Pc(Ma);Ma=Ma.lWa()||[];(tb=tb.Gb(27))&&Ma.push(tb);if(!Ma.length)return this.Md.state=7,null;for(;this.Md.$m.iT<=
Math.min(Ma.length-1,Fa);){if(this.Md.n7b=this.noj(Ma[this.Md.$m.iT],Z,pa,this.Md.$m.iT===Fa?this.Md.xQ.paragraphIndex:tl.QQe))return z;let Hb;(Hb=this.Md.$m).iT=Hb.iT+1;this.Md.$m.paragraphIndex=0}return null}noj(z,Z,pa,Fa){if(!this.Qm.NHa(z)&&z.VA)return null;const Ma=Uj.a.createInstance(z);let tb=0;for(;Ma.moveNext()&&this.Md.$m.paragraphIndex<=Fa;){const Hb=Ma.currentNode;if(Ng.ParagraphReader.ke(Hb)&&tb++===this.Md.$m.paragraphIndex){if(this.Md.dUa=this.koj(Hb,Z,pa,this.Md.$m.paragraphIndex===
Fa?this.Md.xQ.Sia:tl.QQe))return z;let rc;(rc=this.Md.$m).paragraphIndex=rc.paragraphIndex+1;this.Md.$m.Sia=this.Md.$m.b8=-1}}return null}koj(z,Z,pa,Fa){if(!Ng.ParagraphReader.ke(z))return null;let Ma=z.bBb();if(!Ma.length)return null;Ma=Ma.substring(0,Math.min(Ma.length,Fa));return this.poj(Ma,Math.max(0,this.Md.$m.b8),Z,pa)?z:null}poj(z,Z,pa,Fa){let Ma=z,tb=pa;Fa||(Ma=z.toLowerCase(),tb=pa.toLowerCase());z=Ma.indexOf(tb,-1===Z?0:Z);if(-1!==z)return this.Md.$m.Sia=z,this.Md.$m.b8=z+tb.length,this.Md.state=
2,this.Md.hce=!0;this.Md.state=1;return!1}FBj(){var z=zk.b(this.tF);z=z?z.Rb:null;if(!z||!z.Oa)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(z.Oa.kb){var Z=z.Oa.kb.Ua;if(Ng.ParagraphReader.ke(Z.node)){z=Object(w.a)(5,Z.node);this.Md.xQ.Sia=Z.Ra;this.Md.xQ.b8=Z.Ra;const pa=this.Ga.sfa(Z.node);pa?(this.Md.xQ.iT=pa.get_zIndex()-1,this.Md.xQ.paragraphIndex=this.umg(z)):this.Qm.DBb(Z.node)&&(Z=this.sa.Aa?this.sa.Aa.lWa():null,this.Md.xQ.iT=Z?Z.length:0,this.Md.xQ.paragraphIndex=
this.umg(z))}else this.Ga.dIa(Z.node)&&(this.Md.xQ.iT=Z.node.get_zIndex()-1)}}umg(z){z=this.Ub.Pc(z);if(!z.h8(pa=>10===pa.type||60===pa.type||16===pa.type))return 0;z.Dc();const Z=z.lr;z.Dc();return Math.max(0,z.EVa(Z))}Mih(){const z=this.sa.presentation;if(!z)throw Error.argumentNull("Presentation is null");return this.Md.xQ.slideIndex||this.Md.xQ.iT?this.Md.$m.slideIndex<(z.slides||[]).length:!1}vrg(){const z=this.sa.presentation;if(!z)throw Error.argumentNull("Presentation is null");this.Md.$m.slideIndex=
z.slides?z.slides.length:0;this.Md.$wb=!1;this.Lod()}K6c(){return this.nn.hm()}W2k(z){if(!this.K6c()){Qc.a.J(512496409,820,50,"OnBackendFindSucceeded");var Z=Aj.a.empty;({slideId:Z}=Aj.a.s_h(z));(z=this.Wb.Dma(Z))?(Z=z.slideIndex,Z>this.Md.xQ.slideIndex&&Z<this.Md.$m.slideIndex?this.R8b():this.Yb.Aa!==z?(this.xq.kU(Object(ib.a)(this,this.$Lb,"onActiveSlideDomChanged")),this.Yb.Aa=z):(this.Md.state=5,this.Md.$wb=!0,this.Md.$m.slideIndex=this.Md.$m.slideIndex>Z?Z+this.Md.slideCount:Z,this.Md.$m.iT=
0,this.Md.$m.paragraphIndex=0,this.Md.$m.Sia=-1,this.Md.$m.b8=-1,this.Lod())):this.Mih()?this.vrg():this.R8b()}}$Lb(){Qc.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.xq.wqa(Object(ib.a)(this,this.$Lb,"onActiveSlideDomChanged"));this.K6c()||this.kKa||(this.kKa=new ee.a(3,1,0,Object(ib.a)(this,this.sVe,"onPostActiveSlideDomChangedTask"),90,"30"),this.zb.Jb(this.kKa))}sVe(){Qc.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.kKa=null;if(!this.K6c())if(4===this.Md.state){const z=this.AYd;
this.Md.$m.slideIndex=this.Md.$m.slideIndex>z?z+this.Md.slideCount:z;this.Md.state=5;this.Md.$wb=!0;this.Lod()}else 2===this.Md.state?this.setSelection():this.R8b()}V2k(){this.K6c()||(Qc.a.J(512496406,820,50,"OnBackendFindFailed"),this.Mih()?this.vrg():this.R8b())}wfl(z,Z,pa){Qc.a.J(512496405,820,50,"PerformBackendFind");this.Xjc.findText(Z,pa,z.toString(),Object(ib.a)(this,this.W2k,"onBackendFindSucceeded"),Object(ib.a)(this,this.V2k,"onBackendFindFailed"));this.Md.state=4;return!0}R8b(){this.Md.state=
this.Md.hce?3:1;Qc.a.J(512496404,820,50,"End of Find: {0}",this.Md.state);this.clearSelection();this.t3a(0,"")}getShapeType(z){return z.Xu?ResourceStrings.L_TextBox:z.Lq?ResourceStrings.l_Chart:z.vd?ResourceStrings.L_Table:z.ig?ResourceStrings.L_SmartArt:z.Vp?ResourceStrings.L_Media:z.$j?ResourceStrings.l_Picture:z.Sk?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var z=this.Md.dUa,Z=this.Md.p7b;if(this.Yb.Aa!==Z)this.xq.kU(Object(ib.a)(this,this.$Lb,"onActiveSlideDomChanged")),
this.Yb.Aa=Z;else{z=Jg.SelectionFactory.U4(z,this.Md.$m.Sia,this.Md.$m.b8);if(this.Qm.NHa(this.Md.n7b))this.ia.Ia(Mc.a.ONa,2,new yb.a(!0)),this.Fa.Df(Uh.a.H4),this.Jxa.setSelection(z),this.t3a(this.Md.$m.slideIndex%this.Wb.Hi()+1,ResourceStrings.l_NotesPaneType);else{Z=this.Md.n7b;const pa=this.Md.n7b.vg(this.yb.Na);if(pa)if(pa.Mq){let Fa;(Fa=this.Md.$m).iT=Fa.iT+1;this.Md.$m.paragraphIndex=0;this.Md.$m.Sia=0;this.Md.$m.b8=0;pa.OAd()}else this.QPk&&Z.ig?(this.ue.Szh(new md.a(Z)),this.JKa.setSelection(z)):
(this.Fa.Df(cd.a.Ag),this.yb.setSelection(z));this.t3a(this.Md.$m.slideIndex%this.Wb.Hi()+1,this.getShapeType(Z))}Qc.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.Md.$m.slideIndex,this.Md.$m.iT,this.Md.$m.paragraphIndex,this.Md.$m.Sia,this.Md.$m.b8);this.gbe()}}clearSelection(){var z=zk.b(this.tF);if(z=z?z.Rb:null){var Z=this.Md.$uk;Z&&(Z=Jg.SelectionFactory.fh(Z,0),z.setSelection(Z))}else Qc.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}t3a(z,
Z){const pa=new Sys.StringBuilder,Fa=new Sys.StringBuilder;let Ma=!1;z!=this.eid?(this.eid=z,this.pHe=1):this.pHe++;switch(this.Md.state){case 1:Ma=!0;pa.append(ResourceStrings.l_FindTextNotFound);break;case 3:pa.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ma=!0;pa.append(ResourceStrings.l_FindTextFindAgain);break;case 2:Fa.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.pHe,z,Z));break;default:Qc.a.J(512496400,820,50,"Find Text: {0}",this.Md.state)}this.CRl(pa.toString(),
Ma,Fa.toString());this.gbe()}vcm(z){z=this.VDl(z);32===z&&this.Bff(this.bH,this.Ylc);16===z&&(this.nn.t3a(ResourceStrings.l_ReplaceTextErrorMessage,0),this.nn.H$d(),this.nn.v8f(!0))}VDl(z){return vg.a.oce("SingleReplaceAction",Mc.a.b3,()=>{z||(z="",Qc.a.J(512496399,820,50,"Replacing with empty string"));var Z=this.Md.dUa;if(!Z)return Qc.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var pa=this.Md.$m.Sia;const Fa=this.Md.$m.b8;if(-1===pa||-1===Fa)return Qc.a.J(512496397,820,10,"Invalid start or end position of current text selection."),
16;const Ma=this.Ar.xe(15);Ma.rd(Z);this.BK.replaceTextRange(Ih.a.createTextRange(Z,pa,Fa),z,!0,!1,Mc.a.b3);Z=pa+z.length;pa=Z!==this.Md.$m.b8;this.Md.$m.b8=Z;Ma.dispose();pa&&this.setSelection();return 32})}gbe(){this.nn.v8f(1===this.fib);this.A8f();this.nn.lgj(3===this.fib)}A8f(){this.Md.dUa?this.nn.mgj(2===this.fib):this.nn.H$d()}K5f(){this.nn.ecj();this.nn.H$d();this.nn.gcj()}CRl(z,Z,pa){2===this.fib?(this.nn.bzd(ResourceStrings.l_ReplaceTextReplaced+". "+pa),this.nn.Dyd("")):(this.nn.Dyd(pa),
this.nn.bzd(""));this.nn.t8e("");this.nn.t3a(z,Z?0:1)}njj(z,Z){const pa=vg.a.Zj("FindNext");pa.Wa("CommandId",z.toString());pa.Wa("IsReadOnlyModeEnabled",this.nn.OJe.toString());try{Z()}finally{pa.finish(!0)}}z3k(){Ob.a.Ta(this.nn.X2a)||this.njj(Mc.a.find,()=>{Qc.a.J(512496396,820,50,"Find Text Started");this.fib=1;this.Bff(this.nn.X2a,this.nn.matchCase);return 32})}A3k(){this.nn.RJe?(Qc.a.J(512496394,820,50,"Replace Text Started"),this.fib=2,this.vcm(this.nn.b4e)):(this.nn.G7l(),Qc.a.J(512496395,
820,50,"Find dialog switched to replace dialog"),this.A8f())}B3k(z){this.cYa()?Qc.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.QJb,Date.now()-this.QJb):Ob.a.Ta(this.nn.X2a)||(Pf.a("FixReplaceAllTimeOutError")&&(this.sa.presentation.lia=-16),this.bH=this.nn.X2a,this.Uoa=z?z:"",this.QJb=Date.now(),this.fib=3,this.F$d(),this.jnj(this.sa.Aa,this.bH,this.Uoa,this.Ylc),0<this.p$g&&(this.Iid=window.setTimeout(()=>{this.bph()},this.p$g)),16===this.replaceAll()&&
(this.PJb=Date.now(),this.pXf(),this.bph()))}replaceAll(){return vg.a.oce("ReplaceAllAction",Mc.a.b3,()=>{Qc.a.J(512496392,820,50,"ReplaceAll Text Started");const z=this.sa.presentation;if(z){const Z=this.Eb.ud(15);try{Z.mc(z),this.Gib.Ak(Object(ib.a)(this,this.Mkb,"onPresentationPropertyChange")),z.zPb=Object.assign(new Bm,{NewStr:this.Uoa,OldStr:this.bH,ActiveSlideCid:this.sa.Aa.cid,ActiveSlideSid:this.sa.Aa.sid,MatchTxtInfo:Object.assign(new sl,{ShouldMatchCase:this.nn.matchCase})})}finally{Z&&
Z.dispose()}return 32}return 16})}jnj(z,Z,pa,Fa){if(z){z=this.Wb.Qk(z.Fb);var Ma=this.Ub.Pc(z);z=z.lWa()||[];(Ma=Ma.Gb(27))&&z.push(Ma);if(z.length)for(Ma=0;Ma<=z.length-1;)this.toj(z[Ma],Z,pa,Fa),Ma++}else Qc.a.J(512496391,820,50,"slide must not be null.")}toj(z,Z,pa,Fa){if(this.Qm.NHa(z)||!z.VA)for(z=Uj.a.createInstance(z);z.moveNext();){const Ma=z.currentNode;if(!Ng.ParagraphReader.ke(Ma))continue;let tb=null;(tb=this.loj(Ma,Z,Fa))&&tb.characterData.replace(Z,pa)}}loj(z,Z,pa){if(!Ng.ParagraphReader.ke(z))return Qc.a.J(512496390,
820,50,"node must be ParagraphNode"),null;const Fa=z.bBb();return Fa.length?this.qoj(Fa,Z,pa)?z:null:null}qoj(z,Z,pa){let Fa=z,Ma=Z;pa||(Fa=z.toLowerCase(),Ma=Z.toLowerCase());return-1!==Fa.indexOf(Ma,0)?!0:!1}Mkb(z,Z){if(!this.cYa())Qc.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(Z.property===Md.a.Y3e){this.pXf();z=Object(w.a)(688,Z.node);if(-1!==z.lia){var pa=2;if(0===z.lia){Z=ResourceStrings.l_FindTextNotFound;var Fa=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;pa=
0;var Ma=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===z.lia?(Z=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,z.lia,this.bH,this.Uoa),Fa=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,z.lia,this.bH,this.Uoa)):(Z=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,z.lia,this.bH,this.Uoa),Fa=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,z.lia,this.bH,this.Uoa)),Ma=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Ma=
ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,Z=Fa=ResourceStrings.l_ReplaceAllErrorMessage,pa=0,Qc.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.PJb=Date.now();Qc.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.PJb-this.QJb);this.u8f(Z,pa);this.Gib.tn(Object(ib.a)(this,this.Mkb,"onPresentationPropertyChange"));this.nn.hm()&&this.E$e(Ma,Fa,10);z.lia=-16}}cYa(){return this.QJb>this.PJb}F$d(){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,
this.bH);this.nn.t3a(z,3);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.bH);this.nn.t8e(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.bH);this.nn.bzd(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.bH);this.nn.Dyd(z);this.K5f()}u8f(z,Z){this.nn.t3a(z,Z);this.nn.t8e(z);this.nn.bzd("");
this.nn.Dyd("");this.gbe()}u_l(){if(this.cYa()){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.bH);this.E$e(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,z,1024)}}E$e(z,Z,pa){this.uI?(this.uI.L$d(),Qc.a.J(512496385,820,50,"Callout notification called for Replace All operation"),z=Object.assign(new ya.a,{title:z,message:Z,timeoutInSeconds:pa}),z=this.uI.fRh(z),z.IXa&&Qc.a.J(512496384,820,10,"Error in callout notification: Error:{0}",z.message)):Qc.a.J(512496386,820,
10,"Find Replace Text: m_calloutNotification adapter is null.")}bph(){let z=!1;this.cYa()&&(z=!0,this.PJb=Date.now());Qc.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",z,this.PJb-this.QJb);this.u8f(ResourceStrings.l_ReplaceAllErrorMessage,0);this.Gib.tn(Object(ib.a)(this,this.Mkb,"onPresentationPropertyChange"));this.nn.hm()&&this.E$e(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);
this.sa.presentation.lia=-16}pXf(){-1!==this.Iid&&(window.clearTimeout(this.Iid),this.Iid=-1)}}tl.QQe=1024;Object(k.a)(tl,"FindReplaceTextHandler",null,[1007]);class Jh{constructor(z){this.P_g=this.Hch=null;this.MIb=!1;this.N6=z}findText(z,Z,pa,Fa,Ma){this.P_g=z;this.MIb=Z;this.Hch=pa;this.N6.HG(Fa,Ma,null)}get D5l(){return this.Hch}get matchCase(){return this.MIb}get emd(){return this.P_g}}Object(k.a)(Jh,"FindTextManager",null,[1005]);var pn=d(397),jj=d(114);class kh extends jj.a{constructor(){super();
this.MatchText=null;this.MatchCase=!1;this.SlideID=null}om(){return 54}static r6d(z,Z,pa){const Fa=new kh;Fa.SlideID=pa;Fa.MatchText=z;Fa.MatchCase=Z;return Fa}}Object(k.a)(kh,"FindTextRequest",jj.a,[]);class ah extends pn.a{constructor(z,Z,pa,Fa){super();this.dJa=this.QKa=null;this.JP=this.f6=!1;this.Xic=null;this.fe=pa;this.tad=!1;this.Xjc=Z;this.Xa=Fa;this.Kn=z;this.enabled=2;this.Kn.register(this)}HG(z,Z){this.tad=!0;this.QKa=z;this.dJa=Z;this.Kn.dca()}forceOutbound(){}Nma(){return this.tad&&
!this.f6}cP(){return!1}NWa(){return this.ge&&2===this.ge.status?!0:this.Nma()}DPb(){if(1===this._state)this.Xic=this.Xa.podSessionId,this.ge.hL=kh.r6d(this.Xjc.value.emd,this.Xjc.value.matchCase,this.Xjc.value.D5l),this.ge.status=1,this._state=3;else if(3===this._state&&this.ge&&2===this.ge.status){if(2!==this.ge.statusCode)this.VI();else{if(!this.ge.Sv||1!==this.ge.Sv.length){this.VI();return}const z=this.ge.Sv[0];0===z.StatusCode?(this.I2(),this.QKa&&this.QKa(z.SlideID)):(this.VI(z),124===z.StatusCode&&
this.fe.At(z.ServerError,this.Xic))}this.Xic=null}}VI(z=null){this.tad=!1;this._state=1;Qc.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",z?z.StatusCode:-1,this.ge?ad.a[this.ge.statusCode]:"NULL",this.ge?this.ge.lu:-1,this.JP,this.Xic||"NULL");this.JP=!0;this.dJa&&this.dJa(-1,-1)}I2(){this.tad=!1;this._state=1;Qc.a.J(25012056,818,this.JP?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",
this.JP,this.Xic||"NULL");this.JP=!1}dispose(){this.f6||(1===this._state&&this.Kn.unregister(this),this.f6=!0)}}Object(k.a)(ah,"FindTextReplicator",pn.a,[106]);class Vj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}fc(z){this.K=z;this.K.register(1005,"PowerPointWebEditor.IFindTextManager").ma().na(()=>new Jh(new ah(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.ze("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(1006,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().na(()=>new Uk(this.K.ze("PowerPointWebEditor.IFocusManager")));const Z=new cm.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.K.resolve("PowerPointWebEditor.IRibbonPane").va);this.K.register(1007,"PowerPointWebEditor.IFindReplaceTextHandler").ma().na(()=>new tl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.ze("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
this.K.resolve("Common.IAppSettingsManager").tc("ReplaceAllClientTimeoutMS",0),Z))}init(){const z=new cg(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Cm);z.qb();z.Sd()}dispose(){}static main(){Qa.a.instance.Ac(gf.a(new Vj,
0))}}Object(k.a)(Vj,"PPTWebEditorFindTextPackage",null,[2,3]);class dm{constructor(z){this.Ba=z}get $_d(){return"PowerPoint"}get rUf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get bhk(){return this.Ba.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get hFb(){return this.Ba.powerPointEditorFirstRunExperienceUIIsEnabled}get sGg(){return this.Ba.powerPointEditorFirstRunExperienceTestIsEnabled}get wpj(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get ohh(){return 24}get DHh(){return 4E3}get Awc(){return this.Ba.roamingServiceHandlerWebServiceBase||
""}}Object(k.a)(dm,"FirstRunExperienceLauncherSettings",null,[1060]);class hg{constructor(z){this.oSg=z}f0l(z){this.oSg&&this.oSg.L$e(z)}}Object(k.a)(hg,"FirstRunExperienceManager",null,[1004]);class vj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}fc(z){if(!z)throw Error.argumentNull("container");this.K=z;this.K.register(1004,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().na(()=>new hg(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").Ue(()=>
{this.L$e()})}dispose(){}L$e(){var z=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!z)throw Error.argumentNull("appSettings");const Z=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");Z&&(z=new dm(z),Z.f0l(z))}static main(){Qa.a.instance.Ac(new vj)}}Object(k.a)(vj,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);class en extends qb.a{constructor(){super(!1,!1,!0);this.Ksl=()=>{}}get wbj(){return"TrimVideoDialog"}B$(z){const Z=ResourceStrings.L_TextBox,
pa={};pa.videoSrcUrl=z;this.Fd=1;this.Vj(Z,this.Ksl,{["id"]:this.wbj,["bodyControls"]:pa})}}Object(k.a)(en,"TrimVideoDialog",qb.a,[]);class M{constructor(z,Z,pa,Fa){this.Y1l=(Ma,tb,Hb)=>{Ma=this.oa.Zn();if(null===Ma||void 0===Ma||!Ma.sK||(null===Ma||void 0===Ma?0:Ma.Vp))return Qc.a.J(508367065,846,10,"Selected shape for video object is not valid"),8;if(1===Hb)return 32;this.Doa.P0c(this.Xa.podSessionId,Ma).then(rc=>{rc&&(new en).B$(rc)});return 32};if(!z)throw Error.argumentNull("actionManager");
if(!Z)throw Error.argumentNull("selectionManager");if(!pa)throw Error.argumentNull("mediaLocalRequestHelper");if(!Fa)throw Error.argumentNull("sessionInfoOwner");this.ia=z;this.oa=Z;this.Doa=pa;this.Xa=Fa}Sd(){}qb(){this.ia.xa(Mc.a.vJg,bd.a.application,this.Y1l)}}Object(k.a)(M,"LocalVideoTrimDialogActor",null,[948]);class ck{get name(){return"PowerPointWebEditor.TrimVideoDialog"}fc(z){this.K=z}init(){if(this.K){var z=this.K.resolve("Common.IActionManagerExtended");const Z=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
pa=this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),Fa=this.K.resolve("PowerPointWebEditor.ISessionInfoOwner");z=new M(z,Z,pa,Fa);z.qb();z.Sd()}else Qc.a.J(508367064,846,10,"Container is not available")}dispose(){}static main(){Qa.a.instance.Ac(new ck)}}Object(k.a)(ck,"PPTWebEditorTrimVideoDialogPackage",null,[2,3]);class wf extends qb.a{constructor(z){super(!1,!1,!0);this.ORk=z;this.ZGk=this.ORk.KWl}B$(){this.Fd=0;this.Te(1,"Close");this.Vj("Keyboard Shortcuts",this.Kuk,{["id"]:"KeyboardShortcutsDialog",
["bodyControls"]:{renderOverrideShortcutsSection:!1,defaultCheckbox:!0,prioritySection:"section2"},["shortcuts"]:this.ZGk})}Kuk(){}}Object(k.a)(wf,"KeyboardShortcutsDialog",qb.a,[]);class fn{constructor(z,Z){this.M0l=(pa,Fa,Ma)=>{if(1==Ma)return 32;(new wf(this.lMk)).B$();return 32};if(!z)throw Error.argumentNull("actionManager");if(!Z)throw Error.argumentNull("keyboardshortcutsCollection");this.ia=z;this.lMk=Z}Sd(){}qb(){this.ia.xa(Mc.a.KHg,bd.a.application,this.M0l)}}Object(k.a)(fn,"KeyboardShortCutsActor",
null,[948]);class rm{constructor(z){this.P8=z}get ri(){return this.P8?"\u2318":"Ctrl"}get fPa(){return this.P8?"Option":"Alt"}get Bvg(){return this.ri+"+K"}get xvg(){return this.ri+"+X"}get wvg(){return this.ri+"+C"}get Ivg(){return this.ri+"+V"}get j4j(){return this.ri+"+Shift+V"}get vvg(){return this.ri+"+B"}get A3j(){return this.ri+"+I"}get X4j(){return this.ri+"+U"}get Y4j(){return this.ri+"+Z"}get p4j(){return this.ri+"+Y"}get z3j(){return this.ri+"+Shift+>"}get R4j(){return this.ri+"+Shift+<"}get zvg(){return this.ri+
"+F"}get T4j(){return this.ri+"+Shift+_"}get U4j(){return this.ri+"+Shift+="}get m3j(){return this.ri+"+D"}get Fvg(){return"\u2191,\u2193,\u2190,\u2192"}get $4j(){return"\u2191"}get l3j(){return"\u2193"}get e3j(){return"Delete"}get Gvg(){return"Page Down"}get Hvg(){return"Page Up"}get Kvg(){return"Tab"}get Q4j(){return"Shift+Tab"}get yvg(){return"Esc"}get n4j(){return this.ri+"+P"}get u4j(){return this.fPa+"+Q"}get a5j(){return this.ri+"++"}get b5j(){return this.ri+"+\u2193"}get c5j(){return this.ri+
"+-"}get d5j(){return this.ri+"+\u2191"}get S4j(){return this.ri+"+F5"}get h4j(){return"N"}get i4j(){return"Page Down"}get l4j(){return"P"}get m4j(){return"Page Up"}get W4j(){return"J"}get F4j(){return"Enter"}get G4j(){return"F2"}get o3j(){return"F2"}get z4j(){return"Ctrl+Click"}get A4j(){return"Shift+Click"}get w4j(){return"Click+Drag the mouse"}get x4j(){return"Shift+Drag the mouse"}get y4j(){return"Ctrl+Drag the mouse"}get qoe(){return this.ri+"+A"}get O4j(){return this.ri+"+["}get P4j(){return this.ri+
"+]"}get y3j(){return this.ri+"+G"}get Z4j(){return this.ri+"+Shift+G"}get X2j(){return this.ri+"+"+this.Fvg}get t4j(){return this.fPa+"+\u2192"}get s4j(){return this.fPa+"+\u2190"}get x3j(){return"G,then the \u2190 or \u2192 until on the slide,and then Enter"}get a4j(){return"Tab"}get c4j(){return"Shift+Tab"}get b4j(){return"\u2193"}get d4j(){return"\u2191"}get Jvg(){return"Enter"}get W2j(){return"Tab"}get t3j(){return"\u2193"}get w3j(){return"\u2191"}get q3j(){return"\u2192"}get Z2j(){return"\u2190"}get u3j(){return"\u2193"}get v3j(){return"\u2191"}get J3j(){return"Tab"}get n3j(){return"Tab to more thread actions,Enter and \u2193 to Edit comment"}get k4j(){return this.ri+
"+Enter"}get C4j(){return"Shift+\u2192"}get B4j(){return"Shift+\u2190"}get D4j(){return"Shift+"+this.ri+"+\u2190"}get E4j(){return"Shift+"+this.ri+"+\u2192"}get N4j(){return"Shift+\u2191"}get v4j(){return"Shift+\u2193"}get L4j(){return"Shift+"+this.ri+"+\u2191"}get I4j(){return"Shift+"+this.ri+"+\u2193"}get K4j(){return this.P8?"Shift+"+this.ri+"+\u2190":"Shift+Home"}get H4j(){return this.P8?"Shift+"+this.ri+"+\u2192":"Shift+End"}get M4j(){return this.P8?"Shift+"+this.ri+"+Fn\u2190":"Shift+"+this.ri+
"+Home"}get J4j(){return this.P8?"Shift+"+this.ri+"+Fn\u2192":"Shift+"+this.ri+"+End"}get f3j(){return this.P8?"Delete":"Backspace"}get g3j(){return this.P8?"Fn+Delete":"Delete"}get h3j(){return this.P8?this.ri+"+Delete":this.ri+"+Backspace"}get i3j(){return this.ri+"+Delete"}get R3j(){return"\u2192"}get Q3j(){return"\u2190"}get Evg(){return this.ri+"+\u2192"}get Dvg(){return this.ri+"+\u2190"}get T3j(){return"\u2191"}get S3j(){return"\u2193"}get Z3j(){return this.P8?this.ri+"+\u2192":"End"}get e4j(){return this.P8?
this.ri+"+\u2190":"Home"}get g4j(){return this.ri+"+\u2191"}get I3j(){return this.ri+"+\u2193"}get $3j(){return this.P8?this.ri+"+Fn\u2192":this.ri+"+End"}get f4j(){return this.P8?this.ri+"+Fn\u2190":this.ri+"+Home"}get Y2j(){return this.ri+"+E"}get B3j(){return this.ri+"+J"}get V4j(){return"Shift+F3"}get q4j(){return this.ri+"+Space"}get o4j(){return this.fPa+"+Shift+\u2190"}get j3j(){return this.fPa+"+Shift+\u2192"}get d3j(){return"*, then press space"}get a3j(){return"-, then press space"}get b3j(){return">, then press space"}get c3j(){return"<, then press space"}get Y3j(){return this.ri+
"+\u2191"}get V3j(){return this.ri+"+\u2193"}get W3j(){return this.ri+"+Shift+\u2191"}get X3j(){return this.ri+"+Shift+\u2193"}get N3j(){return this.ri+"+F6"}get L3j(){return this.ri+"+F6"}get O3j(){return this.ri+"+F6"}get P3j(){return this.ri+"+F6"}get M3j(){return this.ri+"+F6"}get Cvg(){return this.ri+"+F6"}get E3j(){return"Shift+"+this.ri+"+F6"}get D3j(){return"Shift+"+this.ri+"+F6"}get G3j(){return"Shift+"+this.ri+"+F6"}get F3j(){return"Shift+"+this.ri+"+F6"}get C3j(){return"Shift+"+this.ri+
"+F6"}get s3j(){return"\u2190 or \u2193"}get H3j(){return"\u2190 or \u2192"}get k3j(){return this.fPa+"+. or "+this.fPa+"+\u229e"}get U3j(){return this.ri+"+Shift+F"}get K3j(){return"\u2191 or \u2193"}get r3j(){return"+(on numeric keypad only) or \u2192"}get $2j(){return"-(on numeric keypad only) or \u2190"}get r4j(){return"F2"}get p3j(){return this.fPa+"+Shift+9"}}Object(k.a)(rm,"KeyboardShortcutsMapping",null,[]);class pj{constructor(){this.zbh=[];this.cIb=!1;this.cIb=ba.a.Fl;this.Ad=new rm(this.cIb);
this.L6i()}get KWl(){return this.zbh}L6i(){this.lui();this.jwi();this.Evi();this.Zvi();this.Ewi();this.Awi();this.xti();this.aui();this.Qui();this.Uvi()}lui(){this.Rd("Apply bold formatting to the selected text",this.Ad.vvg,"Frequently used");this.Rd("Cut selected text, object or slide",this.Ad.xvg,"Frequently used");this.Rd("Copy selected text, object or slide",this.Ad.wvg,"Frequently used");this.Rd("Paste cut or copied text, object or slide",this.Ad.Ivg,"Frequently used");this.Rd("Insert a hyperlink",
this.Ad.Bvg,"Frequently used");this.Rd("Undo the last action",this.Ad.Y4j,"Frequently used");this.Rd("Redo the last action",this.Ad.p4j,"Frequently used");this.Rd("Delete selected text, object or slide",this.Ad.e3j,"Frequently used");this.Rd("Open the Find dialog box",this.Ad.zvg,"Frequently used");this.Rd("Go to the next slide (with the focus in the thumbnail pane or the slide pane)",this.Ad.Gvg,"Frequently used");this.Rd("Go to the previous slide (with the focus in the thumbnail pane or the slide pane)",
this.Ad.Hvg,"Frequently used");this.Rd("When a task pane option has focus, move to the next or previous option in the task pane",this.Ad.Kvg+" or "+this.Ad.Q4j,"Frequently used");this.Rd("Exit the Slide Show view",this.Ad.yvg,"Frequently used");this.Rd("Print a presentation",this.Ad.n4j,"Frequently used");this.Rd("Search and action or command",this.Ad.u4j,"Frequently used");this.Rd("Move a shape",this.Ad.Fvg,"Frequently used")}jwi(){this.Rd("Go to the next slide (with the focus in the thumbnail pane or the slide pane)",
this.Ad.Gvg,"Slides");this.Rd("Go to the previous slide (with the focus in the thumbnail pane or the slide pane)",this.Ad.Hvg,"Slides");this.Rd("Zoom in on the slide",this.Ad.a5j+" or "+this.Ad.b5j,"Slides");this.Rd("Zoom out of the slide",this.Ad.c5j+" or "+this.Ad.d5j,"Slides");this.cIb||(this.Rd("Move the selected slide up one position in the thumbnail pane",this.Ad.Y3j,"Slides"),this.Rd("Move the selected slide down one position in the thumbnail pane",this.Ad.V3j,"Slides"),this.Rd("Move the selected slide to the beginning in the thumbnail pane",
this.Ad.W3j,"Slides"),this.Rd("Move the selected slide to the end in the thumbnail pane",this.Ad.X3j,"Slides"))}Evi(){this.cIb||this.Rd("Start the Slide Show",this.Ad.S4j,"While presenting");this.Rd("Go to the next slide in the Slide Show view",this.Ad.h4j+" or "+this.Ad.i4j+" or "+this.Ad.l3j,"While presenting");this.Rd("Go to the previous slide in the Slide Show view",this.Ad.l4j+" or "+this.Ad.m4j+" or "+this.Ad.$4j,"While presenting");this.Rd("Go to a specific slide in the Slide Show view",this.Ad.x3j,
"While presenting");this.Rd("Turn captions or subtitles on or off in the Slide Show view",this.Ad.W4j,"While presenting");this.Rd("Exit the slide show",this.Ad.yvg,"While presenting")}Zvi(){this.Rd("Cut selected object or text",this.Ad.xvg,"Shapes and Objects");this.Rd("Copy selected object or text",this.Ad.wvg,"Shapes and Objects");this.Rd("Paste cut or copied object or text",this.Ad.Ivg,"Shapes and Objects");this.Rd("Duplicate selected objects",this.Ad.m3j,"Shapes and Objects");this.Rd("Paste text, unformatted",
this.Ad.j4j,"Shapes and Objects");this.Rd("Move left to right through placeholders on a slide",this.Ad.Kvg,"Shapes and Objects");this.Rd("Select or edit the current placeholder",this.Ad.F4j+" or "+this.Ad.G4j,"Shapes and Objects");this.Rd("End editing text in a placeholder",this.Ad.o3j,"Shapes and Objects");this.Rd("Select multiple single objects",this.Ad.z4j+" or "+this.Ad.A4j,"Shapes and Objects");this.Rd("Select multiple objects",this.Ad.w4j+" or "+this.Ad.x4j+" or "+this.Ad.y4j,"Shapes and Objects");
this.Rd("Select all objects on the page.",this.Ad.qoe,"Shapes and Objects");this.Rd("Select all text in the active text box",this.Ad.qoe,"Shapes and Objects");this.Rd("Insert a hyperlink in the active text box",this.Ad.Bvg,"Shapes and Objects");this.Rd("Send the object back one position",this.Ad.O4j,"Shapes and Objects");this.Rd("Send the object forward one position",this.Ad.P4j,"Shapes and Objects");this.Rd("Group selected object",this.Ad.y3j,"Shapes and Objects");this.Rd("Ungroup selected group",
this.Ad.Z4j,"Shapes and Objects");this.Rd("Adjust width or height of objects in smaller increments",this.Ad.X2j,"Shapes and Objects");this.Rd("Rotate the selected object clockwise",this.Ad.t4j,"Shapes and Objects");this.Rd("Rotate the selected object counter-clockwise",this.Ad.s4j,"Shapes and Objects")}Ewi(){this.Rd("Select one character to the left",this.Ad.B4j,"Text Editing");this.Rd("Select one character to the right",this.Ad.C4j,"Text Editing");this.Rd("Select one word to the left",this.Ad.D4j,
"Text Editing");this.Rd("Select one word to the right",this.Ad.E4j,"Text Editing");this.Rd("Select from the insertion point to the same point one line up",this.Ad.N4j,"Text Editing");this.Rd("Select from the insertion point to the same point one line down",this.Ad.v4j,"Text Editing");this.Rd("Select from the insertion point to the beginning of the paragraph",this.Ad.L4j,"Text Editing");this.Rd("Select from the insertion point to the end of the paragraph",this.Ad.I4j,"Text Editing");this.Rd("Select to the beginning of a line",
this.Ad.K4j,"Text Editing");this.Rd("Select to the end of a line",this.Ad.H4j,"Text Editing");this.Rd("Select to the beginning of a placeholder or notes",this.Ad.M4j,"Text Editing");this.Rd("Select to the end of a placeholder or notes",this.Ad.J4j,"Text Editing");this.Rd("Select all within the placeholder or notes",this.Ad.qoe,"Text Editing");this.Rd("Delete one character to the left",this.Ad.f3j,"Text Editing");this.Rd("Delete one character to the right",this.Ad.g3j,"Text Editing");this.Rd("Delete one word to the left",
this.Ad.h3j,"Text Editing");this.Rd("Delete one word to the right (with the cursor between the words)",this.Ad.i3j,"Text Editing");this.Rd("Move one character to the left",this.Ad.Q3j,"Text Editing");this.Rd("Move one character to the right",this.Ad.R3j,"Text Editing");this.Rd("Move one word to the left",this.Ad.Dvg,"Text Editing");this.Rd("Move one word to the right",this.Ad.Evg,"Text Editing");this.Rd("Move one line up",this.Ad.T3j,"Text Editing");this.Rd("Move one line down",this.Ad.S3j,"Text Editing");
this.Rd("Move to the end of a line",this.Ad.Z3j,"Text Editing");this.Rd("Move to the beginning of a line",this.Ad.e4j,"Text Editing");this.Rd("Move up one paragraph",this.Ad.g4j,"Text Editing");this.Rd("Move down one paragraph",this.Ad.I3j,"Text Editing");this.Rd("Move to the end of a text box",this.Ad.$3j,"Text Editing");this.Rd("Move to the beginning of a text box",this.Ad.f4j,"Text Editing");this.Rd("Increase the font size",this.Ad.z3j,"Text Editing");this.Rd("Decrease the font size",this.Ad.R4j,
"Text Editing");this.Rd("Apply bold formatting to the selected text",this.Ad.vvg,"Text Editing");this.Rd("Apply italic formatting",this.Ad.A3j,"Text Editing");this.Rd("Apply underline formatting",this.Ad.X4j,"Text Editing");this.Rd("Center a paragraph",this.Ad.Y2j,"Text Editing");this.Rd("Justify a paragraph",this.Ad.B3j,"Text Editing");this.Rd("Apply subscript formatting to selected text",this.Ad.T4j,"Text Editing");this.Rd("Apply superscript formatting to selected text",this.Ad.U4j,"Text Editing");
this.Rd("Switch between sentence case, lowercase, or uppercase",this.Ad.V4j,"Text Editing");this.cIb||(this.Rd("Remove manual character formatting, such as subscript and superscript",this.Ad.q4j,"Text Editing"),this.Rd("Promote a paragraph",this.Ad.o4j,"Text Editing"),this.Rd("Demote a paragraph",this.Ad.j3j,"Text Editing"));this.Rd("Create a list with filled round bullet",this.Ad.d3j,"Text Editing");this.Rd("Create a list that uses hyphens",this.Ad.a3j,"Text Editing");this.Rd("Create a list that uses arrow bullets",
this.Ad.b3j,"Text Editing");this.Rd("Create a list that uses diamond bullets",this.Ad.c3j,"Text Editing")}Awi(){this.Rd("Move to the next cell",this.Ad.a4j,"Tables");this.Rd("Move to the preceding cell",this.Ad.c4j,"Tables");this.Rd("Move to the next row",this.Ad.b4j,"Tables");this.Rd("Move to the preceding row",this.Ad.d4j,"Tables");this.Rd("Start a new paragraph",this.Ad.Jvg,"Tables");this.Rd("Add a new row at the bottom of the table with the cursor in the last cell of the last row",this.Ad.W2j,
"Tables")}xti(){this.Rd("Go to the next comment thread",this.Ad.t3j,"Comments");this.Rd("Go to the previous comment thread",this.Ad.w3j,"Comments");this.Rd("Expand a comment thread when the focus is on it",this.Ad.q3j,"Comments");this.Rd("Collapse a comment thread",this.Ad.Z2j,"Comments");this.Rd("Go to the next reply in a comment thread",this.Ad.u3j,"Comments");this.Rd("Go to the previous reply in a thread or the parent comment",this.Ad.v3j,"Comments");this.Rd("Move the focus to the reply box",this.Ad.J3j,
"Comments");this.Rd("Edit a parent comment or reply (when the focus is on the parent comment or reply)",this.Ad.n3j,"Comments");this.Rd("Post a comment or a reply or save an edit",this.Ad.k4j,"Comments")}aui(){this.Rd("Find",this.Ad.zvg,"Find and Replace")}Qui(){this.Rd("Slide pane",this.Ad.N3j,"Keyboard Navigation");this.Rd("Slide pane",this.Ad.E3j,"Keyboard Navigation");this.Rd("Notes pane",this.Ad.L3j,"Keyboard Navigation");this.Rd("Notes pane",this.Ad.C3j,"Keyboard Navigation");this.Rd("Status bar",
this.Ad.O3j,"Keyboard Navigation");this.Rd("Status bar",this.Ad.F3j,"Keyboard Navigation");this.Rd("Title bar",this.Ad.P3j,"Keyboard Navigation");this.Rd("Title bar",this.Ad.G3j,"Keyboard Navigation");this.Rd("Ribbon",this.Ad.M3j,"Keyboard Navigation");this.Rd("Ribbon",this.Ad.D3j,"Keyboard Navigation");this.Rd("Thumbnail pane",this.Ad.Cvg,"Keyboard Navigation");this.Rd("Thumbnail pane",this.Ad.Cvg,"Keyboard Navigation");this.Rd("Go to a different ribbon tab",this.Ad.s3j,"Keyboard Navigation");this.Rd("Carry out the currently selected ribbon option",
this.Ad.Jvg,"Keyboard Navigation");this.Rd("Move between ribbon options or controls",this.Ad.H3j,"Keyboard Navigation");this.Rd("Move between groups of features on the ribbon",this.Ad.Dvg+" or "+this.Ad.Evg,"Keyboard Navigation");this.Rd("Display the access keys (ribbon commands) on the ribbon",this.Ad.k3j,"Keyboard Navigation")}Uvi(){this.cIb||this.Rd("Move a selected item forward",this.Ad.U3j,"Selection Pane");this.Rd("Move the focus to a single item or group",this.Ad.K3j,"Selection Pane");this.Rd("Expand a focused group",
this.Ad.r3j,"Selection Pane");this.Rd("Collapse a focused group",this.Ad.$2j,"Selection Pane");this.Rd("Rename a focused item",this.Ad.r4j,"Selection Pane");this.Rd("Expand all groups",this.Ad.p3j,"Selection Pane")}Rd(z,Z,pa){this.zbh.push({description:z,shortcut:Z,section:pa,overrideBrowserShortcut:""})}}Object(k.a)(pj,"KeyboardShortcutsCollection",null,[]);class ul{get name(){return"PowerPointWebEditor.KeyboardShortcutsDialog"}fc(z){this.K=z;z.register(pj,"PowerPointWebEditor.KeyboardShortcutsCollection").ma().na(()=>
new pj)}init(){if(this.K){const z=new fn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.KeyboardShortcutsCollection"));z.qb();z.Sd()}else e.ULS.sendTraceTag(508367313,334,50,"PPTWebEditorKeyboardShortcutsDialogPackage.init Empty container while intializing")}dispose(){}static main(){Qa.a.instance.Ac(new ul)}}Object(k.a)(ul,"PPTWebEditorKeyboardShortcutsDialogPackage",null,[2,3]);var eg=d(470);class ni{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(k.a)(ni,"CatchUpConfiguration",null,[]);class wc{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(k.a)(wc,"SharedControllerFactoryParameters",null,[]);const kj=(z,Z)=>{if(!z)throw Error.create(String.format("Argument {0} is null.",Z));},$c=z=>{if(!z.navigationId)return Qc.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const Z=window.atob(z.navigationId);return Z&&""!==Z?{["NavigationId"]:Z}:null}catch(Z){return Qc.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",
Z),null}};class jg{constructor(z){kj(z,"ActivityContentManager.IActionManagerExtended");this.ia=z}doesContentExist(z){if(!z)return Qc.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(z=$c(z))?32===this.ia.Ia(oa.a.izb,2,z):!1;default:return!1}}}Object(k.a)(jg,"ActivityContentManager",null,[1E3]);class mk{constructor(z){this.zn=z}shouldShowEmptyExperienceButton(){return H.AFrameworkApplication.C9c()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.zn.Ia(oa.a.Xyc,
2,null)}onInviteOthersButtonClick(){this.zn.Ia(oa.a.bfa,2,null)}}Object(k.a)(mk,"EmptyCatchUpBehaviorManager",null,[1003]);class Kh{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(k.a)(Kh,"Person",null,[]);var Yg=d(663),em=d(235),sh=d(172);class Vk extends jj.a{constructor(z){super();this.StartTime=null;this.StartTime=z}om(){return 93}}Object(k.a)(Vk,"GetFileRevisionHistoryRequest",jj.a,[]);class vl{constructor(z,Z,pa){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=z;this.UserId=Z;this.ProviderId=pa}}Object(k.a)(vl,"Author",null,[]);const gl=(z,Z)=>z&&Z?z.providerIdField===Z.ProviderId?z.userIdField===Z.UserId:z.userNameField===Z.UserName:!1;var lj=d(247);class Ij{constructor(z,Z,pa){this.Edd=this.dgb=null;this.Qi=z;this.qgb=pa;this.qgb.Wyi(Object(ib.a)(this,this.Smh,"onFileRevisionHistoryReady"));Z.Ue(()=>{this.dgb=new vl(Z.Ea("UserName"),Z.Ea("387"),Z.Ea("388"))})}dispose(){this.qgb.tBl(Object(ib.a)(this,this.Smh,
"onFileRevisionHistoryReady"));this.dgb=null}lBj(z,Z,pa){z&&pa&&(this.Edd=pa,z=new lj.a(new Vk(z),Fa=>{this.FKg(Fa,Z);this.Rpd(Fa)},Fa=>{this.FKg(Fa,Z);return this.Pkb(Fa)}),this.Qi.Jb(z))}Smh(z,Z){z=null;const pa=[];Ob.a.Ta(Z.ZXc)||(({ZXc:Z}=this.hem(Z.ZXc)).returnValue?sh.b(Z.fileRevisionEntriesField,Fa=>this.Imk(Fa.changesDataField),Fa=>{pa.push(Fa.changesDataField)}):z="ErrorGetFileRevisionHistoryParseJsonException");this.wUe(pa,z)}Rpd(z){let Z=null;z.ServerError&&0!==z.ServerError.Code?Z=em.a[z.ServerError.Code]:
0!==z.StatusCode&&(Z=Yg.a[z.StatusCode]);Z&&this.wUe(null,Z)}Pkb(z){Qc.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+z.toString());this.wUe(null,"ErrorGetFileRevisionHistoryFailed");return!0}wUe(z,Z){this.Edd&&(z=this.Gtj(z),this.Edd(z,Z),this.Edd=null)}hem(z){let Z;Z=null;try{Z=Sys.Serialization.JavaScriptSerializer.deserialize(z)}catch(pa){Qc.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+pa)}return{returnValue:!!Z,ZXc:Z}}Imk(z){return!gl(z,this.dgb)}FKg(z,Z){z.Zza&&
Z.Xm("GetAuthorNamesRequestInvokedTime",z.Zza);Z.Wa("GetAuthorNamesRequestCorrelationId",z.ii)}Gtj(z){if(!z)return[];const Z=Array(z.length);for(let Fa=0;Fa<z.length;Fa++){var pa=z[Fa];pa=Object.assign(new Kh,{displayName:pa.userNameField,id:pa.userIdField,provider:pa.providerIdField});Z[Fa]=pa}return Z}}Object(k.a)(Ij,"FileRevisionHistoryService",null,[1056,106]);class qa{constructor(z,Z){kj(z,"FlyoutFocus.IF6Manager");kj(Z,"FlyoutFocus.IFocusManagerHelper");this.ih=z;this.YG=Z}initialize(){this.YG.Lfa(cd.a.w$a,
cd.a.Nj,null,Object(ib.a)(this,this.$pj,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.ih.bM(cd.a.w$a)}disableF6Focus(){this.ih.zp(cd.a.w$a)}$pj(){const z=document.getElementById("flyoutItem0");z&&(Qc.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),z.focus())}}Object(k.a)(qa,"FlyoutFocus",null,[1055]);class hb{constructor(z,Z,pa,Fa){this.abd=null;this.iNg=this.HTg=this.YHb=this.Red=!1;kj(Z,"FlyoutRibbonButton.IActionManagerExtended");kj(pa,"FlyoutRibbonButton.IFocusManager");
kj(Fa,"FlyoutRibbonButton.FloodgateEventLogger");this.Db=z;this.ia=Z;this.Fa=pa;this.WIk=Fa;this.$Ik=new Date}initialize(){H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Pf.a("DelayRegisterCatchUpActions")||this.qb()}registerButtonClickedEvent(z){this.abd&&Qc.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.abd=z.buttonClickedCallback}onFlyoutInitialized(){this.Red&&Qc.a.J(571532948,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const z=(new Date).getTime()-this.$Ik.getTime();Qc.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",z);this.Red=!0;he.c(oa.a.DQi,!0,he.e,0,0,z);H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Pf.a("DelayRegisterCatchUpActions")&&this.qb();this.Db&&this.Db.Gf()}logFlightTriggers(){}onFlyoutVisibilityChanged(z){this.YHb!==z.flyoutIsVisible&&
(this.YHb=z.flyoutIsVisible,this.Db&&this.Db.Gf(!0),this.YHb&&this.iNg?this.Fa.Df(cd.a.w$a):this.YHb||this.Fa.Df(cd.a.Nj),this.YHb||this.WIk.mzk())}qb(){this.ia.xa(oa.a.Tef,Db.a.frame,Object(ib.a)(this,this.P$k,"onToggleCatchUpFlyout"));this.ia.pa(oa.a.Qyh,Db.a.frame,Object(ib.a)(this,this.y8k,"onQueryToggleCatchUpFlyout"),96)}P$k(z,Z,pa){if(1===pa)return this.Red?(this.HTg||(this.HTg=!0,Qc.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.abd)return 8;this.iNg=!0;this.abd();return 32}y8k(z,
Z,pa,Fa,Ma){Ma[dg.a.Visible]=!0;Ma[dg.a.On]=this.YHb&&this.Red;return 32}}Object(k.a)(hb,"FlyoutRibbonButton",null,[1054]);const Gb=z=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+z)};class pc{constructor(z,Z,pa,Fa,Ma,tb){kj(z,"PowerPointActivityNavigationManager.IActionManagerExtended");kj(Z,"PowerPointActivityNavigationManager.IPresentationReader");kj(pa,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");kj(Fa,"PowerPointActivityNavigationManager.IRibbonUser");
kj(tb,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=z;this.Wb=Z;this.De=pa;this.nv=Fa;this.dRk=Ma;this.KFk=tb}navigateToActivity(z){if(z.fromSummaryString)return this.BQl(),this.dTj(),this.aTj(),this.x_l(),Promise.resolve(1);z=z.activity;if(!z)return Qc.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!z.navigationId)return Qc.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),Promise.resolve(4);if(!this.KFk.doesContentExist(z))return Promise.resolve(2);
switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:z=$c(z);if(!z)return Promise.resolve(5);z=this.ia.Ia(oa.a.W5b,2,z);return Promise.resolve(32===z?1:6);default:return Promise.resolve(7)}}BQl(){const z=this.Wb.Fn;z?z.QFa=!0:Qc.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}dTj(){this.nv.selectRibbonTabById(this.dRk)}aTj(){var z=this.Wb.Fn;if(z&&z.slides){var Z=null;for(const pa of z.slides)if(pa&&(z=this.Wb.Qk(pa.Fb))&&z.isUnread){Z=z;
break}Z?(this.De.Eyd(),this.De.RI(Z.ve)):Qc.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Qc.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}x_l(){this.ia.Ia(Mc.a.R3a,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(k.a)(pc,"PowerPointActivityNavigationManager",null,[1001]);var vd=d(679);class zd{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=
null}}Object(k.a)(zd,"ActivityFeedEntry",null,[]);const xe=(z,Z)=>Z.w9c?Ea.toArray(Ea.select(Ea.asEnumerable(z),pa=>{if(!pa||!pa.activityFeedItemPayload)return pa;const Fa=JSON.parse(pa.activityFeedItemPayload);var Ma=Fa.actor;if(!Ma||Ma.pictureUrl)return pa;const tb=Ma.userPrincipalName||Ma.email;if(!tb)return pa;Ma=Z.uyb(tb,Ma.provider,H.AFrameworkApplication.mh,0);if(!Ma)return pa;Fa.actor.pictureUrl=Ma;return Object.assign(new zd,{id:pa.id,type:pa.type,collectionId:pa.collectionId,activityState:pa.activityState,
activityFeedItemPayload:JSON.stringify(Fa),timestamp:pa.timestamp})})):z,le=(z,Z)=>{const pa=new Map,Fa=new Map;for(const Ma of z){if(!Ma||!Ma.activityFeedItemPayload)continue;z=JSON.parse(Ma.activityFeedItemPayload).actor;if(!z)continue;const tb=z.email||z.userPrincipalName;tb&&!Fa.has(tb)&&Fa.set(tb,new vd.a(tb,null,z.name))}Fa.forEach(Ma=>{const tb=Z.Dva(Ma,6);pa.set(Ma.UserId,tb)});return pa};class Dg{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=
null}}Object(k.a)(Dg,"ActivityFeedItem",null,[]);class ch{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(k.a)(ch,"ActivityFeedPayload",null,[]);class $h{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(k.a)($h,"ActivityRequestPayload",null,[]);var wj=d(546);class kf{constructor(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=
this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(k.a)(kf,"Activity",null,[]);class Kf{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc){this.ff=this.KKe=null;kj(z,"PowerPointActivityRequestManager.IJsonpHelperManager");kj(Z,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");kj(pa,"PowerPointActivityRequestManager.IFileRevisionHistoryService");kj(Fa,"PowerPointActivityRequestManager.IAppSettingsManager");kj(Ma,"PowerPointActivityRequestManager.IApplicationSettings");kj(tb,
"PowerPointActivityRequestManager.IActionManagerExtended");kj(Hb,"PowerPointActivityRequestManager.ICatchUpRequestHandler");kj(rc,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");kj(yc,"PowerPointActivityRequestManager.IPeopleColorUtils");this.Tga=z;this.UUk=Z;this.OIk=pa;this.Lb=Fa;this.ia=tb;this.ibd=Hb;this.hQk=rc;this.zhd=yc;this.ebh=xc}requestWYWAActivities(){return new Promise((z,Z)=>{this.ff=vg.a.Zj("ShowWYWACallout",2);this.UUk.AHl(pa=>{pa=this.dml(pa);Kf.isExpectedError(pa)?
z(Kf.LUc):pa?(Qc.a.J(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",pa),Z(pa)):this.OIk.lBj(this.KKe,this.ff,(Fa,Ma)=>{Ma&&(Qc.a.J(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Ma),Z(Ma));z(Kf.T_i(Fa))})},pa=>{const Fa=!!pa.data&&Kf.jik(pa.data.Ke);pa=this.Tga.n$(pa);Qc.a.J(509223007,3012,Fa?50:10,"OnReadRoamingFailed() - Error: {0}",pa);Fa?z(Kf.LUc):Z(pa)})})}requestActivities(){return Promise.resolve(Kf.LUc)}requestRelevantActivities(){return Promise.resolve(Kf.LUc)}requestActivityFeed(){return this.ibd?
wj.b(this.ibd.Dtj(this.ebh)).then(z=>{z=Kf.Kbm(z);return{activityFeedItems:xe(z,this.hQk),personaColorMap:le(z,this.zhd)}}):Promise.resolve(Object.assign(new ch,{activityFeedItems:[]}))}updateActivityState(z){return this.ibd?wj.b(this.ibd.Fgm(this.ebh,z.itemIds,z.activityStatesToSet||0,z.activityStatesToReset||0,z.resetUnseenCount)):Promise.resolve(!1)}dml(z){z=z.data.Ud;if(!z)return"ErrorReadRoamingEmptyResponseBody";let Z;try{Z=JSON.parse(z)}catch(pa){return pa.toString()}z=null;if(!Z.Error){if(!Z.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");
z=Z.Timestamp}this.KKe=this.alm(z);Qc.a.J(509223006,3012,100,"Timestamp for retrieving activities: "+this.KKe);return Z.Error}alm(z){const Z={};var pa=this.Lb.tc("AppWaterlineOverrideTimestampValue",0);return pa?(z=new Date(1E3*pa),Z.timestamp=z,this.ia.Ia(Mc.a.TAd,2,Z),z.format("yyyy-MM-ddTHH:mm:ssZ")):z?(pa=this.Lb.tc("AppWaterlineOverrideDaysValue",0))?(z=new Date(+new Date(z)-+new Date(864E5*pa)),Z.timestamp=z,this.ia.Ia(Mc.a.TAd,2,Z),z.format("yyyy-MM-ddTHH:mm:ssZ")):z:null}static T_i(z){return z?
Object.assign(new $h,{actors:z}):null}static Kbm(z){const Z=[];if(!z)return Z;for(const pa of z)Z.push(Object.assign(new Dg,{id:pa.id,type:pa.type,collectionId:pa.collectionId,activityState:pa.activityState,activityFeedItemPayload:pa.activityFeedItemPayload,timestamp:pa.timestamp}));return Z}static isExpectedError(z){return"ErrorDocNotInRoamingList"===z||"ErrorLastViewedDocListIsEmpty"===z}static jik(z){return 403===z}}Kf.LUc=Object.assign(new $h,{activities:[],actors:[],hasMore:!1,highWaterline:"",
lowWaterline:"",wywaWaterline:""});Object.assign(new $h,{activities:[Object.assign(new kf,{activityId:"activityId1",type:3,actors:[Object.assign(new Kh,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new kf,{activityId:"activityId2",type:4,actors:[Object.assign(new Kh,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,
relevancy:2,navigationId:"navigationId2"})]});Object.assign(new ch,{activityFeedItems:[Object.assign(new Dg,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new Dg,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(k.a)(Kf,"PowerPointActivityRequestManager",null,[1002]);var lh=d(249);class sc{constructor(z,Z,pa,Fa,Ma,tb){this.zhb=!1;this.o_g=null;this.Nc=z;this.Ms=Z;this.mRk=pa;this.Tga=Fa;this.zb=Ma;this.gKb=tb}initialize(){this.Nc&&(this.Nc.dEa(Object(ib.a)(this,this.DLa,"onBeforeSessionEnd")),this.Nc.aC(Object(ib.a)(this,this.GN,"onSessionClosed")));this.JKl()}AHl(z,Z){const pa=this.Hng("getPPTDocLastViewedTimestamp");this.Py(pa,1,z,Z)}DLa(){this.e6h()}GN(){this.zhb=
!0}JKl(){if(this.zb){var z=new ee.a(3,2,3E4,Object(ib.a)(this,this.gFl,"requestWriteWaterline"),90,"29");this.zb.Jb(z)}}gFl(){!this.zhb&&3E4<+vg.a.Ugc-+this.o_g&&(this.e6h(),this.o_g=vg.a.Ugc)}e6h(){const z=this.Hng("savePPTDocLastViewedTimestamp");this.gKb.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled")?this.Ms.Mqa(z,""):this.Py(z,2,Object(ib.a)(this,this.zal,"onWriteWaterlineSucceeded"),Object(ib.a)(this,this.yal,"onWriteWaterlineFailed"))}zal(z){let Z=null;try{const pa=z.data.Ud;Z=
pa?JSON.parse(pa).Error:"ErrorWriteRoamingEmptyResponseBody"}catch(pa){Z="ErrorWriteRoamingParseJsonResponseException",Qc.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+pa)}finally{Z&&this.cLg(Z)}Qc.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.au-+z.data.cF,+z.data.Et-+z.data.cF)}yal(z){this.cLg("ErrorReadRoamingFailed");Qc.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.Tga.n$(z))}Hng(z){return this.mRk+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
z,H.AFrameworkApplication.mh)}Py(z,Z,pa,Fa){const Ma={};Ma["X-StatelessPopsAffinityRoutingEnabled"]=this.gKb.getBooleanAppSetting("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Ms.Tj(z,Z,null,Ma,!1,1,pa,Fa,null,void 0,void 0,void 0,void 0,lh.a("5"))}cLg(z){Qc.a.J(572555924,811,50,z)}}Object(k.a)(sc,"PowerPointWaterlineUpdater",null,[]);class uf{get name(){return"PowerPointWebEditor.Activity"}get Xte(){return H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").Ue(Object(ib.a)(this,this.I$i,"delayedInit"))}fc(z){this.K=z}dispose(){this.K=this.hbd=null}pXl(z){return!z||z.getBooleanAppSetting("IsAnonymousUser")?!1:z.getBooleanAppSetting("PPTCatchUpFlyoutIsEnabled")}I$i(){const z=this.K.resolve("Common.IAppSettingsManager");this.pXl(z)&&(Gb("Begin"),this.dej(),this.jAk())}dej(){Zd.a.get_instance().Ij(7,()=>{Gb("ScriptDownload");Gk.a(this.K)("catchUpActivity").catch(()=>{Qc.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.x8j()).catch(()=>{Qc.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}jAk(){Qc.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Xte&&Qc.a.J(526718752,3012,50,"ActivityFeedData is enabled")}x8j(){const z=new Ij(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),Z=this.K.resolve("Common.AFrameworkApplication");this.K.register(sc,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().na(()=>new sc(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),H.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(1E3,"Common.App.CatchUpActivity.IActivityContentManager").ma().na(()=>new jg(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1001,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().na(()=>new pc(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),ne.a.Bsl,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let pa=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mg&&
(pa=this.K.resolve("Common.IAppSettingsManager").Ea("368")+"p");this.K.register(1002,"Common.App.CatchUpActivity.IActivityRequestManager").ma().na(()=>new Kf(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),z,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
this.K.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.K.resolve("Common.App.People.IPeopleColorUtils"),pa));this.K.register(hb,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().na(()=>new hb(Z.Qp,H.AFrameworkApplication.Pa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(qa,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().na(()=>
new qa(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));this.K.register(1003,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().na(()=>new mk(this.K.resolve("Common.IActionManagerExtended")));this.hbd=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new wc,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:H.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.Xte?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:H.AFrameworkApplication.uiCulture,ulsLogger:new eg.a}));if(!this.hbd)return Promise.reject("Failure to create CatchUpApp");
this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.hbd.setWebpackPublicPath(H.AFrameworkApplication.jra);Gb("InitializeCatchUpApp");return this.hbd.initialize(Object.assign(new ni,{activityFeedDataEnabled:this.Xte,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){Qa.a.instance.Ac(gf.a(new uf,
0))}}Object(k.a)(uf,"PPTWebEditorActivityPackage",null,[2,3]);var Ak=d(752);class oi extends Sys.EventArgs{constructor(z,Z){super();this.shape=z;this.QFa=Z}}Object(k.a)(oi,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class sg{constructor(z,Z,pa,Fa,Ma,tb,Hb){this.ff=null;this.ia=z;this.sa=Z;this.zS=pa;this.djd=Fa;this.Tb=Ma;this.Hc=tb;this.Qib=Hb}dispose(){this.ff&&(this.ff=null)}Sd(){}qb(){this.ia.xa(Mc.a.EQe,bd.a.application,Object(ib.a)(this,this.jXj,"handleMarkAsRead"));this.ia.xa(Mc.a.R3a,
bd.a.application,Object(ib.a)(this,this.p_j,"handleShowHideChanges"));this.ia.pa(Mc.a.m0e,Zc.a.application,Object(ib.a)(this,this.RYj,"handleQueryShowHideChanges"),96);this.ia.pa(Mc.a.TAd,bd.a.application,Object(ib.a)(this,this.q_j,"handleShowRevisionTrackingWithUrlOverrides"),96)}jXj(z,Z,pa,Fa,Ma){if(1===pa)return this.Tb.Hi()?32:8;z=new Date;if(!Ma)throw Error.argumentNull("actionData is null");if(Ma.SlideNode){if(Ma=Object(w.a)(205,Ma.SlideNode))Qc.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",
Ma.slideIndex+1)),this.zS.Cgc?this.zS.Yld(Ma,!0):(Ma.CY=z,this.zS.f2e(Ma))}else this.FQe(z);return 32}FQe(z){const Z=this.sa.presentation;if(!Z)throw Error.argumentNull("Presentation is null");this.ff=vg.a.Zj("MarkActivitiesAsRead",1);Qc.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.zS.Cgc?this.zS.FQe():(sh.b(Z.slides||[],null,pa=>{if(pa=Object(w.a)(205,pa))pa.CY=z}),this.zS.rBh())}p_j(z,Z,pa,Fa,Ma){if(1===pa)return this.Tb.Hi()?32:8;const tb=this.Tb.Fn;
z=this.sa.Aa;if(!(tb&&z&&z.isConnected&&Ma))return 16;pa=Z=!1;switch(Ma.ShowRevisionTrackingStatus){case 0:pa=Z=!1;break;case 2:Z=!0;pa=!1;break;case 3:pa=Z=!0;break;case 1:Z=tb.QFa&&!this.zS.c5d?!0:!tb.QFa;pa=!0;break;default:return 8}if(this.zS.c5d&&!pa)return 32;Ma=Ma.InvokeSource;tb.QFa=Z;this.zS.c5d=Z&&pa;pa&&this.Qib.yDk(Ma,Z);Ma=z.yj();sh.b(Ma,null,Hb=>{this.djd.wrl(new oi(Hb,tb.QFa))});this.Hc.Gz(new Ql.a(1));return 32}RYj(z,Z,pa,Fa,Ma){z=this.Tb.Fn;if(!z)return 16;Ma.Rf(z.QFa);return 32}q_j(z,
Z,pa,Fa,Ma){z=this.sa.presentation;if(!Ma||!z||!z.slides)return 8;Ma=Ma.timestamp;if(!Ma)return 8;for(const tb of z.slides)Object(w.a)(205,tb).CY=Ma;this.zS.g2e(z.slides);return 32}}Object(k.a)(sg,"RevisionTrackingActor",null,[948,106]);class Ui{constructor(z){this.backgroundColor=this.foregroundColor=null;z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=z.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=z.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=
this.foregroundColor="#006BFF"}}Object(k.a)(Ui,"RevisionTrackingColorProvider",null,[]);class Vh{constructor(){this.ua=new Hk.a}Brl(z){this.ua.raiseEvent("SlideUSC",z)}AOc(z){this.ua.addHandler("SlideUSC",z)}E3e(z){this.ua.removeHandler("SlideUSC",z)}drl(z){this.ua.raiseEvent("ShapeUSC",z)}yAi(z){this.ua.addHandler("ShapeUSC",z)}tCl(z){this.ua.removeHandler("ShapeUSC",z)}wrl(z){this.ua.raiseEvent("ShowHideSC",z)}JAi(z){this.ua.addHandler("ShowHideSC",z)}ACl(z){this.ua.removeHandler("ShowHideSC",z)}}
Object(k.a)(Vh,"RevisionTrackingEventSource",null,[1051,1052,1053]);class qh extends Sys.EventArgs{constructor(z,Z){super();this.shape=z;this.slide=Z}}Object(k.a)(qh,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class ab{constructor(){this.cid=this.sid=0}}Object(k.a)(ab,"Slide",null,[]);class wl{constructor(z,Z){this.dt=this.mk=null;this.mk=Object.assign(new ab,{sid:z.sid,cid:z.cid});this.dt=Z}}Object(k.a)(wl,"SlideLastViewedVersion",null,[]);class Dn{constructor(){this.v=0;this.lv=this.defLv=
null;this.v=1}}Object(k.a)(Dn,"SlideLastViewedVersions",null,[]);class Zn extends Sys.EventArgs{constructor(z){super();this.slide=z}}Object(k.a)(Zn,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Bk{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd,t,aa,ra,Na){this.xgb=this.dgb=null;this.nSg=!1;this.tIe=null;this.Xfd=0;this.EIb=this.Flc=null;this.vMe=[];this.iid=null;this.Bjd=!1;this.Eza=null;this.kne=this.jne=this.c5d=!1;Qc.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");
this.KNe=z;this.sa=Z;this.zb=pa;this.nc=Fa;this.Tb=Ma;this.xd=tb;this.Zoc=Hb;this.Nc=rc;this.jh=yc;this.djd=ld;this.mbh=xc;this.Lb=t;this.$Uk=wd.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.sYg=wd.ipk;this.Gbh=!0;this.KI=!1;this.tKa=new Cf.a;this.Nc.xOc(Object(ib.a)(this,this.Tpa,"onSessionAccessTokenExpired"));H.AFrameworkApplication.WA&&this.Nc.DOc(Object(ib.a)(this,this.Qha,"onWopiTokenRefreshed"));this.Lb.Ue(()=>{this.jne=!0;this.initialize();this.rBh();this.jne=!1});this.Qib=aa;
this.yb=ra;this.lSk=Na}get Cgc(){return Pf.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.dgb&&(this.xd.wqa(Object(ib.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.xd.vvd(Object(ib.a)(this,this.hza,"onShapeViewElementAdded")),this.Zoc.j3e(Object(ib.a)(this,this.Hkb,"onMarkedUndo")),this.Nc.uvd(Object(ib.a)(this,this.DLa,"onBeforeSessionEnd")),this.Nc.F7(Object(ib.a)(this,this.GN,"onSessionClosed")),this.Nc.Wba(Object(ib.a)(this,this.mo,"onSessionRehydrated")),this.jh.ECl(Object(ib.a)(this,
this.Pph,"onSlideChangesDataChanged")),this.jh.eCl(Object(ib.a)(this,this.Noh,"onPresentationLastModifiedTimeReceived")),this.sYg&&this.mbh.tn(Object(ib.a)(this,this.Bph,"onShapePropertyChanged")),this.Nc.uEh(Object(ib.a)(this,this.Tpa,"onSessionAccessTokenExpired")))}initialize(){Qc.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.tIe=new Date;this.Xfd=this.tIe.getTime();this.yOl();this.xd.kU(Object(ib.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.xd.yvb(Object(ib.a)(this,
this.hza,"onShapeViewElementAdded"));this.Zoc.$2b(Object(ib.a)(this,this.Hkb,"onMarkedUndo"));this.Nc.dEa(Object(ib.a)(this,this.DLa,"onBeforeSessionEnd"));this.Nc.aC(Object(ib.a)(this,this.GN,"onSessionClosed"));this.Nc.bC(Object(ib.a)(this,this.mo,"onSessionRehydrated"));this.jh.PAi(Object(ib.a)(this,this.Pph,"onSlideChangesDataChanged"));this.jh.fAi(Object(ib.a)(this,this.Noh,"onPresentationLastModifiedTimeReceived"));this.sYg&&this.mbh.Ak(Object(ib.a)(this,this.Bph,"onShapePropertyChanged"));
this.Eza=this.sa.Aa;this.xgb=this.gzj();this.getSlideLastViewedVersions();const z=new ee.a(3,2,this.$Uk,()=>{this.getSlideLastViewedVersions()},90,"12");this.zb.Jb(z)}onActiveSlideDomReady(z,Z){z=Object(w.a)(205,Z.Aa);this.Eza&&z!==this.Eza&&this.R9e()&&(this.Eza.isConnected&&(this.Eza.isUnread&&this.Yld(this.Eza,!0),!this.Cgc&&this.Eza.changesData&&(this.Eza.CY=this.Eza.changesData.dtField)),z&&z.isUnread&&this.DBh(z));this.Eza=z;this.Xfd=Date.now()}Hkb(z,Z){Z.actionId!==Hd.a.gXa&&Z.iEb&&(z=this.sa.Aa)&&
z.isConnected&&z.isUnread&&this.R9e()&&this.Yld(z,!0)}DLa(){this.R9e()&&this.Egm();this.yGd()}GN(){this.Qib.log();this.KI=!0}mo(){this.KI=!1;this.Flc&&this.A1h(this.Flc)}A1h(z){var Z=this.sa.presentation;if(!Z)throw Error.argumentNull("Presentation is null");Z=Z.slides||[];0<Z.length&&(this.tkm(Z,z),this.g2e(Z))}F8k(z){this.kne=!0;Qc.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");z&&(this.tKa=new Cf.a,this.forEach(z.lv,Fa=>{const Ma=Fa.mk.sid;(!this.tKa.Ib(Ma)||this.tKa.ga(Ma).dt<Fa.dt)&&
this.tKa.$(Ma,Fa)}));const Z=vg.a.Ugc;let pa=!1;this.EIb&&this.KNe.hHg&&Z!==this.EIb&&(this.Flc&&W.c(this.ufg())===W.c(this.Flc)||(pa=!0));z&&z.defLv&&(this.xgb=z.defLv,this.Gbh=!1,z.lv&&0<z.lv.length&&this.A1h(z));pa&&this.yGd();this.EIb=vg.a.Ugc;this.kne=!1}Pph(z,Z){this.forEach(Z.slides,pa=>{this.vue(pa.changesData)||(this.sa.Aa&&pa.Fb!==this.sa.Aa.Fb||this.X1j(Object(w.a)(205,pa)))&&this.f2e(Object(w.a)(205,pa))})}Noh(z,Z){this.Gbh&&(this.xgb=Z.ykl)}Bph(z,Z){z=Z.property;Z=Object(w.a)(4,Z.node);
z===Md.a.WPb&&(z=this.nc.ug(Z),z===this.sa.Aa&&z.isUnread&&Z.changesData.dtField<=z.changesData.dtField&&(Qc.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.Xfd),this.e2e(this.sa.Aa,Z)))}hza(z,Z){z=Z.Vx.shapeNode;this.sa.Aa.isUnread&&this.eIa(this.sa.Aa.Fb,z)&&!this.vue(z.changesData)&&(this.vMe.push(z),this.iid||(this.iid=new ee.a(2,1,0,Object(ib.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),
90,"13"),this.zb.Jb(this.iid)))}getSlideLastViewedVersions(){this.KI||this.Bjd||this.KNe.getSlideLastViewedVersionInfo(Object(ib.a)(this,this.F8k,"onReceiveLastViewedVersionInfo"))}yGd(){if(!this.KI&&!this.Bjd){var z=this.ufg();this.KNe.putSlideLastViewedVersionInfo(z);this.Flc=z}}ufg(){const z=this.sa.presentation;if(!z)throw Error.argumentNull("Presentation is null");const Z=Object.assign(new Dn,{defLv:this.xgb}),pa=[];this.forEach(z.slides||[],Fa=>{Fa=Fa.Fb;const Ma=this.Tb.Qk(Fa);Ma&&Ma.CY&&(!Fa.cid&&
this.tKa.Ib(Fa.sid)?Fa=Aj.a.Aq(Fa.sid,this.tKa.ga(Fa.sid).mk.cid):Fa.cid&&this.tKa.Ib(Fa.sid)&&Fa.cid!==this.tKa.ga(Fa.sid).mk.cid&&Qc.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",Fa.sid,this.tKa.ga(Fa.sid),Fa.cid),pa.push(new wl(Fa,Ma.CY)))});Z.lv=pa;return Z}tkm(z,Z){const pa=Z.lv;this.forEach(z,Fa=>{const Ma=Object(w.a)(205,Fa);this.forEach(pa,tb=>{Ma&&this.JFi(Ma,tb.mk)&&(!Ma.CY||Ma.CY<tb.dt)&&(Ma.CY=tb.dt)})})}JFi(z,Z){return z.cid&&Z.cid?z.sid===
Z.sid&&z.cid===Z.cid:z.sid===Z.sid}g2e(z){this.forEach(z,Z=>{this.f2e(Object(w.a)(205,Z))})}rBh(){var z=this.sa.presentation;if(!z)throw Error.argumentNull("Presentation is null");z=z.slides||[];0<z.length&&this.g2e(z)}DBh(z){this.w5h(z,Z=>{this.e2e(z,Z)})}f2e(z){if(z&&z.isConnected&&z.changesData){const Z=this.p6c(z.changesData,this.H0c(z));Z!==z.isUnread&&(this.pgh(z,Z),this.tem(),z===this.sa.Aa&&this.DBh(z))}}e2e(z,Z){if(Z&&Z.isConnected&&Z.Qa(Md.a.WPb)){const pa=this.p6c(Z.changesData,this.H0c(z));
this.ngh(z,Z,pa)}}ngh(z,Z,pa){pa!==Z.isUnread&&(Qc.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",Z.isUnread,pa),Z.isUnread=pa,this.djd.drl(new qh(Z,z)))}pgh(z,Z){Z!==z.isUnread&&(Qc.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",z.isUnread,Z,z.Fb.toString()),z.isUnread=Z,this.djd.Brl(new Zn(z)))}Yld(z,Z){if(this.Cgc){if(!z)throw Error.argumentNull("ISlideNode is null");this.skm(z);Qc.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",
z.Fb.toString(),z.isUnread,Z);if(!z.isUnread)return!1}this.w5h(z,pa=>{this.ngh(z,pa,!1)});this.pgh(z,!1);this.Cgc&&Z&&this.yGd();return!0}FQe(){const z=this.sa.presentation;if(!z)throw Error.argumentNull("Presentation is null");let Z=!1;this.forEach(z.slides,pa=>{pa=this.Yld(Object(w.a)(205,pa),!1);Z||(Z=pa)});Qc.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",Z);Z&&this.yGd()}w5h(z,Z){z&&(z=z.yj(),this.forEach(z,pa=>{Z(pa)}))}forEach(z,Z){sh.b(z,null,Z)}vue(z){return gl(z,
this.dgb)}p6c(z,Z){return!!z&&!!z.dtField&&!this.vue(z)&&z.dtField>Z}gzj(){const z=this.Tb.Fn;if(z&&z.bZe)return z.bZe;Qc.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}yAg(z){const Z=Object(w.a)(205,this.lSk.Eog(z));return Z&&Z.isUnread&&z&&this.p6c(z.changesData,this.H0c(Z))}yOl(){this.dgb=new vl(this.Lb.Ea("UserName"),this.Lb.Ea("387"),this.Lb.Ea("388"))}skm(z){z.CY=z&&z.changesData?z.changesData.dtField:this.xgb}Egm(){const z=this.sa.Aa;z&&(z.CY=z.changesData?
z.changesData.dtField:this.xgb)}H0c(z){return z.CY||this.xgb}tem(){this.nSg||(this.nSg=!0,Qc.a.J(512262741,804,50,"First revision tracking view render completed!"))}X1j(z){return z.isConnected&&z.changesData&&z.changesData.dtField?z.changesData.dtField<=this.tIe&&this.p6c(z.changesData,this.H0c(z)):!1}eIa(z,Z){return z.equals(Z.slideId)}tryHighlightInsertedShapes(){Qc.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-
this.Xfd);this.iid=null;const z=this.sa.Aa;if(z&&z.isUnread){const Z=z.Fb;for(const pa of this.vMe)this.eIa(Z,pa)&&this.e2e(z,pa)}Array.clear(this.vMe)}Tpa(){this.Bjd=!0}Qha(z,Z){try{Z.o9c?(Qc.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),this.Bjd=!1):Qc.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(pa){Qc.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",pa)}}R9e(){return 1!==
this.yb.$i}}Object(k.a)(Bk,"RevisionTrackingManager",null,[]);class Gg{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld){this.sa=z;this.Tb=Z;this.HNe=pa;this.xd=Fa;this.q2=Ma;this.Ga=tb;this.sbd=Hb;this.wjb=rc;this.gf=yc;this.CJa=xc;this.sLk=ld;this.B1g=!1;this.xd.Avb(Object(ib.a)(this,this.Yqh,"onVisibleThumbnailRangeChanged"));this.xd.BOc(Object(ib.a)(this,this.jza,"onThumbnailRefresh"));this.xd.CAi(Object(ib.a)(this,this.Aph,"onShapePresenceStateChanged"));this.xd.bBi(Object(ib.a)(this,this.Fqh,"onThumbnailPresenceStateChanged"));
this.xd.Hzi(Object(ib.a)(this,this.W9k,"onShapeViewElementShowRevisionTrackingHint"));this.xd.Ezi(Object(ib.a)(this,this.P9k,"onShapeViewElementHideRevisionTrackingHint"));this.q2.AOc(Object(ib.a)(this,this.NLa,"onSlideUnreadStateChanged"));this.q2.yAi(Object(ib.a)(this,this.Gph,"onShapeUnreadStateChanged"));this.q2.JAi(Object(ib.a)(this,this.Kph,"onShowHideStateChanged"))}dispose(){this.xd.DEh(Object(ib.a)(this,this.Yqh,"onVisibleThumbnailRangeChanged"));this.xd.G3e(Object(ib.a)(this,this.jza,"onThumbnailRefresh"));
this.xd.wCl(Object(ib.a)(this,this.Aph,"onShapePresenceStateChanged"));this.xd.MCl(Object(ib.a)(this,this.Fqh,"onThumbnailPresenceStateChanged"));this.q2.E3e(Object(ib.a)(this,this.NLa,"onSlideUnreadStateChanged"));this.q2.tCl(Object(ib.a)(this,this.Gph,"onShapeUnreadStateChanged"));this.q2.ACl(Object(ib.a)(this,this.Kph,"onShowHideStateChanged"))}Yqh(){const z=this.sa.presentation;if(!z)throw Error.argumentNull("Presentation is null");sh.b(z.slides||[],null,Z=>{(Z=this.Tb.Qk(Z.Fb))&&Z.isUnread&&
this.taf(Z)})}jza(z,Z){z=this.Tb.Qk(Z.lYh);z.isUnread&&this.taf(z)}NLa(z,Z){z=Z.slide;z.isUnread?this.taf(z):this.cAl(z)}Gph(z,Z){z=Z.shape;Z=Z.slide;z&&(z.isUnread?Z===this.sa.Aa&&this.paf(z):this.b3e(z))}Aph(z,Z){z=Z.shape;z.Bt?this.b3e(z):z.isUnread&&this.paf(z,!0)}Fqh(z,Z){z=Z.slide;z.Bt&&!this.q$e?this.jAl(z):z.isUnread&&this.S1l(z)}Kph(z,Z){z=Z.shape;Z.QFa&&z.isUnread?this.paf(z):this.b3e(z)}get q$e(){return this.sLk}taf(z){z&&z.isConnected&&this.uFd(z,Z=>{Z.hSh();z.Bt&&!this.q$e||this.LKf(Z)})}cAl(z){z&&
z.isConnected&&this.uFd(z,Z=>{Z.pDh();Z.Y2e()})}S1l(z){z.Bt&&!this.q$e||this.uFd(z,Object(ib.a)(this,this.LKf,"addRevisionTrackingPawnForThumbnail"))}jAl(z){this.uFd(z,Z=>{Z.Y2e()})}xQh(){const z=this.Tb.Fn;return!this.CJa||this.CJa&&z.QFa}paf(z,Z=!1){this.xQh()&&!z.Bt&&z.Qa(Md.a.WPb)&&(Object(w.a)(178,z.sc(this.gf))?(this.HNe.$J(z).display(()=>this.Ga.H1c(z)),this.Wdm(),Qc.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",Z)):Qc.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}b3e(z){const Z=
this.HNe.dK(z);Z?Z.dismiss():this.xQh()&&z.isUnread&&Qc.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}uFd(z,Z){z&&((z=Object(w.a)(1050,z.vg(this.wjb)))?Z(z):Qc.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}LKf(z){z.qZd(this.sbd.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}W9k(z,Z){this.I3h(Z.Vx.shapeNode,!0)}P9k(z,Z){this.I3h(Z.Vx.shapeNode,
!1)}I3h(z,Z){(z=this.HNe.dK(z))&&(Z?z.Q3a():z.Efa())}Wdm(){this.B1g||(this.B1g=!0,he.c(oa.a.EQi))}}Object(k.a)(Gg,"RevisionTrackingPresenter",null,[]);class Ik{v1f(){const z=new dj.a;z.Mh(10,10);z.Yqa("0 0 10 10");z.va.setAttribute("class","ModernRevisionTrackingIconSVG");const Z=new Tj.a;Z.h_("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");Z.va.setAttribute("class","ModernRevisionTrackingIconPath");z.appendChild(Z);return z.va}}Object(k.a)(Ik,"RevisionTrackingSVGProvider",null,[999]);class qn{constructor(){this.ejd=
this.Rkd=this.Qkd=this.JLe=0}jEk(){this.Rkd+=1}yDk(z,Z){switch(z){case 2:Z&&(this.Qkd+=1);break;case 0:Z?(this.ejd+=1,Qc.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Qc.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:Z&&(this.JLe+=1)}}log(){Qc.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",
this.JLe,this.Qkd,this.Rkd,this.ejd);0<this.Qkd+this.Rkd+this.ejd&&he.c(oa.a.uVf)}}Object(k.a)(qn,"RevisionTrackingTelemetry",null,[]);var rn=d(1328),gn=d(1204),Wk=d(78),hl=d(588);class Cm{constructor(z,Z,pa,Fa,Ma){this.agb=null;this.sKa=z;this.Qib=Z;this.qc=Ma;this.Yb=pa;this.oa=Fa;this.sKa.t9(Object(ib.a)(this,this.LZ,"onInteractivityChanged"))}dispose(){this.sKa&&this.sKa.dispose();this.agb=this.sKa=null}display(z,Z){this.agb||(this.agb=new hl.a);this.agb.color=z;this.agb.userName=Z;this.sKa.$B(this.agb)}dismiss(){this.sKa.qQ(this.agb.clientId)}Q3a(){this.sKa.LNa()}Efa(){this.sKa.PNa()}get o1d(){const z=
this.sKa.NNb;return 0<z.length?z[0]:null}LZ(z,Z){z={InvokeSource:2,ShowRevisionTrackingStatus:null};1===Z.type?(this.Yb.Aa!==this.qc?(this.qc&&(this.Yb.Aa=this.qc,this.oa.Pu()),z.ShowRevisionTrackingStatus=3):z.ShowRevisionTrackingStatus=1,H.AFrameworkApplication.Pa.Ia(Mc.a.R3a,2,z)):2===Z.type?this.qc&&this.Yb.Aa===this.qc&&(z.ShowRevisionTrackingStatus=2,H.AFrameworkApplication.Pa.Ia(Mc.a.R3a,2,z),this.Qib.jEk()):3===Z.type&&this.qc&&this.Yb.Aa===this.qc&&(z.ShowRevisionTrackingStatus=0,H.AFrameworkApplication.Pa.Ia(Mc.a.R3a,
2,z))}}Object(k.a)(Cm,"ThumbnailRevisionTrackingPawn",null,[1061,106]);d(299);class Ao{constructor(z,Z,pa,Fa,Ma,tb){this.Ye=z;z=Wk.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");Z=Z.Ok("pegal.png");pa=pa.v1f();this.cQk=this.N7i(H.AFrameworkApplication.isRtl,z,Z,pa);this.Qib=Fa;this.Yb=Ma;this.oa=tb}y5i(z,Z){return new Cm(this.cQk.J6b(z),this.Qib,this.Yb,this.oa,Z)}Rc(z){return this.Ye.Rc(z)}N7i(z,Z,pa,Fa){const Ma=new rn.a;Ma.add(1,Z);Ma.add(4,pa);Ma.add(6,16);Ma.add(8,z);Ma.add(12,
2);Ma.add(11,!1);Ma.add(14,Fa);return new gn.a(Ma)}}Object(k.a)(Ao,"RevisionTrackingThumbnailGadgetsFactory",null,[998]);class Sf{constructor(z,Z,pa){this.xJa=this.voa=!0;this.Ms=z;this.Tga=Z;this.ka=pa}get hHg(){return this.voa}getSlideLastViewedVersionInfo(z){if(this.xJa){Qc.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var Z=this.ka.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
"getPPTSlideLastViewedMetadata",H.AFrameworkApplication.mh),pa={};pa["X-StatelessPopsAffinityRoutingEnabled"]=this.ka.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ms.Tj(Z,1,null,pa,!1,2,Object(ib.a)(this,this.X5k,"onGetVersionInfoSucceeded"),Object(ib.a)(this,this.W5k,"onGetVersionInfoFailed"),z,void 0,void 0,void 0,void 0,lh.a("12"));this.xJa=!1}else Qc.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(z){if(this.voa){Qc.a.J(25203106,
824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var Z=W.c(z),pa=this.ka.pptRevisionTrackingMaxRoamingDataSizeInBytes;if(Z.length>pa)Qc.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",z.lv.length,Z.length,pa);else{pa=this.ka.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",H.AFrameworkApplication.mh);
if(H.AFrameworkApplication.fa.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled"))this.Ms.Mqa(pa,Z);else{const Fa={};Fa["X-StatelessPopsAffinityRoutingEnabled"]=this.ka.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ms.Tj(pa,2,Z,Fa,!1,2,Object(ib.a)(this,this.x8k,"onPutVersionInfoSucceeded"),Object(ib.a)(this,this.w8k,"onPutVersionInfoFailed"),z.lv.length,void 0,void 0,void 0,void 0,lh.a("13"))}this.voa=!1}}else Qc.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}X5k(z){this.xJa=
!0;let Z=0;try{let pa=null;z.data.Ud&&0<z.data.Ud.trim().length&&(Z=z.data.Ud.length,pa=JSON.parse(z.data.Ud,Object(ib.a)(this,this.luk,"jsonDateReviver")));const Fa=z.data.state;Fa(pa)}catch(pa){Qc.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",pa.toString())}z=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",Z,JSON.stringify(z.data.cF),JSON.stringify(z.data.Et),JSON.stringify(z.data.au));Qc.a.J(25203139,824,
50,z)}W5k(z){this.xJa=!0;z=this.Tga.n$(z);Qc.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",z)}x8k(z){this.voa=!0;Qc.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.au-+z.data.cF,+z.data.Et-+z.data.cF)}w8k(z){this.voa=!0;const Z=this.Tga.n$(z);Qc.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",Z,z.data.state)}luk(z,Z){return"dt"===z||"defLv"===z?new Date(Z):Z}}Object(k.a)(Sf,"RoamingCacheProxy",
null,[997,106]);var En=d(1005),J=d(120);class X{constructor(z,Z,pa){this.Og=z;this.PK=Object(w.a)(En.a,this.Og.OOh);this.sbd=Z;this.PSk=pa;this.Og.wDg=!0}display(z){let Z;Z=this.PSk.v1f();this.PK.Qvi(this.sbd.backgroundColor,z,Z);this.Og.iUb(this.sbd.foregroundColor);this.Og.setVisibility()}dismiss(){this.PK.clear();this.Og.iUb(J.a.none);this.Og.setVisibility()}Cn(z){this.Og.Cn(z)}wE(z){this.Og.wE(z)}Jq(){return this.Og.Jq()}aP(z){return this.Og.EDb(z)}Ry(z){this.Og.Ry(z)}dispose(){this.Og.dispose()}Xz(){this.Og.Xz()}jF(z){return this.Og.jF(z)}bD(z){return this.Og.bD(z)}draw(z,
Z){this.Og.draw(z,Z)}get visible(){return this.Og.visible}set visible(z){this.Og.visible=z}setPosition(z,Z){this.Og.setPosition(z,Z)}Pj(z){this.Og.Pj(z)}Kr(z){this.Og.Kr(z)}Tv(z){this.Og.Tv(z)}setZIndex(z){this.Og.setZIndex(z)}TF(z,Z){this.Og.TF(z,Z)}Q3a(){this.PK.Q3a()}Efa(){this.PK.Efa()}setSelection(){}}Object(k.a)(X,"ShapeRevisionTrackingView",null,[1037,805,806,106]);class Ia{constructor(){this.K=null;this.CJa=this.fIb=this.LP=this.v6=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}fc(z){this.K=
z;z.resolve("Common.IAppSettingsManager").Ue(()=>{this.LP=z.resolve("PowerPointWebEditor.IApplicationContext").td.Mg;this.fIb=z.resolve("PowerPointWebEditor.IApplicationContext").td.Qnk;this.v6=z.resolve("PowerPointWebEditor.IApplicationContext").td.Hxe;this.CJa=z.resolve("PowerPointWebEditor.IApplicationContext").td.Ewe;this.register();this.resolve()})}dispose(){this.v6&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const z=this.K;this.LP&&this.fIb&&z.register(Ak.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Ak.a(H.AFrameworkApplication.Me,z.resolve("PowerPointWebEditor.ISessionInfoOwner"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),z.resolve("PowerPointWebEditor.IErrorHandler"),z.resolve("Common.ITaskManager"),z.resolve("Common.IAppSettingsManager")));
this.v6&&(z.register(qn,"RevisionTrackingTelemetry").ma().na(()=>new qn),z.register(Bk,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().na(()=>new Bk(z.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("Common.ITaskManager"),z.resolve("PowerPointWebEditor.ISlideReader"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),z.resolve("Box4.Graph.IGraphInstance").Cd(10),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),z.resolve("PowerPointWebEditor.IApplicationSettings"),z.resolve("Common.IAppSettingsManager"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.View.IPPTPageView"),z.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),
z.register(Gg,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().na(()=>new Gg(z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),z.resolve("PowerPointWebEditor.IShapeReader"),
z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,z.resolve("Box4.IPageView").Na,z.resolve("PowerPointWebEditor.IApplicationSettings").Ewe,z.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PPTCanvasPresenceBubbleUXEnabled"))),z.register(997,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().na(()=>new Sf(H.AFrameworkApplication.Me,z.resolve("PowerPointWebEditor.IJsonpHelperManager"),
z.resolve("PowerPointWebEditor.IApplicationSettings"))),z.register(998,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().na(()=>new Ao(z.resolve("PowerPoint.IBrowserHelperManager"),z.resolve("PowerPoint.IPathManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),z.resolve("PowerPointWebEditor.IPptSelectionManager"))),z.register(Vh,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().na(()=>
new Vh),z.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().na(()=>new uj.a((Z,pa)=>{let Fa=null;const Ma=Object(w.a)(178,Z.sc(z.resolve("Box4.IPageView").Na));Ma&&!Ma.hm&&(Z=z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").s8d(z.resolve("PowerPointWebEditor.IPptSelectionManager"),(tb,Hb,rc)=>z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").F6i(tb,Hb,rc,z.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
Z,pa,Ma.oW),Fa=new X(Z,z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),Fa.Cn(Ma.oW),Ma.vta(Fa,1),Fa.visible=Ma.KR||Ma.Oo);return Fa})),z.register(Ui,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().na(()=>new Ui(z.resolve("Common.Utils.IHighContrastDetector"))),z.register(999,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().na(()=>new Ik),
this.LP&&this.CJa&&z.register(sg,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().na(()=>new sg(z.resolve("Common.IActionManagerExtended"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.View.IViewEventSource"),z.resolve("RevisionTrackingTelemetry"))))}resolve(){this.LP&&
this.fIb&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.v6&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.CJa)){const z=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");z.qb();z.Sd()}}static main(){Qa.a.instance.Ac(gf.a(new Ia,0))}}Object(k.a)(Ia,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var fb=d(416),Ab=d(218),ec=d(132);class Uc{constructor(z){this.XRa=[Hd.a.aAc,Hd.a.bAc,Hd.a.cAc,Hd.a.dAc,Hd.a.eAc];this.$qf=z}wig(z){return this.$qf?this.$qf.D_c(z.Ua):null}create(z){return z?(z=this.S6b(z))?ec.m(z):"":""}T2i(z){z=z.suggestions;if(!z||!z.count)return null;z=({w4f:Z}=this.v7i(z)).returnValue;var Z=Uc.W3i(Z);const pa=Object.assign(new fb.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:Wk.getImageClassWithCluster(H.AFrameworkApplication.dP,Uc.Obj),Image16by16:H.AFrameworkApplication.Mm,Menu:Object.assign(new Me.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});z&&Array.add(pa.Menu.MenuSectionList,z);Array.add(pa.Menu.MenuSectionList,Z);return pa}v7i(z){let Z;const pa=Object.assign(new Bg.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
Z=null;for(let Fa=0,Ma=Math.min(this.XRa.length,z.count);Fa<Ma;++Fa){if(!Z&&""===z.ga(Fa).suggestion){Z=this.XRa[Fa].toString();continue}const tb=Object.assign(new Ab.a,{ExternalId:"btnDictationCorrectionSuggestion"+Fa,Command:this.XRa[Fa].toString(),LabelText:z.ga(Fa).suggestion});Array.add(pa.ControlList,tb)}return pa.ControlList.length?{returnValue:pa,w4f:Z}:{returnValue:null,w4f:Z}}S6b(z){if(z=this.T2i(z)){const Z=Object.assign(new Bg.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(Z.ControlList,z);return Z}return null}static W3i(z){const Z=Object.assign(new Bg.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),pa=Object.assign(new Ab.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(Z.ControlList,pa);z&&(z=Object.assign(new Ab.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:z,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(Z.ControlList,z));return Z}}Uc.Obj="Insertaudio_16x16x32";Object(k.a)(Uc,"DictationCorrectionContextMenuManager",null,[1036]);var Ad=d(449);class Ce{constructor(z,Z){this.QEc=null;this.Cs=z;this.$_=Z}get key(){return"DICTATIONCORRECTION"}get J9(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(z){this.Cs.ke(z.node)?this.QEc=z.node:this.QEc=null}qBc(z){let Z;Z=null;if(!this.QEc)return{returnValue:!1,
NDa:Z};z=this.$_.Gzj(this.QEc,z);if(!z)return{returnValue:!1,NDa:Z};Z=Object.assign(new Ad.a,{T2:this.key,nR:z,description:this.Hge()});return{returnValue:!0,NDa:Z}}Hge(){return H.AFrameworkApplication.fa&&H.AFrameworkApplication.fa.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(k.a)(Ce,"DictationCorrectionDetailsProvider",null,[1062,1063]);var ye=d(624),hf=d(136);class Gf{constructor(z,Z,pa=-1){this.TriggerType="click";
this.TreatedInUX="true";this.PhraseId=z.Mfl;this.CorrectionId=z.id;switch(Z){case 0:this.EditType="alternate";this.AlternateId=pa;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(k.a)(Gf,"CorrectionEvent",null,[]);class Kg{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(k.a)(Kg,"CorrectionTelemetry",null,[]);class Lg{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(k.a)(Lg,"CorrectionsSessionTelemetry",null,[]);class se{constructor(){this.OT=!1;this.cHd=this.WPd=0}start(){this.OT||(this.OT=!0,this.WPd=this.getTime())}stop(){this.OT&&(this.cHd+=this.getTime()-this.WPd,this.OT=!1)}get Qr(){return this.cHd+(this.OT?this.getTime()-this.WPd:0)}getTime(){return(new Date).getTime()}}Object(k.a)(se,"DictationCorrectionsSessionTimer",null,[]);class xi{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(k.a)(xi,"SessionInfo",null,[]);class gi{constructor(){this.FinalText="";this.PhraseIds=null}}Object(k.a)(gi,"TextInfo",null,[]);var jf=d(182);class th{constructor(z){this.MAf=this.FRd=this.GRd=0;this.S9h="Office.Voice.Online.DictationCorrectionsSession";this.z8a=null;this.cub=Object.assign(new xi,{TextInfo:[new gi]});this.Gtf=z}startSession(){this.z8a||(this.cub.StartTime=(new Date).toISOString(),this.z8a=new se);
this.z8a.start()}pauseSession(){this.z8a.stop()}endSession(){this.z8a.stop();var z=new jf.a;z.name=this.S9h;z.samplingPolicy=2;z.durationMs=this.z8a.Qr;z.dataFields=[];Array.add(z.dataFields,Object.assign(new Ye.a,{name:"CorrectionSessionId",string:this.pAa}));Array.add(z.dataFields,Object.assign(new Ye.a,{name:"StartTime",string:this.cub.StartTime}));Array.add(z.dataFields,Object.assign(new Ye.a,{name:"NumberOfCorrectionsMarked",int64:this.GRd}));Array.add(z.dataFields,Object.assign(new Ye.a,{name:"NumberOfCorrectionsMade",
int64:this.FRd}));Array.add(z.dataFields,Object.assign(new Ye.a,{name:"NumberOfCorrectionsDismissed",int64:this.MAf}));hf.a.sendActivityEvent(z);if(Eb.App.N0&&0<Eb.App.N0.puh.length){this.cub.AlternateEditCount=this.FRd;this.cub.Duration=Math.floor(this.z8a.Qr/1E3);this.cub.TextInfo[0].PhraseIds=Eb.App.N0.puh;var Z=new Lg;Z.ClientSessionId=this.pAa;Z.SessionInfo=this.cub;if(z=this.Gtf())Z=W.c(Z),z.OJg(Z)}}x4k(z){this.GRd+=z}mmh(z,Z,pa=-1){0===Z?this.FRd++:1===Z&&this.MAf++;var Fa=new Kg;Fa.ClientSessionId=
this.pAa;Fa.CorrectionEvents=[new Gf(z,Z,pa)];if(z=this.Gtf())Fa=W.c(Fa),z.OJg(Fa)}get pAa(){return Eb.App.N0?Eb.App.N0.pAa:""}}Object(k.a)(th,"DictationCorrectionsTelemetry",null,[]);var Fn=d(43),Jj=d(42);class yi{constructor(z,Z,pa){this.IO=z;this.Pb=Z;this.XH=pa}}Object(k.a)(yi,"DictationCorrectionRange",null,[]);var dk=d(365);class lo{constructor(z,Z,pa){this.bU=this.Or=null;this.urb=z;this.dCa=Z;this.GJc=new dk.a(new ye.a);this.IEc=pa;this.NMa()}xte(z){this.dCa.sFa&&Ng.ParagraphReader.ke(z)&&
this.GJc.contains(z.id)&&this.urb.xte(z)}d5l(){this.dCa.sFa=!0;this.Or=new th(()=>this.bU);this.Or.startSession()}V5l(){this.dCa.sFa=!1;var z=Eb.App.Ob.ie.yo.Zg;if(z){z=z.Zh;for(const Z of this.GJc){const pa=z.Ie(Z);pa&&Ng.ParagraphReader.ke(pa)&&this.urb.STi(pa)}}this.IEc.clear();this.GJc.clear();this.Or.endSession()}SGl(z){if(this.dCa.sFa){var Z=z.ra(Jj.a.v$d,null);if(!Pg.a.Ta(Z)){var pa=new Ta.a,Fa=Math.min(Z.length,z.Sa.length);for(let Ma=0;Ma<Fa;Ma++){const tb=this.IEc.Xxj(Z[Ma]);if(tb){const Hb=
z.Sa.ga(Ma).cp;pa.add(new yi(Hb,Hb+tb.source.length,tb))}}this.urb.PVk(z,pa)}}}khf(z,Z){if(!Z)return!1;if(!this.dCa.sFa||!z)return Z.add(null),!1;Z.add(z.tw?z.tw.XH.key:null);return!!z.tw}XJl(z,Z){this.dCa.sFa&&Z&&Ea.AT(Z,pa=>!!pa)?z.He(Jj.a.v$d,Z.toArray()):z.removeProperty(Jj.a.v$d)}YBh(z){this.bU=z}NMa(){this.urb.Hxi(Object(ib.a)(this,this.u4k,"onDictationCorrectionMarkerAdded"));Sc.a.addHandler(window.self,ob.a.blur,()=>{this.Or&&this.dCa.sFa&&this.Or.pauseSession()});Sc.a.addHandler(window.self,
ob.a.focus,()=>{this.Or&&this.dCa.sFa&&this.Or.startSession()});this.urb.Ixi(Object(ib.a)(this,this.v4k,"onDictationCorrectionMarkerRemoved"))}v4k(z,Z){this.IEc.Yyl(Z.Z_f)}u4k(z,Z){this.GJc.add(Z.Mcl);this.Or&&this.Or.x4k(Z.tWk);this.IEc.Lti(Z.Z_f)}t4k(z,Z){this.Or&&this.Or.mmh(z,0,Z)}w4k(z){this.Or&&this.Or.mmh(z,1)}Gzj(z,Z){if(!this.dCa.sFa)return null;z=Ih.a.rk(z,Z);return this.urb.D_c(z)}}Object(k.a)(lo,"DictationCorrectionManager",null,[1035]);class sn extends Sys.EventArgs{constructor(z,Z){super();
this.Mcl=z;this.tWk=Z?Z.count:0;this.Z_f=Z}}Object(k.a)(sn,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Ze{constructor(z,Z,pa,Fa,Ma){this.fli=z;this._id=Z;this.Lbi=Fa;this.y1b=Ma;this.Ju=pa;this.jZb=String.format("{0}_{1}",z,Z)}get Mfl(){return this.fli}get id(){return this._id}get source(){return this.Ju}get confidence(){return this.Lbi}get suggestions(){return this.y1b}get key(){return this.jZb}CXk(z){this.suggestions.addRange(z.suggestions)}}Object(k.a)(Ze,"DictationCorrectionDetails",
null,[]);class Jk{constructor(z,Z,pa){this.Xo=z;this.kci=Z;this.iki=pa}get XH(){return this.kci}get inh(){return this.iki}get Qe(){return this.Xo}le(z){return new Jk(z||this.Qe,this.XH,this.inh)}}Object(k.a)(Jk,"DictationCorrectionObject",null,[429]);class Wg{constructor(z,Z){this.source=z;this.suggestion=Z}}Object(k.a)(Wg,"DictationCorrectionSuggestion",null,[]);class tg{constructor(z){this.Ch=z;this.Ma=new Hk.a}Hxi(z){this.Ma.addHandler("ADCM",z)}Ixi(z){this.Ma.addHandler("RDCM",z)}PVk(z,Z){this.ZVk(z,
Z)}ZVk(z,Z){if(z&&Z&&Z.count&&(Z=tg.Smm(z,Z))&&Z.count){this.dUi(z,Z);var pa=new Ta.a;for(var Fa of Z)pa.add(Fa.IO),pa.add(Fa.Pb);z.Bbe(pa);for(const Ma of Z)Fa=z.Sa.TU(Ma.IO),Fa.tw=new Jk(Fa,Ma.XH,Object(ib.a)(this,this.RXj,"handleParagraphSplit")),Fa.isFromErrorRangeSplit=!0,Fa=z.Sa.TU(Ma.Pb),Fa.isDictationCorrectionEnd=!0,Fa.isFromErrorRangeSplit=!0;0<Z.count&&this.Ma.raiseEvent("ADCM",new sn(z.id,Z))}}vig(z){const Z=new Ta.a;if(z){let pa=null,Fa=-1;for(let Ma=0;Ma<z.Sa.length;Ma++){const tb=z.Sa.ga(Ma);
tb.tw?(Fa=tb.cp,pa=tb.tw.XH):tb.isDictationCorrectionEnd&&(pa?Z.add(new yi(Fa,tb.cp,pa)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),pa=null)}}return Z}Gvc(z,Z){if(z&&Z&&Z.count){for(const pa of Z){let Fa=z.Sa.TU(pa.IO);Fa&&(Fa.tw=null);if(Fa=z.Sa.TU(pa.Pb))Fa.isDictationCorrectionEnd=!1}this.Ma.raiseEvent("RDCM",new sn(z.id,Z))}}STi(z){if(z)for(let Z=0;Z<z.Sa.length;Z++){const pa=z.Sa.ga(Z);pa.tw&&(pa.tw=null);pa.isDictationCorrectionEnd&&(pa.isDictationCorrectionEnd=
!1)}}D_c(z){if(!z||!Fn.SelectionEditor.Tk(z)&&!Fn.SelectionEditor.nh(z))return null;const Z=z.node,pa=z.Ra;z=z.Pb;let Fa=0,Ma=null;for(let tb=0;tb<Z.Sa.length;tb++){const Hb=Z.Sa.ga(tb);if(Hb.tw&&pa>=Hb.cp)Ma=Hb.tw,Fa=Hb.cp;else if(Ma&&Hb.isDictationCorrectionEnd){if(z<=Hb.cp)return new yi(Fa,Hb.cp,Ma.XH);Ma=null}}return null}Tmm(z,Z,pa){if(!z)return!1;z=Ng.ParagraphReader.text(z);return tg.V4h(z,Z.source,pa)}xte(z){if(z){var Z=this.vig(z);if(Z&&0<Z.count){const pa=new Ta.a,Fa=Ng.ParagraphReader.text(z);
for(const Ma of Z)tg.U4h(Fa,Ma)||pa.add(Ma);this.Gvc(z,pa)}}}dUi(z,Z){Z.ga(0);Z.ga(Z.count-1);const pa=this.vig(z);let Fa=0,Ma=0;const tb=new Ta.a;for(;Ma<Z.count&&Fa<pa.count;){const Hb=Z.ga(Ma),rc=pa.ga(Fa);Hb.Pb<rc.IO?Ma++:(rc.Pb>Hb.IO&&tb.add(rc),Fa++)}this.Gvc(z,tb)}RXj(z,Z){const pa=Z.Qe;for(var Fa=z.Sa.mBb(pa.cp)+1;Fa<z.Sa.length;Fa++){const Ma=z.Sa.ga(Fa);if(Ma.isDictationCorrectionEnd){let tb;this.Gvc(z,(tb=new Ta.a,tb.add(new yi(pa.cp,Ma.cp,Z.XH)),tb));break}}}t$k(z,Z){(z=Eb.App.Ob.ie.yo.Zg)&&
(Z=z.Zh.Ie(Fg.a.Tf(Z.nodeId)))&&Ng.ParagraphReader.ke(Z)&&this.Zyl(Z)}Zyl(z){if(z){var Z=0,pa=!1,Fa=!1,Ma=new Ta.a;for(let tb=0;tb<z.Sa.length;tb++){const Hb=z.Sa.ga(tb);Hb.tw&&(Z=tb,pa=!0);pa&&(Hb.Bq||Hb.VM)&&(Fa=!0);Hb.isDictationCorrectionEnd&&pa&&(pa=!1,Fa&&(Fa=z.Sa.ga(Z),Fa.tw&&Fa.tw.XH&&Ma.add(new yi(Fa.cp,Hb.cp,Fa.tw.XH)),Fa.tw=null,Fa=Hb.isDictationCorrectionEnd=!1))}this.Ma.raiseEvent("RDCM",new sn(z.id,Ma))}}static Smm(z,Z){if(!Z.count)return Z;Z.Sc((Fa,Ma)=>Fa.IO!==Ma.IO?Fa.IO-Ma.IO:Fa.Pb-
Ma.Pb);z=Ng.ParagraphReader.text(z);const pa=new Ta.a;for(let Fa=0;Fa<Z.count;Fa++){const Ma=Z.ga(Fa);if(Ma.IO>z.length||Ma.Pb>z.length)break;if(!tg.U4h(z,Ma))continue;if(!pa.count){pa.add(Ma);continue}const tb=pa.ga(pa.count-1);Ma.IO>tb.Pb?pa.add(Ma):tb.IO===Ma.IO&&tb.Pb===Ma.Pb&&tb.XH.CXk(Ma.XH)}return pa}static V4h(z,Z,pa){if(pa+Z.length<=z.length){for(let Fa=0;Fa<Z.length;Fa++)if(Z.charAt(Fa)!==z.charAt(Fa+pa))return!1;return!0}return!1}static U4h(z,Z){return!z||Z.IO>z.length||Z.Pb>z.length||
!Z.XH||!Z.XH.source?!1:tg.V4h(z,Z.XH.source,Z.IO)}}Object(k.a)(tg,"DictationCorrectionRangeEditor",null,[1034]);class xl{constructor(){this.sFa=!1}}Object(k.a)(xl,"DictationCorrectionSettings",null,[]);var zq=d(15);class $n{constructor(){this.v1b=new zq.ScriptSharpLegacyMap}Lti(z){if(z&&z.count)for(const Z of z)Z.XH?(z=Z.XH.key,this.v1b.Ib(z)||this.v1b.add(z,Z.XH)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}Yyl(z){if(z&&z.count)for(const Z of z)Z.XH?this.v1b.remove(Z.XH.key):
e.ULS.sendTraceTag(593285259,394,10,"Correction details is null.")}Xxj(z){if(!z)return null;let Z;return({value:Z}=this.v1b.Eg(z)).returnValue?Z:null}clear(){this.v1b=new zq.ScriptSharpLegacyMap}}Object(k.a)($n,"DictationCorrectionStorage",null,[1059]);class yl{constructor(z,Z,pa,Fa,Ma,tb,Hb){this.Ch=z;this.SWb=Z;this.$_=pa;this.Ca=Fa;this.Vc=Ma;this.Bf=tb;this.lm=Hb}qb(){this.Ca.xa(Hd.a.aAc,Zc.a.Xf,Object(ib.a)(this,this.fAc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(Hd.a.bAc,Zc.a.Xf,
Object(ib.a)(this,this.fAc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(Hd.a.cAc,Zc.a.Xf,Object(ib.a)(this,this.fAc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(Hd.a.dAc,Zc.a.Xf,Object(ib.a)(this,this.fAc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(Hd.a.eAc,Zc.a.Xf,Object(ib.a)(this,this.fAc,"takeSuggestedDictationCorrectionAction"));this.Ca.xa(Hd.a.$zc,Zc.a.Xf,Object(ib.a)(this,this.$zc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.xa(Hd.a.aAc,Zc.a.view,Object(ib.a)(this,
this.Kxb,"collapseIpThenExecuteAction"));this.Ca.xa(Hd.a.bAc,Zc.a.view,Object(ib.a)(this,this.Kxb,"collapseIpThenExecuteAction"));this.Ca.xa(Hd.a.cAc,Zc.a.view,Object(ib.a)(this,this.Kxb,"collapseIpThenExecuteAction"));this.Ca.xa(Hd.a.dAc,Zc.a.view,Object(ib.a)(this,this.Kxb,"collapseIpThenExecuteAction"));this.Ca.xa(Hd.a.eAc,Zc.a.view,Object(ib.a)(this,this.Kxb,"collapseIpThenExecuteAction"));this.Ca.xa(Hd.a.$zc,Zc.a.view,Object(ib.a)(this,this.Kxb,"collapseIpThenExecuteAction"));this.Ca.pe(Hd.a.aAc,
96);this.Ca.pe(Hd.a.bAc,96);this.Ca.pe(Hd.a.cAc,96);this.Ca.pe(Hd.a.dAc,96);this.Ca.pe(Hd.a.eAc,96);this.Ca.pe(Hd.a.$zc,96)}lEi(z,Z,pa){const Fa=this.lm.xe(15);try{Fa.rd(z);let Ma;this.SWb.Gvc(z,(Ma=new Ta.a,Ma.add(Z),Ma));const tb=Z.XH.suggestions.ga(pa);if(this.SWb.Tmm(z,tb,Z.IO)){const Hb=Ih.a.createTextRange(z,Z.IO,Z.IO+tb.source.length);this.Ch.replaceTextRange(Hb,tb.suggestion);this.$_.t4k(Z.XH,pa)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{Fa&&Fa.dispose()}}fAc(z,
Z,pa){2===pa&&Z.El&&(pa=this.SWb.D_c(Z))&&this.lEi(Z.node,pa,this.Zxj(z));return 32}Kxb(z,Z,pa,Fa,Ma){if(2===pa){Z=this.Vc.Oa.kb;if(!Z)return 2;Z=this.Bf.Km(Z,!0,!1);return this.Ca.Ai(Z.Ua,z,pa,!1,Fa,Ma)}return 32}$zc(z,Z,pa){if(2===pa&&Z.El&&(z=this.SWb.D_c(Z))){let Fa;this.SWb.Gvc(Z.node,(Fa=new Ta.a,Fa.add(z),Fa));this.$_.w4k(z.XH)}return 32}Zxj(z){switch(z){case Hd.a.aAc:return 0;case Hd.a.bAc:return 1;case Hd.a.cAc:return 2;case Hd.a.dAc:return 3;case Hd.a.eAc:return 4;default:return-1}}}Object(k.a)(yl,
"DictationCorrectionsActor",null,[1058]);var Hf=d(327),xj=d(63);class Gn{constructor(){this.arf=this.Da=null}get name(){return"Box4.DictationCorrections"}fc(z){this.Da=z;this.Da.register(1034,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().na(()=>new tg(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(1035,"Box4.DictationCorrections.IDictationCorrectionManager").ma().na(()=>new lo(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new xl,
new $n));this.Da.register(1036,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().na(()=>new Uc(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.arf=new yl(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),H.AFrameworkApplication.Pa,
xj.a.instance,Hf.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.arf.qb();this.bwl(this.Da.Ha("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const z=this.Da.ub("Box4.Proofing.IErrorRangeEditor"),Z=this.Da.ub("Box4.DictationCorrections.IDictationCorrectionRangeEditor");H.AFrameworkApplication.fa.getBooleanAppSetting("WacBox4DictationFloatieIsEnabled")&&z&&Z&&
z.Syi(Object(ib.a)(Z,Z.t$k,"onSpellingErrorRangesChangedEventHandler"));Eb.App.Ob.Gf()}dispose(){}bwl(z,Z,pa){z&&z.execute(Fa=>{Fa.o2a(new Ce(Z,pa))})}}Object(k.a)(Gn,"DictationCorrectionsPackageManager",null,[2,3]);d(1278);d(736);var rp=d(489);class Wd{constructor(z,Z,pa,Fa=null,Ma=null){this.Xo=z;this.OH=Z;this.xhi=pa;this._id=Fa;this.HNd=Ma}get Qe(){return this.Xo}get type(){return this.OH}get il(){return this.xhi}get id(){return this._id}get intent(){return this.HNd}le(z){return new Wd(z,this.type,
this.il,this.id,this.intent)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,this.il,this.id?this.id.toString():"<null>")}}Object(k.a)(Wd,"IntentObject",null,[429]);d(611);class Gi{constructor(z,Z,pa,Fa=null,Ma=null){rp.a(z);this.OH=z;this.uId=Z;this.cLd=pa;this._id=Fa;this.HNd=Ma}get type(){return this.OH}get begin(){return this.uId}get end(){return this.cLd}get id(){return this._id}get intent(){return this.HNd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",
this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(k.a)(Gi,"IntentRange",null,[343]);d(364);d(152);d(196);class lf{constructor(z){this.Ch=z}}Object(k.a)(lf,"IntentRangeEditor",null,[1029]);class zl{constructor(){this.Da=null}get name(){return"Box4.Intent"}fc(z){this.Da=z;this.Da.register(lf,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().na(()=>new lf(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){Qa.a.instance.Ac(new zl)}}
Object(k.a)(zl,"PackageManager",null,[2,3]);var Vo=d(1218),Je=d(1167),sp=d(301),ri=d(1168),Gh=d(955),Bo=d(818);class mh{}mh.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");mh.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");mh.Znm=
"en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");mh.iHi=["en-US","en-CA","en-GB","en-AU","en-IN"];mh.jHi="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");mh.T9i="en-US";mh.Ebj="btnStartDictation";mh.Pbj="btnDictationFloatieToggle";mh.Jbj="Dictation";mh.Qbj="DictationFloatieToggle";
mh.u5f="Insertaudio_32x32x32";mh.t5f="Insertaudio_16x16x32";mh.Ibj="JotInsertAudioRecordingShort_32x32x32";mh.Hbj="JotInsertAudioRecordingShort_16x16x32";mh.i4l="speechOn.wav";mh.h4l="speechOff.wav";Object(k.a)(mh,"DictationConstants",null,[]);class ao{constructor(z){this.Qxf=z;this.ZPa=(z=pi.a.Oe(z))?z.displayName:this.Qxf;this.IH=z?z.LCID:ao.dwk}get T9c(){return this.Qxf}get displayName(){return this.ZPa}get LCID(){return this.IH}}ao.dwk=1033;Object(k.a)(ao,"DictationLanguage",null,[]);class Al{constructor(z,
Z,pa,Fa,Ma,tb,Hb,rc,yc){this.bIc=null;this.Xtf=!1;this.hda=null;this.Pub=!1;this.Wsd=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;aa&&(xc=!!H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.es,this.hda?aa[xc?dg.a.On:Je.a.On]=this.hda.isVisible():(wd=this.b4.XJ(),wd=(ld=2===wd)||1===wd,xc?(aa[dg.a.On]=wd,aa[sp.a.IconSet]=ld?(new ri.a("JotInsertAudioRecordingShort_20")).iconSet:H.AFrameworkApplication.za.mb.DAa?(new ri.a("InsertAudio_32")).iconSet:(new ri.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):
(aa[Je.a.On]=wd,ld?(aa[Je.a.Image32by32Class]=Wk.getImageClass(mh.Ibj),aa[Je.a.Image16by16Class]=Wk.getImageClass(mh.Hbj)):(aa[Je.a.Image32by32Class]=Wk.getImageClass(mh.u5f),aa[Je.a.Image16by16Class]=Wk.getImageClass(mh.t5f)))));return 32};this.UAc=(xc,ld,wd,t,aa)=>{if(2===wd){if(!this.hda||(null===aa||void 0===aa?0:aa.s5f))return this.mce(aa);this.GYh()}return 32};this.rDd=(xc,ld,wd)=>2!==wd?32:this.mce(void 0);this.Xsc=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;this.Ugl(aa,xc===Hd.a.Vuh);return 32};
this.i0e=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;aa&&((xc=aa.MenuItemId)&&xc===this.Hg.CU?(aa[dg.a.On]=!0,this.bIc=aa.SourceControlId):aa[dg.a.On]=!1);return 32};this.y_e=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;aa&&(aa[Gh.a.Value]=(new ao(this.Hg.CU)).displayName);return 32};this.F7e=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;aa&&(xc=aa.SourceControlId,this.bIc!==xc&&(this.Hg.CU=aa.MenuItemId,this.K2h(this.bIc),this.K2h(xc),this.bIc=xc,2===this.b4.XJ()&&this.xW()));return 32};this.G7e=(xc,ld,wd,t,aa)=>{if(1===
wd)return 32;if(aa){xc=aa.MenuItemId;if(this.Hg.CU!==xc){this.Hg.CU=xc;if(this.hda)this.hda.onDictationLanguageChanged(xc);2===this.b4.XJ()&&this.xW()}this.ohf()}return 32};this.showHelpPane=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;xc=this.T$h.value;if(!xc)return 0;aa&&(aa={},aa.query="AssetID="+(this.Hg.Dlm?Al.ofi:Al.TMd),aa=Object.assign(new Vo.a,{nonPersistedSettings:aa}),xc.Aia(Al.SMd,aa));return 32};this.qam=(xc,ld,wd,t,aa)=>{if(1===wd)return this.Hg.kue?32:8;aa&&this.Hg&&(this.Hg.useAutoPunctuation=
aa[dg.a.On]);2===this.b4.XJ()&&this.xW();this.ohf();return 32};this.Dam=(xc,ld,wd,t,aa)=>{if(1===wd)return this.Hg.Gye?32:8;aa&&this.Hg&&(this.Hg.KUb=aa[dg.a.On]);2===this.b4.XJ()&&(this.b4.xW(),this.pUb());this.f2h();return 32};this.Bol=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;aa&&this.Hg&&(aa[dg.a.On]=this.Hg.useAutoPunctuation);return 32};this.Dol=(xc,ld,wd,t,aa)=>{if(1===wd)return 32;aa&&this.Hg&&(aa[dg.a.On]=this.Hg.KUb);return 32};this.y4k=(xc,ld,wd)=>{2===wd&&this.EWc();return 32};this.$7k=(xc,
ld,wd)=>{2===wd&&this.Hg.LM&&2===this.b4.XJ()&&this.xW();return 32};this.$4k=(xc,ld,wd)=>{2===wd&&this.Hg.LM&&this.EWc();return 32};this.dMb=(xc,ld,wd)=>{2===wd&&(this.Hg.LM?this.EWc():this.xW());return 32};this.c5k=(xc,ld,wd)=>{2===wd&&this.xW();return 32};this.B4k=(xc,ld,wd)=>{2===wd&&this.pUb();return 32};this.C4k=(xc,ld,wd)=>{2===wd&&(this.b4.xW(),this.pUb());return 32};this.A4k=(xc,ld,wd,t,aa)=>{2===wd&&aa&&(xc=pi.a.Oe(this.Hg.CU),this.Sf.wxc(this.NQ.yt(aa),xc.LCID,aa.Pb));return 32};this.z4k=
(xc,ld,wd)=>{2===wd&&this.xW();return 32};this.E4k=(xc,ld,wd)=>{2===wd&&this.xW();return 32};this.D4k=(xc,ld,wd)=>2===wd&&this.Hg&&this.Hg.lhk?this.Hg.LM&&this.hda&&!this.hda.isVisible()?(this.GYh(),32):this.mce(void 0):32;this.Ca=z;this.$_=Eb.App.z4a;this.mFc=Eb.App.N0;this.b4=pa;this.MKc=Z;this.Sf=Fa;this.NQ=Ma;this.Hg=Hb;this.Wd=yc;this.Hg.LM&&(this.hda=tb);this.T$h=rc}qb(){this.Ca.pa(Hd.a.Xsc,Zc.a.view,this.Xsc,96);this.Ca.pa(Hd.a.F7e,Zc.a.view,this.F7e,1028);this.Ca.pa(Hd.a.i0e,Zc.a.view,this.i0e,
96);this.Ca.pa(Hd.a.UAc,Zc.a.view,this.UAc,1028);this.Ca.pa(Hd.a.Wsd,Zc.a.view,this.Wsd,96);this.Ca.pa(Hd.a.p5f,Zc.a.view,this.dMb,64);this.Ca.pa(Hd.a.v5f,Zc.a.view,this.dMb,64);this.Ca.pa(Hd.a.y5f,Zc.a.view,this.B4k,64);this.Ca.pa(Hd.a.z5f,Zc.a.view,this.C4k,64);this.Ca.pa(Hd.a.w5f,Zc.a.view,this.A4k,64);this.Ca.pa(Hd.a.r5f,Zc.a.view,this.z4k,64);this.Ca.pa(Hd.a.B5f,Zc.a.view,this.c5k,64);this.Ca.pa(Hd.a.x5f,Zc.a.view,this.E4k,64);this.Ca.pa(Hd.a.Vuh,Zc.a.view,this.Xsc,96);this.Ca.pa(Hd.a.G7e,Zc.a.view,
this.G7e,1028);this.Ca.pa(Hd.a.y_e,Zc.a.view,this.y_e,96);this.Ca.pa(Hd.a.Lbj,Zc.a.view,this.showHelpPane,96);this.Ca.pa(Hd.a.Mbj,Zc.a.view,this.showHelpPane,96);this.Ca.pa(Hd.a.Kbj,Zc.a.view,this.qam,96);this.Ca.pa(Hd.a.qnl,Zc.a.view,this.Bol,96);this.Ca.pa(Hd.a.Nbj,Zc.a.view,this.Dam,96);this.Ca.pa(Hd.a.rnl,Zc.a.view,this.Dol,96);this.Ca.pa(Hd.a.rDd,Zc.a.view,this.rDd,1028);this.Ca.pa(Hd.a.q5f,Zc.a.view,this.y4k,1028);this.Ca.pa(Hd.a.Gbj,Zc.a.view,this.$7k,96);this.Ca.pa(Hd.a.Fbj,Zc.a.view,this.$4k,
96);const z=ub.KeyInputManager.Va(qc.a.G4h,1);this.Wd.Kc(Tb.AFrame.Nj).bindAction(z,Hd.a.A5f);this.Ca.pa(Hd.a.A5f,Zc.a.view,this.D4k,1028)}C_c(){return H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.es?this.Hg.LM?mh.Qbj:mh.Jbj:this.Hg.LM?mh.Pbj:mh.Ebj}Kti(){const z=Object.assign(new Bg.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),Z=Object.assign(new Ae.a,{Id:"DictationLanguageList_"+this.C_c(),ExternalId:"DictationLanguageList_"+
this.C_c(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.C_c(),QueryCommand:"2417470717",Image16by16Class:Wk.getImageClass(mh.t5f),Image32by32Class:Wk.getImageClass(mh.u5f),Visible:!0,AriaLabel:ic.a.ZFi});Array.add(z.ControlList,Z);return z}Ugl(z,Z){z.MenuItems=Object.assign(new Me.a,{Id:Z?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!Z){var pa=this.Kti();Array.add(z.MenuItems.MenuSectionList,pa)}pa=
this.Hg.Dxh;0<pa.length&&(pa=Al.STc(pa,"dictationProdcutionLanguages","",Z),Array.add(z.MenuItems.MenuSectionList,pa));pa=this.Hg.Awh;0<pa.length&&(Z=Al.STc(pa,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,Z),Array.add(z.MenuItems.MenuSectionList,Z));z.PopulationXML=ec.l(z.MenuItems);this.Xtf=!0}pUb(){const z=this.MKc.value;if(z){const Z=this.C_c();if(H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.es){const pa={};pa[Z]=this.Hg.LM?"ToggleButtonModel":"SplitButtonModel";
this.Xtf&&!this.Hg.LM&&(pa["DictationLanguageList_"+Z]="ToggleButtonModel");z.nUb(pa)}this.ohf();this.f2h()}}ohf(){if(this.Hg.LM){const z=this.MKc.value;H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.es&&z.nUb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}f2h(){if(this.Hg.LM){const z=this.MKc.value;H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.es&&z.nUb({DictationSettingsVoiceCommands:"CheckboxModel"})}}K2h(z){const Z=this.MKc.value;if(Z&&H.AFrameworkApplication.za&&
H.AFrameworkApplication.za.mb.es){const pa={};pa[z]="ToggleButtonModel";Z.nUb(pa)}}GYh(){this.Pub||(this.Pub=!0,this.hda.isVisible()?(this.EWc(),this.Pub=!1):this.showFloatie(),this.pUb())}showFloatie(){this.hda.showFloatie((new ao(this.Hg.CU)).displayName).then(()=>{0===this.b4.XJ()&&this.b4.Lob(void 0).then(()=>{this.Pub=!1}).catch(z=>{this.Pub=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",z)});this.Hg.zec&&this.$_&&this.$_.d5l();this.mFc&&this.mFc.startSession()}).catch(()=>
{this.Pub=!1})}mce(z){const Z=this.b4.XJ();if(1===Z||3===Z)return 1;0===Z?this.Lob(null===z||void 0===z?void 0:z.s5f):this.xW();return 32}EWc(){const z=this.b4.XJ();1!==z&&(this.hda&&this.hda.hideFloatie(),this.$_&&this.$_.V5l(),0!==z&&this.xW(),this.mFc&&this.mFc.endSession(),this.pUb())}xW(){this.b4.xW();this.pUb()}Lob(z){this.b4.Lob(z).then(()=>{}).catch(Z=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",Z)})}static createInstance(z,Z,pa,Fa,Ma,tb,Hb,rc){return Al.Ja||(Al.Ja=
new Al(H.AFrameworkApplication.Pa,z,Z,pa,Fa,Ma,tb,Hb,rc))}static STc(z,Z,pa,Fa){pa=Object.assign(new Bg.a,{DisplayMode:"Menu",Title:pa,Id:Z,ControlsId:"ctr"+Z,ControlList:[]});for(const Ma of z){z=Z+"_"+Ma.T9c;const tb=Ma.displayName,Hb=Ma.T9c;Fa?(z=Object.assign(new Bo.a,{Id:z,ExternalId:z,LabelText:tb,Command:"3662249320",MenuItemId:Hb,Visible:!0}),Array.add(pa.ControlList,z)):(z=Object.assign(new Ae.a,{Id:z,ExternalId:z,LabelText:tb,Command:"2863762275",MenuItemId:Hb,QueryCommand:"2739750502",
Visible:!0,AriaLabel:ic.a.gwb}),Array.add(pa.ControlList,z))}return pa}}Al.Ja=null;Al.SMd="FA000000012";Al.TMd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";Al.ofi="78766431-0933-4603-abf5-5bcc1dee9dda";Object(k.a)(Al,"DictationActor",null,[1113]);var mo=d(277),bo=d(1165),Dm=d(163);class Xk{constructor(z,Z){this.a0=null;this.rda=!1;this.SPa=null;this.Wci=z;this.Hg=Z}isVisible(){return this.rda}e6c(){return this.rda&&!!this.a0}ohj(){if(this.a0)return!0;this.a0=this.Wci.value;if(!this.a0)return!1;this.a0.KDm(Hd.a.rDd);
this.a0.EDm(Hd.a.q5f);Sc.a.addHandler(window.self,ob.a.resize,()=>{this.u0j()});const z=Ic.FocusManager.instance().Kc(Dm.AppFrame.Fab);z.cea(Z=>{this.Cpj(Z)});z.TDa((Z,pa)=>{this.Bpj(pa)});z.uK=!0;z.T4e=!0;mo.a.instance.y4(Dm.AppFrame.Fab,!0);mo.a.instance.zp(Dm.AppFrame.Fab);return!0}Cpj(z){this.e6c()&&z.name!==Tb.AFrame.mQ&&this.a0.focus()}Bpj(z){this.e6c()&&z.name!==Tb.AFrame.mQ&&this.a0.blur()}showFloatie(z){return this.rda?Promise.resolve(null):this.ohj()?new Promise((Z,pa)=>{this.a0.xvm().then(()=>
{this.a0.showDictationFloatie(this.fBb(),!1,z,this.Hg.useAutoPunctuation);this.SPa=z;this.rda=!0;mo.a.instance.bM(Dm.AppFrame.Fab);Z(null)}).catch(()=>{pa("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.e6c()&&(this.a0.dismissDictationFloatie(),mo.a.instance.zp(Dm.AppFrame.Fab),this.rda=!1)}showDictationWarning(z){this.e6c()&&this.a0.showDictationWarning(z)}onDictationLanguageChanged(z){this.SPa=z}fBb(){var z=Eb.App.Ob.Nab.getBoundingClientRect();
const Z=z.left+z.width/2-44;z=z.top+z.height-70;return Object.assign(new bo.a,{x:Z,y:z})}u0j(){this.rda&&this.a0&&(this.a0.dismissDictationFloatie(),this.a0.showDictationFloatie(this.fBb(),!1,this.SPa,this.Hg.useAutoPunctuation))}}Object(k.a)(Xk,"DictationFloatieManager",null,[]);class Yk{constructor(){this.cka=this.LCa=0;this.MFc=null;this.uda=!0;this.aDc="";this.Hg=this.Xh=null;this.MCa=this.Bda=this.lQa=this.Du=this.pk=0;this.fLd=this.S_="";this.l0b=this.rWb=0;this.ALd=this.ULd=this.TLd=!1;this.MVd=
"";this.V_b=this.TXb=this.Di=this.a4=null;this.QJd=this.CIc=this.BIc=this.jXd=this.lHf=this.X8a=this.V8a=0}set yZi(z){this.S_=z}get pAa(){return Eb.App.N0?Eb.App.N0.pAa:""}get N4a(){return Eb.App.N0?Eb.App.N0.N4a:""}set N4a(z){Eb.App.N0&&(Eb.App.N0.N4a=z)}onFragment(z){this.lQa||(this.lQa=(new Date).getTime());this.TXb&&(this.TXb.stop(),this.V8a+=this.TXb.Qr,this.TXb.start());this.LCa++;this.MCa+=z.split(" ").length}onFinalPhrase(z){this.lQa||(this.lQa=(new Date).getTime());this.V_b&&(this.V_b.stop(),
this.X8a+=this.V_b.Qr,this.V_b.start());this.MCa=0;this.cka++;this.Bda+=z.split(" ").length}onConnectionStarted(z){this.rWb=(new Date).getTime();this.yZi=z;this.Di&&(this.TXb=this.Di.lj("WebServiceCall","FragmentResponse"),this.V_b=this.Di.lj("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.l0b=(new Date).getTime()}onMicrophoneError(z){this.onCustomError("MicrophoneError",z)}onCustomError(z,Z=null){this.uda=!1;this.MFc=z;this.setEndReason(Z||z)}setEndReason(z){this.fLd=z}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(z,
Z){this.QJd=Z;z?(this.jXd+=Z,Z>this.CIc&&(this.CIc=Z)):(this.lHf=Z,Z>this.BIc&&(this.BIc=Z))}onFocusLost(){this.TLd=!0}onFocusLostWhileStarting(){this.ULd=!0}onFailedToStartTurn(){this.ALd=!0}onSpeechSessionStarted(z){this.MVd=z}setDictationLatency(z){this.a4=z}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(k.a)(Yk,"AbstractDictationSessionTelemetry",null,[1147]);class Em{}Em.seen="Seen";Em.nZh="Tried";Em.GHg="Kept";Object(k.a)(Em,"FunnelStatus",null,[]);class tp{constructor(){this.dataFields=this.name=null}}Object(k.a)(tp,"Contract",null,[]);class Tl extends Yk{constructor(z,Z){super();this.Npf=this.Mpf=this.fof=!1;this.KQd=this.FQd=this.JTd=0;this.UQd=this.TQd=2147483647;this.iXd=this.gXd=0;this.Hg=z;this.pk=(new Date).getTime();this.Di=Z;this.N4a=ka.a.create().toString();this.Xh=new jf.a;this.Xh.dataFields=
[];this.aDc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(z,Z,pa){z=z+this.QJd-(this.JTd+(Z+pa)/1E4);this.gXd+=z;this.FQd<z&&(this.FQd=z);this.TQd>z&&(this.TQd=z)}onPartialResultAnnotationResponse(z,Z,pa){z=z+this.QJd-(this.JTd+(Z+pa)/1E4);this.iXd+=z;this.KQd<z&&(this.KQd=z);this.UQd>z&&(this.UQd=z)}setRecordingStartTime(z){this.JTd=z}onCommandCalled(){this.Mpf=!0}onAugloopError(z){this.uda=!1;this.fof=!0;this.MFc=z}onCommandError(){this.Npf=!0}endActivity(){this.Bda+=
this.MCa;this.Du=(new Date).getTime();this.Xh.succeeded=this.uda;this.Xh.durationMs=this.Du-this.pk;Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"Success",bool:this.uda}));this.uda||Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"error",string:this.MFc}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"SessionID",string:this.pAa}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"SpeechSessionID",string:this.MVd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,
{name:"TurnID",string:this.N4a}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"NumberOfWords",int64:0<this.MCa?this.MCa+this.Bda:this.Bda}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"NumberOfFragments",int64:this.LCa}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"NumberOfFinalPhrases",int64:this.cka}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"Language",string:this.Hg.CU}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"connectionID",
string:this.S_}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"IsUsingFloatie",bool:this.Hg.LM}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"UseAutoPunctuation",bool:this.Hg.useAutoPunctuation}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"EndReason",string:this.fLd}));this.lQa&&Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TimeToGetFirstResult",int64:this.lQa-
this.rWb}));this.uda&&(Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TimeToStartRecording",int64:this.l0b-this.pk})),Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TimeToOpenConnection",int64:this.rWb-this.l0b})));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"FocusLost",bool:this.TLd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"FocusLostWhileStarting",bool:this.ULd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"FailedToStartTurn",
bool:this.ALd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MaxTimeToInsertFragment",int64:this.BIc}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MaxTimeToInsertPhrase",int64:this.CIc}));var z=Em.seen;this.uda&&0<this.Bda&&(z=0<this.cka?Em.GHg:Em.nZh);Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"DictationFunnel",contract:Object.assign(new tp,{name:"Office.System.Funnel",dataFields:[Object.assign(new Ye.a,{name:"Name",string:"Dictation"}),Object.assign(new Ye.a,
{name:"State",string:z})]})}));this.Xh.name=this.aDc;this.Xh.samplingPolicy=2;Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"AugloopFailed",bool:this.fof}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"CommandsUsed",bool:this.Mpf}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"CommandsFailed",bool:this.Npf}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.FQd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.TQd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.KQd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.UQd}));z=0<this.cka?this.gXd/this.cka:0;const Z=0<this.LCa?this.iXd/this.LCa:0;Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"AverageFinalResultUserPerceivedLatency",double:z}));Array.add(this.Xh.dataFields,
Object.assign(new Ye.a,{name:"AveragePartialResultUserPerceivedLatency",double:Z}));hf.a.sendActivityEvent(this.Xh)}}Object(k.a)(Tl,"AugloopDictationTelemetry",Yk,[]);var Vp=d(220);class up{constructor(z){this.u8=z}play(){this.u8.play()}pause(){this.u8.pause()}get paused(){return this.u8.paused}get currentTime(){return this.u8.currentTime}set currentTime(z){this.u8.currentTime=z}get duration(){return this.u8.duration}get error(){const z=this.u8.error;return z?z.code:0}get readyState(){return this.u8.readyState}get src(){return this.u8.getAttribute("src")}set src(z){this.u8.setAttribute("src",
z)}get preload(){return this.u8.getAttribute("preload")}set preload(z){this.u8.setAttribute("preload",z)}get tg(){return this.u8}}Object(k.a)(up,"AudioElement",null,[]);class Wo{constructor(){this.MRd=this.LRd=this.X8a=this.V8a=this.DKd=0}onAudioData(){this.DKd||(this.DKd=(new Date).getTime())}onFragment(z){this.V8a+=this.$pg(z);this.LRd++}b8k(z){this.X8a+=this.$pg(z);this.MRd++}ngg(){return this.MRd?this.X8a/this.MRd:0}Puj(){return this.LRd?this.V8a/this.LRd:this.ngg()}$pg(z){if(!z)return 0;const Z=
(new Date).getTime();let pa=null;return({Ev:pa}=W.d(z)).returnValue?Z-this.DKd-(pa.Offset+pa.Duration)/1E4:0}}Object(k.a)(Wo,"DictationLatency",null,[]);class hn{constructor(z,Z){this.I8=0;this.KVd=this.LVd=null;this.fZb=!1;this.IIc=null;this.qHc=!1;this.a4=this.Or=null;this.EH=Z;this.lda=z}onFinalText(z,Z){if(2===this.I8){var pa=z.size;if(1!==pa&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",pa),!pa))return;Z=Z.get("JsonResult");this.a4&&this.a4.b8k(Z);this.EH.onFinalPhrase(z.values().next().value,
Z)}}onFragmentText(z,Z){if(2===this.I8){var pa=z.size;if(1!==pa&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",pa),!pa))return;Z=Z.get("JsonResult");if(this.a4)this.a4.onFragment(Z);this.EH.onFragment(z.values().next().value)}}onError(z){if(0!==this.I8&&3!==this.I8&&"ErrorNone"!==z){this.I8=3;switch(z){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.EH.Z1k(z);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.EH.W3k(z);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.EH.HN(z);break;case "ErrorInitialSilenceTimeout":this.EH.q6k(z);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.EH.onMicrophoneError(z);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.EH.FUe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.EH.FUe("NotFoundError");break;case "ErrorAudioNotReadableError":this.EH.FUe("NotReadableError");break;default:this.EH.bal(z)}this.I8=0}}onSpeechRecognitionStarted(z){window.self.document.hasFocus()?(this.I8=2,this.fZb=!1,this.EH.onRecordingStarted(),this.EH.onConnectionStarted(z),this.LVd||
(this.LVd=Object.assign(new up(document.createElement("audio")),{src:Vp.a.box4Image(mh.i4l)})),this.LVd.play()):(this.Sgf(),this.EH.onFocusLost())}onSpeechEnd(){this.Sgf();0!==this.XJ()&&(this.I8=3,this.EH.J8k(),this.I8=0,this.KVd||(this.KVd=Object.assign(new up(document.createElement("audio")),{src:Vp.a.box4Image(mh.h4l)})),this.KVd.play())}onAudioData(z){if(this.a4)this.a4.onAudioData();if(this.lda){var Z=0;for(const pa of z)Z+=Math.pow(pa,2);z=Math.sqrt(Z/z.length)>hn.U3l;!this.fZb&&z?(this.fZb=
!0,this.IIc=null):this.fZb&&!z&&(this.IIc?(new Date).getTime()>=this.IIc+hn.$Xk&&(this.fZb=!1):this.IIc=(new Date).getTime())}}onSpeechSessionStarted(z){this.EH.onSpeechSessionStarted(z)}onEventUpdate(z){if(this.lda&&"QualityStatusUpdate"===z.eventName)switch(z.shortCode){case 13:case 2:this.lda.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.lda.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.lda.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}f4a(z,
Z){this.EH.HFa(!1);this.EH.Qy=z;this.EH.Pzg=Z;this.qwl();this.Or=z;this.I8=1;this.a4=new Wo;this.Or&&this.Or.setDictationLatency(this.a4)}XJ(){return this.I8}qwl(){this.qHc||(Sc.a.addHandler(window.self,ob.a.blur,Object(ib.a)(this,this.$mh,"onFocusLostEventHandler")),this.qHc=!0)}Sgf(){this.qHc&&(Sc.a.removeHandler(window.self,ob.a.blur,Object(ib.a)(this,this.$mh,"onFocusLostEventHandler")),this.qHc=!1)}$mh(){if(1===this.I8){if(this.Or)this.Or.onFocusLostWhileStarting()}else 2===this.I8&&(this.Sgf(),
this.EH.onFocusLost())}}hn.U3l=350;hn.$Xk=350;Object(k.a)(hn,"FrontdoorSpeechClientObserver",null,[1214]);class ej extends hn{constructor(z,Z){super(z,Z);this.nQa=new hn(z,Z)}onFinalText(z,Z){this.nQa.onFinalText(z,Z)}onFragmentText(z,Z){this.nQa.onFragmentText(z,Z)}onError(z){this.nQa.onError(z)}onSpeechRecognitionStarted(z){this.nQa.onSpeechRecognitionStarted(z)}onSpeechEnd(){this.nQa.onSpeechEnd()}onAudioData(z){this.nQa.onAudioData(z)}f4a(z,Z){this.nQa.f4a(z,Z)}XJ(){return this.nQa.XJ()}}Object(k.a)(ej,
"AugloopFrontdoorSpeechObserverAbstractDecorator",hn,[]);class Ge extends ej{constructor(z,Z,pa){super(z,Z);this.Vc=pa}onFinalText(z,Z){super.onFinalText(z,Z)}onFragmentText(z,Z){if(this.Bxe())super.onFragmentText(z,Z)}onError(z){super.onError(z)}onSpeechRecognitionStarted(z=null){const Z=ka.a.create().toString();super.onSpeechRecognitionStarted(z?z:Z)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(z){super.onAudioData(z)}f4a(z,Z){super.f4a(z,Z)}XJ(){return super.XJ()}Bxe(){const z=this.Vc.Oa.kb.Ua;
return z.Pb!==z.Ra?!1:!0}}Object(k.a)(Ge,"AugloopFrontdoorSpeechObserverDecorator",ej,[]);class Mi{constructor(z){this.kIf=z}onVoiceCommand(z){this.kIf.onVoiceCommand(z)}setDictationSessionTelemetry(z){this.kIf.setDictationSessionTelemetry(z)}}Object(k.a)(Mi,"AugloopVoiceCommandObserverAbstractDecorator",null,[1141]);class pd extends Mi{constructor(z,Z,pa){super(z);this.X3=Z;this.Vc=pa}onVoiceCommand(z){this.Bxe()&&this.X3.DEm();super.onVoiceCommand(z)}setDictationSessionTelemetry(z){super.setDictationSessionTelemetry(z)}Bxe(){const z=
this.Vc.Oa.kb.Ua;return z.Pb!==z.Ra?!1:!0}}Object(k.a)(pd,"AugloopVoiceCommandObserverDecorator",Mi,[]);class ek{constructor(z){this.Hg=z}OJg(z){const Z=H.AFrameworkApplication.Me;if(Z){var pa=this.Hg.Reg;pa&&""!==pa&&Z.Tj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",pa),2,z,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(k.a)(ek,"FrontdoorCorrectionsTelemetryLogger",null,[1150]);class dh{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(k.a)(dh,"SpeechDictationSettings",null,[]);class co{constructor(z,Z,pa,Fa){this.CKd=this.Qz=null;this.X3=z;this.lda=Z;this.EH=pa;this.srb=Fa;this.initializeCommandsDictionary()}onVoiceCommand(z){if(this.CKd)this.CKd.onCommandCalled();var Z=4;if(({value:Z}=this.Qz.Eg(z.commandId,0)).returnValue&&4!==Z){let pa=null;z.commandValue&&(pa=new n.a(r.a.gl()),pa.add("commandValue",z.commandValue));this.EH.HFa(!1);Z=this.X3.executeCommand(Z,pa);if(z.offset&&
z.duration)this.srb.onCommandFinished(z.commandId,Z,z.offset,z.duration)}}setDictationSessionTelemetry(z){this.CKd=z}initializeCommandsDictionary(){this.Qz=new n.a(r.a.gl());this.Qz.add("Word.Editing.Undo",2);this.Qz.add("Word.Editing.Bold",5);this.Qz.add("Word.Editing.Italics",6);this.Qz.add("Word.Editing.Underline",10);this.Qz.add("Word.Editing.StrikeThrough",20);this.Qz.add("Word.Editing.Subscript",19);this.Qz.add("Word.Editing.Superscript",18);this.Qz.add("Word.Editing.RemoveBold",11);this.Qz.add("Word.Editing.RemoveUnderline",
13);this.Qz.add("Word.Editing.RemoveItalics",12);this.Qz.add("Word.Editing.RemoveStrikeThrough",21);this.Qz.add("Word.Editing.RemoveSubscript",22);this.Qz.add("Word.Editing.RemoveSuperscript",24);this.Qz.add("Word.Editing.Paste",7);this.Qz.add("Word.Editing.InsertTable",8);this.Qz.add("Word.Editing.InsertComment",9);this.Qz.add("Word.Editing.InsertBullet",23);this.Qz.add("Word.Editing.FullJustify",14);this.Qz.add("Word.Editing.CenterJustify",15);this.Qz.add("Word.Editing.LeftJustify",16);this.Qz.add("Word.Editing.RightJustify",
17);this.Qz.add("Command.Exit",1);this.Qz.add("Command.Pause",0);this.Qz.add("Command.ShowHelp",26);this.Qz.add("Command.ShowCommand",27);this.Qz.add("Word.Editing.RemoveFormatting",28)}}Object(k.a)(co,"VoiceCommandObserver",null,[1141]);var Uq=d(1009);class Zk{constructor(z,Z,pa,Fa,Ma,tb,Hb){this.Or=this.j2b=null;this.D6j=0;this.srb=Ma;this.Hg=Hb;Ma=new dh;Ma.dictationLanguage=Hb.CU;Ma.useAutoPunctuation=Hb.useAutoPunctuation?"Intelligent":"Explicit";Ma.useCorrections=Hb.zec.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
Ma;this.l9=new Ge(z,tb,Fa);this.lIf=new pd(new co(Z,z,tb,this.srb),Z,Fa);this.xDc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.Nnf=Array(pa);this.xDc.setAnnotationResultCallback(Object.assign(new Uq.a,{handler:rc=>{for(const yc of this.Nnf)yc.onAnnotationResult(rc)}}));this.p1b=new alVoiceClient.SpeechToTextClient(this.xDc,this.l9,Hb.hqb||Hb.AFd,!1);this.sJf(this.p1b.getAnnotationObserver());this.i2b=new alVoiceClient.VoiceCommandingClient(this.xDc,this.lIf,this.l9);this.sJf(this.i2b.getAnnotationObserver());
Hb.zec&&(z=new ek(Hb),(Z=Eb.App.z4a)&&Z.YBh(z))}Fxg(z,Z){return new Promise(pa=>{const Fa=new dh;Fa.dictationLanguage=z;Fa.useAutoPunctuation=this.Hg.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=Fa;this.Or=Z;pa(this.Y9j())})}Lob(z){if(!this.p1b)return 3;this.j2b.startVoiceSessionFromMicrophoneInput();this.l9.f4a(this.Or,z);z=this.Hg.KUb;this.p1b.initializeAsync(z?[1]:[1,0],this.Or);z&&this.K5l();return 0}xW(z){if(z&&this.l9)this.l9.onSpeechEnd();
this.p1b&&this.p1b.uninitializeAsync();this.j2b&&(this.j2b.stopVoiceSession(),this.j2b=null);this.Or=null;this.Hg.KUb&&this.h6l()}XJ(){return this.l9.XJ()}Y9j(){this.Hg.KUb&&this.lIf.setDictationSessionTelemetry(this.Or);this.j2b=new alVoiceClient.VoiceSession(this.xDc,this.l9,this.Hg.hqb,this.srb,this.Or);return 0}K5l(){this.i2b&&this.i2b.initializeAsync(this.Or)}h6l(){this.i2b&&this.i2b.uninitializeAsync()}sJf(z){this.Nnf[this.D6j++]=z}}Object(k.a)(Zk,"AugloopSpeechClientProxy",null,[1103]);class Xo extends Yk{constructor(z,
Z){super();this.Hg=z;this.pk=(new Date).getTime();this.Di=Z;this.N4a=ka.a.create().toString();this.Xh=new jf.a;this.Xh.dataFields=[];this.aDc="Office.Voice.Online.DictationSession"}endActivity(){this.Bda+=this.MCa;this.Du=(new Date).getTime();this.Xh.succeeded=this.uda;this.Xh.durationMs=this.Du-this.pk;Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"Success",bool:this.uda}));this.uda||Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"error",string:this.MFc}));Array.add(this.Xh.dataFields,
Object.assign(new Ye.a,{name:"SessionID",string:this.pAa}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"SpeechSessionID",string:this.MVd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TurnID",string:this.N4a}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"NumberOfWords",int64:0<this.MCa?this.MCa+this.Bda:this.Bda}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"NumberOfFragments",int64:this.LCa}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,
{name:"NumberOfFinalPhrases",int64:this.cka}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"Language",string:this.Hg.CU}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"connectionID",string:this.S_}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"IsUsingFloatie",bool:this.Hg.LM}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"UseAutoPunctuation",bool:this.Hg.useAutoPunctuation}));
Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"EndReason",string:this.fLd}));this.lQa&&Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TimeToGetFirstResult",int64:this.lQa-this.rWb}));this.uda&&(Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TimeToStartRecording",int64:this.l0b-this.pk})),Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"TimeToOpenConnection",int64:this.rWb-this.l0b})));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"FocusLost",
bool:this.TLd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"FocusLostWhileStarting",bool:this.ULd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"FailedToStartTurn",bool:this.ALd}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"AverageFragmentLatency",double:this.a4?this.a4.Puj():0<this.LCa?this.V8a/this.LCa:0}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"AveragePhraseLatency",double:this.a4?this.a4.ngg():0<this.cka?this.X8a/this.cka:0}));
Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"AveragePhraseInsertionLatency",double:0<this.cka?this.jXd/this.cka:0}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"AverageFragmentInsertionLatency",double:0<this.LCa?this.lHf/this.LCa:0}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MaxTimeToInsertFragment",int64:this.BIc}));Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"MaxTimeToInsertPhrase",int64:this.CIc}));let z=Em.seen;this.uda&&0<this.Bda&&
(z=0<this.cka?Em.GHg:Em.nZh);Array.add(this.Xh.dataFields,Object.assign(new Ye.a,{name:"DictationFunnel",contract:Object.assign(new tp,{name:"Office.System.Funnel",dataFields:[Object.assign(new Ye.a,{name:"Name",string:"Dictation"}),Object.assign(new Ye.a,{name:"State",string:z})]})}));this.Xh.name=this.aDc;this.Xh.samplingPolicy=2;hf.a.sendActivityEvent(this.Xh)}}Object(k.a)(Xo,"DictationSessionTelemetry",Yk,[]);var Hi=d(1213);class Qj{constructor(z,Z){this.lRa=z;this.vgi=Z}getAccessToken(z){this.vgi&&
this.lRa?this.lRa.vH("OfficeDictation",H.AFrameworkApplication.fa.Ea("DictationResourceID")).then(Z=>{Z.IsSuccess?z(Z.Token):z(Qj.Dae)}).catch(()=>{z(Qj.Dae)}):z(Qj.Dae)}}Qj.Dae="dictation access token";Object(k.a)(Qj,"AuthenticationProvider",null,[]);class Kk{constructor(z){this.Dgi=z;this.BMc=new eg.a}debugAssertTag(z,Z,pa,Fa){this.xGd(Fa);this.BMc.debugAssertTag(z,Z,pa,Fa)}debugTraceTag(z,Z,pa,Fa){this.xGd(Fa);this.BMc.debugTraceTag(z,Z,pa,Fa)}sendTraceTag(z,Z,pa,Fa){this.xGd(Fa);this.BMc.sendTraceTag(z,
Z,pa,Fa)}shipAssertTag(z,Z,pa,Fa){this.xGd(Fa);this.BMc.shipAssertTag(z,Z,pa,Fa)}xGd(z){if(this.Dgi){const Z=window.console;Z&&Z.log(String.format("FDSpeechService: {0}",z))}}}Object(k.a)(Kk,"FrontdoorExternalLogger",null,[280]);class no{constructor(){this.accessToken=null}}Object(k.a)(no,"IAuthenticationProvider",null,[]);class Yo{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(k.a)(Yo,"ISpeechConfig",null,[]);class Fm{constructor(z,Z,pa,Fa,Ma){this.Or=this.uub=null;this.ZVd=!1;this.l9=new hn(pa,Fa);this.VW=z;this.Hg=Z;this.mai=new Qj(Ma,Z.khk);this.Hg.zec&&(z=new ek(Z),(Z=Eb.App.z4a)&&Z.YBh(z))}Fxg(z,Z){return new Promise(pa=>{this.mai.getAccessToken(Fa=>{pa(this.z9j(z,Z,Fa))})})}z9j(z,Z,pa){this.Or=Z;z=this.C7d(z);pa=Object.assign(new no,
{accessToken:pa});Z=new Kk(this.Hg.M6c);this.uub=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(z,this.l9,pa,null,Z);return this.uub?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}Lob(z){if(!this.uub)return 3;this.l9.f4a(this.Or,z);this.uub.startSpeechRecognition();return 0}xW(z){if(!this.ZVd){this.ZVd=!0;if(this.uub)try{this.uub.stopSpeechRecognition()}catch(Z){e.ULS.shipAssertTag(593277727,394,!1,Z.message)}if(z&&this.l9)this.l9.onSpeechEnd();
this.Or=null;this.ZVd=!1}}XJ(){return this.l9.XJ()}C7d(z){const Z=new Yo;Z.speechMode="Dictation";Z.sourceLanguage=z;(z=this.Hg.Reg)&&""!==z&&(Z.speechFDBase=String.format("wss://{0}/",z));Z.properties=new Map;this.VW&&(Z.properties.set("DictationInsertionPointLeft",this.VW.vle()),Z.properties.set("DictationInsertionPointRight",this.VW.Mpg()));Z.properties.set("Corrections","true");Z.properties.set("punctuation",this.Hg&&this.Hg.useAutoPunctuation?"Intelligent":"Explicit");this.Hg.M6c&&Z.properties.set("EnableAudioLogging",
this.Hg.M6c.toString());switch(Hi.a.m0d){case "Word":Z.clientApp=1;break;case "PowerPoint":Z.clientApp=0;break;case "OneNote":Z.clientApp=2}return Z}}Object(k.a)(Fm,"FrontdoorSpeechClientProxy",null,[1103]);class Wj{static d_l(){Wj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static B_l(){Wj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static T0l(z){Wj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
z)}static b2l(){Wj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(z,Z){Wj.Nf||(Wj.Nf=new Vb.StandardDialog,Wj.Nf.Is=H.AFrameworkApplication.Rfa,Wj.Nf.Fd=0,Wj.Nf.Te(1,CommonUIStrings.l_DialogClose),Wj.Nf.vQ(z,Z,()=>{Wj.Nf=null}))}}Wj.Nf=null;Object(k.a)(Wj,"Dialogs",null,[]);class tn{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc){this.jtb=this.Vub=!1;this.Qy=null;this.VW=z;this.Pzg=Z;this.Ca=pa;this.FPa=Fa;this.Hg=Ma;this.X3=tb;
this.oWb=Hb;this.lda=rc;this.dDf=new U.a;for(z=0;z<tn.cDf.length;z++)this.dDf.add(tn.cDf.charAt(z).toString())}onFinalPhrase(z,Z=null){let pa=!0;if(this.Qy)this.Qy.onFinalPhrase(z);if(this.oWb&&this.X3){var Fa=this.oWb.ZBm(z);if(Fa){this.HFa(!1);this.X3.executeCommand(Fa.commandId,null);return}}Fa=(new Date).getTime();if(1===z.length&&"\n"===z)this.Ime("",null),this.F$f();else{let Ma=z.indexOf("\n");for(0<Ma&&Ma!==z.length-1&&(pa=!1);0<=Ma;)this.Ime(z.substr(0,Ma),pa?Z:null),this.F$f(),z=z.substr(Ma+
1),Ma=z.indexOf("\n"),pa=!1;this.Ime(z,pa?Z:null)}z=(new Date).getTime();if(this.Qy)this.Qy.onTextInserted(!0,z-Fa)}onFragment(z){if(this.Vub)var Z=this.u2c(z);else{if(!this.wzc())return;Z=this.jtb?this.u2c(z):z}if(this.Qy)this.Qy.onFragment(z);z=!0;const pa=(new Date).getTime();this.VW&&!this.VW.aOf(Z)&&(this.qsg(),z=!1);Z=(new Date).getTime();if(this.Qy)this.Qy.onTextInserted(!1,Z-pa);z&&this.X3&&this.X3.LBm()}onRecordingStarted(){this.Ca.nb(Hd.a.y5f,2);if(this.Qy)this.Qy.onRecordingStarted()}onMicrophoneError(z=
""){this.Lsg(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,z)}dMb(z){if(this.Qy)this.Qy.onCustomError(z);this.Ca.Ia(Hd.a.p5f,2,z)}Z1k(z){this.dMb(z);Wj.d_l()}W3k(z){this.dMb(z);Wj.B_l()}bal(z){this.dMb(z);Wj.b2l()}HN(z){this.Qy&&this.Qy.setEndReason(z);this.Ca.Ia(Hd.a.x5f,2,z)}q6k(z){this.HN(z);this.F1l()}J8k(){this.HFa(!1);this.Ca.nb(Hd.a.z5f,2)}onConnectionStarted(z){if(this.Qy)this.Qy.onConnectionStarted(z)}FUe(z){this.Lsg(this.yFj(z),z)}onFocusLost(){if(this.Qy)this.Qy.onFocusLost();
this.Ca.nb(Hd.a.r5f,2)}Yqk(z){return this.Pzg&&!Ob.a.Iye(z)&&!this.dDf.contains(z.toString())}u2c(z){return 0<z.length&&this.Yqk(z.charAt(0))?" "+z:z}wzc(){if(this.Vub)return!0;if(this.VW){const z=this.VW.vle();this.jtb=!1;z&&0<z.length&&(this.jtb=!Ob.a.Iye(z.charAt(z.length-1))&&!z.endsWith("\u201c"));return this.Vub=this.VW.wzc()}if(this.Qy)this.Qy.onFailedToStartTurn();this.X3&&this.X3.OBm();return!1}HFa(z){this.jtb=this.Vub=!1;this.VW&&(z&&this.VW.Lhh(),this.VW.HFa())}onSpeechSessionStarted(z){if(this.Qy)this.Qy.onSpeechSessionStarted(z);
this.Hg.M6c&&this.J$e(z)}Lsg(z,Z=""){if(this.Qy)this.Qy.onMicrophoneError(Z);this.Ca.nb(Hd.a.v5f,2);Wj.T0l(z)}yFj(z){z=z.trimStart();return z.startsWith("NotAllowedError")||z.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:z.startsWith("NotFoundError")||z.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:z.startsWith("NotReadableError")||z.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}F1l(){this.FPa&&this.FPa.execute(z=>{z.Q_l()})}J$e(z){this.FPa&&this.FPa.execute(Z=>{Z.J$e(String.format("ServiceSessionID:{0} ClientSessionId: {1}",z,this.LUi))})}Ime(z,Z){if(this.Vub||this.wzc()){if(this.VW){const pa=this.jtb?this.u2c(z):z;(this.Hg.zec&&Object(Wa.a)(1102,this.VW)?this.VW.Bvm(pa,Z,0<z.length&&z.charAt(0)!==pa.charAt(0)):this.VW.jyg(this.jtb?this.u2c(z):z))||this.qsg()}this.HFa(!0)}}qsg(){if(this.Qy)this.Qy.onTextInsertionError();
this.Ca.nb(Hd.a.B5f,2)}F$f(){this.Ca.nb(Hd.a.WC,2)}get LUi(){return Eb.App.N0?Eb.App.N0.pAa:""}}tn.cDf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(k.a)(tn,"SpeechClientObserverController",null,[]);class oo{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd){this.pDa=null;this.JVd=new Map;this.oWb=this.X3=this.lda=this.Or=null;this.nG=z;this.Xci=Z;this.Vc=pa;this.FPa=Fa;this.Di=Ma;this.Hg=tb;this.lRa=ld;this.zFf=wd;this.Hg.LM&&(this.lda=Hb);if(this.Hg.kBg||this.Hg.hqb)this.X3=
rc;this.Hg.kBg&&(this.oWb=yc);this.srb=xc}Lob(z){this.FPa&&this.FPa.execute(Fa=>{Fa.A2j()});const Z=this.Xci.value,pa=null!==z&&void 0!==z?z:"Box4.Dictation.IDictationHost";return new Promise((Fa,Ma)=>{this.JVd.has(pa)?(this.pDa=this.JVd.get(pa),this.Q$f(Fa,Ma)):this.ayk().then(()=>{if(Z){const tb=Z.S2i(pa);this.pDa=this.j7i(tb);this.JVd.set(pa,this.pDa);this.Q$f(Fa,Ma)}else Ma(4)}).catch(()=>{Ma(2)})})}Q$f(z,Z){this.f4a().then(pa=>{0===pa?z(0):Z(pa)}).catch(pa=>{Z(pa)})}f4a(){return new Promise((z,
Z)=>{this.Or=new Xo(this.Hg,this.Di);if(this.Hg.AFd||this.Hg.hqb)this.Or=new Tl(this.Hg,this.Di);this.pDa.Fxg(this.Hg.CU,this.Or).then(pa=>{0!==pa?z(pa):z(this.pDa.Lob(this.eHg()))}).catch(pa=>{Z(pa)})})}ayk(){return this.Hg.AFd||this.Hg.hqb?this.mJg("alVoiceClient",!0):this.mJg("PPTSpeechClient")}mJg(z,Z=!1){return!Z&&this.zFf&&H.AFrameworkApplication.za.mb.MBg?(Z=H.AFrameworkApplication.Ui(z,2),wj.a(this.zFf.LFb(Z))):this.nG?this.nG.loadScript(z):new Promise((pa,Fa)=>{Fa("Unable to load speech client "+
z)})}xW(z=!0){0!==this.XJ()&&(this.pDa&&this.pDa.xW(z),this.Or&&(this.Or.endActivity(),this.Or=null))}XJ(){return this.pDa?this.pDa.XJ():0}eHg(){return"zh-CN"!==this.Hg.CU&&"ja-JP"!==this.Hg.CU}j7i(z){const Z=new tn(z,this.eHg(),H.AFrameworkApplication.Pa,this.FPa,this.Hg,this.X3,this.oWb,this.lda);return this.Hg.AFd||this.Hg.hqb?new Zk(this.lda,this.X3,2,this.Vc,this.srb,Z,this.Hg):new Fm(z,this.Hg,this.lda,Z,this.lRa)}}Object(k.a)(oo,"DictationManager",null,[]);class Gm{constructor(){this.sCf=[];
this.N4a=this.bVd=""}startSession(){this.bVd=ka.a.create().toString();this.sCf=[]}endSession(){this.bVd=""}get pAa(){return this.bVd}get puh(){return this.sCf}}Object(k.a)(Gm,"DictationSessionInfo",null,[1027]);class jn{constructor(z,Z,pa){this.JXd=this.f2b=this.HXd=this.e2b=!1;this.SPa="";this.La=z?z:H.AFrameworkApplication.fa;this.o7a=Z;this.Vc=pa}get useAutoPunctuation(){if(!this.LM||!this.kue)return!1;if(this.HXd)return this.e2b;const z=Ha.a.instance.getItem("WACDictationFUseAutoPunctuation");
this.e2b=void 0===z||null===z?this.La.getBooleanAppSetting("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(mh.iHi,this.CU):!1:Boolean.parse(z);this.HXd=!0;return this.e2b}set useAutoPunctuation(z){this.LM&&this.kue&&(this.e2b=z,this.HXd=!0,Ha.a.instance.setItem("WACDictationFUseAutoPunctuation",this.e2b.toString()))}get KUb(){if(!this.LM||!this.Gye)return!1;if(this.JXd)return this.f2b;const z=Ha.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.f2b=void 0===z||null===
z?!0:Boolean.parse(z);this.JXd=!0;return this.f2b}set KUb(z){this.LM&&this.Gye&&(this.f2b=z,this.JXd=!0,Ha.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.f2b.toString()))}get kue(){return Array.contains(mh.jHi,this.CU)}get Gye(){return this.hqb&&Array.contains(mh.Znm,this.CU)}get CU(){""===this.SPa&&(this.SPa=this.bzj());return this.SPa}set CU(z){z&&(this.SPa=z)}get zec(){return this.LM}get LM(){return this.La.getBooleanAppSetting("WacBox4DictationFloatieIsEnabled")}get Dlm(){return this.La.getBooleanAppSetting("WacBox4DictationInternalArticle")}get Reg(){return this.La.Ea("DictationFrontdoorDomain")}get AFd(){return this.La.getBooleanAppSetting("WacBox4DictationUseAugloopService")}get kBg(){return this.La.getBooleanAppSetting("WacBox4DictationCommandsIsEnabled")&&
this.LM}get hqb(){return this.La.getBooleanAppSetting("WacBox4DictationUseAugloopServiceWithFrontdoor")}get khk(){return this.La.getBooleanAppSetting("WacDictationAuthenticationEnabled")}get M6c(){return this.La.getBooleanAppSetting("DictationDebugModeEnabled")}get Dxh(){return this.getSupportedLanguages(0)}get Awh(){return this.getSupportedLanguages(1)}get lhk(){return ba.a.LVh&&this.La.getBooleanAppSetting("UserCanUseDictation")}getSupportedLanguages(z){const Z=[];z=0===z?mh.productionLanguages:
mh.previewLanguages;for(const pa of z)Array.add(Z,new ao(pa));Z.sort((pa,Fa)=>pa.displayName.localeCompare(Fa.displayName));return Z}bzj(){if(this.o7a&&this.Vc){const z=this.o7a.F0c(this.Vc.Ik);for(const Z of this.Dxh)if(Z.LCID===z)return Z.T9c;for(const Z of this.Awh)if(Z.LCID===z)return Z.T9c}return mh.T9i}}Object(k.a)(jn,"DictationSettings",null,[]);class vp{constructor(){this.Zqf=this.Da=null}get name(){return"Box4.Dictation"}fc(z){this.Da=z;const Z=ia.a.instance.ub("Common.IDynamicScriptLoaderProvider");
let pa=null;Z&&(pa=Z.nG);const Fa=ia.a.instance.ze("Box4.Dictation.IDictationHostFactory");this.Da.register(jn,"Box4.Dictation.DictationSettings").ma().na(()=>new jn(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const Ma=ia.a.instance.ze("Common.IDictationFloatieController");this.Da.register(Xk,"Box4.Dictation.DictationFloatieManager").ma().na(()=>new Xk(Ma,this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(oo,
"Box4.Dictation.DictationManager").ma().na(()=>new oo(pa,Fa,this.Da.resolve("Box4.ISelectionManager"),z.Ha("Box4.IBusinessBarController"),z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.ub("Box4.DictationCommands.IDictationCommandManager"),this.Da.ub("Box4.DictationCommands.IDictationCommandParser"),this.Da.ub("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),
this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(1027,"Box4.Dictation.IDictationSessionInfo").ma().na(()=>new Gm)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.Zqf=Al.createInstance(this.Da.ze("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),
this.Da.ze("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Ic.FocusManager.instance());this.Zqf.qb();Eb.App.Ob.Gf()}dispose(){}}Object(k.a)(vp,"DictationPackageManager",null,[2,3]);class Co{constructor(z){this.K=z}S2i(z){return this.K.resolve(z)}}Object(k.a)(Co,"DictationHostFactory",null,[1024]);class Hn{constructor(z,Z,pa){this.mZ=null;this.VG=this.SY=-1;this.nHb=!1;this.BK=z;this.oa=Z;this.ia=pa}vle(){return this.Ppg(!1)}Mpg(){return this.Ppg(!0)}wzc(){this.mZ&&this.HFa();const z=this.oa.Oa.kb;
if(z){const Z=z.Ua;if(Z&&Ng.ParagraphReader.ke(Z.node))return this.mZ=Z.node,this.VG=z.Ua.lSa,this.SY=z.Ua.gvb,this.nHb=!0}return!1}HFa(){this.mZ=null;this.nHb=!1;this.SY=this.VG=-1}aOf(z){if(this.mZ){const Z=new oc.GraphTransaction(15);try{Z.rd(this.mZ);const pa=this.nHb&&this.VG!==this.SY?Ih.a.createTextRange(this.mZ,this.VG,this.SY):Ih.a.rk(this.mZ,this.SY);this.BK.replaceTextRange(pa,z);this.SY=this.nHb?this.VG+z.length:this.SY+z.length;const Fa=Jg.SelectionFactory.fh(this.mZ,this.SY);this.oa.setSelection(Fa);
this.nHb=!1;return!0}finally{Z&&Z.dispose()}}return!1}jyg(z){if(this.mZ){const Z=new oc.GraphTransaction(15);try{Z.rd(this.mZ);const pa=this.VG!==this.SY?Ih.a.createTextRange(this.mZ,this.VG,this.SY):Ih.a.rk(this.mZ,this.SY);this.BK.replaceTextRange(pa,z);this.SY=this.VG+z.length;const Fa=Jg.SelectionFactory.fh(this.mZ,this.SY);this.oa.setSelection(Fa);this.nHb=!1;return!0}finally{Z&&Z.dispose()}}return!1}Lhh(){var z=this.Hzj();this.ia&&z&&z.lSa!==z.gvb&&0<=z.lSa&&(z=Ih.a.createTextRange(z.node,z.lSa,
z.gvb),this.ia.Ia(Hd.a.w5f,2,z))}Hzj(){return this.mZ?this.VG!==this.SY?Ih.a.createTextRange(this.mZ,this.VG,this.SY):Ih.a.rk(this.mZ,this.SY):null}Ppg(z){var Z=this.oa.Oa.kb;if(Z){var pa=Z.Ua;if(pa&&(Z=pa.node,Ng.ParagraphReader.ke(Z)&&(pa=z?pa.gvb:pa.lSa,Z=Ng.ParagraphReader.text(Z),pa<=Z.length)))return z?Z.substring(pa,Z.length):Z.substring(0,pa)}return""}}Object(k.a)(Hn,"DictationHost",null,[1025]);class $k{get name(){return"PowerPointWebEditor.Dictation"}fc(z){z.register(Co,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().na(()=>
new Co(z));z.register(Hn,"PowerPointWebEditor.Dictation.DictationHost").as("Box4.Dictation.IDictationHost").ma().na(()=>new Hn(z.resolve("Box4.ICharacterPropertiesEditor"),z.resolve("Box4.ISelectionManager"),H.AFrameworkApplication.Pa))}init(){}dispose(){}static main(){Qa.a.instance.Ac(new $k)}}Object(k.a)($k,"PPTWebEditorDictationPackage",null,[2,3]);var Im=d(462);class Vm{constructor(z,Z,pa=null){this.id=z.Id;pa||(pa="");this.htl=pa;this.sensitivityLabel=z}}Object(k.a)(Vm,"AutoPolicyLabelData",
null,[]);class Lh{constructor(z,Z){this.A9=z;this.displayName=Z}}Object(k.a)(Lh,"PolicyLabelRequestState",null,[]);class fm{constructor(){this.x6e=this.ySe=""}}Object(k.a)(fm,"PolicyStrings",null,[]);class jl{static get Rye(){return jl.suk}}jl.suk="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(k.a)(jl,"JustificationDialogHtml",null,[]);class Ni extends qb.a{constructor(z,Z){super(!1,!1,Ni.F3);this.MQa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.pKc=null;this.oKc=!1;this.ruk=(pa,Fa)=>{let Ma="";if(1===pa)for(let tb=0;tb<this.MQa.length;tb++)if(Fa[Ni.Z0e+tb]){Ma=tb===this.MQa.length-1?Fa[Ni.sAc]:this.MQa[tb];break}this.IE(pa,this.cLc,Ma)};this.pAh=pa=>{let Fa="";
1===pa&&this.pKc&&(Fa=this.pKc);this.IE(pa,this.cLc,Fa)};this.C6k=pa=>{this.pKc=pa;pa=this.validate();this.oKc!==pa&&(this.oKc=pa,this.l8(CommonUIStrings.l_SensitivityJustificationTitle,this.pAh,this.mng(this.oKc)))};this.J9l=pa=>{pa.target&&this.SF(1,this.validate())};this.Ytd=pa=>{if(pa=pa.target){pa.checked=!0;var Fa=$get(Ni.sAc);pa.id===Ni.Z0e+(this.MQa.length-1)?(Fa.disabled=!1,Sys.UI.DomElement.setVisible(Fa,!0),Fa.focus()):(Fa.disabled=!0,pa.focus());this.SF(1,this.validate())}};this.cLc=z;
this.IE=Z;this.Wg=this.nKi();this.Fd=1;this.Fg=Ni.id;this.Te(1,CommonUIStrings.l_DialogChange);this.SF(1,!1);this.uAa(0)}$$e(){if(Ni.F3)this.Vj(CommonUIStrings.l_SensitivityJustificationTitle,this.pAh,this.mng(this.oKc));else{const z={};for(let Z=0;Z<this.MQa.length;Z++)z[Ni.Z0e+Z]=!1;z[Ni.sAc]="";this.Vj(CommonUIStrings.l_SensitivityJustificationTitle,this.ruk,z);this.p2e();Sc.a.addHandler($get(Ni.sAc),ob.a.input,this.J9l)}}validate(){if(Ni.F3)return this.Y4h(this.pKc);const z=$get(Ni.sAc);return z.disabled?
!0:this.Y4h(z.value)}Y4h(z){const Z=2>z.length,pa=500<z.length,Fa=RegExp("[{|}|;|\\\\]").test(z);z=""===Ob.a.K2e(z);return!Z&&!pa&&!Fa&&!z}mng(z){return{["id"]:this.Fg,["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!z},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,
["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,["onJustificationUpdated"]:this.C6k}}nKi(){return qb.a.oC(Ni.Rye,H.AFrameworkApplication.Mm,Wk.getImageClass(Ni.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.MQa[0],this.MQa[1],this.MQa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}p2e(){const z=document.getElementsByName(Ni.Wwk);for(let Z=0;Z<z.length;Z++)Sc.a.addHandler(z[Z],
ob.a.focus,this.Ytd),Sc.a.addHandler(z[Z],ob.a.click,this.Ytd)}static get F3(){return H.AFrameworkApplication.za.mb.SD&&H.AFrameworkApplication.za.mb.fxe}}Ni.Rye=jl.Rye;Ni.Wwk="ListRadioBox";Ni.Z0e="radiobox";Ni.sAc="txtJustification";Ni.iconName="Info_32x32x32";Ni.id="JustificationDialog";Object(k.a)(Ni,"JustificationDialog",qb.a,[]);class kn extends qb.a{constructor(z,Z,pa){super(!1,!1,!0);this.FVk=(Ma,tb)=>{1===Ma&&tb.selectedLabel&&(Ma=tb.selectedLabel,""!==Ma&&this.Tci(Ma))};if(z&&pa){var Fa=
{["id"]:"MandatoryLabellingDialog"};this.Tci=pa;this.eQd=Z;if(!H.AFrameworkApplication.fa.getBooleanAppSetting("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.eQd&&""!==this.eQd)Fa.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.eQd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};Z={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(Z.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",
["controls"]:z});Fa.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:Z};z={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Fa};Fa.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Fa.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;this.Vj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,this.FVk,z)}else e.ULS.sendTraceTag(560547850,
306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}}Object(k.a)(kn,"MandatoryLabellingDialog",qb.a,[]);class gm{constructor(){this.tsa=!!H.AFrameworkApplication.za&&H.AFrameworkApplication.za.mb.SD}D4i(z,Z,pa){this.tsa&&new kn(z,Z,pa)}static get instance(){return gm.Ja||(gm.Ja=new gm)}}gm.Ja=null;Object(k.a)(gm,"MandatoryLabellingDialogFactory",null,[1106]);class mf{}mf.O5l="sbProtectForm14";mf.Q5l="SBStatusBarMarkAsReadOnly14";mf.fwk="Info_16x16x32";mf.jWf="QuickSearchCompletedToday_16x16x32";
mf.x1e="CommonControlCheckboxCheck_16";mf.DYh="On";mf.visible="Visible";mf.Tpj="ImageIsVisible";mf.uW="SourceControlId";mf.menuItemId="MenuItemId";mf.menu="Menu";mf.GNf="AppLockId";mf.value="Value";mf.labelText="LabelText";mf.alt="Alt";mf.Awg="Image16by16";mf.PCb="Image16by16Class";mf.N5l="SBProtectForm_16";mf.P5l="SBStatusBarMarkAsReadOnly_16";mf.icon="Icon";mf.iconColor="IconColor";mf.customTooltip="CustomTooltip";mf.Gsl="MipTagDynamicFillWithOutline_20";mf.Hsl="MipTagLockDynamicFillWithOutline_20";
mf.Fsl="MipTagErrorOutline_20";mf.Isl="MipTagQuestionOutline_20";mf.NDd="transparent";mf.jfm="UILocation";Object(k.a)(mf,"PolicyConstants",null,[]);class Rj extends qb.a{constructor(z,Z,pa){super(!1,!1,Rj.F3);this.amm=Fa=>{1!==Fa&&this.IE(Fa,this.cLc,"",this.f0)};this.cLc=z;this.f0=Z;this.IE=pa;this.Fd=1;this.Fg=Rj.id;this.uAa(1);this.uAa(0)}Daf(){const z={["id"]:"UserDefinedPermissionsDialog"};Rj.F3&&this.Vj("Defined Permissions",this.amm,z)}static get F3(){return H.AFrameworkApplication.za.mb.SD&&
H.AFrameworkApplication.za.mb.fxe}}Rj.id="UserDefinedPermissionsDialog";Object(k.a)(Rj,"UserDefinedPermissionsDialog",qb.a,[]);var Jm=d(596),Lk=d(123);class Wm{constructor(z,Z,pa,Fa){this.mZb=this.n7a=null;this.qwf=this.QOd=this.pPd=this.VYb=this.Lxf=this.tzf=this.gKd=!1;this.yrb=this.iCa=this.$Ca=this.zPa=this.f0=this.fw=this.Gsa=this.Vi=null;this.dci=this.iId=0;this.GLd=this.sxf=this.uof=this.$Sd=null;this.$ul=()=>{this.QOd&&!this.P6c()&&(this.QOd=!1,this.nk.value.Zul())};this.EVk=Ma=>{this.$be(this.vzf[Ma])};
this.BZe=()=>{if(!this.nk.value.xFg()){var Ma=this.fw[this.Vi.AppliedPolicyId];this.VYb&&this.zPa&&this.yrb!==this.zPa.id&&(!Ma||Ma.Order<this.zPa.sensitivityLabel.Order)&&(Ma=this.x3a(this.zPa.id,{},4),32!==Ma?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+Ma):(this.yrb=this.zPa.id,this.iCa&&(Ma=this.fw[this.iCa])&&Ma.Order<=this.zPa.sensitivityLabel.Order&&(this.nk.value.Tza(29),this.iCa=null)));Ma=this.fw[this.nk.value.zv.AppliedPolicyId];
if(this.$Ca&&this.iCa!==this.$Ca.id&&(!Ma||Ma.Order<this.$Ca.sensitivityLabel.Order)){const tb=this.$Ca.id;this.nk.value.Tza(29);this.nk.value.zNc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.n1c(this.$Ca.sensitivityLabel))+" "+this.$Ca.htl,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.x3a(tb,{},8)});this.iCa=this.$Ca.id}this.$Ca=this.zPa=null}};this.O_i=(Ma,tb,Hb,rc)=>{1===Ma&&this.Qnb(tb,rc)};this.N_i=(Ma,tb,Hb)=>
{1===Ma?this.nfb()?this.x3a(tb,null,2,Hb):this.Qnb(tb===this.Vi.AppliedPolicyId?"":tb,Hb):this.oi.Gf()};this.FIi=Ma=>{1===Ma&&this.nk.value.Mrl()};this.UVc=()=>32;this.dal=(Ma,tb)=>{tb.uu&&this.fw&&(Ma=this.fw[this.nk.value.zv.AppliedPolicyId])&&(this.iCa&&(tb=this.fw[this.iCa])&&tb.Order<=Ma.Order&&(this.nk.value.Tza(29),this.iCa=null),this.yrb&&this.yrb!==Ma.Id&&(this.nk.value.Tza(28),this.yrb=null))};this.Ca=z;this.oi=Z;this.La=pa;this.nk=Fa;this.$Zb={};this.wCf={};this.vzf={};this.k6c=pa.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled");
this.nk.value.n_d(this.BZe);this.nk.value.oMf(this.BZe);this.nk.value.Z2b(this.dal);H.AFrameworkApplication.za&&H.AFrameworkApplication.za.QH(this.$ul);pa.getBooleanAppSetting("SupportsPolicies")&&pa.Ea("AppliedPolicyId")&&(this.n7a=pa.Ea("IrmPolicyTitle"),this.mZb=pa.Ea("IrmPolicyDescription"));this.pai=this.La.tc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.qai=this.La.tc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get nwa(){return H.AFrameworkApplication.nwa||!!this.sxf&&
this.sxf()}qb(){this.Ca.xa(oa.a.iWe,Db.a.frame,this.UVc);this.Ca.pa(oa.a.oOb,Db.a.frame,Object(ib.a)(this,this.oOb,"queryPolicyLabel"),96);this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Ca.xa(oa.a.irh,Db.a.frame,this.UVc),this.Ca.pa(oa.a.uuc,Db.a.frame,Object(ib.a)(this,this.uuc,"queryPolicyShortLabel"),96));this.Ca.xa(oa.a.Epb,Db.a.frame,Object(ib.a)(this,this.Epb,"toggleSensitivity"));this.Ca.xa(oa.a.slb,Db.a.frame,Object(ib.a)(this,this.slb,"populateSensitivityFlyout"));
this.Ca.xa(oa.a.Tnb,Db.a.frame,Object(ib.a)(this,this.Tnb,"setSensitivity"));this.Ca.pa(oa.a.Auc,Db.a.frame,Object(ib.a)(this,this.Auc,"querySensitivity"),96);this.Ca.xa(oa.a.Zlb,Db.a.frame,Object(ib.a)(this,this.Zlb,"querySensitivityToggleButton"));this.Ca.xa(oa.a.Ylb,Db.a.frame,Object(ib.a)(this,this.Ylb,"querySensitivitySubFlyout"));this.x2b(oa.a.Epb)||this.Ca.pe(oa.a.Epb,4);this.x2b(oa.a.slb)||this.Ca.pe(oa.a.slb,4);this.x2b(oa.a.Tnb)||this.Ca.pe(oa.a.Tnb,4);this.x2b(oa.a.Zlb)||this.Ca.pe(oa.a.Zlb,
4);this.x2b(oa.a.Ylb)||this.Ca.pe(oa.a.Ylb,4);this.oi.Gf();H.AFrameworkApplication.fa&&re.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.nk.value.TAl(Object(ib.a)(this,this.JBh,"registerActionsHandler"))}JBh(){this.qb()}e1h(){this.Ca.YI(oa.a.iWe,Db.a.frame,this.UVc);this.Ca.YI(oa.a.oOb,Db.a.frame,Object(ib.a)(this,this.oOb,"queryPolicyLabel"));this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",
!1)&&(this.Ca.YI(oa.a.irh,Db.a.frame,this.UVc),this.Ca.YI(oa.a.uuc,Db.a.frame,Object(ib.a)(this,this.uuc,"queryPolicyShortLabel")));this.Ca.YI(oa.a.Epb,Db.a.frame,Object(ib.a)(this,this.Epb,"toggleSensitivity"));this.Ca.YI(oa.a.slb,Db.a.frame,Object(ib.a)(this,this.slb,"populateSensitivityFlyout"));this.Ca.YI(oa.a.Tnb,Db.a.frame,Object(ib.a)(this,this.Tnb,"setSensitivity"));this.Ca.YI(oa.a.Auc,Db.a.frame,Object(ib.a)(this,this.Auc,"querySensitivity"));this.Ca.YI(oa.a.Zlb,Db.a.frame,Object(ib.a)(this,
this.Zlb,"querySensitivityToggleButton"));this.Ca.YI(oa.a.Ylb,Db.a.frame,Object(ib.a)(this,this.Ylb,"querySensitivitySubFlyout"))}Epb(){return 32}dgg(z){const Z="mandatoryLabelling_"+z.Id;this.vzf[Z]=z.Id;return{["type"]:"AppToggleButtonProps",["id"]:Z,["label"]:z.DisplayName,["hideLabel"]:!1,["customTooltip"]:z.Tooltip}}nfb(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}owe(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)}gFj(){const z=[],Z=this.Gsa;for(const Fa in Z){var pa=Z[Fa];const Ma=this.fw[Fa];if(Ma&&Ma.Enabled&&!Ma.HasUserDefinedPermissions)if(pa.count){const tb={["sections"]:[],["shouldAutoOpen"]:!1},Hb={["id"]:"mandatoryLabelling_flyoutMenuSection_"+Ma.Id,["controls"]:[]};for(const rc of pa)(pa=this.fw[rc])&&pa.Enabled&&!pa.HasUserDefinedPermissions&&Array.add(Hb.controls,this.dgg(pa));Array.add(tb.sections,Hb);Array.add(z,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ma.Id,["label"]:Ma.DisplayName,
["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:tb})}else Array.add(z,this.dgg(Ma))}return z}slb(z,Z,pa,Fa,Ma){if(1===pa||!this.nk.value.fwb(!0))return 32;Ma.MenuItems=Object.assign(new Me.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ma.MenuItems.MenuSectionList,this.STc(!this.isReactRibbonEnabled()));this.Vi.CustomUrl&&Array.add(Ma.MenuItems.MenuSectionList,this.i4i(this.isReactRibbonEnabled()?this.Vi.CustomUrl:Ob.a.Fe(this.Vi.CustomUrl)));this.isReactRibbonEnabled()||
(Ma.PopulationXML=ec.l(Ma.MenuItems));return 32}Auc(z,Z,pa,Fa,Ma){if(1===pa||!Ma||!this.k6c)return 32;this.Vi=this.nk.value.zv;if(this.nk.value.fwb(!0)&&(Ma[mf.visible]=!0,this.Lxf||(he.a("MipLabelsAvailable"),this.Lxf=!0),this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&!this.La.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",!1)&&this.Vi&&this.Vi.AreLabelsAvailable&&(z=ia.a.instance.Ha("Common.ISystemInitiatedFeedback")))){const tb=
Wm.Ta(this.Vi.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";z.execute(Hb=>{Hb.logActivity(tb,null)})}return 32}Zlb(z,Z,pa,Fa,Ma){if(1===pa||!Ma)return 32;let tb,Hb;Ma[mf.DYh]=!!(tb=Ma[mf.menuItemId])&&!!(Hb=this.$Zb[tb])&&Hb===this.Vi.AppliedPolicyId;return 32}Ylb(z,Z,pa,Fa,Ma){if(1===pa||!Ma)return 32;let tb,Hb,rc;z=!!(tb=Ma[mf.uW])&&!!(Hb=this.$Zb[tb])&&!!(rc=this.Gsa[Hb])&&rc.contains(this.Vi.AppliedPolicyId);Ma[mf.Tpj]=z;Ma[mf.DYh]=z;return 32}Tnb(z,
Z,pa,Fa,Ma){if(1===pa||!Ma)return 32;z=this.$Zb[Ma[mf.uW]];Z=this.kfm(Ma[mf.jfm]);pa=new Ye.a;pa.name="SensitivityPickerLocation";pa.int64=Z;he.a("SensitivityPickerUsage",void 0,void 0,[pa]);return this.x3a(z,Ma,2)}P6c(){return!!H.AFrameworkApplication.za&&1===H.AFrameworkApplication.za.mode}$bm(){this.Vi.DefaultLabelId&&this.Vi.MandatoryLabelingEnforced?this.gKd||this.P6c()?this.Vi.AppliedPolicyId?this.$be(""):(this.nk.value.epk(this.nk.value.Xgc)||this.P6c())&&this.b9f():this.JLh():this.Vi.DefaultLabelId?
this.JLh():this.Vi.MandatoryLabelingEnforced&&(this.Vi.AppliedPolicyId?this.$be(""):this.b9f())}qDg(){return this.Vi.MandatoryLabelingEnforced?this.Vi&&this.Vi.AreLabelsAvailable?this.La.getBooleanAppSetting("TestOverrideIsReactDialogEnabled")||this.oi&&this.oi.mb&&this.oi.mb.SD?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(e.ULS.sendTraceTag(539109063,
306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}b9f(){!this.qDg()||H.AFrameworkApplication.TR||this.tzf||(this.tzf=H.AFrameworkApplication.TR=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.nk.value.lzh("",1),this.nk.value.jZd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.DVk()}))}$be(z){this.qDg()&&
H.AFrameworkApplication.TR&&(H.AFrameworkApplication.TR=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.nk.value.T2e(),this.nk.value.lzh(z,2))}DVk(){gm.instance.D4i(this.gFj(),this.Vi.CustomUrl,this.EVk)}FQf(){return this.La.getBooleanAppSetting("CoAuthForProtectedFilesEnabled")&&this.La.getBooleanAppSetting("SupportsOfficeClientCoauthoring")&&this.La.getBooleanAppSetting("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.GLd&&this.nwa}x3a(z,Z,pa,Fa=
null){this.nk.value.brl(pa);let Ma=32,tb=!1,Hb=!0;const rc=2===pa||8===pa||16===pa,yc=z===this.Vi.AppliedPolicyId;if(this.uof&&this.uof(z,rc))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",pa),this.oi.Gf();else if(Z&&mf.GNf in Z&&this.nk.value.d8e(Z[mf.GNf]),z)if(this.nk.value.xFg()||this.FQf()&&this.pPd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",
pa),this.oi.Gf(),rc&&this.VOc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.La.getBooleanAppSetting("HasDocumentEditRights"))if(this.nk.value.ZPi(z))if(!this.nfb()&&this.fw[z]&&this.fw[z].HasUserDefinedPermissions&&!yc)e.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",pa),1!==pa&&4!==pa&&this.UCi();else if(rc&&this.Vi.MandatoryLabelingEnforced&&yc)e.ULS.sendTraceTag(570972054,
306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",pa),this.VOc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(rc&&this.La.getBooleanAppSetting("WacLabelingJustificationDialogIsEnabled")&&this.Vi.RequiredDowngradeJustification&&(yc||this.fw[z].RequiredDowngradeJustification)&&(this.nfb()?!this.qwf&&!Fa:!this.f0))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",
pa),this.$$e(z),Ma;if(this.nfb()&&this.fw[z].HasUserDefinedPermissions&&!yc)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",pa),this.Daf(z,Fa),Ma;if(this.FQf()&&!this.GLd())this.iId<this.pai?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.iId,pa),this.pPd=!0,this.iId++,fg.Task.delay(this.qai).continueWith(()=>{this.pPd=!1;this.x3a(z,Z,pa)})):(e.ULS.sendTraceTag(577356771,306,
15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",pa),tb=1!==pa,Hb=!1,Ma=8);else{if(this.knk(z)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",pa),1===pa||8===pa||4===pa))return Ma;e.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",pa);this.Qnb(yc?"":z,this.nfb()?Fa:this.f0,pa);return Ma}}else e.ULS.sendTraceTag(42796169,
306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",pa),this.oi.Gf(),rc&&this.VOc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",pa),this.oi.Gf(),rc&&this.VOc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);
else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",pa),this.oi.Gf(),tb=rc,Hb=!1,Ma=8;this.nk.value.Mzh(0,pa,tb,Hb);return Ma}GOf(z,Z,pa=null,Fa=!1){m.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.La.getBooleanAppSetting("SupportsOfficeClientCoauthoring")&&this.La.getBooleanAppSetting("CoAuthForProtectedFilesIsEnabled")?(this.VYb=!1,(this.Vi=this.nk.value.zv)&&!this.Vi.AppliedPolicyId?
this.VYb=!0:this.Vi&&this.Vi.PolicyLabelAssignmentMethod&&(this.VYb=Lk.e(this.Vi.PolicyLabelAssignmentMethod)===Lk.e("standard"))):this.VYb=Fa;z=Wm.Ta(z)?null:this.fw[z];(Z=Wm.Ta(Z)?null:this.fw[Z])?this.$Ca=new Vm(Z,!0,pa):(this.nk.value.Tza(29),this.iCa=null);z?this.zPa=new Vm(z,!1):this.yrb=null;this.BZe(null,null)}HEi(z){this.x3a(z,null,16)}KQl(){this.fw={};if(this.Vi=this.nk.value.zv)for(const z of this.Vi.SensitivityLabels)this.fw[z.Id]=z}knk(z){if(this.Gsa&&z in this.Gsa){z=this.Gsa[z];for(const Z of z)if((z=
this.fw[Z])&&z.Enabled)return!0}return!1}iSl(){this.Gsa={};if(this.Vi=this.nk.value.zv){for(const z of this.Vi.SensitivityLabels)z.ParentId||(this.Gsa[z.Id]=new Ta.a);for(const z of this.Vi.SensitivityLabels)z.ParentId&&z.ParentId in this.Gsa&&z.Enabled&&this.Gsa[z.ParentId].add(z.Id)}}eol(){this.Vi=this.nk.value.zv;const z=this.k6c&&this.isReactRibbonEnabled()&&this.nk.value.fwb();Wm.Lvd(z)}mwl(z){this.GLd=z}JLh(){if(this.La.getBooleanAppSetting("WacApplyDefaultPolicyLabelIsEnabled"))if(this.P6c())this.QOd=
!0;else if(!this.gKd&&(this.gKd=!0,(this.Vi=this.nk.value.zv)&&this.Vi.DefaultLabelId))if(!this.Vi.AppliedPolicyId)e.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Vi.DefaultLabelType),this.x3a(this.Vi.DefaultLabelId,null,1);else if(r.a.gl().equals(this.Vi.DefaultLabelType,"documentLibraryDefault")){const z=this.fw[this.Vi.AppliedPolicyId],Z=this.fw[this.Vi.DefaultLabelId];this.Vi.AppliedPolicyId!==this.Vi.DefaultLabelId&&r.a.gl().equals(this.Vi.PolicyLabelAssignmentMethod,
"standard")&&z.Order<Z.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Vi.DefaultLabelType),this.x3a(this.Vi.DefaultLabelId,null,1))}}Qnb(z,Z,pa=2){this.nfb()?Z&&(this.qwf=!0):this.f0=Z;this.nk.value.Qnb(z);this.oi.Gf();pa=new Lh(pa,this.n1c(this.fw[z]));this.nk.value.p8e(z,this.nfb()?Z:this.f0,pa)}$$e(z){(new Ni(z,this.N_i)).$$e()}Daf(z,Z){(new Rj(z,Z,this.O_i)).Daf()}VOc(z="",Z=""){const pa=new Vb.StandardDialog;pa.Is=H.AFrameworkApplication.Rfa;
pa.Fd=0;pa.Te(1,CommonUIStrings.l_DialogClose);pa.vQ(z,Z,null)}UCi(){const z=new Vb.StandardDialog;z.Is=H.AFrameworkApplication.Rfa;z.Fd=1;z.Te(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);z.Te(0,CommonUIStrings.l_DialogClose);z.vQ(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,this.FIi)}isReactRibbonEnabled(){return!!this.oi&&!!this.oi.mb&&this.oi.mb.Xp}AEb(){return this.oi&&this.oi.mb?this.oi.mb.AEb:!1}FSl(z,Z,pa,Fa){z?(Fa[mf.value]=
z,Fa[mf.labelText]=z,Fa[mf.customTooltip]=Z,this.pMh(pa,H.AFrameworkApplication.Tw,Fa)):(Fa[mf.iconColor]=mf.NDd,this.Vi.MandatoryLabelingEnforced?(Fa[mf.value]=Fa[mf.labelText]=this.t1c().x6e,Fa[mf.icon]=mf.Fsl):(Fa[mf.value]=Fa[mf.labelText]=this.t1c().ySe,Fa[mf.icon]=mf.Isl));Fa[mf.visible]=!0}fRl(z){let Z="",pa="",Fa="";if(this.Vi.AreLabelsAvailable){let Ma=null;this.fw&&(Ma=this.fw[this.Vi.AppliedPolicyId]);Ma&&(Z=this.n1c(Ma),pa=Ma.Tooltip,H.AFrameworkApplication.Tw=this.nk.value.afb(Ma),Fa=
this.yge(Ma));if(!this.nk.value.fwb()&&!Ma)return}else{if(!this.n7a)return;Z=this.n7a;Fa=mf.NDd;pa=this.mZb?this.mZb:""}this.FSl(Z,pa,Fa,z)}oOb(z,Z,pa,Fa,Ma){if(1===pa)return 32;this.Vi=this.nk.value.zv;if(!this.Vi||!Ma)return 32;Ma[mf.value]="";Ma[mf.labelText]="";Ma[mf.alt]=null;Ma[mf.Awg]=null;Ma[mf.PCb]=null;Ma[mf.customTooltip]="";Ma[mf.visible]=!1;Ma[mf.iconColor]="";Ma[mf.icon]="";if(this.owe())this.fRl(Ma);else{pa=Z=z="";if(!this.Vi.AreLabelsAvailable){if(!this.n7a)return 32;z=this.n7a;pa=
mf.NDd;this.mZb&&(Z=this.mZb)}else if(this.Vi.AppliedPolicyId){Fa=null;for(const tb of this.Vi.SensitivityLabels)if(tb.Id.toLowerCase()===this.Vi.AppliedPolicyId.toLowerCase()){Fa=tb;break}Fa&&(z=this.n1c(Fa),Z=Fa.Tooltip,H.AFrameworkApplication.Tw=this.nk.value.afb(Fa),pa=this.yge(Fa))}z&&(Ma[mf.value]=z,Ma[mf.labelText]=z,this.AEb()?Ma[mf.customTooltip]=Z:Ma[mf.alt]=Z,this.pMh(pa,H.AFrameworkApplication.Tw,Ma),Ma[mf.visible]=!0)}return 32}uuc(z,Z,pa,Fa,Ma){if(1===pa)return 32;this.Vi=this.nk.value.zv;
if(!this.Vi||!Ma)return 32;Ma[mf.labelText]="";if(this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.Vi.HideBarByDefault)return 32;z="";if(this.Vi.AreLabelsAvailable)if(this.Vi.AppliedPolicyId){if(!this.fw)return 32;(Z=this.fw[this.nk.value.zv.AppliedPolicyId])&&(z=Z.ParentId&&this.fw[Z.ParentId]?this.fw[Z.ParentId].DisplayName:Z.DisplayName)}else z=this.Vi.MandatoryLabelingEnforced?this.t1c().x6e:this.t1c().ySe;else{if(!this.n7a)return 32;z=this.n7a}Ma[mf.labelText]=
z;return 32}n1c(z){return z?this.fw?z.ParentId&&this.fw[z.ParentId]?this.fw[z.ParentId].DisplayName+"\\"+z.DisplayName:z.DisplayName:(e.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),z.DisplayName):""}pMh(z,Z,pa){this.owe()?(pa[mf.icon]=this.Fpg(Z),pa[mf.iconColor]=this.Gpg(z)):this.AEb()?pa[mf.icon]=Z?mf.N5l:mf.P5l:(pa[mf.Awg]=H.AFrameworkApplication.Mm,pa[mf.PCb]=Z?Wk.getImageClass(mf.O5l):Wk.getImageClass(mf.Q5l))}i4i(z){const Z=this.eu("LearnMoreSection",
!0);z=Object.assign(new Ab.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:z,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:H.AFrameworkApplication.Mm,Image16by16Class:Wk.getImageClass(mf.fwk),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(Z.ControlList,z);return Z}v2f(z,Z,pa=!1){let Fa;Fa="Toggle_"+z.Id;Fa="Sensitivity_"+Fa;const Ma=z.DisplayName,tb=z.Tooltip;var Hb=z.Id===this.Vi.AppliedPolicyId,rc=pa?Ob.a.Fe(Fa):Fa;this.owe()?
(Hb=this.yge(z),Z=Object.assign(new Ae.a,{Id:rc,ExternalId:rc,LabelText:pa?Ob.a.Fe(Ma):Ma,Command:"2935633379",MenuItemId:rc,QueryCommand:"991261903",Visible:!0,Alt:pa?Ob.a.Fe(tb):tb,AriaLabel:ic.a.gwb,IconColor:this.Gpg(Hb),KeyTip:Z}),Z.ExternalImageId=this.Fpg(this.nk.value.afb(z))):(rc=Object.assign(new Jm.a,{Id:rc,ExternalId:rc,LabelText:pa?Ob.a.Fe(Ma):Ma,Command:"2935633379",MenuItemId:rc,QueryCommand:"991261903",CheckedImage:H.AFrameworkApplication.Mm,Visible:!0,Alt:pa?Ob.a.Fe(tb):tb,IsChecked:Hb,
AriaLabel:ic.a.gwb,KeyTip:Z}),this.isReactRibbonEnabled()?(rc.CheckedImageClass=Wk.getImageClass(mf.x1e),rc.ExternalImageId=mf.x1e):rc.CheckedImageClass=Wk.getImageClass(mf.jWf),Z=rc);rc=Fa;this.$Zb[rc]=z.Id;this.wCf[z.Id]=rc;return Z}eu(z,Z=!1){return Object.assign(new Bg.a,{Title:"",Id:z,DisplayMode:mf.menu,ShowMenuSectionSeparator:Z,ControlsId:"Ctrl_"+z,ControlList:[]})}q7i(z,Z,pa){z=this.eu(z+"Sub");let Fa=1;for(const Ma of Z)(Z=this.fw[Ma])&&Z.Enabled&&(Array.add(z.ControlList,this.v2f(Z,Fa.toString(),
pa)),Fa++);return z}STc(z=!1){const Z=this.eu("SensitivitySection");let pa=1;const Fa=this.Gsa;for(const tb in Fa){const Hb=Fa[tb],rc=this.fw[tb];if(rc&&rc.Enabled){if(Hb.count){var Ma="Sensitivity_"+rc.Name;z&&Ob.a.Fe(Ma);Ma="Label"+this.dci++;const yc=Object.assign(new fb.a,{Id:Ma,ExternalId:Ma,LabelText:z?Ob.a.Fe(rc.DisplayName):rc.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new Me.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,
ImageUsesSpaceWhileInvisible:!0,AriaLabel:ic.a.gwb,KeyTip:pa.toString(),Alt:z?Ob.a.Fe(rc.Tooltip):rc.Tooltip});this.isReactRibbonEnabled()?yc.ExternalImageId=mf.x1e:(yc.Image16by16=H.AFrameworkApplication.Mm,yc.Image16by16Class=Wk.getImageClass(mf.jWf));Array.add(yc.Menu.MenuSectionList,this.q7i(Ma,Hb,z));Array.add(Z.ControlList,yc);this.$Zb[yc.Id]=rc.Id;this.wCf[rc.Id]=yc.Id}else Array.add(Z.ControlList,this.v2f(rc,pa.toString(),z));pa++}}return Z}x2b(z){return!!this.Ca.RU(z)&&!!this.Ca.RU(z).flags&&
!!this.Ca.RU(z).flags.length}Fpg(z){return z?mf.Hsl:mf.Gsl}Gpg(z){return z?z:mf.NDd}yge(z){if(z.Color||!z.ParentId)return z.Color;const Z=this.fw[z.ParentId];return Z?Z.Color:z.Color}kfm(z){switch(z){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}t1c(){this.$Sd||(this.$Sd=Object.assign(new fm,{ySe:HeaderStrings.NoSensitivityLabel,x6e:HeaderStrings.SelectASensitivityLabel}));return this.$Sd}static hkm(){H.AFrameworkApplication.fa&&!H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)||!re.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",!0))}static Lvd(z){re.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!z))}static Ta(z){return z&&z.length?!1:!0}}Object(k.a)(Wm,"PolicyActor",null,[1082]);var Vq=d(1266),Vi;(function(z){z[z.unknown=0]="unknown";z[z.boot=1]="boot";z[z.refresh=2]="refresh";z[z.xDm=3]="selfSetPolicyLabel"})(Vi||(Vi={}));Object(k.b)("GetPolicyLabelsReason",Vi);class al extends Sys.EventArgs{constructor(z,
Z,pa,Fa,Ma,tb){super();this.Mwb=z;this.title=Z;this.message=pa;this.buttonText=Fa;this.w4b=Ma;this.z8c=tb}}Object(k.a)(al,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Km extends Sys.EventArgs{constructor(z,Z,pa,Fa,Ma){super();this.Mwb=z;this.title=Z;this.message=pa;this.buttonText=Fa;this.w4b=Ma}}Object(k.a)(Km,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Bl;(function(z){z[z.none=0]="none";z[z.uCm=1]="reasonDefaultLabel";z[z.wCm=2]="reasonManual";z[z.tCm=
4]="reasonAutomatic";z[z.xCm=8]="reasonRecommended";z[z.vCm=16]="reasonMandatory"})(Bl||(Bl={}));Object(k.b)("ApplyLabelFlags",Bl);class Xj extends Sys.EventArgs{constructor(z,Z,pa){super();this.aYf=z;this.$Xf=Z;this.existingLabelPriority=pa}}Object(k.a)(Xj,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Xm extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Xm,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Vl extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Vl,"GetPolicyLabelFailureEventArgs",
Sys.EventArgs,[]);class Mh{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=
this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl="";this.HideBarByDefault=!1}}Object(k.a)(Mh,"GetPolicyLabelsData",null,[]);class In extends Sys.EventArgs{constructor(z=!1){super();this.uu=z}}Object(k.a)(In,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Cl extends Sys.EventArgs{constructor(z,Z){super();this.Yfh=z;this.Z_d=Z}}Object(k.a)(Cl,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Dl extends Sys.EventArgs{constructor(z,Z,pa,
Fa){super();this.title=z;this.ygl=Z;this.buttonText=pa;this.l3k=Fa}}Object(k.a)(Dl,"PolicyTipEventArgs",Sys.EventArgs,[]);class Do extends Sys.EventArgs{constructor(z,Z){super();this.Mwb=z;this.z8c=Z}}Object(k.a)(Do,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class qo extends Sys.EventArgs{constructor(){super()}}Object(k.a)(qo,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Be extends Sys.EventArgs{constructor(z,Z){super();this.Ouh=z;this.A9=Z}}Object(k.a)(Be,
"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class Lm extends Sys.EventArgs{constructor(z,Z,pa,Fa=null,Ma=null,tb=null,Hb=null){super();this.errorType=z;this.R0l=pa;this.title=Fa;this.message=Ma;this.buttonText=tb;this.w4b=Hb}}Object(k.a)(Lm,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Ii extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Ii,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class $o extends Sys.EventArgs{constructor(z){super();this.kYl=z}}Object(k.a)($o,"UDPLabelingAppHandlerEventArgs",
Sys.EventArgs,[]);var Eo=d(707);class Dc{static $Pl(z,Z){if(!z||!Z||z.count!==Z.count)return!1;for(const pa of z)if(!Z.contains(pa))return!1;return!0}static toArray(z){if(!z)return null;const Z=Array(z.count);let pa=0;for(const Fa of z)Z[pa]=Fa,pa++;return Z}}Object(k.a)(Dc,"HashSetUtils",null,[]);var Kj=d(621),Sj=d(320);class un{constructor(z,Z,pa,Fa=0,Ma=null){this.cKd=this.Srf=null;this.RRa=this.$Xb=this.aYb=0;this.ada="";this.y8a=this.Kxf=this.XHd=this.SNd=this.TBa=this.sQd=null;this.swf=!1;this.J5a=
null;this.$Md=0;this.UJc=this.B8a=this.F6a=this.TJc=null;this.Ma=new Hk.a;this.Cxc=this.Kac=this.XT=null;this.NNd=!1;this.Xgc=null;this.L1d=tb=>{if(!this.dFg){var Hb=tb.yN.task;Hb.continueWith(()=>{this.XT=Hb.result;this.XT.fEa(this.I6k)})}};this.I6k=(tb,Hb)=>{12===Hb.type&&(this.Kxf?this.Kxf():this.JVa(this.ada,2,this.TBa,!0))};this.La=z;this.Bi=Z;this.Di=pa;this.zIc=Fa;this.zv=new Mh;this.vCf=this.La.Ea("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.AH=Ma;this.k6c=z.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled");
this.rec=z.getBooleanAppSetting("CoAuthForProtectedFilesIsEnabled");this.$ob=z.getBooleanAppSetting("SupportsOfficeClientCoauthoring");this.gqk=!1;this.qSl=3E4;this.je=Yf.a.instance;z.getBooleanAppSetting("SupportsPolicies")&&he.a("MipSupportsPolicies");this.rec&&this.$ob&&he.a("MipSupportsOfficeClientCoauthoring")}get jue(){return this.NNd}$zi(z){this.Ma.addHandler("PolicyTipEvent",z)}Z2b(z){this.Ma.addHandler("LabelInfoUpdateEvent",z)}TAl(z){this.Ma.removeHandler("LabelInfoUpdateEvent",z)}n_d(z){this.Ma.addHandler("SetPolicyLabelEventKey",
z)}wEh(z){this.Ma.removeHandler("SetPolicyLabelEventKey",z)}oMf(z){this.Ma.addHandler("SetPolicyLabelFailureEventKey",z)}Uxi(z){this.Ma.addHandler("GetAutoPolicyLabelEventKey",z);this.jue&&(e.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.g1e(new Xm(0)))}Exi(z){this.Ma.addHandler("CreateAutoCLPSecurityNodesEventKey",z)}kBi(z){this.Ma.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",z)}lBi(z){this.Ma.addHandler("UpdateAutoCLPSITNodesEventKey",
z)}hxi(z){this.Ma.addHandler("AddAutoPolicyBusinessBarEntryEventKey",z)}lAi(z){this.Ma.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",z)}ixi(z){this.Ma.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",z)}mAi(z){this.Ma.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}nyi(z){this.Ma.addHandler("MandatoryLabellingAppHandlerEventKey",z)}iBi(z){this.Ma.addHandler("UDPLabelingAppHandlerEventKey",z)}get hik(){if(!this.Srf)return!1;for(const z of this.Srf.Kfe())if(!z.Capabilities||
!z.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get dFg(){return!!this.XT}c9j(z){z&&this.rec&&this.$ob&&z.execute(this.L1d)}Twl(z){this.SNd=z}lSi(){return this.SNd?this.SNd():!1}Hvl(z){this.XHd=z}IG(){return(new Date).getTime()}dhe(){this.Di&&(this.TJc=this.Di.lj("WebServiceCall","Call Get Policy Endpoint On Server"));var z=Kj.a.ZEa(1,1);this.La.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Eo.a(this.FBb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,z),this.Bi.send(z).qmb(Object(ib.a)(this,this.dmh,"onDataLossPolicySuccessCallback"),Object(ib.a)(this,this.cmh,"onDataLossPolicyFailureCallback"))):this.Bi.Tj(this.FBb("datalosspolicy"),1,null,null,!0,2,Object(ib.a)(this,this.dmh,"onDataLossPolicySuccessCallback"),Object(ib.a)(this,this.cmh,"onDataLossPolicyFailureCallback"),null);this.aYb++;e.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",
this.vCf,this.aYb)}Zul(){this.JVa(this.ada,2,this.TBa)}JVa(z,Z=0,pa=null,Fa=!1){m.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.ohe(void 0,Z));this.Kac=this.IG();const Ma=this.N7d(Z);this.G_c(z,Ma,pa,Fa,Z);this.j4e(!0)}dmh(z){this.Nuh();let Z="";({data:Z}=this.Zff(z)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.aYb=0,this.Di&&(this.UJc=this.Di.lj("Task","Parse and Handle Get Policy Response")),this.ydl(Z),
this.UJc&&(this.UJc.stop(),this.UJc=null))}cmh(z){this.Nuh();this.aYb<=this.zIc?this.dhe():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",z?z.data?z.data.NPb:null:null),this.aYb=0)}xFg(){return 0<this.RRa}Qnb(z){this.zv.AppliedPolicyId=z}p8e(z,Z,pa=null){const Fa=this.P3i(pa);this.pSl(z,Z,Fa,pa)}rph(z){this.B8a&&(this.B8a.stop(),this.B8a=null);const {gKh:Z,TMh:pa}=this.jog(z),Fa=z.data.state,Ma=Fa?Fa.A9:2;let tb="";({data:tb}=this.Zff(z)).returnValue?
(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Ma),this.RRa=0,this.gel(tb,Z,pa,Fa)):this.m5e(Ma)}brl(z){m.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.ohe(z));this.Cxc=this.IG();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Ma.raiseEvent("SetPolicyLabelTriggeredEventKey",new Ii(z))}R0k(){this.rec&&this.$ob&&this.dFg&&this.XT.gca(12,null,!0)}qph(z){this.B8a&&(this.B8a.stop(),this.B8a=
null);const {gKh:Z,TMh:pa}=this.jog(z);if(this.RRa<=this.zIc)this.p8e(Z,pa);else{var Fa=z.data.state;Fa=Fa?Fa.A9:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",z?z.data?z.data.NPb:null:null,Fa);this.Xgc="WACServerConnectionFailed";this.RRa=0;this.m5e(Fa)}}epk(z){if(z&&("LabelNotSupported"===z||"LabelErrorRetryLater"===z||"CoherencyFailure"===z||"LabelIdNotFound"===z||"LabelDisabled"===z))return e.ULS.sendTraceTag(539103556,306,
50,"LabelError is retriable: {0}",z),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",z);return!1}afb(z){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPAsProtectedLabelEnabled",!1)?z.IsEndpointProtectionEnabled||z.HasUserDefinedPermissions:z.IsEndpointProtectionEnabled}ZPi(z){if(!z)return!1;let Z=null,pa=null;for(const Fa of this.zv.SensitivityLabels)Fa.Id===z&&(Z=Fa),Fa.Id===this.ada&&(pa=Fa);if(!Z)return!1;if(this.rec&&this.$ob){if(this.XHd&&this.XHd()||
this.hik)return!0}else if(H.AFrameworkApplication.jC&&H.AFrameworkApplication.jC.iGa||this.TBa&&this.TBa())return!0;return this.afb(Z)===(!!pa&&this.afb(pa))}zNc(z,Z,pa,Fa,Ma){28===z?this.Xyh(new al(z,Z,pa,Fa,Ma,!1)):this.Xyh(new al(z,Z,pa,Fa,Ma,!0))}Tza(z){28===z?this.Czh(new Do(z,!1)):this.Czh(new Do(z,!0))}upl(z,Z,pa){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.Ma.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Xj(z,Z,pa))}Prl(z){e.ULS.sendTraceTag(545280778,
306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Ma.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new Xj(null,null,z))}Qrl(z,Z){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Ma.raiseEvent("UpdateAutoCLPSITNodesEventKey",new Xj(z,Z,null))}lzh(z,Z){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===Z?"Reading":"Edit")+" switch event.");this.Ma.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Cl(z,Z))}jZd(z,Z,pa,Fa,Ma){37===
z&&this.Wol(new Km(37,Z,pa,Fa,Ma))}T2e(){this.Kql(new qo)}Mrl(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Ma.raiseEvent("UDPLabelingAppHandlerEventKey",new $o(!0))}fwb(z=!1){const Z=!!this.zv&&this.zv.AreLabelsAvailable&&!!this.zv.SensitivityLabels&&0<this.zv.SensitivityLabels.length&&Pg.a.any(this.zv.SensitivityLabels,pa=>!!pa&&pa.Enabled);Z||z||Wm.Lvd(!1);return Z}enh(z){this.F6a&&(this.F6a.stop(),this.F6a=null);var Z="";this.j4e(!1);({data:Z}=this.Zff(z)).returnValue?
(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.$Xb=0,Z=this.Qdl(Z),z=this.Nmg(z.data),m.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.xZc(void 0,z,this.Kac)),this.Kac=null,z=new Xm(z),this.Ppl(z),this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?Z&&this.QWl()?this.jue?this.Wgm():(this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.rTc(),this.g1e(z),this.NNd=
!0):Z||this.lud():!this.jue&&Z&&this.La.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&this.qPf()?(this.g1e(z),this.NNd=!0):Z||this.lud()):this.lud()}QWl(){if(!this.La.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.qPf())return!1;if(""===this.ada)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),
!0;if(this.J5a===this.$Md)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}rTc(){this.E1h();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.y8a.count,this.J5a);const z=Dc.toArray(this.y8a);this.upl(z,
z,this.J5a)}Wgm(){var z=this.y8a;this.E1h();Dc.$Pl(z,this.y8a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.y8a.count),z=Dc.toArray(this.y8a),this.Qrl(z,z));this.swf&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.J5a),this.Prl(this.J5a))}E1h(){const z=new Vq.a(r.a.gl());for(const Z of this.zv.SensitivityLabels)if(Z&&Z.AutoLabelingSensitiveTypeIds&&0<Z.AutoLabelingSensitiveTypeIds.length)for(const pa of Z.AutoLabelingSensitiveTypeIds)pa&&
z.add(pa);this.y8a=z}dnh(z){const Z=this.Nmg(z.data);m.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.xZc(void 0,Z,this.Kac));this.Kac=null;this.F6a&&(this.F6a.stop(),this.F6a=null);if(this.$Xb<=this.zIc){if(this.La.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")){const pa=z.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in pa&&pa[Kj.a.exd]&&"HostAttributionInfo.ScenarioTypeParamName"in pa&&pa[Kj.a.Swc]){z.data.request.get_headers();
z.data.request.get_headers()[Kj.a.Swc];z=this.N7d(Z);this.G_c(this.ada,z,this.TBa,void 0,Z);return}}this.JVa(this.ada,Z,this.TBa)}else e.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",z?z.data?z.data.NPb:null:null),this.lud(),this.$Xb=0,this.j4e(!1)}Nmg(z){return z.state?z.state:0}FBb(z,Z=!1){let pa=String.format("{0}{1}?action={2}&{3}",this.La.Ea("PolicyHandlerWebServiceBase")||H.AFrameworkApplication.za.mb.yha,this.vCf,z,H.AFrameworkApplication.mh);
"setpolicylabel"===z&&H.AFrameworkApplication.jC&&H.AFrameworkApplication.jC.tve&&(pa=C.a.Xi(pa,"sl","1"));Z&&(pa=C.a.Xi(pa,"cbd","1"));return pa}jog(z){let Z,pa;Z=pa=null;z&&z.data&&z.data.request&&z.data.request.get_headers()&&(Z=z.data.request.get_headers()[Sj.a.hKh],pa=z.data.request.get_headers()[Sj.a.UMh]);return{gKh:Z,TMh:pa}}Zff(z){z=z?z.data?z.data.Ud:null:null;return z&&z.length&&!this.cqk(z)?{returnValue:!0,data:z}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),
{returnValue:!1,data:z})}ydl(z){let Z;try{Z=W.b(z)}catch(pa){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(Z)if(Z.IsPolicyTipAvailable)switch(Z.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.cKd=Z.NavigateUrl;this.i1l(Z.GeneralText,
Object(ib.a)(this,this.j4k,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",Z.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else e.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}F0i(z){switch(z){case "CoherencyFailure":return 1;
case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}gel(z,Z,pa,Fa){var Ma=Fa?Fa.A9:2;
let tb=0,Hb="",rc;if(({Ev:rc}=W.d(z)).returnValue)if(rc){Hb="Success";z=this.N7d(3);if(rc.IsSuccessful){m.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.xZc(Ma,void 0,this.Cxc));this.Xgc=this.Cxc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ma);2===Ma&&this.Tza(29);this.mTl(Z,Ma);this.R0k();this.Tza(28);Fa&&4===Ma&&this.zNc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,
Fa.displayName),CommonUIStrings.l_DialogOk,()=>{});he.a("MipAppliedLabels",void 0,void 0,[Object.assign(new Ye.a,{name:"SetPolicyLabelApplyFlag",string:Bl[Ma]})]);this.G_c(Z,z,this.TBa,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",Ma,rc.FailureReason);this.Xgc=rc.FailureReason;tb=this.F0i(rc.FailureReason);this.gqk&&0<=rc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&
(Fa=new ee.a(2,1,this.qSl,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.RRa);this.RRa<=this.zIc&&this.p8e(Z,pa)}),this.je.Jb(Fa));this.rec&&this.$ob&&this.G_c(this.zv.AppliedPolicyId,z,this.TBa,!0,3)}else Hb="setPolicyLabelData null.",e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ma);else Hb="TryDeserialize failed.",
e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ma);this.m5e(Ma,tb);Ma=this.xZc(Ma,void 0,this.Cxc);this.Cxc=null;Ma.extendedProperties.set("SetPolicyLabelDataFailureReason",this.Xgc);Ma.extendedProperties.set("SetPolicyLabelDataParseStatus",Hb.toString());m.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Ma)}m5e(z,Z=0){const pa=2===z||8===z||16===z;this.Qnb(this.ada);this.jzh(new In);this.Mzh(Z,z,
pa,!1)}mTl(z,Z){this.Qnb(this.ada=z);if(""===z)H.AFrameworkApplication.Tw=!1,H.AFrameworkApplication.N8b=!1;else for(const pa of this.zv.SensitivityLabels)if(pa.Id===z){H.AFrameworkApplication.Tw=this.afb(pa);break}this.$ql(new Be(z,Z))}Oim(){for(const z of this.zv.SensitivityLabels)z&&z.Enabled&&(z.Id===this.ada&&(this.swf=this.J5a!==z.Order,this.J5a=z.Order),z.Order>this.$Md&&(this.$Md=z.Order))}Qdl(z){if(!({Ev:z}=W.d(z)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),
!1;if(!z)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!z.AreLabelsAvailable)return!1;this.zv=z;this.ada=z.AppliedPolicyId;this.La.appSettings&&(this.La.appSettings.AppliedPolicyId=this.ada);this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.Oim();this.fwb()&&e.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.jzh(new In(!0));return!0}qPf(){if(!this.fwb())return e.ULS.sendTraceTag(539877699,
306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const z of this.zv.SensitivityLabels)if(z&&z.AutoLabelingSensitiveTypeIds&&0<z.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}jzh(z){e.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Ma.raiseEvent("LabelInfoUpdateEvent",z)}Ppl(z){e.ULS.sendTraceTag(50676305,
306,50,"Raising get policy label event.");this.Ma.raiseEvent("GetPolicyLabelEventKey",z)}lud(){Wm.Lvd(!1);this.Ma.raiseEvent("GetPolicyLabelFailureEventKey",new Vl)}g1e(z){this.AH&&this.AH.execute(Z=>{Z=[Z.isFeatureEnabled("MsoClpSpTwo",!0),Z.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(Z).then(pa=>{Pg.a.any(pa,Fa=>Fa)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Ma.raiseEvent("GetAutoPolicyLabelEventKey",z),this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",
!1)&&this.rTc(),he.a("MipAutoClassificationEnabled"));return null})})}ohe(z=null,Z=null){const pa=new Map;pa.set("ClpCoauth",this.$ob.toString());null!=z&&pa.set("ApplyLabelFlags",Bl[z]);null!=Z&&pa.set("GetPolicyLabelsReason",Vi[Z]);return pa}xZc(z=null,Z=null,pa=null){const Fa=new sa.a;Fa.extendedProperties=this.ohe(z,Z);null!=pa&&(Fa.durationMs=this.IG()-pa);return Fa}$ql(z){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Ma.raiseEvent("SetPolicyLabelEventKey",z)}Xyh(z){e.ULS.sendTraceTag(51128227,
306,50,"Raising an add auto policy business bar entry event.");z&&z.z8c&&he.a("MipRecommendations");this.Ma.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",z)}Czh(z){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Ma.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",z)}Wol(z){e.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Ma.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",
z)}Kql(z){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.Ma.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}i1l(z,Z=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Ma.raiseEvent("PolicyTipEvent",new Dl(CommonUIStrings.l_PolicyBusinessBarTitle,z,CommonUIStrings.l_PolicyOverrideButton,Z))}Mzh(z,Z,pa,Fa=!0){e.ULS.sendTraceTag(42074656,306,Fa?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",
Z);Fa=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let Ma=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,tb=null,Hb=null;switch(z){case 2:Fa=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:Ma=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:Fa=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;
Ma=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:Fa=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:Fa=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:Ma=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;
break;case 14:Fa=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Ma=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;break;case 15:Fa=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Ma=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,tb=CommonUIStrings.l_LearnMore,Hb=()=>{this.rSl()}}z=new Lm(z,Z,pa,Fa,Ma,tb,Hb);this.Ma.raiseEvent("SetPolicyLabelFailureEventKey",z)}d8e(z){this.sQd=z}j4k(){this.cKd?
(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Rc.a.KYc(this.cKd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}cqk(z){if(!z.startsWith("<")||-1===z.indexOf("Error")&&-1===z.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}Nuh(){this.TJc&&
(this.TJc.stop(),this.TJc=null)}wtj(z){if(!z)return"manual";switch(z.A9){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}Huj(z){if(!z)return"privileged";z=z.A9;let Z="privileged";if(4===z||1===z)Z="standard";return Z}G_c(z,Z,pa=null,Fa=!1,Ma=0){this.La.getBooleanAppSetting("WacLabelingGetPolicyLabelsIsEnabled")&&(this.ada=z,this.TBa=pa,this.Di&&(this.F6a=this.Di.lj("WebServiceCall",
"Call Get Policy Endpoint On Server")),pa={},pa[Sj.a.cEi]=z,this.La.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Eo.a(this.FBb("getpolicylabels",Fa),1,null,pa,!0,2,Ma,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Z),this.Bi.send(z).qmb(Object(ib.a)(this,this.enh,"onGetPolicyLabelsSuccessCallback"),Object(ib.a)(this,this.dnh,"onGetPolicyLabelsFailureCallback"))):this.Bi.Tj(this.FBb("getpolicylabels",Fa),1,null,pa,!0,2,Object(ib.a)(this,
this.enh,"onGetPolicyLabelsSuccessCallback"),Object(ib.a)(this,this.dnh,"onGetPolicyLabelsFailureCallback"),Ma,void 0,void 0,void 0,void 0,"22"),this.$Xb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.$Xb))}pSl(z,Z,pa,Fa=null){if(this.k6c){this.Di&&(this.B8a=this.Di.lj("WebServiceCall","Call Set Policy Endpoint On Server"));var Ma={};Ma[Sj.a.hKh]=z;Z&&(Ma[Sj.a.UMh]=encodeURIComponent(Z));this.sQd&&(Ma[Sj.a.DDi]=this.sQd);Fa?(Ma[Sj.a.RMh]=this.wtj(Fa),
Ma[Sj.a.SMh]=this.Huj(Fa),1===Fa.A9&&this.zv.DefaultLabelType&&(Ma[Sj.a.oSl]=this.zv.DefaultLabelType)):(Ma[Sj.a.RMh]="manual",Ma[Sj.a.SMh]="privileged");this.$ob&&this.zv&&(Ma[Sj.a.xgl]=this.zv.PolicyLabelVersionToken);this.La.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Eo.a(this.FBb("setpolicylabel",!0),1,null,Ma,!0,2,Fa,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,pa),this.Bi.send(z).qmb(Object(ib.a)(this,this.rph,"onSetPolicyLabelSuccessCallback"),
Object(ib.a)(this,this.qph,"onSetPolicyLabelFailureCallback"))):this.Bi.Tj(this.FBb("setpolicylabel",!0),1,null,Ma,!0,2,Object(ib.a)(this,this.rph,"onSetPolicyLabelSuccessCallback"),Object(ib.a)(this,this.qph,"onSetPolicyLabelFailureCallback"),Fa,void 0,void 0,void 0,void 0,"32");this.RRa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.RRa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}rSl(){const z=
new Vb.StandardDialog,Z=this.La.Ea("BreadcrumbFolderUrl");Z?(z.Fd=11,z.Te(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),z.Te(2,CommonUIStrings.l_DialogOk)):(z.Fd=0,z.Te(1,CommonUIStrings.l_DialogOk));z.cZd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");z.ezl();z.vQ(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,
pa=>{1===pa&&Z&&Rc.a.qo(Z,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}N7d(z){switch(z){case 1:return Kj.a.ZEa(1,1);case 2:return Kj.a.ZEa(7,1);case 3:return Kj.a.ZEa(8,1);default:return Kj.a.ZEa(7,0)}}P3i(z=null){if(!z)return Kj.a.ZEa(8,0);switch(z.A9){case 1:case 16:return Kj.a.ZEa(1,1);case 4:case 2:case 8:return Kj.a.ZEa(8,1);default:return Kj.a.ZEa(8,0)}}j4e(z){re.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",z)}}Object(k.a)(un,"PolicyManager",
null,[1028]);class nk{constructor(){this.eVd=this.aTd=this.uzf=this.rDf=this.kof=this.so=this.xRa=this.Da=this.nk=null;this.Skh=()=>{this.so=this.Da.ub("CommonUI.BusinessBar");this.nk||(this.nk=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.xRa=this.Da.resolve("Common.App.Policy.PolicyActor");re.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.nk.Z2b(Object(ib.a)(this.xRa,this.xRa.JBh,"registerActionsHandler")):
this.xRa.qb();this.nk.Z2b(this.Nim);H.AFrameworkApplication.fa.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&(this.nk.oMf(this.h_j),this.nk.hxi(this.zNc),this.nk.lAi(this.Tza),this.nk.ixi(this.jZd),this.nk.mAi(this.T2e))};this.Nim=()=>{this.xRa.iSl();this.xRa.KQl();this.xRa.eol();const z=this.nk.lSi();H.AFrameworkApplication.fa.getBooleanAppSetting("HasDocumentEditRights")&&!z?this.xRa.$bm():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",
H.AFrameworkApplication.fa.getBooleanAppSetting("HasDocumentEditRights"),z);H.AFrameworkApplication.za.Gf()};this.h1l=(z,Z)=>{this.aTd&&this.so.Tfa(38)&&this.so.removeEntry(this.aTd);z=this.Lmg(Z.title,Z.ygl,38,Z.l3k,Z.buttonText);H.AFrameworkApplication.za.mb.BNc(z,!0)?(this.aTd=z,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};
this.h_j=(z,Z)=>{Z.R0l&&(this.eVd&&this.so.Tfa(21)&&this.so.removeEntry(this.eVd),z=this.Lmg(Z.title,Z.message,21,null,null,Z.w4b,Z.buttonText),H.AFrameworkApplication.za.mb.BNc(z,!0)?(this.eVd=z,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))};this.Tza=(z,Z)=>{(z=Z.z8c?this.rDf:this.kof)&&this.so&&this.so.Tfa(Z.Mwb)&&
this.so.removeEntry(z)};this.zNc=(z,Z)=>{this.so&&(this.nk.Tza(Z.Mwb),z=new Im.a(Z.title,Z.message,null),z.id=Z.Mwb,z.closeable=!0,z.image=3,z.addButton(Z.buttonText,Z.w4b,Z.buttonText,!0),this.so.Ei(z,!1),Z.z8c?this.rDf=z:this.kof=z)};this.jZd=(z,Z)=>{this.so&&(z=new Im.a(Z.title,Z.message,null),z.id=Z.Mwb,z.closeable=!1,z.image=3,z.addButton(Z.buttonText,Z.w4b,Z.buttonText,!1),this.so.Ei(z,!1),this.uzf=z)};this.T2e=()=>{const z=this.uzf;z&&this.so&&this.so.Tfa(z.id)&&this.so.removeEntry(z)}}get name(){return"Common.App.Policy"}init(){H.AFrameworkApplication.fa.getBooleanAppSetting("ShouldInitCommonPolicyPackage")&&
(H.AFrameworkApplication.fa.getBooleanAppSetting("IsDataLossPreventionEnabledForUser")&&H.AFrameworkApplication.za&&(this.nk=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.nk.$zi(this.h1l),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?Zd.a.get_instance().Ij(5,()=>{this.nk.dhe()}):Zd.a.get_instance().Ij(6,()=>{this.nk.dhe()})),H.AFrameworkApplication.fa.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&
H.AFrameworkApplication.fa.getBooleanAppSetting("SupportsPolicies")?H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?Zd.a.get_instance().Ij(5,this.Skh):Zd.a.get_instance().Ij(6,this.Skh):(Wm.hkm(),Wm.Lvd(!1)))}dispose(){}fc(z){z.register(1028,"Common.App.Policy.Contracts.IPolicyManager").ma().na(()=>new un(H.AFrameworkApplication.fa,H.AFrameworkApplication.Me,H.AFrameworkApplication.za.DW,H.AFrameworkApplication.fa.tc("MaxGetPolicyRetries",
1),z.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),H.AFrameworkApplication.za.mb.Ej));z.register(Wm,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().na(()=>new Wm(H.AFrameworkApplication.Pa,H.AFrameworkApplication.za,H.AFrameworkApplication.fa,z.ze("Common.App.Policy.Contracts.IPolicyManager")));this.Da=z}Lmg(z,Z,pa,Fa=null,Ma=null,tb=null,Hb=null){z=new Im.a(z,Z,null);z.id=pa;z.closeable=!0;Fa&&z.hZd(Ma,Fa);tb&&z.addButton(Hb,tb,Hb);return z}static main(){Qa.a.instance.Ac(new nk)}}
Object(k.a)(nk,"PackageManager",null,[2,3]);var Bf=d(255),Fo=d(294),Go=d(134);class eo extends Fo.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new Go.a,{T_:eo.getTypeName(),B_:eo.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}Object(k.a)(eo,"SecurityShared",Fo.a,[]);class vn extends eo{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Go.a,{T_:vn.getTypeName(),
B_:vn.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(k.a)(vn,"CLP",eo,[]);var ap=d(252),hm=d(267),fk=d(529);class wp extends jj.a{constructor(z){super();this.TenantId=null;this.TenantId=z}om(){return 103}}Object(k.a)(wp,"GetAppliedPolicyIdRequest",jj.a,[]);class fo extends Sys.EventArgs{constructor(z){super();this.Tka=z}}Object(k.a)(fo,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class Yp{constructor(z,
Z,pa){this.A2=this.KHe=this.Ddd=null;this.ua=new Hk.a;this.efc=!1;this.Qi=z;this.qgb=Z;this.Lb=pa;this.qgb.uyi(Object(ib.a)(this,this.dlh,"onAppliedPolicyIdReady"));this.qgb.fzi(Object(ib.a)(this,this.Dnh,"onIsManuallyAppliedReady"))}vyi(z){this.ua.addHandler("AppliedPolicyEventReceivedKey",z)}dispose(){this.qgb.cBl(Object(ib.a)(this,this.dlh,"onAppliedPolicyIdReady"));this.qgb.ABl(Object(ib.a)(this,this.Dnh,"onIsManuallyAppliedReady"))}egg(z,Z){z?(this.A2=z,this.Ddd=Z,z=new lj.a(new wp(z),pa=>{this.Rpd(pa)},
pa=>this.Pkb(pa)),this.Qi.Jb(z)):Qc.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}ADj(z,Z){!Z||Ob.a.Ta(z)?Qc.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.A2=z,this.KHe=Z,z=new lj.a(new wp(z),pa=>{this.Rpd(pa)},pa=>this.Pkb(pa)),this.Qi.Jb(z))}dlh(z,Z){z="";Ob.a.Ta(Z.Tka)||(z=Z.Tka);"00000000-0000-0000-0000-000000000000"===z?(Z=Ob.a.Ta(this.A2)?this.Lb.Ea("TenantId"):this.A2,this.egg(Z,this.Ddd)):this.rTe(z,null)}Dnh(z,Z){this.z6k(Z.efc)}Rpd(z){let Z=
null;z.ServerError&&0!==z.ServerError.Code?Z=em.a[z.ServerError.Code]:0!==z.StatusCode&&(Z=Yg.a[z.StatusCode]);Z&&this.rTe("",Z)}Pkb(){Qc.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.rTe("","ErrorGetAppliedPolicyIdFailed");return!0}rTe(z,Z){Z&&Qc.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+Z);this.Ddd?this.Ddd(z,Z):Qc.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");Qc.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");z=
new fo(z);this.ua.raiseEvent("AppliedPolicyEventReceivedKey",z)}z6k(z){this.KHe?this.KHe(z,null):Qc.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(k.a)(Yp,"AppliedPolicyIdService",null,[983,106]);class xp{constructor(z,Z,pa,Fa){this.sJb=z;this.BIa=Z;this.MV=pa;this.ka=Fa}FM(z){var Z=z.automatic||{},pa=Z.sensitivityLabel||{};Z=this.iue()?Z.id:pa.id;pa=z.recommended||{};const Fa=pa.sensitivityLabel||{};z=this.iue()?pa.id:Fa.id;pa=this.iue()?pa.policyTip:Fa.policyTip;this.ka.pptIsManuallyAppliedForAclpIsEnabled?
this.sJb.GOf(Z,z,pa,!this.MV.zv.AppliedPolicyId||!this.BIa.efc):this.sJb.GOf(Z,z,pa,!this.MV.zv.AppliedPolicyId)}iue(){return this.ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(k.a)(xp,"AutoClpAnnotationEventHandler",null,[]);class kl{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(k.a)(kl,"PolicyInfo",null,[]);var Zp=d(1045);class mj{constructor(){this.gNb=
this.startTime=null}}Object(k.a)(mj,"PollingData",null,[]);class Ho{constructor(z,Z,pa,Fa,Ma,tb,Hb,rc,yc,xc,ld,wd){this.Abh=this.aIb=!1;this.kcd=null;this.VWg=!1;this.ia=z;this.sJb=Z;this.MV=pa;this.A2=Fa;this.COg=new Ta.a;this.oJk=Ma;this.BIa=tb;this.zb=Hb;this.wbh=rc;this.yr=yc;this.rF=xc;this.Mw=ld;this.rc=wd;this.H3g=H.AFrameworkApplication.fa.tc("ClpLabelPollingIntervalMs",3E4);this.IMe=H.AFrameworkApplication.fa.tc("ClpLabelPollingTimeoutMs",3E5);this.mpa=H.AFrameworkApplication.fa.Ea("UserName");
this.tUk=H.AFrameworkApplication.fa.Ea("UserPrincipalName");this.SHk=this.Uzj()}Uzj(){let z;if(H.AFrameworkApplication.fa.getBooleanAppSetting("DynamicVariableCLPFixEnabled")){if(z=H.AFrameworkApplication.fa.Ea("EditDocInClientUrl"))return Qc.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),z;Qc.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(z=H.AFrameworkApplication.fa.Ea("WOPISrc"))||Qc.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");
Qc.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return z}dispose(){this.sJb=null;if(this.aIb){this.MV.wEh(Object(ib.a)(this,this.pph,"onSetLabelSucceeded"));for(const z of this.COg)this.MV.wEh(z)}}init(){this.sJb.qb();this.sJb.Sd();if(H.AFrameworkApplication.fa.getBooleanAppSetting("PPTClpSwitchEnabled")&&H.AFrameworkApplication.fa.getBooleanAppSetting("SupportsOfficeClientCoauthoring")){const z=Object(w.a)(Zp.a,Eb.App.ni);z&&this.MV.Hvl(Object(ib.a)(z,z.nFi,"areAllCoauthorsInSessionClientMipTrusted"));
this.MV.c9j(this.oJk);0<this.H3g&&0<this.IMe&&this.BIa.vyi(Object(ib.a)(this,this.L4k,"onDocumentContentPolicyChanged"));H.AFrameworkApplication.nwa&&this.wbh.mwl(()=>this.yr.r6h);this.yr.U5&&(Qc.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.yr.U5),this.MV.d8e(this.yr.U5));this.rF.hyi(()=>{Qc.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.yr.U5);this.MV.d8e(this.yr.U5)})}this.MV.iBi(Object(ib.a)(this,this.jFi,"applyUdpLabeling"));this.MV.Twl(Object(ib.a)(this,
this.$fk,"isClpBlockedByAppSpecificScenario"));this.MV.nyi(Object(ib.a)(this,this.GEi,"applyMandatoryLabeling"));this.MV.n_d(Object(ib.a)(this,this.pph,"onSetLabelSucceeded"));this.aIb=!0}jFi(z,Z){Z.kYl&&H.AFrameworkApplication.Pa.nb(Mc.a.openInClient,2)}$fk(){const z=!this.rc.getState(2)&&!this.rc.JDg;this.Abh!==z&&(this.rc.MKg(),Qc.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",z),this.Abh=z);return z}get Tka(){return this.MV.zv.AppliedPolicyId}hxl(z){this.MV.n_d(z);
this.COg.add(z)}Ifl(z,Z,pa){const Fa=new kl;Fa.TenantId=this.A2;Fa.LabelId=z;Fa.ApplyLabelType=Z;Fa.LabelJson=Ho.Woj(W.c(pa));Fa.SkipContentMarking=!1;Fa.UserName=this.mpa;Fa.UserPrincipalName=this.tUk;Fa.DocLocation=this.SHk;Qc.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.ia.Ia(Mc.a.pvh,2,Fa)}GEi(z,Z){if(Z&&0!==Z.Z_d){(z=1===Z.Z_d)?this.Mw.aWh():(this.Mw.YVh(),""!==Z.Yfh&&this.wbh.HEi(Z.Yfh));Z=z?1:3;var pa=H.AFrameworkApplication.Pa.mode;Z!==pa?Qc.a.J(512263625,
822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",Z,pa):this.VWg=z}else Qc.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}pph(z,Z){this.Ifl(Z.Ouh,Z.A9,this.MV.zv);Qc.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}Pce(z){z&&this.Tka?z=this.Tka.toLowerCase()===z.toLowerCase():(Qc.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!z,!this.Tka),z=z===this.Tka);Qc.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",z);return z}Cgl(z){const Z=Object(w.a)(mj,z.gu);if(Z){var pa=+new Date-+Z.startTime;Qc.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",pa);this.Pce(Z.gNb)||pa>this.IMe||Z.gNb!==this.kcd?(Qc.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.Pce(Z.gNb),pa>this.IMe,Z.gNb!==this.kcd),this.zb.Vg(z)):
(Qc.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.MV.JVa(Z.gNb,void 0,Ho.FSa,!0))}else Qc.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.zb.Vg(z)}N6l(z){Qc.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const Z=new ee.a(2,2,this.H3g,Object(ib.a)(this,this.Cgl,"pollingTaskCallback"),90,"113");Z.gu=Object.assign(new mj,{startTime:new Date,gNb:z});this.zb.Jb(Z)}L4k(z,Z){Qc.a.J(512263616,822,
50,"OnDocumentContentPolicyChanged: Notification received");Z.Tka||Qc.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.kcd=Z.Tka;this.Pce(this.kcd)?Qc.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.N6l(Z.Tka)}static FSa(){const z=Eb.App.ni.amIAlone,Z=Eb.App.ni.FSa;let pa=!1;const Fa=Object(w.a)(Zp.a,Eb.App.ni);Fa&&(pa=Fa.oFi());Qc.a.J(512263585,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",
z,Z,pa);return z||Z&&pa}static Woj(z){z=z.replace(RegExp(":null","gi"),':""');return z=z.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(k.a)(Ho,"PptPolicyManager",null,[106]);class $p{constructor(z,Z,pa,Fa){this.IFk=z;this.Wb=Z;this.Eb=pa;this.ka=Fa}qb(){this.IFk.pa(Mc.a.pvh,bd.a.application,Object(ib.a)(this,this.gUj,"handleApplySensitivity"),4)}Sd(){}gUj(z,Z,pa,Fa,Ma){if(!(H.AFrameworkApplication.fa.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&H.AFrameworkApplication.fa.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&
this.ka.pptLabelingGetPolicyLabelsIsEnabled&&this.ka.pptApplyManualPolicyLabelIsEnabled&&H.AFrameworkApplication.fa.getBooleanAppSetting("SupportsPolicies")))return 16;if(Z.contextId!==bd.a.application)return 2;if(!Ma||!Object(Wa.a)(kl,Ma))return 8;z=Object(w.a)(kl,Ma);if(Ob.a.Ta(z.TenantId))return Qc.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(Ob.a.Ta(z.LabelJson))return Qc.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===pa)return 32;pa=
this.Wb.Fn;Z=this.Eb.ud(7);try{Z.mc(pa),pa.rlb=z}finally{Z&&Z.dispose()}return 32}}Object(k.a)($p,"SetPolicyActor",null,[948]);class bp{constructor(){this.gic=this.Rhd=this.Lb=this.BIa=this.K=null;this.d$g=!0}get name(){return"PowerPointWebEditor.Policy"}fc(z){this.K=z;this.K.register(983,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().na(()=>new Yp(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.Lb=
this.K.resolve("Common.IAppSettingsManager");this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.Lb.sDb(Object(ib.a)(this,this.Pn,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").Ue(Object(ib.a)(this,this.Pn,"onFullAppSettingsReady"))}dispose(){}Pn(){this.Lb.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&this.Lb.getBooleanAppSetting("SupportsPolicies")&&this.Lb.getBooleanAppSetting("890")&&(this.BIa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),
Zd.a.get_instance().Ij(10,Object(ib.a)(this,this.q2k,"onAfterRibbonDisplayed")),Bf.a.Au(this.K.Ha("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const Z=new $p(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));z=z.result;this.Rhd=new Ho(this.K.resolve("Common.IActionManagerExtended"),Z,z,this.Lb.Ea("TenantId"),
this.K.Ha("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.Rhd.init()}))}q2k(){Bf.a.Au(this.K.Ha("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>
{const Z=z.result;H.AFrameworkApplication.fa.getBooleanAppSetting("AutoClpIsEnabled")&&(Qc.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.gic=new rb.a(()=>new xp(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),Z,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.Lb.Ea("TenantId"))),Z.Uxi(Object(ib.a)(this,this.Jvl,"registerAutoClpAnnotationEventHandler")),
H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(Z.Exi(Object(ib.a)(this,this.rTc,"createAutoCLPSecurityNodes")),Z.kBi(Object(ib.a)(this,this.Ugm,"updateAutoCLPLabelPriorityNode")),Z.lBi(Object(ib.a)(this,this.Vgm,"updateAutoCLPSITNodes"))));(z=this.Lb.Ea("AppliedPolicyId"))||H.AFrameworkApplication.fa.getBooleanAppSetting("PPTClpSwitchEnabled")&&H.AFrameworkApplication.fa.getBooleanAppSetting("SupportsOfficeClientCoauthoring")?H.AFrameworkApplication.fa.getBooleanAppSetting("PPTOCoauthorPopUpFixManualCLPEnabled")?
Z.JVa(z,void 0,Ho.FSa):Z.JVa(z):(z=this.Lb.Ea("TenantId"),Ob.a.Ta(z)?Qc.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Qc.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.BIa.egg(z,(pa,Fa)=>{Fa&&Qc.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+Fa);Ob.a.Ta(pa)&&(pa="",Qc.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));
H.AFrameworkApplication.fa.getBooleanAppSetting("PPTOCoauthorPopUpFixManualCLPEnabled")?Z.JVa(pa,void 0,Ho.FSa):Z.JVa(pa)}),this.BIa.ADj(z,(pa,Fa)=>{Fa?Qc.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+Fa):this.BIa.efc=pa}),this.Rhd.hxl(Object(ib.a)(this,this.Kim,"updateIsManuallyApplied"))))})}Jvl(){const z=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.d$g&&(z.fp||this.Rhd.VWg&&z.Gfc)&&(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Z=>
{Qc.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");H.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?(Z.aM("AugLoop_SecurityClp_LabellingAnnotation"),Z.Z2("AugLoop_SecurityClp_LabellingAnnotation",Object(ib.a)(this.gic.value,this.gic.value.FM,"handleAnnotationEvent"))):(Z.aM("AugLoop_Automatic_Clp_LabellingAnnotation"),Z.Z2("AugLoop_Automatic_Clp_LabellingAnnotation",Object(ib.a)(this.gic.value,
this.gic.value.FM,"handleAnnotationEvent")))}),this.d$g=!1)}rTc(z,Z){z=[Object.assign(new hm.a,{id:"clp",body:Object.assign(new vn,{existingLabelPriority:Z.existingLabelPriority,partialDocSITs:Z.aYf,fullDocSITs:Z.$Xf})})];const pa=Object.assign(new ap.a,{parentPath:["session","doc","security"],items:z});this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Fa=>{Qc.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");Fa.submitOperation(pa)})}Ugm(z,
Z){z=[Object.assign(new hm.a,{id:"clp",body:Object.assign(new vn,{existingLabelPriority:Z.existingLabelPriority})})];const pa=Object.assign(new fk.a,{parentPath:["session","doc","security"],items:z});this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Fa=>{Qc.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");Fa.submitOperation(pa)})}Vgm(z,Z){z=[Object.assign(new hm.a,{id:"clp",body:Object.assign(new vn,{partialDocSITs:Z.aYf,
fullDocSITs:Z.$Xf})})];const pa=Object.assign(new fk.a,{parentPath:["session","doc","security"],items:z});this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Fa=>{Qc.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");Fa.submitOperation(pa)})}Kim(z,Z){Z&&(this.BIa.efc=Z.Ouh&&0!==Z.A9?2===Z.A9||8===Z.A9||16===Z.A9?!0:!1:!1)}static main(){Qa.a.instance.Ac(new bp)}}Object(k.a)(bp,"PPTWebEditorPolicyPackage",null,[2,3]);var cp=
d(13);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");
Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Object(cp.d)("Chronosslim");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Ua.main();Type.registerNamespace("Common.App.CatchUpActivity");zc.main();Type.registerNamespace("Common.App.Rename");
Qa.a.instance.Ac(new Hc,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");Qa.a.instance.Ac(new Cd);Type.registerNamespace("Common.App.SafeLinks");me.main();yk.main();qm.main();Vj.main();vj.main();ck.main();uf.main();Ia.main();Qa.a.instance.Ac(new Gn);zl.main();Qa.a.instance.Ac(new vp);$k.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");nk.main();bp.main();ul.main();Object(cp.c)("Chronosslim")},
213:function(L,V,d){L=d(0);var k=d(54);class e{constructor(w,D,y,m,C){this.yJa=!1;this.IHb=w;this.JGb=D;this.oic=y;this.hLk=C;this.eJb=m.AGa(y,D.name)}get CSf(){return this.oic}fc(w){this.eJb.QQf();this.JGb.fc(w);this.eJb.Q8f()}init(){this.eJb.Mu(this.JGb.name+"_d");this.hLk?this.IHb.a9j(this,this.oic):this.IHb.$8j(this,this.oic)}Z8j(){this.eJb.Su(this.JGb.name+"_d");this.eJb.SQf();this.JGb.init();this.yJa=!0;this.eJb.T8f()}dispose(){this.yJa&&this.JGb.dispose()}get name(){return this.JGb.name}}Object(L.a)(e,
"DelayLoadedPackage",null,[1083,2,3]);class n{constructor(w,D){this.IHb=null;w.execute(y=>{this.IHb=y});this.AGk=D}create(w,D,y){return this.IHb?new e(this.IHb,w,D,this.AGk.value,y):w}static get instance(){return n.Ja||(n.Ja=new n(k.a.instance.Ha("PowerPointWebEditor.DelayLoadedPackageInitializer"),k.a.instance.ze("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}n.Ja=null;Object(L.a)(n,"DelayLoadedPackageFactory",null,[]);d.d(V,"a",function(){return r});const r=(w,D)=>n.instance.create(w,D,!1)},
706:function(L,V,d){(function(k){function e(){try{var ha=new Uint8Array(1);ha.__proto__={__proto__:Uint8Array.prototype,Oum:function(){return 42}};return"function"===typeof ha.subarray&&0===ha.subarray(1,1).byteLength}catch(ka){return!1}}function n(ha,ka){if((r.N3?2147483647:1073741823)<ka)throw new RangeError("Invalid typed array length");r.N3?(ha=new Uint8Array(ka),ha.__proto__=r.prototype):(null===ha&&(ha=new r(ka)),ha.length=ka);return ha}function r(ha,ka,ca){if(!(r.N3||this instanceof r))return new r(ha,
ka,ca);if("number"===typeof ha){if("string"===typeof ka)throw Error("If encoding is specified then the first argument must be a string");return y(this,ha)}return w(this,ha,ka,ca)}function w(ha,ka,ca,ia){if("number"===typeof ka)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&ka instanceof ArrayBuffer){ka.byteLength;if(0>ca||ka.byteLength<ca)throw new RangeError("'offset' is out of bounds");if(ka.byteLength<ca+(ia||0))throw new RangeError("'length' is out of bounds");
ka=void 0===ca&&void 0===ia?new Uint8Array(ka):void 0===ia?new Uint8Array(ka,ca):new Uint8Array(ka,ca,ia);r.N3?(ha=ka,ha.__proto__=r.prototype):ha=m(ha,ka);ka=ha}else if("string"===typeof ka){ia=ha;ha=ca;if("string"!==typeof ha||""===ha)ha="utf8";if(!r.lve(ha))throw new TypeError('"encoding" must be a valid string encoding');ca=F(ka,ha)|0;ia=n(ia,ca);ka=ia.write(ka,ha);ka!==ca&&(ia=ia.slice(0,ka));ka=ia}else ka=C(ha,ka);return ka}function D(ha){if("number"!==typeof ha)throw new TypeError('"size" argument must be a number');
if(0>ha)throw new RangeError('"size" argument must not be negative');}function y(ha,ka){D(ka);ha=n(ha,0>ka?0:E(ka)|0);if(!r.N3)for(var ca=0;ca<ka;++ca)ha[ca]=0;return ha}function m(ha,ka){var ca=0>ka.length?0:E(ka.length)|0;ha=n(ha,ca);for(var ia=0;ia<ca;ia+=1)ha[ia]=ka[ia]&255;return ha}function C(ha,ka){if(r.isBuffer(ka)){var ca=E(ka.length)|0;ha=n(ha,ca);if(0===ha.length)return ha;ka.copy(ha,0,0,ca);return ha}if(ka){if("undefined"!==typeof ArrayBuffer&&ka.buffer instanceof ArrayBuffer||"length"in
ka)return(ca="number"!==typeof ka.length)||(ca=ka.length,ca=ca!==ca),ca?n(ha,0):m(ha,ka);if("Buffer"===ka.type&&G(ka.data))return m(ha,ka.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function E(ha){if(ha>=(r.N3?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(r.N3?2147483647:1073741823).toString(16)+" bytes");return ha|0}function F(ha,ka){if(r.isBuffer(ha))return ha.length;if("undefined"!==
typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(ha)||ha instanceof ArrayBuffer))return ha.byteLength;"string"!==typeof ha&&(ha=""+ha);var ca=ha.length;if(0===ca)return 0;for(var ia=!1;;)switch(ka){case "ascii":case "latin1":case "binary":return ca;case "utf8":case "utf-8":case void 0:return W(ha).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*ca;case "hex":return ca>>>1;case "base64":return P(ha).length;default:if(ia)return W(ha).length;ka=
(""+ka).toLowerCase();ia=!0}}function B(ha,ka,ca){var ia=!1;if(void 0===ka||0>ka)ka=0;if(ka>this.length)return"";if(void 0===ca||ca>this.length)ca=this.length;if(0>=ca)return"";ca>>>=0;ka>>>=0;if(ca<=ka)return"";for(ha||(ha="utf8");;)switch(ha){case "hex":ha=ka;ka=ca;ca=this.length;if(!ha||0>ha)ha=0;if(!ka||0>ka||ka>ca)ka=ca;ia="";for(ca=ha;ca<ka;++ca)ha=ia,ia=this[ca],ia=16>ia?"0"+ia.toString(16):ia.toString(16),ia=ha+ia;return ia;case "utf8":case "utf-8":return A(this,ka,ca);case "ascii":ha="";
for(ca=Math.min(this.length,ca);ka<ca;++ka)ha+=String.fromCharCode(this[ka]&127);return ha;case "latin1":case "binary":ha="";for(ca=Math.min(this.length,ca);ka<ca;++ka)ha+=String.fromCharCode(this[ka]);return ha;case "base64":return 0===ka&&ca===this.length?Q.Deg(this):Q.Deg(this.slice(ka,ca));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ka=this.slice(ka,ca);ca="";for(ha=0;ha<ka.length;ha+=2)ca+=String.fromCharCode(ka[ha]+256*ka[ha+1]);return ca;default:if(ia)throw new TypeError("Unknown encoding: "+
ha);ha=(ha+"").toLowerCase();ia=!0}}function H(ha,ka,ca,ia,oa){if(0===ha.length)return-1;"string"===typeof ca?(ia=ca,ca=0):2147483647<ca?ca=2147483647:-2147483648>ca&&(ca=-2147483648);ca=+ca;isNaN(ca)&&(ca=oa?0:ha.length-1);0>ca&&(ca=ha.length+ca);if(ca>=ha.length){if(oa)return-1;ca=ha.length-1}else if(0>ca)if(oa)ca=0;else return-1;"string"===typeof ka&&(ka=r.from(ka,ia));if(r.isBuffer(ka))return 0===ka.length?-1:K(ha,ka,ca,ia,oa);if("number"===typeof ka)return ka&=255,r.N3&&"function"===typeof Uint8Array.prototype.indexOf?
oa?Uint8Array.prototype.indexOf.call(ha,ka,ca):Uint8Array.prototype.lastIndexOf.call(ha,ka,ca):K(ha,[ka],ca,ia,oa);throw new TypeError("val must be string, number or Buffer");}function K(ha,ka,ca,ia,oa){function sa(Ha,da){return 1===Ca?Ha[da]:Ha.Tsl(da*Ca)}var Ca=1,Ta=ha.length,R=ka.length;if(void 0!==ia&&(ia=String(ia).toLowerCase(),"ucs2"===ia||"ucs-2"===ia||"utf16le"===ia||"utf-16le"===ia)){if(2>ha.length||2>ka.length)return-1;Ca=2;Ta/=2;R/=2;ca/=2}if(oa)for(ia=-1;ca<Ta;ca++)if(sa(ha,ca)===sa(ka,
-1===ia?0:ca-ia)){if(-1===ia&&(ia=ca),ca-ia+1===R)return ia*Ca}else-1!==ia&&(ca-=ca-ia),ia=-1;else for(ca+R>Ta&&(ca=Ta-R);0<=ca;ca--){Ta=!0;for(ia=0;ia<R;ia++)if(sa(ha,ca+ia)!==sa(ka,ia)){Ta=!1;break}if(Ta)return ca}return-1}function A(ha,ka,ca){ca=Math.min(ha.length,ca);for(var ia=[];ka<ca;){var oa=ha[ka],sa=null,Ca=239<oa?4:223<oa?3:191<oa?2:1;if(ka+Ca<=ca)switch(Ca){case 1:128>oa&&(sa=oa);break;case 2:var Ta=ha[ka+1];128===(Ta&192)&&(oa=(oa&31)<<6|Ta&63,127<oa&&(sa=oa));break;case 3:Ta=ha[ka+1];
var R=ha[ka+2];128===(Ta&192)&&128===(R&192)&&(oa=(oa&15)<<12|(Ta&63)<<6|R&63,2047<oa&&(55296>oa||57343<oa)&&(sa=oa));break;case 4:Ta=ha[ka+1];R=ha[ka+2];var Ha=ha[ka+3];128===(Ta&192)&&128===(R&192)&&128===(Ha&192)&&(oa=(oa&15)<<18|(Ta&63)<<12|(R&63)<<6|Ha&63,65535<oa&&1114112>oa&&(sa=oa))}null===sa?(sa=65533,Ca=1):65535<sa&&(sa-=65536,ia.push(sa>>>10&1023|55296),sa=56320|sa&1023);ia.push(sa);ka+=Ca}ha=ia.length;if(ha<=Y)ia=String.fromCharCode.apply(String,ia);else{ca="";for(ka=0;ka<ha;)ca+=String.fromCharCode.apply(String,
ia.slice(ka,ka+=Y));ia=ca}return ia}function W(ha,ka){ka=ka||Infinity;for(var ca,ia=ha.length,oa=null,sa=[],Ca=0;Ca<ia;++Ca){ca=ha.charCodeAt(Ca);if(55295<ca&&57344>ca){if(!oa){if(56319<ca){-1<(ka-=3)&&sa.push(239,191,189);continue}else if(Ca+1===ia){-1<(ka-=3)&&sa.push(239,191,189);continue}oa=ca;continue}if(56320>ca){-1<(ka-=3)&&sa.push(239,191,189);oa=ca;continue}ca=(oa-55296<<10|ca-56320)+65536}else oa&&-1<(ka-=3)&&sa.push(239,191,189);oa=null;if(128>ca){if(0>--ka)break;sa.push(ca)}else if(2048>
ca){if(0>(ka-=2))break;sa.push(ca>>6|192,ca&63|128)}else if(65536>ca){if(0>(ka-=3))break;sa.push(ca>>12|224,ca>>6&63|128,ca&63|128)}else if(1114112>ca){if(0>(ka-=4))break;sa.push(ca>>18|240,ca>>12&63|128,ca>>6&63|128,ca&63|128)}else throw Error("Invalid code point");}return sa}function N(ha){for(var ka=[],ca=0;ca<ha.length;++ca)ka.push(ha.charCodeAt(ca)&255);return ka}function P(ha){var ka=Q,ca=ka.Z$l;ha=(ha.trim?ha.trim():ha.replace(/^\s+|\s+$/g,"")).replace(ba,"");if(2>ha.length)ha="";else for(;0!==
ha.length%4;)ha+="=";return ca.call(ka,ha)}function U(ha,ka,ca,ia){for(var oa=0;oa<ia&&!(oa+ca>=ka.length||oa>=ha.length);++oa)ka[oa+ca]=ha[oa];return oa}var Q=d(1184);d(1185);var G=d(1186);V.GGd=r;V.jsm=function(ha){+ha!=ha&&(ha=0);return r.jNf(+ha)};V.brm=50;r.N3=void 0!==k.N3?k.N3:e();V.Kvm=r.N3?2147483647:1073741823;r.from=function(ha,ka,ca){return w(null,ha,ka,ca)};r.N3&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&r[Symbol.species]===
r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0}));r.jNf=function(ha){D(ha);return n(null,ha)};r.YCi=function(ha){return y(null,ha)};r.isBuffer=function(ha){return!(null==ha||!ha.zgi)};r.compare=function(ha,ka){if(!r.isBuffer(ha)||!r.isBuffer(ka))throw new TypeError("Arguments must be Buffers");if(ha===ka)return 0;for(var ca=ha.length,ia=ka.length,oa=0,sa=Math.min(ca,ia);oa<sa;++oa)if(ha[oa]!==ka[oa]){ca=ha[oa];ia=ka[oa];break}return ca<ia?-1:ia<ca?1:0};r.lve=function(ha){switch(String(ha).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};r.concat=function(ha,ka){if(!G(ha))throw new TypeError('"list" argument must be an Array of Buffers');if(0===ha.length)return r.jNf(0);var ca;if(void 0===ka)for(ca=ka=0;ca<ha.length;++ca)ka+=ha[ca].length;ka=r.YCi(ka);var ia=0;for(ca=0;ca<ha.length;++ca){var oa=ha[ca];if(!r.isBuffer(oa))throw new TypeError('"list" argument must be an Array of Buffers');oa.copy(ka,ia);ia+=oa.length}return ka};r.byteLength=F;r.prototype.zgi=!0;r.prototype.toString=function(){var ha=this.length|0;
return 0===ha?"":0===arguments.length?A(this,0,ha):B.apply(this,arguments)};r.prototype.equals=function(ha){if(!r.isBuffer(ha))throw new TypeError("Argument must be a Buffer");return this===ha?!0:0===r.compare(this,ha)};r.prototype.compare=function(ha,ka,ca,ia,oa){if(!r.isBuffer(ha))throw new TypeError("Argument must be a Buffer");void 0===ka&&(ka=0);void 0===ca&&(ca=ha?ha.length:0);void 0===ia&&(ia=0);void 0===oa&&(oa=this.length);if(0>ka||ca>ha.length||0>ia||oa>this.length)throw new RangeError("out of range index");
if(ia>=oa&&ka>=ca)return 0;if(ia>=oa)return-1;if(ka>=ca)return 1;ka>>>=0;ca>>>=0;ia>>>=0;oa>>>=0;if(this===ha)return 0;var sa=oa-ia,Ca=ca-ka,Ta=Math.min(sa,Ca);ia=this.slice(ia,oa);ha=ha.slice(ka,ca);for(ka=0;ka<Ta;++ka)if(ia[ka]!==ha[ka]){sa=ia[ka];Ca=ha[ka];break}return sa<Ca?-1:Ca<sa?1:0};r.prototype.includes=function(ha,ka,ca){return-1!==this.indexOf(ha,ka,ca)};r.prototype.indexOf=function(ha,ka,ca){return H(this,ha,ka,ca,!0)};r.prototype.lastIndexOf=function(ha,ka,ca){return H(this,ha,ka,ca,
!1)};r.prototype.write=function(ha,ka,ca,ia){if(void 0===ka)ia="utf8",ca=this.length,ka=0;else if(void 0===ca&&"string"===typeof ka)ia=ka,ca=this.length,ka=0;else if(isFinite(ka))ka|=0,isFinite(ca)?(ca|=0,void 0===ia&&(ia="utf8")):(ia=ca,ca=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var oa=this.length-ka;if(void 0===ca||ca>oa)ca=oa;if(0<ha.length&&(0>ca||0>ka)||ka>this.length)throw new RangeError("Attempt to write outside buffer bounds");ia||
(ia="utf8");for(oa=!1;;)switch(ia){case "hex":ka=Number(ka)||0;ia=this.length-ka;ca?(ca=Number(ca),ca>ia&&(ca=ia)):ca=ia;ia=ha.length;if(0!==ia%2)throw new TypeError("Invalid hex string");ca>ia/2&&(ca=ia/2);for(ia=0;ia<ca;++ia){oa=parseInt(ha.substr(2*ia,2),16);if(isNaN(oa))break;this[ka+ia]=oa}return ia;case "utf8":case "utf-8":return U(W(ha,this.length-ka),this,ka,ca);case "ascii":return U(N(ha),this,ka,ca);case "latin1":case "binary":return U(N(ha),this,ka,ca);case "base64":return U(P(ha),this,
ka,ca);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ia=ha;oa=this.length-ka;for(var sa=[],Ca=0;Ca<ia.length&&!(0>(oa-=2));++Ca){var Ta=ia.charCodeAt(Ca);ha=Ta>>8;Ta%=256;sa.push(Ta);sa.push(ha)}return U(sa,this,ka,ca);default:if(oa)throw new TypeError("Unknown encoding: "+ia);ia=(""+ia).toLowerCase();oa=!0}};r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.Hsm||this,0)}};var Y=4096;r.prototype.slice=function(ha,ka){var ca=this.length;ha=~~ha;ka=void 0===
ka?ca:~~ka;0>ha?(ha+=ca,0>ha&&(ha=0)):ha>ca&&(ha=ca);0>ka?(ka+=ca,0>ka&&(ka=0)):ka>ca&&(ka=ca);ka<ha&&(ka=ha);if(r.N3)ka=this.subarray(ha,ka),ka.__proto__=r.prototype;else{ca=ka-ha;ka=new r(ca,void 0);for(var ia=0;ia<ca;++ia)ka[ia]=this[ia+ha]}return ka};r.prototype.Tsl=function(ha){if(0!==ha%1||0>ha)throw new RangeError("offset is not uint");if(ha+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[ha]<<8|this[ha+1]};r.prototype.copy=function(ha,ka,ca,ia){ca||
(ca=0);ia||0===ia||(ia=this.length);ka>=ha.length&&(ka=ha.length);ka||(ka=0);0<ia&&ia<ca&&(ia=ca);if(ia===ca||0===ha.length||0===this.length)return 0;if(0>ka)throw new RangeError("targetStart out of bounds");if(0>ca||ca>=this.length)throw new RangeError("sourceStart out of bounds");if(0>ia)throw new RangeError("sourceEnd out of bounds");ia>this.length&&(ia=this.length);ha.length-ka<ia-ca&&(ia=ha.length-ka+ca);var oa=ia-ca;if(this===ha&&ca<ka&&ka<ia)for(ia=oa-1;0<=ia;--ia)ha[ia+ka]=this[ia+ca];else if(1E3>
oa||!r.N3)for(ia=0;ia<oa;++ia)ha[ia+ka]=this[ia+ca];else Uint8Array.prototype.set.call(ha,this.subarray(ca,ca+oa),ka);return oa};r.prototype.fill=function(ha,ka,ca,ia){if("string"===typeof ha){"string"===typeof ka?(ia=ka,ka=0,ca=this.length):"string"===typeof ca&&(ia=ca,ca=this.length);if(1===ha.length){var oa=ha.charCodeAt(0);256>oa&&(ha=oa)}if(void 0!==ia&&"string"!==typeof ia)throw new TypeError("encoding must be a string");if("string"===typeof ia&&!r.lve(ia))throw new TypeError("Unknown encoding: "+
ia);}else"number"===typeof ha&&(ha&=255);if(0>ka||this.length<ka||this.length<ca)throw new RangeError("Out of range index");if(ca<=ka)return this;ka>>>=0;ca=void 0===ca?this.length:ca>>>0;ha||(ha=0);if("number"===typeof ha)for(ia=ka;ia<ca;++ia)this[ia]=ha;else for(ha=r.isBuffer(ha)?ha:W((new r(ha,ia)).toString()),oa=ha.length,ia=0;ia<ca-ka;++ia)this[ia+ka]=ha[ia%oa];return this};var ba=/[^+\/0-9A-Za-z-_]/g}).call(this,d(1007))},707:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,
n,r,w,D,y,m,C=null,E=null,F=!1,B=null,H=null,K=null,A=null,W=!1,N=null,P=null,U=null,Q=null,G=null,Y=null){this.url=e;this.inm=n;this.body=r;this.headers=w;this.p$e=D;this.priority=y;this.state=m;this.E5h=C;this.ewc=E;this.Bj=F;this.Pol=B;this.sNl=H;this.name=K;this.clb=A;this.Vee=W;this.Hqd=N;this.ny=P;this.tDb=U;this.MPb=Q;this.k5j=G;this.responseType=Y}}Object(L.a)(k,"ClientRequest",null,[])},752:function(L,V,d){L=d(0);var k=d(25),e=d(103),n=d(80),r=d(7),w=d(35),D=d(86),y=d(27),m=d(249);class C{constructor(){this.TenantId=
this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(L.a)(C,"PodsInfo",null,[]);d.d(V,"a",function(){return E});class E{constructor(F,B,H,K,A,W,N){y.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Lb=N;this.Ms=F;this.Xa=B;this.Nc=H;this.oA=K;this.fe=
A;this.zb=W;this.aIb=!1;this.R_a=0;this.Lb.Ue(Object(r.a)(this,this.initialize,"initialize"))}initialize(){y.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.Nc.bC(Object(r.a)(this,this.mo,"onSessionRehydrated"));this.oA.xvb(Object(r.a)(this,this.Jha,"onPodSessionRefreshed"));this.aIb=!0}dispose(){this.aIb&&(this.Nc.Wba(Object(r.a)(this,this.mo,"onSessionRehydrated")),this.oA.Fmb(Object(r.a)(this,this.Jha,"onPodSessionRefreshed")),this.aIb=!1)}sendInfoToPods(){var F=
this.Lb.Ea("361"),B=this.Xa.podSessionId;const H=this.Xa.$k,K=k.AFrameworkApplication.userSessionId,A=e.a.create().toString();y.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",A);F=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",F,B);B={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};B["X-UserSessionId"]=K;B["X-CorrelationID"]=A;B["X-WacCluster"]=H;try{const W=Object.assign(new C,{UserName:this.Lb.Ea(D.a.ndl),
UserId:this.Lb.Ea("387"),ProviderId:this.Lb.Ea("388"),FileSource:this.Lb.Ea("FileSource"),LoggableUserId:this.Lb.Ea("LoggableUserId"),TenantId:this.Lb.Ea("TenantId"),BrowserCacheAllowed:this.Lb.getBooleanAppSetting("431"),EnableMacrosForProtectedFile:k.AFrameworkApplication.N8b,ServerDocId:this.Lb.Ea("ServerDocId"),ComplianceDomainPrefix:k.AFrameworkApplication.fa.Ea("ComplianceDomainPrefix"),IsO365CommercialHost:this.Lb.getBooleanAppSetting("IsO365CommercialHost"),IsO365ConsumerHost:this.Lb.getBooleanAppSetting("IsO365ConsumerHost"),
IsCLPCoauthoringEnabled:this.Lb.getBooleanAppSetting("PPTClpSwitchEnabled")&&this.Lb.getBooleanAppSetting("SupportsOfficeClientCoauthoring")}),N=w.c(W);this.Ms.Tj(F,2,N,B,!1,1,Object(r.a)(this,this.A9k,"onSendUserInfoSucceeded"),Object(r.a)(this,this.z9k,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,m.a("6"))}catch(W){y.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",W)}}A9k(){y.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.R_a=
0}z9k(){y.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.R_a?this.HHl():this.QSj()}HHl(){this.R_a++;y.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.R_a);const F=new n.a(1,1,5E3,Object(r.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.zb.Jb(F)}QSj(){y.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.R_a);this.fe.iI(307,null);this.R_a=0}mo(){this.R_a=
0;y.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}Jha(){this.R_a=0;y.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(L.a)(E,"PodsInfoSender",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.chronosslim.js.map
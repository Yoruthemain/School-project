'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1010:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.pEa=this.Fpb=this.cie=this.Hle=this.Gbc=this.Gdf=null}}Object(L.a)(k,"AppsForOfficeOauthResult",null,[])},1011:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=
this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static jgg(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(L.a)(k,"WopiAuthContext",null,[483])},1309:function(L,V,d){d.r(V);var k=d(0),e=d(18),n=d(395),r=d(279);class w{constructor(){this.Sai=new e.a}get PQc(){return this.Sai}gHj(J){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",J);const X=
new e.a;for(const Ia of this.PQc)for(const fb of Ia.Fqc)fb.id===J&&X.add(fb);return X}hKi(){var J=this.gHj("ContextMenuText");if(J&&0<J.count){const X=Object.assign(new r.a,{ControlList:[]});for(const Ia of J)J=Ia.QAc(),0<J.length&&Array.addRange(X.ControlList,J);return X}return null}JJf(J){this.PQc.add(J)}Tyl(J){for(const X of this.PQc)if(X.ZMf===J.ZMf){this.PQc.remove(X);break}}static bcj(J,X,Ia=null){J=w.Cxj(J);0<J.length&&(w.Cyd(J,!1),Ia&&Ia(X,J))}static Cxj(J){const X=[];if(J&&J.Fqc&&0<J.Fqc.count)for(const Ia of J.Fqc)if(Ia.controls&&
0<Ia.controls.count)for(const fb of Ia.controls)if(fb.menuItems&&0<fb.menuItems.count)for(const Ab of fb.menuItems)Array.add(X,Ab.id);return X}static Cyd(J,X){if(J.length){var Ia=[];for(const fb of J)Ia.push(appChrome.actions.updateControlEnabledDisabledState(fb,X));appChrome.api.dispatch(Ia)}}}Object(k.a)(w,"ContextMenuExtensibilityCache",null,[1148,1149]);var D=d(25),y=d(334),m=d(111),C=d(68),E=d(7);class F{constructor(J,X,Ia){this._id=J;this.s$h=X;this.Cbi=Ia;this.ozg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get v_d(){return this.s$h}get nWi(){return this.Cbi}execute(J,
X,Ia){Ia=Ia||{};Ia.commandMode=this.ozg;X.invokeAppCommand(this.v_d,this.nWi,Ia,(fb,Ab)=>{J.coh(this.id,this.v_d,fb,Ab)})}}Object(k.a)(F,"AddinNativeActionBase",null,[546]);class B extends F{constructor(J,X){super(1,J,X);this.ozg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(k.a)(B,"AddinTakeSnapshotAction",F,[]);class H{f0f(J,X){let Ia=null;switch(J){case 1:Ia=new B(X,this.Hfe().getNativeActionName(J));break;case 2:Ia=new F(2,X,this.Hfe().getNativeActionName(J));break;case 3:Ia=new F(3,X,this.Hfe().getNativeActionName(J))}return Ia}Hfe(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(k.a)(H,"AddinNativeActionManager",null,[493]);class K{invokeAppCommand(J,X,Ia,fb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(J,X,Ia,fb)}static getInstance(){K.Ja||(K.Ja=new K);return K.Ja}}K.Ja=null;Object(k.a)(K,"OSFAddinCommandsRuntimeManager",null,[494]);var A=d(75);class W{constructor(){this.B7f=this.displayName=this.p6b=this.aJ=this.IN=null;this.isUpgraded=!1}hFg(J,X){return this.IN.getStoreType().toLowerCase()===J.toLowerCase()&&this.IN.getSolutionId().toLowerCase()===X.toLowerCase()}}
Object(k.a)(W,"AddinCommandsResourceItem",null,[]);class N{constructor(){this.yHd=null;this.FMd=0;this.dOd=!1;this.Ma=new A.a;this.egi=new e.a}lxi(J){this.Ma.addHandler("AddinCommandsLoadingMessageChanged",J)}get d3b(){return this.yHd}CRb(J){J!==this.yHd&&(this.yHd=J,this.Ma.raiseEvent("AddinCommandsLoadingMessageChanged"))}DOl(){this.FMd++;this.d3b||this.CRb(CommonUIStrings.l_LoadingAddInsTitle)}J7e(){this.FMd--;this.C$c()&&(this.dOd?this.d3b!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.CRb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.CRb(null))}bQl(){this.dOd=!0;this.CRb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}JWf(){this.dOd=!1;this.C$c()?this.CRb(null):this.CRb(CommonUIStrings.l_LoadingAddInsTitle)}C$c(){return 0>=this.FMd}get lDb(){return this.egi}ybb(J,X,Ia=0){for(const fb of this.lDb)if(fb.hFg(J,X)&&(!fb.aJ||fb.aJ.htj===Ia))return fb;return null}sKf(J,X,Ia,fb){const Ab=new W;Ab.IN=J;Ab.aJ=X;Ab.p6b=Ia;Ab.displayName=fb;this.lDb.add(Ab)}dvi(J,X,Ia,fb){const Ab=new W;Ab.IN=J;Ab.aJ=X;Ab.p6b=null;Ab.B7f=Ia;Ab.displayName=
fb;this.lDb.add(Ab)}Byl(J,X){let Ia=0;for(const fb of this.lDb)fb.IN.getStoreType()===J&&fb.IN.getSolutionId()===X?this.lDb.removeAt(Ia):Ia++}static getInstance(){N.Ja||(N.Ja=new N);return N.Ja}}N.Ja=null;Object(k.a)(N,"AddinCommandsResourceManager",null,[]);var P=d(201),U=d(454),Q=d(165),G=d(136);class Y extends Sys.EventArgs{constructor(){super();this.aJ=this.yx=null}}Object(k.a)(Y,"InsertionParamEventArgs",Sys.EventArgs,[]);class ba{constructor(J,X,Ia,fb,Ab,ec){this.hA=J;this.yx=X;this.oia=Ia;
this.displayName=Ab;this.RHg=ec}}Object(k.a)(ba,"PostLaunchAddinCommandsParameters",null,[]);var ha=d(15),ka=d(16),ca=d(1182),ia=d(35),oa=d(46);class sa{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(k.a)(sa,"AddinAbstract",null,[]);var Ca=d(1264);class Ta{constructor(J,X,Ia,fb=null){this.Jcb=Ab=>{let ec=!1,Uc=null;try{if(0<Ab.data.Ud.length){const Ad=Object(Ca.a)(Object,ia.a(Ab.data.Ud)),Ce=Ad?Ad[this.appName]:null;Ce&&(Uc=Object(Ca.a)(Object,ia.a(Ce.toString())))}ec=
!0}catch(Ad){this.DGa(null)}ec&&this.bYb&&this.bYb(Uc)};this.DGa=Ab=>{this.ZXb&&this.ZXb(Ab?Ab.data:null)};this.mMa=Ab=>{this.Y_b&&this.Y_b(Ab?Ab.data:null)};this.Awc=D.AFrameworkApplication.fa.Ea("RoamingServiceHandlerWebServiceBase");this.appName=J;this.bYb=X;this.ZXb=Ia;this.Y_b=fb}nce(J){this.pjj(J,this.Jcb,this.DGa)}pjj(J,X,Ia){const fb=new Sys.StringBuilder(this.Awc);fb.append("RoamingServiceHandler.ashx?action=");fb.append("getAddinTeachingCalloutSettings");fb.append("&");fb.append(this.Pje(J));
fb.append("&");fb.append(D.AFrameworkApplication.mh);D.AFrameworkApplication.Me.Tj(fb.toString(),1,null,null,!0,2,X,Ia,null)}mXc(J){this.wjj(J)}wjj(J){var X=new Sys.StringBuilder(this.Awc);X.append("RoamingServiceHandler.ashx?action=");X.append("saveAddinTeachingCalloutSettings");X.append("&");X.append(D.AFrameworkApplication.mh);X=X.toString();J=ia.c(J);D.AFrameworkApplication.Me.Tj(X,2,J,null,!0,4,null,this.mMa,null)}Pje(J){const X=new Sys.StringBuilder("requestedsettings=");for(let Ia=0;Ia<J.count;Ia++)X.append(J.ga(Ia)),
Ia<J.count-1&&X.append(";");return X.toString()}}Object(k.a)(Ta,"AddinTeachingUIRoamingRequestHandler",null,[]);class R extends Sys.EventArgs{constructor(J){super();this.solutionId=J.solutionId;this.assetId=J.assetId;this.storeType=J.storeType;this.storeId=J.storeId;this.assetStoreId=J.assetStoreId;this.targetType=J.targetType;this.width=J.width;this.height=J.height;this.displayName=J.displayName;this.version=J.version}}Object(k.a)(R,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);
var Ha=d(121),da=d(166);class Ba{constructor(J){this.Gvb=this.yx=null;this.CHh=!1;this.OPa=this.lDc=this.Mza=this.xj=this.AHd=this.aQb=null;this.M6k=()=>{const X=new ha.ScriptSharpLegacyMap;this.Gvb&&this.Gvb.tabs&&!this.Gvb.tabs[0].isOfficeTab&&X.$("SDX.FeatureFlags","NonOfficeTab");this.NFb(Ba.r5(this.yx),"ClickOnLaunch",X);this.Xld();this.Gvb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Gvb,()=>{const Ia=new Y;Ia.yx=this.yx;this.Ds.raiseEvent(P.a.jIg,Ia)}):n.ULS.sendTraceTag(508625355,
220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};this.C3k=()=>{this.NFb(Ba.r5(this.yx),"ClickOnClose");this.Xld()};this.G4k=()=>{this.NFb(Ba.r5(this.yx),"ClickOnDismiss");this.Xld()};this.Flh=X=>{if(X&&(X=X.detail)&&X.id&&this.nfk(X.id)){const Ia=(X.action||"").toLowerCase();if(X.success&&"opened"===Ia)this.NFb(Ba.r5(this.yx),"CampaignLaunched"),n.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Xld(),window.removeEventListener&&
window.removeEventListener("FGWebSurfaceEvent",this.Flh,!0);else{let fb;try{fb=JSON.stringify(X),n.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+fb)}catch(Ab){fb="id : "+X.id+" telemetryEventName: "+X.telemetryEventName,n.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+fb+" Error: "+(Ab?Ab.toString():""))}}}};this.Jcb=X=>{X?this.oZl(X)?(n.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.aQb="AddinHasShown"in X&&X.AddinHasShown?X.AddinHasShown.toString():
null,this.jZf()):(n.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),this.Mza(this.DSa,null)):(n.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.aQb=null,this.jZf())};this.DGa=X=>{n.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",X?X.Ke:-1);this.Mza(this.DSa,null)};this.mMa=X=>{n.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",X?X.Ke:-1)};this.Ds=J}get appName(){return D.AFrameworkApplication.fa.Ea("WebAppShortName")}get BMf(){this.AHd||
(this.AHd=new Ta(this.appName,this.Jcb,this.DGa,this.mMa));return this.AHd}get DSa(){this.lDc||(this.lDc=new e.a);return this.lDc}set DSa(J){this.lDc=J}get Z$a(){this.OPa||(this.OPa=new e.a);return this.OPa}set Z$a(J){this.OPa=J}Vti(J,X){window.addEventListener?(this.yx=J,this.Gvb=X,window.addEventListener("LaunchAddinTaskpane",this.M6k,!0),window.addEventListener("DismissCallout",this.G4k,!0),window.addEventListener("CloseCallout",this.C3k,!0),window.addEventListener("FGWebSurfaceEvent",this.Flh,
!0)):n.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Acm(J,X,Ia,fb){this.xj=J;this.DSa=X;this.Z$a=Ia;this.Mza=fb;n.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",X?X.count.toString():"null",Ia?Ia.count.toString():"null");0<this.DSa.count||0<this.Z$a.count?(J=new e.a,J.add(this.appName),this.BMf.nce(J)):this.Mza(new e.a,null)}nfk(J){J=oa.a.Dg(J);return-1!==J.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==J.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==J.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==J.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==J.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==J.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}$wd(J){if(this.appName){const X={},Ia={};Ia.LastTeachingUIShowTime=(new Date).toUTCString();Ia.AddinHasShown=J;X[this.appName]=ia.c(Ia);this.BMf.mXc(X);n.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}Xld(){if(!this.CHh){const J=window.g_roamingAddinList;J&&(this.$wd(J),this.CHh=!0)}}jZf(){const J=this.Vaj();0===J.targetType?(J.solutionId?this.vnl(J):this.NFb(null,"NoSolutionId"),this.u3h(J),this.Mza(this.DSa,null)):this.Mza(this.DSa,J);n.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",J.addinId)}vnl(J){const X=new ca.a;X.callbackFunc=Ia=>{if(Ia.errorCode){this.NFb(J.solutionId,"FailToGetAppDetails");var fb=window.g_roamingAddinList;
fb&&this.$wd(fb)}else if(Ia.value)for(fb of Ia.value)if(Ia=fb[1],Ia===J.solutionId){const Ab={};Ab.solutionId=Ia;Ab.assetId=fb[5];Ab.storeType=fb[12];Ab.storeId=fb[11];Ab.assetStoreId=fb[6];Ab.targetType=fb[3];Ab.width=fb[7];Ab.height=fb[8];Ab.displayName=fb[0];Ab.version=fb[4];n.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",J.solutionId);fb=new R(Ab);this.Ds.raiseEvent(P.a.eRh,fb);break}};X.storeType=OSF.StoreTypeEnum.PrivateCatalog;X.fromInsertDialog=
!1;X.refresh=!1;this.xj.queryEntitlementDetails(X)}oZl(J){if("LastTeachingUIShowTime"in J){if(J=+new Date-+new Date(J.LastTeachingUIShowTime.toString()),J<D.AFrameworkApplication.fa.cY("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",J),!1}else n.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}Vaj(){let J=new ka.a(new sa,0),X=new ka.a(new sa,0),Ia=0,fb=0,Ab=0;var ec=new e.a;
for(var Uc of this.DSa)ec.add(Uc);for(const Ad of this.Z$a)ec.add(Ad);for(const Ad of ec)if(!("excatalog"!==Ad.storeType||Ha.b(Ad.installTimeInMS)||!Ad.installTimeInMS||Ad.installTimeInMS<=D.AFrameworkApplication.fa.cY("DateTimeInMSForNewAddin",16409952E5))){ec=Ba.Mfg(Ad);if(this.aQb&&(Uc=this.aQb.split(","),0<Uc.length&&Array.contains(Uc,ec))){Ab++;n.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}ec.startsWith("private_")?(J=Ba.Ukg(Ad,J),fb++):(X=Ba.Ukg(Ad,
X),Ia++)}n.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",fb,Ia,Ab);return 0<X.value?X.key:0<J.value?J.key:Object.assign(new sa,{addinId:null,targetType:-1,solutionId:null})}NFb(J,X,Ia=null){J={["AppTeachingUICalloutAction"]:X,["SDX.Id"]:J,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ia)for(const fb of Ia.keys)J[fb]=Ia.ga(fb);G.a.sendTelemetryEvent(Object.assign(new da.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Q.a.YH(J)}))}u3h(J){J&&(window.g_roamingAddinList=this.aQb?this.aQb+","+J.addinId:J.addinId)}static r5(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static Ukg(J,X){return X.value<J.installTimeInMS?new ka.a(Object.assign(new sa,{addinId:Ba.Mfg(J),targetType:J.targetType,solutionId:J.solutionId}),J.installTimeInMS):X}static Mfg(J){return Telemetry.PrivacyRules.IsPrivateAddin(J.storeType,
J.assetId,null,null,J.storeId)?"private_"+J.installTimeInMS:J.solutionId}}Object(k.a)(Ba,"PrivateCatalogTeachingCalloutHandler",null,[]);class za{constructor(J){this.DPd=null;this.ovf=J}get xfb(){return this.DPd}nvb(J,X=null){this.ovf.nvb(J,X);this.DPd=J}Z2e(J){this.ovf.Z2e(J)}sMh(J){this.DPd=J}}Object(k.a)(za,"RibbonExtensibilityManagerWithChangeDetection",null,[1186]);var Aa=d(74);const na=()=>{const J=Aa.a.CBb(window.location.href.toLowerCase(),"wdomexsrctype");return!!J&&"4"===J},la=()=>Aa.a.CBb(window.location.href.toLowerCase(),
"wdtpl"),va=()=>{const J=Aa.a.CBb(window.location.href.toLowerCase(),"wdomexsrctype");return!!J&&"1"===J},Pa=J=>{let X=null;switch(J){case 0:X="omex";break;case 1:X="spcatalog";break;case 2:X="spapp";break;case 3:X="filesystem";break;case 4:X="exchange";break;case 6:X="registry";break;case 7:X="inmemory";break;case 8:X="uploadfiledevcatalog";break;case 9:X="hardcodedpreinstall";break;case 10:X="excatalog";break;case 16:X="wopicatalog"}return X},Qa=J=>{let X=-1;switch(J.toLowerCase()){case "omex":X=
0;break;case "spcatalog":X=1;break;case "spapp":X=2;break;case "filesystem":X=3;break;case "exchange":X=4;break;case "registry":X=6;break;case "inmemory":X=7;break;case "uploadfiledevcatalog":X=8;break;case "hardcodedpreinstall":X=9;break;case "excatalog":X=10;break;case "wopicatalog":X=16}return X};class Ua{constructor(){this.title=this.id=this.tabs=null}}Object(k.a)(Ua,"AddInDataTransferObject",null,[]);class Ya{constructor(J,X,Ia){this.jDc=J;this.o$h=X;this.p$h=Ia}get zG(){return this.jDc}get Gui(){return this.o$h}get Hui(){return this.p$h}static A$b(J){return(J=
J.Lba)?Object.assign(new Ua,{tabs:J.zG.toArray(),id:J.Gui,title:J.Hui}):null}}Object(k.a)(Ya,"OneLineRibbonExtensibility",null,[]);class Ea{nvb(J,X=null){if(J=Ya.A$b(J)){appChrome.addInApi.dispatchActionsToInstallAddIn(J,X);for(const Ia of J.tabs)if(Ia.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(J,()=>{});break}}}Z2e(J){(J=Ya.A$b(J))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(J)}sMh(){}static hcj(J,X,Ia=null){J=Ea.lKj(J);0<J.length&&(Ea.Cyd(J,!1),Ia&&Ia(X,J))}static lKj(J){const X=
[];if(J&&(J=J.Lba,J.zG&&0<J.zG.count))for(const Ia of J.zG)if(Ia.groups&&0<Ia.groups.length)for(const fb of Ia.groups)if(fb.controls&&0<fb.controls.length)for(const Ab of fb.controls)Array.add(X,Ab.id);return X}static Cyd(J){if(J.length){var X=[];for(const Ia of J)X.push(appChrome.actions.updateControlEnabledDisabledState(Ia,!0));appChrome.api.dispatch(X)}}}Object(k.a)(Ea,"OneLineRibbonExtensibilityManager",null,[1186]);class La{constructor(){this.Ver=1}}Object(k.a)(La,"CacheItem",null,[]);class xb{constructor(){}}
Object(k.a)(xb,"AppsDataCacheManager",null,[1038]);class dc{constructor(){new xb(y.a.instance)}jLh(J,X){J=P.a.qjg()+J;y.a.instance.setItem(J,X.toString())}QIj(){var J=P.a.$mg();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",J);J=y.a.instance.getItem(J);return ia.a(J)}wSl(J){const X=P.a.$mg();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",X);y.a.instance.setItem(X,ia.c(J))}mlk(){return!!y.a.instance.localStorage}static get instance(){dc.Ja||(dc.Ja=new dc);return dc.Ja}}dc.Ja=null;
Object(k.a)(dc,"AddInCommandsCacheManager",null,[996]);var gb=d(550),gc=d(71);class Ac{static Zjg(J){const X=new e.a;if(Ac.ZYf)for(var Ia of Ac.ZYf)X.add(Ia);Ia=null;switch(J){case "Workbook":Ia=Ac.Epm;break;case "Document":Ia=Ac.Kdj;break;case "Presentation":Ia=Ac.wkl}if(Ia)for(const fb of Ia)X.add(fb);return X}}Ac.ZYf=["PrimaryCommandSurface","ContextMenu"];Ac.Epm=null;Ac.Kdj=null;Ac.wkl=null;Object(k.a)(Ac,"ExtensionPointType",null,[]);class $b{constructor(J){this.bBf=null;if(Ha.b(J))throw n.ULS.sendTraceTag(9175315,
220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.z$h=J}get Fqc(){return this.bBf||(this.bBf=new e.a)}get ZMf(){return this.z$h}}Object(k.a)($b,"ContextMenuExtensibility",null,[1144]);class jc{constructor(J,X=null,Ia=0){if(Ha.b(J))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.qki=
J;this.Uoi=X;this.Kei=Ia}get Lba(){return this.qki}get startedNode(){return this.Uoi}get htj(){return this.Kei}}Object(k.a)(jc,"RibbonExtensibility",null,[1225]);class pb{constructor(J){this.Mdi=J.entitlement}get entitlement(){return this.Mdi}createActionContext(J,X){J={};J.ownerAddinInfo=this.entitlement;J.action=X;return J}}Object(k.a)(pb,"AddInCommandsContextProvider",null,[]);class $a{constructor(J,X,Ia){this.Cnf=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=
this.commandSurface=null;this.ribbonBuilder=J;this.eventBuilder=X;this.contextMenuBuilder=Ia}get addinInfo(){return this.Cnf}z2i(J){return new pb(J)}createActionBuilder(J,X){return OfficeExt.DefaultControlActionBinder.createActionBuilder(J,X.entitlement,X.manifest)}startApplyAddin(J){this.Cnf=J;const X=this.z2i(J);this.actionBuilder=this.createActionBuilder(X,J)}endApplyAddin(){}tfe(J,X,Ia=0){return this.ribbonBuilder.zG&&0<this.ribbonBuilder.zG.count?new jc(this.Qsj(J,X),this.addinInfo.startedNode,
Ia):null}jfg(){var J=null;if(this.contextMenuBuilder.rmd&&0<this.contextMenuBuilder.rmd.count){J||(J=this.addinInfo.entitlement.solutionId);J=new $b(J);for(const X of this.contextMenuBuilder.rmd)J.Fqc.add(X);return J}return null}Qsj(J,X){return this.ribbonBuilder.zG&&0<this.ribbonBuilder.zG.count?new Ya(this.ribbonBuilder.zG,J,X):null}}Object(k.a)($a,"AddinCommandsBuilder",null,[]);class zc{constructor(J,X,Ia,fb,Ab,ec,Uc){this.Tob=new gc.a;this.hA=J;this.xj=X;this.lU=Ia;this.XPb=fb;this.J6d=Ab;this.cNa=
ec;this.Cvb=Uc;this.xca=D.AFrameworkApplication.za.DW}i$c(J,X,Ia,fb,Ab,ec,Uc){const Ad=(Ce,ye,hf,Gf)=>{Ab(Ce,ye,hf,Gf);Ce=gb.a[this.hA]+ye.assetId;({value:ye}=this.Tob.Eg(Ce)).returnValue&&(ye.stop(),this.Tob.remove(Ce))};if(0!==this.hA&&J){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",J.count);4===this.hA&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",fb)),this.GTi(J,fb),ec());for(const Ce of J)if(J=Ce,n.ULS.sendTraceTag(17638144,220,50,
String.format("{0}: Install addin {1}",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId))),this.d5h(J))if(Uc&&J.requireConsent)Uc(J,ye=>{try{if(this.xca){const Gf=gb.a[this.hA]+ye.solutionId,Kg=this.xca.lj("ComponentAttach",Gf);this.Tob.$(Gf,Kg)}const hf=this.cNa.ybb(ye.storeType,ye.solutionId);6!==this.hA&&(hf&&(this.KRc(hf),hf.IN.purge(!1)),this.xj.insertOsfControl(this.Etc(ye,X,Ia,Ad)),hf&&this.xj.ownerAddinControlRecreated(ye.solutionId,
ye.storeType))}catch(hf){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(ye.solutionId,ye.ownerAddinStoreType||ye.storeType,ye.assetId,null,null,ye.storeId),ye.version,ye.storeType,ye.storeId,hf.message)),Ad(!1,ye,null,null)}});else try{if(this.xca){const hf=gb.a[this.hA]+J.solutionId,Gf=this.xca.lj("ComponentAttach",hf);this.Tob.$(hf,
Gf)}const ye=this.cNa.ybb(J.storeType,J.solutionId);!D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==D.AFrameworkApplication.za.mb.Ej&&1!==D.AFrameworkApplication.za.mb.Ej&&2!==D.AFrameworkApplication.za.mb.Ej||3!==this.hA||"excatalog"===J.storeType||!ye||ye.isUpgraded?6!==this.hA&&(ye&&(this.KRc(ye),ye.IN.purge(!1)),this.xj.insertOsfControl(this.Etc(J,X,Ia,Ad)),ye&&this.xj.ownerAddinControlRecreated(J.solutionId,J.storeType)):(this.XPb.sMh(ye.aJ),
Ad(!0,J,null,ye.displayName))}catch(ye){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,ye.message)),Ad(!1,J,null,null)}else Ad(!1,J,null,null)}}xvk(J,X,Ia,fb,Ab,ec){const Uc=(Ad,Ce,ye,hf)=>{ec(Ad,Ce,ye,hf);Ad=gb.a[this.hA]+
Ce.solutionId;({value:Ce}=this.Tob.Eg(Ad)).returnValue&&(Ce.stop(),this.Tob.remove(Ad))};if(6===this.hA&&J)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId))),this.d5h(J))try{if(this.xca){const Ce=gb.a[this.hA]+J.solutionId,ye=this.xca.lj("ComponentAttach",Ce);this.Tob.$(Ce,ye)}const Ad=this.cNa.ybb(J.storeType,J.solutionId);Ad||
Uc(!1,J,null,null);D.AFrameworkApplication.za&&D.AFrameworkApplication.za.mb.a4f?this.Bfg(J,X,fb,Ab,Ia,Ce=>{Uc(Ce,J,Ia,Ad.displayName)}):(this.Bfg(J,X,fb,Ab,Ia),Uc(!0,J,Ia,Ad.displayName))}catch(Ad){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,
J.storeId),J.version,J.storeType,J.storeId,Ad.message)),Uc(!1,J,null,null)}else Uc(!1,J,null,null)}g2k(J,X,Ia,fb,Ab,ec){if(ec)if(ec._isAddinCommandsManifest(this.lU.$U))try{D.AFrameworkApplication.za&&D.AFrameworkApplication.za.mb.a4f?this.Afg(J,X,Ia,Ab,ec,Uc=>{fb(Uc,J,ec,ec.getDefaultDisplayName())}):(this.Afg(J,X,Ia,Ab,ec),fb(!0,J,ec,ec.getDefaultDisplayName()))}catch(Uc){n.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,Uc.message)),fb(!1,J,ec,ec.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,
J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId)),fb(!1,J,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.lU.$U,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId)),fb(!1,J,null,null)}Etc(J,X,Ia,fb){const Ab={},ec=document.createElement("div");ec.setAttribute("visible",
"false");Ab.div=ec;Ab.id=J.solutionId;Ab.solutionId=J.solutionId;Ab.version=J.version;Ab.storeType=J.storeType;Ab.storeId=J.storeId;Ab.assetId=J.assetId;Ab.assetStoreId=J.assetStoreId;Ab.isvirtualOsfControl=!0;Ab.virtualOsfControlActivationCallback=(Uc,Ad)=>{const Ce=this.cNa.ybb(J.storeType,J.solutionId);Ce&&(Ce.isUpgraded&&(J.isUpgraded=!0),this.KRc(Ce));this.g2k(J,X,Ia,fb,Uc,Ad)};Ab.reason=3===this.hA?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return Ab}Afg(J,X,Ia,fb,Ab,ec=null){const Uc={};Uc.solutionId=fb.getSolutionId();Uc.version=fb.getVersion();Uc.storeType=fb.getStoreType();Uc.storeId=fb.getStoreId();Uc.assetId=fb.getAssetId();Uc.assetStoreId=fb.getAssetStoreId();Uc.targetType=fb.getOsfControlType();let Ad=null,Ce=null;if(D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ad=(new OfficeExt.Parser.AddinCommandsManifestParser(this.lU.$U,this.lU.formFactor)).parseExtensions(Uc,
Ab,this.Cvb),Ce=Ac.Zjg(this.lU.$U);else try{Ad=(new OfficeExt.Parser.AddinCommandsManifestParser(this.lU.$U,this.lU.formFactor)).parseExtensions(Uc,Ab,this.Cvb),Ce=Ac.Zjg(this.lU.$U)}catch(hf){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+hf.message),hf;}if(Ce&&0<Ce.count){if(D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var ye=X(J);X=Ia(J);Ia=!!D.AFrameworkApplication.fa&&
D.AFrameworkApplication.fa.getBooleanAppSetting("AddinCommandsMultipleCustomTabsEnabled");ye=new $a(ye,null,X);for(const hf of Ce)ye.commandSurface=hf,Ad.apply(ye,this.Cvb,Ia)}else try{const hf=X(J),Gf=Ia(J),Kg=!!D.AFrameworkApplication.fa&&D.AFrameworkApplication.fa.getBooleanAppSetting("AddinCommandsMultipleCustomTabsEnabled");ye=new $a(hf,null,Gf);for(const Lg of Ce)ye.commandSurface=Lg,Ad.apply(ye,this.Cvb,Kg)}catch(hf){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
hf.message),hf;}if(OSF.OUtil.checkFlight(14))try{const hf=ye.tfe(J.solutionId,Ab.getDefaultDisplayName()),Gf=ye.jfg();hf&&this.XPb.nvb(hf,ec);Gf&&this.J6d.JJf(Gf);this.cNa.sKf(fb,hf,Gf,Ab.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Ab.getDefaultDisplayName())}catch(hf){throw OfficeExt.DevConsole.log(hf),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+hf.message),hf;}else try{const hf=ye.tfe(J.solutionId,Ab.getDefaultDisplayName()),
Gf=ye.jfg();hf&&this.XPb.nvb(hf);Gf&&this.J6d.JJf(Gf);this.cNa.sKf(fb,hf,Gf,Ab.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Ab.getDefaultDisplayName())}catch(hf){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+hf.message),hf;}}}Bfg(J,X,Ia,fb,Ab,ec=null){const Uc={};Uc.solutionId=J.solutionId;Uc.version=J.version;Uc.storeType=J.storeType;Uc.storeId=J.storeId;Uc.assetId=J.assetId;Uc.assetStoreId=J.assetStoreId;Uc.targetType=
J.targetType;const Ad=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.lU.$U,this.lU.formFactor);try{const Ce=X.getManifest(),ye=Ad.parse(Uc,Ce,Ab,this.Cvb,X.getSharedRuntimeId(),X),hf=Ia(J),Gf=fb(J),Kg=new $a(hf,null,Gf);Kg.commandSurface="PrimaryCommandSurface";ye.apply(Kg,this.Cvb,!0);if(Kg.ribbonBuilder.zG&&0<Kg.ribbonBuilder.zG.count){const Lg=Kg.tfe(J.solutionId,X.getManifest().getDefaultDisplayName(),1);D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.XPb.nvb(Lg,ec):Lg&&this.XPb.nvb(Lg,ec);this.cNa.dvi(X,Lg,Ab,X.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",X.getManifest().getDefaultDisplayName())}}catch(Ce){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",X.getManifest().getDefaultDisplayName(),Ce.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ce)}}KRc(J){J.aJ&&this.XPb.Z2e(J.aJ);J.p6b&&this.J6d.Tyl(J.p6b);
this.cNa.Byl(J.IN.getStoreType(),J.IN.getSolutionId())}GTi(J,X){X=Pa(X);for(const Ia of this.cNa.lDb){if(Ia.IN.getStoreType()!==X)continue;let fb=!0;for(const Ab of J){const ec=Ab;if(ec&&Ia.hFg(ec.storeType,ec.solutionId)){fb=!1;break}}fb&&(this.KRc(Ia),Ia.IN.purge(!1))}}d5h(J){return!!J&&!!J.solutionId&&!!J.version&&!!J.storeType&&!!J.storeId}}Object(k.a)(zc,"AddInCommandsIntegration",null,[]);var rb=d(1211),ib=d(168),Vb=d(953),Od=d(589),jb=d(356),Wb=d(954),qb=d(144),Ga=d(99),cb=d(64),Ob=d(54);class Db{static get B9(){return Db.BH||
(Db.BH=Ob.a.instance.ub("Common.Utils.IAriaNotifier"))}static k0f(J,X,Ia,fb){Db.dX&&Db.dX.MM&&Db.dX.dismiss();Db.dX=rb.a.X7d(X,J,J,3);Db.dX.content=Ia;Ha.a(fb)||(Db.dX.title=fb,Db.dX.Jcc=!0);J=new Sys.UI.Bounds(0,0,Ga.a.Mbc(),Ga.a.Lbc());Db.dX.B0=Db.lge(J,X,Db.dX.Uca,1);Db.dX.show();Db.B9&&Db.B9.K7(Ia.innerText,!0)}static r7d(J,X,Ia,fb=null){qb.UISurfaces.BM().then(Ab=>{let ec=null;Db.f0b&&(Ab.removeNotification(Db.f0b),Db.f0b=null);const Uc=Ab.callout(Object.assign(new Vb.a,{target:J,title:X,content:Ia,
showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new Wb.a,{onDismiss:()=>{Ab.removeNotification(ec)},directionalHint:null!=fb?fb:null})})),Ad=Object.assign(new jb.a,{expirationOptions:Object.assign(new Od.a,{displayTimeoutSeconds:7,onExpire:()=>{Ab.removeNotification(Db.f0b)}})});ec=Db.f0b=Ab.addNotification(Uc,Ad);return null},Ab=>{n.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Ab);return null})}static B$e(J){Db.dX&&
Db.dX.MM&&Db.dX.dismiss();const X=new m.StandardDialog;X.T3a=!1;X.Fd=0;X.Kz(ib.a.ivk,CommonUIStrings.l_DialogError,Ha.a(J)?Db.uig():J,null)}static h_l(J){Db.dX&&Db.dX.MM&&Db.dX.dismiss();n.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",J.errorCode));const X=Ha.a(J.description)?Db.uig():J.description,Ia=new m.StandardDialog;let fb=null;J.z4b?(Ia.Fd=1,Ia.Te(1,J.buttonText),Ia.uAa(1)):Ia.Fd=0;fb=Ab=>{1===Ab?J.z4b():J.W7b&&J.W7b()};Ia.T3a=!1;0===J.Bpe?
Ia.Kz(J.errorCode,J.title?J.title:CommonUIStrings.l_DialogError,X,fb):1===J.Bpe?Ia.vQ(J.title?J.title:CommonUIStrings.l_DialogWarning,X,fb):Ia.yob(J.title?J.title:CommonUIStrings.l_DialogInfo,X,fb)}static lge(J,X,Ia,fb){let Ab=0===fb?0:4;const ec=J.x+J.width-X.x-X.width;X.x-J.x+X.width/2<=Ia/2?Ab=0===fb?2:5:ec+X.width/2<=Ia/2&&(Ab=0===fb?3:6);return Ab}static s_l(J,X,Ia,fb=!1){(X=Ya.A$b(X))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(X,
Ab=>{Ab&&(fb||Db.r7d(Ab,Ia,J,5))})}static t_l(J,X,Ia=!1){Db.s_l(X.startedNode?X.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,J),X,X.startedNode?X.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,J),Ia)}static r_l(J,X,Ia,fb){if(Db.u4h)J=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ia,fb,CommonUIStrings.l_InsertionDialogRefresh)),Db.r7d(X,J,CommonUIStrings.l_ErrorLoadingAddInsTitle,
1);else{X=cb.a.wi(X);var Ab=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),ec=document.createElement("span");ec.innerText=Ab[0];var Uc=document.createElement("span");Uc.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ia,fb,CommonUIStrings.l_InsertionDialogRefresh);Uc.className="UIFontBold";Ia=document.createElement("span");Ia.innerText=Ab[1];fb=document.createElement("div");Sys.UI.DomElement.addCssClass(fb,"ModalCalloutControl");fb.appendChild(ec);
fb.appendChild(Uc);fb.appendChild(Ia);Db.k0f(J,X,fb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static S0l(J,X){var Ia=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,fb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Db.u4h?Db.r7d(X,Ia,fb):(X=cb.a.wi(X),Db.k0f(J,X,Db.NLi(fb),Ia))}static NLi(J){const X=document.createElement("div");Sys.UI.DomElement.addCssClass(X,"ModalCalloutControl");X.innerText=J;return X}static uig(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get u4h(){return D.AFrameworkApplication.za.mb.Xp&&
D.AFrameworkApplication.za.mb.bYa}}Db.dX=null;Db.f0b=null;Db.BH=null;Object(k.a)(Db,"AddInCommandsNotificationFactory",null,[]);class mb{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad=null){this.Ma=new A.a;this.zHd=J;this.Zbi=X;this.RB=Ia;this.vHf=fb;this.Qtb=Ab;this.q$h=ec;this.mDc=Uc;this.eki=Ad}kxi(J){this.Ma.addHandler(P.a.xMf,J)}gyi(J){this.Ma.addHandler(P.a.jIg,J)}IAi(J){this.Ma.addHandler(P.a.gRh,J)}xxi(J){this.Ma.addHandler(P.a.J1d,J)}Kvk(J,X,Ia){const fb=Ia[P.a.FOc],Ab=void 0===Ia[P.a.Qka]?0:Ia[P.a.Qka];
if(fb&&0!==Ab)if(0>=fb.count&&4!==Ab)this.jvh(new ba(Ab,null,null,X,null,!0));else{var ec=fb.count,Uc=new za(new Ea),Ad=void 0===Ia[P.a.Rka]?-1:Ia[P.a.Rka],Ce=new zc(Ab,this.RB,this.zHd,Uc,this.Zbi,this.Qtb,this.mDc),ye=se=>this.vHf.eLi(se.solutionId,this.mDc,this.zHd,J),hf=se=>this.vHf.gKi(se.solutionId),Gf=(se,xi,gi)=>{ec--;gi=new ba(Ab,xi,Uc,X,gi,0>=ec);if(se&&xi)this.jvh(gi);else{if(3===Ab||xi&&xi.isUpgraded)se="",xi&&(se=Telemetry.PrivacyRules.GetPrivacyCompliantId(xi.solutionId,xi.ownerAddinStoreType||
xi.storeType,xi.assetId,null,null,xi.storeId)),xi={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:se},G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Q.a.YH(xi)}));this.ivh(gi)}ec||D.AFrameworkApplication.za.Gf()},Kg=(se,xi,gi,jf)=>{Gf(se,xi,jf)},Lg=()=>{this.OSe();0>=fb.count&&4===Ab&&this.Qtb.J7e()};6===Ab?(Ad=Ia[P.a.Nej],Ia=Ia[P.a.Oej],Ce.xvk(fb.ga(0),Ad,Ia,ye,hf,(se,xi,gi,jf)=>{Gf(se,xi,jf)})):
Ce.i$c(fb,ye,hf,Ad,Kg,Lg,this.eki)}else G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Q.a.YH({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.zHd.$U)),this.ivh(new ba(Ab,null,null,X,null,!0))}ivh(J){this.OSe(J);this.$Rh(!1,J)}jvh(J){const X=J.yx;let Ia=null;null!==
X&&(Ia=X.storeType,Ia=Ia.toLowerCase());if(J&&"omex"===Ia&&(3===J.hA||X.isUpgraded)){var fb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(X.solutionId,X.ownerAddinStoreType||X.storeType,X.assetId,null,null,X.storeId)};G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Q.a.YH(fb)}))}this.OSe(J);fb=va()&&"omex"===Ia&&!!J.oia&&!!X.solutionId&&2===J.hA&&X.solutionId.toLowerCase()===
la().toLowerCase();var Ab="excatalog"===Ia&&3===J.hA;if("omex"===Ia&&J.oia&&(3===J.hA&&"hardcodedpreinstall"!==Ia||X.isUpgraded)||fb||Ab)fb=new Y,fb.yx=X,fb.aJ=J.oia.xfb,this.Ma.raiseEvent(P.a.J1d,fb);fb=na();Ab=la();fb&&X&&"excatalog"===X.storeType&&J.oia&&5===J.hA&&Ab&&(X.storeId&&X.storeId.toLowerCase()===Ab.toLowerCase()||X.assetId&&X.assetId.toLowerCase()===Ab.toLowerCase())&&(fb=new Y,fb.yx=X,fb.aJ=J.oia.xfb,this.Ma.raiseEvent(P.a.J1d,fb),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));
X&&(dc.instance.jLh(Qa(Ia),!0),"uploadfiledevcatalog"===Ia&&(fb=this.q$h.createAddinDataProvider(Ia,this.RB))&&fb.localCacheAddinCommands(this.RB.nza,X.solutionId,X.version,X.storeId),U.a.uBc(P.a.IOc,"true",Qa(Ia)));this.$Rh(!0,J)}$Rh(J,X){J?X.oia&&5===X.hA&&X.oia.xfb&&void 0!==X.yx.showCallout&&null!==X.yx.showCallout&&X.yx.showCallout?((new Ba(this.Ma)).Vti(X.yx,Ya.A$b(X.oia.xfb)),J=new Y,J.aJ=X.oia.xfb,J.yx=X.yx,this.Ma.raiseEvent(P.a.gRh,J)):3!==X.hA?X.RHg&&this.Qtb.J7e():X.oia&&X.oia.xfb&&"hardcodedpreinstall"!==
X.yx.storeType&&Db.t_l(X.displayName,X.oia.xfb,X.yx.isAutoLaunched):3===X.hA?X.yx&&"uploadfiledevcatalog"===X.yx.storeType.toLowerCase()?(X=this.mDc.SAj(X.yx.solutionId),Db.B$e(X?X:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.Qtb.bQl():X.RHg&&this.Qtb.J7e()}OSe(J=null){var X=J?J.yx:null;const Ia=new Y;if(Ia.yx=X){var fb=this.Qtb.ybb(X.storeType,X.solutionId,6===J.hA?1:0);if(fb&&fb.aJ){Ia.aJ=fb.aJ;var Ab=la();Ab=va()&&!!X.solutionId&&!!Ab&&X.solutionId.toLowerCase()===
Ab.toLowerCase()&&2===J.hA;if(3===J.hA&&"hardcodedpreinstall"!==X.storeType||Ab)J="",fb.aJ.Lba&&fb.aJ.Lba.zG&&(fb=fb.aJ.Lba.zG.ga(0))&&(J=fb.id),X={["SDX_CommandPlacement"]:J,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(X.solutionId,X.ownerAddinStoreType||X.storeType,X.assetId,null,null,X.storeId)},G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Q.a.YH(X)}))}}this.Ma.raiseEvent(P.a.xMf,
Ia)}}Object(k.a)(mb,"LaunchAddinCommandsHandler",null,[1143]);class Vc{constructor(J){this.Bki=J}get nza(){return this.Bki}insertOsfControl(J){return this.nza.insertOsfControl(J)}getManifestInvaildErrorString(){return this.nza.getManifestInvaildErrorString()}isAddinCommandsAsync(J,X){this.nza.isAddinCommandsAsync(J,X)}isAddinCommandsExAsync(J,X){this.nza.isAddinCommandsExAsync(J,X)}ownerAddinControlRecreated(J,X){this.nza.ownerAddinControlRecreated(J,X)}queryEntitlementDetails(J){this.nza.queryEntitlementDetails(J)}}
Object(k.a)(Vc,"ContextActivationMgrWrapper",null,[1145]);class Zb{}Zb.tqb="Alt";Zb.vqb="Command";Zb.id="Id";Zb.q5a="Image16by16";Zb.wqb="LabelText";Zb.button="Button";Zb.vee="FlyoutAnchor";Object(k.a)(Zb,"AddinDataNodeConstants",null,[]);var fc=d(218),ob=d(416),ub=d(321),bc=d(65);class ic{constructor(J,X){this.FIc=this.bqf=null;if(Ha.b(J)||Ha.b(X))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.OJd=X;this._id=J;this.HO[Zb.id]=this._id}get id(){return this._id||""}get HO(){return this.bqf||(this.bqf={})}get controlType(){return this.OJd||""}get menuItems(){return this.FIc||(this.FIc=new e.a)}QAc(){let J=null;this.OJd===Zb.vee?J=Object.assign(new ob.a,{Menu:this.nXk()}):this.OJd===Zb.button&&(J=Object.assign(new fc.a,{}));J&&(this.HO[Zb.id]&&(J.ExternalId=this.HO[Zb.id]),this.HO[Zb.vqb]&&(J.Command=this.HO[Zb.vqb].toString()),this.HO[Zb.wqb]&&(J.LabelText=this.HO[Zb.wqb]),this.HO[Zb.tqb]&&
(J.Alt=this.HO[Zb.tqb]),this.HO[Zb.q5a]&&(bc.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.HO[Zb.q5a]),J.ExternalImageId=this._id));return J}nXk(){const J=Object.assign(new ub.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.FIc){const X=Object.assign(new r.a,{ControlList:[]});for(const Ia of this.FIc)Array.add(X.ControlList,Ia.QAc());Array.add(J.MenuSectionList,X)}return J}}Object(k.a)(ic,"ControlDefinition",null,[1142]);class Rc{constructor(J){this.xda=
null;if(Ha.b(J))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=J;this.Fpc[Zb.id]=this._id}get Fpc(){return this.xda||(this.xda={})}get id(){return this._id||""}QAc(){const J=Object.assign(new fc.a,{});this.xda[Zb.id]&&(J.ExternalId=this.xda[Zb.id]);this.xda[Zb.vqb]&&(J.Command=this.xda[Zb.vqb].toString());this.xda[Zb.wqb]&&(J.LabelText=this.xda[Zb.wqb]);this.xda[Zb.tqb]&&
(J.Alt=this.xda[Zb.tqb]);this.xda[Zb.q5a]&&(bc.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.xda[Zb.q5a]),J.ExternalImageId=this._id);return J}}Object(k.a)(Rc,"MenuItemDefinition",null,[1213]);class Fb{constructor(J){this.GEc=null;if(Ha.b(J))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=J}get id(){return this._id}get controls(){return this.GEc||
(this.GEc=new e.a)}QAc(){const J=[];if(this.GEc)for(const X of this.GEc){const Ia=X.QAc();Ia&&J.push(Ia)}return J}}Object(k.a)(Fb,"OfficeMenuDefinition",null,[1140]);var Qb=d(36);class hc{constructor(J,X,Ia){this.UW=this.Frb=null;this.lRd=J;this.qrb=X;this.Gqb=Ia;this.oji=new e.a}get ind(){return this.lRd}get V5b(){return this.qrb}get sYd(){return this.Gqb}addButton(J){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",J.actionType);this.UW=new ic(this.eTa(J.id),Zb.button);this.UW.HO[Zb.wqb]=
J.label;this.UW.HO[Zb.tqb]=J.label;this.UW.HO[Zb.q5a]=J.icon["16"];this.f4b(this.UW.HO[Zb.id],J.action);this.u9a(this.UW.HO);this.Frb.controls.add(this.UW);this.UW=null}startBuildMenu(J){if(Ha.b(this.Frb))this.Frb=new Fb(J.id);else{const X=this.eTa(J.id);this.UW=new ic(X,Zb.vee);this.Hwb(this.UW.HO,J);this.UW.HO[Zb.q5a]=J.icon["16"];this.UW.HO[Zb.vqb]=Qb.a.x9}}addMenuItem(J){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",J.actionType);const X=new Rc(this.eTa(J.id));this.Hwb(X.Fpc,
J);J.icon&&(X.Fpc[Zb.q5a]=J.icon["16"]);this.f4b(X.Fpc[Zb.id],J.action);this.u9a(X.Fpc);this.UW.menuItems.add(X)}endBuildMenu(){Ha.b(this.UW)?(this.rmd.add(this.Frb),this.Frb=null):(this.Frb.controls.add(this.UW),this.UW=null)}get rmd(){return this.oji}f4b(J,X){this.sYd.bindAction(J,X)}u9a(J){this.V5b.u9a(J)}eTa(J){return this.ind.nGa(J)}Hwb(J,X){J[Zb.wqb]=X.label;J[Zb.tqb]=X.label}}Object(k.a)(hc,"ContextMenuExtensibilityCreator",null,[1195,1191]);class Pc{constructor(J){this.i_b=J}get kqc(){return this.i_b}nGa(J){return this.kqc+
J}}Object(k.a)(Pc,"DefaultContextMenuNamingProvider",null,[1194]);class uc{constructor(J,X,Ia,fb){this.i_b=J;D.AFrameworkApplication.fa.getBooleanAppSetting("AddInCommandsMissingTabIsEnabled")&&Ia.tFj();this.cGf=X;this.goi=fb}get kqc(){return this.i_b}get solutionId(){return this.cGf}get e$e(){return this.goi}nGa(J){J=this.kqc+this.solutionId+J;return this.e$e?(J in uc.JOc||(uc.JOc[J]="AddinControl"+uc.yBi++),uc.JOc[J]):J}j3f(J){if(this.e$e){const Ia=uc.JOc;for(const fb in Ia){var X=fb;if(J===Ia[fb])return X.substr(this.kqc.length+
this.solutionId.length)}}return J}EOj(J){J=this.kqc+this.solutionId+J;return this.e$e?(J in uc.B_d||(uc.B_d[J]="AddinTab"+uc.DBi++),uc.B_d[J]):J}}uc.JOc={};uc.B_d={};uc.DBi=0;uc.yBi=0;Object(k.a)(uc,"DefaultRibbonNamingProvider",null,[1137]);class zb{bindAction(J,X){OfficeExt.DefaultControlActionBinder.bindAction(J,X)}}Object(k.a)(zb,"DefaultUIControlActionBinder",null,[1193]);class ac{constructor(J){this.Bbi=J}get command(){return this.Bbi}u9a(J){J[Zb.vqb]=this.command}}Object(k.a)(ac,"DefaultUIControlCommandBinder",
null,[1192]);var Jb=d(542);class Yc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(k.a)(Yc,"AddInControl",null,[]);class dd{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(k.a)(dd,"AddInGroup",null,[]);class id{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(k.a)(id,"AddInMenuItem",null,[]);class Cc{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(k.a)(Cc,"AddInTab",null,[]);class Nb{constructor(J,X,Ia,fb,Ab,ec){this.jDc=new e.a;this.DWb=this.gCa=this.Grb=null;this.lRd=J;this.Gqb=X;this.qrb=Ia;this.cGf=fb;this.mDc=Ab;this.usf=ec}get ind(){return this.lRd}get zG(){return this.jDc}get sYd(){return this.Gqb}get V5b(){return this.qrb}startBuildTab(J){const X=J.isOfficeTab?J.id:this.ind.EOj(J.id),
Ia=J.isOfficeTab?null:J.label;this.Grb=Object.assign(new Cc,{id:X,title:Ia,isOfficeTab:J.isOfficeTab,visible:J.visible,groups:[],tabType:J.tabType,insertBefore:J.insertBefore,insertAfter:J.insertAfter,autoFocus:J.autoFocus})}startBuildGroup(J){const X=this.eTa(J.id);this.gCa=Object.assign(new dd,{id:X,mlrId:J.mlrId,title:J.label,controls:[],groupType:0})}addNativeGroup(J){this.gCa=Object.assign(new dd,{id:J.id,mlrId:J.mlrId,title:J.label,controls:[],groupType:1});this.Grb.groups.push(this.gCa)}addButton(J){const X=
this.eTa(J.id);X&&(this.f4b(X,J.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",J.actionType),J=Object.assign(new Yc,{id:X,title:J.label,iconLocation:this.die(J),enabled:J.enabled,controlType:0,attributes:this.Hwb()}),this.usf.nJf(new Jb.a(X,this.V5b.command.toString())),this.gCa.controls.push(J))}addNativeControl(J){J.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",J.actionType),J=Object.assign(new Yc,{id:J.id,
title:"",iconLocation:"",enabled:J.enabled,controlType:2,attributes:this.Hwb()}),this.gCa.controls.push(J))}startBuildMenu(J){const X=this.eTa(J.id);X&&(this.DWb=Object.assign(new Yc,{id:X,title:J.label,iconLocation:this.die(J),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(J){const X=this.eTa(J.id);X&&(this.f4b(X,J.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",J.actionType),J=Object.assign(new id,{id:X,title:J.label,iconLocation:this.die(J),
enabled:J.enabled,attributes:this.Hwb()}),this.usf.nJf(new Jb.a(X,this.V5b.command.toString())),this.DWb.menuItems.push(J))}endBuildMenu(){Ha.b(this.DWb.id)||this.gCa.controls.push(this.DWb);this.DWb=null}endBuildGroup(){Ha.b(this.gCa.id)||this.Grb.groups.push(this.gCa);this.gCa=null}endBuildTab(){Ha.b(this.Grb.id)||this.jDc.add(this.Grb);this.Grb=null}Hwb(){const J={};this.u9a(J);return J}die(J){return J.icon["80"]?J.icon["80"]:J.icon["32"]}u9a(J){this.V5b.u9a(J)}eTa(J){return this.ind.nGa(J)}f4b(J,
X){this.sYd.bindAction(J,X)}}Object(k.a)(Nb,"OneLineRibbonExtensibilityCreator",null,[1190,1191]);class nc{constructor(J,X){this.i_b=J;this.Gqb=new zb;this.qrb=new ac(X)}gKi(J){J=new Pc(J);return new hc(J,this.qrb,this.Gqb)}eLi(J,X,Ia,fb){Ia=new uc(this.i_b,J,Ia,!0);return new Nb(Ia,this.Gqb,this.qrb,J,X,fb)}}Object(k.a)(nc,"UIExtensibilityFactory",null,[1139]);class Kc{createAddinDataProvider(J,X){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(J,X.nza)}static get instance(){Kc.Ja||
(Kc.Ja=new Kc);return Kc.Ja}}Kc.Ja=null;Object(k.a)(Kc,"OSFAddinDataProviderFactory",null,[1138]);class xd{constructor(){this.Dvb=null}setErrorMessageForAddin(J,X){this.Dvb||(this.Dvb={});this.Dvb[J]=X}SAj(J){return this.Dvb&&J in this.Dvb?this.Dvb[J]:null}}Object(k.a)(xd,"AddinCommandsErrorManager",null,[]);class Xc{constructor(){this.Bpe=0;this.z4b=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.svg=!1;this.E6j=this.W7b=null}}Object(k.a)(Xc,"AddInCommandsNotificationParameters",
null,[]);class Tb{constructor(){this.mof=this.fHd=null;this.wxg=(J,X)=>{let Ia=null;Ia=()=>{J.getIsUpgrading()?window.setTimeout(Ia,1E3):J.getUpgradingFailed()?Ea.Cyd(X,!0):D.AFrameworkApplication.za.Gf()};window.setTimeout(Ia,1E3)}}get tYd(){return this.fHd||(this.fHd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set tYd(J){this.fHd=J}get nHi(){return this.mof||(this.mof=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(J,
X){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(J,X)}dcc(J,X,Ia,fb,Ab){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",J);if((J=X.ybb(Ab.ownerAddinInfo.storeType,Ab.ownerAddinInfo.solutionId))&&J.IN&&!J.IN.getIsUpgrading())if(X=null,0<J.IN.getNotificationParams().length&&(X=this.eSf(J.IN.getNotificationParams()[0]))&&2147758681===X.errorCode&&(J.isUpgraded=!0),2!==J.IN.getStatus()&&(1!==J.IN.getStatus()||X&&2147758681===X.errorCode))X&&this.bRh(J,X,
null);else try{Ia.setOwnerAddinEToken(J.IN.getEToken()),Ab.action(Ia,fb.nza)}catch(ec){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",D.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?ec.stack:ec.message)),Db.B$e(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}bRh(J,X,Ia=null){const fb=J.IN;if(1===fb.getNotificationParams().length||X.svg){const Ab=X.z4b,ec=X.W7b;X.z4b=
()=>{fb.removeFirstNotification();if(0<fb.getNotificationParams().length){const Uc=this.eSf(fb.getNotificationParams()[0]);this.bRh(J,Uc)}2147758681===X.errorCode&&(Ea.hcj(J.aJ,fb,this.wxg),w.bcj(J.p6b,fb,this.wxg));Ab&&Ab()};X.W7b=()=>{ec&&ec();Ia&&Ia()};Db.h_l(X)}}eSf(J){const X=new Xc;X.Bpe=J.infoType;X.id=J.id;X.title=J.title;X.description=J.description;X.buttonText=J.buttonTxt;X.z4b=J.buttonCallback;X.svg=J.highPriority;X.W7b=J.dismissCallback;X.errorCode=J.errorCode;X.E6j=J.iframeNotificationUrl;
return X}}Object(k.a)(Tb,"AddinCommandsActionHandler",null,[1135]);class he{constructor(){this.labelText=null;this.visible=!1}}Object(k.a)(he,"AddinStatusCommandValues",null,[]);class re{static Nnl(J){const X=new he;X.labelText=J.d3b;X.visible=X.labelText?!0:!1;return X}static aaf(){const J=document.getElementById(void 0);J?re.VRh(void 0,void 0,J,void 0,void 0):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static VRh(J,X,Ia,fb,Ab){Ia?J.d3b===CommonUIStrings.l_ErrorLoadingAddInsTitle?
Db.r_l(X,Ia,fb,Ab):J.d3b===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Db.S0l(X,Ia):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(k.a)(re,"AddinCommandsStatusHandler",null,[]);class ee{constructor(){this.hA=this.wMa=0;this.r_d=null;this.Hsd=this.xDd=0;this.OPa=this.ZLd=this.xHd=null}get HOc(){this.xHd||(this.xHd=new e.a);return this.xHd}get kfe(){this.ZLd||(this.ZLd=new e.a);return this.ZLd}get Z$a(){this.OPa||(this.OPa=
new e.a);return this.OPa}}Object(k.a)(ee,"AddinCommandsListLoaderContext",null,[]);class Yf{constructor(J,X){this.entitlement=J;this.metadata=X}Kef(){var J=this.entitlement;const X={};X.solutionId=J.solutionId;X.version=J.version;X.storeType=J.storeType;X.storeId=J.storeId;X.assetId=J.assetId;X.assetStoreId=J.assetStoreId;X.targetType=J.targetType;X.requireConsent=J.requireConsent||!1;X.isAddinCommands=!0;X.addinCommandsActionType=0;X.targetType=this.targetType;return X}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(k.a)(Yf,"AddinEntitlementEx",null,[]);class ke extends Sys.EventArgs{constructor(J){super();this.properties=J}}Object(k.a)(ke,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class ef{constructor(J,X,Ia){this.Ds=new A.a;this.context=
new ee;this.AWd=null;this.y6k=(fb,Ab,ec,Uc)=>{fb?(fb=new Yf(ec.targetData,Uc),Ab&&this.context.HOc.add(fb),10===this.context.wMa&&(this.context.kfe.add(fb),0===fb.targetType&&this.context.Z$a.add(fb))):(Ab=ec.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ab.solutionId,Ab.storeType,Ab.assetId,null,null,Ab.storeId),Ab.storeType));this.iTe()};this.contextActivationMgr=J;this.zBi=X;this.GOc=Ia;this.appName=D.AFrameworkApplication.fa.Ea("WebAppShortName")}get pXh(){this.AWd||
(this.AWd=new Ba(this.Ds));return this.AWd}jxi(J){this.Ds.addHandler(P.a.wMf,J)}KAi(J){this.Ds.addHandler(P.a.eRh,J)}xem(J){null!==J&&(this.context.wMa=J[P.a.Rka],this.context.hA=J[P.a.Qka],this.context.xDd=this.context.Hsd=0,J=P.a.G9a in J?J[P.a.G9a]:0,-1!==this.context.wMa&&0!==this.context.hA&&(this.context.r_d=this.zBi.createAddinDataProvider(Pa(this.context.wMa),this.contextActivationMgr),this.context.r_d?this.context.r_d.getEntitlementsAsync(this.contextActivationMgr.nza,!0,J,X=>{this.S6k(X)}):
n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.wMa)))}S6k(J){if(J&&0<J.length){this.context.xDd=J.length;const Ia=D.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?la():null;for(let fb=0;fb<J.length;fb++){const Ab=J[fb];if(D.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&va()&&Ab&&Ab.storeType&&"omex"===Ab.storeType.toLowerCase()&&Ab.assetId&&Ia&&Ab.assetId.toLowerCase()===
Ia.toLowerCase()){var X={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:ef.r5(Ab)};G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Q.a.YH(X)}))}!Ab||1!==Ab.targetType&&-1!==Ab.targetType?this.iTe():(X={},D.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(X.solutionId=Ab.solutionId,X.version=Ab.version):(X.marketplaceId=Ab.solutionId,X.marketplaceVersion=Ab.version),
X.storeType=Ab.storeType,X.storeId=Ab.storeId,X.targetData=Ab,this.contextActivationMgr.isAddinCommandsExAsync(X,this.y6k))}}else this.iTe()}iTe(){var J;(J=this.context).Hsd=J.Hsd+1;this.context.Hsd>=this.context.xDd&&(this.GOc.jLh(this.context.wMa,!1),0<this.context.xDd&&10===this.context.wMa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(J=!1,na()&&(J=this.Tzk(this.context.kfe)),this.Yyk(this.context.kfe),J?this.Mza(this.iZf(this.context.HOc)):this.pXh.Acm(this.contextActivationMgr,
this.context.HOc,this.context.Z$a,(X,Ia)=>{const fb=new e.a;for(const Ab of X)X=Ab.Kef(),Ia&&Ia.solutionId===Ab.solutionId&&(X.showCallout=!0,this.pXh.u3h(Ia)),fb.add(X);this.Mza(fb)})):this.Mza(this.iZf(this.context.HOc)))}iZf(J){const X=new e.a;if(J)for(const Ia of J)X.add(Ia.Kef());return X}Mza(J){J&&J.count||U.a.uBc(P.a.IOc,"false",this.context.wMa);J={["ack2"]:J};J[P.a.Rka]=this.context.wMa;J[P.a.Qka]=this.context.hA;this.Ds.raiseEvent(P.a.wMf,new ke(J),this)}Tzk(J){let X=!1;if(J&&1>J.count)return X;
const Ia=la();if(!Ia)return X;for(const fb of J)if(fb.storeId&&fb.storeId.toLowerCase()===Ia.toLowerCase()||fb.assetId&&fb.assetId.toLowerCase()===Ia.toLowerCase())J={["SDX_Id"]:ef.Zmg(fb),["SDX_TargetType"]:Ha.b(fb.targetType)?"":fb.targetType.toString()},G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Q.a.YH(J)})),X=!0;return X}Yyk(J){if(!(J&&1>J.count))if(this.GOc.mlk()){var X=this.GOc.QIj();X?(J=this.Thg(J,X),n.ULS.sendTraceTag(527523848,
306,50,"detect new addins using localStorage")):(J=this.Thg(J,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.GOc.wSl(J)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}Thg(J,X){const Ia={};let fb=!1;for(const Ab of J)if(J=ef.Zmg(Ab))!X||J in X||(this.V5(Ab,J),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===J.toLowerCase()?fb||(fb=!0,Ia[J]=null):Ia[J]=null;return Ia}V5(J,X){var Ia=J.installTimeInMS?(new Date(J.installTimeInMS)).toISOString():
"";Ia={["SDX.Id"]:X,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ha.b(J.targetType)?"":J.targetType.toString(),["SDX.AdminDeploymentTime"]:Ia};G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Q.a.YH(Ia)}));1===J.targetType&&(J={["SDX.Id"]:X,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Q.a.YH(J)})))}static r5(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,
J.storeType,J.assetId,null,null,J.storeId)}static Zmg(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}}Object(k.a)(ef,"AddInCommandsListLoader",null,[]);var yf=d(1174),Rf=d(193),Za=d(1297),Kb=d(28),Ic=d(61),Hc=d(30),jd=d(123);class Id{get f3b(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get u_d(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",
!1)}constructor(J,X,Ia){this.Sfb=this.AIa=this.Nga=this.Sib=null;this.nNe=this.Fid=-1;this.wI=null;this.qah=!1;this.OVe=(fb,Ab)=>{fb="Insert";Hc.a("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.u_d&&(fb="Home");Ab.zha===fb&&(this.Hc.Nvc(this.OVe),this.y4d(Ab.ykh,Ab.zha,this.ZLg,!0))};this.TLg=J;this.Lb=X;this.ZLg=this.Lb.tc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.PFk=this.Lb.tc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.Had=this.Lb.Ea("WebAppShortName");
this.Hc=Ia;oa.a.Ta(this.Had)&&(this.Had="PowerPoint")}r5(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}Oxl(J){this.wI=J;window.addEventListener("LaunchContentAddin",Object(E.a)(this,this.X$k,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(E.a)(this,this.H4k,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(E.a)(this,this.D3k,"onCloseButtonClicked_ContentAddin"),
!0);Hc.a("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.u_d?this.Pxd?(J=appChrome.selectors.getSelectedTabId())&&jd.a(J,"Home")?this.mSh():this.Hc.BSa(this.OVe):n.ULS.sendTraceTag(508564946,802,50,"selector is not ready"):this.Hc.BSa(this.OVe)}K6k(){this.Nga&&this.Sfb&&(this.TLg.dcc({["SourceControlId"]:this.Sfb}),n.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}w_l(J,X){X?(this.Nga=X.yx,(this.Sib=X.aJ)&&this.Sib.Lba&&this.Sib.Lba.zG&&(this.AIa=
this.Sib.Lba.zG.ga(0)),this.AIa?this.AIa.isOfficeTab?(J=this.Nga.solutionId,X=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),J in X?this.Sfb=X[J]:(n.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.r5(this.Nga)),this.Sfb=this.Ltj(this.Sib)),this.Sfb?0<this.AIa.id.indexOf(Ic.a.qAh)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ya.A$b(this.Sib),()=>{this.nSh(this.A1c(this.Sfb))}):this.Hc.BSa(Object(E.a)(this,
this.sqh,"onTabSwitched")):(this.LYa("NoEnabledButtonFound",this.Nga),n.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.hLa())):this.pSh(this.A1c(this.AIa.id),0):(this.LYa("NoTabFound",this.Nga),n.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.hLa())):this.hLa()}sqh(J,X){!this.AIa||void 0===this.AIa.id||null===this.AIa.id||0>oa.a.Dg(this.AIa.id).indexOf(oa.a.Dg(X.zha))||(this.Hc.Nvc(Object(E.a)(this,
this.sqh,"onTabSwitched")),this.y4d(X.ykh,X.zha,this.ZLg,!1))}y4d(J,X,Ia,fb){if(0>Ia)this.LYa("TabSwitchTimeOut",this.Nga);else{var Ab=document.querySelector("button"+this.A1c(X));Ab.hasAttribute("aria-selected")&&"false"!==Ab.getAttribute("aria-selected")?(0<this.nNe&&window.clearTimeout(this.nNe),fb?this.mSh():this.nSh(this.A1c(this.Sfb))):this.nNe=window.setTimeout(()=>{this.y4d(J,X,Ia-1,fb)},1E3)}}A1c(J){return"[id="+J+"]"}mSh(){var J="button[data-unique-id = 'Ribbon-InsertAddIns']";Hc.a("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&
(J=this.u_d&&this.f3b?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":J);var X=(J=document.querySelector(J))?window.getComputedStyle(J,null):null;if(!J||X&&"none"===X.display)if(J=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))n.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.UFb("NoAnchor",this.wI);n.ULS.sendTraceTag(512499850,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else n.ULS.sendTraceTag(512499848,
220,15,"Callout show on OfficeAddin Button");(X=Ob.a.instance.Ha("Common.ISystemInitiatedFeedback"))&&J?(X.execute(Ia=>{Ia.logActivity("ShowTeachingUIForContentAddin",null)}),this.UFb("Show",this.wI),n.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.UFb("NoSifFutureObject",this.wI),n.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}X$k(){this.UFb("ClickOnLaunch",this.wI);this.hLa();const J={};
J.solutionId=this.wI.solutionId;J.assetId=this.wI.assetId;J.assetStoreId=this.wI.assetStoreId;J.height=this.wI.height?this.wI.height:600;J.storeId=this.wI.storeId;J.targetType=this.wI.targetType;J.width=this.wI.width?this.wI.width:600;J.displayName=this.wI.displayName;J.version=this.wI.version;J.storeType=this.wI.storeType;J.isAddinCommands=!1;this.TLg.Kd.AFb("0",3,J)}D3k(){this.UFb("ClickOnClose",this.wI);this.hLa()}H4k(){this.UFb("ClickOnDismiss",this.wI);this.hLa()}pSh(J,X){if(X>this.PFk)window.clearTimeout(this.Fid),
this.oSh("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Ia=document.querySelector("button"+J);!Ia||Ia.hasAttribute("tabIndex")&&"-1"===Ia.getAttribute("tabIndex")?this.Fid=window.setTimeout(()=>{this.pSh(J,X+1)},1E3):(0<this.Fid&&window.clearTimeout(this.Fid),this.oSh(J))}}nSh(J){let X=document.querySelector("button[data-unique-id='RightPaddle']");if(X)this.LYa("RightPaddlePresent",this.Nga);
else if(J=(X=document.querySelector("button"+J))?window.getComputedStyle(X,null):null,!X||J&&"none"===J.display)if(X=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!X){this.LYa("NoAnchor",this.Nga);n.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.hLa();return}this.BZh(X,"ShowTeachingUIForAddinButton")}oSh(J){let X=document.querySelector("button"+J);if(!X&&("[data-unique-id='pivotOverflowButton']"!==J&&(X=document.querySelector("button[data-unique-id='pivotOverflowButton']")),
!X)){this.LYa("NoAnchor",this.Nga);n.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.hLa();return}this.BZh(X,"ShowTeachingUIForAddinTab")}BZh(J,X){J.setAttribute("lpp-id","latestAddin");const Ia=Ob.a.instance.Ha("Common.ISystemInitiatedFeedback");Ia&&J?(this.LYa("Show",this.Nga),Ia.execute(fb=>{fb.logActivity(X,null)}),n.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):(this.LYa("NoSifFutureObject",this.Nga),
n.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.hLa())}Ltj(J){if(!J||!J.Lba||!J.Lba.zG)return null;for(const X of J.Lba.zG)if(X)for(const Ia of X.groups)if(Ia)for(const fb of Ia.controls){if(fb&&fb.attributes&&0===fb.controlType&&fb.enabled)return fb.id;if(fb.menuItems)for(const Ab of fb.menuItems)if(Ab.attributes&&Ab.enabled)return fb.id}return null}LYa(J,X){Id.V5(J,this.r5(X))}UFb(J,X){X=Telemetry.PrivacyRules.GetPrivacyCompliantId(X.solutionId,X.storeType,
X.assetId,null,null,X.storeId);Id.V5(J,X)}$wd(J){const X={};X[this.Had]=ia.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:J});(new Ta(this.Had,null,null,Object(E.a)(this,this.mMa,"postRequestFailureCallback"))).mXc(X);n.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}mMa(J){n.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",J?J.Ke:
-1)}hLa(){if(!this.qah){const J=window.g_roamingAddinList;J&&(this.$wd(J),this.qah=!0)}}static V5(J,X){J={["AppTeachingUICalloutAction"]:J,["SDX.Id"]:X,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};G.a.sendTelemetryEvent(Object.assign(new da.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Q.a.YH(J)}))}get Pxd(){return!!window.appChrome&&!!appChrome.selectors}}Object(k.a)(Id,"AddinTeachingCalloutHandler",null,[]);class ze{}Object(k.a)(ze,
"AddinCommandsHost",null,[]);var Ie=d(83),Cd=d(142);class ue extends Ie.a{constructor(){super(void 0,void 0,void 0,!0);this.RWb="AddinCommandsUILessDialog";this.$Wd="WACDialogTitleText";this.eda="0";this.IQ=380;this.oO=190;this.Fg=this.RWb;this.Fd=5;this.Sbi=String.format("{0}px",this.IQ);this.dda=String.format("{0}px",this.oO);this.rne=this.Is=!1;this.sv()}sv(){super.sv();this.Vm.style.width=this.Sbi;this.Vm.style.height=this.dda;this.Vm.style.padding=this.eda}vAa(J){this.IB();document.getElementById(this.ki(this.$Wd)).innerText=
J}IB(){super.IB();this.Nb.style.width=String.format("{0}px",this.IQ);this.Nb.style.height=String.format("{0}px",this.oO);this.Nb.removeAttribute(Cd.a.Ff);this.Nb.removeAttribute(Cd.a.E4)}hide(){this.hoe()}get Pla(){return this.Vm}initializeAndShowWithTitle(){this.Vj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(k.a)(ue,"AddinCommandsUILessDialog",Ie.a,[1146]);var Ee=d(42),Xe=d(158),Sd=d(38),ad=d(340);class af extends ze{constructor(J,X,Ia,fb){super();this.Taa=J;this.Oc=X;this.ved=Ia;this.Bjb=
fb}setOwnerAddinEToken(J){this.Taa.eToken=J}showTaskpane(J,X,Ia){n.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.dyg(J,X,Ia,!0)||n.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(J,X,Ia){n.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.dyg(J,X,Ia,!1,this.ved)||n.ULS.sendTraceTag(509699667,806,10,String.format("UILess : instance id is null."))}disposeHost(){}dyg(J,
X,Ia,fb,Ab=!1){var ec=this.Oc.TO(J.solutionId);ec||(ec=this.Oc.coj(J,X,this.Taa.solutionId,Ab));if(ec&&this.Oc.fwa(ec.zj))return this.Oc.Imb(ec.zj),Ia(ec.zj,0),Ab||this.Oc.znb(ec.zj,fb),!0;let Uc=null;if(!ec)if(ec=this.Oc.QJi(J,X,fb,this.Taa.solutionId,Ab),ec.setValue(Sd.a.ownerAddinStoreType,this.Taa.storeType),Uc=ec.ra(Xe.a.sharedRuntimeId,null),this.JKg(!!Uc,!0),Ab&&(Ab=Ab&&!Uc),X=Ab?new ue:null,Ab?this.Oc.uob(ec,X.Pla):(ec.setValue(Ee.a.x3b,fb||!!Uc),this.Oc.JEh(ec)),ec=this.Oc.TO(J.solutionId))if(Ab&&
this.Bjb.$(ec.zj,X),J=this.Oc.WFa(this.Taa.solutionId)){if(J=new ad.a(J),this.Oc.C1h(J.id,ec.zj),Uc&&!this.Oc.N9b(J.pqa)&&(J=this.Oc.Sfe(J.pqa)))J.lx||J.Msi(Uc),this.Oc.ONc(this.Taa.solutionId,J)}else{J=this.Oc.PJi(this.Taa,Uc);if(!J)return Ia(null,5001),!1;this.Oc.ONc(this.Taa.solutionId,J);this.Syk(!!Uc)}else return Ia(null,5001),!1;Ia(ec.zj,0);Ia=this.Oc.fwa(ec.zj);this.Oc.znb(ec.zj,Ia?fb:!0);this.JKg(!!Uc,!1);return!0}JKg(J,X){J&&window.performance&&window.performance.memory&&n.ULS.sendTraceTag(509699666,
802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",X,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}Syk(J){n.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Taa.solutionId,this.Taa.storeType,this.Taa.assetId,null,null,this.Taa.storeId),this.Taa.storeType,
J)}}Object(k.a)(af,"WACPowerPointAddInCommandsHost",ze,[]);var pf=d(190);class xf{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad,Ce,ye,hf){this.wI=this.wdh=null;if(!J)throw Error.argumentNull("app");this.Gna=new N;this.qOg=Ia;this.Db=J.Qp;this.ue=Uc;this.Oc=X;this.Hna=ec;this.Oc.ezi(Object(E.a)(this,this.fUi,"clearLoadingAddinMessage"));this.Gna.lxi(Object(E.a)(this,this.JTj,"handleAddinCommandsLoadingMessageChanged"));this.Ba=fb;this.Lb=Ab;yf.a.Wcc=yf.a.Dvh;this.Bjb=new gc.a;this.eHb=Ce;this.Ql=ye;this.CHk=new e.a;
this.OGb=new e.a;this.Hc=hf}get Kd(){return this.Oc}i$c(J){n.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",J[P.a.Qka]);if(this.Ba.ufc||!this.Ba.Wka){var X=J[P.a.FOc];if(X&&0<X.count){const fb=X.count;for(let Ab=fb-1;0<=Ab;Ab--){const ec=X.ga(Ab);OSF.OsfControl.isFirstPartyStoreString(ec.storeType)||X.remove(X.ga(Ab))}X.count<fb&&(this.Ba.ufc&&!this.Ql.Tfa(22)&&this.Ql.vFa(22),this.Ba.Wka||this.Ql.Tfa(36)||this.Ql.vFa(36));if(!X.count)return}}let Ia=null;Ia=D.AFrameworkApplication.fa.getBooleanAppSetting("HostInstallAddInsIsEnabled")?
new mb(this.Hna,this.qOg,new Vc(this.Oc.xj),new nc("",Qb.a.w9a),this.Gna,Kc.instance,new xd,(fb,Ab)=>{const ec={};ec.solutionId=fb.solutionId;ec.version=fb.version;ec.storeType=fb.storeType;ec.storeId=fb.storeId;ec.assetId=fb.assetId;ec.assetStoreId=fb.assetStoreId;this.Oc.Z1l(ec,()=>{Ab(fb)})}):new mb(this.Hna,this.qOg,new Vc(this.Oc.xj),new nc("",Qb.a.w9a),this.Gna,Kc.instance,new xd);Ia.xxi(Object(E.a)(this,this.T2k,"onAutoLaunchAddin"));Ia.kxi(Object(E.a)(this,this.L6k,"onLaunchAddinCommandsCompleted"));
X=new Id(this,this.Lb,this.Hc);Ia.gyi(Object(E.a)(X,X.K6k,"onLaunchAddinButtonClicked"));Ia.IAi(Object(E.a)(X,X.w_l,"showCalloutOnAddin"));try{Rf.a.get_instance().Ij(5,null).continueWith(()=>{Ia.Kvk(this.eHb,Kb.App.Ob.JG(),J)},11)}catch(fb){n.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",fb.message))}}GTj(J){J=J[this.Hna.KTa];J=(new Tb).tYd(J);return D.AFrameworkApplication.Wka||OSF.OsfControl.isFirstPartyStoreString(J.ownerAddinInfo.storeType)}dcc(J){const X=
new Tb;this.Ame(X,J[this.Hna.KTa])}Ame(J,X){const Ia=J.tYd(X),fb=new af(Ia.ownerAddinInfo,this.Oc,this.Ba.cna,this.Bjb);J.dcc(X,this.Gna,fb,new Vc(this.Oc.xj),Ia)}eyh(J){const X=re.Nnl(this.Gna);J[Za.a.LabelText]=X.labelText;J[Za.a.Visible]=X.visible}j_l(){this.aaf()}$Rb(J){J&&P.a.t_d in J&&J[P.a.t_d]&&Db.B$e(J[P.a.t_d].toString())}Sul(){if(this.Gna.C$c()){this.Gna.JWf();const J=this.Wfe();if(J&&0<J.count)for(const X of J)this.QPb({["ack1"]:X,["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(n.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Gna.C$c()),this.QN(10,!0),this.QN(0,!0))}JTj(){this.ue.Gz(new pf.a(2));this.aaf()}get VJ(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}jnl(J){if(J&&P.a.Rka in J)if(this.Oc){var X=J[P.a.Rka];this.VJ?P.a.LOc in J&&(J=J[P.a.LOc],
this.Oc.svc(X,J),1===J&&this.QN(X,!0)):this.QN(X,!0)}else n.ULS.sendTraceTag(508598483,220,10,"queryAddinDetailsWithActionData: abort because m_appForOfficeManager is null.");else n.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}QN(J,X=!1){this.Oc?(n.ULS.sendTraceTag(509669716,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",J,X),this.Oc.QN(J,X)):n.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}QPb(J){n.ULS.sendTraceTag(512499867,
220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",J[P.a.Qka],J[P.a.Rka]);this.Gna.DOl();window.setTimeout(()=>{const X=new ef(new Vc(this.Oc.xj),Kc.instance,dc.instance);X.jxi((Ia,fb)=>{this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.QN(J[P.a.Rka]);this.i$c(fb.properties)});X.KAi((Ia,fb)=>{this.wI=fb;this.wdh=new Id(this,this.Lb,this.Hc);this.wdh.Oxl(this.wI)});X.xem(J)},0)}fUi(){this.Gna.JWf()}hHi(J){var X=
this.Oc.TO(J);if(X&&X.lx&&X.lx.gAa&&!(0>=X.lx.state)){var Ia=new Tb,fb=Ia.getTaskPaneControlIdFromSolutionIdRuntimeId(J,X.lx.gAa);fb&&(this.Oc.ONc(J,X),this.Ame(Ia,fb),this.Oc.OXf(J),(X=this.Oc.TO(J+fb))?this.Oc.setInitialDisplayMode(X.zj,1):n.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+J))}}mHi(J){if(J&&J.solutionId){var X=new Tb,Ia=X.nHi;if(Ia=J.solutionId in Ia?Ia[J.solutionId]:null){let fb=this.Oc.TO(J.solutionId);if(!fb){fb=this.Oc.Sfe(J.solutionId);
if(!fb){n.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)));return}this.Oc.ONc(J.solutionId,fb)}J=fb.settings;(J=P.a.vMf in J?J[P.a.vMf]:null)&&"true"===J.toLowerCase()&&this.Ame(X,Ia)}}else n.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}hXl(J){if(void 0===J||null===J||void 0===J[this.Hna.KTa]||
null===J[this.Hna.KTa])return!1;J=J[this.Hna.KTa];return oa.a.Ta(J)?!1:this.OGb.contains(J)}XSl(J){J=J.Lba;if(!J)n.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(J.zG)for(const X of J.zG)if(X.groups)for(const Ia of X.groups)if(Ia.controls)for(const fb of Ia.controls)if(this.Zcf(fb.id,fb.enabled),1===fb.controlType&&fb.menuItems)for(const Ab of fb.menuItems)this.Zcf(Ab.id,Ab.enabled)}Zcf(J,X){if(J&&J.length){var Ia=this.OGb.contains(J);Ia&&X&&
this.OGb.remove(J);Ia||X||this.OGb.add(J)}}Bhm(J){let X=null,Ia=null,fb=!0;void 0!==J[P.a.Mae]&&null!==J[P.a.Mae]&&void 0!==J[this.Hna.KTa]&&null!==J[this.Hna.KTa]&&void 0!==J[P.a.Kae]&&null!==J[P.a.Kae]&&(X=J[P.a.Mae],Ia=J[this.Hna.KTa],fb=J[P.a.Kae]);oa.a.Ta(X)||oa.a.Ta(Ia)||(J=(new uc("",X,this.Hna,!0)).nGa(Ia),this.Zcf(J,fb),this.Db.Gf())}k9b(J){if(void 0!==J&&null!==J&&void 0!==J[P.a.Lae]&&null!==J[P.a.Lae])switch(J[P.a.Lae]){case 1:this.Bhm(J);break;case 4:this.OGb.clear(),this.OGb.addRange(this.CHk)}}T2k(J,
X){if(X)if(X)if(J=X.yx,X=X.aJ,!va()&&!na()||this.Oc.Sfe(J.solutionId)){var Ia=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(X=J.solutionId in Ia?Ia[J.solutionId]:this.Kxj(X))?(this.dcc({["SourceControlId"]:X}),J.isAutoLaunched=!0):n.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else n.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,
null,J.storeId)));else n.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else n.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}Kxj(J){if(!J)return n.ULS.sendTraceTag(512499859,220,10,"Failed to get button id for addin"),null;J=J.Lba;if(!J||!J.zG||!J.zG.count)return n.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;J=J.zG.ga(0);if(!J.groups||1!==J.groups.length)return n.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;J=J.groups[0];
if(!J.controls||1!==J.controls.length)return n.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;J=J.controls[0];return J.attributes&&0===J.controlType&&J.enabled?J.id:null}L6k(J,X){let Ia=null;X&&(Ia=X);Ia&&Ia.aJ&&this.XSl(Ia.aJ);Ia?(Ia.yx&&this.hHi(Ia.yx.solutionId),this.Ba.Ddk&&window.setTimeout(()=>{Ia.yx&&this.mHi(Ia.yx)},0)):n.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}Wfe(){const J=new e.a;this.Ba.Zva&&(this.Ba.Zte&&
J.add(0),this.Lb.getBooleanAppSetting("187")&&J.add(1),this.Lb.getBooleanAppSetting("305")&&J.add(10),J.add(8));return J}aaf(){const J=this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1),X=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");re.VRh(this.Gna,this.Db.JG(),X,J?ResourceStrings.L_TabHome:ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}Vyc(J){J&&
this.Bjb.Ib(J)&&this.Bjb.ga(J).initializeAndShowWithTitle()}Ucc(J){J&&this.Bjb.Ib(J)&&this.Bjb.ga(J).hide()}}Object(k.a)(xf,"AddinCommandsManager",null,[1353]);class gf{constructor(){this.bdh={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.h0g={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],
["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};this.Igd=null}get KTa(){return"SourceControlId"}get $U(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}tFj(){if(!this.Igd){this.Igd={};for(const J of Object.keys(this.bdh))this.Igd[J]=
this.bdh[J];for(const J of Object.keys(this.h0g))this.Igd[J]=this.h0g[J][0]}}}Object(k.a)(gf,"AddinCommandsStringProvider",null,[1352]);class me{constructor(J){this.G_i=J}qsj(){return this.G_i.hKi()}}Object(k.a)(me,"ContextMenuExtensibilityHandler",null,[1351]);var ag=d(80);class de{constructor(J,X,Ia,fb){this.GKe=null;this.Oc=J;this.tdh=X;this.oa=Ia;this.Wf=fb}get Tgc(){return this.GKe}set Tgc(J){this.GKe=J}register(){this.oa.AG(Object(E.a)(this,this.Oxd,"selectionChangeEventHandler"));Hc.a("ExtensibilitySlideSelectionChangedEventFix")&&
this.Wf.F9a(Object(E.a)(this,this.Oxd,"selectionChangeEventHandler"))}dispose(){this.oa.Xza(Object(E.a)(this,this.Oxd,"selectionChangeEventHandler"));Hc.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Wf.Qvc(Object(E.a)(this,this.Oxd,"selectionChangeEventHandler"))}Oxd(){try{this.Tgc&&this.tdh.Vg(this.Tgc),this.GKe=new ag.a(4,1,0,()=>{this.Tgc=null;this.ecm()},90,"50"),this.tdh.Jb(this.Tgc)}catch(J){n.ULS.sendTraceTag(18442309,802,10,J.toString())}}ecm(){try{this.Oc.czh(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),
null);const X=this.oa.Pk();if(X){var J=X.yj();if(J)for(const Ia of J)if(Ia.$r){const fb=new ad.a(Ia);this.Oc.h2a(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),fb.id,null)}}}catch(X){n.ULS.sendTraceTag(18442310,802,10,X.toString())}}}Object(k.a)(de,"AppForOfficeApiSelectionChangeEventListener",null,[1341,106]);var wa=d(561),ta=d(1010),Eb=d(744);class qc{}qc.Zrj="generalException";qc.invalidArgument="invalidArgument";qc.s0k="notAllowed";qc.wDi="apiNotAvailable";qc.sgm="unresolvedPendingRequest";
qc.timeout="timeout";qc.DYd="adalTimeout";qc.bmm="userNotSignedIn";qc.GFd="userAborted";qc.FSh="silentSignInFailed";qc.L5c="invalidResourceUrl";qc.Vyg="invalidGrant";qc.AZf="connectionLost";qc.CXf="clientError";qc.hca="serverError";Object(k.a)(qc,"WopiHostErrorCodes",null,[]);var Sc=d(245);class td{}Object(k.a)(td,"OAuthCallerMetadata",null,[]);var je=d(55);class Te{constructor(J){this.pN=J;this.Gdi=D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",
!1)}gsi(J,X,Ia,fb,Ab,ec){if(!this.pN)return fb=new ta.a,fb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(fb);const Uc=new td;Uc.AddinName=Ab;Uc.AddinTrustId=ec;let Ad=-1;ec=null;if(fb&&this.SCg())ec=this.pN.u_h(P.a.WCd,J,fb,Te.cng(Ab),Uc);else{const Ce=Date.now();ec=this.pN.vH(P.a.WCd,J,Uc).then(ye=>{Ad=Date.now()-Ce;const hf=(X||Ia)&&"login_required"===ye.ErrorCode;return(X&&("interaction_required"===ye.ErrorCode||"consent_required"===ye.ErrorCode||"invalid_grant"===
ye.ErrorCode)||hf)&&this.SCg()?this.pN.u_h(P.a.WCd,J,null,Te.cng(Ab),Uc):Promise.resolve(ye)})}return ec.then(Ce=>{const ye=new ta.a;Ce.IsSuccess?(ye.token=Ce.Token,Ce.Telemetry&&(ye.Fpb=Ce.Telemetry.fromCache,ye.expiresOn=Ce.Telemetry.expiresOn)):(ye.errorCode=this.LVk(Ce),ye.Gdf=this.vdl(Ce));return ye}).catch(()=>{const Ce=new ta.a;Ce.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Ce)}).then(Ce=>{Ce.pEa="OauthManager";0<=Ad&&(Ce.Gbc=Ad);return Ce})}Zhk(J){const X=
(D.AFrameworkApplication.fa.Ea(D.AFrameworkApplication.uL)||"").toLowerCase();return(je.a.gIa||"teams"===X&&Sc.a.Ddb)&&!Te.rhk(J)||!this.pN||!this.pN.zek()?!1:!0}SCg(){return this.Gdi||1!==Eb.a.KZc()}LVk(J){switch(J.ErrorCode){case "UserCancelled":case "interaction_required":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;
break;case "invalid_client":case "invalid_application_ID":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:J=J.ErrorCode===qc.GFd?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:J.ErrorCode===qc.FSh?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:J.ErrorCode===qc.L5c?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
J.ErrorCode===qc.Vyg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:J.ErrorCode===qc.AZf?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return J}vdl(J){let X="";(J=RegExp("AADSTS(\\d+)").exec(J.ErrorMessage))&&1<J.length&&(X=J[1]);return X}static cng(J){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,J)}static rhk(J){if(!J)return!1;J=J.toLowerCase();for(const X of wa.AppsForOfficeSingleSignOnManager.xYc)if(X===
J)return!0;return!1}}Object(k.a)(Te,"AppsforOfficeTokenFromOauthManager",null,[287]);class Hd{constructor(J){this.RTk=J}static cgf(){if(D.AFrameworkApplication.fa.getBooleanAppSetting("AppForOfficeSSOV2IsEnabled")){var J=null;try{J=Ob.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(X){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+X)}J=new Te(J);Hd.Ja=new Hd(J)}}static getInstance(){Hd.ivf||(Hd.cgf(),Hd.ivf=!0);return Hd.Ja}}Hd.Ja=null;Hd.ivf=!1;Object(k.a)(Hd,
"AppsForOfficeOauthManagerFactory",null,[236]);class mg{constructor(J){const X=Hd.getInstance();this.WFf=new wa.AppsForOfficeSingleSignOnManager(J,X)}getAccessTokenAsync(J,X){return new Promise(Ia=>{const fb=D.AFrameworkApplication.fa.getBooleanAppSetting("342");this.WFf.getAccessToken(J,fb,X,(Ab,ec)=>{const Uc={};Uc.errorCode=Ab;Uc.accessToken=ec?ec.accessToken:"";Ia(Uc)})})}removeCallbackForAddin(J){this.WFf.removeCallbackForAddin(J)}}Object(k.a)(mg,"AppForOfficeAuthProvider",null,[1374]);class fg{X1i(J){return new mg(J)}}
Object(k.a)(fg,"AppForOfficeAuthFactory",null,[1305]);var $e=d(237),oj=d(57),Me=d(48),we=d(639);class Zc{constructor(J,X,Ia,fb,Ab,ec,Uc){this.BOe=this.AOe=this.gMe=this.fMe=0;this.n1g=.5;this.uIb=null;this.IHe=0;this.eGk={};this.Emc=document.createElement("div");this.Emc.className="OsfAddinOverlay";X.appendChild(this.Emc);Ia.LQl(this.Emc);this.bVk=J;this.DF=Uc;this.DF.Y2b(Object(E.a)(this,this.CMb,"onZoomed"));this.sa=fb;this.Jc=Ab;this.xq=ec;this.xq.kU(Object(E.a)(this,this.x2e,"registerSlideViewElementEvents"))}dispose(){this.DF.Kvc(Object(E.a)(this,
this.CMb,"onZoomed"));this.xq.wqa(Object(E.a)(this,this.x2e,"registerSlideViewElementEvents"))}initialize(){if(this.sa.Aa){this.x2e(null,null);const J=this.Jc.Ic;J&&(this.fMe=parseFloat(J.aW.style.left),this.gMe=parseFloat(J.aW.style.top),this.AOe=parseFloat(J.Ee.va.style.left),this.BOe=parseFloat(J.Ee.va.style.top))}this.Mhf();this.CMb(null,new we.a(this.bVk.zoom))}x2e(J,X){(J=this.Jc.Ic)&&J!==this.uIb&&(J.SAi(Object(E.a)(this,this.b3h,"updateOffsetFromSlideView")),J.Tzi(Object(E.a)(this,this.a3h,
"updateOffsetFromPageContentContainer")),this.uIb&&(this.uIb.HCl(Object(E.a)(this,this.b3h,"updateOffsetFromSlideView")),this.uIb.ZBl(Object(E.a)(this,this.a3h,"updateOffsetFromPageContentContainer")),this.Xcf(this.uIb,!1)),X&&X.Y8c&&1!==this.IHe&&this.Xcf(J,!0),this.uIb=J)}Xcf(J,X){if(J&&(J=J.gd)&&J.isConnected){var Ia=J.yj();if(Ia&&Ia.length)for(const Ab of Ia)if(Ab.$r){Ia=Ab.ra(Sd.a.w0,null);var fb=oj.a.Aq(J.$a(Sd.a.sid),J.$a(Sd.a.cid)).toString();const ec=Ab.get_shapeId().toString();Ia=Ia+ec+
fb;Hc.a("Microsoft.Office.SharedOnline.FixBug6808089")?(fb=Ab.vg(0),(null===fb||void 0===fb?0:fb.va)?this.sNa(Ia,X,fb.va.ye):this.sNa(Ia,X,null)):this.sNa(Ia,X,null)}}}X7(J){this.IHe=J;const X=this.Jc.Ic;X?(n.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",X.gd.sid,X.gd.cid),this.Xcf(X,2===J)):n.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}a3h(J,
X){this.fMe=X.x;this.gMe=X.y;this.Mhf()}b3h(J,X){this.AOe=X.x;this.BOe=X.y;this.Mhf()}Mhf(){this.Emc.style.left=Me.a.Rc(this.fMe+this.AOe+$e.a.S7-this.n1g);this.Emc.style.top=Me.a.Rc(this.gMe+this.BOe+$e.a.S7-this.n1g)}jek(J){return J in this.Bta}KJl(J,X){this.Bta[J]=X}sNa(J,X,Ia){1===this.IHe&&X||J in this.Bta&&this.Bta[J].sNa(X,Ia)}ECh(J){J in this.Bta&&(this.Bta[J].dispose(),delete this.Bta[J])}t7e(J,X){J in this.Bta&&this.Bta[J].t7e(X)}CMb(){}get Bta(){return this.eGk}}Object(k.a)(Zc,"AppForOfficeContentAppsContainer",
null,[1350,106]);var te=d(408);class ne extends m.StandardDialog{constructor(J,X){super();this.ebi=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.Ydi=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.Zdi=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.Sci=J;this.QWb=X}showDialog(J,X){const Ia=new Ie.a(void 0,void 0,!1);Ia.Fd=0;Ia.Fg=te.a.wud(Number.MAX_VALUE).toString();Ia.Wg=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
X,this.Zdi,this.Ydi,this.ebi);Ia.Vj(J,Object(E.a)(this,this.x3k,"onCheckboxExecute$4"),{optInCheckbox:!1})}x3k(J,X){1===J&&X.optInCheckbox&&(y.a.instance.getItem("optedIntoAddinDeveloperMode")?y.a.instance.removeItem("optedIntoAddinDeveloperMode"):(y.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Zyc()))}Zyc(){const J=new m.StandardDialog;J.Fd=4;const X=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.Sci)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;J.vQ(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,X,this.QWb)}}Object(k.a)(ne,"AppForOfficeDeveloperModeOptInDialog",m.StandardDialog,[]);const Zf=J=>{const X=[];if(!J)return X;X[OSF.DDA.Marshaling.ThemingKeys.Accent1]=cd(J.Accent1);X[OSF.DDA.Marshaling.ThemingKeys.Accent2]=cd(J.Accent2);X[OSF.DDA.Marshaling.ThemingKeys.Accent3]=cd(J.Accent3);X[OSF.DDA.Marshaling.ThemingKeys.Accent4]=cd(J.Accent4);X[OSF.DDA.Marshaling.ThemingKeys.Accent5]=
cd(J.Accent5);X[OSF.DDA.Marshaling.ThemingKeys.Accent6]=cd(J.Accent6);X[OSF.DDA.Marshaling.ThemingKeys.Background1]=cd(J.OsfColorScheme?J.OsfColorScheme.Background1:null);X[OSF.DDA.Marshaling.ThemingKeys.Background2]=cd(J.OsfColorScheme?J.OsfColorScheme.Background2:null);X[OSF.DDA.Marshaling.ThemingKeys.Text1]=cd(J.OsfColorScheme?J.OsfColorScheme.Text1:null);X[OSF.DDA.Marshaling.ThemingKeys.Text2]=cd(J.OsfColorScheme?J.OsfColorScheme.Text2:null);X[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=cd(J.Hyperlink);
X[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=cd(J.FollowedHyperlink);const Ia=J.OsfFontScheme;Ia&&(X[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Ia.HdEaFt,X[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Ia.HdLtnFt,X[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Ia.HdLclFt,X[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Ia.HdSptFt,X[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Ia.BdEaFt,X[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Ia.BdLtnFt,X[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Ia.BdLclFt,X[OSF.DDA.Marshaling.ThemingKeys.BdScript]=
Ia.BdSptFt);X[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=cd(J.Background);return X},cd=J=>{if(!J)return null;let X;X=J.b;X+=J.g<<8;return X+=J.r<<16};class aj{constructor(J,X,Ia){this.s1g=J;this.tP=X;this.GIk=Ia}register(){this.s1g.Ak(Object(E.a)(this,this.YXh,"themeChangedCallback"))}dispose(){this.s1g.tn(Object(E.a)(this,this.YXh,"themeChangedCallback"))}YXh(J,X){if(X.node.Qa(Sd.a.Ld)&&(X.property===Sd.a.Ld||X.property===Sd.a.Sca)){J=X.node;try{var Ia=Zf(J?J.Ld:null)}catch(fb){return}if(J){J=
J.yj();for(const fb of J)fb.$r&&(J=this.GIk.Q4(fb),this.tP.h2a(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),J.id,Ia))}this.tP.czh(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Ia)}}}Object(k.a)(aj,"AppForOfficeDocumentThemeListener",null,[1341,106]);var Qc=d(225);class Mc extends Ie.a{constructor(J,X,Ia){super();this.ita=null;this.$Wd="WACDialogTitleText";this.eda="0";this.Yra="15px";this.Rbi="0px";this.dda="calc(100% - 30px)";this.Qbi="100%";this.vDf=0;this.Ma=
new A.a;this.u$h=new H;this.Fd=5;this.Fg=this.RWb=Ia;this.AKd=J;this.Rqf=X;this.aLd=!!D.AFrameworkApplication.fa&&D.AFrameworkApplication.fa.getBooleanAppSetting("OfficeAddinEnableInsertDialogAccessibilityFix")}Nyi(J){this.Ma.addHandler("OnDialogClosedEventKey",J)}BRl(){this.ysa=null}sv(){super.sv();this.Vm.style.width="100%";this.Vm.style.height=this.Kcc?this.dda:this.Qbi;this.Vm.style.marginTop=this.Kcc?this.Yra:this.Rbi;this.Vm.style.padding=this.eda}IB(){super.IB();this.Nb.style.width=String.format("{0}px",
this.AKd*window.innerWidth/100);this.Nb.style.height=String.format("{0}px",this.Rqf*window.innerHeight/100);this.Nb.style.minWidth="0px";this.aLd&&D.AFrameworkApplication.isRtl&&100===this.AKd&&(this.Nb.style.right="0px",this.Nb.style.marginRight="0px");this.ita=document.getElementById(this.ki(this.$Wd));this.ita.style.position="absolute";this.ita.style.whiteSpace="nowrap";this.ita.style.textOverflow="ellipsis";D.AFrameworkApplication.isRtl?(this.ita.style.right="14px",this.ita.style.left="44px"):
(this.ita.style.right="44px",this.ita.style.left="14px")}vAa(J){super.vAa(J);this.ita&&this.ita.setAttribute("title",J)}get Pla(){return this.Vm}D4e(){this.Nb.style.width=String.format("{0}px",this.AKd*window.innerWidth/100);this.Nb.style.height=String.format("{0}px",this.Rqf*window.innerHeight/100);this.Nb.style.overflowY="hidden";this.Nb.style.overflowX="hidden";this.Nb.style.marginTop="";this.Nb.style.top="";je.a.Leb&&D.AFrameworkApplication.isRtl?(this.Nb.style.right="",this.Nb.style.marginRight=
""):(this.Nb.style.left="",this.Nb.style.marginLeft="")}hide(){this.u$h.f0f(3,this.RWb).execute(this,K.getInstance(),{});this.vDf=window.setTimeout(()=>{this.Ma.raiseEvent("OnDialogClosedEventKey",this.RWb);Qc.a.prototype.hide.call(this)},500)}coh(J){3===J&&(window.clearTimeout(this.vDf),this.Ma.raiseEvent("OnDialogClosedEventKey",this.RWb),super.hide())}}Object(k.a)(Mc,"AppsForOfficeDialog",Ie.a,[470,471]);class Ig{constructor(){this.dialog=this.Fg=null}}Object(k.a)(Ig,"DialogInfo",null,[]);class wg{}
wg.url="url";wg.height="height";wg.width="width";wg.X$d="displayInIframe";wg.a4c="hideTitle";Object(k.a)(wg,"DialogSettings",null,[]);class fe{constructor(){this.height=this.width=0;this.Fg=this.controlId=this.pageUrl=null;this.a4c=this.X$d=!1}}Object(k.a)(fe,"DisplayDialogParams",null,[]);class Qe extends Sys.EventArgs{constructor(J,X,Ia=null,fb="",Ab=""){super();this.controlId=J;this.messageType=X;this.messageContent=Ia;this.kRe=fb;this.nOa=Ab}}Object(k.a)(Qe,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);class ig extends Sys.EventArgs{constructor(J,X,Ia=null,fb="",Ab=""){super();this.controlId=J;this.messageType=X;this.messageContent=Ia;this.kRe=fb;this.nOa=Ab}}Object(k.a)(ig,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Ph=d(103);class $g{constructor(J){this.Ma=new A.a;this.s4k=(X,Ia)=>{if(X=this.nGa(Ia))this.RB.purgeDialogControl(Ia),$g.Nra.remove(X),this.Ma.raiseEvent("OnMessageParentEventKey",new ig(X,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.RB=J}kzi(J){this.Ma.addHandler("OnMessageParentEventKey",
J)}$Dh(J){this.Ma.removeHandler("OnMessageParentEventKey",J)}jzi(J){this.Ma.addHandler("OnMessageDialogEventKey",J)}EBl(J){this.Ma.removeHandler("OnMessageDialogEventKey",J)}showDialog(J,X,Ia,fb){if($g.Nra.Ib(X))n.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const hf=ia.b(J),Gf=hf[wg.url];if(this.RB.getOsfControl(X).checkAppDomains(Gf)){var Ab=new fe;Ab.width=hf[wg.width];
Ab.height=hf[wg.height];Ab.pageUrl=Gf;Ab.X$d=hf[wg.X$d];Ab.a4c=hf[wg.a4c];Ab.controlId=X;Ab.Fg=Ph.a.create().toString();var ec=new Ig;ec.Fg=Ab.Fg;var Uc=this.RB.getOsfControl(Ab.controlId).getManifest().getDefaultDisplayName(),Ad=this.RB.getOsfControl(Ab.controlId).getStoreType().toLowerCase();J=null;J=(4===D.AFrameworkApplication.za.mb.Ej&&"hardcodedpreinstall"===Ad||"sdxcatalog"===Ad)&&Ab.a4c?this.createAndShowAppsForOfficeDialog(Ab.width,Ab.height,Ab.Fg,!0,Uc):this.createAndShowAppsForOfficeDialog(Ab.width,
Ab.height,Ab.Fg,!1,Uc);var Ce=this.RB.getOsfControl(Ab.controlId),ye=Ce.getManifest();X={};X.id=Ab.Fg;X.solutionId=Ce.getSolutionId();X.version=Ce.getVersion();X.storeType=Ad;X.storeId=Ce.getStoreId();X.assetId=Ce.getAssetId();X.assetStoreId=Ce.getAssetStoreId();X.ownerAddinSolutionId=Ce.getOwnerAddinSolutionId();X.ownerAddinStoreType=Ce.getOwnerAddinStoreType();X.appDomains=ye.getAppDomains();X.dialogUrl=Gf;X.osfControlType=1;X.agaveName=Uc;X.div=J.Pla;n.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(X.solutionId,X.ownerAddinStoreType||X.storeType,X.assetId,null,null,X.storeId),oa.a.gM(Ab.pageUrl));this.RB.insertDialogControl(X);J.Nyi(this.s4k);ec.dialog=J;$g.Nra.$(Ab.controlId,ec);fb&&fb(X);Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else n.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(hf){n.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
hf.message),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}XXk(J,X,Ia,fb){D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===fb&&(fb=Ia);try{const Ab=this.nGa(J);Ab&&this.Ma.raiseEvent("OnMessageParentEventKey",new ig(Ab,OSF.DialogMessageType.DialogMessageReceived,X,Ia,fb))}catch(Ab){return n.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Ab.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}iVi(J,
X){if($g.Nra.Ib(J))try{const Ia=$g.Nra.ga(J);Ia.dialog&&Ia.dialog.hide();this.RB.purgeDialogControl(Ia.Fg);$g.Nra.remove(J);X(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ia){n.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ia.message),X(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else n.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),X(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}IMl(J,
X,Ia,fb){D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===fb&&(fb=Ia);if($g.Nra.Ib(J)&&(J=$g.Nra.ga(J),J.dialog))try{this.Ma.raiseEvent("OnMessageDialogEventKey",new Qe(J.Fg,OSF.DialogMessageType.DialogParentMessageReceived,X,Ia,fb))}catch(Ab){n.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Ab.message)}}nGa(J){let X=null;for(const Ia of $g.Nra)if(Ia.value.Fg===J){X=Ia.key;break}return X}createAndShowAppsForOfficeDialog(J,
X,Ia,fb,Ab){J=new Mc(J,X,Ia);Ab=fb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Ab);fb&&(J.Kcc=!1,J.Is=!1);J.Vj(Ab,null,null);J.BRl();return J}static Sqg(){return $g.Nra}static getInstance(J){$g.Ja||($g.Ja=new $g(J));return $g.Ja}}$g.Ja=null;$g.Nra=new gc.a;Object(k.a)($g,"AppsForOfficeDialogManager",null,[235]);var Vg=d(736),Fg=d(67),bf=d(122),Ag=d(96),ff=d(183),Fe=d(126);class Pf extends Sys.EventArgs{constructor(J){super();this.fea=J}}Object(k.a)(Pf,"AppForOfficeFocusOnAddinPaneEventArgs",
Sys.EventArgs,[]);var Md=d(47);class vg{constructor(J,X,Ia,fb,Ab,ec){this.bS=[];this.iQe=new Vg.a;this.Fa=X;this.Rs=Ia;this.gb=fb;this.Oc=Ab;this.ue=ec}get C4(){return this.bS}get Kd(){return this.Oc.value}one(){return 0<this.Bqc}s0(J){J&&(this.C4.push(J),1===this.Bqc&&this.Fa.qk(Fe.a.U2d,!0),J.isVisible&&this.Rs.addHandler(J.va,Fg.a.Vf,Object(E.a)(this,this.ztg,"handleShortCutsOnAddinPane")))}gDh(J){J&&(Array.remove(this.bS,J),this.Rs.removeHandler(J.va,Fg.a.Vf,Object(E.a)(this,this.ztg,"handleShortCutsOnAddinPane")),
this.Bqc||this.Fa.qk(Fe.a.U2d,!1))}X7(J){if(1===J||2===J){if(1===J){this.iQe=new Vg.a;for(const X of this.C4)X.isVisible&&this.iQe.add(X.id.toLowerCase())}J=2===J;for(const X of this.C4)this.iQe.contains(X.id.toLowerCase())&&(X.zq(J),(J&&1===this.Bqc||!J&&!this.Bqc)&&this.Fa.qk(Fe.a.U2d,J))}}eXj(J,X){for(const Ia of this.bS)J=Ia.layout(J,X)}p7(J,X){if(J){J=null;if(X===Md.a.Ag)for(X=this.bS.length-1;0<=X;X--){if(this.bS[X].isVisible){J=this.bS[X];break}}else if(X===Fe.a.RSf||X===Fe.a.lMi||X===bf.AFrame.pX||
X===bf.AFrame.a$b||X===Fe.a.H4||X===Fe.a.qMi||X===Md.a.bJ||X===Md.a.iK||X===Md.a.VX)for(X=0;X<this.bS.length;X++)if(this.bS[X].isVisible){J=this.bS[X];break}this.Cee(J)}}Cee(J){if(J){var X=this.Kd.pYc(J.id);X&&this.ue.apl(new Pf(X.fea));this.Kd.notifyAgave(J.id,11)}else n.ULS.sendTraceTag(508891138,806,10,"Focus could not be put on the null addin pane!")}aqj(J,X){var Ia;for(Ia=0;Ia<this.bS.length&&this.bS[Ia].id!==J;Ia++);if(Ia===this.bS.length)n.ULS.sendTraceTag(508891137,806,10,String.format("Failed to find the taskpane with instance id: {0}",
J)),this.Dff(X);else{J=null;if(5===X)for(--Ia;0<=Ia;Ia--){if(this.bS[Ia].isVisible){J=this.bS[Ia];break}}else if(6===X)for(Ia+=1;Ia<this.bS.length;Ia++)if(this.bS[Ia].isVisible){J=this.bS[Ia];break}J?this.Cee(J):this.Dff(X)}}Mdg(J){for(const X of this.bS)if(X.id===J){Ag.FocusManager.dr(X.oVi);return}n.ULS.sendTraceTag(508891136,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",J))}Qdm(J){for(const X of $g.Sqg())if(X.value.Fg.toLowerCase()===J.toLowerCase())return X.value.dialog.hide(),
X.key;return null}Dff(J){5===J?this.Fa.yWa(!1):6===J&&this.Fa.yWa(!0)}T$f(){const J=this.gb.Hd();J&&1===J.length&&(this.gb.selectShape(J[0],!0),this.Fa.Gd())}get Bqc(){let J=0;for(const X of this.C4)X.isVisible&&J++;return J}ztg(J){if(J.keyCode===ff.a.O3&&J.ctrlKey)for(var X=0;X<this.C4.length;X++){var Ia=this.C4[X];if(Ia.isVisible&&Ia.va.contains(J.target)){Ia=null;if(J.shiftKey)for(X+=1;X<this.C4.length;X++){if(this.C4[X].isVisible){Ia=this.C4[X];break}}else for(--X;0<=X;X--)if(this.C4[X].isVisible){Ia=
this.C4[X];break}Ia&&(this.Cee(Ia),J.preventDefault(),J.stopPropagation());break}}}Df(J){this.Fa.Df(J)}}Object(k.a)(vg,"AppForOfficeFocusManager",null,[1349]);var Ye=d(974);class Cf{w2i(J,X,Ia){J=Ye.a.gpg(J.llb);J.appName=OSF.AppName.PowerpointWebApp;J.clientMode=1;J.formFactor="DefaultSettings";J.hostControl=X;X=Ob.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");J.allowExternalMarketplace=J.allowExternalMarketplace&&X.q6b;Ia.register(J);Ia=new OSF.ContextActivationManager(J);Ia.setWSA(D.AFrameworkApplication.fj);
return Ia}}Object(k.a)(Cf,"AppForOfficeImportedClassFactory",null,[1348]);class Bg{constructor(J){this.sMg=J}l2e(){for(const J of this.sMg)J.register()}dispose(){for(const J of this.sMg)J.dispose()}}Object(k.a)(Bg,"AppForOfficeListenerManager",null,[1347,106]);var Ae=d(1268),Uf=d(1267),Jd=d(152),We;(function(J){J[J.vBm=0]="myAddins";J[J.Psm=1]="adminManaged";J[J.hCm=2]="popular"})(We||(We={}));Object(k.b)("AddinCollectionType",We);class fd{constructor(){this.AUP=this.priority=0}}Object(k.a)(fd,"AddinDetailInfo",
null,[]);class ui{constructor(J){this.solutionIds=null;this.errorCode=0;this.failure=null;this.N4=J}}Object(k.a)(ui,"AddinCollection",null,[]);class bj extends Sys.EventArgs{constructor(J,X,Ia,fb=null){super();this.sX=J;this.errorCode=X;this.BG=Ia;this.failure=fb}}Object(k.a)(bj,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class nf{constructor(J){this.errorCode=J;this.BG=[];this.failure=null}}Object(k.a)(nf,"GetAddinDetailsResult",null,[]);var ki=d(390);class qf{}Object(k.a)(qf,"GetEntitlementDetailsParameters",
null,[]);var be=d(196),Ud=d(6);class Ei{constructor(J,X,Ia=null){this.Ma=new A.a;this.$w=new Ae.a(Uf.a.gl());this.ro=new Jd.a;this.o4=null;this.Okb=(fb,Ab,ec)=>{if(ec)if(Ei.xhc(fb,ec,window.performance.now()-Ab),0===ec.errorCode){let Ad;if(ec.value){let Ce=0;Ad=Array(ec.value.length);ec.value.forEach(ye=>{Ad[Ce++]=ye})}else Ad=[];this.JF(fb,Ad)}else if(-1===ec.errorCode||10===ec.errorCode)this.JF(fb,[]);else{var Uc={};Uc.collectionType=We[fb];Uc.invokeResultCode=ec.errorCode;Uc["queryResult.Value"]=
ec.value?String.format("Length: {0}",ec.value.length):"null";Uc.queryStart=Ab;Uc.queryDuration=window.performance.now()-Ab;this.ro.$(fb,Object.assign(new ui(fb),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Uc)}));n.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",We[fb],this.ro.ga(fb).failure.toString(),JSON.stringify(this.ro.ga(fb).failure))}else Uc={},Uc.collectionType=
We[fb],Uc.queryResult=ec?"not null":"null",Uc.queryStart=Ab,Uc.queryDuration=window.performance.now()-Ab,this.ro.$(fb,Object.assign(new ui(fb),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Uc)})),n.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",We[fb],this.ro.ga(fb).failure.toString(),JSON.stringify(this.ro.ga(fb).failure))};this.Gpa=(fb,Ab)=>{fb=Object.assign(new ui(Ab.sX),
{solutionIds:new e.a});var ec=Ab.BG;for(const Uc of ec)ec=Uc.solutionId,this.$w.Ib(ec)?this.$w.$(ec,this.Hpc(this.$w.ga(ec),Ab.sX,Uc)):this.$w.add(ec,Uc),fb.solutionIds.add(ec);this.ro.$(Ab.sX,fb)};this.n9=new be.a;this.n9.add(OSF.StoreTypeEnum.MarketPlace,0);this.n9.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.La=J;this.RB=X;this.QB=Ia;this.xYb=Ei.wac(J,"https://store-images.s-microsoft.com");this.wSa(this.Gpa)}get Iec(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get xj(){return this.RB.value}WX(J){if(!this.bna(J))return J=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:We[J]}),Object.assign(new nf(1),{failure:J});if(this.ro.ga(J).failure)return Object.assign(new nf(this.ro.ga(J).errorCode),{failure:this.ro.ga(J).failure});n.ULS.shipAssertTag(509870082,220,!!this.ro.ga(J).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",J);const X=new nf(0);for(const Ia of this.ro.ga(J).solutionIds)this.$w.Ib(Ia)&&
Array.add(X.BG,this.$w.ga(Ia));return X}CAb(J){return this.$w.Ib(J)?this.$w.ga(J):null}Qud(J){if(J){this.wSa(J);for(const Ia of this.ro.keys)if(this.bna(Ia)&&!this.ro.ga(Ia).failure){n.ULS.shipAssertTag(509870081,220,!!this.ro.ga(Ia).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ia);var X=[];for(const fb of this.ro.ga(Ia).solutionIds)Array.add(X,this.$w.ga(fb));X=new bj(Ia,this.ro.ga(Ia).errorCode,X);J(null,X)}}}svc(){}QN(J,X=!1){0!==J&&10!==J?
n.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ki.a[J]):this.Ytc(J,this.Okb,X)}wSa(J){this.Ma.addHandler(P.a.Fvb,J)}fne(J){const X={};X.collectionType=We[J];this.ro.$(J,Object.assign(new ui(J),{errorCode:2,failure:Error.create("The store is disabled.",X)}));n.ULS.sendTraceTag(510253056,220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",We[J],this.ro.ga(J).failure.toString(),JSON.stringify(this.ro.ga(J).failure))}xYl(){return this.bna(2)?
this.La.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.ro.ga(2).failure:!1:!0}Ytc(J,X,Ia=!1){n.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",J);J!==OSF.StoreTypeEnum.MarketPlace&&J!==OSF.StoreTypeEnum.PrivateCatalog?n.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",J):(this.xYl()&&this.queryStoreDisabled(0,(fb,Ab)=>{Ab?this.fne(2):(fb=window.performance.now(),X(2,fb,this.Lje()))}),this.queryStoreDisabled(J,(fb,Ab)=>
{if(fb===OSF.StoreTypeEnum.MarketPlace&&Ab)this.fne(0);else if(fb===OSF.StoreTypeEnum.PrivateCatalog&&Ab)this.fne(1);else{var ec=window.performance.now();this.xj.getEntitlementDetails(Object.assign(new qf,{storeType:fb,refresh:Ia}),Uc=>{X(this.n9.ga(fb),ec,Uc)})}}))}JF(J,X){J=new bj(J,0,X);this.Ma.raiseEvent(P.a.Fvb,J)}bna(J){return this.ro.Ib(J)?!!this.$w:!1}get N3b(){return this.QB?!this.QB.AreThirdPartyAddInsAllowed||this.QB.AppsForOfficeThirdPartyIsDisabled:!this.La.getBooleanAppSetting("AreThirdPartyAddInsAllowed")||
this.La.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")}get ffc(){return this.QB?!this.QB.AppsForOfficeAllowExternalMarketplace:!this.La.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")}get D1a(){return this.QB?this.QB.PopularAddinDetailsJsonString:this.La.Ea("PopularAddinDetailsJsonString")}queryStoreDisabled(J,X){if(this.N3b)X(J,!0);else if(J===OSF.StoreTypeEnum.MarketPlace&&this.ffc)X(J,!0);else{const Ia=Ei.SAc(J);if(Ia){const fb=window.performance.now();this.xj.queryStoreDisabled(Ia,
Ab=>{n.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",J,Ab,fb,window.performance.now()-fb);X(J,Ab)})}else X(J,!1)}}Hpc(J,X,Ia){return J?Ia?2===X?Ei.P0a(Ia,J):Ei.P0a(J,Ia):J:Ia}Lje(){if(!this.o4){const J=JSON.parse(this.D1a);this.Y9b(J);this.o4=J}return Ei.h$a(0,this.o4)}Y9b(J){Ei.E3b(J);this.bwb(J);this.Z9b(J)}bwb(J){const X=this.s4b();for(var Ia=0;Ia<J.length&&0<X.count;Ia++){const fb=J[Ia];if(X.Ib(fb.solutionId)){let Ab=
String.format("Found an override, solutionId: {0}",fb.solutionId);const ec=X.ga(fb.solutionId);ec&&(isNaN(ec.addinInfo.priority)||(Ab=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Ab,fb.addinInfo.priority,ec.addinInfo.priority),fb.addinInfo.priority=ec.addinInfo.priority),isNaN(ec.addinInfo.AUP)||(Ab=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Ab,fb.addinInfo.AUP,ec.addinInfo.AUP),fb.addinInfo.AUP=ec.addinInfo.AUP),ec.displayName&&(Ab=String.format("{0}; DisplayName: update {1} to {2}",
Ab,fb.displayName,ec.displayName),fb.displayName=ec.displayName),ec.iconUrl&&(Ab=String.format("{0}; IconUrl: update {1} to {2}",Ab,fb.iconUrl,ec.iconUrl),fb.iconUrl=ec.iconUrl),ec.description&&(Ab=String.format("{0}; Description: update {1} to {2}",Ab,fb.description,ec.description),fb.description=ec.description));X.remove(fb.solutionId);this.Iec&&n.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Ab)}}for(const fb of X.keys)Ia=X.ga(fb),Ia.displayName&&Ia.iconUrl&&Ia.addinInfo&&
(J.push(Ia),this.Iec&&n.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ia)))}s4b(){const J=new Ae.a(Uf.a.gl());let X=this.La.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!X)return J;X=X.trim();if(12>=X.length)return 0<X.length&&n.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",X),J;this.Iec&&n.ULS.sendTraceTag(509379105,220,
50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",X);try{const Ia=[],fb=X.split("|");for(let Ab=fb.length-1;0<=Ab;Ab--){const ec=fb[Ab],Uc=ec.split("\\");if(2>Uc.length){Ia.push(ec);continue}const Ad=Ei.ysc(Uc);Ad?J.Ib(Ad.solutionId)||J.add(Ad.solutionId,Ad):Ia.push(ec)}this.Iec&&0<Ia.length&&n.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ia.join("|"));this.Iec&&0<J.count&&n.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",
J.count,JSON.stringify(Ud.toArray(J.values)));return J}catch(Ia){n.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",X,Ia.toString())}return J}Z9b(J){for(let X=0;X<J.length;X++)jd.c(J[X].iconUrl.toLowerCase(),"http",0)||(J[X].iconUrl=String.format("{0}/image/apps.{1}",this.xYb,J[X].iconUrl))}static xhc(J,X,Ia){const fb={};fb.AddinCollectionType=We[J];fb.ErrorCode=X.errorCode;fb.AddinCount=X.value?X.value.length:0;n.ULS.sendTraceTag(512231322,
220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Ia,JSON.stringify(fb))}static h$a(J,X){const Ia={};Ia.errorCode=J;Ia.value=X;return Ia}static SAc(J){return J===OSF.StoreTypeEnum.MarketPlace?"omex":J===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static P0a(J,X){X.solutionId=X.solutionId||J.solutionId;X.version=X.version||J.version;X.storeType=X.storeType||J.storeType;X.storeId=X.storeId||J.storeId;X.assetId=X.assetId||J.assetId;X.assetStoreId=X.assetStoreId||
J.assetStoreId;X.displayName=X.displayName||J.displayName;X.provider=X.provider||J.provider;X.description=X.description||J.description;X.iconUrl=X.iconUrl||J.iconUrl;X.webApplicationId=X.webApplicationId||J.webApplicationId;X.highResolutionIconUrl=X.highResolutionIconUrl||J.highResolutionIconUrl;X.licenseUrl=X.licenseUrl||J.licenseUrl;X.privacyUrl=X.privacyUrl||J.privacyUrl;X.addinInfo=X.addinInfo||J.addinInfo;isNaN(X.targetType)&&(X.targetType=J.targetType);isNaN(X.height)&&(X.height=J.height);isNaN(X.width)&&
(X.width=J.width);return X}static E3b(J){for(const X of J)isNaN(X.targetType)&&(X.targetType=1),X.assetId=X.assetId||X.solutionId,X.storeId=X.storeId||"en-US",X.storeType=X.storeType||"omex",X.assetStoreId=X.assetStoreId||"omex",isNaN(X.width)&&(X.width=0),isNaN(X.height)&&(X.height=0)}static ysc(J){const X={};let Ia=0;Ia<J.length&&0<J[Ia].trim().length&&J[Ia].trim().toLowerCase().startsWith("wa")&&(X.solutionId=J[Ia].trim(),X.addinInfo=Object.assign(new fd,{priority:Number.NaN,AUP:Number.NaN}),++Ia<
J.length&&0<J[Ia].trim().length&&(X.addinInfo.priority=parseInt(J[Ia].trim())),++Ia<J.length&&0<J[Ia].trim().length&&(X.addinInfo.AUP=parseInt(J[Ia].trim())),++Ia<J.length&&0<J[Ia].trim().length&&(X.displayName=J[Ia].trim()),++Ia<J.length&&0<J[Ia].trim().length&&(X.iconUrl=J[Ia].trim()),++Ia<J.length&&0<J[Ia].trim().length&&(X.description=J[Ia].trim()));return X.solutionId?X:null}static wac(J,X){J=J.Ea("AddinImageStoreServiceUrl");if(!J)return X;J=J.toLowerCase();return J.startsWith("http://")||J.startsWith("https://")?
J:X}}Object(k.a)(Ei,"AddinDetailsManager",null,[594,595]);class ei{constructor(J,X=0){this.failure=null;this.N4=J;this.errorCode=X}}Object(k.a)(ei,"AddinQueryResult",null,[]);class Aj extends ei{constructor(J,X=0){super(J,X);this.solutionIds=null}}Object(k.a)(Aj,"AddinCollection",ei,[]);var tj;(function(J){J[J.stop=-1]="stop";J[J.s2l=0]="skip";J[J.query=1]="query"})(tj||(tj={}));Object(k.b)("QueryStrategy",tj);var Pi=d(699);class Eh{constructor(J,X,Ia=null){this.Ma=new A.a;this.$w=new Ae.a(Uf.a.gl());
this.ro=new Jd.a;this.j0=new Jd.a;this.o4=null;this.Okb=(fb,Ab,ec)=>{if(ec)if(Eh.xhc(fb,ec,window.performance.now()-Ab),0===ec.errorCode){let Uc;if(ec.value){let Ad=0;Uc=Array(ec.value.length);ec.value.forEach(Ce=>{Uc[Ad++]=Ce})}else Uc=[];this.JF(new ei(fb),Uc)}else-1===ec.errorCode||10===ec.errorCode?this.JF(new ei(fb),[]):(fb=this.C2d(fb,Ab,ec),this.JF(fb));else fb=Eh.D2d(fb,Ab),this.JF(fb)};this.Gpa=(fb,Ab)=>{if(0!==Ab.errorCode)this.ro.$(Ab.sX,Object.assign(new Aj(Ab.sX,Ab.errorCode),{failure:Ab.failure}));
else{fb=Object.assign(new Aj(Ab.sX),{solutionIds:new e.a});var ec=Ab.BG;for(const Uc of ec)ec=Uc.solutionId,this.$w.Ib(ec)?this.$w.$(ec,this.Hpc(this.$w.ga(ec),Ab.sX,Uc)):this.$w.add(ec,Uc),fb.solutionIds.add(ec);this.ro.$(Ab.sX,fb);this.qqa(fb.N4,1)}};this.n9=new be.a;this.n9.add(OSF.StoreTypeEnum.MarketPlace,0);this.n9.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.La=J;this.RB=X;this.QB=Ia;this.xYb=Eh.wac(J,"https://store-images.s-microsoft.com");this.wSa(this.Gpa)}get c0e(){return!!this.La&&this.La.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get VJ(){return!!this.La&&
this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.La&&this.La.getBooleanAppSetting("IsAnonymousUser")}get Aee(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get k$b(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get hma(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get xj(){return this.RB.value}WX(J){if(this.VJ&&!this.sHa(J))return new nf(0);if(!this.bna(J))return J=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:We[J]}),Object.assign(new nf(1),{failure:J});if(this.ro.ga(J).failure)return Object.assign(new nf(this.ro.ga(J).errorCode),{failure:this.ro.ga(J).failure});n.ULS.shipAssertTag(509870082,220,!!this.ro.ga(J).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",J);const X=
new nf(0);for(const Ia of this.ro.ga(J).solutionIds)this.$w.Ib(Ia)&&Array.add(X.BG,this.$w.ga(Ia));return X}CAb(J){return this.$w.Ib(J)?this.$w.ga(J):null}Qud(J){if(J){this.wSa(J);for(const X of this.ro.keys){if(this.VJ&&!this.sHa(X))continue;if(!this.bna(X)||this.ro.ga(X).failure)continue;n.ULS.shipAssertTag(509870081,220,!!this.ro.ga(X).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",X);const Ia=[],fb=this.ro.ga(X);for(const Ab of fb.solutionIds)Array.add(Ia,
this.$w.ga(Ab));J(null,new bj(X,fb.errorCode,Ia,fb.failure))}}}svc(J,X){if(this.VJ&&Eh.ifb(J)){var Ia=Ab=>{this.JF(Eh.f$a(Ab,4,"The connected service is disabled."));this.qqa(Ab,-1)},fb=Ab=>{this.JF(Eh.f$a(Ab,0,"The user doesn't have any addin installed."),[]);this.qqa(Ab,0)};0===J?(this.Adc(0,X,Ia,fb),this.Adc(2,X,Ia,()=>{this.vuc(this.Okb)})):10===J&&this.qqa(1,1)}}QN(J,X=!1){Eh.ifb(J)?this.Ytc(J,this.Okb,X):n.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ki.a[J])}wSa(J){this.Ma.addHandler(P.a.Fvb,
J)}Adc(J,X,Ia,fb){this.sHa(J)||(3===X&&Ia?Ia(J):2===X&&fb?fb(J):this.qqa(J,1))}sHa(J){return this.j0.Ib(J)}qqa(J,X){if(this.VJ){var Ia=this.sHa(J);if(!Ia||-1!==this.j0.ga(J)&&this.j0.ga(J)!==X)n.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",We[J],Ia?tj[this.j0.ga(J)]:"undefined",tj[X]),this.j0.$(J,X)}}C2d(J,X,Ia){const fb={};fb.collectionType=We[J];fb.invokeResultCode=Ia.errorCode;fb["queryResult.Value"]=Ia.value?String.format("Length: {0}",
Ia.value.length):"null";fb.queryStart=X;fb.queryDuration=window.performance.now()-X;return Object.assign(new ei(J,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",fb)})}i$e(){return this.bna(2)?this.La.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.ro.ga(2).errorCode:!1:!0}yyc(J){return this.VJ&&this.j0.Ib(J)?1===this.j0.ga(J):!0}Ytc(J,X,Ia=!1){n.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",J);if(J!==OSF.StoreTypeEnum.MarketPlace&&
J!==OSF.StoreTypeEnum.PrivateCatalog)n.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",J);else{var fb=this.n9.ga(J);this.j$e(J)&&this.yyc(2)&&this.vuc(X);this.yyc(fb)&&(this.k$b&&this.isAnonymousUser?(J=Eh.v2d(fb),this.JF(J)):this.t_e(J,X,Ia))}}j$e(J){return this.c0e?J===OSF.StoreTypeEnum.MarketPlace:!0}t_e(J,X,Ia){this.queryStoreDisabled(J,(fb,Ab)=>{if(fb===OSF.StoreTypeEnum.MarketPlace&&Ab)Ab=Eh.i$a(0),this.JF(Ab);else if(fb===OSF.StoreTypeEnum.PrivateCatalog&&Ab)Ab=Eh.i$a(1),this.JF(Ab);
else{var ec=window.performance.now();this.xj.getEntitlementDetails(Object.assign(new qf,{storeType:fb,refresh:Ia}),Uc=>{X(this.n9.ga(fb),ec,Uc)})}})}vuc(J){this.i$e()&&this.queryStoreDisabled(0,(X,Ia)=>{Ia?(X=Eh.i$a(2),this.JF(X)):(X=window.performance.now(),J(2,X,this.Lje()))})}JF(J,X=null){0!==J.errorCode?(n.ULS.shipAssertTag(509116673,220,!X,"The parameter addinDetails must be null for any failed queries"),n.ULS.shipAssertTag(509116672,220,!!J.failure,"The result.Failure must not be available for any failed queries"),
this.b$e(J)?n.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",We[J.N4],Pi.a[J.errorCode],J.failure?J.failure.toString():"null",JSON.stringify(J.failure)):n.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",We[J.N4],Pi.a[J.errorCode],J.failure?J.failure.toString():"null",JSON.stringify(J.failure))):
(n.ULS.shipAssertTag(509116643,220,!!X,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",We[J.N4]),n.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",We[J.N4],X?X.length:-1));J=new bj(J.N4,J.errorCode,X,J.failure);this.Ma.raiseEvent(P.a.Fvb,J)}b$e(J){return 3===J.errorCode&&(this.k$b&&-2147208619===Eh.zac(J)||this.Aee&&-2===Eh.zac(J))||4===J.errorCode?!1:2!==J.errorCode}bna(J){return this.ro.Ib(J)?
!!this.$w:!1}get N3b(){return this.QB?!this.QB.AreThirdPartyAddInsAllowed||this.QB.AppsForOfficeThirdPartyIsDisabled:!this.La.getBooleanAppSetting("AreThirdPartyAddInsAllowed")||this.La.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")}get ffc(){return this.QB?!this.QB.AppsForOfficeAllowExternalMarketplace:!this.La.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")}get D1a(){return this.QB?this.QB.PopularAddinDetailsJsonString:this.La.Ea("PopularAddinDetailsJsonString")}queryStoreDisabled(J,
X){if(this.N3b)X(J,!0);else if(J===OSF.StoreTypeEnum.MarketPlace&&this.ffc)X(J,!0);else{const Ia=Eh.SAc(J);if(Ia){const fb=window.performance.now();this.xj.queryStoreDisabled(Ia,Ab=>{n.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",J,Ab,fb,window.performance.now()-fb);X(J,Ab)})}else X(J,!1)}}Hpc(J,X,Ia){return J?Ia?2===X?Eh.P0a(Ia,J):Eh.P0a(J,Ia):J:Ia}Lje(){if(!this.o4){const J=JSON.parse(this.D1a);this.Y9b(J);this.o4=J}return Eh.h$a(0,
this.o4)}Y9b(J){Eh.E3b(J);this.bwb(J);this.Z9b(J)}bwb(J){const X=this.s4b();for(var Ia=0;Ia<J.length&&0<X.count;Ia++){const fb=J[Ia];if(X.Ib(fb.solutionId)){let Ab=String.format("Found an override, solutionId: {0}",fb.solutionId);const ec=X.ga(fb.solutionId);ec&&(isNaN(ec.addinInfo.priority)||(Ab=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Ab,fb.addinInfo.priority,ec.addinInfo.priority),fb.addinInfo.priority=ec.addinInfo.priority),isNaN(ec.addinInfo.AUP)||(Ab=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Ab,fb.addinInfo.AUP,ec.addinInfo.AUP),fb.addinInfo.AUP=ec.addinInfo.AUP),ec.displayName&&(Ab=String.format("{0}; DisplayName: update {1} to {2}",Ab,fb.displayName,ec.displayName),fb.displayName=ec.displayName),ec.iconUrl&&(Ab=String.format("{0}; IconUrl: update {1} to {2}",Ab,fb.iconUrl,ec.iconUrl),fb.iconUrl=ec.iconUrl),ec.description&&(Ab=String.format("{0}; Description: update {1} to {2}",Ab,fb.description,ec.description),fb.description=ec.description));X.remove(fb.solutionId);this.hma&&n.ULS.sendTraceTag(509379136,
220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Ab)}}for(const fb of X.keys)Ia=X.ga(fb),Ia.displayName&&Ia.iconUrl&&Ia.addinInfo&&(J.push(Ia),this.hma&&n.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ia)))}s4b(){const J=new Ae.a(Uf.a.gl());let X=this.La.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!X)return J;X=X.trim();if(12>=X.length)return 0<X.length&&n.ULS.sendTraceTag(509379106,
220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",X),J;this.hma&&n.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",X);try{const Ia=[],fb=X.split("|");for(let Ab=fb.length-1;0<=Ab;Ab--){const ec=fb[Ab],Uc=ec.split("\\");if(2>Uc.length){Ia.push(ec);continue}const Ad=Eh.ysc(Uc);Ad?J.Ib(Ad.solutionId)||J.add(Ad.solutionId,Ad):Ia.push(ec)}this.hma&&0<Ia.length&&n.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
Ia.join("|"));this.hma&&0<J.count&&n.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",J.count,JSON.stringify(Ud.toArray(J.values)));return J}catch(Ia){n.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",X,Ia.toString())}return J}Z9b(J){for(let X=0;X<J.length;X++)jd.c(J[X].iconUrl.toLowerCase(),"http",0)||(J[X].iconUrl=String.format("{0}/image/apps.{1}",this.xYb,J[X].iconUrl))}static ifb(J){return 0===
J||10===J}static D2d(J,X){const Ia={};Ia.collectionType=We[J];Ia.queryResult="null";Ia.queryStart=X;Ia.queryDuration=window.performance.now()-X;return Object.assign(new ei(J,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ia)})}static f$a(J,X,Ia){const fb={};fb.collectionType=We[J];J=new ei(J,X);0!==X&&(J.failure=Error.create(Ia,fb));return J}static i$a(J){return Eh.f$a(J,2,"The store is disabled.")}static v2d(J){const X={};X.collectionType=We[J];X.invokeResultCode=-2147208619;
X.queryDuration=0;return Object.assign(new ei(J,3),{failure:Error.create("Anonymous users do not have installed add-ins.",X)})}static zac(J){return J.failure?J.failure.invokeResultCode:-1E3}static xhc(J,X,Ia){const fb={};fb.AddinCollectionType=We[J];fb.ErrorCode=X.errorCode;fb.AddinCount=X.value?X.value.length:0;n.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Ia,JSON.stringify(fb))}static h$a(J,X){const Ia={};Ia.errorCode=J;Ia.value=
X;return Ia}static SAc(J){return J===OSF.StoreTypeEnum.MarketPlace?"omex":J===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static P0a(J,X){X.solutionId=X.solutionId||J.solutionId;X.version=X.version||J.version;X.storeType=X.storeType||J.storeType;X.storeId=X.storeId||J.storeId;X.assetId=X.assetId||J.assetId;X.assetStoreId=X.assetStoreId||J.assetStoreId;X.displayName=X.displayName||J.displayName;X.provider=X.provider||J.provider;X.description=X.description||J.description;X.iconUrl=X.iconUrl||
J.iconUrl;X.webApplicationId=X.webApplicationId||J.webApplicationId;X.highResolutionIconUrl=X.highResolutionIconUrl||J.highResolutionIconUrl;X.licenseUrl=X.licenseUrl||J.licenseUrl;X.privacyUrl=X.privacyUrl||J.privacyUrl;X.addinInfo=X.addinInfo||J.addinInfo;isNaN(X.targetType)&&(X.targetType=J.targetType);isNaN(X.height)&&(X.height=J.height);isNaN(X.width)&&(X.width=J.width);return X}static E3b(J){for(const X of J)isNaN(X.targetType)&&(X.targetType=1),X.assetId=X.assetId||X.solutionId,X.storeId=X.storeId||
"en-US",X.storeType=X.storeType||"omex",X.assetStoreId=X.assetStoreId||"omex",isNaN(X.width)&&(X.width=0),isNaN(X.height)&&(X.height=0)}static ysc(J){const X={};let Ia=0;Ia<J.length&&0<J[Ia].trim().length&&J[Ia].trim().toLowerCase().startsWith("wa")&&(X.solutionId=J[Ia].trim(),X.addinInfo=Object.assign(new fd,{priority:Number.NaN,AUP:Number.NaN}),++Ia<J.length&&0<J[Ia].trim().length&&(X.addinInfo.priority=parseInt(J[Ia].trim())),++Ia<J.length&&0<J[Ia].trim().length&&(X.addinInfo.AUP=parseInt(J[Ia].trim())),
++Ia<J.length&&0<J[Ia].trim().length&&(X.displayName=J[Ia].trim()),++Ia<J.length&&0<J[Ia].trim().length&&(X.iconUrl=J[Ia].trim()),++Ia<J.length&&0<J[Ia].trim().length&&(X.description=J[Ia].trim()));return X.solutionId?X:null}static wac(J,X){J=J.Ea("AddinImageStoreServiceUrl");if(!J)return X;J=J.toLowerCase();return J.startsWith("http://")||J.startsWith("https://")?J:X}}Object(k.a)(Eh,"AddinDetailsManager1",null,[594,595]);class Th{constructor(J,X=null){this.description=this.provider=this.displayName=
this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=J.solutionId;this.version=J.version;this.storeType=J.storeType;this.storeId=J.storeId;this.assetId=J.assetId;this.assetStoreId=J.assetStoreId;this.displayName=J.displayName;this.provider=J.provider;this.description=J.description;this.targetType=
J.targetType;this.height=J.height;this.width=J.width;this.iconUrl=J.iconUrl;this.webApplicationId=J.webApplicationId;this.highResolutionIconUrl=J.highResolutionIconUrl;this.licenseUrl=J.licenseUrl;this.privacyUrl=J.privacyUrl;this.addinInfo=X}Kef(){const J={};J.solutionId=this.solutionId;J.version=this.version;J.storeType=this.storeType;J.storeId=this.storeId;J.assetId=this.assetId;J.assetStoreId=this.assetStoreId;J.targetType=this.targetType;J.displayName=this.displayName;J.width=this.width;J.height=
this.height;return J}}Object(k.a)(Th,"AddinDetail",null,[]);class Qi{constructor(J,X,Ia,fb,Ab){this.BLc=null;this.La=J;this.RB=X;this.$7a=Ia;this.Xli=fb;this.AWb=Ab}QN(J,X){this.xj.queryAppDetails(this.Xli,this.AWb,this.solutionIds,J,(Ia,fb)=>{let Ab=null;if(fb){Ab=Array(fb.length);for(let ec=0;ec<fb.length;ec++)Ab[ec]=new Th(fb[ec],this.gFk(fb[ec].solutionId))}X(Ia,Ab||[])})}get kjk(){return!!this.xj.queryAppDetails}gFk(J){return this.$7a.ga(J)}get solutionIds(){if(!this.BLc){this.BLc=new e.a;for(const J of this.$7a.keys)this.BLc.add(jd.d(J))}return this.BLc.toArray()}get xj(){return this.RB.value}}
Object(k.a)(Qi,"AddinDetailsLoader",null,[]);class fi{constructor(J,X=0){this.failure=null;this.N4=J;this.errorCode=X}}Object(k.a)(fi,"AddinQueryResult",null,[]);class Ng extends fi{constructor(J,X=0){super(J,X);this.Zbf=this.solutionIds=null}}Object(k.a)(Ng,"AddinCollection",fi,[]);var $d=d(1324);class Qf extends $d.a{constructor(){super(Uf.a.gl())}}Object(k.a)(Qf,"AddinDetailTable",$d.a,[]);var Cg;(function(J){J[J.stop=-1]="stop";J[J.s2l=0]="skip";J[J.query=1]="query"})(Cg||(Cg={}));Object(k.b)("QueryStrategy",
Cg);class rh{constructor(J,X,Ia=null){this.Ma=new A.a;this.$w=new Ae.a(Uf.a.gl());this.ro=new Jd.a;this.j0=new Jd.a;this.$7a=this.o4=null;this.Okb=(fb,Ab,ec)=>{ec?(rh.xhc(fb,ec,window.performance.now()-Ab),0===ec.errorCode?(Ab=ec.value?rh.yDi(ec.value):[],this.JF(new fi(fb),Ab)):-1===ec.errorCode||10===ec.errorCode?this.JF(new fi(fb),[]):(fb=this.C2d(fb,Ab,ec),this.JF(fb))):(fb=rh.D2d(fb,Ab),this.JF(fb))};this.Gpa=(fb,Ab)=>{if(0!==Ab.errorCode)this.ro.$(Ab.sX,Object.assign(new Ng(Ab.sX,Ab.errorCode),
{failure:Ab.failure}));else{fb=Object.assign(new Ng(Ab.sX),{solutionIds:new e.a,Zbf:new e.a});var ec=Ab.BG;for(const Ad of ec){ec=Ad.solutionId;const Ce=Ad.storeId;if(this.$w.Ib(ec)){var Uc=this.$w.ga(ec);Uc.Ib(Ce)?Uc.$(Ce,this.Hpc(Uc.ga(Ce),Ab.sX,Ad)):Uc.add(Ce,Ad)}else Uc=new Qf,Uc.add(Ce,Ad),this.$w.add(ec,Uc);fb.solutionIds.add(ec);fb.Zbf.add(Ce)}this.ro.$(Ab.sX,fb);this.qqa(fb.N4,1)}};this.n9=new be.a;this.n9.add(OSF.StoreTypeEnum.MarketPlace,0);this.n9.add(OSF.StoreTypeEnum.PrivateCatalog,1);
this.La=J;this.RB=X;this.QB=Ia;this.xYb=rh.wac(J,"https://store-images.s-microsoft.com");this.cTd=null;this.wSa(this.Gpa)}get c0e(){return!!this.La&&this.La.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get VJ(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.La&&this.La.getBooleanAppSetting("IsAnonymousUser")}get Aee(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",
!0)}get k$b(){return!!this.La&&this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get hma(){return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get xj(){return this.RB.value}get aYe(){this.cTd||(this.cTd=new Qi(this.La,this.RB,this.Hgl,0,this.xj.getAppUILocale()));return this.cTd}WX(J){if(this.VJ&&!this.sHa(J))return new nf(0);if(!this.bna(J))return J=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,
["collectionType"]:We[J]}),Object.assign(new nf(1),{failure:J});const X=this.ro.ga(J);if(X.failure)return Object.assign(new nf(X.errorCode),{failure:X.failure});n.ULS.shipAssertTag(509870082,220,!!X.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",J);const Ia=new nf(0);for(let fb=0;fb<X.solutionIds.count;fb++){const Ab=X.solutionIds.ga(fb),ec=X.Zbf.ga(fb);if(this.$w.Ib(Ab)){const Uc=this.$w.ga(Ab);Uc.Ib(ec)?Array.add(Ia.BG,Uc.ga(ec)):n.ULS.sendTraceTag(508610437,
220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",Ab,J,ec)}else n.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",Ab,J)}return Ia}CAb(J,X=null){if(J=this.Mtj(J))if(X||(X=this.uiCulture),J.Ib(X))return J.ga(X);return null}Mtj(J){return this.$w.Ib(J)?this.$w.ga(J):null}Qud(J){if(J){this.wSa(J);for(const X of this.ro.keys){if(this.VJ&&!this.sHa(X))continue;if(!this.bna(X)||this.ro.ga(X).failure)continue;
n.ULS.shipAssertTag(509870081,220,!!this.ro.ga(X).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",X);const Ia=[],fb=this.ro.ga(X);for(const Ab of fb.solutionIds)Array.add(Ia,this.$w.ga(Ab));J(null,new bj(X,fb.errorCode,Ia,fb.failure))}}}svc(J,X){if(this.VJ&&rh.ifb(J)){var Ia=Ab=>{this.JF(rh.f$a(Ab,4,"The connected service is disabled."));this.qqa(Ab,-1)},fb=Ab=>{this.JF(rh.f$a(Ab,0,"The user doesn't have any addin installed."),[]);this.qqa(Ab,0)};
0===J?(this.Adc(0,X,Ia,fb),this.Adc(2,X,Ia,()=>{this.vuc(this.Okb)})):10===J&&this.qqa(1,1)}}QN(J,X=!1){rh.ifb(J)?this.Ytc(J,this.Okb,X):n.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ki.a[J])}wSa(J){this.Ma.addHandler(P.a.Fvb,J)}Adc(J,X,Ia,fb){this.sHa(J)||(3===X&&Ia?Ia(J):2===X&&fb?fb(J):this.qqa(J,1))}sHa(J){return this.j0.Ib(J)}qqa(J,X){if(this.VJ){var Ia=this.sHa(J);if(!Ia||-1!==this.j0.ga(J)&&this.j0.ga(J)!==X)n.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",
We[J],Ia?Cg[this.j0.ga(J)]:"undefined",Cg[X]),this.j0.$(J,X)}}C2d(J,X,Ia){const fb={};fb.collectionType=We[J];fb.invokeResultCode=Ia.errorCode;fb["queryResult.Value"]=Ia.value?String.format("Length: {0}",Ia.value.length):"null";fb.queryStart=X;fb.queryDuration=window.performance.now()-X;return Object.assign(new fi(J,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",fb)})}i$e(){return this.bna(2)?this.La.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?
3===this.ro.ga(2).errorCode:!1:!0}yyc(J){return this.VJ&&this.j0.Ib(J)?1===this.j0.ga(J):!0}Ytc(J,X,Ia=!1){n.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",J);if(J!==OSF.StoreTypeEnum.MarketPlace&&J!==OSF.StoreTypeEnum.PrivateCatalog)n.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",J);else{var fb=this.n9.ga(J);this.j$e(J)&&this.yyc(2)&&this.vuc(X);this.yyc(fb)&&(this.k$b&&this.isAnonymousUser?(J=rh.v2d(fb),this.JF(J)):this.t_e(J,X,Ia))}}j$e(J){return this.c0e?
J===OSF.StoreTypeEnum.MarketPlace:!0}t_e(J,X,Ia){this.queryStoreDisabled(J,(fb,Ab)=>{if(fb===OSF.StoreTypeEnum.MarketPlace&&Ab)Ab=rh.i$a(0),this.JF(Ab);else if(fb===OSF.StoreTypeEnum.PrivateCatalog&&Ab)Ab=rh.i$a(1),this.JF(Ab);else{var ec=window.performance.now();this.xj.getEntitlementDetails(Object.assign(new qf,{storeType:fb,refresh:Ia}),Uc=>{X(this.n9.ga(fb),ec,Uc)})}})}vuc(J){this.i$e()&&this.queryStoreDisabled(0,(X,Ia)=>{Ia?(X=rh.i$a(2),this.JF(X)):this.Wnl(J)})}JF(J,X=null){0!==J.errorCode?
(n.ULS.shipAssertTag(509116673,220,!X,"The parameter addinDetails must be null for any failed queries"),n.ULS.shipAssertTag(509116672,220,!!J.failure,"The result.Failure must not be available for any failed queries"),this.b$e(J)?n.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",We[J.N4],Pi.a[J.errorCode],J.failure?J.failure.toString():"null",JSON.stringify(J.failure)):n.ULS.sendTraceTag(508610434,220,
50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",We[J.N4],Pi.a[J.errorCode],J.failure?J.failure.toString():"null",JSON.stringify(J.failure))):(n.ULS.shipAssertTag(509116643,220,!!X,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",We[J.N4]),n.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",We[J.N4],
X?X.length:-1));J=new bj(J.N4,J.errorCode,X,J.failure);this.Ma.raiseEvent(P.a.Fvb,J)}b$e(J){return 3===J.errorCode&&(this.k$b&&-2147208619===rh.zac(J)||this.Aee&&-2===rh.zac(J))||4===J.errorCode?!1:2!==J.errorCode}bna(J){return this.ro.Ib(J)?!!this.$w:!1}get uiCulture(){return this.QB&&this.QB.UICulture?this.QB.UICulture:D.AFrameworkApplication.uiCulture}get N3b(){return this.QB?!this.QB.AreThirdPartyAddInsAllowed||this.QB.AppsForOfficeThirdPartyIsDisabled:!this.La.getBooleanAppSetting("AreThirdPartyAddInsAllowed")||
this.La.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")}get ffc(){return this.QB?!this.QB.AppsForOfficeAllowExternalMarketplace:!this.La.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")}get Hgl(){if(!this.$7a){this.$7a=new Ae.a(Uf.a.gl());const J=JSON.parse(this.D1a);for(const X of J)this.$7a.add(X.solutionId,X.addinInfo)}return this.$7a}get D1a(){return this.QB?this.QB.PopularAddinDetailsJsonString:this.La.Ea("PopularAddinDetailsJsonString")}queryStoreDisabled(J,X){if(this.N3b)X(J,
!0);else if(J===OSF.StoreTypeEnum.MarketPlace&&this.ffc)X(J,!0);else{const Ia=rh.SAc(J);if(Ia){const fb=window.performance.now();this.xj.queryStoreDisabled(Ia,Ab=>{n.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",J,Ab,fb,window.performance.now()-fb);X(J,Ab)})}else X(J,!1)}}Hpc(J,X,Ia){return J?Ia?2===X?rh.P0a(Ia,J):rh.P0a(J,Ia):J:Ia}Wnl(J){const X=window.performance.now();if(this.o4)J(2,X,rh.h$a(0,this.o4));else if(this.aYe&&
this.aYe.kjk)this.aYe.QN(!1,(fb,Ab)=>{this.bwb(Ab);this.o4=Ab;J(2,X,rh.h$a(fb,this.o4))});else{var Ia=JSON.parse(this.D1a);this.Y9b(Ia);this.o4=Ia;J(2,X,rh.h$a(0,this.o4))}}Y9b(J){rh.E3b(J);this.bwb(J);this.Z9b(J)}bwb(J){const X=this.s4b();for(var Ia=0;Ia<J.length&&0<X.count;Ia++){const fb=J[Ia];if(X.Ib(fb.solutionId)){let Ab=String.format("Found an override, solutionId: {0}",fb.solutionId);const ec=X.ga(fb.solutionId);ec&&(isNaN(ec.addinInfo.priority)||(Ab=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
Ab,fb.addinInfo.priority,ec.addinInfo.priority),fb.addinInfo.priority=ec.addinInfo.priority),isNaN(ec.addinInfo.AUP)||(Ab=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Ab,fb.addinInfo.AUP,ec.addinInfo.AUP),fb.addinInfo.AUP=ec.addinInfo.AUP),ec.displayName&&(Ab=String.format("{0}; DisplayName: update {1} to {2}",Ab,fb.displayName,ec.displayName),fb.displayName=ec.displayName),ec.iconUrl&&(Ab=String.format("{0}; IconUrl: update {1} to {2}",Ab,fb.iconUrl,ec.iconUrl),fb.iconUrl=ec.iconUrl),ec.description&&
(Ab=String.format("{0}; Description: update {1} to {2}",Ab,fb.description,ec.description),fb.description=ec.description));X.remove(fb.solutionId);this.hma&&n.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Ab)}}for(const fb of X.keys)Ia=X.ga(fb),Ia.displayName&&Ia.iconUrl&&Ia.addinInfo&&(J.push(Ia),this.hma&&n.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ia)))}s4b(){const J=new Ae.a(Uf.a.gl());
let X=this.La.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!X)return J;X=X.trim();if(12>=X.length)return 0<X.length&&n.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",X),J;this.hma&&n.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",X);try{const Ia=[],fb=X.split("|");for(let Ab=fb.length-1;0<=Ab;Ab--){const ec=fb[Ab],Uc=ec.split("\\");if(2>Uc.length){Ia.push(ec);continue}const Ad=
rh.ysc(Uc);Ad?J.Ib(Ad.solutionId)||J.add(Ad.solutionId,Ad):Ia.push(ec)}this.hma&&0<Ia.length&&n.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ia.join("|"));this.hma&&0<J.count&&n.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",J.count,JSON.stringify(Ud.toArray(J.values)));return J}catch(Ia){n.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
X,Ia.toString())}return J}Z9b(J){for(let X=0;X<J.length;X++)jd.c(J[X].iconUrl.toLowerCase(),"http",0)||(J[X].iconUrl=String.format("{0}/image/apps.{1}",this.xYb,J[X].iconUrl))}static ifb(J){return 0===J||10===J}static D2d(J,X){const Ia={};Ia.collectionType=We[J];Ia.queryResult="null";Ia.queryStart=X;Ia.queryDuration=window.performance.now()-X;return Object.assign(new fi(J,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ia)})}static f$a(J,X,Ia){const fb={};fb.collectionType=
We[J];J=new fi(J,X);0!==X&&(J.failure=Error.create(Ia,fb));return J}static i$a(J){return rh.f$a(J,2,"The store is disabled.")}static v2d(J){const X={};X.collectionType=We[J];X.invokeResultCode=-2147208619;X.queryDuration=0;return Object.assign(new fi(J,3),{failure:Error.create("Anonymous users do not have installed add-ins.",X)})}static zac(J){return J.failure?J.failure.invokeResultCode:-1E3}static xhc(J,X,Ia){const fb={};fb.AddinCollectionType=We[J];fb.ErrorCode=X.errorCode;fb.AddinCount=X.value?
X.value.length:0;n.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Ia,JSON.stringify(fb))}static h$a(J,X){const Ia={};Ia.errorCode=J;Ia.value=X;return Ia}static SAc(J){return J===OSF.StoreTypeEnum.MarketPlace?"omex":J===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static P0a(J,X){X.solutionId=X.solutionId||J.solutionId;X.version=X.version||J.version;X.storeType=X.storeType||J.storeType;X.storeId=X.storeId||J.storeId;X.assetId=
X.assetId||J.assetId;X.assetStoreId=X.assetStoreId||J.assetStoreId;X.displayName=X.displayName||J.displayName;X.provider=X.provider||J.provider;X.description=X.description||J.description;X.iconUrl=X.iconUrl||J.iconUrl;X.webApplicationId=X.webApplicationId||J.webApplicationId;X.highResolutionIconUrl=X.highResolutionIconUrl||J.highResolutionIconUrl;X.licenseUrl=X.licenseUrl||J.licenseUrl;X.privacyUrl=X.privacyUrl||J.privacyUrl;X.addinInfo=X.addinInfo||J.addinInfo;isNaN(X.targetType)&&(X.targetType=
J.targetType);isNaN(X.height)&&(X.height=J.height);isNaN(X.width)&&(X.width=J.width);return X}static yDi(J){const X=Array(J.length);for(let Ia=0;Ia<X.length;Ia++)X[Ia]=new Th(J[Ia],J[Ia].addinInfo);return X}static E3b(J){for(const X of J)isNaN(X.targetType)&&(X.targetType=1),X.assetId=X.assetId||X.solutionId,X.storeId=X.storeId||"en-US",X.storeType=X.storeType||"omex",X.assetStoreId=X.assetStoreId||"omex",isNaN(X.width)&&(X.width=0),isNaN(X.height)&&(X.height=0)}static ysc(J){const X={};let Ia=0;
Ia<J.length&&0<J[Ia].trim().length&&J[Ia].trim().toLowerCase().startsWith("wa")&&(X.solutionId=J[Ia].trim(),X.addinInfo=Object.assign(new fd,{priority:Number.NaN,AUP:Number.NaN}),++Ia<J.length&&0<J[Ia].trim().length&&(X.addinInfo.priority=parseInt(J[Ia].trim())),++Ia<J.length&&0<J[Ia].trim().length&&(X.addinInfo.AUP=parseInt(J[Ia].trim())),++Ia<J.length&&0<J[Ia].trim().length&&(X.displayName=J[Ia].trim()),++Ia<J.length&&0<J[Ia].trim().length&&(X.iconUrl=J[Ia].trim()),++Ia<J.length&&0<J[Ia].trim().length&&
(X.description=J[Ia].trim()));return X.solutionId?X:null}static wac(J,X){J=J.Ea("AddinImageStoreServiceUrl");if(!J)return X;J=J.toLowerCase();return J.startsWith("http://")||J.startsWith("https://")?J:X}}Object(k.a)(rh,"AddinDetailsManager2",null,[594,595]);class ge{static createInstance(J,X,Ia=null){if(ge.Q7c(J)){if(ge.ABi(J))return n.ULS.sendTraceTag(508925833,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),new rh(J,X,Ia);n.ULS.sendTraceTag(508925832,
220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");return new Eh(J,X,Ia)}n.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");return new Ei(J,X,Ia)}static Q7c(J){return(J||D.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static ABi(J){return(J||D.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",
!1)}}Object(k.a)(ge,"AddinDetailsManagerFactory",null,[]);var bi=d(197),Og=d(318),Ki=d(1265);class sk extends Ie.a{constructor(){super();this.dda="calc(100% - 46px)";this.Yra="15px";this.eda="0";this.UWb="WACDialogPanel";this.IQ=695;this.VWb=462;this.oO="80%";this.LVb=350;this.DPa="100%";this.Fd=5;this.Fg="AppsForOfficeInsertionDialog";this.aLd=!!D.AFrameworkApplication.fa&&D.AFrameworkApplication.fa.getBooleanAppSetting("OfficeAddinEnableInsertDialogAccessibilityFix")}sv(){super.sv();this.Vm.style.width=
this.DPa;this.Vm.style.height=this.dda;this.Vm.style.marginTop=this.Yra;this.Vm.style.padding=this.eda}Uba(){this.Vm.style.width=this.DPa;this.Vm.style.height=this.dda;this.Vm.style.marginTop=this.Yra;this.Vm.style.padding=this.eda;this.IQ>Qc.a.RS?(this.Nb.style.width=String.format("{0}px",Qc.a.RS),this.Nb.style.overflowX="scroll",D.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0"):(this.Nb.style.width=String.format("{0}px",this.IQ),this.Nb.style.overflowX="hidden");this.Nb.offsetHeight>
Qc.a.jQ||this.VWb+50>Qc.a.jQ?(this.Nb.style.height=String.format("{0}px",Qc.a.jQ),this.Nb.style.overflowY="scroll",this.Nb.style.top="0",D.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0",this.aLd||(this.Nb.style.marginTop="-48px"),this.Vm.style.minHeight=String.format("{0}px",this.LVb)):(this.Nb.style.overflowY="hidden",this.Nb.style.top="10%",this.Nb.style.height=this.oO);this.zEa()}zEa(){if(this.Nb){var J=this.Nb.style.zIndex;this.Nb.style.zIndex="-9999";if(this.IQ>Qc.a.RS)D.AFrameworkApplication.isRtl?
this.Nb.style.marginRight="0":this.Nb.style.marginLeft="0";else{const X=String.format("{0}px",Math.floor(-this.Nb.offsetWidth/2));D.AFrameworkApplication.isRtl?this.Nb.style.marginRight=X:this.Nb.style.marginLeft=X;D.AFrameworkApplication.isRtl?this.Nb.style.right="50%":this.Nb.style.left="50%"}this.Nb.style.zIndex=String(J)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}IB(){super.IB();const J=document.getElementById(this.ki(this.UWb));J.style.width=String.format("{0}px",
this.IQ);J.style.height=this.oO}get Pla(){return this.Vm}}Object(k.a)(sk,"AppsForOfficeInsertionDialog",Ie.a,[584]);class kk extends Ie.a{constructor(J=!0,X=!0,Ia=null){super();this.dda="calc(100% - 46px)";this.Yra="15px";this.eda="0";this.UWb="WACDialogPanel";this.IQ=695;this.VWb=462;this.oO="80%";this.LVb=350;this.DPa="100%";this.Pqf=this.YGc=null;this.prf="auto";this.qrf="5px";this.rrf="auto";this.orf="40px";this.qFc="100px";this.WWb="200px";this.Fd=5;this.Fg="SDXDialog";this.zHc=J;this.Kcc=X;
this.lFc=Ia}sv(){super.sv();this.Vm.style.width=this.DPa;this.Vm.style.height=this.dda;this.Vm.style.marginTop=this.Yra;this.Vm.style.padding=this.eda}Uba(){this.Vm.style.width=this.DPa;this.Vm.style.height=this.zHc?this.dda:"100%";this.Vm.style.marginTop=this.zHc?this.Yra:"0px";this.Vm.style.padding=this.eda;if(this.zHc){this.qFc&&this.WWb&&(this.IQ=parseInt(this.WWb.substring(0,this.WWb.length-2)),this.oO=this.qFc);this.IQ>Qc.a.RS?(this.Nb.style.width=String.format("{0}px",Qc.a.RS),this.Nb.style.overflowX=
"scroll",D.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0"):(this.Nb.style.width=String.format("{0}px",this.IQ),this.Nb.style.overflowX="hidden");if(this.Nb.offsetHeight>Qc.a.jQ||this.VWb+50>Qc.a.jQ)this.Nb.style.height=String.format("{0}px",Qc.a.jQ),this.Nb.style.overflowY="scroll",this.Nb.style.top="0",D.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0",this.Vm.style.minHeight=String.format("{0}px",this.LVb);else{this.Nb.style.overflowY="hidden";
const J="%"===this.oO.substring(this.oO.length-1,this.oO.length),X=J?parseInt(this.oO.substring(0,this.oO.length-1)):parseInt(this.oO.substring(0,this.oO.length-2));this.Nb.style.top=J?(100-X)/2+"%":100*(Qc.a.jQ-X)/Qc.a.jQ/2+"%";this.Nb.style.height=this.oO}this.zEa()}else this.Nb.style.left=this.prf,this.Nb.style.right=this.qrf,this.Nb.style.top=this.rrf,this.Nb.style.bottom=this.orf,this.Nb.style.width=this.WWb,this.Nb.style.height=this.qFc,this.Nb.style.overflowX="hidden",this.Nb.style.overflowY=
"hidden"}zEa(){if(this.Nb){var J=this.Nb.style.zIndex;this.Nb.style.zIndex="-9999";if(this.IQ>Qc.a.RS)D.AFrameworkApplication.isRtl?this.Nb.style.marginRight="0":this.Nb.style.marginLeft="0";else{const X=String.format("{0}px",Math.floor(-this.Nb.offsetWidth/2));D.AFrameworkApplication.isRtl?this.Nb.style.marginRight=X:this.Nb.style.marginLeft=X;D.AFrameworkApplication.isRtl?this.Nb.style.right="50%":this.Nb.style.left="50%"}this.Nb.style.zIndex=String(J)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}IB(){super.IB();
const J=document.getElementById(this.ki(this.UWb));J.style.width=String.format("{0}px",this.IQ);J.style.height=this.oO}get kEb(){return this.zHc}get Pla(){return this.Vm}get zj(){return this.YGc}set zj(J){this.YGc=J}get O7b(){return this.Pqf}set O7b(J){this.Pqf=J}BPl(J,X,Ia,fb){this.prf=J;this.qrf=X;this.rrf=Ia;this.orf=fb}CPl(J,X){this.qFc=J;this.WWb=X}}Object(k.a)(kk,"SDXDialog",Ie.a,[]);class Nj extends Ie.a{constructor(J,X,Ia,fb){super();this.dda="calc(100% - 46px)";this.Yra="15px";this.eda="0";
this.UWb="WACDialogPanel";this.IQ=695;this.VWb=462;this.oO="80%";this.LVb=350;this.DPa="100%";this.mQa=null;this.Fd=5;this.Fg="AddinInstallDialog";this.bId=J;this.pda=X;this.Eqi=Ia;this.kki=fb}sv(){super.sv();this.Vm.style.width=this.DPa;this.Vm.style.height=this.dda;this.Vm.style.marginTop=this.Yra;this.Vm.style.padding=this.eda;document.getElementById(this.ki("WACDialogButtonPanel")).style.display="none";this.zTa.setAttribute("tabindex","0");$addHandler(this.zTa,"keyup",Object(E.a)(this,this.H6k,
"onKeyUp"));const J=document.createElement("iframe");J.setAttribute("id","InstallAddinDialog");J.setAttribute("src","about:blank");J.setAttribute("width","100%");J.setAttribute("height","100%");J.setAttribute("marginHeight","0");J.setAttribute("marginWidth","0");J.setAttribute("frameBorder","0");J.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const X=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.bId,this.pda,this.Eqi);J.setAttribute("src",X);this.mQa=J;$addHandler(J,"load",Object(E.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(E.a)(this,this.onMessage,"onMessage"));this.Vm.appendChild(J);this.Vm.appendChild(this.q3i())}q3i(){const J=document.createElement("div");J.setAttribute("tabindex","0");$addHandler(J,"focus",Object(E.a)(this,this.X6k,"onLoopPivotFocus"));return J}H6k(J){13!==J.keyCode&&32!==J.keyCode||this.hide()}X6k(){this.zTa.focus()}onLoad(){this.mQa.focus()}onMessage(J){J=
J.rawEvent;if(J.source===this.mQa.contentWindow&&(J=(J=J.data)?J.split("|"):null)&&0<J.length&&("REFRESH_REQUIRED"===J[0]||"PRELOAD_MANIFEST"===J[0])){y.a.instance.setItem("refreshRequired","true");const X={};X.solutionId=J[1];X.version=Nj.j0k(J[3]);X.storeType=J[4];X.storeId=J[5];X.assetId=J[6];X.targetType=Nj.kel(J[2]);X.assetStoreId=J[7];X.width=parseInt(J[8]);X.height=parseInt(J[9]);this.kki(X)}}Uba(){this.Vm.style.width=this.DPa;this.Vm.style.height=this.dda;this.Vm.style.marginTop=this.Yra;
this.Vm.style.padding=this.eda;this.IQ>Qc.a.RS?(this.Nb.style.width=String.format("{0}px",Qc.a.RS),this.Nb.style.overflowX="scroll",D.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0"):(this.Nb.style.width=String.format("{0}px",this.IQ),this.Nb.style.overflowX="hidden");this.Nb.offsetHeight>Qc.a.jQ||this.VWb+50>Qc.a.jQ?(this.Nb.style.height=String.format("{0}px",Qc.a.jQ),this.Nb.style.overflowY="scroll",this.Nb.style.top="0",D.AFrameworkApplication.isRtl?this.Nb.style.right=
"0":this.Nb.style.left="0",this.Vm.style.minHeight=String.format("{0}px",this.LVb)):(this.Nb.style.overflowY="hidden",this.Nb.style.top="10%",this.Nb.style.height=this.oO);this.zEa()}zEa(){if(this.Nb){var J=this.Nb.style.zIndex;this.Nb.style.zIndex="-9999";if(this.IQ>Qc.a.RS)D.AFrameworkApplication.isRtl?this.Nb.style.marginRight="0":this.Nb.style.marginLeft="0";else{const X=String.format("{0}px",Math.floor(-this.Nb.offsetWidth/2));D.AFrameworkApplication.isRtl?this.Nb.style.marginRight=X:this.Nb.style.marginLeft=
X;D.AFrameworkApplication.isRtl?this.Nb.style.right="50%":this.Nb.style.left="50%"}this.Nb.style.zIndex=String(J)}else n.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}IB(){super.IB();const J=document.getElementById(this.ki(this.UWb));J.style.width=String.format("{0}px",this.IQ);J.style.height=this.oO}get Pla(){return this.Vm}dispose(){super.dispose();$removeHandler(window,"message",Object(E.a)(this,this.onMessage,"onMessage"))}static kel(J){switch(J){case "1":return 0;
case "2":return 1;default:return 0}}static j0k(J){const X=J.split(".");for(let Ia=0;Ia<4-X.length;Ia++)J+=".0";return J}}Object(k.a)(Nj,"AddinInstallDialog",Ie.a,[]);var rl=d(160);class cj{constructor(J,X,Ia){this.mcc=fb=>{try{if(fb&&fb.rawEvent&&fb.rawEvent.origin&&this.NCb&&this.NCb.id){var Ab=this.eth(fb.rawEvent.origin);const ec=this.eth(document.domain);if(Uf.a.gl().equals(ec,Ab))if(fb.rawEvent.source&&fb.rawEvent.source.frameElement&&fb.rawEvent.source.frameElement.id&&Uf.a.gl().equals(fb.rawEvent.source.frameElement.id,
this.NCb.id)){Ab=null;try{Ab=JSON.parse(fb.rawEvent.data)}catch(Uc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Uc.message)}Ab?(Ab.statusCode!==rl.a.Zw||void 0!==Ab.error&&Ab.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ab.statusCode,Ab.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,
100,"Received response from authentication proxy."),this.uu(Ab.authorizationCode?Ab.authorizationCode:Ab.signInUrl)),$removeHandler(window,"message",this.mcc),this.NCb?document.body.contains(this.NCb)?document.body.removeChild(this.NCb):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(ec){n.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",ec.message)}};this.NCb=J;this.uu=
X;this.onError=Ia;$addHandler(window,"message",this.mcc)}eth(J){let X="";try{J&&(X=-1<J.indexOf("//")?J.split("/")[2]:J.split("/")[0])&&(X=X.split(":")[0],X=X.split("?")[0])}catch(Ia){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Ia.message)}return X}static ez(J,X,Ia){new cj(J,X,Ia)}}Object(k.a)(cj,"ResponseHandler",null,[]);var bh=d(205);class vi{constructor(J){this.mta=J}tryAuthenticate(J,X){this.Brd(vi.Ifi,()=>{J()},X)}tryAuthorize(J,X){this.Brd(vi.kai,J,X)}getSignInUrl(J,
X){this.Brd(vi.UFf,J,X)}signOut(J,X){this.Brd(vi.yoi,J,X)}Brd(J,X,Ia){var fb=new bh.QueryStringBuilder("AuthenticationProxyHandler.aspx");fb.zg("responseType",J);D.AFrameworkApplication.qSa(fb);fb=String.format("{0}{1}&{2}",this.mta,fb.toString(),D.AFrameworkApplication.mh);const Ab=document.createElement("iframe");Ab.setAttribute("id","privateCatalogIframe");Ab.setAttribute("name","privateCatalogIframe");Ab.setAttribute("style","display: none");Uf.a.gl().equals(J,vi.UFf)||Ab.setAttribute("sandbox",
"allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");cj.ez(Ab,X,Ia);Ab.setAttribute("src",fb);document.body.appendChild(Ab)}}vi.kai="authcode";vi.Ifi="identitytoken";vi.UFf="signinurl";vi.yoi="signout";Object(k.a)(vi,"AuthenticationProxy",null,[]);class xh{}xh.getUserId="getUserId";xh.getLastStoreUpdate="laststoreupdate";xh.getEntitlement="getEntitlements";xh.getEToken="getEToken";xh.getManifest="getManifest";xh.getAppState="getAppState";xh.getKilledApps="getRemovedAddins";
xh.getAppDetails="getAppDetails";xh.removeApps="removeAddin";xh.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";xh.getPrivateCatalogAddIns="getAddIns";xh.getPrivateCatalogManifests="getAppManifests";xh.isStoreDisabled="isStoreDisabled";Object(k.a)(xh,"S2SWebRequestActions",null,[]);var hh=d(534);class zf{getUserId(J,X){const Ia=new e.a;Ia.add(new ka.a("corr",J));this.Py(xh.getUserId,Ia,1,X)}getLastStoreUpdate(J,X,Ia){const fb=new e.a;fb.add(new ka.a("lc",J));fb.add(new ka.a("corr",X));this.Py(xh.getLastStoreUpdate,
fb,1,Ia)}getEntitlement(J,X,Ia,fb){J=new e.a;J.add(new ka.a("av",X));J.add(new ka.a("corr",Ia));this.Py(xh.getEntitlement,J,1,fb)}getEToken(J,X,Ia,fb,Ab,ec){const Uc=new e.a;Uc.add(new ka.a("cmu",J));Uc.add(new ka.a("cmf",X));Uc.add(new ka.a("assetid",Ia));Uc.add(new ka.a("expver",fb));Uc.add(new ka.a("corr",Ab));this.Py(xh.getEToken,Uc,1,ec)}getManifest(J,X,Ia,fb){const Ab=new e.a;Ab.add(new ka.a("cmu",J));Ab.add(new ka.a("assetid",X));Ab.add(new ka.a("corr",Ia));this.Py(xh.getManifest,Ab,1,fb)}getAppState(J,
X,Ia){const fb=new e.a;fb.add(new ka.a("ma",J));fb.add(new ka.a("corr",X));this.Py(xh.getAppState,fb,1,Ia)}getKilledApps(J,X){const Ia=new e.a;Ia.add(new ka.a("corr",J));this.Py(xh.getKilledApps,Ia,1,X)}getAppDetails(J,X,Ia,fb){const Ab=new e.a;Ab.add(new ka.a("cmo",J));Ab.add(new ka.a("corr",Ia));this.sendWithBody(xh.getAppDetails,Ab,X,2,fb,!1)}removeApps(J,X,Ia){const fb=new e.a;fb.add(new ka.a("corr",X));this.sendWithBody(xh.removeApps,fb,J,2,Ia,!1)}getLastPrivateCatalogUpdate(J,X,Ia,fb,Ab,ec){const Uc=
new e.a;Uc.add(new ka.a("catalog","privatecatalog"));Uc.add(new ka.a("clientCode",J));Uc.add(new ka.a("clientVersion",X));Uc.add(new ka.a("corr",Ab));J=String.format("authorizationCode={0}&refreshToken={1}",Ia?oa.a.We(Ia):"",fb?oa.a.We(fb):"");this.sendWithBody(xh.getLastPrivateCatalogUpdate,Uc,J,2,ec,!0)}getPrivateCatalogAddIns(J,X,Ia,fb,Ab,ec){const Uc=new e.a;Uc.add(new ka.a("catalog","privatecatalog"));Uc.add(new ka.a("clientCode",J));Uc.add(new ka.a("clientVersion",X));Uc.add(new ka.a("corr",
Ab));J=String.format("authorizationCode={0}&refreshToken={1}",Ia?oa.a.We(Ia):"",fb?oa.a.We(fb):"");this.sendWithBody(xh.getPrivateCatalogAddIns,Uc,J,2,ec,!0)}getPrivateCatalogManifests(J,X,Ia,fb,Ab){const ec=new e.a;ec.add(new ka.a("catalog","privatecatalog"));ec.add(new ka.a("corr",fb));J=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",oa.a.We(J),X?oa.a.We(X):"",Ia?oa.a.We(Ia):"");this.sendWithBody(xh.getPrivateCatalogManifests,ec,J,2,Ab,!0)}isStoreDisabled(J,X){const Ia=
new e.a;Ia.add(new ka.a("corr",J));this.Py(xh.isStoreDisabled,Ia,2,X)}Py(J,X,Ia,fb){this.sendWithBody(J,X,null,Ia,fb,!1)}sendWithBody(J,X,Ia,fb,Ab,ec){const Uc=new bh.QueryStringBuilder("AddinServiceHandler.ashx");Uc.zg("action",J);Uc.zg("app",hh.a[D.AFrameworkApplication.za.mb.Ej]);for(const Ad of X)Uc.zg(Ad.key,Ad.value);X=String.format("{0}{1}&{2}",D.AFrameworkApplication.za.mb.yha,Uc.toString(),D.AFrameworkApplication.mh);D.AFrameworkApplication.Me.Tj(X,fb,Ia,null,!1,2,Ad=>{let Ce=null,ye=null;
Ad&&Ad.data&&(Ad.data.gk["X-BlockedForMinor"]&&"1"===Ad.data.gk["X-BlockedForMinor"].toString()&&(Ad.data.Ke=451),Ce=Ad.data.Ud,ye=Ad.data.gk);Ab(Ad.data.Ke,Ce,ye)},Ad=>{var Ce=null;let ye=null;ec&&Ad&&Ad.data&&Ad.data.Ud&&(Ce=Ad.data.Ud,ye=Ad.data.gk);Ab(Ad.data.Ke,Ce,ye);if(D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Ce={message:"AddinServiceHandler request failed"};Ce.code=Ad.data.Ke;Ce.action=J;if(Ad.data.request||Ad.data.request.get_headers())Ce["X-UserSessionId"]=
Ad.data.request.get_headers()["X-UserSessionId"];408===Ad.data.Ke||503===Ad.data.Ke?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Ce)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Ce))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Ad.data.Ke)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+J,void 0,void 0,void 0,["X-UserKey"])}}Object(k.a)(zf,"S2SWebRequestManager",null,[]);var Yh=d(32),Oa=d(82);class sb{constructor(J,X){this.state=J;this.gAa=X}}Object(k.a)(sb,
"BackgroundAppData",null,[1370]);class Pb{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad){this.fea=null;this.cGk=J;this.lTk=fb;this.mA=X;this.ov=Ia;this.X_a=Ab;this.settings=ec;this.gGk=Uc;this.lx=Ad}get An(){return this.cGk}get taskpane(){return this.lTk}get zj(){return this.mA}get shape(){return this.ov}get o6e(){return this.X_a}get $y(){return this.gGk}Msi(J){this.lx=new sb(0,J)}}Object(k.a)(Pb,"AppForOffice",null,[1345]);var kc=d(31);class Wc{}Wc.c_Error="Error";Object(k.a)(Wc,"ApiResponseKeyStrings",null,
[]);class Xd{constructor(J,X,Ia,fb,Ab){this.EventDispId=J;this.ControlId=X;this.TargetId=Ia;this.Handler=fb;this.Callback=Ab}}Object(k.a)(Xd,"EventRegistrationParams",null,[]);var Gd=d(27);class Pe{constructor(J,X){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.zb=D.AFrameworkApplication.Be;this.yLe=J;this.fRg=X}InvokeDdaMethod(J,X,Ia){const fb=J.DdaMethod.DispatchId,Ab=this.yLe.uuj(fb);Ab?(Ab.parameters=J,Ab.callback=X,Ab.HBi=Ia,Ab.controlId=
J.DdaMethod.ControlId,this.zb.Jb(new ag.a(2,1,0,Object(E.a)(Ab,Ab.go,"go"),90,"51"))):(J="API Call for method ID "+fb+" does not exist:"+kc.Debug.ku(),Gd.a.J(8958091,802,10,J),this.E3d(X))}RegisterDdaEventAsync(J,X,Ia,fb,Ab){const ec=new ag.a(2,1,0,Object(E.a)(this,this.jwl,"registerEventTaskProcess"),90,"52");ec.gu=new Xd(J,X,Ia,fb,Ab);this.zb.Jb(ec)}UnregisterDdaEventAsync(J,X,Ia,fb,Ab){const ec=new ag.a(2,1,0,Object(E.a)(this,this.$fm,"unregisterEventTaskProcess"),90,"53");ec.gu=new Xd(J,X,Ia,
fb,Ab);this.zb.Jb(ec)}jwl(J){J=J.gu;var X=this.fRg.Pfe(J.EventDispId);X?X.addHandler(J.ControlId,J.Handler,J.Callback,J.TargetId):(X="Event for dispatch ID "+J.EventDispId+" does not exist:"+kc.Debug.ku(),Gd.a.J(8958093,802,10,X),this.E3d(J.Callback))}$fm(J){J=J.gu;var X=this.fRg.Pfe(J.EventDispId);X?X.removeHandler(J.ControlId,J.Handler,J.Callback,J.TargetId):(X="Event for dispatch ID "+J.EventDispId+" does not exist:"+kc.Debug.ku(),Gd.a.J(8958095,802,10,X),this.E3d(J.Callback))}E3d(J){if(J){var X=
{};X[Wc.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;J(X)}}}Object(k.a)(Pe,"AppForOfficeApiAdapter",null,[1372]);class Lf{constructor(J,X,Ia,fb){this.menuItemId=J;this.uW=X;this.p6l=Ia;this.Hmj=fb}}Object(k.a)(Lf,"NewDocumentParameters",null,[]);var Nf=d(593),dg=d(131),Pg=d(143),pi=d(43),li=d(52),Ri=d(76),Ih=d(33),ij=d(40),Fi=d(50),Da=d(37),Wa=d(34),lb=d(58);class Lb{constructor(J,X,Ia){this.$ib=[];this.Rcd=this.hHb=!1;this.ta=J;this.VG=X;this.nA=Ia}build(){const J=this.ta.aA();if(!J)return this.$ib;
for(const X of J)if(this.Vll(X),this.Rcd)break;return this.$ib}Vll(J){const X=Ih.ParagraphReader.textLength(J);this.Wll(J,X);this.Rcd||this.Cll(J)}Wll(J,X){this.hHb||(this.VG>=X?this.VG-=X:(this.hHb=!0,this.nA||this.$ib.push(Fi.a.rk(Object(Ca.a)(Oa.a,J),this.VG))));this.hHb&&(this.nA>X-this.VG?0<X&&(this.$ib.push(Fi.a.createTextRange(Object(Ca.a)(Oa.a,J),this.VG,X)),this.nA-=X-this.VG,this.VG=0):0<this.nA&&(this.$ib.push(Fi.a.createTextRange(Object(Ca.a)(Oa.a,J),this.VG,this.VG+this.nA)),this.nA=
0));0>=this.nA&&(this.Rcd=!0)}Cll(J){this.hHb||(0<this.VG?--this.VG:(this.hHb=!0,this.nA||this.$ib.push(Fi.a.STa(Object(Ca.a)(Oa.a,J)))));this.hHb&&0<this.nA&&(this.$ib.push(Fi.a.Dea(Object(Ca.a)(Oa.a,J))),--this.nA);0>=this.nA&&(this.Rcd=!0)}}Object(k.a)(Lb,"TextSelectionBuilder",null,[]);var oc=d(998),Jc=d(29);class bd{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad,Ce,ye,hf,Gf,Kg,Lg,se,xi,gi,jf,th,Fn,Jj,yi,dk,lo){this.Ba=J;this.Lb=X;this.GP=Ia;this.hib=fb;this.oa=Ab;this.BK=ec;this.mgd=Uc;this.Eb=Ad;this.ia=
Ce;this.sa=hf;this.zb=Gf;this.Yb=ye;this.Tb=Kg;this.nc=Lg;this.$Fk=se;this.gb=xi;this.yb=gi;this.Vk=jf;this.Ga=th;this.Ub=Fn;this.cKa=Jj;this.Uh=yi;this.Dr=dk;this.ANk=lo}vLj(){let J;J="";if(this.gb.nI()){if(1<this.gb.Lxd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,$wc:J};const X=this.gb.Zn();if(this.srk(X)){const Ia=[];this.Ga.lH(X,fb=>{fb&&Ia.push(fb.characterData)});J=Ia.join(bd.ITf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
$wc:J}}}else if(this.gb.kz())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,$wc:J}}rLj(){let J;J="";return{returnValue:({Xaf:J}=this.getSelectedSlides()).returnValue,RLl:J}}XAb(){return this.GP.llb.documentUrl}YSj(J){if(!J)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var X=this.Tb.Hi();if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");const Ia=this.sa.Aa.ve;switch(J){case "previous":J=Ia-1;break;case "next":J=
Ia+1;break;case "first":J=0;break;case "last":J=X-1;break;default:if(J=parseInt(J),isNaN(J))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>J||J>X-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;X=this.Tb.oy(J);if(!X)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Yb.Aa=X;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}ZSj(J){if(!J)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;J=parseInt(J);if(isNaN(J))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
J=this.Lke(J);if(!J)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Yb.Aa=J;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}pTl(J){var X=this.gb.Hd();if(!X.length){if(X=Object(Ca.a)(205,this.gb.Pk()||this.sa.Aa)){var Ia=X.Fb;J=this.Vk.f8d(Ia.cid,Ia.sid,X.wt()+1,J,"");Ia=this.Eb.ud(7);Ia.mc(X);X.ZB(J);this.gb.selectShape(J,!0);Ia.dispose();this.Dr.YA=J;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===X.length){if(this.gb.nI())return this.pUl(J);if(this.gb.kz())return this.qUl(J)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}sNh(J,
X,Ia,fb,Ab,ec,Uc,Ad){if(this.CXc(Ab,0,bd.yqb)||this.CXc(ec,0,bd.yqb)||this.CXc(Ia,-bd.yqb,bd.yqb)||this.CXc(fb,-bd.yqb,bd.yqb)||0!==Uc&&1!==Uc)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(J.length>this.Ba.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var Ce=this.gb.Hd().length;if(X||Ab||ec||!Ce){Ce=this.sa.Aa;if(!Ce)throw Error.argumentNull("ActiveSlide is null");const hf=Ce.Fb,Gf=Ce.wt();let Kg=!0,Lg=new lb.a(0,0);X?Lg=
new lb.a(Ia,fb):!this.Ba.bil||Ab&&ec?Lg=this.Tb.Ama(Ab,ec):Kg=!1;const se=this.Vk.Cla(!1,hf.cid,hf.sid,0,Nf.a.WI(Lg.x),Nf.a.WI(Lg.y),Nf.a.WI(Ab),Nf.a.WI(ec),Gf+1,!0);Kg||(se.Vo(ij.a.zz),se.Vo(ij.a.Az));se.$j=!0;se.QAd=!0;se.bA=Uc;se.Ifa=0===Uc?this.E0f(J):J;const xi=(J=this.Bfk(Ad)&&this.Ba.getBooleanAppSetting("ChatPPTImgShowDesigner"))&&this.Ba.getBooleanAppSetting("ChatPPTHideImg");se.zDb=!0;Uc=this.Eb.ud(7,void 0,()=>{xi&&(this.gb.Pu(),this.gb.Bh())},()=>{xi&&(this.gb.Pu(),this.gb.Bh())});try{if(J&&
(Uc.Wc=Jc.a.FNc,xi)){var ye=this.Ba.tc("ChatPPTHideImgMs",3E3);se.kTb=Date.now()+ye;this.zb.Jb(new ag.a(2,1,ye+this.Ba.tc("ChatPPTUnhideUpdateMs",2E3),()=>{if(0!=se.kTb){se.kTb=0;const gi=Object(Ca.a)(178,se.sc(this.yb.Na));null===gi||void 0===gi?void 0:gi.xBa()}},void 0,"ShowAddInImg"))}Uc.mc(Ce);Ce.ZB(se);this.gb.selectShape(se,!0)}catch(gi){Gd.a.J(509112541,802,10,"setSelectedImageData got exception "+gi)}finally{Uc&&Uc.dispose()}this.Dr.YA=se;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===
Ce&&(ye=this.gb.Zn())&&ye.cRc){Ce=this.sa.Aa;if(!Ce)throw Error.argumentNull("ActiveSlide is null");X=this.Pcb(Ce,ye);X.$j=!0;X.bA=Uc;X.Ifa=0===Uc?this.E0f(J):J;X.zDb=!0;J=this.Eb.ud(7);try{J.mc(Ce),Ce.XS([ye]),Ce.ZB(X),this.gb.selectShape(X,!0)}finally{J&&J.dispose()}this.Dr.YA=X;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Gd.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Bfk(J){return this.Ba.Ea("ChatPPTOrigin")===
J}cna(){return this.Ba.cna}nek(){return this.Lb.getBooleanAppSetting("342")}Zzj(J){if(!J)return null;J=this.$Fk.Q4(J);J=0===J.$y?J.node:this.sa.Aa;if(!J)return null;J=Object(Ca.a)(267,this.nc.ug(J));return Zf(J.Ld)}g6e(J,X){if(J&&X)if(Hc.a("UseUndoTransactionForSaveSettingToApp")){var Ia=this.Eb.ud(15,void 0,void 0,void 0,!0);try{Ia.mc(J),Ia.Wc=Jc.a.jXa,oc.a.B1h(this.mgd.value,J,X)}finally{Ia&&Ia.dispose()}}else{Ia=this.Eb.ud(4);try{Ia.mc(J),oc.a.B1h(this.mgd.value,J,X),this.Yb.qj.qia()}finally{Ia&&
Ia.dispose()}}}lab(J,X,Ia){const fb=new m.StandardDialog;fb.Fd=4;fb.Ky(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Ab=>{2===Ab||0===Ab?Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Ab=new Lf("blank","agave",J?bd.A_k:bd.B_k,J),this.ANk.create(X,Ia,Ab).lab())})}Xe(){return this.gb.Xe()}Hd(){return this.gb.Hd()}zLj(){var J=this.gb.Hd();if(!(J.length&&this.gb.kz()&&this.oa.value&&this.oa.value.Oa.length))return[];const X=this.oa.value.Oa.ga(0);
return(J=bd.uJj(J[0],X))&&2===J.length?J:[]}Bem(J){if(!J)return!1;this.gb.qUa();if(!J.length)return!0;J[0]!==this.sa.Aa&&(this.Yb.Aa=J[0]);for(const X of J)X&&this.gb.ZDa(X);return!0}Aem(J){if(!J)return!1;if(!J.length)return this.gb.Bh(),!0;this.gb.$2a(J,!0);return!0}Cem(J,X,Ia){if(!bd.YFg(J))return!1;if(0>X)return!0;J=(new Lb(J,X,Ia)).build();J=[new dg.Selection(J,!0)];J=new Pg.SelectionCollection(J,0);this.gb.VF(J);return!0}getSelectedSlides(){let J;J="";var X=null;if(!X||!X.length){var Ia=this.gb.Pk()||
this.sa.Aa;X||(X=[]);Ia&&X.push(Ia)}if(!X.length)return Gd.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Xaf:J};Ia=[];for(const fb of X){X=fb.ve+1;if(!X)return Gd.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Xaf:J};Array.add(Ia,[fb.sid.toString(),fb.title||"",X.toString()])}J=ia.c(Ia);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Xaf:J}}getSelectedTextRange(){var J=[];for(let X=0;X<this.oa.value.Oa.length;X++){const Ia=this.oa.value.Oa.ga(X);Array.add(J,this.Q1c(Ia))}J=J.join(bd.ITf);if(J===Ri.AParagraphNode.P0)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,$wc:J};J=Ri.AParagraphNode.fvd(J);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,$wc:J}}srk(J){if(!J)return!1;let X=J.Yfa||J.Xu||J.ig||J.vd;if(!X&&J.Sk)switch(J.mj){case 0:case 2:case 1:case 3:case 10:case 8:X=
!0}return X}trk(J){if(!J)return!1;let X=J.Yfa||J.Xu;if(!X&&J.Sk)switch(J.mj){case 0:case 2:case 1:case 3:case 8:X=!0}return X}Q1c(J){let X="";if(J)for(let Ia=0;Ia<J.length;Ia++){const fb=J.ga(Ia),Ab=fb.Ra,ec=fb.Pb-Ab;let Uc="";Ih.ParagraphReader.ke(fb.node)&&(Uc=fb.node.characterData);switch(fb.contextId){case Da.a.paragraph:X+=Uc+"\r";break;case Da.a.textRange:0<ec&&(X+=Uc.substr(Ab,ec));break;case Da.a.endOfParagraph:X+="\r"}}return X}Lke(J){var X=this.sa.presentation;if(!X)throw Error.argumentNull("Presentation is null");
X=X.slides||[];for(let Ia=0;Ia<X.length;Ia++)if(X[Ia].Fb.sid===J)return Object(Ca.a)(205,X[Ia]);return null}qUl(J){if(!this.oa.value||!this.BK.value||!this.hib.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.oa.value.Oa.length){if(!pi.SelectionEditor.uy(this.oa.value.Oa.kb)&&32!==this.ia.nb(Wa.a.nFa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var X=this.oa.value.Oa.kb.Ua;const Ia=X.node,fb=X.Ra;X=X.Pb;const Ab=this.Eb.ud(7);try{Ab.mc(Ia);let ec=null;
ec=fb===X?Fi.a.rk(Ia,fb):Fi.a.createTextRange(Ia,fb,X);this.BK.value.replaceTextRange(ec,J)}finally{Ab.dispose()}X=fb+J.length;this.oa.value.setSelection(li.SelectionFactory.U4(Ia,fb,X));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Gd.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}pUl(J){if(!this.oa.value||!this.BK.value||!this.hib.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
const X=this.gb.Zn();if(!X)return J="Fail to get shape while setting selected shape's text: shape returned as null: "+kc.Debug.ku(),Gd.a.J(512263106,802,10,J),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.trk(X)){const Ia=this.Ub.Pc(X),fb=this.Eb.ud(7);try{fb.mc(Ia);X.deleteParagraph();this.hib.value.uX(Ia,!0);this.cKa.Ti(Ia);const Ab=Ia.currentNode,ec=this.Uh.textLength(Ab),Uc=Fi.a.createTextRange(Ab,0,ec);this.BK.value.replaceTextRange(Uc,J)}finally{fb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Gd.a.J(512263105,
802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}CXc(J,X,Ia){return J<X||Ia<J}E0f(J){return"data:image/png;base64,"+J}Pcb(J,X){if(!J)return null;var Ia=J.Fb;J=J.wt();let fb;const Ab=Ic.a.KS,ec=Ic.a.EZ;fb=X?X.uBb(Ic.a.KS,Ic.a.EZ):this.Tb.Ama(Ic.a.KS,Ic.a.EZ);Ia=this.Vk.Cla(!0,Ia.cid,Ia.sid,0,fb.x,fb.y,Ab,ec,J+1,!0);X&&(Ia.J4=X.id);return Ia}static YFg(J){if(!J)return!1;let X=J.Yfa||J.Xu;if(!X&&J.Sk)switch(J.mj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:X=
!0}return X}static zPj(J,X){J=J.aA();if(!J||!X)return 0;let Ia=0;for(const fb of J){if(fb===X)break;Ia+=Ih.ParagraphReader.textLength(Object(Ca.a)(Oa.a,fb))+1}return Ia}static uJj(J,X){if(!bd.YFg(J)||!X)return[];var Ia=-1;let fb=0;for(const Ab of X){X=Ih.ParagraphReader.ke(Ab.node)?Ih.ParagraphReader.textLength(Ab.node):0;if(-1===Ia)switch(Ia=Ih.ParagraphReader.ke(Ab.node)?bd.zPj(J,Object(Ca.a)(5,Ab.node)):0,Ab.contextId){case Da.a.paragraph:break;case Da.a.textRange:case Da.a.Xf:Ia+=Ab.Ra;break;
case Da.a.endOfParagraph:Ia+=X;break;default:return[]}switch(Ab.contextId){case Da.a.paragraph:fb+=X+1;break;case Da.a.textRange:fb+=Math.max(0,Ab.Pb-Ab.Ra);break;case Da.a.endOfParagraph:fb+=1}}return[Ia,fb]}}bd.ITf=" ";bd.yqb=169056;bd.B_k="streamEmpty";bd.A_k="streamBase64";Object(k.a)(bd,"AppForOfficeApiFacadeEditorImpl",null,[1371]);class rd{atg(J,X,Ia){if(Ia.WFa(J))n.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");
else if(J=Ia.N9b(J)){const fb={};fb.solutionId=J.An.id;fb.version=J.An.version;fb.storeType=J.An.storeType;fb.storeId=J.An.store;fb.assetId=null;fb.assetStoreId=null;Hc.a("AlternateReferenceEnabled")&&(fb.assetId=J.An.assetId,fb.assetStoreId=J.An.assetStoreId);fb.targetType=1;fb.isAddinCommands=!0;fb.addinCommandsActionType=1;fb.sharedRuntimeId=J.lx?J.lx.gAa:null;fb.backgroundState=J.lx?J.lx.state:-1;J.settings=X;Ia.i0d.bI().Ia(Jc.a.W4c,2,fb);return!0}return!1}kek(J,X){if(!J&&!X)return!0;if(!J||!X||
Object.keys(J).length!==Object.keys(X).length)return!1;for(const Ab in J){var Ia=Ab,fb=J[Ab];if(!(Ia in X)||X[Ia]!==fb)return!1}return!0}}Object(k.a)(rd,"AppForOfficeAppSettingProxy",null,[]);class Zd{constructor(J,X,Ia,fb,Ab,ec){this._id=J;this.l9a=X;this.m9=Ia;this.KLc=fb;this.bId=Ab;this.bai=ec}get id(){return this._id}get version(){return this.l9a}get store(){return this.m9}get storeType(){return this.KLc}get assetId(){return this.bId}get assetStoreId(){return this.bai}}Object(k.a)(Zd,"AppForOfficeReference",
null,[1369]);class ea{constructor(J,X){this._id=J;this.Koi=X}get id(){return this._id}get slideId(){return this.Koi}}Object(k.a)(ea,"AppForOfficeShape",null,[1367]);class Ka{constructor(J,X,Ia,fb,Ab,ec=null,Uc=!1){this.cdi=J;this.yri=X;this.o9a=Ia;this.ini=fb;this.vSd=Ab;this.isForUILessAction=Uc;this.Hki=ec}get N6f(){return this.cdi}get visibility(){return this.yri}get width(){return this.o9a}get row(){return this.ini}get ownerAddinSolutionId(){return this.vSd}get ownerAddinStoreType(){return this.Hki}}
Object(k.a)(Ka,"AppForOfficeTaskpane",null,[1368]);class bb{constructor(J,X,Ia,fb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=J;this.controlId=X;this.ddaBinding=Ia;this.ArrayData=fb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(k.a)(bb,"DdaEventArgs",null,[]);class vb{constructor(J,X){this.bHb=null;this.Oc=J;this.ia=X}Pfe(J){this.bHb||this.Wgl();if(!J||!this.bHb[J])return null;J=this.bHb[J];J.Kd=this.Oc;J.zn=this.ia;return J}dXf(J){const X=
this.bHb;for(const Ia in X)X[Ia].removeHandler(J)}set(J,X){this.bHb[J]=X}}Object(k.a)(vb,"ApiEventStore",null,[]);class Yb{constructor(){this.jo=this.ia=this.Oc=null;this.Sl={}}get handlers(){return this.Sl}get zn(){return this.ia}set zn(J){this.ia=J}get Kd(){return this.Oc}set Kd(J){this.Oc=J}raiseEvent(J,X=null){J=this.yva(J);if(X){var Ia=this.Sl[X];Ia&&Ia(J)}else for(Ia in X=this.Sl,X){const fb=X[Ia];fb&&fb(J)}}addHandler(J,X,Ia=null){this.Sl[J]=X;this.t$a(Ia)}removeHandler(J,X,Ia=null){delete this.Sl[J];
this.t$a(Ia)}get result(){return this.jo}t$a(J){this.fC(J,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}fC(J,X){J&&(this.jo={},this.jo[Wc.c_Error]=X,J(this.jo))}}Object(k.a)(Yb,"ApiEvent",null,[1393]);class Gc extends Yb{constructor(){super()}yva(J){return J}static get instance(){Gc.Tl||(Gc.Tl=new Gc);return Gc.Tl}}Gc.Tl=null;Object(k.a)(Gc,"ActivationStatusChangedEvent",Yb,[]);class ud extends Yb{constructor(){super()}yva(){return"view"}static get instance(){ud.Tl||(ud.Tl=new ud);return ud.Tl}}
ud.Tl=null;Object(k.a)(ud,"ActiveViewChangedEvent",Yb,[]);var Nd=d(104);class Bc extends Yb{constructor(){super();this.TBe=null}yva(){return null}get uua(){!this.TBe&&this.Kd&&(this.TBe=$g.getInstance(this.Kd.xj));return this.TBe}addHandler(J,X,Ia=null,fb=null){this.Kd?this.Kd.Lu.cna()?J in this.handlers?this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(n.ULS.sendTraceTag(508360601,802,50,"AddHandler was called."),this.showDialog(J,fb,Ab=>{Ab===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
(Nd.a.count(this.handlers)||this.uua.kzi(Object(E.a)(this,this.bVe,"onMessageParentEvent")),this.handlers[J]=X,this.Kd.xj?({value:Ab}=$g.Sqg().Eg(J),Ab?(this.Kd.xj.setActivationCompletedStatus(Ab.Fg,!0),this.Kd.h2a(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),Ab.Fg,!0)):n.ULS.sendTraceTag(508360600,806,15,"Show dialog successed but get dialogInfo failed")):n.ULS.sendTraceTag(508360599,806,15,"Show dialog successed but ContextActivationManager is null"),this.t$a(Ia)):(n.ULS.sendTraceTag(508360598,
806,10,"Show dialog failed. Error code: {0}",Ab.toString()),this.fC(Ia,Ab))})):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(J,X,Ia=null){this.Kd?this.Kd.Lu.cna()?J in this.handlers?(n.ULS.sendTraceTag(508360597,802,50,"RemoveHandler was called."),this.uua.iVi(J,fb=>{delete this.handlers[J];Nd.a.count(this.handlers)||this.uua.$Dh(Object(E.a)(this,this.bVe,"onMessageParentEvent"));fb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
n.ULS.sendTraceTag(508360596,806,10,"Close dialog failed. Error code: {0}",fb.toString());this.fC(Ia,fb)})):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(J,X,Ia){try{this.uua.showDialog(X,J,Ia,null)}catch(fb){n.ULS.sendTraceTag(508360595,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",fb.message),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}bVe(J,
X){if(X.controlId in this.Sl){J={};J[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=X.messageType;J[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=X.messageContent;J[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=X.kRe;J[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=X.nOa;const Ia=this.Sl[X.controlId];Ia&&Ia(J);X.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.Sl[X.controlId],Nd.a.count(this.Sl)||
this.uua.$Dh(Object(E.a)(this,this.bVe,"onMessageParentEvent")))}}static get instance(){Bc.Tl||(Bc.Tl=new Bc);return Bc.Tl}}Bc.Tl=null;Object(k.a)(Bc,"DialogMessageReceivedEvent",Yb,[]);class qe extends Yb{constructor(){super()}yva(){return null}addHandler(J,X,Ia=null){this.Kd?this.Kd.Lu.cna()?(X=this.Kd.GAb(J))&&X.taskpane&&X.taskpane.isForUILessAction?(this.zn.Ia(Qb.a.Vyc,2,J),this.t$a(Ia)):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(J,X,Ia=null){this.Kd?this.Kd.Lu.cna()?(X=this.Kd.GAb(J))&&X.taskpane?X.taskpane.isForUILessAction?(this.zn.Ia(Qb.a.Ucc,2,J),this.t$a(Ia)):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(k.a)(qe,
"DialogNotificationShownInAddinEvent",Yb,[]);class qg extends Yb{constructor(){super();this.xj=this.R0d=null}yva(){return null}get uua(){this.R0d||(this.R0d=$g.getInstance(this.contextActivationMgr));return this.R0d}get contextActivationMgr(){!this.xj&&this.Kd&&(this.xj=this.Kd.xj);return this.xj}addHandler(J,X,Ia=null){this.Kd&&!this.Kd.Lu.cna()?this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):J in this.Sl?this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):
(Nd.a.count(this.Sl)||this.uua.jzi(Object(E.a)(this,this.Ynh,"onMessageDialogEvent")),this.Sl[J]=X,this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(J,X,Ia=null){this.Kd&&!this.Kd.Lu.cna()?this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):J in this.Sl?(delete this.Sl[J],Nd.a.count(this.Sl)||this.uua.EBl(Object(E.a)(this,this.Ynh,"onMessageDialogEvent")),this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}Ynh(J,
X){X.controlId in this.Sl&&(J={},J[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=X.messageType,J[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=X.messageContent,J[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=X.kRe,J[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=X.nOa,(X=this.Sl[X.controlId])&&X(J))}static get instance(){qg.Tl||(qg.Tl=new qg);return qg.Tl}}qg.Tl=null;Object(k.a)(qg,
"DialogParentMessageReceivedEvent",Yb,[]);class Jf extends Yb{constructor(){super()}yva(){return{}}static get instance(){Jf.Tl||(Jf.Tl=new Jf);return Jf.Tl}}Jf.Tl=null;Object(k.a)(Jf,"DocumentSelectionChangedEvent",Yb,[]);class Bd extends Yb{constructor(){super()}yva(){return null}raiseEvent(J,X){try{const Ia=this.Sl[X];Ia&&(X={},X[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=J,Ia(X))}catch(Ia){Gd.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Ia.message)}}static get instance(){Bd.Tl||
(Bd.Tl=new Bd);return Bd.Tl}}Bd.Tl=null;Object(k.a)(Bd,"DocumentThemeChangedEvent",Yb,[]);class Ld extends Yb{constructor(){super()}yva(){return null}addHandler(J,X,Ia=null){this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(J,X,Ia=null){this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){Ld.Tl||(Ld.Tl=new Ld);return Ld.Tl}}Ld.Tl=null;Object(k.a)(Ld,"OfficeThemeChangedEvent",Yb,[]);class sd{constructor(J){this.ani=
J}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(J,X){this.ani.executeHandlers(J,X)}}Object(k.a)(sd,"RichApiEventManagerHost",null,[1394]);class qd extends Yb{constructor(){super();this.lUd=null}yva(J){return J}addHandler(J,X,Ia=null,fb=null){this.Kd&&Ha.a(fb)?(this.lUd||(this.lUd=new sd(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.lUd)),this.Sl[J]=X,this.t$a(Ia)):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(J,
X,Ia=null,fb=null){this.Kd&&Ha.a(fb)&&J in this.Sl?(delete this.Sl[J],this.t$a(Ia)):this.fC(Ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}executeHandlers(J,X){const Ia={};Ia[OSF.DDA.WAC.UniqueArguments.ArrayData]=X;(J=this.Sl[J])&&J(Ia)}static get instance(){return qd.Ja||(qd.Ja=new qd)}}qd.Ja=null;Object(k.a)(qd,"RichApiMessageEvent",Yb,[]);class Kd extends Yb{constructor(){super()}yva(J){return J}static get instance(){Kd.Tl||(Kd.Tl=new Kd);return Kd.Tl}}Kd.Tl=null;Object(k.a)(Kd,"SettingsChangedEvent",
Yb,[]);class Gk extends vb{constructor(J,X){super(J,X)}Wgl(){this.bHb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Kd.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,ud.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,Gc.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,Bd.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,Ld.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,
Jf.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Bc.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,qg.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new qe);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,qd.instance)}}Object(k.a)(Gk,"EditorEventStore",vb,[]);class of{constructor(J){this.cmc=null;this.Oc=J}uuj(J){this.cmc||this.mhl();if(!J||!this.cmc[J])return null;if(J=this.cmc[J]())J.Kd=this.Oc;return J}set(J,
X){this.cmc[J]=X}}Object(k.a)(of,"ApiMethodFactory",null,[]);class om{constructor(J,X,Ia,fb){this.zj=J.toLowerCase();this.fileSize=X;this.kde=fb;this.hTh=Ia}}Object(k.a)(om,"DocumentCopy",null,[]);var mi=d(398),Oe=d(265);class Ol extends mi.a{constructor(J,X,Ia,fb,Ab,ec,Uc){super();this.KC=J.string;this.mA=X;this.goa=Ia;this.iha=Ab;this.fSk=fb;this.Fhc=ec;this.QYa=Uc;this.i1a=Object(E.a)(this,this.E5k,"onGetDocumentCopyChunkFinished");this.onError=Object(E.a)(this,this.D5k,"onGetDocumentCopyChunkError")}start(){this.hAd=
!1;Oe.a.Eig(this.KC,this.mA,this.goa,this.fSk,this.iha,Object(E.a)(this,this.Afa,"handleWebserviceResponse"),Object(E.a)(this,this.zfa,"handleWebserviceError"))}E5k(J){if(J.dVa){const X={};J=J.result;X.value=J.FileData;X.errorCode=J.ErrorCode;this.Fhc(this.mA,X)}else this.handleError(J)}D5k(J){this.handleError(J)}handleError(J){this.QYa&&(J=J.error,this.QYa(this.mA,!!J&&2===J.type))}}Object(k.a)(Ol,"GetDocumentCopyChunkTask",mi.a,[]);class pm extends mi.a{constructor(J,X,Ia,fb,Ab,ec){super();this.KC=
J.string;this.mA=X;this.goa=Ia;this.iha=fb;this.Fhc=Ab;this.QYa=ec;this.i1a=Object(E.a)(this,this.G5k,"onGetDocumentCopyFinished");this.onError=Object(E.a)(this,this.F5k,"onGetDocumentCopyError")}start(){this.hAd=!1;Oe.a.Wzj(this.KC,this.mA,this.goa,Object(E.a)(this,this.Afa,"handleWebserviceResponse"),Object(E.a)(this,this.zfa,"handleWebserviceError"))}G5k(J){if(J.dVa){const X={};J=J.result;X.fileSize=J.FileSize;X.errorCode=J.ErrorCode;X.format=this.goa;X.sliceSize=this.iha;this.Fhc(this.mA,X)}else this.handleError(J)}F5k(J){this.handleError(J)}handleError(J){this.QYa&&
(J=J.error,this.QYa(this.mA,!!J&&2===J.type))}}Object(k.a)(pm,"GetDocumentCopyTask",mi.a,[]);class tk extends mi.a{constructor(J,X,Ia,fb,Ab,ec,Uc){super();this.KC=J.string;this.mA=X;this.goa=Ia;this.OLk=fb;this.NLk=Ab;this.Fhc=ec;this.QYa=Uc;this.i1a=Object(E.a)(this,this.N8k,"onReleaseDocumentCopyFinished");this.onError=Object(E.a)(this,this.M8k,"onReleaseDocumentCopyError")}start(){this.hAd=!1;Oe.a.Bvc(this.KC,this.mA,this.goa,this.OLk,this.NLk,Object(E.a)(this,this.Afa,"handleWebserviceResponse"),
Object(E.a)(this,this.zfa,"handleWebserviceError"))}N8k(J){if(J.dVa){const X={};X.errorCode=J.result.ErrorCode;this.Fhc(this.mA,X)}else this.handleError(J)}M8k(J){this.handleError(J)}handleError(J){this.QYa&&(J=J.error,this.QYa(this.mA,!!J&&2===J.type))}}Object(k.a)(tk,"ReleaseGetDocumentCopyTask",mi.a,[]);class Oj{constructor(){this.Hkd=null}start(){this.Hkd.start()}static A3i(J,X,Ia,fb,Ab,ec){const Uc=new Oj;Uc.Hkd=new pm(J,X,Ia,fb,Ab,ec);return Uc}static z3i(J,X,Ia,fb,Ab,ec,Uc){const Ad=new Oj;
Ad.Hkd=new Ol(J,X,Ia,fb,Ab,ec,Uc);return Ad}static P1f(J,X,Ia,fb,Ab,ec,Uc){const Ad=new Oj;Ad.Hkd=new tk(J,X,Ia,fb,Ab,ec,Uc);return Ad}}Object(k.a)(Oj,"AppForOfficeTask",null,[]);class yk{constructor(){this.GDe=1;this.Isf=new gc.a}get UFa(){return this.Isf}lOi(J,X,Ia,fb){const Ab=this.Mlg();J=new om(J,X,Ia,fb);this.UFa.$(Ab.toString(),J);return Ab}lBg(J,X){for(const Ia of this.UFa){const fb=Ia.value;if(fb.zj===J.toLowerCase()&&fb.kde===X)return!0}return!1}Ggg(J){return this.UFa.ga(J.toString())}Kyl(J){this.UFa.remove(J.toString())}Bvc(J,
X,Ia,fb){(fb&&this.Lyl(X)||Ia&&this.Dyl())&&Oj.P1f(J,X,4,Ia,fb,()=>{},()=>{}).start()}Dyl(){let J=!1;0<this.UFa.count&&(this.Isf=new gc.a,J=!0);return J}Lyl(J){if(!J)return!1;const X=[];for(const Ia of this.UFa)Ia.value.zj===J.toLowerCase()&&X.push(Ia.key);for(J=0;J<X.length;J++)this.UFa.remove(X[J]);return 0<X.length}Mlg(){return this.GDe++}}Object(k.a)(yk,"GetDocumentCopyHelper",null,[1338]);class bm{constructor(J,X){this.jSg=X.length;this.iha=J;this.eSk=Math.ceil(this.jSg/J);this.y0i(X)}y0i(J){for(let X=
0;X<this.eSk;X++){const Ia=X*this.iha;J.slice(Ia,Math.min(Ia+this.iha,this.jSg))}}}Object(k.a)(bm,"DocumentCopyCache",null,[]);class Hk{constructor(){this.qMe=this.OMe=null;this.rMe=this.PMe=0}add(J,X,Ia,fb){4===X?(this.PMe=J,this.OMe=new bm(Ia,fb)):3===X&&(this.rMe=J,this.qMe=new bm(Ia,fb))}remove(J){this.PMe===J?(this.PMe=0,this.OMe=null):this.rMe===J&&(this.rMe=0,this.qMe=null)}contains(J){return 4===J&&!!this.OMe||3===J&&!!this.qMe}}Object(k.a)(Hk,"PerAppCache",null,[]);class Af{get cache(){return Af.Oi}get lde(){return Af.KIk}lBg(J,
X){return J in this.cache&&this.cache[J].contains(X)}Eig(){}Bvc(J){if(J.toString()in this.lde){const X=this.lde[J.toString()];delete this.lde[J.toString()];this.cache[X].remove(J)}}Mlg(){return Af.GDe++}}Af.Oi={};Af.KIk={};Af.GDe=1;Object(k.a)(Af,"GetFileApiProxy",null,[1478]);class rg{constructor(J,X,Ia){this.xh=0;this.controlId=this.yCa=this.JI=this.jGb=this.Oc=this.jo=null;this.parameters=J;this.callback=X;this.HBi=Ia;new Af;this.Zfb=new rd;this.DZa=new yk}get fPc(){this.Zfb||(this.Zfb=new rd);
return this.Zfb}get nfa(){return this.DZa}get JJl(){this.JI||(this.JI=Ob.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.JI}get w5j(){return this.yCa||(this.yCa=Ob.a.instance.Ha("Postmessage.IHostPostmessenger"))}get errorCode(){return this.xh}set errorCode(J){this.xh=J}get result(){return this.jo}set result(J){this.jo=J}get Lu(){return this.jGb}get Kd(){return this.Oc}set Kd(J){(this.Oc=J)?(this.jGb=this.Oc.Lu,this.DZa=this.Oc.nfa):this.DZa=this.jGb=null}go(){this.jo=
{};try{this.pq()}catch(J){this.Xyk(J)}this.cJ()}Xyk(J){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Gd.a.J(18396573,802,10,"Error when executing API: {0}",J.toString())}cJ(){this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&Gd.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",this.xh);this.jo[Wc.c_Error]=this.xh;this.callback(this.jo)}Rfe(){return this.controlId?this.Kd?this.Kd.jY.SU(this.controlId):null:null}Buj(){if(!this.controlId)return null;let J=null;
this.Kd&&(J=this.Kd.jY.SU(this.controlId));return J?0===J.$y?this.Kd.$bg(J.shape.slideId,J.shape.id):1===J.$y?this.Kd.WFa(J.An.id):null:null}tle(J){return J?this.Kd?this.Kd.tle(J):null:null}}Object(k.a)(rg,"ApiMethod",null,[]);class Li extends rg{constructor(){super()}pq(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[P.a.vBi][P.a.uBi],this.parameters);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}
Object(k.a)(Li,"AppCommandInvocationCompletedMethod",rg,[]);class Vf extends rg{constructor(){super()}go(){this.jo={};this.pq()}pq(){if(this.Lu)try{const J=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();J&&J.length>this.Kd.i0d.td.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(n.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",J.length),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.cJ()):this.Lu.lab(J,Object(E.a)(this,this.W2i,
"createDocumentSuccessCallback"),Object(E.a)(this,this.V2i,"createDocumentFailCallback"))}catch(J){Gd.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+J.toString()),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.cJ()}else this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.cJ()}W2i(J){const X=new m.StandardDialog;X.Fd=4;X.Ky(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Ia=>{1===Ia&&window.open(J);this.xh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.cJ()})}V2i(J){this.xh=J?J:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}get description(){return"Create a new ppt document in the user's default folder."}}Object(k.a)(Vf,"CreateDocumentMethod",rg,[]);var Ej=d(97),Tj=d(89);class dj{static ntl(J){const X=new Map;X.set("ApiId",J.toString());Ej.Health.instance.recordKpiUsage(dj.DIh,1,dj.zIh,X)}static mtl(J,X,Ia){const fb=new Map;fb.set("ApiId",J.toString());J=Object.assign(new Tj.a,
{extendedProperties:fb,durationMs:dj.Kig(X,Ia)});Ej.Health.instance.recordKpiSuccess(dj.DIh,J)}static $Ah(J){const X=new Map;X.set("fWacPartition",J.toString());Ej.Health.instance.recordKpiUsage(dj.EIh,1,dj.zIh,X)}static X1e(J,X){J=Object.assign(new Tj.a,{durationMs:dj.Kig(J,X)});Ej.Health.instance.recordKpiSuccess(dj.EIh,J)}static Kig(J,X){let Ia=null;J&&X&&(Ia=X-J);return Ia}}dj.DIh="PptApiCall";dj.EIh="PptApiRequest";dj.zIh="pptom";Object(k.a)(dj,"PptWacApiTelemetry",null,[]);class Pl{constructor(){this.ver=
0;this.exec=this.sel=null}}Object(k.a)(Pl,"ApiRequest",null,[]);class Si{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(k.a)(Si,"SelectionData",null,[]);const Le=(J,X)=>{var Ia=Object,fb=Ia.assign,Ab=new Pl,ec=Object,Uc=ec.assign,Ad=new Si,Ce=J.Lu.Xe();const ye=[];if(Ce){ye.length=Ce.length;for(var hf=0;hf<Ce.length;hf++)ye[hf]=Ce[hf].Fb.toString()}Ce=J.Lu.Hd();hf=[];if(Ce){hf.length=Ce.length;for(let Gf=0;Gf<Ce.length;Gf++)hf[Gf]=Ce[Gf].get_shapeId().toString()}J=fb.call(Ia,Ab,{ver:1,
exec:X,sel:Uc.call(ec,Ad,{sldLst:ye,shpLst:hf,txRn:J.Lu.zLj()})});return Sys.Serialization.JavaScriptSerializer.serialize(J)},uj=J=>{if(D.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.IncludeWacApiHostTypeRegister")){var X=J.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Ia=X.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ia.addParameter("shortcuts","String[]",
1,null,0);X.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Ia=X.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ia.addParameter("shortcuts","Object",1,null,0);X=J.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ia=X.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Ia.addParameter("pickerCustomizationJsonString","String",1,null,0);X=J.addType("Microsoft.Office.Auth",
"{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Ia=X.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Ia.addParameter("appName","String",1,null,0);Ia.addParameter("target","String",1,null,0);X=J.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);X.addProperty("Data",4,"String",1,!1,null,0);X=J.addType("Microsoft.Office.AugLoopEventService",
"{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);Ia=X.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Ia.addParameter("data","String",1,null,0);X.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);X.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);X=J.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",
2,0);X.addProperty("BatchId",6,"String",1,!1,null,0);X=J.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Ia=X.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Ia.addParameter("batchId","String",1,null,0);Ia=X.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);Ia.addParameter("batchId","String",1,null,0);X.addMethod("Undo",1,"Boolean",1,0,"Undo",4);X.addMethod("_RegisterUndoStackChangedEvent",
2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);X.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);X=J.addEnumType("Microsoft.Office.UserFeedbackType");X.addEnumField("Like",0);X.addEnumField("Dislike",1);X.addEnumField("Idea",2);X.addEnumField("Unclassified",3);X=J.addEnumType("Microsoft.Office.UserFeedbackUIType");X.addEnumField("ModalDialog",0);X.addEnumField("Taskpane",1);X=J.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}",
"{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);Ia=X.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);Ia.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);Ia.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);Ia.addParameter("featureArea","String",1,null,0);Ia.addParameter("options","Object",1,null,0);X.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);X.addMethod("_UnregisterUserFeedbackUIDismissedEvent",
19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4)}X=J.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Ia=X.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Ia.addParameter("address","String",1,null,0);Ia.addParameter("displayName","String",1,null,0);Ia=X.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);Ia.addParameter("slideContent",
"String",1,null,0);X=J.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);X.addProperty("Id",14,"String",1,!0,null,0);X.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);X.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);X.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);X.addProperty("Title",1,"String",1,!0,null,0);Ia=X.addMethod("ApplyJOfcCommands",
10,"String",1,0,"ApplyJOfcCommands",4);Ia.addParameter("commandPayload","String",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions",2,null,0);Ia=X.addMethod("ApplyJOfcCommandsAsync",13,"String",1,0,"ApplyJOfcCommandsAsync",4);Ia.addParameter("commandPayload","String",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions",2,null,0);X.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",
0);X.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);X.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);X.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRangeOrNullObject",0);Ia=X.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);Ia.addParameter("base64File","String",1,null,0);Ia.addParameter("options",
"Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Ia=X.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Ia.addParameter("slideIds","String[]",1,null,0);Ia=X.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Ia.addParameter("referenceId","String",1,null,0);Ia.addParameter("eventType","Int32",1,null,0);X.addMethod("_RegisterEventApplyJOfcCommandsCompleted",11,"Void",0,0,"_RegisterEventApplyJOfcCommandsCompleted",0);Ia=X.addMethod("_UnregisterEvent",1002,"Void",
0,1,"_UnregisterEvent",0);Ia.addParameter("referenceId","String",1,null,0);Ia.addParameter("eventType","Int32",1,null,0);X.addMethod("_UnregisterEventApplyJOfcCommandsCompleted",12,"Void",0,0,"_UnregisterEventApplyJOfcCommandsCompleted",0);X=J.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);X.addProperty("LayoutId",1,"String",1,!1,null,0);X.addProperty("SlideMasterId",2,"String",1,!1,null,0);X=J.addType("Microsoft.Office.PowerPoint.ApplyJOfcCommandsCompletedEventArgs",
"{2a4c199e-e769-4225-9355-93dfe110c629}","{e20b2ede-8e1e-4e20-bb9e-dce2cbc70bcb}",2,0);X.addProperty("RequestId",1,"String",1,!1,null,0);X.addProperty("Result",2,"String",1,!1,null,0);X=J.addType("Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions","{65f2dfc9-c96e-44ce-8f74-6ecb42f994cf}","{feeaf50c-98cf-4bed-93d5-a78df27c3b78}",2,0);X.addProperty("DesignerOptions",1,"String",1,!1,null,0);X.addProperty("ScenarioOptions",2,"String",1,!1,null,0);X.addProperty("SelectionOptions",3,"String",1,!1,null,
0);X=J.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}","",3,0);X.addProperty("Visible",2,"Boolean",1,!1,null,0);X.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);X=J.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");X.addEnumField("Straight",0);X.addEnumField("Elbow",1);X.addEnumField("Curve",2);X=J.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");X.addEnumField("LineInverse",0);X.addEnumField("Triangle",1);X.addEnumField("RightTriangle",
2);X.addEnumField("Rectangle",3);X.addEnumField("Diamond",4);X.addEnumField("Parallelogram",5);X.addEnumField("Trapezoid",6);X.addEnumField("NonIsoscelesTrapezoid",7);X.addEnumField("Pentagon",8);X.addEnumField("Hexagon",9);X.addEnumField("Heptagon",10);X.addEnumField("Octagon",11);X.addEnumField("Decagon",12);X.addEnumField("Dodecagon",13);X.addEnumField("Star4",14);X.addEnumField("Star5",15);X.addEnumField("Star6",16);X.addEnumField("Star7",17);X.addEnumField("Star8",18);X.addEnumField("Star10",
19);X.addEnumField("Star12",20);X.addEnumField("Star16",21);X.addEnumField("Star24",22);X.addEnumField("Star32",23);X.addEnumField("RoundRectangle",24);X.addEnumField("Round1Rectangle",25);X.addEnumField("Round2SameRectangle",26);X.addEnumField("Round2DiagonalRectangle",27);X.addEnumField("SnipRoundRectangle",28);X.addEnumField("Snip1Rectangle",29);X.addEnumField("Snip2SameRectangle",30);X.addEnumField("Snip2DiagonalRectangle",31);X.addEnumField("Plaque",32);X.addEnumField("Ellipse",33);X.addEnumField("Teardrop",
34);X.addEnumField("HomePlate",35);X.addEnumField("Chevron",36);X.addEnumField("PieWedge",37);X.addEnumField("Pie",38);X.addEnumField("BlockArc",39);X.addEnumField("Donut",40);X.addEnumField("NoSmoking",41);X.addEnumField("RightArrow",42);X.addEnumField("LeftArrow",43);X.addEnumField("UpArrow",44);X.addEnumField("DownArrow",45);X.addEnumField("StripedRightArrow",46);X.addEnumField("NotchedRightArrow",47);X.addEnumField("BentUpArrow",48);X.addEnumField("LeftRightArrow",49);X.addEnumField("UpDownArrow",
50);X.addEnumField("LeftUpArrow",51);X.addEnumField("LeftRightUpArrow",52);X.addEnumField("QuadArrow",53);X.addEnumField("LeftArrowCallout",54);X.addEnumField("RightArrowCallout",55);X.addEnumField("UpArrowCallout",56);X.addEnumField("DownArrowCallout",57);X.addEnumField("LeftRightArrowCallout",58);X.addEnumField("UpDownArrowCallout",59);X.addEnumField("QuadArrowCallout",60);X.addEnumField("BentArrow",61);X.addEnumField("UturnArrow",62);X.addEnumField("CircularArrow",63);X.addEnumField("LeftCircularArrow",
64);X.addEnumField("LeftRightCircularArrow",65);X.addEnumField("CurvedRightArrow",66);X.addEnumField("CurvedLeftArrow",67);X.addEnumField("CurvedUpArrow",68);X.addEnumField("CurvedDownArrow",69);X.addEnumField("SwooshArrow",70);X.addEnumField("Cube",71);X.addEnumField("Can",72);X.addEnumField("LightningBolt",73);X.addEnumField("Heart",74);X.addEnumField("Sun",75);X.addEnumField("Moon",76);X.addEnumField("SmileyFace",77);X.addEnumField("IrregularSeal1",78);X.addEnumField("IrregularSeal2",79);X.addEnumField("FoldedCorner",
80);X.addEnumField("Bevel",81);X.addEnumField("Frame",82);X.addEnumField("HalfFrame",83);X.addEnumField("Corner",84);X.addEnumField("DiagonalStripe",85);X.addEnumField("Chord",86);X.addEnumField("Arc",87);X.addEnumField("LeftBracket",88);X.addEnumField("RightBracket",89);X.addEnumField("LeftBrace",90);X.addEnumField("RightBrace",91);X.addEnumField("BracketPair",92);X.addEnumField("BracePair",93);X.addEnumField("Callout1",94);X.addEnumField("Callout2",95);X.addEnumField("Callout3",96);X.addEnumField("AccentCallout1",
97);X.addEnumField("AccentCallout2",98);X.addEnumField("AccentCallout3",99);X.addEnumField("BorderCallout1",100);X.addEnumField("BorderCallout2",101);X.addEnumField("BorderCallout3",102);X.addEnumField("AccentBorderCallout1",103);X.addEnumField("AccentBorderCallout2",104);X.addEnumField("AccentBorderCallout3",105);X.addEnumField("WedgeRectCallout",106);X.addEnumField("WedgeRRectCallout",107);X.addEnumField("WedgeEllipseCallout",108);X.addEnumField("CloudCallout",109);X.addEnumField("Cloud",110);X.addEnumField("Ribbon",
111);X.addEnumField("Ribbon2",112);X.addEnumField("EllipseRibbon",113);X.addEnumField("EllipseRibbon2",114);X.addEnumField("LeftRightRibbon",115);X.addEnumField("VerticalScroll",116);X.addEnumField("HorizontalScroll",117);X.addEnumField("Wave",118);X.addEnumField("DoubleWave",119);X.addEnumField("Plus",120);X.addEnumField("FlowChartProcess",121);X.addEnumField("FlowChartDecision",122);X.addEnumField("FlowChartInputOutput",123);X.addEnumField("FlowChartPredefinedProcess",124);X.addEnumField("FlowChartInternalStorage",
125);X.addEnumField("FlowChartDocument",126);X.addEnumField("FlowChartMultidocument",127);X.addEnumField("FlowChartTerminator",128);X.addEnumField("FlowChartPreparation",129);X.addEnumField("FlowChartManualInput",130);X.addEnumField("FlowChartManualOperation",131);X.addEnumField("FlowChartConnector",132);X.addEnumField("FlowChartPunchedCard",133);X.addEnumField("FlowChartPunchedTape",134);X.addEnumField("FlowChartSummingJunction",135);X.addEnumField("FlowChartOr",136);X.addEnumField("FlowChartCollate",
137);X.addEnumField("FlowChartSort",138);X.addEnumField("FlowChartExtract",139);X.addEnumField("FlowChartMerge",140);X.addEnumField("FlowChartOfflineStorage",141);X.addEnumField("FlowChartOnlineStorage",142);X.addEnumField("FlowChartMagneticTape",143);X.addEnumField("FlowChartMagneticDisk",144);X.addEnumField("FlowChartMagneticDrum",145);X.addEnumField("FlowChartDisplay",146);X.addEnumField("FlowChartDelay",147);X.addEnumField("FlowChartAlternateProcess",148);X.addEnumField("FlowChartOffpageConnector",
149);X.addEnumField("ActionButtonBlank",150);X.addEnumField("ActionButtonHome",151);X.addEnumField("ActionButtonHelp",152);X.addEnumField("ActionButtonInformation",153);X.addEnumField("ActionButtonForwardNext",154);X.addEnumField("ActionButtonBackPrevious",155);X.addEnumField("ActionButtonEnd",156);X.addEnumField("ActionButtonBeginning",157);X.addEnumField("ActionButtonReturn",158);X.addEnumField("ActionButtonDocument",159);X.addEnumField("ActionButtonSound",160);X.addEnumField("ActionButtonMovie",
161);X.addEnumField("Gear6",162);X.addEnumField("Gear9",163);X.addEnumField("Funnel",164);X.addEnumField("MathPlus",165);X.addEnumField("MathMinus",166);X.addEnumField("MathMultiply",167);X.addEnumField("MathDivide",168);X.addEnumField("MathEqual",169);X.addEnumField("MathNotEqual",170);X.addEnumField("CornerTabs",171);X.addEnumField("SquareTabs",172);X.addEnumField("PlaqueTabs",173);X.addEnumField("ChartX",174);X.addEnumField("ChartStar",175);X.addEnumField("ChartPlus",176);X=J.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");
X.addEnumField("KeepSourceFormatting",0);X.addEnumField("UseDestinationTheme",1);X=J.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);X.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);X.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);X.addProperty("TargetSlideId",5,"String",1,!1,null,0);X=J.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");
X.addEnumField("Left",0);X.addEnumField("Center",1);X.addEnumField("Right",2);X.addEnumField("Justify",3);X.addEnumField("JustifyLow",4);X.addEnumField("Distributed",5);X.addEnumField("ThaiDistributed",6);X=J.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);X.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);X.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,
null,0);X.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);X.addProperty("Height",1,"Double",1,!1,null,0);X.addProperty("Left",2,"Double",1,!1,null,0);X.addProperty("Top",3,"Double",1,!1,null,0);X.addProperty("Width",4,"Double",1,!1,null,0);X=J.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Ia=X.addMethod("AddGeometricShape",
6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Ia.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ia=X.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Ia.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ia=X.addMethod("AddTextBox",
8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Ia.addParameter("text","String",1,null,0);Ia.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);X.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ia.addParameter("key","String",1,null,0);Ia=X.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",
3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);X=J.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);X.addProperty("Id",1,"String",1,!0,null,0);X.addProperty("Name",3,"String",1,!0,null,0);X.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);X.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",
0);X=J.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);X.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);Ia.addParameter("key","String",1,null,0);Ia=X.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",
0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);X=J.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);X.addProperty("Id",1,"String",1,!0,null,0);X.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);X.addProperty("Name",4,"String",1,!0,null,0);X.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",
3,!0,null,0);X.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);X.addProperty("Key",2,"String",1,!0,null,0);X.addProperty("Value",3,"String",1,!1,null,0);X.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Ia=X.addMethod("Add",1,"Void",0,0,"Add",0);Ia.addParameter("key","String",1,null,0);Ia.addParameter("value",
"String",1,null,0);Ia=X.addMethod("Delete",2,"Void",0,0,"Delete",0);Ia.addParameter("key","String",1,null,0);X.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);Ia.addParameter("key","String",1,null,0);Ia=X.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Ia.addParameter("key",
"String",1,null,0);X.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);X=J.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);X.addProperty("Id",1,"String",1,!0,null,0);X.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);X.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);X.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",
3,!0,null,0);X.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);X.addMethod("Delete",3,"Void",0,0,"Delete",0);Ia=X.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Ia.addParameter("shapeIds","String[]",1,null,0);X.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);X=J.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");X.addEnumField("NoFill",0);X.addEnumField("Solid",1);X.addEnumField("Gradient",2);X.addEnumField("Pattern",3);X.addEnumField("PictureAndTexture",
4);X.addEnumField("SlideBackground",5);X=J.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);X.addProperty("ForegroundColor",2,"String",1,!1,null,0);X.addProperty("Transparency",5,"Double",1,!1,null,0);X.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);X.addMethod("Clear",1,"Void",0,0,"Clear",0);Ia=X.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);Ia.addParameter("color","String",1,null,0);X.addMethod("_OnAccess",
3,"Void",0,1,"_OnAccess",0);X=J.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");X.addEnumField("Single",0);X.addEnumField("ThickBetweenThin",1);X.addEnumField("ThickThin",2);X.addEnumField("ThinThick",3);X.addEnumField("ThinThin",4);X=J.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");X.addEnumField("Dash",0);X.addEnumField("DashDot",1);X.addEnumField("DashDotDot",2);X.addEnumField("LongDash",3);X.addEnumField("LongDashDot",4);X.addEnumField("RoundDot",5);X.addEnumField("Solid",
6);X.addEnumField("SquareDot",7);X.addEnumField("LongDashDotDot",8);X.addEnumField("SystemDash",9);X.addEnumField("SystemDot",10);X.addEnumField("SystemDashDot",11);X=J.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);X.addProperty("Color",1,"String",1,!1,null,0);X.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);X.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);X.addProperty("Transparency",
5,"Double",1,!1,null,0);X.addProperty("Visible",6,"Boolean",1,!1,null,0);X.addProperty("Weight",7,"Double",1,!1,null,0);X.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);X=J.addEnumType("Microsoft.Office.PowerPoint.ShapeType");X.addEnumField("Unsupported",0);X.addEnumField("Image",1);X.addEnumField("GeometricShape",2);X.addEnumField("Group",3);X.addEnumField("Line",4);X=J.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");X.addEnumField("AutoSizeNone",0);X.addEnumField("AutoSizeTextToFitShape",
1);X.addEnumField("AutoSizeShapeToFitText",2);X.addEnumField("AutoSizeMixed",3);X=J.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");X.addEnumField("Top",0);X.addEnumField("Middle",1);X.addEnumField("Bottom",2);X.addEnumField("TopCentered",3);X.addEnumField("MiddleCentered",4);X.addEnumField("BottomCentered",5);X=J.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");X.addEnumField("None",0);X.addEnumField("Single",1);X.addEnumField("Double",2);X.addEnumField("Heavy",
3);X.addEnumField("Dotted",4);X.addEnumField("DottedHeavy",5);X.addEnumField("Dash",6);X.addEnumField("DashHeavy",7);X.addEnumField("DashLong",8);X.addEnumField("DashLongHeavy",9);X.addEnumField("DotDash",10);X.addEnumField("DotDashHeavy",11);X.addEnumField("DotDotDash",12);X.addEnumField("DotDotDashHeavy",13);X.addEnumField("Wavy",14);X.addEnumField("WavyHeavy",15);X.addEnumField("WavyDouble",16);X=J.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);
X.addProperty("Bold",1,"Boolean",1,!1,null,0);X.addProperty("Color",2,"String",1,!1,null,0);X.addProperty("Italic",3,"Boolean",1,!1,null,0);X.addProperty("Name",5,"String",1,!1,null,0);X.addProperty("Size",6,"Double",1,!1,null,0);X.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);X.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);X.addProperty("Font",1,
"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);X.addProperty("Length",7,"Int32",1,!1,null,0);X.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);X.addProperty("Start",9,"Int32",1,!1,null,0);X.addProperty("Text",5,"String",1,!1,null,0);X.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Ia=X.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Ia.addParameter("start","Int32",
1,null,0);Ia.addParameter("length","Int32",1,null,0);X.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);X.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);X.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);X.addProperty("BottomMargin",2,"Double",1,!1,null,0);X.addProperty("HasText",4,"Boolean",1,!0,null,0);X.addProperty("LeftMargin",6,"Double",1,!1,null,
0);X.addProperty("RightMargin",7,"Double",1,!1,null,0);X.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);X.addProperty("TopMargin",9,"Double",1,!1,null,0);X.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);X.addProperty("WordWrap",11,"Boolean",1,!1,null,0);X.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);X.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);X.addMethod("_OnAccess",
5,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);X.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);X.addProperty("Height",5,"Double",1,!1,null,0);X.addProperty("Id",1,"String",1,!0,null,0);X.addProperty("Left",6,"Double",1,!1,null,0);X.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);X.addProperty("Name",7,"String",1,!1,null,0);X.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",
3,!0,null,0);X.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);X.addProperty("Top",8,"Double",1,!1,null,0);X.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);X.addProperty("Width",10,"Double",1,!1,null,0);X.addMethod("Delete",4,"Void",0,0,"Delete",0);X.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);X.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",
0);X.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);X.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);X.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);X.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);X.addMethod("_OnAccess",
2,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);X.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ia.addParameter("key","String",1,null,0);Ia=X.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",
0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);X=J.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Ia=X.addMethod("Add",6,"Void",0,0,"Add",0);Ia.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",2,null,0);X.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Ia.addParameter("key",
"String",1,null,0);Ia=X.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);X=J.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",
3,0);X.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Ia.addParameter("key","String",1,null,0);Ia=X.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",
!0);X=J.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);X.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);Ia.addParameter("key","String",1,null,0);Ia=X.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Ia.addParameter("index","Int32",1,null,0);Ia=X.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",
0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);X=J.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);X.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ia=X.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ia.addParameter("appRuntimeState",
"Microsoft.AppRuntime.AppRuntimeState",1,null,0);X=J.addEnumType("Microsoft.AppRuntime.AppRuntimeState");X.addEnumField("Inactive",0);X.addEnumField("Background",1);X.addEnumField("Visible",2);X=J.addEnumType("Microsoft.AppRuntime.Visibility");X.addEnumField("Hidden",1);X.addEnumField("Visible",2);X=J.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);X.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeStartState",0);Ia=X.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Ia.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);X=J.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");X.addEnumField("Unknown",0);X.addEnumField("Basic",1);X.addEnumField("Premium",2);X=J.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ia=X.addMethod("GetFeatureTier",
2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ia.addParameter("feature","String",1,null,0);Ia.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ia=X.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ia.addParameter("feature","String",1,null,0);Ia=X.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);Ia.addParameter("resource","String",1,null,0);Ia.addParameter("policy","String",
1,null,0);Ia.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Ia=X.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ia.addParameter("feature","String",1,null,0);Ia.addParameter("fallbackValue","Boolean",1,null,0);X.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ia=X.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ia.addParameter("experienceId","String",1,null,0);Ia=X.addMethod("_TestFireStateChangedEvent",
6,"Void",0,0,"_TestFireStateChangedEvent",4);Ia.addParameter("feature","String",1,null,0);X=J.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);X.addProperty("Id",5,"String",1,!0,null,0);X.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);X.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);X=J.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",
3,0);X.addProperty("Scopes",1,"String",1,!1,null,0);X=J.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);X.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ia=X.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ia.addParameter("jsonCreate","String",1,null,0);Ia=X.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ia.addParameter("jsonUpdate",
"String",1,null,0);Ia=X.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ia.addParameter("id","String",1,null,0);Ia=X.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ia.addParameter("id","String",1,null,0);X.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);X.addProperty("Id",2,"String",1,!0,null,0);Ia=X.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Ia.addParameter("visibility","Boolean",1,null,0);X.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);X.addProperty("Enabled",3,"Boolean",1,!1,null,0);X.addProperty("Id",2,"String",1,!0,null,0);X.addProperty("Label",4,"String",1,!0,null,0);Ia=X.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ia.addParameter("enabled","Boolean",1,null,0);X.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);X=J.addType("Microsoft.DynamicRibbon.RibbonButtonCollection",
"{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);X.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ia=X.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ia.addParameter("key","String",1,null,0);X.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);X.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};var Tk=d(41);class bk{constructor(J,X){this.Mnc=J;this.jnc=X}R0f(J){return[200,null,J]}Bjj(J,X,Ia,fb,Ab,ec){const Uc=Tk.a.A_(),Ad=this.Mnc.create(X,Ia,fb);fb.gJf=Ad;const Ce=this.jnc.create(ec,
Ad);Ce.context.appId=X;Ce.context.controlId=Ia;const ye=()=>{dj.$Ah(!0);Ad.Ktc=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ad,uj,Ce,J).then(Gf=>{if(!Gf)return n.ULS.sendTraceTag(508850825,802,10,"ExecuteRichApiRequest failed."),Ab(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;dj.X1e(Uc,Tk.a.A_());Ab(Gf,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},Gf=>{n.ULS.sendTraceTag(508850824,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",
X,Gf);Ab(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},hf=()=>{dj.$Ah(!1);let Gf=J[4];Hc.a("ExtensibilityUseSerializedPayloads")&&(Gf=Le(fb,Gf));OfficeExtension.WacRuntime.Utility.createPromise(Kg=>{const Lg={};Lg.promiseToResolve=Kg;Lg.requestBody=Gf;D.AFrameworkApplication.Pa.Ia(Jc.a.hXc,2,Lg)}).then(Kg=>{Hc.a("ExtensibilityResetResponse")&&D.AFrameworkApplication.Pa.Ia(Jc.a.hXc,2,{promiseToResolve:null,requestBody:""});if(Hc.a("ExtensibilityUseSerializedPayloads")){a:if((Kg=
Sys.Serialization.JavaScriptSerializer.deserialize(Kg.toString()))&&Kg.sel&&Kg.sel.sldLst){var Lg=ec.presentation,se=Kg.sel.sldLst,xi=[];if(se)for(gi of se)({slideId:se}=oj.a.s_h(gi)).returnValue&&(se=Object(Ca.a)(205,Lg.LD(se)))&&xi.push(se);var gi=xi;if(gi.length&&!fb.Lu.Bem(gi))Kg=null;else{gi=1===gi.length?gi[0]:null;Lg=null;if(gi&&Kg.sel.shpLst){xi=Kg.sel.shpLst;Lg=[];if(xi)for(jf of xi)(xi=gi.ER(parseInt(jf)))&&Lg.push(xi);var jf=Lg;if(jf.length&&!fb.Lu.Aem(jf)){Kg=null;break a}Lg=1===jf.length?
jf[0]:null}Kg=Lg&&Kg.sel.txRn&&(Kg.sel.txRn.length&&2!==Kg.sel.txRn.length||2===Kg.sel.txRn.length&&0<=Kg.sel.txRn[0]&&!fb.Lu.Cem(Lg,Kg.sel.txRn[0],Kg.sel.txRn[1]))?null:Kg.rst}}else Kg=null;Kg?(dj.X1e(Uc,Tk.a.A_()),Ab(this.R0f(Kg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Ab(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else dj.X1e(Uc,Tk.a.A_()),Ab(this.R0f(Kg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Ab(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
return null})};J?(Ad.Ktc=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ad,uj,Ce,J).then(Gf=>{Gf&&Ad.zRg?ye():hf();return null},()=>{hf();return null})):ye()}}Object(k.a)(bk,"RichApiRequest",null,[]);class Ql extends rg{constructor(J,X,Ia){super();this.Mnc=J;this.jnc=X;this.sa=Ia}go(){this.jo={};this.pq()}pq(){const J=this.parameters.ArrayData;if(J){var X=null,Ia=this.Rfe();Ia&&Ia.taskpane&&(X=Ia.taskpane.ownerAddinSolutionId);try{(new bk(this.Mnc,this.jnc)).Bjj(J,X,this.controlId,this.Kd,
Object(E.a)(this,this.Cjj,"executeRichApiRequestCallback"),this.sa)}catch(fb){Gd.a.J(509112536,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+fb.toString()),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.cJ()}}else this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.cJ()}Cjj(J,X){this.errorCode=X;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.jo.Data=J);this.cJ()}get description(){return"Run ExecuteRichApi Invocation Completed."}}
Object(k.a)(Ql,"ExecuteRichApiRequestMethod",rg,[]);class lk extends rg{constructor(){super()}go(){this.jo={};this.pq()}pq(){const J=this.jGb.nek();n.ULS.sendTraceTag(587747344,802,50,"GetAccessToken was called!");const X=(Ia,fb)=>{Ia===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(fb=fb.accessToken,this.jo[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=fb):(fb=this.Kd.jY.SU(this.controlId),n.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Ia.toString(),["appId"]:fb.An.id,
["storeType"]:fb.An.storeType}));this.xh=Ia;this.cJ()};this.w5j.execute(Ia=>{const fb=this.Kd.xj,Ab=Hd.getInstance();wa.AppsForOfficeSingleSignOnManager.getInstance(fb,Ia,Ab).getAccessToken(this.controlId,J,this.parameters,X)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(k.a)(lk,"GetAccessTokenMethod",rg,[]);class qm extends rg{constructor(){super()}pq(){let J=null;this.Lu&&(J=Microsoft.Office.WebExtension.ActiveView.Edit);J?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=
J,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}Object(k.a)(qm,"GetActiveViewMethod",rg,[]);var cm=d(1011);class Uh extends rg{constructor(){super()}go(){this.jo={};this.pq()}pq(){var J=this.Oc.xj.getOsfControl(this.controlId);if(!D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||J.isFirstParty()){J=J.getManifest();
var X=J.getMarketplaceID(),Ia=J.getWebApplicationId(),fb=J.getWebApplicationMsaId();Ob.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(X).then(Ab=>{this.errorCode=0;const ec={};ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ab.upn;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ab.userId;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ia;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=fb?fb:Ia;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
Ab.authority;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=cm.a.jgg(Ab.authorityType);ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ab.isAnonymous;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ab.tenantId;ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ab.supportsAuthToken;this.jo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=ec;this.cJ()},Ab=>{this.xh=1;this.jo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=
Ab;this.cJ()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(k.a)(Uh,"GetAuthContextMethod",rg,[]);class cg extends rg{constructor(){super()}go(){this.jo={};this.pq();this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.cJ()}pq(){var J=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const X=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];J=this.nfa.Ggg(J);!J||X*J.hTh>=J.fileSize?this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:
(Oj.z3i(this.Kd.presentationId,this.controlId,J.kde,X,J.hTh,Object(E.a)(this,this.v7b,"customizedOnFinished"),Object(E.a)(this,this.u7b,"customizedOnError")).start(),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}v7b(J,X){J?0===X.errorCode?(J=X.value,this.jo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=J,this.jo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=J.length,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}u7b(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}get description(){return"Returns the specified slice."}}Object(k.a)(cg,"GetDocumentCopyChunkMethod",rg,[]);class Pj extends rg{constructor(){super();this.iha=this.goa=0}go(){this.jo={};this.pq();this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.cJ()}pq(){try{const J=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];
this.iha=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.iha||4194304<this.iha)Gd.a.J(17310339,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.iha),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(J){case 1:this.goa=4;break;case 2:this.goa=3;break;default:Gd.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+J);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.nfa.lBg(this.controlId,
this.goa)?this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.nfa.UFa.count>=this.Kd.i0d.td.pptEditorAppForOfficeMaxDocumentReaders?this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.JJl.b$(!1,!0,()=>{this.UJl()},Object(E.a)(this,this.hAa,"saveFailureCallback")),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(J){Gd.a.J(17310343,802,10,"Exception thrown at GetDocumentCopyMethod: "+J.toString()),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}UJl(){Oj.A3i(this.Kd.presentationId,
this.controlId,this.goa,this.iha,Object(E.a)(this,this.v7b,"customizedOnFinished"),Object(E.a)(this,this.u7b,"customizedOnError")).start()}hAa(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ();return!1}v7b(J,X){if(J&&J.length){J=X.format;var Ia=X.sliceSize,fb=X.errorCode;0===fb?(X=X.fileSize,this.jo[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=X,X=this.nfa.lOi(this.controlId,X,Ia,J),this.jo[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=X,this.xh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=174===fb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===fb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}u7b(J,X){this.xh=X?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}get description(){return"Returns the entire document file in slices."}}
Object(k.a)(Pj,"GetDocumentCopyMethod",rg,[]);class Rl extends rg{constructor(){super()}pq(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const J=this.Buj(),X=this.Lu.Zzj(J);X&&(this.jo[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=X,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(J){Gd.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+J)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(k.a)(Rl,
"GetDocumentThemeMethod",rg,[]);class Uk extends rg{constructor(){super()}pq(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let J=null;if(this.Lu&&void 0!==(J=this.Lu.XAb())&&null!==(J=this.Lu.XAb())){var X={};X[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=J;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=X;this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}Object(k.a)(Uk,
"GetFilePropertiesMethod",rg,[]);class Sl{constructor(){this.context=null;this.errorCode=0}}Object(k.a)(Sl,"NestedAppAuthContextResult",null,[]);class Ti{static jGj(J,X){const Ia=new Sl;(J=J.getOsfControl(X))&&J.isFirstParty()?(Ia.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,J={},X=D.AFrameworkApplication.fa.Ea("AADUserObjectId"),J.userObjectId=X?X:D.AFrameworkApplication.fa.Ea("HostUserId"),J.userPrincipalName=D.AFrameworkApplication.fa.Ea("UserPrincipalName"),J.tenantId=D.AFrameworkApplication.fa.Ea("TenantId"),
X=(D.AFrameworkApplication.fa.Ea("HostAuthType")||"").toLowerCase(),J.authorityType="aad"===X?"aad":"msa"===X?"msa":"other",Ia.context=J):Ia.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return Ia}}Object(k.a)(Ti,"NestedAppAuthUtil",null,[]);class Jg extends rg{constructor(){super()}pq(){const J=Ti.jGj(this.Oc.xj,this.controlId);J.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.jo=J.context:this.xh=J.errorCode}get description(){return"Returns information needed by MSAL.js to authenticate."}}
Object(k.a)(Jg,"GetNestedAppAuthContextMethod",rg,[]);class Uj extends rg{constructor(){super()}pq(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(k.a)(Uj,"GetOfficeThemeMethod",rg,[]);class sl extends rg{constructor(){super()}pq(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Lu)try{var J=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();J===
Microsoft.Office.WebExtension.CoercionType.SlideRange?(J=null,this.xh=({RLl:J}=this.Lu.rLj()).returnValue,this.jo[OSF.DDA.WAC.UniqueArguments.Data]=J):J===Microsoft.Office.WebExtension.CoercionType.Text?(J=null,this.xh=({$wc:J}=this.Lu.vLj()).returnValue,this.jo[OSF.DDA.WAC.UniqueArguments.Data]=J):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(X){Gd.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+X.toString())}}get description(){return"Get data contained in the current selection of the document."}}
Object(k.a)(sl,"GetSelectedDataMethod",rg,[]);class Bm extends rg{constructor(){super()}pq(){var J=this.Rfe();if(J){const X={};X.Settings=this.bfe(J.settings);this.jo[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=X;this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else J="AppForOffice instance could not be found for ID "+this.controlId+kc.Debug.ku(),Gd.a.J(508694660,802,10,J),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}bfe(J){const X=
{};let Ia=0;for(const fb in J)X[Ia.toString()]=[fb,J[fb]],Ia++;return X}}Object(k.a)(Bm,"LoadSettingsMethod",rg,[]);class yb extends rg{constructor(){super()}pq(){n.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.jGb.cna()?(this.xh=Bc.instance.uua.XXk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[P.a.KOc],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
n.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.xh.toString())):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(k.a)(yb,"MessageParentMethod",rg,[]);class zk extends rg{constructor(){super()}pq(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Lu)try{const J=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],X=J[OSF.DDA.Marshaling.NavigationKeys.GoToType],
Ia=J[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.xh=X===OSF.DDA.Marshaling.GoToType.Index?this.Lu.YSj(Ia):X===OSF.DDA.Marshaling.GoToType.Slide?this.Lu.ZSj(Ia):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(J){Gd.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+J.toString())}}get description(){return"Go to the slide specified by user."}}Object(k.a)(zk,"NavigateToMethod",rg,[]);class ya extends rg{constructor(){super();this.jHe=0}go(){this.jo={};this.pq();
this.xh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.cJ()}pq(){this.jHe=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const J=this.nfa.Ggg(this.jHe);J?(Oj.P1f(this.Kd.presentationId,this.controlId,J.kde,!1,!1,Object(E.a)(this,this.v7b,"customizedOnFinished"),Object(E.a)(this,this.u7b,"customizedOnError")).start(),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}v7b(J,X){J?0===X.errorCode?
(this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.nfa.Kyl(this.jHe)):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}u7b(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.cJ()}get description(){return"Closes the document file."}}Object(k.a)(ya,"ReleaseDocumentCopyMethod",rg,[]);class md extends rg{constructor(){super();this.AKa=null}pq(){var J=this.Rfe();if(J){var X=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];
this.AKa=this.bfe(Array.isArray(X[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?X[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);X=null;J.taskpane&&(X=J.taskpane.ownerAddinSolutionId);var Ia;if(J.taskpane&&X)if(Ia=this.Kd.WFa(X)){this.Lu.g6e(Ia,this.AKa);if(Ia=this.Kd.jY.Qfe(X))Ia.settings=this.AKa;J.settings=this.AKa;this.Kd.aif(X,this.AKa);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.fPc.atg(X,this.AKa,this.Oc)?(J.settings=this.AKa,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(Ia=0===J.$y?this.Kd.$bg(J.shape.slideId,J.shape.id):this.Kd.WFa(J.An.id))?(this.Lu.g6e(Ia,this.AKa),J.settings=this.AKa,this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else J="AppForOffice instance could not be found for ID "+this.controlId+kc.Debug.ku(),Gd.a.J(9052994,802,10,J),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}bfe(J){const X=
{};if(J)for(let Ia=0;Ia<J.length;Ia++){const fb=Array.isArray(J[Ia])?J[Ia]:null;fb&&1<fb.length&&(X[fb[0]]=fb[1])}return X}}Object(k.a)(md,"SaveSettingsMethod",rg,[]);class tl extends rg{constructor(){super()}pq(){this.jGb.cna()?(Bc.instance.uua.IMl(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[P.a.KOc],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(k.a)(tl,"SendMessageMethod",rg,[]);class Jh extends rg{constructor(){super()}pq(){this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Lu)try{const X=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var J=X.CoerceType.toString();const Ia=X[OSF.DDA.WAC.UniqueArguments.Data];if(J===Microsoft.Office.WebExtension.CoercionType.Text)this.xh=this.Lu.pTl(Ia);else{let fb;if(J===Microsoft.Office.WebExtension.CoercionType.Image)fb=0;else if(J===Microsoft.Office.WebExtension.CoercionType.XmlSvg)fb=
1;else{this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}J=!1;let Ab=0,ec=0,Uc=0,Ad=0;({F1j:J,x:Ab,y:ec,width:Uc,height:Ad}=this.tkj(X,J,Ab,ec,Uc,Ad));this.xh=this.Lu.sNh(Ia,J,Ab,ec,Uc,Ad,fb,this.parameters[P.a.KOc])}}catch(X){Gd.a.J(509112542,802,10,"Exception thrown at SetSelectedDataMethod: "+X)}}tkj(J,X,Ia,fb,Ab,ec){const Uc=J[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],Ad=J[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==Uc&&null!==Uc&&"number"===typeof Uc&&void 0!==
Ad&&null!==Ad&&"number"===typeof Ad&&(X=!0,Ia=Uc,fb=Ad);J[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Ab=J[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);J[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(ec=J[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{F1j:X,x:Ia,y:fb,width:Ab,height:ec}}get description(){return"Writes data to the current selection in the document."}}Object(k.a)(Jh,"SetSelectedDataMethod",rg,[]);class pn extends rg{constructor(){super()}pq(){D.AFrameworkApplication.Pa.nb(this.parameters[0],
2);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Executes an action with the ActionManager."}}Object(k.a)(pn,"ExecuteFeature",rg,[]);class jj extends rg{constructor(){super()}pq(){const J=D.AFrameworkApplication.Pa.nb(this.parameters[0],1);this.xh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.jo[0]=32==J;this.jo[1]=!0}get description(){return"Query an action with the ActionManager to check if it is enabled."}}Object(k.a)(jj,"QueryFeature",rg,[]);class kh extends of{constructor(J){super(J)}mhl(){this.cmc=
{};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>new Bm);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new md);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new qm);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new zk);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new sl);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new Uk);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Rl);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,
()=>new Uj);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,()=>new Jh);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Pj);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new cg);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new ya);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new Li);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new yb);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,
()=>new tl);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>new lk);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Uh);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new Vf);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new Ql(this.Oc.YHl,this.Oc.xkl,this.Oc.$O));this.set(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new Jg);this.set(OSF.DDA.MethodDispId.dispidExecuteFeature,()=>new pn);this.set(OSF.DDA.MethodDispId.dispidQueryFeature,
()=>new jj)}}Object(k.a)(kh,"EditorMethodFactory",of,[]);class ah extends Sys.EventArgs{constructor(J){super();this.YGc=J}get zj(){return this.YGc}}Object(k.a)(ah,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class Vj{constructor(){this.WZa={};this.yIe={};this.zid={};this.ned={}}tJf(J,X){X&&J&&(this.WZa[J]=X,this.ned[J]=!1)}zti(J,X){J&&X&&(this.zid[J]=X)}Gyl(J){if(J){var X=this.WZa[J];X&&(delete this.zid[X.An.id],delete this.WZa[J],delete this.yIe[J],delete this.ned[J])}}SU(J){return J?this.WZa[J]:
null}zDj(J){return J?this.ned[J]:!1}sNj(J){return J?this.yIe[J]:null}H2h(J,X){J&&(this.ned[J]=X)}wkm(J,X){J&&(this.yIe[J]=X)}Qfe(J){if(!J)return null;const X=this.WZa;for(const Ia in X){const fb=X[Ia];if(fb&&fb.An.id.toLowerCase()===J.toLowerCase())return fb}return null}wuj(J,X,Ia){if(!J||!X||!Ia)return null;const fb=this.WZa;for(const Ab in fb){const ec=fb[Ab];if(ec&&ec.taskpane&&ec.taskpane.ownerAddinSolutionId&&ec.taskpane.ownerAddinSolutionId.toLowerCase()===J.toLowerCase()){const Uc=Ia.getOsfControl(ec.zj);
if(Uc&&Uc.getSharedRuntimeId()===X)return ec}}return null}Mee(J){Nd.a.forEach(this.WZa,(X,Ia)=>{X=Object(Ca.a)(1345,Ia);1===X.$y&&J(X)},null)}Tmj(J){const X=this.WZa;for(const Ia in X){const fb=Object(Ca.a)(1345,X[Ia]);if(fb&&J(fb))return fb}return null}Lde(J){return J in this.zid?this.zid[J]:null}}Object(k.a)(Vj,"OsfAppInstacneCache",null,[]);class dm{constructor(){}}Object(k.a)(dm,"AppForOfficeSDXDialog",null,[1362]);class hg{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad,Ce,ye,hf,Gf,Kg,Lg,se,xi,gi,jf,th,Fn,
Jj,yi,dk,lo,sn){this.q6b=!1;this.Yfb=this.Lga=this.IBe=this.gJf=null;this.ua=new A.a;this.SVg=!1;this.MFk=3E3;this.NFk=6E4;this.Cad=!1;this.Ep=J;this.GP=X;this.yLe=new kh(this);this.Gad=new Gk(this,Fn);this.DZa=Jj;this.kZa=fb;this.oNg={};this.xF=new Vj;this.aGk=Ia;this.xGb=Ab.value;this.aB=Uc;this.Ub=ec;this.K6=Ad;this.Db=Ce;this.QFk=gi;this.Nwa=ye;this.Lb=hf;this.Qi=Gf;this.sa=Kg;this.Ga=Lg;this.nc=se;this.Wb=xi;this.Whc=th;this.Zfb=new rd;this.LFk=jf;this.Ql=yi;this.Mnc=dk;this.jnc=lo;this.KNk=
sn}initialize(){this.X7(this.Db.mode);this.Db.QH(Object(E.a)(this,this.Nsg,"handleModeSwitch"))}dispose(){this.Db.a_(Object(E.a)(this,this.Nsg,"handleModeSwitch"))}get fPc(){this.Zfb||(this.Zfb=new rd);return this.Zfb}get xj(){if(!hg.Lwa){this.Ep&&(this.Ep.td.mek&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new zf),this.Lb.getBooleanAppSetting("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new zf,new vi(this.Ep.td.Mg?D.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:
D.AFrameworkApplication.fa.appSettings.WebServiceBase),this.Lb.getBooleanAppSetting("306")),OfficeExt.MosRequestHandler.init(new zf),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new zf));const J=new Pe(this.yLe,this.Gad);this.Yfb=this.CG.M1i(this.xF);hg.Lwa=this.aGk.w2i(this.GP,J,this.Yfb);hg.Lwa.setOAuthManager(this.KNk);hg.Lwa&&"undefined"!==typeof hg.Lwa.hostCheckReadyHandler&&D.AFrameworkApplication.dyi(Object(E.a)(hg.Lwa,hg.Lwa.hostCheckReadyHandler,
"hostCheckReadyHandler"))}return hg.Lwa}jhf(J){(J=this.xj.getOsfControl(J))&&this.Yfb&&this.Yfb.Ylh(J)}jMb(J,X){this.Yfb.jMb(J,X)}AFb(J,X,Ia){this.Yfb?this.Yfb.kvk(J,X,Ia):n.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}uob(J,X,Ia=null){const fb=this.CG.Q4(J);if(this.Lb.getBooleanAppSetting("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.cyb(fb.storeType)))this.Ql.Tfa(22)||this.Ql.vFa(22);else if(0===fb.$y)this.kZa.jek(fb.id)?(Ia=this.kZa.Bta[fb.id],Hc.a("Microsoft.Office.SharedOnline.FixBug6808089")?
this.kZa.sNa(fb.id,this.S9e(J),X):(Ia.s7e(X),this.kZa.sNa(fb.id,this.S9e(J),null))):(J=this.vAd(J,X),J.s7e(X),this.kZa.KJl(fb.id,J));else if(1===fb.$y){const Ab=fb.node.ra(Sd.a.w0,null);this.fwa(fb.id)?fb.Ezg||this.znb(Ab,!0):this.vAd(J,X,Ia);this.Ep.td.Zva&&!fb.ownerAddinSolutionId&&(X=this.tle(fb.pqa),this.aif(fb.pqa,X.settings))}}launchInsertDialog(){this.ua.raiseEvent("OnInsertionDialogOpened");this.Lga=new sk;this.Lga.Vj("",null,null);this.xj.launchInsertDialog(this.Lga.Pla)}jvk(J,X,Ia){J=this.Evb.CAb(J,
X);this.Ep.bI().Ia(Qb.a.oqe,2,{version:J.version,storeType:J.storeType,storeId:J.storeId,assetId:J.assetId,assetStoreId:J.assetStoreId,targetType:J.targetType,displayName:J.displayName,solutionId:J.solutionId,width:J.width,height:J.height});this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(Ia={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId),["UILocation"]:Ia},J=new da.a,J.name="Office.Extensibility.Host.InstallMRUAddinFromFlyout",
J.dataFields=Q.a.YH(Ia),G.a.sendTelemetryEvent(J))}j$c(J,X){const Ia=this.xj.getAppUILocale()||"en-US";this.YLg=new Nj(J,"wac_powerpoint",Ia,fb=>{this.Ep.bI().Ia(Qb.a.oqe,2,fb);this.YLg.hide();if(this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)){fb={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(fb.solutionId,fb.storeType,fb.assetId,null,null,fb.storeId),["UILocation"]:X};const Ab=new da.a;Ab.name="Office.Extensibility.Host.InstallPopularAddinFromFlyout";
Ab.dataFields=Q.a.YH(fb);G.a.sendTelemetryEvent(Ab)}});this.YLg.Vj("",null,null);return!0}Evk(J){this.ua.raiseEvent("OnInsertionDialogOpened");this.Lga=new sk;this.Lga.Vj("",null,null);if(J){const X={navigationMode:0};X.assetId=J;this.xj.launchInsertDialog(this.Lga.Pla,"{98143890-AC66-440E-A448-ED8771A02D52}",X)}else this.xj.launchInsertDialog(this.Lga.Pla)}rIg(J){this.ua.raiseEvent("OnInsertionDialogOpened");this.Lga=new sk;this.Lga.Vj("",null,null);this.xj.launchInsertDialog(this.Lga.Pla,J,{navigationMode:0,
assetId:null,category:null})}hvg(){this.Lga&&this.Lga.hide()}Imb(J){const X=this.Acg(J);X?this.JEh(X):n.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",J))}JEh(J){const X=this.CG.Q4(J);if(this.Lb.getBooleanAppSetting("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.cyb(X.storeType)))this.Ql.Tfa(22)||this.Ql.vFa(22);else{var Ia=(fb,Ab)=>{const ec=this.CG.Q4(fb),Uc=this.CG.pTc(D.AFrameworkApplication.isRtl,ec.id,ec.width,ec.visibility);Ab.s0(Uc);
let Ad=Ab=null;this.Ep.td.Zva&&this.Ep.td.Rrk&&(Ad=this.yud(J),Ab=()=>{this.FO(Uc,!0,!1);this.RTb(Ad)});this.uob(fb,Uc.ePc,Ab);Ad&&(fb=this.TO(Ad.An.id).fea,Uc.zUl(fb));Uc.zq(ec.visibility)};if(this.Ep.td.Zva){const fb=this.CG.Q4(J),Ab={};Ab.solutionId=fb.pqa;Ab.version=fb.version;Ab.storeType=this.cyb(fb.storeType);Ab.storeId=fb.store;Ab.targetData=J;this.xj.isAddinCommandsAsync(Ab,(ec,Uc)=>{const Ad=this.yud(J);var Ce=J.ra(Xe.a.isForUILessAction,!1);const ye=J.ra(Xe.a.sharedRuntimeId,null),hf=fb.ownerAddinSolutionId,
Gf=!!Ad.lx&&0<Ad.lx.state&&!!Ad.lx.gAa;if(!Uc&&fb.visibility||Uc&&hf&&!Gf||Ce&&!oa.a.Ta(ye))Ia(J,this.aB),this.jY.H2h(fb.id,Uc);else if(Uc){if(Ce=this.N9b(fb.pqa))Ad.settings=Ce.settings,this.Lu.g6e(J,Ad.settings);this.jY.tJf(Ad.zj,Ad);this.jY.H2h(Ad.zj,Uc);this.aif(Ad.An.id,Ad.settings);if(fb.visibility&&this.Nwa.installVisibleAddinCommandsEnabled||Gf){if("omex"!==Ab.storeType.toLowerCase()&&!Gf)return;let Kg=!1;this.B_e(Lg=>{if(!Lg[P.a.BBi]){if(Lg[P.a.yMf])for(const se of Lg[P.a.yMf])if(Kg=jd.e(se[1])===
jd.e(fb.pqa))break;Kg||this.qNc(Ad)}})}}ec||Gd.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",fb.pqa,this.cyb(fb.storeType))})}else Ia(J,this.aB)}}Obb(J){return J&&J.assetId?J.sourceLocationOverrideResourceId?String.format("{0}.{1}",J.assetId,J.sourceLocationOverrideResourceId):J.assetId:null}ADl(J){J.Sxb=-1;const X=this.SRf(J);this.X_a=new kk(J.lVc,J.pVc,J.t$d);void 0!=J.dialogLeft&&void 0!=J.Q7b&&void 0!=J.dialogTop&&void 0!=J.N7b&&this.X_a.BPl(J.dialogLeft,J.Q7b,J.dialogTop,
J.N7b);void 0!=J.dialogHeight&&void 0!=J.dialogWidth&&this.X_a.CPl(J.dialogHeight,J.dialogWidth);this.X_a.O7b=J.O7b;this.X_a.zj=J.zj;this.X_a.Vj(J.Qla,null,null);this.vAd(X,this.X_a.Pla,null,J)}lDl(J){J.Sxb=1;const X=this.SRf(J),Ia=this.CG.Q4(X);if(D.AFrameworkApplication.H8c(Ia.pqa)){const fb=this.CG.pTc(D.AFrameworkApplication.isRtl,Ia.id,Ia.width,Ia.visibility,J);this.aB.s0(fb);fb.zq(Ia.visibility);this.vAd(X,fb.ePc,null,J)}else n.ULS.sendTraceTag(508425997,802,10,`AppForOfficeManager::renderFirstPartyTaskPane first party SDX addin ${Ia.pqa} is not allowed`)}B_e(J){const X=
{};X.callback=J;D.AFrameworkApplication.Pa.Ia(Qb.a.Y1a,2,X)}qNc(J){const X=this.CG.pTc(D.AFrameworkApplication.isRtl,J.zj,J.taskpane.width,J.taskpane.visibility);this.aB.s0(X);X.zq(J.taskpane.visibility);const Ia=X.ePc;Object(Ca.a)(1344,this.CG.u7d(this.Ep.td,J,Ia,D.AFrameworkApplication.isRtl,this)).qNc(this.xj,Ia,()=>{this.RTb(J);this.FO(X,!1,!!J.lx&&!!J.lx.gAa);y.a.instance.setItem(P.a.s_d,"true")})}FO(J,X,Ia){J.zq(!1);Ia||(hg.Lwa.purgeOsfControl(J.id,!1),X?this.Ep.bI().Ia(Jc.a.T3c,2,J.id):this.Gad.dXf(J.id),
J.dispose())}RTb(J){var X={};X.solutionId=J.An.id;X.version=J.An.version;X.storeType=J.An.storeType;X.storeId=J.An.store;X.assetId=null;X.assetStoreId=null;X.sharedRuntimeId=J.lx?J.lx.gAa:null;X.backgroundState=J.lx?J.lx.state:-1;J=new e.a;J.add(X);X={};X[P.a.FOc]=J;X[P.a.Qka]=3;this.Ep.bI().Ia(Qb.a.h$c,2,X)}HZc(){const J=this.K6.Of;var X=null;J&&(X=new Yh.GraphIterator,X.set(J),X=X.Gb(18));return X}TO(J){return J?(J=this.xF.Qfe(J))&&J.taskpane?J:null:null}coj(J,X,Ia,fb){if(!J||!X||!Ia)return null;
J=this.getSharedRuntimeId(X,fb,J.solutionId,Ia);return(Ia=this.xF.wuj(Ia,J,this.xj))&&Ia.taskpane?Ia:null}pYc(J){return J?(J=this.xF.SU(J))&&J.taskpane?J:null:null}WFa(J){if(!J)return null;var X=this.HZc();if(X&&(X=this.Ub.Pc(X))&&X.Gb(19)){do{const Ia=X.currentNode;if(this.M3b(Ia.ra(Ee.a.Rvb,null),J))return Ia}while(X.sk(19))}return null}Acg(J){if(!J)return null;var X=this.HZc();if(X&&(X=this.Ub.Pc(X))&&X.Gb(19)){do{const Ia=X.currentNode;if(this.M3b(Ia.ra(Sd.a.w0,null),J))return Ia}while(X.sk(19))
}return null}$bg(J,X){return(J=this.Wb.Qk(J))?J.ER(X):null}Edk(J){return J?this.xF.zDj(J):!1}QJi(J,X,Ia,fb,Ab){if(!J||!J)return null;if(!(J.solutionId&&J.version&&J.storeId&&J.storeType))return n.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;const ec=Object(Ca.a)(Oa.a,this.xGb.createInstance(1074135137));ec.setValue(Ee.a.Rvb,J.solutionId);ec.setValue(Ee.a.nPc,J.version);ec.setValue(Ee.a.mPc,J.storeId);ec.setValue(Sd.a.u3b,this.YSc(J.storeType));J.assetId&&J.assetStoreId&&(ec.setValue(Sd.a.s3b,
J.assetId),ec.setValue(Sd.a.cPc,J.assetStoreId));ec.setValue(Ee.a.iPc,!1);ec.setValue(Sd.a.w0,Ph.a.create().toString());ec.setValue(Ee.a.d0d,"right");ec.setValue(Ee.a.x3b,Ia);Ab&&ec.setValue(Xe.a.isForUILessAction,Ab);fb&&(ec.setValue(Sd.a.esh,fb),(J=this.getSharedRuntimeId(X,Ab,J.solutionId,fb))&&ec.setValue(Xe.a.sharedRuntimeId,J));return ec}Sfe(J){J=this.WFa(J);return this.yud(J)}PJi(J,X){var Ia,fb;if(!(J&&J&&J.solutionId&&J.version&&J.storeId&&J.storeType))return null;const Ab=null!==(Ia=J.assetId)&&
void 0!==Ia?Ia:null;Ia=null!==(fb=J.assetStoreId)&&void 0!==fb?fb:null;J=new Zd(J.solutionId,J.version,J.storeId,J.storeType,Ab,Ia);X=X?new sb(0,X):null;return new Pb(J,null,null,null,null,{},1,X)}HVc(J){wa.AppsForOfficeSingleSignOnManager.wRi(J);const X=this.xF.SU(J);X&&(hg.Lwa.purgeOsfControl(X.zj,!1),this.Gad.dXf(X.zj),this.xF.Gyl(X.zj),this.kZa.ECh(X.zj),this.DZa.Bvc(this.presentationId,J,!1,!0))}notifyAgave(J,X){this.xj.notifyAgave(J,X)}Evl(J){!this.SVg&&J.Ek&&(J=J.Ek,J.Cd(47).B4(Object(E.a)(this,
this.CNf,"appDisposeHandler")),J.Cd(10).B4(Object(E.a)(this,this.CNf,"appDisposeHandler")),this.SVg=!0)}CNf(J,X){J=X.node;X=J.ra(Sd.a.$r,!1);const Ia=1074135137===J.hf;if(X||Ia)J=this.CG.Q4(J),this.HVc(J.id)}SRf(J){var X;const Ia=Object(Ca.a)(9,this.xGb.createInstance(1074135137));Ia.setValue(Ee.a.nPc,"1.0.0.0");Ia.setValue(Ee.a.mPc,"en-US");Ia.setValue(Sd.a.w0,Ph.a.create().toString());Ia.setValue(Ee.a.x3b,!0);Ia.setValue(Sd.a.s3b,null);Ia.setValue(Sd.a.cPc,null);Ia.setValue(Ee.a.Rvb,this.Obb(J));
(null!==(X=J.vif)&&void 0!==X?X:1)?(Ia.setValue(Ee.a.v3b,"sdxcatalog"),Ia.setValue(Sd.a.u3b,this.YSc("sdxcatalog"))):(Ia.setValue(Ee.a.v3b,"firstparty"),Ia.setValue(Sd.a.u3b,this.YSc("firstparty")));Ia.setValue(Sd.a.isAddinCommands,!1);Ia.setValue(Ee.a.iPc,!1);Ia.setValue(Ee.a.d0d,"right");return Ia}yud(J,X=null){if(!J)return null;J=this.CG.Q4(J);var Ia=this.cyb(J.storeType);const fb=new Zd(J.pqa,J.version,J.store,Ia,J.assetId,J.assetStoreId);let Ab=null,ec=null,Uc;if(-1==(null===X||void 0===X?void 0:
X.Sxb))Uc=new dm;else if(0===J.$y)Ab=new ea(J.shapeId,J.slideId);else if(1===J.$y)ec=new Ka(J.N6f,J.visibility,J.width,J.row,J.ownerAddinSolutionId,J.ownerAddinStoreType,J.Ezg);else return null;let Ad={};X&&OSF.OsfControl.isFirstPartyStoreString(Ia)?Ad=OSF.OUtil.serializeSettings(X.nonPersistedSettings):J.ownerAddinSolutionId||(Ad=J.settings);Ia=J.W9a?new sb(J.qwb,J.W9a):null;return new Pb(fb,J.id,Ab,ec,Uc,Ad,Uc&&X?X.Sxb:J.$y,Ia)}uBh(J,X=null){if(this.Lb.getBooleanAppSetting("883")){var Ia=this.xj.getOsfControl(J);
if(Ia&&X){if(X.nonPersistedSettings){var fb=OSF.OUtil.serializeSettings(X.nonPersistedSettings);Ia.setSettings(fb);Ia.setHostSettings(fb)}X.BA&&(fb=Object(Ca.a)(1345,this.pYc(J)))&&(fb.fea=X.BA,this.znb(J,!0));Ia.refresh();this.jhf(J)}}}vAd(J,X,Ia=null,fb=null){const Ab=this.yud(J,fb);if(!Ab||OSF.OsfControl.isFirstPartyStoreString(Ab.An.storeType)&&!D.AFrameworkApplication.H8c(Ab.An.id))return null;var ec=this.CG.Q4(J);if(this.Lb.getBooleanAppSetting("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.cyb(ec.storeType)))return this.Ql.Tfa(22)||
this.Ql.vFa(22),null;fb&&fb.BA&&(Ab.fea=fb.BA);ec=Object(Ca.a)(1344,this.CG.u7d(this.Ep.td,Ab,X,D.AFrameworkApplication.isRtl,this));this.xF.tJf(Ab.zj,Ab);this.xF.zti(Ab.An.id,X);fb&&fb.q7&&fb.q7();this.Ep.td.Zva&&Ab.taskpane&&Ab.taskpane.ownerAddinSolutionId&&(X=this.xF.Qfe(Ab.taskpane.ownerAddinSolutionId))&&this.C1h(X.zj,Ab.zj);ec.m_l(this.xj,this.S9e(J),Ia,fb,this.Nwa.powerPointDragInsertImageIsEnabled);Ab.taskpane&&Ab.taskpane.ownerAddinSolutionId||this.Evl(J);return ec}aXh(J){if(this.Nwa.Msk){const Ia=
this.jY.SU(J);if(Ia&&0===Ia.$y&&Ia.shape){var X=this.jY.sNj(J);const fb=new Date;!X||fb.getTime()-X.getTime()>=this.Nwa.pptEditorAppForOfficeSnapshotIntervalTime?(n.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",Ia.An.id,J),(X=this.QFk.f0f(1,J))?(this.jY.wkm(J,fb),X.execute(this,this.LFk,null)):n.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Ia?Ia.An.id:"AppNotExist",J)):n.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",
Ia?Ia.An.id:"AppNotExist",J)}}}coh(J,X,Ia,fb){1===J&&this.E$k(X,Ia,fb)}E$k(J,X,Ia){let fb=null;Ia&&Ia.result&&(Ia=Ia.result,fb=Ia.substr(Ia.indexOf("base64,")+7));const Ab=this.jY.SU(J);X===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&fb&&0<fb.length&&Ab?0===Ab.$y&&Ab.shape&&Ab.An&&this.Qi.V1h(Ab.shape.slideId.toString(),Ab.shape.id,fb,()=>{n.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Ab.An.id,J,fb.length)},()=>{n.ULS.sendTraceTag(512508169,806,10,
"Update addin [{0}] {1} snapshot failed",Ab.An.id,J);return!1}):n.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Ab?Ab.An.id:"AppNotExist",J,fb?fb.length:0)}N9b(J){return J?this.oNg[J]:null}ONc(J,X){J&&X&&(this.oNg[J]=X)}get Lu(){this.IBe||(this.IBe=new bd(this.Ep.td,Ob.a.instance.resolve("Common.IAppSettingsManager"),this.GP,Ob.a.instance.ze("Box4.IOutlineEditor"),Ob.a.instance.ze("Box4.ISelectionManager"),Ob.a.instance.ze("Box4.ICharacterPropertiesEditor"),
Ob.a.instance.ze("PowerPointWebEditor.IClassFactory"),Ob.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Ep.bI(),Ob.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),Ob.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ob.a.instance.resolve("Common.ITaskManager"),Ob.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Ob.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Ob.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),
Ob.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ob.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),Ob.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Ob.a.instance.resolve("PowerPointWebEditor.IShapeReader"),Ob.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Ob.a.instance.resolve("Box4.IOutlineElementNavigator"),Ob.a.instance.resolve("Box4.IParagraphReader"),Ob.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),Ob.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));
return this.IBe}get nfa(){return this.DZa}h2a(J,X,Ia){this.Gad.Pfe(J).raiseEvent(Ia,X)}czh(J,X){this.xF.Mee(Ia=>{this.h2a(J,Ia.zj,X)})}C1h(J,X){if(J&&X){J=this.jY.SU(J);var Ia=this.jY.SU(X);J&&Ia&&(Ia.settings=J.settings,this.goh(X,J.settings))}}aif(J,X){J&&X&&this.jY.Mee(Ia=>{this.M3b(Ia.taskpane.ownerAddinSolutionId,J)&&!this.fPc.kek(Ia.settings,X)&&(Ia.settings=X,this.goh(Ia.zj,X))})}Nsg(J){this.X7(J.mode)}X7(J){if(1!==J&&2!==J)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",
J));n.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===J?"Show":"Edit");this.kZa.X7(J);this.aB.X7(J)}goh(J,X){const Ia=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.h2a(Ia,J,X)}cyb(J){switch(J){case 0:J="spcatalog";break;case 1:J="filesystem";break;case 2:J="omex";break;case 3:J="spapp";break;case 4:J="registry";break;case 5:J="inmemory";break;case 6:J="uploadfiledevcatalog";break;case 7:J="excatalog";break;
case 8:J="firstparty";break;case 9:J="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",J));}return J}YSc(J){if(!J)throw Error.create("Store Type should not be null.");hg.J7||hg.r9j();if(J in hg.J7)return hg.J7[J];throw Error.create(String.format("[{0}] is not the valid store type.",J));}tle(J){return J?this.xF.Tmj(X=>this.M3b(X.An.id,J)):null}get i0d(){return this.Ep}ezi(J){this.ua.addHandler("OnInsertionDialogOpened",J)}lOc(J){this.ua.addHandler("OnFirstPartyAddInHidden",
J)}uBl(J){this.ua.removeHandler("OnFirstPartyAddInHidden",J)}Kpl(J){this.ua.raiseEvent("OnFirstPartyAddInHidden",new ah(J))}l5d(J){const X=bi.a.MBa(this.aB.C4,Ia=>Ia.id===J);if(1!==X.length)return!1;this.FO(X[0],!0,this.fwa(J));return!0}znb(J,X){const Ia=bi.a.MBa(this.aB.C4,fb=>fb.id===J);1!==Ia.length?Gd.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Ia.length):Ia[0].zq(X)}Htj(J){const X=bi.a.MBa(this.aB.C4,Ia=>Ia.id===J);return 1!==X.length?(Gd.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",
X.length),!1):X[0].isVisible}Gem(J,X){const Ia=this.N9b(J);Ia&&Ia.lx&&Ia.lx.gAa&&(Ia.lx.state=X?1:0,(this.WFa(J)||this.fPc.atg(J,Ia.settings,this))&&this.Ep.bI().Ia(Jc.a.F1h,2,Ia))}Itj(J){return(J=this.N9b(J))&&J.lx?1===J.lx.state:!1}OXf(J){this.jY.Mee(X=>{this.M3b(X.taskpane.ownerAddinSolutionId,J)&&this.l5d(X.zj)})}GAb(J){return this.xF.SU(J)}fwa(J){if(!J||4===this.xj.getOsfControlStatus(J))return!1;J=this.xj.getOsfControl(J);return!!J&&!!J.getSharedRuntimeId()}setInitialDisplayMode(J,X){(J=this.xj.getOsfControl(J))&&
J.setInitialDisplayMode(X)}getSharedRuntimeId(J,X,Ia,fb){if(!J)return null;const Ab=new gf;if(!Ab)return null;if(X)return J.getSharedRuntimeId(Ab.$U,X,null);Ia=(new uc("",fb,Ab,!0)).j3f(Ia.substr(fb.length));return J.getSharedRuntimeId(Ab.$U,X,Ia)}zoj(J,X){const Ia={};Ia.visibility=X?"Visible":"Hidden";X=JSON.stringify(Ia);this.Pcg(J,65539,"",X)}Boj(J,X,Ia){this.Pcg(J,1,X,Ia)}Z1l(J,X){J=new Zd(J.solutionId,J.version,J.storeId,J.storeType,null,null);var Ia=new Ka("right",!0,350,0,null,null,!1);J=new Pb(J,
Og.a.create().toString(),null,Ia,null,{},1,null);const fb=this.CG.pTc(D.AFrameworkApplication.isRtl,J.zj,J.taskpane.width,J.taskpane.visibility);this.aB.s0(fb);fb.zq(J.taskpane.visibility);Ia=fb.ePc;Object(Ca.a)(1344,this.CG.u7d(this.Ep.td,J,Ia,D.AFrameworkApplication.isRtl,this)).qNc(this.xj,Ia,()=>{this.FO(fb,!1,!1);X()})}Pcg(J,X,Ia,fb){var Ab=Array(6);Ab[0]=65536;Ab[1]=X;Ab[2]=Ia;Ab[3]=fb;Ab[4]=-1;Ab[5]=!1;X=Array(1);X[0]=Ab;Ab=new bb(OSF.DDA.EventDispId.dispidRichApiMessageEvent,J,null,X);this.h2a(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),
J,Ab)}M3b(J,X){return J&&X?J.toLowerCase()===X.toLowerCase():!1}S9e(J){return!this.Db||1!==this.Db.mode||J&&"FA000000012"===J.ra(Sd.a.s3b,null)?1===this.CG.Q4(J).$y?!0:this.Ga.dIa(J)?this.sa.Aa===this.nc.ug(J):!1:!1}get presentationId(){return this.Ep.gWa().presentationId}get UZf(){return this.kZa}get jY(){return this.xF}get CG(){return this.Whc.value}get YHl(){return this.Mnc}get xkl(){return this.jnc}get $O(){return this.sa}static r9j(){hg.J7={};hg.J7.inmemory=5;hg.J7.uploadfiledevcatalog=6;hg.J7.spcatalog=
0;hg.J7.omex=2;hg.J7.registry=4;hg.J7.spapp=3;hg.J7.filesystem=1;hg.J7.excatalog=7;hg.J7.firstparty=8;hg.J7.sdxcatalog=9}get Evb(){return this.e3b}get e3b(){this.QOc&&!this.WLg&&(this.VJ?window.setTimeout(()=>{this.Cad||n.ULS.sendTraceTag(508598484,220,15,"When AddinDetailsManager.queryAddinDetails has not been called yet, a timed-out error occurs.")},this.NFk):this.txl&&this.aij(this.MFk),this.WLg=ge.createInstance(this.Lb,new Ki.a(()=>this.xj),{["AppsForOfficeAllowExternalMarketplace"]:this.Nwa.Zte,
["AppsForOfficeThirdPartyIsDisabled"]:this.Nwa.ufc,["AreThirdPartyAddInsAllowed"]:this.Nwa.Wka,["PopularAddinDetailsJsonString"]:hg.D1a}));return this.WLg}get QOc(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get txl(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}get VJ(){return this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}aij(J){window.setTimeout(()=>{this.xjj()},J)}xjj(){this.Cad?n.ULS.sendTraceTag(508826763,220,50,"The 1st attempt succeeded."):(n.ULS.sendTraceTag(508826764,220,15,"the 1st attempt was timeout, trigger another try."),this.QN(0,!0))}static ifb(J){return 0===J||10===J}svc(J,X){this.e3b&&this.e3b.svc(J,X)}QN(J,X){this.e3b&&(!this.Cad&&hg.ifb(J)&&(this.Cad=!0),this.e3b.QN(J,X))}static get D1a(){return'[{"displayName":"Pro Word Cloud","solutionId":"wa104038830","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Create beautiful word cloud images from your text","iconUrl":"65503.58165d84-0d6e-4545-a991-40ffee49b75a.9fa95f4f-0649-45b6-8ea9-b3b9e7611d90.2a84fadc-6e9a-4a27-a8c3-4c7a71e76546.jpeg","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://prowritingaid.com/art/245/Privacy-Policy.aspx","addinInfo":{"priority":-1,"AUP":1}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":-1,"AUP":1}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","targetType":1,"width":0,"height":0,"description":"Unlimited access to licensed photos, clipart and your company\'s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":1,"AUP":1885}},{"displayName":"Poll Everywhere Presenter","solutionId":"wa104218073","version":"3.0.0.1","targetType":0,"width":960,"height":540,"description":"Gather audience responses via SMS or web, and display them instantly in gorgeous PowerPoint charts.","iconUrl":"27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","licenseUrl":"https://www.polleverywhere.com/terms","privacyUrl":"https://www.polleverywhere.com/privacy-policy","addinInfo":{"priority":2,"AUP":1495}},{"displayName":"Web Video Player","solutionId":"wa104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":947}},{"displayName":"Web Viewer","solutionId":"wa104295828","version":"1.9.0.0","targetType":0,"width":960,"height":540,"description":"Take it to the web! Insert a secure webpage into your presentation.","iconUrl":"53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949675993/Asset_901070fc-4837-4edc-83b0-b3438f2ddf97/OfficeMixEULA.docx","privacyUrl":"https://aka.ms/mixaddinprivacy","addinInfo":{"priority":2,"AUP":2439}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"wa104379261","version":"3.0.2.4","targetType":0,"width":1000,"height":700,"description":"Engage your audience with fun and interactive presentations, visualizing their opinions in real-time","iconUrl":"51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","licenseUrl":"https://www.mentimeter.com/terms","privacyUrl":"https://www.mentimeter.com/privacy","addinInfo":{"priority":3,"AUP":3793}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":350}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":412}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":795}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":591}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","targetType":1,"width":0,"height":0,"description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":110}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":685}},{"displayName":"officeatwork | Content Chooser for Office","solutionId":"wa104380602","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared content in Word, Excel, PowerPoint, Outlook, Browser, and other Apps.","iconUrl":"21517.8509aff9-edc8-4f6a-8b59-4b406996c84a.d1a19980-7c71-4be1-8215-82ff5834af8f.fa526dd8-ee50-4045-add0-21357070c87b.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":379}},{"displayName":"PP Timer","solutionId":"wa104380667","version":"3.0.0.1","targetType":0,"width":640,"height":480,"description":"Insert a timer into your PowerPoint presentation. Add an analog or digital timer into your slide.","iconUrl":"34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pp-timer.com/privacy-policy","addinInfo":{"priority":1,"AUP":8}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":305}},{"displayName":"Pixton Comic Characters","solutionId":"wa104380907","version":"3.1.0.0","targetType":1,"width":0,"height":0,"description":"Add illustrated, posable comic characters to your training or educational presentations.","iconUrl":"29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","licenseUrl":"https://www.pixton.com/terms-of-use/addons","privacyUrl":"https://www.pixton.com/privacy-policy/addons","addinInfo":{"priority":1,"AUP":1485}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":211}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":1,"AUP":318}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":3852}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","targetType":1,"width":0,"height":0,"description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":645}},{"displayName":"Ubi Timer","solutionId":"wa104381448","version":"1.0.0.8","targetType":0,"width":348,"height":720,"description":"Add a customisable timer to your PowerPoint presentation slides.","iconUrl":"8460.b2044bd4-1b25-41e3-9810-3564d9472171.804e0d26-99a8-4b72-a103-49327a1a30b8.f01fef0d-5053-4e80-b246-34524e7c5f69.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ubicompsolutions.co.uk/timer_privacy","addinInfo":{"priority":3,"AUP":84}},{"displayName":"Forms","solutionId":"wa104381526","version":"1.0.0.2","targetType":0,"width":800,"height":450,"description":"Embed surveys, quizzes, and polls directly into a PowerPoint slide.","iconUrl":"3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?linkid=871815","addinInfo":{"priority":3,"AUP":6617}},{"displayName":"Wooclap","solutionId":"wa104381682","version":"1.0.0.5","targetType":0,"width":900,"height":500,"description":"With its many features and intuitive use, Wooclap turns events into interactive and dynamic learning","iconUrl":"13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","licenseUrl":"https://www.wooclap.com/en/terms-of-service","privacyUrl":"https://www.wooclap.com/en/privacy-policy","addinInfo":{"priority":2,"AUP":935}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","targetType":1,"width":0,"height":0,"description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":1,"AUP":1672}},{"displayName":"EasyTimer","solutionId":"wa104382064","version":"1.0.0.2","targetType":0,"width":1000,"height":600,"description":"An easy-to-use timer for your PowerPoint presentations.","iconUrl":"17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://lixiaoooowei.github.io/TimerLab/Home/PrivacyPolicy.html","addinInfo":{"priority":2,"AUP":1364}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Add formative assessments and interactive activities to lessons and presentations","iconUrl":"59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.peardeck.com/privacy-policy","addinInfo":{"priority":3,"AUP":9847}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":783}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","targetType":1,"width":0,"height":0,"description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":681}},{"displayName":"Present Pal add-in - Presentation Support","solutionId":"wa200001313","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Control your slideshow directly from the Present Pal app to make presenting easy and accessible!","iconUrl":"26522.34e9b858-f1e6-4aa8-b47f-dfb0c9224869.2f9ca7d4-7141-4377-bde9-adcb55b44237.6092b85f-1084-427b-a1ec-55b33b8ee41f.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://presentpal.co.uk/privacy-policy","addinInfo":{"priority":3,"AUP":96}},{"displayName":"Premast Plus","solutionId":"wa200001396","version":"4.1.3.0","targetType":1,"width":0,"height":0,"description":"Use Premast plus features and professional templates to design better presentation, faster. Without ","iconUrl":"62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","licenseUrl":"https://premast.com/plus-terms-of-use","privacyUrl":"https://premast.com/privacy-policy","addinInfo":{"priority":1,"AUP":103}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"wa200001409","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Guided storytelling using pre-built Templates, Industry Domain Slides, Design Slides and Icons","iconUrl":"10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","licenseUrl":"https://slides365.com/Terms.html","privacyUrl":"https://slides365.com/Privacy-Policy.html","addinInfo":{"priority":2,"AUP":124}},{"displayName":"SlideHub","solutionId":"wa200001625","version":"1.0.0.7","targetType":1,"width":0,"height":0,"description":"Helps SlideHub users build better presentations faster via various tools and an on-demand service ","iconUrl":"28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","licenseUrl":"https://slidehub.io/eula","privacyUrl":"https://slidehub.io/privacy","addinInfo":{"priority":2,"AUP":1735}},{"displayName":"Breaktime","solutionId":"wa200001661","version":"2.1.0.2","targetType":0,"width":800,"height":600,"description":"A quick way to tell everyone when you\'ll be back, because it\'s Breaktime!","iconUrl":"53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","licenseUrl":"https://www.flosim.com/breaktime/EULA.html","privacyUrl":"https://www.flosim.com/breaktime/Privacy_Policy.html","addinInfo":{"priority":1,"AUP":3240}},{"displayName":"Canto Connector","solutionId":"wa200001766","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Simplify how you add images and brand elements to Word and PowerPoint from your Canto image library.","iconUrl":"7869.c66666c2-edf3-4109-955b-4b8dcefb734e.39d11081-f25d-4285-9427-84ecd59deb0a.d2b7f5df-5a3f-4755-a8a6-9c5dd4a750dc.png","licenseUrl":"https://team.canto.com/b/Q9GTF","privacyUrl":"https://www.canto.com/privacy-policy","addinInfo":{"priority":3,"AUP":32}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":2,"AUP":1456}},{"displayName":"Kahoot! for PowerPoint","solutionId":"wa200002908","version":"1.1.0.0","targetType":0,"width":800,"height":480,"description":"Host kahoots within PowerPoint and make presentations awesome! ","iconUrl":"5821.dc651664-7ea2-4fed-b845-27e926a3bf3f.29a4cdf3-8814-4a22-b5b3-c79c432e8b0f.0c3e5c0c-62fb-4d25-8518-3bf537f62cd0.png","licenseUrl":"https://trust.kahoot.com/terms-and-conditions","privacyUrl":"https://trust.kahoot.com/privacy-policy","addinInfo":{"priority":1,"AUP":563}},{"displayName":"RRSlide Library","solutionId":"wa200003157","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"We supply PowerPoint templates, infographics, charts, 3D icons, etc. to make a quick presentation","iconUrl":"27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://rrslide.com/privacy-policy","addinInfo":{"priority":2,"AUP":150}},{"displayName":"Microsoft Power BI","solutionId":"wa200003233","version":"2.0.0.3","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":43414}},{"displayName":"Microsoft Power BI Beta","solutionId":"wa200003251","version":"2.0.0.4","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.e29569b7-a73e-472a-906f-7d3d7b5b56d0.6c0dd532-76c1-4565-a1f0-e5e8d45f1138.f53a6d02-633b-4da5-a56f-f804e844a2a0.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":250}},{"displayName":"Showmaster (Helper Plugin)","solutionId":"wa200003676","version":"1.0.0.0","targetType":0,"width":957,"height":538,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.cc4515b5-7941-4c49-8152-a4da1dceef8d.f2ec1037-3774-4e94-a41a-f9e6432611d8.b9e80121-ccc1-40f9-b6f7-3430a31b50fc.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Showmaster","solutionId":"wa200003706","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.e0b83de2-8341-4aaf-a8da-e9a86c1dfdd3.e729953e-7bb6-4556-8a33-55c83e572918.0fe180b8-8511-42ae-b526-0796e91fbee1.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":75}},{"displayName":"PresenterMedia | Thousands of Animations, Templates, and Designs at your Fingertips","solutionId":"wa200003891","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Insert customized graphics, templates and videos directly into your presentation.","iconUrl":"37569.30ec0671-d417-4ae9-8009-4cee496ea074.3b3c120c-ea56-4a82-a3c1-82e4591f6140.e03fae66-8132-4071-a176-963a53dd2798.png","licenseUrl":"https://www.presentermedia.com/addin_terms_of_use","privacyUrl":"https://www.presentermedia.com/privacy_policy","addinInfo":{"priority":3,"AUP":109}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":2,"AUP":250}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":3813}},{"displayName":"beautiful.ai | AI powered slide templates","solutionId":"wa200003964","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Create beautiful presentations faster with AI powered slide templates","iconUrl":"5525.df072342-580e-437e-9d68-96615f75b68a.7429d240-ba6f-4dc1-b122-5ce6e89e8b49.50a5f98b-bd54-446f-a983-3d56cf4f16ca.png","licenseUrl":"https://www.beautiful.ai/terms-of-service","privacyUrl":"https://www.beautiful.ai/privacy-policy","addinInfo":{"priority":1,"AUP":157}},{"displayName":"Project Plan","solutionId":"wa200004643","version":"1.0.0.3","targetType":0,"width":957,"height":538,"description":"Visualize your project plans and roadmaps right in PowerPoint and Excel.","iconUrl":"48512.5fa6879a-44fb-480a-8848-5280995a049e.88d32693-93e0-4681-93a8-a59ee99f893b.c488f1bf-ea9e-4e56-9711-4a5a41a432c4.png","licenseUrl":"https://www.projectplan-powerpoint.com/terms","privacyUrl":"https://www.projectplan-powerpoint.com/privacy","addinInfo":{"priority":1,"AUP":192}},{"displayName":"Vevox for PowerPoint (BETA)","solutionId":"wa200004709","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Include Live Polls and interaction in PowerPoint presentations with the #1 rated polling platform.","iconUrl":"30836.b99a2c67-c0f9-4608-ab59-33f5dab5dffa.3c46736f-fe0e-4dad-b17e-edb4bd558f68.7ecef1a1-72c6-4083-afb1-715afe5fb27c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.vevox.com/terms-conditions#PrivacyPolicy","addinInfo":{"priority":1,"AUP":251}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":1,"AUP":14}}]'}fQl(J,
X=null){if(this.xj.getOsfControl(J)&&X){if(X.BA){const Ia=Object(Ca.a)(1345,this.pYc(J));Ia&&(Ia.fea=X.BA)}this.jhf(J)}}}hg.J7=null;hg.Lwa=null;Object(k.a)(hg,"AppForOfficeManager",null,[1346,106,471]);class vj{constructor(J,X,Ia){this.tP=J;this.yTg=X;this.Ub=Ia}register(){this.yTg.Ak(Object(E.a)(this,this.MNf,"appSettingChangedEventHandler"))}dispose(){this.yTg.tn(Object(E.a)(this,this.MNf,"appSettingChangedEventHandler"))}MNf(J,X){J=X.node;X=X.property;try{if(1074135139===J.hf&&X===Ee.a.lPc){X=
null;var Ia=this.Ub.Pc(J);Ia.uc(47)||Ia.uc(10);Ia.Dc();this.Gue(Ia.currentNode)&&(X=new ad.a(Ia.currentNode));var fb=X.settings;Hc.a("RefreshAppSettingsValue")&&(this.tP.GAb(X.id).settings=fb);this.tP.h2a(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),X.id,fb)}}catch(Ab){n.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Ab)}}Gue(J){if(!J)return!1;const X=Object(Ca.a)(4,J);return 1074135137===J.hf||!!X&&X.$r}}Object(k.a)(vj,"AppForOfficeSettingChangedEventListener",
null,[1341,106]);class en{constructor(J,X,Ia){this.tP=J;this.vMg=X;this.Ub=Ia}register(){for(const J of this.vMg)J.VE(Object(E.a)(this,this.NNf,"appSettingCreatedEventHandler"))}dispose(){for(const J of this.vMg)J.RN(Object(E.a)(this,this.NNf,"appSettingCreatedEventHandler"))}NNf(J,X){J=X.node;try{if(this.Gue(J)&&21===X.vU){this.Ub.Pc(J).Tbc()||n.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const Ia=new ad.a(J),fb=Ia.settings;this.tP.h2a(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),
Ia.id,fb)}}catch(Ia){n.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Ia)}}Gue(J){if(!J)return!1;const X=Object(Ca.a)(4,J);return 1074135137===J.hf||!!X&&X.$r}}Object(k.a)(en,"AppForOfficeSettingCreatedEventListener",null,[1341,106]);class M{constructor(J,X){this.ia=J;this.Qs=X}register(){this.Qs.Ak(Object(E.a)(this,this.mXh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Qs.tn(Object(E.a)(this,this.mXh,"taskpaneAppCreatedEventHandler"))}mXh(J,X){if(J=X.node)J=
new ad.a(J),X.property.id===Sd.a.w0.id&&1===J.$y&&(X=X.node.ra(Sd.a.w0,null))&&this.ia.Ia(Jc.a.Imb,2,X)}}Object(k.a)(M,"AppForOfficeTaskpaneAppCreatedEventListener",null,[1341,106]);var ck=d(661),wf=d(540),fn=d(919),rm=d(920);class pj{constructor(J,X,Ia,fb,Ab){this.tP=J;this.Ep=X;this.Db=Ia;this.xF=fb;this.aB=Ab}register(J){J.controlStatusChanged=Object(E.a)(this,this.Ylh,"onControlStatusChanged");J.notifyHost=Object(E.a)(this,this.hoh,"onOsfNotifyHost")}Ylh(J){let X=this.xF.Lde(J.getSolutionId()),
Ia=!1;Hc.a("FixUILessShowTaskPaneIconIssue")&&(Ia=null!=J.getSharedRuntimeId(),!X&&Ia&&(X=this.xF.Lde(J.getSolutionId()+"##UILessContainer##")));const fb=this.xF.SU(J.getID());fb&&fb.An&&J.isFirstParty()&&(X=this.xF.Lde(fb.An.id));if(X&&fb&&X.previousSibling){var Ab=J.getSolutionId(),ec=J.getVersion(),Uc=null,Ad=null;Ad=J.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(Ab,""):OSF.OsfManifestManager.getCachedManifest(Ab,ec);J.isFirstParty()&&fb.fea?Uc=fb.fea:Ad&&(Uc=Ad.getDefaultDisplayName(),
fb.fea=Uc);if(0!==fb.$y&&-1!==fb.$y){ec=null;Ad&&(ec=Ad.getDefaultIconUrl());Ad=Object.assign(new fn.a,{getContent:()=>X,type:"LegacyTaskPaneProps",isSharedRuntimePane:Ia});var Ce=Object.assign(new ck.a,{title:Uc,hideHeader:!0,iconUrl:ec,width:320,location:2,contentProps:Ad,onOpen:()=>{},onClose:()=>{},isModernPane:!0});this.Ep.td.T7c&&(null===fb||void 0===fb?0:fb.settings)&&rm.a.RBg(fb.settings)&&(Ce.hideHeader=!1,Ce.contentProps=rm.a.iBj(fb.zj,fb.settings,Ad));qb.UISurfaces.qr().then(ye=>{const hf=
J.getID();ye.updateTaskPane(hf,Ce);Hc.a("FixUILessShowTaskPaneIconIssue")&&Ia&&this.tP.znb(J.getID(),!1);return null}).catch(()=>{Gd.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",Ab)});X.previousSibling&&(X.previousSibling.innerText===Uc||!J.isFirstParty()&&""!==X.previousSibling.innerText)||!Uc||!fb.taskpane||fb.taskpane.isForUILessAction||(X.previousSibling.innerText=Uc,this.Db.mdb())}}}kvk(J,X,Ia){this.hoh(J,X,Ia)}get QOc(){return this.Ep.td.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}EFi(J,X){return Uf.a.gl().equals(J.solutionId,X.solutionId)&&Uf.a.gl().equals(J.storeType,X.storeType)}hoh(J,X,Ia){3===X?(this.tP.hvg(),this.aB.Df(Md.a.aG),Ia?(this.jMb("InsertAgave",Ia),this.Ep.bI().Ia(Jc.a.W4c,2,Ia)):n.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===X?this.jMb("ClickTrust",Ia):40===X?this.QOc&&this.AKe&&Ia&&this.EFi(this.AKe,Ia)&&Ia.storeType&&(n.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",
pj.r5(Ia)),this.AKe=void 0,this.tP.QN(Qa(Ia.storeType))):36===X?Ia?this.Ep.bI().Ia(Jc.a.W4c,2,Ia):n.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===X?Ia&&(J=Object(Ca.a)(Object,Ia),J={["ak1"]:this.tP.xj.getDevManifestInvalidUrlErrorString(J.manifestUrl)},this.Ep.bI().Ia(Qb.a.$Rb,2,J)):2===X?this.tP.hvg():9===X?this.Ep.td.Zva&&this.Ep.td.Bzg&&this.Ep.bI().Ia(Qb.a.Z1e,2,Ia):5===X||6===X?(Ia=this.xF.SU(J))?0===Ia.$y?this.aB.Dff(X):this.aB.aqj(J,
X):n.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",J)):13===X||14===X?(Ia=this.xF.SU(J))?0===Ia.$y||Ia.taskpane&&Ia.taskpane.isForUILessAction?this.tP.notifyAgave(J,13===X?11:12):(je.a.jg&&document.activeElement.blur(),13===X?Ag.FocusManager.instance().x8e(Md.a.qT):this.aB.Mdg(J)):n.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",J)):16===X?(X=this.xF.SU(J))?0===X.$y&&this.aB.T$f():n.ULS.sendTraceTag(512360736,
806,10,String.format("Failed to find the cached app with instance Id: {0}",J)):17===X||18===X?(X=this.xF.SU(J))?0===X.$y?this.aB.T$f():(je.a.jg&&document.activeElement.blur(),this.aB.Mdg(J)):n.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",J)):1===X||10===X?(X=this.xF.SU(J))?0===X.$y&&this.tP.aXh(J):n.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",J)):8===X?(J={["ak1"]:this.tP.xj.getManifestInvaildErrorString()},
this.Ep.bI().Ia(Qb.a.$Rb,2,J)):15===X?(J=this.aB.Qdm(J))&&(X=this.tP.GAb(J))&&X.taskpane&&!X.taskpane.isForUILessAction&&this.tP.notifyAgave(J,11):23===X?G.a.sendOtelEvent(Object.assign(new wf.a,{otelEvent:Ia})):38===X?G.a.sendOtelCustomerContent(Object.assign(new wf.a,{otelEvent:Ia})):32===X?(J=Object(Ca.a)(Object,Ia).solutionId,this.tP.OXf(J)):34===X&&(J=Object(Ca.a)(Object,Ia),X=J.controlId,Ia=new uc("",J.ownerAddinSolutionId,new gf,!0),J.originalControlId=Ia?Ia.j3f(X):X)}jMb(J,X){this.QOc&&X&&
(this.AKe=X)}static r5(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}}Object(k.a)(pj,"AppForOfficeAppEventHandler",null,[1377]);var ul=d(254),eg=d(1283);class ni{static yvi(J){var X=J.getAttribute("style");X=X?X.toString():"";0>X.indexOf("pointer-events: auto")&&J.className!==ni.eQb&&(Hc.a("Microsoft.Office.SharedOnline.FixBug6808089")?J.style.pointerEvents="auto":J.setAttribute("style",X+" pointer-events: auto"))}static AKf(J){var X=
J.getAttribute("style");X=X?X.toString():"";0>X.indexOf("pointer-events: none")&&J.className===ni.eQb&&(Hc.a("Microsoft.Office.SharedOnline.FixBug6808089")?J.style.pointerEvents="none":J.setAttribute("style",X+" pointer-events: none"))}static Rzl(J){var X=J.getAttribute("style");X=X?X.toString():"";0<=X.indexOf("pointer-events: none")&&J.className===ni.eQb&&(Hc.a("Microsoft.Office.SharedOnline.FixBug6808089")?J.style.pointerEvents="":(X=X.replace("pointer-events: none",""),J.setAttribute("style",
X)))}}ni.IIl="AppForOfficeContainer EditAppForOfficeContainer";ni.eQb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";ni.Q5e="";Object(k.a)(ni,"AppForOfficeViewHelper",null,[]);var wc=d(996),kj=d(139);class $c{constructor(J,X,Ia,fb,Ab){this.bB=this.VLg=null;this.lKa=!1;this.oz=X;this.ul=Ia;X&&X.taskpane&&X.taskpane.isForUILessAction?(this.bB=null,this.VLg=Ia):(this.bB=new kj.a,this.bB.ye.className=ni.eQb,this.bB.ye.id="AppForOffice_"+this.oz.zj,this.bB.ye.style.width="100%",
this.bB.ye.style.height="100%",this.bB.ye.style.position="relative",this.bB.ye.style.left="0",this.bB.ye.style.top="0",Ia.appendChild(this.bB.ye));this.Oc=Ab}dispose(){this.Hyl();this.oz=null}Hyl(){this.bB&&this.bB.mr()}s7e(J){J&&this.bB&&J!==this.ul&&(this.ul=J,J.appendChild(this.bB.ye),this.lKa&&this.Kfa())}EEa(J){J&&(J.ye.innerHTML="")}m_l(J,X,Ia=null,fb=null,Ab=!1){this.qsi(J,X,Ia,fb,Ab)}qNc(J,X,Ia){X=this.Etc(X);J.insertBlankControlWithErrorUX(X,()=>{Ia()})}qsi(J,X,Ia=null,fb=null,Ab=!1){this.lKa=
Ab;this.EEa(this.bB);this.oz&&J&&(this.sNa(X,null),X=this.Etc(this.bB?this.bB.ye:this.VLg,fb,J),X.virtualOsfControlActivationCallback=Ia,J.insertOsfControl(X),J.setActivationCompletedStatus(this.oz.zj,!0),Ab&&this.Kfa())}Kfa(){if(this.bB){var J=this.bB.va;if(J){var X=J.parentNode;X&&"OsfAddinOverlay"!==X.className&&(ul.a.instance.xb(Fg.a.uha,X,Object(E.a)(this,this.kDh,"removePointerEventsStyleHandler")),eg.a.instance.xb(Fg.a.drop,X,Object(E.a)(this,this.kDh,"removePointerEventsStyleHandler")),ul.a.instance.xb(Fg.a.vha,
X,Object(E.a)(this,this.zvi,"addPointerEventsStyleHandler")),ni.AKf(J))}}}kDh(J){J=J.hc.target;for(let X=0;X<J.childNodes.length;++X)ni.Rzl(J.childNodes[X]);return!0}zvi(J){J=J.hc.target;for(let X=0;X<J.childNodes.length;++X)ni.AKf(J.childNodes[X]);return!0}sNa(J,X){this.bB&&(J?(null!=X&&this.s7e(X),this.bB.ye.className=""===ni.Q5e?ni.IIl:ni.Q5e,ni.yvi(this.bB.va)):(this.bB.ye.className!==ni.eQb&&(ni.Q5e=this.bB.ye.className),this.bB.ye.className=ni.eQb))}t7e(J){this.bB&&(this.bB.ye.style.zIndex=
String(J))}Etc(J,X=null,Ia=null){const fb={};fb.div=J;fb.id=this.oz.zj;J=this.oz.An.id;const Ab=this.oz.taskpane?this.oz.taskpane.ownerAddinSolutionId:null;if(Ia&&Ab){const ec=this.oz.taskpane.isForUILessAction;this.oz.lx?fb.sharedRuntimeId=this.oz.lx.gAa:(Ia=Ia.getOsfControl(Ab).getManifest(),fb.sharedRuntimeId=this.Oc.getSharedRuntimeId(Ia,ec,J,Ab));fb.initialDisplayMode=ec?1:2}fb.hostInfoFlags=0;fb.sharedRuntimeId?(fb.hostInfoFlags|=1,fb.solutionId=Ab):X?(fb.solutionId=X.assetId,fb.sourceLocationOverrideResourceId=
X.sourceLocationOverrideResourceId,fb.featureGates=D.AFrameworkApplication.fa.JBj(X.assetId)):fb.solutionId=J;fb.version=this.oz.An.version;fb.storeId=this.oz.An.store;fb.storeType=this.oz.An.storeType;fb.assetId=this.oz.An.assetId;fb.assetStoreId=this.oz.An.assetStoreId;fb.settings=this.oz.settings;X&&OSF.OsfControl.isFirstPartyStoreString(this.oz.An.storeType)&&(fb.hostSettings=OSF.OUtil.serializeSettings(X.nonPersistedSettings),fb.showLoadingSpinner=X.showLoadingSpinner);fb.reason=wc.a.contains(this.oz.An.id,
this.oz.$y,this.oz.An.store,this.oz.An.storeType,this.oz.An.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.oz.$y?fb.osfControlType=0:1===this.oz.$y&&(fb.osfControlType=1);D.AFrameworkApplication.Wka||OSF.OsfControl.isFirstPartyStoreString(fb.storeType)||(n.ULS.sendTraceTag(512369924,802,50,(0===this.oz.$y?"Content":"Taskpane")+" web add-in disabled by doc IRM"),fb.hostInfoFlags|=4);this.oz.taskpane?(fb.isForUILessAction=
this.oz.taskpane.isForUILessAction,fb.ownerAddinSolutionId=Ab,fb.ownerAddinStoreType=this.oz.taskpane.ownerAddinStoreType):fb.isForUILessAction=!1;return fb}}Object(k.a)($c,"AppForOfficeView",null,[1344]);var jg=d(282),mk=d(78),Kh=d(378);class Yg{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad,Ce,ye,hf,Gf,Kg,Lg,se){new jg.a(0,0,0,0);this.Yhc=this.Zhc=this.$fb=this.sP=this.vm=null;this.CPe=ResourceStrings.l_AddinPane;this.wb=Me.a.we();this.Db=ec;this.hd=Ad;this.aB=Uc;this.te=Ce;this.fv=J;this.mA=X;this.Ep=Ia;this.RFk=
fb;this.Mb=Ab;this.Rs=ye;this.Oc=hf;this.Nc=Gf;this.rc=Kg;this.MI=Lg;this.Ps=se;this.initialize()}dispose(){this.hd&&this.vm&&(this.hd.Hb(Fg.a.click,this.vm,Object(E.a)(this,this.LEa,"closePaneButtonClickHandler")),this.Rs.removeHandler(this.vm,Fg.a.Vf,Object(E.a)(this,this.Atg,"handleShortCutsOnCloseButton")),this.vm=null);this.Nc.Hmb(Object(E.a)(this,this.Bz,"onUnifiedAppStateChanged"));this.Db.Cmb(Object(E.a)(this,this.iQ,"onSetOffline"));this.aB.gDh(this)}initialize(){var J;const X="label_"+this.mA,
Ia="icon_"+this.mA;this.wb.className=this.fv?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(Hc.a)("AddClassOnSDXPaneContainer")&&this.Ps){const fb=this.Ps.iXh;fb&&(this.wb.className+=" "+fb)}this.wb.style.position="absolute";this.wb.style.display="none";this.wb.setAttribute(Cd.a.Ff,Cd.a.mEa);this.wb.setAttribute(Cd.a.E4,X);this.vm=this.hab("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.vm,"AddinPaneCloseButton");this.hd.xb(Fg.a.click,this.vm,Object(E.a)(this,this.LEa,
"closePaneButtonClickHandler"));this.Rs.addHandler(this.vm,Fg.a.Vf,Object(E.a)(this,this.Atg,"handleShortCutsOnCloseButton"));this.wb.appendChild(this.vm);Object(Hc.a)("AddInPaneHeaderEnhancement")?this.DQl():Object(Hc.a)("TempHeaderIconForActionAI")&&this.Ps&&"ActionAITaskPane"===this.Ps.iXh&&(this.Zhc=Me.a.DD(),this.Zhc.className="PaneIcon",this.Zhc.id=Ia,this.Zhc.src="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Orange.svg",this.wb.appendChild(this.Zhc));
this.$fb=Me.a.we();this.$fb.className="PaneLabel";this.$fb.id=X;this.$fb.setAttribute(Cd.a.Ff,Cd.a.DPf);this.$fb.setAttribute(Cd.a.O3b,"1");this.wb.appendChild(this.$fb);this.sP=Me.a.we();this.sP.className="AddinPanePanelResize";this.wb.appendChild(this.sP);this.Nc.eea(Object(E.a)(this,this.Bz,"onUnifiedAppStateChanged"));this.Db.cEa(Object(E.a)(this,this.iQ,"onSetOffline"));Gd.a.J(508425998,802,50,`AddInPane::initialize ${this.mA} for ${null===(J=this.Ps)||void 0===J?void 0:J.assetId}`)}DQl(){var J,
X,Ia;const fb="icon_"+this.mA;bc.c()?(null===(X=this.Ps)||void 0===X?0:X.jXh)?(this.Yhc=Me.a.we(),this.Yhc.className="PaneIcon",this.Yhc.id=fb,null===appChrome||void 0===appChrome?void 0:appChrome.api.renderIcon(this.Ps.jXh,this.Yhc),this.wb.appendChild(this.Yhc)):Gd.a.J(509120517,811,50,"No Header Icon for current pane:{0}",null===(Ia=this.Ps)||void 0===Ia?void 0:Ia.BA):Gd.a.J(508966294,811,10,"appChrome not loaded yet for pane:{0}",null===(J=this.Ps)||void 0===J?void 0:J.BA)}Bz(J,X){X.veb&&!this.rc.fp&&
this.isVisible&&this.Yug()}iQ(J){J&&this.isVisible&&(Object(Hc.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Oc.HVc(this.mA),this.Yug())}Yug(){this.zq(!1);this.Ep.bI().Ia(Jc.a.T3c,2,this.mA);this.Zye()||this.dispose()}layout(J,X){const Ia=X?J.nL(this.width):J.oL(this.width);this.isVisible&&(X?Ia.nL(1):Ia.oL(1),this.sP.style.height=(J.height-this.vm.clientHeight-this.$fb.clientHeight).toString()+"px",this.sP.style.width="100%");Me.a.jca(this.wb,Ia);return J}zUl(J){this.CPe=J}zq(J){const X=this.Mb!==
J;if(this.Mb=J)this.wb.style.display="block";const Ia=this.Zye();this.MI.cRl(this.mA,Ia);let fb=this.CPe;Object(Hc.a)("TaskPaneToolTip")?this.Ps&&this.Ps.Bdf?fb=this.Ps.Bdf:this.Ps&&(fb=this.Ps.BA):fb=this.Ps?this.Ps.BA:this.CPe;this.MI.uQ(this,this.Mb,fb,this.mA);Ia&&(this.vm.style.visibility=J?"visible":"hidden",X&&this.Oc.zoj(this.mA,J))}Zye(){return this.Oc.fwa(this.mA)}LEa(){this.zq(!1);this.Ep.bI().Ia(Jc.a.T3c,2,this.mA);this.Zye()||this.dispose();return!0}OTa(J,X,Ia,fb,Ab,ec,Uc){const Ad=Me.a.DD();
Ad.alt=Ab;Ad.className=mk.getImageClassWithCluster(J,fb);Ad.src=this.te.Ok(J+".png");Ad.setAttribute("Unselectable","on");J=Me.a.En();J.className=X+" cui-img-cont-float";J.appendChild(Ad);X=Me.a.En();X.className=Ia;X.setAttribute("Unselectable","on");X.appendChild(J);Ia=Me.a.zla();Ia.className="CommentPaneNoBorderButton cui-ctl";Ab&&(Ia.title=Ab);Ia.setAttribute(Cd.a.Ff,Cd.a.jx);Uc&&Ia.setAttribute(Cd.a.Rp,Uc);Ia.tabIndex=0;Ia.appendChild(X);ec&&(Ab=Me.a.En(),Ab.className="cui-ctl-mediumlabel",Ab.setAttribute("Unselectable",
"on"),Ab.innerText=ec,Ia.appendChild(Ab));return Ia}hab(J,X){return Object(Hc.a)("UseSVGAddInCloseButton")?(J=document.createElement(Me.a.k$a),J.type="button",J.setAttribute(Cd.a.Rp,CommonUIStrings.l_DialogClose),J.appendChild(Object(Kh.b)(Kh.a,20,20).va),J.className="AddinPaneSvgCloseButton",X=Me.a.zla(),X.setAttribute(Cd.a.Ff,Cd.a.jx),X.setAttribute(Cd.a.Rp,CommonUIStrings.l_DialogClose),X.appendChild(J),X):Object(Hc.a)("RemoveTitleForAddInPaneCloseButton")?this.OTa(J,"cui-img-16by16","cui-ctl-iconContainer",
X,void 0,null,CommonUIStrings.l_DialogClose):this.OTa(J,"cui-img-16by16","cui-ctl-iconContainer",X,CommonUIStrings.l_DialogClose,null,void 0)}Atg(J){J.keyCode===ff.a.Mp||J.keyCode===ff.a.fO?(this.LEa(null),J.preventDefault(),J.stopPropagation()):J.keyCode===ff.a.zs&&(J.shiftKey?this.Oc.notifyAgave(this.mA,12):this.Oc.notifyAgave(this.mA,11),J.preventDefault(),J.stopPropagation())}get isVisible(){return this.Mb}get va(){return this.wb}get order(){return 6}get width(){return this.isVisible?this.RFk:
0}get ePc(){return this.sP}get oVi(){return this.vm}get id(){return this.mA}}Object(k.a)(Yg,"AddInPane",null,[1360,180,106]);class em{constructor(J,X,Ia,fb,Ab,ec,Uc,Ad,Ce,ye){this.Ep=J;this.Db=X;this.aB=Ia;this.hd=fb;this.te=Ab;this.lhb=ec;this.Oc=Uc;this.Nc=Ad;this.rc=Ce;this.MI=ye}pTc(J,X,Ia,fb,Ab){return new Yg(J,X,this.Ep,Ia,fb,this.Db,this.aB,this.hd,this.te,this.lhb,this.Oc,this.Nc,this.rc,this.MI,Ab)}Q4(J){return new ad.a(J)}M1i(J){return new pj(this.Oc,this.Ep,this.Db,J,this.aB)}u7d(J,X,Ia,
fb,Ab){return new $c(J,X,Ia,fb,Ab)}}Object(k.a)(em,"AppforOfficeClassFactory",null,[1339]);class sh{constructor(J){this.TRg=this.AP=!1;this.km=Tk.a.A_();this.pMg=J;dj.ntl(this.pMg)}Vw(){this.TRg=!0}dispose(){if(this.TRg&&!this.AP){var J=Tk.a.A_();dj.mtl(this.pMg,this.km,J);this.AP=!0}}}Object(k.a)(sh,"ApiCallLogger",null,[106]);class Vk{get formatting(){return 0}set formatting(J){}get sourceSlideIds(){return null}set sourceSlideIds(J){}get targetSlideId(){return null}set targetSlideId(J){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(J){switch(J){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"Array<string>");return;
case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}
Object(k.a)(Vk,"InsertSlideOptions",null,[]);class vl{constructor(){this.controlId=this.appId=null}}Object(k.a)(vl,"RequestContext",null,[]);class gl{constructor(){this.aGf=this.Dyf=null}get layoutId(){return this.Dyf}set layoutId(J){this.Dyf=J}get slideMasterId(){return this.aGf}set slideMasterId(J){this.aGf=J}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(J){switch(J){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(k.a)(gl,"AddSlideOptions",null,[]);class lj{constructor(J,X,Ia){this.$hc=J;this.iS=X;this.Oc=Ia}getAppRuntimeStartState(){if(!this.Oc.fwa(this.iS))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Oc.Itj(this.$hc)?1:0}setAppRuntimeStartState(J){if(!this.Oc.fwa(this.iS)||0!==J&&1!==J)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Oc.Gem(this.$hc,1===J)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,
X){switch(J){case 2:return this.Duj();case 1:return this.rOl(X)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Duj(){return this.getAppRuntimeStartState()}rOl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");this.setAppRuntimeStartState(J);return null}}Object(k.a)(lj,"AppRuntimePersistenceService",null,[]);class Ij{constructor(J,X){this.iS=
J;this.Oc=X}getAppRuntimeState(){if(!this.Oc.fwa(this.iS))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Oc.Htj(this.iS)?2:1}setAppRuntimeState(J){if(!this.Oc.fwa(this.iS)||2!==J&&1!==J)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Oc.znb(this.iS,2===J)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 2:return this.Euj();case 1:return this.sOl(X)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,
X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Euj(){return this.getAppRuntimeState()}sOl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");this.setAppRuntimeState(J);return null}}Object(k.a)(Ij,"AppRuntimeService",null,[]);class qa{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 1001:return this.nbk(X);case 1002:return this.Ibk(X)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}nbk(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"string");this.insertHyperLink(X,J);return null}Ibk(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.insertSlideFromContent(J)}}Object(k.a)(qa,"Application",null,[]);class hb{constructor(J,X){this.FH=
!1;this._id=J;this.vSd=X}get enabled(){return this.FH}set enabled(J){this.FH=J;D.AFrameworkApplication.Pa.Ia(Qb.a.k9b,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.vSd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(J){switch(J){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 5:return this.TPl(X);
case 1:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}TPl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"boolean");this.setEnabled(J);return null}mJ(){this._OnAccess();return null}}Object(k.a)(hb,"RibbonButton",null,[]);class Gb{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(J){switch(J){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 3:return this.bVl(X);case 1:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,
X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}bVl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"boolean");this.setVisibility(J);return null}mJ(){this._OnAccess();return null}}Object(k.a)(Gb,"RibbonTab",null,[]);class pc{constructor(J,X){this.wPa=this.RB=this.wJc=null;this.E8=J;this.G5a=X;oa.a.Ta(this.E8)||(this.wPa=X.GAb(J),this.wJc=(this.RB=this.G5a?this.G5a.xj:null)?this.RB.getOsfControl(this.E8):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(J){let X=
null;if(!this.sBg())return this.o0f();if(!oa.a.Ta(J)&&this.wPa&&this.wPa.taskpane){if(!this.qWf(J))return this.C0f(J);X=new hb(J,this.wPa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(X)}getTab(J){let X=null;if(!this.sBg())return this.o0f();if(!oa.a.Ta(J)&&this.wPa&&this.wPa.taskpane){if(!this.qWf(J))return this.C0f(J);X=new Gb(J)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(X)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(J){switch(J){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 1:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){switch(J){case 7:return this.zjj(X);
case 6:return this.Ajj(X);case 3:return this.Bvj(X);case 5:return this.FOj(X)}J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}zjj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.executeRequestCreate(J)}Ajj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.executeRequestUpdate(J)}Bvj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getButton(J)}FOj(J){J=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getTab(J)}mJ(){this._OnAccess();return null}C0f(J){return this.P0f("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+J)}o0f(){return this.P0f("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}sBg(){const J=!oa.a.Ta(this.wJc.getSharedRuntimeId());Gd.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",J));return J}qWf(J){if(this.wJc){var X=
this.wJc.getManifest();if(X&&(X=X.getRibbonExtensionControlMap()))return J in X||this.HRi(J)}return!1}HRi(J){var X=this.Unj();if(X){X=X.B7f;for(const Ia of X.tabs){if(Ia.id===J)return!0;for(const fb of Ia.groups)for(const Ab of fb.controls){if(Ab.id===J)return!0;if("Menu"===Ab.type){X=Ab;for(const ec of X.items)if(ec.id===J)return!0}}}}return!1}Unj(){return N.getInstance().ybb(this.wPa.taskpane.ownerAddinStoreType,this.wPa.taskpane.ownerAddinSolutionId,1)}P0f(J,X){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,
fb)=>{fb(OfficeExtension.WacRuntime.Utility.createRichApiException(J,X))})}}Object(k.a)(pc,"DynamicRibbon",null,[]);class vd{constructor(J,X,Ia,fb){this.Pof="";this.RFc=0;this.AH=J;this._id=X;this.A_b=Ia;this.G5a=fb}get id(){return this._id}_RegisterStateChange(){this.RFc||this.AH.execute(J=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.A_b,this._id,1);this.Pof=J.OMa(this._id,X=>{this.G5a.Boj(this.A_b,this._id,JSON.stringify(X))})});this.RFc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.RFc--;
this.RFc||this.AH.execute(J=>{J.s2a(this._id,this.Pof)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(J){switch(J){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){switch(J){case 6:return this.Q9h();case 7:return this.X9h()}J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Q9h(){return this._RegisterStateChange()}X9h(){return this._UnregisterStateChange()}}Object(k.a)(vd,"LicenseFeature",
null,[]);class zd{get scopes(){return null}set scopes(J){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(J){switch(J){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(k.a)(zd,"MsaDeviceTicketOptions",null,[]);class xe{constructor(J,X){this.AH=Ob.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
this.A_b=J;this.G5a=X}getFeatureTier(J,X){return OfficeExtension.WacRuntime.Utility.createPromise(Ia=>{const fb=1===X?1:2===X?2:0;this.AH.execute(Ab=>{Ab.getFeatureTier(J,fb).then(ec=>{Ia(this.nEj(ec))},()=>{Ia(X)})})})}getLicenseFeature(J){J=new vd(this.AH,J,this.A_b,this.G5a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}getMsaDeviceTicket(){return null}isFeatureEnabled(J,X){return OfficeExtension.WacRuntime.Utility.createPromise(Ia=>{this.AH.execute(fb=>{fb.isFeatureEnabled(J,
X).then(Ab=>{Ia(Ab)},()=>{Ia(X)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(J=>{this.AH.execute(X=>{X=X.isFreemiumUpsellEnabled();J(X)})})}launchUpsellExperience(J){if(this.G5a.xj.getOsfControl(this.A_b).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.AH.execute(X=>{X.launchUpsellExperience(J)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied","");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 7:return this.dGj(X);case 6:return this.T9h(X)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,
X){switch(J){case 2:return this.hBj(X);case 5:return this.mEj(X);case 1:return this.oik(X);case 3:return this.ejk();case 4:return this.Mvk(X)}J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}hBj(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"int");return this.getFeatureTier(X,J)}mEj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");
return this.getLicenseFeature(J)}dGj(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string"),Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,2,zd);return this.getMsaDeviceTicket(X,Ia,J)}oik(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"boolean");return this.isFeatureEnabled(X,J)}ejk(){return this.isFreemiumUpsellEnabled()}Mvk(J){J=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.launchUpsellExperience(J)}T9h(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");this._TestFireStateChangedEvent(J);return null}nEj(J){switch(J){case 1:return 1;case 2:return 2;default:return 0}}}Object(k.a)(xe,"License",null,[]);class le{get height(){return 0}set height(J){}get left(){return 0}set left(J){}get top(){return 0}set top(J){}get width(){return 0}set width(J){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(J){switch(J){case 1:return this.height;
case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return;case 3:this.top=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,
X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(k.a)(le,"ShapeAddOptions",null,[]);class Dg{constructor(){this.hw=this.JRa=null}get requestId(){return this.JRa}set requestId(J){this.JRa=J}get result(){return this.hw}set result(J){this.hw=J}getTypeName(){return"Microsoft.Office.PowerPoint.ApplyJOfcCommandsCompletedEventArgs"}invokePropertyGet(J){switch(J){case 1:return this.requestId;case 2:return this.result}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 1:this.requestId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");break;case 2:this.result=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string")}}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(k.a)(Dg,"ApplyJOfcCommandsCompletedEventArgs",null,[]);class ch{constructor(){this.dFf=this.OEf=this.Mqf=null}get designerOptions(){return this.Mqf}set designerOptions(J){this.Mqf=J}get scenarioOptions(){return this.OEf}set scenarioOptions(J){this.OEf=J}get selectionOptions(){return this.dFf}set selectionOptions(J){this.dFf=J}getTypeName(){return"Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions"}invokePropertyGet(J){switch(J){case 1:return this.designerOptions;
case 2:return this.scenarioOptions;case 3:return this.selectionOptions}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 1:this.designerOptions=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");return;case 2:this.scenarioOptions=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");
return;case 3:this.selectionOptions=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}
Object(k.a)(ch,"ApplyJOfcCommandsOptions",null,[]);class $h{constructor(J){if(!J)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.jQe=J}areShortcutsInUse(J){return OfficeExtension.WacRuntime.Utility.createPromise((X,Ia)=>{this.jQe.checkShortcutsInUse(J).then(fb=>{X(fb)}).catch(fb=>{Ia(fb)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((J,X)=>{this.jQe.getShortcuts().then(Ia=>{J(Ia)}).catch(Ia=>{X(Ia)})})}replaceShortcuts(J){return OfficeExtension.WacRuntime.Utility.createPromise((X,
Ia)=>{this.jQe.replaceShortcuts(J).then(()=>{X(null)}).catch(fb=>{Ia(fb)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){switch(J){case 3:return this.HFi(X);case 1:return this.EMj();case 2:return this.UDl(X)}J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}HFi(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"Array<string>");return this.areShortcutsInUse(J)}EMj(){return this.getShortcuts()}UDl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"any");return this.replaceShortcuts(J)}}Object(k.a)($h,"ActionService",
null,[]);class wj{constructor(){this.data=null}}Object(k.a)(wj,"AugLoopHostMessageReceivedEventArgs",null,[]);var kf=d(708);class Kf{constructor(J,X=!1,Ia=null){this.E8=J;this.GQa=X;this.v6a=Ia||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(J){this.GQa||kf.a.KKh(J)}_RegisterHostMessageReceivedEvent(){this.GQa||(Kf.fCh||(kf.a.TBh(J=>{this.v6a.fireEvent("",65542,Object.assign(new wj,{data:J}))}),Kf.fCh=!0),this.v6a.register(this.E8,"",65542))}_UnregisterHostMessageReceivedEvent(){this.GQa||
this.v6a.unregister(this.E8,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,
X){switch(J){case 1:return this.HMl(X);case 2:return this.P9h();case 3:return this.W9h()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}HMl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");this.sendMessage(J);return null}P9h(){this._RegisterHostMessageReceivedEvent();return null}W9h(){this._UnregisterHostMessageReceivedEvent();return null}}
Kf.fCh=!1;Object(k.a)(Kf,"AugLoopEventService",null,[]);var lh=d(337),sc=d(255);class uf{constructor(J,X,Ia){this.lRa=this.Dtf=null;this.E8=J;this.HBf=X;if(this.La=Ia)this.Dtf=this.La.Ea("GetAccessTokenOAuthFirstPartyAllowList")}XGj(){this.lRa||(this.lRa=sc.a.Au(Ob.a.instance.Ha("Common.App.OAuth.IOAuthManager")));return this.lRa}qjk(J,X){if(!this.HBf||""===this.E8||!this.La)return!1;const Ia=this.HBf.getOsfControl(this.E8);if(!Ia)return!1;let fb=!1;this.Dtf.split(";").forEach(Ab=>{X===Ab&&(fb=!0)});
return this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===D.AFrameworkApplication.za.mb.Ej&&Ia.isFirstParty()&&J===uf.eDi&&fb&&jd.d(Ia.getSolutionId())===uf.fDi}getAccessTokenFirstPartyOAuth(J,X){let Ia;Ia=this.qjk(J,X)?fb=>{const Ab=this.XGj();Ab.continueWith(()=>{Ab.result.vH(J,X).then(ec=>{fb(ec);return ec})})}:fb=>{fb(Object.assign(new lh.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Ia)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){switch(J){case 1:return this.ptj(X)}J=this.invokeMethod(J,
X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}ptj(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"string");return this.getAccessTokenFirstPartyOAuth(X,J)}}uf.eDi="Maker";uf.fDi="fa000000043";Object(k.a)(uf,"Auth",null,[]);var Ak=d(3);class oi{constructor(){this.SRa=null}BMj(){this.SRa||(this.SRa=sc.a.Au(Ob.a.instance.Ha("Common.App.SharedFilePicker.ISharedFilePicker")));return this.SRa}getSharedFilePickerResponse(J){return OfficeExtension.WacRuntime.Utility.createPromise((X,
Ia)=>{try{const fb=this.BMj();Ak.Task.WAA.call(null,fb).continueWith(()=>{const Ab=fb.result;if(Ab){let ec={};({Ev:ec}=ia.d(J)).returnValue?Ab.U_c(ec).then(Uc=>{Uc&&0<Uc.length?X(Uc):Ia(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Uc=>{Ia(Uc)}):Ia(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ia(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(fb){Ia(fb)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){switch(J){case 1:return this.AMj(X)}J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}AMj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getSharedFilePickerResponse(J)}}Object(k.a)(oi,"SharedFilePicker",null,[]);class sg{createInstance(J,X,Ia="",fb=null,Ab=null){switch(J){case "Microsoft.Office.ActionService":return new $h(X);case "Microsoft.Office.SharedFilePicker":return new oi;case "Microsoft.Office.Auth":return new uf(Ia,
fb,Ab);case "Microsoft.Office.AugLoopEventService":return new Kf(Ia)}return null}}Object(k.a)(sg,"WacApiHost",null,[]);class Ui{constructor(){this.isFeedbackSent=!1}}Object(k.a)(Ui,"UserFeedbackUIDismissedEventArgs",null,[]);class Vh{constructor(J,X,Ia=!1,fb=null){this.E8=J;this.$Ec=X;this.GQa=Ia;this.v6a=fb||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(J){this.v6a.fireEvent("",65546,Object.assign(new Ui,{isFeedbackSent:J}))}onError(){}eHj(J){switch(J){case 0:return"Smile";case 1:return"Frown";
case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}fHj(J){switch(J){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}dHj(J){const X={};X.isScenarioEnabled=J.isScenarioEnabled;X.scenarioType=J.scenarioType;if(J=J.question){const Ia={};Ia.questionUiType=J.questionUIType;Ia.questionUiBehavior=J.questionUIBehavior;Ia.questionInstruction=J.questionInstruction;Ia.questionOptions=J.questionOptions;X.questionDetails=Ia}return X}eOc(J,X,Ia){"True"===Ia?J[X]=!0:
"False"===Ia&&(J[X]=!1)}collectUserFeedback(J,X,Ia,fb){if(!this.GQa){const Ab={};D.AFrameworkApplication.fa.M2b(Ab);const ec=this.$Ec.getContext(Ab);ec.initialFeedbackType=this.eHj(J);ec.uiType=this.fHj(X);ec.telemetryGroup.featureArea=Ia;fb.v2Config.contextDataFiles&&(ec.isShareContextDataEnabled=!0,ec.getContextData=()=>Promise.all(bi.a.map(fb.v2Config.contextDataFiles,Uc=>window.fetch("data:application/octet-stream;base64,"+Uc.base64Data).then(Ad=>Ad.blob()).then(Ad=>new File([Ad],Uc.fileName,
{type:Uc.fileType})))));(J=fb.v2Config.scenarioConfig)&&(ec.scenarioConfig=this.dHj(J));this.eOc(ec,"showEmailAddress",fb.v2Config.isEmailCollectionEnabled);this.eOc(ec,"isFileUploadEnabled",fb.v2Config.isFileUploadEnabled);this.eOc(ec,"screenshot",fb.v2Config.isScreenshotEnabled);this.eOc(ec,"isThankYouPageDisabled",fb.v2Config.isThankYouPageDisabled);qb.UISurfaces.$0c().then(Uc=>{Uc.initializeFeedbackModal(ec,Object(E.a)(this,this.onDismiss,"onDismiss"),Object(E.a)(this,this.onError,"onError"));
return Uc})}}_RegisterUserFeedbackUIDismissedEvent(){this.GQa||this.v6a.register(this.E8,"",65546)}_UnregisterUserFeedbackUIDismissedEvent(){this.GQa||this.v6a.unregister(this.E8,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 1:return this.YVi(X);case 18:return this.R9h();case 19:return this.Y9h()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}YVi(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,
"int"),Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"int"),fb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,2,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,3,"object");this.collectUserFeedback(X,Ia,fb,J);return null}R9h(){this._RegisterUserFeedbackUIDismissedEvent();return null}Y9h(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(k.a)(Vh,"UserFeedbackService",null,[]);class qh{constructor(J,X,Ia){this.Ktc=!1;this.zRg=
!0;this.$hc=J;this.iS=X;this.Oc=Ia}hostName(){return"PowerPointOnline"}appId(){return this.$hc}controlId(){return this.iS}createInstance(J){switch(J){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new gl;case "Microsoft.Office.PowerPoint.Application":return new qa;case "Microsoft.Office.PowerPoint.ApplyJOfcCommandsCompletedEventArgs":return new Dg;case "Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions":return new ch;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new Vk;
case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new le;case "Microsoft.AppRuntime.AppRuntimeService":return new Ij(this.iS,this.Oc);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new lj(this.$hc,this.iS,this.Oc);case "Microsoft.Office.Licensing.License":return new xe(this.iS,this.Oc);case "Microsoft.DynamicRibbon.DynamicRibbon":return new pc(this.iS,this.Oc);case "Microsoft.Office.AugLoopEventService":var X=this.Oc.xj.getOsfControl(this.iS);if(null===X||void 0===X?0:X.isFirstParty())return this.nfh||
(this.nfh=new sg),J=this.nfh.createInstance(J,null,this.iS),J.GQa=this.Ktc,J;break;case "Microsoft.Office.UserFeedbackService":if(X=this.Oc.xj.getOsfControl(this.iS),null===X||void 0===X?0:X.isFirstParty())return new Vh(this.iS,Ob.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.Ktc)}n.ULS.sendTraceTag(509085406,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",J);return null}bgg(){const J=this.Oc.jY.SU(this.iS);return J.An.id+
"#"+J.An.storeType}static Iq(J){const X=Ob.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").gJf;J||(X.zRg=!1);return!X.Ktc}}Object(k.a)(qh,"RichApiHost",null,[1361]);class ab{constructor(J,X,Ia){this.bHd=this.pi=-1;this.pD=Ia;0<=J&&(this.pi+=J,this.bHd=0<X?J+X<this.pD.getCount()?J+X:this.pD.getCount():this.pD.getCount())}get_current(){return-1<this.pi&&this.pi<this.bHd?this.pD.getItemAt(this.pi):null}moveNext(){const J=this.dem();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}dem(){return this.pi+
1<this.bHd?(this.pi++,!0):!1}}Object(k.a)(ab,"ElementEnumerator",null,[1479]);class wl{constructor(J,X){this.C8a=J;this.YT=X}get fill(){qh.Iq(!1);return null}get height(){qh.Iq(!1);return 0}set height(J){qh.Iq(!1)}get id(){const J=new sh(28);try{Gd.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.C8a)return Gd.a.J(577525073,802,10,"Shape is null."),"";const X=this.C8a.get_shapeId().toString();J.Vw();return X}finally{J&&J.dispose()}}get left(){qh.Iq(!1);return 0}set left(J){qh.Iq(!1)}get lineFormat(){qh.Iq(!1);
return null}get name(){qh.Iq(!1);return null}set name(J){qh.Iq(!1)}get tags(){qh.Iq(!1);return null}get textFrame(){qh.Iq(!1);return null}get top(){qh.Iq(!1);return 0}set top(J){qh.Iq(!1)}get type(){qh.Iq(!1);return 0}get width(){qh.Iq(!1);return 0}set width(J){qh.Iq(!1)}deleteObject(){if(qh.Iq(!0)){var J=new sh(45);try{Gd.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const X=Object(Ca.a)(205,this.YT);X&&(X.Z$i(Object(Ca.a)(4,this.C8a)),J.Vw())}finally{J&&J.dispose()}}}getParentSlide(){qh.Iq(!1);
return null}getParentSlideLayout(){qh.Iq(!1);return null}getParentSlideLayoutOrNullObject(){qh.Iq(!1);return null}getParentSlideMaster(){qh.Iq(!1);return null}getParentSlideMasterOrNullObject(){qh.Iq(!1);return null}getParentSlideOrNullObject(){qh.Iq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(J){switch(J){case 11:return this.fill;case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;
case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,X){switch(J){case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,
0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(X,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 4:return this.Y9d();
case 15:return this.RHj();case 16:return this.SHj();case 18:return this.THj();case 17:return this.UHj();case 19:return this.VHj();case 20:return this.WHj();case 2:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Y9d(){this.deleteObject();return null}RHj(){return this.getParentSlide()}SHj(){return this.getParentSlideLayout()}THj(){return this.getParentSlideLayoutOrNullObject()}UHj(){return this.getParentSlideMaster()}VHj(){return this.getParentSlideMasterOrNullObject()}WHj(){return this.getParentSlideOrNullObject()}mJ(){this._OnAccess();
return null}}Object(k.a)(wl,"Shape",null,[]);class Dn{constructor(J){this.pYb=this.dub=null;this.YT=J;if(J=Object(Ca.a)(205,this.YT))this.dub=J.lWa();this.ehl()}ehl(){this.pYb=new ha.ScriptSharpLegacyMap;if(this.dub)for(const J of this.dub){const X=new wl(J,this.YT);this.pYb.add(X.id,X)}}addGeometricShape(){qh.Iq(!1);return null}addLine(){qh.Iq(!1);return null}addTextBox(){qh.Iq(!1);return null}getCount(){const J=new sh(29);try{Gd.a.J(508360579,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.dub)return Gd.a.J(508360578,
802,50,"In Shape.GetCount(), _shapes is null"),0;J.Vw();return this.dub.length}finally{J&&J.dispose()}}getItem(J){const X=new sh(31);try{Gd.a.J(508360577,802,50,"PptApi Call - ShapeCollection.GetItem");try{const Ia=this.pYb.ga(J);X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360576,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{X&&X.dispose()}}getItemAt(J){const X=new sh(30);try{Gd.a.J(508360547,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Ia=this.dub[J].get_shapeId().toString(),fb=this.pYb.ga(Ia);X.Vw();return fb}catch(Ia){throw Gd.a.J(508360546,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{X&&
X.dispose()}}getItemOrNullObject(J){const X=new sh(32);try{Gd.a.J(508360545,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");const {value:Ia}=this.pYb.Eg(J);X.Vw();return Ia}finally{null===X||void 0===X?void 0:X.dispose()}}_OnAccess(){}getAsyncEnumerator(J,X){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ab(J,X,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 6:return this.nui(X);case 7:return this.Rui(X);case 8:return this.Dwi(X);case 1:return this.gcb();case 2:return this.wcb(X);
case 5:return this.vcb(X);case 3:return this.xcb(X);case 4:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}nui(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,le);return this.addGeometricShape(X,J)}Rui(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
0,"int");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,le);return this.addLine(X,J)}Dwi(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,le);return this.addTextBox(X,J)}gcb(){return this.getCount()}wcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItem(J)}vcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");return this.getItemAt(J)}xcb(J){J=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItemOrNullObject(J)}mJ(){this._OnAccess();return null}}Object(k.a)(Dn,"ShapeCollection",null,[1477]);class Zn{constructor(J){this.ALc=J}get id(){const J=new sh(15);try{Gd.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.ALc)return Gd.a.J(576581654,802,10,"SlideLayout is null."),"";const X=this.ALc.Id.toString();J.Vw();return X}finally{J&&J.dispose()}}get name(){const J=new sh(16);try{Gd.a.J(572643277,
802,50,"PptApi Call - SlideLayout.GetName");if(!this.ALc)return Gd.a.J(576581655,802,10,"SlideLayout is null."),"";const X=this.ALc.Name;J.Vw();return X}finally{J&&J.dispose()}}get shapes(){qh.Iq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(J){switch(J){case 1:return this.id;case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 2:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}mJ(){this._OnAccess();
return null}}Object(k.a)(Zn,"SlideLayout",null,[]);class Bk{constructor(J){this.qYb=null;this.m1b=J;this.fhl()}fhl(){this.qYb=new ha.ScriptSharpLegacyMap;if(this.m1b)for(const J of this.m1b){const X=new Zn(J);this.qYb.add(X.id,X)}}getCount(){const J=new sh(17);try{Gd.a.J(508360608,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.m1b)return Gd.a.J(508360607,802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;J.Vw();return this.m1b.length}finally{J&&J.dispose()}}getItem(J){const X=
new sh(19);try{Gd.a.J(508360606,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Ia=this.qYb.ga(J);X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360605,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{X&&X.dispose()}}getItemAt(J){const X=new sh(18);try{Gd.a.J(508360604,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");
try{const Ia=this.qYb.ga(this.m1b[J].Id.toString());X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360603,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{X&&X.dispose()}}getItemOrNullObject(J){const X=new sh(20);try{Gd.a.J(508360602,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");
const {value:Ia}=this.qYb.Eg(J);X.Vw();return Ia}finally{null===X||void 0===X?void 0:X.dispose()}}_OnAccess(){}getAsyncEnumerator(J,X){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ab(J,X,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 1:return this.gcb();case 2:return this.wcb(X);case 3:return this.vcb(X);case 4:return this.xcb(X);case 5:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}gcb(){return this.getCount()}wcb(J){J=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItem(J)}vcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");return this.getItemAt(J)}xcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItemOrNullObject(J)}mJ(){this._OnAccess();return null}}Object(k.a)(Bk,"SlideLayoutCollection",null,[1477]);class Gg{constructor(J){this.qub=J}get id(){const J=new sh(21);try{Gd.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");
if(!this.qub)return Gd.a.J(576581648,802,10,"SlideMaster is null."),"";const X=this.qub.Id.toString();J.Vw();return X}finally{J&&J.dispose()}}get layouts(){const J=new sh(23);try{Gd.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.qub)return Gd.a.J(576581649,802,10,"SlideMaster is null."),null;const X=new Bk(this.qub.ContentMasters);J.Vw();return X}finally{J&&J.dispose()}}get name(){const J=new sh(22);try{Gd.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.qub)return Gd.a.J(576581650,
802,10,"SlideMaster is null."),"";const X=this.qub.Name;J.Vw();return X}finally{J&&J.dispose()}}get shapes(){qh.Iq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(J){switch(J){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 2:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}mJ(){this._OnAccess();return null}}Object(k.a)(Gg,"SlideMaster",null,[]);class Ik{constructor(J,X){this.YT=J;this.VCa=X}get id(){const J=
new sh(5);try{Gd.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.YT)return Gd.a.J(587747398,802,10,"Slide is null."),"";const X=this.YT.Fb.toString();J.Vw();return X}finally{J&&J.dispose()}}get layout(){const J=new sh(9);try{Gd.a.J(572643284,802,50,"PptApi Call - Slide.GetLayout");const X=this.VCa.DZ;for(let Ia=0;Ia<X.length;Ia++){const fb=X[Ia].ContentMasters;for(let Ab=0;Ab<fb.length;Ab++)if(this.YT.xo===fb[Ab].Id){const ec=new Zn(fb[Ab]);J.Vw();return ec}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a Layout.");}finally{J&&J.dispose()}}get shapes(){const J=new sh(6);try{Gd.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");const X=new Dn(this.YT);J.Vw();return X}finally{J&&J.dispose()}}get slideMaster(){const J=new sh(8);try{Gd.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const X=this.VCa.DZ;for(let Ia=0;Ia<X.length;Ia++)if(this.YT.Oj===X[Ia].Id){const fb=new Gg(X[Ia]);J.Vw();return fb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a SlideMaster.");}finally{J&&J.dispose()}}get tags(){qh.Iq(!1);return null}deleteObject(){if(qh.Iq(!0)){var J=new sh(7);try{Gd.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.VCa.QJ(this.YT),J.Vw()}finally{J&&J.dispose()}}}setSelectedShapes(){qh.Iq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(J){switch(J){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 3:return this.Y9d();case 8:return this.nTl(X);case 2:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Y9d(){this.deleteObject();return null}nTl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"Array<string>");this.setSelectedShapes(J);return null}mJ(){this._OnAccess();return null}}Object(k.a)(Ik,"Slide",null,[]);class qn{constructor(J){this.rYb=null;this.VCa=J;this.rub=this.VCa.slides;this.ghl()}ghl(){this.rYb=new ha.ScriptSharpLegacyMap;if(this.rub)for(const J of this.rub){const X=
new Ik(J,this.VCa);this.rYb.add(X.id,X)}}fzj(){return 0<this.getCount()?this.rub[this.getCount()-1]:null}ahe(J){return J?J.Oj:this.VCa.DZ[0].Id}hzj(J){const X=this.VCa.DZ;for(let Ia=0;Ia<X.length;Ia++)if(J===X[Ia].Id)return X[Ia].ContentMasters[0].Id;return 0}add(J){if(qh.Iq(!0)){var X=new sh(10);try{Gd.a.J(508360587,802,50,"PptApi Call - SlideCollection.Add");const Ia=this.fzj();let fb=0;fb=J&&J.slideMasterId?parseInt(J.slideMasterId):this.ahe(Ia);let Ab=0;Ab=J&&J.layoutId?parseInt(J.layoutId):this.hzj(fb);
this.VCa.O2b(Ia,null,fb,Ab);X.Vw()}finally{X&&X.dispose()}}}getCount(){const J=new sh(11);try{Gd.a.J(508360586,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.rub)return Gd.a.J(508360585,802,50,"In Slides.GetCount(), _slides is null"),0;J.Vw();return this.rub.length}finally{J&&J.dispose()}}getItem(J){const X=new sh(13);try{Gd.a.J(508360584,802,50,"PptApi Call - SlideCollection.GetItem");try{const Ia=this.rYb.ga(J);X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360583,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{X&&X.dispose()}}getItemAt(J){const X=new sh(12);try{Gd.a.J(508360582,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Ia=this.rYb.ga(this.rub[J].Fb.toString());X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360581,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{X&&X.dispose()}}getItemOrNullObject(J){const X=new sh(14);try{Gd.a.J(508360580,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");const {value:Ia}=this.rYb.Eg(J);X.Vw();return Ia}finally{null===X||void 0===X?void 0:X.dispose()}}_OnAccess(){}getAsyncEnumerator(J,X){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ab(J,X,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 6:return this.Nui(X);case 1:return this.gcb();case 5:return this.wcb(X);case 2:return this.vcb(X);case 3:return this.xcb(X);
case 4:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Nui(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,gl);this.add(J);return null}gcb(){return this.getCount()}wcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItem(J)}vcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
0,"int");return this.getItemAt(J)}xcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItemOrNullObject(J)}mJ(){this._OnAccess();return null}}Object(k.a)(qn,"SlideCollection",null,[1477]);class rn{constructor(J){this.sYb=null;this.n1b=J;this.hhl()}hhl(){this.sYb=new ha.ScriptSharpLegacyMap;if(this.n1b)for(const J of this.n1b){const X=new Gg(J);this.sYb.add(X.id,X)}}getCount(){const J=new sh(24);try{Gd.a.J(508360594,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.n1b)return Gd.a.J(508360593,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;J.Vw();return this.n1b.length}finally{J&&J.dispose()}}getItem(J){const X=new sh(26);try{Gd.a.J(508360592,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Ia=this.sYb.ga(J);X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360591,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{X&&X.dispose()}}getItemAt(J){const X=new sh(25);try{Gd.a.J(508360590,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Ia=this.sYb.ga(this.n1b[J].Id.toString());X.Vw();return Ia}catch(Ia){throw Gd.a.J(508360589,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Ia.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{X&&X.dispose()}}getItemOrNullObject(J){const X=new sh(27);try{Gd.a.J(508360588,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");const {value:Ia}=this.sYb.Eg(J);X.Vw();return Ia}finally{null===X||void 0===X?void 0:X.dispose()}}_OnAccess(){}getAsyncEnumerator(J,X){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ab(J,X,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 1:return this.gcb();case 2:return this.wcb(X);case 3:return this.vcb(X);case 4:return this.xcb(X);case 5:return this.mJ()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,X){J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}gcb(){return this.getCount()}wcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItem(J)}vcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");return this.getItemAt(J)}xcb(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getItemOrNullObject(J)}mJ(){this._OnAccess();return null}}
Object(k.a)(rn,"SlideMasterCollection",null,[1477]);var gn=d(88);class Wk{constructor(J,X,Ia){this.tF=new vl;this.L6=J.presentation;this.jS=Ia;this.nah=X}get context(){return this.tF}Azk(J){try{"chatpane"==JSON.parse(J).entryPoint.toLowerCase()&&gn.c(Jc.a.J6l,!0)}catch(X){Gd.a.J(508682385,817,15,`PptApi::logCopilotEntryPoint parsing options.scenarioOptions threw exceptions : ${X}`)}}get id(){return null}get slideMasters(){const J=new sh(2);try{Gd.a.J(508908362,802,50,"PptApi Call - Presentation.GetSlideMasters");
const X=new rn(this.L6.DZ);J.Vw();return X}finally{J&&J.dispose()}}get slides(){const J=new sh(3);try{Gd.a.J(508908361,802,50,"PptApi Call - Presentation.GetSlides");const X=new qn(this.L6);J.Vw();return X}finally{J&&J.dispose()}}get tags(){qh.Iq(!1);return null}get title(){const J=new sh(4);try{return Gd.a.J(508908360,802,50,"PptApi Call - Presentation.GetTitle"),J.Vw(),"This is the title property"}finally{J&&J.dispose()}}applyJOfcCommands(J,X){if(qh.Iq(!0))return Hc.a("PptApplyJOfcCommandsUseSharedCode")?
((null===X||void 0===X?0:X.scenarioOptions)&&Hc.a("PptChatLogUserAction")&&this.Azk(null===X||void 0===X?void 0:X.scenarioOptions),this.jS.applyJOfcCommands(J,X.designerOptions,X.scenarioOptions,X.selectionOptions,this.nah.bgg())):OfficeExtension.WacRuntime.Utility.createPromise(Ia=>{const fb={};fb.promiseToResolve=Ia;fb.requestBody=J;D.AFrameworkApplication.Pa.Ia(Jc.a.NFa,2,fb)}).then(Ia=>{D.AFrameworkApplication.Pa.Ia(Jc.a.NFa,2,{promiseToResolve:null,requestBody:""});return Ia.toString()},()=>
null)}applyJOfcCommandsAsync(J,X){if(qh.Iq(!0))return this.jS.applyJOfcCommands(J,X.designerOptions,X.scenarioOptions,X.selectionOptions,this.nah.bgg()),""}getSelectedShapes(){qh.Iq(!1);return null}getSelectedSlides(){qh.Iq(!1);return null}getSelectedTextRange(){qh.Iq(!1);return null}getSelectedTextRangeOrNullObject(){qh.Iq(!1);return null}insertSlidesFromBase64(){qh.Iq(!1)}setSelectedSlides(){qh.Iq(!1)}_RegisterEvent(J,X){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
J,X)}_RegisterEventApplyJOfcCommandsCompleted(){}_UnregisterEvent(J,X){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,J,X)}_UnregisterEventApplyJOfcCommandsCompleted(){}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(J){switch(J){case 14:return this.id;case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,X){this.invokePropertySet(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,X){switch(J){case 13:return this.yEi(X);case 5:return this.qLj();case 6:return this.sLj();case 7:return this.xLj();case 9:return this.yLj();case 1003:return this.Jbk(X);
case 8:return this.oTl(X);case 1001:return this.O9h(X);case 11:return this.N9h();case 1002:return this.V9h(X);case 12:return this.U9h()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,X){switch(J){case 10:return this.AEi(X)}J=this.invokeMethod(J,X);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}AEi(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
1,ch);return this.applyJOfcCommands(X,J)}yEi(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,ch);return this.applyJOfcCommandsAsync(X,J)}qLj(){return this.getSelectedShapes()}sLj(){return this.getSelectedSlides()}xLj(){return this.getSelectedTextRange()}yLj(){return this.getSelectedTextRangeOrNullObject()}Jbk(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
1,Vk);this.insertSlidesFromBase64(X,J);return null}oTl(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"Array<string>");this.setSelectedSlides(J);return null}O9h(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"int");this._RegisterEvent(X,J);return null}N9h(){this._RegisterEventApplyJOfcCommandsCompleted();return null}V9h(J){const X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"int");this._UnregisterEvent(X,J);return null}U9h(){this._UnregisterEventApplyJOfcCommandsCompleted();return null}}Object(k.a)(Wk,"Presentation",null,[]);class hl{constructor(J){this.jS=J}create(J,X){return new Wk(J,X,this.jS)}}Object(k.a)(hl,"PresentationFactory",null,[1342]);class Cm{create(J,X,Ia){return new qh(J,X,Ia)}}Object(k.a)(Cm,"RichApiHostFactory",null,[1343]);class Ao{constructor(J){this.wb=document.createElement("div");
this.wb.className="AddinPaneFrame";this.aB=J}dispose(){}layout(J,X){this.aB.value.eXj(J,X);return J}get isVisible(){return!1}get va(){return this.wb}get order(){return 13}}Object(k.a)(Ao,"AddinPaneFrame",null,[1304,180,106]);class Sf{constructor(){this.Dgb=this.bcd=this.K=this.Oc=this.tI=null}get name(){return"PowerPointWebEditor.AppForOffice"}fc(J){this.tI=J.resolve("Common.AFrameworkApplication");this.K=J;this.K.register(yk,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").na(()=>
new yk).ma();this.K.register(vg,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").na(()=>new vg(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").va,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.ze("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(Zc,
"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").na(()=>new Zc(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();
this.K.register(Cm,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").na(()=>new Cm).ma();this.K.register(hl,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").na(()=>new hl(this.K.resolve("PowerPointWebEditor.ICopilotProxy"))).ma();this.K.register(hg,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").na(()=>new hg(this.K.resolve("PowerPointWebEditor.IApplicationContext"),
this.K.resolve("PowerPointWebEditor.IFrameContext"),new Cf,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.ze("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new H,K.getInstance(),this.K.ze("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),
this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const X=new w;this.K.register(xf,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").na(()=>new xf(this.tI,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),X,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new gf,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register(me,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").na(()=>new me(X)).ma();this.K.register(Bg,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").na(()=>
new Bg(this.psj())).ma();this.K.register(em,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").na(()=>new em(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();this.K.register(1304,"PowerPointWebEditor.IAddinPaneFrame").ma().na(()=>new Ao(this.K.ze("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(1305,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().na(()=>new fg)}init(){D.AFrameworkApplication.vua||this.K.resolve("Common.IAppSettingsManager").Ue(Object(E.a)(this,
this.Pn,"onFullAppSettingsReady"))}Pn(){this.Oc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Oc.q6b=!0;D.AFrameworkApplication.fa.getBooleanAppSetting("OcpsIsEnabled")?this.K.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(J=>{J.isFeatureEnabled(Sf.NNk,!0).then(X=>{this.Oc.q6b=X;this.$Cb();return null})}):this.$Cb()}$Cb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").l2e();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const J=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");J.tcm();J.ucm();J.YUj();this.uem();this.J9j();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}J9j(){const J=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame"),
X=this.K.resolve("PowerPointWebEditor.IFocusManager"),Ia=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");X.Lfa(Md.a.gEa,Md.a.Nj,J,!Ia.one());this.tI.Qp.qv()}psj(){const J=[];var X=[];X.push(this.K.resolve("Box4.Graph.IGraphInstance").Cd(47));X.push(this.K.resolve("Box4.Graph.IGraphInstance").Cd(10));X=new en(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),X,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));J.push(X);X=new vj(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));J.push(X);X=new de(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));J.push(X);X=new M(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(47));J.push(X);X=new aj(this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),
this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));J.push(X);return J}uem(){this.Dgb=D.AFrameworkApplication.fa.Ea("DevAddinManifestFileUrl");this.bcd=D.AFrameworkApplication.fa.Ea("DevAddinManifestGuid");var J=D.AFrameworkApplication.fa.Ea("IsDevAddinTest");if(this.Dgb&&this.bcd&&J)if(J="true"===J,y.a.instance.getItem("optedIntoAddinDeveloperMode")||J&&D.AFrameworkApplication.fa.getBooleanAppSetting("SuppressDeveloperAddinDialogs"))if(y.a.instance.getItem(this.bcd)||
J&&D.AFrameworkApplication.fa.getBooleanAppSetting("SuppressDeveloperAddinDialogs"))this.Oc.xj.validateAndCacheNewDevAddinManifest(this.Dgb);else{J=new m.StandardDialog;J.Fd=4;const X=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Dgb)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;J.vQ(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,X,Object(E.a)(this,this.OBh,"registerDevAddinManifestHandler"))}else J=
Object(E.a)(this,this.OBh,"registerDevAddinManifestHandler"),J=new ne(this.Dgb,J),J.Fd=0,J.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}OBh(J){1===J&&this.Dgb&&this.awl()}awl(){this.Oc&&(this.Oc.xj.validateAndCacheNewDevAddinManifest(this.Dgb),y.a.instance.setItem(this.bcd,"true"))}static main(){C.a.instance.Ac(new Sf)}}Sf.NNk="mso_officeStore";Object(k.a)(Sf,"AppForOfficePackage",null,[2,3]);var En=
d(13);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Object(En.d)("AppForOffice");Type.registerNamespace("CommandUI.AddInCommands");Sf.main();Object(En.c)("AppForOffice")},390:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.Y3l=1]="spCatalog";e[e.X3l=2]="spApp";e[e.Imj=3]="fileSystem";
e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.G7j=7]="inMemory";e[e.vlm=8]="uploadFileDevCatalog";e[e.G0j=9]="hardCodedPreinstall";e[e.Ntc=10]="privateCatalog";e[e.Oom=16]="wopiCatalog"})(k||(k={}));Object(L.b)("AddinProviderType",k)},454:function(L,V,d){d.d(V,"a",function(){return n});L=d(0);var k=d(395),e=d(201);class n{static tQh(r){return parseInt(n.Tpb(e.a.w_d,r)||"-1")<=(new Date).getTime()}static Ffe(r){return parseInt(n.Tpb(e.a.G9a,r)||"-1")}static pne(r){return Boolean.parse(n.Tpb(e.a.IOc,
r)||"false")}static Tpb(r,w){let D=null;try{const y=n.Acb();if(void 0!==y&&y){const m=e.a.wZc(r)+w;D=y.getItem(m)}else k.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(y){k.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",r,w)}return D}static uBc(r,w,D){try{const y=n.Acb();if(void 0!==y&&y){const m=e.a.wZc(r)+D;y.setItem(m,w)}else k.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(y){k.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",r,D)}}static Acb(){if(!n.WWa)return null;let r=null;try{r=localStorage}catch(w){n.WWa=!1,r=null}return r}}n.WWa=!0;Object(L.a)(n,"AddinUtil",null,[])},550:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.notSupported=0]="notSupported";e[e.tvk=1]="launchByLocalCacheInitializer";e[e.pvk=2]="launchByAnonymousApiInitializer";e[e.rvk=3]="launchByInsertion";e[e.uvk=4]="launchByRefresh";e[e.svk=5]="launchByLastUpdateInitializer";
e[e.qvk=6]="launchByDynamicCall"})(k||(k={}));Object(L.b)("AddinCommandsLaunchOperationType",k)},561:function(L,V,d){d.r(V);L=d(0);var k=d(18),e=d(395),n=d(71);class r{constructor(){this.startTime=0;this.callback=null}}Object(L.a)(r,"SSOCallbackInfo",null,[]);class w{constructor(){this.accessToken=null}}Object(L.a)(w,"AccessTokenInformation",null,[399]);var D=d(1010);class y{constructor(){this.token=null;this.expiresOn=0;this.pEa=this.yX=null}}Object(L.a)(y,"CachedTokenInfo",null,[]);class m{constructor(){this.VDc=
new k.a;this.zta=this.yta=!1;this.COa=this.yX=null;this.startTime=this.retryCount=0;this.CMf=null}get u$a(){return this.VDc}}Object(L.a)(m,"SSORequestInfo",null,[]);class C extends m{constructor(){super();this.errorCode=0}}Object(L.a)(C,"SSOFailedRequestInfo",m,[]);var E=d(25);class F{constructor(G,Y,ba,ha){this.h9=new k.a;this.IT=new k.a;this.HPa=null;this.j0b=new k.a;this.ryf=Promise.resolve(null);this.SFf=!1;this.Nmi=Y;this.E8=G;this.KLc=ba;this.t$h=ha}IYl(G){if(this.HPa&&this.HPa.yX===G.yX){if(Date.now()/
1E3+F.MWk>this.HPa.expiresOn)return this.HPa=null,!1;G=new D.a;G.token=this.HPa.token;G.expiresOn=this.HPa.expiresOn;G.pEa=this.HPa.pEa;G.Fpb=!0;G.Gbc=0;this.scc(G);return!0}return!1}eXl(G){for(let Y=0;Y<this.IT.count;Y++)if(this.IT.ga(Y).yX===G.yX&&this.IT.ga(Y).COa===G.COa){let ba;(ba=this.IT.ga(Y)).retryCount=ba.retryCount+1;G.retryCount=this.IT.ga(Y).retryCount;if(this.IT.ga(Y).retryCount<F.M0a||!this.IT.ga(Y).yta&&G.yta||!this.IT.ga(Y).zta&&G.zta){if(!this.IT.ga(Y).yta&&G.yta||!this.IT.ga(Y).zta&&
G.zta)G.retryCount=0;this.IT.removeAt(Y);break}G=new D.a;G.errorCode=this.IT.ga(Y).errorCode;this.scc(G);return!0}return!1}Kwi(G,Y){for(let ba=0;ba<this.IT.count;ba++)if(this.IT.ga(ba).COa===G.COa&&this.IT.ga(ba).yX===G.yX)return;this.IT.add(Object.assign(new C,{yta:G.yta,zta:G.zta,yX:G.yX,COa:G.COa,errorCode:Y,retryCount:G.retryCount}))}get resource(){return this.Nmi}Bfe(G,Y,ba,ha,ka,ca){const {AppsForOfficeSingleSignOnManager:ia}=d(561);""===ba&&(ba=null);if(this.SFf)ia.Ena(ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
null,null);else{var oa=null;for(const sa of this.h9)if(sa.yta===G&&sa.zta===Y&&sa.yX===ba&&sa.COa===ka){oa=sa;break}oa||(oa=Object.assign(new m,{yta:G,zta:Y,yX:ba,CMf:ha,COa:ka,retryCount:0,startTime:ia.IG()}),this.h9.add(oa));oa.retryCount=0;oa.u$a.add(ca);this.ryf=this.ryf.then(()=>{var {AppsForOfficeSingleSignOnManager:sa}=d(561);if(0<this.h9.count){var Ca=this.h9.ga(0);if(this.IYl(Ca)||this.eXl(Ca))return null;for(let R=0;R<this.j0b.count;)this.j0b.ga(R)+F.s$l<sa.IG()?this.j0b.removeAt(R):R++;
if(this.j0b.count>=F.aXk||this.h9.count>=F.JWk)return Ca=new D.a,Ca.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.scc(Ca),null;let Ta=null;E.AFrameworkApplication.za&&(sa=E.AFrameworkApplication.za.DW)&&(Ta=sa.lj("ComponentAttach",this.E8+F.Zoi));return Ca.COa.gsi(this.resource,Ca.yta,Ca.zta,Ca.yX,this.t$h,Ca.CMf).then(R=>{Ta&&Ta.stop();this.scc(R)},()=>{Ta&&Ta.stop();const R=new D.a;R.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.scc(R)})}return null})}}scc(G){const {AppsForOfficeSingleSignOnManager:Y}=
d(561);try{if(this.h9.count){var ba=this.h9.ga(0);this.h9.removeAt(0);var ha=null;G.errorCode||(ha=new w,ha.accessToken=G.token);G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.Kwi(ba,G.errorCode);var ka={};null!=G.Gbc&&(ka.getTokenSilentTime=G.Gbc.toString());
null!=G.Hle&&(ka.getTokenPopupTime=G.Hle.toString());null!=G.cie&&(ka.getIDTokenTime=G.cie.toString());null!=G.Fpb&&(ka.tokenCached=G.Fpb.toString());G.Gdf&&(ka.detailedError=G.Gdf);G.pEa&&(ka.authLibrary=G.pEa);ba.retryCount&&(ka.retryCount=ba.retryCount);for(var ca of ba.u$a)Y.Ena(ca,G.errorCode,ha,ka);null!=G.Fpb&&G.Fpb||this.j0b.add(ba.startTime);if(!G.errorCode)for(null!=G.expiresOn&&(this.HPa=Object.assign(new y,{token:G.token,expiresOn:G.expiresOn,yX:ba.yX,pEa:G.pEa})),this.IT.clear(),ca=0;ca<
this.h9.count;)if(this.h9.ga(ca).yX===ba.yX){for(const ia of this.h9.ga(ca).u$a)Y.Ena(ia,G.errorCode,ha,ka);this.h9.removeAt(ca)}else ca++}}catch(ia){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ia.message)}}shutdown(){this.SFf=!0;this.h9.clear()}}F.s$l=6E4;F.aXk=6;F.JWk=6;F.M0a=3;F.MWk=300;F.Zoi="GetAccessToken";Object(L.a)(F,"SSOCallbackManager",null,[]);var B=d(201),H=d(245),K=d(165),A=d(74),W=d(55),N=d(46),P=d(136),U=d(166);d.d(V,"AppsForOfficeSingleSignOnManager",
function(){return Q});class Q{constructor(G,Y,ba=null){this.Nqb=new n.a;const ha=new k.a;Y&&ha.add(Y.RTk);ba&&ha.addRange(ba);this.RB=G;this.oqi=ha}removeCallbackForAddin(G){this.Nqb.Ib(G)&&(this.Nqb.ga(G).shutdown(),this.Nqb.remove(G))}Cfe(G,Y,ba,ha,ka,ca,ia,oa,sa,Ca){Ca=Object.assign(new r,{startTime:Q.IG(),callback:Ca});try{const Ha=!!ba&&""!==ba;var Ta=Ca.startTime;const da=this.getOsfControl(G);let Ba=da.getStoreType()||"",za=da.getOwnerAddinStoreType()||"",Aa=da.getSolutionId()||"";const na=
da.getVersion()||"";Ba=Ba.toLowerCase();za=za.toLowerCase();Aa=Aa.toLowerCase();var R=A.a.n0c(Y)||"";const la=A.a.n0c(da.getIframeUrl())||"",va=R.toLowerCase()===la.toLowerCase();R=Ba;"inmemory"===Ba&&(R=za);const Pa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,R,da.getAssetId(),null,null,da.getStoreId()),Qa={["callInstanceId"]:Ta.toString(),["controlSolutionId"]:Pa,["controlVersion"]:na,["storeType"]:Ba,["ownerStoreType"]:za,["allowConsentPrompt"]:ha.toString(),["forMSGraphAccess"]:ka.toString(),
["allowSignInPrompt"]:ca.toString(),["hasAddinAuthChallenge"]:Ha.toString(),["securityOriginEqualsSourceLocation"]:va.toString(),["singleSignOnEnabled"]:ia.toString(),["accountTypeFilter"]:oa||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Qa);P.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:K.a.YH(Qa)}));Ta=!0;const Ua=E.AFrameworkApplication.fa.Ea("HostAuthType");switch(oa){case "aad":Ta="aad"===Ua;break;case "msa":Ta="msa"===Ua;
break;default:Ta=!oa||"noFilter"===oa}if(Ta){oa=null;if(ia)for(const Ya of this.oqi)if(Ya.Zhk(Aa)){oa=Ya;break}oa?this.isSSOAddin(G)?(ia=!0,"omex"===R&&(ia=!1),"spapp"===R||"spcatalog"===R?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),Q.Ena(Ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ka&&!ia?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),Q.Ena(Ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(ka&&"exchange"===R&&(ha=!1),this.Bfe(G,Y,ba,R,ha,ca,sa,oa,Ca))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),Q.Ena(Ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):Q.Ena(Ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else Q.Ena(Ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Ha){this.I$c(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
Ha.message),Q.Ena(Ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(G,Y,ba,ha){this.Cfe(G,ba[B.a.KOc]||null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,Y,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,ha)}Bfe(G,Y,ba,ha,ka,ca,ia,oa,sa){this.Nqb.Ib(G)?ha=this.Nqb.ga(G):(ha=new F(G,this.getWebApplicationResource(G).split(",")[0],ha,this.getDefaultDisplayName(G)),this.Nqb.add(G,ha));const Ca=ha.resource;G=Q.eKj(Ca,this.getWebApplicationId(G));const Ta=OfficeExt.WACUtils.getHostSecure(Y);G&&Ta?G.toLowerCase()===Ta.toLowerCase()?ha.Bfe(ka,ca,ba,ia,oa,sa):(Q.Ofb('SSO Resource "'+Ca+'" cannot be used from "'+Y+'" origin due to domain mismatch.'),
e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),Q.Ena(sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(G||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Ta||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),Q.Ena(sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}I$c(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(G){return this.RB.getOsfControl(G)}isSSOAddin(G){return this.getOsfControl(G).getManifest().isSSOAddin()}getWebApplicationId(G){return this.getOsfControl(G).getManifest().getWebApplicationId()}getWebApplicationResource(G){return this.getOsfControl(G).getManifest().getWebApplicationResource()}getDefaultDisplayName(G){return this.getOsfControl(G).getManifest().getDefaultDisplayName()}static Cog(){try{const G=
{};W.a.gIa&&H.a.Ddb&&(G.UiHostSupportsAuthTokenAddinList=Q.xYc);G.UiHostSupportsAuthToken=H.a.Ddb;return G}catch(G){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",G.message)}return null}static getInstance(G,Y,ba=null){Q.Ja||(Q.Ja=new Q(G,ba));return Q.Ja}static wRi(G){Q.Ja&&Q.Ja.removeCallbackForAddin(G)}static Ofb(G){window.console.warn&&window.console.warn(G)}static eKj(G,Y){if(!G)return"";Y||(Y="");let ba=G.toLowerCase();var ha=Y.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(ha)||
(Q.Ofb('SSO App Id "'+Y+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ba.endsWith(ha)||(Q.Ofb('SSO Resource "'+G+'" does not end with App Id "'+Y+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ba.startsWith("https://")&&!ba.startsWith("api://"))return Q.Ofb('SSO Resource "'+G+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(Y=0;Y<G.length;Y++){ha=G.charAt(Y);const ka=N.a.charCodeAt(G,Y);if(33>ka||126<ka||"&"===ha||"?"===ha||"#"===ha||"%"===ha||"\\"===ha)return Q.Ofb('SSO Resource "'+G+'" contains an invalid character "'+ha+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+ha+"' in resource URI."),""}if(0<=G.indexOf("::"))return Q.Ofb('SSO Resource "'+G+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),
"";if(120<G.length)return Q.Ofb('SSO Resource "'+G+'" is '+G.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+G.length+"."),"";ba.startsWith("api://")&&(ba="https://"+ba.substring(6,ba.length));return 8===ba.length?"":OfficeExt.WACUtils.getHostSecure(ba)||""}static Ena(G,Y,ba,ha){var ka=G.startTime;let ca=0;0<ka&&(ca=Q.IG()-ka);ka={["callInstanceId"]:ka.toString(),["callDuration"]:ca.toString(),["errorCode"]:Y.toString()};
if(ha)for(const ia in ha)ka[ia]=ha[ia];e.ULS.sendTraceTag(51401116,344,50,"{0}",ka);P.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:K.a.YH(ka)}));G.callback(Y,ba)}static IG(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(G){}return Date.now()}}Q.xYc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
Q.Ja=null;Object(L.a)(Q,"AppsForOfficeSingleSignOnManager",null,[324])},708:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(18);class e{static TBh(n){e.Ycc.add(n)}static CKh(n){for(const r of e.Ycc)r(n)}static dCh(n){e.nnb.add(n);if(0<e.IMa.count){for(const r of e.IMa)n(r);e.IMa=new k.a}}static KKh(n){if(0<e.nnb.count)for(const r of e.nnb)r(n);else e.IMa.add(n)}}e.IMa=new k.a;e.nnb=new k.a;e.Ycc=new k.a;Object(L.a)(e,"AugLoopEventUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.appforoffice.js.map
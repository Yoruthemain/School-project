'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1311:function(L,V,d){d.r(V);var k=d(0),e=d(395),n=d(18),r=d(19),w=d(25);class D{}D.beginDraftingAsync="OSC:BDA";D.Npj="OSC:FEQ";D.selectComment="OSC:SC";Object(k.a)(D,"CommentTaskNames",null,[]);class y{constructor(ea){this.gJa=ea;this.pIk=[]}get handler(){return this.gJa}get X9(){return this.pIk}}Object(k.a)(y,"RegisteredListener",null,[]);class m{constructor(ea,Ka){this.type=0;this.payload=null;this.type=ea;
this.payload=Ka}}Object(k.a)(m,"OfficeSharedCommentsEvent",null,[560]);class C{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(k.a)(C,"ViewContainerEvent",null,[560]);var E=d(680);class F{constructor(ea){this.yHe=!1;this.gZ=new n.a;this.zb=ea}Dwl(ea){ea=new y(ea);this.gZ.add(ea)}h1h(ea){for(let Ka=0;Ka<this.gZ.count;++Ka)if(this.gZ.ga(Ka).handler===ea){this.gZ.removeAt(Ka);break}}Iqa(ea=!1){const Ka=()=>{if(w.AFrameworkApplication.Dh)e.ULS.sendTraceTag(40420181,
201,50,"Skipped processing comment pane events since app is shutting down.");else for(let Yb=0;Yb<this.gZ.count;++Yb){const Gc=this.gZ.ga(Yb);for(;0<Gc.X9.length;){var bb=Array.dequeue(Gc.X9);if(Object(r.a)(C,bb)){var vb=Gc.handler;vb(bb)}else Object(r.a)(m,bb)&&(vb=Gc.handler,vb(bb.type,bb.payload))}}};ea?Ka():this.yHe||(this.yHe=!0,E.a.B9a(this.zb,()=>{Ka();this.yHe=!1},D.Npj))}}Object(k.a)(F,"GenericEventHost",null,[]);class B extends F{constructor(ea){super(ea)}cyl(ea){this.Dwl(ea)}pgm(ea){this.h1h(ea)}eOh(ea){ea=
this.t2i(ea);for(let Ka=0;Ka<this.gZ.count;++Ka)Array.enqueue(this.gZ.ga(Ka).X9,ea);this.Iqa(!0)}t2i(ea){const Ka=new C;Ka.eventType=3;Ka.viewContainerVisibilityState=ea;return Ka}bqj(){const ea=this.$7i();for(let Ka=0;Ka<this.gZ.count;++Ka)Array.enqueue(this.gZ.ga(Ka).X9,ea);this.Iqa(!0)}$7i(){const ea=new C;ea.eventType=2;return ea}}Object(k.a)(B,"ViewContainerEventHost",F,[526]);class H{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=
this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(k.a)(H,"BasicEventPayload",null,[810]);class K{constructor(ea){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ea}}Object(k.a)(K,"CommentContextDetails",null,[]);class A{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(k.a)(A,"ContextChangeWithSelectedThreadIndex",null,[810]);class W{constructor(){this.tasks=this.comments=null}}Object(k.a)(W,"LoadCommentsNoVirtualization",null,[810]);class N extends F{constructor(ea){super(ea);this.bni=0}Zwl(ea,Ka,bb,vb,Yb,Gc,ud=0){ea=new y(ea);Gc&&Array.enqueue(ea.X9,this.d2i(Gc,this.bni));Gc=Ka?Ka.length:0;Array.enqueue(ea.X9,this.A0f(Gc,
bb,vb,ud,null));Gc&&Array.enqueue(ea.X9,this.n1f(Ka,Yb));this.gZ.add(ea);this.Iqa()}Vgf(ea){this.h1h(ea)}U6e(ea,Ka,bb,vb=0,Yb=null){this.lXa(this.A0f(ea,Ka,bb,vb,Yb));this.Iqa()}vMl(ea,Ka,bb,vb,Yb=null){this.lXa(this.x2i(ea,Ka,bb,vb,Yb));this.Iqa()}xKh(ea,Ka,bb){this.lXa(this.A2i(ea,Ka,bb));this.Iqa()}Y6e(ea,Ka){this.lXa(this.n1f(ea,Ka));this.Iqa()}selectComment(ea){this.lXa(this.W1f(ea,6));this.Iqa()}highlightComment(ea){this.lXa(this.W1f(ea,7));this.Iqa()}Y4a(ea,Ka){this.lXa(this.X4i(ea,Ka));this.Iqa()}zhl(ea,
Ka){this.lXa(this.g7i(ea,Ka));this.Iqa()}d2i(ea,Ka=0){const bb=new H;bb.modelCapabilityFlags=ea;bb.richTextCapabilityFlags=Ka;return new m(12,bb)}A0f(ea,Ka,bb,vb,Yb=null){const Gc=new H;Gc.numberOfComments=ea;Gc.numberOfThreads=Ka;Gc.contextDetails=Object.assign(new K(bb),{nextPopulatedContextDetails:vb});Gc.contextDrafts=Yb;Gc.rehydrationDrafts=null;return new m(0,Gc)}x2i(ea,Ka,bb,vb,Yb=null){const Gc=new A;Gc.numberOfComments=ea;Gc.numberOfThreads=Ka;Gc.selectedThreadIndex=bb;Gc.contextDetails=
Object.assign(new K(vb),{nextPopulatedContextDetails:0});Gc.contextDrafts=Yb;Gc.rehydrationDrafts=null;return new m(0,Gc)}A2i(ea,Ka,bb){const vb=new H;vb.comments=ea;vb.numberOfThreads=Ka;vb.tasks=bb;return new m(2,vb)}n1f(ea,Ka){const bb=new W;bb.comments=ea;bb.tasks=Ka;return new m(1,bb)}W1f(ea,Ka){const bb=new H;bb.commentId="";ea&&(bb.commentId=ea);return new m(Ka,bb)}X4i(ea,Ka){const bb=new H;bb.changes=[];bb.contextDetails=Object.assign(new K(Ka),{nextPopulatedContextDetails:ea});return new m(10,
bb)}g7i(ea,Ka){const bb=new H;bb.commentId=ea;bb.smartReplies=Ka;return new m(15,bb)}lXa(ea){for(let Ka=0;Ka<this.gZ.count;++Ka)Array.enqueue(this.gZ.ga(Ka).X9,ea)}}Object(k.a)(N,"OfficeSharedCommentsEventHost",F,[552]);var P=d(1265);class U{constructor(){this.wFf=this.BGf=!1;this.qqi=[]}get OTb(){return this.qqi}get Yob(){return this.BGf}set Yob(ea){this.BGf=ea;for(const Ka of this.OTb)Ka.Yob=ea}get Nnb(){return this.wFf}set Nnb(ea){this.wFf=ea;for(const Ka of this.OTb)Ka.Nnb=ea}EOa(ea){for(const Ka of this.OTb)ea=
Ka.EOa(ea);return ea}}Object(k.a)(U,"AggregateCommentTaskPersonTransformer",null,[967]);var Q=d(103);class G{constructor(ea,Ka,bb,vb,Yb=!1){this.priority=this.completion=-1;this.type=ea;this.user=Ka;this.time=bb;this.recordId=vb;this.isLossy=Yb}}Object(k.a)(G,"HistoryRecord",null,[]);class Y{constructor(ea,Ka){this.jii=new P.a(()=>Ka.EOa(ea.value))}Tyj(){return new Date}XEa(ea,Ka,bb){if(0===ea)throw e.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const vb=Q.a.create().toString();bb=new G(ea,this.jii.value,bb,vb,!1);bb.commentId=Ka;e.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",ea);return bb}}Object(k.a)(Y,"HistoryRecordFactory",null,[968]);class ba{constructor(){this.endDate=this.startDate=null}}Object(k.a)(ba,"CommentTaskSchedule",null,[]);class ha{constructor(ea,Ka,bb,vb,Yb,Gc){this.isLossy=ea;this.title=Ka;this.assignees=bb;this.schedule=vb;this.completion=Yb;this.priority=
Gc}}Object(k.a)(ha,"CommentTaskState",null,[]);class ka{constructor(){this.commentId=null}}Object(k.a)(ka,"HistoryItem",null,[]);class ca{constructor(ea,Ka,bb,vb,Yb,Gc,ud){this.WNd=!1;if(1!==Ka.type)throw Error.argument("createRecord");this.LWb=bb;this.IWb=vb;this.JWb=Yb;this.CAf=1;this.RGc=ea;this.Aji=Gc;this._state=new ha(!1,this.LWb,ud,new ba,this.JWb,this.IWb);this._history=[];this.z1f(Ka)}syb(ea,Ka){if(1!==ea.type)throw Error.argument("createRecordTemplate");const bb=ca.DOj(ea,this.CAf);this.CAf++;
return Object.assign(new G(Ka,ea.user,ea.time,bb),{commentId:ea.commentId})}get VHg(){return this.history[this.history.length-1]}get dug(){return this.state.completion===this.JWb}get cug(){return this.state.priority===this.IWb}get eug(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get fug(){return this.state.title===this.LWb}z1f(ea){ea=Object.assign(new ka,{commentId:ea.commentId,records:[ea]});
this.history.push(ea)}fgg(ea){let Ka=-1;for(let bb=0;bb<this.state.assignees.length;bb++)if(this.RGc.equals(this.state.assignees[bb],ea)){Ka=bb;break}return Ka}NWl(ea){const Ka=this.VHg,bb=Ka.records[Ka.records.length-1];return this.RGc.equals(bb.user,ea.user)&&Ka.commentId===ea.commentId&&bb.time.getTime()===ea.time.getTime()?!0:!1}mlm(ea){switch(ea.type){case 2:-1===this.fgg(ea.assignee)&&this.state.assignees.push(ea.assignee);break;case 3:const Ka=this.fgg(ea.assignee);0<=Ka&&this.state.assignees.splice(Ka,
1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=ea.schedule;break;case 6:this.state.completion=ea.completion;break;case 9:this.state.title=ea.title;break;case 10:this.state.priority=ea.priority;break;case 0:this.state.isLossy=!0;break;case 1:e.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.WNd=!0;break;case 8:this.WNd=!1;break;case -1:e.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;
default:this.state.isLossy=!0}ea.isLossy&&(this.state.isLossy=!0);this.NWl(ea)?this.VHg.records.push(ea):this.z1f(ea)}get isDeleted(){return this.WNd}get state(){return this._state}get history(){return this._history}ACj(ea){if(!ea)return this.history;const Ka=Array.clone(this.history),bb=Ka[0],vb=bb.records.shift();if(!this.Aji){var Yb=this.syb(vb,4);bb.records.unshift(Yb)}!ea.dug&&this.dug&&(Yb=this.syb(vb,6),Yb.completion=this.JWb,bb.records.unshift(Yb));!ea.cug&&this.cug&&(Yb=this.syb(vb,10),Yb.priority=
this.IWb,bb.records.unshift(Yb));!ea.eug&&this.eug&&(Yb=this.syb(vb,5),Yb.schedule=new ba,bb.records.unshift(Yb));!ea.fug&&this.fug&&(Yb=this.syb(vb,9),Yb.title=this.LWb,bb.records.unshift(Yb));ea.isDeleted&&(ea=this.syb(vb,8),bb.records.unshift(ea));return Ka}static DOj(ea,Ka){return"Synthesized-"+ea.recordId+"-"+Ka}}Object(k.a)(ca,"CommentTaskStateBuilder",null,[]);var ia=d(736);class oa{constructor(ea,Ka,bb,vb){this.id=ea;this.commentId=Ka;this.currentState=bb;this.history=vb}}Object(k.a)(oa,"CommentTaskItem",
null,[]);class sa{constructor(ea,Ka="",bb="",vb=""){this.IsCurrentUser=!1;this.UserId=ea;this.Provider=Ka;this.DisplayName=bb;this.Email=vb}}Object(k.a)(sa,"CommentTaskPerson",null,[903]);const Ca=ea=>{const Ka=new sa(ea.UserId,ea.Provider,ea.DisplayName,ea.Email);Ka.IsCurrentUser=ea.IsCurrentUser;return Ka};var Ta=d(1061);d(287);class R{constructor(ea){this.extensions=ea}}Object(k.a)(R,"ExtensionList",null,[]);class Ha{static clone(ea){ea=Ha.$Ui(ea.extensions);return new R(ea)}static MXf(ea){return ea?
Ha.clone(ea):null}static isEmpty(ea){return!ea.extensions||!ea.extensions.count}static Ta(ea){return!ea||Ha.isEmpty(ea)}static $Ui(ea){if(!ea)return null;const Ka=new Ta.a;ea.forEach((bb,vb)=>{Ka.add(bb,vb);return!0});return Ka}}Object(k.a)(Ha,"ExtensionListExtensions",null,[]);class da{static clone(ea){var Ka=Ca(ea.user);Ka=new G(ea.type,Ka,ea.time,ea.recordId,ea.isLossy);Ka.commentId=ea.commentId;Ka.anchorExtensionList=Ha.MXf(ea.anchorExtensionList);Ka.recordExtensionList=Ha.MXf(ea.recordExtensionList);
ea.assignee&&(Ka.assignee=Ca(ea.assignee));if(ea.schedule){var bb=ea.schedule;const vb=new ba;vb.startDate=bb.startDate;vb.endDate=bb.endDate;Ka.schedule=vb}Ka.completion=ea.completion;Ka.title=ea.title;Ka.priority=ea.priority;Ka.undoId=ea.undoId;return Ka}}Object(k.a)(da,"HistoryRecordExtensions",null,[]);class Ba{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd=!1){this.RGc=ea;this.PJc=Ka;this.Osa=bb;this.Xbi=vb;this.LWb=Yb;this.IWb=Gc;this.JWb=ud;this.AHc=Nd}F7i(ea,Ka,bb,vb=null){if(!ea)throw e.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Ka)throw e.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!bb||!bb.length)throw e.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==bb[0].type)throw e.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Yb=[],Gc=null,ud=this.tml(bb);for(var Nd of bb)if(!ud.contains(Nd.recordId))if(bb=
this.mqg(Nd.commentId,vb),bb=this.ftj(Nd,bb),1===bb.type){let qe=[];this.AHc&&Gc&&Gc.state&&(qe=Gc.state.assignees);Gc=new ca(this.RGc,bb,this.LWb,this.IWb,this.JWb,this.AHc,qe);Yb.push(Gc)}else if(Gc)Gc.mlm(bb);else throw e.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");ud=null;Nd=[];if(Gc){Gc.isDeleted||
(ud=Gc.state);Gc=null;for(var Bc of Yb)Yb=Bc.ACj(Gc),Array.addRange(Nd,Yb),Gc=Bc}Bc=this.mqg(Ka,vb);ud&&(ud.completion=this.sXi(Ka,vb,ud.completion));return new oa(ea,Bc,ud,Nd)}Asj(ea,Ka,bb,vb=null){if(!Ka)throw e.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(bb&&!ea)throw e.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Yb=[],Gc=this.Osa.Tyj();if(bb){var ud=this.Osa.XEa(1,ea,Gc);Yb.push(ud)}ud=
null;if(Ka.assigneeUpdate){if(!Ka.assigneeUpdate.assigneesToAdd||!Ka.assigneeUpdate.assigneesToRemove)throw e.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Nd=0;Nd<Ka.assigneeUpdate.assigneesToAdd.length;Nd++){var Bc=this.A1f(2,Ka.assigneeUpdate.assigneesToAdd[Nd],ea,Gc);Bc&&Yb.push(Bc)}for(Nd=0;Nd<Ka.assigneeUpdate.assigneesToRemove.length;Nd++)(Bc=this.A1f(3,Ka.assigneeUpdate.assigneesToRemove[Nd],ea,Gc))&&Yb.push(Bc)}else Ka.assignee&&
(bb||(ud=this.Osa.XEa(4,ea,Gc),Yb.push(ud)),Nd=this.Osa.XEa(2,ea,Gc),ud=this.PJc.EOa(Ka.assignee),Nd.assignee=ud,Yb.push(Nd));Ka.title?(vb=this.Osa.XEa(9,ea,Gc),vb.title=Ka.title,Yb.push(vb)):bb&&vb&&(Nd=this.Osa.XEa(9,ea,Gc),Nd.title=this.Xbi.AQj(vb,ud),Yb.push(Nd));if(Ka.schedule){if(Ka.schedule.startDate>Ka.schedule.endDate)throw e.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");vb=this.Osa.XEa(5,ea,Gc);vb.schedule=Ka.schedule;Yb.push(vb)}if(void 0!==
Ka.completion&&null!==Ka.completion){vb=Ka.completion;if(0>vb||100<vb)throw e.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");bb||e.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",vb);bb=this.Osa.XEa(6,ea,Gc);bb.completion=vb;Yb.push(bb)}if(void 0!==Ka.priority&&null!==Ka.priority){Ka=Ka.priority;if(0>Ka||10<Ka)throw e.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");ea=this.Osa.XEa(10,
ea,Gc);ea.priority=Ka;Yb.push(ea)}return Yb}A1f(ea,Ka,bb,vb){if(2!==ea&&3!==ea)return e.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;ea=this.Osa.XEa(ea,bb,vb);ea.assignee=this.PJc.EOa(Ka);return ea}tml(ea){const Ka=new ia.a,bb=new ia.a;for(let vb=ea.length-1;0<=vb;vb--){const Yb=ea[vb],Gc=bb.contains(Yb.recordId);Gc||-1!==Yb.type||(bb.contains(Yb.undoId)?e.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
bb.add(Yb.undoId));if(Gc||-1===Yb.type)Ka.contains(Yb.recordId)?e.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Ka.add(Yb.recordId)}return Ka}ftj(ea,Ka){const bb=da.clone(ea);bb.commentId=Ka;bb.user=this.PJc.EOa(ea.user);bb.assignee=this.PJc.EOa(ea.assignee);return bb}sXi(ea,Ka,bb){let vb=bb;ea&&Ka&&(({value:Ka}=Ka.Eg(ea)).returnValue?(vb=Ka.ResolveState?100:100===bb?0:bb,vb!==bb&&e.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",ea)):e.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",ea));return vb}mqg(ea,Ka){let bb=ea;ea&&Ka&&(({value:Ka}=Ka.Eg(ea)).returnValue?bb=Ka.CommentId:(e.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",ea),bb=ea));return bb}}Object(k.a)(Ba,"CommentTaskTranslatorImpl",null,[969]);class za{constructor(){this.n6a=
{};this.n6a.ops=[]}Cbk(ea){const Ka=this.n6a.ops;if(Ka.length){var bb=Ka.length-1;const vb=Ka[bb];if(!vb.attributes){vb.insert+=ea;Ka[bb]=vb;this.n6a.ops=Ka;return}}bb={};bb.insert=ea;Array.add(Ka,bb)}cbk(ea,Ka,bb){var vb={};vb.fullName=Ka.fullName;vb.email=Ka.email;vb.resolveState=Ka.resolveState;Ka={};Ka.atmention=vb;ea=this.VTa(ea,Ka);bb&&(vb={},vb.contentId=bb.contentId,bb={},bb.atmention=vb,ea.optional=bb);Array.add(this.n6a.ops,ea)}Ldc(ea,Ka){ea=this.VTa(ea,{});const bb={};bb.base64=Ka.base64;
Ka={};Ka.image=bb;ea.optional=Ka;Array.add(this.n6a.ops,ea)}insertHyperLink(ea,Ka){const bb={};bb.link=Ka.link;this.ZSl(bb,Ka);Array.add(this.n6a.ops,this.VTa(ea,bb))}vzj(){return Sys.Serialization.JavaScriptSerializer.serialize(this.n6a)}VTa(ea,Ka){const bb={};bb.insert=ea;bb.attributes=Ka;return bb}ZSl(ea,Ka){this.Dnb(Ka.weight>=za.dYk,ea,"weight",Ka.weight);this.Dnb(Ka.italic,ea,"italic",!0);this.Dnb(Ka.underline,ea,"underline",!0);this.Dnb(Ka.strikethrough,ea,"strikethrough",!0);this.Dnb(!!Ka.highlight,
ea,"highlight",Ka.highlight);this.Dnb(!!Ka.color,ea,"color",Ka.color);this.Dnb(!!Ka.paragraph,ea,"paragraph",Ka.paragraph)}Dnb(ea,Ka,bb,vb){ea&&(Ka[bb]=vb)}static qig(ea){return Sys.Serialization.JavaScriptSerializer.deserialize(ea,!0)}}za.dYk=700;Object(k.a)(za,"DeltaFormatCreator",null,[605]);var Aa=d(538),na=d(1207);class la{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}AQj(ea,Ka){if(!ea)throw e.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var bb=za.qig(ea)}catch(Bc){throw e.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var vb=ea=0,Yb=0;const Gc=RegExp("\\s+","g"),ud=new Sys.StringBuilder;for(var Nd of bb.ops)Nd.attributes&&Nd.attributes.atmention&&Nd.attributes.atmention.email&&Ka&&(bb=Nd.attributes.atmention.email,0<bb.length&&(bb===Ka.UserId||bb===Ka.Email||bb===Aa.a.nbb(Ka.UserId))&&(vb=ea,Yb=vb+Nd.insert.length)),bb=Nd.insert.replace(Gc,
" "),ea+=bb.length,ud.append(bb);!Yb&&Ka&&e.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Ka.Provider);Ka=ud.toString().trimEnd();ea=Ka.length;255<ea?(Nd=(255-(Yb-vb))/2,0>vb-Nd?(ea=na.a.instance.Zfe(Ka,255-this.ellipsis.length),Yb=Ka.substring(0,ea)+this.ellipsis,ea="Trimmed End"):Yb+Nd>ea?(vb=na.a.instance.d0c(Ka,ea-255+this.ellipsis.length),Yb=this.ellipsis+Ka.substring(vb,ea),ea="Trimmed Start"):(vb=na.a.instance.d0c(Ka,vb-Nd+this.ellipsis.length),ea=na.a.instance.Zfe(Ka,
Yb+Nd-this.ellipsis.length),Yb=this.ellipsis+Ka.substring(vb,ea)+this.ellipsis,ea="Trimmed Both")):(ea="No Trim",Yb=Ka);e.ULS.sendTraceTag(592998804,327,50,ea);return Yb}}Object(k.a)(la,"ContentExtractor",null,[]);class va{constructor(ea,Ka){this.Hfi=ea;this.kii=Ka;this.Nnb=this.Yob=!1}EOa(ea){if(!ea)return null;if(void 0===ea.UserId||null===ea.UserId)throw e.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(ea.IsCurrentUser||!this.Hfi.equals(this.kii.value,
ea))return ea;ea=Ca(ea);ea.IsCurrentUser=!0;return ea}}Object(k.a)(va,"EnsureIsCurrentUserSetTransformer",null,[967]);class Pa{constructor(){this.Nnb=this.Yob=!1}EOa(ea){if(!ea)return null;if(void 0===ea.UserId||null===ea.UserId)return ea;if(!ea.Email||""===ea.Email){let Ka;if(Ka=Aa.a.nbb(ea.UserId))return ea=Ca(ea),ea.Email=Ka,ea}return ea}}Object(k.a)(Pa,"RestoreEmailTransformer",null,[967]);class Qa{constructor(){this.Nnb=this.Yob=!1}EOa(ea){if(!ea)return null;if(void 0!==ea.UserId&&null!==ea.UserId)return ea;
switch(this.Yob?this.Nnb?2:1:0){case 0:if(void 0===ea.UserId||null===ea.UserId)throw e.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");ea=Ca(ea);break;case 1:if(void 0===ea.Id||null===ea.Id)throw e.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===ea.Email||null===ea.Email)throw e.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Ka=Qa.mth(ea.Id,ea.Email,null);
if(!Ka||""===Ka)throw e.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var bb=w.AFrameworkApplication.fa.Ea("HostAuthType")||"";if("aad"!==bb.toLowerCase()||Ka.startsWith("S::")){if("msa"===bb.toLowerCase())throw e.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");e.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",bb)}else throw e.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");ea=new sa(Ka,"AD",ea.DisplayName,ea.Email);break;case 2:if(void 0===ea.UserPrincipalName||null===ea.UserPrincipalName)throw e.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==ea.SuggestionSubtype&&null!==ea.SuggestionSubtype)if("OrganizationUser"===ea.SuggestionSubtype)Ka="AD";else throw e.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
ea.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw e.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");bb=Qa.mth(ea.Id,ea.UserPrincipalName,ea.AadObjectId);if(!bb||""===bb)throw e.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Ka&&!bb.startsWith("S::"))throw e.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
ea=new sa(bb,Ka,ea.Name,ea.UserPrincipalName);break;default:throw e.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return ea}static mth(ea,Ka,bb){if(!Ka||""===Ka)return e.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),ea;if(bb&&""!==bb)return"S::"+Ka+"::"+bb;if(!ea||""===ea)return e.ULS.sendTraceTag(593368217,327,50,"Missing ID"),ea;if(ea.startsWith("S::"))return ea;if(-1!==ea.indexOf("@")){bb=ea.split("@");if(Q.a.isValid(bb[0]))return"S::"+Ka+"::"+
bb[0];e.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return ea}}Object(k.a)(Qa,"UserIdCanonicalizationTransformer",null,[967]);class Ua{constructor(ea,Ka,bb=!1,vb=!1){this.Kdi=ea;this.bpf=Ka;this.Eii=bb;this.AHc=vb}r2i(){const ea=new Aa.a;var Ka=new P.a(Ua.Fyj);const bb=new U;this.bpf&&(bb.OTb.push(new Qa),bb.OTb.push(new Pa));this.Kdi&&bb.OTb.push(new va(ea,Ka));bb.Yob=this.bpf;bb.Nnb=this.Eii;Ka=new Y(Ka,bb);const vb=new la;return new Ba(ea,bb,Ka,vb,Ua.r$i,Ua.c$i,
Ua.d$i,this.AHc)}static Fyj(){const ea=new sa(w.AFrameworkApplication.fa.Ea("PresenceUserId")||"",w.AFrameworkApplication.fa.Ea("PresenceProvider")||"",w.AFrameworkApplication.userName||"");ea.IsCurrentUser=!0;return ea}}Ua.r$i="";Ua.c$i=5;Ua.d$i=0;Object(k.a)(Ua,"CommentTaskTranslatorFactory",null,[902]);class Ya{constructor(){this.iVd=this.xnf=!1;this.nub=this.fy=this.nvf=this.Yyf=this.cIf=this.kCf=this.SGf=this.Rpf=this.nG=this.X0b=null}initialize(ea,Ka,bb,vb=null,Yb=null,Gc=null,ud=null,Nd=null,
Bc=null,qe=null){this.nG=ea;this.Rpf=Ka;this.SGf=bb;this.kCf=vb;this.cIf=Yb;this.Yyf=Gc;this.nvf=ud;this.fy=Nd;this.xnf=!0;this.nub=Bc;this.X0b=qe}Udc(ea=null,Ka=null){if(!this.xnf)return e.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((bb,vb)=>{vb(E.a.fu(-2130915313))});if(this.iVd)return e.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>
{});this.X0b||(w.AFrameworkApplication.fa.getBooleanAppSetting("DynamicBundlesIsEnabled")?this.X0b=appResourceLoader.loadChunk("sharedComments"):this.X0b=this.nG.loadScript("sharedComments"));return this.X0b.then(()=>{ea&&ea();this.iVd||(this.nub&&this.nub.execute(bb=>{bb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Ka&&Ka(),sharedComments.instantiate(this.Rpf,this.SGf,this.kCf,this.cIf,this.Yyf,this.nvf,this.fy));this.iVd=!0})}}Object(k.a)(Ya,
"CommentActivationManager",null,[919]);class Ea{constructor(){this.actionBehavior=this.actionType=0}}Object(k.a)(Ea,"CommentUIActionPayload",null,[]);var La=d(266);class xb{constructor(ea,Ka){this.w2b=(bb,vb,Yb,Gc,ud)=>{if(this.hHd.Ib(bb)){var Nd=this.hHd.ga(bb);if(!this.y5a.Ib(Nd))return 8;const Bc=this.y5a.ga(Nd);if(Bc.preCallback){const qe=Bc.preCallback(bb,vb,Yb,Gc,ud);if(2!==qe)return qe}if(!Bc.registeredCallback)return 1===Yb?8:2;Nd=Object.assign(new Ea,{actionType:Nd});1===Yb&&(Nd.actionBehavior=
1);Nd=Bc.registeredCallback(Nd);return Bc.postCallback?Bc.postCallback(Nd,bb,vb,Yb,Gc,ud):Nd?32:8}return 2};this.Ca=ea;this.y5a=Ka;this.hHd=new La.a;for(const bb of this.y5a)this.hHd.$(bb.value.canvasActionId,bb.key),ea=bb.value,ea.delayActionsUntilRegistration||this.xa(ea)}xa(ea){ea.withFlags?this.Ca.pa(ea.canvasActionId,ea.canvasContextId,this.w2b,97):this.Ca.xa(ea.canvasActionId,ea.canvasContextId,this.w2b)}Pza(ea,Ka){this.y5a.Ib(ea)&&(this.y5a.ga(ea).delayActionsUntilRegistration&&this.xa(this.y5a.ga(ea)),
this.y5a.ga(ea).registeredCallback=Ka)}}Object(k.a)(xb,"OfficeSharedCommentsActionHost",null,[774]);var dc=d(310),gb=d(36),gc=d(181);class Ac{}Object(k.a)(Ac,"CommentActivityData",null,[]);var $b=d(136),jc=d(72);class pb{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc,qe=null,qg=null){this.lJf={["CancelCommentCreateThreadAction"]:gb.a.cPh,["CommitComment"]:gb.a.dPh,["CommitDraftAction"]:gb.a.ePh,["CommitDraftCreateAction"]:gb.a.x9e,["CommitDraftEditAction"]:gb.a.z9e,["CommitDraftReplyAction"]:gb.a.w9e,["CreateReplyAction"]:gb.a.w9e,
["CreateReplyWithMentions"]:gb.a.fPh,["CreateReplyWithTaskAssigned"]:gb.a.gPh,["CreateThreadAction"]:gb.a.x9e,["CreateThreadWithMentions"]:gb.a.hPh,["CreateThreadWithTaskAssigned"]:gb.a.iPh,["DeletePostAction"]:gb.a.jPh,["DeleteThreadAction"]:gb.a.kPh,["DeleteThreadWithTask"]:gb.a.lPh,["DiscardDraftAsync"]:gb.a.mPh,["PresentLinkToCommentAction"]:gb.a.nPh,["ResolveThreadAction"]:gb.a.rPh,["ResolveThreadWithTask"]:gb.a.sPh,["ReopenThreadAction"]:gb.a.oPh,["ReopenThreadWithTask"]:gb.a.pPh,["RequestInitCommentSession"]:gb.a.qPh,
["SelectCommentAction"]:gb.a.tPh,["UpdateCommentBodyAction"]:gb.a.z9e};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=ea;this.appVersion=Ka;this.releaseAudience=bb;this.releaseChannel=vb;this.sessionId=Yb;this.ring=Gc;this.dataCenter=ud;this.disableUpload=Nd;this.sovereignEnvironmentName=qg;this.Ca=Bc;this.mCf=qe;this.Bak()}Bak(){this.Ca.xa(gb.a.cPh,jc.a.frame,
gc.ActionManager.uh);this.Ca.xa(gb.a.dPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.ePh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.w9e,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.fPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.gPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.x9e,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.hPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.iPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.jPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.kPh,
jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.lPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.mPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.nPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.rPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.sPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.oPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.pPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.qPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.tPh,jc.a.frame,gc.ActionManager.uh);this.Ca.xa(gb.a.z9e,
jc.a.frame,gc.ActionManager.uh)}sendULSTrace(ea,Ka,bb,vb){e.ULS.sendTraceTag(ea,Ka,bb,vb)}recordActivity(ea){this.lJf[ea]&&this.Ca.nb(this.lJf[ea],2)}sendOtelEvent(ea){$b.a.sendOtelEvent(ea)}recordPerfData(ea,Ka){this.mCf&&(ea=Object.assign(new Ac,{durationMs:Ka,name:ea}),this.mCf.mqa(ea))}}Object(k.a)(pb,"OfficeSharedCommentsTelemetry",null,[]);var $a=d(276);class zc{constructor(ea,Ka,bb,vb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ea;this.appLocale=
Ka;this.uiCulture=bb;this.dataCulture=vb}}Object(k.a)(zc,"LocalizationDetails",null,[]);var rb=d(255),ib=d(67),Vb=d(94);class Od{constructor(ea,Ka){this.vri=ea;this.qsf=Ka}getViewContainer(){return this.vri}registerForViewContainerEvents(ea){this.qsf.cyl(ea)}unregisterForViewContainerEvents(ea){this.qsf.pgm(ea)}}Object(k.a)(Od,"ViewContainerProvider",null,[488]);var jb=d(68),Wb=d(1264),qb=d(7),Ga=d(35),cb=d(28),Ob=d(250),Db=d(212),mb=d(27),Vc=d(180),Zb=d(650);class fc{static ukg(ea){return ea===fc.create?
0:ea===fc.reply?1:ea===fc.edit?2:ea===fc.metadata?3:null}}fc.create="CREATE";fc.reply="REPLY";fc.edit="EDIT";fc.metadata="METADATA";Object(k.a)(fc,"CommentSessionType",null,[]);class ob{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(k.a)(ob,"InitCommentSessionResult",null,[]);class ub extends ob{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(k.a)(ub,"BeginDraftingHostResult",ob,[]);
class bc{constructor(ea,Ka="",bb="",vb="",Yb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=ea;this.Provider=Ka;this.DisplayName=bb;this.Email=vb;this.IsCurrentUser=Yb}}Object(k.a)(bc,"OfficeSharedCommentUser",null,[]);var ic=d(46),Rc=d(54),Fb=d(123),Qb=d(30);class hc{constructor(ea,Ka,bb){this.Fr=ea;this.ZHk=Ka;this.bHk=bb;this.nRg=null;this.qYg=!1}get FTa(){return this.Fr}get FD(){return this.ZHk}get commentId(){return this.bHk}get Z9(){return this.nRg}set Z9(ea){this.nRg=
ea}get K8c(){return this.qYg}set K8c(ea){this.qYg=ea}}Object(k.a)(hc,"ActiveCommentSession",null,[]);var Pc=d(697);class uc{static get WWk(){return 50}static puj(ea){return uc.exj(ea)}static oIj(ea){if(""===ea)return"";let Ka=0,bb="";try{const vb=za.qig(ea);for(const Yb of vb.ops)if(uc.awa(Yb))Ka||(bb+=uc.ABj(Yb.attributes.atmention.fullName)),Ka+=1;else{const Gc=Yb.insert?Yb.insert:"";" "!==Gc&&0<Gc.length&&(Ka=0,bb+=Gc)}}catch(vb){e.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return bb}static exj(ea){ea=
uc.oIj(ea);return 0<ea.length&&ea.split(" ").length<=uc.WWk?ea:null}static ABj(ea){let Ka="";ea&&(ea=ea.split(" "),0<ea.length&&(Ka=ea[0]));return Ka}static awa(ea){return!!ea.attributes&&!!ea.attributes.atmention}}Object(k.a)(uc,"BaseCommentSmartReplyHelpers",null,[]);class zb{constructor(ea){this.iDe=ea}Mmm(ea,Ka,bb,vb){-1===bb||Ka||(Ka=vb[bb],bb=Ka.author?Ka.author.IsCurrentUser:!1,Ka&&Ka.commentBody&&!bb&&(Ka=uc.puj(Ka.commentBody))&&this.iDe.invoke(ea,Ka))}}Object(k.a)(zb,"CommentSmartReplyHelpers",
null,[]);var ac=d(55),Jb=d(76),Yc=d(33),dd=d(90),id=d(91),Cc=d(50);class Nb{constructor(){this.eLd=this.SVd=this.uRa=null;this.bug=!1;this.LCd=this.MCd=this.endPos=this.startPos=0}get paragraphs(){return this.uRa}get wW(){return this.SVd}set wW(ea){this.SVd=ea;this.uRa=[];this.uRa.push(this.SVd)}get d5(){return this.eLd}set d5(ea){this.eLd=ea;this.uRa&&this.cgc&&this.uRa.push(this.eLd)}mlj(){for(const ea of this.uRa){const Ka=Object(Wb.a)(5,ea);if(Ka&&-1!==Ka.bBb().indexOf("\ufffc"))return!0}return!1}tGg(ea){const Ka=
(this.LCd&4294967295)>>>0;ea.TextBodyLength!==this.MCd||Ka===ea.TextBodyHash||Nb.IIh.contains(this.LCd)||(Nb.IIh.add(this.LCd),mb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.mlj()));return ea.TextBodyLength===this.MCd}get lAh(){let ea=0;if(this.isValid)if(this.cgc){ea+=Yc.ParagraphReader.textLength(this.wW)-this.startPos;ea+=this.endPos;for(let Ka=1;Ka<this.paragraphs.length-1;Ka++){const bb=this.paragraphs[Ka];bb&&
(ea+=Yc.ParagraphReader.textLength(bb)+1)}}else ea=this.endPos-this.startPos;return ea}get sOa(){if(!this.isValid)return dd.a.auto;var ea=Cc.a.rk(this.wW,this.startPos+1);if(!ea)return dd.a.auto;ea=id.a.yt(ea);return ea?(ea=ea.cache)&&ea.y5?ea.fontColor:dd.a.auto:dd.a.auto}get isValid(){return!!this.wW&&!!this.d5&&!!this.paragraphs}get cgc(){return!this.wW.equals(this.d5)}qvi(ea){this.uRa&&ea&&this.uRa.push(ea)}Ick(){if(this.isValid&&(this.wW.Dw(16,!0),this.cgc))for(let ea=1;ea<this.paragraphs.length;ea++){const Ka=
this.paragraphs[ea];Ka&&Ka.Dw(16,!0)}}Agk(ea,Ka){if(!this.isValid)return!1;const bb=Object(Wb.a)(Jb.AParagraphNode,ea.node),vb=Object(Wb.a)(Jb.AParagraphNode,Ka.node);return!(bb&&vb&&Array.contains(this.paragraphs,bb)&&Array.contains(this.paragraphs,vb))||bb.equals(this.wW)&&(0>ea.Ra||ea.Ra<this.startPos)||vb.equals(this.d5)&&(0>Ka.Pb||Ka.Pb>this.endPos)?!1:!0}Jig(ea){let Ka=3;ea&&(!this.cgc&&this.wW.equals(ea)?Ka=2:this.wW.equals(ea)?Ka=0:this.d5.equals(ea)&&(Ka=1));return Ka}}Nb.IIh=new ia.a;Object(k.a)(Nb,
"TextAnchorParagraphInfo",null,[]);class nc{static Vzb(ea,Ka){return ea||Ka?ea&&Ka?ea.commentId===Ka.commentId:!1:!0}static AXc(ea){return!!ea.Children&&0<ea.Children.length}static GHj(ea,Ka){ea=ea.bBb()+"\r";for(let bb=0;bb<ea.length;bb++){let vb=ea.charCodeAt(bb);160===vb&&(vb=32);Ka=(Ka<<5>>>0)+Ka+vb}return Ka}static QO(ea){return!!ea&&!!ea.textAnchoringInfo&&ea.textAnchoringInfo.EndPos>ea.textAnchoringInfo.StartPos&&0<ea.textAnchoringInfo.TextBodyLength}static Bbc(ea,Ka){if(!nc.QO(ea))return null;
if(!Ka||1>Ka.aA().length)return mb.a.J(509220243,805,Ka?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!Ka),null;let bb=null,vb=null,Yb=null;ea.textAnchoringInfo.AnchoringShape&&(ea.textAnchoringInfo.AnchoringShape.TableCell?(bb=Q.a.Tf(ea.textAnchoringInfo.AnchoringShape.TableCell.RowId),vb=Q.a.Tf(ea.textAnchoringInfo.AnchoringShape.TableCell.ColId)):ea.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Yb=ea.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
Yb.startsWith("{")||(Yb="{"+Yb),Yb.endsWith("}")||(Yb+="}")));let Gc=ea.textAnchoringInfo.StartPos;ea=ea.textAnchoringInfo.EndPos;let ud=0,Nd=0;const Bc=new Nb;Ka=Ka.aA();for(let qg=0;qg<Ka.length;qg++){const Jf=Ka[qg],Bd=Yc.ParagraphReader.textLength(Object(Wb.a)(Jb.AParagraphNode,Jf));if(bb&&vb){var qe=Jf.xM();if(!qe||!bb.equals(qe.rowId)||!vb.equals(qe.cellId))continue}else if(Yb&&(!Jf.get_smartArtModelId()||Yb!==Jf.get_smartArtModelId()))continue;if(!Bc.isValid&&(Bd>Gc||Bc.wW)){if(!Bc.wW&&(Bc.wW=
Object(Wb.a)(Jb.AParagraphNode,Jf),Bc.startPos=Gc,!Bc.wW))return null;qe=qg===Ka.length-1||!!Yb&&nc.$lk(Yb,Ka[qg+1])||!!bb&&!!vb&&nc.Zlk(bb,vb,Ka[qg+1]);qe=Bd<ea&&0<Bd&&qe;if((Bd>=ea||qe)&&!Bc.d5){if(qe&&(ea=Bd),Bc.d5=Object(Wb.a)(Jb.AParagraphNode,Jf),Bc.endPos=ea,!Bc.d5)return null}else Jf.equals(Bc.wW)||Bc.qvi(Object(Wb.a)(Jb.AParagraphNode,Jf))}ud+=Bd+1;Nd=nc.GHj(Jf,Nd);Bc.wW||(Gc-=Bd+1);ea-=Bd+1}Bc.MCd=ud;Bc.LCd=Nd;return Bc}static $lk(ea,Ka){return Ka.get_smartArtModelId()&&Ka.get_smartArtModelId()===
ea?!1:!0}static Zlk(ea,Ka,bb){return(bb=bb.xM())&&ea.equals(bb.rowId)&&Ka.equals(bb.cellId)?!1:!0}static kPj(ea,Ka,bb,vb){bb=vb=-1;if(!ea)return mb.a.J(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,aOa:bb,FFa:vb};let Yb=Object(Wb.a)(5,Ka.Ua.node);const Gc=Object(Wb.a)(5,Ka.vf.node);if(!Yb||!Gc)return mb.a.J(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!Yb,!Gc),{returnValue:null,aOa:bb,FFa:vb};const ud=Ka.Ua.lSa,Nd=Ka.vf.gvb;var Bc=Yc.ParagraphReader.textLength(Ka.Ua.node);Ka=Yc.ParagraphReader.textLength(Ka.vf.node);if(0>ud||0>=Nd||ud===Nd&&Yb===Gc||ud>Bc||Nd>Ka)return mb.a.J(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",ud,Nd,Bc,Ka),{returnValue:null,aOa:bb,FFa:vb};ea=ea.aA();if(!ea)return mb.a.J(509220239,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,aOa:bb,FFa:vb};Bc=0;for(const qe of ea){if(Gc.get_smartArtModelId()){if(qe.get_smartArtModelId()!==Gc.get_smartArtModelId())continue;Yb.get_smartArtModelId()!==Gc.get_smartArtModelId()&&(Yb=qe)}if(Gc.Ft()){if(qe.xM()!==Gc.xM())continue;Yb.xM()!==Gc.xM()&&(Yb=qe)}Yb===qe&&(bb=ud+Bc);Gc===qe&&(vb=Nd+Bc);if(0<=bb&&0<=vb)return{returnValue:Yb,aOa:bb,FFa:vb};Bc+=qe.bBb().length+1}0<=
bb&&-1===vb&&(Yb.get_smartArtModelId()||Yb.Ft())&&(vb=Bc-1);return{returnValue:Yb,aOa:bb,FFa:vb}}static get iQc(){return ac.a.jg||ac.a.NXa}static get EXc(){return!ac.a.Aj}}Object(k.a)(nc,"CommentUtilities",null,[]);const Kc=(ea,Ka)=>{var bb,vb;if(null===ea||void 0===ea||!ea.ReactionList)return ea;for(const Yb in ea.ReactionList)ea.ReactionList[Yb].ReactionInstances=null===(vb=null===(bb=ea.ReactionList[Yb])||void 0===bb?void 0:bb.ReactionInstances)||void 0===vb?void 0:vb.filter(Gc=>Gc.User.UserId!=
Ka.UserId);ea.ReactionList=ea.ReactionList.filter(Yb=>0!=Yb.ReactionInstances.length);0==ea.ReactionList.length&&(ea.ReactionList=void 0);return ea},xd=ea=>ea.getBooleanAppSetting("PPTOCommentReactionsUIEnabled");class Xc{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc,qe,qg,Jf,Bd,Ld,sd,qd,Kd){this.Vgd=!1;this.jb=ea;this.TJa=Ka;this.FEe=bb;this.FFk=vb;this.zb=Yb;this.Lb=Gc;this.ald=ud;this.gHk=Nd;this.Rxa=Bc;this.iDe=qg;this.uIk=Jf;this.lxa=Bd;this.Mhd=Ld;this.$Gk=sd;this.ia=qd;this.Ba=Kd}beginDraftingAsync(ea){if(!ea)return new Promise((bb,
vb)=>{vb(E.a.fu(-2130915327))});const Ka=fc.ukg(ea.sessionType);return void 0===Ka||null===Ka?new Promise((bb,vb)=>{vb(E.a.fu(-2130915317))}):2===Ka&&ea.commentId===Xc.ELb?new Promise((bb,vb)=>{vb(E.a.fu(-2130915324))}):new Promise((bb,vb)=>{E.a.B9a(this.zb,()=>{this.Ba.L$&&!this.jb.Vl.isVisible&&this.jb.P3a();var Yb=this.jb.nje(),Gc=null;let ud=-1;mb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",Ka);try{switch(Ka){case 0:if(this.Mhd)try{ud=this.jb.okg(!0)}catch(qg){mb.a.J(512496832,
801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",qg),ud=Yb.length}else ud=Yb.length;Gc=new hc(Ka,ea,"");this.Vgd=!0;break;case 1:if(!ea.threadId||!ea.threadId.length)throw E.a.fu(-2130915324);ud=Xc.fDj(Yb,ea.threadId);if(-1===ud)throw E.a.fu(-2130915323);if(this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Nd=ea.threadId;(new zb(this.iDe)).Mmm(Nd,Xc.P0j(Yb,Nd),Xc.jie(Yb,Nd),Yb)}Gc=new hc(Ka,ea,ea.threadId);break;case 2:if(!ea.commentId||
!ea.commentId.length)throw E.a.fu(-2130915324);ud=Xc.jie(Yb,ea.commentId);if(-1===ud)throw E.a.fu(-2130915323);Gc=new hc(Ka,ea,ea.commentId);break;case 3:ud=Xc.jie(Yb,ea.threadId);Gc=new hc(Ka,ea,ea.threadId);break;default:throw E.a.fu(-2130915322);}if(!Gc)throw E.a.fu(-2130915322);var Bc=this.jb.z8j(Gc);if(Bc)throw Bc;}catch(qg){vb(qg);return}Yb=new ub;Gc=this.Lb.Ea("UserName");Bc=this.Lb.Ea("387");Nd=this.Lb.Ea("388");const qe=Qb.a("PPTPlumbEmailThroughCG")?Aa.a.nbb(Bc||""):"";Bc=new bc(Bc,Nd,Gc,
qe,!0);Yb.author=Bc;Yb.insertIndex=ud;Yb.authorName=Gc;Yb.authorIdentity=new String;bb(Yb)})})}commit(ea,Ka,bb){if(!this.jb.rUc)throw mb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.jb.IWi),E.a.fu(-2130915320);var vb=this.jb.rUc.FD;if(!vb)throw mb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),E.a.fu(-2130915320);const Yb=fc.ukg(vb.sessionType);if(void 0===Yb||null===Yb)throw E.a.fu(-2130915317);
if(ea!==vb.draftId)throw E.a.fu(-2130915327);const Gc=this.lxa?Fb.e(Q.a.create().toString()):"";this.jb.N5f();switch(Yb){case 0:return mb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",Gc),vb={},this.jb.QDl(Gc),vb.commentId=Gc,this.Vgd=!1,this.jb.ajh=Gc,Xc.NZh(bb),Xc.MZh(),this.createComment(Ka,vb,bb);case 1:return mb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",vb.threadId,Gc),ea={},ea.parentId=vb.threadId,ea.commentId=Gc,Xc.NZh(bb),Xc.MZh(),this.createComment(Ka,
ea,bb);case 2:return mb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",vb.commentId),bb={},bb.commentBody=Ka,this.qhm(vb.commentId,bb),ea;case 3:return mb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",vb.threadId),xd(this.Lb)?this.rhm(vb.threadId,bb):this.Q1h(vb.threadId,bb),vb.threadId;default:throw E.a.fu(-2130915322);}}endCommentSession(ea){mb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",ea);this.jb.endCommentSession(ea,this.Vgd?9:1);this.Vgd=
!1}createComment(ea,Ka,bb){const vb=this.ald.MDd(ea,new Date);let Yb="";this.lxa&&(Yb=ic.a.Ta(Ka.commentId)?Q.a.create().toString():Ka.commentId);let Gc=null;void 0!==bb&&null!==bb&&(Gc=this.ald.Sbm(Yb,bb.Task,ea));ea=this.jb.Kxd;if(bb=Ka.parentId?null:this.jb.lPj())ea=this.jb.ULl;this.TJa.wti(Yb,vb.plainText,Ka.parentId,ea,this.jb.anchorNode,vb.Xih,Gc,bb);return ic.a.Ta(Yb)?Xc.ELb:Yb}deleteComment(ea){if(ea===Xc.ELb)throw E.a.fu(-2130915327);mb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",
ea);this.TJa.deleteComment(ea)}selectComment(ea){this.Ba.L$&&!this.jb.Vl.isVisible&&this.jb.P3a();ea!==Xc.ELb&&this.jb.ria(ea,0,!1)}highlightComment(ea){ea!==Xc.ELb&&this.jb.tsi(ea)}P1h(ea,Ka,bb){const vb=Array.clone(this.jb.nje());var Yb=null;for(var Gc of vb)if(Gc.commentId===ea){Yb=Gc;break}if(!Yb)throw mb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),E.a.fu(-2130915323);(Gc=w.AFrameworkApplication.userName)&&0<Gc.length&&Gc!==Yb.author.DisplayName&&mb.a.J(512496794,
805,50,"Author of comment being edited is not the current user (isAnonymous={0})",w.AFrameworkApplication.jqb||w.AFrameworkApplication.YR);Gc=new Date;Yb=this.ald.MDd(Yb.commentBody,null).plainText;Ka=this.ald.MDd(Ka.commentBody,Gc);this.TJa.Xej(Ka.plainText,ea,Ka.Xih);bb||Yb!==Ka.plainText||this.FEe.xKh(vb,this.jb.bkh,Array.clone(this.jb.bmg()))}qhm(ea,Ka){if(ea===Xc.ELb)throw E.a.fu(-2130915327);Ka.commentBody&&(this.Lb.getBooleanAppSetting("896")?this.P1h(ea,Ka,!0):E.a.B9a(this.zb,()=>{this.P1h(ea,
Ka,!1)}))}rhm(ea,Ka){if(!((null===Ka||void 0===Ka?0:Ka.Resolve)||(null===Ka||void 0===Ka?0:Ka.Reaction)))throw E.a.fu(-2130915327);(null===Ka||void 0===Ka?0:Ka.Resolve)&&this.Q1h(ea,Ka);(null===Ka||void 0===Ka?0:Ka.Reaction)&&this.uhm(ea,Ka)}Q1h(ea,Ka){if(void 0===Ka.Resolve||null===Ka.Resolve)throw E.a.fu(-2130915327);const bb=Ka.Resolve.isResolved;let vb=bb?100:0;void 0!==Ka.Task&&null!==Ka.Task&&(vb=Ka.Task.completion);this.TJa.R1h(ea,bb?1:0,vb);bb&&this.jb.fPl()}uhm(ea,Ka){if(xd(this.Lb)){if(null==
(null===Ka||void 0===Ka?void 0:Ka.Reaction))throw E.a.fu(-2130915327);a:{switch(Ka.Reaction.reactionType){case 1:var bb="\ud83d\udc4d";break a;default:mb.a.J(509220244,805,50,"Unsupported reaction type")}bb=void 0}void 0!==bb&&(this.TJa.vhm(ea,bb,Ka.Reaction.isActive),this.jb.Q3k())}}setThreadResolvedState(ea,Ka){this.TJa.R1h(ea,Ka?1:0,Ka?100:0);Ka&&this.jb.U4f(ea)}selectFirstThreadInNextCommentContext(){this.jb.DLl()}selectLastThreadInPreviousCommentContext(){this.jb.GLl()}presentLinkToComment(ea){if(ea=
this.TJa.WMj(ea)){ea=JSON.stringify({["sId"]:ea.sid,["cId"]:ea.cid});var Ka={};Ka.nav=Pc.a(ea);Ka.mode="copy";mb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",ea);this.ia.Ia(gb.a.bfa,2,Ka)}else mb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(ea){this.$Gk.JFj().then(Ka=>{this.FEe.Zwl(ea,this.jb.nje(),this.jb.bkh,this.jb.isReadOnly,this.jb.bmg(),Ka,this.gHk.X9c)})}unregisterForCommentEvents(ea){this.FEe.Vgf(ea)}registerForAction(ea,Ka){this.FFk.Pza(ea,Ka);this.jb.gvl()}unregisterForAction(){}loadThreads(){mb.a.J(512496791,
805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(ea=>{w.AFrameworkApplication.fa.Ue(()=>{this.Rxa?this.Rxa.atMentionsEnabledAsync().then(Ka=>{ea(Ka);return null}):ea(!1)})})}resolveSupported(){return this.uIk}static fDj(ea,Ka){let bb=!1;for(let vb=0;vb<ea.length;vb++){if(bb&&ea[vb].commentId!==Ka&&ea[vb].parentId!==Ka)return vb;ea[vb].commentId===Ka&&(bb=!0)}return bb?ea.length:-1}static P0j(ea,Ka){let bb=!1;for(let vb=0;vb<ea.length;vb++)if(ea[vb].commentId===
Ka&&(bb=!0),bb&&ea[vb].parentId===Ka)return!0;return!1}static jie(ea,Ka){for(let bb=0;bb<ea.length;bb++)if(ea[bb].commentId===Ka)return bb;return-1}static MZh(){if(Qb.a("CommentsFpsIsEnabled"))try{const ea=Rc.a.instance.Ha("Common.ISystemInitiatedFeedback");ea&&ea.execute(Ka=>{Ka.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(ea){mb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",ea)}}static NZh(ea){if(Qb.a("CommentsTasksFpsIsEnabled")&&
ea&&ea.Task)try{const Ka=Rc.a.instance.Ha("Common.ISystemInitiatedFeedback");Ka&&Ka.execute(bb=>{bb.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(Ka){mb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",Ka)}}}Xc.ELb="temp-id";Object(k.a)(Xc,"CommentAPI",null,[1666,1667]);var Tb=d(197),he=d(318),re=d(705);class ee{constructor(ea,Ka,bb){this.osc=ea;this.commentId=Ka;this.state=bb}}Object(k.a)(ee,"CommentTextAnchorToHighlight",
null,[]);class Yf extends Sys.EventArgs{constructor(ea){super();this.aWl=ea}}Object(k.a)(Yf,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class ke{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc,qe){this.tbh=[];this.Zld=null;this.bAd=!1;if(!qe)throw Error.argumentNull("viewElementEventNotifier");this.Jc=Ka;this.oOe=this.noc=!1;this.xbd=ea;this.ERk=bb;this.rgb=this.nZa=null;this.Rl=vb;this.oa=Yb;this.ZYa=Gc;this.NIa=ud;this.Gga=Nd;this.cHk=Bc;this.UK=qe;this.Gga.q2e(this.cHk)}get OX(){return this.nZa&&
this.nZa.isConnected?this.nZa:null}get XSh(){return this.noc}Ixc(ea,Ka,bb=!1,vb=!1){const Yb=this.ERk.$J(ea);if(Yb)switch(Ka){case 0:Yb.display(bb,vb);this.nZa=ea;break;case 1:Yb.activate();this.rgb=ea;break;case 2:Yb.dismiss();this.nZa=null;break;case 3:this.OX&&this.OX===ea&&this.qab&&this.Vce(this.qab,ea)?Yb.display(nc.QO(this.qab),vb):Yb.dismiss();this.rgb=null;break;case 4:Yb.Icj(bb),this.nZa=ea}}lzd(ea){if(this.Jc&&this.Jc.Ic)switch(ea){case 0:this.Jc.Ic.highlight();this.noc=!0;break;case 2:this.Jc.Ic.W0h();
this.noc=!1;break;case 1:this.Jc.Ic.highlight();this.oOe=!0;break;case 3:this.Jc.Ic.W0h(),this.oOe=!1}}bVc(){this.xbd&&(this.noc?this.lzd(2):this.OX&&this.Ixc(this.OX,2),this.Tyb(null))}Vce(ea,Ka){if(!nc.QO(ea))return!0;ea=this.Rl.Zz();return Tb.a.any(ea,bb=>!nc.QO(bb)&&bb.anchorShape===Ka.get_shapeId())}D6e(ea,Ka,bb,vb=!1,Yb=!1){if(this.xbd&&ea&&(!vb||ke.izb(this.Rl.Zz(),ea))){vb=this.d$(ea);var Gc=this.OX!==vb&&!!this.OX;Gc&&this.oa.T9(this.OX);this.bVc();if(vb){const ud=nc.QO(ea);this.rgb===vb?
this.Vce(ea,vb)?this.Ixc(vb,4,ud,ud&&Gc):this.nZa=vb:this.Vce(ea,vb)?this.Ixc(vb,0,ud,bb&&Gc):this.nZa=vb;Ka=!!Ka&&Ka===ea.commentId;(ud||Ka)&&Yb||this.tMl(vb,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,ea.authorName,ea.dt.toDateString(),ea.dt.toLocaleTimeString()))}else this.lzd(0),this.Jc&&this.Jc.Ic&&this.Jc.Ic.gd&&this.Rxd(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Jc.Ic.gd.ve+1).toString(),this.Jc.Ic.gd.title));!Yb&&Gc&&this.oa.selectShape(this.OX,
!0,!1);this.Tyb(null)}}ssi(ea){if(this.xbd){var Ka=this.d$(ea);Ka?nc.QO(ea)?this.rgb=Ka:this.Ixc(Ka,1):this.lzd(1);this.Tyb(ea)}}EUc(){this.rgb&&this.Ixc(this.rgb,3);this.oOe&&!this.noc&&this.lzd(3);this.Tyb(null)}d$(ea){if(!ea)return null;try{return this.NIa.BZc(ea)}catch(Ka){return mb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",Ka),null}}Tyb(ea){const Ka=[];var bb=this.rgb;ea&&!bb&&(bb=this.OX);const vb=this.OX?this.OX:this.oa.Zn();vb||ea&&bb||
this.LZh(Ka);let Yb=null;const Gc=[];var ud=!1;if(nc.QO(ea)&&bb&&0<bb.aA().length&&(!this.qab||ea.commentId!==this.qab.commentId)){var Nd=nc.Bbc(ea,bb);Nd&&Nd.isValid&&(ud=he.a.Tf("{"+ea.commentId+"}{1}"),Ka.push(new ee(Nd,ud,1)),ud=!0,bb=this.NIa.ik(bb))&&(Gc.push(bb),(bb=bb.shapeNode)&&bb.ig&&(Yb=bb))}if(this.bAd||vb&&0<vb.aA().length)if(bb=this.Rl.Zz())for(var Bc of bb){if(!nc.QO(Bc)||!this.bAd&&Bc.anchorShape!==vb.get_shapeId()||ud&&Bc.commentId===ea.commentId)continue;Nd=this.bAd?this.d$(Bc):
vb;if(!Nd)continue;const qe=nc.Bbc(Bc,Nd);if(!qe||!qe.isValid)continue;let qg=5;(bb=!!this.qab&&Bc.commentId===this.qab.commentId)&&(qg=0);const Jf=he.a.Tf("{"+Bc.commentId+"}{1}");Ka.push(new ee(qe,Jf,qg));if(Nd=this.NIa.ik(Nd))Gc.push(Nd),Nd=Nd.shapeNode,!Yb&&Nd&&bb&&Nd.ig&&(Yb=Nd)}for(const qe of this.tbh)!qe||Array.contains(Gc,qe)||qe.shapeNode&&qe.shapeNode.ig||(qe.sve=!1,qe.Mq||!qe.Oo||qe.lz||qe.ZSb());ea=null;for(const qe of Gc)(Bc=qe.shapeNode)&&Bc.ig?(ea||(ea=Bc),Yb||vb!==Bc||(Yb=Bc)):(qe.sve=
!0,qe.Oo||(mb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),qe.eCd()));Yb||this.oa.UM()||!ea||(Yb=ea);this.tbh=Gc;this.UK.qpl(new Yf(Yb));this.LZh(Ka)}LZh(ea){ea=Object.assign(new re.a,{action:0,type:0,Ffa:ea,Klb:this.Gga.zfb?this.Gga.zfb.Ffa:null});this.Gga.yyd(ea)}Rxd(ea){this.ZYa.dia(ea)}tMl(ea,Ka){this.ZYa.CAh(ea,Ka)}y7e(ea){this.xbd=ea}get qab(){return this.Zld&&this.Zld.yQb?this.Zld.yQb.comment:null}static izb(ea,Ka){if(ea)for(const bb of ea)if(Ka.commentId===
bb.commentId)return!0;return!1}}Object(k.a)(ke,"CommentAnchoringHighlightsHelper",null,[]);var ef=d(41);class yf{constructor(ea,Ka,bb,vb,Yb,Gc,ud){this.Wb=ea;this.sa=Ka;this.mdd=bb;this.xP=vb;this.MRk=Yb;this.Db=Gc;this.zb=ud;this.Xxf=0}Y4a(ea,Ka){if(ea||1!==this.X9c)if(2>this.Wb.Hi())this.ysi?this.g8e(5):this.g8e(1);else{const bb=ef.a.Zj("UpdateNextPopulatedContextDetails",2);this.mdd.Qde((vb,Yb,Gc)=>{this.j5k(vb,Yb,Gc,bb,Ka)},bb)}}get X9c(){return this.Xxf}j5k(ea,Ka,bb,vb,Yb){let Gc=1;if(this.sa.Aa){const ud=
this.sa.Aa.ve;let Nd=!1,Bc=!1,qe=!1;Ka&&ea&&(ea=ea.ve,ea<ud?Nd=!0:ea===ud?Bc=!0:(qe=!0,bb||(Nd=!0)));0<=Yb&&(Yb<ud?Nd=!0:Yb===ud?Bc=!0:qe=!0);qe?Gc=Nd||Bc?3:2:Nd?Gc=4:Bc&&(Gc=5)}this.g8e(Gc);vb.finish();E.a.B9a(this.zb,()=>{this.Db.Gf()})}g8e(ea){this.Xxf=ea;this.MRk.Y4a(ea,1===this.Db.mode)}get ysi(){return!!this.sa.Aa&&this.xP.Udj(this.sa.Aa)}}Object(k.a)(yf,"CommentContextDetailsUpdateHelper",null,[1606]);var Rf=d(38);class Za{gPl(ea){if(null===ea)throw Error.argumentNull("comment");ea.setValue(Rf.a.commentId,
"")}cPl(ea,Ka){if(null===ea)throw Error.argumentNull("comment");ea.setValue(Rf.a.d5d,Ka)}ePl(ea){if(null===ea)throw Error.argumentNull("comment");if(ea=Object(Wb.a)(757,ea))ea.Mxb=ResourceStrings.anonymousCommentAuthor}hRb(ea){if(null===ea)throw Error.argumentNull("comment");ea.setValue(Rf.a.$5b,!0)}BLh(ea,Ka,bb,vb){if(null===ea)throw Error.argumentNull("comment");if(ea=Object(Wb.a)(757,ea))ea.authorName=Ka,ea.W3b=bb,ea.OPc=vb}iPl(ea,Ka){if(null===ea)throw Error.argumentNull("comment");ea.setValue(Rf.a.a6b,
Ka)}hPl(ea,Ka){if(!ea)throw Error.argumentNull("comment");Ka=Ga.c(Ka);ea.setValue(Rf.a.reactions,Ka)}}Object(k.a)(Za,"CommentEditor",null,[1665]);var Kb=d(32),Ic=d(82),Hc=d(58);class jd{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(k.a)(jd,"Comment",null,[]);var Id=d(297),ze=d(925),Ie=d(284),
Cd=d(29);class ue{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc,qe,qg,Jf,Bd,Ld,sd){this.nga=null;this.xGb=vb;this.Eb=Yb;this.sa=Gc;this.DC=ud;this.kaa=Nd;this.Lb=Bc;this.Ub=qe;this.oa=qg;this.sF=Jf;this.NDe=Bd;this.nc=Ld;this.zS=sd;this.ES=ea;this.aHk=bb;this.tIk=0===Ka;this.u1h();this.vAe()}dispose(){}get userName(){return this.Lb.appSettings.UserName}get userId(){return this.Lb.appSettings["387"]}get providerId(){return this.Lb.appSettings["388"]}get isTasksHistoryEnabled(){return this.Lb.getBooleanAppSetting("TasksHistoryEnabled")}get lec(){return this.Lb.getBooleanAppSetting("PPTOBlueDotsForComments")}get lDg(){return Qb.a("Comments.LogTasksTelemetry")}get RFa(){return this.Lb.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}addComment(ea,
Ka,bb){this.EJf("",ea,Ka,bb,null,null,null,null)}wti(ea,Ka,bb,vb,Yb,Gc,ud,Nd){this.EJf(ea,Ka,bb,vb,Yb,Gc,ud,Nd)}EJf(ea,Ka,bb,vb,Yb,Gc,ud,Nd){const Bc=this.ES.lj("UserAction","AddComment");w.AFrameworkApplication.fa.sY?this.GJf(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc):this.Lb.Ue(()=>{this.GJf(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc)})}GJf(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc){this.aHk.oyb().then(qe=>{ue.xIh&&(mb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.tIk,qe),this.sF.Dzk(qe),
ue.xIh=!1);this.vti(ea,Ka,bb,vb,Yb,Gc,ud,Nd);Bc&&Bc.stop();return qe}).catch(qe=>{mb.a.J(512262930,805,10,JSON.stringify(qe));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}vti(ea,Ka,bb,vb,Yb,Gc,ud,Nd){if(this.JDb()){var Bc=!1,qe=0,qg=0;vb&&(Bc=!0,qe=vb.x,qg=vb.y);vb=this.Eb.xe(15);try{var Jf=this.nga;vb.mc(Jf);const Bd=Kb.GraphIterator.ob(Jf),Ld=Object(Wb.a)(Ic.a,this.xGb.createInstance(1074135127));this.kaa.hRb(Ld);this.kaa.gPl(Ld);this.kaa.cPl(Ld,ea);
Jf=null;const sd=Object(Wb.a)(757,Ld);if(sd){if(sd.Oxb=Bc)sd.xea=Object.assign(new ze.a,{X:qe,Y:qg});sd.qYh=this.NDe.YPj();sd.JPc=Gc;if(Jf=Object(Wb.a)(4,Yb))sd.X5b=Jf.get_shapeId();bb&&(sd.tza=bb);ud&&(sd.taskInfo=ud);Nd&&(sd.textAnchoringInfo=Nd);sd.Uta=Ka}let qd=this.userId;Yb=!qd;const Kd=!this.providerId,Gk=!this.userName;(Yb||Kd)&&mb.a.J(512262928,805,Yb&&!Kd?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Yb,Kd,Gk);Qb.a("Comments.UseNameInPlaceOfUserId")&&Yb&&
!Kd&&(qd=Gk?ResourceStrings.anonymousCommentAuthor:this.userName);this.kaa.BLh(Ld,this.userName,qd,this.providerId);Gk&&this.kaa.ePl(Ld);Bd.$l(Ld,1);mb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",ea,!!ud,!!Nd,!!Jf)}finally{vb&&vb.dispose()}this.Oyk(ea,bb,Ka,Nd,ud)}else mb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}Oyk(ea,Ka,
bb,vb,Yb){this.lDg?Ka?(Ka=this.ova(Ka))?(Ka=this.iva(Ka))?this.sF.Pyk(ea,bb.length-1,!!vb,Ka.taskInfo,Yb):mb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):mb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.sF.Qyk(ea,bb.length-1,!!vb,!!Yb):this.sF.rAe(ea,bb.length-1,!!vb,!!Yb)}deleteComment(ea){this.sF.SDk();if(this.JDb()){var Ka=this.Eb.ud(15);try{Ka.mc(this.nga),this.U9d(ea,this.nga),
Ka.Wc=Cd.a.deleteComment}finally{Ka&&Ka.dispose()}}else mb.a.J(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}U9d(ea,Ka){Qb.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.oa.i1()&&(mb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.oa.Bh());const bb=this.bxj(ea,Ka);if(bb&&0<bb.count){this.kaa.hRb(Ka);for(const vb of bb)Ka=Kb.GraphIterator.ob(vb),Ka.uc(39),Ka.rj();mb.a.J(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",ea)}else mb.a.J(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",ea);this.sF.wul()}mUa(){const ea=Date.now();this.sF.Jzk();const Ka=this.Zz();if(Ka){var bb=this.Eb.ud(15);try{bb.mc(this.sa.Aa);for(const vb of Ka)this.U9d(vb.commentId,this.nga);bb.Wc=Cd.a.mUa}finally{bb&&bb.dispose()}mb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-ea)}else mb.a.J(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}G7b(ea){const Ka=Date.now();ea?this.sF.Kzk():this.sF.Izk();const bb=this.sa.presentation;if(bb){var vb=bb.slides;if(vb){var Yb=this.Eb.ud(15);try{Yb.mc(bb);for(const Gc of vb){const ud=Object(Wb.a)(205,Gc);if(!ud||!ud.fF()){mb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",ud);continue}const Nd=Kb.GraphIterator.ob(ud).Gb(16);for(const Bc of this.jva(ud.fF()))(ea?
1===Bc.status:1)&&this.U9d(Bc.commentId,Nd)}Yb.Wc=ea?Cd.a.Myb:Cd.a.Lyb}finally{Yb&&Yb.dispose()}mb.a.J(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-Ka,ea)}}}Xej(ea,Ka,bb){this.Wej(ea,Ka,bb)}Wej(ea,Ka,bb){if(this.JDb()){var vb=this.ova(Ka);if(vb){const Yb=this.Eb.xe(15);try{Yb.mc(vb);this.kaa.hRb(vb);const Gc=Object(Wb.a)(757,vb);Gc&&(Gc.Uta=ea,Gc.JPc=bb)}finally{Yb&&Yb.dispose()}mb.a.J(512262915,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",
Ka)}else mb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",Ka);this.sF.Pzk()}else mb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}rLb(ea,Ka){if(this.JDb()){var bb=this.ova(ea);if(bb){if(null===Ka)throw Error.argumentNull("pos");const vb=this.Eb.xe(15);try{vb.mc(bb),this.kaa.hRb(bb),Object(Wb.a)(757,bb).xea=Object.assign(new ze.a,{X:Ka.x,Y:Ka.y})}finally{vb&&vb.dispose()}mb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",
ea)}else mb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",ea);this.sF.OBk(ea)}else mb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}vhm(ea,Ka,bb){this.Lb.Ue(()=>{this.whm(ea,Ka,bb)})}whm(ea,Ka,bb){if(this.JDb()){var vb=this.ova(ea);if(vb){var Yb=this.Eb.xe(15);try{Yb.mc(vb);this.kaa.hRb(vb);const qe=Object(Wb.a)(757,vb);if(qe){var Gc=qe.reactions,ud={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,
UserId:this.userId};if(bb){let qg;qg=Kc(Gc,ud);a:{ea=qg;var Nd;const Jf={Time:new Date,User:ud};if(ea&&ea.ReactionList){for(const [Bd,Ld]of ea.ReactionList.entries())if(Ld.Type===Ka){null===(Nd=ea.ReactionList[Bd].ReactionInstances)||void 0===Nd?void 0:Nd.push(Jf);qg=ea;break a}ea.ReactionList.push({Type:Ka,ReactionInstances:[Jf]})}else ea={ReactionList:[{Type:Ka,ReactionInstances:[Jf]}]};qg=ea}var Bc=qg}else Bc=Kc(Gc,ud);this.kaa.hPl(vb,Bc)}else mb.a.J(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",
ea)}finally{null===Yb||void 0===Yb?void 0:Yb.dispose()}}else mb.a.J(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",ea)}else mb.a.J(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}R1h(ea,Ka,bb){if(this.JDb()){var vb=this.ova(ea);if(vb){const Yb=this.Eb.xe(15);try{Yb.mc(vb),this.kaa.hRb(vb),this.kaa.iPl(vb,Ka),Object(Wb.a)(757,vb).lpb=bb,this.isTasksHistoryEnabled&&this.kaa.BLh(vb,this.userName,
this.userId,this.providerId)}finally{Yb&&Yb.dispose()}if(this.lDg){bb=this.iva(vb);if(!bb){mb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===Ka?this.sF.qDk(!!bb.taskInfo):0===Ka&&this.sF.EEk(!!bb.taskInfo)}else 1===Ka&&this.sF.rDk();mb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",ea,Ka)}else mb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",ea)}else mb.a.J(512262882,
805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}Zz(){return this.jva(this.nga)}jva(ea){const Ka=[];if(!ea||39!==ea.type)return Ka;ea=Kb.GraphIterator.ob(ea);for(var bb=ea.sj();bb;){if(40===bb.type){const vb=Object(Wb.a)(757,bb).tza;bb=this.iva(bb);if(vb)for(const Yb of Ka)Yb.commentId===vb&&(Yb.Children||(Yb.Children=[]),Yb.Children.push(bb));else Ka.push(bb)}bb=ea.Up()}return Ka}u1h(){const ea=this.sa.Aa;this.nga=ea?Kb.GraphIterator.ob(ea).Gb(16):null}eCj(){if(!this.nga)return!1;
const ea=Kb.GraphIterator.ob(this.nga);if(this.DC.yhg(this.nga))return!0;let Ka=ea.sj();for(;Ka;){if(this.DC.yhg(Ka))return!0;Ka=ea.Up()}return!1}tnj(ea,Ka){return this.acg(ea,Ka,!1)}Fnj(ea,Ka){return this.acg(ea,Ka,!0)}acg(ea,Ka,bb){if(!ea)return null;if(ea=ea.fF()){ea=this.Ub.Pc(ea);let vb=bb?ea.Tbc():ea.sj();for(;vb;){if(!(this.DC.C8c(vb)||Ka&&0!==this.DC.i_c(vb)))return this.iva(vb);vb=bb?ea.Gva():ea.Up()}}return null}Udj(ea){return ea?(ea=ea.fF())?!!this.Ub.Pc(ea).sj():!1:!1}j_c(ea){if(!ea)return 0;
var Ka=ea.fF();ea=0;if(Ka){Ka=this.Ub.Pc(Ka);let bb=Ka.sj();for(;bb;)this.DC.C8c(bb)||ea++,bb=Ka.Up()}return ea}JDb(){return!!this.nga&&this.nga.isConnected}bxj(ea,Ka){Ka=Kb.GraphIterator.ob(Ka);var bb=Ka.sj();const vb=new n.a;for(;bb;){const Yb=this.DC.g_c(bb),Gc=Object(Wb.a)(757,bb).tza;ea!==Yb&&ea!==Gc||vb.add(bb);bb=Ka.Up()}return vb}ova(ea){const Ka=Kb.GraphIterator.ob(this.nga);let bb=Ka.sj();for(;bb;){const vb=this.DC.g_c(bb);if(ea===vb)return bb;bb=Ka.Up()}return null}gke(ea){ea=this.ova(ea);
if(!ea)return null;const Ka=Object(Wb.a)(757,ea).tza;return ic.a.Ta(Ka)?ea:this.ova(Ka)}iva(ea){if(Qb.a("GetCommentFromGraphNodeNullSafety")){var Ka=Object(Wb.a)(757,ea);if(!Ka)return null;var bb=new jd;bb.dt=Ka.d7b;bb.text=Ka.Uta;bb.status=this.DC.i_c(ea);bb.userId=Ka.W3b;bb.commentId=this.DC.g_c(ea);bb.authorName=Ka.authorName;bb.providerId=Ka.OPc;bb.anchorShape=Ka.X5b;bb.pos=Object.assign(new Id.a,{X:Ka.xea.X,Y:Ka.xea.Y});bb.taskInfo=Ka.taskInfo;bb.textAnchoringInfo=Ka.textAnchoringInfo;this.lec&&
(bb.changesData=Ka.changesData,bb.isUnread=this.zS.instance&&this.zS.instance.yAg(Ka));xd(this.Lb)&&(bb.reactions=Ka.reactions);return bb}if(ea){Ka=this.DC.g_c(ea);bb=new jd;const vb=Object(Wb.a)(757,ea);if(vb){bb.dt=vb.d7b;bb.anchorShape=vb.X5b;const Yb=vb.xea;bb.pos=Object.assign(new Id.a,{X:Yb.X,Y:Yb.Y});bb.text=vb.Uta;bb.authorName=vb.authorName;bb.userId=vb.W3b;bb.providerId=vb.OPc;this.lec&&(bb.changesData=vb.changesData,bb.isUnread=this.zS.instance&&this.zS.instance.yAg(vb));xd(this.Lb)&&(bb.reactions=
vb.reactions)}bb.status=this.DC.i_c(ea);bb.commentId=Ka;bb.taskInfo=Object(Wb.a)(757,vb).taskInfo;bb.textAnchoringInfo=Object(Wb.a)(757,vb).textAnchoringInfo;return bb}return null}dcb(ea){if(!ea)return[];const Ka=this.jva(ea.fF());if(!Ka||this.RFa&&!Ka.length){if(!Ka)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return Ka}Ka.sort((bb,vb)=>{var Yb=this.nc.Bke(ea,bb.anchorShape);Yb=Yb?Yb.gD:new Hc.a(0,0);var Gc=this.nc.Bke(ea,vb.anchorShape);Gc=Gc?Gc.gD:new Hc.a(0,
0);Yb.y+=bb.pos.Y;Gc.y+=vb.pos.Y;Yb.x+=bb.pos.X;Gc.x+=vb.pos.X;let ud=Yb.y-Gc.y;ud||(ud=Yb.x-Gc.x)||(ud=+bb.dt-+vb.dt);return ud});return Ka}WMj(ea){var Ka=this.sa.presentation;if(!Ka)return null;Ka=Ka.slides;if(!Ka)return null;for(const bb of Ka)if(Ka=Object(Wb.a)(Ie.a,bb))for(const vb of this.jva(Ka.fF())){if(ea===vb.commentId)return bb;if(vb.Children)for(const Yb of vb.Children)if(ea===Yb.commentId)return bb}return null}vAe(){let ea=0,Ka=0;var bb=this.sa.presentation;if(bb){var vb=bb.slides;if(vb){bb=
new n.a;for(const Yb of vb)if((vb=Object(Wb.a)(Ie.a,Yb))&&vb.fF())for(const Gc of this.jva(vb.fF()))nc.QO(Gc)?Ka+=1:Gc.textAnchoringInfo&&bb.add(Gc.commentId),ea+=1;this.sF.vAe(ea,Ka,bb)}}}}ue.xIh=!0;Object(k.a)(ue,"CommentManager",null,[1663,1664,106]);var Ee=d(135);class Xe{constructor(ea,Ka,bb,vb){this.xP=ea;this.Jc=Ka;this.yb=bb;this.Cc=vb}bMj(ea){if(null===ea)throw Error.argumentNull("comment");if(ea=this.BZc(ea))if(ea=this.ik(ea))return ea.va.va;return null}nuj(ea){if(null===ea)throw Error.argumentNull("comment");
if(ea=this.BZc(ea)){if(ea.vd){var Ka=this.Cc.XO(ea);if(!Ka)return mb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",ea.get_shapeId()),null;Ka=Ka.sc(this.yb.Na);return Ka&&Ka.htmlElement?Ee.a.jfa(new Sys.UI.Bounds(Ka.htmlElement.clientLeft,Ka.htmlElement.clientTop,Ka.htmlElement.clientWidth,Ka.htmlElement.clientHeight)):(mb.a.J(595133521,805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",ea.get_shapeId()),null)}if(ea=
this.ik(ea))return ea=ea.va.va,Ee.a.jfa(new Sys.UI.Bounds(ea.clientLeft,ea.clientTop,ea.clientWidth,ea.clientHeight))}return null}BZc(ea){if(null===ea)throw Error.argumentNull("comment");if(!ea.anchorShape)return null;ea=this.xP.gke(ea.commentId);ea=this.xP.iva(ea);if(!ea)return null;const Ka=this.Jc.Ic?this.Jc.Ic.gd:null;return Ka?Ka.KD(ea.anchorShape):(mb.a.J(557090388,805,50,"ActiveSlide is null"),null)}ouj(ea){if(null===ea)throw Error.argumentNull("comment");if(!ea.anchorShape)return 0;if(ea=
this.BZc(ea))if(ea=this.ik(ea))return ea.rotation;return 0}ik(ea){if(null===ea)throw Error.argumentNull("shapeNode");return Object(Wb.a)(178,ea.sc(this.yb.Na))}}Object(k.a)(Xe,"CommentMarkerAnchorHelper",null,[1601]);var Sd=d(593),ad=d(115);class af{constructor(ea,Ka,bb){this.raa=ea;this.Jc=Ka;this.gDe=bb}Tdj(ea){const Ka=Object(Wb.a)(757,this.gDe.ova(ea.commentId));if(!Ka)throw e.ULS.sendTraceTag(508360530,805,10,"There is no graph node for comment {0}",ea.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");
return!!Ka.xea}$Jj(ea,Ka){if(!ea)throw Error.argumentNull("commentMarkerViewElement");if(!Ka)throw Error.argumentNull("comment");if(!this.gDe.ova(Ka.commentId))return e.ULS.sendTraceTag(508360529,805,10,"GetRenderingPosition: There is no graph node for comment {0}",Ka.commentId),new Hc.a(0,Number.MIN_VALUE);const bb=ea.Ko;ea=ea.Wqd;if(!this.Tdj(Ka)||!Ka.pos.X&&!Ka.pos.Y){if(bb)return Ka=new Hc.a(bb.lc-bb.oc-af.Vwd.width-af.tIh.width,af.tIh.height),af.stg(Ka,bb,ea),Ka;if(this.Jc.Ic&&this.Jc.Ic.Oy)return new Hc.a(this.Jc.Ic.Oy.clientWidth-
af.Vwd.width,0);e.ULS.sendTraceTag(508360528,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new Hc.a(0,0)}Ka=new Hc.a(this.raa.Ve(Ka.pos.X,0),this.raa.Ve(Ka.pos.Y,1));Ka=new Hc.a(Ka._x-af.P2a._x,Ka._y-af.P2a._y);bb&&(Ka._x=Math.max(0,Ka._x),Ka._y=Math.max(0,Ka._y),Ka._x=Math.min(Ka._x,bb.lc-bb.oc-af.Vwd.width),Ka._y=Math.min(Ka._y,bb.jc-bb.pc-af.Vwd.height),af.stg(Ka,bb,ea));return Ka}shm(ea,Ka){var bb=new Hc.a(ea.element.offsetLeft,
ea.element.offsetTop);bb=new Hc.a(bb._x+af.P2a._x,bb._y+af.P2a._y);const vb=ea.Ko;vb&&ea.Wqd%360&&af.TOf(bb,0-ea.Wqd,vb.ng());Ka.pos.X=this.raa.Cf(bb._x,0);Ka.pos.Y=this.raa.Cf(bb._y,1);this.gDe.rLb(Ka.commentId,new Hc.a(Ka.pos.X,Ka.pos.Y))}static stg(ea,Ka,bb){if(Ka&&bb%360){var vb=new Hc.a(ea._x+af.P2a._x,ea._y+af.P2a._y);af.TOf(vb,bb,Ka.ng());ea.update(vb._x-af.P2a._x,vb._y-af.P2a._y)}}static TOf(ea,Ka,bb){ea.BN(0-bb._x,0-bb._y);Ka=Sd.a.O9d(Ka);ea.update(ea._x*Math.cos(Ka)-ea._y*Math.sin(Ka)+bb._x,
ea._x*Math.sin(Ka)+ea._y*Math.cos(Ka)+bb._y)}}af.Vwd=new ad.a(20,20);af.tIh=new ad.a(4,4);af.P2a=new Hc.a(4,20);Object(k.a)(af,"CommentMarkerPositionHelper",null,[1602]);var pf=d(142),xf=d(78),gf=d(48);class me{constructor(ea,Ka){this.NKa=this.bKa=this.cMe=null;this.Gic=ea;this.Gr=Ka}Ew(){return!0}Qv(ea){if(!ea)return!1;this.NKa=this.Gic.element.style;this.cMe=new Hc.a(ea.clientPoint.x,ea.clientPoint.y);this.bKa=new Hc.a(parseInt(this.NKa.left),parseInt(this.NKa.top));this.Px(ea);return!0}Px(ea){if(!ea)return!1;
ea=this.Elg(new Hc.a(ea.clientPoint.x,ea.clientPoint.y),this.cMe);this.NKa.left=gf.a.Rc(this.bKa._x+ea._x);this.NKa.top=gf.a.Rc(this.bKa._y+ea._y);return!0}Uo(ea){if(ea){ea=this.Elg(new Hc.a(ea.clientPoint.x,ea.clientPoint.y),this.cMe);var Ka=this.bKa._x+ea._x,bb=this.bKa._y+ea._y,vb=this.Gic.Ko;vb&&(Ka=Math.max(vb.oc,Ka),Ka=Math.min(vb.lc-this.Gic.element.clientWidth,Ka),bb=Math.max(vb.pc,bb),bb=Math.min(vb.jc-this.Gic.element.clientHeight,bb),ea._x=Ka-this.bKa._x,ea._y=bb-this.bKa._y);this.NKa.left=
gf.a.Rc(Ka);this.NKa.top=gf.a.Rc(bb);this.Gic.Zhh(ea)}}rv(){this.NKa.left=gf.a.Rc(this.bKa._x);this.NKa.top=gf.a.Rc(this.bKa._y)}Elg(ea,Ka){ea=Hc.a.nT(ea,Ka);return new Hc.a(this.Gr.Tm(ea.x),this.Gr.Tm(ea.y))}}Object(k.a)(me,"CommentMarkerDragAdapter",null,[363]);class ag{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd){this.uaa=null;this.vZa=this.wZa=!1;if(!Ka)throw Error.argumentNull("parentElement");this.fHb=Nd;this.jaa=ea;this.Vq=bb;this.coa=vb;this.ZD=Yb;this.Ycd=ud;this.qn=document.createElement("div");
this.qn.className=nc.AXc(ea)?this.ZD.tgh:this.ZD.sgh;this.qn.title=ResourceStrings.L_CommentMarkerTooltip;this.qn.style.display=this.Ycd||this.fHb?"none":"block";this.qn.setAttribute("data-pptcommentid",String.format("{0}",ea.commentId));this.gB=document.createElement("img");this.gB.alt=ResourceStrings.L_CommentMarkerTooltip;this.gB.src=bb.frame.Ok(bb.frame.yU+".png");this.gB.setAttribute(pf.a.Ff,pf.a.jx);this.qn.appendChild(this.gB);this.R4a();this.frame.hd.xb(ib.a.click,this.qn,Object(qb.a)(this,
this.xD,"clickHandler"));nc.EXc&&(Vb.a.addHandler(this.qn,ib.a.Wq,Object(qb.a)(this,this.Oya,"mouseOverHandler")),Vb.a.addHandler(this.qn,ib.a.Rt,Object(qb.a)(this,this.Vpc,"mouseOutHandler")));nc.iQc&&Vb.a.addHandler(this.gB,ib.a.mouseDown,Object(qb.a)(this,this.Jtc,"preventNativeDragMouseDownHandler"));Ka.appendChild(this.qn);Gc||this.F7d()}dispose(){this.gB&&(nc.iQc&&Vb.a.removeHandler(this.gB,ib.a.mouseDown,Object(qb.a)(this,this.Jtc,"preventNativeDragMouseDownHandler")),this.frame.hd.Hb(ib.a.click,
this.qn,Object(qb.a)(this,this.xD,"clickHandler")),this.gB.parentNode&&this.gB.parentNode.removeChild(this.gB),this.gB=null);this.qn&&(nc.EXc&&(Vb.a.removeHandler(this.qn,ib.a.Wq,Object(qb.a)(this,this.Oya,"mouseOverHandler")),Vb.a.removeHandler(this.qn,ib.a.Rt,Object(qb.a)(this,this.Vpc,"mouseOutHandler"))),this.coa&&(this.coa.S3d(),this.coa.dG(this.qn,this.uaa)),this.qn.parentNode&&this.qn.parentNode.removeChild(this.qn));this.Vq=this.jaa=null}get comment(){return this.jaa}get element(){return this.qn}get frame(){return this.Vq.frame}F7d(){this.coa&&
(this.uaa=new me(this,Rc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.coa.dL(this.qn,this.uaa))}updatePosition(ea){this.qn.style.left=gf.a.Rc(ea._x-(this.Vq.isRightToLeft?this.ZD.NQe:0));this.qn.style.top=gf.a.Rc(ea._y)}Zhh(ea){this.Vq.rLb(this.jaa,ea)}select(ea){this.wZa=ea;this.R4a()}activate(ea){this.vZa=ea;this.R4a()}BRh(){}setVisibility(ea){this.qn.style.display=ea&&!this.fHb?"block":"none"}R4a(){this.fHb||(this.gB.className=nc.AXc(this.jaa)?this.wZa?xf.getImageClassWithCluster(this.frame.yU,
this.ZD.wgh):this.vZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.ugh):xf.getImageClassWithCluster(this.frame.yU,this.ZD.vgh):this.wZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.rgh):this.vZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.MQe):xf.getImageClassWithCluster(this.frame.yU,this.ZD.wpc))}get Ko(){return null}get Wqd(){return 0}xD(ea){if(ea.xB!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.jaa,null,!1,!0,ea.wg,1,!1);ea=ea.hc;ea.preventDefault();ea.stopPropagation();
return!0}Oya(){this.frame.dvb(this.jaa,1)}Vpc(){this.frame.dvb(null,1)}Jtc(ea){ea.preventDefault()}}Object(k.a)(ag,"LegacyCommentMarkerViewElement",null,[1680]);var de=d(99),wa=d(655);class ta{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc,qe){this.uaa=null;this.GRg=this.vZa=this.wZa=!1;if(!Ka)throw Error.argumentNull("parentElement");this.CI=Nd;this.jaa=ea;this.Vq=bb;this.coa=vb;this.ZD=Yb;this.NIa=Gc;this.vbd=ud;this.Ycd=qe;this.qn=document.createElement("div");this.qn.className=nc.AXc(ea)?this.ZD.tgh:
this.ZD.sgh;Sys.UI.DomElement.addCssClass(this.qn,"CommentMarker");this.qn.title=ResourceStrings.L_CommentMarkerTooltip;this.qn.style.display="none";this.qn.setAttribute("data-pptcommentid",String.format("{0}",ea.commentId));this.gB=document.createElement("img");this.gB.alt=ResourceStrings.L_CommentMarkerTooltip;this.gB.src=bb.frame.Ok(bb.frame.yU+".png");this.gB.setAttribute(pf.a.Ff,pf.a.jx);this.qn.appendChild(this.gB);this.R4a();this.frame.hd.xb(ib.a.click,this.qn,Object(qb.a)(this,this.xD,"clickHandler"));
nc.EXc&&(Vb.a.addHandler(this.qn,ib.a.Wq,Object(qb.a)(this,this.Oya,"mouseOverHandler")),Vb.a.addHandler(this.qn,ib.a.Rt,Object(qb.a)(this,this.Vpc,"mouseOutHandler")));nc.iQc&&Vb.a.addHandler(this.gB,ib.a.mouseDown,Object(qb.a)(this,this.Jtc,"preventNativeDragMouseDownHandler"));Ka.appendChild(this.qn);Bc||this.F7d()}dispose(){this.gB&&(nc.iQc&&Vb.a.removeHandler(this.gB,ib.a.mouseDown,Object(qb.a)(this,this.Jtc,"preventNativeDragMouseDownHandler")),this.frame.hd.Hb(ib.a.click,this.qn,Object(qb.a)(this,
this.xD,"clickHandler")),this.gB.parentNode&&this.gB.parentNode.removeChild(this.gB),this.gB=null);this.qn&&(nc.EXc&&(Vb.a.removeHandler(this.qn,ib.a.Wq,Object(qb.a)(this,this.Oya,"mouseOverHandler")),Vb.a.removeHandler(this.qn,ib.a.Rt,Object(qb.a)(this,this.Vpc,"mouseOutHandler"))),this.coa&&(this.coa.S3d(),this.coa.dG(this.qn,this.uaa)),this.qn.parentNode&&this.qn.parentNode.removeChild(this.qn));this.Vq=this.jaa=null}get comment(){return this.jaa}get element(){return this.qn}get frame(){return this.Vq.frame}F7d(){this.coa&&
(this.uaa=new me(this,Rc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.coa.dL(this.qn,this.uaa))}updatePosition(){const ea=this.vbd.$Jj(this,this.comment);this.qn.style.left=ea._x+"px";this.qn.style.top=ea._y+"px"}Zhh(){this.vbd.shm(this,this.comment)}select(ea){this.wZa=ea;this.R4a();this.onVisibilityChange()}activate(ea){this.vZa=ea;this.R4a();this.onVisibilityChange()}BRh(ea){this.GRg=ea;this.R4a();this.onVisibilityChange()}setVisibility(ea){this.Ycd=!ea;this.onVisibilityChange()}onVisibilityChange(){!this.Ycd&&
(this.wZa||this.vZa||this.GRg)?(this.updatePosition(this.frame.SEa(this.comment.pos.X,this.comment.pos.Y)),this.qn.style.display="block",de.a.RJ(this.qn,wa.a.ySc)):(this.qn.style.display="none",de.a.SMa(this.qn,wa.a.ySc))}get Ko(){return this.NIa.nuj(this.jaa)}get Wqd(){return this.NIa.ouj(this.jaa)}R4a(){this.gB.className=nc.AXc(this.jaa)?this.wZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.wgh):this.vZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.ugh):xf.getImageClassWithCluster(this.frame.yU,
this.ZD.vgh):this.wZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.rgh):this.vZa?xf.getImageClassWithCluster(this.frame.yU,this.ZD.MQe):xf.getImageClassWithCluster(this.frame.yU,this.ZD.wpc)}xD(ea){if(ea.xB!==Sys.UI.MouseButton.leftButton)return!1;this.CI&&!this.frame.Vl.isVisible&&this.frame.P3a();this.frame.selectComment(this.jaa,null,!1,!0,ea.wg,1,!1);ea=ea.hc;ea.preventDefault();ea.stopPropagation();return!0}Oya(){this.gB.className=xf.getImageClassWithCluster(this.frame.yU,this.ZD.MQe)}Vpc(){this.gB.className=
xf.getImageClassWithCluster(this.frame.yU,this.ZD.wpc)}Jtc(ea){ea.preventDefault()}}Object(k.a)(ta,"ModernCommentMarkerViewElement",null,[1680]);class Eb{constructor(ea,Ka,bb,vb,Yb,Gc,ud){this.NIa=ea;this.vbd=Ka;this.ZD=bb;this.Njc=Yb;this.fHb=Gc;vb.oyb().then(Nd=>{Nd||this.W8e(!1);this.CI=ud})}dispose(){this.ZD=null}create(ea,Ka,bb,vb,Yb,Gc){if(this.Njc){const ud=this.NIa.bMj(ea);return new ta(ea,ud||Ka,bb,vb,this.ZD,this.NIa,this.vbd,this.CI,Yb,Gc)}return new ag(ea,Ka,bb,vb,this.ZD,Yb,Gc,this.fHb)}W8e(ea){this.fHb=
this.Njc=ea;this.ZD.W8e(ea)}}Object(k.a)(Eb,"CommentMarkerViewElementFactory",null,[1603,106]);var qc=d(75);class Sc extends qc.a{constructor(){super()}XAi(ea){this.addHandler(Sc.HUh,ea)}Hjh(){this.raiseEvent(Sc.HUh)}}Sc.HUh="S";Object(k.a)(Sc,"ATransactionCompletedProcessor",qc.a,[1679]);var td=d(40);class je extends Sc{constructor(ea,Ka,bb){super();this.fUk=ea;this.Gdd=Ka;this.YY=bb}get index(){return 0}Lh(){this.fUk()}VYf(ea,Ka){Ka.property!==Rf.a.xea&&Ka.property!==Rf.a.Uta&&Ka.property!==Rf.a.commentId&&
Ka.property!==Rf.a.$5b&&Ka.property!==Rf.a.a6b&&Ka.property!==Rf.a.pAc&&Ka.property!==Rf.a.oAc&&Ka.property!==Rf.a.reactions||this.Hjh()}GYf(ea,Ka){Ka.property!==td.a.mC&&Ka.property!==Rf.a.$5b||this.Hjh()}f5j(){this.Gdd.Cd(39).Ak(Object(qb.a)(this,this.GYf,"commentContentPropertyChanged"));this.Gdd.Cd(40).Ak(Object(qb.a)(this,this.VYf,"commentPropertyChanged"));this.YY.COl(this)}nfm(){this.Gdd.Cd(40).tn(Object(qb.a)(this,this.VYf,"commentPropertyChanged"));this.Gdd.Cd(39).tn(Object(qb.a)(this,this.GYf,
"commentContentPropertyChanged"))}}Object(k.a)(je,"CommentPropertyTracker",Sc,[]);var Te=d(385),Hd=d(134);class mg extends Te.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new Hd.a,{T_:mg.getTypeName(),B_:mg.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(k.a)(mg,"CommentSmartReplySignal",Te.a,[]);var fg=d(491);class $e extends fg.a{constructor(){super();this.DomainName=
this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Hd.a,{T_:$e.getTypeName(),B_:$e.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(k.a)($e,"SmartReply",fg.a,[]);var oj=d(252),Me=d(267);class we{constructor(ea,Ka){this.Fbi=ea;this.eof=Ka}initialize(){this.eof.execute(ea=>{const Ka=$e.getTypeName();ea.aM(Ka);ea.Z2(Ka,Object(qb.a)(this,this.FM,"handleAnnotationEvent"))})}invoke(ea,
Ka){const bb=Object.assign(new oj.a,{parentPath:["Signal",mg.getTypeName()],items:[Object.assign(new Me.a,{body:Object.assign(new mg,{commentId:ea,comment:Ka})})]});this.eof.execute(vb=>{vb.submitOperation(bb)})}FM(ea){if(ea){var Ka=new n.a;if(ea&&ea.CommentId&&ea.ResultSets&&0<ea.ResultSets.length&&ea.ResultSets[0].Documents&&0<ea.ResultSets[0].Documents.length){for(const bb of ea.ResultSets[0].Documents)Ka.add(bb.Caption);0<Ka.count&&this.Fbi.zhl(ea.CommentId,Ka.toArray())}else mb.a.J(557593412,
327,10,"Invalid response from SmartReplies request")}else mb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(k.a)(we,"CommentSmartReplyProvider",null,[]);var Zc=d(317),te=d(288),ne=d(308),Zf=d(98),cd=d(182),aj=d(109),Qc=d(57),Mc=d(525);class Ig{constructor(ea,Ka,bb,vb,Yb){this.jDe=this.ZDe=this.yEe=this.Bad=0;this.jOg=new n.a;this.rPe=this.xOg=this.lDe=this.Gnc=this.CLe=0;this.fNe=new n.a;this.CBe=this.BBe=this.DBe=this.ABe=0;this.jMg=new n.a;this.Djd=new n.a;this.XDe=
this.VDe=this.WDe=this.YDe=this.AIe=this.zIe=this.BIe=this.CIe=0;this.Fad=this.wHe=this.ybd=cb.App.Xn;this.o_a=null;this.mPe=this.nPe=this.Ikd=this.jld=this.Rid=this.zBe=0;if(!ea)throw Error.argumentNull("coreEventHandler");if(!Ka)throw Error.argumentNull("appSettingsManager");this.Nc=ea;this.Lb=Ka;this.sa=bb;this.DC=vb;this.eDe=Yb;this.Nc.bC(Object(qb.a)(this,this.mo,"onSessionRehydrated"));this.Nc.aC(Object(qb.a)(this,this.KF,"onSessionEnd"))}get V5d(){return this.Lb.getBooleanAppSetting("CommentTextAnchoringCreateNewEnabled")}get g9l(){return this.Lb.getBooleanAppSetting("TasksForCommentsEnabled")}rAe(ea,
Ka,bb,vb){this.Bad+=1;this.jDe+=Ka;bb&&(this.ABe+=1,this.fNe.add(ea));vb&&(this.zBe+=1)}Qyk(ea,Ka,bb,vb){this.Ikd=vb?this.Ikd+1:this.Ikd;this.rAe(ea,Ka,bb,vb)}Pyk(ea,Ka,bb,vb,Yb){(Yb=!!Yb)&&vb?this.nPe+=1:Yb&&(this.mPe+=1);this.rAe(ea,Ka,bb,Yb)}hEk(){this.DBe+=1}eEk(){this.BBe+=1}fEk(){this.CBe+=1}gEk(ea,Ka,bb,vb){this.VCg(ea.commentId)||(bb&&!this.Yrk(Ka,bb.aA(),vb)?this.PKg(ea,bb,!0):this.PKg(ea,bb,!1))}wul(){this.ZDe+=1}SDk(){this.YDe+=1}Jzk(){this.WDe+=1}Izk(){this.VDe+=1}Kzk(){this.XDe+=1}Pzk(){this.yEe+=
1}OBk(ea){this.jOg.contains(ea)||(this.CLe+=1,this.jOg.add(ea))}qDk(ea){this.Rid=ea?this.Rid+1:this.Rid;this.Gnc+=1}EEk(ea){this.jld=ea?this.jld+1:this.jld}rDk(){this.Gnc+=1}vAe(ea,Ka,bb){this.lDe=ea;this.rPe=Ka;this.jMg=bb;this.uKg()}Dzk(ea){this.xOg=ea?1:2}M3k(ea){this.ybd===cb.App.Xn&&(this.ybd=new Date,this.vIa("OnCollabCornerCommentsEnabled",this.ybd,ea),this.T6e("CollabCornerCommentsEnabled",this.ybd))}n5k(ea){this.wHe===cb.App.Xn&&(this.wHe=new Date,this.vIa("OnFloatingCommentsRendered",this.wHe,
ea))}G2k(ea){this.Fad===cb.App.Xn&&(this.Fad=new Date,this.vIa("OnAllFloatingContainersVisible",this.Fad,ea),this.T6e("AllFloatingContainersVisible",this.Fad))}k4k(ea){const Ka=new Date;this.vIa("OnDeepLinkedCommentSelected",Ka,ea);this.T6e("DeepLinkedCommentSelected",Ka)}VCg(ea){return this.jMg.contains(ea)||this.Djd.contains(ea)}Yrk(ea,Ka,bb){let vb=0;for(const Gc of Ka)if(Ka=Object(Wb.a)(214,Gc.sc(bb))){Ka=Ka.htmlElement.getElementsByClassName(Zf.a.h7b);for(let ud=0;ud<Ka.length;ud++){var Yb=Ka[ud];
const Nd=Zc.a.Ie(Yb,Zf.a.T5d);Nd&&(vb+=Tb.a.contains(Nd,ea)?1:0);(Yb=Zc.a.Ie(Yb,Zf.a.P5d))&&(vb+=Tb.a.contains(Yb,ea)?1:0);if(2===vb)return!0}}return!1}PKg(ea,Ka,bb){if(ea&&ea.textAnchoringInfo&&!this.VCg(ea.commentId))if(ea.textAnchoringInfo.EndPos<=ea.textAnchoringInfo.StartPos){if(Ka){if(bb){this.AIe+=1;this.Djd.add(ea.commentId);return}this.BIe+=1}else this.CIe+=1;this.Djd.add(ea.commentId)}else 0>=ea.textAnchoringInfo.TextBodyLength&&(this.fNe.contains(ea.commentId)?this.fNe.remove(ea.commentId):
(this.zIe+=1,this.Djd.add(ea.commentId)))}vIa(ea,Ka,bb){const vb={};vb.Event=ea;vb.Time=Ka.getTime();vb.SlideId=bb.toString();vb.LandingSlide=this.TDj();vb.SessionDimensions=this.tke();vb.PerfMetrics=this.Cuj();vb.CommentPerfMetrics=this.dxj();vb.CommentFileType=this.eDe;vb.CommentDeepLinkedOpen=!!this.Lb.Ea("CurrentCommentId");vb.StandaloneCommentJsEnabled=!0;vb.LoadSharedCommentsEarly=!0;vb.FetchFullAppSettingsOnBoot=!0;vb.PrefetchCommentCloudPolicy=this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",
!1);mb.a.J(509703831,805,15,Ga.c(vb))}uKg(){mb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.lDe,this.eDe);mb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.rPe);mb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.V5d,this.g9l)}log(){mb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.Bad,
this.yEe,this.ZDe,this.jDe/this.Bad,this.CLe,this.Gnc,this.lDe,this.eDe,this.xOg);mb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.rPe,this.ABe,this.DBe,this.BBe,this.CBe,this.BIe,this.zIe,this.CIe,this.AIe);mb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.YDe,this.WDe,this.VDe,this.XDe);
this.cEk()}cEk(){mb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.zBe);const ea={};ea.ResolvedTasksCount=this.Rid;ea.UnresolvedTasksCount=this.jld;ea.TasksCreatedNewThreadCount=this.Ikd;ea.TasksReassignedInReplyCount=this.nPe;ea.TasksCreatedInReplyCount=this.mPe;mb.a.J(509703823,845,15,Ga.c(ea))}mo(){this.uKg()}KF(){this.log()}TDj(){if(this.o_a)return this.o_a;this.o_a={};var ea=parseInt(this.Lb.Ea("CurrentSlideId"));ea=ea!==Qc.a.empty.sid?Qc.a.Aq(ea,0):this.sa.presentation.TBb(0);if(!ea)return this.o_a;
this.o_a.SlideId=ea.toString();if(ea=this.sa.presentation.Lke(ea.sid))ea=Object(Wb.a)(205,ea).fF(),this.o_a.HasComments=this.DC.Ztg(ea),this.o_a.HasActiveComments=this.DC.Ptg(ea);return this.o_a}tke(){const ea={};ea.Ring=w.AFrameworkApplication.ld.Ring;ea.Host=w.AFrameworkApplication.ld.Host;ea.UiHost=w.AFrameworkApplication.ld.UiHost;ea.SessionOrigin=w.AFrameworkApplication.ld.SessionOrigin;ea.ApplicationMode=w.AFrameworkApplication.ld.ApplicationMode;ea.Browser=w.AFrameworkApplication.ld.Browser;
ea.Os=w.AFrameworkApplication.ld.Os;return ea}Cuj(){const ea={};ea[te.a.LUb]=dc.a.instance.hh(te.a.LUb);ea.DocPageNavigationStart=dc.a.instance.hh("DocPageNavigationStart");ea[te.a.w$b]=dc.a.instance.hh(te.a.w$b);ea[Mc.a.x4e]=dc.a.instance.hh(Mc.a.x4e);ea[Mc.a.w4e]=dc.a.instance.hh(Mc.a.w4e);ea[Mc.a.$Fh]=dc.a.instance.hh(Mc.a.$Fh);ea[Mc.a.cag]=dc.a.instance.hh(Mc.a.cag);ea[Mc.a.wce]=dc.a.instance.hh(Mc.a.wce);ea[Mc.a.vce]=dc.a.instance.hh(Mc.a.vce);ea[Mc.a.E4d]=dc.a.instance.hh(Mc.a.E4d);ea[te.a.aGd]=
0<ne.a.instance.fBh();return ea}dxj(){const ea={};ea[Zb.a.S5d]=dc.a.instance.hh(Zb.a.S5d);ea[Zb.a.X5d]=dc.a.instance.hh(Zb.a.X5d);ea[Zb.a.zdc]=dc.a.instance.hh(Zb.a.zdc);ea[Zb.a.Gpe]=dc.a.instance.hh(Zb.a.Gpe);ea[Zb.a.y9e]=dc.a.instance.hh(Zb.a.y9e);ea[Zb.a.Udc]=dc.a.instance.hh(Zb.a.Udc);ea[Zb.a.Hpe]=dc.a.instance.hh(Zb.a.Hpe);ea[Zb.a.bAe]=dc.a.instance.hh(Zb.a.bAe);ea[Zb.a.nee]=dc.a.instance.hh(Zb.a.nee);ea[Zb.a.oee]=dc.a.instance.hh(Zb.a.oee);ea[Zb.a.Vzd]=dc.a.instance.hh(Zb.a.Vzd);ea[Zb.a.Z7d]=
dc.a.instance.hh(Zb.a.Z7d);ea[Zb.a.Y7d]=dc.a.instance.hh(Zb.a.Y7d);return ea}TLj(){const ea=dc.a.instance.hh("DocPageNavigationStart");if(!dc.a.instance.hh(te.a.LUb))return ea;const Ka=dc.a.instance.hh(te.a.LUb);return 6E4>ea-Ka?Ka:ea}T6e(ea,Ka){const bb=[];Array.add(bb,Object.assign(new aj.a,{name:"EventName",string:ea}));$b.a.sendActivityEvent(Object.assign(new cd.a,{name:"CommentsBootEvents",durationMs:Ka.getTime()-this.TLj(),dataFields:bb}))}}Object(k.a)(Ig,"CommentTelemetryManager",null,[1662]);
var wg=d(702),fe=d(703),Qe=d(704);class ig extends wg.a{constructor(ea,Ka){super();this.ZKk=ea;this.kj=Ka;this.ZHe=[new fe.a(Zf.a.IYf,null),new fe.a(Zf.a.JYf,null),new fe.a(Zf.a.KYf,null),new fe.a(Zf.a.NYf,null),new fe.a(Zf.a.RYf,null),new fe.a(Zf.a.SYf,null),new fe.a(Zf.a.QYf,null),new fe.a(Zf.a.LYf,null),new fe.a(Zf.a.MYf,null),new fe.a(Zf.a.OYf,null),new fe.a(Zf.a.PYf,null)]}get isInHighContrastMode(){return!!this.kj&&this.kj.isInHighContrastMode}get FCb(){return this.ZKk}get poe(){return this.ZHe}prc(ea,
Ka){var bb=this.d1.Dla;if(bb&&0===bb.type&&(bb=this.d1.Dla.Ffa,bb=Object(r.a)(Array,bb)?bb:null)){var vb=null,Yb=null,Gc=new Ta.a;for(const ud of bb)ud.osc.isValid&&Array.contains(ud.osc.paragraphs,ea)&&(0===ud.state?vb=ud.commentId:1===ud.state&&(Yb=ud.commentId),Gc.$(ud.commentId,ud.osc));this.tEi(Ka.querySelectorAll("*"),Gc,ea,vb,Yb)}}Zdc(ea,Ka){ea=Object(r.a)(Array,ea)?Array.isArray(ea)?ea:null:null;if(!ea||0<ea.length&&!Object(Wb.a)(ee,ea[0]))return Ka;for(const bb of ea)if(bb.osc.isValid)for(const vb of bb.osc.paragraphs)vb&&
(Qe.b(vb),Ka.add(vb));return Ka}ilj(ea,Ka){ea=ea.sOa;const bb=Ka?ig.wHk:ig.xHk;Ka=dd.a.phg(ea,Ka?ig.xMk:ig.yMk);ea=dd.a.phg(ea,bb);return Ka<ea}tEi(ea,Ka,bb,vb,Yb){const Gc=new ia.a,ud=new ia.a;for(let qe=0;qe<ea.length;qe++){const qg=ea[qe];this.Zud(qg);if(!qg.parentNode)continue;var Nd=Zc.a.Ie(qg,Zf.a.T5d),Bc=Zc.a.Ie(qg,Zf.a.P5d);const Jf=[!1,!1,!1];if(Nd)for(const Bd of Nd)if(Ka.Ib(Bd)){Nd=Ka.ga(Bd).Jig(bb);if(Ka.ga(Bd).bug||(2===Nd||0===Nd)&&!this.isInHighContrastMode&&this.ilj(Ka.ga(Bd),Bd===
Yb))Ka.ga(Bd).bug=!0,Gc.add(Bd);ud.add(Bd);this.g5f(Ka,bb,Bd,vb,Yb,Jf,!0)}if(Bc)for(const Bd of Bc)ud.contains(Bd)&&(ud.remove(Bd),Gc.remove(Bd),this.g5f(Ka,bb,Bd,vb,Yb,Jf,!1));if(0!==Qe.a(qg)){Bc=(Nd=0<Gc.count)&&!!Yb&&Gc.contains(Yb);const Bd=!!vb&&ud.contains(vb),Ld=!!Yb&&ud.contains(Yb);0<ud.count&&!this.isInHighContrastMode&&0<=qg.parentNode.className.indexOf(Zf.a.tOa)&&(de.a.RJ(qg.parentNode,Zf.a.IYf),Ld?de.a.RJ(qg.parentNode,Bc?Zf.a.MYf:Zf.a.LYf):Bd?(de.a.RJ(qg.parentNode,Zf.a.JYf),Nd=qg.parentNode.className.match(new RegExp("\\b"+
Zf.a.uvg+"\\b")),(!Nd||1>Nd.length)&&de.a.RJ(qg.parentNode,Zf.a.KYf)):de.a.RJ(qg.parentNode,Nd?Zf.a.SYf:Zf.a.RYf));Jf[1]?de.a.RJ(qg,Bc?Zf.a.PYf:Zf.a.OYf):Jf[0]?de.a.RJ(qg,Zf.a.NYf):Jf[2]&&de.a.RJ(qg,Zf.a.QYf)}}}g5f(ea,Ka,bb,vb,Yb,Gc,ud){ea=ea.ga(bb).Jig(Ka);if(2===ea||(ud?0===ea:1===ea))vb&&vb.equals(bb)&&(Gc[0]=!0),Yb&&Yb.equals(bb)&&(Gc[1]=!0),Gc[2]=!0}}ig.yMk="#F5E7F6";ig.xHk="#503355";ig.xMk="#F2E1F4";ig.wHk="#4C3050";Object(k.a)(ig,"CommentTextAnchorHighlightActor",wg.a,[]);class Ph{constructor(ea){let Ka;
this.Yii=20;Ka=ea?ea="SharedCommentBubble":ea="SharedCommentBubbleSelected";this.Tii=this.oVa("SharedCommentBubble");this.Sii=this.oVa("SharedCommentBubbleHover");this.xzf=this.oVa(ea);this.Xii=this.oVa("SharedCommentBubble");this.Wii=this.oVa("SharedCommentBubbleHover");this.yzf=this.oVa(Ka);this.Uii="ModernCommentMarkerElementSingle cui-img-cont-float";this.Vii="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get sgh(){return this.Uii}get tgh(){return this.Vii}get NQe(){return this.Yii}get wpc(){return this.Tii}get MQe(){return this.Sii}get rgh(){return this.xzf}get vgh(){return this.Xii}get ugh(){return this.Wii}get wgh(){return this.yzf}W8e(ea){const Ka=
ea?this.wpc:"SharedCommentBubbleSelected";ea=ea?this.wpc:Ka;this.xzf=this.oVa(Ka);this.yzf=this.oVa(ea)}oVa(ea){return String.format("{0}_{1}x{2}x32",ea,this.NQe,this.NQe)}}Object(k.a)(Ph,"CommentViewHelper",null,[]);class $g{constructor(ea,Ka,bb,vb,Yb,Gc){this.Nc=ea;this.sa=Ka;this.zb=bb;this.y9g=vb;this.jb=Gc;this.y9g.VE(Object(qb.a)(this,this.bqd,"onSlideOrderChanged"));this.Nc.Cxi(Object(qb.a)(this,this.Ulh,"onCommentsChanged"))}dispose(){this.Nc.yAl(Object(qb.a)(this,this.Ulh,"onCommentsChanged"));
this.y9g.RN(Object(qb.a)(this,this.bqd,"onSlideOrderChanged"))}Ulh(){const ea=this.sa.Aa;E.a.B9a(this.zb,()=>{this.Qhl(ea)})}bqd(ea,Ka){if(2===Ka.vU){const bb=this.sa.Aa;E.a.B9a(this.zb,()=>{this.lvh(bb)})}}lvh(ea){this.sa.Aa===ea&&ea&&this.jb.Y4a(!0)}Qhl(ea){this.lvh(ea)}}Object(k.a)($g,"CommentsChangeListener",null,[106]);var Vg=d(144),Fg=d(282),bf=d(47);class Ag{constructor(ea,Ka,bb,vb){this.pkc=this.T_a=null;new Fg.a(0,0,0,0);this.lOg=null;this.fQh=!1;this.HK=vb;this.Db=Ka;this.HK||(this.T_a=
document.createElement("div"),this.T_a.className="CommentPanel",this.T_a.style.position="absolute");this.Mb=!1;this.vdh=bb}dispose(){}layout(ea){return ea}Doe(ea){this.pkc=ea}jPl(ea){this.lOg=ea}zq(ea){this.Mb=ea;this.HK?this.uQ(this.Mb):this.vdh.uQ(this,this.Mb,ResourceStrings.L_Comments,bf.a.Sr)}uQ(ea){Vg.UISurfaces.qr().then(Ka=>{ea?Ka.showTaskPane(bf.a.Sr,this.lOg):Ka.hideTaskPane(bf.a.Sr,2);return null}).catch(Ka=>{mb.a.J(508887565,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",
Ka.toString(),ea.toString())})}J6e(){Vg.UISurfaces.qr().then(ea=>{ea.setSelectedTaskPane(bf.a.Sr);return null}).catch(ea=>{mb.a.J(508887564,833,10,"CommentsPane::SelectPane exception: {0}",ea.toString())})}zLl(){try{this.HK?this.J6e():this.vdh.J6e(bf.a.Sr)}catch(ea){mb.a.J(508887563,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",ea)}}rLa(ea){this.Db.rLa(ea?1:2)}get isVisible(){return this.Mb}get va(){return this.T_a}get order(){return 18}}Object(k.a)(Ag,"CommentsPane",
null,[1607,180,106,1505]);class ff{constructor(){this.E2a=this.bOa=0;this.$c=this.f3a=this.pla=null}}Object(k.a)(ff,"FindCommentContext",null,[]);var Fe;(function(ea){ea[ea.findNextComment=0]="findNextComment";ea[ea.findPreviousComment=1]="findPreviousComment";ea[ea.findNextActiveComment=2]="findNextActiveComment";ea[ea.findPreviousActiveComment=3]="findPreviousActiveComment"})(Fe||(Fe={}));Object(k.b)("FindCommentRequestType",Fe);class Pf{constructor(ea,Ka,bb,vb,Yb,Gc){this.Wb=ea;this.sa=Ka;this.oHe=
bb;this.xP=vb;this.fWg=Yb;this.Md=new ff;this.iJk=Gc}get NEa(){return this.iJk.value}dispose(){this.oHe.dispose();this.Md=this.oHe=null}Pde(ea,Ka,bb){this.Jde(0,!1,ea,Ka,bb)}Wde(ea,Ka,bb){this.Jde(1,!1,ea,Ka,bb)}Qde(ea,Ka){this.Jde(0,!0,ea,Ka,!1)}Jde(ea,Ka,bb,vb,Yb){var Gc=this.sa.presentation;if(!Gc)throw Error.argumentNull("Presentation is null");vb||(vb=ef.a.Zj("FindComment",0),vb.Wa("FindCommentRequestType",Fe[ea]));vb.Wa(Pf.e3d,"true");if(this.fWg&&this.sa.Aa){if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");
const ud=this.sa.Aa.ve;Gc=Gc.slides||[];this.Md.pla=bb;this.Md.E2a=Pf.qBj(ea,Yb);this.Md.$c=vb;Ka?this.Kde(Gc[ud>=Gc.length-1?0:ud+1]):1===ea?this.pcg(Gc,ud-1,Yb):this.mcg(Gc,ud+1,Yb)}else vb.Wa(Pf.YMi,this.fWg.toString()),bb(null,null,!1,!1)}mcg(ea,Ka,bb){this.Md.f3a=null;this.Md.bOa=Ka;for(let vb=Ka;vb<ea.length;vb++)if(ea[vb]&&this.HFg(ea[vb])){const Yb=this.wBj(ea[vb],bb);if(Yb){this.Md.pla(ea[vb],Yb,!1,!1);return}}else{this.Kde(ea[vb]);return}0<Ka?this.Inj(bb):this.notFound()}pcg(ea,Ka,bb){this.Md.f3a=
null;this.Md.bOa=Ka;for(let vb=Ka;-1<vb;vb--)if(ea[vb]&&this.HFg(ea[vb])){const Yb=this.$Dj(ea[vb],bb);if(Yb){this.Md.pla(ea[vb],Yb,!1,!1);return}}else{this.Kde(ea[vb]);return}Ka<ea.length-1?this.Qnj(bb):this.notFound()}Kde(ea){this.Md.$c.Xm(Pf.QNi,new Date);ea&&this.oHe.find(ea.Fb,this.Md.E2a,Object(qb.a)(this,this.C9k,"onServerFindSucceeded"),Object(qb.a)(this,this.B9k,"onServerFindFailed"))}C9k(ea){this.Md.$c.jD(Pf.e3d,"false");this.Md.$c.Xm(Pf.GTf,new Date);this.Md.$c.Wa(Pf.mTf,"true");ea?(this.Md.f3a=
ea,-1===this.jbc(this.Md.f3a.TargetSlideId)?this.notFound():this.Md.pla(this.jam(this.Md.f3a.TargetSlideId),this.Md.f3a.TargetComment,this.Md.f3a.IsFirstComment,this.Md.f3a.IsLastComment)):this.notFound()}B9k(){this.Md.$c.jD(Pf.e3d,"false");this.Md.$c.Xm(Pf.GTf,new Date);this.Md.$c.Wa(Pf.mTf,"false");mb.a.J(512496786,805,50,"OnServerFindFailed");this.notFound()}Inj(ea){var Ka=this.sa.presentation;if(!Ka)throw Error.argumentNull("Presentation is null");Ka=Ka.slides||[];Tb.a.Ta(Ka)?this.notFound():
this.mcg(Ka,0,ea)}Qnj(ea){var Ka=this.sa.presentation;if(!Ka)throw Error.argumentNull("Presentation is null");Ka=Ka.slides||[];Tb.a.Ta(Ka)?this.notFound():this.pcg(Ka,Ka.length-1,ea)}wBj(ea,Ka){ea=this.Wb.Qk(ea.Fb);if(this.NEa){const bb=(ea=this.xP.dcb(ea))?ea.length:0;for(let vb=0;vb<bb;vb++){const Yb=ea[vb];if(Pf.TGg(Yb,Ka))return Yb}return null}return this.xP.tnj(ea,Ka)}$Dj(ea,Ka){ea=this.Wb.Qk(ea.Fb);if(this.NEa){var bb=(ea=this.xP.dcb(ea))?ea.length:0;for(--bb;0<=bb;bb--){const vb=ea[bb];if(Pf.TGg(vb,
Ka))return vb}return null}return this.xP.Fnj(ea,Ka)}HFg(ea){return ea.kF}jbc(ea){var Ka=this.sa.presentation;if(!Ka)throw Error.argumentNull("Presentation is null");if(ea){Ka=Ka.slides||[];ea=new Qc.a(ea);for(let bb=0;bb<Ka.length;bb++)if(Ka[bb]&&Qc.a.OEa(Ka[bb].Fb,ea))return bb}return-1}jam(ea){return ea?this.Wb.Dma(new Qc.a(ea)):null}notFound(){this.Md.pla&&this.Md.pla(null,null,!1,!1)}static qBj(ea,Ka){if(Ka)switch(ea){case 0:return 2;case 1:return 3}return ea}static TGg(ea,Ka){return!Ka||0===
ea.status}}Pf.e3d="IsCompletedSearchInClient";Pf.QNi="ServerSearchStartTime";Pf.GTf="ServerSearchEndTime";Pf.mTf="IsServerSearchSucceeded";Pf.YMi="IsBRSOn";Object(k.a)(Pf,"FindCommentLogic",null,[1605,106]);var Md=d(80);class vg{constructor(){this.type=0;this.pla=this.$c=null;this.yYd=!1}}Object(k.a)(vg,"Entry",null,[]);class Ye{constructor(ea,Ka){this.Kcd=null;this.Tl=ea;this.zb=Ka;this.Qoa=[];this.vLe=0}dispose(){this.Tl.dispose();this.Qoa=this.Tl=null;mb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",
this.vLe)}Pde(ea,Ka,bb){this.enqueue(1,ea,Ka,bb)}Wde(ea,Ka,bb){this.enqueue(0,ea,Ka,bb)}Qde(ea,Ka){this.enqueue(2,ea,Ka,!1)}enqueue(ea,Ka,bb,vb){bb.Wa("AlreadyQueuedEntryCount",this.Qoa.length.toString());ea=Object.assign(new vg,{type:ea,pla:(Yb,Gc,ud,Nd)=>{Ka(Yb,Gc,ud,Nd);this.Kcd=null;this.Uth()},$c:bb,yYd:vb});Array.enqueue(this.Qoa,ea);this.vLe=Math.max(this.vLe,this.Qoa.length);this.Uth()}Uth(){0<this.Qoa.length&&!this.Kcd&&(this.Kcd=new Md.a(2,1,0,Object(qb.a)(this,this.Tll,"processOneEntry"),
90,"49"),this.zb.Jb(this.Kcd))}Tll(){const ea=Array.dequeue(this.Qoa);1===ea.type?this.Tl.Pde(ea.pla,ea.$c,ea.yYd):0===ea.type?this.Tl.Wde(ea.pla,ea.$c,ea.yYd):this.Tl.Qde(ea.pla,ea.$c)}}Object(k.a)(Ye,"FindCommentLogicDecorator",null,[1605,106]);var Cf=d(397),Bg=d(114);class Ae extends Bg.a{constructor(ea,Ka){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===ea)throw Error.argumentNull("slideId");this.RequestType=Ka;this.StartSlideId=ea.toString();this.FFindModernComments=
!0}om(){return 88}}Object(k.a)(Ae,"FindCommentRequest",Bg.a,[]);class Uf extends Cf.a{constructor(ea){super();this.yya=null;this.H$g=0;this.QKa=this.dJa=null;this.enabled=2;this.YIb=0;this.rl=!1;this.Kn=ea;this.Kn.register(this)}dispose(){this.rl||(1===this._state&&this.Kn.unregister(this),this.rl=!0,this.YIb=0)}find(ea,Ka,bb,vb){0<this.YIb&&null!==bb&&(mb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.YIb),bb(null));this.yya=ea;this.H$g=Ka;this.HG(bb,vb,null)}Nma(){return 0<
this.YIb&&!this.rl}cP(){return!1}NWa(){return this.aFg||this.Nma()}DPb(){if(1===this._state)this.ge.hL=new Ae(this.yya,this.H$g),this.ge.status=1,this._state=3;else if(3===this._state&&this.aFg)if(mb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.ge.Pvd,this.ge.Et,this.ge.au),2===this.ge.statusCode&&this.ge.Sv&&1===this.ge.Sv.length){const ea=this.ge.Sv[0];0!==ea.StatusCode?this.VI(ea):this.I2(ea)}else this.VI()}HG(ea,Ka){this.YIb++;this.QKa=ea;this.dJa=
Ka;this.Kn.dca()}forceOutbound(){}VI(ea=null){mb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.ge.lu,this.ge.statusCode,ea?ea.StatusCode:-1);this.tnh(ea,!1)}I2(ea){this.tnh(ea,!0)}get aFg(){return!!this.ge&&2===this.ge.status}tnh(ea,Ka){this.YIb--;this._state=1;if(Ka){Ka=null;try{Ka=Sys.Serialization.JavaScriptSerializer.deserialize(ea.FindCommentResult)}catch(bb){mb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",
bb)}this.QKa(Ka)}else this.dJa(null,-1)}}Object(k.a)(Uf,"FindCommentReplicator",Cf.a,[106]);class Jd{constructor(){this.fy=null;this.wDc=this.HCf=this.dof=this.E1b=this.jIf=this.AAf=this.PDf=!1}yMj(){this.fy||(e.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.xNh());return this.fy}JFj(){return new Promise((ea,Ka)=>{this.wDc?ea(this.ylg()):this.nLh().then(()=>{ea(this.ylg())}).catch(bb=>{Ka(bb)})})}ylg(){this.wDc||e.ULS.sendTraceTag(588292829,
327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ea;ea=33;this.dof&&(ea|=2);this.PDf&&(ea|=8);this.jIf&&(ea|=16);this.AAf&&(ea|=4);this.E1b&&(ea|=64);this.HCf&&(ea|=128);return ea}}Object(k.a)(Jd,"OfficeSharedCommentsAppCapabilities",null,[553]);class We extends Jd{constructor(ea,Ka,bb,vb,Yb,Gc){super();this.Lb=ea;this.Ba=Ka;this.K1g=bb;this.Pgd=Gc;this.bUl(vb,Yb);this.xNh();this.nLh()}bUl(ea,Ka){Qb.a("CheckTaskHostIsEnabledForOneDriveConsumer")&&
this.XYl(ea)?this.E1b=!0:this.E1b=this.Lb.getBooleanAppSetting("TasksForCommentsEnabled")&&!ea;this.jIf=!1;this.PDf=Ka;this.HCf=this.AAf=!0}XYl(ea){return this.Lb.getBooleanAppSetting("TasksForCommentsEnabled")&&!ea&&this.Lb.getBooleanAppSetting("TasksHostIsEnabled")}xNh(){this.fy={};const ea=this.E1b&&this.Ba.Qrk;this.fy.CommentsFluentUI="true";this.fy.CommentTasks=this.E1b.toString();this.fy.DisabledChangeGates=this.Lb.Ea("DisabledChangeGatesInSharedComments");this.fy.DiscreteHostedComments="true";
this.fy.CommentReactions=xd(this.Lb).toString();this.fy.NewCommentButton="true";this.fy.PersonaColor="true";this.fy.LivePersonaPicker="true";this.fy.AtMentionFloodgateSurvey=w.AFrameworkApplication.fa.getBooleanAppSetting("AtMentionUserFloodGateCampaignIsEnabled").toString();this.fy.CommentTasksFromReply=ea.toString();this.fy.LogDraftCommentIdPair=this.Pgd.toString();this.fy.HyperlinksInComments="true";this.fy.SmartReplies=this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",
!1).toString();this.fy.TaskPaneWithNewInfrastructure=this.Ba.Y5d.toString();this.fy.NewSelectionInteractions="true";this.fy.ExtendedDrafting="true";this.fy.LinkToComment="true";this.fy.WebThemeIntegration="true";this.fy.TaskHistoryRecordIDs=this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()}nLh(){return new Promise((ea,Ka)=>{this.K1g?this.K1g.atMentionsEnabledAsync().then(bb=>{this.dof=bb;this.wDc=!0;ea(this.wDc)}):(e.ULS.sendTraceTag(509645712,327,10,
"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Ka(E.a.fu(-2130915320)))})}}Object(k.a)(We,"PPTSharedCommentAppCapabilities",Jd,[]);class fd{constructor(ea){this.Og=ea}display(ea,Ka){this.Og.chf(ea?0:2,Ka);this.Og.setVisibility()}dismiss(){this.Og.HTi();this.Og.setVisibility()}activate(){this.Og.chf(1);this.Og.setVisibility()}Icj(ea){this.Og.chf(ea?0:2)}Cn(ea){this.Og.Cn(ea)}wE(ea){this.Og.wE(ea)}Jq(){return this.Og.Jq()}aP(ea){return this.Og.EDb(ea)}Ry(ea){this.Og.Ry(ea)}dispose(){this.Og.dispose()}Xz(){this.Og.Xz()}jF(ea){return this.Og.jF(ea)}bD(ea){return this.Og.bD(ea)}draw(ea,
Ka){this.Og.draw(ea,Ka)}get visible(){return this.Og.visible}set visible(ea){this.Og.visible=ea}setPosition(ea,Ka){this.Og.setPosition(ea,Ka)}Pj(ea){this.Og.Pj(ea)}Kr(ea){this.Og.Kr(ea)}Tv(ea){this.Og.Tv(ea)}setZIndex(ea){this.Og.setZIndex(ea)}TF(ea,Ka){this.Og.TF(ea,Ka)}setSelection(){}}Object(k.a)(fd,"ShapeCommentsAnchoredSelectionView",null,[1653,805,806,106]);class ui{constructor(ea,Ka){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=
null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ea;this.canvasContextId=Ka}}Object(k.a)(ui,"CommentUIAction",null,[]);var bj=d(64),nf=d(661),ki=d(122),qf=d(194),be=d(183),Ud=d(1167),Ei=d(543);class ei{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(k.a)(ei,"CurrentContextDraft",null,[]);class Aj{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(k.a)(Aj,"IContentAnchorPosition",
null,[]);class tj{constructor(){this.y=this.x=this.height=this.width=0}}Object(k.a)(tj,"IViewportInfo",null,[]);class Pi{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=null}}Object(k.a)(Pi,"FloatingContainerManagerCreationParams",null,[]);var Eh=d(143),Th=d(52),Qi=d(846),fi=d(426),Ng=d(393),$d=d(928),Qf;(function(ea){ea[ea.line=0]="line";ea[ea.lineInv=1]="lineInv";ea[ea.triangle=
2]="triangle";ea[ea.rtTriangle=3]="rtTriangle";ea[ea.rect=4]="rect";ea[ea.diamond=5]="diamond";ea[ea.parallelogram=6]="parallelogram";ea[ea.trapezoid=7]="trapezoid";ea[ea.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";ea[ea.pentagon=9]="pentagon";ea[ea.hexagon=10]="hexagon";ea[ea.heptagon=11]="heptagon";ea[ea.octagon=12]="octagon";ea[ea.decagon=13]="decagon";ea[ea.dodecagon=14]="dodecagon";ea[ea.star4=15]="star4";ea[ea.star5=16]="star5";ea[ea.star6=17]="star6";ea[ea.star7=18]="star7";ea[ea.star8=
19]="star8";ea[ea.star10=20]="star10";ea[ea.star12=21]="star12";ea[ea.star16=22]="star16";ea[ea.star24=23]="star24";ea[ea.star32=24]="star32";ea[ea.roundRect=25]="roundRect";ea[ea.round1Rect=26]="round1Rect";ea[ea.round2SameRect=27]="round2SameRect";ea[ea.round2DiagRect=28]="round2DiagRect";ea[ea.snipRoundRect=29]="snipRoundRect";ea[ea.snip1Rect=30]="snip1Rect";ea[ea.snip2SameRect=31]="snip2SameRect";ea[ea.snip2DiagRect=32]="snip2DiagRect";ea[ea.plaque=33]="plaque";ea[ea.ellipse=34]="ellipse";ea[ea.teardrop=
35]="teardrop";ea[ea.homePlate=36]="homePlate";ea[ea.chevron=37]="chevron";ea[ea.pieWedge=38]="pieWedge";ea[ea.pie=39]="pie";ea[ea.blockArc=40]="blockArc";ea[ea.donut=41]="donut";ea[ea.noSmoking=42]="noSmoking";ea[ea.rightArrow=43]="rightArrow";ea[ea.leftArrow=44]="leftArrow";ea[ea.upArrow=45]="upArrow";ea[ea.downArrow=46]="downArrow";ea[ea.stripedRightArrow=47]="stripedRightArrow";ea[ea.notchedRightArrow=48]="notchedRightArrow";ea[ea.bentUpArrow=49]="bentUpArrow";ea[ea.leftRightArrow=50]="leftRightArrow";
ea[ea.upDownArrow=51]="upDownArrow";ea[ea.leftUpArrow=52]="leftUpArrow";ea[ea.leftRightUpArrow=53]="leftRightUpArrow";ea[ea.quadArrow=54]="quadArrow";ea[ea.leftArrowCallout=55]="leftArrowCallout";ea[ea.rightArrowCallout=56]="rightArrowCallout";ea[ea.upArrowCallout=57]="upArrowCallout";ea[ea.downArrowCallout=58]="downArrowCallout";ea[ea.leftRightArrowCallout=59]="leftRightArrowCallout";ea[ea.upDownArrowCallout=60]="upDownArrowCallout";ea[ea.quadArrowCallout=61]="quadArrowCallout";ea[ea.bentArrow=62]=
"bentArrow";ea[ea.uturnArrow=63]="uturnArrow";ea[ea.circularArrow=64]="circularArrow";ea[ea.leftCircularArrow=65]="leftCircularArrow";ea[ea.leftRightCircularArrow=66]="leftRightCircularArrow";ea[ea.curvedRightArrow=67]="curvedRightArrow";ea[ea.curvedLeftArrow=68]="curvedLeftArrow";ea[ea.curvedUpArrow=69]="curvedUpArrow";ea[ea.curvedDownArrow=70]="curvedDownArrow";ea[ea.swooshArrow=71]="swooshArrow";ea[ea.cube=72]="cube";ea[ea.can=73]="can";ea[ea.lightningBolt=74]="lightningBolt";ea[ea.heart=75]="heart";
ea[ea.sun=76]="sun";ea[ea.moon=77]="moon";ea[ea.smileyFace=78]="smileyFace";ea[ea.irregularSeal1=79]="irregularSeal1";ea[ea.irregularSeal2=80]="irregularSeal2";ea[ea.foldedCorner=81]="foldedCorner";ea[ea.bevel=82]="bevel";ea[ea.frame=83]="frame";ea[ea.halfFrame=84]="halfFrame";ea[ea.corner=85]="corner";ea[ea.diagStripe=86]="diagStripe";ea[ea.chord=87]="chord";ea[ea.arc=88]="arc";ea[ea.leftBracket=89]="leftBracket";ea[ea.rightBracket=90]="rightBracket";ea[ea.leftBrace=91]="leftBrace";ea[ea.rightBrace=
92]="rightBrace";ea[ea.bracketPair=93]="bracketPair";ea[ea.bracePair=94]="bracePair";ea[ea.straightConnector1=95]="straightConnector1";ea[ea.bentConnector2=96]="bentConnector2";ea[ea.bentConnector3=97]="bentConnector3";ea[ea.bentConnector4=98]="bentConnector4";ea[ea.bentConnector5=99]="bentConnector5";ea[ea.curvedConnector2=100]="curvedConnector2";ea[ea.curvedConnector3=101]="curvedConnector3";ea[ea.curvedConnector4=102]="curvedConnector4";ea[ea.curvedConnector5=103]="curvedConnector5";ea[ea.callout1=
104]="callout1";ea[ea.callout2=105]="callout2";ea[ea.callout3=106]="callout3";ea[ea.accentCallout1=107]="accentCallout1";ea[ea.accentCallout2=108]="accentCallout2";ea[ea.accentCallout3=109]="accentCallout3";ea[ea.borderCallout1=110]="borderCallout1";ea[ea.borderCallout2=111]="borderCallout2";ea[ea.borderCallout3=112]="borderCallout3";ea[ea.accentBorderCallout1=113]="accentBorderCallout1";ea[ea.accentBorderCallout2=114]="accentBorderCallout2";ea[ea.accentBorderCallout3=115]="accentBorderCallout3";
ea[ea.wedgeRectCallout=116]="wedgeRectCallout";ea[ea.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";ea[ea.wedgeEllipseCallout=118]="wedgeEllipseCallout";ea[ea.cloudCallout=119]="cloudCallout";ea[ea.cloud=120]="cloud";ea[ea.ribbon=121]="ribbon";ea[ea.ribbon2=122]="ribbon2";ea[ea.ellipseRibbon=123]="ellipseRibbon";ea[ea.ellipseRibbon2=124]="ellipseRibbon2";ea[ea.leftRightRibbon=125]="leftRightRibbon";ea[ea.verticalScroll=126]="verticalScroll";ea[ea.horizontalScroll=127]="horizontalScroll";ea[ea.wave=
128]="wave";ea[ea.doubleWave=129]="doubleWave";ea[ea.plus=130]="plus";ea[ea.flowChartProcess=131]="flowChartProcess";ea[ea.flowChartDecision=132]="flowChartDecision";ea[ea.flowChartInputOutput=133]="flowChartInputOutput";ea[ea.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";ea[ea.flowChartInternalStorage=135]="flowChartInternalStorage";ea[ea.flowChartDocument=136]="flowChartDocument";ea[ea.flowChartMultidocument=137]="flowChartMultidocument";ea[ea.flowChartTerminator=138]="flowChartTerminator";
ea[ea.flowChartPreparation=139]="flowChartPreparation";ea[ea.flowChartManualInput=140]="flowChartManualInput";ea[ea.flowChartManualOperation=141]="flowChartManualOperation";ea[ea.flowChartConnector=142]="flowChartConnector";ea[ea.flowChartPunchedCard=143]="flowChartPunchedCard";ea[ea.flowChartPunchedTape=144]="flowChartPunchedTape";ea[ea.flowChartSummingJunction=145]="flowChartSummingJunction";ea[ea.flowChartOr=146]="flowChartOr";ea[ea.flowChartCollate=147]="flowChartCollate";ea[ea.flowChartSort=
148]="flowChartSort";ea[ea.flowChartExtract=149]="flowChartExtract";ea[ea.flowChartMerge=150]="flowChartMerge";ea[ea.flowChartOfflineStorage=151]="flowChartOfflineStorage";ea[ea.flowChartOnlineStorage=152]="flowChartOnlineStorage";ea[ea.flowChartMagneticTape=153]="flowChartMagneticTape";ea[ea.flowChartMagneticDisk=154]="flowChartMagneticDisk";ea[ea.flowChartMagneticDrum=155]="flowChartMagneticDrum";ea[ea.flowChartDisplay=156]="flowChartDisplay";ea[ea.flowChartDelay=157]="flowChartDelay";ea[ea.flowChartAlternateProcess=
158]="flowChartAlternateProcess";ea[ea.flowChartOffpageConnector=159]="flowChartOffpageConnector";ea[ea.actionButtonBlank=160]="actionButtonBlank";ea[ea.actionButtonHome=161]="actionButtonHome";ea[ea.actionButtonHelp=162]="actionButtonHelp";ea[ea.actionButtonInformation=163]="actionButtonInformation";ea[ea.actionButtonForwardNext=164]="actionButtonForwardNext";ea[ea.actionButtonBackPrevious=165]="actionButtonBackPrevious";ea[ea.actionButtonEnd=166]="actionButtonEnd";ea[ea.actionButtonBeginning=167]=
"actionButtonBeginning";ea[ea.actionButtonReturn=168]="actionButtonReturn";ea[ea.actionButtonDocument=169]="actionButtonDocument";ea[ea.actionButtonSound=170]="actionButtonSound";ea[ea.actionButtonMovie=171]="actionButtonMovie";ea[ea.gear6=172]="gear6";ea[ea.gear9=173]="gear9";ea[ea.funnel=174]="funnel";ea[ea.mathPlus=175]="mathPlus";ea[ea.mathMinus=176]="mathMinus";ea[ea.mathMultiply=177]="mathMultiply";ea[ea.mathDivide=178]="mathDivide";ea[ea.mathEqual=179]="mathEqual";ea[ea.mathNotEqual=180]="mathNotEqual";
ea[ea.cornerTabs=181]="cornerTabs";ea[ea.squareTabs=182]="squareTabs";ea[ea.plaqueTabs=183]="plaqueTabs";ea[ea.chartX=184]="chartX";ea[ea.chartStar=185]="chartStar";ea[ea.chartPlus=186]="chartPlus"})(Qf||(Qf={}));Object(k.b)("ST_ShapeType",Qf);var Cg=d(157);class rh{constructor(){this.RowId=this.ColId=null}}Object(k.a)(rh,"TableCellInfo",null,[]);var ge=d(927),bi=d(51),Og=d(187),Ki=d(126),sk=d(172),kk=d(1164),Nj=d(953),rl=d(954),cj=d(356),bh=d(111);class vi{constructor(ea,Ka){this.iya=this.KGb=null;
this.IYg=!1;this.dOe=ea;this.ih=Ka}get brk(){return this.IYg}lPb(ea,Ka){Ka&&ea.removeNotification(Ka);return Ka}Qyl(ea){this.KGb=this.lPb(ea,this.KGb);this.lPb(ea,this.iya);this.iya=this.KGb=null}w1l(ea,Ka,bb){ea?this.dOe.Vl.isVisible&&1===ea.SN.length&&Ka.Aa&&Qc.a.tca(ea.Bbb.Fb,Ka.Aa.Fb)||Vg.UISurfaces.BM().then(vb=>{this.iya=this.lPb(vb,this.iya);this.iya=null;var Yb=Object.assign(new kk.a,{label:ea.RNb,onExecute:()=>{ea.primaryButtonAction(this.dOe,Ka);Ka.Aa.ve!==ea.Bbb.ve&&bb.RI(ea.Bbb.ve);this.lPb(vb,
this.iya);this.iya=null}}),Gc=Object.assign(new kk.a,{label:ea.kxd,onExecute:()=>{this.IYg=!0;this.lPb(vb,this.iya);this.iya=null}});Gc=Object.assign(new Nj.a,{target:".EditingRibbonPanel",title:ea.title,content:ea.content,primaryButtonProps:Yb,secondaryButtonProps:Gc,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new rl.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.ih.zp(bf.a.I3a)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Yb=Object.assign(new cj.a,
{onShow:()=>{this.ih.bM(bf.a.I3a)}});Gc=vb.callout(Gc);this.iya=vb.addNotification(Gc,Yb)}):mb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}mRh(ea,Ka){const bb=new bh.StandardDialog;bb.Fd=4;bb.Ky(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,Ka?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,vb=>{1===vb?(ea.G7b(Ka),this.dOe.Rce(Ka)?
this.nRh():this.lRh(Ka?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),mb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Ka)):mb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Ka)})}nRh(){const ea=new bh.StandardDialog;ea.Fd=0;ea.Ky(ResourceStrings.l_DeleteAllCommentsErrorTitle,
ResourceStrings.l_DeleteAllCommentsError,1,null)}lRh(ea){const Ka=()=>{this.ih.bM(bf.a.I3a)},bb=()=>{this.ih.zp(bf.a.I3a)};Vg.UISurfaces.BM().then(vb=>{this.lPb(vb,this.KGb);this.KGb=null;var Yb=Object.assign(new Nj.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:ea,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new rl.a,{directionalHint:6,isBeakVisible:!1,onDismiss:bb,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const Gc=
Object.assign(new cj.a,{onShow:Ka});Yb=vb.callout(Yb);this.KGb=vb.addNotification(Yb,Gc)})}}Object(k.a)(vi,"CommentCalloutDialogManager",null,[]);var xh=d(994);class hh{constructor(ea){this.TJa=ea;this.Qoa=[];this.UDe=new xh.a(1E3,Object(qb.a)(this,this.perform,"perform"))}Nhl(ea){Array.contains(this.Qoa,ea)||Array.add(this.Qoa,ea);this.UDe.perform()}perform(){const ea=this.Qoa;this.Qoa=[];for(let Ka=0;Ka<ea.length;Ka++){const bb=ea[Ka];this.TJa.rLb(bb.commentId,new Hc.a(bb.pos.X,bb.pos.Y))}}}Object(k.a)(hh,
"CommentKeyboardMoveController",null,[]);class zf{constructor(ea,Ka,bb,vb,Yb){this.zIa=this.lya=null;this.Vga=[];if(!ea)throw Error.argumentNull("parentElement");if(!Ka)throw Error.argumentNull("frame");this.LIb=bb;this.ul=ea;this.jb=Ka;this.PRg=vb;this.XRg=Yb}dispose(){this.I2e();this.jb=this.ul=null}I2e(){this.zIa=this.lya=null;if(this.Vga&&0<this.Vga.length){for(const ea of this.Vga)ea&&ea.dispose();Array.clear(this.Vga)}}R0(ea){if(!this.RFa)return!0;if(!ea||!ea.length)return!1;ea=sk.e(ea,Ka=>
0===Ka.status);return!!ea&&0<ea.length}Iud(ea){this.I2e();if(ea&&this.ul){var Ka=this.jb.isReadOnly?null:this.jb.av;for(const bb of ea)this.Vga.push(this.LIb.create(bb,this.ul,this,Ka,this.jb.isReadOnly,nc.QO(bb)||!this.XRg));this.R0(ea)&&this.Ihf()}}selectComment(ea,Ka){if(!(!ea&&!this.lya||this.lya&&nc.Vzb(ea,this.lya.comment))&&(this.lya&&this.lya.select(!1),this.lya=null,ea))for(const bb of this.Vga){if(nc.Vzb(bb.comment,ea)){this.lya=bb;bb.select(!0);break}if(Ka&&bb.comment.Children)for(const vb of bb.comment.Children)if(nc.Vzb(vb,
ea)){this.lya=bb;bb.select(!0);return}}}dvb(ea,Ka){if(!(!ea&&!this.zIa||this.zIa&&nc.Vzb(ea,this.zIa.comment))&&(this.zIa&&this.zIa.activate(!1),this.zIa=null,ea))for(const bb of this.Vga){if(nc.Vzb(bb.comment,ea)){this.zIa=bb;bb.activate(!0);break}if(Ka&&bb.comment.Children)for(const vb of bb.comment.Children)if(nc.Vzb(vb,ea)){this.zIa=bb;bb.activate(!0);return}}}CRh(ea){for(const Ka of this.Vga)Ka.BRh(ea)}Ihf(){for(const ea of this.Vga)ea.updatePosition(this.jb.SEa(ea.comment.pos.X,ea.comment.pos.Y))}rLb(ea,
Ka){Ka=this.jb.H_f(Ka._x,Ka._y);ea.pos.X+=Ka._x;ea.pos.Y+=Ka._y;Ka=new Hc.a(ea.pos.X,ea.pos.Y);this.jb.selectComment(ea,null,!0,!1,0,1,!1);this.jb.manager.rLb(ea.commentId,Ka)}cjm(ea){for(const Ka of this.Vga)if(Ka.comment===ea){Ka.updatePosition(this.jb.SEa(Ka.comment.pos.X,Ka.comment.pos.Y));break}}djm(ea){for(const Ka of ea)for(const bb of this.Vga)bb.comment.commentId===Ka.commentId&&bb.updatePosition(this.jb.SEa(bb.comment.pos.X,bb.comment.pos.Y))}setVisibility(ea){this.XRg=ea;for(const Ka of this.Vga)Ka.setVisibility(!nc.QO(Ka.comment)&&
ea)}get frame(){return this.jb}get isRightToLeft(){return this.PRg}set isRightToLeft(ea){this.PRg=ea}get parentElement(){return this.ul}set parentElement(ea){this.ul=ea}get yQb(){return this.lya}get RFa(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}}Object(k.a)(zf,"CommentMarkerView",null,[]);class Yh{static OTa(ea,Ka,bb,vb,Yb,Gc,ud){const Nd=gf.a.DD();Nd.alt=Gc;Nd.className=xf.getImageClassWithCluster(Ka,Yb);Nd.setAttribute(pf.a.Ff,
pf.a.jx);Nd.src=ea.Ok(Ka+".png");Nd.setAttribute("Unselectable","on");ea=gf.a.En();ea.className=bb+" cui-img-cont-float";ea.setAttribute(pf.a.Ff,pf.a.jx);ea.appendChild(Nd);bb=gf.a.En();bb.className=vb;bb.setAttribute("Unselectable","on");bb.setAttribute(pf.a.Ff,pf.a.jx);bb.appendChild(ea);vb=gf.a.zla();vb.className=Yh.LIl+" cui-ctl";vb.title=Gc;vb.setAttribute(pf.a.Ff,pf.a.jx);vb.setAttribute(pf.a.Rp,Gc);vb.appendChild(bb);ud&&(Gc=gf.a.En(),Gc.className="cui-ctl-mediumlabel",Gc.setAttribute("Unselectable",
"on"),Gc.setAttribute(pf.a.Ff,pf.a.jx),Gc.innerText=ud,vb.appendChild(Gc));return vb}static hab(ea,Ka){return Yh.OTa(ea,ea.yU,"cui-img-16by16","cui-ctl-iconContainer",Ka,CommonUIStrings.l_DialogClose,null)}}Yh.JIl="CommentPaneLTR";Yh.KIl="CommentPaneRTL";Yh.LIl="CommentPaneWithBorderButton";Object(k.a)(Yh,"CommentPaneHelper",null,[]);class Oa{constructor(){this.comment=this.slide=null;this.direction=0;this.C6e=null}}Object(k.a)(Oa,"CommentSelectContext",null,[]);var sb;(function(ea){ea[ea.previous=
0]="previous";ea[ea.next=1]="next"})(sb||(sb={}));Object(k.b)("CommentSelectDirection",sb);class Pb{constructor(ea,Ka){if(!ea||1>ea.length)throw Error.argument("ISlideNode[] slides");if(!Ka)throw Error.argumentNull("ICommentGraphManager graphManager");this.rSk=ea;this.Rl=Ka;this.BNe=[];this.init()}get bMa(){return this.rSk}get SN(){return this.BNe}get Bbb(){return this.SN[this.SN.length-1]}get RNb(){return 1<this.SN.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get kxd(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.T2l()}init(){for(const ea of this.bMa)for(const Ka of this.Rl.jva(ea.fF()))if(1===
Ka.status){this.BNe.push(ea);break}if(1>this.BNe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}T2l(){switch(this.SN.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.SN[1].ve+1,this.SN[0].ve+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.SN[2].ve+1,this.SN[1].ve+1,this.SN[0].ve+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.SN[3].ve+1,this.SN[2].ve+1,this.SN[1].ve+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.SN[this.SN.length-1].ve+1,this.SN[this.SN.length-2].ve+1,this.SN[this.SN.length-3].ve+1,this.SN.length-3)}}EBj(){for(const ea of this.Rl.dcb(this.Bbb))if(1===ea.status)return ea;return null}primaryButtonAction(ea,Ka){if(!Ka.presentation||!Ka.presentation.slides)return mb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
Ka.presentation?"Presentation.Slides":"Presentation"),null;const bb=this.EBj();if(!bb)return null;ea.Vl.isVisible||ea.P3a();if(Ka.Aa&&Qc.a.tca(Ka.Aa.Fb,this.Bbb.Fb))ea.ria(bb.commentId,1,!0);else for(const vb of Ka.presentation.slides)if(Qc.a.tca(vb.Fb,this.Bbb.Fb))return Object.assign(new Oa,{slide:this.Bbb,comment:bb,direction:1,C6e:ef.a.Zj("SelectResolvedCommentCrossSlide",1)});return null}}Object(k.a)(Pb,"ResolvedCommentsCalloutParams",null,[]);class kc{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(k.a)(kc,"SharedCommentsTaskPaneProps",null,[]);var Wc=d(1004),Xd=d(377),Gd=d(152);class Pe{constructor(ea,Ka,bb,vb,Yb,Gc,ud,Nd,Bc,qe,qg,Jf,Bd,Ld,sd,qd,Kd,Gk,of,om,mi,Oe,Ol,pm,tk,Oj,yk,bm,Hk,Af,rg,Li,Vf,Ej,Tj,dj,Pl,Si,Le,uj,Tk,bk,Ql,lk,qm,cm,Uh,cg,Pj,Rl,Uk,Sl,Ti,Jg,Uj,sl,Bm,yb){this.WNe=this.io=null;this.Qgb=!0;this.Gp=this.PFe=this.Qjc=this.zFe=this.Sgb=!1;this.Zhb=0;this.ujd=this.VJb=!1;this.OIa=this.Aid=this.Ii=this.WYa=this.ejb=this.gba=this.lMg=null;this.RRg=this.b_a=
!1;this.Ns=null;this.iOe=this.jFe=!1;this.N$g=null;this.cTf=[bf.a.xA,bf.a.Sr,bf.a.HX,bf.a.wWi];this.xqb=2147483647;this.WFb=0;this.i_g=-1;this.gOg=0;this.kmc=null;this.whd=this.hid=this.cDe=!1;this.NLa=(zk,ya)=>{ya.slide===this.sa.Aa&&(zk=this.zS.instance.jne||this.zS.instance.kne,!ya.slide.isUnread||zk)&&(ya=this.Rl.Zz(),this.cPb(ya,w.AFrameworkApplication.isRtl,!0))};if(!dj)throw Error.argumentNull("appSettingsManager");if(!Oe)throw Error.argumentNull("commentEventHost");if(!Ka)throw Error.argumentNull("commentTelemetryManager");
if(Ti.Cm&&!yb)throw Error.argumentNull("sorterViewActorLazy");this.HK=Uk;this.ia=bb;this.Db=vb;this.Vl=Yb;this.av=Gc;this.hd=ud;this.Fa=Nd;this.ih=Bc;this.te=qe;this.oa=qg;this.Jc=Bd;this.Pw=Ld;this.Qt=sd;this.Rl=ea;this.sF=Ka;this.kMk=new hh(ea);this.K6=qd;this.sa=Kd;this.Lkd=Gk.Cd(40);this.u1g=Qb.a("PreventCommentDraftDeletionOnPageContentChange")?Gk.Cd(7):Gk.Cd(8);this.iJb=Jf;this.OP=Bd.Ic?Bd.Ic.R5d:null;this.Axa=tk;this.zb=om;this.O1=Oe;this.Njb=Ol;this.i0g=mi;this.njd=pm;this.dDe=Oj;this.mdd=
yk;this.De=Af;this.phd=bm;this.xq=Hk;this.Gbd=rg;this.Pt=Li;this.LIb=Vf;this.ES=Ej;this.Ro=Tj;this.Lb=dj;this.tq=Si;this.vRg=Le;this.a6=new n.a;this.fe=uj;this.Xa=Tk;this.ajb=Ql;this.lxa=bk;this.Hc=lk;this.Ga=Uh;this.rRk=cg;this.BK=Pj;this.Ujc=Rl;this.Ba=Ti;this.jm=Jg;this.RY=Uj;this.Njc=cm;this.IJa=!1;this.ia.a3(this);this.ngb=new vi(this,this.ih);this.zS=sl;this.q2=Bm;this.lba=yb;if(!Pl)throw Error.argumentNull("InteractiveViewManagerFuture");this.eVg=Pl;this.JFk=this.x1i();this.HK&&this.Vl.jPl(this.BHj());
this.Ub=Sl;qm.oyb().then(zk=>{zk||this.y7e(!1)})}get yXc(){return this.vRg}get Mag(){return this.lxa}get A7b(){return this.Lb.Ea("CurrentCommentId")}get x9d(){return this.Lb.Ea("CurrentSlideId")}get jjl(){return this.Lb.getBooleanAppSetting("PPTSafeLinksIsEnabledForModernComments")}get KWi(){return this.Lb.getBooleanAppSetting("CommentTextAnchoringReadWriteEnabled")}get V5d(){return this.Lb.getBooleanAppSetting("CommentTextAnchoringCreateNewEnabled")}get s8f(){return this.Lb.getBooleanAppSetting("EnableDeleteAllComments")}get RFa(){return this.Lb.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}get yzb(){return Qb.a("CompactingDHCsEnabled")}get Cag(){return Qb.a("CanvasToCommentFocusFixV2")}get lec(){return this.Lb.getBooleanAppSetting("PPTOBlueDotsForComments")}initialize(){this.Gp=
1===this.Db.mode;this.HK||(this.Axa?Sys.UI.DomElement.addCssClass(this.iJb,Yh.KIl):Sys.UI.DomElement.addCssClass(this.iJb,Yh.JIl));const ea=this.Fa.Kc(bf.a.Sr);ea.uK=!0;ea.f5a=!0;ea.Zda(bb=>{const vb=!Qb.a("FixAltF12KeboardingInCommentPane")||!bb||bb.name!==bf.a.qT;this.Xqc(!0,!bb||bb.name!==bf.a.xA&&vb,!0)});ea.TDa((bb,vb)=>{bb=(vb.name===bf.a.mQ||vb.name===bf.a.aca)&&bb.name===bf.a.Sr;this.Xqc(!1,!1,vb.name===bf.a.Sr||vb.name===bf.a.Ag||vb.name===bf.a.xA||vb.name===bf.a.HX||vb.name===bf.a.qT||bb)});
const Ka=this.Fa.Kc(bf.a.xA);Ka.Zda((bb,vb)=>{this.C8k(bb,vb)});Ka.TDa(()=>{this.B8k()});this.HK||this.hd.iPb(ib.a.click,this.iJb,Object(qb.a)(this,this.cMb,"onCommentPaneParentDivClick"),null,ea.f5a);this.qb();this.Pw.TZd(Object(qb.a)(this,this.ELa,"onBeforeSlideSwitched"));this.Pw.kU(Object(qb.a)(this,this.ghf,"updateCommentsWhenNavigateSlide"));this.Qt.vSa(Object(qb.a)(this,this.iJf,"activeSlideDOMDisplayed"));this.xq.Vzi(Object(qb.a)(this,this.toh,"onPageViewZoomChanged"));this.tq.o_d(Object(qb.a)(this,
this.onShapeSelected,"onShapeSelected"));this.tq.pMf(Object(qb.a)(this,this.Oha,"onShapeDeselected"));this.Pw.zvb(Object(qb.a)(this,this.Eph,"onShapeTextSelected"));this.Pw.p_d(Object(qb.a)(this,this.Frc,"onSlideBackgroundClicked"));this.Njc&&(this.Pw.c3b(Object(qb.a)(this,this.g$k,"onSlideSizeUpdated")),this.Pw.EAi(Object(qb.a)(this,this.Cph,"onShapeRotatedOrBoundsUpdated")),this.Pw.AAi(Object(qb.a)(this,this.Cph,"onShapeRotatedOrBoundsUpdated")));this.Lkd.Ak(Object(qb.a)(this,this.Aqh,"onTextAnchorPropertyChanged"));
this.u1g.VE(Object(qb.a)(this,this.ZC,"onChildTopologyChanged"));this.Lkd.aEa(Object(qb.a)(this,this.vlh,"onBeforeTextAnchorDisconnect"));this.ajb.Ak(Object(qb.a)(this,this.Crc,"onShapePropertyChange"));this.ajb.Szi(Object(qb.a)(this,this.xph,"onShapeInvalidation"));this.Hc.Nxi(Object(qb.a)(this,this.Gmh,"onF6FocusDocument"));this.Hc.oOc(Object(qb.a)(this,this.Skb,"onSetFocus"));this.lec&&this.q2.execute(bb=>{bb.AOc(this.NLa)});this.Gbd.yOc(Object(qb.a)(this,this.Wpd,"onSessionExpired"));this.Gbd.aC(Object(qb.a)(this,
this.gza,"onSessionEnded"));this.Jc.Ic&&this.Jc.Ic.R5d&&(this.ELa(this,null),this.ghf(this,null));this.Db.QH(Object(qb.a)(this,this.clh,"onAppModeSwitched"));this.Db.cEa(Object(qb.a)(this,this.iQ,"onSetOffline"));this.Qt.yvb(Object(qb.a)(this,this.Ypd,"onShapeViewElementAddedOrRemoved"));this.Qt.rMf(Object(qb.a)(this,this.Ypd,"onShapeViewElementAddedOrRemoved"));this.oa.AG(Object(qb.a)(this,this.oE,"onSelectionChanged"))}Ypd(ea,Ka){this.io&&(ea=Ka.Vx)&&ea.shapeNode&&this.kqk(ea.shapeNode.slideId)&&
this.io.Iud(this.Rl.Zz())}kqk(ea){return!!this.sa&&!!this.sa.Mk&&this.sa.Mk.equals(ea)}y7e(ea){this.lxa=this.vRg=ea;this.Ro.y7e(ea)}g$k(){this.io&&this.io.Ihf()}Cph(ea,Ka){if(this.io){const bb=Ka.Vx.shapeNode;if(bb){if((ea=this.Rl.Zz())&&ea.length){Ka=[];for(const vb of ea)vb.anchorShape===bb.get_shapeId()&&Ka.push(vb);this.io.djm(Ka)}}else mb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}Aim(){try{if(this.Vl){const ea=Object(Wb.a)(1505,this.Vl);ea&&(ea.fQh=
!!this.Ii)}}catch(ea){mb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",ea)}}Hag(){return this.Ii&&this.Ii.Z9&&this.sa.Aa?!Qc.a.tca(this.Ii.Z9,this.sa.Aa.Fb):!1}Ozb(){return this.Ii&&this.sa.Aa?!this.Ii.Z9||Qc.a.tca(this.Ii.Z9,this.sa.Aa.Fb):!1}QEh(){if(this.Ns&&this.Ns.isIntegratedExtensionEnabled()){const ea=this.Rl.Zz(),Ka=!this.RFa||!this.IJa;ea&&0<ea.length&&(this.cT(!0,!0,Ka),this.Avd());this.Ozb()&&this.PEh(this.Ii)}}T7k(){if(this.Ba.L$)this.Db.rLa(1);
else if(this.Ns){this.Aim();this.QEh();const ea=this.vQb;ea&&0!==ea.status&&this.NOa(1)}}U7k(){this.K7b();const ea=!this.RFa||!(this.R0()&&this.IJa);this.cT(!1,!1,ea);this.Ba.L$&&this.Db.rLa(1)}g8k(ea){this.WFb!==ea&&(this.WFb=ea,this.Jc&&this.Jc.Ic&&this.Jc.Ic.$2h(2,!1,this.WFb))}pxg(){const ea=Object.assign(new Pi,{paneClosedCallback:Object(qb.a)(this,this.T7k,"onPaneClosedCallback"),paneOpenedCallback:Object(qb.a)(this,this.U7k,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(qb.a)(this,
this.g8k,"onPositionUpdatedScrollHeightCallback")});ea.allContainersVisibleCallback=Object(qb.a)(this,this.F2k,"onAllContainersVisible");this.Ns=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(ea)}hak(){this.jjl&&this.rRk.execute(ea=>{const Ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();Ka?Ka.registerSafelinksNavigator(Object(qb.a)(ea,ea.eEd,"tryNavigate")):mb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}K8j(){this.pxg();
this.cT(!0,!1,!0);this.jFe=!0;const ea=this.X$b();Vb.a.Nud(ea,[ib.a.contextMenu]);if(this.Ns){this.Ns.setDhcContainerPanel(ea,this.Axa);var Ka=Object.assign(new tj,{width:parseFloat(ea.style.width),height:this.xqb,x:0,y:0});this.Ns.updateViewport(Ka);this.Ns.setCompactContainers(this.yzb)}this.Avd();this.sF.n5k(this.sa.Mk);Ka=this.Fa.Kc(bf.a.HX);Ka.uK=!0;Ka.f5a=!0;Ka.Zda(bb=>{this.Xqc(!0,!bb||bb.name!==bf.a.xA,!0)});Ka.TDa((bb,vb)=>{bb=(vb.name===bf.a.mQ||vb.name===bf.a.aca)&&bb.name===bf.a.HX;this.Xqc(!1,
!1,vb.name===bf.a.Sr||vb.name===bf.a.Ag||vb.name===bf.a.xA||vb.name===bf.a.HX||vb.name===bf.a.qT||bb)});this.Fa.O4c(bf.a.HX,bf.a.Nj,ea);this.SBh();this.ia.xa(Cd.a.n3,jc.a.frame,Object(qb.a)(this,this.n3,"showHideComments"))}Avd(){const ea=this.Rl.Zz();this.MEh(ea)}SBh(){if(this.Ns){const ea=this.X$b();if(ea){const Ka=this.Fa.Kc(bf.a.HX);this.hd.iPb(ib.a.click,ea,Object(qb.a)(this,this.cMb,"onCommentPaneParentDivClick"),null,Ka.f5a)}}}k1h(){if(this.Ns){const ea=this.X$b();ea&&this.hd.Hb(ib.a.click,
ea,Object(qb.a)(this,this.cMb,"onCommentPaneParentDivClick"))}}X$b(){const ea=this.Jc&&this.Jc.Ic?this.Jc.Ic.yea:null;return ea?ea.va:null}MEh(ea){if(this.Jc.Ic&&this.jFe){if(!this.Ns)try{this.pxg(),mb.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.Ns)}catch(vb){mb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",vb);return}var Ka=Date.now();if((ea=this.V4f(ea))&&
ea.length){var bb=this.X$b();bb.setAttribute(pf.a.Ff,"group");if(bb){this.a6=this.uxj(ea);mb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.a6.count);if(!this.a6.count&&!this.HXa){this.cT(!1,!1,!0);mb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-Ka);return}this.Ns.setDhcContainerPanel(bb,this.Axa);this.Ns.attachContainers(this.a6.toArray());this.cT(!0,!1,!0)}mb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",
Date.now()-Ka)}}}V4f(ea){if(!ea||!ea.length)return ea;const Ka=new n.a;for(const bb of ea)0!==bb.status?this.U4f(bb.commentId):Ka.add(bb);return Ka.toArray()}ekm(){this.cDe=!1;if(!this.Ro.XSh&&!this.Ro.OX&&this.Jc.Ic){var ea=this.Rl.dcb(this.Jc.Ic.gd);for(const Ka of ea)if(0===Ka.status){this.selectComment(Ka,null,!0,!0,0,0,!1);break}}}YMj(){if(!this.Jc||!this.Jc.Ic||!this.Jc.Ic.gd)return this.xqb;var ea=this.Jc.Ic.gd;if(isNaN(ea.yl))return this.xqb;ea=ea.yl;return 0>ea?this.xqb:ea}Ufg(ea){var Ka=
this.Ro.d$(ea);ea=ea.pos.Y;Ka&&(ea+=Ka.gD.y,Ka.Rg&&(Ka=this.Ga.zt(Ka),ea+=Ka&&Ka.gD?Ka.gD.y:0));return this.SEa(0,ea).y}lhf(){if(this.Ns){const ea=this.YMj();ea!==this.i_g&&(this.i_g=ea,this.Ns.setSlideHeight(ea))}}PEh(ea){if(ea&&0===ea.FTa){var Ka=0;if(this.yzb)Ka=-this.xqb,this.lhf();else{const bb=this.oa.Zn();bb&&(Ka=this.SEa(0,bb.gD.y).y)}Ka=Object.assign(new Aj,{contentId:ea.FD.draftId,containerContentType:0,anchorTop:Ka,anchorLeft:0});this.cT(!0,!0,!0);this.Ns.setDhcContainerPanel(this.X$b(),
this.Axa);this.Ns.updateDrafting(Ka,!0);this.Ns.selectContainer(ea.FD.draftId,!0)}}QDl(ea){if(this.a6){var Ka=0,bb="";if(this.yzb){var vb=this.oa.Zn();vb&&(Ka=this.SEa(0,vb.gD.y).y);if(vb=this.Rl.Zz())for(const Yb of vb)ic.a.Ta(Yb.commentId)||this.Ufg(Yb)!==Ka||(bb=Yb.commentId)}Ka=Object.assign(new Aj,{contentId:ea,containerContentType:0,anchorTop:Ka,anchorLeft:0});this.yzb?this.Ns.updateDraftingAndPosition(Ka,!1,bb):this.Ns.updateDrafting(Ka,!1);this.Ns.selectContainer(ea,!0)}}U4f(ea){if(this.Ns&&
this.a6){for(const Ka of this.a6)Pe.zgh(Ka,ea)&&(this.Ns.detachContainers([Ka]),this.a6.remove(Ka));this.R0()||this.HXa||this.cT(!1,!1,!0)}}fPl(){this.cDe=!0}KWc(){this.Vl&&this.Vl.isVisible&&this.Vl.zLl()}Kkj(){var ea=this.sa.presentation;if(!ea)return!1;ea=ea.slides;if(!ea)return!1;for(const Ka of ea)if(ea=Object(Wb.a)(Ie.a,Ka))for(const bb of this.Rl.jva(ea.fF()))if(nc.QO(bb))return!0;return!1}Nke(ea){var Ka=this.sa.presentation;if(!Ka)return null;Ka=Ka.slides;if(!Ka)return null;for(const bb of Ka)if(Ka=
Object(Wb.a)(Ie.a,bb),Qc.a.tca(Ka.Fb,ea))return Ka;return null}Bkj(){return this.V5d||this.KWi&&this.Kkj()}zpg(){const ea=this.oa.Oa.kb,Ka=this.oa.Oa.s3;if(!ea||!Ka)return null;var bb=Object(Wb.a)(5,ea.Ua.node),vb=Object(Wb.a)(5,Ka.Ua.node);if(!bb||!vb)return null;bb=Object(Wb.a)(Og.TableCellNode,bb.xM());vb=Object(Wb.a)(Og.TableCellNode,vb.xM());return bb&&vb?bb.rowIndex>vb.rowIndex?ea:Ka:null}lPj(){if(!this.Bkj()||!this.oa.i1())return null;mb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");
var ea=0,Ka=0;if(this.oa.Oa.qm){var bb=this.zpg();if(!bb)return mb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var vb=bb}else vb=this.oa.Oa.kb;if(!vb)return mb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const Yb=({aOa:ea,FFa:Ka}=nc.kPj(this.oa.Z0(),vb,ea,Ka)).returnValue;if(!Yb||0>ea||0>Ka||0>=Ka-ea)return mb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",
!Yb,Ka,ea),null;bb=new ge.a;bb.StartPos=ea;bb.EndPos=Ka;if(this.oa.kYa()&&Yb.get_smartArtModelId()){mb.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");bb.AnchoringShape=new $d.a;ea=Q.a.Tf(Yb.get_smartArtModelId()).toString();if(!ea||!Q.a.isValid(ea))return mb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!ea),null;bb.AnchoringShape.SmartArtNodeId=ea;
this.sF.eEk()}else if(Yb.Ft()){mb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");Ka=Object(Wb.a)(Og.TableCellNode,Yb.xM());if(!Ka)return mb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;ea=Ka.rowId.toString();Ka=Ka.cellId.toString();if(!(ea&&Ka&&Q.a.isValid(ea)&&Q.a.isValid(Ka)))return mb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",
!ea,!Ka),null;bb.AnchoringShape=new $d.a;bb.AnchoringShape.TableCell=new rh;bb.AnchoringShape.TableCell.RowId=ea;bb.AnchoringShape.TableCell.ColId=Ka;this.sF.fEk()}ea=Object(Wb.a)(5,vb.Ua.node);vb=Object(Wb.a)(5,vb.vf.node);ea!==vb&&this.sF.hEk();mb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return bb}Oaj(ea){if(this.Ns&&ea){for(const Ka of this.a6.toArray()){let bb=!1;for(const vb of ea)if(Pe.zgh(Ka,vb.commentId)){bb=!0;break}bb||(this.Ns.detachContainers([Ka]),
this.a6.remove(Ka),mb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",Ka.contentId))}this.R0()||this.HXa||this.cT(!1,!1,!0)}}K7b(){if(this.Ns){for(const ea of this.a6.toArray())this.Ns.detachContainers([ea]);this.a6.clear()}this.R0()||this.HXa||(this.RFa&&!this.IJa?this.cT(!1,!1,!1):this.cT(!1,!1,!0))}hbf(ea){if(!ea)return null;ea.sort((Ka,bb)=>{var vb=this.Ro.d$(Ka);vb=vb?vb.gD:new Hc.a(0,0);var Yb=this.Ro.d$(bb);Yb=Yb?Yb.gD:new Hc.a(0,0);vb.y+=Ka.pos.Y;Yb.y+=bb.pos.Y;
vb.x+=Ka.pos.X;Yb.x+=bb.pos.X;let Gc=vb.y-Yb.y;Gc||(Gc=vb.x-Yb.x)||(Gc=+Ka.dt-+bb.dt);return Gc});return ea}uxj(ea){const Ka=new n.a;if(ea){this.yzb&&this.lhf();for(const bb of ea)ic.a.Ta(bb.commentId)||(ea=this.Ufg(bb),ea=Object.assign(new Aj,{contentId:bb.commentId,containerContentType:0,anchorTop:ea,anchorLeft:0}),Ka.add(ea))}return Ka}iQ(ea){this.Enh(ea)}ICh(ea,Ka){for(let bb=0;bb<ea.Sa.length;bb++){const vb=ea.Sa.ga(bb);if(!vb.Kg)continue;const Yb=[];for(let Gc=0;Gc<vb.Kg.length;Gc++){const ud=
vb.Kg.ga(Gc);ud.VH.equals(Ka)&&Yb.push(ud)}if(!(1>Yb.length))try{ea.mra=!0;for(const Gc of Yb)vb.Kg.remove(Gc)}catch(Gc){mb.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",Gc.toString())}finally{ea.mra=!1}}}FJf(ea,Ka,bb){ea.Kg||(ea.Kg=new fi.a(ea));const vb=ea.Kg.Qe.paragraph;Ka=new Qi.a(ea.Kg.Qe,null,Ka,bb);ea.Kg.add(Ka);vb.$v()}zTc(ea){return he.a.Tf("{"+ea+"}{1}")}G2b(ea,Ka,bb,vb){let Yb=null;for(let Gc=0;Gc<ea.Sa.length;Gc++){let ud=
ea.Sa.ga(Gc);if(ud.cp>=bb){try{ea.mra=!0;if(ud.cp>bb||!ud.formatting)this.BK.Gia(ea,Gc,bb,Yb),ud=ea.Sa.ga(Gc);this.FJf(ud,Ka,vb)}catch(Nd){mb.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Nd.toString())}finally{ea.mra=!1}return}ud.formatting&&(Yb=ud.formatting)}if(Yc.ParagraphReader.textLength(ea)>=bb)try{ea.mra=!0;this.BK.Gia(ea,ea.Sa.length,bb,Yb);const Gc=ea.Sa.ga(ea.Sa.length-1);this.FJf(Gc,Ka,vb)}catch(Gc){mb.a.J(512496736,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Gc.toString())}finally{ea.mra=!1}}z8b(){var ea=this.Rl.Zz();if(ea){var Ka=Date.now(),bb=!1,vb=new Ta.a;for(var Yb of ea){var Gc=nc.Bbc(Yb,this.Ro.d$(Yb));vb.$(Yb.commentId,Gc)}for(var ud of ea)if(ud.textAnchoringInfo&&(Yb=this.Ro.d$(ud))&&(Gc=vb.ga(ud.commentId),!Gc||!Gc.isValid||Gc.tGg(ud.textAnchoringInfo)))for(var Nd of Yb.aA())this.ICh(Object(Wb.a)(Jb.AParagraphNode,Nd),this.zTc(ud.commentId));
for(const Bc of ea)if((ea=vb.ga(Bc.commentId))&&ea.isValid&&ea.tGg(Bc.textAnchoringInfo)&&(this.Vl.isVisible||0===Bc.status)){bb=this.zTc(Bc.commentId);this.G2b(ea.wW,bb,ea.startPos,!0);if(ea.cgc)for(ud=1;ud<ea.paragraphs.length;ud++){if(Nd=ea.paragraphs[ud])this.G2b(Nd,bb,0,!0),ea.d5.equals(Nd)?this.G2b(ea.d5,bb,ea.endPos,!1):this.G2b(Nd,bb,Yc.ParagraphReader.textLength(Nd),!1)}else this.G2b(ea.d5,bb,ea.endPos,!1);ea.Ick();bb=!0}bb&&mb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",
Date.now()-Ka)}}Aqh(ea,Ka){if((ea=this.Rl.iva(Ka.node))&&(Ka.property===Rf.a.pAc||Ka.property===Rf.a.oAc||Ka.property===Rf.a.JCd||Ka.property===Rf.a.KCd)){const bb=nc.QO(ea);bb&&this.z8b();!ea.textAnchoringInfo||bb||Ka.property!==Rf.a.KCd&&Ka.property!==Rf.a.JCd||this.sF.gEk(ea,this.zTc(ea.commentId),this.Ro.d$(ea),this.Jc.Ic.Na)}}P8f(){this.Ii&&this.gba&&(this.O1.U6e(this.gba.length,this.Zhb,this.Gp,this.dDe.X9c),this.O1.Y6e(Array.clone(this.gba),Array.clone(this.ejb)),this.dWf(2))}Tqk(ea,Ka){Ka=
this.Ub.Pc(Ka);for(var bb=Ka.Gb(2);bb;bb=Ka.Qf(2))if((bb=Object(Wb.a)(267,bb))&&Qc.a.tca(bb.Fb,ea))return!0;return!1}ZC(ea,Ka){Ka&&(ea=Object(Wb.a)(688,Ka.node),Ka=Ka.vU,ea&&2===Ka&&((Ka=this.K6.Of)&&Ka.slides&&0>=Ka.slides.length&&this.Vl.isVisible&&this.qvc(!1,!1),this.Ii&&(Ka=this.Ii.Z9,!Ka&&this.sa.Aa&&(Ka=this.sa.Aa.Fb),this.Tqk(Ka,ea)||this.P8f())))}vlh(ea,Ka){if((ea=this.Rl.iva(Ka.node))&&nc.QO(ea)&&(Ka=this.Ro.d$(ea)))for(const bb of Ka.aA())this.ICh(Object(Wb.a)(Jb.AParagraphNode,bb),this.zTc(ea.commentId))}xph(ea,
Ka){(ea=Object(Wb.a)(4,Ka.node))&&0<ea.aA().length&&(Ka.Yyg&192||Ka.Yyg&4)&&this.z8b()}Crc(ea,Ka){ea=Ka.property;Ka=Ka.node;if(ea===td.a.zz||ea===td.a.Az)if(ea=this.Rl.Zz()){for(const bb of ea)bb.pos.Y=Ka.gD.y,bb.pos.X=Ka.gD.x;this.Avd()}}Wpd(){mb.a.J(512496734,805,this.odb?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.odb)}gza(ea,Ka){mb.a.J(512496733,805,this.odb?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",Xd.a[Ka.uE],this.odb)}dispose(){this.io&&
(this.io.dispose(),this.io=null);this.LIb&&(this.LIb.dispose(),this.LIb=null);this.Pw.NDh(Object(qb.a)(this,this.ELa,"onBeforeSlideSwitched"));this.Pw.wqa(Object(qb.a)(this,this.ghf,"updateCommentsWhenNavigateSlide"));this.Pw.uPb(Object(qb.a)(this,this.iJf,"activeSlideDOMDisplayed"));this.xq.$Bl(Object(qb.a)(this,this.toh,"onPageViewZoomChanged"));this.tq.B3e(Object(qb.a)(this,this.onShapeSelected,"onShapeSelected"));this.tq.xEh(Object(qb.a)(this,this.Oha,"onShapeDeselected"));this.Pw.Pvc(Object(qb.a)(this,
this.Eph,"onShapeTextSelected"));this.Pw.AEh(Object(qb.a)(this,this.Frc,"onSlideBackgroundClicked"));this.ajb.tn(Object(qb.a)(this,this.Crc,"onShapePropertyChange"));this.ajb.XBl(Object(qb.a)(this,this.xph,"onShapeInvalidation"));this.Hc.FAl(Object(qb.a)(this,this.Gmh,"onF6FocusDocument"));this.Hc.t3e(Object(qb.a)(this,this.Skb,"onSetFocus"));this.lec&&this.q2.execute(ea=>{ea.E3e(this.NLa)});this.Lkd.tn(Object(qb.a)(this,this.Aqh,"onTextAnchorPropertyChanged"));this.u1g.RN(Object(qb.a)(this,this.ZC,
"onChildTopologyChanged"));this.Lkd.UMa(Object(qb.a)(this,this.vlh,"onBeforeTextAnchorDisconnect"));this.Db.a_(Object(qb.a)(this,this.clh,"onAppModeSwitched"));this.Gbd.z3e(Object(qb.a)(this,this.Wpd,"onSessionExpired"));this.Gbd.F7(Object(qb.a)(this,this.gza,"onSessionEnded"));this.Db.Cmb(Object(qb.a)(this,this.iQ,"onSetOffline"));this.HK||this.hd.Hb(ib.a.click,this.iJb,Object(qb.a)(this,this.cMb,"onCommentPaneParentDivClick"));this.k1h();this.OP=this.iJb=null;this.Qt.vvd(Object(qb.a)(this,this.Ypd,
"onShapeViewElementAddedOrRemoved"));this.Qt.xCl(Object(qb.a)(this,this.Ypd,"onShapeViewElementAddedOrRemoved"));this.oa.Xza(Object(qb.a)(this,this.oE,"onSelectionChanged"))}get isReadOnly(){return this.Gp}get HXa(){return!!this.Ii}get hasFocus(){return this.zFe}x1i(){const ea=new Gd.a;var Ka=new ui(Cd.a.cDb,bi.a.application);Ka.preCallback=Object(qb.a)(this,this.HRc,"claimFocus");Ka.postCallback=Object(qb.a)(this,this.M5f,"disableOnEmptyDeckAndReadOnly");ea.$(0,Ka);Ka=new ui(Cd.a.deleteComment,bi.a.application);
Ka.preCallback=Object(qb.a)(this,this.HRc,"claimFocus");Ka.postCallback=Object(qb.a)(this,this.M5f,"disableOnEmptyDeckAndReadOnly");ea.$(3,Ka);Ka=new ui(Cd.a.nZe,bi.a.application);Ka.preCallback=Object(qb.a)(this,this.HRc,"claimFocus");Ka.postCallback=Object(qb.a)(this,this.dvh,"postCommentAction");ea.$(2,Ka);Ka=new ui(Cd.a.tSe,bi.a.application);Ka.preCallback=Object(qb.a)(this,this.HRc,"claimFocus");Ka.postCallback=Object(qb.a)(this,this.dvh,"postCommentAction");ea.$(1,Ka);Ka=new ui(gb.a.nDd,bi.a.application);
Ka.preCallback=Object(qb.a)(this,this.s0l,"showHideActionPreCallback");Ka.postCallback=Object(qb.a)(this,this.r0l,"showHideActionPostCallback");Ka.delayActionsUntilRegistration=this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Qb.a("DelayCommentsShowHideAction");ea.$(6,Ka);return ea}s0l(ea,Ka,bb,vb,Yb){if(1===bb)return!this.sa.Aa||this.isDisabled?8:2;mb.a.J(36983504,805,50,"New Comment Pane opened.");this.Vl.rLa(!!Yb&&Yb.AutoShowHide);return 2}r0l(ea,Ka,bb,vb,
Yb,Gc){if(1===vb)return ea&&this.sF.M3k(this.sa.Mk),ea?32:8;this.OMf(this.Vl.isVisible,!!Gc&&Gc.AutoShowHide);return ea?32:8}HRc(ea,Ka,bb,vb,Yb){if(1===bb&&this.oa.yXa())return 8;1!==bb&&((this.Qjc=!!Yb&&Yb.ShouldCanvasTakeFocus)||this.Fua(),this.oa.Pu(),this.PFe=!0);return 2}dvh(ea,Ka,bb,vb){if(1===vb&&(this.b_a||!this.gba))return 8;this.Qjc=!1;return ea?32:8}M5f(ea,Ka,bb,vb){return(1!==vb||!this.Gp&&this.gba)&&this.Jc.Ic?ea?32:8:8}SEa(ea,Ka){return new Hc.a(this.phd.Ve(ea,0),this.phd.Ve(Ka,1))}H_f(ea,
Ka){return new Hc.a(this.phd.Cf(ea,0),this.phd.Cf(Ka,1))}PAb(ea){ea=this.Rl.ova(ea);return this.Rl.iva(ea)}ria(ea,Ka,bb){!this.Hag()||ea!==this.Ii.FD.draftId&&ea!==this.Ii.commentId?this.Ozb()&&ea===this.Ii.FD.draftId?(this.O1.selectComment(ea),this.Ns&&this.Ns.selectContainer(ea,!0),this.Cag&&!this.hasFocus&&1!==Ka&&this.Fua()):this.selectComment(this.PAb(ea),null,!0,!0,0,Ka,bb):(ea=this.Nke(this.Ii.Z9),ea)?1!==Ka&&(this.Ii.K8c=!0,this.Ba.Cm?this.lba.instance&&this.lba.instance.RI(ea.ve):this.De.RI(ea.ve)):
(mb.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.Ii.FD.draftId,0))}selectComment(ea,Ka,bb,vb,Yb,Gc,ud){this.oa.Pu();Ka=this.vQb?this.vQb.commentId:null;ud||this.KWc();0!==Gc?ea?this.O1.selectComment(ea.commentId):this.O1.selectComment(null):0===Gc&&(Gc=this.Ro.d$(ea))&&Gc.fM&&this.Ro.Rxd(Qf[Gc.fM]);this.io&&this.io.selectComment(ea,!0);!this.Vl.isVisible&&this.Ns&&ea&&ea!==this.WYa&&(Gc=this.Rl.gke(ea.commentId))&&
(Gc=this.Rl.iva(Gc),this.Ns.selectContainer(Gc.commentId,!this.Qjc&&!ud&&!this.PFe),this.PFe=!1,this.Jc&&this.Jc.Ic&&this.Jc.Ic.dFd(5,!1,this.WFb));ud||this.Qjc||this.Fua();!this.Ro||!this.Vl.isVisible&&this.Vl.isVisible||(this.Ro.D6e(ea,Ka,!0,!1,ud),nc.QO(ea)&&!ud&&this.z8b());this.Db.Gf()}get vQb(){return this.io&&this.io.yQb?this.io.yQb.comment:null}DLl(){if(!this.b_a){const ea=ef.a.Zj("SelectNextCommentCrossSlide",1),Ka=!this.Vl.isVisible;this.b_a=!0;this.mdd.Pde((bb,vb)=>{this.Umh(bb,vb,1,ea)},
ea,Ka)}}GLl(){if(!this.b_a){const ea=ef.a.Zj("SelectPreviousCommentCrossSlide",1),Ka=!this.Vl.isVisible;this.b_a=!0;this.mdd.Wde((bb,vb)=>{this.Umh(bb,vb,0,ea)},ea,Ka)}}Umh(ea,Ka,bb,vb){vb.Xm("FindCommentEndTime",new Date);this.zb.Jb(new Md.a(2,1,100,()=>{this.b_a&&(this.b_a=!1,this.gYl(ea,Ka,bb)?this.ria(this.Ii.commentId||this.Ii.FD.draftId,0,!1):Ka&&ea&&this.Jc.Ic.gd?ea.Fb.equals(this.Jc.Ic.gd.Fb)?(this.selectComment(Ka,null,!0,!0,2,1,!1),vb.Wa("CircularSelectCommentInSingleSlide",sb[bb]),vb.finish()):
(this.OIa=Object.assign(new Oa,{slide:ea,comment:Ka,direction:bb,C6e:vb}),this.Ba.Cm?this.lba.instance&&this.lba.instance.RI(ea.ve):this.De.RI(ea.ve)):(this.Db.Gf(),vb.Wa("NoCommentFound",sb[bb]),vb.finish()))},90,"47"))}skg(){let ea=-1;if(!this.Ii)return ea;if(this.Ii.Z9){const Ka=this.Nke(this.Ii.Z9);Ka&&(ea=Ka.ve)}else this.Jc.Ic&&this.Jc.Ic.gd&&(ea=this.Jc.Ic.gd.ve);return ea}gYl(ea,Ka,bb){if(!this.Ii||this.Ii.FD.sessionType!==fc.create)return!1;const vb=this.skg();if(0>vb)return!1;if(!Ka||!ea)return!0;
Ka=this.Jc.Ic.gd.ve;if(1===bb)return bb=vb<=Ka&&Ka<ea.ve,Ka=ea.ve<=Ka&&Ka<vb,vb<=ea.ve&&!bb||Ka;bb=vb>=Ka&&Ka>ea.ve;Ka=ea.ve>=Ka&&Ka>vb;return vb>ea.ve&&!bb||Ka}NOa(ea){0!==ea&&this.O1.selectComment(null);this.io&&this.io.selectComment(null,!1);if(this.Ns&&(this.Ns.deselectContainer(),this.Jc&&this.Jc.Ic)){let Ka=5;const bb=this.oa.Zn();bb&&bb.ig&&(Ka=2);this.Jc.Ic.dFd(Ka,!1,this.WFb)}this.Ro&&0!==ea&&(this.Ro.bVc(),this.Ro.EUc());this.Db.Gf()}tsi(ea){this.dvb(this.PAb(ea),0)}dvb(ea,Ka){this.WYa!==
ea&&(this.Ro&&(ea?this.Ro.ssi(ea):this.Ro.EUc()),this.WYa=ea,0!==Ka&&(this.WYa?this.O1.highlightComment(this.WYa.commentId):this.O1.highlightComment(null)),this.io&&this.io.dvb(this.WYa,!0))}BLl(){this.Ba.L$&&!this.Vl.isVisible&&this.P3a();if(this.A7b){var ea=this.PAb(this.A7b),Ka=this.Jc.Ic.gd.sid,bb=Ka===parseInt(this.x9d);ea?(1!==ea.status&&2!==ea.status||this.P3a(),this.selectComment(ea,null,!0,!0,0,1,!1),this.sF.k4k(this.sa.Mk),mb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
this.A7b,this.x9d)):(bb&&this.fe.At(Object.assign(new Cg.a,{Code:389,Source:4}),this.Xa.podSessionId),mb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.A7b,this.x9d,parseInt(Ka)))}}get manager(){return this.Rl}get yU(){return"per"}get xgh(){return this.OP}set xgh(ea){this.OP=ea;this.io&&(this.io.parentElement=ea)}get ajh(){return this.kmc}set ajh(ea){this.kmc=ea}Iud(ea){this.cPb(ea,void 0,!0)}p7(ea,Ka){Ka=!Qb.a("FixAltF12KeboardingInCommentPane")||
Ka;this.Xqc(ea,Ka,!0)}i2e(){!this.HK&&this.Vl&&(this.iJb.style.display=this.Vl.isVisible?"flex":"none");this.io&&(this.io.setVisibility(this.Qgb),this.io.CRh(this.Sgb),this.Ro.Tyb(this.WYa))}qvc(ea,Ka){this.e0h(ea,Ka);this.i2e();this.OMf(ea,Ka)}toh(){this.io&&!this.Njc&&this.io.Ihf();this.Avd();this.yzb&&this.lhf()}fkl(){this.b_a=!1;this.g9f();this.io&&this.io.I2e();this.VJb=!1;this.k1h()}g9f(){this.Rl.u1h()}ELa(){this.IJa=this.R0()||this.Ozb();this.Ro&&this.IJa&&(this.Ro.bVc(),this.Ro.EUc());this.fkl();
this.lHi()}NYl(){return this.Ii&&this.Ii.Z9&&this.sa.Aa?this.Ii.K8c&&Qc.a.tca(this.Ii.Z9,this.sa.Aa.Fb):!1}ghf(){this.sa.Aa||this.ELa(this,null);this.g9f();this.Jc.Ic&&(this.xgh=this.Jc.Ic.R5d);const ea=this.Jc&&this.Jc.Ic?this.Rl.dcb(this.Jc.Ic.gd):this.Rl.Zz(),Ka=this.gDj(ea),bb=this.R0()||this.Ozb();this.hid||bb||(this.jm.Nnd(this.jm.W3d,this.jm.U5d),this.hid=!0);this.Vl.isVisible||(bb?(this.K7b(),this.QEh()):this.R0()?(this.K7b(),this.cT(!0,!1,!0)):this.RFa&&!this.IJa?this.cT(!1,!1,!1):this.cT(!1,
!1,!0),this.SBh());this.cPb(ea,w.AFrameworkApplication.isRtl,!1,Ka);this.NYl()?(this.ria(this.Ii.commentId||this.Ii.FD.draftId,0,!1),this.Ii.K8c=!1):-1<Ka&&this.ria(ea[Ka].commentId,0,!1);this.OIa&&(this.OIa.C6e.finish(),this.OIa=null);this.Y4a(!1);-1!==Ka&&this.io&&(this.io.dvb(null,!1),this.io.selectComment(ea[Ka],!1))}iJf(){if(this.iOe){try{this.ngb.w1l(this.N$g,this.sa,this.De)}catch(ea){mb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",
ea)}this.iOe=!1}}Y4a(ea){const Ka=this.skg();this.dDe.Y4a(ea,Ka)}Qhm(ea){this.Ii&&!this.Ii.Z9&&(this.Ii.Z9=ea)}onShapeSelected(ea,Ka){this.yXc&&(ea=Ka.shapeNode,this.s9e(ea),ea&&0<ea.aA().length&&this.z8b())}Eph(ea,Ka){this.yXc&&(this.s9e(Ka.Vx.shapeNode),this.z8b())}oE(ea,Ka){if(Ka&&Ka.wl&&this.oa.i1()&&(ea=this.Rl.Zz())){Ka=!1;for(var bb of ea)if(nc.QO(bb)){Ka=!0;break}Ka&&((bb=this.oa.Z0())?this.s9e(bb):mb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}s9e(ea){ea.get_shapeId()&&
(this.Ro&&ea!==this.Ro.OX&&this.NOa(1),this.ZJh(ea.get_shapeId(),!0))}ZJh(ea,Ka){var bb=this.Rl.Zz();if(bb){var vb=null,Yb=null,Gc=0,ud=null;for(const Nd of bb)if((this.Vl.isVisible||0===Nd.status)&&Nd.anchorShape===ea)if(this.oa.i1()&&nc.QO(Nd)){bb=this.oa.Oa.kb.Ua;const Bc=this.oa.Oa.kb.vf,qe=nc.Bbc(Nd,this.Ro.d$(Nd));qe&&qe.isValid?(this.vQb&&this.vQb.commentId===Nd.commentId||qe.MCd===Nd.textAnchoringInfo.TextBodyLength)&&qe.Agk(bb,Bc)&&(Yb?(bb=qe.lAh,bb<Gc&&(Yb=Nd,Gc=bb)):(Yb=Nd,Gc=qe.lAh)):
(vb=Nd,mb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else Yb||ud||nc.QO(Nd)||(ud=Nd);Yb?this.ria(Yb.commentId,1,Ka):ud?this.ria(ud.commentId,1,Ka):this.oa.i1()&&!vb?this.Ro&&this.NOa(1):vb&&this.ria(vb.commentId,1,Ka)}}Oha(){if(this.yXc){var ea=this.Tge();this.Ro.Rxd(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,ea.toString()));this.NOa(1)}}Tge(){const ea=this.Rl.Zz();let Ka=[];ea&&(Ka=sk.e(ea,bb=>0===bb.status));
return Ka.length}Frc(){this.yXc&&this.NOa(1)}Gmh(ea,Ka){Ka.qkb===bf.a.Ag&&this.Ro.Rxd(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.Tge().toString()));Ka.ONb===bf.a.Ag&&this.NOa(1)}Skb(ea,Ka){this.Cag&&Ka.qkb!==bf.a.HX&&(Ka.ONb===bf.a.HX||bf.a.xA)&&this.odb&&this.NOa(1)}gDj(ea){let Ka=-1;if(this.OIa&&this.Jc.Ic)if(this.OIa.slide!==this.Jc.Ic.gd)mb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");
else if(ea&&0<ea.length){if(this.Vl.isVisible)Ka=1===this.OIa.direction?0:ea.length-1;else if(1===this.OIa.direction)for(var bb=0;bb<ea.length;bb++){if(0===ea[bb].status){Ka=bb;break}}else for(bb=ea.length-1;0<=bb;bb--)if(0===ea[bb].status){Ka=bb;break}0<=Ka&&Ka<ea.length&&(ea=ea[Ka],bb=this.OIa.comment,bb.dt===ea.dt&&bb.commentId===ea.commentId&&bb.authorName===ea.authorName||mb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return Ka}aUe(){!this.Rl.eCj()||
this.whd?(this.cPb(this.Rl.Zz(),w.AFrameworkApplication.isRtl,!0),this.whd&&(this.whd=!1)):this.Ii&&(0===this.Ii.FTa||1===this.Ii.FTa?(this.Mag&&this.cPb(this.Rl.Zz(),w.AFrameworkApplication.isRtl,!0),0===this.Ii.FTa&&(this.ujd=!0)):this.Ii&&2===this.Ii.FTa&&this.Mag&&this.cPb(this.Rl.Zz(),w.AFrameworkApplication.isRtl,!0))}Q3k(){xd(this.Lb)&&(this.whd=!0,this.aUe())}get Kxd(){const ea=this.oa.Zn();if(ea){const Ka=ea.gD;this.WNe=new Hc.a(w.AFrameworkApplication.isRtl?Ka.x:Ka.x+ea.zy,Ka.y)}else this.WNe=
null;return this.WNe}get ULl(){if(!this.oa.i1())return null;var ea=Object(Wb.a)(5,this.oa.Oa.kb.vf.node);if(!ea)return null;const Ka=Object(Wb.a)(214,ea.sc(this.Jc.Ic.Na));if(!Ka)return null;var bb=null,vb=Ka.htmlElement.getElementsByClassName("Selected");if(0<vb.length)bb=vb[vb.length-1];else if(this.oa.Oa.qm){if(vb=this.zpg())if(vb=Object(Wb.a)(5,vb.vf.node))if(vb!==ea){if(ea=Object(Wb.a)(214,vb.sc(this.Jc.Ic.Na)))bb=ea.htmlElement}else bb=Ka.htmlElement}else return null;ea=this.oa.Zn();if(!ea||
!bb)return null;ea=Object(Wb.a)(178,ea.sc(this.Jc.Ic.Na));if(!ea)return null;bb=bj.a.wi(bb);ea=bj.a.wi(ea.Zq);if(0>=bb.width+bb.height&&0>=ea.width+ea.height)return null;ea=Hc.a.nT(new Hc.a(bb.x,bb.y),new Hc.a(ea.x,ea.y));return this.H_f(ea.x+bb.width-5,ea.y+10)}get anchorNode(){const ea=this.oa.Zn();return this.lMg=ea?ea:this.Jc.Ic.gd}e0h(ea,Ka){this.Vl&&(Ka||this.CLh(),this.Njb.eOh(ea?3:1),!this.isDisabled&&ea&&Qb.a("CommentShimmerBugFix")&&this.RY&&this.RY.isVisible&&(this.RY.qvg(),this.Db.rLa(1)),
this.cT(!ea,!1,!0),this.Vl.zq(!this.isDisabled&&ea,Ka),this.Vl.isVisible&&(this.Qgb=!0))}cT(ea,Ka,bb){if(!this.Ba.L$){var vb=this.R0();bb&&(!vb&&!this.IJa||vb&&this.IJa)&&mb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.R0()&&!this.HXa&&ea&&!Ka||this.Vl.isVisible&&ea&&!Ka||this.R0()&&this.RY&&this.RY.isVisible&&!ea&&!Ka||!this.Jc.Ic||!(Ka=this.Jc.Ic.yea)||(Ka.setVisibility(ea),ea=
new Wc.a(ea),this.Pw.azh(ea),bb?this.Db.rLa(1):mb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Jc.Ic.dFd(5,!1,this.WFb))}}Jem(ea){this.Vl&&(this.Qgb=!this.isDisabled&&ea,this.Qgb||(this.Njb.eOh(1),this.Vl.zq(!1,!1),this.Fa.qk(bf.a.Sr,!1)))}BHj(){const ea=new kc;ea.focusCallback=Object(qb.a)(this,this.IYc,"focusFirstPaneElement");return Object.assign(new nf.a,{title:ResourceStrings.L_Comments,hideHeader:!1,
width:parseInt(this.YBm?300:320),contentProps:ea,location:2,onOpen:Ka=>{Vb.a.Nud(Ka,[ib.a.contextMenu]);const bb=this.Fa.Kc(bf.a.Sr);this.hd.iPb(ib.a.click,Ka,Object(qb.a)(this,this.cMb,"onCommentPaneParentDivClick"),null,bb.f5a)},onClose:Ka=>{this.qvc(!1,!1);this.hd.Hb(ib.a.click,Ka,Object(qb.a)(this,this.cMb,"onCommentPaneParentDivClick"))},isModernPane:!0})}lHi(){if(!this.RRg){var ea=this.Rl.Zz();ea=!!ea&&0<ea.length;mb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",
ea);ea?this.R0()&&this.cT(!0,!1,!0):(this.K7b(),this.RFa&&!this.IJa?this.cT(!1,!1,!1):this.cT(!1,!1,!0))}}P3a(){this.Vl.isVisible||this.ia.nb(Cd.a.n3,2);this.KWc()}y2j(){this.Vl.isVisible&&this.ia.nb(Cd.a.n3,2)}Ok(ea){return this.te.Ok(ea)}get isDisabled(){const ea=this.K6.Of;return ea?ea.rdb:!0}CKf(){this.Aid||(this.Aid=new Md.a(0,1,0,Object(qb.a)(this,this.Wul,"refreshCommentsTask"),90,"48"),this.zb.Jb(this.Aid))}clh(ea){this.Enh(1===ea.mode)}Enh(ea){this.Gp=ea;this.CKf();Qb.a("PreventCommentPaneCloseOnReadOnlyChanged")?
this.P8f():this.Vl.isVisible&&this.Gp&&this.y2j()}nje(){return this.gba?this.gba:[]}bmg(){return this.ejb?this.ejb:[]}get bkh(){return this.Zhb}get rUc(){return this.Ii}okg(ea){const Ka=this.Jc&&this.Jc.Ic?this.Rl.dcb(this.Jc.Ic.gd):this.hbf(this.Rl.Zz());if(!Ka||!Ka.length)return 0;let bb=null;this.Kxd&&(bb=this.SEa(this.Kxd.x,this.Kxd.y));let vb=-1,Yb=0;for(let Bc=0;Bc<Ka.length;Bc++){var Gc=this.Ro.d$(Ka[Bc]);if(!bb&&Gc)break;if(Gc&&bb){var ud=Gc.gD.x,Nd=Gc.gD.y;ud+=Ka[Bc].pos.X;Nd+=Ka[Bc].pos.Y;
Gc.Rg&&(Gc=this.Ga.zt(Gc),ud+=Gc&&Gc.gD?Gc.gD.x:0,Nd+=Gc&&Gc.gD?Gc.gD.y:0);Nd=this.SEa(ud,Nd);ud=Nd.y;Nd=Nd.x;if(bb.y<ud)break;if(bb.y>ud||bb.y===ud&&bb.x>=Nd)vb=Bc,Ka[Bc].Children&&ea&&(Yb+=Ka[Bc].Children.length)}else Gc||(vb=Bc,Ka[Bc].Children&&ea&&(Yb+=Ka[Bc].Children.length))}return vb+Yb+1}z8j(ea){if(!this.jFe)throw mb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),E.a.fu(-2130915320);if(this.Ii)return mb.a.J(512496720,
805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),E.a.fu(-2130915319);if(null===ea)throw Error.argumentNull("session");if(!ea.commentId.length&&0!==ea.FTa)return E.a.fu(-2130915327);this.Ii=ea;this.Y4a(!0);0===ea.FTa&&(this.NOa(0),this.Vl.isVisible||this.PEh(ea));if(this.Vl.isVisible||!this.Vl.isVisible)this.Fua(),this.jgj();let Ka="";ea.FD&&(Ka=ea.FD.draftId);mb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",Ka);return null}endCommentSession(ea,
Ka){if(this.Ii){if(this.Ii.FD&&this.Ii.FD.draftId!==ea)throw mb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",ea,this.Ii.FD.draftId),E.a.fu(-2130915327);this.gOg=Ka}9!==Ka||this.Vl.isVisible||this.Fa.PF(bf.a.Ag);this.Ii=null;this.Db.Gf();if(this.Ns&&!this.Vl.isVisible){const bb=[Object.assign(new Aj,{contentId:ea,containerContentType:0,anchorTop:0,anchorLeft:0})];this.Ns.detachContainers(bb);this.R0()||this.cT(!1,!1,!0)}this.njd.eFg&&
this.N5f();mb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",ea,Ka)}get IWi(){return this.gOg}N7(){this.Fua()}c5f(ea){if(this.Ba.getBooleanAppSetting("CommentCopyPasteEnabled")&&!this.ngb.brk)for(const Ka of ea)for(const bb of this.Rl.jva(Ka.fF()))if(1===bb.status){this.N$g=new Pb(ea,this.Rl);this.iOe=!0;return}}qb(){1!==this.Ujc.sla&&(this.ia.xa(Cd.a.Nyc,bi.a.application,Object(qb.a)(this,this.n3,"showHideComments")),this.ia.pa(Cd.a.l0e,bi.a.application,
Object(qb.a)(this,this.HMa,"queryShowHideComments"),97));this.s8f&&(this.ia.xa(Cd.a.mUa,bi.a.application,Object(qb.a)(this,this.G7b,"deleteAllComments")),this.ia.xa(Cd.a.Lyb,bi.a.application,Object(qb.a)(this,this.G7b,"deleteAllComments")),this.ia.xa(Cd.a.Myb,bi.a.application,Object(qb.a)(this,this.G7b,"deleteAllComments")));this.ia.xa(Cd.a.dSb,bi.a.application,Object(qb.a)(this,this.n3,"showHideComments"));this.ia.pa(gb.a.S0e,jc.a.frame,Object(qb.a)(this,this.HMa,"queryShowHideComments"),97);this.ia.pa(Cd.a.HMa,
bi.a.application,Object(qb.a)(this,this.HMa,"queryShowHideComments"),97);this.ia.pa(Cd.a.FOb,bi.a.application,Object(qb.a)(this,this.HMa,"queryShowHideComments"),97);this.ia.pa(Cd.a.Ltd,bi.a.application,Object(qb.a)(this,this.HMa,"queryShowHideComments"),97);this.ia.xa(Cd.a.GRe,bi.a.application,Object(qb.a)(this,this.Ond,"nudgeCommentMarker"));this.ia.xa(Cd.a.HRe,bi.a.application,Object(qb.a)(this,this.Ond,"nudgeCommentMarker"));this.ia.xa(Cd.a.IRe,bi.a.application,Object(qb.a)(this,this.Ond,"nudgeCommentMarker"));
this.ia.xa(Cd.a.JRe,bi.a.application,Object(qb.a)(this,this.Ond,"nudgeCommentMarker"));this.ia.xa(Cd.a.yTb,bi.a.application,Object(qb.a)(this,this.yTb,"toggleCommentAnchoringFocus"));this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.xa(gb.a.izb,bi.a.application,Object(qb.a)(this,this.izb,"doesCommentExist")),this.ia.xa(gb.a.W5b,bi.a.application,Object(qb.a)(this,this.W5b,"commentActivitySelected")));this.Sd()}Sd(){var ea=this.Fa.Kc(ki.AFrame.Nj),Ka=
this.Fa.Kc(bf.a.xA);const bb=this.Fa.Kc(bf.a.kT);ea.bindAction(qf.KeyInputManager.Va(be.a.NBa,1),Cd.a.yTb);Ka.bindAction(qf.KeyInputManager.Va(be.a.NBa,1),Cd.a.yTb);bb.bindAction(qf.KeyInputManager.Va(be.a.NBa,1),Cd.a.yTb);ea=this.Fa.Kc(bf.a.Sr);Ka=[ea,this.Fa.Kc(Ki.a.XE),this.Fa.Kc(Ki.a.H4),this.Fa.Kc(bf.a.Ag),this.Fa.Kc(bf.a.wR)];for(const vb of Ka)vb.bindAction(qf.KeyInputManager.Va(be.a.OBa,qf.KeyInputManager.Ze|(ac.a.Fl?4:1)),Cd.a.cDb);ea.bindAction(qf.KeyInputManager.Va(be.a.r5a,1),Cd.a.cDb)}cPb(ea,
Ka,bb,vb=-1){this.Axa=Ka;!this.io&&this.OP&&(this.io=new zf(this.OP,this,this.LIb,this.Axa,this.Qgb),this.Ro.Zld=this.io);if(ea){Pe.uzk(ea);Ka=null;this.oa.i1()&&(Ka=this.oa.Oa);var Yb=0<ea.length?ea[ea.length-1]:null;if(this.io){var Gc=this.io.yQb?this.io.yQb.comment:null;const ud=Gc?Gc.commentId:null;this.io.isRightToLeft=this.Axa;this.io.Iud(ea);this.Ro&&(this.R0()||this.Ozb())&&(this.Ro.bVc(),this.Ro.EUc());this.io.selectComment(null,!1);if(this.Ii)Gc=this.PAb(this.Ii.commentId),this.Ro&&this.Ro.D6e(Gc,
ud,!1),this.io.selectComment(Gc,!0);else if(bb&&Gc){const Nd=this.PAb(Gc.commentId);this.Ro&&(this.Vl.isVisible||!Nd||1!==Nd.status&&2!==Nd.status)&&(this.io.selectComment(Gc,!1),this.Ro.D6e(Gc,ud,!1,!0))}else this.ujd&&Yb&&(this.ria(Yb.commentId,1,!1),this.io.selectComment(Yb,!1));this.io.CRh(this.Sgb);this.Sgb&&this.Ro.Tyb(this.WYa)}this.Zhb=ea.length;ea=this.hbf(ea);this.gba=this.i0g.Nbm(ea,this.Gp);this.ejb=this.i0g.Mbm(ea);bb?(this.Y4a(!0),this.O1.xKh(Array.clone(this.gba),this.Zhb,Array.clone(this.ejb)),
this.ujd&&Yb&&this.O1.selectComment(Yb.commentId)):(bb=[],this.Ozb()&&(bb=this.okg(!1),bb=[Object.assign(new ei,{draftId:this.Ii.FD.draftId,insertIndex:0>vb?0:bb})]),0>vb?this.O1.U6e(this.gba.length,this.Zhb,this.Gp,this.dDe.X9c,bb):this.O1.vMl(this.gba.length,this.Zhb,vb,this.Gp,bb),this.O1.Y6e(Array.clone(this.gba),Array.clone(this.ejb)));if(this.kmc){if(vb=this.PAb(this.kmc))this.selectComment(vb,null,!0,!0,0,1,!1),this.kmc=null}else Ka&&this.oa.VF(Ka);ea=this.V4f(ea);this.a6&&ea&&this.a6.count>
ea.length&&this.Oaj(ea);this.MEh(ea);this.cDe&&this.ekm();this.ujd=!1}else this.O1.U6e(0,0,this.Gp,1),this.O1.Y6e([],[]),this.Zhb=0,this.io&&(this.io.isRightToLeft=this.Axa,this.io.Iud(null)),this.ejb=this.gba=null,this.e0h(!1,!1),this.K7b()}Fua(){this.KWc();this.hasFocus?this.Ii&&this.njd.eFg&&!this.Hag()&&this.Fa.PF(bf.a.xA):this.Fa.PF(this.Vl.isVisible?bf.a.Sr:bf.a.HX)}Wul(){this.Aid=null;this.aUe()}cMb(){this.Fua();this.oa.Pu();return!1}dWf(ea){if(this.Ii){if(!this.Ii.FD)throw mb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",ea),E.a.fu(-2130915320);this.endCommentSession(this.Ii.FD.draftId,ea)}else mb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",ea),this.endCommentSession("",ea)}jgj(){this.VJb=this.Fa.Je.name===(this.Vl.isVisible?bf.a.Sr:bf.a.HX);this.njd.JMf(!0)}N5f(){this.njd.JMf(!1);this.VJb&&(this.Fa.PF(this.Vl.isVisible?bf.a.Sr:bf.a.HX),
this.VJb=!1)}C8k(ea,Ka){if(ea&&ea.name!==bf.a.Sr&&ea.name!==bf.a.HX&&Ka.name===bf.a.xA)if(this.Vl.isVisible)this.IYc();else if(this.Ii){ea="";switch(this.Ii.FTa){case 0:ea=this.Ii.FD?this.Ii.FD.draftId:"";break;case 1:case 2:if(Ka=this.Rl.gke(this.Ii.commentId))ea=this.Rl.iva(Ka).commentId}this.Ns.selectContainer(ea,!0)}this.VJb=!0}B8k(){this.VJb=!1}IYc(){this.Vl.isVisible&&this.Njb.bqj()}Xqc(ea,Ka,bb){this.zFe=ea;this.Db.Gf();(Qb.a("FixAltF12KeboardingInCommentPane")||!this.HK)&&this.zFe&&Ka&&this.IYc();
ea||bb||this.NOa(1)}Rce(ea){var Ka=this.sa.presentation;if(!Ka)return!1;Ka=Ka.slides;if(!Ka)return!1;for(const bb of Ka)if(Ka=Object(Wb.a)(Ie.a,bb))if(Ka=this.Rl.jva(Ka.fF()),ea)for(const vb of Ka){if(1===vb.status)return!0}else{if(Ka&&0<Ka.length)return!0}else mb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}M$i(){this.Rl.mUa();const ea=this.Rl.Zz();ea&&ea.length?this.ngb.nRh():this.ngb.lRh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}Ond(ea,
Ka,bb){if(1===bb)return 32;if(null!==this.jKh){Ka=this.jKh;switch(ea){case Cd.a.GRe:Ka.pos.Y+=20;break;case Cd.a.HRe:Ka.pos.X-=20;break;case Cd.a.IRe:Ka.pos.X+=20;break;case Cd.a.JRe:Ka.pos.Y-=20}this.io.cjm(Ka);this.kMk.Nhl(Ka)}return 32}G7b(ea,Ka,bb){return!this.s8f||this.Gp||this.Ii&&this.Ii.FD?8:1===bb?this.rzj(ea):this.K$i(ea)}rzj(ea){switch(ea){case Cd.a.mUa:return this.Rl.Zz()&&this.Rl.Zz().length?32:8;case Cd.a.Lyb:return this.Rce(!1)?32:8;case Cd.a.Myb:return 1!==this.Ujc.sla&&this.Rce(!0)?
32:8;default:return mb.a.J(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",ea),2}}K$i(ea){switch(ea){case Cd.a.mUa:this.M$i();break;case Cd.a.Lyb:this.ngb.mRh(this.Rl,!1);break;case Cd.a.Myb:this.ngb.mRh(this.Rl,!0);break;default:return mb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",ea),2}return 32}n3(ea,Ka,bb,vb,Yb){if(1===bb)return!this.sa.Aa||this.isDisabled?8:32;Ka=!this.Vl.isVisible;
bb=this.ES.lj("UserAction",String.format("ShowHideComments: {0}",Ka?"ShowPane":"HidePane"));mb.a.J(36983504,805,50,"New Comment Pane opened.");ea===Cd.a.dSb?(this.Jem(!this.Qgb),this.i2e()):ea===Cd.a.Nyc?(this.Sgb=!this.Sgb,this.Ro.bAd=this.Sgb,this.i2e()):this.qvc(Ka,!!Yb&&Yb.AutoShowHide);bb&&bb.stop();return 32}ahj(){this.Vl.isVisible&&this.ria(this.Ii.FD.draftId,1,!1)}yTb(){var ea=this.Fa.Je.name;if(this.Ii&&this.Ii.FD)return ea===bf.a.Ag?(this.Fua(),Qb.a("FixAltF12KeboardingInCommentPane")||
Qb.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.ahj()):this.Fa.Df(bf.a.Ag),32;if(this.Ro.XSh||this.Ro.OX){if(ea===bf.a.Ag||ea===bf.a.kT){var Ka=this.Ro.OX;this.Vl.isVisible||(ea=0,Ka&&(ea=Ka.get_shapeId()),this.ZJh(ea,!1));this.Fua();return 32}if(Tb.a.contains(this.cTf,ea)){if((Ka=this.vQb)&&nc.QO(Ka)){if(ea=nc.Bbc(Ka,this.Ro.OX),ea.isValid){const bb=[];for(let Yb=0;Yb<ea.paragraphs.length;Yb++){const Gc=ea.paragraphs[Yb];Gc&&bb.push(Th.SelectionFactory.U4(Gc,ea.wW.equals(Gc)?ea.startPos:
0,ea.d5.equals(Gc)?ea.endPos:Yc.ParagraphReader.textLength(Gc)))}const vb=new Eh.SelectionCollection(bb,0);Ka.textAnchoringInfo.AnchoringShape&&Ka.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.Df(bf.a.kT),this.eVg.execute(Yb=>{(Yb=Object(Wb.a)(268,Yb.$d))&&this.eVg.instance.dOh(Object(Wb.a)(Ng.a,Yb),vb)})):(this.Fa.Df(bf.a.Ag),this.oa.VF(vb))}}else this.Fa.Df(bf.a.Ag);return 32}}else{if(Tb.a.contains(this.cTf,ea))this.Fa.Df(bf.a.Ag);else{ea=null;ea=this.Jc&&this.Jc.Ic?this.Rl.dcb(this.Jc.Ic.gd):
this.hbf(this.Rl.Zz());if(!Tb.a.Ta(ea))for(Ka of ea)if(this.Vl.isVisible||0===Ka.status){this.ria(Ka.commentId,1,!1);break}this.Fua()}return 32}return 8}OMf(ea,Ka){ea&&!Ka?this.HK?this.KWc():(this.Fa.qk(bf.a.Sr,!0),this.Fua(),this.IYc()):Ka?ea&&this.Fa.Lfa(bf.a.Sr,bf.a.Nj,this.Vl,!1):0<this.Tge()||this.Ii&&this.Ii.FD?this.Fa.qk(bf.a.HX,!0):this.Fa.qk(bf.a.Sr,!1);Ka||this.CLh()}F2k(){this.hid||(this.jm.MS(this.jm.W3d,this.jm.U5d),this.jm.Epa(this.jm.W3d,this.jm.U5d),this.hid=!0,this.sF.G2k(this.sa.Mk));
this.RY&&this.RY.Alj()}CLh(){const ea=this.Rl.Zz();ea&&0<ea.length&&(this.RRg=!0)}R0(){var ea=this.Rl.Zz();if(!ea||!ea.length)return!1;ea=sk.e(ea,Ka=>0===Ka.status);return!!ea&&0<ea.length}HMa(ea,Ka,bb,vb,Yb){ea===Cd.a.HMa?Yb[Ud.a.On]=this.Vl.isVisible:ea===Cd.a.FOb||ea===gb.a.S0e?Yb[Ei.a.On]=this.Vl.isVisible:ea===Cd.a.Ltd?Yb[Ei.a.On]=this.Qgb:ea===Cd.a.l0e&&(Yb[Ei.a.On]=this.Sgb);return!this.sa.Aa||this.isDisabled?16:32}izb(ea,Ka,bb,vb,Yb){return 2!==bb?32:(ea=this.wag(Yb))&&this.findComment(ea)?
32:8}W5b(ea,Ka,bb,vb,Yb){return 2!==bb?32:(ea=this.wag(Yb))&&this.h_k(ea)?32:8}wag(ea){if(!ea)return null;ea=ea.NavigationId;if(!ea)return null;try{return JSON.parse(ea)}catch(Ka){return mb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",Ka),null}}h_k(ea){if(this.QAg(this.Jc.Ic.gd,ea))return this.YJh(ea);var Ka=Qc.a.Aq(ea.sId,ea.cId);Ka=this.Nke(Ka);if(!Ka)return!1;this.Ba.Cm?this.lba.instance&&this.lba.instance.RI(Ka.ve):this.De.RI(Ka.ve);E.a.B9a(this.zb,()=>{this.YJh(ea)});
return!0}YJh(ea){const Ka=this.findComment(ea);if(!Ka)return!1;1!==Ka.status&&2!==Ka.status||this.P3a();this.ria(ea.commentId,1,!1);return!0}findComment(ea){var Ka=this.sa.presentation;if(!Ka)return null;Ka=Ka.slides;if(!Ka)return null;for(const bb of Ka)if((Ka=Object(Wb.a)(Ie.a,bb))&&this.QAg(Ka,ea)){Ka=this.Rl.jva(Ka.fF());for(const vb of Ka){if(vb.commentId===ea.commentId)return vb;if(vb.Children&&vb.Children.length)for(const Yb of vb.Children)if(Yb.commentId===ea.commentId)return Yb}}return null}QAg(ea,
Ka){return ea.cid&&Ka.cId?ea.cid===Ka.cId:ea.sid===Ka.sId}isCollapsed(){return!1}get jKh(){return null}clearSelection(){}gvl(){this.Db.Gf()}get odb(){return!!this.Ii}FTi(){this.Ii&&this.dWf(8)}getName(){return"SharedFrame"}JZ(ea){2===ea.behavior&&ea.actionId===Cd.a.P1a&&(ea=this.Pt.x_c(!0),ea!==Cd.a.mrd&&ea!==Cd.a.uR&&ea!==Cd.a.mUa&&ea!==Cd.a.Lyb&&ea!==Cd.a.Myb||Vg.UISurfaces.BM().then(Ka=>{this.ngb.Qyl(Ka)}))}IZ(){}static zgh(ea,Ka){return ea.contentId===Ka}static uzk(ea){let Ka="";if(ea){for(const bb of ea)if(Ka+=
bb.commentId+";",bb.Children)for(const vb of bb.Children)Ka+=vb.commentId+";";mb.a.J(512496659,805,15,"LogCommentIds() - {0}",Ka)}}}Object(k.a)(Pe,"SharedCommentFrame",null,[1650,106,1651,182]);class Lf{constructor(ea,Ka,bb,vb,Yb,Gc,ud=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ea;this.parentId=Ka;this.commentBody=bb;this.author=vb;this.date=Yb;this.commentFlags=Gc;this.usersByReactionType=ud}}Object(k.a)(Lf,
"OfficeSharedCommentModel",null,[]);class Nf{constructor(ea,Ka){this.CommentId=ea;this.ResolveState=Ka}}Object(k.a)(Nf,"CommentProperties",null,[]);class dg{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(k.a)(dg,"AtMentionAttributes",null,[]);class Pg{constructor(){this.contentId=""}}Object(k.a)(Pg,"AtMentionOptionalAttributes",null,[]);class pi{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=
0;this.paragraph=this.color=this.highlight=null}}Object(k.a)(pi,"DeltaAttributes",null,[]);var li;(function(ea){ea[ea.Undo=-1]="Undo";ea[ea.Unknown=0]="Unknown";ea[ea.Create=1]="Create";ea[ea.wqm=2]="Assign";ea[ea.Csm=3]="Unassign";ea[ea.Dsm=4]="UnassignAll";ea[ea.bsm=5]="Schedule";ea[ea.Qrm=6]="Progress";ea[ea.Delete=7]="Delete";ea[ea.Xrm=8]="Restore";ea[ea.hsm=9]="SetTitle";ea[ea.Priority=10]="Priority"})(li||(li={}));Object(k.b)("HistoryRecordType",li);class Ri{constructor(){this.Id=this.FullName=
this.Email=this.DispName=null}}Object(k.a)(Ri,"CommentAtMention",null,[]);var Ih=d(926);class ij{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(k.a)(ij,"UserInfo",null,[]);class Fi{constructor(ea,Ka){this.plainText=ea;this.Xih=Ka}}Object(k.a)(Fi,"TextTranslationResult",null,[]);var Da=d(71);class Wa{constructor(ea,Ka,bb){this.DGl="[";this.uGi=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.Jwk=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.vGi=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)",
"gi");this.gLg=!1;this.U7i=vb=>{if(!vb)return null;const Yb={};for(const Gc of vb){a:{switch(Gc.Type){case "\ud83d\udc4d":vb=1;break a;default:mb.a.J(509220245,805,50,"Unsupported reaction type")}vb=void 0}void 0!==vb&&(Yb[vb.toString()]=this.bml(Gc.ReactionInstances))}return Yb};this.bml=vb=>{const Yb=[];for(const Gc of vb)vb=Gc.User,Yb.push({DateUtc:Gc.Time,DisplayName:vb.DisplayName,Email:vb.Email,Provider:vb.ProviderId,UserId:vb.UserId,IsCurrentUser:this.isCurrentUser(Gc.User.UserId,Gc.User.ProviderId)});
return Yb};this.Lb=ea;this.eOe=Ka;this.jKe=bb}get userId(){return this.Lb.appSettings["387"]}get providerId(){return this.Lb.appSettings["388"]}xMj(ea,Ka){let bb=0;if(1===ea.status||2===ea.status)bb|=8;Ka&&(bb|=1);this.HYl(ea)&&(bb|=16);this.Lb.getBooleanAppSetting("PPTOBlueDotsForComments")&&ea.isUnread&&(bb|=32);return bb}isCurrentUser(ea,Ka){return ea?"Author"===ea||this.userId===ea&&Ka===Ka?!0:!1:!1}fgk(ea){return this.isCurrentUser(ea.userId,ea.providerId)}HYl(ea){return""===ea.userId||"Author"===
ea.userId||!this.knm(ea.userId)||this.userId===ea.userId&&this.providerId===ea.providerId?!1:!0}knm(ea){return 3===ea.split("::").length}kZh(ea,Ka,bb){var vb;if(null===ea)throw Error.argumentNull("comment");const Yb=this.Pbm(ea.text);var Gc=ea.authorName,ud=Qb.a("PPTPlumbEmailThroughCG")?Aa.a.nbb(ea.userId||""):"";const Nd=ea.dt;bb=this.xMj(ea,bb);Gc=new bc(ea.userId,ea.providerId,Gc,ud,this.fgk(ea));return xd(this.Lb)&&(null===ea||void 0===ea?0:ea.reactions)?(ud=this.U7i(null===(vb=ea.reactions)||
void 0===vb?void 0:vb.ReactionList),new Lf(ea.commentId,Ka,Yb,Gc,Nd,bb,ud)):new Lf(ea.commentId,Ka,Yb,Gc,Nd,bb)}Nbm(ea,Ka){if(null===ea)throw Error.argumentNull("comments");const bb=new n.a;for(const vb of ea)if(bb.add(this.kZh(vb,"",Ka)),vb.Children&&0<vb.Children.length)for(const Yb of vb.Children)bb.add(this.kZh(Yb,vb.commentId,Ka));return bb.toArray()}Tbm(ea,Ka,bb,vb){const Yb=Object.assign(new Ih.a,{Asignees:[]});ea=this.eOe.Asj(ea,Ka,!Ka.taskId,bb);for(const Gc of ea)2===Gc.type?Gc.assignee?
(ea=Object.assign(new ij,{DisplayName:Gc.assignee.DisplayName,FullName:Gc.assignee.DisplayName,UserId:Gc.assignee.UserId,ProviderId:Gc.assignee.Provider,Email:Gc.assignee.Email}),Yb.Asignees.push(ea)):mb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===Gc.type&&(Yb.Title=Gc.title);if(!Yb.Asignees)return mb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;Yb.Title||(mb.a.J(512496656,
845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Yb.Title=vb);return Yb}Rbm(ea,Ka){const bb=new Ih.a;if(ea.assignee){const vb=new ij,Yb=ea.assignee;vb.DisplayName=Yb.Name;vb.FullName=Yb.Name;vb.UserId=Yb.UserPrincipalName;vb.ProviderId="O365";vb.Email=Yb.UserPrincipalName;bb.Asignees=[vb]}bb.Title=ea.title?ea.title:Ka;return bb}Sbm(ea,Ka,bb){if(!Ka)return null;try{const vb=this.MDd(bb,new Date).plainText,Yb=this.jKe?this.Tbm(ea,Ka,bb,vb):this.Rbm(Ka,vb);if(!Yb)return null;
Yb.CompletionPercentage=Ka.completion?Ka.completion:0;return Yb}catch(vb){mb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",vb)}return null}Mbm(ea){if(null===ea)throw Error.argumentNull("comments");const Ka=new n.a;for(const bb of ea)bb.taskInfo&&bb.taskInfo.Asignees&&0<bb.taskInfo.Asignees.length&&(ea=this.Lbm(bb))&&Ka.add(ea);return Ka.toArray()}Lbm(ea){if(this.jKe&&this.eOe&&0<ea.taskInfo.TaskHistoryRecords.length)try{const Ka=Wa.d0i(ea.taskInfo.TaskHistoryRecords),
bb=new Da.a;bb.add(ea.commentId,new Nf(ea.commentId,100===ea.taskInfo.CompletionPercentage));const vb=this.eOe.F7i(ea.commentId,ea.commentId,Ka,bb);Wa.DRi(ea,vb,this.jKe);return vb}catch(Ka){return mb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",Ka.message),this.jZh(ea)}else return this.jZh(ea)}jZh(ea){var Ka=new ba;Ka.startDate=ea.taskInfo.StartDate;Ka.endDate=ea.taskInfo.DueDate;const bb=new sa(ea.taskInfo.Asignees[0].UserId);bb.DisplayName=ea.taskInfo.Asignees[0].DisplayName;
bb.Provider=ea.taskInfo.Asignees[0].ProviderId;bb.Email=ea.taskInfo.Asignees[0].Email;const vb=Array(1);vb[0]=bb;Ka=new ha(!1,ea.taskInfo.Title,vb,Ka,ea.taskInfo.CompletionPercentage,0);return new oa(ea.commentId,ea.commentId,Ka,[])}Pbm(ea){if(null===ea)throw Error.argumentNull("nativeText");const Ka=new za;ea=ea.split(this.vGi);for(const vb of ea){var bb=this.uGi.exec(vb);bb&&3===bb.length?(ea=new dg,bb[0].substring(0,1)===this.DGl?(ea.fullName=bb[2],ea.resolveState=1):(ea.fullName=bb[1],ea.resolveState=
0),ea.email="UnknownEmail",bb=new Pg,bb.contentId="Pre-existing Mention",Ka.cbk("@"+ea.fullName,ea,bb),this.gLg||(this.gLg=!0,mb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(ea=this.Jwk.exec(vb))&&1===ea.length?(ea=ea[0],Ka.insertHyperLink(ea,Object.assign(new pi,{link:ea}))):Ka.Cbk(vb)}return Ka.vzj()}MDd(ea,Ka){var bb=Sys.Serialization.JavaScriptSerializer.deserialize(ea);ea=[];Ka||(Ka=new Date);const vb=new Sys.StringBuilder;for(const Yb of bb.ops)if(Yb.attributes){if(Yb.attributes.atmention){const Gc=
1<Yb.insert.length?Yb.insert.substring(1,Yb.insert.length):"";if(Yb.optional&&Yb.optional.atmention&&Yb.optional.atmention.contentId)bb=Wa.Akg(Gc,1===Yb.attributes.atmention.resolveState);else{bb=Wa.Akg(Gc,1===Yb.attributes.atmention.resolveState);const ud=Wa.oGj(Ka,1===Yb.attributes.atmention.resolveState);Array.add(ea,Object.assign(new Ri,{FullName:Yb.attributes.atmention.fullName,DispName:Gc,Id:ud,Email:Yb.attributes.atmention.email}));Ka=new Date(Ka.getTime()+1)}}else Yb.attributes.link||mb.a.J(512496652,
845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),bb=Yb.insert;vb.append(bb)}else vb.append(Yb.insert);return new Fi(vb.toString(),ea)}static G0i(ea){switch(ea){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static D0i(ea){var Ka=null;ea.User&&(Ka=new sa(ea.User.UserId,ea.User.ProviderId,ea.User.DisplayName));Ka=new G(Wa.G0i(ea.HistoryRecordType),
Ka,ea.DtTime,ea.RecordId);Ka.commentId=ea.CommentId;ea.Assignee&&(Ka.assignee=new sa(ea.Assignee.UserId,ea.Assignee.ProviderId,ea.Assignee.DisplayName));ea.StartDate&&ea.DueDate?(Ka.schedule=new ba,Ka.schedule.startDate=ea.StartDate?ea.StartDate:null,Ka.schedule.endDate=ea.DueDate?ea.DueDate:null):ea.StartDate&&!ea.DueDate?mb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!ea.StartDate&&ea.DueDate&&mb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");
var bb=ea.Priority;0<bb?Ka.priority=bb:mb.a.J(512496649,845,10,"Priority is negative");bb=ea.CompletionPercentage;0<=bb?Ka.completion=bb:mb.a.J(512496648,845,10,"Percent complete is negative");Ka.title=ea.Title;Ka.undoId=ea.UndoId;return Ka}static d0i(ea){const Ka=ea.length,bb=Array(Ka);for(let vb=0;vb<Ka;++vb)bb[vb]=Wa.D0i(ea[vb]);return bb}static DRi(ea,Ka,bb){const vb=Ka.currentState,Yb=ea.taskInfo;let Gc=!1;const ud=Qb.a("SetTaskFromTaskStateInsteadOfHistory");Yb.StartDate.toString()!==vb.schedule.startDate.toString()&&
(ud&&(vb.schedule.startDate=Yb.StartDate),Gc=!0,mb.a.J(512496647,845,10,"Start Date does not match."));Yb.DueDate.toString()!==vb.schedule.endDate.toString()&&(ud&&(vb.schedule.endDate=Yb.DueDate),Gc=!0,mb.a.J(512496646,845,10,"End Date does not match."));Yb.CompletionPercentage!==vb.completion&&(ud&&(vb.completion=Yb.CompletionPercentage),Gc=!0,mb.a.J(512496645,845,10,"Completion percentage does not match."));Yb.Title!==vb.title&&(ud&&(vb.title=Yb.Title),Gc=!0,mb.a.J(512496644,845,10,"Title does not match."));
Yb.Asignees[0].UserId!==vb.assignees[0].UserId&&(ud&&(vb.assignees[0].UserId=Yb.Asignees[0].UserId),Gc=!0,mb.a.J(512496643,845,10,"Assigned to user id does not match."));Yb.Asignees[0].DisplayName!==vb.assignees[0].DisplayName&&(ud&&(vb.assignees[0].DisplayName=Yb.Asignees[0].DisplayName),Gc=!0,mb.a.J(512496642,845,10,"Assigned to display name does not match."));Yb.Asignees[0].ProviderId!==vb.assignees[0].Provider&&(ud&&(vb.assignees[0].Provider=Yb.Asignees[0].ProviderId),Gc=!0,mb.a.J(512496641,845,
10,"Assigned to provider id does not match."));Yb.Asignees[0].Email!==vb.assignees[0].Email&&(ud&&(vb.assignees[0].Email=Yb.Asignees[0].Email),bb||(Gc=!0,mb.a.J(512496640,845,10,"Assigned to email does not match.")));if(Gc&&bb&&(Wa.bEk(ea,Ka),Qb.a("IsThrowForTaskStateMismatchEnabled")))throw mb.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),Error.create("TaskStateMismatch");}static bEk(ea,Ka){const bb=new n.a;for(const vb of Ka.history)for(const Yb of vb.records)bb.add(li[Yb.type]);
if(bb.count!==ea.taskInfo.TaskHistoryRecords.length){Ka=new n.a;for(const vb of ea.taskInfo.TaskHistoryRecords)Ka.add(li[vb.HistoryRecordType]);mb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static oGj(ea,Ka){ea=ea._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return Ka?ea+"_Z":ea}static Akg(ea,Ka){return Ka?"[@"+ea+"]":"<@"+ea+">"}}Object(k.a)(Wa,"SharedCommentModelTranslator",null,[1652]);class lb{constructor(ea,Ka,bb){this.Ywf=!1;this.Fa=ea;this.ih=
Ka;this.Hic=bb}JMf(ea){ea?(this.Hic&&this.Hic.isVisible||this.ih.bM(bf.a.xA),this.ih.zp(bf.a.Sr),this.Fa.PF(bf.a.xA)):this.ih.zp(bf.a.xA);this.Ywf=ea}get eFg(){return this.Ywf}}Object(k.a)(lb,"SharedCommentsRTEFocusActionHelper",null,[1604]);class Lb{constructor(ea,Ka,bb,vb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ea;this.body=Ka;this.confirmButton=bb;this.cancelButton=vb}}Object(k.a)(Lb,"ViewContainerModalDialogStrings",null,[]);class oc{constructor(ea,Ka,bb){this.containerType=
"full-pane";this.identifier=null;this.jb=ea;this.Fa=Ka;this.identifier=bb}closeView(){this.jb.qvc(!1,!1)}openView(){this.jb.qvc(!0,!1)}invokeModalConfirmationDialog(ea,Ka,bb){const vb=new bh.StandardDialog;bb&&bb.title&&bb.body&&bb.confirmButton&&bb.cancelButton||(mb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),bb=new Lb("","","",""));vb.Fd=1;vb.Te(1,bb.confirmButton);vb.Te(0,bb.cancelButton);vb.Hab=this.Fa.Je.name;vb.zqc=!0;vb.Ky(bb.title,bb.body,1,Yb=>{1===
Yb?(ea(),vb.Hab=null):Ka()})}}Object(k.a)(oc,"ViewContainerAPI",null,[1648,1649]);class Jc extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Jc,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var bd=d(342);class rd{constructor(){this.C_g=this.ydh=this.Njb=this.hfh=this.Rxa=this.ubd=this.T_a=this.wbd=this.gS=this.K=null;this.Ogb=this.lxa=this.gHb=!1;this.ES=this.kDe=null;this.w1g="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.xP=null;this.HK=!1}fc(ea){this.K=ea;this.HK=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Y5d;
this.ES=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.Njb=new B(w.AFrameworkApplication.Be,"CommentPane");ea.register(Za,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().na(()=>new Za);const Ka=this.K.resolve("PowerPointWebEditor.IFileInfo").sla,bb=2===Ka||3===Ka;this.gHb=bb;this.Ogb=1===Ka;ea.register(Ig,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().na(()=>new Ig(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),Ka));ea.register(ue,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().na(()=>new ue(this.ES,Ka,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ha("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));
const vb=this.gHb||!this.Ogb;this.xP=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");vb&&ea.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().na(()=>new bd.a((Bc,qe)=>{let qg=null;const Jf=Object(Wb.a)(178,Bc.sc(ea.resolve("Box4.IPageView").Na));Jf&&!Jf.hm&&(Bc=ea.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").s8d(ea.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Bc,
qe,Jf.oW),qg=new fd(Bc),qg.Cn(Jf.oW),Jf.vta(qg,5),qg.visible=Jf.KR||Jf.Oo);return qg}));this.K.register(1601,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().na(()=>new Xe(this.xP,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),ea.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(1602,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().na(()=>new af(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Xd,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.xP));const Yb=this.gHb||!this.Ogb;this.K.register(1603,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().na(()=>new Eb(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new Ph(Yb),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Yb,Yb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").L$));this.K.register(ig,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().na(()=>
new ig(!this.Ogb,this.K.resolve("Common.Utils.IHighContrastDetector")));const Gc=new ke(vb,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),vb?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.xP,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),
this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));ea.register(1604,"PowerPointWebEditor.IRTEFocusActionHelper").ma().na(()=>new lb(ea.resolve("Common.IFocusManager"),ea.resolve("Common.IF6Manager"),ea.resolve("PowerPointWebEditor.ICommentsPane")));this.K.register(N,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().na(()=>new N(this.K.resolve("Common.ITaskManager")));
const ud=this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("TasksHistoryEnabled");ud&&this.K.register(969,"Common.Comments.ICommentTaskTranslator").ma().na(()=>(new Ua(!0,ud,!0)).r2i());this.K.register(Wa,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().na(()=>new Wa(this.K.resolve("Common.IAppSettingsManager"),ud?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,ud));this.K.register(Ya,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().na(()=>
new Ya);this.lxa=this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("896")&&(bb||!this.Ogb);this.K.register(Pe,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().na(()=>new Pe(this.xP,this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),
this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").va,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Njb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),w.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Xd,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.ES,Gc,this.K.resolve("Common.IAppSettingsManager"),this.K.Ha("Box4.IInteractiveViewManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),vb,ea.resolve("PowerPointWebEditor.IErrorHandler"),ea.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.lxa,ea.resolve("Box4.Graph.IGraphInstance").Cd(10),ea.resolve("PowerPointWebEditor.View.IViewEventSource"),ea.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Yb,ea.resolve("PowerPointWebEditor.IShapeReader"),ea.Ha("Common.App.SafeLinks.ISafeLinksManager"),ea.resolve("Box4.ICharacterPropertiesEditor"),ea.resolve("PowerPointWebEditor.IFileInfo"),
this.HK,ea.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").lLa?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):null,this.K.Ha("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ha("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Cm?
this.K.Ha("PowerPointWebEditor.ISorterViewActorLazy"):null));this.K.register(xb,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().na(()=>new xb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").JFk));this.K.register(oc,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().na(()=>new oc(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.w1g));const Nd=new Pf(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new Uf(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.xP,this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("459"),this.K.ze("PowerPointWeb.Comments.ICommentFrame"));this.K.register(1605,"PowerPointWebEditor.IFindCommentLogic").ma().na(()=>new Ye(Nd,this.K.resolve("Common.ITaskManager")));this.K.register($g,"PowerPointWebEditor.CommentsChangeListener").ma().na(()=>
new $g(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(1606,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().na(()=>new yf(this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.xP,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));this.K.register(je,"PowerPointWebEditor.CommentPropertyTracker").ma().na(()=>new je(Object(qb.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").aUe,
"onCommentPropertiesUpdated"),cb.App.BQ.BW,Ob.GraphTransactionManager.instance));this.K.register(1607,"PowerPointWebEditor.ICommentsPane").ma().na(()=>new Ag(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.HK));this.K.register(we,"PowerPointWebEditor.CommentSmartReplyProvider").ma().na(()=>new we(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){dc.a.instance.Xb(Zb.a.X5d,
(new Date).getTime());const ea=this.ES.lj("UserAction","InitCommentsPackage"),Ka={};this.HK||(this.T_a=this.K.resolve("PowerPointWebEditor.ICommentsPane").va);this.gS=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");this.gS.initialize();var bb=ea.Qr;Ka.CommentFrameInitMS=bb;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.wbd=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");this.wbd.f5j();const vb=ea.Qr;Ka.CommentPropertyTrackerInitMS=vb-bb;this.kDe=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");
this.hfh=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Yb=Ga.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());bb=Yb.Ring||"Unknown";Yb=Yb.WACDatacenter||"Unknown";const Gc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pek;var ud=w.AFrameworkApplication.fa.Ea("LokiComplianceEnvironment");ud=ud&&""!==ud?ud:w.AFrameworkApplication.fa.Ea("SovereignEnvironmentName");this.ydh=new pb("PowerPoint",w.AFrameworkApplication.buildVersion,null,null,w.AFrameworkApplication.userSessionId,
bb,Yb,!Gc,this.K.resolve("Common.IActionManagerExtended"),null,ud);bb=$a.a.Oe(w.AFrameworkApplication.lcid);this.C_g=new zc(w.AFrameworkApplication.isRtl,bb?bb.name:Sys.CultureInfo.CurrentCulture.name,w.AFrameworkApplication.uiCulture,w.AFrameworkApplication.dataCulture);this.HK||(this.T_a.id=this.w1g);this.zdc();w.AFrameworkApplication.fa.Ue(Object(qb.a)(this,this.Pn,"onFullAppSettingsReady"));(bb=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&bb.ppl(new Jc);bb=ea.Qr;
Ka.CommentReactPaneInitMS=bb-vb;this.A8j();Ka.CommentPaneInitMS=ea.Qr-bb;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();ea.stop();mb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",Ka,this.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("896"))}A8j(){const ea=this.K.resolve("PowerPointWebEditor.ICommentsPane"),
Ka=this.K.resolve("PowerPointWebEditor.IPaneManager");this.HK||document.getElementsByClassName("CommentPanel").length||Ka.s0(ea);Ka.Zgc(2);this.K.resolve("PowerPointWebEditor.IFocusManager").Lfa(bf.a.Sr,bf.a.Nj,ea,!ea.isVisible)}zdc(){dc.a.instance.Xb(Zb.a.zdc,(new Date).getTime());const ea=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").oyb().then(Ka=>{dc.a.instance.Xb(Zb.a.Gpe,(new Date).getTime());rb.a.Au(ea.K.Ha("Common.App.People.IExternalPeopleAPI")).continueWith(bb=>{ea.Rxa=
bb.result;ea.Rxa||mb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");ea.K.resolve("PowerPointWebEditor.IApplicationSettings").Mg&&(bb=ea.K.resolve("Common.IAppSettingsManager").Ea("368"),ea.Rxa.$rh(bb+"p"));bb=[ib.a.contextMenu];ea.HK||Vb.a.Nud(ea.T_a,bb);const vb=Ka&&(ea.gHb||!ea.Ogb),Yb=ea.K.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");ea.K.register(We,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().na(()=>
new We(ea.K.resolve("Common.IAppSettingsManager"),ea.K.resolve("PowerPointWebEditor.IApplicationSettings"),ea.Rxa,ea.Ogb,vb,ea.lxa));ea.K.register(Xc,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().na(()=>new Xc(ea.K.resolve("PowerPointWeb.Comments.ICommentFrame"),ea.xP,ea.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),ea.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),ea.K.resolve("Common.ITaskManager"),ea.K.resolve("Common.IAppSettingsManager"),
ea.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),ea.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),ea.Rxa,ea.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),ea.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),vb,ea.lxa,Yb,ea.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),ea.K.resolve("Common.IActionManagerExtended"),ea.K.resolve("PowerPointWebEditor.IApplicationSettings")));ea.ubd=ea.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},
11).continueWith(()=>{ea.ubd&&ea.ubd.checkAtMentionCapability().then(bb=>{bb&&((bb=ea.K.Ha("Common.ISystemInitiatedFeedback"))?bb.execute(vb=>{vb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):mb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});ea.y8j()})})}y8j(){dc.a.instance.Xb(Zb.a.y9e,(new Date).getTime());const ea=this.K.resolve("Common.IDynamicScriptLoaderProvider").nG,Ka=
this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),bb=this.K.resolve("Common.Comments.ICommentActivationManager");dc.a.instance.Xb("CommentActivationManagerInitStart",(new Date).getTime());bb.initialize(ea,this.ubd,this.ydh,this.Rxa,new Od(this.hfh,this.Njb),this.C_g,null,Ka.yMj());dc.a.instance.Xb(Zb.a.Udc,(new Date).getTime());bb.Udc().then(()=>{dc.a.instance.Xb(Zb.a.Hpe,(new Date).getTime());this.gS.hak();dc.a.instance.Xb(Zb.a.bAe,(new Date).getTime());Vc.a(this.K)("floatingContainerManager").then(()=>
{dc.a.instance.Xb(Zb.a.nee,(new Date).getTime());this.gS.K8j();dc.a.instance.Xb(Zb.a.oee,(new Date).getTime());if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").wFi){const vb=this.xP.Zz();vb&&0<vb.length?(this.gS.BLl(),dc.a.instance.Xb(Zb.a.Vzd,(new Date).getTime()),Db.App.FQb(null,Zb.a.Vzd)):mb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(vb=>{mb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+
vb.toString())})})}Pn(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").Gf()}dispose(){this.wbd&&this.wbd.nfm();this.gS&&this.gS.dispose();this.kDe&&this.kDe.dispose();this.Rxa=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){dc.a.instance.Xb(Zb.a.S5d,(new Date).getTime());w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CommentTTVRImprovementIsEnabled",!1)?jb.a.instance.Ac(new rd,0,!0):jb.a.instance.Ac(new rd)}}Object(k.a)(rd,"CommentsPackage",
null,[2,3]);var Zd=d(13);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Type.registerNamespace("Common.Comments");Object(Zd.d)("Comment");rd.main();Object(Zd.c)("Comment")},702:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(18),e=d(99),n=d(28),r=
d(49);d(98);class w{constructor(){this.d1=null}get FCb(){return!1}zZh(D,y){let m=new k.a;const C=new r.GraphTransaction(3);try{C.rd(n.App.Ob.ie.yo.Zg),this.xgc(y)&&(m=this.Zdc(y,m)),y!==D&&this.xgc(D)&&(m=this.Zdc(D,m))}finally{C&&C.dispose()}return m.toArray()}xgc(D){return!!D}Zud(D){let y=!1;for(const m of this.poe)y||!Sys.UI.DomElement.containsCssClass(D,m.className)&&!Sys.UI.DomElement.containsCssClass(D,m.acc)||(y=!0),e.a.SMa(D,m.className),e.a.SMa(D,m.acc)}}Object(L.a)(w,"AHighlightActor",null,
[1358])},703:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.className=e;this.acc=n}}Object(L.a)(k,"HighlightCssClassPair",null,[])},704:function(L,V,d){d.d(V,"b",function(){return r});d.d(V,"a",function(){return w});var k=d(99);d(28);var e=d(49);d(33);d(95);var n=d(98);const r=D=>{const y=new e.GraphTransaction(3);try{y.rd(D),D.Dw(32,!0)}finally{y&&y.dispose()}},w=D=>{if(D){D=k.a.sma(D);if(-1===D.indexOf(n.a.M9)&&-1!==D.indexOf(n.a.AO)&&-1===D.indexOf(n.a.i7b))return 2;
if(-1===D.indexOf(n.a.M9)&&(-1!==D.indexOf(n.a.h7b)||-1!==D.indexOf(n.a.OO)||-1!==D.indexOf(n.a.i7b)||-1!==D.indexOf(n.a.wSc)||-1!==D.indexOf(n.a.pUc)||-1!==D.indexOf(n.a.nUc)||-1!==D.indexOf(n.a.mUc)||-1!==D.indexOf(n.a.U8d)||-1!==D.indexOf(n.a.P8d)||-1!==D.indexOf(n.a.R8d)||-1!==D.indexOf(n.a.oUc)||-1!==D.indexOf(n.a.O8d)))return 1;if(-1!==D.indexOf("WACImageContainer"))return 3}return 0}},705:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.type=this.action=0;this.Klb=
this.Ffa=null}}Object(L.a)(k,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.comment.js.map
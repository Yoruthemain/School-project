'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1011:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static jgg(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";
default:return"external"}}}Object(L.a)(k,"WopiAuthContext",null,[483])},1032:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e,n,r=null){super();this.shapeId=e;this.Jwg=n;this.t_=r}}Object(L.a)(k,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},1033:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e,n=null){super();this.shapeId=e;this.t_=n}}Object(L.a)(k,"ReplaceObjectSuggestionPointerOutEventArgs",
Sys.EventArgs,[])},1034:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.vPc=null}}Object(L.a)(k,"IdeasSmartArtSuggestionWrapper",null,[])},1306:function(L,V,d){d.r(V);var k=d(0),e=d(68),n=d(395),r=d(7),w=d(25),D=d(204),y=d(136),m;(function(v){v[v.error=0]="error";v[v.warning=1]="warning";v[v.tip=2]="tip";v[v.intelligentService=3]="intelligentService"})(m||(m={}));Object(k.b)("AccessibilityRuleCategory",m);var C=d(54),E=d(72),F=d(36),B=d(109),H=d(166),K=d(107);class A{constructor(v,
S,ma=null){this.aHd=null;this.pwf=this.Nvf=!1;this.KDa=v;this.eDc=S;this.Ca=ma;this.zn.xa(F.a.aVi,E.a.frame,Object(r.a)(this,this.FO,"closePane"))}get zn(){return this.Ca||(this.Ca=w.AFrameworkApplication.Pa)}set zn(v){this.Ca=v}dhj(){this.Nvf||(this.KDa.initialize(this),this.eDc.initialize(this),this.Nvf=!0)}QTe(){K.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.eDc.yIl()}Jl(v,S,ma){if(1===ma)return D.SessionStatusManager.instance.Oma?8:32;this.KDa.isVisible||this.dhj();this.e1l();return 32}FO(v,
S,ma){1!==ma&&this.KDa.ur();return 32}zVe(){this.KDa.IRh(!0)}aae(v){if(v){if(v.AccessibilityRules&&Object.keys(v.AccessibilityRules).length){const ma=v.AccessibilityRules;for(const Ja in ma){var S=Ja;const Va=ma[Ja].RuleId+"";S!==Va&&K.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",S,Va)}this.aHd=ma}else!this.aHd&&v.Results&&0<v.Results.length?(K.c(18993251,200,15,"No accessibility rule definitions available"),v.IsSuccess=!1):v.AccessibilityRules=this.aHd;
v.IsSuccess||K.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.xzl(v);this.CDk(v);this.KDa.aae(v)}}xzl(v){const S=v.AccessibilityRules;if(v=v.Results)for(let ma=v.length-1;0<=ma;ma--){const Ja=v[ma];let Va="";const wb=Ja.RuleId;Ja.ContentName||(Va+="Result does not have content name. ");wb in S||(Va+=String.format("No accessibility check rule exists for ID {0}.",wb));0<Va.length&&(K.c(36214999,200,15,"Omitting invalid accessibility check result: "+Va),Array.removeAt(v,ma))}}ZKj(){return w.AFrameworkApplication.fa.getBooleanAppSetting("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("accessibility-checker-pane-strings"):C.a.instance.resolve("Common.IDynamicScriptLoaderProvider").nG.loadScript("accessibility-checker-pane-strings")}e1l(){this.pwf?this.KDa.Jl():this.ZKj().then(()=>{this.pwf=!0;this.KDa.Jl()}).catch(v=>n.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",v))}CDk(v){var S={};const ma={};var Ja=v.Results,Va=[];Array.add(Va,Object.assign(new B.a,{name:"FinalViolationCount",int64:0}));
Array.add(Va,Object.assign(new B.a,{name:"FinalErrorCount",string:"0"}));Array.add(Va,Object.assign(new B.a,{name:"FinalWarningCount",string:"0"}));Array.add(Va,Object.assign(new B.a,{name:"FinalTipCount",string:"0"}));Array.add(Va,Object.assign(new B.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ja){for(const vc of Ja)if(v.AccessibilityRules){var wb=v.AccessibilityRules[vc.RuleId];if(wb){if(S[m[wb.Category]]){let gd=S[m[wb.Category]];S[m[wb.Category]]=++gd}else S[m[wb.Category]]=1;ma[vc.RuleId]?
(wb=ma[vc.RuleId],ma[vc.RuleId]=++wb):ma[vc.RuleId]=1}}Va[0].int64=Ja.length;for(var Sb in S)switch(v=S[Sb],Ja=Sb,Ja="Final"+Ja.charAt(0).toUpperCase()+Ja.substring(1,Ja.length)+"Count",Ja){case "FinalErrorCount":Va[1].string=v.toString();break;case "FinalWarningCount":Va[2].string=v.toString();break;case "FinalTipCount":Va[3].string=v.toString();break;case "FinalIntelligentServiceCount":Va[4].string=v.toString()}}y.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}","Office.UX.AccChecker",
"AccCheckerViolationInformation"),dataFields:Va}));for(const vc in ma)S=vc,Va=ma[vc],Sb=[],Array.add(Sb,Object.assign(new B.a,{name:"RuleID",string:S})),Array.add(Sb,Object.assign(new B.a,{name:"FinalViolationCount",string:Va.toString()})),y.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Sb}))}dispose(){this.KDa&&this.KDa.dispose();this.eDc&&this.eDc.dispose()}}Object(k.a)(A,"AAccessibilityCheckManager",
null,[233,106]);var W=d(80),N=d(1264),P=d(57),U=d(295),Q=d(27);class G extends A{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd){super(v,S);this.Jib=this.kKa=null;this.Fa=ma;this.zb=Ja;this.xq=Va;this.K6=wb;this.sa=Sb;this.oa=vc;this.Tb=gd;this.qOe=!1}kQl(v){if(!v)return Q.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(v.sldIdField){var S=new P.a(Object.assign(new U.a,{Sid:v.sldIdField.sidField,Cid:v.sldIdField.cidField}));S=this.Tb.Dma(S);if(!S)return!1;let ma=null;if(v.spIdFieldSpecified&&
(ma=S.KD(v.spIdField),!ma&&this.qOe))return!1;this.JLl(S,ma)}else Q.a.J(19227929,334,15,"There is no slide id info in violation data");return!0}QTe(){this.qOe=!1;super.QTe()}zVe(){this.qOe=!0;super.zVe()}JLl(v,S){if(v){const ma=this.sa.Aa!==v?!0:!1;S&&(this.Jib=S,ma?this.xq.kU(Object(r.a)(this,this.$Lb,"onActiveSlideDomChanged")):this.dKh());ma&&(this.K6.Aa=v);this.oa.Pu();this.Fa.Gd()}}$Lb(){this.xq.wqa(Object(r.a)(this,this.$Lb,"onActiveSlideDomChanged"));this.kKa||(this.kKa=new W.a(2,1,0,Object(r.a)(this,
this.sVe,"onPostActiveSlideDomChangedTask"),90,"20"),this.zb.Jb(this.kKa))}sVe(){this.kKa=null;this.dKh()}Gd(){this.K6.dM.Wp||this.Fa.Gd()}dKh(){if(this.Jib){const v=Object(N.a)(178,this.Jib.vg(this.K6.dM.Na));v?v.hm?Q.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.Jib.id):v.Mq?v.OAd():this.oa.selectShape(this.Jib,!0):Q.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.Jib.id);this.Gd();this.Jib=null}}}Object(k.a)(G,"PptAccCheckManager",
A,[]);class Y{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(v){v=Sys.Serialization.JavaScriptSerializer.deserialize(v);const S=v.AccessibilityRules,ma={};if(S)for(let Ja=0;Ja<S.length;++Ja){const Va=S[Ja];ma[Va.Key]=Va.Value}v.AccessibilityRules=ma;return v}}Object(k.a)(Y,"AccessibilityCheckResultCollection",null,[]);class ba{}Object(k.a)(ba,"AccessibilityCheckResult",null,[]);class ha{}Object(k.a)(ha,"AccessibilityCheckRule",
null,[]);class ka{constructor(v){this.nPa=null;this.Ftf=v}get fileId(){return this.Ftf?this.Ftf():null}initialize(v){this.nPa=v}Jlh(v){this.nPa.aae(v)}}Object(k.a)(ka,"AAccessibilityCheckService",null,[383,106]);var ca=d(18),ia=d(114);class oa extends ia.a{constructor(){super()}om(){return 56}}Object(k.a)(oa,"AccCheckRequest",ia.a,[]);var sa=d(247);class Ca extends ka{constructor(v,S){super(null);this.Qi=v;this.J_a=S}yIl(){const v=new sa.a(new oa,Object(r.a)(this,this.X1k,"onAccCheckSucceed"),Object(r.a)(this,
this.W1k,"onAccCheckFailed"));this.Qi.Jb(v)}dispose(){}get qdk(){return 0<this.J_a.t2b.length}X1k(v){if(v&&v.ACResult&&(v=this.JJi(v.ACResult))){this.Jlh(v);Q.a.J(19227935,334,50,"Acc-check succeeded");return}this.Zfh("Succeeded but response is invalid")}W1k(v){this.Zfh(v.toString());return!0}Zfh(v){Q.a.J(19227937,334,50,String.format("Acc-check failed: {0}",v));v=new Y;v.IsSuccess=!1;this.Jlh(v)}JJi(v){if(v){var S=null;try{S=JSON.parse(v)}catch(ma){return Q.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",
ma.toString()),null}if(S){v=new Y;v.IsSuccess=!0;v.IsPartialResult=S.isPartialResultField;v.AccessibilityRules={};if(S.violatedRulesField){const ma=new ca.a;for(const Ja of S.violatedRulesField)if(S=this.LJi(Ja)){v.AccessibilityRules[S.RuleId]=S;for(const Va of Ja.violationsField){const wb=new ba;wb.RuleId=S.RuleId;wb.ContentName=Va.labelField;wb.ContentId=Va;ma.add(wb)}}v.Results=ma.toArray()}return v}}return null}LJi(v){if(!v)return null;if(v.ruleIdField>=this.J_a.t2b.length)return Q.a.J(19227971,
334,10,"Rule id {0} is bigger than total rule info list count {1}",v.ruleIdField,this.J_a.t2b.length),null;const S=new ha;S.RuleId=v.ruleIdField.toString();S.RuleName=this.J_a.t2b[v.ruleIdField].ruleTextField;switch(this.J_a.t2b[v.ruleIdField].ruleTypeField){case 0:S.Category=0;break;case 1:S.Category=1;break;case 2:S.Category=2;break;case 3:S.Category=3}return S}}Object(k.a)(Ca,"PptAccCheckService",ka,[1538,383,106]);class Ta{get w_i(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get x_i(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get y_i(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Hbl(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Mqd(){return CommonUIStrings.l_AccCheckerPaneTitle}get vel(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(k.a)(Ta,"AccessibilityCheckStringsProvider",null,[384]);class R{constructor(){this.$Hh=this.contentId=null}}Object(k.a)(R,"ResultIds",null,[]);var Ha=d(67),da=d(183);class Ba{constructor(v,S){this._element=null;this.er=S;this.lh=v}get element(){this._element||(this._element=this.E7d(),this.ps());return this._element}cob(v){this._element=v}dispose(){this.element&&(this.Jca(),this.cob(null))}ps(){this.er&&this.lh?(this.er.xb(Ha.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.lh.xb(Ha.a.Vf,
this.element,Object(r.a)(this,this.Gnh,"onKeyPress"))):n.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Jca(){this.er&&this.lh&&(this.er.Hb(Ha.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.lh.Hb(Ha.a.Vf,this.element,Object(r.a)(this,this.Gnh,"onKeyPress")))}onClick(){this.Cnh();return!0}Gnh(v){return this.Okk(v.hc.keyCode)?(this.Cnh(),!0):!1}Okk(v){return v===da.a.MUb||
v===da.a.Mp}}Object(k.a)(Ba,"AInteractivePaneElement",null,[422,106]);const za=(v,S,ma)=>{v=document.createElement(v);S&&(v.id=S);ma&&(v.className=ma);v.setAttribute("Unselectable","on");return v};var Aa=d(78),na=d(142),la=d(99);class va extends Ba{constructor(v,S,ma){super(v,S);this.hki=ma}hide(){this.element.removeAttribute(na.a.Ff);na.a.bT(this.element,na.a.JJ,na.a.cC);this.element.style.display="none"}show(){na.a.bT(this.element,na.a.JJ,na.a.Xka);na.a.bT(this.element,na.a.Ff,na.a.c1d);this.element.style.display=
"block"}E7d(){const v=za("div",this.Djh,"AccCheckerNotification");na.a.bT(v,na.a.d1d,na.a.cC);na.a.bT(v,na.a.E4,this.ISe);v.tabIndex=0;const S=za("span",this.Cjh,"AccCheckerNotificationIcon");var ma=Aa.createClusteredImage(16,16,"Info_16x16x32","",!0,"");S.appendChild(ma);ma=za("span",this.ISe,"AccCheckerNotificationText");la.a.yA(ma,this.Ejh);v.appendChild(S);v.appendChild(ma);return v}Cnh(){this.hki()}}Object(k.a)(va,"APopupNotification",Ba,[460,422,106]);class Pa extends va{constructor(v,S,ma,
Ja){super(v,S,ma);this.Pda=Ja}get Djh(){return"AccCheckerOutOfSyncNotificationId"}get Cjh(){return"AccCheckerOutOfSyncNotificationIconId"}get ISe(){return"AccCheckerOutOfSyncNotificationTextId"}get Ejh(){return this.Pda.Hbl}}Object(k.a)(Pa,"OutOfSyncNotification",va,[]);class Qa extends va{constructor(v,S,ma,Ja){super(v,S,ma);this.Pda=Ja}get Djh(){return"AccCheckerPartialResultNotificationId"}get Cjh(){return"AccCheckerPartialResultNotificationIconId"}get ISe(){return"AccCheckerPartialResultNotificationTextId"}get Ejh(){return this.Pda.vel}}
Object(k.a)(Qa,"PartialResultNotification",va,[]);var Ua=d(122),Ya=d(111);class Ea{constructor(v,S,ma,Ja=null,Va=null,wb=null,Sb=null){this.VDf=this.k9=this.lh=this.nPa=null;this.tfb=Ja;this.er=v;this.Wd=S;this.KL=ma;this.Pda=Sb||new Ta;this.pSd=Va||new Pa(this.tfb,this.er,Object(r.a)(this,this.Xbj,"dimissOutOfSyncNotification"),this.Pda);this.ESd=wb||new Qa(this.tfb,this.er,Object(r.a)(this,this.Ybj,"dimissPartialResultNotification"),this.Pda)}show(){}hide(){}get tfb(){return this.lh||(this.lh=w.AFrameworkApplication.za.uH)}set tfb(v){this.lh=
v}D0f(){}ur(){}dispose(){}e1h(){}zyd(){}Zck(v){var S=this.VDf[v];v=S.contentId;if((S=S.$Hh+"")&&S.length){const ma=[];Array.add(ma,Object.assign(new B.a,{name:"RuleID",string:S}));y.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ea.Jdf,"ViolationSelected"),dataFields:ma}))}this.i_k(v)}i_k(v){v&&this.nPa.kQl(v)||(this.Wd.dW(Ua.AFrame.pX,!1),this.F_l())}Xbj(){this.IRh(!1);this.zyd()}Ybj(){this.KRh(!1);this.zyd()}F_l(){const v=Object.assign(new Ya.StandardDialog(!0),{Is:w.AFrameworkApplication.Rfa,
Fd:1,T3a:!1});v.uAa(1);v.Te(1,this.Pda.w_i);v.Te(0,CommonUIStrings.l_DialogCancel);v.vQ(this.Pda.y_i,this.Pda.x_i,S=>{1===S&&this.Lte()})}tLi(v){let S=null;if(v.Results&&0<v.Results.length){S={};let ma=0;for(const Ja of v.Results)Ja.ResultId=Ea.Xri+ ++ma,v=new R,v.contentId=Ja.ContentId,v.$Hh=Ja.RuleId,S[Ja.ResultId]=v}return S}RDk(){y.a.addNamespaceMapping(Ea.Jdf,Ea.r9l);y.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ea.Jdf,"ShowTaskpane")}))}}Ea.Xri="AccCheckResult";
Ea.Jdf="Office.UX.AccChecker";Ea.r9l="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(k.a)(Ea,"BaseAccessibilityCheckPane",null,[386,106]);class La{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(k.a)(La,"AccCheckerTaskPaneProps",null,[]);
var xb=d(1218),dc=d(308);class gb{constructor(){this.VDc=new ca.a}MMa(v){this.VDc.add(v)}ESl(v){for(const S of this.VDc)S(v)}}Object(k.a)(gb,"ReactTaskPaneManager",null,[423]);var gc=d(661),Ac=d(144);class $b extends Ea{constructor(v,S,ma,Ja,Va=null,wb=null,Sb,vc=null,gd=null){super(S,ma,Ja,wb,void 0,void 0,vc);this.qnf=null;this.iDf=this.DSd=this.xJc=this.WKc=this.IKc=!1;this.EXd=null;this.zWd=!!w.AFrameworkApplication.za&&!!w.AFrameworkApplication.za.mb&&w.AFrameworkApplication.za.mb.mye;this.IXb=
this.Kra=null;this.gYb=0;this.DGc=null;this.WHd=Va;gd&&(this.Kra=gd.lsi,this.IXb=gd.Joj,this.gYb=gd.t2j);this.Lsa=new gb}get isVisible(){return this.iDf}ERb(v){this.iDf=v}aae(v){v&&(this.qnf=v,v.IsSuccess&&(this.VDf=this.tLi(v),v.IsPartialResult&&this.KRh(!0)),this.IKc=!0,this.WKc=!1,this.QBc())}IRh(v){this.isVisible&&v!==this.xJc&&(this.xJc=v,this.QBc())}KRh(v){this.DSd=v;this.QBc()}Jl(){this.WKc||Ac.UISurfaces.qr().then(v=>{dc.a.instance.z4($b.w5a+":PaneOpen:Start");v.showTaskPane($b.w5a,this.Hea());
this.Lte();return null});this.isVisible?Ac.UISurfaces.qr().then(v=>{v.setSelectedTaskPane($b.w5a);return null}):this.RDk()}QBc(){Ac.UISurfaces.qr().then(v=>{v.updateTaskPane($b.w5a,this.Hea());return null})}Hea(){var v=new La;this.Lsa.ESl(v);v=Object.assign(new gc.a,{title:this.Pda.Mqd,hideHeader:!1,width:320,location:2,contentProps:v,onOpen:()=>{this.nQl();this.ERb(!0);w.AFrameworkApplication.za.Gf()},onClose:()=>{this.Fyd();this.ERb(!1);this.WKc=this.IKc=!1;this.QBc();w.AFrameworkApplication.za.Gf()},
isModernPane:!0});this.zWd&&(v.enableResize=!0,v.minResizeWidth=268,v.maxResizeWidth=920);return v}initialize(v){const S=this.Wd.Kc($b.w5a);S.parent=Ua.AFrame.Nj;S.uK=!0;this.nPa=v;this.Asi()}dispose(){this.e1h();this.pSd&&(this.pSd.dispose(),this.pSd=null);this.ESd&&(this.ESd.dispose(),this.ESd=null);super.dispose()}Asi(){this.Lsa.MMa(this.onRecheckExecute());this.Lsa.MMa(this.rtj());this.Lsa.MMa(this.iKj());this.Lsa.MMa(this.onInvokeNavigateExecute());this.Lsa.MMa(this.xCj());this.Lsa.MMa(this.wHj());
this.Lsa.MMa(this.$Hj());this.Lsa.MMa(this.updateLastScanTime());this.Lsa.MMa(this.showHelpPane())}onRecheckExecute(){return v=>{v.onRecheckExecute=()=>{this.Lte()}}}rtj(){return v=>{v.accessibilityCheckResultCollection=this.qnf}}iKj(){return v=>{v.resultsReady=this.IKc}}onInvokeNavigateExecute(){return v=>{v.onInvokeNavigateExecute=S=>{this.Zck(S)}}}xCj(){return v=>{v.helpLink=this.gkj}}wHj(){return v=>{v.outOfSync=this.xJc}}$Hj(){return v=>{v.partialResult=this.DSd}}updateLastScanTime(){return v=>
{v.updateLastScanTime=S=>{this.EXd=S}}}showHelpPane(){return v=>{v.showHelpPane=()=>{w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?w.AFrameworkApplication.vua||this.pPf()?this.DGc?this.DGc():this.Kra.value&&this.IXb&&this.gYb&&this.Kra.value.Ia(this.gYb,2,this.IXb):this.uSh():this.pPf()?this.DGc?this.DGc():this.Kra.value&&this.IXb&&this.gYb&&this.Kra.value.Ia(this.gYb,2,this.IXb):this.uSh()}}}pPf(){return!this.WHd||
!this.WHd.value}uSh(){const v=this.WHd.value;if(v){var S={};S.query=$b.bmi+$b.TMd;S=Object.assign(new xb.a,{nonPersistedSettings:S});v.Aia($b.SMd,S)}}Lte(){this.DSd=this.xJc=this.IKc=!1;this.EXd&&this.EXd();this.QBc();this.WKc=!0;this.nPa.QTe()}nQl(){this.Wd.Df($b.w5a)}Fyd(){this.lye()&&this.Wd.Df(this.Wd.R9)}lye(){return!!this.Wd.Je&&this.Wd.Je.name===$b.w5a}}$b.w5a="AccessibilityCheckerPane";$b.TMd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";$b.SMd="FA000000012";$b.bmi="AssetID=";Object(k.a)($b,"ReactAccessibilityCheckPane",
Ea,[]);class jc{constructor(v,S,ma){this.lsi=v;this.Joj=S;this.t2j=ma}}Object(k.a)(jc,"HelpPaneProperties",null,[]);var pb=d(88),$a=d(29);class zc extends $b{constructor(v,S,ma,Ja,Va,wb,Sb,vc){super(null,S,ma,Ja,void 0,null,void 0,void 0,new jc(Sb,zc.Fhe(),$a.a.Aia));this.anc=v;this.BFk=Va;this.MI=wb;this.Olc=Sb;this.nv=vc}get isVisible(){return!!this.anc&&this.anc.isVisible}ERb(v){this.anc&&(this.anc.isVisible=v)}get gkj(){return this.BFk}Jl(){this.ERb(!0);this.MI.uQ(this.anc,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
Ua.AFrame.pX);super.Jl();if(this.Olc){var v=this.Olc.value;if(v){v.nb($a.a.gNc,1);v=!1;try{this.nv.selectRibbonTabById("AccessibleAuthoring"),v=!0}catch(S){Q.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",S.toString())}pb.a("AccessibleAuthoringTab",v)}else Q.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else Q.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Rod(){}onBeforeLoadContent(){}onAfterLoadContent(){this.nPa&&
this.nPa.zVe()}onAfterFirstSaveContent(){}static Fhe(){const v={};v.BA=ResourceStrings.L_Help;v.assetId="FA000000012";v.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return v}}Object(k.a)(zc,"PptReactAccCheckControl",$b,[435]);class rb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}fc(v){this.K=v;this.K.register(Ca,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().na(()=>
new Ca(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(386,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().na(()=>new zc(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.ze("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(233,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().na(()=>new G(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Ac(new rb)}}Object(k.a)(rb,"PptAccessibilityPackage",null,[2,3]);var ib=d(193),Vb=d(1270),Od=d(251),jb=d(194),Wb=d(543),qb=d(51),Ga=d(126);class cb{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd){this.ia=v;this.ka=S;this.CFk=ma;this.DFk=Ja;this.Qfb=Va;this.nv=Sb;this.J_a=wb;this.Fa=vc;this.Wb=gd;this.J_a.pyi(Object(r.a)(this,this.pBh,"refreshAccCheckButtonStatus"))}qb(){this.ka.powerPointEnableAccCheck&&
(this.ia.pa($a.a.qYe,qb.a.application,Object(r.a)(this,this.uRi,"checkAccessibility"),4),this.ia.pa($a.a.Xnl,qb.a.application,Object(r.a)(this,this.nnl,"queryCheckAccessibility"),97))}Sd(){this.ka.powerPointEnableAccCheck&&this.Fa.Kc(Ga.a.TSf).bindAction(jb.KeyInputManager.Va(da.a.TCc,jb.KeyInputManager.Ze|1),$a.a.qYe)}uRi(v,S,ma,Ja,Va){return 1===ma?this.Wb.Hi()?this.DFk.qdk?32:8:8:this.CFk.Jl(v,S,ma,Ja,Va)}nnl(v,S,ma,Ja,Va){Va[Wb.a.On]=this.Qfb.isVisible;return 32}dispose(){this.J_a.YAl(Object(r.a)(this,
this.pBh,"refreshAccCheckButtonStatus"))}pBh(){this.nv.CB()}}Object(k.a)(cb,"AccCheckActor",null,[948,106]);class Ob{constructor(){this.Ghc=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}fc(v){this.K=v}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").uXa(()=>{this.$Cb()})}$Cb(){const v=this.K.resolve("Common.AFrameworkApplication").nU.td,S=this.K.resolve("Common.IActionManagerExtended");v.powerPointEnableAccCheck&&(this.Ghc=new cb(S,v,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.Ghc.qb(),this.Ghc.Sd());v.cAe&&ib.a.get_instance().Ij(7,Object(r.a)(this,this.cAe,"loadInternalSlice"))}cAe(){const v=Vb.a.create("pptedit.internal",
null,()=>d.e(18).then(d.bind(null,1323)));Od.a.bF(v)}dispose(){this.Ghc&&this.Ghc.dispose()}static main(){e.a.instance.Ac(new Ob)}}Object(k.a)(Ob,"PptLazyActorsPackage",null,[2,3]);var Db=d(213),mb=d(254),Vc=d(593),Zb=d(188),fc=d(170),ob=d(58),ub=d(48),bc=d(70),ic=d(69),Rc=d(378);class Fb{constructor(v,S,ma,Ja,Va,wb,Sb){this.Jd=1;this.t2=new Zb.a;this.Nv=new Zb.a;this.Gp=!1;this.yUg="";this.vJe=this.wJe=this.w6=this.hxa=this.hba=!1;this.h0f=()=>{this.w6||this.wJe||(this.QGb||(this.QGb=new W.a(3,1,
this.ka.QRh,this.dismissImageDescriptionBarTask,90,"19")),this.w6=!0,this.zb.Jb(this.QGb))};this.m4f=()=>{this.w6&&(this.w6=!1,this.zb.Vg(this.QGb),this.QGb=void 0)};this.n7k=()=>{this.wJe=!0;this.m4f();return!0};this.o7k=()=>{this.wJe=!1;this.h0f();return!0};this.l6k=vc=>this.wmh(vc);this.P2k=()=>{this.ia.nb($a.a.BPc,2);this.Zyb();return!0};this.wmh=()=>{this.ia.nb($a.a.iWc,2);this.Zyb();return!0};this.onSelectionChange=()=>{this.Zyb()};this.dismissImageDescriptionBarTask=()=>{this.Zyb()};if(!v)throw Error.argumentNull("shapeNode");
if(!S)throw Error.argumentNull("taskManager");if(!Ja)throw Error.argumentNull("appSettings");if(!wb)throw Error.argumentNull("clickInputManager");if(!Sb)throw Error.argumentNull("pptSelectionManager");this.ta=v;this.zb=S;this.te=ma;this.ka=Ja;this.ia=Va;this.hd=wb;this.gb=Sb}P2i(){this.dB=ub.a.we();this.dB.className="ImageDescriptionBarNew";this.hd.xb(Ha.a.click,this.dB,this.l6k);mb.a.instance.xb(Ha.a.uha,this.dB,this.n7k);mb.a.instance.xb(Ha.a.vha,this.dB,this.o7k);this.$De=ub.a.En();this.zgb=document.createElement(ub.a.k$a);
this.zgb.className="ImageDescriptionBarNewButton";this.zgb.appendChild(Object(Rc.b)("M 768 1660 l -666 -666 l 73 -72 l 593 593 l 1105 -1105 l 73 72 z",20,20).va);var v=ub.a.En();v.innerText=ResourceStrings.L_ImageDescriptionBarApprove;this.zgb.appendChild(v);this.hd.xb(Ha.a.click,this.zgb,this.P2k);this.ejc=document.createElement(ub.a.k$a);this.ejc.className="ImageDescriptionBarNewButton";this.ejc.appendChild(Object(Rc.b)("M 1879 169 q 39 39 59 88 q 20 50 20 102 q 0 51 -20 100 q -20 50 -59 89 l -1221 1215 l -556 183 l 195 -574 l 1203 -1203 q 38 -38 86 -57 q 48 -19 99 -19 h 4 q 53 0 103 19 q 49 19 87 57 m -1440 1206 q 85 26 147 87 q 61 62 87 147 l 995 -995 l -234 -234 m -1194 1428 l 345 -127 q -6 -43 -24 -80 q -19 -37 -48 -66 q -29 -29 -66 -48 q -37 -18 -80 -24 m 1440 -987 q 24 -24 37 -55 q 12 -30 12 -62 q 0 -33 -13 -63 q -13 -30 -35 -53 q -23 -22 -53 -36 q -31 -13 -66 -13 q -32 0 -63 12 q -31 12 -54 35 l -66 66 l 235 235 z",
20,20).va);v=ub.a.En();v.innerText=ResourceStrings.L_ImageDescriptionBarEdit;this.ejc.appendChild(v);this.hd.xb(Ha.a.click,this.zgb,this.wmh);this.dB.appendChild(this.$De);this.dB.appendChild(this.zgb);this.dB.appendChild(this.ejc)}E2h(v){const S=v.indexOf("\n");this.yUg=-1===S?v:v.substring(0,S);this.$De.innerText=ResourceStrings.L_ImageDescriptionBarFormatString.replace("{0}",this.yUg);this.nhf(!0)}nhf(v){this.Eo=this.ta.Ko;this.hxa=v;this.asd();this.dB.style.display=this.hxa?ic.a.q3:ic.a.kf;this.h0f()}Zyb(){if(this.hba){this.hxa=
this.hba=!1;this.gb.Xza(this.onSelectionChange);this.m4f();this.Rnc&&this.Rnc.contains(this.dB)&&this.Rnc.removeChild(this.dB);const v=Date.now()-this.ESk,S=new B.a;S.name="IsMisaligned";S.int64=this.vJe?1:0;pb.a("AltTextBar",!0,v,[S])}}asd(){if(this.hba&&this.Eo){var v=this.Eo.copy();this.t2.Zm(v);this.Nv.Zm(v);var S=Vc.a.VS(ob.a.IJ(v.ga(0),v.ga(1))),ma=v.el(new fc.a(6)),Ja=v.el(new fc.a(4));v=v.el(new fc.a(2));v=ob.a.an(Ja,v)*this.Jd;ma=ob.a.an(ma,Ja)*this.Jd;this.dB.style.position=ic.a.Iia;if(45<=
S&&135>S||225<=S&&315>S){if(150>v||70>ma){this.hxa=!1;return}this.dB.style.marginLeft=(.5*(ma-v)).toString()+"px";this.dB.style.marginTop=(.5*(ma+v)-this.dB.offsetHeight).toString()+"px";this.dB.style.width=v.toString()+"px"}else{if(150>ma||70>v){this.hxa=!1;return}this.dB.style.marginLeft="0";this.dB.style.marginTop=(v-this.dB.offsetHeight).toString()+"px";this.dB.style.width=ma.toString()+"px"}this.vJe=0!=S%90}}E0l(v){this.ESk=Date.now();this.dB&&this.Rnc&&(this.hba=!0,this.vJe=!1,this.Rnc.appendChild(this.dB),
this.gb.AG(this.onSelectionChange),this.E2h(v))}Cim(v){this.ta===v&&this.hba&&this.E2h(this.ta.R_d)}get visible(){return this.hxa}set visible(v){this.hba&&(this.hxa!==v&&(this.hxa=v,this.dB.style.display=this.hxa?ic.a.q3:ic.a.kf),this.hxa||this.Zyb())}Cn(v){this.Rnc=v.va;this.P2i()}setPosition(){}Pj(v){this.Jd=v;this.hba&&this.asd()}Kr(v){this.t2=v;this.hba&&this.asd()}Tv(v){this.Nv=v;this.hba&&this.asd()}setZIndex(v){this.hba&&(this.dB.style.zIndex=v.toString())}wE(v){if(this.hba&&!this.Gp)switch(v){case 1:this.te&&
(v=this.te.Ok("formatpainterobject.cur"),this.dB.style.cursor=ub.a.rR(v,bc.a.zzc));break;case 0:this.dB.style.cursor=bc.a.zzc}}jF(){return null}Xz(){}TF(v,S){this.hba&&(this.nhf(!v&&S||!S),!v&&this.QGb&&this.zb.G7(this.QGb,this.ka.QRh))}Jq(){return null}aP(){return!1}Ry(v){this.Gp=v}setSelection(){}bD(){return[]}draw(){this.hba&&this.nhf(!0)}dispose(){this.Zyb();this.dB&&(this.ejc=this.zgb=this.$De=this.dB=void 0)}}Object(k.a)(Fb,"ImageDescriptionBarViewNew",null,[1537,805,806,106]);var Qb=d(1061),
hc=d(46),Pc=d(38);class uc{constructor(v,S,ma,Ja){this.shapeNode=v;this.MXc=S;this.vnk=ma;this.imageDescription=Ja}}Object(k.a)(uc,"ImageDescriptionCache",null,[]);var zb=d(222);class ac{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd){this.Aaa=new Qb.a;this.Qdk=Ke=>{[Ke]=Object(Rc.c)(Ke);return Ke};this.yb=v;this.Qi=S;this.xq=Sb;this.vOg=ma;this.gb=Ja;this.X1=wb;this.lJa=Va;this.Qs=vc;this.Eb=gd;this.ic=od;this.ced=Vd}initialize(){this.Qs.Ak(Object(r.a)(this,this.ph,"onPropertyChanged"));this.xq.WLf(Object(r.a)(this,
this.yMb,"onShapeImageFirstDraw"));this.xq.hzi(Object(r.a)(this,this.Unh,"onLocalImageViewDismissed"));this.vOg.czi(Object(r.a)(this,this.pnh,"onImageDescriptionReady"))}dispose(){this.Qs.tn(Object(r.a)(this,this.ph,"onPropertyChanged"));this.xq.u3e(Object(r.a)(this,this.yMb,"onShapeImageFirstDraw"));this.xq.CBl(Object(r.a)(this,this.Unh,"onLocalImageViewDismissed"));this.vOg.yBl(Object(r.a)(this,this.pnh,"onImageDescriptionReady"))}ph(v,S){if((v=S.node)&&v.$j)if(S=S.property,S===Pc.a.alt){S=Object(N.a)(178,
v.sc(this.yb.Na));const ma=v.get_alt();ma&&this.Qdk(ma)&&(S&&S.KR&&v.get_alt()&&(S=this.ced.$J(v))&&S.Cim(v),this.lJa.Ogm(v),v.get_alt()&&this.KAd(v,v.get_alt()))}else S===Pc.a.ND?v.ND&&(S=Object(N.a)(178,v.sc(this.yb.Na)))&&S.KR&&(v=this.ced.$J(v))&&(v.visible=!1):S===Pc.a.mg&&v.mg!==zb.a.bV?(S=Object(N.a)(178,v.sc(this.yb.Na)))&&S.KR&&!v.lga&&this.Aaa.ga(v.id)&&this.Aaa.ga(v.id).MXc&&(this.C$b(v,S),this.Aaa.remove(v.id)):S===Pc.a.KM&&(v=this.ced.$J(v))&&(v.visible=!1)}pnh(v,S){if(v=S.Z2c){var ma=
S.confidence,Ja=S.imageDescription,Va=S.ojk;S=S.MXc;var wb=this.X1.tfa(v),Sb=wb?Object(N.a)(178,wb.sc(this.yb.Na)):null;S?Sb&&Sb.KR&&!wb.isLocal&&!wb.ND?this.C$b(wb,Sb):this.Aaa.add(v,new uc(wb,!0,!0,Ja)):!Ja||!Va&&60>ma?Q.a.J(509092041,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Va,ma):(Ja=this.iXi(ma,Ja),Va?this.q7e(wb,Ja,!1):(Q.a.J(509092040,815,50,"Image description ready for show and save"),Sb&&Sb.KR?(Q.a.J(509092039,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",
v.toString(),(new Date).getTime()),this.KAd(wb,Ja),wb.isLocal?this.Aaa.add(v,new uc(wb,!1,!1,Ja)):(Q.a.J(509092038,815,50,"Save image description immediately"),this.q7e(wb,Ja,!0))):this.Aaa.add(v,new uc(wb,!1,!0,Ja))))}else Q.a.J(509092042,815,15,"Graph node id is null")}yMb(v,S){v=S.Z2c;Q.a.J(509092037,815,50,"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",v?v.toString():"",(new Date).getTime());this.Aaa.Ib(v)?this.jxh(v):(v=this.X1.tfa(v))&&v.get_alt()&&this.KAd(v,v.get_alt())}iXi(v,S){S+=
String.fromCharCode(10,10);return S=80<=v?S+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=v?S+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=v?S+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=v?S+ResourceStrings.L_ImageDescriptionWithLowConfidence:S+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}Unh(v,S){(v=S.V3l)&&this.Aaa.Ib(v.id)&&this.jxh(v.id)}jxh(v){const S=this.Aaa.ga(v).shapeNode;if(S){var ma=this.Aaa.ga(v).MXc,Ja=this.Aaa.ga(v).vnk,Va=this.Aaa.ga(v).imageDescription;
ma?(ma=Object(N.a)(178,S.sc(this.yb.Na)))&&this.C$b(S,ma):(Ja&&this.KAd(S,Va),S.isLocal?Q.a.J(509092035,815,15,"Try to save alt text for local picture"):this.q7e(S,Va,!0));this.Aaa.remove(v)}else Q.a.J(509092036,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}C$b(v,S){this.Qi.generateImageDescription(v.id,S.lbf,v.get_isSVGBlipFilled(),!1)}q7e(v,S,ma){const Ja=Date.now();if(!ma||!v.get_alt()){var Va=this.Eb.xe(ma?7:15);Va.mc(v);v.V3a=ma;v.set_alt(hc.a.aXa(S));Va.dispose();ma&&
this.Qi.forceOutbound();v=Date.now()-Ja;pb.a("UpdateAltText",!0,v)}}KAd(v,S){if(v.$j){this.ic.Xc(v)&&Q.a.J(509092033,815,50,"Graph node or parents blocked");var ma=this.gb.Hd();ma&&this.gb.zY(v)?(Q.a.J(509092003,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",v.id.toString(),(new Date).getTime()),(v=this.ced.$J(v))&&v.E0l(S)):Q.a.J(509092032,815,50,"Is selected shapes empty: {0}",!ma)}else Q.a.J(509092034,815,50,"ShapeNode.IsPicture: {0}",v.$j)}}Object(k.a)(ac,
"ImageDescriptionManager",null,[106]);var Jb=d(96),Yc=d(348),dd=d(47),id=d(30);class Cc{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh){this.Mb=!1;this.lIe=new Qb.a(0);this.ph=(df,bg)=>{df=bg.node;this.tA&&this.tA.includes(df)&&[Pc.a.alt,Pc.a.jEa,Pc.a.KM].includes(bg.property)&&this.N4c()};this.kuj=()=>{if(!this.tA||0===this.tA.length)return"";let df="",bg=!0;for(const ih of this.tA){const He=ih.R_d;if(!bg&&He!==df)return"";df=He;bg=!1}return df};this.Vyj=()=>{if(!this.tA||0===this.tA.length)return[!1,
!1];let df=!0,bg=!0;for(const ih of this.tA)ih.KM?bg=!1:df=!1;return[df,!(df||bg)]};this.N4c=()=>{if(this.tA&&0!==this.tA.length){this.MUg=this.I1.checked;[this.NZa,this.iZ.indeterminate]=this.Vyj();this.iZ.checked=this.NZa;this.iZ.disabled=!1;this.Shb.style.display=ic.a.kl;this.qIe=this.kuj();this.$A.value=this.NZa?ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative:this.qIe;this.$A.disabled=this.NZa;this.bKe=this.Dqk();var df=!1;if(this.bKe){let bg;[df,bg]=Object(Rc.c)(this.$A.value);df=
df&&0<bg}this.Owa.style.display=df||this.I1.checked?ic.a.kl:ic.a.kf;this.waa.style.display=!this.bKe||df||this.I1.checked?ic.a.kf:ic.a.kl;this.waa.disabled=this.NZa;this.oxa.style.display=ic.a.kf;""!==this.xaa.innerText&&(this.xaa.innerText="");this.A5b()}else this.$A.value="",this.$A.disabled=!0,this.waa.style.display=ic.a.kf,this.oxa.style.display=ic.a.kf,""!==this.xaa.innerText&&(this.xaa.innerText=""),this.A5b(),this.Owa.style.display=ic.a.kf,this.Shb.style.display=ic.a.kf};this.Dqk=()=>this.tA?
1===this.tA.length&&this.tA[0].$j&&!this.tA[0].get_isSVGBlipFilled():!1;this.eif=()=>{this.JYd(this.wb);this.MI&&this.MI.uQ(this,this.Mb,ResourceStrings.L_ShapeAltTextNew,dd.a.Tma)};this.$4d=()=>{0!==this.eld&&(window.clearTimeout(this.eld),this.eld=0)};this.A5b=()=>{0!==this.Cdd&&(window.clearTimeout(this.Cdd),this.Cdd=0)};this.pNf=()=>{var df=Date.now();const bg=this.Owa.style.display===ic.a.kl;bg&&(this.I1.checked=!1,this.Owa.style.display=ic.a.kf,this.waa.style.display=ic.a.kl,this.oxa.style.display=
ic.a.kf,""!==this.xaa.innerText&&(this.xaa.innerText=""),this.A5b(),this.FCh());this.$4d();this.eld=window.setTimeout(()=>{this.vxc()},500);if(!this.RTg){df=Date.now()-df;const ih=new B.a;ih.name="ApproveImplicitly";ih.int64=bg?1:0;pb.d($a.a.Zem,!0,"AltTextPane",1,12,df,[ih]);this.RTg=!0}};this.xdm=()=>{this.Gyd();Jb.FocusManager.dr(this.vm)||Q.a.J(509092104,815,50,"Fail to set focus on close button")};this.QLh=()=>{this.Gyd();window.setTimeout(()=>{if(Jb.FocusManager.dr(this.$A))return this.$A.selectionStart=
0,this.$A.selectionEnd=0,!0;Q.a.J(509092103,815,50,"Fail to set focus on alt text box");return!1},0)};this.Gyd=()=>{this.Fa&&this.Fa.PF(dd.a.Tma)};this.Hxb=()=>{this.FO();return!0};this.FCh=()=>{const [df,bg]=Object(Rc.c)(this.$A.value);if(df){const ih=this.$A.selectionStart,He=this.$A.selectionEnd;this.$A.value=this.$A.value.substring(0,bg).trimEnd();this.$A.setSelectionRange(ih,He)}};this.Q0d=(df,bg)=>{var ih=Date.now();const He=!this.MUg;(this.I1.checked=He)?(this.cbd=this.$A.value,this.FCh()):
this.$A.value=this.cbd;this.vxc();bg&&(bg=Date.now()-ih,ih=new B.a,ih.name="CustomData1",ih.int64=He?1:0,pb.d($a.a.BPc,!0,"AltTextPane",df,12,bg,[ih]))};this.lPf=df=>{df.hc.preventDefault();df.hc.stopPropagation();this.Q0d(2,!0);window.setTimeout(()=>{this.I1.checked=this.MUg},0);return!0};this.mPf=df=>df.hc.keyCode===da.a.Mp||df.hc.keyCode===da.a.fO?(df.hc.preventDefault(),df.hc.stopPropagation(),this.Q0d(1,!0),!0):!1;this.dgh=df=>{var bg=Date.now();const ih=!this.NZa;this.iZ.indeterminate=!1;this.iZ.checked=
ih;this.waa.disabled=ih;this.Owa.style.display=ic.a.kf;(this.$A.disabled=ih)?(this.cbd=this.$A.value,this.$A.value=ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative):this.$A.value=this.cbd;this.vxc();bg=Date.now()-bg;const He=new B.a;He.name="CustomData1";He.int64=ih?1:0;pb.d($a.a.IQe,!0,"AltTextPane",df,12,bg,[He])};this.bgh=df=>{console.log("[markAsDecorativeClickHandler]",this.iZ.checked);df.hc.preventDefault();df.hc.stopPropagation();this.dgh(2);window.setTimeout(()=>{this.iZ.checked=
this.NZa},0);return!0};this.cgh=df=>{console.log("[markAsDecorativeKeyDownHandler]",this.iZ.checked);return df.hc.keyCode===da.a.Mp||df.hc.keyCode===da.a.fO?(df.hc.preventDefault(),df.hc.stopPropagation(),this.dgh(1),!0):!1};this.FO=()=>{if(this.Mb){var df=Date.now();this.G4d();Q.a.J(509092102,815,50,"ImageDescriptionPaneNew.closePane - Image Description pane close button clicked.");df=Date.now()-df;const bg=new B.a;bg.name="CustomData1";bg.int64=0;pb.d($a.a.aPc,!0,"AltTextPane",0,12,df,[bg])}};this.kfg=
()=>{this.C$b();return!0};this.C$b=()=>{var df=Date.now();const bg=this.tA[0]?this.tA[0].sc(0):void 0;this.Qi&&bg?(this.waa.style.display=ic.a.kf,this.oxa.style.display=ic.a.q3,this.xaa.innerText=ResourceStrings.L_ImageDescriptionPaneInProgress,this.A5b(),this.Cdd=window.setTimeout(()=>{this.oxa.style.display=ic.a.kf;""!==this.xaa.innerText&&(this.xaa.innerText="");pb.a("GeneratingAltTextMessageTimeout")},15E3),this.xdm(),this.lIe.add(this.tA[0].id.toString(),this.tA[0].mg),this.Qi.generateImageDescription(this.tA[0].id,
bg.lbf,this.tA[0].get_isSVGBlipFilled(),!0),df=Date.now()-df,pb.d($a.a.csj,!0,"AltTextPane",0,12,df)):Q.a.J(509092101,815,15,"ImageDescriptionPaneNew.generateDescriptionForMe - Is shape node null or undefined {0}",!this.tA[0])};this.Ngm=df=>{df=df.rf();this.cbd="";this.vxc();this.tA=df;this.RTg=this.I1.checked=!1;this.N4c()};this.onSelectionChange=df=>{this.Ngm(df);this.ih&&this.ih.zp(dd.a.Tma)};this.JYd=df=>{w.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(df,"ImageDescriptionPaneRTL"):
Sys.UI.DomElement.addCssClass(df,"ImageDescriptionPaneLTR")};this.vxc=()=>{this.$4d();if(this.tA&&0!==this.tA.length){var df=this.iZ.checked,bg=df?"":this.$A.value;if(bg!==this.qIe||df!==this.NZa){var ih=this.Eb.xe(15);if(ih){ih.mc(this.gb.Pk());if(df)for(const He of this.tA)He.V3a=!1,He.KM=!0;else for(const He of this.tA)He.V3a=!1,He.set_alt(bg),He.set_altTitle("");ih.dispose()}this.NZa=df;this.qIe=bg;this.nv&&this.nv.CB()}}};this.EHh=df=>df.hc.keyCode===da.a.E_||df.hc.keyCode===da.a.GBa?(df.hc.preventDefault(),
df.hc.stopPropagation(),this.Fa.Gd(),!0):!1;this.P$e=df=>{const bg=this.Mb;df?bg?(this.eif(),this.QLh()):this.L9j():bg&&this.G4d();df!==bg&&(this.nv&&this.nv.CB(),this.b6&&this.b6.CB());Q.a.J(509092099,815,50,"ImageDescrptionPaneNew.showHideAltTextPaneInternal {0} to {1}",bg,df)};this.L9j=()=>{this.Fa&&this.Fa.qk(dd.a.Tma,!0);this.tA=this.gb.rf();this.N4c();this.Mb=!0;this.wb.appendChild(this.Jga);this.wb.style.display=ic.a.kl;this.eif();this.gb.AG(this.onSelectionChange);Q.a.J(509092098,815,50,"ImageDescriptionPaneNew.initializeAndShowAltTextPane");
if(this.Olc){try{var df=this.Olc.value}catch(bg){Q.a.J(509092096,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab: {0}",bg.toString());return}if(df){df.nb($a.a.gNc,1);df=!1;try{this.nv.selectRibbonTabById("AccessibleAuthoring"),df=!0}catch(bg){Q.a.J(509092066,822,10,"ImageDescriptionPaneNew: can't select ribbon tab AccessibleAuthoring: {0}",bg.toString())}pb.a("AccessibleAuthoringTab",df);this.QLh()}else Q.a.J(509092067,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else Q.a.J(509092097,
822,10,"ImageDescriptionPaneNew: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab"),id.a("UpdateAltTextState")&&this.z1h()};this.G4d=()=>{this.Mb&&(this.Fa&&this.Fa.qk(dd.a.Tma,!1),this.gb.Xza(this.onSelectionChange),this.vxc(),this.Mb=!1,this.wb.removeChild(this.Jga),this.wb.style.display=ic.a.kf,this.eif(),Q.a.J(509092100,815,50,"ImageDescriptionPaneNew.cleanUpAndHideAltTextPane"),id.a("UpdateAltTextState")&&this.z1h())};this.dispose=()=>{this.G4d();this.rS&&this.rS.Hb(Ha.a.Vf,
this.wb,this.EHh);this.hd.Hb(Ha.a.click,this.vm,this.Hxb);this.lhb.removeHandler(this.$A,Ha.a.input,this.pNf);this.hd.Hb(Ha.a.click,this.waa,this.kfg);this.hd.Hb(Ha.a.click,this.XYa,this.lPf);this.rS&&this.rS.Hb(Ha.a.Vf,this.I1,this.mPf);this.hd.Hb(Ha.a.click,this.w_a,this.bgh);this.rS&&this.rS.Hb(Ha.a.Vf,this.iZ,this.cgh);this.Qs&&this.Qs.tn(this.ph);this.Xlc=this.iLe=this.iZ=this.w_a=this.Shb=this.cic=this.RBe=this.I1=this.XYa=this.Owa=this.oxa=this.xaa=this.waa=this.$A=this.kIe=this.ded=this.eed=
this.vm=this.ukc=this.tkc=this.Jga=this.wb=void 0;this.$4d();this.A5b();Q.a.J(509092065,815,50,"ImageDescriptionPaneNew.dispose")};this.layout=(df,bg)=>{const ih=bg?df.nL(this.width):df.oL(this.width);this.Mb&&(bg?(Sys.UI.DomElement.addCssClass(this.wb,"ImageDescriptionPaneRTL"),ih.nL(1)):(Sys.UI.DomElement.addCssClass(this.wb,"ImageDescriptionPaneLTR"),ih.oL(1)));ub.a.jca(this.wb,ih);return df};this.Ogm=df=>{this.bKe&&df===this.tA[0]&&this.Mb&&(this.lIe.Ib(df.id.toString())&&this.tA[0].mg!==this.lIe.ga(df.id.toString())&&
Q.a.J(509092064,815,50,"ImageDescriptionPaneNew.updateAltTextbox - Image version have been changed after generate description"),this.N4c())};this.t0l=()=>{this.P$e(!this.Mb)};this.lFi=()=>{this.P$e(!0);this.I1.checked||this.Q0d(0,!1)};this.D7f=()=>{this.P$e(!0)};if(!S)throw Error.argumentNull("frameContext");if(!Ja)throw Error.argumentNull("clickInputManager");if(!wb)throw Error.argumentNull("selectionManager");if(!Sb)throw Error.argumentNull("focusManagerHelper");if(!vc)throw Error.argumentNull("inputHandlerManager");
if(!gd)throw Error.argumentNull("transactionFactory");this.ih=v;this.Db=S;this.Fa=od;this.Qi=ma;this.hd=Ja;this.rS=Va;this.gb=wb;this.YG=Sb;this.lhb=vc;this.Eb=gd;this.MI=Vd;this.Olc=Ke;this.nv=kg;this.b6=If;this.Qs=yh;this.wb=ub.a.we();this.wb.className="ImageDescriptionPaneNew";this.wb.id="ImageDescriptionPaneNew";this.wb.style.position=ic.a.Iia;this.wb.setAttribute(na.a.Ff,na.a.mEa);this.wb.setAttribute(na.a.E4,"ImageDescriptionPaneLabel");this.rS&&this.rS.xb(Ha.a.Vf,this.wb,this.EHh);this.Jga=
ub.a.we();this.Jga.className="ImageDescriptionPaneLayoutRootNew";this.tkc=ub.a.we();this.tkc.className="ImageDescriptionPaneHeader";this.Jga.appendChild(this.tkc);this.ukc=ub.a.we();this.ukc.id="ImageDescriptionPaneLabel";this.ukc.className="ImageDescriptionPaneTitle";this.ukc.innerText=ResourceStrings.L_ShapeAltTextNew;this.tkc.appendChild(this.ukc);this.vm=document.createElement(ub.a.k$a);this.vm.type="button";this.vm.setAttribute(na.a.Rp,CommonUIStrings.l_DialogClose);this.vm.appendChild(Object(Rc.b)(Rc.a,
20,20).va);this.vm.className="ImageDescriptionPaneCloseButtonNew";id.a("SvgCloseButton")&&(this.vm.className+=" SvgCloseButton");this.tkc.appendChild(this.vm);this.hd.xb(Ha.a.click,this.vm,this.Hxb);this.eed=ub.a.we();this.eed.innerText=ResourceStrings.L_ImageDescriptionPaneLabelRefresh;this.eed.className="ImageDescriptionLabelNew";this.Jga.appendChild(this.eed);this.ded=ub.a.we();this.ded.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.ded.className="ImageDescriptionHintNew";this.Jga.appendChild(this.ded);
this.kIe=ub.a.we();this.$A=document.createElement(ub.a.L9l);this.$A.className="AltTextTextAreaNew";this.$A.setAttribute(na.a.Rp,ResourceStrings.L_ShapeAltTextNew);this.kIe.appendChild(this.$A);this.Jga.appendChild(this.kIe);this.lhb.addHandler(this.$A,Ha.a.input,this.pNf);v=ub.a.En();v.className="GenerateDescriptionButtonText";v.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltipNew;this.waa=document.createElement(ub.a.k$a);this.waa.type="button";this.waa.className="ImageDescriptionPaneGenerateButtonNew";
this.waa.appendChild(v);this.Jga.appendChild(this.waa);this.hd.xb(Ha.a.click,this.waa,this.kfg);v=Object(Rc.b)("M1039.84,0.126321c261.41,4.108,517.2,108.271,709.24,300.861c292.63,293.471,379.52,734.393,220.11,1116.953c-154.43,370.6,-510.5,615.63,-909.38,629.51l-34.61,0.55l-16.1,-0.67c-72.623,-7.38,-129.295,-68.71,-129.295,-143.29c0,-74.57,56.672,-135.9,129.295,-143.28l12.8,-0.64c0,-0.07,0,-0.13,0,-0.19c297.81,0.84,566.77,-177.91,681.33,-452.82c114.55,-274.92,52.11,-591.774,-158.18,-802.668c-210.29,-210.893,-526.96,-274.235,-802.182,-160.458c-275.227,113.778,-454.739,382.239,-454.739,680.066l-288.129,0c0,-414.442,249.801,-788.021,632.795,-946.349c131.654,-54.426,270.122,-79.727,407.045,-77.575z",
16,16).va;this.xaa=ub.a.En();this.xaa.setAttribute(na.a.Ff,na.a.HPf);this.xaa.setAttribute(na.a.FPc,na.a.h1d);this.oxa=ub.a.we();this.oxa.className="ImageDescriptionPaneGeneratingMessage";this.oxa.appendChild(v);this.oxa.appendChild(this.xaa);this.Jga.appendChild(this.oxa);this.Owa=ub.a.we();this.Owa.className="ImageDescriptionCheckboxContainer";this.XYa=document.createElement(ub.a.MHg);this.XYa.setAttribute("for","ImageDescriptionCheckboxApprove");this.XYa.innerText=ResourceStrings.L_ApproveAltText;
this.Owa.appendChild(this.XYa);this.I1=ub.a.MTc();this.I1.setAttribute("type","checkbox");this.I1.setAttribute(na.a.iea,"ImageDescriptionTipApprove");this.I1.id="ImageDescriptionCheckboxApprove";this.XYa.appendChild(this.I1);this.RBe=ub.a.En();this.RBe.className="checkmark";this.XYa.appendChild(this.RBe);this.cic=ub.a.we();this.cic.className="ImageDescriptionInlineTip";this.cic.innerText=ResourceStrings.L_ApproveAltTextTip;this.cic.id="ImageDescriptionTipApprove";this.Owa.appendChild(this.cic);this.Jga.appendChild(this.Owa);
this.hd.xb(Ha.a.click,this.XYa,this.lPf);this.rS&&this.rS.xb(Ha.a.Vf,this.I1,this.mPf);this.Shb=ub.a.we();this.Shb.className="ImageDescriptionCheckboxContainer";this.w_a=document.createElement(ub.a.MHg);this.w_a.setAttribute("for","ImageDescriptionCheckboxDecorative");this.w_a.innerText=ResourceStrings.L_MarkAsDecorative;this.Shb.appendChild(this.w_a);this.iZ=ub.a.MTc();this.iZ.setAttribute("type","checkbox");this.iZ.setAttribute(na.a.iea,"ImageDescriptionTipDecorative");this.iZ.id="ImageDescriptionCheckboxDecorative";
this.w_a.appendChild(this.iZ);this.iLe=ub.a.En();this.iLe.className="checkmark";this.w_a.appendChild(this.iLe);this.Xlc=ub.a.we();this.Xlc.className="ImageDescriptionInlineTip";this.Xlc.innerText=ResourceStrings.L_MarkAsDecorativeTip;this.Xlc.id="ImageDescriptionTipDecorative";this.Shb.appendChild(this.Xlc);this.Jga.appendChild(this.Shb);this.hd.xb(Ha.a.click,this.w_a,this.bgh);this.rS&&this.rS.xb(Ha.a.Vf,this.iZ,this.cgh);this.YG.Lfa(dd.a.Tma,dd.a.Nj,this.wb,()=>{},()=>{},!0);this.Qs&&this.Qs.Ak(this.ph);
this.Cdd=this.eld=0}z1h(){this.Db.OB({AlternativeText:"ToggleButtonModel"})}get width(){return this.Mb?264+Yc.a.kNa:0}get va(){return this.wb}get order(){return 10}get isVisible(){return this.Mb}}Object(k.a)(Cc,"ImageDescriptionPaneNew",null,[1524,180,106]);var Nb=d(342);class nc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ImageDescription"}fc(v){this.K=v;this.K.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().na(()=>
new Nb.a(S=>{let ma=null;const Ja=Object(N.a)(178,S.sc(v.resolve("Box4.IPageView").Na));Ja&&!Ja.hm&&(ma=new Fb(S,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")),ma.Cn(Ja.oW),Ja.vta(ma,4));return ma}));this.K.register(1524,"PowerPointWebEditor.IImageDescriptionPane").ma().na(()=>
new Cc(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.K.ze("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IContextMenuUser"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10)));this.K.register(ac,"PowerPointWebEditor.ImageDescriptionManager").ma().na(()=>new ac(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Ac(Db.a(new nc,
0))}}Object(k.a)(nc,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var Kc=d(83),xd=d(75);class Xc extends xd.a{constructor(){super()}static instance(){return Xc.Ja||(Xc.Ja=new Xc)}}Xc.J$k="OnTextSelectionHighlightChangeEvent";Xc.Ja=null;Object(k.a)(Xc,"TextSelectionHighlightChangeEvent",xd.a,[]);class Tb extends Kc.a{constructor(v,S){super(!1,!1,!0);this.cHl=(ma,Ja)=>{1===ma&&(this.x5a.Eoe=Ja.tooltipPersistenceEnabled,w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",
!1)&&(ma=Ja.textSelectionChangeEnabled,this.x5a.xAc!==ma&&this.cqi.raiseEvent(Xc.J$k),this.x5a.xAc=ma))};this.x5a=v;this.cqi=S}start(){const v={["tooltipPersistenceEnabled"]:this.x5a.Eoe};w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(v.textSelectionChangeEnabled=this.x5a.xAc);this.Vj("",this.cHl,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:v})}}Object(k.a)(Tb,"AccessibilitySettingsDialog",Kc.a,[]);class he{constructor(v,
S){this.f_l=()=>{(new Tb(this.x5a,Xc.instance())).start();return 32};this.Ca=v;this.x5a=S}qb(){this.Ca.xa(F.a.e_l,E.a.frame,this.f_l)}}Object(k.a)(he,"AccessibilitySettingsDialogActor",null,[1584]);var re=d(1104);const ee=v=>{const S=new re.a;w.AFrameworkApplication.Me.Tj(ke(v),1,null,null,!0,2,ma=>{200===ma.data.Ke?S.Jg("true"===ma.data.Ud.toLowerCase()):S.Jg(!1)},()=>{S.Jg(!1)},null,void 0,void 0,void 0,void 0,"7");return S.task},Yf=(v,S)=>{w.AFrameworkApplication.Me.Tj(ke(v),2,S.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},ke=v=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",w.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",v,w.AFrameworkApplication.mh);var ef=d(65);class yf{constructor(){this.Lub=this.rsb=null}get Eoe(){return!!this.rsb}set Eoe(v){v!==this.rsb&&(this.rsb=v,ef.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(v),this.D8c()&&Yf("saveHoverableRibbonTooltipIsEnabled",v))}get xAc(){return!!this.Lub}set xAc(v){v!==
this.Lub&&(this.Lub=v,this.D8c()&&Yf("saveTextSelectionHighlightChangeIsEnabled",v))}Dxk(){const v=new re.a;if(this.rsb)v.Jg(this.rsb);else if(this.D8c()){const S=ee("getHoverableRibbonTooltipIsEnabled");S.continueWith(()=>{this.rsb=S.result;ef.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(S.result);v.Jg(S.result)},8)}else v.Jg(!1)}iyk(){const v=new re.a;if(this.Lub)v.Jg(this.Lub);else if(this.D8c()){const S=ee("getTextSelectionHighlightChangeIsEnabled");S.continueWith(()=>
{this.Lub=S.result;v.Jg(S.result)},8)}else v.Jg(!1)}D8c(){const v=w.AFrameworkApplication.fa.getBooleanAppSetting("IsRoamingServiceEnabled"),S=w.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser");return v&&!S}}Object(k.a)(yf,"AccessibilitySettingsInfo",null,[1579]);class Rf{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}fc(v){this.Da=v;this.Da.register(yf,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").na(()=>
new yf).ma();this.Da.register(he,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").na(()=>new he(w.AFrameworkApplication.Pa,this.Da.ub("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const v=this.Da.ub("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),S=this.Da.ub("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");v&&S?(S.qb(),v.Dxk(),v.iyk(),K.c(508827098,
200,50,"Text Selection Highlight Change Setting value on boot: {0}",v.xAc)):K.c(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Ac(new Rf)}}Object(k.a)(Rf,"AccessibilitySettingsPackage",null,[2,3]);var Za=d(94),Kb=d(225),Ic=d(1175),Hc=d(74),jd=d(728);class Id extends Ya.StandardDialog{constructor(v,S,ma,Ja=null){super();this.n4=this.nt=this.gQa=null;this.ix=[];this.MVe=
Va=>{this.nt&&(this.nt.target="_blank",this.nt.submit());Va.preventDefault()};this.b7f=()=>{n.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};this.Wkl=()=>{n.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.yub&&this.yub.stop()};this.JJc=S;this.SQ=v;this.rfi=ma;this.hLc=Ja;this.yub=new jd.a("LoadResource","LoadPrintablePdf")}Rla(){this.Fd=5;this.width=40;const v=document.createElement("span");v.id=this.ki("DirectPrintHeaderContent");
const S=document.createElement("span");S.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(S,"DirectPrintHeader");this.n4=document.createElement("iframe");this.n4.name="pdfObjectFrame";this.n4.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.n4.onload=this.Wkl;if(this.hLc&&0<this.hLc.count){var ma=Hc.a.Cje(this.JJc,this.hLc);const Ja=Hc.a.V2e(this.JJc,this.hLc);this.nt=document.createElement("form");this.nt.id="printPreviewPostForm";this.nt.method="POST";this.nt.target=
this.n4.name;this.nt.action=Ja;for(const Va of ma)ma=document.createElement("input"),ma.type="hidden",ma.name=Va.key,ma.value=Va.value,this.nt.appendChild(ma)}else this.n4.setAttribute("src",this.JJc);Sys.UI.DomElement.addCssClass(this.n4,Kb.a.ZAf);this.rfi?(Sys.UI.DomElement.addCssClass(this.n4,"DirectPrintPdfObjectHidden"),S.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,na.a.bT(this.n4,na.a.JJ,na.a.cC)):(Sys.UI.DomElement.addCssClass(this.n4,"DirectPrintPdfObject"),this.ix.push(this.n4));
v.appendChild(S);v.appendChild(document.createElement("br"));v.appendChild(this.n4);this.nt&&v.appendChild(this.nt);v.appendChild(document.createElement("br"));v.appendChild(this.FZi(this.nt?"#":this.JJc));this.yub.start();this.Opc(CommonUIStrings.l_AppTitle,null,null,null,null,v);this.M7(this.ki("DirectPrintHeaderContent"));this.nt&&this.nt.submit();this.p3i();n.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}FZi(v){const S=document.createElement("span");var ma=document.createElement("span");
ma.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;S.appendChild(ma);w.AFrameworkApplication.fa&&(2===w.AFrameworkApplication.za.mb.Ej&&w.AFrameworkApplication.fa.getBooleanAppSetting("PPTDisableDirectPrintDialogDownloadPDFLink")||1===w.AFrameworkApplication.za.mb.Ej&&w.AFrameworkApplication.fa.getBooleanAppSetting("XLODisableDirectPrintDialogOpenPDFLink"))?(v=document.createElement("span"),2===w.AFrameworkApplication.za.mb.Ej?v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:
1===w.AFrameworkApplication.za.mb.Ej&&(v.innerText=CommonUIStrings.l_InternalError_Directive,n.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.gQa=v,S.appendChild(document.createElement("br")),S.appendChild(v)):(ma=document.createElement("a"),ma.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,ma.href=v,ma.target="_blank",ma.id="PrintPDFLink",ma.className="AllowBrowserClick",this.gQa=ma,S.appendChild(document.createElement("br")),S.appendChild(ma),
this.nt&&Za.a.addHandler(ma,"click",this.MVe),this.SQ.xb(Ha.a.click,this.gQa,this.b7f,null));this.ix.push(this.gQa);return S}p3i(){if(0<this.ix.length){const v=new Ic.a(this.ix),S=Jb.FocusManager.instance().gm();S&&(this.gQa.focus(),S.jk=v,S.IY=!0)}}Lfb(){n.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.gQa&&(this.SQ.Hb(Ha.a.click,this.gQa,this.b7f),this.gQa=null);la.a.oQ(this.n4);this.n4=null;super.dispose()}}Object(k.a)(Id,"DirectPrintDialog",
Ya.StandardDialog,[1689]);class ze{constructor(v){this.SQ=v}Lzj(v,S){return new Id(this.SQ,v,S,null)}}Object(k.a)(ze,"DirectPrintDialogFactory",null,[1677]);var Ie=d(1265),Cd=d(64);class ue{constructor(v,S){this._url=v;this.uki=S}G6f(){this.uki?Cd.a.gej(this._url):Cd.a.qo(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(k.a)(ue,"OpenUrlInTabDialogDownloadBehavior",null,[478,106]);var Ee=d(55);class Xe extends Ya.StandardDialog{constructor(v,S=!0,ma=!1,
Ja=null,Va=null,wb=!1,Sb=null){super();this.isb=this.hsb=this.nt=this.vda=null;this.a2k=Ke=>{this.z$f(Ke);return!0};this.b2k=Ke=>this.L9c(Ke,this.z$f);this.z$f=Ke=>{this.nt&&this.nt.submit();this.cbb(Ke.Ec)};this.Y4=Ke=>{1===Ke?(this.Lfb(),this.nt?Xe.F3&&this.oAh():this.PKd.G6f()):2===Ke&&(this.B6c?this.N_f():this.ABg&&this.Lfj());this.dispose()};var vc=this.Hef?this.Hef:CommonUIStrings.l_DefaultDialogTitle;Xe.BCb=wb;this.Vai=Sb;this.PKd=Ja||new ue(v,!0);const gd=[],od=[];Xe.F3&&(this.MOc&&this.MOc.forEach(Ke=>
{Array.add(gd,Ke)}),this.DMf&&this.DMf.forEach(Ke=>{Array.add(od,Ke)}));S?ma?this.B6c?(this.Fd=12,this.Te(1,this.buttonText),this.Te(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.Te(3,CommonUIStrings.l_DialogClose)):this.ABg?(this.Fd=12,this.Te(1,this.buttonText),this.Te(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Te(3,CommonUIStrings.l_DialogClose)):(this.Fd=4,this.Te(1,this.buttonText),this.Te(2,CommonUIStrings.l_DialogClose)):(this.Fd=6,this.Te(0,CommonUIStrings.l_DialogClose)):
this.Fd=5;wb=document.createElement("span");this.g7b&&(wb.className=this.g7b);Ja=document.createElement("a");Ja.innerText=this.EFb;Ja.href=v;Ja.target="_blank";Ja.id=this.dhc;Ja.className=Ua.AFrame.kNf;if(Sb=!Ee.a.gV&&!!Va&&0<Va.count){const Ke=Hc.a.Cje(v,Va);Va=Hc.a.V2e(v,Va);Ja.href="#";Ja.target="_self";this.nt=document.createElement("form");this.nt.id="printPreviewPostForm1";this.nt.method="post";this.nt.target="_blank";this.nt.action=Va;for(var Vd of Ke)Va=document.createElement("input"),Va.type=
"hidden",Va.name=Vd.key,Va.value=Vd.value,this.nt.appendChild(Va)}else this.nt=null;this.nt||Xe.BCb?Xe.BCb||Array.add(od,{["type"]:"AppLinkProps",["id"]:this.dhc,["text"]:this.EFb,["onExecute"]:()=>{this.oAh()}}):Array.add(od,{["type"]:"AppLinkProps",["id"]:this.dhc,["text"]:this.EFb,["handler"]:{["href"]:Sb?"#":v,["target"]:Sb?"_self":"_blank"}});this.spa&&Array.add(gd,this.spa);ma?(v=document.createElement("span"),v.innerText=this.spa.replace("{0}",""),wb.appendChild(v)):this.lhh?(v=document.createElement("span"),
v.id=this.ki("message"),Vd=document.createElement("span"),Va=document.createElement("span"),Sb=this.spa.split("{0}"),Vd.innerText=Sb[0],Va.innerText=Sb[1],v.appendChild(Vd),v.appendChild(Ja),v.appendChild(Va),wb.appendChild(v)):(v=document.createElement("span"),v.innerText=this.spa,wb.appendChild(v),wb.appendChild(document.createElement("br")),wb.appendChild(document.createElement("br")),wb.appendChild(Ja),Xe.BCb||Array.add(gd,"{0}"));this.nt&&wb.appendChild(this.nt);Xe.F3&&(this.zYa&&(this.ahc?this.UJf(this.zYa,
this.ahc):(Array.add(gd,"{0}"),Array.add(od,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.zYa,["onExecute"]:()=>{this.n$c()}}))),this.wNc(gd,od));this.Opc(vc,null,this.Joe,null,this.Y4,Xe.F3?null:wb);this.M7(this.ki("message"));!Xe.F3&&this.ahc&&this.zYa&&(vc=document.createElement("div"),vc.className="WACDialogLearnMoreLinkContainer",this.vda=document.createElement("a"),this.vda.innerText=this.zYa,this.vda.href=this.ahc,this.vda.target="_blank",this.vda.id=this.ki("LearnMoreLinkId"),
this.vda.className=Ua.AFrame.kNf,vc.appendChild(this.vda),S?this.Nb.insertBefore(vc,this.Nb.lastChild):this.Nb.appendChild(vc),this.M7(String.format("{0} {1}",this.ki("message"),this.ki("LearnMoreLinkId"))));this.$Wb=Ja;ma?this.eT(this.HE):this.eT(this.$Wb);this.PFb();w.AFrameworkApplication.za.sT.xb(Ha.a.click,this.$Wb,Object(r.a)(this,this.a7f,"downloadLinkClicked"),null);this.vda&&w.AFrameworkApplication.za.sT.xb(Ha.a.click,this.vda,Object(r.a)(this,this.n$c,"learnMoreLinkClicked"),null);this.mrf=
!1}get Joe(){return null}get Hef(){return null}get spa(){return null}get oPi(){return this.Vai}get ahc(){return null}get zYa(){return null}get lhh(){return!1}get buttonText(){return CommonUIStrings.l_Open}get g7b(){return null}get MOc(){return null}get DMf(){return null}get B6c(){return!1}get ABg(){return!1}N_f(){this.bfa({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}Lfj(){this.bfa({SourceControlId:"Share"},{ControlId:"Share"})}bfa(v,S){const ma=w.AFrameworkApplication.Pa;ma.oq=8;ma.Ia(F.a.bfa,
2,v,S)}C9(){this.nt&&(this.hsb||(this.hsb=this.a2k,this.to.xb(Ha.a.click,this.HE,this.hsb)),this.isb||(this.isb=this.b2k,this.lh.xb(Ha.a.rm,this.HE,this.isb)));super.C9()}Lfb(){}a7f(){this.thc();this.nt?this.nt.submit():this.PKd.G6f();return!0}n$c(){return!1}dispose(){this.PKd.dispose();this.$Wb&&(w.AFrameworkApplication.za.sT.Hb(Ha.a.click,this.$Wb,Object(r.a)(this,this.a7f,"downloadLinkClicked")),this.$Wb=null);this.vda&&(w.AFrameworkApplication.za.sT.Hb(Ha.a.click,this.vda,Object(r.a)(this,this.n$c,
"learnMoreLinkClicked")),this.vda=null);this.to&&this.hsb&&(this.to.Hb(Ha.a.click,this.HE,this.hsb),this.hsb=null);this.lh&&this.isb&&(this.lh.Hb(Ha.a.rm,this.HE,this.isb),this.isb=null);super.dispose()}oAh(){this.nt&&(document.body.appendChild(this.nt),this.nt.submit(),document.body.removeChild(this.nt))}static get F3(){return w.AFrameworkApplication.za.mb.SD&&w.AFrameworkApplication.za.mb.PEg}static get BCb(){return Xe.suf}static set BCb(v){Xe.suf=v}}Xe.suf=!1;Object(k.a)(Xe,"ADialogWithLinkToResource",
Ya.StandardDialog,[]);class Sd extends Xe{constructor(v,S,ma=null,Ja=!0,Va=!1,wb=null){super(v,!0,!(Sd.i5a&&Ja),new ue(v,S),ma,Va,wb);Sd.i5a=Sd.i5a&&Ja;if(Sd.i5a){S=document.createElement("iframe");Ja=null;Va=this.xbj;S.name="pdfObjectFrame";S.id="pdfObjectIFrame";if(ma&&0<ma.count){wb=Hc.a.Cje(v,ma);v=Hc.a.V2e(v,ma);Ja=document.createElement("form");Ja.id="printPreviewPostForm";Ja.method="POST";Ja.target=S.name;Ja.action=v;for(const Sb of wb)v=document.createElement("input"),v.type="hidden",v.name=
Sb.key,v.value=Sb.value,Ja.appendChild(v)}else S.src=v;Va.appendChild(S);Ja&&(Va.appendChild(Ja),Ja.submit());Sys.UI.DomElement.addCssClass(S,"DirectPrintPdfObjectHidden");na.a.bT(S,na.a.JJ,na.a.cC)}}get Joe(){return"Print_32x32x32"}get Hef(){return Sd.i5a?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get spa(){return Sd.i5a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get MOc(){const v=[];Array.add(v,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Xe.BCb){let S=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;
""!==w.AFrameworkApplication.za.mb.b3f&&(S=w.AFrameworkApplication.za.mb.b3f);Array.add(v,S)}return Sd.i5a?v:null}get EFb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get dhc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get g7b(){return w.AFrameworkApplication.tua?"UIFontDialogTextLarge":null}PFb(){n.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}thc(){w.AFrameworkApplication.fj.Qdb(9540,1);n.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Lfb(){n.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")}static get i5a(){return!!w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.SD&&w.AFrameworkApplication.fa.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Ee.a.gV||Ee.a.Gk||Ee.a.jg||Ee.a.JEb)&&!w.AFrameworkApplication.sgc&&w.AFrameworkApplication.fa.getBooleanAppSetting("ShouldHostDefaultToNativeBrowserPrintExperience")&&Sd.OHf}static set i5a(v){Sd.OHf=v}}Sd.OHf=!1;Object(k.a)(Sd,"PrintDialogWithLinkToPdf",Xe,[]);class ad{constructor(v){this.isEnabled=
Boolean.parse(v.DirectPrintIsEnabled||"false");this.sok=Boolean.parse(v.DirectPrintProbeIsEnabled||"false");this.Akk=Boolean.parse(v.DirectPrintEnabledForInternetExplorer||"false");this.Zob=(v.DirectPrintSupportedMimeTypes||"").split(ad.D$d);this.o4a=(v.DirectPrintSupportedPlugins||"").split(ad.D$d);this.B7j=(v.DirectPrintImmersivePreviewPlugins||"").split(ad.D$d);this.wBg=Boolean.parse(v.DirectPrintEnabledForEdge||"false");this.Nfk=Boolean.parse(v.ChromePrintLayoutFixIsEnabled||"false");this.dTi=
parseInt(v.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.lRe=14;this.nhh=14394;if(v=v.DirectPrintMinimalSupportedEdgeVersion){const S=v.split(".");2===S.length?(this.lRe=parseInt(S[0]),this.nhh=parseInt(S[1])):n.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",v)}else n.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}ad.D$d=",";Object(k.a)(ad,"DirectPrintBrsSettings",
null,[]);class af{constructor(v,S){this.Ecf=v;this.o4a=S}}Object(k.a)(af,"DirectPrintProbeResults",null,[]);var pf=d(197),xf=d(104);class gf{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od){this.RMc=null;this.XIj=()=>{var Vd=this.zOj();const Ke=this.vol(),kg={},If={};for(let yh=0;yh<this.nM.Zob.length;yh++)kg[this.nM.Zob[yh]]=Vd[yh];for(Vd=0;Vd<this.nM.o4a.length;Vd++)If[this.nM.o4a[Vd]]=Ke[Vd];return new af(kg,If)};this.Zci=v;this.j_b=S;this.nRd=ma;this.Igi=Ja;this.Ahi=Va;this.Z_b=new Ie.a(this.XIj);this.tKd=
wb;this.Gyf=gd;this.XVd=Sb;this.Bhi=vc;this.Rhi=od}get nM(){return this.Zci}start(){}jll(){this.nM.sok&&this.TCk()}uol(){const v=Array(this.nM.Zob.length);if(void 0!==this.j_b&&null!==this.j_b)for(let S=0;S<this.nM.Zob.length;S++)v[S]=this.nM.Zob[S]in this.j_b&&this.Igi(this.j_b[this.nM.Zob[S]]);return v}vol(){const v=Array(this.nM.o4a.length),S=!(void 0===this.nRd||null===this.nRd);for(let ma=0;ma<this.nM.o4a.length;ma++){const Ja=this.nM.o4a[ma];v[ma]=S&&Ja in this.nRd?!0:this.Ahi(Ja)}return v}zOj(){const v=
this.uol(),S=Array(v.length);for(let ma=0;ma<v.length;ma++)S[ma]=v[ma]?this.pkj(this.j_b[this.nM.Zob[ma]]):null;return S}pkj(v){if(void 0===v||null===v)return null;v=v.enabledPlugin;return void 0===v||null===v?null:v.name}TCk(){n.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.Z_b.value.Ecf,this.Z_b.value.o4a)}VZl(){return this.Rhi||!this.nM.isEnabled||w.AFrameworkApplication.sgc?!1:this.e7l()}WQh(){if(null!=this.RMc)return this.RMc;const v=gf.uBg(this.nM);return this.RMc=this.nM.wBg&&
v||this.Jfk()}Jfk(){return Ee.a.Fk&&this.nM.Nfk&&Ee.a.GRc>=this.nM.dTi?!0:!1}e7l(){if(!this.Bhi(this.nM))return!1;var v=xf.a.Ule(this.Z_b.value.Ecf);for(const S of v)if(void 0!==S&&null!==S)return!0;v=xf.a.Ule(this.Z_b.value.o4a);for(const S of v)if(S)return!0;return!1}g1j(){const v=xf.a.Ule(this.Z_b.value.Ecf);for(const S of v)if(pf.a.contains(this.nM.B7j,S))return!0;return!1}cSh(v){w.AFrameworkApplication.za&&w.AFrameworkApplication.fa.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")?
this.Gyf(v,null):this.VZl()?this.Gcj(v,this.g1j()&&!0):this.Gyf(v,null)}Gcj(v,S){const ma=this.XVd.lj("UserAction","OpenDirectPrintDialog");this.tKd.Lzj(v,S).Rla();ma.stop()}static lrk(v){try{return new ActiveXObject(v),!0}catch(S){n.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",v)}return!1}static aik(v){return void 0===v||null===v?!1:!(void 0===v.enabledPlugin||null===v.enabledPlugin)}static create(v){const S=new ad(w.AFrameworkApplication.fa.appSettings);let ma=
null;try{ma=window.navigator.mimeTypes}catch(od){n.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Ja=null;try{Ja=window.navigator.plugins}catch(od){n.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Va=gf.aik,wb=gf.lrk;v=v.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Sb=w.AFrameworkApplication.za.DW,vc=gf.nrk,gd=!!w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.SD&&!w.AFrameworkApplication.fa.getBooleanAppSetting("PrintDialogFallbackLinkEnabled");
return new gf(S,ma,Ja,Va,wb,v,Sb,vc,(od,Vd)=>new Sd(od,!1,Vd,!0,gd),w.AFrameworkApplication.isEmbedded)}static nrk(v){return Ee.a.Fk||Ee.a.Gk&&v.Akk||v.wBg&&gf.uBg(v)?!0:!1}static uBg(v){var S=Ee.a.AUa;if(S){var ma=S.split(".");if(2===ma.length)return S=parseInt(ma[0]),ma=parseInt(ma[1]),S>v.lRe||S===v.lRe&&ma>=v.nhh}return!1}}Object(k.a)(gf,"DirectPrintManager",null,[1578]);class me{constructor(){this.crf=this.Da=null}get name(){return"Common.App.DirectPrint"}fc(v){this.Da=v;v.register(ze,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().na(()=>
new ze(w.AFrameworkApplication.za.sT));v.register(1578,"Common.App.DirectPrint.IDirectPrintManager").ma().na(()=>gf.create(this.Da))}init(){this.crf=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.crf.start()}dispose(){}}Object(k.a)(me,"PackageManager",null,[2,3]);var ag=d(1181),de=d(301);class wa{constructor(v,S){this.rXb=null;this.bim=(ma,Ja,Va,wb,Sb)=>{if(1===Va)return 32;Sb[ag.a.Value]=this.rXb;Sb[de.a.labelText]=this.rXb;Sb[ag.a.Visible]=!0;return 32};this.Ca=v;this.La=S}qb(){(this.rXb=
this.La.Ea("StatusBarEnvironmentNameToUse"))&&""!==this.rXb&&this.Ca.pa(F.a.C_e,E.a.frame,this.bim,96)}}Object(k.a)(wa,"DisplayEnvironmentName",null,[]);class ta{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}fc(v){this.Da=v;this.Da.register(wa,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().na(()=>new wa(w.AFrameworkApplication.Pa,w.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").qb()}dispose(){}static main(){e.a.instance.Ac(new ta)}}
Object(k.a)(ta,"DisplayEnvironmentNamePackage",null,[2,3]);var Eb=d(176),qc=d(563);class Sc extends qc.a{constructor(v){super(v)}get iyb(){return!1}createElement(){const v=document.createElement("link");v.setAttribute("rel","stylesheet");v.setAttribute("type","text/css");v.setAttribute("href",this.uv);return v}JTc(){return null}Cvc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.VN.uv)}}Object(k.a)(Sc,"CssResource",qc.a,[]);var td=d(312),je=d(3);class Te{constructor(){this.WJc=
this.bGc=null}Axk(){this.bGc||(n.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.bGc=je.Task.WAA(Te.Jxk(),Te.pxk()),this.bGc.continueWith(v=>{n.ULS.sendTraceTag(21030599,324,10,"{0}",hc.a.mhe(v.Ni))},5));return this.bGc}Bxk(){if(!this.WJc)try{n.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.WJc=je.Task.WAA(Te.vbe(td.a.create(w.AFrameworkApplication.fa.Ea("DimeUrl"),null,null))),this.WJc.continueWith(v=>{n.ULS.sendTraceTag(39978391,
324,10,"{0}",hc.a.mhe(v.Ni))},5)}catch(v){n.ULS.sendTraceTag(594874951,324,10,"{0}",hc.a.mhe(v))}return this.WJc}static Jxk(){var v=Te.E2c("inproductmessaging.js");v=td.a.create(v,null,null);return Te.vbe(v)}static pxk(){var v=Te.E2c("inproductmessaging.css");v=new Sc(v);return Te.vbe(v)}static E2c(v){return Eb.a.Qxb(String.format("ipm/{0}",v))}static vbe(v){Od.a.bF(v);return v.rIa}}Object(k.a)(Te,"DependencyDownloader",null,[1600]);class Hd{}Hd.ccl="inProductMessagingOverlayDiv";Hd.fgl="PlayButtonImage";
Hd.dEl="ReplayButtonImage";Object(k.a)(Hd,"Constants",null,[]);class mg{constructor(){this.PFf=this.bAf=this.lof=!0;this.eEl=this.ggl=null;this.b_k=!1;this.locale=null;this.E0h={}}get autoPlay(){return this.lof}set autoPlay(v){this.lof=v}get Jhh(){return this.bAf}set Jhh(v){this.bAf=v}get URh(){return this.PFf}set URh(v){(this.PFf=v)&&this.nSl()}nSl(){this.gLf(Hd.fgl,this.ggl);this.gLf(Hd.dEl,this.eEl)}gLf(v,S){S&&(this.E0h[v]=S)}}Object(k.a)(mg,"FirstRunExperienceUISettings",null,[1599]);class fg{constructor(){this.completed=
this.xyl=!1}}Object(k.a)(fg,"FirstRunExperienceViewData",null,[1596]);var $e=d(181);class oj{constructor(v,S,ma){this.Moj=(Ja,Va,wb,Sb,vc)=>{2===wb&&this.WGc.Dvk(vc);return 32};this.Wbj=(Ja,Va,wb,Sb,vc)=>{2===wb&&this.WGc.Cvk(vc);return 32};this.J7j=(Ja,Va,wb)=>2===wb?this.WGc.MRe():32;this.I7j=(Ja,Va,wb)=>2===wb?this.WGc.ERe():32;this.Ca=v;this.oi=S;this.WGc=ma}qb(){this.Ca.pa(F.a.Noj,E.a.frame,this.Moj,64);this.Ca.xa(F.a.cdg,E.a.frame,this.J7j);this.Ca.xa(F.a.bdg,E.a.frame,this.I7j);this.Ca.xa(F.a.Vbj,
E.a.frame,this.Wbj);this.Ca.xa(F.a.rFh,E.a.frame,$e.ActionManager.uh);this.Ca.xa(F.a.yEl,E.a.frame,$e.ActionManager.uh);this.Ca.xa(F.a.zEl,E.a.frame,$e.ActionManager.uh);this.oi&&this.oi.Gf()}}Object(k.a)(oj,"InProductMessagingActor",null,[]);class Me{constructor(){this.pCh=this.H7=this.gXh=this.k$c=this.instance=null}}Object(k.a)(Me,"DimeExperienceUISettings",null,[]);var we=d(533);class Zc{constructor(v,S,ma,Ja,Va){this.eZc=!1;this.R7b=null;this.Ca=v;this.d9a=S;this.EKc=ma;this.kja=Ja;this.jja=
Va}u$j(v){ef.b("getHeaderApi")?v.isFeatureEnabled("MsoPremiumBadge",!0).then(S=>{const ma=v.isFreemiumUpsellEnabled();ma&&(appChrome.getHeaderApi().then(Ja=>{Ja.updatePremiumStatus(S,ma);return null}),v.OMa("MsoPremiumBadge",Ja=>{appChrome.getHeaderApi().then(Va=>{Va.updatePremiumStatus(Ja.isEnabled,ma);return null})}));return null}):n.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}Dvk(v){this.EKc.Axk().continueWith(()=>{this.d9a.$1l(v)})}Cvk(v){let S="gopremium",ma=null,Ja=()=>{};
v?(v.experience&&""!==Object(N.a)(String,v.experience)&&(S=Object(N.a)(String,v.experience)),v.onTaskComplete&&(Ja=v.onTaskComplete),v.campaignId&&""!==Object(N.a)(String,v.campaignId)&&(ma=Object(N.a)(String,v.campaignId))):n.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.mIg(S,Ja,ma)}mIg(v,S,ma=null){if(this.eZc&&this.R7b){const Ja={};Ja.experience=v||"gopremium";Ja.campaignId=ma||we.b(this.kja,this.jja,Object(N.a)(String,Ja.experience),!0);this.Ca.nb(F.a.rFh,
2);n.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Ja.experience);try{const Va=Object.assign(new Me,{instance:this.R7b,k$c:Ja,gXh:S||(()=>{}),H7:wb=>{n.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+wb.status)},pCh:()=>{n.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.eZc=!1;this.R7b=null}});this.d9a.o0l(Va)}catch(Va){n.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Va.message),this.eZc=!1,this.R7b=null,this.Ca.Ia(F.a.fZc,2,{["experience"]:Ja.experience})}}else n.ULS.sendTraceTag(39978392,
324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.Ia(F.a.fZc,2,{["experience"]:v})}Cxk(){this.EKc.Bxk().continueWith(()=>{try{var v=hc.a.Dg(w.AFrameworkApplication.uiCulture);const Ja=we.c(this.kja);if(Ja){var S={};S.partnerId=Ja;S.language=v;S.sessionId=w.AFrameworkApplication.userSessionId;S.authHint=w.AFrameworkApplication.fa.Ea("UserPrincipalName");var ma=w.AFrameworkApplication.fa.Ea("Puid")||"";""!==ma&&(v={},v.puid=ma,S.userInfo=v);this.R7b=new Dime(S);this.eZc=!0;n.ULS.sendTraceTag(592721856,
324,50,"Dime initialized")}else n.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Ja){n.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Ja.message)}},3)}MRe(){return this.d9a.MRe()}ERe(){return this.d9a.ERe()}}Object(k.a)(Zc,"InProductMessagingUIManager",null,[1587]);class te{constructor(){this.nHf=0;this.Zsb=Array(5);this.Zsb[0]=10;this.Zsb[1]=15;this.Zsb[2]=50;this.Zsb[3]=100;this.Zsb[4]=200}Init(v){this.nHf=v}SendTrace(v,S){n.ULS.sendTraceTag(34182235,this.nHf,
this.Zsb[v],"{0}",S)}}Object(k.a)(te,"DefaultNetworkingManager",null,[1630]);var ne=d(206);class Zf{constructor(v){this.Wd=v}$1l(v){v&&(InProductMessaging.Networking.NetworkingMgr=new te,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(v.URh,v.Jhh,v.autoPlay,v.b_k,v.locale,Object(r.a)(this,this.J4k,"onDismissFirstRunExperience"),v.E0h),this.N7(Hd.ccl,!0))}o0l(v){if(v&&v.instance&&v.k$c){let S=document.getElementById("wacDimeContainer");S||(S=document.createElement("div"),
S.id="wacDimeContainer",document.body.appendChild(S));w.AFrameworkApplication.fa.getBooleanAppSetting("DimeFocusManagerIsEnabled")&&this.N7("wacDimeContainer",!1);v.k$c.parentElementId="wacDimeContainer";v.instance.launch(v.k$c,v.gXh).then(ma=>{this.sqa();document.body.removeChild(S);v.H7(ma)}).catch(ma=>{this.sqa();document.body.removeChild(S);v.pCh(ma)})}else throw Error.argument("DimeExperienceUISettings");}N7(v,S){if(this.Wd&&v&&(v=document.getElementById(v),this.k$j(v),v=this.Wd.DR("InProductMessagingFocusId"))){const ma=
this.Wd.Je;ma&&"InProductMessagingFocusId"===ma.name||this.Wd.dW("InProductMessagingFocusId",!1);S&&this.E1e(v.scope)}}k$j(v){var S=this.Wd.Kc("InProductMessagingFocusId");S.parent=Ua.AFrame.vD;const ma=new ne.DOMFocusListing(()=>v);ma.wmb=!1;ma.xp(3);ma.xp(2);ma.xp(4);S=this.Wd.hla(()=>v,S,ma);S.xmb();S.IY=!0;S.HTa=!0}E1e(v){v.Sy(Jb.FocusManager.instance().ata);v.Sy(Jb.FocusManager.instance().bta);v.bindAction(Jb.FocusManager.instance().ata,F.a.cdg);v.bindAction(Jb.FocusManager.instance().bta,F.a.bdg)}sqa(){this.Wd&&
(this.Wd.P2("InProductMessagingFocusId"),this.Wd.rPb("InProductMessagingFocusId"))}J4k(v,S){this.sqa();v=Object.assign(new fg,{completed:v,xyl:S});w.AFrameworkApplication.Pa.Ia(F.a.Loj,2,v)}MRe(){const v=document.activeElement,S=this.Wd.gm();return v&&S&&S.jk&&v===S.jk.sFb?(S.jk.bG(v),S.sLb()?32:8):4}ERe(){const v=document.activeElement,S=this.Wd.gm();return v&&S&&S.jk&&v===S.jk.gma?(S.jk.bG(v),S.qLb()?32:8):4}}Object(k.a)(Zf,"InProductMessagingUIWrapper",null,[1586]);class cd{constructor(){this.Da=
null}get name(){return"Common.App.InProductMessaging"}fc(v){v.register(Te,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().na(()=>new Te);v.register(Zf,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().na(()=>new Zf(Jb.FocusManager.instance()));v.register(Zc,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().na(()=>new Zc(w.AFrameworkApplication.Pa,
v.resolve("Common.IInProductMessagingUIWrapper"),v.resolve("Common.App.InProductMessaging.IDependencyDownloader"),w.AFrameworkApplication.za.mb.Ej,w.AFrameworkApplication.za.mb.wLa));v.register(oj,"Common.App.InProductMessaging.InProductMessagingActor").ma().na(()=>new oj(w.AFrameworkApplication.Pa,w.AFrameworkApplication.za,v.resolve("Common.IInProductMessagingUIManager")));v.register(mg,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().na(()=>
new mg);v.register(fg,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().na(()=>new fg);this.Da=v}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").qb();w.AFrameworkApplication.fa.Ue(()=>{w.AFrameworkApplication.za.mb.mP&&ib.a.get_instance().Ij(15,()=>{this.Da.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(v=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").u$j(v)})});
w.AFrameworkApplication.fa.getBooleanAppSetting("FreemiumUpsellShowDialogIsEnabled")&&we.a()&&!Ee.a.vy&&1!==w.AFrameworkApplication.za.mb.Ej&&this.Da.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(v=>{v.isFeatureEnabled("MsoPremiumBadge",!0).then(S=>{!S&&v.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Cxk();return null})})})}dispose(){}static main(){e.a.instance.Ac(new cd)}}Object(k.a)(cd,"InProductMessagingPackage",
null,[2,3]);var aj=d(401),Qc=d(575);class Mc{static tgj(v){return Mc.uSf("New",v)}static ugj(v){return Mc.uSf("Open",v)}static bSf(v,S){return Mc.g$a("LoadingMenuSection",Mc.Ayk,v,Mc.q4b("lblLoading",S))}static r4b(v,S,ma=null,Ja=null){return Mc.g$a("MessageMenuSection",Mc.oih,S,Mc.q4b("lblMessage",v,ma,Ja))}static ZKi(v){return Mc.bSf(v,CommonUIStrings.l_VoicedLoadingText)}static $Ki(v,S){return Mc.r4b(CommonUIStrings.l_NewCreationLocationMessage,v.labelText,S.SS,S.cOa)}static YKi(v,S){return Mc.r4b(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,
S.cOa,"\n\n"),v.labelText)}static dSf(v){return Mc.r4b(CommonUIStrings.l_NewGenericErrorMessage,v.labelText)}static WKi(v,S,ma){return Mc.g$a("menuNewBlank",Mc.h2j,ma?v.labelText:null,Mc.m4b(v.Qug,v.Rug,v.Sug,null,v.bHa,v.mdc,S,"blank"))}static LLi(){return Mc.q4b("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static rSf(){return Mc.q4b("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static MLi(v,S){return Mc.g$a("menuNewTemplates",v,null,S)}static UKi(v,S){return Mc.g$a("menuNewMoreTemplates",
Mc.ceg,null,Mc.m4b("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,v,S))}static TJi(v,S,ma){let Ja="";ma&&S&&(Ja=Mc.g$a("BrowseMoreMenuSection",Mc.ceg,null,Mc.m4b("btnBrowseMore",S,S,null,null,null,v||"1959943459",ma)));return Ja}static q4b(v,S,ma=null,Ja=null){let Va=Ja;S&&0<S.length&&(Va=Mc.Wih.dMa(S).trimEnd(),Va=0<=Va.indexOf("{0}")?String.format(Va,Ja):String.format("{0} {1}",Va,Ja));ma=ma&&Ja?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
hc.a.Fe(ma),hc.a.Fe(Ja),hc.a.Fe(Va)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',hc.a.Fe(v||""),Mc.Wih.dMa(hc.a.Fe(S||"")),ma)}static m4b(v,S,ma,Ja,Va,wb,Sb,vc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',hc.a.Fe(v||""),hc.a.Fe(S||
""),hc.a.Fe(ma||""),Ja||"32by32",hc.a.Fe(Va||""),hc.a.Fe(wb||""),Sb,hc.a.Fe(vc||""))}static uSf(v,S){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',v,S)}static g$a(v,S,ma,Ja){ma=ma?String.format('Title="{0}"',hc.a.Fe(ma)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
hc.a.Fe(v||""),hc.a.Fe(S||""),ma,Ja)}}Mc.oih="MenuMru";Mc.Ayk="MenuLoading";Mc.h2j="MenuHeader";Mc.ceg="MenuFooter";Mc.Wih=Qc.a.jy("\n","&#10;");Object(k.a)(Mc,"NewAndOpenXmlUtilities",null,[]);var Ig=d(97);class wg{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(k.a)(wg,"HostInformation",null,[]);var fe=d(177),Qe=d(127),ig=d(445),Ph=d(534);class $g{constructor(v,S,ma,Ja,Va,wb){this.G1b=this.Go=this.PDc=null;this.wLc=this.yVd=!1;this.Ozf=0;this.POd=!1;this.btc=
(Sb,vc,gd,od,Vd)=>{if(1===gd)return 32;2!==gd||this.POd||(this.Ozf=(new Date).getTime(),n.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.nAd,["CachedNewMenuXmlExists"]:!!this.PDc,["ShouldCallGetMoreInfo"]:this.SI.VAa}));return this.phl(Vd)};this.$ja=v;this.EXb=S;this.Ija=new Ie.a(()=>new aj.a(ma.value,Object(r.a)(this,this.yGa,"getMoreInfoEventReceived")));this.wji=Ja;this.gRa=Va;this.poi=wb;this.a1b=this.nAd;this.OHc=!!w.AFrameworkApplication.fa&&
w.AFrameworkApplication.fa.getBooleanAppSetting("GateTemplateRenderingByGetMoreInfoResponse");this.Ihi=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",!1);this.qxf=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",!1)}get v0(){switch(this.SI.E2){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}qb(){const v=this.SI.DLb;v.xa(F.a.newDocument,E.a.frame,Object(r.a)(this,this.newDocument,"newDocument"));v.xa(F.a.btc,E.a.frame,this.btc)}newDocument(v,S,ma,Ja,Va){if(1===ma)return 32;if(2===ma&&Va){if(w.AFrameworkApplication.fa.getBooleanAppSetting("BackstagePremiumTemplateExperienceEnabled")&&Va.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),w.AFrameworkApplication.Pa.nb(F.a.Ujl,2);if(Va.MenuItemId&&Va.SourceControlId)return"NewDocumentHome"===
Va.SourceControlId&&pb.a("NewDocumentFromHomeTab"),this.lab(Va.MenuItemId,Va.SourceControlId)}return 8}lab(v,S){var ma=this.nnd.$7d;if(null===ma)return 8;var Ja=w.AFrameworkApplication.fa.getBooleanAppSetting("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Va=w.AFrameworkApplication.ofb;"blank"===v&&this.Vlk()&&(n.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.v0),v="blankNew");if(Va&&Ja){n.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const wb={};wb[fe.a.DXh]=v;wb[fe.a.v0]=this.v0;wb[fe.a.lcid]=w.AFrameworkApplication.lcid.toString();wb[fe.a.reason]=ig.a.Q4i;wb[fe.a.uiCulture]=w.AFrameworkApplication.uiCulture;wb[fe.a.dataCulture]=w.AFrameworkApplication.dataCulture;w.AFrameworkApplication.WU().execute(Sb=>{Sb.sendMessage(Qe.a.lab,wb)})}else Ja=(new Date).getTime(),S=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ma,hc.a.We(this.Qya),hc.a.We(v),hc.a.We(this.v0),
hc.a.We(w.AFrameworkApplication.lcid.toString()),hc.a.We(Ja.toString()),hc.a.We(S),hc.a.We(w.AFrameworkApplication.gC),w.AFrameworkApplication.mh),(ma=w.AFrameworkApplication.fa.Ea("ScenarioId"))&&""!==ma&&(S+="&wdscenarioid="+hc.a.We(ma)),S+="&"+w.AFrameworkApplication.jWa(),w.AFrameworkApplication.JHa&&(S+="&"+w.AFrameworkApplication.N0c()),(ma=this.Go?this.Go.SS:null)?S+="&DestinationUrl="+hc.a.We(ma):3===this.SI.E2&&this.SI.VAa&&n.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),
Cd.a.qo(S,"_blank",void 0,"CreateNewDocument");2!==this.SI.E2&&3!==this.SI.E2||n.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Ph.a[this.SI.E2],["Template"]:v});w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.SI.E2&&("blank"===v||"blankNew"===v?pb.b("ConsumerTemplateNewBlank"):(v=[Object.assign(new B.a,{name:"TemplateId",string:v})],pb.b("ConsumerTemplateNew",null,
0,!0,0,v)));return 32}Vlk(){let v=!1;switch(this.SI.E2){case 3:v=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:v=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:v=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return v}kEk(v){let S=Number.MAX_VALUE,ma=Number.MIN_VALUE;const Ja=window.performance;if(Ja&&"undefined"!==
typeof Ja.getEntriesByName){for(let wb=0;wb<v.length;wb++){var Va=Ja.getEntriesByName(v[wb]);Va&&0<Va.length&&(Va=Va[0],S=Math.min(parseInt(String(Va.fetchStart)),S),ma=Math.max(parseInt(String(Va.responseEnd)),ma))}ma>S&&n.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ma-S,["MinFetchStart"]:S,["MaxResponseEnd"]:ma})}}phl(v){v&&(this.PDc?v.PopulationXML=this.PDc:(this.SI.VAa&&!this.Go&&this.F_k.Gi("Opened New menu",!0),v.PopulationXML=this.jtj(this.iPj())));
return 32}TEg(){return!this.SI.VAa||!!this.Go&&3===this.Go.state&&!!this.Go.cOa&&!!this.Go.SS}ixe(){return w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.WHa&&!this.OHc?!0:this.TEg()}iPj(){if(!this.nAd&&!this.OHc&&!this.ixe())return null;if(this.a1b&&!this.wLc){let S=!1;var v="9";const ma=w.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in ma&&(v=ma.NumberOfTemplatesInBackstage);let Ja=this.v0;"TemplateCollectionId"in ma&&(Ja=ma.TemplateCollectionId);this.Ihi&&(Ja="WordConsumerWAC",
v="10");this.qxf&&(Ja="WordConsumerWAC",v="10",S=!0);v=String.format(this.SI.yha+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",hc.a.We(w.AFrameworkApplication.lcid.toString()),hc.a.We(Ja),v);Boolean.parse(ma.AppendOriginQueryParam||"false")&&(v+="&org=backstage");Boolean.parse(ma.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in ma&&(v+="&templateTier="+ma.TemplateTier);this.qxf&&(v+="&col=officetemplateswordonlinestartexp2");v=S?v+"&p=1":v+"&p=0";v+="&"+w.AFrameworkApplication.jWa();
w.AFrameworkApplication.JHa&&(v+="&"+w.AFrameworkApplication.N0c());this.SI.sqc.Tj(v,1,null,null,!1,2,Va=>{this.SI.Ewa("CreateNewActor.GetTemplateListJson",Va.data);this.x9l(Va.data.Ud)},Va=>{this.SI.Ewa("CreateNewActor.GetTemplateListJson",Va.data);this.w9l()},null,void 0,void 0,void 0,void 0,"5");this.a1b=!1}return this.G1b}x9l(v){this.G1b=v;this.a1b=!1;this.pvc();this.OHc?this.ixe()?this.V$d():this.Go&&(n.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.T$d()):
this.V$d()}V$d(){if(w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.WHa&&ef.c()){const v=w.AFrameworkApplication.fa.getBooleanAppSetting("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),S=w.AFrameworkApplication.ofb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.G1b,!0,v&&S));3===this.SI.E2&&n.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}w9l(){this.wLc=this.a1b=!0;this.pvc();this.T$d();Ig.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}T$d(){w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.WHa&&ef.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.SI.E2&&n.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}WPj(v){var S=0;for(var ma=0;ma<v.length;ma++)if("ST"===v[ma].ImageType){S=ma;break}const Ja=v.length?v[S]:null;v=Ja?Ja.Url||"":"";var Va;let wb=ma=S=!1;if(Ja&&(Va=Ja.AspectRatio))Va=parseFloat(Va),1>Va?S=!0:1.5<Va?ma=
!0:1===Va&&(wb=!0);else switch(n.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:v}),this.SI.E2){case 3:S=!0;break;case 2:ma=!0;break;case 5:wb=!0}return{returnValue:v,jK:S?"95by123":ma?"123by69":wb?"100by100":"123by95"}}jtj(v){const S=({Zzd:v}=this.XKi(v,this.nnd,this.nnd.y4b||"1056925771")).returnValue;v&&(this.PDc=S,n.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.Ozf}));
return S}yGa(v,S){n.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Go||3!==v.state?2===v.state&&(n.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.yVd=!0,this.pvc()):(this.Go=v,S||this.pvc(),w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.WHa&&ef.c()&&ef.d("setFileMenuHostInformation")&&(v=Object.assign(new wg,{hostUrl:this.Go.SS,hostName:this.Go.cOa,folderUrl:w.AFrameworkApplication.breadcrumbFolderUrl,folderName:w.AFrameworkApplication.breadcrumbFolderName}),
n.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(v)),this.OHc&&this.G1b&&this.G1b.length&&(this.ixe()?this.V$d():this.T$d(),n.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}XKi(v,S,ma){let Ja;Ja=!1;const Va=this.TEg();let wb="";this.SI.VAa&&(this.yVd?(wb=Mc.dSf(S),this.yVd=!1,n.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.Go?Va?wb=Mc.$Ki(S,this.Go):this.Go.eck?(Ja=!0,this.a1b=!1,wb=Mc.YKi(S,this.Go),n.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Ja=!0,wb=Mc.dSf(S),n.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Go.SS,["StorageServiceDisplayNameIsSet"]:!!this.Go.cOa})):(wb=Mc.ZKi(S.labelText),n.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
Va&&(wb+=Mc.WKi(S,ma,!wb)+({Zzd:Ja}=this.KLi(v,ma)).returnValue);return{returnValue:Mc.tgj(wb),Zzd:Ja}}KLi(v,S){let ma;ma=!1;if(!this.nAd)return ma=!0,n.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Zzd:ma};let Ja="",Va="",wb="MenuTemplate";if(this.wLc)Ja=Mc.rSf(),this.wLc=!1,n.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(v){try{const Sb=Sys.Serialization.JavaScriptSerializer.deserialize(v,!0);
Ja=this.JLi(Sb,S);n.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");w.AFrameworkApplication.Yih&&"OneDrive"===this.Qya&&(Va=Mc.UKi(this.G_k,w.AFrameworkApplication.Yih))}catch(Sb){n.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:v}),Ja=Mc.rSf()}ma=!0}else wb="MenuLoading",Ja=Mc.LLi(),n.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Mc.MLi(wb,Ja)+Va,Zzd:ma}}JLi(v,
S){let ma="";const Ja=[];for(let wb=0;wb<v.length;wb++){var Va=v[wb];let Sb="";if(Va){const vc=Va.Title,gd=Va.AssetId;Va=Va.Thumbnails;gd&&vc&&Va&&({jK:Va,returnValue:Sb}=this.WPj(Va),ma+=Mc.m4b("jbtnNewTemplate"+wb,vc,null,Va,null,Sb,S,gd))}Ja[wb]=Sb}v=new W.a(4,1,5E3,()=>{this.kEk(Ja)},106);this.SI.lnd.Jb(v);return ma}pvc(){this.POd=!0;this.SI.Sih.E3(this.nnd.i$b);this.POd=!1}get SI(){return this.$ja.value}get nnd(){return this.EXb.value}get F_k(){return this.Ija.value}get G_k(){return this.wji.value}get Qya(){return this.gRa.value}get nAd(){return this.poi.value}}
Object(k.a)($g,"CreateNewActor",null,[]);class Vg{constructor(){this._initialized=!1;this.bWd={}}MD(v){this.P9f();return this.get(v)}contains(v){this.P9f();return v.toString()in this.bWd}P9f(){this._initialized||(this.qwi(),this._initialized=!0)}qvb(v,S){this.bWd[v.toString()]=S}get(v){return this.bWd[v.toString()]}}Object(k.a)(Vg,"AIntlHelper",null,[]);class Fg extends Vg{constructor(){super()}qwi(){this.qvb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.qvb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.qvb(2,CommonUIStrings.l_Open);this.qvb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.qvb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.qvb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Fg.Ja||(Fg.Ja=new Fg)}static gbl(v){return Fg.instance.MD(v)}}Fg.Ja=null;Object(k.a)(Fg,"MruActorIntlHelper",Vg,[]);var bf;(function(v){v[v.success=0]="success";v[v.failure=1]="failure";v[v.spinner=2]="spinner";v[v.none=3]="none"})(bf||(bf={}));Object(k.b)("DisplayState",bf);var Ag=d(35);
class ff{constructor(v,S,ma,Ja,Va,wb,Sb,vc){this.OId=null;this.UXd=!0;this.ODc="";this.nqi=0;this.Ysb=null;this.JPd=3;this.Zrd=(gd,od,Vd,Ke,kg)=>1!==Vd&&kg?this.nhl(kg):32;this.La=vc;this.$ja=v;this.Pda=S;this.iei=ma;this.Eai=Ja;this.Dai=Va;this.Ija=new Ie.a(()=>new aj.a(wb.value,null));this.Sei=new Ie.a(()=>new aj.a(Sb.value,Object(r.a)(this,this.eZk,"mruEventResultReceived")));this.La.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost");this.La.getBooleanAppSetting("UiHostSupportsDocRebootFeatures")}eZk(v,
S){this.Ysb=v;S||this.wBh()}Axl(){this.iH.DLb.pa(F.a.Zrd,E.a.frame,this.Zrd,96)}nhl(v){this.Ygj();this.Xgj();v.PopulationXML=Mc.ugj(this.ODc+this.OId);return 32}Ygj(){var v=3;let S=!1;if(this.ODc&&this.nqi===this.Ysb.V$l)n.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),v=this.JPd;else{n.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ma=this.iH.IG();
this.Ysb=this.dZk.Gi("File Open opened",!0);this.ODc&&2!==this.JPd&&3!==this.Ysb.state?S=!0:(v=this.JLj(this.Ysb),w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.WHa&&ef.c()&&v&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(v,!0)),this.ODc=({w_k:v}=this.ktj(this.Ysb)).returnValue);ma=this.iH.IG()-ma;n.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ma})}2!==v&&(ma={["DisplayState"]:bf[v]},1!==v&&
(ma.IsStale=S),n.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",ma));this.JPd=v}JLj(v){let S;try{S=Ag.c(v.aSe)}catch(ma){S=null,n.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ma)}return S}Xgj(){this.UXd?(n.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.OId=({qom:this.UXd}=this.nVk()).returnValue):n.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
n.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.UXd,["NotDisplayingLink"]:!this.OId})}ktj(v){let S;1===v.state||0===v.state?(n.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),v=2,S=Mc.bSf(this.PGa(2),this.PGa(5))):3===v.state&&v.aSe?(S=this.VKi(v.aSe),v=0):(n.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),S=Mc.r4b(this.PGa(1),this.PGa(2)),v=1);return{returnValue:S,w_k:v}}VKi(v){let S;
const ma=this.Gpc.y4b||"2155708348";if(v.length){S=Mc.q4b("lblRecentDocuments",this.PGa(3));let Ja=0;for(let Va=0;Va<v.length;Va++){const wb=v[Va];"FileName"in wb&&"DocumentUrl"in wb&&"Path"in wb&&(S+=Mc.m4b("MruButton"+Va,wb.FileName.toString(),wb.Path.toString(),null,this.Gpc.bHa,this.Gpc.mdc,ma,wb.DocumentUrl.toString()),wb.IsPinned&&Ja++)}S=Mc.g$a("RecentDocumentsMenuSection",Mc.oih,this.PGa(2),S);n.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:v.length,
["NumPinnedDocuments"]:Ja})}else S=Mc.r4b(this.PGa(0),this.PGa(2)),n.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return S}nVk(){let v;v=!0;let S=this.kJi;var ma=this.jJi;if(S&&ma||!this.iH.VAa)v=!1;else{const Ja=this.S0c.Gi("File Open",!1);3===Ja.state&&(S=Ja.SS,ma=Ja.cOa,v=!1)}ma=ma?String.format(this.PGa(4),ma):null;return{returnValue:Mc.TJi(this.Gpc.y4b,ma,S),qom:v}}wBh(){this.iH.Sih.E3(this.Gpc.i$b)}get iH(){return this.$ja.value}get PGa(){return this.Pda.value}get Gpc(){return this.iei.value}get kJi(){return this.Eai.value}get jJi(){return this.Dai.value}get S0c(){return this.Ija.value}get dZk(){return this.Sei.value}}
Object(k.a)(ff,"MruRenderer",null,[]);var Fe=d(160),Pf=d(455);class Md{constructor(v,S,ma,Ja,Va,wb,Sb){this.Go=null;this.REf=!1;this.jQa=this.Oof=0;this.yGa=vc=>{if(!this.Go&&3===vc.state)this.Go=vc;else if(2===vc.state){this.REf?n.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.S0c.Gi("NewDocumentFromStream",!0),this.REf=!0);return}this.x1f()};this.z_k=vc=>{if(vc&&vc.data&&vc.data.Ud){var gd;({Ev:gd}=Ag.d(vc.data.Ud)).returnValue?(vc=gd,vc.StatusCode!==Fe.a.Zw&&
vc.StatusCode!==Fe.a.c7b?(n.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.v0,this.jQa,vc.StatusCode),this.ktb(null)):vc.NewDocumentUrl&&""!==vc.NewDocumentUrl?(n.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.v0,this.jQa,(new Date).getTime()-this.Oof),this.Hji(vc.NewDocumentUrl)):(n.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.v0,this.jQa),this.ktb(null))):(n.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.v0,this.jQa,{["ResponseData"]:Pf.a.oBc(vc.data.Ud)}),this.ktb(null))}else n.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.v0,this.jQa),this.ktb(null)};this.y_k=vc=>{vc&&vc.data&&n.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.v0,this.jQa,vc.data.status);this.ktb(null)};this.Hji=v;this.ktb=S;this.SIc=ma;this.EXb=Ja;this.gRa=Va;this.$ja=wb;this.Ija=new Ie.a(()=>new aj.a(Sb.value,this.yGa))}lab(){!this.Go&&this.nSe.VAa?this.S0c.Gi("NewDocumentFromStream",!0):this.x1f()}x1f(){this.Oof=(new Date).getTime();var v=this.Amj.$7d;if(null===v)this.ktb(null);else{var S=this.SIc.menuItemId,ma=this.SIc.uW,Ja=this.SIc.p6l,Va=this.SIc.Hmj;this.jQa="streamBase64"===Ja?Va.length/1024:0;n.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",
this.v0,this.jQa);var wb=(new Date).getTime();v=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",v,hc.a.We(this.Qya),hc.a.We(S),hc.a.We(this.v0),hc.a.We(w.AFrameworkApplication.lcid.toString()),hc.a.We(wb.toString()),hc.a.We(ma),hc.a.We(w.AFrameworkApplication.gC),w.AFrameworkApplication.mh,hc.a.We(Ja));v+="&"+w.AFrameworkApplication.jWa();w.AFrameworkApplication.JHa&&(v+="&"+w.AFrameworkApplication.N0c());(S=this.Go?this.Go.SS:
null)&&(v+="&DestinationUrl="+hc.a.We(S));this.nSe.sqc.Tj(v,2,Va,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.z_k,this.y_k,null,void 0,void 0,void 0,void 0,"31")}}get v0(){switch(this.nSe.E2){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get Amj(){return this.EXb.value}get Qya(){return this.gRa.value}get nSe(){return this.$ja.value}get S0c(){return this.Ija.value}}Object(k.a)(Md,"NewDocumentFromStreamOperation",null,
[]);class vg{constructor(v,S,ma,Ja){this.EXb=v;this.gRa=S;this.$ja=ma;this.Rei=Ja}create(v,S,ma){return new Md(v,S,ma,this.EXb,this.gRa,this.$ja,this.Rei)}}Object(k.a)(vg,"NewDocumentFromStreamOperationFactory",null,[1612]);var Ye=d(255);class Cf{get name(){return"Common.App.NewAndOpen.UX"}fc(v){v.register(vg,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().na(()=>new vg(new Ie.a(()=>w.AFrameworkApplication.za.mb.vhe()),
new Ie.a(()=>w.AFrameworkApplication.Qya),new Ie.a(()=>v.ub("Common.INewAndOpenCommonHelpers")),new Ie.a(()=>v.ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){w.AFrameworkApplication.fa.Ue(()=>{this.gHa()})}gHa(){const v=Ye.a.Au(C.a.instance.Ha("Common.INewAndOpenCommonHelpers")),S=Ye.a.Au(C.a.instance.Ha("Common.IEventEmitter<Common.IGetMoreInfoResult>"));w.AFrameworkApplication.Qya&&je.Task.WAA.call(null,v,S).continueWith(()=>{const ma=new $g(new Ie.a(()=>v.result),new Ie.a(()=>
w.AFrameworkApplication.za.mb.vhe()),new Ie.a(()=>S.result),new Ie.a(()=>w.AFrameworkApplication.za.mb.whe().y4b||"1959943459"),new Ie.a(()=>w.AFrameworkApplication.Qya),new Ie.a(()=>w.AFrameworkApplication.Wlk));ma.qb();ma.pvc()});if(w.AFrameworkApplication.A1e){const ma=Ye.a.Au(C.a.instance.Ha("Common.IEventEmitter<Common.IMruResult>"));je.Task.WAA.call(null,v,S,ma).continueWith(()=>{const Ja=new ff(new Ie.a(()=>v.result),new Ie.a(()=>Fg.gbl),new Ie.a(()=>w.AFrameworkApplication.za.mb.whe()),new Ie.a(()=>
w.AFrameworkApplication.fbl),new Ie.a(()=>w.AFrameworkApplication.ebl),new Ie.a(()=>S.result),new Ie.a(()=>ma.result),w.AFrameworkApplication.fa);Ja.Axl();Ja.wBh()})}}dispose(){}}Object(k.a)(Cf,"UXPackageManager",null,[2,3,106]);class Bg extends Ya.StandardDialog{constructor(){super();this.Fd=0;this.Te(1,CommonUIStrings.l_DialogClose)}uw(v){this.Kz(v,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}vFa(v){this.Kz(v,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,
null,!0)}}Object(k.a)(Bg,"ErrorDialog",Ya.StandardDialog,[1575]);class Ae{Zfg(){n.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const v=new re.a;v.Jg("api.onedrive.com");return v.task}}Object(k.a)(Ae,"OneDriveConsumerEndpointHelper",null,[1532]);var Uf=d(168);class Jd{constructor(v,S,ma,Ja){this.T7a=this.Mpa=null;this.fVd=this.hVd=!1;this.ptb=null;this.La=v;this.Sqb=S;this.t7a=ma;this.TB=Ja}get DNf(){return this.Sqb}get fa(){return this.La}vBb(){this.ptb||(this.ptb=this.DMb?td.a.create(this.DMb,
null,null,null,!1):null);return this.ptb}setup(v){this.T7a=v;this.hVd||this.fVd?this.hVd&&this.T7a&&this.T7a(!0):(v=this.vBb())?(this.fVd=!0,v.rIa.continueWith(S=>{this.B7k(S)}),Od.a.bF(v)):(n.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.T7a(!1))}WUe(v){n.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",v.Ni?v.Ni.toString():"No error detail.")}B7k(v){this.fVd=!1;if(v.Pm)this.WUe(v),this.T7a(!1);else try{this.hVd=
!0,n.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Mpe(),n.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.T7a(!0)}catch(S){n.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",S.toString()),this.T7a(!1)}}szc(v){this.Mpa=v;this.t7a?n.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(r.a)(this,this.oTe,
"onApiReady")))}oTe(v){v?this.l$c():this.zu()}zu(){this.TB().uw(Uf.a.Dal)}uu(v){n.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.Mpa&&this.Mpa(!0,v)}dispose(){this.ptb&&this.ptb.dispose()}}Object(k.a)(Jd,"AOneDriveFilePickerApiManager",null,[288,106]);class We extends Jd{constructor(v,S,ma,Ja,Va,wb){super(S,ma,Ja,wb);this.yk=null;this.Oda=v;this.uoi=Va}get DMb(){return this.fa.Ea("OneDriveApiUrl")}start(v,S){this.yk=v;this.szc(S)}Mpe(){WL.init(1===this.DNf||
2===this.DNf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}szc(v){this.Mpa=v;!this.t7a&&this.Oda.gue?(n.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(r.a)(this,this.oTe,"onApiReady"))):(n.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.uoi())}l$c(){try{n.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),
WL.fileDialog(this.yk).then(Object(r.a)(this,this.uu,"onSuccess"),Object(r.a)(this,this.wA,"onFailure"))}catch(v){n.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",v,v.stack),this.zu()}}wA(v){if(v&&v.error){if("user_canceled"===v.error.code){n.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}n.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",v.error.code,v.error.message)}else n.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.Mpa&&this.Mpa(!1,v);this.zu()}}Object(k.a)(We,"OneDriveFilePickerApiManagerV5",Jd,[]);class fd extends Jd{constructor(v,S,ma,Ja,Va){super(v,S,ma,Ja);this.GGc=this.rBf=null;this.tDd=()=>{this.GGc.style.visibility="hidden"===this.GGc.style.visibility?"":"hidden"};this.Jdi=Va;this.options={};this.options.clientId=this.fa.Ea("OneDriveApiV7ClientId");this.options.cancel=this.tDd}get DMb(){return this.fa.Ea("OneDriveApiV72Url")}start(v,S){this.GGc=S;
const ma=this.Jdi.Zfg();ma.continueWith(()=>{n.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.rBf=ma.result;this.szc((Ja,Va)=>{this.tDd();v(Ja,Va)})},3);ma.continueWith(()=>{n.ULS.sendTraceTag(24134242,352,15,ma.Ni.message);this.tDd()},5)}Mpe(){this.options.success=v=>{const S={};S.data=v;this.uu(S)};this.options.error=v=>{const S={};S.error=v;this.wA(S)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.rBf;this.options.advanced.iframeParentDiv=this.GGc}l$c(){try{n.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.tDd(),OneDrive.open(this.options)}catch(v){n.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",v.message),this.zu()}}wA(v){this.Mpa&&this.Mpa(!1,v);this.zu()}}Object(k.a)(fd,"OneDriveFilePickerApiManagerV7",Jd,[]);class ui extends Jd{constructor(v,S,ma,Ja){super(v,S,ma,Ja);this.Q$h=v;this.options={};this.options.advanced=
{};this.options.action="query";this.options.clientId=this.fa.Ea("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get DMb(){return this.fa.Ea("OneDriveApiV72Url")}start(v,S,ma,Ja){this.options.advanced.iframeParentDiv=ma;this.options.advanced.endpointHint=Ja;this.options.cancel=S;this.Q$h.getBooleanAppSetting("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.szc(v)}szc(v){this.Mpa=v;this.t7a?n.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(r.a)(this,this.oTe,"onApiReady")))}Mpe(){this.options.success=v=>{const S={};S.data=v;this.uu(S)};this.options.error=v=>{const S={};S.error=v;this.wA(S)}}l$c(){try{n.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),
OneDrive.save(this.options)}catch(v){n.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",v.message,v.stack),this.zu()}}WUe(v){n.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",v.Ni?v.Ni.toString():"No error detail.");Od.a.Zzl(this.DMb);this.ptb=null}zu(){this.TB().vFa(Uf.a.PJl)}wA(v){this.Mpa&&this.Mpa(!1,v)}}Object(k.a)(ui,"OneDriveFilePickerApiManagerV72",Jd,[]);class bj{constructor(v){this.olsSessionId=this.value=
this.key=null;this.olsSessionId=v}}Object(k.a)(bj,"IExtraData",null,[]);class nf extends ui{constructor(v,S,ma,Ja){super(v,S,ma,Ja);this.options.advanced.filter=v.Ea("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=w.AFrameworkApplication.QNf;v.getBooleanAppSetting("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=v.Ea("OneDriveApiV72CommandMode")||"none");v.getBooleanAppSetting("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=
new bj(w.AFrameworkApplication.userSessionId))}get DMb(){return this.fa.Ea("OneDriveApiV72Url")}l$c(){try{n.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",w.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(v){n.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
v.message,v.stack),this.zu()}}}Object(k.a)(nf,"OneDriveFilePickerApiOpenManagerV72",ui,[]);class ki{constructor(v){this.hx=null;this.TFj=S=>{if(S.data.Ke===Fe.a.Ctc&&"X-NewKey"in S.data.gk){n.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const ma={};ma["X-Key"]=S.data.gk["X-NewKey"];this.W6e(ma)}else 0<this.eUd?(n.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.eUd),
this.eUd--,this.W6e()):(n.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.hx.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};this.VFj=S=>{"PersonalFileStorageUrl"in S.data.gk&&""!==S.data.gk.PersonalFileStorageUrl?(n.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.hx.Jg(S.data.gk.PersonalFileStorageUrl)):(n.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.hx.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};this.Bi=v;this.eUd=3}Zfg(){this.hx=new re.a;n.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.W6e();return this.hx.task}W6e(v=null){const S=String.format("GetMoreInfoHandler.ashx?{0}",w.AFrameworkApplication.pab);this.Bi.jU(S,1,null,v,["PersonalFileStorageUrl","X-NewKey"],2,this.VFj,this.TFj,null,void 0,void 0,void 0,void 0,"21")}}Object(k.a)(ki,"OneDriveForBusinessEndpointHelper",
null,[1532]);var qf=d(358);class be{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}fc(v){this.Da=v;this.Da.register(We,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().na(()=>new We(qf.a.instance,w.AFrameworkApplication.fa,w.AFrameworkApplication.RUa,w.AFrameworkApplication.YR,w.AFrameworkApplication.gSh,()=>new Bg));w.AFrameworkApplication.WEb?this.Da.register(1532,
"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new Ae):this.Da.register(1532,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new ki(w.AFrameworkApplication.Me));this.Da.register(fd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().na(()=>new fd(w.AFrameworkApplication.fa,w.AFrameworkApplication.RUa,w.AFrameworkApplication.YR,()=>new Bg,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.Da.register(ui,
"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().na(()=>new ui(w.AFrameworkApplication.fa,w.AFrameworkApplication.RUa,w.AFrameworkApplication.YR,()=>new Bg));this.Da.register(nf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().na(()=>new nf(w.AFrameworkApplication.fa,w.AFrameworkApplication.RUa,w.AFrameworkApplication.YR,()=>new Bg))}static main(){e.a.instance.Ac(new be)}}Object(k.a)(be,"PackageManager",null,[2,3]);var Ud=d(165),Ei=d(182);class ei{constructor(v){this.fgb=
this.GMe=this.Aib=this.Tfd=0;this.gLe=this.J1g=null;this.e8k=S=>{"pen"!==S.pointerType||this.Aib||(this.Aib=Math.floor(this.y7b()/1E3),this.Aib<=this.Tfd&&(this.Aib=this.Tfd),this.GMe=0)};this.f8k=()=>{this.btg()};this.vcc=(S,ma)=>{0!==ma.newState&&this.btg()};this.JCk=()=>{0<this.fgb&&this.HKh(this.fgb);this.fgb=0};v?(this.zb=v,this.y7b=Date.now,this.z5i(),this.nxl()):n.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}lSl(){this.J1g="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}nxl(){window.document.body.addEventListener("pointerenter",
this.e8k);window.document.body.addEventListener("pointerleave",this.f8k);C.a.instance.Ha("Common.App.VisibilityManagement.IVisibilityManager").execute(v=>{v.uOc(this.vcc)})}btg(){const v=Math.ceil(this.y7b()/1E3);this.Aib&&v>this.Tfd&&(this.GMe=v,this.fgb+=this.GMe-this.Aib);this.Tfd=v;this.Aib=0}z5i(){this.gLe=new W.a(4,2,6E4,this.JCk);this.zb.Jb(this.gLe)}HKh(v){const S=new Ei.a;S.name=this.J1g;const ma=[];(v=Ud.a.W0("PenInputSec",v.toString(),3))&&Array.add(ma,v);S.dataFields=ma;y.a.sendActivityEvent(S)}dispose(){0<
this.fgb&&this.HKh(this.fgb);this.zb.Vg(this.gLe)}}Object(k.a)(ei,"PenMinutesManager",null,[1531]);class Aj{constructor(){this.PSd=this.Da=null}get name(){return"Common.App.PenMinutesManager"}fc(v){this.Da=v;const S=w.AFrameworkApplication.Be;this.Da.register(1531,"Common.App.PenMinutesManager.IPenMinutesManager").ma().na(()=>new ei(S))}init(){this.PSd=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.PSd&&this.PSd.dispose()}static main(){e.a.instance.Ac(new Aj)}}Object(k.a)(Aj,
"PenMinutesManagerPackage",null,[2,3]);class tj extends Ya.StandardDialog{constructor(v,S){super();this.rtb=!1;this.LL=null;this.i5e=ma=>{1===ma?(n.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.LL?this.Ca.Ia(F.a.gQb,2,[this.LL,this.rtb]):this.Ca.nb(F.a.gQb,2)):n.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.Ca=v;this.xXb=S;this.T3a=!1}uw(v,S,ma){this.LL=S;this.rtb=ma;n.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
v,ma);v=this.s4d(v);0===v?(this.Fd=6,this.Te(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Te(1,CommonUIStrings.l_DialogClose));0===v&&n.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Kz(Uf.a.OJl,this.Fzj(v),this.Ezj(v,S),this.i5e,!0)}s4d(v){return 0>v||6<v?(n.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",v),0):v}Ezj(v,S){v=this.s4d(v);return this.xXb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,
CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,S),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][v]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,S),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][v]}Fzj(v){v=this.s4d(v);return[CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][v]}}Object(k.a)(tj,"ErrorRetryDialog",Ya.StandardDialog,[1307]);class Pi{constructor(v,S){this.La=v;this.Ca=S;this.xXb=this.La.getBooleanAppSetting("SaveToHostWithExtraCharsInFileName")}create(){return new tj(this.Ca,this.xXb)}}Object(k.a)(Pi,"ErrorRetryDialogFactory",null,[1283]);class Eh extends Kc.a{constructor(v,
S,ma,Ja,Va,wb,Sb=null){super();this.WW=null;this.Ca=S;this.Zca=Ja;this.CDa=wb;this.La=v;this.TB=Va;this.oi=ma;this.xXb=this.La.getBooleanAppSetting("SaveToHostWithExtraCharsInFileName");this.yk=Sb;this.Te(1,CommonUIStrings.l_SaveButtonLabel)}get za(){return this.oi}O5f(v,S){this.SF(1,!!v&&v!==S);this.WW=document.getElementById(Eh.Ibg);Za.a.addHandler(this.WW,"change",Object(r.a)(this,this.Kod,"onFileNameChange"));Za.a.addHandler(this.WW,"input",Object(r.a)(this,this.Kod,"onFileNameChange"));this.WW.focus()}Hbg(v){return this.xXb?
(new RegExp("["+this.j$f('\\/:*?"<>|')+"]")).test(v):(new RegExp("["+this.j$f('\\/:*?"<>|#{}%~&')+"]")).test(v)}j$f(v){return v.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Hme(){const v=hc.a.dI(w.AFrameworkApplication.Qu.iy);this.SF(1,!!this.WW&&""!==this.WW.value&&this.WW.value!==v)}Kod(){this.WW&&window.setTimeout(()=>{this.Hme()},0)}WXc(v,S){if(1!==v)n.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{v=S[Eh.Ibg];S=Eh.bsh in S?S[Eh.bsh]:
!1;n.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",hc.a.jBh(v),S);const ma=hc.a.AR(w.AFrameworkApplication.fileName);(v=v?v.trim():null)&&""!==v&&""!==ma||1===this.za.state?this.Hbg(v)?this.TB.create().uw(1,v,S):this.CDa.s_(v+ma,S,this.yk):this.TB.create().uw(2,v,S)}}dispose(){this.WW&&(Za.a.removeHandler(this.WW,"change",Object(r.a)(this,this.Kod,"onFileNameChange")),Za.a.removeHandler(this.WW,"input",Object(r.a)(this,this.Kod,"onFileNameChange")),
this.WW=null);super.dispose()}}Eh.Ibg="txtFileName";Eh.bsh="chkOverwrite";Object(k.a)(Eh,"FileNameDialogBase",Kc.a,[]);class Th{static get Wg(){return Kc.a.oC(Th.Hq,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Th.Hq="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(k.a)(Th,"FileNameDialogHtml",null,[]);class Qi extends Eh{constructor(v,S,ma,Ja,Va,wb){super(v,S,ma,Ja,Va,wb);this.Wg=Th.Wg;this.Fg="FileNameDialog-SaveAsToHost"}Rla(v,S){const ma=hc.a.dI(w.AFrameworkApplication.Qu.iy);S={["txtFileName"]:v||ma,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:S};this.Vj(CommonUIStrings.L_SaveAs,Object(r.a)(this,this.WXc,"fileNameDialogHandler"),S);this.O5f(v,ma)}}Object(k.a)(Qi,"FileNameDialog",Eh,[1306]);class fi{constructor(v,S,ma,Ja,Va,
wb){this.Ca=S;this.La=v;this.Zca=Ja;this.CDa=wb;this.TB=Va;this.oi=ma}create(){return new Qi(this.La,this.Ca,this.oi,this.Zca,this.TB,this.CDa)}}Object(k.a)(fi,"FileNameDialogFactory",null,[1282]);class Ng{constructor(v,S,ma){this.YIh=(Ja,Va,wb,Sb,vc)=>Va.contextId!==E.a.frame||Ja!==F.a.gQb?2:this.La.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")?1===wb?D.SessionStatusManager.instance.Oma||w.AFrameworkApplication.TR?8:32:2===wb?(n.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
Ja=this.HLd.create(),vc&&Object.getType(vc)===Array&&2===vc.length?Ja.Rla(vc[0],!!vc[1]):Ja.Rla(null,!1),32):8:8;this.CDa=ma;this.HLd=S;this.La=v}qb(){2===w.AFrameworkApplication.za.mb.Ej?w.AFrameworkApplication.Pa.pa(F.a.gQb,E.a.frame,this.YIh,4):w.AFrameworkApplication.Pa.xa(F.a.gQb,E.a.frame,this.YIh)}}Object(k.a)(Ng,"SaveAsToHostActor",null,[]);class $d{constructor(v,S,ma,Ja,Va,wb,Sb,vc){this.Jo=null;this.rtb=this.e4=!1;this.BDa=this.yk=this.LL=null;this.La=S;this.HDa=this.La.appSettings.SaveAsToHostWebServiceBase;
this.Gvf=Ja;this.Isa=Va;this.Bi=ma;this.TB=wb;this.Di=vc;this.oi=Sb;this.Ca=v;this.vCa=S.Ea("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Yyc(){1!==this.oi.state&&(this.Jo=this.Isa(),this.Jo.message=CommonUIStrings.l_CommentProgressTooltip,this.Jo.Fd=5,this.Jo.Is=!1,this.Jo.fra(CommonUIStrings.l_DefaultDialogTitle,null,null))}q_(v=0){1!==this.oi.state&&this.TB.create().uw(v,hc.a.dI(this.LL),this.rtb)}nmb(){const v=this.La.appSettings.BreadcrumbFolderUrl;n.ULS.sendTraceTag(8194016,216,50,
"Redirecting to OneDrive for business Folder.");Cd.a.qo(v,Cd.a.Vca(3),void 0,"UploadToHostManager.RedirectToFolder")}mmb(v){let S=!1,ma=!1;this.La&&(S=this.La.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),ma=this.La.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",v,S,ma);if(S&&ma){n.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Ja={};Ja[fe.a.WOb]="1";Ja[fe.a.documentUrl]=v;Ja[fe.a.reason]=ig.a.$5e;w.AFrameworkApplication.WU().execute(Va=>{Va.sendMessage(Qe.a.yFa,Ja)})}else S&&!ma&&w.AFrameworkApplication.vY?Cd.a.qo(v,Cd.a.Vca(4),void 0,"UploadToHostManager.RedirectToEditUrl"):Cd.a.qo(v,Cd.a.Vca(3),void 0,"UploadToHostManager.RedirectToEditUrl")}s_(v,S,ma=null){n.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Gvf&&!this.Gvf()&&this.Bi&&(this.Di&&(this.BDa=this.Di.lj("DialogShown","SaveAsToHostUploadTime")),
this.Yyc(),this.rtb=S,this.LL=v,(this.yk=ma)&&"true"===this.yk.SkipSaveToHost?this.gXc():this.f5())}f5(){32!==this.Ca.nb(F.a.R2a,1)?(n.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.gXc()):this.Ca.Ia(F.a.R2a,2,[()=>{n.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.gXc()},(v,S)=>{n.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.q_(S)}])}ial(v){this.Iab();this.e4=!1;if(v&&v.data&&v.data.Ud)if(({Ev:S}=Ag.d(v.data.Ud)).returnValue)if(v=S,v.StatusCode!==Fe.a.Zw&&v.StatusCode!==Fe.a.c7b){n.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var S={};S.FailureReason=v.StatusCode.toString();S.ExtraInfo=v.ExtraInfo;this.Yza(S);this.q_(parseInt(v.ExtraInfo))}else{n.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.n4e();try{v.NewDocumentUrl&&""!==v.NewDocumentUrl?this.mmb(v.NewDocumentUrl):
this.nmb()}catch(ma){n.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ma.toString())}this.Gsc()}else n.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Pf.a.oBc(v.data.Ud)}),this.Yza({["FailureReason"]:"Failed to deserialize response"}),this.q_();else n.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.Yza({["FailureReason"]:"null response"}),this.q_()}hal(v){5!==v.data.status&&12!==v.data.status||this.e4?
(n.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:v.data.status,["HttpStatus"]:v.data.Ke}),this.Yza({["FailureReason"]:v.data.Ke.toString()}),this.Iab(),this.q_(),this.Gsc()):(n.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.e4=!0,this.yk&&"true"===this.yk.SkipSaveToHost?this.gXc():this.f5())}Iab(){this.Jo&&(this.Jo.close(),this.Jo=null)}Gsc(){this.BDa&&(this.BDa.stop(),this.BDa=null)}n4e(){this.yk&&"VersionHistory"===
this.yk.SaveEntryPoint&&this.Ca.nb(F.a.Ovd,2)}Yza(v){this.yk&&"VersionHistory"===this.yk.SaveEntryPoint&&this.Ca.Ia(F.a.o4e,2,v)}gXc(){let v=this.HDa+this.vCa;v=Hc.a.Xi(v,"qs",hc.a.We(w.AFrameworkApplication.mh));v=Hc.a.Xi(v,"n",hc.a.We((new Date).getTime().toString()));v=Hc.a.Xi(v,"ov",hc.a.We(this.rtb.toString()));v=Hc.a.Xi(v,"fn",hc.a.We(this.LL));this.yk&&this.yk.FileDownloadUrl&&(v=Hc.a.Xi(v,"furl",hc.a.We(this.yk.FileDownloadUrl)));this.Bi.Tj(v,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,Object(r.a)(this,this.ial,"onUploadFinished"),Object(r.a)(this,this.hal,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(k.a)($d,"UploadToHostManager",null,[1281]);var Qf=d(566);class Cg{constructor(){this.Da=null;this.Pn=()=>{w.AFrameworkApplication.fa.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")&&this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").qb()}}get name(){return"Common.App.SaveAsToHost"}init(){w.AFrameworkApplication.fa.Ue(this.Pn)}fc(v){this.Da=v;this.Da.register(Pi,
"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").na(()=>new Pi(w.AFrameworkApplication.fa,w.AFrameworkApplication.Pa)).ma();this.Da.register($d,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").na(()=>new $d(w.AFrameworkApplication.Pa,w.AFrameworkApplication.fa,w.AFrameworkApplication.Me,()=>w.AFrameworkApplication.Dh,()=>(new Qf.a).create(),v.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),
w.AFrameworkApplication.za,w.AFrameworkApplication.za.DW)).ma();this.Da.register(fi,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").na(()=>new fi(w.AFrameworkApplication.fa,w.AFrameworkApplication.Pa,w.AFrameworkApplication.za,w.AFrameworkApplication.za.mb,v.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();this.Da.register(Ng,"Common.App.SaveAsToHost.SaveAsToHostActor").na(()=>
new Ng(w.AFrameworkApplication.fa,v.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),v.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Ac(new Cg)}}Object(k.a)(Cg,"SaveAsToHostPackage",null,[2,3]);class rh extends Ya.StandardDialog{constructor(){super();this.Fd=0;this.Te(1,CommonUIStrings.l_DialogClose)}uw(v,S){this.m6f(v,S,Uf.a.QJl)}m6f(v,S,ma){n.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",ma);this.Kz(ma,
v,S,null)}vFa(v,S){n.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Kz(Uf.a.SJl,v,S,null,!0)}}Object(k.a)(rh,"ErrorDialog",Ya.StandardDialog,[246]);class ge{static get Wg(){return Kc.a.oC(ge.Hq,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}ge.Hq="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(k.a)(ge,"FileNameDialogHtml",null,[]);class bi extends Eh{constructor(v,S,ma,Ja,Va,wb,Sb,vc){super(v,S,ma,Ja,Va,wb,vc);this.wQa=this.GUd=this.CJ=null;this.cMi=CommonUIStrings.l_SaveToAnotherFolder;this.Wg=ge.Wg;this.Fg="FileNameDialog-SaveToSharePoint";this.I0b=Sb;this.wki=vc}Rla(v){const S=hc.a.dI(w.AFrameworkApplication.Qu.iy),ma=w.AFrameworkApplication.breadcrumbFolderName,Ja=w.AFrameworkApplication.breadcrumbBrandName,Va={["txtFileName"]:v||S};let wb=CommonUIStrings.L_SaveAs;2===w.AFrameworkApplication.za.mb.Ej&&
(wb=CommonUIStrings.L_SaveACopy);this.Vj(wb,Object(r.a)(this,this.WXc,"fileNameDialogHandler"),Va);this.O5f(v,S);this.r$d.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");w.AFrameworkApplication.fa.getBooleanAppSetting("HideSaveToAnotherFolderButtonforUIHost")||(this.CJ=document.getElementById("anotherFolder"),v=document.getElementById("folderLocation"),this.GUd=na.a.TNf(v,this.CJ,"anotherFolderDescribedBy",""),this.CJ.className=
"WACButton WACDialogButtonNormal",v=!1,ma&&ma.length?(this.yJf(this.CJ,this.GUd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ja,ma)),v=this.Qsi(Ja,ma)):this.yJf(this.CJ,this.GUd,CommonUIStrings.l_CurrentOnlineFolder),this.Aui(this.CJ),this.Ssi(this.CJ),v?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.CJ,"SaveToAnotherLocationTwo"),n.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.CJ,
"SaveToAnotherLocationOne"),Za.a.addHandler(this.CJ,Ha.a.click,Object(r.a)(this,this.DVe,"onSaveToAnotherLocationClick")),Za.a.addHandler(this.CJ,Ha.a.Vf,Object(r.a)(this,this.lph,"onSaveToAnotherLocationKeyDown")))}Qsi(v,S){let ma;ma=!1;const Ja=document.getElementById("currentLocation");Ja.innerText="";const Va=this.Ilg(Ja,v),wb=this.Ilg(Ja,S);let Sb=255,vc=255;255<Va+wb&&(Sb=Math.max(238,408-Va),vc=Math.max(170,408-wb),ma=!0);this.fwi(Ja,v,vc,S,Sb);return ma}Ilg(v,S){const ma=document.createElement("div");
ma.innerText=S;ma.style.visibility="hidden";v.appendChild(ma);S=ma.clientWidth;v.removeChild(ma);return S}fwi(v,S,ma,Ja,Va){S&&(this.xJf(v,S,ma),this.Vvi(v));Ja&&this.xJf(v,Ja,Va)}xJf(v,S,ma){const Ja=document.createElement("div");Ja.innerText=S;Ja.title=S;Ja.className="SaveToAnotherFolderBreadcrumb";Ja.style.maxWidth=ma.toString()+"px";v.appendChild(Ja)}Vvi(v){const S=document.createElement("span");S.id="FolderSeparator";const ma=document.createElementNS("http://www.w3.org/2000/svg","svg");ma.setAttribute("class",
"SeparatorCaret");const Ja=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ja.setAttribute("points","1 4 1 11 5 7.5");ma.appendChild(Ja);S.appendChild(ma);v.appendChild(S)}yJf(v,S,ma){ma=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ma);S&&(S.innerText=ma);v.tabIndex=0;v.setAttribute(na.a.Ff,na.a.jx)}Ssi(v){const S=document.createElement("span");S.id="anotherFolderText";S.innerText=this.cMi;S.className="AnotherFolderTextSpan";v.appendChild(S)}Aui(v){const S=
document.createElement("span");S.className="cui-img-cont-float cui-img-16by16 ";this.wQa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.wQa.setAttribute("class","FolderIconSVG");const ma=document.createElementNS("http://www.w3.org/2000/svg","path");ma.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.wQa.appendChild(ma);S.appendChild(this.wQa);v.appendChild(S)}lph(v){!v||v.keyCode!==
da.a.Mp&&v.keyCode!==da.a.MUb||this.DVe(v)}DVe(){if(this.WW){const v=hc.a.AR(w.AFrameworkApplication.fileName);let S=this.WW.value;this.hide();S&&""!==S&&""!==v||1===this.za.state?(""!==v&&(S+=v),this.Hbg(S)?this.TB.create().uw(1,S,!1):this.I0b.start(S,this.wki)):this.TB.create().uw(2,S,!1)}}lRi(v){this.CJ&&this.wQa&&(v?(this.CJ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.CJ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.wQa,"DisabledFolderIconSVG")):(this.CJ.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.CJ,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.wQa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.CJ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.wQa,"DisabledFolderIconSVG"))))}Hme(){super.Hme();this.lRi(!!this.WW&&""!==this.WW.value)}dispose(){this.CJ&&(Za.a.removeHandler(this.CJ,Ha.a.click,Object(r.a)(this,this.DVe,"onSaveToAnotherLocationClick")),Za.a.removeHandler(this.CJ,Ha.a.Vf,Object(r.a)(this,this.lph,"onSaveToAnotherLocationKeyDown")),this.CJ=
null);super.dispose()}}Object(k.a)(bi,"FileNameDialog",Eh,[292]);var Og=d(1268),Ki=d(1267),sk=d(946),kk=d(214);class Nj{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(k.a)(Nj,"SaveAsDialogInput",null,[]);class rl{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(k.a)(rl,"SaveLocation",null,[]);var cj=d(89);class bh{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd){this.cQd=null;this.LL="";this.Dzj=()=>{const od=
new ca.a;od.add(this.Byj());const Vd=this.DMj();Vd&&od.addRange(Vd);return Object.assign(new Nj,{enableMoreLocations:!w.AFrameworkApplication.fa.getBooleanAppSetting("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.LL,extension:hc.a.AR(this.lG.iy),saveLocations:od.toArray(),scenario:"SaveToSharePoint"})};this.I0b=v;this.TB=S;this.yk=gd;this.CDa=ma;this.oi=Va;this.lG=Ja;this.h9a=Sb;this.eub=vc;wb&&(this.cQd=new Ie.a(()=>new aj.a(wb.value,null)))}Byj(){const v=new Og.a(Ki.a.gl());v.$("type",
"currentHost");return Object.assign(new rl,{folderName:this.lG.breadcrumbFolderName,friendlyPath:this.lG.breadcrumbBrandName,properties:v})}rqk(v){return!!v&&"ClassicMru"===v.type&&!!v.service_info&&!!v.service_info.service_id&&-1!==v.service_info.service_id.indexOf("SHAREPOINT")}DMj(){if(!this.cQd||!this.h9a)return null;var v=this.cQd.value.Gi("SaveAsToSharePointDialog",!1);if(!v||3!==v.state||!v.pih)return null;v=v.pih;const S=new ca.a;let ma=0,Ja=0;for(var Va=0;Va<v.length;Va++){var wb=v[Va];if(!this.rqk(wb))continue;
ma++;if(!wb.sharepoint_info)continue;const Sb=wb.url,vc=wb.sharepoint_info.site_url,gd=wb.title;wb=sk.b(wb,w.AFrameworkApplication.isRtl);if(!(Sb&&vc&&gd&&wb))continue;Ja++;const od=new Og.a(Ki.a.gl());od.$("type","SharePoint");od.$("siteUrl",vc);od.$("folderUrl",Sb);Ja++;S.add(Object.assign(new rl,{folderName:gd,friendlyPath:wb,properties:od}))}Va=new Map;Va.set("NumPlaces",v.length.toString());Va.set("NumSharepointPlaces",ma.toString());Va.set("placesWithMetadata",Ja.toString());Ig.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",
0,"smartfio",Va);0<ma&&(Ja?.5>1*Ja/ma&&Ig.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ig.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return S}Czj(){const v={};v.inputPropsCallback=this.Dzj;return v}Rla(v){this.LL=v;this.LL||(this.LL=String.format(CommonUIStrings.l_SaveACopy_Filename,hc.a.dI(this.lG.iy)));v={["id"]:"SaveAsDialog",["bodyControls"]:this.Czj()};let S=CommonUIStrings.L_SaveAs;
2===this.oi.mb.Ej&&(S=CommonUIStrings.L_SaveACopy);const ma=new Kc.a(!1,!1,!0);ma.Fd=1;ma.Fg="SaveAsDialog";ma.Te(1,CommonUIStrings.l_SaveButtonLabel);ma.Vj(S,Object(r.a)(this,this.MJl,"saveAsDialogHandler"),v)}U0l(v,S){v&&""!==v&&""!==S||1===this.oi.state?this.qqk()?this.Xxk(v,S):(""!==S&&(v+=S),this.I0b.start(v,this.yk)):(n.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.TB.create().uw(2,v,!1))}Xxk(v,S){Ig.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const ma=this.eub.J7d(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.eub.U_c(ma).then(Ja=>{if(Ja&&0<Ja.length){const Va=Ja[0][fe.a.Ofl];Ja=Ja[0][fe.a.KXe];if(""!==Va&&""!==Ja)this.h9a.s_(Ja,v+S,Va,this.yk),Ig.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.TB.create().uw(0,v,!1);const wb=kk.a.Yz();wb&&(wb.set("SiteUrlAvailable",""===Va?"false":"true"),wb.set("FolderUrlAvailable",""===Ja?"false":
"true"));Ig.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new cj.a,{extendedProperties:wb}))}}else this.TB.create().uw(0,v,!1),Ig.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ja=>{"Canceled"===Ja?((Ja=kk.a.Yz())&&Ja.set("IsCanceled","true"),Ig.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new cj.a,{extendedProperties:Ja}))):Ig.Health.instance.recordKpiFailure("SaveACopySFP",
Ja,!1,!1,null)})}qqk(){return this.eub?this.eub.Gxe():(n.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}MJl(v,S){if(S&&1===v){v=S.fileName;var ma=hc.a.AR(this.lG.iy);S.moreLocationsSelected&&this.U0l(v,ma);if(S.locationCallback){var Ja=S.locationCallback();Ja?Ja.properties&&"currentHost"===Ja.properties.ga("type")?this.CDa.s_(v+ma,!1,this.yk):Ja.properties&&"SharePoint"===Ja.properties.ga("type")?(S=Ja.properties.ga("siteUrl"),Ja=Ja.properties.ga("folderUrl"),this.h9a.s_(Ja,
v+ma,S,this.yk)):n.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):n.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else n.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(k.a)(bh,"ReactSaveAsDialog",null,[292]);class vi{constructor(v,S,ma,Ja,Va,wb,Sb,vc=null,gd=null,od=null){this.Ca=S;this.La=v;this.Zca=Ja;this.CDa=wb;this.TB=Va;this.oi=ma;this.LEf=Sb;this.nii=vc;this.h9a=gd;this.eub=od}create(v){return this.oi&&this.oi.mb.SD?new bh(this.LEf,
this.TB,this.CDa,w.AFrameworkApplication.Qu,this.oi,this.nii,this.h9a,this.eub,v):new bi(this.La,this.Ca,this.oi,this.Zca,this.TB,this.CDa,this.LEf,v)}}Object(k.a)(vi,"FileNameDialogFactory",null,[251]);class xh{constructor(v,S,ma,Ja){this.Go=this.dka=null;this.yGa=Va=>{this.Go||3!==Va.state||(this.Go=Va)};this.z6a=v;this.oi=ma;this.gli=Ja;this.Ija=new Ie.a(()=>new aj.a(S.value,this.yGa))}get EMb(){this.dka||(this.Ija.value.Gi("Save As",!0),this.Go&&this.Go.SS&&this.Go.SS.length&&(this.dka=this.oje(this.Go.SS)));
return this.dka}start(v){if(!this.EMb)if(w.AFrameworkApplication.breadcrumbFolderUrl&&w.AFrameworkApplication.breadcrumbFolderUrl.length)this.dka=w.AFrameworkApplication.breadcrumbFolderUrl;else return n.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Go),!1;const S=this.gli();S.iaf();const ma=S.Gje();if(!ma)return n.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.z6a.start((Ja,Va)=>{S.hide();v(Ja,Va)},()=>{this.OTe(S)},ma,this.dka);return!0}OTe(v){v.hide();n.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}oje(v){v=v.toLowerCase();v.endsWith("/")||(v+="/");const S=v.indexOf("/documents/");return-1!==S?v.substring(0,S+1)+"_layouts/15/onedrive.aspx":""}}Object(k.a)(xh,"OneDriveFilePickerHelper",null,[250]);class hh extends Kc.a{constructor(){super()}iaf(){this.ZEc="FilePickerDialog";this.Wg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Fg="PickerDialog-MsoSp";this.showDialog("",null)}Gje(){return document.getElementById("FilePickerDiv")}IB(){}Uba(){}}Object(k.a)(hh,"PickerDialog",Kc.a,[245]);var zf=d(493);class Yh{constructor(v,S,ma,Ja,Va,wb,Sb){this.La=v;this.HLd=ma;this.Ca=S;this.I0b=Ja;this.z6a=Va;this.eSd=wb;this.Xai=Sb}qb(){const v=this.z6a.vBb();v?Ee.a.vy||this.La.getBooleanAppSetting("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.pa(F.a.inb,E.a.frame,Object(r.a)(this,this.qJh,"saveToSharePointActionDispatcher"),
64):(v.rIa.continueWith(S=>{S.Pm&&this.z6a.WUe(S)}),this.VQc()):n.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}VQc(){Od.a.Mud(Object(r.a)(this,this.qJh,"saveToSharePointActionDispatcher"));Od.a.V8b([new zf.a(F.a.inb,E.a.frame,0)],this.z6a.vBb())}get hFb(){return this.La.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")}get XUf(){return this.La.getBooleanAppSetting("UserCanWriteRelative")}qJh(v,S,ma,Ja,Va){return S.contextId!==E.a.frame||v!==
F.a.inb?2:this.hFb&&(this.eSd.EMb||this.XUf)?1===ma?D.SessionStatusManager.instance.Oma||w.AFrameworkApplication.TR?8:this.Xai()?32:8:2===ma?(n.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Va&&Va.SaveEntryPoint&&"VersionHistory"===Va.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.XUf?(n.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.HLd.create(Va).Rla(null)):(n.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.I0b.start(null,Va)),32):8:8}}Object(k.a)(Yh,"SaveToSharePointActor",null,[]);class Oa{constructor(v,S,ma,Ja){this.yk=this.wAf=null;this.h9a=v;this.TB=S;this.eSd=ma;this.oi=Ja}start(v,S){n.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.wAf=v;this.yk=S;this.eSd.start((ma,Ja)=>{this.processResponse(ma,Ja)})||this.jaf()}processResponse(v,S){v?this.uu(S):this.wA(S)}jaf(){1!==this.oi.state&&this.TB().vFa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}uu(v){n.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(v&&v.data&&v.data.value&&v.data.value.length&&v.data.value[0].sharePoint){const S=v.data.value[0].sharePoint.url;v=v.data.value[0].sharePoint.listUrl;let ma=null;if(S&&(ma=v?this.OMj(v):this.NMj(S))){this.h9a.s_(S,this.wAf,ma,this.yk);return}n.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!S,!ma)}n.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.jaf()}NMj(v){v.endsWith("/")||(v+="/");let S=0;for(let ma=0;ma<v.length;ma++)if("/"===v.charAt(ma)&&5===++S)return v.substr(0,ma);return null}OMj(v){v.endsWith("/")&&(v=v.substring(0,v.length-1));const S=v.lastIndexOf("/");return-1!==S?v.substring(0,S):null}wA(v){n.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");v&&v.error?n.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",v.error.errorCode,v.error.message):n.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.jaf()}}Object(k.a)(Oa,"SaveToSharePointManager",null,[1286]);class sb{constructor(v,S,ma,Ja,Va,wb,Sb,vc){this.HDa=v;this.LL=S;this.dsb=Ja;this.tTd=wb;this.lsa=ma;this.Foi=Va;this.vCa=Sb;this.yk=vc}execute(v,S){if(!w.AFrameworkApplication.Dh&&w.AFrameworkApplication.Me){var ma=this.HDa+this.vCa;ma=Hc.a.Xi(ma,"fu",hc.a.We(this.lsa));ma=Hc.a.Xi(ma,"su",hc.a.We(this.Foi));ma=Hc.a.Xi(ma,"fn",hc.a.We(this.LL));ma=Hc.a.Xi(ma,"n",hc.a.We((new Date).getTime().toString()));
this.yk&&this.yk.FileDownloadUrl&&(ma=Hc.a.Xi(ma,"furl",hc.a.We(this.yk.FileDownloadUrl)));ma=ma+"&"+this.tTd;this.dsb&&this.dsb.length?ma=Hc.a.Xi(ma,"fnn",hc.a.We(this.dsb)):n.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");n.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");w.AFrameworkApplication.Me.Tj(ma,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,v,S,null,void 0,void 0,void 0,void 0,"9")}}}Object(k.a)(sb,"SharePointSaveAsCaller",
null,[1308]);class Pb{constructor(v){this.mta=v.appSettings.SaveAsToHostWebServiceBase;this.LL=v.appSettings.FileName;this.vCa=v.Ea("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(v,S,ma,Ja){return new sb(this.mta,this.LL,v,S,ma,w.AFrameworkApplication.mh,this.vCa,Ja)}}Object(k.a)(Pb,"SharePointUploadCallerFactory",null,[1285]);var kc=d(504);class Wc{constructor(v,S,ma,Ja,Va){this.Jo=this.XVb=null;this.MHd=!1;this.DUd=this.lsa=null;this.GXd=S;this.Isa=ma;this.TB=Ja;this.oi=Va;this.Ca=
v}s_(v,S,ma,Ja){this.MHd=!1;n.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Yyc();this.lsa=v;Ja&&Ja.SaveEntryPoint&&(this.DUd=Ja.SaveEntryPoint);this.XVb=this.GXd.create(v,S,ma,Ja);Ja&&"true"===Ja.SkipSaveToHost?this.f5():this.Fqj()}Fqj(){const v=()=>{n.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.f5()};32!==this.Ca.Ia(F.a.R2a,2,[()=>{n.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.f5()},v])&&v()}f5(){n.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.XVb.execute(Object(r.a)(this,this.n9k,"onSaveToSharePointUploadFinished"),Object(r.a)(this,this.m9k,"onSaveToSharePointUploadFailed"))}n9k(v){if(v&&v.data&&v.data.Ud){var S;if(({Ev:S}=Ag.d(v.data.Ud)).returnValue)if(S.StatusCode!==Fe.a.Zw&&S.StatusCode!==Fe.a.c7b)n.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
v.data.status,S.StatusCode),S.StatusCode!==Fe.a.UFh&&this.L6f(v.data.status)||(this.Yza(S.StatusCode.toString()),this.X_l(S.StatusCode));else{n.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.n4e();try{S.NewDocumentUrl?this.mmb(S.NewDocumentUrl):this.nmb()}catch(ma){n.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ma.toString())}}else n.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Pf.a.oBc(v.data.Ud)}),
this.LVc()||(this.Yza("Failed to deserialize response"),this.Wyc())}else n.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.LVc()||(this.Yza("Unknown"),this.Wyc())}m9k(v){v&&v.data?this.L6f(v.data.status)||(n.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Yza(kc.a[v.data.status]),this.Wyc()):(n.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.LVc()||(this.Yza("Unknown"),this.Wyc()))}LVc(){if(!this.MHd)return n.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.MHd=!0,this.f5(),!0;n.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}L6f(v){n.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",v);return this.LVc()}nmb(){n.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Cd.a.qo(this.lsa,Cd.a.Vca(3),void 0,"UploadToSharePointManager.RedirectToFolder")}mmb(v){let S=!1,ma=!1;w.AFrameworkApplication.fa&&(S=w.AFrameworkApplication.fa.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),
ma=w.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",v,S);if(S&&ma){n.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ja={};Ja[fe.a.WOb]="1";Ja[fe.a.documentUrl]=v;Ja[fe.a.reason]=ig.a.$5e;w.AFrameworkApplication.WU().execute(Va=>{Va.sendMessage(Qe.a.yFa,Ja)})}else Cd.a.qo(v,Cd.a.Vca(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Yyc(){this.oi&&
1===this.oi.state||(this.Jo=this.Isa(),this.Jo.message=CommonUIStrings.l_CommentProgressTooltip,this.Jo.Fd=5,this.Jo.Is=!1,this.Jo.fra(CommonUIStrings.l_DefaultDialogTitle,null,null))}Iab(){this.Jo&&(this.Jo.close(),this.Jo=null)}Wyc(){this.zu(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Y0l(){this.zu(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}e0l(){const v=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.zu(CommonUIStrings.l_SaveAsFileTooLargeTitle,v,Uf.a.NJl)}zu(v,S,ma=Uf.a.RJl){n.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",v,S);this.Iab();1!==this.oi.state&&this.TB().m6f(v,S,ma)}X_l(v){n.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",v);switch(v){case Fe.a.L0h:this.Y0l();break;case Fe.a.UFh:this.e0l();break;default:this.Wyc()}}n4e(){"VersionHistory"===this.DUd&&this.Ca.nb(F.a.Ovd,2)}Yza(v){"VersionHistory"===this.DUd&&this.Ca.Ia(F.a.o4e,
2,{["FailureReason"]:v})}}Object(k.a)(Wc,"UploadToSharePointManager",null,[1284]);class Xd{constructor(){this.SRa=this.gRd=this.aRd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}fc(v){this.Da=v;this.aRd=Ye.a.Au(v.Ha("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.gRd=Ye.a.Au(v.Ha("Common.IEventEmitter<Common.IMruResult>"));this.SRa=Ye.a.Au(v.Ha("Common.App.SharedFilePicker.ISharedFilePicker"));je.Task.WAA.call(null,this.aRd,this.gRd,this.SRa).continueWith(()=>
{this.Avl()})}Avl(){this.Da.register(Pb,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").na(()=>new Pb(w.AFrameworkApplication.fa)).ma();this.Da.register(Wc,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").na(()=>new Wc(w.AFrameworkApplication.Pa,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Qf.a).create(),()=>new rh,
w.AFrameworkApplication.za)).ma();this.Da.register(Oa,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").na(()=>new Oa(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new rh,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),w.AFrameworkApplication.za)).ma();this.Da.register(xh,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").na(()=>
new xh(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Ie.a(()=>this.aRd.result),w.AFrameworkApplication.za,()=>new hh)).ma();this.Da.register(vi,"Common.App.SaveToSharePoint.FileNameDialogFactory").na(()=>new vi(w.AFrameworkApplication.fa,w.AFrameworkApplication.Pa,w.AFrameworkApplication.za,w.AFrameworkApplication.za.mb,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Ie.a(()=>this.gRd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.SRa?this.SRa.result:null)).ma();this.Da.register(Yh,"Common.App.SaveToSharePoint.SaveToSharePointActor").na(()=>new Yh(w.AFrameworkApplication.fa,w.AFrameworkApplication.Pa,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>w.AFrameworkApplication.za.fRc)).ma();w.AFrameworkApplication.fa.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").qb()}static main(){e.a.instance.Ac(new Xd)}}Object(k.a)(Xd,"PackageManager",null,[2,3]);class Gd extends Ya.StandardDialog{constructor(){super();this.Fd=0;this.Te(1,CommonUIStrings.l_DialogClose)}uw(v){this.Kz(v,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(k.a)(Gd,"ErrorDialog",Ya.StandardDialog,[1291]);class Pe{}Pe.default=0;Object(k.a)(Pe,"SaveToCloudErrorCodes",null,[]);class Lf{}Lf.S2a="SaveToCloudStorage";Lf.Q2a="SaveACopy";Object(k.a)(Lf,"SaveToCloudStorageConstants",null,[]);class Nf{constructor(v,S,ma,Ja,Va,wb){this.yk=null;this.xoi=v;this.Oda=S;this.Yub=ma;this.La=Ja;this.Sqb=Va;this.TB=wb}start(v){this.yk=v;var S=null!==this.yk&&this.yk.hasOwnProperty("SaveEntryPoint")&&this.yk.SaveEntryPoint.toString()===
Lf.S2a;if("SharePointOnlineConsumer"===this.La.Ea("FileSource")){const ma=C.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ma){ma.start(null,v);return}}this.Oda.gue?(v=Object(N.a)(String,w.AFrameworkApplication.ld.Host),w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej&&S&&("Open From URL"===v||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))?(n.ULS.sendTraceTag(508852051,
216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.Yub.s_("root","https://onedrive.live.com",null,this.yk)):(n.ULS.sendTraceTag(6590559,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej?15:50,"User is signed in. We will show file picker."),this.jPi())):(n.ULS.sendTraceTag(6590560,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej?15:50,"User is not signed in. We will show sign in dialog."),
this.E1l())}E1l(){this.xoi.create().Rla()}zu(){this.TB().uw(Pe.default)}jPi(){try{n.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let v={["client_id"]:this.La.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.Sqb||2===this.Sqb)v={["client_id"]:this.La.appSettings.UploadToSkyDriveClientId};WL.init(v);n.ULS.sendTraceTag(6590562,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej?15:50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(r.a)(this,this.uu,"onSuccess"),Object(r.a)(this,this.wA,"onFailure"))}catch(v){n.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",v,v.stack),this.zu()}}uu(v){n.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");v&&v.data&&v.data.folders&&this.Yub.s_(v.data.folders[0].id,v.data.folders[0].urls.viewInBrowser,null,this.yk)}wA(v){if(v&&v.error){if("user_canceled"===
v.error.code){n.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}n.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",v.error.code,v.error.message)}else n.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.zu()}}Object(k.a)(Nf,"SaveToCloudManager",null,[1290]);class dg{constructor(v,S,ma,Ja){this.HKc=null;this.lni=v;this.La=ma;this.sBf=S;this.Tyf=new re.a;this.Di=Ja}hFb(){return this.La.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")}Gfg(){return F.a.S2a}VQc(){Od.a.Mud(Object(r.a)(this,
this.nJh,"saveToCloudActionDispatcher"));Od.a.V8b([new zf.a(F.a.S2a,E.a.frame,0)],this.sBf.vBb())}qb(){const v=this.sBf.vBb();v?(v.u9(()=>{this.Tyf.Jg(!0)}),this.VQc()):n.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}TAh(){n.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}nJh(v,S,ma,Ja,Va){Ja="";switch(v){case F.a.S2a:Ja=Lf.S2a;break;case F.a.Q2a:Ja=Lf.Q2a;break;default:n.ULS.sendTraceTag(508372377,216,50,"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}return S.contextId!==
E.a.frame||v!==this.Gfg()?2:this.hFb()?1===ma?D.SessionStatusManager.instance.Oma||w.AFrameworkApplication.TR?8:32:2===ma?(this.TAh(),Va&&w.AFrameworkApplication.fa.getBooleanAppSetting("EntryPoint_SaveToCloudStorage")&&(Va.SaveEntryPoint=Ja),Va&&Va.FileDownloadUrl&&n.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Di&&(this.HKc=this.Di.lj("DialogShown","SaveToOneDriveReponseTime")),this.Tyf.task.continueWith(()=>{this.HKc&&(this.HKc.stop(),this.HKc=null);
this.lni.start(Va)}),32):8:8}}Object(k.a)(dg,"SaveToCloudStorageActor",null,[1289]);var Pg=d(205);class pi extends Ya.StandardDialog{constructor(v,S,ma){super();this.Yak=Ja=>{0===Ja?(n.ULS.sendTraceTag(6590598,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej?15:50,"User dismissed SignIn Dialog."),this.hide()):this.Crd()};this.Lph=()=>{this.UR&&this.hide();n.ULS.sendTraceTag(7143885,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===
w.AFrameworkApplication.za.mb.Ej?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ca.nb(F.a.S2a,2)};this.Ca=v;this.Oda=S;this.Zca=ma;this.bX=!1;this.Fd=1;this.uAa(1);this.Te(1,CommonUIStrings.l_SignIn);this.Te(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}Rla(){this.Oda.nLf(this.Lph);this.Ky(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.Yak)}yRi(){let v="2";if(this.Zca)switch(this.Zca.Ej){case 3:v="0";break;case 2:v=
"3";break;case 1:v="1"}return v}hide(){this.Oda.vAl(this.Lph);super.hide()}Crd(){var v=w.AFrameworkApplication.fa.getBooleanAppSetting("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";v=new Pg.QueryStringBuilder(v);v.zg("prompt","1");v.zg("cbcxt",this.yRi());w.AFrameworkApplication.qSa(v);Cd.a.qo(v.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(k.a)(pi,"SignInDialog",Ya.StandardDialog,[1310]);class li{constructor(v,S,ma){this.Ca=v;this.Oda=S;this.Zca=ma}create(){return new pi(this.Ca,
this.Oda,this.Zca)}}Object(k.a)(li,"SignInDialogFactory",null,[1288]);class Ri{constructor(v,S,ma,Ja,Va,wb,Sb){this.HDa=v;this.LL=S;this.dsb=ma;this.fGc=Ja;this.tTd=Va;this.vCa=wb;this.yk=Sb}execute(v,S){if(!w.AFrameworkApplication.Dh&&w.AFrameworkApplication.Me){var ma=this.HDa+this.vCa;ma=Hc.a.Xi(ma,"fo",hc.a.We(this.fGc));ma=Hc.a.Xi(ma,"fn",hc.a.We(this.LL));ma=Hc.a.Xi(ma,"qs",hc.a.We(this.tTd));ma=Hc.a.Xi(ma,"n",hc.a.We((new Date).getTime().toString()));this.yk&&this.yk.FileDownloadUrl&&(ma=Hc.a.Xi(ma,
"furl",hc.a.We(this.yk.FileDownloadUrl)));this.dsb&&(ma=Hc.a.Xi(ma,"fnn",hc.a.We(this.dsb)));w.AFrameworkApplication.Me.Tj(ma,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,v,S,null)}}}Object(k.a)(Ri,"SkyDriveUploadCaller",null,[1309]);class Ih{constructor(v){this.La=v;this.mta=v.appSettings.SkyDriveUploadWebServiceBase;this.LL=v.appSettings.FileName;this.vCa=v.Ea("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(v,S,ma){return new Ri(this.mta,this.LL,S,v,w.AFrameworkApplication.mh,
this.vCa,ma)}}Object(k.a)(Ih,"SkydriveUploadCallerFactory",null,[1287]);class ij{constructor(v,S,ma,Ja,Va){this.lsa=this.Jo=this.XVb=null;this.e4=!1;this.yk=this.BDa=null;this.GXd=v;this.Isa=S;this.TB=ma;this.oi=Ja;this.Di=Va}Yyc(){this.oi&&1===this.oi.state||(this.Jo=this.Isa(),this.Jo.message=CommonUIStrings.l_CommentProgressTooltip,this.Jo.Fd=5,this.Jo.Is=!1,this.Jo.fra(CommonUIStrings.l_DefaultDialogTitle,null,null))}Iab(){this.Jo&&(this.Jo.close(),this.Jo=null)}q_(){1!==w.AFrameworkApplication.za.state&&
this.TB().uw(Pe.default)}nmb(){n.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Cd.a.qo(this.lsa,Cd.a.Vca(3),void 0,"UploadToCloudManager.RedirectToFolder")}mmb(v){var S=null!==this.yk&&this.yk.hasOwnProperty("SaveEntryPoint")&&this.yk.SaveEntryPoint.toString()===Lf.S2a;w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej&&S&&(v+="&wdsvodm=true");let ma=S=!1;w.AFrameworkApplication.fa&&(S=w.AFrameworkApplication.fa.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),
ma=w.AFrameworkApplication.fa.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(6654163,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",v,S);if(S&&ma){n.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ja={};Ja[fe.a.WOb]="1";Ja[fe.a.documentUrl]=v;w.AFrameworkApplication.WU().execute(Va=>{Va.sendMessage(Qe.a.yFa,
Ja)})}else Cd.a.qo(v,Cd.a.Vca(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}s_(v,S,ma=null,Ja=null){n.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Di&&(this.BDa=this.Di.lj("DialogShown","SaveToOneDriveUploadTime"));this.Yyc();this.lsa=S;this.XVb=this.GXd.create(v,ma,Ja);this.yk=Ja;this.f5()}f5(){n.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.XVb.execute(Object(r.a)(this,this.l9k,"onSaveToCloudUploadFinished"),Object(r.a)(this,this.k9k,"onSaveToCloudUploadFailed"))}l9k(v){this.Iab();
this.e4=!1;if(v&&v.data&&v.data.Ud){var S;if(({Ev:S}=Ag.d(v.data.Ud)).returnValue)if(v=S,v.StatusCode!==Fe.a.Zw&&v.StatusCode!==Fe.a.c7b)n.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.q_();else{n.ULS.sendTraceTag(6590603,216,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb&&1===w.AFrameworkApplication.za.mb.Ej?15:50,"UploadToCloudManager upload success.");try{v.NewDocumentUrl&&""!==v.NewDocumentUrl?this.mmb(v.NewDocumentUrl):this.nmb()}catch(ma){n.ULS.sendTraceTag(37025728,
216,15,"Redirect failed with exception: {0}",ma.toString())}this.Gsc()}else n.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Pf.a.oBc(v.data.Ud)}),this.q_()}else n.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.q_()}k9k(v){5!==v.data.status&&12!==v.data.status||this.e4?(n.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",v.data.status),this.Iab(),this.q_(),this.Gsc()):(n.ULS.sendTraceTag(6590604,
216,10,"UploadToCloudManager failure. Retrying."),this.e4=!0,this.f5())}Gsc(){this.BDa&&(this.BDa.stop(),this.BDa=null)}}Object(k.a)(ij,"UploadToCloudManager",null,[1280]);class Fi{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){w.AFrameworkApplication.fa.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")&&this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").qb()}dispose(){}fc(v){this.Da=v;this.Da.register(li,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").na(()=>
new li(w.AFrameworkApplication.Pa,qf.a.instance,w.AFrameworkApplication.za.mb)).ma();this.Da.register(Ih,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").na(()=>new Ih(w.AFrameworkApplication.fa)).ma();this.Da.register(dg,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").na(()=>new dg(v.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),v.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
w.AFrameworkApplication.fa,w.AFrameworkApplication.za.DW)).ma();this.Da.register(ij,"Common.App.SaveToCloudStorage.UploadToCloudManager").na(()=>new ij(v.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Qf.a).create(),()=>new Gd,w.AFrameworkApplication.za,w.AFrameworkApplication.za.DW)).ma();this.Da.register(Nf,"Common.App.SaveToCloudStorage.SaveToCloudManager").na(()=>new Nf(v.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),qf.a.instance,v.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
w.AFrameworkApplication.fa,w.AFrameworkApplication.RUa,()=>new Gd)).ma()}static main(){e.a.instance.Ac(new Fi)}}Object(k.a)(Fi,"PackageManager",null,[2,3]);class Da{static get Wg(){return Kc.a.oC(Da.Hq,CommonUIStrings.l_SaveACopyFileName)}}Da.Hq="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(k.a)(Da,"FileNameDialogHtml",null,[]);class Wa extends Kc.a{constructor(v,S,ma,Ja){super();this.fGc=this.lsa=null;this.Ca=v;this.Zca=S;this.Yub=ma;this.Te(1,CommonUIStrings.l_SaveButtonLabel);this.Wg=Da.Wg;this.Fg="FileNameDialog-SaveACopy";this.yk=Ja}Rla(v,S,ma){this.fGc=v;this.lsa=ma;v={["txtFileName"]:hc.a.dI(w.AFrameworkApplication.Qu.iy),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,S)};this.Vj(CommonUIStrings.l_SaveToOneDrive,Object(r.a)(this,this.WXc,"fileNameDialogHandler"),
v);n.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}WXc(v,S){1!==v?n.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(v=S.txtFileName.trim(),n.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),S=hc.a.AR(w.AFrameworkApplication.fileName),v&&""!==v&&""!==S&&(v+=S),this.Yub.s_(this.fGc,this.lsa,v,this.yk))}}Object(k.a)(Wa,"FileNameDialog",Kc.a,
[1311]);class lb{constructor(v,S,ma){this.Ca=v;this.Zca=S;this.Yub=ma}create(v){return new Wa(this.Ca,this.Zca,this.Yub,v)}}Object(k.a)(lb,"FileNameDialogFactory",null,[1293]);class Lb extends Ya.StandardDialog{constructor(v){super();this.i5e=S=>{1===S?(n.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.nb(F.a.Q2a,2)):n.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Fd=1;this.Te(1,CommonUIStrings.l_RetryButtonLabel);this.Te(0,CommonUIStrings.l_DialogClose);
this.Ca=v}uw(v){n.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",v);this.Kz(v,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.i5e)}}Object(k.a)(Lb,"RetryDialog",Ya.StandardDialog,[1291]);class oc extends dg{constructor(v,S,ma,Ja){super(v,S,ma,Ja);this.pki=S}hFb(){return this.La.getBooleanAppSetting("SaveACopyBrsIsEnabled")}Gfg(){return F.a.Q2a}VQc(){Od.a.Mud(Object(r.a)(this,this.nJh,"saveToCloudActionDispatcher"));Od.a.V8b([new zf.a(F.a.Q2a,E.a.frame,
0)],this.pki.vBb())}TAh(){w.AFrameworkApplication.F1("CreateCopy_cf;CreateCopy_tf");n.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(k.a)(oc,"SaveACopyActor",dg,[]);class Jc extends Nf{constructor(v,S,ma,Ja,Va,wb,Sb){super(S,ma,Ja,Va,wb,Sb);this.hei=v}uu(v){v&&v.data&&v.data.folders?(n.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.hei.create(this.yk).Rla(v.data.folders[0].id,v.data.folders[0].name,v.data.folders[0].urls.viewInBrowser)):
(n.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.zu())}wA(v){v&&v.error&&"user_canceled"===v.error.code&&n.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.wA(v)}zu(){n.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.zu()}}Object(k.a)(Jc,"SaveACopyManager",Nf,[]);class bd extends ij{constructor(v,S,ma,Ja,Va,wb){super(S,ma,Ja,Va,wb);this.Ca=v}vxe(){return!!this.yk&&!!this.yk.SaveEntryPoint&&
"VersionHistory"===this.yk.SaveEntryPoint.toString()}q_(){n.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.vxe()&&this.Ca.Ia(F.a.o4e,2,{["FailureReason"]:"Unknown"});super.q_()}nmb(){n.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.vxe()&&this.Ca.nb(F.a.Ovd,2);super.nmb()}mmb(v){n.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",v);this.vxe()&&this.Ca.nb(F.a.Ovd,2);super.mmb(v)}f5(){this.yk&&"true"===this.yk.SkipSaveToHost?
super.f5():32!==this.Ca.nb(F.a.R2a,1)?(n.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.f5()):this.Ca.Ia(F.a.R2a,2,[()=>{n.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");ij.prototype.f5.call(this)},()=>{n.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.q_()}])}}Object(k.a)(bd,"SaveACopyUploadToCloudManager",ij,[]);class rd{constructor(){this.Da=
null;this.Pn=()=>{w.AFrameworkApplication.fa.getBooleanAppSetting("SaveACopyBrsIsEnabled")&&this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").qb()}}get name(){return"Common.App.SaveACopy"}init(){w.AFrameworkApplication.fa.Ue(this.Pn)}dispose(){}fc(v){this.Da=v;this.Da.register(bd,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").na(()=>new bd(w.AFrameworkApplication.Pa,v.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Qf.a).create(),()=>new Lb(w.AFrameworkApplication.Pa),
w.AFrameworkApplication.za,w.AFrameworkApplication.za.DW)).ma();this.Da.register(lb,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").na(()=>new lb(w.AFrameworkApplication.Pa,w.AFrameworkApplication.za.mb,v.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(oc,"Common.App.SaveACopy.SaveACopyActor").na(()=>new oc(v.resolve("Common.App.SaveACopy.SaveACopyManager"),v.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
w.AFrameworkApplication.fa,w.AFrameworkApplication.za.DW)).ma();this.Da.register(Jc,"Common.App.SaveACopy.SaveACopyManager").na(()=>new Jc(v.resolve("Common.App.SaveACopy.FileNameDialogFactory"),v.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),qf.a.instance,v.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),w.AFrameworkApplication.fa,w.AFrameworkApplication.RUa,()=>new Lb(w.AFrameworkApplication.Pa))).ma()}static main(){e.a.instance.Ac(new rd)}}Object(k.a)(rd,"PackageManager",
null,[2,3]);var Zd=d(334);class ea{constructor(v){this.RZg=null;this.JNj=()=>{n.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.LNj=S=>{n.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");S=Ag.a(S.data.Ud).state+"";Zd.a.instance.setItem("AccountLinkedStatusCache",S)};n.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Umc=w.AFrameworkApplication.fa.Ea("PhoneLinkServiceEndpoint");
(this.pN=v)||n.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Umc&&this.Umc.length||n.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}nmj(v){v&&(this.Umc="https://dcg-df.microsoft.com/",n.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.mmj()}mmj(){n.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.RZg)n.ULS.sendTraceTag(527574722,
306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.RZg=new Date;var v=new Date;this.pN.vH("BayBridge",this.Umc).then(S=>{const ma=+new Date-+v;S.IsSuccess?(n.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ma),this.fmj(S.Token,this.vuj())):n.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
ma,S.ErrorCode,S.ErrorMessage)}).catch(S=>{n.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",S,+new Date-+v)})}}fmj(v,S){const ma={};ma.Authorization="Bearer "+v;ma["Authorization-Type"]="AAD";ma.Accept="application/json";ma["DCG-SessionId"]=w.AFrameworkApplication.userSessionId;w.AFrameworkApplication.Me.Tj(S,1,null,ma,!1,2,this.LNj,this.JNj,null,void 0,void 0,void 0,void 0,"39");pb.a("FetchAccountLinkedStatus")}Evj(){const v=Zd.a.instance.getItem("AccountLinkedStatusCache");
return v&&v.length?"true"===v.toLowerCase()?!0:!1:!1}vuj(){return this.Umc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(k.a)(ea,"PhoneLinkManager",null,[1237]);class Ka{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}fc(v){this.Da=v;this.Da.register(1237,"Common.App.PhoneLink.IPhoneLinkManager").ma().na(()=>new ea(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){w.AFrameworkApplication.fa.Ue(()=>{this.gHa()})}gHa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Ac(new Ka)}}
Object(k.a)(Ka,"PhoneLinkPackage",null,[2,3]);var bb;(function(v){v[v.wBm=0]="myFiles";v[v.recent=1]="recent";v[v.Ztm=2]="currentFolder";v[v.ZEm=3]="yourPhone"})(bb||(bb={}));Object(k.b)("SharedFilePickerLandingLocation",bb);class vb{constructor(v){this.Edb=this.YNb=null;this._initialized=!1;this.zoe=v}Jbe(v){this._initialized||(v.Bv(Qe.a.FAh),v.dD(Qe.a.FAh,Object(r.a)(this,this.I8k,"onReceivedPickerResponse")),this._initialized=!0)}U_c(v){return this.Edb=new Promise((S,ma)=>{const Ja={};Ja[fe.a.Nfl]=
v;this.YNb=(Va,wb)=>{""===wb?(n.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),S(Va)):("Canceled"===wb?n.ULS.sendTraceTag(572548164,306,50,wb):n.ULS.sendTraceTag(556901065,306,10,wb),ma(wb))};this.zoe.execute(Va=>{this.Jbe(Va);Va.sendMessage(Qe.a.mbl,Ja)})})}I8k(v){this.YNb(v.Values[fe.a.OLl],void 0===v.Values[fe.a.DXe]||null===v.Values[fe.a.DXe]?"":v.Values[fe.a.DXe])}Gxe(){return w.AFrameworkApplication.fa.getBooleanAppSetting("UiHostCommonFilePicker")}J7d(v,S,ma,Ja,Va,
wb,Sb,vc,gd=null){const od={};od[fe.a.yLl]=v;od[fe.a.titleText]=S;od[fe.a.aDi]=ma;od[fe.a.bDi]=Ja;od[fe.a.cDi]=Va;od[fe.a.Ecj]=!0;od[fe.a.Jmj]=wb;od[fe.a.Qfl]=Sb;od[fe.a.Pfl]=bb[vc];ef.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(od[fe.a.Rfl]="Dark");gd&&(null!=gd.Nvb&&(od[fe.a.Nvb]=gd.Nvb),null!=gd.WCb&&(od[fe.a.WCb]=gd.WCb));return od}}Object(k.a)(vb,"SharedFilePickerManager",null,[1277]);class Yb{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}fc(v){this.Da=
v;v.register(vb,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().na(()=>new vb(v.Ha("Postmessage.IHostPostmessenger")))}init(){w.AFrameworkApplication.fa.Ue(()=>{this.gHa()})}gHa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Ac(new Yb)}}Object(k.a)(Yb,"SharedFilePickerPackage",null,[2,3]);class Gc{constructor(v,S=3E4){this.Fam=9E5;this.Jam=1E4;this.sNg=this.ZIb=null;this.yCe=0;
this.y7b=Date.now;this.dQj=v;this.vDd=S;this.CZc()}cqg(v=!0){const S=this.y7b();if(S<this.yCe+this.Fam)return S>this.yCe+this.Jam&&this.CZc(),this.sNg;v&&this.CZc();return null}getToken(v=!0){return(v=this.cqg(v))?Promise.resolve(v):this.CZc()}CZc(){return this.ZIb=this.ZIb||new Promise(v=>{this.dQj().then(S=>{this.ZIb=null;""!==S&&S&&(this.sNg=S,this.yCe=this.y7b(),v(S));v(null)}).catch(()=>{this.ZIb=null;v(null)});window.setTimeout(()=>{this.ZIb=null;v(null)},this.vDd)})}}Object(k.a)(Gc,"OAuthCacheManager",
null,[]);class ud{constructor(){this.pN=null;this.gsf={};this.GTb=new Og.a(Ki.a.gl())}getToken(v,S){if(this.GTb.Ib(S))return this.GTb.ga(S).getToken();const ma=new Gc(()=>this.dqg(v,S));this.GTb.$(S,ma);return ma.getToken()}cQj(v,S){if(this.GTb.Ib(S))return this.GTb.ga(S).cqg();const ma=new Gc(()=>this.dqg(v,S));this.GTb.$(S,ma);return null}dqg(v,S){if(!this.pN)try{this.pN=C.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ma){n.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+
ma)}return this.pN?new Promise(ma=>{const Ja=Date.now();this.pN.vH(v,S).then(Va=>{const wb=Va.Token;!Va.IsSuccess||this.msk(wb)?(this.EQb("GetTokenInternalImplicitJS",!1,Date.now()-Ja,v,Va.ErrorCode,Va.ErrorMessage,S),ma(null)):(this.EQb("GetTokenInternalImplicitJS",!0,Date.now()-Ja,v,Va.ErrorCode,Va.ErrorMessage,S),ma(wb))}).catch(Va=>{Va=Va?Ag.c(Va):"";this.EQb("GetTokenInternalImplicitJS",!1,Date.now()-Ja,v,"Caught Exception",Va,S);ma(null)})}):new Promise(ma=>{this.EQb("GetTokenInternalImplicitJS",
!1,0,v,"Null OAuthManager","OAuthManager not set");ma(null)})}EQb(v,S,ma,Ja,Va="",wb="",Sb=""){var vc="Search"===Ja;const gd=[];v=Ud.a.W0(vc?"Event":"EventName",v,2);Ja=Ud.a.W0("AppName",Ja,2);Array.add(gd,v);Array.add(gd,Ja);vc&&(Ja=Ud.a.W0("LatencyType","FetchToken",2),Array.add(gd,Ja));Va&&""!==Va&&(Va=Ud.a.W0("ErrorCode",Va,2),Array.add(gd,Va));wb&&""!==wb&&(wb=Ud.a.W0("ErrorMessage",wb,2),Array.add(gd,wb));Sb&&""!==Sb&&(wb=!(Sb in this.gsf),this.gsf[Sb]=wb,wb=Ud.a.W0("WarmUpCall",wb.toString(),
1),Array.add(gd,wb),Sb=Ud.a.W0("Service",this.T1c(Sb),2),Array.add(gd,Sb));vc=vc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";S=Object.assign(new Ei.a,{name:vc,samplingPolicy:2,dataFields:gd,succeeded:S,durationMs:ma});y.a.sendActivityEvent(S)}T1c(v){return v===w.AFrameworkApplication.dBe?"Loki":v===w.AFrameworkApplication.zcf?"Substrate":w.AFrameworkApplication.fa&&v===w.AFrameworkApplication.fa.Ea("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}msk(v){return!v||
!v.length}}Object(k.a)(ud,"SearchOAuthManager",null,[1233]);class Nd{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}fc(v){this.Da=v;this.Da.register(1233,"Common.App.SearchCommon.ISearchOAuthManager").ma().na(()=>new ud)}init(){}dispose(){}static main(){e.a.instance.Ac(new Nd)}}Object(k.a)(Nd,"SearchOAuthPackage",null,[2,3]);var Bc;(function(v){v[v.Zrj=0]="generalException";v[v.invalidArgument=1]="invalidArgument";v[v.s0k=2]="notAllowed";v[v.wDi=3]="apiNotAvailable";v[v.sgm=
4]="unresolvedPendingRequest";v[v.timeout=5]="timeout";v[v.DYd=6]="adalTimeout";v[v.bmm=7]="userNotSignedIn";v[v.GFd=8]="userAborted";v[v.FSh=9]="silentSignInFailed";v[v.L5c=10]="invalidResourceUrl";v[v.Vyg=11]="invalidGrant";v[v.AZf=12]="connectionLost";v[v.CXf=13]="clientError";v[v.hca=14]="serverError"})(Bc||(Bc={}));Object(k.b)("ErrorCodes",Bc);class qe{}Object(k.a)(qe,"HostApplicationType",null,[]);class qg{constructor(v,S){this.requestCallback=this.requestParameters=null;this.requestParameters=
v;this.requestCallback=S}}Object(k.a)(qg,"OutstandingRequest",null,[]);class Jf{}Jf.f0k="AADSTS50058";Jf.L5c="AADSTS50001";Jf.$_k="AADSTS65001";Jf.t0k="AADSTS70011";Jf.GFd="13002";Jf.Jhl="Popup Window is null";Jf.Ihl="Popup Window closed";Jf.DYd="Token renewal operation failed due to timeout";Jf.Kam="tokenRevoked";Object(k.a)(Jf,"WopiHostErrorType",null,[]);var Bd=d(245),Ld=d(318),sd=d(1011);class qd{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=
""}}Object(k.a)(qd,"WopiIdentityInfo",null,[1184]);class Kd{constructor(v,S,ma){this.expiration=this.authority=this.accessToken=null;this.accessToken=v;this.authority=S;this.expiration=ma}}Object(k.a)(Kd,"WopiIdentityToken",null,[1181]);class Gk{constructor(v){this._initialized=!1;this.G8k=S=>{let ma=null;try{const Va=S.Values[fe.a.xbf],wb=S.Values[fe.a.L4l],Sb=S.Values[fe.a.ZTh],vc=S.Values[fe.a.T4l];let gd=null,od=null;const Vd=this.JMb[Va];if("undefined"!==typeof Vd&&Vd){var Ja=[];Array.add(Ja,
Object.assign(new B.a,{name:fe.a.wbf,string:Vd.requestParameters.correlationId}));y.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:Ja}));ma=Vd.requestCallback;delete this.JMb[Va];"undefined"!==typeof wb&&wb&&wb.length?od=new Kd(wb,Sb,vc):gd=Bc[this.NVk(S)];Ja="getAccessToken_"+Va;Ja in this.GBd&&(this.GBd[Ja].stop(),delete this.GBd[Ja]);ma(od,gd)}else n.ULS.sendTraceTag(37856066,344,10,Ag.c({["error"]:"No matching outstanding request for request ID.",
["requestId"]:Va}))}catch(Va){S=S.Values[fe.a.xbf],S in this.JMb&&delete this.JMb[S],this.I$c(),n.ULS.sendTraceTag(37856067,344,10,Ag.c({["error"]:Va.message,["stack"]:Va.stack})),ma&&ma(null,"generalException")}};this.JMb={};this.GBd={};this.xca=w.AFrameworkApplication.za.DW;this.zoe=v}Jbe(v){this._initialized||(v.Bv(Qe.a.cvh),v.dD(Qe.a.cvh,this.G8k),this._initialized=!0)}getAccessToken(v,S,ma=null){this.JEk(v,S);return new Promise((Ja,Va)=>{if(this.$te(S))if(S in this.JMb)Va("unresolvedPendingRequest");
else{var wb=window.setTimeout(()=>{n.ULS.sendTraceTag(37856032,344,10,Ag.c({["error"]:"Request timeout.",["callerId"]:S}));Va("timeout")},12E4);this.Cfe(v,S,ma,(Sb,vc)=>{window.clearTimeout(wb);Sb?Ja(Sb):(n.ULS.sendTraceTag(37856033,369,15,Ag.c({["error"]:Bc[vc]})),Va(vc))})}else n.ULS.sendTraceTag(37856034,344,10,Ag.c({["error"]:"Caller is not allowed."})),Va("notAllowed")})}getPrimaryIdentityInfo(v){return new Promise((S,ma)=>{this.$te(v)?this.TIj((Ja,Va)=>{Ja?S(Ja):(n.ULS.sendTraceTag(37856064,
369,10,Ag.c({["error"]:Va.toString()})),ma(Va))}):(n.ULS.sendTraceTag(37856065,344,10,Ag.c({["error"]:"Caller is not allowed."})),ma("notAllowed"))})}getAuthContext(v){return new Promise((S,ma)=>{const Ja=this.getAuthContextSync(v);Ja?S(Ja):ma("notAllowed")})}getAuthContextSync(v){if(this.$te(v)){const S=new sd.a;S.upn=w.AFrameworkApplication.fa.Ea("UserPrincipalName");S.userId=w.AFrameworkApplication.fa.Ea("LoggableUserId");S.authority=w.AFrameworkApplication.fa.Ea("HostAuthAuthority");S.tenantId=
w.AFrameworkApplication.fa.Ea("TenantId");S.isAnonymous=w.AFrameworkApplication.fa.getBooleanAppSetting("IsAnonymousUser");S.supportsAuthToken=this.B5j(v);v=w.AFrameworkApplication.fa.Ea("HostAuthType");S.authorityType="aad"===v.toLowerCase()?2:"msa"===v.toLowerCase()?1:0;return S}n.ULS.sendTraceTag(40751647,344,10,Ag.c({["error"]:"Caller is not allowed."}));return null}B5j(v){const S=Bd.a.Ddb;return Ee.a.gIa?S&&Bd.a.qXh?Array.contains(Bd.a.qXh,v.toLowerCase()):!1:S}Cfe(v,S,ma,Ja){var Va=[];Array.add(Va,
Object.assign(new B.a,{name:"CallerId",string:S}));Array.add(Va,Object.assign(new B.a,{name:fe.a.wbf,string:v.correlationId}));y.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Va}));Va=Ld.a.create().toString();const wb="getAccessToken_"+Va,Sb=this.xca.lj("ComponentAttach",wb);this.GBd[wb]=Sb;const vc={};vc[fe.a.xbf]=Va;vc[fe.a.Q4l]=v.resource;vc[fe.a.R4l]=v.scope;vc[fe.a.ZTh]=w.AFrameworkApplication.fa.Ea("HostAuthType");
vc[fe.a.U4l]=w.AFrameworkApplication.fa.Ea("UserPrincipalName");vc[fe.a.S4l]=v.silentLogin;vc[fe.a.N4l]=v.options;vc[fe.a.wbf]=v.correlationId;vc[fe.a.O4l]=S;ma&&(vc[fe.a.addinName]=ma.AddinName,vc[fe.a.M4l]=ma.AddinTrustId);this.zoe.execute(gd=>{this.Jbe(gd);gd.sendMessage(Qe.a.getAuthToken,vc)});this.JMb[Va]=new qg(v,Ja)}TIj(v){const S=w.AFrameworkApplication.fa.Ea("UserName"),ma=w.AFrameworkApplication.fa.Ea("UserPrincipalName"),Ja=w.AFrameworkApplication.fa.Ea("LoggableUserIdSpace"),Va=new qd;
Va.email=ma;Va.displayName=S;switch(Ja){case "OrgIdPuid":Va.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Va.authority="MicrosoftAccount";break;default:Va.authority=Ja}v(Va,null)}$te(v){var S=w.AFrameworkApplication.FSj();v=v.toLowerCase();for(const ma of S)if(v===ma.toLowerCase())return!0;S=Bd.a.Y_d;for(const ma in S)if(v===S[ma].toLowerCase())return!0;return!1}NVk(v){v=v.Values[fe.a.P4l];this.I$c();n.ULS.sendTraceTag(39068821,344,15,Ag.c({["error"]:v}));return v?-1<
v.indexOf(Jf.f0k)?9:-1<v.indexOf(Jf.Jhl)||-1<v.indexOf(Jf.Ihl)?12:-1<v.indexOf(Jf.L5c)?10:-1<v.indexOf(Jf.GFd)?8:-1<v.indexOf(Jf.t0k)||-1<v.indexOf(Jf.$_k)||v===Jf.Kam?11:-1<v.indexOf(Jf.DYd)?6:0:13}JEk(v,S){v=this.Qul(v.resource);n.ULS.sendTraceTag(39921882,344,50,Ag.c({["callerId"]:S,["resource"]:v}))}I$c(){n.ULS.sendTraceTag(39068822,344,50,Ag.c({["userAgent"]:window.navigator.userAgent}))}Qul(v){return(v?v:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(k.a)(Gk,
"WopiIdentityManager",null,[1131]);class of{constructor(){this.Da=null;this.Pn=()=>{try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(v){n.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+v)}}}get name(){return"Common.App.WopiIdentity"}fc(v){this.Da=v;v.register(Gk,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().na(()=>new Gk(v.Ha("Postmessage.IHostPostmessenger")))}init(){w.AFrameworkApplication.fa&&
w.AFrameworkApplication.fa.Ue(this.Pn)}dispose(){}static main(){e.a.instance.Ac(new of)}}Object(k.a)(of,"WopiIdentityPackage",null,[2,3]);var om=d(681);class mi extends om.a{constructor(v,S){super(v,Hc.a.CR(S))}Qza(v,S){this.isEnabled()&&this.ODa(this.nOa)&&(this.Bv(v),this.dD(v,S))}}Object(k.a)(mi,"InsertMediaCrossDocumentMessenger",om.a,[1336,225,106]);class Oe{getInstance(v,S){return new mi(v,S)}}Object(k.a)(Oe,"InsertMediaCrossDocumentMessengerFactory",null,[1300]);class Ol{constructor(v,S,ma){this.correlationId=
null;this.Eba=0;this.insertPictureTelemetryEndpoint=null;this.mVc=0;this.xfi=v;this.b2b=[];this.vfi=S;this.CGf=ma.split(";")}zob(v,S){Array.clear(this.b2b);v=this.xfi.value;v.Vfm(S.HCb);v.ODa(this.vfi);v.Bv(S.HCb);v.dD(S.HCb,ma=>{this.PUe(ma,S)});n.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");v.sendMessage(S.z2f,{["FileExtensionFilterList"]:this.CGf})}Wwi(v){Array.contains(this.b2b,v)||Array.add(this.b2b,v)}PUe(v,S){n.ULS.sendTraceTag(17838544,
352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");v=S.fth(v);const ma=[];for(let Ja=0;Ja<v.length;Ja++){const Va=v[Ja];S.e7c(Va,this.CGf)?Array.add(ma,Va):this.Wwi(S.Eng(Va))}ma&&ma.length?S.Wva(ma):n.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.b2b.length&&(S=this.b2b.join(", "),n.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",S),this.c2l(S))}c2l(v){const S=new Ya.StandardDialog;
S.Fd=0;S.vQ(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,v),null)}dispose(){}}Object(k.a)(Ol,"InsertMediaFromHostManager",null,[1270,106]);class pm{constructor(v){this.bgi=v}getInstance(){return this.bgi}}Object(k.a)(pm,"InsertMediaFromHostManagerFactory",null,[1235,1236]);class tk{constructor(){this.AXb=document.createElement("iframe");this.AXb.src="about:blank";this.AXb.style.visibility="hidden";this.AXb.style.position="absolute";this.AXb.style.zIndex=
"-100"}get ubb(){return this.AXb}}Object(k.a)(tk,"InsertMediaFromHostOneDriveHostFrame",null,[1234]);class Oj extends om.a{constructor(v,S){super(v,"*"===S?S:Hc.a.CR(S));this.pJf(Qe.a.Ldc);this.pJf(Qe.a.nqe)}reportDocumentLoadedTime(){}}Object(k.a)(Oj,"InsertMediaFromOneDriveCrossDocumentMessenger",om.a,[224,225,106]);var yk=d(276),bm=d(551);class Hk{jPc(v){switch(v){case 1:v=8;break;case 4:v=3;break;case 2:v=0;break;default:v=0}return v}IKi(v,S){return String.format(S,this.jPc(v))}$Rf(v,S,ma,Ja,
Va,wb,Sb){v=this.jPc(v);const vc=yk.a.Oe(w.AFrameworkApplication.lcid).name,gd=w.AFrameworkApplication.buildVersion;w.AFrameworkApplication.F1("ShIns226;ShIns226cf");return String.format(S,w.AFrameworkApplication.lcid,vc,gd,Va,v,wb,ma,Ja,Sb)}LKi(v,S){v=this.jPc(v);const ma=w.AFrameworkApplication.buildVersion,Ja=0<ma.indexOf(".")?ma.substring(0,ma.indexOf(".")):"16";return String.format(S,w.AFrameworkApplication.lcid,w.AFrameworkApplication.lcid,w.AFrameworkApplication.lcid,v,Ja,ma,"Video",0,0)}KKi(v,
S,ma,Ja,Va,wb){v=String.format(S,w.AFrameworkApplication.lcid,w.AFrameworkApplication.uiCulture,w.AFrameworkApplication.buildVersion,ma,this.jPc(v),Ja);v+="&flipgrid=1";Va&&(Va=new Pg.QueryStringBuilder(v),Va.zg("stream2","1"),Va.zg("enablegetcustomheader","1"),v=Va.toString());"defaultModal"!=wb&&(Va=new Pg.QueryStringBuilder(v),Va.zg("modalvariation",wb),v=Va.toString());return v}hth(v){if(!v||!v.Values)return null;v=v.Values;if(!v)return null;let S="";"sourceProvider"in v&&(S=v.sourceProvider||
"");return Object.assign(new bm.a,{Action:v.action||"",Caption:v.caption||"",ContentType:v.contentType||"",Type:v.extension||"",PageUrl:v.pageUrl||"",OriginalUrl:v.sourceUrl||"",ContentProvider:S,ThumbnailUrl:v.thumbnailUrl||"",LicenseUrl:v.licenseUrl||"",LicenseDisplayName:v.licenseDisplayName||"",Height:v.height||0,Width:v.width||0,SvgContent:v.svgContent||"",Description:v.description||"",ProviderName:v.providerName||"",StartInsertTime:v.startInsertTime||0})}$dl(v){const S=[];if(!v||!v.Values||
!v.Values.Items)return S;v=v.Values.Items;for(let Ja=0;Ja<v.length;Ja++){var ma=v[Ja];ma&&(ma=Object.assign(new bm.a,{Type:ma.Extension||"",OriginalUrl:ma.SourceUrl||"",Caption:ma.caption,Description:ma.description||"",Height:ma.Height||0,Width:ma.Width||0}),Array.add(S,ma))}return S}e7c(v,S){if(!v)return!1;for(let ma=0;ma<S.length;ma++)if(0<=v.toLowerCase().indexOf(S[ma]))return!0;return!1}gkl(v){let S="";if(v)for(let ma=0;ma<v.length;ma++){const Ja=v[ma];Ja&&(S+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',
Ja.OriginalUrl,Ja.Width,Ja.Height))}return S}FRj(v){return(v=Hk.MIl.exec(v))&&2<v.length?v[2].trim():""}Fti(v,S){v.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?S.zg("dallecore","1"):v.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&S.zg("dalle","1")}}Hk.MIl=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(k.a)(Hk,"InsertMediaHelper",null,[1232]);var Af=d(34);class rg{constructor(v){this.BYb=Af.a.insertHyperlink;
this.Ca=v}get xx(){return this.BYb}set xx(v){this.BYb=v}Wva(v){try{n.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",v.length);for(let S=0;S<v.length;S++)this.Ca.Ia(this.xx,2,v[S]);n.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",v.length)}catch(S){n.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",S.toString())}}}Object(k.a)(rg,"InsertOneDriveFileHandler",
null,[1231]);class Li extends rg{constructor(v){super(v)}get z2f(){return Qe.a.nqe}get HCb(){return Qe.a.lbk}fth(v){return v&&v.Values&&"Items"in v.Values?v.Values.Items:null}Eng(){K.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}e7c(){return!0}rxh(v,S,ma){v=ma(v);v.length&&(ma={},ma.Items=v,S.sendMessage(this.HCb,ma))}gth(v){const S=[];for(let ma=0;ma<v.data.value.length;ma++){const Ja=v.data.value[ma];if(Ja){const Va=
{};Va.DisplayText=Ja.name;Va.Url=Ja.urls.download;Va.sourceUrl=Ja.urls.download;Va.caption=Ja.name;Array.add(S,Va)}}return S}}Object(k.a)(Li,"InsertOneDriveFileHelper",rg,[1230,1231]);class Vf extends Kc.a{constructor(){super()}iaf(){this.ZEc="FilePickerDialog";this.Wg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.Fg="PickerDialog-Livebooks";this.showDialog("",null)}Gje(){return document.getElementById("OpenFilePickerDiv")}IB(){}Uba(){}}Object(k.a)(Vf,"PickerDialog",Kc.a,[1276]);
class Ej{constructor(v,S,ma){this.Go=this.dka=null;this.z6a=v;this.oli=ma;this.Ija=new Ie.a(()=>new aj.a(S.value,Object(r.a)(this,this.yGa,"getMoreInfoEventReceived")))}get EMb(){this.dka||(this.Ija.value.Gi("InsertFromOneDrive",!0),this.Go&&this.Go.SS&&this.Go.SS.length&&(this.dka=this.oje(this.Go.SS)));return this.dka}oje(v){v=v.toLowerCase();v.endsWith("/")||(v+="/");const S=v.indexOf("/documents/");return-1!==S?v.substring(0,S+1)+"_layouts/15/onedrive.aspx":""}yGa(v){this.Go||3!==v.state||(this.Go=
v)}start(v){if(!this.EMb)if(w.AFrameworkApplication.breadcrumbFolderUrl&&w.AFrameworkApplication.breadcrumbFolderUrl.length)this.dka=w.AFrameworkApplication.breadcrumbFolderUrl;else{n.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Go);return}const S=new Vf;S.iaf();const ma=S.Gje();ma?this.z6a.start((Ja,Va)=>{S.hide();this.processResponse(Ja,Va,v)},()=>{this.OTe(S)},ma,
this.dka):n.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}OTe(v){v.hide();n.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}processResponse(v,S,ma){n.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",v);v&&S&&S.data&&S.data.value&&0<S.data.value.length?(v=this.oli.getInstance(window.frames[0].parent,window.document.URL),ma.rxh(S,v,Object(r.a)(ma,
ma.gth,"parseOneDriveV7Response"))):n.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(k.a)(Ej,"OneDriveFilePickerHelperV7",null,[1228,1229]);class Tj{constructor(v,S,ma,Ja){this.ia=S;this.ka=v;this.u6=this.ka.Zva;this.$M=ma;this.ULg=Ja}get cR(){return this.ULg?this.ULg.instance:null}qb(){this.ia.pa(F.a.h$c,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"),4);this.ia.pa(F.a.w9a,qb.a.application,Object(r.a)(this,
this.sBa,"triggerCommandforAddinCommands"),4);this.ia.pa(F.a.Z1e,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"),4);this.ia.pa(F.a.cOb,qb.a.application,Object(r.a)(this,this.cOb,"queryAddInCommandsLoadStatus"),96);this.ia.xa(F.a.C$e,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"));this.ia.pa(F.a.QN,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"),64);this.ia.pa(F.a.QPb,qb.a.application,Object(r.a)(this,this.sBa,
"triggerCommandforAddinCommands"),64);this.ia.xa(F.a.Vyc,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"));this.ia.pa(F.a.Ucc,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"),64);this.ia.xa(F.a.$Rb,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"));this.ia.xa(F.a.k9b,qb.a.application,Object(r.a)(this,this.sBa,"triggerCommandforAddinCommands"))}Sd(){}sBa(v,S,ma,Ja,Va){if(!this.u6)return 16;if(1===ma)return S=v===F.a.w9a&&
(!this.cR||!this.cR.GTj(Va)),v=v===F.a.w9a&&!!this.cR&&this.cR.hXl(Va),S||v?8:32;if(this.cR)switch(v){case F.a.h$c:this.cR.i$c(Va);break;case F.a.w9a:this.cR.dcc(Va);break;case F.a.cOb:this.cR.eyh(Va);break;case F.a.C$e:this.cR.j_l();break;case F.a.QN:this.cR.jnl(Va);break;case F.a.QPb:this.cR.QPb(Va);break;case F.a.Z1e:this.cR.Sul();break;case F.a.Vyc:this.cR.Vyc(Va);break;case F.a.Ucc:this.cR.Ucc(Va);break;case F.a.$Rb:this.cR.$Rb(Va);break;case F.a.k9b:this.cR.k9b(Va)}else this.$M.mla(),this.$M.pSa(v,
Va);return 32}cOb(v,S,ma,Ja,Va){if(!this.u6)return 16;this.cR&&this.cR.eyh(Va);return 32}}Object(k.a)(Tj,"AddinCommandsActor",null,[948]);var dj=d(1042),Pl=d(202),Si=d(86),Le=d(172),uj=d(41),Tk=d(1064),bk=d(371);class Ql{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He,$m,Ck,cl,Nk,xn,um,km){this.qjc=null;this.yMg=!1;this.JZa=null;this.NRg=id.a("PartialDoc.SkipCutCopyCallout");if(!km)throw Error.argumentNull("calloutNotificationAdapter");this.ia=v;this.uf=S;this.Lb=He;this.Fa=ma;
this.oa=Ja;this.Rq=Va;this.JI=wb;this.Gah=Sb;this.VJk=vc;this.gQk=gd;this.Ebd=od;this.Db=Vd;this.Zdd=ih.Svg;this.Kx=Ke;this.Wb=$m;this.qFk=ih.powerPointEditorDownloadACopyUiIsEnabled;this.ROk=kg;this.mcd=If;this.Xa=bg;this.bKb=!ih.Mg;this.V9g=Ck;this.Bbh=Nk;this.tZg=xn;this.Hx=um;this.WPg=!ih.printingEnabled||He.getBooleanAppSetting("DisablePrint");this.XPg=yh;this.Ql=df;this.YHk=He.Ea("DownloadPdfFromPodsUrl");this.m_printUrl=He.Ea("PrintPdfFromPodsUrl");this.XHk=He.Ea("DownloadOdpFromPodsUrl");
this.qQg=He.Ea("DownloadImagesFromPodsUrl");this.KQk=He.getBooleanAppSetting("UseToastForDeferredBlobsEnabled");this.PRk=ih.pptAppendFileNameToQueryUrlForDocumentOperationsActor;v=(w.AFrameworkApplication.fileName||"").toLowerCase();ih.Mg&&ih.shk?(this.yMg=!0,this.qjc=He.Ea("DownloadACopyPodsUrl")):!ih.Mg&&ih.Wok&&(v.endsWith(".pptx")||v.endsWith(".ppsx"))?this.qjc=this.pVk():this.qjc=w.AFrameworkApplication.xUa;this.aIe=cl;this.wLk=ih.W7c;this.pba=C.a.instance.Ha("Common.ISystemInitiatedFeedback");
this.YKk=He.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.uI=km}qb(){const v=!!this.XPg&&!this.V9g();Q.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.WPg,v);this.WPg?v&&this.Ql.B0l(this.XPg):(this.ia.xa($a.a.print,qb.a.application,Object(r.a)(this,this.DYj,"handlePrint")),this.ia.xa($a.a.downloadACopy,qb.a.application,Object(r.a)(this,this.downloadACopy,"downloadACopy")),this.ia.xa($a.a.n8b,qb.a.application,Object(r.a)(this,
this.n8b,"downloadACopyAsPdf")),this.ia.xa($a.a.m8b,qb.a.application,Object(r.a)(this,this.m8b,"downloadACopyAsOdp")),this.ia.xa($a.a.o8b,qb.a.application,Object(r.a)(this,this.o8b,"downloadAsImages")),this.ia.xa($a.a.h6e,qb.a.application,Object(r.a)(this,this.h6e,"saveSlidesAsImages")),this.ia.xa($a.a.qtc,qb.a.application,Object(r.a)(this,this.wjl,"pptoSaveACopy")),this.ia.xa($a.a.AYe,qb.a.application,Object(r.a)(this,this.xjl,"pptoSaveAsToHost")),this.ia.xa($a.a.BYe,qb.a.application,Object(r.a)(this,
this.yjl,"pptoSaveToSharePoint")),this.ia.xa($a.a.rZe,qb.a.application,Object(r.a)(this,this.FYj,"handlePrintNotes")),this.ia.xa($a.a.pZe,qb.a.application,Object(r.a)(this,this.EYj,"handlePrintHandouts")));this.ia.xa(F.a.R2a,qb.a.application,Object(r.a)(this,this.R2a,"saveFileChange"));this.Gah&&this.ia.pa($a.a.vtd,qb.a.application,Object(r.a)(this,this.vtd,"querySaveStatus"),96);this.aIe.execute(Object(r.a)(this,this.$qc,"onHostPostmessengerCreated"))}Sd(){const v=this.Fa.Kc(Ga.a.iMi);v.bindAction(jb.KeyInputManager.Va(da.a.Cqb,
jb.KeyInputManager.Ze),$a.a.print);v.bindAction(jb.KeyInputManager.Va(da.a.jPa,jb.KeyInputManager.Ze),F.a.Ce);v.bindAction(jb.KeyInputManager.Va(da.a.SGd,jb.KeyInputManager.Ze),F.a.Ce);v.bindAction(jb.KeyInputManager.Va(da.a.O3,jb.KeyInputManager.Ze),F.a.Ce);v.bindAction(jb.KeyInputManager.Va(da.a.O3,jb.KeyInputManager.Ze|4),F.a.Ce)}xjl(v,S,ma){return this.a6e(ma,F.a.gQb,"SaveAsToHost")}wjl(v,S,ma){return this.a6e(ma,F.a.Q2a,"SaveACopy")}yjl(v,S,ma){return this.a6e(ma,F.a.inb,"SaveToSharePoint")}a6e(v,
S,ma){if(1===v)return w.AFrameworkApplication.Tw||w.AFrameworkApplication.TR?8:this.ia.nb(S,1);if(this.Hx.hasDeferredContent()&&(Q.a.J(512500628,843,15,"{0} is triggered while document has deferred content",ma),!this.KQk))return this.Hx.F$e(ma,null,null),8;this.ivb(ma);return this.Xa.Vfa?(Q.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",S),this.ia.Ia($a.a.iQb,2,S)):this.ia.nb(S,2)}downloadACopy(v,S,ma,Ja,Va){if(this.uf.Xc(this.Rq))return 16;if(1===ma)return!this.Wb.Hi()||
w.AFrameworkApplication.TR?8:Ql.Jag()?32:this.xxb();if(this.Hx.hasDeferredContent())return Q.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),this.NRg&&this.uI.L$d(),this.Hx.F$e("DownloadACopy",new Tk.a,()=>{this.zff(Va)}),this.Hx.tta("DownloadACopyRequestedTime",uj.a.Ef(new Date)),8;this.oa.Bh();this.Fa.Gd();Q.a.J(512500625,801,50,"PPT save and download a copy");this.Xa.Vfa?this.zff(Va):(this.Kx.show(!0,v),this.JI.b$(!1,this.bKb,()=>{this.zff(Va)},Object(r.a)(this,
this.hAa,"saveFailureCallback")));this.ivb("DownloadACopy");return 32}zff(v){this.Kx.hide();let S;S=Ql.Jag()?w.AFrameworkApplication.xUa:this.yMg?this.Tvb(this.qjc):this.qjc;v&&v.FileDownloadUrl&&(S=v.FileDownloadUrl.toString());this.Ozk();this.tZg&&!this.tZg()&&this.Bbh&&this.Bbh("3555692408")?this.JZa.sendMessage(Qe.a.download,{}):this.qFk?(this.ROk.j1l(S),this.Hx.tta("DownloadModalTime",uj.a.Ef(new Date))):this.Db.DN(!0,S,!0)}Ozk(){this.YKk&&this.pba&&this.pba.execute(v=>{v.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity",
"CollabCornerFloodgateSurveysIsEnabled")})}vtd(v,S,ma,Ja,Va){v="";this.Gah&&(v=this.VJk.pY(this.Rq)?String.format(ResourceStrings.L_SavingStatus):this.Zdd?String.format(CommonUIStrings.l_SavedToStatus,this.Zdd):String.format(ResourceStrings.L_SavedStatus));Va[ag.a.Value]=v;return 32}DYj(v,S,ma){return this.qZe(ma,0,v)}FYj(v,S,ma){return this.qZe(ma,8,v)}EYj(v,S,ma){return this.qZe(ma,4,v)}qZe(v,S,ma){if(this.uf.Xc(this.Rq))return 16;if(1===v)return!this.Wb.Hi()||w.AFrameworkApplication.TR?8:this.xxb();
if(this.V9g())return Q.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;Q.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",S);this.oa.Bh();this.Fa.Gd();this.Xa.Vfa?this.bJh(S):(this.Kx.show(!0,ma),this.JI.b$(!1,this.bKb,()=>{this.bJh(S)},Object(r.a)(this,this.hAa,"saveFailureCallback")));this.ivb("Print-"+ma);return 32}bJh(v){this.Kx.hide();this.gQk.print(this.Xa.presentationId.string,this.Tvb(this.m_printUrl),v)}n8b(v,S,ma){if(this.uf.Xc(this.Rq))return 16;if(1===
ma)return!this.Wb.Hi()||w.AFrameworkApplication.TR?8:this.xxb();this.mcd.d7f=new Date;this.oa.Bh();this.Fa.Gd();this.Xa.Vfa?this.ZIh():(this.Kx.show(!0,v),this.JI.b$(!1,this.bKb,()=>{this.ZIh()},Object(r.a)(this,this.hAa,"saveFailureCallback")));this.ivb("DownloadACopyAsPDF");this.uvi();return 32}ZIh(){this.Kx.hide();this.mcd.fJh=new Date;this.Ebd.convert(this.Xa.presentationId.string,1,this.Tvb(this.YHk))}o8b(v,S,ma){if(this.uf.Xc(this.Rq))return 16;if(1===ma)return!this.Wb.Hi()||w.AFrameworkApplication.TR?
8:this.xxb();this.oa.Bh();this.Fa.Gd();this.Xa.Vfa?this.$Ih():(this.Kx.show(!0,v),this.JI.b$(!1,this.bKb,()=>{this.$Ih()},Object(r.a)(this,this.hAa,"saveFailureCallback")));this.ivb("DownloadAsImages");return 32}h6e(v,S,ma){if(this.uf.Xc(this.Rq))return 16;if(1===ma)return!this.Wb.Hi()||w.AFrameworkApplication.TR?8:this.xxb();this.oa.Bh();this.Fa.Gd();this.Xa.Vfa?this.c7f():(this.Kx.show(!0,v),this.JI.b$(!1,this.bKb,()=>{this.c7f()},Object(r.a)(this,this.hAa,"saveFailureCallback")));this.ivb("SaveSlidesAsImages");
return 32}$Ih(){this.Kx.hide();this.Ebd.convert(this.Xa.presentationId.string,2,this.Tvb(this.qQg))}c7f(){this.Kx.hide();var v=this.Tvb(this.qQg),S=this.oa.Xe();0<S.length&&(S=Le.c(S,ma=>ma.sid.toString()).join(","),v=new Pg.QueryStringBuilder(v),v.zg(Si.a.P2l,S),this.Ebd.convert(this.Xa.presentationId.string,2,v.toString()))}m8b(v,S,ma){if(this.uf.Xc(this.Rq))return 16;if(1===ma)return!this.Wb.Hi()||w.AFrameworkApplication.TR?8:this.xxb();if(this.Hx.hasDeferredContent())return this.NRg&&this.uI.L$d(),
Q.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.Hx.F$e("DownloadACopyAsOdp",new Tk.a,()=>{this.b6e()}),8;this.oa.Bh();this.Fa.Gd();this.Xa.Vfa?this.b6e():(this.Kx.show(!0,v),this.JI.b$(!1,this.bKb,()=>{this.b6e()},Object(r.a)(this,this.hAa,"saveFailureCallback")));return 32}hAa(){this.Kx.hide();return!1}b6e(){this.Kx.hide();this.Ebd.convert(this.Xa.presentationId.string,0,this.Tvb(this.XHk))}R2a(v,S,ma,Ja,Va){if(this.uf.Xc(this.Rq))return 16;if(1===
ma)return 32;this.oa.Bh();this.Fa.Gd();this.JI.b$(!1,!0,wb=>{if(Va&&1<=Va.length)Va[0](wb)},wb=>Va&&2<=Va.length?(Va[1](wb,wb.ServerError.Code),!0):!1);return 32}pVk(){const v=new Pg.QueryStringBuilder(Hc.a.$ua("DownloadACopyHandler.ashx"));v.zg(Si.a.Tqd,this.Xa.presentationId.string);v.zg(Si.a.Zpa,this.Xa.sessionInfo);v.zg("fn",w.AFrameworkApplication.fileName);w.AFrameworkApplication.qSa(v);return v.toString()}Tvb(v){if(v){const S=new Pg.QueryStringBuilder(v);this.Xa&&this.Xa.podSessionId&&0>v.indexOf(this.Xa.podSessionId)&&
(S.ENc(Si.a.Mba+"="+this.Xa.podSessionId),Q.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Xa.podSessionId));this.PRk&&w.AFrameworkApplication.Qu.iy&&0<w.AFrameworkApplication.Qu.iy.length&&(S.zg(Si.a.Qsh,w.AFrameworkApplication.Qu.iy),Q.a.J(512500619,801,50,"Appended FileName in url"));this.wLk&&(S.zg(Si.a.adl,"true"),Q.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));w.AFrameworkApplication.qSa(S);return S.toString()}return null}ivb(v){const S=Pl.a.YX(bk.a.rsd,!0);Q.a.J(509448414,
801,15,"DocOperation={0};SimplifiedRibbonON={1}",v,S)}uvi(){const v=new B.a;v.name="IsPdfProtectionEnabled";v.bool=this.Lb.getBooleanAppSetting("KeepPDFProtection");const S=new B.a;S.name="IsLabeled";const ma=this.Lb.Ea("AppliedPolicyId");S.bool=!!(ma&&0<ma.length);pb.a("PdfProtectionUsage",!0,void 0,[v,S])}$qc(v){this.JZa=v}xxb(){return w.AFrameworkApplication.Tw?8:32}static Jag(){const v=w.AFrameworkApplication.Tw,S=!hc.a.Ta(w.AFrameworkApplication.xUa),ma=w.AFrameworkApplication.fa.getBooleanAppSetting("SupportsOfficeClientCoauthoring"),
Ja=w.AFrameworkApplication.fa.getBooleanAppSetting("PPTClpSwitchEnabled");Q.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",v,S,ma,Ja);return v&&S&&ma&&Ja}}Object(k.a)(Ql,"DocumentOperationsActor",null,[948]);class lk{}lk.Wg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(k.a)(lk,
"EmbedDialogHtml",null,[]);class qm{constructor(v,S,ma,Ja){this.rWe=v;this.B5=S;this.Jrh=ma;this.value=Ja}}Object(k.a)(qm,"OptionInfo",null,[]);class cm{constructor(v,S,ma){this.t6e=v;this.RCb=S;this.B5=ma}}Object(k.a)(cm,"SectionInfo",null,[]);var Uh=d(319);class cg extends Kc.a{constructor(v,S=!1){super(!1,!1,S);this.Wrf=476;this.CFc=288;this.Vci=798;this.zli=476;this.xli=288;this.Uqd={};this.Y2a=[];this.KQ=this.WCa=this.jSd=this.nFc=this.tJc=this.xtb=null;this.bGi=ma=>{this.HVf(ma);return!0};this.cGi=
ma=>this.L9c(ma,this.HVf);this.HVf=ma=>{ma=ma.CE;"visible"===ma.t6e.style.visibility?(ma.t6e.style.visibility="hidden",ma.B5.className=Aa.getImageClass(cg.wrf),ma.B5.title=CommonUIStrings.l_Expand,ma.RCb.title=CommonUIStrings.l_Expand):(ma.t6e.style.visibility="visible",ma.B5.className=Aa.getImageClass(cg.Uqi),ma.B5.title=CommonUIStrings.l_Collapse,ma.RCb.title=CommonUIStrings.l_Collapse)};this.rbl=ma=>{this.Irh(ma);return!0};this.sbl=ma=>this.L9c(ma,this.Irh);this.Irh=ma=>{const Ja=this.Uqd[ma.CE.toString()];
Ja.value?(Ja.value=0,Ja.B5.className=Aa.getImageClass(cg.Gqi),Ja.Jrh.setAttribute(na.a.CPf,na.a.Xka)):(Ja.value=1,Ja.B5.className=Aa.getImageClass(cg.fbi),Ja.Jrh.setAttribute(na.a.CPf,na.a.cC));this.Zhm(ma.CE.toString(),Ja.value.toString())};this.K9l=()=>{this.KQ.select()};this.kXb=w.AFrameworkApplication.ICb;this.XJc=v;this.hSd=this.rbl;this.iSd=this.sbl;this.ZHd=this.bGi;this.Wqb=this.cGi;this.gMc=this.K9l;this.qhi=S;this.Wg=lk.Wg;this.Fd=0;this.Fg="EmbedDialog"}get psb(){return this.CFc}set psb(v){this.CFc=
v}fSh(v){const S={["id"]:this.Fg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Hc.a.Xi(this.XJc,"wdPreview","1"),["initialEmbedUrl"]:this.kXb,["getEmbedCode"]:cg.Rig,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const ma of Object.keys(v))S[ma]=v[ma];this.Fd=1;this.Te(1,
CommonUIStrings.l_CopyAction);this.Te(0,CommonUIStrings.l_Close);this.Vj(CommonUIStrings.l_Embed,null,S)}vob(){if(this.qhi)this.fSh({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.xtb=document.getElementById("embedpreviewpane");this.tJc=document.getElementById("embedoptionpane");this.xtb.style.width=String.format("{0}px",this.zli);this.WCa=document.createElement("iframe");this.WCa.className=cg.wli;this.WCa.frameBorder="0";this.WCa.style.height=String.format("{0}px",this.xli);this.WCa.tabIndex=
-1;this.xtb.appendChild(this.$Tc(CommonUIStrings.l_Preview,this.WCa,cg.JCf,cg.yli,cg.JCf,!0));this.KQ=document.createElement("textarea");this.KQ.className=cg.Bdi;Sys.UI.DomElement.addCssClass(this.KQ,Uh.a.iEa);this.KQ.id=cg.Cdi;Ee.a.Aj||(this.KQ.readOnly=!0);this.KQ.rows=4;this.KQ.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.KQ.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.KQ.setAttribute(na.a.E4,String.format("{0} {1}",cg.Vrf,cg.Urf));this.xtb.appendChild(this.$Tc(CommonUIStrings.l_EmbedCode,
this.KQ,cg.Vrf));Za.a.addHandler(this.KQ,"focus",this.gMc);var v=document.createElement("span");v.className=cg.Aei;v.innerText=CommonUIStrings.l_CopyText;v.id=cg.Urf;this.xtb.appendChild(v);this.nFc=document.createElement("div");this.nFc.className=cg.Yci;this.tJc.appendChild(this.$Tc(CommonUIStrings.l_Dimensions,this.nFc));this.jSd=document.createElement("div");this.tJc.appendChild(this.n2i(cg.xki,this.jSd));this.Fd=0;this.Te(1,CommonUIStrings.l_Close);this.l2h();this.n3h();Ee.a.Aj||this.KQ.focus()}}dispose(){if(this.Uqd){var v=
this.Uqd;for(const S in v){const ma=v[S];this.to.Hb(Ha.a.click,ma.rWe,this.hSd);this.lh.Hb(Ha.a.Vf,ma.rWe,this.iSd);this.lh.Hb(Ha.a.rm,ma.rWe,this.iSd)}this.iSd=this.hSd=this.Uqd=null}if(this.Y2a){for(v=0;v<this.Y2a.length;++v)this.to.Hb(Ha.a.click,this.Y2a[v].RCb,this.ZHd),this.lh.Hb(Ha.a.Vf,this.Y2a[v].RCb,this.Wqb),this.lh.Hb(Ha.a.nz,this.Y2a[v].RCb,this.Wqb),this.lh.Hb(Ha.a.rm,this.Y2a[v].RCb,this.Wqb);this.lh=this.ZHd=this.Y2a=null}this.gMc&&this.KQ&&(Za.a.removeHandler(this.KQ,"focus",this.gMc),
this.gMc=null);this.KQ=this.WCa=this.jSd=this.nFc=this.tJc=this.xtb=null;super.dispose()}Uba(){super.Uba();this.Nb.style.width=String.format("{0}px",this.Vci);this.zEa()}m2h(v,S){const ma=Hc.a.Xi(this.kXb,v,S);return this.kXb!==ma?(this.kXb=ma,this.XJc=Hc.a.Xi(this.XJc,v,S),!0):!1}l2h(){this.KQ&&(this.KQ.innerText=cg.Rig(this.kXb,this.Wrf,this.CFc))}n3h(){this.WCa&&this.WCa.contentWindow.location.replace(Hc.a.Xi(this.XJc,"wdPreview","1"))}Zhm(v,S){this.m2h(v,S)&&(this.l2h(),this.n3h())}$Tc(v,S,ma=
null,Ja=null,Va=null,wb=!1){const Sb=document.createElement("div");Sb.className=cg.rni;Ja&&(Sb.id=Ja);Va&&Sb.setAttribute(na.a.E4,Va);wb&&(Sb.tabIndex=0);Ja=document.createElement("span");Ja.className=cg.sni;Ja.innerText=v;ma&&(Ja.id=ma);Sb.appendChild(Ja);Sb.appendChild(S);return Sb}n2i(v,S){const ma=this.$Tc(CommonUIStrings.l_Interaction,S),Ja=this.Mi.createElement("div");Ja.className=cg.X$h;Ja.id=cg.Z$h+v;Ja.setAttribute(na.a.Ff,na.a.jx);Ja.tabIndex=0;ma.insertBefore(Ja,S);v=Aa.createClusteredImage(16,
16,cg.Y$h,cg.$$h,!0,"");Ja.appendChild(v);v=v.childNodes[0];v.className=Aa.getImageClass(cg.wrf);v.title=CommonUIStrings.l_Expand;Ja.title=CommonUIStrings.l_Expand;S.style.visibility="hidden";S=new cm(S,Ja,v);Array.add(this.Y2a,S);this.to.gW(Ha.a.click,Ja,this.ZHd,S);this.lh.gW(Ha.a.Vf,Ja,this.Wqb,S);this.lh.gW(Ha.a.nz,Ja,this.Wqb,S);this.lh.gW(Ha.a.rm,Ja,this.Wqb,S);return ma}static Rig(v,S,ma){if(!cg.uRd){const Ja=String.format('<a target="_blank" href="{0}">{1}</a>',hc.a.adc("https://office.com"),
CommonUIStrings.l_Office),Va=String.format('<a target="_blank" href="{0}">{1}</a>',hc.a.adc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);cg.uRd=String.format(CommonUIStrings.l_NoFrames,Ja,Va)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',hc.a.adc(v),S,ma,cg.uRd)}}cg.uRd=null;cg.fbi="CheckboxChecked_16x16x32";cg.Gqi="CheckboxUnchecked_16x16x32";cg.Uqi="OutlookSearchChevronUp_16x16x32";cg.wrf="OutlookSearchChevronDown_16x16x32";cg.Y$h=
"UpArrowServer";cg.rni="EmbedSectionHeader";cg.sni="EmbedSectionName UIFontBold";cg.Aei="EmbedCodeFooter";cg.wli="EmbedPreviewFrame";cg.Bdi="EmbedCodeTextArea";cg.Yci="EmbedDimensionSection";cg.$$h="EmbedArrowIcon";cg.X$h="WACGlyph EmbedArrowHolder";cg.Cdi="EmbedCode";cg.Vrf="EmbedCodeHeader";cg.JCf="Preview";cg.yli="PreviewHeader";cg.xki="Options";cg.Z$h="Arrow";cg.Urf="EmbedCodeFooter";Object(k.a)(cg,"EmbedDialog",Kc.a,[]);class Pj extends cg{constructor(v,S){super(v,!0);S&&S&&!isNaN(S)||Q.a.J(539762772,
820,10,"Invalid aspectRatio in ReactEmbedDialog");this.m2h(Si.a.Scl,S.toString())}vob(){const v=[];v.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:Pj.Nsl});this.fSh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.Wrf,["defaultHeight"]:this.CFc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:v})}static Nsl(v,
S,ma){return"wdEaaCheck"===S?Hc.a.Xi(v,S,ma?"1":"0"):v}}Object(k.a)(Pj,"ReactEmbedDialog",cg,[]);class Rl{constructor(v,S,ma,Ja,Va){this.CIa=null;this.yFe=!1;this.JZa=null;this.Db=v;this.GHe=S;this.zjc=ma;this.aIe=Ja;this.Xa=Va}vob(v,S,ma){(v=(v=w.AFrameworkApplication.cD)||this.Xa.Vfa)||this.yFe||(v=!this.WZh());return 1===ma?v?2:32:this.T_l()}T_l(){if(!this.yFe)return 8;if(w.AFrameworkApplication.ICb&&this.zjc)this.rRh();else{const v=w.AFrameworkApplication.oif?this.JZa.sendMessage(Qe.a.ymj,null)?
32:8:2;return 32!==v?this.Db.DN(!0,w.AFrameworkApplication.jde):v}return 32}S_l(v){v.Values.HostEmbeddedViewUrl&&(this.zjc=w.AFrameworkApplication.ICb=v.Values.HostEmbeddedViewUrl.toString(),this.rRh())}WZh(){return!1}Rti(v,S){this.CIa=S;this.yFe=!!this.Db&&!!this.GHe&&!(void 0===this.zjc||null===this.zjc)&&!!v&&!!S}rRh(){(new Pj(this.zjc,this.CIa)).vob()}}Object(k.a)(Rl,"EmbedManager",null,[]);class Uk{constructor(v,S,ma){this.CIa=null;this.eJk={};for(S=0;S<v.length;S++)this.eJk[v[S].Format.toString()]=
S;this.CIa=ma&&!isNaN(ma)&&isFinite(ma)?ma:0}}Object(k.a)(Uk,"FormatPicker",null,[]);class Sl extends Rl{constructor(v,S,ma,Ja,Va,wb,Sb,vc){super(v,S,ma,wb,Sb,vc);this.ia=Ja;this.Tb=Va}qb(){this.ia.xa($a.a.vob,qb.a.application,Object(r.a)(this,this.vob,"showEmbedDialog"));this.aIe.execute(Object(r.a)(this,this.$qc,"onHostPostmessengerCreated"))}Sd(){}WZh(){var v=this.Tb.Bw();if(!this.GHe||!v.height)return!1;v=v.width/v.height;const S=new Uk(this.GHe,!1,v);this.Rti(S,v);return!0}$qc(v){this.JZa=v;
w.AFrameworkApplication.isEmbedded||w.AFrameworkApplication.ICb||!this.JZa||(this.JZa.Bv(Qe.a.EUf),this.JZa.dD(Qe.a.EUf,Object(r.a)(this,this.S_l,"showEmbedDialogPostMessage")))}}Object(k.a)(Sl,"EmbedActor",Rl,[948]);var Ti=d(1273),Jg=d(37),Uj=d(751),sl=d(700);class Bm{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke){this.ia=v;this.kib=S?S.va:null;this.sa=ma;this.ic=Ja;this.gb=Va;this.Dr=wb;this.Eb=Sb;this.Vk=vc;this.fe=gd;this.mGb=null;this.Fa=od;this.Rq=ma.presentation;this.Pe=Vd;this.ff=null;this.Thb=
Ke}qb(){this.ia.pa($a.a.SRh,Jg.a.application,Object(r.a)(this,this.l0j,"handleUploadAudioDialog"),4)}Sd(){}l0j(v,S,ma){const Ja=this.sa.Aa;if(!Ja||this.ic.Xc(Ja))return 16;if(1===ma)return 32;if(this.kib){this.ff=uj.a.Zj("Audio::Insert");try{return sl.a.Baf("audio/*",Uj.e,()=>Uj.d(v,Object(r.a)(this,this.dbk,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Pe,Ja),"audio",Ja,this.sa.presentation,this.ic,this.fe,this.ff,!1,this.Thb,50,10,3),this.ff&&this.ff.Wa("AudioDialogInitialized",
"true"),32}catch(Va){Q.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return Q.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(v,S){this.ff&&(this.ff.finish(),this.ff=null);this.fe.iI(v,ma=>{ma.yD=1;ma.YUa=S;return!1})}dbk(v,S,ma,Ja,Va,wb,Sb){Ja.iP(ma)&&Q.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-
+ma.ula);Ja.vL(ma);Va&&Va.Wa("AudioUploadToRC","true");Object(id.a)("FixForInsertMediaSlideNavigationIssue")||(Sb=this.sa.Aa);ma=Sb.wt();var vc=this.Rq.slideWidth,gd=this.Rq.slideHeight;Ja=Ti.a.Cf(32,0);const od=Ti.a.Cf(32,1);vc=vc/2-Ti.a.Cf(16,0);gd=gd/2-Ti.a.Cf(16,1);if(Sb&&Sb.isConnected){var Vd=this.Eb.ud(15,void 0,void 0,()=>{this.Dr.YA=this.mGb;this.gb.selectShape(this.mGb,!0);this.Fa.Gd()});try{Vd.mc(Sb);Vd.Wc=v;Va&&Va.Wa("CreatingAudioShape","true");this.mGb=this.Vk.cFa(!1,Sb.Fb.cid,Sb.Fb.sid,
0,10,vc,gd,Ja,od,ma+1);const Ke=wb.files[0].name;this.mGb.V3b=S;this.mGb.T3b=Ke;Sb.ZB(this.mGb)}finally{Vd&&Vd.dispose()}Va&&(Va.Wa("AudioShapeSuccessfullyCreated","true"),Va.finish(),Va=null)}}}Object(k.a)(Bm,"InsertAudioActor",null,[948]);var yb=d(103);class zk{constructor(){this.WCb=this.Nvb=null}}Object(k.a)(zk,"CreatePickerCustomizationDictionaryOptions",null,[870]);var ya=d(167),md=d(28);class tl{}tl.Wg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(k.a)(tl,"InsertMediaDialogHtml",null,[]);class Jh{}Jh.Wg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(k.a)(Jh,"InsertMediaM365DialogHtml",null,[]);var pn=d(400);class jj{static get Wg(){return Kc.a.oC(jj.Hq,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}jj.Hq="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(k.a)(jj,"InsertOnlineVideoDialogHtml",null,[]);class kh extends Kc.a{constructor(v){super();this.SF(1,!0);this.Te(1,ResourceStrings.L_Insert);this.Wg=jj.Wg;this.Faa=v;this.bX=!1}zia(){this.width=50;this.Vj(ResourceStrings.L_OnlineVideo,Object(r.a)(this,this.wbk,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(na.a.FPc,na.a.SFi);const v=document.getElementById("url");this.SF(1,!!v&&0<v.value.length);
Za.a.addHandler(v,Ha.a.input,Object(r.a)(this,this.Dpd,"onPatternChanged"));Za.a.addHandler(v,Ha.a.change,Object(r.a)(this,this.Dpd,"onPatternChanged"));this.eT(v)}hide(){const v=document.getElementById("url");v&&(Za.a.removeHandler(v,Ha.a.input,Object(r.a)(this,this.Dpd,"onPatternChanged")),Za.a.removeHandler(v,Ha.a.change,Object(r.a)(this,this.Dpd,"onPatternChanged")));super.hide()}wbk(v,S){if(1===v){if(S){var ma=uj.a.Zj("InsertOnlineVideo",1);ma.gq=!0;v=S.url.trim();(v=this.Faa.xkj(v))?this.Faa.aHg(v)&&
this.Faa.Atk(v)?(Q.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.Faa.Iig(v)),this.Faa.requestVideoData(v,Ja=>{uj.a.gz(ma,()=>{this.u_(Ja)})},Object(r.a)(this,this.Blj,"failCallback"))):(Q.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.Faa.Iig(v)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(Q.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}u_(v){this.hide();
this.Faa.Ayg(v)}Blj(v){this.fail(v,ResourceStrings.l_CannotInsertOnlineVideo)}fail(v,S){if(document.getElementById("labelmessage")){var ma=+new Date-+this.Faa.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=S;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();v&&Q.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:ma,["ResponseCode"]:v.data.Ke}))}else Q.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}Dpd(){uj.a.iIa();const v=document.getElementById("url");this.SF(1,!!v&&0<v.value.length)}}Object(k.a)(kh,"InsertOnlineVideoDialog",Kc.a,[1321]);var ah=d(61),Vj=d(1135),dm=d(60);class hg{constructor(v,S,ma){this.BYb=Af.a.F9;this.BH=null;this.Ca=v;this.ENd=S;this.wDa=ma}get zn(){return this.Ca}get B9(){return this.BH||(this.BH=C.a.instance.resolve("Common.Utils.IAriaNotifier"))}get xx(){return this.BYb}set xx(v){this.BYb=v}Wva(v){try{n.ULS.sendTraceTag(21612195,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",v.length);const S=this.ENd.gkl(v);let ma=2;if(S&&0<S.length){const Ja=new Vj.DictionaryPropertySet;Ja.setValue(dm.a.bW,S);Ja.setValue(dm.a.v7c,!0);if(this.wDa){const Va=this.wDa.Hbf();Va.qPc("insertOnlineImage");Ja.setValue(dm.a.yTa,Va)}w.AFrameworkApplication.fa.getBooleanAppSetting("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.B9.K7(Box4Intl.Box4Strings.l_ImageUploading,!0);ma=this.Ca.Ia(this.xx,2,Ja)}n.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",v.length,32===ma,""===S)}catch(S){n.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",S.toString())}}}Object(k.a)(hg,"InsertOnlineImageHandler",null,[1231]);class vj extends hg{constructor(v,S,ma=null){super(v,S,ma)}get z2f(){return Qe.a.Ldc}get HCb(){return Qe.a.qbk}fth(v){return this.ENd.$dl(v)}Eng(v){return v.Type}e7c(v,S){return this.ENd.e7c(v.Type,
S)}gth(v){const S=[];if(v&&v.data&&v.data.value&&0<v.data.value.length)for(let Ja=0;Ja<v.data.value.length;Ja++)if(v.data.value[Ja]&&v.data.value[Ja].urls&&v.data.value[Ja].urls.download){var ma=v.data.value[Ja];ma=Object.assign(new bm.a,{OriginalUrl:ma.urls.download,Type:ma.extension||"",Caption:ma.name,ContentType:"",Height:ma.driveItem||ma.driveItem.image?ma.driveItem.image.height:0,Width:ma.driveItem||ma.driveItem.image?ma.driveItem.image.width:0});Array.add(S,ma)}S.length||n.ULS.sendTraceTag(26071184,
352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return S}rxh(v,S,ma){ma=ma(v);if(ma.length){v=[];for(let Ja=0;Ja<ma.length;Ja++){const Va=ma[Ja],wb={};wb.Extension=Va.Type;wb.SourceUrl=Va.OriginalUrl;wb.SourceUrl=Va.OriginalUrl;wb.Width=Va.Width;wb.Height=Va.Height;Array.add(v,wb)}ma={};ma.Items=v;S.sendMessage(this.HCb,ma)}}}Object(k.a)(vj,"InsertOnlineImageHelperBox4",hg,[1230,1231]);class en extends vj{constructor(v,S,ma){super(v,S);this.XPe=ma.insertOnlineVideoUrlPatterns;
this.xx=$a.a.rqe}Wva(v){if(v&&0<v.length){var S=Hc.a.GD(v[0].OriginalUrl);S=this.dye(S)?S:"unsupported";Q.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",S);this.zn.Ia(this.xx,2,v[0])}}dye(v){if(!v)return!1;v=v.trim();for(const S of this.XPe)if((new RegExp(S)).test(v))return!0;return!1}}Object(k.a)(en,"InsertOnlineVideoHelper",vj,[]);class M{static get Wg(){return Kc.a.oC(M.Hq,ResourceStrings.l_InsertSocialMediaDialogMsg)}}M.Hq="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";
Object(k.a)(M,"InsertSocailMediaDialogHtml",null,[]);var ck=d(85),wf=d(223);class fn extends Sys.EventArgs{constructor(v,S,ma,Ja){super();this.slideId=v;this.t_=ma;this.shapeId=S;this.iconName=Ja}}Object(k.a)(fn,"IconChangedEventArgs",Sys.EventArgs,[]);var rm=d(501);class pj{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He,$m,Ck,cl,Nk,xn,um,km,Fj,uk,Nn){this.ylc=this.HJa=this.c7c=!1;this.oKb=this.Boa=null;this.Cia=(Hh,vk,fq)=>{if(!this.qca(this.sa.Aa,Hh,this.ka.ceb))return 8;if(1===
fq)return 32;let go,fp;w.AFrameworkApplication.cD||w.AFrameworkApplication.Tw||!this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?w.AFrameworkApplication.cD||w.AFrameworkApplication.Tw||!this.ka.getBooleanAppSetting("CopilotDalleLicenseCheckEnabled")?this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&(fp="dalle"):this.X5.execute(pg=>{pg.isFeatureEnabled("Copilot",!1).then(ll=>{ll&&(fp="dallecore")})}):fp="dallecore";vk=new Pg.QueryStringBuilder(this.ICj(Hh));
vk.zg("entryPoint",$a.a.Fv(Hh));fp&&vk.zg(fp,"1");switch(Hh){case $a.a.gDb:case $a.a.Pdc:go=1;this.Eaa.xx=$a.a.Qdc;break;case $a.a.b5c:case $a.a.c5c:vk.lw("initpivot","dalle");go=1;this.Eaa.xx=$a.a.Qdc;break;case $a.a.Kdc:go=1;this.Eaa.xx=$a.a.h5c;break;case $a.a.pTa:id.a("ChangePictureFromIconsFixEnabled")?this.Pna.xx=$a.a.b5b:this.Pna.xx=$a.a.rRc;go=0;break;case $a.a.z$a:go=0;this.Pna.xx=$a.a.b5b;break;case $a.a.g5b:vk.lw("initpivot","dalle");go=0;this.Pna.xx=$a.a.b5b;break;case $a.a.Ibb:vk.zg("disabledpivots",
"stockvideos");go=0;this.Eaa.xx=$a.a.Zee;break;default:return Q.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",Hh.toString()),16}this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(vk.zg("gae","1"),w.AFrameworkApplication.KYa("0fecb342;2aaje503"));this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyIngestionExperiment",!1)&&(vk.zg("gie","1"),vk.zg("semsearch","1"),w.AFrameworkApplication.KYa("421a8839;gjbhf574"));
this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableHubbleSemanticSearchExperiment",!1)&&(vk.zg("ss","1"),w.AFrameworkApplication.KYa("fdfb7742;909ce823"));this.ka.geb&&vk.zg("sv","1");const gp=vk.toString();if(!gp||!gp.length)return 16;Q.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const pg=yb.a.create(),ll=hc.a.gM(this.ka.pptEditingUserId).toString();this.X5.execute(gq=>{var hq=this.ka.qyg&&gq.isFreemiumUpsellEnabled();hq=this.HJa?
1:hq?0:-1;var iq=this.Lb.getBooleanAppSetting("InsertOnlineM365ExperimentEnabled")?1:0;iq=this.GK.$Rf(md.App.mode,gp,hq,go,pg.toString(),ll,iq);gq=this.MHb.getInstance(iq,this.LHb,this.GK,gq,Jh.Wg);gq.correlationId=pg;gq.Eba=2;gq.mVc=hq;gq.zob(CommonUIStrings.L_PictureInsertTitle,Hh===$a.a.pTa||Hh===$a.a.z$a?this.Pna:this.Eaa,void 0);Q.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(pg){return Q.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",
pg.toString()),pj.zu(ck.a.F$b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}};this.ka=v;this.ia=S;this.ic=ma;this.oa=Ja;this.Fa=Va;this.sa=wb;this.Eb=Sb;this.MHb=vc;this.zKk=gd;this.LHb=od;this.GK=Vd;this.X5=Ke;this.Eaa=kg;this.Pna=If;this.Tb=yh;this.Vk=df;this.Ga=bg;this.yb=ih;this.Dr=He;this.Lj=$m;this.cib=Ck;this.RZa=um;this.sKe=km;this.Hc=Fj;this.DV=v.INb;this.Lb=Nn;this.cib&&(this.cib.ubb.removeAttribute("style"),this.cib.ubb.style.display="none");this.WLe=
cl;this.AKk=Nk;this.Faa=xn;this.N1=uk;this.X5.execute(Hh=>{Hh.isFeatureEnabled("MsoPremiumStockImages",!1).catch(vk=>Q.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",vk)).then(vk=>{this.HJa=vk;this.HJa||(this.Boa=Hh.OMa("MsoPremiumStockImages",()=>{this.HJa=!0;Q.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null});Hh.isFeatureEnabled("OmgStreamTwo",!1).then(vk=>{this.ylc=vk;this.ylc||
(this.Mch=Hh.OMa("OmgStreamTwo",()=>{this.ylc=!0}))})})}qb(){this.Kui();this.ia.pa($a.a.h5c,Jg.a.application,Object(r.a)(this,this.xlm,"uploadIcon"),4);id.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa($a.a.rRc,Jg.a.application,Object(r.a)(this,this.oRi,"changeToIcon"),4):this.ia.pa($a.a.rRc,Jg.a.application,Object(r.a)(this,this.pRi,"changeToIcon"),4);this.ia.pa($a.a.deb,Jg.a.application,Object(r.a)(this,this.yFd,"uploadOnlinePicture"),4);id.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa($a.a.f5b,
Jg.a.application,Object(r.a)(this,this.tRc,"changeToOnlinePicture"),4):this.ia.pa($a.a.f5b,Jg.a.application,Object(r.a)(this,this.uRc,"changeToOnlinePicture"),4);this.ia.pa($a.a.Qdc,Jg.a.application,Object(r.a)(this,this.yFd,"uploadOnlinePicture"),4);id.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa($a.a.b5b,Jg.a.application,Object(r.a)(this,this.tRc,"changeToOnlinePicture"),4):this.ia.pa($a.a.b5b,Jg.a.application,Object(r.a)(this,this.uRc,"changeToOnlinePicture"),4);this.ia.pa($a.a.j5c,Jg.a.application,
Object(r.a)(this,this.yFd,"uploadOnlinePicture"),4);id.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa($a.a.c5b,Jg.a.application,Object(r.a)(this,this.tRc,"changeToOnlinePicture"),4):this.ia.pa($a.a.c5b,Jg.a.application,Object(r.a)(this,this.uRc,"changeToOnlinePicture"),4);this.Jui();this.ia.pa($a.a.oyg,Jg.a.application,Object(r.a)(this,this.yFd,"uploadOnlinePicture"),4);id.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa($a.a.h4d,Jg.a.application,Object(r.a)(this,this.tRc,"changeToOnlinePicture"),
4):this.ia.pa($a.a.h4d,Jg.a.application,Object(r.a)(this,this.uRc,"changeToOnlinePicture"),4);this.Lui();this.ia.pa($a.a.rqe,Jg.a.application,Object(r.a)(this,this.Alm,"uploadOnlineVideo"),4);this.ia.pa($a.a.pqe,Jg.a.application,Object(r.a)(this,this.zlm,"uploadOnlineHubbleVideo"),4);this.ia.pa($a.a.iuc,qb.a.application,Object(r.a)(this,this.aim,"updateEntryPoints"),96)}Kui(){this.ia.pa($a.a.Kdc,Jg.a.application,this.Cia,4);this.ia.pa($a.a.pTa,Jg.a.application,this.Cia,4);this.ia.pa($a.a.insertOnlinePicture,
Jg.a.application,Object(r.a)(this,this.X$e,"showInsertPictureDialog"),4);this.ia.pa($a.a.d5b,Jg.a.application,Object(r.a)(this,this.X$e,"showInsertPictureDialog"),4);id.a("InsertSocialMediaVideoIcon")&&this.ia.pa($a.a.wyg,Jg.a.application,Object(r.a)(this,this.H0l,"showInsertSocialMediaDialog"),4);id.a("InsertDalleIcon")&&(this.ia.pa($a.a.b5c,Jg.a.application,this.Cia,4),this.ia.pa($a.a.c5c,Jg.a.application,this.Cia,4));this.ia.pa($a.a.gDb,Jg.a.application,this.Cia,4);this.ia.pa($a.a.z$a,Jg.a.application,
this.Cia,4);id.a("ChangePictureCreateWithAI")&&this.ia.pa($a.a.g5b,Jg.a.application,this.Cia,4);this.ia.pa($a.a.Pdc,Jg.a.application,this.Cia,4);this.ka.b9c&&(this.ia.pa($a.a.Ibb,Jg.a.application,this.Cia,4),this.ka.ocpsIsEnabled&&this.ia.r2a("ppt_insertOnlinePictures",$a.a.Ibb,Jg.a.application,this.Cia,v=>{md.App.Ob.ROa(v,this.N1.hva)}));this.ia.pa($a.a.hDb,Jg.a.application,Object(r.a)(this,this.Y$e,"showInsertPictureFromHostDialog"),4);this.ia.pa($a.a.e5b,Jg.a.application,Object(r.a)(this,this.Y$e,
"showInsertPictureFromHostDialog"),4);this.ka.ocpsIsEnabled&&(this.ia.r2a("ppt_insertOnlinePictures",$a.a.insertOnlinePicture,Jg.a.application,Object(r.a)(this,this.X$e,"showInsertPictureDialog"),v=>{md.App.Ob.ROa(v,Object(r.a)(this.N1,this.N1.hva,"getCommandById"))}),this.ia.r2a("ppt_insertOnlinePictures",$a.a.gDb,Jg.a.application,this.Cia,v=>{md.App.Ob.ROa(v,Object(r.a)(this.N1,this.N1.hva,"getCommandById"))}),this.ia.r2a("ppt_insertOnlinePictures",$a.a.Pdc,Jg.a.application,this.Cia,v=>{md.App.Ob.ROa(v,
Object(r.a)(this.N1,this.N1.hva,"getCommandById"))}),this.ia.r2a("ppt_insertOnlinePictures",$a.a.hDb,Jg.a.application,Object(r.a)(this,this.Y$e,"showInsertPictureFromHostDialog"),v=>{md.App.Ob.ROa(v,Object(r.a)(this.N1,this.N1.hva,"getCommandById"))}))}Jui(){this.ka.n5c&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.pa($a.a.m5c,Jg.a.application,Object(r.a)(this,this.MAd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.pa($a.a.h5b,
Jg.a.application,Object(r.a)(this,this.MAd,"showInsertPictureFromMobileDeviceDialog"),4),this.ka.ocpsIsEnabled&&(this.ia.r2a("mso_insertMobileDevicePictures",$a.a.m5c,Jg.a.application,Object(r.a)(this,this.MAd,"showInsertPictureFromMobileDeviceDialog"),v=>{md.App.Ob.ROa(v,Object(r.a)(this.N1,this.N1.hva,"getCommandById"))}),this.ia.r2a("mso_insertMobileDevicePictures",$a.a.h5b,Jg.a.application,Object(r.a)(this,this.MAd,"showInsertPictureFromMobileDeviceDialog"),v=>{md.App.Ob.ROa(v,Object(r.a)(this.N1,
this.N1.hva,"getCommandById"))})))}Lui(){this.ia.pa($a.a.Xva,Jg.a.application,Object(r.a)(this,this.gSb,"showInsertVideoDialog"),4);this.ka.ocpsIsEnabled&&this.ia.r2a("ppt_insertOnlineVideos",$a.a.Xva,Jg.a.application,Object(r.a)(this,this.gSb,"showInsertVideoDialog"),v=>{md.App.Ob.ROa(v,Object(r.a)(this.N1,this.N1.hva,"getCommandById"))})}ikl(){w.AFrameworkApplication.$ec()&&w.AFrameworkApplication.VQh()&&(w.AFrameworkApplication.za.get_element().appendChild(this.cib.ubb),Za.a.addHandler(this.cib.ubb.contentWindow,
"message",Object(r.a)(this,this.aSh,"showOneDriveFilePickerDialog")),this.c7c=!0)}aSh(v){if(v.rawEvent&&(v=v.rawEvent.data))try{Q.a.J(512517961,352,50,"User select images.");const S=Sys.Serialization.JavaScriptSerializer.deserialize(v,!0),ma=S.MessageId?S.MessageId.toString():null;S&&ma&&(ma===Qe.a.Ldc||ma===Qe.a.nqe)&&this.WLe.start(ma===Qe.a.Ldc?this.Eaa:this.AKk)}catch(S){Q.a.J(512517960,352,10,"malformatted postmessage here.")}}Sd(){}aim(){return 32}X$e(v,S,ma){if(!this.qca(this.sa.Aa,v,this.ka.pptInsertOnlinePictureEnabled))return 8;
if(1===ma)return 32;Q.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Ja=yb.a.create(),Va=hc.a.gM(this.ka.pptEditingUserId).toString(),wb=v===$a.a.insertOnlinePicture&&this.ka.Oil?1:0;let Sb=String.format(this.ka.insertPictureServiceEndpoint,w.AFrameworkApplication.lcid,yk.a.Oe(w.AFrameworkApplication.lcid).name,w.AFrameworkApplication.buildVersion,Ja.toString(),3,Va,wb);0<this.ka.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net","gi"))&&
(Sb=this.GK.IKi(md.App.mode,this.ka.pptInsertOnlineContentImagesEnabled?this.ka.insertOnlineContentImagesEndpoint:this.ka.insertPictureServiceEndpoint));this.X5.execute(vc=>{vc=this.MHb.getInstance(Sb,this.LHb,this.GK,vc,tl.Wg);vc.insertPictureTelemetryEndpoint=this.ka.insertPictureTelemetryEndpoint;vc.correlationId=Ja;vc.Eba=1;switch(v){case $a.a.d5b:this.Pna.xx=$a.a.f5b;break;default:this.Eaa.xx=$a.a.deb}vc.zob(CommonUIStrings.L_PictureInsertTitle,v===$a.a.insertOnlinePicture?this.Eaa:this.Pna,
void 0);Q.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Ja){return Q.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Ja.toString()),pj.zu(ck.a.F$b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}H0l(v,S,ma){if(1===ma)return 32;v=new Kc.a(void 0,void 0,!1);v.Fd=5;v.Wg=M.Wg;v.Vj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});
Q.a.J(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}ICj(v){switch(v){case $a.a.gDb:case $a.a.Pdc:case $a.a.b5c:case $a.a.c5c:case $a.a.Ibb:return this.ka.qqe;case $a.a.Kdc:return this.ka.i5c;case $a.a.pTa:return id.a("ChangePictureFromIconsFixEnabled")?this.ka.i5c:this.ka.fRi;case $a.a.z$a:case $a.a.g5b:return this.ka.gRi;default:return this.ka.qqe}}Y$e(v,S,ma){if(!this.qca(this.sa.Aa,v,w.AFrameworkApplication.$ec()&&(pj.jug?!!this.WLe.EMb&&9<this.WLe.EMb.length:
!0)))return 8;if(1===ma)return 32;Q.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{S=!0;let Ja=0;if(this.Lb.getBooleanAppSetting("InsertMediaSharedFilePickerEnabled")){const wb=C.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(wb.Gxe()){S=!1;const Sb=this.ka.tyg;ma=!1;this.ka.n5c&&(ma=this.ttj());const vc=Object.assign(new zk,{Nvb:ma,WCb:!0}),gd=wb.J7d(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,
!0,!1,!0,Sb,"InsertPicture",0,vc);wb.U_c(gd).then(od=>{if(od&&0<od.length){const Vd=[];for(let Ke=0;Ke<od.length;Ke++){const kg=od[Ke][fe.a.KXe],If={};If.Extension=od[Ke][fe.a.uuh];If.OriginalUrl=fe.a.FXe in od[Ke]?od[Ke][fe.a.FXe]:kg;If.Type=fe.a.GXe in od[Ke]?od[Ke][fe.a.GXe]:"";If.Caption=fe.a.JXe in od[Ke]?od[Ke][fe.a.JXe]:"";If.Description=fe.a.EXe in od[Ke]?od[Ke][fe.a.EXe]:"";If.Width=fe.a.IXe in od[Ke]?od[Ke][fe.a.IXe]:0;If.Height=fe.a.HXe in od[Ke]?od[Ke][fe.a.HXe]:0;Array.add(Vd,If)}this.qDj(v).Wva(Vd);
Q.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Ja=32}).catch(od=>{Q.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",od.toString());pj.zu(ck.a.F$b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Ja=8})}}if(!S)return Ja;pj.jug=!0;this.c7c||this.ikl();const Va=this.zKk.getInstance();Va.Eba=4;switch(v){case $a.a.e5b:this.Pna.xx=$a.a.c5b;break;default:this.Eaa.xx=
$a.a.j5c}Va.zob(CommonUIStrings.L_PictureInsertTitle,v===$a.a.hDb?this.Eaa:this.Pna,void 0);Q.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Ja){return Q.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Ja.toString()),pj.zu(ck.a.F$b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}qDj(v){if(!id.a("ChangePictureFromOneDriveFixEnabled"))return this.Eaa;const S=
(v=v===$a.a.hDb)?this.Eaa:this.Pna;S.xx=v?$a.a.j5c:$a.a.c5b;return S}ttj(){return C.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").Evj()}MAd(v,S,ma){if(!this.qca(this.sa.Aa,v,this.ka.n5c&&this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===ma)return 32;C.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").nmj(this.Lb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",
!1));try{let Ja=0;const Va=C.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Va.Gxe()){const wb=v===$a.a.m5c,Sb=this.ka.tyg,vc=Object.assign(new zk,{Nvb:!0,WCb:!0}),gd=Va.J7d(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,wb,Sb,"InsertPictureFromMobile",3,vc);Va.U_c(gd).then(od=>{if(od&&0<od.length){const Vd=[];let Ke=!1;const kg=this.Lb.Ea("PhoneLinkServiceEndpoint");for(let If=0;If<od.length;If++){const yh=od[If][fe.a.KXe],df=od[If],bg=
{};bg.Extension=od[If][fe.a.uuh];bg.OriginalUrl=this.VOb(df,fe.a.FXe,yh);bg.Type=this.VOb(df,fe.a.GXe,"");bg.Caption=this.VOb(df,fe.a.JXe,"");bg.Description=this.VOb(df,fe.a.EXe,"");bg.Width=this.VOb(df,fe.a.IXe,0);bg.Height=this.VOb(df,fe.a.HXe,0);Array.add(Vd,bg);Ke||(Ke=-1!==bg.OriginalUrl.indexOf(kg))}od=wb?this.Eaa:this.Pna;od.xx=Ke?wb?$a.a.oyg:$a.a.h4d:wb?$a.a.j5c:$a.a.c5b;od.Wva(Vd);Q.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Ja=
32}).catch(od=>{Q.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",od.toString());Ja=8})}return Ja}catch(Ja){return Q.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Ja.toString()),8}}VOb(v,S,ma){return S in v?v[S]:ma}yFd(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.pptInsertOnlinePictureEnabled))return 8;if(1===ma)return 32;
if(!this.Lj.UD(S,1))return this.Lj.yE(S),16;try{const wb=S.U0(this.oa.Hd());if(wb&&this.ic.Xc(wb))return 16;const Sb=this.Pcb(S,wb);let vc=null;const gd=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.oa.selectShape(Sb,!0);vc&&this.oa.selectShape(vc,!1)});try{gd.mc(S);gd.Wc=$a.a.insertOnlinePicture;gd.ny[wf.a.Rea]=wf.a.Xkb;ma=null;v={["actionId"]:v};if(this.ka.pptInsertOnlinePictureAttributionIsEnabled)if(Va.LicenseUrl&&Va.LicenseDisplayName){const od=pj.ZYe(Va);ma=ya.c(od);
if(this.ka.pptImageAttributionSelectionImprove){const Vd=S.Fb;vc=this.Vk.Cla(!0,Vd.cid,Vd.sid,0,0,0,ah.a.KS,ah.a.EZ,S.wt()+1,!1)}}else v["result.LicenseDisplayName"]=Va.LicenseDisplayName,v["result.LicenseUrl"]=hc.a.gM(Va.LicenseUrl);else v.IsEnabled=this.ka.pptInsertOnlinePictureAttributionIsEnabled;Q.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",v);Sb.kRb(Va.OriginalUrl,Va.LicenseUrl?null:Va.Caption,ma,Va.PageUrl);wb&&S.XS([wb]);S.ZB(Sb);vc&&(S.ZB(vc),Sb.U9a=vc.id,vc.Jdb=!0)}finally{gd&&
gd.dispose()}this.Dr.YA=Sb;return 32}catch(wb){return Q.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",wb.toString()),8}}uRc(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.qMa))return 8;if(1===ma)return 32;Q.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Va)return 16;try{const wb=this.mcb()||this.a0c();if(!wb||this.ic.Xc(wb))return 16;let Sb=null;
const vc=this.Eb.ud(15,void 0,void 0,()=>{this.oa.selectShape(wb,!0);Sb&&this.oa.selectShape(Sb,!1);Q.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{vc.mc(S);vc.Wc=$a.a.f5b;vc.ny[wf.a.Rea]=wf.a.Xkb;v=null;if(this.ka.pptInsertOnlinePictureAttributionIsEnabled&&Va.LicenseUrl&&Va.LicenseDisplayName){const gd=pj.ZYe(Va);v=ya.c(gd);if(this.ka.pptImageAttributionSelectionImprove){const od=S.Fb;Sb=this.Vk.Cla(!0,od.cid,od.sid,0,0,0,ah.a.KS,ah.a.EZ,S.wt()+
1,!1);Q.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}wb.kRb(Va.OriginalUrl,Va.LicenseUrl?null:Va.Caption,v,Va.PageUrl);wb.set_isSVGBlipFilled(!1);Sb&&(S.ZB(Sb),wb.U9a=Sb.id,Sb.Jdb=!0)}finally{vc&&vc.dispose()}this.Dr.YA=wb;return 32}catch(wb){return Q.a.J(512517905,352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",wb.toString()),8}}tRc(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517911,
352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.qMa))return 8;if(1===ma)return 32;Q.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Va)return 16;try{var wb=this.oa.Hd();v=[];for(var Sb of wb)Sb.Lf||v.push(Sb);for(const gd of v)if(!gd||this.ic.Xc(gd))return 16;wb=null;const vc=this.Eb.ud(15,void 0,void 0);try{vc.mc(S);vc.Wc=$a.a.f5b;vc.ny[wf.a.Rea]=wf.a.Xkb;Sb=null;if(this.ka.pptInsertOnlinePictureAttributionIsEnabled&&Va.LicenseUrl&&Va.LicenseDisplayName){const od=
pj.ZYe(Va);Sb=ya.c(od);if(this.ka.pptImageAttributionSelectionImprove){const Vd=S.Fb;wb=this.Vk.Cla(!0,Vd.cid,Vd.sid,0,0,0,ah.a.KS,ah.a.EZ,S.wt()+1,!1);Q.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const gd=Va.LicenseUrl?null:Va.Caption;for(const od of v)od.kRb(Va.OriginalUrl,gd,Sb,Va.PageUrl),od.set_isSVGBlipFilled(!1),wb&&(S.ZB(wb),od.U9a=wb.id,wb.Jdb=!0)}finally{vc&&vc.dispose()}this.Dr.YA=v[0];return 32}catch(vc){return Q.a.J(512517904,
352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",vc.toString()),8}}xlm(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.ceb))return 8;if(1===ma)return 32;Q.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Va||!Va.length)return 16;if(!this.Lj.UD(S,Va.length))return this.Lj.yE(S),16;try{let wb=null;ma=null;if(!({dgl:ma,Ufl:wb}=this.mIj(Va,S)).returnValue)return 16;const Sb=this.Eb.ud(15,
void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.oa.$2a(wb,!0)});try{for(Sb.mc(S),Sb.Wc=v,Sb.ny[wf.a.Rea]=wf.a.icon,ma&&S.XS(ma),v=0;v<wb.length;v++)S.ZB(wb[v])}finally{Sb&&Sb.dispose()}this.Dr.YA=wb[wb.length-1];return 32}catch(wb){return Q.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",Va.length,wb.toString()),8}}mIj(v,S){const ma=Array(v.length),Ja=Array(v.length);var Va=S.LZc(this.oa.Hd());if(Va&&0<Va.length){var wb=0;for(const Sb of Va)if(Sb&&
!this.ic.Xc(Sb)&&wb<v.length&&(ma[wb]=Sb,wb++,wb===v.length))break}Va=!0;for(wb=0;wb<ma.length;wb++)this.ka.svgIconLocalEditingIsEnabled&&v[wb].SvgContent&&0<v[wb].SvgContent.length&&(!ma[wb]||ma[wb]&&15!==ma[wb].mj)?Ja[wb]=this.kIj(S,ma[wb],v[wb],wb):(Ja[wb]=this.W1c(S,ma[wb],v[wb],!0,wb),Va=!1),Va&&uj.a.CQ(!0,!0),Ja[wb].kRb(v[wb].OriginalUrl,v[wb].Caption,null,null);return{returnValue:!0,dgl:ma,Ufl:Ja}}kIj(v,S,ma,Ja){if(!v)return null;var Va=v.Fb,wb=v.wt();v=Object(N.a)(227,v.sc(this.yb.Na));const {ede:Sb,
gD:vc}=this.RZa.k6d(S,ma.Width,ma.Height);Ja=S?0:Ja*pn.a.tU;Va=this.Vk.Cla(!0,Va.cid,Va.sid,0,vc.x+Ja,vc.y+Ja,Sb.width,Sb.height,wb+1,!1);wb=this.RZa.j2d(this.yb.Xd,Sb,vc,v.cV);Va.ZS=wb;Va.isResizable=!0;Va.ifc=!0;Va.SM=!0;Va.Cha=!0;Va.set_isSVGBlipFilled(!0);ma=this.sKe.FJl(ma.SvgContent);Va.lga=ma?String.format("data:image/svg+xml;charset=utf8,{0}",encodeURIComponent(ma)):"";S&&(Va.J4=S.id);return Va}oRi(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.qca(S,
v,this.ka.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ma)return 32;Q.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Va||!Va.length)return 16;try{const wb=this.oa.Hd(),Sb=[];for(const od of wb)od.Lf||Sb.push(od);const vc=Va[0].Caption;for(const od of Sb){if(!Sb||this.ic.Xc(od))return 16;const Vd=this.Ga.Hs(od);vc&&Vd&&this.Hc.gzh(new fn(S.Fb,od.get_shapeId(),od.get_smartArtModelId(),vc))}const gd=this.Eb.ud(15,void 0,void 0,()=>{for(const od of Sb){const Vd=this.Ga.Hs(od);
Vd&&(this.Hc.$td(),this.oa.selectShape(Vd,!0),this.Hc.Ztd())}Q.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{gd.mc(Sb[0]);gd.Wc=v;gd.ny[wf.a.Rea]=wf.a.icon;for(const od of Sb)od.set_isSVGBlipFilled(!0),od.kRb(Va[0].OriginalUrl,vc,null,null)}finally{gd&&gd.dispose()}for(const od of Sb)this.ic.Kta(S,od,this.yb.Na,v);return 32}catch(wb){return Q.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Va.length,wb.toString()),8}}pRi(v,
S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ma)return 32;Q.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Va||!Va.length)return 16;try{const wb=this.a0c()||this.mcb();if(!wb||this.ic.Xc(wb))return 16;const Sb=Va[0].Caption,vc=this.Ga.Hs(wb);Sb&&vc&&this.Hc.gzh(new fn(S.Fb,wb.get_shapeId(),wb.get_smartArtModelId(),Sb));const gd=this.Eb.ud(15,
void 0,void 0,()=>{vc&&(this.Hc.$td(),this.oa.selectShape(vc,!0),this.Hc.Ztd());Q.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{gd.mc(wb),gd.Wc=v,gd.ny[wf.a.Rea]=wf.a.icon,wb.set_isSVGBlipFilled(!0),wb.kRb(Va[0].OriginalUrl,Sb,null,null)}finally{gd&&gd.dispose()}(ma=vc||wb)&&this.ic.Kta(S,ma,this.yb.Na,v);return 32}catch(wb){return Q.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Va.length,wb.toString()),
8}}a0c(){let v=null;const S=this.oa.Hd();for(const ma of S)if(ma&&ma.get_isSVGBlipFilled())if(v)break;else v=ma;return v}mcb(){if(this.DV){const v=this.oa.Hd();return v&&v.length?this.V0d(v)?v[0]:this.eBb():null}return this.eBb()}V0d(v){if(!v||!v.length)return!1;let S=v[0].$j,ma=1===v[0].mediaType;for(const Ja of v)S=S&&Ja.$j,ma=ma&&1===Ja.mediaType;return S||ma}eBb(){const v=this.oa.Hd();for(const S of v)if(S&&S.$j)return S;return null}OKg(v,S){const ma=this.Lb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal",
"defaultModal");"defaultModal"!==ma&&Q.a.J(v,352,15,`${S}::Modal:${ma}`)}gSb(v,S,ma){if(!this.qca(this.sa.Aa,v,this.ka.pptInsertOnlineVideoEnabled))return 8;if(1===ma)return 32;this.oKb=uj.a.Zj("ShowInsertVideoDialog",1);const Ja=this.Lb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.ka.insertVideoOnlineFromHubbleEnabled){Q.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const wb=yb.a.create(),
Sb=hc.a.gM(this.ka.pptEditingUserId).toString();let vc;const gd=this.ylc&&this.ka.getBooleanAppSetting("InsertStream2FlowEnabled")&&this.ka.aFb&&this.ka.getBooleanAppSetting("GetCustomHeaderEnabled");gd&&(vc=C.a.instance.resolve("Common.App.OAuth.IOAuthManager"));Q.a.J(508822735,352,50,"InsertMediaActor::ShowInsertVideoDialog : Licensing enabled for user: {0} with correlationId: {1}",this.ylc,wb);this.X5.execute(od=>{od=this.MHb.getInstance(this.GK.KKi(md.App.mode,this.ka.Tbk,wb.toString(),Sb,gd,
Ja),this.LHb,this.GK,od,Jh.Wg);od.correlationId=wb;od.Eba=5;const Vd=new en(this.ia,this.GK,this.ka);Vd.xx=$a.a.pqe;od.zob(CommonUIStrings.L_VideoInsertTitle,Vd,vc)})}else this.ka.insertVideoOnlineFromUrlEnabled?(Q.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new kh(this.Faa)).zia()):(Q.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.X5.execute(wb=>{this.MHb.getInstance(this.GK.LKi(md.App.mode,this.ka.insertVideoServiceEndpoint),
this.LHb,this.GK,wb,tl.Wg).zob(CommonUIStrings.L_VideoInsertTitle,new en(this.ia,this.GK,this.ka),void 0)}));this.OKg(512557208,"ShowInsertOnlineVideoDialog");null!=this.oKb&&Object(rm.a)(this.oKb.actionName,(new Date).getTime()-this.oKb.RE.getTime(),"InsertOnlineVideoDialog",this.oKb.actionId,this.oKb.tk);const Va=this.Lb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");id.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Va&&
Q.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Va);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Lb.b$b){const wb=this.Lb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";Q.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+wb)}Q.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Va){return Q.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",
Va.toString()),pj.zu(ck.a.F$b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}Alm(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.pptInsertOnlineVideoEnabled))return 8;if(1===ma)return 32;if(!this.Lj.UD(S,1))return this.Lj.yE(S),16;try{const wb=S.U0(this.oa.Hd());if(wb&&this.ic.Xc(wb))return 16;const Sb=this.Pcb(S,wb),vc=this.GK.FRj(Va.OriginalUrl);Sb.k8e(vc,Va.ThumbnailUrl,Va.Caption,Va.Description,
0<Va.Width?Va.Width:0,0<Va.Height?Va.Height:0);const gd=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.oa.selectShape(Sb,!0)});try{gd.mc(S),gd.Wc=v,wb&&S.XS([wb]),S.ZB(Sb)}finally{gd&&gd.dispose()}Q.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.Dr.YA=Sb;return 32}catch(wb){return Q.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",wb.toString()),8}}zlm(v,S,ma,Ja,Va){S=this.sa.Aa;if(!S)return Q.a.J(512517850,
352,50,"Active Slide is null"),8;if(!this.qca(S,v,this.ka.insertVideoOnlineFromHubbleEnabled))return 8;if(1===ma)return 32;Q.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.Lj.UD(S,1))return this.Lj.yE(S),16;try{const wb=S.U0(this.oa.Hd());if(wb&&this.ic.Xc(wb))return 16;const Sb=this.Pcb(S,wb),vc=0<Va.Width?Va.Width:0,gd=0<Va.Height?Va.Height:0;let od=Va.PageUrl;this.ka.aFb&&"odspbusiness"===Va.ProviderName.toLocaleLowerCase()&&(od=Va.OriginalUrl);Sb.k8e(od,
Va.ThumbnailUrl,Va.Caption,Va.Description,vc,gd);const Vd=this.Eb.ud(15,void 0,()=>{this.oa.Pu();this.oa.Bh();this.Fa.Gd()},()=>{this.oa.selectShape(Sb,!0)});try{Vd.mc(S),Vd.Wc=v,wb&&S.XS([wb]),S.ZB(Sb)}finally{Vd&&Vd.dispose()}this.OKg(512557200,"InsertOnlineHubbleVideo");Q.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Va.StartInsertTime);this.Dr.YA=Sb;return 32}catch(wb){return Q.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",
wb.toString()),8}}qca(v,S,ma){v=!!v&&ma&&!this.ic.Xc(v);switch(S){case $a.a.pTa:return v&&(!!this.mcb()||!!this.a0c());case $a.a.d5b:case $a.a.e5b:case $a.a.h5b:case $a.a.z$a:return v&&this.CSi();default:return v}}CSi(){const v=this.mcb()||this.a0c();return!v||this.ka.enableCameoInEditor&&v.lF?!1:this.Ga.Hs(v)?!1:!0}Pcb(v,S){return this.W1c(v,S,null,!1,0)}W1c(v,S,ma,Ja,Va){if(!v)return null;var wb=v.Fb;v=v.wt();let Sb;Ja?{width:ma,height:Sb}=pj.BOj(S,ma):(ma=ah.a.KS,Sb=ah.a.EZ);let vc;vc=S?S.uBb(ma,
Sb):this.Tb.Ama(ma,Sb);Va=S?0:Va*pn.a.tU;wb=this.Vk.Cla(!0,wb.cid,wb.sid,0,vc.x+Va,vc.y+Va,ma,Sb,v+1,!0);wb.set_isSVGBlipFilled(Ja);S&&(wb.J4=S.id);return wb}dispose(){this.X5.instance&&(this.Boa&&this.X5.instance.s2a("MsoPremiumStockImages",this.Boa),this.Mch&&this.X5.instance.s2a("OmgStreamTwo",this.Mch));this.c7c&&this.cib.ubb.contentWindow&&(Za.a.removeHandler(this.cib.ubb.contentWindow,"message",Object(r.a)(this,this.aSh,"showOneDriveFilePickerDialog")),this.c7c=!1)}static wLi(){const v=CommonUIStrings.l_AttributionText.split(/[{}]+/);
return Le.e(v,S=>!!S)}static GKi(v,S){const ma=document.createElement("body");var Ja="";let Va="",wb=CommonUIStrings.L_CCYYSA;void 0!==S&&null!==S&&(void 0!==S.PageUrl&&null!==S.PageUrl&&(Ja=S.PageUrl),void 0!==S.LicenseDisplayName&&null!==S.LicenseDisplayName&&0<S.LicenseDisplayName.length&&(wb=S.LicenseDisplayName),void 0!==S.LicenseUrl&&null!==S.LicenseUrl&&(Va=S.LicenseUrl));for(const Sb of v){switch(Sb){case "L_ThePhoto":v=pj.YRf(CommonUIStrings.l_ThePhoto,Ja);break;case "L_CCYYSA":v=pj.YRf(wb,
Va);break;case "L_PhotoAuthor":v=pj.sSf(CommonUIStrings.l_PhotoAuthor);break;default:v=pj.sSf(Sb)}v&&ma.appendChild(v)}Ja=document.createElement("html");Ja.appendChild(ma);return Ja}static sSf(v){const S=document.createElement("span");S.innerText=v;return S}static YRf(v,S){const ma=document.createElement("A");ma.setAttribute("href",S);ma.setAttribute("target","_blank");ma.setAttribute("rel","noreferrer");S=document.createElement("span");S.innerText=v;ma.appendChild(S);return ma}static ZYe(v){const S=
pj.wLi();return pj.GKi(S,v)}static zu(){}static BOj(v,S){let ma;v&&15===v.mj?(ma=Ti.a.Ve(v.ljf,0,!1),v=Ti.a.Ve(v.Wne,0,!1)):S&&0<S.Width&&0<S.Height?(ma=S.Width,v=S.Height):(ma=Ti.a.Ve(2,0,!1),v=Ti.a.Ve(2,0,!1));return{width:ma,height:v}}}pj.jug=!1;Object(k.a)(pj,"InsertMediaActor",null,[948]);var ul=d(550);class eg{}eg.M$l=864E5;eg.wBi=3;eg.V1k=144E5;Object(k.a)(eg,"AddinConstantsNum",null,[]);var ni=d(201),wc=d(390),kj=d(454);class $c{constructor(v,S,ma,Ja=null){this.fa=Ja?Ja:w.AFrameworkApplication.fa;
this.ANd=2;this.Tdb=v;this.hri=S;this.Xx=ma}get fHa(){return this.ANd}get Ylm(){return this.hri}a5e(v){if(this.fa.getBooleanAppSetting("AgaveSupportsLiveIdSpoofing"))this.Tdb(v,this.fHa,{["ak0"]:(new Date).getTime()});else if(kj.a.tQh(v)){var S=String.format(w.AFrameworkApplication.za.mb.yha+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",w.AFrameworkApplication.za.mb.Ej,this.Ylm,w.AFrameworkApplication.mh);const ma=w.AFrameworkApplication.Me;let Ja=null;this.Xx&&(Ja=this.Xx.lj("ComponentAttach",
wc.a[v]+ul.a[this.fHa]));ma.Tj(S,1,null,null,!0,4,Va=>{this.ral(v,Va.data.Ud);Ja&&Ja.stop()},Va=>{n.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Va.data.Ke);this.uMb(v,1,"request failed");Ja&&Ja.stop()},null)}else kj.a.pne(v)?(S=kj.a.Ffe(v),this.Tdb(v,this.fHa,{["ak0"]:S})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.VJ?this.uMb(v,1,"no local timestamp"):this.Tdb(v,this.fHa,null))}ral(v,S){if(S&&""!==S)if(S=
Sys.Net.XMLDOM(S)){kj.a.uBc(ni.a.w_d,((new Date).getTime()+eg.V1k).toString(),v);let ma=S.getElementsByTagName("update");ma&&ma.length||(ma=S.getElementsByTagName("o:update"));ma&&0<ma.length?(S=Date.parse(ma[0].firstChild.nodeValue),kj.a.Ffe(v)<S||kj.a.pne(v)?this.Tdb(v,this.fHa,{["ak0"]:S}):this.uMb(v,1,"outdate timestamp in reponse")):this.uMb(v,2,"no timestamp in response")}else this.uMb(v,1,"response data is invalid");else this.uMb(v,1,"no responseData")}uMb(v,S,ma){this.VJ&&this.Tdb(v,this.fHa,
{["AddinServiceUserState"]:S,["DiagnosticInfo"]:ma})}get VJ(){return this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(k.a)($c,"AddinCommandsAnonymousAPIInitializer",null,[476]);class jg{constructor(v,S,ma){this.ANd=ma;this.Tdb=v;this.Di=S}get fHa(){return this.ANd}a5e(v){let S=null;this.Di&&(S=this.Di.lj("ComponentAttach",wc.a[v]+ul.a[this.fHa]));
(null==this.l$e(v)?0:this.l$e(v))&&this.Tdb(v,this.fHa,{["ak0"]:(new Date).getTime()-eg.wBi*eg.M$l});S&&S.stop()}}Object(k.a)(jg,"AddinCommandsInitializerBase",null,[476]);class mk extends jg{constructor(v,S){super(v,S,5)}l$e(){return!0}}Object(k.a)(mk,"AddinCommandsInitializer",jg,[]);class Kh extends jg{constructor(v,S){super(v,S,1)}l$e(v){try{const S=ni.a.qjg()+v;return Boolean.parse(this.Dvj(S)||"false")}catch(S){n.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",S.toString())}return null}Dvj(v){const S=
localStorage;return void 0!==S&&null!==S?S.getItem(v):null}}Object(k.a)(Kh,"AddinCommandsLocalCacheInitializer",jg,[]);class Yg{constructor(v,S=null){this.Xx=v;this.fa=S?S:w.AFrameworkApplication.fa}get appUILocale(){return yk.a.Oe(w.AFrameworkApplication.lcid).name}K9j(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var v={};v[ni.a.Pej]="TeachingCallout";this.Esd(F.a.Bcm,v)}const S=this.Wfe();if(S)if(this.fa.getBooleanAppSetting("OcpsIsEnabled"))C.a.instance.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ma=>{ma.isFeatureEnabled("ConnectedServices",!0).then(Ja=>{for(const Va of S){if(!Ja&&0===Va.key){this.VJ&&this.EZh(0,Va.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});
continue}const wb=this.nfg(Va.value);wb&&wb.a5e(Va.key)}return null})});else for(const ma of S)(v=this.nfg(ma.value))&&v.a5e(ma.key)}b5e(v,S,ma){ma&&ma[ni.a.G9a]?(ma[ni.a.Rka]=v,ma[ni.a.Qka]=S,this.Esd(F.a.QPb,ma),kj.a.uBc(ni.a.G9a,ma[ni.a.G9a].toString(),v)):this.VJ?this.EZh(v,S,ma):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===v&&(ma={},ma[ni.a.Rka]=v,ma[ni.a.Qka]=S,this.Esd(F.a.QN,ma))}nfg(v){let S=null;switch(v){case 1:S=new Kh(Object(r.a)(this,
this.b5e,"retrieveAddinFlagCompleted"),this.Xx);break;case 2:S=new $c(Object(r.a)(this,this.b5e,"retrieveAddinFlagCompleted"),this.appUILocale,this.Xx,this.fa);break;case 5:S=new mk(Object(r.a)(this,this.b5e,"retrieveAddinFlagCompleted"),this.Xx)}return S}EZh(v,S,ma){0===v&&ma&&ma[ni.a.LOc]&&(ma[ni.a.Rka]=v,ma[ni.a.Qka]=S,n.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",ma[ni.a.LOc].toString(),JSON.stringify(ma)),this.Esd(F.a.QN,ma))}get VJ(){return this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(k.a)(Yg,"AddinCommandsInitializerHost",null,[]);var em=d(1174),sh=d(152);class Vk extends Yg{constructor(v,S){super(v.hpg());this.Ep=v;this.Lb=S;em.a.Wcc=em.a.Dvh}Sdm(){this.K9j()}Wfe(){const v=new sh.a;this.Lb.getBooleanAppSetting("51")&&(v.$(0,2),v.$(16,5));this.Lb.getBooleanAppSetting("187")&&v.$(1,1);this.Ep.td.Zva&&v.$(8,1);this.Lb.getBooleanAppSetting("305")&&v.$(10,5);return v}Esd(v,S){this.Ep.bI().Ia(v,
2,S)}}Object(k.a)(Vk,"AddinCommandsInitService",Yg,[1274]);class vl{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}fc(v){this.K=v;C.a.instance.register(Vk,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").na(()=>new Vk(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bzg&&this.K.resolve("Common.IAppSettingsManager").Ue(()=>
{C.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").Sdm()})}dispose(){}}Object(k.a)(vl,"AddInCommandsInitPackage",null,[2,3]);class gl extends Sd{constructor(v,S=null,ma=null){super(v,!0,S,!1,void 0,ma)}get Joe(){return null}get spa(){return this.B6c?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:w.AFrameworkApplication.tua?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get EFb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get MOc(){return null}get B6c(){return"VersionHistory"===
this.oPi?!1:w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}PFb(){n.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");w.AFrameworkApplication.KYa("tcopypdf;ccopypdf")}}Object(k.a)(gl,"DownloadAsPdfDialog",Sd,[]);class lj extends gl{constructor(v){super(v)}get spa(){return w.AFrameworkApplication.tua?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}PFb(){Q.a.J(25544926,801,
50,"Images download dialog displayed")}thc(){Q.a.J(25544928,801,50,"Images download dialog link clicked")}Lfb(){Q.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(k.a)(lj,"DownloadACopyAsImagesDialog",gl,[]);var Ij=d(203);class qa extends Xe{constructor(v){super(v,void 0,w.AFrameworkApplication.tua)}get spa(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get EFb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get dhc(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get g7b(){return w.AFrameworkApplication.tua?
"UIFontDialogTextLarge":null}PFb(){Q.a.J(8958087,801,50,"ODP download dialog displayed")}thc(){Q.a.J(8958089,801,50,"ODP download dialog link clicked")}Lfb(){Q.a.J(19505496,801,50,"ODP download dialog button clicked")}n$c(){Ij.Redirect.showHelp("PPTODF");return!0}get ahc(){return w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanAppSetting("EnableReactDialogs")&&id.a("ReactDialogsODPDialogFix")?null:"#"}get zYa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get lhh(){return!w.AFrameworkApplication.tua}}
Object(k.a)(qa,"DownloadACopyAsOdpDialog",Xe,[]);class hb extends gl{constructor(v){super(v)}get spa(){return w.AFrameworkApplication.tua?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}PFb(){Q.a.J(21050910,801,50,"PDF download dialog displayed")}thc(){Q.a.J(21050912,801,50,"PDF download dialog link clicked")}Lfb(){Q.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(k.a)(hb,"DownloadACopyAsPdfDialog",gl,[]);var Gb=d(1215),pc=d(398);class vd extends pc.a{constructor(v,
S,ma){super();this.oZ=null;this.Rbd=0;this.fe=this.O0g=null;this.mQk=v;this.nIk=S;this.mFk=ma;this.i1a=Object(r.a)(this,this.r7,"onRequestComplete");this.onError=Object(r.a)(this,this.U8k,"onRequestError")}get Jrc(){return this.O0g}set Jrc(v){this.O0g=v}get nr(){return this.fe}set nr(v){this.fe=v}start(){this.iSb()}iSb(){1!==w.AFrameworkApplication.za.state&&(this.oZ=new Gb.a,this.oZ.Is=!1,this.oZ.Fd=5,this.oZ.message=this.mQk,this.oZ.fra(ResourceStrings.l_GenericDialogTitle,null,null),this.Rbd=0)}ZU(){this.oZ&&
(this.oZ.close(),this.oZ=null)}r7(v){this.ZU();v.dVa?this.Jrc(v):this.q_()}U8k(v){v.Gkj&&this.Rbd<vd.oJl?(this.Rbd+=1,v.start()):this.q_()}q_(){this.ZU();if(1!==w.AFrameworkApplication.za.state){const v=new Ya.StandardDialog;v.Fd=0;v.Kz(this.mFk,ResourceStrings.l_GenericDialogTitle,this.nIk,this.nr)}}}vd.oJl=3;Object(k.a)(vd,"UIBlockingTask",pc.a,[]);var zd=d(265);class xe extends vd{constructor(v){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,
ck.a.G1k);this.KC=v}start(){super.start();zd.a.C0i(this.KC,Object(r.a)(this,this.Afa,"handleWebserviceResponse"),Object(r.a)(this,this.zfa,"handleWebserviceError"))}}Object(k.a)(xe,"ConvertToOdpTask",vd,[]);class le extends vd{constructor(v){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.l_ConvertingToPdfErrorString,ck.a.pfl);this.KC=v}start(){super.start();zd.a.E0i(this.KC,Object(r.a)(this,this.Afa,"handleWebserviceResponse"),Object(r.a)(this,this.zfa,"handleWebserviceError"))}}Object(k.a)(le,
"ConvertToPdfTask",vd,[]);class Dg{constructor(v,S,ma){this.mcd=v;this.Ge=S;this.VEe=ma}get kzb(){return this.mcd.value}convert(v,S,ma){let Ja=null;0===S?this.VEe?new qa(ma):(Ja=new xe(v),Ja.Jrc=Object(r.a)(this,this.d4k,"onConvertOdpRequestSucceeded"),Ja.start()):1===S?this.Ge.td.sCg&&this.VEe?new hb(ma):uj.a.TJ(uj.a.Kb,()=>{Ja=new le(v);Ja.Jrc=Object(r.a)(this,this.e4k,"onConvertPdfRequestSucceeded");Ja.start()}):2===S?this.Ge.td.HEg&&this.VEe&&new lj(ma):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",
S))}d4k(v){v=v.result;1!==w.AFrameworkApplication.za.state&&(v=Hc.a.$ua(v.PrintUrl),new qa(v))}e4k(v){v=v.result;1!==w.AFrameworkApplication.za.state&&(v=Hc.a.$ua(v.PrintUrl),this.kzb.r_f=new Date,new hb(v),this.kzb.k5f=new Date,Q.a.J(21050908,801,50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.kzb.d7f.toString(),this.kzb.fJh.toString(),this.kzb.r_f.toString(),this.kzb.k5f.toString()))}}Object(k.a)(Dg,
"Converter",null,[1354]);class ch{constructor(){this.d7f=this.fJh=this.r_f=this.k5f=md.App.Xn}}Object(k.a)(ch,"DownloadACopyAsPdfContext",null,[]);class $h extends vd{constructor(v,S){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,ck.a.Xkl);this.KC=v;this.qUk=S}start(){super.start();zd.a.print(this.KC,this.qUk,Object(r.a)(this,this.Afa,"handleWebserviceResponse"),Object(r.a)(this,this.zfa,"handleWebserviceError"))}}Object(k.a)($h,"PrintTask",vd,[]);class wj{constructor(v,
S,ma){if(!v)throw Error.argumentNull("directPrintManager");this.kjc=v;this.Ge=S;this.DIk=ma}r8k(v){this.kjc.jll();v=v.result;1!==w.AFrameworkApplication.za.state&&(v=Hc.a.$ua(v.PrintUrl),this.kjc.cSh(v))}print(v,S,ma){this.Ge.td.sCg&&this.DIk?(v=new Pg.QueryStringBuilder(S),v.zg(Si.a.ldl,this.kjc.WQh().toString()),v.zg(Si.a.hdl,ma.toString()),this.kjc.cSh(v.toString())):(ma=new $h(v,this.kjc.WQh()),ma.Jrc=Object(r.a)(this,this.r8k,"onPrintRequestSucceeded"),ma.start())}}Object(k.a)(wj,"Printer",null,
[1275]);class kf{get name(){return"PowerPointWebEditor.PrintPackage"}fc(){C.a.instance.register(wj,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().na(()=>new wj(C.a.instance.ub("Common.App.DirectPrint.IDirectPrintManager"),C.a.instance.ub("PowerPointWebEditor.IApplicationContext"),C.a.instance.ub("PowerPointWebEditor.IApplicationSettings").Mg));C.a.instance.register(Dg,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().na(()=>new Dg(C.a.instance.ze("PowerPointWebEditor.DownloadACopyAsPdfContext"),
C.a.instance.ub("PowerPointWebEditor.IApplicationContext"),C.a.instance.ub("PowerPointWebEditor.IApplicationSettings").Mg));C.a.instance.register(ch,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().na(()=>new ch)}init(){}dispose(){}}Object(k.a)(kf,"PrintPackage",null,[2,3]);var Kf=d(1079);class lh extends vj{constructor(v,S,ma){super(v,S);this.ka=ma;this.xx=$a.a.pxb}Wva(v){if(v&&v.length){var S=$a.a.Fv(this.xx),ma=this.zfk(v[0]);try{Q.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",
S,ma?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(ma?this.zn.Ia($a.a.rRc,2,v):this.zn.Ia(this.xx,2,v[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",ma?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));Q.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",S,ma?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Ja){Q.a.J(512517843,
352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",S,Ja.toString())}}}zfk(v){(v=!!v&&!!v.OriginalUrl&&0<v.OriginalUrl.length&&this.ka.pptSmartArtSubNodeIconChangeEnabled&&!!this.ka.powerPointInsertContentSvgPath&&0<this.ka.powerPointInsertContentSvgPath.length&&0<=v.OriginalUrl.toLowerCase().indexOf(this.ka.powerPointInsertContentSvgPath.toLowerCase())&&v.OriginalUrl.toLowerCase().indexOf(".svg")===v.OriginalUrl.length-4)||Q.a.J(512517842,352,50,"isChangeSvg = false");
return v}}Object(k.a)(lh,"ChangeOnlineImageHelper",vj,[]);class sc extends vj{constructor(v,S,ma){super(v,S);this.ka=ma;this.xx=$a.a.deb}Wva(v){var S;if(v&&v.length){var ma=$a.a.Fv(this.xx),Ja=new Map;Ja.set("InsertMediaCommand",ma);Ig.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,Ja);try{const wb=[],Sb=[],vc=[];for(let od=0;od<v.length;od++){const Vd=v[od];this.OCg(Vd)?Array.add(wb,Vd):this.ka.geb&&this.Btk(Vd)?Array.add(vc,Vd):Array.add(Sb,Vd)}Q.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",
Sb.length,wb.length,ma);let gd=this.xx;gd===$a.a.h5c?gd=$a.a.Qdc:this.ka.geb&&gd===$a.a.feb&&(gd=$a.a.Qdc);for(v=0;v<Sb.length;v++){var Va=this.zn.Ia(gd,2,Sb[v]);if(32!==Va)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",Sb.toString(),ma));}if(this.ka.geb&&0<vc.length){this.ff||(this.fLh(uj.a.Zj("StockVideos::Insert")),null===(S=this.ff)||void 0===S?void 0:S.Wa("StockVideoInitiatedByRibbon","false"));this.ff&&this.ff.Wa("totalVideosSelected",vc.length.toString());
const od=performance.now();for(S=0;S<vc.length;S++)if(Va=this.zn.Ia($a.a.feb,2,vc[S]),32!==Va)throw this.L8f("videosInsertedBeforeFailure",S,od),Error.invalidOperation(String.format("Failed to upload video {0} with command {1}.",vc.toString(),ma));this.L8f("videosInsertedSuccess",vc.length,od)}if(this.OCg(wb[0])&&(Va=this.ka.b9c&&gd===$a.a.Zee?this.zn.Ia(gd,2,wb[0]):this.zn.Ia($a.a.h5c,2,wb),32!==Va))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",wb.toString()));
Q.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images {2} videos success, command: {3}.",Sb.length,wb.length,vc.length,ma)}catch(wb){Q.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.xx.toString(),wb.toString()),Ja.set("Exception",wb.toString()),Ig.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new cj.a,{extendedProperties:Ja}))}}}fLh(v){this.ff=v}L8f(v,S,ma){if(this.ff){const Ja=performance.now();this.ff.Wa("VideosInsertionTimeInMilliseconds",
(Ja-ma).toString());this.ff.Wa(v,S.toString());this.ff.finish();this.ff=null}}OCg(v){(v=!!v&&!!v.OriginalUrl&&0<v.OriginalUrl.length&&this.ka.ceb&&!!this.ka.powerPointInsertContentSvgPath&&0<this.ka.powerPointInsertContentSvgPath.length&&0<=v.OriginalUrl.toLowerCase().indexOf(this.ka.powerPointInsertContentSvgPath.toLowerCase())&&v.OriginalUrl.toLowerCase().indexOf(".svg")===v.OriginalUrl.length-4)||Q.a.J(512517838,352,50,"isInsertSvg = false");return v}Btk(v){return!!v&&!!v.OriginalUrl&&0<v.OriginalUrl.length&&
v.OriginalUrl.toLowerCase().indexOf(".mp4")===v.OriginalUrl.length-4}}Object(k.a)(sc,"InsertOnlineImageHelper",vj,[]);var uf=d(736);class Ak{constructor(v,S){this.rhb=!1;this.Khb=new Date(0);this.Jhb=new Date(0);this.SNe=v;this.zb=S}Prg(){this.rhb=!0}jNa(){this.rhb?Q.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.Khb>this.Jhb?Q.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+
this.Khb+". Last scan at "+this.Jhb+"."):(this.Khb=new Date,this.zb.Jb(new W.a(3,1,0,Object(r.a)(this,this.J5e,"runJob"),90,"112")))}J5e(){this.Jhb=new Date;this.rhb?Q.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.SNe()&&this.jNa()}}Object(k.a)(Ak,"PrefetchScheduler",null,[]);class oi{constructor(v,S,ma){this.ebd=null;this.KSg=S;this.TMg=ma;this.eGb=v}bOl(v){this.eGb!==v&&(this.eGb=v,this.ebd=null)}eNj(){this.ebd||(this.ebd=
this.VOi());return this.ebd}VOi(){const v=[];Array.add(v,this.eGb);for(let S=1;S<=this.KSg||S<=this.TMg;S++)S<=this.KSg&&Array.add(v,this.eGb+S),S<=this.TMg&&0<=this.eGb-S&&Array.add(v,this.eGb-S);return v}}Object(k.a)(oi,"SlideWindow",null,[]);class sg{constructor(v,S,ma,Ja,Va,wb,Sb,vc){this.ljb=!1;this.nc=Va;this.Uq=Ja;this.zya=vc;this.gGb=new uf.a;this.rB=new Ak(Object(r.a)(this,this.qgf,"tryScan"),wb);this.mpc=new oi(Ja&&Ja.Aa?Ja.Aa.slideIndex:0,Sb?Sb.r6l:10,Sb?Sb.q6l:5);this.i9e(v,S,ma)}start(){this.ljb?
Q.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(Q.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.ljb=!0,this.rB.jNa())}i9e(v,S,ma){v&&v.HJ(Object(r.a)(this,this.Cod,"onEditSlideChanged"));S&&S.Pka(Object(r.a)(this,this.Bpd,"onPageContentLoaded"));ma&&ma.ySa(Object(r.a)(this,this.m$k,"onSlideshowSlideChanged"))}Bpd(v,S){this.ljb&&(v=Object(N.a)(205,S.node))&&v.kF&&(this.gGb.remove(v.Fb),this.rB.jNa())}Cod(v,
S){S&&S.xpa&&this.XC(S.xpa.slideIndex)}m$k(v,S){S&&this.XC(S.slideIndex)}XC(v){this.mpc.bOl(v);this.ljb&&this.rB.jNa()}qgf(){const v=this.Qke();0<v.length&&this.k6e(v[0]);return 1<v.length}Qke(){const v=[];var S=this.Uq.presentation;if(!S)throw Error.argumentNull("Presentation is null");S=S.slides||[];for(const ma of this.mpc.eNj()){const Ja=S[ma];this.MYl(Ja)&&Array.add(v,Ja)}return v}MYl(v){return!!v&&v.kF&&!v.hP&&!this.gGb.contains(v.Fb)}k6e(v){this.gGb.add(v.Fb);v=this.ONj(v);0<v.length&&(Q.a.J(593773072,
813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",v.length),this.zya?this.zya.Bjl(v):Q.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}ONj(v){if(!this.nc)return Q.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.rB.Prg(),[];const S=[];if(!v)return S;v=Object(N.a)(205,v);if(!v)return S;for(const ma of v.yj())(v=
ma.Dra)&&this.zya&&this.zya.hfb(v)&&Array.add(S,v);return S}static jok(v){return!!v&&v.NFg&&!Ee.a.Aj&&!Ee.a.EHa&&!Ee.a.OD&&!Ee.a.Kye}}Object(k.a)(sg,"StreamVideoPrefetchOrchestrator",null,[]);class Ui{static addAppPLTEventToLog(v){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(v)}catch(S){}}static setIsPageLoadForFirstTime(v){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(v)}catch(S){}}}Object(k.a)(Ui,"VersionHistoryLogConnector",null,[]);
class Vh{constructor(v,S,ma,Ja){this.BZ=null;this.lGh=this.ResetAppVersionController;this.Nx=v;this.kj=S;this.Ba=ma;this.Wb=Ja;this.v0a={}}OnVersionHistorySelected(v,S){try{Q.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const ma=document.getElementById("VersionHistoryViewerSpinner");ma&&(ma.style.display="none");if(this.BZ)this.BZ.onVersionSelected(v,S,this.v0a)}catch(ma){Q.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
ma)}}ResetAppVersionController(v){try{if(this.BZ)Ui.setIsPageLoadForFirstTime(!1),this.BZ.switchParentViewContainer(v);else{Ui.setIsPageLoadForFirstTime(!0);const S=new PowerPointVersionHistory.AppBootSettings;S.RenderServiceBase="";S.IsRtl=!1;const ma=new PowerPointVersionHistory.AppCallbackBag;ma.animationDecoratorCallback=Object(r.a)(this.Nx,this.Nx.t7d,"createAnimationOrTransitionStar");ma.notesIconDecoratorCallback=Object(r.a)(this,this.CreateNotesIcon,"CreateNotesIcon");S.IsHighContrast=!1;
this.kj&&(S.IsHighContrast=this.kj.isInHighContrastMode);S.IsHighContrast&&(S.ClientColorSettings=this.kj.highContrastColors.foregroundTextColor+"_"+this.kj.highContrastColors.backgroundColor+"_"+this.kj.highContrastColors.linkColor);if(this.Wb){const Ja=this.Wb.Gcb();S.DefaultSlideWidth=Ja.width;S.DefaultSlideHeight=Ja.height}S.UserSessionId=w.AFrameworkApplication.userSessionId;S.VersionViewerCssUrl=this.Ba.versionHistoryViewerCssUrl;S.ProgressImageResourceUrl=Eb.a.GO(ah.a.iqa);this.BZ=new PowerPointVersionHistory.AppVersionController(S,
v,ma)}}catch(S){Q.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",S)}}CreateNotesIcon(){return Aa.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(k.a)(Vh,"PPTVersionHistorySelectionHandler",null,[1226]);class qh extends Xe{constructor(v){super(v,void 0,w.AFrameworkApplication.tua)}get spa(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get EFb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get dhc(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get g7b(){return w.AFrameworkApplication.tua?
"UIFontDialogTextLarge":null}PFb(){Q.a.J(19743688,801,50,"Download a copy dialog displayed")}thc(){Q.a.J(19743690,801,50,"Download a copy dialog clicked")}Lfb(){Q.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(k.a)(qh,"PowerPointDownloadACopyDialog",Xe,[]);class ab{j1l(v){new qh(v)}}Object(k.a)(ab,"PowerPointDownloadACopyDialogFactory",null,[1171]);var wl=d(92),Dn;(function(v){v[v.OK=0]="OK";v[v.cancel=1]="cancel";v[v.error=2]="error";v[v.open=3]="open"})(Dn||(Dn={}));Object(k.b)("HubbleAction",
Dn);var Zn=d(540);const Bk={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class Gg{constructor(v){this.fic=
v}static b7c(){return Date.now()>Gg.OIh}getToken(v){return Object(wl.b)(this,void 0,void 0,function*(){return Gg.b7c()?yield this.refreshToken(v):Gg.fQb})}refreshToken(v){return Object(wl.b)(this,void 0,void 0,function*(){Gg.fQb="";if(!this.fic)return n.ULS.sendTraceTag(508872861,352,50,"Refresh token requested without IOAuthManager."),Gg.fQb;try{const S=yield this.fic.vH("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");S.IsSuccess&&(Gg.OIh=S.Telemetry.expiresOn?1E3*(S.Telemetry.expiresOn-
10):0,Gg.fQb=S.Token);n.ULS.sendTraceTag(509096264,352,50,`Hubble token requested by: ${"PowerPointInsertMediaDialog"} successful: ${!!Gg.fQb} time: ${(new Date).getTime()-v}`)}catch(S){n.ULS.sendTraceTag(509096262,352,10,`Hubble token requested by: ${"showInsertMediaDialog"} successful: false time: ${(new Date).getTime()-v} error: ${S}`)}return Gg.fQb})}}Gg.OIh=0;Gg.fQb="";Object(k.a)(Gg,"TokenCache",null,[]);class Ik extends Kc.a{constructor(v,S,ma,Ja,Va){super();this.Jx=null;this.Vcd=!1;this.skc=
this.Boa=this.bZ=null;this.f3d="KeepFocusDiv";this.g3d="KeepFocusStartDiv";this.correlationId=null;this.Eba=0;this.insertPictureTelemetryEndpoint=null;this.mVc=0;if(!v)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.WUg=v;this.lS="";this.GK=ma;this.W5=Ja;this.Y_a=[];this.POk=S;this.Wg=Va||tl.Wg;this.Fg="InsertMediaDialog";this.rne=!1;this.Fd=5}zob(v,S,ma){Object(wl.b)(this,void 0,void 0,function*(){this.lS=v;this.ZKa=new Gg(ma);this.km=(new Date).getTime();
yield this.ZKa.getToken(this.km);this.Vcd=!1;this.showDialog(this.lS,null);this.bZ=this.B_c(this.ki("insertmediaframe"));if(!this.bZ)throw this.cbb(this.lQc),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Ja=document.getElementById(this.ki("WACDialogPanel"));Ja&&Ja.setAttribute(na.a.Ff,na.a.f1d);Ja=document.createElement("div");Ja.setAttribute("Id",this.g3d);Ja.setAttribute("tabindex","0");Ja.setAttribute("position","absolute");Ja.setAttribute("width","-1000px");Ja.setAttribute("top",
"-1000px");this.bZ.parentNode.insertBefore(Ja,this.bZ.parentNode.firstChild);Ja=document.createElement("div");Ja.setAttribute("Id",this.f3d);Ja.setAttribute("tabindex","0");this.bZ.parentNode.appendChild(Ja);Ja.setAttribute("position","absolute");Ja.setAttribute("width","-1000px");Ja.setAttribute("top","10000px");$addHandler(this.r$d,"keydown",Object(r.a)(this,this.XA,"keyDownHandler"));this.bZ.setAttribute("src",this.WUg);this.bZ.setAttribute("width","100%");this.bZ.setAttribute("height","100%");
this.bZ.setAttribute("frameborder","0");w.AFrameworkApplication.fa.getBooleanAppSetting("ShowInsertMediaIframeWhenIframeIsReady")&&(Ee.a.jg||Ee.a.JEb)?(this.bZ.style.visibility="hidden",this.skc=Object(r.a)(this,this.t6k,"onInsertMediaIframeLoaded"),Za.a.addHandler(this.bZ,"load",this.skc)):this.bZ.style.visibility="visible";this.B_c(this.ki("WACDialogTitleText")).style.display="none";if(2===this.Eba||5===this.Eba)this.B_c(this.ki("WACDialogTitlePanel")).style.display="none",this.B_c(this.ki("WACDialogBodyPanel")).style.padding=
"0";Jb.FocusManager.instance().gm().scope.uK=!0;Ja=this.WUg;if(w.AFrameworkApplication.fa.getBooleanAppSetting("GetCustomHeaderEnabled")){const Va=new URL(Ja),wb=Bk[Va.protocol+"//"+Va.host];wb?Ja=wb:n.ULS.sendTraceTag(508937633,352,10,`Target URL: ${Va.host} not found`)}this.Jx=this.POk.getInstance(this.bZ.contentWindow,Ja);this.Jx.ODa("https://osiziwuspersimmon002.blob.core.windows.net");this.Jx.ODa("https://osizewuspersimmon001.blob.core.windows.net");this.Jx.ODa("https://osizpscuspersimmon000.blob.core.windows.net");
this.Jx.ODa("https://cdn.hubblecontent.msit.osi.office.net");this.Jx.ODa("https://cdn.hubblecontent.osi.office.net");this.Jx.Qza(Qe.a.lKf,Va=>{this.e2k(Va,Object(r.a)(S,S.Wva,"insertMediaCallback"))});this.Jx.Qza(Qe.a.insert,Va=>{this.PUe(Va,Object(r.a)(S,S.Wva,"insertMediaCallback"))});this.Jx.Qza(Qe.a.nvi,Va=>{this.G7k(Va)});this.Jx.Qza(Qe.a.Jyj,Object(r.a)(this,this.C5k,"onGetCustomHeaders"));this.Jx.Qza(Qe.a.SLj,Object(r.a)(this,this.O5k,"onGetSessionId"));this.Jx.Qza(Qe.a.Cvj,Object(r.a)(this,
this.z5k,"onGetCID"));this.Jx.Qza(Qe.a.gQi,Object(r.a)(this,this.o3k,"onCancelDialog"));2===this.Eba&&0===this.mVc&&(this.Jx.Qza(Qe.a.Hvk,Object(r.a)(this,this.N6k,"onLaunchM365Upsell")),this.Boa=this.W5.OMa("MsoPremiumStockImages",Va=>{n.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.Jx.sendMessage(Qe.a.ulm,{["LicenseTier"]:Va.toString()})}));this.jxc(3)})}t6k(){this.bZ&&(this.bZ.style.visibility="visible",window.setTimeout(()=>{if(this.Mi){const v=this.Mi.getElementById("insertmediaframe");
v&&v.focus()}},0))}XA(v){v.keyCode===Sys.UI.Key.tab&&(v.target.id!==this.f3d||v.shiftKey?v.target.id===this.g3d&&v.shiftKey&&(v.preventDefault(),this.Mi.getElementById(this.f3d).focus()):(v.preventDefault(),this.Mi.getElementById(this.g3d).focus()))}dispose(){this.W5&&this.Boa&&this.W5.s2a("MsoPremiumStockImages",this.Boa);this.Jx&&(this.Jx.dispose(),this.Jx=null);this.skc&&(Za.a.removeHandler(this.bZ,"load",this.skc),this.skc=null);super.dispose()}e2k(v,S){n.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");
if(v=this.GK.hth(v))50<this.Y_a.length?n.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.Y_a,v),this.Vcd&&(S(this.Y_a),this.Vcd=!1))}o3k(){n.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.cbb(this.lQc);this.jxc(1)}jxc(v){if(2===this.Eba||5===this.Eba){const Ja=w.AFrameworkApplication.fa.Ea("InsertMediaDialogAriaTenantNameSpace");if(Ja&&""!==Ja){var S=[],ma="InsertUnknownContent";2===this.Eba?(Array.add(S,Object.assign(new B.a,
{name:"DialogMode",string:"M365Content"})),Array.add(S,Object.assign(new B.a,{name:"Provider",string:"M365Content"})),ma="InsertM365Content"):5===this.Eba&&(Array.add(S,Object.assign(new B.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(S,Object.assign(new B.a,{name:"Provider",string:"HubbleVideo"})),ma="InsertHubbleVideo");Array.add(S,Object.assign(new B.a,{name:"InsertedFiles",int64:this.Y_a.length}));Array.add(S,Object.assign(new B.a,{name:"DialogResult",string:Dn[v]}));Array.add(S,Object.assign(new B.a,
{name:"CorrelationId",string:this.correlationId.toString()}));y.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ja,ma),dataFields:S}))}}}B_c(v){const S=document.getElementById(v);if(!S)throw Error.invalidOperation(String.format("Couldn't get {0}.",v));return S}PUe(v,S){n.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.cbb(this.lQc);S?this.Y_a&&0<this.Y_a.length?(S(this.Y_a),this.jxc(0)):(n.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Vcd=
!0,S(this.Y_a),this.jxc(2)):this.jxc(2)}C5k(){return Object(wl.b)(this,void 0,void 0,function*(){if(this.Jx){var v=yield this.ZKa.getToken(this.km);n.ULS.sendTraceTag(509096025,352,50,`onGetCustomHeaders : Token available: ${!!v} time: ${(new Date).getTime()-this.km}`);this.Jx.sendMessage(Qe.a.wPl,{["CustomHeaders"]:v||""})}})}O5k(){this.Jx&&(n.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Jx.sendMessage(Qe.a.vTl,{["SessionId"]:w.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}z5k(){this.Jx&&
(n.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Jx.sendMessage(Qe.a.NOl,{["CID"]:""}))}G7k(v){v&&v.Values&&(v=v.Values,delete v.m_Origin,delete v.m_Source,delete v.m_ReceivedTime,n.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+v.eventName||!1),y.a.sendOtelEvent(Object.assign(new Zn.a,{otelEvent:v})))}N6k(){this.W5&&(n.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.W5.launchUpsellExperience("stockimages"))}}
Object(k.a)(Ik,"InsertMediaDialog",Kc.a,[1270,106]);class qn{getInstance(v,S,ma,Ja,Va){return new Ik(v,S,ma,Ja,Va)}}Object(k.a)(qn,"PptInsertMediaDialogFactory",null,[1224]);var rn=d(112);class gn{constructor(v){this.Ygb=v;this.i9e(this.Ygb.jh,this.Ygb.r1g)}i9e(v,S){v&&v.HJ(Object(r.a)(this,this.Cod,"onEditSlideChanged"));S&&S.Pka(Object(r.a)(this,this.Bpd,"onPageContentLoaded"))}Fzl(v,S){v&&v.E7(Object(r.a)(this,this.Cod,"onEditSlideChanged"));S&&S.x2a(Object(r.a)(this,this.Bpd,"onPageContentLoaded"))}Bpd(v,
S){(v=Object(N.a)(205,S.node))&&v.kF&&(this.Ygb.gGb.remove(v.Fb),this.Ygb.rB.jNa())}Cod(v,S){S&&S.xpa&&(this.Ygb.oZa=S.xpa,this.Ygb.rB.jNa(),this.Ygb.wBe=new Date)}}Object(k.a)(gn,"SlideEventListener",null,[]);class Wk{constructor(v,S,ma){this.udh="";this.rhb=!1;this.Khb=new Date(0);this.Jhb=new Date(0);this.SNe=v;this.zb=S;ma&&(this.udh=ma)}Prg(){this.rhb=!0}jNa(){this.rhb?Q.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):
this.Khb>this.Jhb?Q.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Khb+". Last scan at "+this.Jhb+"."):(this.Khb=new Date,this.zb.Jb(new W.a(3,1,0,Object(r.a)(this,this.J5e,"runJob"),90,this.udh)))}J5e(){this.Jhb=new Date;this.rhb?Q.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.SNe()&&this.jNa()}}
Object(k.a)(Wk,"BackgroundJobScheduler",null,[]);class hl{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd){this.akd=null;this.wBe=new Date;this.oZa=null;this.mSg={};this.beh={};this.Meh={};this.qRg={};if(!ma)throw Error.argumentNull("graphTopologyManager");if(!Ja)throw Error.argumentNull("fontUtilsManager");this.Uq=ma;this.kA=Ja;this.jh=v;this.r1g=S;this.jKb=vc;this.d0a=gd;this.kKb=od;this.Rjd=Vd;this.gGb=new uf.a;this.rB=new Wk(Object(r.a)(this,this.qgf,"tryScan"),Va,"");0<wb&&window.setInterval(Object(r.a)(this,
this.nKg,"logMissingFonts"),wb);this.QMk=Sb;v=ma.Aa?ma.Aa.slideIndex:0;if(S=this.Uq.presentation)S=S.slides||[],v<S.length&&(this.oZa=S[v],this.wBe=new Date)}dispose(){this.stop();this.nKg()}start(){this.stop();this.akd=new gn(this);this.rB.jNa()}stop(){this.akd&&this.akd.Fzl(this.jh,this.r1g);this.akd=null}Qke(){const v=[];this.oZa&&v.push(this.oZa);return v}qgf(){const v=this.Qke();0<v.length&&(this.k6e(v[0]),this.gGb.add(v[0].Fb));return 1<v.length}wAe(v,S,ma,Ja){const Va=[];for(const wb of Object.keys(v))v[wb]||
this.qRg[wb]||(Va.push(wb),this.qRg[wb]=!0);v=Va.length;0<v&&(Q.a.J(ma,820,15,"{0}",v),S&&Q.a.J(Ja,820,15,"{0}",Va.join(",")))}k6e(v){const S=v.lWa();if(S&&(this.jKb||this.kKb||this.d0a||id.a("ShouldLogMissingThirdPartyFontCount"))){var ma={},Ja={},Va={};v.Zcg.split(",").forEach(od=>{od&&(od=this.kA.gH(od),ma[od]=!1)});v.dYh.split(",").forEach(od=>{od&&(od=this.kA.gH(od),Ja[od]=!1)});v.Y0h.split(",").forEach(od=>{od&&(od=this.kA.gH(od),Va[od]=!1)});v=[];var wb=[],Sb=[];for(let od=0;od<S.length;od++){var vc=
S[od];vc=Array.isArray(vc.aA())?vc.aA():null;for(const Vd of vc)for(vc=0;Vd.Sa&&vc<Vd.Sa.length;){var gd=Vd.Sa.ga(vc);gd=gd.formatting?this.kA.gH(rn.Font.sGa(gd.formatting.cache.tM.trim().toLowerCase())):"";hc.a.Ta(gd)||(gd in ma&&!ma[gd]?(v.push(gd),ma[gd]=!0):gd in Ja&&!Ja[gd]?(wb.push(gd),Ja[gd]=!0):gd in ma||gd in Ja||Va[gd]||(Sb.push(gd),Va[gd]=!0));vc++}}this.jKb&&(hl.Vpe(this.mSg,v,this.kA),this.wAe(ma,!0,555886295,555886296));if(this.d0a||id.a("ShouldLogMissingThirdPartyFontCount"))hl.Vpe(this.beh,
wb,this.kA),this.wAe(Ja,this.d0a||this.Rjd,555886297,555886298);this.kKb&&(hl.Vpe(this.Meh,Sb,this.kA),this.wAe(Va,this.Rjd,555886299,555886300))}}nKg(){+new Date-+this.wBe<this.QMk||(this.jKb&&hl.HAe(this.mSg,this.kA,591003669,!0,"MissingFirstPartyFonts"),(this.d0a||id.a("ShouldLogMissingThirdPartyFontCount"))&&hl.HAe(this.beh,this.kA,591003667,this.d0a||this.Rjd,"MissingThirdPartyFonts"),this.kKb&&hl.HAe(this.Meh,this.kA,587337796,this.Rjd,"MissingNonLoggableFonts"))}static Vpe(v,S,ma){S.forEach(Ja=>
{id.a("ShouldNormalizeFontNamesBeforeLogging")&&(Ja=ma.gH(Ja));if(void 0===v[Ja]||null===v[Ja])v[Ja]=!1})}static FFj(v,S){if(!v)throw Error.argumentNull("fonts");const ma=[];for(const Ja of Object.keys(v))v[Ja]||(S.M$(Ja)||S.M$('"'+Ja+'"')||ma.push(Ja),v[Ja]=!0);return ma}static HAe(v,S,ma,Ja,Va){S=hl.FFj(v,S);v=S.length;0<v&&(S=S.join(","),Ja&&587337796===ma?Q.a.J(ma,820,15,"{0}",S):Q.a.J(ma,820,15,"{0}",Ja?S:v.toString()),ma=new Map,Ja&&ma.set("Fonts",S),ma.set("FontsCount",v.toString()),Ig.Health.instance.recordQosError(Va,
["MissingFont"],!1,!1,!0,!1,Object.assign(new cj.a,{extendedProperties:ma})))}}Object(k.a)(hl,"FontLogger",null,[106]);var Cm=d(1002),Ao=d(1008),Sf=d(212);class En{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He,$m){this.HJa=!1;this.Boa=null;this.K1l=(Ck,cl,Nk)=>{var xn;cl=this.sa.Aa;if(!cl||this.ic.Xc(cl))return 16;if(1===Nk)return 32;Q.a.J(508941190,846,50,"InsertVideoActor::InsertStockVideos Initiated");this.ff=uj.a.Zj("StockVideos::Insert");Nk=new Pg.QueryStringBuilder(this.Ba.qqe);
Nk.lw("initpivot","stockvideos");Nk.zg("entryPoint",$a.a.Fv(Ck));Nk.zg("sv","1");id.a("AddDalleTabToStockVideoDialog")&&this.GK.Fti(this.Ba,Nk);const um=new sc(this.ia,this.GK,this.Ba);um.xx=$a.a.feb;null===(xn=this.ff)||void 0===xn?void 0:xn.Wa("StockVideoInitiatedByRibbon","true");um.fLh(this.ff);const km=Nk.toString();if(!km||!km.length)return 16;try{const Fj=yb.a.create(),uk=hc.a.gM(this.Ba.pptEditingUserId).toString();this.X5.execute(Nn=>{var Hh=this.Ba.qyg&&Nn.isFreemiumUpsellEnabled();Hh=this.HJa?
1:Hh?0:-1;var vk=this.Ba.getBooleanAppSetting("InsertOnlineM365ExperimentEnabled")?1:0;vk=this.GK.$Rf(Sf.App.mode,km,Hh,1,Fj.toString(),uk,vk);Nn=this.MHb.getInstance(vk,this.LHb,this.GK,Nn,Jh.Wg);Nn.correlationId=Fj;Nn.Eba=2;Nn.mVc=Hh;Nn.zob(CommonUIStrings.L_VideoInsertTitle,um,void 0);this.ff&&this.ff.Wa("StockVideoDialogInitialized","true");Q.a.J(509100040,846,50,"InsertVideoActor::showStockVideosDialog : Show dialog success.")});return 32}catch(Fj){Q.a.J(509100039,846,10,"InsertVideoActor::showStockVideosDialog : Exception = [{0}]",
Fj.toString())}return 8};this.Kbk=(Ck,cl,Nk,xn,um)=>{Ck=this.sa.Aa;if(!Ck||this.ic.Xc(Ck))return 16;if(1===Nk)return 32;if(!this.Lj.UD(Ck,1))return this.Lj.yE(Ck),16;if(!um||!um.OriginalUrl)return 16;try{const km=Ck.U0(this.gb.Hd());if(km&&this.ic.Xc(km))return 16;const Fj=this.W1c(Ck,km),uk=this.Eb.ud(15,void 0,()=>{this.gb.Pu();this.gb.Bh();this.Fa.Gd()},()=>{this.gb.selectShape(Fj,!0)});try{uk.mc(Ck);uk.Wc=$a.a.feb;uk.ny[wf.a.Rea]=wf.a.Xkb;Q.a.J(509100038,846,50,"InsertVideoActor::UploadStockVideo");
Fj.setValue(Pc.a.jEa,um.LicenseUrl?null:um.Caption);Fj.RUb=um.Caption;Fj.setValue(Pc.a.mediaType,2);Fj.setValue(Pc.a.Vp,!0);Fj.setValue(Pc.a.QNa,!0);Fj.setValue(Pc.a.Dra,um.OriginalUrl);Fj.setValue(Pc.a.sK,!0);const Nn=String.format("{0}{1}","video",yb.a.create().toString());Fj.SUb=Nn;km&&Ck.XS([km]);Ck.ZB(Fj)}finally{uk&&uk.dispose()}this.Dr.YA=Fj;return 32}catch(km){return Q.a.J(509100037,846,10,"InsertVideoActor:: Error while creating video shape node : Exception = [{0}].",km.toString()),8}};this.rca=
(Ck,cl)=>{var Nk;this.ff&&(this.ff.Wa("MediaFileValidationPassedOnUI","false"),this.ff.Wa("ErrorMessage",null===(Nk=cl.Message)||void 0===Nk?void 0:Nk.toString()),this.ff.finish(),this.ff=null);Ck=cl.ExtraErrorParam?String.format(cl.Message,cl.ExtraErrorParam):cl.Message;cl=Object.assign(new Ao.a,{title:cl.Title,message:Ck,timeoutInSeconds:120});this.uI.fRh(cl)};if(!v)throw Error.argumentNull("applicationSettings");if(!S)throw Error.argumentNull("actionManager");if(!ma)throw Error.argumentNull("graphTopologyManager");
if(!Ja)throw Error.argumentNull("graphActionBlockingManager");if(!Va)throw Error.argumentNull("pptSelectionManager");if(!wb)throw Error.argumentNull("ribbonChangeManager");if(!Sb)throw Error.argumentNull("transactionFactory");if(!vc)throw Error.argumentNull("shapeEditor");if(!gd)throw Error.argumentNull("errorHandler");if(!od)throw Error.argumentNull("focusManager");if(!Vd)throw Error.argumentNull("sessionInfo");if(!Ke)throw Error.argumentNull("mediaUploaderFactory");if(!kg)throw Error.argumentNull("calloutNotificationAdapter");
if(null===v||void 0===v?0:v.geb){if(!If)throw Error.argumentNull("appFeatureHelper");if(!yh)throw Error.argumentNull("insertMediaHelper");if(!bg)throw Error.argumentNull("insertMediaCrossDocumentMessengerFactory");if(!df)throw Error.argumentNull("insertMediaDialogFactory");if(!ih)throw Error.argumentNull("shapeCountValidator");if(!He)throw Error.argumentNull("pageView");if(!$m)throw Error.argumentNull("presReader");}this.Ba=v;this.ia=S;this.sa=ma;this.ic=Ja;this.gb=Va;this.Dr=wb;this.Eb=Sb;this.Vk=
vc;this.fe=gd;this.Fa=od;this.Rq=ma.presentation;this.Pe=Vd;this.Thb=Ke;this.uI=kg;this.X5=If;this.GK=yh;this.LHb=bg;this.MHb=df;this.Lj=ih;this.yb=He;this.Tb=$m;Cm.a.Gmm=this.Ba.h5h;Cm.a.Bnm=this.Ba.Dnm;(null===v||void 0===v?0:v.geb)&&this.sSi()}qb(){this.ia.pa($a.a.gSb,Jg.a.application,this.p0j.bind(this),4);this.ia.pa($a.a.xyg,Jg.a.application,this.K1l,4);this.ia.pa($a.a.feb,Jg.a.application,this.Kbk,4);id.a("EnableCalloutNotificationsForVideos")&&Uj.b(this.rca)}Sd(){}p0j(v,S,ma){const Ja=this.sa.Aa;
if(!Ja||this.ic.Xc(Ja))return 16;if(1===ma)return 32;this.ff=uj.a.Zj("Video::Insert");try{return Q.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),sl.a.Baf(this.Ba.h5h.toString(),Uj.e,()=>Uj.d(v,this.Ubk.bind(this),"video",this.Pe,Ja),"video",Ja,this.sa.presentation,this.ic,this.fe,this.ff,!0,this.Thb,this.Ba.wCc,this.Ba.vCc,this.Ba.uCc),this.ff&&this.ff.Wa("VideoDialogInitialized","true"),32}catch(Va){Q.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Va)}Uj.a("video")?
Uj.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}dispose(){this.X5.instance&&this.Boa&&this.X5.instance.s2a("MsoPremiumStockImages",this.Boa)}showErrorMessage(v,S){this.ff&&(this.ff.finish(),this.ff=null);this.fe.iI(v,ma=>{ma.yD=1;ma.YUa=S;return!1})}Ubk(v,S,ma,Ja,Va,wb,Sb){Ja.iP(ma)&&Q.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-
+ma.ula);Ja.vL(Sb);ma=Sb.wt();var vc=this.Rq.slideHeight;Ja=this.Rq.slideWidth/2-Ti.a.Cf(ah.a.KS/2,0);vc=vc/2-Ti.a.Cf(ah.a.KS/2,1);if(Sb&&Sb.isConnected){var gd=this.Eb.ud(15,void 0,void 0,()=>{this.Dr.YA=this.WKb;this.gb.selectShape(this.WKb,!0);this.Fa.Gd()});try{gd.mc(Sb);gd.Wc=v;Va&&Va.Wa("CreatingVideoShape","true");this.WKb=this.Vk.cFa(!1,Sb.Fb.cid,Sb.Fb.sid,0,10,Ja,vc,ah.a.KS,ah.a.EZ,ma+1);const od=wb.files[0].name;this.WKb.SUb=S;this.WKb.RUb=od;id.a("SetMediaTypeAsVideoForEmbeddedVideo")&&
this.WKb.setValue(Pc.a.mediaType,2);Sb.ZB(this.WKb)}finally{gd&&gd.dispose()}Va&&(Va.Wa("VideoShapeSuccessfullyCreated","true"),Va.finish(),Va=null)}}sSi(){this.X5.execute(v=>{v.isFeatureEnabled("MsoPremiumStockImages",!1).catch(S=>Q.a.J(509100036,846,10,"InsertVideoActor::Constructor - Failed to load the premium state from application feature helper: {0}",S)).then(S=>{this.HJa=S;this.HJa||(this.Boa=v.OMa("MsoPremiumStockImages",()=>{this.HJa=!0;Q.a.J(509100035,846,50,"InsertVideoActor:: setting isUserLicensed=1")}));
return null})})}W1c(v,S){if(!v)return null;var ma=v.Fb;v=v.wt();const Ja=this.Tb.Ama(ah.a.KS,ah.a.EZ);ma=this.Vk.Cla(!0,ma.cid,ma.sid,0,Ja.x,Ja.y,ah.a.KS,ah.a.EZ,v+1,!0);S&&(ma.J4=S.id);return ma}}Object(k.a)(En,"InsertVideoActor",null,[948]);class J{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd){if(!v)throw Error.argumentNull("transactionHelper");if(!S)throw Error.argumentNull("actionManager");if(!Ja)throw Error.argumentNull("graphTopologyManager");if(!Ja.presentation)throw Error.argumentNull("graphTopologyManager.presentation");
if(!ma)throw Error.argumentNull("graphActionBlockingManager");if(!Va)throw Error.argumentNull("ribbonChangeManager");if(!wb)throw Error.argumentNull("shapeEditor");if(!Sb)throw Error.argumentNull("shapeCountValidator");if(!vc)throw Error.argumentNull("appSettings");if(!gd)throw Error.argumentNull("selectionManager");this.ms=v;this.ia=S;this.sa=Ja;this.ic=ma;this.Dr=Va;this.Rq=Ja.presentation;this.Vk=wb;this.Lj=Sb;this.ka=vc;this.oa=gd}qb(){this.ka.enableCameoInEditor&&this.ia.pa($a.a.e5c,Jg.a.application,
this.JWj.bind(this),4)}Sd(){}JWj(v,S,ma){S=this.sa.Aa;if(!S)return 16;if(P.a.Cx(S.Fb))return 8;if(this.ic.Xc(S))return 16;if(1===ma)return 32;if(!this.Lj.UD(S,1))return this.Lj.yE(S),16;var Ja=Math.min(Math.min(this.Rq.eTh,this.Rq.RSh),100);ma=S.wt();var Va=this.Rq.slideWidth,wb=this.Rq.slideHeight,Sb=Ti.a.Cf(Ja,0);Ja=Ti.a.Cf(Ja,1);Va=Va/2-Ti.a.Cf(50,0);wb=wb/2-Ti.a.Cf(50,1);ma=this.Vk.cFa(!1,S.Fb.cid,S.Fb.sid,0,10,Va,wb,Sb,Ja,ma+1);this.ka.BXa&&(Sb=S.LZc(this.oa.Hd()).filter(vc=>!!vc&&!this.ic.Xc(vc)).find(vc=>
16===vc.mj))&&(ma.J4=Sb.id);ma.lF=!0;this.ms.NU([ma],S,v);this.Dr.YA=ma;return 32}}Object(k.a)(J,"InsertCameoActor",null,[948]);class X{constructor(){this.eba=this.yh=this.M6=this.K=null;this.B0g=[];this.djc=[new kf];this.lZ=[]}get name(){return"PowerPointWebEditor.Chronos2"}fc(v){this.K=v;this.M6=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.yh=this.M6.AGa(5,this.name);this.eba=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Va=0;Va<this.djc.length;++Va)Array.add(this.lZ,
Db.a(this.djc[Va],5));for(const Va of this.lZ)Va.fc(v);const S=this.K.resolve("PowerPointWebEditor.IApplicationContext"),ma=w.AFrameworkApplication.fa.getBooleanAppSetting("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),Ja=Ye.a.Au(this.K.Ha("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Object(id.a)("EnhancementOfSDXPaneBootTime")||this.K.register(Kf.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").na(()=>new Kf.a(this.K.resolve("Common.IActionManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();this.K.register(Vh,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().na(()=>new Vh(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Ej,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().na(()=>new Ej(v.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new Ie.a(()=>Ja.result),v.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(Li,"Box4.Media.InsertOneDriveFileHelper").ma().na(()=>new Li(w.AFrameworkApplication.Pa));this.K.register(Hk,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().na(()=>
new Hk);this.K.register(sc,"PowerPointWebEditor.InsertOnlineImageHelper").ma().na(()=>new sc(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(lh,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().na(()=>new lh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(pm,
"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().na(()=>new pm(new Ol(new Ie.a(()=>{if(w.AFrameworkApplication.VQh()){var Va=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ubb;Va=new Oj(Va.contentWindow,"*")}else Va=S.BCj();return Va}),ma?Hc.a.CR(window.document.URL):Hc.a.CR(w.AFrameworkApplication.dqa),w.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(Oe,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();
this.K.register(tk,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().na(()=>new tk);this.K.register(qn,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(1171,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().na(()=>new ab);this.K.register(sg,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().na(()=>new sg(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let v=this.yh.Mu("resolvechronos2");const S=this.K.resolve("Common.AFrameworkApplication"),ma=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
Ja=ma.td,Va=S.Qp,wb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Sb=this.K.resolve("Common.IActionManagerExtended"),vc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var gd=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const od=this.K.resolve("PowerPointWebEditor.IFocusManager"),Vd=Va.ie,Ke=this.K.resolve("Common.Transaction.ITransactionFactory"),kg=this.K.resolve("PowerPointWebEditor.IShapeEditor"),If=this.K.ze("PowerPointWebEditor.IClassFactory"),
yh=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),df=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),bg=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),ih=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),He=this.K.resolve("PowerPointWebEditor.IPresentationReader"),$m=Va.llb,Ck=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),cl=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),Nk=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
xn=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),um=this.K.resolve("PowerPointWebEditor.IShapeReader"),km=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.yh.Su(v);v=this.yh.Mu("regactorschronos2");gd=[...(Object(id.a)("EnhancementOfSDXPaneBootTime")?[]:[new dj.a(Ja,this.K.resolve("Common.IAppSettingsManager"),gd,Sb,Vd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ke,If,vc,this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),df,bg,ih)]),new Tj(Ja,Sb,vc,
this.K.Ha("PowerPointWebEditor.IAddinCommandsManager")),new pj(Ja,Sb,bg,yh,od,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ke,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),
this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),He,kg,um,km,xn,ih,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),
this.K.resolve("Common.IAppSettingsManager")),new Bm(Sb,this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bg,yh,xn,this.K.resolve("Common.Transaction.ITransactionFactory"),kg,this.K.resolve("PowerPointWebEditor.IErrorHandler"),od,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new J(gd,Sb,bg,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),xn,kg,ih,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
yh),new En(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Sb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),bg,yh,xn,this.K.resolve("Common.Transaction.ITransactionFactory"),kg,this.K.resolve("PowerPointWebEditor.IErrorHandler"),od,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.K.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))];for(const Fj of gd)Fj.qb(),Fj.Sd();vc.mJf=!0;this.yh.Su(v);w.AFrameworkApplication.fa.Ue(()=>{v=this.yh.Mu("regfullactorschronos2");
const Fj=[new Ql(Sb,bg,od,yh,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").Of,Ck,ma.gWa().Fpk,cl,this.K.resolve("PowerPointWeb.IPrinter"),this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),Nk,wb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),S.uzg,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>w.AFrameworkApplication.cD,ma.aie(),uk=>w.AFrameworkApplication.za.mb.N9e(uk),()=>w.AFrameworkApplication.sgc,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new Sl(Va,Ja.Iqj,$m.embedPreviewUrl,Sb,He,ma.aie(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const uk of Fj)uk.qb(),uk.Sd();
this.yh.Su(v)});Q.a.J(512360593,809,50,"Chronos2Package::Init");for(const Fj of this.lZ)this.yh.Mu(Fj.name),Fj.init(),this.yh.Su(Fj.name);v=this.yh.Mu("al");this.R9j();this.yh.Su(v);w.AFrameworkApplication.fa.Ue(()=>{if(Ja.powerPointIdeasIsEnabled){v=this.yh.Mu("idea");var Fj=this.A$j();this.z$j(Fj);this.yh.Su(v)}Ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1)&&(v=this.yh.Mu("fastcards"),this.f$j(),this.yh.Su(v));Ja.powerPointSmartLookupIsEnabled&&(v=this.yh.Mu("smartLookup"),
this.qak(),this.yh.Su(v));w.AFrameworkApplication.C9c()&&(v=this.yh.Mu("versionhistory"),this.Hak(),this.yh.Su(v));sg.jok(Ja)&&ib.a.get_instance().Ij(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const uk=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(uk&&(uk.ZPh||uk.YPh||uk.$Ph)){const Nn=!hc.a.Ta(w.AFrameworkApplication.fa.Ea("TenantId"))&&Array.contains(uk.C9l,w.AFrameworkApplication.fa.Ea("TenantId"));this.K.register(hl,"PowerPointWebEditor.Text.FontLogger").ma().na(()=>
new hl(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),uk.mYk,uk.lYk,uk.ZPh,uk.YPh&&w.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost"),uk.$Ph,uk.dgj&&Nn));Fj=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.B0g.push(Fj);Fj.start()}});w.AFrameworkApplication.vua||
(v=this.yh.Mu("appforoffice"),this.O9j(),this.yh.Su(v));Ja.aTh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").fAe()}dispose(){for(const v of this.lZ)v.dispose();for(const v of this.B0g)try{v&&v.dispose()}catch(S){Q.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",S.message,S.stack)}}R9j(){Q.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const v=Vb.a.create("pptedit.augloop",null,()=>d.e(8).then(d.bind(null,1310)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const S=
this.K.resolve("Common.ISharedDependencyLoader"),ma=w.AFrameworkApplication.Ui("augloop-runtime-shim-ie",2);S.LFb(ma).continueWith(()=>{Od.a.bF(v)})}else Od.a.bF(v)}catch(v){Q.a.J(512360590,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",v.message,v.stack)}}A$j(){Q.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var v=[this.eba.qyb(w.AFrameworkApplication.Ui("ir-plugin-ski.min.js",5))];v=Vb.a.create("pptedit.infrared",v,()=>d.e(14).then(d.bind(null,
1316)));Od.a.bF(v);return v}z$j(v){Q.a.J(512360587,809,50,"Start to download ideas.hermes.js file");v=this.eba.m8d(w.AFrameworkApplication.Ui("microsoft.ideas.runtime.js",5),[v],!1);v=Vb.a.create("pptedit.ideas",[v],()=>d.e(15).then(d.bind(null,1318)));Od.a.bF(v)}f$j(){Q.a.J(508958302,809,50,"Start to download fastcards.hermes.js file");const v=Vb.a.create("pptedit.fastcards",null,()=>d.e(11).then(d.bind(null,1320)));Od.a.bF(v)}qak(){Q.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");
const v=Vb.a.create("pptedit.smartlookup",null,()=>d.e(13).then(d.bind(null,1313)));Od.a.bF(v)}Hak(){var v=w.AFrameworkApplication.Ui("pptVersionHistory.js",5);v=this.eba.qyb(v);try{Od.a.bF(v)}catch(S){Q.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",S.toString())}}O9j(){const v=this.K.resolve("PowerPointWebEditor.IApplicationSettings");C.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").one()?X.Cpe():
v.Mg?w.AFrameworkApplication.fa.Ue(X.kxg):ib.a.get_instance().Ij(8,()=>{X.kxg()})}static main(){w.AFrameworkApplication.Dh&&Ee.a.jg?Q.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Ac(Db.a(new X,5))}static Cpe(){C.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").mla();e.a.instance.Ac(new vl)}static kxg(){let v=!1;try{window.self.requestIdleCallback(X.Cpe)}catch(S){v=!0}v&&window.setTimeout(X.Cpe,0)}}Object(k.a)(X,"Chronos2Package",
null,[2,3]);var Ia=d(180),fb;(function(v){v[v.unsupported=0]="unsupported";v[v.designer=1]="designer";v[v.blank=2]="blank"})(fb||(fb={}));Object(k.b)("AgendaSlideThemeType",fb);var Ab=d(113);class ec{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(k.a)(ec,"AgendaApplyInfo",null,[]);class Uc{constructor(){this.DeckSuggestionId=this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(k.a)(Uc,"AgendaThemeApplyInfo",null,[]);class Ad{constructor(v,
S){this.Nce=!1;this.jZe=[];this.t3f=v;this.Skj=S}}Object(k.a)(Ad,"DeckOptionInformation",null,[]);class Ce{constructor(){this.Deh=this.Eeh=0;this.MOg=[]}get PDd(){return this.Eeh}set PDd(v){this.Eeh=v}get ODd(){return this.Deh}set ODd(v){this.Deh=v}get yab(){return this.MOg}set yab(v){this.MOg=v}Uuh(v,S,ma){const Ja=new ca.a;if(v)for(let Va=0;Va<ma-1&&Va<v.length;Va++)Ja.add(new Ad(v[Va],!1));hc.a.Ta(S)||Ja.add(new Ad(S,!0));this.yab=Ja.toArray()}}Object(k.a)(Ce,"AgendaDeckSessionInformation",null,
[]);class ye{constructor(){this.Ohc=this.Phc=this.cMg=0;this.VNe=this.Ead=this.QLe=this.nhd=null}kOl(v){v&&(this.cMg=v.body.slideIndex)}$Rl(v){v.body&&v.body.outlineRequestContent&&(this.nhd=JSON.stringify(v.body.outlineRequestContent))}gOl(v){v.body&&(this.Ohc=v.body.slideCId)}jOl(v){v.body&&(this.Phc=v.body.slideSId)}hOl(v){this.Ead=v.id}Kdk(v){return v===this.Ead?(this.Ead=this.nhd=null,!0):!1}Wsk(){return!hc.a.Ta(this.nhd)&&!hc.a.Ta(this.Ead)}PRl(v){v.body&&v.body.outlineRequestContent&&v.body.outlineRequestContent.Slides&&
(this.QLe=v.body.outlineRequestContent.Slides.length)}iOl(v){this.VNe=v.body.score}}Object(k.a)(ye,"AgendaDetection",null,[]);var hf=d(1087);class Gf{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke){this.Kwa=this.BC=null;this.Kad=0;this.G1=null;this.dKb="";this.Tcd=!1;this.Ina=0;this.faa=new ca.a;this.nVg=!1;this.Qi=v;this.Tb=S;this.sa=ma;this.ic=Ja;this.Ba=Va;this.Ar=wb;this.De=vc;this.gb=gd;this.Ex=od;this.Gib=Vd;this.Lb=Ke;this.Ex.N4k(this.Ba)}pZh(){this.TNh();this.G1i();this.Tzb()?(this.G1=new Ce,
this.G1.PDd=this.yM(),this.Ybm()):1!==this.Ina||this.Ba.zWc?2===this.Ina&&this.Ba.yWc&&(this.G1=new Ce,this.G1.PDd=this.yM(),this.Gcm()):this.Fcm()}G1i(){this.Kwa=yb.a.create().toString();this.Ex.tEl(this.Kwa);this.Ex.f2k()}vff(v,S){if(this.BC){if(!this.BC.Phc||!this.BC.Ohc){var ma=this.Tb.oy(this.BC.cMg);this.BC.Phc=ma.Fb.sid;this.BC.Ohc=ma.Fb.cid}ma=this.Tb.oy(0);this.Qi.generateAgendaSuggestion(ma.Fb.cid,ma.Fb.sid,this.Kwa,this.BC.nhd,this.zsj(),v,S)}else S(null)}Fcm(){this.vff(Object(r.a)(this,
this.I7k,"onPODSTriggerAgendaConversionSuccessV1"),Object(r.a)(this,this.noh,"onPODSTriggerAgendaConversionFailureV1"));this.ic.blockContent(this.sa.presentation,"ApplyAgenda",!0)}Gcm(){for(const v of this.faa)v&&v.ccm();this.vff(Object(r.a)(this,this.J7k,"onPODSTriggerAgendaConversionSuccessV2"),Object(r.a)(this,this.H7k,"onPODSTriggerAgendaConversionFailureV2"))}Ybm(){this.vff(Object(r.a)(this,this.K7k,"onPODSTriggerAgendaConversionSuccessV3"),Object(r.a)(this,this.ooh,"onPODSTriggerAgendaConversionFailureV3"));
this.ic.blockContent(this.sa.presentation,"ApplyAgenda",!0)}Mkb(v,S){if(S.property===Pc.a.F1a&&this.Kad){v=Object(N.a)(688,S.node);if(v.F1a===Gf.H6h)for(const ma of this.faa)ma&&ma.C2k();else if(v.F1a===Gf.I6h){for(const ma of this.faa)ma&&ma.$kh();this.Tcd=!0}this.Gib.tn(Object(r.a)(this,this.Mkb,"onPresentationPropertyChange"));this.Kad=0}}zsj(){const v={};this.Ba.yWc&&2===this.Ina&&(v.shouldGenerateThemes="true",v.themeCount="3");this.Tzb()&&(v.shouldNotConvertToGVMLBytes="true",v.shouldInsertBlankSlides=
"true");return Ab.c(v)}osj(v){const S={};S.SlideCount=this.Hi().toString();S.isBlankThemeRequest=(this.G1.yab[v].Skj&&!this.Tzb()).toString();S.isRequestForDeckDesignerForNonBlankSlides=this.Tzb();return Ab.c(S)}Tzb(){return this.Ba.zWc&&(1===this.Ina||0===this.Ina)}Xbm(){this.gb.Bh();const v=this.sa.presentation;if(v){const S=this.Ar.xe(15);try{S.mc(v),S.Wc=$a.a.C3b,v.Jvb=Object.assign(new ec,{CorrelationId:this.Kwa,AgendaSlideSid:this.BC.Phc,AgendaSlideCid:this.BC.Ohc})}finally{S&&S.dispose()}this.ic.mx(v,
$a.a.C3b);this.ic.vL(v)}else this.Ynd()}qZh(v){this.gb.Bh();this.Ex.cFi(this.Xge(v));const S=this.sa.presentation;if(S){const ma=this.Ar.xe(15);try{ma.mc(S),ma.Wc=$a.a.C3b,S.F1a=Gf.G6h,this.Kad=this.yM(),this.Gib.Ak(Object(r.a)(this,this.Mkb,"onPresentationPropertyChange")),S.Kvb=Object.assign(new Uc,{DeckSuggestionId:this.Xge(v),AgendaSessionId:this.Kwa,CorrelationId:yb.a.create().toString()})}finally{ma&&ma.dispose()}this.ic.mx(S,$a.a.C3b);this.ic.vL(S)}else this.Ynd()}Ynd(){for(const v of this.faa)v&&
v.B2k();this.ic.vL(this.sa.presentation)}I7k(){this.Xbm();this.Tcd=!0;for(const v of this.faa)v&&v.$kh()}J7k(v){this.G1.ODd=this.yM();const S=this.ljg(),ma=new ca.a;if(v.Images)for(const Ja of v.Images)ma.add("data:image/jpg;base64, "+Ja);ma.add(S);hc.a.Ta(v.BlankSuggestionId)&&(v.BlankSuggestionId=yb.a.create().toString());this.G1.Uuh(v.DeckSuggestionId,v.BlankSuggestionId,Gf.Zjf);for(const Ja of this.faa)Ja&&Ja.E2k(ma.toArray());this.yff(0)}K7k(){this.G1.ODd=this.yM();this.G1.Uuh(null,yb.a.create().toString(),
Gf.Zjf);this.yff(0)}yff(v){this.Tzb()?this.vZh(v,Object(r.a)(this,this.M7k,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(r.a)(this,this.ooh,"onPODSTriggerAgendaConversionFailureV3")):this.vZh(v,Object(r.a)(this,this.L7k,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(r.a)(this,this.poh,"onPODSTriggerAgendaDeckSuggestionFailure"))}vZh(v,S,ma){if(this.G1.ODd<this.G1.PDd)this.pZh();else if(this.Ex.U$k(v),this.dKb=this.Xge(v),this.slj(this.G1.yab[v])){var Ja=yb.a.create().toString();
this.Qi.generateAgendaDeckSuggestion(this.BC.Ohc,this.BC.Phc,Ja,this.Kwa,this.dKb,this.osj(v),S,ma);Q.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",Ja,this.dKb)}else this.Gjh(this.G1.yab[v].jZe,this.dKb),this.Ex.Wkh(v,!0)}L7k(v){if(v.Images&&v.Images.length){var S=new ca.a;for(var ma of v.Images)S.add("data:image/jpg;base64, "+ma);this.Gjh(S.toArray(),v.DeckSuggestionId);if(ma=({themeIndex:v}=this.gig(v.DeckSuggestionId)).returnValue)ma.jZe=
S.toArray(),ma.Nce=!0;this.Ex.Wkh(v,!1)}else this.poh(v)}M7k(v){v.Images&&v.Images.length?this.qZh(0):this.Ynd()}Gjh(v,S){for(const ma of this.faa)ma&&S===this.dKb&&ma.x2k(v)}poh(v){try{let S;const ma=({themeIndex:S}=this.gig(v.DeckSuggestionId)).returnValue;ma&&(ma.Nce=!1,ma.jZe=[]);this.Ex.w2k(S);if(this.dKb!==v.DeckSuggestionId)return!0}catch(S){Q.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+S.message)}for(const S of this.faa)S&&S.Zkh();return!0}noh(){this.Ynd();
return!0}ooh(v){return this.noh(v)}H7k(){const v=this.ljg(),S=new ca.a;S.add(v);for(const ma of this.faa)ma&&(ma.D2k(S.toArray()),ma.Zkh());return!0}ljg(){const v=this.Tb.oy(0);return this.De.MG(v.Fb).image.src}FM(v,S){try{this.BC||(this.BC=new ye);let ma=!1;S?this.BC.Kdk(v.id)&&(this.nMh(!1,this.Ina),ma=!0):(this.BC.kOl(v),this.BC.$Rl(v),this.BC.gOl(v),this.BC.jOl(v),this.BC.hOl(v),this.BC.iOl(v),this.TNh(),this.BC.Wsk()&&(this.nMh(!0,this.Ina),this.BC.PRl(v)));if(!(0>=this.faa.count))for(const Ja of this.faa)try{Ja&&
(ma?window.setTimeout(()=>{Ja.Fjh()},100):Ja.Fjh())}catch(Va){Q.a.J(512496857,813,10,"Exception message: "+Va.message)}}catch(ma){Q.a.J(512496856,813,10,"Exception message: "+ma.message)}}Cvl(v){v&&this.faa.add(v)}Tfm(v){this.faa.remove(v)}nMh(v,S){this.nVg=this.Ba.zWc?v:v&&0!==S}Fkg(){return this.nVg&&!this.Tcd}ZVe(v){this.Tcd=!v}Hi(){return this.sa.presentation.slideCount+this.BC.QLe}TNh(){this.Ina=this.JPj();this.Ex.EEl(fb[this.Ina]);this.nEl()}nEl(){this.Tzb()?this.Ex.i4e("V3"):1!==this.Ina||
this.Ba.zWc?2===this.Ina&&this.Ba.yWc&&this.Ex.i4e("V2"):this.Ex.i4e("V1")}JPj(){try{const v=this.Tb.YJ();if(v&&0<v.length)for(const S of v)if(S){const ma=S.ThemeFamilyId;if(this.Ba.yWc&&ma.toLowerCase()===Gf.Y6h.toLowerCase())return 2;if(0<=Array.indexOf(this.Ba.JCi,ma)||Object(id.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Lb.getBooleanAppSetting("DisableAgendaToPPTForUnsupportedTheme")&&void 0===hf.a.UAa.find(Ja=>Ja.QXc===ma))return 1}return 0}catch(v){return Q.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+
v.message),0}}Xge(v){return this.G1.yab[v].t3f}gig(v){let S;S=0;for(const ma of this.G1.yab){if(ma.t3f===v)return{returnValue:ma,themeIndex:S};S++}Q.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+v);return{returnValue:null,themeIndex:S}}slj(v){return v?!v.Nce:(Q.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.Gib.tn(Object(r.a)(this,this.Mkb,
"onPresentationPropertyChange"));this.Kad=0}yM(){return(new Date).getTime()}}Gf.Zjf=4;Gf.Y6h="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";Gf.I6h=1;Gf.H6h=2;Gf.G6h=0;Object(k.a)(Gf,"AgendaConverterManager",null,[106]);class Kg{constructor(v,S,ma){this.Ex=v;this.Hc=S;this.rP=ma;this.ps()}ps(){this.Hc.tOc(Object(r.a)(this,this.Vpa,"onUndoRedo"))}dispose(){this.Hc.tvd(Object(r.a)(this,this.Vpa,"onUndoRedo"))}tcc(v,S){v===$a.a.C3b&&(this.Ex.ZVe(S),this.rP.ZVe(S))}Vpa(v,S){this.tcc(S.Mgf,S.pfb)}}Object(k.a)(Kg,
"AgendaConverterUndoRedoController",null,[1178]);class Lg{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(k.a)(Lg,"IAgendaSettings",null,[]);class se{constructor(v,S,ma,Ja,Va){this.hTf="HighConfidenceAgendaDetected";this.iA=null;this.ua=new xd.a;this.Dad=null;this.dld=0;this.ka=ma;this.Us=S;this.Fa=Va;this.iA||(S=new Lg,S.isEntryState=!0,S.pptAppFrameDomElement=this.Us.JG(),S.maxTryAgainCount=this.ka.dNf,this.iA=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(S));
this.R6l();this.rP=v;this.ka&&this.ka.xWc&&this.rP.Cvl(this);this.Ex=Ja;this.Tfb=!1}Fjh(){this.rP&&(this.rP.Fkg()?(this.Ex.mEl(this.rP.BC.VNe),this.cRh(this.Dad),1===this.rP.BC.VNe&&this.ua.raiseEvent(this.hTf,null)):this.Zne())}ccm(){this.iA&&(this.Ex.y2k(),this.iA.showAgendaToPptDialog(this.rP.Hi()),this.Fa.O4c(dd.a.cNf,dd.a.Nj,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.qk(dd.a.cNf,!0),this.Tfb=!0)}$kh(){this.Zne();this.Ex.A2k();window.setTimeout(()=>{this.kcm()},8E3)}E2k(v){this.qSh(v);
this.Ex.Xkh(!0)}D2k(v){this.qSh(v);this.Ex.Xkh(!1)}x2k(v){this.l1l(v)}B2k(){this.dld>=this.ka.dNf?this.iA.showAgendaToPptDismissCard():(this.dld+=1,this.iA.showAgendaToPptFailureCard());this.Ex.Xnh()}Zkh(){this.iA&&this.Tfb&&this.iA.showSlidePreviewError()}C2k(){this.iA.showMergeSlidesError();this.Ex.Xnh()}cRh(v){this.ka.xWc&&(this.o7e(v),this.iA&&this.Dad&&this.rP&&this.rP.Fkg()&&(this.iA.showAgendaCard(this.Dad,this.rP.BC.QLe),this.Ex.v2k()))}Zne(){Q.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");
this.iA&&!this.Tfb&&(this.iA.hideAgendaCard(),this.o7e(null))}qSh(v){this.iA&&this.Tfb&&this.iA.populateThemesInAgendaDialog(v)}l1l(v){this.iA&&this.Tfb&&this.iA.populatePreviewSlidesInAgendaDialog(v)}o7e(v){this.Dad=v}kcm(){if(this.ka.Vhl)try{const v=C.a.instance.Ha("Common.ISystemInitiatedFeedback");v&&(Q.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),v.execute(S=>{S.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(v){Q.a.J(562422278,
813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",v)}}R6l(){this.iA.on(se.J6h,()=>{this.ECi()});this.iA.on(se.M6h,()=>{this.HCi()});this.iA.on(se.K6h,()=>{this.FCi()});this.iA.on(se.L6h,()=>{this.GCi()});this.iA.on(se.Q6h,v=>{this.DCi(v)});this.iA.on(se.N6h,v=>{this.bNf(v,!1)});this.iA.on(se.O6h,()=>{this.ICi()});this.iA.on(se.P6h,v=>{this.bNf(v,!0)})}ECi(){this.xUh()}HCi(){this.Ex.W$k();this.xUh()}FCi(){this.aNf();this.Ex.Glh()}GCi(){this.aNf();this.Ex.I4k()}aNf(){this.cleanup();
this.rP.Tfm(this)}xUh(){this.rP.pZh()}DCi(v){this.rP.yff(v)}bNf(v,S){this.Ex.z2k(v,S);this.Tfb=!1;this.iA.hideAgendaToPptDialog();this.rP.qZh(v)}ICi(){this.Tfb=!1;this.iA.hideAgendaToPptDialog();this.Ex.Glh()}cleanup(){this.o7e(null);this.dld=0;this.iA.cleanup()}$yi(v){this.ua.addHandler(this.hTf,v)}}se.J6h="AgendaCardAddSlides";se.M6h="AgendaCardTryAgain";se.K6h="AgendaCardCancel";se.L6h="AgendaCardDismiss";se.Q6h="AgendaToPptDialogThemeSuggestionSelected";se.N6h="AgendaToPptDialogApply";se.O6h=
"AgendaToPptDialogCancel";se.P6h="AgendaToPptDialogMergeTryAgain";Object(k.a)(se,"AgendaConverterView",null,[1179,1206]);var xi=d(693);class gi{constructor(){this.Tmc={}}uBd(v){this.Tmc[v]=new xi.a(v,!0)}ASb(v){if(v in this.Tmc){var S=this.Tmc[v];S.stop();S=S.eWc;delete this.Tmc[v];return S}return-1}pWe(v){return v in this.Tmc}}Object(k.a)(gi,"AgendaPerfLogger",null,[]);class jf{constructor(){this.q7c=this.Fzg=this.Hzg=this.Gzg=!1}JDk(){this.q7c&&!this.Gzg&&(this.Gzg=!0,pb.b(jf.xMi))}rEk(){this.q7c&&
!this.Hzg&&(this.Hzg=!0,pb.b(jf.yMi))}lBk(){this.q7c&&!this.Fzg&&(this.Fzg=!0,pb.b(jf.wMi))}static Mzk(v){v&&v.isCreateNew&&pb.b(jf.vMi)}}jf.xMi="WAC_Exp_AgendaToPPTHighConfidenceSeen";jf.yMi="WAC_Exp_AgendaToPPTHighConfidenceTried";jf.wMi="WAC_Exp_AgendaToPPTHighConfidenceKept";jf.vMi="WAC_Exp_AgendaToPPTIsCreateNew";Object(k.a)(jf,"ExperimentationMetrics",null,[]);class th{constructor(){this.lEe=this.FDe=this.FBe=this.Kwa=null;this.HFe=!1;this.kRg=this.bMg=this.xdh=this.Ba=null;this.oPe="";this.KFe=
!1;this.EBe=""}reset(){this.xdh={};this.bMg=new gi;this.kRg=new jf;this.oPe="";this.KFe=!1;this.EBe="";this.lEe=this.FDe=this.FBe=this.Kwa=null;this.HFe=!1}get telemetryData(){return this.xdh}get rXc(){return this.kRg}get w9(){return this.bMg}get td(){return this.Ba}set td(v){this.Ba=v}get FCd(){return this.oPe}set FCd(v){this.oPe=v}get bVa(){return this.KFe}set bVa(v){this.KFe=v}get dR(){return this.EBe}set dR(v){this.EBe=v}get tX(){return this.Kwa}set tX(v){this.Kwa=v}get RH(){return this.FBe}set RH(v){this.FBe=
v}get BU(){return this.FDe}set BU(v){this.FDe=v}get documentOpenType(){return this.lEe}set documentOpenType(v){this.lEe=v}get fec(){return this.HFe}set fec(v){this.HFe=v}}Object(k.a)(th,"AgendaMetricsState",null,[]);var Fn=d(792);class Jj{constructor(v,S){if(!v)throw Error.argumentNull("AgendaThemetype is null");if(!S)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.fxa=new Fn.a;this.fxa.Ika(Object.assign(new B.a,{name:"AgendaThemeType",string:v}));this.fxa.Ika(Object.assign(new B.a,
{name:"AgendaFlowVersion",string:S}))}L7(v){hc.a.Ta(v)||this.fxa.Ika(Object.assign(new B.a,{name:"AgendaSessionId",string:v}));return this}myd(v){this.fxa.Ika(Object.assign(new B.a,{name:"AgendaThemeIndexSelected",int64:v}));return this}Anb(v){hc.a.Ta(v)||this.fxa.Ika(Object.assign(new B.a,{name:"AgendaCardState",string:v}));return this}qNa(v){hc.a.Ta(v)||this.fxa.Ika(Object.assign(new B.a,{name:"AgendaDialogState",string:v}));return this}k3a(v){hc.a.Ta(v)||this.fxa.Ika(Object.assign(new B.a,{name:"AgendaButtonClickedType",
string:v}));return this}fzd(v){hc.a.Ta(v)||this.fxa.Ika(Object.assign(new B.a,{name:"AgendaSeenTriedKept",string:v}));return this}j3(v){hc.a.Ta(v)||this.fxa.Ika(Object.assign(new B.a,{name:"DocumentOpenType",string:v}));return this}build(){return this.fxa.dataFields}}Object(k.a)(Jj,"AgendaToPptActivityDataPointBuilder",null,[]);class yi{constructor(){this.Yc=null;this.p0a=new xi.a("AgendaToPpt",!1);this.j9e()}j9e(){this.Yc=new th;this.Yc.reset();this.Yc.telemetryData.Flights="";w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Yc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Yc.telemetryData.InitialUserThemeType=this.Yc.dR}N4k(v){v&&(this.Yc.td=v,this.Yc.documentOpenType=yi.Yzj(v),jf.Mzk(this.Yc.td),this.Yc.telemetryData.IsDocumentOpenTypeCreateNew=this.Yc.td.isCreateNew.toString())}Ykh(v,S){if(this.Yc.w9.pWe("AgendaToPptDialogThemeApply")&&"V2"===this.Yc.RH){var ma=this.Yc.w9.ASb("AgendaToPptDialogThemeApply");this.Yc.telemetryData.TotalTimeTakenToMerge=ma.toString();pb.a(yi.DX,v,
ma,S)}else this.Yc.w9.pWe("OnAddSlidesClicked")?(ma=this.Yc.w9.ASb("OnAddSlidesClicked"),this.Yc.telemetryData.TotalTimeTakenToMerge=ma.toString(),pb.a(yi.DX,v,ma,S)):this.Yc.w9.pWe("OnTryAgainClicked")&&(ma=this.Yc.w9.ASb("OnTryAgainClicked"),this.Yc.telemetryData.TotalTimeTakenToMerge=ma.toString(),pb.a(yi.DX,v,ma,S));this.Yc.fec=!1}v2k(){this.Yc.fec=!1;if(!("Seen"in this.Yc.telemetryData)){this.gO("OnAgendaCardShown");this.p0a.start();this.Yc.telemetryData.Seen="true";Q.a.J(508692634,813,50,"AgendaCard shown");
const v=(new Jj(this.Yc.dR,this.Yc.RH)).Anb("AgendaCardShown").fzd("Seen").j3(this.Yc.documentOpenType).build();pb.a(yi.DX,!0,0,v);this.Yc.rXc.JDk()}}f2k(){this.Yc.fec?this.tEk():this.Ryk()}Ryk(){this.gO("OnAddSlidesClicked");this.p0a.stop();this.Yc.telemetryData.Tried="true";this.Yc.w9.uBd("OnAddSlidesClicked");Q.a.J(508692633,813,50,"AgendaCard tried in MS:{0}",this.p0a.eWc);const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).Anb("AgendaCardShown").k3a("AddSlides").fzd("Tried").j3(this.Yc.documentOpenType).build();
pb.a(yi.DX,!0,this.p0a.eWc,v);this.Yc.rXc.rEk()}A2k(){this.gO("OnAgendaToPPTApply");this.Yc.bVa=!0;this.Yc.telemetryData.Kept="true";this.Yc.telemetryData.Event="AgendaCompleted";const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).Anb("AgendaCompleted").j3(this.Yc.documentOpenType).build();this.Ykh(!0,v);Q.a.J(508692632,813,50,"AgendaToPPT Completed successfully")}W$k(){this.Yc.fec=!0;this.gO("OnTryAgainClicked");this.Yc.telemetryData.Tried="true";this.Yc.telemetryData.Event="AgendaTryAgain";this.Yc.w9.uBd("OnTryAgainClicked");
Q.a.J(508692631,813,50,"AgendaCard retry attempt")}tEk(){const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).Anb("AgendaMergeError").k3a("TryAgain").fzd("Tried").j3(this.Yc.documentOpenType).build();pb.a(yi.DX,!0,0,v)}y2k(){this.gO("OnAgendaDialogShown");this.Yc.BU="Loading";Q.a.J(508692630,813,50,"AgendaDialog shown");const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).qNa(this.Yc.BU).j3(this.Yc.documentOpenType).build();pb.a(yi.DX,!0,0,v)}Xkh(v){this.gO("OnAgendaThemePaneLoadedSuccess");this.Yc.BU=
v?"ThemeSuggestions":"ThemeSuggestionsFailure";v=this.Yc.w9.ASb("OnAddSlidesClicked");this.Yc.telemetryData.ThemePaneLoadingTime=v.toString();const S=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).qNa(this.Yc.BU).j3(this.Yc.documentOpenType).build();pb.a(yi.DX,!0,v,S)}cFi(v){this.gO("ThemeDeckSuggestionId");this.Yc.telemetryData.SelectedDeckSuggestionId=v}U$k(v){"V2"===this.Yc.RH&&(this.gO("OnTriggerDifferentThemeWorkflow"),this.Yc.BU="ThemeSuggestions",this.Yc.w9.uBd("TriggerDeckLevelDesigner_"+
v),v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).qNa(this.Yc.BU).myd(v).k3a("ThemeSelected").j3(this.Yc.documentOpenType).build(),pb.a(yi.DX,!0,0,v))}Wkh(v,S){this.gO("OnAgendaDeckPreviewLoaded");this.Yc.BU=S?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";S=this.Yc.w9.ASb("TriggerDeckLevelDesigner_"+v);this.Yc.telemetryData["DeckPreviewLoadTime_"+v]=S.toString();v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).qNa(this.Yc.BU).myd(v).j3(this.Yc.documentOpenType).build();pb.a(yi.DX,
!0,S,v)}w2k(v){const S=this.Yc.w9.ASb("TriggerDeckLevelDesigner_"+v);this.gO("OnAgendaDeckPreviewError");this.Yc.BU="AgendaDeckPreviewError";let ma="";"DeckPreviewFailure"in this.Yc.telemetryData&&(ma=this.Yc.telemetryData.DeckPreviewFailure.toString());this.Yc.telemetryData.DeckPreviewFailure=ma+v.toString()+";";v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).qNa(this.Yc.BU).myd(v).j3(this.Yc.documentOpenType).build();pb.a(yi.DX,!1,S,v)}z2k(v,S){this.gO("OnAgendaDialogThemeApply");this.Yc.BU=S?
"AgendaDeckMergeError":this.Yc.BU;this.Yc.w9.uBd("AgendaToPptDialogThemeApply");v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).myd(v).qNa(this.Yc.BU).k3a(S?"TryAgain":"Apply").j3(this.Yc.documentOpenType).build();pb.a(yi.DX,!0,0,v)}Glh(){this.gO("OnCancelClicked");this.Yc.bVa=!0;this.Yc.telemetryData.Kept="false";this.Yc.telemetryData.Event="AgendaCancelled";Q.a.J(508692629,813,50,"AgendaToPPT clicked Cancel button");const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).k3a("Cancel").j3(this.Yc.documentOpenType);
"V2"===this.Yc.RH?v.qNa(this.Yc.BU):v.Anb("AgendaMergeError");pb.a(yi.DX,!0,0,v.build())}I4k(){this.gO("OnDismissClicked");this.Yc.bVa=!0;this.Yc.telemetryData.Kept="false";this.Yc.telemetryData.Event="AgendaDismissed";Q.a.J(508692628,813,50,"AgendaToPPT clicked Dismiss button");const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).k3a("Dismiss").j3(this.Yc.documentOpenType);"V2"===this.Yc.RH?v.qNa(this.Yc.BU):v.Anb("AgendaMergeError");pb.a(yi.DX,!0,0,v.build())}Xnh(){this.gO("OnMergingErrorInAgenda");
this.Yc.bVa=!0;this.Yc.telemetryData.Kept="false";this.Yc.telemetryData.Event="AgendaError";const v=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).j3(this.Yc.documentOpenType);"V2"===this.Yc.RH?(this.Yc.BU="AgendaMergeError",v.qNa("AgendaMergeError")):v.Anb("AgendaMergeError");this.Ykh(!1,v.build())}ZVe(v){let S=!1;this.gO("OnUndoRedoClicked");let ma=(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).j3(this.Yc.documentOpenType);if("Kept"in this.Yc.telemetryData){this.Yc.telemetryData.Kept=(!v).toString();
const Ja=v?"UndoClicked":"RedoClicked";this.Yc.telemetryData.Event=Ja;ma=ma.k3a(Ja)}else S=!0,ma.k3a("UndoRedoPostAgendaKept");pb.a(yi.DX,!0,0,ma.build());Q.a.J(508692627,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!v).toString(),S.toString())}tEl(v){this.gO("ReportCorrelationID");this.Yc.telemetryData.CorrelationId=v;this.Yc.tX=v}EEl(v){this.gO("ReportInitialUserThemeType");this.Yc.telemetryData.InitialUserThemeType=v;this.Yc.dR=v}i4e(v){this.gO("ReportAgendaToPptFlowVersion");this.Yc.telemetryData.AgendaToPptFlowVersion=
v;this.Yc.RH=v}mEl(v){this.gO("ReportAgendaScore");this.Yc.telemetryData.AgendaScore=v.toString();1===v&&this.CEl()}CEl(){this.gO("ReportHighConfidenceAgendaDetected");this.Yc.telemetryData.HighConfidenceAgendaDetected="true";this.Yc.rXc.q7c=!0}dispose(){Q.a.J(508692626,813,50,"AgendaToPPTMetrics: {0}",Ab.c(this.Yc.telemetryData))}LEl(){if(!this.Yc.telemetryData||!xf.a.count(this.Yc.telemetryData))return"";const v=Ab.c(this.Yc.telemetryData);if(this.Yc.FCd===v)return"";this.Yc.FCd=v;if("Kept"in this.Yc.telemetryData){const S=
(new Jj(this.Yc.dR,this.Yc.RH)).L7(this.Yc.tX).fzd("Kept").j3(this.Yc.documentOpenType).build(),ma=Boolean.parse(this.Yc.telemetryData.Kept.toString());pb.a(yi.DX,ma,0,S);ma&&this.Yc.rXc.lBk()}this.Yc.bVa&&(this.j9e(),this.Yc.bVa=!1);Q.a.J(508692625,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Yc.FCd,this.Yc.bVa.toString());return v}gO(v){this.Yc.telemetryData||(Q.a.J(508692624,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",v),this.j9e())}static Yzj(v){return v.isCreateNew?
"NewDocument":v.wYa?"ViewOnlyDocument":"EditDocument"}}yi.DX="AgendaToPptEvents";Object(k.a)(yi,"AgendaMetrics",null,[1177]);class dk{constructor(){this.Ba=this.K=null;this.c$g=!0;this.aMg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.rP=null}get name(){return"PowerPointWebEditor.AgendaConverter"}fc(v){this.K=v;this.K.register(1177,"PowerPointWebEditor.IAgendaMetrics").ma().na(()=>new yi);this.K.register(Gf,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().na(()=>new Gf(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").Cd(7),this.K.resolve("Common.IAppSettingsManager")));this.K.register(1178,"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().na(()=>new Kg(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");
const S=Ia.a(this.K);id.a("AgendaToPPT.DisableLocalizedStrings")?S("agendaConverter").then(()=>{this.K.register(1179,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>new se(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{}):S("powerpoint-agenda-to-ppt-strings").then(()=>{S("agendaConverter").then(()=>{this.K.register(1179,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>new se(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").Ue(Object(r.a)(this,this.Bvl,"registerAgendaDetectionEventHandler"))}dispose(){}Bvl(){this.Ba=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.rP=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const v=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ba.Wfj&&this.c$g&&2===v.mode&&(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(S=>{S.aM(this.aMg);
S.KBh(this.aMg,Object(r.a)(this.rP,this.rP.FM,"handleAnnotationEvent"))}),this.c$g=!1)}static main(){e.a.instance.Ac(new dk)}}Object(k.a)(dk,"AgendaConverterPackage",null,[2,3]);var lo=d(697);class sn{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd){this.Ihc=0;this.ia=v;this.Db=S;this.ka=ma;this.Fa=Ja;this.te=Va;this.oa=wb;this.Kn=Sb;this.JI=vc;this.Kx=gd;this.Ep=od;this.Cya=Vd}qb(){this.Bsi();this.ka.vkl&&this.Oag()&&this.Cya.continueWith(()=>{this.Cya.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}Bsi(){this.ia.pa($a.a.Ilb,
qb.a.application,Object(r.a)(this,this.Ilb,"presentToTeams"),4);this.ia.pa($a.a.gZe,qb.a.application,Object(r.a)(this,this.Ilb,"presentToTeams"),4);this.ia.pa($a.a.fZe,qb.a.application,Object(r.a)(this,this.Ilb,"presentToTeams"),4)}aJh(){this.Kx.hide();this.Zde()}Zde(){let v;uj.a.UDd();v=this.nbl();this.showDialog();return v}nbl(){this.Ep.Efc=!0;const v=yb.a.create().toString(),S=this.te.documentUrl;try{const Ja={};Ja.pptSharingUrl=lo.b(S);const Va=encodeURIComponent(Ag.c(Ja));let wb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}",
"1",v,Va);if(!hc.a.Ta(null)){const Sb=Hc.a.GD(null);wb=wb+"&fqdn="+Sb;const vc=encodeURIComponent(Ag.c({joinUrl:null}));wb=wb+"&meetingContext="+vc}var ma=wb;n.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.Ihc,v);window.open(ma,"_top")}catch(Ja){return n.ULS.sendTraceTag(508692483,838,15,"PresentToTeamsActor: failed with error: {0}",Ja),!1}return!0}showDialog(){const v=new Ya.StandardDialog;v.Fd=4;v.Te(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);v.Te(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);
v.Ky(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(r.a)(this,this.Vtc,"protocolLaunchingDialogResultHandler"))}Vtc(v){1===v||0===v?(n.ULS.sendTraceTag(508692482,838,50,"PresentToTeamsActor - restarting PPT session"),this.K2a()):2===v&&(n.ULS.sendTraceTag(508692481,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.nb($a.a.fZe,2))}K2a(){this.ia.Ia($a.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}Oag(){return!!this.te.documentUrl}Ilb(v,
S,ma){if(!this.Oag())return n.ULS.sendTraceTag(508692480,838,10,"PresentToTeamsActor: Document not supported"),8;if(1===ma)return 32;this.Ihc=v;if(this.Kn.isPaused)return this.Fa.Gd(),this.Zde()?32:8;this.oa.Bh();this.Fa.Gd();if(v===$a.a.fZe||1===this.Db.mode)return this.Zde()?32:8;this.JI.b$(!0,!0,()=>{this.aJh()},()=>{n.ULS.sendTraceTag(508692451,838,15,"PresentToTeamsActor: ForceSave failed");this.aJh();return!0});this.Kx.show(!1,this.Ihc);return 32}JZ(){}IZ(){}}Object(k.a)(sn,"PresentToTeamsActor",
null,[182]);class Ze{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}fc(v){this.K=v}init(){w.AFrameworkApplication.fa.Ue(()=>{(new sn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),
this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ye.a.Au(C.a.instance.Ha("Common.ISystemInitiatedFeedback")))).qb()})}dispose(){}static main(){e.a.instance.Ac(new Ze)}}Object(k.a)(Ze,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var Jk=d(752),Wg=d(19);class tg{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=
0}}Object(k.a)(tg,"DesignerSuggestionApplyInfo",null,[]);var xl=d(345),zq=d(536),$n=d(110);class yl{constructor(){this.vPc=null}}Object(k.a)(yl,"IdeasSlideSuggestionWrapper",null,[]);var Hf=d(106);class xj{constructor(){this.trigger=null;this.cid=this.sid=0;this.HM=null;this.timestamp=new Date;this.correlationId=yb.a.create().toString()}}Object(k.a)(xj,"DesignerRequestData",null,[]);var Gn=d(228);class rp{}Object(k.a)(rp,"SlideSuggestionData",null,[]);class Wd{}Wd.qYk="mivTitle";Wd.pYk="mivSubtitle";
Wd.Hmd="mivContainer";Wd.oYk="mivButtonsContainer";Wd.Chh="mivButton";Wd.nYk="mivButtonImage";Wd.jLb="mivOverlayContainer";Wd.pRe="mivIcon";Wd.kLb="mivTerm";Wd.Ehh="mivFrame";Wd.rYk="mivView";Wd.Fhh="mivIdx";Wd.rRe="mivKeepFocusStart";Wd.qRe="mivKeepFocusEnd";Wd.b8f="Editor";Wd.Xae="EditorContainer";Wd.Dfj="EditorTitle";Wd.zfj="EditorSubtitleContainer";Wd.d8f="EditorSubtitle";Wd.nfj="EditorBucketContainer";Wd.Vab="EditorPrev";Wd.E8b="EditorPrevDisabled";Wd.szb="EditorPrevEnabled";Wd.Wae="EditorBucketCurrent";
Wd.ofj="EditorBucketTotalCount";Wd.S7f="EditorBucketTotal";Wd.qzb="EditorNext";Wd.rzb="EditorNextEnabled";Wd.D8b="EditorNextDisabled";Wd.qfj="EditorDescription";Wd.tfj="EditorIgnoreContainer";Wd.C8b="EditorIgnore";Wd.xfj="EditorSeeMoreContainer";Wd.G8b="EditorSeeMoreLabel";Wd.T7f="EditorCardContent";Wd.g8f="EditorSuggestionsContainer";Wd.GUa="EditorSuggestionContainer";Wd.nWc="EditorSuggestionArrow";Wd.Afj="EditorSuggestionCheck";Wd.f8f="EditorSuggestionText";Wd.e8f="EditorSuggestionInstances";Wd.ufj=
"EditorNoMoreContainer";Wd.Bfj="EditorSvgCheck";Wd.Efj="EditorWhiteCheck";Wd.sfj="EditorGreenFill";Wd.rfj="EditorGreenBorder";Wd.vfj="EditorNoMoreLabel";Object(k.a)(Wd,"IdeasCss",null,[]);class Gi{}Gi.kdc="IdeasPane";Gi.FUa="editorSuggestionIdx";Gi.FO="ClosePane";Gi.p6j="IdeasPaneOpen";Gi.Bpc=6;Gi.LWk=3;Gi.E3f="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(k.a)(Gi,"IdeasPaneConstants",null,[]);var lf=d(388),zl=d(162),Vo=d(199);class Je{constructor(v,S,ma,Ja,Va,wb,Sb){this.ykc=
null;this.sa=v;this.Wb=S;this.ka=ma;this.Sb=Ja;this.Wid=(v=this.ka.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.Xid=v?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.zb=Va;this.te=wb;this.fGb=Sb}jel(v){const S=[];try{if(!v||!v.SlideSuggestions)return Q.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),S;for(let ma=0;ma<v.SlideSuggestions.length;ma++){if(!v.SlideSuggestions[ma])continue;
const Ja=v.SlideSuggestions[ma].Base64Img;let Va=null;try{Va=Object.assign(new rp,{suggestionIndex:v.SlideSuggestions[ma].Index.toString(),suggestionCid:v.SlideSuggestions[ma].SlideId.Cid.toString(),suggestionSid:v.SlideSuggestions[ma].SlideId.Sid.toString(),imageData:Ja.startsWith("data:image")?Ja:"data:image/png;base64,"+Ja,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ma+1)})}catch(wb){Q.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),
Va=null}Va||(Va=Object.assign(new rp,{suggestionIndex:v.SlideSuggestions[ma].Index.toString(),suggestionSid:v.SlideSuggestions[ma].SlideSid.toString(),imageData:Ja.startsWith("data:image")?Ja:"data:image/png;base64,"+Ja,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ma+1)}));Array.add(S,Va)}}catch(ma){Q.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",ma)}return S}yzj(v,S,ma){if(!v)throw Error.argumentNull("suggestionsContainer");
return v.querySelector("#"+S+" ."+Je.vEa+'[correlationId="'+ma+'"]')}Nle(){return this.ka.Laj?this.ka.Kaj:this.ka.Jaj}C4c(v){if(!this.ka.designerIncrementalRenderEnabled)return!1;let S=!0;switch(v){case lf.a.moreIdeas:S=!1;break;case lf.a.newDocument:S=!1}return S}Q3e(v){Q.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Sb.correlationId,v.Abb);if(v.Ryb&&v.qXc&&v.Kia){var S=this.Qte(),ma=v.Kia.parentNode.parentNode.id;if(v.Caf&&this.ka.rUa&&v.Abb)switch(v.Ryb.DocumentUpsellStatus){case 0:this.pwi(v.Kia);
break;case 1:this.Fui(v.Kia);break;case 2:this.kui(v.Kia)}v.Abb&&this.ka.xWc&&this.IEh(v.Kia);var Ja=v.Abb?this.Q2i(v.qXc,v.ii,v.Kia,S,v.DFd):this.yzj(v.Kia,ma,v.ii);if(Ja)try{const wb=this.Sb.mTa,Sb=!pf.a.Ta(wb)&&ma===Gi.kdc,vc=this.ILi(v.Ryb,Sb,wb);if(v.Abb){this.Sb.Bef=new Date;v.DFd&&this.j5l(v.Pjj);for(var Va=0;Va<Ja.childNodes.length;Va++){const gd=Ja.childNodes[Va];v.DFd&&this.kZl(vc,Va)?Je.F0l(S,Va,gd):this.M3e(Sb?wb[Va].Type:0,v.Kia,gd,ma,v.qXc,vc[Va.toString()],Va,v.Caf,v.Ryb.DocumentUpsellStatus)}this.ka.Nla&&
v.Ryb.HasPaginationInfo&&this.ZRh(v.Kia,v.ii)}else if(v.DFd){Q.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Sb.correlationId,xf.a.count(vc));for(Va of Object.keys(vc)){const gd=parseInt(Va),od=v.Kia.querySelector("#"+ma+" ["+Je.wEa+'="'+gd+'"]');vc[Va]&&od&&Sys.UI.DomElement.containsCssClass(od.firstChild,"IncSuggestionPlaceholder")&&this.M3e(Sb?wb[gd].Type:0,v.Kia,od,ma,v.qXc,vc[Va],gd,v.Caf,v.Ryb.DocumentUpsellStatus)}}}catch(wb){Q.a.J(510248773,
829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Sb.correlationId,wb)}}}tDl(v,S,ma,Ja){try{if(!(v&&v.SlideSuggestions&&v.SlideSuggestions.length&&S))return!1;this.W3c(S);const Va=S.querySelector("."+Je.vEa);if(!Va)return!1;const wb=Va.childNodes.length,Sb=Va.childNodes.length+v.SlideSuggestions.length,vc=this.Qte(),gd=S.parentNode.parentNode.id;for(let od=0;od<v.SlideSuggestions.length;++od){const Vd=this.J0f(wb+od,Sb,vc);this.M3e(0,S,Vd,gd,Sb,v.SlideSuggestions[od],
wb+od,Ja,v.DocumentUpsellStatus);Va.appendChild(Vd)}v.HasPaginationInfo&&this.ZRh(S,ma);return!0}catch(Va){return Q.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",Va),!1}}ILi(v,S,ma){const Ja={};if(S)for(const Va of ma)switch(Va.Type){case 0:S=Va;ma=null;for(const wb of v.SlideSuggestions)if(wb.Index===S.IndexInDesigner){ma=wb;break}Ja[Va.Index.toString()]=ma;break;default:Ja[Va.Index.toString()]=Va}else for(const Va of v.SlideSuggestions)Ja[Va.Index.toString()]=Va;
return Ja}kZl(v,S){S=S.toString();return!(S in v)||!v[S]}pwi(v){const S=ub.a.we();S.className="DesignerFreeTrialCardContainer";const ma=ub.a.we();ma.className="DesignerFreeTrialCardTitle";ma.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Ja=ub.a.we();Ja.className="DesignerFreeTrialCardContent";Ja.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.Nle());const Va=ub.a.we();Va.className="DesignerStartFreeTrialButtonsContainer";const wb=ub.a.we();
wb.className=Je.Qwb;wb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;wb.tabIndex=0;wb.setAttribute(na.a.Rp,wb.innerText);wb.setAttribute(na.a.Ff,na.a.jx);const Sb=ub.a.we();Sb.className=Je.AQc;const vc=document.createElement("i");vc.className=Je.HQc;vc.style.lineHeight="20px";vc.setAttribute("Unselectable","on");const gd=ub.a.we();gd.className="DesignerStartTrialGoPremiumButtonText";gd.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;gd.setAttribute("Unselectable","on");
Sb.setAttribute(na.a.Rp,gd.innerText);Sb.setAttribute(na.a.Ff,na.a.jx);Sb.tabIndex=0;Sb.appendChild(vc);Sb.appendChild(gd);Va.appendChild(wb);Va.appendChild(Sb);S.appendChild(ma);S.appendChild(Ja);S.appendChild(Va);S.setAttribute(na.a.Rp,String.format("{0}. {1}",ma.innerText,Ja.innerText));S.setAttribute(na.a.Ff,na.a.mEa);v.appendChild(S)}a1f(){const v=ub.a.we();v.className="DesignerInFreeTrialView";const S=document.createElement("i");S.className=w.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":
"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const ma=ub.a.we();ma.className=Je.E4b;ma.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ma.tabIndex=0;const Ja=ub.a.we();Ja.className=w.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Ja.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;ma.setAttribute(na.a.Ff,na.a.g1d);ma.setAttribute(na.a.P9a,na.a.Xka);ma.setAttribute(na.a.Rp,ma.innerText);v.appendChild(S);v.appendChild(ma);v.appendChild(Ja);
v.setAttribute(na.a.Rp,ma.innerText+" "+Ja.innerText);v.setAttribute(na.a.Ff,na.a.mEa);return v}Jbm(){const v=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(v)for(let S=0;S<v.length;S++){const ma=v[S];if(ma.parentNode){const Ja=this.a1f();ma.parentNode.replaceChild(Ja,ma)}}this.q1h()}Fui(v){const S=this.a1f();v.appendChild(S)}kui(v){const S=ub.a.we();S.className="DesignerFreeTrialCardContainer";const ma=ub.a.we();ma.className="DesignerFreeTrialCardTitle";ma.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;
const Ja=ub.a.we();Ja.className="DesignerFreeTrialCardContent";Ja.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const Va=ub.a.we();Va.className=Je.D4b;const wb=document.createElement("i");wb.className=Je.HQc;wb.style.lineHeight="20px";const Sb=ub.a.we();Sb.className="DesignerTrialExhaustedGoPremiumButtonText";Sb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Va.setAttribute(na.a.Rp,Sb.innerText);Va.setAttribute(na.a.Ff,na.a.jx);Va.tabIndex=0;Va.appendChild(wb);Va.appendChild(Sb);
S.appendChild(ma);S.appendChild(Ja);S.appendChild(Va);S.setAttribute(na.a.Rp,String.format("{0}. {1}",ma.innerText,Ja.innerText));S.setAttribute(na.a.Ff,na.a.mEa);v.appendChild(S)}ZRh(v,S){const ma=ub.a.we();ma.className=Je.j3d;ma.setAttribute(Je.Pwb,S);ma.tabIndex=0;S=new Vo.a;S.Mh(16,16);S.Yqa("0,0,2048,2048");const Ja=new zl.a;Ja.h_("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
S.appendChild(Ja);S=S.va;S.setAttribute("class","DesignerMoreIdeasButtonIcon");ma.appendChild(S);S=ub.a.we();S.className="DesignerMoreIdeasButtonLabel";S.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;ma.appendChild(S);ma.setAttribute(na.a.Rp,S.innerText);ma.setAttribute(na.a.Ff,na.a.jx);v.appendChild(ma)}Q0l(v){if(v){var S=ub.a.DD();S.className="DesignerMoreIdeasLoading";S.src=Eb.a.GO(ah.a.iqa);v.appendChild(S)}}W3c(v){if(v){var S=v.querySelector("."+Je.j3d);S&&v.removeChild(S);(S=v.querySelector(".DesignerMoreIdeasLoading"))&&
v.removeChild(S)}}Q2i(v,S,ma,Ja,Va){const wb=ub.a.we();wb.className=Je.vEa;wb.setAttribute(Je.Pwb,S);wb.setAttribute(na.a.Rp,ResourceStrings.l_DesignerSuggestions);wb.setAttribute(na.a.Ff,na.a.P3b);Va&&(this.Sb.V4b=this.Mvj());for(S=0;S<v;++S)wb.appendChild(this.J0f(S,v,Ja));ma.appendChild(wb);return wb}J0f(v,S,ma){const Ja=ub.a.we();Ja.className=ma?this.Wid+"4x3":this.Wid;Ja.setAttribute(Je.wEa,v);Ja.tabIndex=0;Ja.setAttribute(na.a.Rp,String.format(ResourceStrings.l_DesignerSuggestionItem,v+1));
Ja.setAttribute(na.a.Ff,na.a.PSa);Ja.setAttribute(na.a.i1d,v+1);Ja.setAttribute(na.a.j1d,S);return Ja}M3e(v,S,ma,Ja,Va,wb,Sb,vc,gd){let od=null;this.ka.designerIncrementalRenderEnabled&&(S&&(od=S.querySelector("#"+Ja+' [IncSuggestionPlaceholder="'+Sb+'"]')),od&&Sys.UI.DomElement.addCssClass(od,"ShimmerPaused"),this.cBk(Sb,Va));S=!1;switch(v){case 0:this.ZTl(ma,wb,Sb);S=(v=vc&&this.ka.rUa)&&1!==gd;Va=Ja=gd=!1;if(wb&&wb.Categories)for(const Vd of wb.Categories)2===Vd?gd=vc&&!v:1===Vd?Ja=!0:3===Vd?Va=
!0:4===Vd&&this.ype(ma,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Sb);(gd||S)&&this.TUl(ma);Ja?this.ype(ma,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Sb):Va&&(this.ype(ma,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Sb),ma.setAttribute(Je.Z2d,Je.Z2d),ma.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.ka.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.Jti(ma,wb);break;case 1:this.rDl(ma,wb);break;case 2:this.iDl(ma);break;case 3:case 4:this.EDl(ma,wb)}od&&od.parentNode.removeChild(od);wb=ub.a.we();wb.className=Je.NQc;S&&(wb.style.visibility=bc.a.visible,ma.removeAttribute("tabindex"),ma.setAttribute(na.a.JJ,na.a.cC));ma.appendChild(wb)}rDl(v,S){if(S){v.className=Wd.Hmd;v.setAttribute(na.a.Rp,ResourceStrings.L_MakeItVisualCardTitle);var ma=ub.a.En();ma.className=Wd.qYk;ma.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Ja=ub.a.En();
Ja.className=Wd.pYk;Ja.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Va=ub.a.we();Va.className=Wd.oYk;Va.setAttribute(na.a.Ff,na.a.P3b);var wb=0,Sb=new uf.a,vc=Math.min(Gi.Bpc,S.SearchTerms.length);for(let gd=0;gd<vc;gd++)wb=this.p1f(S.SearchTerms[gd].Term,Va,Sb,gd,wb);for(S=vc;S<Gi.Bpc;S++)for(const gd of Gi.E3f)if(!Sb.contains(gd)){wb=this.p1f(gd,Va,Sb,S,wb);break}v.appendChild(ma);v.appendChild(Ja);v.appendChild(Va);this.Sb.Uld=!0}}p1f(v,S,ma,Ja,Va){const wb=ub.a.we();wb.className=Wd.Chh;
wb.setAttribute(na.a.Ff,na.a.PSa);const Sb=Wd.kLb+"."+Ja,vc=ub.a.DD();vc.className=Wd.nYk;vc.src=({MCb:Va}=this.fFj(v,ma,Va)).returnValue;vc.setAttribute(na.a.E4,Sb);ma=ub.a.we();ma.className=Wd.jLb;ma.tabIndex=0;ma.setAttribute(Wd.Fhh,Ja);ma.setAttribute(na.a.Ff,na.a.jx);Ja=document.createElement("i");Ja.className=Wd.pRe;Ja.innerText="\ue721";Ja.setAttribute(na.a.Ff,na.a.gR);const gd=ub.a.En();gd.className=Wd.kLb;gd.innerText=v;gd.id=Sb;wb.appendChild(vc);wb.appendChild(ma);ma.appendChild(Ja);ma.appendChild(gd);
S.appendChild(wb);return Va}fFj(v,S,ma){for(const Ja of Gi.E3f)if(Ja.toLowerCase()===v.toLowerCase())return S.add(Ja),{returnValue:this.te.Ok(v+".png"),MCb:ma};return{returnValue:this.te.Ok("stock"+ma++ +".png"),MCb:ma}}YTl(v,S){if(v){var ma=document.createElement("video");ma.className="SuggestedVideoBackgroundContainer";ma.setAttribute("Src",S);ma.setAttributeNode(document.createAttribute("muted"));Gn.a.Rok()||(ma.setAttributeNode(document.createAttribute("autoplay")),ma.setAttributeNode(document.createAttribute("loop")),
ma.addEventListener("canplay",()=>{ma.muted="true";ma.play()}));v.appendChild(ma)}}ype(v,S,ma,Ja){if(v){var Va=ub.a.DD();Va.src=this.te.Ok(S);Va.className="SuggestedMediaIcon";S=ub.a.En();S.className="SuggestedMediaContainer";S.appendChild(Va);v.setAttribute(na.a.Rp,String.format(ma,Ja+1));S.setAttribute("aria-hidden",na.a.cC);S.setAttribute("Unselectable","on");v.appendChild(S)}}Jti(v,S){v&&S&&S.DesignDescription&&0!=S.DesignDescription.length&&v.setAttribute(na.a.Rp,S.DesignDescription)}TUl(v){if(v)if(this.ka.rUa)Sys.UI.DomElement.addCssClass(v,
bc.a.Osc);else{v.setAttribute(Je.DQc,Je.DQc);var S=v.getAttribute(na.a.Rp);S&&v.setAttribute(na.a.Rp,String.format("{0}. {1}",S.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));na.a.bT(v,na.a.P9a,na.a.Xka);S=ub.a.we();S.className=Je.LQc;var ma=document.createElement("i");ma.className=Je.HQc;S.appendChild(ma);v.appendChild(S)}}q1h(){const v=document.getElementsByClassName(Je.H4b);if(v)for(let S=0;S<v.length;S++){Sys.UI.DomElement.removeCssClass(v[S].parentNode,bc.a.Osc);v[S].parentNode.tabIndex=
0;v[S].parentNode.removeAttribute(na.a.JJ);const ma=la.a.lfa(v[S].parentNode,Je.NQc);!ma||ma.getAttribute(Je.o3d)&&ma.getAttribute(Je.o3d).toString()===Je.xTf||(ma.style.visibility=bc.a.hidden)}}ugm(){if(this.ka.rUa){var v=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(v)for(var S=0;S<v.length;S++)v[S].parentNode.removeChild(v[S]);if(v=document.getElementsByClassName("DesignerInFreeTrialView"))for(S=0;S<v.length;S++)v[S].parentNode.removeChild(v[S]);this.q1h()}else if(v=document.getElementsByClassName(Je.LQc))for(S=
0;S<v.length;S++){v[S].style.display="none";const Ja=v[S].parentNode;Ja.removeAttribute(Je.DQc);Ja.removeAttribute(na.a.P9a);var ma=Ja.getAttribute(na.a.Rp);ma&&(ma=ma.toString(),ma=ma.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Ja.setAttribute(na.a.Rp,ma))}}ZTl(v,S,ma){if(v&&S)try{let Ja=!1;try{v.setAttribute(Je.p$a,S.SlideId.Sid),v.setAttribute(Je.MQc,S.SlideId.Cid),Ja=!0}catch(wb){Q.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Ja=!1}Ja||v.setAttribute(Je.p$a,S.SlideSid);const Va=ub.a.DD();Va.className=Je.H4b;Va.src=S.Base64Img;this.Sb.rua.contains(S.Index)||this.Sb.rua.add(S.Index);this.ka.eVc&&!hc.a.Ta(S.DesignerMediaURL)&&S.Categories&&pf.a.contains(S.Categories,1)&&this.YTl(v,S.DesignerMediaURL);v.appendChild(Va);Q.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",ma,this.Sb.correlationId)}catch(Ja){v.parentNode.removeChild(v),Q.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
ma,this.Sb.correlationId,Ja)}}iDl(v){if(pf.a.Ta(this.Sb.RX)||!this.Sb.BZi())v.style.display=bc.a.none;else{v.className=Wd.Xae;var S=ub.a.En();S.className=Wd.Dfj;S.innerText=ResourceStrings.L_ConsistencyCardTitle;var ma=ub.a.we();ma.className=Wd.zfj;var Ja=ub.a.En();Ja.className=Ja.id=Wd.d8f;Ja.innerText=Ja.title=this.Sb.RX[0].critiques[0].explanationLabel;var Va=ub.a.we();Va.className=Wd.nfj;var wb=ub.a.En();wb.innerText="<";wb.tabIndex=0;Sys.UI.DomElement.addCssClass(wb,Wd.Vab);Sys.UI.DomElement.addCssClass(wb,
Wd.E8b);wb.id=Wd.Vab;var Sb=ub.a.En();Sb.innerText="1";Sb.id=Wd.Wae;this.Sb.LO=0;var vc=ub.a.En();vc.innerText="/";var gd=ub.a.En();gd.className=Wd.ofj;gd.id=Wd.S7f;gd.innerText=this.Sb.RX.length.toString();var od=ub.a.En();od.innerText=">";od.tabIndex=0;od.className=od.id=Wd.qzb;0<this.Sb.RX.length-1?Sys.UI.DomElement.addCssClass(od,Wd.rzb):Sys.UI.DomElement.addCssClass(od,Wd.D8b);Va.appendChild(wb);Va.appendChild(Sb);Va.appendChild(vc);Va.appendChild(gd);Va.appendChild(od);ma.appendChild(Ja);ma.appendChild(Va);
Ja=ub.a.En();Ja.className=Wd.qfj;Ja.innerText=ResourceStrings.L_ConsistencyCardDescription;Va=Je.M0f();this.itg(Va,0);wb=ub.a.we();wb.className=Wd.tfj;Sb=ub.a.we();Sb.className=Wd.C8b;Sb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Sb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Sb.tabIndex=0;wb.appendChild(Sb);Sb=ub.a.we();Sb.className=Wd.xfj;vc=ub.a.En();vc.className=Wd.G8b;vc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;vc.tabIndex=0;Sb.appendChild(vc);vc=ub.a.we();vc.id=Wd.T7f;
vc.appendChild(ma);vc.appendChild(Ja);vc.appendChild(Va);vc.appendChild(wb);v.appendChild(S);v.appendChild(vc);v.appendChild(Sb);this.Sb.mWc=!0}}EDl(v,S){if(S){v.className=Je.JTf;v.setAttribute(na.a.Rp,S.TitleText);v.setAttribute(Je.wEa,S.Index);var ma=this.Y6l(S.ExecutionActionName);if(ma){var Ja=ub.a.DD();Ja.src=this.te.Ok("pegal.png");Ja.className=ma;var Va=ub.a.En();Va.className="cui-img-container cui-img-24by24";Va.appendChild(Ja);v.appendChild(Va)}Ja=ub.a.En();Ja.className="DesignerSuggestedActionTitle";
Ja.innerText=S.TitleText;Va=ub.a.En();Va.className="DesignerSuggestedActionSubtitle";Va.innerText=S.DescriptionText;S=ub.a.we();S.className=ma?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";S.appendChild(Ja);S.appendChild(Va);v.appendChild(S)}}IEh(v){try{if(this.fGb&&this.fGb.instance){const S=ub.a.we();S.id="AgendaCardContainer";S.className="AgendaCardContainer";v.appendChild(S);this.fGb.instance.cRh(S)}}catch(S){Q.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Sb.correlationId,S)}}tTi(){try{this.fGb&&this.fGb.instance&&this.fGb.instance.Zne()}catch(v){Q.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Sb.correlationId,v)}}Y6l(v){switch(v){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}itg(v,S){S=this.Sb.RX[S].critiques[0].suggestions;const ma=Math.min(Gi.LWk,S.length);for(let Ja=0;Ja<ma;Ja++)this.BZj(v,S[Ja].description,S[Ja].numberOfInstances,
Ja)}BZj(v,S,ma,Ja){const Va=ub.a.we();Va.className=Wd.GUa;Va.tabIndex=0;Va.setAttribute(Gi.FUa,Ja);const wb=ub.a.En();wb.className=Wd.nWc;wb.innerText="\u2192";wb.setAttribute(Gi.FUa,Ja);const Sb=ub.a.En();Sb.className=Wd.f8f;Sb.innerText=S;Sb.setAttribute(Gi.FUa,Ja);S=ub.a.En();S.className=Wd.e8f;S.innerText=String.format("[{0}]",ma);S.setAttribute(Gi.FUa,Ja);Va.appendChild(wb);Va.appendChild(Sb);Va.appendChild(S);v.appendChild(Va)}j5l(v){this.DBd();this.ykc=new W.a(2,1,this.ka.designerIncrementalRenderTimeoutInMs,
()=>{this.bBk(v)},void 0,"IncrementalRenderTimeoutTask");this.zb.Jb(this.ykc)}DBd(){this.ykc&&(this.zb.Vg(this.ykc),this.ykc=null)}bBk(v){this.DBd();for(let S=0;S<v;S++)this.Sb.rua.contains(S)||this.Sb.B4c.add(S)}cBk(v,S){if(!this.Sb.lTa.contains(v)&&(this.Sb.lTa.add(v),v=this.Sb.lTa.count,v===S&&(this.Sb.i3b=new Date,this.DBd()),!this.Sb.XUb&&v>=this.Sb.V4b)){for(S=0;S<this.Sb.V4b;S++)if(!this.Sb.lTa.contains(S))return;this.Sb.XUb=new Date}}Mvj(){const v=document.getElementById("WACDocumentPanel");
if(v){const S=this.ka.useWideSuggestionThumbs,ma=this.Qte();return Math.floor((v.offsetHeight-87)/(S||ma?135:101))}return 1}Qte(){const v=this.Bw();return.01>=Math.abs(v.width/v.height-1.33)}NWf(v,S){this.cif(this.HAb(v,S),S,!1)}lLh(v,S){this.cif(v,S,!0)}vfm(v){if(v&&(v=v.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var S=-1!==v.className.indexOf("4x3");this.cif(v,S,!1)}}cif(v,
S,ma){v&&(ma?(v.className=S?this.Xid+"4x3":this.Xid,na.a.bT(v,na.a.Q9a,na.a.cC)):(v.className=S?this.Wid+"4x3":this.Wid,na.a.bT(v,na.a.Q9a,na.a.Xka)))}Bw(){return this.Wb.Bw()}HAb(v,S){return v.querySelector("."+(S?this.Xid+"4x3":this.Xid))}get Aa(){return Object(N.a)(205,this.sa.Aa)}JJh(v,S){if(v){if(v=v.querySelector("["+Je.wEa+'="'+S+'"]'))S=Cd.a.wi(v),v.contains(Cd.a.KVa(new Sys.UI.Point(S.x,S.y)))&&v.contains(Cd.a.KVa(new Sys.UI.Point(S.x+S.width-1,S.y)))?v.contains(Cd.a.KVa(new Sys.UI.Point(S.x,
S.y+S.height-1)))&&v.contains(Cd.a.KVa(new Sys.UI.Point(S.x+S.width-1,S.y+S.height-1)))||v.scrollIntoView(!1):v.scrollIntoView(!id.a("Designer.ScrollIntoViewFix"))}else Q.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static f$d(v){let S=null;try{S=Ag.a(v)}catch(ma){Q.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return S}static Cdl(v){const S=v.CardData;let ma=null;try{if(ma=Ag.a(S),!v.SlideSuggestions&&
ma)for(ma=Le.e(ma,Ja=>0!==Ja.Type),v=0;v<ma.length;v++)ma[v].Index=v}catch(Ja){Q.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Ja)}return ma}static F0l(v,S,ma){ma.style.backgroundColor="white";const Ja=ub.a.we();Ja.className=v?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Ja.setAttribute("IncSuggestionPlaceholder",S);(Ee.a.Fk||Ee.a.jg)&&Sys.UI.DomElement.addCssClass(Ja,"Shimmer");ma.appendChild(Ja)}static M0f(){const v=ub.a.we();v.className=
v.id=Wd.g8f;return v}}Je.vEa="DesignerSuggestionList";Je.Pwb="correlationId";Je.wEa="suggestionIndex";Je.p$a="slideId";Je.MQc="slideCid";Je.DQc="isShownAsPremiumContent";Je.Z2d="containsAnimation";Je.xTf="Refreshing";Je.o3d="SourceTrigger";Je.H4b="SuggestionImg";Je.HQc="ms-Icon ms-Icon--Diamond";Je.LQc="ShadowedTriangleContainer";Je.NQc="DesignerSuggestionListDisabled";Je.j3d="DesignerMoreIdeasButton";Je.JTf="DesignerSuggestedActionResult";Je.E4b="DesignerInFreeTrialViewGoPremiumText";Je.D4b="DesignerFreeTrialCardGoPremiumButton";
Je.Qwb="DesignerStartFreeTrialButton";Je.AQc="DesignerStartFreeTrialGoPremiumButton";Object(k.a)(Je,"DesignerViewHelper",null,[1161]);class sp{constructor(){this.cid=this.sid=0;this.e4c=this.HM=this.trigger=null}}Object(k.a)(sp,"PendingRequest",null,[]);class ri{constructor(){this.zNe=!1;this.BIb=null}get ZEg(){return this.zNe}get cIg(){return this.BIb}static get f1(){const v=new ri;v.zNe=!0;v.BIb=new Date;return v}static get ready(){const v=new ri;v.zNe=!1;v.BIb=null;return v}}Object(k.a)(ri,"RequestState",
null,[]);var Gh=d(344),Bo=d(377);class mh{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He,$m,Ck,cl,Nk,xn,um,km,Fj,uk,Nn,Hh,vk){this.sN=null;this.dLa=this.MSg=0;this.wZg=!1;this.OYa=this.TDe=this.pZa=null;this.$Og=!1;this.JZg=0;this.MXj=(fq,go,fp)=>{if(1===fp)return 32;try{this.Zp&&this.Zp.lp&&this.Zp.lp.isVisible?Ac.UISurfaces.qr().then(gp=>{gp.setSelectedTaskPane(dd.a.U9);return null}).catch(gp=>{Q.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",gp.toString())}):
this.ia.nb($a.a.z9b,2)}catch(gp){return Q.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",gp.toString()),8}return 32};this.Co=Sb;this.Zp=vc;this.$p=gd;this.rz=od;this.Sb=Vd;this.ia=v;this.fS=S;this.gb=Va;this.Fa=wb;this.sa=Ke;this.Wf=kg;this.Hc=If;this.ka=df;this.ic=ma;this.Eb=Ja;this.Qi=bg;this.Noa=ih;this.Voa=ri.ready;this.yaa=He;this.yb=$m;this.Nc=Ck;this.zb=cl;this.OKb=Nk;this.xjc=km;this.Wb=Fj;this.pN=uk;this.Ex=Nn;this.$Lg=Hh;this.uOg=vk;this.LSg=Object(r.a)(this,this.cWj,
"handleFirstRunExperienceEvent");um&&um.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(fq=>{this.wZg=fq;return null});this.ia.a3(this)}qb(){this.ka.J6c&&(this.ia.pa($a.a.GRh,qb.a.application,Object(r.a)(this,this.FRh,"showHideIdeas"),4),this.ia.pa($a.a.R$e,qb.a.application,Object(r.a)(this,this.FRh,"showHideIdeas"),4),id.a("Designer.QueryNewPane")&&this.ia.pa($a.a.Kuc,qb.a.application,Object(r.a)(this,this.fol,"queryShowHideDesignerPane"),96),this.ia.pa($a.a.wrh,qb.a.application,this.MXj,
4),this.ia.pa($a.a.z9b,qb.a.application,Object(r.a)(this,this.Q$e,"showHideDesigner"),4),this.ia.pa($a.a.y9,qb.a.application,Object(r.a)(this,this.y9,"applyDesignerSuggestion"),4),this.ia.pa($a.a.Xvb,qb.a.application,Object(r.a)(this,this.y9,"applyDesignerSuggestion"),4),this.ia.xa($a.a.nkb,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.nqc,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.zLb,qb.a.application,Object(r.a)(this,
this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.mkb,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.lqc,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.xLb,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.mqc,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),this.ia.xa($a.a.yLb,qb.a.application,Object(r.a)(this,this.Y0a,"navigateDesignerSuggestion")),
this.ia.pa($a.a.Aqa,qb.a.application,Object(r.a)(this,this.Aqa,"reportSuggestionSessionInfo"),64),this.ia.xa($a.a.Q4f,qb.a.application,Object(r.a)(this,this.pcm,"triggerOnUndoRedo")),this.ia.xa($a.a.uqe,qb.a.application,Object(r.a)(this,this.Asg,"handleImageUploadForDesigner")),this.ia.xa($a.a.l5c,qb.a.application,Object(r.a)(this,this.Asg,"handleImageUploadForDesigner")),this.Noa.E9a(Object(r.a)(this,this.J2,"onSlidePresenceChanged")),this.Wf.HJ(Object(r.a)(this,this.Gaj,"designerTargetSlideChangedHandler")),
this.ka.designerIncrementalRenderEnabled&&this.Hc.xzi(Object(r.a)(this,this.S8k,"onRenderSuggestions")),this.ka.Nla&&this.Hc.Gxi(Object(r.a)(this,this.l7k,"onMoreIdesClicked")),this.ka.I4f&&this.Hc.BSa(Object(r.a)(this,this.Mha,"onRibbonTabSwitched")),this.ka.RD&&this.Wf.F9a(Object(r.a)(this,this.Eaj,"designerSlidesSelectionChangedHandler")),this.ka.designerSendAppliedSuggestionHistoryEnabled&&this.yaa.a3b(Object(r.a)(this,this.Gha,"onBlockingStateChanged")),this.Wf.tLf(Object(r.a)(this,this.Ood,
"onForceOutboundGraphTransactionDisposed")),this.OKb.$2b(Object(r.a)(this,this.Hkb,"onMarkedUndo")),this.ka.l$d&&this.Nc.dEa(Object(r.a)(this,this.Rkb,"onSessionEnding")),this.Nc.bC(Object(r.a)(this,this.mo,"onSessionRehydrated")),this.xjc&&this.xjc.execute(v=>{v.ILf(Object(r.a)(this,this.qUe,"onEditorCritiques"))}),this.$Lg&&this.$Lg.execute(v=>{v.$yi(Object(r.a)(this,this.g6k,"onHighConfidenceAgendaDetected"))}),this.ka.yaj?(this.MSg=window.setTimeout(Object(r.a)(this,this.zgf,"tryTriggerNewDocDesignerRequest"),
this.ka.xaj),window.addEventListener("FREDecisionEvent",this.LSg,!0)):this.zgf(),!hc.a.Ta(this.ka.yYe)&&this.Haj(this.ka.yYe)&&(this.eVj(),this.lcm(this.ka.yYe)))}cWj(v){window.removeEventListener("FREDecisionEvent",this.LSg,!0);window.clearTimeout(this.MSg);(v=v.detail)&&v.show&&v.show||this.zgf()}Sd(){const v=this.Fa.Kc(dd.a.U9);v.bindAction(jb.KeyInputManager.Va(da.a.I3,0),$a.a.nkb);v.bindAction(jb.KeyInputManager.Va(da.a.gG,0),$a.a.nkb);v.bindAction(jb.KeyInputManager.Va(da.a.lJ,0),$a.a.nqc);
v.bindAction(jb.KeyInputManager.Va(da.a.zs,4),$a.a.zLb);v.bindAction(jb.KeyInputManager.Va(da.a.H3,0),$a.a.mkb);v.bindAction(jb.KeyInputManager.Va(da.a.fG,0),$a.a.mkb);v.bindAction(jb.KeyInputManager.Va(da.a.Pz,0),$a.a.lqc);v.bindAction(jb.KeyInputManager.Va(da.a.zs,0),$a.a.xLb);v.bindAction(jb.KeyInputManager.Va(da.a.F_,0),$a.a.mqc);v.bindAction(jb.KeyInputManager.Va(da.a.LW,0),$a.a.yLb)}Q$e(v,S,ma,Ja,Va){return this.uQ(this.Zp,dd.a.U9,ma,v,Va)}FRh(v,S,ma,Ja,Va){return Va||!this.Co.isVisible?this.uQ(this.Zp,
dd.a.Idb,ma,v,Va):0}uQ(v,S,ma,Ja,Va){var wb=this.sa.presentation;wb=!!this.sa.Aa&&!!wb&&!this.ic.Xc(wb);if(this.ka.RD){const Sb=this.gb.Xe();wb=!!Sb&&1===Sb.length&&wb}if(!wb)return 16;if(!this.rz.isEnabled())return 8;if(1===ma)return 32;Va||this.Fa.qk(S,v.lp.isVisible);Ja===$a.a.z9b?this.Sb.correlationId&&!this.Sb.bFb(this.Sb.correlationId)||this.xfa(lf.a.ITb):v.lp.isVisible?v.lp.zq(!1,Gh.a.NSb):(this.xfa(Ja===$a.a.R$e?lf.a.ITb:lf.a.$Ac),v.lp.zq(!0,Gh.a.none));return 32}fol(v,S,ma,Ja,Va){if(!Object(Wg.a)($n.a,
Va)||!this.Zp||!this.Zp.lp)return 8;Va.Rf(this.Zp.lp.isVisible);return 32}y9(v,S,ma,Ja,Va){S=this.sa.presentation;if(!this.sa.Aa||!S||this.ic.Xc(S))return 16;Ja=null;let wb=!0;Object(Wg.a)(tg,Va)?Ja=Va:Object(Wg.a)(yl,Va)&&(Ja=Va.vPc,wb=!1);if(!this.rz.isEnabled()||!Ja)return 8;if(this.rz.Bcl())return Q.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Ja.CorrelationId,v),8;if(1===ma)return 32;if(!this.gb.Js()){if(1===this.gb.Hd().length&&
this.gb.Hd()[0].Iv)return this.gb.Bh(),Q.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Ja.CorrelationId,v),8;this.gb.Bh()}if(!this.ka.Nla&&this.Sb.x0.sid===Ja.SuggestionSid)return Q.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Ja.CorrelationId,Ja.SuggestionSid),2;ma=this.Eb.xe(15);try{this.ka.designerSendAppliedSuggestionHistoryEnabled&&
(this.Sb.MSa=new Date),ma.mc(S),ma.Wc=v,S.rFa=Ja,this.Sb.x0=P.a.Aq(Ja.SuggestionSid,Ja.SuggestionCid),this.Sb.lV=!0,Q.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ja.CorrelationId,v,Ja.SuggestionSid)}finally{ma&&ma.dispose()}this.ka.designerBlockApplyUntilDraw?this.ic.Kta(S,this.sa.Aa,this.yb.Na,v):this.ic.mx(S,v);this.Co.isVisible&&this.Fa.Df(dd.a.Idb);wb&&this.Sb.JQe();return 32}Y0a(v,S,ma){S=this.sa.presentation;if(!this.sa.Aa||
!S||this.ic.Xc(S))return 16;if(!this.rz.isEnabled())return 8;if(1===ma)return 32;this.rz.I_j(v);return 32}Aqa(v,S,ma,Ja,Va){if(this.rz.Zp.lp.isVisible)return 0;this.wnb(Va.b8c,Va.JFl);return 32}wnb(v,S,ma){const Ja=this.Sb.correlationId;if(hc.a.Ta(Ja))Q.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",S);else if(this.Sb.bFb(Ja))Q.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",
Ja,S);else{var Va={};Va.CachedTrigger=this.Sb.r3d;Va.SuggestionSlideId=this.Sb.x0.sid.toString();Va.SuggestionSlideCreationId=this.Sb.x0.cid.toString();Va.AppliedSuggestion=this.Sb.lV;Va.DisplaySuggestionsTimeoutInMs=this.ka.k$d;Va.SuggestionsTimeout=this.Sb.lYa;Va.ClientAbort=this.Sb.IDb||this.rz.ycl();Va.DesignerPaneClosed=v;Va.ResetReason=S;Va.HoverPreviewDesignerTriggered=this.Sb.yCg;Va.DesignerFixPaneOpenHint=this.ka.K4f;Va.DesignerSendTraceRequestOnSessionEnded=this.ka.l$d;Va.UseWin32DesignerIconEnabled=
this.ka.m$d;Va.IsSimplifiedRibbon=this.Vfc();id.a("DesignerLogRetriggerReason")&&ma&&(Va.RetriggerReason=ma);this.ka.I4f&&(Va.DesignerDesignTabTriggerEnabled=!0);this.Zp.Nua()&&(this.ka.rUa?(Va[wf.a.i4h]=this.$p.Nle(),Va[wf.a.k4h]=!0,this.Sb.Nbf&&(Va.StartUpsellFreeTrial=!0)):Va[wf.a.WZf]=!0);v=!!S&&0<=S.indexOf(lf.a.moreIdeas);this.ka.Nla&&(Va.TermCorrelationId=mh.ule(),v||(Va.TermAction=this.jPj()));ma=Ag.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());var wb={};wb.ClientOS=
ma.Os;wb.Browser=ma.Browser||"";wb.BrowserVersion=ma.BrowserVersion||"";wb.BrowserMajorVersion=ma.BrowserMajorVersion||"";wb.BrowserMinorVersion=ma.BrowserMinorVersion||"";this.Sb.Izc&&this.Sb.Lia&&this.Sb.Lia>this.Sb.Izc&&(wb.SuggestionsE2ETimeMs=+this.Sb.Lia-+this.Sb.Izc);this.ka.designerIncrementalRenderEnabled&&(this.$p.DBd(),this.Tbf(),Va[wf.a.axg]=!0,wb.VisibleSuggestionsCount=this.Sb.V4b,0<this.Sb.B4c.count&&(wb.IncrementalRenderTimeoutIndexes=this.Sb.B4c.toArray().join(",")),0<this.Sb.tha.count&&
(wb.MissingDesignerCardIndexes=this.Sb.tha.toArray().join(",")),0<this.Sb.lTa.count&&(wb.CardIndexes=this.Sb.lTa.toArray().join(",")),0<this.Sb.rua.count&&(wb.DesignerCardIndexes=this.Sb.rua.toArray().join(",")),this.Sb.qR&&(this.Sb.Rpc&&this.Sb.Rpc>this.Sb.qR&&(wb.MissingDesignerCardsReceivedTime=+this.Sb.Rpc-+this.Sb.qR),this.Sb.i3b&&this.Sb.i3b>this.Sb.qR&&(wb.AllIncRenderReceivedTime=+this.Sb.i3b-+this.Sb.qR),this.Sb.XUb&&this.Sb.XUb>this.Sb.qR&&(wb.VisibleIncRenderReceivedTime=+this.Sb.XUb-+this.Sb.qR)));
this.Dui(wb);try{if(this.Ex.instance){const Sb=this.Ex.instance.LEl();hc.a.Ta(Sb)||(Va.AgendaMetrics=Sb)}}catch(Sb){Q.a.J(512496583,813,10,"exception while populating AgendaMetrics",Sb)}Va.BrowserData=wb;this.Sb.qR&&this.Sb.Lia&&this.Sb.Lia>this.Sb.qR&&(Va.TimeToDisplaySuggestionsInMs=+this.Sb.Lia-+this.Sb.qR);this.Sb.Bef&&this.Sb.MAc&&(Va.TimeSuggestionsRendered=this.Sb.Bef.toUTCString());this.Sb.MAc&&(Va.TimeDesignerPaneClosed=this.Sb.MAc.toUTCString());this.Sb.J3b&&0<this.Sb.J3b.count&&(Va.AppliedSuggestionHis=
this.Sb.J3b.toArray().join(" "));this.Qi.Aqa(Ja,Ab.c(Va),S===Gh.a.gyd);this.zim(Ja,S);this.Sb.KJf(Ja,this.ka.Nla&&v);Q.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",S,Ja)}}Vfc(){return w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.es?!0:!1}Dui(v){v.IdeasMivShown=this.Sb.Uld;v.IdeasMivDrillIn=this.Sb.zQe;v.IdeasEditorShown=this.Sb.mWc;v.IdeasEditorKept=this.Sb.lWc;v.IdeasEditorDrillIn=
this.Sb.U7f;v.AnyCardShown=this.Sb.mWc||this.Sb.Uld||0<this.Sb.lTa.count;v.AnyCardKept=this.Sb.lWc||this.Sb.lV}zim(v,S){this.rz.sLa(v,S===Gh.a.NSb||S===Gh.a.XBd||S===Gh.a.noSuggestion||S===Gh.a.S5f?xl.a.qLa:xl.a.pending)}S8k(v,S){S.zVh.addRange(this.Sb.rua);this.ZVf(S.zVh,S.Z$f,S.slideId,S.trigger,S.correlationId);S.Abb&&(this.OYa||this.Sb.tha.count||this.$4l(S.trigger,S.Z$f))}l7k(v,S){this.xfa(lf.a.moreIdeas,null,S.Y9c)}Mha(v,S){!S.zha||"PptRibbon.Design"!==S.zha&&"Design"!==S.zha||2!==S.Gv&&3!==
S.Gv&&4!==S.Gv||this.rz.Zp.lp.isVisible||32!==this.ia.nb($a.a.EAd,1)||this.xfa(lf.a.h$d)}$4l(v,S){this.Tbf();const ma=this.sa.Aa.Fb,Ja=this.Sb.correlationId;this.OYa=new W.a(2,1,this.ka.retryMissingDesignerCardsCountdownInMs,()=>{this.Sb.bFb(Ja)||this.ZVf(this.Sb.rua,S,ma,v,Ja,S)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.zb.Jb(this.OYa)}ZVf(v,S,ma,Ja,Va,wb=-1){if(this.Sb.rua.count===S)this.Tbf();else if(v&&v.count&&!(0<this.Sb.tha.count)){if(-1===wb)for(const Sb of v)Sb>wb&&(wb=Sb);this.TRi(v,
S,wb)&&this.odm(ma,Ja,Va)}}TRi(v,S,ma){for(let Ja=0;Ja<S&&(v.contains(Ja)||this.Sb.tha.contains(Ja)||this.Sb.tha.add(Ja),Ja!==ma||this.Sb.tha.count);Ja++);return 0<this.Sb.tha.count}odm(v,S,ma){const Ja={};Ja.MissingDesignerCardIndexes=this.Sb.tha.toArray().join(",");this.OYa=new W.a(0,1,0,()=>{this.Qi.oma(v.cid,v.sid,ma,mh.ule(),S,null,Ab.c(Ja),()=>{Q.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",
Ja.MissingDesignerCardIndexes,ma)},Va=>{Q.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Ja.MissingDesignerCardIndexes,Va.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.zb.Jb(this.OYa)}Tbf(){this.OYa&&(this.zb.Vg(this.OYa),this.OYa=null)}J2(v,S){(v=this.sa.Aa)&&S.slideId.equals(v.Fb)&&(this.rz.hBd(S.dTh,S.twh),this.rz.Zp.lp.isVisible&&!this.rz.isEnabled()&&
(Q.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",S.dTh,S.twh,this.Sb.correlationId),this.Co.zq(!1,Gh.a.vVi)),this.Co.isVisible&&(this.rz.isEnabled()||this.rz.sLa(this.Sb.correlationId,xl.a.qLa)))}Gaj(v,S){S.xpa?(v=Object.assign(new zq.a,{slideId:S.xpa.Fb}),this.ia.Ia($a.a.f2a,2,v),this.rz.hBd(v.dzc,v.swh),this.Co.isVisible&&(Q.a.J(512496577,
829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Sb.correlationId),this.rz.isEnabled()&&!S.xpa.hP?this.xfa(lf.a.Yaf):S.xpa.hP&&this.ka.designerNewSlideEnabled||(this.Co.zq(!1,Gh.a.slideNavigation),this.rz.sLa(this.Sb.correlationId,xl.a.qLa)))):Q.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Sb.correlationId)}qcc(v){this.ka.designerRequestThrottlingEnabled&&
(this.Voa=ri.ready,this.sN&&(this.Co.isVisible?(Q.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.sN.trigger,this.sN.sid),v()):this.sN=null))}Ukb(v,S){this.qcc(S);Q.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",v.HttpStatusCode);return!0}Eaj(){if(this.rz.Zp.lp.isVisible){const v=this.gb.Xe();v&&1<v.length&&(Q.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),
this.Co.isVisible&&this.Co.zq(!1,Gh.a.XZk))}}Gha(v,S){v=this.Sb.MSa;const ma=this.ka.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";v&&Object(N.a)(String,S.actionName)===ma&&(this.Sb.J3b.add(String.format("{0}:{1}:{2}",this.Sb.x0,+v-+this.Sb.Lia,+new Date-+v)),this.Sb.MSa=null)}Rkb(v,S){this.rz.Zp.lp.isVisible&&(Q.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Sb.correlationId,Bo.a[S.uE]),1!==S.uE&&3!==S.uE||this.wnb(!0,Gh.a.gyd))}mo(){Q.a.J(512496544,
829,50,"DesignerActor::OnSessionRehydrated");const v={};v[wf.a.KXc]=!0;this.xfa(lf.a.refresh,v)}Ood(v,S){S&&this.Dme(S.actionId,S.transaction.ny)}Hkb(v,S){if(S.iEb&&this.rz.JGg(S.actionId)){v={};if(S.revisionId){const ma=uj.a.Ava(Hf.a.d_,uj.a.Kcb(S.revisionId.toString()).toString());ma&&1===ma.length&&(v[wf.a.RE]=ma[0].RE)}this.Dme(S.actionId,v)}}Asg(v,S,ma,Ja,Va){switch(v){case $a.a.uqe:return this.Sb.lWk(Va),32;case $a.a.l5c:return this.Sb.dAl(Va),32;default:return 2}}HVk(v,S,ma){if(v!==lf.a.insertPicture&&
v!==lf.a.wza&&v!==lf.a.Y4c)return null;const Ja=ma?ma[wf.a.Ccc]:!1,Va=ma?ma[wf.a.G3c]:!1,wb=ma?ma[wf.a.Dcc]:!1,Sb=ma?ma[wf.a.F3c]:!1;let vc=null;switch(S){case $a.a.bqa:case $a.a.jrd:vc=Ja?wf.a.Zel:Va?wf.a.Yel:wb?wf.a.$el:Sb?wf.a.Xel:null;break;case $a.a.lrd:vc=Ja?wf.a.cfl:Va?wf.a.bfl:wb?wf.a.dfl:Sb?wf.a.afl:null;break;case $a.a.FNc:vc=wf.a.copilot;break;case $a.a.iYc:vc=wf.a.Feg;break;case $a.a.insertOnlinePicture:case $a.a.Xva:case $a.a.feb:vc=wf.a.Xkb;break;case $a.a.lyg:vc=wf.a.icon}vc||Q.a.J(512496543,
829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",v,S,this.Sb.correlationId);delete ma[wf.a.Ccc];delete ma[wf.a.G3c];delete ma[wf.a.Dcc];delete ma[wf.a.F3c];return vc}IVk(v,S){switch(v){case $a.a.iYc:case $a.a.insertOnlinePicture:case $a.a.Xva:case $a.a.Asc:case $a.a.lyg:case $a.a.FNc:case $a.a.feb:return lf.a.insertPicture;case $a.a.lrd:case $a.a.bqa:case $a.a.jrd:case $a.a.fsd:return S&&S[wf.a.Ccc]||S&&S[wf.a.G3c]&&
this.ka.bcm?lf.a.insertPicture:S&&S[wf.a.Dcc]?lf.a.wza:S&&S[wf.a.F3c]&&this.ka.uZh?lf.a.Y4c:this.ka.tBa?lf.a.$La:"";case $a.a.ow:case $a.a.AEa:case $a.a.dwb:return lf.a.dwb;case $a.a.lla:return lf.a.Taf;case $a.a.Kxc:case $a.a.Lxc:case $a.a.mzd:case $a.a.nzd:case $a.a.Nxc:return S&&wf.a.pCb in S&&S[wf.a.pCb]?lf.a.k4d:lf.a.refresh;case $a.a.mXf:case $a.a.I$a:return S&&wf.a.pCb in S&&S[wf.a.pCb]?lf.a.E4f:lf.a.refresh;case $a.a.mLa:case $a.a.Qmb:case $a.a.hxc:case Af.a.gXa:case $a.a.bringForward:case $a.a.bringToFront:case $a.a.sendToBack:case $a.a.sendBackward:return lf.a.Xmb;
case Af.a.v1d:case Af.a.y1d:case Af.a.Z3b:case Af.a.x1d:case Af.a.z1d:case Af.a.A1d:case Af.a.SSa:case Af.a.B1d:case Af.a.C1d:case Af.a.D1d:case Af.a.E1d:case Af.a.G1d:case Af.a.I1d:case Af.a.backspace:case Af.a.rEa:case Af.a.PJ:case Af.a.nUa:case Af.a.enter:case Af.a.WC:case Af.a.Nz:return lf.a.Nz;case $a.a.wza:return lf.a.wza;case $a.a.hsd:return this.ka.getBooleanAppSetting("DesignerUseRefreshTriggerForInsertTable")?lf.a.refresh:lf.a.insertTable;case $a.a.m7:case $a.a.pnd:case $a.a.FLb:case $a.a.uR:return lf.a.ypa;
case $a.a.KSa:return lf.a.y0d;case $a.a.PVf:return lf.a.e4d;case $a.a.pxb:return lf.a.pxb;default:return lf.a.refresh}}pcm(){const v={};v[wf.a.undoRedo]=!0;this.xfa(lf.a.refresh,v);return 32}Dme(v,S){if(!this.vdk(v)){var ma=wb=>{const Sb={};Sb[wf.a.timestamp]=wb.timestamp;Sb[wf.a.correlationId]=wb.correlationId;Sb[wf.a.trigger]=wb.trigger;Sb[wf.a.sid]=wb.sid;Sb[wf.a.cid]=wb.cid;Sb[wf.a.HM]=wb.HM;wb=this.Eb.ud(4);try{wb.mc(this.sa.presentation),wb.Wc=$a.a.L4f,this.sa.presentation.Qyb=Ab.c(Sb)}finally{wb&&
wb.dispose()}},Ja=this.IVk(v,S),Va=this.HVk(Ja,v,S);S||(S={});id.a("DesignerLogRetriggerReason")&&Ja===lf.a.refresh&&(S[wf.a.f5e]=v);if(this.X6c(Ja)||this.Co.isVisible)hc.a.Ta(Va)||(S[wf.a.Rea]=Va),this.rz.JGg(v)&&this.Co.isVisible?this.R9d(Ja,this.ka.designerTypeRefreshThrottleTimeoutMs,S,ma):Ja===lf.a.refresh&&this.Co.isVisible&&id.a("DesignerDelayRefreshTrigger")?this.R9d(Ja,this.ka.Daj,S,ma):v===$a.a.FNc?(v=this.ka.tc("ChatPPTDesignerTriggerDelayMs",100),this.JZg=Date.now(),this.R9d(Ja,v,S,ma)):
this.kXc(ma,Ja,S)}}R9d(v,S,ma,Ja){if(this.pZa){if(this.TDe===lf.a.insertPicture&&v===lf.a.refresh){this.zb.Vg(this.pZa);this.zb.Jb(this.pZa);return}this.I4d()}this.Co.isVisible&&(this.rz.sLa(this.Sb.correlationId,xl.a.pending),this.Wyd(v));const Va=this.sa.Aa;if(Va){var wb=Va.sid,Sb=Va.cid;this.TDe=v;this.pZa=new W.a(2,1,S,()=>{this.I4d();this.Co.isVisible&&Q.a.J(512496542,829,50,"Potential candidate for {0} request for designer pane",v);this.xZl(v,wb,Sb)||this.kXc(Ja,v,ma)},void 0,"DesignerDelayTriggerTask");
this.zb.Jb(this.pZa)}}I4d(){this.pZa&&(this.zb.Vg(this.pZa),this.TDe=this.pZa=null)}xfa(v,S=null,ma=null){S||(S={});this.kXc(Ja=>{if(this.ka.designerRequestThrottlingEnabled){if(this.Voa.ZEg&&+new Date-+this.Voa.cIg<this.ka.designerRequestThrottleIntervalMs){this.sN=new sp;this.sN.sid=Ja.sid;this.sN.cid=Ja.cid;this.sN.trigger=Ja.trigger;this.sN.e4c=Ja.HM;Q.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",v,Ja.sid);return}this.Voa=
ri.f1;this.sN=null}const Va=()=>{this.xfa(this.sN.trigger,this.sN.e4c,ma)};this.Qi.oma(Ja.cid,Ja.sid,Ja.correlationId,mh.ule(),Ja.trigger,ma,Ab.c(Ja.HM),wb=>{wb&&wb.Status===wf.a.fGh?this.lwd(()=>{this.xfa(Ja.trigger,Ja.HM,ma)}):this.dLa=0;this.dLa||this.qcc(Va)},wb=>this.Ukb(wb,Va))},v,S)}lwd(v){this.dLa<this.ka.designerMaxRetryOnWait?this.zb.Jb(new W.a(2,1,1E3,()=>{Q.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Sb.correlationId);this.Voa=ri.ready;
this.dLa++;v()},void 0,"RetryRequestOnWait")):Q.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Sb.correlationId)}zCj(v,S=null){S=S||{};this.ka.fVc&&v===lf.a.newDocument&&(S[wf.a.$fj]="true");this.ka.Faj&&(S[wf.a.d7l]=this.wZg);this.Zp.Nua()&&(this.ka.rUa?(S[wf.a.i4h]=this.$p.Nle(),S[wf.a.k4h]=!0):S[wf.a.WZf]=!0);this.$p.C4c(v)&&(S[wf.a.axg]=!0);this.rz.agk()&&(S[wf.a.w5d]=this.rz.w5d());S.NewPaneEnabled=!0;var ma=!pf.a.Ta(this.Sb.RX);
(S.RequestForEditorCardsForNewIdeasPane=ma)&&(S.NumEditorCritiques=this.r1i());ma={};ma.SupportsImageToTableSuggestedAction=32===this.ia.nb($a.a.rYe,1);S.PPTOEnabledSuggestedActions=Ab.c(ma);this.ka.tBa&&v===lf.a.$La&&(S[wf.a.jlb]=this.ka.jlb,S[wf.a.gXe]=this.ka.gXe,S[wf.a.fXe]=this.ka.fXe);return S}r1i(){let v=0;for(const S of this.Sb.RX)for(const ma of S.critiques)v+=ma.suggestions.length;return v}vdk(v){if(void 0===v||null===v)return!0;switch(v){case $a.a.y9:case $a.a.Xvb:case $a.a.mkb:case $a.a.lqc:case $a.a.xLb:case $a.a.nkb:case $a.a.nqc:case $a.a.zLb:case $a.a.mqc:case $a.a.yLb:case $a.a.L4f:return!0;
case $a.a.hXc:return this.ka.getBooleanAppSetting("ChatPPTImgShowDesigner")&&id.a("DesignerIgnore")&&Date.now()<this.JZg+this.ka.tc("ChatPPTImgIgnoreRefreshMs",2E4);case $a.a.mLa:case $a.a.Qmb:case $a.a.hxc:case Af.a.gXa:case $a.a.bringForward:case $a.a.bringToFront:case $a.a.sendToBack:case $a.a.sendBackward:return!this.Sb.lV;default:return!1}}d6i(v,S=null){const ma=this.sa.Aa;return ma?Object.assign(new xj,{trigger:v,sid:ma.sid,cid:ma.cid,HM:this.zCj(v,S)}):null}$ok(v){return Object(wl.b)(this,
void 0,void 0,function*(){if(!v||!v.sid||!this.X6c(v.trigger)&&!this.Co.isVisible)return!1;switch(v.trigger){case lf.a.ypa:case lf.a.$Ac:case lf.a.ITb:case lf.a.insertPicture:case lf.a.dwb:case lf.a.h$d:case lf.a.$6d:case lf.a.wza:case lf.a.Yaf:case lf.a.Taf:case lf.a.insertTable:return!0;case lf.a.Y4c:return this.ka.uZh;case lf.a.Nz:return this.ka.P4f&&this.Co.isVisible;case lf.a.Xmb:return this.ka.designerRetriggerEnabled&&this.Sb.lV;case lf.a.k4d:case lf.a.E4f:return this.ka.designerDesignElementsRemovedEnabled;
case lf.a.$La:return this.ka.tBa;case lf.a.y0d:case lf.a.e4d:case lf.a.pxb:return this.ka.triggerDesignerAfterApplyReplaceObject;case lf.a.refresh:return this.Tok(v.HM);case lf.a.moreIdeas:return this.ka.Nla;case lf.a.newDocument:const S=0===(yield this.uOg.Lge());return this.ka.fVc&&this.ka.isCreateNew&&!S;case lf.a.L_d:return this.ka.xff;default:return Q.a.J(512496538,829,15,"invalid trigger: {0}",v.trigger),!1}})}Tok(v){return wf.a.KXc in v&&v[wf.a.KXc]||wf.a.undoRedo in v&&v[wf.a.undoRedo]||this.ka.Baj&&
this.rz.Zp.lp.isVisible?!0:!1}X6c(v){switch(v){case lf.a.$Ac:case lf.a.ITb:case lf.a.insertPicture:case lf.a.Y4c:case lf.a.Taf:case lf.a.k4d:case lf.a.dwb:case lf.a.wza:case lf.a.newDocument:case lf.a.y0d:case lf.a.h$d:case lf.a.$6d:return!0;case lf.a.L_d:return this.ka.xff;case lf.a.$La:return this.ka.tBa;default:return!1}}udk(v){if(!(this.ka.designerSendActionDuration&&wf.a.RE in v.HM&&v.HM[wf.a.RE]))return!1;switch(v.trigger){case lf.a.$Ac:case lf.a.ITb:case lf.a.Yaf:case lf.a.newDocument:return!1;
case lf.a.refresh:return!(wf.a.KXc in v.HM)||!(wf.a.undoRedo in v.HM);default:return!0}}Wyd(v){const S=v===lf.a.Nz||v===lf.a.refresh?4:v===lf.a.moreIdeas?7:1;(this.rz.Zp.lp.isVisible||this.X6c(v))&&this.Zp.G3a(S)}lce(v,S,ma){var Ja,Va;Object(wl.b)(this,void 0,void 0,function*(){this.I4d();const wb=this.d6i(S,ma);if(yield this.$ok(wb))if(this.Sb.Rqk(this.sa.Aa.sid))this.Wyd(wb.trigger),this.lwd(()=>{this.kXc(v,S,ma)});else{var Sb=null!==(Va=null===(Ja=wb.HM)||void 0===Ja?void 0:Ja.Yrm)&&void 0!==Va?
Va:null;Q.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2} ReTriggerReason: {3}",wb.trigger,wb.sid,wb.correlationId,Sb);this.Sb.correlationId&&!this.Sb.bFb(this.Sb.correlationId)&&(id.a("DesignerLogRetriggerReason")?this.wnb(this.rz.Zp.lp.isVisible,wb.trigger,Sb):this.wnb(this.rz.Zp.lp.isVisible,wb.trigger));this.Sb.Izc=new Date;this.Sb.correlationId=wb.correlationId;this.Sb.r3d=wb.trigger;this.Sb.qR=this.udk(wb)?wb.HM[wf.a.RE]:new Date;wb.HM[wf.a.Rea]===wf.a.copilot&&(this.Sb.nec=
!0);v(wb);this.Wyd(wb.trigger);this.rz.sLa(wb.correlationId,xl.a.pending)}else Q.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",S),this.Co.zq(!1,Gh.a.S5f)})}kXc(v,S,ma){if(this.ka.designerAuthEnabled&&this.pN){this.Wyd(S);var Ja=new Date;this.pN.vH(this.ka.pptDesignerImplicitAuthAppName,this.ka.designerResourceUri).then(Va=>{const wb=+new Date-+Ja;Va.IsSuccess?(ma[wf.a.gmj]=wb,ma[wf.a.KNl]=Va.Token):(ma[wf.a.xbg]=wb,Q.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+
Va.ErrorCode+": "+Va.ErrorMessage));this.lce(v,S,ma)}).catch(Va=>{Q.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Va);ma[wf.a.xbg]=+new Date-+Ja;this.lce(v,S,ma)})}else this.lce(v,S,ma)}zgf(){return Object(wl.b)(this,void 0,void 0,function*(){if(this.ka.fVc&&this.ka.isCreateNew)if(0===(yield this.uOg.Lge()))Q.a.J(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.Wb){var v=this.sa.presentation;if(!v)throw Error.argumentNull("Presentation is null");
var S=this.Wb.YJ();if(!S||0>=S.length)Q.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var ma="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===S[0].ThemeFamilyId.toLowerCase();ma&&1!==S.length?Q.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.ka.wff||ma?!v.slides||0>=v.slides.length?Q.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):
ma&&1!==v.slides.length?Q.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(v=null,this.ka.iNl&&this.ka.a8&&0<this.ka.a8.length&&(v={},v.TemplateId=this.ka.a8),Q.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.xfa(lf.a.newDocument,v)):Q.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else Q.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");
else Q.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.ka.fVc,this.ka.isCreateNew)})}qUe(v,S){this.Sb.Xhm(S.F8b)}xZl(v,S,ma){const Ja=this.sa.Aa;if(!Ja)return!0;const Va=Ja.cid;return Ja.sid!=S||Va!=ma||!this.Co.isVisible&&!this.X6c(v)}jPj(){const v=document.querySelector("."+Je.vEa);return v&&(this.$p.HAb(v,!1)||this.$p.HAb(v,!0))?"Kept":"NotKept"}ykg(v){const S=new ca.a;if(v&&v.children)for(let ma=0;ma<v.children.length;ma++){const Ja=
v.children[ma].innerText;Ja&&0<Ja.length&&S.add(v.children[ma].innerText)}return S.toArray()}eIj(v){if(!v)return null;var S=v.ra(dm.a.klb,null);if(S)return S.replace("\r","\n").replace("\n\n","\n").split("\n");if(S=v.ra(dm.a.bW,null))if(S=this.fS.WLa(S))return this.ykg(S);if(S=v.ra(dm.a.iXe,null))if(v=this.fS.WLa(S))return this.ykg(v);return null}getName(){return"DesignerActor"}JZ(){}IZ(v){if(this.ka.tBa&&v.actionId===$a.a.fsd&&32===v.response){var S=this.gb.Hd();if(S&&1===S.length&&S[0].id&&(S=this.eIj(Object(N.a)(10,
v.Bd)))&&!(0>=S.length)){var ma={};ma[wf.a.efl]=S;this.Dme(v.actionId,ma)}}}Haj(v){switch(v){case wf.a.a6h:return this.ka.Yfj;default:return!1}}eVj(){this.Co.zq(!0,Gh.a.none);this.xfa(lf.a.$6d);this.Zp.G3a(3)}lcm(v){switch(v){case wf.a.a6h:this.mcm()}}mcm(){if(this.ka.$hl)try{const v=C.a.instance.Ha("Common.ISystemInitiatedFeedback");v&&(Q.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),v.execute(S=>{S.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(v){Q.a.J(512496524,
829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",v)}}g6k(){this.ka.xff&&(this.Co.isVisible||this.$Og||(this.Co.zq(!0,Gh.a.none),this.xfa(lf.a.L_d),this.Zp.G3a(3),Q.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),this.$Og=!0)}static ule(){const v=document.querySelector("."+Je.vEa);return v&&v.getAttribute(Je.Pwb)?v.getAttribute(Je.Pwb).toString():null}}Object(k.a)(mh,"DesignerActor",null,[182]);var ao=d(553),Al=d(716);class mo{constructor(v){this.bucketId=
v;this.critiques=[]}}Object(k.a)(mo,"BucketedEditorData",null,[]);class bo{constructor(v){this.r3d=this.correlationId=this.jZa=this.fNg=null;this.IDb=this.lYa=this.lV=!1;this.MAc=this.Bef=null;this.yCg=!1;this.mTa=this.suggestions=this.XUb=this.i3b=this.qR=this.MSa=this.Rpc=this.Lia=this.Izc=null;this.LO=0;this.nec=this.Nbf=this.zQe=this.Uld=this.U7f=this.lWc=this.mWc=!1;this.QCe=[];this.COe=[];this.hjc=v;this.x0=P.a.empty;this.J3b=new ca.a;this.lTa=new ca.a;this.rua=new ca.a;this.B4c=new ca.a;this.tha=
new ca.a;this.V4b=1}bWk(){this.e3a(0,0)}aWk(){this.e3a(1,0)}JQe(){this.e3a(2,4)}e3a(v,S){this.hjc&&this.hjc.execute(ma=>{const Ja=Object.assign(new Al.a,{cardId:ao.a.bTh,actionType:v,actionEngagement:S});ma.Lnd(Ja)})}KJf(v,S){this.bFb(v)||(Array.add(this.QCe,v),Q.a.J(509112540,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",v,this.QCe.length));this.J4e(!S)}bFb(v){return Array.contains(this.QCe,v)}lWk(v){Array.add(this.COe,v)}dAl(v){Array.remove(this.COe,
v)}Rqk(v){return Array.contains(this.COe,v)}get o6d(){return this.jZa}BZi(){if(this.jZa)return!0;try{const v=C.a.instance.ub("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(v)return this.jZa=v,!0}catch(v){Q.a.J(509112539,829,15,"error resolving consistencyCheckActor. ex: {0}",v)}return!1}Xhm(v){if(v){var S=[],ma=new Qb.a;for(const Ja of v.critiques){v=Ja.bucketId;let Va=ma.ga(v);Va||(Va=new mo(v),ma.$(v,Va),S.push(Va));Va.critiques.push(Ja)}this.fNg=S}}get RX(){return this.fNg}J4e(v){this.correlationId=
"";this.x0=P.a.empty;this.r3d="";this.IDb=this.lYa=this.lV=!1;this.MAc=null;this.yCg=!1;this.MSa=this.Rpc=this.Lia=this.Izc=null;this.J3b.clear();this.XUb=this.i3b=this.qR=null;this.V4b=1;this.lTa.clear();this.rua.clear();this.B4c.clear();this.tha.clear();this.LO=0;this.nec=this.Nbf=this.mWc=this.lWc=this.Uld=this.zQe=!1;v&&(this.suggestions=this.mTa=null)}}Object(k.a)(bo,"DesignerContext",null,[1164]);class Dm{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;
this.SlideSuggestions=null}}Object(k.a)(Dm,"DesignerSuggestions",null,[]);var Xk;(function(v){v[v.init=0]="init";v[v.loading=1]="loading";v[v.noSuggestion=2]="noSuggestion";v[v.showSuggestion=3]="showSuggestion";v[v.refreshing=4]="refreshing";v[v.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";v[v.makeItVisualDrillIn=6]="makeItVisualDrillIn";v[v.loadingMoreIdeas=7]="loadingMoreIdeas";v[v.moreIdeas=8]="moreIdeas";v[v.noSuggestionRibbon=9]="noSuggestionRibbon"})(Xk||(Xk={}));Object(k.b)("DesignerViewState",
Xk);class Yk{constructor(){this.suggestions=[]}}Object(k.a)(Yk,"SlideSuggestionNotificationData",null,[]);var Em=d(261),tp=d(399);class Tl{constructor(v,S,ma){this.Fsb=this.VB=!1;v&&(this.W5=v,this.W5.isFeatureEnabled("PowerPointDesigner",!1).then(Ja=>{(this.VB=Ja)?Q.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.Fsb=this.W5.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?ma?Q.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):
Q.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):Q.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.HQk=this.W5.OMa("PowerPointDesigner",Object(r.a)(this,this.Yzb,"featureStateChangeCallback")),this.XNk=S)}Nua(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.W5&&(this.W5.s2a("PowerPointDesigner",this.HQk),this.W5=null)}get isEnabled(){return this.VB}get isFreemiumUpsellEnabled(){return this.Fsb}launchUpsellExperience(v){this.W5&&
this.W5.launchUpsellExperience(v)}Yzb(v){v&&"PowerPointDesigner"===v.featureName&&(!this.isEnabled&&v.isEnabled&&this.XNk(),this.VB=v.isEnabled)}}Object(k.a)(Tl,"DesignerStateManager",null,[]);class Vp{constructor(v,S,ma){this.MSk=v;this.PC=S;this.iSk=ma}toString(){return"SuggestionIndex:"+this.MSk+" SlideId:"+this.PC+" CreationId:"+this.iSk}}Object(k.a)(Vp,"LoggableSourceContext",null,[]);var up=d(1211),Wo=d(984),hn=d(552);class ej{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If){this.Kkc=this.fpa=
!1;this.fQe=0;this.vm=this.NGb=null;this.ua=new xd.a;this.Zdb=yh=>{!this.isVisible||yh.keyCode!==da.a.Mp&&yh.keyCode!==da.a.fO||this.zq(!1,Gh.a.Nz)};this.LEa=()=>{this.isVisible&&(Q.a.J(509089857,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Sb.correlationId),this.zq(!1,Gh.a.NSb));return!0};this.fpa=id.a("SvgCloseButton");this.Db=v;this.te=S;this.hd=ma;this.Rs=Ja;this.ia=Va;this.Sb=wb;this.YG=Sb;this.Nc=vc;this.oA=gd;this.rc=od;this.Fa=
Vd;this.ka=Ke;this.Iw=kg;this.aH=Gi.kdc;this.jOk=ResourceStrings.L_Designer;this.MI=If;this.wb=document.createElement("div");this.wb.className=ah.a.zaj;this.wb.id=Gi.kdc;this.wb.style.position=ic.a.Iia;this.wb.setAttribute(na.a.Ff,na.a.mEa);this.wb.setAttribute(na.a.E4,ah.a.j$d);this.Mb=!1;this.ixa=ub.a.we();this.ixa.className="DesignerPaneLayoutRoot";this.fpa&&(this.ixa.style.display=ic.a.q3);this.wb.appendChild(this.ixa);v=w.AFrameworkApplication.fa.Ea("PPTFabricIconDiamondCssUrl");S=document.createElement("link");
S.setAttribute("rel","stylesheet");S.setAttribute("type","text/css");S.setAttribute("href",v);this.wb.appendChild(S);this.Db.cEa(Object(r.a)(this,this.iQ,"onSetOffline"))}dispose(){this.K4();this.wb.removeChild(this.ixa);this.Db.Cmb(Object(r.a)(this,this.iQ,"onSetOffline"));Q.a.J(509089863,829,50,"DesignerPane::Dispose")}initialize(){this.fpa||(this.vm=ej.hab(this.te),Sys.UI.DomElement.addCssClass(this.vm,"DesignerPaneCloseButton"),this.vm.setAttribute(na.a.Ff,na.a.jx),this.ixa.appendChild(this.vm));
this.NGb=ub.a.we();this.NGb.id=ah.a.j$d;this.NGb.className=ah.a.j$d;this.NGb.innerText=this.jOk;this.ixa.appendChild(this.NGb);this.fpa&&(this.vm=ej.xTc(),Sys.UI.DomElement.addCssClass(this.vm,"DesignerPaneCloseButtonNew"),this.ixa.appendChild(this.vm));this.hd.xb(Ha.a.click,this.vm,this.LEa);this.Rs.addHandler(this.vm,Ha.a.Vf,this.Zdb);this.YG.Lfa(this.tjg(),dd.a.Nj,this.wb,v=>{v===this.Fa.Kc(dd.a.qT)&&this.vm?this.FB(!0):this.p7(!0)},()=>{this.p7(!1)});this.Nc.eea(Object(r.a)(this,this.Bz,"onUnifiedAppStateChanged"));
this.Nc.bC(Object(r.a)(this,this.Kba,"onPodSessionRehydrated"));this.oA.xvb(Object(r.a)(this,this.Kba,"onPodSessionRehydrated"));Q.a.J(509089862,829,50,"DesignerPane::Initialize")}tjg(){return dd.a.U9}K4(){this.hd&&0<this.ixa.childNodes.length&&(this.hd.Hb(Ha.a.click,this.vm,this.LEa),this.Rs.removeHandler(this.vm,Ha.a.Vf,this.Zdb),this.ixa.removeChild(this.NGb),this.ixa.removeChild(this.vm));this.Nc.Hmb(Object(r.a)(this,this.Bz,"onUnifiedAppStateChanged"));this.Nc.Wba(Object(r.a)(this,this.Kba,"onPodSessionRehydrated"));
this.oA.Fmb(Object(r.a)(this,this.Kba,"onPodSessionRehydrated"));this.Fa.Je&&this.Fa.Je.name===dd.a.U9&&this.Fa.qk(dd.a.U9,!1)}Bz(v,S){S.veb&&!this.rc.fp&&this.isVisible&&(Q.a.J(509089861,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Sb.correlationId),this.zq(!1,Gh.a.NSb))}iQ(v){v&&this.isVisible&&this.zq(!1,Gh.a.NSb)}Kba(){Q.a.J(509089860,801,50,"Designer Pane is closed because session is rehydrated.");this.zq(!1,
Gh.a.VNl)}layout(v,S){const ma=S?v.nL(this.width):v.oL(this.width);this.isVisible&&(S?(Sys.UI.DomElement.addCssClass(this.wb,ah.a.O4f),ma.nL(ah.a.i$d)):(Sys.UI.DomElement.addCssClass(this.wb,ah.a.N4f),ma.oL(ah.a.i$d)));ub.a.jca(this.wb,ma);return v}zq(v,S){if(this.Mb!==v){this.Mb=v;var ma=this.ka.K4f||this.id!==Gi.kdc?wf.a.Acl:Gi.p6j;v?(S={},S[ma]=!0,this.Iw.iCd(Ab.c(S)),this.initialize(),this.wb.style.display=ic.a.q3,this.Sb.bWk(),Q.a.J(509089859,829,50,"DesignerPane::SetIsVisible - Set to visible")):
(v={},v[ma]=!1,this.Iw.iCd(Ab.c(v)),this.K4(),this.wb.style.display=ic.a.kf,this.u2l(S)||(this.Sb.MAc=new Date,1===this.fQe&&(this.Sb.IDb=!0),this.ia.Ia($a.a.Aqa,2,new hn.a(!0,S))),this.Sb.aWk(),Q.a.J(509089858,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.JYd(this.wb);ma=ResourceStrings.L_Designer;this.MI.uQ(this,this.Mb,this.id===Gi.kdc?ma:ResourceStrings.L_ShowHideDesignerPane,this.tjg());this.Mb&&this.Sb.nec&&id.a("DesignerFocusChatPPT")&&this.ia.nb($a.a.BEa,2,null)}}JYd(v){w.AFrameworkApplication.isRtl?
Sys.UI.DomElement.addCssClass(v,ah.a.O4f):Sys.UI.DomElement.addCssClass(v,ah.a.N4f)}u2l(v){return v===Gh.a.TXf||this.isVisible&&v===Gh.a.NSb}p7(v){v?this.ua.raiseEvent("OnDesignerPaneFocusOn"):this.ua.raiseEvent("OnDesignerPaneFocusBlur")}KLf(v){this.ua.addHandler("OnDesignerPaneFocusOn",v)}UDh(v){this.ua.removeHandler("OnDesignerPaneFocusOn",v)}LLf(v){this.ua.addHandler("OnDesignerPaneFocusBlur",v)}VDh(v){this.ua.removeHandler("OnDesignerPaneFocusBlur",v)}FB(v){(this.Kkc=v)&&this.vm.focus()}get Tca(){return this.fQe}set Tca(v){this.fQe=
v}Onb(v){this.setFocus("#"+this.id+" ."+Wd.Chh+":nth-child("+v+") > ."+Wd.jLb)}OPl(){this.setFocus("#"+Wd.Vab)}NPl(){this.setFocus("#"+Wd.qzb)}Ayd(v){this.setFocus("."+Wd.GUa+"["+Gi.FUa+'="'+v+'"')}LPl(){this.setFocus("."+Wd.C8b)}MPl(){this.setFocus("."+Wd.G8b)}setFocus(v){(v=document.querySelector(v))&&Jb.FocusManager.dr(v)}get isVisible(){return this.Mb}get CXa(){return this.Kkc}get va(){return this.wb}get order(){return 7}get id(){return this.aH}get width(){let v=0;this.isVisible&&(v=ah.a.Aaj,
v+=ah.a.i$d+Yc.a.kNa);return v}static hab(v){return ej.OTa(v,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static xTc(){const v=document.createElement(ub.a.k$a);v.type="button";v.setAttribute(na.a.Rp,CommonUIStrings.l_DialogClose);v.appendChild(Object(Rc.b)(Rc.a,20,20).va);v.className="SvgCloseButton";return v}static OTa(v,S,ma,Ja,Va,wb,Sb){const vc=ub.a.DD();vc.alt=wb;vc.className=Aa.getImageClassWithCluster(S,Va);vc.src=v.Ok(S+".png");
vc.setAttribute("Unselectable","on");v=ub.a.En();v.className=ma+" cui-img-cont-float";v.appendChild(vc);ma=ub.a.En();ma.className=Ja;ma.setAttribute("Unselectable","on");ma.appendChild(v);Ja=ub.a.zla();Ja.className="cui-ctl DesignerPaneButton";Ja.title=wb;Ja.setAttribute(na.a.Ff,na.a.jx);Ja.tabIndex=0;Ja.appendChild(ma);Sb&&(wb=ub.a.En(),wb.className="cui-ctl-mediumlabel",wb.setAttribute("Unselectable","on"),wb.innerText=Sb,Ja.appendChild(wb));return Ja}}Object(k.a)(ej,"DesignerPane",null,[1160,180,
106]);class Ge{constructor(v,S,ma,Ja,Va,wb){this.fpa=!1;this.Vkd=this.vic=this.VIb=this.hp=null;this.WIe=this.Pec=!1;this.LOe=null;this.fpa=id.a("SvgCloseButton");this.ka=S;this.ia=v;this.YNk=wb;this.hd=Ja;this.Rs=Va;this.bRg=jb.KeyInputManager.Va(da.a.GBa,0);this.ia.xa($a.a.h4h,E.a.frame,Object(r.a)(this,this.eVi,"closeCallout"));this.cS=ub.a.we();this.cS.className="GoPremiumCalloutContainer";v=document.createElement("i");v.className=Je.HQc+" GoPremiumIcon";v.setAttribute(na.a.Ff,na.a.gR);v.setAttribute("Unselectable",
"on");v.setAttribute(na.a.JJ,na.a.cC);this.fpa?(ma=document.createElement("div"),ma.className="GoPremiumHeader",ma.appendChild(v),this.Ywa=ej.xTc(),Sys.UI.DomElement.addCssClass(this.Ywa,"GoPremiumCalloutCloseNew"),ma.appendChild(this.Ywa),this.cS.appendChild(ma)):(this.Ywa=ej.hab(ma),Sys.UI.DomElement.addCssClass(this.Ywa,"GoPremiumCalloutClose"),this.Ywa.setAttribute(na.a.Ff,na.a.jx),this.cS.appendChild(this.Ywa),this.cS.appendChild(v));this.Fya=ub.a.we();this.Fya.className="GoPremiumTitle";this.cS.appendChild(this.Fya);
this.vV=ub.a.we();this.vV.className="GoPremiumSubtitle";this.cS.appendChild(this.vV);this.ioa=ub.a.we();this.ioa.className="GoPremiumButton";ma=ub.a.En();ma.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ma.setAttribute("Unselectable","on");ma.setAttribute(na.a.JJ,na.a.cC);this.ioa.appendChild(ma);this.ioa.tabIndex=0;this.ioa.setAttribute(na.a.Rp,ma.innerText);this.ioa.setAttribute(na.a.Ff,na.a.jx);this.cS.appendChild(this.ioa);this.ps()}show(v,S,ma,Ja,Va,wb){this.MM&&this.dismiss();this.VIb=
Ja;this.vic=S;this.Vkd=Va;this.LOe=wb;this.VIb&&Sys.UI.DomElement.addCssClass(this.VIb,this.Vkd);ma?(this.Fya.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.vV.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.Fya.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.vV.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);S.setAttribute(na.a.P9a,na.a.cC);this.ka.z8f?this.hp=new Wo.a(v,document.body,w.AFrameworkApplication.za.sT,null):(this.hp=up.a.X7d(v,
document.body,document.body,2,Object(r.a)(this,this.dismiss,"dismiss")),this.hp.Def=120);this.hp.Uca=310;this.cS.setAttribute(na.a.Rp,String.format("{0}. {1}",this.Fya.innerText,this.vV.innerText));this.cS.setAttribute(na.a.Ff,na.a.mEa);this.Rs&&this.Rs.addHandler(this.cS,Ha.a.Vf,Object(r.a)(this,this.Zdb,"inputKeyPressHandler"));this.hp.content=this.cS;this.Jka();S=new Sys.UI.Bounds(0,0,la.a.Mbc(),la.a.Lbc());this.hp.B0=this.lge(S,v,240,ma);this.hp.Is=!1;this.hp.Zpd=()=>{this.cS.parentNode&&Sys.UI.DomElement.addCssClass(this.cS.parentNode,
"GoPremiumCalloutContentContainer");this.hp.ZK&&(Sys.UI.DomElement.addCssClass(this.hp.ZK,"GoPremiumCalloutOuter"),this.hp.ZK.removeAttribute(na.a.Ff),this.ka.z8f||(this.hp.ZK.style.zIndex=String(w.AFrameworkApplication.za.evb)));this.hp.E8e();this.eT(this.ioa);this.Pec=!0};this.hp.show()}Jka(){if(Jb.FocusManager.eO()){var v=Jb.FocusManager.instance(),S=v.Kc("callout/modal");S.parent=dd.a.Nj;v.YYd("callout/modal",dd.a.Nj,this.cS);v.dW("callout/modal",!1);S.bindAction(this.bRg,$a.a.h4h);S=new ne.DOMFocusListing(()=>
this.cS);S.wmb=!0;S.xp(2);v=v.hla(()=>this.cS,v.Kc("callout/modal"),S);v.xmb();v.IY=!0;v.HTa=!0}}Amb(){if(Jb.FocusManager.eO()&&!w.AFrameworkApplication.Dh){const S=Jb.FocusManager.instance();var v=S.Kc("callout/modal");v&&v.Sy(this.bRg);S.P2("callout/modal");(v=S.DR("callout/modal"))&&v.jk.bG(null);S.rPb("callout/modal")}}eT(v){Jb.FocusManager.eO()?Jb.FocusManager.instance().DR("callout/modal").jk.Hbb(v):v.focus()}get MM(){return!!this.hp&&this.hp.MM}L_j(){this.MM&&(this.Pec?this.Ywa.focus():this.ioa.focus(),
this.Pec=!this.Pec)}d6f(){this.dismiss();return!0}eVi(){this.dismiss();return 32}dismiss(){if(!this.WIe){this.WIe=!0;try{this.Amb(),this.vic&&(this.vic.setAttribute(na.a.P9a,na.a.Xka),Jb.FocusManager.dr(this.vic),this.vic=null),this.VIb&&(Sys.UI.DomElement.removeCssClass(this.VIb,this.Vkd),this.VIb=null),this.LOe=this.Vkd=null,this.Pec=!1,this.hp&&(this.hp.dismiss(),this.hp.dispose(),this.hp=null),this.Rs&&this.Rs.removeHandler(this.cS,Ha.a.Vf,Object(r.a)(this,this.Zdb,"inputKeyPressHandler"))}finally{this.WIe=
!1}}}dispose(){this.dismiss();this.Jca();this.cS=this.Ywa=this.ioa=null}Zdb(v){if(v.keyCode===da.a.Mp||v.keyCode===da.a.fO){v.preventDefault();v=document.activeElement;try{v?v.click():Q.a.J(508372757,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(S){Q.a.J(508372756,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",S)}}}gnh(){this.YNk(this.LOe);return!0}ps(){this.hd?(this.hd.xb(Ha.a.click,this.Ywa,Object(r.a)(this,this.d6f,"dismissAndReturn")),
this.hd.xb(Ha.a.click,this.ioa,Object(r.a)(this,this.gnh,"onGoPremiumClicked"))):Q.a.J(508372755,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}Jca(){this.hd&&(this.hd.Hb(Ha.a.click,this.Ywa,Object(r.a)(this,this.d6f,"dismissAndReturn")),this.hd.Hb(Ha.a.click,this.ioa,Object(r.a)(this,this.gnh,"onGoPremiumClicked")))}lge(v,S,ma,Ja){if(Ja)return 0;Ja=6;S.y-v.y<ma&&(Ja=3);return Ja}}Object(k.a)(Ge,"PremiumContentCallout",
null,[]);class Mi{constructor(v,S,ma,Ja,Va,wb,Sb,vc){this.Ryb=v;this.Pjj=S;this.qXc=ma;this.ii=Ja;this.Kia=Va;this.Abb=wb;this.Caf=Sb;this.DFd=vc}}Object(k.a)(Mi,"RenderSuggestionsArgs",null,[1496]);class pd extends Sys.EventArgs{constructor(v){super();this.card=v}}Object(k.a)(pd,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class ek extends Sys.EventArgs{constructor(v){super();this.Y9c=v}}Object(k.a)(ek,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class dh extends Sys.EventArgs{constructor(v,
S){super();this.TLl=v;this.a7l=S}}Object(k.a)(dh,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class co extends Em.a{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If){super(new tp.a,v,wb);this.Agb=this.Bgb=this.cN=this.Q1=this.gjc=this.UY=null;this.nTg=this.sTg=0;this.noa=!1;this.Gdh=this.SJa=this.Jx=null;this.Co=ma;this.$p=Ja;this.Sb=Va;this.Fa=Sb;this.hd=vc;this.te=S;this.Ts=gd;this.Rs=od;this.ia=Vd;this.ue=Ke;this.ka=kg;this.y4h=this.ka.useWideSuggestionThumbs;this.wS=new Ie.a(()=>new Ge(this.ia,
this.ka,S,vc,od,Object(r.a)(this,this.frg,"goPremiumExperience")));this.EPg=new Tl(If,Object(r.a)(this,this.$1k,"onAccountUpgrade"),kg.rUa);this.GK=new Hk;this.CKk=Object.assign(new sc(Vd,this.GK,this.ka),{xx:$a.a.deb})}dispose(){this.noa&&this.OWf();this.Jx&&(this.Jx.dispose(),this.Jx=null);this.wS.Cdb&&this.wS.value.dispose();super.dispose();Q.a.J(512496477,829,50,"DesignerView::Dispose")}Ddc(){this.UY=ub.a.we();this.UY.className="DesignerViewContainer";this.container.appendChild(this.UY);this.noa=
!0;Q.a.J(512496476,829,50,"DesignerView::InitializeView")}OWf(){this.ka.xWc&&this.$p.tTi();if(this.UY.children&&0<this.UY.children.length)for(const v=0;v<this.UY.children.length;)this.UY.removeChild(this.UY.children[v]);this.Co.Tca=0;this.Co.UDh(Object(r.a)(this,this.onFocus,"onFocus"));this.Co.VDh(Object(r.a)(this,this.Zmh,"onFocusBlur"));this.wS.Cdb&&this.wS.value.dismiss();Q.a.J(512496475,829,50,"DesignerView::CleanUpView")}G3a(v){Q.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",
this.Sb.correlationId,Xk[v]);this.DO();4!==v&&7!==v&&8!==v&&(this.OWf(),this.UY.id=this.Sb.correlationId);this.Co.Tca=v;switch(this.Co.Tca){case 1:this.O8j();this.yUl();break;case 7:this.xUl();break;case 2:this.V8j();break;case 9:this.U8j();break;case 5:this.g9j();break;case 3:this.l9j();break;case 6:this.P8j();break;case 4:if(v=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let S=0;S<v.length;S++)v[S].style.visibility=bc.a.visible,v[S].setAttribute(Je.o3d,Je.xTf)}this.Co.KLf(Object(r.a)(this,
this.onFocus,"onFocus"));this.Co.LLf(Object(r.a)(this,this.Zmh,"onFocusBlur"))}Nua(){return this.ka.R4f&&this.EPg.Nua()}frg(v){this.ka.R4f&&(Q.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",v?v.toString():""),this.wS.Cdb&&this.wS.value.dismiss(),this.EPg.launchUpsellExperience(this.ka.rUa?"designertrial":"designer"))}startFreeTrial(){this.wS.Cdb&&this.wS.value.dismiss();this.$p.Jbm();this.Sb.Nbf=!0;this.Ux(0,!0);Q.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}$1k(){Q.a.J(512496471,
829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.wS.Cdb&&this.wS.value.dismiss();this.$p.ugm()}O8j(){this.gjc=ub.a.we();this.gjc.className="DesignerLoadingView";const v=ub.a.DD();v.className=w.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";v.src=Eb.a.GO(ah.a.iqa);const S=ub.a.we();S.className=w.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";S.innerText=ResourceStrings.L_DesignerLoading;this.gjc.appendChild(v);
Q.a.J(512496470,829,50,"DesignerView::spinner shows up");this.gjc.appendChild(S);this.UY.appendChild(this.gjc);Q.a.J(512496469,829,50,"DesignerView::InitLoadingState")}W8j(){const v=ub.a.we();v.className="DesignerNoSuggestionNewButton";v.tabIndex=0;v.innerText=ResourceStrings.L_DesignerLearnMoreShort;v.setAttribute("Unselectable","on");v.setAttribute(na.a.Rp,v.innerText);v.setAttribute(na.a.Ff,na.a.jx);v.setAttribute("href",ah.a.M4f);this.hd.xb(Ha.a.click,v,Object(r.a)(this,this.BXf,"clickSuggestionLinkHandler"));
this.Q1.appendChild(v)}T8j(){const v=ub.a.zla();v.className="DesignerNoSuggestionView-Link";v.setAttribute("href",ah.a.M4f);v.setAttribute("target","_blank");v.innerText=ResourceStrings.L_DesignerLearnMore;v.tabIndex=0;v.setAttribute(na.a.Ff,na.a.g1d);this.Q1.appendChild(v);this.hd.xb(Ha.a.click,v,Object(r.a)(this,this.BXf,"clickSuggestionLinkHandler"))}V8j(){this.Co.isVisible&&(this.Epe(!1),this.Bgb.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.Agb.innerText=ResourceStrings.L_DesignerNoSuggestionContent,
Q.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}U8j(){this.Co.isVisible&&(this.Epe(!0),this.Bgb.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.Agb.innerText=ResourceStrings.L_DesignerNoIdeas,Q.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}g9j(){this.Co.isVisible&&(this.Epe(!1),this.Bgb.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.Agb.innerText=ResourceStrings.L_DesignerCoauthorContent,Q.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}Epe(v){this.Q1=
ub.a.we();this.Q1.className=w.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.Bgb=ub.a.we();this.Agb=ub.a.we();this.$p.IEh(this.UY);if(v){this.Bgb.className="DesignerNoSuggestionNew-Header";this.Agb.className="DesignerNoSuggestionNew-Content";const S=ub.a.DD();S.src=this.te.Ok("DesignerNoIdeas.svg");S.className="DesignerNoIdeasIllustration";this.Q1.appendChild(S)}else this.Bgb.className="DesignerNoSuggestionView-Header",this.Agb.className="DesignerNoSuggestionView-Content";
this.Q1.appendChild(this.Bgb);this.Q1.appendChild(this.Agb);v?this.W8j():this.T8j();this.UY.appendChild(this.Q1);this.Rs.addHandler(this.Q1,Ha.a.Vf,Object(r.a)(this,this.Zdb,"inputKeyPressHandler"))}l9j(){this.Co.isVisible||this.Co.zq(!0,Gh.a.none);this.cN=ub.a.we();const v=this.y4h?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",S=this.y4h?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.cN.className=w.AFrameworkApplication.isRtl?S:v;this.UY.appendChild(this.cN);
this.ka.P4f||(this.Fa.qk(dd.a.U9,!0),this.Fa.Gd());this.hd.xb(Ha.a.click,this.cN,Object(r.a)(this,this.GUi,"clickSuggestionHandler"));this.Rs.addHandler(this.cN,Ha.a.Vf,Object(r.a)(this,this.V4c,"inputKeyApplyHandler"));this.Ts.xb(Ha.a.aD,this.cN,Object(r.a)(this,this.FN,"onPointerOver"));this.Ts.xb(Ha.a.qE,this.cN,Object(r.a)(this,this.hH,"onPointerOut"));Q.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}tLj(){return this.ubc(this.cN.querySelector("#"+this.lp.id+" .DesignerSuggestionResultSelected"))}CCj(){return this.ubc(this.cN.querySelector("#"+
this.lp.id+" ["+Je.p$a+"]:hover"))}ubc(v){let S;return({suggestionIndex:S}=this.rpg(v)).returnValue?parseInt(S):-1}rpg(v){let S,ma,Ja;Ja=ma=S="";if(v){const Va=v.getAttribute(Je.wEa),wb=v.getAttribute(Je.p$a);if(!Va||!wb)return Q.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Sb.correlationId),{returnValue:!1,suggestionIndex:S,slideId:ma,Waf:Ja};S=Va.toString();ma=wb.toString();(v=v.getAttribute(Je.MQc))?Ja=
v.toString():Q.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Sb.correlationId);return{returnValue:!0,suggestionIndex:S,slideId:ma,Waf:Ja}}return{returnValue:!1,suggestionIndex:S,slideId:ma,Waf:Ja}}vbc(){return this.cN.querySelectorAll("#"+this.lp.id+" ["+Je.wEa+"]").length}BXf(v){return this.Co.isVisible&&v&&v.hC?this.srg(v.hC.className):!1}ufa(){const v=this.ka.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":
"DesignerShowSuggestionView",S=this.ka.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(w.AFrameworkApplication.isRtl?S:v))}FUi(v){v=v.getAttribute(Je.wEa).toString();v=this.Sb.mTa[parseInt(v)];if(!v||3!==v.Type&&4!==v.Type)return!1;this.ue.jpl(new pd(v));return!0}jYc(v,S){for(;v&&v.className!==S;)v=v.parentNode;return v}GUi(v){if(!this.Co.isVisible||v.xB!==Sys.UI.MouseButton.leftButton||!this.$p.Aa||!v.Ec)return!1;var S=
v.Ec;try{if(S.className){if(S.className===Wd.jLb||S.className===Wd.kLb||S.className===Wd.pRe||S.className===Wd.Hmd)return this.EUi(S);if(S.className.startsWith(Wd.b8f))return this.DUi(S)}else Q.a.J(512496462,829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(Vd){return Q.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",S.className,Vd.message),!1}if(v=this.jYc(S,Je.JTf))return this.FUi(v);if(this.Nua()){if(S.className===Je.Qwb)return this.startFreeTrial(),
!0;if(S.className===Je.E4b)return v=Cd.a.wi(S),this.wS.value.show(v,S,!0,S,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(v=this.jYc(S,Je.D4b))||(v=this.jYc(S,Je.AQc));if(v)return this.frg(null),!0}if(this.ka.Nla&&(v=this.jYc(S,Je.j3d))){this.$p.W3c(this.ufa());if(!v.getAttribute(Je.Pwb))return!1;this.$p.Q0l(this.ufa());v=new ek(v.getAttribute(Je.Pwb).toString());this.ue.xpl(v);return!0}if(Sys.UI.DomElement.containsCssClass(S,"ms-Icon--Diamond")){if(S=S.parentNode,!S)return!1}else if(!(Sys.UI.DomElement.containsCssClass(S,
Je.LQc)||Sys.UI.DomElement.containsCssClass(S,Je.H4b)||Sys.UI.DomElement.containsCssClass(S,Je.NQc)||(S=S.firstChild,S)))return!1;v=S.parentNode;var ma=document.querySelector("#"+this.lp.id+" ."+Je.vEa);if(!({suggestionIndex:vc,slideId:gd,Waf:od}=this.rpg(v)).returnValue)return!1;var Ja=parseInt(vc),Va=parseInt(gd);const wb=parseInt(od)||0;let Sb=this.Sb.x0.sid===Va;this.ka.Nla&&(Sb=this.$p.HAb(ma,!1)===v||this.$p.HAb(ma,!0)===v);if(Sb)return Q.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),
this.ue.bzh(new dh(Ja,this.vbc())),!1;if(v&&v.getAttribute(Je.DQc)){S=null;ma=v.childNodes;for(Ja=0;Ja<ma.length;Ja++)if(Va=ma[Ja],Sys.UI.DomElement.containsCssClass(Va,Je.LQc)){S=Va;break}ma=new Vp(vc,gd,od);S=Cd.a.wi(S||v);this.wS.value.show(S,v,!1,null,null,ma);return!1}if(Sys.UI.DomElement.containsCssClass(S,Je.NQc))return!1;var vc=this.SKj(S,Va,wb);var gd=Object.assign(new tg,{SuggestionCid:wb,SuggestionSid:Va,CorrelationId:ma.getAttribute("correlationId").toString(),ActiveSlideCid:this.$p.Aa.cid,
ActiveSlideSid:this.$p.Aa.sid});var od=S;od=.01>=Math.abs(od.width/od.height-1.33);this.$p.HAb(ma,od)?(this.$p.NWf(ma,od),vc&&vc.parentNode&&vc.parentNode.parentNode&&this.$p.NWf(vc.parentNode.parentNode,od),this.ia.Ia($a.a.Xvb,2,gd),Q.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.Ia($a.a.y9,2,gd),Q.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.ka.waj&&v&&v.getAttribute(Je.Z2d)&&C.a.instance.Ha("Common.ISystemInitiatedFeedback").execute(Vd=>
{try{Vd.logActivity("DesignerAnimationSuggestion",null)}catch(Ke){Q.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",Ke)}});this.$p.lLh(S.parentNode,od);vc&&this.$p.lLh(vc.parentNode,od);this.$p.JJh(this.UY,Ja);this.ue.bzh(new dh(Ja,this.vbc()));return!0}SKj(v,S,ma){var Ja="["+Je.p$a+'="'+S+'"] > .'+Je.H4b;ma&&(Ja=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',Je.p$a,S,Je.MQc,ma,Je.H4b));S=document.querySelectorAll(Ja);if(!S)return null;for(ma=0;ma<S.length;ma++)if(Ja=
S[ma],Ja!==v)return Ja;return null}Zdb(v){this.Co.isVisible&&(v.keyCode!==da.a.Mp&&v.keyCode!==da.a.fO||this.srg(v.target.className))}V4c(v){!this.Co.isVisible||v.keyCode!==da.a.Mp&&v.keyCode!==da.a.fO||(v.preventDefault(),(v=document.activeElement)&&v.click())}Ux(v,S){if(!(0>v)){var ma=this.cN.querySelector("["+Je.wEa+'="'+v+'"]');ma?S&&(Jb.FocusManager.dr(ma),this.$p.JJh(this.UY,v)):Q.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",v)}}uqg(){return this.Nua()?
this.cN.querySelector("."+Je.E4b)?2:this.cN.querySelector("."+Je.Qwb)?1:this.cN.querySelector("."+Je.D4b)?3:0:0}MFg(){return!!this.cN.querySelector("."+Je.Qwb+":focus")}Oxc(v){const S=this.cN.querySelector("."+Je.Qwb);S?v?Jb.FocusManager.dr(S):S.blur():Q.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}Gtg(){this.QGg()&&this.wS.value.L_j()}QGg(){return this.wS.Cdb&&this.wS.value.MM}Psk(v){return v?!!v&&(v.className===Je.Qwb||v.className===Je.AQc||
v.className===Je.E4b||v.className===Je.D4b):!1}Qqa(v,S){let ma=null;1===S?ma=this.cN.querySelector("."+Je.AQc):2===S?ma=this.cN.querySelector("."+Je.E4b):3===S&&(ma=this.cN.querySelector("."+Je.D4b));ma?v?Jb.FocusManager.dr(ma):ma.blur():Q.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",S)}$Tl(v,S){(S=9===S?this.Q1.querySelector(".DesignerNoSuggestionNewButton"):this.Q1.querySelector(".DesignerNoSuggestionView-Link"))?v?S.focus():
S.blur():Q.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}irk(v){return!(9===v?!this.Q1.querySelector(".DesignerNoSuggestionNewButton:focus"):!this.Q1.querySelector(".DesignerNoSuggestionView-Link:focus"))}srg(v){try{const S=this.Q1.querySelector("."+v);if(!S)return!1;const ma=S.getAttribute("href").toString();if(!ma)return!1;Cd.a.openWindow(4,ma);return!0}catch(S){return Q.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",S),!1}}Zmh(){this.Co.isVisible&&
this.wS.Cdb&&this.wS.value.MM&&this.wS.value.dismiss()}onFocus(){if(this.Co.isVisible)if(2===this.Co.Tca)Jb.FocusManager.dr(this.Q1.lastChild);else if(3===this.Co.Tca){var v=this.uqg();if(1===v)this.Oxc(!0);else if(3===v)this.Qqa(!0,v);else{v=this.tLj();var S=this.CCj();-1===v?this.Ux(-1===S?0:S,!0):this.Ux(v,!0)}}}FN(v){return this.Co.isVisible&&v.Ec?this.a8f(v.clientPoint):!1}nEi(v){var S;if(v){var ma=v.getAttribute(Je.p$a);if((S=v.getAttribute(Je.MQc))&&ma)S=S.toString(),ma=ma.toString();else{Q.a.J(509371461,
829,10,"DesignerView::applyFirstDesignerSuggestion - Failed to parse suggestion slide creation id and slideId, CorrelationId: {0}",this.Sb.correlationId);return}}Q.a.J(508941526,829,50,"DesignerView::applyFirstDesignerSuggestion - CorrelationId: {0}",this.Sb.correlationId);v=parseInt(ma);S=parseInt(S)||0;S=Object.assign(new tg,{SuggestionCid:S,SuggestionSid:v,CorrelationId:this.Sb.correlationId,ActiveSlideCid:this.$p.Aa.cid,ActiveSlideSid:this.$p.Aa.sid});this.ia.Ia($a.a.y9,2,S)}y9(v,S){Q.a.J(509089807,
829,50,"DesignerView::applyDesignerSuggestion - auto apply designer, CorrelationId: {0}",this.Sb.correlationId);v=Object.assign(new tg,{SuggestionCid:S,SuggestionSid:v,CorrelationId:this.Sb.correlationId,ActiveSlideCid:this.$p.Aa.cid,ActiveSlideSid:this.$p.Aa.sid});this.ia.Ia($a.a.y9,2,v)}hH(v){return this.Co.isVisible&&v.Ec?this.a8f(v.clientPoint):!1}nWj(v){this.DO();this.G3a(2);Q.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",v);this.Co.isVisible&&(this.Sb.lYa=
!0,this.ia.Ia($a.a.Aqa,2,new hn.a(!1,Gh.a.XBd)))}yUl(){const v=this.Sb.correlationId;this.sTg=window.setTimeout(()=>{this.nWj(v)},this.ka.k$d)}mWj(v){this.DO();this.$p.W3c(this.ufa());Q.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",v)}xUl(){const v=this.Sb.correlationId;this.nTg=window.setTimeout(()=>{this.mWj(v)},this.ka.k$d)}DO(){window.clearTimeout(this.sTg);window.clearTimeout(this.nTg)}get lp(){return this.Co}P8j(){this.cN.style.display=bc.a.none;this.Sb.zQe=
!0;this.SJa=ub.a.we();this.SJa.className=Wd.rYk;const v=this.i1f(Wd.rRe),S=document.createElement("iframe");S.className=S.id=Wd.Ehh;const ma=this.i1f(Wd.qRe);this.SJa.appendChild(v);this.SJa.appendChild(S);this.SJa.appendChild(ma);this.UY.appendChild(this.SJa);const Ja=this.Fa.Kc(dd.a.p4c);Ja.parent=Ua.AFrame.vD;this.hd.DNc(dd.a.p4c,S);Ja.cea(()=>{S.focus();const Va=Object.assign(new ne.DOMFocusListing(()=>this.SJa),{wmb:!0});Va.xp(3);Va.xp(2);Va.xp(4);Va.xp(1);Va.xp(6);Va.xp(5);Jb.FocusManager.instance().F2d(this.SJa,
Ja,Va);const wb=Jb.FocusManager.instance().DR(dd.a.p4c);wb.xmb();wb.IY=!0;wb.HTa=!0;Ja.Sy(Jb.FocusManager.instance().ata);Ja.Sy(Jb.FocusManager.instance().bta);Va.bG(S)});this.Fa.Df(dd.a.p4c);this.Rs.addHandler(this.SJa,Ha.a.Vf,Object(r.a)(this,this.XA,"keyDownHandler"))}i1f(v){const S=document.createElement("div");S.setAttribute("Id",v);S.setAttribute("tabindex",0);S.setAttribute("position","absolute");S.setAttribute("width","-1000px");S.setAttribute("top","-1000px");return S}XA(v){v.keyCode===Sys.UI.Key.tab&&
(v.target.id!==Wd.qRe||v.shiftKey?v.target.id===Wd.rRe&&v.shiftKey&&this.DMh(v,Wd.qRe):this.DMh(v,Wd.rRe))}DMh(v,S){v.preventDefault();v.stopPropagation();(v=document.getElementById(S))&&v.focus()}EUi(v){switch(v.className){case Wd.Hmd:return this.lp.Onb(1),!0;case Wd.jLb:v=v.querySelector("."+Wd.kLb).innerText;break;case Wd.kLb:v=v.innerText;break;case Wd.pRe:v=v.parentNode.querySelector("."+Wd.kLb).innerText;break;default:return!1}return this.sDl(v)}sDl(v){this.ka.Nla&&(this.Gdh=this.ufa().querySelector("."+
Je.vEa).getAttribute("correlationId").toString());this.G3a(6);var S=hc.a.gM(this.ka.pptEditingUserId).toString();S=String.format(this.ka.insertPictureServiceEndpoint,w.AFrameworkApplication.lcid,yk.a.Oe(w.AFrameworkApplication.lcid).name,w.AFrameworkApplication.buildVersion,yb.a.create().toString(),3,S,0);S=S.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+v;v=document.getElementById(Wd.Ehh);v.setAttribute("src",S);v.style.visibility=bc.a.visible;this.Jx=(new Oe).getInstance(v.contentWindow,
S);this.Jx.Qza(Qe.a.lKf,ma=>{if(ma=this.GK.hth(ma)){const Ja=[];Array.add(Ja,ma);this.ia.nb($a.a.T$e,2);this.lp.zq(!1,Gh.a.TXf);this.CKk.Wva(Ja)}});this.Jx.Qza(Gi.FO,()=>{this.G3a(3);const ma=new Mi(this.Sb.suggestions,this.Sb.suggestions?this.Sb.suggestions.SlideSuggestions.length:0,this.Sb.mTa.length,this.ka.Nla?this.Gdh:this.Sb.correlationId,this.ufa(),!0,this.Nua(),this.$p.C4c(lf.a.makeItVisual));this.$p.Q3e(ma)});return!0}DUi(v){return Sys.UI.DomElement.containsCssClass(v,Wd.szb)||Sys.UI.DomElement.containsCssClass(v,
Wd.rzb)?this.MVj(v):Sys.UI.DomElement.containsCssClass(v,Wd.GUa)||Sys.UI.DomElement.containsCssClass(v,Wd.nWc)||Sys.UI.DomElement.containsCssClass(v,Wd.f8f)||Sys.UI.DomElement.containsCssClass(v,Wd.e8f)?this.NVj(v):Sys.UI.DomElement.containsCssClass(v,Wd.C8b)?this.xWj():Sys.UI.DomElement.containsCssClass(v,Wd.G8b)?this.KXj():!1}KXj(){this.ia.nb($a.a.sYe,2);this.lp.zq(!1,Gh.a.Oal);return this.Sb.U7f=!0}a8f(v){const S=this.Sb.o6d;if(!S||pf.a.Ta(this.Sb.RX))return!1;v=Cd.a.KVa(v);this.Jhk(v)?S.c4c(this.Uhg()):
S.c4c([]);return!0}Jhk(v){for(;v&&v.className!==Wd.Xae;)v=v.parentNode;return!!v&&v.className===Wd.Xae}xWj(){const v=this.Sb.o6d;if(!v)return!1;v.ignoreCritiques(this.Uhg(),4);this.Sb.RX.splice(this.Sb.LO,1);if(this.Sb.LO===this.Sb.RX.length){let S;(S=this.Sb).LO=S.LO-1}this.avl();return!0}Uhg(){const v=[];for(const S of this.Sb.RX[this.Sb.LO].critiques)v.push(S.critiqueId);return v}MVj(v){if(Sys.UI.DomElement.containsCssClass(v,Wd.szb)){let S;(S=this.Sb).LO=S.LO-1;this.Sb.LO||(Sys.UI.DomElement.removeCssClass(v,
Wd.szb),Sys.UI.DomElement.addCssClass(v,Wd.E8b));v=document.getElementById(Wd.qzb);Sys.UI.DomElement.removeCssClass(v,Wd.D8b);Sys.UI.DomElement.addCssClass(v,Wd.rzb)}else{let S;(S=this.Sb).LO=S.LO+1;this.Sb.LO===this.Sb.RX.length-1&&(Sys.UI.DomElement.removeCssClass(v,Wd.rzb),Sys.UI.DomElement.addCssClass(v,Wd.D8b));v=document.getElementById(Wd.Vab);Sys.UI.DomElement.removeCssClass(v,Wd.E8b);Sys.UI.DomElement.addCssClass(v,Wd.szb)}document.getElementById(Wd.Wae).innerText=(this.Sb.LO+1).toString();
this.i2h(this.Sb.LO);return!0}i2h(v){var S=this.Sb.RX[v].critiques[0].explanationLabel;document.getElementById(Wd.d8f).innerText=S;S=document.getElementById(Wd.g8f);const ma=Je.M0f();S.parentNode.replaceChild(ma,S);this.$p.itg(ma,v)}NVj(v){const S=this.Sb.o6d;if(pf.a.Ta(this.Sb.RX)||!S)return!1;v=v.getAttribute(Gi.FUa);var ma=document.querySelector("."+Wd.nWc+"["+Gi.FUa+'="'+v+'"]');ma&&(ma.innerText="\u2713",Sys.UI.DomElement.removeCssClass(ma,Wd.nWc),Sys.UI.DomElement.addCssClass(ma,Wd.Afj));ma=
new Qb.a(0);for(const Ja of this.Sb.RX[this.Sb.LO].critiques)ma.add(Ja.critiqueId,v);S.cXh(ma);return this.Sb.lWc=!0}avl(){var v=document.getElementById(Wd.S7f);let S=parseInt(v.innerText);S--;if(0>=S)this.X0l(document.getElementById(Wd.T7f));else{v.innerText=S.toString();this.i2h(this.Sb.LO);v=this.Sb.LO===this.Sb.RX.length-1;const ma=document.getElementById(Wd.qzb);1<S&&!v?(Sys.UI.DomElement.addCssClass(ma,Wd.rzb),Sys.UI.DomElement.removeCssClass(ma,Wd.D8b)):(Sys.UI.DomElement.addCssClass(ma,Wd.D8b),
Sys.UI.DomElement.removeCssClass(ma,Wd.rzb));v&&(document.getElementById(Wd.Wae).innerText=S.toString());v=document.getElementById(Wd.Vab);1<S&&this.Sb.LO?(Sys.UI.DomElement.addCssClass(v,Wd.szb),Sys.UI.DomElement.removeCssClass(v,Wd.E8b)):(Sys.UI.DomElement.addCssClass(v,Wd.E8b),Sys.UI.DomElement.removeCssClass(v,Wd.szb))}}X0l(v){const S=ub.a.we();S.className=Wd.ufj;const ma=new Vo.a;ma.Mh(40,40);ma.Yqa("0,0,2048,2048");ma.ot(Wd.Bfj);var Ja=new zl.a;Ja.h_("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Va=new zl.a;Va.h_("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Va.va.setAttribute("class",Wd.Efj);const wb=
new zl.a;wb.h_("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
wb.va.setAttribute("class",Wd.sfj);const Sb=new zl.a;Sb.h_("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Sb.va.setAttribute("class",Wd.rfj);ma.appendChild(Ja);ma.appendChild(Va);ma.appendChild(wb);ma.appendChild(Sb);Ja=ub.a.En();Ja.innerText=ResourceStrings.l_ConsistencyCardNoMore;Ja.className=Wd.vfj;S.appendChild(ma.va);S.appendChild(Ja);v.parentNode.replaceChild(S,v)}}co.pfj=[Wd.Vab,Wd.qzb,Wd.GUa,Wd.C8b,Wd.G8b];Object(k.a)(co,"DesignerView",Em.a,[1159,418,262,106]);var Uq=d(190);class Zk extends Sys.EventArgs{constructor(v,S){super();this.slideId=v.slideId;this.zVh=v.Gzc;this.Z$f=v.Eca;this.Abb=S;
this.trigger=v.trigger;this.correlationId=v.correlationId}}Object(k.a)(Zk,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class Xo{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If){this.xUg=new uf.a;this.Zp=v;this.$p=S;this.Sb=ma;this.ka=Ja;this.ia=Va;this.sa=wb;this.Eb=Sb;this.Hc=vc;this.yb=gd;this.Fa=od;this.zb=Vd;this.Dic=this.YCe=0;this.MZa=Ke;this.jGk=kg;this.Cya=If;this.ps()}ps(){this.Hc.Myi(Object(r.a)(this,this.qqh,"onSuggestionsUpdated"));this.Hc.Lyi(Object(r.a)(this,this.Tlh,"onCoauthModifiedSameSlide"));
this.jGk.execute(v=>{v.bwi(Object(r.a)(this,this.Z9k,"onShowMoreSuggestions"),()=>{this.ZQb(this.Zp,3)})});this.ka.designerIncrementalRenderEnabled&&this.Hc.Rzi(Object(r.a)(this,this.Vqh,"onUserBeginUploadPicture"));this.Hc.tOc(Object(r.a)(this,this.Vpa,"onUndoRedo"))}dispose(){this.Hc.nBl(Object(r.a)(this,this.qqh,"onSuggestionsUpdated"));this.Hc.mBl(Object(r.a)(this,this.Tlh,"onCoauthModifiedSameSlide"));this.ka.designerIncrementalRenderEnabled&&this.Hc.WBl(Object(r.a)(this,this.Vqh,"onUserBeginUploadPicture"));
this.Hc.tvd(Object(r.a)(this,this.Vpa,"onUndoRedo"))}ZMl(v){this.ia.Ia($a.a.Aqa,2,new hn.a(!1,v))}ZQb(v,S){v?v.G3a(S):Q.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Sb.correlationId,S)}I_j(v){const S=this.kbj(v);if(S){var ma=S.lp;Q.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",v,Xk[ma.Tca]);switch(ma.Tca){case 3:this.g_k(v,S);break;case 2:case 9:this.f_k(v,S,ma.Tca)}}}kbj(v){switch(v){case $a.a.mkb:case $a.a.lqc:case $a.a.xLb:case $a.a.nkb:case $a.a.nqc:case $a.a.zLb:case $a.a.mqc:case $a.a.yLb:v=
this.Zp;break;default:return null}return v}g_k(v,S){if(S&&S.lp){var ma=document.activeElement;if(ma){var Ja=ma.getAttribute(Je.wEa),Va=S.Psk(ma),wb=Sys.UI.DomElement.containsCssClass(ma,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(ma,"IdeasText"),Sb=this.Dhh(ma)||this.V7f(ma),vc=S.QGg();if(Ja||wb||Sb||Va||vc)if(Ja=Ja?parseInt(Ja.toString()):-1,Va=S.vbc()-1,!(1>Va))switch(wb=S.lp,Sb=S.uqg(),v){case $a.a.mkb:if(vc||1===Sb||3===Sb)break;wb.FB(!1);Ja<Va&&(S.Ux(Ja,!1),S.Ux(Ja+1,!0));
break;case $a.a.lqc:if(vc||1===Sb||3===Sb)break;wb.FB(!1);Ja!==Va&&(S.Ux(Ja,!1),S.Ux(Va,!0));break;case $a.a.xLb:if(vc){S.Gtg();break}this.CXj(S,Ja,Va,Sb);break;case $a.a.nkb:if(vc||1===Sb||3===Sb)break;wb.FB(!1);0<Ja&&(S.Ux(Ja,!1),S.Ux(Ja-1,!0));break;case $a.a.nqc:if(vc||1===Sb||3===Sb)break;wb.FB(!1);Ja&&(S.Ux(Ja,!1),S.Ux(0,!0));break;case $a.a.zLb:if(vc){S.Gtg();break}this.DXj(S,Ja,Va,Sb);break;case $a.a.mqc:case $a.a.yLb:vc||1===Sb||3===Sb||(v=v===$a.a.yLb,S=S.lp,this.Dhh(ma)?this.FXj(v,S):this.V7f(ma)&&
this.EXj(v,S))}}}}CXj(v,S,ma,Ja){const Va=v.lp;if(-1===S){switch(Ja){case 1:Va.CXa?(Va.FB(!1),v.Oxc(!0)):v.MFg()?(v.Oxc(!1),v.Qqa(!0,Ja)):(v.Qqa(!1,Ja),Va.FB(!0));return;case 2:Va.CXa?(Va.FB(!1),v.Ux(0,!0)):(v.Qqa(!1,Ja),Va.FB(!0));return;case 3:S=Va.CXa;Va.FB(!S);v.Qqa(S,Ja);return}Va.FB(!1);v.Ux(0,!0)}else S===ma?(v.Ux(S,!1),2===Ja?v.Qqa(!0,Ja):Va.FB(!0)):(v.Ux(S,!1),v.Ux(S+1,!0))}DXj(v,S,ma,Ja){const Va=v.lp;if(0<S)v.Ux(S,!1),v.Ux(S-1,!0);else if(-1===S){switch(Ja){case 1:Va.CXa?(Va.FB(!1),v.Qqa(!0,
Ja)):v.MFg()?(v.Oxc(!1),Va.FB(!0)):(v.Qqa(!1,Ja),v.Oxc(!0));return;case 2:Va.CXa?(Va.FB(!1),v.Qqa(!0,Ja)):(v.Qqa(!1,Ja),v.Ux(ma,!0));return;case 3:S=Va.CXa;Va.FB(!S);v.Qqa(S,Ja);return}Va.CXa&&(Va.FB(!1),v.Ux(ma,!0))}else v.Ux(0,!1),Va.FB(!0)}f_k(v,S,ma){if(S){var Ja=S.lp;if(v===$a.a.xLb||v===$a.a.zLb||v===$a.a.nkb||v===$a.a.mkb)v=S.irk(ma),Ja.FB(v),S.$Tl(!v,ma)}}Dhh(v){return Sys.UI.DomElement.containsCssClass(v,Wd.Hmd)||Sys.UI.DomElement.containsCssClass(v,Wd.jLb)}V7f(v){return v.className.startsWith(Wd.b8f)}FXj(v,
S){var ma=document.activeElement;ma&&(Sys.UI.DomElement.containsCssClass(ma,Wd.jLb)?(ma=parseInt(ma.getAttribute(Wd.Fhh).toString())+1,v?ma!==Gi.Bpc?S.Onb(ma+1):S.Onb(1):1!==ma?S.Onb(ma-1):S.Onb(Gi.Bpc)):v?S.Onb(1):S.Onb(Gi.Bpc))}EXj(v,S){var ma=document.activeElement;if(ma){for(var Ja=co.pfj,Va=0;!Sys.UI.DomElement.containsCssClass(ma,Ja[Va]);)if(Va++,Va===Ja.length){Va=-1;break}var wb=document.querySelectorAll("."+Wd.GUa).length;Ja[Va]!==Wd.GUa?v?Va!==Ja.length-1&&-1!==Va?Ja[Va+1]!==Wd.GUa?this.iCb(Ja[Va+
1],S):S.Ayd(0):this.iCb(Ja[0],S):Va&&-1!==Va?Ja[Va-1]!==Wd.GUa?this.iCb(Ja[Va-1],S):S.Ayd(wb-1):this.iCb(Ja[Ja.length-1],S):(ma=parseInt(ma.getAttribute(Gi.FUa).toString()),v?ma!==wb-1?S.Ayd(ma+1):this.iCb(Ja[Va+1],S):ma?S.Ayd(ma-1):this.iCb(Ja[Va-1],S))}}iCb(v,S){switch(v){case Wd.Vab:S.OPl();break;case Wd.qzb:S.NPl();break;case Wd.C8b:S.LPl();break;case Wd.G8b:S.MPl()}}tcc(v,S){if(this.ka.J6c&&this.Zp.lp.isVisible){if(S&&(v===$a.a.y9||v===$a.a.Xvb)){this.Sb.x0=P.a.empty;S=this.sa.presentation;const ma=
this.Eb.ud(7,void 0,void 0,void 0,!0);try{ma.mc(S),this.ka.Iaj&&(ma.Wc=v),S.removeProperty(Pc.a.rFa)}finally{ma&&ma.dispose()}}this.$p.vfm(this.Zp.ufa());this.ka.Caj&&v!==$a.a.y9&&v!==$a.a.Xvb&&this.ia.nb($a.a.Q4f,2)}}Vpa(v,S){this.tcc(S.Mgf,S.pfb)}Zfk(v){return this.Sb.bFb(v)}JGg(v){switch(v){case Af.a.v1d:case Af.a.y1d:case Af.a.Z3b:case Af.a.x1d:case Af.a.z1d:case Af.a.A1d:case Af.a.SSa:case Af.a.B1d:case Af.a.C1d:case Af.a.D1d:case Af.a.E1d:case Af.a.G1d:case Af.a.I1d:case Af.a.backspace:case Af.a.rEa:case Af.a.PJ:case Af.a.nUa:case Af.a.enter:case Af.a.WC:case Af.a.Nz:return!0;
default:return!1}}isEnabled(){return this.ka.J6c}agk(){return 0<this.Dic}w5d(){return this.Dic}Tlh(v,S){v=S.slideId;Q.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",v.sid);if((S=this.sa.Aa)&&S.Fb.equals(v)){S="unopened";this.Zp.lp.isVisible&&(this.Zp.lp.isVisible&&this.ZQb(this.Zp,5),S="set to SameSlideCoauthNoSuggestion UI");let ma="unopened";this.Zp.lp.isVisible&&(this.sLa(this.Sb.correlationId,xl.a.qLa),ma="closed");"unopened"===S&&"unopened"===
ma||Q.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",S,ma,v.sid,v.cid,this.Sb.correlationId,this.YCe,this.Dic)}}qqh(v,S){Q.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.ka.J6c,this.YCe,
this.Dic,S.correlationId,S.trigger);if(this.isEnabled()){if(v=this.sa.Aa)if(S.slideId.equals(v.Fb))if(this.Zfk(S.correlationId))Q.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",S.correlationId);else if(this.fmm(S.correlationId))Q.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
S.correlationId);else{this.Sb.correlationId!==S.correlationId&&(this.Sb.KJf(S.correlationId,this.ka.Nla&&S.trigger===lf.a.moreIdeas),Q.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Sb.correlationId,S.correlationId));if(this.Sb.correlationId===S.correlationId&&this.Zp.lp.isVisible&&3===this.Zp.lp.Tca)if(this.ka.designerIncrementalRenderEnabled&&pf.a.any(S.Gzc.toArray(),ma=>0<=this.Sb.tha.indexOf(ma)))this.Sb.Rpc=
new Date,Q.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",S.correlationId,S.Gzc.toString(),this.Sb.tha.toString());else if(v=S.bOa,!this.ka.designerIncrementalRenderEnabled||this.Sb.rua.contains(v)){Q.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",S.correlationId,v.toString());
return}v=Je.f$d(S.xFa);this.WJl(v,S);this.K_j(S);this.J_j(this.Zp,S,v,S.Eca,pf.a.Ta(this.Sb.mTa)?S.Eca:this.Sb.mTa.length)}else Q.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",S.correlationId)}else Q.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",S.correlationId)}WJl(v,S){if(v&&S.trigger!==lf.a.moreIdeas){this.Sb.suggestions||(this.Sb.suggestions=
Object.assign(new Dm,{CardData:v.CardData,SlideSuggestions:Array(S.ope?S.Eca:S.m4a)}));if(!pf.a.Ta(v.SlideSuggestions))for(const ma of v.SlideSuggestions)this.Sb.suggestions.SlideSuggestions[ma.Index]=ma;this.Sb.mTa||(this.Sb.mTa=Je.Cdl(v))}}J_j(v,S,ma,Ja,Va){Q.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",S.correlationId,S.trigger,S.Eca,Ja);if(S.trigger===lf.a.moreIdeas){this.Sb.Lia||(this.Sb.Lia=new Date);var wb=v.vbc();
this.$p.tDl(ma,v.ufa(),S.correlationId,v.Nua())||(this.$p.W3c(v.ufa()),wb=v.vbc()-1);v.Ux(wb,!0);this.ZQb(v,8)}else if(!Ja)!this.ka.designerNewNoIdeasUxEnabled||S.trigger!==lf.a.$Ac&&S.trigger!==lf.a.ITb?this.ZQb(v,2):this.ZQb(v,9),this.Zp.lp.isVisible?this.sLa(this.Sb.correlationId,xl.a.qLa):this.ZMl(Gh.a.noSuggestion);else if(this.dZl(S.trigger,v.lp)){var Sb=!0;if(this.ka.designerIncrementalRenderEnabled){Sb=null;var vc=v.ufa();vc&&(Sb=vc.querySelector("#"+v.lp.id+" ."+Je.vEa+'[correlationId="'+
S.correlationId+'"]'));Sb=!Sb;Q.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",S.correlationId,S.trigger,Sb);vc=new Zk(S,Sb);this.Hc.Lql(vc)}if(Sb){this.ZQb(v,3);this.Sb.Lia||(this.Sb.Lia=new Date);try{this.ka.Hil&&this.Cya.execute(gd=>{gd.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(gd){Q.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
gd)}}Ja=new Mi(ma,Ja,Va,S.correlationId,v.ufa(),Sb,v.Nua(),this.$p.C4c(S.trigger));this.$p.Q3e(Ja);this.Sb.nec&&this.ka.getBooleanAppSetting("ChatPPTHideImg")&&this.VFl();this.Sb.nec&&this.ka.getBooleanAppSetting("ChatPPTImgAutoApplyDesigner")&&"InsertPicture"===S.trigger&&(id.a("DesignerChatPPTApplyOnFirstRender")?Sb&&0<(null===(wb=null===ma||void 0===ma?void 0:ma.SlideSuggestions)||void 0===wb?void 0:wb.length)?v.y9(ma.SlideSuggestions[0].SlideId.Sid,ma.SlideSuggestions[0].SlideId.Cid):Q.a.J(509089808,
829,Sb?10:50,"DesignerManager::HandleSuggestionUpdate: not able to get suggestion to apply"):(S=v.ufa().querySelector("."+Je.vEa),null!=S&&v.nEi(S.childNodes[0])))}}VFl(){const v=this.sa.Aa;if(v){var S=v.X0(ma=>0!==ma.kTb);S&&S.length&&(S.forEach(ma=>{ma.kTb=0}),S=new W.a(2,1,this.ka.tc("ChatPPTUnhideUpdateMs",2E3),()=>{v.E$(this.yb.Na,252,!0)},void 0,"ResetTempHiddenShapeTask"),this.zb.Jb(S))}}K_j(v){v.ope?(pf.a.Ta(this.Sb.suggestions.SlideSuggestions)||this.Sb.suggestions.SlideSuggestions.length===
v.Eca)&&this.sLa(v.correlationId,xl.a.success,this.Sb.suggestions,v.trigger):this.sLa(v.correlationId,xl.a.success,this.Sb.suggestions,v.trigger)}dZl(v,S){return S.isVisible||v!==lf.a.ypa&&v!==lf.a.e4d&&v!==lf.a.pxb}hBd(v,S){this.Dic=v;this.YCe=S;this.Hc.Gz(new Uq.a(1))}Vqh(){this.Zp.lp.isVisible&&3===this.Zp.lp.Tca&&(this.xUg.add(this.Sb.correlationId),this.Zp.G3a(1))}fmm(v){return this.xUg.contains(v)}sLa(v,S,ma=null,Ja=""){Q.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",
v,S,Ja);this.MZa.execute(Va=>{const wb=this.z0i(v,ma);hc.a.Ta(Ja)||(wb.trigger=Ja);Va.notifySlideSuggestion(S,wb)})}z0i(v,S){const ma=new Yk;ma.correlationId=v;if(!S)return Q.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",v),ma;ma.suggestions=this.$p.jel(S);return ma}Z9k(v){v=new Mi(this.Sb.suggestions,v.suggestions.length,v.suggestions.length,v.correlationId,this.Zp.ufa(),!0,this.Zp.Nua(),this.$p.C4c(v.trigger));this.$p.Q3e(v);
this.Fa.qk(dd.a.U9,!0)}Bcl(){return 4===this.Zp.lp.Tca}ycl(){return 1===this.Zp.lp.Tca}}Object(k.a)(Xo,"DesignerManager",null,[1162,106]);var Hi=d(139);class Qj{constructor(v,S){this.Iib=this.jp=null;this.qSk=S;this.Ye=v;this.Bs=!1}get Sh(){return this.Bs}setup(){this.Sh||(this.Iib=ub.a.we(),this.Iib.setAttribute("Unselectable","on"),this.Iib.style.position=bc.a.absolute,this.Ye.addCssClass(this.Iib,"designerPreviewImageContainer"),this.jp=new Hi.a,this.Bs=!0)}dispose(){this.Sh&&(this.dismiss(),this.jp&&
this.jp.va.parentNode&&(this.jp.mr(),this.Ye.removeCssClass(this.jp.va,"designerPreviewImageContainer")))}dismiss(){this.Sh?(this.t2a(),this.jp.setVisibility(!1)):Q.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}xNa(v){if(this.Sh){this.Iib&&(this.Iib.appendChild(this.jp.va),this.Ye.addCssClass(this.jp.va,"designerPreviewImageContainer"),this.jp.setVisibility(!1));var S=this.qSk.Ic;if(v=this.Bla(v))this.t2a(),S.czc.appendChild(this.Iib),this.jp.va.appendChild(v),this.jp.setVisibility(!0);
this.jp.Mh(S.Oy.clientWidth,S.Oy.clientHeight)}else Q.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}Bla(v){if(!hc.a.Ta(v)){const S=ub.a.DD();S.setAttribute("Unselectable","on");S.src=v;S.style.height="100%";S.style.width="100%";return S}return null}t2a(){this.jp.va.firstChild&&this.jp.va.removeChild(this.jp.va.firstChild)}}Object(k.a)(Qj,"DesignerPreviewImageView",null,[1163]);var Kk=d(171);class no{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke){this.sN=null;this.dLa=
0;this.ia=v;this.Eb=S;this.gb=ma;this.sa=Ja;this.yb=Va;this.ka=wb;this.Qi=Sb;this.ek=vc;this.ic=gd;this.yaa=od;this.zb=Vd;this.fe=Ke;this.Voa=ri.ready}qb(){this.ia.pa($a.a.fixIt,qb.a.application,Object(r.a)(this,this.dWj,"handleFixIt"),4);this.ia.pa($a.a.E_e,qb.a.application,Object(r.a)(this,this.MYj,"handleQueryFixIt"),96);this.ia.pa($a.a.Yvb,qb.a.application,Object(r.a)(this,this.Yvb,"applyFixItSuggestion"),4);this.ia.pa($a.a.A2a,qb.a.application,Object(r.a)(this,this.A2a,"reportFixItSessionInfo"),
64);this.yaa.a3b(Object(r.a)(this,this.Gha,"onBlockingStateChanged"))}dispose(){this.yaa.ovd(Object(r.a)(this,this.Gha,"onBlockingStateChanged"))}dWj(v,S,ma){S=this.gb.Hd();if(2>S.length)return 8;if(1===ma)return 32;ma=this.sa.presentation;this.ka.designerBlockApplyUntilDraw?this.ic.Kta(ma,this.sa.Aa,this.yb.Na,v):this.ic.mx(ma,v);this.ek.y6c=!0;const Ja=[];S.forEach(Va=>{Array.add(Ja,Va.get_shapeId())});v={};v.SelectedShapeIds=Ja.join(",");this.ek.hob=Ja;this.Jme(v);this.ek.Apb=window.setTimeout(()=>
{this.eWj(this.ek.correlationId)},this.ka.kdg);return 32}eWj(v){this.ek.lYa=!0;Q.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",v);this.ia.Ia($a.a.A2a,2,Gh.a.XBd);this.fe.xua(ck.a.hi(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}Jme(v=null,S=null){this.ojj(ma=>{if(this.ka.designerRequestThrottlingEnabled){if(this.Voa.ZEg&&+new Date-+this.Voa.cIg<this.ka.designerRequestThrottleIntervalMs){this.sN=new sp;this.sN.sid=
ma.sid;this.sN.cid=ma.cid;this.sN.e4c=ma.HM;return}this.Voa=ri.f1;this.sN=null}const Ja=()=>{this.Jme(this.sN.e4c,S)};this.Qi.oma(ma.cid,ma.sid,ma.correlationId,null,wf.a.fixIt,S,Ab.c(ma.HM),Va=>{Va&&Va.Status===wf.a.fGh?this.lwd(()=>{this.Jme(ma.HM,S)}):this.dLa=0;this.dLa||this.qcc(Ja)},Va=>this.Ukb(Va,Ja))},v)}lwd(v){this.dLa<this.ka.designerMaxRetryOnWait?this.zb.Jb(new W.a(2,1,1E3,()=>{Q.a.J(578937822,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.ek.correlationId);
this.Voa=ri.ready;this.dLa++;v()},void 0,"RetryRequestOnWait")):Q.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.ek.correlationId)}Yvb(v,S,ma,Ja,Va){S=this.sa.presentation;if(!this.sa.Aa||!S)return 16;Ja=null;Object(Wg.a)(tg,Va)&&(Ja=Va);if(!Ja)return 8;if(1===ma)return 32;ma=this.Eb.xe(15);try{this.ka.designerSendAppliedSuggestionHistoryEnabled&&(this.ek.MSa=new Date),ma.mc(S),ma.Wc=v,S.rFa=Ja,this.ek.x0=P.a.Aq(Ja.SuggestionSid,Ja.SuggestionCid),
this.ek.lV=!0,Q.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ja.CorrelationId,v,Ja.SuggestionSid)}finally{ma&&ma.dispose()}return 32}ojj(v,S=null){const ma=this.sa.Aa;ma&&ma.sid&&(S=Object.assign(new xj,{sid:ma.sid,cid:ma.cid,HM:S||{}}),Q.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",S.sid,S.correlationId),this.ek.correlationId&&this.wnb(Gh.a.Xmb),this.ek.l4a=new Date,this.ek.correlationId=S.correlationId,this.ek.qR=new Date,
v(S))}qcc(v){this.ka.designerRequestThrottlingEnabled&&(this.Voa=ri.ready,this.sN&&v())}Ukb(v,S){this.qcc(S);Q.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",v.HttpStatusCode);return!0}MYj(v,S,ma,Ja,Va){this.Zbm();if(!Object(Wg.a)($n.a,Va))return 8;if(1<this.gb.Lxd()){let wb;(wb=this.ek).Nwb=wb.Nwb+1;return 32}return 8}A2a(v,S,ma,Ja,Va){if(Va===Gh.a.noSuggestion||Va===Gh.a.XBd)this.ka.designerBlockApplyUntilDraw?this.ic.EBc(Kk.e(this.sa.Aa,
this.yb.Na)):this.ic.vL(this.sa.presentation);this.wnb(Va);return 32}Gha(v,S){if(this.ek.y6c){v=this.ic.Xc(this.sa.presentation);const ma=this.ka.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";v||Object(N.a)(String,S.actionName)!==ma||(window.clearTimeout(this.ek.Apb),this.ek.lYa||(this.ek.k4a=new Date),this.ek.MSa=null,this.ek.y6c=!1)}}wnb(v){const S=this.ek.correlationId;if(hc.a.Ta(S))Q.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",
v);else{var ma={};this.ek.x0&&(ma.SuggestionSlideId=this.ek.x0.sid.toString(),ma.SuggestionSlideCreationId=this.ek.x0.cid.toString());ma.AppliedSuggestion=this.ek.lV;ma.DisplaySuggestionsTimeoutInMs=this.ka.kdg;ma.SuggestionsTimeout=this.ek.lYa;ma.ClientAbort=this.ek.IDb;ma.ResetReason=v;ma.DesignerSendTraceRequestOnSessionEnded=this.ka.l$d;var Ja=Ag.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),Va={};Va.ClientOS=Ja.Os;Va.Browser=Ja.Browser||"";Va.BrowserVersion=Ja.BrowserVersion||
"";Va.BrowserMajorVersion=Ja.BrowserMajorVersion||"";Va.BrowserMinorVersion=Ja.BrowserMinorVersion||"";this.ek.l4a&&this.ek.OSb&&this.ek.OSb>this.ek.l4a&&(Va.SuggestionsE2ETimeMs=+this.ek.OSb-+this.ek.l4a);this.ek.l4a&&this.ek.k4a&&this.ek.k4a>this.ek.l4a&&(Va.SuggestionAppliedE2ETimeMs=+this.ek.k4a-+this.ek.l4a);ma.BrowserData=Va;this.ek.qR&&this.ek.k4a&&this.ek.k4a>this.ek.qR&&(ma.TimeToDisplaySuggestionsInMs=+this.ek.k4a-+this.ek.qR);this.ek.Aef&&(ma.TimeSuggestionsRendered=this.ek.Aef.toUTCString());
this.Qi.Aqa(S,Ab.c(ma),v===Gh.a.gyd);this.ek.J4e();Q.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",v,S)}}Zbm(){try{const v=C.a.instance.Ha("Common.ISystemInitiatedFeedback");v&&v.execute(S=>{S.logActivity("AutoFixInViewportActivity",null)})}catch(v){Q.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",v)}}JZ(){}IZ(){}}Object(k.a)(no,"FixItActor",null,
[182]);class Yo{constructor(){this.Nwb=0;this.correlationId=this.hob=null;this.Apb=0;this.IDb=this.y6c=this.lV=this.lYa=!1;this.suggestion=this.qR=this.k4a=this.MSa=this.OSb=this.l4a=this.Aef=null;this.x0=P.a.empty}J4e(){this.Nwb=0;this.correlationId=this.hob=null;this.x0=P.a.empty;this.Apb=0;this.IDb=this.y6c=this.lV=this.lYa=!1;this.qR=this.k4a=this.MSa=this.OSb=this.l4a=this.Aef=null}}Object(k.a)(Yo,"FixItContext",null,[1167]);var Fm=d(977),Wj=d(1012),tn=d(874),oo=d(945);class Gm{constructor(v,
S,ma,Ja,Va,wb,Sb,vc,gd,od){this.ia=v;this.sa=S;this.Eb=ma;this.Hc=Ja;this.ek=Va;this.Wf=wb;this.OKb=Sb;this.yK=vc;this.Nc=gd;this.fe=od;this.ps()}ps(){this.OKb.$2b(Object(r.a)(this,this.TI,"onEvent"));this.Wf.HJ(Object(r.a)(this,this.TI,"onEvent"));this.Nc.dEa(Object(r.a)(this,this.TI,"onEvent"));this.Nc.bC(Object(r.a)(this,this.TI,"onEvent"));this.Hc.Yyi(Object(r.a)(this,this.pqh,"onSuggestionReceived"));this.Hc.tOc(Object(r.a)(this,this.Vpa,"onUndoRedo"))}dispose(){this.Hc.vBl(Object(r.a)(this,
this.pqh,"onSuggestionReceived"));this.Hc.tvd(Object(r.a)(this,this.Vpa,"onUndoRedo"))}pqh(v,S){if(v=this.sa.Aa)if(S.slideId.equals(v.Fb))if(this.ek.correlationId!==S.correlationId)Q.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.ek.correlationId,S.correlationId);else if(v=Gm.f$d(S.xFa),v.SlideSuggestion)this.ek.OSb||(this.ek.OSb=new Date),S=Object.assign(new tg,{SuggestionCid:v.SlideSuggestion.SlideId.Cid,
SuggestionSid:v.SlideSuggestion.SlideId.Sid,CorrelationId:S.correlationId,ActiveSlideCid:Object(N.a)(205,this.sa.Aa).cid,ActiveSlideSid:Object(N.a)(205,this.sa.Aa).sid}),this.ia.Ia($a.a.Yvb,2,S);else switch(this.ia.Ia($a.a.A2a,2,Gh.a.noSuggestion),v.ResponseDescription){case "Invalid request":this.fe.xua(ck.a.hi(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.fe.xua(ck.a.hi(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.fe.xua(ck.a.hi(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else Q.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",S.correlationId)}JR(v){this.ek.correlationId&&v!==$a.a.Yvb&&this.ia.Ia($a.a.A2a,2,Gh.a.cVb+this.yK.H7(v))}tcc(v,S,ma){if(this.ek.correlationId&&ma&&S===$a.a.Yvb){this.ek.x0=
P.a.empty;ma=this.sa.presentation;const Ja=this.Eb.ud(7,void 0,void 0,void 0,!0);try{Ja.mc(ma),Ja.Wc=S,ma.removeProperty(Pc.a.rFa)}finally{Ja&&Ja.dispose()}this.ia.Ia($a.a.A2a,2,Gh.a.cVb+this.yK.H7(v))}}Vpa(v,S){this.tcc(S.actionId,S.Mgf,S.pfb)}TI(v,S){v=!1;let ma="";if(Object(Wg.a)(Fm.a,S)){Q.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.ek.correlationId,Bo.a[Object(N.a)(Fm.a,S).uE]);if(1===Object(N.a)(Fm.a,S).uE||3===Object(N.a)(Fm.a,S).uE)v=!0;ma=Gh.a.gyd}else Object(Wg.a)(Wj.a,
S)?(Q.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),v=!0,ma=Gh.a.kyl):Object(Wg.a)(tn.a,S)?(v=!0,ma=Gh.a.slideNavigation):Object(Wg.a)(oo.a,S)&&Object(N.a)(oo.a,S).iEb&&this.JR(Object(N.a)(oo.a,S).actionId);v&&this.ek.correlationId&&this.ia.Ia($a.a.A2a,2,ma);this.IDk()}IDk(){0<this.ek.Nwb&&(Q.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.ek.Nwb),this.ek.Nwb=0)}static f$d(v){let S=null;try{S=Ag.a(v)}catch(ma){Q.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return S}}
Object(k.a)(Gm,"FixItManager",null,[1166,106]);var jn=d(1067),vp=d(16),Co;(function(v){v[v.seen=0]="seen";v[v.keep=1]="keep";v[v.drillIn=2]="drillIn"})(Co||(Co={}));Object(k.b)("IdeasCardAction",Co);var Hn;(function(v){v[v.designer=0]="designer";v[v.makeItVisual=1]="makeItVisual";v[v.editor=2]="editor";v[v.UNKNOWN=3]="UNKNOWN"})(Hn||(Hn={}));Object(k.b)("IdeasCardType",Hn);class $k{constructor(v,S){this.Uwa=null;this.Hmc=!1;this.ia=v;this.ka=S;this.ia.xa($a.a.ideasPaneOpened,qb.a.application,Object(r.a)(this,
this.wWj,"handleIdeasPaneOpen"));this.ia.xa($a.a.Loe,qb.a.application,Object(r.a)(this,this.vWj,"handleIdeasPaneClose"));this.ia.xa($a.a.nwg,qb.a.application,Object(r.a)(this,this.ysg,"handleIdeasKeep"));this.ia.xa($a.a.owg,qb.a.application,Object(r.a)(this,this.Nme,"handleIdeasSee"));this.ia.xa($a.a.twg,qb.a.application,Object(r.a)(this,this.Nme,"handleIdeasSee"));this.ia.xa($a.a.uwg,qb.a.application,Object(r.a)(this,this.Mme,"handleIdeasDrillIn"));this.ia.xa($a.a.rwg,qb.a.application,Object(r.a)(this,
this.ysg,"handleIdeasKeep"));this.ia.xa($a.a.swg,qb.a.application,Object(r.a)(this,this.Nme,"handleIdeasSee"));this.ia.xa($a.a.pwg,qb.a.application,Object(r.a)(this,this.Mme,"handleIdeasDrillIn"));this.ia.xa($a.a.qwg,qb.a.application,Object(r.a)(this,this.Mme,"handleIdeasDrillIn"))}wWj(){if(!this.ka.pptIdeasContextEnabled)return 2;this.Hmc=!0;this.ygk()||this.p5l(yb.a.create());return 32}vWj(){if(!this.ka.pptIdeasContextEnabled)return 2;this.Hmc=!1;return 32}ysg(v){if(!this.ka.pptIdeasContextEnabled)return 2;
this.nbm(this.q$d(v));return 32}Nme(v){if(!this.ka.pptIdeasContextEnabled)return 2;this.ADd(this.q$d(v));return 32}Mme(v){if(!this.ka.pptIdeasContextEnabled)return 2;this.kbm(this.q$d(v));return 32}q$d(v){switch(v){case $a.a.nwg:case $a.a.owg:case $a.a.pwg:v=0;break;case $a.a.twg:case $a.a.uwg:v=1;break;case $a.a.rwg:case $a.a.swg:case $a.a.qwg:v=2;break;default:v=3}return v}p5l(){this.ka.pptIdeasContextEnabled&&(this.Uwa=new jn.a)}ADd(v){this.ka.pptIdeasContextEnabled&&this.Hmc&&3!==v&&this.Uwa&&
!this.Uwa.any(S=>S.key===v)&&this.Uwa.add(new vp.a(v,0))}nbm(v){this.Hmc&&3!==v&&this.Uwa&&this.Uwa.add(new vp.a(v,1))}kbm(v){this.Hmc&&3!==v&&this.Uwa&&this.Uwa.add(new vp.a(v,2))}ygk(){return!!this.Uwa&&0<this.Uwa.length}}Object(k.a)($k,"IdeasContext",null,[1165]);class Im{constructor(){this.Az=this.zz=null;this.XD=this.zy=0}}Object(k.a)(Im,"ImageLocationInfo",null,[]);var Vm=d(446);class Lh{}Object(k.a)(Lh,"ImageToTableRequest",null,[]);class fm{}fm.Mwg="ImageToTableTile";fm.Kwg="ImageToTable.Request";
fm.Lwg="ImageToTable.Response";Object(k.a)(fm,"ImateToTableAugmentationSchemaNames",null,[]);class jl{constructor(){this.o2=this.J1=null}get xH(){return"ImageToTableALWorkflow"}get proto(){return""}get uwb(){this.J1||(this.J1=Object.assign(new Vm.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:fm.Mwg,outputSchema:fm.Kwg,func:Object(r.a)(this,this.wfb,"lambdaBeforeFunc")}));return this.J1}get Ivb(){return null}get kPb(){this.o2||(this.o2=Object.assign(new Vm.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:fm.Kwg,outputSchema:fm.Lwg,func:null}));return this.o2}wfb(v,S,ma){v=Object.assign(new Lh,{image:v.image});ma(v)}}Object(k.a)(jl,"ImageToTableALWorkflow",null,[1175]);class Ni{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(k.a)(Ni,"ImageToTableALv2ResponseWrapper",null,[]);class kn{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.mhc=null}}Object(k.a)(kn,"ImageToTableTile",null,[]);class gm{constructor(v,
S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd){this.ia=v;this.gb=S;this.ic=ma;this.jh=Ja;this.fB=Va;this.Tb=Sb;this.Vk=vc;this.bCe=gd;this.loa=od;this.ka=Vd}initialize(){this.ia.xa($a.a.rYe,qb.a.application,Object(r.a)(this,this.csg,"handleConvertImageToTable"));this.ia.xa($a.a.zYe,qb.a.application,Object(r.a)(this,this.ltg,"handleReplaceImageWithHtmlTable"));this.jh.HJ(Object(r.a)(this,this.XC,"onActiveSlideChanged"));this.bCe.execute(v=>{const S=new jl;v.registerSimpleRemoteWorkflow(S.xH,S.uwb,S.kPb,S.Ivb);v.addEventHandler(fm.Lwg,
Object(r.a)(this,this.zWj,"handleImageToTableALResults"));v.aM("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");v.Z2("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(r.a)(this,this.FM,"handleAnnotationEvent"))})}dispose(){this.ia.YI($a.a.rYe,qb.a.application,Object(r.a)(this,this.csg,"handleConvertImageToTable"));this.ia.YI($a.a.zYe,qb.a.application,Object(r.a)(this,this.ltg,"handleReplaceImageWithHtmlTable"));this.jh.E7(Object(r.a)(this,this.XC,"onActiveSlideChanged"))}XC(){this.loa.close()}csg(v,
S,ma){if(!this.ka.pptSuggestedActionImageToTableEnabled)return 16;if(1===ma)return 32;v=this.gb.Hd();if(1!==v.length)return 8;const Ja=this.loa.Qal();if(!Ja)return Q.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Va=v[0];this.ka.Wvh&&(this.loa.rPl(Ja,Va.slideSid,Va.get_shapeId(),gm.W7d(Va)),this.loa.$lh(Ja));this.bCe.execute(wb=>{wb.ylm(Va.slideCid,Va.slideSid,Va.get_shapeId(),Sb=>{this.zsg(Ja,Va,Sb)},()=>{this.zsg(Ja,Va,null);return!0})});
return 32}FM(v){if(v&&"errorDescription"in v&&"parentPath"in v&&"errorCode"in v){var S=new Ni,ma=v.errorDescription.split(";");S.errorDescription=ma[0].split(":")[1];S.processId=ma[1].split(":")[1];S.errorCode=v.errorCode;Q.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",S.processId,S.errorCode,S.errorDescription);ma=v.parentPath[1].split("|");S.slideId=Number.parseInvariant(ma[0]);S.shapeId=Number.parseInvariant(ma[2]);S.html=v.html;
this.loa.pPl(S);this.loa.Zlh()}}zsg(v,S,ma){if(ma&&ma.ImgData)if(this.ka.Wvh)this.loa.qPl(v,ma.ImgData),this.loa.Zlh();else{const Ja=gm.W7d(S),Va=Object.assign(new kn,{sessionId:v,slideSid:S.slideSid,shapeId:S.get_shapeId(),mhc:Ja,image:ma.ImgData});this.bCe.execute(wb=>{wb.submit(fm.Mwg,Va)});this.loa.$lh(v)}else this.loa.n6k(v)}zWj(v,S,ma,Ja){Q.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Ja.processId,Ja.errorCode,Ja.errorDescription);
this.loa.c4k(S,Ja)}ltg(v,S,ma,Ja,Va){v=this.Tb.LGa(Va.slideSid);if(!v)return 8;ma=(S=v.ER(Va.shapeId))?gm.W7d(S):Va.mhc;if(!ma)return 8;Q.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",S.get_shapeId());Va=this.Vk.e8d(!1,v.cid,v.sid,!1,ma.zz,ma.Az,ma.zy,ma.XD,v.wt()+1,Va.RWh,"");this.fB.NU([Va],v,0,null,S);this.ic.mx(v,"ImageToTable");return 32}static W7d(v){return Object.assign(new Im,{zz:v.zz,Az:v.Az,zy:v.zy,XD:v.XD})}}Object(k.a)(gm,"ImageToTableActor",null,[]);class mf{constructor(v){this.shapeId=
this.slideId=0;this.Yoe=null;this.xjf=0;this.Sne=!1;this.Vrc=null;this.b8c=!1;this.w4c=this.bpe=this.Jkh=this.vrh=null;this.sessionId=v}}Object(k.a)(mf,"ImageToTableConversionContext",null,[]);class Rj{constructor(){this.shapeId=this.slideSid=0;this.RWh=this.mhc=null}}Object(k.a)(Rj,"ReplaceImageWithHtmlTableData",null,[]);class Jm{constructor(v,S,ma,Ja){this.ia=v;this.Oc=S;this.Ba=ma;this.xLe=Ja;this.Baa=null}initialize(){this.Oc.execute(v=>{v.lOc(Object(r.a)(this,this.Xmh,"onFirstPartyAddInHidden"))});
this.xLe.QZd(Object(r.a)(this,this.Jsg,"handleMessage"))}dispose(){this.Oc.execute(v=>{v.uBl(Object(r.a)(this,this.Xmh,"onFirstPartyAddInHidden"))});this.xLe.JDh(Object(r.a)(this,this.Jsg,"handleMessage"))}Qal(){this.close();const v=new mf(yb.a.create().toString());v.vrh=new Promise(ma=>{v.Jkh=()=>{ma(v.sessionId)}});const S={};S.BA=ResourceStrings.L_DataFromPicturePaneTitle;S.assetId="FA000000050";S.q7=()=>{this.Jkb(v)};S.nonPersistedSettings={["SessionID"]:v.sessionId};S.sourceLocationOverrideResourceId=
this.Ba.pptImageToTableSourceLocationId;return 32===this.ia.Ia($a.a.Aia,2,S)?(this.Baa=v,this.Baa.sessionId):this.Baa=null}close(){this.r5d(this.Baa)}Jkb(v){Q.a.J(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",v.sessionId);const S=this.Oc.instance.TO("FA000000050");if(S&&S.settings&&"SessionID"in S.settings){var ma;({Ev:ma}=Ag.d(S.settings.SessionID)).returnValue&&(v.sessionId===ma?(v.Vrc=S.zj,Q.a.J(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
S.zj)):Q.a.J(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}r5d(v){v&&v.Vrc&&(v.b8c=!0,this.ia.Ia($a.a.Gxb,2,v.Vrc))}rPl(v,S,ma,Ja){if(v=this.TAb(v))v.slideId=S,v.shapeId=ma,v.Yoe=Ja}pPl(v){const S=this.Baa;S&&S.slideId===v.slideId&&S.shapeId===v.shapeId&&(this.Baa.w4c=v)}qPl(v,S){if(v=this.TAb(v))v.bpe=S}$lh(v){const S=this.TAb(v);S&&(S.xjf=window.setTimeout(()=>{this.dVj(S)},this.Ba.pptImageToTableALWorkflowTimeoutMs))}c4k(v,S){if(v&&S){var ma=this.TAb(v.sessionId);if(ma&&
!ma.Sne)if(ma.slideId=v.slideSid,ma.shapeId=v.shapeId,ma.Yoe=v.mhc,window.clearTimeout(ma.xjf),0===S.errorCode){const Ja={};Ja.tableHtml=S.html;Ja.imageData=v.image;this.sendMessage(ma.sessionId,Ja)}else this.Vxd(v.sessionId,"Failed to convert image to table")}}Zlh(){const v=this.Baa;if(v&&!v.Sne&&v.w4c&&v.bpe)if(window.clearTimeout(v.xjf),0===v.w4c.errorCode){const S={};S.tableHtml=v.w4c.html;S.imageData=v.bpe;this.sendMessage(v.sessionId,S)}else this.Vxd(v.sessionId,"Failed to convert image to table")}n6k(v){this.Vxd(v,
"Failed to render the image shape")}dVj(v){v.Sne=!0;this.Vxd(v.sessionId,"Failed to convert image to table using AL")}Jsg(v,S){S=S.message;(v=this.TAb(S.session_id))&&!v.b8c&&("ACK"===S.cmd_type?(Q.a.J(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",S.cmd_type),v.Jkh()):"cancel"===S.cmd_type?(Q.a.J(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",S.cmd_type),this.r5d(v)):"insert_html"===S.cmd_type?(Q.a.J(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
S.cmd_type),S=Object.assign(new Rj,{slideSid:v.slideId,shapeId:v.shapeId,mhc:v.Yoe,RWh:S.parameters}),this.r5d(v),this.ia.Ia($a.a.zYe,2,S)):Q.a.J(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",S.cmd_type))}Vxd(v,S){this.sendMessage(v,{["errorMessage"]:S})}sendMessage(v,S){const ma=this.TAb(v);ma&&ma.sessionId===v&&ma.vrh.then(()=>{this.xLe.sendMessage(ma.Vrc,S)})}TAb(v){return v&&this.Baa&&this.Baa.sessionId===v?this.Baa:null}Xmh(v,S){S&&
this.Baa&&S.zj===this.Baa.Vrc&&(this.Baa=null)}}Object(k.a)(Jm,"ImageToTablePane",null,[1169]);class Lk extends Sys.EventArgs{constructor(v){super();this.message=v}}Object(k.a)(Lk,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class Wm{constructor(v){this.ua=new xd.a;this.Ba=v}QZd(v){this.ua.addHandler("ImageToDocPaneMessageReceived",v)}JDh(v){this.ua.removeHandler("ImageToDocPaneMessageReceived",v)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(r.a)(this,
this.Ppc,"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(r.a)(this,this.Ppc,"messageReceivedHandler")):Q.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(v){Q.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",v.message,v.stack)}}sendMessage(v,S){const ma={["imageToTablePaneWildcard"]:"."};
for(const Ja of Object.keys(S))ma[Ja]=S[Ja];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(v,"onCustomMessage",ma,Ja=>{Ja&&Q.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Ja)})}Ppc(v){if(v&&this.qfc(v.origin)){var S;({Ev:S}=Ag.d(v.data)).returnValue&&S&&(v=Object(N.a)(Object,S),"."===v.imageToTablePaneWildcard&&this.ua.raiseEvent("ImageToDocPaneMessageReceived",new Lk(v)))}}qfc(v){return v&&v.length&&"null"!==v?v===this.Ba.pptImageToTableAllowedOrigin:
!1}}Object(k.a)(Wm,"ImageToTablePaneMessenger",null,[1168]);var Vq=d(1129);class Vi{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(k.a)(Vi,"ImageTransformInfo",null,[]);class al{constructor(v,S,ma,Ja){this.ia=v;this.gb=S;this.sa=ma;this.Hc=Ja}initialize(){this.Hc.Bxi(Object(r.a)(this,this.oqh,"onSuggestedActionClick"))}dispose(){this.Hc.xAl(Object(r.a)(this,this.oqh,"onSuggestedActionClick"))}oqh(v,S){if((v=S.card)&&this.sa.Aa){var ma=this.sa.Aa.yj(),Ja=[];
S=[];for(var Va of ma)for(const wb of v.Selects)if(wb.Id===Va.get_shapeId()){Array.add(Ja,Va);Array.add(S,Va.get_shapeId());break}this.gb.Pu();this.gb.Bh();this.gb.$2a(Ja,!0);if(4===v.Type){if(Va=this.sa.presentation)Va.SCb=Object.assign(new Vi,{Scenario:v.Scenario,SlideSid:this.sa.Aa.sid,SlideCid:this.sa.Aa.cid,ShapeIds:S})}else this.ia.nb(Vq.a.SQc(v.ExecutionActionName),2)}}}Object(k.a)(al,"SuggestedActionsHandler",null,[]);class Km{constructor(){this.K=null;this.LP=!1}get name(){return"PowerPointWebEditor.Designer"}fc(v){this.K=
v;this.K.register(1159,"PowerPointWebEditor.IDesignerView").ma().na(()=>new co(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(1160,"PowerPointWebEditor.IDesignerPane").ma().na(()=>new ej(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(1161,"PowerPointWebEditor.IDesignerViewHelper").ma().na(()=>new Je(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),
this.K.Ha("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(1162,"PowerPointWebEditor.IDesignerManager").ma().na(()=>new Xo(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.Ha("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ha("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ha("Common.ISystemInitiatedFeedback")));this.K.register(1163,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().na(()=>new Qj(this.K.resolve("PowerPoint.IBrowserHelperManager"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));this.K.register(1164,"PowerPointWebEditor.IDesignerContext").ma().na(()=>new bo(this.K.Ha("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(1165,"PowerPointWebEditor.Infrared.IIdeasContext").ma().na(()=>new $k(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1166,"PowerPointWebEditor.IFixItManager").ma().na(()=>new Gm(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));
this.K.register(1167,"PowerPointWebEditor.IFixItContext").ma().na(()=>new Yo);(this.LP=this.K.resolve("PowerPointWebEditor.IApplicationContext").td.Mg)&&this.K.register(Jk.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Jk.a(w.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(gm,"PowerPointWebEditor.Designer.ImageToTableActor").ma().na(()=>new gm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1168,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().na(()=>new Wm(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1169,"PowerPointWebEditor.Designer.IImageToTablePane").ma().na(()=>
new Jm(this.K.resolve("Common.IActionManagerExtended"),this.K.Ha("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(al,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().na(()=>new al(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const v=this.K.resolve("Common.IAppSettingsManager");v.Ue(()=>{if(v.getBooleanAppSetting("248")){this.LP&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var S=this.K.resolve("PowerPointWebEditor.IDesignerView");const ma=C.a.instance.resolve("PowerPointWebEditor.IDesignerPane").va;S.tEa(ma);S.Ddc();S=null;if(v.getBooleanAppSetting("1034")&&(S=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Ja=new Date;S.vH(v.Ea("1043"),
v.Ea("1035")).then(Va=>{const wb=+new Date-+Ja;Va.IsSuccess?Q.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+wb):(Q.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Va.ErrorCode+": "+Va.ErrorMessage),Q.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+wb))}).catch(Va=>{Q.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+Ja));Q.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Va)})}S=new mh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.Ha("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),S,this.K.Ha("PowerPointWebEditor.IAgendaMetrics"),this.K.Ha("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"),this.K.resolve("PowerPointWebEditor.ICopilotEnableStateChecker"));S.qb();S.Sd();(new no(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).qb();
this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else Q.a.J(512262858,
829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Ac(Db.a(new Km,
0))}}Object(k.a)(Km,"PPTWebEditorDesignerPackage",null,[2,3]);class Bl{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PenMinutes"}fc(v){this.K=v}init(){const v=this.K.ub("Common.App.PenMinutesManager.IPenMinutesManager");v&&v.lSl()}dispose(){}static main(){e.a.instance.Ac(new Bl)}}Object(k.a)(Bl,"PPTWebEditorPenMinutesPackage",null,[2,3]);var Xj=d(947);class Xm{}Object(k.a)(Xm,"TextToSmartArtSuggestionData",null,[]);class Vl{constructor(){this.suggestions=[]}}Object(k.a)(Vl,"TextToSmartArtSuggestionNotificationData",
null,[]);class Mh{}Mh.q9e="ShapePresence";Mh.slideNavigation="SlideNavigation";Mh.cVb="WebActionId:";Mh.nW="SelectionChanged";Mh.iyc="ShapePositionChanged";Mh.Xmb="Retrigger";Mh.zSe="NoSuggestions";Mh.kFk="LowSuggestions";Mh.ond="NewSession";Mh.a3l="SlideShowStarted";Mh.hca="ServerError";Mh.EXf="ClientSuggestionTimeOut";Object(k.a)(Mh,"ReplaceObjectResetReason",null,[]);class In{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He){this.j_a=this.nIe=this.ahb=!1;this.oa=v;this.Fa=S;this.sa=
ma;this.ic=Ja;this.yaa=Va;this.Wf=wb;this.ia=Sb;this.pA=vc;this.oKa=gd;this.qA=od;this.OKb=Ke;this.Noa=kg;this.Lid=If;this.Hc=yh;this.yK=df;this.zb=bg;this.Db=ih;this.mv=Vd;this.MZa=He;this.Bs=!1}get Sh(){return this.Bs}setup(){this.Sh||(this.ps(),this.nIe=2===this.Db.mode,this.Bs=!0)}ps(){this.oa.AG(Object(r.a)(this,this.oE,"onSelectionChanged"));this.OKb.$2b(Object(r.a)(this,this.LQe,"markedUndo"));this.Wf.HJ(Object(r.a)(this,this.XC,"onActiveSlideChanged"));this.Noa.E9a(Object(r.a)(this,this.J2,
"onSlidePresenceChanged"));this.Hc.yzi(Object(r.a)(this,this.xVe,"onReplaceObjectResponse"));this.oKa.zzi(Object(r.a)(this,this.yVe,"onReplaceObjectViewDragEnd"));this.yaa.a3b(Object(r.a)(this,this.sTe,"onApplyReplaceObjectBlockingStateChanged"));this.Wf.XZd(Object(r.a)(this,this.NBc,"updateEditState"));this.Db.QH(Object(r.a)(this,this.St,"onAppFrameModeSwitched"));this.Hc.CLf(Object(r.a)(this,this.hlh,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Hc.BLf(Object(r.a)(this,this.glh,
"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Hc.tOc(Object(r.a)(this,this.Vpa,"onUndoRedo"))}dispose(){this.Sh&&(this.oa.Xza(Object(r.a)(this,this.oE,"onSelectionChanged")),this.OKb.j3e(Object(r.a)(this,this.LQe,"markedUndo")),this.Wf.E7(Object(r.a)(this,this.XC,"onActiveSlideChanged")),this.Noa.D3e(Object(r.a)(this,this.J2,"onSlidePresenceChanged")),this.Hc.MBl(Object(r.a)(this,this.xVe,"onReplaceObjectResponse")),this.oKa.NBl(Object(r.a)(this,this.yVe,"onReplaceObjectViewDragEnd")),
this.yaa.ovd(Object(r.a)(this,this.sTe,"onApplyReplaceObjectBlockingStateChanged")),this.Db.a_(Object(r.a)(this,this.St,"onAppFrameModeSwitched")),this.Wf.n3e(Object(r.a)(this,this.NBc,"updateEditState")),this.Hc.MDh(Object(r.a)(this,this.hlh,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Hc.LDh(Object(r.a)(this,this.glh,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Hc.tvd(Object(r.a)(this,this.Vpa,"onUndoRedo")),this.Bs=!1)}M3a(v){return this.hve()?this.Lid.tCc(v):!1}selectShape(v){v&&
this.oa.selectShape(v,!1)}u7c(v){switch(v){case $a.a.KSa:case $a.a.SRe:case $a.a.aqc:case $a.a.bqc:case $a.a.cqc:case $a.a.dqc:case $a.a.mLa:return!0;default:return!1}}hve(){return this.ahb&&this.nIe}jth(v,S){const ma=[];if(hc.a.Ta(v))return ma;v=v.split(";");if(v.length<S)return Q.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",S,v.length),ma;for(let Ja=0;Ja<S;++Ja){const Va=v[Ja].split(":");if(3!==Va.length)throw S=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",
Ja,v[Ja]),Q.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",S),Error.create(S);const wb=Xj.a.EPj(Number.parseInvariant(Va[1]));Array.add(ma,Object.assign(new Xm,{index:Va[0],labelText:hc.a.Ta(wb)?ResourceStrings.L_SmartArt:wb,imageData:this.t0c(Va[2])}))}return ma}hlh(){this.j_a=!0}glh(){this.j_a=!1}Vpa(v,S){this.JR(S.actionId)}t0c(v){return hc.a.Ta(v)?null:"data:image/png;base64,"+v}St(v){Q.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",
v.mode);this.nIe=2===v.mode}NBc(){this.ahb||Q.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");this.ahb=!0}RLb(v,S,ma,Ja){this.MZa.execute(Va=>{const wb=Object.assign(new Vl,{correlationId:v,shapeId:S,suggestions:ma});Va.notifyTextToSmartArtSuggestion(Ja,wb)})}mtg(v,S,ma){if(S.mF)if(S.Z$&&0!==v.WMa)Q.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",v.WMa);else{if(0===v.WMa){if(0>=v.cga){Q.a.J(38115482,
829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",v.correlationId);this.closeSession(S,Mh.zSe);return}if(v.cga<ma.replaceObjectMinRequiredSuggestions){Q.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",v.correlationId);this.closeSession(S,Mh.kFk);return}S.Z$=!1;S.suggestions=this.jth(v.xFa,v.cga);S.suggestionCount=v.cga;Q.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",S.suggestionCount,
v.correlationId)}else if(1===v.WMa){if(hc.a.Ta(v.xFa)){Q.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",v.correlationId);return}S.suggestions=this.jth(v.xFa,v.cga);S.uTb=new Date;ma.powerPointIdeasIsEnabled&&this.RLb(v.correlationId,S.shapeId,S.suggestions,xl.a.success)}else 2===v.WMa&&(S.Hye=!1,S.shapeId=v.shapeId,this.RLb(S.correlationId,v.shapeId,S.suggestions,xl.a.success));ma=S.shape;S.slide&&S.slide.isConnected&&ma&&ma.isConnected&&this.mv.eIa(ma)&&
this.hve()&&(1===v.WMa?this.qA.FBh(S.correlationId):this.qA.VAd(ma))}else Q.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",v.correlationId)}}Object(k.a)(In,"BaseReplaceObjectManager",null,[1123,1174]);class Cl{}Cl.none="";Cl.iyc="ShapePositionChanged";Object(k.a)(Cl,"ReplaceObjectRetriggerReason",null,[]);class Dl{}Dl.selectShape="SelectShape";Dl.Xmb="Retrigger";Dl.XGi="AugLoopRetrigger";Dl.WGi="AugLoopDefault";Object(k.a)(Dl,"ReplaceObjectTrigger",
null,[]);var Do=d(517);class qo extends In{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He,$m,Ck,cl,Nk){super(vc,ma,Ja,Va,wb,Sb,gd,od,Vd,Ke,kg,yh,df,bg,ih,$m,Ck,cl,Nk);this.tV=v;this.Mad=S;this.SQk=If;this.ka=He;this.w$g=this.ka.replaceObjectGrayFloatieInTyping}ps(){this.ka.replaceObjectUseClientAL?this.Mad.execute(v=>{v.addEventHandler("ShapeTextConvertable",Object(r.a)(this,this.xxh,"processShapeTextConvertibleClientAL"))}):this.tV.execute(v=>{v.addEventHandler("ShapeTextConvertable",
Object(r.a)(this,this.WZe,"processShapeTextConvertible"))});this.Hc.RAi(Object(r.a)(this,this.cqd,"onSlideShowStarted"));super.ps()}dispose(){this.Sh&&(this.ka.replaceObjectUseClientAL?this.Mad.execute(v=>{v.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.xxh,"processShapeTextConvertibleClientAL"))}):this.tV.execute(v=>{v.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.WZe,"processShapeTextConvertible"))}),this.Hc.GCl(Object(r.a)(this,this.cqd,"onSlideShowStarted")));
super.dispose()}WZe(v,S){if(v&&S){try{var ma=Ag.a(v);var Ja=Ag.a(S)}catch(wb){Q.a.J(508692432,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(ma&&!isNaN(ma.sid)&&!isNaN(ma.cid)&&!isNaN(ma.shapeId)&&this.sa.Aa&&(v=new Date(ma.c),Q.a.J(508692431,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",ma.sid,ma.cid,ma.shapeId,ma.t,ma.c?(new Date).getTime()-ma.c:-1),(S=this.sa.Aa.ER(ma.shapeId))&&(pf.a.contains(this.aog(),
S.get_shapeId())||"activeSlideChanged"===ma.t)))if(Ja&&!Ja.isTextConvertible)this.qA.vqa(S,!0);else{var Va=this.pA.Vac(S.get_shapeId());if(Va&&Va.Zea&&(Va=new Do.a(S,Va.Via),this.ia.Ia($a.a.Tlb,2,Va),!Va.ewa))return;this.M3a(S)&&this.oma(this.sa.Aa,S,Ja&&Ja.smartArtInfo?Ja.smartArtInfo.length:0,ma.t||Dl.WGi,Cl.none,v)}}}xxh(v,S,ma,Ja){S&&Ja&&Ja.ContextId&&Ja.Payload&&this.WZe(Ja.ContextId,Ja.Payload)}cqd(){this.m5d(Mh.a3l)}oE(v,S){if(!this.Sh)Q.a.J(508692430,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.j_a&&(S.LF.length||!this.Fa.Je||this.Fa.Je.name!==dd.a.Ag)){v=this.aog();for(const ma of this.pA)ma.mF&&!Array.contains(v,ma.shapeId)&&this.closeSession(ma,Mh.nW);this.w$g&&!Array.contains(v,this.qA.fCb)&&this.qA.lzl()}}yVe(v,S){this.Sh?(v=this.pA.Vac(S.shape.get_shapeId()))&&v.mF&&(S=v.shape,this.closeSession(v,Mh.iyc),this.M3a(S)&&this.oma(this.sa.Aa,S,0,Dl.XGi,Cl.iyc)):Q.a.J(508692429,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}LQe(v,
S){S.iEb&&this.JR(S.actionId)}XC(){this.m5d(Mh.slideNavigation)}J2(v,S){if(S.F$&&S.shapes)for(const ma of S.shapes)(v=this.pA.Vac(ma))&&v.mF&&this.closeSession(v,Mh.q9e)}xVe(v,S){(v=this.pA.Hcb(S.correlationId))?this.mtg(S,v,this.ka):Q.a.J(508692428,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",S.correlationId)}sTe(){if(this.Sh)for(const v of this.pA)v.peb&&0===v.suggestionType&&!this.ic.Xc(this.sa.presentation)&&(v.peb=!1,this.qA.vqa(v.shape,
!0))}M3a(v){const S=this.pA.hJf;return 1<=S?(Q.a.J(508692427,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",S),!1):super.M3a(v)}oma(v,S,ma,Ja,Va,wb=null){try{let Sb=this.pA.Vac(S.get_shapeId());Sb&&this.closeSession(Sb,Mh.ond);Sb=this.pA.UTc(v,S.get_shapeId(),Ja,Va,this.ka);Sb.KAc=wb;Sb.Zea="richEditTextUnicodeChanged"===Ja;this.qA.KBc(Sb.correlationId);const vc=this.SQk.AKh(Sb);Q.a.J(508692426,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",
Sb.correlationId,Sb.slide.sid,Sb.slide.cid,Sb.shapeId,vc);Q.a.J(508692425,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",Sb.correlationId,ma,Math.min(ma,this.ka.replaceObjectSuggestionMaxCount),Ja);ma&&this.ka.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(ma=Math.min(ma,this.ka.replaceObjectSuggestionMaxCount),Sb.suggestions=this.Jsj(ma),
Sb.suggestionCount=ma,Sb.Z$=!1,this.qA.VAd(S));0===vc&&this.ka.powerPointIdeasIsEnabled&&this.RLb(Sb.correlationId,Sb.shapeId,[],xl.a.pending)}catch(Sb){Q.a.J(508692424,829,10,"GenerateSuggestion failed!! {0} ",Sb.message)}}Jsj(v){const S=Array(v);for(let ma=0;ma<v;ma++)Array.add(S,Object.assign(new Xm,{index:ma.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return S}JR(v){this.Sh?this.u7c(v)||this.m5d(Mh.cVb+this.yK.H7(v)):Q.a.J(508692423,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}NXl(v){if(!this.w$g)return!1;
const S=this.oa.Hd();return v.Zea&&Array.contains(S,v.shape)}closeSession(v,S){0===v.suggestionType&&(S===Mh.zSe?this.qA.vqa(v.shape,!0):v.Zea&&this.qA.vqa(v.shape,!0,S!==Mh.ond,this.NXl(v)),this.pA.O5c(v,S),this.ka.powerPointIdeasIsEnabled&&this.RLb(v.correlationId,v.shapeId,v.suggestions,xl.a.qLa))}m5d(v){for(const S of this.pA)this.closeSession(S,v)}aog(){const v=this.oa.Hd(),S=[];v&&v.forEach(ma=>{Array.add(S,ma.get_shapeId())});return S}}Object(k.a)(qo,"AugmentationLoopReplaceObjectManager",
In,[]);class Be{constructor(v,S){this.disabled=!1;this.SZg=md.App.Xn;this.ka=v;this.zb=S}MLh(v){this.disabled=!0;this.SZg=new Date;const S=new W.a(2,1,this.ka.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.SZg>=this.ka.replaceObjectGrayFloatieTimeoutInMilliSeconds&&v()});this.zb.Jb(S)}FQl(v){const S=new W.a(2,1,550,()=>{v()});this.zb.Jb(S)}static Flm(v,S){return 7<=v&&8>=v&&1!==S}}Object(k.a)(Be,"FlyoutAnchorTimer",null,[]);var Lm=d(373);class Ii{constructor(v,S,
ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh){this.Jt=null;this.j_a=!1;this.Hc=S;this.oa=v;this.pA=ma;this.sa=Ja;this.Ga=Va;this.ka=wb;this.qA=Sb;this.Qi=vc;this.mv=gd;this.Noa=od;this.yaa=Vd;this.EZa=Ke;this.Zoc=kg;this.yK=If;this.rc=yh}ps(){this.Hc.bzi(Object(r.a)(this,this.mnh,"onIconSuggestionNotification"));this.oa.AG(Object(r.a)(this,this.oE,"onSelectionChanged"));this.Hc.CLf(Object(r.a)(this,this.flh,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Hc.BLf(Object(r.a)(this,this.elh,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));
this.Hc.azi(Object(r.a)(this,this.lnh,"onIconChanged"));this.Noa.E9a(Object(r.a)(this,this.J2,"onSlidePresenceChanged"));this.yaa.a3b(Object(r.a)(this,this.Gha,"onBlockingStateChanged"));this.Zoc.$2b(Object(r.a)(this,this.Hkb,"onMarkedUndo"))}Igf(){this.Hc.xBl(Object(r.a)(this,this.mnh,"onIconSuggestionNotification"));this.oa.Xza(Object(r.a)(this,this.oE,"onSelectionChanged"));this.Hc.MDh(Object(r.a)(this,this.flh,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Hc.LDh(Object(r.a)(this,
this.elh,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Hc.wBl(Object(r.a)(this,this.lnh,"onIconChanged"));this.Noa.D3e(Object(r.a)(this,this.J2,"onSlidePresenceChanged"));this.yaa.ovd(Object(r.a)(this,this.Gha,"onBlockingStateChanged"));this.Zoc.j3e(Object(r.a)(this,this.Hkb,"onMarkedUndo"))}dispose(){this.Igf()}setup(){this.ps()}flh(){this.j_a=!0}elh(){this.j_a=!1}lnh(v,S){S&&this.Jt&&this.Jt.Wwc&&this.Jt.slide.sid===S.slideId.sid&&this.Jt.slide.cid===S.slideId.cid&&this.Jt.shapeId===
S.shapeId&&this.Jt.T7===S.t_&&(this.Jt.v6e=S.iconName)}J2(v,S){if(S.F$&&S.shapes&&this.Jt)for(const ma of S.shapes)this.Jt.shapeId===ma&&this.GX(Mh.q9e)}Hkb(v,S){S.iEb&&!this.u7c(S.actionId)&&this.GX(Mh.cVb+this.yK.H7(S.actionId))}u7c(v){switch(v){case $a.a.KSa:case $a.a.SRe:case $a.a.aqc:case $a.a.bqc:case $a.a.cqc:case $a.a.dqc:case $a.a.mLa:return!0;default:return!1}}Gha(){if(this.Jt){const v=this.Jt.shape,S=this.Ga.Hs(v);v&&S&&!this.EZa.Xc(S)&&(this.Jt.peb=!1,this.qA.vqa(v,!0),this.Jt.IAc=new Date,
this.Jt.GX(Mh.nW))}}oE(){if(!this.j_a){var v=this.Ga.PVa(this.oa.Hd());if(v){if(this.Jt&&this.Jt.mF){if(Lm.a.hyc(v.jT,this.Jt.jT))return;this.GX(Mh.nW)}this.M3a(v)&&this.oma(this.sa.Aa,v,Dl.selectShape)}else this.Jt&&this.Jt.mF&&this.GX(Mh.nW)}}oma(v,S,ma){this.Jt=this.pA.UTa(v,S.get_shapeId(),ma,"",this.ka,S.get_smartArtModelId());this.Jt.Z$=!0;this.qA.KBc(this.Jt.correlationId);Q.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",
this.Jt.correlationId,this.Jt.slide.sid,this.Jt.slide.cid,this.Jt.shapeId,this.Jt.T7);const Ja=S.get_smartArtModelId()?this.Ga.Hs(S):S;Ja?this.Qi.Gsj(v.cid,v.sid,Ja.get_shapeId(),this.mv.Y1c(Ja),this.mv.X1c(Ja),S.get_smartArtModelId(),this.Jt.correlationId,ma,Object(r.a)(this,this.k6k,"onIconSuggestionResponseSuccess"),Object(r.a)(this,this.Ukb,"onTaskFailure")):Q.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",S.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}k6k(v){if(v&&v.SuggestionResult){var S=
v.CorrelationId,ma=this.pA.Hcb(S);if(ma)if(ma.mF){S=null;try{S=Sys.Serialization.JavaScriptSerializer.deserialize(v.SuggestionResult)}catch(Ja){Q.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Ja)}if(S){ma.suggestions=this.Vdl(S);ma.uTb=new Date;if(ma.Z$){if(this.tAg(ma)){Q.a.J(39184097,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",ma.I5b,this.ka.pptIconChunkingSuggestionTimeoutMs);
this.GX(Mh.EXf);return}Q.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");ma.suggestionCount=ma.suggestions?ma.suggestions.length:0;ma.Z$=!1;this.qA.VAd(ma.shape)}this.qA.FBh(ma.correlationId)}else this.GX(Mh.hca),Q.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else Q.a.J(38279315,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",
this.Jt?this.Jt.correlationId:"",S);else Q.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",S)}else this.GX(Mh.hca),Q.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}Ukb(v){this.GX(Mh.hca);Q.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",
v.HttpStatusCode);return!0}M3a(v){return this.rc.fp?v.get_smartArtModelId()&&v.get_isSVGBlipFilled()?(v=this.Ga.Hs(v),!!v&&!v.Bt):!1:!1}GX(v){this.Jt&&(this.qA.vqa(this.Jt.shape,!0),this.pA.O5c(this.Jt,v),this.Jt=null)}t0c(v){return hc.a.Ta(v)?null:v.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(v):"data:image/png;base64,"+v}Vdl(v){const S=[];if(!v||!v.length)return S;for(let ma=0;ma<v.length;++ma){const Ja=Object.assign(new Xm,{index:v[ma].Index.toString(),labelText:v[ma].Label,
imageData:this.t0c(v[ma].Render),renderData:this.t0c(v[ma].Replace)});Array.add(S,Ja)}return S}V3i(v,S){const ma=[];if(hc.a.Ta(v)||!S)return ma;for(var Ja=0;Ja<S;++Ja){var Va=Object.assign(new Xm,{index:Ja.toString(),labelText:"",imageData:null,renderData:null});Array.add(ma,Va)}v=v.split(";");if(v.length-1!==S)return Q.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",ma.length,
S),ma;for(Ja=0;Ja<S;++Ja)Va=v[Ja].indexOf(":"),0>Va?Q.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):ma[Ja].labelText=v[Ja].substr(Va+1);return ma}Udl(v){let S,ma,Ja,Va;S="";Ja=ma=0;Va=null;if(hc.a.Ta(v))return Q.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:S,cga:ma,JSe:Ja,suggestions:Va};const wb=v.split("|");if(4!==wb.length)return Q.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+v.length),{returnValue:!1,correlationId:S,cga:ma,JSe:Ja,suggestions:Va};S=wb[0];ma=parseInt(wb[1]);Ja=Number.parseInvariant(wb[2]);Va=this.V3i(wb[3],ma);return{returnValue:!0,correlationId:S,cga:ma,JSe:Ja,suggestions:Va}}mnh(v,S){let ma,Ja;if(({correlationId:v,cga:S,JSe:ma,suggestions:Ja}=this.Udl(S.xFa)).returnValue){var Va=this.pA.Hcb(v);if(Va)if(Va.mF&&Va.Z$){var wb=Va.shape;0===ma&&(0>=
S?(Q.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",v),this.GX(Mh.zSe)):this.tAg(Va)?(Q.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Va.I5b,this.ka.pptIconChunkingSuggestionTimeoutMs),this.GX(Mh.EXf)):(Va.Z$=!1,Va.suggestionCount=S,Va.suggestions=Ja,Q.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Va.correlationId,Va.suggestionCount),this.qA.VAd(wb)))}else Q.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Jt?this.Jt.correlationId:"",v,Va.mF,Va.Z$);else Q.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",v)}else Q.a.J(38279327,829,50,
"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}tAg(v){const S=new Date,ma=v.Via,Ja=this.ka.pptIconChunkingSuggestionTimeoutMs;return S&&ma&&0<Ja&&+S-+ma>Ja?(v.I5b=+S-+ma,!0):!1}}Object(k.a)(Ii,"ReplaceIconManager",null,[]);var $o=d(717),Eo=d(1034);class Dc extends Sys.EventArgs{constructor(v){super();this.jT=v}}Object(k.a)(Dc,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class Kj{constructor(){this.shape=null;this.action=0}}Object(k.a)(Kj,
"ShowHideReplaceObjectGalleryData",null,[]);class Sj{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg){this.Bs=this.ahb=!1;this.ia=S;this.Fa=ma;this.sa=Va;this.Wf=Ja;this.ic=wb;this.pKa=Sb;this.qA=Vd;this.yb=Ke;this.Ga=kg;this.oa=v;this.Hc=vc;this.pA=gd;this.Eb=od}get Sh(){return this.Bs}setup(){this.Sh||(this.ps(),this.qb(),this.Sd(),this.Bs=!0)}dispose(){this.Sh&&(this.Igf(),this.Bs=!1)}ps(){this.Wf.XZd(Object(r.a)(this,this.NBc,"updateEditState"))}Igf(){this.Wf.n3e(Object(r.a)(this,this.NBc,"updateEditState"))}qb(){this.ia.pa($a.a.KSa,
qb.a.application,Object(r.a)(this,this.KSa,"applyReplaceObjectSuggestion"),4);this.ia.pa($a.a.S3a,qb.a.application,Object(r.a)(this,this.S3a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.pa($a.a.eSb,qb.a.application,Object(r.a)(this,this.S3a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.pa($a.a.pqc,qb.a.application,Object(r.a)(this,this.Hih,"navigateReplaceObjectSuggestion"),4);this.ia.pa($a.a.oqc,qb.a.application,Object(r.a)(this,this.Hih,"navigateReplaceObjectSuggestion"),4)}Sd(){const v=
this.Fa.Kc(dd.a.wR),S=this.Fa.Kc(dd.a.Ag),ma=this.Fa.Kc(dd.a.Jmb);v.bindAction(jb.KeyInputManager.Va(da.a.Mp,2),$a.a.eSb);S.bindAction(jb.KeyInputManager.Va(da.a.Mp,2),$a.a.eSb);ma.bindAction(jb.KeyInputManager.Va(da.a.Mp,2),$a.a.eSb);ma.bindAction(jb.KeyInputManager.Va(da.a.E_,0),$a.a.eSb);ma.bindAction(jb.KeyInputManager.Va(da.a.Rca,0),$a.a.pqc);ma.bindAction(jb.KeyInputManager.Va(da.a.eja,0),$a.a.oqc)}NBc(){this.ahb||Q.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");
this.ahb=!0}KSa(v,S,ma,Ja,Va){if(!this.Sh)return Q.a.J(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;S=this.sa.presentation;if(!this.sa.Aa||!S||this.ic.Xc(S))return 16;if(1===ma)return 32;ma=!0;Ja=null;Object(Wg.a)($o.a,Va)?Ja=Va:Object(Wg.a)(Eo.a,Va)&&(Ja=Va.vPc,ma=!1);Va=new Lm.a(P.a.Aq(Ja.ActiveSlideSid,Ja.ActiveSlideCid),Ja.ShapeId,Ja.SmartArtSubNodeId);const wb=new Dc(Va);this.pKa.kql(wb);const Sb=this.pA.Icb(Va);if(Sb&&Sb.shapeId===Ja.ShapeId){let vc=
null;1===Sb.suggestionType&&(vc=this.Ga.Hs(Sb.shape));Va=this.Eb.ud(15,void 0,()=>{1===Sb.suggestionType||this.oa.Js()||(this.Hc.$td(),this.oa.Bh(),this.Hc.Ztd())},()=>{vc&&(this.Hc.$td(),this.oa.selectShape(vc,!0),this.Hc.Ztd())});try{Va.mc(S),Va.Wc=Ja.SmartArtSubNodeId?$a.a.PVf:v,S.BPb=Ja,Sb.sPc=Ja.SuggestionSid,Sb.n0d=Ja.Label,Sb.lV=!0,Sb.JAc=new Date,Q.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ja.CorrelationId,
v,Ja.SuggestionSid)}finally{Va&&Va.dispose()}Sb.Hye=!0;Sb.peb=!0;ma&&Sb.JQe();0===Sb.suggestionType?this.ic.mx(S,v):vc?this.ic.Kta(S,vc,this.yb.Na,v):Q.a.J(38854750,808,15,"Invalid smartArtShape")}else Q.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}S3a(v,S,ma,Ja,Va){if(!this.Sh)return Q.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;S=this.sa.presentation;if(!this.sa.Aa||!S||this.ic.Xc(S))return 16;if(1===ma)return 32;
ma=null;S=0;if(v===$a.a.S3a){v=Object(N.a)(Kj,Va);if(!v)return 16;ma=v.shape;S=v.action}else if(v===$a.a.eSb){v=this.oa.Hd();if(1!==v.length)return 32;ma=v[0]}if(!ma)return Q.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;v=this.pA.Icb(ma.jT);if(!v||!this.ahb&&v&&0===v.suggestionType)return 2;if(v&&v.mF&&v.shapeId===ma.get_shapeId())switch(this.oa.uj(),this.Fa.Gd(),S){case 0:this.qA.wam(v.correlationId);break;case 1:this.qA.QC.isVisible||this.qA.zaf(v.correlationId);
break;case 2:this.qA.moe(ma)}return 32}Hih(v,S,ma){if(!this.Sh)return Q.a.J(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;S=this.sa.presentation;return this.sa.Aa&&S&&!this.ic.Xc(S)?1===ma?32:this.qA.QC.isVisible?v===$a.a.pqc?(this.qA.pqc(),32):v===$a.a.oqc?(this.qA.oqc(),32):16:16:16}}Object(k.a)(Sj,"ReplaceObjectActor",null,[]);class un{constructor(v,S){this.VP=v;this.Nad=S}initialize(){this.VP.execute(v=>{v.registerSimpleRemoteWorkflow(this.Nad.xH,
this.Nad.uwb,this.Nad.kPb,this.Nad.Ivb)})}}Object(k.a)(un,"ReplaceObjectAugLoopRuntimeManager",null,[]);var nk=d(1134),Bf;(function(v){v[v.textToSmartArt=0]="textToSmartArt";v[v.iconChunking=1]="iconChunking"})(Bf||(Bf={}));Object(k.b)("ReplaceObjectType",Bf);class Fo{constructor(v,S){this.C8a=this.YT=this.ka=null;this.shapeId=0;this.T7=null;this.suggestionType=0;this.Zea=!1;this.sPc=0;this.n0d=null;this.Lve=this.zve=this.peb=this.lV=!1;this.IAc=this.JAc=this.zef=this.uTb=this.NAc=this.yOa=this.KAc=
this.Via=null;this.hAb=this.Hzc=0;this.fUd=this.c9a=this.$ra=null;this.Z$=!1;this.suggestions=null;this.I5b=this.suggestionCount=0;this.Hye=!1;this.jnb=null;this.Wwc=!1;this.v6e=null;this.bPd=!1;this.BJb=[];this.Qi=v;this.hjc=S;this.reset()}UTa(v,S,ma,Ja,Va,wb){this.mF&&this.GX(Mh.ond);if(!v)throw Error.argumentNull("slide");const Sb=v.QBb(new Lm.a(v?v.Fb:null,S,wb));if(!Sb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",S));this.YT=v;this.C8a=Sb;
this.shapeId=S;this.T7=wb;this.$ra=yb.a.create().toString();this.bPd=!0;this.c9a=ma;this.fUd=Ja;this.ka=Va;this.Via=new Date;this.suggestionType=this.uOj();return this.correlationId}UTc(v,S,ma,Ja,Va){return this.UTa(v,S,ma,Ja,Va,null)}uOj(){const v=this.shape;return this.ka.iconChunkingEnabled&&v&&this.T7&&v.get_isSVGBlipFilled()?1:0}GX(v){if(this.mF&&!this.rok(this.correlationId)){const S={};S.SuggestionCount=this.suggestionCount;S.ClientSuggestionTimeoutInMs=this.I5b;S.IsApplied=this.lV;S.AppliedSuggestionId=
this.lV?this.sPc.toString():"";S.AppliedSuggestionLabel=this.lV?this.n0d:"";S.IsFloatieShown=this.zve;S.IsGalleryShown=this.Lve;S.Trigger=this.trigger;S.RetriggerReason=this.f5e;S.ResetReason=v;S.IconId=this.ka.replaceObjectIconType;S.SlideCID=this.slide.cid;S.SlideSID=this.slide.sid;S.ShapeID=this.shapeId;S.AnimId=this.ka.replaceObjectAnimId;S.AnimEnabled=this.ka.APb;S.GalleryHoverEnabled=this.ka.replaceObjectGalleryHoverEnabled;S.ReplaceSuggestionType=Bf[this.suggestionType];S.SeeMoreButtonClicked=
this.Wwc;S.SeeMoreIconName=this.Wwc?this.v6e:"";this.Via&&(S.SessionLiveTimeInMs=+new Date-+this.Via);this.T7&&(S.SmartArtSubNodeId=this.T7);this.yOa&&this.uTb&&this.uTb>this.yOa&&(S.SuggestionsReadyInMs=+this.uTb-+this.yOa);0<this.Hzc&&(S.SuggestionsDisplayedForMs=this.Hzc);0<this.hAb&&(S.FloatieDisplayedForMs=this.hAb);this.yOa&&this.Via&&this.yOa>this.Via&&(S.FloatieReadyInMs=+this.yOa-+this.Via);this.Via&&this.KAc&&this.Via>this.KAc&&(S.TriggeredByAugLoopInMs=+this.Via-+this.KAc);this.JAc&&this.IAc&&
this.IAc>this.JAc&&(S.SuggestionAppliedInMs=+this.IAc-+this.JAc);if(0<this.suggestions.length){v=[];for(let ma=0;ma<this.suggestions.length;ma++)Array.add(v,this.suggestions[ma].labelText);S.SuggestionLabels=Ab.c(v)}1!==this.suggestionType||hc.a.Ta(this.jnb)||(v=nk.a.Mcb(this.jnb))&&v.hasChildNodes()&&(nk.a.U8b(),nk.a.ryl(this.jnb));this.Qi.JEl(this.correlationId,Ab.c(S),Object(r.a)(this,this.Wqc,"onFailureCallback"));this.XVk(this.correlationId)}this.reset()}reset(){this.bPd=!1;this.YT=null;this.Hye=
this.Lve=this.zve=this.peb=this.lV=this.Zea=!1;this.fUd=this.c9a=this.$ra="";this.suggestions=[];this.sPc=0;this.n0d="";this.Z$=!1;this.I5b=this.suggestionCount=0;this.IAc=this.JAc=this.zef=this.uTb=this.NAc=this.yOa=this.KAc=this.Via=null;this.suggestionType=this.hAb=this.Hzc=0;this.jnb="";this.C8a=null;this.Wwc=!1;this.v6e=""}rok(v){return this.BJb?Array.contains(this.BJb,v):!1}XVk(v){this.BJb&&!Array.contains(this.BJb,v)&&(Array.add(this.BJb,v),Q.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",
v,this.BJb.length))}Wqc(v){Q.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",v.HttpStatusCode);return!0}JQe(){this.jgh(2,4)}cWk(){this.jgh(3,3)}jgh(v,S){this.hjc&&this.hjc.execute(ma=>{const Ja=Object.assign(new Al.a,{cardId:ao.a.lTh,actionType:v,actionEngagement:S});ma.Lnd(Ja)})}get slide(){return this.YT}get shape(){return this.C8a}get correlationId(){return this.$ra}get trigger(){return this.c9a}get f5e(){return this.fUd}get mF(){return this.bPd}get appSettings(){return this.ka}get jT(){return new Lm.a(this.slide?
this.slide.Fb:null,this.shapeId,this.T7)}}Object(k.a)(Fo,"ReplaceObjectContext",null,[1221]);class Go{constructor(){this.ua=new xd.a}kql(v){this.ua.raiseEvent("ReplaceObjectBSA",v)}Byi(v){this.ua.addHandler("ReplaceObjectBSA",v)}gBl(v){this.ua.removeHandler("ReplaceObjectBSA",v)}Fzh(v){this.ua.raiseEvent("ReplaceObjectSPOver",v)}oAi(v){this.ua.addHandler("ReplaceObjectSPOver",v)}kCl(v){this.ua.removeHandler("ReplaceObjectSPOver",v)}Ezh(v){this.ua.raiseEvent("ReplaceObjectSPOut",v)}nAi(v){this.ua.addHandler("ReplaceObjectSPOut",
v)}jCl(v){this.ua.removeHandler("ReplaceObjectSPOut",v)}oql(v){this.ua.raiseEvent("ReplaceObjectViewDE",v)}zzi(v){this.ua.addHandler("ReplaceObjectViewDE",v)}NBl(v){this.ua.removeHandler("ReplaceObjectViewDE",v)}}Object(k.a)(Go,"ReplaceObjectEventSource",null,[1218,1219,1220]);class eo extends In{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg,ih,He,$m,Ck){super(wb,v,S,ma,Ja,Va,Sb,vc,gd,od,Vd,kg,If,yh,df,ih,He,$m,Ck);this.Ri=vc.kjg();this.Qi=Ke;this.ka=bg}oE(v,S){if(!this.Sh)Q.a.J(25306451,
829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.j_a&&S.LF.length)if(v=this.oa.Hd(),1!==v.length)this.Ri.mF&&this.closeSession(this.Ri,Mh.nW);else{v=v[0];if(this.Ri.mF){if(this.Ri.shapeId===v.get_shapeId())return;this.closeSession(this.Ri,Mh.nW)}this.M3a(v)&&this.oma(this.sa.Aa,v,Dl.selectShape,"")}}yVe(v,S){this.Sh?this.Ri.mF&&this.Ri.shape===S.shape&&(v=this.Ri.shape,this.closeSession(this.Ri,Mh.iyc),this.M3a(v)&&this.oma(this.sa.Aa,v,Dl.Xmb,Cl.iyc)):Q.a.J(25306453,
829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}LQe(v,S){S.iEb&&this.JR(S.actionId)}XC(){this.Ri.mF&&this.closeSession(this.Ri,Mh.slideNavigation)}J2(v,S){this.Ri.mF&&S.F$&&S.shapes&&Array.contains(S.shapes,this.Ri.shapeId)&&this.closeSession(this.Ri,Mh.q9e)}xVe(v,S){S.correlationId!==this.Ri.correlationId?Q.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Ri.correlationId,S.correlationId):
this.mtg(S,this.Ri,this.ka)}sTe(){this.Sh&&this.Ri.peb&&0===this.Ri.suggestionType&&!this.ic.Xc(this.sa.presentation)&&(this.Ri.peb=!1,this.qA.vqa(this.Ri.shape,!0))}oma(v,S,ma,Ja=""){try{const Va=this.Ri.UTc(v,S.get_shapeId(),ma,Ja,this.ka);this.Ri.Z$=!0;this.qA.KBc(this.Ri.correlationId);this.Qi.rfg(v.cid,v.sid,S.get_shapeId(),Va,ma,this.mv.Y1c(S),this.mv.X1c(S),void 0,Object(r.a)(this,this.Ukb,"onTaskFailure"));this.ka.powerPointIdeasIsEnabled&&this.RLb(Va,this.Ri.shapeId,this.Ri.suggestions,xl.a.pending)}catch(Va){Q.a.J(34152532,
829,15,"GenerateSuggestion failed!! {0} ",Va.message)}}Ukb(v){Q.a.J(36966422,829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",v.HttpStatusCode);return!0}JR(v){this.Sh?this.Ri.mF&&!this.u7c(v)&&this.closeSession(this.Ri,Mh.cVb+this.yK.H7(v)):Q.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(v,S){v.Zea&&this.qA.vqa(v.shape,!0);v.GX(S);this.ka.powerPointIdeasIsEnabled&&this.RLb(v.correlationId,v.shapeId,
v.suggestions,xl.a.qLa)}}Object(k.a)(eo,"ReplaceObjectManager",In,[]);var vn=d(1);class ap{constructor(v){this.IP=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.UBe=Array.clone(v)}get_current(){if(-1===this.IP||this.IP>=this.UBe.length)throw Error.invalidOperation();return this.UBe[this.IP]}moveNext(){this.IP++;return this.IP<this.UBe.length}reset(){this.IP=-1}}Object(k.a)(ap,"ArrayEnumerator",null,[265]);class hm{constructor(v){this.nKa=[];this.$$ge=this.getEnumerator;
this.PQk=v}getEnumerator(){return new ap(this.nKa)}[Symbol.iterator](){return Object(vn.a)(this.getEnumerator())}O5c(v,S){v&&(v.GX(S),Array.remove(this.nKa,v))}Hcb(v){for(const S of this.nKa)if(S.correlationId===v)return S;return null}Icb(v){for(const S of this.nKa)if(Lm.a.hyc(v,S.jT))return S;return null}yng(v,S){for(const ma of this.nKa)if(ma.shapeId===v&&(!S&&!ma.T7||S&&S===ma.T7))return ma;return null}Vac(v){return this.yng(v,null)}kjg(){return 0<this.nKa.length?this.nKa[0]:null}UTa(v,S,ma,Ja,
Va,wb){let Sb=this.Icb(new Lm.a(v.Fb,S,wb));Sb&&this.O5c(Sb,Mh.ond);Sb=this.PQk(v,S,ma,Ja,Va,wb);Array.add(this.nKa,Sb);return Sb}UTc(v,S,ma,Ja,Va){return this.UTa(v,S,ma,Ja,Va,null)}get hJf(){let v=0;this.nKa.forEach(S=>{S.mF&&v++});return v}}Object(k.a)(hm,"ReplaceObjectMultipleContextManager",null,[1122,259]);class fk{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od){this.sa=v;this.E$g=S;this.TQk=ma;this.mv=wb;this.oKa=Va;this.pA=Ja;this.QC=Sb;this.Fa=vc;this.gf=gd;this.Ga=od;this.Bs=!1;this.vGc=-1}get Sh(){return this.Bs}get fCb(){return this.vGc}setup(){this.Sh||
(this.oKa.Byi(Object(r.a)(this,this.tlh,"onBeforeReplaceObjectSuggestionApply")),this.oKa.oAi(Object(r.a)(this,this.dph,"onReplaceObjectSuggestionPointerOver")),this.oKa.nAi(Object(r.a)(this,this.cph,"onReplaceObjectSuggestionPointerOut")),this.Bs=!0)}dispose(){this.Sh&&(this.oKa.gBl(Object(r.a)(this,this.tlh,"onBeforeReplaceObjectSuggestionApply")),this.oKa.kCl(Object(r.a)(this,this.dph,"onReplaceObjectSuggestionPointerOver")),this.oKa.jCl(Object(r.a)(this,this.cph,"onReplaceObjectSuggestionPointerOut")),
this.Bs=!1)}tlh(v,S){if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");(v=this.sa.Aa.QBb(S.jT))&&this.vqa(v,!1)}dph(v,S){this.sa.Aa&&(v=new Lm.a(this.sa.Aa.Fb,S.shapeId,S.t_),(v=this.sa.Aa.QBb(v))&&this.yaf(v,S.Jwg))}cph(v,S){this.sa.Aa&&(v=new Lm.a(this.sa.Aa.Fb,S.shapeId,S.t_),(v=this.sa.Aa.QBb(v))&&this.Tcc(v))}yaf(v,S){let ma=v;v.get_smartArtModelId()&&(ma=this.Ga.Hs(v));if(v=this.spg(ma))this.MRh(ma,!1),v.yaf(S)}Tcc(v){let S=v;v.get_smartArtModelId()&&(S=this.Ga.Hs(v));if(v=this.spg(S))this.MRh(S,
!0),v.Tcc()}spg(v){return v&&!v.get_smartArtModelId()&&Object(N.a)(178,v.sc(this.gf))?this.TQk.$J(v):null}cij(v){return v&&Object(N.a)(178,v.sc(this.gf))?this.E$g.$J(v):null}Zje(v){return v&&Object(N.a)(178,v.sc(this.gf))?this.E$g.dK(v):null}VAd(v){if(!this.Sh)Q.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(v){var S=this.cij(v);if(S){const ma=this.pA.Icb(v.jT);!ma||ma.Zea&&this.fCb!==ma.shapeId||(ma.Zea?this.fCb===ma.shapeId&&(S.AWc(),this.vGc=
-1):(this.vqa(v,!0,!(this.QC.y2a&&this.QC.isVisible&&Lm.a.hyc(v.jT,this.QC.y2a.jT))),S.display()),ma.Zea=!0)}}}lzl(){if(-1!==this.fCb&&this.sa.Aa){var v=this.sa.Aa.ER(this.fCb);v&&this.vqa(v,!0)}}vqa(v,S,ma=!0,Ja=!1){this.Sh?v&&(S&&this.Tcc(v),ma&&this.moe(v),S=this.Zje(v))&&(Ja?(S.xVc(),this.vGc=v.get_shapeId()):(this.fCb===v.get_shapeId()&&(this.vGc=-1),S.visible&&S.dismiss(),(Ja=this.pA.Icb(v.jT))&&v.get_shapeId()===Ja.shapeId&&(Ja.Zea=!1))):Q.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}KBc(v){this.QC.KBc(v)}wam(v){if(this.Sh)if(this.QC.isVisible){const S=
this.pA.Hcb(v);S&&S.mF&&S.correlationId===v&&this.Tcc(S.shape);this.moe(S.shape)}else this.zaf(v);else Q.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}moe(v){this.QC.isVisible&&this.QC.y2a&&Lm.a.hyc(this.QC.y2a.jT,v.jT)&&(this.QC.dismiss(),(v=this.Zje(this.QC.y2a.shape))&&v.root&&(v.root.style.zIndex="0"),this.Fa.qk(dd.a.Jmb,!1))}zaf(v){const S=this.pA.Hcb(v);if(S&&S.correlationId===v&&S.mF){var ma=this.Zje(S.shape);if(ma){var Ja=ma.root;Ja?this.QC.isVisible&&
this.QC.y2a&&!Lm.a.hyc(this.QC.y2a.jT,S.jT)||(Ja=this.mv.getBounds(Ja),this.QC.show(v,Ja.x,Ja.y),ma.root.style.zIndex=String(w.AFrameworkApplication.za.evb),this.Fa.qk(dd.a.Jmb,!0),S.Lve=!0):Q.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else Q.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}FBh(v){this.Sh?this.QC.isVisible&&this.zaf(v):Q.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}pqc(){if(this.Sh){var v=
this.QC.Jhe();v&&(-1===v?this.QC.Ux(0,!0):(this.QC.Ux(v,!1),this.QC.Ux(v-1,!0)))}else Q.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}oqc(){if(this.Sh){var v=this.QC.Jhe();v+1!==this.QC.pOj()&&(-1===v?this.QC.Ux(0,!0):(this.QC.Ux(v,!1),this.QC.Ux(v+1,!0)))}else Q.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}MRh(v,S){v&&(v=Object(N.a)(178,v.sc(this.gf)))&&((v=v.va)?v.ee(S):Q.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(k.a)(fk,"ReplaceObjectPresenter",null,[1174]);class wp{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.dNb=null;this.mXe=0}}Object(k.a)(wp,"TaskItem",null,[]);class fo{constructor(v,S,ma){this.Wib=[];this.Qi=v;this.mv=S;this.vNg=ma}Ynj(v,S,ma){for(let Ja=0;Ja<this.Wib.length;Ja++)if(this.Wib[Ja].slideSid===v&&this.Wib[Ja].slideCid===S&&this.Wib[Ja].shapeId===ma)return this.Wib[Ja];return null}AKh(v){var S=
this.Ynj(v.slide.sid,v.slide.cid,v.shapeId);if(S)return S.dNb=v,S.mXe++,1;const ma=Object.assign(new wp,{slideSid:v.slide.sid,slideCid:v.slide.cid,shapeId:v.shapeId,mXe:0,dNb:null});Array.add(this.Wib,ma);v.Z$=!0;S=v.correlationId;const Ja=v.slide,Va=v.shape;this.Qi.rfg(Ja.cid,Ja.sid,Va.get_shapeId(),S,v.trigger,this.vNg?this.mv.Y1c(Va):this.mv.gbc(Va),this.vNg?this.mv.X1c(Va):this.mv.fbc(Va),()=>{this.zqh(ma)},wb=>{this.zqh(ma);Q.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
wb.HttpStatusCode);return!0});return 0}zqh(v){Array.remove(this.Wib,v);v.dNb&&v.dNb.mF&&(Q.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",v.dNb.correlationId,v.mXe-1),this.AKh(v.dNb))}}Object(k.a)(fo,"ReplaceObjectRequestManager",null,[1121]);class Yp{constructor(v){this.bJe=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Tl=v}get_current(){return this.Tl}moveNext(){return this.bJe?(this.bJe=!1,!0):!1}reset(){this.bJe=
!0}}Object(k.a)(Yp,"SingleEnumerator",null,[265]);class xp{constructor(v){this.$$ge=this.getEnumerator;this.Ri=v}getEnumerator(){return new Yp(this.Ri)}[Symbol.iterator](){return Object(vn.a)(this.getEnumerator())}O5c(v,S){v&&v===this.Ri&&v.GX(S)}Hcb(){return this.Ri}Icb(){return this.Ri}Vac(){return this.Ri}yng(){return this.Ri}kjg(){return this.Ri}UTa(v,S,ma,Ja,Va,wb){this.Ri.UTa(v,S,ma,Ja,Va,wb);return this.Ri}UTc(v,S,ma,Ja,Va){return this.UTa(v,S,ma,Ja,Va,null)}get hJf(){return this.Ri.mF?1:0}}
Object(k.a)(xp,"ReplaceObjectSingleContextManager",null,[1122,259]);var kl=d(135);class Zp{constructor(v,S,ma,Ja,Va){this.cha=null;this.mKb=this.kEe=!1;this.Poa=null;this.visible=!1;this.ov=v;this.sV=S;this.saa=ma;this.mv=Va;this.Anc=Ja;this.Bs=!1}get Sh(){return this.Bs}setup(){this.Sh||(this.Poa=new Hi.a,this.cha=this.Anc.a6i(this.Poa.va),this.sV&&!this.sV.hm&&this.sV.oW&&(this.sV.oW.appendChild(this.Poa),this.ee(!1),this.mKb=!0,this.sV.vta(this,3),this.visible=this.sV.KR||this.sV.Oo),this.Bs=!0)}Cn(){Q.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}wE(){}Jq(){if(!this.Sh)return Q.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.kEe||!this.cha.Sh||!this.cha.ZO)return null;const v=ub.a.zo(this.cha.ZO.va.style.left),S=ub.a.zo(this.cha.ZO.va.style.top),ma=ub.a.zo(this.cha.ZO.va.style.width),Ja=ub.a.zo(this.cha.ZO.va.style.height);return new kl.a(new ob.a(v,S),new ob.a(v+ma,S),new ob.a(v+ma,S+
Ja),new ob.a(v,S+Ja))}aP(){return!1}Ry(){}Xz(){}setPosition(){}Pj(){this.mKb=!0;this.$s()}Kr(){this.mKb=!0;this.$s()}Tv(){this.mKb=!0;this.$s()}setZIndex(v){this.Poa&&this.Poa.xE(v)}TF(){}jF(){return null}bD(){return[]}draw(){}dispose(){this.saa();this.Sh&&(this.cha.dispose(),this.Poa.va.parentNode&&this.Poa.mr(),this.Poa=null,this.Bs=!1)}yaf(v){this.Sh?(this.uxc(v),this.$s()):Q.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}Tcc(){this.Sh?this.vTa():
Q.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}uxc(v){this.Sh?(this.cha.xNa(v),this.ee(!0)):Q.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}vTa(){this.Sh?(this.cha.dismiss(),this.ee(!1)):Q.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}$s(){if(this.kEe&&this.mKb){var v=this.mv.gbc(this.ov),S=this.mv.fbc(this.ov);this.Mh(v,S);this.Poa&&(v=
this.mv.rKj(this.ov),Gn.a.setRotation(this.Poa.va,v));this.mKb=!1}}ee(v){this.kEe=v;this.Poa.ee(v)}Mh(v,S){this.cha&&this.cha.Mh(v,S)}}Object(k.a)(Zp,"ReplaceObjectSuggestionPreviewView",null,[1182,1183,805,806,106,1174]);var mj=d(285),Ho=d(240),$p=d(1033),bp=d(1032);class cp extends Sys.EventArgs{constructor(v){super();this.shape=v}}Object(k.a)(cp,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class z{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd){this.Nbh=!1;this.bba=this.AZa=null;this.ia=Va;
this.Ye=wb;this.xd=Sb;this.pA=vc;this.pKa=gd;this.Anc=Ja;this.saa=ma;this.ov=v;this.sV=S;this.iB=!1;this.ka=od;this.tNe=Vd;this.Bs=this.visible=!1}get Sh(){return this.Bs}VAb(){return this.pA.Icb(this.ov.jT)}setup(){if(!this.Sh){var v=this.VAb();v=v?v.suggestionType:0;this.Nbh=1===v;this.bba=new Hi.a;this.AZa=this.Anc.n3i(this.bba,z.CQc,Object(r.a)(this,this.p5k,"onFlyoutAnchorClick"),Object(r.a)(this,this.q5k,"onFlyoutAnchorHover"),v);this.sV&&!this.sV.hm&&this.sV.oW&&(this.Cn(this.sV.oW),this.sV.vta(this,
3));this.Bs=!0}}AWc(){this.Sh?this.AZa&&this.AZa.AWc():Q.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}xVc(){this.Sh?this.AZa&&this.AZa.xVc():Q.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.Sh)Q.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.$s();this.AZa.show();this.visible=!0;this.CUb();var v=this.VAb();if(v){v.zve=!0;const S=new Date;v.yOa||
(v.yOa=S);v.NAc=S;Q.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",v.trigger,v.correlationId)}}}get root(){return this.Sh?this.bba.va:(Q.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.Sh){this.AZa.dismiss();this.visible=!1;var v=this.VAb();v&&(v.Zea=!1,v.NAc&&(v.hAb+=+new Date-+v.NAc,Q.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
v.hAb,v.NAc,v.trigger,v.correlationId)))}else Q.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Cn(){this.visible=!1;this.Ye.addCssClass(this.bba.va,"replaceObjectBody");document.body.appendChild(this.bba.va);this.xd.c3b(Object(r.a)(this,this.tu,"onResize"));this.$s()}wE(){}Jq(){return null}aP(){return!1}Ry(){}Xz(){}setPosition(){}Pj(){}Kr(){}Tv(){}setZIndex(){}TF(v){if(this.Sh){if(v)this.visible=!1,this.CUb();else if(this.iB){const S=new cp(this.ov);this.pKa.oql(S)}this.iB=
v}else Q.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}jF(){return null}bD(){return[]}draw(){this.Sh?this.$s():Q.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.saa();this.Sh&&(this.xd.CEh(Object(r.a)(this,this.tu,"onResize")),this.bba&&(this.bba.va.parentNode&&this.bba.mr(),this.Ye.removeCssClass(this.bba.va,"replaceObjectBody")),this.dismiss(),this.AZa.dispose(),this.bba=null,this.Bs=!1)}CUb(){this.bba.va.style.visibility=
this.visible?bc.a.visible:bc.a.hidden;const v=this.VAb();v&&(v.Zea=this.visible)}$s(){let v=null;var S=this.sV.oW;S&&(v=this.Ye.wi(S.va));v?(S=v.x-(z.CQc+10),this.Nbh&&this.sV&&this.sV.Vd&&(S=this.sV.Vd.Xd.Ve(this.ov.zy,0),S=v.x+S+10),Gn.a.Gxc(this.bba.va,1),this.bba.setPosition(1*S,v.y),this.Sgm(1*S,v.y)):Q.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}Sgm(v,S){if(this.tNe.isVisible){var ma=this.VAb(),Ja=this.tNe.y2a;Ja&&ma&&Ja.correlationId===ma.correlationId&&
this.tNe.updatePosition(v,S)}}p5k(v){if(v.xB!==Sys.UI.MouseButton.leftButton)return!1;this.ia.Ia($a.a.S3a,2,Object.assign(new Kj,{shape:this.ov,action:0}));return!0}q5k(){if(!this.ka.replaceObjectGalleryHoverEnabled)return!1;const v=this.VAb();if(v&&1===v.suggestionType)return!1;this.ia.Ia($a.a.S3a,2,Object.assign(new Kj,{shape:this.ov,action:1}));return!0}tu(v,S){this.visible&&(v=null,S&&S.sH&&(v=S.sH.gd),v&&v.Fb.equals(this.ov.slideId)&&this.$s())}}z.CQc=32;Object(k.a)(z,"ShapeReplaceObjectView",
null,[1172,1173,805,806,106,1174]);var Z=d(660),pa=d(71);class Fa{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke){this.K_a=this.Iga=this.N_a=this.a7=this.kp=null;this.tkd=0;this.DHe=-1;this.hr=this.Ri=null;this.Ye=v;this.hd=ma;this.Ts=S;this.sa=Ja;this.ia=Va;this.YG=gd;this.pKa=wb;this.pA=Sb;this.lhb=vc;this.Fa=od;this.ka=Vd;this.QRk=!Ke.Fk;this.Bs=this.Psb=!1}get Sh(){return this.Bs}get isVisible(){return this.Psb}get y2a(){return this.Ri}setup(){this.Sh||(this.kp=ub.a.we(),this.kp.setAttribute("Unselectable",
"on"),this.kp.style.position=bc.a.absolute,this.Ye.addCssClass(this.kp,"replaceObjectContainer"),this.N4e(null),document.body.appendChild(this.kp),this.NMa(),this.YG.Lfa(dd.a.Jmb,dd.a.Nj,this.kp,()=>{},()=>{},!0),this.Bs=!0)}dispose(){this.Sh&&(this.dismiss(),this.Hgf(),this.kp&&this.kp.parentNode&&this.kp.parentNode.removeChild(this.kp),this.Bs=!1)}dismiss(){this.Sh?(w.AFrameworkApplication.za.PUa(!0),this.setVisibility(!1),this.lLb.style.display=bc.a.none,this.lLb.style.zIndex="-1",this.K_a=this.Iga=
null,this.N4e(null)):Q.a.J(508692386,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(v,S,ma){if(!this.Sh)Q.a.J(508692385,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!hc.a.Ta(v)){var Ja=this.pA.Hcb(v);Ja&&Ja.correlationId===v&&Ja.mF&&!Ja.Z$&&(this.Ri=Ja,this.Ahl(v,this.Ri.suggestions),this.tkd=this.Ri.suggestionCount,this.sGh(),w.AFrameworkApplication.za.XSa(!0),this.lLb.style.zIndex=String(w.AFrameworkApplication.za.qta),this.kp.style.zIndex=
String(w.AFrameworkApplication.za.evb),this.lLb.style.visibility=bc.a.hidden,this.lLb.style.display=bc.a.block,this.lLb.style.visibility=bc.a.visible,this.ina()?this.Ye.addCssClass(this.kp,"replaceIconObjectContainer"):this.Ye.removeCssClass(this.kp,"replaceIconObjectContainer"),this.updatePosition(S,ma),this.setVisibility(!0))}}updatePosition(v,S){let ma,Ja;this.setPosition(0,0);if(this.ina()){ma=v+z.CQc+7;Ja=S;const Va=Z.a(0,0);ma+this.kp.offsetWidth>Va.width&&(ma=v+z.CQc-this.kp.offsetWidth,Ja=
S-7-this.kp.offsetHeight)}else ma=v,Ja=S-7-this.kp.offsetHeight;this.setPosition(ma,Ja)}pOj(){return this.Sh?this.tkd:(Q.a.J(508692384,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}Jhe(){return this.Sh?this.isVisible?this.kp?this.kp.querySelector(".replaceObjectSuggestionsList")?this.DHe:(Q.a.J(508692381,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(Q.a.J(508692382,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(Q.a.J(508692383,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}Ux(v,S){if(!this.Sh)Q.a.J(508692380,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>v)&&this.isVisible)if(this.kp)if(v>=this.tkd)Q.a.J(508692378,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.tkd,v);else{var ma=this.kp.querySelector(".replaceObjectSuggestionsList");
ma?(ma=ma.children)?(ma=ma[v])?S?(this.DHe=v,Jb.FocusManager.dr(ma)&&this.bSh(ma.firstChild)):(this.sGh(),Jb.FocusManager.Zcm(ma)&&this.nvg(ma.firstChild)):Q.a.J(508692375,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):Q.a.J(508692376,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):Q.a.J(508692377,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else Q.a.J(508692379,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}KBc(v){this.N_a&&(this.N_a.className="ReplaceObjectCorrelation "+v)}Ahl(v,S){this.N4e(v);if(v=this.u7i(v,S))S=this.t7i(),this.kp.appendChild(S),this.kp.appendChild(v),this.ina()&&(v=this.s7i(),this.kp.appendChild(v))}N4e(v){this.kp&&(this.a7&&(this.hd.Hb(Ha.a.click,this.a7,Object(r.a)(this,this.Knh,"onLinkClick")),this.a7=null),this.Ye.qw(this.kp),this.N_a=ub.a.we(),this.N_a.setAttribute("Unselectable",
"on"),this.N_a.className=hc.a.Ta(v)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+v,this.N_a.style.position=bc.a.absolute,this.N_a.style.display=bc.a.none,this.kp.appendChild(this.N_a),this.kp.style.zIndex="-1")}t7i(){const v=ub.a.En();v.setAttribute("Unselectable","on");this.ina()?(v.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.Ye.addCssClass(v,"replaceIconObjectContainerTitle")):(v.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.Ye.removeCssClass(v,
"replaceIconObjectContainerTitle"));this.Ye.addCssClass(v,"UIFont replaceObjectContainerTitle");return v}u7i(v,S){if(hc.a.Ta(v))return Q.a.J(508692374,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!S||!S.length)return Q.a.J(508692373,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const ma=ub.a.a7b();ma.id=v;ma.setAttribute("Unselectable","on");ma.setAttribute(na.a.Ff,na.a.XFi);
this.Ye.addCssClass(ma,"replaceObjectSuggestionsList");this.Iga||(this.Iga=new pa.a);this.K_a||(this.K_a=new pa.a);for(var Ja of S)hc.a.Ta(Ja.imageData)||this.Iga.$(Ja.index,Ja.imageData),this.ina()&&!hc.a.Ta(Ja.renderData)&&this.K_a.$(Ja.index,Ja.renderData),v=this.pKi(Ja.index,Ja.labelText),ma.appendChild(v);if(this.QRk&&0<this.K_a.count&&this.ina()&&(hc.a.Ta(this.Ri.jnb)&&(this.Ri.jnb=Ld.a.create().toString()),(Ja=nk.a.Mcb(this.Ri.jnb))&&!Ja.hasChildNodes())){Ja.style.position=bc.a.absolute;Ja.style.left=
"0px";Ja.style.top="0px";for(const Va of this.K_a.values)v=ub.a.DD(),v.src=Va,v.style.display=bc.a.block,v.style.position=bc.a.absolute,Ja.appendChild(v);nk.a.d4b()}return ma}s7i(){this.a7=ub.a.En();this.a7.setAttribute("Unselectable","on");this.a7.setAttribute("tabindex","-1");this.a7.setAttribute(na.a.Ff,na.a.g1d);this.Ye.addCssClass(this.a7,"UIFont replaceObjectContainerLink");this.ina()&&this.ka.pptSmartArtSubNodeIconChangeEnabled&&this.ka.ceb&&(this.a7.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.hd.xb(Ha.a.click,this.a7,Object(r.a)(this,this.Knh,"onLinkClick")));const v=ub.a.we();v.appendChild(this.a7);return v}NMa(){this.kp&&(this.hd.xb(Ha.a.click,this.kp,Object(r.a)(this,this.onClick,"onClick")),this.lhb.addHandler(this.kp,Ha.a.Vf,Object(r.a)(this,this.V4c,"inputKeyApplyHandler")),this.Ts.xb(Ha.a.aD,this.kp,Object(r.a)(this,this.FN,"onPointerOver")),this.Ts.xb(Ha.a.qE,this.kp,Object(r.a)(this,this.hH,"onPointerOut")))}Hgf(){this.kp&&(this.hd.Hb(Ha.a.click,this.kp,Object(r.a)(this,
this.onClick,"onClick")),this.lhb.removeHandler(this.kp,Ha.a.Vf,Object(r.a)(this,this.V4c,"inputKeyApplyHandler")),this.Ts.Hb(Ha.a.aD,this.kp,Object(r.a)(this,this.FN,"onPointerOver")),this.Ts.Hb(Ha.a.qE,this.kp,Object(r.a)(this,this.hH,"onPointerOut")))}FN(v){v=this.cle(v.Ec);this.bSh(v);return!0}hH(v){v=this.cle(v.Ec);this.nvg(v);return!0}V4c(v){if(this.isVisible&&!v.ctrlKey&&!v.altKey&&(!v.shiftKey||v.keyCode===da.a.zs&&this.ina()))if(v.keyCode===da.a.Mp||v.keyCode===da.a.fO)v.preventDefault(),
(v=this.kp.querySelector(":focus"))&&v.firstChild.click();else if(v.keyCode===da.a.zs&&this.ina()){const S=this.kp.querySelector(":focus");S&&this.a7&&(S===this.a7?(v.preventDefault(),v.stopPropagation(),this.Ux(0,!0)):S.parentNode&&S.parentNode.className&&0<=S.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(v.preventDefault(),v.stopPropagation(),this.Ux(this.Jhe(),!1),Jb.FocusManager.dr(this.a7)))}}onClick(v){if(v.xB!==Sys.UI.MouseButton.leftButton)return!1;var S=this.cle(v.Ec);if(!this.bye(S)||
!this.grk(S))return!0;v=this.$xj(S);const ma=this.ubc(S);S=this.sOj(S);hc.a.Ta(v)||hc.a.Ta(ma)||(v=Object.assign(new $o.a,{SuggestionSid:parseInt(ma),ShapeId:this.Ri.shapeId,CorrelationId:v,ActiveSlideCid:this.sa.Aa.cid,ActiveSlideSid:this.sa.Aa.sid,Label:S,SmartArtSubNodeId:this.Ri.T7?this.Ri.T7:null,ReplaceObjectType:this.Ri.suggestionType}),this.ia.Ia($a.a.KSa,2,v));return!0}Knh(){this.Ri&&(this.Ri.Wwc=!0);this.Eme();this.ia.nb($a.a.pTa,2);return!0}bSh(v){v&&this.bye(v)&&(v=this.ubc(v),hc.a.Ta(v)||
(v=this.ina()?this.K_a.Ib(v)?this.K_a.ga(v):"":this.Iga.Ib(v)?this.Iga.ga(v):"",hc.a.Ta(v)||(v=new bp.a(this.Ri.shapeId,v,this.Ri.T7),this.pKa.Fzh(v))))}nvg(v){v&&this.bye(v)&&(v=new $p.a(this.Ri.shapeId,this.Ri.T7),this.pKa.Ezh(v))}cle(v){if(!v)throw Error.argumentNull("sourceElement");return"a"===v.nodeName.toLowerCase()?v:v.parentNode}$xj(v){return v?v.parentNode.parentNode.id:null}ubc(v){if(!v)return null;v=v.id.split("_");return 2!==v.length?null:v[1]}sOj(v){return v?v.title:null}bye(v){return!!v&&
!hc.a.Ta(v.className)&&-1!==v.className.indexOf("ObjectSuggestionContainer")}grk(v){return!!v&&!hc.a.Ta(v.className)&&-1===v.className.indexOf("ReplaceObjectSuggestionLoading")}pKi(v,S){const ma=this.Iga.Ib(v);var Ja=ma?this.Iga.ga(v):Eb.a.GO(ah.a.iqa);ma||Q.a.J(508692372,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Va=ub.a.DD();Va.setAttribute("Unselectable","on");Va.src=Ja;Va.title=S;Va.setAttribute(na.a.Ff,na.a.gR);this.Ye.addCssClass(Va,"replaceObjectSuggestionThumbnail");
Ja=ub.a.zla();Ja.id="ROS_"+v;Ja.setAttribute("Unselectable","on");Ja.title=S;Ja.setAttribute(na.a.Ff,"none");let wb=this.ina()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.Ri.lV&&this.Ri.sPc.toString()===v&&(wb+="Selected");this.Ye.addCssClass(Ja,wb);ma||this.Ye.addCssClass(Ja,"ReplaceObjectSuggestionLoading");Ja.appendChild(Va);v=this.Ye.j1f();v.setAttribute("Unselectable","on");v.setAttribute("tabindex","-1");v.setAttribute(na.a.Ff,na.a.gR);v.setAttribute(na.a.Rp,
S);v.appendChild(Ja);return v}setPosition(v,S){this.Sh?(0>v&&(v=0),0>S&&(S=0),this.kp.style.left=this.Ye.Rc(v),this.kp.style.top=this.Ye.Rc(S)):Q.a.J(508692371,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(v){if(this.kp){if(this.Ri)if(v)this.Ri.zef=new Date,this.Ri.cWk();else{let S;(S=this.Ri).Hzc=S.Hzc+(+new Date-+this.Ri.zef)}this.kp.style.visibility=v?bc.a.visible:bc.a.hidden;this.Psb=v;this.Fa.qk(dd.a.Jmb,v)}}sGh(){this.DHe=-1}ina(){return!!this.Ri&&
1===this.Ri.suggestionType}get lLb(){this.hr&&"undefined"!==typeof this.hr||(this.hr=this.Ye.we(),this.hr.setAttribute("id","ModalDiv"),this.Ye.addCssClass(this.hr,"cui-modalDiv"),this.hr.setAttribute("Unselectable","on"),document.body.appendChild(this.hr),mj.a.instance.xb(Ha.a.BB,this.hr,Object(r.a)(this,this.npd,"onModalPointerDown")),mj.a.instance.xb(Ha.a.US,this.hr,Object(r.a)(this,this.opd,"onModalPointerUp")),mj.a.instance.xb(Ha.a.Qsc,this.hr,Object(r.a)(this,this.j7k,"onModalPointerMove")),
mj.a.instance.xb(Ha.a.qE,this.hr,Object(r.a)(this,this.k7k,"onModalPointerOut")),Ho.a.instance.xb(Ha.a.click,this.hr,Object(r.a)(this,this.i7k,"onModalClick")),mb.a.instance.xb(Ha.a.pLb,this.hr,Object(r.a)(this,this.eVe,"onModalMouseWheel")));return this.hr}npd(){return!0}opd(){return this.Eme()}j7k(){return!0}k7k(){return!0}i7k(){return this.Eme()}eVe(){return!0}Eme(){if(!this.Ri||!this.Ri.slide)return!0;const v=this.Ri.shape;if(!v)return!0;this.ia.Ia($a.a.S3a,2,Object.assign(new Kj,{action:2,shape:v}));
return!0}}Object(k.a)(Fa,"ReplaceObjectSuggestionsGalleryView",null,[1119,1174]);class Ma{constructor(v,S,ma,Ja){this.UQk=v;this.mv=S;this.sa=ma;this.ka=Ja}quj(v){if(!this.sa.Aa)return!1;v=this.sa.Aa.ER(v);return this.tCc(v)}tCc(v){return!(v&&v.get_shapeId()&&v.hasText&&this.mv.eIa(v))||v.get_shapeRotation()||v.Bt||v.z1||v.Xu||!this.UQk.validate(v)?!1:!0}stk(v){return!Array.contains(this.ka.replaceObjectDisabledTriggers,v)}}Object(k.a)(Ma,"ReplaceObjectValidationHelper",null,[]);class tb{constructor(v,
S,ma,Ja,Va,wb,Sb,vc,gd){this.Gw=this.V1=null;this.Bs=!1;this.Zga=v;this.hd=S;this.Ts=ma;this.F6=Ja;this.Xga=Va;this.te=Sb;this.ka=wb;this.Ufb=gd}get Sh(){return this.Bs}xVc(){this.ka.APb?this.Gw.setAttribute("Src",this.te.Ok("BLUEBOLT_Deactivated.gif")):this.Gw.style.opacity=".3";this.Ufb.MLh(Object(r.a)(this,this.dismiss,"dismiss"))}AWc(){this.ka.APb?this.Gw.setAttribute("Src",this.te.Ok("BLUEBOLT_Reactivated.gif")):this.Gw.style.opacity="initial";this.Ufb.disabled=!1}show(){this.ka.APb?this.Gw.setAttribute("Src",
this.te.Ok("BLUEBOLT_Entrance.gif")):this.Gw.setAttribute("Src",this.te.Ok("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.ka.APb?(this.Gw.setAttribute("Src",this.te.Ok("BLUEBOLT_Exit.gif")),this.Ufb.FQl(()=>{this.Zga.va.style.visibility=bc.a.hidden})):(this.Gw.setAttribute("Src",""),this.Zga.va.style.visibility=bc.a.hidden)}setup(){this.Sh||(this.Zga?(this.V1=new Hi.a,this.V1.va.style.visibility=bc.a.inherit,this.V1.va.style.position=bc.a.absolute,this.Gw=ub.a.DD(),this.Gw.setAttribute("Unselectable",
"on"),this.Gw.setAttribute(na.a.Ff,na.a.gR),this.Gw.className="gifFloatie",this.V1.va.appendChild(this.Gw),this.Zga.appendChild(this.V1),this.NMa()):Q.a.J(38072903,829,15,"parentElement is null"),this.Bs=!0)}knh(v){let S;switch(this.ka.replaceObjectIconType){case 7:S="BLUEBOLT_Hover_on.gif";break;case 8:S="BLUEBOLT_HoverWhite_On.gif";break;default:S="BLUEBOLT_Hover_on.gif"}this.Gw.setAttribute("Src",this.te.Ok(S));return this.Xga(v)}onBlur(){let v;switch(this.ka.replaceObjectIconType){case 7:v="BLUEBOLT_Hover_off.gif";
break;case 8:v="BLUEBOLT_HoverWhite_Off.gif";break;default:v="BLUEBOLT_Hover_off.gif"}this.Gw.setAttribute("Src",this.te.Ok(v));return!0}NMa(){this.F6&&this.hd.xb(Ha.a.click,this.Gw,this.F6);this.Xga&&(this.Ts.xb(Ha.a.aD,this.Gw,Object(r.a)(this,this.knh,"onHover")),this.Ts.xb(Ha.a.qE,this.Gw,Object(r.a)(this,this.onBlur,"onBlur")))}Rgf(){this.F6&&this.hd.Hb(Ha.a.click,this.Gw,this.F6);this.Xga&&(this.Ts.Hb(Ha.a.aD,this.Gw,Object(r.a)(this,this.knh,"onHover")),this.Ts.Hb(Ha.a.qE,this.Gw,Object(r.a)(this,
this.onBlur,"onBlur")))}dispose(){this.dismiss();this.Rgf();this.Bs=!1}}Object(k.a)(tb,"GifFlyoutAnchor",null,[1207,1174]);class Hb{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If){this.Gw=this.Fw=null;this.Zga=v;this.q6=S;this.eKk=ma;this.jKk=Ja;this.sUg=Ke.replaceObjectIconType;this.mMg=Ke.replaceObjectAnimId;this.nMg=Ke.APb;this.bjb=wb;this.Anc=Va;this.hd=Sb;this.Ts=vc;this.F6=gd;this.Xga=od;this.Ye=Vd;this.NSk=kg;this.Ufb=If;this.Bs=!1}get bae(){return 1===this.NSk?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.Ufb.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get Sh(){return this.Bs}setup(){this.Sh||(this.Fw=new Hi.a,this.Gw=this.Anc.$5i(),this.Fw.va.style.visibility=bc.a.inherit,this.fTa(),this.Bs=!0)}xVc(){this.Ufb.MLh(Object(r.a)(this,this.dismiss,"dismiss"));this.vTa();this.uxc();this.Fw.ZZi()||this.Fw.ot("replaceObjectGrayedFlyoutAnchor")}show(){this.Sh?this.uxc(this.nMg):Q.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}AWc(){this.Ufb.disabled=
!1;this.vTa();this.uxc();this.Fw.ymb("replaceObjectGrayedFlyoutAnchor")}uxc(v=!1){this.Sh?this.Gw.xNa(this.bCj(v),""):Q.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}bCj(v){const S=this.bjb.X0f(this.q6,this.q6,this.eKk,this.jKk,this.bae,null);this.Ye.addCssClass(this.Fw.va,"replaceObjectFlyoutAnchorBase");this.Ye.addCssClass(this.Fw.va,"replaceObjectFlyoutAnchor"+this.sUg);v&&(this.Ye.addCssClass(this.Fw.va,"replaceObjectFlyoutAnchorAnimBase"),this.Ye.addCssClass(this.Fw.va,
"replaceObjectFlyoutAnchorAnim"+this.mMg));return S}vTa(){this.Sh?(this.Gw.clear(),this.Ye.removeCssClass(this.Fw.va,"replaceObjectFlyoutAnchorBase"),this.Ye.removeCssClass(this.Fw.va,"replaceObjectFlyoutAnchor"+this.sUg),this.nMg&&(this.Ye.removeCssClass(this.Fw.va,"replaceObjectFlyoutAnchorAnimBase"),this.Ye.removeCssClass(this.Fw.va,"replaceObjectFlyoutAnchorAnim"+this.mMg))):Q.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.Sh&&(this.Rgf(),this.Fw&&
this.Fw.va.parentNode&&this.Fw.mr(),this.dismiss(),this.Gw.dispose(),this.Fw=null,this.Bs=!1)}dismiss(){this.Sh?(this.vTa(),this.Zga.va.style.visibility=bc.a.hidden):Q.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}fTa(){this.Zga?(this.Fw.va.style.width=this.Ye.Rc(this.q6),this.Fw.va.style.height=this.Ye.Rc(this.q6),this.Fw.va.setAttribute(na.a.Ff,na.a.jx),this.Zga.appendChild(this.Fw),this.Gw.fTa(this.Fw.va),this.NMa()):Q.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Dkb(){return!0}NMa(){this.F6&&
this.hd.xb(Ha.a.click,this.Fw.va,this.F6);this.hd.xb(Ha.a.doubleClick,this.Fw.va,Object(r.a)(this,this.Dkb,"onDoubleClick"));this.Xga&&(this.Ts.xb(Ha.a.aD,this.Fw.va,this.Xga),this.Ts.xb(Ha.a.aD,this.Fw.va.firstChild,this.Xga),this.Ts.xb(Ha.a.aD,this.Fw.va.firstChild.firstChild,this.Xga))}Rgf(){this.F6&&this.hd.Hb(Ha.a.click,this.Fw.va,this.F6);this.hd.Hb(Ha.a.doubleClick,this.Fw.va,Object(r.a)(this,this.Dkb,"onDoubleClick"));this.Xga&&(this.Ts.Hb(Ha.a.aD,this.Fw.va,this.Xga),this.Ts.Hb(Ha.a.aD,this.Fw.va.firstChild,
this.Xga),this.Ts.Hb(Ha.a.aD,this.Fw.va.firstChild.firstChild,this.Xga))}}Object(k.a)(Hb,"ReplaceObjectFlyoutAnchor",null,[1207,1174]);class rc{constructor(v,S){this.GA=null;this.ul=v;this.Ye=S;this.Bs=!1}get Sh(){return this.Bs}get ZO(){return this.GA}setup(){this.Sh||(this.GA=new Hi.a,this.fTa(),this.Bs=!0)}fTa(){this.ul?(this.ul.appendChild(this.ZO.va),this.Ye.addCssClass(this.ZO.va,"replaceObjectPreviewContainer"),this.ZO.setVisibility(!1)):Q.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}xNa(v){if(this.Sh){if(v=
this.Bla(v))this.t2a(),this.ZO.va.appendChild(v),this.ZO.setVisibility(!0)}else Q.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}Mh(v,S){this.Sh?this.ZO.Mh(v,S):Q.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.Sh&&(this.dismiss(),this.ZO&&this.ZO.va.parentNode&&(this.ZO.mr(),this.Ye.removeCssClass(this.ZO.va,"replaceObjectPreviewContainer")),this.GA=null)}dismiss(){this.Sh?(this.t2a(),this.ZO.setVisibility(!1)):
Q.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}Bla(v){if(!hc.a.Ta(v)){const S=ub.a.DD();S.setAttribute("Unselectable","on");S.src=v;S.style.height="100%";S.style.width="100%";return S}return null}t2a(){this.ZO.va.firstChild&&this.ZO.va.removeChild(this.ZO.va.firstChild)}}Object(k.a)(rc,"ReplaceObjectPreviewImageView",null,[1174]);var yc=d(1006);class xc{constructor(v,S,ma,Ja,Va,wb,Sb){this.hd=v;this.Ts=S;this.Ye=ma;this.bjb=Ja;this.ka=Va;this.te=wb;this.zSg=
Sb}n3i(v,S,ma,Ja,Va){v=Be.Flm(this.ka.replaceObjectIconType,Va)?new tb(v,this.hd,this.Ts,ma,Ja,this.ka,this.te,this.Ye,this.zSg):new Hb(v,S,"per","PowerPointDesigner_32x32x32",this,this.bjb,this.hd,this.Ts,ma,Ja,this.Ye,this.ka,Va,this.zSg);v.setup();return v}a6i(v){v=new rc(v,this.Ye);v.setup();return v}$5i(){return new yc.a(this.Ye)}}Object(k.a)(xc,"ReplaceObjectViewFactory",null,[]);class ld{constructor(v,S,ma){this.Ye=v;this.sa=ma;this.nch=S}Y1c(v){if(!v)throw Error.argumentNull("shape");var S=
v.ZS;v=this.dyb(S.TopLeft);S=this.dyb(S.TopRight);return ob.a.an(v,S)}X1c(v){if(!v)throw Error.argumentNull("shape");var S=v.ZS;v=this.dyb(S.TopRight);S=this.dyb(S.BottomRight);return ob.a.an(v,S)}gbc(v){return this.Y1c(v)*this.Oqg()}fbc(v){return this.X1c(v)*this.Oqg()}rKj(v){if(!v)throw Error.argumentNull("shape");var S=v.ZS;v=this.dyb(S.TopLeft);S=this.dyb(S.TopRight);return Vc.a.VS(ob.a.IJ(v,S))}Ifg(){return this.getBounds(this.nch.Ic.Oy)}getBounds(v){return this.Ye.wi(v)}Oqg(){const v=this.nch.Ic;
return v?v.cV:1}dyb(v){return new ob.a(v.X,v.Y)}eIa(v){return v?!!this.sa.Aa&&this.sa.Aa.Fb.equals(v.slideId):!1}}Object(k.a)(ld,"ReplaceObjectViewHelper",null,[]);var wd=d(447);class t{constructor(v,S,ma){this.o2=this.J1=null;this.tV=v;this.RQk=S;this.Lid=ma}get xH(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get uwb(){this.J1||(this.J1=
Object.assign(new Vm.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:wd.a.u9e,outputSchema:wd.a.u9e,func:Object(r.a)(this,this.wfb,"lambdaBeforeFunc")}));return this.J1}get Ivb(){return null}get kPb(){this.o2||(this.o2=Object.assign(new Vm.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:wd.a.u9e,outputSchema:"ShapeTextConvertable",func:Object(r.a)(this,this.gze,"lambdaRemoteFunc")}));return this.o2}wfb(v,S,ma){if(v&&this.RQk.hve())if(v){try{var Ja=Ag.a(v.ContextId)}catch(Va){Q.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.xH);ma(null);return}this.Lid.stk(Ja.t)?this.Lid.quj(Ja.shapeId)?ma(v):(Q.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.xH),ma(null)):(Q.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.xH),ma(null))}else ma(null),Q.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.xH);else Q.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.xH),ma(null)}gze(v,S,ma){v?
v?this.tV.execute(Ja=>{Ja.dwc(v.Topic,v.Data,v.ContextId,Va=>{this.$Ma(Va)},Va=>{this.YMa(Va)},ma)}):ma(null):ma(null)}$Ma(v){if(!w.AFrameworkApplication.Dh&&v&&v.data){var S=v.data.state;if(S){try{var ma=Ag.a(v.data.Ud)}catch(Ja){S(null);Q.a.J(36804442,375,10,"Try parse aug response failed:{0}",Ja.message);return}S(ma)}}}YMa(v){!w.AFrameworkApplication.Dh&&v&&v.data&&(v=v.data.state)&&v(null)}}Object(k.a)(t,"ReplaceObjectWacALWorkflow",null,[1175]);var aa=d(262);class ra{constructor(){this.vSe=null}tCc(v){return this.validate(v)?
this.vSe?this.vSe.tCc(v):!0:!1}MRl(v){this.vSe=v}}Object(k.a)(ra,"ReplaceObjectWall",null,[]);class Na extends ra{constructor(){super();this.mv=null}mog(v){const S=this.mv.gbc(v);v=this.mv.fbc(v);var ma=S*v;const Ja=this.mv.Ifg().width,Va=this.mv.Ifg().height;ma=ma/(Ja*Va)*100;Q.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",S,v,Ja,Va,ma);return ma}}Object(k.a)(Na,"AreaRatioWall",ra,[]);class db extends Na{constructor(v,
S){super();this.ZMk=v;this.mv=S}validate(v){return this.mog(v)<=this.ZMk}}Object(k.a)(db,"MaxAreaRatio",Na,[]);class kb extends ra{constructor(v,S){super();this.WMk=v;this.mv=S}validate(v){return this.mv.fbc(v)<=this.WMk}}Object(k.a)(kb,"MaxShapeHeight",ra,[]);class Ib extends ra{constructor(v,S){super();this.aNk=v;this.mv=S}validate(v){return this.mv.gbc(v)<=this.aNk}}Object(k.a)(Ib,"MaxShapeWidth",ra,[]);class Rb extends Na{constructor(v,S){super();this.nNk=v;this.mv=S}validate(v){return this.mog(v)>=
this.nNk}}Object(k.a)(Rb,"MinAreaRatio",Na,[]);var Cb=d(40);class cc extends ra{constructor(v,S){super();this.mNk=v;this.Ga=S}validate(v){return this.CHj(v,this.Ga)>=this.mNk}CHj(v,S){if(!v)return 0;let ma=0;S.lH(v,Ja=>{Ja.Qa(Cb.a.np)&&(Ja=Ja.$a(Cb.a.np))&&0<Ja.length&&ma++});return ma}}Object(k.a)(cc,"MinParagraphCount",ra,[]);class Fc extends ra{constructor(v,S){super();this.kNk=v;this.mv=S}validate(v){return this.mv.fbc(v)>=this.kNk}}Object(k.a)(Fc,"MinShapeHeight",ra,[]);class ed extends ra{constructor(v,
S){super();this.qNk=v;this.mv=S}validate(v){return this.mv.gbc(v)>=this.qNk}}Object(k.a)(ed,"MinShapeWidth",ra,[]);class Td{constructor(v,S,ma){this.sha=null;this.ka=v;this.Ga=S;this.XKb=ma;this.init(this.ka.replaceObjectClientWalls)}validate(v){return this.sha?this.sha.tCc(v):!0}init(v){v=this.d8i(v);this.RLi(v)}d8i(v){const S={};if(hc.a.Ta(v))return S;v=v.split(";");for(const ma of v)hc.a.Ta(ma)||(v=ma.split(":"),2===v.length?S[v[0]]=v[1]:Q.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
ma));return S}RLi(v){const S=[];"MinParagraphCount"in v&&Array.add(S,new cc(aa.d(v,"MinParagraphCount",0),this.Ga));"MinShapeHeight"in v&&Array.add(S,new Fc(aa.b(v,"MinShapeHeight",0),this.XKb));"MaxShapeHeight"in v&&Array.add(S,new kb(aa.b(v,"MaxShapeHeight",Number.MAX_VALUE),this.XKb));"MinShapeWidth"in v&&Array.add(S,new ed(aa.b(v,"MinShapeWidth",0),this.XKb));"MaxShapeWidth"in v&&Array.add(S,new Ib(aa.b(v,"MaxShapeWidth",Number.MAX_VALUE),this.XKb));"MinShapeAreaRatio"in v&&Array.add(S,new Rb(aa.b(v,
"MinShapeAreaRatio",0),this.XKb));"MaxShapeAreaRatio"in v&&Array.add(S,new db(aa.b(v,"MaxShapeAreaRatio",Number.MAX_VALUE),this.XKb));for(v=0;v<S.length-1;v++)S[v].MRl(S[v+1]);0<S.length&&(this.sha=S[0])}}Object(k.a)(Td,"ReplaceObjectWalls",null,[1120]);class rf{constructor(){this.K=null;this.LP=this.lJe=this.SJe=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}fc(v){this.K=v;(this.LP=this.K.resolve("PowerPointWebEditor.IApplicationContext").td.Mg)&&this.K.register(Jk.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>
new Jk.a(w.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));v.register(Go,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().na(()=>
new Go);v.register(ld,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().na(()=>new ld(v.resolve("PowerPoint.IBrowserHelperManager"),v.resolve("PowerPointWebEditor.IActiveSlideViewManager"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));v.register(1119,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().na(()=>new Fa(v.resolve("PowerPoint.IBrowserHelperManager"),v.resolve("Common.IPointerInputManager"),v.resolve("Common.IClickInputManager"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
v.resolve("Common.IActionManagerExtended"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),v.resolve("PowerPointWebEditor.IInputHandlerManager"),v.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),v.resolve("PowerPointWebEditor.IFocusManager"),v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("Common.IBrowserUtils")));v.register(1120,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().na(()=>
new Td(v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("PowerPointWebEditor.IShapeReader"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));v.register(Ma,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().na(()=>new Ma(v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),v.resolve("PowerPointWebEditor.IApplicationSettings")));
v.register(1121,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().na(()=>new fo(v.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),v.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));v.register(1122,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().na(()=>v.resolve("Common.IAppSettingsManager").getBooleanAppSetting("473")?
new hm((S,ma,Ja,Va,wb,Sb)=>{const vc=new Fo(v.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),v.Ha("PowerPointWebEditor.IDesignerServiceProvider"));vc.UTa(S,ma,Ja,Va,wb,Sb);return vc}):new xp(new Fo(v.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),v.Ha("PowerPointWebEditor.IDesignerServiceProvider"))));v.register(1123,"PowerPointWebEditor.IReplaceObjectManager").ma().na(()=>v.resolve("Common.IAppSettingsManager").getBooleanAppSetting("473")?new qo(v.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),
v.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),v.resolve("PowerPointWebEditor.IFocusManager"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),v.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),v.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),v.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),v.resolve("PowerPointWebEditor.IPptSelectionManager"),v.resolve("Common.IActionManagerExtended"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),v.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),v.resolve("PowerpointPresence.IPresenceEventHandlers"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),v.resolve("PowerPointWebEditor.View.IViewEventSource"),
v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("PowerPointWebEditor.IActionNameResolver"),v.resolve("Common.ITaskManager"),v.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),v.Ha("PowerPointWebEditor.IDesignerServiceProvider")):new eo(v.resolve("PowerPointWebEditor.IFocusManager"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),v.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),v.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
v.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),v.resolve("PowerPointWebEditor.IPptSelectionManager"),v.resolve("Common.IActionManagerExtended"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),v.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
v.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),v.resolve("PowerpointPresence.IPresenceEventHandlers"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),v.resolve("PowerPointWebEditor.View.IViewEventSource"),v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("PowerPointWebEditor.IActionNameResolver"),v.resolve("Common.ITaskManager"),v.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),v.Ha("PowerPointWebEditor.IDesignerServiceProvider")));v.register(fk,
"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().na(()=>new fk(v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),v.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),v.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),v.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),v.resolve("PowerPointWebEditor.IFocusManager"),v.resolve("Box4.IPageView").Na,v.resolve("PowerPointWebEditor.IShapeReader")));v.register(Be,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().na(()=>new Be(v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("Common.ITaskManager")));v.register(xc,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().na(()=>
new xc(v.resolve("Common.IClickInputManager"),v.resolve("Common.IPointerInputManager"),v.resolve("PowerPoint.IBrowserHelperManager"),v.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("PowerPoint.IPathManager"),v.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));v.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().na(()=>new Nb.a((S,
ma)=>{let Ja=null;const Va=Object(N.a)(178,S.sc(v.resolve("Box4.IPageView").Na));Va&&!Va.hm&&Va.oW&&(Ja=new z(S,Va,ma,v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),v.resolve("Common.IActionManagerExtended"),v.resolve("PowerPoint.IBrowserHelperManager"),v.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),Ja.setup());return Ja}));v.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().na(()=>new Nb.a((S,ma)=>{let Ja=null;const Va=Object(N.a)(178,S.sc(v.resolve("Box4.IPageView").Na));Va&&!Va.hm&&Va.oW&&(Ja=new Zp(S,Va,ma,v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
Ja.setup());return Ja}));v.register(t,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new t(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));v.register(un,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().na(()=>new un(this.K.Ha("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));v.register(Sj,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().na(()=>new Sj(v.resolve("PowerPointWebEditor.IPptSelectionManager"),v.resolve("Common.IActionManagerExtended"),v.resolve("PowerPointWebEditor.IFocusManager"),v.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),v.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),v.resolve("PowerPointWebEditor.View.IViewEventSource"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),v.resolve("Common.Transaction.ITransactionFactory"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),v.resolve("PowerPointWebEditor.View.IPPTPageView"),v.resolve("PowerPointWebEditor.IShapeReader")));v.register(Ii,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().na(()=>
new Ii(v.resolve("PowerPointWebEditor.IPptSelectionManager"),v.resolve("PowerPointWebEditor.View.IViewEventSource"),v.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),v.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),v.resolve("PowerPointWebEditor.IShapeReader"),v.resolve("PowerPointWebEditor.IApplicationSettings"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),v.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),v.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
v.resolve("PowerpointPresence.IPresenceEventHandlers"),v.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),v.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),v.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),v.resolve("PowerPointWebEditor.IActionNameResolver"),v.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.LP&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");const v=this.K.resolve("Common.IAppSettingsManager");
v.Ue(()=>{const S=new Date;v.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?Q.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):Q.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.SJe=v.getBooleanAppSetting("463"))v.getBooleanAppSetting("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.lJe=v.getBooleanAppSetting("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();
Q.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+S)})}dispose(){this.SJe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.lJe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Ac(Db.a(new rf,0))}}Object(k.a)(rf,"PPTWebEditorReplaceObjectPackage",null,[2,3]);var sf=d(277),Hg=d(470),uh=d(1118);class fj{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=
null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdDisableSPOFileCache=this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(k.a)(fj,"AppSettings",null,[]);class Wi{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=
this.serviceBase=this.ulsLogger=null}}Object(k.a)(Wi,"ControllerFactoryParameters",null,[]);var eh=d(749),El=d(338);class Nh{}Nh.none="None";Nh.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Nh.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Nh.vhFailedToParseVersionList="VHFailedToParseVersionList";Nh.vhFetchFailed="VHFetchFailed";Nh.vhVersioningNotEnabled="VHVersioningNotEnabled";Nh.vhFileNotFound="VHFileNotFound";Nh.vhVersionTooOld="VHVersionTooOld";Nh.xnm="VHFailedToRenderThumbnails";
Nh.wnm="VHFailedToRenderSlide";Nh.vnm="VHFailedToRenderNotes";Nh.tnm="VHFailedToRenderDiff";Nh.ynm="VHFailedToShowAnimaitonIcon";Nh.znm="VHFailedToShowHiddenEffect";Nh.unm="VHFailedToRenderInitPresInfo";Object(k.a)(Nh,"ErrorName",null,[]);class Mk{constructor(){this.CKa=new Qb.a;this.CKa.add(0,Nh.none);this.CKa.add(100,Nh.vhFailedToLoadVersionList);this.CKa.add(101,Nh.vhFailedToGetDownloadToken);this.CKa.add(102,Nh.vhFailedToParseVersionList);this.CKa.add(103,Nh.vhFetchFailed);this.CKa.add(104,Nh.vhVersioningNotEnabled);
this.CKa.add(105,Nh.vhFileNotFound);this.CKa.add(106,Nh.vhVersionTooOld);this.bLa=new Qb.a;this.bLa.add(0,Nh.none);this.bLa.add(100,Nh.xnm);this.bLa.add(101,Nh.wnm);this.bLa.add(102,Nh.vnm);this.bLa.add(103,Nh.tnm);this.bLa.add(104,Nh.ynm);this.bLa.add(105,Nh.znm);this.bLa.add(106,Nh.unm)}get CWl(){return this.CKa}get Nnm(){return this.bLa}static Dog(){Mk.Y5e||(Mk.Y5e=new Mk);return Mk.Y5e}}Mk.YSf="ErrorCode";Mk.Y5e=null;Object(k.a)(Mk,"VersionHistoryTelmetryHelper",null,[]);var Ym=d(314);class nj{constructor(v,
S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If,yh,df,bg){this.qld=this.AF=this.SSg=this.Chd=this.uV=this.zI=this.QPe=this.BZ=this.xI=null;this.dxa=-1;this.XGb=null;if(!bg)throw Error.argumentNull("clientRequestManager");this.ia=v;this.Nx=S;this.kj=ma;this.Ba=Ja;this.Wb=Va;this.v0a={};this.Fa=wb;this.ih=Sb;this.fKb={};this.rc=gd;this.pld={};this.zPk=vc;this.$ga=od;this.Xa=Vd;this.DDe=[];Ke&&(this.SSg=Ke,this.SSg.execute(ih=>{this.AF=ih}));this.wP=kg;this.oh=If;this.tCe=yh;this.CKb=df;this.Ms=bg;this.nUk=new Ym.a(Ja.Pba)}qb(){this.ia.xa(F.a.Xyc,
E.a.frame,Object(r.a)(this,this.d2l,"showVersionHistoryDialogAction"));this.Ba.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.xa($a.a.Cvh,E.a.frame,Object(r.a)(this,this.OYe,"pptoShowFileVersion"));this.ia.xa($a.a.e5h,E.a.frame,Object(r.a)(this,this.q0j,"handleVersionHistoryCopySlides"))}d2l(v,S,ma){if(1===ma)return v=!1,this.Xa.Vfa&&(v=!0),v?2:32;2===ma&&(this.qld=yb.a.create().toString(),n.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: ${this.m_versionHistoryLaunchSessionId}. disableVHSPOFileCache: ${this.disableVHSPOFileCache()}"),
pb.c($a.a.Erh,!0),this.v0a.VersionHistoryLaunchSessionId=this.qld,this.fKb.VersionHistoryLaunchSessionId=this.qld,this.v0a.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.Chd=[],this.xI||(this.xI=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Wi,{ulsLogger:new Hg.a,serviceBase:this.Ba.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Ba.getBooleanAppSetting("PPTVHPodsBootEnabled")?this.Ba.getSetting("PODSLatestServiceBase")+"&PodSID="+
this.Ba.getSetting("PodSID"):"",docId:w.AFrameworkApplication.mh,appSettings:Object.assign(new fj,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ba.getSetting("PodVHRetryCount"),wdEnableSaveACopy:!0,wdEnableRestore:this.rc.fp,userSessionId:w.AFrameworkApplication.userSessionId,wacCluster:this.Ba.Ea("WacCluster"),uiLocale:this.Ba.iMa?this.Ba.iMa:"en-us",isRtl:w.AFrameworkApplication.isRtl,disabledChangeGates:this.Ba.Ea("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ba.getBooleanAppSetting("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),
disableSaveACopy:!this.rc.fp,wdEnableDeleteVersions:this.Ba.getBooleanAppSetting("PPTVersionHistoryDeleteVersionsIsEnabled"),wdDisableSPOFileCache:this.Gab()}),perfTelemetryInfos:this.Chd}))),this.xI&&this.xI.setDisableSaveACopy(w.AFrameworkApplication.Tw),this.e2l());return 32}OYe(v,S,ma){return 1===ma&&this.Xa.Vfa?2:this.ia.nb(F.a.Lyc,ma)}q0j(v,S,ma){if(1===ma)return this.rQh()?2:32;this.BZ.onCopySlides();return 32}e2l(){var v;if(!document.getElementById("VersionHistoryOverlay")){this.Cwl();this.ywl();
this.zwl();this.twl();this.rwl();this.xwl();this.wwl();this.uwl();const S=document.createElement("div");S.id="VersionHistoryOverlay";S.style.width="100%";S.style.zIndex="998";S.style.display="block";S.style.position="absolute";S.style.top="0px";if(this.Ba.getBooleanAppSetting("RegionComposerIsEnabled")){const ma=(null===(v=document.getElementById("HeaderRegion"))||void 0===v?void 0:v.offsetHeight)||0;S.style.top=ma+"px";S.style.bottom="0px";S.style.height=`calc(100vh - ${ma}px)`}else S.style.height=
"calc(100% + "+Ua.AFrame.ABd+"px)";document.getElementById("WACInnerFrame").appendChild(S);this.QPe=this.xI.createVersionHistoryDialog(S);this.eob()}document.getElementById("VersionHistoryOverlay").style.display="block";this.xI.getTipVersion&&this.Ba.getBooleanAppSetting("PPTVHPodsBootEnabled")&&this.xI.getTipVersion();this.xI.getVersions("");this.wsi()}wsi(){try{this.XGb=this.zPk.uyj();for(let v=0;v<this.XGb.length;v++)this.ih.zp(this.XGb[v]);this.ih.bM(dd.a.PUb)}catch(v){n.ULS.sendTraceTag(512508633,
822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",v)}}s9i(){try{if(this.XGb)for(let v=0;v<this.XGb.length;v++)this.ih.bM(this.XGb[v]);else n.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.ih.zp(dd.a.PUb)}catch(v){n.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",v)}}Cwl(){this.xI.getFullAppErrorEvent().addListener(v=>{try{const S=Mk.Dog().CWl.ga(v);this.fKb[Mk.YSf]=
S;n.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",S,this.qld)}catch(S){n.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",S)}})}ywl(){this.xI.getVersionsReadyEvent().addListener(v=>{this.lGh(v.containerDiv);try{n.ULS.sendTraceTag(508843726,822,50,"registerForVersionReadyEvent - getVersionsReadyEvent - disableVHSPOFileCache: ${this.disableVHSPOFileCache()}");const S=v.versions;if(this.Gab()){let ma=v=!1;const Ja=this.zI?
nj.EGa(this.zI):null,Va=this.uV?nj.EGa(this.uV):null;for(const wb of S){this.MBc(wb);const Sb=nj.EGa(wb);Sb===Ja?v=!0:Sb===Va&&(ma=!0)}this.zI&&!v?(this.MBc(this.zI),S.push(this.zI)):this.uV&&!ma&&(this.MBc(this.uV),S.push(this.uV))}this.bxi(S);this.Fa.dW("VersionHistoryOverlay",!0);this.zI&&this.uV&&this.bWc(this.zI.DownloadUrl)&&this.bWc(this.uV.DownloadUrl)&&this.BZ&&(this.g6h(),this.xxg(),this.BZ.onVersionSelected(this.zI,this.uV,this.v0a),this.lXf())}catch(S){n.ULS.sendTraceTag(512508628,822,
10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",S)}})}bWc(v){return v.length?(new URL(v)).host?!0:(n.ULS.sendTraceTag(508397020,822,10,"VersionHistoryPaneActor: DownloadUrl has no host"),!1):(n.ULS.sendTraceTag(508397021,822,10,"VersionHistoryPaneActor: DownloadUrl is empty"),!1)}bxi(v){const S=this.BZ.getAppDataStore();for(const ma of v)S.AddVersionInfoToStore(ma)}zwl(){this.xI.getVersionSelectedEvent().addListener(v=>{this.zI=v.currentVersion;this.uV=v.baseVersion;if(this.BZ){this.Gab()&&
(this.zI&&!this.bWc(this.zI.DownloadUrl)&&this.MBc(this.zI),this.uV&&!this.bWc(this.uV.DownloadUrl)&&this.MBc(this.uV));try{this.g6h(),this.xxg(),this.BZ.onVersionSelected(this.zI,this.uV,this.v0a),this.ayl(),this.lXf()}catch(S){n.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",S)}}})}ayl(){const v=this.Jbc(2);v&&(Za.a.addHandler(v,Ha.a.Vf,Object(r.a)(this,this.XA,"keyDownHandler")),Uh.a.instance.xb(v,Object(r.a)(this,this.AD,"contextMenuHandler")))}ngm(){const v=
this.Jbc(2);v&&(Za.a.removeHandler(v,Ha.a.Vf,Object(r.a)(this,this.XA,"keyDownHandler")),Uh.a.instance.Hb(v,Object(r.a)(this,this.AD,"contextMenuHandler")))}XA(v){try{if(v.shiftKey&&v.keyCode===da.a.Jra||v.keyCode===da.a.YOa){const S=uh.a.create(Ha.a.contextMenu,v,1);this.AD(S)}}catch(S){n.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",S)}}AD(v){if(1===v.wg){const S=this.Jbc(2);S&&(v.clientPoint.x=Cd.a.fge(S)+ah.a.Zta,v.clientPoint.y=Cd.a.hge(S)+ah.a.Zta)}return 32===
this.ia.Ia($a.a.f_f,2,v)}twl(){this.xI.getDownloadTokenReadyEvent().addListener(v=>{try{if(n.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.uV)if(v&&v.updatedVersions&&2<=v.updatedVersions.length){let S=null,ma=null;const Ja=nj.EGa(this.zI),Va=nj.EGa(this.uV);for(const wb of v.updatedVersions){const Sb=nj.EGa(wb);Ja===Sb?S=wb:Va===Sb&&(ma=wb);if(S&&ma)break}S&&ma?(this.zI=S,this.uV=ma,this.BZ.diff(this.zI,this.uV)):n.ULS.sendTraceTag(512508623,
822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ja,Va)}else n.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else n.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(S){n.ULS.sendTraceTag(512508621,
822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",S)}})}Gab(){return this.nUk.Jkj||this.Ba.getBooleanAppSetting("DisableVHSPOFileCache")}mej(v){return v?0!=v.indexOf("SequenceNumber")?(n.ULS.sendTraceTag(508859522,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL does not start with SequenceNumber: {0}",v),!1):!0:(n.ULS.sendTraceTag(508859523,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL is null or empty"),
!1)}MBc(v){if(v&&this.mej(v.DownloadUrl)){const ma=this.Ba.popsServiceBase;var S=ma+"VersionHistoryDownloadLink.ashx";const Ja=w.AFrameworkApplication.mh;if(Ja)S=new Pg.QueryStringBuilder(S),S.zg(Si.a.fdl,Ja),S.zg(Si.a.Wsh,v.DownloadUrl),S.zg(Si.a.jdl,nj.EGa(v)),v.DownloadUrl=S.toString(),v=new URL(ma),n.ULS.sendTraceTag(508940565,822,50,`VersionHistoryPaneActor - updateDownloadUrl - Generated download URL with popsServiceBase host: ${v.host}`);else throw n.ULS.sendTraceTag(508936896,822,15,"VersionHistoryPaneActor - updateDownloadUrl - QuerySignature not found"),
Error("Could not update downloadUrl with valid VersionHistoryDownloadLink - QuerySignature not found");}else n.ULS.sendTraceTag(508371797,822,15,"VersionHistoryPaneActor - updateDownloadUrl - Invalid SyncToken")}xwl(){this.xI.getSaveACopySelectedEvent().addListener(v=>{n.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",v);this.Ba.getBooleanAppSetting("PowerPointVersionHistoryFloodGateIsEnabled")&&nj.m1k();let S=w.AFrameworkApplication.WEb;this.Ba.getBooleanAppSetting("VHSaveACopyForOdcOnSpoEnabled")&&
(S=32===this.ia.nb($a.a.qtc,1));this.Gab()&&(-1!=v.indexOf("VersionHistoryDownloadLink.ashx")?v="app=ppt ver="+(new Pg.QueryStringBuilder(v)).zmg(Si.a.Wsh):n.ULS.sendTraceTag(508699020,832,10,"DownloadURL did not contain VersionHistoryDownloadLink"));v=S?this.ia.Ia($a.a.qtc,2,{["FileDownloadUrl"]:v}):this.ia.Ia(F.a.inb,2,{["FileDownloadUrl"]:v});32!==v?(pb.c($a.a.b5d,!1),n.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",v)):pb.c($a.a.b5d,!0)})}KZh(v,S){try{(new Promise((ma,
Ja)=>{this.xI.setRestoreInProgress();this.$ga.$Rc(this.Xa.xl,this.Xa.podSessionId,this.Xa.presentationId.string,this.Ba.getSetting("361"),this.Xa.Oba,!1,!0,()=>{ma(!0)},Va=>{Ja("ClosePopWacSessionSync:: "+Va.error.message)})})).then(()=>{(new Promise((ma,Ja)=>{this.$ga.dwd(this.Xa.presentationId.string,v,()=>{ma(!0)},Va=>{Ja("RestoreFileVersion:: "+Va.error.message)})})).then(()=>{const ma=Date.now()-S;n.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",
ma);this.fKb.RestoreSucceededTime=ma;this.ia.Ia($a.a.refresh,2,{["IsSourceVH"]:!0});pb.c($a.a.G5b,!0)}).catch(ma=>{const Ja=Date.now()-S;this.xI.setRestoreFailedAtServer(()=>{this.ia.Ia($a.a.refresh,2,{["IsSourceVH"]:!0})});n.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",ma,Ja);this.fKb.RestoreFailedTime=Ja;pb.c($a.a.G5b,!1)})})}catch(ma){n.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",
ma.message),pb.c($a.a.G5b,!1)}}wwl(){this.xI.getRestoreVersionSelectedEvent().addListener(v=>{n.ULS.sendTraceTag(512508615,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",v);const S=Date.now();this.AF?(this.DDe=this.AF.H$b(),0<this.DDe.length?(n.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.DDe.length),pb.c($a.a.G5b,!1),this.xI.setCoauthRestoreError()):this.KZh(v,S)):(n.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),
this.KZh(v,S))})}uwl(){this.xI.getDownloadVersionSelectedEvent().addListener(v=>{n.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");v=new Pg.QueryStringBuilder(v);v.zg(Si.a.Qsh,w.AFrameworkApplication.fileName);v=this.ia.Ia(F.a.downloadACopy,2,{["FileDownloadUrl"]:v.toString()});32!==v?(pb.c($a.a.a5d,!1),n.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",v)):pb.c($a.a.a5d,!0)})}g6h(){for(const v of this.Chd){const S=
v.TelemetryEventKey?v.TelemetryEventKey:v.telemetryEventKey?v.telemetryEventKey:"",ma=v.TelemetryEventData?v.TelemetryEventData:v.telemetryEventData?v.telemetryEventData:"";hc.a.Ta(S)||hc.a.Ta(ma)||(this.v0a[S]=ma)}}lXf(){this.Chd=[];this.v0a={}}rwl(){this.xI.getCloseSelectedEvent().addListener(()=>{this.Ba.getBooleanAppSetting("PowerPointVersionHistoryFloodGateIsEnabled")&&nj.Nvk();this.WXf()})}WXf(){this.s9i();this.Fa.P2("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display=
"none";this.Ba.GQf&&(this.zI=null);n.ULS.sendTraceTag(512508610,822,50,Ag.c(this.fKb))}lGh(v){try{if(this.BZ)Ui.setIsPageLoadForFirstTime(!1),this.BZ.switchParentViewContainer(v);else{Ui.setIsPageLoadForFirstTime(!0);const S=new PowerPointVersionHistory.AppBootSettings;S.RenderServiceBase="";S.IsRtl=w.AFrameworkApplication.isRtl;const ma=new PowerPointVersionHistory.AppCallbackBag;ma.animationDecoratorCallback=Object(r.a)(this.Nx,this.Nx.t7d,"createAnimationOrTransitionStar");ma.notesIconDecoratorCallback=
Object(r.a)(this,this.Z4i,"createNotesIcon");ma.addToF6LoopCallback=Object(r.a)(this,this.Jwi,"addToF6Loop");ma.copySlideCallback=Object(r.a)(this,this.copySlideCallback,"copySlideCallback");ma.reportViewerErrorCallback=Ja=>{this.fKb[Mk.YSf]=Mk.Dog().Nnm.ga(Ja);106!==Ja&&103!==Ja||this.xI.setViewerError(!0);n.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Ja);0!==Ja&&(w.AFrameworkApplication.Lp(ck.a.hi(406)),Ig.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],
!1,!1,!0,!1,null));return!0};S.IsHighContrast=!1;this.kj&&(S.IsHighContrast=this.kj.isInHighContrastMode);S.IsHighContrast&&(S.ClientColorSettings=this.kj.highContrastColors.foregroundTextColor+"_"+this.kj.highContrastColors.backgroundColor+"_"+this.kj.highContrastColors.linkColor);if(this.Wb){const Ja=this.Wb.Gcb();S.DefaultSlideWidth=Ja.width;S.DefaultSlideHeight=Ja.height}S.UserSessionId=w.AFrameworkApplication.userSessionId;S.VersionViewerCssUrl=this.Ba.versionHistoryViewerCssUrl;S.ProgressImageResourceUrl=
Eb.a.GO(ah.a.iqa);S.ThumbnailShareOptimizationEnabled=this.Ba.pptvhThumbnailShareOptimizationEnabled;S.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ba.getBooleanAppSetting("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ba.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ba.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ba.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ba.getSetting("PPTVHSlidePrefetchDelay")});
S.FileExtension=void 0!==this.Ba.hMa&&null!==this.Ba.hMa?hc.a.AR(this.Ba.hMa).toLowerCase():"";S.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;S.NotesButtonLabel=ResourceStrings.L_Notes;S.SynchronizerTimeout=this.Ba.getSetting("PptVersionHistorySynchronizerTimeout");S.IsRtl=w.AFrameworkApplication.isRtl;S.IsCopySlidesEnabled=!0;S.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;S.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;S.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
S.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;S.Lcid=w.AFrameworkApplication.lcid;S.EnableOverflowXOnSlideAndNotePane=this.Ba.getBooleanAppSetting("PodVHEnableOverflowXOnSlideAndNotePane");S.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;S.IsModernCatchUpUxEnable=!0;S.IsRevisionTrackingFlyoutEnabled=id.a("EnableRevisionTrackingFlyoutForVH");S.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.BZ=new PowerPointVersionHistory.AppVersionController(S,v,ma)}}catch(S){this.xI.setViewerError(!0),
n.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",S)}}Z4i(){return Aa.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}eob(){const v=this.Fa.Kc("VersionHistoryOverlay");v.parent=Ua.AFrame.Nj;v.uK=!0;v.T4e=!0;v.Zda(S=>{S&&"dialog/modal"===S.name?this.xI.setSaveACopyCanceled():S&&S.name===Ua.AFrame.mQ||(this.dxa=-1,this.H_h(!0))});this.ih.y4("VersionHistoryOverlay");this.ih.zxc(dd.a.PUb,
S=>{this.H_h(S)});this.ih.jRb(dd.a.PUb,()=>{2===this.dxa&&Sys.UI.DomElement.addCssClass(this.Jbc(2),"PPTVHViewerElementSelected");3===this.dxa&&Sys.UI.DomElement.addCssClass(this.Jbc(3),"PPTVHViewerElementSelected")})}H_h(v){try{const S=this.I2c();(this.dxa=this.tGj(v))?1===this.dxa?this.QPe.then(ma=>{ma.enterHeaderFocusTrapZone();return null}):S&&Jb.FocusManager.dr(document.getElementById(S[this.dxa])):this.QPe.then(ma=>{ma.enterFocusTrapZone();return null})}catch(S){n.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",S)}}tGj(v){const S=this.I2c();let ma=this.dxa;do if(v?S&&(ma=(ma+1)%S.length):S&&(ma=0<ma?ma-1:S.length-1),!ma||1===ma||S&&"none"!==document.getElementById(S[ma]).style.display)return ma;while(ma!==this.dxa);return 0}xxg(){const v=nj.EGa(this.zI);this.pld[v]||(this.pld[v]=["VersionListPane","vhHeader"],this.dxa=-1)}I2c(){if(!this.zI)return this.Ba.GQf?["VersionListPane","vhHeader"]:null;const v=nj.EGa(this.zI);return this.pld[v]?
this.pld[v]:null}Jbc(v){const S=this.I2c();return S&&S.length>v?document.getElementById(S[v]):null}Jwi(v){try{const S=this.I2c();S&&S.push(v)}catch(S){n.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",S)}return!0}copySlideCallback(v){if(this.rQh())return!1;const S=yb.a.create().toString();n.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",S);const ma=this.wP.wTc(1,v.SlideIds.length),Ja={};Ja.WacSessionId=w.AFrameworkApplication.userSessionId;
Ja.CallerCorrelationId=S;var Va={};Va.Source=v.Source;Va.SlideIds=v.SlideIds;Va.CcpId=ma.nq;Va.PackageAccessKey=ma.Cz;v=JSON.stringify(Va);Va=String.format("{0}{1}",this.Ba.podsWebServiceBase,"vhcopyslide.ashx");const wb=Date.now();try{if(this.Ms.Tj(Va,2,v,Ja,!1,0,Sb=>{nj.snm(Sb,wb,S)},Sb=>{nj.rnm(Sb,wb,S)},null,null),this.oh.contentWindow&&this.oh.contentWindow.document&&this.oh.contentWindow.document.body){ub.a.z5b(this.oh);const Sb=ub.a.zla();Sb.innerText=ub.a.njh;Sb.setAttribute(El.a.nq,ma.nq);
Sb.setAttribute(El.a.EE,ma.EE);Sb.setAttribute(El.a.count,ma.objectCount.toString());const vc=eh.a(ma.dataType);Sb.setAttribute(El.a.type,vc);Sb.setAttribute(El.a.location,ma.location);Sb.setAttribute(El.a.Cz,ma.Cz);this.oh.contentWindow.document.body.appendChild(Sb);this.tCe.Z2a(this.oh);this.CKb.copy(this.oh)}else n.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Sb){n.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Sb)}return!0}rQh(){return(w.AFrameworkApplication.cD||w.AFrameworkApplication.Tw)&&!w.AFrameworkApplication.MUa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.WXf();this.ngm()}static EGa(v){return v.RevisionID?v.RevisionID:v.revisionID?v.revisionID:""}static snm(v,S,ma){const Ja=Date.now();try{JSON.parse(v.data.Ud).IsCopied?n.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",
Ja-S,ma):n.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Ja-S,ma)}catch(Va){n.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Va,ma)}}static rnm(v,S,ma){const Ja=Date.now();n.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",Ja-S,v.data?v.data.Ke:-1,ma)}static Nvk(){const v=C.a.instance.ub("Common.ISystemInitiatedFeedback");
v?(v.logActivity("VersionHistoryExited",null),v.logActivity("VersionHistoryCheckExited",null)):n.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static m1k(){const v=C.a.instance.ub("Common.ISystemInitiatedFeedback");v?v.logActivity("VersionHistoryExited",null):n.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}}Object(k.a)(nj,"VersionHistoryPaneActor",null,[1204,106]);class Io{constructor(){this.CJc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}fc(v){this.Da=
v}init(){w.AFrameworkApplication.fa.Ue(Object(r.a)(this,this.Pn,"onFullAppSettingsReady"))}Pn(){w.AFrameworkApplication.C9c()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").W7c?n.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(n.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),
ib.a.get_instance().Ij(7,()=>{Ia.a(this.Da)("versionHistory").catch(v=>n.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",v)).then(()=>this.mal()).catch(v=>n.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",v))})):n.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}mal(){this.I6b();return null}I6b(){this.Da.register(nj,
"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").na(()=>new nj(w.AFrameworkApplication.Pa,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),Jb.FocusManager.instance(),sf.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.Da.resolve("PowerPointWebEditor.IPopWebService"),
this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.Ha("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").HEa,this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),w.AFrameworkApplication.Me)).ma();this.CJc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");this.CJc.qb()}dispose(){this.CJc&&this.CJc.dispose()}}
Object(k.a)(Io,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var aq=d(462),yp=d(740),Jo;(function(v){v[v.anyone=0]="anyone";v[v.organization=1]="organization"})(Jo||(Jo={}));Object(k.b)("AccessControlEnum",Jo);var zp=d(337);class Jn{constructor(){this.token=this.timeStamp=null}}Object(k.a)(Jn,"CachedAccessToken",null,[]);class bq{constructor(v){this.xCe={};this.qIk=v}oOi(v,S){if(!hc.a.Ta(v)&&!hc.a.Ta(S)){const ma=new Jn;ma.token=S;ma.timeStamp=new Date;this.xCe[v]=ma}}Jgg(v){return v in this.xCe&&
(v=Object(N.a)(Jn,this.xCe[v]),+new Date-+v.timeStamp<6E4*this.qIk)?v.token:null}}Object(k.a)(bq,"AccessTokenCache",null,[]);class Ap{constructor(){this.reject=this.resolve=this.frame=this.Xha=this.Eif=this.resource=this.appId=this.authority=this.id=null;this.Apb=0;this.q4e=null;this.Usc=0;this.P_h=!1}}Object(k.a)(Ap,"DirectAuthRequest",null,[]);class Aq{constructor(v){this.Rmc={};this.ka=v;this.ZKa=new bq(this.ka.gil);window.addEventListener("message",Object(r.a)(this,this.UEl,"requestCompletionMessageHandler"),
!1)}Sjg(v){const S={},ma=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ja;for(;Ja=ma.exec(v);)S[Object(N.a)(String,Ja[1])]=Object(N.a)(String,Ja[2]);return S}UEl(v){if("data"in v){var S;({Ev:S}=Ag.d(v.data)).returnValue&&S&&"DirectAuthRequestID"in S&&this.gCb(S)}}gCb(v){try{const Ja=v.DirectAuthRequestID;if(Ja in this.Rmc){var S=null,ma=Object(N.a)(Ap,this.Rmc[Ja]);if(ma&&ma.id===Ja){Q.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",Ja,"Timeouted"in
v,"FromPolling"in v);window.clearTimeout(ma.Apb);delete this.Rmc[Ja];window.clearTimeout(ma.Usc);const Va=new zp.a;Va.IsSuccess=!1;Va.ErrorCode="";Va.ErrorMessage="";Va.Token="";"Timeouted"in v?(Q.a.J(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Va.ErrorCode="Timeout",Va.ErrorMessage="No response received in time for the authentcation request",ma.resolve(Va)):"PopupWindowClosed"in v&&ma.Xha?(Va.ErrorCode="User_aborted",Va.ErrorMessage="User aborted log in by closing the popup window",
ma.resolve(Va)):(ma.frame?S=this.Sjg(ma.frame.contentWindow.location.hash):ma.Xha&&!ma.Xha.closed&&(S=this.Sjg(ma.Xha.location.hash)),"access_token"in S?(Va.IsSuccess=!0,Va.Token=Object(N.a)(String,S.access_token),this.ZKa&&this.ZKa.oOi(ma.q4e,Va.Token),ma.resolve(Va)):(Va.ErrorCode="error"in S?Object(N.a)(String,S.error):"unknown",0<=Array.indexOf(this.ka.iil,Va.ErrorCode)&&ma.P_h&&ma.frame&&!ma.Xha?this.Ghl(ma.authority,ma.appId,ma.resource,ma.Eif,this.ka.jil).then(wb=>{ma.resolve(wb)}).catch(wb=>
{ma.reject(wb)}):(Va.ErrorMessage="error_description"in S?Object(N.a)(String,S.error_description):"unknown",ma.resolve(Va))));ma.frame?document.body.removeChild(ma.frame):ma.Xha&&!ma.Xha.closed&&ma.Xha.close()}else Q.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Ja)}else Q.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(v))}catch(Ja){Q.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
Ja.message)}}EZf(){const v=window.location.protocol,S=window.location.host;var ma="/p/";Q.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",v,S,"ffc-powerpoint.officeapps.live.com"===S||"ppc-powerpoint.officeapps.live.com"===S);if(void 0===ma||null===ma){ma=window.location.pathname;const Ja=ma.lastIndexOf("/");ma=0<=Ja?ma.substring(0,Ja+1):""}return v+"//"+S+ma+"WacDirectAuth.html"}zdm(v,S,ma,Ja,Va,wb=!1){return this.n2l(v,S,ma,Ja,Va,wb)}Ghl(v,
S,ma,Ja,Va){if(hc.a.Ta(v))throw Error.argumentNull("authority");if(hc.a.Ta(S))throw Error.argumentNull("appId");if(hc.a.Ta(ma))throw Error.argumentNull("resource");if(hc.a.Ta(Ja))throw Error.argumentNull("userUPN");const wb=!hc.a.Ta(Ja)&&Ja.indexOf("@")<Ja.indexOf("."),Sb=this.EZf(),vc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",v,S,encodeURIComponent(ma),encodeURIComponent(Sb));if(this.ZKa){const Vd=
this.ZKa.Jgg(vc);if(!hc.a.Ta(Vd))return Q.a.J(593782154,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Ke=>{const kg=new zp.a;kg.IsSuccess=!0;kg.ErrorCode="";kg.ErrorMessage="";kg.Token=Vd;Ke(kg)})}const gd=yb.a.create().toString(),od=String.format("{0}&state={1}",vc,gd);return new Promise((Vd,Ke)=>{const kg=new Ap;kg.authority=v;kg.appId=S;kg.resource=ma;kg.Eif=Ja;kg.resolve=Vd;kg.reject=Ke;kg.id=gd;kg.q4e=vc;kg.Xha=window.open("",gd,"width=400, height=600");kg.Xha?(this.Rmc[gd]=
kg,kg.Xha.location.replace(od),Q.a.J(593782152,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",gd,wb),this.jUh(kg,1E3*Va).then(()=>{const If={};If.DirectAuthRequestID=gd;If.FromPolling=!0;this.gCb(If)}).catch(If=>{"WindowClosed"===Object(N.a)(String,If)&&(If={},If.DirectAuthRequestID=gd,If.PopupWindowClosed=!0,Q.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+gd),this.gCb(If))}),kg.Apb=window.setTimeout(()=>{const If={};If.DirectAuthRequestID=
gd;If.Timeouted=!0;Q.a.J(593782148,833,10,"DirectAuth: Popup request timedout with ID of: "+gd);this.gCb(If)},1E3*Va)):(Q.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",gd),Ke=new zp.a,Ke.IsSuccess=!1,Ke.ErrorCode="fail_to_open_popup",Ke.ErrorMessage="Failed to create popup window!",Ke.Token="",Vd(Ke))})}n2l(v,S,ma,Ja,Va,wb){if(hc.a.Ta(v))throw Error.argumentNull("authority");if(hc.a.Ta(S))throw Error.argumentNull("appId");if(hc.a.Ta(ma))throw Error.argumentNull("resource");
if(hc.a.Ta(Ja))throw Error.argumentNull("userUPN");const Sb=!hc.a.Ta(Ja)&&Ja.indexOf("@")<Ja.indexOf(".");var vc=this.EZf();const gd=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",v,S,encodeURIComponent(ma),encodeURIComponent(vc));if(this.ZKa){const Ke=this.ZKa.Jgg(gd);if(!hc.a.Ta(Ke))return Q.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(kg=>{const If=
new zp.a;If.IsSuccess=!0;If.ErrorCode="";If.ErrorMessage="";If.Token=Ke;kg(If)})}const od=yb.a.create().toString();vc=Sb?String.format("{0}&login_hint={1}&state={2}",gd,encodeURIComponent(Ja),od):String.format("{0}&state={1}",gd,od);const Vd=document.createElement("iframe");Vd.style.display="none";Vd.src=vc;return new Promise((Ke,kg)=>{const If=new Ap;If.authority=v;If.appId=S;If.resource=ma;If.Eif=Ja;If.frame=Vd;If.resolve=Ke;If.reject=kg;If.id=od;If.q4e=gd;If.P_h=wb;document.body.appendChild(Vd);
Q.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",od,Sb);this.jUh(If,1E3*Va).then(()=>{const yh={};yh.DirectAuthRequestID=od;yh.FromPolling=!0;this.gCb(yh)});If.Apb=window.setTimeout(()=>{const yh={};yh.DirectAuthRequestID=od;yh.Timeouted=!0;Q.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+od);this.gCb(yh)},1E3*Va);this.Rmc[od]=If})}jUh(v,S){return new Promise((ma,Ja)=>{const Va=S/50;let wb=0;v.Usc=window.setInterval(()=>
{try{wb++>Va&&(window.clearInterval(v.Usc),Q.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",S,Va),Ja(""));const Sb=v.frame?v.frame.contentWindow:v.Xha;if(!Sb||Sb.closed)window.clearInterval(v.Usc),Q.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),Ja("WindowClosed");let vc=null,gd=null;try{vc=Sb.location.href,gd=Sb.location.hash}catch(od){}vc&&"about:blank"!==vc?hc.a.Ta(gd)||(window.clearInterval(v.Usc),
ma(gd)):Q.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===vc)}catch(Sb){Q.a.J(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Sb.message)}},50)})}}Object(k.a)(Aq,"DirectAuthHelper",null,[]);class ro{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=
this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(k.a)(ro,"ILiveActorSettings",null,[]);class Kn{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(k.a)(Kn,"ILiveReaction",null,[]);class cq{constructor(){this.isPaused=
this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(k.a)(cq,"ILiveSessionState",null,[]);class Ji{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(k.a)(Ji,"ILiveSessionURL",null,[]);class dq{constructor(){this.G3g=this.F3g=null}}Object(k.a)(dq,"PollObjectInfo",null,[]);var wn;(function(v){v[v.none=0]="none";v[v.singleLineRibbon=1]="singleLineRibbon";v[v.multipleLineRibbon=2]="multipleLineRibbon";v[v.slideShowToolbar=3]="slideShowToolbar";
v[v.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";v[v.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(wn||(wn={}));Object(k.b)("LiveEntryPoint",wn);var Ln;(function(v){v[v.none=0]="none";v[v.callout=1]="callout";v[v.businessBar=2]="businessBar";v[v.pausedSessionTimeout=3]="pausedSessionTimeout";v[v.slideshowContextMenu=4]="slideshowContextMenu";v[v.accessControlChange=5]="accessControlChange";v[v.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Ln||(Ln={}));Object(k.b)("LiveExitPoint",
Ln);var Mm=d(688);class dp{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If){this.ua=new xd.a;this.cJa=this.jHb=this.Wcd=this.FGe=this.JRg=!1;this.Rjc=this.sGe=this.Zcd=!0;this.lnc=this.uKb=!1;this.vq=this.fk=this.oga=this.Qo=null;this.UYa=0;this.HIb=-1;this.MJb=30;this.Slc=-1;this.Pd=this.Soa=this.L1=null;this.gbh=this.Afh=this.Fjd=this.Cjd=0;this.dic=this.Gwa=this.PYa=null;this.IKe=this.ugb=0;this.Hob=null;this.qPe=new Set;this.pPe=new Map;this.Vfd=null;this.lmc=1;this.Rlc=this.hcd=this.UP=this.opa=
this.aQe=this.hEe=null;this.te=Ja;this.ka=v;this.SRg=!1;this.jb=ma;this.Wb=wb;this.Uq=Sb;this.Nc=vc;this.oA=gd;this.Xa=od;this.Mc=Vd;this.xm=Ke;this.B_a=kg;this.Fa=If;if(this.Us=S)this.oga=S.JG();this.pN=Va;this.UYa=this.Pag?1:0;this.ka.powerPointLiveBroadcastEnabled&&(this.hEe=new Aq(this.ka));this.Nc.bC(Object(r.a)(this,this.Kba,"onPodSessionRehydrated"));this.oA.h_d(Object(r.a)(this,this.qMb,"onPodSessionUnavailable"));this.$Ua()&&this.xm.execute(yh=>{yh.show(ResourceStrings.L_LivePresentations_Disconnected,
Mm.a.QLb);yh.hide()});Q.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.ka.hostAuthType)}get Es(){return this.ka.powerPointLiveBroadcastEnabled&&this.Zcd}get obb(){return this.FGe}set obb(v){(this.FGe=v)&&this.ua.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get Xr(){return!!this.vq}get $ea(){return this.SRg}set $ea(v){this.SRg=v}get OFa(){return this.JRg}set OFa(v){this.JRg=v}get cVa(){return!!this.vq&&this.vq.isPaused}get Tkj(){return this.Wcd}get PFa(){return this.Rjc}set PFa(v){this.Rjc=
v}get Dkj(){return this.obb&&this.Es&&!!this.Qo}get accessControl(){return this.UYa}set accessControl(v){this.UYa=v}get Pag(){return"true"===this.lng("wdDisablePrivateSession")?!1:"aad"===this.ka.hostAuthType}get Kag(){return this.Es&&this.Xr&&this.fk?this.fk.isWelcomeScreenVisible():!1}Uzb(){return this.ka.isMicButtonInSlideShowToolbarEnabled&&this.ka.psd&&this.Mc.p9b?this.Mc.Wzb?this.lnc=!0:this.Mc.bbg||this.lnc:!0}cqd(v,S,ma,Ja,Va,wb,Sb,vc,gd){if(this.Es){this.jb.$Zd(Object(r.a)(this,this.Uph,
"onSlideShowEnterEndOfShow"));this.jb.b_d(Object(r.a)(this,this.Vph,"onSlideShowLeaveEndOfShow"));this.jb.mOc(Object(r.a)(this,this.Zya,"onGetCurrentSlideDimensionsHandler"));this.jHb=!1;this.cJa=!0;try{this.ka.isd&&this.ctj();const od=this.Gie(Va,Ja);if(this.Qo)(this.OFa||this.cVa)&&this.Qo.FetchDocumentDownloadURL(od);else{Q.a.J(512496259,833,50,"Creating Broadcast monitor ...");const Vd=new PowerPointLive.PPTBroadcastMonitorSettings;Vd.isBlueChicken=this.ka.isBlueChicken;Vd.fileDownloadUrl=od;
Vd.rendezvousSvcBaseUri=this.ka.podLiveBroadcastRendezvousServiceBaseUri;Vd.broadcastSubtitlesFromSpeechFrontDoor=!0;Vd.pragueInitTimeoutInMS=this.ka.lil;Vd.preferredSubtitleLanguage=this.Mc.H2c();Vd.useStateService=this.ka.vil;Vd.numMaxAttempts=this.ka.pil;Vd.delayInSecsToCloseBroadcasterOnPause=this.ka.fil;Vd.batchedRequestsEnabled=this.ka.cil;Vd.sharedSessionSettings={};Vd.websocketAliveTimeAfterLoseFocusInMs=this.ka.wil;Vd.pingTimeoutInMs=this.ka.mil;Vd.pongTimeoutInMs=this.ka.oil;Vd.enableTransientSessionHandling=
this.ka.Sil;Vd.maxStateServiceRoundtripRaw=w.AFrameworkApplication.fa.tc("PPTLiveMaxStateServiceRoundtripRaw",300);Vd.sharedSessionSettings.MaxStateServiceRoundtripRaw=Vd.maxStateServiceRoundtripRaw;Vd.documentSnapshotRequestUrlGenerator=this.ka.Pil?()=>this.Gie(this.Xa.podSessionId,this.Xa.$k):null;this.ka.xvh&&(Vd.sharedSessionSettings.IsAutomation=!0);this.Qo=new PowerPointLive.PPTBroadcastMonitor(Vd);this.Qo.RegisterParticipantsCountChangeEventListener(Ke=>{this.Pd.telemetryData.maxParticipantCount=
Math.max(this.Pd.telemetryData.maxParticipantCount,Ke);this.fk&&this.fk.setParticipantCount(Ke);this.ua.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});this.Qo.RegisterNewReactionEventListener(Object(r.a)(this,this.I_k,"newReactionHandler"));this.Qo.RegisterConnectionStateEventListener(Object(r.a)(this,this.AZi,"connectionStateHandler"))}this.Qo.SetCurrentPosition(v,S-1,null);this.ugb=v;this.OFa&&!this.vq&&gd?(this.qzc(w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.es?1:2,
Sb,ma,Va,vc),this.WVi(v),this.Gwa=new Set):this.L1&&this.CCb();this.Gwa&&this.Gwa.add(v)}catch(od){Q.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",od.toString())}}}ycm(){window.setTimeout(()=>{const v=this.ugb===this.IKe;this.Es&&this.Xr&&v&&this.vq&&!this.vq.isPaused&&(Q.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.mEd(0),this.STb(0))},6E4*this.ka.ril)}f$k(){this.Es&&(this.jb.p3e(Object(r.a)(this,this.Uph,
"onSlideShowEnterEndOfShow")),this.jb.r3e(Object(r.a)(this,this.Vph,"onSlideShowLeaveEndOfShow")),this.jb.pvd(Object(r.a)(this,this.Zya,"onGetCurrentSlideDimensionsHandler")),this.cJa=this.jHb=!1,this.Xr&&this.fk&&(this.fk.hideAll(),this.Fxe()||(this.kfl(),this.O0l()),this.$Ua()&&this.xm.instance.hide()))}l5l(v,S,ma,Ja,Va,wb){try{const Sb=new PowerPointLive.RendezvousSessionConfig;Sb.userSessionId=v;Sb.webServiceBase=S;Sb.podSessionId=ma;Sb.docId=Ja;Sb.sessionId=Va;Sb.accessControl=1===this.UYa?"organization":
"anyone";Sb.authTokenFunc=wb;Sb.locale=w.AFrameworkApplication.uiCulture;Sb.presentationName=hc.a.dI(w.AFrameworkApplication.fileName);Sb.slideHeight=this.Wb.Bw().height;Sb.slideWidth=this.Wb.Bw().width;Sb.correlationId=this.Pd.telemetryData.correlationId;Sb.showQRCodeAfterFetchingDocDownloadUrl=this.ka.Zil;Sb.presenterTenantId=!this.ka.isBlueChicken&&this.ka.Kvh?w.AFrameworkApplication.fa.Ea("TenantId"):null;Sb.fileSource=w.AFrameworkApplication.fa.Ea("FileHost");this.ka.til||(Sb.fileName=w.AFrameworkApplication.fileName,
Sb.bootstrapperUrl=this.ka.pptEditorSlideShowWrsEndpoint);const vc=this.Qo.StartLiveBroadcasting(Sb,this.Pd,!this.ka.JYe);this.G$j();if(vc){this.vq=new cq;this.vq.isPrivate=1===this.UYa;this.vq.isPaused=!1;this.vq.participantsCount=0;this.vq.sessionCurrentState=0;const gd=vc.then(od=>{const Vd=new Ji;Vd.participantUrl=od.sessionInfo.shortParticipantUrl;Vd.sessionQRCode=od.sessionInfo.sessionQRCode;this.vq.sessionCurrentState=1;return Vd});this.vq.sessionURLPromise=gd;this.ka.qsd?this.Rlc.then(()=>
{this.fk.actOnSessionRequested(this.vq)}):this.fk.actOnSessionRequested(this.vq);this.jb.qOc(Object(r.a)(this,this.Wph,"onSlideShowReady"));this.jb.YLf(Object(r.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.jb.c_d(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));vc.then(od=>{this.Pd.telemetryData.pragueDocId=od.sessionInfo.pragueDocId;this.Pd.telemetryData.sessionCreationWebServiceCallTimeInMS=this.yM()-this.Fjd;this.Pd.telemetryData.startAttemptCount=od.numAttempt;
Q.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Pd.telemetryData.sessionId,this.Pd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.ka.JYe?(this.sxc(),this.Qo.InitializeStateService().then(()=>{this.BOh(od);this.E1("StartLiveBroadcasting")}).catch(Vd=>{this.Pd.telemetryData.sessionEndedBeforePragueInitialized||this.Pd.telemetryData.sessionId!==Va||(Q.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",
this.Pd.telemetryData.sessionId,Vd?Vd.toString():""),this.Pd.telemetryData.SetErrorCode(2,Vd?Vd.toString():""),this.E1("StartLiveBroadcasting"),this.WAd())})):this.BOh(od);this.ka.Ril&&$addHandler(window,"visibilitychange",Object(r.a)(this,this.S7k,"onPageVisibilityChangedHandler"));this.E1("StartLiveBroadcasting")}).catch(od=>{Q.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Pd.telemetryData.sessionId,od.toString());this.Pd.telemetryData.SetErrorCode(4,
od.toString());this.E1("StartLiveBroadcasting");this.WAd()})}else this.WAd(),this.Pd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),Q.a.J(512496225,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Sb){this.WAd(),this.Pd.telemetryData.SetErrorCode(4,Sb.toString()),Q.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Pd.telemetryData.sessionId,Sb.toString())}finally{this.E1("StartLiveBroadcasting")}}BOh(v){const S=
this.Mc.xwj(this.Mc.hra);S?this.Qo.SetDefaultSubtitlesLanguage(S):Q.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",this.Pd.telemetryData.sessionId);this.jb.FTb(!0,this.Qo.GetPragueSessionInfoJSONString());this.jb.ySa(Object(r.a)(this,this.Hrc,"onSlideShowPositionChanged"));this.jb.XLf(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.ka.JYe&&!this.fk.isWelcomeScreenVisible()||this.sxc();this.ua.raiseEvent("OnLiveSessionStarted",v.sessionInfo);
this.Uzb()||!this.Mc.p9b||this.Mc.bbg||this.lnc||!this.$Ua()||(this.uKb=!0,this.xm.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",yk.a.Oe(w.AFrameworkApplication.uiCulture).displayName),Mm.a.QLb));this.dic=this.Qo.CreateSurvey(v.authToken,null,null,null);this.dic.then(ma=>{if(ma){const Ja={};Ja.surveyeeName=w.AFrameworkApplication.userName;Ja.surveyId=ma.surveyId;Ja.surveyResponseUrl=ma.surveyResponseUrl;this.Qo.SetAudienceFeedbackInfo(JSON.stringify(Ja))}});
this.ka.isd&&(this.pPe.clear(),this.qPe.forEach(ma=>{try{const Ja=ma.F3g;this.Qo.CreateSurvey(v.authToken,null,Ja,ma.G3g).then(Va=>{Va?this.pPe.set(Ja,Va.surveyId):Q.a.J(512496222,833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Pd.telemetryData.sessionId)}).catch(Va=>{Q.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Pd.telemetryData.sessionId,Va.toString());this.Pd.telemetryData.SetErrorCode(13,
v.toString())})}catch(Ja){Q.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Pd.telemetryData.sessionId,Ja.toString())}}));this.B_a.init()?this.B_a.RZd(Object(r.a)(this,this.lrc,"onNetworkConnectivityChanged")):Q.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Pd.telemetryData.sessionId)}lng(v){v=new RegExp(String.format("[\\?&]{0}=([^&#]*)",v));return(v=window.location.search.match(v))&&2===v.length?v[1]:""}qzc(v,
S,ma,Ja,Va){this.aQe=S;this.opa=ma;this.UP=Ja;this.hcd=Va;this.Fjd=this.yM();this.Cjd=this.yM();var wb=this.lng("wdSetLiveSessionId");wb="rdvSession_"+(wb.length?wb:yb.a.create().toString());this.Pd=new PowerPointLive.LiveSessionTelemetry;this.Pd.telemetryData.sessionId=wb;this.Pd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Pd.telemetryData.accessControl=Jo[this.UYa];this.Pd.telemetryData.sessionEntryPoint=wn[v];this.Pd.telemetryData.isSubtitleStartedByLive=
this.$ea;this.Pd.telemetryData.isAutomation=this.ka.xvh;this.Pd.telemetryData.correlationId=yb.a.create().toString();this.E1("StartLiveBroadcasting");try{this.Es&&this.Qo&&this.Z8b()&&!this.vq?(this.Mxk(),this.jb.b3b(Object(r.a)(this,this.cnh,"onGetCurrentSlideShowPosition")),this.jb.getCurrentPosition(),this.Lce()&&this.fk&&this.Rlc&&this.Rlc.then(()=>{this.fk.showOnboardingScreen();this.fjf=!0}),this.l5l(S,ma,Ja,Va,wb,()=>this.L$b("StartLiveBroadcasting",this.Pd.telemetryData.sessionId))):(this.Pd.telemetryData.SetErrorCode(4,
"Live actor or broadcast monitor is null while trying to start live session!"),Q.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),this.Pd.telemetryData.isMordernSlideShow=!!this.jb&&this.jb instanceof yp.SlideShowCoreFrame}catch(Sb){this.Pd.telemetryData.SetErrorCode(4,Sb.toString()),Q.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Pd.telemetryData.sessionId,Sb.toString())}finally{this.E1("StartLiveBroadcasting")}}kfl(){if(this.Es&&
this.Xr&&this.Qo&&this.Z8b()&&!this.vq.isPaused){this.mEd(2);this.STb(2);try{this.Pd.telemetryData.sessionPauseCount+=1,this.Pd.telemetryData.sessionActiveDurationInMS+=this.yM()-this.Cjd,Q.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Pd.telemetryData.sessionId),this.fk.actOnSessionPaused(),this.vq.isPaused=!0,this.gbh=this.yM(),this.Qo.PauseLiveBroadcasting(()=>this.L$b("PauseLiveBroadcasting",this.Pd.telemetryData.sessionId)),this.ua.raiseEvent("OnLiveSessionPaused",
Sys.EventArgs.Empty),this.s5l(),this.jb.FTb(!1)}catch(v){this.Pd.telemetryData.SetErrorCode(5,v.toString()),Q.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",this.Pd.telemetryData.sessionId,v.toString())}finally{this.E1("PauseLiveBroadcasting")}}}$Gh(){if(this.Es&&this.Xr&&this.Qo&&this.Z8b()&&this.vq.isPaused)try{this.Cjd=this.yM(),this.Pd.telemetryData.sessionResumeCount+=1,Q.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",
this.Pd.telemetryData.sessionId),this.AGh(),this.fk.actOnSessionResumed(),this.Qo.ResumeLiveBroadcasting(()=>this.L$b("ResumeLiveBroadcasting",this.Pd.telemetryData.sessionId)),this.vq.isPaused=!1,this.ua.raiseEvent("OnLiveSessionResumed",Sys.EventArgs.Empty),this.Vbf(),this.jb.FTb(!0,this.Qo.GetPragueSessionInfoJSONString())}catch(v){this.Pd.telemetryData.SetErrorCode(6,v.toString()),Q.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Pd.telemetryData.sessionId,
v.toString())}finally{this.E1("ResumeLiveBroadcasting")}}S8b(v){if(this.Es&&this.Xr&&this.Qo&&this.Z8b()){this.STb(3);try{this.gcm(v,()=>{this.Pd.telemetryData.sessionExitPoint=Ln[v];this.vq.isPaused||(this.Pd.telemetryData.sessionActiveDurationInMS+=this.yM()-this.Cjd);this.L1&&this.CCb();this.Vbf();this.$Ua()&&this.xm.instance.hide();Q.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Pd.telemetryData.sessionId);this.fk.actOnSessionEnded();this.jb.rvd(Object(r.a)(this,
this.Wph,"onSlideShowReady"));this.jb.Dmb(Object(r.a)(this,this.Hrc,"onSlideShowPositionChanged"));this.jb.gEh(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.jb.iEh(Object(r.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.B_a.KDh(Object(r.a)(this,this.lrc,"onNetworkConnectivityChanged"));this.jb.s3e(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.cJa&&this.jb.FTb(!1);this.dic=this.vq=null;this.ua.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);
this.ka.psd&&this.Mc.p9b&&(this.lnc=this.uKb=!1);if(3!==v){const S=this.Qo.EndLiveBroadcasting(()=>this.L$b("EndLiveBroadcasting",this.Pd.telemetryData.sessionId));S?S.then(()=>{this.E1("EndLiveBroadcasting");Q.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",this.Pd.telemetryData.sessionId)}).catch(ma=>{this.Pd.telemetryData.SetErrorCode(7,ma.toString());this.E1("EndLiveBroadcasting");Q.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",
this.Pd.telemetryData.sessionId,ma.toString())}):(this.Pd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),Q.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Qo.CleanUpBroadcastBeforeEnd(),Q.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.E1("EndLiveBroadcasting")})}catch(S){this.Pd.telemetryData.SetErrorCode(7),Q.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",
this.Pd.telemetryData.sessionId,S.toString())}finally{3!==v&&this.Ppb(),this.E1("EndLiveBroadcasting")}}}zMh(){this.Es&&this.Qo&&this.Qo.SetPresenterState("muted")}AMh(){this.Es&&this.Qo&&this.Qo.SetPresenterState("unmuted")}showCallout(v){this.Es&&this.fk&&(this.Wcd=!0,this.fk.showCallout(v))}showWelcomeScreen(){this.Es&&this.fk&&(this.fk.showWelcomeScreen(),this.c8e())}showEndSessionDialog(v,S){this.Es&&this.Xr&&this.fk&&this.fk.showEndSessionDialogWithCallbacks(v,S)}WAd(){this.fk.isWelcomeScreenVisible()||
this.vq.isPaused||this.showWelcomeScreen();this.vq=null;this.fk.onSessionRequestError()}Z8b(){if(this.Es&&!this.fk&&this.oga){const v=new ro;v.hostElement=this.oga;v.baseZIndex=50005;v.welcomeScreenBackgroundImageUrl=this.te.Ok("LiveWelcomeScreenBackground.png");v.welcomeScreenErrorImageUrl=this.te.Ok("LiveWelcomeScreenError.png");v.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";v.calloutContainerId="LiveCalloutContainer";v.urlBarLayerHostId="LiveURLBarLayerHost";v.dialogLayerHostId="LiveDialogLayerHost";
v.reactionsBarLayerHostId="LiveReactionBarLayerHost";v.showTryAgainButton=!0;v.isPowerpointLiveReactionEnabled=!id.a("PPTLive.ReactionToggleInLiveCallout");v.onboardingScreenHostId="LiveOnboardingScreenLayerHost";v.resourceCDNPath=this.ka.Clb;v.enablePrefetchLiveResource=this.ka.qsd;v.enableNewLiveWelcomeScreen=this.ka.qsd;v.userSessionId=this.aQe;v.podsUrl=this.opa;this.fk=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(v);this.fk.on("OnWelcomeScreenOpenedAction",()=>{this.uNa("LiveWelcomeScreenLayerHost");
this.c8e();this.Afh=Date.now();this.Pd.telemetryData.welcomeShownCount+=1});this.fk.on("OnWelcomeScreenClosedAction",()=>{this.jHb&&this.fk.hideURLBar();this.gXf();this.jb.restoreFocus();this.Pd.telemetryData.welcomeScreenDurations.push(Date.now()-this.Afh);this.Pd.telemetryData.welcomeScreenFirstTimeDuration=this.Pd.telemetryData.welcomeScreenDurations[0];this.E1("OnWelcomeScreenClosedAction");this.Qo.SetWelcomeScreenState(!1);this.ka.isd&&this.DZh();this.uKb&&this.$Ua()&&window.setTimeout(()=>{this.xm.instance.hide();
this.uKb=!1},5E3)});this.fk.on("ResumeSessionAction",()=>{this.$Gh();this.jHb||this.fk.showURLBar()});this.fk.on("EndSessionAction",()=>{this.S8b(this.cJa?1:2);this.jb.restoreFocus()});this.fk.on("OnCalloutOpenedAction",()=>{this.Wcd=!0;this.ua.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);this.Pd.telemetryData.calloutShownCount+=1});this.fk.on("OnCalloutClosedAction",()=>{this.Wcd=!1;this.ua.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.jb.restoreFocus()});this.fk.on("OnEndSessionDialogOpenedAction",
()=>{this.lQl()});this.fk.on("OnEndSessionDialogClosedAction",()=>{this.TGl()});this.fk.on("OnCalloutMenuDefinitionChangedAction",()=>{this.ua.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.fk.on("OnTryAgainAction",()=>{Q.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",this.Pd.telemetryData.sessionId);this.qzc(5,this.aQe,this.opa,this.UP,this.hcd)});this.fk.on("PresenterDisabledReactions",()=>{this.sGe=!1});this.fk.on("PresenterEnabledReactions",()=>
{this.sGe=!0});this.fk.on("OnOnboardingScreenOpenedAction",()=>{this.uNa("LiveOnboardingScreenLayerHost");this.c8e()});this.fk.on("OnOnboardingScreenClosedAction",()=>{this.sxc()})}return!!this.fk}sxc(){this.fk&&(this.Lce()&&this.fk.isOnboardingScreenVisible()?this.uNa("LiveOnboardingScreenLayerHost"):this.fk.isWelcomeScreenVisible()?this.uNa("LiveWelcomeScreenLayerHost"):(-1!==this.Slc&&this.gXf(),this.jb.restoreFocus()))}Qik(){const v=document.getElementById("LiveWelcomeScreenLayerHost"),S=document.getElementById("LiveOnboardingScreenLayerHost");
let ma=!1;v&&(ma=v.contains(document.activeElement));return document.activeElement===S||document.activeElement===v||ma}c8e(){this.fk&&-1===this.Slc&&(this.Slc=window.setInterval(()=>{this.Qik()||this.sxc()},500))}gXf(){window.clearInterval(this.Slc);this.Slc=-1}uNa(v){this.oga&&this.fk&&window.setTimeout(()=>{Jb.FocusManager.dr(this.oga.ownerDocument.getElementById(v))},50)}lQl(){this.cJa?this.uNa("LiveDialogLayerHost"):(this.Fa.O4c(dd.a.IYe,dd.a.Nj,document.getElementById("LiveDialogLayerHost")),
this.Fa.qk(dd.a.IYe,!0))}TGl(){this.cJa?this.jb.restoreFocus():this.Fa.qk(dd.a.IYe,!1)}Ksg(){this.ka.psd&&this.Mc.p9b&&(this.$Ua()&&this.uKb&&(this.xm.instance.hide(),this.uKb=!1),this.lnc=!0)}Mxk(){try{this.Rlc||!this.Lce()&&!this.ka.qsd||(this.Rlc=Ia.a(C.a.instance)("liveActorLazy"))}catch(v){Q.a.J(512496205,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Pd.telemetryData.sessionId,v.toString())}}Wph(){this.Es&&this.Qo&&(this.cVa?(window.setTimeout(()=>
{this.ua.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.$Gh()):this.vq&&this.fk&&this.fk.isWelcomeScreenVisible()&&this.sxc())}Hrc(v,S){this.Es&&this.Qo&&(this.Qo.SetCurrentPosition(S.slideId,S.slideIndex,S.OAc),this.ugb!==S.slideId&&this.AGh(),this.ugb=S.slideId,this.Gwa&&(this.PYa&&10>this.lmc&&10*this.Gwa.size>=this.lmc*this.PYa.size&&(this.STb(4),this.lmc+=1),this.Gwa.add(S.slideId)),this.ka.isd&&this.DZh(),v=!!this.PYa&&this.PYa.size>=this.ka.qil,this.ugb===this.IKe&&v&&
this.ycm())}Uph(){this.jHb=!0;this.Es&&this.Xr&&this.fk&&(this.fk.hideURLBar(),this.mEd(1),this.STb(1))}Vph(){this.jHb=!1;this.Es&&this.Xr&&this.fk&&this.fk.showURLBar()}onSubtitleUpdated(v,S){this.Es&&this.Xr&&this.Qo&&(S.isFinal?this.Qo.UpdateFinalSubtitles(S.fZh):this.Qo.UpdatePartialSubtitles(S.fZh))}onTranscriberStarted(v,S){this.Pd.telemetryData.transcriberSessionIds+=S.eZh+",";this.Es&&this.Xr&&this.jb.FTb(!0,this.Qo.GetPragueSessionInfoJSONString())}s5l(){Q.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",
this.Pd.telemetryData.sessionId);-1!==this.HIb&&window.clearInterval(this.HIb);this.MJb=30;this.HIb=window.setInterval(Object(r.a)(this,this.ofl,"pausedSessionAutoExpireTimerCallBack"),6E4)}Vbf(){-1!==this.HIb&&(Q.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Pd.telemetryData.sessionId),window.clearInterval(this.HIb),this.HIb=-1)}ofl(){--this.MJb;0>=this.MJb?(Q.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Pd.telemetryData.sessionId),this.CCb(),
this.S8b(3)):this.L1&&(this.L1.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.MJb.toString()))}O0l(){if(!this.L1&&this.Us&&!w.AFrameworkApplication.Dh&&0!==this.vq.sessionCurrentState){var v=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.MJb.toString());v=new aq.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,v,null);v.closeable=!0;v.xU=Object(r.a)(this,this.i3k,"onBusinessBarClosed");v.image=3;v.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,
Object(r.a)(this,this.k3k,"onBusinessBarResumeSessionButtonClicked"),"");v.sZd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(r.a)(this,this.j3k,"onBusinessBarEndSessionButtonClicked"));this.Us.businessBar.Ei(v,!1);this.Us.qv();this.L1=v}}Fxe(){var v=6E4*this.ka.Wil;v=0<v?this.yM()-this.Fjd>=v:!1;Q.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",v);return v}CCb(){try{this.Us&&this.L1?(this.Vbf(),this.Us.businessBar.removeEntry(this.L1),this.Us.qv(),Q.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",
!this.L1.businessBar),this.L1=null):Q.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.Us,!!this.L1)}catch(v){Q.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",v.toString())}}i3k(v){v===this.L1&&(this.L1=null)}k3k(v){v===this.L1&&this.fk&&(this.CCb(),this.Fxe()||w.AFrameworkApplication.Pa.nb($a.a.NAa,2))}j3k(v){v===this.L1&&this.fk&&(this.Fxe()?this.CCb():this.fk.showEndSessionDialog())}S7k(){const v=this.yM(),
S=window.document.hidden;Q.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",S?"hidden":"visible",v);S||this.cVa&&18E5<=v-this.gbh&&this.CCb()}Tfe(v,S,ma){return!this.ka.powerPointLiveBroadcastEnabled||0===this.UYa&&this.ka.isBlueChicken?new Promise(Ja=>{Ja(null)}):!ma&&!this.pN||ma&&!this.hEe?(Q.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",v,S,ma),new Promise((Ja,Va)=>{Va("AuthHelperNotSet")})):
new Promise((Ja,Va)=>{const wb=this.ka.hostAuthType;let Sb="";if("aad"===wb||this.ka.isBlueChicken)Sb=this.ka.pptLiveResourceUri;else if("msa"===wb)Sb=this.ka.Vil;else{Q.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",v,S);Va("HostAuthTypeInvalid");return}const vc="true"===w.AFrameworkApplication.fa.Ea("IsAnonymousUser").toLowerCase();let gd=w.AFrameworkApplication.fa.Ea(w.AFrameworkApplication.uL);hc.a.Ta(gd)&&(gd="Unset");const od=new Date;
let Vd=null;Vd=ma?this.hEe.zdm(this.ka.eil,this.ka.dil,Sb,w.AFrameworkApplication.fa.Ea("UserPrincipalName"),this.ka.sil,this.ka.hil&&"StartLiveBroadcasting"===v&&!this.ka.Kvh):this.pN.vH(this.ka.pptLiveImplicitAuthAppName,Sb);Vd.then(Ke=>{this.$Jg(S,v,wb,ma,vc,gd,Ke.IsSuccess,+new Date-+od,Ke.ErrorCode,Ke.ErrorMessage);Ke.IsSuccess?Ja(Ke.Token):Va(Ke.ErrorCode)}).catch(Ke=>{this.$Jg(S,v,wb,ma,vc,gd,!1,+new Date-+od,"exception",Ke.toString());Va("exception")})})}L$b(v,S){if(!this.ka.powerPointLiveBroadcastEnabled||
0===this.UYa&&this.ka.isBlueChicken)return new Promise(Ja=>{Ja(null)});Q.a.J(508384139,833,50,"LivePresenter::GetToken with user credentials for type: {0}",this.ka.hostAuthType);const ma=this;return new Promise((Ja,Va)=>{const wb=this.ka.getBooleanAppSetting("PowerpointLiveBroadcastEnableDirectAuthFallback");ma.Tfe(v,S,!1).then(Sb=>{Q.a.J(508384138,833,50,"LivePresenter::GetToken succeeded with OAuth");Ja(Sb)}).catch(Sb=>{Q.a.J(508384137,833,50,"LivePresenter::GetToken - failed OAUth token retrieval: {0}",
Sb.toString());ma.Tfe(v,S,!1).then(vc=>{Q.a.J(508384136,833,50,"LivePresenter::GetToken - Retry with OAuth succeeded");Ja(vc)}).catch(vc=>{Q.a.J(508384135,833,50,"LivePresenter::GetToken - failed OAUth token retrieval Retry: {0}",vc.toString());wb?ma.Tfe(v,S,!0).then(gd=>{Q.a.J(508621791,833,50,"LivePresenter::GetToken - Retry with Direct Auth succeeded");Ja(gd)}).catch(gd=>{Q.a.J(508384134,833,50,"LivePresenter::GetToken - Direct auth Re-Retry Failed with error:{1}",gd.toString());Va(gd)}):(Q.a.J(508384133,
833,50,"LivePresenter::GetToken - Request Failed with error:{1}",vc.toString()),Va(vc))})})})}yM(){return(new Date).getTime()}$Jg(v,S,ma,Ja,Va,wb,Sb,vc,gd,od){const Vd={};Vd.SessionId=v;Vd.Action=S;Vd.HostAuthType=ma;Vd.UseDirectAuth=Ja;Vd.IsAnonymousUser=Va;Vd.UiHost=wb;Vd.IsSuccess=Sb;Vd.Latency=vc;Vd.ErrorCode=gd;Vd.ErrorMessage=od;Q.a.J(51197915,833,50,JSON.stringify(Vd))}E1(v){this.Pd.telemetryData.action=v;this.Pd.telemetryData.sessionDurationInMS=this.yM()-this.Fjd;this.Pd.telemetryData.hostAuthType=
this.ka.hostAuthType;this.Pd.SetStateServiceMetrics();this.Pd.telemetryData.errorCode.length&&(!this.Pd.telemetryData.errorMessage.length||0>Array.indexOf(this.ka.kil,this.Pd.telemetryData.errorMessage))&&(this.Pd.telemetryData.hasUnexpectedError=!0);v=this.ka.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==v.indexOf("pptservicescast.officeapps.live.com")?this.Pd.telemetryData.rendezvousServiceEnvironment="prod":-1!==v.indexOf("pptservicescast.edog.officeapps.live.com")?this.Pd.telemetryData.rendezvousServiceEnvironment=
"edog":-1!==v.indexOf("pptservicescast.officeapps.live-int.com")?this.Pd.telemetryData.rendezvousServiceEnvironment="int":this.Pd.telemetryData.rendezvousServiceEnvironment="dev";Q.a.J(50706442,833,this.Pd.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Pd.telemetryData))}WVi(v){if(this.Wb)try{var S=this.Uq.presentation;if(!S)throw Error.argumentNull("Presentation is null");const ma=S.slides||[];this.IKe=ma[ma.length-1].sid;let Ja=S=!1;this.PYa=new Set;for(const Va of ma)S||Va.sid!==v||
(S=!0,Ja=Va.Hn),!S||Va.Hn&&!Ja||this.PYa.add(Va.sid),Ja&&!Va.Hn&&(Ja=!1)}catch(ma){this.Pd.telemetryData.SetErrorCode(16,ma.toString()),Q.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Pd.telemetryData.sessionId,ma.toString())}}mEd(v){return new Promise(S=>{if(this.Es&&this.Qo&&this.vq&&this.dic)try{this.dic.then(ma=>{let Ja=!1;switch(v){case 2:if(!this.Gwa||!this.PYa||10*this.Gwa.size<8*this.PYa.size){S(!0);
return}break;case 3:Ja=!0}const Va={triggeredSurveyType:"Survey.AudienceFeedback"};Va.isMandatory=Ja;Va.triggerEventId=yb.a.create().toString();Va.surveyeeName=w.AFrameworkApplication.userName;ma?(Va.surveyId=ma.surveyId,Va.surveyResponseUrl=ma.surveyResponseUrl):Q.a.J(512496192,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Pd.telemetryData.sessionId);this.Qo.TriggerSurvey(JSON.stringify(Va));Q.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",
this.Pd.telemetryData.sessionId,v);S(!0)}).catch(ma=>{Q.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Pd.telemetryData.sessionId,ma.toString());this.Pd.telemetryData.SetErrorCode(13,ma.toString());S(!1)})}catch(ma){this.Pd.telemetryData.SetErrorCode(17,ma.toString()),Q.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
this.Pd.telemetryData.sessionId,ma.toString()),S(!1)}else S(!0)})}cnh(v,S){this.jb&&this.Qo&&S&&(this.jb.Bmb(Object(r.a)(this,this.cnh,"onGetCurrentSlideShowPosition")),this.Qo.SetCurrentPosition(S.slideId,S.slideIndex,S.OAc))}Zya(v,S){this.fk&&this.fk.actOnCurrentSlideDimensionChange(S.slideHeight,S.PSh,S.slideWidth,S.TSh)}getCalloutMenuDefinition(){return this.Z8b()?this.fk.getCalloutMenuDefinition():null}G$j(){const v=String.format("{0}{1}",this.ka.Clb,"reactions/heart/default/240_anim_f/heart.png"),
S=String.format("{0}{1}",this.ka.Clb,"reactions/yes/default/240_anim_f/yes.png"),ma=String.format("{0}{1}",this.ka.Clb,"reactions/clap/default/240_anim_f/clap.png"),Ja=String.format("{0}{1}",this.ka.Clb,"reactions/laugh/default/240_anim_f/laugh.png"),Va=String.format("{0}{1}",this.ka.Clb,"reactions/surprised/default/240_anim_f/surprised.png"),wb=String.format("{0}{1}",this.ka.Clb,"reactions/wonder/default/240_anim_f/wonder.png");this.Soa=[Object.assign(new Kn,{react:"yes",reactionCount:0,reactionImagePath:S,
numberOfAnimationFrames:40}),Object.assign(new Kn,{react:"heart",reactionCount:0,reactionImagePath:v,numberOfAnimationFrames:16}),Object.assign(new Kn,{react:"clap",reactionCount:0,reactionImagePath:ma,numberOfAnimationFrames:40}),Object.assign(new Kn,{react:"laugh",reactionCount:0,reactionImagePath:Ja,numberOfAnimationFrames:77}),Object.assign(new Kn,{react:"surprised",reactionCount:0,reactionImagePath:Va,numberOfAnimationFrames:68}),Object.assign(new Kn,{react:"wonder",reactionCount:0,reactionImagePath:wb,
numberOfAnimationFrames:70})];this.Hob=new Map;this.lmc=1;this.Vfd=null}AGh(){if(this.Soa){for(const v of this.Soa)v.reactionCount=0;this.fk&&this.fk.resetReactions()}}I_k(v){if(this.Hob){var S=this.Hob.has(v.slideId)?this.Hob.get(v.slideId)+1:1;this.Hob.set(v.slideId,S)}if(this.Soa&&!this.cVa&&this.sGe){for(const ma of this.Soa)if(ma.react===v.react){ma.reactionCount+=1;break}if(this.fk){v=Array(this.Soa.length);for(S=0;S<this.Soa.length;S++)v[S]=Object.assign(new Kn,{react:this.Soa[S].react,reactionCount:this.Soa[S].reactionCount,
reactionImagePath:this.Soa[S].reactionImagePath,numberOfAnimationFrames:this.Soa[S].numberOfAnimationFrames});this.fk.setReactions(v)}}}STb(v){return new Promise(S=>{if(this.Es&&this.Qo&&this.vq)try{if(1>this.Hob.size)Q.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Pd.telemetryData.sessionId,v),S(!0);else if(2===v&&(!this.Gwa||1>this.Gwa.size))Q.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",
this.Pd.telemetryData.sessionId,v),S(!0);else{var ma=null,Ja=0;this.Hob.forEach((wb,Sb)=>{wb>Ja&&(ma=Sb.toString(),Ja=wb)});if(this.Vfd&&ma===this.Vfd)Q.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Pd.telemetryData.sessionId,v),S(!0);else{var Va=this.Qo.TriggerSaveThumbnails(()=>this.L$b("SaveThumbnails",this.Pd.telemetryData.sessionId),ma);Va?Va.then(()=>{this.Vfd=ma;Q.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",
this.Pd.telemetryData.sessionId,v);S(!0)}).catch(wb=>{Q.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Pd.telemetryData.sessionId,wb.toString(),v);S(!1)}):(this.Pd.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),Q.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),S(!1))}}}catch(wb){this.Pd.telemetryData.SetErrorCode(15,
wb.toString()),Q.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Pd.telemetryData.sessionId,wb.toString()),S(!1)}else S(!0)})}$Ua(){return this.ka.pptEditorVoiceUXEnabled&&this.xm&&this.xm.instance?!0:!1}AZi(v){if(this.$Ua())switch(v){case 0:this.cJa&&this.xm.instance.show(ResourceStrings.L_LivePresentations_Disconnected,Mm.a.$0a);this.Pd.telemetryData.SetErrorCode(3);this.E1("DisconnectdToPrague");break;case 1:this.xm.instance.hide();break;
case 2:this.cJa&&this.xm.instance.show(ResourceStrings.L_LivePresentations_Connecting,Mm.a.QLb);break;default:Q.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Pd.telemetryData.sessionId)}else Q.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Pd.telemetryData.sessionId)}lrc(v,S){this.$Ua()?S.isConnected?this.xm.instance.hide():this.cJa&&this.xm.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,
Mm.a.QLb):Q.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Pd.telemetryData.sessionId)}Gie(v,S){v=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.ka.podsWebServiceBase,v,S);this.ka.uil&&(v+="&shareable=true");return v}gcm(v,S){try{const ma=new ca.a;if(1===v||2===v||4===v)ma.add(this.mEd(3)),ma.add(this.STb(3));ma.count?Promise.all(ma.toArray()).then(()=>S()).catch(()=>S()):S()}catch(ma){Q.a.J(512496150,
833,10,"failed to create end session task promises, error : {0}",ma),S()}}get fjf(){const v=Pl.a.get("PPTLivePresentationOnboarded");return v?"true"===v.toLowerCase():!1}set fjf(v){Pl.a.lL("PPTLivePresentationOnboarded",v.toString(),Pl.a.VK)||Q.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",v.toString())}Lce(){return this.ka.Xil&&!this.fjf}Kba(){try{if(Q.a.J(512496148,833,15,"Pods session rehydrated!"),this.Zcd=!0,this.Es&&this.Xr&&this.Qo){Q.a.J(512496147,833,
15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Pd.telemetryData.sessionId,this.Xa.$k);const v=this.Gie(this.Xa.podSessionId,this.Xa.$k);this.Qo.OnPodSessionUpdated(v)}}catch(v){Q.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",v.toString())}}qMb(){this.Zcd=!1}onPodSessionExpired(){this.Zcd=!1}Ppb(){if(this.ka.Yil)try{const v=C.a.instance.Ha("Common.ISystemInitiatedFeedback");v&&(Q.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),
v.execute(S=>{S.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(v){Q.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",v)}}Omg(v){const S=document.createElement("a");S.setAttribute("href",v);return(v=S.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===v.length?v[1]:""}ctj(){var v=this.Wb.Tke();let S=1;this.qPe.clear();for(const ma of v){v=ma.yj();for(const Ja of v)if(!hc.a.Ta(Ja.vkb)){v=
this.Omg(Ja.vkb);const Va=new dq;Va.F3g=v;Va.G3g=S.toString();this.qPe.add(Va);S+=1}}}DZh(){var v=this.Wb.LGa(this.ugb).yj();for(const S of v)hc.a.Ta(S.vkb)||(v=this.Omg(S.vkb),v=this.pPe.get(v),hc.a.Ta(v)||this.Qo.SetCurrentPollInfoState(v,this.ugb))}Azi(v){this.ua.addHandler("OnLiveResourcesLoaded",v)}OBl(v){this.ua.removeHandler("OnLiveResourcesLoaded",v)}VLf(v){this.ua.addHandler("OnLiveSessionStarted",v)}eEh(v){this.ua.removeHandler("OnLiveSessionStarted",v)}TLf(v){this.ua.addHandler("OnLiveSessionEnded",
v)}dEh(v){this.ua.removeHandler("OnLiveSessionEnded",v)}Dyi(v){this.ua.addHandler("OnCalloutDismissed",v)}hBl(v){this.ua.removeHandler("OnCalloutDismissed",v)}QLf(v){this.ua.addHandler("OnRelaunchPausedSession",v)}aEh(v){this.ua.removeHandler("OnRelaunchPausedSession",v)}Eyi(v){this.ua.addHandler("CalloutMenuDefinitionChanged",v)}iBl(v){this.ua.removeHandler("CalloutMenuDefinitionChanged",v)}}Object(k.a)(dp,"LivePresenter",null,[1118]);class Ko{constructor(){this.K=null;this.q1g=0}get name(){return"PowerPointWebEditor.Live"}fc(v){this.K=
v;const S=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(1118,"PowerPointLive.ILivePresenter").ma().na(()=>new dp(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),S,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),C.a.instance.Ha("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),this.K.resolve("PowerPointWebEditor.IFocusManager")))}Nxk(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.q1g=Date.now(),Q.a.J(509441559,
833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),ib.a.get_instance().Ij(7,()=>{const v=this.K.resolve("Common.IDynamicScriptLoaderProvider").nG,S=Ia.a(this.K),ma=new ca.a;ma.add(v.loadScript("PPTLiveBroadcast"));ma.add(v.loadScript("BroadcastMonitor"));ma.add(S("liveActor"));w.AFrameworkApplication.za.mb.es||ma.add(S("uiFabricLazy"));Promise.all(ma.toArray()).then(()=>this.Q6k()).catch(Ja=>Q.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Ja))})):
Q.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(v){Q.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",v)}}Pn(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qil){const v=hc.a.AR((w.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===v||".pps"===v){Q.a.J(509441556,
833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==v&&Q.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+v)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").Til&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?Q.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uil&&
(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?Q.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jvh&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?Q.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):this.K.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(v=>
{v.isFeatureEnabled("PowerPointLivePresentations",!1).then(S=>{S?this.Nxk():(Q.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else Q.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(v){Q.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",v)}}Q6k(){Q.a.J(509441549,833,
50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.q1g);this.K.resolve("PowerPointLive.ILivePresenter").obb=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jvh||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){w.AFrameworkApplication.fa.Ue(Object(r.a)(this,this.Pn,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Ac(new Ko)}}
Object(k.a)(Ko,"PPTWebEditorLivePackage",null,[2,3]);var tm=d(744);class so{}Object(k.a)(so,"LokiTokenResult",null,[]);class ai{constructor(v){this.cJc=v}VEj(){const v=this.UEj();return v?ai.zwe?new Promise((S,ma)=>{this.cJc.continueWith(()=>{this.cJc.Ao||this.cJc.Pm?ma(Error.create("Error downloading auth library")):this.cJc.result.vH("Loki",v).then(Ja=>{Ja=w.AFrameworkApplication.fa.getBooleanAppSetting("ForceLokiFallbackToACLPTokenIsEnabled")?this.YEj():Ja.IsSuccess&&Ja.Token?Object.assign(new so,
{isSuccess:!0,token:Ja.Token,errorMessage:null}):Object.assign(new so,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Ja)});S(Ja);return Ja})})}):Promise.resolve(Object.assign(new so,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new so,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",tm.a.kgg())}))}YEj(){const v=w.AFrameworkApplication.fa.Ea("LokiUserDataSignature")||
"";return Object.assign(new so,{isSuccess:!0,token:v,errorMessage:null})}UEj(){let v=null;const S=tm.a.KZc();2===S?v=w.AFrameworkApplication.fa.Ea("LokiAADAppId"):1===S&&(v=w.AFrameworkApplication.fa.Ea("LokiMSAAppId"));return v}static get zwe(){return w.AFrameworkApplication.fa.getBooleanAppSetting("IsO365CommercialHost")||w.AFrameworkApplication.fa.getBooleanAppSetting("IsO365ConsumerHost")}}Object(k.a)(ai,"LokiTokenManager",null,[1222]);class vr{get name(){return"Common.App.LivePersonaUtils"}init(){C.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}fc(v){v.register(ai,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().na(()=>new ai(Ye.a.Au(v.Ha("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Ac(new vr)}}Object(k.a)(vr,"LivePersonaUtilsPackage",null,[2,3]);var wr=d(249);class Bq{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(k.a)(Bq,"RehearsalCritique",null,[]);class oe{static E9j(){oe.ZZ[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;oe.ZZ[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
oe.ZZ[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;oe.ZZ[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;oe.$4f=ResourceStrings.L_SubtitleDetection_MicReady;oe.a5f=ResourceStrings.L_SubtitleDetection_SoundReminder;oe.c$f=ResourceStrings.L_SubtitleDetection_NoMicrophone;oe.i$f=ResourceStrings.l_NoCamera;oe.Dfg=ResourceStrings.L_SpeechGenericRetryErrorMessage}}oe.qTf=20;oe.hCh=50002;oe.ZZ=Array(oe.qTf);oe.$4f=null;oe.a5f=null;oe.c$f=null;oe.i$f=null;oe.Dfg=null;oe.vde="fillerWords";
oe.Abl="originality";oe.Dpm="wordsPerMinute";oe.rNl="sensitivePhrases";oe.m1i="correctedSensitivePhrases";oe.Lhl="positivity";oe.qme="grammar";oe.uRe="monotone";oe.n_e="pronunciation";oe.N8d="crutchWords";oe.u5h="visionFace";oe.Wnm="visionGaze";oe.Vnm="visionGazeGood";oe.Ynm="visionOcclusion";oe.Xnm="visionOcclusionGood";oe.Snm="visionDistanceGood";oe.Tnm="visionDistanceTooClose";oe.Unm="visionDistanceTooFar";oe.cpg="GetStartedButton";oe.axk="ListeningButtonPlayPauseButton";oe.bxk="ListeningElement";
oe.VZi="ContainerElement";oe.nfl="PausedElement";oe.O0k="NotificationButtonElement";oe.Jom="WelcomeCheckboxElement";oe.jCh="RehearsalFeedbackSettingPane";oe.FYe="PPTCoachRehearsalFREShown";Object(k.a)(oe,"RehearsalResourceString",null,[]);const Mn=(v,S)=>hc.a.Ta(S)?(n.ULS.sendTraceTag(508692422,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):v?S.toLowerCase()in v:!0,Fl=(v,S)=>{let ma=null;try{if(!v||hc.a.Ta(S))return n.ULS.sendTraceTag(508692421,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Va=hc.a.Ta(v.Uud)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(v.Uud,!0);ma={};for(const wb in Va){v=wb;var Ja=Va[wb];if(Ja){const Sb=xf.a.p4b(Ja.split(","));Sb&&S.toLowerCase()in Sb&&(ma[v.toLowerCase()]=!0)}}}catch(Va){Q.a.J(508692420,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Va.toString()),ma=null}return ma},yv=(v,S)=>{if(hc.a.Ta(S)||hc.a.Ta(v.Guh))return null;try{var ma=Sys.Serialization.JavaScriptSerializer.deserialize(v.Guh,
!0);if(hc.a.Ta(S)){n.ULS.sendTraceTag(508692416,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Ja=null}else Ja=S.split("-")[0].toLowerCase();return ma[Ja]}catch(Va){return Q.a.J(508692417,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Va.toString()),null}},ep=v=>{if(v&&3<v.length){let S="";"ws"===v.substring(0,2)?S="http"+v.substring(2,v.length):"wss"===v.substring(0,3)&&(S="https"+v.substring(3,
v.length));return S}return v},$r=v=>{if(hc.a.Ta(v))return n.ULS.sendTraceTag(508692387,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",v),"en-US";switch(v.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return v}};class eq{constructor(){this.userCritiques=null}}Object(k.a)(eq,"RehearseRoamingSettings",null,[]);class Cq{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(k.a)(Cq,"UserCritiqueSettings",null,[]);class Qs{constructor(v,S,ma,Ja){this.ua=new xd.a;this.LK=this.Ric=this.OV=null;this.eN=!1;this.FNg=null;this.dya=this.eya=0;this.Ms=v;this.ka=S;this.Tga=ma;this.ia=Ja}Pak(){try{this.qng(()=>{this.ua.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(v){Q.a.J(508692293,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",v.toString())}}A8c(){return 2===this.eya&&2===this.dya}ygf(){try{0!==
this.eya&&3!==this.eya||this.qng(Object(r.a)(this,this.l1e,"raiseRehearsalGetCritiquesEvent")),0!==this.dya&&3!==this.dya||this.DAj()}catch(v){Q.a.J(508692292,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",v.toString())}}kyj(){if(!this.Ric)return Q.a.J(508692291,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.LK)for(const v of this.Ric)this.LK.contains(v.critique.toLowerCase())?v.optOut=!0:v.optOut=!1}catch(v){Q.a.J(508692290,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
v.toString())}return this.Ric.toArray()}njm(v,S){this.d3h(v,S);"vision"===v.toLowerCase()&&(this.eN=!S,v={},v.triggerPoint=oe.jCh,this.ia.Ia($a.a.zTb,2,v))}fmg(v=!1){let S="";if(this.LK&&0<this.LK.count)if(id.a("RehearsalFilterOptOutCritiqueEnabled")&&v){a:{var ma=this.ka;v=this.ka.Oza;var Ja=null;try{if(!ma||hc.a.Ta(v)){n.ULS.sendTraceTag(508692419,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Va=null;break a}var wb=
hc.a.Ta(ma.Uud)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(ma.Uud,!0);Ja={};for(const vc in wb){Va=vc;var Sb=wb[vc];if(Sb){const gd=xf.a.p4b(Sb.split(","));Ja[Va.toLowerCase()]=gd&&v.toLowerCase()in gd?!0:!1}}}catch(vc){Q.a.J(508692418,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",vc.toString()),Ja=null}Va=Ja}if(Sb=Va)for(const vc of this.LK)if(wb="vision"===vc?oe.u5h.toLowerCase():vc.toLowerCase(),wb in Sb?Sb[wb]:1)S=
hc.a.Ta(S)?vc.toLowerCase():S+","+vc.toLowerCase()}else for(Ja of this.LK)S=hc.a.Ta(S)?Ja.toLowerCase():S+","+Ja.toLowerCase();return S}bxd(){if(2!==this.eya)Q.a.J(508692289,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.Gpk()){Q.a.J(508692259,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var v=new eq;v.userCritiques=Object.assign(new Cq,{critiquesDisabled:this.fmg(),critiquesDisabledByDefault:this.OV.userCritiques.critiquesDisabledByDefault});
var S=Ag.c(v),ma=this.ka.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",w.AFrameworkApplication.mh),Ja={};Ja["X-StatelessPopsAffinityRoutingEnabled"]=this.ka.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ms.Tj(ma,2,S,Ja,!1,2,Va=>{this.p9k(Va,v)},Object(r.a)(this,this.o9k,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,wr.a("17"))}else Q.a.J(508692288,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get Wce(){return this.eN}set Wce(v){this.eN=
v;this.d3h("vision",!this.eN);this.A8c()&&this.ua.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}tzi(v){this.ua.addHandler("OnRehearsalOptOutSettingsRequestFinished",v)}JBl(v){this.ua.removeHandler("OnRehearsalOptOutSettingsRequestFinished",v)}szi(v){this.ua.addHandler("OnRehearsalGetCritiquesSucceeded",v)}IBl(v){this.ua.removeHandler("OnRehearsalGetCritiquesSucceeded",v)}rzi(v){this.ua.addHandler("OnRehearsalGetCritiquesFailed",v)}HBl(v){this.ua.removeHandler("OnRehearsalGetCritiquesFailed",
v)}uzi(v){this.ua.addHandler("OnRehearsalSettingsUpdatedExternally",v)}KBl(v){this.ua.removeHandler("OnRehearsalSettingsUpdatedExternally",v)}d3h(v,S){this.LK&&(v=v.toLowerCase(),S&&!this.LK.contains(v)?this.LK.add(v):!S&&this.LK.contains(v)&&this.LK.remove(v),id.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.bxd())}Gpk(){let v=!1;try{var S=hc.a.Ta(this.OV.userCritiques.critiquesDisabled);if(!this.LK||!this.LK.count&&S)return!1;if(S&&0<this.LK.count||!S&&!this.LK.count)return!0;const ma=new Set(this.OV.userCritiques.critiquesDisabled.split(","));
if(this.LK.count!==ma.size)return!0;for(S=0;S<this.LK.count;S++)if(!ma.has(this.LK.ga(S).toLowerCase())){v=!0;break}}catch(ma){Q.a.J(508692258,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",ma.toString())}return v}p9k(v,S){this.OV=S;Q.a.J(508692257,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+v.data.au-+v.data.cF,+v.data.Et-+v.data.cF)}o9k(v){const S=this.Tga.n$(v);Q.a.J(508692256,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
S,v.data.state)}qng(v){const S=this.ka.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",w.AFrameworkApplication.mh),ma={};ma["X-StatelessPopsAffinityRoutingEnabled"]=this.ka.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ms.Tj(S,1,null,ma,!1,2,Ja=>{this.V5k(Ja,v)},Ja=>{this.U5k(Ja,v)},null,void 0,void 0,void 0,void 0,wr.a("16"));this.eya=1}V5k(v,S){let ma=0;try{v.data.Ud&&0<v.data.Ud.trim().length&&(ma=v.data.Ud.length,
this.OV=JSON.parse(v.data.Ud));this.OV&&this.OV.userCritiques||(this.OV=new eq,this.OV.userCritiques=new Cq);hc.a.Ta(this.OV.userCritiques.critiquesDisabledByDefault)&&(this.OV.userCritiques.critiquesDisabledByDefault="vision",hc.a.Ta(this.OV.userCritiques.critiquesDisabled)?this.OV.userCritiques.critiquesDisabled="vision":this.OV.userCritiques.critiquesDisabled+=",vision");this.LK=new ca.a;if(!hc.a.Ta(this.OV.userCritiques.critiquesDisabled)){const Ja=this.OV.userCritiques.critiquesDisabled.split(",");
for(const Va of Ja)this.LK.add(Va.toLowerCase())}this.eN=!this.LK.contains("vision");this.eya=2}catch(Ja){this.eya=3,Q.a.J(508692255,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Ja.toString())}S&&S();v=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",ma,JSON.stringify(v.data.cF),JSON.stringify(v.data.Et),JSON.stringify(v.data.au));Q.a.J(508692254,822,50,v)}U5k(v,S){this.eya=3;S&&S();v=this.Tga.n$(v);Q.a.J(508692253,822,
50,"OnGetUserCritiquesFailed: Web service failed with {0}",v)}DAj(){try{const S=this.Rlj();if(hc.a.Ta(S))Q.a.J(508692252,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var v=new XMLHttpRequest;v.open("GET",S,!0);v.onreadystatechange=()=>{if(4===v.readyState){if(200===v.status){Q.a.J(508692251,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const ma=Ag.b(v.responseText);if(ma){this.Ric=new ca.a;for(const Ja of ma.critiquesData)this.Ric.add(Object.assign(new Bq,
{category:Ja.category,displayName:Ja.displayName,optOut:!1,critique:Ja.critique.toLowerCase()}));this.FNg=ma.categoriesData;this.dya=2}else this.dya=3}else this.dya=3;this.l1e()}};v.send("");this.dya=1}}catch(S){this.dya=3,this.l1e(),Q.a.J(508692250,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",S.toString())}}Rlj(){const v=Ag.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",S=this.ka.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return S&&S.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",S,v,$r(this.ka.Oza)):null}l1e(){0!==this.eya&&1!==this.eya&&0!==this.dya&&1!==this.dya&&(this.A8c()?this.ua.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.ua.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(k.a)(Qs,"RehearsalFeedbackSettings",null,[1115]);class Zm{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(k.a)(Zm,"RehearsalCritiqueWithGroupProps",null,[]);class Wq{constructor(v,S,ma,Ja,Va){this.zJa=this.Mb=!1;v("powerpoint-presenter-coach-strings").then(()=>{this.zJa=!0;Q.a.J(509138183,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(wb=>{Q.a.J(509138182,822,10,"Failed to load powerpoint-presenter-coach-strings "+wb.toString())});
this.ia=S;this.ka=Va;this.YG=ma;this.uz=Ja;this.ia.a3(this)}qb(){this.ia.xa($a.a.SAd,qb.a.application,Object(r.a)(this,this.SAd,"showRehearsalFeedbackSettingsPane"));this.ia.xa($a.a.GAd,qb.a.application,Object(r.a)(this,this.GAd,"showHideRehearsalFeedbackSettingsPane"));this.ia.pa($a.a.Mtd,qb.a.application,Object(r.a)(this,this.Mtd,"queryShowHideRehearsalFeedbackSettingsPane"),96)}Sd(){}getName(){return"RehearsalSettings"}JZ(){}IZ(){}SAd(v,S,ma){if(S.contextId!==qb.a.application||!this.zJa)return 2;
if(1===ma)return 32;this.Mb?Ac.UISurfaces.qr().then(Ja=>{Ja.setSelectedTaskPane(dd.a.smb);this.FB(!0);return null}).catch(Ja=>{Q.a.J(509138180,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Ja.toString())}):(this.Mb=!0,this.cCh(),(v=!this.uz.A8c())&&this.uz.ygf(),v=this.SA(v,!1),this.Kyc(v),Q.a.J(509138181,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}GAd(v,S,ma){if(S.contextId!==qb.a.application||!this.zJa)return 2;
if(1===ma)return 32;(this.Mb=!this.Mb)?(this.cCh(),(v=!this.uz.A8c())&&this.uz.ygf(),v=this.SA(v,!1),this.Kyc(v),Q.a.J(509138179,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.lVi(),Q.a.J(509138178,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}Mtd(v,S,ma,Ja,Va){if(!Object(Wg.a)($n.a,Va))return 8;Va.Rf(this.Mb);return 32}Kyc(v,S=!1){const ma=Object.assign(new gc.a,{title:ResourceStrings.L_RehearseFeedbackSettings,
hideHeader:!1,width:320,location:2,contentProps:v,onOpen:()=>{},onClose:()=>{this.Mb=!1;this.gaj();this.uz.bxd()},onHide:()=>{this.uz.bxd()},isModernPane:!0});v=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.YG.Lfa(dd.a.smb,dd.a.Nj,v,()=>{this.FB(!0)},()=>{this.FB(!1)});Ac.UISurfaces.qr().then(Ja=>{S?this.Mb&&Ja.updateTaskPane(dd.a.smb,ma):Ja.showTaskPane(dd.a.smb,ma);return null}).catch(Ja=>{Q.a.J(509138177,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
Ja.toString())})}lVi(){Ac.UISurfaces.qr().then(v=>{v.hideTaskPane(dd.a.smb,2);return null}).catch(v=>{Q.a.J(509138176,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",v.toString())})}SA(v,S){return Object.assign(new Zm,{groupItems:v||S?null:this.uz.kyj(),categoriesData:this.uz.FNg,locale:this.ka.Oza,updateCritiqueState:(ma,Ja)=>{this.uz.njm(ma,Ja)},retryToFetchCritiqueSettings:()=>{this.uz.ygf()},showLoadingMessage:v,showErrorMessage:S})}FB(v){const S=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
v&&S&&S.focus()}cCh(){this.uz.szi(Object(r.a)(this,this.Xoh,"onRehearsalGetCritiquesSucceeded"));this.uz.rzi(Object(r.a)(this,this.Woh,"onRehearsalGetCritiquesFailed"));this.uz.uzi(Object(r.a)(this,this.Zoh,"onRehearsalSettingsUpdatedExternally"))}gaj(){this.uz.IBl(Object(r.a)(this,this.Xoh,"onRehearsalGetCritiquesSucceeded"));this.uz.HBl(Object(r.a)(this,this.Woh,"onRehearsalGetCritiquesFailed"));this.uz.KBl(Object(r.a)(this,this.Zoh,"onRehearsalSettingsUpdatedExternally"))}Xoh(){const v=this.SA(!1,
!1);this.Kyc(v,!0)}Woh(){const v=this.SA(!1,!0);this.Kyc(v,!0)}Zoh(){const v=this.SA(!1,!1);v.isExternalUpdated=!0;this.Kyc(v,!0)}}Object(k.a)(Wq,"RehearsalFeedbackSettingsPane",null,[182]);var Dq;(function(v){v[v.none=0]="none";v[v.ribbon=1]="ribbon";v[v.slideShowToolbar=2]="slideShowToolbar";v[v.summaryPage=3]="summaryPage";v[v.ribbonTopBar=4]="ribbonTopBar";v[v.deepLink=5]="deepLink"})(Dq||(Dq={}));Object(k.b)("RehearsalEntryPoint",Dq);class as{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(k.a)(as,"ICoachActorConfig",null,[]);class Xq{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(k.a)(Xq,"ICoachFREActorConfig",null,[]);class bs{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(k.a)(bs,"ICoachSessionConfig",null,[]);class Rs{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(k.a)(Rs,"IDocumentDownloadConfig",null,[]);class Eq{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(k.a)(Eq,"ISlideState",null,[]);class cs{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(k.a)(cs,"IWebcamConfig",null,[]);var Yq=d(689);class im{constructor(v,S,ma,Ja,Va,wb,Sb,vc,gd,od,Vd,Ke,kg,If){this.xZa=!1;this.Gx=this.XCe=this.PY=this.oga=null;this.ync=0;this.J9g=-1;this.Roc=0;this.Hld=this.uld=null;this.vGe=this.lGe=!1;this.jNe=this.Toa=0;this.eN=!1;this.ua=new xd.a;this.q0a=null;this.VRg=this.cQe=this.aCe=!1;this.lNe=null;this.eic=this.$Ng=0;this.Kbh=this.rRg=!1;this.xRg=w.AFrameworkApplication.fa.getBooleanAppSetting("FirstRehearsalExperienceEnabled");
this.WGb=ma;S&&(this.oga=S.JG());this.jb=Ja;this.ia=v;this.Wb=Va;this.sa=wb;this.Xa=Sb;this.ka=vc;this.xm=gd;this.Dga=od;this.xnc=Vd;this.uz=Ke;this.vP=kg;this.nv=If;this.u9b()&&this.uz.tzi(Object(r.a)(this,this.Yoh,"onRehearsalOptOutSettingsRequestFinished"))}qb(){this.ia.xa($a.a.tzc,qb.a.application,Object(r.a)(this,this.tzc,"startRehearsalManager"));this.ia.xa($a.a.zTb,qb.a.application,Object(r.a)(this,this.zTb,"toggleRehearsalVisionEnabled"));this.ia.xa($a.a.xvc,qb.a.application,Object(r.a)(this,
this.xvc,"rehearsePresentationDropDown"));this.ia.pa($a.a.AOb,qb.a.application,Object(r.a)(this,this.AOb,"queryRehearsalVisionEnabled"),96)}AOb(v,S,ma,Ja,Va){if(!Va||!Object(Wg.a)($n.a,Va))return Q.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Va.Rf(this.eN);return 32}xvc(v,S,ma){switch(ma){case 1:if(this.xZa&&this.wye())return this.ia.nb($a.a.gia,1);break;default:Q.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}zTb(v,
S,ma,Ja,Va){switch(ma){case 2:return this.eN=!this.eN,w.AFrameworkApplication.za&&w.AFrameworkApplication.za.mb.es&&md.App.Ob.OB({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.u9b()&&Va&&Va.triggerPoint!==oe.jCh&&(this.uz.Wce=this.eN),32;case 1:if(this.xZa&&this.wye())return 32;break;default:Q.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}tzc(v,S,ma,Ja,Va){switch(ma){case 2:return this.w5l(Va),32;case 1:if(this.xZa&&this.wye())return 32;break;default:Q.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}khc(){try{this.$Ng=Date.now();const v=this.WGb.nG;v.loadScript("powerpoint-presenter-coach-strings").then(()=>{const S=new ca.a;S.add(v.loadScript("CoachActorPackage"));S.add(v.loadScript("CoachPackage"));Promise.all(S.toArray()).then(()=>{this.I3k();return null}).catch(ma=>{Q.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",ma);return null})})}catch(v){Q.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
v)}}Fyi(v){this.ua.addHandler("OnCoachResourcesLoaded",v)}jBl(v){this.ua.removeHandler("OnCoachResourcesLoaded",v)}I3k(){const v=w.AFrameworkApplication.fa.Ea("CoachPackageCssUrl"),S=document.createElement("link");S.setAttribute("rel","stylesheet");S.setAttribute("type","text/css");S.setAttribute("href",v);$addHandler(S,"load",()=>{this.xZa=!0;id.a("PollToRefreshCoachEntryPointOnRibbon")&&this.nv&&this.nv.CB();this.ua.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);Q.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.$Ng)});document.body.appendChild(S)}Mxl(){this.jb.qOc(Object(r.a)(this,this.aqh,"onSlideshowReady"));this.jb.ySa(Object(r.a)(this,this.Hrc,"onSlideShowPositionChanged"));this.jb.Oka(Object(r.a)(this,this.Pha,"onSlideshowExitHandler"));this.jb.rOc(Object(r.a)(this,this.iza,"onSpecialKeyHandler"))}haj(){this.jb.rvd(Object(r.a)(this,this.aqh,"onSlideshowReady"));this.jb.Dmb(Object(r.a)(this,this.Hrc,"onSlideShowPositionChanged"));this.jb.jia(Object(r.a)(this,this.Pha,"onSlideshowExitHandler"));
this.jb.svd(Object(r.a)(this,this.iza,"onSpecialKeyHandler"))}iza(v,S){S.key===da.a.nVb&&this.O7e()}O7e(){if(0===this.Toa){var v=this.Gx.getCoachElement(oe.cpg);v&&this.uNa(v)}else 2===this.Toa?(v=this.Gx.getCoachElement(oe.nfl))&&this.uNa(v):1===this.Toa&&(v=this.Gx.getCoachElement(oe.bxk))&&this.uNa(v)}uNa(v){this.oga&&this.Gx&&window.setTimeout(()=>{Jb.FocusManager.dr(v)},50)}XA(v){try{const Va=this.Gx.getCoachElement(oe.cpg),wb=this.Gx.getCoachElement(oe.axk),Sb=this.Gx.getCoachElement(oe.Jom),
vc=this.Gx.getCoachElement(oe.O0k);if(v.keyCode===da.a.zs){if(!id.a("PresenterCoachTabFix")){var S=!Sb&&!!Va&&v.target===Va||!!Sb&&v.target===Sb,ma=!!Va&&!!wb&&wb.contains(v.target),Ja=!!vc&&v.target===vc;(S||ma||Ja)&&this.jb.restoreFocus()}}else v.keyCode===da.a.F_||v.keyCode===da.a.I3?(this.jb.prev(),this.O7e()):v.keyCode===da.a.LW||v.keyCode===da.a.H3?(this.jb.next(),this.O7e()):v.keyCode===da.a.Mp||v.keyCode===da.a.MUb||v.shiftKey||this.jb.restoreFocus()}catch(Va){Q.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Va)}}Vwl(){const v=this.Gx.getCoachElement(oe.VZi);if(id.a("PresenterCoachTabFix")){var S=document.getElementById("HiddenFocusTrapAnchor");this.oga.insertBefore(v,S)}else S=document.getElementById("slideshowEndFocusTrap"),this.oga.insertBefore(v,S);v&&Za.a.addHandler(v,Ha.a.Vf,Object(r.a)(this,this.XA,"keyDownHandler"))}w5l(v){if(!this.sa.Aa)throw Error.argumentNull("ActiveSlide is null");oe.E9j();this.Mxl();this.u9b()&&(this.uz.bxd(),this.uz.JBl(Object(r.a)(this,this.Yoh,"onRehearsalOptOutSettingsRequestFinished")));
const S=new Eq;this.q0a=Fl(this.ka,this.ka.Oza);this.eN&&!this.ka.pptRehearsalVisionEnabled&&Q.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.eN=this.eN&&this.ka.pptRehearsalVisionEnabled;var ma=new Hg.a,Ja=Object(N.a)(267,this.Wb.LGa(this.sa.Aa.Fb.sid));S.currentSlideIndex=Ja?Ja.ve:0;S.totalSlideCount=this.Wb.Hi();Ja=this.Bwj(S);this.Gx=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Ja,ma);this.eN&&(this.uld=this.Gx.getRehearsalVideoElement(),
this.Hld=this.Gx.getRehearsalVideoCanvas());this.jNe=v;v=this.vge(S,this.uld,this.Hld);this.PY=(new CoachPackage.CoachSessionFactory).createCoachManager(v);v=this.Cwj();this.XCe=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(v,ma);id.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.vP.enumerateDevices(Object(r.a)(this,this.Vqc,"onEnumerateDevicesSuccess"),Object(r.a)(this,this.h1a,"onDevicesFailure"),Object(r.a)(this,this.q1a,"onUnsupported"));this.Lvl();this.Mvl();
this.ync=0;this.vGe=!1;this.Vwl();2===this.jNe&&(ma=localStorage.getItem(oe.FYe),this.xRg&&!ma?this.oUh():this.Bbf())}Bbf(){this.Toa=0;this.Dga.execute(v=>{v.SF(Yq.a.SubtitlesButton,!1);v.SF(Yq.a.LiveButton,!1);v.SF(Yq.a.CoachButton,!1);v.SF(Yq.a.MicButton,!1)});this.PY.startSession(!0)}oUh(){this.XCe.showCoachFREUI(v=>{localStorage.setItem(oe.FYe,"true");this.Kbh=v;this.Bbf()})}Vqc(v){this.eic=0;if(v.length)for(var S of v)"audioinput"===S.kind&&(this.eic+=1);else this.eic=0;this.rRg=!0;v=new Eq;
S=Object(N.a)(267,this.Wb.LGa(this.sa.Aa.Fb.sid));v.currentSlideIndex=S?S.ve:0;v.totalSlideCount=this.Wb.Hi();v=this.vge(v,this.uld,this.Hld);this.PY.updateSessionConfiguration(v)}h1a(v){Q.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",v.toString())}q1a(){Q.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",Ee.a.nx)}aqh(){const v=localStorage.getItem(oe.FYe);this.xRg&&!v?this.oUh():this.Bbf()}Hrc(v,
S){v=new Eq;v.currentSlideIndex=S.slideIndex;v.totalSlideCount=this.Wb.Hi();S=this.vge(v,this.uld,this.Hld);this.PY.updateSessionConfiguration(S);this.Gx.updateCoachSlideComponent(v)}getTraceRequestMetadata(v,S){const ma={};if(v)for(const Ja in v)ma[Ja]=v[Ja];if(S)for(const Ja in S)ma[Ja]=S[Ja];v=Ag.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());ma.AudienceGroup=v.Ring||"Unknown";ma.BuildVersion=w.AFrameworkApplication.buildVersion||"Unknown";ma.ClientType="web";ma.IdentityProvider=
this.ka.hostAuthType||w.AFrameworkApplication.fa.Ea("HostAuthType")||"Unknown";ma.Locale=this.ka.iMa||"Unknown";ma.SpeechMode="rehearsal";ma.TenantId=w.AFrameworkApplication.fa.Ea("TenantId");ma.UserId=this.getUserId();ma.WacDatacenter=v.WACDatacenter||"Unknown";ma.WacHost=v.Host||"Unknown";ma.SourceLanguage=this.ka.bYf||$r(this.ka.Oza);return ma}getUserId(){let v=w.AFrameworkApplication.fa.Ea("PptEditingUserId");hc.a.Ta(v)&&(v=w.AFrameworkApplication.fa.Ea("LoggableUserId"),n.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",hc.a.Ta(v)));return v}MMl(){if(this.ka.kgl){var v=this.PY.getTraceRequestMetadata(),S=this.Gx.getTraceRequestMetadata(),ma=this.ka.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(ma&&ma.length){var Ja=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",ma);ma=new XMLHttpRequest;ma.open("POST",Ja,!0);Ja=yb.a.create().toString();ma.setRequestHeader("X-Correlation",Ja);try{n.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Ja);const Va=this.getTraceRequestMetadata(v,S);ma.send(Ag.c(Va))}catch(Va){n.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Ja)}}else n.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}Pha(){this.haj();this.Toa=3;this.PY.stopSession();this.XCe.hideCoachFREAndWelcomeUI();this.Gx.hideCoachUI();this.cQe=this.aCe=!1;try{this.PY.getSessionSummary(v=>
{v.timeSpentInSeconds=this.ync;this.ia.nb($a.a.DWc,2);this.ia.nb($a.a.CWc,2);window.clearInterval(this.J9g);this.vGe&&this.xnc.instance.SNa(v,this.eN,this.q0a,this.lNe,()=>{this.MMl()})})}catch(v){n.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",v)}}bKj(){let v=",visionFace";this.ka.fjl&&(v+=","+oe.Wnm+","+oe.Vnm);this.ka.gjl&&(v+=","+oe.Ynm+","+oe.Xnm);this.ka.ejl&&(v+=","+oe.Snm+","+oe.Tnm+","+oe.Unm);return oe.Dpm+(Mn(this.q0a,oe.vde)?","+oe.vde:
"")+","+oe.rNl+","+oe.m1i+","+oe.Abl+","+oe.Lhl+(this.ka.GYe&&Mn(this.q0a,oe.qme)?","+oe.qme:"")+(this.ka.VXe&&Mn(this.q0a,oe.uRe)?","+oe.uRe:"")+(this.ka.pptRehearsalVisionEnabled&&Mn(this.q0a,oe.u5h)?v:"")+(this.ka.pptRehearsalPronunciationEnabled&&Mn(this.q0a,oe.n_e)?","+oe.n_e:"")+(this.ka.pptRehearsalCrutchWordsEnabled&&Mn(this.q0a,oe.N8d)?","+oe.N8d:"")}vge(v,S,ma){const Ja=new bs;Ja.disabledCoachRealtimeFeatures="";Ja.userSessionId=w.AFrameworkApplication.userSessionId;var Va=new Rs;Va.docId=
w.AFrameworkApplication.mh;Va.podsSessionId=this.Xa.podSessionId;Va.userDataCenterClusterId=this.Xa.$k;Va.webServiceBase=this.ka.podsWebServiceBase;Ja.documentDownloadConfig=Va;Va=new Hg.a;Ja.logger=Va;Va={};Va.currentSlideIndex=v.currentSlideIndex.toString();Ja.customSettings=Va;Ja.fEnableServiceSideAggregationForCoach=this.ka.tsd;Ja.httpTimeoutForCoachSummaryData=this.ka.pjl;Ja.fSendClientMetaDataOnSessionStart=this.ka.ngj;Ja.speechFDBase=this.ka.pptEditorSpeechHandlerBaseUri;Ja.requestedCoachFeatures=
this.bKj();this.u9b()&&(this.lNe=this.uz.fmg(!0),Ja.requestedRehearsalOptOutFeatures=this.lNe);id.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Ja.enableTimeStampedCritiqueTelemetry=!0);Ja.entryPoint=Dq[this.jNe];Ja.fEnableVision=this.eN;Ja.fEnableVision&&S&&ma&&(Ja.webcamConfig=Object.assign(new cs,{videoView:S,workingCanvas:ma,numFramesPerSecond:this.ka.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.ka.ijl}));Ja.supportedRehearsalTemplates=this.Gx.getSupportedRehearsalTemplates();
id.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.rRg&&(Ja.audioInputDeviceCount=this.eic);v=Ag.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Ja.userId=this.getUserId();Ja.tenantId=w.AFrameworkApplication.fa.Ea("TenantId");Ja.identityProvider=this.ka.hostAuthType||w.AFrameworkApplication.fa.Ea("HostAuthType")||"Unknown";Ja.audienceChannel="";Ja.audienceGroup=v.Ring||"Unknown";Ja.buildVersion=w.AFrameworkApplication.buildVersion||"Unknown";Ja.locale=this.ka.iMa||
"Unknown";Ja.wacHost=v.Host||"Unknown";Ja.wacDatacenter=v.WACDatacenter||"Unknown";Ja.sourceLanguage=this.ka.bYf||$r(this.ka.Oza);Q.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.ka.iMa,this.ka.Oza);return Ja}Cwj(){const v=new Xq;v.rootContainer=this.oga;v.zIndex=oe.hCh;v.imagesBaseFilePath=w.AFrameworkApplication.fa.Ea("CoachImagesBaseFilePath");return v}Bwj(v){const S=new as;S.rootContainer=this.oga;S.slideState=v;S.imagesBaseFilePath=
w.AFrameworkApplication.fa.Ea("CoachImagesBaseFilePath");S.zIndex=oe.hCh;S.fEnableVision=this.eN;S.fShowRealtimeFeedbackEnabledCheckbox=this.ka.jgl;S.fUseNewRealtimePanel=this.ka.Tud;S.fUseCountdownWelcomeScreen=w.AFrameworkApplication.fa.getBooleanAppSetting("PptCoachEnableCountdownWelcomeUI");S.speechFDBase=ep(this.ka.pptEditorSpeechHandlerBaseUri);S.fDontShowTooltips=Ee.a.jg;S.fUseNewRealtimeCheckbox=id.a("UseNewRealtimeCheckbox");return S}Ejm(){2!==this.Toa&&(this.ync+=1,this.Gx&&this.Gx.updateTimer(this.ync))}Lvl(){this.Gx.on("CoachSessionStarted",
()=>{this.Toa=1;this.J9g=window.setInterval(Object(r.a)(this,this.Ejm,"updatePresentationTimer"),1E3);this.PY.enableVoiceStreaming();this.I1l();this.vGe=!0});this.Gx.on("CoachSessionPaused",()=>{this.Toa=2;this.PY.pauseSession();this.$la()&&this.xm.instance.hide()});this.Gx.on("CoachSessionResumed",()=>{this.Toa=1;this.PY.resumeSession()})}Mvl(){this.PY.on("SpeechRecognitionStarted",()=>{this.lGe&&this.$la()&&(this.xm.instance.hide(),this.lGe=!1)});this.PY.on("PPTCoachRealtimeNotification",v=>{this.XUj(v)});
this.PY.on("QualityStatusChanged",v=>{this.HYj(v)});this.PY.on("MediaStatusChanged",v=>{this.kXj(v)});this.PY.on("Error",v=>{this.handleError(v)});this.PY.on("ConnectionRetry",()=>{this.kWj()})}kWj(){this.lGe=!0;this.$la()&&this.xm.instance.show(oe.Dfg,Mm.a.$0a)}XUj(v){this.Gx.updateCoachRealtimeNotification(v)}handleError(v){v=Object(N.a)(String,v);this.Toa=4;v?v.startsWith("ErrorAudio")?(this.Gx&&this.Gx.showCoachDisabledUI(0),this.$la()&&this.xm.instance.show(oe.c$f,Mm.a.$0a)):v.startsWith("ErrorVideo")?
(this.Gx&&this.Gx.showCoachDisabledUI(1),this.$la()&&this.xm.instance.show(oe.i$f,Mm.a.$0a)):Q.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):Q.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}gUh(){this.Gx&&(this.eN&&this.Gx.enableCoachVideoUI(),this.Gx.showCoachRealtimeUI(this.Kbh));this.$la()&&this.xm.instance.show(oe.$4f,Mm.a.Knd)}kXj(v){"AudioDeviceConnected"===v.mediaStatus?(this.aCe=!0,this.eN&&!this.cQe||this.gUh()):"VideoSetupCompleted"===v.mediaStatus&&
(this.cQe=!0,this.aCe&&(this.Gx&&this.Gx.enableCoachVideoUI(),this.gUh()))}HYj(v){if(this.ka.pptEditorVoiceUXEnabled){var S=v.severity,ma=v.shortCode;if(0<ma&&ma<oe.qTf&&oe.ZZ[ma])switch(S){case 0:this.$la()&&this.xm.instance.hide();break;case 1:(v=0<ma?oe.ZZ[ma]:v.shortString)&&this.$la()&&this.xm.instance.show(v,Mm.a.QLb);break;case 2:(v=0<ma?oe.ZZ[ma]:v.shortString)&&this.$la()&&this.xm.instance.show(v,Mm.a.$0a)}else Q.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}$la(){return this.ka.pptEditorVoiceUXEnabled&&
this.xm&&this.xm.instance&&2!==this.Toa?!0:!1}I1l(){this.$la()&&(this.xm.instance.show(oe.a5f,Mm.a.Knd),this.Roc=window.setTimeout(Object(r.a)(this,this.loe,"hideSoundReminderNotification"),3E3))}loe(){this.$la()&&(window.clearTimeout(this.Roc),this.xm.instance.hide())}u9b(){return this.ka.JNb&&!!this.uz}wye(){return this.u9b()?this.VRg:!0}Yoh(){this.VRg=!0;this.eN=this.uz.Wce;id.a("PollToRefreshCoachEntryPointOnRibbon")&&this.nv&&this.nv.CB()}}Object(k.a)(im,"RehearsalManager",null,[1116]);class Lo{constructor(v,
S,ma){this.ym=v;this.ia=S;this.ka=ma}SNa(v,S,ma,Ja,Va){try{const vc=document.createElement("div");vc.id="SummaryPageOverlay";vc.style.width="100%";vc.style.height="100%";vc.style.zIndex="999";vc.style.display="flex";vc.style.flexDirection="column";vc.style.justifyContent="center";vc.style.position="absolute";var wb=document.getElementById("SummaryPageOverlay");wb&&document.body.removeChild(wb);document.body.insertBefore(vc,document.body.firstChild);const gd=vc.parentNode;Za.a.addHandler(gd,Ha.a.Vf,
Object(r.a)(this,this.woh,"onParentNodeKeyDownHandler"));var Sb=v.thumbIndices;if(Sb){wb={};let kg=0;const If=this.iNj(Sb);for(let yh=0;yh<Sb.length;yh++)wb[Sb[yh].toString()]=If[yh],If[yh]||kg++;Q.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Sb.length,kg);v.slideImageSrcs=wb}else v.slideImageSrcs={},Q.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const od=w.AFrameworkApplication.XF;od||Q.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");ma||(ma=Fl(this.ka,this.ka.Oza));Sb={};const Vd=Ag.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Sb.fFeedbackCardEnabled=this.ka.lgl&&od;Sb.fShowFeedbackButton=od;Sb.fMonotoneEnabled=this.ka.VXe&&Mn(ma,oe.uRe);Sb.fGrammarEnabled=this.ka.GYe&&Mn(ma,oe.qme);Sb.fFillersCardEnabled=Mn(ma,oe.vde);Sb.locale=this.ka.Oza;Sb.fPronunciationCardEnabled=
this.ka.pptRehearsalPronunciationEnabled&&Mn(ma,oe.n_e);Sb.fCrutchWordCardEnabled=this.ka.pptRehearsalCrutchWordsEnabled&&Mn(ma,oe.N8d);Sb.fVisionEnabled=S&&this.ka.hjl&&this.ka.pptRehearsalVisionEnabled;const Ke=yv(this.ka,this.ka.Oza);hc.a.Ta(Ke)||(Sb.fPacingGaugeRange=Ke);hc.a.Ta(Vd)||(Sb.clientSessionId=Vd);this.ka.JNb&&(Sb.rehearsalOptOutFeatures=Ja);(new rehearsalSummaryPage.RehearsalSummaryPageController(vc,v,()=>{Q.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Va&&Va();this.ia&&(vc.parentNode.removeChild(vc),this.ia.Ia($a.a.gia,2,{entryPoint:3}))},()=>{Va&&Va();Za.a.removeHandler(gd,Ha.a.Vf,Object(r.a)(this,this.woh,"onParentNodeKeyDownHandler"))},this.ka.podsWebServiceBase,decodeURIComponent(this.ka.Jrd),()=>{this.d0l()},Sb,ep(this.ka.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.z_l()})).renderSummaryPage()}catch(vc){Q.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",vc.toString())}}woh(v){"MainApp"===
v.target.id&&(v.preventDefault(),v.stopPropagation())}z_l(){Q.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.ka.JNb&&this.ia.Ia($a.a.SAd,2,null)}d0l(){Q.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.ka.yil?this.ia.Ia($a.a.mCh,2,null):this.ia.Ia(F.a.w5,2,!1))}iNj(v){const S=Array(v.length);if(!this.ym)return S;const ma=this.ym.fI(),Ja=this.ym.oWa();for(let Va=
0;Va<v.length;Va++){const wb=Ja[ma[v[Va]].sid.toString()];wb&&wb.thumbnailImage.length&&(S[Va]=wb.thumbnailImage)}return S}}Object(k.a)(Lo,"RehearsalSummaryPageHelper",null,[]);class ds{constructor(v,S,ma,Ja,Va){this.xZa=!1;this.ua=new xd.a;this.ia=v;this.Wdd=new Lo(S,this.ia,Ja);this.XKe=ma;this.Vjd=Va}qb(){this.ia.xa($a.a.SNa,qb.a.application,Object(r.a)(this,this.M1l,"showSummaryPage"));this.ia.xa($a.a.mCh,qb.a.application,Object(r.a)(this,this.l0l,"showFloodgateSurvey"))}SNa(v,S,ma,Ja,Va){this.Wdd.SNa(v,
S,ma,Ja,Va)}M1l(v,S,ma,Ja,Va){switch(ma){case 2:return this.Wdd.SNa(Va,!1,null,null,null),32;case 1:if(this.xZa)return 32;break;default:Q.a.J(509117593,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}l0l(v,S,ma){switch(ma){case 2:return this.Vjd.execute(Ja=>{Ja.Cob("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.xZa)return 32;break;default:Q.a.J(509117592,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}khc(){const v=
Date.now();this.XKe("rehearsalSummaryPage").then(()=>{const S=w.AFrameworkApplication.fa.Ea("RehearsalSummaryPageCssUrl"),ma=document.createElement("link");ma.setAttribute("rel","stylesheet");ma.setAttribute("type","text/css");ma.setAttribute("href",S);$addHandler(ma,"load",()=>{this.xZa=!0;this.ua.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);Q.a.J(509117591,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-v)});document.body.appendChild(ma);return null})}vzi(v){this.ua.addHandler("OnRehearsalSummaryResourcesLoaded",
v)}LBl(v){this.ua.removeHandler("OnRehearsalSummaryResourcesLoaded",v)}}Object(k.a)(ds,"RehearsalSummaryPageActor",null,[1114]);class Fq{constructor(v,S,ma,Ja,Va){this.VEg=this.wAg=!1;this.ia=v;this.Ba=S;this.kNe=ma;this.xnc=Ja;this.Cya=Va;this.kNe.execute(wb=>{wb.Fyi(Object(r.a)(this,this.Slh,"onCoachResourcesLoaded"))});this.xnc.execute(wb=>{wb.vzi(Object(r.a)(this,this.$oh,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.kNe.instance&&this.kNe.instance.jBl(Object(r.a)(this,this.Slh,"onCoachResourcesLoaded"));
this.xnc.instance&&this.xnc.instance.LBl(Object(r.a)(this,this.$oh,"onRehearsalSummaryResourcesLoaded"))}Slh(){this.wAg=!0;this.IZh()}$oh(){this.VEg=!0;this.IZh()}IZh(){this.wAg&&this.VEg&&ib.a.get_instance().Ij(10,null).continueWith(()=>{if(this.Ba.IQh&&this.Ba.djl){const v=document.getElementById("rehearsal-loading-dialog-modal");v?(v.style.display="none",Q.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):Q.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.nb($a.a.gia,1))if(this.Ba.IQh)this.ia.Ia($a.a.gia,2,{entryPoint:5});else if(!this.Ba.isCreateNew&&this.Ba.Ovh&&this.Ba.Fil)try{this.Cya.continueWith(()=>{this.Cya.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),Q.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(v){Q.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",v)}})}}Object(k.a)(Fq,
"RehearsalTrigger",null,[1117]);class bl{constructor(){this.K=this.uz=null}get name(){return"PowerPointWebEditor.Rehearsal"}WYi(){this.K.register(1114,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().na(()=>new ds(w.AFrameworkApplication.Pa,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),Ia.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ha("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").qb()}fc(v){this.K=
v;this.K.Ha("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.WYi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(1115,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().na(()=>new Qs(w.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.uz=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const S=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(1116,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().na(()=>new im(w.AFrameworkApplication.Pa,S,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
C.a.instance.Ha("PowerPointWebEditor.ISlideShowVoiceNotification"),C.a.instance.Ha("PowerPointWebEditor.ISlideshowToolbar"),C.a.instance.Ha("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.uz,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").qb();this.K.register(1117,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().na(()=>new Fq(w.AFrameworkApplication.Pa,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),C.a.instance.Ha("PowerPointWebEditor.Rehearsal.IRehearsalManager"),C.a.instance.Ha("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Ye.a.Au(C.a.instance.Ha("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){w.AFrameworkApplication.fa.Ue(Object(r.a)(this,this.Pn,"onFullAppSettingsReady"))}Pn(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").qgc&&ib.a.get_instance().Ij(7,
()=>{this.K.Ha("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").khc();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").khc();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").JNb){const v=new Wq(Ia.a(this.K),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.uz,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));v.qb();v.Sd();this.uz.Pak()}}dispose(){}static main(){e.a.instance.Ac(new bl)}}Object(k.a)(bl,"PPTWebEditorRehearsalPackage",null,[2,3]);class Bp{static $bb(v){try{return caches.open(Bp.Hof).then(S=>S.match(v))}catch(S){return Promise.reject(null)}}static CVa(v,S){try{return Bp.$bb(v).then(ma=>ma&&Number.parseInvariant(ma.headers.get("cachedTime"))>Date.now()-S?Promise.resolve(ma.text().toLocaleString()):
Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(ma){return Promise.reject(null)}}static store(v,S){try{return caches.open(Bp.Hof).then(ma=>{ma.put(v,S).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(ma){return Promise.resolve(!0)}}static j6l(v,S){const ma={};ma.body=S;const Ja={};Ja.cachedTime=Date.now().toString();ma.headers=Ja;S=new Response(S,ma);Bp.store(v,S).then(()=>!0)}}Bp.Hof="ConsentState";Object(k.a)(Bp,"CacheManager",null,[]);class jm{constructor(){this.message=
null;this.lu=0}}Object(k.a)(jm,"HttpRequstToPromiseRejectData",null,[]);class Gq{constructor(v){this.Jda=v}eaa(v,S,ma,Ja,Va,wb){y.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+v,dataFields:[Object.assign(new B.a,{name:"EventMessage",string:S}),Object.assign(new B.a,{name:"FormFactor",string:this.Jda.formFactor}),Object.assign(new B.a,{name:"CorrelationId",string:this.Jda.correlationId}),Object.assign(new B.a,{name:"AccountType",string:this.Jda.accountType}),Object.assign(new B.a,
{name:"OSVersion",string:this.Jda.osVersion}),Object.assign(new B.a,{name:"AppId",string:this.Jda.appId}),Object.assign(new B.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new B.a,{name:"ConsentLanguage",string:this.Jda.consentLanguage}),Object.assign(new B.a,{name:"EventCode",string:ma}),Object.assign(new B.a,{name:"Region",string:this.Jda.region}),Object.assign(new B.a,{name:"ModelType",string:Ja}),Object.assign(new B.a,{name:"ModelId",string:Va}),Object.assign(new B.a,{name:"Platform",
string:this.Jda.os}),Object.assign(new B.a,{name:"ReConsentReason",string:""}),Object.assign(new B.a,{name:"ConsentType",string:wb})]}))}}Object(k.a)(Gq,"TelemetryLogger",null,[]);class Zq{constructor(v,S,ma){this.Obi="https://consent.config.office.com/consentcheckin/v1.0/consents";this.La=v;this.Bi=S;this.iSa=ma;this.bU=new Gq(ma)}kab(v,S){return new Promise((ma,Ja)=>{const Va=this.La.tc("UCNoticeCheckinCallTimeoutMs",5E3);let wb=this.La.Ea("UCNoticeCheckinStateUrl");wb&&wb.length||(wb=this.Obi);
this.Bi.jU(wb,1,null,this.oac(v),null,0,Sb=>{try{if(void 0===Sb||null===Sb||void 0===Sb.data||null===Sb.data||void 0===Sb.data.Ud||null===Sb.data.Ud){this.bU.eaa("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Ja(this.VU(gd,Sb))}else if(Sb.data.Ke!==Fe.a.Zw){this.bU.eaa("UnifiedConsent.ConsentGetFailed",
"CheckInApi : HTTP failure",Sb.data.Ke.toString(),null,null,null);const gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Sb.data.Ke,"UnifiedConsent.ConsentGetFailed");Ja(this.VU(gd,Sb))}else{var vc=S(Sb.data.Ud);if(vc)ma(vc);else{this.bU.eaa("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Ja(this.VU(gd,Sb))}}}catch(gd){this.bU.eaa("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),vc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",gd,"UnifiedConsent.ConsentGetFailed"),Ja(this.VU(vc,Sb))}},Sb=>{this.bU.eaa("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Sb.data.Ke.toString(),null,null,null);const vc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Sb.data.Ke,"UnifiedConsent.ConsentGetFailed");Ja(this.VU(vc,Sb))},null,void 0,void 0,2500,Va)})}VU(v,S){const ma=new jm;ma.message=v;ma.lu=S&&S.data?S.data.Ke:-1;return ma}oac(v){const S={};S["Accept-Language"]=this.iSa.consentLanguage;S.consentsurface="AppStart";S.platform="Web";S.formfactor=Ee.a.gfc?"Mobile":"Desktop";S["x-Cid"]=this.iSa.correlationId;S.Authorization="Bearer "+v;return S}}Object(k.a)(Zq,"HttpRequestToPromiseUtility",null,[]);class Cp{constructor(){this.accountType="MSA";this.modelType=
null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(k.a)(Cp,"WebSdkAdapterProps",null,[]);class Nm{constructor(v,S,ma,Ja){this.Kuf=this.cCa=this.Xja=this.yda=null;this.Jdl=Va=>{if(void 0===Va||null===Va)return this.bU.eaa(Nm.m7a,"Checkin response undefined or null","705",this.yda,this.Xja,
this.cCa),null;try{const {Ev:wb}=Ag.d(Va);return wb}catch(wb){this.bU.eaa(Nm.m7a,"Checkin response parse error : "+wb.message,"706",this.yda,this.Xja,this.cCa)}return null};this.Sqb=Ja;this.La=v;this.lai=ma;this.Bi=S;this.iSa=this.E_c();this.bU=new Gq(this.iSa)}C_l(){"MSA"===(this.La.Ea("HostAuthType")||"").toUpperCase()&&Bp.CVa(this.iSa.userId,this.La.tc("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.bU.eaa(Nm.m7a,"CacheFound","701",this.yda,this.Xja,this.cCa);return{}}).catch(()=>{this.lai.execute(v=>
{v.vH("Consent",Nm.Bpi).then(S=>{S.IsSuccess?(this.bU.eaa(Nm.m7a,"CheckInTokenSuccess","702",this.yda,this.Xja,this.cCa),this.nxj(S.Token).then(ma=>{this.MFj(ma);this.yda&&""!==this.yda&&v.vH("Consent",Nm.Dpi).then(Ja=>{Ja.IsSuccess?(this.bU.eaa(Nm.m7a,"WebTokenSuccess","703",this.yda,this.Xja,this.cCa),this.Z0l(Ja,this.yda)):this.bU.eaa(Nm.m7a,"WebTokenFailed : "+Ja.ErrorMessage,Ja.ErrorCode,this.yda,this.Xja,this.cCa);return{}});return{}})):this.bU.eaa(Nm.m7a,"CheckInTokenFailed : "+S.ErrorMessage,
S.ErrorCode,this.yda,this.Xja,this.cCa);return{}})})})}nxj(v){this.Kuf=new Zq(this.La,this.Bi,this.iSa);return this.Kuf.kab(v,this.Jdl).then(S=>Promise.resolve(S),S=>Promise.reject("Error while getting result"+S))}MFj(v){for(const S of v.consentValues)if(S.needConsent&&!S.maxPromptsReached){this.Xja=S.id;this.cCa=S.consentType;this.yda=S.modelType;return}Bp.j6l(this.iSa.userId,Ag.c(v))}Z0l(v,S){if(ef.a("showConsentNotice")){const ma=document.createElement("div");document.body.appendChild(ma);appChrome.api.showConsentNotice(this.Kzj(v.Token,
S),ma)}else this.bU.eaa(Nm.bii,"1JS : ShowConsentNotice API not found","704",this.yda,this.Xja,this.cCa)}Kzj(v,S){const ma=this.iSa;ma.token=v;ma.modelType=S;return ma}E_c(){const v=this.Jpe(this.La.Ea("SessionStartInfoJson"));return Object.assign(new Cp,{emailId:this.La.Ea("UserPrincipalName"),userId:this.La.Ea("LoggableUserId"),accountType:"AAD"===(this.La.Ea("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.La.Ea("OfficeApplicationId"),appVersion:this.La.Ea("appVersion"),appName:"Application"in
v?v.Application:"",appEnv:this.Sqb,consentLanguage:this.La.Ea("UICulture")||"en-US",formFactor:Ee.a.gfc?"Mobile":"Desktop",os:"Os"in v?v.Os:"",osVersion:"OsVersion"in v?v.OsVersion:"",region:this.La.Ea("region"),correlationId:yb.a.create().toString(),isDarkMode:this.La.getBooleanAppSetting("DarkModeIsOn"),useCache:!0})}Jpe(v){let S={};try{S=Ag.b(v)}catch(ma){}return S}}Nm.Dpi="https://consentservice.microsoft.com/web";Nm.Bpi="https://consentservice.microsoft.com/checkin";Nm.bii="UnifiedConsent.ConsentGetFailed";
Nm.m7a="UnifiedConsent.AuthTokenStatus";Object(k.a)(Nm,"ConsentNoticeManager",null,[1223]);class Dp{constructor(){this.Da=null}get name(){return"Common.App.ConsentNoticeDialog"}fc(v){this.Da=v;v.register(Nm,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().na(()=>new Nm(w.AFrameworkApplication.fa,w.AFrameworkApplication.Me,v.Ha("Common.App.OAuth.IOAuthManager"),w.AFrameworkApplication.RUa))}init(){this.Da.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){e.a.instance.Ac(new Dp)}}
Object(k.a)(Dp,"ConsentNoticeDialogPackage",null,[2,3]);var es=d(13);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");
Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");
Type.registerNamespace("PowerPointWebEditor.VersionHistory");Object(es.d)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");rb.main();Ob.main();nc.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Rf.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Ac(new me);Type.registerNamespace("Common.App.DisplayEnvironmentName");ta.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");
cd.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Ac(new Cf);Type.registerNamespace("Common.App.OneDriveFilePickerApi");be.main();Type.registerNamespace("Common.App.PenMinutesManager");Aj.main();Type.registerNamespace("Common.App.SaveAsToHost");Cg.main();Type.registerNamespace("Common.App.SaveToSharePoint");Xd.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Fi.main();Type.registerNamespace("Common.App.SaveACopy");rd.main();Type.registerNamespace("Common.App.PhoneLink");
Ka.main();Type.registerNamespace("Common.App.SharedFilePicker");Yb.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");Nd.main();Type.registerNamespace("Common.App.WopiIdentity");of.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Dp.main();X.main();dk.main();Ze.main();Km.main();Bl.main();rf.main();e.a.instance.Ac(Db.a(new Io,0));
Ko.main();Type.registerNamespace("Common.App.LivePersonaUtils");vr.main();bl.main();Object(es.c)("Chronos2")},344:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.none=null;k.vVi="CoAuth";k.Loe="IdeasPaneClosed";k.XZk="MultiSlidesSelected";k.Xmb="Retrigger";k.gyd="SessionEnded";k.VNl="SessionRehydrated";k.slideNavigation="SlideNavigation";k.NSb="SuggestionPaneClosed";k.XBd="SuggestionsLoadingTimeout";k.noSuggestion="NoSuggestion";k.Nz="Typing";k.cVb="WebActionId:";k.kyl="Rehydrated";
k.S5f="DisallowedRequest";k.TXf="CloseSecondPane";k.Oal="OpenEditorPane";Object(L.a)(k,"DesignerResetReason",null,[])},345:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.invalid="Invalid";k.success="Success";k.error="Error";k.pending="Pending";k.qLa="NoResult";Object(L.a)(k,"ProviderResultStatus",null,[])},390:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.Y3l=1]="spCatalog";e[e.X3l=2]="spApp";
e[e.Imj=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.G7j=7]="inMemory";e[e.vlm=8]="uploadFileDevCatalog";e[e.G0j=9]="hardCodedPreinstall";e[e.Ntc=10]="privateCatalog";e[e.Oom=16]="wopiCatalog"})(k||(k={}));Object(L.b)("AddinProviderType",k)},401:function(L,V,d){L=d(0);class k{static sGj(){return k._nextEventReceiverId++}}k._nextEventReceiverId=0;Object(L.a)(k,"EventReceiverIdCounter",null,[]);d.d(V,"a",function(){return e});class e{constructor(n,
r){this.Rdi=n;this._id=k.sGj();this.Rmi=r}get id(){return this._id}notify(n,r){this.Rmi(n,r)}Gi(n,r){return this.Rdi.Cnl(n,r?this:null)}}Object(L.a)(e,"EventReceiver",null,[244])},454:function(L,V,d){d.d(V,"a",function(){return n});L=d(0);var k=d(395),e=d(201);class n{static tQh(r){return parseInt(n.Tpb(e.a.w_d,r)||"-1")<=(new Date).getTime()}static Ffe(r){return parseInt(n.Tpb(e.a.G9a,r)||"-1")}static pne(r){return Boolean.parse(n.Tpb(e.a.IOc,r)||"false")}static Tpb(r,w){let D=null;try{const y=n.Acb();
if(void 0!==y&&y){const m=e.a.wZc(r)+w;D=y.getItem(m)}else k.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(y){k.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",r,w)}return D}static uBc(r,w,D){try{const y=n.Acb();if(void 0!==y&&y){const m=e.a.wZc(r)+D;y.setItem(m,w)}else k.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(y){k.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",r,D)}}static Acb(){if(!n.WWa)return null;let r=null;try{r=localStorage}catch(w){n.WWa=!1,r=null}return r}}n.WWa=!0;Object(L.a)(n,"AddinUtil",null,[])},550:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.notSupported=0]="notSupported";e[e.tvk=1]="launchByLocalCacheInitializer";e[e.pvk=2]="launchByAnonymousApiInitializer";e[e.rvk=3]="launchByInsertion";e[e.uvk=4]="launchByRefresh";e[e.svk=5]="launchByLastUpdateInitializer";
e[e.qvk=6]="launchByDynamicCall"})(k||(k={}));Object(L.b)("AddinCommandsLaunchOperationType",k)},551:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"OnlineMediaSearchResult",null,[])},552:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.iOk=e;this.$Qk=n}get b8c(){return this.iOk}get JFl(){return this.$Qk}}Object(L.a)(k,"ReportSuggestionSessionActionData",null,[])},553:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}
k.c8f="Provider.UCI.Editor";k.W7f="EntityGroup.UCI.Editor";k.cTh="Provider.Designer.Slide";k.bTh="EntityGroup.Designer.Slide.Suggestion";k.mTh="Provider.Designer.TextToSmartArt";k.lTh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(L.a)(k,"InfraredConstant",null,[])},716:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}Object(L.a)(k,"ProviderActionInfo",null,[])},717:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=
0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(L.a)(k,"ReplaceObjectSuggestionApplyInfo",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.chronos2.js.map
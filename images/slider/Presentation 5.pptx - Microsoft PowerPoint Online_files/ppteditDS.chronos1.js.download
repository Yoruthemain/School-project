'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1012:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k extends Sys.EventArgs{constructor(e){super();this.Rza=e}}Object(L.a)(k,"SessionRehydratedEventArgs",Sys.EventArgs,[])},1013:function(L,V,d){d.d(V,"a",function(){return n});L=d(0);var k=d(132),e=d(46);class n{constructor(r,w,D,y,m){this.NUd=r;this.MUd=w;this.Vpi=D;this.pfi=y;this.Xuf=m}get Umb(){return 4}lM(r,w=null){w=w.sessionId+"|"+w.D$+"|"+
r.aL;if(this.Xuf||this.pfi){let D=this.Xuf||e.a.iD(CommonUIStrings.l_HelpTooltip)===e.a.iD(r.aL.trim());if(this.Vpi&&2<r.aL.length){const y=r.aL;";"===y.charAt(0)&&";"===y.charAt(y.length-1)&&y.substring(1,y.length-1)===n.Xne&&(D=!0)}r=D?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,r.aL);return this.sfg(w,e.a.Fe(r),D)}return this.sfg(w,e.a.Fe(String.format(CommonUIStrings.l_TextWithQuotation,r.aL)),!1)}sfg(r,w,D){return k.a(n.Xne,D?this.MUd:this.NUd,
w,"OfficeAssistant_16x16x32","A0",e.a.Fe(r),w,null,null)}}n.Xne="bSearchHelp";Object(L.a)(n,"AssistanceMenuItemFactory",null,[1170])},1014:function(L,V,d){d.d(V,"a",function(){return w});L=d(0);var k=d(25),e=d(132),n=d(78),r=d(46);class w{get Umb(){return 13}lM(){return w.sKi()}static sKi(){return e.b(w.adg,"798637440",r.a.Fe(CommonUIStrings.l_LookupFirstRunExperienceTitle),k.AFrameworkApplication.Mm,n.getImageClass("Info_32x32x32"),null,null,r.a.Fe(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,r.a.Fe(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.adg="bTellMeFirstRun";Object(L.a)(w,"FirstRunMenuItemFactory",null,[1170])},1015:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Byg="bInsights";Object(L.a)(k,"InsightsMenuItemFactoryStatic",null,[])},1016:function(L,V,d){d.d(V,"a",function(){return r});L=d(0);var k=d(25),e=d(132),n=d(46);class r{constructor(w=null,D=null){this.FAf=w;this.Pji=D||CommonUIStrings.l_LookupNoResultsDescription}get Umb(){return 14}lM(w){w=
String.format(this.Pji,w.aL);return this.aLi(w)}aLi(w){return e.b(r.mjh,"798637440",n.a.Fe(CommonUIStrings.l_LookupNoResultsTitle),this.FAf?k.AFrameworkApplication.Mm:null,this.FAf,null,null,n.a.Fe(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,n.a.Fe(w),null,null)}}r.mjh="lookupNoResults";Object(L.a)(r,"NoCommandsFoundMenuItemFactory",null,[1170])},1017:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=
n}}Object(L.a)(k,"LabelFormatted",null,[])},1018:function(L,V,d){d.d(V,"a",function(){return D});L=d(0);d(145);var k=d(159),e=d(174),n=d(173),r=d(108),w=d(46);class D{constructor(y){this.vb=y}hF(){return"Assistance"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:this.vb.Trc?3:2}AC(y,m,C=!1,E,F=null){E=new n.a(y);if((!F||Array.contains(F,8))&&!r.a.SG(y)){F=new e.a(8);if(C){C=w.a.iD(CommonUIStrings.l_HelpTooltip)===w.a.iD(y.Mf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
y.Mf);const B=[];this.vb.nYa&&(this.vb.x$e||B.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),C=this.Rlg(y.Mf));const H="||"+y.Mf;B.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",C));B.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));appChrome.api.dispatch(B);y=new k.a("GetHelpFromTellMe",4,y.Mf,null,1)}else y=new k.a("bSearchHelp",4,y.Mf,null,1);F.qt(y);F.displayName=CommonUIStrings.l_HelpButtonTitle;E.jr(F)}m.oo(E)}BWa(y,m=
null){const C=new e.a(8),E=w.a.iD(CommonUIStrings.l_HelpTooltip)===w.a.iD(y.Mf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,y.Mf);for(let B=0;B<m.length&&2>B;B++){var F=[];let H="GetHelpWithDescriptionFromTellMe"+(B+1).toString(),K=4;if(this.vb.ryc)F.push(appChrome.actions.setControlLabel(H,E)),F.push(appChrome.actions.setCompoundButtonCommandValueId(H,y.Mf)),F.push(appChrome.actions.updateCompoundButtonDescription(H,this.oQj(m.length)));
else if(this.vb.syc){let A=this.hqg(m[B]);H="GetHelpFromTellMe"+(B+1).toString();this.vb.nYa&&(A=this.Rlg(A));K=9;F.push(appChrome.actions.setControlLabel(H,A));F.push(appChrome.actions.setButtonCommandValueId(H,this.mQj(m[B])))}appChrome.api.dispatch(F);F=new k.a(H,K,null,null,0);F.label=this.hqg(m[B]);F.description=this.lQj(m[B]);C.qt(F);if(this.vb.syc)break}C.displayName=CommonUIStrings.l_HelpButtonTitle;return C}oQj(y){return 1===y?String.format(CommonUIStrings.l_SearchResultText,y):String.format(CommonUIStrings.l_SearchResultsText,
y)}Rlg(y){return this.vb.Zxe?r.a.Ohe(y,CommonUIStrings.l_HelpScopedButtonText):y+CommonUIStrings.l_HelpScopedButtonText}hqg(y){return y.name?y.name:""}lQj(y){return y.description?y.description:""}mQj(y){return y.id?"AssetID="+y.id:""}}Object(L.a)(D,"AssistanceResultsProvider",null,[1132])},1019:function(L,V,d){d.d(V,"a",function(){return y});L=d(0);d(145);var k=d(159),e=d(174),n=d(173),r=d(116),w=d(108),D=d(302);class y{constructor(m){this.vb=m}hF(){return"Image"}CM(){return 0===this.vb.pr?0:1===
this.vb.pr?1:3===this.vb.pr?3:2}AC(m,C,E,F,B=null){E=new n.a(m);(!B||Array.contains(B,19))&&w.a.SG(m)&&this.vb.gJ&&this.BWa(m,E,1);C.oo(E)}BWa(m,C,E,F=null){var B=[];let H;r.TellMeActor.instance.cI()&&r.TellMeActor.instance.cI().nYa?(H=this.vb.Zxe?w.a.Ohe(m.Mf,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):m.Mf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.vb.x$e||B.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.vb.gJ?
w.a.SG(m)?this.vb.OSa?w.a.zVa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.vb.OSa?w.a.zVa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,m.Mf)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,m.Mf):this.vb.TRb?CommonUIStrings.l_TellMeImageSuggestionButtonText:m.Mf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.vb.wfa?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
H)),B=w.a.bFa(m.Mf,9,Object.assign(new D.a,{landingTab:"Image"})),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",B))):(B.push(appChrome.actions.setControlLabel("ImageForSearch",H)),m=w.a.bFa(m.Mf,9,Object.assign(new D.a,{landingTab:"Image"})),B.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",m)),appChrome.api.dispatch(B));E=new k.a("ImageForSearch",12,null,null,E);F&&(E.score=F.ConfidenceScore);F=new e.a(19,this.vb.TRb?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);F.qt(E);C.jr(F)}}Object(L.a)(y,"ImageResultsProvider",null,[1132])},1020:function(L,V,d){d.d(V,"a",function(){return D});L=d(0);d(145);var k=d(159),e=d(174),n=d(173),r=d(108),w=d(25);class D{constructor(y){this.vb=y}hF(){return"Template"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:3}AC(y,m){y=new n.a(y);m.oo(y)}BWa(y,m,C){var E=[];let F;F=this.vb.gJ?this.vb.OSa?r.a.zVa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,y.Mf)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
y.Mf):String.format(CommonUIStrings.l_TellMeTemplateButtonText,y.Mf);E.push(appChrome.actions.setControlLabel("TemplateForSearch",F));E.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(w.AFrameworkApplication.fa.Ea("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,y.Mf)));appChrome.api.dispatch(E);y=new e.a(23);y.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;E=new k.a("TemplateForSearch",24,null,null,0);E.label=C[0].Title?C[0].Title:"";E.description=
C[0].Description?C[0].Description:"";y.qt(E);m.jr(y)}}Object(L.a)(D,"TemplateResultsProvider",null,[1132])},1021:function(L,V,d){d.d(V,"a",function(){return C});L=d(0);d(145);var k=d(343),e=d(159),n=d(174),r=d(173),w=d(709),D=d(116),y=d(108),m=d(46);class C{constructor(E,F,B,H){this.PT=E;this.dSa=F;this.rHf=H;this.sei=B;this.vb=D.TellMeActor.instance.cI()}hF(){return"EmptyQuery"}CM(){return 1===this.vb.pr?1:0}AC(E,F,B=!1,H,K=null){H=new r.a(E);if((!K||Array.contains(K,5)||Array.contains(K,6)||Array.contains(K,
4))&&y.a.SG(E)){this.PT.bac().length||!this.sei||this.rHf||(E=new n.a(6),K=new e.a(null,13,void 0,void 0,1),E.qt(K),H.jr(E));E=new n.a(4);if(0<this.PT.bac().length){E.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;K=this.PT.bac();var A=[];for(var W of K)A.push(W.Id);k.CommandResultsUtility.mUb(A,this.vb);for(var N of K)k.CommandResultsUtility.tec(N.Id)&&E.qt(new e.a(N.Id,5,null,null,2));H.jr(E)}if(this.rHf&&0<this.dSa.length&&this.PT.bac().length<C.maxResults){W=new n.a(5);W.displayName=CommonUIStrings.l_TellMeTryQueryTitle;
N=C.maxResults-E.results.length;E=[];for(K=0;K<this.dSa.length&&K<N;++K){if(B){A=y.a.lgf+(K+1);const P=this.dSa[K].key,U=m.a.replaceAll(P,'"',"");E.push(appChrome.actions.setControlLabel(A,P));E.push(appChrome.actions.setButtonCommandValueId(A,U));A=new w.a(P,7,0,U,A)}else A=new w.a(this.dSa[K].key,7,0,this.dSa[K].value);W.qt(A)}0<E.length&&appChrome.api.dispatch(E);H.jr(W)}}F.oo(H)}}C.maxResults=5;Object(L.a)(C,"EmptyQueryResultsProvider",null,[1132])},1022:function(L,V,d){d.d(V,"a",function(){return k});
L=d(0);class k{constructor(){this.xCd=this.Qva=this.cXa=this.mu=this.uQc=this.EA=this.oqb=0}}Object(L.a)(k,"TRIESCAN",null,[])},1023:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.esm=0]="Service";e[e.j8h=1]="Local";e[e.xrm=2]="MRU";e[e.i9h=3]="TestResult";e[e.Unknown=4]="Unknown"})(k||(k={}));Object(L.b)("SubResultType",k)},1040:function(L,V,d){d.r(V);var k=d(0),e=d(145),n=d(391),r=d(268),w=d(159),D=d(174),y=d(173),m=d(116),C=d(108),E=d(302);class F{constructor(Da){this.vb=
Da}hF(){return"ActionAI"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa,lb=!1,Lb,oc=null){Lb=new y.a(Da);if(!oc||Array.contains(oc,24))if(this.YYl()||!C.a.SG(Da)){oc=new D.a(24);var Jc=C.a.SG(Da);lb&&(lb=null,C.a.V$()&&(lb=C.a.bFa(Jc?"":Da.Mf,1,Object.assign(new E.a,{landingTab:"ActionAI"}))),this.vb.wfa?lb&&m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",lb)):(Da=[],lb&&Da.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
lb)),appChrome.api.dispatch(Da)));oc.qt(new w.a("ActionAIFromTellMe",25,null,null,1));Lb.jr(oc)}Wa.oo(Lb)}YYl(){return C.a.V$()&&this.vb.Ste}}Object(k.a)(F,"ActionAIResultsProvider",null,[1132]);var B=d(726);class H{constructor(Da,Wa){this.HHd=Da;this.pi=Wa}oo(Da){this.HHd.USl(this.pi,Da)}}Object(k.a)(H,"AggregatorResultsProviderCallback",null,[1180]);class K{constructor(Da){this.Yca=null;this.vb=Da;this.vb.O9a&&(this.Yca=null)}hF(){return"AppsForOffice"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?
1:2}AC(Da,Wa,lb,Lb,oc=null){lb=new y.a(Da);if(!oc||Array.contains(oc,1))oc=new D.a(1),this.Yca.Msm(oc,Da.Mf),lb.jr(oc);Wa.oo(lb)}}Object(k.a)(K,"AppsForOfficeRecommendationResultsProvider",null,[1132]);var A=d(1018),W=d(79),N=d(227),P=d(19);class U{constructor(Da,Wa){this.Ka=Da;this.sIk=Wa}isMatch(Da,Wa){if(!Object(P.a)(1312,Da))throw Error.argument("objToTest","Expected feature bundle");let lb;return({value:lb}=Da.Sn(this.Ka.jea)).returnValue?this.Ka.Nif.isMatch(lb,Wa):this.sIk}}Object(k.a)(U,"AnnotatedWithAndValueMatchesAnnotationFilter",
null,[1355]);class Q{constructor(Da,Wa){this.Ka=Da;this.WFe=Wa}isMatch(Da){if(!Object(P.a)(1312,Da))throw Error.argument("objToTest","Expected feature bundle");return!!(this.WFe^Da.Sn(this.Ka.jea).returnValue)}}Object(k.a)(Q,"AnnotatedWithAnnotationFilter",null,[1355]);class G{constructor(Da){this.Ka=Da}isMatch(Da,Wa){if(!Object(P.a)(1315,Da))throw Error.argument("objToTest","Expected struct value");return this.Ka.Nif.isMatch(Da.OVa(this.Ka.Pua),Wa)}}Object(k.a)(G,"FieldValueMatchesStructFilter",
null,[1355]);class Y{constructor(Da,Wa){Da&&(this.Pua=Da.ga(0),this.Nif=Wa.m$(Da.ga(1)))}}Object(k.a)(Y,"FieldValueMatchesStructFilterInit",null,[]);class ba{constructor(Da){this.WFe=Da}isMatch(Da){if(!Object(P.a)(1312,Da))throw Error.argument("objToTest","Expected feature bundle");return!!(this.WFe^Da.qne)}}Object(k.a)(ba,"HasAnnotationsAnnotationFilter",null,[1355]);class ha{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da,Wa){if(!Object(P.a)(1314,Da))throw Error.argument("objToTest","Expected list value");
switch(this.Fr){case 0:for(const lb of Da.items)if(this.Ka.filter.isMatch(lb,Wa))return!0;return!1;case 1:for(const lb of Da.items)if(!this.Ka.filter.isMatch(lb,Wa))return!1;return!0;default:throw Error.notImplemented();}}}Object(k.a)(ha,"ItemTestListFilter",null,[1355]);class ka{constructor(Da){this.Ka=Da}isMatch(Da,Wa){if(!Object(P.a)(1314,Da))throw Error.argument("objToTest","Expected list value");return this.Ka.filter.isMatch(Da.items.length,Wa)}}Object(k.a)(ka,"LengthMatchesListFilter",null,
[1355]);class ca{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da,Wa,lb=null){let Lb=0===this.Fr;for(const oc of this.Ka.yWf)if((Lb=oc.isMatch(Da,Wa,lb))?1===this.Fr:0===this.Fr)return Lb;2===this.Fr&&(Lb=!Lb);return Lb}}Object(k.a)(ca,"NonterminalFilter",null,[1355]);class ia{constructor(Da,Wa){if(Da){var lb=Da.ga(0);this.yWf=Array(lb);for(let Lb=0;Lb<lb;++Lb)this.yWf[Lb]=Wa.m$(Da.ga(1+Lb))}}}Object(k.a)(ia,"NonterminalFilterInit",null,[]);class oa{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da,
Wa){if("number"!==typeof Da)throw Error.argument("objToTest","Expected number value");let lb=this.Ka.number;if(this.Ka.query){Wa=this.Ka.query.Yp(null,Wa);if("number"!==typeof Wa)throw Error.invalidOperation("Query did not return number");lb+=Wa}switch(this.Fr){case 0:return Da===lb;case 1:return Da<lb;case 2:return Da<=lb;case 3:return Da>lb;case 4:return Da>=lb;default:throw Error.notImplemented();}}}Object(k.a)(oa,"NumberFilter",null,[1355]);class sa{constructor(Da,Wa){Da&&(this.number=Da.ga(0),
this.query=Da.ga(1)?Wa.eF(Da.ga(1)):null)}}Object(k.a)(sa,"NumberFilterInit",null,[]);class Ca{constructor(Da,Wa,lb){this.T_c=this.gBj;this.YJa=Da;this.dSg=Wa;this.bSg=lb}c4d(Da){this.dSg=Da}gBj(Da){if(!Da)throw Error.argument("name","Invalid named feature bundle reference");const Wa=Da.substr(1);return 1===Da.charCodeAt(0)&&Wa===this.YJa?this.dSg:this.bSg?this.bSg.T_c(Da):null}}Object(k.a)(Ca,"SimpleNamedFeatureBundleResolver",null,[1475]);class Ta{constructor(Da){this.Ka=Da}isMatch(Da,Wa){if(!Object(P.a)(1312,
Da))throw Error.argument("objToTest","Expected feature bundle");Da=this.Ka.query.Yp(null,new Ca(this.Ka.TFd,Da,Wa));if("boolean"!==typeof Da)throw Error.invalidOperation("Query did not return bool");return Da}}Object(k.a)(Ta,"PredicateAnnotationFilter",null,[1355]);class R{constructor(Da,Wa){Da&&(this.TFd=Wa.MD(Da.ga(0)),this.query=Wa.eF(Da.ga(1)))}}Object(k.a)(R,"PredicateAnnotationFilterInit",null,[]);class Ha{constructor(Da){this.Ka=Da}isMatch(Da,Wa){if("boolean"!==typeof Da)throw Error.argument("objToTest",
"Expected bool value");Wa=this.Ka.query.Yp(null,Wa);if("boolean"!==typeof Wa)throw Error.invalidOperation("Query did not return bool");return Da===Wa}}Object(k.a)(Ha,"QueryBooleanFilter",null,[1355]);class da{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da,Wa){if("number"!==typeof Da)throw Error.argument("objToTest","Expected integer");Wa=this.Ka.query.Yp(null,Wa);if("number"!==typeof Wa)throw Error.invalidOperation("Query did not return an enum value");switch(this.Fr){case 0:return Da===Wa;case 1:return 0!==
(Da&Wa);case 2:return Da===(Da&Wa);case 3:return Wa===(Da&Wa);default:throw Error.notImplemented();}}}Object(k.a)(da,"QueryEnumFilter",null,[1355]);class Ba{constructor(Da,Wa){Da&&(this.N7c=1===Da.ga(0),this.query=Wa.eF(Da.ga(1)))}}Object(k.a)(Ba,"QueryEnumFilterInit",null,[]);class za{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da,Wa){if(!Object(P.a)(1314,Da))throw Error.argument("objToTest","Expected list value");Wa=this.Ka.query.Yp(null,Wa);if(!Object(P.a)(1314,Wa))throw Error.invalidOperation("Query did not return list value");
if(Da.YV!==Wa.YV)return!1;switch(this.Fr){case 0:return W.Annotations.l5a(W.Annotations.LEj(Da.YV),Da,Wa);case 1:for(const lb of Da.items)for(const Lb of Wa.items)if(W.Annotations.l5a(Da.YV,lb,Lb))return!0;return!1;case 2:for(const lb of Da.items)for(const Lb of Wa.items)if(!W.Annotations.l5a(Da.YV,lb,Lb))return!1;return!0;case 3:for(const lb of Wa.items)for(const Lb of Da.items)if(!W.Annotations.l5a(Da.YV,lb,Lb))return!1;return!0;default:throw Error.notImplemented();}}}Object(k.a)(za,"QueryListFilter",
null,[1355]);class Aa{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da,Wa){if("string"!==typeof Da)throw Error.argument("objToTest","Expected string");Wa=this.Ka.query.Yp(null,Wa);if("string"!==typeof Wa)throw Error.invalidOperation("Query did not return string");this.Ka.sue&&(Da=Da.toUpperCase(),Wa=Wa.toUpperCase());switch(this.Fr){case 0:return Da===Wa;case 1:return 0<=Da.indexOf(Wa);case 2:return Da.startsWith(Wa);case 3:return Da.endsWith(Wa);case 4:return 0<=Wa.indexOf(Da);case 5:return Wa.startsWith(Da);
case 6:return Wa.endsWith(Da);default:throw Error.notImplemented();}}}Object(k.a)(Aa,"QueryStringFilter",null,[1355]);class na{constructor(Da,Wa){Da&&(this.query=Wa.eF(Da.ga(0)),this.sue=1===Da.ga(1))}}Object(k.a)(na,"QueryStringFilterInit",null,[]);class la{constructor(Da){this.Ka=Da}isMatch(Da,Wa){if(!Object(P.a)(1315,Da))throw Error.argument("objToTest","Expected struct value");Wa=this.Ka.query.Yp(null,Wa);if(!Object(P.a)(1315,Wa))throw Error.invalidOperation("Query did not return struct value");
return Da.isEqual(Da)}}Object(k.a)(la,"QueryStructFilter",null,[1355]);class va{constructor(Da){this.Ka=Da}isMatch(Da,Wa){Da=this.Ka.query.Yp(null,Wa);if("boolean"!==typeof Da)throw Error.invalidOperation("Query did not return bool");return Da}}Object(k.a)(va,"QueryWhereConstraintFilter",null,[1355]);class Pa{constructor(Da){this.Ka=Da}isMatch(Da){if("string"!==typeof Da)throw Error.argument("objToTest","Expected string");return this.Ka.regex.test(Da)}}Object(k.a)(Pa,"RegexStringFilter",null,[1355]);
class Qa{constructor(Da,Wa){Da&&(this.regex=Wa.ong(Da.ga(0)))}}Object(k.a)(Qa,"RegexStringFilterInit",null,[]);class Ua{constructor(Da,Wa){Da&&(this.filter=Wa.m$(Da.ga(0)))}}Object(k.a)(Ua,"SingleFilterFilterInit",null,[]);class Ya{constructor(Da,Wa){Da&&(this.query=Wa.eF(Da.ga(0)))}}Object(k.a)(Ya,"SingleQueryFilterInit",null,[]);class Ea{constructor(Da){this.Ka=Da}isMatch(Da){if("boolean"!==typeof Da)throw Error.argument("objToTest","Expected bool value");return Da===this.Ka.value}}Object(k.a)(Ea,
"StoredValueBooleanFilter",null,[1355]);class La{constructor(Da){Da&&(this.value=1===Da.ga(0))}}Object(k.a)(La,"StoredValueBooleanFilterInit",null,[]);class xb{constructor(Da,Wa){this.Ka=Da;this.Fr=Wa}isMatch(Da){if("number"!==typeof Da)throw Error.argument("objToTest","Expected integer");switch(this.Fr){case 0:return this.Ka.N7c?this.Ka.value?!!(Da&this.Ka.value):!Da:Da===this.Ka.value;case 1:return this.Ka.N7c?(Da&this.Ka.value)===this.Ka.value:32>Da&&(1<<Da&this.Ka.value)===this.Ka.value;case 2:return this.Ka.N7c?
!!(Da&this.Ka.value):32>Da&&!!(1<<Da&this.Ka.value);default:throw Error.notImplemented();}}}Object(k.a)(xb,"StoredValueEnumFilter",null,[1355]);class dc{constructor(Da){Da&&(this.N7c=1===Da.ga(0),this.value=Da.ga(1))}}Object(k.a)(dc,"StoredValueEnumFilterInit",null,[]);class gb{constructor(){this.sdl=null;this.T2d=this.Gdb=0}}Object(k.a)(gb,"WHEREConstraintData",null,[]);class gc{constructor(Da){this.Ka=Da}isMatch(Da,Wa){if(!Object(P.a)(gb,Da))throw Error.argument("objToTest","Expected WHERE constraint data");
let lb=-1,Lb=-1;const oc=Da.sdl;switch(this.Ka.X3d){case 4:lb=oc.V9b;Lb=oc.obf;break;case 5:lb=Da.Gdb;Lb=oc.V9b-Da.Gdb;break;case 6:lb=oc.V9b+oc.obf;Lb=Da.Gdb+Da.T2d-lb;break;case 1:case 2:case 3:let Jc=!1;for(let bd=oc.rtm;bd;bd=bd.next)if(this.Ka.$lm===bd.name){Jc=!0;1===this.Ka.X3d?(lb=bd.V9b,Lb=bd.obf):2===this.Ka.X3d?(lb=Da.Gdb,Lb=bd.V9b-Da.Gdb):(lb=bd.V9b+bd.obf,Lb=Da.Gdb+Da.T2d-lb);break}if(!Jc)return!1;break;case 7:lb=Da.Gdb;Lb=Da.T2d;break;default:throw Error.notImplemented();}return null!==
this.Ka.J4l.bvm(oc.bEm,lb,Lb,lb,!0,2,Wa)}}Object(k.a)(gc,"SubSreWhereConstraintFilter",null,[1355]);class Ac{constructor(Da,Wa){if(Da){var lb=Wa.MD(Da.ga(0));this.X3d=lb.charCodeAt(0);this.$lm=lb.substr(1);this.J4l=Wa.LKj(Da.ga(1))}}}Object(k.a)(Ac,"SubSreWhereConstraintFilterInit",null,[]);class $b{constructor(Da){this.Ka=Da}isMatch(Da,Wa,lb=null){if(!Object(P.a)(1312,Da))throw Error.argument("objToTest","Expected feature bundle");if(null==lb)throw Error.argumentNull("parentTextForSpan");if(this.Ka.ANf&&
!this.Ka.ANf.isMatch(Da,Wa))return!1;if(this.Ka.bef){let Lb;if(({value:Lb}=Da.Sn(this.Ka.d4l)).returnValue){if(!this.Ka.bef.isMatch(Lb,Wa))return!1}else{let oc,Jc;if(!({value:oc}=Da.Sn(this.Ka.JTh)).returnValue||!({value:Jc}=Da.Sn(this.Ka.ITh)).returnValue||0>oc||0>Jc||oc+Jc>lb.length||!this.Ka.bef.isMatch(lb.substr(oc,Jc),Wa))return!1}}if(this.Ka.rUh){let Lb;if(!({value:Lb}=Da.Sn(this.Ka.JTh)).returnValue||!this.Ka.rUh.isMatch(Lb,Wa))return!1}if(this.Ka.DIg){let Lb;if(!({value:Lb}=Da.Sn(this.Ka.ITh)).returnValue||
!this.Ka.DIg.isMatch(Lb,Wa))return!1}return!0}}Object(k.a)($b,"TextSpanFilter",null,[1355]);class jc{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.JTh=Da.ga(0),this.ITh=Da.ga(1),this.d4l=Da.ga(2),this.bef=Da.ga(3)?Wa.m$(Da.ga(3)):null,this.ANf=Da.ga(4)?Wa.m$(Da.ga(4)):null,this.rUh=Da.ga(5)?Wa.m$(Da.ga(5)):null,this.DIg=Da.ga(6)?Wa.m$(Da.ga(6)):null)}}Object(k.a)(jc,"TextSpanFilterInit",null,[]);class pb{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.jea=Da.ga(0),this.Nif=
Da.ga(1)?Wa.m$(Da.ga(1)):null)}}Object(k.a)(pb,"ValueFilterAnnotationFilterInit",null,[]);var $a=d(283);class zc{m$(Da,Wa){const lb=Da.ga(0),Lb=new $a.a;Lb.sVa(Da,1,Da.count-1);switch(lb){case 1:return new ca(new ia(Lb,Wa),0);case 2:return new ca(new ia(Lb,Wa),1);case 3:return new ca(new ia(Lb,Wa),2);case 101:return new Pa(new Qa(Lb,Wa));case 103:return new Aa(new na(Lb,Wa),0);case 104:return new Aa(new na(Lb,Wa),1);case 105:return new Aa(new na(Lb,Wa),2);case 106:return new Aa(new na(Lb,Wa),3);case 107:return new Aa(new na(Lb,
Wa),4);case 108:return new Aa(new na(Lb,Wa),5);case 109:return new Aa(new na(Lb,Wa),6);case 201:return new Ea(new La(Lb));case 202:return new Ha(new Ya(Lb,Wa));case 301:return new oa(new sa(Lb,Wa),0);case 302:return new oa(new sa(Lb,Wa),1);case 303:return new oa(new sa(Lb,Wa),2);case 304:return new oa(new sa(Lb,Wa),3);case 305:return new oa(new sa(Lb,Wa),4);case 401:return new xb(new dc(Lb),0);case 402:return new xb(new dc(Lb),1);case 403:return new xb(new dc(Lb),2);case 404:return new da(new Ba(Lb,
Wa),0);case 405:return new da(new Ba(Lb,Wa),1);case 406:return new da(new Ba(Lb,Wa),2);case 407:return new da(new Ba(Lb,Wa),3);case 501:return new G(new Y(Lb,Wa));case 502:return new la(new Ya(Lb,Wa));case 601:return new ha(new Ua(Lb,Wa),0);case 602:return new ha(new Ua(Lb,Wa),1);case 603:return new ka(new Ua(Lb,Wa));case 604:return new za(new Ya(Lb,Wa),0);case 605:return new za(new Ya(Lb,Wa),1);case 606:return new za(new Ya(Lb,Wa),2);case 607:return new za(new Ya(Lb,Wa),3);case 701:return new ba(!1);
case 702:return new ba(!0);case 703:return new Q(new pb(Lb,Wa),!1);case 704:return new Q(new pb(Lb,Wa),!0);case 705:return new U(new pb(Lb,Wa),!1);case 706:return new U(new pb(Lb,Wa),!0);case 707:return new Ta(new R(Lb,Wa));case 901:return new $b(new jc(Lb,Wa));case 1002:return new va(new Ya(Lb,Wa));case 1001:return new gc(new Ac(Lb,Wa));default:throw Error.argument("initData");}}}Object(k.a)(zc,"FilterFactory",null,[1318]);var rb=d(140);class ib{constructor(Da){this.Ka=Da}get iz(){return this.Ka.iz}get iW(){return this.Ka.iW}get ZBd(){return this.Ka.ZBd}get z6c(){return this.Ka.z6c}load(Da,
Wa){return this.Yp(Da,Da?new Ca("root",Da,Wa):Wa)}store(Da,Wa,lb){this.CSb(Da,Wa,Da?new Ca("root",Da,lb):lb,null)}Yp(Da,Wa){if(!this.z6c&&!this.Ka.annotations.eEb(this.iz,Da))throw Error.argument("input","Input value not of expected type");let lb=this.Ka.edg;for(;lb;)Da=lb.load(Da,Wa),lb=lb.next;return Da}CSb(Da,Wa,lb,Lb){if(!this.ZBd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.z6c&&!this.Ka.annotations.eEb(this.iz,Da))throw Error.argument("lvalue",
"Lvalue not of expected type");if(!this.Ka.annotations.eEb(this.iW,Wa))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ka.edg.store(Da,Wa,lb,Lb)}static iYf(Da,Wa,lb,Lb){if(lb===Lb)return Wa;if(W.Annotations.kD(lb)&&W.Annotations.kD(Lb)){lb=W.Annotations.vGa(lb);Lb=W.Annotations.vGa(Lb);const oc=new rb.a(Da,Lb);for(const Jc of Wa.items)Array.add(oc.items,ib.iYf(Da,Jc,lb,Lb));return oc}if(lb===W.Annotations.yra){if(Lb===W.Annotations.Hca)return Wa;if(Lb===W.Annotations.C_)return Wa.toString()}else if(lb===
W.Annotations.Hca){if(Lb===W.Annotations.yra)return Math.floor(Wa);if(Lb===W.Annotations.C_)return Wa.toString()}else if(lb===W.Annotations.C_){if(Lb===W.Annotations.yra)return parseInt(Wa);if(Lb===W.Annotations.Hca)return parseFloat(Wa)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(k.a)(ib,"AnnotationQuery",null,[1385]);class Vb{constructor(){this.iW=this.iz=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}zGa(Da){if(this.next)return{returnValue:this.next,
kra:Da};if(Da){const Wa=Da.g_f;Da=Da.Cwh;return{returnValue:Wa,kra:Da}}return{returnValue:null,kra:Da}}}Object(k.a)(Vb,"AnnotationQueryStep",null,[1481]);class Od extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){Wa=this.Ka.query.Yp(Da,Wa);if(W.Annotations.kD(this.iz)){var lb=W.Annotations.vGa(this.iz);let oc=new rb.a(this.Ka.annotations,lb);if(W.Annotations.kD(this.Ka.query.iW)){if(Da.items.length!==Wa.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");
for(let Jc=0,bd=Da.items.length;Jc<bd;++Jc)Array.add(oc.items,this.UQc(Da.items[Jc],Wa.items[Jc],lb===W.Annotations.Hca))}else for(var Lb of Da.items)Array.add(oc.items,this.UQc(Lb,Wa,lb===W.Annotations.Hca));return oc}if(W.Annotations.kD(this.Ka.query.iW)){Lb=new rb.a(this.Ka.annotations,this.iz);for(lb of Wa.items)Array.add(Lb.items,this.UQc(Da,lb,this.iz===W.Annotations.Hca));return Lb}return this.UQc(Da,Wa,this.iz===W.Annotations.Hca)}UQc(Da,Wa,lb){Da=this.Vwb(Da,Wa);return lb?Da:Math.floor(Da)}}
Object(k.a)(Od,"NumericAnnotationQueryStep",Vb,[]);class jb extends Od{constructor(Da){super(Da)}Vwb(Da,Wa){return Da+Wa}}Object(k.a)(jb,"AddAnnotationQueryStep",Od,[]);class Wb extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){if(this.iz===W.Annotations.$ia&&this.Ka.query.iW===W.Annotations.$ia){let oc;if(({result:oc}=this.SUf(Da)).returnValue)return oc}if(W.Annotations.kD(this.iz)){var lb=new rb.a(this.Ka.annotations,W.Annotations.$ia);Wa=this.Ka.query.Yp(Da,Wa);if(W.Annotations.kD(this.Ka.query.iW)){if(Da.items.length!==
Wa.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let oc=0,Jc=Da.items.length;oc<Jc;++oc)Array.add(lb.items,this.f6b(Wa.items[oc],Da.items[oc]))}else for(var Lb of Da.items)Array.add(lb.items,this.f6b(Wa,Lb));return lb}Lb=this.Ka.query.Yp(Da,Wa);if(W.Annotations.kD(this.Ka.query.iW)){Wa=new rb.a(this.Ka.annotations,W.Annotations.$ia);for(lb of Lb.items)Array.add(Wa.items,this.f6b(lb,Da));return Wa}return this.f6b(Lb,Da)}}Object(k.a)(Wb,"BinaryBooleanAnnotationQueryStep",
Vb,[]);class qb extends Wb{constructor(Da){super(Da)}SUf(Da){return{returnValue:!Da,result:!1}}f6b(Da,Wa){return Da&&Wa}}Object(k.a)(qb,"AndAnnotationQueryStep",Wb,[]);class Ga{constructor(Da){Da&&(this.annotations=Da)}}Object(k.a)(Ga,"AnnotationsOnlyQueryStepInit",null,[]);class cb extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){Wa=this.Ka.query.Yp(Da,Wa);Da=Da.clone();W.Annotations.kD(this.Ka.query.iW)?Array.addRange(Da.items,Wa.items):Array.add(Da.items,Wa);return Da}}Object(k.a)(cb,
"AppendAnnotationQueryStep",Vb,[]);class Ob extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){if(this.iz===W.Annotations.cO)return this.l9b(Da,Wa);const lb=new rb.a(this.Ka.annotations,W.Annotations.cO);for(const Lb of Da.items)Array.add(lb.items,this.l9b(Lb,Wa));return lb}l9b(Da,Wa){const lb=new N.a(this.Ka.annotations);lb.TEa(Da);Da=new N.a(this.Ka.annotations);this.Ka.script.Y9(null,new Ca("Input",lb,new Ca("Output",Da,Wa)));return Da}}Object(k.a)(Ob,"ApplyAnnotationQueryStep",Vb,[]);class Db extends Vb{constructor(Da){super();
this.Ka=Da}load(Da,Wa){if(this.iz===W.Annotations.cO)return Wa=this.l9b(Da,Wa),Wa.Sn(this.Ka.zNf).returnValue||new rb.a(this.Ka.annotations,W.Annotations.cO),Wa;const lb=new rb.a(this.Ka.annotations,W.Annotations.cO);for(const Lb of Da.items)if(Da=this.l9b(Lb,Wa),({value:Da}=Da.Sn(this.Ka.zNf)).returnValue)for(const oc of Da.items)Array.add(lb.items,oc);return lb}l9b(Da,Wa){const lb=new N.a(this.Ka.annotations);lb.TEa(Da);Da=new N.a(this.Ka.annotations);this.Ka.script.Y9(null,new Ca("Input",lb,new Ca("Output",
Da,Wa)));return Da}}Object(k.a)(Db,"ApplyExpandAnnotationQueryStep",Vb,[]);class mb{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.script=Wa.Ubb(Da.ga(0)),this.zNf=Da.ga(1))}}Object(k.a)(mb,"ApplyExpandQueryStepInit",null,[]);class Vc{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.script=Wa.Ubb(Da.ga(0)))}}Object(k.a)(Vc,"ApplyQueryStepInit",null,[]);class Zb extends Vb{constructor(Da){super();this.Ka=Da}load(Da){if(this.iz===W.Annotations.cO)return this.B$c(Da);const Wa=
new rb.a(this.Ka.annotations,this.Ka.annotations.getAttributeType(this.Ka.jea));for(const lb of Da.items)Array.add(Wa.items,this.B$c(lb));return Wa}store(Da,Wa,lb,Lb){if(this.iz===W.Annotations.cO){var oc=Wa,Jc=({kra:Lb}=this.zGa(Lb)).returnValue;Jc&&(oc=Jc.store(W.Annotations.kM(this.B$c(Da)),Wa,lb,Lb));Da.vv(this.Ka.jea,oc)}else{var bd=Wa;if(oc=({kra:Lb}=this.zGa(Lb)).returnValue){bd=new rb.a(this.Ka.annotations,this.Ka.annotations.getAttributeType(this.Ka.jea));for(Jc of Da.items)Array.add(bd.items,
this.B$c(Jc));bd=oc.store(bd,Wa,lb,Lb)}Wa=bd;if(Wa.items.length!==Da.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let rd=0,Zd=Da.items.length;rd<Zd;++rd)lb=Da.items[rd],lb.isReadOnly&&(lb=lb.clone(),Da.items[rd]=lb),lb.vv(this.Ka.jea,Wa.items[rd])}return Da}B$c(Da){({value:Da}=Da.Sn(this.Ka.jea)).returnValue||(Da=this.Ka.annotations.Iuj(this.Ka.jea));return Da}}Object(k.a)(Zb,"AttrAnnotationQueryStep",Vb,[]);class fc{constructor(Da,Wa){Da&&
(this.annotations=Wa,this.jea=Da.ga(0))}}Object(k.a)(fc,"AttrQueryStepInit",null,[]);class ob extends Vb{constructor(Da){super();this.Ka=Da}load(Da){const Wa=new N.a(this.Ka.annotations);Wa.TEa(Da);return this.Ka.module.execute(Wa)}}Object(k.a)(ob,"CallModuleAnnotationQueryStep",Vb,[]);class ub{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.module=Wa.$ie(Da.ga(0)))}}Object(k.a)(ub,"CallModuleQueryStepInit",null,[]);class bc extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){if(W.Annotations.kD(this.iz)){var lb=
this.Ka.query.Yp(Da,Wa);Wa=new rb.a(this.Ka.annotations,W.Annotations.C_);let Jc="string"===typeof lb;for(var Lb of Da.items)if(Jc)Array.add(Wa.items,Lb+lb);else for(var oc of lb.items)Array.add(Wa.items,Lb+oc);return Wa}Lb=this.Ka.query.Yp(Da,Wa);if("string"===typeof Lb)return Da+Lb;oc=new rb.a(this.Ka.annotations,W.Annotations.C_);for(lb of Lb.items)Array.add(oc.items,Da+lb);return oc}}Object(k.a)(bc,"ConcatAnnotationQueryStep",Vb,[]);class ic extends Vb{constructor(Da){super();this.Ka=Da}load(Da){return ib.iYf(this.Ka.annotations,
Da,this.iz,this.iW)}}Object(k.a)(ic,"ConvertAnnotationQueryStep",Vb,[]);class Rc extends Vb{constructor(){super()}load(Da){return Da.items.length}}Object(k.a)(Rc,"CountAnnotationQueryStep",Vb,[]);class Fb extends Od{constructor(Da){super(Da)}Vwb(Da,Wa){return Da/Wa}}Object(k.a)(Fb,"DivideAnnotationQueryStep",Od,[]);class Qb extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){Wa=new Ca(this.Ka.TFd,null,Wa);for(const lb of Da.items)if(Wa.c4d(lb),this.Ka.query.Yp(lb,Wa))return!0;return!1}}Object(k.a)(Qb,
"ExistsAnnotationQueryStep",Vb,[]);class hc extends Od{constructor(Da){super(Da)}Vwb(Da,Wa){return Math.pow(Da,Wa)}}Object(k.a)(hc,"ExpAnnotationQueryStep",Od,[]);class Pc{constructor(Da,Wa){Da&&(this.Oua=Wa.MD(Da.ga(0)))}}Object(k.a)(Pc,"FeatureBundleNameQueryStepInit",null,[]);class uc extends Vb{constructor(Da){super();this.Ka=Da}load(Da){if(W.Annotations.kD(this.iz)){const Wa=new rb.a(this.Ka.annotations,this.Ka.annotations.Rcb(W.Annotations.vGa(this.iz),this.Ka.Pua));for(const lb of Da.items)Array.add(Wa.items,
lb.OVa(this.Ka.Pua));return Wa}return Da.OVa(this.Ka.Pua)}store(Da,Wa,lb,Lb){if(W.Annotations.kD(this.iz)){var oc=Wa,Jc=({kra:Lb}=this.zGa(Lb)).returnValue;if(Jc){oc=new rb.a(this.Ka.annotations,this.Ka.annotations.Rcb(W.Annotations.vGa(this.iz),this.Ka.Pua));for(var bd of Da.items)Array.add(oc.items,bd.OVa(this.Ka.Pua));oc=Jc.store(oc,Wa,lb,Lb)}Wa=oc;if(Wa.items.length!==Da.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let rd=0,Zd=Da.items.length;rd<
Zd;++rd)lb=Da.items[rd],lb.isReadOnly&&(lb=lb.clone(),Da.items[rd]=lb),lb.K7e(this.Ka.Pua,Wa.items[rd])}else Jc=Wa,(bd=({kra:Lb}=this.zGa(Lb)).returnValue)&&(Jc=bd.store(W.Annotations.kM(Da.OVa(this.Ka.Pua)),Wa,lb,Lb)),Da.K7e(this.Ka.Pua,Jc);return Da}}Object(k.a)(uc,"FieldAnnotationQueryStep",Vb,[]);class zb{constructor(Da,Wa){Da&&(this.annotations=Wa,this.Pua=Da.ga(0))}}Object(k.a)(zb,"FieldQueryStepInit",null,[]);class ac extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){for(const lb of Da.items)if(this.Ka.filter.isMatch(lb,
Wa))return lb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Da,Wa,lb,Lb){let oc=Wa,Jc=-1;for(let rd=0,Zd=Da.items.length;rd<Zd;rd++)if(this.Ka.filter.isMatch(Da.items[rd],lb)){Jc=rd;break}if(0>Jc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const bd=({kra:Lb}=this.zGa(Lb)).returnValue;bd&&(oc=bd.store(W.Annotations.kM(Da.items[Jc]),Wa,lb,Lb));Da.items[Jc]=oc;return Da}}Object(k.a)(ac,"FirstItemMatchingAnnotationQueryStep",
Vb,[]);class Jb extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){Wa=new Ca(this.Ka.TFd,null,Wa);for(const lb of Da.items)if(Wa.c4d(lb),!this.Ka.query.Yp(lb,Wa))return!1;return!0}}Object(k.a)(Jb,"ForAllAnnotationQueryStep",Vb,[]);class Yc extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){Da=Wa?Wa.T_c(this.Ka.Oua):null;if(!Da)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ka.Oua+'"');return Da}store(Da,Wa,lb,Lb){Da=lb?lb.T_c(this.Ka.Oua):null;if(!Da)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ka.Oua+'"');let oc=Wa;const Jc=({kra:Lb}=this.zGa(Lb)).returnValue;Jc&&(oc=Jc.store(Da,Wa,lb,Lb));Da!==oc&&Da.TEa(oc);return Da}}Object(k.a)(Yc,"GetAnnotationQueryStep",Vb,[]);class dd{constructor(Da,Wa){this.aci=Da;this.Ali=Wa}get g_f(){return this.aci}get Cwh(){return this.Ali}}Object(k.a)(dd,"AnnotationQueryStoreContinuation",null,[1491]);class id extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){return this.Ka.ICd.Yp(Da,Wa)?this.Ka.UZh.Yp(Da,Wa):this.Ka.PXc?this.Ka.PXc.Yp(Da,Wa):
Da}store(Da,Wa,lb,Lb){var oc=this.Ka.ICd.Yp(Da,lb);this.next&&(Lb=new dd(this.next,Lb));if(oc)return this.Ka.UZh.CSb(Da,Wa,lb,Lb);if(this.Ka.PXc)return this.Ka.PXc.CSb(Da,Wa,lb,Lb);oc=Wa;let Jc=null;Lb&&(Jc=Lb.g_f,Lb=Lb.Cwh);Jc&&(oc=Jc.store(W.Annotations.kM(Da),Wa,lb,Lb));return oc}}Object(k.a)(id,"IfAnnotationQueryStep",Vb,[]);class Cc{constructor(Da,Wa){Da&&(this.ICd=Wa.eF(Da.ga(0)),this.UZh=Wa.eF(Da.ga(1)),this.PXc=Da.ga(2)?Wa.eF(Da.ga(2)):null)}}Object(k.a)(Cc,"IfQueryStepInit",null,[]);class Nb{constructor(Da,
Wa){Da&&(this.d8j=Wa.eF(Da.ga(0)),this.mHg=Wa.eF(Da.ga(1)))}}Object(k.a)(Nb,"IndexAndItemQueryStepInit",null,[]);class nc extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){const lb=this.Ka.d8j.Yp(Da,Wa);Wa=this.Ka.mHg.Yp(Da,Wa);Da=Da.clone();if(0>lb||lb>Da.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(W.Annotations.kD(this.Ka.mHg.iW))for(let Lb=0;Lb<Wa.items.length;++Lb)Array.insert(Da.items,lb+Lb,Wa.items[Lb]);else Array.insert(Da.items,lb,Wa);
return Da}}Object(k.a)(nc,"InsertAtAnnotationQueryStep",Vb,[]);class Kc extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){return!(!Wa||!Wa.T_c(this.Ka.Oua))}}Object(k.a)(Kc,"IsDefinedAnnotationQueryStep",Vb,[]);class xd extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){Wa=this.lBb(Da,Wa);return Da.items[Wa]}store(Da,Wa,lb,Lb){const oc=this.lBb(Da,lb);let Jc=Wa;const bd=({kra:Lb}=this.zGa(Lb)).returnValue;bd&&(Jc=bd.store(W.Annotations.kM(Da.items[oc]),Wa,lb,Lb));Da.items[oc]=Jc;return Da}lBb(Da,
Wa){Wa=this.Ka.query.Yp(Da,Wa);if(0>Wa||Wa>=Da.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Wa}}Object(k.a)(xd,"ItemAnnotationQueryStep",Vb,[]);class Xc extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){const lb=new rb.a(this.Ka.annotations,W.Annotations.vGa(this.iz));for(const Lb of Da.items)this.Ka.filter.isMatch(Lb,Wa)&&Array.add(lb.items,Lb);return lb}}Object(k.a)(Xc,"ItemsMatchingAnnotationQueryStep",Vb,[]);class Tb extends Vb{constructor(Da){super();
this.Ka=Da}load(Da,Wa){Wa=this.lBb(Da,Wa);return Da.items[Da.items.length-Wa-1]}store(Da,Wa,lb,Lb){const oc=this.lBb(Da,lb);let Jc=Wa;const bd=({kra:Lb}=this.zGa(Lb)).returnValue;bd&&(Jc=bd.store(W.Annotations.kM(Da.items[Da.items.length-oc-1]),Wa,lb,Lb));Da.items[Da.items.length-oc-1]=Jc;return Da}lBb(Da,Wa){Wa=this.Ka.query?this.Ka.query.Yp(Da,Wa):0;if(0>Wa||Wa>=Da.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Wa}}Object(k.a)(Tb,"LastItemAnnotationQueryStep",
Vb,[]);class he extends Vb{constructor(Da){super();this.Ka=Da}load(Da){if(W.Annotations.kD(this.iz)){const Wa=new rb.a(this.Ka.annotations,W.Annotations.yra);for(const lb of Da.items)Array.add(Wa.items,lb.length);return Wa}return Da.length}}Object(k.a)(he,"LengthAnnotationQueryStep",Vb,[]);class re extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){if(W.Annotations.kD(this.iz)){const lb=new rb.a(this.Ka.annotations,W.Annotations.$ia);for(const Lb of Da.items)Array.add(lb.items,this.Ka.filter.isMatch(Lb,
Wa));return lb}return this.Ka.filter.isMatch(Da,Wa)}}Object(k.a)(re,"MatchesAnnotationQueryStep",Vb,[]);class ee extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){return this.Ka.filter.isMatch(Da,Wa)}}Object(k.a)(ee,"MatchesAsListAnnotationQueryStep",Vb,[]);class Yf extends Od{constructor(Da){super(Da)}Vwb(Da,Wa){return Da%Wa}}Object(k.a)(Yf,"ModuloAnnotationQueryStep",Od,[]);class ke extends Od{constructor(Da){super(Da)}Vwb(Da,Wa){return Da*Wa}}Object(k.a)(ke,"MultiplyAnnotationQueryStep",
Od,[]);class ef extends Vb{constructor(Da){super();this.Ka=Da}load(Da){if(W.Annotations.kD(this.iz)){const Wa=new rb.a(this.Ka.annotations,W.Annotations.$ia);for(const lb of Da.items)Array.add(Wa.items,!lb);return Wa}return!Da}}Object(k.a)(ef,"NotAnnotationQueryStep",Vb,[]);class yf extends Wb{constructor(Da){super(Da)}SUf(Da){return{returnValue:Da,result:!0}}f6b(Da,Wa){return Da||Wa}}Object(k.a)(yf,"OrAnnotationQueryStep",Wb,[]);class Rf extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){const lb=
this.Ka.Jbf.Yp(Da,Wa);Da=this.Ka.D6b.Yp(Da,Wa);Wa=new rb.a(this.Ka.annotations,W.Annotations.yra);for(let Lb=0;Lb<Da;++Lb)Array.add(Wa.items,lb+Lb);return Wa}}Object(k.a)(Rf,"RangeAnnotationQueryStep",Vb,[]);class Za{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.filter=Wa.m$(Da.ga(0)))}}Object(k.a)(Za,"SingleFilterQueryStepInit",null,[]);class Kb{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.query=Da.ga(0)?Wa.eF(Da.ga(0)):null)}}Object(k.a)(Kb,"SingleOptionalQueryQueryStepInit",
null,[]);class Ic{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.query=Wa.eF(Da.ga(0)))}}Object(k.a)(Ic,"SingleQueryQueryStepInit",null,[]);class Hc{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.Jbf=Wa.eF(Da.ga(0)),this.D6b=Da.ga(1)?Wa.eF(Da.ga(1)):null)}}Object(k.a)(Hc,"StartAndCountOrLengthQueryStepInit",null,[]);class jd extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){let lb;({bOa:Wa,length:lb}=this.i2c(Da,Wa));const Lb=new rb.a(this.Ka.annotations,Da.YV);
for(let oc=0;oc<lb;++oc)Array.add(Lb.items,Da.items[Wa+oc]);return Lb}store(Da,Wa,lb,Lb){let oc,Jc;({bOa:oc,length:Jc}=this.i2c(Da,lb));var bd=Wa;const rd=({kra:Lb}=this.zGa(Lb)).returnValue;if(rd){bd=new rb.a(this.Ka.annotations,Da.YV);for(let Zd=0;Zd<Jc;++Zd)Array.add(bd.items,Da.items[oc+Zd]);bd=rd.store(bd,Wa,lb,Lb)}Wa=bd;for(lb=0;lb<Jc;++lb)Array.removeAt(Da.items,oc);for(let Zd=0,ea=Wa.items.length;Zd<ea;++Zd)Array.insert(Da.items,oc+Zd,Wa.items[Zd]);return Da}i2c(Da,Wa){let lb;lb=this.Ka.Jbf.Yp(Da,
Wa);if(0>lb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Wa=this.Ka.D6b?this.Ka.D6b.Yp(Da,Wa):Da.items.length-lb;if(0>Wa||lb+Wa>Da.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{bOa:lb,length:Wa}}}Object(k.a)(jd,"SublistAnnotationQueryStep",Vb,[]);class Id extends Vb{constructor(Da){super();this.Ka=Da}load(Da,Wa){if(W.Annotations.kD(this.iz)){const lb=new rb.a(this.Ka.annotations,W.Annotations.C_);for(let Lb=
0,oc=Da.items.length;Lb<oc;++Lb)Array.add(lb.items,this.getSubstring(Da.items[Lb],Wa));return lb}return this.getSubstring(Da,Wa)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(Da,Wa){let lb;({bOa:Wa,length:lb}=this.i2c(Da,Wa));return Da.substr(Wa,lb)}i2c(Da,Wa){let lb;lb=this.Ka.Jbf.Yp(Da,Wa);if(0>lb)throw Error.invalidOperation("Invalid start index in Substring() query step");Wa=this.Ka.D6b?this.Ka.D6b.Yp(Da,Wa):Da.length-lb;if(0>Wa||lb+Wa>
Da.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{bOa:lb,length:Wa}}}Object(k.a)(Id,"SubstringAnnotationQueryStep",Vb,[]);class ze extends Od{constructor(Da){super(Da)}Vwb(Da,Wa){return Da-Wa}}Object(k.a)(ze,"SubtractAnnotationQueryStep",Od,[]);class Ie extends Vb{constructor(Da){super();this.Ka=Da}load(Da){const Wa=new rb.a(this.Ka.annotations,W.Annotations.C_);for(let lb=0;lb<Da.length;++lb)Array.add(Wa.items,Da.charAt(lb).toString());
return Wa}}Object(k.a)(Ie,"ToCharListAnnotationQueryStep",Vb,[]);class Cd extends Vb{constructor(Da){super();this.Ka=Da}load(Da){const Wa=new rb.a(this.Ka.annotations,this.iz);Array.add(Wa.items,Da);return Wa}}Object(k.a)(Cd,"ToListAnnotationQueryStep",Vb,[]);class ue extends Vb{constructor(Da){super();this.Ka=Da}load(){return this.Ka.value}}Object(k.a)(ue,"ValueAnnotationQueryStep",Vb,[]);class Ee{constructor(Da,Wa){if(Da){var lb=Da.ga(0),Lb=1;this.value=({z5:Lb}=Wa.pua(lb,Da,Lb,null,null,null)).returnValue;
W.Annotations.Jfb(this.value)}}}Object(k.a)(Ee,"ValueQueryStepInit",null,[]);class Xe{constructor(Da,Wa){Da&&(this.TFd=Wa.MD(Da.ga(0)),this.query=Wa.eF(Da.ga(1)))}}Object(k.a)(Xe,"VarNameAndQueryQueryStepInit",null,[]);class Sd{constructor(Da,Wa){this.$sf=null;if(Da){this.annotations=Wa.annotations;var lb=0;this.iz=Da.ga(lb);++lb;this.iW=Da.ga(lb);++lb;this.ZBd=1===Da.ga(lb);++lb;this.z6c=1===Da.ga(lb);++lb;var Lb=Da.ga(lb);++lb;if(Lb){var oc=lb,Jc=lb+Lb,bd=lb+2*Lb;lb+=3*Lb;var rd=Da.count-lb,Zd=
null;for(let Ka=0;Ka<Lb;++Ka){var ea=lb+Da.ga(bd+Ka);const bb=(Ka===Lb-1?rd:Da.ga(bd+Ka+1))-Da.ga(bd+Ka),vb=new $a.a;vb.sVa(Da,ea,bb);ea=Sd.qGj(Da.ga(Jc+Ka),vb,Wa);ea.iz=Da.ga(oc+Ka);ea.iW=Ka===Lb-1?this.iW:Da.ga(oc+Ka+1);Zd?Zd.next=ea:this.$sf=ea;Zd=ea}}}}get edg(){return this.$sf}static qGj(Da,Wa,lb){switch(Da){case 1:return new Yc(new Pc(Wa,lb));case 2:return new Kc(new Pc(Wa,lb));case 3:return new Zb(new fc(Wa,lb.annotations));case 4:return new uc(new zb(Wa,lb.annotations));case 5:return new id(new Cc(Wa,
lb));case 6:return new re(new Za(Wa,lb));case 43:return new ee(new Za(Wa,lb));case 45:return new Ob(new Vc(Wa,lb));case 49:return new Db(new mb(Wa,lb));case 46:return new ue(new Ee(Wa,lb.annotations));case 51:return new ob(new ub(Wa,lb));case 52:return new Rf(new Hc(Wa,lb));case 53:return new ic(new Ga(lb.annotations));case 13:return new xd(new Ic(Wa,lb));case 14:return new Tb(new Kb(Wa,lb));case 15:return new Rc;case 18:return new ac(new Za(Wa,lb));case 16:return new Jb(new Xe(Wa,lb));case 17:return new Qb(new Xe(Wa,
lb));case 22:return new nc(new Nb(Wa,lb));case 24:return new cb(new Ic(Wa,lb));case 26:return new jd(new Hc(Wa,lb));case 27:return new Xc(new Za(Wa,lb));case 30:return new Cd(new Ga(lb.annotations));case 31:return new Id(new Hc(Wa,lb));case 32:return new bc(new Ic(Wa,lb));case 47:return new he(new Ga(lb.annotations));case 48:return new Ie(new Ga(lb.annotations));case 34:return new jb(new Ic(Wa,lb));case 35:return new ze(new Ic(Wa,lb));case 36:return new ke(new Ic(Wa,lb));case 37:return new Fb(new Ic(Wa,
lb));case 38:return new Yf(new Ic(Wa,lb));case 39:return new hc(new Ic(Wa,lb));case 40:return new qb(new Ic(Wa,lb));case 41:return new yf(new Ic(Wa,lb));case 42:return new ef(new Ga(lb.annotations));default:throw Error.argument("currStepInitData");}}}Object(k.a)(Sd,"AnnotationQueryInit",null,[]);class ad{constructor(Da){this.Ka=Da}execute(Da,Wa){this.Y9(Da,Da?new Ca("root",Da,Wa):Wa)}Y9(Da,Wa){for(const lb of this.Ka.commands)Wa=lb.execute(Da,Wa)}}Object(k.a)(ad,"AnnotationScript",null,[1384]);class af{constructor(Da){this.Ka=
Da}execute(Da,Wa){const lb=this.Ka.$ak.Yp(Da,Wa),Lb=this.Ka.$bl.Yp(Da,Wa);this.Ka.script.Y9(Da,new Ca("Input",lb,new Ca("Output",Lb,Wa)));return Wa}}Object(k.a)(af,"ApplyAnnotationScriptCommand",null,[1476]);class pf{constructor(Da,Wa){Da&&(this.$ak=Wa.eF(Da.ga(0)),this.$bl=Wa.eF(Da.ga(1)),this.script=Wa.Ubb(Da.ga(2)))}}Object(k.a)(pf,"ApplyScriptCommandInit",null,[]);class xf{constructor(Da){this.Ka=Da}execute(Da,Wa){const lb=this.Ka.O5e.Yp(Da,Wa);this.Ka.bad.CSb(Da,lb,Wa,null);return Wa}}Object(k.a)(xf,
"AssignAnnotationScriptCommand",null,[1476]);class gf{constructor(Da){this.Ka=Da}execute(Da,Wa){const lb=this.Ka.bad.Yp(Da,Wa);Da=this.Ka.O5e.Yp(Da,Wa);lb!==Da&&lb.TEa(Da);return Wa}}Object(k.a)(gf,"CopyAnnotationScriptCommand",null,[1476]);class me{constructor(Da){this.Ka=Da}execute(Da,Wa){let lb=this.Ka.Zze.Yp(Da,Wa);if(this.Ka.Zze.ZBd){lb=W.Annotations.kM(lb);var Lb=new Ca(this.Ka.Oua,null,Wa);for(let Jc=0,bd=lb.items.length;Jc<bd;++Jc){var oc=this.y$f(Da,lb.items[Jc],Lb);if(0>this.Ka.fwd)lb.items[Jc]=
oc;else if(({value:oc}=oc.Sn(this.Ka.fwd)).returnValue)lb.items[Jc]=oc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ka.Zze.CSb(Da,lb,Wa,null)}else{Lb=new Ca(this.Ka.Oua,null,Wa);for(let Jc=0,bd=lb.items.length;Jc<bd;++Jc)this.y$f(Da,lb.items[Jc],Lb)}return Wa}y$f(Da,Wa,lb){let Lb;0>this.Ka.fwd?Lb=W.Annotations.kM(Wa):(Lb=new N.a(this.Ka.annotations),Lb.vv(this.Ka.fwd,Wa));lb.c4d(Lb);this.Ka.JIi.Y9(Da,lb);return Lb}}Object(k.a)(me,"EnumerateAnnotationScriptCommand",
null,[1476]);class ag{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.Oua=Wa.MD(Da.ga(0)),this.Zze=Wa.eF(Da.ga(1)),this.JIi=Wa.Ubb(Da.ga(2)),this.fwd=Da.ga(3))}}Object(k.a)(ag,"EnumerateScriptCommandInit",null,[]);class de{constructor(Da){this.Ka=Da}execute(Da,Wa){this.Ka.ICd.Yp(Da,Wa)?this.Ka.Qcm.Y9(Da,Wa):this.Ka.qbg&&this.Ka.qbg.Y9(Da,Wa);return Wa}}Object(k.a)(de,"IfAnnotationScriptCommand",null,[1476]);class wa{constructor(Da,Wa){Da&&(this.ICd=Wa.eF(Da.ga(0)),this.Qcm=Wa.Ubb(Da.ga(1)),
this.qbg=Da.ga(2)?Wa.Ubb(Da.ga(2)):null)}}Object(k.a)(wa,"IfScriptCommandInit",null,[]);class ta{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.bad=Wa.eF(Da.ga(0)),this.O5e=Wa.eF(Da.ga(1)))}}Object(k.a)(ta,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Eb{constructor(Da){this.Ka=Da}execute(Da,Wa){const lb=this.Ka.O5e.Yp(this.Ka.bad.Yp(Da,Wa),Wa);this.Ka.bad.CSb(Da,lb,Wa,null);return Wa}}Object(k.a)(Eb,"ModifyAnnotationScriptCommand",null,[1476]);class qc{constructor(Da){this.Ka=
Da}execute(Da,Wa){const lb=new N.a(this.Ka.annotations);this.Ka.query&&lb.TEa(this.Ka.query.Yp(Da,Wa));return Wa=new Ca(this.Ka.Oua,lb,Wa)}}Object(k.a)(qc,"NewAnnotationScriptCommand",null,[1476]);class Sc{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.Oua=Wa.MD(Da.ga(0)),this.query=Da.ga(1)?Wa.eF(Da.ga(1)):null)}}Object(k.a)(Sc,"NewScriptCommandInit",null,[]);class td{constructor(Da){this.Ka=Da}execute(Da,Wa){Da=this.Ka.query.Yp(Da,Wa);if(this.Ka.query.iW===W.Annotations.cO)Da.$ud(this.Ka.jea);
else for(const lb of Da.items)lb.$ud(this.Ka.jea);return Wa}}Object(k.a)(td,"RemoveAnnotationScriptCommand",null,[1476]);class je{constructor(Da,Wa){Da&&(this.annotations=Wa.annotations,this.query=Wa.eF(Da.ga(0)),this.jea=Da.ga(1))}}Object(k.a)(je,"RemoveScriptCommandInit",null,[]);class Te{constructor(Da,Wa){if(Da){var lb=0,Lb=Da.ga(lb);++lb;if(Lb){var oc=lb,Jc=lb+Lb;lb+=2*Lb;var bd=Da.count-lb;this.commands=Array(Lb);for(let rd=0;rd<Lb;++rd){const Zd=lb+Da.ga(Jc+rd),ea=(rd===Lb-1?bd:Da.ga(Jc+rd+
1))-Da.ga(Jc+rd),Ka=new $a.a;Ka.sVa(Da,Zd,ea);this.commands[rd]=Te.mGj(Da.ga(oc+rd),Ka,Wa)}}}}static mGj(Da,Wa,lb){switch(Da){case 1:return new xf(new ta(Wa,lb));case 2:return new Eb(new ta(Wa,lb));case 3:return new td(new je(Wa,lb));case 6:return new qc(new Sc(Wa,lb));case 7:return new me(new ag(Wa,lb));case 8:return new de(new wa(Wa,lb));case 9:return new gf(new ta(Wa,lb));case 10:return new af(new pf(Wa,lb));default:throw Error.argument("initData");}}}Object(k.a)(Te,"AnnotationScriptInit",null,
[]);var Hd=d(723);class mg{constructor(Da){this.oJ=Da;this.nO=0}$Z(){const Da=this.oJ.tv(this.nO,4);this.nO+=4;return Da}get Q3b(){return this.oJ}get offset(){return this.nO}set offset(Da){this.nO=Da}}Object(k.a)(mg,"ByteArrayReader",null,[]);class fg{constructor(){this.YD=null;this.iUg=this.nA=0}ga(Da){if(0>Da||Da>=this.nA)throw Error.argumentOutOfRange("index");return this.YD.tv(this.iUg+4*Da,4)}get count(){return this.nA}static w3i(Da,Wa,lb){const Lb=new fg;Lb.YD=Da;Lb.iUg=Wa;Lb.nA=lb;return Lb}}
Object(k.a)(fg,"ReadOnlyListOverByteArray",null,[1356]);class $e{constructor(Da,Wa){this.URg=this.CRg=!1;this.Ls=this.Gya=this.HBe=this.eSg=null;try{this.Ls=Wa.annotations;const lb=Wa.BVa(Da.ga(0)),Lb=new mg(lb);if(-914743053!==Lb.$Z())throw Error.argument("Input does not represent a flat lexicon");this.CRg=1===Lb.$Z();this.URg=1===Lb.$Z();const oc=Lb.$Z();Lb.offset+=oc;const Jc=Lb.$Z();this.HBe=$e.xdl(Lb,Jc,this.Ls);const bd=Lb.$Z();this.eSg=$e.Ldl(Lb,bd);const rd=Lb.$Z();this.Gya=new Hd.a(Lb.Q3b,
Lb.offset);Lb.offset+=rd}catch(lb){throw Error.argument("initData");}}get trie(){return this.Gya}Nvj(Da){return"i"===Da&&this.URg?"\u0130":Da.toUpperCase()}sue(){return this.CRg}muj(Da){let Wa;Wa=new rb.a(this.Ls,W.Annotations.cO);if(1!==Da)if(0===Da)Da=new N.a(this.Ls),Array.add(Wa.items,Da);else if(Da&1073741824){Da=this.eSg[Da&-1073741825];for(let Lb=0;Lb<Da.length;++Lb){var lb=Da[Lb];lb=0===lb?new N.a(this.Ls):this.HBe[lb-2];Array.add(Wa.items,lb)}}else Array.add(Wa.items,this.HBe[Da-2]);return{returnValue:!0,
twk:Wa}}static xdl(Da,Wa,lb){if(Wa%4)throw Error.argument("reader");const Lb=fg.w3i(Da.Q3b,Da.offset,Wa/4);Da.offset+=Wa;Da=[];for(Wa=0;Wa<Lb.count;){const oc=({z5:Wa}=lb.pua(W.Annotations.cO,Lb,Wa,null,null,null)).returnValue;Array.add(Da,oc)}return Da}static Ldl(Da,Wa){Wa=Da.offset+Wa;const lb=[];for(;Da.offset<Wa;){const Lb=Da.$Z(),oc=Array(Lb);for(let Jc=0;Jc<Lb;++Jc){const bd=Da.$Z();oc[Jc]=bd}Array.add(lb,oc)}return lb}}Object(k.a)($e,"RawFlatLexicon",null,[1383]);var oj=d(710),Me=d(711);class we{constructor(Da){if(null==
Da)throw Error.argumentNull("base64String");const Wa=Da.length;if(Wa%4)throw Error.argument("base64String's length must be a multiple of 4");this.nA=.75*Wa;this.exa=Array(Math.ceil(this.nA/4));Da.endsWith("==")?this.nA-=2:Da.endsWith("=")&&--this.nA;let lb=0;for(let Lb=0;Lb<Wa;Lb+=4){const oc=we.Uwd[Da.charCodeAt(Lb)-43]<<18|we.Uwd[Da.charCodeAt(Lb+1)-43]<<12|we.Uwd[Da.charCodeAt(Lb+2)-43]<<6|we.Uwd[Da.charCodeAt(Lb+3)-43];let Jc=oc>>16&255;this.exa[Math.floor(lb/4)]|=Jc<<lb%4*8;++lb;Jc=oc>>8&255;
this.exa[Math.floor(lb/4)]|=Jc<<lb%4*8;++lb;Jc=oc&255;this.exa[Math.floor(lb/4)]|=Jc<<lb%4*8;++lb}}get length(){return this.nA}ga(Da){if(0>Da||Da>=this.nA)throw Error.argumentOutOfRange("i");return this.Dgg(Da)}tv(Da,Wa){if(0>Da||0>Wa||Da+Wa>this.nA)throw Error.argument("Bad range");let lb=0;for(let Lb=0;Lb<Wa;++Lb)lb|=this.Dgg(Da+Lb)<<8*Lb;return lb}Usl(Da,Wa){let lb=0,Lb=0,oc=Math.floor(Da/8);for(Da%=8;Lb<Wa;){const Jc=8-Da>Wa-Lb?Wa-Lb:8-Da,bd=this.ga(oc);lb|=(bd>>Da&~(255<<Jc))<<Lb;Lb+=Jc;++oc;
Da=0}return lb}Dgg(Da){return this.exa[Math.floor(Da/4)]>>Da%4*8&255}}we.Uwd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(k.a)(we,"ByteArray",null,[]);class Zc{constructor(Da,Wa,lb){this.vz=Da;this.QIk=Wa;this.tNk=lb;this.SUg=Array(Da.b?Da.b.length:0);this.ZOe=new oj.a(new Me.a(this.BVa(this.vz.s)));this.$Y=Array(Da.t.length);
this.K$h=new W.Annotations(this.yVa(0),this)}get annotations(){return this.K$h}get $dj(){return this.vz.d}RFj(){if(!(""in this.vz.m))throw Error.argument("name","Unrecognized module");return this.$ie(this.vz.m[""])}BVa(Da){if(0>Da||!this.vz.b||Da>=this.vz.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.SUg[Da]||(this.SUg[Da]=new we(this.vz.b[Da]))}MD(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not a string");
if(null==this.$Y[Da]){const Wa=this.yVa(Da).ga(0);this.$Y[Da]=this.ZOe.MD(Wa)}return this.$Y[Da]}ong(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.$Y[Da]){var Wa=this.yVa(Da);const lb=this.MD(Wa.ga(0));Wa=1===Wa.ga(1);this.$Y[Da]=new RegExp(lb,Wa?"i":"")}return this.$Y[Da]}LKj(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.vz.t[Da])throw Error.argument("blobID",
"Requested blob is not an SRE");throw Error.notImplemented();}$ie(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not an NL module");return this.$Y[Da]||(this.$Y[Da]=this.tNk.gGj(this.yVa(Da),this))}eF(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not an annotation query");return this.$Y[Da]||(this.$Y[Da]=
new ib(new Sd(this.yVa(Da),this)))}Ubb(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not an annotation script");return this.$Y[Da]||(this.$Y[Da]=new ad(new Te(this.yVa(Da),this)))}m$(Da){if(1>Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not a filter");return this.$Y[Da]||(this.$Y[Da]=this.QIk.m$(this.yVa(Da),this))}vJj(Da){if(1>
Da||Da>=this.vz.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.vz.t[Da])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.$Y[Da]||(this.$Y[Da]=new $e(this.yVa(Da),this))}yVa(Da){const Wa=this.vz.n[Da];Da=(Da<this.vz.t.length-1?this.vz.n[Da+1]:this.vz.n.length)-Wa;if(0>Wa||0>Da||Wa+Da>this.vz.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Wa+","+Da+")");const lb=new $a.a;lb.gZc(this.vz.n,Wa,Da);return lb}}Object(k.a)(Zc,
"ObjectFetcher",null,[1317]);class te{constructor(Da,Wa,lb){if(!Da)throw Error.argumentNull("prediction");if(!Wa)throw Error.argumentNull("fieldNames");if(!lb)throw Error.argumentNull("values");if(Wa.length!==lb.length)throw Error.argument("values","fieldNames and values do not have same length");this.pli=Da;this.Ugb=Wa;this.Hjb=lb}get prediction(){return this.pli}get Cbg(){return this.Ugb.length}the(Da){return 0<=Da&&Da<this.Ugb.length?this.Ugb[Da]:null}$a(Da){return 0<=Da&&Da<this.Hjb.length?this.Hjb[Da]:
null}}Object(k.a)(te,"PredictionData",null,[]);class ne{constructor(Da,Wa){if(!Da)throw Error.argumentNull("predictions");if(!Wa)throw Error.argumentNull("tokenAttributes");this.XPk=Da;this.QTk=Wa}Nje(){return this.XPk}Rfg(){return this.QTk}}Object(k.a)(ne,"PredictionDataWithTokenAttributes",null,[]);class Zf{constructor(Da,Wa){this.prediction=null;this.score=0;this.prediction=Da;this.score=Wa}}Object(k.a)(Zf,"PredictionWithScore",null,[]);class cd{constructor(Da,Wa){if(!Da)throw Error.argumentNull("predictions");
if(!Wa)throw Error.argumentNull("attributes");this.qli=Da;this.hai=Wa}Nje(){return this.qli}Rfg(){return this.hai}}Object(k.a)(cd,"PredictionsWithTokenAttributes",null,[]);class aj{constructor(Da,Wa,lb){if(!Da)throw Error.argumentNull("attributeName");if(!Wa)throw Error.argumentNull("fieldNames");if(!lb)throw Error.argumentNull("values");if(Wa.length!==lb.length)throw Error.argument("values","fieldNames and values do not have same length");this.gai=Da;this.Ugb=Wa;this.Hjb=lb}get attributeName(){return this.gai}get Cbg(){return this.Ugb.length}the(Da){return 0<=
Da&&Da<this.Ugb.length?this.Ugb[Da]:null}$a(Da){return 0<=Da&&Da<this.Hjb.length?this.Hjb[Da]:null}}Object(k.a)(aj,"TokenAttributes",null,[]);var Qc=d(7),Mc=d(1);class Ig{constructor(Da,Wa,lb,Lb,oc){this.MCc=0;this.Fjf=null;this.NCc=this.hVb=0;this.FGd=this.sqb=this.Wca=this.iVb=null;this.Gjf=0;this.K7a=this.Rz=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.xL=Da;this.w6h=this.B6h=Wa;this.v6h=this.y6h=lb;this.ICc=this.x6h=
Lb;this.JCc=this.z6h=oc}CGd(){this.NCc=0;return this.gVb}gVb(){if(!(this.NCc<this.ICc))return this.LCc;this.iVb=this.w6h.items[this.NCc+this.v6h];this.Wca=new N.a(this.xL.Ka.annotations);1!==this.ICc&&this.xL.Ka.qec||this.Wca.TEa(this.iVb);if(0<=this.xL.Ka.gnd){({value:this.sqb}=this.Wca.Sn(this.xL.Ka.gnd)).returnValue?this.sqb=this.sqb.kM():this.sqb=new rb.a(this.xL.Ka.annotations,W.Annotations.cO);this.FGd=this.JCc.items;this.Gjf=this.FGd.length;for(this.MCc=0;this.MCc<this.Gjf;++this.MCc)this.Fjf=
this.FGd[this.MCc],Array.add(this.sqb.items,this.Fjf);this.Wca.vv(this.xL.Ka.gnd,this.sqb)}else 0<=this.xL.Ka.Oaf?this.Wca.vv(this.xL.Ka.Oaf,this.JCc.items[0]):0<=this.xL.Ka.h2d?this.Wca.vv(this.xL.Ka.h2d,!0):this.xL.Ka.ZDg?this.JCc.items[0].PYc((Da,Wa)=>this.Wca.vv(Da,Wa)):(this.Wca.TEa(this.JCc.items[0]),1!==this.ICc&&this.xL.Ka.qec||(({value:this.hVb}=this.iVb.Sn(this.xL.Ka.qU)).returnValue&&this.Wca.vv(this.xL.Ka.qU,this.hVb),({value:this.hVb}=this.iVb.Sn(this.xL.Ka.xX)).returnValue&&this.Wca.vv(this.xL.Ka.xX,
this.hVb),this.iVb.Sn(this.xL.Ka.RSa).returnValue&&this.Wca.vv(this.xL.Ka.RSa,this.hVb)));this.Rz=this.Wca;this._state=2;return this.EGd}LCc(){this._state=3}DGd(){this.NCc++;return this.gVb}EGd(){return 1<this.ICc&&this.xL.Ka.qec?this.LCc:this.DGd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Ig(this.xL,this.B6h,this.y6h,this.x6h,this.z6h)).getEnumerator()}[Symbol.iterator](){return Object(Mc.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?
this._state=1:(this._state=1,this.K7a=this.CGd());for(;1===this._state;)this.K7a=this.K7a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Rz}}Object(k.a)(Ig,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[106,259,265]);class wg{constructor(Da,Wa,lb){this.rkc=this.jUg=0;this.FGb=null;this.jPe=this.wCe=this.sGb=this.Jbd=this.BDe=0;this.Mcd=!1;this.ALe=Da;
this.APe=Wa;this.pOk=lb}Llg(){null===this.FGb&&({RXh:this.FGb,kwg:this.BDe,length:this.Jbd,Nkj:Da}=this.ALe.fqg(this.APe.items[this.rkc],this.pOk),this.Mcd=Da||this.Mcd);if(this.sGb<this.Jbd){var Da=this.FGb.charAt(this.BDe+this.sGb);++this.sGb;return{returnValue:!0,ch:Da}}if(this.rkc===this.APe.items.length-1)return{returnValue:!1,ch:"\x00"};++this.rkc;this.sGb=0;this.FGb=null;return{returnValue:!0,ch:" "}}A2e(Da,Wa){this.sGb===this.Jbd&&this.FGb&&(this.jPe=Wa,this.wCe=this.rkc-this.jUg+1)}SFl(Da){if(0>
Da||Da>=this.APe.items.length)throw Error.argumentOutOfRange("iToken");this.rkc=this.jUg=Da;this.FGb=null;this.wCe=this.sGb=this.Jbd=this.BDe=0;this.jPe=-1;this.Mcd=!1}aFj(){return{gMi:this.wCe,Euk:this.jPe,zkj:this.Mcd}}}Object(k.a)(wg,"TriePrefixVisitor",null,[1386]);class fe{constructor(Da){this.Ka=Da}execute(Da){if(!({value:lb}=Da.Sn(this.Ka.Gta)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Wa;({value:Wa}=Da.Sn(this.Ka.nEa)).returnValue||(Wa=null);var lb=
this.Stj(lb,Wa);Da=W.Annotations.kM(Da);Da.vv(this.Ka.Gta,lb);return Da}Stj(Da,Wa){let lb=null;const Lb=this.Ka.flatLexicon.trie,oc=new wg(this,Da,Wa);let Jc=null;this.Ka.flatLexicon.sue()&&(Jc=Object(Qc.a)(this.Ka.flatLexicon,this.Ka.flatLexicon.Nvj,"getCaseInsensitiveForm"));let bd=0,rd;var Zd;let ea;for(;bd<Da.items.length;){const Ka=Da.items[bd];oc.SFl(bd);Lb.v5h(oc,Jc);({gMi:rd,Euk:Zd,zkj:ea}=oc.aFj());if(0<rd){({twk:Zd}=this.Ka.flatLexicon.muj(Zd));for(let bb of this.W4i(Da,bd,rd,Zd)){1<rd&&
this.Ka.qec&&this.D5i(Da,Wa,bd,Ka,rd,ea,bb);if(!lb)for(lb=new rb.a(this.Ka.annotations,W.Annotations.cO),Zd=0;Zd<bd;++Zd)Array.add(lb.items,Da.items[Zd]);Array.add(lb.items,bb)}bd+=rd}else lb&&Array.add(lb.items,Ka),++bd}return lb||Da}D5i(Da,Wa,lb,Lb,oc,Jc,bd){if(Jc)Jc=!0;else if(this.Ka.IDg){Jc=!1;var rd=-1;for(var Zd=0;Zd<oc;Zd++){var ea=Da.items[lb+Zd];let Yb;var Ka=void 0;if(!({value:Yb}=ea.Sn(this.Ka.qU)).returnValue||!({value:Ka}=ea.Sn(this.Ka.xX)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Zd){if(Yb>rd+1){Jc=!0;break}if(0>rd||null===Wa||rd>=Wa.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Wa.charAt(rd)){Jc=!0;break}}rd=Yb+Ka}}else Jc=!1;if(Jc){Ka=new Sys.StringBuilder;for(Jc=0;Jc<oc;++Jc)({RXh:rd,kwg:Zd,length:ea}=this.fqg(Da.items[lb+Jc],Wa)),0<Jc&&Ka.append(" "),Ka.append(rd.substr(Zd,ea));bd.vv(this.Ka.RSa,Ka.toString())}Da=Da.items[lb+oc-1];let bb,vb;({value:Lb}=Lb.Sn(this.Ka.qU)).returnValue&&
({value:bb}=Da.Sn(this.Ka.qU)).returnValue&&({value:vb}=Da.Sn(this.Ka.xX)).returnValue?(bd.vv(this.Ka.qU,Lb),bd.vv(this.Ka.xX,bb+vb-Lb)):(bd.$ud(this.Ka.qU),bd.$ud(this.Ka.xX))}W4i(Da,Wa,lb,Lb){return new Ig(this,Da,Wa,lb,Lb)}fqg(Da,Wa){let lb,Lb;if(({value:lb}=Da.Sn(this.Ka.RSa)).returnValue)Lb=!0,Wa=0,Da=lb.length;else{Lb=!1;if(null===Wa)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");lb=Wa;if(!({value:Wa}=Da.Sn(this.Ka.qU)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:Da}=Da.Sn(this.Ka.xX)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Wa||0>Da||Wa+Da>lb.length)throw Error.argument("Token start/length values out of range","token");}return{RXh:lb,kwg:Wa,length:Da,Nkj:Lb}}}Object(k.a)(fe,"FlatLexiconNLModule",null,[1357]);class Qe{constructor(Da,Wa){this.h2d=this.gnd=this.Oaf=this.RSa=this.xX=this.qU=this.nEa=this.Gta=0;this.ZDg=this.IDg=this.qec=!1;this.flatLexicon=null;this.annotations=Wa.annotations;
let lb=0;try{this.Gta=Da.ga(lb),++lb,this.nEa=Da.ga(lb),++lb,this.qU=Da.ga(lb),++lb,this.xX=Da.ga(lb),++lb,this.RSa=Da.ga(lb),++lb,this.Oaf=Da.ga(lb),++lb,this.gnd=Da.ga(lb),++lb,this.h2d=Da.ga(lb),++lb,this.qec=1===Da.ga(lb),++lb,this.IDg=1===Da.ga(lb),++lb,this.ZDg=1===Da.ga(lb),++lb,this.flatLexicon=Wa.vJj(Da.ga(lb))}catch(Lb){throw Error.argument("initData");}}}Object(k.a)(Qe,"FlatLexiconNLModuleInit",null,[]);class ig{constructor(){this.hdc=0;this.Ade=null;this.Uwc=0}}Object(k.a)(ig,"FeatureGenStackRec",
null,[]);class Ph{constructor(Da){this.Yef=Array(Da);this.HTb=Array(Da);this.bcf=[];this.YUh=[]}}Object(k.a)(Ph,"TokenStringLattice",null,[]);const $g=(Da,Wa,lb)=>{for(let Lb=0;Lb<Da.length;Lb++)lb=Wa(lb,Da[Lb]);return lb},Vg=(Da,Wa)=>{const lb=Array(Da.length);for(let Lb=0;Lb<Da.length;Lb++)lb[Lb]=Wa(Da[Lb]);return lb},Fg=(Da,Wa)=>{Wa=Array(Math.min(Wa,Da.length));for(let lb=0;lb<Wa.length;lb++)Wa[lb]=Da[lb];return Wa},bf=(Da,Wa)=>{const lb=[];for(const Lb of Da)Wa(Lb)&&Array.add(lb,Lb);return lb};
class Ag{constructor(Da,Wa){this.key=Da;this.value=Wa}}Object(k.a)(Ag,"KeyValuePair",null,[]);const ff=(Da,Wa)=>({returnValue:Wa in Da,value:Da[Wa]}),Fe=Da=>{const Wa=[];for(let lb in Da){const Lb=new Ag(lb,Da[lb]);Array.add(Wa,Lb)}return Wa};class Pf{constructor(Da){this.eqg=this.fQj;this.Ka=Da;this.Dgd=this.pLe=this.qLe=0;for(const Wa of this.Ka.SXc)this.qLe=Math.max(this.qLe,Wa.UYe),this.pLe=Math.max(this.pLe,Wa.nYe),this.Dgd=Math.max(this.Dgd,Wa.qSb.length)}get enj(){return this.Ka.wDd.trie}execute(Da){if(!Da)throw Error.argumentNull("input");
let Wa,lb;({tokens:Wa,hvk:lb}=this.gQj(Da));let Lb=null,oc=null,Jc={};if(this.Ka.Lec){Wa=W.Annotations.kM(Wa);for(var bd=0;bd<Wa.items.length;++bd)Wa.items[bd]=W.Annotations.kM(Wa.items[bd])}else({ubg:oc,returnValue:Lb}=this.kmg(Da,Jc));bd=Array(this.Dgd);const rd=Array(this.Dgd);for(var Zd=0;Zd<rd.length;++Zd)rd[Zd]=new ig;for(Zd=-this.qLe;Zd<Wa.items.length+this.pLe;++Zd){let ea=null;this.Ka.Lec&&(ea=Wa.items[Zd],Jc={},{ubg:oc,returnValue:Lb}=this.kmg(ea,Jc));for(const Ka of this.Ka.SXc){if(0>Zd&&
-Zd>Ka.UYe||Zd>=Wa.items.length&&Zd-Wa.items.length+1>Ka.nYe)continue;let bb=!0;for(let vb=0;vb<Ka.qSb.length;++vb){const Yb=Zd+Ka.qSb[vb];bd[vb]=Yb;if(0>Yb?0>this.Ka.VYe:Yb>=Wa.items.length?0>this.Ka.oYe:!lb.HTb[Yb]){bb=!1;break}}bb&&({I8i:Lb,J8i:oc}=this.dck(Ka,lb,Lb,oc,Jc,rd,bd))}this.Ka.Lec&&(ea.vv(this.Ka.CHa?this.Ka.nwb:this.Ka.lwb,Lb),this.Ka.CHa&&ea.vv(this.Ka.mwb,oc))}Da=W.Annotations.kM(Da);this.Ka.Lec?Da.vv(this.Ka.Gta,Wa):(Da.vv(this.Ka.CHa?this.Ka.nwb:this.Ka.lwb,Lb),this.Ka.CHa&&Da.vv(this.Ka.mwb,
oc));return Da}gQj(Da){let Wa,lb;if(!Da||!({value:Wa}=Da.Sn(this.Ka.Gta)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Lb;({value:Lb}=Da.Sn(this.Ka.nEa)).returnValue||(Lb="");lb=new Ph(Wa.items.length);const oc=bf(this.Ka.bff,Jc=>!Jc.Edc||Jc.Edc.isMatch(Da,null));for(let Jc=0;Jc<Wa.items.length;++Jc){const bd=Wa.items[Jc];let rd=null;lb.Yef[Jc]=lb.bcf.length;let Zd=lb.HTb[Jc]=0;for(const ea of oc)0<ea.zpc&&lb.HTb[Jc]+Zd>=ea.zpc||ea.YAc&&!ea.YAc.isMatch(bd,
null)||({ZAc:rd,A4b:Zd}=ea.apply(this,bd,Jc,lb,Lb,rd,Zd))}return{tokens:Wa,hvk:lb}}dck(Da,Wa,lb,Lb,oc,Jc,bd){let rd=0;Jc[0].hdc=-1;for(Jc[0].Ade=Da.FHh;;){var Zd=bd[rd],ea=0>Zd||Zd>=Wa.HTb.length?1:Wa.HTb[Zd];let vb=!1;for(;Jc[rd].hdc<ea-1;){++Jc[rd].hdc;var Ka=void 0,bb=void 0;0>Zd?(Ka=this.Ka.VYe,bb=1):Zd>=Wa.Yef.length?(Ka=this.Ka.oYe,bb=1):(bb=Wa.Yef[Zd]+Jc[rd].hdc,Ka=Wa.bcf[bb],bb=Wa.YUh[bb]);Jc[rd].Uwc=bb*(rd?Jc[rd-1].Uwc:Da.score);if(({value:Ka}=ff(Jc[rd].Ade,Ka.toString())).returnValue){rd===
Da.qSb.length-1?(Zd=Ka,Jc[rd].Uwc&&(({value:ea}=ff(oc,Zd.toString())).returnValue||(ea=-1),0>ea&&(lb=W.Annotations.kM(lb),Array.add(lb.items,Zd)),this.Ka.CHa&&(Lb=W.Annotations.kM(Lb),0>ea?Array.add(Lb.items,Jc[rd].Uwc):Lb.items[ea]+=Jc[rd].Uwc),0>ea&&(this.Ka.NGg||this.Ka.CHa)&&(oc[Zd.toString()]=lb.items.length-1))):(++rd,Jc[rd].hdc=-1,Jc[rd].Ade=Ka);vb=!0;break}}if(!vb&&(--rd,0>rd))break}return{I8i:lb,J8i:Lb}}kmg(Da,Wa){let lb;if(({value:lb}=Da.Sn(this.Ka.CHa?this.Ka.nwb:this.Ka.lwb)).returnValue)for(let Lb=
0;Lb<lb.items.length;++Lb)Wa[lb.items[Lb].toString()]=Lb;else lb=new rb.a(this.Ka.annotations,W.Annotations.yra);if(this.Ka.CHa){if(({value:Wa}=Da.Sn(this.Ka.mwb)).returnValue||(Wa=new rb.a(this.Ka.annotations,W.Annotations.Hca)),Wa.items.length!==lb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ka.annotations.K3(W.Annotations.cO,Da));}else Wa=null;return{returnValue:lb,ubg:Wa}}get Lam(){return this.Ka.wDd}fQj(Da,
Wa){var lb;if(({value:lb}=Wa.Sn(this.Ka.RSa)).returnValue)Da=lb;else{if(!({value:lb}=Wa.Sn(this.Ka.qU)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Wa}=Wa.Sn(this.Ka.xX)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>lb||0>Wa||lb+Wa>Da.length)throw Error.argument("Token indices are out of range");Da=Da.substr(lb,Wa)}return Da}}Object(k.a)(Pf,"NGramNLModule",null,[1357,1379]);class Md{constructor(Da){this.qSb=null;this.score=this.nYe=this.UYe=
0;this.FHh=null;if(Da){var Wa=0;try{if(Da.ga(Wa)!==Md.l$a)throw Error.argument("initData","Input does not represent a feature template");++Wa;const lb=Da.ga(Wa);++Wa;this.qSb=Array(lb);for(let Lb=0;Lb<lb;++Lb)this.qSb[Lb]=Da.ga(Wa),++Wa;this.UYe=Da.ga(Wa);++Wa;this.nYe=Da.ga(Wa);++Wa;this.score=Da.ga(Wa);++Wa;this.FHh=({hwg:Wa}=Md.vAh(Da,Wa)).returnValue}catch(lb){throw Error.argument("initData");}}}static vAh(Da,Wa){const lb=Da.ga(Wa);++Wa;const Lb={};for(let oc=0;oc<lb;++oc){const Jc=Da.ga(Wa);
++Wa;Da.ga(Wa)?Lb[Jc.toString()]=({hwg:Wa}=Md.vAh(Da,Wa)).returnValue:(++Wa,Lb[Jc.toString()]=Da.ga(Wa),++Wa)}return{returnValue:Lb,hwg:Wa}}}Md.l$a=240803228;Object(k.a)(Md,"FeatureTemplate",null,[1388]);var vg=d(557);class Ye{constructor(Da,Wa){this.CHa=this.NGg=this.Lec=!1;this.RSa=this.xX=this.qU=this.Gta=this.nEa=this.mwb=this.nwb=this.lwb=0;this.wDd=null;this.oYe=this.VYe=0;this.SXc=this.bff=null;if(Da){this.annotations=Wa.annotations;var lb=0;try{this.Lec=1===Da.ga(lb);++lb;this.NGg=1===Da.ga(lb);
++lb;this.CHa=1===Da.ga(lb);++lb;this.lwb=Da.ga(lb);++lb;this.nwb=Da.ga(lb);++lb;this.mwb=Da.ga(lb);++lb;this.nEa=Da.ga(lb);++lb;this.Gta=Da.ga(lb);++lb;this.qU=Da.ga(lb);++lb;this.xX=Da.ga(lb);++lb;this.RSa=Da.ga(lb);++lb;this.wDd=this.iel(Wa.BVa(Da.ga(lb)));++lb;this.VYe=Da.ga(lb);++lb;this.oYe=Da.ga(lb);++lb;const Lb=Da.ga(lb);++lb;this.bff=Array(Lb);for(let Jc=0;Jc<Lb;++Jc){const bd=Da.ga(lb);++lb;const rd=this.wDd.trie,Zd=new $a.a;Zd.sVa(Da,lb,bd);this.bff[Jc]=this.nel(Zd,Wa,rd);lb+=bd}const oc=
Da.ga(lb);++lb;this.SXc=Array(oc);for(Wa=0;Wa<oc;++Wa){const Jc=Da.ga(lb);++lb;const bd=new $a.a;bd.sVa(Da,lb,Jc);this.SXc[Wa]=this.Mdl(bd);lb+=Jc}}catch(Lb){throw Error.argument("initData");}}}iel(Da){return new oj.a(new Me.a(Da))}nel(Da,Wa,lb){return vg.a.create(Da,Wa,lb)}Mdl(Da){return new Md(Da)}}Object(k.a)(Ye,"NGramNLModuleInit",null,[]);class Cf{constructor(Da){this.Ka=Da}execute(Da){if(!Da)throw Error.argumentNull("input");Da=Da.clone();this.Ka.script.execute(Da,null);return Da}}Object(k.a)(Cf,
"ScriptNLModule",null,[1357]);class Bg{constructor(Da,Wa){Da&&(this.script=Wa.Ubb(Da.ga(0)))}}Object(k.a)(Bg,"ScriptNLModuleInit",null,[]);const Ae=Da=>{Da=Vg(Da,Wa=>Wa*Wa);return Math.sqrt($g(Da,(Wa,lb)=>Wa+lb,0))},Uf=Da=>$g(Da,(Wa,lb)=>Wa>lb?Wa:lb,Da[0]);class Jd{constructor(Da){this.Ka=Da}execute(Da){if(!Da)throw Error.argumentNull("input");var Wa=[],lb=[];this.XVi(Da,Wa,lb);this.IBi(Wa,lb);const Lb={};for(let Jc=0;Jc<Wa.length;++Jc){var oc=Wa[Jc];const bd=this.Ka.Myg.ga(oc);oc=this.Ka.Nyg.ga(oc);
for(let rd=0;rd<oc;++rd){const Zd=this.Ka.kTi.ga(this.Ka.HWf.ga(bd+rd)),ea=this.Ka.IWf.ga(bd+rd);let Ka;({value:Ka}=ff(Lb,Zd)).returnValue||(Ka=0);Lb[Zd]=Ka+lb[Jc]*ea}}lb=Fe(Lb);lb.sort((Jc,bd)=>{var rd=Jc.value,Zd=bd.value;(rd=-(rd>Zd?1:rd<Zd?-1:0))||(rd=Jc.key.localeCompare(bd.key));return rd});Wa=new rb.a(this.Ka.annotations,W.Annotations.cO);for(const Jc of Fg(lb,this.Ka.HWk))lb=new N.a(this.Ka.annotations),lb.vv(this.Ka.KGi,Jc.key),lb.vv(this.Ka.MGi,Jc.value),Array.add(Wa.items,lb);Da.vv(this.Ka.LGi,
Wa);return Da}XVi(Da,Wa,lb){if(({value:Da}=Da.Sn(this.Ka.JGi)).returnValue){let Lb;if(({value:Lb}=Da.Sn(this.Ka.nwb)).returnValue){let oc;if(!({value:oc}=Da.Sn(this.Ka.mwb)).returnValue||Lb.items.length!==oc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.kSc(Lb,oc,Wa,lb)}if(({value:Lb}=Da.Sn(this.Ka.OGi)).returnValue){let oc;if(!({value:oc}=Da.Sn(this.Ka.PGi)).returnValue||Lb.items.length!==oc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.kSc(Lb,oc,Wa,lb)}({value:Lb}=Da.Sn(this.Ka.lwb)).returnValue&&this.kSc(Lb,null,Wa,lb);({value:Lb}=Da.Sn(this.Ka.NGi)).returnValue&&this.kSc(Lb,null,Wa,lb)}}kSc(Da,Wa,lb,Lb){for(let Jc=0;Jc<Da.items.length;++Jc){var oc=void 0;Da.YV===W.Annotations.C_?({value:oc}=ff(this.Ka.z7f,Da.items[Jc])).returnValue||(oc=-1):(oc=Da.items[Jc],oc=oc>=this.Ka.nRe&&oc<=this.Ka.$Wk?this.Ka.BSe?this.Ka.BSe.ga(oc-this.Ka.nRe)-1:oc-this.Ka.nRe:-1);if(0<=oc){let bd;bd=Wa?Wa.items[Jc]:1;0<bd&&(Array.add(lb,oc),Array.add(Lb,
bd))}}}IBi(Da,Wa){if(Da.length){switch(this.Ka.Anl){case 0:break;case 1:for(var lb=0;lb<Wa.length;++lb)Wa[lb]=1+Math.log(Wa[lb]);break;case 2:lb=Uf(Wa);for(let Lb=0;Lb<Wa.length;++Lb)Wa[Lb]=.5+Wa[Lb]/lb*.5;break;case 3:for(lb=0;lb<Wa.length;++lb)Wa[lb]=1;break;default:throw Error.notImplemented();}if(this.Ka.J5c)for(lb=0;lb<Wa.length;++lb)Wa[lb]*=this.Ka.J5c.ga(Da[lb]);Da=Ae(Wa);for(lb=0;lb<Wa.length;++lb)Wa[lb]/=Da}}}Object(k.a)(Jd,"TfIdfRankerNLModule",null,[1357]);class We{constructor(Da,Wa=0){if(!Da)throw Error.argumentNull("byteArray");
this.EI=Wa;if(604662927!==Da.tv(this.EI+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Un=Da.tv(this.EI+4,4);this.XMg=Da.tv(this.EI+8,4);this.BGk=Da}ga(Da){if(0>Da||Da>=this.count)throw Error.argumentOutOfRange("index");return this.BGk.Usl(8*this.EI+96+Da*this.XMg,this.XMg)}get count(){return this.Un}}Object(k.a)(We,"CompactIntArray",null,[1356]);const fd=(Da,Wa)=>{Wa=Array(Wa);for(let Jc=0;Jc<Wa.length;Jc++){var lb=Jc,Lb=Da.$Z(),oc=1===(Lb>>31&1)?-1:1;
const bd=Lb&8388607;Lb=Lb>>23&255;256===Lb+1?oc=bd?Number.NaN:1===oc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Lb?(Lb-=127,oc=oc*ui(bd,1)*Math.pow(2,Lb)):oc=oc*ui(bd,0)*Math.pow(2,-126);Wa[lb]=oc}return Wa},ui=(Da,Wa)=>{let lb=0;for(let Lb=0;23>Lb;Lb++)lb+=(Da>>22-Lb&1)/Math.pow(2,Lb+1);return Wa+lb};class bj{constructor(Da,Wa){this.BSe=null;this.Wjh=0;this.Nyg=this.Myg=this.J5c=null;this.Vjh=0;this.IWf=this.HWf=null;this.annotations=Wa.annotations;let lb=0;this.NGi=Da.ga(lb);++lb;this.lwb=
Da.ga(lb);++lb;this.OGi=Da.ga(lb);++lb;this.PGi=Da.ga(lb);++lb;this.nwb=Da.ga(lb);++lb;this.mwb=Da.ga(lb);++lb;this.JGi=Da.ga(lb);++lb;this.LGi=Da.ga(lb);++lb;this.KGi=Da.ga(lb);++lb;this.MGi=Da.ga(lb);++lb;var Lb=Da.ga(lb);++lb;var oc=Array(Lb);for(var Jc=0;Jc<Lb;++Jc)oc[Jc]=Wa.MD(Da.ga(lb)),++lb;this.kTi=$a.a.j8d(oc);this.HWk=Da.ga(lb);++lb;this.Anl=Da.ga(lb);++lb;Lb=Da.ga(lb);++lb;this.z7f={};for(oc=0;oc<Lb;++oc){Jc=Wa.MD(Da.ga(lb));++lb;const bd=Da.ga(lb);++lb;this.z7f[Jc]=bd}this.nRe=Da.ga(lb);
++lb;this.$Wk=Da.ga(lb);++lb;Lb=Da.ga(lb);++lb;0<Lb&&(Lb=Wa.BVa(Da.ga(lb)),++lb,this.BSe=this.Yqd(new mg(Lb)));++lb;Da=Wa.BVa(Da.ga(lb));this.Xdl(Da)}Yqd(Da){return new We(Da.Q3b,Da.offset)}Xdl(Da){try{const Wa=new mg(Da);this.Wjh=Wa.$Z();1===Wa.$Z()?this.J5c=$a.a.j8d(fd(Wa,this.Wjh)):this.J5c=null;const lb=Wa.$Z();this.Myg=this.Yqd(Wa);Wa.offset+=lb;const Lb=Wa.$Z();this.Nyg=this.Yqd(Wa);Wa.offset+=Lb;this.Vjh=Wa.$Z();const oc=Wa.$Z();this.HWf=this.Yqd(Wa);Wa.offset+=oc;this.IWf=$a.a.j8d(fd(Wa,this.Vjh))}catch(Wa){throw Error.argument("byteReader");
}}}Object(k.a)(bj,"TfIdfRankerNLModuleInit",null,[]);class nf{constructor(Da,Wa,lb,Lb){this.UWe=Da;this.Rcg=lb;this.tokens=Lb;this.P9=Wa;this.GQb=-1;this.byd=0}}Object(k.a)(nf,"TokenizerData",null,[]);class ki{constructor(Da){this.Ka=Da}execute(Da){if(!Da)throw Error.argumentNull("input");if(!({value:Lb}=Da.Sn(this.Ka.nEa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Wa;({value:Wa}=Da.Sn(this.Ka.qU)).returnValue||(Wa=0);let lb;({value:lb}=
Da.Sn(this.Ka.xX)).returnValue||(lb=Lb.length-Wa);if(0>Wa||Wa>Lb.length)throw Error.argument("input","Start index out of range");if(0>lb||lb>Lb.length)throw Error.argument("input","Length out of range");if(Wa+lb>Lb.length)throw Error.argument("input","Bad start-length range");var Lb=new nf(Lb,Wa,Wa+lb,new rb.a(this.Ka.annotations,W.Annotations.cO));this.Mam(Lb);Da=Da.isReadOnly?Da.clone():Da;Da.vv(this.Ka.Gta,Lb.tokens);return Da}Mam(Da){for(;Da.P9<Da.Rcg;){if(this.Ka.wme){var Wa=this.Ka.wme.kLg(Da.UWe,
Da.P9,Da.Rcg-Da.P9,null);!Wa.succeeded&&Wa.fjh&&(Wa=Wa.fjh);if(Wa.succeeded){this.doh(Da,Wa.length,this.Ka.Mrg);Da.P9+=Wa.length;continue}}Wa=Da.UWe.substr(Da.P9);let lb=-1,Lb=-1,oc=-1;for(let Jc=0;Jc<this.Ka.Mwd.length;++Jc){const bd=this.Ka.Mwd[Jc].exec(Wa);bd&&0<bd[1].length&&(0>lb||bd[0].length>Lb)&&(lb=Jc,Lb=bd[0].length,oc=bd[1].length)}0<=lb?(this.doh(Da,oc,this.Ka.F5e[lb]),Da.P9+=oc):Da.P9+=1}}doh(Da,Wa,lb){if(this.Ka.tFg)lb!==ki.bOi&&(0>Da.GQb&&(Da.GQb=Da.P9),Da.byd=Da.P9+Wa-Da.GQb,lb===
ki.aOi&&(0<=Da.GQb&&0<Da.byd&&(Wa=new N.a(this.Ka.annotations),Wa.vv(this.Ka.qU,Da.GQb),Wa.vv(this.Ka.xX,Da.byd),Wa.vv(this.Ka.s1d,ki.cOi),Wa.vv(this.Ka.nEa,Da.UWe),Array.add(Da.tokens.items,Wa)),Da.GQb=-1,Da.byd=0));else{let Lb=new N.a(this.Ka.annotations);Lb.vv(this.Ka.qU,Da.P9);Lb.vv(this.Ka.xX,Wa);Lb.vv(this.Ka.s1d,lb);Array.add(Da.tokens.items,Lb)}}}ki.bOi="GAP";ki.aOi="EOS_CHUNK";ki.cOi="SENTENCE";Object(k.a)(ki,"TokenizerNLModule",null,[1357]);class qf{constructor(Da,Wa){this.xX=this.qU=this.s1d=
this.Gta=this.nEa=0;this.tFg=!1;this.F5e=this.Mwd=this.Mrg=this.wme=null;if(Da){this.annotations=Wa.annotations;var lb=0;try{this.nEa=Da.ga(lb);++lb;this.Gta=Da.ga(lb);++lb;this.s1d=Da.ga(lb);++lb;this.qU=Da.ga(lb);++lb;this.xX=Da.ga(lb);++lb;this.tFg=1===Da.ga(lb);++lb;var Lb=Da.ga(lb);++lb;0<Lb&&(this.wme=Wa.$ie(Lb).enj);this.Mrg=Da.ga(lb)?Wa.MD(Da.ga(lb)):"";++lb;const oc=Da.ga(lb);++lb;this.Mwd=Array(oc);this.F5e=Array(oc);for(Lb=0;Lb<oc;++Lb)this.Mwd[Lb]=new RegExp(Wa.MD(Da.ga(lb))),++lb,this.F5e[Lb]=
Wa.MD(Da.ga(lb)),++lb}catch(oc){throw Error.argument("initData");}}}}Object(k.a)(qf,"TokenizerNLModuleInit",null,[]);class be{constructor(Da){this.Ka=Da}execute(Da){if(!Da)throw Error.argumentNull("input");let Wa;if(!({value:Wa}=Da.Sn(this.Ka.hQf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const lb of this.Ka.Abf)Wa=lb.apply(Wa);Da=W.Annotations.kM(Da);Da.vv(this.Ka.iQf,Wa);return Da}static P0d(Da,Wa){const lb=new Sys.StringBuilder;for(let Lb=
0;Lb<Da.length;++Lb)lb.append(Wa(Da.substr(Lb,1)));return lb.toString()}}Object(k.a)(be,"TransliteratorNLModule",null,[1357]);class Ud{constructor(Da){Da&&(this.style=Da.ga(0))}apply(Da){return be.P0d(Da,Wa=>Ud.$Qi(Wa,this.style))}static $Qi(Da,Wa){switch(Wa){case 0:return Da.toLowerCase();case 1:return"I"===Da?"\u0131":Da.toLowerCase();case 2:return Da.toUpperCase();case 3:return"i"===Da?"\u0130":Da.toUpperCase();default:throw Error.invalidOperation();}}}Ud.n$a=0;Object(k.a)(Ud,"ChangeCaseTransliterationStage",
null,[1376]);class Ei{apply(Da){return be.P0d(Da,Ei.Ebm)}static Ebm(Da){const Wa=Da.charCodeAt(0);return 65281<=Wa&&65374>=Wa?String.fromCharCode(Wa-65248):Da}}Ei.n$a=4;Object(k.a)(Ei,"LatinFullWidthToHalfWidthTransliterationStage",null,[1376]);class ei{constructor(Da,Wa){Da&&(this.regex=Wa.ong(Da.ga(0)),this.cEl=Wa.MD(Da.ga(1)))}apply(Da){return Da.replace(this.regex,this.cEl)}}ei.n$a=1;Object(k.a)(ei,"RegexReplaceTransliterationStage",null,[1376]);class Aj{constructor(Da,Wa){if(Da){var lb=Da.ga(0),
Lb=Wa.MD(Da.ga(1)),oc=new We(Wa.BVa(Da.ga(2)));Da=0>Da.ga(3)?null:new We(Wa.BVa(Da.ga(3)));this.ycf={};for(Wa=0;Wa<lb;++Wa)this.ycf[Lb.charAt(Wa).toString()]=Lb.substr(oc.ga(Wa),Da?Da.ga(Wa):1)}}apply(Da){return be.P0d(Da,Wa=>Wa in this.ycf?this.ycf[Wa]:Wa)}}Aj.n$a=2;Object(k.a)(Aj,"SingleCharSubstitutionsTransliterationStage",null,[1376]);class tj{constructor(Da,Wa){this.iQf=this.hQf=0;this.Abf=null;if(Da){this.annotations=Wa.annotations;var lb=0;try{this.hQf=Da.ga(lb);++lb;this.iQf=Da.ga(lb);++lb;
const Lb=Da.ga(lb);++lb;this.Abf=Array(Lb);for(let oc=0;oc<Lb;++oc){const Jc=Da.ga(lb);++lb;const bd=Da.ga(lb);++lb;const rd=new $a.a;rd.sVa(Da,lb,bd);lb+=bd;this.Abf[oc]=this.hel(Jc,rd,Wa)}}catch(Lb){throw Error.argument("initData");}}}hel(Da,Wa,lb){switch(Da){case Ud.n$a:return new Ud(Wa);case ei.n$a:return new ei(Wa,lb);case Aj.n$a:return new Aj(Wa,lb);case Ei.n$a:return new Ei;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(k.a)(tj,"TransliteratorNLModuleInit",
null,[]);class Pi{gGj(Da,Wa){const lb=Da.ga(0),Lb=new $a.a;Lb.sVa(Da,1,Da.count-1);switch(lb){case 0:return new Cf(new Bg(Lb,Wa));case 2:return new ki(new qf(Lb,Wa));case 3:return new Pf(new Ye(Lb,Wa));case 5:return new fe(new Qe(Lb,Wa));case 9:return new be(new tj(Lb,Wa));case 10:return new Jd(new bj(Lb,Wa));default:throw Error.notImplemented();}}}Object(k.a)(Pi,"NLModuleFactory",null,[1319]);class Eh{constructor(Da){this.VNi=";";if(!Da)throw Error.argumentNull("resource");this.E6=new Zc(Da,new zc,
new Pi);this.ALe=this.E6.RFj();this.IMg=this.E6.annotations.K$b("Text.Text");this.GMg=this.E6.annotations.K$b("Classification.Predictions");this.$Be=this.E6.annotations.K$b("Classification.PredictionString");this.HMg=this.E6.annotations.K$b("Classification.Probability");this.kGk=this.E6.annotations.K$b("NLMod.Tokens");if(0>this.IMg||0>this.GMg||0>this.$Be||0>this.HMg)throw Error.argument("resourceObj","Resource does not represent a ranker");}avj(){const Da=[];this.kce(void 0,this.tgg(Da),null);return Da}cvj(Da,
Wa){const lb=[],Lb=[];this.kce(Da,this.tgg(lb),(oc,Jc)=>{const bd=this.E6.annotations.ggg(oc),rd=[],Zd=[];Wa&&Wa.length&&-1===Array.indexOf(Wa,bd)||(oc=this.E6.annotations.getAttributeType(oc),this.bvh(oc,Jc,rd,Zd),Jc=new aj(bd,rd,Zd),Array.add(Lb,Jc))});return new cd(lb,Lb)}bvj(Da){const Wa=[];this.kce(Da,lb=>{let Lb;if(({value:Lb}=lb.Sn(this.$Be)).returnValue){let oc;({value:oc}=lb.Sn(this.HMg)).returnValue&&Array.add(Wa,new Zf(Lb,oc))}},null);return Wa}kce(Da,Wa,lb){var Lb=new N.a(this.E6.annotations);
Lb.vv(this.IMg,Da);Da=this.ALe.execute(Lb);if(({value:Lb}=Da.Sn(this.GMg)).returnValue)for(const oc of Lb.items)Wa(oc);if(lb&&({value:Wa}=Da.Sn(this.kGk)).returnValue)for(const oc of Wa.items)oc.PYc(lb)}bvh(Da,Wa,lb,Lb){if(W.Annotations.kD(Da))for(var oc of Wa.items)this.bvh(Wa.YV,oc,lb,Lb);else if(W.Annotations.v0h(Da)){oc=this.E6.annotations.Xlg(Da);for(let Jc=0;Jc<oc;Jc++)Array.add(lb,this.E6.annotations.kpg(Da,Jc)),Array.add(Lb,this.E6.annotations.K3(this.E6.annotations.Rcb(Da,Jc),Wa.OVa(Jc)))}else Array.add(lb,
"VALUE"),Array.add(Lb,this.E6.annotations.K3(Da,Wa))}tgg(Da){return Wa=>{let lb;({value:lb}=Wa.Sn(this.$Be)).returnValue&&Array.add(Da,this.GIj(lb))}}GIj(Da){const Wa=Da.indexOf(this.VNi);return 0>Wa?Da:Da.substring(0,Wa)}}Object(k.a)(Eh,"Ranker",null,[]);var Th=d(343),Qi=d(392),fi=d(25);class Ng{constructor(Da,Wa){this.qyf="";this.yTd=null;this.zTd=!1;this.Yca=null;this.jai=["TellMe.TellMeParamCollection"];this.vb=Da;this.PCa=Wa;this.vb.O9a&&(this.Yca=null)}get std(){if(!this.yTd&&!this.zTd){let Da=
null;try{Da=window.TellMeModel}catch(Wa){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("QueryRanker","TellMeModel not found. Exception: "+Wa)}if(Da){try{this.yTd=new Eh(Da)}catch(Wa){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Wa)}this.zTd=!0}else if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("QueryRanker","Classifier model not found")}return this.yTd}hF(){return"Command"}CM(){return 0===
this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa,lb=!1,Lb=e.a.hq,oc=null){const Jc=new y.a(Da);if((!oc||Array.contains(oc,0))&&!C.a.SG(Da)){if(!this.std&&this.zTd){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.vb.O9a&&this.Yca&&this.Yca.initialize();if(Th.CommandResultsUtility.Aue(Da.Mf)&&(oc=Th.CommandResultsUtility.whg(Da.Mf),0<oc.results.length)){oc.displayName=
"Classifier Debug";Jc.jr(oc);Wa.oo(Jc);return}oc=Da?this.qyf=Da.Mf:this.qyf;if(fi.AFrameworkApplication.fa.getBooleanAppSetting("TellMeParameterizedQueriesEnabled")){oc=this.IIj(oc);var bd=this.f_c(oc.Nje());oc=oc.Rfg()}else oc=this.HIj(oc),bd=this.Zwj(oc),oc=[];Th.CommandResultsUtility.J$c(bd,!1,"Classifier","TFIDF");bd=Th.CommandResultsUtility.Xac(Da,bd,this.vb,this.Yca,this.PCa,oc,0,1);0<bd.results.length&&Lb!==e.a.contextMenu&&(bd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);lb||
bd.results.length||this.vb.oHa||this.vb.LAa||(Da=new w.a("lookupNoResults",14,Da.Mf,null,1),bd.qt(Da));0<bd.results.length&&Jc.jr(bd);Jc.attributes=oc}Wa.oo(Jc)}Nje(){let Da=[];try{Da=this.std.avj()}catch(Wa){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("GetPredictions","Exception: "+Wa)}return Da}HIj(Da){let Wa=[];try{Wa=this.std.bvj(Da)}catch(lb){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("GetPredictionsWithScore","Exception: "+lb)}return Wa}IIj(Da){try{return this.std.cvj(Da,
this.jai)}catch(Wa){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("GetPredictionsWithTokenAttributes","Exception: "+Wa)}return new cd([],[])}f_c(Da){const Wa=[];if(Da)for(const lb of Da)Wa.push(new Qi.a(lb,-99999));return Wa}Zwj(Da){const Wa=[];if(Da)for(const lb of Da)Wa.push(new Qi.a(lb.prediction,lb.score));return Wa}}Object(k.a)(Ng,"CommandResultsProvider",null,[1132]);var $d=d(1021);class Qf{constructor(Da){this.vb=Da}hF(){return"Feedback"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?
1:2}AC(Da,Wa,lb,Lb,oc=null){Da=new y.a(Da);if(!oc||Array.contains(oc,21))oc=[],oc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(oc),oc=new D.a(22),oc.displayName="",oc.qt(new w.a("TellMeFeedback",23,null,null,1)),Da.jr(oc);Wa.oo(Da)}}Object(k.a)(Qf,"FeedbackResultsProvider",null,[1132]);class Cg{constructor(Da,Wa,lb,Lb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Da;this.CommandId=Wa;this.CommandValueId=
lb;this.InputText=Lb}}Object(k.a)(Cg,"FindInDocumentProp",null,[]);var rh=d(46);class ge{constructor(Da){this.GQd=2;this.H7a=[];this.fRa=[];this.vb=Da;ge.ema=Da.fcg;ge.kcg="FindInDocumentSuggestion";ge.muh="FindInDocumentSuggestion3";this.fii=Object.assign(new E.a,{landingTab:"Indoc",data:null});this.Qni=this.vb.SRb||!!fi.AFrameworkApplication.za&&fi.AFrameworkApplication.za.mb.SRb}hF(){return"FindInDocument"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:3===this.vb.pr?this.vb.KSh?2:3:2}AC(Da,Wa,
lb=!1,Lb,oc=null){const Jc=new y.a(Da);if(oc&&!Array.contains(oc,2))Wa.oo(Jc);else if(Array.clear(this.H7a),C.a.SG(Da)){if(lb&&this.AQh()){lb=new D.a(2);lb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;oc=1;Lb="";if(0<this.fRa.length&&!this.vb.TRb)for(var bd of this.fRa)if(""!==bd.Label.toLowerCase()){if(oc>=this.GQd)break;this.r3h(lb,bd.Label,bd.CommandValueId,ge.kcg+oc,bd.InputText);oc++}bd="";this.vb.gJ?(Jc.jr(lb),lb=new D.a(3),bd=this.vb.OSa?C.a.zVa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):bd=CommonUIStrings.l_TellMeOpenFindPaneText;Lb=this.vhg("");this.r3h(lb,bd,Lb,ge.muh,"");Jc.jr(lb)}Wa.oo(Jc)}else bd="",lb&&(lb=this.vhg(Da.Mf),Lb=[],this.vb.nYa?(this.vb.x$e&&Lb.push(appChrome.actions.setControlIconSet(ge.ema,{"default":"FindInDocument_20"})),bd=this.vb.Zxe?C.a.Ohe(Da.Mf,CommonUIStrings.l_FindInDocumentScopedButtonText):Da.Mf+CommonUIStrings.l_FindInDocumentScopedButtonText):this.vb.gJ?(bd=this.vb.OSa?C.a.zVa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
Da.Mf)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Da.Mf),Lb.push(appChrome.actions.setControlIconSet(ge.ema,{"default":"FindInDocument_20"}))):bd=this.vb.TRb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Da.Mf),this.vb.wfa?(m.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ge.ema,bd)),m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ge.ema,lb))):(Lb.push(appChrome.actions.setControlLabel(ge.ema,
bd)),Lb.push(appChrome.actions.setButtonCommandValueId(ge.ema,lb)),appChrome.api.dispatch(Lb)),this.CMh(bd,ge.ema,lb,Da.Mf)),this.vb.KSh?(bd=new w.a(ge.ema,8,Da.Mf),lb=new D.a(2),lb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,lb.qt(bd),Jc.jr(lb),Wa.oo(Jc)):this.vb.rBj().then(rd=>{const Zd=new w.a(ge.ema,8,Da.Mf,null,1);Zd.count=rd;rd=new D.a(2);rd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;rd.qt(Zd);Jc.jr(rd);Wa.oo(Jc)},rd=>{m.TellMeActor.instance.Qd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+rd);rd=new w.a(ge.ema,8,Da.Mf,null,1);const Zd=new D.a(2);Zd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Zd.qt(rd);Jc.jr(Zd);Wa.oo(Jc)})}AQh(){return!!this.vb&&this.vb.kAd}r3h(Da,Wa,lb,Lb,oc=null){const Jc=[];Wa&&Jc.push(appChrome.actions.setControlLabel(Lb,Wa));this.vb.gJ&&Jc.push(appChrome.actions.setControlIconSet(Lb,{"default":"FindInDocument_20"}));Jc.push(appChrome.actions.setButtonCommandValueId(Lb,lb));appChrome.api.dispatch(Jc);this.CMh(Wa,
Lb,lb,"");Da.qt(new w.a(Lb,8,oc,null,1,-99999))}vhg(Da){return this.Qni?C.a.bFa(Da,15,this.fii):rh.a.Fe(Da)}CMh(Da,Wa,lb,Lb){this.AQh()&&this.H7a.length<this.GQd&&(Da=new Cg(Da,Wa,lb,Lb),Array.add(this.H7a,Da))}zRl(Da){for(let Wa=0;Wa<this.H7a.length;Wa++)if(this.H7a[Wa].CommandId===Da){const lb=this.H7a[Wa].Label;let Lb=!1;if(0<this.fRa.length){let oc=0;for(const Jc of this.fRa){if(Jc.Label===lb){Array.removeAt(this.fRa,oc);Lb=!0;break}oc++}}!Lb&&this.fRa.length>=this.GQd-1&&Array.removeAt(this.fRa,
1);Array.insert(this.fRa,0,this.H7a[Wa])}}}ge.ema=null;ge.kcg=null;ge.muh=null;Object(k.a)(ge,"FindInDocumentResultsProvider",null,[1132]);var bi=d(1019);class Og{constructor(Da){this.vb=Da}hF(){return"Insights"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa,lb=!1,Lb,oc=null){Lb=new y.a(Da);if(!oc||Array.contains(oc,13))if(this.hZl()||!C.a.SG(Da)){oc=new D.a(13);var Jc=""===Da.Mf.trim(),bd=Jc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",rd=new w.a(bd,10,Da.Mf,null,1);lb&&(lb=
null,C.a.V$()?Jc?Jc=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(Jc=this.vb.TRb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Da.Mf),lb=C.a.bFa(Da.Mf,1)):(Jc=String.format(CommonUIStrings.l_InsightsButtonText,Da.Mf),lb=C.a.q8d(Da.Mf)),this.vb.wfa?(m.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(bd,Jc)),lb&&m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
lb))):(Da=[],Da.push(appChrome.actions.setControlLabel(bd,Jc)),lb&&Da.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",lb)),appChrome.api.dispatch(Da)),rd.label=Jc);oc.qt(rd);Lb.jr(oc)}Wa.oo(Lb)}hZl(){return C.a.V$()&&this.vb.s9l&&!this.vb.c5}}Object(k.a)(Og,"InsightsResultsProvider",null,[1132]);var Ki=d(1017);class sk{constructor(Da){this.vb=Da}hF(){return"Learning"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa,lb,Lb,oc=null){lb=new y.a(Da);oc&&!Array.contains(oc,
21)||!C.a.SG(Da)||(oc=[],Lb=this.vb.hwk,oc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Lb)),Lb=sk.RBj(Lb),oc.push(appChrome.actions.setControlLabel("LearningForSearch",Lb)),appChrome.api.dispatch(oc),Da=new w.a("LearningForSearch",22,Da.Mf,null,1),oc=new D.a(21),oc.qt(Da),lb.jr(oc));Wa.oo(lb)}static RBj(Da){const Wa=[];Array.add(Wa,new Ki.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Wa,new Ki.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Wa,
new Ki.a(600,Da));Array.add(Wa,new Ki.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Da={};Da.parts=Wa;return JSON.stringify(Da)}}Object(k.a)(sk,"LearningProvider",null,[1132]);var kk=d(1106);class Nj{constructor(Da,Wa){this.Ssb=this.Xub=this.zRa=this.LIc=null;this.gx=!1;this.itb=Da;this.zci=Wa;Da&&this.vag(Da)}bEd(){this.itb.bEd()&&this.vag(this.itb)}vOj(Da){let Wa=[];var lb=[];Da=Nj.n0k(Da);var Lb="";Array.clear(lb);for(let oc=0;oc<Da.length;oc++){const Jc=Da.charAt(oc);-1!==" ".indexOf(Jc)?
(Lb.length&&Array.add(lb,Lb),Lb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Jc)?(Lb.length&&Array.add(lb,Lb),Lb=Jc,Array.add(lb,Lb),Lb=""):Lb+=Jc}Lb.length&&Array.add(lb,Lb);for(Da=0;Da<lb.length;Da++)Lb=this.Ywj(lb[Da]),Lb=this.n0i(Lb),Wa=Nj.xXk(Wa,Lb);return Wa=this.Fvi(Wa)}swe(){this.gx||this.bEd();return this.gx}GUc(Da){return this.LIc[Da.toString()]}Fvi(Da){for(let Wa=0;Wa<Da.length;Wa++){const lb=this.zRa[Wa];if(Da[Wa].commandId!==this.GUc(lb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Lb;(Lb=Da[Wa]).score=Lb.score+lb[1]}return Da}n0i(Da){const Wa=[];for(var lb=0;lb<this.zRa.length;lb++)Wa.push(new Qi.a(this.GUc(this.zRa[lb][0]),-5));lb=new kk.a;for(var Lb=0;Lb<Da.length;Lb++)lb.add(this.GUc(Da[Lb][0]));for(Lb=0;Lb<Wa.length;Lb++){const Jc=Wa[Lb];for(let bd=0;bd<Da.length;bd++){var oc=Da[bd];const rd=this.GUc(oc[0]);oc=oc[1];if(rd===Jc.commandId){Jc.score=oc;lb.remove(rd);break}}if(!lb.count)break}return Wa}Ywj(Da){const Wa=1>Da.length;for(let bd=0;2>=bd;bd++){const rd=this.Ssb;
for(const Zd in rd){var lb=rd[Zd],Lb=Da,oc=Zd;const ea=oc.length+1,Ka=Array((Lb.length+1)*ea);for(var Jc=0;Jc<=Lb.length;Jc++)Ka[Jc*ea]=Jc;for(Jc=0;Jc<=oc.length;Jc++)Ka[Jc]=Jc;for(Jc=0;Jc<oc.length;Jc++)for(let bb=0;bb<Lb.length;bb++)Ka[(bb+1)*ea+(Jc+1)]=Lb.charAt(bb)===oc.charAt(Jc)?Ka[bb*ea+Jc]:Math.min(Math.min(Ka[bb*ea+(Jc+1)]+1,Ka[(bb+1)*ea+Jc]+1),Ka[bb*ea+Jc]+1);Lb=Ka[Lb.length*ea+oc.length];if((!Lb||!Wa)&&Lb<=bd)return lb}}return this.Xub}vag(Da){this.LIc=Da.Zie();this.zRa=Da.VIj();this.Xub=
Da.JQj();this.Ssb=Da.ODj();if(this.gx=!!this.LIc&&!!this.zRa&&!!this.Ssb&&!!this.Xub)this.gx=0<this.zRa.length&&Nj.fue(this.zRa);this.gx&&(this.gx=0<this.Xub.length&&Nj.fue(this.Xub));this.gx&&(this.Ssb=Nj.mRj(this.Ssb));this.gx||(this.Ssb=this.Xub=this.zRa=this.LIc=null)}nQj(Da){Da=this.vOj(Da);return this.Rmj(Da,this.zci)}Rmj(Da,Wa){let lb=[];for(let Lb=0;Lb<Da.length;Lb++)Da[Lb].score>=Wa&&lb.push(Da[Lb]);lb.sort((Lb,oc)=>Lb.score<oc.score?1:Lb.score>oc.score?-1:0);0<lb.length-10&&(lb=lb.slice(0,
10));return lb}static xXk(Da,Wa){if(!Da.length)return Wa;if(Da.length!==Wa.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let lb=0;lb<Da.length;lb++){if(Da[lb].commandId!==Wa[lb].commandId)throw Error.create("Incorrect CommandId");let Lb;(Lb=Da[lb]).score=Lb.score+Wa[lb].score}return Da}static n0k(Da){return rh.a.Dg(Da)}static fue(Da){for(let Wa=0;Wa<Da.length;Wa++)if(2!==Da[Wa].length)return!1;return!0}static mRj(Da){const Wa={};for(const oc in Da){var lb=
oc,Lb=Da[oc];const Jc=Lb;Jc.length&&Nj.fue(Jc)&&(Wa[lb]=Lb)}return Wa}}Object(k.a)(Nj,"NaiveBayesClassifierModel",null,[]);class rl{constructor(Da,Wa){this.Yca=null;this.vb=Da;this.f_b=new Nj(Wa,Da.Hlg);this.vb.O9a&&(this.Yca=null)}hF(){return"NBCommand"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa,lb=!1,Lb=e.a.hq,oc=null){const Jc=new y.a(Da);if((!oc||Array.contains(oc,0))&&!C.a.SG(Da)){if(Th.CommandResultsUtility.Aue(Da.Mf)&&(oc=Th.CommandResultsUtility.whg(Da.Mf),0<oc.results.length)){oc.displayName=
"Classifier Debug";Jc.jr(oc);Wa.oo(Jc);return}if(!this.f_b.swe()){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.vb.O9a&&this.Yca&&this.Yca.initialize();oc=this.f_b.nQj(Da.Mf);Th.CommandResultsUtility.J$c(oc,!1,"Classifier","NaiveBayesian");oc=Th.CommandResultsUtility.Xac(Da,oc,this.vb,this.Yca,null,null,0,1);0<oc.results.length&&Lb!==e.a.contextMenu&&
(oc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);lb||oc.results.length||this.vb.oHa||this.vb.LAa||(Da=new w.a("lookupNoResults",14,Da.Mf,null,1),oc.qt(Da));0<oc.results.length&&Jc.jr(oc)}Wa.oo(Jc)}}Object(k.a)(rl,"NaiveBayesCommandProvider",null,[1132]);class cj{constructor(){this.F7a=null;this.gx=!1;this.bEd()}bEd(){this.gx||(this.F7a=window.NBCRM)&&4===this.F7a.length&&(this.gx=!0);return this.gx}VIj(){return this.gx?this.F7a[1]:null}JQj(){return this.gx?this.F7a[2]:null}ODj(){return this.gx?
this.F7a[3][0]:null}Zie(){return this.gx?this.F7a[0][0]:null}}Object(k.a)(cj,"NaiveBayesModelAdapter",null,[1212]);var bh=d(123);class vi{constructor(Da){this.vb=Da}hF(){return"OfficeScript"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa){const lb=new y.a(Da);if(!C.a.SG(Da)){Da=bh.d(Da.Mf);var Lb=new D.a(28);Lb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Lb=this.IKf(Da,vi.Ifm,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Lb);Lb=this.IKf(Da,
vi.irj,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Lb);lb.jr(Lb)}Wa.oo(lb)}IKf(Da,Wa,lb,Lb,oc,Jc){const bd=[];for(const rd of Wa)if(bh.a(Da,rd)){this.vb.wfa?(m.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(lb,oc)),m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(lb,Lb))):(bd.push(appChrome.actions.setControlLabel(lb,oc)),bd.push(appChrome.actions.setButtonCommandValueId(lb,Lb)),appChrome.api.dispatch(bd));
Jc.qt(new w.a(lb,28,null,null,1));break}return Jc}}vi.Ifm="unhide row rows col cols column columns".split(" ");vi.irj=["freeze","selection","pane","panes"];Object(k.a)(vi,"OfficeScriptsSamplesProvider",null,[1132]);var xh=d(18),hh=d(16),zf=d(457),Yh=d(305),Oa=d(456),sb=d(35),Pb=d(103),kc=d(121);class Wc{constructor(Da){this.yJ=null;this.HT=-1;this.VQe=14;this.WQe=12;this.attributes=this.yXd=this.query=null;this.zEb=!1;this.Stb=[];this.Bi=fi.AFrameworkApplication.Me;fi.AFrameworkApplication.fa&&(this.VQe=
fi.AFrameworkApplication.fa.tc("TellMeMaxTermedResults",this.VQe),this.WQe=fi.AFrameworkApplication.fa.tc("TellMeMaxZeroTermResults",this.WQe));this.EK=Da}get zl(){return this.Stb}get CEd(){return this.yXd}jr(Da){let Wa=!1;for(let lb=0;lb<this.zl.length;lb++)if(30!==this.zl[lb].groupType&&this.zl[lb].groupType===Da.groupType){this.oZd(this.zl[lb],Da);Wa=!0;break}Wa||this.zl.push(Da)}oZd(Da,Wa){for(let lb=0;lb<Wa.results.length;lb++)Da.qt(Wa.results[lb])}nDh(Da){const Wa=[];for(const lb of this.zl)lb.groupType!==
Da&&Wa.push(lb);this.zl.length!==Wa.length&&(this.Stb=Wa)}Hzl(Da){let Wa=null,lb=null,Lb=null;for(let oc=0;oc<Da.length;oc++){const Jc=Da[oc];if(Jc&&Jc.zl&&Jc.zl.length)for(const bd of Jc.zl)if(17===bd.groupType||18===bd.groupType)Wa=bd;else if(0===bd.groupType||16===bd.groupType)lb=bd,Lb=Jc}Wa&&lb&&0<lb.results.length&&(17===Wa.groupType&&({ZYd:lb,BZd:Wa}=Th.CommandResultsUtility.yui(lb,Wa,this.EK.cI()?this.EK.cI().lwj:-.6)),Lb.nDh(lb.groupType))}M3l(){this.EK&&(new xh.a,this.jzc(this.EK.T$g))}fgc(Da,
Wa){return this.query.Mf.length>this.EK.cI().pJj&&this.mok(Da,Wa)||this.query.Mf.length>this.EK.cI().qJj&&this.frk(Da,Wa)?!0:!1}frk(Da,Wa){return Da&&Da.length&&Wa&&Wa.length?-1===Wa.toLowerCase().indexOf(Da.toLowerCase())?!1:!0:!1}mok(Da,Wa){return Da&&Da.length&&Wa&&Wa.length?Wa.toLowerCase().startsWith(Da.toLowerCase()):!1}bnj(Da){const Wa=[];for(const lb of this.EK.cI().gJ?this.CEd:this.zl)Da.contains(lb.groupType)||Wa.push(lb);this.EK.cI().gJ?this.yXd=Wa:this.Stb=Wa}Rjm(Da,Wa){const lb=[];for(const Lb of this.zl){const oc=
Lb;if(13!==oc.groupType||24!==oc.groupType){const Jc=Da[Yh.a[oc.groupType].toLowerCase()];let bd="False";Jc<Wa&&(bd="True");oc.displayName=oc.displayName+" ("+bd+": "+Jc+")"}lb.push(oc)}this.Stb=lb}jzc(Da,Wa=!1,lb=null){if(this.EK.cI().gJ){if(!Wa)for(this.yXd=Array(this.zl.length),Wa=0;Wa<this.zl.length;Wa++)this.CEd[Wa]=this.zl[Wa];this.EK.Qbh.jzc(this.zl,this.CEd,this.query,Da,lb)}else{for(lb=new xh.a;this.zl.length;){Wa=this.zl.pop();const Lb=Yh.a[Wa.groupType].toLowerCase(),oc=Da[Lb];if(kc.b(oc))throw Error.create("GroupId "+
Lb+" missed from group SortingOrder");lb.add(new hh.a(oc,Wa))}lb.Sc((Lb,oc)=>Lb.key<oc.key?-1:1);for(Da=0;Da<lb.count;Da++)Wa=lb.ga(Da).value,this.zl.push(Wa)}}N3l(){var Da=!1;let Wa=!1,lb=!1;for(let oc=0;oc<this.zl.length;oc++){var Lb=this.zl[oc];const Jc=Lb.groupType;if(8===Jc||15===Jc||14===Jc){Lb=Lb.results;for(let bd=0;bd<Lb.length;bd++){if(8===Jc&&this.fgc(this.query.Mf,Lb[bd].label)){Da=!0;break}if(15===Jc&&this.fgc(this.query.Mf,Lb[bd].label)){Wa=!0;break}if(14===Jc){if(this.fgc(this.query.Mf,
Lb[bd].label)||this.fgc(this.query.Mf,Lb[bd].description)){lb=!0;break}const rd=Lb[bd].label.split(" ");for(const Zd of rd)if(this.fgc(this.query.Mf,Zd)){lb=!0;break}}}}}Da=this.EK.JKj(Da,Wa,lb);this.jzc(Da)}Tkb(Da,Wa,lb,Lb,oc,Jc){if(oc===this.yJ){var bd=Da.data.Ud;oc=null;try{oc=sb.b(bd)}catch(ud){m.TellMeActor.instance.Qd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+ud);return}if("RankerResults"in oc&&oc.RankerResults){this.ola();var rd=oc.RankerResults,
Zd=new xh.a,ea=new xh.a;bd=0;for(var Ka of rd){rd=Ka.ProviderId;var bb=Ka.Score;bd+=bb;Zd.add(new hh.a(rd,bb))}Zd.Sc((Nd,Bc)=>Nd.value>Bc.value?-1:1);bb=Jc?Jc.QLj:1E-6;Ka={};rd={};let ud=0;for(var vb=0;vb<Zd.count;vb++){const Nd=parseInt(Zd.ga(vb).key),Bc=Zd.ga(vb).value/bd;1===Nd&&(rd.answer=ud++,rd.entity=ud++,rd.definition=ud++,rd.wolframanswer=ud++,Bc<bb&&(ea.add(9),ea.add(11),ea.add(10),ea.add(12)),Ka.answer=Bc,Ka.entity=Bc,Ka.definition=Bc,Ka.wolframanswer=Bc);2===Nd&&(rd.assistance=ud++,Bc<
bb&&ea.add(8),Ka.assistance=Bc);3===Nd&&(rd.classifier=ud++,rd.serviceclassifier=ud++,Bc<bb&&(ea.add(0),ea.add(17)),Ka.classifier=Bc,Ka.serviceclassifier=Bc);4===Nd&&(rd.people=ud++,Bc<bb&&ea.add(14),Ka.people=Bc);5===Nd&&(rd.document=ud++,Bc<bb&&ea.add(15),Ka.document=Bc);6===Nd&&(rd.findindocument=ud++,Bc<bb&&ea.add(2),Ka.findindocument=Bc);7===Nd&&(rd.notes=ud++,Bc<bb&&ea.add(20),Ka.notes=Bc);8===Nd&&(rd.image=ud++,Bc<bb&&ea.add(19),Ka.image=Bc)}Zd=new xh.a;Zd.add("classifier");Zd.add("serviceclassifier");
Zd.add("appsforoffice");Zd.add("addin");Zd.add("findindocument");Zd.add("assistance");Zd.add("document");Zd.add("people");Zd.add("answer");Zd.add("wolframanswer");Zd.add("definition");Zd.add("entity");Zd.add("image");Zd.add("template");Zd.add("officescript");for(vb=0;vb<Zd.count;vb++)Zd.ga(vb)in rd||(rd[Zd.ga(vb)]=ud++);rd.learning=ud++;rd.insights=ud++;rd.actionai=ud++;rd.actionaicommand=ud++;rd.feedback=ud++;Jc&&Jc.Flk&&this.Rjm(Ka,bb);Jc&&Jc.Glk&&this.bnj(ea);ea={};for(var Yb in Ka)ea[Yb]=Ka[Yb]*
bd;this.jzc(rd,!0,ea)}if(Jc.R8c&&"Intents"in oc&&oc.Intents){Yb=oc.Intents;for(var Gc of Yb)if(this.yye(Gc)&&"Serplet"===Gc.GroupType&&Gc.ConfidenceScore>Gc.ConfidenceThreshold){Yb=!1;oc=0;if(Jc.Exe){bd=new w.a("",32);for(ea=0;ea<this.zl.length;ea++)if((Zd=this.zl[ea].results)&&0<Zd.length){oc=ea;bd=Zd[0];break}2===bd.groupType&&(Yb=!0)}bd=new D.a(13);Yb&&Jc.Exe&&(bd=new D.a(13,CommonUIStrings.l_TellMeWebTitle));ea=new w.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Mf,null,0);Zd=[];Ka=null;
Ka=C.a.V$()?C.a.bFa(this.query.Mf,1):C.a.q8d(this.query.Mf);Zd.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Ka));Ka=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Mf);Zd.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Ka));appChrome.api.dispatch(Zd);bd.qt(ea);ea=[];if(Yb&&Jc.Exe)for(ea.push(this.zl[oc]),ea.push(bd),Yb=oc+1;Yb<this.zl.length;Yb++)(oc=this.zl[Yb].results)&&0<oc.length&&ea.push(this.zl[Yb]);
else for(ea.push(bd),Yb=0;Yb<this.zl.length;Yb++)(oc=this.zl[Yb].results)&&0<oc.length&&ea.push(this.zl[Yb]);this.Stb=ea}}if(Jc.ngc&&!Jc.gJ){Gc=Yb=-1;for(oc=0;oc<this.zl.length;oc++)switch(this.zl[oc].groupType){case 23:Yb=oc;break;case 0:case 17:case 2:-1===Gc&&(Gc=oc)}if(-1!==Yb){Gc=-1===Gc?0:Yb>Gc?Gc+1:Gc;Yb=this.zl[Yb];oc=Array(this.zl.length);bd=0;for(ea=0;ea<oc.length;ea++)ea===Gc?oc[ea]=Yb:(23===this.zl[bd].groupType&&bd++,oc[ea]=this.zl[bd],bd++);this.Stb=oc}}Lb.oo(this);Lb=m.TellMeActor.instance.Qd;
Lb.r7(Wa.length,"RankerInference",Da.data.Ke.toString(),Math.round(window.performance.now()-lb),Oa.a.yXh,!0,zf.a.Ova);this.zEb&&Lb&&(Da=this.query.Z1a,Wa=Lb.TEc,Jc.i9c&&Da>Wa&&!Jc.gJ&&(Lb.OAe(this.query.Mf),Lb.D7e(Da)))}}yye(Da){if("GroupType"in Da&&Da.GroupType&&"ConfidenceScore"in Da&&"ConfidenceThreshold"in Da)return!0;m.TellMeActor.instance.Qd.onError("IsValidIntentGroup","Invalid intents found");return!1}Ekb(Da,Wa,lb,Lb,oc){Lb===this.yJ&&(this.ola(),m.TellMeActor.instance.Qd.r7(Wa.length,"RankerInference",
Da.data.Ke.toString(),Math.round(window.performance.now()-lb),Oa.a.yXh,!1,zf.a.Ova));oc.oo(this)}ola(){-1!==this.HT&&(window.clearTimeout(this.HT),this.HT=-1)}O3l(Da){let Wa;Wa=this.EK.cI().gJ?m.TellMeActor.instance.Qd.ele(this.CEd,this.query.Mf):m.TellMeActor.instance.Qd.ele(this.zl,this.query.Mf);var lb=this.EK.cI().PLj;""!==lb&&(lb="_"+lb);let Lb="";this.EK.cI().rwe&&(Lb="RankerInference"+lb+",");this.EK.cI().R8c&&(Lb+="SerpletClassifier");","===Lb.charAt(Lb.length-1)&&(Lb=Lb.substring(0,Lb.length-
1));lb=m.TellMeActor.instance.Qd.Kpg(Lb);const oc=this.yJ=Pb.a.create().toString();lb["Client-Request-Id"]=oc;const Jc=window.performance.now(),bd=this.EK.cI()?this.EK.cI().RLj:600;this.ola();this.HT=window.setTimeout(()=>{if(oc===this.yJ){this.yJ="";this.HT=-1;Da.oo(this);const rd={};rd[n.a.provider]="Ranker";rd[n.a.Rlb]=this.query.Z1a;m.TellMeActor.instance.Qd.TI(r.a.Cef,bd,rd)}},bd);this.Bi.Tj(m.TellMeActor.instance.Qd.Lpg(),2,Wa,lb,!1,0,rd=>{this.Tkb(rd,this.query.Mf,Jc,Da,oc,this.EK.cI())},rd=>
{this.Ekb(rd,this.query.Mf,Jc,oc,Da)},null,null,!1,4E3,6E3)}Hcm(){var Da=0,Wa=new xh.a,lb=this.EK.R$g,Lb=this.EK.S$g;for(var oc=0;oc<this.zl.length;oc++){var Jc=this.zl[oc],bd=Yh.a[Jc.groupType].toLowerCase(),rd=lb[bd];Da+=Jc.results.length;Jc.results.length>rd&&(bd=Lb[bd],kc.b(bd)||Wa.add(new hh.a(bd,Jc)))}Lb=!this.query||""===this.query.Mf.trim();oc=Da-(Lb?this.WQe:this.VQe);if(!(0>=oc)){Lb=window.performance.now();Da=Da.toString()+" total,"+oc.toString()+" to remove.";if(0<Wa.count)for(Wa.Sc((Zd,
ea)=>Zd.key>ea.key?-1:1),Jc=0;Jc<Wa.count&&0<oc;Jc++){bd=Wa.ga(Jc).value;rd=Yh.a[bd.groupType].toLowerCase();let Zd=bd.results.length-lb[rd];Zd>oc&&(Zd=oc);0<Zd&&(bd.X2e(Zd),Da+=rd+": "+Zd.toString()+" results removed.",oc-=Zd)}if(0<oc){Da+=oc.toString()+" results left after trimming.";Wa=new xh.a;lb=this.EK.W$g;for(Jc=0;Jc<this.zl.length;Jc++)bd=this.zl[Jc],rd=lb[Yh.a[bd.groupType].toLowerCase()],kc.b(rd)||Wa.add(new hh.a(rd,bd));Wa.Sc((Zd,ea)=>Zd.key<ea.key?-1:1);for(lb=0;0<oc;)Jc=Wa.ga(lb++).value,
oc>=Jc.results.length?(Array.remove(this.zl,Jc),Da+=Yh.a[Jc.groupType]+": "+Jc.results.length.toString()+" results force removed.",oc-=Jc.results.length):(Jc.X2e(oc),Da+=Yh.a[Jc.groupType]+": "+oc.toString()+" results force removed.",oc=0)}m.TellMeActor.instance.Qd&&(Wa={},Wa[n.a.message]=Da,m.TellMeActor.instance.Qd.TI("ShowOptimal",window.performance.now()-Lb,Wa))}}}Object(k.a)(Wc,"CombineResultsUpdatedEventArgs",null,[1126]);class Xd{constructor(Da,Wa,lb,Lb=!1,oc=""){this.NSd=this.bUd=!1;this.IE=
Da;this.n8a=[];this.aDf=Wa.length;this.vb=m.TellMeActor.instance.cI();this.NHc=Lb;this.eSa=oc;this.Dub={};for(Da=0;Da<Wa.length;++Da)this.Dub[Da.toString()]=lb?0:Wa[Da].CM()}USl(Da,Wa){Wa&&Wa.query&&Wa.query.Z1a<m.TellMeActor.instance.Kda||(this.n8a[Da]=Wa,this.NSd?this.bUd=!0:(!this.vb||3!==this.vb.pr||3!==this.Dub[Da.toString()]||this.D5f())&&this.R5c())}jfl(){this.NSd=!0}Rfm(){this.NSd=!1;this.bUd&&(this.bUd=!1,this.R5c())}D5f(){if(this.n8a.length<this.aDf)return!1;for(let Da=0;Da<this.aDf;++Da)if(!this.n8a[Da])return!1;
return!0}R5c(){var Da=this.D5f();const Wa=window.performance.now(),lb=new Wc(m.TellMeActor.instance.Stf);lb.Hzl(this.n8a);for(var Lb=0;Lb<this.n8a.length;++Lb){var oc=this.n8a[Lb];if(oc&&oc.zl&&oc.zl.length&&(lb.query=oc.query,oc.attributes&&0<oc.attributes.length&&(lb.attributes=oc.attributes),oc&&oc.zl&&(Da||this.JSi(Lb,this.n8a))))for(const Jc of oc.zl)lb.jr(Jc)}lb.zl&&lb.zl.length&&(lb.zEb=Da,this.vb&&this.vb.Iff&&lb.Hcm(),this.vb&&this.vb.rpk&&lb.query.Mf&&0<lb.query.Mf.length?lb.N3l():lb.M3l(),
this.vb&&(this.vb.rwe||this.vb.R8c)&&this.NHc&&lb.query.Mf&&0<lb.query.Mf.length&&lb.zEb&&this.eSa!==e.a.contextMenu?(3===this.vb.pr&&Da||this.IE.oo(lb),lb.O3l(this.IE)):this.IE.oo(lb),Da=m.TellMeActor.instance.Qd,lb.zEb&&Da&&(Lb=lb.query.Z1a,oc=Da.TEc,lb.query.Mf&&0<lb.query.Mf.length&&this.NHc&&this.vb.i9c&&this.eSa!==e.a.contextMenu&&Lb>oc&&!this.vb.rwe&&!this.vb.gJ&&(Da.OAe(lb.query.Mf),Da.D7e(Lb)),Da.TI(r.a.gHl,window.performance.now()-Wa)))}JSi(Da,Wa){if(!(this.Dub&&Da.toString()in this.Dub)||
Wa.length<=Da||!Wa[Da])return!1;if(!Wa[Da].zl.length)return!0;const lb=this.Dub[Da.toString()];if(0===lb)return!0;const Lb=this.Dub;for(const Jc in Lb){var oc=Lb[Jc];const bd=Number.parseInvariant(Jc);if(bd!==Da&&oc===lb&&!(Wa.length>bd&&Wa[bd]))return!1}return!0}}Object(k.a)(Xd,"ResultsAggregator",null,[]);var Gd=d(1051);class Pe{constructor(){this.sTb=this.tTb=this.rTb=this.qhc=this.TFb=this.pDb=0}Zti(Da,Wa){switch(Da){case 1:this.pDb=Wa;break;case 3:this.TFb=Wa;break;case 2:this.qhc=Wa;break;case 5:this.rTb=
Wa;break;case 4:this.tTb=Wa;break;case 6:this.sTb=Wa}}}Object(k.a)(Pe,"CommandFeatures",null,[]);class Lf{constructor(Da){this.Fsf=0;this.Xja=Da;this.zbi={}}get modelId(){return this.Xja}get Tlj(){return this.Fsf}get Q5b(){return this.zbi}Xsi(Da,Wa,lb){0===Wa?this.Fsf=lb:(this.Q5b[Da]||(this.Q5b[Da]=new Pe),this.Q5b[Da].Zti(Wa,lb))}}Object(k.a)(Lf,"CoefficientsModel",null,[]);const Nf=(Da,Wa)=>Math.pow(10,-Wa/(60*Math.LN10/Math.LN2*Da));class dg{constructor(Da,Wa){this.Un=1;this.SFc=new Pe;this.features.qhc=
1+Math.log(this.count)/Math.LN2;this.features.pDb=Da?1/Da:0;this.features.TFb=2/Math.pow(2,Da);this.features.rTb=Nf(10,Wa);this.features.tTb=Nf(2,Wa);this.features.sTb=Nf(1,Wa)}get count(){return this.Un}get features(){return this.SFc}U7j(){this.Un=this.count+1;this.features.qhc=1+Math.log(this.count)/Math.LN2}Kjm(Da){const Wa=2/Math.pow(2,Da);this.features.pDb=Math.max(this.features.pDb,Da?1/Da:0);this.features.TFb=Math.max(this.features.TFb,Wa)}$km(Da){const Wa=Nf(10,Da),lb=Nf(2,Da);Da=Nf(1,Da);
this.features.rTb=Math.max(this.features.rTb,Wa);this.features.tTb=Math.max(this.features.tTb,lb);this.features.sTb=Math.max(this.features.sTb,Da)}}Object(k.a)(dg,"CommandModel",null,[]);class Pg{constructor(Da){this.iWb=null;if(!Da&&m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("PredictionEngine","IModelAdapter can't be null");this.itb=Da;this.KIc=this.dAe()}dAe(){const Da=this.itb.KFj(),Wa=this.itb.Zie();if(void 0===Da||null===Da||void 0===Wa||null===Wa)return!1;try{window.performance.now();
this.iWb={};for(let lb=0;lb<Da.length;lb++){const Lb=Da[lb],oc=Wa[Lb[0].toString()].trim(),Jc=Lb[1],bd=0!==Jc?Wa[Lb[2].toString()].trim():"",rd=Lb[3];oc in this.iWb||(this.iWb[oc]=new Lf(oc));this.iWb[oc].Xsi(bd,Jc,rd)}}catch(lb){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("LoadModelData","Error Loading Suggestions Model: "+lb);return!1}return!0}Hsj(){const Da=this.itb.nDj(),Wa={};if(!Da)return Wa;let lb=1;for(let Lb=0;Lb<Da.length;Lb++){const oc=Da[Lb];oc.Id in Wa?(Wa[oc.Id].U7j(),
Wa[oc.Id].Kjm(lb),Wa[oc.Id].$km(oc.TimeElapsedSinceClick)):Wa[oc.Id]=new dg(lb,oc.TimeElapsedSinceClick);lb++}return Wa}swe(){this.KIc||(this.KIc=this.dAe());return this.KIc}EIj(){let Da=[];if(!this.KIc){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("GetPredictedCommands","IModelAdapter returned no data");return Da}const Wa=this.Hsj(),lb=this.iWb;for(const oc in lb){const Jc=lb[oc],bd=Jc.modelId;let rd=0;for(const Zd in Wa){var Lb=Zd;const ea=Wa[Zd].features;(Lb=Lb in Jc.Q5b?Jc.Q5b[Lb]:
null)&&(rd+=ea.pDb*Lb.pDb+ea.TFb*Lb.TFb+ea.qhc*Lb.qhc+ea.rTb*Lb.rTb+ea.tTb*Lb.tTb+ea.sTb*Lb.sTb)}rd+=Jc.Tlj;Da.push(new Qi.a(bd,rd))}Da.sort((oc,Jc)=>oc.score<Jc.score?1:oc.score>Jc.score?-1:0);0<Da.length-10&&(Da=Da.slice(0,10));return Da}}Object(k.a)(Pg,"PredictionEngine",null,[]);class pi{constructor(){this.hFf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),
"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),
"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),
"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),
"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}f_c(Da,Wa){return Wa&&"word"===Wa.application.toLowerCase()&&Da in this.hFf?this.hFf[Da]:[]}}Object(k.a)(pi,"SuggestionResultsUtility",null,[]);class li{constructor(Da,Wa,lb){this.vb=Wa;this.f_b=new Pg(Da);this.PT=lb;this.AGf=new pi}hF(){return"Suggestion"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(Da,Wa,lb,Lb=e.a.hq,oc=null){lb=new y.a(Da);
m.TellMeActor.instance.iCc=!1;if((!oc||Array.contains(oc,16))&&C.a.SG(Da)){if(!this.f_b.swe()){if(m.TellMeActor.instance.Qd)m.TellMeActor.instance.Qd.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.zxe()&&0<this.AGf.f_c(m.TellMeActor.instance.uUc,this.vb).length){const bd=this.AGf.f_c(m.TellMeActor.instance.uUc,this.vb);oc=[];for(var Jc of bd)this.vb.kAd&&"Find"===Jc||oc.push(new Qi.a(Jc,
0));m.TellMeActor.instance.iCc=!0}else oc=this.f_b.EIj();Th.CommandResultsUtility.J$c(oc,!0,"Recommended","LRE");Jc=[];for(const bd of oc)this.PT&&this.PT.v6d(bd.commandId)||Jc.push(bd);Da=Th.CommandResultsUtility.Xac(Da,Jc,this.vb,null,null,null,16,1);0<Da.results.length&&Lb!==e.a.contextMenu&&(Da.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Da.results.length&&lb.jr(Da)}Wa.oo(lb)}zxe(){return!!this.vb&&(this.vb.zxe||this.vb.Ztk)}}Object(k.a)(li,"SuggestionResultsProvider",null,[1132]);
class Ri{nDj(){return m.TellMeActor.instance.zJd}KFj(){return window.TellMeSuggestionModel}Zie(){return window.CoefficientModelIdMap}}Object(k.a)(Ri,"SuggestionsModelAdapter",null,[1209]);var Ih=d(1086),ij=d(1020);d.d(V,"AggregatorResultsProvider",function(){return Fi});class Fi{constructor(Da=!1){this.Etb={};this.Etb[e.a.hq]=[];this.Etb[e.a.contextMenu]=[];this.NHc=Da}kHg(Da,Wa,lb,Lb,oc=null){let Jc;var bd=!1;switch(Lb){case e.a.contextMenu:Jc=this.Etb[e.a.contextMenu];bd=!0;break;default:Jc=this.Etb[e.a.hq]}Wa=
new Xd(Wa,Jc,bd,this.NHc,Lb);Wa.jfl();for(let rd=0;rd<Jc.length;++rd){const Zd=window.performance.now(),ea=new H(Wa,rd);(bd=m.TellMeActor.instance.cI())&&bd.hJi?window.setTimeout(()=>{Jc[rd].AC(Da,ea,lb,Lb,oc);if(m.TellMeActor.instance.Qd){const Ka={};Ka[n.a.provider]=Jc[rd].hF();Ka[n.a.Rlb]=Da.Z1a;m.TellMeActor.instance.Qd.TI(r.a.AC,window.performance.now()-Zd,Ka)}},0):(Jc[rd].AC(Da,ea,lb,Lb,oc),m.TellMeActor.instance.Qd&&(bd={},bd[n.a.provider]=Jc[rd].hF(),bd[n.a.Rlb]=Da.Z1a,m.TellMeActor.instance.Qd.TI(r.a.AC,
window.performance.now()-Zd,bd)))}Wa.Rfm()}hF(){return"Aggregator"}CM(){return 0}AC(Da,Wa,lb=!1,Lb=e.a.hq,oc=null){if(m.TellMeActor.instance.wYk)this.kHg(Da,Wa,lb,Lb,oc);else{const Jc=window.performance.now();m.TellMeActor.instance.mom.then(()=>{m.TellMeActor.instance.Qd&&m.TellMeActor.instance.Qd.TI(r.a.xYk,window.performance.now()-Jc);this.kHg(Da,Wa,lb,Lb,oc);return!0})}}Vz(Da,Wa){this.Etb[Wa].push(Da)}Wui(Da){switch(Da){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Wa=
this.Etb[e.a.hq];for(const lb of Wa)if("FindInDocument"===lb.hF()){lb.zRl(Da);break}}}static createInstance(Da,Wa,lb,Lb){const oc=Wa.c5;var Jc=Lb&&C.a.V9e(Wa),bd=Jc&&Wa.gWe&&!oc;const rd=Wa.nye&&!C.a.ZEb()&&!oc,Zd=Wa.Awe&&!oc,ea=new Fi(Jc);if(Wa.iZl&&!oc){var Ka=new sk(Wa);ea.Vz(Ka,e.a.hq)}Ka=Wa.Xp?fi.AFrameworkApplication.fa.getBooleanAppSetting("TellMeIsSuggestionsForSimplifiedUxEnabled"):fi.AFrameworkApplication.fa.getBooleanAppSetting("TellMeSuggestionsIsEnabled");const bb=!Ka&&fi.AFrameworkApplication.fa.getBooleanAppSetting("TellMeFirstRunExperienceIsEnabled");
ea.Vz(new $d.a(Da,Wa.rem,bb,!1),e.a.hq);Ka&&!oc&&ea.Vz(new li(new Ri,Wa,Da),e.a.hq);Da=fi.AFrameworkApplication.za.mb.nGg?new rl(Wa,new cj):new Ng(Wa,lb);ea.Vz(Da,e.a.contextMenu);(Jc&&Wa.hWe||bd)&&ea.Vz(Ih.a.o2f(Wa,!0),e.a.hq);ea.Vz(Da,e.a.hq);!Wa.Dnj||oc||"Word"===Wa.application&&Wa.gcg||ea.Vz(new ge(Wa),e.a.hq);Wa.O9a&&!oc&&(bd=new K(Wa),ea.Vz(bd,e.a.hq),ea.Vz(bd,e.a.contextMenu));!Wa.kwb||Wa.syc||Wa.ryc||oc||ea.Vz(new A.a(Wa),e.a.hq);Lb&&(Wa.oHa||C.a.V$())&&(bd=new Og(Wa),ea.Vz(bd,e.a.hq),ea.Vz(bd,
e.a.contextMenu));Jc&&ea.Vz(Ih.a.o2f(Wa,!1),e.a.hq);Lb&&!Wa.Acf&&C.a.U9e(Wa)&&!oc&&(ea.Vz(new Gd.a(Wa),e.a.hq),Wa.S6l&&ea.Vz(new Gd.a(Wa),e.a.contextMenu));rd&&ea.Vz(new Qf(Wa),e.a.hq);!Wa.YRb&&!Wa.gJ||oc||ea.Vz(new bi.a(Wa),e.a.hq);Wa.ngc&&!oc&&ea.Vz(new ij.a(Wa),e.a.hq);Wa.Ste&&(Jc=new F(Wa),ea.Vz(Jc,e.a.hq),ea.Vz(Jc,e.a.contextMenu));Lb&&Wa.f6c&&!oc&&ea.Vz(new B.AddinResultsProvider(Wa),e.a.hq);Zd&&"Excel"===Wa.application&&!oc&&ea.Vz(new vi(Wa),e.a.hq);return ea}}Object(k.a)(Fi,"AggregatorResultsProvider",
null,[1132])},1051:function(L,V,d){L=d(0);var k=d(145),e=d(685),n=d(391),r=d(268);class w{constructor(ca,ia,oa,sa,Ca,Ta){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=ca;this.url=ia;this.spWebUrl=oa;this.uniqueId=sa;this.size=Ca;this.lastModified=Ta}}Object(L.a)(w,"FileInfo",null,[]);var D=d(457);class y{constructor(ca,ia){this.DimensionValue=this.DimensionName=null;this.DimensionName=ca;this.DimensionValue=ia}}Object(L.a)(y,"Dimension",null,[]);
class m{constructor(ca,ia,oa,sa,Ca){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ca;this.Query=ia;this.From=oa;this.Size=sa;Ca&&(this.Filter=Ca)}}Object(L.a)(m,"EntityRequest",null,[]);class C{constructor(ca){this.QueryString=null;this.QueryString=ca}}Object(L.a)(C,"Query",null,[]);var E=d(159);class F{constructor(ca,ia){this.Dimensions=this.Name=null;this.Name=ca;this.Dimensions=ia}}Object(L.a)(F,"Scenario",null,[]);var B=d(174),H=d(173);class K{constructor(ca,
ia,oa,sa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ca;this.TimeZone=ia;this.Cvid=oa;this.Scenario=sa}}Object(L.a)(K,"SubstrateBody",null,[]);var A=d(456),W=d(116),N=d(108),P=d(25),U=d(960),Q=d(959),G=d(302),Y=d(35),ba=d(46),ha=d(103);d.d(V,"a",function(){return ka});class ka{constructor(ca){this.t_b=this.LRa=this.WIc=this.FXb=this.T_b=0;this.HAf=this.pCf=this.yJ=null;this.YPd=0;this.HT=-1;this.x1b="";this.gMd=!1;this.Bi=P.AFrameworkApplication.Me;this.vb=
ca;this.MLc=this.fle();this.t8a=new e.a;this.Fzf=this.vb.Iff?3:2;this.EWd=this.vb.Iff&&this.vb.YRh?5:3;this.mYd=this.vb.kAd?2:3;this.FIf=1;this.yIc=this.vb.Zlg;this.bGf=this.vb.Wqk;this.u0b=ca.Mog;P.AFrameworkApplication.fa&&(this.pCf=P.AFrameworkApplication.fa.Ea("AppCatalogUrl")+P.AFrameworkApplication.fa.Ea("SearchPersonaPhotoBaseUrl"),this.gMd=this.vb.xzb||this.vb.c5||this.vb.BWc);this.vb.c5&&(this.mYd=this.EWd=5)}hF(){return"Substrate"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:3}AC(ca,ia,
oa,sa=k.a.hq,Ca=null){const Ta=new H.a(ca);if(!Ca||Array.contains(Ca,14)||Array.contains(Ca,15)||Array.contains(Ca,20))if(!this.YPd||window.performance.now()-this.YPd>=N.a.vDd)if(oa=this.t8a.ppg())this.YPd=window.performance.now(),oa.then(R=>{R&&""!==R?(this.x1b=R,""!==this.yJ&&this.opg(ca,sa,this.x1b,ia,Ca)):(W.TellMeActor.instance.Qd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ia.oo(Ta))},R=>{W.TellMeActor.instance.Qd.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+R);ia.oo(Ta)});else{if(W.TellMeActor.instance.Qd)W.TellMeActor.instance.Qd.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ia.oo(Ta)}else this.x1b&&""!==this.x1b?this.opg(ca,sa,this.x1b,ia,Ca):(ia.oo(Ta),W.TellMeActor.instance.Qd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ia.oo(Ta)}d3(){this.LRa=this.t_b=this.WIc=this.FXb=this.T_b=0}opg(ca,ia,oa,sa,Ca){this.d3();const Ta=new H.a(ca),R=this.yJ=ha.a.create().toString();
this.ola();this.HT=window.setTimeout(()=>{if(R===this.yJ){this.yJ="";this.HT=-1;sa.oo(Ta);const Ba={};Ba[n.a.provider]=this.hF();Ba[n.a.Rlb]=ca.Z1a;W.TellMeActor.instance.Qd.TI(r.a.Cef,this.u0b,Ba)}},this.u0b);const Ha={"Content-Type":"application/json",Accept:"application/json"};Ha.Authorization="Bearer "+oa;Ha["X-Office-Version"]=P.AFrameworkApplication.buildVersion;Ha["X-Office-Application"]=P.AFrameworkApplication.fa.Ea("Application");Ha["X-Office-Platform"]="WAC";Ha["X-TellMe-SessionId"]=W.TellMeActor.instance.s2c();
Ha["X-TellMe-Culture"]=P.AFrameworkApplication.uiCulture;Ha["X-TellMe-ProcessSessionId"]=P.AFrameworkApplication.userSessionId;Ha["Client-Request-Id"]=R;const da=window.performance.now();this.Bi.Tj(this.iOj(),2,this.jOj(ca.Mf,this.vb.application,W.TellMeActor.instance.s2c(),N.a.SG(ca)),Ha,!1,0,Ba=>{this.Tkb(Ba,ca,sa,R,da,ia,Ca)},Ba=>{this.Ekb(Ba,ca,sa,R,da)},null,null,!1,4E3,6E3)}ola(){-1!==this.HT&&(window.clearTimeout(this.HT),this.HT=-1)}Tkb(ca,ia,oa,sa,Ca,Ta,R){W.TellMeActor.instance.Qd.r7(ia.Mf.length,
this.MLc.join(","),ca.data.Ke.toString(),Math.round(window.performance.now()-Ca),A.a.xVh,!0,D.a.Ova);const Ha=N.a.SG(ia),da=new H.a(ia);if(sa===this.yJ){this.ola();ca=Y.b(ca.data.Ud);if(ca.Groups){ca=ca.Groups;for(const Ba of ca)"People"===Ba.Type&&this.vb.lAc&&(R?Array.contains(R,14):1)?(ca=this.Cmg(Ba.Suggestions,Ha,Ta),0<ca.results.length&&da.jr(ca)):"File"===Ba.Type&&this.vb.jAc&&(R?Array.contains(R,15):1)?(ca=this.yhe(Ba.Suggestions,Ha,Ta),0<ca.results.length&&(this.n7c()&&(sa=new E.a("GenerateSlidesFromTellMe",
30,"",null,1),ca.qt(sa)),da.jr(ca))):"Notes"===Ba.Type&&this.vb.oYa&&Ta!==k.a.contextMenu&&(R?Array.contains(R,20):1)&&(ca=this.Wlg(Ba.Suggestions,Ha,ia),0<ca.results.length&&da.jr(ca))}oa.oo(da);W.TellMeActor.instance.Qd.r7(ia.Mf.length,this.MLc.join(","),"",Math.round(window.performance.now()-Ca),"",!0,D.a.provider)}else oa.oo(da)}Wlg(ca,ia,oa){const sa=new B.a(20);sa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const Ca of ca)this.ltk(Ca)&&(ca=Ca.NotesType,ca=ba.a.Dg(ca),ca=this.PGj(ca,
Ca.LastModifiedTime,Ca.BodyPreview,Ca.Subject,ia,oa,Ca))&&(ca.groupType=20,sa.qt(ca));return sa}Cmg(ca,ia,oa){const sa=new B.a(14);sa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Ta of ca)if(this.mtk(Ta)){var Ca=Ta.Id.split("@")[0];ca=Ta.EmailAddresses[0];let R=Ta.Type;if(void 0===R||null===R)R="User";if(Ca=this.gIj(R,Ta.DisplayName,Ta.JobTitle,ca,Ca,oa,ia))Ca.description=ca,ca=Ta.JobTitle,"Department"in Ta&&"CompanyName"in Ta&&(ca+="@"+Ta.Department+"@"+Ta.CompanyName),Ca.C_d=
ca,sa.qt(Ca)}return sa}yhe(ca,ia,oa){const sa=new B.a(15);sa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ba of ca)if(this.ctk(Ba)){var Ca=Ba.FileName;ca=Ba.FileExtension;var Ta=Ca;Ca.length>ca.length&&Ta.endsWith(ca)&&(Ta=Ca.substr(0,Ca.length-ca.length-1));var R=void 0,Ha=0;"DateCreated"in Ba&&Ba.DateCreated?(Ha=N.a.Fle(Ba.DateCreated),R=N.a.Zpg(Ba.DateCreated),R=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ba.Author,R)):R=Ba.Author;var da=Ba.AccessUrl+"?web=1";const za=
ba.a.adc(da);Ca=String.format('<a href="{0}">{1}</a>',za,ba.a.aXa(Ca));if(oa!==k.a.contextMenu||ba.a.O$(da))if(Ta=this.kBj(Ta,oa===k.a.contextMenu?Ca:da,R,Ba.FileExtension,Ba.Text,ia))Ta.description=Ba.Author,Ta.UOc=Ha,sa.qt(Ta),this.gMd&&(Ha=Ba.AccessUrl,Ca=N.a.V_c(ca),R=Ba.DateModified?Ba.DateModified:Ba.DateCreated,da=Ba.Size?Ba.Size:Ba.FileSize,this.nYl()&&(Ha=Ha.replace(RegExp("%20","g")," "),Ca=N.a.qNj(ca)),ca=new w(Ca,Ha,Ba.SPWebUrl,Ba.Id,da,R),W.TellMeActor.instance.xhf(!1,Ta.value,ca))}return sa}Ekb(ca,
ia,oa,sa,Ca){sa===this.yJ&&(this.ola(),W.TellMeActor.instance.Qd.r7(ia.Mf.length,this.MLc.join(","),ca.data.Ke.toString(),Math.round(window.performance.now()-Ca),A.a.xVh,!1,D.a.Ova));ca=new H.a(ia);oa.oo(ca)}gIj(ca,ia,oa,sa,Ca,Ta,R){R=R?this.FIf:this.Fzf;if(!window.LPC&&!N.a.Wue()||this.T_b===R)return null;this.T_b+=1;R="PeopleSuggestion"+this.T_b.toString();var Ha=this.pCf+"?size=1&accountName="+sa;ca=Object.assign(new U.a,{PersonaType:ca,Smtp:sa,ProfilePictureUrl:Ha,AadObjectId:Ca});const da=Object.assign(new Q.a,
{identifiers:ca,displayName:ia});ca=Ta===k.a.contextMenu;this.vb.wfa?(W.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(R,da,ia,oa)),Ta===k.a.contextMenu&&(oa=N.a.Y1f(ia,sa,Ca),W.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(R,oa))),W.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(R,ca))):(Ha=[],Ha.push(appChrome.actions.setPersonaButtonCoauthor(R,da,ia,oa)),Ta===k.a.contextMenu&&(oa=N.a.Y1f(ia,
sa,Ca),Ha.push(appChrome.actions.setButtonCommandValueId(R,oa))),Ha.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(R,ca)),appChrome.api.dispatch(Ha));return new E.a(R,11,ia,sa,0)}PGj(ca,ia,oa,sa,Ca,Ta,R){if(Ca&&!this.vb.rGg||this.WIc===this.yIc||this.t_b===this.yIc||this.LRa===this.yIc)return null;var Ha=null;this.WIc+=1;Ca="";const da=[],Ba={};R.type="Notes";this.HAf=Object.assign(new G.a,{landingTab:"Notes",data:R});Ta=N.a.bFa(Ta.Mf,33,this.HAf);if("onenotepagepreviews"===ca){if(!("ClickthroughUrl"in
R&&R.ClickthroughUrl)||""===R.ClickthroughUrl)return null;this.t_b+=1;Ca="OnenoteNotesSuggestion"+this.t_b.toString();Ba["default"]="SaveAsonetoc2_20";Ha=R.ClickthroughUrl;da.push(appChrome.actions.setControlIconSet(Ca,Ba));da.push(appChrome.actions.setCompoundButtonCommandValueId(Ca,Ha));Ha=new E.a(Ca,19,null,null,0)}else if("stickynote"===ca){if(!this.bGf)return null;this.LRa+=1;Ca="NotesSuggestion"+this.LRa.toString();Ba["default"]="ShowAllNotes_20";da.push(appChrome.actions.setControlIconSet(Ca,
Ba));da.push(appChrome.actions.setCompoundButtonCommandValueId(Ca,Ta));Ha=new E.a(Ca,21,null,null,0)}else if("samsung"===ca){if(!this.bGf)return null;this.LRa+=1;Ca="NotesSuggestion"+this.LRa.toString();Ba["default"]="CategoryCollapsed_20";da.push(appChrome.actions.setControlIconSet(Ca,Ba));da.push(appChrome.actions.setCompoundButtonCommandValueId(Ca,Ta));Ha=new E.a(Ca,20,null,null,0)}""!==Ca&&(ca=N.a.Zpg(ia),ca=String.format(CommonUIStrings.l_LastModifiedString,ca),Ha.label=sa,Ha.UOc=N.a.Fle(ia),
da.push(appChrome.actions.setControlLabel(Ca,sa)),da.push(appChrome.actions.updateCompoundButtonDescription(Ca,ca)),da.push(appChrome.actions.setControlCustomTooltip(Ca,oa)),appChrome.api.dispatch(da));return Ha}kBj(ca,ia,oa,sa,Ca,Ta){if(this.FXb===(Ta?this.mYd:this.EWd)||this.gMd&&"Word"!==N.a.V_c(sa))return null;this.FXb+=1;Ta="FileSuggestion"+this.FXb.toString();const R=[],Ha={};Ha["default"]=N.a.MCj(sa);this.vb.wfa?(W.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ta,ca)),
W.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Ta,Ha)),W.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ta,oa)),W.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ta,ia)),W.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ta,Ca)),this.vb.xzb&&W.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(Ta,"QuickActionOnFile"))):(R.push(appChrome.actions.setControlLabel(Ta,
ca)),R.push(appChrome.actions.setControlIconSet(Ta,Ha)),R.push(appChrome.actions.updateCompoundButtonDescription(Ta,oa)),R.push(appChrome.actions.setCompoundButtonCommandValueId(Ta,ia)),R.push(appChrome.actions.setControlCustomTooltip(Ta,Ca)),this.vb.xzb&&R.push(appChrome.actions.setCompoundButtonSecondaryButtonId(Ta,"QuickActionOnFile")),appChrome.api.dispatch(R));return new E.a(Ta,6,ca,oa,0)}fle(){const ca=[];this.vb.lAc&&Array.add(ca,"People");this.vb.jAc&&Array.add(ca,"File");this.vb.oYa&&Array.add(ca,
"Notes");return ca}jOj(ca,ia,oa,sa){var Ca=new C(ca);ca=new m("File",Ca,0,sa?this.mYd:this.EWd,null);sa=new m("People",Ca,0,sa?this.FIf:this.Fzf,N.a.tfl);Ca=new m("Notes",Ca,0,this.yIc,null);(this.vb.xzb||this.vb.BWc)&&"powerpoint"===ia.toLowerCase()&&(ia="word");ia=new y("app",ia.toLowerCase());var Ta=[];Array.add(Ta,ia);ia=new F("tellmesearch",Ta);Ta=[];this.vb.jAc&&Array.add(Ta,ca);this.vb.lAc&&Array.add(Ta,sa);this.vb.oYa&&Array.add(Ta,Ca);oa=new K(Ta,"UTC",oa,ia);return Y.c(oa)}iOj(){let ca=
this.vb.T6l;this.vb.oYa&&(ca+="?&setflight=NotesFrom3S");""!==this.vb.qpg&&(ca=ca+"&"+this.vb.qpg);return ca}mtk(ca){return"DisplayName"in ca&&"Id"in ca&&"EmailAddresses"in ca&&!!ca.Id&&!!ca.EmailAddresses}ctk(ca){return"FileExtension"in ca&&!!ca.FileExtension&&"FileName"in ca&&!!ca.FileName&&""!==ca.FileName&&"AccessUrl"in ca&&!!ca.AccessUrl&&""!==ca.AccessUrl}ltk(ca){return"Id"in ca&&!!ca.Id&&"NotesType"in ca&&!!ca.NotesType&&"Subject"in ca&&!!ca.Subject&&""!==ca.Subject}n7c(){return!!P.AFrameworkApplication.fa&&
P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}nYl(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(L.a)(ka,"SubstrateResultsProvider",null,[1132])},108:function(L,V,d){L=d(0);var k=d(16);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(L.a)(e,"InsertMentionParameters",null,[]);class n{constructor(){this.neighborhood=
null;this.mentionLength=this.mentionStart=0}}Object(L.a)(n,"InsightsParameters",null,[]);var r=d(1013),w=d(1014),D=d(1016),y=d(1017),m=d(25),C=d(341),E=d(453),F=d(35),B=d(55),H=d(46),K=d(121),A=d(1015);d.d(V,"a",function(){return W});class W{static get Ybk(){return"Insights_16x16x32"}static get Cnj(){return"Find_16x16x32"}static get Zsh(){return"-Parameterized"}static get Naf(){return"Parameterized"}static get hEd(){return"bTryQuery"}static get lgf(){return"TellMeSuggestion_"}static get R_h(){return"bTryQueryAlternate"}static get Mdf(){return"MenuTellMe"}static get tfl(){const N=
{},P=[];Array.add(P,{Term:{PeopleType:"Person"}});N.And=P;return N}static i8i(N){return N+W.Zsh}static getParameter(N){let P="",U="";if(N)for(let Q=0;Q<N.Cbg;++Q)"Type"===N.the(Q)?P=N.$a(Q):"Value"===N.the(Q)&&(U=N.$a(Q));return new k.a(P,U)}static q8d(N){N=Object.assign(new n,{neighborhood:N,mentionStart:0,mentionLength:N.length});return F.c(N)}static Y1f(N,P,U){N=Object.assign(new e,{displayName:N,email:P,userId:U});return F.c(N)}static bFa(N,P,U=null){return F.c(W.Qog(N,P,U,null))}static Qog(N,
P,U=null,Q=null){N=Object.assign(new E.a,{neighborhood:N,mentionStart:0,mentionLength:N?N.length:0});return Object.assign(new C.a,{selection:N,userIntent:Q,entryPoint:P,launchData:U})}static fHl(N,P){return W.bFa(N,W.ZGh(P))}static ZGh(N){switch(N){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static rjk(){return!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.getBooleanAppSetting("IsGoLocalEnvironment")}static ZEb(){const N=
m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Ea("SovereignEnvironmentName"):null;return!!N&&0<N.length}static isEnterpriseUser(){const N=m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Ea("HostAuthType"):null;return!!N&&"aad"===N.toLowerCase()||"external"===N&&W.Wue()}static V9e(N){return N.u9l&&!W.ZEb()}static Mpk(){const N=m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Ea("UiHostIntegrationType"):"";return!!m.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===N&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static U9e(N){return N.iBa&&N.umj&&(N.lAc||N.jAc||N.oYa)&&!W.Mpk()&&W.isEnterpriseUser()&&!W.ZEb()}static V$(){return m.AFrameworkApplication.fa?m.AFrameworkApplication.LAa||m.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupEnableNativePane"):m.AFrameworkApplication.LAa}static SG(N){return!N||W.OFg(N.Mf)}static OFg(N){return!N||!N.trim().length}static RDd(N){if(!N)return 0;const P=Math.pow(10,5);return Math.round(N*P)/P}static kam(){var N=new Date;return N?new Date(N.getUTCFullYear(),
N.getUTCMonth(),N.getUTCDate(),N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds(),N.getUTCMilliseconds()):null}static Fle(N){return(W.kam().getTime()-(new Date(N)).getTime())/1E3}static mGg(N){switch(N){case r.a.Xne:case w.a.adg:case A.a.Byg:case D.a.mjh:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return N.startsWith(W.hEd)||
N.startsWith(W.lgf)||N.startsWith(W.R_h)||N.startsWith("PeopleSuggestion")||N.startsWith("FileSuggestion")||N.startsWith("FindInDocumentSuggestion")||N.startsWith("NotesSuggestion")||N.startsWith("OnenoteNotesSuggestion")||N.startsWith("SmartLookupFromTellMe")||N.startsWith("GetHelpFromTellMe")||N.startsWith("GetHelpWithDescriptionFromTellMe")||N.startsWith("AddinSuggestion")||N.startsWith("OfficeScripts")?!0:!1}static Ohe(N,P){const U=[];Array.add(U,new y.a(400,N));Array.add(U,new y.a(200,P));N=
{};N.parts=U;return JSON.stringify(N)}static zVa(N){const P=N.indexOf("<b0>"),U=N.lastIndexOf("</b0>"),Q=[];Array.add(Q,new y.a(400,N.substring(0,P)));Array.add(Q,new y.a(600,N.substring(P+4,U)));Array.add(Q,new y.a(400,N.substring(U+5,N.length)));N={};N.parts=Q;return JSON.stringify(N)}static Zpg(N){const P=W.Fle(N);return 60>P?CommonUIStrings.l_TimeSince_SecsAgo:3600>P?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(P/60).toString()):86400>P?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(P/3600).toString()):172800>P?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(N)).localeFormat("MMMM dd, yyyy"))}static Xwj(N){const P=Array(N.length);for(let U=0;U<N.length;U++)P[U]=N[U].commandId;return P}static Wue(){if("Dev Box"===m.AFrameworkApplication.fa.Ea("StatusBarEnvironmentNameToUse"))return!0;let N=m.AFrameworkApplication.fa.Ea("UserPrincipalName");N=K.b(N)?"":H.a.Dg(N);const P=m.AFrameworkApplication.fa.du("TellMeIntEnabledForFeatureCrew")?
m.AFrameworkApplication.fa.hz("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(P,N)&&"inner"===m.AFrameworkApplication.fa.Ea("Microsoft365Ring")}static MCj(N){switch(W.V_c(N)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static qNj(N){N=W.V_c(N);switch(N){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return N}}static V_c(N){switch(N.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static vy(){return B.a.iV&&!B.a.Fk}}W.vDd=9E5;Object(L.a)(W,"TellMeUtils",null,[])},1086:function(L,V,d){L=d(0);var k=d(18),e=d(145),n=d(685),r=d(391),w=d(268),D=d(457),y=d(159),m=d(174),C=d(173),E=d(116),F=d(108);class B{constructor(ha){this.vb=ha;this.MLc=this.fle()}hF(){return"Add-ins"}CM(){return 0===this.vb.pr?
0:1===this.vb.pr?1:3}AC(ha,ka){ha=new C.a(ha);ka.oo(ha)}BWa(ha,ka,ca){let ia;ia=this.vb.gJ?new m.a(29):new m.a(27);ia.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ca&&this.L1l(ha.Mf,ka,ia)}L1l(ha,ka,ca){const ia=[];let oa;oa=this.vb.Gdk?this.vb.gJ&&this.vb.OSa?F.a.zVa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,ha)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,ha):this.vb.Hdk?this.vb.gJ&&this.vb.OSa?F.a.zVa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,
ha)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,ha):this.vb.gJ&&this.vb.OSa?F.a.zVa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,ha)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,ha);this.vb.wfa?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",oa)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ha))):(ia.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
oa)),ia.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ha)),appChrome.api.dispatch(ia));ca.qt(new y.a("LaunchAddinDialogFromTellMe",29));ka.jr(ca)}fle(){const ha=[];this.vb.f6c&&Array.add(ha,"Addin");return ha}}Object(L.a)(B,"AddinStoreResultsProvider",null,[1132]);var H=d(1018),K=d(343),A=d(392),W=d(1019),N=d(1051),P=d(1020),U=d(456),Q=d(25),G=d(35),Y=d(103);d.d(V,"a",function(){return ba});class ba{constructor(ha,ka,ca){this.TRa=this.d1b=this.e1b=this.sLc=!1;this.yJ=
null;this.HT=-1;this.oDa=this.F1b=this.eSa=this.N8a=null;this.vyf=this.xyf=0;this.vb=ha;const ia=F.a.V$();this.bQa=ka||[];this.Bi=Q.AFrameworkApplication.Me;this.KFf=ha.hWe;this.f1b=ha.gWe;this.qLc=ia&&this.rob();this.rLc=ia&&this.sob();this.MFf=ia&&this.tob();this.uLc=this.ZRb();this.tVd=this.YRb();if((ka=ha.Acf&&F.a.U9e(ha))||ha.c5)this.N8a=new N.a(ha),this.sLc=ha.jAc;ka&&(this.e1b=ha.lAc,this.d1b=ha.oYa,this.TRa=this.sLc&&this.Gt("File")||this.e1b&&this.Gt("People")||this.d1b&&this.Gt("Notes"));
this.pLc=this.aZl();this.g1b=ha.Trc;this.tLc=this.pZl();this.sVd=this.$Yl();this.iub=this.jAd();this.VBa=this.gPj();this.cof=new H.a(ha);this.Ofi=new W.a(ha);this.Tpi=new P.a(ha);this.x$h=new B(ha);this.u0b=ca;this.t8a=new n.a;this.g1b&&(this.cof=new H.a(ha));ha.c5&&(this.sVd=this.tLc=this.g1b=this.TRa=this.d1b=this.e1b=this.tVd=this.uLc=this.MFf=this.rLc=this.qLc=this.f1b=!1,Q.AFrameworkApplication.fa&&this.Gt("File")&&this.PQh()||this.iub)&&(ha=this.t8a.Ile("Search",Q.AFrameworkApplication.fa.Ea("TellMeServiceAuthEndpointForSearch")),
this.A9b(ha,"TellMeService",!0),ha=this.t8a.Ile("SmartLookup",Q.AFrameworkApplication.fa.Ea("SmartLookupShredderServiceEndpoint")),this.A9b(ha,"Shredder",!1));Q.AFrameworkApplication.fa&&this.TRa&&this.Gt("File")&&this.PQh()&&(ha=this.t8a.Ile("Search",Q.AFrameworkApplication.fa.Ea("TellMeServiceAuthEndpointForSearch")),this.A9b(ha,"TellMeService",!0))}Gt(ha){return Array.contains(this.bQa,ha)?!0:!1}hF(){return"TellMeService"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:this.Gt("Command")||this.Gt("Recommended")?
2:3}dPj(ha){let ka="";if(!ha&&this.Gt("Command")&&this.vb.uwe){ka+="CommandSearch_DLIS,";var ca=this.vb.CXh;0<ca.length&&(ka+=ca+",")}ha&&this.Gt("Recommended")&&this.f1b&&(ca=this.dSj(),0<ca.length&&(ka+=ca+","));!ha&&this.Gt("Help")&&(ha=this.vb.BXh,0<ha.length&&(ka+=ha+","));this.vb.c5&&this.oDa&&0<this.oDa.length&&(ka+="IsRecallEnabled_true,");(this.vb.xzb||this.vb.BWc||this.vb.c5)&&this.TRa&&(ka+="IsGenerateSlidesEnabled_true,");0<ka.length&&(ka=ka.substr(0,ka.length-1));return ka}A9b(ha,ka,
ca){const ia=ca?this.xyf:this.vyf;if(!ia||window.performance.now()-ia>=F.a.vDd)if(ha)ca?this.xyf=window.performance.now():this.vyf=window.performance.now(),ha.then(oa=>{ca?this.F1b=oa:(this.oDa=oa,E.TellMeActor.instance.Gaf=oa)},oa=>{E.TellMeActor.instance.Qd.onError("TellMeServiceProvider:FetchTokenForService_"+ka,"tellMeServiceToken promise rejected: "+oa)});else if(E.TellMeActor.instance.Qd)E.TellMeActor.instance.Qd.onError("TellMeServiceProvider:FetchTokenForService_"+ka,"undefined token promise")}AC(ha,
ka,ca,ia=e.a.hq,oa=null){const sa=new C.a(ha);ca=F.a.SG(ha);this.Gt("File")&&(this.TRa||this.vb.c5)&&this.A9b(this.t8a.hPj(),"TellMeService",!0);(this.Gt("File")&&this.vb.c5||this.Gt("ActionAI")&&this.iub)&&this.A9b(this.t8a.IMj(),"Shredder",!1);var Ca=this.TRa&&!!this.F1b;const Ta=this.vb.c5&&!!this.oDa;var R=Ca||Ta||ca&&this.Gt("Recommended")&&this.f1b;Ca=Ca||Ta||!ca&&(this.KFf&&this.Gt("Command")||this.qLc&&this.Gt("Answer")||this.rLc&&this.Gt("Definition")||this.tVd&&this.Gt("Image")||this.g1b&&
this.Gt("Help")||this.uLc&&this.Gt("WolframAnswer")||this.tLc&&this.Gt("Template")||this.sVd&&this.Gt("Addin"));if(R||Ca)if(this.eSa=ia,ia={"Content-Type":"application/json",Accept:"application/json"},ia["X-Office-Version"]=Q.AFrameworkApplication.buildVersion,ia["X-Office-Application"]=Q.AFrameworkApplication.fa.Ea("Application"),ia["X-Office-Platform"]="WAC",ia["X-TellMe-SqmUserId"]=Q.AFrameworkApplication.fa.Ea("LoggableUserId")||"",ia["X-TellMe-SessionId"]=E.TellMeActor.instance.s2c(),this.F1b&&
(ia.Authorization="Bearer "+this.F1b),this.oDa&&0<this.oDa.length&&(ia["X-TellMe-ShredderToken"]="Bearer "+this.oDa),R=this.dPj(ca),0<R.length&&(ia["X-TellMe-Flights"]=R),R=[],!ca&&this.Gt("Answer")&&this.qLc&&(oa?Array.contains(oa,9):1)&&Array.add(R,"Answer"),!ca&&this.Gt("Command")&&this.KFf&&!K.CommandResultsUtility.Aue(ha.Mf)&&(oa?Array.contains(oa,17):1)&&Array.add(R,"Command"),!ca&&this.Gt("Definition")&&this.rLc&&(oa?Array.contains(oa,10):1)&&Array.add(R,"Definition"),!ca&&this.Gt("Help")&&
this.g1b&&(oa?Array.contains(oa,8):1)&&Array.add(R,"Help"),!ca&&this.Gt("WolframAnswer")&&this.uLc&&(oa?Array.contains(oa,12):1)&&Array.add(R,"WolframAnswer"),ca&&this.Gt("Recommended")&&this.f1b&&!E.TellMeActor.instance.iCc&&(oa?Array.contains(oa,18):1)&&Array.add(R,"Recommended"),!ca&&this.Gt("Image")&&this.tVd&&(oa?Array.contains(oa,19):1)&&Array.add(R,"Image"),this.F1b&&this.TRa&&(oa?Array.contains(oa,14)||Array.contains(oa,15)||Array.contains(oa,20):1)&&(this.N8a.d3(),this.sLc&&this.Gt("File")&&
Array.add(R,"File"),this.e1b&&this.Gt("People")&&Array.add(R,"People"),this.d1b&&this.Gt("Notes")&&Array.add(R,"Notes")),this.oDa&&0<this.oDa.length&&this.vb.c5&&(oa?Array.contains(oa,15):1)&&(this.N8a.d3(),this.Gt("File")&&Array.add(R,"File")),!ca&&this.Gt("Template")&&this.tLc&&(oa?Array.contains(oa,23):1)&&Array.add(R,"Template"),!ca&&this.Gt("Addin")&&this.sVd&&(oa?Array.contains(oa,27):1)&&Array.add(R,"Addin"),!ca&&this.Gt("ActionAI")&&this.iub&&(oa?Array.contains(oa,25):1)&&Array.add(R,"ActionAI"),
R.length){ia["X-TellMe-SuggestionTypes"]=R.join(",");ia["X-TellMe-Culture"]=Q.AFrameworkApplication.uiCulture;ia["X-TellMe-ProcessSessionId"]=Q.AFrameworkApplication.userSessionId;var Ha=this.yJ=Y.a.create().toString();ia["Client-Request-Id"]=Ha;var da=window.performance.now();this.ola();this.HT=window.setTimeout(()=>{if(Ha===this.yJ){this.yJ="";this.HT=-1;ka.oo(sa);const Ba={};Ba[r.a.provider]=this.hF();Ba[r.a.Rlb]=ha.Z1a;E.TellMeActor.instance.Qd.TI(w.a.Cef,this.u0b,Ba)}},this.u0b);this.Bi.Tj(this.VBa,
2,this.fPj(ha.Mf),ia,!1,0,Ba=>{this.Tkb(Ba,ha,ka,Ha,da,oa)},Ba=>{this.Ekb(Ba,ha,ka,Ha,da)},null,null,!1,4E3,this.iub?3E4:6E3)}else E.TellMeActor.instance.Qd.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ka.oo(sa);else ka.oo(sa)}ola(){-1!==this.HT&&(window.clearTimeout(this.HT),this.HT=-1)}Tkb(ha,ka,ca,ia,oa,sa){const Ca=new C.a(ka);if(ia===this.yJ){this.ola();E.TellMeActor.instance.Qd.r7(ka.Mf.length,this.bQa.join(","),ha.data.Ke.toString(),Math.round(window.performance.now()-
oa),U.a.hq,!0,D.a.Ova);ia=ha.data.Ud;ha=null;try{ha=G.b(ia)}catch(za){E.TellMeActor.instance.Qd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+za);return}ia=F.a.SG(ka);if("Groups"in ha&&ha.Groups){var Ta=ha.Groups;for(var R of Ta)if("GroupType"in R&&"Suggestions"in R&&R.Suggestions)if("Commands"===R.GroupType&&(sa?Array.contains(sa,17):1)||"Recommended"===R.GroupType&&(sa?Array.contains(sa,18):1)){var Ha=(Ta="Recommended"===R.GroupType)?"DLIS":"NaiveBayes";"Source"in
R&&R.Source&&(Ha=R.Source);var da=R.Suggestions;new k.a;var Ba=[];for(const za of da)this.$sk(za)&&(da=za.Type,("Command"===da||Ta&&"Recommended"===da)&&Ba.push(new A.a(za.CommandId,za.Score)));K.CommandResultsUtility.J$c(Ba,!ka.Mf.trim().length,R.GroupType,Ha);Ha=E.TellMeActor.instance.PT;da=[];for(const za of Ba)Ta&&Ha&&Ha.v6d(za.commandId)||da.push(za);Ba=K.CommandResultsUtility.Xac(ka,da,this.vb,null,null,null,Ta?18:17,0);0<Ba.results.length&&(this.eSa!==e.a.contextMenu&&(Ba.displayName=Ta?CommonUIStrings.l_TellMeTryCommandTitle:
CommonUIStrings.l_TellMeCommandProviderTitle),Ca.jr(Ba))}else if("Answer"===R.GroupType){da=R.Suggestions;Ta=null;Ba=2147483647;Ha="";for(const za of da)if(this.Xsk(za))if(Ha=za.Type,da=this.HBb(Ha),"Answer"===Ha&&this.qLc){Ta=this.S1f(Ha,za,ka.Mf);break}else da&&da<Ba&&(Ba=da,Ta=this.S1f(Ha,za,ka.Mf));Ba=F.a.fHl(ka.Mf,Ha);Ta&&(sa?Array.contains(sa,Ta.type):1)&&(Ha=[],this.pLc?this.vb.wfa?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ta.value,Ta.aL)),E.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ta.value,
Ta.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ta.value,Ba))):(Ha.push(appChrome.actions.setControlLabel(Ta.value,Ta.aL)),Ha.push(appChrome.actions.updateCompoundButtonDescription(Ta.value,Ta.description)),Ha.push(appChrome.actions.setCompoundButtonCommandValueId(Ta.value,Ba)),appChrome.api.dispatch(Ha)):this.vb.wfa?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ta.value,Ta.aL+" - "+Ta.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ta.value,
Ba))):(Ha.push(appChrome.actions.setControlLabel(Ta.value,Ta.aL+" - "+Ta.description)),Ha.push(appChrome.actions.setButtonCommandValueId(Ta.value,Ba)),appChrome.api.dispatch(Ha)),Ba=this.O6i(Ta.type),Ba.qt(Ta),Ca.jr(Ba))}else"Help"===R.GroupType&&R.Suggestions.length&&(sa?Array.contains(sa,8):1)?this.g1b&&(Ta=this.cof.BWa(ka,R.Suggestions))&&0<Ta.results.length&&Ca.jr(Ta):"Template"===R.GroupType&&(sa?Array.contains(sa,23):1)?(Ta=R.Suggestions)&&0<Ta.length&&this.Tpi.BWa(ka,Ca,Ta):"Addin"===R.GroupType&&
(sa?Array.contains(sa,27):1)?(Ta=R.Suggestions)&&0<Ta.length&&this.x$h.BWa(ka,Ca,Ta):"ActionAI"===R.GroupType&&(sa?Array.contains(sa,25):1)?(Ba=R.Suggestions,Ta=[],new m.a(25),Ba&&1===Ba.length&&(Ha=Ba[0])&&Ha.CommandId&&(Ba=Ha.CommandId,Ta.push(new A.a(Ba,"Score"in Ha?Ha.Score:0)),Ta=K.CommandResultsUtility.Xac(ka,Ta,this.vb,null,null,null,25,0),Ta.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,Ca.jr(Ta))):"Substrate"===R.GroupType&&this.TRa&&"Type"in R?"File"===R.Type&&this.sLc&&(sa?
Array.contains(sa,15):1)?(Ta=this.N8a.yhe(R.Suggestions,ia,this.eSa))&&0<Ta.results.length&&(this.n7c()&&(Ba=new y.a("GenerateSlidesFromTellMe",30,"",null,1),Ta.qt(Ba)),Ca.jr(Ta)):"People"===R.Type&&this.e1b&&(sa?Array.contains(sa,14):1)?(Ta=this.N8a.Cmg(R.Suggestions,ia,this.eSa))&&0<Ta.results.length&&Ca.jr(Ta):"Notes"===R.Type&&this.d1b&&(sa?Array.contains(sa,14):1)&&(Ta=this.N8a.Wlg(R.Suggestions,ia,ka))&&0<Ta.results.length&&Ca.jr(Ta):"Recall"===R.GroupType&&this.vb.c5&&"Type"in R&&"IntentService"===
R.Type&&(sa?Array.contains(sa,15):1)&&(Ta=this.N8a.yhe(R.Suggestions,ia,this.eSa))&&0<Ta.results.length&&(this.n7c()&&(Ba=new y.a("GenerateSlidesFromTellMe",30,"",null,1),Ta.qt(Ba)),Ca.jr(Ta));else E.TellMeActor.instance.Qd.onError("OnSuccessCallBack","GroupType"in R?"Invalid group suggestions found for "+R.GroupType:"Invalid group found")}if(ha.Intents){R=ha.Intents;for(const za of R)this.yye(za)&&("Image"===za.GroupType&&za.ConfidenceScore>za.ConfidenceThreshold&&(sa?Array.contains(sa,19):1)?this.Ofi.BWa(ka,
Ca,0,za):"Commands"===za.GroupType&&za.ConfidenceScore<za.ConfidenceThreshold&&(sa?Array.contains(sa,17):1)&&(R=new m.a(17),Ca.jr(R)))}ca.oo(Ca);E.TellMeActor.instance.Qd.r7(ka.Mf.length,this.bQa.join(","),"",Math.round(window.performance.now()-oa),"",!0,D.a.provider)}}Ekb(ha,ka,ca,ia,oa){const sa=new C.a(ka);ia===this.yJ&&(this.ola(),E.TellMeActor.instance.Qd.r7(ka.Mf.length,this.bQa.join(","),ha.data.Ke.toString(),Math.round(window.performance.now()-oa),U.a.hq,!1,D.a.Ova));ca.oo(sa)}HBb(ha){switch(ha){case "Entity":return this.MFf?
3:0;case "Definition":return this.rLc?5:0;case "WolframAnswer":return this.uLc?2:0;default:return 0}}S1f(ha,ka,ca){switch(ha){case "Answer":return new y.a(this.pLc?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ka.Title?ca:ka.Title,ka.Description,0);case "Entity":return new y.a(this.pLc?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ka.Title?ca:ka.Title,ka.Description,0);case "Definition":return new y.a(this.pLc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ka.Title?ca:ka.Title,
ka.Description,0);case "WolframAnswer":return new y.a("WolframForSearch",3,""===ka.Title?ca:ka.Title,ka.Description,0);default:return null}}O6i(ha){switch(ha){case 0:return new m.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new m.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new m.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new m.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new m.a(19,this.vb.TRb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}Xsk(ha){return"Type"in ha&&!!ha.Type&&""!==ha.Type&&"Description"in ha&&!!ha.Description&&""!==ha.Description}$sk(ha){return"Type"in ha&&!!ha.Type&&""!==ha.Type&&"CommandId"in ha&&!!ha.CommandId&&""!==ha.CommandId&&"Score"in ha&&!!ha.Score}yye(ha){if("GroupType"in ha&&ha.GroupType&&"ConfidenceScore"in ha&&"ConfidenceThreshold"in ha)return!0;E.TellMeActor.instance.Qd.onError("IsValidIntentGroup","Invalid intents found");return!1}fPj(ha){const ka=F.a.OFg(ha),ca={};ca.Query=ha;ka&&
this.f1b&&(this.Ylk()?ca.UserActionEvents=E.TellMeActor.instance.SHf:(ca.CommandClickedEvents=E.TellMeActor.instance.zJd,ca.CommandActionEvents=E.TellMeActor.instance.Lpf),ca.TellMeCommandClickMruEvents=E.TellMeActor.instance.gAf,ca.ContentType=E.TellMeActor.instance.uUc);this.tLc&&(ha={},ha.Application=this.vb.application,ca.TemplateInfo=ha);return G.c(ca)}rob(){return!!this.vb&&this.vb.rob||!!Q.AFrameworkApplication.za&&Q.AFrameworkApplication.za.mb.rob}sob(){return!!this.vb&&this.vb.sob||!!Q.AFrameworkApplication.za&&
Q.AFrameworkApplication.za.mb.sob}tob(){return!!this.vb&&this.vb.tob||!!Q.AFrameworkApplication.za&&Q.AFrameworkApplication.za.mb.tob}ZRb(){return!!this.vb&&this.vb.ZRb||!!Q.AFrameworkApplication.za&&Q.AFrameworkApplication.za.mb.ZRb}YRb(){return!!this.vb&&(this.vb.YRb||this.vb.gJ)}aZl(){return!!this.vb&&!this.vb.nYa}pZl(){return!!this.vb&&this.vb.ngc}$Yl(){return!!this.vb&&this.vb.Idk&&this.vb.Fdk}jAd(){return!!this.vb&&this.vb.jAd}pGg(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}qGg(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Ylk(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}n7c(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}PQh(){return!!Q.AFrameworkApplication.fa&&
Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}dSj(){return Q.AFrameworkApplication.fa?Q.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}gPj(){if(!Q.AFrameworkApplication.fa)return"";if(this.qGg())return Q.AFrameworkApplication.fa.Ea("TellMeServiceProdEndpointForSearch");if(this.pGg())return Q.AFrameworkApplication.fa.Ea("TellMeServiceEdogEndpointForSearch");if(F.a.Wue())return Q.AFrameworkApplication.fa.Ea("TellMeServiceIntEndpointForSearch");
let ha=Q.AFrameworkApplication.fa.Ea("TellMeServiceSearchEndpoint");ha&&""!==ha||(ha=Q.AFrameworkApplication.AXh);return ha}static o2f(ha,ka){if(ka)return new ba(ha,["Command","Recommended"],ha.fBj);ka=F.a.V$()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new ba(ha,ka,ha.Mog)}}Object(L.a)(ba,"TellMeServiceProvider",null,[1132])},116:function(L,V,d){d.r(V);L=d(0);var k=
d(1268),e=d(1267),n=d(7),r=d(19),w=d(1264),D=d(725),y=d(270);class m{constructor(Fb,Qb,hc,Pc,uc,zb){this.groupType=Fb;this.resultType=Qb;this.vcf=hc;this.kdb=Pc;this.Y$d=uc;this.resultIndex=zb}}Object(L.a)(m,"ClickLoggingInfo",null,[]);const C=Fb=>{const Qb=[];for(;Fb;)Array.add(Qb,"{ContextId:"+Fb.contextId+", IsGraphNodeContext:"+Fb.El+"}"),Fb=Fb.GF;Qb.reverse();return"{"+Qb.join(", ")+"}"};class E{constructor(){this.D$=this.sessionId=null}}Object(L.a)(E,"CorrelationRecord",null,[1188]);var F=d(268);
class B{constructor(Fb,Qb){this.provider=Fb;this.tEd=Qb}}Object(L.a)(B,"ExternalResultProvider",null,[]);class H{constructor(Fb,Qb){this.Id=null;this.TimeStamp=0;this.Id=Fb;this.TimeStamp=Qb}}Object(L.a)(H,"MRUControl",null,[]);var K=d(712),A=d(108),W=d(25),N=d(334);class P{constructor(Fb,Qb){this.eji=10;this.eX=[];this.Zja=[];this.wwf=this.vwf=!1;this.h_b=this.g_b="";this.AIc=Qb;this.vb=Fb}bac(){!this.vwf&&this.vb&&(this.g_b="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.vb.application,this.eX=this.Igg(),
this.vwf=!0);return this.eX}lJj(){!this.wwf&&this.vb&&(this.h_b="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.vb.application,this.Zja=this.Igg(!0),this.wwf=!0);return this.Zja}Wrk(Fb){return Fb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===Fb||"TryOfficeUpsell"===Fb}Jue(Fb){return this.iek(Fb)||this.Wrk(Fb)||A.a.mGg(Fb)?!1:!0}Cti(Fb){Fb=Fb.ControlId;this.Jue(Fb)&&(Fb=this.g3e(Fb),this.Lzl(Fb),this.xVk(),Array.insert(this.eX,0,new H(Fb,Date.now())),this.g_b.length&&(Fb=JSON.stringify(this.eX),
N.a.instance.setItem(this.g_b,Fb)))}Vz(Fb){this.wVk();Array.insert(this.Zja,0,new H(K.a[Fb],Date.now()));this.h_b.length&&(Fb=JSON.stringify(this.Zja),N.a.instance.setItem(this.h_b,Fb))}Igg(Fb=!1){if(!this.eX.length){var Qb=Fb?N.a.instance.getItem(this.h_b):N.a.instance.getItem(this.g_b);if(!Qb||""===Qb)return Fb?this.Zja:this.eX;let hc=null;try{hc=JSON.parse(Qb)}catch(Pc){this.MTi(Fb),hc=null}if(!hc||!hc.length||10<hc.length)return Fb?this.Zja:this.eX;Qb=0;for(const Pc of hc)if(Fb||this.vb.x9c(Pc.Id)&&
this.Jue(Pc.Id))if(Fb?Array.insert(this.Zja,Qb++,Pc):Array.insert(this.eX,Qb++,Pc),Qb===this.AIc)break}return Fb?this.Zja:this.eX}v6d(Fb){Fb=this.g3e(Fb);for(const Qb of this.eX)if(Qb.Id===Fb)return!0;return!1}MTi(Fb=!1){N.a.instance.setItem(Fb?this.h_b:this.g_b,"")}Ggk(Fb){Fb=this.g3e(Fb.ControlId);return this.Jue(Fb)?this.v6d(Fb):!1}Lzl(Fb){if(0<this.eX.length){let Qb=0;for(const hc of this.eX){if(hc.Id===Fb){Array.removeAt(this.eX,Qb);break}Qb++}}}g3e(Fb){return"Excel"===this.vb.application&&Fb.startsWith("m_excelWebRenderer_ewaCtl_")?
Fb.substr(26,Fb.length):Fb}xVk(){this.eX.length===this.AIc&&Array.removeAt(this.eX,this.eX.length-1)}wVk(){this.Zja.length===this.eji&&Array.removeAt(this.Zja,this.Zja.length-1)}iek(Fb){Fb=Fb.split("|");let Qb="";if(6<=Fb.length)Qb=Fb[0];else if(3<=Fb.length){if("3"===Fb[0])return!0;Qb=Fb[1]}return Qb.startsWith("WA")}static createInstance(Fb){let Qb=3;W.AFrameworkApplication.fa&&(Qb=W.AFrameworkApplication.fa.tc("TellMeMaxRecommendedResultsToReturn",3));return new P(Fb,Qb)}}Object(L.a)(P,"MruControlsManager",
null,[1187]);class U{constructor(Fb){this.Y7a=Fb}lM(Fb,Qb){let hc;return Fb.aL&&(hc=this.Y7a[Fb.value])?hc.lM(Fb,Qb):(hc=this.thg(Fb.value))?hc.lM(hc.EYk,Qb):null}OHj(Fb,Qb){if(Fb=this.Y7a[Fb])for(const hc of Qb)if(Qb=A.a.getParameter(hc),Qb.key===Fb.rdl)return Qb.value;return null}S0k(Fb){(Fb=this.thg(Fb))&&Fb.Q0k()}thg(Fb){const Qb=Fb.indexOf(A.a.Zsh);return 0<Qb?this.Y7a[Fb.substring(0,Qb)]:null}}Object(L.a)(U,"ParameterizedCommandManager",null,[1185]);var Q=d(305);class G{constructor(Fb,Qb){this.Mf=
Fb;this.Z1a=Qb}}Object(L.a)(G,"TellMeQuery",null,[]);var Y=d(709);class ba{constructor(Fb,Qb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Fb;this.TimeElapsedSinceClick=Qb}}Object(L.a)(ba,"CommandClickedEvent",null,[]);var ha=d(121);class ka{constructor(Fb,Qb){this.lki=Fb;this.Kda=Qb}oo(Fb){this.lki(ha.b(Fb.query)?"":Fb.query.Mf,Fb.zl,Fb.attributes,this.Kda,Fb.zEb)}}Object(L.a)(ka,"ResultsUpdatedCallback",null,[1180]);class ca{constructor(Fb,Qb,hc,Pc,uc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=
0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Fb;this.TimeElapsedSinceClick=hc;this.CommandSurface=Pc;this.CommandId=Qb;this.TerminalParentControlId=uc}}Object(L.a)(ca,"UserActionEvent",null,[]);var ia=d(18);class oa{constructor(Fb,Qb){this.menuModel=Fb;this.YGh=Qb}}Object(L.a)(oa,"GeneratedMenuModel",null,[]);class sa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(L.a)(sa,"MenuModel",null,[]);class Ca{constructor(Fb,
Qb,hc){this.vb=Fb;this.Y7a=Qb;this.IMc=hc}atj(Fb,Qb,hc){const {TellMeActor:Pc}=d(116);let uc=0;const zb=new sa,ac=[];let Jb="";zb.sections=[];let Yc=new ia.a;const dd=!!this.vb&&this.vb.nYa;var id=!!this.vb&&this.vb.SRb||W.AFrameworkApplication.za.mb.SRb;for(const Nb of Fb){Fb=0;dd||(Yc=new ia.a);const nc=new ia.a;let Kc=Nb.displayName;for(const xd of Nb.results){if(0<=xd.value.indexOf(A.a.Naf)){if(xd.aL){var Cc=this.Y7a[xd.value];if(Cc&&xd.value.endsWith(A.a.Naf)){if("FindParameterized"!==xd.value&&
!id){const Xc=[];Xc.push(appChrome.actions.setControlLabel(xd.value,Cc.SDj(xd)));Xc.push(appChrome.actions.setButtonCommandValueId(xd.value,Cc.$wj(xd)));appChrome.api.dispatch(Xc)}Cc=xd.value.replace(A.a.Naf,"");Yc.remove(Cc)?Fb--:nc.add(Cc);Yc.add(xd.value);Fb++}}}else switch(xd.type){case 5:nc.contains(xd.value)||(Yc.add(xd.value),Fb++);break;case 7:Yc.add(xd.aL);Fb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Yc.add(xd.value),
Fb++}13===Nb.groupType&&(Kc=A.a.V$()?0<Qb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Qb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Qb));21===Nb.groupType&&(Kc=CommonUIStrings.l_LearningUILiveText)}uc+=Fb;""!==Kc&&0<Fb&&(Jb+=" , "+Fb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Kc+" , ");0<Yc.count&&!dd&&(Fb=appChrome.api.menuSection(Yc.toArray(),Nb.displayName,null,Q.a[Nb.groupType]),ac.push(Fb))}id=
null;0<uc&&(id=0<Qb.length?1!==uc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,uc,Qb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Qb):1!==uc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,uc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,dd?(Qb=appChrome.api.menuSection(Yc.toArray(),"",null,null),ac.push(Qb)):id+=Jb);hc&&(this.vb.wfa?Pc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(id)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(id)));zb.sections=ac;return new oa(zb,uc,[])}static get cbe(){return Ca.Yrf||(Ca.Yrf=new oa(Object.assign(new sa,{sections:[]}),0,[]))}}Ca.Yrf=null;Object(L.a)(Ca,"TellMeMenuDefintionGenerator",null,[]);var Ta;(function(Fb){Fb[Fb.rsm=0]="TellMeControlActivated";Fb[Fb.tsm=1]="TellMeQueryExecuted";Fb[Fb.vsm=2]="TellMeResultsRendered";Fb[Fb.ssm=3]="TellMeControlDeactivated"})(Ta||(Ta={}));Object(L.b)("PerformanceMarker",Ta);var R;
(function(Fb){Fb[Fb.xsm=0]="TellMeTimeToRender";Fb[Fb.wsm=1]="TellMeSessionLength";Fb[Fb.usm=2]="TellMeResultTriageTime"})(R||(R={}));Object(L.b)("PerformanceMeasure",R);class Ha{mark(Fb){window.performance.mark(Ta[Fb])}measure(Fb,Qb,hc){const {TellMeActor:Pc}=d(116);try{window.performance.measure(R[Fb],Ta[Qb],Ta[hc])}catch(uc){Pc.instance.Qd.onError("TellMePerformance:Measure","error measuring "+R[Fb])}}CAe(Fb,Qb,hc){const {TellMeActor:Pc}=d(116);Pc.instance.Qd.LAe(Qb,hc,Fb,this.kFj(Fb))}wTa(Fb){for(const Qb of Fb)window.performance.clearMarks(Ta[Qb])}clearMeasures(Fb){for(const Qb of Fb)window.performance.clearMeasures(R[Qb])}kFj(Fb){let Qb=
0;(Fb=this.Ztj(Fb))&&0<Fb.length&&(Qb=Fb[Fb.length-1].duration);return Qb}Ztj(Fb){return window.performance.getEntriesByName(R[Fb],"measure")}}Object(L.a)(Ha,"TellMePerformance",null,[]);var da=d(457),Ba=d(456),za=d(35);class Aa{constructor(Fb){this.Rpi=Fb}NVe(Fb,Qb,hc){const {TellMeActor:Pc}=d(116);Pc.instance.Qd.r7(Qb,Ba.a.iOb,Fb.data.Ke.toString(),Math.round(window.performance.now()-hc),Ba.a.iOb,!0,da.a.Ova);Fb=za.b(Fb.data.Ud);Qb=-1;Fb.Index&&(Qb=Fb.Index);Pc.instance.Qd.hDk(Qb,this.Rpi)}Wqc(Fb,
Qb,hc){const {TellMeActor:Pc}=d(116);Pc.instance.Qd.r7(Qb,Ba.a.iOb,Fb.data.Ke.toString(),Math.round(window.performance.now()-hc),Ba.a.iOb,!1,da.a.Ova)}oJj(Fb){if(Fb&&""!==Fb.trim()){const hc=window.performance.now(),Pc=W.AFrameworkApplication.xXh;var Qb={};Qb.Text=Fb;Qb.IsFileHash="false";Qb=za.c(Qb);W.AFrameworkApplication.Me.Tj(Pc,2,Qb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,uc=>{this.NVe(uc,Fb.length,hc)},uc=>{this.Wqc(uc,Fb.length,hc)},null,null,!1,4E3,6E3)}}}Object(L.a)(Aa,
"TellMeQueryIndexCallback",null,[]);var na=d(145);class la{constructor(Fb,Qb,hc){this.xml=Fb;this.YGh=Qb;this.Qcj=hc}}Object(L.a)(la,"GeneratedMenuXml",null,[]);var va=d(1013),Pa=d(46);class Qa{constructor(Fb,Qb){this.CEc=Fb||{};this.PCa=Qb}get Umb(){return 5}lM(Fb,Qb=null){return this.PCa.lM(Fb,Qb)||this.aKi(Fb.value)}aKi(Fb){return Qa.$Ji(Fb,this.CEc[Fb]||null)}static $Ji(Fb,Qb=null){Fb=String.format('<ClonedControl Id="{0}" ',Fb);for(const uc in Qb){var hc=uc,Pc=Qb[uc];Pc=Pc?Pa.a.Fe(Pc.toString()):
"";Fb+=String.format('{0}="{1}" ',hc,Pc)}return Fb+"/>"}}Object(L.a)(Qa,"CommandMenuItemFactory",null,[1170]);var Ua=d(132);class Ya{constructor(){this.nei=CommonUIStrings.l_FindInDocumentText}get Umb(){return 8}lM(Fb){var Qb=Fb.aL;Fb=Pa.a.Fe(Fb.value);const hc=Pa.a.Fe(Qb);Qb=Pa.a.Fe(String.format(this.nei,Qb));return this.rsj(Fb,hc,Qb)}rsj(Fb,Qb,hc){return Ua.a(Fb,"1540292897",hc,A.a.Cnj,null,Qb,hc,null,null)}}Object(L.a)(Ya,"FindInDocumentMenuItemFactory",null,[1170]);var Ea=d(1014),La=d(1015);
class xb{constructor(Fb=null){this.cgi=Fb||CommonUIStrings.l_InsightsButtonText}get Umb(){return 10}lM(Fb){var Qb=Fb.aL;Fb=A.a.V$()?A.a.bFa(Qb,1):A.a.q8d(Qb);Qb=String.format(this.cgi,Qb);return this.Isj(Fb,Qb)}Isj(Fb,Qb){return Ua.a(La.a.Byg,A.a.V$()?"1914896509":"3317204163",Pa.a.Fe(Qb),A.a.Ybk,null,Pa.a.Fe(Fb),Pa.a.Fe(Qb),null,null)}}Object(L.a)(xb,"InsightsMenuItemFactory",null,[1170]);var dc=d(1016);class gb{get Umb(){return 7}lM(Fb){const Qb=Object(w.a)(Y.a,Fb);return this.gtj(Pa.a.Fe(Fb.value),
Qb.id)}gtj(Fb,Qb){return Ua.a(Qb,"1404166600",Fb,null,null,Fb,Fb,null,null)}}Object(L.a)(gb,"TryQueryMenuItemFactory",null,[1170]);class gc{constructor(Fb){this.isa=[];this.vb=Fb}dBj(Fb){for(const Qb of this.isa)if(Qb.Umb===Fb)return Qb;return null}q2a(Fb){this.isa.push(Fb)}Yvl(Fb){this.q2a(new Qa(this.vb.Q_i,Fb));this.q2a(new dc.a(this.vb.b0k));this.q2a(new va.a(this.vb.fLl,this.vb.eLl,this.vb.G9l,this.vb.s2j,this.vb.RXl));this.q2a(new xb);this.q2a(new Ya);this.q2a(new Ea.a);this.q2a(new gb)}}Object(L.a)(gc,
"MenuItemFactoryRegistry",null,[]);var Ac=d(159);class $b{constructor(Fb,Qb){this.vb=Fb;this.Mzf=new gc(this.vb);this.Mzf.Yvl(Qb)}btj(Fb,Qb){let hc=0;const Pc=[],uc=[];for(const ac of Fb){Fb=A.a.Mdf;var zb=[];for(const Jb of ac.results){const Yc=this.Mzf.dBj(Jb.type).lM(Jb,Qb);Fb=A.a.Mdf;zb.push(Yc);if(13===Jb.type||14===Jb.type)Fb="Menu32";17===Jb.type&&(Fb="MenuTellMeExtended");Jb.groupType=ac.groupType;uc.push(Object(w.a)(Ac.a,Jb))}hc=hc?hc:zb.length;zb=Ua.c("TellMeDropdownControls",zb);Fb=Ua.e("TellMeDropdownMenuSection",
zb,Fb,ac.displayName);Pc.push(Fb)}Qb=Ua.f(Pc,"LookupDropdownMenu");return new la(Qb,hc,uc)}static get vWc(){return $b.Zrf||($b.Zrf=new la(Ua.f([],"LookupDropdownMenu"),0,[]))}}$b.Zrf=null;Object(L.a)($b,"TellMeXmlGenerator",null,[]);class jc{}jc.aZk="MRU";jc.test="Test";Object(L.a)(jc,"ActionType",null,[]);var pb=d(391),$a=d(1023),zc=d(104);class rb{constructor(Fb,Qb,hc,Pc,uc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Fb;this.IsEnabled=
Qb;this.ResultType=K.a[hc];this.SubResultType=$a.a[Pc];this.OptionalData=uc?zc.a.toJSON(uc):null}}Object(L.a)(rb,"ResultInfo",null,[]);var ib=d(165),Vb=d(136),Od=d(182);class jb{constructor(Fb,Qb=null){this.svf="TellMeWAC.";this.Tki=Fb;this.vqi=Qb}Nqa(Fb,Qb,hc){Qb=ib.a.YH(Qb);Fb=ib.a.F8d(Fb,this.Tki,this.vqi,hc,Qb);Vb.a.Nqa(Fb,this.svf)}oNa(Fb,Qb,hc=0){Qb=ib.a.YH(Qb);Vb.a.oNa(Object.assign(new Od.a,{name:Fb,dataFields:Qb,durationMs:hc}),this.svf)}}Object(L.a)(jb,"TellMeOtelLogger",null,[1208]);var Wb=
d(103);class qb{constructor(Fb,Qb,hc,Pc,uc,zb,ac){this.fX=this.k0=this.Ppf=null;this.t8=Fb;this.AWb=Qb;this.Nsa=hc;this.HQa=Pc;this.BCa=uc;this.Fhi=zb;this.fX=ac?ac:new jb(this.HQa?y.CuiHelper.Maf:y.CuiHelper.Wdf)}get Xp(){return this.HQa}get mqa(){return this.Nsa}dzd(Fb){this.Ppf=Fb;switch(Fb){case na.a.contextMenu:this.k0=na.a.contextMenu;break;default:this.k0=na.a.hq}}SHi(Fb,Qb){this.Nsa.D$||(this.Nsa.D$=Wb.a.create().toString(),this.HJg(Fb,!0,Qb))}R8f(Fb,Qb=!0){this.Nsa.D$&&this.Xzk(Fb,Qb);this.HQa&&
appChrome.api.updateTellMeCorrelationId("");this.Nsa.D$=null}HJg(Fb,Qb,hc){const {TellMeActor:Pc}=d(116),uc=this.JX(F.a.nDb);uc[pb.a.culture]=this.AWb;uc[pb.a.appName]=this.t8;uc[pb.a.context]=Fb;uc[pb.a.J8c]=this.BCa;uc[pb.a.Trk]=this.Fhi;uc[pb.a.sqk]=hc;uc[pb.a.qkk]=Qb;uc[pb.a.contentType]=Pc.instance.uUc;this.fX.Nqa(F.a.nDb,uc,this.Ppf);this.HQa&&appChrome.api.updateTellMeCorrelationId(this.Nsa.D$)}Xzk(Fb,Qb){const hc=this.JX(F.a.Hyg);hc[pb.a.Mej]=Fb;hc[pb.a.pkk]=Qb;this.fX.oNa(F.a.Hyg,hc)}gDk(Fb,
Qb,hc){let Pc=0;!hc&&0<Fb.length&&(Pc=Fb.trim().split(" ").length);const uc=this.JX(F.a.query);uc[pb.a.query]="!";uc[pb.a.Rlb]=Qb;uc[pb.a.qyh]=Fb.length;uc[pb.a.jHg]=hc;uc[pb.a.Cpm]=Pc;this.fX.Nqa(F.a.query,uc,this.k0)}qBk(Fb,Qb,hc,Pc,uc,zb,ac,Jb=null){const Yc=this.JX(F.a.latency);Yc[pb.a.culture]=this.AWb;Yc[pb.a.qyh]=Fb;Yc[pb.a.z0h]=Qb;Yc[pb.a.statusCode]=hc;Yc[pb.a.INl]=uc;Yc[pb.a.isSuccess]=zb;Yc[pb.a.gvk]=ac;Jb&&(Yc[pb.a.Eam]=Jb);this.fX.oNa(F.a.latency,Yc,Pc)}LAe(Fb,Qb,hc,Pc){const uc=this.JX(F.a.performance);
uc[pb.a.culture]=this.AWb;uc[pb.a.VHi]=Ta[Fb];uc[pb.a.Dgj]=Ta[Qb];uc[pb.a.Dfl]=R[hc];this.fX.oNa(F.a.performance,uc,Pc)}tDk(Fb,Qb){var {TellMeActor:hc}=d(116);const {CommandResultsUtility:Pc}=d(343);if(Fb.results.length){var uc=this.JX(F.a.fFh);uc[pb.a.kdb]=Qb.toString();uc[pb.a.groupType]=Q.a[Fb.groupType];16===Fb.groupType&&(uc[pb.a.Upk]=hc.instance.iCc);Qb=[];hc=[];var zb=[];for(const ac of Fb.results)uc[pb.a.resultType]||(uc[pb.a.resultType]=K.a[ac.type]),Fb={},27===ac.type&&(Fb.AssetId=ac.C_d),
hc.push(Pc.tec(ac.value)),Qb.push(ac.value),zb.push(new rb(ac.value,Pc.tec(ac.value),ac.type,ac.subType,Fb));0<Qb.length&&(uc[pb.a.hHl]="{"+Qb.join(", ")+"}",uc[pb.a.cgj]="{"+hc.join(", ")+"}",uc[pb.a.dHl]=za.c(zb));this.fX.Nqa(F.a.fFh,uc,this.k0)}}xtj(Fb,Qb){if(4===Fb)return jc.aZk;switch(Qb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return K.a[Qb]}tzk(Fb,Qb,hc,Pc,uc){const zb=this.JX(F.a.click);zb[pb.a.z0h]=
Fb;zb[pb.a.tdl]=Qb;zb[pb.a.commandId]=hc;zb[pb.a.IEa]=Pc;zb[pb.a.actionType]=this.xtj(uc.groupType,uc.resultType);zb[pb.a.resultType]=K.a[uc.resultType];zb[pb.a.vcf]=$a.a[uc.vcf];zb[pb.a.groupType]=Q.a[uc.groupType];zb[pb.a.kdb]=uc.kdb.toString();zb[pb.a.Y$d]=uc.Y$d.toString();zb[pb.a.resultIndex]=uc.resultIndex.toString();this.fX.Nqa(F.a.click,zb,this.k0)}wzk(Fb,Qb){this.Nsa.D$||(this.Nsa.D$=Wb.a.create().toString(),this.HJg("",!1,Qb));Qb=this.JX(F.a.j_f);Qb[pb.a.Rlb]=Fb;this.fX.oNa(F.a.j_f,Qb)}XJg(Fb,
Qb,hc){if(Fb){if(hc)for(const Pc in hc)Fb[Pc]=hc[Pc];this.fX.oNa(F.a.events,Fb,Qb)}}vIa(Fb,Qb,hc=null){const Pc=this.JX(F.a.events);Pc[pb.a.event]=Fb;this.XJg(Pc,Math.round(Qb),hc)}uIa(Fb,Qb,hc=null){const Pc=this.JX(F.a.events);Pc[pb.a.event]=F.a.error;Pc[pb.a.module]=Fb;Pc[pb.a.errorMessage]=Qb;Pc[pb.a.message]=Qb;this.XJg(Pc,Math.round(window.performance.now()),hc)}rzk(Fb){const Qb=this.JX(F.a.uYf);Qb[pb.a.value]=Fb;Qb[pb.a.xud]=this.HQa;this.fX.Nqa(F.a.uYf,Qb,this.k0)}Myk(Fb){const Qb=this.JX(F.a.SIf);
Qb[pb.a.value]=Fb;Qb[pb.a.xud]=this.HQa;this.fX.Nqa(F.a.SIf,Qb,this.k0)}pAk(Fb){const Qb=this.JX(F.a.Tbg);Qb[pb.a.value]=Fb;Qb[pb.a.xud]=this.HQa;this.fX.Nqa(F.a.Tbg,Qb,this.k0)}fDk(Fb){const Qb=this.JX(F.a.Yxh);Qb[pb.a.value]=Fb;Qb[pb.a.xud]=this.HQa;this.fX.Nqa(F.a.Yxh,Qb,this.k0)}$yk(Fb){const Qb=this.JX(F.a.ZKh);Qb[pb.a.value]=Fb;this.fX.Nqa(F.a.ZKh,Qb,this.k0)}iDk(Fb,Qb){const hc=this.JX(F.a.oyh);hc[pb.a.iOb]=Fb;Qb&&(hc[pb.a.D$]=Qb);this.fX.oNa(F.a.oyh,hc)}JX(Fb){return{["SessionID"]:this.Nsa.sessionId,
["CorrelationID"]:this.Nsa.D$,["Time"]:(new Date).getTime(),["Event"]:Fb,["Scenario"]:this.k0}}}Object(L.a)(qb,"UsageLogger",null,[1176]);var Ga=d(96);class cb{}cb.Callback="action";Object(L.a)(cb,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var Ob=d(544),Db=d(302),mb=d(80),Vc=d(142),Zb=d(493),fc=d(251),ob=d(55),ub=d(276),bc=d(72),ic=d(36);d.d(V,"TellMeActor",function(){return Rc});class Rc{constructor(){this.PCa=this.PT=this.Wd=this.La=this.P3=this.AH=this.je=this.Ca=this.Qd=this.PE=this.NQd=
this.EIf=this.i9=this.vb=null;this.Rsb=!1;this.zJd=[];this.Lpf=[];this.SHf=[];this.gAf=[];this.hAf=[];this.axf=!1;this.rrb=this.IMc=null;this.SYb=this.BCa=!1;this.MIc=!0;this.$Q=this.PGc=this.Stf=this.YQd=this.aAf=null;this.Q3=[];this.TPa=this.Irb=this.wja=this.jKc=this.RFf=null;this.xsb=!1;this.SQd=0;this.irb=null;this.Kda=-1;this.Nzf=0;this.aZb=!1;this.bQa=null;this.PHf=!1;this.jrb=this.uO=null;this.Dcj=(Fb,Qb,hc,Pc,uc)=>{if(Qb.contextId===bc.a.frame)switch(Fb){case ic.a.hq:return this.hq(Fb,Qb,
hc,Pc,uc);case ic.a.Ldf:return this.LTf(Fb,Qb,hc,Pc,uc);case ic.a.Qdf:return this.jKg(Fb,Qb,hc,Pc,uc);case ic.a.Tdf:return this.NJg(Fb,Qb,hc,Pc,uc);case ic.a.Sdf:return this.fKg(Fb,Qb,hc,Pc,uc);case ic.a.Odf:return this.nDb(Fb,Qb,hc,Pc,uc);case ic.a.Vdf:return this.restoreFocus(Fb,Qb,hc,Pc,uc);case ic.a.Rdf:return this.eKg(Fb,Qb,hc,Pc,uc);case ic.a.Udf:return this.MJg(Fb,Qb,hc,Pc,uc);case ic.a.kAc:return this.Pdg(Fb,Qb,hc,Pc,uc);case ic.a.Kdf:return this.DZf(Fb,Qb,hc,Pc,uc);case ic.a.Xdf:case ic.a.Ize:return this.ote(Fb,
Qb,hc,Pc,uc);case ic.a.nde:case ic.a.ode:case ic.a.pde:case ic.a.qde:case ic.a.rde:case ic.a.dWe:case ic.a.eWe:case ic.a.fWe:case ic.a.Ydf:return this.mza(Fb,Qb,hc,Pc,uc);case ic.a.nXe:case ic.a.oXe:case ic.a.pXe:return this.Ndc(Fb,Qb,hc,Pc,uc);case ic.a.Ndf:return this.krh(Fb,Qb,hc,Pc,uc);case ic.a.y_d:case ic.a.z_d:case ic.a.A_d:return this.AFb(Fb,Qb,hc,Pc,uc);case ic.a.Bob:return this.Bob(Fb,Qb,hc,Pc,uc);case ic.a.zze:return this.kIg(Fb,Qb,hc,Pc,uc);case ic.a.Y0e:return this.Syh(Fb,Qb,hc,Pc,uc);
case ic.a.vfe:return this.vfg(Fb,Qb,hc,Pc,uc)}return 2};this.Syh=(Fb,Qb,hc,Pc,uc)=>{if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Wd.Kdg();if(Fb=uc.TerminalParentControlId){Fb=this.jrb.ga(Fb);if(!Fb)return 16;Qb=[];Array.add(Qb,Fb);if(!this.wIg(Qb))return 8}return 32};this.vfg=()=>{if(!this.jrb.count)return 16;const Fb=[];for(const Qb of this.jrb.values)Array.add(Fb,Qb);return this.wIg(Fb)?32:8};this.Ndc=(Fb,Qb,hc,Pc,
uc)=>{if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:InsertMention","actiondata comes null"),16;Fb=uc.UILocation;let zb;uc=uc.CommandValueId;try{zb=za.a(uc)}catch(ac){return this.Qd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return ha.b(zb)?(this.Qd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):ha.b(this.PGc)?(this.Qd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Fb?(this.Qd.onError("TellMeActor:InsertMention",
"location "+Fb+" is unexpected"),16):this.PGc.Ndc(zb.displayName,zb.email,zb.userId)?32:(this.Qd.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.mza=(Fb,Qb,hc,Pc,uc)=>1===hc?32:ha.b(uc)?(this.Qd.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===uc.UILocation?this.Sbk(hc,uc):this.HMb(Fb,Qb,hc,Pc,uc);this.krh=(Fb,Qb,hc,Pc,uc)=>{if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.uO&&window.setTimeout(()=>
{this.uO.execute(zb=>{zb.Cob("TellMeSurvey",null)})},Rc.Vlj);return 32};this.Lha=(Fb,Qb,hc,Pc,uc)=>{hc=window.performance.now();this.Qgl(Qb);this.Qd.kRl(Qb);this.vb.Xp?(this.TPa=this.NQd.atj(Qb,Fb,uc),this.vb.wfa?(this.Q3.push(appChrome.actions.updateTellMeSearchResults(this.TPa.menuModel,Fb,uc)),appChrome.api.dispatch(this.Q3)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.TPa.menuModel,Fb,uc)),this.vb.FFd&&this.xsb&&(ha.b(this.$Q)||this.$Q.Location!==na.a.contextMenu)&&
(this.PE.mark(2),this.PE.measure(0,1,2))):this.wja=this.EIf.btj(Qb,this.Qd.mqa);this.irb&&this.je.Jb(this.irb);uc={};uc.GroupsCount=Qb.length;uc.QueryID=Pc;uc.QueryLength=Fb.length;this.Qd.TI(F.a.f6i,window.performance.now()-hc,uc)};this.kIg=(Fb,Qb,hc,Pc,uc)=>{if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.La.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Fb={};Fb.SourceControlId=uc.SourceControlId;
Fb.Query=uc.CommandValueId;uc=this.Ca.Ia(ic.a.Aze,2,Fb);if(32!==uc)this.Qd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+uc+".");return uc}return this.Ca.Ia(ic.a.Aze,2,uc)};this.AFb=(Fb,Qb,hc,Pc,uc)=>{({AddinResultsProvider:Fb}=d(726));if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;hc=uc.CommandValueId;if(ha.a(hc))return this.Qd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),
16;if(!Fb.H9a[hc])return this.Qd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+hc+" doesn't not exist in entitlements"),16;uc=d(726).AddinResultsProvider.H9a[hc];Fb={};Fb.solutionId=uc.id;Fb.version=uc.appVersion;Fb.storeType=uc.storeType;Fb.storeId=uc.storeId;Fb.assetId=uc.assetId;Fb.assetStoreId=uc.assetStoreId;Fb.displayName=uc.displayName;Fb.targetType=uc.targetType;Fb.height=uc.height;Fb.width=uc.width;uc=this.Ca.Ia(ic.a.pyg,2,Fb);if(32!==uc)this.Qd.onError("TellMeActor:LaunchAddin",
"CommonCommands.InsertOfficeAddin failed. Response: "+uc+". AssetId: "+hc);return uc};this.Bob=()=>{if(!ha.b(this.uO))for(const Fb of D.a.instance.V5a){if("ShowContextMenuWithFloatie"===Fb.commandId)return this.uO.execute(Qb=>{Qb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Fb.commandId&&-1===Fb.commandId.indexOf("Tab"))break}return 8}}get uUc(){return this.P3?this.P3.contentType:Rc.unknown}m7b(){return this.P3?[""]:[]}get actions(){return this.Q3}set actions(Fb){this.Q3=Fb}s2c(){return this.Qd?
this.Qd.mqa.D$:null}cI(){return this.vb}get wYk(){return this.MIc}get mom(){return this.aAf}performance(){return this.PE}get Gaf(){return this.RFf}set Gaf(Fb){this.RFf=Fb}get iCc(){return this.PHf}set iCc(Fb){this.PHf=Fb}OB(Fb){const Qb=window.performance.now();this.IMc&&!ha.b(Fb)&&(this.IMc(Fb),this.Qd.TI(F.a.OB,window.performance.now()-Qb))}initialize(Fb,Qb=null,hc=null,Pc=null,uc=null,zb=null,ac=null,Jb=null,Yc=null,dd=null,id=null){const {InteractionLogger:Cc}=d(1205),{GroupsPlacementInfo:Nb}=
d(1202),{AggregatorResultsProvider:nc}=d(1040);this.vb=Fb;this.BCa=!!W.AFrameworkApplication.za&&W.AFrameworkApplication.za.mb.TEb;this.Qd=Pc;if(!Pc){Pc=new E;Pc.sessionId=W.AFrameworkApplication.userSessionId;const Kc=ub.a.Oe(W.AFrameworkApplication.lcid)||ub.a.cec;this.Qd=new Cc(new qb(this.vb.application,Kc.name,Pc,this.vb.Xp,this.BCa,Fb.iBa,null),this.vb.R_i,this.vb)}this.PCa=new U(this.vb.parameterData);this.EIf=hc||new $b(this.vb,this.PCa);this.IMc=ac;this.NQd=this.NQd||new Ca(this.vb,this.vb.parameterData,
ac);this.Wd=Ga.FocusManager.instance();this.PT=P.createInstance(this.vb);this.Stf=new Nb(Fb);this.Ca=uc||W.AFrameworkApplication.Pa;this.je=zb||W.AFrameworkApplication.Be;this.AH=Yc;this.i9=Qb;this.uO=id;this.PE=new Ha;this.jrb=new k.a(e.a.gl());this.jKc=[];Yc?Yc.execute(Kc=>{Kc.isFeatureEnabled(Rc.t9l,!0).then(xd=>{const {AggregatorResultsProvider:Xc}=d(1040);this.aZb=xd;this.i9=this.i9||Xc.createInstance(this.PT,this.vb,this.PCa,this.aZb);for(const Tb of this.jKc)this.i9.Vz(Tb.provider,Tb.tEd);
this.jKc=[];return null})}):(this.aZb=!0,this.i9=this.i9||nc.createInstance(this.PT,this.vb,this.PCa,this.aZb));this.La=Jb;this.wja=$b.vWc;this.aAf=new Promise(Kc=>{this.YQd=Kc});dd&&dd.execute(Kc=>{this.P3=Kc})}qb(){this.Cwi()}Cwi(){this.Ca.pa(ic.a.hq,bc.a.frame,Object(n.a)(this,this.hq,"tellMe"),96);this.Ca.pa(ic.a.Ldf,bc.a.frame,Object(n.a)(this,this.LTf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.pa(ic.a.Qdf,bc.a.frame,Object(n.a)(this,this.jKg,"logItemExecuted"),96);this.Ca.pa(ic.a.Tdf,bc.a.frame,
Object(n.a)(this,this.NJg,"logControlDeactivation"),96);this.Ca.pa(ic.a.Sdf,bc.a.frame,Object(n.a)(this,this.fKg,"logInputFocus"),96);this.Ca.pa(ic.a.Odf,bc.a.frame,Object(n.a)(this,this.nDb,"interactionBegin"),96);this.Ca.pa(ic.a.Vdf,bc.a.frame,Object(n.a)(this,this.nDb,"interactionBegin"),96);this.Ca.pa(ic.a.Rdf,bc.a.frame,Object(n.a)(this,this.eKg,"logInputBlur"),96);this.Ca.pa(ic.a.Udf,bc.a.frame,Object(n.a)(this,this.MJg,"logControlActivated"),96);this.Ca.pa(ic.a.kAc,bc.a.frame,Object(n.a)(this,
this.Pdg,"focusSearchBox"),96);this.Ca.pa(ic.a.Kdf,bc.a.frame,Object(n.a)(this,this.DZf,"constructLiveNotificationForMenu"),96);this.Ca.pa(ic.a.Xdf,bc.a.frame,Object(n.a)(this,this.ote,"insertTryQuery"),96);this.Ca.pa(ic.a.Ize,bc.a.frame,Object(n.a)(this,this.ote,"insertTryQuery"),96);this.Ca.pa(ic.a.nde,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.ode,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.pde,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.qde,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.rde,bc.a.frame,this.mza,
96);this.Ca.pa(ic.a.dWe,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.eWe,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.fWe,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.nXe,bc.a.frame,this.Ndc,96);this.Ca.pa(ic.a.oXe,bc.a.frame,this.Ndc,96);this.Ca.pa(ic.a.pXe,bc.a.frame,this.Ndc,96);this.Ca.pa(ic.a.Ndf,bc.a.frame,this.krh,96);this.Ca.pa(ic.a.Ydf,bc.a.frame,this.mza,96);this.Ca.pa(ic.a.y_d,bc.a.frame,this.AFb,96);this.Ca.pa(ic.a.z_d,bc.a.frame,this.AFb,96);this.Ca.pa(ic.a.A_d,bc.a.frame,this.AFb,96);this.Ca.pa(ic.a.Bob,
bc.a.frame,this.Bob,96);this.Ca.pa(ic.a.zze,bc.a.frame,this.kIg,96);this.Ca.pa(ic.a.Y0e,bc.a.frame,this.Syh,96);this.Ca.pa(ic.a.vfe,bc.a.frame,this.vfg,96)}xvl(Fb){this.MIc=!1;const Qb=window.performance.now();Fb.rIa.isCompleted?(this.MIc=!0,this.YQd(!0)):Fb.u9(()=>{this.MIc=!0;this.YQd(!0);this.Qd.TI(F.a.faj,window.performance.now()-Qb)});this.cwl(Fb)}cwl(Fb){fc.a.Mud(this.Dcj);fc.a.V8b([new Zb.a(ic.a.hq,bc.a.frame,96),new Zb.a(ic.a.Ldf,bc.a.frame,96),new Zb.a(ic.a.Qdf,bc.a.frame,96),new Zb.a(ic.a.Tdf,
bc.a.frame,96),new Zb.a(ic.a.Sdf,bc.a.frame,96),new Zb.a(ic.a.Odf,bc.a.frame,96),new Zb.a(ic.a.Vdf,bc.a.frame,96),new Zb.a(ic.a.Rdf,bc.a.frame,96),new Zb.a(ic.a.Udf,bc.a.frame,96),new Zb.a(ic.a.kAc,bc.a.frame,96),new Zb.a(ic.a.Kdf,bc.a.frame,96),new Zb.a(ic.a.Xdf,bc.a.frame,96),new Zb.a(ic.a.Ize,bc.a.frame,96),new Zb.a(ic.a.nde,bc.a.frame,96),new Zb.a(ic.a.ode,bc.a.frame,96),new Zb.a(ic.a.pde,bc.a.frame,96),new Zb.a(ic.a.qde,bc.a.frame,96),new Zb.a(ic.a.rde,bc.a.frame,96),new Zb.a(ic.a.dWe,bc.a.frame,
96),new Zb.a(ic.a.eWe,bc.a.frame,96),new Zb.a(ic.a.fWe,bc.a.frame,96),new Zb.a(ic.a.nXe,bc.a.frame,96),new Zb.a(ic.a.oXe,bc.a.frame,96),new Zb.a(ic.a.pXe,bc.a.frame,96),new Zb.a(ic.a.Ndf,bc.a.frame,96),new Zb.a(ic.a.Ydf,bc.a.frame,96),new Zb.a(ic.a.y_d,bc.a.frame,96),new Zb.a(ic.a.z_d,bc.a.frame,96),new Zb.a(ic.a.A_d,bc.a.frame,96),new Zb.a(ic.a.Bob,bc.a.frame,96),new Zb.a(ic.a.zze,bc.a.frame,96),new Zb.a(ic.a.Y0e,bc.a.frame,96),new Zb.a(ic.a.vfe,bc.a.frame,96)],Fb)}Pdg(Fb,Qb,hc){if(1===hc)return 32;
this.JNh();Fb=!1;(this.vb.iBa||this.BCa)&&(Qb=document.getElementById("SearchButton"))&&Qb.click();if(!this.vb.iBa&&this.BCa)for(Qb=document.getElementsByClassName("ms-suiteux-search-box"),hc=0;hc<Qb.length;hc++){const Pc=Qb[hc].querySelector("input[type=search]");Pc&&(Fb=Ga.FocusManager.dr(Pc))}else Fb=Ga.FocusManager.dr($get(this.vb.Xp?y.CuiHelper.Maf:y.CuiHelper.Wdf));this.SYb=!0;return Fb?32:8}ote(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:InsertTryQuery",
"actiondata comes null"),16;this.JNh();Fb=uc.CommandValueId;Qb=this.vb.Xp?y.CuiHelper.Maf:y.CuiHelper.Wdf;this.vb.Xp&&!ha.b(uc[Ob.a.pca])&&(uc[Ob.a.pca]=!1);if(Fb){if(this.vb.Xp)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Fb)),this.bQa=[19],32;if(uc=$get(Qb))uc.value=Fb}return Ga.FocusManager.dr($get(Qb))?32:8}JNh(){this.Wd.dW(this.vb.iBa||this.BCa?this.vb.O3c:this.vb.gNa,!1)}stj(Fb,Qb){switch(Fb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,
Qb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Qb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Qb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Qb)}return Qb}DZf(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Fb=this.wja?this.wja.YGh:0;uc.Value=1!==Fb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,
Fb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.wja)for(const zb of this.wja.Qcj)uc=Object(r.a)(Y.a,zb)?zb.id:Pa.a.replaceAll(zb.value,'"',""),(uc=$get(uc+"-"+A.a.Mdf))&&Vc.a.bT(uc,Vc.a.Rp,Pa.a.Fe(this.stj(zb.groupType,uc.innerText)));return 32}LTf(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.irb=new mb.a(2,1,0,()=>{uc[cb.Callback]()},97);this.wja&&this.je.Jb(this.irb);
return 32}jKg(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;uc.CloseAllMenus&&(Fb=void 0===uc.ParentControlId||null===uc.ParentControlId?"<NA>":uc.ParentControlId,Qb=this.rrb?this.rrb[uc.ControlId]:null,!Qb&&this.rrb&&"<NA>"!==Fb&&(Qb=this.rrb[Fb]),Qb||(Qb=this.Rsb&&this.PT.Ggk(uc),Qb=this.dbj(Qb,uc.ControlId),Qb=new m(Qb,32,4,-1,-1,-1),this.Qd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+uc.ControlId+
" determined group:"+Q.a[Qb.groupType])),this.Qd.P3k(uc.ControlId,Fb,uc.CommandId,uc.CloseAllMenus,Qb),this.PCa.S0k(uc.ControlId),uc.Location!==na.a.contextMenu&&(this.PT.Cti(uc),this.PT.Vz(Qb.resultType),this.vb.kAd&&this.i9.Wui(uc.CommandId)));return 32}NJg(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;(new Aa(this.s2c())).oJj(this.Irb);Fb=this.Irb;Qb=this.Kda;hc=this.Qd.TEc;if(ha.b(uc))return this.Qd.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;uc=uc.UILocation;Fb&&0<Fb.length&&
this.aZb&&A.a.V9e(this.vb)&&this.vb.i9c&&19!==uc&&Qb>hc&&!this.vb.gJ&&(this.Qd.OAe(Fb),this.Qd.D7e(Qb));this.Qd.GFl();this.vb.FFd&&19!==uc&&(this.PE.mark(3),this.PE.measure(1,0,3),this.PE.measure(2,2,3),this.PE.CAe(0,1,2),this.PE.CAe(2,2,3),this.PE.CAe(1,0,3),this.PE.wTa([0,1,2,3]),this.PE.clearMeasures([0,2,1]));this.Qd.b4k(window.performance.now()-this.SQd);this.vb.Xp&&(this.TPa=null,this.Qd.vnh());this.SYb=this.xsb=!1;this.Irb="";return 32}fKg(Fb,Qb,hc){if(1===hc)return 32;this.Qd.wnh(C(Qb),this.SYb);
return 32}eKg(Fb,Qb,hc){if(1===hc)return 32;this.Qd.vnh();this.xsb=!1;return 32}MJg(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;this.$Q=null;uc&&(this.$Q=uc);this.vb.FFd&&(ha.b(this.$Q)||this.$Q.Location!==na.a.contextMenu)&&this.PE.mark(0);this.Qd.dzd(ha.b(this.$Q)||ha.b(this.$Q.Location)?na.a.unknown:this.$Q.Location);this.Qd.a4k(this.Nzf,this.SYb);this.xsb||this.crc();return 32}Q0f(Fb,Qb){const hc=[],Pc=Date.now();for(const uc of Fb)Fb=(Pc-uc.timeStamp)/1E3,Fb=A.a.RDd(Fb),Array.add(hc,new ba(Qb?uc.commandId:
uc.controlId,Fb));return hc}h8i(Fb){const Qb=[],hc=Date.now();for(const Pc of Fb)if(Pc.controlId||"keyboardShortcut"===Pc.commandSurface)Fb=(hc-Pc.timeStamp)/1E3,Fb=A.a.RDd(Fb),Array.add(Qb,new ca(Pc.controlId,Pc.commandId,Fb,Pc.commandSurface,Pc.HCd));return Qb}o1f(Fb=!1){var Qb=Fb?this.PT.lJj():this.PT.bac();Fb=[];const hc=Date.now();for(const Pc of Qb)Qb=(hc-Pc.TimeStamp)/1E3,Qb=A.a.RDd(Qb),Array.add(Fb,new ba(Pc.Id,Qb));return Fb}crc(){if(!this.xsb){this.Rsb=this.xsb=!0;if(!this.axf){this.axf=
!0;const Fb={};Fb.IsMLREnabled=this.vb.Llk;Fb.IsReactRibbonEnabled=this.vb.Xp;Fb.IsSharedHeaderEnabled=!!W.AFrameworkApplication.za&&W.AFrameworkApplication.za.mb.mP;Fb.IsSearchUxEnabled=this.BCa;Fb.IsTellMeInHeaderEnabled=this.vb.iBa;Fb.IsGoLocalEnv=A.a.rjk();Fb.IsSovereignEnvironment=A.a.ZEb();Fb.IsTellMeServiceResultsEnabled=A.a.V9e(this.vb);Fb.IsSubstrateProviderEnabled=A.a.U9e(this.vb);Fb.ShouldFetchTokens=!!W.AFrameworkApplication.za&&W.AFrameworkApplication.za.mb.RRb;Fb.IsSerpletEnabled=A.a.V$();
Fb.FirstOnClickTimeInMS=Math.round(window.performance.now());Fb.IsHeaderHidden=W.AFrameworkApplication.hideHeader||W.AFrameworkApplication.fY;Fb.IsSearchInHeaderHidden=W.AFrameworkApplication.Y3c;void 0!==window.performance.timing&&null!==window.performance.timing&&(Fb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Fb.IsFindWithMatchesEnabled=this.vb.gcg;Fb.HelpShowsTopSearchResult=this.vb.syc;Fb.HelpShowsNumberOfMatches=this.vb.ryc;W.AFrameworkApplication.fa&&(Fb.UiHost=
W.AFrameworkApplication.fa.Ea("UiHostIntegrationType"));this.Qd.PDk(JSON.stringify(Fb))}this.zJd=this.Q0f(D.a.instance.vWb,!1);this.Lpf=this.Q0f(D.a.instance.V5a,!0);this.SHf=this.h8i(D.a.instance.V5a);this.gAf=this.o1f();this.hAf=this.o1f(!0);this.Qd.crc()}}nDb(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(ob.a.m1)return 32;this.SQd=window.performance.now();this.crc();Fb=new ka(this.Lha,0);this.Kda++;this.Qd.beginQuery("",
this.Kda,this.Rsb);this.xhf(!0,null);this.wja=$b.vWc;this.TPa=Ca.cbe;if(this.i9)Rc.instance.actions=[],this.i9.AC(new G("",this.Kda),Fb,this.vb.Xp);else this.Qd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.irb&&this.je.Jb(this.irb);return 32}restoreFocus(Fb,Qb,hc){if(1===hc)return 32;this.Wd.P2(this.vb.iBa||this.BCa?this.vb.O3c:this.vb.gNa,!1);return 32}hq(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:TellMe","actiondata comes null"),
16;this.$Q=uc;this.Qd.dzd(ha.b(this.$Q.Location)?na.a.unknown:this.$Q.Location);Fb=this.$Q.Value;this.vb.Xp||Fb&&""!==Fb.trim()?(!this.TPa&&this.vb.Xp&&(this.Qd.wnh(C(Qb),this.SYb),this.crc()),this.Fjj(Fb,this.$Q.Location),this.$Q.PopulationXML=this.wja.xml):this.Rsb?this.$Q.PopulationXML=this.wja.xml:(this.$Q.PopulationXML=$b.vWc.xml,this.TPa=Ca.cbe,this.Irb="");return 32}Fjj(Fb,Qb){this.SQd=window.performance.now();this.vb.FFd&&Qb!==na.a.contextMenu&&this.PE.mark(1);this.vb.Xp&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Fb));
Fb&&0<Fb.trim().length&&(this.Rsb=!1);this.vb.qij();Qb=ha.b(Qb)?na.a.hq:Qb;if(Fb!==this.Irb||this.vb.Xp){this.Kda++;this.Qd.beginQuery(Fb,this.Kda,this.Rsb);this.xhf(!0,null);const hc=new G(Fb,this.Kda),Pc=new ka(this.Lha,this.Kda);this.wja=$b.vWc;this.TPa=Ca.cbe;if(this.i9)Rc.instance.actions=[],this.i9.AC(hc,Pc,this.vb.Xp,Qb,this.bQa),this.bQa=null;else this.Qd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Nzf=this.Kda;this.Irb=Fb}}Mim(Fb){if(this.vb.Xp){var Qb=
appChrome.selectors.getActiveControlStates();if(Qb=Object(w.a)(Object,Qb[Fb.value])){Fb.label=Qb.label;let hc=null;"description"in Qb&&(hc=Qb.description);hc&&Object.getType(hc)===String?Fb.description=hc:"secondaryText"in Qb?Fb.description=Qb.secondaryText:"fullDescriptionLabel"in Qb&&(Fb.description=Qb.fullDescriptionLabel)}}}Qgl(Fb){this.rrb={};let Qb=0,hc=0;for(const Pc of Fb){Fb=0;for(const uc of Pc.results)this.rrb[uc.value]=new m(uc.groupType,uc.type,uc.subType,Qb,Fb,hc),Fb++,hc++,uc.label||
5!==uc.type||this.Mim(uc);0<Fb&&Qb++}}HMb(Fb,Qb,hc,Pc,uc){if(1===hc)return 32;if(ha.b(uc))return this.Qd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Fb=uc.CommandValueId)&&window.open(Fb,"_blank");return 32}wIg(Fb){const Qb={};Qb.token=this.Gaf;Qb.files=za.c(Fb);Qb.type="MultiFilesDeckGeneration";if(W.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.Ca.Ia(ic.a.oIg,2,Qb),!0;Fb=A.a.Qog("",A.a.ZGh("GenerateDeckFromFile"),
Object.assign(new Db.a,{landingTab:"All",data:Qb}));Fb=this.Ca.Ia(ic.a.W5c,2,Fb);return 32!==Fb?(this.Qd.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+Fb+"."),!1):!0}Sbk(Fb,Qb){if(1===Fb)return 32;if(ha.b(Qb))return this.Qd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(ha.b(this.PGc))return this.Qd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Fb=Qb.CommandValueId;return ha.b(Fb)?(this.Qd.onError("TellMeActor:InsertUrl",
"commandValueId comes null"),16):this.PGc.insertHtmlText(Fb)?32:(this.Qd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}dbj(Fb,Qb){return Qb.startsWith(this.vb.Xp?A.a.lgf:A.a.hEd)?5:Fb?4:"bSearchHelp"===Qb||Qb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Qb||Qb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Qb?24:Qb===this.vb.fcg?2:0}Vz(Fb,Qb){this.i9?this.i9.Vz(Fb,Qb):Array.add(this.jKc,new B(Fb,Qb))}xhf(Fb,Qb="",hc=null){Fb?this.jrb=new k.a(e.a.gl()):Qb&&hc&&this.jrb.add(Qb,
hc)}static get instance(){return Rc.Ja||(Rc.Ja=new Rc)}}Rc.Ja=null;Rc.t9l="mso_tellMeService";Rc.unknown="Unknown";Rc.Vlj=500;Object(L.a)(Rc,"TellMeActor",null,[])},1187:function(L,V,d){d.r(V);d.d(V,"SurfaceStringTokenStringGenerator",function(){return e});L=d(0);var k=d(557);class e extends k.a{constructor(n){super(n);this.Ka=n}apply(n,r,w,D,y,m,C){null==m&&(m=n.eqg(y,r));C=k.a.eLf(n,m,this.Ka.score,w,D,C);return{ZAc:m,A4b:C}}}e.B4b=0;Object(L.a)(e,"SurfaceStringTokenStringGenerator",k.a,[])},1188:function(L,
V,d){d.r(V);d.d(V,"QueryTokenStringGenerator",function(){return n});L=d(0);var k=d(557),e=d(79);class n extends k.a{constructor(r){super(r);this.Ka=r}apply(r,w,D,y,m,C,E){w=this.Ka.query.load(w,null);m=0;let F=null;this.Ka.query.iW===e.Annotations.$ia?w&&(F=this.Ka.name):((F=this.Ka.name)&&(F+="_"),F+=this.Ka.annotations.K3(this.Ka.query.iW,w));null!=F&&(m=k.a.eLf(r,F,this.Ka.score,D,y,m));return{ZAc:C,A4b:E+m}}}n.B4b=1;Object(L.a)(n,"QueryTokenStringGenerator",k.a,[])},1189:function(L,V,d){d.r(V);
d.d(V,"FuzzyMatchTokenStringGenerator",function(){return e});L=d(0);var k=d(557);class e extends k.a{constructor(n){super(n);this.Ka=n}apply(n,r,w,D,y,m,C){null==m&&(m=n.eqg(y,r));n=this.Ka.h$f.fFk(m);if(this.Ka.drh)for(var E of n)if(!E.ZH&&E.AYc)return{ZAc:m,A4b:C};E=0;for(const F of n)if(F.ZH&&!({R2d:E}=this.kPf(F,!0,w,D,E)).returnValue)return{ZAc:m,A4b:C};if(this.Ka.Xwg)for(const F of n)if(!({R2d:E}=this.kPf(F,!1,w,D,E)).returnValue)break;return{ZAc:m,A4b:C}}kPf(n,r,w,D,y){let m;r?(r=0,m=n.AYc?
1:0):(r=n.AYc?1:0,m=n.count-r);for(let C=0;C<m;++C)if(k.a.fLf(n.kVa+r+C,this.Ka.score,w,D),++y,0<this.Ka.UQe&&y>=this.Ka.UQe)return{returnValue:!1,R2d:y};return{returnValue:!0,R2d:y}}}e.B4b=2;Object(L.a)(e,"FuzzyMatchTokenStringGenerator",k.a,[])},1202:function(L,V,d){d.r(V);L=d(0);var k=d(305),e=d(18),n=d(16),r=d(1264),w=d(174);class D{constructor(A,W,N,P=0){this.Org=A;this.groupType=W;this.xme=P;this.twc=N}}Object(L.a)(D,"SortingGroup",null,[]);class y{constructor(A,W,N,P){this.order=A;this.kdb=
W;this.zTj=N;this.groupType=P}}Object(L.a)(y,"SortingProp",null,[]);var m=d(116),C=d(145),E=d(108),F=d(121);class B{constructor(A,W){this.V$g={};this.U$g={};this.W9g=this.Lfh=1;this.qSf(A,W)}P3l(A,W,N){var P=E.a.SG(N)?this.V$g:this.U$g;N=new e.a;for(var U of W)W=Object(r.a)(y,P[k.a[U.groupType].toLowerCase()]),F.b(W)||N.add(new n.a(W,U));N.Sc((G,Y)=>G.key.order<Y.key.order?-1:1);Array.clear(A);U=m.TellMeActor.instance.$Q;for(W=0;W<N.count;){P=N.ga(W).key.kdb;var Q=N.ga(W).value;const G=new w.a(N.ga(W).key.groupType);
F.b(U)||U.Location===C.a.contextMenu||(G.displayName=N.ga(W).key.zTj);for(const Y of Q.results)G.qt(Y);for(Q=++W;Q<N.count&&N.ga(Q).key.kdb===P;)this.oZd(G,N.ga(Q).value),Q=++W;A.push(G)}}xkm(A,W){this.W9g=this.Lfh=1;this.qSf(A,W)}qSf(A,W){this.BTh(A);for(var N=0;N<A.length;N++){const P=A[N];for(const U of P.twc)this.vui(U,N,P.Org,P.groupType)}this.BTh(W);for(A=0;A<W.length;A++){N=W[A];for(const P of N.twc)this.uui(P,A,N.Org,N.groupType)}}BTh(A){A.sort((W,N)=>Object(r.a)(D,W).xme>Object(r.a)(D,N).xme?
-1:1)}vui(A,W,N,P){this.V$g[k.a[A].toLowerCase()]=new y(this.Lfh++,W,N,P)}uui(A,W,N,P){this.U$g[k.a[A].toLowerCase()]=new y(this.W9g++,W,N,P)}oZd(A,W){for(let N=0;N<W.results.length;N++)A.qt(W.results[N])}}Object(L.a)(B,"BaseGroupingSorter",null,[]);class H{constructor(){this.Jld=[new D("",26,[26]),new D("",24,[24]),new D(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new D(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new D(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,
14,19,3]),new D("",13,[13]),new D("",22,[22])];this.qid=[new D("",25,[25]),new D(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new D(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new D(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new D("",13,[13]),new D("",22,[22])];this.ETg=new B(this.Jld,this.qid)}jzc(A,W,N,P=null,U=null){let Q=!1;if(P){for(const G of E.a.SG(N)?this.Jld:this.qid)this.csl(G,P);Q=!0}if(U){for(const G of E.a.SG(N)?
this.Jld:this.qid)this.ykm(W,G,U);Q=!0}Q&&this.ETg.xkm(this.Jld,this.qid);this.ETg.P3l(A,W,N)}csl(A,W){const N=new e.a;for(var P of A.twc){const U=W[k.a[P].toLowerCase()];N.add(new n.a(F.b(U)?Number.MAX_VALUE:U,P))}if(N.count){N.Sc((U,Q)=>U.key<Q.key?-1:1);W=Array(N.count);for(P=0;P<N.count;P++)W[P]=N.ga(P).value;A.twc=W}}ykm(A,W,N){let P=0;for(const U of W.twc)if(k.a[U].toLowerCase()in N&&N[k.a[U].toLowerCase()])for(const Q of A)if(Q.groupType===U){P+=N[k.a[U].toLowerCase()];break}W.xme=P}}Object(L.a)(H,
"SimplifiedGroupingSorter",null,[]);d.d(V,"GroupsPlacementInfo",function(){return K});class K{constructor(A){this.T$g={};this.R$g={};this.S$g={};this.W$g={};this.RNe={};this.yah=this.$Tk=this.aSk=this.zSk=1;this.Qbh=null;this.Oq=A;this.FLi();this.qhl();this.zLi();this.BKi();A.gJ&&(this.Qbh=new H)}Uz(A){this.T$g[k.a[A].toLowerCase()]=this.zSk++}YB(A,W){this.R$g[k.a[A].toLowerCase()]=W}rta(A){this.S$g[k.a[A].toLowerCase()]=this.aSk++}hU(A){this.W$g[k.a[A].toLowerCase()]=this.$Tk++}Yy(A){this.RNe[k.a[A].toLowerCase()]=
this.yah++}FLi(){const A=!!this.Oq&&this.Oq.nYa,W=!!this.Oq&&this.Oq.Trc,N=!!this.Oq&&this.Oq.oYa,P=!!this.Oq&&this.Oq.nye&&!E.a.ZEb(),U=!!this.Oq&&this.Oq.ngc,Q=!!this.Oq&&this.Oq.f6c,G=!!this.Oq&&this.Oq.Awe,Y=!!this.Oq&&this.Oq.Ste;this.Oq&&(this.Oq.xzb||this.Oq.c5||this.Oq.BWc)&&this.Uz(26);Y&&this.Uz(24);this.Uz(4);this.Uz(18);this.Uz(16);this.Uz(7);this.Uz(17);this.Uz(0);this.Uz(1);G&&this.Uz(28);U&&this.Uz(23);A||this.Uz(2);A&&!W||this.Uz(8);this.Uz(15);N&&this.Uz(20);this.Uz(14);this.Uz(9);
this.Uz(12);this.Uz(10);this.Uz(11);A&&this.Uz(2);A&&!W&&this.Uz(8);this.Uz(19);Q&&this.Uz(27);this.Uz(21);this.Uz(13);P&&this.Uz(22);this.Uz(30)}qhl(){this.YB(21,1);this.YB(4,3);this.YB(18,3);this.YB(16,3);this.YB(7,3);this.YB(17,5);this.YB(0,5);this.YB(1,1);this.YB(28,2);this.YB(2,1);this.YB(8,2);this.YB(15,3);this.YB(14,2);this.YB(27,3);this.YB(9,1);this.YB(12,1);this.YB(10,1);this.YB(11,1);this.YB(19,1);this.YB(23,1);this.YB(13,1);this.YB(24,1);this.YB(25,1);this.YB(20,2);this.YB(22,1);this.YB(26,
1)}zLi(){this.rta(4);this.rta(0);this.rta(17);this.rta(7);this.rta(16);this.rta(18);this.rta(15);this.rta(20);this.rta(8);this.rta(14)}BKi(){this.hU(14);this.hU(10);this.hU(12);this.hU(9);this.hU(11);this.hU(20);this.hU(15);this.hU(8);this.hU(2);this.hU(1);this.hU(27);this.hU(7);this.hU(18);this.hU(16);this.hU(17);this.hU(0);this.hU(4)}OFl(){this.RNe={};this.yah=1}JKj(A,W,N){this.OFl();const P=!!this.Oq&&this.Oq.nYa,U=!!this.Oq&&this.Oq.Trc,Q=!!this.Oq&&this.Oq.oYa,G=!!this.Oq&&this.Oq.nye&&!E.a.ZEb(),
Y=!!this.Oq&&this.Oq.ngc,ba=!!this.Oq&&this.Oq.f6c,ha=!!this.Oq&&this.Oq.Awe,ka=!!this.Oq&&this.Oq.jAd;A=A&&U;ka&&this.Yy(25);this.Yy(4);this.Yy(18);this.Yy(16);this.Yy(7);this.Yy(17);this.Yy(0);this.Yy(1);ha&&this.Yy(28);Y&&this.Yy(23);P&&!U||!A||this.Yy(8);W&&this.Yy(15);P||this.Yy(2);ba&&this.Yy(27);N&&this.Yy(14);P&&!U||A||this.Yy(8);W||this.Yy(15);Q&&this.Yy(20);N||this.Yy(14);this.Yy(9);this.Yy(12);this.Yy(10);this.Yy(11);P&&this.Yy(2);P&&!U&&this.Yy(8);this.Yy(19);this.Yy(21);this.Yy(13);G&&
this.Yy(22);return this.RNe}cI(){return this.Oq}}Object(L.a)(K,"GroupsPlacementInfo",null,[])},1205:function(L,V,d){d.r(V);L=d(0);var k=d(725),e=d(457),n=d(305),r=d(1086),w=d(456);class D{constructor(K="",A="",W="",N=-99999,P=-1,U=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=K?K:"";this.Description=A?A:"";this.Type=W?W:"";this.Score=N;this.Age=P;this.Count=U}}Object(L.a)(D,"Suggestion",null,[]);class y{constructor(K,A){this.GroupType=this.Suggestions=null;
this.Suggestions=K;this.GroupType=A}}Object(L.a)(y,"SuggestionGroup",null,[]);class m{}m.Dfa="help";m.tDi="answer";m.commands="commands";m.JNl="servicecommands";m.DXh="template";Object(L.a)(m,"SuggestionGroupType",null,[]);var C=d(116),E=d(108),F=d(25),B=d(35);d.d(V,"InteractionLogger",function(){return H});class H{constructor(K,A,W){this.UKd=0;this.CWd=this.yZb=null;this.lk=K;this.EVd=this.NJd=this.xNd=!1;this.hci=A;this.Bi=F.AFrameworkApplication.Me;this.vb=W;this.TEc=this.CSd=0}get mqa(){return this.lk.mqa}dzd(K){this.lk.dzd(K)}DKg(){if(this.yZb){var K=
0;for(const A of this.yZb)this.lk.tDk(A,K++);this.yZb=null}}beginQuery(K,A,W){this.lk.gDk(K,A,W)}wnh(K,A){this.lk.SHi(K,A);this.xNd=!0;this.EVd=!1}vnh(){this.xNd=!1;this.NJd||(this.DKg(),this.lk.R8f(this.UKd))}hDk(K,A){this.lk.iDk(K,A)}P3k(K,A,W,N,P){for(const U of this.hci)if(K.startsWith(U)){this.EVd=!0;break}this.lk.tzk(K,A,W,N,P)}b4k(K){this.NJd=!1;this.UKd=K;this.xNd||this.EVd||(this.DKg(),this.lk.R8f(this.UKd,!1))}a4k(K,A){this.lk.wzk(K,A);this.NJd=!0}qfe(K,A){if(!K.count)return"";let W="";
const N=Date.now();for(const P of K)K=(N-P.timeStamp)/1E3,K=E.a.RDd(K),0<W.length&&(W+=";"),W+=A?P.commandId:P.controlId,W+=":",W+=K.toString();return W}crc(){var K=this.qfe(k.a.instance.vWb,!1);0<K.length&&this.lk.rzk(K);K=this.qfe(k.a.instance.V5a,!0);0<K.length&&this.lk.Myk(K);K=this.qfe(k.a.instance.XFc,!0);0<K.length&&this.lk.pAk(K);K=C.TellMeActor.instance.hAf;0<K.length&&this.lk.fDk(B.c(K))}PDk(K){this.lk.$yk(K)}r7(K,A,W,N,P,U,Q,G=null){this.lk.qBk(K,A,W,N,P,U,Q,G)}LAe(K,A,W,N){this.lk.LAe(K,
A,W,N)}TI(K,A,W=null){this.lk.vIa(K,A,W)}onError(K,A,W=null){this.lk.uIa(K,A,W)}kRl(K){this.yZb=K}qOj(K){const A=[];if(!K)return A;for(let W=0;W<K.length;W++){const N=n.a[K[W].groupType].toLowerCase(),P=[],U=K[W].results;if(U){for(let Q=0;Q<U.length;Q++)"findindocument"===N?Array.add(P,new D("","",N,U[Q].score,U[Q].UOc,U[Q].count)):Array.add(P,new D(U[Q].label,U[Q].description,N,U[Q].score,U[Q].UOc,U[Q].count));"answer"===N||"definition"===N||"wolframanswer"===N||"entity"===N?Array.add(A,new y(P,
m.tDi)):"classifier"===N||"appsforoffice"===N?Array.add(A,new y(P,m.commands)):"serviceclassifier"===N?Array.add(A,new y(P,m.JNl)):"assistance"===N?Array.add(A,new y(P,m.Dfa)):("document"===N||"people"===N||"findindocument"===N||"notes"===N||"image"===N||"template"===N)&&Array.add(A,new y(P,N))}}return A}ele(K,A){const W={};W.Query=A;W.SuggestionGroups=B.c(this.qOj(K));return B.c(W)}Kpg(K){const A={"Content-Type":"application/json",Accept:"application/json"};A["X-Office-Version"]=F.AFrameworkApplication.buildVersion;
A["X-Office-Application"]=F.AFrameworkApplication.fa.Ea("Application");A["X-Office-Platform"]="WAC";A["X-TellMe-SqmUserId"]=F.AFrameworkApplication.fa.Ea("LoggableUserId")||"";A["X-TellMe-SessionId"]=this.lk.mqa.D$;A["X-TellMe-SuggestionTypes"]="Ranker";A["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;A["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;A["X-TellMe-Flights"]=K;A["X-TellMe-PartialQueryIndex"]=this.CSd;return A}Tkb(K,A,W){this.r7(A.length,"RankerLogging",K.data.Ke.toString(),
Math.round(window.performance.now()-W),w.a.zXh,!0,e.a.Ova)}Ekb(K,A,W){this.r7(A.length,"RankerLogging",K.data.Ke.toString(),Math.round(window.performance.now()-W),w.a.zXh,!1,e.a.Ova)}Lpg(){this.CWd||(this.CWd=new r.a(this.vb,null,6E3));return this.CWd.VBa}OAe(K){const A=this.ele(this.yZb,K),W=this.Kpg("RankerLogging"),N=window.performance.now();this.Bi.Tj(this.Lpg(),2,A,W,!1,0,P=>{this.Tkb(P,K,N)},P=>{this.Ekb(P,K,N)},null,null,!1,4E3,6E3);this.CSd++}GFl(){this.CSd=0}D7e(K){this.TEc=K}}Object(L.a)(H,
"InteractionLogger",null,[])},1312:function(L,V,d){d.r(V);var k=d(0),e=d(25),n=d(68),r=d(395),w=d(956),D=d(96),y=d(54),m=d(1265),C=d(7),E=d(1302),F=d(94),B=d(67),H=d(183),K=d(982),A=d(83);class W{static get Wg(){return A.a.oC(W.Hq,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}W.Hq="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(k.a)(W,"InsertSymbolsDialogHtml",null,[]);var N=d(34),P=d(219);class U extends E.a{constructor(Oa,sb,Pb){super();this.cyf=this.$sa=this.YRa=null;this.FNd=0;this.Ca=Oa;this.Wd=sb;this.tDa=Pb;this.Te(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Te(0,CommonUIStrings.l_DialogClose);this.bX=!1;this.Wg=W.Wg;this.Fg="InsertSymbolsDialog"}dispose(){0<U.hXd&&r.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.FNd,U.hXd);U.Qqf++;
r.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",U.Qqf);this.Ca=this.tDa=null;super.dispose()}zia(){this.Vj(Box4Intl.Box4Strings.L_SymbolSingle,Object(C.a)(this,this.Obk,"insertSymbolsDialogHandler"),null);this.FNd=0;U.Vqf++;r.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",U.Vqf);const Oa=this.ile("symbol_d_"+U.vZb);Oa&&Oa.focus()}hide(){var Oa=document.getElementById("symbolsContainer");if(Oa&&(Oa=Oa.getElementsByTagName("a")))for(let sb=0;sb<
Oa.length;sb++)F.a.removeHandler(Oa[sb],B.a.focus,Object(C.a)(this,this.eWh,"symbolFocusHandler"));super.hide()}Obk(Oa){1===Oa?(this.RUe("symbol_d_"+U.vZb),this.Wd.dW(this.uM,!0),this.Wd.gm().jk.bG(this.HE),this.HE.focus()):this.hide()}get yFb(){return U.yyf}set yFb(Oa){U.yyf=Oa}get tFb(){return U.kyf}set tFb(Oa){U.kyf=Oa}$ya(){super.$ya();var Oa=document.getElementById("symbolsContainer");if(Oa&&(K.a.Myd(Oa,this.tDa.zKi(),"InsertSymbolsDialog"),Oa=Oa.getElementsByTagName("a")))for(let sb=0;sb<Oa.length;sb++)F.a.addHandler(Oa[sb],
B.a.focus,Object(C.a)(this,this.eWh,"symbolFocusHandler"))}C9(){const Oa=document.getElementById("symbolsContainer");Oa&&(this.YRa||(this.YRa=Object(C.a)(this,this.I7l,"symbolClickHandler"),this.to.xb(B.a.click,Oa,this.YRa),this.to.xb(B.a.doubleClick,Oa,this.YRa)),this.$sa||(this.$sa=Object(C.a)(this,this.K7l,"symbolKeyHandler"),this.lh.xb(B.a.Vf,Oa,this.$sa),this.lh.xb(B.a.nz,Oa,this.$sa),this.lh.xb(B.a.rm,Oa,this.$sa)));super.C9()}sua(){const Oa=document.getElementById("symbolsContainer");Oa&&(this.YRa&&
(this.to.Hb(B.a.click,Oa,this.YRa),this.to.Hb(B.a.doubleClick,Oa,this.YRa),this.YRa=null),this.$sa&&(this.lh.Hb(B.a.Vf,Oa,this.$sa),this.lh.Hb(B.a.nz,Oa,this.$sa),this.lh.Hb(B.a.rm,Oa,this.$sa),this.$sa=null));super.sua()}v9k(Oa){this.KNh("symbol_d_"+U.vZb,!1);U.vZb=parseInt(Oa.substr(Oa.lastIndexOf("_")+1));this.KNh(Oa,!0);if(Oa=document.getElementById("SymbolNameValueLabel")){const sb=this.m2c(U.vZb);Oa.innerText=sb.altText}}m2c(Oa){const sb=this.tDa.hCd.Ycf.value,Pb=P.a(sb);return sb[Pb[Oa]]}eWh(Oa){if(Oa.target!==
this.cyf){const sb=this.Wd.gm();sb&&sb.jk&&(sb.jk.bG(Oa.target),this.cyf=Oa.target)}this.v9k(Oa.target.id)}I7l(Oa){const sb=Oa.Ec;if("a"!==sb.tagName.toLowerCase())return!1;Oa.eventName===B.a.doubleClick&&this.RUe(sb.id);this.Wd.dW(this.uM,!0);this.Wd.gm().jk.bG(sb);sb.focus();return!0}K7l(Oa){var sb=Oa.Ec;if("a"!==sb.tagName.toLowerCase())return!1;const Pb=parseInt(sb.id.substr(sb.id.lastIndexOf("_")+1));if(Oa.hc.ctrlKey||Oa.hc.altKey||Oa.hc.keyCode>=H.a.Aqb&&Oa.hc.keyCode<=H.a.NBa)return!1;if(Oa.eventName===
B.a.Vf){Oa=Oa.hc.keyCode;let kc=-1;Oa===Sys.UI.Key.enter?(this.RUe(sb.id),this.Wd.dW(this.uM,!0),this.Wd.gm().jk.bG(sb),sb.focus()):Oa===Sys.UI.Key.up?kc=Pb-15:Oa===Sys.UI.Key.down?kc=Pb+15:Oa===Sys.UI.Key.left?kc=e.AFrameworkApplication.isRtl?Pb+1:Pb-1:Oa===Sys.UI.Key.right&&(kc=e.AFrameworkApplication.isRtl?Pb-1:Pb+1);0<=kc&&(sb=this.ile("symbol_d_"+kc))&&sb.focus()}return!0}RUe(Oa){this.FNd++;U.hXd++;Oa=parseInt(Oa.substr(Oa.lastIndexOf("_")+1));const sb=this.m2c(Oa),Pb={};Pb.SourceControlId="symbol_"+
Oa+"_"+sb.fCd;this.Ca.Ia(N.a.qXa,2,Pb);r.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Oa)}ile(Oa){const sb=document.getElementById("symbolsContainer");return sb?sb.querySelector("#"+Oa):null}KNh(Oa,sb){(Oa=this.ile(Oa))&&(sb?Oa.setAttribute("selected","true"):Oa.removeAttribute("selected"))}}U.vZb=0;U.yyf=null;U.kyf=null;U.Vqf=0;U.Qqf=0;U.hXd=0;Object(k.a)(U,"InsertSymbolsDialog",E.a,[]);var Q=d(43),G=d(52),Y=d(37),ba=d(185),ha=d(107);class ka{constructor(Oa,sb,
Pb,kc,Wc,Xd,Gd,Pe){this.Ca=Oa;this.OL=sb;this.lpi=new m.a(Object(C.a)(this,this.COj,"getSymbolsDropDownMenuProps"));this.mpi=new m.a(Object(C.a)(this,this.jle,"getSymbolsDropDownXml"));this.lm=Pb;this.tDa=kc;this.NE=Wc;this.EQ=Xd;this.Vc=Gd;this.yn=Pe}COj(){return this.tDa.mLi()}jle(){return this.tDa.build()}qb(){this.Ca.pa(N.a.etd,Y.a.application,Object(C.a)(this,this.etd,"queryInsertSymbols"),96);this.Ca.xa(N.a.tlb,Y.a.view,Object(C.a)(this,this.tlb,"populateSymbolsDropDown"));this.Ca.xa(N.a.gCd,
Y.a.view,Object(C.a)(this,this.fWh,"symbolsDropDownOpenHandler"));this.Ca.xa(N.a.u0e,Y.a.view,Object(C.a)(this,this.Nyh,"querySymbolPositionHandler"));this.Ca.xa(N.a.qXa,Y.a.view,Object(C.a)(this,this.nHa,"insertSymbolViewHandler"));this.Ca.xa(N.a.tlb,Y.a.Xf,Object(C.a)(this,this.tlb,"populateSymbolsDropDown"));this.Ca.xa(N.a.gCd,Y.a.Xf,Object(C.a)(this,this.fWh,"symbolsDropDownOpenHandler"));this.Ca.xa(N.a.u0e,Y.a.Xf,Object(C.a)(this,this.Nyh,"querySymbolPositionHandler"));this.Ca.xa(N.a.qXa,Y.a.Xf,
Object(C.a)(this,this.Nbk,"insertSymbolHandler"));this.Ca.pe(N.a.tlb,1124);this.Ca.pe(N.a.gCd,1036);this.Ca.pe(N.a.u0e,1124);this.Ca.pe(N.a.qXa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("InsertMoreSymbolsIsEnabled")&&(this.Ca.xa(N.a.g5c,Y.a.view,Object(C.a)(this,this.TRh,"showInsertMoreSymbolsDialogHandler")),this.Ca.xa(N.a.g5c,Y.a.Xf,Object(C.a)(this,this.TRh,"showInsertMoreSymbolsDialogHandler")),this.Ca.pe(N.a.g5c,1124))}Nyh(Oa,sb,Pb,kc,Wc){if(1===Pb)return 32;
Oa=this.tDa.kth(Wc);Oa=String.format(this.tDa.J7l,Oa.character);Wc[w.a.InnerHTML]=Oa;Wc[w.a.On]=!1;return 32}nHa(Oa,sb,Pb,kc,Wc){if(({Yf:Oa,selected:Pb,nHa:Pe}=this.w3f(sb,Pb)).returnValue)return Pe;var Xd=Q.SelectionEditor.nh(Pb);let Gd=!0;Pb=8;var Pe=this.lm.xe(15);Pe.rd(Oa.Zg);Xd||(Pb=this.Ca.Ai(sb,N.a.nFa,2,!0,kc,null),sb=32===Pb,r.ULS.shipAssertTag(6407387,348,sb,"DeleteForReplace did not succeed. Response is {0}",Pb),Gd=sb);Gd&&(sb=Oa.Rb.Ik,Xd=Q.SelectionEditor.nh(sb),r.ULS.shipAssertTag(6407388,
348,Xd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",sb.contextId),Pb=8,Xd&&(Pb=this.Ca.Ai(sb,N.a.qXa,2,!1,kc,Wc),r.ULS.shipAssertTag(6407389,348,32===Pb,"Insertion at IP context did not succeed. Response is {0}",Pb),32===Pb&&D.FocusManager.instance().Df(Oa.WJ)));Pe.dispose();return Pb}w3f(Oa,sb){let Pb,kc;Pb=null;Oa.view.xi&&(Pb=Oa.view);kc=null;return Pb&&Pb.Rb?(kc=Pb.Rb.Ik)?this.EQ.ga(14)&&this.NE.aab(kc)?{returnValue:!0,Yf:Pb,selected:kc,nHa:8}:Pb.Rb.Oa.rI||
this.yn&&this.yn.instance&&this.yn.instance.rY(kc)||Q.SelectionEditor.n6c(Oa.GF)?{returnValue:!0,Yf:Pb,selected:kc,nHa:2}:1===sb?{returnValue:!0,Yf:Pb,selected:kc,nHa:32}:{returnValue:!1,Yf:Pb,selected:kc,nHa:32}:{returnValue:!0,Yf:Pb,selected:kc,nHa:2}:(ha.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Oa.toString()),{returnValue:!0,Yf:Pb,selected:kc,nHa:8})}Nbk(Oa,sb,Pb,kc,Wc){if(1===Pb)return 32;if(Q.SelectionEditor.n6c(sb))return 2;
Oa=this.tDa.kth(Wc);kc.ED=Oa.index;kc=this.OL.Pc(sb.node);Pb=kc.uc(11);r.ULS.shipAssertTag(6379466,324,Pb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",ba.a[sb.node.type]);Pb=this.lm.xe(15);Pb.Jz(kc);ka.characterPropertiesEditor.replaceTextRange(sb,Oa.character,!0,!1);sb=G.SelectionFactory.fh(kc.currentNode,sb.Ra+1);this.Vc.setSelection(sb);Pb.dispose();return 32}tlb(Oa,sb,Pb,kc,Wc){if(1===Pb)return 32;e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.es?Wc.MenuItems=
this.lpi.value:Wc.PopulationXML=this.mpi.value;return 32}fWh(Oa,sb,Pb){return this.w3f(sb,Pb).nHa}TRh(Oa,sb,Pb){2===Pb&&(new U(this.Ca,D.FocusManager.instance(),y.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).zia();return 32}etd(){return 32}static get characterPropertiesEditor(){return ka.Ch||(ka.Ch=y.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Oa){ka.Ch=Oa}}ka.Ch=null;Object(k.a)(ka,"SymbolsActor",null,[1096]);class ca{constructor(Oa,sb){this.fCd=
Oa;this.altText=sb}}Object(k.a)(ca,"Symbol",null,[]);class ia{constructor(){this.oWd=null;this.GGf=new m.a(ia.w8d)}get Ycf(){return this.GGf}JDj(Oa){this.oWd||(this.oWd=P.a(this.GGf.value));return Array.indexOf(this.oWd,Oa)}static w8d(){const Oa={};Oa["\u2022"]=new ca("\u2022",Box4Intl.Box4Strings.L_Bullet);Oa["\u20ac"]=new ca("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Oa["\u00a3"]=new ca("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Oa["\u00a5"]=new ca("\u00a5",Box4Intl.Box4Strings.L_YenSign);Oa["\u00a9"]=
new ca("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Oa["\u00ae"]=new ca("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Oa["\u2122"]=new ca("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Oa["\u00b1"]=new ca("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Oa["\u2260"]=new ca("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Oa["\u2264"]=new ca("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Oa["\u2265"]=new ca("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Oa["\u00f7"]=new ca("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);
Oa["\u00d7"]=new ca("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Oa["\u221e"]=new ca("\u221e",Box4Intl.Box4Strings.L_Infinity);Oa["\u00b5"]=new ca("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Oa["\u03b1"]=new ca("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Oa["\u03b2"]=new ca("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Oa["\u03c0"]=new ca("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Oa["\u03a9"]=new ca("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Oa["\u03a3"]=new ca("\u03a3",
Box4Intl.Box4Strings.L_NArySummation);Oa["\u00b0"]=new ca("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Oa["\u0394"]=new ca("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Oa["\u263a"]=new ca("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Oa["\u2665"]=new ca("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Oa["\u20b9"]=new ca("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Oa["\u00bf"]=new ca("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Oa["\u00a1"]=new ca("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);
Oa["\u2014"]=new ca("\u2014",Box4Intl.Box4Strings.L_EmDash);Oa["\u2026"]=new ca("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Oa["\u00c0"]=new ca("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Oa["\u00c1"]=new ca("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Oa["\u00c2"]=new ca("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Oa["\u00c3"]=new ca("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Oa["\u00c4"]=new ca("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);
Oa["\u00c5"]=new ca("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Oa["\u00c6"]=new ca("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Oa["\u00c7"]=new ca("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Oa["\u00c8"]=new ca("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Oa["\u00c9"]=new ca("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Oa["\u00ca"]=new ca("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Oa["\u00cb"]=
new ca("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Oa["\u00cc"]=new ca("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Oa["\u00cd"]=new ca("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Oa["\u00ce"]=new ca("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Oa["\u00cf"]=new ca("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Oa["\u00d1"]=new ca("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Oa["\u00d2"]=
new ca("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Oa["\u00d3"]=new ca("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Oa["\u00d4"]=new ca("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Oa["\u00d5"]=new ca("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Oa["\u00d6"]=new ca("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Oa["\u00d9"]=new ca("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Oa["\u00da"]=
new ca("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Oa["\u00db"]=new ca("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Oa["\u00dc"]=new ca("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Oa["\u00df"]=new ca("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Oa["\u00e0"]=new ca("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Oa["\u00e1"]=new ca("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Oa["\u00e2"]=new ca("\u00e2",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Oa["\u00e3"]=new ca("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Oa["\u00e4"]=new ca("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Oa["\u00e5"]=new ca("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Oa["\u00e6"]=new ca("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Oa["\u00e7"]=new ca("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Oa["\u00e8"]=new ca("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);
Oa["\u00e9"]=new ca("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Oa["\u00ea"]=new ca("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Oa["\u00eb"]=new ca("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Oa["\u00ec"]=new ca("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Oa["\u00ed"]=new ca("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Oa["\u00ee"]=new ca("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Oa["\u00ef"]=
new ca("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Oa["\u00f1"]=new ca("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Oa["\u00f2"]=new ca("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Oa["\u00f3"]=new ca("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Oa["\u00f4"]=new ca("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Oa["\u00f5"]=new ca("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Oa["\u00f6"]=new ca("\u00f6",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Oa["\u00f9"]=new ca("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Oa["\u00fa"]=new ca("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Oa["\u00fb"]=new ca("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Oa["\u00fc"]=new ca("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Oa["\u00ff"]=new ca("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Oa["\u011e"]=new ca("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);
Oa["\u011f"]=new ca("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Oa["\u0130"]=new ca("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Oa["\u0131"]=new ca("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Oa["\u0152"]=new ca("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Oa["\u0153"]=new ca("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Oa["\u015e"]=new ca("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Oa["\u015f"]=new ca("\u015f",
Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Oa["\u0178"]=new ca("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Oa}}Object(k.a)(ia,"SymbolsLoader",null,[1095]);var oa=d(46),sa=d(321),Ca=d(279),Ta=d(218),R=d(595),Ha=d(1295),da=d(132),Ba=d(78);class za{constructor(Oa){this.npi=Oa}get hCd(){return this.npi}get J7l(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}kth(Oa){Oa=Oa.SourceControlId.split("_");const sb={};2===Oa.length?
(sb.character=Oa[1],sb.index=this.hCd.JDj(sb.character)):(sb.character=Oa[2],sb.index=parseInt(Oa[1]));return sb}mLi(){return this.vpg()}build(){return this.jle()}zKi(){const Oa=new Sys.StringBuilder;Oa.append('<table class="moreSymbolsTable">');const sb=this.hCd.Ycf.value,Pb=P.a(sb);let kc=0;for(;kc<Pb.length;){kc%15||Oa.append('<tr role="presentation">');const Wc=sb[Pb[kc]];Oa.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+kc,oa.a.aXa(Wc.fCd),oa.a.aXa(Wc.altText)));kc++;kc%15&&kc!==Pb.length||Oa.append("</tr>")}Oa.append("</table>");return Oa.toString()}jle(){const Oa=this.vpg();return da.l(Oa)}vpg(){const Oa=Object.assign(new sa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Oa.MenuSectionList,this.uwi());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("InsertMoreSymbolsIsEnabled")&&Array.add(Oa.MenuSectionList,this.avi());return Oa}avi(){const Oa=Object.assign(new Ca.a,
{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),sb=Object.assign(new Ta.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:oa.a.Fe(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:oa.a.Fe(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.Mm,Image16by16Class:Ba.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Oa.ControlList,sb);return Oa}uwi(){const Oa=Object.assign(new Ca.a,{Id:"msSymbolsPosition",
ShowMenuSectionSeparator:!1,ControlList:[]}),sb=Object.assign(new R.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Pb=this.hCd.Ycf.value,kc=P.a(Pb),Wc=Math.min(25,kc.length);for(let Gd=0;Gd<Wc;Gd++){var Xd=Pb[kc[Gd]];Xd=Object.assign(new Ha.a,{Id:String.format("{0}{1}_{2}","symbol_",Gd,Xd.fCd),Character:Xd.fCd,Command:"3966968829",QueryCommand:"816646517",Alt:oa.a.Fe(Xd.altText)});sb.GalleryItems.push(Xd)}Array.add(Oa.ControlList,
sb);return Oa}}Object(k.a)(za,"SymbolsUiBuilder",null,[1093]);var Aa=d(63),na=d(125),la=d(39),va=d(519),Pa=d(324);class Qa{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.getBooleanAppSetting("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").qb()}dispose(){}fc(Oa){this.Da=Oa;this.Da.register(ia,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(za,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().na(()=>
new za(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));this.Da.register(ka,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().na(()=>new ka(e.AFrameworkApplication.Pa,new va.a,new Pa.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),na.a.instance,la.a.instance,Aa.a.instance,this.Da.Ha("Box4.IExternalSelectionManager")))}static main(){n.a.instance.Ac(new Qa)}}Object(k.a)(Qa,"Box4SymbolsPackage",null,[2,3]);var Ua=d(1104),Ya=d(35),Ea=d(74),La=d(455);class xb{constructor(Oa,sb){this.kVd=
this.jVd=null;this.fub=new Ua.a;this.NVe=Pb=>{let kc=null;kc&&kc.length||!Pb||!Pb.data||(kc=Pb.data.Ud);if(kc&&kc.length)try{const Wc=Ya.a(kc);this.jVd=Wc.NavBarDataJson;r.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.jVd?({Ev:this.kVd}=Ya.d(Wc.NavBarDataJson)).returnValue?(this.RBk(this.kVd),this.fub.Jg(this.kVd)):(r.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:La.a.oBc(this.jVd)}),this.fub.i3()):(r.ULS.sendTraceTag(9000737,
215,15,"ShellData is null"),this.fub.i3())}catch(Wc){r.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.fub.i3()}else r.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.Wqc=()=>{this.fub.i3();r.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Bi=Oa;this.HDa=sb.appSettings[xb.xom]||""}get GWl(){return this.fub.task}get vea(){return this.Bi.value}bFl(){const Oa={};Oa[xb.D0j]=e.AFrameworkApplication.mh;
Oa["Content-Type"]="application/json; charset=utf-8";r.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const sb=Ea.a.Xi(this.HDa+xb.HWl,xb.K1k,e.AFrameworkApplication.za.mb.Ej.toString());this.vea.Tj(sb,1,"",Oa,!0,2,this.NVe,this.Wqc,null,void 0,void 0,void 0,void 0,"20")}RBk(Oa){try{const sb={};sb.FlightName=Oa.FlightName;sb.SessionID=Oa.SessionID;r.ULS.sendTraceTag(594883776,215,50,Ya.c(sb))}catch(sb){r.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return xb.Ja||
(xb.Ja=xb.Tbb())}static Tbb(){return new xb(new m.a(()=>e.AFrameworkApplication.Me),e.AFrameworkApplication.fa,e.AFrameworkApplication.za.mb.Ej)}}xb.D0j="X-qs";xb.K1k="at";xb.HWl="O365ShellServiceProxy.ashx";xb.Ja=null;xb.xom="ShellWebServiceBase";Object(k.a)(xb,"O365ShellActor",null,[1128]);class dc{constructor(){this.Da=null;this.Pn=()=>{e.AFrameworkApplication.EFd&&e.AFrameworkApplication.za.mb.mP&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").bFl()}}get name(){return"Common.App.O365Shell"}fc(Oa){this.Da=
Oa;this.Da.register(xb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().na(()=>new xb(new m.a(()=>e.AFrameworkApplication.Me),e.AFrameworkApplication.fa,e.AFrameworkApplication.za.mb.Ej))}init(){e.AFrameworkApplication.fa.Ue(this.Pn)}dispose(){}static main(){n.a.instance.Ac(new dc)}}Object(k.a)(dc,"PackageManager",null,[2,3]);var gb=d(75),gc=d(273);class Ac{constructor(Oa){this.Ma=new gb.a;this.nJ=Oa}sOc(Oa){this.Ma.addHandler(Ac.nBa,Oa)}v3e(Oa){this.Ma.removeHandler(Ac.nBa,
Oa)}I$e(){this.Ma.raiseEvent(Ac.LQb)}H$e(){this.Ma.raiseEvent(Ac.MQb)}}Ac.LQb="SE";Ac.MQb="SEP";Ac.nBa="SER";Ac.aff="TRP";Object(k.a)(Ac,"NullSessionExpirationManager",null,[1092,604]);var $b=d(168);class jc{constructor(){this.W0b=this.QRa=!1;this.wMb=()=>{gc.a.instance.vEh(this.wMb);r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.ene()};this.yrc=()=>{gc.a.instance.qCl(this.yrc);this.W0b||this.QRa||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),
this.W0b=!0,this.oaf())};const Oa=e.AFrameworkApplication.Im;0>=Oa||(this.Im=Oa,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Im,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.mea}),gc.a.instance.m_d(this.wMb),gc.a.instance.l_d(this.yrc))}ene(){this.QRa||(e.AFrameworkApplication.Lp($b.a.sessionAccessTokenExpired),this.QRa=!0,this.UAd())}}Object(k.a)(jc,"ASessionExpirationManager",null,[]);var pb=d(289),$a=d(36);class zc{constructor(Oa,
sb,Pb,kc){this.pef="";this.dDc=Oa;this.tFf=Pb;this.qFf=kc;this.bwf=sb;Oa=(new Date(this.dDc)).format(e.AFrameworkApplication.vPh);this.pef=this.bwf?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,Oa)}JQb(Oa){1===Oa?this.tFf&&this.tFf(this.bwf):0===Oa&&e.AFrameworkApplication.Pa.Ia($a.a.close,2,pb.g)}dispose(){this.qFf&&this.qFf()}}zc.id="SessionExpirationDialog";Object(k.a)(zc,"SessionExpirationDialogSharedProperties",null,[]);class rb{}
rb.Wg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(k.a)(rb,"SessionExpirationDialogHtml",null,[]);class ib extends A.a{constructor(Oa,sb,Pb,kc){super(sb);const Wc={};this.mDa=new zc(Oa,sb,Pb,kc);this.Fg=zc.id;e.AFrameworkApplication.FUf?(this.Fd=1,this.Te(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Is=!1);sb||1===e.AFrameworkApplication.za.mode?this.Te(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Te(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Wg=rb.Wg;Wc.WACSessionExpirationText=this.mDa.pef;this.Vj(CommonUIStrings.l_DefaultDialogTitle,Object(C.a)(this,this.JQb,"sessionExpirationDialogHandler"),Wc);this.M7(this.ki("WACSessionExpirationText"))}JQb(Oa){this.mDa.JQb(Oa)}L6c(){return this.UR}Qcc(){this.hide()}dispose(){super.dispose();this.mDa&&this.mDa.dispose()}}Object(k.a)(ib,"LegacySessionExpirationDialog",A.a,[1250]);var Vb=d(111);class Od extends Vb.StandardDialog{constructor(Oa,
sb,Pb,kc){super(sb);this.mDa=new zc(Oa,sb,Pb,kc);this.Fg=zc.id;e.AFrameworkApplication.FUf?(this.Fd=1,this.Te(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Is=!1);sb||1===e.AFrameworkApplication.za.mode?this.Te(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Te(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Ky(CommonUIStrings.l_DefaultDialogTitle,this.mDa.pef,0,Object(C.a)(this,this.JQb,"sessionExpirationDialogHandler"))}JQb(Oa){this.mDa.JQb(Oa)}L6c(){return this.UR}Qcc(){this.hide()}dispose(){super.dispose();
this.mDa&&this.mDa.dispose()}}Object(k.a)(Od,"SessionExpirationDialog",Vb.StandardDialog,[1250]);const jb=(Oa,sb,Pb,kc)=>e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.SD&&e.AFrameworkApplication.fa.getBooleanAppSetting("ReactStandardSessionExpirationDialogIsEnabled")?new Od(Oa,sb,Pb,kc):new ib(Oa,sb,Pb,kc);var Wb=d(225);class qb extends jc{constructor(Oa){super();this.jub=this.kub=!0;this.YQ=null;this.Ma=new gb.a;this.azb=()=>{this.YQ=null};this.KQb=()=>{this.nJ.refreshDocument(null)};
this.nJ=Oa}sOc(Oa){this.Ma.addHandler(qb.nBa,Oa)}v3e(Oa){this.Ma.removeHandler(qb.nBa,Oa)}I$e(Oa){this.kub=Oa}H$e(Oa){this.jub=Oa}oaf(){this.YQ||Wb.a.ly||(this.jub&&(this.YQ=jb(this.Im,!1,this.KQb,this.azb)),this.Ma.raiseEvent(qb.MQb))}UAd(){this.YQ&&(this.YQ.L6c()&&this.YQ.Qcc(),this.YQ=null);this.kub&&(this.YQ=jb(this.Im,!0,this.KQb,this.azb));this.Ma.raiseEvent(qb.LQb)}}qb.LQb="SE";qb.MQb="SEP";qb.nBa="SER";qb.aff="TRP";Object(k.a)(qb,"SessionExpirationManager",jc,[1092,604]);var Ga=d(18);class cb{}
cb.Tri="Aborting";cb.vNc="ActivityDuration";cb.error="Error";cb.Zbe="Errors";cb.failed="Failed";cb.uYc="FirstActivity";cb.iXa="Initialized";cb.Nuk="KickedOut";cb.Vuk="LastActivity";cb.gHh="RetryOverride";cb.Qvd="RequestGroups";cb.F2a="Requests";cb.cwd="Responses";cb.fyd="SessionDuration";cb.status="Status";cb.success="Success";cb.V6l="Successful";cb.tokens="Tokens";cb.ZXe="PollingDuration";Object(k.a)(cb,"SessionExpirationStrings",null,[]);var Ob=d(80);class Db{constructor(Oa){this.Rz={};this.r8=
{};this.yRa={};this.hKg=15;this.jxf=!1;this.Eni=new Date;this.VHc=new Date;this.f6h=()=>{r.ULS.sendTraceTag(41964821,217,50,r.ULS.Qye({["Aggregate"]:this.r8,["Current"]:this.Rz}))};this.je=Oa;this.o9=new Ob.a(2,2,6E4*this.hKg,this.f6h,135,"SL",!1);this.je.Jb(this.o9);this.H$j()}H$j(){this.r8[cb.Qvd]=0;this.r8[cb.F2a]=0;this.r8[cb.cwd]=0;this.r8[cb.status]=cb.iXa;this.r8[cb.uYc]=new Date;this.r8[cb.fyd]=0;this.r8[cb.vNc]=0;this.r8[cb.fyd]=0;this.Rz[cb.fyd]=0;this.r8[cb.vNc]=0;this.Rz[cb.vNc]=0}get Bgl(){this.yRa[cb.ZXe]=
+new Date-+this.yRa[cb.uYc];return this.yRa}npe(Oa,sb){var Pb=Oa[sb];Pb=Pb?Pb:0;Pb++;Oa[sb]=Pb;this.Y7e(Oa)}Y7e(Oa){const sb=new Date;Oa[cb.vNc]=+sb-+this.VHc;this.VHc=sb;Oa[cb.fyd]=+this.VHc-+this.Eni;Oa[cb.Vuk]=this.VHc}k_(Oa,sb){this.Rz[Oa]=sb;this.Y7e(this.Rz)}C7e(Oa,sb){this.Rz[Oa]=sb;this.Y7e(this.Rz)}YCb(Oa){this.npe(this.Rz,Oa);this.npe(this.r8,Oa);this.npe(this.yRa,Oa)}flush(){this.jxf||(this.r8[cb.status]=this.Rz[cb.status],this.f6h(this.o9),this.je.G7(this.o9,6E4*this.hKg))}BFl(){const Oa=
this.Rz[cb.status];Oa&&(this.r8[cb.status]=Oa);this.Rz={}}IFl(){this.yRa={};this.yRa[cb.ZXe]=0;this.yRa[cb.uYc]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.jxf=!0;this.je.Vg(this.o9)}}Object(k.a)(Db,"SessionLogger",null,[1088]);class mb{constructor(Oa,sb){this.tMc=Oa;this.Dja=sb}get tokens(){return this.tMc}get errors(){return this.Dja}}Object(k.a)(mb,"TokenRefreshArgs",null,[1124]);var Vc=d(97),Zb=d(204),fc=d(141);class ob extends Sys.EventArgs{constructor(Oa,
sb,Pb,kc,Wc,Xd,Gd){super();this.yRa=Oa;this.Qvd=kc;this.failed=Wc;this.F2a=Xd;this.cwd=Gd}}Object(k.a)(ob,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var ub=d(89);class bc{constructor(Oa,sb=null,Pb=null){this.W0b=this.QRa=!1;this.jub=this.kub=!0;this.Ma=new gb.a;this.Y0b=this.nZb=this.vKc=!1;this.bTd=null;this.xCf=10;this.CHc=!1;this.Rul=()=>{this.rcc(!1);return!gc.a.instance.cIa(e.AFrameworkApplication.Im)};this.Ori=(kc,Wc)=>{gc.a.instance.V8c?this.wMb(kc,Wc):this.nPd?(this.nZb=!1,this.rcc(!1)):
(this.QRa||r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.wMb(kc,Wc))};this.Pri=(kc,Wc)=>{gc.a.instance.T8c?this.yrc(kc,Wc):(ha.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.nZb=!1,this.rcc(!0))};this.nYd=(kc,Wc)=>{gc.a.instance.T8c?this.yrc(kc,Wc):this.rcc(!0)};this.wMb=()=>{this.nPd||gc.a.instance.vEh(this.wMb);r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.ene(gc.a.instance.V8c)};
this.Gam=()=>{const kc=this.lk.Bgl;r.ULS.sendTraceTag(555255521,217,50,"{0}",Ya.c(kc));this.Ma.raiseEvent(bc.aff,new ob(kc,kc[cb.ZXe],kc[cb.uYc],kc[cb.Qvd],kc[cb.failed],kc[cb.F2a],kc[cb.cwd]))};this.Ijl=()=>{3E5<+new Date-+this.jyf?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.rcc(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.bXd=Oa;this.nPd=e.AFrameworkApplication.Otk;this.je=fc.a.instance;
r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.Im,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.mea});this.lk=sb||new Db(fc.a.instance);this.uka=Pb;gc.a.instance.m_d(this.Ori);gc.a.instance.l_d(this.nYd);Zb.SessionStatusManager.instance.d_d(this.nYd);Zb.SessionStatusManager.instance.dAi(this.Ijl);this.jyf=new Date;e.AFrameworkApplication.Ntk&&(gc.a.instance.U3d=this.Rul);Oa=!1;e.AFrameworkApplication.fa&&
(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.xCf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),Oa=e.AFrameworkApplication.fa.getBooleanAppSetting("WopiTokenRefreshWhenNetworkResumed"));Oa?Zb.SessionStatusManager.instance.d_d(this.Pri):Zb.SessionStatusManager.instance.d_d(this.nYd)}sOc(Oa){this.Ma.addHandler(bc.nBa,
Oa)}v3e(Oa){this.Ma.removeHandler(bc.nBa,Oa)}rcc(Oa){if(!this.vKc&&!this.nZb)if(this.uka&&this.uka.Oeb)this.Y0b=!0,this.lk.k_(cb.status,cb.Nuk),this.lk.flush(),this.lk.stop();else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",Oa,this.Y0b),this.Y0b)this.UAd();else{this.lk.flush();this.lk.BFl();this.lk.YCb(cb.Qvd);this.vKc=!0;this.CHc||(this.lk.IFl(),this.CHc=!0,this.F1i());const sb=this.bXd.pvl(Oa);sb.continueWith(()=>{if(this.bXd.sml(sb))this.lk.YCb(cb.V6l),
this.lk.k_(cb.status,cb.success),this.jub=!1,this.nPd&&(this.kub=!1),this.nZb=!1,this.jyf=new Date,this.$5l(),this.Ma.raiseEvent(bc.nBa,new mb(sb.result.tokens,null));else{const Pb=sb.result.errors;this.lk.YCb(cb.failed);this.lk.k_(cb.status,cb.failed);Oa||(this.Y0b=this.bXd.Bfc(Pb));this.Y0b&&(this.lk.k_(cb.Tri,JSON.stringify(Pb)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.nZb=!0;this.Ma.raiseEvent(bc.nBa,new mb(null,Pb))}this.lk.flush();this.vKc=!1})}}yrc(){this.W0b||this.QRa||
(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.W0b=!0,this.oaf(gc.a.instance.T8c))}ene(Oa){if(!this.QRa){var sb=Oa?$b.a.NNl:$b.a.sessionAccessTokenExpired;const Pb=Object.assign(new ub.a,{extendedProperties:new Map});Pb.extendedProperties.set("ErrorCode",String.format("{0}",sb));e.AFrameworkApplication.Lp(sb,void 0,["SessionExpired"],Pb);Oa||(Oa=new Date,sb=new Date(e.AFrameworkApplication.mea),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",
sb,Oa,+Oa-+sb),864E5>+Oa-+sb&&Vc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,Pb),2592E5>+Oa-+sb&&Vc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Pb));this.QRa=!0;this.UAd()}}$5l(){this.CHc&&(this.je.Vg(this.bTd),this.CHc=!1)}F1i(){this.bTd=new Ob.a(2,2,1E3*this.xCf,this.Gam,135);this.je.Jb(this.bTd)}}bc.LQb="SE";bc.MQb="SEP";bc.nBa="SER";bc.aff="TRP";Object(k.a)(bc,"ASessionExpirationManagerWithRefresh",
null,[]);class ic extends bc{constructor(Oa,sb,Pb=null,kc=null){super(sb,Pb,kc);this.YQ=null;this.azb=()=>{this.YQ=null};this.KQb=()=>{this.nJ.refreshDocument(null)};this.nJ=Oa}I$e(Oa){this.kub=Oa}H$e(Oa){this.jub=Oa}oaf(Oa){if(!this.YQ&&!Wb.a.ly){if(Oa)this.YQ=jb(e.AFrameworkApplication.kQb,!1,this.KQb,this.azb);else if(this.jub){if(this.vKc)return;this.YQ=jb(e.AFrameworkApplication.Im,!1,this.KQb,this.azb)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",bc.MQb,
Oa);this.Ma.raiseEvent(bc.MQb)}}UAd(){this.YQ&&(this.YQ.L6c()&&this.YQ.Qcc(),this.YQ=null);if(this.kub){this.lk.stop();if(this.uka&&this.uka.Oeb)return;this.YQ=jb(e.AFrameworkApplication.Im,!0,this.KQb,this.azb)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",bc.LQb);this.Ma.raiseEvent(bc.LQb)}}Object(k.a)(ic,"SessionExpirationManagerWithRefresh",bc,[1092,604]);class Rc{constructor(Oa,sb,Pb=null,kc=null){this.KHf=!1;this.Ja=null;this.mQa=Oa;this.ZQa=sb;this.lk=Pb||new Db(fc.a.instance);this.uka=
kc}create(){this.KHf=e.AFrameworkApplication.WA;if(!this.KHf)return new qb(this.mQa);r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ja)switch(e.AFrameworkApplication.Pom){case 1:r.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.Ja=new Ac(this.mQa);break;case 2:r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ja=new ic(this.mQa,this.ZQa,this.lk,this.uka);break;default:r.ULS.sendTraceTag(39408092,
217,50,"Creating new legacy SessionExpirationManager"),this.Ja=new qb(this.mQa)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ja).getName());return this.Ja}}Object(k.a)(Rc,"SessionExpirationManagerFactory",null,[1091]);var Fb=d(1264),Qb=d(19);class hc{}Object(k.a)(hc,"Error",null,[]);class Pc{}Object(k.a)(Pc,"NamedResult",null,[]);class uc extends Pc{}Object(k.a)(uc,"ErrorInfo",Pc,[]);var zb=d(411),ac=d(103),Jb=d(177),Yc=d(127),dd=d(728);
class id{constructor(Oa,sb,Pb,kc=null,Wc=!1,Xd=null,Gd=!1,Pe=!1,Lf=!1,Nf=!1,dg=!1){this.eDa=0;this.cta=this.Wn=null;this.tMc=new Ga.a;this.Dja=new Ga.a;this.hx=null;this.dZb=!1;this.Q1b=this.R1b=null;this.fFl=()=>{this.dGh()};this.je=Oa;this.CCf=sb;this.CCf.execute(Pg=>{Pg.dD(Yc.a.Aoe,Object(C.a)(this,this.h6k,"onHostResponseReceived"))});this.WT=Pb;this.hHf=new dd.a("WebServiceCall","TokenRefresh");this.lk=kc||new Db(Oa);this.zni=Wc;this.Wsa=Xd?Xd:Zb.SessionStatusManager.instance;this.asf=Gd;this.GFc=
Pe;this.Kni=Lf;this.Lni=Nf;this.BFf=dg}h6k(Oa){if(Oa.MessageId!==Yc.a.Aoe)ha.c(39408099,306,15,"Unexpected message.");else{var sb=new Ga.a,Pb=new Ga.a;this.lk.YCb(cb.cwd);var kc=Oa.Values[Jb.a.bLh];if(!kc||0>=kc.length)ha.c(40122317,306,15,"Found no tokens in the dictionary"),kc=Oa.Values;ha.c(40122318,306,100,"The Tokens array contains {0} tokens",kc.length);this.lk.k_("Correlation",Oa.CorrelationId);var Wc="";for(let Pe=0;Pe<kc.length;Pe++){this.lk.C7e(cb.tokens,kc.length);var Xd=kc[Pe],Gd=Xd;if(!Gd||
!Gd.Name)continue;this.lk.YCb(Gd.Name);const Lf=Xd;if(Lf&&Lf.Value)ha.c(39408128,306,100,"Received token with name: {0}",Lf.Name),sb.add(Lf),this.tMc.add(Lf),this.GFc||this.lk.k_(cb.status,cb.success),this.asf&&this.Wsa&&this.Wsa.XFl();else if(Xd=this.aLj(Xd),ha.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Gd.Name,JSON.stringify(Xd),this.cta),Pb.add(Xd),this.GFc||(this.Dja.add(Xd),Wc=JSON.stringify(Xd),this.lk.k_(cb.error,JSON.stringify(Xd)),this.lk.k_(cb.status,
cb.failed)),this.asf)for(const Nf of Xd.Errors)Gd=this.RAj(Nf),this.Wsa&&this.Wsa.Swi(Gd)}this.GFc?(0<Pb.count?this.Q1b?this.Q1b(new mb(sb,Pb)):ha.c(512267295,306,15,"Received errors but the promise has completed"):this.R1b?this.R1b(new mb(sb,Pb)):ha.c(512267294,306,15,"Received valid tokens but the promise has completed"),ha.c(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",sb.count,Pb.count,Oa.CorrelationId,this.cta)):(0<Pb.count&&""!==Wc?
(kc=Object.assign(new ub.a,{extendedProperties:new Map}),kc.extendedProperties.set("Errors",Wc),kc.extendedProperties.set("RetryCount",this.eDa.toString()),kc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),kc.extendedProperties.set("IsTokenExpiring",this.dZb.toString()),Vc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,kc)):Vc.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ha.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
sb.count,Pb.count,Oa.CorrelationId,this.cta),0<Pb.count&&!this.Bfc(Pb)?(Oa=this.WT.Gng(Pb),Oa!==this.WT.TPb&&(this.lk.C7e(cb.gHh,Oa),this.je.G7(this.Wn,Oa))):(this.lk.flush(),this.Wn&&(ha.c(39408131,306,100,"Deleting task {0} from task manager",this.Wn.name),this.je.Vg(this.Wn)),this.hx&&!this.hx.task.isCompleted?this.hx.Jg(new mb(sb,Pb)):ha.c(512267293,306,15,"Received results but the task has completed")))}}aLj(Oa){if(!Oa)return null;const sb=Object.assign(new uc,{Name:Oa.Name,Errors:[]});for(const Pb of Oa.Errors)Oa=
new hc,Oa.Id=Pb.Id,Oa.Details=zb.a.Ocb(Pb.Details,500),sb.Errors.push(Oa);return sb}dGh(){e.AFrameworkApplication.F1("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.eDa>=this.WT.Mgh?(ha.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.cta),this.b3i(this.hx)):(Vc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.uKh())}uKh(){const Oa={};Oa[Jb.a.bLh]=this.WT.tokens;this.Kni&&(Oa[Jb.a.RNl]=this.Lni);const sb=ac.a.create().toString();
ha.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.WT.tokens),this.eDa+1,sb,this.cta);this.CCf.execute(Pb=>{Pb.sendMessage(Yc.a.b0d,Oa,sb)});this.eDa++;this.lk.YCb(cb.F2a)}b3i(Oa){const sb=new Ga.a;for(let Pb=0;Pb<this.WT.tokens.length;Pb++){const kc=Object.assign(new uc,{Name:this.WT.tokens[Pb],Errors:[Object.assign(new hc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
sb.add(kc);this.Dja.add(kc)}this.je.Vg(this.Wn);this.lk.k_(cb.Zbe,JSON.stringify(this.Dja));this.lk.k_(cb.status,cb.failed);Oa&&!Oa.task.isCompleted&&Oa.Jg(new mb(new Ga.a,this.Dja))}pvl(Oa){e.AFrameworkApplication.F1("ej4if276;fheca743");e.AFrameworkApplication.F1("5d4fi128;abe10395");this.hHf.start();this.dZb=Oa;this.cta=ac.a.create().toString();ha.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.cta,this.dZb);this.eDa=0;this.Dja.clear();this.tMc.clear();this.hx=
new Ua.a;this.GFc?this.eGh(this.WT.Mgh).then(sb=>{this.hx&&!this.hx.task.isCompleted&&this.hx.Jg(sb);this.Q1b=this.R1b=null;this.lk.k_(cb.Zbe,JSON.stringify(this.Dja));this.lk.k_(cb.status,cb.success);this.lk.flush()}).catch(sb=>{this.hx&&!this.hx.task.isCompleted&&this.hx.Jg(Object(Fb.a)(1124,sb));this.Q1b=this.R1b=null;this.lk.k_(cb.Zbe,JSON.stringify(this.Dja));this.lk.k_(cb.status,cb.failed);this.lk.flush()}):(this.Wn=new Ob.a(this.WT.priority,2,this.WT.TPb,this.fFl,98,Yc.a.b0d,!0),this.zni&&
this.dGh(),this.je.Jb(this.Wn));return this.hx.task}eGh(Oa){const sb=this,Pb=new Promise((Pe,Lf)=>{sb.R1b=Pe;sb.Q1b=Lf;Vc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);sb.uKh()}),kc=this,Wc=new Promise((Pe,Lf)=>{window.setTimeout(()=>{Lf(kc.T0f("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},kc.WT.TPb)});let Xd=Oa;const Gd=this;return new Promise((Pe,Lf)=>{Xd--;Promise.race([Pb,Wc]).then(Nf=>{Vc.Health.instance.recordKpiSuccess("WACTokenRefresh",
null);Pe(Nf)}).catch(Nf=>{var dg=Gd.WT.TPb;if(Object(Qb.a)(1124,Nf)&&(Nf=Object(Fb.a)(1124,Nf),0<Nf.errors.count)){Gd.aAk(Nf.errors);Gd.RJf(Nf.errors);if(Gd.Bfc(Nf.errors)){Lf(Nf);return}const Pg=Gd.WT.Gng(Nf.errors);Pg!==Gd.WT.TPb?(Gd.lk.C7e(cb.gHh,Pg),dg=Pg):Gd.hsk(Nf.errors)&&(dg=0)}Xd?window.setTimeout(()=>{Gd.eGh(Xd).then(Pe).catch(Lf)},dg):(dg=Gd.T0f("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Gd.RJf(dg.errors),Lf(dg),ha.c(512267292,
306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Gd.cta))})})}RJf(Oa){for(const sb of Oa)this.Dja.add(sb)}hsk(Oa){if(!Oa.count)return!1;Oa=Oa.ga(Oa.count-1);return Oa.Errors.length?"TIMEOUT"==Oa.Errors[0].Id:!1}T0f(Oa,sb){const Pb=new Ga.a;for(let kc=0;kc<this.WT.tokens.length;kc++){const Wc=this.c3i(this.WT.tokens[kc],Oa,sb);Pb.add(Wc)}return new mb(new Ga.a,Pb)}c3i(Oa,sb,Pb){return Object.assign(new uc,{Name:Oa,Errors:[Object.assign(new hc,{Id:sb,Details:Pb})]})}aAk(Oa){if(Oa.count){Oa=
Oa.ga(Oa.count-1);Oa=JSON.stringify(Oa);var sb=Object.assign(new ub.a,{extendedProperties:new Map});sb.extendedProperties.set("Errors",Oa);sb.extendedProperties.set("RetryCount",this.eDa.toString());sb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());sb.extendedProperties.set("IsTokenExpiring",this.dZb.toString());Vc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,sb);this.lk.k_(cb.error,Oa);this.lk.k_(cb.status,cb.failed)}}sml(Oa){this.hHf.stop();
const sb=this.a1j(Oa.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!sb,this.cta,this.dZb,this.eDa,this.Dja.count,0<Oa.result.errors.count?Oa.result.errors.ga(0).Name:"",0<Oa.result.errors.count&&0<Oa.result.errors.ga(0).Errors.length?Oa.result.errors.ga(0).Errors[0].Id:"",0<Oa.result.errors.count&&0<Oa.result.errors.ga(0).Errors.length?
Oa.result.errors.ga(0).Errors[0].Details:"");return sb?!1:this.rml(Oa.result.tokens)}Bfc(Oa){return this.WT.Bfc(Oa)}rml(Oa){for(let sb=0;sb<Oa.count;sb++){const Pb=Oa.ga(sb);if(Pb.Name===Jb.a.accessToken){const kc=(new Date).getTime();Pb.Expiry>e.AFrameworkApplication.Im?(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Pb.Expiry,["NowGetTime"]:kc,["BootTime"]:e.AFrameworkApplication.mea},"PreviousAccessTokenTtl",e.AFrameworkApplication.Im),e.AFrameworkApplication.accessToken=
Pb.Value,e.AFrameworkApplication.Im=Math.floor(Pb.Expiry),e.AFrameworkApplication.ojf=kc,e.AFrameworkApplication.q9=Math.floor(Pb.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Pb.Expiry,["NowGetTime"]:kc,["BootTime"]:e.AFrameworkApplication.mea},"PreviousAccessTokenTtl",e.AFrameworkApplication.Im)}}return!0}a1j(Oa){let sb=!1;for(let Pb=0;Pb<Oa.count;Pb++){sb=!0;const kc=Oa.ga(Pb);r.ULS.sendTraceTag(39706829,
217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",kc.Name,JSON.stringify(kc.Errors),this.cta)}return sb}EGg(Oa){return Oa.includes("aadInteractionRequired")||Oa.includes("sessionRevocation")||Oa.includes("blockAccessForTenantRestrictions")||Oa.includes("revoked")||Oa.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}RAj(Oa){let sb=$b.a.sessionAccessTokenExpired;const Pb=parseInt(Oa.Id);Oa=Oa.Details;if(isNaN(Pb))sb=$b.a.Tom;
else{switch(Pb){case 401:sb=$b.a.Wom;this.BFf&&this.EGg(Oa)&&(sb=$b.a.O5h);break;case 403:sb=$b.a.Rom;this.BFf&&this.EGg(Oa)&&(sb=$b.a.O5h);break;case 500:sb=$b.a.Som;break;case 503:sb=$b.a.Vom}sb===$b.a.sessionAccessTokenExpired&&(sb=500<Pb?$b.a.Uom:$b.a.Qom)}return sb}}Object(k.a)(id,"TokenRefreshManager",null,[1090]);class Cc{constructor(){this.TPb=e.AFrameworkApplication.Zom;this.Mgh=e.AFrameworkApplication.Xom;this.tokens=e.AFrameworkApplication.HSj();this.priority=e.AFrameworkApplication.$om;
this.YDf=this.WSl();this.bYd=e.AFrameworkApplication.GSj()}Bfc(Oa){Oa=JSON.stringify(Oa);if(this.bYd&&0<this.bYd.length)for(const sb of this.bYd)if(0<sb.length&&0<=Oa.indexOf(sb))return!0;return!1}Gng(Oa){try{if(Oa)for(const sb of Oa)if(sb.Errors)for(const Pb of sb.Errors)if(Pb.Id in this.YDf)return Number.parseInvariant(this.YDf[Pb.Id].toString())}catch(sb){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",sb.toString())}return this.TPb}WSl(){const Oa=
{};try{if(!e.AFrameworkApplication.O2c()||0>=e.AFrameworkApplication.O2c().length||""===e.AFrameworkApplication.O2c()[0])return Oa;for(const sb of e.AFrameworkApplication.O2c())0<sb.length&&(Oa[sb]=e.AFrameworkApplication.Yom)}catch(sb){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",sb.toString())}return Oa}}Object(k.a)(Cc,"TokenRefreshPolicy",null,[1089]);class Nb{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.Ue(()=>
{this.gHa()})}gHa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}fc(Oa){this.Da=Oa;Oa.register(1088,"Common.App.SessionExpiration.ISessionLogger").ma().na(()=>new Db(fc.a.instance));Oa.register(1089,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().na(()=>new Cc);Oa.register(1090,"Common.App.SessionExpiration.ITokenRefreshManager").ma().na(()=>new id(fc.a.instance,
e.AFrameworkApplication.WU(),Oa.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),Oa.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.getBooleanAppSetting("WopiTokenRefreshSendTokenRequestWithoutTasks"),Oa.ub("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanAppSetting("WopiAllowTokenRefreshErrorTracking"),e.AFrameworkApplication.fa.getBooleanAppSetting("WopiTokenRefreshSyncMessageWithTimeout"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",
!1),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RevokedTokenExperiment",!1)&&e.AFrameworkApplication.fa.getBooleanAppSetting("ShowTokenRevocationErrorMessage")));Oa.register(1091,"Common.ISessionExpirationManagerFactory").ma().na(()=>new Rc(e.AFrameworkApplication.za,Oa.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Oa.resolve("Common.App.SessionExpiration.ISessionLogger"),
Oa.ub("Common.ISessionStatus")));Oa.register(1092,"Common.ISessionExpirationManagerWithDialog").ma().na(()=>Oa.resolve("Common.ISessionExpirationManagerFactory").create());Oa.register(604,"Common.ISessionExpirationManager").ma().na(()=>Oa.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){n.a.instance.Ac(new Nb)}}Object(k.a)(Nb,"SessionExpirationPackage",null,[2,3]);var nc=d(55),Kc=d(448),xd=d(38),Xc=d(154),Tb=d(122),he=d(142),re=d(61),ee=d(27),Yf=d(30),ke=d(29);class ef extends Wb.a{constructor(Oa,
sb){super();this.nha=null;this.oGk=!1;this.sHk="";this.R0g=this.S0g=this.dNg=this.eNg=null;this.Fd=3;this.Te(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Te(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=Oa;this.I1g=sb.Ok(re.a.rfl)}dispose(){this.nha=null;super.dispose()}showDialog(Oa){this.Vj(Oa);this.eNg=document.getElementById("btnMaximize");this.S0g=Object(C.a)(this,this.r9k,"onScaleUpButton");F.a.addHandler(this.eNg,"click",this.S0g);this.dNg=document.getElementById("btnEnsure");
this.R0g=Object(C.a)(this,this.q9k,"onScaleDownButton");F.a.addHandler(this.dNg,"click",this.R0g)}Vj(Oa){this.ysa=Object(C.a)(this,this.HTl,"setSlideOrientationRatio");this.vAa(Oa);this.Vm.style.width="420px";this.show()}hide(){this.Nb&&(e.AFrameworkApplication.za.Yx.zp(Tb.AFrame.j7),super.hide())}r9k(Oa){this.ia.nb(ke.a.Lxc,2);Oa.preventDefault();this.bX&&this.hide()}q9k(Oa){this.ia.nb(ke.a.Kxc,2);Oa.preventDefault();this.bX&&this.hide()}HTl(Oa){1===Oa?this.ia.nb(ke.a.Lxc,2):2===Oa?this.ia.nb(ke.a.Kxc,
2):ee.a.J(25277209,822,50,"Cancle the slide orientation change.");this.bX&&this.hide()}vAa(){this.sv();this.IB()}sv(){super.sv();Sys.UI.DomElement.addCssClass(this.Nb,this.sHk);var Oa=$get("WACDialogTitleText");Oa.innerText=ResourceStrings.l_SetSlideScaleTitle;Oa.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);Oa=document.createElement("div");Oa.id=this.ki("WACDialogHtmlPanel");Oa.className="WACDialogHtmlPanel";this.Vm.appendChild(Oa);this.nha=document.createElement("div");this.nha.id=
this.ki("WACDialogText");Oa.appendChild(this.nha);Oa=document.createElement("div");Oa.id=this.ki("Scalediv");Oa.className="WACDialogRow";this.nha.appendChild(Oa);var sb=document.createElement("label");sb.id=this.ki("Scalelabel");sb.innerText=ResourceStrings.L_SetSlideOrientationInformation;Oa.appendChild(sb);Oa=document.createElement("div");Oa.id=this.ki("ScaleMode");Oa.setAttribute("style","margin-left: 20px;");Oa.className="WACDialogRow";this.nha.appendChild(Oa);sb=ef.$0f(re.a.Wth+"_MaximizeFit_170x130x32",
this.I1g,ResourceStrings.L_SetSlideOrientationMaximize);sb.id=this.ki("btnMaximize");var Pb=document.createElement("td");Pb.className=String.format("clip{0}x{1}","170","130");Pb.setAttribute("style","border: #ccc 1px solid");Pb.appendChild(sb);sb=ef.$0f(re.a.Wth+"_Ensurefit_170x130x32",this.I1g,ResourceStrings.L_SetSlideOrientationEnsure);sb.id=this.ki("btnEnsure");var kc=document.createElement("td");kc.className=String.format("clip{0}x{1}","170","130");kc.setAttribute("style","border: #ccc 1px solid");
kc.appendChild(sb);var Wc=document.createElement("td");Wc.setAttribute("style","width: 30px;");sb=document.createElement("tr");sb.appendChild(Pb);sb.appendChild(Wc);sb.appendChild(kc);Pb=document.createElement("td");Pb.setAttribute("align","center");kc=document.createElement("label");kc.id=this.ki("Maxlabel");kc.className="UIFontBold";kc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Pb.appendChild(kc);kc=document.createElement("td");kc.setAttribute("align","center");Wc=document.createElement("label");
Wc.id=this.ki("Ensurelabel");Wc.className="UIFontBold";Wc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;kc.appendChild(Wc);const Xd=document.createElement("td");Xd.setAttribute("style","width: 30px;");Wc=document.createElement("tr");Wc.appendChild(Pb);Wc.appendChild(Xd);Wc.appendChild(kc);Pb=document.createElement("table");Pb.appendChild(sb);Pb.appendChild(Wc);Oa.appendChild(Pb)}IB(){this.bBd(Wb.a.etc+(Wb.a.jQ-ef.GMi)/2-12,Wb.a.dtc+(Wb.a.RS-ef.JMi)/2-12)}bBd(Oa,sb){this.Nb.style.top=(0>Oa?
0:Oa)+"px";Yf.a("DeprecateIE.SetSlideOrientation")?this.Nb.style.left=(0>sb?0:sb)+"px":nc.a.Leb&&e.AFrameworkApplication.isRtl?this.Nb.style.right=(0>sb?0:sb)+"px":this.Nb.style.left=(0>sb?0:sb)+"px";this.oGk||(this.Nb.style.width=String.format("{0}em",this.width));this.Nb.style.display="Block"}static $0f(Oa,sb,Pb){const kc=document.createElement("img");kc.className=Oa;kc.setAttribute("Unselectable","on");kc.setAttribute(he.a.Ff,he.a.gR);kc.src=sb;Pb&&(kc.alt=Pb,kc.title=Pb);return kc}}ef.JMi=350;
ef.GMi=200;Object(k.a)(ef,"SetSlideOrientationDialog",Wb.a,[]);var yf=d(51),Rf=d(110),Za=d(223),Kb=d(65);class Ic extends A.a{constructor(Oa,sb){super(!1,!1,!0);this.m_f=this.Y4=null;if(!Oa)throw Error.argumentNull("actionManager");if(!sb)throw Error.argumentNull("presentationReader");this.ia=Oa;this.Wb=sb}B$(){this.Y4=Object(C.a)(this,this.ITl,"setSlideSizeAndLayoutDialogResultHandler");this.m_f=this.lsj(this.getCurrentSlideDimensions());this.Vj(ResourceStrings.L_SetSlideSize,this.Y4,this.m_f)}ITl(Oa,
sb){1===Oa&&this.ia.Ia(ke.a.CNh,2,sb);this.dispose()}getCurrentSlideDimensions(){const Oa=this.Wb.Bw(),sb={};sb.height=Oa.height;sb.width=Oa.width;sb.slideType=this.Wb.jNj();return sb}lsj(Oa){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:Oa,["numberFormatInfo"]:Kb.e().numberFormatInfo}}}Object(k.a)(Ic,"SlideSizeAndLayoutDialog",A.a,[]);class Hc{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf){this.HKa=this.bpa=this.SV=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");
this.SSh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.fTh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=Oa;this.Fa=sb;this.uf=Pb;this.Eb=kc;this.Yb=Wc;this.sa=Xd;this.oa=Pe;this.Wb=Gd;this.te=Lf}qb(){this.ia.pa(ke.a.Ptd,yf.a.application,Object(C.a)(this,this.o0e,"querySlideSize"),96);this.ia.pa(ke.a.Otd,yf.a.application,Object(C.a)(this,this.o0e,"querySlideSize"),96);this.ia.pa(ke.a.p0e,yf.a.application,
Object(C.a)(this,this.o0e,"querySlideSize"),96);this.ia.xa(ke.a.KTl,yf.a.application,Kc.a.jI);this.ia.pa(ke.a.gol,yf.a.application,Kc.a.V2,96);this.ia.pa(ke.a.Nxc,yf.a.application,Object(C.a)(this,this.j_j,"handleSetSlideSize"),4);this.ia.pa(ke.a.nzd,yf.a.application,Object(C.a)(this,this.l_j,"handleSetSlideSize4x3"),4);this.ia.pa(ke.a.mzd,yf.a.application,Object(C.a)(this,this.k_j,"handleSetSlideSize16x9"),4);this.ia.pa(ke.a.mWe,yf.a.application,Object(C.a)(this,this.Lvk,"launchSlideSizeAndLayoutDialogHandler"),
4);this.ia.pa(ke.a.kbl,yf.a.application,Object(C.a)(this,this.vIg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.pa(ke.a.lbl,yf.a.application,Object(C.a)(this,this.vIg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.pa(ke.a.Lxc,yf.a.application,Object(C.a)(this,this.BNh,"setSlideOrientationHandler"),4);this.ia.pa(ke.a.Kxc,yf.a.application,Object(C.a)(this,this.BNh,"setSlideOrientationHandler"),4);this.ia.pa(ke.a.CNh,yf.a.application,Object(C.a)(this,this.JTl,"setSlideSizeAndLayoutHandler"),
4);this.ia.xa(ke.a.LTl,yf.a.application,Kc.a.jI);this.ia.xa(ke.a.setSlideHeight,yf.a.application,Kc.a.jI);this.ia.pa(ke.a.iol,yf.a.application,Kc.a.V2,96);this.ia.pa(ke.a.hol,yf.a.application,Kc.a.V2,96);this.ia.xa(ke.a.s4l,yf.a.application,Kc.a.jI);this.ia.xa(ke.a.r4l,yf.a.application,Kc.a.jI)}Sd(){}o0e(Oa,sb,Pb,kc,Wc){ee.a.J(34936782,822,50,"Click slide size drop down.");if(sb.contextId!==yf.a.application)return 2;if(sb=Object(Fb.a)(Rf.a,Wc))Oa=Hc.Vgk(this.Wb.Bw(),Oa),sb.Rf(Oa);return 32}Lvk(Oa,
sb,Pb){sb=this.sa.Aa;return!sb||this.uf.Xc(sb)||!Yf.a("DeprecateIE.CustomizeSlideSizeActor")&&nc.a.vy?8:1===Pb?32:Xc.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",Oa,()=>{(new Ic(this.ia,this.Wb)).B$();ee.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}vIg(Oa,sb,Pb,kc,Wc){Oa=this.sa.Aa;if(!Oa||this.uf.Xc(Oa))return 16;if(1===Pb)return 32;if("slideType"in Wc&&"slideWidth"in Wc&&"slideHeight"in Wc)if(this.HKa=6,"o_custom"===Wc.slideType.toString().toLowerCase())this.SV=
6*Math.round(Wc.slideWidth),this.bpa=6*Math.round(Wc.slideHeight);else{Pb=0;for(const Xd of this.slideSizeType){if(Wc.slideType.toString().toLowerCase()===Xd.toLowerCase()){this.HKa=Pb;break}Pb++}"landscape"===Wc.orientation.toString()?(this.bpa=this.SSh[Pb],this.SV=this.fTh[Pb]):(this.SV=this.SSh[Pb],this.bpa=this.fTh[Pb])}(new ef(this.ia,this.te)).showDialog(ResourceStrings.l_SetSlideScaleTitle);ee.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}j_j(Oa,sb,Pb){Oa=this.sa.Aa;return!Oa||
this.uf.Xc(Oa)?8:this.ia.nb(ke.a.Lab,Pb)}l_j(Oa,sb,Pb){ee.a.J(34936788,822,50,"click set slide size 4:3.");sb=this.sa.Aa;if(!sb||this.uf.Xc(sb))return 16;if(1===Pb||960===this.Wb.Bw().width)return 32;this.SV=5760;this.bpa=4320;this.HKa=0;return this.sRb(this.SV,this.bpa,Oa,this.HKa,"EnsureFit")}k_j(Oa,sb,Pb){ee.a.J(34936792,822,50,"click set slide size 16:9.");sb=this.sa.Aa;if(!sb||this.uf.Xc(sb))return 16;if(1===Pb)return 32;Pb=this.Wb.Bw();if(1280===Pb.width)return 32;this.SV=7680;this.bpa=4320;
this.HKa=16;return 960===Pb.width&&720===Pb.height?this.sRb(this.SV,this.bpa,Oa,this.HKa,""):this.sRb(this.SV,this.bpa,Oa,this.HKa,"EnsureFit")}JTl(Oa,sb,Pb,kc,Wc){sb=this.sa.Aa;return!sb||this.uf.Xc(sb)?8:1===Pb?32:this.sRb(Wc.width,Wc.height,Oa,Wc.slideType,Wc.slideScaleType)}BNh(Oa,sb,Pb){sb=this.sa.Aa;return!sb||this.uf.Xc(sb)?16:1===Pb?32:this.bpa&&this.SV?Oa===ke.a.Lxc?this.sRb(this.SV,this.bpa,Oa,this.HKa,"Maximize"):Oa===ke.a.Kxc?this.sRb(this.SV,this.bpa,Oa,this.HKa,"EnsureFit"):32:(ee.a.J(34936796,
822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}sRb(Oa,sb,Pb,kc,Wc){const Xd=this.sa.Aa;let Gd=!1;if(Xd){var Pe=Xd.yj();if(Pe&&0<Pe.length)for(const Lf of Pe)if(Lf.xHa){Gd=!0;break}}Pe=this.Eb.ud(15,void 0,()=>{this.Fa.Gd();this.oa.Bh()});try{Pe.rd(Xd),Pe.Wc=Pb,Pe.ny[Za.a.pCb]=Gd,Xd.setValue(xd.a.slideWidth,Oa),Xd.setValue(xd.a.slideHeight,sb),Xd.setValue(xd.a.slideScaleType,Wc),Xd.setValue(xd.a.slideSizeType,kc)}finally{Pe&&Pe.dispose()}ee.a.J(34936798,
822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",Oa,sb,Wc);this.uf.i4b(this.Yb.Of,Xd,Pb);return 32}static Vgk(Oa,sb){Oa=Oa.width/Oa.height;switch(sb){case ke.a.Ptd:return.01>Math.abs(Oa-1.33);case ke.a.Otd:return.01>Math.abs(Oa-1.77);default:return!1}}}Object(k.a)(Hc,"CustomizeSlideSizeActor",null,[948]);class jd{}jd.xGh=0;jd.HFl=22711;Object(k.a)(jd,"ImageConstants",null,[]);var Id=d(235),ze=d(331),Ie=d(452),Cd=d(41),ue=d(106),Ee=d(247),Xe=d(114);class Sd extends Xe.a{constructor(){super();
this.ImageToken=null;this.ErrorCode=0}om(){return 78}}Object(k.a)(Sd,"NotifyImageUploadFailureRequest",Xe.a,[]);class ad{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf,dg,Pg,pi,li,Ri,Ih,ij,Fi,Da,Wa,lb,Lb,oc){this.V6=this.eZa=this.hv=null;this.Ejb=!1;this.d8k=(Jc,bd)=>{(Jc=y.a.instance.Ha("Common.ISystemInitiatedFeedback"))&&bd&&bd.Cnk&&Jc.execute(rd=>{rd.logActivity("InsertPicture",null)})};this.ia=Oa;this.gb=Pb;this.ic=sb;this.sa=Wc;this.Eb=Xd;this.Fa=kc;this.pB=Gd;this.uS=Pe;this.Vk=Lf;this.RKe=Nf;this.Dr=
dg;this.fe=Pg;this.yb=pi;this.bnc=li;this.hlc=Ri;this.RZa=Ih;this.Qi=ij;this.Lj=Fi;this.Ba=Da;this.Ql=Wa;this.Hc=lb;this.DV=Da.INb;this.Ga=Lb;this.oLk=null===oc||void 0===oc?void 0:oc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",!1);this.ps()}ps(){this.oLk&&this.Hc.ozi(this.d8k)}qb(){this.ia.pa(ke.a.insertPicture,Y.a.application,Object(C.a)(this,this.Dsg,"handleInsertPicture"),4);this.ia.pa(ke.a.iYc,Y.a.view,Object(C.a)(this,this.m0j,"handleUploadPictureAll"),
4);this.ia.pa(ke.a.sRc,Y.a.application,Object(C.a)(this,this.LUj,"handleChangePicture"),4);this.ia.pa(ke.a.Xvd,Y.a.application,Object(C.a)(this,this.EZj,"handleResetPicture"),4);this.ia.pa(ke.a.vGh,Y.a.application,Object(C.a)(this,this.FZj,"handleResetPictureAndSize"),4);this.ia.pa(ke.a.wGh,Y.a.application,Object(C.a)(this,this.GZj,"handleResetPictureSplitButton"),4);this.ia.pa(ke.a.Nta,Y.a.application,Object(C.a)(this,this.MUj,"handleChangePictureStyle"),4);this.ia.pa(ke.a.yae,Y.a.application,Object(C.a)(this,
this.Dsg,"handleInsertPicture"),4);this.ia.pa(ke.a.e7f,Y.a.application,Object(C.a)(this,this.BVj,"handleDragAndInsertImage"),4)}Sd(){}Dsg(Oa,sb,Pb){this.Ba.rBg&&!Yf.a("DummyChangeGateForTest")&&ee.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");sb=this.sa.Aa;sb=this.Ba.n8c&&!!sb&&!this.ic.Xc(sb);sb=(this.hlc=this.bnc.jfk()&&this.hlc)?sb&&!!this.pB&&this.pB.zFd:this.uS.VBg&&sb;if(!sb)return 16;if(1===Pb)return 32;this.Ejb=!0;this.V6=this.sa.Aa;this.XAd(Oa!==ke.a.yae,
!0);return 32}m0j(Oa,sb,Pb,kc,Wc){var Xd;sb=this.sa?this.sa.Aa:null;if(!sb||!sb.isConnected)return 16;if(!this.Lj.UD(sb,1))return this.Lj.yE(sb),16;if(Yf.a("ImageFileExtLogsForSaveImageToDisk")&&this.Ejb)var Gd=(Gd=this.pB.pag(null!==(Xd=null===Wc||void 0===Wc?void 0:Wc.fileName)&&void 0!==Xd?Xd:""))?`: image file ext - ${Gd}`:"";ee.a.J(512500497,822,50,"PictureActor::handleUploadPictureAll Start picture upload{0}",null!==Gd&&void 0!==Gd?Gd:"");Xd=ad.yrk(Wc);(Gd=Cd.a.Kb)&&Gd.Wa(ue.a.Vbk,Xd?"1":"0");
this.Hc.Vrl();kc=!1;if(this.Ejb&&this.hlc&&!this.pB.mob&&this.klk(Xd)){if(sb=sb.U0(this.gb.Hd())){if(15!==sb.mj){const Pe=sb.ZS;Pe.BottomLeft.X!==Pe.TopLeft.X&&(kc=!0)}Gd&&Gd.Wa(ue.a.iIl,kc?"1":"0")}sb&&(15===sb.mj||kc)?(Gd&&Gd.Wa(ue.a.Yce,kc?"PlaceHolder Rotated":"Picture Type PlaceHolder"),Oa=this.Ltg(Oa,Pb,Wc)):Oa=this.o0j(Oa,Pb,Wc)}else this.pB.mob=!1,Oa=this.Ltg(Oa,Pb,Wc);Xd&&32===Oa&&ee.a.J(512500496,822,50,"Upload a svg file successfully.");return Oa}klk(Oa){return Oa?this.Ba.powerPointInsertSVGFileLocalRenderingEnabled:
!0}BVj(Oa,sb,Pb,kc,Wc){if(!this.pB.Xfl)return ee.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Wc)return 16;Oa=[];sb=0;Pb=!1;for(const Xd of Wc)if(sb++,"string"===typeof Xd.type)if(Wc=oa.a.Dg(Xd.type),ee.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",sb,Xd.size,Wc),0<=Wc.indexOf("image")&&0===this.pB.QFd(Xd.name))if(Oa.length<this.Ba.powerPointDragInsertMultipleImageQuantityLimit)Array.add(Oa,
Xd);else{this.Ql.oM(19);break}else Pb||(this.Ql.oM(18),Pb=!0);if(1>Oa.length)return ee.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.pB.sej(Oa);return 32}Ltg(Oa,sb,Pb){if(!(this.sa&&this.sa.Aa&&this.pB))return 16;if(1===sb)return 32;this.uS.olb=new Date;this.Ejb&&this.gb.uj();this.Fa.Gd();this.ic.blockContent(this.sa.presentation,Oa);const kc=Cd.a.Kb;this.pB.Mbf(Pb,Wc=>{Cd.a.TJ(kc,()=>{ee.a.J(512500492,822,50,"Picture upload successful");this.lYj(Pb,
Wc,Oa);this.keg()})},Wc=>{ee.a.J(512500491,822,10,"Upload picture failed");this.ucc(Wc.error);this.keg()});return 32}o0j(Oa,sb,Pb){if(!(this.sa&&this.sa.Aa&&this.pB))return 16;if(1===sb)return 32;const kc=String.format("{0}{1}","client",ac.a.create().toString());ee.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",kc,Pb.jK);this.uS.cIi(kc);const Wc=Cd.a.Kb;Wc&&(sb="InsertPicture",this.Ejb||(sb="ChangePicture"),Wc.actionName=sb,Wc.tk=!0);const Xd=new Date;Cd.a.Xk("PictureUploadStart",
Cd.a.Ef(Xd));Cd.a.Xk("ImageSize",Pb.jK.toString());Cd.a.Xk("ImageToken",kc);const Gd=this.sa.Aa.sid;this.ia.Ia(ke.a.uqe,2,Gd);this.pB.Mbf(Pb,Pe=>{Cd.a.TJ(Wc,()=>{ee.a.J(512500489,822,50,"Upload picture completed");Cd.a.Xk("PictureUploadDurationMS",(+new Date-+Xd).toString());this.Wfl(kc,Pe);this.ia.Ia(ke.a.l5c,2,Gd)})},Pe=>{this.uS.a9f(kc);var Lf=Object.assign(new Sd,{ImageToken:kc,ErrorCode:Pe.error.Code});Wc&&Wc.Wa("UploadPictureErrorCode",Id.a[Lf.ErrorCode]);Lf=new Ee.a(Lf,null,()=>ad.z7k());this.Qi.Jb(Lf);
ee.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",kc,Id.a[Pe.error.Code],Pe.error.Message);this.ia.Ia(ke.a.l5c,2,Gd)},kc);this.insertPicture(kc,Oa,Pb);return 32}LUj(Oa,sb,Pb){Oa=this.DV?this.mcb():this.eBb();if(!(this.DV?this.Cfc(Oa):this.o8c(Oa)&&this.Ba.n8c&&this.uS.VBg&&!this.ic.Xc(Oa)))return 16;if(1===Pb)return 32;this.Ejb=!1;this.XAd(!0,!1);return 32}EZj(Oa,sb,Pb){return this.Nta(sb,Pb,jd.xGh,Oa)}FZj(Oa,sb,Pb){return this.Nta(sb,Pb,jd.HFl,Oa)}GZj(Oa,
sb,Pb,kc,Wc){return this.Nta(sb,1,Wc,Oa)}MUj(Oa,sb,Pb,kc,Wc){return this.Nta(sb,Pb,Wc,Oa)}Nta(Oa,sb,Pb,kc){const Wc=this.gb.Hd();if(!(Wc&&0<Wc.length))return 8;Oa=[];if(Yf.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.kLj(Wc,Oa);else for(const Gd of Wc){if(this.GDg(Gd)||this.ic.Xc(Gd))return 8;(this.DV?this.Cfc(Gd):this.o8c(Gd))&&Oa.push(Gd)}if(0>=Oa.length)return 8;if(1===sb)return 32;ee.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Pb);sb=Cd.a.Kb?Cd.a.Kb.actionName:
null;for(var Xd of Oa)this.Xla(Xd);Xd=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});try{Xd.mc(Oa[0]);Xd.Wc=kc;for(const Gd of Oa)Gd.B1a=Pb}finally{Xd&&Xd.dispose()}if(kc=Cd.a.Kb)sb&&(kc.actionName=sb),kc.Wa("PictureStyleId",Pb.toString()),Cd.a.Y2(kc);return 32}kLj(Oa,sb){let Pb=!1;for(const kc of Oa){if(!kc||this.GDg(kc)||this.ic.Xc(kc))return;kc.Rg&&(Pb=!0)}if(Pb)for(const kc of Oa)kc.Rg&&this.Cfc(kc)&&sb.push(kc);else for(const kc of Oa)if(this.Cfc(kc))sb.push(kc);else if(kc.Lf){Oa=this.Ga.rx(kc);
for(const Wc of Oa)this.Cfc(Wc)&&sb.push(Wc)}}lYj(Oa,sb,Pb){this.uS.C1a=new Date;const kc=sb.result;if(Oa){if(this.Ejb?(sb="InsertPicture",this.Bbk(kc,Oa,Pb)):(sb="ChangePicture",Yf.a("ChangePictureOnMultiSelectFixEnabled")?this.hRi(kc,Oa,Pb):this.iRi(kc,Oa,Pb)),Oa=Cd.a.Kb)Oa.actionName=sb,Oa.Wa("PictureUploadStart",Cd.a.Ef(this.uS.olb)),Oa.Wa("PictureUploadDurationMS",(+this.uS.C1a-+this.uS.olb).toString())}else Oa=Object.assign(new ze.a,{Code:94}),this.ucc(Oa)}Wfl(Oa,sb){this.uS.a9f(Oa);sb.result||
ee.a.J(512500486,822,50,"Upload picture completed with null response")}Bbk(Oa,sb,Pb){const kc=this.sa.Aa;if(kc&&kc.isConnected){this.eZa=kc.U0(this.gb.Hd());var Wc=this.Eb.ud(15,void 0,void 0,()=>{this.gb.selectShape(this.hv,!0);this.Fa.Gd()});try{Wc.mc(kc),Wc.Wc=Pb,Wc.ny[Za.a.Rea]=Za.a.Feg,this.hv=this.Vk.a3i(kc.Fb),this.eZa&&(this.hv.J4=this.eZa.id),this.hv.Syd(Oa.ItemId,sb.fileName),kc.ZB(this.hv)}finally{Wc&&Wc.dispose()}this.ic.Kta(this.sa.Aa,this.hv,this.yb.Na,"InsertPictureAfterUpload");this.Dr.YA=
this.hv}}hRi(Oa,sb,Pb){var kc=this.gb.Hd();if(kc){var Wc=[];for(const Xd of kc)Xd.Lf||Wc.push(Xd);for(const Xd of Wc)this.Xla(Xd);kc=this.Eb.ud(15);try{kc.Wc=Pb;kc.mc(Wc[0]);for(const Xd of Wc)Xd.J4=Xd.id,Xd.Syd(Oa.ItemId,sb.fileName),Xd.set_alt("")}finally{kc&&kc.dispose()}for(const Xd of Wc)this.ic.Kta(this.sa.Aa,Xd,this.yb.Na,"ChangePictureAfterUpload")}}iRi(Oa,sb,Pb){const kc=this.DV?this.mcb():this.eBb();if(kc){this.Xla(kc);var Wc=this.Eb.ud(15);try{Wc.Wc=Pb,Wc.mc(kc),kc.J4=kc.id,kc.Syd(Oa.ItemId,
sb.fileName),kc.set_alt("")}finally{Wc&&Wc.dispose()}this.ic.Kta(this.sa.Aa,kc,this.yb.Na,"changePictureAfterUploadSingleImage")}}ucc(Oa){this.uS.C1a=new Date;ee.a.J(512500484,822,50,"Upload picture failed");this.fe.iI(Oa.Code,sb=>{sb.yD=1;sb.YUa=Oa.ExtraErrorParam;return!1})}keg(){this.ic.vL(this.sa.presentation)}XAd(Oa,sb){this.RKe?Ie.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.pB&&(this.pB.D$c=this.hlc,this.pB.FUb=0,Oa&&this.pB.Oxh(sb))}eBb(){const Oa=this.gb.Hd();
for(const sb of Oa)if(sb&&sb.$j)return sb;return null}mcb(){const Oa=this.gb.Hd();return Oa&&Oa.length?this.V0d(Oa)?Oa[0]:this.eBb():null}V0d(Oa){if(!Oa||!Oa.length)return!1;let sb=Oa[0].$j,Pb=1===Oa[0].mediaType;for(const kc of Oa)sb=sb&&kc.$j,Pb=Pb&&1===kc.mediaType;return sb||Pb}ik(Oa){return Oa?Object(Fb.a)(178,Oa.sc(this.yb.Na)):null}Xla(Oa){Oa&&Oa.Iv&&(Oa=this.ik(Oa))&&Oa.qW(!1)}o8c(Oa){return!this.sa||!this.sa.Aa||!Oa||this.Ba.enableCameoInEditor&&Oa.lF||!Oa.$j?!1:!0}Cfc(Oa){return!this.sa||
!this.sa.Aa||!Oa||this.Ba.enableCameoInEditor&&Oa.lF||!Oa.$j&&1!==Oa.mediaType?!1:!0}GDg(Oa){return this.sa&&this.sa.Aa&&Oa&&Oa.Vp?!0:!1}insertPicture(Oa,sb,Pb){var kc=this.sa.Aa;const Wc=Object(Fb.a)(227,kc.sc(this.yb.Na)),Xd=this.V6.Fb;if(kc&&kc.isConnected&&Wc&&this.V6&&this.V6.isConnected){kc=this.V6.wt();this.eZa=this.V6.U0(this.gb.Hd());var {ede:Gd,gD:Pe}=this.RZa.k6d(this.eZa,Pb.imageWidth,Pb.imageHeight),Lf=this.Eb.ud(15,void 0,()=>{this.gb.Pu();this.gb.Bh();this.Fa.Gd()},()=>{this.Dr.YA=
this.hv;this.gb.selectShape(this.hv,!0)});try{Lf.mc(this.V6);Lf.Wc=sb;this.hv=this.Vk.Cla(!0,Xd.cid,Xd.sid,0,Pe.x,Pe.y,Gd.width,Gd.height,kc+1,!1);const Nf=this.RZa.j2d(this.yb.Xd,Gd,Pe,Wc.cV);this.hv.ZS=Nf;this.eZa&&(this.hv.J4=this.eZa.id,this.V6.XS([this.eZa]));this.hv.Syd(Oa,Pb.fileName);this.hv.isResizable=!0;this.hv.ifc=!0;this.hv.SM=!0;this.hv.Cha=!0;this.hv.$j=!0;this.hv.Szb=!!Pb.VLb;this.hv.lga=Pb.VLb||Pb.t4c;this.V6.ZB(this.hv)}finally{Lf&&Lf.dispose()}Cd.a.tgf()}}static yrk(Oa){return!!Oa&&
!!Oa.fileName&&Oa.fileName.toLowerCase().indexOf(".svg")===Oa.fileName.length-4}static z7k(){ee.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(k.a)(ad,"PictureActor",null,[948]);var af=d(113),pf=d(212),xf=d(739),gf=d(936),me=d(85);class ag extends Sys.EventArgs{constructor(Oa,sb){super();this.Onk=Oa;this.o9c=sb}}Object(k.a)(ag,"TokenRefreshEventArgs",Sys.EventArgs,[]);class de{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd){this.NKb=0;this.Nc=Oa;this.$Ne=sb;this.kv=Pb;this.ia=kc;
this.Hp=Wc;this.zb=Xd;this.Ba=Gd;this.$Ne&&this.$Ne.sOc(Object(C.a)(this,this.Kqh,"onTokenRefreshed"))}n4d(Oa){!this.Ba.podTokenRefreshImprovementEnabled&&this.zb.Jva&&this.zb.dNa();const sb=gc.a.instance.cIa(e.AFrameworkApplication.Im),Pb=gc.a.instance.S8c(e.AFrameworkApplication.Im,e.AFrameworkApplication.Cka);ee.a.J(508694619,801,sb||Pb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",sb,Pb,Oa,this.Ba.podTokenRefreshImprovementEnabled,
this.NKb);gc.a.instance.C$a();this.Ba.podTokenRefreshImprovementEnabled&&this.zb.Jva&&this.zb.dNa()}Kqh(Oa,sb){ee.a.J(508694618,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Pb=Object(Fb.a)(mb,sb)||new mb(null,null),kc=Pb.tokens,Wc=Pb.errors;Oa="";if(void 0===Wc||null===Wc||0>=Wc.count)for(sb=0;sb<kc.count;sb++)if(kc.ga(sb).Name===Jb.a.SNl){const Gd=kc.ga(sb)?kc.ga(sb):null;Oa=Gd&&Gd.Value&&0<Gd.Value.length?Gd.Value:"";break}const Xd=gc.a.instance.cIa(e.AFrameworkApplication.Im);ee.a.J(508694617,
809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Xd,this.Ba.RYe,this.NKb,this.Ba.Yvh);if(0<Oa.length&&Xd&&this.Ba.RYe&&this.NKb<this.Ba.Yvh)ee.a.J(508694616,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,e.AFrameworkApplication.Im,new Date(e.AFrameworkApplication.Im),this.Ba.RYe,this.NKb),this.NKb++,this.n4d(2);else if(0<Oa.length&&!Xd){ee.a.J(508694615,809,Xd?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Im,new Date(e.AFrameworkApplication.Im));pf.App.zhe=e.AFrameworkApplication.Vyb=oa.a.We(Oa);const Gd=this.kv.Itc.presentationId.ccf+
"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.Im.toString());this.kv.Itc=new gf.a(new xf.a(Gd));this.Nc.kAh(new ag(this.Hp?this.Hp.S0:!1,!0))}else{if(Yf.a("CleanPIIFromC49mm")&&Wc)for(const Gd of Wc)if(Gd.Errors)for(const Pe of Gd.Errors)"403"===Pe.Id&&Pe.Details&&Pe.Details.startsWith("<")&&(Pe.Details=null);ee.a.J(508694614,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
Wc?af.c(Wc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.NKb);Wc&&0<=af.c(Wc).indexOf("The caller is not authenticated")?(e.AFrameworkApplication.Lp(me.a.hi(383)),Vc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.Lp(me.a.hi(380)),Vc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.Zx&&e.AFrameworkApplication.Zx.ffa();this.Nc.kAh(new ag(this.Hp?
this.Hp.S0:!1,!1));this.ia.Ia(ke.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Pb){ee.a.J(508694613,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",af.c(Pb))}}dispose(){this.$Ne.v3e(Object(C.a)(this,this.Kqh,"onTokenRefreshed"))}}Object(k.a)(de,"PPTTokenRefreshManager",null,[1067]);var wa=d(86),ta=d(664);class Eb{constructor(Oa,sb,Pb,kc,Wc,Xd){this.HZ=this.pom=this.f4e=null;this.v9b=this.sde=!1;this.Ukd=
0;this.Hqb=Cd.a.Zj("SeamlessFailover");1!==sb&&2!==sb||Cd.a.iIa();this.pk=new Date;Cd.a.zFb=this.startTime;this.Aki=Pb;this.WTa=0;this.vmi=sb;this.bei=kc;this.lli=Wc;this.hcm=Xd;this.tlj=!1;this.resultCode=0;this.ysf=!0;if(Oa=e.AFrameworkApplication.ld)this.$c.Wa("Host",Object(Fb.a)(String,Oa.Host)),this.$c.Wa("Ring",Object(Fb.a)(String,Oa.Ring))}VNh(Oa,sb){this.Ukd=window.setTimeout(Oa,sb)}b6l(){this.ysf=!1}dispose(){Cd.a.Wgc=new Date;0<=this.Ukd&&(window.clearTimeout(this.Ukd),this.Ukd=-1)}get qlj(){return this.ysf}get $c(){return this.Hqb}get startTime(){return this.pk}get ybl(){return this.Aki}get Rza(){return this.vmi}get Fkj(){return this.bei}get podsCleaningRequestPattern(){return this.lli}}
Object(k.a)(Eb,"SeamlessFailoverState",null,[106]);const qc=Oa=>{Oa=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ea("361"),Oa);e.AFrameworkApplication.Me.jU(Oa,1,null,null,null,0,()=>{ee.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{ee.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var Sc;(function(Oa){Oa[Oa.unknown=0]="unknown";Oa[Oa.mouse=
1]="mouse";Oa[Oa.keyboard=2]="keyboard";Oa[Oa.podsPopsUnavailable=4]="podsPopsUnavailable"})(Sc||(Sc={}));Object(k.b)("RehydrationTrigger",Sc);var td=d(675),je=d(1012);class Te{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf,dg,Pg,pi,li,Ri,Ih,ij,Fi,Da,Wa,lb,Lb,oc){this.Se=this.hDe=null;this.qQe=this.Fld=-1;this.Pah=0;this.zib=Oa;this.ka=sb;this.Yb=Pb;this.ia=kc;this.zb=Wc;this.vF=Xd;this.Pe=Gd;this.Sg=Lf;this.oA=Nf;this.fe=dg;this.Kn=Pg;this.Ng=pi;this.rc=li;this.vS=Ri;this.Ms=Fi;this.aOe=new Date;this.Iw=
Ih;this.HC=ij;this.sa=Da;this.Lb=Wa;this.qmc=lb;oc.execute(Jc=>{this.hDe=Jc});this.hdd=[];this.wRk=this.Lb.tc("SeamlessFailoverMaxRetryAttempts",0);this.vRk=this.Lb.getBooleanAppSetting("SeamlessFailoverIncludePopsInfoInFinalLog");this.xRk=this.Lb.getBooleanAppSetting("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");ee.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get S0(){return!!this.Se&&this.Se.qlj}get mbg(){return this.Pah}oYd(Oa){if(this.S0){e.AFrameworkApplication.WA&&
(this.Ng.Rvc(Object(C.a)(this,this.Qha,"onWopiTokenRefreshed")),this.v5b());var sb=0;if(this.ka.cEb)this.Se.$c.jD("Result","abortedOnIrmProtectedFile"),sb=365;else if(this.Se.$c.jD("Result",Oa),"abortedOnExitApp"!==Oa||this.xRk)sb=4===this.Se.Rza?356:357;this.onb(!1,sb,!this.Se.v9b&&"abortedOnRefreshDoc"!==Oa)}}Aff(Oa,sb,Pb){if(this.S0)ee.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.Zx||(e.AFrameworkApplication.Zx=ee.a.N6b());this.fe.disabled=
!1;this.fe.Rma=!1;this.Se=new Eb(Oa,sb,this.Pe.podSessionId,this.ka.podsCleanPendingTasksAndRequestsWhenFailover,this.ka.podsCleaningRequestPattern,Pb);this.ka.wopiTokenRefreshLongerTimeoutIsEnable||this.Se.VNh(Object(C.a)(this,this.Jmh,"onFailoverTimeout"),this.ka.podsSeamlessFailoverTimeoutDurationInMs);this.Se.$c.Wa("PopsAvailable",this.Sg.jH.toString());this.Se.$c.Wa("OrderlyShutdown",Oa.toString());this.Se.$c.Wa("Trigger",Sc[sb]);this.Se.$c.Wa("TriggerErrorCode",Id.a[Pb]);this.Se.$c.Wa("OldPodsId",
this.Se.ybl);this.Se.$c.Wa("OldPopsId",this.Pe.xl);ee.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Se.$c.actionId,this.Se.$c.wTb());if(1===sb||2===sb)e.AFrameworkApplication.Dh=!1,this.sa.presentation&&this.sa.presentation.M4e();this.Ng.DOc(Object(C.a)(this,this.Qha,"onWopiTokenRefreshed"));e.AFrameworkApplication.WA&&gc.a.instance.C$a()?(ee.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",
(new Date).getTime(),new Date,e.AFrameworkApplication.Im,new Date(e.AFrameworkApplication.Im)),this.v5b(),this.Fld=window.setTimeout(Object(C.a)(this,this.xal,"onWopiTokenRefreshTimeout"),this.ka.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.ka.Euh&&this.qmc.ieg(!1)):(this.Ng.Rvc(Object(C.a)(this,this.Qha,"onWopiTokenRefreshed")),this.xZh(sb))}}wlj(Oa){if(Array.contains(this.ka.podTriggerFailoverOnServerErrorsCandidates,me.a.hi(Oa).toString())){if(!this.hdd.length)return!0;const sb=new Date;
let Pb=0;for(let kc=this.hdd.length-1;0<=kc;kc--){const Wc=this.hdd[kc];if(+sb-+Wc.startTime>this.ka.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Wc.hcm===Oa&&Pb++}if(Pb<this.ka.podTriggerFailoverOnServerErrorsMaxTry)return!0;ee.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",Oa,Pb,this.ka.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}xZh(Oa){e.AFrameworkApplication.WA&&
(this.Ng.Rvc(Object(C.a)(this,this.Qha,"onWopiTokenRefreshed")),this.v5b());if(++this.Pah>this.wRk)this.Fme("SeamlessFailoverMaxRetryCountReached",392);else if(this.ka.wopiTokenRefreshLongerTimeoutIsEnable&&this.Se.VNh(Object(C.a)(this,this.Jmh,"onFailoverTimeout"),this.ka.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.aOe>=36E5*this.ka.powerPointPodRecoveryStorageAgeThreshold)this.Fme("RecoveryStreamExpired",358);else{if(this.Se.sde&&(this.Se.$c.jD("Trigger",Sc[Oa]+"_GetFileUrlExpired"),
this.Mek())){this.Fme("GetFileUrlExpired_NoAzureBackup",364);return}this.Se.Fkj&&this.pTi();this.Ng.pud(new td.a(4===Oa?5:2));this.Ng.Yql();this.ka.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===Oa&&(ee.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Pe.xl),this.vS.Ywb(()=>{},()=>{}));this.Kn.isPaused||this.Kn.pause();this.Se.$c.Xm("CreatePodsWithRetryST",new Date);this.Se.$c.Xm("SessionStartTime",this.aOe);this.oCh()}}Fme(Oa,sb){this.zb.Jva&&
this.zb.dNa();this.Se.$c.jD("Result",Oa);this.onb(!1,sb)}xal(){this.Ng.Rvc(Object(C.a)(this,this.Qha,"onWopiTokenRefreshed"));this.v5b();ee.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Se.$c.Wa("WopiTokenRefreshed","TO");e.AFrameworkApplication.Lp(me.a.hi(382));Vc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.Zx&&e.AFrameworkApplication.Zx.ffa();this.Se.v9b=!0;this.ia.Ia(ke.a.refresh,
2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}Qha(Oa,sb){Oa=sb.o9c;this.Ng.Rvc(Object(C.a)(this,this.Qha,"onWopiTokenRefreshed"));this.v5b();this.ka.Euh&&this.qmc.ieg(!0);sb=0<e.AFrameworkApplication.Im&&(new Date).getTime()>=e.AFrameworkApplication.Im-this.ka.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;ee.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",
Oa,(new Date).getTime(),new Date,e.AFrameworkApplication.Im,new Date(e.AFrameworkApplication.Im));this.Se.$c.Wa("WopiTokenRefreshed","True");this.Se.$c.Wa("WopiTokenRefreshedSuccessfully",Oa.toString());this.Se.sde=sb;Oa?this.xZh(this.Se.Rza):this.Se.v9b=!0}v5b(){-1!==this.qQe&&(window.clearTimeout(this.qQe),this.qQe=-1);-1!==this.Fld&&(window.clearTimeout(this.Fld),this.Fld=-1)}Mek(){const Oa=oa.a.Dg(this.Lb.Ea("152")||""),sb=!e.AFrameworkApplication.gh.IsRealEdit&&1!==this.Se.Rza&&2!==this.Se.Rza;
return".pptx"!==Oa&&".ppsx"!==Oa||sb}pTi(){try{let Oa=0,sb=0;const Pb={},kc={};this.Ms.Sri(Wc=>{if(-1<Wc.request.get_url().search(new RegExp(this.Se.podsCleaningRequestPattern,"i")))return this.aZh(Pb,this.Bng(Wc.request.get_url())),Oa++,!0;this.aZh(kc,this.Bng(Wc.request.get_url()));sb++;return!1});ee.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",Oa,Pb,sb,kc)}catch(Oa){ee.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",
Oa)}}Bng(Oa){let sb=Oa;const Pb=Oa.indexOf("?");0<Pb&&(sb=Oa.substr(0,Pb));Oa=sb.lastIndexOf("/");0<Oa&&(sb=sb.substr(Oa+1));return sb}aZh(Oa,sb){Oa[sb]=sb in Oa?Oa[sb]+1:1}Jmh(){this.S0&&(this.Se.$c.jD("Result","Timeout"),this.Se.$c.Wa("TimeoutDuration",(+new Date-+this.Se.startTime).toString()),this.onb(!1,4===this.Se.Rza?354:355))}onb(Oa,sb=0,Pb=!0){if(this.S0){this.oA.Fmb(Object(C.a)(this,this.Jha,"onPodSessionRefreshed"));this.Yb.qj.Fq.Lvc(Object(C.a)(this,this.Rkh,"onAfterReplication"));var kc=
+new Date-+this.aOe>=6E4*this.ka.pptEditorFileGetUrlExpireTimeInMinutes;e.AFrameworkApplication.WA&&(kc=0<e.AFrameworkApplication.Im&&(new Date).getTime()>=e.AFrameworkApplication.Im-this.ka.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&ee.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Im,new Date(e.AFrameworkApplication.Im));Oa&&kc&&this.Se.$c.Wa("SkipPopsReason",
"FileUrlExpired");this.rc.MKg();var Wc=this.Se.Rza;this.Se.$c.Wa("IsInEditingMode",this.rc.fp.toString());this.Se.$c.Wa("IsPreviousModeEditing",this.rc.Gfc.toString());this.Se.$c.Wa("IsLastKnownModeEditing",this.rc.hwe.toString());this.Se.$c.Wa("PopSessionEverInitialized",this.Sg.Vsc.toString());this.Se.$c.Wa("ResultErrorCode",Id.a[sb]);this.Se.$c.Wa("RefreshPage",Pb.toString());this.Se.$c.Wa("FRehydrationInitiatedPageRefresh",this.Se.v9b.toString());this.Se.tlj=Oa;this.Se.resultCode=sb;this.Se.b6l();
this.hdd.push(this.Se);this.vRk||this.GYc();Oa?(this.Ng.Lzh(new je.a(Wc)),this.JZh(kc,Wc)):(this.GYc(),0!==sb&&(Oa=me.a.hi(sb),e.AFrameworkApplication.Lp(Oa),Vc.Health.instance.recordQosError(me.a.Bea(Oa),["UnexpectedAppRefresh"],399===sb,!1,!0,Pb,null)),Pb?(e.AFrameworkApplication.Zx&&e.AFrameworkApplication.Zx.ffa(),this.ia.Ia(ke.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Ng.Lzh(new je.a(Wc)),this.JZh(kc,Wc)))}}w9b(){return this.Se&&this.Se.$c?!0:!1}GYc(){this.w9b()&&
(ee.a.J(512497874,801,15,"Action Telemetry: {0}",this.Se.$c.wTb()),this.Se.$c.finish(!0),this.Se.dispose(),this.Se=null)}JZh(Oa,sb){!this.rc.OM||Oa||2!==sb&&1!==sb&&4!==sb?(this.w9b()&&this.Se.$c.Wa("PopsRehydrationAttempted","false"),ee.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",Oa,sb),this.K1f(null)):(this.w9b()&&this.Se.$c.Wa("PopsRehydrationAttempted","true"),this.vS.hia(4===sb?6:7,Object(C.a)(this,this.J5i,"createPopSessionSucceededCallback"),
Object(C.a)(this,this.K1f,"createPopSessionFailedCallback")))}J5i(){this.w9b()&&(this.idg(),this.Se.$c.Wa("POPSessionCreated","true"),this.GYc())}K1f(){if(!this.w9b())return!1;this.idg();this.Se.$c.Wa("POPSessionCreated","false");this.GYc();return!1}idg(){this.Se.$c.jD("IsInEditingMode",this.rc.fp.toString());this.Se.$c.jD("IsPreviousModeEditing",this.rc.Gfc.toString());this.Se.$c.jD("PopSessionEverInitialized",this.Sg.Vsc.toString())}jcm(Oa){ee.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.Lb.getBooleanAppSetting("UserHasValidLicenseForEnterpriseFonts"),this.Lb.getBooleanAppSetting("PPTOEnterpriseFontsEnabled"));this.Lb.getBooleanAppSetting("UserHasValidLicenseForEnterpriseFonts")&&this.Lb.getBooleanAppSetting("PPTOEnterpriseFontsEnabled")&&qc(Oa)}oCh(){this.Se.HZ=ta.a();this.zb.Jva||this.zb.stop();let Oa=this.ka.restoreRCInCreatePodSessionRequest&&this.sa.Mk?this.sa.Mk.toString():"";Oa=oa.a.replaceAll(Oa,"#","%23");this.zib.createPodSession(this.Se.HZ,"SeamlessFailover_"+this.Se.Rza,
this.Se.WTa,+new Date-+this.Se.startTime,Object(C.a)(this,this.I5i,"createPodSessionSucceededCallback"),Object(C.a)(this,this.H5i,"createPodSessionFailedCallback"),this.vF,this.Pe.podSessionId,Oa);this.zib.zjm(this.Se.HZ,Object(C.a)(this,this.jcm,"triggerFontsInstallationCallback"));this.zb.dNa()}I5i(Oa){if(this.S0){Cd.a.$Cd=[];this.Se.$c.Wa("NewPodsId",this.Se.HZ);this.Pe.podSessionId=this.Se.HZ;this.Se.$c.Wa("CreatePodsWithRetryResult","true");this.Se.$c.Wa("CreatePodsRetryCount",this.Se.WTa.toString());
this.Se.$c.Wa("CreatePodsDuration",(+new Date-+this.Se.startTime).toString());this.Kn.isPaused&&this.Kn.Zpb();try{this.Kn.ZUf()}catch(sb){ee.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",sb)}if(this.ka.restoreRCInCreatePodSessionRequest&&Oa&&wa.a.vsc in Oa&&!oa.a.Ta(Oa[wa.a.vsc])){const sb=Boolean.parse(Oa[wa.a.vsc]);this.Se.$c.Wa("RCRestoredWhenCreatePodSession",Oa[wa.a.vsc]);sb?(this.Se.$c.jD("Result","Success"),this.onb(!0)):(this.hDe&&this.hDe.FTi(),this.Se.$c.Wa("DocRefreshTriggered",
"true"),Oa={failedMachineId:null,isPlanedShutdown:!1,fromSeamlessFailoverManager:!0},Oa.podSessionId=this.Pe.podSessionId,this.Se.v9b=!0,this.ia.Ia(ke.a.dPb,2,Oa))}else this.AZh()}}AZh(){this.Yb.qj.Fq.kOc(Object(C.a)(this,this.Rkh,"onAfterReplication"));this.ncm()}ncm(){const Oa=()=>{this.Se.f4e=new Date;this.Se.$c.Xm("InboundStartTime",this.Se.f4e);this.Yb.qj.Fq.HG(null,null,null)};ee.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",
!0,this.sa.Aa?this.sa.Aa.sid:0,this.Se.HZ);4===this.Se.Rza&&this.ka.podsSeamlessFailoverForceInboundSlideEnabled&&this.sa.Aa?(this.HC.odc&&this.HC.odc.fzg(this.sa.Aa.Fb),this.Se.$c.Xm("ForceInboundSlideStartTime",new Date),this.Iw.Qee(this.sa.Aa,(sb,Pb)=>{ee.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",sb,Pb);this.S0&&(this.Se.$c.Xm("ForceInboundSlideEndTime",new Date),Oa())},!0,!1)):Oa()}H5i(Oa){if(!this.S0)return!0;const sb=
+new Date-+this.Se.startTime;if(399===Oa)return ee.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Pe.podSessionId,sb),this.fe.iI(Oa,null),this.onb(!1,Oa,!1),!0;if(this.Se.sde&&230===Oa)return ee.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Pe.podSessionId,sb),this.Z8f("CreatePodSessionFailed_GetFileUrlFailed",
Oa),!0;if(this.Se.WTa<this.ka.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&sb<this.ka.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Pb;(Pb=this.Se).WTa=Pb.WTa+1;ee.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Pe.podSessionId,this.Se.WTa,sb,Oa);this.oCh();return!0}ee.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Pe.podSessionId,this.Se.WTa,sb,Oa);this.Z8f("CreatePodSessionFailed",Oa);return!0}Z8f(Oa,sb){this.Se.$c.Wa("CreatePodsWithRetryResult","false");this.Se.$c.Wa("CreatePodsRetryCount",this.Se.WTa.toString());this.Se.$c.Xm("CreatePodsWithRetryET",new Date);this.Se.$c.jD("Result",Oa);this.Se.$c.Wa("CreatePodsDuration",(+new Date-+this.Se.startTime).toString());this.onb(!1,sb)}Rkh(Oa,sb){this.S0&&(sb.TDg?ee.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
sb.Ykb):(this.Se.$c.jD("InboundDuration",(+new Date-+this.Se.f4e).toString()),this.Se.$c.jD("Result","Success"),this.onb(!0)))}Jha(Oa,sb){this.S0&&(this.Se.$c.Wa("WaitPodsRefreshedDuration",(+new Date-+this.Se.pom).toString()),this.Se.$c.Wa("NewPodsId",sb.HZ),this.oA.Fmb(Object(C.a)(this,this.Jha,"onPodSessionRefreshed")),this.Kn.isPaused&&this.Kn.Zpb(),this.AZh())}}Object(k.a)(Te,"PodSeamlessFailoverManager",null,[1066]);class Hd{constructor(Oa,sb,Pb){this.Wwa=Oa;this.Xa=Pb}t0(){}J2b(){}s9a(Oa){Oa&&
(Array.add(Oa,wa.a.TWe),Array.add(Oa,wa.a.Mba),Array.add(Oa,wa.a.YMb),Array.add(Oa,wa.a.ddl),Array.add(Oa,wa.a.vsc))}yfa(Oa,sb){sb?((sb=Oa[wa.a.YMb])&&sb.toLowerCase()!==(this.Xa.Oba?this.Xa.Oba.toLowerCase():"")&&(ee.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",sb),this.Xa.Oba=sb),this.Wwa?(Oa=Oa[wa.a.TWe])?(this.Wwa.ccpInfo=Oa,ee.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",Oa.length)):ee.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
ee.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):ee.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(k.a)(Hd,"RehydrationHeaderHandler",null,[769]);class mg{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf){this.RP=null;this.ddd=!1;this.Bsg=dg=>{if(dg.keyCode===H.a.KFd||dg.keyCode===H.a.XOa||dg.keyCode===H.a.kqb||dg.keyCode>=H.a.Aqb&&dg.keyCode<=H.a.NBa)return!1;this.C2e(2);return!0};this.zf=Oa;this.Nc=
sb;this.rS=Pb;this.Rs=kc;this.hd=Wc;this.Ye=Xd;this.ibh=Lf;this.Ba=Gd;this.Hp=Pe;this.Xkd=Nf}init(){this.Nc&&(this.Nc.yOc(Object(C.a)(this,this.j7e,"sessionExpired")),this.Nc.D9a(Object(C.a)(this,this.L8k,"onRehydrateSession")))}j7e(){this.LRh(!0);r.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Vc.Health.instance.stopAllHealthTimers()}C2e(Oa){this.LRh(!1);const sb=e.AFrameworkApplication.WA||!Yf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");r.ULS.sendTraceTag(544789148,821,100,
"Should refresh token: {0}",sb);sb&&this.Xkd&&this.Xkd.n4d(0);this.Ba.podsSeamlessFailoverEnabled&&this.Hp.Aff(!1,Oa,223)}L8k(){r.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");Vc.Health.instance.resumeAllHealthTimers()}LRh(Oa){this.ddd!==Oa&&this.zf&&(Oa?(this.RP||(this.RP=this.Ye.we(),this.RP.id="sessiontimeoutoverlay",this.RP.className="SessionTimeoutOverlay",this.RP.tabIndex=-1,this.FGi(this.RP),this.zf.appendChild(this.RP)),this.ddd=!0,this.ibh(this.RP)):(this.W4f(this.RP),this.RP&&
this.RP.parentNode&&this.RP.parentNode.removeChild(this.RP),this.RP=null,this.ddd=!1))}FGi(Oa){Oa&&(this.hd.xb(B.a.click,Oa,Object(C.a)(this,this.ldb,"handleClickEvent")),this.hd.xb(B.a.doubleClick,Oa,Object(C.a)(this,this.ldb,"handleClickEvent")),Yf.a("FixRehydrationOnKeyPress")?this.Rs.addHandler(Oa,B.a.Vf,this.Bsg):this.rS.xb(B.a.Vf,Oa,Object(C.a)(this,this.Fsg,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(C.a)(this,this.onVisibilityChange,"onVisibilityChange")))}W4f(Oa){Oa&&
(this.hd.Hb(B.a.click,Oa,Object(C.a)(this,this.ldb,"handleClickEvent")),this.hd.Hb(B.a.doubleClick,Oa,Object(C.a)(this,this.ldb,"handleClickEvent")),Yf.a("FixRehydrationOnKeyPress")?this.Rs.removeHandler(Oa,B.a.Vf,this.Bsg):this.rS.Hb(B.a.Vf,Oa,Object(C.a)(this,this.Fsg,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(C.a)(this,this.onVisibilityChange,"onVisibilityChange")))}ldb(){this.C2e(1);return!0}Fsg(Oa){if(Oa.hc.ctrlKey||Oa.hc.altKey||Oa.hc.shiftKey||Oa.hc.keyCode>=H.a.Aqb&&
Oa.hc.keyCode<=H.a.NBa)return!1;this.C2e(2);return!0}onVisibilityChange(){e.AFrameworkApplication.WA&&!window.document.hidden&&this.Xkd&&this.Xkd.n4d(1)}dispose(){this.Nc.z3e(Object(C.a)(this,this.j7e,"sessionExpired"));this.RP&&(this.W4f(this.RP),this.RP.parentNode&&this.RP.parentNode.removeChild(this.RP));this.Rs=this.rS=this.hd=null;this.ddd=!1;this.ibh=null}}Object(k.a)(mg,"SessionRehydrationController",null,[]);class fg{constructor(){this.Da=null}fc(Oa){this.Da=Oa||y.a.instance}dispose(){}}Object(k.a)(fg,
"TellMePackage",null,[2,3]);var $e=d(116),oj=d(145),Me=d(28),we=d(16),Zc=d(108),te=d(961);class ne{constructor(Oa=null,sb=null,Pb=null,kc,Wc=null){this.BHd=null;this.Dnf=!1;this.Qsf=this.Vqb=null;this.soi=this.EFf=this.S$h=this.Rsf=!1;this.CEc=null;this.cai=null==sb?e.AFrameworkApplication.kwb:sb;this.dgi=null==Pb?e.AFrameworkApplication.oHa:Pb;this.Noi=null==Wc?e.AFrameworkApplication.LAa:Wc;this.qfi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeHelpOnHelpIsEnabled");
this.Wpi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeCommandHookIsEnabled");this.AVl(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeIgnoreQueryForHelp"));this.Npi=!!e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.mgc;this.Opi=!Zc.a.vy()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMePeopleSuggestionIsEnabled");this.Mpi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeFileSuggestionIsEnabled");
this.fei=!!e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.RRb;this.Ppi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.doi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("HelpShowsTopSearchResult");this.tki=this.syc||this.ryc;this.rki=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("OnlineCommandSuggestionsIsEnabled");this.ski=this.uwe;this.zhi=!!e.AFrameworkApplication.fa&&
this.iBa&&e.AFrameworkApplication.fa.getBooleanAppSetting("StyledHeaderInLabelIsEnabled");this.Oei=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Wei=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.Lei=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.whi=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.hhi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.Phi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.lgi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.Stk||this.Omk);this.iub=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.fpi=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.Zei=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.eoi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.Boi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.ooi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("ShowFindInDocumentInZeroTermSearchBox")||this.gJ;this.Hhi=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.ehi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.uhi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.Ehi=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.Vhi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeZeroTermContextualCommandSuggestionsEnabled");
this.U$h=this.iBa&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.mfi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Goi=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==e.AFrameworkApplication.fa.Ea("Application"));
this.Cai=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.cri=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMePerformanceMarkerEnabled");this.ngi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.rgi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.Vei=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.Ghi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeNotesSuggestionIsEnabled")||this.oGg;this.pgi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.qgi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.ogi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.Edi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.Fdi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.Ddi=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.$Sc&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.Qpi=this.Urk&&(this.gWe||this.hWe||this.Trc||this.iBa&&Zc.a.V$()&&!!e.AFrameworkApplication.fa&&(this.YRb||this.rob||this.sob||this.tob||this.ZRb||e.AFrameworkApplication.fa.getBooleanAppSetting("ShowAnswerSearchResults")||e.AFrameworkApplication.fa.getBooleanAppSetting("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.getBooleanAppSetting("ShowEntitySearchResults")||
e.AFrameworkApplication.fa.getBooleanAppSetting("ShowWolframSearchResults")));this.v$h=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.Wka;this.w$h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("AppsForOfficePrivateCatalogIsEnabled");this.W9j(Oa||{});this.NUd="2918242107";this.MUd="1454393937";
this.Y7a={};this.dSa=[];this.R_i=[Zc.a.hEd]}get application(){return this.Vqb}get kwb(){return this.cai}get fLl(){return this.NUd}get eLl(){return this.MUd}get fcg(){return this.Qsf}get Dnj(){return this.Rsf}get oHa(){return this.dgi}get LAa(){return this.Noi}get O9a(){return this.S$h}get s2j(){return this.qfi}get G9l(){return this.Wpi}get Urk(){return!0}get u9l(){return this.Qpi}get RXl(){return this.EFf}AVl(Oa){this.EFf=Oa}get iBa(){return this.Npi}get lAc(){return this.Opi}get jAc(){return this.Mpi}get umj(){return this.fei}get s9l(){return this.Ppi}get Iff(){return!1}get Trc(){return this.tki}get gWe(){return this.rki}get hWe(){return this.ski}get nYa(){return!1}get i9c(){return!1}get Zxe(){return this.zhi}get x$e(){return this.soi}get YRb(){return!1}get iZl(){return!1}get hwk(){return""}get Wie(){return 2}get pJj(){return 4}get qJj(){return 5}get PLj(){return""}get fBj(){return this.Oei}get Mog(){return this.Wei}get RLj(){return 1E3}get QLj(){return 1E-6}get T6l(){return this.fpi}get Acf(){return!1}get S6l(){return!1}get rpk(){return this.uhi}get R8c(){return!1}get Exe(){return!1}get Glk(){return!1}get Flk(){return!1}get oGg(){return!1}get rGg(){return!1}get gcg(){return!1}get SRb(){return!1}get rob(){return!1}get sob(){return!1}get tob(){return!1}get ZRb(){return!1}get syc(){return this.doi}get TRb(){return this.eoi}get ryc(){return!1}get Jge(){return null}get zxe(){return!1}get kAd(){return this.ooi}get Zlg(){return 0}get lwj(){return this.Lei}get qpg(){return this.Zei}get Wqk(){return this.whi}get Ste(){return this.lgi}get jAd(){return this.iub}get Hlg(){return-3.9}get gJ(){return this.Boi}get ngc(){return this.Hhi}get Awe(){return this.ehi}get nye(){return this.Ehi}get OSa(){return this.U$h}get Ztk(){return this.Vhi}get wfa(){return this.mfi}get KSh(){return this.Goi}get hJi(){return this.Cai}get FFd(){return this.cri}get f6c(){return this.ngi}get Idk(){return this.rgi}get pr(){return this.Vei}get oYa(){return this.Ghi}get Gdk(){return this.pgi}get Hdk(){return this.qgi}get Fdk(){return this.ogi}get zMf(){return this.v$h}get AMf(){return this.w$h}get c5(){return this.Edi}get BWc(){return this.Fdi}get xzb(){return this.Ddi}get Stk(){return this.Phi}get Omk(){return this.hhi}get es(){return!!e.AFrameworkApplication.za&&
e.AFrameworkApplication.za.mb.Xp}get Xp(){return!!e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.Xp}get Llk(){return!!e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.DAa}get b0k(){return Ba.getImageClass("OfficeAssistant_32x32x32")}rBj(){return Promise.reject("GetFindMatchCount method is not overridden")}x9c(Oa){return Array.contains(appChrome.selectors.getVisibleControlIds(),Oa)}Iue(){return!1}get rwe(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeModelRankerEnabled")}get BXh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ea("TellMeServiceHelpClassifierModelName"):""}get uwe(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeMultiLingualCommandModelEnabled")}get O3c(){return"NoOpHeaderUi"}get Q_i(){return this.CEc}get parameterData(){return this.Y7a}get rem(){return this.dSa}qij(){if(this.BHd&&!this.Dnf&&(this.Dnf=!0,this.zzd(this.BHd),this.Xp)){var Oa=y.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Oa=(new te.a(Oa)).Dfe(this.BHd.Fca);
appChrome.api.dispatch(Oa)}}zzd(){}ibj(Oa){const sb=[];for(let Pb=0;Pb<Oa.length;++Pb)Oa[Pb].SZl?sb.push(new we.a(Oa[Pb].alternate,Zc.a.R_h+Pb.toString())):sb.push(new we.a(Oa[Pb].standard,Zc.a.hEd+Pb.toString()));return sb}W9j(Oa){const sb={};for(const Pb in Oa){const kc=Pb,Wc=Oa[Pb];for(const Xd in Wc){const Gd=Xd,Pe=Wc[Xd];(sb[Gd]||(sb[Gd]={}))[kc]=Pe}}this.CEc=sb}get CXh(){return""}get YRh(){return!1}}Object(k.a)(ne,"TellMeApplicationData",null,[1125]);class Zf{constructor(Oa,sb=null,Pb=!1){this.standard=
Oa;this.alternate=sb;this.SZl=Pb}}Object(k.a)(Zf,"TryQuerySet",null,[]);class cd{constructor(){this.dAf=this.eAf=null}get EYk(){return this.dAf}lM(Oa){this.eAf=Oa;return this.F4i(Oa)}Q0k(){this.dAf=this.eAf}SDj(Oa){return 8===Oa.type?String.format(CommonUIStrings.l_FindInDocumentText,Oa.aL):Oa.aL}$wj(Oa){return Oa.aL}}Object(k.a)(cd,"ParameterizedCommand",null,[]);class aj extends cd{constructor(Oa){super();this.Aqk=Oa}get commandId(){return this.Aqk?"FindParameterized":"EditingFind"}get rdl(){return"Find"}F4i(Oa){if(!Oa)return null;
const sb=oa.a.Fe(String.format(ResourceStrings.l_ParamFindInDocTitle,Oa.aL));return da.a(Zc.a.i8i(Oa.value),"1540292897",sb,"Find_16x16x32",null,oa.a.Fe(Oa.aL),sb,null,null)}}Object(k.a)(aj,"FindParameterizedCommand",cd,[]);var Qc=d(126);class Mc extends ne{constructor(){super(window.TellMeControlMetadataOverrides);this.Vqb="PowerPoint";if(e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeTryQueriesIsEnabled")){var Oa=[new Zf(ResourceStrings.l_TellMeTryQuery01,"",!1),new Zf(ResourceStrings.l_TellMeTryQuery02,
"",!1),new Zf(ResourceStrings.l_TellMeTryQuery03,"",!1),new Zf(ResourceStrings.l_TellMeTryQuery04,"",!1),new Zf(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.dSa=this.ibj(Oa)}e.AFrameworkApplication.fa.getBooleanAppSetting("TellMeFindInDocumentIsEnabled")&&(Oa=new aj(Mc.zqk()),this.parameterData[Oa.commandId]=Oa,this.Rsf=!0,this.Qsf=Oa.commandId)}get gNa(){return Qc.a.USf}zzd(Oa){if(Oa){Oa=Oa.Fca;var sb=e.AFrameworkApplication.fa;Oa["PptTellMe.Animation"]=!sb.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled")||
sb.getBooleanAppSetting("241");Oa["PptTellMe.Transition"]=!sb.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled");Oa["PptTellMe.SelectAll"]=!sb.getBooleanAppSetting("TellMeSelectAllResultIsEnabled");Oa["PptTellMe.AnimationNew"]=!sb.getBooleanAppSetting("241")||!sb.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled");Oa["PptTellMe.Designer"]=!sb.getBooleanAppSetting("248");sb=sb.getBooleanAppSetting("TellMeDesktopUpSellIsEnabled");var Pb=e.AFrameworkApplication.Vrk;Oa["PptTellMe.WordArtUpSellButton"]=
!sb||Pb;Oa["PptTellMe.SpellCheckDictUpSellButton"]=!sb||Pb;Oa["PptTellMe.InsertAudioUpSellButton"]=!sb||Pb;Oa["PptTellMe.InsertChartUpSellButton"]=!sb||Pb;Oa["PptTellMe.WordArtUpSellButtonEnterprise"]=!sb||!Pb;Oa["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=!sb||!Pb;Oa["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!sb||!Pb;Oa["PptTellMe.InsertChartUpSellButtonEnterprise"]=!sb||!Pb}}get oGg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",
!1)}get rGg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get Zlg(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",2)}get CXh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get Acf(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",
!1)}get BXh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get YRb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",!1)}get uwe(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get Wie(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",
0)}get YRh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get i9c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get jrk(){return e.AFrameworkApplication.$Sc&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSummarizeDeckInTellMe",!1)}get Jge(){const Oa={};e.AFrameworkApplication.fa.getBooleanAppSetting("PPTOModernFontPickerIsEnabled")?
Oa.FontName="FontPicker":Oa.FontPicker="FontName";e.AFrameworkApplication.fa.getBooleanAppSetting("ReactNewSlideLayoutEnabled")?(Oa.NewSlide="NewSlideSplit",Oa.ChangeLayout="ChangeLayoutFlyout"):(Oa.NewSlideSplit="NewSlide",Oa.ChangeLayoutFlyout="ChangeLayout");return Oa}get Hlg(){var Oa=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");Oa=parseFloat(Oa);return isNaN(Oa)?-3.9:Oa}get R8c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",
!1)}get zMf(){return e.AFrameworkApplication.fa.getBooleanAppSetting("51")}get AMf(){return e.AFrameworkApplication.fa.getBooleanAppSetting("305")}static zqk(){return!!e.AFrameworkApplication.za&&e.AFrameworkApplication.za.mb.es}}Object(k.a)(Mc,"PowerPointTellMeApplicationData",ne,[]);var Ig;(function(Oa){Oa[Oa.none=0]="none";Oa[Oa.cjf=1]="waitAll";Oa[Oa.lEm=2]="synchronizeFast";Oa[Oa.Q7l=3]="synchronizeSlow"})(Ig||(Ig={}));Object(k.b)("ProviderSynchronizationType",Ig);var wg;(function(Oa){Oa[Oa.immediate=
0]="immediate";Oa[Oa.cjf=1]="waitAll";Oa[Oa.jEm=2]="synchronizeAndWaitAll";Oa[Oa.kEm=3]="synchronizeAndWaitForRanker"})(wg||(wg={}));Object(k.b)("MenuUpdatePolicy",wg);var fe=d(173),Qe=d(305),ig=d(159),Ph=d(712),$g=d(174),Vg=d(1023);class Fg{constructor(Oa,sb,Pb){this.Oq=Oa;this.gb=sb;this.sa=Pb}hF(){return"SummarizeSlidesProvider"}CM(){return this.Oq.Wie?this.Oq.Wie===wg.cjf?Ig.cjf:Ig.Q7l:Ig.none}AC(Oa,sb,Pb,kc,Wc=null){var Xd,Gd,Pe,Lf;const Nf=new fe.a(Oa);if(this.SG(Oa))if(null!=Wc&&0>Wc.indexOf(Qe.a.Kjf))sb.oo(Nf);
else{this.dPe="SummarizeDeckFromTellMe";if(1<(null===(Gd=null===(Xd=this.gb)||void 0===Xd?void 0:Xd.Xe())||void 0===Gd?void 0:Gd.length))this.dPe="SummarizeSlidesFromTellMe";else if(null===(Lf=null===(Pe=this.sa)||void 0===Pe?void 0:Pe.presentation)||void 0===Lf||!Lf.slides||2>this.sa.presentation.slideCount){sb.oo(Nf);return}appChrome&&appChrome.selectors.isControlDisabled(this.dPe)?sb.oo(Nf):(Oa=new ig.a(this.dPe,Ph.a.LGd,"","",Vg.a.j8h),Pb=new $g.a(Qe.a.LGd),Pb.qt(Oa),Nf.jr(Pb),window.requestAnimationFrame(()=>
{sb.oo(Nf)}))}else sb.oo(Nf)}SG(Oa){return!Oa||!Oa.Mf||!Oa.Mf.trim().length}}Object(k.a)(Fg,"SummarizeSlidesProvider",null,[1132]);class bf extends fg{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.wXh){var Oa=Me.App.Ob.mb.Jke($a.a.hq);Oa.Q6c?bf.Puh():Oa.u9(Object(C.a)(this,this.QKl,"scriptResource_LoadFinished"));var sb=new Mc;$e.TellMeActor.instance.initialize(sb,null,null,null,null,null,Object(C.a)(Me.App.Ob,Me.App.Ob.leg,"forceUpdateRibbonControls"),
e.AFrameworkApplication.fa,this.Da.Ha("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.Ha("Common.IActionContextProvider"),this.Da.Ha("Common.ISystemInitiatedFeedback"));$e.TellMeActor.instance.xvl(Oa);Oa=e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanAppSetting("822");sb.jrk&&Oa&&$e.TellMeActor.instance.Vz(new Fg(sb,this.Da.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),oj.a.hq)}}QKl(){bf.Puh()}static Puh(){Me.App.Ob.Gf()}}
Object(k.a)(bf,"PowerPointTellMePackage",fg,[]);var Ag=d(213),ff=d(180);class Fe{constructor(Oa,sb,Pb,kc,Wc,Xd){if(!Oa)throw Error.argumentNull("transactionFactory");if(!sb)throw Error.argumentNull("actionManager");if(!Wc)throw Error.argumentNull("focusManager");if(!Xd)throw Error.argumentNull("pageView");if(!kc)throw Error.argumentNull("selectionManager");if(!Pb)throw Error.argumentNull("graphActionBlockingManager");this.Eb=Oa;this.Fa=Wc;this.ia=sb;this.yb=Xd;this.gb=kc;this.ic=Pb}qb(){this.ia.pa(ke.a.x$a,
Y.a.application,this.HUj.bind(this),4)}Sd(){}HUj(Oa,sb,Pb,kc,Wc){return this.x$a(sb,Pb,Wc,Oa)}x$a(Oa,sb,Pb,kc){var Wc;Oa=this.gb.Hd();if(!(0<(null===Oa||void 0===Oa?void 0:Oa.length))||Oa.some(Xd=>this.ic.Xc(Xd)))return 8;Oa=Oa.filter(Xd=>Xd.lF);if(0>=Oa.length)return 8;if(1===sb)return 32;ee.a.J(508560658,822,15,"CameoStyle change started. CameoStyleId: '{0}'",Pb);sb=null===(Wc=Cd.a.Kb)||void 0===Wc?void 0:Wc.actionName;for(const Xd of Oa)this.Xla(Xd);Wc=this.Eb.ud(15,void 0,()=>{this.gb.uj();this.Fa.Gd()});
try{Wc.mc(Oa[0]);Wc.Wc=kc;for(const Xd of Oa)Xd.B1a=Pb}finally{Wc&&Wc.dispose()}Cd.a.Kb&&sb&&(Cd.a.Kb.actionName=sb,Cd.a.Kb.Wa("CameoStyleId",Pb.toString()),Cd.a.Y2(Cd.a.Kb));return 32}Xla(Oa){null!==Oa&&void 0!==Oa&&Oa.Iv&&(Oa=this.ik(Oa))&&Oa.qW(!1)}ik(Oa){if(Oa)return Oa.sc(this.yb.Na)}}Object(k.a)(Fe,"CameoActor",null,[948]);class Pf{constructor(){this.yh=this.M6=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}fc(Oa){this.K=Oa;this.M6=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");
this.yh=this.M6.AGa(4,this.name);this.K.register(Hd,"PowerPointWebEditor.RehydrationHeaderHandler").ma().na(()=>new Hd(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(mg,"PowerPointWebEditor.SessionRehydrationController").ma().na(()=>new mg(this.K.resolve("Box4.IAppFrame").JG(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),sb=>{D.FocusManager.dr(sb)},e.AFrameworkApplication.WA?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(1066,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().na(()=>
new Te(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),
this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.Me,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ha("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.WA&&this.K.register(1067,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().na(()=>new de(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),
this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let Oa=this.yh.Mu("resolvechronos1");const sb=this.K.resolve("Common.AFrameworkApplication"),Pb=this.K.resolve("PowerPointWebEditor.IApplicationContext").td;var kc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Wc=this.K.resolve("Common.IActionManagerExtended"),Xd=this.K.resolve("PowerPointWebEditor.IFocusManager"),
Gd=this.K.resolve("Common.Transaction.ITransactionFactory"),Pe=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Lf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Nf=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),dg=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Pg=this.K.resolve("PowerPointWebEditor.PictureContext"),pi=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),li=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),
Ri=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.yh.Su(Oa);Oa=this.yh.Mu("regactorschronos1");kc=[new ad(Wc,Nf,Pe,Xd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Gd,Ri,Pg,Lf,e.AFrameworkApplication.YR,li,this.K.resolve("PowerPointWebEditor.IErrorHandler"),kc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Pb.Jjk,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),pi,dg,Pb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Common.IAppSettingsManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings").enableCameoInEditor?new Fe(Gd,Wc,Nf,Pe,Xd,kc):null].filter(ij=>null!==ij);for(var Ih of kc)Ih.qb(),Ih.Sd();this.H9j();this.yh.Su(Oa);Oa=this.yh.Mu("tellme");Ih=new bf;Ih.fc(this.K);Ih.load(sb);this.yh.Su(Oa);Pb.pptEditorTimeoutDialogRemovalIsEnabled&&Pb.Mg&&(Oa=this.yh.Mu("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),
this.yh.Su(Oa));Pb.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.WA&&(Oa=this.yh.Mu("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.yh.Su(Oa));this.kxk()}H9j(){const Oa=this.K.resolve("Common.IActionManagerExtended"),sb=this.K.resolve("PowerPointWebEditor.IFocusManager"),Pb=this.K.resolve("Common.AFrameworkApplication").Qp.ie,kc=this.K.resolve("Common.Transaction.ITransactionFactory"),
Wc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Xd=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Gd=this.K.resolve("PowerPoint.IPathManager"),Pe=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Lf=ff.a(this.K);Lf("powerpoint-editor-intl").then(()=>{ee.a.J(512497373,801,50,"Editor script is loaded successfully");Lf("powerpoint-ribbon-intl").then(()=>{ee.a.J(512497372,801,50,"Ribbon script is loaded successfully");const Nf=[];Nf.push(new Hc(Oa,
sb,Xd,kc,Pb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pe,Wc,Gd));for(const dg of Nf)dg.qb(),dg.Sd()}).catch(()=>{ee.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{ee.a.J(512497370,801,10,"Failed to load Editor script")})}kxk(){ee.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Wea("pptedit.chronos2",()=>{const Oa=this.K.resolve("PowerPointWebEditor.ISessionState");Oa&&Oa.fia("Chronos2DownloadFinished")},
()=>d.e(6).then(d.bind(null,1306)))}dispose(){const Oa=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Oa.pptEditorTimeoutDialogRemovalIsEnabled&&Oa.Mg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.WA&&Oa.Mg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Dh&&nc.a.jg?ee.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):n.a.instance.Ac(Ag.a(new Pf,
4))}}Object(k.a)(Pf,"Chronos1Package",null,[2,3]);var Md=d(661),vg=d(144),Ye=d(593),Cf=d(58),Bg=d(47);class Ae{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf,dg,Pg,pi){this.type="FormatPictureTaskPaneProps";this.transparency=this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.isPictureTransparencyInactive=this.isPicturePropertiesInactive=this.isCropInactive=!1;this.onChange=null;this.emptyValueFields=0;this.onSectionToggle=this.formatPictureSections=
null;const li=Object(Fb.a)(Object,Kb.e().numberFormatInfo);if(!li)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=li;this.width=Oa;this.height=sb;this.top=kc;this.left=Pb;this.brightness=Wc;this.contrast=Xd;this.saturation=Gd;this.transparency=Pe;this.isCropInactive=Lf;this.isPicturePropertiesInactive=Nf;this.isPictureTransparencyInactive=dg;this.emptyValueFields=Pg;this.formatPictureSections=pi}}Object(k.a)(Ae,"FormatPictureTaskPaneProps",null,[]);const Uf=ResourceStrings.l_PictureProperties,
Jd=ResourceStrings.L_PictureTransparency,We=ResourceStrings.L_CropPicture;class fd{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf,dg,Pg,pi){this.KJe=this.JJe=this.TIe=!0;this.xDe=this.sCe=this.meh=this.u_g=this.b2=this.C2=0;this.TNe=100;this.OPe=0;this.W_a=this.Mb=this.hRg=!1;this.nxa=new Map([[Uf,!1],[We,!1],[Jd,!1]]);this.onSectionToggle=(li,Ri)=>{this.nxa.forEach((Ih,ij)=>this.nxa.set(ij,ij===li?Ri:!1));this.X1h();this.Jl(!0)};pi("powerpoint-editor-intl").then(()=>{this.W_a=!0}).catch(li=>{ee.a.J(512350083,
801,10,"Failed to load powerpoint-editor-intl "+li.toString())});this.gb=Oa;this.Db=sb;this.ia=Pb;this.Fa=kc;this.Wf=Wc;this.sa=Xd;this.yb=Gd;this.Ji=Pe;this.laa=Lf;this.ic=Nf;this.Hc=dg;if(!Pg)throw Error.argumentNull("appSettings");this.ka=Pg;this.Wf.$Da(Object(C.a)(this,this.mod,"onChangeRenderFormatPicturePane"));this.Db.QH(Object(C.a)(this,this.St,"onAppFrameModeSwitched"));this.Hc.zSa(Object(C.a)(this,this.mod,"onChangeRenderFormatPicturePane"))}dispose(){this.Wf.w2a(Object(C.a)(this,this.mod,
"onChangeRenderFormatPicturePane"));this.Db.a_(Object(C.a)(this,this.St,"onAppFrameModeSwitched"));this.Hc.Emb(Object(C.a)(this,this.mod,"onChangeRenderFormatPicturePane"))}Sd(){}qb(){this.ia.pa(ke.a.GOb,yf.a.application,Object(C.a)(this,this.GOb,"queryShowHideReactPictureCropPane"),96);this.ia.pa(ke.a.Qyc,yf.a.application,Object(C.a)(this,this.Qyc,"showHideReactPictureCropPane"),4);this.ia.pa(ke.a.Z4a,yf.a.application,Object(C.a)(this,this.Z4a,"updatePictureCropPane"),4)}GOb(Oa,sb,Pb,kc,Wc){(Oa=
Object(Fb.a)(Rf.a,Wc))&&Oa.Rf(this.Mb);return 32}Qyc(Oa,sb,Pb,kc,Wc){if(!this.W_a)return 8;if(1===Pb)return 32;sb=this.sa.presentation;if(!this.sa.Aa||!sb||this.ic.Xc(sb))return 16;this.URl(Wc);return Xc.b("ShowHideReactPictureCropPane:",this.Mb.toString(),Oa,()=>{if(this.Mb=!this.Mb){if(this.Jl(),!this.ka.JSa&&Yf.a("CropControlEnableOnDisplayingFormatPicturePane")){const Xd=this.gb.Zn();(null===Xd||void 0===Xd?0:Xd.Iv)||this.ia.nb(ke.a.jUc,2)}}else this.ur();return 32})}URl(Oa){null!=Oa&&"FormatPicture"===
Oa.SourceControlId?(this.nxa.set(Uf,!0),this.nxa.set(We,!1)):(this.nxa.set(We,!0),this.nxa.set(Uf,!1))}Z4a(Oa,sb,Pb,kc,Wc){if(!this.Mb)return 8;if(2===Pb)if(this.ka.JSa)this.onSectionToggle(Wc.sectionName,Wc.sectionNewState);else this.Jl(!0);return 32}Jl(Oa=!1){var sb=this.O1c();sb=this.SA(sb);const Pb=Object.assign(new Md.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:sb,onOpen:()=>{},onClose:()=>{this.Mb=!1},isModernPane:!0});vg.UISurfaces.qr().then(kc=>
{Oa?kc.updateTaskPane(Bg.a.fMa,Pb):kc.showTaskPane(Bg.a.fMa,Pb);return null}).catch(kc=>{ee.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+kc.toString())})}ur(){vg.UISurfaces.qr().then(Oa=>{Oa.hideTaskPane(Bg.a.fMa,2);return null}).catch(Oa=>{ee.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+Oa.toString())})}SA(Oa){var sb=null;if(Oa){sb=Oa.Nge();const Pb=this.yb.Xd;this.b2=Ye.a.Ov(Pb.Cf(this.Ji.dJ(Cf.a.an(sb.ga(0),sb.ga(3)),Oa.zoom),1));this.C2=Ye.a.Ov(Pb.Cf(this.Ji.dJ(Cf.a.an(sb.ga(0),
sb.ga(1)),Oa.zoom),0));this.u_g=Ye.a.Ov(Pb.Cf(this.Ji.dJ(sb.ga(0).x,Oa.zoom),0));this.meh=Ye.a.Ov(Pb.Cf(this.Ji.dJ(sb.ga(0).y,Oa.zoom),1));this.TIe=!1;this.hRg=!0}else this.TIe=!0;this.Vnl();Oa=this.hRg?0:15;this.ka.JSa&&(this.KJe=this.JJe=!1,this.o8c()||(this.nxa.forEach((Pb,kc)=>this.nxa.set(kc,!1)),Oa=15,this.KJe=this.JJe=!0));sb=new Ae(this.C2,this.b2,this.u_g,this.meh,this.sCe,this.xDe,this.TNe,this.OPe,this.TIe,this.JJe,this.KJe,Oa,this.nxa);sb.onChange=Object(C.a)(this,this.dza,"onPropertyChange");
sb.onSectionToggle=this.onSectionToggle;return sb}O1c(){const Oa=this.gb.Zn();return Oa&&Oa.Iv&&Oa.isConnected?this.laa.dK(Oa):null}o8c(){const Oa=this.gb.Hd(),sb=this.gb.b0c(Oa);return 1==Oa.length&&(null===sb||void 0===sb?void 0:sb.$j)}Vnl(){if(this.ka.JSa){const Oa=this.gb.Zn();null!=Oa&&(this.sCe=Oa.Nba.brightness,this.xDe=Oa.Nba.contrast,this.TNe=Oa.Nba.saturation,this.OPe=Oa.Nba.transparency)}}dza(Oa,sb,Pb){const kc={};kc.Number=Oa;kc.IsChanged=Pb;switch(sb){case 0:this.ia.Ia(ke.a.jFd,2,kc);
break;case 1:this.ia.Ia(ke.a.gFd,2,kc);break;case 2:this.ia.Ia(ke.a.hFd,2,kc);break;case 3:this.ia.Ia(ke.a.iFd,2,kc);break;case 4:this.ia.Ia(ke.a.fhf,2,kc);this.sCe=Oa;break;case 5:this.ia.Ia(ke.a.ihf,2,kc);this.xDe=Oa;break;case 6:this.ia.Ia(ke.a.Vhf,2,kc);this.TNe=Oa;break;case 7:this.ia.Ia(ke.a.gif,2,kc),this.OPe=Oa}this.Jl(!0)}ik(Oa){return Oa?Oa.sc(this.yb.Na):null}X1h(){var Oa=this.gb.Zn();this.nxa.get(We)?Yf.a("CropControlEnableOnDisplayingFormatPicturePane")&&Oa&&((null===Oa||void 0===Oa?
0:Oa.Iv)||this.ia.nb(ke.a.jUc,2)):(Oa=this.ik(Oa))&&Oa.qW(!1)}mod(){this.Mb&&(this.ka.JSa&&this.X1h(),this.Jl(!0))}St(Oa){1===Oa.mode&&this.Mb&&(this.Mb=!1,this.ur(),this.Fa.qk(Bg.a.fMa,this.Mb))}}Object(k.a)(fd,"FormatPicturePaneActor",null,[]);var ui=d(878);const bj=ResourceStrings.L_CropPicture;class nf{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf,dg,Pg,pi,li,Ri,Ih,ij,Fi,Da){this.OHb=!1;if(!Ri)throw Error.argumentNull("shapeReader");if(Ih&&!ij)throw Error.argumentNull("shapeSVGDependencyLoader");
if(!Fi)throw Error.argumentNull("businessBarController");this.ia=Oa;this.oa=sb;this.Eb=Pb;this.Qi=kc;this.ic=Wc;this.IJe=Xd;this.MVg=Gd;this.Fp=Pe;this.yb=Lf;this.sa=Nf;this.Ji=dg;this.laa=Pg;this.iN=pi;this.e2=li;this.Ga=Ri;this.Koa=Ih;this.b0a=ij;this.Ql=Fi;this.DK=Da}qb(){this.ia.pa(ke.a.jUc,Y.a.application,Object(C.a)(this,this.lcc,"handlePictureCropEvent"),4);this.MVg?(this.ia.pa(ke.a.L8d,Y.a.application,Object(C.a)(this,this.dsg,"handleCropSplitButton"),4),this.ia.pa(ke.a.M8d,Y.a.application,
Object(C.a)(this,this.dsg,"handleCropSplitButton"),4)):(this.ia.pa(ke.a.L8d,Y.a.application,Object(C.a)(this,this.lcc,"handlePictureCropEvent"),4),this.ia.pa(ke.a.M8d,Y.a.application,Object(C.a)(this,this.lcc,"handlePictureCropEvent"),4));this.ia.pa(ke.a.b0e,Y.a.application,Object(C.a)(this,this.Knl,"queryIsActive"),101);this.ia.pa(ke.a.hxc,Y.a.application,Object(C.a)(this,this.e_j,"handleSendCropInfo"),4);this.ia.pa(ke.a.LXe,Y.a.application,Object(C.a)(this,this.Yme,"handlePictureCropToShapeEvent"),
4);this.ia.pa(ke.a.wuh,Y.a.application,Object(C.a)(this,this.Yme,"handlePictureCropToShapeEvent"),4);this.ia.pa(ke.a.lOb,Y.a.application,Object(C.a)(this,this.otd,"queryPictureCropBounding"),100);this.ia.pa(ke.a.nOb,Y.a.application,Object(C.a)(this,this.otd,"queryPictureCropBounding"),100);this.ia.pa(ke.a.mOb,Y.a.application,Object(C.a)(this,this.otd,"queryPictureCropBounding"),100);this.ia.pa(ke.a.ruc,Y.a.application,Object(C.a)(this,this.otd,"queryPictureCropBounding"),100);this.ia.pa(ke.a.gFd,
Y.a.application,Object(C.a)(this,this.fFd,"updatePictureCropBounding"),4);this.ia.pa(ke.a.jFd,Y.a.application,Object(C.a)(this,this.fFd,"updatePictureCropBounding"),4);this.ia.pa(ke.a.hFd,Y.a.application,Object(C.a)(this,this.fFd,"updatePictureCropBounding"),4);this.ia.pa(ke.a.iFd,Y.a.application,Object(C.a)(this,this.fFd,"updatePictureCropBounding"),4)}dsg(Oa,sb,Pb,kc,Wc){return 1===Pb?32===this.Yme(Oa,sb,Pb,kc,Wc)||32===this.lcc(Oa,sb,Pb,kc,Wc)?32:8:this.lcc(Oa,sb,Pb,kc,Wc)}e_j(Oa,sb,Pb,kc,Wc){if(!Wc)return ee.a.J(512500482,
824,50,"Send Crop Info called with no cropping info"),8;sb=Wc.pictCropperInfo;Wc=Wc.shapeNode;if(!Wc||!Wc.pictureCropInfo)return ee.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Pb)return 32;if(Pb=Cd.a.Kb)Pb.actionName="EndCropPicture",Pb.tk=!1,Pb.gq=!0;Pb=this.Eb.ud(15);try{Pb.mc(Wc),Pb.Wc=Oa,Wc.Jsc=sb}finally{Pb&&Pb.dispose()}return 32}Yme(Oa,sb,Pb,kc,Wc){if(!this.MVg||this.ic.Xc(this.oa.Pk()))return 8;sb=this.oa.rf();if(!sb||!sb.length)return 8;const Xd=[];for(var Gd of sb)Gd&&
Xd.push(Gd);if(!Xd.length)return 8;for(const Nf of Xd)if(Nf.isLocal||this.iN.pY(Nf)||!this.Ank(Nf))return 8;if(1===Pb)return 32;ee.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Pe=Wc?Wc.SourceControlId:"";Gd=0;Pb=Pe.split("_");if(3===Pb.length)Gd=Number.parseInvariant(Pb[2]);else return ee.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",Pe),16;Pb=window.performance.now();Wc=new ui.a;
Wc.TargetShapeTypeAsInt=Gd;Gd=this.Eb.ud(15,void 0,()=>{for(const Nf of Xd)if(Nf.Iv){const dg=this.ik(Nf);dg&&dg.qW(!1)}ee.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Pe)});try{Gd.mc(Xd[0]);Gd.Wc=Oa;for(var Lf of Xd)Lf.Ksc=Wc}finally{Gd&&Gd.dispose()}Oa=window.performance.now();if(Lf=Cd.a.Kb)Lf.actionName="PictureCropToShape",Lf.Wa("PictureCropShapeType",Wc.TargetShapeTypeAsInt.toString()),Lf.Wa("PictureCropToShapeDuration",(Oa-Pb).toString()),
Cd.a.Y2(Lf);ee.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Wc.TargetShapeTypeAsInt);return 32}lcc(Oa,sb,Pb){if(!this.IJe||this.ic.Xc(this.oa.Pk()))return 16;if(this.Koa&&!this.b0a.YCg)return ee.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;sb=this.oa.Hd();const kc=this.oa.b0c(sb);if(1!==sb.length)return Yf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Pb&&this.l6f(),
8;if(!kc)return 8;if(this.Ga.rx(kc).length)return Yf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Pb&&this.l6f(),8;if(!this.Swe(kc))return 8;if(1===Pb)return 32;if(kc.isLocal||this.iN.pY(kc))return 16;if(kc.Iv){Oa=this.ik(kc);if(!Oa)return 8;Oa.qW(!1);kc.pictureCropInfo=null;Me.App.Ob.Gf();this.Z4a(null===kc||void 0===kc?void 0:kc.Iv);return 32}this.oa.uj();const Wc=this.sa.Aa;this.ic.blockContent(Wc,Oa);const Xd=Cd.a.Kb;Xd&&(Xd.actionName="BeginCropPicture",Xd.tk=!1,Xd.gq=!0);this.Qi.Fmg(kc.get_sid(),
kc.get_cid(),kc.get_shapeId(),Gd=>{Cd.a.gz(Xd,()=>{this.M5k(kc,Wc,Gd)})},()=>this.L5k(kc,Wc),!0);return 32}Knl(Oa,sb,Pb,kc,Wc){if(!Object(Qb.a)(Rf.a,Wc))return 8;Oa=this.oa.Zn();Wc.Rf(Oa?Oa.Iv:!1);return 32}O1c(){const Oa=this.oa.Zn();return Oa&&Oa.Iv&&Oa.isConnected?this.laa.dK(Oa):null}ik(Oa){return Oa?Object(Fb.a)(178,Oa.sc(this.yb.Na)):null}l6f(){this.Ql.oM(26)}otd(Oa,sb,Pb,kc,Wc){if(!this.IJe||!Wc)return 16;sb=this.O1c();if(!sb)return 16;Pb=sb.Nge();kc=this.yb.Xd;Oa=Oa===ke.a.lOb?kc.Cf(this.Ji.dJ(Cf.a.an(Pb.ga(0),
Pb.ga(3)),sb.zoom),1):Oa===ke.a.nOb?kc.Cf(this.Ji.dJ(Cf.a.an(Pb.ga(0),Pb.ga(1)),sb.zoom),0):Oa===ke.a.mOb?kc.Cf(this.Ji.dJ(Pb.ga(0).x,sb.zoom),0):kc.Cf(this.Ji.dJ(Pb.ga(0).y,sb.zoom),1);Wc=Wc.queryResult;null!==Wc&&(Wc.uca=parseFloat(Ye.a.Ov(Oa).toFixed(2)).toString());return 32}fFd(Oa,sb,Pb,kc,Wc){if(!this.IJe||this.Koa&&!this.b0a.YCg)return 16;sb=this.O1c();if(1===Pb)return sb?32:16;if(!sb||!Wc)return 16;if(2===Pb){Pb=!1;kc=sb.Nge().copy();Wc=Ye.a.gY(Wc.Number);const Xd=Cf.a.an(kc.ga(0),kc.ga(1)),
Gd=Cf.a.an(kc.ga(0),kc.ga(3)),Pe=this.yb.Xd;Oa===ke.a.gFd?(Wc=this.Ji.wQ(Pe.Ve(Wc,1),sb.zoom),Oa=Wc-Gd,kc.ga(2).BN(0,Oa),kc.ga(3).BN(0,Oa)):Oa===ke.a.jFd?(Wc=this.Ji.wQ(Pe.Ve(Wc,0),sb.zoom),Oa=Wc-Xd,kc.ga(1).BN(Oa,0),kc.ga(2).BN(Oa,0)):Oa===ke.a.hFd?(Pb=!0,Wc=this.Ji.wQ(Pe.Ve(Wc,0),sb.zoom),Oa=Wc-kc.ga(0).x,kc.move(Oa,0)):Oa===ke.a.iFd&&(Pb=!0,Wc=this.Ji.wQ(Pe.Ve(Wc,1),sb.zoom),Oa=Wc-kc.ga(0).y,kc.move(0,Oa));sb.Ehm(kc,Pb)}return 32}Ank(Oa){let sb=[];Oa.Lf?sb=this.Ga.rx(Oa):Oa.Rg&&(sb=this.Ga.rx(Oa.zt()));
if(sb.length){for(const Pb of sb)if(!this.Swe(Pb))return!1;return!0}return this.Swe(Oa)}Swe(Oa){const sb=this.Fp.Kcf&&!Oa.isGif&&(Oa.$j||1===Oa.mediaType)&&(!Oa.get_isSVGBlipFilled()||this.DK&&Oa.lF);return this.e2?sb&&!Oa.JLb:sb}L5k(Oa,sb){this.ic.vL(sb);if(!this.isActive||!Oa.isConnected)return!0;this.isActive=!1;Oa.pictureCropInfo=null;ee.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}M5k(Oa,sb,Pb){this.ic.vL(sb);if(Oa.isConnected)if(sb=Cd.a.Kb,Cd.a.gz(sb,
()=>{this.ia.nb(ke.a.U$a,2)}),this.iN.pY(Oa))ee.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var kc=Oa.vg(this.yb.Na);if(kc){var Wc=new Date;Oa.pictureCropInfo=JSON.parse(Pb.PictureCropInfoStr);this.laa.$J(Oa).c5l();Pb=new Date;sb&&(sb.Xm("ParseCropInfoStart",Wc),sb.Xm("ParseCropInfoEnd",Pb),Cd.a.Y2(sb));kc.NB();this.Z4a(null===Oa||void 0===Oa?void 0:Oa.Iv)}}}Z4a(Oa){this.ia.Ia(ke.a.Z4a,2,{["sectionName"]:bj,["sectionNewState"]:Oa})}get isActive(){return this.OHb}set isActive(Oa){this.OHb=
Oa}}Object(k.a)(nf,"PictureCropActor",null,[]);var ki=d(1273),qf=d(198),be=d(188),Ud=d(220),Ei=d(135),ei=d(170),Aj=d(387),tj=d(877),Pi=d(638),Eh=d(48),Th=d(70),Qi=d(745),fi=d(120),Ng=d(211),$d=d(162),Qf=d(913),Cg=d(382),rh=d(200),ge=d(189),bi=d(190),Og=d(286);class Ki{constructor(Oa,sb,Pb,kc,Wc,Xd,Gd,Pe,Lf,Nf,dg,Pg,pi,li){this.Mb=!0;this.rl=!1;this.Bo=[];this.p6=this.GC=this.OY=this.NI=this.KK=this.Bb=null;this.gE=Array(8);this.sxa=this.Eo=this.Kw=null;this.TV=this.Jd=1;this.vOe=new Cf.a(0,0);this.Do=
new qf.a;this.t2=new be.a;this.xKb=new Cf.a(0,0);this.n0a=0;this.Nv=new be.a;this.Gxa=new Cf.a(0,0);this.Coa=new Cf.a(0,0);this.Toc=this.qJa=!1;this.Elc=new Cf.a(0,0);this.rba=this.Raa=null;this.uQg=new gb.a;this.ov=null;if(!kc)throw Error.argumentNull("clickInputManager");if(!Oa)throw Error.argumentNull("shapeNode");if(dg&&!Pg)throw Error.argumentNull("transformFactory");if(dg&&!pi)throw Error.argumentNull("presReader");this.ta=Oa;this.Ga=sb;this.nc=Pb;this.hd=kc;this.ia=Wc;this.OI=Xd;this.ue=Gd;
this.saa=Pe;this.CRk=Lf;this.Txa=Nf;this.Koa=dg;this.jl=Pg;this.VIk=li}Cn(Oa){this.Bb=new ge.a;this.Bb.xk(1);this.Bb.ee(!1);this.Bb.sAa(Th.a.z6l);Oa.appendChild(this.Bb.viewport);this.KK=new Qi.a(!1,this.Koa);this.Bb.appendChild(this.KK);this.NI=new Qi.a(!1,this.Koa);this.Bb.appendChild(this.NI);this.NI.xk(1);this.OY=new $d.a;this.OY.Vv(re.a.m3);this.OY.vs(re.a.WF);this.OY.UF(fi.a.none);this.OY.xk(1);this.Bb.appendChild(this.OY);this.p6=new $d.a;this.p6.xk(1);this.p6.Dm(Th.a.SAa);this.p6.sAa("ShapeMoveHandle");
this.p6.UF(fi.a.none);this.Bb.appendChild(this.p6);this.GC=new Ng.a;this.V6b(this.GC);this.Bb.appendChild(this.GC);this.Bb.viewport.va.setAttribute("class",Th.a.Osc);this.Bb.ee(!1);this.hd.xb(B.a.click,this.p6.va,Object(C.a)(this,this.znd,"noOpHandler"));this.hd.xb(B.a.click,this.OY.va,Object(C.a)(this,this.znd,"noOpHandler"))}V6b(Oa){for(let kc=0;8>kc;++kc){var sb="cropHandle"+kc;const Wc=new Ng.a;Wc.va.id=sb;if(nc.a.dOa){var Pb=new Cg.a;Pb.va.id=sb;Pb.setVisibility(!1);Pb.setPosition(-10,-10);Pb.Mh(20,
20);Wc.appendChild(Pb)}Pb=new ei.a(kc);sb=Pb.MDb()?this.B2i(Pb,sb):this.M6i(Pb,sb);Wc.appendChild(sb);Wc.xk(1);this.gE[kc]=Wc;Oa.appendChild(Wc)}}Moe(Oa){for(let sb=0;8>sb;++sb)if(this.gE[sb].va.id===Oa.id)return new ei.a(sb);return null}cpk(Oa){return Oa.id.startsWith("cropHandle")}dispose(){this.saa();this.rl=!0;this.Mb=!1;this.Bb&&this.Bb.mr();this.Bb=null;this.p6&&this.hd.Hb(B.a.click,this.p6.va,Object(C.a)(this,this.znd,"noOpHandler"));this.p6=null;this.OY&&this.hd.Hb(B.a.click,this.OY.va,Object(C.a)(this,
this.znd,"noOpHandler"));this.GC=this.OY=null;this.gE&&Array.clear(this.gE);this.Raa=this.rba=this.gE=null;this.Elc=new Cf.a(0,0)}Yzd(Oa,sb,Pb,kc){const Wc=this.Fke(),Xd=Oa-Wc.x+this.Coa.x+Pb,Gd=sb-Wc.y+this.Coa.y+kc;return isNaN(Xd)||isNaN(Gd)?(ee.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",Oa,Wc.x,this.Coa.x,Pb,sb,Wc.y,this.Coa.y,
kc,this.Jd),new Cf.a(0,0)):new Cf.a(Xd,Gd)}setPosition(Oa,sb){this.qJa&&this.ta.pictureCropInfo&&(this.Gxa=Oa=new Cf.a(Oa/this.Jd,sb/this.Jd),this.Txa?(this.Raa&&this.KK&&(sb=this.Yzd(this.Raa.Position.X,this.Raa.Position.Y,Oa.x,Oa.y),this.KK.setPosition(sb.x,sb.y)),this.rba&&this.NI&&this.NI.image&&(Oa=this.Yzd(this.rba.Position.X,this.rba.Position.Y,Oa.x,Oa.y),this.NI.image.setPosition(Oa.x,Oa.y))):((sb=this.ta.pictureCropInfo.MaskViewElem)&&this.KK&&(sb=this.Yzd(sb.Position.X,sb.Position.Y,Oa.x,
Oa.y),this.KK.setPosition(sb.x,sb.y)),(sb=this.ta.pictureCropInfo.TextureViewElem)&&this.NI&&this.NI.image&&(Oa=this.Yzd(sb.Position.X,sb.Position.Y,Oa.x,Oa.y),this.NI.image.setPosition(Oa.x,Oa.y))),this.Bb.Gm())}K3l(Oa,sb){const Pb=new Cf.a(this.Ga.sC(this.ta,this.OI).x/this.Jd,this.Ga.sC(this.ta,this.OI).y/this.Jd),kc=new Cf.a(this.Coa.x+this.Gxa.x,this.Coa.y+this.Gxa.y);if(this.Txa)this.Raa&&this.KK&&this.KK.setPosition(this.Raa.Position.X-Pb.x+kc.x+Oa/this.Jd,this.Raa.Position.Y-Pb.y+kc.y+sb/
this.Jd),this.rba&&this.NI&&this.NI.image.setPosition(this.rba.Position.X-Pb.x+kc.x+Oa/this.Jd,this.rba.Position.Y-Pb.y+kc.y+sb/this.Jd);else{var Wc=this.ta.pictureCropInfo.MaskViewElem;Wc&&this.KK.setPosition(Wc.Position.X-Pb.x+kc.x+Oa/this.Jd,Wc.Position.Y-Pb.y+kc.y+sb/this.Jd);(Wc=this.ta.pictureCropInfo.TextureViewElem)&&this.NI.image.setPosition(Wc.Position.X-Pb.x+kc.x+Oa/this.Jd,Wc.Position.Y-Pb.y+kc.y+sb/this.Jd)}this.Bb.Gm()}L3l(Oa,sb){sb.Pj(1/this.TV);this.lOh(Oa,qf.a.add(this.xLa,sb))}resize(Oa,
sb){sb.Pj(1/this.TV);this.lOh(Oa,sb)}lOh(Oa,sb){Oa=this.G2d(Oa,sb);this.Kr(Oa);this.setOffsets(sb)}Fke(){const Oa=this.Ga.sC(this.ta,this.OI);return new Cf.a(Oa.x/this.Jd,Oa.y/this.Jd)}M3h(){this.ta.Iv&&(this.TV=this.nc.ug(this.ta).yq/this.vOe.x)}c5l(){const Oa=this.nc.ug(this.ta);this.vOe.update(Oa.yq,Oa.yl)}Pj(Oa){this.Jd=Oa;this.Bb.Pj(this.Jd);Oa=new be.a;Oa.aea(1/this.Jd,1/this.Jd);this.GC.oH(Oa,rh.a.nea);this.VIk?this.XZ(!1):this.XZ(!0)}get zoom(){return this.Jd/this.TV}Nge(){this.M3h();this.Kw||
(this.Kw=this.ta.Ko);var Oa=Cf.a.an(this.Kw.ga(0),this.Kw.ga(1));const sb=Cf.a.an(this.Kw.ga(0),this.Kw.ga(3)),Pb=this.Kw.ng(),kc=new Ei.a(new Cf.a(0,0),new Cf.a(Oa,0),new Cf.a(Oa,sb),new Cf.a(0,sb));kc.move(Pb.x-Oa/2,Pb.y-sb/2);Oa=this.Fke();kc.move(Oa.x,Oa.y);kc.scale(this.TV,this.TV);return kc}Ehm(Oa,sb){Oa=Oa.copy();Oa.scale(1/this.TV,1/this.TV);var Pb=this.Fke();Oa.move(-1*Pb.x,-1*Pb.y);Pb=Oa.ng();const kc=new be.a;sb?kc.$da(this.ta.get_shapeRotation(),Pb):kc.$da(this.ta.get_shapeRotation(),
this.Kw.ga(0));kc.Zm(Oa);sb||Oa.move(this.Kw.ga(0).x-Oa.ga(0).x,this.Kw.ga(0).y-Oa.ga(0).y);this.Kw=Oa;this.OY.yu(this.Kw.points);sb=this.NI.clipPath;Yf.a("SVGCreationOnChangesFromFormatPane")&&this.Koa&&sb?(sb.J5b=this.ZTc(Oa.copy()),this.dOc(Cf.a.nT(Oa.points[this.n0a],this.xKb))):sb&&sb.L$a&&sb.L$a.Phf(this.Kw.points);this.Toc=!0;this.XZ(!0);this.Bb.Gm()}setZIndex(Oa){this.Bb.xE(Oa+2*Aj.a.hja)}setOffsets(Oa){this.Kw||(this.Kw=this.ta.Ko);this.eCi(Oa);this.Do=Oa;var sb=this.GC.wGb;Oa=new Cf.a(sb[0].x/
this.Jd,sb[0].y/this.Jd);var Pb=new Cf.a(sb[2].x/this.Jd,sb[2].y/this.Jd);const kc=new Cf.a(sb[4].x/this.Jd,sb[4].y/this.Jd);sb=new Cf.a(sb[6].x/this.Jd,sb[6].y/this.Jd);Oa=new Ei.a(Oa,Pb,kc,sb);this.OY.yu(this.Kw.points);Pb=this.NI.clipPath;this.Koa&&Pb?(this.dOc(Cf.a.nT(Oa.points[this.n0a],this.xKb)),Pb.J5b=this.ZTc(Oa)):Pb&&Pb.L$a&&Pb.L$a.Phf(Oa.points);this.Bb.Gm()}eCi(Oa){var sb=this.Kw,Pb=Cf.a.an(sb.ga(0),sb.ga(1));sb=Cf.a.an(sb.ga(0),sb.ga(3));Oa.bottom-Oa.top<-1*sb&&(sb+=Oa.bottom-Oa.top,
Oa.top+=sb,Oa.bottom-=sb);Oa.right-Oa.left<-1*Pb&&(Pb+=Oa.right-Oa.left,Oa.left+=Pb,Oa.right-=Pb)}Kr(Oa){this.t2=Oa;this.OY.oH(Oa,rh.a.nea);this.XZ(!0)}Tv(Oa){this.Nv=Oa;this.Bb.oH(Oa,rh.a.Swb);this.Bb.Gm()}Xz(){Array.clear(this.Bo)}jF(Oa){return this.cpk(Oa)?this.Moe(Oa):null}bD(Oa){const sb=[];var Pb=this.ta.pictureCropInfo;if(this.ta.Iv){const kc=this.nc.ug(this.ta);if(Pb.MaskViewElem){const Wc=Og.a.WTc(6,kc.yq,kc.yl);Array.add(sb,Wc)}Pb.TextureViewElem&&(Pb=Og.a.WTc(7,kc.yq,kc.yl),Array.add(sb,
Pb));Array.add(this.Bo,Oa)}else this.Mb=!1,this.Bb.ee(!1);return sb}wE(){}jlm(){this.Elc.x!==this.KK.x&&this.Elc.y!==this.KK.y&&(ee.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.Raa.Position.X=this.KK.x+this.Ga.sC(this.ta,this.OI).x/this.Jd,this.Raa.Position.Y=this.KK.y+this.Ga.sC(this.ta,this.OI).y/this.Jd,this.rba.Position.X=this.NI.image.x+this.Ga.sC(this.ta,this.OI).x/this.Jd,this.rba.Position.Y=this.NI.image.y+
this.Ga.sC(this.ta,this.OI).y/this.Jd,this.Coa.update(0,0))}t4b(Oa,sb){const Pb=this.jl.fUc();this.ta.get_isVerticallyFlipped()&&(Pb.aea(1,-1),Pb.UE(0,2*sb._y));this.ta.get_isHorizontallyFlipped()&&(Pb.aea(-1,1),Pb.UE(2*sb._x,0));Pb.$da(Oa,sb);return Pb}dpg(){return this.ta.get_isVerticallyFlipped()&&this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}dOc(Oa){const sb=new be.a;sb.UE(Oa._x,Oa._y);this.NI.clipPath.oH(sb,rh.a.nea)}ZTc(Oa){ee.a.J(512497025,
809,15,"PictureCropShapeView:: createSVG operation started");var sb=this.ta.get_shapeRotation();this.jl.Gea(-sb,Oa.ng()).Zm(Oa);this.ov||(this.ov=svgShape.FactoryGlobal.createShape());this.ov.setSVGRoot(this.Bb.va,!1);this.ta.fM?this.ov.setShapeType(this.ta.fM):(this.ov.setShapeType(4),ee.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.ov.setOffsets(this.ta.get_xPersisted()+ki.a.WZ(Oa.ga(0).x/this.TV,0),this.ta.get_yPersisted()+ki.a.WZ(Oa.ga(0).y/this.TV,1));this.ov.setExtents(ki.a.WZ(Oa.ga(1).x-
Oa.ga(0).x,0),ki.a.WZ(Oa.ga(2).y-Oa.ga(1).y,1));var Pb=svgShape.FactoryGlobal.getConvertor().getPath(this.ov,!1,this.TV,this.TV);if(!Pb||!Pb.length)throw ee.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");Oa=Array(Pb.length);sb=0;for(const kc of Pb)Pb=new $d.a,Pb.h_(kc),Pb.va.setAttribute(fi.a.NTb,this.Nv.Dpb()),Oa[sb++]=Pb;ee.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");
return Oa}draw(Oa,sb){if(Array.contains(this.Bo,Oa)){Array.remove(this.Bo,Oa);if(this.ta.pictureCropInfo&&!this.qJa){if(this.ta.pictureCropInfo.MaskViewElem){Oa=this.ta.pictureCropInfo.MaskViewElem;var Pb=Oa.Clip,kc=this.nc.ug(this.ta);kc=Og.a.WTc(6,kc.yq,kc.yl);if(kc=sb[kc.toString()])this.KK.NQl(kc.Base64Data,Oa.Id.toString(),Pb.Bounds.Left,Pb.Bounds.Top,Pb.TotalWidth,Pb.TotalHeight,Pb.Bounds.Right-Pb.Bounds.Left,Pb.Bounds.Bottom-Pb.Bounds.Top),this.KK.ee(!0),this.KK.setPosition(Oa.Position.X-this.Ga.sC(this.ta,
this.OI).x/this.Jd,Oa.Position.Y-this.Ga.sC(this.ta,this.OI).y/this.Jd);this.Raa=Oa;this.Elc=new Cf.a(this.KK.x,this.KK.y)}this.ta.pictureCropInfo.TextureViewElem?(Oa=this.nc.ug(this.ta),kc=Og.a.WTc(7,Oa.yq,Oa.yl),Oa=this.ta.pictureCropInfo.TextureViewElem,Pb=Oa.Clip,(sb=sb[kc.toString()])?this.Koa?(this.n0a=this.dpg(),this.xKb=this.Eo.points[this.n0a].copy(),this.dOc(Cf.a.nT(this.ta.Ko.points[this.n0a],this.xKb)),this.Nv=this.t4b(this.ta.get_shapeRotation(),this.ta.Ko.ng()),this.NI.OQl(sb.Base64Data,
Oa.Id.toString(),Oa.Position.X-this.Ga.sC(this.ta,this.OI).x/this.Jd,Oa.Position.Y-this.Ga.sC(this.ta,this.OI).y/this.Jd,Pb.TotalWidth,Pb.TotalHeight,this.Eo.copy().points,this.ZTc(this.Eo.copy()))):this.NI.MQl(sb.Base64Data,Oa.Id.toString(),Oa.Position.X-this.Ga.sC(this.ta,this.OI).x/this.Jd,Oa.Position.Y-this.Ga.sC(this.ta,this.OI).y/this.Jd,Pb.TotalWidth,Pb.TotalHeight,this.ta.Ko.points):ee.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.rba=Oa):ee.a.J(512496992,
822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");this.Kw&&Cf.a.an(this.Kw.ga(0),this.Kw.ga(2))||(this.Kw=this.ta.Ko);this.sxa=this.ta.t1a;this.p6.yu(this.sxa.points);this.OY.yu(this.Kw.points);this.qJa=!0;this.XZ(!0);this.visible=this.Mb}else this.Txa&&this.Raa&&this.rba&&(this.jlm(),this.KK.setPosition(this.Raa.Position.X-this.Ga.sC(this.ta,this.OI).x/this.Jd,this.Raa.Position.Y-this.Ga.sC(this.ta,this.OI).y/this.Jd),this.NI.image.setPosition(this.rba.Position.X-
this.Ga.sC(this.ta,this.OI).x/this.Jd,this.rba.Position.Y-this.Ga.sC(this.ta,this.OI).y/this.Jd),this.Koa?(this.n0a=this.dpg(),this.xKb=this.Eo.points[this.n0a].copy(),this.dOc(Cf.a.nT(this.ta.Ko.points[this.n0a],this.xKb)),this.Nv=this.t4b(this.ta.get_shapeRotation(),this.ta.Ko.ng()),this.NI.clipPath.J5b=this.ZTc(this.ta.Ko)):this.NI.clipPath.L$a=new Qf.a(this.ta.Ko.points,0),this.Elc=new Cf.a(this.KK.x,this.KK.y),this.Kw=this.ta.Ko,this.sxa=this.ta.t1a,this.p6.yu(this.sxa.points),this.OY.yu(this.Kw.points),
this.XZ(!0),ee.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));this.Bb.Gm();this.Bb.ee(this.Mb)}}khm(){if(this.Kw){var Oa=this.GC.wGb;const sb=new Cf.a(Oa[0].x/this.Jd,Oa[0].y/this.Jd),Pb=new Cf.a(Oa[2].x/this.Jd,Oa[2].y/this.Jd),kc=new Cf.a(Oa[4].x/this.Jd,Oa[4].y/this.Jd);Oa=new Cf.a(Oa[6].x/this.Jd,Oa[6].y/this.Jd);this.Kw=new Ei.a(sb,Pb,kc,Oa)}else this.Kw=this.ta.Ko;this.Eo=this.Kw.copy();this.sxa||(this.sxa=this.ta.t1a);this.sxa.move(this.Gxa.x,this.Gxa.y);this.p6.yu(this.sxa.points);
this.Coa.BN(this.Gxa.x,this.Gxa.y);this.Gxa.update(0,0);this.ue.Gz(new bi.a(1))}vwj(){var Oa=this.GC.wGb;const sb=new Cf.a(Oa[0].x,Oa[0].y),Pb=new Cf.a(Oa[2].x,Oa[2].y),kc=new Cf.a(Oa[4].x,Oa[4].y);Oa=new Cf.a(Oa[6].x,Oa[6].y);return new Ei.a(sb,Pb,kc,Oa)}zyj(){var Oa=this.ta.t1a.copy().points,sb=new Cf.a(Oa[0].x*this.Jd,Oa[0].y*this.Jd);const Pb=new Cf.a(Oa[1].x*this.Jd,Oa[1].y*this.Jd),kc=new Cf.a(Oa[2].x*this.Jd,Oa[2].y*this.Jd);Oa=new Cf.a(Oa[3].x*this.Jd,Oa[3].y*this.Jd);sb=new Ei.a(sb,Pb,kc,
Oa);sb.scale(1/this.TV,1/this.TV);sb.move((this.Coa.x+this.Gxa.x)*this.Jd,(this.Coa.y+this.Gxa.y)*this.Jd);return sb}TF(Oa){this.qJa&&(this.GC.ee(!Oa),Oa?(this.M3h(),this.Toc=!0):(this.khm(),this.ia.Ia(ke.a.Z4a,2,{["sectionName"]:"Crop",["sectionNewState"]:this.qJa}),this.Txa&&(Oa={["pictCropperInfo"]:this.RRf(),["shapeNode"]:this.ta},this.ia.Ia(ke.a.hxc,2,Oa))))}Jq(){return this.Bb.Jq()}XZ(Oa){if(this.qJa){var sb=this.Kw.copy();Oa&&this.t2.Zm(sb);Oa=new be.a;Oa.pvb(this.ta.get_shapeRotation());var Pb=
2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let kc=0;8>kc;++kc){const Wc=this.gE[kc];Wc.Dm(Eh.a.rR(Ud.a.box4Image(Ki.Mwc[Pb]),Th.a.LB));this.wNa(Wc,sb.el(new ei.a(kc)));Wc.oH(Oa,rh.a.Swb);Pb=(Pb+1)%8}}}wNa(Oa,sb){Oa.x===sb.x*this.Jd&&Oa.y===sb.y*this.Jd||Oa.setPosition(sb.x*this.Jd,sb.y*this.Jd)}get visible(){return this.Mb}set visible(Oa){this.Mb=Oa;!Oa&&this.qJa&&(this.Hjj(),this.qJa=!1);this.Bb.ee(this.Mb)}Hjj(){if(this.qJa){if(this.Toc){const Oa={["pictCropperInfo"]:this.RRf(),["shapeNode"]:this.ta};
this.ia.Ia(ke.a.hxc,2,Oa)}this.K4()}}RRf(){const Oa=this.zOi(),{left:sb,top:Pb,right:kc,bottom:Wc}=this.vXi(),Xd=new tj.a;Xd.Left=sb;Xd.Top=Pb;Xd.Right=kc;Xd.Bottom=Wc;Xd.X=Oa.x;Xd.Y=Oa.y;return Xd}vXi(){let Oa,sb,Pb,kc;({left:Oa,top:sb,right:Pb,bottom:kc}=this.$aj());({left:Oa,top:sb,right:Pb,bottom:kc}=this.f0i(Oa,sb,Pb,kc));({left:Oa,top:sb,right:Pb,bottom:kc}=Ki.Qmm(Oa,sb,Pb,kc));return{left:Oa,top:sb,right:Pb,bottom:kc}}$aj(){var Oa=this.sxa.points;const sb=this.Kw.points,Pb=Pi.a(Oa[3],Oa[0],
sb[3],sb[0]),kc=Pi.a(Oa[0],Oa[1],sb[0],sb[1]),Wc=Pi.a(Oa[1],Oa[2],sb[1],sb[2]);Oa=Pi.a(Oa[2],Oa[3],sb[2],sb[3]);return{left:Pb,top:kc,right:Wc,bottom:Oa}}f0i(Oa,sb,Pb,kc){var Wc=this.sxa.points;const Xd=Cf.a.an(Wc[0],Wc[1]);Wc=Cf.a.an(Wc[1],Wc[2]);Oa=Math.floor(Oa/Xd*1E6)/1E6;sb=Math.floor(sb/Wc*1E6)/1E6;Pb=Math.floor(Pb/Xd*1E6)/1E6;kc=Math.floor(kc/Wc*1E6)/1E6;return{left:Oa,top:sb,right:Pb,bottom:kc}}zOi(){var Oa=this.Kw.copy(),sb=new be.a,Pb=Oa.ng();sb.$da(-1*this.ta.get_shapeRotation(),Pb);sb.Zm(Oa);
Pb=this.Ga.sC(this.ta,this.OI);this.CRk?(sb=this.OI.Cf(Oa.oc*this.Jd+Pb.x,0),Oa=this.OI.Cf(Oa.pc*this.Jd+Pb.y,1),Oa=new Cf.a(sb,Oa)):Oa=new Cf.a(Oa.oc+Pb.x/this.Jd,Oa.pc+Pb.y/this.Jd);return Cf.a.scale(Oa,this.TV,this.TV)}znd(){return!0}K4(){this.OY.oH(new be.a,rh.a.nea);this.p6.setPosition(0,0);this.Do=new qf.a;this.Eo=this.Kw=this.t2=this.ta.pictureCropInfo=null;this.Coa.update(0,0);this.Toc=!1;this.vOe.update(0,0);this.TV=1}G2d(Oa,sb){const Pb=new be.a;this.Eo||(this.Eo=Oa);Oa=this.Eo.ng();const kc=
Cf.a.an(this.Eo.ga(0),this.Eo.ga(1)),Wc=Cf.a.an(this.Eo.ga(0),this.Eo.ga(3)),Xd=kc?1+(sb.right-sb.left)/kc:1,Gd=Wc?1+(sb.bottom-sb.top)/Wc:1,Pe=Oa.copy();Pe.BN(-1*kc/2,-1*Wc/2);Pb.$da(-1*this.ta.get_shapeRotation(),Oa);Pb.UE(-1*Pe.x,-1*Pe.y);Pb.aea(Xd,Gd);Pb.UE(sb.left+Pe.x,sb.top+Pe.y);Pb.$da(this.ta.get_shapeRotation(),Oa);return Pb}B2i(Oa,sb){var Pb=[new Cf.a(0,0),new Cf.a(20,0),new Cf.a(20,5),new Cf.a(5,5),new Cf.a(5,20),new Cf.a(0,20)];Pb=new Qf.a(Pb,0);Pb.va.id=sb;Pb.UF("black");Pb.Vv("white");
Pb.vs(1);Oa.equals(ei.a.IF)?Pb.CNa(90):Oa.equals(ei.a.Pv)?Pb.CNa(0):Oa.equals(ei.a.ZF)?Pb.CNa(180):Oa.equals(ei.a.hJ)&&Pb.CNa(-90);return Pb}M6i(Oa,sb){const Pb=new Cg.a;Pb.va.id=sb;Pb.UF("black");Pb.Vv("white");Pb.vs(1);Pb.Mh(20,5);Oa.equals(ei.a.north)?Pb.setPosition(-10,0):Oa.equals(ei.a.south)?Pb.setPosition(-10,-5):Oa.equals(ei.a.east)?(Pb.setPosition(-5,-10),Pb.Mh(5,20)):Oa.equals(ei.a.west)&&(Pb.setPosition(0,-10),Pb.Mh(5,20));return Pb}get xLa(){return this.Do}get Ee(){return this.Bb.viewport}ake(Oa){return!this.ta.Iv&&
8>Oa.index?this.gE[Oa.index].va:null}aP(){return!1}Ry(Oa){Oa&&(this.Toc=!1)}setSelection(){}static Qmm(Oa,sb,Pb,kc){.999999<Oa+Pb&&(ee.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",Oa,Pb),Pb=(999999-1E6*Oa)/1E6);.999999<sb+kc&&(ee.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",sb,kc),kc=(999999-1E6*sb)/1E6);return{left:Oa,top:sb,right:Pb,bottom:kc}}}Ki.Mwc=[Th.a.jVh,Th.a.hVh,Th.a.iVh,Th.a.gVh,Th.a.lVh,Th.a.kVh,Th.a.mVh,Th.a.nVh];Object(k.a)(Ki,
"PictureCropShapeView",null,[1087,805,806,106]);var sk=d(674);class kk{constructor(Oa,sb,Pb){this.Ga=Oa;this.OI=sb;this.laa=Pb}setPosition(Oa,sb,Pb){this.laa.dK(Oa.shapeNode).K3l(sb,Pb)}setOffsets(Oa,sb){this.laa.dK(Oa.shapeNode).L3l(Oa.Zgf.copy(),sb)}ZJ(Oa,sb){const Pb=new be.a,kc=this.laa.dK(Oa.shapeNode);sb=sb?kc.vwj().copy():kc.zyj().copy();Oa=this.Ga.sC(Oa.shapeNode,this.OI);Pb.UE(Oa.x,Oa.y);Pb.Zm(sb);return new sk.a(sb)}pH(Oa){return Oa.shapeNode.Iv}}Object(k.a)(kk,"ShapeCropMoveResizeHandler",
null,[190]);class Nj{constructor(Oa,sb,Pb){this.laa=Oa;this.Txa=sb;this.Dhd=Pb}qW(Oa,sb,Pb){if((Oa=this.laa.dK(Oa))&&Oa.visible!==Pb){for(const kc of sb)this.Dhd&&(sb=Object(Fb.a)(854,kc))&&sb.setSelected(!Pb),kc!==Oa&&(kc.visible=!Pb);Oa.visible=Pb}}sAd(){return!1}LEd(Oa,sb,Pb){this.laa.dK(Oa).resize(Pb,sb)}tAd(){return!1}MEd(Oa,sb,Pb,kc){kc&&this.laa.dK(Oa).setPosition(sb,Pb)}D9c(){return!this.Txa}ccb(Oa,sb){return this.Txa?sb:[this.laa.dK(Oa)]}pH(Oa){return Oa.Iv}}Object(k.a)(Nj,"ShapeViewCropUpdateStrategyHandler",
null,[855,851]);var rl=d(342);class cj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}fc(Oa){this.K=Oa;this.K.register(722,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().na(()=>new rl.a((sb,Pb)=>{let kc=null;const Wc=Object(Fb.a)(178,sb.sc(this.K.resolve("Box4.IPageView").Na));Wc&&!Wc.hm&&(kc=new Ki(sb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Xd,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Pb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").NXe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Drd,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").lee),
kc.Cn(Wc.va),kc.setZIndex(3),kc.visible=!1,Wc.pL(kc.Ee.va,!0),Wc.vta(kc,3));return kc}));this.K.register(nf,"PowerPointWebEditor.PictureCropActor").ma().na(()=>new nf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bnk,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").MXe,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lma,
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Drd,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").enableCameoInEditor));this.K.register(fd,"PowerPointWebEditor.FormatPicturePaneActor").ma().na(()=>new fd(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),ff.a(this.K)))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new Nj(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").NXe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Erd));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new kk(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.IPageView").Xd,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").qb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").qb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").Sd()}dispose(){}static main(){n.a.instance.Ac(Ag.a(new cj,0))}}Object(k.a)(cj,"PPTWebEditorPictureCropPackage",null,[2,3]);var bh=d(40),vi=d(248);class xh{constructor(Oa,
sb,Pb,kc,Wc){this.ZA=[bh.a.Dj,bh.a.font,xd.a.autonumberBulletType];this.Ub=Oa;this.zm=sb;this.Uh=Pb;this.cnc=kc;this.IK=Wc}format(Oa){if(Oa&&Oa.eFb){Oa=this.Ub.Pc(Oa);for(var sb=this.zm.R4(Oa,Oa.currentNode);sb.moveNext();){var Pb=sb.currentNode;if(Pb&&this.Uh.ke(Pb)){var kc=this.Uh.flb(Pb);kc=this.IK.BR(Oa,kc);(Pb=this.cnc.L0c(Pb))&&vi.d(kc,Pb,this.ZA)}}}}}Object(k.a)(xh,"BeautifyListFormatter",null,[1069]);class hh{constructor(Oa,sb,Pb,kc,Wc){this.ia=Oa;this.sa=Pb;this.Eb=sb;this.Ga=kc;this.uGk=
Wc}initialize(){this.qb()}qb(){this.ia.pa(ke.a.M0d,Y.a.application,Object(C.a)(this,this.M0d,"applyTextFormatterSuggestion"),4)}M0d(Oa,sb,Pb){if(1===Pb)return 32;Oa=this.sa.Aa;if(!Oa)return 16;sb=Oa.yj();if(!sb||!sb.length)return 16;sb=this.Ga.a1(sb);if(!sb.length)return 16;Pb=this.Eb.ud(15);Pb.mc(Oa);for(const kc of sb)this.uGk.format(kc);Pb.dispose();return 32}}Object(k.a)(hh,"TextFormatterActor",null,[]);class zf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}fc(Oa){this.K=
Oa;Oa.register(1069,"PowerPointWebEditor.IBeautifyListFormatter").ma().na(()=>new xh(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor")));Oa.register(hh,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().na(()=>new hh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const Oa=this.K.resolve("Common.IAppSettingsManager");Oa.Ue(()=>{Oa.getBooleanAppSetting("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){n.a.instance.Ac(Ag.a(new zf,0))}}Object(k.a)(zf,"PPTWebEditorTextFormatterPackage",null,[2,3]);var Yh=d(13);
Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(Yh.d)("Chronos1");Qa.main();Type.registerNamespace("Common.App.O365Shell");dc.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Nb.main();Type.registerNamespace("Common.App.TellMe");
Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Pf.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",
attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},
{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},
{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",
attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",
Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",
Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",
Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",
Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",
Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",
InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",
attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",
Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",
Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},
{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},
children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",
attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",LabelText:"STR@L_DesktopUpSellTitle",
Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};cj.main();zf.main();Type.registerNamespace("NLRT");Object(Yh.c)("Chronos1")},140:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(227);class e{constructor(n,r){this.IQa=!1;const {Annotations:w}=d(79);if(!n)throw Error.argumentNull("annotations");
if(!n.Cye(r))throw Error.argument("memberTypeID","Invalid type ID");if(w.kD(r))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Ls=n;this.mji=r;this.pD=[]}get Pvb(){return this.Ls}get isReadOnly(){return this.IQa}get YV(){return this.mji}get items(){return this.pD}K3(){const {Annotations:n}=d(79);let r="[";for(let w=0,D=this.items.length;w<D;++w){0<w&&(r+=", ");const y=this.Ls.K3(this.YV,this.items[w]);this.YV===n.C_?(r+='"',r+=k.a.ace(y),r+='"'):r+=y}return r+"]"}isEqual(n){const {Annotations:r}=
d(79);if(this===n)return!0;if(!n||n.Pvb!==this.Ls||n.YV!==this.YV||n.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!r.l5a(this.YV,this.items[w],n.items[w]))return!1;return!0}clone(){const n=new e(this.Ls,this.YV);Array.addRange(n.items,this.items);return n}kM(){return this.isReadOnly?this.clone():this}nAe(){const {Annotations:n}=d(79);if(!this.isReadOnly){this.IQa=!0;for(const r of this.items)n.Jfb(r)}}toString(){return this.K3()}}Object(L.a)(e,"ListValue",null,
[1314,1313])},145:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.hq="TellMe";k.contextMenu="ContextMenu";k.unknown="Unknown";Object(L.a)(k,"TellMeScenario",null,[])},159:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n,r=null,w=null,D=4,y=-99999,m=0){this.C_d="";this.UOc=-1;this.value=e;this.type=n;this.subType=D;this.label=this.aL=r;this.groupType=30;this.description=w;this.score=y;this.count=m}}Object(L.a)(k,"ResultBinding",null,[])},173:function(L,
V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.attributes=null;this.query=e;this.zl=[]}jr(e){this.zl.push(e)}nDh(e){const n=[];for(const r of this.zl)r.groupType!==e&&n.push(r);this.zl.length!==n.length&&(this.zl=n)}get zEb(){return!1}}Object(L.a)(k,"SimpleResultsUpdatedEventArgs",null,[1126])},174:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e=30,n=""){this.Vmi=[];this.groupType=e;this.displayName=n}get results(){return this.Vmi}qt(e){e.groupType=
this.groupType;Array.add(this.results,e)}X2e(e=1){if(this.results.length>=e)for(let n=0;n<e;n++)Array.removeAt(this.results,this.results.length-1)}}Object(L.a)(k,"SimpleResultGroup",null,[1127])},227:function(L,V,d){L=d(0);class k{constructor(n,r){this.QSa=n;this.value=r}}Object(L.a)(k,"AttrValuePair",null,[]);d.d(V,"a",function(){return e});class e{constructor(n){this.IQa=!1;if(!n)throw Error.argumentNull("annotations");this.Ls=n;this.uP=[]}get Pvb(){return this.Ls}get isReadOnly(){return this.IQa}get qne(){return 0<
this.uP.length}Sn(n){if(!this.Ls.iFb(n))throw Error.argument("attributeID","Invalid attribute ID");for(const r of this.uP)if(n===r.QSa)return n=r.value,{returnValue:!0,value:n};return{returnValue:!1,value:null}}vv(n,r){var {Annotations:w}=d(79);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Ls.iFb(n))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Ls.eEb(this.Ls.getAttributeType(n),r))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");w.Jfb(r);for(w=0;w<this.uP.length;++w){const D=this.uP[w];if(n===D.QSa){D.value=r;return}}Array.add(this.uP,new k(n,r))}$ud(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Ls.iFb(n))throw Error.argument("attributeID","Invalid attribute ID");for(let r=0;r<this.uP.length;++r)if(n===this.uP[r].QSa){Array.removeAt(this.uP,r);break}}PYc(n){if(!n)throw Error.argumentNull("action");
for(const r of this.uP)n(r.QSa,r.value)}clone(){const n=new e(this.Ls);n.TEa(this);return n}TEa(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!n)throw Error.argumentNull("other");if(n.Pvb!==this.Ls)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.uP);n.PYc((r,w)=>{this.vv(r,w)})}K3(){const {Annotations:n}=d(79);let r="[",w=!0;for(const D of this.uP){w?w=!1:r+=", ";r+=this.Ls.ggg(D.QSa);r+="=";const y=this.Ls.getAttributeType(D.QSa),
m=this.Ls.K3(y,D.value);y===n.C_?(r+='"',r+=e.ace(m),r+='"'):r+=m}return r+"]"}isEqual(n){const {Annotations:r}=d(79);if(!n)throw Error.argumentNull("other");if(this===n)return!0;if(!n||this.Ls!==n.Pvb||this.qne!==n.qne)return!1;let w=0,D=null,y=!1;n.PYc((m,C)=>{++w;if(!y){var E=-1;for(let F=0,B=this.uP.length;F<B;++F)if(this.uP[F].QSa===m){E=F;break}0>E?y=!0:(D||(D=Array(this.uP.length)),D[E]=C)}});if(this.uP.length!==w||y)return!1;for(let m=0,C=this.uP.length;m<C;++m)if(!r.l5a(this.Ls.getAttributeType(this.uP[m].QSa),
this.uP[m].value,D[m]))return!1;return!0}kM(){return this.isReadOnly?this.clone():this}nAe(){const {Annotations:n}=d(79);if(!this.isReadOnly){this.IQa=!0;for(const r of this.uP)n.Jfb(r.value)}}toString(){return this.K3()}static ace(n){return n.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(L.a)(e,"FeatureBundle",null,[1312,1313])},268:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.click="Click";k.nDb="InteractionBegin";k.Hyg="InteractionEnd";
k.j_f="ControlActivated";k.query="Query";k.oyh="QueryIndexRecorded";k.uYf="Clicks";k.SIf="ActionEvents";k.Tbg="FilteredActionEvents";k.ZKh="SessionContext";k.latency="Latency";k.performance="Performance";k.fFh="RenderedResults";k.events="Events";k.f6i="CreateResultsMenu";k.OB="UpdateRibbonControls";k.gHl="ResultsAggregation";k.AC="IssueQuery";k.rWi="CommandSuggestions";k.error="Error";k.dAe="LoadModelData";k.faj="DepsResolveTime";k.xYk="ModelDataWaitTime";k.Cef="TimedOut";k.CBi="AddinQueryCommandReady";
k.Ntj="GetAddinEntitlements";k.Yxh="ProviderMRUEvents";k.Vfj="EnableAddinSearchCommands";Object(L.a)(k,"EventNames",null,[])},283:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(){this.hNe=null;this.nA=this.OOe=0}gZc(e,n,r){if(!e)throw Error.argumentNull("referenceList");if(0>n||n>e.length)throw Error.argumentOutOfRange("startIndex");if(0>r||r>e.length)throw Error.argumentOutOfRange("length");if(n+r>e.length)throw Error.argument("Invalid start-length range");this.hNe=e;
this.OOe=n;this.nA=r}sVa(e,n,r){this.gZc(e.hNe,e.OOe+n,r)}ga(e){if(0>e||e>=this.nA)throw Error.argumentOutOfRange("index");return this.hNe[this.OOe+e]}get count(){return this.nA}static j8d(e){const n=new k;n.gZc(e,0,e.length);return n}}Object(L.a)(k,"ReadOnlyList",null,[1356])},305:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.Fqm=0]="Classifier";e[e.sqm=1]="AppsForOffice";e[e.K7h=2]="FindInDocument";e[e.Tqm=3]="FindInDocumentScopedSearch";e[e.Vrm=4]="RecentlyUsed";
e[e.l9h=5]="TryQuery";e[e.Empty=6]="Empty";e[e.Asm=7]="TryCommand";e[e.X6h=8]="Assistance";e[e.W6h=9]="Answer";e[e.Definition=10]="Definition";e[e.C7h=11]="Entity";e[e.J9h=12]="WolframAnswer";e[e.U7h=13]="Insights";e[e.L8h=14]="People";e[e.Document=15]="Document";e[e.Wrm=16]="Recommended";e[e.fsm=17]="ServiceClassifier";e[e.gsm=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.h8h=21]="Learning";e[e.Feedback=22]="Feedback";e[e.h9h=23]="Template";e[e.Kjf=24]="ActionAI";e[e.T6h=
25]="ActionAICommand";e[e.LGd=26]="SummarizeDeck";e[e.U6h=27]="Addin";e[e.A8h=28]="OfficeScript";e[e.V6h=29]="AddinStoreEntry";e[e.None=30]="None";e[e.zrm=31]="MergedActions";e[e.Arm=32]="MergedScopedSearches";e[e.Brm=33]="MergedSuggestedSearches"})(k||(k={}));Object(L.b)("ResultGroupType",k)},343:function(L,V,d){d.r(V);d.d(V,"CommandResultsUtility",function(){return C});L=d(0);var k=d(391),e=d(268),n=d(392),r=d(159),w=d(174),D=d(116),y=d(108),m=d(25);class C{static mUb(E,F){if(F&&F.Xp){const B={};
for(const H of E)F.x9c(H)&&(B[H]=appChrome.selectors.getModelType(H));D.TellMeActor.instance.OB(B)}}static I9l(E){return E.startsWith("btnTellMeOfficeAddIn")}static tec(E){const F=D.TellMeActor.instance.cI();return!!F&&F.Xp&&!appChrome.selectors.isControlDisabled(E)}static J$c(E,F,B,H){if(D.TellMeActor.instance.Qd&&E){const K=[];for(const A of E)K.push(String.format('{{"Id":"{0}","Score":{1}}}',A.commandId,A.score));E={};E[k.a.suggestions]="[{"+K.join(",")+"}]";E[k.a.jHg]=F;E[k.a.groupType]=B;E[k.a.provider]=
H;D.TellMeActor.instance.Qd.TI(e.a.rWi,window.performance.now(),E)}}static Wxj(E,F){const B=[],H=[];for(const K of F){F=K.commandId;let A=K;K.commandId in E&&(F=E[K.commandId],A=new n.a(F,K.score));Array.contains(H,F)||(B.push(A),H.push(F))}return B}static Xac(E,F,B,H,K,A,W,N){B.Jge&&(F=C.Wxj(B.Jge,F));var P=y.a.Xwj(F);C.mUb(P,B);var U=[],Q=[];P=[];const G=new w.a(W);W=16===W||18===W||7===W||4===W?m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.tc("TellMeMaxRecommendedResultsToReturn",3):3:
0===W||17===W||25===W?5:0;for(const Y of F)if(!C.Egk(Y.commandId)){F=C.I9l(Y.commandId);if(B.x9c(Y.commandId)&&!F){if(y.a.mGg(Y.commandId))continue;F=null;K&&A&&(F=K.OHj(Y.commandId,A));C.tec(Y.commandId)?Array.add(U,new r.a(Y.commandId,5,F,null,N,Y.score)):Array.add(Q,new r.a(Y.commandId,5,F,null,N,Y.score))}else B.O9a&&F&&H&&Array.add(P,Y.commandId.substr(21));if(U.length+P.length>=W)break}B=0;for(K=0;K<U.length&&B<W;K++,B++)G.qt(U[K]);for(U=0;U<Q.length&&B<W;U++,B++)G.qt(Q[U]);for(Q=0;Q<P.length&&
B<W;Q++,B++)H.KEm(E,P[Q],G);return G}static Egk(E){C.fRf||(m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.du("TellMeControlPredictionBlockList")&&m.AFrameworkApplication.fa.hz("TellMeControlPredictionBlockList").forEach(F=>{Array.add(C.eRf,F.toLowerCase())}),C.fRf=!0);return Array.contains(C.eRf,E.toLowerCase())}static Aue(E){return 2<E.length&&";"===E.charAt(0)&&";"===E.charAt(E.length-1)&&!!m.AFrameworkApplication.fa&&(m.AFrameworkApplication.fa.getBooleanAppSetting("TellMeCommandHookIsEnabled")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static whg(E){const F=new w.a(0);var B=E.split(";");E=D.TellMeActor.instance.cI();for(const H of B)if(0<H.length){B=H.split(":");const K=2===B.length?B[0]:H;if(!E.x9c(K))break;if(1===B.length)B=new r.a(K,5,null,null,1),F.qt(B);else if(2===B.length)B=new r.a(K,5,B[1],null,1),F.qt(B);else break}return F}static yui(E,F,B){if(!(F&&F.results&&E&&E.results&&E.results.length))return{returnValue:!1,
ZYd:E,BZd:F};const H=[];for(var K of F.results)Array.add(H,K.value);K=0;const A=0<F.results.length?F.results[0].score:0;for(const W of E.results)if(W.score>B&&!Array.contains(H,W.value)&&C.tec(W.value)&&(0<A&&(W.score=A),Array.insert(F.results,K,W),K++),2===K)break;return 0<K?(B=F.results.length-5,0<B&&F.X2e(B),{returnValue:!0,ZYd:E,BZd:F}):{returnValue:!1,ZYd:E,BZd:F}}}C.fRf=!1;C.eRf=[];Object(L.a)(C,"CommandResultsUtility",null,[])},391:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}
k.appName="AppName";k.IEa="CloseAllMenus";k.commandId="CommandId";k.context="Context";k.culture="Culture";k.message="Message";k.errorMessage="ErrorMessage";k.event="Event";k.D$="CorrelationID";k.tdl="ParentUiElement";k.query="Input";k.Rlb="QueryID";k.qyh="QueryLength";k.iOb="QueryIndex";k.hHl="ResultsList";k.suggestions="Suggestions";k.scenario="Scenario";k.sessionId="SessionID";k.source="Source";k.timeStamp="Time";k.z0h="UiElement";k.xud="ReactUx";k.value="Val";k.statusCode="StatusCode";k.INl="Service";
k.isSuccess="IsSuccess";k.Eam="TokenAcquired";k.gvk="LatencyType";k.groupName="GroupName";k.kdb="GroupIndex";k.groupType="GroupType";k.dHl="ResultInfoList";k.resultType="ResultType";k.vcf="SubResultType";k.pkk="IsInputBlur";k.qkk="IsInputFocus";k.sqk="IsShortCutUsed";k.actionType="ActionType";k.count="Count";k.Mej="DwellTime";k.jHg="IsZeroTerm";k.Cpm="WordsCount";k.J8c="IsSearchUxEnabled";k.Trk="IsTellMeInHeaderEnabled";k.module="Module";k.resultIndex="ResultIndex";k.Y$d="DisplayIndex";k.cgj="EnableList";
k.provider="Provider";k.contentType="ContentType";k.Upk="IsSelectionBased";k.VHi="BeginPerformanceMarker";k.Dgj="EndPerformanceMarker";k.Dfl="PerformanceMeasure";Object(L.a)(k,"Columns",null,[])},392:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e,n){this.commandId=e;this.score=n}}Object(L.a)(k,"CommandSuggestion",null,[])},455:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{static oBc(e){if(!e)return"{NULL}";const n=e.length;return 600>=n?e:e.substring(0,
400)+"[...]"+e.substring(n-195,n)}}Object(L.a)(k,"LogUtils",null,[])},456:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.hq="TellMe";k.dFk="Loki";k.xVh="Substrate";k.iOb="QueryIndex";k.yXh="TellMeRanker";k.zXh="TellMeRankerLogging";Object(L.a)(k,"Services",null,[])},457:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{}k.Ova="HttpRequest";k.provider="Provider";Object(L.a)(k,"LatencyTypes",null,[])},557:function(L,V,d){L=d(0);class k{constructor(){this.YAc=this.Edc=
null;this.UQe=this.score=this.zpc=0}VWe(B,H,K){this.score=B.ga(H);++H;this.Edc=B.ga(H)?K.m$(B.ga(H)):null;++H;this.YAc=B.ga(H)?K.m$(B.ga(H)):null;++H;this.zpc=B.ga(H);++H;this.UQe=B.ga(H);++H;return H}}Object(L.a)(k,"TokenStringGeneratorInit",null,[]);class e{constructor(B,H,K,A,W){this.kVa=B;this.count=H;this.AYc=K;this.ZH=A;this.depth=W}}Object(L.a)(e,"ErrorTolerantTrieMatch",null,[]);var n=d(723),r=d(1022);class w{constructor(B=null,H=0,K=0,A=0){this.tqi=B||new r.a;this.efa=H;this.ZH=K;this.depth=
A}get IW(){return this.tqi}getKey(){return this.IW.mu.toString()+":"+this.efa.toString()}}Object(L.a)(w,"TrieBookmark",null,[]);class D{constructor(B,H){this.Gya=B;this.nLe=H}fFk(B){if(null==B)throw Error.argumentNull("prefix");let H={};var K=H[""]=new w;this.o4c(K,H);for(K=0;K<B.length;++K){const A=B.charCodeAt(K),W={};for(let N in H)this.wCi(A,H[N],W);H=W}return this.Obm(H)}o4c(B,H){if(!(B.ZH>=this.nLe)&&(B=new w(n.a.k5d(B.IW),B.efa,B.ZH+1,B.depth),B.IW.EA&n.a.hPa&&(B.efa+=1),this.Gya.Npb(B.IW))){B.depth+=
1;let K=!0;for(;K;)D.eFd(B,H),this.o4c(B,H),B.efa+=this.Gya.UAb(B.IW,!0)+(B.IW.EA&n.a.hPa?1:0),K=this.Gya.iBc(B.IW)}}wCi(B,H,K){H.ZH+1<=this.nLe&&(H.ZH+=1,D.eFd(H,K),--H.ZH);H.IW.EA&n.a.hPa&&(H.efa+=1);if(this.Gya.Npb(H.IW)){H.depth+=1;let A=!0;for(;A;)H.IW.oqb===B?(D.eFd(H,K),this.o4c(H,K)):H.ZH+1<=this.nLe&&(H.ZH+=1,D.eFd(H,K),this.o4c(H,K),--H.ZH),H.efa+=this.Gya.UAb(H.IW,!0)+(H.IW.EA&n.a.hPa?1:0),A=this.Gya.iBc(H.IW)}}Obm(B){const H=[];for(var K in B){const A=B[K];if(!A.IW.mu)continue;const W=
!!(A.IW.EA&n.a.hPa),N=this.Gya.UAb(A.IW,!1)+(W?1:0);Array.add(H,new e(A.efa,N,W,A.ZH,A.depth))}H.sort((A,W)=>{let N=A.kVa-W.kVa;return N||(N=-(A.count-W.count))?N:N=A.depth-W.depth});if(2>H.length)return H;B=[];for(K=0;K<H.length;)K+=D.mZh(K,H,B);return B}static eFd(B,H){const K=B.getKey();K in H?(H=H[K],H.ZH=Math.min(H.ZH,B.ZH)):H[K]=new w(n.a.k5d(B.IW),B.efa,B.ZH,B.depth)}static mZh(B,H,K){const A=H[B];let W=A.kVa;const N=W+A.count;let P=1,U=A.AYc;for(;B+P<H.length&&H[B+P].kVa<N;){const Q=H[B+P];
Q.kVa>W&&(Array.add(K,new e(W,Q.kVa-W,U,A.ZH,A.depth)),U=!1);P+=D.mZh(B+P,H,K);W=Q.kVa+Q.count}W<N&&Array.add(K,new e(W,N-W,U,A.ZH,A.depth));return P}}Object(L.a)(D,"ErrorTolerantTrieLookupEngine",null,[1501]);class y extends k{constructor(B,H,K){super();this.Xwg=this.drh=!1;this.h$f=null;if(B){var A=0;try{A=this.VWe(B,A,H);this.drh=1===B.ga(A);++A;this.Xwg=1===B.ga(A);++A;const W=B.ga(A);this.h$f=this.Kdl(K,W)}catch(W){throw Error.argument("initData");}}}Kdl(B,H){return new D(B,H)}}Object(L.a)(y,
"FuzzyMatchTokenStringGeneratorInit",k,[]);class m extends k{constructor(B,H){super();this.query=this.name=null;if(B){this.annotations=H.annotations;var K=0;try{K=this.VWe(B,K,H),this.name=H.MD(B.ga(K)),++K,this.query=H.eF(B.ga(K))}catch(A){throw Error.argument("initData");}}}}Object(L.a)(m,"QueryTokenStringGeneratorInit",k,[]);class C extends k{constructor(B,H){super();if(B)try{this.VWe(B,0,H)}catch(K){throw Error.argument("initData");}}}Object(L.a)(C,"SurfaceStringTokenStringGeneratorInit",k,[]);
var E=d(283);d.d(V,"a",function(){return F});class F{constructor(B){this.hCe=B}get Edc(){return this.hCe.Edc}get YAc(){return this.hCe.YAc}get zpc(){return this.hCe.zpc}static create(B,H,K){const {SurfaceStringTokenStringGenerator:A}=d(1187),{QueryTokenStringGenerator:W}=d(1188),{FuzzyMatchTokenStringGenerator:N}=d(1189);let P=0;try{if(B.ga(P)!==F.l$a)throw Error.argument("initData","Input does not represent a token string generator");++P;const U=B.ga(P);++P;const Q=new E.a;Q.sVa(B,P,B.count-P);switch(U){case A.B4b:return new A(new C(Q,
H));case W.B4b:return new W(new m(Q,H));case N.B4b:return new N(new y(Q,H,K));default:throw Error.argument("initData");}}catch(U){throw Error.argument("initData");}}static eLf(B,H,K,A,W,N){B=B.Lam.getId(H,null);if(0>B)return++N,N;F.fLf(B,K,A,W);return N}static fLf(B,H,K,A){Array.add(A.bcf,B);Array.add(A.YUh,H);++A.HTb[K]}}F.l$a=1099767983;Object(L.a)(F,"TokenStringGenerator",null,[1389])},709:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);d=d(159);class k extends d.a{constructor(e,n,r,w,D=
null){super(e,n,D,null,r);this.id=w}}Object(L.a)(k,"TryQueryResultBinding",d.a,[])},710:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);class k{constructor(e){this.Ka=e}get tLa(){return this.Ka.tLa}get l7l(){return 4!==this.Ka.style}get o7l(){return!0}get trie(){return this.Ka.trie}getId(e,n){if(!this.l7l)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ka.style){case 0:return this.NCj(e,n);default:throw Error.notImplemented();}}MD(e){if(!this.o7l)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.tLa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ka.style){case 0:return this.QNj(e);case 4:return this.PNj(e);default:throw Error.notImplemented();}}NCj(e,n){e=this.Ka.trie.kLg(e,0,e.length,n);if(!e.succeeded)return-1;if(0>e.QTb||e.QTb>=this.Ka.tLa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ka.jBc?this.Ka.bvc.tv(this.Ka.jBc+4*e.QTb,4):e.QTb}QNj(e){if(this.Ka.jBc){let n=0;for(;n<this.Ka.tLa&&this.Ka.bvc.tv(this.Ka.jBc+
4*n,4)!==e;++n);if(n>=this.Ka.tLa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ka.trie.ipg(n)}return this.Ka.trie.ipg(e)}PNj(e){const n=this.Ka.bvc.tv(this.Ka.WUh+4*e,4);e=this.Ka.bvc.tv(this.Ka.XUh+4*e,4);if(0>e||0>n)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const r=Array(n);for(let w=0;w<n;++w)r[w]=({X5j:e}=this.Psl(e)).returnValue;return String.fromCharCode.apply(null,r)}Psl(e){let n=0;for(let r=0;3>r;++r){const w=
this.Ka.bvc.ga(this.Ka.TVf+e)^182;++e;n|=(w&127)<<7*r;if(!(w&128))break}return{returnValue:n,X5j:e}}}Object(L.a)(k,"StringTable",null,[1382])},711:function(L,V,d){d.d(V,"a",function(){return e});L=d(0);var k=d(723);class e{constructor(n){this.trie=null;this.TVf=this.WUh=this.XUh=this.jBc=0;if(n){this.bvc=n;var r=0;if(n.tv(r,4)!==e.l$a)throw Error.argument("bytes","Input does not represent a string table");r+=4;this.tLa=n.tv(r,4);r+=4;this.style=n.tv(r,4);r+=4;switch(this.style){case 0:const w=1===
n.tv(r,4);r+=4;w||(this.jBc=r,r+=4*this.tLa);n.tv(r,4);this.trie=this.oel(n,r+4);break;case 4:this.XUh=r;this.WUh=r+=4*this.tLa;r+=4*this.tLa;n.tv(r,4);this.TVf=r+4;break;default:throw Error.argument("bytes");}}}oel(n,r){return new k.a(n,r)}}e.l$a=1025118440;Object(L.a)(e,"StringTableInit",null,[])},712:function(L,V,d){d.d(V,"a",function(){return k});L=d(0);var k;(function(e){e[e.W6h=0]="Answer";e[e.Definition=1]="Definition";e[e.C7h=2]="Entity";e[e.J9h=3]="WolframAnswer";e[e.X6h=4]="Assistance";
e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.l9h=7]="TryQuery";e[e.K7h=8]="FindInDocument";e[e.$qm=9]="HelpAction";e[e.U7h=10]="Insights";e[e.L8h=11]="People";e[e.Image=12]="Image";e[e.Vqm=13]="FirstRunResult";e[e.Hrm=14]="NoCommandsFoundResult";e[e.i9h=15]="TestResult";e[e.tqm=16]="AppsForOffice_Installed";e[e.vqm=17]="AppsForOffice_Recommandation";e[e.uqm=18]="AppsForOffice_Query";e[e.Irm=19]="Notes_Onenote";e[e.Jrm=20]="Notes_Samsung";e[e.Krm=21]="Notes_Sticky";e[e.h8h=22]="Learning";
e[e.Feedback=23]="Feedback";e[e.h9h=24]="Template";e[e.Kjf=25]="ActionAI";e[e.T6h=26]="ActionAICommand";e[e.U6h=27]="Addin";e[e.A8h=28]="OfficeScript";e[e.V6h=29]="AddinStoreEntry";e[e.Zqm=30]="GenerateSlides";e[e.LGd=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(k||(k={}));Object(L.b)("ResultType",k)},723:function(L,V,d){L=d(0);class k{constructor(y){this.fjh=y;this.succeeded=!1;this.QTb=y?y.QTb:0;this.Prk=!1;this.length=this.W8l=0}}Object(L.a)(k,"TrieResult",null,[]);class e{constructor(y,m,C){this.jo=
new k(null);this.RMk=y;this.qkc=m;this.TQg=m+C-1}get result(){return this.jo}Llg(){let y;return this.qkc<=this.TQg?(y=this.RMk.charAt(this.qkc),++this.qkc,{returnValue:!0,ch:y}):{returnValue:!1,ch:"\x00"}}A2e(y,m,C){y&&(this.jo.Prk=!0,this.jo.W8l=m);this.jo.length=this.qkc;this.jo.succeeded=!0;this.jo.QTb=C;this.qkc!==this.TQg+1&&(this.jo=new k(this.jo))}}Object(L.a)(e,"LookUpStringVisitor",null,[1386]);var n=d(1022);class r{constructor(){this.zVf=this.OSf=this.QSf=this.NSf=this.PSf=this.Q2d=this.P2d=
this.S2d=this.O2d=0}}Object(L.a)(r,"TRIESTATS",null,[]);class w{constructor(){this.symbol=this.Aqc=0}}Object(L.a)(w,"TrieSymbol",null,[]);d.d(V,"a",function(){return D});class D{constructor(y,m){this.UV=null;this.aed=this.mUg=this.kUg=this.oUg=this.gUg=this.nUg=this.lUg=this.pUg=this.hUg=0;this.YD=y;if(y.tv(m,4)!==D.l$a)throw Error.argument("Input does not represent a trie");m+=4;this.wRg=1===y.tv(m,4);m+=4;this.wIk=1===y.tv(m,4);m+=4;this.hIk=y.tv(m,4);m+=4;if(y.tv(m,4)){y=m+4;this.UV=this.Rsl(y);
this.hUg=m=y+D.CMi;this.pUg=m+=D.xQc*(this.UV.O2d+(this.UV.O2d%2?1:0));this.lUg=m+=D.xQc*(this.UV.S2d+(this.UV.S2d%2?1:0));this.nUg=m+=D.xQc*(this.UV.P2d+(this.UV.P2d%2?1:0));this.gUg=m+=D.xQc*(this.UV.Q2d+(this.UV.Q2d%2?1:0));this.oUg=m+=D.X2d*this.UV.NSf;this.kUg=m+=D.Y2d*this.UV.QSf;this.mUg=m+=D.Y2d*this.UV.OSf;m+=D.Y2d*this.UV.PSf;if(m!==y+this.UV.zVf)throw Error.argument("Corrupted trie binary");this.aed=m}else this.UV=null}kLg(y,m,C,E){y=new e(y,m,C);this.v5h(y,E);return y.result}ipg(y){if(this.wRg)if(y)--y;
else return"";if(!this.UV)throw Error.argument("Invalid trieID");const m=new n.a;m.EA=0;this.Npb(m);const C=[];for(;;){if(m.EA&D.hPa)if(y)--y;else return Array.add(C,m.oqb),String.fromCharCode.apply(null,C);const E=!!(m.EA&D.NGd),F=this.UAb(m,!0);if(E||y<F){if(Array.add(C,m.oqb),!this.Npb(m))throw Error.argument("Invalid trieID");}else if(y-=F,!this.iBc(m))throw Error.argument("Invalid trieID");}}v5h(y,m){let C=0;this.wRg&&(y.A2e(this.wIk,this.hIk,0),++C);if(this.UV){var E=new n.a;E.EA=0;if(this.Npb(E))for(;;){var F=
void 0;if(!({ch:F}=y.Llg()).returnValue)break;m&&(F=m(F));F=F.toString().charCodeAt(0);let B=!1;for(;!B;){const H=!!(E.EA&D.hPa);if(E.oqb===F){if(B=!0,H&&y.A2e(!!(E.EA&D.tmf),E.xCd,C),!this.Npb(E))return}else if(C+=this.UAb(E,!0),!this.iBc(E))return;H&&++C}}}}Npb(y){if(!y.EA)return this.tff(y),!0;if(!(y.EA&D.MGd))return!1;y.Qva=0;y.mu=y.cXa;this.tff(y);return!0}iBc(y){if(y.EA&D.NGd)return!1;this.tff(y);return!0}UAb(y,m){return y.EA&D.smf?y.uQc:y.EA&D.MGd?!m&&y.EA&D.NGd?this.byj(y):1:0}byj(y){y=D.k5d(y);
if(!this.Npb(y))return 0;let m=0;do y.EA&D.hPa&&++m,m+=this.UAb(y,!1);while(this.iBc(y));return m}tff(y){y.EA||(y.Qva=0,y.mu=this.aed);var m=this.HUc(this.hUg,y.mu),C=m.symbol;y.mu+=m.Aqc;m=this.YD.tv(this.gUg+D.X2d*C,D.X2d);y.oqb=m&65535;y.EA=m>>16;y.EA&D.smf&&(y.uQc=this.z9i(y));y.EA&D.tmf&&(m=this.HUc(this.pUg,y.mu),C=m.symbol,y.mu+=m.Aqc,y.xCd=this.YD.tv(this.oUg+4*C,4));y.EA&D.e9h?(y.cXa=this.aed+((this.YD.ga(y.mu)<<8|this.YD.ga(y.mu+1))<<8|this.YD.ga(y.mu+2)),y.mu+=3):y.EA&D.f9h?(y.cXa=y.mu,
y.Qva=y.cXa):y.EA&D.g9h?(m=this.HUc(this.lUg,y.mu),C=m.symbol,y.mu+=m.Aqc,y.cXa=this.aed+this.YD.tv(this.kUg+4*C,4)):y.EA&D.MGd&&(m=this.HUc(this.nUg,y.mu),C=m.symbol,y.mu+=m.Aqc,y.Qva||(y.Qva=y.mu),y.Qva+=this.YD.tv(this.mUg+4*C,4),y.cXa=y.Qva)}HUc(y,m){const C=new w;let E=0;for(;;){E+=this.YD.ga(m);++m;++C.Aqc;const F=this.YD.tv(y,2);if(E<F)break;C.symbol+=F;E-=F;y+=2;E<<=8}C.symbol+=E;return C}z9i(y){let m=this.YD.ga(y.mu);192<=m?(m=(m&63)<<15|(this.YD.ga(y.mu+1)&127)<<8,m|=this.YD.ga(y.mu+2),
y.mu+=3):128<=m?(m=(m&127)<<8|this.YD.ga(y.mu+1),y.mu+=2):y.mu+=1;return m}Rsl(y){const m=new r;m.O2d=this.YD.tv(y+12,2);m.S2d=this.YD.tv(y+14,2);m.P2d=this.YD.tv(y+16,2);m.Q2d=this.YD.tv(y+18,2);m.PSf=this.YD.tv(y+24,4);m.NSf=this.YD.tv(y+28,4);m.QSf=this.YD.tv(y+32,4);m.OSf=this.YD.tv(y+36,4);m.zVf=this.YD.tv(y+40,4);return m}static k5d(y){const m=new n.a;m.oqb=y.oqb;m.EA=y.EA;m.uQc=y.uQc;m.mu=y.mu;m.cXa=y.cXa;m.Qva=y.Qva;m.xCd=y.xCd;return m}}D.l$a=1654263084;D.CMi=48;D.xQc=2;D.Y2d=4;D.X2d=4;D.hPa=
1;D.NGd=2;D.smf=4;D.tmf=8;D.MGd=16;D.f9h=64;D.g9h=128;D.e9h=256;Object(L.a)(D,"Trie",null,[1375])},726:function(L,V,d){d.r(V);L=d(0);d(145);var k=d(268);class e{}e.ygh=0;e.Ntc=10;Object(L.a)(e,"AppsForOfficeStoreType",null,[]);var n=d(116),r=d(25),w=d(80),D=d(36);class y{constructor(){this.TVd=0}B_e(A,W){this.TVd=window.performance.now();this.m5a(()=>{const N=window.performance.now(),P={},U=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);W.zMf&&(P.callback=Q=>{A(Q,e.ygh,N)},U&&(P.storeType=e.ygh),r.AFrameworkApplication.Pa.Ia(D.a.Y1a,2,P));W.AMf&&(P.callback=Q=>{A(Q,e.Ntc,N)},U?P.storeType=e.Ntc:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?P.storeType=10:P.storeType=e.Ntc,r.AFrameworkApplication.Pa.Ia(D.a.Y1a,2,P))},0,()=>{if(n.TellMeActor.instance.Qd)n.TellMeActor.instance.Qd.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.TVd)+" ms")})}m5a(A,W=0,N=null){2!==r.AFrameworkApplication.Pa.nb(D.a.Y1a,1)?(n.TellMeActor.instance.Qd&&n.TellMeActor.instance.Qd.TI(k.a.CBi,window.performance.now()-this.TVd),A()):W<y.dXk?r.AFrameworkApplication.Be.Jb(new w.a(2,1,y.oom,()=>{this.m5a(A,W+1,N)})):N&&N()}static get instance(){y.Ja||(y.Ja=new y);return y.Ja}}y.Ja=null;y.dXk=20;y.oom=500;Object(L.a)(y,"AddinEntitlementsQuery",null,[]);class m{constructor(){this.description=this.id=this.displayName=null;
this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.dze=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(L.a)(m,"AddinInfo",null,[]);var C=d(159),E=d(174),F=d(173),B=d(108),H=d(65);d.d(V,"AddinResultsProvider",function(){return K});class K{constructor(A){this.OTd=[];this.vb=A;this.H5k=(W,N,P)=>{if(W){const U=W.errorCode;if(n.TellMeActor.instance.Qd){const Q={};Q.StoreType=N;Q.ErrorCode=U;Q.AddinCount=W.value?W.value.length:0;n.TellMeActor.instance.Qd.TI(k.a.Ntj,
window.performance.now()-P,Q)}if(0===U&&W.value){K.H9a=K.H9a||{};W=W.value;for(const Q of W)W=new m,W.displayName=Q[0],W.id=Q[1],W.description=Q[2],W.targetType=Q[3],W.appVersion=4<Q.length?Q[4]:"",W.assetId=5<Q.length?Q[5]:"",W.assetStoreId=6<Q.length?Q[6]:"",W.width=7<Q.length?Q[7]:0,W.height=8<Q.length?Q[8]:0,W.iconUrl=9<Q.length?Q[9]:"",W.providerName=10<Q.length?Q[10]:"",W.storeId=11<Q.length?Q[11]:"",W.storeType=12<Q.length?Q[12]:"",W.dze=this.LDj(W),K.H9a[W.id]=W,0<W.iconUrl.length&&(N="AddinIcon_"+
W.id,r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.UBh(N,W.iconUrl):appChrome.addInApi.registerAddinIcon(N,W.iconUrl))}}};y.instance.B_e(this.H5k,this.vb)}hF(){return"Add-ins"}CM(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}AC(A,W,N,P,U=null){N=new F.a(A);U&&!Array.contains(U,27)||B.a.SG(A)||(U=new E.a(27),U.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.tDj(A.Mf,U),N.jr(U));W.oo(N)}tDj(A,W){if((A=this.cLl(A))&&
0<A.length){let N=0;A.forEach(P=>{if(!(3<++N)){var U="AddinSuggestion"+N,Q={};if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var G="AddinIcon_"+P.id;0>Array.indexOf(this.OTd,G)&&0<P.iconUrl.length&&this.UBh(G,P.iconUrl);Q["default"]=0<=Array.indexOf(this.OTd,G)?G:"AppForOfficeLogo_20"}else Q["default"]=0<P.iconUrl.length?"AddinIcon_"+P.id:"AppForOfficeLogo_20";G=[];G.push(appChrome.actions.setControlLabel(U,P.displayName));G.push(appChrome.actions.setControlIconSet(U,
Q));G.push(appChrome.actions.setCompoundButtonCommandValueId(U,P.id));G.push(appChrome.actions.updateCompoundButtonDescription(U,P.description));r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(Q=window.performance.now(),G.push(appChrome.actions.updateControlEnabledDisabledState(U,!1)),n.TellMeActor.instance.Qd&&n.TellMeActor.instance.Qd.TI(k.a.Vfj,window.performance.now()-Q));appChrome.api.dispatch(G);U=new C.a(U,27,void 0,void 0,
1);U.C_d=Telemetry.PrivacyRules.GetPrivacyCompliantId(P.id,P.storeType,P.assetId,null,null,P.storeId);W.qt(U)}})}}UBh(A,W){H.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(A,W),Array.add(this.OTd,A))}cLl(A){if(!K.H9a)return null;const W=[],N=K.H9a;for(const U in N){var P=N[U];P&&K.xWk(A,P)&&Array.add(W,P)}return W}LDj(A){return K.H4l(A.displayName)}static xWk(A,W){if(!W.dze)return!1;for(const N of A.split(" ")){A=!1;for(const P of W.dze)if(P.toLowerCase().startsWith(N.toLowerCase())){A=
!0;break}if(!A)return!1}return!0}static H4l(A){const W=[];for(const N of A.split(" ")){A=0;for(let P=0;P<N.length;P++){const U=N.charAt(P);U.toString().toUpperCase()===U.toString()&&P>A&&(Array.add(W,N.substring(A,P)),A=P)}Array.add(W,N.substring(A,N.length));A&&Array.add(W,N.substring(0,N.length))}return W}}K.H9a=null;Object(L.a)(K,"AddinResultsProvider",null,[1132])},79:function(L,V,d){d.r(V);L=d(0);var k=d(19),e=d(227),n=d(140),r=d(710),w=d(711);class D{constructor(m,C){this.IQa=!1;this.h6=null;
if(!m)throw Error.argumentNull("annotations");if(!m.jFb(C))throw Error.argument("structTypeID","Invalid struct type ID");this.Ls=m;this.tGb=this.Ls.Xlg(C);this.cpi=C}get Pvb(){return this.Ls}get isReadOnly(){return this.IQa}get RAa(){return this.cpi}OVa(m){if(0>m||m>=this.tGb)throw Error.argument("iField","Invalid field index");return this.h6&&null!=this.h6[m]?this.h6[m]:this.Ls.jpg(this.RAa,m)}K7e(m,C){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");
if(0>m||m>=this.tGb)throw Error.argument("iField","Invalid field index");if(!this.Ls.eEb(this.Ls.Rcb(this.RAa,m),C))throw Error.argument("value","Value is not of the correct type for the specified field");(this.h6||(this.h6=Array(this.tGb)))[m]=C}K3(){const {Annotations:m}=d(79);let C="[";if(this.h6){let E=!0;for(let F=0;F<this.tGb;++F){if(null==this.h6[F])continue;const B=this.Ls.Rcb(this.RAa,F);if(m.l5a(B,this.h6[F],this.Ls.jpg(this.RAa,F)))continue;E?E=!1:C+=", ";C+=this.Ls.kpg(this.RAa,F);C+=
"=";const H=this.Ls.K3(B,this.h6[F]);B===m.C_?(C+='"',C+=e.a.ace(H),C+='"'):C+=H}}return C+"]"}isEqual(m){const {Annotations:C}=d(79);if(this===m)return!0;if(!m||this.Ls!==m.Pvb||this.RAa!==m.RAa)return!1;for(let E=0;E<this.tGb;++E)if(!C.l5a(this.Ls.Rcb(this.RAa,E),this.OVa(E),m.OVa(E)))return!1;return!0}clone(){const m=new D(this.Ls,this.RAa);this.h6&&(m.h6=Array.clone(this.h6));return m}kM(){return this.isReadOnly?this.clone():this}nAe(){const {Annotations:m}=d(79);if(!this.isReadOnly&&(this.IQa=
!0,this.h6))for(let C=0;C<this.tGb;++C){const E=this.h6[C];null!=E&&m.Jfb(E)}}toString(){return this.K3()}}Object(L.a)(D,"StructValue",null,[1315,1313]);d.d(V,"Annotations",function(){return y});class y{constructor(m,C){if(!m)throw Error.argumentNull("initData");if(!C)throw Error.argumentNull("objectFetcher");this.WHk=C.$dj;let E=0;var F=C.BVa(m.ga(E));++E;this.ZOe=new r.a(new w.a(F));this.Ndi=m.ga(E);++E;this.ZQg=Array(this.YWc);this.Bjc=Array(this.YWc);this.tZa=Array(this.YWc);for(F=0;F<this.YWc;++F){this.ZQg[F]=
C.MD(m.ga(E));++E;this.Bjc[F]=m.ga(E);++E;var B=m.ga(E);++E;this.tZa[F]=Array(B);for(var H=0;H<B;++H)this.tZa[F][H]=C.MD(m.ga(E)),++E}this.bpi=m.ga(E);++E;this.Rch=Array(this.xzc);this.qkd=Array(this.xzc);this.rkd=Array(this.xzc);this.pkd=Array(this.xzc);for(F=0;F<this.xzc;++F)for(this.Rch[F]=C.MD(m.ga(E)),++E,B=m.ga(E),++E,this.qkd[F]=Array(B),this.rkd[F]=Array(B),this.pkd[F]=Array(B),H=0;H<B;++H)this.qkd[F][H]=C.MD(m.ga(E)),++E,this.rkd[F][H]=m.ga(E),++E,this.pkd[F][H]=({z5:E}=this.pua(this.rkd[F][H],
m,E,null,null,null)).returnValue,y.Jfb(this.pkd[F][H]);this.fai=m.ga(E);++E;this.YBe=Array(this.owb);this.ZBe=Array(this.owb);this.XBe=Array(this.owb);for(F=0;F<this.owb;++F)this.YBe[F]=C.MD(m.ga(E)),++E,this.ZBe[F]=m.ga(E),++E,this.XBe[F]=({z5:E}=this.pua(this.ZBe[F],m,E,null,null,null)).returnValue,y.Jfb(this.XBe[F])}K$b(m){for(let C=0;C<this.owb;++C)if(this.YBe[C]===m)return C;return-1}ggg(m){if(!this.iFb(m))throw Error.argument("attrID","Invalid attribute ID");return this.YBe[m]}getAttributeType(m){if(!this.iFb(m))throw Error.argument("attrID",
"Invalid attribute ID");return this.ZBe[m]}Rcb(m,C){if(!this.jFb(m))throw Error.argument("structTypeID","Invalid struct type ID");m=this.rkd[y.yzc(m)];if(0>C||C>=m.length)throw Error.argument("iField","Invalid field index");return m[C]}K3(m,C){if(!this.Cye(m))throw Error.argument("typeID","Invalid type ID");if(!this.eEb(m,C))throw Error.argument("value","Value is not of the correct type");switch(m){case y.C_:return C;case y.$ia:return C?"True":"False";case y.yra:case y.Hca:return C.toString();case y.cO:return C.K3();
default:if(!y.kD(m)&&y.ABc(m)){m=y.Vbe(m);const B=this.tZa[m].length;switch(this.Bjc[m]){case 0:return this.tZa[m][C];case 1:if(C){var E="";for(var F=1;F<B;++F)C&1<<F-1&&(0<E.length&&(E+=" & "),E+=this.tZa[m][F]);return E}return this.tZa[m][0];case 2:E="";for(F=0;F<B;++F)C&1<<F&&(0<E.length&&(E+=" & "),E+=this.tZa[m][F]);return E;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Bjc[m]);}}else return C.K3()}}Cye(m){switch(m){case y.C_:case y.$ia:case y.yra:case y.Hca:case y.cO:return!0;
default:return y.kD(m)?this.Cye(y.vGa(m)):y.ABc(m)?this.btk(m):this.jFb(m)}}btk(m){m=y.Vbe(m);return 0<=m&&m<this.ZQg.length}jFb(m){m=y.yzc(m);return 0<=m&&m<this.Rch.length}iFb(m){return 0<=m&&m<this.owb}eEb(m,C){if(null==C)return!1;switch(m){case y.C_:return"string"===typeof C;case y.$ia:return"boolean"===typeof C;case y.yra:return"number"===typeof C;case y.Hca:return"number"===typeof C;case y.cO:return Object(k.a)(1312,C);default:if(y.kD(m))return Object(k.a)(1314,C)&&C.YV===y.vGa(m);if(y.ABc(m)){if("number"!==
typeof C)return!1;m=y.Vbe(m);const E=this.tZa[m].length;switch(this.Bjc[m]){case 0:return 0<=C&&C<E;case 1:return!(C&-1<<E-1);case 2:return!!C&&!(C&-1<<E);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Bjc[m]);}}else return Object(k.a)(1315,C)&&C.RAa===m}}get owb(){return this.fai}get YWc(){return this.Ndi}get xzc(){return this.bpi}Iuj(m){if(!this.iFb(m))throw Error.argument("attrID","Invalid attribute ID");return this.XBe[m]}Xlg(m){if(!this.jFb(m))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.qkd[y.yzc(m)].length}kpg(m,C){if(!this.jFb(m))throw Error.argument("structTypeID","Invalid struct type ID");return this.qkd[y.yzc(m)][C]}jpg(m,C){if(!this.jFb(m))throw Error.argument("structTypeID","Invalid struct type ID");m=this.pkd[y.yzc(m)];if(0>C||C>=m.length)throw Error.argument("iField","Invalid field index");return m[C]}pua(m,C,E,F,B,H){if(!C)throw Error.argumentNull("initData");if(y.kD(m)){var K=C.ga(E);++E;m=y.vGa(m);var A=new n.a(this,m);for(var W=
0;W<K;++W)Array.add(A.items,({z5:E}=this.pua(m,C,E,F,B,H)).returnValue);return{returnValue:A,z5:E}}switch(m){case y.C_:return{returnValue:(F||this.ZOe).MD(C.ga(E++)),z5:E};case y.$ia:return{returnValue:1===C.ga(E++),z5:E};case y.yra:return{returnValue:C.ga(E++),z5:E};case y.Hca:return{returnValue:(B||this.WHk)[C.ga(E++)],z5:E};case y.cO:m=C.ga(E++);K=new e.a(this);for(A=0;A<m;++A)W=C.ga(E),++E,H&&(W=H[W]),K.vv(W,({z5:E}=this.pua(this.getAttributeType(W),C,E,F,B,H)).returnValue);return{returnValue:K,
z5:E};default:if(y.ABc(m))return{returnValue:C.ga(E++),z5:E};if(y.v0h(m)){K=C.ga(E++);A=new D(this,m);for(W=0;W<K;++W){const N=C.ga(E);++E;A.K7e(N,({z5:E}=this.pua(this.Rcb(m,N),C,E,F,B,H)).returnValue)}return{returnValue:A,z5:E}}throw Error.argument("typeID","Invalid type ID");}}static ABc(m){return 16<=(m&16383)&&16384!==(m&16384)&&32768!==(m&32768)}static v0h(m){return 16<=(m&16383)&&16384===(m&16384)&&32768!==(m&32768)}static kD(m){return 32768===(m&32768)}static LEj(m){if(y.kD(m))throw Error.argument("nonListTypeID",
"Non-list type ID required");return m|32768}static vGa(m){if(!y.kD(m))throw Error.argument("listTypeID","List type ID required");return m&-32769}static l5a(m,C,E){switch(m){case y.C_:case y.$ia:case y.yra:case y.Hca:return C===E;case y.cO:return C.isEqual(E);default:return y.kD(m)?C.isEqual(E):y.ABc(m)?C===E:C.isEqual(E)}}static Jfb(m){Object(k.a)(1313,m)&&m.nAe()}static kM(m){return Object(k.a)(1313,m)?m.kM():m}static Vbe(m){return m-16}static yzc(m){return(m&-16385)-16}}y.C_=1;y.$ia=2;y.yra=3;y.Hca=
5;y.cO=9;Object(L.a)(y,"Annotations",null,[1316])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/21962925/wdjs/ppteditDS.chronos1.js.map